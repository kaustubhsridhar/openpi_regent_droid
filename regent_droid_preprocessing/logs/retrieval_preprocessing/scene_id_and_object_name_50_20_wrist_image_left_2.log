nohup: ignoring input
2025-03-09 06:47:11: got the info dicts: there are 36687 groupings

2025-03-09 06:47:11: number of groupings with atleast 50 episodes [in the first 95658 episodes]: 105

these groupings have chosen_id-->num_episodes as

 {(1297764552, 'bottle'): 53, (2515873443, 'cloth'): 50, (5235850418, 'drawer'): 612, (5879622450, 'block'): 108, (1431810548, 'lid'): 51, (3485794757, 'marker'): 97, (8756300955, 'block'): 117, (1180576306, 'cloth'): 60, (9154343709, 'drawer'): 96, (6498288010, 'bottle'): 138, (8911427557, 'bottle'): 50, (1058976383, 'drawer'): 148, (4045730075, 'lid'): 61, (1712293193, 'marker'): 163, (65137982, 'block'): 100, (4329524892, 'cup'): 166, (484659531, 'marker'): 96, (-1, 'marker'): 1032, (6078642573, 'marker'): 54, (452818143, 'lid'): 221, (1461982682, 'cloth'): 76, (5235850418, 'block'): 97, (7495112204, 'marker'): 102, (666854965, 'marker'): 68, (395700094, 'block'): 72, (3827924651, 'lid'): 67, (6612454114, 'block'): 65, (2782099537, 'marker'): 75, (8376714657, 'marker'): 464, (3452853472, 'drawer'): 91, (9306310171, 'marker'): 97, (3816161570, 'drawer'): 78, (5511329841, 'marker'): 59, (3951366978, 'cup'): 112, (1959308322, 'marker'): 65, (3163748394, 'cup'): 127, (7644292911, 'marker'): 50, (1775582436, 'marker'): 98, (4706041793, 'cloth'): 142, (2370783071, 'block'): 50, (9551783935, 'drawer'): 65, (2782099537, 'cup'): 153, (7489911085, 'cloth'): 179, (5576515039, 'marker'): 50, (4465064685, 'marker'): 198, (9186164821, 'bottle'): 57, (5207831207, 'cup'): 139, (3774560981, 'cloth'): 99, (4823049285, 'bottle'): 234, (9130122211, 'marker'): 159, (6313680013, 'cup'): 50, (9088223759, 'bottle'): 99, (8098563998, 'lid'): 73, (9505766118, 'drawer'): 108, (441689524, 'mug'): 77, (8150285641, 'marker'): 63, (8456936732, 'bottle'): 54, (446878712, 'marker'): 83, (6093644330, 'cloth'): 52, (4345518188, 'lid'): 89, (5024387521, 'marker'): 60, (6498288010, 'lid'): 96, (4823049285, 'block'): 174, (6667529842, 'lid'): 90, (5507987860, 'marker'): 100, (8898968162, 'block'): 58, (-1, 'mug'): 228, (9965421062, 'bottle'): 63, (6357288647, 'lid'): 71, (5701580274, 'marker'): 67, (1469427884, 'marker'): 63, (9933578360, 'drawer'): 53, (1498834123, 'cup'): 77, (440287856, 'drawer'): 75, (376702246, 'cup'): 53, (9883209091, 'mug'): 201, (9934859632, 'marker'): 62, (4312815282, 'marker'): 66, (-1, 'cup'): 113, (8922050678, 'lid'): 64, (2883696971, 'cup'): 69, (9209350647, 'drawer'): 76, (6655265581, 'cup'): 51, (4345518188, 'cloth'): 91, (4545879864, 'marker'): 51, (818725642, 'block'): 63, (3854327802, 'bottle'): 97, (3951366978, 'lid'): 72, (5059283044, 'drawer'): 113, (4846810092, 'cloth'): 93, (8690198922, 'marker'): 65, (1477699675, 'marker'): 89, (4400212150, 'marker'): 52, (1526685371, 'marker'): 62, (6074146895, 'lid'): 59, (8911427557, 'cup'): 112, (8702636502, 'lid'): 90, (8172596608, 'cup'): 51, (1575177183, 'marker'): 59, (5414640868, 'lid'): 56, (1477699675, 'mug'): 57, (9228483020, 'marker'): 80, (2927338332, 'cloth'): 51, (52817038, 'block'): 54, (8815207926, 'block'): 54}
2025-03-09 06:47:12: [retrieval_preprocessing] starting retrieval preprocessing for embeddings__wrist_image_left
2025-03-09 06:47:12: [retrieval_preprocessing] concatenated all embeddings and indices for 20 episodes for (1461982682, 'cloth') [chosen_id count 0/10]
2025-03-09 06:47:12: [retrieval_preprocessing] we have num_total=4426 embedding_dim=49152
[retrieval_preprocessing] for episode 86144 [episode count 0/20], we have num_retrieval=np.int64(4236) num_query=np.int64(190)
2025-03-09 06:47:13,856 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-09 06:47:14,354 [INFO]: Launching the whole pipeline 03/09/2025, 06:47:14
2025-03-09 06:47:14,354 [INFO]: Reading total number of vectors and dimension 03/09/2025, 06:47:14
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 685.79it/s]
2025-03-09 06:47:14,388 [INFO]: There are 4236 embeddings of dim 49152
2025-03-09 06:47:14,389 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0343 secs
2025-03-09 06:47:14,389 [INFO]: 	Compute estimated construction time of the index 03/09/2025, 06:47:14
2025-03-09 06:47:14,389 [INFO]: 		-> Train: 16.7 minutes
2025-03-09 06:47:14,389 [INFO]: 		-> Add: 2.3 seconds
2025-03-09 06:47:14,389 [INFO]: 		Total: 16.7 minutes
2025-03-09 06:47:14,389 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0002 secs
2025-03-09 06:47:14,389 [INFO]: 	Checking that your have enough memory available to create the index 03/09/2025, 06:47:14
2025-03-09 06:47:14,390 [INFO]: 874.2MB of memory will be needed to build the index (more might be used if you have more)
2025-03-09 06:47:14,390 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0008 secs
2025-03-09 06:47:14,390 [INFO]: 	Selecting most promising index types given data characteristics 03/09/2025, 06:47:14
2025-03-09 06:47:14,390 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-09 06:47:14,390 [INFO]: 	Creating the index 03/09/2025, 06:47:14
2025-03-09 06:47:14,390 [INFO]: 		-> Instanciate the index HNSW15 03/09/2025, 06:47:14
2025-03-09 06:47:14,392 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0016 secs
2025-03-09 06:47:14,392 [INFO]: 		-> Adding the vectors to the index 03/09/2025, 06:47:14
2025-03-09 06:47:14,392 [INFO]: The memory available for adding the vectors is 49.2GB(total available - used by the index)
2025-03-09 06:47:14,392 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/17 [00:00<?, ?it/s]  6%|▌         | 1/17 [00:00<00:02,  6.75it/s] 18%|█▊        | 3/17 [00:00<00:01, 10.13it/s] 29%|██▉       | 5/17 [00:00<00:01, 11.36it/s] 41%|████      | 7/17 [00:00<00:00, 11.72it/s] 53%|█████▎    | 9/17 [00:00<00:00, 13.82it/s] 71%|███████   | 12/17 [00:00<00:00, 16.31it/s] 82%|████████▏ | 14/17 [00:00<00:00, 16.31it/s] 94%|█████████▍| 16/17 [00:01<00:00, 15.19it/s]100%|██████████| 17/17 [00:04<00:00,  3.89it/s]
2025-03-09 06:47:18,774 [INFO]: 	Computing best hyperparameters for index knn.index 03/09/2025, 06:47:18
2025-03-09 06:47:59,324 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 40.5499 secs
2025-03-09 06:47:59,324 [INFO]: The best hyperparameters are: efSearch=182
2025-03-09 06:47:59,324 [INFO]: 	Compute fast metrics 03/09/2025, 06:47:59
  0%|          | 0/4 [00:00<?, ?it/s] 25%|██▌       | 1/4 [00:00<00:00,  5.71it/s] 75%|███████▌  | 3/4 [00:00<00:00,  9.27it/s] 75%|███████▌  | 3/4 [00:00<00:00,  7.11it/s]
2025-03-09 06:48:12,656 [INFO]: 	>>> Finished "Compute fast metrics" in 13.3313 secs
2025-03-09 06:48:12,659 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 58.2667 secs
2025-03-09 06:48:12,659 [INFO]: {
2025-03-09 06:48:12,659 [INFO]: 	index_key: HNSW15
2025-03-09 06:48:12,659 [INFO]: 	index_param: efSearch=182
2025-03-09 06:48:12,659 [INFO]: 	index_path: knn.index
2025-03-09 06:48:12,659 [INFO]: 	size in bytes: 833407570
2025-03-09 06:48:12,659 [INFO]: 	avg_search_speed_ms: 10.26832079060674
2025-03-09 06:48:12,659 [INFO]: 	99p_search_speed_ms: 16.322679005097598
2025-03-09 06:48:12,659 [INFO]: 	reconstruction error %: 0.0
2025-03-09 06:48:12,659 [INFO]: 	nb vectors: 4236
2025-03-09 06:48:12,659 [INFO]: 	vectors dimension: 49152
2025-03-09 06:48:12,659 [INFO]: 	compression ratio: 0.999308763178141
2025-03-09 06:48:12,659 [INFO]: }
2025-03-09 06:48:12,659 [INFO]: 	>>> Finished "Creating the index" in 58.2690 secs
2025-03-09 06:48:12,659 [INFO]: >>> Finished "Launching the whole pipeline" in 58.3050 secs
2025-03-09 06:48:13: [retrieval_preprocessing] calculating distances ...
2025-03-09 06:48:14: [retrieval_preprocessing] finished and saved retrieval indices for episode 86144 [episode count 0/20]
[retrieval_preprocessing] for episode 60161 [episode count 1/20], we have num_retrieval=np.int64(4190) num_query=np.int64(236)
2025-03-09 06:48:15,281 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-09 06:48:15,805 [INFO]: Launching the whole pipeline 03/09/2025, 06:48:15
2025-03-09 06:48:15,805 [INFO]: Reading total number of vectors and dimension 03/09/2025, 06:48:15
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1262.20it/s]
2025-03-09 06:48:15,835 [INFO]: There are 4190 embeddings of dim 49152
2025-03-09 06:48:15,836 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0306 secs
2025-03-09 06:48:15,836 [INFO]: 	Compute estimated construction time of the index 03/09/2025, 06:48:15
2025-03-09 06:48:15,836 [INFO]: 		-> Train: 16.7 minutes
2025-03-09 06:48:15,836 [INFO]: 		-> Add: 2.3 seconds
2025-03-09 06:48:15,836 [INFO]: 		Total: 16.7 minutes
2025-03-09 06:48:15,837 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0004 secs
2025-03-09 06:48:15,837 [INFO]: 	Checking that your have enough memory available to create the index 03/09/2025, 06:48:15
2025-03-09 06:48:15,837 [INFO]: 864.7MB of memory will be needed to build the index (more might be used if you have more)
2025-03-09 06:48:15,837 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0005 secs
2025-03-09 06:48:15,838 [INFO]: 	Selecting most promising index types given data characteristics 03/09/2025, 06:48:15
2025-03-09 06:48:15,838 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-09 06:48:15,838 [INFO]: 	Creating the index 03/09/2025, 06:48:15
2025-03-09 06:48:15,838 [INFO]: 		-> Instanciate the index HNSW15 03/09/2025, 06:48:15
2025-03-09 06:48:15,842 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0040 secs
2025-03-09 06:48:15,843 [INFO]: 		-> Adding the vectors to the index 03/09/2025, 06:48:15
2025-03-09 06:48:15,843 [INFO]: The memory available for adding the vectors is 49.2GB(total available - used by the index)
2025-03-09 06:48:15,843 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/17 [00:00<?, ?it/s]  6%|▌         | 1/17 [00:00<00:04,  3.80it/s] 18%|█▊        | 3/17 [00:00<00:01,  7.51it/s] 24%|██▎       | 4/17 [00:00<00:01,  8.02it/s] 35%|███▌      | 6/17 [00:00<00:01,  9.25it/s] 47%|████▋     | 8/17 [00:00<00:00, 10.58it/s] 59%|█████▉    | 10/17 [00:01<00:00, 10.38it/s] 71%|███████   | 12/17 [00:01<00:00, 10.63it/s] 82%|████████▏ | 14/17 [00:01<00:00, 10.29it/s] 94%|█████████▍| 16/17 [00:01<00:00, 10.04it/s]100%|██████████| 17/17 [00:05<00:00,  3.07it/s]
2025-03-09 06:48:21,395 [INFO]: 	Computing best hyperparameters for index knn.index 03/09/2025, 06:48:21
2025-03-09 06:49:01,310 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 39.9138 secs
2025-03-09 06:49:01,310 [INFO]: The best hyperparameters are: efSearch=105
2025-03-09 06:49:01,310 [INFO]: 	Compute fast metrics 03/09/2025, 06:49:01
  0%|          | 0/4 [00:00<?, ?it/s] 25%|██▌       | 1/4 [00:00<00:00,  9.93it/s] 75%|███████▌  | 3/4 [00:00<00:00, 11.54it/s] 75%|███████▌  | 3/4 [00:00<00:00,  8.49it/s]
2025-03-09 06:49:15,426 [INFO]: 	>>> Finished "Compute fast metrics" in 14.1159 secs
2025-03-09 06:49:15,429 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 59.5862 secs
2025-03-09 06:49:15,429 [INFO]: {
2025-03-09 06:49:15,429 [INFO]: 	index_key: HNSW15
2025-03-09 06:49:15,429 [INFO]: 	index_param: efSearch=105
2025-03-09 06:49:15,429 [INFO]: 	index_path: knn.index
2025-03-09 06:49:15,429 [INFO]: 	size in bytes: 824357350
2025-03-09 06:49:15,429 [INFO]: 	avg_search_speed_ms: 7.3287728830797825
2025-03-09 06:49:15,429 [INFO]: 	99p_search_speed_ms: 13.181195138022304
2025-03-09 06:49:15,429 [INFO]: 	reconstruction error %: 0.0
2025-03-09 06:49:15,429 [INFO]: 	nb vectors: 4190
2025-03-09 06:49:15,429 [INFO]: 	vectors dimension: 49152
2025-03-09 06:49:15,429 [INFO]: 	compression ratio: 0.9993087585135257
2025-03-09 06:49:15,429 [INFO]: }
2025-03-09 06:49:15,429 [INFO]: 	>>> Finished "Creating the index" in 59.5913 secs
2025-03-09 06:49:15,429 [INFO]: >>> Finished "Launching the whole pipeline" in 59.6244 secs
2025-03-09 06:49:16: [retrieval_preprocessing] calculating distances ...
2025-03-09 06:49:16: [retrieval_preprocessing] finished and saved retrieval indices for episode 60161 [episode count 1/20]
[retrieval_preprocessing] for episode 80642 [episode count 2/20], we have num_retrieval=np.int64(4175) num_query=np.int64(251)
2025-03-09 06:49:17,921 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-09 06:49:18,491 [INFO]: Launching the whole pipeline 03/09/2025, 06:49:18
2025-03-09 06:49:18,491 [INFO]: Reading total number of vectors and dimension 03/09/2025, 06:49:18
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1300.96it/s]
2025-03-09 06:49:18,519 [INFO]: There are 4175 embeddings of dim 49152
2025-03-09 06:49:18,520 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0291 secs
2025-03-09 06:49:18,520 [INFO]: 	Compute estimated construction time of the index 03/09/2025, 06:49:18
2025-03-09 06:49:18,520 [INFO]: 		-> Train: 16.7 minutes
2025-03-09 06:49:18,520 [INFO]: 		-> Add: 2.3 seconds
2025-03-09 06:49:18,520 [INFO]: 		Total: 16.7 minutes
2025-03-09 06:49:18,520 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0003 secs
2025-03-09 06:49:18,520 [INFO]: 	Checking that your have enough memory available to create the index 03/09/2025, 06:49:18
2025-03-09 06:49:18,521 [INFO]: 861.6MB of memory will be needed to build the index (more might be used if you have more)
2025-03-09 06:49:18,521 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0003 secs
2025-03-09 06:49:18,521 [INFO]: 	Selecting most promising index types given data characteristics 03/09/2025, 06:49:18
2025-03-09 06:49:18,521 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-09 06:49:18,521 [INFO]: 	Creating the index 03/09/2025, 06:49:18
2025-03-09 06:49:18,521 [INFO]: 		-> Instanciate the index HNSW15 03/09/2025, 06:49:18
2025-03-09 06:49:18,524 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0027 secs
2025-03-09 06:49:18,524 [INFO]: 		-> Adding the vectors to the index 03/09/2025, 06:49:18
2025-03-09 06:49:18,525 [INFO]: The memory available for adding the vectors is 49.2GB(total available - used by the index)
2025-03-09 06:49:18,525 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/17 [00:00<?, ?it/s]  6%|▌         | 1/17 [00:00<00:02,  6.18it/s] 18%|█▊        | 3/17 [00:00<00:01,  9.44it/s] 29%|██▉       | 5/17 [00:00<00:01, 10.57it/s] 41%|████      | 7/17 [00:00<00:00, 11.09it/s] 53%|█████▎    | 9/17 [00:00<00:00, 11.49it/s] 65%|██████▍   | 11/17 [00:01<00:00, 11.64it/s] 76%|███████▋  | 13/17 [00:01<00:00, 11.98it/s] 88%|████████▊ | 15/17 [00:01<00:00, 13.06it/s]100%|██████████| 17/17 [00:05<00:00,  1.46it/s]100%|██████████| 17/17 [00:05<00:00,  3.22it/s]
2025-03-09 06:49:23,815 [INFO]: 	Computing best hyperparameters for index knn.index 03/09/2025, 06:49:23
2025-03-09 06:50:05,037 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 41.2206 secs
2025-03-09 06:50:05,037 [INFO]: The best hyperparameters are: efSearch=147
2025-03-09 06:50:05,037 [INFO]: 	Compute fast metrics 03/09/2025, 06:50:05
  0%|          | 0/4 [00:00<?, ?it/s] 25%|██▌       | 1/4 [00:02<00:07,  2.46s/it] 50%|█████     | 2/4 [00:04<00:03,  1.97s/it] 75%|███████▌  | 3/4 [00:04<00:01,  1.38s/it] 75%|███████▌  | 3/4 [00:05<00:01,  1.96s/it]
2025-03-09 06:50:28,545 [INFO]: 	>>> Finished "Compute fast metrics" in 23.5083 secs
2025-03-09 06:50:28,548 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 70.0235 secs
2025-03-09 06:50:28,548 [INFO]: {
2025-03-09 06:50:28,548 [INFO]: 	index_key: HNSW15
2025-03-09 06:50:28,548 [INFO]: 	index_param: efSearch=147
2025-03-09 06:50:28,548 [INFO]: 	index_path: knn.index
2025-03-09 06:50:28,548 [INFO]: 	size in bytes: 821406250
2025-03-09 06:50:28,548 [INFO]: 	avg_search_speed_ms: 8.351982661438118
2025-03-09 06:50:28,548 [INFO]: 	99p_search_speed_ms: 12.937028408050537
2025-03-09 06:50:28,548 [INFO]: 	reconstruction error %: 0.0
2025-03-09 06:50:28,548 [INFO]: 	nb vectors: 4175
2025-03-09 06:50:28,548 [INFO]: 	vectors dimension: 49152
2025-03-09 06:50:28,548 [INFO]: 	compression ratio: 0.9993086855621076
2025-03-09 06:50:28,548 [INFO]: }
2025-03-09 06:50:28,548 [INFO]: 	>>> Finished "Creating the index" in 70.0271 secs
2025-03-09 06:50:28,548 [INFO]: >>> Finished "Launching the whole pipeline" in 70.0576 secs
2025-03-09 06:50:29: [retrieval_preprocessing] calculating distances ...
2025-03-09 06:50:30: [retrieval_preprocessing] finished and saved retrieval indices for episode 80642 [episode count 2/20]
[retrieval_preprocessing] for episode 10372 [episode count 3/20], we have num_retrieval=np.int64(4225) num_query=np.int64(201)
2025-03-09 06:50:31,571 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-09 06:50:32,172 [INFO]: Launching the whole pipeline 03/09/2025, 06:50:32
2025-03-09 06:50:32,172 [INFO]: Reading total number of vectors and dimension 03/09/2025, 06:50:32
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1763.05it/s]
2025-03-09 06:50:32,198 [INFO]: There are 4225 embeddings of dim 49152
2025-03-09 06:50:32,198 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0264 secs
2025-03-09 06:50:32,199 [INFO]: 	Compute estimated construction time of the index 03/09/2025, 06:50:32
2025-03-09 06:50:32,199 [INFO]: 		-> Train: 16.7 minutes
2025-03-09 06:50:32,199 [INFO]: 		-> Add: 2.3 seconds
2025-03-09 06:50:32,199 [INFO]: 		Total: 16.7 minutes
2025-03-09 06:50:32,199 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0004 secs
2025-03-09 06:50:32,199 [INFO]: 	Checking that your have enough memory available to create the index 03/09/2025, 06:50:32
2025-03-09 06:50:32,200 [INFO]: 871.9MB of memory will be needed to build the index (more might be used if you have more)
2025-03-09 06:50:32,200 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0004 secs
2025-03-09 06:50:32,200 [INFO]: 	Selecting most promising index types given data characteristics 03/09/2025, 06:50:32
2025-03-09 06:50:32,200 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-09 06:50:32,200 [INFO]: 	Creating the index 03/09/2025, 06:50:32
2025-03-09 06:50:32,200 [INFO]: 		-> Instanciate the index HNSW15 03/09/2025, 06:50:32
2025-03-09 06:50:32,203 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0026 secs
2025-03-09 06:50:32,203 [INFO]: 		-> Adding the vectors to the index 03/09/2025, 06:50:32
2025-03-09 06:50:32,204 [INFO]: The memory available for adding the vectors is 49.2GB(total available - used by the index)
2025-03-09 06:50:32,204 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/17 [00:00<?, ?it/s]  6%|▌         | 1/17 [00:00<00:02,  6.43it/s] 18%|█▊        | 3/17 [00:00<00:01, 10.85it/s] 29%|██▉       | 5/17 [00:00<00:01, 11.66it/s] 41%|████      | 7/17 [00:00<00:00, 12.37it/s] 53%|█████▎    | 9/17 [00:00<00:00, 12.78it/s] 65%|██████▍   | 11/17 [00:00<00:00, 12.61it/s] 76%|███████▋  | 13/17 [00:01<00:00, 12.51it/s] 88%|████████▊ | 15/17 [00:01<00:00, 12.06it/s]100%|██████████| 17/17 [00:04<00:00,  1.67it/s]100%|██████████| 17/17 [00:04<00:00,  3.62it/s]
2025-03-09 06:50:36,914 [INFO]: 	Computing best hyperparameters for index knn.index 03/09/2025, 06:50:36
2025-03-09 06:51:16,096 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 39.1810 secs
2025-03-09 06:51:16,096 [INFO]: The best hyperparameters are: efSearch=95
2025-03-09 06:51:16,096 [INFO]: 	Compute fast metrics 03/09/2025, 06:51:16
  0%|          | 0/4 [00:00<?, ?it/s] 25%|██▌       | 1/4 [00:00<00:00,  5.15it/s] 50%|█████     | 2/4 [00:00<00:00,  6.94it/s] 75%|███████▌  | 3/4 [00:00<00:00,  7.81it/s] 75%|███████▌  | 3/4 [00:00<00:00,  5.80it/s]
2025-03-09 06:51:29,938 [INFO]: 	>>> Finished "Compute fast metrics" in 13.8415 secs
2025-03-09 06:51:29,941 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 57.7379 secs
2025-03-09 06:51:29,941 [INFO]: {
2025-03-09 06:51:29,941 [INFO]: 	index_key: HNSW15
2025-03-09 06:51:29,942 [INFO]: 	index_param: efSearch=95
2025-03-09 06:51:29,942 [INFO]: 	index_path: knn.index
2025-03-09 06:51:29,942 [INFO]: 	size in bytes: 831243370
2025-03-09 06:51:29,942 [INFO]: 	avg_search_speed_ms: 6.183597899543728
2025-03-09 06:51:29,942 [INFO]: 	99p_search_speed_ms: 9.315266059711574
2025-03-09 06:51:29,942 [INFO]: 	reconstruction error %: 0.0
2025-03-09 06:51:29,942 [INFO]: 	nb vectors: 4225
2025-03-09 06:51:29,942 [INFO]: 	vectors dimension: 49152
2025-03-09 06:51:29,942 [INFO]: 	compression ratio: 0.9993087824568153
2025-03-09 06:51:29,942 [INFO]: }
2025-03-09 06:51:29,942 [INFO]: 	>>> Finished "Creating the index" in 57.7414 secs
2025-03-09 06:51:29,942 [INFO]: >>> Finished "Launching the whole pipeline" in 57.7696 secs
2025-03-09 06:51:30: [retrieval_preprocessing] calculating distances ...
2025-03-09 06:51:30: [retrieval_preprocessing] finished and saved retrieval indices for episode 10372 [episode count 3/20]
[retrieval_preprocessing] for episode 27268 [episode count 4/20], we have num_retrieval=np.int64(4221) num_query=np.int64(205)
2025-03-09 06:51:32,108 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-09 06:51:32,700 [INFO]: Launching the whole pipeline 03/09/2025, 06:51:32
2025-03-09 06:51:32,700 [INFO]: Reading total number of vectors and dimension 03/09/2025, 06:51:32
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 2250.16it/s]
2025-03-09 06:51:32,723 [INFO]: There are 4221 embeddings of dim 49152
2025-03-09 06:51:32,724 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0232 secs
2025-03-09 06:51:32,724 [INFO]: 	Compute estimated construction time of the index 03/09/2025, 06:51:32
2025-03-09 06:51:32,724 [INFO]: 		-> Train: 16.7 minutes
2025-03-09 06:51:32,724 [INFO]: 		-> Add: 2.3 seconds
2025-03-09 06:51:32,724 [INFO]: 		Total: 16.7 minutes
2025-03-09 06:51:32,724 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0001 secs
2025-03-09 06:51:32,724 [INFO]: 	Checking that your have enough memory available to create the index 03/09/2025, 06:51:32
2025-03-09 06:51:32,724 [INFO]: 871.1MB of memory will be needed to build the index (more might be used if you have more)
2025-03-09 06:51:32,724 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0001 secs
2025-03-09 06:51:32,724 [INFO]: 	Selecting most promising index types given data characteristics 03/09/2025, 06:51:32
2025-03-09 06:51:32,724 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-09 06:51:32,724 [INFO]: 	Creating the index 03/09/2025, 06:51:32
2025-03-09 06:51:32,724 [INFO]: 		-> Instanciate the index HNSW15 03/09/2025, 06:51:32
2025-03-09 06:51:32,725 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0008 secs
2025-03-09 06:51:32,725 [INFO]: 		-> Adding the vectors to the index 03/09/2025, 06:51:32
2025-03-09 06:51:32,725 [INFO]: The memory available for adding the vectors is 49.2GB(total available - used by the index)
2025-03-09 06:51:32,725 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/17 [00:00<?, ?it/s]  6%|▌         | 1/17 [00:00<00:02,  6.73it/s] 18%|█▊        | 3/17 [00:00<00:01,  8.86it/s] 24%|██▎       | 4/17 [00:00<00:01,  8.98it/s] 53%|█████▎    | 9/17 [00:00<00:00, 17.83it/s] 71%|███████   | 12/17 [00:00<00:00, 20.00it/s]100%|██████████| 17/17 [00:03<00:00,  2.99it/s]100%|██████████| 17/17 [00:03<00:00,  4.26it/s]
2025-03-09 06:51:36,722 [INFO]: 	Computing best hyperparameters for index knn.index 03/09/2025, 06:51:36
2025-03-09 06:52:16,424 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 39.7017 secs
2025-03-09 06:52:16,424 [INFO]: The best hyperparameters are: efSearch=143
2025-03-09 06:52:16,424 [INFO]: 	Compute fast metrics 03/09/2025, 06:52:16
  0%|          | 0/4 [00:00<?, ?it/s] 25%|██▌       | 1/4 [00:00<00:00,  5.13it/s] 50%|█████     | 2/4 [00:00<00:00,  5.89it/s] 75%|███████▌  | 3/4 [00:00<00:00,  6.20it/s] 75%|███████▌  | 3/4 [00:00<00:00,  4.75it/s]
2025-03-09 06:52:31,337 [INFO]: 	>>> Finished "Compute fast metrics" in 14.9134 secs
2025-03-09 06:52:31,340 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 58.6151 secs
2025-03-09 06:52:31,340 [INFO]: {
2025-03-09 06:52:31,340 [INFO]: 	index_key: HNSW15
2025-03-09 06:52:31,340 [INFO]: 	index_param: efSearch=143
2025-03-09 06:52:31,340 [INFO]: 	index_path: knn.index
2025-03-09 06:52:31,340 [INFO]: 	size in bytes: 830456410
2025-03-09 06:52:31,340 [INFO]: 	avg_search_speed_ms: 7.595619241605119
2025-03-09 06:52:31,340 [INFO]: 	99p_search_speed_ms: 12.2259133378975
2025-03-09 06:52:31,340 [INFO]: 	reconstruction error %: 0.0
2025-03-09 06:52:31,340 [INFO]: 	nb vectors: 4221
2025-03-09 06:52:31,340 [INFO]: 	vectors dimension: 49152
2025-03-09 06:52:31,340 [INFO]: 	compression ratio: 0.9993087632377959
2025-03-09 06:52:31,340 [INFO]: }
2025-03-09 06:52:31,340 [INFO]: 	>>> Finished "Creating the index" in 58.6163 secs
2025-03-09 06:52:31,340 [INFO]: >>> Finished "Launching the whole pipeline" in 58.6400 secs
2025-03-09 06:52:32: [retrieval_preprocessing] calculating distances ...
2025-03-09 06:52:32: [retrieval_preprocessing] finished and saved retrieval indices for episode 27268 [episode count 4/20]
[retrieval_preprocessing] for episode 37764 [episode count 5/20], we have num_retrieval=np.int64(4198) num_query=np.int64(228)
2025-03-09 06:52:33,621 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-09 06:52:34,269 [INFO]: Launching the whole pipeline 03/09/2025, 06:52:34
2025-03-09 06:52:34,269 [INFO]: Reading total number of vectors and dimension 03/09/2025, 06:52:34
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1738.93it/s]
2025-03-09 06:52:34,294 [INFO]: There are 4198 embeddings of dim 49152
2025-03-09 06:52:34,295 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0252 secs
2025-03-09 06:52:34,295 [INFO]: 	Compute estimated construction time of the index 03/09/2025, 06:52:34
2025-03-09 06:52:34,295 [INFO]: 		-> Train: 16.7 minutes
2025-03-09 06:52:34,295 [INFO]: 		-> Add: 2.3 seconds
2025-03-09 06:52:34,295 [INFO]: 		Total: 16.7 minutes
2025-03-09 06:52:34,295 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0001 secs
2025-03-09 06:52:34,295 [INFO]: 	Checking that your have enough memory available to create the index 03/09/2025, 06:52:34
2025-03-09 06:52:34,295 [INFO]: 866.4MB of memory will be needed to build the index (more might be used if you have more)
2025-03-09 06:52:34,295 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0002 secs
2025-03-09 06:52:34,295 [INFO]: 	Selecting most promising index types given data characteristics 03/09/2025, 06:52:34
2025-03-09 06:52:34,295 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-09 06:52:34,295 [INFO]: 	Creating the index 03/09/2025, 06:52:34
2025-03-09 06:52:34,295 [INFO]: 		-> Instanciate the index HNSW15 03/09/2025, 06:52:34
2025-03-09 06:52:34,296 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0010 secs
2025-03-09 06:52:34,296 [INFO]: 		-> Adding the vectors to the index 03/09/2025, 06:52:34
2025-03-09 06:52:34,296 [INFO]: The memory available for adding the vectors is 49.2GB(total available - used by the index)
2025-03-09 06:52:34,297 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/17 [00:00<?, ?it/s]  6%|▌         | 1/17 [00:00<00:03,  4.04it/s] 24%|██▎       | 4/17 [00:00<00:00, 13.40it/s] 41%|████      | 7/17 [00:00<00:00, 16.66it/s] 53%|█████▎    | 9/17 [00:00<00:00, 17.35it/s] 65%|██████▍   | 11/17 [00:00<00:00, 17.25it/s] 82%|████████▏ | 14/17 [00:00<00:00, 19.57it/s]100%|██████████| 17/17 [00:03<00:00,  2.41it/s]100%|██████████| 17/17 [00:03<00:00,  4.30it/s]
2025-03-09 06:52:38,249 [INFO]: 	Computing best hyperparameters for index knn.index 03/09/2025, 06:52:38
2025-03-09 06:53:15,328 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 37.0783 secs
2025-03-09 06:53:15,328 [INFO]: The best hyperparameters are: efSearch=154
2025-03-09 06:53:15,328 [INFO]: 	Compute fast metrics 03/09/2025, 06:53:15
  0%|          | 0/4 [00:00<?, ?it/s] 25%|██▌       | 1/4 [00:00<00:00,  4.66it/s] 50%|█████     | 2/4 [00:00<00:00,  5.97it/s] 75%|███████▌  | 3/4 [00:00<00:00,  6.66it/s] 75%|███████▌  | 3/4 [00:00<00:00,  4.93it/s]
2025-03-09 06:53:29,582 [INFO]: 	>>> Finished "Compute fast metrics" in 14.2536 secs
2025-03-09 06:53:29,584 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 55.2880 secs
2025-03-09 06:53:29,585 [INFO]: {
2025-03-09 06:53:29,585 [INFO]: 	index_key: HNSW15
2025-03-09 06:53:29,585 [INFO]: 	index_param: efSearch=154
2025-03-09 06:53:29,585 [INFO]: 	index_path: knn.index
2025-03-09 06:53:29,585 [INFO]: 	size in bytes: 825931270
2025-03-09 06:53:29,585 [INFO]: 	avg_search_speed_ms: 8.460754787276755
2025-03-09 06:53:29,585 [INFO]: 	99p_search_speed_ms: 14.778262751642616
2025-03-09 06:53:29,585 [INFO]: 	reconstruction error %: 0.0
2025-03-09 06:53:29,585 [INFO]: 	nb vectors: 4198
2025-03-09 06:53:29,585 [INFO]: 	vectors dimension: 49152
2025-03-09 06:53:29,585 [INFO]: 	compression ratio: 0.999308797207787
2025-03-09 06:53:29,585 [INFO]: }
2025-03-09 06:53:29,585 [INFO]: 	>>> Finished "Creating the index" in 55.2895 secs
2025-03-09 06:53:29,585 [INFO]: >>> Finished "Launching the whole pipeline" in 55.3155 secs
2025-03-09 06:53:30: [retrieval_preprocessing] calculating distances ...
2025-03-09 06:53:31: [retrieval_preprocessing] finished and saved retrieval indices for episode 37764 [episode count 5/20]
[retrieval_preprocessing] for episode 41099 [episode count 6/20], we have num_retrieval=np.int64(4165) num_query=np.int64(261)
2025-03-09 06:53:31,339 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-09 06:53:31,851 [INFO]: Launching the whole pipeline 03/09/2025, 06:53:31
2025-03-09 06:53:31,851 [INFO]: Reading total number of vectors and dimension 03/09/2025, 06:53:31
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1540.32it/s]
2025-03-09 06:53:31,878 [INFO]: There are 4165 embeddings of dim 49152
2025-03-09 06:53:31,878 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0269 secs
2025-03-09 06:53:31,878 [INFO]: 	Compute estimated construction time of the index 03/09/2025, 06:53:31
2025-03-09 06:53:31,879 [INFO]: 		-> Train: 16.7 minutes
2025-03-09 06:53:31,879 [INFO]: 		-> Add: 2.3 seconds
2025-03-09 06:53:31,879 [INFO]: 		Total: 16.7 minutes
2025-03-09 06:53:31,879 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0001 secs
2025-03-09 06:53:31,879 [INFO]: 	Checking that your have enough memory available to create the index 03/09/2025, 06:53:31
2025-03-09 06:53:31,879 [INFO]: 859.6MB of memory will be needed to build the index (more might be used if you have more)
2025-03-09 06:53:31,879 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0002 secs
2025-03-09 06:53:31,879 [INFO]: 	Selecting most promising index types given data characteristics 03/09/2025, 06:53:31
2025-03-09 06:53:31,879 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-09 06:53:31,879 [INFO]: 	Creating the index 03/09/2025, 06:53:31
2025-03-09 06:53:31,879 [INFO]: 		-> Instanciate the index HNSW15 03/09/2025, 06:53:31
2025-03-09 06:53:31,880 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0008 secs
2025-03-09 06:53:31,880 [INFO]: 		-> Adding the vectors to the index 03/09/2025, 06:53:31
2025-03-09 06:53:31,880 [INFO]: The memory available for adding the vectors is 49.2GB(total available - used by the index)
2025-03-09 06:53:31,880 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/17 [00:00<?, ?it/s]  6%|▌         | 1/17 [00:00<00:02,  5.61it/s] 29%|██▉       | 5/17 [00:00<00:00, 18.25it/s] 47%|████▋     | 8/17 [00:00<00:00, 19.00it/s] 59%|█████▉    | 10/17 [00:00<00:00, 16.91it/s] 71%|███████   | 12/17 [00:00<00:00, 15.47it/s] 82%|████████▏ | 14/17 [00:00<00:00, 13.95it/s] 94%|█████████▍| 16/17 [00:01<00:00, 12.72it/s]100%|██████████| 17/17 [00:04<00:00,  3.98it/s]
2025-03-09 06:53:36,159 [INFO]: 	Computing best hyperparameters for index knn.index 03/09/2025, 06:53:36
2025-03-09 06:54:11,653 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 35.4929 secs
2025-03-09 06:54:11,653 [INFO]: The best hyperparameters are: efSearch=195
2025-03-09 06:54:11,653 [INFO]: 	Compute fast metrics 03/09/2025, 06:54:11
  0%|          | 0/4 [00:00<?, ?it/s] 25%|██▌       | 1/4 [00:00<00:00,  4.97it/s] 50%|█████     | 2/4 [00:00<00:00,  6.42it/s] 75%|███████▌  | 3/4 [00:00<00:00,  7.21it/s] 75%|███████▌  | 3/4 [00:00<00:00,  5.43it/s]
2025-03-09 06:54:26,265 [INFO]: 	>>> Finished "Compute fast metrics" in 14.6122 secs
2025-03-09 06:54:26,269 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 54.3891 secs
2025-03-09 06:54:26,269 [INFO]: {
2025-03-09 06:54:26,269 [INFO]: 	index_key: HNSW15
2025-03-09 06:54:26,269 [INFO]: 	index_param: efSearch=195
2025-03-09 06:54:26,269 [INFO]: 	index_path: knn.index
2025-03-09 06:54:26,269 [INFO]: 	size in bytes: 819438850
2025-03-09 06:54:26,269 [INFO]: 	avg_search_speed_ms: 9.989263554969869
2025-03-09 06:54:26,269 [INFO]: 	99p_search_speed_ms: 13.96066090092063
2025-03-09 06:54:26,269 [INFO]: 	reconstruction error %: 0.0
2025-03-09 06:54:26,269 [INFO]: 	nb vectors: 4165
2025-03-09 06:54:26,269 [INFO]: 	vectors dimension: 49152
2025-03-09 06:54:26,269 [INFO]: 	compression ratio: 0.9993086366359125
2025-03-09 06:54:26,269 [INFO]: }
2025-03-09 06:54:26,269 [INFO]: 	>>> Finished "Creating the index" in 54.3904 secs
2025-03-09 06:54:26,269 [INFO]: >>> Finished "Launching the whole pipeline" in 54.4180 secs
2025-03-09 06:54:27: [retrieval_preprocessing] calculating distances ...
2025-03-09 06:54:28: [retrieval_preprocessing] finished and saved retrieval indices for episode 41099 [episode count 6/20]
[retrieval_preprocessing] for episode 81035 [episode count 7/20], we have num_retrieval=np.int64(4210) num_query=np.int64(216)
2025-03-09 06:54:30,136 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-09 06:54:30,881 [INFO]: Launching the whole pipeline 03/09/2025, 06:54:30
2025-03-09 06:54:30,881 [INFO]: Reading total number of vectors and dimension 03/09/2025, 06:54:30
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1686.49it/s]
2025-03-09 06:54:30,907 [INFO]: There are 4210 embeddings of dim 49152
2025-03-09 06:54:30,907 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0267 secs
2025-03-09 06:54:30,908 [INFO]: 	Compute estimated construction time of the index 03/09/2025, 06:54:30
2025-03-09 06:54:30,908 [INFO]: 		-> Train: 16.7 minutes
2025-03-09 06:54:30,908 [INFO]: 		-> Add: 2.3 seconds
2025-03-09 06:54:30,908 [INFO]: 		Total: 16.7 minutes
2025-03-09 06:54:30,908 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0003 secs
2025-03-09 06:54:30,908 [INFO]: 	Checking that your have enough memory available to create the index 03/09/2025, 06:54:30
2025-03-09 06:54:30,909 [INFO]: 868.8MB of memory will be needed to build the index (more might be used if you have more)
2025-03-09 06:54:30,909 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0003 secs
2025-03-09 06:54:30,909 [INFO]: 	Selecting most promising index types given data characteristics 03/09/2025, 06:54:30
2025-03-09 06:54:30,909 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-09 06:54:30,909 [INFO]: 	Creating the index 03/09/2025, 06:54:30
2025-03-09 06:54:30,909 [INFO]: 		-> Instanciate the index HNSW15 03/09/2025, 06:54:30
2025-03-09 06:54:30,912 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0027 secs
2025-03-09 06:54:30,912 [INFO]: 		-> Adding the vectors to the index 03/09/2025, 06:54:30
2025-03-09 06:54:30,912 [INFO]: The memory available for adding the vectors is 49.2GB(total available - used by the index)
2025-03-09 06:54:30,913 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/17 [00:00<?, ?it/s]  6%|▌         | 1/17 [00:00<00:02,  6.90it/s] 18%|█▊        | 3/17 [00:00<00:01, 13.25it/s] 29%|██▉       | 5/17 [00:00<00:00, 15.04it/s] 41%|████      | 7/17 [00:00<00:00, 16.03it/s] 53%|█████▎    | 9/17 [00:00<00:00, 15.96it/s] 65%|██████▍   | 11/17 [00:00<00:00, 14.64it/s] 76%|███████▋  | 13/17 [00:00<00:00, 13.65it/s] 88%|████████▊ | 15/17 [00:01<00:00, 12.95it/s]100%|██████████| 17/17 [00:04<00:00,  1.71it/s]100%|██████████| 17/17 [00:04<00:00,  3.79it/s]
2025-03-09 06:54:35,400 [INFO]: 	Computing best hyperparameters for index knn.index 03/09/2025, 06:54:35
2025-03-09 06:55:10,425 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 35.0253 secs
2025-03-09 06:55:10,426 [INFO]: The best hyperparameters are: efSearch=161
2025-03-09 06:55:10,426 [INFO]: 	Compute fast metrics 03/09/2025, 06:55:10
  0%|          | 0/4 [00:00<?, ?it/s] 25%|██▌       | 1/4 [00:00<00:00,  5.52it/s] 75%|███████▌  | 3/4 [00:00<00:00,  8.51it/s] 75%|███████▌  | 3/4 [00:00<00:00,  6.30it/s]
2025-03-09 06:55:24,759 [INFO]: 	>>> Finished "Compute fast metrics" in 14.3334 secs
2025-03-09 06:55:24,762 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 53.8496 secs
2025-03-09 06:55:24,762 [INFO]: {
2025-03-09 06:55:24,762 [INFO]: 	index_key: HNSW15
2025-03-09 06:55:24,762 [INFO]: 	index_param: efSearch=161
2025-03-09 06:55:24,762 [INFO]: 	index_path: knn.index
2025-03-09 06:55:24,762 [INFO]: 	size in bytes: 828292210
2025-03-09 06:55:24,762 [INFO]: 	avg_search_speed_ms: 8.93358183401313
2025-03-09 06:55:24,762 [INFO]: 	99p_search_speed_ms: 14.693914158269758
2025-03-09 06:55:24,762 [INFO]: 	reconstruction error %: 0.0
2025-03-09 06:55:24,762 [INFO]: 	nb vectors: 4210
2025-03-09 06:55:24,762 [INFO]: 	vectors dimension: 49152
2025-03-09 06:55:24,762 [INFO]: 	compression ratio: 0.9993087825853149
2025-03-09 06:55:24,762 [INFO]: }
2025-03-09 06:55:24,762 [INFO]: 	>>> Finished "Creating the index" in 53.8532 secs
2025-03-09 06:55:24,762 [INFO]: >>> Finished "Launching the whole pipeline" in 53.8817 secs
2025-03-09 06:55:25: [retrieval_preprocessing] calculating distances ...
2025-03-09 06:55:26: [retrieval_preprocessing] finished and saved retrieval indices for episode 81035 [episode count 7/20]
[retrieval_preprocessing] for episode 58511 [episode count 8/20], we have num_retrieval=np.int64(4184) num_query=np.int64(242)
2025-03-09 06:55:27,373 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-09 06:55:27,933 [INFO]: Launching the whole pipeline 03/09/2025, 06:55:27
2025-03-09 06:55:27,933 [INFO]: Reading total number of vectors and dimension 03/09/2025, 06:55:27
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 2199.43it/s]
2025-03-09 06:55:27,960 [INFO]: There are 4184 embeddings of dim 49152
2025-03-09 06:55:27,960 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0272 secs
2025-03-09 06:55:27,960 [INFO]: 	Compute estimated construction time of the index 03/09/2025, 06:55:27
2025-03-09 06:55:27,960 [INFO]: 		-> Train: 16.7 minutes
2025-03-09 06:55:27,960 [INFO]: 		-> Add: 2.3 seconds
2025-03-09 06:55:27,961 [INFO]: 		Total: 16.7 minutes
2025-03-09 06:55:27,961 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0001 secs
2025-03-09 06:55:27,961 [INFO]: 	Checking that your have enough memory available to create the index 03/09/2025, 06:55:27
2025-03-09 06:55:27,961 [INFO]: 863.5MB of memory will be needed to build the index (more might be used if you have more)
2025-03-09 06:55:27,961 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0001 secs
2025-03-09 06:55:27,961 [INFO]: 	Selecting most promising index types given data characteristics 03/09/2025, 06:55:27
2025-03-09 06:55:27,961 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-09 06:55:27,961 [INFO]: 	Creating the index 03/09/2025, 06:55:27
2025-03-09 06:55:27,961 [INFO]: 		-> Instanciate the index HNSW15 03/09/2025, 06:55:27
2025-03-09 06:55:27,962 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0008 secs
2025-03-09 06:55:27,962 [INFO]: 		-> Adding the vectors to the index 03/09/2025, 06:55:27
2025-03-09 06:55:27,962 [INFO]: The memory available for adding the vectors is 49.2GB(total available - used by the index)
2025-03-09 06:55:27,962 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/17 [00:00<?, ?it/s]  6%|▌         | 1/17 [00:00<00:02,  5.36it/s] 24%|██▎       | 4/17 [00:00<00:00, 15.19it/s] 35%|███▌      | 6/17 [00:00<00:00, 15.29it/s] 47%|████▋     | 8/17 [00:00<00:00, 16.36it/s] 59%|█████▉    | 10/17 [00:00<00:00, 14.61it/s] 71%|███████   | 12/17 [00:00<00:00, 12.59it/s] 82%|████████▏ | 14/17 [00:01<00:00, 11.25it/s] 94%|█████████▍| 16/17 [00:01<00:00,  9.81it/s]100%|██████████| 17/17 [00:04<00:00,  3.49it/s]
2025-03-09 06:55:32,831 [INFO]: 	Computing best hyperparameters for index knn.index 03/09/2025, 06:55:32
2025-03-09 06:56:13,813 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 40.9815 secs
2025-03-09 06:56:13,813 [INFO]: The best hyperparameters are: efSearch=174
2025-03-09 06:56:13,813 [INFO]: 	Compute fast metrics 03/09/2025, 06:56:13
  0%|          | 0/4 [00:00<?, ?it/s] 25%|██▌       | 1/4 [00:00<00:00,  5.82it/s] 50%|█████     | 2/4 [00:00<00:00,  7.03it/s] 75%|███████▌  | 3/4 [00:00<00:00,  7.46it/s] 75%|███████▌  | 3/4 [00:00<00:00,  5.61it/s]
2025-03-09 06:56:27,129 [INFO]: 	>>> Finished "Compute fast metrics" in 13.3164 secs
2025-03-09 06:56:27,132 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 59.1701 secs
2025-03-09 06:56:27,132 [INFO]: {
2025-03-09 06:56:27,132 [INFO]: 	index_key: HNSW15
2025-03-09 06:56:27,132 [INFO]: 	index_param: efSearch=174
2025-03-09 06:56:27,132 [INFO]: 	index_path: knn.index
2025-03-09 06:56:27,132 [INFO]: 	size in bytes: 823176910
2025-03-09 06:56:27,132 [INFO]: 	avg_search_speed_ms: 9.910978978902206
2025-03-09 06:56:27,132 [INFO]: 	99p_search_speed_ms: 15.601962581276894
2025-03-09 06:56:27,132 [INFO]: 	reconstruction error %: 0.0
2025-03-09 06:56:27,132 [INFO]: 	nb vectors: 4184
2025-03-09 06:56:27,132 [INFO]: 	vectors dimension: 49152
2025-03-09 06:56:27,132 [INFO]: 	compression ratio: 0.9993087293957261
2025-03-09 06:56:27,132 [INFO]: }
2025-03-09 06:56:27,132 [INFO]: 	>>> Finished "Creating the index" in 59.1713 secs
2025-03-09 06:56:27,132 [INFO]: >>> Finished "Launching the whole pipeline" in 59.1991 secs
2025-03-09 06:56:28: [retrieval_preprocessing] calculating distances ...
2025-03-09 06:56:29: [retrieval_preprocessing] finished and saved retrieval indices for episode 58511 [episode count 8/20]
[retrieval_preprocessing] for episode 71313 [episode count 9/20], we have num_retrieval=np.int64(4177) num_query=np.int64(249)
2025-03-09 06:56:30,217 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-09 06:56:30,825 [INFO]: Launching the whole pipeline 03/09/2025, 06:56:30
2025-03-09 06:56:30,825 [INFO]: Reading total number of vectors and dimension 03/09/2025, 06:56:30
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 2239.35it/s]
2025-03-09 06:56:30,841 [INFO]: There are 4177 embeddings of dim 49152
2025-03-09 06:56:30,841 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0161 secs
2025-03-09 06:56:30,841 [INFO]: 	Compute estimated construction time of the index 03/09/2025, 06:56:30
2025-03-09 06:56:30,841 [INFO]: 		-> Train: 16.7 minutes
2025-03-09 06:56:30,841 [INFO]: 		-> Add: 2.3 seconds
2025-03-09 06:56:30,841 [INFO]: 		Total: 16.7 minutes
2025-03-09 06:56:30,841 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0001 secs
2025-03-09 06:56:30,841 [INFO]: 	Checking that your have enough memory available to create the index 03/09/2025, 06:56:30
2025-03-09 06:56:30,841 [INFO]: 862.0MB of memory will be needed to build the index (more might be used if you have more)
2025-03-09 06:56:30,841 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0001 secs
2025-03-09 06:56:30,841 [INFO]: 	Selecting most promising index types given data characteristics 03/09/2025, 06:56:30
2025-03-09 06:56:30,841 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-09 06:56:30,841 [INFO]: 	Creating the index 03/09/2025, 06:56:30
2025-03-09 06:56:30,841 [INFO]: 		-> Instanciate the index HNSW15 03/09/2025, 06:56:30
2025-03-09 06:56:30,842 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0011 secs
2025-03-09 06:56:30,842 [INFO]: 		-> Adding the vectors to the index 03/09/2025, 06:56:30
2025-03-09 06:56:30,843 [INFO]: The memory available for adding the vectors is 49.2GB(total available - used by the index)
2025-03-09 06:56:30,843 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/17 [00:00<?, ?it/s]  6%|▌         | 1/17 [00:00<00:02,  6.53it/s] 24%|██▎       | 4/17 [00:00<00:00, 16.47it/s] 41%|████      | 7/17 [00:00<00:00, 18.42it/s] 53%|█████▎    | 9/17 [00:00<00:00, 17.14it/s] 65%|██████▍   | 11/17 [00:00<00:00, 16.96it/s] 76%|███████▋  | 13/17 [00:00<00:00, 17.28it/s] 88%|████████▊ | 15/17 [00:00<00:00, 17.87it/s]100%|██████████| 17/17 [00:04<00:00,  1.89it/s]100%|██████████| 17/17 [00:04<00:00,  4.18it/s]
2025-03-09 06:56:34,913 [INFO]: 	Computing best hyperparameters for index knn.index 03/09/2025, 06:56:34
2025-03-09 06:57:13,219 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 38.3064 secs
2025-03-09 06:57:13,220 [INFO]: The best hyperparameters are: efSearch=98
2025-03-09 06:57:13,220 [INFO]: 	Compute fast metrics 03/09/2025, 06:57:13
  0%|          | 0/4 [00:00<?, ?it/s] 25%|██▌       | 1/4 [00:00<00:00,  7.06it/s] 75%|███████▌  | 3/4 [00:00<00:00, 11.03it/s] 75%|███████▌  | 3/4 [00:00<00:00,  8.52it/s]
2025-03-09 06:57:26,625 [INFO]: 	>>> Finished "Compute fast metrics" in 13.4054 secs
2025-03-09 06:57:26,628 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 55.7853 secs
2025-03-09 06:57:26,628 [INFO]: {
2025-03-09 06:57:26,628 [INFO]: 	index_key: HNSW15
2025-03-09 06:57:26,628 [INFO]: 	index_param: efSearch=98
2025-03-09 06:57:26,628 [INFO]: 	index_path: knn.index
2025-03-09 06:57:26,628 [INFO]: 	size in bytes: 821799730
2025-03-09 06:57:26,628 [INFO]: 	avg_search_speed_ms: 5.819009267589526
2025-03-09 06:57:26,628 [INFO]: 	99p_search_speed_ms: 8.348741624504328
2025-03-09 06:57:26,628 [INFO]: 	reconstruction error %: 0.0
2025-03-09 06:57:26,628 [INFO]: 	nb vectors: 4177
2025-03-09 06:57:26,628 [INFO]: 	vectors dimension: 49152
2025-03-09 06:57:26,628 [INFO]: 	compression ratio: 0.9993086953192355
2025-03-09 06:57:26,628 [INFO]: }
2025-03-09 06:57:26,628 [INFO]: 	>>> Finished "Creating the index" in 55.7870 secs
2025-03-09 06:57:26,628 [INFO]: >>> Finished "Launching the whole pipeline" in 55.8036 secs
2025-03-09 06:57:27: [retrieval_preprocessing] calculating distances ...
2025-03-09 06:57:27: [retrieval_preprocessing] finished and saved retrieval indices for episode 71313 [episode count 9/20]
[retrieval_preprocessing] for episode 32019 [episode count 10/20], we have num_retrieval=np.int64(4220) num_query=np.int64(206)
2025-03-09 06:57:28,850 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-09 06:57:29,414 [INFO]: Launching the whole pipeline 03/09/2025, 06:57:29
2025-03-09 06:57:29,414 [INFO]: Reading total number of vectors and dimension 03/09/2025, 06:57:29
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1722.51it/s]
2025-03-09 06:57:29,439 [INFO]: There are 4220 embeddings of dim 49152
2025-03-09 06:57:29,439 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0247 secs
2025-03-09 06:57:29,439 [INFO]: 	Compute estimated construction time of the index 03/09/2025, 06:57:29
2025-03-09 06:57:29,439 [INFO]: 		-> Train: 16.7 minutes
2025-03-09 06:57:29,439 [INFO]: 		-> Add: 2.3 seconds
2025-03-09 06:57:29,439 [INFO]: 		Total: 16.7 minutes
2025-03-09 06:57:29,439 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0001 secs
2025-03-09 06:57:29,439 [INFO]: 	Checking that your have enough memory available to create the index 03/09/2025, 06:57:29
2025-03-09 06:57:29,439 [INFO]: 870.9MB of memory will be needed to build the index (more might be used if you have more)
2025-03-09 06:57:29,439 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0001 secs
2025-03-09 06:57:29,439 [INFO]: 	Selecting most promising index types given data characteristics 03/09/2025, 06:57:29
2025-03-09 06:57:29,439 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-09 06:57:29,439 [INFO]: 	Creating the index 03/09/2025, 06:57:29
2025-03-09 06:57:29,439 [INFO]: 		-> Instanciate the index HNSW15 03/09/2025, 06:57:29
2025-03-09 06:57:29,440 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0009 secs
2025-03-09 06:57:29,440 [INFO]: 		-> Adding the vectors to the index 03/09/2025, 06:57:29
2025-03-09 06:57:29,441 [INFO]: The memory available for adding the vectors is 49.2GB(total available - used by the index)
2025-03-09 06:57:29,441 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/17 [00:00<?, ?it/s]  6%|▌         | 1/17 [00:00<00:02,  5.61it/s] 18%|█▊        | 3/17 [00:00<00:01,  8.68it/s] 29%|██▉       | 5/17 [00:00<00:01,  9.68it/s] 41%|████      | 7/17 [00:00<00:00, 10.09it/s] 53%|█████▎    | 9/17 [00:00<00:00, 10.42it/s] 65%|██████▍   | 11/17 [00:01<00:00, 10.85it/s] 76%|███████▋  | 13/17 [00:01<00:00, 11.33it/s] 88%|████████▊ | 15/17 [00:01<00:00, 11.66it/s]100%|██████████| 17/17 [00:04<00:00,  1.77it/s]100%|██████████| 17/17 [00:04<00:00,  3.68it/s]
2025-03-09 06:57:34,068 [INFO]: 	Computing best hyperparameters for index knn.index 03/09/2025, 06:57:34
2025-03-09 06:58:10,823 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 36.7542 secs
2025-03-09 06:58:10,823 [INFO]: The best hyperparameters are: efSearch=159
2025-03-09 06:58:10,823 [INFO]: 	Compute fast metrics 03/09/2025, 06:58:10
  0%|          | 0/4 [00:00<?, ?it/s] 75%|███████▌  | 3/4 [00:00<00:00, 26.07it/s] 75%|███████▌  | 3/4 [00:00<00:00, 22.77it/s]
2025-03-09 06:58:23,620 [INFO]: 	>>> Finished "Compute fast metrics" in 12.7968 secs
2025-03-09 06:58:23,623 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 54.1823 secs
2025-03-09 06:58:23,623 [INFO]: {
2025-03-09 06:58:23,623 [INFO]: 	index_key: HNSW15
2025-03-09 06:58:23,623 [INFO]: 	index_param: efSearch=159
2025-03-09 06:58:23,623 [INFO]: 	index_path: knn.index
2025-03-09 06:58:23,623 [INFO]: 	size in bytes: 830259670
2025-03-09 06:58:23,623 [INFO]: 	avg_search_speed_ms: 8.171339187956738
2025-03-09 06:58:23,623 [INFO]: 	99p_search_speed_ms: 11.495148446410893
2025-03-09 06:58:23,623 [INFO]: 	reconstruction error %: 0.0
2025-03-09 06:58:23,623 [INFO]: 	nb vectors: 4220
2025-03-09 06:58:23,623 [INFO]: 	vectors dimension: 49152
2025-03-09 06:58:23,623 [INFO]: 	compression ratio: 0.9993087584273485
2025-03-09 06:58:23,623 [INFO]: }
2025-03-09 06:58:23,623 [INFO]: 	>>> Finished "Creating the index" in 54.1837 secs
2025-03-09 06:58:23,623 [INFO]: >>> Finished "Launching the whole pipeline" in 54.2091 secs
2025-03-09 06:58:24: [retrieval_preprocessing] calculating distances ...
2025-03-09 06:58:25: [retrieval_preprocessing] finished and saved retrieval indices for episode 32019 [episode count 10/20]
[retrieval_preprocessing] for episode 67219 [episode count 11/20], we have num_retrieval=np.int64(4197) num_query=np.int64(229)
2025-03-09 06:58:26,718 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-09 06:58:27,285 [INFO]: Launching the whole pipeline 03/09/2025, 06:58:27
2025-03-09 06:58:27,285 [INFO]: Reading total number of vectors and dimension 03/09/2025, 06:58:27
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1688.53it/s]
2025-03-09 06:58:27,318 [INFO]: There are 4197 embeddings of dim 49152
2025-03-09 06:58:27,319 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0338 secs
2025-03-09 06:58:27,319 [INFO]: 	Compute estimated construction time of the index 03/09/2025, 06:58:27
2025-03-09 06:58:27,319 [INFO]: 		-> Train: 16.7 minutes
2025-03-09 06:58:27,319 [INFO]: 		-> Add: 2.3 seconds
2025-03-09 06:58:27,319 [INFO]: 		Total: 16.7 minutes
2025-03-09 06:58:27,319 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0003 secs
2025-03-09 06:58:27,319 [INFO]: 	Checking that your have enough memory available to create the index 03/09/2025, 06:58:27
2025-03-09 06:58:27,320 [INFO]: 866.2MB of memory will be needed to build the index (more might be used if you have more)
2025-03-09 06:58:27,320 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0004 secs
2025-03-09 06:58:27,320 [INFO]: 	Selecting most promising index types given data characteristics 03/09/2025, 06:58:27
2025-03-09 06:58:27,320 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-09 06:58:27,320 [INFO]: 	Creating the index 03/09/2025, 06:58:27
2025-03-09 06:58:27,320 [INFO]: 		-> Instanciate the index HNSW15 03/09/2025, 06:58:27
2025-03-09 06:58:27,323 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0026 secs
2025-03-09 06:58:27,323 [INFO]: 		-> Adding the vectors to the index 03/09/2025, 06:58:27
2025-03-09 06:58:27,323 [INFO]: The memory available for adding the vectors is 49.2GB(total available - used by the index)
2025-03-09 06:58:27,324 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/17 [00:00<?, ?it/s]  6%|▌         | 1/17 [00:00<00:02,  5.40it/s] 12%|█▏        | 2/17 [00:00<00:02,  7.22it/s] 18%|█▊        | 3/17 [00:00<00:01,  8.03it/s] 24%|██▎       | 4/17 [00:00<00:01,  8.52it/s] 29%|██▉       | 5/17 [00:00<00:01,  8.67it/s] 35%|███▌      | 6/17 [00:00<00:01,  8.66it/s] 41%|████      | 7/17 [00:00<00:01,  8.95it/s] 47%|████▋     | 8/17 [00:00<00:01,  8.88it/s] 53%|█████▎    | 9/17 [00:01<00:00,  9.06it/s] 59%|█████▉    | 10/17 [00:01<00:00,  8.84it/s] 65%|██████▍   | 11/17 [00:01<00:00,  8.78it/s] 71%|███████   | 12/17 [00:01<00:00,  8.83it/s] 76%|███████▋  | 13/17 [00:01<00:00,  8.78it/s] 82%|████████▏ | 14/17 [00:01<00:00,  8.78it/s] 88%|████████▊ | 15/17 [00:01<00:00,  8.82it/s] 94%|█████████▍| 16/17 [00:01<00:00,  8.80it/s]100%|██████████| 17/17 [00:05<00:00,  1.07s/it]100%|██████████| 17/17 [00:05<00:00,  3.30it/s]
2025-03-09 06:58:32,475 [INFO]: 	Computing best hyperparameters for index knn.index 03/09/2025, 06:58:32
2025-03-09 06:59:08,190 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 35.7139 secs
2025-03-09 06:59:08,190 [INFO]: The best hyperparameters are: efSearch=152
2025-03-09 06:59:08,190 [INFO]: 	Compute fast metrics 03/09/2025, 06:59:08
  0%|          | 0/4 [00:00<?, ?it/s] 25%|██▌       | 1/4 [00:00<00:00,  5.21it/s] 50%|█████     | 2/4 [00:00<00:00,  6.55it/s] 75%|███████▌  | 3/4 [00:00<00:00,  7.21it/s] 75%|███████▌  | 3/4 [00:00<00:00,  5.43it/s]
2025-03-09 06:59:21,513 [INFO]: 	>>> Finished "Compute fast metrics" in 13.3228 secs
2025-03-09 06:59:21,516 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 54.1926 secs
2025-03-09 06:59:21,516 [INFO]: {
2025-03-09 06:59:21,516 [INFO]: 	index_key: HNSW15
2025-03-09 06:59:21,516 [INFO]: 	index_param: efSearch=152
2025-03-09 06:59:21,516 [INFO]: 	index_path: knn.index
2025-03-09 06:59:21,516 [INFO]: 	size in bytes: 825734530
2025-03-09 06:59:21,516 [INFO]: 	avg_search_speed_ms: 8.771469941558806
2025-03-09 06:59:21,516 [INFO]: 	99p_search_speed_ms: 12.0915793441236
2025-03-09 06:59:21,516 [INFO]: 	reconstruction error %: 0.0
2025-03-09 06:59:21,516 [INFO]: 	nb vectors: 4197
2025-03-09 06:59:21,516 [INFO]: 	vectors dimension: 49152
2025-03-09 06:59:21,516 [INFO]: 	compression ratio: 0.9993087923790712
2025-03-09 06:59:21,516 [INFO]: }
2025-03-09 06:59:21,516 [INFO]: 	>>> Finished "Creating the index" in 54.1959 secs
2025-03-09 06:59:21,516 [INFO]: >>> Finished "Launching the whole pipeline" in 54.2314 secs
2025-03-09 06:59:22: [retrieval_preprocessing] calculating distances ...
2025-03-09 06:59:23: [retrieval_preprocessing] finished and saved retrieval indices for episode 67219 [episode count 11/20]
[retrieval_preprocessing] for episode 149 [episode count 12/20], we have num_retrieval=np.int64(4216) num_query=np.int64(210)
2025-03-09 06:59:24,533 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-09 06:59:25,133 [INFO]: Launching the whole pipeline 03/09/2025, 06:59:25
2025-03-09 06:59:25,134 [INFO]: Reading total number of vectors and dimension 03/09/2025, 06:59:25
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 2141.04it/s]
2025-03-09 06:59:25,159 [INFO]: There are 4216 embeddings of dim 49152
2025-03-09 06:59:25,159 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0257 secs
2025-03-09 06:59:25,159 [INFO]: 	Compute estimated construction time of the index 03/09/2025, 06:59:25
2025-03-09 06:59:25,159 [INFO]: 		-> Train: 16.7 minutes
2025-03-09 06:59:25,159 [INFO]: 		-> Add: 2.3 seconds
2025-03-09 06:59:25,159 [INFO]: 		Total: 16.7 minutes
2025-03-09 06:59:25,159 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0001 secs
2025-03-09 06:59:25,159 [INFO]: 	Checking that your have enough memory available to create the index 03/09/2025, 06:59:25
2025-03-09 06:59:25,160 [INFO]: 870.1MB of memory will be needed to build the index (more might be used if you have more)
2025-03-09 06:59:25,160 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0002 secs
2025-03-09 06:59:25,160 [INFO]: 	Selecting most promising index types given data characteristics 03/09/2025, 06:59:25
2025-03-09 06:59:25,160 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-09 06:59:25,160 [INFO]: 	Creating the index 03/09/2025, 06:59:25
2025-03-09 06:59:25,160 [INFO]: 		-> Instanciate the index HNSW15 03/09/2025, 06:59:25
2025-03-09 06:59:25,161 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0009 secs
2025-03-09 06:59:25,161 [INFO]: 		-> Adding the vectors to the index 03/09/2025, 06:59:25
2025-03-09 06:59:25,161 [INFO]: The memory available for adding the vectors is 49.2GB(total available - used by the index)
2025-03-09 06:59:25,161 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/17 [00:00<?, ?it/s]  6%|▌         | 1/17 [00:00<00:02,  5.84it/s] 18%|█▊        | 3/17 [00:00<00:01,  9.87it/s] 29%|██▉       | 5/17 [00:00<00:01, 11.35it/s] 41%|████      | 7/17 [00:00<00:00, 13.88it/s] 53%|█████▎    | 9/17 [00:00<00:00, 13.10it/s] 65%|██████▍   | 11/17 [00:00<00:00, 12.78it/s] 76%|███████▋  | 13/17 [00:01<00:00, 12.51it/s] 88%|████████▊ | 15/17 [00:01<00:00, 12.39it/s]100%|██████████| 17/17 [00:04<00:00,  1.75it/s]100%|██████████| 17/17 [00:04<00:00,  3.77it/s]
2025-03-09 06:59:29,678 [INFO]: 	Computing best hyperparameters for index knn.index 03/09/2025, 06:59:29
2025-03-09 07:00:06,183 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 36.5052 secs
2025-03-09 07:00:06,184 [INFO]: The best hyperparameters are: efSearch=189
2025-03-09 07:00:06,184 [INFO]: 	Compute fast metrics 03/09/2025, 07:00:06
  0%|          | 0/4 [00:00<?, ?it/s] 25%|██▌       | 1/4 [00:00<00:00,  5.74it/s] 75%|███████▌  | 3/4 [00:00<00:00,  9.37it/s] 75%|███████▌  | 3/4 [00:00<00:00,  7.15it/s]
2025-03-09 07:00:19,211 [INFO]: 	>>> Finished "Compute fast metrics" in 13.0272 secs
2025-03-09 07:00:19,214 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 54.0529 secs
2025-03-09 07:00:19,214 [INFO]: {
2025-03-09 07:00:19,214 [INFO]: 	index_key: HNSW15
2025-03-09 07:00:19,214 [INFO]: 	index_param: efSearch=189
2025-03-09 07:00:19,214 [INFO]: 	index_path: knn.index
2025-03-09 07:00:19,214 [INFO]: 	size in bytes: 829472710
2025-03-09 07:00:19,214 [INFO]: 	avg_search_speed_ms: 9.569340448550275
2025-03-09 07:00:19,214 [INFO]: 	99p_search_speed_ms: 12.395918983966112
2025-03-09 07:00:19,214 [INFO]: 	reconstruction error %: 0.0
2025-03-09 07:00:19,214 [INFO]: 	nb vectors: 4216
2025-03-09 07:00:19,214 [INFO]: 	vectors dimension: 49152
2025-03-09 07:00:19,214 [INFO]: 	compression ratio: 0.9993087391627387
2025-03-09 07:00:19,214 [INFO]: }
2025-03-09 07:00:19,214 [INFO]: 	>>> Finished "Creating the index" in 54.0542 secs
2025-03-09 07:00:19,214 [INFO]: >>> Finished "Launching the whole pipeline" in 54.0805 secs
2025-03-09 07:00:20: [retrieval_preprocessing] calculating distances ...
2025-03-09 07:00:20: [retrieval_preprocessing] finished and saved retrieval indices for episode 149 [episode count 12/20]
[retrieval_preprocessing] for episode 10902 [episode count 13/20], we have num_retrieval=np.int64(4252) num_query=np.int64(174)
2025-03-09 07:00:22,545 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-09 07:00:23,215 [INFO]: Launching the whole pipeline 03/09/2025, 07:00:23
2025-03-09 07:00:23,215 [INFO]: Reading total number of vectors and dimension 03/09/2025, 07:00:23
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1637.12it/s]
2025-03-09 07:00:23,239 [INFO]: There are 4252 embeddings of dim 49152
2025-03-09 07:00:23,239 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0233 secs
2025-03-09 07:00:23,239 [INFO]: 	Compute estimated construction time of the index 03/09/2025, 07:00:23
2025-03-09 07:00:23,239 [INFO]: 		-> Train: 16.7 minutes
2025-03-09 07:00:23,239 [INFO]: 		-> Add: 2.3 seconds
2025-03-09 07:00:23,239 [INFO]: 		Total: 16.7 minutes
2025-03-09 07:00:23,239 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0001 secs
2025-03-09 07:00:23,239 [INFO]: 	Checking that your have enough memory available to create the index 03/09/2025, 07:00:23
2025-03-09 07:00:23,239 [INFO]: 877.5MB of memory will be needed to build the index (more might be used if you have more)
2025-03-09 07:00:23,239 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0001 secs
2025-03-09 07:00:23,239 [INFO]: 	Selecting most promising index types given data characteristics 03/09/2025, 07:00:23
2025-03-09 07:00:23,239 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-09 07:00:23,239 [INFO]: 	Creating the index 03/09/2025, 07:00:23
2025-03-09 07:00:23,239 [INFO]: 		-> Instanciate the index HNSW15 03/09/2025, 07:00:23
2025-03-09 07:00:23,241 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0010 secs
2025-03-09 07:00:23,241 [INFO]: 		-> Adding the vectors to the index 03/09/2025, 07:00:23
2025-03-09 07:00:23,241 [INFO]: The memory available for adding the vectors is 49.2GB(total available - used by the index)
2025-03-09 07:00:23,241 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/17 [00:00<?, ?it/s]  6%|▌         | 1/17 [00:00<00:03,  4.92it/s] 12%|█▏        | 2/17 [00:00<00:02,  6.14it/s] 18%|█▊        | 3/17 [00:00<00:02,  6.44it/s] 24%|██▎       | 4/17 [00:00<00:01,  7.08it/s] 29%|██▉       | 5/17 [00:00<00:01,  7.36it/s] 35%|███▌      | 6/17 [00:00<00:01,  7.03it/s] 41%|████      | 7/17 [00:00<00:01,  7.76it/s] 47%|████▋     | 8/17 [00:01<00:01,  8.26it/s] 53%|█████▎    | 9/17 [00:01<00:00,  8.35it/s] 59%|█████▉    | 10/17 [00:01<00:00,  7.90it/s] 65%|██████▍   | 11/17 [00:01<00:00,  8.15it/s] 71%|███████   | 12/17 [00:01<00:00,  8.34it/s] 82%|████████▏ | 14/17 [00:01<00:00,  9.76it/s]100%|██████████| 17/17 [00:05<00:00,  1.47it/s]100%|██████████| 17/17 [00:05<00:00,  3.08it/s]
2025-03-09 07:00:28,775 [INFO]: 	Computing best hyperparameters for index knn.index 03/09/2025, 07:00:28
2025-03-09 07:01:06,506 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 37.7313 secs
2025-03-09 07:01:06,506 [INFO]: The best hyperparameters are: efSearch=154
2025-03-09 07:01:06,506 [INFO]: 	Compute fast metrics 03/09/2025, 07:01:06
  0%|          | 0/4 [00:00<?, ?it/s] 25%|██▌       | 1/4 [00:00<00:00,  5.88it/s] 75%|███████▌  | 3/4 [00:00<00:00,  9.39it/s] 75%|███████▌  | 3/4 [00:00<00:00,  7.15it/s]
2025-03-09 07:01:20,458 [INFO]: 	>>> Finished "Compute fast metrics" in 13.9512 secs
2025-03-09 07:01:20,460 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 57.2198 secs
2025-03-09 07:01:20,461 [INFO]: {
2025-03-09 07:01:20,461 [INFO]: 	index_key: HNSW15
2025-03-09 07:01:20,461 [INFO]: 	index_param: efSearch=154
2025-03-09 07:01:20,461 [INFO]: 	index_path: knn.index
2025-03-09 07:01:20,461 [INFO]: 	size in bytes: 836555530
2025-03-09 07:01:20,461 [INFO]: 	avg_search_speed_ms: 8.348419318187092
2025-03-09 07:01:20,461 [INFO]: 	99p_search_speed_ms: 11.688686376437545
2025-03-09 07:01:20,461 [INFO]: 	reconstruction error %: 0.0
2025-03-09 07:01:20,461 [INFO]: 	nb vectors: 4252
2025-03-09 07:01:20,461 [INFO]: 	vectors dimension: 49152
2025-03-09 07:01:20,461 [INFO]: 	compression ratio: 0.9993086962200823
2025-03-09 07:01:20,461 [INFO]: }
2025-03-09 07:01:20,461 [INFO]: 	>>> Finished "Creating the index" in 57.2213 secs
2025-03-09 07:01:20,461 [INFO]: >>> Finished "Launching the whole pipeline" in 57.2453 secs
2025-03-09 07:01:21: [retrieval_preprocessing] calculating distances ...
2025-03-09 07:01:21: [retrieval_preprocessing] finished and saved retrieval indices for episode 10902 [episode count 13/20]
[retrieval_preprocessing] for episode 35735 [episode count 14/20], we have num_retrieval=np.int64(4206) num_query=np.int64(220)
2025-03-09 07:01:22,898 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-09 07:01:23,518 [INFO]: Launching the whole pipeline 03/09/2025, 07:01:23
2025-03-09 07:01:23,518 [INFO]: Reading total number of vectors and dimension 03/09/2025, 07:01:23
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1789.38it/s]
2025-03-09 07:01:23,542 [INFO]: There are 4206 embeddings of dim 49152
2025-03-09 07:01:23,542 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0241 secs
2025-03-09 07:01:23,542 [INFO]: 	Compute estimated construction time of the index 03/09/2025, 07:01:23
2025-03-09 07:01:23,542 [INFO]: 		-> Train: 16.7 minutes
2025-03-09 07:01:23,542 [INFO]: 		-> Add: 2.3 seconds
2025-03-09 07:01:23,542 [INFO]: 		Total: 16.7 minutes
2025-03-09 07:01:23,542 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0001 secs
2025-03-09 07:01:23,543 [INFO]: 	Checking that your have enough memory available to create the index 03/09/2025, 07:01:23
2025-03-09 07:01:23,543 [INFO]: 868.0MB of memory will be needed to build the index (more might be used if you have more)
2025-03-09 07:01:23,543 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0002 secs
2025-03-09 07:01:23,543 [INFO]: 	Selecting most promising index types given data characteristics 03/09/2025, 07:01:23
2025-03-09 07:01:23,543 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-09 07:01:23,543 [INFO]: 	Creating the index 03/09/2025, 07:01:23
2025-03-09 07:01:23,543 [INFO]: 		-> Instanciate the index HNSW15 03/09/2025, 07:01:23
2025-03-09 07:01:23,544 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0010 secs
2025-03-09 07:01:23,544 [INFO]: 		-> Adding the vectors to the index 03/09/2025, 07:01:23
2025-03-09 07:01:23,544 [INFO]: The memory available for adding the vectors is 49.2GB(total available - used by the index)
2025-03-09 07:01:23,544 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/17 [00:00<?, ?it/s]  6%|▌         | 1/17 [00:00<00:03,  4.76it/s] 12%|█▏        | 2/17 [00:00<00:02,  6.10it/s] 18%|█▊        | 3/17 [00:00<00:02,  6.79it/s] 24%|██▎       | 4/17 [00:00<00:01,  7.28it/s] 29%|██▉       | 5/17 [00:00<00:01,  7.44it/s] 35%|███▌      | 6/17 [00:00<00:01,  7.65it/s] 41%|████      | 7/17 [00:00<00:01,  7.94it/s] 47%|████▋     | 8/17 [00:01<00:01,  8.14it/s] 53%|█████▎    | 9/17 [00:01<00:00,  8.30it/s] 59%|█████▉    | 10/17 [00:01<00:00,  8.29it/s] 65%|██████▍   | 11/17 [00:01<00:00,  8.27it/s] 71%|███████   | 12/17 [00:01<00:00,  8.20it/s] 76%|███████▋  | 13/17 [00:01<00:00,  8.16it/s] 82%|████████▏ | 14/17 [00:01<00:00,  8.19it/s] 88%|████████▊ | 15/17 [00:01<00:00,  8.44it/s]100%|██████████| 17/17 [00:05<00:00,  1.20it/s]100%|██████████| 17/17 [00:05<00:00,  3.25it/s]
2025-03-09 07:01:28,777 [INFO]: 	Computing best hyperparameters for index knn.index 03/09/2025, 07:01:28
2025-03-09 07:02:05,345 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 36.5675 secs
2025-03-09 07:02:05,345 [INFO]: The best hyperparameters are: efSearch=178
2025-03-09 07:02:05,345 [INFO]: 	Compute fast metrics 03/09/2025, 07:02:05
  0%|          | 0/4 [00:00<?, ?it/s] 25%|██▌       | 1/4 [00:00<00:00,  5.75it/s] 75%|███████▌  | 3/4 [00:00<00:00,  9.33it/s] 75%|███████▌  | 3/4 [00:00<00:00,  7.12it/s]
2025-03-09 07:02:18,375 [INFO]: 	>>> Finished "Compute fast metrics" in 13.0299 secs
2025-03-09 07:02:18,378 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 54.8339 secs
2025-03-09 07:02:18,378 [INFO]: {
2025-03-09 07:02:18,378 [INFO]: 	index_key: HNSW15
2025-03-09 07:02:18,378 [INFO]: 	index_param: efSearch=178
2025-03-09 07:02:18,378 [INFO]: 	index_path: knn.index
2025-03-09 07:02:18,378 [INFO]: 	size in bytes: 827505250
2025-03-09 07:02:18,378 [INFO]: 	avg_search_speed_ms: 9.452724891374968
2025-03-09 07:02:18,378 [INFO]: 	99p_search_speed_ms: 13.461603184696289
2025-03-09 07:02:18,378 [INFO]: 	reconstruction error %: 0.0
2025-03-09 07:02:18,378 [INFO]: 	nb vectors: 4206
2025-03-09 07:02:18,378 [INFO]: 	vectors dimension: 49152
2025-03-09 07:02:18,378 [INFO]: 	compression ratio: 0.9993087632978763
2025-03-09 07:02:18,378 [INFO]: }
2025-03-09 07:02:18,378 [INFO]: 	>>> Finished "Creating the index" in 54.8353 secs
2025-03-09 07:02:18,378 [INFO]: >>> Finished "Launching the whole pipeline" in 54.8602 secs
2025-03-09 07:02:19: [retrieval_preprocessing] calculating distances ...
2025-03-09 07:02:20: [retrieval_preprocessing] finished and saved retrieval indices for episode 35735 [episode count 14/20]
[retrieval_preprocessing] for episode 78744 [episode count 15/20], we have num_retrieval=np.int64(4201) num_query=np.int64(225)
2025-03-09 07:02:21,337 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-09 07:02:21,905 [INFO]: Launching the whole pipeline 03/09/2025, 07:02:21
2025-03-09 07:02:21,905 [INFO]: Reading total number of vectors and dimension 03/09/2025, 07:02:21
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1224.26it/s]
2025-03-09 07:02:21,931 [INFO]: There are 4201 embeddings of dim 49152
2025-03-09 07:02:21,931 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0258 secs
2025-03-09 07:02:21,931 [INFO]: 	Compute estimated construction time of the index 03/09/2025, 07:02:21
2025-03-09 07:02:21,931 [INFO]: 		-> Train: 16.7 minutes
2025-03-09 07:02:21,932 [INFO]: 		-> Add: 2.3 seconds
2025-03-09 07:02:21,932 [INFO]: 		Total: 16.7 minutes
2025-03-09 07:02:21,932 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0001 secs
2025-03-09 07:02:21,932 [INFO]: 	Checking that your have enough memory available to create the index 03/09/2025, 07:02:21
2025-03-09 07:02:21,932 [INFO]: 867.0MB of memory will be needed to build the index (more might be used if you have more)
2025-03-09 07:02:21,932 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0001 secs
2025-03-09 07:02:21,932 [INFO]: 	Selecting most promising index types given data characteristics 03/09/2025, 07:02:21
2025-03-09 07:02:21,932 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-09 07:02:21,932 [INFO]: 	Creating the index 03/09/2025, 07:02:21
2025-03-09 07:02:21,932 [INFO]: 		-> Instanciate the index HNSW15 03/09/2025, 07:02:21
2025-03-09 07:02:21,933 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0011 secs
2025-03-09 07:02:21,933 [INFO]: 		-> Adding the vectors to the index 03/09/2025, 07:02:21
2025-03-09 07:02:21,933 [INFO]: The memory available for adding the vectors is 49.2GB(total available - used by the index)
2025-03-09 07:02:21,933 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/17 [00:00<?, ?it/s]  6%|▌         | 1/17 [00:00<00:02,  6.18it/s] 18%|█▊        | 3/17 [00:00<00:01,  9.80it/s] 29%|██▉       | 5/17 [00:00<00:01, 10.87it/s] 41%|████      | 7/17 [00:00<00:00, 11.55it/s] 53%|█████▎    | 9/17 [00:00<00:00, 11.94it/s] 65%|██████▍   | 11/17 [00:00<00:00, 12.12it/s] 76%|███████▋  | 13/17 [00:01<00:00, 12.29it/s] 88%|████████▊ | 15/17 [00:01<00:00, 12.33it/s]100%|██████████| 17/17 [00:04<00:00,  1.80it/s]100%|██████████| 17/17 [00:04<00:00,  3.82it/s]
2025-03-09 07:02:26,391 [INFO]: 	Computing best hyperparameters for index knn.index 03/09/2025, 07:02:26
2025-03-09 07:03:02,897 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 36.5054 secs
2025-03-09 07:03:02,897 [INFO]: The best hyperparameters are: efSearch=183
2025-03-09 07:03:02,898 [INFO]: 	Compute fast metrics 03/09/2025, 07:03:02
  0%|          | 0/4 [00:00<?, ?it/s] 25%|██▌       | 1/4 [00:00<00:00,  5.43it/s] 75%|███████▌  | 3/4 [00:00<00:00,  8.95it/s] 75%|███████▌  | 3/4 [00:00<00:00,  7.01it/s]
2025-03-09 07:03:29,868 [INFO]: 	>>> Finished "Compute fast metrics" in 26.9701 secs
2025-03-09 07:03:29,870 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 67.9371 secs
2025-03-09 07:03:29,870 [INFO]: {
2025-03-09 07:03:29,870 [INFO]: 	index_key: HNSW15
2025-03-09 07:03:29,870 [INFO]: 	index_param: efSearch=183
2025-03-09 07:03:29,870 [INFO]: 	index_path: knn.index
2025-03-09 07:03:29,870 [INFO]: 	size in bytes: 826521490
2025-03-09 07:03:29,870 [INFO]: 	avg_search_speed_ms: 10.004340364364907
2025-03-09 07:03:29,870 [INFO]: 	99p_search_speed_ms: 14.548871037550269
2025-03-09 07:03:29,870 [INFO]: 	reconstruction error %: 0.0
2025-03-09 07:03:29,871 [INFO]: 	nb vectors: 4201
2025-03-09 07:03:29,871 [INFO]: 	vectors dimension: 49152
2025-03-09 07:03:29,871 [INFO]: 	compression ratio: 0.9993088116801415
2025-03-09 07:03:29,871 [INFO]: }
2025-03-09 07:03:29,871 [INFO]: 	>>> Finished "Creating the index" in 67.9386 secs
2025-03-09 07:03:29,871 [INFO]: >>> Finished "Launching the whole pipeline" in 67.9651 secs
2025-03-09 07:03:30: [retrieval_preprocessing] calculating distances ...
2025-03-09 07:03:31: [retrieval_preprocessing] finished and saved retrieval indices for episode 78744 [episode count 15/20]
[retrieval_preprocessing] for episode 81340 [episode count 16/20], we have num_retrieval=np.int64(4182) num_query=np.int64(244)
2025-03-09 07:03:32,901 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-09 07:03:33,506 [INFO]: Launching the whole pipeline 03/09/2025, 07:03:33
2025-03-09 07:03:33,506 [INFO]: Reading total number of vectors and dimension 03/09/2025, 07:03:33
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1757.14it/s]
2025-03-09 07:03:33,527 [INFO]: There are 4182 embeddings of dim 49152
2025-03-09 07:03:33,528 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0212 secs
2025-03-09 07:03:33,528 [INFO]: 	Compute estimated construction time of the index 03/09/2025, 07:03:33
2025-03-09 07:03:33,528 [INFO]: 		-> Train: 16.7 minutes
2025-03-09 07:03:33,528 [INFO]: 		-> Add: 2.3 seconds
2025-03-09 07:03:33,528 [INFO]: 		Total: 16.7 minutes
2025-03-09 07:03:33,528 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0001 secs
2025-03-09 07:03:33,528 [INFO]: 	Checking that your have enough memory available to create the index 03/09/2025, 07:03:33
2025-03-09 07:03:33,528 [INFO]: 863.1MB of memory will be needed to build the index (more might be used if you have more)
2025-03-09 07:03:33,528 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0002 secs
2025-03-09 07:03:33,528 [INFO]: 	Selecting most promising index types given data characteristics 03/09/2025, 07:03:33
2025-03-09 07:03:33,528 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-09 07:03:33,528 [INFO]: 	Creating the index 03/09/2025, 07:03:33
2025-03-09 07:03:33,528 [INFO]: 		-> Instanciate the index HNSW15 03/09/2025, 07:03:33
2025-03-09 07:03:33,529 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0009 secs
2025-03-09 07:03:33,529 [INFO]: 		-> Adding the vectors to the index 03/09/2025, 07:03:33
2025-03-09 07:03:33,529 [INFO]: The memory available for adding the vectors is 49.2GB(total available - used by the index)
2025-03-09 07:03:33,529 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/17 [00:00<?, ?it/s]  6%|▌         | 1/17 [00:00<00:02,  5.79it/s] 12%|█▏        | 2/17 [00:00<00:02,  7.43it/s] 18%|█▊        | 3/17 [00:00<00:01,  8.32it/s] 24%|██▎       | 4/17 [00:00<00:01,  8.89it/s] 35%|███▌      | 6/17 [00:00<00:01,  9.40it/s] 41%|████      | 7/17 [00:00<00:01,  9.42it/s] 47%|████▋     | 8/17 [00:00<00:00,  9.37it/s] 53%|█████▎    | 9/17 [00:01<00:00,  9.27it/s] 59%|█████▉    | 10/17 [00:01<00:00,  9.20it/s] 65%|██████▍   | 11/17 [00:01<00:00,  9.15it/s] 71%|███████   | 12/17 [00:01<00:00,  9.17it/s] 76%|███████▋  | 13/17 [00:01<00:00,  9.27it/s] 82%|████████▏ | 14/17 [00:01<00:00,  9.02it/s] 88%|████████▊ | 15/17 [00:01<00:00,  8.84it/s] 94%|█████████▍| 16/17 [00:01<00:00,  8.78it/s]100%|██████████| 17/17 [00:05<00:00,  1.19s/it]100%|██████████| 17/17 [00:05<00:00,  3.09it/s]
2025-03-09 07:03:39,039 [INFO]: 	Computing best hyperparameters for index knn.index 03/09/2025, 07:03:39
2025-03-09 07:04:16,414 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 37.3748 secs
2025-03-09 07:04:16,414 [INFO]: The best hyperparameters are: efSearch=152
2025-03-09 07:04:16,414 [INFO]: 	Compute fast metrics 03/09/2025, 07:04:16
  0%|          | 0/4 [00:00<?, ?it/s] 25%|██▌       | 1/4 [00:00<00:00,  5.68it/s] 75%|███████▌  | 3/4 [00:00<00:00,  8.49it/s] 75%|███████▌  | 3/4 [00:00<00:00,  6.59it/s]
2025-03-09 07:04:30,653 [INFO]: 	>>> Finished "Compute fast metrics" in 14.2386 secs
2025-03-09 07:04:30,656 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 57.1272 secs
2025-03-09 07:04:30,656 [INFO]: {
2025-03-09 07:04:30,656 [INFO]: 	index_key: HNSW15
2025-03-09 07:04:30,656 [INFO]: 	index_param: efSearch=152
2025-03-09 07:04:30,656 [INFO]: 	index_path: knn.index
2025-03-09 07:04:30,656 [INFO]: 	size in bytes: 822783430
2025-03-09 07:04:30,656 [INFO]: 	avg_search_speed_ms: 7.737790106438193
2025-03-09 07:04:30,656 [INFO]: 	99p_search_speed_ms: 10.519821825437248
2025-03-09 07:04:30,656 [INFO]: 	reconstruction error %: 0.0
2025-03-09 07:04:30,656 [INFO]: 	nb vectors: 4182
2025-03-09 07:04:30,656 [INFO]: 	vectors dimension: 49152
2025-03-09 07:04:30,657 [INFO]: 	compression ratio: 0.9993087196712263
2025-03-09 07:04:30,657 [INFO]: }
2025-03-09 07:04:30,657 [INFO]: 	>>> Finished "Creating the index" in 57.1285 secs
2025-03-09 07:04:30,657 [INFO]: >>> Finished "Launching the whole pipeline" in 57.1503 secs
2025-03-09 07:04:31: [retrieval_preprocessing] calculating distances ...
2025-03-09 07:04:32: [retrieval_preprocessing] finished and saved retrieval indices for episode 81340 [episode count 16/20]
[retrieval_preprocessing] for episode 89627 [episode count 17/20], we have num_retrieval=np.int64(4165) num_query=np.int64(261)
2025-03-09 07:04:33,529 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-09 07:04:34,047 [INFO]: Launching the whole pipeline 03/09/2025, 07:04:34
2025-03-09 07:04:34,047 [INFO]: Reading total number of vectors and dimension 03/09/2025, 07:04:34
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 2225.09it/s]
2025-03-09 07:04:34,070 [INFO]: There are 4165 embeddings of dim 49152
2025-03-09 07:04:34,071 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0233 secs
2025-03-09 07:04:34,071 [INFO]: 	Compute estimated construction time of the index 03/09/2025, 07:04:34
2025-03-09 07:04:34,071 [INFO]: 		-> Train: 16.7 minutes
2025-03-09 07:04:34,071 [INFO]: 		-> Add: 2.3 seconds
2025-03-09 07:04:34,071 [INFO]: 		Total: 16.7 minutes
2025-03-09 07:04:34,071 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0001 secs
2025-03-09 07:04:34,071 [INFO]: 	Checking that your have enough memory available to create the index 03/09/2025, 07:04:34
2025-03-09 07:04:34,071 [INFO]: 859.6MB of memory will be needed to build the index (more might be used if you have more)
2025-03-09 07:04:34,071 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0001 secs
2025-03-09 07:04:34,071 [INFO]: 	Selecting most promising index types given data characteristics 03/09/2025, 07:04:34
2025-03-09 07:04:34,071 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-09 07:04:34,071 [INFO]: 	Creating the index 03/09/2025, 07:04:34
2025-03-09 07:04:34,071 [INFO]: 		-> Instanciate the index HNSW15 03/09/2025, 07:04:34
2025-03-09 07:04:34,072 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0009 secs
2025-03-09 07:04:34,072 [INFO]: 		-> Adding the vectors to the index 03/09/2025, 07:04:34
2025-03-09 07:04:34,072 [INFO]: The memory available for adding the vectors is 49.2GB(total available - used by the index)
2025-03-09 07:04:34,072 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/17 [00:00<?, ?it/s]  6%|▌         | 1/17 [00:00<00:02,  5.98it/s] 12%|█▏        | 2/17 [00:00<00:01,  7.68it/s] 18%|█▊        | 3/17 [00:00<00:01,  8.46it/s] 29%|██▉       | 5/17 [00:00<00:01,  9.50it/s] 41%|████      | 7/17 [00:00<00:01,  9.52it/s] 47%|████▋     | 8/17 [00:00<00:00,  9.27it/s] 53%|█████▎    | 9/17 [00:01<00:00,  9.10it/s] 59%|█████▉    | 10/17 [00:01<00:00,  8.98it/s] 65%|██████▍   | 11/17 [00:01<00:00,  8.88it/s] 71%|███████   | 12/17 [00:01<00:00,  8.61it/s] 76%|███████▋  | 13/17 [00:01<00:00,  8.31it/s] 82%|████████▏ | 14/17 [00:01<00:00,  8.14it/s] 88%|████████▊ | 15/17 [00:01<00:00,  8.01it/s] 94%|█████████▍| 16/17 [00:01<00:00,  8.18it/s]100%|██████████| 17/17 [00:05<00:00,  1.08s/it]100%|██████████| 17/17 [00:05<00:00,  3.26it/s]
2025-03-09 07:04:39,294 [INFO]: 	Computing best hyperparameters for index knn.index 03/09/2025, 07:04:39
2025-03-09 07:05:13,700 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 34.4057 secs
2025-03-09 07:05:13,700 [INFO]: The best hyperparameters are: efSearch=188
2025-03-09 07:05:13,700 [INFO]: 	Compute fast metrics 03/09/2025, 07:05:13
  0%|          | 0/4 [00:00<?, ?it/s] 25%|██▌       | 1/4 [00:00<00:00,  5.17it/s] 50%|█████     | 2/4 [00:00<00:00,  7.00it/s] 75%|███████▌  | 3/4 [00:00<00:00,  7.75it/s] 75%|███████▌  | 3/4 [00:00<00:00,  5.88it/s]
2025-03-09 07:05:26,917 [INFO]: 	>>> Finished "Compute fast metrics" in 13.2169 secs
2025-03-09 07:05:26,920 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 52.8479 secs
2025-03-09 07:05:26,920 [INFO]: {
2025-03-09 07:05:26,920 [INFO]: 	index_key: HNSW15
2025-03-09 07:05:26,920 [INFO]: 	index_param: efSearch=188
2025-03-09 07:05:26,920 [INFO]: 	index_path: knn.index
2025-03-09 07:05:26,920 [INFO]: 	size in bytes: 819438850
2025-03-09 07:05:26,920 [INFO]: 	avg_search_speed_ms: 9.605167145992018
2025-03-09 07:05:26,920 [INFO]: 	99p_search_speed_ms: 13.66506768390536
2025-03-09 07:05:26,920 [INFO]: 	reconstruction error %: 0.0
2025-03-09 07:05:26,920 [INFO]: 	nb vectors: 4165
2025-03-09 07:05:26,920 [INFO]: 	vectors dimension: 49152
2025-03-09 07:05:26,920 [INFO]: 	compression ratio: 0.9993086366359125
2025-03-09 07:05:26,920 [INFO]: }
2025-03-09 07:05:26,920 [INFO]: 	>>> Finished "Creating the index" in 52.8492 secs
2025-03-09 07:05:26,920 [INFO]: >>> Finished "Launching the whole pipeline" in 52.8730 secs
2025-03-09 07:05:28: [retrieval_preprocessing] calculating distances ...
2025-03-09 07:05:28: [retrieval_preprocessing] finished and saved retrieval indices for episode 89627 [episode count 17/20]
[retrieval_preprocessing] for episode 36124 [episode count 18/20], we have num_retrieval=np.int64(4208) num_query=np.int64(218)
2025-03-09 07:05:30,077 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-09 07:05:30,753 [INFO]: Launching the whole pipeline 03/09/2025, 07:05:30
2025-03-09 07:05:30,753 [INFO]: Reading total number of vectors and dimension 03/09/2025, 07:05:30
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1785.57it/s]
2025-03-09 07:05:30,780 [INFO]: There are 4208 embeddings of dim 49152
2025-03-09 07:05:30,780 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0269 secs
2025-03-09 07:05:30,780 [INFO]: 	Compute estimated construction time of the index 03/09/2025, 07:05:30
2025-03-09 07:05:30,780 [INFO]: 		-> Train: 16.7 minutes
2025-03-09 07:05:30,780 [INFO]: 		-> Add: 2.3 seconds
2025-03-09 07:05:30,780 [INFO]: 		Total: 16.7 minutes
2025-03-09 07:05:30,780 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0001 secs
2025-03-09 07:05:30,780 [INFO]: 	Checking that your have enough memory available to create the index 03/09/2025, 07:05:30
2025-03-09 07:05:30,780 [INFO]: 868.4MB of memory will be needed to build the index (more might be used if you have more)
2025-03-09 07:05:30,780 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0001 secs
2025-03-09 07:05:30,780 [INFO]: 	Selecting most promising index types given data characteristics 03/09/2025, 07:05:30
2025-03-09 07:05:30,781 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-09 07:05:30,781 [INFO]: 	Creating the index 03/09/2025, 07:05:30
2025-03-09 07:05:30,781 [INFO]: 		-> Instanciate the index HNSW15 03/09/2025, 07:05:30
2025-03-09 07:05:30,782 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0009 secs
2025-03-09 07:05:30,782 [INFO]: 		-> Adding the vectors to the index 03/09/2025, 07:05:30
2025-03-09 07:05:30,782 [INFO]: The memory available for adding the vectors is 49.2GB(total available - used by the index)
2025-03-09 07:05:30,782 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/17 [00:00<?, ?it/s]  6%|▌         | 1/17 [00:00<00:03,  5.32it/s] 12%|█▏        | 2/17 [00:00<00:02,  6.78it/s] 18%|█▊        | 3/17 [00:00<00:01,  7.71it/s] 24%|██▎       | 4/17 [00:00<00:01,  8.21it/s] 29%|██▉       | 5/17 [00:00<00:01,  8.42it/s] 41%|████      | 7/17 [00:00<00:01,  9.25it/s] 53%|█████▎    | 9/17 [00:01<00:00,  9.69it/s] 65%|██████▍   | 11/17 [00:01<00:00,  9.48it/s] 71%|███████   | 12/17 [00:01<00:00,  9.26it/s] 76%|███████▋  | 13/17 [00:01<00:00,  9.00it/s] 88%|████████▊ | 15/17 [00:01<00:00, 10.56it/s]100%|██████████| 17/17 [00:04<00:00,  1.52it/s]100%|██████████| 17/17 [00:04<00:00,  3.46it/s]
2025-03-09 07:05:35,704 [INFO]: 	Computing best hyperparameters for index knn.index 03/09/2025, 07:05:35
2025-03-09 07:06:14,340 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 38.6359 secs
2025-03-09 07:06:14,341 [INFO]: The best hyperparameters are: efSearch=176
2025-03-09 07:06:14,341 [INFO]: 	Compute fast metrics 03/09/2025, 07:06:14
  0%|          | 0/4 [00:00<?, ?it/s] 25%|██▌       | 1/4 [00:00<00:01,  1.74it/s] 50%|█████     | 2/4 [00:01<00:01,  1.28it/s] 75%|███████▌  | 3/4 [00:02<00:00,  1.29it/s]
2025-03-09 07:06:31,305 [INFO]: 	>>> Finished "Compute fast metrics" in 16.9643 secs
2025-03-09 07:06:31,308 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 60.5268 secs
2025-03-09 07:06:31,309 [INFO]: {
2025-03-09 07:06:31,309 [INFO]: 	index_key: HNSW15
2025-03-09 07:06:31,309 [INFO]: 	index_param: efSearch=176
2025-03-09 07:06:31,309 [INFO]: 	index_path: knn.index
2025-03-09 07:06:31,309 [INFO]: 	size in bytes: 827898730
2025-03-09 07:06:31,309 [INFO]: 	avg_search_speed_ms: 8.534092741578169
2025-03-09 07:06:31,309 [INFO]: 	99p_search_speed_ms: 11.056993103120476
2025-03-09 07:06:31,309 [INFO]: 	reconstruction error %: 0.0
2025-03-09 07:06:31,309 [INFO]: 	nb vectors: 4208
2025-03-09 07:06:31,309 [INFO]: 	vectors dimension: 49152
2025-03-09 07:06:31,309 [INFO]: 	compression ratio: 0.999308772946179
2025-03-09 07:06:31,309 [INFO]: }
2025-03-09 07:06:31,309 [INFO]: 	>>> Finished "Creating the index" in 60.5282 secs
2025-03-09 07:06:31,309 [INFO]: >>> Finished "Launching the whole pipeline" in 60.5557 secs
2025-03-09 07:06:32: [retrieval_preprocessing] calculating distances ...
2025-03-09 07:06:33: [retrieval_preprocessing] finished and saved retrieval indices for episode 36124 [episode count 18/20]
[retrieval_preprocessing] for episode 22559 [episode count 19/20], we have num_retrieval=np.int64(4266) num_query=np.int64(160)
2025-03-09 07:06:34,128 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-09 07:06:34,686 [INFO]: Launching the whole pipeline 03/09/2025, 07:06:34
2025-03-09 07:06:34,686 [INFO]: Reading total number of vectors and dimension 03/09/2025, 07:06:34
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 2247.75it/s]
2025-03-09 07:06:34,709 [INFO]: There are 4266 embeddings of dim 49152
2025-03-09 07:06:34,710 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0235 secs
2025-03-09 07:06:34,710 [INFO]: 	Compute estimated construction time of the index 03/09/2025, 07:06:34
2025-03-09 07:06:34,710 [INFO]: 		-> Train: 16.7 minutes
2025-03-09 07:06:34,710 [INFO]: 		-> Add: 2.3 seconds
2025-03-09 07:06:34,710 [INFO]: 		Total: 16.7 minutes
2025-03-09 07:06:34,710 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0001 secs
2025-03-09 07:06:34,710 [INFO]: 	Checking that your have enough memory available to create the index 03/09/2025, 07:06:34
2025-03-09 07:06:34,710 [INFO]: 880.4MB of memory will be needed to build the index (more might be used if you have more)
2025-03-09 07:06:34,710 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0001 secs
2025-03-09 07:06:34,710 [INFO]: 	Selecting most promising index types given data characteristics 03/09/2025, 07:06:34
2025-03-09 07:06:34,710 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-09 07:06:34,710 [INFO]: 	Creating the index 03/09/2025, 07:06:34
2025-03-09 07:06:34,710 [INFO]: 		-> Instanciate the index HNSW15 03/09/2025, 07:06:34
2025-03-09 07:06:34,711 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0008 secs
2025-03-09 07:06:34,711 [INFO]: 		-> Adding the vectors to the index 03/09/2025, 07:06:34
2025-03-09 07:06:34,711 [INFO]: The memory available for adding the vectors is 49.2GB(total available - used by the index)
2025-03-09 07:06:34,711 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/17 [00:00<?, ?it/s]  6%|▌         | 1/17 [00:00<00:02,  6.45it/s] 18%|█▊        | 3/17 [00:00<00:01, 11.18it/s] 29%|██▉       | 5/17 [00:00<00:01, 10.72it/s] 41%|████      | 7/17 [00:00<00:00, 10.77it/s] 53%|█████▎    | 9/17 [00:00<00:00, 10.38it/s] 65%|██████▍   | 11/17 [00:01<00:00, 10.12it/s] 76%|███████▋  | 13/17 [00:01<00:00,  9.65it/s] 82%|████████▏ | 14/17 [00:01<00:00,  9.57it/s] 88%|████████▊ | 15/17 [00:01<00:00,  9.24it/s] 94%|█████████▍| 16/17 [00:01<00:00,  9.02it/s]100%|██████████| 17/17 [00:05<00:00,  1.01it/s]100%|██████████| 17/17 [00:05<00:00,  3.23it/s]
2025-03-09 07:06:39,984 [INFO]: 	Computing best hyperparameters for index knn.index 03/09/2025, 07:06:39
2025-03-09 07:07:25,477 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 45.4922 secs
2025-03-09 07:07:25,477 [INFO]: The best hyperparameters are: efSearch=153
2025-03-09 07:07:25,477 [INFO]: 	Compute fast metrics 03/09/2025, 07:07:25
  0%|          | 0/4 [00:00<?, ?it/s] 25%|██▌       | 1/4 [00:01<00:04,  1.38s/it] 50%|█████     | 2/4 [00:03<00:03,  1.63s/it] 75%|███████▌  | 3/4 [00:03<00:01,  1.01s/it] 75%|███████▌  | 3/4 [00:04<00:01,  1.42s/it]
2025-03-09 07:07:42,548 [INFO]: 	>>> Finished "Compute fast metrics" in 17.0712 secs
2025-03-09 07:07:42,552 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 67.8406 secs
2025-03-09 07:07:42,552 [INFO]: {
2025-03-09 07:07:42,552 [INFO]: 	index_key: HNSW15
2025-03-09 07:07:42,552 [INFO]: 	index_param: efSearch=153
2025-03-09 07:07:42,552 [INFO]: 	index_path: knn.index
2025-03-09 07:07:42,552 [INFO]: 	size in bytes: 839309890
2025-03-09 07:07:42,552 [INFO]: 	avg_search_speed_ms: 8.090414804772664
2025-03-09 07:07:42,552 [INFO]: 	99p_search_speed_ms: 11.280661541968584
2025-03-09 07:07:42,552 [INFO]: 	reconstruction error %: 0.0
2025-03-09 07:07:42,552 [INFO]: 	nb vectors: 4266
2025-03-09 07:07:42,552 [INFO]: 	vectors dimension: 49152
2025-03-09 07:07:42,552 [INFO]: 	compression ratio: 0.9993087630600898
2025-03-09 07:07:42,552 [INFO]: }
2025-03-09 07:07:42,552 [INFO]: 	>>> Finished "Creating the index" in 67.8420 secs
2025-03-09 07:07:42,552 [INFO]: >>> Finished "Launching the whole pipeline" in 67.8660 secs
2025-03-09 07:07:43: [retrieval_preprocessing] calculating distances ...
2025-03-09 07:07:43: [retrieval_preprocessing] finished and saved retrieval indices for episode 22559 [episode count 19/20]
2025-03-09 07:07:43: [retrieval_preprocessing] finished for (1461982682, 'cloth') [chosen_id count 0/10]
2025-03-09 07:07:44: [retrieval_preprocessing] concatenated all embeddings and indices for 20 episodes for (5235850418, 'block') [chosen_id count 1/10]
2025-03-09 07:07:44: [retrieval_preprocessing] we have num_total=2227 embedding_dim=49152
[retrieval_preprocessing] for episode 47105 [episode count 0/20], we have num_retrieval=np.int64(2144) num_query=np.int64(83)
2025-03-09 07:07:45,124 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-09 07:07:45,458 [INFO]: Launching the whole pipeline 03/09/2025, 07:07:45
2025-03-09 07:07:45,458 [INFO]: Reading total number of vectors and dimension 03/09/2025, 07:07:45
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1357.82it/s]
2025-03-09 07:07:45,483 [INFO]: There are 2144 embeddings of dim 49152
2025-03-09 07:07:45,483 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0253 secs
2025-03-09 07:07:45,484 [INFO]: 	Compute estimated construction time of the index 03/09/2025, 07:07:45
2025-03-09 07:07:45,484 [INFO]: 		-> Train: 16.7 minutes
2025-03-09 07:07:45,484 [INFO]: 		-> Add: 1.2 seconds
2025-03-09 07:07:45,484 [INFO]: 		Total: 16.7 minutes
2025-03-09 07:07:45,484 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0001 secs
2025-03-09 07:07:45,484 [INFO]: 	Checking that your have enough memory available to create the index 03/09/2025, 07:07:45
2025-03-09 07:07:45,484 [INFO]: 442.5MB of memory will be needed to build the index (more might be used if you have more)
2025-03-09 07:07:45,484 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0001 secs
2025-03-09 07:07:45,484 [INFO]: 	Selecting most promising index types given data characteristics 03/09/2025, 07:07:45
2025-03-09 07:07:45,484 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-09 07:07:45,484 [INFO]: 	Creating the index 03/09/2025, 07:07:45
2025-03-09 07:07:45,484 [INFO]: 		-> Instanciate the index HNSW15 03/09/2025, 07:07:45
2025-03-09 07:07:45,485 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0009 secs
2025-03-09 07:07:45,485 [INFO]: 		-> Adding the vectors to the index 03/09/2025, 07:07:45
2025-03-09 07:07:45,485 [INFO]: The memory available for adding the vectors is 49.6GB(total available - used by the index)
2025-03-09 07:07:45,485 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/9 [00:00<?, ?it/s] 11%|█         | 1/9 [00:00<00:01,  5.52it/s] 22%|██▏       | 2/9 [00:00<00:00,  7.38it/s] 33%|███▎      | 3/9 [00:00<00:00,  8.18it/s] 44%|████▍     | 4/9 [00:00<00:00,  8.66it/s] 56%|█████▌    | 5/9 [00:00<00:00,  8.95it/s] 67%|██████▋   | 6/9 [00:00<00:00,  9.19it/s] 78%|███████▊  | 7/9 [00:00<00:00,  9.17it/s]100%|██████████| 9/9 [00:02<00:00,  2.44it/s]100%|██████████| 9/9 [00:02<00:00,  3.94it/s]
2025-03-09 07:07:47,770 [INFO]: 	Computing best hyperparameters for index knn.index 03/09/2025, 07:07:47
2025-03-09 07:08:16,618 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 28.8474 secs
2025-03-09 07:08:16,618 [INFO]: The best hyperparameters are: efSearch=293
2025-03-09 07:08:16,618 [INFO]: 	Compute fast metrics 03/09/2025, 07:08:16
  0%|          | 0/4 [00:00<?, ?it/s] 25%|██▌       | 1/4 [00:01<00:04,  1.55s/it] 50%|█████     | 2/4 [00:02<00:01,  1.02it/s] 75%|███████▌  | 3/4 [00:02<00:00,  1.33it/s] 75%|███████▌  | 3/4 [00:02<00:00,  1.11it/s]
2025-03-09 07:08:34,219 [INFO]: 	>>> Finished "Compute fast metrics" in 17.6002 secs
2025-03-09 07:08:34,220 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 48.7354 secs
2025-03-09 07:08:34,221 [INFO]: {
2025-03-09 07:08:34,221 [INFO]: 	index_key: HNSW15
2025-03-09 07:08:34,221 [INFO]: 	index_param: efSearch=293
2025-03-09 07:08:34,221 [INFO]: 	index_path: knn.index
2025-03-09 07:08:34,221 [INFO]: 	size in bytes: 421818970
2025-03-09 07:08:34,221 [INFO]: 	avg_search_speed_ms: 10.896372884787896
2025-03-09 07:08:34,221 [INFO]: 	99p_search_speed_ms: 17.089056235272455
2025-03-09 07:08:34,221 [INFO]: 	reconstruction error %: 0.0
2025-03-09 07:08:34,221 [INFO]: 	nb vectors: 2144
2025-03-09 07:08:34,221 [INFO]: 	vectors dimension: 49152
2025-03-09 07:08:34,221 [INFO]: 	compression ratio: 0.9993091396529653
2025-03-09 07:08:34,221 [INFO]: }
2025-03-09 07:08:34,221 [INFO]: 	>>> Finished "Creating the index" in 48.7368 secs
2025-03-09 07:08:34,221 [INFO]: >>> Finished "Launching the whole pipeline" in 48.7627 secs
2025-03-09 07:08:34: [retrieval_preprocessing] calculating distances ...
2025-03-09 07:08:35: [retrieval_preprocessing] finished and saved retrieval indices for episode 47105 [episode count 0/20]
[retrieval_preprocessing] for episode 62470 [episode count 1/20], we have num_retrieval=np.int64(2129) num_query=np.int64(98)
2025-03-09 07:08:35,799 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-09 07:08:36,090 [INFO]: Launching the whole pipeline 03/09/2025, 07:08:36
2025-03-09 07:08:36,090 [INFO]: Reading total number of vectors and dimension 03/09/2025, 07:08:36
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 2331.46it/s]
2025-03-09 07:08:36,115 [INFO]: There are 2129 embeddings of dim 49152
2025-03-09 07:08:36,116 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0257 secs
2025-03-09 07:08:36,116 [INFO]: 	Compute estimated construction time of the index 03/09/2025, 07:08:36
2025-03-09 07:08:36,116 [INFO]: 		-> Train: 16.7 minutes
2025-03-09 07:08:36,116 [INFO]: 		-> Add: 1.2 seconds
2025-03-09 07:08:36,116 [INFO]: 		Total: 16.7 minutes
2025-03-09 07:08:36,116 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0003 secs
2025-03-09 07:08:36,116 [INFO]: 	Checking that your have enough memory available to create the index 03/09/2025, 07:08:36
2025-03-09 07:08:36,117 [INFO]: 439.4MB of memory will be needed to build the index (more might be used if you have more)
2025-03-09 07:08:36,117 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0004 secs
2025-03-09 07:08:36,117 [INFO]: 	Selecting most promising index types given data characteristics 03/09/2025, 07:08:36
2025-03-09 07:08:36,117 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-09 07:08:36,117 [INFO]: 	Creating the index 03/09/2025, 07:08:36
2025-03-09 07:08:36,117 [INFO]: 		-> Instanciate the index HNSW15 03/09/2025, 07:08:36
2025-03-09 07:08:36,120 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0026 secs
2025-03-09 07:08:36,120 [INFO]: 		-> Adding the vectors to the index 03/09/2025, 07:08:36
2025-03-09 07:08:36,120 [INFO]: The memory available for adding the vectors is 49.6GB(total available - used by the index)
2025-03-09 07:08:36,121 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/9 [00:00<?, ?it/s] 11%|█         | 1/9 [00:00<00:00,  9.25it/s] 33%|███▎      | 3/9 [00:00<00:00, 15.02it/s] 56%|█████▌    | 5/9 [00:00<00:00, 15.79it/s] 78%|███████▊  | 7/9 [00:00<00:00, 15.79it/s]100%|██████████| 9/9 [00:01<00:00,  3.31it/s]100%|██████████| 9/9 [00:01<00:00,  4.85it/s]
2025-03-09 07:08:37,981 [INFO]: 	Computing best hyperparameters for index knn.index 03/09/2025, 07:08:37
2025-03-09 07:09:05,031 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 27.0499 secs
2025-03-09 07:09:05,032 [INFO]: The best hyperparameters are: efSearch=263
2025-03-09 07:09:05,032 [INFO]: 	Compute fast metrics 03/09/2025, 07:09:05
  0%|          | 0/4 [00:00<?, ?it/s] 25%|██▌       | 1/4 [00:00<00:02,  1.50it/s] 50%|█████     | 2/4 [00:02<00:03,  1.55s/it] 75%|███████▌  | 3/4 [00:03<00:01,  1.14s/it]
2025-03-09 07:09:22,212 [INFO]: 	>>> Finished "Compute fast metrics" in 17.1805 secs
2025-03-09 07:09:22,214 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 46.0934 secs
2025-03-09 07:09:22,214 [INFO]: {
2025-03-09 07:09:22,214 [INFO]: 	index_key: HNSW15
2025-03-09 07:09:22,214 [INFO]: 	index_param: efSearch=263
2025-03-09 07:09:22,214 [INFO]: 	index_path: knn.index
2025-03-09 07:09:22,214 [INFO]: 	size in bytes: 418867750
2025-03-09 07:09:22,214 [INFO]: 	avg_search_speed_ms: 9.806847008511278
2025-03-09 07:09:22,214 [INFO]: 	99p_search_speed_ms: 14.897682929877183
2025-03-09 07:09:22,214 [INFO]: 	reconstruction error %: 0.0
2025-03-09 07:09:22,214 [INFO]: 	nb vectors: 2129
2025-03-09 07:09:22,214 [INFO]: 	vectors dimension: 49152
2025-03-09 07:09:22,214 [INFO]: 	compression ratio: 0.9993092855680582
2025-03-09 07:09:22,214 [INFO]: }
2025-03-09 07:09:22,214 [INFO]: 	>>> Finished "Creating the index" in 46.0968 secs
2025-03-09 07:09:22,214 [INFO]: >>> Finished "Launching the whole pipeline" in 46.1241 secs
2025-03-09 07:09:22: [retrieval_preprocessing] calculating distances ...
2025-03-09 07:09:23: [retrieval_preprocessing] finished and saved retrieval indices for episode 62470 [episode count 1/20]
[retrieval_preprocessing] for episode 95238 [episode count 2/20], we have num_retrieval=np.int64(2130) num_query=np.int64(97)
2025-03-09 07:09:24,145 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-09 07:09:24,461 [INFO]: Launching the whole pipeline 03/09/2025, 07:09:24
2025-03-09 07:09:24,462 [INFO]: Reading total number of vectors and dimension 03/09/2025, 07:09:24
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 822.25it/s]
2025-03-09 07:09:24,487 [INFO]: There are 2130 embeddings of dim 49152
2025-03-09 07:09:24,487 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0259 secs
2025-03-09 07:09:24,487 [INFO]: 	Compute estimated construction time of the index 03/09/2025, 07:09:24
2025-03-09 07:09:24,488 [INFO]: 		-> Train: 16.7 minutes
2025-03-09 07:09:24,488 [INFO]: 		-> Add: 1.2 seconds
2025-03-09 07:09:24,488 [INFO]: 		Total: 16.7 minutes
2025-03-09 07:09:24,488 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0001 secs
2025-03-09 07:09:24,488 [INFO]: 	Checking that your have enough memory available to create the index 03/09/2025, 07:09:24
2025-03-09 07:09:24,488 [INFO]: 439.6MB of memory will be needed to build the index (more might be used if you have more)
2025-03-09 07:09:24,488 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0003 secs
2025-03-09 07:09:24,488 [INFO]: 	Selecting most promising index types given data characteristics 03/09/2025, 07:09:24
2025-03-09 07:09:24,488 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-09 07:09:24,488 [INFO]: 	Creating the index 03/09/2025, 07:09:24
2025-03-09 07:09:24,488 [INFO]: 		-> Instanciate the index HNSW15 03/09/2025, 07:09:24
2025-03-09 07:09:24,490 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0013 secs
2025-03-09 07:09:24,490 [INFO]: 		-> Adding the vectors to the index 03/09/2025, 07:09:24
2025-03-09 07:09:24,490 [INFO]: The memory available for adding the vectors is 49.6GB(total available - used by the index)
2025-03-09 07:09:24,490 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/9 [00:00<?, ?it/s] 11%|█         | 1/9 [00:00<00:01,  6.64it/s] 33%|███▎      | 3/9 [00:00<00:00, 11.47it/s] 56%|█████▌    | 5/9 [00:00<00:00, 14.06it/s] 78%|███████▊  | 7/9 [00:00<00:00, 14.83it/s]100%|██████████| 9/9 [00:02<00:00,  2.75it/s]100%|██████████| 9/9 [00:02<00:00,  4.04it/s]
2025-03-09 07:09:26,719 [INFO]: 	Computing best hyperparameters for index knn.index 03/09/2025, 07:09:26
2025-03-09 07:09:53,858 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 27.1385 secs
2025-03-09 07:09:53,858 [INFO]: The best hyperparameters are: efSearch=236
2025-03-09 07:09:53,858 [INFO]: 	Compute fast metrics 03/09/2025, 07:09:53
  0%|          | 0/4 [00:00<?, ?it/s] 25%|██▌       | 1/4 [00:00<00:00,  5.11it/s] 50%|█████     | 2/4 [00:00<00:00,  6.53it/s] 75%|███████▌  | 3/4 [00:00<00:00,  7.30it/s] 75%|███████▌  | 3/4 [00:00<00:00,  5.62it/s]
2025-03-09 07:10:06,661 [INFO]: 	>>> Finished "Compute fast metrics" in 12.8030 secs
2025-03-09 07:10:06,663 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 42.1732 secs
2025-03-09 07:10:06,663 [INFO]: {
2025-03-09 07:10:06,663 [INFO]: 	index_key: HNSW15
2025-03-09 07:10:06,663 [INFO]: 	index_param: efSearch=236
2025-03-09 07:10:06,663 [INFO]: 	index_path: knn.index
2025-03-09 07:10:06,663 [INFO]: 	size in bytes: 419064490
2025-03-09 07:10:06,663 [INFO]: 	avg_search_speed_ms: 9.770604860250387
2025-03-09 07:10:06,663 [INFO]: 	99p_search_speed_ms: 16.669928140472614
2025-03-09 07:10:06,663 [INFO]: 	reconstruction error %: 0.0
2025-03-09 07:10:06,663 [INFO]: 	nb vectors: 2130
2025-03-09 07:10:06,663 [INFO]: 	vectors dimension: 49152
2025-03-09 07:10:06,663 [INFO]: 	compression ratio: 0.9993092948534007
2025-03-09 07:10:06,663 [INFO]: }
2025-03-09 07:10:06,663 [INFO]: 	>>> Finished "Creating the index" in 42.1750 secs
2025-03-09 07:10:06,663 [INFO]: >>> Finished "Launching the whole pipeline" in 42.2017 secs
2025-03-09 07:10:07: [retrieval_preprocessing] calculating distances ...
2025-03-09 07:10:07: [retrieval_preprocessing] finished and saved retrieval indices for episode 95238 [episode count 2/20]
[retrieval_preprocessing] for episode 35852 [episode count 3/20], we have num_retrieval=np.int64(2129) num_query=np.int64(98)
2025-03-09 07:10:07,960 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-09 07:10:08,237 [INFO]: Launching the whole pipeline 03/09/2025, 07:10:08
2025-03-09 07:10:08,237 [INFO]: Reading total number of vectors and dimension 03/09/2025, 07:10:08
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1077.40it/s]
2025-03-09 07:10:08,263 [INFO]: There are 2129 embeddings of dim 49152
2025-03-09 07:10:08,263 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0258 secs
2025-03-09 07:10:08,263 [INFO]: 	Compute estimated construction time of the index 03/09/2025, 07:10:08
2025-03-09 07:10:08,263 [INFO]: 		-> Train: 16.7 minutes
2025-03-09 07:10:08,263 [INFO]: 		-> Add: 1.2 seconds
2025-03-09 07:10:08,263 [INFO]: 		Total: 16.7 minutes
2025-03-09 07:10:08,263 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0002 secs
2025-03-09 07:10:08,263 [INFO]: 	Checking that your have enough memory available to create the index 03/09/2025, 07:10:08
2025-03-09 07:10:08,263 [INFO]: 439.4MB of memory will be needed to build the index (more might be used if you have more)
2025-03-09 07:10:08,263 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0001 secs
2025-03-09 07:10:08,263 [INFO]: 	Selecting most promising index types given data characteristics 03/09/2025, 07:10:08
2025-03-09 07:10:08,263 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-09 07:10:08,263 [INFO]: 	Creating the index 03/09/2025, 07:10:08
2025-03-09 07:10:08,264 [INFO]: 		-> Instanciate the index HNSW15 03/09/2025, 07:10:08
2025-03-09 07:10:08,264 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0009 secs
2025-03-09 07:10:08,265 [INFO]: 		-> Adding the vectors to the index 03/09/2025, 07:10:08
2025-03-09 07:10:08,265 [INFO]: The memory available for adding the vectors is 49.6GB(total available - used by the index)
2025-03-09 07:10:08,265 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/9 [00:00<?, ?it/s] 11%|█         | 1/9 [00:00<00:00,  8.33it/s] 33%|███▎      | 3/9 [00:00<00:00, 13.77it/s] 56%|█████▌    | 5/9 [00:00<00:00, 15.57it/s] 78%|███████▊  | 7/9 [00:00<00:00, 16.47it/s]100%|██████████| 9/9 [00:01<00:00,  3.35it/s]100%|██████████| 9/9 [00:01<00:00,  4.88it/s]
2025-03-09 07:10:10,110 [INFO]: 	Computing best hyperparameters for index knn.index 03/09/2025, 07:10:10
2025-03-09 07:10:40,147 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 30.0365 secs
2025-03-09 07:10:40,147 [INFO]: The best hyperparameters are: efSearch=272
2025-03-09 07:10:40,147 [INFO]: 	Compute fast metrics 03/09/2025, 07:10:40
  0%|          | 0/4 [00:00<?, ?it/s] 25%|██▌       | 1/4 [00:00<00:00,  5.66it/s] 50%|█████     | 2/4 [00:00<00:00,  6.93it/s] 75%|███████▌  | 3/4 [00:00<00:00,  7.48it/s] 75%|███████▌  | 3/4 [00:00<00:00,  5.68it/s]
2025-03-09 07:10:53,738 [INFO]: 	>>> Finished "Compute fast metrics" in 13.5908 secs
2025-03-09 07:10:53,740 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 45.4752 secs
2025-03-09 07:10:53,740 [INFO]: {
2025-03-09 07:10:53,740 [INFO]: 	index_key: HNSW15
2025-03-09 07:10:53,740 [INFO]: 	index_param: efSearch=272
2025-03-09 07:10:53,740 [INFO]: 	index_path: knn.index
2025-03-09 07:10:53,740 [INFO]: 	size in bytes: 418867750
2025-03-09 07:10:53,740 [INFO]: 	avg_search_speed_ms: 10.623459078967334
2025-03-09 07:10:53,740 [INFO]: 	99p_search_speed_ms: 18.876267364248633
2025-03-09 07:10:53,740 [INFO]: 	reconstruction error %: 0.0
2025-03-09 07:10:53,740 [INFO]: 	nb vectors: 2129
2025-03-09 07:10:53,740 [INFO]: 	vectors dimension: 49152
2025-03-09 07:10:53,740 [INFO]: 	compression ratio: 0.9993092855680582
2025-03-09 07:10:53,740 [INFO]: }
2025-03-09 07:10:53,740 [INFO]: 	>>> Finished "Creating the index" in 45.4766 secs
2025-03-09 07:10:53,740 [INFO]: >>> Finished "Launching the whole pipeline" in 45.5031 secs
2025-03-09 07:10:54: [retrieval_preprocessing] calculating distances ...
2025-03-09 07:10:54: [retrieval_preprocessing] finished and saved retrieval indices for episode 35852 [episode count 3/20]
[retrieval_preprocessing] for episode 21025 [episode count 4/20], we have num_retrieval=np.int64(2137) num_query=np.int64(90)
2025-03-09 07:10:55,975 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-09 07:10:56,379 [INFO]: Launching the whole pipeline 03/09/2025, 07:10:56
2025-03-09 07:10:56,380 [INFO]: Reading total number of vectors and dimension 03/09/2025, 07:10:56
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1608.86it/s]
2025-03-09 07:10:56,406 [INFO]: There are 2137 embeddings of dim 49152
2025-03-09 07:10:56,406 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0262 secs
2025-03-09 07:10:56,406 [INFO]: 	Compute estimated construction time of the index 03/09/2025, 07:10:56
2025-03-09 07:10:56,406 [INFO]: 		-> Train: 16.7 minutes
2025-03-09 07:10:56,406 [INFO]: 		-> Add: 1.2 seconds
2025-03-09 07:10:56,406 [INFO]: 		Total: 16.7 minutes
2025-03-09 07:10:56,406 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0001 secs
2025-03-09 07:10:56,406 [INFO]: 	Checking that your have enough memory available to create the index 03/09/2025, 07:10:56
2025-03-09 07:10:56,406 [INFO]: 441.0MB of memory will be needed to build the index (more might be used if you have more)
2025-03-09 07:10:56,406 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0002 secs
2025-03-09 07:10:56,406 [INFO]: 	Selecting most promising index types given data characteristics 03/09/2025, 07:10:56
2025-03-09 07:10:56,406 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-09 07:10:56,406 [INFO]: 	Creating the index 03/09/2025, 07:10:56
2025-03-09 07:10:56,406 [INFO]: 		-> Instanciate the index HNSW15 03/09/2025, 07:10:56
2025-03-09 07:10:56,408 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0011 secs
2025-03-09 07:10:56,408 [INFO]: 		-> Adding the vectors to the index 03/09/2025, 07:10:56
2025-03-09 07:10:56,408 [INFO]: The memory available for adding the vectors is 49.6GB(total available - used by the index)
2025-03-09 07:10:56,408 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/9 [00:00<?, ?it/s] 11%|█         | 1/9 [00:00<00:01,  4.87it/s] 22%|██▏       | 2/9 [00:00<00:01,  6.27it/s] 33%|███▎      | 3/9 [00:00<00:00,  6.77it/s] 44%|████▍     | 4/9 [00:00<00:00,  7.19it/s] 56%|█████▌    | 5/9 [00:00<00:00,  7.44it/s] 67%|██████▋   | 6/9 [00:00<00:00,  7.64it/s] 78%|███████▊  | 7/9 [00:00<00:00,  7.76it/s] 89%|████████▉ | 8/9 [00:01<00:00,  7.85it/s]100%|██████████| 9/9 [00:02<00:00,  1.75it/s]100%|██████████| 9/9 [00:02<00:00,  3.41it/s]
2025-03-09 07:10:59,049 [INFO]: 	Computing best hyperparameters for index knn.index 03/09/2025, 07:10:59
2025-03-09 07:11:24,610 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 25.5606 secs
2025-03-09 07:11:24,610 [INFO]: The best hyperparameters are: efSearch=254
2025-03-09 07:11:24,610 [INFO]: 	Compute fast metrics 03/09/2025, 07:11:24
  0%|          | 0/4 [00:00<?, ?it/s] 25%|██▌       | 1/4 [00:00<00:00,  5.91it/s] 75%|███████▌  | 3/4 [00:00<00:00,  9.45it/s] 75%|███████▌  | 3/4 [00:00<00:00,  7.17it/s]
2025-03-09 07:11:37,347 [INFO]: 	>>> Finished "Compute fast metrics" in 12.7364 secs
2025-03-09 07:11:37,348 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 40.9406 secs
2025-03-09 07:11:37,349 [INFO]: {
2025-03-09 07:11:37,349 [INFO]: 	index_key: HNSW15
2025-03-09 07:11:37,349 [INFO]: 	index_param: efSearch=254
2025-03-09 07:11:37,349 [INFO]: 	index_path: knn.index
2025-03-09 07:11:37,349 [INFO]: 	size in bytes: 420441790
2025-03-09 07:11:37,349 [INFO]: 	avg_search_speed_ms: 10.07123826698129
2025-03-09 07:11:37,349 [INFO]: 	99p_search_speed_ms: 18.500792225822828
2025-03-09 07:11:37,349 [INFO]: 	reconstruction error %: 0.0
2025-03-09 07:11:37,349 [INFO]: 	nb vectors: 2137
2025-03-09 07:11:37,349 [INFO]: 	vectors dimension: 49152
2025-03-09 07:11:37,349 [INFO]: 	compression ratio: 0.9993090743905357
2025-03-09 07:11:37,349 [INFO]: }
2025-03-09 07:11:37,349 [INFO]: 	>>> Finished "Creating the index" in 40.9423 secs
2025-03-09 07:11:37,349 [INFO]: >>> Finished "Launching the whole pipeline" in 40.9691 secs
2025-03-09 07:11:38: [retrieval_preprocessing] calculating distances ...
2025-03-09 07:11:38: [retrieval_preprocessing] finished and saved retrieval indices for episode 21025 [episode count 4/20]
[retrieval_preprocessing] for episode 91171 [episode count 5/20], we have num_retrieval=np.int64(2126) num_query=np.int64(101)
2025-03-09 07:11:39,295 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-09 07:11:39,649 [INFO]: Launching the whole pipeline 03/09/2025, 07:11:39
2025-03-09 07:11:39,649 [INFO]: Reading total number of vectors and dimension 03/09/2025, 07:11:39
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1290.56it/s]
2025-03-09 07:11:39,677 [INFO]: There are 2126 embeddings of dim 49152
2025-03-09 07:11:39,677 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0283 secs
2025-03-09 07:11:39,678 [INFO]: 	Compute estimated construction time of the index 03/09/2025, 07:11:39
2025-03-09 07:11:39,678 [INFO]: 		-> Train: 16.7 minutes
2025-03-09 07:11:39,678 [INFO]: 		-> Add: 1.2 seconds
2025-03-09 07:11:39,678 [INFO]: 		Total: 16.7 minutes
2025-03-09 07:11:39,678 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0004 secs
2025-03-09 07:11:39,678 [INFO]: 	Checking that your have enough memory available to create the index 03/09/2025, 07:11:39
2025-03-09 07:11:39,678 [INFO]: 438.8MB of memory will be needed to build the index (more might be used if you have more)
2025-03-09 07:11:39,679 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0004 secs
2025-03-09 07:11:39,679 [INFO]: 	Selecting most promising index types given data characteristics 03/09/2025, 07:11:39
2025-03-09 07:11:39,679 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-09 07:11:39,679 [INFO]: 	Creating the index 03/09/2025, 07:11:39
2025-03-09 07:11:39,679 [INFO]: 		-> Instanciate the index HNSW15 03/09/2025, 07:11:39
2025-03-09 07:11:39,682 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0025 secs
2025-03-09 07:11:39,682 [INFO]: 		-> Adding the vectors to the index 03/09/2025, 07:11:39
2025-03-09 07:11:39,682 [INFO]: The memory available for adding the vectors is 49.6GB(total available - used by the index)
2025-03-09 07:11:39,682 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/9 [00:00<?, ?it/s] 11%|█         | 1/9 [00:00<00:01,  5.35it/s] 22%|██▏       | 2/9 [00:00<00:01,  6.39it/s] 33%|███▎      | 3/9 [00:00<00:00,  6.79it/s] 44%|████▍     | 4/9 [00:00<00:00,  7.12it/s] 56%|█████▌    | 5/9 [00:00<00:00,  7.11it/s] 67%|██████▋   | 6/9 [00:00<00:00,  7.03it/s] 78%|███████▊  | 7/9 [00:01<00:00,  6.91it/s] 89%|████████▉ | 8/9 [00:01<00:00,  6.86it/s]100%|██████████| 9/9 [00:02<00:00,  1.74it/s]100%|██████████| 9/9 [00:02<00:00,  3.34it/s]
2025-03-09 07:11:42,383 [INFO]: 	Computing best hyperparameters for index knn.index 03/09/2025, 07:11:42
2025-03-09 07:12:12,280 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 29.8969 secs
2025-03-09 07:12:12,280 [INFO]: The best hyperparameters are: efSearch=280
2025-03-09 07:12:12,280 [INFO]: 	Compute fast metrics 03/09/2025, 07:12:12
  0%|          | 0/4 [00:00<?, ?it/s] 25%|██▌       | 1/4 [00:01<00:03,  1.17s/it] 50%|█████     | 2/4 [00:02<00:02,  1.19s/it] 75%|███████▌  | 3/4 [00:03<00:01,  1.18s/it] 75%|███████▌  | 3/4 [00:04<00:01,  1.55s/it]
2025-03-09 07:12:29,114 [INFO]: 	>>> Finished "Compute fast metrics" in 16.8332 secs
2025-03-09 07:12:29,115 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 49.4333 secs
2025-03-09 07:12:29,115 [INFO]: {
2025-03-09 07:12:29,115 [INFO]: 	index_key: HNSW15
2025-03-09 07:12:29,115 [INFO]: 	index_param: efSearch=280
2025-03-09 07:12:29,115 [INFO]: 	index_path: knn.index
2025-03-09 07:12:29,115 [INFO]: 	size in bytes: 418277530
2025-03-09 07:12:29,115 [INFO]: 	avg_search_speed_ms: 10.517196181856026
2025-03-09 07:12:29,115 [INFO]: 	99p_search_speed_ms: 14.93725343607366
2025-03-09 07:12:29,116 [INFO]: 	reconstruction error %: 0.0
2025-03-09 07:12:29,116 [INFO]: 	nb vectors: 2126
2025-03-09 07:12:29,116 [INFO]: 	vectors dimension: 49152
2025-03-09 07:12:29,116 [INFO]: 	compression ratio: 0.9993092576596213
2025-03-09 07:12:29,116 [INFO]: }
2025-03-09 07:12:29,116 [INFO]: 	>>> Finished "Creating the index" in 49.4365 secs
2025-03-09 07:12:29,116 [INFO]: >>> Finished "Launching the whole pipeline" in 49.4667 secs
2025-03-09 07:12:29: [retrieval_preprocessing] calculating distances ...
2025-03-09 07:12:30: [retrieval_preprocessing] finished and saved retrieval indices for episode 91171 [episode count 5/20]
[retrieval_preprocessing] for episode 11313 [episode count 6/20], we have num_retrieval=np.int64(2051) num_query=np.int64(176)
2025-03-09 07:12:30,639 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-09 07:12:31,035 [INFO]: Launching the whole pipeline 03/09/2025, 07:12:31
2025-03-09 07:12:31,035 [INFO]: Reading total number of vectors and dimension 03/09/2025, 07:12:31
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1535.81it/s]
2025-03-09 07:12:31,059 [INFO]: There are 2051 embeddings of dim 49152
2025-03-09 07:12:31,059 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0237 secs
2025-03-09 07:12:31,059 [INFO]: 	Compute estimated construction time of the index 03/09/2025, 07:12:31
2025-03-09 07:12:31,059 [INFO]: 		-> Train: 16.7 minutes
2025-03-09 07:12:31,059 [INFO]: 		-> Add: 1.1 seconds
2025-03-09 07:12:31,059 [INFO]: 		Total: 16.7 minutes
2025-03-09 07:12:31,059 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0001 secs
2025-03-09 07:12:31,059 [INFO]: 	Checking that your have enough memory available to create the index 03/09/2025, 07:12:31
2025-03-09 07:12:31,059 [INFO]: 423.3MB of memory will be needed to build the index (more might be used if you have more)
2025-03-09 07:12:31,060 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0001 secs
2025-03-09 07:12:31,060 [INFO]: 	Selecting most promising index types given data characteristics 03/09/2025, 07:12:31
2025-03-09 07:12:31,060 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-09 07:12:31,060 [INFO]: 	Creating the index 03/09/2025, 07:12:31
2025-03-09 07:12:31,060 [INFO]: 		-> Instanciate the index HNSW15 03/09/2025, 07:12:31
2025-03-09 07:12:31,060 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0008 secs
2025-03-09 07:12:31,061 [INFO]: 		-> Adding the vectors to the index 03/09/2025, 07:12:31
2025-03-09 07:12:31,061 [INFO]: The memory available for adding the vectors is 49.6GB(total available - used by the index)
2025-03-09 07:12:31,061 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/9 [00:00<?, ?it/s] 11%|█         | 1/9 [00:00<00:01,  5.13it/s] 22%|██▏       | 2/9 [00:00<00:01,  6.68it/s] 33%|███▎      | 3/9 [00:00<00:00,  7.39it/s] 44%|████▍     | 4/9 [00:00<00:00,  7.84it/s] 67%|██████▋   | 6/9 [00:00<00:00,  8.76it/s] 78%|███████▊  | 7/9 [00:00<00:00,  8.68it/s] 89%|████████▉ | 8/9 [00:00<00:00,  8.63it/s]100%|██████████| 9/9 [00:02<00:00,  2.25it/s]100%|██████████| 9/9 [00:02<00:00,  4.00it/s]
2025-03-09 07:12:33,311 [INFO]: 	Computing best hyperparameters for index knn.index 03/09/2025, 07:12:33
2025-03-09 07:12:55,190 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 21.8785 secs
2025-03-09 07:12:55,190 [INFO]: The best hyperparameters are: efSearch=272
2025-03-09 07:12:55,190 [INFO]: 	Compute fast metrics 03/09/2025, 07:12:55
  0%|          | 0/4 [00:00<?, ?it/s] 25%|██▌       | 1/4 [00:00<00:00,  6.29it/s] 75%|███████▌  | 3/4 [00:00<00:00,  9.85it/s] 75%|███████▌  | 3/4 [00:00<00:00,  7.54it/s]
2025-03-09 07:13:08,541 [INFO]: 	>>> Finished "Compute fast metrics" in 13.3511 secs
2025-03-09 07:13:08,543 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 37.4821 secs
2025-03-09 07:13:08,543 [INFO]: {
2025-03-09 07:13:08,543 [INFO]: 	index_key: HNSW15
2025-03-09 07:13:08,543 [INFO]: 	index_param: efSearch=272
2025-03-09 07:13:08,543 [INFO]: 	index_path: knn.index
2025-03-09 07:13:08,543 [INFO]: 	size in bytes: 403521910
2025-03-09 07:13:08,543 [INFO]: 	avg_search_speed_ms: 10.49481115205231
2025-03-09 07:13:08,543 [INFO]: 	99p_search_speed_ms: 18.38698162697256
2025-03-09 07:13:08,543 [INFO]: 	reconstruction error %: 0.0
2025-03-09 07:13:08,543 [INFO]: 	nb vectors: 2051
2025-03-09 07:13:08,543 [INFO]: 	vectors dimension: 49152
2025-03-09 07:13:08,543 [INFO]: 	compression ratio: 0.999308830591132
2025-03-09 07:13:08,543 [INFO]: }
2025-03-09 07:13:08,543 [INFO]: 	>>> Finished "Creating the index" in 37.4833 secs
2025-03-09 07:13:08,543 [INFO]: >>> Finished "Launching the whole pipeline" in 37.5075 secs
2025-03-09 07:13:09: [retrieval_preprocessing] calculating distances ...
2025-03-09 07:13:10: [retrieval_preprocessing] finished and saved retrieval indices for episode 11313 [episode count 6/20]
[retrieval_preprocessing] for episode 59958 [episode count 7/20], we have num_retrieval=np.int64(2103) num_query=np.int64(124)
2025-03-09 07:13:10,865 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-09 07:13:11,169 [INFO]: Launching the whole pipeline 03/09/2025, 07:13:11
2025-03-09 07:13:11,169 [INFO]: Reading total number of vectors and dimension 03/09/2025, 07:13:11
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1998.24it/s]
2025-03-09 07:13:11,192 [INFO]: There are 2103 embeddings of dim 49152
2025-03-09 07:13:11,193 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0234 secs
2025-03-09 07:13:11,193 [INFO]: 	Compute estimated construction time of the index 03/09/2025, 07:13:11
2025-03-09 07:13:11,193 [INFO]: 		-> Train: 16.7 minutes
2025-03-09 07:13:11,193 [INFO]: 		-> Add: 1.2 seconds
2025-03-09 07:13:11,193 [INFO]: 		Total: 16.7 minutes
2025-03-09 07:13:11,193 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0001 secs
2025-03-09 07:13:11,193 [INFO]: 	Checking that your have enough memory available to create the index 03/09/2025, 07:13:11
2025-03-09 07:13:11,193 [INFO]: 434.0MB of memory will be needed to build the index (more might be used if you have more)
2025-03-09 07:13:11,193 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0001 secs
2025-03-09 07:13:11,193 [INFO]: 	Selecting most promising index types given data characteristics 03/09/2025, 07:13:11
2025-03-09 07:13:11,193 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-09 07:13:11,193 [INFO]: 	Creating the index 03/09/2025, 07:13:11
2025-03-09 07:13:11,193 [INFO]: 		-> Instanciate the index HNSW15 03/09/2025, 07:13:11
2025-03-09 07:13:11,194 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0008 secs
2025-03-09 07:13:11,194 [INFO]: 		-> Adding the vectors to the index 03/09/2025, 07:13:11
2025-03-09 07:13:11,194 [INFO]: The memory available for adding the vectors is 49.6GB(total available - used by the index)
2025-03-09 07:13:11,194 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/9 [00:00<?, ?it/s] 11%|█         | 1/9 [00:00<00:01,  5.46it/s] 33%|███▎      | 3/9 [00:00<00:00,  7.77it/s] 44%|████▍     | 4/9 [00:00<00:00,  8.22it/s] 56%|█████▌    | 5/9 [00:00<00:00,  8.68it/s] 67%|██████▋   | 6/9 [00:00<00:00,  8.68it/s] 78%|███████▊  | 7/9 [00:00<00:00,  8.72it/s] 89%|████████▉ | 8/9 [00:00<00:00,  8.94it/s]100%|██████████| 9/9 [00:02<00:00,  2.04it/s]100%|██████████| 9/9 [00:02<00:00,  3.92it/s]
2025-03-09 07:13:13,491 [INFO]: 	Computing best hyperparameters for index knn.index 03/09/2025, 07:13:13
2025-03-09 07:13:41,494 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 28.0023 secs
2025-03-09 07:13:41,494 [INFO]: The best hyperparameters are: efSearch=292
2025-03-09 07:13:41,494 [INFO]: 	Compute fast metrics 03/09/2025, 07:13:41
  0%|          | 0/4 [00:00<?, ?it/s] 25%|██▌       | 1/4 [00:00<00:00,  5.91it/s] 75%|███████▌  | 3/4 [00:00<00:00,  9.50it/s] 75%|███████▌  | 3/4 [00:00<00:00,  7.32it/s]
2025-03-09 07:13:53,859 [INFO]: 	>>> Finished "Compute fast metrics" in 12.3648 secs
2025-03-09 07:13:53,861 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 42.6669 secs
2025-03-09 07:13:53,861 [INFO]: {
2025-03-09 07:13:53,861 [INFO]: 	index_key: HNSW15
2025-03-09 07:13:53,861 [INFO]: 	index_param: efSearch=292
2025-03-09 07:13:53,861 [INFO]: 	index_path: knn.index
2025-03-09 07:13:53,861 [INFO]: 	size in bytes: 413752510
2025-03-09 07:13:53,861 [INFO]: 	avg_search_speed_ms: 9.722548890161981
2025-03-09 07:13:53,861 [INFO]: 	99p_search_speed_ms: 13.285238081589346
2025-03-09 07:13:53,861 [INFO]: 	reconstruction error %: 0.0
2025-03-09 07:13:53,861 [INFO]: 	nb vectors: 2103
2025-03-09 07:13:53,861 [INFO]: 	vectors dimension: 49152
2025-03-09 07:13:53,861 [INFO]: 	compression ratio: 0.9993090410496845
2025-03-09 07:13:53,861 [INFO]: }
2025-03-09 07:13:53,861 [INFO]: 	>>> Finished "Creating the index" in 42.6681 secs
2025-03-09 07:13:53,861 [INFO]: >>> Finished "Launching the whole pipeline" in 42.6921 secs
2025-03-09 07:13:54: [retrieval_preprocessing] calculating distances ...
2025-03-09 07:13:55: [retrieval_preprocessing] finished and saved retrieval indices for episode 59958 [episode count 7/20]
[retrieval_preprocessing] for episode 64055 [episode count 8/20], we have num_retrieval=np.int64(2126) num_query=np.int64(101)
2025-03-09 07:13:56,031 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-09 07:13:56,338 [INFO]: Launching the whole pipeline 03/09/2025, 07:13:56
2025-03-09 07:13:56,338 [INFO]: Reading total number of vectors and dimension 03/09/2025, 07:13:56
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1547.14it/s]
2025-03-09 07:13:56,362 [INFO]: There are 2126 embeddings of dim 49152
2025-03-09 07:13:56,363 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0247 secs
2025-03-09 07:13:56,363 [INFO]: 	Compute estimated construction time of the index 03/09/2025, 07:13:56
2025-03-09 07:13:56,363 [INFO]: 		-> Train: 16.7 minutes
2025-03-09 07:13:56,363 [INFO]: 		-> Add: 1.2 seconds
2025-03-09 07:13:56,363 [INFO]: 		Total: 16.7 minutes
2025-03-09 07:13:56,363 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0001 secs
2025-03-09 07:13:56,363 [INFO]: 	Checking that your have enough memory available to create the index 03/09/2025, 07:13:56
2025-03-09 07:13:56,363 [INFO]: 438.8MB of memory will be needed to build the index (more might be used if you have more)
2025-03-09 07:13:56,363 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0001 secs
2025-03-09 07:13:56,363 [INFO]: 	Selecting most promising index types given data characteristics 03/09/2025, 07:13:56
2025-03-09 07:13:56,363 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-09 07:13:56,363 [INFO]: 	Creating the index 03/09/2025, 07:13:56
2025-03-09 07:13:56,363 [INFO]: 		-> Instanciate the index HNSW15 03/09/2025, 07:13:56
2025-03-09 07:13:56,364 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0009 secs
2025-03-09 07:13:56,364 [INFO]: 		-> Adding the vectors to the index 03/09/2025, 07:13:56
2025-03-09 07:13:56,364 [INFO]: The memory available for adding the vectors is 49.6GB(total available - used by the index)
2025-03-09 07:13:56,364 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/9 [00:00<?, ?it/s] 11%|█         | 1/9 [00:00<00:01,  7.37it/s] 33%|███▎      | 3/9 [00:00<00:00, 13.53it/s] 56%|█████▌    | 5/9 [00:00<00:00, 13.39it/s] 78%|███████▊  | 7/9 [00:00<00:00, 13.00it/s]100%|██████████| 9/9 [00:01<00:00,  3.27it/s]100%|██████████| 9/9 [00:01<00:00,  4.69it/s]
2025-03-09 07:13:58,286 [INFO]: 	Computing best hyperparameters for index knn.index 03/09/2025, 07:13:58
2025-03-09 07:14:25,529 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 27.2424 secs
2025-03-09 07:14:25,529 [INFO]: The best hyperparameters are: efSearch=262
2025-03-09 07:14:25,530 [INFO]: 	Compute fast metrics 03/09/2025, 07:14:25
  0%|          | 0/4 [00:00<?, ?it/s] 25%|██▌       | 1/4 [00:00<00:00,  5.23it/s] 75%|███████▌  | 3/4 [00:00<00:00,  8.38it/s] 75%|███████▌  | 3/4 [00:00<00:00,  5.95it/s]
2025-03-09 07:14:37,877 [INFO]: 	>>> Finished "Compute fast metrics" in 12.3472 secs
2025-03-09 07:14:38,364 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 41.9998 secs
2025-03-09 07:14:38,364 [INFO]: {
2025-03-09 07:14:38,364 [INFO]: 	index_key: HNSW15
2025-03-09 07:14:38,364 [INFO]: 	index_param: efSearch=262
2025-03-09 07:14:38,364 [INFO]: 	index_path: knn.index
2025-03-09 07:14:38,365 [INFO]: 	size in bytes: 418277530
2025-03-09 07:14:38,365 [INFO]: 	avg_search_speed_ms: 10.256945310303799
2025-03-09 07:14:38,365 [INFO]: 	99p_search_speed_ms: 14.717125450260937
2025-03-09 07:14:38,365 [INFO]: 	reconstruction error %: 0.0
2025-03-09 07:14:38,365 [INFO]: 	nb vectors: 2126
2025-03-09 07:14:38,365 [INFO]: 	vectors dimension: 49152
2025-03-09 07:14:38,365 [INFO]: 	compression ratio: 0.9993092576596213
2025-03-09 07:14:38,365 [INFO]: }
2025-03-09 07:14:38,365 [INFO]: 	>>> Finished "Creating the index" in 42.0018 secs
2025-03-09 07:14:38,365 [INFO]: >>> Finished "Launching the whole pipeline" in 42.0271 secs
2025-03-09 07:14:38: [retrieval_preprocessing] calculating distances ...
2025-03-09 07:14:39: [retrieval_preprocessing] finished and saved retrieval indices for episode 64055 [episode count 8/20]
[retrieval_preprocessing] for episode 3128 [episode count 9/20], we have num_retrieval=np.int64(2093) num_query=np.int64(134)
2025-03-09 07:14:40,232 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-09 07:14:40,585 [INFO]: Launching the whole pipeline 03/09/2025, 07:14:40
2025-03-09 07:14:40,585 [INFO]: Reading total number of vectors and dimension 03/09/2025, 07:14:40
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 2251.37it/s]
2025-03-09 07:14:40,610 [INFO]: There are 2093 embeddings of dim 49152
2025-03-09 07:14:40,610 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0252 secs
2025-03-09 07:14:40,610 [INFO]: 	Compute estimated construction time of the index 03/09/2025, 07:14:40
2025-03-09 07:14:40,610 [INFO]: 		-> Train: 16.7 minutes
2025-03-09 07:14:40,610 [INFO]: 		-> Add: 1.1 seconds
2025-03-09 07:14:40,610 [INFO]: 		Total: 16.7 minutes
2025-03-09 07:14:40,610 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0001 secs
2025-03-09 07:14:40,610 [INFO]: 	Checking that your have enough memory available to create the index 03/09/2025, 07:14:40
2025-03-09 07:14:40,610 [INFO]: 431.9MB of memory will be needed to build the index (more might be used if you have more)
2025-03-09 07:14:40,610 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0001 secs
2025-03-09 07:14:40,610 [INFO]: 	Selecting most promising index types given data characteristics 03/09/2025, 07:14:40
2025-03-09 07:14:40,610 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-09 07:14:40,610 [INFO]: 	Creating the index 03/09/2025, 07:14:40
2025-03-09 07:14:40,611 [INFO]: 		-> Instanciate the index HNSW15 03/09/2025, 07:14:40
2025-03-09 07:14:40,612 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0011 secs
2025-03-09 07:14:40,612 [INFO]: 		-> Adding the vectors to the index 03/09/2025, 07:14:40
2025-03-09 07:14:40,612 [INFO]: The memory available for adding the vectors is 49.6GB(total available - used by the index)
2025-03-09 07:14:40,612 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/9 [00:00<?, ?it/s] 11%|█         | 1/9 [00:00<00:01,  6.35it/s] 33%|███▎      | 3/9 [00:00<00:00,  9.90it/s] 56%|█████▌    | 5/9 [00:00<00:00, 11.22it/s] 78%|███████▊  | 7/9 [00:00<00:00, 11.89it/s]100%|██████████| 9/9 [00:02<00:00,  2.93it/s]100%|██████████| 9/9 [00:02<00:00,  4.15it/s]
2025-03-09 07:14:42,783 [INFO]: 	Computing best hyperparameters for index knn.index 03/09/2025, 07:14:42
2025-03-09 07:15:12,019 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 29.2361 secs
2025-03-09 07:15:12,020 [INFO]: The best hyperparameters are: efSearch=259
2025-03-09 07:15:12,020 [INFO]: 	Compute fast metrics 03/09/2025, 07:15:12
  0%|          | 0/4 [00:00<?, ?it/s] 25%|██▌       | 1/4 [00:00<00:00,  5.89it/s] 75%|███████▌  | 3/4 [00:00<00:00,  9.27it/s] 75%|███████▌  | 3/4 [00:00<00:00,  7.15it/s]
2025-03-09 07:15:24,285 [INFO]: 	>>> Finished "Compute fast metrics" in 12.2655 secs
2025-03-09 07:15:24,287 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 43.6748 secs
2025-03-09 07:15:24,287 [INFO]: {
2025-03-09 07:15:24,287 [INFO]: 	index_key: HNSW15
2025-03-09 07:15:24,287 [INFO]: 	index_param: efSearch=259
2025-03-09 07:15:24,287 [INFO]: 	index_path: knn.index
2025-03-09 07:15:24,287 [INFO]: 	size in bytes: 411785050
2025-03-09 07:15:24,287 [INFO]: 	avg_search_speed_ms: 10.383008911079985
2025-03-09 07:15:24,287 [INFO]: 	99p_search_speed_ms: 19.099463713355362
2025-03-09 07:15:24,287 [INFO]: 	reconstruction error %: 0.0
2025-03-09 07:15:24,287 [INFO]: 	nb vectors: 2093
2025-03-09 07:15:24,287 [INFO]: 	vectors dimension: 49152
2025-03-09 07:15:24,287 [INFO]: 	compression ratio: 0.9993090909929828
2025-03-09 07:15:24,287 [INFO]: }
2025-03-09 07:15:24,287 [INFO]: 	>>> Finished "Creating the index" in 43.6766 secs
2025-03-09 07:15:24,287 [INFO]: >>> Finished "Launching the whole pipeline" in 43.7024 secs
2025-03-09 07:15:25: [retrieval_preprocessing] calculating distances ...
2025-03-09 07:15:25: [retrieval_preprocessing] finished and saved retrieval indices for episode 3128 [episode count 9/20]
[retrieval_preprocessing] for episode 77882 [episode count 10/20], we have num_retrieval=np.int64(2116) num_query=np.int64(111)
2025-03-09 07:15:26,148 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-09 07:15:26,459 [INFO]: Launching the whole pipeline 03/09/2025, 07:15:26
2025-03-09 07:15:26,459 [INFO]: Reading total number of vectors and dimension 03/09/2025, 07:15:26
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 2184.53it/s]
2025-03-09 07:15:26,482 [INFO]: There are 2116 embeddings of dim 49152
2025-03-09 07:15:26,483 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0239 secs
2025-03-09 07:15:26,483 [INFO]: 	Compute estimated construction time of the index 03/09/2025, 07:15:26
2025-03-09 07:15:26,483 [INFO]: 		-> Train: 16.7 minutes
2025-03-09 07:15:26,483 [INFO]: 		-> Add: 1.2 seconds
2025-03-09 07:15:26,483 [INFO]: 		Total: 16.7 minutes
2025-03-09 07:15:26,483 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0001 secs
2025-03-09 07:15:26,483 [INFO]: 	Checking that your have enough memory available to create the index 03/09/2025, 07:15:26
2025-03-09 07:15:26,483 [INFO]: 436.7MB of memory will be needed to build the index (more might be used if you have more)
2025-03-09 07:15:26,483 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0001 secs
2025-03-09 07:15:26,483 [INFO]: 	Selecting most promising index types given data characteristics 03/09/2025, 07:15:26
2025-03-09 07:15:26,483 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-09 07:15:26,483 [INFO]: 	Creating the index 03/09/2025, 07:15:26
2025-03-09 07:15:26,483 [INFO]: 		-> Instanciate the index HNSW15 03/09/2025, 07:15:26
2025-03-09 07:15:26,485 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0011 secs
2025-03-09 07:15:26,485 [INFO]: 		-> Adding the vectors to the index 03/09/2025, 07:15:26
2025-03-09 07:15:26,485 [INFO]: The memory available for adding the vectors is 49.6GB(total available - used by the index)
2025-03-09 07:15:26,485 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/9 [00:00<?, ?it/s] 11%|█         | 1/9 [00:00<00:01,  6.66it/s] 33%|███▎      | 3/9 [00:00<00:00,  9.47it/s] 56%|█████▌    | 5/9 [00:00<00:00, 10.44it/s] 78%|███████▊  | 7/9 [00:00<00:00, 10.70it/s]100%|██████████| 9/9 [00:02<00:00,  2.96it/s]100%|██████████| 9/9 [00:02<00:00,  4.15it/s]
2025-03-09 07:15:28,657 [INFO]: 	Computing best hyperparameters for index knn.index 03/09/2025, 07:15:28
2025-03-09 07:15:57,943 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 29.2864 secs
2025-03-09 07:15:57,944 [INFO]: The best hyperparameters are: efSearch=266
2025-03-09 07:15:57,944 [INFO]: 	Compute fast metrics 03/09/2025, 07:15:57
  0%|          | 0/4 [00:00<?, ?it/s] 25%|██▌       | 1/4 [00:00<00:00,  5.83it/s] 50%|█████     | 2/4 [00:00<00:00,  7.68it/s] 75%|███████▌  | 3/4 [00:00<00:00,  7.56it/s] 75%|███████▌  | 3/4 [00:00<00:00,  5.57it/s]
2025-03-09 07:16:10,566 [INFO]: 	>>> Finished "Compute fast metrics" in 12.6221 secs
2025-03-09 07:16:10,568 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 44.0832 secs
2025-03-09 07:16:10,568 [INFO]: {
2025-03-09 07:16:10,568 [INFO]: 	index_key: HNSW15
2025-03-09 07:16:10,568 [INFO]: 	index_param: efSearch=266
2025-03-09 07:16:10,568 [INFO]: 	index_path: knn.index
2025-03-09 07:16:10,568 [INFO]: 	size in bytes: 416310130
2025-03-09 07:16:10,568 [INFO]: 	avg_search_speed_ms: 10.922090627515372
2025-03-09 07:16:10,568 [INFO]: 	99p_search_speed_ms: 19.824536575470127
2025-03-09 07:16:10,568 [INFO]: 	reconstruction error %: 0.0
2025-03-09 07:16:10,568 [INFO]: 	nb vectors: 2116
2025-03-09 07:16:10,568 [INFO]: 	vectors dimension: 49152
2025-03-09 07:16:10,568 [INFO]: 	compression ratio: 0.9993091640599762
2025-03-09 07:16:10,568 [INFO]: }
2025-03-09 07:16:10,568 [INFO]: 	>>> Finished "Creating the index" in 44.0851 secs
2025-03-09 07:16:10,568 [INFO]: >>> Finished "Launching the whole pipeline" in 44.1098 secs
2025-03-09 07:16:11: [retrieval_preprocessing] calculating distances ...
2025-03-09 07:16:11: [retrieval_preprocessing] finished and saved retrieval indices for episode 77882 [episode count 10/20]
[retrieval_preprocessing] for episode 31804 [episode count 11/20], we have num_retrieval=np.int64(2081) num_query=np.int64(146)
2025-03-09 07:16:12,179 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-09 07:16:12,490 [INFO]: Launching the whole pipeline 03/09/2025, 07:16:12
2025-03-09 07:16:12,490 [INFO]: Reading total number of vectors and dimension 03/09/2025, 07:16:12
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1110.49it/s]
2025-03-09 07:16:12,518 [INFO]: There are 2081 embeddings of dim 49152
2025-03-09 07:16:12,519 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0287 secs
2025-03-09 07:16:12,519 [INFO]: 	Compute estimated construction time of the index 03/09/2025, 07:16:12
2025-03-09 07:16:12,519 [INFO]: 		-> Train: 16.7 minutes
2025-03-09 07:16:12,519 [INFO]: 		-> Add: 1.1 seconds
2025-03-09 07:16:12,519 [INFO]: 		Total: 16.7 minutes
2025-03-09 07:16:12,519 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0002 secs
2025-03-09 07:16:12,519 [INFO]: 	Checking that your have enough memory available to create the index 03/09/2025, 07:16:12
2025-03-09 07:16:12,519 [INFO]: 429.5MB of memory will be needed to build the index (more might be used if you have more)
2025-03-09 07:16:12,520 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0002 secs
2025-03-09 07:16:12,520 [INFO]: 	Selecting most promising index types given data characteristics 03/09/2025, 07:16:12
2025-03-09 07:16:12,520 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-09 07:16:12,520 [INFO]: 	Creating the index 03/09/2025, 07:16:12
2025-03-09 07:16:12,520 [INFO]: 		-> Instanciate the index HNSW15 03/09/2025, 07:16:12
2025-03-09 07:16:12,521 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0012 secs
2025-03-09 07:16:12,521 [INFO]: 		-> Adding the vectors to the index 03/09/2025, 07:16:12
2025-03-09 07:16:12,521 [INFO]: The memory available for adding the vectors is 49.6GB(total available - used by the index)
2025-03-09 07:16:12,521 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/9 [00:00<?, ?it/s] 11%|█         | 1/9 [00:00<00:01,  6.15it/s] 22%|██▏       | 2/9 [00:00<00:00,  7.42it/s] 33%|███▎      | 3/9 [00:00<00:00,  8.00it/s] 44%|████▍     | 4/9 [00:00<00:00,  8.13it/s] 56%|█████▌    | 5/9 [00:00<00:00,  8.36it/s] 67%|██████▋   | 6/9 [00:00<00:00,  8.39it/s] 89%|████████▉ | 8/9 [00:00<00:00,  9.57it/s]100%|██████████| 9/9 [00:02<00:00,  2.25it/s]100%|██████████| 9/9 [00:02<00:00,  3.85it/s]
2025-03-09 07:16:14,860 [INFO]: 	Computing best hyperparameters for index knn.index 03/09/2025, 07:16:14
2025-03-09 07:16:43,736 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 28.8754 secs
2025-03-09 07:16:43,736 [INFO]: The best hyperparameters are: efSearch=258
2025-03-09 07:16:43,736 [INFO]: 	Compute fast metrics 03/09/2025, 07:16:43
  0%|          | 0/4 [00:00<?, ?it/s] 25%|██▌       | 1/4 [00:00<00:00,  6.17it/s] 75%|███████▌  | 3/4 [00:00<00:00,  9.91it/s] 75%|███████▌  | 3/4 [00:00<00:00,  7.80it/s]
2025-03-09 07:16:55,942 [INFO]: 	>>> Finished "Compute fast metrics" in 12.2056 secs
2025-03-09 07:16:55,943 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 43.4222 secs
2025-03-09 07:16:55,943 [INFO]: {
2025-03-09 07:16:55,943 [INFO]: 	index_key: HNSW15
2025-03-09 07:16:55,943 [INFO]: 	index_param: efSearch=258
2025-03-09 07:16:55,944 [INFO]: 	index_path: knn.index
2025-03-09 07:16:55,944 [INFO]: 	size in bytes: 409424170
2025-03-09 07:16:55,944 [INFO]: 	avg_search_speed_ms: 9.93067037953247
2025-03-09 07:16:55,944 [INFO]: 	99p_search_speed_ms: 14.052293202839772
2025-03-09 07:16:55,944 [INFO]: 	reconstruction error %: 0.0
2025-03-09 07:16:55,944 [INFO]: 	nb vectors: 2081
2025-03-09 07:16:55,944 [INFO]: 	vectors dimension: 49152
2025-03-09 07:16:55,944 [INFO]: 	compression ratio: 0.9993089758232886
2025-03-09 07:16:55,944 [INFO]: }
2025-03-09 07:16:55,944 [INFO]: 	>>> Finished "Creating the index" in 43.4239 secs
2025-03-09 07:16:55,944 [INFO]: >>> Finished "Launching the whole pipeline" in 43.4538 secs
2025-03-09 07:16:57: [retrieval_preprocessing] calculating distances ...
2025-03-09 07:16:57: [retrieval_preprocessing] finished and saved retrieval indices for episode 31804 [episode count 11/20]
[retrieval_preprocessing] for episode 45643 [episode count 12/20], we have num_retrieval=np.int64(2120) num_query=np.int64(107)
2025-03-09 07:16:58,361 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-09 07:16:58,721 [INFO]: Launching the whole pipeline 03/09/2025, 07:16:58
2025-03-09 07:16:58,721 [INFO]: Reading total number of vectors and dimension 03/09/2025, 07:16:58
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1358.70it/s]
2025-03-09 07:16:58,746 [INFO]: There are 2120 embeddings of dim 49152
2025-03-09 07:16:58,747 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0258 secs
2025-03-09 07:16:58,747 [INFO]: 	Compute estimated construction time of the index 03/09/2025, 07:16:58
2025-03-09 07:16:58,747 [INFO]: 		-> Train: 16.7 minutes
2025-03-09 07:16:58,748 [INFO]: 		-> Add: 1.2 seconds
2025-03-09 07:16:58,748 [INFO]: 		Total: 16.7 minutes
2025-03-09 07:16:58,748 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0007 secs
2025-03-09 07:16:58,748 [INFO]: 	Checking that your have enough memory available to create the index 03/09/2025, 07:16:58
2025-03-09 07:16:58,749 [INFO]: 437.5MB of memory will be needed to build the index (more might be used if you have more)
2025-03-09 07:16:58,749 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0005 secs
2025-03-09 07:16:58,749 [INFO]: 	Selecting most promising index types given data characteristics 03/09/2025, 07:16:58
2025-03-09 07:16:58,749 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-09 07:16:58,749 [INFO]: 	Creating the index 03/09/2025, 07:16:58
2025-03-09 07:16:58,750 [INFO]: 		-> Instanciate the index HNSW15 03/09/2025, 07:16:58
2025-03-09 07:16:58,753 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0033 secs
2025-03-09 07:16:58,754 [INFO]: 		-> Adding the vectors to the index 03/09/2025, 07:16:58
2025-03-09 07:16:58,754 [INFO]: The memory available for adding the vectors is 49.6GB(total available - used by the index)
2025-03-09 07:16:58,754 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/9 [00:00<?, ?it/s] 11%|█         | 1/9 [00:00<00:01,  5.50it/s] 22%|██▏       | 2/9 [00:00<00:00,  7.01it/s] 33%|███▎      | 3/9 [00:00<00:00,  7.75it/s] 44%|████▍     | 4/9 [00:00<00:00,  8.05it/s] 67%|██████▋   | 6/9 [00:00<00:00,  9.54it/s] 89%|████████▉ | 8/9 [00:00<00:00, 10.43it/s]100%|██████████| 9/9 [00:02<00:00,  3.92it/s]
2025-03-09 07:17:01,058 [INFO]: 	Computing best hyperparameters for index knn.index 03/09/2025, 07:17:01
2025-03-09 07:17:32,871 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 31.8131 secs
2025-03-09 07:17:32,871 [INFO]: The best hyperparameters are: efSearch=223
2025-03-09 07:17:32,871 [INFO]: 	Compute fast metrics 03/09/2025, 07:17:32
  0%|          | 0/4 [00:00<?, ?it/s] 25%|██▌       | 1/4 [00:00<00:00,  5.57it/s] 75%|███████▌  | 3/4 [00:00<00:00, 10.03it/s] 75%|███████▌  | 3/4 [00:00<00:00,  7.78it/s]
2025-03-09 07:17:45,250 [INFO]: 	>>> Finished "Compute fast metrics" in 12.3787 secs
2025-03-09 07:17:45,252 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 46.4981 secs
2025-03-09 07:17:45,252 [INFO]: {
2025-03-09 07:17:45,252 [INFO]: 	index_key: HNSW15
2025-03-09 07:17:45,252 [INFO]: 	index_param: efSearch=223
2025-03-09 07:17:45,252 [INFO]: 	index_path: knn.index
2025-03-09 07:17:45,252 [INFO]: 	size in bytes: 417097090
2025-03-09 07:17:45,252 [INFO]: 	avg_search_speed_ms: 9.729923371946736
2025-03-09 07:17:45,252 [INFO]: 	99p_search_speed_ms: 17.76579761179165
2025-03-09 07:17:45,252 [INFO]: 	reconstruction error %: 0.0
2025-03-09 07:17:45,252 [INFO]: 	nb vectors: 2120
2025-03-09 07:17:45,252 [INFO]: 	vectors dimension: 49152
2025-03-09 07:17:45,252 [INFO]: 	compression ratio: 0.999309201605794
2025-03-09 07:17:45,252 [INFO]: }
2025-03-09 07:17:45,252 [INFO]: 	>>> Finished "Creating the index" in 46.5025 secs
2025-03-09 07:17:45,252 [INFO]: >>> Finished "Launching the whole pipeline" in 46.5313 secs
2025-03-09 07:17:45: [retrieval_preprocessing] calculating distances ...
2025-03-09 07:17:46: [retrieval_preprocessing] finished and saved retrieval indices for episode 45643 [episode count 12/20]
[retrieval_preprocessing] for episode 17486 [episode count 13/20], we have num_retrieval=np.int64(2132) num_query=np.int64(95)
2025-03-09 07:17:46,635 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-09 07:17:46,934 [INFO]: Launching the whole pipeline 03/09/2025, 07:17:46
2025-03-09 07:17:46,934 [INFO]: Reading total number of vectors and dimension 03/09/2025, 07:17:46
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 843.42it/s]
2025-03-09 07:17:46,962 [INFO]: There are 2132 embeddings of dim 49152
2025-03-09 07:17:46,962 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0277 secs
2025-03-09 07:17:46,962 [INFO]: 	Compute estimated construction time of the index 03/09/2025, 07:17:46
2025-03-09 07:17:46,962 [INFO]: 		-> Train: 16.7 minutes
2025-03-09 07:17:46,962 [INFO]: 		-> Add: 1.2 seconds
2025-03-09 07:17:46,963 [INFO]: 		Total: 16.7 minutes
2025-03-09 07:17:46,963 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0004 secs
2025-03-09 07:17:46,963 [INFO]: 	Checking that your have enough memory available to create the index 03/09/2025, 07:17:46
2025-03-09 07:17:46,963 [INFO]: 440.0MB of memory will be needed to build the index (more might be used if you have more)
2025-03-09 07:17:46,963 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0004 secs
2025-03-09 07:17:46,963 [INFO]: 	Selecting most promising index types given data characteristics 03/09/2025, 07:17:46
2025-03-09 07:17:46,963 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-09 07:17:46,963 [INFO]: 	Creating the index 03/09/2025, 07:17:46
2025-03-09 07:17:46,964 [INFO]: 		-> Instanciate the index HNSW15 03/09/2025, 07:17:46
2025-03-09 07:17:46,966 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0027 secs
2025-03-09 07:17:46,967 [INFO]: 		-> Adding the vectors to the index 03/09/2025, 07:17:46
2025-03-09 07:17:46,967 [INFO]: The memory available for adding the vectors is 49.6GB(total available - used by the index)
2025-03-09 07:17:46,967 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/9 [00:00<?, ?it/s] 11%|█         | 1/9 [00:00<00:00,  8.09it/s] 33%|███▎      | 3/9 [00:00<00:00, 13.11it/s] 56%|█████▌    | 5/9 [00:00<00:00, 14.97it/s] 78%|███████▊  | 7/9 [00:00<00:00, 14.22it/s]100%|██████████| 9/9 [00:02<00:00,  2.93it/s]100%|██████████| 9/9 [00:02<00:00,  4.31it/s]
2025-03-09 07:17:49,062 [INFO]: 	Computing best hyperparameters for index knn.index 03/09/2025, 07:17:49
2025-03-09 07:18:17,967 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 28.9046 secs
2025-03-09 07:18:17,967 [INFO]: The best hyperparameters are: efSearch=255
2025-03-09 07:18:17,967 [INFO]: 	Compute fast metrics 03/09/2025, 07:18:17
  0%|          | 0/4 [00:00<?, ?it/s] 25%|██▌       | 1/4 [00:00<00:00,  6.45it/s] 75%|███████▌  | 3/4 [00:00<00:00,  9.50it/s] 75%|███████▌  | 3/4 [00:00<00:00,  7.32it/s]
2025-03-09 07:18:31,506 [INFO]: 	>>> Finished "Compute fast metrics" in 13.5391 secs
2025-03-09 07:18:31,508 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 44.5416 secs
2025-03-09 07:18:31,508 [INFO]: {
2025-03-09 07:18:31,508 [INFO]: 	index_key: HNSW15
2025-03-09 07:18:31,508 [INFO]: 	index_param: efSearch=255
2025-03-09 07:18:31,508 [INFO]: 	index_path: knn.index
2025-03-09 07:18:31,508 [INFO]: 	size in bytes: 419457970
2025-03-09 07:18:31,508 [INFO]: 	avg_search_speed_ms: 10.9896684940495
2025-03-09 07:18:31,508 [INFO]: 	99p_search_speed_ms: 19.024972815532234
2025-03-09 07:18:31,508 [INFO]: 	reconstruction error %: 0.0
2025-03-09 07:18:31,509 [INFO]: 	nb vectors: 2132
2025-03-09 07:18:31,509 [INFO]: 	vectors dimension: 49152
2025-03-09 07:18:31,509 [INFO]: 	compression ratio: 0.999309313397955
2025-03-09 07:18:31,509 [INFO]: }
2025-03-09 07:18:31,509 [INFO]: 	>>> Finished "Creating the index" in 44.5450 secs
2025-03-09 07:18:31,509 [INFO]: >>> Finished "Launching the whole pipeline" in 44.5743 secs
2025-03-09 07:18:32: [retrieval_preprocessing] calculating distances ...
2025-03-09 07:18:32: [retrieval_preprocessing] finished and saved retrieval indices for episode 17486 [episode count 13/20]
[retrieval_preprocessing] for episode 27730 [episode count 14/20], we have num_retrieval=np.int64(2139) num_query=np.int64(88)
2025-03-09 07:18:33,023 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-09 07:18:33,386 [INFO]: Launching the whole pipeline 03/09/2025, 07:18:33
2025-03-09 07:18:33,386 [INFO]: Reading total number of vectors and dimension 03/09/2025, 07:18:33
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 2261.08it/s]
2025-03-09 07:18:33,409 [INFO]: There are 2139 embeddings of dim 49152
2025-03-09 07:18:33,410 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0239 secs
2025-03-09 07:18:33,410 [INFO]: 	Compute estimated construction time of the index 03/09/2025, 07:18:33
2025-03-09 07:18:33,410 [INFO]: 		-> Train: 16.7 minutes
2025-03-09 07:18:33,410 [INFO]: 		-> Add: 1.2 seconds
2025-03-09 07:18:33,410 [INFO]: 		Total: 16.7 minutes
2025-03-09 07:18:33,410 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0001 secs
2025-03-09 07:18:33,410 [INFO]: 	Checking that your have enough memory available to create the index 03/09/2025, 07:18:33
2025-03-09 07:18:33,410 [INFO]: 441.4MB of memory will be needed to build the index (more might be used if you have more)
2025-03-09 07:18:33,410 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0001 secs
2025-03-09 07:18:33,410 [INFO]: 	Selecting most promising index types given data characteristics 03/09/2025, 07:18:33
2025-03-09 07:18:33,410 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-09 07:18:33,410 [INFO]: 	Creating the index 03/09/2025, 07:18:33
2025-03-09 07:18:33,410 [INFO]: 		-> Instanciate the index HNSW15 03/09/2025, 07:18:33
2025-03-09 07:18:33,411 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0009 secs
2025-03-09 07:18:33,411 [INFO]: 		-> Adding the vectors to the index 03/09/2025, 07:18:33
2025-03-09 07:18:33,411 [INFO]: The memory available for adding the vectors is 49.6GB(total available - used by the index)
2025-03-09 07:18:33,411 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/9 [00:00<?, ?it/s] 11%|█         | 1/9 [00:00<00:01,  6.48it/s] 33%|███▎      | 3/9 [00:00<00:00,  8.76it/s] 56%|█████▌    | 5/9 [00:00<00:00,  9.46it/s] 78%|███████▊  | 7/9 [00:00<00:00,  9.77it/s]100%|██████████| 9/9 [00:02<00:00,  2.47it/s]100%|██████████| 9/9 [00:02<00:00,  3.52it/s]
2025-03-09 07:18:35,973 [INFO]: 	Computing best hyperparameters for index knn.index 03/09/2025, 07:18:35
2025-03-09 07:18:57,665 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 21.6911 secs
2025-03-09 07:18:57,665 [INFO]: The best hyperparameters are: efSearch=323
2025-03-09 07:18:57,665 [INFO]: 	Compute fast metrics 03/09/2025, 07:18:57
  0%|          | 0/4 [00:00<?, ?it/s] 25%|██▌       | 1/4 [00:00<00:00,  6.02it/s] 75%|███████▌  | 3/4 [00:00<00:00,  9.61it/s] 75%|███████▌  | 3/4 [00:00<00:00,  7.40it/s]
2025-03-09 07:19:09,851 [INFO]: 	>>> Finished "Compute fast metrics" in 12.1865 secs
2025-03-09 07:19:09,853 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 36.4418 secs
2025-03-09 07:19:09,853 [INFO]: {
2025-03-09 07:19:09,853 [INFO]: 	index_key: HNSW15
2025-03-09 07:19:09,853 [INFO]: 	index_param: efSearch=323
2025-03-09 07:19:09,853 [INFO]: 	index_path: knn.index
2025-03-09 07:19:09,853 [INFO]: 	size in bytes: 420835270
2025-03-09 07:19:09,853 [INFO]: 	avg_search_speed_ms: 10.028993377859967
2025-03-09 07:19:09,853 [INFO]: 	99p_search_speed_ms: 12.466102531179784
2025-03-09 07:19:09,853 [INFO]: 	reconstruction error %: 0.0
2025-03-09 07:19:09,853 [INFO]: 	nb vectors: 2139
2025-03-09 07:19:09,853 [INFO]: 	vectors dimension: 49152
2025-03-09 07:19:09,853 [INFO]: 	compression ratio: 0.9993090930805301
2025-03-09 07:19:09,853 [INFO]: }
2025-03-09 07:19:09,853 [INFO]: 	>>> Finished "Creating the index" in 36.4432 secs
2025-03-09 07:19:09,853 [INFO]: >>> Finished "Launching the whole pipeline" in 36.4676 secs
2025-03-09 07:19:10: [retrieval_preprocessing] calculating distances ...
2025-03-09 07:19:10: [retrieval_preprocessing] finished and saved retrieval indices for episode 27730 [episode count 14/20]
[retrieval_preprocessing] for episode 24149 [episode count 15/20], we have num_retrieval=np.int64(2104) num_query=np.int64(123)
2025-03-09 07:19:11,304 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-09 07:19:11,580 [INFO]: Launching the whole pipeline 03/09/2025, 07:19:11
2025-03-09 07:19:11,580 [INFO]: Reading total number of vectors and dimension 03/09/2025, 07:19:11
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1757.88it/s]
2025-03-09 07:19:11,602 [INFO]: There are 2104 embeddings of dim 49152
2025-03-09 07:19:11,602 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0223 secs
2025-03-09 07:19:11,602 [INFO]: 	Compute estimated construction time of the index 03/09/2025, 07:19:11
2025-03-09 07:19:11,603 [INFO]: 		-> Train: 16.7 minutes
2025-03-09 07:19:11,603 [INFO]: 		-> Add: 1.2 seconds
2025-03-09 07:19:11,603 [INFO]: 		Total: 16.7 minutes
2025-03-09 07:19:11,603 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0001 secs
2025-03-09 07:19:11,603 [INFO]: 	Checking that your have enough memory available to create the index 03/09/2025, 07:19:11
2025-03-09 07:19:11,603 [INFO]: 434.2MB of memory will be needed to build the index (more might be used if you have more)
2025-03-09 07:19:11,603 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0001 secs
2025-03-09 07:19:11,603 [INFO]: 	Selecting most promising index types given data characteristics 03/09/2025, 07:19:11
2025-03-09 07:19:11,603 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-09 07:19:11,603 [INFO]: 	Creating the index 03/09/2025, 07:19:11
2025-03-09 07:19:11,603 [INFO]: 		-> Instanciate the index HNSW15 03/09/2025, 07:19:11
2025-03-09 07:19:11,604 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0008 secs
2025-03-09 07:19:11,604 [INFO]: 		-> Adding the vectors to the index 03/09/2025, 07:19:11
2025-03-09 07:19:11,604 [INFO]: The memory available for adding the vectors is 49.6GB(total available - used by the index)
2025-03-09 07:19:11,604 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/9 [00:00<?, ?it/s] 11%|█         | 1/9 [00:00<00:01,  5.16it/s] 22%|██▏       | 2/9 [00:00<00:01,  6.77it/s] 33%|███▎      | 3/9 [00:00<00:00,  7.52it/s] 44%|████▍     | 4/9 [00:00<00:00,  8.06it/s] 56%|█████▌    | 5/9 [00:00<00:00,  8.25it/s] 67%|██████▋   | 6/9 [00:00<00:00,  8.33it/s] 78%|███████▊  | 7/9 [00:00<00:00,  8.38it/s] 89%|████████▉ | 8/9 [00:01<00:00,  8.39it/s]100%|██████████| 9/9 [00:02<00:00,  1.71it/s]100%|██████████| 9/9 [00:02<00:00,  3.43it/s]
2025-03-09 07:19:14,228 [INFO]: 	Computing best hyperparameters for index knn.index 03/09/2025, 07:19:14
2025-03-09 07:19:45,616 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 31.3882 secs
2025-03-09 07:19:45,616 [INFO]: The best hyperparameters are: efSearch=238
2025-03-09 07:19:45,617 [INFO]: 	Compute fast metrics 03/09/2025, 07:19:45
  0%|          | 0/4 [00:00<?, ?it/s] 25%|██▌       | 1/4 [00:00<00:00,  6.76it/s] 75%|███████▌  | 3/4 [00:00<00:00, 10.04it/s] 75%|███████▌  | 3/4 [00:00<00:00,  7.65it/s]
2025-03-09 07:19:58,135 [INFO]: 	>>> Finished "Compute fast metrics" in 12.5181 secs
2025-03-09 07:19:58,137 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 46.5326 secs
2025-03-09 07:19:58,137 [INFO]: {
2025-03-09 07:19:58,137 [INFO]: 	index_key: HNSW15
2025-03-09 07:19:58,137 [INFO]: 	index_param: efSearch=238
2025-03-09 07:19:58,137 [INFO]: 	index_path: knn.index
2025-03-09 07:19:58,137 [INFO]: 	size in bytes: 413949250
2025-03-09 07:19:58,137 [INFO]: 	avg_search_speed_ms: 9.500380791635283
2025-03-09 07:19:58,137 [INFO]: 	99p_search_speed_ms: 15.739395627751946
2025-03-09 07:19:58,137 [INFO]: 	reconstruction error %: 0.0
2025-03-09 07:19:58,137 [INFO]: 	nb vectors: 2104
2025-03-09 07:19:58,137 [INFO]: 	vectors dimension: 49152
2025-03-09 07:19:58,137 [INFO]: 	compression ratio: 0.9993090505659812
2025-03-09 07:19:58,137 [INFO]: }
2025-03-09 07:19:58,137 [INFO]: 	>>> Finished "Creating the index" in 46.5338 secs
2025-03-09 07:19:58,137 [INFO]: >>> Finished "Launching the whole pipeline" in 46.5568 secs
2025-03-09 07:19:58: [retrieval_preprocessing] calculating distances ...
2025-03-09 07:19:59: [retrieval_preprocessing] finished and saved retrieval indices for episode 24149 [episode count 15/20]
[retrieval_preprocessing] for episode 38487 [episode count 16/20], we have num_retrieval=np.int64(2105) num_query=np.int64(122)
2025-03-09 07:20:00,410 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-09 07:20:00,995 [INFO]: Launching the whole pipeline 03/09/2025, 07:20:00
2025-03-09 07:20:00,996 [INFO]: Reading total number of vectors and dimension 03/09/2025, 07:20:00
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1294.94it/s]
2025-03-09 07:20:01,029 [INFO]: There are 2105 embeddings of dim 49152
2025-03-09 07:20:01,029 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0334 secs
2025-03-09 07:20:01,029 [INFO]: 	Compute estimated construction time of the index 03/09/2025, 07:20:01
2025-03-09 07:20:01,029 [INFO]: 		-> Train: 16.7 minutes
2025-03-09 07:20:01,029 [INFO]: 		-> Add: 1.2 seconds
2025-03-09 07:20:01,029 [INFO]: 		Total: 16.7 minutes
2025-03-09 07:20:01,029 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0003 secs
2025-03-09 07:20:01,030 [INFO]: 	Checking that your have enough memory available to create the index 03/09/2025, 07:20:01
2025-03-09 07:20:01,030 [INFO]: 434.4MB of memory will be needed to build the index (more might be used if you have more)
2025-03-09 07:20:01,030 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0004 secs
2025-03-09 07:20:01,030 [INFO]: 	Selecting most promising index types given data characteristics 03/09/2025, 07:20:01
2025-03-09 07:20:01,030 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-09 07:20:01,030 [INFO]: 	Creating the index 03/09/2025, 07:20:01
2025-03-09 07:20:01,030 [INFO]: 		-> Instanciate the index HNSW15 03/09/2025, 07:20:01
2025-03-09 07:20:01,033 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0025 secs
2025-03-09 07:20:01,033 [INFO]: 		-> Adding the vectors to the index 03/09/2025, 07:20:01
2025-03-09 07:20:01,033 [INFO]: The memory available for adding the vectors is 49.6GB(total available - used by the index)
2025-03-09 07:20:01,034 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/9 [00:00<?, ?it/s] 11%|█         | 1/9 [00:00<00:01,  6.09it/s] 22%|██▏       | 2/9 [00:00<00:00,  7.42it/s] 33%|███▎      | 3/9 [00:00<00:00,  7.98it/s] 44%|████▍     | 4/9 [00:00<00:00,  8.10it/s] 56%|█████▌    | 5/9 [00:00<00:00,  8.32it/s] 67%|██████▋   | 6/9 [00:00<00:00,  8.47it/s] 78%|███████▊  | 7/9 [00:00<00:00,  8.45it/s] 89%|████████▉ | 8/9 [00:00<00:00,  8.19it/s]100%|██████████| 9/9 [00:02<00:00,  1.63it/s]100%|██████████| 9/9 [00:02<00:00,  3.35it/s]
2025-03-09 07:20:03,722 [INFO]: 	Computing best hyperparameters for index knn.index 03/09/2025, 07:20:03
2025-03-09 07:20:29,032 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 25.3097 secs
2025-03-09 07:20:29,033 [INFO]: The best hyperparameters are: efSearch=312
2025-03-09 07:20:29,033 [INFO]: 	Compute fast metrics 03/09/2025, 07:20:29
  0%|          | 0/4 [00:00<?, ?it/s] 25%|██▌       | 1/4 [00:00<00:00,  6.18it/s] 75%|███████▌  | 3/4 [00:00<00:00, 11.29it/s] 75%|███████▌  | 3/4 [00:00<00:00,  8.13it/s]
2025-03-09 07:20:42,937 [INFO]: 	>>> Finished "Compute fast metrics" in 13.9041 secs
2025-03-09 07:20:42,939 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 41.9057 secs
2025-03-09 07:20:42,939 [INFO]: {
2025-03-09 07:20:42,939 [INFO]: 	index_key: HNSW15
2025-03-09 07:20:42,939 [INFO]: 	index_param: efSearch=312
2025-03-09 07:20:42,939 [INFO]: 	index_path: knn.index
2025-03-09 07:20:42,939 [INFO]: 	size in bytes: 414145990
2025-03-09 07:20:42,939 [INFO]: 	avg_search_speed_ms: 12.266904512774541
2025-03-09 07:20:42,939 [INFO]: 	99p_search_speed_ms: 23.373063257895417
2025-03-09 07:20:42,939 [INFO]: 	reconstruction error %: 0.0
2025-03-09 07:20:42,939 [INFO]: 	nb vectors: 2105
2025-03-09 07:20:42,939 [INFO]: 	vectors dimension: 49152
2025-03-09 07:20:42,939 [INFO]: 	compression ratio: 0.9993090600732365
2025-03-09 07:20:42,939 [INFO]: }
2025-03-09 07:20:42,939 [INFO]: 	>>> Finished "Creating the index" in 41.9090 secs
2025-03-09 07:20:42,939 [INFO]: >>> Finished "Launching the whole pipeline" in 41.9439 secs
2025-03-09 07:20:43: [retrieval_preprocessing] calculating distances ...
2025-03-09 07:20:44: [retrieval_preprocessing] finished and saved retrieval indices for episode 38487 [episode count 16/20]
[retrieval_preprocessing] for episode 83033 [episode count 17/20], we have num_retrieval=np.int64(2123) num_query=np.int64(104)
2025-03-09 07:20:45,064 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-09 07:20:45,372 [INFO]: Launching the whole pipeline 03/09/2025, 07:20:45
2025-03-09 07:20:45,372 [INFO]: Reading total number of vectors and dimension 03/09/2025, 07:20:45
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1175.86it/s]
2025-03-09 07:20:45,398 [INFO]: There are 2123 embeddings of dim 49152
2025-03-09 07:20:45,398 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0265 secs
2025-03-09 07:20:45,398 [INFO]: 	Compute estimated construction time of the index 03/09/2025, 07:20:45
2025-03-09 07:20:45,398 [INFO]: 		-> Train: 16.7 minutes
2025-03-09 07:20:45,398 [INFO]: 		-> Add: 1.2 seconds
2025-03-09 07:20:45,399 [INFO]: 		Total: 16.7 minutes
2025-03-09 07:20:45,399 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0001 secs
2025-03-09 07:20:45,399 [INFO]: 	Checking that your have enough memory available to create the index 03/09/2025, 07:20:45
2025-03-09 07:20:45,399 [INFO]: 438.1MB of memory will be needed to build the index (more might be used if you have more)
2025-03-09 07:20:45,399 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0001 secs
2025-03-09 07:20:45,399 [INFO]: 	Selecting most promising index types given data characteristics 03/09/2025, 07:20:45
2025-03-09 07:20:45,399 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-09 07:20:45,399 [INFO]: 	Creating the index 03/09/2025, 07:20:45
2025-03-09 07:20:45,399 [INFO]: 		-> Instanciate the index HNSW15 03/09/2025, 07:20:45
2025-03-09 07:20:45,400 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0009 secs
2025-03-09 07:20:45,400 [INFO]: 		-> Adding the vectors to the index 03/09/2025, 07:20:45
2025-03-09 07:20:45,400 [INFO]: The memory available for adding the vectors is 49.6GB(total available - used by the index)
2025-03-09 07:20:45,400 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/9 [00:00<?, ?it/s] 11%|█         | 1/9 [00:00<00:01,  5.80it/s] 33%|███▎      | 3/9 [00:00<00:00,  8.51it/s] 56%|█████▌    | 5/9 [00:00<00:00,  8.94it/s] 67%|██████▋   | 6/9 [00:00<00:00,  9.12it/s] 89%|████████▉ | 8/9 [00:00<00:00,  9.66it/s]100%|██████████| 9/9 [00:02<00:00,  2.17it/s]100%|██████████| 9/9 [00:02<00:00,  3.61it/s]
2025-03-09 07:20:47,897 [INFO]: 	Computing best hyperparameters for index knn.index 03/09/2025, 07:20:47
2025-03-09 07:21:11,509 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 23.6121 secs
2025-03-09 07:21:11,509 [INFO]: The best hyperparameters are: efSearch=162
2025-03-09 07:21:11,509 [INFO]: 	Compute fast metrics 03/09/2025, 07:21:11
  0%|          | 0/4 [00:00<?, ?it/s] 25%|██▌       | 1/4 [00:00<00:00,  6.31it/s] 75%|███████▌  | 3/4 [00:00<00:00, 10.53it/s] 75%|███████▌  | 3/4 [00:00<00:00,  7.90it/s]
2025-03-09 07:21:23,870 [INFO]: 	>>> Finished "Compute fast metrics" in 12.3608 secs
2025-03-09 07:21:23,872 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 38.4718 secs
2025-03-09 07:21:23,872 [INFO]: {
2025-03-09 07:21:23,872 [INFO]: 	index_key: HNSW15
2025-03-09 07:21:23,872 [INFO]: 	index_param: efSearch=162
2025-03-09 07:21:23,872 [INFO]: 	index_path: knn.index
2025-03-09 07:21:23,872 [INFO]: 	size in bytes: 417687310
2025-03-09 07:21:23,872 [INFO]: 	avg_search_speed_ms: 7.288760101557071
2025-03-09 07:21:23,872 [INFO]: 	99p_search_speed_ms: 12.559379171580073
2025-03-09 07:21:23,872 [INFO]: 	reconstruction error %: 0.0
2025-03-09 07:21:23,872 [INFO]: 	nb vectors: 2123
2025-03-09 07:21:23,872 [INFO]: 	vectors dimension: 49152
2025-03-09 07:21:23,872 [INFO]: 	compression ratio: 0.9993092296723116
2025-03-09 07:21:23,872 [INFO]: }
2025-03-09 07:21:23,872 [INFO]: 	>>> Finished "Creating the index" in 38.4732 secs
2025-03-09 07:21:23,872 [INFO]: >>> Finished "Launching the whole pipeline" in 38.5003 secs
2025-03-09 07:21:24: [retrieval_preprocessing] calculating distances ...
2025-03-09 07:21:24: [retrieval_preprocessing] finished and saved retrieval indices for episode 83033 [episode count 17/20]
[retrieval_preprocessing] for episode 66138 [episode count 18/20], we have num_retrieval=np.int64(2102) num_query=np.int64(125)
2025-03-09 07:21:25,135 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-09 07:21:25,423 [INFO]: Launching the whole pipeline 03/09/2025, 07:21:25
2025-03-09 07:21:25,423 [INFO]: Reading total number of vectors and dimension 03/09/2025, 07:21:25
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1712.66it/s]
2025-03-09 07:21:25,450 [INFO]: There are 2102 embeddings of dim 49152
2025-03-09 07:21:25,450 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0268 secs
2025-03-09 07:21:25,450 [INFO]: 	Compute estimated construction time of the index 03/09/2025, 07:21:25
2025-03-09 07:21:25,450 [INFO]: 		-> Train: 16.7 minutes
2025-03-09 07:21:25,451 [INFO]: 		-> Add: 1.2 seconds
2025-03-09 07:21:25,451 [INFO]: 		Total: 16.7 minutes
2025-03-09 07:21:25,451 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0004 secs
2025-03-09 07:21:25,451 [INFO]: 	Checking that your have enough memory available to create the index 03/09/2025, 07:21:25
2025-03-09 07:21:25,451 [INFO]: 433.8MB of memory will be needed to build the index (more might be used if you have more)
2025-03-09 07:21:25,451 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0004 secs
2025-03-09 07:21:25,452 [INFO]: 	Selecting most promising index types given data characteristics 03/09/2025, 07:21:25
2025-03-09 07:21:25,452 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-09 07:21:25,452 [INFO]: 	Creating the index 03/09/2025, 07:21:25
2025-03-09 07:21:25,452 [INFO]: 		-> Instanciate the index HNSW15 03/09/2025, 07:21:25
2025-03-09 07:21:25,455 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0026 secs
2025-03-09 07:21:25,455 [INFO]: 		-> Adding the vectors to the index 03/09/2025, 07:21:25
2025-03-09 07:21:25,455 [INFO]: The memory available for adding the vectors is 49.6GB(total available - used by the index)
2025-03-09 07:21:25,456 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/9 [00:00<?, ?it/s] 11%|█         | 1/9 [00:00<00:01,  5.64it/s] 22%|██▏       | 2/9 [00:00<00:00,  7.04it/s] 33%|███▎      | 3/9 [00:00<00:00,  7.61it/s] 44%|████▍     | 4/9 [00:00<00:00,  7.79it/s] 56%|█████▌    | 5/9 [00:00<00:00,  8.21it/s] 78%|███████▊  | 7/9 [00:00<00:00, 10.10it/s]100%|██████████| 9/9 [00:02<00:00,  2.71it/s]100%|██████████| 9/9 [00:02<00:00,  3.94it/s]
2025-03-09 07:21:27,746 [INFO]: 	Computing best hyperparameters for index knn.index 03/09/2025, 07:21:27
2025-03-09 07:21:59,558 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 31.8118 secs
2025-03-09 07:21:59,558 [INFO]: The best hyperparameters are: efSearch=246
2025-03-09 07:21:59,558 [INFO]: 	Compute fast metrics 03/09/2025, 07:21:59
  0%|          | 0/4 [00:00<?, ?it/s] 25%|██▌       | 1/4 [00:00<00:00,  6.20it/s] 75%|███████▌  | 3/4 [00:00<00:00,  9.43it/s] 75%|███████▌  | 3/4 [00:00<00:00,  7.29it/s]
2025-03-09 07:22:12,566 [INFO]: 	>>> Finished "Compute fast metrics" in 13.0077 secs
2025-03-09 07:22:12,567 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 47.1120 secs
2025-03-09 07:22:12,567 [INFO]: {
2025-03-09 07:22:12,567 [INFO]: 	index_key: HNSW15
2025-03-09 07:22:12,568 [INFO]: 	index_param: efSearch=246
2025-03-09 07:22:12,568 [INFO]: 	index_path: knn.index
2025-03-09 07:22:12,568 [INFO]: 	size in bytes: 413555710
2025-03-09 07:22:12,568 [INFO]: 	avg_search_speed_ms: 9.967141805851789
2025-03-09 07:22:12,568 [INFO]: 	99p_search_speed_ms: 16.252579470165074
2025-03-09 07:22:12,568 [INFO]: 	reconstruction error %: 0.0
2025-03-09 07:22:12,568 [INFO]: 	nb vectors: 2102
2025-03-09 07:22:12,568 [INFO]: 	vectors dimension: 49152
2025-03-09 07:22:12,568 [INFO]: 	compression ratio: 0.9993091765073199
2025-03-09 07:22:12,568 [INFO]: }
2025-03-09 07:22:12,568 [INFO]: 	>>> Finished "Creating the index" in 47.1156 secs
2025-03-09 07:22:12,568 [INFO]: >>> Finished "Launching the whole pipeline" in 47.1444 secs
2025-03-09 07:22:13: [retrieval_preprocessing] calculating distances ...
2025-03-09 07:22:13: [retrieval_preprocessing] finished and saved retrieval indices for episode 66138 [episode count 18/20]
[retrieval_preprocessing] for episode 9311 [episode count 19/20], we have num_retrieval=np.int64(2123) num_query=np.int64(104)
2025-03-09 07:22:14,291 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-09 07:22:14,593 [INFO]: Launching the whole pipeline 03/09/2025, 07:22:14
2025-03-09 07:22:14,593 [INFO]: Reading total number of vectors and dimension 03/09/2025, 07:22:14
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 2252.58it/s]
2025-03-09 07:22:14,616 [INFO]: There are 2123 embeddings of dim 49152
2025-03-09 07:22:14,616 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0231 secs
2025-03-09 07:22:14,616 [INFO]: 	Compute estimated construction time of the index 03/09/2025, 07:22:14
2025-03-09 07:22:14,616 [INFO]: 		-> Train: 16.7 minutes
2025-03-09 07:22:14,616 [INFO]: 		-> Add: 1.2 seconds
2025-03-09 07:22:14,616 [INFO]: 		Total: 16.7 minutes
2025-03-09 07:22:14,616 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0001 secs
2025-03-09 07:22:14,616 [INFO]: 	Checking that your have enough memory available to create the index 03/09/2025, 07:22:14
2025-03-09 07:22:14,616 [INFO]: 438.1MB of memory will be needed to build the index (more might be used if you have more)
2025-03-09 07:22:14,616 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0002 secs
2025-03-09 07:22:14,616 [INFO]: 	Selecting most promising index types given data characteristics 03/09/2025, 07:22:14
2025-03-09 07:22:14,616 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-09 07:22:14,616 [INFO]: 	Creating the index 03/09/2025, 07:22:14
2025-03-09 07:22:14,616 [INFO]: 		-> Instanciate the index HNSW15 03/09/2025, 07:22:14
2025-03-09 07:22:14,617 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0010 secs
2025-03-09 07:22:14,618 [INFO]: 		-> Adding the vectors to the index 03/09/2025, 07:22:14
2025-03-09 07:22:14,618 [INFO]: The memory available for adding the vectors is 49.6GB(total available - used by the index)
2025-03-09 07:22:14,618 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/9 [00:00<?, ?it/s] 11%|█         | 1/9 [00:00<00:01,  5.87it/s] 33%|███▎      | 3/9 [00:00<00:00,  9.65it/s] 56%|█████▌    | 5/9 [00:00<00:00, 11.65it/s] 78%|███████▊  | 7/9 [00:00<00:00, 12.07it/s]100%|██████████| 9/9 [00:02<00:00,  3.00it/s]100%|██████████| 9/9 [00:02<00:00,  4.24it/s]
2025-03-09 07:22:16,745 [INFO]: 	Computing best hyperparameters for index knn.index 03/09/2025, 07:22:16
2025-03-09 07:22:44,110 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 27.3647 secs
2025-03-09 07:22:44,110 [INFO]: The best hyperparameters are: efSearch=224
2025-03-09 07:22:44,110 [INFO]: 	Compute fast metrics 03/09/2025, 07:22:44
  0%|          | 0/4 [00:00<?, ?it/s] 25%|██▌       | 1/4 [00:00<00:00,  5.88it/s] 75%|███████▌  | 3/4 [00:00<00:00,  9.13it/s] 75%|███████▌  | 3/4 [00:00<00:00,  6.97it/s]
2025-03-09 07:22:56,515 [INFO]: 	>>> Finished "Compute fast metrics" in 12.4046 secs
2025-03-09 07:22:56,517 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 41.8992 secs
2025-03-09 07:22:56,517 [INFO]: {
2025-03-09 07:22:56,517 [INFO]: 	index_key: HNSW15
2025-03-09 07:22:56,517 [INFO]: 	index_param: efSearch=224
2025-03-09 07:22:56,517 [INFO]: 	index_path: knn.index
2025-03-09 07:22:56,517 [INFO]: 	size in bytes: 417687310
2025-03-09 07:22:56,517 [INFO]: 	avg_search_speed_ms: 8.692356732511973
2025-03-09 07:22:56,517 [INFO]: 	99p_search_speed_ms: 13.639081707224248
2025-03-09 07:22:56,517 [INFO]: 	reconstruction error %: 0.0
2025-03-09 07:22:56,517 [INFO]: 	nb vectors: 2123
2025-03-09 07:22:56,517 [INFO]: 	vectors dimension: 49152
2025-03-09 07:22:56,517 [INFO]: 	compression ratio: 0.9993092296723116
2025-03-09 07:22:56,517 [INFO]: }
2025-03-09 07:22:56,517 [INFO]: 	>>> Finished "Creating the index" in 41.9006 secs
2025-03-09 07:22:56,517 [INFO]: >>> Finished "Launching the whole pipeline" in 41.9243 secs
2025-03-09 07:22:57: [retrieval_preprocessing] calculating distances ...
2025-03-09 07:22:57: [retrieval_preprocessing] finished and saved retrieval indices for episode 9311 [episode count 19/20]
2025-03-09 07:22:57: [retrieval_preprocessing] finished for (5235850418, 'block') [chosen_id count 1/10]
2025-03-09 07:22:59: [retrieval_preprocessing] concatenated all embeddings and indices for 20 episodes for (7495112204, 'marker') [chosen_id count 2/10]
2025-03-09 07:22:59: [retrieval_preprocessing] we have num_total=2798 embedding_dim=49152
[retrieval_preprocessing] for episode 70659 [episode count 0/20], we have num_retrieval=np.int64(2648) num_query=np.int64(150)
2025-03-09 07:23:00,817 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-09 07:23:01,190 [INFO]: Launching the whole pipeline 03/09/2025, 07:23:01
2025-03-09 07:23:01,190 [INFO]: Reading total number of vectors and dimension 03/09/2025, 07:23:01
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1382.43it/s]
2025-03-09 07:23:01,216 [INFO]: There are 2648 embeddings of dim 49152
2025-03-09 07:23:01,217 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0266 secs
2025-03-09 07:23:01,217 [INFO]: 	Compute estimated construction time of the index 03/09/2025, 07:23:01
2025-03-09 07:23:01,217 [INFO]: 		-> Train: 16.7 minutes
2025-03-09 07:23:01,217 [INFO]: 		-> Add: 1.5 seconds
2025-03-09 07:23:01,217 [INFO]: 		Total: 16.7 minutes
2025-03-09 07:23:01,217 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0003 secs
2025-03-09 07:23:01,217 [INFO]: 	Checking that your have enough memory available to create the index 03/09/2025, 07:23:01
2025-03-09 07:23:01,218 [INFO]: 546.5MB of memory will be needed to build the index (more might be used if you have more)
2025-03-09 07:23:01,218 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0004 secs
2025-03-09 07:23:01,218 [INFO]: 	Selecting most promising index types given data characteristics 03/09/2025, 07:23:01
2025-03-09 07:23:01,218 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-09 07:23:01,218 [INFO]: 	Creating the index 03/09/2025, 07:23:01
2025-03-09 07:23:01,218 [INFO]: 		-> Instanciate the index HNSW15 03/09/2025, 07:23:01
2025-03-09 07:23:01,221 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0023 secs
2025-03-09 07:23:01,221 [INFO]: 		-> Adding the vectors to the index 03/09/2025, 07:23:01
2025-03-09 07:23:01,221 [INFO]: The memory available for adding the vectors is 49.5GB(total available - used by the index)
2025-03-09 07:23:01,221 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/11 [00:00<?, ?it/s]  9%|▉         | 1/11 [00:00<00:01,  6.29it/s] 27%|██▋       | 3/11 [00:00<00:00,  9.47it/s] 45%|████▌     | 5/11 [00:00<00:00, 10.75it/s] 64%|██████▎   | 7/11 [00:00<00:00, 11.23it/s] 82%|████████▏ | 9/11 [00:00<00:00, 11.62it/s]100%|██████████| 11/11 [00:02<00:00,  2.96it/s]100%|██████████| 11/11 [00:02<00:00,  4.51it/s]
2025-03-09 07:23:03,666 [INFO]: 	Computing best hyperparameters for index knn.index 03/09/2025, 07:23:03
2025-03-09 07:23:30,521 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 26.8545 secs
2025-03-09 07:23:30,521 [INFO]: The best hyperparameters are: efSearch=346
2025-03-09 07:23:30,521 [INFO]: 	Compute fast metrics 03/09/2025, 07:23:30
  0%|          | 0/4 [00:00<?, ?it/s] 25%|██▌       | 1/4 [00:00<00:00,  8.88it/s] 75%|███████▌  | 3/4 [00:00<00:00, 11.92it/s]
2025-03-09 07:23:44,308 [INFO]: 	>>> Finished "Compute fast metrics" in 13.7867 secs
2025-03-09 07:23:44,310 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 43.0892 secs
2025-03-09 07:23:44,311 [INFO]: {
2025-03-09 07:23:44,311 [INFO]: 	index_key: HNSW15
2025-03-09 07:23:44,311 [INFO]: 	index_param: efSearch=346
2025-03-09 07:23:44,311 [INFO]: 	index_path: knn.index
2025-03-09 07:23:44,311 [INFO]: 	size in bytes: 520977730
2025-03-09 07:23:44,311 [INFO]: 	avg_search_speed_ms: 10.54976661006806
2025-03-09 07:23:44,311 [INFO]: 	99p_search_speed_ms: 18.674898971803476
2025-03-09 07:23:44,311 [INFO]: 	reconstruction error %: 0.0
2025-03-09 07:23:44,311 [INFO]: 	nb vectors: 2648
2025-03-09 07:23:44,311 [INFO]: 	vectors dimension: 49152
2025-03-09 07:23:44,311 [INFO]: 	compression ratio: 0.9993094791211133
2025-03-09 07:23:44,311 [INFO]: }
2025-03-09 07:23:44,311 [INFO]: 	>>> Finished "Creating the index" in 43.0924 secs
2025-03-09 07:23:44,311 [INFO]: >>> Finished "Launching the whole pipeline" in 43.1208 secs
2025-03-09 07:23:46: [retrieval_preprocessing] calculating distances ...
2025-03-09 07:23:46: [retrieval_preprocessing] finished and saved retrieval indices for episode 70659 [episode count 0/20]
[retrieval_preprocessing] for episode 57863 [episode count 1/20], we have num_retrieval=np.int64(2688) num_query=np.int64(110)
2025-03-09 07:23:47,765 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-09 07:23:48,194 [INFO]: Launching the whole pipeline 03/09/2025, 07:23:48
2025-03-09 07:23:48,194 [INFO]: Reading total number of vectors and dimension 03/09/2025, 07:23:48
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 733.65it/s]
2025-03-09 07:23:48,222 [INFO]: There are 2688 embeddings of dim 49152
2025-03-09 07:23:48,222 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0280 secs
2025-03-09 07:23:48,223 [INFO]: 	Compute estimated construction time of the index 03/09/2025, 07:23:48
2025-03-09 07:23:48,223 [INFO]: 		-> Train: 16.7 minutes
2025-03-09 07:23:48,223 [INFO]: 		-> Add: 1.5 seconds
2025-03-09 07:23:48,223 [INFO]: 		Total: 16.7 minutes
2025-03-09 07:23:48,223 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0001 secs
2025-03-09 07:23:48,223 [INFO]: 	Checking that your have enough memory available to create the index 03/09/2025, 07:23:48
2025-03-09 07:23:48,223 [INFO]: 554.7MB of memory will be needed to build the index (more might be used if you have more)
2025-03-09 07:23:48,223 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0003 secs
2025-03-09 07:23:48,223 [INFO]: 	Selecting most promising index types given data characteristics 03/09/2025, 07:23:48
2025-03-09 07:23:48,223 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-09 07:23:48,223 [INFO]: 	Creating the index 03/09/2025, 07:23:48
2025-03-09 07:23:48,223 [INFO]: 		-> Instanciate the index HNSW15 03/09/2025, 07:23:48
2025-03-09 07:23:48,224 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0009 secs
2025-03-09 07:23:48,224 [INFO]: 		-> Adding the vectors to the index 03/09/2025, 07:23:48
2025-03-09 07:23:48,224 [INFO]: The memory available for adding the vectors is 49.5GB(total available - used by the index)
2025-03-09 07:23:48,224 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/11 [00:00<?, ?it/s]  9%|▉         | 1/11 [00:00<00:01,  6.60it/s] 18%|█▊        | 2/11 [00:00<00:01,  8.02it/s] 27%|██▋       | 3/11 [00:00<00:01,  7.82it/s] 36%|███▋      | 4/11 [00:00<00:00,  7.55it/s] 45%|████▌     | 5/11 [00:00<00:00,  7.47it/s] 55%|█████▍    | 6/11 [00:00<00:00,  7.53it/s] 64%|██████▎   | 7/11 [00:00<00:00,  7.51it/s] 73%|███████▎  | 8/11 [00:01<00:00,  7.55it/s] 82%|████████▏ | 9/11 [00:01<00:00,  7.49it/s] 91%|█████████ | 10/11 [00:01<00:00,  7.46it/s]100%|██████████| 11/11 [00:03<00:00,  1.43it/s]100%|██████████| 11/11 [00:03<00:00,  3.32it/s]
2025-03-09 07:23:51,544 [INFO]: 	Computing best hyperparameters for index knn.index 03/09/2025, 07:23:51
2025-03-09 07:24:19,707 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 28.1629 secs
2025-03-09 07:24:19,708 [INFO]: The best hyperparameters are: efSearch=302
2025-03-09 07:24:19,708 [INFO]: 	Compute fast metrics 03/09/2025, 07:24:19
  0%|          | 0/4 [00:00<?, ?it/s] 25%|██▌       | 1/4 [00:00<00:00,  4.88it/s] 50%|█████     | 2/4 [00:00<00:00,  6.50it/s] 75%|███████▌  | 3/4 [00:00<00:00,  7.18it/s] 75%|███████▌  | 3/4 [00:00<00:00,  5.41it/s]
2025-03-09 07:24:40,137 [INFO]: 	>>> Finished "Compute fast metrics" in 20.4295 secs
2025-03-09 07:24:40,139 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 51.9152 secs
2025-03-09 07:24:40,139 [INFO]: {
2025-03-09 07:24:40,139 [INFO]: 	index_key: HNSW15
2025-03-09 07:24:40,139 [INFO]: 	index_param: efSearch=302
2025-03-09 07:24:40,140 [INFO]: 	index_path: knn.index
2025-03-09 07:24:40,140 [INFO]: 	size in bytes: 528847330
2025-03-09 07:24:40,140 [INFO]: 	avg_search_speed_ms: 9.89002122338327
2025-03-09 07:24:40,140 [INFO]: 	99p_search_speed_ms: 14.231499494053422
2025-03-09 07:24:40,140 [INFO]: 	reconstruction error %: 0.0
2025-03-09 07:24:40,140 [INFO]: 	nb vectors: 2688
2025-03-09 07:24:40,140 [INFO]: 	vectors dimension: 49152
2025-03-09 07:24:40,140 [INFO]: 	compression ratio: 0.9993097705532521
2025-03-09 07:24:40,140 [INFO]: }
2025-03-09 07:24:40,140 [INFO]: 	>>> Finished "Creating the index" in 51.9168 secs
2025-03-09 07:24:40,140 [INFO]: >>> Finished "Launching the whole pipeline" in 51.9455 secs
2025-03-09 07:24:40: [retrieval_preprocessing] calculating distances ...
2025-03-09 07:24:41: [retrieval_preprocessing] finished and saved retrieval indices for episode 57863 [episode count 1/20]
[retrieval_preprocessing] for episode 92176 [episode count 2/20], we have num_retrieval=np.int64(2645) num_query=np.int64(153)
2025-03-09 07:24:43,623 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-09 07:24:44,004 [INFO]: Launching the whole pipeline 03/09/2025, 07:24:44
2025-03-09 07:24:44,004 [INFO]: Reading total number of vectors and dimension 03/09/2025, 07:24:44
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1127.50it/s]
2025-03-09 07:24:44,033 [INFO]: There are 2645 embeddings of dim 49152
2025-03-09 07:24:44,033 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0297 secs
2025-03-09 07:24:44,034 [INFO]: 	Compute estimated construction time of the index 03/09/2025, 07:24:44
2025-03-09 07:24:44,034 [INFO]: 		-> Train: 16.7 minutes
2025-03-09 07:24:44,034 [INFO]: 		-> Add: 1.5 seconds
2025-03-09 07:24:44,034 [INFO]: 		Total: 16.7 minutes
2025-03-09 07:24:44,034 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0004 secs
2025-03-09 07:24:44,034 [INFO]: 	Checking that your have enough memory available to create the index 03/09/2025, 07:24:44
2025-03-09 07:24:44,034 [INFO]: 545.9MB of memory will be needed to build the index (more might be used if you have more)
2025-03-09 07:24:44,035 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0005 secs
2025-03-09 07:24:44,035 [INFO]: 	Selecting most promising index types given data characteristics 03/09/2025, 07:24:44
2025-03-09 07:24:44,035 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-09 07:24:44,035 [INFO]: 	Creating the index 03/09/2025, 07:24:44
2025-03-09 07:24:44,035 [INFO]: 		-> Instanciate the index HNSW15 03/09/2025, 07:24:44
2025-03-09 07:24:44,038 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0026 secs
2025-03-09 07:24:44,038 [INFO]: 		-> Adding the vectors to the index 03/09/2025, 07:24:44
2025-03-09 07:24:44,038 [INFO]: The memory available for adding the vectors is 49.5GB(total available - used by the index)
2025-03-09 07:24:44,039 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/11 [00:00<?, ?it/s]  9%|▉         | 1/11 [00:00<00:02,  4.95it/s] 27%|██▋       | 3/11 [00:00<00:01,  4.38it/s] 36%|███▋      | 4/11 [00:01<00:01,  3.70it/s] 91%|█████████ | 10/11 [00:01<00:00, 12.21it/s]100%|██████████| 11/11 [00:02<00:00,  4.17it/s]
2025-03-09 07:24:46,680 [INFO]: 	Computing best hyperparameters for index knn.index 03/09/2025, 07:24:46
2025-03-09 07:25:14,408 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 27.7275 secs
2025-03-09 07:25:14,408 [INFO]: The best hyperparameters are: efSearch=361
2025-03-09 07:25:14,408 [INFO]: 	Compute fast metrics 03/09/2025, 07:25:14
  0%|          | 0/4 [00:00<?, ?it/s] 25%|██▌       | 1/4 [00:00<00:00,  6.58it/s] 75%|███████▌  | 3/4 [00:00<00:00, 10.65it/s] 75%|███████▌  | 3/4 [00:00<00:00,  7.94it/s]
2025-03-09 07:25:36,552 [INFO]: 	>>> Finished "Compute fast metrics" in 22.1442 secs
2025-03-09 07:25:36,554 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 52.5154 secs
2025-03-09 07:25:36,554 [INFO]: {
2025-03-09 07:25:36,554 [INFO]: 	index_key: HNSW15
2025-03-09 07:25:36,554 [INFO]: 	index_param: efSearch=361
2025-03-09 07:25:36,554 [INFO]: 	index_path: knn.index
2025-03-09 07:25:36,554 [INFO]: 	size in bytes: 520387510
2025-03-09 07:25:36,554 [INFO]: 	avg_search_speed_ms: 11.691760226363908
2025-03-09 07:25:36,554 [INFO]: 	99p_search_speed_ms: 19.342048675753187
2025-03-09 07:25:36,554 [INFO]: 	reconstruction error %: 0.0
2025-03-09 07:25:36,554 [INFO]: 	nb vectors: 2645
2025-03-09 07:25:36,554 [INFO]: 	vectors dimension: 49152
2025-03-09 07:25:36,554 [INFO]: 	compression ratio: 0.999309456908372
2025-03-09 07:25:36,554 [INFO]: }
2025-03-09 07:25:36,554 [INFO]: 	>>> Finished "Creating the index" in 52.5187 secs
2025-03-09 07:25:36,554 [INFO]: >>> Finished "Launching the whole pipeline" in 52.5504 secs
2025-03-09 07:25:38: [retrieval_preprocessing] calculating distances ...
2025-03-09 07:25:38: [retrieval_preprocessing] finished and saved retrieval indices for episode 92176 [episode count 2/20]
[retrieval_preprocessing] for episode 9761 [episode count 3/20], we have num_retrieval=np.int64(2638) num_query=np.int64(160)
2025-03-09 07:25:39,332 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-09 07:25:39,723 [INFO]: Launching the whole pipeline 03/09/2025, 07:25:39
2025-03-09 07:25:39,723 [INFO]: Reading total number of vectors and dimension 03/09/2025, 07:25:39
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 2232.20it/s]
2025-03-09 07:25:39,746 [INFO]: There are 2638 embeddings of dim 49152
2025-03-09 07:25:39,746 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0228 secs
2025-03-09 07:25:39,746 [INFO]: 	Compute estimated construction time of the index 03/09/2025, 07:25:39
2025-03-09 07:25:39,746 [INFO]: 		-> Train: 16.7 minutes
2025-03-09 07:25:39,746 [INFO]: 		-> Add: 1.4 seconds
2025-03-09 07:25:39,746 [INFO]: 		Total: 16.7 minutes
2025-03-09 07:25:39,746 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0001 secs
2025-03-09 07:25:39,746 [INFO]: 	Checking that your have enough memory available to create the index 03/09/2025, 07:25:39
2025-03-09 07:25:39,747 [INFO]: 544.4MB of memory will be needed to build the index (more might be used if you have more)
2025-03-09 07:25:39,747 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0001 secs
2025-03-09 07:25:39,747 [INFO]: 	Selecting most promising index types given data characteristics 03/09/2025, 07:25:39
2025-03-09 07:25:39,747 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-09 07:25:39,747 [INFO]: 	Creating the index 03/09/2025, 07:25:39
2025-03-09 07:25:39,747 [INFO]: 		-> Instanciate the index HNSW15 03/09/2025, 07:25:39
2025-03-09 07:25:39,748 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0011 secs
2025-03-09 07:25:39,748 [INFO]: 		-> Adding the vectors to the index 03/09/2025, 07:25:39
2025-03-09 07:25:39,748 [INFO]: The memory available for adding the vectors is 49.5GB(total available - used by the index)
2025-03-09 07:25:39,748 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/11 [00:00<?, ?it/s]  9%|▉         | 1/11 [00:00<00:01,  6.35it/s] 27%|██▋       | 3/11 [00:00<00:00,  9.16it/s] 45%|████▌     | 5/11 [00:00<00:00, 10.23it/s] 64%|██████▎   | 7/11 [00:00<00:00, 10.63it/s] 82%|████████▏ | 9/11 [00:00<00:00, 10.87it/s]100%|██████████| 11/11 [00:02<00:00,  2.94it/s]100%|██████████| 11/11 [00:02<00:00,  4.45it/s]
2025-03-09 07:25:42,226 [INFO]: 	Computing best hyperparameters for index knn.index 03/09/2025, 07:25:42
2025-03-09 07:26:15,801 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 33.5746 secs
2025-03-09 07:26:15,801 [INFO]: The best hyperparameters are: efSearch=266
2025-03-09 07:26:15,801 [INFO]: 	Compute fast metrics 03/09/2025, 07:26:15
  0%|          | 0/4 [00:00<?, ?it/s] 25%|██▌       | 1/4 [00:00<00:00,  5.66it/s] 50%|█████     | 2/4 [00:00<00:00,  7.31it/s] 75%|███████▌  | 3/4 [00:00<00:00,  7.98it/s] 75%|███████▌  | 3/4 [00:00<00:00,  6.13it/s]
2025-03-09 07:26:28,903 [INFO]: 	>>> Finished "Compute fast metrics" in 13.1022 secs
2025-03-09 07:26:28,905 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 49.1573 secs
2025-03-09 07:26:28,905 [INFO]: {
2025-03-09 07:26:28,906 [INFO]: 	index_key: HNSW15
2025-03-09 07:26:28,906 [INFO]: 	index_param: efSearch=266
2025-03-09 07:26:28,906 [INFO]: 	index_path: knn.index
2025-03-09 07:26:28,906 [INFO]: 	size in bytes: 519010330
2025-03-09 07:26:28,906 [INFO]: 	avg_search_speed_ms: 9.447202865189123
2025-03-09 07:26:28,906 [INFO]: 	99p_search_speed_ms: 15.327590429224088
2025-03-09 07:26:28,906 [INFO]: 	reconstruction error %: 0.0
2025-03-09 07:26:28,906 [INFO]: 	nb vectors: 2638
2025-03-09 07:26:28,906 [INFO]: 	vectors dimension: 49152
2025-03-09 07:26:28,906 [INFO]: 	compression ratio: 0.9993094048821726
2025-03-09 07:26:28,906 [INFO]: }
2025-03-09 07:26:28,906 [INFO]: 	>>> Finished "Creating the index" in 49.1589 secs
2025-03-09 07:26:28,906 [INFO]: >>> Finished "Launching the whole pipeline" in 49.1823 secs
2025-03-09 07:26:29: [retrieval_preprocessing] calculating distances ...
2025-03-09 07:26:30: [retrieval_preprocessing] finished and saved retrieval indices for episode 9761 [episode count 3/20]
[retrieval_preprocessing] for episode 6691 [episode count 4/20], we have num_retrieval=np.int64(2679) num_query=np.int64(119)
2025-03-09 07:26:31,286 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-09 07:26:31,640 [INFO]: Launching the whole pipeline 03/09/2025, 07:26:31
2025-03-09 07:26:31,640 [INFO]: Reading total number of vectors and dimension 03/09/2025, 07:26:31
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 2344.50it/s]
2025-03-09 07:26:31,662 [INFO]: There are 2679 embeddings of dim 49152
2025-03-09 07:26:31,663 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0226 secs
2025-03-09 07:26:31,663 [INFO]: 	Compute estimated construction time of the index 03/09/2025, 07:26:31
2025-03-09 07:26:31,663 [INFO]: 		-> Train: 16.7 minutes
2025-03-09 07:26:31,663 [INFO]: 		-> Add: 1.5 seconds
2025-03-09 07:26:31,663 [INFO]: 		Total: 16.7 minutes
2025-03-09 07:26:31,663 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0001 secs
2025-03-09 07:26:31,663 [INFO]: 	Checking that your have enough memory available to create the index 03/09/2025, 07:26:31
2025-03-09 07:26:31,663 [INFO]: 552.9MB of memory will be needed to build the index (more might be used if you have more)
2025-03-09 07:26:31,663 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0001 secs
2025-03-09 07:26:31,663 [INFO]: 	Selecting most promising index types given data characteristics 03/09/2025, 07:26:31
2025-03-09 07:26:31,663 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-09 07:26:31,663 [INFO]: 	Creating the index 03/09/2025, 07:26:31
2025-03-09 07:26:31,663 [INFO]: 		-> Instanciate the index HNSW15 03/09/2025, 07:26:31
2025-03-09 07:26:31,664 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0009 secs
2025-03-09 07:26:31,664 [INFO]: 		-> Adding the vectors to the index 03/09/2025, 07:26:31
2025-03-09 07:26:31,664 [INFO]: The memory available for adding the vectors is 49.5GB(total available - used by the index)
2025-03-09 07:26:31,664 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/11 [00:00<?, ?it/s]  9%|▉         | 1/11 [00:00<00:01,  5.58it/s] 27%|██▋       | 3/11 [00:00<00:00,  9.84it/s] 45%|████▌     | 5/11 [00:00<00:00, 10.86it/s] 64%|██████▎   | 7/11 [00:00<00:00, 10.67it/s] 82%|████████▏ | 9/11 [00:00<00:00, 12.25it/s]100%|██████████| 11/11 [00:02<00:00,  2.76it/s]100%|██████████| 11/11 [00:02<00:00,  4.26it/s]
2025-03-09 07:26:34,249 [INFO]: 	Computing best hyperparameters for index knn.index 03/09/2025, 07:26:34
2025-03-09 07:27:02,796 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 28.5470 secs
2025-03-09 07:27:02,796 [INFO]: The best hyperparameters are: efSearch=339
2025-03-09 07:27:02,797 [INFO]: 	Compute fast metrics 03/09/2025, 07:27:02
  0%|          | 0/4 [00:00<?, ?it/s] 25%|██▌       | 1/4 [00:00<00:00,  7.13it/s] 75%|███████▌  | 3/4 [00:00<00:00, 11.58it/s] 75%|███████▌  | 3/4 [00:00<00:00,  8.80it/s]
2025-03-09 07:27:17,673 [INFO]: 	>>> Finished "Compute fast metrics" in 14.8765 secs
2025-03-09 07:27:17,675 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 46.0108 secs
2025-03-09 07:27:17,675 [INFO]: {
2025-03-09 07:27:17,675 [INFO]: 	index_key: HNSW15
2025-03-09 07:27:17,675 [INFO]: 	index_param: efSearch=339
2025-03-09 07:27:17,675 [INFO]: 	index_path: knn.index
2025-03-09 07:27:17,675 [INFO]: 	size in bytes: 527076670
2025-03-09 07:27:17,675 [INFO]: 	avg_search_speed_ms: 9.973890204743991
2025-03-09 07:27:17,675 [INFO]: 	99p_search_speed_ms: 16.424912163056437
2025-03-09 07:27:17,675 [INFO]: 	reconstruction error %: 0.0
2025-03-09 07:27:17,675 [INFO]: 	nb vectors: 2679
2025-03-09 07:27:17,675 [INFO]: 	vectors dimension: 49152
2025-03-09 07:27:17,675 [INFO]: 	compression ratio: 0.9993097057397741
2025-03-09 07:27:17,675 [INFO]: }
2025-03-09 07:27:17,675 [INFO]: 	>>> Finished "Creating the index" in 46.0121 secs
2025-03-09 07:27:17,675 [INFO]: >>> Finished "Launching the whole pipeline" in 46.0352 secs
2025-03-09 07:27:18: [retrieval_preprocessing] calculating distances ...
2025-03-09 07:27:18: [retrieval_preprocessing] finished and saved retrieval indices for episode 6691 [episode count 4/20]
[retrieval_preprocessing] for episode 61484 [episode count 5/20], we have num_retrieval=np.int64(2670) num_query=np.int64(128)
2025-03-09 07:27:19,407 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-09 07:27:19,765 [INFO]: Launching the whole pipeline 03/09/2025, 07:27:19
2025-03-09 07:27:19,765 [INFO]: Reading total number of vectors and dimension 03/09/2025, 07:27:19
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1781.02it/s]
2025-03-09 07:27:19,788 [INFO]: There are 2670 embeddings of dim 49152
2025-03-09 07:27:19,788 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0230 secs
2025-03-09 07:27:19,788 [INFO]: 	Compute estimated construction time of the index 03/09/2025, 07:27:19
2025-03-09 07:27:19,788 [INFO]: 		-> Train: 16.7 minutes
2025-03-09 07:27:19,788 [INFO]: 		-> Add: 1.5 seconds
2025-03-09 07:27:19,788 [INFO]: 		Total: 16.7 minutes
2025-03-09 07:27:19,788 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0001 secs
2025-03-09 07:27:19,788 [INFO]: 	Checking that your have enough memory available to create the index 03/09/2025, 07:27:19
2025-03-09 07:27:19,789 [INFO]: 551.0MB of memory will be needed to build the index (more might be used if you have more)
2025-03-09 07:27:19,789 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0001 secs
2025-03-09 07:27:19,789 [INFO]: 	Selecting most promising index types given data characteristics 03/09/2025, 07:27:19
2025-03-09 07:27:19,789 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-09 07:27:19,789 [INFO]: 	Creating the index 03/09/2025, 07:27:19
2025-03-09 07:27:19,789 [INFO]: 		-> Instanciate the index HNSW15 03/09/2025, 07:27:19
2025-03-09 07:27:19,789 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0008 secs
2025-03-09 07:27:19,790 [INFO]: 		-> Adding the vectors to the index 03/09/2025, 07:27:19
2025-03-09 07:27:19,790 [INFO]: The memory available for adding the vectors is 49.5GB(total available - used by the index)
2025-03-09 07:27:19,790 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/11 [00:00<?, ?it/s]  9%|▉         | 1/11 [00:00<00:01,  5.47it/s] 27%|██▋       | 3/11 [00:00<00:00,  8.56it/s] 36%|███▋      | 4/11 [00:00<00:00,  8.91it/s] 45%|████▌     | 5/11 [00:00<00:00,  9.13it/s] 55%|█████▍    | 6/11 [00:00<00:00,  9.10it/s] 64%|██████▎   | 7/11 [00:00<00:00,  8.85it/s] 73%|███████▎  | 8/11 [00:00<00:00,  8.65it/s] 82%|████████▏ | 9/11 [00:01<00:00,  8.63it/s] 91%|█████████ | 10/11 [00:01<00:00,  8.52it/s]100%|██████████| 11/11 [00:03<00:00,  1.46it/s]100%|██████████| 11/11 [00:03<00:00,  3.48it/s]
2025-03-09 07:27:22,956 [INFO]: 	Computing best hyperparameters for index knn.index 03/09/2025, 07:27:22
2025-03-09 07:27:48,439 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 25.4826 secs
2025-03-09 07:27:48,439 [INFO]: The best hyperparameters are: efSearch=411
2025-03-09 07:27:48,439 [INFO]: 	Compute fast metrics 03/09/2025, 07:27:48
  0%|          | 0/4 [00:00<?, ?it/s] 25%|██▌       | 1/4 [00:00<00:00,  6.80it/s] 75%|███████▌  | 3/4 [00:00<00:00, 10.35it/s] 75%|███████▌  | 3/4 [00:00<00:00,  7.96it/s]
2025-03-09 07:28:00,869 [INFO]: 	>>> Finished "Compute fast metrics" in 12.4296 secs
2025-03-09 07:28:00,871 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 41.0810 secs
2025-03-09 07:28:00,871 [INFO]: {
2025-03-09 07:28:00,871 [INFO]: 	index_key: HNSW15
2025-03-09 07:28:00,871 [INFO]: 	index_param: efSearch=411
2025-03-09 07:28:00,871 [INFO]: 	index_path: knn.index
2025-03-09 07:28:00,871 [INFO]: 	size in bytes: 525306010
2025-03-09 07:28:00,871 [INFO]: 	avg_search_speed_ms: 10.887904356662448
2025-03-09 07:28:00,871 [INFO]: 	99p_search_speed_ms: 15.835908572189417
2025-03-09 07:28:00,871 [INFO]: 	reconstruction error %: 0.0
2025-03-09 07:28:00,871 [INFO]: 	nb vectors: 2670
2025-03-09 07:28:00,871 [INFO]: 	vectors dimension: 49152
2025-03-09 07:28:00,871 [INFO]: 	compression ratio: 0.9993096404893597
2025-03-09 07:28:00,871 [INFO]: }
2025-03-09 07:28:00,871 [INFO]: 	>>> Finished "Creating the index" in 41.0822 secs
2025-03-09 07:28:00,871 [INFO]: >>> Finished "Launching the whole pipeline" in 41.1058 secs
2025-03-09 07:28:02: [retrieval_preprocessing] calculating distances ...
2025-03-09 07:28:03: [retrieval_preprocessing] finished and saved retrieval indices for episode 61484 [episode count 5/20]
[retrieval_preprocessing] for episode 84018 [episode count 6/20], we have num_retrieval=np.int64(2688) num_query=np.int64(110)
2025-03-09 07:28:03,868 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-09 07:28:04,214 [INFO]: Launching the whole pipeline 03/09/2025, 07:28:04
2025-03-09 07:28:04,214 [INFO]: Reading total number of vectors and dimension 03/09/2025, 07:28:04
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1798.59it/s]
2025-03-09 07:28:04,238 [INFO]: There are 2688 embeddings of dim 49152
2025-03-09 07:28:04,238 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0245 secs
2025-03-09 07:28:04,238 [INFO]: 	Compute estimated construction time of the index 03/09/2025, 07:28:04
2025-03-09 07:28:04,239 [INFO]: 		-> Train: 16.7 minutes
2025-03-09 07:28:04,239 [INFO]: 		-> Add: 1.5 seconds
2025-03-09 07:28:04,239 [INFO]: 		Total: 16.7 minutes
2025-03-09 07:28:04,239 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0005 secs
2025-03-09 07:28:04,239 [INFO]: 	Checking that your have enough memory available to create the index 03/09/2025, 07:28:04
2025-03-09 07:28:04,239 [INFO]: 554.7MB of memory will be needed to build the index (more might be used if you have more)
2025-03-09 07:28:04,240 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0004 secs
2025-03-09 07:28:04,240 [INFO]: 	Selecting most promising index types given data characteristics 03/09/2025, 07:28:04
2025-03-09 07:28:04,240 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-09 07:28:04,240 [INFO]: 	Creating the index 03/09/2025, 07:28:04
2025-03-09 07:28:04,240 [INFO]: 		-> Instanciate the index HNSW15 03/09/2025, 07:28:04
2025-03-09 07:28:04,243 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0026 secs
2025-03-09 07:28:04,243 [INFO]: 		-> Adding the vectors to the index 03/09/2025, 07:28:04
2025-03-09 07:28:04,243 [INFO]: The memory available for adding the vectors is 49.5GB(total available - used by the index)
2025-03-09 07:28:04,243 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/11 [00:00<?, ?it/s]  9%|▉         | 1/11 [00:00<00:01,  7.43it/s] 27%|██▋       | 3/11 [00:00<00:00, 10.84it/s] 45%|████▌     | 5/11 [00:00<00:00, 11.83it/s] 64%|██████▎   | 7/11 [00:00<00:00, 12.27it/s] 82%|████████▏ | 9/11 [00:00<00:00, 12.45it/s]100%|██████████| 11/11 [00:02<00:00,  2.70it/s]100%|██████████| 11/11 [00:02<00:00,  4.27it/s]
2025-03-09 07:28:06,823 [INFO]: 	Computing best hyperparameters for index knn.index 03/09/2025, 07:28:06
2025-03-09 07:28:34,554 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 27.7303 secs
2025-03-09 07:28:34,554 [INFO]: The best hyperparameters are: efSearch=343
2025-03-09 07:28:34,554 [INFO]: 	Compute fast metrics 03/09/2025, 07:28:34
  0%|          | 0/4 [00:00<?, ?it/s] 25%|██▌       | 1/4 [00:00<00:00,  7.14it/s] 75%|███████▌  | 3/4 [00:00<00:00, 10.62it/s] 75%|███████▌  | 3/4 [00:00<00:00,  8.09it/s]
2025-03-09 07:28:47,944 [INFO]: 	>>> Finished "Compute fast metrics" in 13.3895 secs
2025-03-09 07:28:47,946 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 43.7026 secs
2025-03-09 07:28:47,946 [INFO]: {
2025-03-09 07:28:47,946 [INFO]: 	index_key: HNSW15
2025-03-09 07:28:47,946 [INFO]: 	index_param: efSearch=343
2025-03-09 07:28:47,946 [INFO]: 	index_path: knn.index
2025-03-09 07:28:47,946 [INFO]: 	size in bytes: 528847330
2025-03-09 07:28:47,946 [INFO]: 	avg_search_speed_ms: 10.354240794423157
2025-03-09 07:28:47,946 [INFO]: 	99p_search_speed_ms: 15.047972463071348
2025-03-09 07:28:47,946 [INFO]: 	reconstruction error %: 0.0
2025-03-09 07:28:47,946 [INFO]: 	nb vectors: 2688
2025-03-09 07:28:47,946 [INFO]: 	vectors dimension: 49152
2025-03-09 07:28:47,946 [INFO]: 	compression ratio: 0.9993097705532521
2025-03-09 07:28:47,946 [INFO]: }
2025-03-09 07:28:47,946 [INFO]: 	>>> Finished "Creating the index" in 43.7060 secs
2025-03-09 07:28:47,946 [INFO]: >>> Finished "Launching the whole pipeline" in 43.7322 secs
2025-03-09 07:28:49: [retrieval_preprocessing] calculating distances ...
2025-03-09 07:28:49: [retrieval_preprocessing] finished and saved retrieval indices for episode 84018 [episode count 6/20]
[retrieval_preprocessing] for episode 32820 [episode count 7/20], we have num_retrieval=np.int64(2648) num_query=np.int64(150)
2025-03-09 07:28:50,380 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-09 07:28:50,779 [INFO]: Launching the whole pipeline 03/09/2025, 07:28:50
2025-03-09 07:28:50,779 [INFO]: Reading total number of vectors and dimension 03/09/2025, 07:28:50
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 2294.48it/s]
2025-03-09 07:28:50,803 [INFO]: There are 2648 embeddings of dim 49152
2025-03-09 07:28:50,803 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0241 secs
2025-03-09 07:28:50,803 [INFO]: 	Compute estimated construction time of the index 03/09/2025, 07:28:50
2025-03-09 07:28:50,804 [INFO]: 		-> Train: 16.7 minutes
2025-03-09 07:28:50,804 [INFO]: 		-> Add: 1.5 seconds
2025-03-09 07:28:50,804 [INFO]: 		Total: 16.7 minutes
2025-03-09 07:28:50,804 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0001 secs
2025-03-09 07:28:50,804 [INFO]: 	Checking that your have enough memory available to create the index 03/09/2025, 07:28:50
2025-03-09 07:28:50,804 [INFO]: 546.5MB of memory will be needed to build the index (more might be used if you have more)
2025-03-09 07:28:50,804 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0001 secs
2025-03-09 07:28:50,804 [INFO]: 	Selecting most promising index types given data characteristics 03/09/2025, 07:28:50
2025-03-09 07:28:50,804 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-09 07:28:50,804 [INFO]: 	Creating the index 03/09/2025, 07:28:50
2025-03-09 07:28:50,804 [INFO]: 		-> Instanciate the index HNSW15 03/09/2025, 07:28:50
2025-03-09 07:28:50,805 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0008 secs
2025-03-09 07:28:50,805 [INFO]: 		-> Adding the vectors to the index 03/09/2025, 07:28:50
2025-03-09 07:28:50,805 [INFO]: The memory available for adding the vectors is 49.5GB(total available - used by the index)
2025-03-09 07:28:50,805 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/11 [00:00<?, ?it/s]  9%|▉         | 1/11 [00:00<00:01,  6.19it/s] 27%|██▋       | 3/11 [00:00<00:00,  9.33it/s] 45%|████▌     | 5/11 [00:00<00:00, 10.63it/s] 64%|██████▎   | 7/11 [00:00<00:00, 11.26it/s] 82%|████████▏ | 9/11 [00:00<00:00, 11.56it/s]100%|██████████| 11/11 [00:02<00:00,  2.91it/s]100%|██████████| 11/11 [00:02<00:00,  4.45it/s]
2025-03-09 07:28:53,281 [INFO]: 	Computing best hyperparameters for index knn.index 03/09/2025, 07:28:53
2025-03-09 07:29:19,700 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 26.4186 secs
2025-03-09 07:29:19,701 [INFO]: The best hyperparameters are: efSearch=309
2025-03-09 07:29:19,701 [INFO]: 	Compute fast metrics 03/09/2025, 07:29:19
  0%|          | 0/4 [00:00<?, ?it/s] 25%|██▌       | 1/4 [00:00<00:00,  6.06it/s] 50%|█████     | 2/4 [00:00<00:00,  7.24it/s] 75%|███████▌  | 3/4 [00:00<00:00,  7.85it/s] 75%|███████▌  | 3/4 [00:00<00:00,  5.96it/s]
2025-03-09 07:29:32,658 [INFO]: 	>>> Finished "Compute fast metrics" in 12.9576 secs
2025-03-09 07:29:32,661 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 41.8556 secs
2025-03-09 07:29:32,661 [INFO]: {
2025-03-09 07:29:32,661 [INFO]: 	index_key: HNSW15
2025-03-09 07:29:32,661 [INFO]: 	index_param: efSearch=309
2025-03-09 07:29:32,661 [INFO]: 	index_path: knn.index
2025-03-09 07:29:32,661 [INFO]: 	size in bytes: 520977730
2025-03-09 07:29:32,661 [INFO]: 	avg_search_speed_ms: 9.571434173100231
2025-03-09 07:29:32,661 [INFO]: 	99p_search_speed_ms: 15.902262544259395
2025-03-09 07:29:32,661 [INFO]: 	reconstruction error %: 0.0
2025-03-09 07:29:32,661 [INFO]: 	nb vectors: 2648
2025-03-09 07:29:32,661 [INFO]: 	vectors dimension: 49152
2025-03-09 07:29:32,661 [INFO]: 	compression ratio: 0.9993094791211133
2025-03-09 07:29:32,661 [INFO]: }
2025-03-09 07:29:32,661 [INFO]: 	>>> Finished "Creating the index" in 41.8574 secs
2025-03-09 07:29:32,661 [INFO]: >>> Finished "Launching the whole pipeline" in 41.8822 secs
2025-03-09 07:29:33: [retrieval_preprocessing] calculating distances ...
2025-03-09 07:29:34: [retrieval_preprocessing] finished and saved retrieval indices for episode 32820 [episode count 7/20]
[retrieval_preprocessing] for episode 7733 [episode count 8/20], we have num_retrieval=np.int64(2629) num_query=np.int64(169)
2025-03-09 07:29:34,742 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-09 07:29:35,084 [INFO]: Launching the whole pipeline 03/09/2025, 07:29:35
2025-03-09 07:29:35,084 [INFO]: Reading total number of vectors and dimension 03/09/2025, 07:29:35
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1501.18it/s]
2025-03-09 07:29:35,108 [INFO]: There are 2629 embeddings of dim 49152
2025-03-09 07:29:35,108 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0241 secs
2025-03-09 07:29:35,108 [INFO]: 	Compute estimated construction time of the index 03/09/2025, 07:29:35
2025-03-09 07:29:35,108 [INFO]: 		-> Train: 16.7 minutes
2025-03-09 07:29:35,108 [INFO]: 		-> Add: 1.4 seconds
2025-03-09 07:29:35,108 [INFO]: 		Total: 16.7 minutes
2025-03-09 07:29:35,108 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0001 secs
2025-03-09 07:29:35,108 [INFO]: 	Checking that your have enough memory available to create the index 03/09/2025, 07:29:35
2025-03-09 07:29:35,108 [INFO]: 542.6MB of memory will be needed to build the index (more might be used if you have more)
2025-03-09 07:29:35,108 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0001 secs
2025-03-09 07:29:35,109 [INFO]: 	Selecting most promising index types given data characteristics 03/09/2025, 07:29:35
2025-03-09 07:29:35,109 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-09 07:29:35,109 [INFO]: 	Creating the index 03/09/2025, 07:29:35
2025-03-09 07:29:35,109 [INFO]: 		-> Instanciate the index HNSW15 03/09/2025, 07:29:35
2025-03-09 07:29:35,110 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0009 secs
2025-03-09 07:29:35,110 [INFO]: 		-> Adding the vectors to the index 03/09/2025, 07:29:35
2025-03-09 07:29:35,110 [INFO]: The memory available for adding the vectors is 49.5GB(total available - used by the index)
2025-03-09 07:29:35,110 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/11 [00:00<?, ?it/s]  9%|▉         | 1/11 [00:00<00:01,  6.13it/s] 45%|████▌     | 5/11 [00:00<00:00, 18.95it/s] 73%|███████▎  | 8/11 [00:00<00:00, 14.56it/s] 91%|█████████ | 10/11 [00:00<00:00, 15.20it/s]100%|██████████| 11/11 [00:02<00:00,  4.82it/s]
2025-03-09 07:29:37,395 [INFO]: 	Computing best hyperparameters for index knn.index 03/09/2025, 07:29:37
2025-03-09 07:30:07,252 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 29.8565 secs
2025-03-09 07:30:07,253 [INFO]: The best hyperparameters are: efSearch=392
2025-03-09 07:30:07,253 [INFO]: 	Compute fast metrics 03/09/2025, 07:30:07
  0%|          | 0/4 [00:00<?, ?it/s] 25%|██▌       | 1/4 [00:00<00:00,  9.27it/s] 50%|█████     | 2/4 [00:00<00:00,  7.99it/s] 75%|███████▌  | 3/4 [00:00<00:00,  9.01it/s]
2025-03-09 07:30:28,056 [INFO]: 	>>> Finished "Compute fast metrics" in 20.8034 secs
2025-03-09 07:30:28,058 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 52.9484 secs
2025-03-09 07:30:28,058 [INFO]: {
2025-03-09 07:30:28,058 [INFO]: 	index_key: HNSW15
2025-03-09 07:30:28,058 [INFO]: 	index_param: efSearch=392
2025-03-09 07:30:28,058 [INFO]: 	index_path: knn.index
2025-03-09 07:30:28,058 [INFO]: 	size in bytes: 517239670
2025-03-09 07:30:28,058 [INFO]: 	avg_search_speed_ms: 11.804646344518964
2025-03-09 07:30:28,058 [INFO]: 	99p_search_speed_ms: 16.826591906137757
2025-03-09 07:30:28,058 [INFO]: 	reconstruction error %: 0.0
2025-03-09 07:30:28,058 [INFO]: 	nb vectors: 2629
2025-03-09 07:30:28,058 [INFO]: 	vectors dimension: 49152
2025-03-09 07:30:28,058 [INFO]: 	compression ratio: 0.9993093375842576
2025-03-09 07:30:28,058 [INFO]: }
2025-03-09 07:30:28,058 [INFO]: 	>>> Finished "Creating the index" in 52.9496 secs
2025-03-09 07:30:28,058 [INFO]: >>> Finished "Launching the whole pipeline" in 52.9743 secs
2025-03-09 07:30:30: [retrieval_preprocessing] calculating distances ...
2025-03-09 07:30:30: [retrieval_preprocessing] finished and saved retrieval indices for episode 7733 [episode count 8/20]
[retrieval_preprocessing] for episode 5181 [episode count 9/20], we have num_retrieval=np.int64(2590) num_query=np.int64(208)
2025-03-09 07:30:37,284 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-09 07:30:37,920 [INFO]: Launching the whole pipeline 03/09/2025, 07:30:37
2025-03-09 07:30:37,920 [INFO]: Reading total number of vectors and dimension 03/09/2025, 07:30:37
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 2063.11it/s]
2025-03-09 07:30:37,944 [INFO]: There are 2590 embeddings of dim 49152
2025-03-09 07:30:37,944 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0242 secs
2025-03-09 07:30:37,944 [INFO]: 	Compute estimated construction time of the index 03/09/2025, 07:30:37
2025-03-09 07:30:37,944 [INFO]: 		-> Train: 16.7 minutes
2025-03-09 07:30:37,944 [INFO]: 		-> Add: 1.4 seconds
2025-03-09 07:30:37,944 [INFO]: 		Total: 16.7 minutes
2025-03-09 07:30:37,944 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0001 secs
2025-03-09 07:30:37,945 [INFO]: 	Checking that your have enough memory available to create the index 03/09/2025, 07:30:37
2025-03-09 07:30:37,945 [INFO]: 534.5MB of memory will be needed to build the index (more might be used if you have more)
2025-03-09 07:30:37,945 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0002 secs
2025-03-09 07:30:37,945 [INFO]: 	Selecting most promising index types given data characteristics 03/09/2025, 07:30:37
2025-03-09 07:30:37,945 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-09 07:30:37,945 [INFO]: 	Creating the index 03/09/2025, 07:30:37
2025-03-09 07:30:37,945 [INFO]: 		-> Instanciate the index HNSW15 03/09/2025, 07:30:37
2025-03-09 07:30:37,946 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0010 secs
2025-03-09 07:30:37,946 [INFO]: 		-> Adding the vectors to the index 03/09/2025, 07:30:37
2025-03-09 07:30:37,946 [INFO]: The memory available for adding the vectors is 49.5GB(total available - used by the index)
2025-03-09 07:30:37,946 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/11 [00:00<?, ?it/s]  9%|▉         | 1/11 [00:00<00:01,  5.93it/s] 27%|██▋       | 3/11 [00:00<00:00, 11.05it/s] 45%|████▌     | 5/11 [00:00<00:00, 12.99it/s] 64%|██████▎   | 7/11 [00:00<00:00, 13.79it/s] 82%|████████▏ | 9/11 [00:00<00:00, 15.50it/s]100%|██████████| 11/11 [00:02<00:00,  3.04it/s]100%|██████████| 11/11 [00:02<00:00,  4.78it/s]
2025-03-09 07:30:40,252 [INFO]: 	Computing best hyperparameters for index knn.index 03/09/2025, 07:30:40
2025-03-09 07:31:12,684 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 32.4322 secs
2025-03-09 07:31:12,684 [INFO]: The best hyperparameters are: efSearch=291
2025-03-09 07:31:12,684 [INFO]: 	Compute fast metrics 03/09/2025, 07:31:12
  0%|          | 0/4 [00:00<?, ?it/s] 25%|██▌       | 1/4 [00:00<00:00,  5.12it/s] 50%|█████     | 2/4 [00:00<00:00,  6.59it/s] 75%|███████▌  | 3/4 [00:00<00:00,  7.27it/s] 75%|███████▌  | 3/4 [00:00<00:00,  5.50it/s]
2025-03-09 07:31:35,212 [INFO]: 	>>> Finished "Compute fast metrics" in 22.5276 secs
2025-03-09 07:31:35,214 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 57.2683 secs
2025-03-09 07:31:35,214 [INFO]: {
2025-03-09 07:31:35,215 [INFO]: 	index_key: HNSW15
2025-03-09 07:31:35,215 [INFO]: 	index_param: efSearch=291
2025-03-09 07:31:35,215 [INFO]: 	index_path: knn.index
2025-03-09 07:31:35,215 [INFO]: 	size in bytes: 509566630
2025-03-09 07:31:35,215 [INFO]: 	avg_search_speed_ms: 9.844314603741816
2025-03-09 07:31:35,215 [INFO]: 	99p_search_speed_ms: 15.822902077343317
2025-03-09 07:31:35,215 [INFO]: 	reconstruction error %: 0.0
2025-03-09 07:31:35,215 [INFO]: 	nb vectors: 2590
2025-03-09 07:31:35,215 [INFO]: 	vectors dimension: 49152
2025-03-09 07:31:35,215 [INFO]: 	compression ratio: 0.9993093935527136
2025-03-09 07:31:35,215 [INFO]: }
2025-03-09 07:31:35,215 [INFO]: 	>>> Finished "Creating the index" in 57.2699 secs
2025-03-09 07:31:35,215 [INFO]: >>> Finished "Launching the whole pipeline" in 57.2948 secs
2025-03-09 07:31:36: [retrieval_preprocessing] calculating distances ...
2025-03-09 07:31:37: [retrieval_preprocessing] finished and saved retrieval indices for episode 5181 [episode count 9/20]
[retrieval_preprocessing] for episode 23620 [episode count 10/20], we have num_retrieval=np.int64(2688) num_query=np.int64(110)
2025-03-09 07:31:44,240 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-09 07:31:44,679 [INFO]: Launching the whole pipeline 03/09/2025, 07:31:44
2025-03-09 07:31:44,679 [INFO]: Reading total number of vectors and dimension 03/09/2025, 07:31:44
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1165.73it/s]
2025-03-09 07:31:44,713 [INFO]: There are 2688 embeddings of dim 49152
2025-03-09 07:31:44,713 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0336 secs
2025-03-09 07:31:44,713 [INFO]: 	Compute estimated construction time of the index 03/09/2025, 07:31:44
2025-03-09 07:31:44,713 [INFO]: 		-> Train: 16.7 minutes
2025-03-09 07:31:44,713 [INFO]: 		-> Add: 1.5 seconds
2025-03-09 07:31:44,713 [INFO]: 		Total: 16.7 minutes
2025-03-09 07:31:44,713 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0001 secs
2025-03-09 07:31:44,713 [INFO]: 	Checking that your have enough memory available to create the index 03/09/2025, 07:31:44
2025-03-09 07:31:44,714 [INFO]: 554.7MB of memory will be needed to build the index (more might be used if you have more)
2025-03-09 07:31:44,714 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0002 secs
2025-03-09 07:31:44,714 [INFO]: 	Selecting most promising index types given data characteristics 03/09/2025, 07:31:44
2025-03-09 07:31:44,714 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-09 07:31:44,714 [INFO]: 	Creating the index 03/09/2025, 07:31:44
2025-03-09 07:31:44,714 [INFO]: 		-> Instanciate the index HNSW15 03/09/2025, 07:31:44
2025-03-09 07:31:44,715 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0015 secs
2025-03-09 07:31:44,715 [INFO]: 		-> Adding the vectors to the index 03/09/2025, 07:31:44
2025-03-09 07:31:44,716 [INFO]: The memory available for adding the vectors is 49.5GB(total available - used by the index)
2025-03-09 07:31:44,716 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/11 [00:00<?, ?it/s]  9%|▉         | 1/11 [00:00<00:01,  7.83it/s] 27%|██▋       | 3/11 [00:00<00:00, 11.58it/s] 45%|████▌     | 5/11 [00:00<00:00, 14.40it/s] 64%|██████▎   | 7/11 [00:00<00:00, 13.99it/s] 82%|████████▏ | 9/11 [00:00<00:00, 12.83it/s]100%|██████████| 11/11 [00:02<00:00,  2.59it/s]100%|██████████| 11/11 [00:02<00:00,  4.20it/s]
2025-03-09 07:31:47,339 [INFO]: 	Computing best hyperparameters for index knn.index 03/09/2025, 07:31:47
2025-03-09 07:32:18,004 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 30.6641 secs
2025-03-09 07:32:18,004 [INFO]: The best hyperparameters are: efSearch=336
2025-03-09 07:32:18,004 [INFO]: 	Compute fast metrics 03/09/2025, 07:32:18
  0%|          | 0/4 [00:00<?, ?it/s] 25%|██▌       | 1/4 [00:00<00:00,  5.79it/s] 50%|█████     | 2/4 [00:00<00:00,  7.48it/s] 75%|███████▌  | 3/4 [00:00<00:00,  8.36it/s] 75%|███████▌  | 3/4 [00:00<00:00,  6.31it/s]
2025-03-09 07:32:32,420 [INFO]: 	>>> Finished "Compute fast metrics" in 14.4155 secs
2025-03-09 07:32:32,692 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 47.9767 secs
2025-03-09 07:32:32,693 [INFO]: {
2025-03-09 07:32:32,693 [INFO]: 	index_key: HNSW15
2025-03-09 07:32:32,693 [INFO]: 	index_param: efSearch=336
2025-03-09 07:32:32,693 [INFO]: 	index_path: knn.index
2025-03-09 07:32:32,693 [INFO]: 	size in bytes: 528847330
2025-03-09 07:32:32,693 [INFO]: 	avg_search_speed_ms: 11.277229629358299
2025-03-09 07:32:32,693 [INFO]: 	99p_search_speed_ms: 17.541004605591294
2025-03-09 07:32:32,693 [INFO]: 	reconstruction error %: 0.0
2025-03-09 07:32:32,693 [INFO]: 	nb vectors: 2688
2025-03-09 07:32:32,693 [INFO]: 	vectors dimension: 49152
2025-03-09 07:32:32,693 [INFO]: 	compression ratio: 0.9993097705532521
2025-03-09 07:32:32,693 [INFO]: }
2025-03-09 07:32:32,693 [INFO]: 	>>> Finished "Creating the index" in 47.9795 secs
2025-03-09 07:32:32,693 [INFO]: >>> Finished "Launching the whole pipeline" in 48.0139 secs
2025-03-09 07:32:33: [retrieval_preprocessing] calculating distances ...
2025-03-09 07:32:33: [retrieval_preprocessing] finished and saved retrieval indices for episode 23620 [episode count 10/20]
[retrieval_preprocessing] for episode 75336 [episode count 11/20], we have num_retrieval=np.int64(2653) num_query=np.int64(145)
2025-03-09 07:32:34,546 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-09 07:32:34,947 [INFO]: Launching the whole pipeline 03/09/2025, 07:32:34
2025-03-09 07:32:34,947 [INFO]: Reading total number of vectors and dimension 03/09/2025, 07:32:34
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1544.86it/s]
2025-03-09 07:32:34,972 [INFO]: There are 2653 embeddings of dim 49152
2025-03-09 07:32:34,973 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0256 secs
2025-03-09 07:32:34,973 [INFO]: 	Compute estimated construction time of the index 03/09/2025, 07:32:34
2025-03-09 07:32:34,973 [INFO]: 		-> Train: 16.7 minutes
2025-03-09 07:32:34,973 [INFO]: 		-> Add: 1.5 seconds
2025-03-09 07:32:34,973 [INFO]: 		Total: 16.7 minutes
2025-03-09 07:32:34,973 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0001 secs
2025-03-09 07:32:34,973 [INFO]: 	Checking that your have enough memory available to create the index 03/09/2025, 07:32:34
2025-03-09 07:32:34,973 [INFO]: 547.5MB of memory will be needed to build the index (more might be used if you have more)
2025-03-09 07:32:34,973 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0001 secs
2025-03-09 07:32:34,973 [INFO]: 	Selecting most promising index types given data characteristics 03/09/2025, 07:32:34
2025-03-09 07:32:34,973 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-09 07:32:34,973 [INFO]: 	Creating the index 03/09/2025, 07:32:34
2025-03-09 07:32:34,973 [INFO]: 		-> Instanciate the index HNSW15 03/09/2025, 07:32:34
2025-03-09 07:32:34,974 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0011 secs
2025-03-09 07:32:34,974 [INFO]: 		-> Adding the vectors to the index 03/09/2025, 07:32:34
2025-03-09 07:32:34,974 [INFO]: The memory available for adding the vectors is 49.5GB(total available - used by the index)
2025-03-09 07:32:34,974 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/11 [00:00<?, ?it/s]  9%|▉         | 1/11 [00:00<00:02,  4.95it/s] 18%|█▊        | 2/11 [00:00<00:01,  6.25it/s] 27%|██▋       | 3/11 [00:00<00:01,  7.42it/s] 45%|████▌     | 5/11 [00:00<00:00,  8.59it/s] 64%|██████▎   | 7/11 [00:00<00:00,  9.32it/s] 73%|███████▎  | 8/11 [00:00<00:00,  9.23it/s] 82%|████████▏ | 9/11 [00:01<00:00,  9.21it/s] 91%|█████████ | 10/11 [00:01<00:00,  9.40it/s]100%|██████████| 11/11 [00:02<00:00,  1.79it/s]100%|██████████| 11/11 [00:02<00:00,  3.80it/s]
2025-03-09 07:32:37,869 [INFO]: 	Computing best hyperparameters for index knn.index 03/09/2025, 07:32:37
2025-03-09 07:33:07,257 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 29.3875 secs
2025-03-09 07:33:07,258 [INFO]: The best hyperparameters are: efSearch=275
2025-03-09 07:33:07,258 [INFO]: 	Compute fast metrics 03/09/2025, 07:33:07
  0%|          | 0/4 [00:00<?, ?it/s] 25%|██▌       | 1/4 [00:00<00:00,  7.50it/s] 75%|███████▌  | 3/4 [00:00<00:00, 12.21it/s] 75%|███████▌  | 3/4 [00:00<00:00,  9.23it/s]
2025-03-09 07:33:22,078 [INFO]: 	>>> Finished "Compute fast metrics" in 14.8208 secs
2025-03-09 07:33:22,082 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 47.1077 secs
2025-03-09 07:33:22,082 [INFO]: {
2025-03-09 07:33:22,082 [INFO]: 	index_key: HNSW15
2025-03-09 07:33:22,082 [INFO]: 	index_param: efSearch=275
2025-03-09 07:33:22,082 [INFO]: 	index_path: knn.index
2025-03-09 07:33:22,082 [INFO]: 	size in bytes: 521961430
2025-03-09 07:33:22,082 [INFO]: 	avg_search_speed_ms: 10.384343248266854
2025-03-09 07:33:22,082 [INFO]: 	99p_search_speed_ms: 18.699405370280147
2025-03-09 07:33:22,082 [INFO]: 	reconstruction error %: 0.0
2025-03-09 07:33:22,082 [INFO]: 	nb vectors: 2653
2025-03-09 07:33:22,082 [INFO]: 	vectors dimension: 49152
2025-03-09 07:33:22,082 [INFO]: 	compression ratio: 0.9993095160307152
2025-03-09 07:33:22,082 [INFO]: }
2025-03-09 07:33:22,082 [INFO]: 	>>> Finished "Creating the index" in 47.1093 secs
2025-03-09 07:33:22,082 [INFO]: >>> Finished "Launching the whole pipeline" in 47.1355 secs
2025-03-09 07:33:23: [retrieval_preprocessing] calculating distances ...
2025-03-09 07:33:23: [retrieval_preprocessing] finished and saved retrieval indices for episode 75336 [episode count 11/20]
[retrieval_preprocessing] for episode 70218 [episode count 12/20], we have num_retrieval=np.int64(2660) num_query=np.int64(138)
2025-03-09 07:33:31,891 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-09 07:33:32,915 [INFO]: Launching the whole pipeline 03/09/2025, 07:33:32
2025-03-09 07:33:32,915 [INFO]: Reading total number of vectors and dimension 03/09/2025, 07:33:32
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1129.32it/s]
2025-03-09 07:33:32,942 [INFO]: There are 2660 embeddings of dim 49152
2025-03-09 07:33:32,942 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0268 secs
2025-03-09 07:33:32,942 [INFO]: 	Compute estimated construction time of the index 03/09/2025, 07:33:32
2025-03-09 07:33:32,942 [INFO]: 		-> Train: 16.7 minutes
2025-03-09 07:33:32,942 [INFO]: 		-> Add: 1.5 seconds
2025-03-09 07:33:32,942 [INFO]: 		Total: 16.7 minutes
2025-03-09 07:33:32,942 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0001 secs
2025-03-09 07:33:32,942 [INFO]: 	Checking that your have enough memory available to create the index 03/09/2025, 07:33:32
2025-03-09 07:33:32,942 [INFO]: 549.0MB of memory will be needed to build the index (more might be used if you have more)
2025-03-09 07:33:32,942 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0002 secs
2025-03-09 07:33:32,942 [INFO]: 	Selecting most promising index types given data characteristics 03/09/2025, 07:33:32
2025-03-09 07:33:32,942 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-09 07:33:32,943 [INFO]: 	Creating the index 03/09/2025, 07:33:32
2025-03-09 07:33:32,943 [INFO]: 		-> Instanciate the index HNSW15 03/09/2025, 07:33:32
2025-03-09 07:33:32,944 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0011 secs
2025-03-09 07:33:32,944 [INFO]: 		-> Adding the vectors to the index 03/09/2025, 07:33:32
2025-03-09 07:33:32,944 [INFO]: The memory available for adding the vectors is 49.5GB(total available - used by the index)
2025-03-09 07:33:32,944 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/11 [00:00<?, ?it/s]  9%|▉         | 1/11 [00:01<00:10,  1.06s/it] 27%|██▋       | 3/11 [00:01<00:02,  3.14it/s] 45%|████▌     | 5/11 [00:01<00:01,  5.34it/s] 64%|██████▎   | 7/11 [00:02<00:01,  3.59it/s]100%|██████████| 11/11 [00:04<00:00,  2.31it/s]100%|██████████| 11/11 [00:04<00:00,  2.53it/s]
2025-03-09 07:33:37,299 [INFO]: 	Computing best hyperparameters for index knn.index 03/09/2025, 07:33:37
2025-03-09 07:34:08,787 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 31.4882 secs
2025-03-09 07:34:08,788 [INFO]: The best hyperparameters are: efSearch=188
2025-03-09 07:34:08,788 [INFO]: 	Compute fast metrics 03/09/2025, 07:34:08
  0%|          | 0/4 [00:00<?, ?it/s] 25%|██▌       | 1/4 [00:00<00:00,  7.13it/s] 50%|█████     | 2/4 [00:00<00:00,  8.13it/s] 75%|███████▌  | 3/4 [00:00<00:00,  8.40it/s] 75%|███████▌  | 3/4 [00:00<00:00,  6.39it/s]
2025-03-09 07:34:20,793 [INFO]: 	>>> Finished "Compute fast metrics" in 12.0047 secs
2025-03-09 07:34:20,799 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 47.8554 secs
2025-03-09 07:34:20,800 [INFO]: {
2025-03-09 07:34:20,800 [INFO]: 	index_key: HNSW15
2025-03-09 07:34:20,800 [INFO]: 	index_param: efSearch=188
2025-03-09 07:34:20,800 [INFO]: 	index_path: knn.index
2025-03-09 07:34:20,800 [INFO]: 	size in bytes: 523338610
2025-03-09 07:34:20,800 [INFO]: 	avg_search_speed_ms: 7.5696613747107655
2025-03-09 07:34:20,800 [INFO]: 	99p_search_speed_ms: 15.237463498488056
2025-03-09 07:34:20,800 [INFO]: 	reconstruction error %: 0.0
2025-03-09 07:34:20,800 [INFO]: 	nb vectors: 2660
2025-03-09 07:34:20,800 [INFO]: 	vectors dimension: 49152
2025-03-09 07:34:20,800 [INFO]: 	compression ratio: 0.999309567471049
2025-03-09 07:34:20,800 [INFO]: }
2025-03-09 07:34:20,800 [INFO]: 	>>> Finished "Creating the index" in 47.8572 secs
2025-03-09 07:34:20,800 [INFO]: >>> Finished "Launching the whole pipeline" in 47.8847 secs
2025-03-09 07:34:21: [retrieval_preprocessing] calculating distances ...
2025-03-09 07:34:21: [retrieval_preprocessing] finished and saved retrieval indices for episode 70218 [episode count 12/20]
[retrieval_preprocessing] for episode 54870 [episode count 13/20], we have num_retrieval=np.int64(2646) num_query=np.int64(152)
2025-03-09 07:34:22,116 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-09 07:34:22,462 [INFO]: Launching the whole pipeline 03/09/2025, 07:34:22
2025-03-09 07:34:22,462 [INFO]: Reading total number of vectors and dimension 03/09/2025, 07:34:22
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1300.96it/s]
2025-03-09 07:34:22,494 [INFO]: There are 2646 embeddings of dim 49152
2025-03-09 07:34:22,495 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0323 secs
2025-03-09 07:34:22,495 [INFO]: 	Compute estimated construction time of the index 03/09/2025, 07:34:22
2025-03-09 07:34:22,495 [INFO]: 		-> Train: 16.7 minutes
2025-03-09 07:34:22,495 [INFO]: 		-> Add: 1.5 seconds
2025-03-09 07:34:22,495 [INFO]: 		Total: 16.7 minutes
2025-03-09 07:34:22,496 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0005 secs
2025-03-09 07:34:22,496 [INFO]: 	Checking that your have enough memory available to create the index 03/09/2025, 07:34:22
2025-03-09 07:34:22,496 [INFO]: 546.1MB of memory will be needed to build the index (more might be used if you have more)
2025-03-09 07:34:22,496 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0005 secs
2025-03-09 07:34:22,496 [INFO]: 	Selecting most promising index types given data characteristics 03/09/2025, 07:34:22
2025-03-09 07:34:22,496 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-09 07:34:22,496 [INFO]: 	Creating the index 03/09/2025, 07:34:22
2025-03-09 07:34:22,497 [INFO]: 		-> Instanciate the index HNSW15 03/09/2025, 07:34:22
2025-03-09 07:34:22,499 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0028 secs
2025-03-09 07:34:22,500 [INFO]: 		-> Adding the vectors to the index 03/09/2025, 07:34:22
2025-03-09 07:34:22,500 [INFO]: The memory available for adding the vectors is 49.5GB(total available - used by the index)
2025-03-09 07:34:22,500 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/11 [00:00<?, ?it/s] 27%|██▋       | 3/11 [00:00<00:00, 25.43it/s] 64%|██████▎   | 7/11 [00:00<00:00, 32.09it/s]100%|██████████| 11/11 [00:02<00:00,  4.09it/s]100%|██████████| 11/11 [00:02<00:00,  5.19it/s]
2025-03-09 07:34:24,623 [INFO]: 	Computing best hyperparameters for index knn.index 03/09/2025, 07:34:24
2025-03-09 07:35:02,673 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 38.0493 secs
2025-03-09 07:35:02,674 [INFO]: The best hyperparameters are: efSearch=330
2025-03-09 07:35:02,674 [INFO]: 	Compute fast metrics 03/09/2025, 07:35:02
  0%|          | 0/4 [00:00<?, ?it/s] 25%|██▌       | 1/4 [00:01<00:04,  1.59s/it] 50%|█████     | 2/4 [00:01<00:01,  1.15it/s] 75%|███████▌  | 3/4 [00:02<00:00,  1.40it/s] 75%|███████▌  | 3/4 [00:03<00:01,  1.00s/it]
2025-03-09 07:35:18,666 [INFO]: 	>>> Finished "Compute fast metrics" in 15.9918 secs
2025-03-09 07:35:18,668 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 56.1684 secs
2025-03-09 07:35:18,668 [INFO]: {
2025-03-09 07:35:18,668 [INFO]: 	index_key: HNSW15
2025-03-09 07:35:18,669 [INFO]: 	index_param: efSearch=330
2025-03-09 07:35:18,669 [INFO]: 	index_path: knn.index
2025-03-09 07:35:18,669 [INFO]: 	size in bytes: 520584250
2025-03-09 07:35:18,669 [INFO]: 	avg_search_speed_ms: 12.078863505334796
2025-03-09 07:35:18,669 [INFO]: 	99p_search_speed_ms: 31.068564574234188
2025-03-09 07:35:18,669 [INFO]: 	reconstruction error %: 0.0
2025-03-09 07:35:18,669 [INFO]: 	nb vectors: 2646
2025-03-09 07:35:18,669 [INFO]: 	vectors dimension: 49152
2025-03-09 07:35:18,669 [INFO]: 	compression ratio: 0.9993094643182155
2025-03-09 07:35:18,669 [INFO]: }
2025-03-09 07:35:18,669 [INFO]: 	>>> Finished "Creating the index" in 56.1721 secs
2025-03-09 07:35:18,669 [INFO]: >>> Finished "Launching the whole pipeline" in 56.2064 secs
2025-03-09 07:35:19: [retrieval_preprocessing] calculating distances ...
2025-03-09 07:35:20: [retrieval_preprocessing] finished and saved retrieval indices for episode 54870 [episode count 13/20]
[retrieval_preprocessing] for episode 40027 [episode count 14/20], we have num_retrieval=np.int64(2638) num_query=np.int64(160)
2025-03-09 07:35:20,501 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-09 07:35:20,932 [INFO]: Launching the whole pipeline 03/09/2025, 07:35:20
2025-03-09 07:35:20,932 [INFO]: Reading total number of vectors and dimension 03/09/2025, 07:35:20
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1593.58it/s]
2025-03-09 07:35:20,961 [INFO]: There are 2638 embeddings of dim 49152
2025-03-09 07:35:20,961 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0289 secs
2025-03-09 07:35:20,961 [INFO]: 	Compute estimated construction time of the index 03/09/2025, 07:35:20
2025-03-09 07:35:20,961 [INFO]: 		-> Train: 16.7 minutes
2025-03-09 07:35:20,961 [INFO]: 		-> Add: 1.4 seconds
2025-03-09 07:35:20,962 [INFO]: 		Total: 16.7 minutes
2025-03-09 07:35:20,962 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0001 secs
2025-03-09 07:35:20,962 [INFO]: 	Checking that your have enough memory available to create the index 03/09/2025, 07:35:20
2025-03-09 07:35:20,962 [INFO]: 544.4MB of memory will be needed to build the index (more might be used if you have more)
2025-03-09 07:35:20,962 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0002 secs
2025-03-09 07:35:20,962 [INFO]: 	Selecting most promising index types given data characteristics 03/09/2025, 07:35:20
2025-03-09 07:35:20,962 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-09 07:35:20,962 [INFO]: 	Creating the index 03/09/2025, 07:35:20
2025-03-09 07:35:20,962 [INFO]: 		-> Instanciate the index HNSW15 03/09/2025, 07:35:20
2025-03-09 07:35:20,963 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0013 secs
2025-03-09 07:35:20,963 [INFO]: 		-> Adding the vectors to the index 03/09/2025, 07:35:20
2025-03-09 07:35:20,964 [INFO]: The memory available for adding the vectors is 49.5GB(total available - used by the index)
2025-03-09 07:35:20,964 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/11 [00:00<?, ?it/s] 18%|█▊        | 2/11 [00:00<00:00, 18.13it/s] 64%|██████▎   | 7/11 [00:00<00:00, 35.44it/s]100%|██████████| 11/11 [00:02<00:00,  4.01it/s]100%|██████████| 11/11 [00:02<00:00,  4.99it/s]
2025-03-09 07:35:23,171 [INFO]: 	Computing best hyperparameters for index knn.index 03/09/2025, 07:35:23
2025-03-09 07:36:05,953 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 42.7824 secs
2025-03-09 07:36:05,954 [INFO]: The best hyperparameters are: efSearch=247
2025-03-09 07:36:05,954 [INFO]: 	Compute fast metrics 03/09/2025, 07:36:05
  0%|          | 0/4 [00:00<?, ?it/s] 25%|██▌       | 1/4 [00:00<00:00,  7.39it/s] 75%|███████▌  | 3/4 [00:00<00:00, 13.84it/s] 75%|███████▌  | 3/4 [00:00<00:00, 11.79it/s]
2025-03-09 07:36:22,771 [INFO]: 	>>> Finished "Compute fast metrics" in 16.8167 secs
2025-03-09 07:36:22,772 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 61.8088 secs
2025-03-09 07:36:22,772 [INFO]: {
2025-03-09 07:36:22,772 [INFO]: 	index_key: HNSW15
2025-03-09 07:36:22,773 [INFO]: 	index_param: efSearch=247
2025-03-09 07:36:22,773 [INFO]: 	index_path: knn.index
2025-03-09 07:36:22,773 [INFO]: 	size in bytes: 519010330
2025-03-09 07:36:22,773 [INFO]: 	avg_search_speed_ms: 10.011446984341225
2025-03-09 07:36:22,773 [INFO]: 	99p_search_speed_ms: 23.144744462333616
2025-03-09 07:36:22,773 [INFO]: 	reconstruction error %: 0.0
2025-03-09 07:36:22,773 [INFO]: 	nb vectors: 2638
2025-03-09 07:36:22,773 [INFO]: 	vectors dimension: 49152
2025-03-09 07:36:22,773 [INFO]: 	compression ratio: 0.9993094048821726
2025-03-09 07:36:22,773 [INFO]: }
2025-03-09 07:36:22,773 [INFO]: 	>>> Finished "Creating the index" in 61.8107 secs
2025-03-09 07:36:22,773 [INFO]: >>> Finished "Launching the whole pipeline" in 61.8403 secs
2025-03-09 07:36:23: [retrieval_preprocessing] calculating distances ...
2025-03-09 07:36:24: [retrieval_preprocessing] finished and saved retrieval indices for episode 40027 [episode count 14/20]
[retrieval_preprocessing] for episode 59487 [episode count 15/20], we have num_retrieval=np.int64(2662) num_query=np.int64(136)
2025-03-09 07:36:24,435 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-09 07:36:24,856 [INFO]: Launching the whole pipeline 03/09/2025, 07:36:24
2025-03-09 07:36:24,856 [INFO]: Reading total number of vectors and dimension 03/09/2025, 07:36:24
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1352.13it/s]
2025-03-09 07:36:24,888 [INFO]: There are 2662 embeddings of dim 49152
2025-03-09 07:36:24,889 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0325 secs
2025-03-09 07:36:24,889 [INFO]: 	Compute estimated construction time of the index 03/09/2025, 07:36:24
2025-03-09 07:36:24,889 [INFO]: 		-> Train: 16.7 minutes
2025-03-09 07:36:24,889 [INFO]: 		-> Add: 1.5 seconds
2025-03-09 07:36:24,889 [INFO]: 		Total: 16.7 minutes
2025-03-09 07:36:24,889 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0004 secs
2025-03-09 07:36:24,889 [INFO]: 	Checking that your have enough memory available to create the index 03/09/2025, 07:36:24
2025-03-09 07:36:24,890 [INFO]: 549.4MB of memory will be needed to build the index (more might be used if you have more)
2025-03-09 07:36:24,890 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0005 secs
2025-03-09 07:36:24,890 [INFO]: 	Selecting most promising index types given data characteristics 03/09/2025, 07:36:24
2025-03-09 07:36:24,890 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-09 07:36:24,891 [INFO]: 	Creating the index 03/09/2025, 07:36:24
2025-03-09 07:36:24,891 [INFO]: 		-> Instanciate the index HNSW15 03/09/2025, 07:36:24
2025-03-09 07:36:24,894 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0027 secs
2025-03-09 07:36:24,894 [INFO]: 		-> Adding the vectors to the index 03/09/2025, 07:36:24
2025-03-09 07:36:24,895 [INFO]: The memory available for adding the vectors is 49.5GB(total available - used by the index)
2025-03-09 07:36:24,895 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/11 [00:00<?, ?it/s]  9%|▉         | 1/11 [00:00<00:01,  9.92it/s] 55%|█████▍    | 6/11 [00:00<00:00, 33.34it/s]100%|██████████| 11/11 [00:02<00:00,  4.64it/s]100%|██████████| 11/11 [00:02<00:00,  5.45it/s]
2025-03-09 07:36:26,920 [INFO]: 	Computing best hyperparameters for index knn.index 03/09/2025, 07:36:26
2025-03-09 07:36:59,586 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 32.6659 secs
2025-03-09 07:36:59,587 [INFO]: The best hyperparameters are: efSearch=311
2025-03-09 07:36:59,587 [INFO]: 	Compute fast metrics 03/09/2025, 07:36:59
  0%|          | 0/4 [00:00<?, ?it/s] 50%|█████     | 2/4 [00:00<00:00, 19.57it/s] 75%|███████▌  | 3/4 [00:00<00:00, 21.64it/s]
2025-03-09 07:37:12,622 [INFO]: 	>>> Finished "Compute fast metrics" in 13.0350 secs
2025-03-09 07:37:12,624 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 47.7295 secs
2025-03-09 07:37:12,624 [INFO]: {
2025-03-09 07:37:12,624 [INFO]: 	index_key: HNSW15
2025-03-09 07:37:12,624 [INFO]: 	index_param: efSearch=311
2025-03-09 07:37:12,624 [INFO]: 	index_path: knn.index
2025-03-09 07:37:12,624 [INFO]: 	size in bytes: 523732090
2025-03-09 07:37:12,624 [INFO]: 	avg_search_speed_ms: 12.056090990474155
2025-03-09 07:37:12,624 [INFO]: 	99p_search_speed_ms: 24.369794186204686
2025-03-09 07:37:12,624 [INFO]: 	reconstruction error %: 0.0
2025-03-09 07:37:12,624 [INFO]: 	nb vectors: 2662
2025-03-09 07:37:12,624 [INFO]: 	vectors dimension: 49152
2025-03-09 07:37:12,624 [INFO]: 	compression ratio: 0.9993095821185981
2025-03-09 07:37:12,624 [INFO]: }
2025-03-09 07:37:12,624 [INFO]: 	>>> Finished "Creating the index" in 47.7332 secs
2025-03-09 07:37:12,624 [INFO]: >>> Finished "Launching the whole pipeline" in 47.7682 secs
2025-03-09 07:37:13: [retrieval_preprocessing] calculating distances ...
2025-03-09 07:37:14: [retrieval_preprocessing] finished and saved retrieval indices for episode 59487 [episode count 15/20]
[retrieval_preprocessing] for episode 73833 [episode count 16/20], we have num_retrieval=np.int64(2671) num_query=np.int64(127)
2025-03-09 07:37:15,142 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-09 07:37:15,610 [INFO]: Launching the whole pipeline 03/09/2025, 07:37:15
2025-03-09 07:37:15,610 [INFO]: Reading total number of vectors and dimension 03/09/2025, 07:37:15
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1271.39it/s]
2025-03-09 07:37:15,648 [INFO]: There are 2671 embeddings of dim 49152
2025-03-09 07:37:15,648 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0386 secs
2025-03-09 07:37:15,649 [INFO]: 	Compute estimated construction time of the index 03/09/2025, 07:37:15
2025-03-09 07:37:15,649 [INFO]: 		-> Train: 16.7 minutes
2025-03-09 07:37:15,649 [INFO]: 		-> Add: 1.5 seconds
2025-03-09 07:37:15,649 [INFO]: 		Total: 16.7 minutes
2025-03-09 07:37:15,649 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0003 secs
2025-03-09 07:37:15,649 [INFO]: 	Checking that your have enough memory available to create the index 03/09/2025, 07:37:15
2025-03-09 07:37:15,649 [INFO]: 551.2MB of memory will be needed to build the index (more might be used if you have more)
2025-03-09 07:37:15,649 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0004 secs
2025-03-09 07:37:15,650 [INFO]: 	Selecting most promising index types given data characteristics 03/09/2025, 07:37:15
2025-03-09 07:37:15,650 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-09 07:37:15,650 [INFO]: 	Creating the index 03/09/2025, 07:37:15
2025-03-09 07:37:15,650 [INFO]: 		-> Instanciate the index HNSW15 03/09/2025, 07:37:15
2025-03-09 07:37:15,653 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0025 secs
2025-03-09 07:37:15,653 [INFO]: 		-> Adding the vectors to the index 03/09/2025, 07:37:15
2025-03-09 07:37:15,653 [INFO]: The memory available for adding the vectors is 49.5GB(total available - used by the index)
2025-03-09 07:37:15,653 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/11 [00:00<?, ?it/s]  9%|▉         | 1/11 [00:00<00:01,  5.11it/s] 18%|█▊        | 2/11 [00:00<00:01,  6.41it/s] 27%|██▋       | 3/11 [00:00<00:01,  7.25it/s] 36%|███▋      | 4/11 [00:00<00:00,  7.76it/s] 45%|████▌     | 5/11 [00:00<00:00,  8.40it/s] 55%|█████▍    | 6/11 [00:00<00:00,  8.86it/s] 64%|██████▎   | 7/11 [00:00<00:00,  9.16it/s] 82%|████████▏ | 9/11 [00:01<00:00,  9.36it/s] 91%|█████████ | 10/11 [00:01<00:00,  9.03it/s]100%|██████████| 11/11 [00:03<00:00,  1.48it/s]100%|██████████| 11/11 [00:03<00:00,  3.23it/s]
2025-03-09 07:37:19,065 [INFO]: 	Computing best hyperparameters for index knn.index 03/09/2025, 07:37:19
2025-03-09 07:37:47,571 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 28.5051 secs
2025-03-09 07:37:47,572 [INFO]: The best hyperparameters are: efSearch=245
2025-03-09 07:37:47,572 [INFO]: 	Compute fast metrics 03/09/2025, 07:37:47
  0%|          | 0/4 [00:00<?, ?it/s] 25%|██▌       | 1/4 [00:00<00:00,  4.78it/s] 75%|███████▌  | 3/4 [00:00<00:00,  8.28it/s] 75%|███████▌  | 3/4 [00:00<00:00,  6.33it/s]
2025-03-09 07:38:00,351 [INFO]: 	>>> Finished "Compute fast metrics" in 12.7787 secs
2025-03-09 07:38:00,353 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 44.7001 secs
2025-03-09 07:38:00,353 [INFO]: {
2025-03-09 07:38:00,353 [INFO]: 	index_key: HNSW15
2025-03-09 07:38:00,353 [INFO]: 	index_param: efSearch=245
2025-03-09 07:38:00,353 [INFO]: 	index_path: knn.index
2025-03-09 07:38:00,353 [INFO]: 	size in bytes: 525502750
2025-03-09 07:38:00,353 [INFO]: 	avg_search_speed_ms: 10.8414154652296
2025-03-09 07:38:00,353 [INFO]: 	99p_search_speed_ms: 25.333238637540468
2025-03-09 07:38:00,353 [INFO]: 	reconstruction error %: 0.0
2025-03-09 07:38:00,353 [INFO]: 	nb vectors: 2671
2025-03-09 07:38:00,353 [INFO]: 	vectors dimension: 49152
2025-03-09 07:38:00,353 [INFO]: 	compression ratio: 0.9993096477611202
2025-03-09 07:38:00,353 [INFO]: }
2025-03-09 07:38:00,353 [INFO]: 	>>> Finished "Creating the index" in 44.7035 secs
2025-03-09 07:38:00,353 [INFO]: >>> Finished "Launching the whole pipeline" in 44.7436 secs
2025-03-09 07:38:01: [retrieval_preprocessing] calculating distances ...
2025-03-09 07:38:01: [retrieval_preprocessing] finished and saved retrieval indices for episode 73833 [episode count 16/20]
[retrieval_preprocessing] for episode 1131 [episode count 17/20], we have num_retrieval=np.int64(2674) num_query=np.int64(124)
2025-03-09 07:38:02,330 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-09 07:38:02,839 [INFO]: Launching the whole pipeline 03/09/2025, 07:38:02
2025-03-09 07:38:02,840 [INFO]: Reading total number of vectors and dimension 03/09/2025, 07:38:02
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 965.76it/s]
2025-03-09 07:38:02,869 [INFO]: There are 2674 embeddings of dim 49152
2025-03-09 07:38:02,870 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0299 secs
2025-03-09 07:38:02,870 [INFO]: 	Compute estimated construction time of the index 03/09/2025, 07:38:02
2025-03-09 07:38:02,870 [INFO]: 		-> Train: 16.7 minutes
2025-03-09 07:38:02,870 [INFO]: 		-> Add: 1.5 seconds
2025-03-09 07:38:02,870 [INFO]: 		Total: 16.7 minutes
2025-03-09 07:38:02,870 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0002 secs
2025-03-09 07:38:02,870 [INFO]: 	Checking that your have enough memory available to create the index 03/09/2025, 07:38:02
2025-03-09 07:38:02,870 [INFO]: 551.8MB of memory will be needed to build the index (more might be used if you have more)
2025-03-09 07:38:02,870 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0003 secs
2025-03-09 07:38:02,870 [INFO]: 	Selecting most promising index types given data characteristics 03/09/2025, 07:38:02
2025-03-09 07:38:02,871 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-09 07:38:02,871 [INFO]: 	Creating the index 03/09/2025, 07:38:02
2025-03-09 07:38:02,871 [INFO]: 		-> Instanciate the index HNSW15 03/09/2025, 07:38:02
2025-03-09 07:38:02,872 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0011 secs
2025-03-09 07:38:02,872 [INFO]: 		-> Adding the vectors to the index 03/09/2025, 07:38:02
2025-03-09 07:38:02,872 [INFO]: The memory available for adding the vectors is 49.5GB(total available - used by the index)
2025-03-09 07:38:02,872 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/11 [00:00<?, ?it/s]  9%|▉         | 1/11 [00:00<00:01,  8.51it/s] 55%|█████▍    | 6/11 [00:00<00:00, 28.92it/s]100%|██████████| 11/11 [00:02<00:00,  3.43it/s]100%|██████████| 11/11 [00:02<00:00,  4.05it/s]
2025-03-09 07:38:05,594 [INFO]: 	Computing best hyperparameters for index knn.index 03/09/2025, 07:38:05
2025-03-09 07:38:39,111 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 33.5169 secs
2025-03-09 07:38:39,112 [INFO]: The best hyperparameters are: efSearch=270
2025-03-09 07:38:39,112 [INFO]: 	Compute fast metrics 03/09/2025, 07:38:39
  0%|          | 0/4 [00:00<?, ?it/s] 50%|█████     | 2/4 [00:00<00:00, 19.18it/s] 75%|███████▌  | 3/4 [00:00<00:00, 17.88it/s]
2025-03-09 07:38:52,043 [INFO]: 	>>> Finished "Compute fast metrics" in 12.9309 secs
2025-03-09 07:38:52,044 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 49.1724 secs
2025-03-09 07:38:52,045 [INFO]: {
2025-03-09 07:38:52,045 [INFO]: 	index_key: HNSW15
2025-03-09 07:38:52,045 [INFO]: 	index_param: efSearch=270
2025-03-09 07:38:52,045 [INFO]: 	index_path: knn.index
2025-03-09 07:38:52,045 [INFO]: 	size in bytes: 526092970
2025-03-09 07:38:52,045 [INFO]: 	avg_search_speed_ms: 10.151729027405002
2025-03-09 07:38:52,045 [INFO]: 	99p_search_speed_ms: 23.886911496520042
2025-03-09 07:38:52,045 [INFO]: 	reconstruction error %: 0.0
2025-03-09 07:38:52,045 [INFO]: 	nb vectors: 2674
2025-03-09 07:38:52,045 [INFO]: 	vectors dimension: 49152
2025-03-09 07:38:52,045 [INFO]: 	compression ratio: 0.9993096695437691
2025-03-09 07:38:52,045 [INFO]: }
2025-03-09 07:38:52,045 [INFO]: 	>>> Finished "Creating the index" in 49.1742 secs
2025-03-09 07:38:52,045 [INFO]: >>> Finished "Launching the whole pipeline" in 49.2051 secs
2025-03-09 07:38:53: [retrieval_preprocessing] calculating distances ...
2025-03-09 07:38:53: [retrieval_preprocessing] finished and saved retrieval indices for episode 1131 [episode count 17/20]
[retrieval_preprocessing] for episode 40556 [episode count 18/20], we have num_retrieval=np.int64(2694) num_query=np.int64(104)
2025-03-09 07:38:53,719 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-09 07:38:54,125 [INFO]: Launching the whole pipeline 03/09/2025, 07:38:54
2025-03-09 07:38:54,125 [INFO]: Reading total number of vectors and dimension 03/09/2025, 07:38:54
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1736.05it/s]
2025-03-09 07:38:54,158 [INFO]: There are 2694 embeddings of dim 49152
2025-03-09 07:38:54,158 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0329 secs
2025-03-09 07:38:54,158 [INFO]: 	Compute estimated construction time of the index 03/09/2025, 07:38:54
2025-03-09 07:38:54,158 [INFO]: 		-> Train: 16.7 minutes
2025-03-09 07:38:54,158 [INFO]: 		-> Add: 1.5 seconds
2025-03-09 07:38:54,158 [INFO]: 		Total: 16.7 minutes
2025-03-09 07:38:54,158 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0001 secs
2025-03-09 07:38:54,159 [INFO]: 	Checking that your have enough memory available to create the index 03/09/2025, 07:38:54
2025-03-09 07:38:54,159 [INFO]: 556.0MB of memory will be needed to build the index (more might be used if you have more)
2025-03-09 07:38:54,159 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0001 secs
2025-03-09 07:38:54,159 [INFO]: 	Selecting most promising index types given data characteristics 03/09/2025, 07:38:54
2025-03-09 07:38:54,159 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-09 07:38:54,159 [INFO]: 	Creating the index 03/09/2025, 07:38:54
2025-03-09 07:38:54,159 [INFO]: 		-> Instanciate the index HNSW15 03/09/2025, 07:38:54
2025-03-09 07:38:54,160 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0009 secs
2025-03-09 07:38:54,160 [INFO]: 		-> Adding the vectors to the index 03/09/2025, 07:38:54
2025-03-09 07:38:54,160 [INFO]: The memory available for adding the vectors is 49.5GB(total available - used by the index)
2025-03-09 07:38:54,160 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/11 [00:00<?, ?it/s] 18%|█▊        | 2/11 [00:00<00:00, 16.74it/s] 64%|██████▎   | 7/11 [00:00<00:00, 32.93it/s]100%|██████████| 11/11 [00:02<00:00,  3.58it/s]100%|██████████| 11/11 [00:02<00:00,  4.46it/s]
2025-03-09 07:38:56,627 [INFO]: 	Computing best hyperparameters for index knn.index 03/09/2025, 07:38:56
2025-03-09 07:39:31,484 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 34.8558 secs
2025-03-09 07:39:31,484 [INFO]: The best hyperparameters are: efSearch=319
2025-03-09 07:39:31,484 [INFO]: 	Compute fast metrics 03/09/2025, 07:39:31
  0%|          | 0/4 [00:00<?, ?it/s] 50%|█████     | 2/4 [00:00<00:00, 18.55it/s] 75%|███████▌  | 3/4 [00:00<00:00, 20.08it/s]
2025-03-09 07:39:43,129 [INFO]: 	>>> Finished "Compute fast metrics" in 11.6451 secs
2025-03-09 07:39:43,131 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 48.9713 secs
2025-03-09 07:39:43,131 [INFO]: {
2025-03-09 07:39:43,132 [INFO]: 	index_key: HNSW15
2025-03-09 07:39:43,132 [INFO]: 	index_param: efSearch=319
2025-03-09 07:39:43,132 [INFO]: 	index_path: knn.index
2025-03-09 07:39:43,132 [INFO]: 	size in bytes: 530027770
2025-03-09 07:39:43,132 [INFO]: 	avg_search_speed_ms: 11.39257372895803
2025-03-09 07:39:43,132 [INFO]: 	99p_search_speed_ms: 22.743635103106502
2025-03-09 07:39:43,132 [INFO]: 	reconstruction error %: 0.0
2025-03-09 07:39:43,132 [INFO]: 	nb vectors: 2694
2025-03-09 07:39:43,132 [INFO]: 	vectors dimension: 49152
2025-03-09 07:39:43,132 [INFO]: 	compression ratio: 0.9993098135216576
2025-03-09 07:39:43,132 [INFO]: }
2025-03-09 07:39:43,132 [INFO]: 	>>> Finished "Creating the index" in 48.9729 secs
2025-03-09 07:39:43,132 [INFO]: >>> Finished "Launching the whole pipeline" in 49.0065 secs
2025-03-09 07:39:44: [retrieval_preprocessing] calculating distances ...
2025-03-09 07:39:44: [retrieval_preprocessing] finished and saved retrieval indices for episode 40556 [episode count 18/20]
[retrieval_preprocessing] for episode 10349 [episode count 19/20], we have num_retrieval=np.int64(2653) num_query=np.int64(145)
2025-03-09 07:39:44,903 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-09 07:39:45,361 [INFO]: Launching the whole pipeline 03/09/2025, 07:39:45
2025-03-09 07:39:45,361 [INFO]: Reading total number of vectors and dimension 03/09/2025, 07:39:45
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1379.25it/s]
2025-03-09 07:39:45,393 [INFO]: There are 2653 embeddings of dim 49152
2025-03-09 07:39:45,393 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0316 secs
2025-03-09 07:39:45,393 [INFO]: 	Compute estimated construction time of the index 03/09/2025, 07:39:45
2025-03-09 07:39:45,393 [INFO]: 		-> Train: 16.7 minutes
2025-03-09 07:39:45,393 [INFO]: 		-> Add: 1.5 seconds
2025-03-09 07:39:45,393 [INFO]: 		Total: 16.7 minutes
2025-03-09 07:39:45,393 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0001 secs
2025-03-09 07:39:45,393 [INFO]: 	Checking that your have enough memory available to create the index 03/09/2025, 07:39:45
2025-03-09 07:39:45,393 [INFO]: 547.5MB of memory will be needed to build the index (more might be used if you have more)
2025-03-09 07:39:45,393 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0002 secs
2025-03-09 07:39:45,393 [INFO]: 	Selecting most promising index types given data characteristics 03/09/2025, 07:39:45
2025-03-09 07:39:45,393 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-09 07:39:45,393 [INFO]: 	Creating the index 03/09/2025, 07:39:45
2025-03-09 07:39:45,394 [INFO]: 		-> Instanciate the index HNSW15 03/09/2025, 07:39:45
2025-03-09 07:39:45,395 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0012 secs
2025-03-09 07:39:45,395 [INFO]: 		-> Adding the vectors to the index 03/09/2025, 07:39:45
2025-03-09 07:39:45,395 [INFO]: The memory available for adding the vectors is 49.5GB(total available - used by the index)
2025-03-09 07:39:45,395 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/11 [00:00<?, ?it/s] 18%|█▊        | 2/11 [00:00<00:00, 17.97it/s] 73%|███████▎  | 8/11 [00:00<00:00, 37.35it/s]100%|██████████| 11/11 [00:01<00:00,  5.83it/s]
2025-03-09 07:39:47,286 [INFO]: 	Computing best hyperparameters for index knn.index 03/09/2025, 07:39:47
2025-03-09 07:40:16,179 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 28.8929 secs
2025-03-09 07:40:16,180 [INFO]: The best hyperparameters are: efSearch=256
2025-03-09 07:40:16,180 [INFO]: 	Compute fast metrics 03/09/2025, 07:40:16
  0%|          | 0/4 [00:00<?, ?it/s] 50%|█████     | 2/4 [00:00<00:00, 15.14it/s] 75%|███████▌  | 3/4 [00:00<00:00, 16.74it/s]
2025-03-09 07:40:32,119 [INFO]: 	>>> Finished "Compute fast metrics" in 15.9390 secs
2025-03-09 07:40:32,121 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 46.7259 secs
2025-03-09 07:40:32,121 [INFO]: {
2025-03-09 07:40:32,121 [INFO]: 	index_key: HNSW15
2025-03-09 07:40:32,121 [INFO]: 	index_param: efSearch=256
2025-03-09 07:40:32,121 [INFO]: 	index_path: knn.index
2025-03-09 07:40:32,121 [INFO]: 	size in bytes: 521961430
2025-03-09 07:40:32,121 [INFO]: 	avg_search_speed_ms: 9.476591277317228
2025-03-09 07:40:32,121 [INFO]: 	99p_search_speed_ms: 22.235293139237914
2025-03-09 07:40:32,121 [INFO]: 	reconstruction error %: 0.0
2025-03-09 07:40:32,121 [INFO]: 	nb vectors: 2653
2025-03-09 07:40:32,121 [INFO]: 	vectors dimension: 49152
2025-03-09 07:40:32,121 [INFO]: 	compression ratio: 0.9993095160307152
2025-03-09 07:40:32,121 [INFO]: }
2025-03-09 07:40:32,121 [INFO]: 	>>> Finished "Creating the index" in 46.7279 secs
2025-03-09 07:40:32,121 [INFO]: >>> Finished "Launching the whole pipeline" in 46.7601 secs
2025-03-09 07:40:33: [retrieval_preprocessing] calculating distances ...
2025-03-09 07:40:33: [retrieval_preprocessing] finished and saved retrieval indices for episode 10349 [episode count 19/20]
2025-03-09 07:40:33: [retrieval_preprocessing] finished for (7495112204, 'marker') [chosen_id count 2/10]
2025-03-09 07:40:34: [retrieval_preprocessing] concatenated all embeddings and indices for 20 episodes for (666854965, 'marker') [chosen_id count 3/10]
2025-03-09 07:40:34: [retrieval_preprocessing] we have num_total=4282 embedding_dim=49152
[retrieval_preprocessing] for episode 82945 [episode count 0/20], we have num_retrieval=np.int64(4103) num_query=np.int64(179)
2025-03-09 07:40:34,748 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-09 07:40:35,528 [INFO]: Launching the whole pipeline 03/09/2025, 07:40:35
2025-03-09 07:40:35,528 [INFO]: Reading total number of vectors and dimension 03/09/2025, 07:40:35
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1598.44it/s]
2025-03-09 07:40:35,556 [INFO]: There are 4103 embeddings of dim 49152
2025-03-09 07:40:35,556 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0285 secs
2025-03-09 07:40:35,556 [INFO]: 	Compute estimated construction time of the index 03/09/2025, 07:40:35
2025-03-09 07:40:35,556 [INFO]: 		-> Train: 16.7 minutes
2025-03-09 07:40:35,556 [INFO]: 		-> Add: 2.3 seconds
2025-03-09 07:40:35,556 [INFO]: 		Total: 16.7 minutes
2025-03-09 07:40:35,556 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0001 secs
2025-03-09 07:40:35,557 [INFO]: 	Checking that your have enough memory available to create the index 03/09/2025, 07:40:35
2025-03-09 07:40:35,557 [INFO]: 846.8MB of memory will be needed to build the index (more might be used if you have more)
2025-03-09 07:40:35,557 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0002 secs
2025-03-09 07:40:35,557 [INFO]: 	Selecting most promising index types given data characteristics 03/09/2025, 07:40:35
2025-03-09 07:40:35,557 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-09 07:40:35,557 [INFO]: 	Creating the index 03/09/2025, 07:40:35
2025-03-09 07:40:35,557 [INFO]: 		-> Instanciate the index HNSW15 03/09/2025, 07:40:35
2025-03-09 07:40:35,558 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0011 secs
2025-03-09 07:40:35,558 [INFO]: 		-> Adding the vectors to the index 03/09/2025, 07:40:35
2025-03-09 07:40:35,558 [INFO]: The memory available for adding the vectors is 49.2GB(total available - used by the index)
2025-03-09 07:40:35,558 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/17 [00:00<?, ?it/s]  6%|▌         | 1/17 [00:00<00:01,  8.19it/s] 29%|██▉       | 5/17 [00:00<00:00, 24.74it/s] 53%|█████▎    | 9/17 [00:00<00:00, 30.24it/s] 82%|████████▏ | 14/17 [00:00<00:00, 35.27it/s]100%|██████████| 17/17 [00:03<00:00,  4.72it/s]
2025-03-09 07:40:39,167 [INFO]: 	Computing best hyperparameters for index knn.index 03/09/2025, 07:40:39
2025-03-09 07:41:18,433 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 39.2655 secs
2025-03-09 07:41:18,433 [INFO]: The best hyperparameters are: efSearch=193
2025-03-09 07:41:18,433 [INFO]: 	Compute fast metrics 03/09/2025, 07:41:18
  0%|          | 0/4 [00:00<?, ?it/s] 75%|███████▌  | 3/4 [00:00<00:00, 25.08it/s] 75%|███████▌  | 3/4 [00:00<00:00, 20.80it/s]
2025-03-09 07:41:32,940 [INFO]: 	>>> Finished "Compute fast metrics" in 14.5065 secs
2025-03-09 07:41:32,942 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 57.3837 secs
2025-03-09 07:41:32,942 [INFO]: {
2025-03-09 07:41:32,942 [INFO]: 	index_key: HNSW15
2025-03-09 07:41:32,942 [INFO]: 	index_param: efSearch=193
2025-03-09 07:41:32,942 [INFO]: 	index_path: knn.index
2025-03-09 07:41:32,942 [INFO]: 	size in bytes: 807240730
2025-03-09 07:41:32,942 [INFO]: 	avg_search_speed_ms: 9.676312929113005
2025-03-09 07:41:32,942 [INFO]: 	99p_search_speed_ms: 18.55699236970393
2025-03-09 07:41:32,942 [INFO]: 	reconstruction error %: 0.0
2025-03-09 07:41:32,942 [INFO]: 	nb vectors: 4103
2025-03-09 07:41:32,942 [INFO]: 	vectors dimension: 49152
2025-03-09 07:41:32,942 [INFO]: 	compression ratio: 0.9993086250739602
2025-03-09 07:41:32,942 [INFO]: }
2025-03-09 07:41:32,942 [INFO]: 	>>> Finished "Creating the index" in 57.3853 secs
2025-03-09 07:41:32,943 [INFO]: >>> Finished "Launching the whole pipeline" in 57.4150 secs
2025-03-09 07:41:33: [retrieval_preprocessing] calculating distances ...
2025-03-09 07:41:34: [retrieval_preprocessing] finished and saved retrieval indices for episode 82945 [episode count 0/20]
[retrieval_preprocessing] for episode 57349 [episode count 1/20], we have num_retrieval=np.int64(4058) num_query=np.int64(224)
2025-03-09 07:41:34,754 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-09 07:41:35,363 [INFO]: Launching the whole pipeline 03/09/2025, 07:41:35
2025-03-09 07:41:35,364 [INFO]: Reading total number of vectors and dimension 03/09/2025, 07:41:35
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1236.89it/s]
2025-03-09 07:41:35,393 [INFO]: There are 4058 embeddings of dim 49152
2025-03-09 07:41:35,394 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0302 secs
2025-03-09 07:41:35,394 [INFO]: 	Compute estimated construction time of the index 03/09/2025, 07:41:35
2025-03-09 07:41:35,394 [INFO]: 		-> Train: 16.7 minutes
2025-03-09 07:41:35,394 [INFO]: 		-> Add: 2.2 seconds
2025-03-09 07:41:35,395 [INFO]: 		Total: 16.7 minutes
2025-03-09 07:41:35,395 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0004 secs
2025-03-09 07:41:35,395 [INFO]: 	Checking that your have enough memory available to create the index 03/09/2025, 07:41:35
2025-03-09 07:41:35,395 [INFO]: 837.5MB of memory will be needed to build the index (more might be used if you have more)
2025-03-09 07:41:35,395 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0005 secs
2025-03-09 07:41:35,395 [INFO]: 	Selecting most promising index types given data characteristics 03/09/2025, 07:41:35
2025-03-09 07:41:35,396 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-09 07:41:35,396 [INFO]: 	Creating the index 03/09/2025, 07:41:35
2025-03-09 07:41:35,396 [INFO]: 		-> Instanciate the index HNSW15 03/09/2025, 07:41:35
2025-03-09 07:41:35,398 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0023 secs
2025-03-09 07:41:35,399 [INFO]: 		-> Adding the vectors to the index 03/09/2025, 07:41:35
2025-03-09 07:41:35,399 [INFO]: The memory available for adding the vectors is 49.3GB(total available - used by the index)
2025-03-09 07:41:35,399 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/16 [00:00<?, ?it/s]  6%|▋         | 1/16 [00:00<00:01,  8.07it/s] 38%|███▊      | 6/16 [00:00<00:00, 29.77it/s] 62%|██████▎   | 10/16 [00:00<00:00, 31.02it/s] 94%|█████████▍| 15/16 [00:00<00:00, 37.33it/s]100%|██████████| 16/16 [00:03<00:00,  4.28it/s]
2025-03-09 07:41:39,146 [INFO]: 	Computing best hyperparameters for index knn.index 03/09/2025, 07:41:39
2025-03-09 07:42:20,884 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 41.7379 secs
2025-03-09 07:42:20,884 [INFO]: The best hyperparameters are: efSearch=194
2025-03-09 07:42:20,884 [INFO]: 	Compute fast metrics 03/09/2025, 07:42:20
  0%|          | 0/4 [00:00<?, ?it/s] 50%|█████     | 2/4 [00:00<00:00, 19.28it/s] 75%|███████▌  | 3/4 [00:00<00:00, 21.45it/s]
2025-03-09 07:42:34,991 [INFO]: 	>>> Finished "Compute fast metrics" in 14.1066 secs
2025-03-09 07:42:34,993 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 59.5941 secs
2025-03-09 07:42:34,993 [INFO]: {
2025-03-09 07:42:34,993 [INFO]: 	index_key: HNSW15
2025-03-09 07:42:34,993 [INFO]: 	index_param: efSearch=194
2025-03-09 07:42:34,994 [INFO]: 	index_path: knn.index
2025-03-09 07:42:34,994 [INFO]: 	size in bytes: 798387250
2025-03-09 07:42:34,994 [INFO]: 	avg_search_speed_ms: 9.811427050075467
2025-03-09 07:42:34,994 [INFO]: 	99p_search_speed_ms: 19.958579037338474
2025-03-09 07:42:34,994 [INFO]: 	reconstruction error %: 0.0
2025-03-09 07:42:34,994 [INFO]: 	nb vectors: 4058
2025-03-09 07:42:34,994 [INFO]: 	vectors dimension: 49152
2025-03-09 07:42:34,994 [INFO]: 	compression ratio: 0.9993086237286479
2025-03-09 07:42:34,994 [INFO]: }
2025-03-09 07:42:34,994 [INFO]: 	>>> Finished "Creating the index" in 59.5978 secs
2025-03-09 07:42:34,994 [INFO]: >>> Finished "Launching the whole pipeline" in 59.6301 secs
2025-03-09 07:42:36: [retrieval_preprocessing] calculating distances ...
2025-03-09 07:42:36: [retrieval_preprocessing] finished and saved retrieval indices for episode 57349 [episode count 1/20]
[retrieval_preprocessing] for episode 89993 [episode count 2/20], we have num_retrieval=np.int64(4085) num_query=np.int64(197)
2025-03-09 07:42:37,316 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-09 07:42:38,129 [INFO]: Launching the whole pipeline 03/09/2025, 07:42:38
2025-03-09 07:42:38,129 [INFO]: Reading total number of vectors and dimension 03/09/2025, 07:42:38
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1318.96it/s]
2025-03-09 07:42:38,157 [INFO]: There are 4085 embeddings of dim 49152
2025-03-09 07:42:38,157 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0282 secs
2025-03-09 07:42:38,157 [INFO]: 	Compute estimated construction time of the index 03/09/2025, 07:42:38
2025-03-09 07:42:38,158 [INFO]: 		-> Train: 16.7 minutes
2025-03-09 07:42:38,158 [INFO]: 		-> Add: 2.2 seconds
2025-03-09 07:42:38,158 [INFO]: 		Total: 16.7 minutes
2025-03-09 07:42:38,158 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0001 secs
2025-03-09 07:42:38,158 [INFO]: 	Checking that your have enough memory available to create the index 03/09/2025, 07:42:38
2025-03-09 07:42:38,158 [INFO]: 843.0MB of memory will be needed to build the index (more might be used if you have more)
2025-03-09 07:42:38,158 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0002 secs
2025-03-09 07:42:38,158 [INFO]: 	Selecting most promising index types given data characteristics 03/09/2025, 07:42:38
2025-03-09 07:42:38,158 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-09 07:42:38,158 [INFO]: 	Creating the index 03/09/2025, 07:42:38
2025-03-09 07:42:38,158 [INFO]: 		-> Instanciate the index HNSW15 03/09/2025, 07:42:38
2025-03-09 07:42:38,159 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0012 secs
2025-03-09 07:42:38,159 [INFO]: 		-> Adding the vectors to the index 03/09/2025, 07:42:38
2025-03-09 07:42:38,160 [INFO]: The memory available for adding the vectors is 49.3GB(total available - used by the index)
2025-03-09 07:42:38,160 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/17 [00:00<?, ?it/s]  6%|▌         | 1/17 [00:00<00:02,  6.17it/s] 35%|███▌      | 6/17 [00:00<00:00, 24.61it/s] 65%|██████▍   | 11/17 [00:00<00:00, 31.98it/s] 94%|█████████▍| 16/17 [00:00<00:00, 35.78it/s]100%|██████████| 17/17 [00:04<00:00,  3.89it/s]
2025-03-09 07:42:42,533 [INFO]: 	Computing best hyperparameters for index knn.index 03/09/2025, 07:42:42
2025-03-09 07:43:28,835 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 46.3009 secs
2025-03-09 07:43:28,835 [INFO]: The best hyperparameters are: efSearch=203
2025-03-09 07:43:28,835 [INFO]: 	Compute fast metrics 03/09/2025, 07:43:28
  0%|          | 0/4 [00:00<?, ?it/s] 50%|█████     | 2/4 [00:00<00:00, 19.11it/s] 75%|███████▌  | 3/4 [00:00<00:00, 20.83it/s]
2025-03-09 07:43:43,710 [INFO]: 	>>> Finished "Compute fast metrics" in 14.8751 secs
2025-03-09 07:43:43,713 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 65.5533 secs
2025-03-09 07:43:43,713 [INFO]: {
2025-03-09 07:43:43,713 [INFO]: 	index_key: HNSW15
2025-03-09 07:43:43,713 [INFO]: 	index_param: efSearch=203
2025-03-09 07:43:43,713 [INFO]: 	index_path: knn.index
2025-03-09 07:43:43,713 [INFO]: 	size in bytes: 803699350
2025-03-09 07:43:43,713 [INFO]: 	avg_search_speed_ms: 11.978184017157572
2025-03-09 07:43:43,713 [INFO]: 	99p_search_speed_ms: 27.298377538099885
2025-03-09 07:43:43,713 [INFO]: 	reconstruction error %: 0.0
2025-03-09 07:43:43,713 [INFO]: 	nb vectors: 4085
2025-03-09 07:43:43,713 [INFO]: 	vectors dimension: 49152
2025-03-09 07:43:43,713 [INFO]: 	compression ratio: 0.9993086096187586
2025-03-09 07:43:43,713 [INFO]: }
2025-03-09 07:43:43,713 [INFO]: 	>>> Finished "Creating the index" in 65.5551 secs
2025-03-09 07:43:43,713 [INFO]: >>> Finished "Launching the whole pipeline" in 65.5841 secs
2025-03-09 07:43:44: [retrieval_preprocessing] calculating distances ...
2025-03-09 07:43:45: [retrieval_preprocessing] finished and saved retrieval indices for episode 89993 [episode count 2/20]
[retrieval_preprocessing] for episode 12683 [episode count 3/20], we have num_retrieval=np.int64(4046) num_query=np.int64(236)
2025-03-09 07:43:45,750 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-09 07:43:46,344 [INFO]: Launching the whole pipeline 03/09/2025, 07:43:46
2025-03-09 07:43:46,344 [INFO]: Reading total number of vectors and dimension 03/09/2025, 07:43:46
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 971.13it/s]
2025-03-09 07:43:46,374 [INFO]: There are 4046 embeddings of dim 49152
2025-03-09 07:43:46,374 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0306 secs
2025-03-09 07:43:46,374 [INFO]: 	Compute estimated construction time of the index 03/09/2025, 07:43:46
2025-03-09 07:43:46,374 [INFO]: 		-> Train: 16.7 minutes
2025-03-09 07:43:46,374 [INFO]: 		-> Add: 2.2 seconds
2025-03-09 07:43:46,374 [INFO]: 		Total: 16.7 minutes
2025-03-09 07:43:46,375 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0001 secs
2025-03-09 07:43:46,375 [INFO]: 	Checking that your have enough memory available to create the index 03/09/2025, 07:43:46
2025-03-09 07:43:46,375 [INFO]: 835.0MB of memory will be needed to build the index (more might be used if you have more)
2025-03-09 07:43:46,375 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0001 secs
2025-03-09 07:43:46,375 [INFO]: 	Selecting most promising index types given data characteristics 03/09/2025, 07:43:46
2025-03-09 07:43:46,375 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-09 07:43:46,375 [INFO]: 	Creating the index 03/09/2025, 07:43:46
2025-03-09 07:43:46,375 [INFO]: 		-> Instanciate the index HNSW15 03/09/2025, 07:43:46
2025-03-09 07:43:46,376 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0009 secs
2025-03-09 07:43:46,376 [INFO]: 		-> Adding the vectors to the index 03/09/2025, 07:43:46
2025-03-09 07:43:46,376 [INFO]: The memory available for adding the vectors is 49.3GB(total available - used by the index)
2025-03-09 07:43:46,376 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/16 [00:00<?, ?it/s]  6%|▋         | 1/16 [00:00<00:01,  8.79it/s] 38%|███▊      | 6/16 [00:00<00:00, 31.11it/s] 69%|██████▉   | 11/16 [00:00<00:00, 37.46it/s]100%|██████████| 16/16 [00:03<00:00,  3.31it/s]100%|██████████| 16/16 [00:03<00:00,  4.48it/s]
2025-03-09 07:43:49,955 [INFO]: 	Computing best hyperparameters for index knn.index 03/09/2025, 07:43:49
2025-03-09 07:44:41,377 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 51.4207 secs
2025-03-09 07:44:41,377 [INFO]: The best hyperparameters are: efSearch=198
2025-03-09 07:44:41,377 [INFO]: 	Compute fast metrics 03/09/2025, 07:44:41
  0%|          | 0/4 [00:00<?, ?it/s] 75%|███████▌  | 3/4 [00:00<00:00, 25.84it/s] 75%|███████▌  | 3/4 [00:00<00:00, 21.80it/s]
2025-03-09 07:44:56,977 [INFO]: 	>>> Finished "Compute fast metrics" in 15.6000 secs
2025-03-09 07:44:56,980 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 70.6040 secs
2025-03-09 07:44:56,980 [INFO]: {
2025-03-09 07:44:56,980 [INFO]: 	index_key: HNSW15
2025-03-09 07:44:56,980 [INFO]: 	index_param: efSearch=198
2025-03-09 07:44:56,980 [INFO]: 	index_path: knn.index
2025-03-09 07:44:56,980 [INFO]: 	size in bytes: 796026370
2025-03-09 07:44:56,980 [INFO]: 	avg_search_speed_ms: 9.917901306171045
2025-03-09 07:44:56,980 [INFO]: 	99p_search_speed_ms: 22.79824294615535
2025-03-09 07:44:56,980 [INFO]: 	reconstruction error %: 0.0
2025-03-09 07:44:56,980 [INFO]: 	nb vectors: 4046
2025-03-09 07:44:56,980 [INFO]: 	vectors dimension: 49152
2025-03-09 07:44:56,980 [INFO]: 	compression ratio: 0.9993085631070237
2025-03-09 07:44:56,980 [INFO]: }
2025-03-09 07:44:56,980 [INFO]: 	>>> Finished "Creating the index" in 70.6055 secs
2025-03-09 07:44:56,980 [INFO]: >>> Finished "Launching the whole pipeline" in 70.6368 secs
2025-03-09 07:44:58: [retrieval_preprocessing] calculating distances ...
2025-03-09 07:44:59: [retrieval_preprocessing] finished and saved retrieval indices for episode 12683 [episode count 3/20]
[retrieval_preprocessing] for episode 49663 [episode count 4/20], we have num_retrieval=np.int64(4073) num_query=np.int64(209)
2025-03-09 07:44:59,497 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-09 07:45:00,287 [INFO]: Launching the whole pipeline 03/09/2025, 07:45:00
2025-03-09 07:45:00,287 [INFO]: Reading total number of vectors and dimension 03/09/2025, 07:45:00
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1118.78it/s]
2025-03-09 07:45:00,314 [INFO]: There are 4073 embeddings of dim 49152
2025-03-09 07:45:00,314 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0268 secs
2025-03-09 07:45:00,314 [INFO]: 	Compute estimated construction time of the index 03/09/2025, 07:45:00
2025-03-09 07:45:00,314 [INFO]: 		-> Train: 16.7 minutes
2025-03-09 07:45:00,314 [INFO]: 		-> Add: 2.2 seconds
2025-03-09 07:45:00,314 [INFO]: 		Total: 16.7 minutes
2025-03-09 07:45:00,314 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0001 secs
2025-03-09 07:45:00,314 [INFO]: 	Checking that your have enough memory available to create the index 03/09/2025, 07:45:00
2025-03-09 07:45:00,315 [INFO]: 840.6MB of memory will be needed to build the index (more might be used if you have more)
2025-03-09 07:45:00,315 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0002 secs
2025-03-09 07:45:00,315 [INFO]: 	Selecting most promising index types given data characteristics 03/09/2025, 07:45:00
2025-03-09 07:45:00,315 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-09 07:45:00,315 [INFO]: 	Creating the index 03/09/2025, 07:45:00
2025-03-09 07:45:00,315 [INFO]: 		-> Instanciate the index HNSW15 03/09/2025, 07:45:00
2025-03-09 07:45:00,316 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0011 secs
2025-03-09 07:45:00,316 [INFO]: 		-> Adding the vectors to the index 03/09/2025, 07:45:00
2025-03-09 07:45:00,316 [INFO]: The memory available for adding the vectors is 49.3GB(total available - used by the index)
2025-03-09 07:45:00,316 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/17 [00:00<?, ?it/s]  6%|▌         | 1/17 [00:00<00:01,  8.93it/s] 24%|██▎       | 4/17 [00:00<00:00, 20.07it/s] 59%|█████▉    | 10/17 [00:00<00:00, 35.74it/s] 94%|█████████▍| 16/17 [00:00<00:00, 43.98it/s]100%|██████████| 17/17 [00:03<00:00,  4.66it/s]
2025-03-09 07:45:03,967 [INFO]: 	Computing best hyperparameters for index knn.index 03/09/2025, 07:45:03
2025-03-09 07:45:47,488 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 43.5213 secs
2025-03-09 07:45:47,489 [INFO]: The best hyperparameters are: efSearch=227
2025-03-09 07:45:47,489 [INFO]: 	Compute fast metrics 03/09/2025, 07:45:47
  0%|          | 0/4 [00:00<?, ?it/s] 50%|█████     | 2/4 [00:00<00:00, 19.07it/s] 75%|███████▌  | 3/4 [00:00<00:00, 20.65it/s]
2025-03-09 07:46:00,737 [INFO]: 	>>> Finished "Compute fast metrics" in 13.2480 secs
2025-03-09 07:46:00,740 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 60.4234 secs
2025-03-09 07:46:00,740 [INFO]: {
2025-03-09 07:46:00,740 [INFO]: 	index_key: HNSW15
2025-03-09 07:46:00,740 [INFO]: 	index_param: efSearch=227
2025-03-09 07:46:00,740 [INFO]: 	index_path: knn.index
2025-03-09 07:46:00,740 [INFO]: 	size in bytes: 801338410
2025-03-09 07:46:00,740 [INFO]: 	avg_search_speed_ms: 11.278135171254599
2025-03-09 07:46:00,740 [INFO]: 	99p_search_speed_ms: 23.264865190722045
2025-03-09 07:46:00,740 [INFO]: 	reconstruction error %: 0.0
2025-03-09 07:46:00,740 [INFO]: 	nb vectors: 4073
2025-03-09 07:46:00,740 [INFO]: 	vectors dimension: 49152
2025-03-09 07:46:00,740 [INFO]: 	compression ratio: 0.9993086241803885
2025-03-09 07:46:00,740 [INFO]: }
2025-03-09 07:46:00,740 [INFO]: 	>>> Finished "Creating the index" in 60.4252 secs
2025-03-09 07:46:00,740 [INFO]: >>> Finished "Launching the whole pipeline" in 60.4527 secs
2025-03-09 07:46:02: [retrieval_preprocessing] calculating distances ...
2025-03-09 07:46:03: [retrieval_preprocessing] finished and saved retrieval indices for episode 49663 [episode count 4/20]
[retrieval_preprocessing] for episode 82059 [episode count 5/20], we have num_retrieval=np.int64(4096) num_query=np.int64(186)
2025-03-09 07:46:03,714 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-09 07:46:04,351 [INFO]: Launching the whole pipeline 03/09/2025, 07:46:04
2025-03-09 07:46:04,352 [INFO]: Reading total number of vectors and dimension 03/09/2025, 07:46:04
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1375.63it/s]
2025-03-09 07:46:04,377 [INFO]: There are 4096 embeddings of dim 49152
2025-03-09 07:46:04,377 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0257 secs
2025-03-09 07:46:04,377 [INFO]: 	Compute estimated construction time of the index 03/09/2025, 07:46:04
2025-03-09 07:46:04,377 [INFO]: 		-> Train: 16.7 minutes
2025-03-09 07:46:04,377 [INFO]: 		-> Add: 2.2 seconds
2025-03-09 07:46:04,377 [INFO]: 		Total: 16.7 minutes
2025-03-09 07:46:04,377 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0001 secs
2025-03-09 07:46:04,378 [INFO]: 	Checking that your have enough memory available to create the index 03/09/2025, 07:46:04
2025-03-09 07:46:04,378 [INFO]: 845.3MB of memory will be needed to build the index (more might be used if you have more)
2025-03-09 07:46:04,378 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0002 secs
2025-03-09 07:46:04,378 [INFO]: 	Selecting most promising index types given data characteristics 03/09/2025, 07:46:04
2025-03-09 07:46:04,378 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-09 07:46:04,378 [INFO]: 	Creating the index 03/09/2025, 07:46:04
2025-03-09 07:46:04,378 [INFO]: 		-> Instanciate the index HNSW15 03/09/2025, 07:46:04
2025-03-09 07:46:04,379 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0010 secs
2025-03-09 07:46:04,379 [INFO]: 		-> Adding the vectors to the index 03/09/2025, 07:46:04
2025-03-09 07:46:04,379 [INFO]: The memory available for adding the vectors is 49.2GB(total available - used by the index)
2025-03-09 07:46:04,379 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/17 [00:00<?, ?it/s]  6%|▌         | 1/17 [00:00<00:01,  9.22it/s] 41%|████      | 7/17 [00:00<00:00, 35.67it/s] 76%|███████▋  | 13/17 [00:00<00:00, 41.57it/s]100%|██████████| 17/17 [00:03<00:00,  4.78it/s]
2025-03-09 07:46:07,940 [INFO]: 	Computing best hyperparameters for index knn.index 03/09/2025, 07:46:07
2025-03-09 07:46:51,578 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 43.6379 secs
2025-03-09 07:46:51,579 [INFO]: The best hyperparameters are: efSearch=188
2025-03-09 07:46:51,579 [INFO]: 	Compute fast metrics 03/09/2025, 07:46:51
  0%|          | 0/4 [00:00<?, ?it/s] 25%|██▌       | 1/4 [00:00<00:00,  7.32it/s] 75%|███████▌  | 3/4 [00:00<00:00, 13.65it/s]
2025-03-09 07:47:08,223 [INFO]: 	>>> Finished "Compute fast metrics" in 16.6446 secs
2025-03-09 07:47:08,226 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 63.8468 secs
2025-03-09 07:47:08,226 [INFO]: {
2025-03-09 07:47:08,226 [INFO]: 	index_key: HNSW15
2025-03-09 07:47:08,226 [INFO]: 	index_param: efSearch=188
2025-03-09 07:47:08,226 [INFO]: 	index_path: knn.index
2025-03-09 07:47:08,226 [INFO]: 	size in bytes: 805863490
2025-03-09 07:47:08,226 [INFO]: 	avg_search_speed_ms: 9.893457386384762
2025-03-09 07:47:08,226 [INFO]: 	99p_search_speed_ms: 23.59543340280652
2025-03-09 07:47:08,226 [INFO]: 	reconstruction error %: 0.0
2025-03-09 07:47:08,226 [INFO]: 	nb vectors: 4096
2025-03-09 07:47:08,226 [INFO]: 	vectors dimension: 49152
2025-03-09 07:47:08,226 [INFO]: 	compression ratio: 0.9993086645481358
2025-03-09 07:47:08,226 [INFO]: }
2025-03-09 07:47:08,226 [INFO]: 	>>> Finished "Creating the index" in 63.8484 secs
2025-03-09 07:47:08,226 [INFO]: >>> Finished "Launching the whole pipeline" in 63.8748 secs
2025-03-09 07:47:09: [retrieval_preprocessing] calculating distances ...
2025-03-09 07:47:09: [retrieval_preprocessing] finished and saved retrieval indices for episode 82059 [episode count 5/20]
[retrieval_preprocessing] for episode 13454 [episode count 6/20], we have num_retrieval=np.int64(4102) num_query=np.int64(180)
2025-03-09 07:47:10,188 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-09 07:47:10,979 [INFO]: Launching the whole pipeline 03/09/2025, 07:47:10
2025-03-09 07:47:10,979 [INFO]: Reading total number of vectors and dimension 03/09/2025, 07:47:10
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 977.92it/s]
2025-03-09 07:47:11,020 [INFO]: There are 4102 embeddings of dim 49152
2025-03-09 07:47:11,021 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0419 secs
2025-03-09 07:47:11,021 [INFO]: 	Compute estimated construction time of the index 03/09/2025, 07:47:11
2025-03-09 07:47:11,021 [INFO]: 		-> Train: 16.7 minutes
2025-03-09 07:47:11,021 [INFO]: 		-> Add: 2.3 seconds
2025-03-09 07:47:11,021 [INFO]: 		Total: 16.7 minutes
2025-03-09 07:47:11,021 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0002 secs
2025-03-09 07:47:11,021 [INFO]: 	Checking that your have enough memory available to create the index 03/09/2025, 07:47:11
2025-03-09 07:47:11,021 [INFO]: 846.6MB of memory will be needed to build the index (more might be used if you have more)
2025-03-09 07:47:11,022 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0003 secs
2025-03-09 07:47:11,022 [INFO]: 	Selecting most promising index types given data characteristics 03/09/2025, 07:47:11
2025-03-09 07:47:11,022 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-09 07:47:11,022 [INFO]: 	Creating the index 03/09/2025, 07:47:11
2025-03-09 07:47:11,022 [INFO]: 		-> Instanciate the index HNSW15 03/09/2025, 07:47:11
2025-03-09 07:47:11,024 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0017 secs
2025-03-09 07:47:11,024 [INFO]: 		-> Adding the vectors to the index 03/09/2025, 07:47:11
2025-03-09 07:47:11,024 [INFO]: The memory available for adding the vectors is 49.2GB(total available - used by the index)
2025-03-09 07:47:11,024 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/17 [00:00<?, ?it/s]  6%|▌         | 1/17 [00:00<00:01,  8.17it/s] 35%|███▌      | 6/17 [00:00<00:00, 28.00it/s] 65%|██████▍   | 11/17 [00:00<00:00, 34.50it/s] 88%|████████▊ | 15/17 [00:00<00:00, 36.38it/s]100%|██████████| 17/17 [00:03<00:00,  4.52it/s]
2025-03-09 07:47:14,791 [INFO]: 	Computing best hyperparameters for index knn.index 03/09/2025, 07:47:14
2025-03-09 07:47:59,907 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 45.1158 secs
2025-03-09 07:47:59,907 [INFO]: The best hyperparameters are: efSearch=191
2025-03-09 07:47:59,907 [INFO]: 	Compute fast metrics 03/09/2025, 07:47:59
  0%|          | 0/4 [00:00<?, ?it/s] 75%|███████▌  | 3/4 [00:00<00:00, 24.42it/s] 75%|███████▌  | 3/4 [00:00<00:00, 19.88it/s]
2025-03-09 07:48:14,121 [INFO]: 	>>> Finished "Compute fast metrics" in 14.2132 secs
2025-03-09 07:48:14,123 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 63.0989 secs
2025-03-09 07:48:14,123 [INFO]: {
2025-03-09 07:48:14,123 [INFO]: 	index_key: HNSW15
2025-03-09 07:48:14,123 [INFO]: 	index_param: efSearch=191
2025-03-09 07:48:14,123 [INFO]: 	index_path: knn.index
2025-03-09 07:48:14,123 [INFO]: 	size in bytes: 807043930
2025-03-09 07:48:14,123 [INFO]: 	avg_search_speed_ms: 10.427616049105358
2025-03-09 07:48:14,123 [INFO]: 	99p_search_speed_ms: 24.23761829268187
2025-03-09 07:48:14,123 [INFO]: 	reconstruction error %: 0.0
2025-03-09 07:48:14,123 [INFO]: 	nb vectors: 4102
2025-03-09 07:48:14,123 [INFO]: 	vectors dimension: 49152
2025-03-09 07:48:14,123 [INFO]: 	compression ratio: 0.9993086943854469
2025-03-09 07:48:14,123 [INFO]: }
2025-03-09 07:48:14,123 [INFO]: 	>>> Finished "Creating the index" in 63.1013 secs
2025-03-09 07:48:14,123 [INFO]: >>> Finished "Launching the whole pipeline" in 63.1444 secs
2025-03-09 07:48:14: [retrieval_preprocessing] calculating distances ...
2025-03-09 07:48:15: [retrieval_preprocessing] finished and saved retrieval indices for episode 13454 [episode count 6/20]
[retrieval_preprocessing] for episode 64910 [episode count 7/20], we have num_retrieval=np.int64(4093) num_query=np.int64(189)
2025-03-09 07:48:15,911 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-09 07:48:16,454 [INFO]: Launching the whole pipeline 03/09/2025, 07:48:16
2025-03-09 07:48:16,454 [INFO]: Reading total number of vectors and dimension 03/09/2025, 07:48:16
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 2027.21it/s]
2025-03-09 07:48:16,480 [INFO]: There are 4093 embeddings of dim 49152
2025-03-09 07:48:16,480 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0261 secs
2025-03-09 07:48:16,480 [INFO]: 	Compute estimated construction time of the index 03/09/2025, 07:48:16
2025-03-09 07:48:16,480 [INFO]: 		-> Train: 16.7 minutes
2025-03-09 07:48:16,480 [INFO]: 		-> Add: 2.2 seconds
2025-03-09 07:48:16,480 [INFO]: 		Total: 16.7 minutes
2025-03-09 07:48:16,480 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0001 secs
2025-03-09 07:48:16,480 [INFO]: 	Checking that your have enough memory available to create the index 03/09/2025, 07:48:16
2025-03-09 07:48:16,480 [INFO]: 844.7MB of memory will be needed to build the index (more might be used if you have more)
2025-03-09 07:48:16,480 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0002 secs
2025-03-09 07:48:16,480 [INFO]: 	Selecting most promising index types given data characteristics 03/09/2025, 07:48:16
2025-03-09 07:48:16,480 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-09 07:48:16,481 [INFO]: 	Creating the index 03/09/2025, 07:48:16
2025-03-09 07:48:16,481 [INFO]: 		-> Instanciate the index HNSW15 03/09/2025, 07:48:16
2025-03-09 07:48:16,482 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0011 secs
2025-03-09 07:48:16,482 [INFO]: 		-> Adding the vectors to the index 03/09/2025, 07:48:16
2025-03-09 07:48:16,482 [INFO]: The memory available for adding the vectors is 49.3GB(total available - used by the index)
2025-03-09 07:48:16,482 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/17 [00:00<?, ?it/s]  6%|▌         | 1/17 [00:00<00:01,  8.90it/s] 41%|████      | 7/17 [00:00<00:00, 35.28it/s] 76%|███████▋  | 13/17 [00:00<00:00, 44.21it/s]100%|██████████| 17/17 [00:03<00:00,  4.62it/s]
2025-03-09 07:48:20,163 [INFO]: 	Computing best hyperparameters for index knn.index 03/09/2025, 07:48:20
2025-03-09 07:49:02,469 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 42.3058 secs
2025-03-09 07:49:02,469 [INFO]: The best hyperparameters are: efSearch=220
2025-03-09 07:49:02,469 [INFO]: 	Compute fast metrics 03/09/2025, 07:49:02
  0%|          | 0/4 [00:00<?, ?it/s] 75%|███████▌  | 3/4 [00:00<00:00, 26.90it/s] 75%|███████▌  | 3/4 [00:00<00:00, 23.00it/s]
2025-03-09 07:49:16,031 [INFO]: 	>>> Finished "Compute fast metrics" in 13.5613 secs
2025-03-09 07:49:16,033 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 59.5512 secs
2025-03-09 07:49:16,033 [INFO]: {
2025-03-09 07:49:16,033 [INFO]: 	index_key: HNSW15
2025-03-09 07:49:16,033 [INFO]: 	index_param: efSearch=220
2025-03-09 07:49:16,033 [INFO]: 	index_path: knn.index
2025-03-09 07:49:16,033 [INFO]: 	size in bytes: 805273270
2025-03-09 07:49:16,033 [INFO]: 	avg_search_speed_ms: 11.977802156219761
2025-03-09 07:49:16,033 [INFO]: 	99p_search_speed_ms: 24.05993811786174
2025-03-09 07:49:16,033 [INFO]: 	reconstruction error %: 0.0
2025-03-09 07:49:16,033 [INFO]: 	nb vectors: 4093
2025-03-09 07:49:16,033 [INFO]: 	vectors dimension: 49152
2025-03-09 07:49:16,033 [INFO]: 	compression ratio: 0.9993086495966766
2025-03-09 07:49:16,033 [INFO]: }
2025-03-09 07:49:16,033 [INFO]: 	>>> Finished "Creating the index" in 59.5528 secs
2025-03-09 07:49:16,033 [INFO]: >>> Finished "Launching the whole pipeline" in 59.5796 secs
2025-03-09 07:49:17: [retrieval_preprocessing] calculating distances ...
2025-03-09 07:49:17: [retrieval_preprocessing] finished and saved retrieval indices for episode 64910 [episode count 7/20]
[retrieval_preprocessing] for episode 86548 [episode count 8/20], we have num_retrieval=np.int64(4085) num_query=np.int64(197)
2025-03-09 07:49:18,419 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-09 07:49:19,278 [INFO]: Launching the whole pipeline 03/09/2025, 07:49:19
2025-03-09 07:49:19,279 [INFO]: Reading total number of vectors and dimension 03/09/2025, 07:49:19
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1325.63it/s]
2025-03-09 07:49:19,306 [INFO]: There are 4085 embeddings of dim 49152
2025-03-09 07:49:19,306 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0273 secs
2025-03-09 07:49:19,306 [INFO]: 	Compute estimated construction time of the index 03/09/2025, 07:49:19
2025-03-09 07:49:19,306 [INFO]: 		-> Train: 16.7 minutes
2025-03-09 07:49:19,306 [INFO]: 		-> Add: 2.2 seconds
2025-03-09 07:49:19,306 [INFO]: 		Total: 16.7 minutes
2025-03-09 07:49:19,306 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0001 secs
2025-03-09 07:49:19,306 [INFO]: 	Checking that your have enough memory available to create the index 03/09/2025, 07:49:19
2025-03-09 07:49:19,306 [INFO]: 843.0MB of memory will be needed to build the index (more might be used if you have more)
2025-03-09 07:49:19,306 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0002 secs
2025-03-09 07:49:19,306 [INFO]: 	Selecting most promising index types given data characteristics 03/09/2025, 07:49:19
2025-03-09 07:49:19,306 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-09 07:49:19,307 [INFO]: 	Creating the index 03/09/2025, 07:49:19
2025-03-09 07:49:19,307 [INFO]: 		-> Instanciate the index HNSW15 03/09/2025, 07:49:19
2025-03-09 07:49:19,308 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0012 secs
2025-03-09 07:49:19,308 [INFO]: 		-> Adding the vectors to the index 03/09/2025, 07:49:19
2025-03-09 07:49:19,308 [INFO]: The memory available for adding the vectors is 49.3GB(total available - used by the index)
2025-03-09 07:49:19,309 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/17 [00:00<?, ?it/s] 12%|█▏        | 2/17 [00:00<00:00, 16.89it/s] 41%|████      | 7/17 [00:00<00:00, 32.16it/s] 71%|███████   | 12/17 [00:00<00:00, 37.15it/s]100%|██████████| 17/17 [00:03<00:00,  3.26it/s]100%|██████████| 17/17 [00:03<00:00,  4.54it/s]
2025-03-09 07:49:23,531 [INFO]: 	Computing best hyperparameters for index knn.index 03/09/2025, 07:49:23
2025-03-09 07:50:05,838 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 42.3067 secs
2025-03-09 07:50:05,838 [INFO]: The best hyperparameters are: efSearch=165
2025-03-09 07:50:05,839 [INFO]: 	Compute fast metrics 03/09/2025, 07:50:05
  0%|          | 0/4 [00:00<?, ?it/s] 75%|███████▌  | 3/4 [00:00<00:00, 25.41it/s] 75%|███████▌  | 3/4 [00:00<00:00, 21.98it/s]
2025-03-09 07:50:20,926 [INFO]: 	>>> Finished "Compute fast metrics" in 15.0876 secs
2025-03-09 07:50:20,929 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 61.6202 secs
2025-03-09 07:50:20,929 [INFO]: {
2025-03-09 07:50:20,929 [INFO]: 	index_key: HNSW15
2025-03-09 07:50:20,929 [INFO]: 	index_param: efSearch=165
2025-03-09 07:50:20,929 [INFO]: 	index_path: knn.index
2025-03-09 07:50:20,929 [INFO]: 	size in bytes: 803699350
2025-03-09 07:50:20,929 [INFO]: 	avg_search_speed_ms: 8.246860131567615
2025-03-09 07:50:20,929 [INFO]: 	99p_search_speed_ms: 13.532326966524103
2025-03-09 07:50:20,929 [INFO]: 	reconstruction error %: 0.0
2025-03-09 07:50:20,929 [INFO]: 	nb vectors: 4085
2025-03-09 07:50:20,929 [INFO]: 	vectors dimension: 49152
2025-03-09 07:50:20,929 [INFO]: 	compression ratio: 0.9993086096187586
2025-03-09 07:50:20,929 [INFO]: }
2025-03-09 07:50:20,929 [INFO]: 	>>> Finished "Creating the index" in 61.6223 secs
2025-03-09 07:50:20,929 [INFO]: >>> Finished "Launching the whole pipeline" in 61.6504 secs
2025-03-09 07:50:21: [retrieval_preprocessing] calculating distances ...
2025-03-09 07:50:22: [retrieval_preprocessing] finished and saved retrieval indices for episode 86548 [episode count 8/20]
[retrieval_preprocessing] for episode 78229 [episode count 9/20], we have num_retrieval=np.int64(4084) num_query=np.int64(198)
2025-03-09 07:50:22,653 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-09 07:50:23,299 [INFO]: Launching the whole pipeline 03/09/2025, 07:50:23
2025-03-09 07:50:23,299 [INFO]: Reading total number of vectors and dimension 03/09/2025, 07:50:23
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 919.60it/s]
2025-03-09 07:50:23,332 [INFO]: There are 4084 embeddings of dim 49152
2025-03-09 07:50:23,332 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0330 secs
2025-03-09 07:50:23,332 [INFO]: 	Compute estimated construction time of the index 03/09/2025, 07:50:23
2025-03-09 07:50:23,332 [INFO]: 		-> Train: 16.7 minutes
2025-03-09 07:50:23,332 [INFO]: 		-> Add: 2.2 seconds
2025-03-09 07:50:23,332 [INFO]: 		Total: 16.7 minutes
2025-03-09 07:50:23,332 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0001 secs
2025-03-09 07:50:23,333 [INFO]: 	Checking that your have enough memory available to create the index 03/09/2025, 07:50:23
2025-03-09 07:50:23,333 [INFO]: 842.8MB of memory will be needed to build the index (more might be used if you have more)
2025-03-09 07:50:23,333 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0002 secs
2025-03-09 07:50:23,333 [INFO]: 	Selecting most promising index types given data characteristics 03/09/2025, 07:50:23
2025-03-09 07:50:23,333 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-09 07:50:23,333 [INFO]: 	Creating the index 03/09/2025, 07:50:23
2025-03-09 07:50:23,333 [INFO]: 		-> Instanciate the index HNSW15 03/09/2025, 07:50:23
2025-03-09 07:50:23,334 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0009 secs
2025-03-09 07:50:23,334 [INFO]: 		-> Adding the vectors to the index 03/09/2025, 07:50:23
2025-03-09 07:50:23,334 [INFO]: The memory available for adding the vectors is 49.3GB(total available - used by the index)
2025-03-09 07:50:23,334 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/17 [00:00<?, ?it/s]  6%|▌         | 1/17 [00:00<00:01,  8.23it/s] 24%|██▎       | 4/17 [00:00<00:00, 19.73it/s] 53%|█████▎    | 9/17 [00:00<00:00, 30.40it/s] 82%|████████▏ | 14/17 [00:00<00:00, 35.41it/s]100%|██████████| 17/17 [00:04<00:00,  4.09it/s]
2025-03-09 07:50:27,494 [INFO]: 	Computing best hyperparameters for index knn.index 03/09/2025, 07:50:27
2025-03-09 07:51:12,784 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 45.2903 secs
2025-03-09 07:51:12,785 [INFO]: The best hyperparameters are: efSearch=219
2025-03-09 07:51:12,785 [INFO]: 	Compute fast metrics 03/09/2025, 07:51:12
  0%|          | 0/4 [00:00<?, ?it/s] 75%|███████▌  | 3/4 [00:00<00:00, 26.52it/s] 75%|███████▌  | 3/4 [00:00<00:00, 22.47it/s]
2025-03-09 07:51:31,821 [INFO]: 	>>> Finished "Compute fast metrics" in 19.0361 secs
2025-03-09 07:51:31,823 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 68.4892 secs
2025-03-09 07:51:31,823 [INFO]: {
2025-03-09 07:51:31,823 [INFO]: 	index_key: HNSW15
2025-03-09 07:51:31,824 [INFO]: 	index_param: efSearch=219
2025-03-09 07:51:31,824 [INFO]: 	index_path: knn.index
2025-03-09 07:51:31,824 [INFO]: 	size in bytes: 803502610
2025-03-09 07:51:31,824 [INFO]: 	avg_search_speed_ms: 9.489111752519685
2025-03-09 07:51:31,824 [INFO]: 	99p_search_speed_ms: 14.283030442893516
2025-03-09 07:51:31,824 [INFO]: 	reconstruction error %: 0.0
2025-03-09 07:51:31,824 [INFO]: 	nb vectors: 4084
2025-03-09 07:51:31,824 [INFO]: 	vectors dimension: 49152
2025-03-09 07:51:31,824 [INFO]: 	compression ratio: 0.9993086046105065
2025-03-09 07:51:31,824 [INFO]: }
2025-03-09 07:51:31,824 [INFO]: 	>>> Finished "Creating the index" in 68.4907 secs
2025-03-09 07:51:31,824 [INFO]: >>> Finished "Launching the whole pipeline" in 68.5244 secs
2025-03-09 07:51:32: [retrieval_preprocessing] calculating distances ...
2025-03-09 07:51:33: [retrieval_preprocessing] finished and saved retrieval indices for episode 78229 [episode count 9/20]
[retrieval_preprocessing] for episode 76566 [episode count 10/20], we have num_retrieval=np.int64(3982) num_query=np.int64(300)
2025-03-09 07:51:33,538 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-09 07:51:34,015 [INFO]: Launching the whole pipeline 03/09/2025, 07:51:34
2025-03-09 07:51:34,015 [INFO]: Reading total number of vectors and dimension 03/09/2025, 07:51:34
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1458.38it/s]
2025-03-09 07:51:34,041 [INFO]: There are 3982 embeddings of dim 49152
2025-03-09 07:51:34,041 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0260 secs
2025-03-09 07:51:34,041 [INFO]: 	Compute estimated construction time of the index 03/09/2025, 07:51:34
2025-03-09 07:51:34,041 [INFO]: 		-> Train: 16.7 minutes
2025-03-09 07:51:34,041 [INFO]: 		-> Add: 2.2 seconds
2025-03-09 07:51:34,041 [INFO]: 		Total: 16.7 minutes
2025-03-09 07:51:34,041 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0001 secs
2025-03-09 07:51:34,041 [INFO]: 	Checking that your have enough memory available to create the index 03/09/2025, 07:51:34
2025-03-09 07:51:34,041 [INFO]: 821.8MB of memory will be needed to build the index (more might be used if you have more)
2025-03-09 07:51:34,041 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0001 secs
2025-03-09 07:51:34,042 [INFO]: 	Selecting most promising index types given data characteristics 03/09/2025, 07:51:34
2025-03-09 07:51:34,042 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-09 07:51:34,042 [INFO]: 	Creating the index 03/09/2025, 07:51:34
2025-03-09 07:51:34,042 [INFO]: 		-> Instanciate the index HNSW15 03/09/2025, 07:51:34
2025-03-09 07:51:34,043 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0009 secs
2025-03-09 07:51:34,043 [INFO]: 		-> Adding the vectors to the index 03/09/2025, 07:51:34
2025-03-09 07:51:34,043 [INFO]: The memory available for adding the vectors is 49.3GB(total available - used by the index)
2025-03-09 07:51:34,043 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/16 [00:00<?, ?it/s] 12%|█▎        | 2/16 [00:00<00:00, 16.99it/s] 50%|█████     | 8/16 [00:00<00:00, 38.42it/s] 88%|████████▊ | 14/16 [00:00<00:00, 44.76it/s]100%|██████████| 16/16 [00:03<00:00,  4.91it/s]
2025-03-09 07:51:37,307 [INFO]: 	Computing best hyperparameters for index knn.index 03/09/2025, 07:51:37
2025-03-09 07:52:23,986 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 46.6790 secs
2025-03-09 07:52:23,987 [INFO]: The best hyperparameters are: efSearch=199
2025-03-09 07:52:23,987 [INFO]: 	Compute fast metrics 03/09/2025, 07:52:23
  0%|          | 0/4 [00:00<?, ?it/s] 25%|██▌       | 1/4 [00:00<00:00,  9.38it/s] 75%|███████▌  | 3/4 [00:00<00:00, 17.76it/s]
2025-03-09 07:52:40,407 [INFO]: 	>>> Finished "Compute fast metrics" in 16.4198 secs
2025-03-09 07:52:40,409 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 66.3662 secs
2025-03-09 07:52:40,409 [INFO]: {
2025-03-09 07:52:40,409 [INFO]: 	index_key: HNSW15
2025-03-09 07:52:40,409 [INFO]: 	index_param: efSearch=199
2025-03-09 07:52:40,409 [INFO]: 	index_path: knn.index
2025-03-09 07:52:40,409 [INFO]: 	size in bytes: 783434770
2025-03-09 07:52:40,409 [INFO]: 	avg_search_speed_ms: 9.442063605604558
2025-03-09 07:52:40,409 [INFO]: 	99p_search_speed_ms: 21.627930053509786
2025-03-09 07:52:40,409 [INFO]: 	reconstruction error %: 0.0
2025-03-09 07:52:40,409 [INFO]: 	nb vectors: 3982
2025-03-09 07:52:40,409 [INFO]: 	vectors dimension: 49152
2025-03-09 07:52:40,409 [INFO]: 	compression ratio: 0.9993085397524545
2025-03-09 07:52:40,409 [INFO]: }
2025-03-09 07:52:40,409 [INFO]: 	>>> Finished "Creating the index" in 66.3675 secs
2025-03-09 07:52:40,409 [INFO]: >>> Finished "Launching the whole pipeline" in 66.3942 secs
2025-03-09 07:52:41: [retrieval_preprocessing] calculating distances ...
2025-03-09 07:52:43: [retrieval_preprocessing] finished and saved retrieval indices for episode 76566 [episode count 10/20]
[retrieval_preprocessing] for episode 79384 [episode count 11/20], we have num_retrieval=np.int64(4001) num_query=np.int64(281)
2025-03-09 07:52:43,456 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-09 07:52:43,977 [INFO]: Launching the whole pipeline 03/09/2025, 07:52:43
2025-03-09 07:52:43,977 [INFO]: Reading total number of vectors and dimension 03/09/2025, 07:52:43
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1077.67it/s]
2025-03-09 07:52:44,002 [INFO]: There are 4001 embeddings of dim 49152
2025-03-09 07:52:44,003 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0259 secs
2025-03-09 07:52:44,003 [INFO]: 	Compute estimated construction time of the index 03/09/2025, 07:52:44
2025-03-09 07:52:44,003 [INFO]: 		-> Train: 16.7 minutes
2025-03-09 07:52:44,003 [INFO]: 		-> Add: 2.2 seconds
2025-03-09 07:52:44,003 [INFO]: 		Total: 16.7 minutes
2025-03-09 07:52:44,003 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0001 secs
2025-03-09 07:52:44,003 [INFO]: 	Checking that your have enough memory available to create the index 03/09/2025, 07:52:44
2025-03-09 07:52:44,003 [INFO]: 825.7MB of memory will be needed to build the index (more might be used if you have more)
2025-03-09 07:52:44,003 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0003 secs
2025-03-09 07:52:44,003 [INFO]: 	Selecting most promising index types given data characteristics 03/09/2025, 07:52:44
2025-03-09 07:52:44,003 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-09 07:52:44,003 [INFO]: 	Creating the index 03/09/2025, 07:52:44
2025-03-09 07:52:44,004 [INFO]: 		-> Instanciate the index HNSW15 03/09/2025, 07:52:44
2025-03-09 07:52:44,005 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0010 secs
2025-03-09 07:52:44,005 [INFO]: 		-> Adding the vectors to the index 03/09/2025, 07:52:44
2025-03-09 07:52:44,005 [INFO]: The memory available for adding the vectors is 49.3GB(total available - used by the index)
2025-03-09 07:52:44,005 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/16 [00:00<?, ?it/s] 12%|█▎        | 2/16 [00:00<00:00, 16.54it/s] 38%|███▊      | 6/16 [00:00<00:00, 26.51it/s] 69%|██████▉   | 11/16 [00:00<00:00, 35.56it/s]100%|██████████| 16/16 [00:03<00:00,  3.22it/s]100%|██████████| 16/16 [00:03<00:00,  4.40it/s]
2025-03-09 07:52:47,650 [INFO]: 	Computing best hyperparameters for index knn.index 03/09/2025, 07:52:47
2025-03-09 07:53:33,285 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 45.6347 secs
2025-03-09 07:53:33,285 [INFO]: The best hyperparameters are: efSearch=169
2025-03-09 07:53:33,285 [INFO]: 	Compute fast metrics 03/09/2025, 07:53:33
  0%|          | 0/4 [00:00<?, ?it/s] 50%|█████     | 2/4 [00:00<00:00, 16.64it/s] 75%|███████▌  | 3/4 [00:00<00:00, 17.70it/s]
2025-03-09 07:53:49,316 [INFO]: 	>>> Finished "Compute fast metrics" in 16.0302 secs
2025-03-09 07:53:49,318 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 65.3135 secs
2025-03-09 07:53:49,318 [INFO]: {
2025-03-09 07:53:49,318 [INFO]: 	index_key: HNSW15
2025-03-09 07:53:49,318 [INFO]: 	index_param: efSearch=169
2025-03-09 07:53:49,318 [INFO]: 	index_path: knn.index
2025-03-09 07:53:49,318 [INFO]: 	size in bytes: 787172890
2025-03-09 07:53:49,318 [INFO]: 	avg_search_speed_ms: 8.507237674234448
2025-03-09 07:53:49,318 [INFO]: 	99p_search_speed_ms: 16.235401388257742
2025-03-09 07:53:49,318 [INFO]: 	reconstruction error %: 0.0
2025-03-09 07:53:49,318 [INFO]: 	nb vectors: 4001
2025-03-09 07:53:49,318 [INFO]: 	vectors dimension: 49152
2025-03-09 07:53:49,318 [INFO]: 	compression ratio: 0.9993085610455918
2025-03-09 07:53:49,318 [INFO]: }
2025-03-09 07:53:49,318 [INFO]: 	>>> Finished "Creating the index" in 65.3149 secs
2025-03-09 07:53:49,318 [INFO]: >>> Finished "Launching the whole pipeline" in 65.3417 secs
2025-03-09 07:53:50: [retrieval_preprocessing] calculating distances ...
2025-03-09 07:53:51: [retrieval_preprocessing] finished and saved retrieval indices for episode 79384 [episode count 11/20]
[retrieval_preprocessing] for episode 33308 [episode count 12/20], we have num_retrieval=np.int64(4079) num_query=np.int64(203)
2025-03-09 07:53:51,499 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-09 07:53:52,047 [INFO]: Launching the whole pipeline 03/09/2025, 07:53:52
2025-03-09 07:53:52,047 [INFO]: Reading total number of vectors and dimension 03/09/2025, 07:53:52
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1431.99it/s]
2025-03-09 07:53:52,073 [INFO]: There are 4079 embeddings of dim 49152
2025-03-09 07:53:52,073 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0260 secs
2025-03-09 07:53:52,073 [INFO]: 	Compute estimated construction time of the index 03/09/2025, 07:53:52
2025-03-09 07:53:52,073 [INFO]: 		-> Train: 16.7 minutes
2025-03-09 07:53:52,073 [INFO]: 		-> Add: 2.2 seconds
2025-03-09 07:53:52,073 [INFO]: 		Total: 16.7 minutes
2025-03-09 07:53:52,073 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0002 secs
2025-03-09 07:53:52,073 [INFO]: 	Checking that your have enough memory available to create the index 03/09/2025, 07:53:52
2025-03-09 07:53:52,073 [INFO]: 841.8MB of memory will be needed to build the index (more might be used if you have more)
2025-03-09 07:53:52,074 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0001 secs
2025-03-09 07:53:52,074 [INFO]: 	Selecting most promising index types given data characteristics 03/09/2025, 07:53:52
2025-03-09 07:53:52,074 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-09 07:53:52,074 [INFO]: 	Creating the index 03/09/2025, 07:53:52
2025-03-09 07:53:52,074 [INFO]: 		-> Instanciate the index HNSW15 03/09/2025, 07:53:52
2025-03-09 07:53:52,075 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0010 secs
2025-03-09 07:53:52,075 [INFO]: 		-> Adding the vectors to the index 03/09/2025, 07:53:52
2025-03-09 07:53:52,075 [INFO]: The memory available for adding the vectors is 49.3GB(total available - used by the index)
2025-03-09 07:53:52,075 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/17 [00:00<?, ?it/s]  6%|▌         | 1/17 [00:00<00:01,  8.38it/s] 35%|███▌      | 6/17 [00:00<00:00, 29.99it/s] 71%|███████   | 12/17 [00:00<00:00, 40.57it/s]100%|██████████| 17/17 [00:03<00:00,  3.27it/s]100%|██████████| 17/17 [00:03<00:00,  4.43it/s]
2025-03-09 07:53:55,916 [INFO]: 	Computing best hyperparameters for index knn.index 03/09/2025, 07:53:55
2025-03-09 07:54:39,113 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 43.1959 secs
2025-03-09 07:54:39,113 [INFO]: The best hyperparameters are: efSearch=217
2025-03-09 07:54:39,113 [INFO]: 	Compute fast metrics 03/09/2025, 07:54:39
  0%|          | 0/4 [00:00<?, ?it/s] 50%|█████     | 2/4 [00:00<00:00, 16.28it/s] 75%|███████▌  | 3/4 [00:00<00:00, 16.31it/s]
2025-03-09 07:54:51,948 [INFO]: 	>>> Finished "Compute fast metrics" in 12.8345 secs
2025-03-09 07:54:51,950 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 59.8755 secs
2025-03-09 07:54:51,950 [INFO]: {
2025-03-09 07:54:51,950 [INFO]: 	index_key: HNSW15
2025-03-09 07:54:51,950 [INFO]: 	index_param: efSearch=217
2025-03-09 07:54:51,950 [INFO]: 	index_path: knn.index
2025-03-09 07:54:51,950 [INFO]: 	size in bytes: 802518910
2025-03-09 07:54:51,950 [INFO]: 	avg_search_speed_ms: 11.184041023721097
2025-03-09 07:54:51,950 [INFO]: 	99p_search_speed_ms: 26.97021934203799
2025-03-09 07:54:51,951 [INFO]: 	reconstruction error %: 0.0
2025-03-09 07:54:51,951 [INFO]: 	nb vectors: 4079
2025-03-09 07:54:51,951 [INFO]: 	vectors dimension: 49152
2025-03-09 07:54:51,951 [INFO]: 	compression ratio: 0.9993085795324125
2025-03-09 07:54:51,951 [INFO]: }
2025-03-09 07:54:51,951 [INFO]: 	>>> Finished "Creating the index" in 59.8769 secs
2025-03-09 07:54:51,951 [INFO]: >>> Finished "Launching the whole pipeline" in 59.9036 secs
2025-03-09 07:54:52: [retrieval_preprocessing] calculating distances ...
2025-03-09 07:54:53: [retrieval_preprocessing] finished and saved retrieval indices for episode 33308 [episode count 12/20]
[retrieval_preprocessing] for episode 27294 [episode count 13/20], we have num_retrieval=np.int64(4005) num_query=np.int64(277)
2025-03-09 07:54:54,240 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-09 07:54:55,093 [INFO]: Launching the whole pipeline 03/09/2025, 07:54:55
2025-03-09 07:54:55,093 [INFO]: Reading total number of vectors and dimension 03/09/2025, 07:54:55
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1460.92it/s]
2025-03-09 07:54:55,120 [INFO]: There are 4005 embeddings of dim 49152
2025-03-09 07:54:55,121 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0273 secs
2025-03-09 07:54:55,121 [INFO]: 	Compute estimated construction time of the index 03/09/2025, 07:54:55
2025-03-09 07:54:55,121 [INFO]: 		-> Train: 16.7 minutes
2025-03-09 07:54:55,121 [INFO]: 		-> Add: 2.2 seconds
2025-03-09 07:54:55,121 [INFO]: 		Total: 16.7 minutes
2025-03-09 07:54:55,121 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0001 secs
2025-03-09 07:54:55,121 [INFO]: 	Checking that your have enough memory available to create the index 03/09/2025, 07:54:55
2025-03-09 07:54:55,121 [INFO]: 826.5MB of memory will be needed to build the index (more might be used if you have more)
2025-03-09 07:54:55,121 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0002 secs
2025-03-09 07:54:55,121 [INFO]: 	Selecting most promising index types given data characteristics 03/09/2025, 07:54:55
2025-03-09 07:54:55,121 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-09 07:54:55,121 [INFO]: 	Creating the index 03/09/2025, 07:54:55
2025-03-09 07:54:55,121 [INFO]: 		-> Instanciate the index HNSW15 03/09/2025, 07:54:55
2025-03-09 07:54:55,122 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0012 secs
2025-03-09 07:54:55,123 [INFO]: 		-> Adding the vectors to the index 03/09/2025, 07:54:55
2025-03-09 07:54:55,123 [INFO]: The memory available for adding the vectors is 49.3GB(total available - used by the index)
2025-03-09 07:54:55,123 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/16 [00:00<?, ?it/s] 12%|█▎        | 2/16 [00:00<00:00, 19.86it/s] 50%|█████     | 8/16 [00:00<00:00, 40.13it/s] 88%|████████▊ | 14/16 [00:00<00:00, 45.51it/s]100%|██████████| 16/16 [00:03<00:00,  5.21it/s]
2025-03-09 07:54:58,254 [INFO]: 	Computing best hyperparameters for index knn.index 03/09/2025, 07:54:58
2025-03-09 07:55:41,680 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 43.4257 secs
2025-03-09 07:55:41,680 [INFO]: The best hyperparameters are: efSearch=208
2025-03-09 07:55:41,680 [INFO]: 	Compute fast metrics 03/09/2025, 07:55:41
  0%|          | 0/4 [00:00<?, ?it/s] 25%|██▌       | 1/4 [00:00<00:00,  9.38it/s] 75%|███████▌  | 3/4 [00:00<00:00, 17.20it/s]
2025-03-09 07:55:57,264 [INFO]: 	>>> Finished "Compute fast metrics" in 15.5830 secs
2025-03-09 07:55:57,266 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 62.1431 secs
2025-03-09 07:55:57,266 [INFO]: {
2025-03-09 07:55:57,266 [INFO]: 	index_key: HNSW15
2025-03-09 07:55:57,266 [INFO]: 	index_param: efSearch=208
2025-03-09 07:55:57,266 [INFO]: 	index_path: knn.index
2025-03-09 07:55:57,266 [INFO]: 	size in bytes: 787959850
2025-03-09 07:55:57,266 [INFO]: 	avg_search_speed_ms: 9.5685854086287
2025-03-09 07:55:57,266 [INFO]: 	99p_search_speed_ms: 12.980652311816812
2025-03-09 07:55:57,266 [INFO]: 	reconstruction error %: 0.0
2025-03-09 07:55:57,266 [INFO]: 	nb vectors: 4005
2025-03-09 07:55:57,266 [INFO]: 	vectors dimension: 49152
2025-03-09 07:55:57,266 [INFO]: 	compression ratio: 0.9993085815222692
2025-03-09 07:55:57,266 [INFO]: }
2025-03-09 07:55:57,266 [INFO]: 	>>> Finished "Creating the index" in 62.1449 secs
2025-03-09 07:55:57,266 [INFO]: >>> Finished "Launching the whole pipeline" in 62.1729 secs
2025-03-09 07:55:58: [retrieval_preprocessing] calculating distances ...
2025-03-09 07:55:59: [retrieval_preprocessing] finished and saved retrieval indices for episode 27294 [episode count 13/20]
[retrieval_preprocessing] for episode 42143 [episode count 14/20], we have num_retrieval=np.int64(4091) num_query=np.int64(191)
2025-03-09 07:55:59,644 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-09 07:56:00,241 [INFO]: Launching the whole pipeline 03/09/2025, 07:56:00
2025-03-09 07:56:00,241 [INFO]: Reading total number of vectors and dimension 03/09/2025, 07:56:00
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 2162.01it/s]
2025-03-09 07:56:00,269 [INFO]: There are 4091 embeddings of dim 49152
2025-03-09 07:56:00,270 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0283 secs
2025-03-09 07:56:00,270 [INFO]: 	Compute estimated construction time of the index 03/09/2025, 07:56:00
2025-03-09 07:56:00,270 [INFO]: 		-> Train: 16.7 minutes
2025-03-09 07:56:00,270 [INFO]: 		-> Add: 2.2 seconds
2025-03-09 07:56:00,270 [INFO]: 		Total: 16.7 minutes
2025-03-09 07:56:00,270 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0001 secs
2025-03-09 07:56:00,270 [INFO]: 	Checking that your have enough memory available to create the index 03/09/2025, 07:56:00
2025-03-09 07:56:00,270 [INFO]: 844.3MB of memory will be needed to build the index (more might be used if you have more)
2025-03-09 07:56:00,270 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0001 secs
2025-03-09 07:56:00,270 [INFO]: 	Selecting most promising index types given data characteristics 03/09/2025, 07:56:00
2025-03-09 07:56:00,270 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-09 07:56:00,270 [INFO]: 	Creating the index 03/09/2025, 07:56:00
2025-03-09 07:56:00,270 [INFO]: 		-> Instanciate the index HNSW15 03/09/2025, 07:56:00
2025-03-09 07:56:00,271 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0009 secs
2025-03-09 07:56:00,271 [INFO]: 		-> Adding the vectors to the index 03/09/2025, 07:56:00
2025-03-09 07:56:00,271 [INFO]: The memory available for adding the vectors is 49.3GB(total available - used by the index)
2025-03-09 07:56:00,271 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/17 [00:00<?, ?it/s] 18%|█▊        | 3/17 [00:00<00:00, 25.60it/s] 53%|█████▎    | 9/17 [00:00<00:00, 40.87it/s] 88%|████████▊ | 15/17 [00:00<00:00, 45.74it/s]100%|██████████| 17/17 [00:03<00:00,  5.53it/s]
2025-03-09 07:56:03,515 [INFO]: 	Computing best hyperparameters for index knn.index 03/09/2025, 07:56:03
2025-03-09 07:56:48,008 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 44.4930 secs
2025-03-09 07:56:48,009 [INFO]: The best hyperparameters are: efSearch=218
2025-03-09 07:56:48,009 [INFO]: 	Compute fast metrics 03/09/2025, 07:56:48
  0%|          | 0/4 [00:00<?, ?it/s] 25%|██▌       | 1/4 [00:00<00:00,  9.00it/s] 75%|███████▌  | 3/4 [00:00<00:00, 15.41it/s]
2025-03-09 07:57:08,170 [INFO]: 	>>> Finished "Compute fast metrics" in 20.1611 secs
2025-03-09 07:57:08,172 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 67.9008 secs
2025-03-09 07:57:08,172 [INFO]: {
2025-03-09 07:57:08,172 [INFO]: 	index_key: HNSW15
2025-03-09 07:57:08,172 [INFO]: 	index_param: efSearch=218
2025-03-09 07:57:08,172 [INFO]: 	index_path: knn.index
2025-03-09 07:57:08,172 [INFO]: 	size in bytes: 804879790
2025-03-09 07:57:08,172 [INFO]: 	avg_search_speed_ms: 10.224809609201179
2025-03-09 07:57:08,172 [INFO]: 	99p_search_speed_ms: 21.387430070899455
2025-03-09 07:57:08,172 [INFO]: 	reconstruction error %: 0.0
2025-03-09 07:57:08,172 [INFO]: 	nb vectors: 4091
2025-03-09 07:57:08,172 [INFO]: 	vectors dimension: 49152
2025-03-09 07:57:08,172 [INFO]: 	compression ratio: 0.9993086396168551
2025-03-09 07:57:08,172 [INFO]: }
2025-03-09 07:57:08,172 [INFO]: 	>>> Finished "Creating the index" in 67.9023 secs
2025-03-09 07:57:08,172 [INFO]: >>> Finished "Launching the whole pipeline" in 67.9311 secs
2025-03-09 07:57:09: [retrieval_preprocessing] calculating distances ...
2025-03-09 07:57:10: [retrieval_preprocessing] finished and saved retrieval indices for episode 42143 [episode count 14/20]
[retrieval_preprocessing] for episode 81952 [episode count 15/20], we have num_retrieval=np.int64(4089) num_query=np.int64(193)
2025-03-09 07:57:10,520 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-09 07:57:11,260 [INFO]: Launching the whole pipeline 03/09/2025, 07:57:11
2025-03-09 07:57:11,260 [INFO]: Reading total number of vectors and dimension 03/09/2025, 07:57:11
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1878.33it/s]
2025-03-09 07:57:11,287 [INFO]: There are 4089 embeddings of dim 49152
2025-03-09 07:57:11,287 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0269 secs
2025-03-09 07:57:11,287 [INFO]: 	Compute estimated construction time of the index 03/09/2025, 07:57:11
2025-03-09 07:57:11,287 [INFO]: 		-> Train: 16.7 minutes
2025-03-09 07:57:11,287 [INFO]: 		-> Add: 2.2 seconds
2025-03-09 07:57:11,287 [INFO]: 		Total: 16.7 minutes
2025-03-09 07:57:11,287 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0001 secs
2025-03-09 07:57:11,288 [INFO]: 	Checking that your have enough memory available to create the index 03/09/2025, 07:57:11
2025-03-09 07:57:11,288 [INFO]: 843.9MB of memory will be needed to build the index (more might be used if you have more)
2025-03-09 07:57:11,288 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0002 secs
2025-03-09 07:57:11,288 [INFO]: 	Selecting most promising index types given data characteristics 03/09/2025, 07:57:11
2025-03-09 07:57:11,288 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-09 07:57:11,288 [INFO]: 	Creating the index 03/09/2025, 07:57:11
2025-03-09 07:57:11,288 [INFO]: 		-> Instanciate the index HNSW15 03/09/2025, 07:57:11
2025-03-09 07:57:11,289 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0011 secs
2025-03-09 07:57:11,289 [INFO]: 		-> Adding the vectors to the index 03/09/2025, 07:57:11
2025-03-09 07:57:11,289 [INFO]: The memory available for adding the vectors is 49.3GB(total available - used by the index)
2025-03-09 07:57:11,289 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/17 [00:00<?, ?it/s]  6%|▌         | 1/17 [00:00<00:01,  9.00it/s] 29%|██▉       | 5/17 [00:00<00:00, 24.07it/s] 47%|████▋     | 8/17 [00:00<00:00, 20.50it/s] 76%|███████▋  | 13/17 [00:00<00:00, 28.11it/s]100%|██████████| 17/17 [00:03<00:00,  2.98it/s]100%|██████████| 17/17 [00:03<00:00,  4.43it/s]
2025-03-09 07:57:15,126 [INFO]: 	Computing best hyperparameters for index knn.index 03/09/2025, 07:57:15
2025-03-09 07:57:55,892 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 40.7657 secs
2025-03-09 07:57:55,893 [INFO]: The best hyperparameters are: efSearch=168
2025-03-09 07:57:55,893 [INFO]: 	Compute fast metrics 03/09/2025, 07:57:55
  0%|          | 0/4 [00:00<?, ?it/s] 50%|█████     | 2/4 [00:00<00:00, 18.41it/s] 75%|███████▌  | 3/4 [00:00<00:00, 19.05it/s]
2025-03-09 07:58:10,266 [INFO]: 	>>> Finished "Compute fast metrics" in 14.3734 secs
2025-03-09 07:58:10,307 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 59.0175 secs
2025-03-09 07:58:10,307 [INFO]: {
2025-03-09 07:58:10,307 [INFO]: 	index_key: HNSW15
2025-03-09 07:58:10,307 [INFO]: 	index_param: efSearch=168
2025-03-09 07:58:10,307 [INFO]: 	index_path: knn.index
2025-03-09 07:58:10,307 [INFO]: 	size in bytes: 804486310
2025-03-09 07:58:10,307 [INFO]: 	avg_search_speed_ms: 8.520464633204348
2025-03-09 07:58:10,307 [INFO]: 	99p_search_speed_ms: 19.87818574532866
2025-03-09 07:58:10,307 [INFO]: 	reconstruction error %: 0.0
2025-03-09 07:58:10,307 [INFO]: 	nb vectors: 4089
2025-03-09 07:58:10,307 [INFO]: 	vectors dimension: 49152
2025-03-09 07:58:10,307 [INFO]: 	compression ratio: 0.9993086296272711
2025-03-09 07:58:10,307 [INFO]: }
2025-03-09 07:58:10,308 [INFO]: 	>>> Finished "Creating the index" in 59.0196 secs
2025-03-09 07:58:10,308 [INFO]: >>> Finished "Launching the whole pipeline" in 59.0473 secs
2025-03-09 07:58:10: [retrieval_preprocessing] calculating distances ...
2025-03-09 07:58:11: [retrieval_preprocessing] finished and saved retrieval indices for episode 81952 [episode count 15/20]
[retrieval_preprocessing] for episode 17953 [episode count 16/20], we have num_retrieval=np.int64(4090) num_query=np.int64(192)
2025-03-09 07:58:11,777 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-09 07:58:12,357 [INFO]: Launching the whole pipeline 03/09/2025, 07:58:12
2025-03-09 07:58:12,357 [INFO]: Reading total number of vectors and dimension 03/09/2025, 07:58:12
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1689.89it/s]
2025-03-09 07:58:12,382 [INFO]: There are 4090 embeddings of dim 49152
2025-03-09 07:58:12,382 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0252 secs
2025-03-09 07:58:12,382 [INFO]: 	Compute estimated construction time of the index 03/09/2025, 07:58:12
2025-03-09 07:58:12,383 [INFO]: 		-> Train: 16.7 minutes
2025-03-09 07:58:12,383 [INFO]: 		-> Add: 2.2 seconds
2025-03-09 07:58:12,383 [INFO]: 		Total: 16.7 minutes
2025-03-09 07:58:12,383 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0001 secs
2025-03-09 07:58:12,383 [INFO]: 	Checking that your have enough memory available to create the index 03/09/2025, 07:58:12
2025-03-09 07:58:12,383 [INFO]: 844.1MB of memory will be needed to build the index (more might be used if you have more)
2025-03-09 07:58:12,383 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0003 secs
2025-03-09 07:58:12,383 [INFO]: 	Selecting most promising index types given data characteristics 03/09/2025, 07:58:12
2025-03-09 07:58:12,383 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-09 07:58:12,383 [INFO]: 	Creating the index 03/09/2025, 07:58:12
2025-03-09 07:58:12,383 [INFO]: 		-> Instanciate the index HNSW15 03/09/2025, 07:58:12
2025-03-09 07:58:12,384 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0010 secs
2025-03-09 07:58:12,384 [INFO]: 		-> Adding the vectors to the index 03/09/2025, 07:58:12
2025-03-09 07:58:12,384 [INFO]: The memory available for adding the vectors is 49.3GB(total available - used by the index)
2025-03-09 07:58:12,384 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/17 [00:00<?, ?it/s]  6%|▌         | 1/17 [00:00<00:01,  9.32it/s] 41%|████      | 7/17 [00:00<00:00, 35.19it/s] 76%|███████▋  | 13/17 [00:00<00:00, 42.93it/s]100%|██████████| 17/17 [00:03<00:00,  4.52it/s]
2025-03-09 07:58:16,146 [INFO]: 	Computing best hyperparameters for index knn.index 03/09/2025, 07:58:16
2025-03-09 07:58:58,324 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 42.1772 secs
2025-03-09 07:58:58,324 [INFO]: The best hyperparameters are: efSearch=205
2025-03-09 07:58:58,324 [INFO]: 	Compute fast metrics 03/09/2025, 07:58:58
  0%|          | 0/4 [00:00<?, ?it/s] 50%|█████     | 2/4 [00:00<00:00, 19.45it/s] 75%|███████▌  | 3/4 [00:00<00:00, 21.02it/s]
2025-03-09 07:59:15,130 [INFO]: 	>>> Finished "Compute fast metrics" in 16.8061 secs
2025-03-09 07:59:15,134 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 62.7493 secs
2025-03-09 07:59:15,134 [INFO]: {
2025-03-09 07:59:15,134 [INFO]: 	index_key: HNSW15
2025-03-09 07:59:15,134 [INFO]: 	index_param: efSearch=205
2025-03-09 07:59:15,134 [INFO]: 	index_path: knn.index
2025-03-09 07:59:15,134 [INFO]: 	size in bytes: 804683050
2025-03-09 07:59:15,134 [INFO]: 	avg_search_speed_ms: 10.642543372926005
2025-03-09 07:59:15,134 [INFO]: 	99p_search_speed_ms: 22.813273032661527
2025-03-09 07:59:15,134 [INFO]: 	reconstruction error %: 0.0
2025-03-09 07:59:15,134 [INFO]: 	nb vectors: 4090
2025-03-09 07:59:15,134 [INFO]: 	vectors dimension: 49152
2025-03-09 07:59:15,134 [INFO]: 	compression ratio: 0.9993086346232842
2025-03-09 07:59:15,134 [INFO]: }
2025-03-09 07:59:15,134 [INFO]: 	>>> Finished "Creating the index" in 62.7509 secs
2025-03-09 07:59:15,134 [INFO]: >>> Finished "Launching the whole pipeline" in 62.7769 secs
2025-03-09 07:59:16: [retrieval_preprocessing] calculating distances ...
2025-03-09 07:59:16: [retrieval_preprocessing] finished and saved retrieval indices for episode 17953 [episode count 16/20]
[retrieval_preprocessing] for episode 24097 [episode count 17/20], we have num_retrieval=np.int64(4065) num_query=np.int64(217)
2025-03-09 07:59:16,994 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-09 07:59:17,676 [INFO]: Launching the whole pipeline 03/09/2025, 07:59:17
2025-03-09 07:59:17,676 [INFO]: Reading total number of vectors and dimension 03/09/2025, 07:59:17
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1457.37it/s]
2025-03-09 07:59:17,704 [INFO]: There are 4065 embeddings of dim 49152
2025-03-09 07:59:17,705 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0285 secs
2025-03-09 07:59:17,705 [INFO]: 	Compute estimated construction time of the index 03/09/2025, 07:59:17
2025-03-09 07:59:17,705 [INFO]: 		-> Train: 16.7 minutes
2025-03-09 07:59:17,705 [INFO]: 		-> Add: 2.2 seconds
2025-03-09 07:59:17,705 [INFO]: 		Total: 16.7 minutes
2025-03-09 07:59:17,705 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0001 secs
2025-03-09 07:59:17,705 [INFO]: 	Checking that your have enough memory available to create the index 03/09/2025, 07:59:17
2025-03-09 07:59:17,705 [INFO]: 838.9MB of memory will be needed to build the index (more might be used if you have more)
2025-03-09 07:59:17,705 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0002 secs
2025-03-09 07:59:17,705 [INFO]: 	Selecting most promising index types given data characteristics 03/09/2025, 07:59:17
2025-03-09 07:59:17,705 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-09 07:59:17,705 [INFO]: 	Creating the index 03/09/2025, 07:59:17
2025-03-09 07:59:17,705 [INFO]: 		-> Instanciate the index HNSW15 03/09/2025, 07:59:17
2025-03-09 07:59:17,706 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0011 secs
2025-03-09 07:59:17,706 [INFO]: 		-> Adding the vectors to the index 03/09/2025, 07:59:17
2025-03-09 07:59:17,706 [INFO]: The memory available for adding the vectors is 49.3GB(total available - used by the index)
2025-03-09 07:59:17,707 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/17 [00:00<?, ?it/s]  6%|▌         | 1/17 [00:00<00:01,  8.24it/s] 41%|████      | 7/17 [00:00<00:00, 33.29it/s] 76%|███████▋  | 13/17 [00:00<00:00, 41.38it/s]100%|██████████| 17/17 [00:03<00:00,  4.69it/s]
2025-03-09 07:59:21,336 [INFO]: 	Computing best hyperparameters for index knn.index 03/09/2025, 07:59:21
2025-03-09 08:00:06,244 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 44.9077 secs
2025-03-09 08:00:06,245 [INFO]: The best hyperparameters are: efSearch=217
2025-03-09 08:00:06,245 [INFO]: 	Compute fast metrics 03/09/2025, 08:00:06
  0%|          | 0/4 [00:00<?, ?it/s] 50%|█████     | 2/4 [00:00<00:00, 15.96it/s] 75%|███████▌  | 3/4 [00:00<00:00, 15.66it/s]
2025-03-09 08:00:21,643 [INFO]: 	>>> Finished "Compute fast metrics" in 15.3986 secs
2025-03-09 08:00:21,646 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 63.9394 secs
2025-03-09 08:00:21,646 [INFO]: {
2025-03-09 08:00:21,646 [INFO]: 	index_key: HNSW15
2025-03-09 08:00:21,646 [INFO]: 	index_param: efSearch=217
2025-03-09 08:00:21,646 [INFO]: 	index_path: knn.index
2025-03-09 08:00:21,646 [INFO]: 	size in bytes: 799764430
2025-03-09 08:00:21,646 [INFO]: 	avg_search_speed_ms: 11.134267454595618
2025-03-09 08:00:21,646 [INFO]: 	99p_search_speed_ms: 27.335945265367613
2025-03-09 08:00:21,646 [INFO]: 	reconstruction error %: 0.0
2025-03-09 08:00:21,646 [INFO]: 	nb vectors: 4065
2025-03-09 08:00:21,646 [INFO]: 	vectors dimension: 49152
2025-03-09 08:00:21,646 [INFO]: 	compression ratio: 0.999308658925979
2025-03-09 08:00:21,646 [INFO]: }
2025-03-09 08:00:21,646 [INFO]: 	>>> Finished "Creating the index" in 63.9411 secs
2025-03-09 08:00:21,646 [INFO]: >>> Finished "Launching the whole pipeline" in 63.9702 secs
2025-03-09 08:00:22: [retrieval_preprocessing] calculating distances ...
2025-03-09 08:00:23: [retrieval_preprocessing] finished and saved retrieval indices for episode 24097 [episode count 17/20]
[retrieval_preprocessing] for episode 28193 [episode count 18/20], we have num_retrieval=np.int64(4048) num_query=np.int64(234)
2025-03-09 08:00:23,856 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-09 08:00:24,413 [INFO]: Launching the whole pipeline 03/09/2025, 08:00:24
2025-03-09 08:00:24,413 [INFO]: Reading total number of vectors and dimension 03/09/2025, 08:00:24
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1709.87it/s]
2025-03-09 08:00:24,438 [INFO]: There are 4048 embeddings of dim 49152
2025-03-09 08:00:24,438 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0245 secs
2025-03-09 08:00:24,438 [INFO]: 	Compute estimated construction time of the index 03/09/2025, 08:00:24
2025-03-09 08:00:24,438 [INFO]: 		-> Train: 16.7 minutes
2025-03-09 08:00:24,438 [INFO]: 		-> Add: 2.2 seconds
2025-03-09 08:00:24,438 [INFO]: 		Total: 16.7 minutes
2025-03-09 08:00:24,438 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0001 secs
2025-03-09 08:00:24,438 [INFO]: 	Checking that your have enough memory available to create the index 03/09/2025, 08:00:24
2025-03-09 08:00:24,438 [INFO]: 835.4MB of memory will be needed to build the index (more might be used if you have more)
2025-03-09 08:00:24,438 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0001 secs
2025-03-09 08:00:24,438 [INFO]: 	Selecting most promising index types given data characteristics 03/09/2025, 08:00:24
2025-03-09 08:00:24,438 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-09 08:00:24,438 [INFO]: 	Creating the index 03/09/2025, 08:00:24
2025-03-09 08:00:24,438 [INFO]: 		-> Instanciate the index HNSW15 03/09/2025, 08:00:24
2025-03-09 08:00:24,439 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0009 secs
2025-03-09 08:00:24,439 [INFO]: 		-> Adding the vectors to the index 03/09/2025, 08:00:24
2025-03-09 08:00:24,440 [INFO]: The memory available for adding the vectors is 49.3GB(total available - used by the index)
2025-03-09 08:00:24,440 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/16 [00:00<?, ?it/s] 12%|█▎        | 2/16 [00:00<00:00, 18.06it/s] 56%|█████▋    | 9/16 [00:00<00:00, 43.73it/s]100%|██████████| 16/16 [00:02<00:00,  4.79it/s]100%|██████████| 16/16 [00:02<00:00,  5.74it/s]
2025-03-09 08:00:27,229 [INFO]: 	Computing best hyperparameters for index knn.index 03/09/2025, 08:00:27
2025-03-09 08:01:11,526 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 44.2958 secs
2025-03-09 08:01:11,526 [INFO]: The best hyperparameters are: efSearch=191
2025-03-09 08:01:11,526 [INFO]: 	Compute fast metrics 03/09/2025, 08:01:11
  0%|          | 0/4 [00:00<?, ?it/s] 75%|███████▌  | 3/4 [00:00<00:00, 26.37it/s] 75%|███████▌  | 3/4 [00:00<00:00, 22.77it/s]
2025-03-09 08:01:27,337 [INFO]: 	>>> Finished "Compute fast metrics" in 15.8111 secs
2025-03-09 08:01:27,339 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 62.8995 secs
2025-03-09 08:01:27,339 [INFO]: {
2025-03-09 08:01:27,339 [INFO]: 	index_key: HNSW15
2025-03-09 08:01:27,339 [INFO]: 	index_param: efSearch=191
2025-03-09 08:01:27,339 [INFO]: 	index_path: knn.index
2025-03-09 08:01:27,339 [INFO]: 	size in bytes: 796419850
2025-03-09 08:01:27,339 [INFO]: 	avg_search_speed_ms: 8.085982183825674
2025-03-09 08:01:27,339 [INFO]: 	99p_search_speed_ms: 13.249919535592202
2025-03-09 08:01:27,339 [INFO]: 	reconstruction error %: 0.0
2025-03-09 08:01:27,339 [INFO]: 	nb vectors: 4048
2025-03-09 08:01:27,339 [INFO]: 	vectors dimension: 49152
2025-03-09 08:01:27,339 [INFO]: 	compression ratio: 0.9993085732355868
2025-03-09 08:01:27,339 [INFO]: }
2025-03-09 08:01:27,339 [INFO]: 	>>> Finished "Creating the index" in 62.9009 secs
2025-03-09 08:01:27,339 [INFO]: >>> Finished "Launching the whole pipeline" in 62.9260 secs
2025-03-09 08:01:28: [retrieval_preprocessing] calculating distances ...
2025-03-09 08:01:28: [retrieval_preprocessing] finished and saved retrieval indices for episode 28193 [episode count 18/20]
[retrieval_preprocessing] for episode 33700 [episode count 19/20], we have num_retrieval=np.int64(4083) num_query=np.int64(199)
2025-03-09 08:01:29,209 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-09 08:01:29,689 [INFO]: Launching the whole pipeline 03/09/2025, 08:01:29
2025-03-09 08:01:29,689 [INFO]: Reading total number of vectors and dimension 03/09/2025, 08:01:29
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1447.31it/s]
2025-03-09 08:01:29,715 [INFO]: There are 4083 embeddings of dim 49152
2025-03-09 08:01:29,715 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0262 secs
2025-03-09 08:01:29,716 [INFO]: 	Compute estimated construction time of the index 03/09/2025, 08:01:29
2025-03-09 08:01:29,716 [INFO]: 		-> Train: 16.7 minutes
2025-03-09 08:01:29,716 [INFO]: 		-> Add: 2.2 seconds
2025-03-09 08:01:29,716 [INFO]: 		Total: 16.7 minutes
2025-03-09 08:01:29,716 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0005 secs
2025-03-09 08:01:29,716 [INFO]: 	Checking that your have enough memory available to create the index 03/09/2025, 08:01:29
2025-03-09 08:01:29,717 [INFO]: 842.6MB of memory will be needed to build the index (more might be used if you have more)
2025-03-09 08:01:29,717 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0004 secs
2025-03-09 08:01:29,717 [INFO]: 	Selecting most promising index types given data characteristics 03/09/2025, 08:01:29
2025-03-09 08:01:29,717 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-09 08:01:29,717 [INFO]: 	Creating the index 03/09/2025, 08:01:29
2025-03-09 08:01:29,717 [INFO]: 		-> Instanciate the index HNSW15 03/09/2025, 08:01:29
2025-03-09 08:01:29,720 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0023 secs
2025-03-09 08:01:29,720 [INFO]: 		-> Adding the vectors to the index 03/09/2025, 08:01:29
2025-03-09 08:01:29,720 [INFO]: The memory available for adding the vectors is 49.3GB(total available - used by the index)
2025-03-09 08:01:29,720 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/17 [00:00<?, ?it/s] 12%|█▏        | 2/17 [00:00<00:00, 19.41it/s] 53%|█████▎    | 9/17 [00:00<00:00, 45.83it/s] 94%|█████████▍| 16/17 [00:00<00:00, 54.28it/s]100%|██████████| 17/17 [00:03<00:00,  5.65it/s]
2025-03-09 08:01:32,735 [INFO]: 	Computing best hyperparameters for index knn.index 03/09/2025, 08:01:32
2025-03-09 08:02:26,428 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 53.6927 secs
2025-03-09 08:02:26,429 [INFO]: The best hyperparameters are: efSearch=191
2025-03-09 08:02:26,429 [INFO]: 	Compute fast metrics 03/09/2025, 08:02:26
  0%|          | 0/4 [00:00<?, ?it/s] 50%|█████     | 2/4 [00:00<00:00, 18.70it/s] 75%|███████▌  | 3/4 [00:00<00:00, 20.16it/s]
2025-03-09 08:02:41,195 [INFO]: 	>>> Finished "Compute fast metrics" in 14.7657 secs
2025-03-09 08:02:41,197 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 71.4765 secs
2025-03-09 08:02:41,197 [INFO]: {
2025-03-09 08:02:41,197 [INFO]: 	index_key: HNSW15
2025-03-09 08:02:41,197 [INFO]: 	index_param: efSearch=191
2025-03-09 08:02:41,197 [INFO]: 	index_path: knn.index
2025-03-09 08:02:41,197 [INFO]: 	size in bytes: 803305870
2025-03-09 08:02:41,197 [INFO]: 	avg_search_speed_ms: 9.671954743427223
2025-03-09 08:02:41,197 [INFO]: 	99p_search_speed_ms: 25.921687418594935
2025-03-09 08:02:41,197 [INFO]: 	reconstruction error %: 0.0
2025-03-09 08:02:41,197 [INFO]: 	nb vectors: 4083
2025-03-09 08:02:41,197 [INFO]: 	vectors dimension: 49152
2025-03-09 08:02:41,197 [INFO]: 	compression ratio: 0.9993085995998012
2025-03-09 08:02:41,197 [INFO]: }
2025-03-09 08:02:41,197 [INFO]: 	>>> Finished "Creating the index" in 71.4796 secs
2025-03-09 08:02:41,197 [INFO]: >>> Finished "Launching the whole pipeline" in 71.5079 secs
2025-03-09 08:02:42: [retrieval_preprocessing] calculating distances ...
2025-03-09 08:02:42: [retrieval_preprocessing] finished and saved retrieval indices for episode 33700 [episode count 19/20]
2025-03-09 08:02:42: [retrieval_preprocessing] finished for (666854965, 'marker') [chosen_id count 3/10]
2025-03-09 08:02:43: [retrieval_preprocessing] concatenated all embeddings and indices for 20 episodes for (395700094, 'block') [chosen_id count 4/10]
2025-03-09 08:02:43: [retrieval_preprocessing] we have num_total=1510 embedding_dim=49152
[retrieval_preprocessing] for episode 52481 [episode count 0/20], we have num_retrieval=np.int64(1439) num_query=np.int64(71)
2025-03-09 08:02:43,372 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-09 08:02:43,544 [INFO]: Launching the whole pipeline 03/09/2025, 08:02:43
2025-03-09 08:02:43,544 [INFO]: Reading total number of vectors and dimension 03/09/2025, 08:02:43
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1500.65it/s]
2025-03-09 08:02:43,572 [INFO]: There are 1439 embeddings of dim 49152
2025-03-09 08:02:43,572 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0281 secs
2025-03-09 08:02:43,572 [INFO]: 	Compute estimated construction time of the index 03/09/2025, 08:02:43
2025-03-09 08:02:43,572 [INFO]: 		-> Train: 16.7 minutes
2025-03-09 08:02:43,572 [INFO]: 		-> Add: 0.8 seconds
2025-03-09 08:02:43,573 [INFO]: 		Total: 16.7 minutes
2025-03-09 08:02:43,573 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0003 secs
2025-03-09 08:02:43,573 [INFO]: 	Checking that your have enough memory available to create the index 03/09/2025, 08:02:43
2025-03-09 08:02:43,573 [INFO]: 297.0MB of memory will be needed to build the index (more might be used if you have more)
2025-03-09 08:02:43,573 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0004 secs
2025-03-09 08:02:43,573 [INFO]: 	Selecting most promising index types given data characteristics 03/09/2025, 08:02:43
2025-03-09 08:02:43,573 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-09 08:02:43,573 [INFO]: 	Creating the index 03/09/2025, 08:02:43
2025-03-09 08:02:43,574 [INFO]: 		-> Instanciate the index HNSW15 03/09/2025, 08:02:43
2025-03-09 08:02:43,577 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0028 secs
2025-03-09 08:02:43,577 [INFO]: 		-> Adding the vectors to the index 03/09/2025, 08:02:43
2025-03-09 08:02:43,577 [INFO]: The memory available for adding the vectors is 49.7GB(total available - used by the index)
2025-03-09 08:02:43,577 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/6 [00:00<?, ?it/s] 50%|█████     | 3/6 [00:00<00:00, 26.41it/s]100%|██████████| 6/6 [00:01<00:00,  4.85it/s]100%|██████████| 6/6 [00:01<00:00,  5.52it/s]
2025-03-09 08:02:45,309 [INFO]: 	Computing best hyperparameters for index knn.index 03/09/2025, 08:02:45
2025-03-09 08:03:03,820 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 18.5116 secs
2025-03-09 08:03:03,821 [INFO]: The best hyperparameters are: efSearch=147
2025-03-09 08:03:03,821 [INFO]: 	Compute fast metrics 03/09/2025, 08:03:03
  0%|          | 0/4 [00:00<?, ?it/s] 50%|█████     | 2/4 [00:00<00:00, 18.21it/s] 75%|███████▌  | 3/4 [00:00<00:00, 20.35it/s]
2025-03-09 08:03:17,452 [INFO]: 	>>> Finished "Compute fast metrics" in 13.6315 secs
2025-03-09 08:03:17,454 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 33.8768 secs
2025-03-09 08:03:17,454 [INFO]: {
2025-03-09 08:03:17,454 [INFO]: 	index_key: HNSW15
2025-03-09 08:03:17,454 [INFO]: 	index_param: efSearch=147
2025-03-09 08:03:17,454 [INFO]: 	index_path: knn.index
2025-03-09 08:03:17,454 [INFO]: 	size in bytes: 283114690
2025-03-09 08:03:17,454 [INFO]: 	avg_search_speed_ms: 7.191629660376739
2025-03-09 08:03:17,454 [INFO]: 	99p_search_speed_ms: 18.719297647476193
2025-03-09 08:03:17,454 [INFO]: 	reconstruction error %: 0.0
2025-03-09 08:03:17,454 [INFO]: 	nb vectors: 1439
2025-03-09 08:03:17,454 [INFO]: 	vectors dimension: 49152
2025-03-09 08:03:17,454 [INFO]: 	compression ratio: 0.9993084851937566
2025-03-09 08:03:17,454 [INFO]: }
2025-03-09 08:03:17,454 [INFO]: 	>>> Finished "Creating the index" in 33.8804 secs
2025-03-09 08:03:17,454 [INFO]: >>> Finished "Launching the whole pipeline" in 33.9101 secs
2025-03-09 08:03:18: [retrieval_preprocessing] calculating distances ...
2025-03-09 08:03:18: [retrieval_preprocessing] finished and saved retrieval indices for episode 52481 [episode count 0/20]
[retrieval_preprocessing] for episode 17538 [episode count 1/20], we have num_retrieval=np.int64(1434) num_query=np.int64(76)
2025-03-09 08:03:18,717 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-09 08:03:18,904 [INFO]: Launching the whole pipeline 03/09/2025, 08:03:18
2025-03-09 08:03:18,905 [INFO]: Reading total number of vectors and dimension 03/09/2025, 08:03:18
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1651.95it/s]
2025-03-09 08:03:18,931 [INFO]: There are 1434 embeddings of dim 49152
2025-03-09 08:03:18,932 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0270 secs
2025-03-09 08:03:18,932 [INFO]: 	Compute estimated construction time of the index 03/09/2025, 08:03:18
2025-03-09 08:03:18,932 [INFO]: 		-> Train: 16.7 minutes
2025-03-09 08:03:18,932 [INFO]: 		-> Add: 0.8 seconds
2025-03-09 08:03:18,932 [INFO]: 		Total: 16.7 minutes
2025-03-09 08:03:18,932 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0001 secs
2025-03-09 08:03:18,932 [INFO]: 	Checking that your have enough memory available to create the index 03/09/2025, 08:03:18
2025-03-09 08:03:18,932 [INFO]: 295.9MB of memory will be needed to build the index (more might be used if you have more)
2025-03-09 08:03:18,932 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0001 secs
2025-03-09 08:03:18,932 [INFO]: 	Selecting most promising index types given data characteristics 03/09/2025, 08:03:18
2025-03-09 08:03:18,932 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-09 08:03:18,932 [INFO]: 	Creating the index 03/09/2025, 08:03:18
2025-03-09 08:03:18,932 [INFO]: 		-> Instanciate the index HNSW15 03/09/2025, 08:03:18
2025-03-09 08:03:18,933 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0010 secs
2025-03-09 08:03:18,933 [INFO]: 		-> Adding the vectors to the index 03/09/2025, 08:03:18
2025-03-09 08:03:18,933 [INFO]: The memory available for adding the vectors is 49.7GB(total available - used by the index)
2025-03-09 08:03:18,933 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/6 [00:00<?, ?it/s] 33%|███▎      | 2/6 [00:00<00:00, 19.39it/s]100%|██████████| 6/6 [00:01<00:00,  4.95it/s]100%|██████████| 6/6 [00:01<00:00,  5.34it/s]
2025-03-09 08:03:20,060 [INFO]: 	Computing best hyperparameters for index knn.index 03/09/2025, 08:03:20
2025-03-09 08:03:40,820 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 20.7596 secs
2025-03-09 08:03:40,821 [INFO]: The best hyperparameters are: efSearch=309
2025-03-09 08:03:40,821 [INFO]: 	Compute fast metrics 03/09/2025, 08:03:40
  0%|          | 0/4 [00:00<?, ?it/s] 75%|███████▌  | 3/4 [00:00<00:00, 26.27it/s] 75%|███████▌  | 3/4 [00:00<00:00, 22.82it/s]
2025-03-09 08:03:54,393 [INFO]: 	>>> Finished "Compute fast metrics" in 13.5725 secs
2025-03-09 08:03:54,394 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 35.4612 secs
2025-03-09 08:03:54,394 [INFO]: {
2025-03-09 08:03:54,395 [INFO]: 	index_key: HNSW15
2025-03-09 08:03:54,395 [INFO]: 	index_param: efSearch=309
2025-03-09 08:03:54,395 [INFO]: 	index_path: knn.index
2025-03-09 08:03:54,395 [INFO]: 	size in bytes: 282130870
2025-03-09 08:03:54,395 [INFO]: 	avg_search_speed_ms: 10.71639656611306
2025-03-09 08:03:54,395 [INFO]: 	99p_search_speed_ms: 24.01492575183509
2025-03-09 08:03:54,395 [INFO]: 	reconstruction error %: 0.0
2025-03-09 08:03:54,395 [INFO]: 	nb vectors: 1434
2025-03-09 08:03:54,395 [INFO]: 	vectors dimension: 49152
2025-03-09 08:03:54,395 [INFO]: 	compression ratio: 0.9993088384833606
2025-03-09 08:03:54,395 [INFO]: }
2025-03-09 08:03:54,395 [INFO]: 	>>> Finished "Creating the index" in 35.4626 secs
2025-03-09 08:03:54,395 [INFO]: >>> Finished "Launching the whole pipeline" in 35.4902 secs
2025-03-09 08:03:55: [retrieval_preprocessing] calculating distances ...
2025-03-09 08:03:56: [retrieval_preprocessing] finished and saved retrieval indices for episode 17538 [episode count 1/20]
[retrieval_preprocessing] for episode 83972 [episode count 2/20], we have num_retrieval=np.int64(1430) num_query=np.int64(80)
2025-03-09 08:03:56,323 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-09 08:03:56,524 [INFO]: Launching the whole pipeline 03/09/2025, 08:03:56
2025-03-09 08:03:56,524 [INFO]: Reading total number of vectors and dimension 03/09/2025, 08:03:56
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1526.31it/s]
2025-03-09 08:03:56,549 [INFO]: There are 1430 embeddings of dim 49152
2025-03-09 08:03:56,549 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0253 secs
2025-03-09 08:03:56,549 [INFO]: 	Compute estimated construction time of the index 03/09/2025, 08:03:56
2025-03-09 08:03:56,549 [INFO]: 		-> Train: 16.7 minutes
2025-03-09 08:03:56,550 [INFO]: 		-> Add: 0.8 seconds
2025-03-09 08:03:56,550 [INFO]: 		Total: 16.7 minutes
2025-03-09 08:03:56,550 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0004 secs
2025-03-09 08:03:56,550 [INFO]: 	Checking that your have enough memory available to create the index 03/09/2025, 08:03:56
2025-03-09 08:03:56,550 [INFO]: 295.1MB of memory will be needed to build the index (more might be used if you have more)
2025-03-09 08:03:56,550 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0004 secs
2025-03-09 08:03:56,550 [INFO]: 	Selecting most promising index types given data characteristics 03/09/2025, 08:03:56
2025-03-09 08:03:56,551 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-09 08:03:56,551 [INFO]: 	Creating the index 03/09/2025, 08:03:56
2025-03-09 08:03:56,551 [INFO]: 		-> Instanciate the index HNSW15 03/09/2025, 08:03:56
2025-03-09 08:03:56,554 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0026 secs
2025-03-09 08:03:56,554 [INFO]: 		-> Adding the vectors to the index 03/09/2025, 08:03:56
2025-03-09 08:03:56,554 [INFO]: The memory available for adding the vectors is 49.7GB(total available - used by the index)
2025-03-09 08:03:56,554 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/6 [00:00<?, ?it/s] 33%|███▎      | 2/6 [00:00<00:00, 19.72it/s]100%|██████████| 6/6 [00:01<00:00,  3.97it/s]100%|██████████| 6/6 [00:01<00:00,  4.30it/s]
2025-03-09 08:03:57,954 [INFO]: 	Computing best hyperparameters for index knn.index 03/09/2025, 08:03:57
2025-03-09 08:04:22,396 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 24.4423 secs
2025-03-09 08:04:22,397 [INFO]: The best hyperparameters are: efSearch=178
2025-03-09 08:04:22,397 [INFO]: 	Compute fast metrics 03/09/2025, 08:04:22
  0%|          | 0/4 [00:00<?, ?it/s] 50%|█████     | 2/4 [00:00<00:00, 19.13it/s] 75%|███████▌  | 3/4 [00:00<00:00, 21.51it/s]
2025-03-09 08:04:34,394 [INFO]: 	>>> Finished "Compute fast metrics" in 11.9967 secs
2025-03-09 08:04:34,395 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 37.8409 secs
2025-03-09 08:04:34,395 [INFO]: {
2025-03-09 08:04:34,395 [INFO]: 	index_key: HNSW15
2025-03-09 08:04:34,395 [INFO]: 	index_param: efSearch=178
2025-03-09 08:04:34,395 [INFO]: 	index_path: knn.index
2025-03-09 08:04:34,395 [INFO]: 	size in bytes: 281343910
2025-03-09 08:04:34,395 [INFO]: 	avg_search_speed_ms: 7.9684206907937964
2025-03-09 08:04:34,395 [INFO]: 	99p_search_speed_ms: 19.139518323354437
2025-03-09 08:04:34,395 [INFO]: 	reconstruction error %: 0.0
2025-03-09 08:04:34,395 [INFO]: 	nb vectors: 1430
2025-03-09 08:04:34,395 [INFO]: 	vectors dimension: 49152
2025-03-09 08:04:34,395 [INFO]: 	compression ratio: 0.9993087819103673
2025-03-09 08:04:34,395 [INFO]: }
2025-03-09 08:04:34,395 [INFO]: 	>>> Finished "Creating the index" in 37.8444 secs
2025-03-09 08:04:34,395 [INFO]: >>> Finished "Launching the whole pipeline" in 37.8713 secs
2025-03-09 08:04:34: [retrieval_preprocessing] calculating distances ...
2025-03-09 08:04:34: [retrieval_preprocessing] finished and saved retrieval indices for episode 83972 [episode count 2/20]
[retrieval_preprocessing] for episode 2566 [episode count 3/20], we have num_retrieval=np.int64(1447) num_query=np.int64(63)
2025-03-09 08:04:35,004 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-09 08:04:35,184 [INFO]: Launching the whole pipeline 03/09/2025, 08:04:35
2025-03-09 08:04:35,184 [INFO]: Reading total number of vectors and dimension 03/09/2025, 08:04:35
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1453.33it/s]
2025-03-09 08:04:35,208 [INFO]: There are 1447 embeddings of dim 49152
2025-03-09 08:04:35,209 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0251 secs
2025-03-09 08:04:35,209 [INFO]: 	Compute estimated construction time of the index 03/09/2025, 08:04:35
2025-03-09 08:04:35,209 [INFO]: 		-> Train: 16.7 minutes
2025-03-09 08:04:35,209 [INFO]: 		-> Add: 0.8 seconds
2025-03-09 08:04:35,209 [INFO]: 		Total: 16.7 minutes
2025-03-09 08:04:35,209 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0002 secs
2025-03-09 08:04:35,209 [INFO]: 	Checking that your have enough memory available to create the index 03/09/2025, 08:04:35
2025-03-09 08:04:35,209 [INFO]: 298.6MB of memory will be needed to build the index (more might be used if you have more)
2025-03-09 08:04:35,209 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0002 secs
2025-03-09 08:04:35,210 [INFO]: 	Selecting most promising index types given data characteristics 03/09/2025, 08:04:35
2025-03-09 08:04:35,210 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-09 08:04:35,210 [INFO]: 	Creating the index 03/09/2025, 08:04:35
2025-03-09 08:04:35,210 [INFO]: 		-> Instanciate the index HNSW15 03/09/2025, 08:04:35
2025-03-09 08:04:35,212 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0019 secs
2025-03-09 08:04:35,212 [INFO]: 		-> Adding the vectors to the index 03/09/2025, 08:04:35
2025-03-09 08:04:35,212 [INFO]: The memory available for adding the vectors is 49.7GB(total available - used by the index)
2025-03-09 08:04:35,212 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/6 [00:00<?, ?it/s] 17%|█▋        | 1/6 [00:00<00:00,  7.72it/s]100%|██████████| 6/6 [00:01<00:00,  4.40it/s]100%|██████████| 6/6 [00:01<00:00,  4.49it/s]
2025-03-09 08:04:36,554 [INFO]: 	Computing best hyperparameters for index knn.index 03/09/2025, 08:04:36
2025-03-09 08:04:58,752 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 22.1986 secs
2025-03-09 08:04:58,753 [INFO]: The best hyperparameters are: efSearch=257
2025-03-09 08:04:58,753 [INFO]: 	Compute fast metrics 03/09/2025, 08:04:58
  0%|          | 0/4 [00:00<?, ?it/s] 75%|███████▌  | 3/4 [00:00<00:00, 28.30it/s] 75%|███████▌  | 3/4 [00:00<00:00, 24.41it/s]
2025-03-09 08:05:13,042 [INFO]: 	>>> Finished "Compute fast metrics" in 14.2896 secs
2025-03-09 08:05:13,044 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 37.8316 secs
2025-03-09 08:05:13,044 [INFO]: {
2025-03-09 08:05:13,044 [INFO]: 	index_key: HNSW15
2025-03-09 08:05:13,044 [INFO]: 	index_param: efSearch=257
2025-03-09 08:05:13,044 [INFO]: 	index_path: knn.index
2025-03-09 08:05:13,044 [INFO]: 	size in bytes: 284688610
2025-03-09 08:05:13,044 [INFO]: 	avg_search_speed_ms: 10.557810468363174
2025-03-09 08:05:13,044 [INFO]: 	99p_search_speed_ms: 23.880666079930947
2025-03-09 08:05:13,044 [INFO]: 	reconstruction error %: 0.0
2025-03-09 08:05:13,044 [INFO]: 	nb vectors: 1447
2025-03-09 08:05:13,044 [INFO]: 	vectors dimension: 49152
2025-03-09 08:05:13,044 [INFO]: 	compression ratio: 0.9993085989636186
2025-03-09 08:05:13,044 [INFO]: }
2025-03-09 08:05:13,044 [INFO]: 	>>> Finished "Creating the index" in 37.8344 secs
2025-03-09 08:05:13,044 [INFO]: >>> Finished "Launching the whole pipeline" in 37.8604 secs
2025-03-09 08:05:13: [retrieval_preprocessing] calculating distances ...
2025-03-09 08:05:13: [retrieval_preprocessing] finished and saved retrieval indices for episode 2566 [episode count 3/20]
[retrieval_preprocessing] for episode 28168 [episode count 4/20], we have num_retrieval=np.int64(1442) num_query=np.int64(68)
2025-03-09 08:05:13,637 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-09 08:05:13,838 [INFO]: Launching the whole pipeline 03/09/2025, 08:05:13
2025-03-09 08:05:13,838 [INFO]: Reading total number of vectors and dimension 03/09/2025, 08:05:13
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1691.93it/s]
2025-03-09 08:05:13,861 [INFO]: There are 1442 embeddings of dim 49152
2025-03-09 08:05:13,862 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0236 secs
2025-03-09 08:05:13,862 [INFO]: 	Compute estimated construction time of the index 03/09/2025, 08:05:13
2025-03-09 08:05:13,862 [INFO]: 		-> Train: 16.7 minutes
2025-03-09 08:05:13,862 [INFO]: 		-> Add: 0.8 seconds
2025-03-09 08:05:13,862 [INFO]: 		Total: 16.7 minutes
2025-03-09 08:05:13,862 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0001 secs
2025-03-09 08:05:13,862 [INFO]: 	Checking that your have enough memory available to create the index 03/09/2025, 08:05:13
2025-03-09 08:05:13,862 [INFO]: 297.6MB of memory will be needed to build the index (more might be used if you have more)
2025-03-09 08:05:13,862 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0001 secs
2025-03-09 08:05:13,862 [INFO]: 	Selecting most promising index types given data characteristics 03/09/2025, 08:05:13
2025-03-09 08:05:13,862 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-09 08:05:13,862 [INFO]: 	Creating the index 03/09/2025, 08:05:13
2025-03-09 08:05:13,862 [INFO]: 		-> Instanciate the index HNSW15 03/09/2025, 08:05:13
2025-03-09 08:05:13,863 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0008 secs
2025-03-09 08:05:13,863 [INFO]: 		-> Adding the vectors to the index 03/09/2025, 08:05:13
2025-03-09 08:05:13,863 [INFO]: The memory available for adding the vectors is 49.7GB(total available - used by the index)
2025-03-09 08:05:13,863 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/6 [00:00<?, ?it/s] 17%|█▋        | 1/6 [00:00<00:00,  9.66it/s]100%|██████████| 6/6 [00:01<00:00,  5.57it/s]100%|██████████| 6/6 [00:01<00:00,  5.68it/s]
2025-03-09 08:05:14,923 [INFO]: 	Computing best hyperparameters for index knn.index 03/09/2025, 08:05:14
2025-03-09 08:05:39,853 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 24.9301 secs
2025-03-09 08:05:39,854 [INFO]: The best hyperparameters are: efSearch=237
2025-03-09 08:05:39,854 [INFO]: 	Compute fast metrics 03/09/2025, 08:05:39
  0%|          | 0/4 [00:00<?, ?it/s] 50%|█████     | 2/4 [00:00<00:00, 19.57it/s] 75%|███████▌  | 3/4 [00:00<00:00, 21.14it/s]
2025-03-09 08:05:54,930 [INFO]: 	>>> Finished "Compute fast metrics" in 15.0768 secs
2025-03-09 08:05:54,932 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 41.0687 secs
2025-03-09 08:05:54,932 [INFO]: {
2025-03-09 08:05:54,932 [INFO]: 	index_key: HNSW15
2025-03-09 08:05:54,932 [INFO]: 	index_param: efSearch=237
2025-03-09 08:05:54,932 [INFO]: 	index_path: knn.index
2025-03-09 08:05:54,932 [INFO]: 	size in bytes: 283704910
2025-03-09 08:05:54,932 [INFO]: 	avg_search_speed_ms: 9.545956205093225
2025-03-09 08:05:54,932 [INFO]: 	99p_search_speed_ms: 21.454063523560755
2025-03-09 08:05:54,932 [INFO]: 	reconstruction error %: 0.0
2025-03-09 08:05:54,932 [INFO]: 	nb vectors: 1442
2025-03-09 08:05:54,932 [INFO]: 	vectors dimension: 49152
2025-03-09 08:05:54,932 [INFO]: 	compression ratio: 0.9993085280053842
2025-03-09 08:05:54,932 [INFO]: }
2025-03-09 08:05:54,932 [INFO]: 	>>> Finished "Creating the index" in 41.0700 secs
2025-03-09 08:05:54,932 [INFO]: >>> Finished "Launching the whole pipeline" in 41.0941 secs
2025-03-09 08:05:55: [retrieval_preprocessing] calculating distances ...
2025-03-09 08:05:55: [retrieval_preprocessing] finished and saved retrieval indices for episode 28168 [episode count 4/20]
[retrieval_preprocessing] for episode 60296 [episode count 5/20], we have num_retrieval=np.int64(1453) num_query=np.int64(57)
2025-03-09 08:05:55,550 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-09 08:05:55,767 [INFO]: Launching the whole pipeline 03/09/2025, 08:05:55
2025-03-09 08:05:55,767 [INFO]: Reading total number of vectors and dimension 03/09/2025, 08:05:55
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1867.46it/s]
2025-03-09 08:05:55,791 [INFO]: There are 1453 embeddings of dim 49152
2025-03-09 08:05:55,791 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0235 secs
2025-03-09 08:05:55,791 [INFO]: 	Compute estimated construction time of the index 03/09/2025, 08:05:55
2025-03-09 08:05:55,791 [INFO]: 		-> Train: 16.7 minutes
2025-03-09 08:05:55,791 [INFO]: 		-> Add: 0.8 seconds
2025-03-09 08:05:55,791 [INFO]: 		Total: 16.7 minutes
2025-03-09 08:05:55,791 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0001 secs
2025-03-09 08:05:55,791 [INFO]: 	Checking that your have enough memory available to create the index 03/09/2025, 08:05:55
2025-03-09 08:05:55,791 [INFO]: 299.9MB of memory will be needed to build the index (more might be used if you have more)
2025-03-09 08:05:55,791 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0001 secs
2025-03-09 08:05:55,791 [INFO]: 	Selecting most promising index types given data characteristics 03/09/2025, 08:05:55
2025-03-09 08:05:55,791 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-09 08:05:55,791 [INFO]: 	Creating the index 03/09/2025, 08:05:55
2025-03-09 08:05:55,791 [INFO]: 		-> Instanciate the index HNSW15 03/09/2025, 08:05:55
2025-03-09 08:05:55,792 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0009 secs
2025-03-09 08:05:55,792 [INFO]: 		-> Adding the vectors to the index 03/09/2025, 08:05:55
2025-03-09 08:05:55,792 [INFO]: The memory available for adding the vectors is 49.7GB(total available - used by the index)
2025-03-09 08:05:55,793 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/6 [00:00<?, ?it/s] 33%|███▎      | 2/6 [00:00<00:00, 15.83it/s]100%|██████████| 6/6 [00:01<00:00,  4.08it/s]100%|██████████| 6/6 [00:01<00:00,  4.41it/s]
2025-03-09 08:05:57,157 [INFO]: 	Computing best hyperparameters for index knn.index 03/09/2025, 08:05:57
2025-03-09 08:06:17,960 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 20.8021 secs
2025-03-09 08:06:17,960 [INFO]: The best hyperparameters are: efSearch=207
2025-03-09 08:06:17,960 [INFO]: 	Compute fast metrics 03/09/2025, 08:06:17
  0%|          | 0/4 [00:00<?, ?it/s] 50%|█████     | 2/4 [00:00<00:00, 19.93it/s] 75%|███████▌  | 3/4 [00:00<00:00, 22.19it/s]
2025-03-09 08:06:32,654 [INFO]: 	>>> Finished "Compute fast metrics" in 14.6935 secs
2025-03-09 08:06:32,655 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 36.8626 secs
2025-03-09 08:06:32,655 [INFO]: {
2025-03-09 08:06:32,655 [INFO]: 	index_key: HNSW15
2025-03-09 08:06:32,655 [INFO]: 	index_param: efSearch=207
2025-03-09 08:06:32,655 [INFO]: 	index_path: knn.index
2025-03-09 08:06:32,655 [INFO]: 	size in bytes: 285869050
2025-03-09 08:06:32,655 [INFO]: 	avg_search_speed_ms: 8.113544090067105
2025-03-09 08:06:32,655 [INFO]: 	99p_search_speed_ms: 17.20473151654005
2025-03-09 08:06:32,655 [INFO]: 	reconstruction error %: 0.0
2025-03-09 08:06:32,655 [INFO]: 	nb vectors: 1453
2025-03-09 08:06:32,655 [INFO]: 	vectors dimension: 49152
2025-03-09 08:06:32,655 [INFO]: 	compression ratio: 0.999308683468882
2025-03-09 08:06:32,655 [INFO]: }
2025-03-09 08:06:32,655 [INFO]: 	>>> Finished "Creating the index" in 36.8640 secs
2025-03-09 08:06:32,655 [INFO]: >>> Finished "Launching the whole pipeline" in 36.8880 secs
2025-03-09 08:06:32: [retrieval_preprocessing] calculating distances ...
2025-03-09 08:06:33: [retrieval_preprocessing] finished and saved retrieval indices for episode 60296 [episode count 5/20]
[retrieval_preprocessing] for episode 70152 [episode count 6/20], we have num_retrieval=np.int64(1439) num_query=np.int64(71)
2025-03-09 08:06:33,175 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-09 08:06:33,397 [INFO]: Launching the whole pipeline 03/09/2025, 08:06:33
2025-03-09 08:06:33,397 [INFO]: Reading total number of vectors and dimension 03/09/2025, 08:06:33
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 2066.16it/s]
2025-03-09 08:06:33,420 [INFO]: There are 1439 embeddings of dim 49152
2025-03-09 08:06:33,420 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0230 secs
2025-03-09 08:06:33,420 [INFO]: 	Compute estimated construction time of the index 03/09/2025, 08:06:33
2025-03-09 08:06:33,420 [INFO]: 		-> Train: 16.7 minutes
2025-03-09 08:06:33,420 [INFO]: 		-> Add: 0.8 seconds
2025-03-09 08:06:33,420 [INFO]: 		Total: 16.7 minutes
2025-03-09 08:06:33,420 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0001 secs
2025-03-09 08:06:33,420 [INFO]: 	Checking that your have enough memory available to create the index 03/09/2025, 08:06:33
2025-03-09 08:06:33,420 [INFO]: 297.0MB of memory will be needed to build the index (more might be used if you have more)
2025-03-09 08:06:33,420 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0001 secs
2025-03-09 08:06:33,420 [INFO]: 	Selecting most promising index types given data characteristics 03/09/2025, 08:06:33
2025-03-09 08:06:33,420 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-09 08:06:33,420 [INFO]: 	Creating the index 03/09/2025, 08:06:33
2025-03-09 08:06:33,420 [INFO]: 		-> Instanciate the index HNSW15 03/09/2025, 08:06:33
2025-03-09 08:06:33,421 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0008 secs
2025-03-09 08:06:33,421 [INFO]: 		-> Adding the vectors to the index 03/09/2025, 08:06:33
2025-03-09 08:06:33,421 [INFO]: The memory available for adding the vectors is 49.7GB(total available - used by the index)
2025-03-09 08:06:33,421 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/6 [00:00<?, ?it/s] 17%|█▋        | 1/6 [00:00<00:00,  9.06it/s]100%|██████████| 6/6 [00:01<00:00,  4.72it/s]100%|██████████| 6/6 [00:01<00:00,  4.83it/s]
2025-03-09 08:06:34,666 [INFO]: 	Computing best hyperparameters for index knn.index 03/09/2025, 08:06:34
2025-03-09 08:06:56,256 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 21.5895 secs
2025-03-09 08:06:56,256 [INFO]: The best hyperparameters are: efSearch=236
2025-03-09 08:06:56,256 [INFO]: 	Compute fast metrics 03/09/2025, 08:06:56
  0%|          | 0/4 [00:00<?, ?it/s] 50%|█████     | 2/4 [00:00<00:00, 19.90it/s] 75%|███████▌  | 3/4 [00:00<00:00, 21.35it/s]
2025-03-09 08:07:08,528 [INFO]: 	>>> Finished "Compute fast metrics" in 12.2711 secs
2025-03-09 08:07:08,529 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 35.1076 secs
2025-03-09 08:07:08,529 [INFO]: {
2025-03-09 08:07:08,529 [INFO]: 	index_key: HNSW15
2025-03-09 08:07:08,529 [INFO]: 	index_param: efSearch=236
2025-03-09 08:07:08,529 [INFO]: 	index_path: knn.index
2025-03-09 08:07:08,529 [INFO]: 	size in bytes: 283114690
2025-03-09 08:07:08,529 [INFO]: 	avg_search_speed_ms: 9.372364121926521
2025-03-09 08:07:08,529 [INFO]: 	99p_search_speed_ms: 22.190398564562194
2025-03-09 08:07:08,529 [INFO]: 	reconstruction error %: 0.0
2025-03-09 08:07:08,529 [INFO]: 	nb vectors: 1439
2025-03-09 08:07:08,529 [INFO]: 	vectors dimension: 49152
2025-03-09 08:07:08,529 [INFO]: 	compression ratio: 0.9993084851937566
2025-03-09 08:07:08,529 [INFO]: }
2025-03-09 08:07:08,529 [INFO]: 	>>> Finished "Creating the index" in 35.1089 secs
2025-03-09 08:07:08,529 [INFO]: >>> Finished "Launching the whole pipeline" in 35.1324 secs
2025-03-09 08:07:08: [retrieval_preprocessing] calculating distances ...
2025-03-09 08:07:09: [retrieval_preprocessing] finished and saved retrieval indices for episode 70152 [episode count 6/20]
[retrieval_preprocessing] for episode 80520 [episode count 7/20], we have num_retrieval=np.int64(1405) num_query=np.int64(105)
2025-03-09 08:07:09,219 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-09 08:07:09,397 [INFO]: Launching the whole pipeline 03/09/2025, 08:07:09
2025-03-09 08:07:09,397 [INFO]: Reading total number of vectors and dimension 03/09/2025, 08:07:09
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1169.63it/s]
2025-03-09 08:07:09,422 [INFO]: There are 1405 embeddings of dim 49152
2025-03-09 08:07:09,422 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0253 secs
2025-03-09 08:07:09,422 [INFO]: 	Compute estimated construction time of the index 03/09/2025, 08:07:09
2025-03-09 08:07:09,422 [INFO]: 		-> Train: 16.7 minutes
2025-03-09 08:07:09,422 [INFO]: 		-> Add: 0.8 seconds
2025-03-09 08:07:09,422 [INFO]: 		Total: 16.7 minutes
2025-03-09 08:07:09,422 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0001 secs
2025-03-09 08:07:09,422 [INFO]: 	Checking that your have enough memory available to create the index 03/09/2025, 08:07:09
2025-03-09 08:07:09,423 [INFO]: 290.0MB of memory will be needed to build the index (more might be used if you have more)
2025-03-09 08:07:09,423 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0001 secs
2025-03-09 08:07:09,423 [INFO]: 	Selecting most promising index types given data characteristics 03/09/2025, 08:07:09
2025-03-09 08:07:09,423 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-09 08:07:09,423 [INFO]: 	Creating the index 03/09/2025, 08:07:09
2025-03-09 08:07:09,423 [INFO]: 		-> Instanciate the index HNSW15 03/09/2025, 08:07:09
2025-03-09 08:07:09,424 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0010 secs
2025-03-09 08:07:09,424 [INFO]: 		-> Adding the vectors to the index 03/09/2025, 08:07:09
2025-03-09 08:07:09,424 [INFO]: The memory available for adding the vectors is 49.7GB(total available - used by the index)
2025-03-09 08:07:09,424 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/6 [00:00<?, ?it/s] 33%|███▎      | 2/6 [00:00<00:00, 18.61it/s]100%|██████████| 6/6 [00:01<00:00,  4.43it/s]100%|██████████| 6/6 [00:01<00:00,  4.79it/s]
2025-03-09 08:07:10,679 [INFO]: 	Computing best hyperparameters for index knn.index 03/09/2025, 08:07:10
2025-03-09 08:07:36,420 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 25.7400 secs
2025-03-09 08:07:36,420 [INFO]: The best hyperparameters are: efSearch=215
2025-03-09 08:07:36,420 [INFO]: 	Compute fast metrics 03/09/2025, 08:07:36
  0%|          | 0/4 [00:00<?, ?it/s] 50%|█████     | 2/4 [00:00<00:00, 17.58it/s] 75%|███████▌  | 3/4 [00:00<00:00, 18.50it/s]
2025-03-09 08:07:48,662 [INFO]: 	>>> Finished "Compute fast metrics" in 12.2423 secs
2025-03-09 08:07:48,663 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 39.2395 secs
2025-03-09 08:07:48,664 [INFO]: {
2025-03-09 08:07:48,664 [INFO]: 	index_key: HNSW15
2025-03-09 08:07:48,664 [INFO]: 	index_param: efSearch=215
2025-03-09 08:07:48,664 [INFO]: 	index_path: knn.index
2025-03-09 08:07:48,664 [INFO]: 	size in bytes: 276425350
2025-03-09 08:07:48,664 [INFO]: 	avg_search_speed_ms: 8.917996996347389
2025-03-09 08:07:48,664 [INFO]: 	99p_search_speed_ms: 18.827508715912685
2025-03-09 08:07:48,664 [INFO]: 	reconstruction error %: 0.0
2025-03-09 08:07:48,664 [INFO]: 	nb vectors: 1405
2025-03-09 08:07:48,664 [INFO]: 	vectors dimension: 49152
2025-03-09 08:07:48,664 [INFO]: 	compression ratio: 0.9993086379378736
2025-03-09 08:07:48,664 [INFO]: }
2025-03-09 08:07:48,664 [INFO]: 	>>> Finished "Creating the index" in 39.2411 secs
2025-03-09 08:07:48,664 [INFO]: >>> Finished "Launching the whole pipeline" in 39.2670 secs
2025-03-09 08:07:49: [retrieval_preprocessing] calculating distances ...
2025-03-09 08:07:49: [retrieval_preprocessing] finished and saved retrieval indices for episode 80520 [episode count 7/20]
[retrieval_preprocessing] for episode 94219 [episode count 8/20], we have num_retrieval=np.int64(1447) num_query=np.int64(63)
2025-03-09 08:07:49,563 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-09 08:07:49,751 [INFO]: Launching the whole pipeline 03/09/2025, 08:07:49
2025-03-09 08:07:49,751 [INFO]: Reading total number of vectors and dimension 03/09/2025, 08:07:49
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 2404.99it/s]
2025-03-09 08:07:49,774 [INFO]: There are 1447 embeddings of dim 49152
2025-03-09 08:07:49,774 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0227 secs
2025-03-09 08:07:49,774 [INFO]: 	Compute estimated construction time of the index 03/09/2025, 08:07:49
2025-03-09 08:07:49,774 [INFO]: 		-> Train: 16.7 minutes
2025-03-09 08:07:49,774 [INFO]: 		-> Add: 0.8 seconds
2025-03-09 08:07:49,774 [INFO]: 		Total: 16.7 minutes
2025-03-09 08:07:49,774 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0001 secs
2025-03-09 08:07:49,774 [INFO]: 	Checking that your have enough memory available to create the index 03/09/2025, 08:07:49
2025-03-09 08:07:49,774 [INFO]: 298.6MB of memory will be needed to build the index (more might be used if you have more)
2025-03-09 08:07:49,774 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0001 secs
2025-03-09 08:07:49,774 [INFO]: 	Selecting most promising index types given data characteristics 03/09/2025, 08:07:49
2025-03-09 08:07:49,774 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-09 08:07:49,775 [INFO]: 	Creating the index 03/09/2025, 08:07:49
2025-03-09 08:07:49,775 [INFO]: 		-> Instanciate the index HNSW15 03/09/2025, 08:07:49
2025-03-09 08:07:49,775 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0008 secs
2025-03-09 08:07:49,776 [INFO]: 		-> Adding the vectors to the index 03/09/2025, 08:07:49
2025-03-09 08:07:49,776 [INFO]: The memory available for adding the vectors is 49.7GB(total available - used by the index)
2025-03-09 08:07:49,776 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/6 [00:00<?, ?it/s] 50%|█████     | 3/6 [00:00<00:00, 25.63it/s]100%|██████████| 6/6 [00:01<00:00,  4.11it/s]100%|██████████| 6/6 [00:01<00:00,  4.69it/s]
2025-03-09 08:07:51,059 [INFO]: 	Computing best hyperparameters for index knn.index 03/09/2025, 08:07:51
2025-03-09 08:08:09,825 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 18.7647 secs
2025-03-09 08:08:09,825 [INFO]: The best hyperparameters are: efSearch=257
2025-03-09 08:08:09,825 [INFO]: 	Compute fast metrics 03/09/2025, 08:08:09
  0%|          | 0/4 [00:00<?, ?it/s] 50%|█████     | 2/4 [00:00<00:00, 17.45it/s] 75%|███████▌  | 3/4 [00:00<00:00, 18.51it/s]
2025-03-09 08:08:22,410 [INFO]: 	>>> Finished "Compute fast metrics" in 12.5855 secs
2025-03-09 08:08:22,411 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 32.6358 secs
2025-03-09 08:08:22,412 [INFO]: {
2025-03-09 08:08:22,412 [INFO]: 	index_key: HNSW15
2025-03-09 08:08:22,412 [INFO]: 	index_param: efSearch=257
2025-03-09 08:08:22,412 [INFO]: 	index_path: knn.index
2025-03-09 08:08:22,412 [INFO]: 	size in bytes: 284688610
2025-03-09 08:08:22,412 [INFO]: 	avg_search_speed_ms: 12.362231625064434
2025-03-09 08:08:22,412 [INFO]: 	99p_search_speed_ms: 24.16233591735361
2025-03-09 08:08:22,412 [INFO]: 	reconstruction error %: 0.0
2025-03-09 08:08:22,412 [INFO]: 	nb vectors: 1447
2025-03-09 08:08:22,412 [INFO]: 	vectors dimension: 49152
2025-03-09 08:08:22,412 [INFO]: 	compression ratio: 0.9993085989636186
2025-03-09 08:08:22,412 [INFO]: }
2025-03-09 08:08:22,412 [INFO]: 	>>> Finished "Creating the index" in 32.6372 secs
2025-03-09 08:08:22,412 [INFO]: >>> Finished "Launching the whole pipeline" in 32.6605 secs
2025-03-09 08:08:22: [retrieval_preprocessing] calculating distances ...
2025-03-09 08:08:22: [retrieval_preprocessing] finished and saved retrieval indices for episode 94219 [episode count 8/20]
[retrieval_preprocessing] for episode 28429 [episode count 9/20], we have num_retrieval=np.int64(1429) num_query=np.int64(81)
2025-03-09 08:08:23,115 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-09 08:08:23,831 [INFO]: Launching the whole pipeline 03/09/2025, 08:08:23
2025-03-09 08:08:23,831 [INFO]: Reading total number of vectors and dimension 03/09/2025, 08:08:23
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1577.99it/s]
2025-03-09 08:08:23,855 [INFO]: There are 1429 embeddings of dim 49152
2025-03-09 08:08:23,855 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0240 secs
2025-03-09 08:08:23,855 [INFO]: 	Compute estimated construction time of the index 03/09/2025, 08:08:23
2025-03-09 08:08:23,855 [INFO]: 		-> Train: 16.7 minutes
2025-03-09 08:08:23,856 [INFO]: 		-> Add: 0.8 seconds
2025-03-09 08:08:23,856 [INFO]: 		Total: 16.7 minutes
2025-03-09 08:08:23,856 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0001 secs
2025-03-09 08:08:23,856 [INFO]: 	Checking that your have enough memory available to create the index 03/09/2025, 08:08:23
2025-03-09 08:08:23,856 [INFO]: 294.9MB of memory will be needed to build the index (more might be used if you have more)
2025-03-09 08:08:23,856 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0001 secs
2025-03-09 08:08:23,856 [INFO]: 	Selecting most promising index types given data characteristics 03/09/2025, 08:08:23
2025-03-09 08:08:23,856 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-09 08:08:23,856 [INFO]: 	Creating the index 03/09/2025, 08:08:23
2025-03-09 08:08:23,856 [INFO]: 		-> Instanciate the index HNSW15 03/09/2025, 08:08:23
2025-03-09 08:08:23,857 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0008 secs
2025-03-09 08:08:23,857 [INFO]: 		-> Adding the vectors to the index 03/09/2025, 08:08:23
2025-03-09 08:08:23,857 [INFO]: The memory available for adding the vectors is 49.7GB(total available - used by the index)
2025-03-09 08:08:23,857 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/6 [00:00<?, ?it/s] 17%|█▋        | 1/6 [00:00<00:00,  8.73it/s] 83%|████████▎ | 5/6 [00:00<00:00, 25.14it/s]100%|██████████| 6/6 [00:01<00:00,  4.00it/s]
2025-03-09 08:08:25,362 [INFO]: 	Computing best hyperparameters for index knn.index 03/09/2025, 08:08:25
2025-03-09 08:08:51,009 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 25.6466 secs
2025-03-09 08:08:51,009 [INFO]: The best hyperparameters are: efSearch=223
2025-03-09 08:08:51,009 [INFO]: 	Compute fast metrics 03/09/2025, 08:08:51
  0%|          | 0/4 [00:00<?, ?it/s] 50%|█████     | 2/4 [00:00<00:00, 19.52it/s] 75%|███████▌  | 3/4 [00:00<00:00, 21.13it/s]
2025-03-09 08:09:02,871 [INFO]: 	>>> Finished "Compute fast metrics" in 11.8619 secs
2025-03-09 08:09:02,872 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 39.0153 secs
2025-03-09 08:09:02,872 [INFO]: {
2025-03-09 08:09:02,872 [INFO]: 	index_key: HNSW15
2025-03-09 08:09:02,872 [INFO]: 	index_param: efSearch=223
2025-03-09 08:09:02,872 [INFO]: 	index_path: knn.index
2025-03-09 08:09:02,872 [INFO]: 	size in bytes: 281147170
2025-03-09 08:09:02,872 [INFO]: 	avg_search_speed_ms: 10.474171938072324
2025-03-09 08:09:02,872 [INFO]: 	99p_search_speed_ms: 19.34831640683115
2025-03-09 08:09:02,872 [INFO]: 	reconstruction error %: 0.0
2025-03-09 08:09:02,872 [INFO]: 	nb vectors: 1429
2025-03-09 08:09:02,872 [INFO]: 	vectors dimension: 49152
2025-03-09 08:09:02,872 [INFO]: 	compression ratio: 0.9993087677176334
2025-03-09 08:09:02,872 [INFO]: }
2025-03-09 08:09:02,872 [INFO]: 	>>> Finished "Creating the index" in 39.0165 secs
2025-03-09 08:09:02,872 [INFO]: >>> Finished "Launching the whole pipeline" in 39.0411 secs
2025-03-09 08:09:03: [retrieval_preprocessing] calculating distances ...
2025-03-09 08:09:03: [retrieval_preprocessing] finished and saved retrieval indices for episode 28429 [episode count 9/20]
[retrieval_preprocessing] for episode 75661 [episode count 10/20], we have num_retrieval=np.int64(1427) num_query=np.int64(83)
2025-03-09 08:09:03,503 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-09 08:09:03,686 [INFO]: Launching the whole pipeline 03/09/2025, 08:09:03
2025-03-09 08:09:03,686 [INFO]: Reading total number of vectors and dimension 03/09/2025, 08:09:03
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1800.13it/s]
2025-03-09 08:09:03,714 [INFO]: There are 1427 embeddings of dim 49152
2025-03-09 08:09:03,714 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0279 secs
2025-03-09 08:09:03,714 [INFO]: 	Compute estimated construction time of the index 03/09/2025, 08:09:03
2025-03-09 08:09:03,715 [INFO]: 		-> Train: 16.7 minutes
2025-03-09 08:09:03,715 [INFO]: 		-> Add: 0.8 seconds
2025-03-09 08:09:03,715 [INFO]: 		Total: 16.7 minutes
2025-03-09 08:09:03,715 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0005 secs
2025-03-09 08:09:03,715 [INFO]: 	Checking that your have enough memory available to create the index 03/09/2025, 08:09:03
2025-03-09 08:09:03,715 [INFO]: 294.5MB of memory will be needed to build the index (more might be used if you have more)
2025-03-09 08:09:03,716 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0004 secs
2025-03-09 08:09:03,716 [INFO]: 	Selecting most promising index types given data characteristics 03/09/2025, 08:09:03
2025-03-09 08:09:03,716 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-09 08:09:03,716 [INFO]: 	Creating the index 03/09/2025, 08:09:03
2025-03-09 08:09:03,716 [INFO]: 		-> Instanciate the index HNSW15 03/09/2025, 08:09:03
2025-03-09 08:09:03,719 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0025 secs
2025-03-09 08:09:03,719 [INFO]: 		-> Adding the vectors to the index 03/09/2025, 08:09:03
2025-03-09 08:09:03,719 [INFO]: The memory available for adding the vectors is 49.7GB(total available - used by the index)
2025-03-09 08:09:03,719 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/6 [00:00<?, ?it/s] 50%|█████     | 3/6 [00:00<00:00, 26.01it/s]100%|██████████| 6/6 [00:01<00:00,  4.76it/s]100%|██████████| 6/6 [00:01<00:00,  5.42it/s]
2025-03-09 08:09:04,831 [INFO]: 	Computing best hyperparameters for index knn.index 03/09/2025, 08:09:04
2025-03-09 08:09:26,800 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 21.9684 secs
2025-03-09 08:09:26,800 [INFO]: The best hyperparameters are: efSearch=247
2025-03-09 08:09:26,800 [INFO]: 	Compute fast metrics 03/09/2025, 08:09:26
  0%|          | 0/4 [00:00<?, ?it/s] 50%|█████     | 2/4 [00:00<00:00, 17.79it/s] 75%|███████▌  | 3/4 [00:00<00:00, 18.90it/s]
2025-03-09 08:09:41,396 [INFO]: 	>>> Finished "Compute fast metrics" in 14.5958 secs
2025-03-09 08:09:42,103 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 38.3838 secs
2025-03-09 08:09:42,103 [INFO]: {
2025-03-09 08:09:42,103 [INFO]: 	index_key: HNSW15
2025-03-09 08:09:42,103 [INFO]: 	index_param: efSearch=247
2025-03-09 08:09:42,104 [INFO]: 	index_path: knn.index
2025-03-09 08:09:42,104 [INFO]: 	size in bytes: 280753690
2025-03-09 08:09:42,104 [INFO]: 	avg_search_speed_ms: 9.118883930606836
2025-03-09 08:09:42,104 [INFO]: 	99p_search_speed_ms: 16.50157989002764
2025-03-09 08:09:42,104 [INFO]: 	reconstruction error %: 0.0
2025-03-09 08:09:42,104 [INFO]: 	nb vectors: 1427
2025-03-09 08:09:42,104 [INFO]: 	vectors dimension: 49152
2025-03-09 08:09:42,104 [INFO]: 	compression ratio: 0.9993087392724919
2025-03-09 08:09:42,104 [INFO]: }
2025-03-09 08:09:42,104 [INFO]: 	>>> Finished "Creating the index" in 38.3881 secs
2025-03-09 08:09:42,104 [INFO]: >>> Finished "Launching the whole pipeline" in 38.4181 secs
2025-03-09 08:09:42: [retrieval_preprocessing] calculating distances ...
2025-03-09 08:09:42: [retrieval_preprocessing] finished and saved retrieval indices for episode 75661 [episode count 10/20]
[retrieval_preprocessing] for episode 2447 [episode count 11/20], we have num_retrieval=np.int64(1452) num_query=np.int64(58)
2025-03-09 08:09:42,732 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-09 08:09:42,893 [INFO]: Launching the whole pipeline 03/09/2025, 08:09:42
2025-03-09 08:09:42,893 [INFO]: Reading total number of vectors and dimension 03/09/2025, 08:09:42
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 2372.34it/s]
2025-03-09 08:09:42,915 [INFO]: There are 1452 embeddings of dim 49152
2025-03-09 08:09:42,916 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0220 secs
2025-03-09 08:09:42,916 [INFO]: 	Compute estimated construction time of the index 03/09/2025, 08:09:42
2025-03-09 08:09:42,916 [INFO]: 		-> Train: 16.7 minutes
2025-03-09 08:09:42,916 [INFO]: 		-> Add: 0.8 seconds
2025-03-09 08:09:42,916 [INFO]: 		Total: 16.7 minutes
2025-03-09 08:09:42,916 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0001 secs
2025-03-09 08:09:42,916 [INFO]: 	Checking that your have enough memory available to create the index 03/09/2025, 08:09:42
2025-03-09 08:09:42,916 [INFO]: 299.7MB of memory will be needed to build the index (more might be used if you have more)
2025-03-09 08:09:42,916 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0002 secs
2025-03-09 08:09:42,916 [INFO]: 	Selecting most promising index types given data characteristics 03/09/2025, 08:09:42
2025-03-09 08:09:42,916 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-09 08:09:42,916 [INFO]: 	Creating the index 03/09/2025, 08:09:42
2025-03-09 08:09:42,916 [INFO]: 		-> Instanciate the index HNSW15 03/09/2025, 08:09:42
2025-03-09 08:09:42,917 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0010 secs
2025-03-09 08:09:42,917 [INFO]: 		-> Adding the vectors to the index 03/09/2025, 08:09:42
2025-03-09 08:09:42,917 [INFO]: The memory available for adding the vectors is 49.7GB(total available - used by the index)
2025-03-09 08:09:42,917 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/6 [00:00<?, ?it/s] 33%|███▎      | 2/6 [00:00<00:00, 17.31it/s]100%|██████████| 6/6 [00:01<00:00,  5.22it/s]100%|██████████| 6/6 [00:01<00:00,  5.60it/s]
2025-03-09 08:09:43,993 [INFO]: 	Computing best hyperparameters for index knn.index 03/09/2025, 08:09:43
2025-03-09 08:10:02,613 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 18.6196 secs
2025-03-09 08:10:02,613 [INFO]: The best hyperparameters are: efSearch=239
2025-03-09 08:10:02,613 [INFO]: 	Compute fast metrics 03/09/2025, 08:10:02
  0%|          | 0/4 [00:00<?, ?it/s] 50%|█████     | 2/4 [00:00<00:00, 16.14it/s] 75%|███████▌  | 3/4 [00:00<00:00, 17.34it/s]
2025-03-09 08:10:14,248 [INFO]: 	>>> Finished "Compute fast metrics" in 11.6345 secs
2025-03-09 08:10:14,249 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 31.3318 secs
2025-03-09 08:10:14,249 [INFO]: {
2025-03-09 08:10:14,249 [INFO]: 	index_key: HNSW15
2025-03-09 08:10:14,249 [INFO]: 	index_param: efSearch=239
2025-03-09 08:10:14,249 [INFO]: 	index_path: knn.index
2025-03-09 08:10:14,249 [INFO]: 	size in bytes: 285672310
2025-03-09 08:10:14,249 [INFO]: 	avg_search_speed_ms: 11.631118633979282
2025-03-09 08:10:14,249 [INFO]: 	99p_search_speed_ms: 20.16312065767124
2025-03-09 08:10:14,249 [INFO]: 	reconstruction error %: 0.0
2025-03-09 08:10:14,249 [INFO]: 	nb vectors: 1452
2025-03-09 08:10:14,249 [INFO]: 	vectors dimension: 49152
2025-03-09 08:10:14,249 [INFO]: 	compression ratio: 0.9993086694331698
2025-03-09 08:10:14,249 [INFO]: }
2025-03-09 08:10:14,249 [INFO]: 	>>> Finished "Creating the index" in 31.3332 secs
2025-03-09 08:10:14,249 [INFO]: >>> Finished "Launching the whole pipeline" in 31.3558 secs
2025-03-09 08:10:14: [retrieval_preprocessing] calculating distances ...
2025-03-09 08:10:14: [retrieval_preprocessing] finished and saved retrieval indices for episode 2447 [episode count 11/20]
[retrieval_preprocessing] for episode 94857 [episode count 12/20], we have num_retrieval=np.int64(1424) num_query=np.int64(86)
2025-03-09 08:10:14,817 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-09 08:10:15,012 [INFO]: Launching the whole pipeline 03/09/2025, 08:10:15
2025-03-09 08:10:15,012 [INFO]: Reading total number of vectors and dimension 03/09/2025, 08:10:15
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 2181.13it/s]
2025-03-09 08:10:15,036 [INFO]: There are 1424 embeddings of dim 49152
2025-03-09 08:10:15,037 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0241 secs
2025-03-09 08:10:15,037 [INFO]: 	Compute estimated construction time of the index 03/09/2025, 08:10:15
2025-03-09 08:10:15,037 [INFO]: 		-> Train: 16.7 minutes
2025-03-09 08:10:15,037 [INFO]: 		-> Add: 0.8 seconds
2025-03-09 08:10:15,037 [INFO]: 		Total: 16.7 minutes
2025-03-09 08:10:15,037 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0001 secs
2025-03-09 08:10:15,037 [INFO]: 	Checking that your have enough memory available to create the index 03/09/2025, 08:10:15
2025-03-09 08:10:15,037 [INFO]: 293.9MB of memory will be needed to build the index (more might be used if you have more)
2025-03-09 08:10:15,037 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0001 secs
2025-03-09 08:10:15,037 [INFO]: 	Selecting most promising index types given data characteristics 03/09/2025, 08:10:15
2025-03-09 08:10:15,037 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-09 08:10:15,037 [INFO]: 	Creating the index 03/09/2025, 08:10:15
2025-03-09 08:10:15,037 [INFO]: 		-> Instanciate the index HNSW15 03/09/2025, 08:10:15
2025-03-09 08:10:15,038 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0009 secs
2025-03-09 08:10:15,038 [INFO]: 		-> Adding the vectors to the index 03/09/2025, 08:10:15
2025-03-09 08:10:15,038 [INFO]: The memory available for adding the vectors is 49.7GB(total available - used by the index)
2025-03-09 08:10:15,038 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/6 [00:00<?, ?it/s] 33%|███▎      | 2/6 [00:00<00:00, 18.47it/s]100%|██████████| 6/6 [00:01<00:00,  5.02it/s]100%|██████████| 6/6 [00:01<00:00,  5.40it/s]
2025-03-09 08:10:16,152 [INFO]: 	Computing best hyperparameters for index knn.index 03/09/2025, 08:10:16
2025-03-09 08:10:34,338 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 18.1862 secs
2025-03-09 08:10:34,338 [INFO]: The best hyperparameters are: efSearch=249
2025-03-09 08:10:34,339 [INFO]: 	Compute fast metrics 03/09/2025, 08:10:34
  0%|          | 0/4 [00:00<?, ?it/s] 50%|█████     | 2/4 [00:00<00:00, 18.32it/s] 75%|███████▌  | 3/4 [00:00<00:00, 19.90it/s]
2025-03-09 08:10:47,769 [INFO]: 	>>> Finished "Compute fast metrics" in 13.4303 secs
2025-03-09 08:10:47,770 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 32.7323 secs
2025-03-09 08:10:47,771 [INFO]: {
2025-03-09 08:10:47,771 [INFO]: 	index_key: HNSW15
2025-03-09 08:10:47,771 [INFO]: 	index_param: efSearch=249
2025-03-09 08:10:47,771 [INFO]: 	index_path: knn.index
2025-03-09 08:10:47,771 [INFO]: 	size in bytes: 280163410
2025-03-09 08:10:47,771 [INFO]: 	avg_search_speed_ms: 9.98060027218262
2025-03-09 08:10:47,771 [INFO]: 	99p_search_speed_ms: 22.674449521582574
2025-03-09 08:10:47,771 [INFO]: 	reconstruction error %: 0.0
2025-03-09 08:10:47,771 [INFO]: 	nb vectors: 1424
2025-03-09 08:10:47,771 [INFO]: 	vectors dimension: 49152
2025-03-09 08:10:47,771 [INFO]: 	compression ratio: 0.9993089104676446
2025-03-09 08:10:47,771 [INFO]: }
2025-03-09 08:10:47,771 [INFO]: 	>>> Finished "Creating the index" in 32.7336 secs
2025-03-09 08:10:47,771 [INFO]: >>> Finished "Launching the whole pipeline" in 32.7584 secs
2025-03-09 08:10:49: [retrieval_preprocessing] calculating distances ...
2025-03-09 08:10:49: [retrieval_preprocessing] finished and saved retrieval indices for episode 94857 [episode count 12/20]
[retrieval_preprocessing] for episode 35217 [episode count 13/20], we have num_retrieval=np.int64(1449) num_query=np.int64(61)
2025-03-09 08:10:49,533 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-09 08:10:49,771 [INFO]: Launching the whole pipeline 03/09/2025, 08:10:49
2025-03-09 08:10:49,771 [INFO]: Reading total number of vectors and dimension 03/09/2025, 08:10:49
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1145.36it/s]
2025-03-09 08:10:49,798 [INFO]: There are 1449 embeddings of dim 49152
2025-03-09 08:10:49,798 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0265 secs
2025-03-09 08:10:49,798 [INFO]: 	Compute estimated construction time of the index 03/09/2025, 08:10:49
2025-03-09 08:10:49,798 [INFO]: 		-> Train: 16.7 minutes
2025-03-09 08:10:49,798 [INFO]: 		-> Add: 0.8 seconds
2025-03-09 08:10:49,798 [INFO]: 		Total: 16.7 minutes
2025-03-09 08:10:49,798 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0002 secs
2025-03-09 08:10:49,798 [INFO]: 	Checking that your have enough memory available to create the index 03/09/2025, 08:10:49
2025-03-09 08:10:49,798 [INFO]: 299.0MB of memory will be needed to build the index (more might be used if you have more)
2025-03-09 08:10:49,798 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0001 secs
2025-03-09 08:10:49,798 [INFO]: 	Selecting most promising index types given data characteristics 03/09/2025, 08:10:49
2025-03-09 08:10:49,798 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-09 08:10:49,798 [INFO]: 	Creating the index 03/09/2025, 08:10:49
2025-03-09 08:10:49,798 [INFO]: 		-> Instanciate the index HNSW15 03/09/2025, 08:10:49
2025-03-09 08:10:49,799 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0010 secs
2025-03-09 08:10:49,800 [INFO]: 		-> Adding the vectors to the index 03/09/2025, 08:10:49
2025-03-09 08:10:49,800 [INFO]: The memory available for adding the vectors is 49.7GB(total available - used by the index)
2025-03-09 08:10:49,800 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/6 [00:00<?, ?it/s] 50%|█████     | 3/6 [00:00<00:00, 29.58it/s]100%|██████████| 6/6 [00:01<00:00,  4.54it/s]100%|██████████| 6/6 [00:01<00:00,  5.19it/s]
2025-03-09 08:10:50,959 [INFO]: 	Computing best hyperparameters for index knn.index 03/09/2025, 08:10:50
2025-03-09 08:11:09,702 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 18.7415 secs
2025-03-09 08:11:09,702 [INFO]: The best hyperparameters are: efSearch=254
2025-03-09 08:11:09,702 [INFO]: 	Compute fast metrics 03/09/2025, 08:11:09
  0%|          | 0/4 [00:00<?, ?it/s] 50%|█████     | 2/4 [00:00<00:00, 18.30it/s] 75%|███████▌  | 3/4 [00:00<00:00, 16.60it/s]
2025-03-09 08:11:24,495 [INFO]: 	>>> Finished "Compute fast metrics" in 14.7933 secs
2025-03-09 08:11:24,497 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 34.6968 secs
2025-03-09 08:11:24,497 [INFO]: {
2025-03-09 08:11:24,497 [INFO]: 	index_key: HNSW15
2025-03-09 08:11:24,497 [INFO]: 	index_param: efSearch=254
2025-03-09 08:11:24,497 [INFO]: 	index_path: knn.index
2025-03-09 08:11:24,497 [INFO]: 	size in bytes: 285082090
2025-03-09 08:11:24,497 [INFO]: 	avg_search_speed_ms: 9.72663197780446
2025-03-09 08:11:24,497 [INFO]: 	99p_search_speed_ms: 22.04707038588822
2025-03-09 08:11:24,497 [INFO]: 	reconstruction error %: 0.0
2025-03-09 08:11:24,497 [INFO]: 	nb vectors: 1449
2025-03-09 08:11:24,497 [INFO]: 	vectors dimension: 49152
2025-03-09 08:11:24,497 [INFO]: 	compression ratio: 0.9993086272097977
2025-03-09 08:11:24,497 [INFO]: }
2025-03-09 08:11:24,497 [INFO]: 	>>> Finished "Creating the index" in 34.6984 secs
2025-03-09 08:11:24,497 [INFO]: >>> Finished "Launching the whole pipeline" in 34.7257 secs
2025-03-09 08:11:24: [retrieval_preprocessing] calculating distances ...
2025-03-09 08:11:24: [retrieval_preprocessing] finished and saved retrieval indices for episode 35217 [episode count 13/20]
[retrieval_preprocessing] for episode 73874 [episode count 14/20], we have num_retrieval=np.int64(1431) num_query=np.int64(79)
2025-03-09 08:11:25,041 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-09 08:11:25,229 [INFO]: Launching the whole pipeline 03/09/2025, 08:11:25
2025-03-09 08:11:25,229 [INFO]: Reading total number of vectors and dimension 03/09/2025, 08:11:25
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1955.39it/s]
2025-03-09 08:11:25,255 [INFO]: There are 1431 embeddings of dim 49152
2025-03-09 08:11:25,256 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0267 secs
2025-03-09 08:11:25,256 [INFO]: 	Compute estimated construction time of the index 03/09/2025, 08:11:25
2025-03-09 08:11:25,256 [INFO]: 		-> Train: 16.7 minutes
2025-03-09 08:11:25,256 [INFO]: 		-> Add: 0.8 seconds
2025-03-09 08:11:25,256 [INFO]: 		Total: 16.7 minutes
2025-03-09 08:11:25,256 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0001 secs
2025-03-09 08:11:25,256 [INFO]: 	Checking that your have enough memory available to create the index 03/09/2025, 08:11:25
2025-03-09 08:11:25,256 [INFO]: 295.3MB of memory will be needed to build the index (more might be used if you have more)
2025-03-09 08:11:25,256 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0001 secs
2025-03-09 08:11:25,256 [INFO]: 	Selecting most promising index types given data characteristics 03/09/2025, 08:11:25
2025-03-09 08:11:25,256 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-09 08:11:25,256 [INFO]: 	Creating the index 03/09/2025, 08:11:25
2025-03-09 08:11:25,256 [INFO]: 		-> Instanciate the index HNSW15 03/09/2025, 08:11:25
2025-03-09 08:11:25,257 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0011 secs
2025-03-09 08:11:25,257 [INFO]: 		-> Adding the vectors to the index 03/09/2025, 08:11:25
2025-03-09 08:11:25,257 [INFO]: The memory available for adding the vectors is 49.7GB(total available - used by the index)
2025-03-09 08:11:25,257 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/6 [00:00<?, ?it/s] 33%|███▎      | 2/6 [00:00<00:00, 18.76it/s]100%|██████████| 6/6 [00:01<00:00,  4.49it/s]100%|██████████| 6/6 [00:01<00:00,  4.86it/s]
2025-03-09 08:11:26,496 [INFO]: 	Computing best hyperparameters for index knn.index 03/09/2025, 08:11:26
2025-03-09 08:11:46,112 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 19.6157 secs
2025-03-09 08:11:46,112 [INFO]: The best hyperparameters are: efSearch=96
2025-03-09 08:11:46,112 [INFO]: 	Compute fast metrics 03/09/2025, 08:11:46
  0%|          | 0/4 [00:00<?, ?it/s] 50%|█████     | 2/4 [00:00<00:00, 18.30it/s] 75%|███████▌  | 3/4 [00:00<00:00, 20.21it/s]
2025-03-09 08:11:58,820 [INFO]: 	>>> Finished "Compute fast metrics" in 12.7079 secs
2025-03-09 08:11:58,822 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 33.5648 secs
2025-03-09 08:11:58,823 [INFO]: {
2025-03-09 08:11:58,823 [INFO]: 	index_key: HNSW15
2025-03-09 08:11:58,823 [INFO]: 	index_param: efSearch=96
2025-03-09 08:11:58,823 [INFO]: 	index_path: knn.index
2025-03-09 08:11:58,823 [INFO]: 	size in bytes: 281540650
2025-03-09 08:11:58,823 [INFO]: 	avg_search_speed_ms: 5.156606340674225
2025-03-09 08:11:58,823 [INFO]: 	99p_search_speed_ms: 8.267488488927482
2025-03-09 08:11:58,823 [INFO]: 	reconstruction error %: 0.0
2025-03-09 08:11:58,823 [INFO]: 	nb vectors: 1431
2025-03-09 08:11:58,823 [INFO]: 	vectors dimension: 49152
2025-03-09 08:11:58,823 [INFO]: 	compression ratio: 0.9993087960832654
2025-03-09 08:11:58,823 [INFO]: }
2025-03-09 08:11:58,823 [INFO]: 	>>> Finished "Creating the index" in 33.5667 secs
2025-03-09 08:11:58,823 [INFO]: >>> Finished "Launching the whole pipeline" in 33.5941 secs
2025-03-09 08:11:58: [retrieval_preprocessing] calculating distances ...
2025-03-09 08:11:59: [retrieval_preprocessing] finished and saved retrieval indices for episode 73874 [episode count 14/20]
[retrieval_preprocessing] for episode 57620 [episode count 15/20], we have num_retrieval=np.int64(1424) num_query=np.int64(86)
2025-03-09 08:11:59,643 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-09 08:11:59,830 [INFO]: Launching the whole pipeline 03/09/2025, 08:11:59
2025-03-09 08:11:59,830 [INFO]: Reading total number of vectors and dimension 03/09/2025, 08:11:59
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1361.79it/s]
2025-03-09 08:11:59,860 [INFO]: There are 1424 embeddings of dim 49152
2025-03-09 08:11:59,861 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0308 secs
2025-03-09 08:11:59,861 [INFO]: 	Compute estimated construction time of the index 03/09/2025, 08:11:59
2025-03-09 08:11:59,861 [INFO]: 		-> Train: 16.7 minutes
2025-03-09 08:11:59,861 [INFO]: 		-> Add: 0.8 seconds
2025-03-09 08:11:59,861 [INFO]: 		Total: 16.7 minutes
2025-03-09 08:11:59,861 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0002 secs
2025-03-09 08:11:59,861 [INFO]: 	Checking that your have enough memory available to create the index 03/09/2025, 08:11:59
2025-03-09 08:11:59,861 [INFO]: 293.9MB of memory will be needed to build the index (more might be used if you have more)
2025-03-09 08:11:59,861 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0002 secs
2025-03-09 08:11:59,861 [INFO]: 	Selecting most promising index types given data characteristics 03/09/2025, 08:11:59
2025-03-09 08:11:59,861 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-09 08:11:59,861 [INFO]: 	Creating the index 03/09/2025, 08:11:59
2025-03-09 08:11:59,861 [INFO]: 		-> Instanciate the index HNSW15 03/09/2025, 08:11:59
2025-03-09 08:11:59,863 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0014 secs
2025-03-09 08:11:59,863 [INFO]: 		-> Adding the vectors to the index 03/09/2025, 08:11:59
2025-03-09 08:11:59,863 [INFO]: The memory available for adding the vectors is 49.7GB(total available - used by the index)
2025-03-09 08:11:59,863 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/6 [00:00<?, ?it/s] 17%|█▋        | 1/6 [00:00<00:00,  6.49it/s] 50%|█████     | 3/6 [00:00<00:00, 10.15it/s] 83%|████████▎ | 5/6 [00:00<00:00, 11.27it/s]100%|██████████| 6/6 [00:01<00:00,  3.91it/s]
2025-03-09 08:12:01,401 [INFO]: 	Computing best hyperparameters for index knn.index 03/09/2025, 08:12:01
2025-03-09 08:12:23,800 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 22.3986 secs
2025-03-09 08:12:23,801 [INFO]: The best hyperparameters are: efSearch=320
2025-03-09 08:12:23,801 [INFO]: 	Compute fast metrics 03/09/2025, 08:12:23
  0%|          | 0/4 [00:00<?, ?it/s] 25%|██▌       | 1/4 [00:00<00:00,  5.42it/s] 50%|█████     | 2/4 [00:00<00:00,  6.99it/s] 75%|███████▌  | 3/4 [00:00<00:00,  7.69it/s] 75%|███████▌  | 3/4 [00:00<00:00,  5.78it/s]
2025-03-09 08:12:38,467 [INFO]: 	>>> Finished "Compute fast metrics" in 14.6658 secs
2025-03-09 08:12:38,468 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 38.6051 secs
2025-03-09 08:12:38,468 [INFO]: {
2025-03-09 08:12:38,468 [INFO]: 	index_key: HNSW15
2025-03-09 08:12:38,468 [INFO]: 	index_param: efSearch=320
2025-03-09 08:12:38,468 [INFO]: 	index_path: knn.index
2025-03-09 08:12:38,468 [INFO]: 	size in bytes: 280163410
2025-03-09 08:12:38,468 [INFO]: 	avg_search_speed_ms: 11.548880603020327
2025-03-09 08:12:38,468 [INFO]: 	99p_search_speed_ms: 21.292536938563
2025-03-09 08:12:38,469 [INFO]: 	reconstruction error %: 0.0
2025-03-09 08:12:38,469 [INFO]: 	nb vectors: 1424
2025-03-09 08:12:38,469 [INFO]: 	vectors dimension: 49152
2025-03-09 08:12:38,469 [INFO]: 	compression ratio: 0.9993089104676446
2025-03-09 08:12:38,469 [INFO]: }
2025-03-09 08:12:38,469 [INFO]: 	>>> Finished "Creating the index" in 38.6073 secs
2025-03-09 08:12:38,469 [INFO]: >>> Finished "Launching the whole pipeline" in 38.6389 secs
2025-03-09 08:12:39: [retrieval_preprocessing] calculating distances ...
2025-03-09 08:12:39: [retrieval_preprocessing] finished and saved retrieval indices for episode 57620 [episode count 15/20]
[retrieval_preprocessing] for episode 16278 [episode count 16/20], we have num_retrieval=np.int64(1390) num_query=np.int64(120)
2025-03-09 08:12:40,080 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-09 08:12:40,335 [INFO]: Launching the whole pipeline 03/09/2025, 08:12:40
2025-03-09 08:12:40,335 [INFO]: Reading total number of vectors and dimension 03/09/2025, 08:12:40
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1187.52it/s]
2025-03-09 08:12:40,363 [INFO]: There are 1390 embeddings of dim 49152
2025-03-09 08:12:40,364 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0287 secs
2025-03-09 08:12:40,364 [INFO]: 	Compute estimated construction time of the index 03/09/2025, 08:12:40
2025-03-09 08:12:40,364 [INFO]: 		-> Train: 16.7 minutes
2025-03-09 08:12:40,364 [INFO]: 		-> Add: 0.8 seconds
2025-03-09 08:12:40,364 [INFO]: 		Total: 16.7 minutes
2025-03-09 08:12:40,364 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0001 secs
2025-03-09 08:12:40,364 [INFO]: 	Checking that your have enough memory available to create the index 03/09/2025, 08:12:40
2025-03-09 08:12:40,364 [INFO]: 286.9MB of memory will be needed to build the index (more might be used if you have more)
2025-03-09 08:12:40,364 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0002 secs
2025-03-09 08:12:40,364 [INFO]: 	Selecting most promising index types given data characteristics 03/09/2025, 08:12:40
2025-03-09 08:12:40,364 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-09 08:12:40,364 [INFO]: 	Creating the index 03/09/2025, 08:12:40
2025-03-09 08:12:40,364 [INFO]: 		-> Instanciate the index HNSW15 03/09/2025, 08:12:40
2025-03-09 08:12:40,365 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0010 secs
2025-03-09 08:12:40,365 [INFO]: 		-> Adding the vectors to the index 03/09/2025, 08:12:40
2025-03-09 08:12:40,366 [INFO]: The memory available for adding the vectors is 49.7GB(total available - used by the index)
2025-03-09 08:12:40,366 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/6 [00:00<?, ?it/s] 17%|█▋        | 1/6 [00:00<00:00,  5.05it/s] 33%|███▎      | 2/6 [00:00<00:00,  6.81it/s] 50%|█████     | 3/6 [00:00<00:00,  7.52it/s] 67%|██████▋   | 4/6 [00:00<00:00,  7.88it/s] 83%|████████▎ | 5/6 [00:00<00:00,  8.08it/s]100%|██████████| 6/6 [00:01<00:00,  2.22it/s]100%|██████████| 6/6 [00:01<00:00,  3.43it/s]
2025-03-09 08:12:42,116 [INFO]: 	Computing best hyperparameters for index knn.index 03/09/2025, 08:12:42
2025-03-09 08:13:05,105 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 22.9878 secs
2025-03-09 08:13:05,105 [INFO]: The best hyperparameters are: efSearch=217
2025-03-09 08:13:05,106 [INFO]: 	Compute fast metrics 03/09/2025, 08:13:05
  0%|          | 0/4 [00:00<?, ?it/s] 25%|██▌       | 1/4 [00:00<00:00,  5.86it/s] 75%|███████▌  | 3/4 [00:00<00:00,  7.20it/s] 75%|███████▌  | 3/4 [00:00<00:00,  4.86it/s]
2025-03-09 08:13:18,617 [INFO]: 	>>> Finished "Compute fast metrics" in 13.5108 secs
2025-03-09 08:13:18,618 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 38.2525 secs
2025-03-09 08:13:18,618 [INFO]: {
2025-03-09 08:13:18,618 [INFO]: 	index_key: HNSW15
2025-03-09 08:13:18,618 [INFO]: 	index_param: efSearch=217
2025-03-09 08:13:18,618 [INFO]: 	index_path: knn.index
2025-03-09 08:13:18,618 [INFO]: 	size in bytes: 273474070
2025-03-09 08:13:18,618 [INFO]: 	avg_search_speed_ms: 9.636883245940771
2025-03-09 08:13:18,618 [INFO]: 	99p_search_speed_ms: 19.08155877608802
2025-03-09 08:13:18,618 [INFO]: 	reconstruction error %: 0.0
2025-03-09 08:13:18,618 [INFO]: 	nb vectors: 1390
2025-03-09 08:13:18,618 [INFO]: 	vectors dimension: 49152
2025-03-09 08:13:18,618 [INFO]: 	compression ratio: 0.9993090752626017
2025-03-09 08:13:18,618 [INFO]: }
2025-03-09 08:13:18,618 [INFO]: 	>>> Finished "Creating the index" in 38.2540 secs
2025-03-09 08:13:18,618 [INFO]: >>> Finished "Launching the whole pipeline" in 38.2834 secs
2025-03-09 08:13:19: [retrieval_preprocessing] calculating distances ...
2025-03-09 08:13:19: [retrieval_preprocessing] finished and saved retrieval indices for episode 16278 [episode count 16/20]
[retrieval_preprocessing] for episode 76695 [episode count 17/20], we have num_retrieval=np.int64(1447) num_query=np.int64(63)
2025-03-09 08:13:19,874 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-09 08:13:20,067 [INFO]: Launching the whole pipeline 03/09/2025, 08:13:20
2025-03-09 08:13:20,067 [INFO]: Reading total number of vectors and dimension 03/09/2025, 08:13:20
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1262.96it/s]
2025-03-09 08:13:20,096 [INFO]: There are 1447 embeddings of dim 49152
2025-03-09 08:13:20,096 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0288 secs
2025-03-09 08:13:20,096 [INFO]: 	Compute estimated construction time of the index 03/09/2025, 08:13:20
2025-03-09 08:13:20,097 [INFO]: 		-> Train: 16.7 minutes
2025-03-09 08:13:20,097 [INFO]: 		-> Add: 0.8 seconds
2025-03-09 08:13:20,097 [INFO]: 		Total: 16.7 minutes
2025-03-09 08:13:20,097 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0004 secs
2025-03-09 08:13:20,097 [INFO]: 	Checking that your have enough memory available to create the index 03/09/2025, 08:13:20
2025-03-09 08:13:20,097 [INFO]: 298.6MB of memory will be needed to build the index (more might be used if you have more)
2025-03-09 08:13:20,097 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0004 secs
2025-03-09 08:13:20,098 [INFO]: 	Selecting most promising index types given data characteristics 03/09/2025, 08:13:20
2025-03-09 08:13:20,098 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-09 08:13:20,098 [INFO]: 	Creating the index 03/09/2025, 08:13:20
2025-03-09 08:13:20,098 [INFO]: 		-> Instanciate the index HNSW15 03/09/2025, 08:13:20
2025-03-09 08:13:20,101 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0029 secs
2025-03-09 08:13:20,101 [INFO]: 		-> Adding the vectors to the index 03/09/2025, 08:13:20
2025-03-09 08:13:20,101 [INFO]: The memory available for adding the vectors is 49.7GB(total available - used by the index)
2025-03-09 08:13:20,102 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/6 [00:00<?, ?it/s] 17%|█▋        | 1/6 [00:00<00:00,  5.92it/s] 33%|███▎      | 2/6 [00:00<00:00,  7.68it/s] 67%|██████▋   | 4/6 [00:00<00:00,  8.95it/s] 83%|████████▎ | 5/6 [00:00<00:00,  9.16it/s]100%|██████████| 6/6 [00:01<00:00,  2.13it/s]100%|██████████| 6/6 [00:01<00:00,  3.22it/s]
2025-03-09 08:13:21,978 [INFO]: 	Computing best hyperparameters for index knn.index 03/09/2025, 08:13:21
2025-03-09 08:13:41,592 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 19.6137 secs
2025-03-09 08:13:41,593 [INFO]: The best hyperparameters are: efSearch=275
2025-03-09 08:13:41,593 [INFO]: 	Compute fast metrics 03/09/2025, 08:13:41
  0%|          | 0/4 [00:00<?, ?it/s] 25%|██▌       | 1/4 [00:00<00:00,  5.30it/s] 50%|█████     | 2/4 [00:00<00:00,  7.01it/s] 75%|███████▌  | 3/4 [00:00<00:00,  7.72it/s] 75%|███████▌  | 3/4 [00:00<00:00,  5.80it/s]
2025-03-09 08:13:56,025 [INFO]: 	>>> Finished "Compute fast metrics" in 14.4318 secs
2025-03-09 08:13:56,026 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 35.9249 secs
2025-03-09 08:13:56,026 [INFO]: {
2025-03-09 08:13:56,026 [INFO]: 	index_key: HNSW15
2025-03-09 08:13:56,026 [INFO]: 	index_param: efSearch=275
2025-03-09 08:13:56,026 [INFO]: 	index_path: knn.index
2025-03-09 08:13:56,026 [INFO]: 	size in bytes: 284688610
2025-03-09 08:13:56,026 [INFO]: 	avg_search_speed_ms: 11.897664241698724
2025-03-09 08:13:56,026 [INFO]: 	99p_search_speed_ms: 20.127322571352128
2025-03-09 08:13:56,026 [INFO]: 	reconstruction error %: 0.0
2025-03-09 08:13:56,026 [INFO]: 	nb vectors: 1447
2025-03-09 08:13:56,026 [INFO]: 	vectors dimension: 49152
2025-03-09 08:13:56,026 [INFO]: 	compression ratio: 0.9993085989636186
2025-03-09 08:13:56,026 [INFO]: }
2025-03-09 08:13:56,026 [INFO]: 	>>> Finished "Creating the index" in 35.9286 secs
2025-03-09 08:13:56,026 [INFO]: >>> Finished "Launching the whole pipeline" in 35.9591 secs
2025-03-09 08:13:56: [retrieval_preprocessing] calculating distances ...
2025-03-09 08:13:56: [retrieval_preprocessing] finished and saved retrieval indices for episode 76695 [episode count 17/20]
[retrieval_preprocessing] for episode 31004 [episode count 18/20], we have num_retrieval=np.int64(1447) num_query=np.int64(63)
2025-03-09 08:13:57,499 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-09 08:13:57,743 [INFO]: Launching the whole pipeline 03/09/2025, 08:13:57
2025-03-09 08:13:57,743 [INFO]: Reading total number of vectors and dimension 03/09/2025, 08:13:57
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1330.68it/s]
2025-03-09 08:13:57,767 [INFO]: There are 1447 embeddings of dim 49152
2025-03-09 08:13:57,767 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0237 secs
2025-03-09 08:13:57,767 [INFO]: 	Compute estimated construction time of the index 03/09/2025, 08:13:57
2025-03-09 08:13:57,767 [INFO]: 		-> Train: 16.7 minutes
2025-03-09 08:13:57,767 [INFO]: 		-> Add: 0.8 seconds
2025-03-09 08:13:57,767 [INFO]: 		Total: 16.7 minutes
2025-03-09 08:13:57,767 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0001 secs
2025-03-09 08:13:57,767 [INFO]: 	Checking that your have enough memory available to create the index 03/09/2025, 08:13:57
2025-03-09 08:13:57,767 [INFO]: 298.6MB of memory will be needed to build the index (more might be used if you have more)
2025-03-09 08:13:57,767 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0001 secs
2025-03-09 08:13:57,767 [INFO]: 	Selecting most promising index types given data characteristics 03/09/2025, 08:13:57
2025-03-09 08:13:57,767 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-09 08:13:57,767 [INFO]: 	Creating the index 03/09/2025, 08:13:57
2025-03-09 08:13:57,767 [INFO]: 		-> Instanciate the index HNSW15 03/09/2025, 08:13:57
2025-03-09 08:13:57,769 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0011 secs
2025-03-09 08:13:57,769 [INFO]: 		-> Adding the vectors to the index 03/09/2025, 08:13:57
2025-03-09 08:13:57,769 [INFO]: The memory available for adding the vectors is 49.7GB(total available - used by the index)
2025-03-09 08:13:57,769 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/6 [00:00<?, ?it/s] 17%|█▋        | 1/6 [00:00<00:01,  4.53it/s] 33%|███▎      | 2/6 [00:00<00:00,  6.06it/s] 50%|█████     | 3/6 [00:00<00:00,  7.38it/s] 67%|██████▋   | 4/6 [00:00<00:00,  8.12it/s] 83%|████████▎ | 5/6 [00:00<00:00,  8.61it/s]100%|██████████| 6/6 [00:02<00:00,  1.69it/s]100%|██████████| 6/6 [00:02<00:00,  2.76it/s]
2025-03-09 08:13:59,949 [INFO]: 	Computing best hyperparameters for index knn.index 03/09/2025, 08:13:59
2025-03-09 08:14:19,830 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 19.8805 secs
2025-03-09 08:14:19,830 [INFO]: The best hyperparameters are: efSearch=271
2025-03-09 08:14:19,830 [INFO]: 	Compute fast metrics 03/09/2025, 08:14:19
  0%|          | 0/4 [00:00<?, ?it/s] 25%|██▌       | 1/4 [00:00<00:00,  5.95it/s] 75%|███████▌  | 3/4 [00:00<00:00,  9.79it/s] 75%|███████▌  | 3/4 [00:00<00:00,  7.46it/s]
2025-03-09 08:14:34,296 [INFO]: 	>>> Finished "Compute fast metrics" in 14.4656 secs
2025-03-09 08:14:34,297 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 36.5288 secs
2025-03-09 08:14:34,298 [INFO]: {
2025-03-09 08:14:34,298 [INFO]: 	index_key: HNSW15
2025-03-09 08:14:34,298 [INFO]: 	index_param: efSearch=271
2025-03-09 08:14:34,298 [INFO]: 	index_path: knn.index
2025-03-09 08:14:34,298 [INFO]: 	size in bytes: 284688610
2025-03-09 08:14:34,298 [INFO]: 	avg_search_speed_ms: 12.18749298634695
2025-03-09 08:14:34,298 [INFO]: 	99p_search_speed_ms: 20.522860344499342
2025-03-09 08:14:34,298 [INFO]: 	reconstruction error %: 0.0
2025-03-09 08:14:34,298 [INFO]: 	nb vectors: 1447
2025-03-09 08:14:34,298 [INFO]: 	vectors dimension: 49152
2025-03-09 08:14:34,298 [INFO]: 	compression ratio: 0.9993085989636186
2025-03-09 08:14:34,298 [INFO]: }
2025-03-09 08:14:34,298 [INFO]: 	>>> Finished "Creating the index" in 36.5304 secs
2025-03-09 08:14:34,298 [INFO]: >>> Finished "Launching the whole pipeline" in 36.5548 secs
2025-03-09 08:14:35: [retrieval_preprocessing] calculating distances ...
2025-03-09 08:14:35: [retrieval_preprocessing] finished and saved retrieval indices for episode 31004 [episode count 18/20]
[retrieval_preprocessing] for episode 19869 [episode count 19/20], we have num_retrieval=np.int64(1434) num_query=np.int64(76)
2025-03-09 08:14:36,433 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-09 08:14:36,619 [INFO]: Launching the whole pipeline 03/09/2025, 08:14:36
2025-03-09 08:14:36,619 [INFO]: Reading total number of vectors and dimension 03/09/2025, 08:14:36
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1359.58it/s]
2025-03-09 08:14:36,644 [INFO]: There are 1434 embeddings of dim 49152
2025-03-09 08:14:36,644 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0252 secs
2025-03-09 08:14:36,644 [INFO]: 	Compute estimated construction time of the index 03/09/2025, 08:14:36
2025-03-09 08:14:36,644 [INFO]: 		-> Train: 16.7 minutes
2025-03-09 08:14:36,644 [INFO]: 		-> Add: 0.8 seconds
2025-03-09 08:14:36,644 [INFO]: 		Total: 16.7 minutes
2025-03-09 08:14:36,644 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0001 secs
2025-03-09 08:14:36,644 [INFO]: 	Checking that your have enough memory available to create the index 03/09/2025, 08:14:36
2025-03-09 08:14:36,645 [INFO]: 295.9MB of memory will be needed to build the index (more might be used if you have more)
2025-03-09 08:14:36,645 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0001 secs
2025-03-09 08:14:36,645 [INFO]: 	Selecting most promising index types given data characteristics 03/09/2025, 08:14:36
2025-03-09 08:14:36,645 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-09 08:14:36,645 [INFO]: 	Creating the index 03/09/2025, 08:14:36
2025-03-09 08:14:36,645 [INFO]: 		-> Instanciate the index HNSW15 03/09/2025, 08:14:36
2025-03-09 08:14:36,646 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0009 secs
2025-03-09 08:14:36,646 [INFO]: 		-> Adding the vectors to the index 03/09/2025, 08:14:36
2025-03-09 08:14:36,646 [INFO]: The memory available for adding the vectors is 49.7GB(total available - used by the index)
2025-03-09 08:14:36,646 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/6 [00:00<?, ?it/s] 17%|█▋        | 1/6 [00:00<00:00,  5.12it/s] 33%|███▎      | 2/6 [00:00<00:00,  6.49it/s] 50%|█████     | 3/6 [00:00<00:00,  7.09it/s] 67%|██████▋   | 4/6 [00:00<00:00,  7.54it/s] 83%|████████▎ | 5/6 [00:00<00:00,  7.75it/s]100%|██████████| 6/6 [00:02<00:00,  1.59it/s]100%|██████████| 6/6 [00:02<00:00,  2.62it/s]
2025-03-09 08:14:38,937 [INFO]: 	Computing best hyperparameters for index knn.index 03/09/2025, 08:14:38
2025-03-09 08:15:01,721 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 22.7842 secs
2025-03-09 08:15:01,721 [INFO]: The best hyperparameters are: efSearch=295
2025-03-09 08:15:01,721 [INFO]: 	Compute fast metrics 03/09/2025, 08:15:01
  0%|          | 0/4 [00:00<?, ?it/s] 25%|██▌       | 1/4 [00:00<00:00,  7.07it/s] 75%|███████▌  | 3/4 [00:00<00:00, 10.89it/s] 75%|███████▌  | 3/4 [00:00<00:00,  8.01it/s]
2025-03-09 08:15:16,180 [INFO]: 	>>> Finished "Compute fast metrics" in 14.4588 secs
2025-03-09 08:15:16,182 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 39.5360 secs
2025-03-09 08:15:16,182 [INFO]: {
2025-03-09 08:15:16,182 [INFO]: 	index_key: HNSW15
2025-03-09 08:15:16,182 [INFO]: 	index_param: efSearch=295
2025-03-09 08:15:16,182 [INFO]: 	index_path: knn.index
2025-03-09 08:15:16,182 [INFO]: 	size in bytes: 282130870
2025-03-09 08:15:16,182 [INFO]: 	avg_search_speed_ms: 10.73072754324298
2025-03-09 08:15:16,182 [INFO]: 	99p_search_speed_ms: 16.47433293983338
2025-03-09 08:15:16,182 [INFO]: 	reconstruction error %: 0.0
2025-03-09 08:15:16,182 [INFO]: 	nb vectors: 1434
2025-03-09 08:15:16,182 [INFO]: 	vectors dimension: 49152
2025-03-09 08:15:16,182 [INFO]: 	compression ratio: 0.9993088384833606
2025-03-09 08:15:16,182 [INFO]: }
2025-03-09 08:15:16,182 [INFO]: 	>>> Finished "Creating the index" in 39.5373 secs
2025-03-09 08:15:16,182 [INFO]: >>> Finished "Launching the whole pipeline" in 39.5631 secs
2025-03-09 08:15:16: [retrieval_preprocessing] calculating distances ...
2025-03-09 08:15:16: [retrieval_preprocessing] finished and saved retrieval indices for episode 19869 [episode count 19/20]
2025-03-09 08:15:16: [retrieval_preprocessing] finished for (395700094, 'block') [chosen_id count 4/10]
2025-03-09 08:15:19: [retrieval_preprocessing] concatenated all embeddings and indices for 20 episodes for (3827924651, 'lid') [chosen_id count 5/10]
2025-03-09 08:15:19: [retrieval_preprocessing] we have num_total=4390 embedding_dim=49152
[retrieval_preprocessing] for episode 60672 [episode count 0/20], we have num_retrieval=np.int64(4181) num_query=np.int64(209)
2025-03-09 08:15:20,747 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-09 08:15:21,275 [INFO]: Launching the whole pipeline 03/09/2025, 08:15:21
2025-03-09 08:15:21,275 [INFO]: Reading total number of vectors and dimension 03/09/2025, 08:15:21
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1244.60it/s]
2025-03-09 08:15:21,300 [INFO]: There are 4181 embeddings of dim 49152
2025-03-09 08:15:21,301 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0252 secs
2025-03-09 08:15:21,301 [INFO]: 	Compute estimated construction time of the index 03/09/2025, 08:15:21
2025-03-09 08:15:21,301 [INFO]: 		-> Train: 16.7 minutes
2025-03-09 08:15:21,301 [INFO]: 		-> Add: 2.3 seconds
2025-03-09 08:15:21,301 [INFO]: 		Total: 16.7 minutes
2025-03-09 08:15:21,301 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0001 secs
2025-03-09 08:15:21,301 [INFO]: 	Checking that your have enough memory available to create the index 03/09/2025, 08:15:21
2025-03-09 08:15:21,301 [INFO]: 862.9MB of memory will be needed to build the index (more might be used if you have more)
2025-03-09 08:15:21,301 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0001 secs
2025-03-09 08:15:21,301 [INFO]: 	Selecting most promising index types given data characteristics 03/09/2025, 08:15:21
2025-03-09 08:15:21,301 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-09 08:15:21,301 [INFO]: 	Creating the index 03/09/2025, 08:15:21
2025-03-09 08:15:21,301 [INFO]: 		-> Instanciate the index HNSW15 03/09/2025, 08:15:21
2025-03-09 08:15:21,302 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0012 secs
2025-03-09 08:15:21,302 [INFO]: 		-> Adding the vectors to the index 03/09/2025, 08:15:21
2025-03-09 08:15:21,302 [INFO]: The memory available for adding the vectors is 49.2GB(total available - used by the index)
2025-03-09 08:15:21,303 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/17 [00:00<?, ?it/s]  6%|▌         | 1/17 [00:00<00:02,  6.53it/s] 18%|█▊        | 3/17 [00:00<00:01, 10.21it/s] 29%|██▉       | 5/17 [00:00<00:01, 11.06it/s] 41%|████      | 7/17 [00:00<00:00, 11.36it/s] 53%|█████▎    | 9/17 [00:00<00:00, 11.35it/s] 65%|██████▍   | 11/17 [00:01<00:00, 11.27it/s] 76%|███████▋  | 13/17 [00:01<00:00, 11.27it/s] 88%|████████▊ | 15/17 [00:01<00:00, 11.31it/s]100%|██████████| 17/17 [00:04<00:00,  1.81it/s]100%|██████████| 17/17 [00:04<00:00,  3.80it/s]
2025-03-09 08:15:25,775 [INFO]: 	Computing best hyperparameters for index knn.index 03/09/2025, 08:15:25
2025-03-09 08:16:04,811 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 39.0349 secs
2025-03-09 08:16:04,811 [INFO]: The best hyperparameters are: efSearch=268
2025-03-09 08:16:04,811 [INFO]: 	Compute fast metrics 03/09/2025, 08:16:04
  0%|          | 0/4 [00:00<?, ?it/s] 25%|██▌       | 1/4 [00:00<00:00,  5.30it/s] 50%|█████     | 2/4 [00:00<00:00,  6.74it/s] 75%|███████▌  | 3/4 [00:00<00:00,  7.47it/s] 75%|███████▌  | 3/4 [00:00<00:00,  5.66it/s]
2025-03-09 08:16:24,045 [INFO]: 	>>> Finished "Compute fast metrics" in 19.2343 secs
2025-03-09 08:16:24,048 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 62.7457 secs
2025-03-09 08:16:24,048 [INFO]: {
2025-03-09 08:16:24,048 [INFO]: 	index_key: HNSW15
2025-03-09 08:16:24,048 [INFO]: 	index_param: efSearch=268
2025-03-09 08:16:24,048 [INFO]: 	index_path: knn.index
2025-03-09 08:16:24,048 [INFO]: 	size in bytes: 822586690
2025-03-09 08:16:24,048 [INFO]: 	avg_search_speed_ms: 10.484711854011836
2025-03-09 08:16:24,048 [INFO]: 	99p_search_speed_ms: 19.27443500142545
2025-03-09 08:16:24,048 [INFO]: 	reconstruction error %: 0.0
2025-03-09 08:16:24,048 [INFO]: 	nb vectors: 4181
2025-03-09 08:16:24,048 [INFO]: 	vectors dimension: 49152
2025-03-09 08:16:24,048 [INFO]: 	compression ratio: 0.9993087148054876
2025-03-09 08:16:24,048 [INFO]: }
2025-03-09 08:16:24,048 [INFO]: 	>>> Finished "Creating the index" in 62.7474 secs
2025-03-09 08:16:24,048 [INFO]: >>> Finished "Launching the whole pipeline" in 62.7732 secs
2025-03-09 08:16:25: [retrieval_preprocessing] calculating distances ...
2025-03-09 08:16:26: [retrieval_preprocessing] finished and saved retrieval indices for episode 60672 [episode count 0/20]
[retrieval_preprocessing] for episode 8195 [episode count 1/20], we have num_retrieval=np.int64(4226) num_query=np.int64(164)
2025-03-09 08:16:27,632 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-09 08:16:28,348 [INFO]: Launching the whole pipeline 03/09/2025, 08:16:28
2025-03-09 08:16:28,348 [INFO]: Reading total number of vectors and dimension 03/09/2025, 08:16:28
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1663.75it/s]
2025-03-09 08:16:28,375 [INFO]: There are 4226 embeddings of dim 49152
2025-03-09 08:16:28,375 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0269 secs
2025-03-09 08:16:28,376 [INFO]: 	Compute estimated construction time of the index 03/09/2025, 08:16:28
2025-03-09 08:16:28,376 [INFO]: 		-> Train: 16.7 minutes
2025-03-09 08:16:28,376 [INFO]: 		-> Add: 2.3 seconds
2025-03-09 08:16:28,376 [INFO]: 		Total: 16.7 minutes
2025-03-09 08:16:28,376 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0005 secs
2025-03-09 08:16:28,376 [INFO]: 	Checking that your have enough memory available to create the index 03/09/2025, 08:16:28
2025-03-09 08:16:28,377 [INFO]: 872.1MB of memory will be needed to build the index (more might be used if you have more)
2025-03-09 08:16:28,377 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0003 secs
2025-03-09 08:16:28,377 [INFO]: 	Selecting most promising index types given data characteristics 03/09/2025, 08:16:28
2025-03-09 08:16:28,377 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-09 08:16:28,377 [INFO]: 	Creating the index 03/09/2025, 08:16:28
2025-03-09 08:16:28,377 [INFO]: 		-> Instanciate the index HNSW15 03/09/2025, 08:16:28
2025-03-09 08:16:28,380 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0028 secs
2025-03-09 08:16:28,380 [INFO]: 		-> Adding the vectors to the index 03/09/2025, 08:16:28
2025-03-09 08:16:28,381 [INFO]: The memory available for adding the vectors is 49.2GB(total available - used by the index)
2025-03-09 08:16:28,381 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/17 [00:00<?, ?it/s]  6%|▌         | 1/17 [00:00<00:02,  5.39it/s] 18%|█▊        | 3/17 [00:00<00:01,  8.30it/s] 29%|██▉       | 5/17 [00:00<00:01,  9.26it/s] 35%|███▌      | 6/17 [00:00<00:01,  9.41it/s] 47%|████▋     | 8/17 [00:00<00:00,  9.72it/s] 59%|█████▉    | 10/17 [00:01<00:00,  9.90it/s] 65%|██████▍   | 11/17 [00:01<00:00,  9.90it/s] 76%|███████▋  | 13/17 [00:01<00:00, 10.05it/s] 88%|████████▊ | 15/17 [00:01<00:00, 10.41it/s]100%|██████████| 17/17 [00:04<00:00,  1.69it/s]100%|██████████| 17/17 [00:04<00:00,  3.62it/s]
2025-03-09 08:16:33,084 [INFO]: 	Computing best hyperparameters for index knn.index 03/09/2025, 08:16:33
2025-03-09 08:17:16,253 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 43.1687 secs
2025-03-09 08:17:16,254 [INFO]: The best hyperparameters are: efSearch=178
2025-03-09 08:17:16,254 [INFO]: 	Compute fast metrics 03/09/2025, 08:17:16
  0%|          | 0/4 [00:00<?, ?it/s] 50%|█████     | 2/4 [00:00<00:00, 19.08it/s] 75%|███████▌  | 3/4 [00:00<00:00, 20.17it/s]
2025-03-09 08:17:33,314 [INFO]: 	>>> Finished "Compute fast metrics" in 17.0593 secs
2025-03-09 08:17:33,316 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 64.9353 secs
2025-03-09 08:17:33,316 [INFO]: {
2025-03-09 08:17:33,316 [INFO]: 	index_key: HNSW15
2025-03-09 08:17:33,316 [INFO]: 	index_param: efSearch=178
2025-03-09 08:17:33,316 [INFO]: 	index_path: knn.index
2025-03-09 08:17:33,316 [INFO]: 	size in bytes: 831440110
2025-03-09 08:17:33,316 [INFO]: 	avg_search_speed_ms: 8.45904307213002
2025-03-09 08:17:33,316 [INFO]: 	99p_search_speed_ms: 19.039984268601987
2025-03-09 08:17:33,316 [INFO]: 	reconstruction error %: 0.0
2025-03-09 08:17:33,316 [INFO]: 	nb vectors: 4226
2025-03-09 08:17:33,316 [INFO]: 	vectors dimension: 49152
2025-03-09 08:17:33,316 [INFO]: 	compression ratio: 0.9993087872558855
2025-03-09 08:17:33,316 [INFO]: }
2025-03-09 08:17:33,316 [INFO]: 	>>> Finished "Creating the index" in 64.9390 secs
2025-03-09 08:17:33,316 [INFO]: >>> Finished "Launching the whole pipeline" in 64.9681 secs
2025-03-09 08:17:34: [retrieval_preprocessing] calculating distances ...
2025-03-09 08:17:34: [retrieval_preprocessing] finished and saved retrieval indices for episode 8195 [episode count 1/20]
[retrieval_preprocessing] for episode 45444 [episode count 2/20], we have num_retrieval=np.int64(4216) num_query=np.int64(174)
2025-03-09 08:17:34,869 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-09 08:17:35,580 [INFO]: Launching the whole pipeline 03/09/2025, 08:17:35
2025-03-09 08:17:35,581 [INFO]: Reading total number of vectors and dimension 03/09/2025, 08:17:35
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1169.96it/s]
2025-03-09 08:17:35,628 [INFO]: There are 4216 embeddings of dim 49152
2025-03-09 08:17:35,628 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0478 secs
2025-03-09 08:17:35,629 [INFO]: 	Compute estimated construction time of the index 03/09/2025, 08:17:35
2025-03-09 08:17:35,629 [INFO]: 		-> Train: 16.7 minutes
2025-03-09 08:17:35,629 [INFO]: 		-> Add: 2.3 seconds
2025-03-09 08:17:35,629 [INFO]: 		Total: 16.7 minutes
2025-03-09 08:17:35,629 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0003 secs
2025-03-09 08:17:35,629 [INFO]: 	Checking that your have enough memory available to create the index 03/09/2025, 08:17:35
2025-03-09 08:17:35,630 [INFO]: 870.1MB of memory will be needed to build the index (more might be used if you have more)
2025-03-09 08:17:35,630 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0005 secs
2025-03-09 08:17:35,630 [INFO]: 	Selecting most promising index types given data characteristics 03/09/2025, 08:17:35
2025-03-09 08:17:35,630 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-09 08:17:35,630 [INFO]: 	Creating the index 03/09/2025, 08:17:35
2025-03-09 08:17:35,630 [INFO]: 		-> Instanciate the index HNSW15 03/09/2025, 08:17:35
2025-03-09 08:17:35,633 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0028 secs
2025-03-09 08:17:35,633 [INFO]: 		-> Adding the vectors to the index 03/09/2025, 08:17:35
2025-03-09 08:17:35,634 [INFO]: The memory available for adding the vectors is 49.2GB(total available - used by the index)
2025-03-09 08:17:35,634 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/17 [00:00<?, ?it/s] 12%|█▏        | 2/17 [00:00<00:00, 19.35it/s] 47%|████▋     | 8/17 [00:00<00:00, 41.42it/s] 82%|████████▏ | 14/17 [00:00<00:00, 47.93it/s]100%|██████████| 17/17 [00:03<00:00,  4.79it/s]
2025-03-09 08:17:39,451 [INFO]: 	Computing best hyperparameters for index knn.index 03/09/2025, 08:17:39
2025-03-09 08:18:23,077 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 43.6258 secs
2025-03-09 08:18:23,078 [INFO]: The best hyperparameters are: efSearch=198
2025-03-09 08:18:23,078 [INFO]: 	Compute fast metrics 03/09/2025, 08:18:23
  0%|          | 0/4 [00:00<?, ?it/s] 75%|███████▌  | 3/4 [00:00<00:00, 26.05it/s] 75%|███████▌  | 3/4 [00:00<00:00, 21.93it/s]
2025-03-09 08:18:39,368 [INFO]: 	>>> Finished "Compute fast metrics" in 16.2903 secs
2025-03-09 08:18:39,371 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 63.7369 secs
2025-03-09 08:18:39,371 [INFO]: {
2025-03-09 08:18:39,371 [INFO]: 	index_key: HNSW15
2025-03-09 08:18:39,371 [INFO]: 	index_param: efSearch=198
2025-03-09 08:18:39,371 [INFO]: 	index_path: knn.index
2025-03-09 08:18:39,371 [INFO]: 	size in bytes: 829472710
2025-03-09 08:18:39,371 [INFO]: 	avg_search_speed_ms: 8.174174331213885
2025-03-09 08:18:39,371 [INFO]: 	99p_search_speed_ms: 13.41753480955958
2025-03-09 08:18:39,371 [INFO]: 	reconstruction error %: 0.0
2025-03-09 08:18:39,371 [INFO]: 	nb vectors: 4216
2025-03-09 08:18:39,371 [INFO]: 	vectors dimension: 49152
2025-03-09 08:18:39,371 [INFO]: 	compression ratio: 0.9993087391627387
2025-03-09 08:18:39,371 [INFO]: }
2025-03-09 08:18:39,371 [INFO]: 	>>> Finished "Creating the index" in 63.7406 secs
2025-03-09 08:18:39,371 [INFO]: >>> Finished "Launching the whole pipeline" in 63.7904 secs
2025-03-09 08:18:40: [retrieval_preprocessing] calculating distances ...
2025-03-09 08:18:40: [retrieval_preprocessing] finished and saved retrieval indices for episode 45444 [episode count 2/20]
[retrieval_preprocessing] for episode 261 [episode count 3/20], we have num_retrieval=np.int64(4156) num_query=np.int64(234)
2025-03-09 08:18:41,051 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-09 08:18:41,557 [INFO]: Launching the whole pipeline 03/09/2025, 08:18:41
2025-03-09 08:18:41,557 [INFO]: Reading total number of vectors and dimension 03/09/2025, 08:18:41
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1613.19it/s]
2025-03-09 08:18:41,583 [INFO]: There are 4156 embeddings of dim 49152
2025-03-09 08:18:41,583 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0261 secs
2025-03-09 08:18:41,583 [INFO]: 	Compute estimated construction time of the index 03/09/2025, 08:18:41
2025-03-09 08:18:41,583 [INFO]: 		-> Train: 16.7 minutes
2025-03-09 08:18:41,583 [INFO]: 		-> Add: 2.3 seconds
2025-03-09 08:18:41,583 [INFO]: 		Total: 16.7 minutes
2025-03-09 08:18:41,583 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0002 secs
2025-03-09 08:18:41,583 [INFO]: 	Checking that your have enough memory available to create the index 03/09/2025, 08:18:41
2025-03-09 08:18:41,583 [INFO]: 857.7MB of memory will be needed to build the index (more might be used if you have more)
2025-03-09 08:18:41,583 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0002 secs
2025-03-09 08:18:41,583 [INFO]: 	Selecting most promising index types given data characteristics 03/09/2025, 08:18:41
2025-03-09 08:18:41,584 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-09 08:18:41,584 [INFO]: 	Creating the index 03/09/2025, 08:18:41
2025-03-09 08:18:41,584 [INFO]: 		-> Instanciate the index HNSW15 03/09/2025, 08:18:41
2025-03-09 08:18:41,585 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0012 secs
2025-03-09 08:18:41,585 [INFO]: 		-> Adding the vectors to the index 03/09/2025, 08:18:41
2025-03-09 08:18:41,585 [INFO]: The memory available for adding the vectors is 49.2GB(total available - used by the index)
2025-03-09 08:18:41,585 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/17 [00:00<?, ?it/s] 12%|█▏        | 2/17 [00:00<00:00, 19.93it/s] 41%|████      | 7/17 [00:00<00:00, 37.32it/s] 71%|███████   | 12/17 [00:00<00:00, 42.80it/s]100%|██████████| 17/17 [00:03<00:00,  3.70it/s]100%|██████████| 17/17 [00:03<00:00,  5.16it/s]
2025-03-09 08:18:44,886 [INFO]: 	Computing best hyperparameters for index knn.index 03/09/2025, 08:18:44
2025-03-09 08:19:29,602 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 44.7161 secs
2025-03-09 08:19:29,602 [INFO]: The best hyperparameters are: efSearch=235
2025-03-09 08:19:29,603 [INFO]: 	Compute fast metrics 03/09/2025, 08:19:29
  0%|          | 0/4 [00:00<?, ?it/s] 50%|█████     | 2/4 [00:00<00:00, 18.04it/s] 75%|███████▌  | 3/4 [00:00<00:00, 19.25it/s]
2025-03-09 08:19:44,817 [INFO]: 	>>> Finished "Compute fast metrics" in 15.2142 secs
2025-03-09 08:19:44,821 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 63.2356 secs
2025-03-09 08:19:44,821 [INFO]: {
2025-03-09 08:19:44,821 [INFO]: 	index_key: HNSW15
2025-03-09 08:19:44,821 [INFO]: 	index_param: efSearch=235
2025-03-09 08:19:44,821 [INFO]: 	index_path: knn.index
2025-03-09 08:19:44,821 [INFO]: 	size in bytes: 817668130
2025-03-09 08:19:44,821 [INFO]: 	avg_search_speed_ms: 9.924725900563072
2025-03-09 08:19:44,821 [INFO]: 	99p_search_speed_ms: 17.768376923631852
2025-03-09 08:19:44,821 [INFO]: 	reconstruction error %: 0.0
2025-03-09 08:19:44,821 [INFO]: 	nb vectors: 4156
2025-03-09 08:19:44,821 [INFO]: 	vectors dimension: 49152
2025-03-09 08:19:44,821 [INFO]: 	compression ratio: 0.9993086657297013
2025-03-09 08:19:44,821 [INFO]: }
2025-03-09 08:19:44,821 [INFO]: 	>>> Finished "Creating the index" in 63.2374 secs
2025-03-09 08:19:44,821 [INFO]: >>> Finished "Launching the whole pipeline" in 63.2643 secs
2025-03-09 08:19:46: [retrieval_preprocessing] calculating distances ...
2025-03-09 08:19:47: [retrieval_preprocessing] finished and saved retrieval indices for episode 261 [episode count 3/20]
[retrieval_preprocessing] for episode 65804 [episode count 4/20], we have num_retrieval=np.int64(4193) num_query=np.int64(197)
2025-03-09 08:19:47,712 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-09 08:19:48,234 [INFO]: Launching the whole pipeline 03/09/2025, 08:19:48
2025-03-09 08:19:48,234 [INFO]: Reading total number of vectors and dimension 03/09/2025, 08:19:48
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 810.65it/s]
2025-03-09 08:19:48,265 [INFO]: There are 4193 embeddings of dim 49152
2025-03-09 08:19:48,265 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0306 secs
2025-03-09 08:19:48,265 [INFO]: 	Compute estimated construction time of the index 03/09/2025, 08:19:48
2025-03-09 08:19:48,265 [INFO]: 		-> Train: 16.7 minutes
2025-03-09 08:19:48,266 [INFO]: 		-> Add: 2.3 seconds
2025-03-09 08:19:48,266 [INFO]: 		Total: 16.7 minutes
2025-03-09 08:19:48,266 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0003 secs
2025-03-09 08:19:48,266 [INFO]: 	Checking that your have enough memory available to create the index 03/09/2025, 08:19:48
2025-03-09 08:19:48,266 [INFO]: 865.3MB of memory will be needed to build the index (more might be used if you have more)
2025-03-09 08:19:48,266 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0003 secs
2025-03-09 08:19:48,266 [INFO]: 	Selecting most promising index types given data characteristics 03/09/2025, 08:19:48
2025-03-09 08:19:48,266 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-09 08:19:48,266 [INFO]: 	Creating the index 03/09/2025, 08:19:48
2025-03-09 08:19:48,267 [INFO]: 		-> Instanciate the index HNSW15 03/09/2025, 08:19:48
2025-03-09 08:19:48,269 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0027 secs
2025-03-09 08:19:48,270 [INFO]: 		-> Adding the vectors to the index 03/09/2025, 08:19:48
2025-03-09 08:19:48,270 [INFO]: The memory available for adding the vectors is 49.2GB(total available - used by the index)
2025-03-09 08:19:48,270 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/17 [00:00<?, ?it/s] 18%|█▊        | 3/17 [00:00<00:00, 25.57it/s] 53%|█████▎    | 9/17 [00:00<00:00, 41.86it/s] 88%|████████▊ | 15/17 [00:00<00:00, 47.22it/s]100%|██████████| 17/17 [00:03<00:00,  4.43it/s]
2025-03-09 08:19:52,111 [INFO]: 	Computing best hyperparameters for index knn.index 03/09/2025, 08:19:52
2025-03-09 08:20:36,469 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 44.3575 secs
2025-03-09 08:20:36,469 [INFO]: The best hyperparameters are: efSearch=230
2025-03-09 08:20:36,469 [INFO]: 	Compute fast metrics 03/09/2025, 08:20:36
  0%|          | 0/4 [00:00<?, ?it/s] 50%|█████     | 2/4 [00:00<00:00, 16.52it/s] 75%|███████▌  | 3/4 [00:00<00:00, 16.68it/s]
2025-03-09 08:20:51,285 [INFO]: 	>>> Finished "Compute fast metrics" in 14.8163 secs
2025-03-09 08:20:51,288 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 63.0180 secs
2025-03-09 08:20:51,288 [INFO]: {
2025-03-09 08:20:51,288 [INFO]: 	index_key: HNSW15
2025-03-09 08:20:51,288 [INFO]: 	index_param: efSearch=230
2025-03-09 08:20:51,288 [INFO]: 	index_path: knn.index
2025-03-09 08:20:51,288 [INFO]: 	size in bytes: 824947570
2025-03-09 08:20:51,288 [INFO]: 	avg_search_speed_ms: 9.651711363431685
2025-03-09 08:20:51,289 [INFO]: 	99p_search_speed_ms: 19.17886884184555
2025-03-09 08:20:51,289 [INFO]: 	reconstruction error %: 0.0
2025-03-09 08:20:51,289 [INFO]: 	nb vectors: 4193
2025-03-09 08:20:51,289 [INFO]: 	vectors dimension: 49152
2025-03-09 08:20:51,289 [INFO]: 	compression ratio: 0.9993087730411764
2025-03-09 08:20:51,289 [INFO]: }
2025-03-09 08:20:51,289 [INFO]: 	>>> Finished "Creating the index" in 63.0221 secs
2025-03-09 08:20:51,289 [INFO]: >>> Finished "Launching the whole pipeline" in 63.0543 secs
2025-03-09 08:20:52: [retrieval_preprocessing] calculating distances ...
2025-03-09 08:20:53: [retrieval_preprocessing] finished and saved retrieval indices for episode 65804 [episode count 4/20]
[retrieval_preprocessing] for episode 65677 [episode count 5/20], we have num_retrieval=np.int64(4252) num_query=np.int64(138)
2025-03-09 08:20:53,414 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-09 08:20:53,997 [INFO]: Launching the whole pipeline 03/09/2025, 08:20:53
2025-03-09 08:20:53,997 [INFO]: Reading total number of vectors and dimension 03/09/2025, 08:20:53
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1866.62it/s]
2025-03-09 08:20:54,020 [INFO]: There are 4252 embeddings of dim 49152
2025-03-09 08:20:54,020 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0231 secs
2025-03-09 08:20:54,020 [INFO]: 	Compute estimated construction time of the index 03/09/2025, 08:20:54
2025-03-09 08:20:54,020 [INFO]: 		-> Train: 16.7 minutes
2025-03-09 08:20:54,020 [INFO]: 		-> Add: 2.3 seconds
2025-03-09 08:20:54,020 [INFO]: 		Total: 16.7 minutes
2025-03-09 08:20:54,020 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0001 secs
2025-03-09 08:20:54,020 [INFO]: 	Checking that your have enough memory available to create the index 03/09/2025, 08:20:54
2025-03-09 08:20:54,020 [INFO]: 877.5MB of memory will be needed to build the index (more might be used if you have more)
2025-03-09 08:20:54,020 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0001 secs
2025-03-09 08:20:54,020 [INFO]: 	Selecting most promising index types given data characteristics 03/09/2025, 08:20:54
2025-03-09 08:20:54,020 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-09 08:20:54,020 [INFO]: 	Creating the index 03/09/2025, 08:20:54
2025-03-09 08:20:54,020 [INFO]: 		-> Instanciate the index HNSW15 03/09/2025, 08:20:54
2025-03-09 08:20:54,021 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0009 secs
2025-03-09 08:20:54,021 [INFO]: 		-> Adding the vectors to the index 03/09/2025, 08:20:54
2025-03-09 08:20:54,021 [INFO]: The memory available for adding the vectors is 49.2GB(total available - used by the index)
2025-03-09 08:20:54,021 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/17 [00:00<?, ?it/s] 18%|█▊        | 3/17 [00:00<00:00, 25.48it/s] 41%|████      | 7/17 [00:00<00:00, 29.31it/s] 65%|██████▍   | 11/17 [00:00<00:00, 31.37it/s]100%|██████████| 17/17 [00:03<00:00,  4.00it/s]100%|██████████| 17/17 [00:03<00:00,  5.43it/s]
2025-03-09 08:20:57,154 [INFO]: 	Computing best hyperparameters for index knn.index 03/09/2025, 08:20:57
2025-03-09 08:21:42,622 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 45.4675 secs
2025-03-09 08:21:42,622 [INFO]: The best hyperparameters are: efSearch=226
2025-03-09 08:21:42,623 [INFO]: 	Compute fast metrics 03/09/2025, 08:21:42
  0%|          | 0/4 [00:00<?, ?it/s] 50%|█████     | 2/4 [00:00<00:00, 19.34it/s] 75%|███████▌  | 3/4 [00:00<00:00, 21.30it/s]
2025-03-09 08:21:56,283 [INFO]: 	>>> Finished "Compute fast metrics" in 13.6604 secs
2025-03-09 08:21:56,285 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 62.2641 secs
2025-03-09 08:21:56,286 [INFO]: {
2025-03-09 08:21:56,286 [INFO]: 	index_key: HNSW15
2025-03-09 08:21:56,286 [INFO]: 	index_param: efSearch=226
2025-03-09 08:21:56,286 [INFO]: 	index_path: knn.index
2025-03-09 08:21:56,286 [INFO]: 	size in bytes: 836555530
2025-03-09 08:21:56,286 [INFO]: 	avg_search_speed_ms: 9.43235596334386
2025-03-09 08:21:56,286 [INFO]: 	99p_search_speed_ms: 20.450747844297457
2025-03-09 08:21:56,286 [INFO]: 	reconstruction error %: 0.0
2025-03-09 08:21:56,286 [INFO]: 	nb vectors: 4252
2025-03-09 08:21:56,286 [INFO]: 	vectors dimension: 49152
2025-03-09 08:21:56,286 [INFO]: 	compression ratio: 0.9993086962200823
2025-03-09 08:21:56,286 [INFO]: }
2025-03-09 08:21:56,286 [INFO]: 	>>> Finished "Creating the index" in 62.2655 secs
2025-03-09 08:21:56,286 [INFO]: >>> Finished "Launching the whole pipeline" in 62.2891 secs
2025-03-09 08:21:56: [retrieval_preprocessing] calculating distances ...
2025-03-09 08:21:57: [retrieval_preprocessing] finished and saved retrieval indices for episode 65677 [episode count 5/20]
[retrieval_preprocessing] for episode 53774 [episode count 6/20], we have num_retrieval=np.int64(4172) num_query=np.int64(218)
2025-03-09 08:21:57,643 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-09 08:21:58,249 [INFO]: Launching the whole pipeline 03/09/2025, 08:21:58
2025-03-09 08:21:58,249 [INFO]: Reading total number of vectors and dimension 03/09/2025, 08:21:58
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1135.74it/s]
2025-03-09 08:21:58,275 [INFO]: There are 4172 embeddings of dim 49152
2025-03-09 08:21:58,275 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0262 secs
2025-03-09 08:21:58,275 [INFO]: 	Compute estimated construction time of the index 03/09/2025, 08:21:58
2025-03-09 08:21:58,275 [INFO]: 		-> Train: 16.7 minutes
2025-03-09 08:21:58,275 [INFO]: 		-> Add: 2.3 seconds
2025-03-09 08:21:58,275 [INFO]: 		Total: 16.7 minutes
2025-03-09 08:21:58,275 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0001 secs
2025-03-09 08:21:58,275 [INFO]: 	Checking that your have enough memory available to create the index 03/09/2025, 08:21:58
2025-03-09 08:21:58,275 [INFO]: 861.0MB of memory will be needed to build the index (more might be used if you have more)
2025-03-09 08:21:58,275 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0002 secs
2025-03-09 08:21:58,275 [INFO]: 	Selecting most promising index types given data characteristics 03/09/2025, 08:21:58
2025-03-09 08:21:58,275 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-09 08:21:58,275 [INFO]: 	Creating the index 03/09/2025, 08:21:58
2025-03-09 08:21:58,276 [INFO]: 		-> Instanciate the index HNSW15 03/09/2025, 08:21:58
2025-03-09 08:21:58,277 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0012 secs
2025-03-09 08:21:58,277 [INFO]: 		-> Adding the vectors to the index 03/09/2025, 08:21:58
2025-03-09 08:21:58,277 [INFO]: The memory available for adding the vectors is 49.2GB(total available - used by the index)
2025-03-09 08:21:58,277 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/17 [00:00<?, ?it/s]  6%|▌         | 1/17 [00:00<00:01,  9.58it/s] 41%|████      | 7/17 [00:00<00:00, 35.69it/s] 71%|███████   | 12/17 [00:00<00:00, 41.44it/s]100%|██████████| 17/17 [00:03<00:00,  3.93it/s]100%|██████████| 17/17 [00:03<00:00,  5.39it/s]
2025-03-09 08:22:01,436 [INFO]: 	Computing best hyperparameters for index knn.index 03/09/2025, 08:22:01
2025-03-09 08:22:49,421 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 47.9846 secs
2025-03-09 08:22:49,421 [INFO]: The best hyperparameters are: efSearch=204
2025-03-09 08:22:49,421 [INFO]: 	Compute fast metrics 03/09/2025, 08:22:49
  0%|          | 0/4 [00:00<?, ?it/s] 25%|██▌       | 1/4 [00:00<00:00,  7.08it/s] 75%|███████▌  | 3/4 [00:00<00:00, 14.22it/s]
2025-03-09 08:23:08,056 [INFO]: 	>>> Finished "Compute fast metrics" in 18.6345 secs
2025-03-09 08:23:08,058 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 69.7813 secs
2025-03-09 08:23:08,058 [INFO]: {
2025-03-09 08:23:08,058 [INFO]: 	index_key: HNSW15
2025-03-09 08:23:08,058 [INFO]: 	index_param: efSearch=204
2025-03-09 08:23:08,058 [INFO]: 	index_path: knn.index
2025-03-09 08:23:08,058 [INFO]: 	size in bytes: 820816030
2025-03-09 08:23:08,058 [INFO]: 	avg_search_speed_ms: 10.624543275767254
2025-03-09 08:23:08,058 [INFO]: 	99p_search_speed_ms: 21.3304964825511
2025-03-09 08:23:08,058 [INFO]: 	reconstruction error %: 0.0
2025-03-09 08:23:08,058 [INFO]: 	nb vectors: 4172
2025-03-09 08:23:08,058 [INFO]: 	vectors dimension: 49152
2025-03-09 08:23:08,058 [INFO]: 	compression ratio: 0.9993086709088759
2025-03-09 08:23:08,058 [INFO]: }
2025-03-09 08:23:08,058 [INFO]: 	>>> Finished "Creating the index" in 69.7829 secs
2025-03-09 08:23:08,058 [INFO]: >>> Finished "Launching the whole pipeline" in 69.8099 secs
2025-03-09 08:23:09: [retrieval_preprocessing] calculating distances ...
2025-03-09 08:23:10: [retrieval_preprocessing] finished and saved retrieval indices for episode 53774 [episode count 6/20]
[retrieval_preprocessing] for episode 38415 [episode count 7/20], we have num_retrieval=np.int64(4197) num_query=np.int64(193)
2025-03-09 08:23:10,633 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-09 08:23:11,364 [INFO]: Launching the whole pipeline 03/09/2025, 08:23:11
2025-03-09 08:23:11,365 [INFO]: Reading total number of vectors and dimension 03/09/2025, 08:23:11
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1432.48it/s]
2025-03-09 08:23:11,391 [INFO]: There are 4197 embeddings of dim 49152
2025-03-09 08:23:11,391 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0265 secs
2025-03-09 08:23:11,391 [INFO]: 	Compute estimated construction time of the index 03/09/2025, 08:23:11
2025-03-09 08:23:11,391 [INFO]: 		-> Train: 16.7 minutes
2025-03-09 08:23:11,391 [INFO]: 		-> Add: 2.3 seconds
2025-03-09 08:23:11,391 [INFO]: 		Total: 16.7 minutes
2025-03-09 08:23:11,391 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0001 secs
2025-03-09 08:23:11,391 [INFO]: 	Checking that your have enough memory available to create the index 03/09/2025, 08:23:11
2025-03-09 08:23:11,392 [INFO]: 866.2MB of memory will be needed to build the index (more might be used if you have more)
2025-03-09 08:23:11,392 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0002 secs
2025-03-09 08:23:11,392 [INFO]: 	Selecting most promising index types given data characteristics 03/09/2025, 08:23:11
2025-03-09 08:23:11,392 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-09 08:23:11,392 [INFO]: 	Creating the index 03/09/2025, 08:23:11
2025-03-09 08:23:11,392 [INFO]: 		-> Instanciate the index HNSW15 03/09/2025, 08:23:11
2025-03-09 08:23:11,393 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0011 secs
2025-03-09 08:23:11,393 [INFO]: 		-> Adding the vectors to the index 03/09/2025, 08:23:11
2025-03-09 08:23:11,393 [INFO]: The memory available for adding the vectors is 49.2GB(total available - used by the index)
2025-03-09 08:23:11,393 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/17 [00:00<?, ?it/s]  6%|▌         | 1/17 [00:00<00:03,  4.61it/s] 18%|█▊        | 3/17 [00:00<00:01, 10.69it/s] 41%|████      | 7/17 [00:00<00:00, 20.53it/s] 71%|███████   | 12/17 [00:00<00:00, 28.42it/s]100%|██████████| 17/17 [00:03<00:00,  3.49it/s]100%|██████████| 17/17 [00:03<00:00,  4.74it/s]
2025-03-09 08:23:14,983 [INFO]: 	Computing best hyperparameters for index knn.index 03/09/2025, 08:23:14
2025-03-09 08:24:01,837 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 46.8526 secs
2025-03-09 08:24:01,837 [INFO]: The best hyperparameters are: efSearch=220
2025-03-09 08:24:01,837 [INFO]: 	Compute fast metrics 03/09/2025, 08:24:01
  0%|          | 0/4 [00:00<?, ?it/s] 75%|███████▌  | 3/4 [00:00<00:00, 25.60it/s] 75%|███████▌  | 3/4 [00:00<00:00, 21.71it/s]
2025-03-09 08:24:19,279 [INFO]: 	>>> Finished "Compute fast metrics" in 17.4418 secs
2025-03-09 08:24:19,281 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 67.8884 secs
2025-03-09 08:24:19,281 [INFO]: {
2025-03-09 08:24:19,282 [INFO]: 	index_key: HNSW15
2025-03-09 08:24:19,282 [INFO]: 	index_param: efSearch=220
2025-03-09 08:24:19,282 [INFO]: 	index_path: knn.index
2025-03-09 08:24:19,282 [INFO]: 	size in bytes: 825734530
2025-03-09 08:24:19,282 [INFO]: 	avg_search_speed_ms: 9.817681671737148
2025-03-09 08:24:19,282 [INFO]: 	99p_search_speed_ms: 23.324881736189113
2025-03-09 08:24:19,282 [INFO]: 	reconstruction error %: 0.0
2025-03-09 08:24:19,282 [INFO]: 	nb vectors: 4197
2025-03-09 08:24:19,282 [INFO]: 	vectors dimension: 49152
2025-03-09 08:24:19,282 [INFO]: 	compression ratio: 0.9993087923790712
2025-03-09 08:24:19,282 [INFO]: }
2025-03-09 08:24:19,282 [INFO]: 	>>> Finished "Creating the index" in 67.8900 secs
2025-03-09 08:24:19,282 [INFO]: >>> Finished "Launching the whole pipeline" in 67.9171 secs
2025-03-09 08:24:20: [retrieval_preprocessing] calculating distances ...
2025-03-09 08:24:20: [retrieval_preprocessing] finished and saved retrieval indices for episode 38415 [episode count 7/20]
[retrieval_preprocessing] for episode 71565 [episode count 8/20], we have num_retrieval=np.int64(4229) num_query=np.int64(161)
2025-03-09 08:24:21,330 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-09 08:24:21,877 [INFO]: Launching the whole pipeline 03/09/2025, 08:24:21
2025-03-09 08:24:21,877 [INFO]: Reading total number of vectors and dimension 03/09/2025, 08:24:21
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1437.88it/s]
2025-03-09 08:24:21,902 [INFO]: There are 4229 embeddings of dim 49152
2025-03-09 08:24:21,902 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0252 secs
2025-03-09 08:24:21,902 [INFO]: 	Compute estimated construction time of the index 03/09/2025, 08:24:21
2025-03-09 08:24:21,902 [INFO]: 		-> Train: 16.7 minutes
2025-03-09 08:24:21,902 [INFO]: 		-> Add: 2.3 seconds
2025-03-09 08:24:21,902 [INFO]: 		Total: 16.7 minutes
2025-03-09 08:24:21,902 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0001 secs
2025-03-09 08:24:21,902 [INFO]: 	Checking that your have enough memory available to create the index 03/09/2025, 08:24:21
2025-03-09 08:24:21,902 [INFO]: 872.8MB of memory will be needed to build the index (more might be used if you have more)
2025-03-09 08:24:21,902 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0001 secs
2025-03-09 08:24:21,903 [INFO]: 	Selecting most promising index types given data characteristics 03/09/2025, 08:24:21
2025-03-09 08:24:21,903 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-09 08:24:21,903 [INFO]: 	Creating the index 03/09/2025, 08:24:21
2025-03-09 08:24:21,903 [INFO]: 		-> Instanciate the index HNSW15 03/09/2025, 08:24:21
2025-03-09 08:24:21,904 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0009 secs
2025-03-09 08:24:21,904 [INFO]: 		-> Adding the vectors to the index 03/09/2025, 08:24:21
2025-03-09 08:24:21,904 [INFO]: The memory available for adding the vectors is 49.2GB(total available - used by the index)
2025-03-09 08:24:21,904 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/17 [00:00<?, ?it/s]  6%|▌         | 1/17 [00:00<00:01,  8.30it/s] 35%|███▌      | 6/17 [00:00<00:00, 30.76it/s] 65%|██████▍   | 11/17 [00:00<00:00, 38.77it/s]100%|██████████| 17/17 [00:03<00:00,  3.40it/s]100%|██████████| 17/17 [00:03<00:00,  4.50it/s]
2025-03-09 08:24:25,682 [INFO]: 	Computing best hyperparameters for index knn.index 03/09/2025, 08:24:25
2025-03-09 08:25:07,089 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 41.4063 secs
2025-03-09 08:25:07,089 [INFO]: The best hyperparameters are: efSearch=222
2025-03-09 08:25:07,089 [INFO]: 	Compute fast metrics 03/09/2025, 08:25:07
  0%|          | 0/4 [00:00<?, ?it/s] 50%|█████     | 2/4 [00:00<00:00, 18.10it/s] 75%|███████▌  | 3/4 [00:00<00:00, 19.11it/s]
2025-03-09 08:25:30,301 [INFO]: 	>>> Finished "Compute fast metrics" in 23.2123 secs
2025-03-09 08:25:30,304 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 68.3999 secs
2025-03-09 08:25:30,304 [INFO]: {
2025-03-09 08:25:30,304 [INFO]: 	index_key: HNSW15
2025-03-09 08:25:30,304 [INFO]: 	index_param: efSearch=222
2025-03-09 08:25:30,304 [INFO]: 	index_path: knn.index
2025-03-09 08:25:30,304 [INFO]: 	size in bytes: 832030330
2025-03-09 08:25:30,304 [INFO]: 	avg_search_speed_ms: 9.405916875187984
2025-03-09 08:25:30,304 [INFO]: 	99p_search_speed_ms: 18.227440514601767
2025-03-09 08:25:30,304 [INFO]: 	reconstruction error %: 0.0
2025-03-09 08:25:30,304 [INFO]: 	nb vectors: 4229
2025-03-09 08:25:30,304 [INFO]: 	vectors dimension: 49152
2025-03-09 08:25:30,304 [INFO]: 	compression ratio: 0.9993088016394787
2025-03-09 08:25:30,304 [INFO]: }
2025-03-09 08:25:30,304 [INFO]: 	>>> Finished "Creating the index" in 68.4014 secs
2025-03-09 08:25:30,304 [INFO]: >>> Finished "Launching the whole pipeline" in 68.4271 secs
2025-03-09 08:25:31: [retrieval_preprocessing] calculating distances ...
2025-03-09 08:25:31: [retrieval_preprocessing] finished and saved retrieval indices for episode 71565 [episode count 8/20]
[retrieval_preprocessing] for episode 60561 [episode count 9/20], we have num_retrieval=np.int64(4274) num_query=np.int64(116)
2025-03-09 08:25:31,998 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-09 08:25:32,763 [INFO]: Launching the whole pipeline 03/09/2025, 08:25:32
2025-03-09 08:25:32,763 [INFO]: Reading total number of vectors and dimension 03/09/2025, 08:25:32
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1599.66it/s]
2025-03-09 08:25:32,928 [INFO]: There are 4274 embeddings of dim 49152
2025-03-09 08:25:32,929 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.1652 secs
2025-03-09 08:25:32,929 [INFO]: 	Compute estimated construction time of the index 03/09/2025, 08:25:32
2025-03-09 08:25:32,929 [INFO]: 		-> Train: 16.7 minutes
2025-03-09 08:25:32,929 [INFO]: 		-> Add: 2.3 seconds
2025-03-09 08:25:32,929 [INFO]: 		Total: 16.7 minutes
2025-03-09 08:25:32,929 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0002 secs
2025-03-09 08:25:32,929 [INFO]: 	Checking that your have enough memory available to create the index 03/09/2025, 08:25:32
2025-03-09 08:25:32,929 [INFO]: 882.1MB of memory will be needed to build the index (more might be used if you have more)
2025-03-09 08:25:32,930 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0004 secs
2025-03-09 08:25:32,930 [INFO]: 	Selecting most promising index types given data characteristics 03/09/2025, 08:25:32
2025-03-09 08:25:32,930 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-09 08:25:32,930 [INFO]: 	Creating the index 03/09/2025, 08:25:32
2025-03-09 08:25:32,930 [INFO]: 		-> Instanciate the index HNSW15 03/09/2025, 08:25:32
2025-03-09 08:25:32,932 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0022 secs
2025-03-09 08:25:32,932 [INFO]: 		-> Adding the vectors to the index 03/09/2025, 08:25:32
2025-03-09 08:25:32,933 [INFO]: The memory available for adding the vectors is 49.2GB(total available - used by the index)
2025-03-09 08:25:32,933 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/17 [00:00<?, ?it/s]  6%|▌         | 1/17 [00:00<00:01,  9.89it/s] 35%|███▌      | 6/17 [00:00<00:00, 30.11it/s] 65%|██████▍   | 11/17 [00:00<00:00, 37.31it/s]100%|██████████| 17/17 [00:03<00:00,  3.67it/s]100%|██████████| 17/17 [00:03<00:00,  4.84it/s]
2025-03-09 08:25:36,449 [INFO]: 	Computing best hyperparameters for index knn.index 03/09/2025, 08:25:36
2025-03-09 08:26:23,739 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 47.2898 secs
2025-03-09 08:26:23,739 [INFO]: The best hyperparameters are: efSearch=239
2025-03-09 08:26:23,739 [INFO]: 	Compute fast metrics 03/09/2025, 08:26:23
  0%|          | 0/4 [00:00<?, ?it/s] 50%|█████     | 2/4 [00:00<00:00, 16.97it/s] 75%|███████▌  | 3/4 [00:00<00:00, 17.79it/s]
2025-03-09 08:26:44,319 [INFO]: 	>>> Finished "Compute fast metrics" in 20.5797 secs
2025-03-09 08:26:44,322 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 71.3894 secs
2025-03-09 08:26:44,322 [INFO]: {
2025-03-09 08:26:44,322 [INFO]: 	index_key: HNSW15
2025-03-09 08:26:44,322 [INFO]: 	index_param: efSearch=239
2025-03-09 08:26:44,322 [INFO]: 	index_path: knn.index
2025-03-09 08:26:44,322 [INFO]: 	size in bytes: 840883870
2025-03-09 08:26:44,322 [INFO]: 	avg_search_speed_ms: 10.088822125614952
2025-03-09 08:26:44,322 [INFO]: 	99p_search_speed_ms: 20.015111849643304
2025-03-09 08:26:44,322 [INFO]: 	reconstruction error %: 0.0
2025-03-09 08:26:44,322 [INFO]: 	nb vectors: 4274
2025-03-09 08:26:44,322 [INFO]: 	vectors dimension: 49152
2025-03-09 08:26:44,322 [INFO]: 	compression ratio: 0.9993087297536103
2025-03-09 08:26:44,322 [INFO]: }
2025-03-09 08:26:44,322 [INFO]: 	>>> Finished "Creating the index" in 71.3924 secs
2025-03-09 08:26:44,322 [INFO]: >>> Finished "Launching the whole pipeline" in 71.5589 secs
2025-03-09 08:26:45: [retrieval_preprocessing] calculating distances ...
2025-03-09 08:26:45: [retrieval_preprocessing] finished and saved retrieval indices for episode 60561 [episode count 9/20]
[retrieval_preprocessing] for episode 83853 [episode count 10/20], we have num_retrieval=np.int64(4179) num_query=np.int64(211)
2025-03-09 08:26:45,989 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-09 08:26:46,642 [INFO]: Launching the whole pipeline 03/09/2025, 08:26:46
2025-03-09 08:26:46,642 [INFO]: Reading total number of vectors and dimension 03/09/2025, 08:26:46
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1318.96it/s]
2025-03-09 08:26:46,670 [INFO]: There are 4179 embeddings of dim 49152
2025-03-09 08:26:46,671 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0281 secs
2025-03-09 08:26:46,671 [INFO]: 	Compute estimated construction time of the index 03/09/2025, 08:26:46
2025-03-09 08:26:46,671 [INFO]: 		-> Train: 16.7 minutes
2025-03-09 08:26:46,671 [INFO]: 		-> Add: 2.3 seconds
2025-03-09 08:26:46,671 [INFO]: 		Total: 16.7 minutes
2025-03-09 08:26:46,671 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0003 secs
2025-03-09 08:26:46,671 [INFO]: 	Checking that your have enough memory available to create the index 03/09/2025, 08:26:46
2025-03-09 08:26:46,672 [INFO]: 862.4MB of memory will be needed to build the index (more might be used if you have more)
2025-03-09 08:26:46,672 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0005 secs
2025-03-09 08:26:46,672 [INFO]: 	Selecting most promising index types given data characteristics 03/09/2025, 08:26:46
2025-03-09 08:26:46,672 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-09 08:26:46,672 [INFO]: 	Creating the index 03/09/2025, 08:26:46
2025-03-09 08:26:46,672 [INFO]: 		-> Instanciate the index HNSW15 03/09/2025, 08:26:46
2025-03-09 08:26:46,675 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0028 secs
2025-03-09 08:26:46,676 [INFO]: 		-> Adding the vectors to the index 03/09/2025, 08:26:46
2025-03-09 08:26:46,676 [INFO]: The memory available for adding the vectors is 49.2GB(total available - used by the index)
2025-03-09 08:26:46,676 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/17 [00:00<?, ?it/s]  6%|▌         | 1/17 [00:00<00:01,  9.05it/s] 35%|███▌      | 6/17 [00:00<00:00, 29.81it/s] 65%|██████▍   | 11/17 [00:00<00:00, 36.30it/s] 94%|█████████▍| 16/17 [00:00<00:00, 39.28it/s]100%|██████████| 17/17 [00:03<00:00,  4.61it/s]
2025-03-09 08:26:50,370 [INFO]: 	Computing best hyperparameters for index knn.index 03/09/2025, 08:26:50
2025-03-09 08:27:38,674 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 48.3042 secs
2025-03-09 08:27:38,675 [INFO]: The best hyperparameters are: efSearch=210
2025-03-09 08:27:38,675 [INFO]: 	Compute fast metrics 03/09/2025, 08:27:38
  0%|          | 0/4 [00:00<?, ?it/s] 25%|██▌       | 1/4 [00:00<00:00,  9.54it/s] 75%|███████▌  | 3/4 [00:00<00:00, 16.46it/s]
2025-03-09 08:27:54,081 [INFO]: 	>>> Finished "Compute fast metrics" in 15.4064 secs
2025-03-09 08:27:54,084 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 67.4081 secs
2025-03-09 08:27:54,084 [INFO]: {
2025-03-09 08:27:54,084 [INFO]: 	index_key: HNSW15
2025-03-09 08:27:54,084 [INFO]: 	index_param: efSearch=210
2025-03-09 08:27:54,084 [INFO]: 	index_path: knn.index
2025-03-09 08:27:54,084 [INFO]: 	size in bytes: 822193210
2025-03-09 08:27:54,084 [INFO]: 	avg_search_speed_ms: 10.936647603141564
2025-03-09 08:27:54,084 [INFO]: 	99p_search_speed_ms: 21.416786608751863
2025-03-09 08:27:54,084 [INFO]: 	reconstruction error %: 0.0
2025-03-09 08:27:54,084 [INFO]: 	nb vectors: 4179
2025-03-09 08:27:54,084 [INFO]: 	vectors dimension: 49152
2025-03-09 08:27:54,084 [INFO]: 	compression ratio: 0.9993087050670243
2025-03-09 08:27:54,084 [INFO]: }
2025-03-09 08:27:54,084 [INFO]: 	>>> Finished "Creating the index" in 67.4122 secs
2025-03-09 08:27:54,085 [INFO]: >>> Finished "Launching the whole pipeline" in 67.4421 secs
2025-03-09 08:27:54: [retrieval_preprocessing] calculating distances ...
2025-03-09 08:27:55: [retrieval_preprocessing] finished and saved retrieval indices for episode 83853 [episode count 10/20]
[retrieval_preprocessing] for episode 90007 [episode count 11/20], we have num_retrieval=np.int64(3725) num_query=np.int64(665)
2025-03-09 08:27:56,083 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-09 08:27:56,588 [INFO]: Launching the whole pipeline 03/09/2025, 08:27:56
2025-03-09 08:27:56,588 [INFO]: Reading total number of vectors and dimension 03/09/2025, 08:27:56
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1225.69it/s]
2025-03-09 08:27:56,615 [INFO]: There are 3725 embeddings of dim 49152
2025-03-09 08:27:56,615 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0273 secs
2025-03-09 08:27:56,615 [INFO]: 	Compute estimated construction time of the index 03/09/2025, 08:27:56
2025-03-09 08:27:56,615 [INFO]: 		-> Train: 16.7 minutes
2025-03-09 08:27:56,615 [INFO]: 		-> Add: 2.0 seconds
2025-03-09 08:27:56,615 [INFO]: 		Total: 16.7 minutes
2025-03-09 08:27:56,615 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0001 secs
2025-03-09 08:27:56,615 [INFO]: 	Checking that your have enough memory available to create the index 03/09/2025, 08:27:56
2025-03-09 08:27:56,616 [INFO]: 768.8MB of memory will be needed to build the index (more might be used if you have more)
2025-03-09 08:27:56,616 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0002 secs
2025-03-09 08:27:56,616 [INFO]: 	Selecting most promising index types given data characteristics 03/09/2025, 08:27:56
2025-03-09 08:27:56,616 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-09 08:27:56,616 [INFO]: 	Creating the index 03/09/2025, 08:27:56
2025-03-09 08:27:56,616 [INFO]: 		-> Instanciate the index HNSW15 03/09/2025, 08:27:56
2025-03-09 08:27:56,617 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0012 secs
2025-03-09 08:27:56,617 [INFO]: 		-> Adding the vectors to the index 03/09/2025, 08:27:56
2025-03-09 08:27:56,617 [INFO]: The memory available for adding the vectors is 49.3GB(total available - used by the index)
2025-03-09 08:27:56,617 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/15 [00:00<?, ?it/s] 13%|█▎        | 2/15 [00:00<00:00, 18.09it/s] 47%|████▋     | 7/15 [00:00<00:00, 35.57it/s] 80%|████████  | 12/15 [00:00<00:00, 41.52it/s]100%|██████████| 15/15 [00:02<00:00,  5.30it/s]
2025-03-09 08:27:59,451 [INFO]: 	Computing best hyperparameters for index knn.index 03/09/2025, 08:27:59
2025-03-09 08:28:37,634 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 38.1819 secs
2025-03-09 08:28:37,634 [INFO]: The best hyperparameters are: efSearch=215
2025-03-09 08:28:37,634 [INFO]: 	Compute fast metrics 03/09/2025, 08:28:37
  0%|          | 0/4 [00:00<?, ?it/s] 25%|██▌       | 1/4 [00:00<00:00,  5.07it/s] 50%|█████     | 2/4 [00:00<00:00,  6.92it/s] 75%|███████▌  | 3/4 [00:00<00:00,  7.60it/s] 75%|███████▌  | 3/4 [00:00<00:00,  5.65it/s]
2025-03-09 08:28:54,001 [INFO]: 	>>> Finished "Compute fast metrics" in 16.3674 secs
2025-03-09 08:28:54,585 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 57.9678 secs
2025-03-09 08:28:54,585 [INFO]: {
2025-03-09 08:28:54,585 [INFO]: 	index_key: HNSW15
2025-03-09 08:28:54,586 [INFO]: 	index_param: efSearch=215
2025-03-09 08:28:54,586 [INFO]: 	index_path: knn.index
2025-03-09 08:28:54,586 [INFO]: 	size in bytes: 732870970
2025-03-09 08:28:54,586 [INFO]: 	avg_search_speed_ms: 9.940948258010742
2025-03-09 08:28:54,586 [INFO]: 	99p_search_speed_ms: 19.999657925218344
2025-03-09 08:28:54,586 [INFO]: 	reconstruction error %: 0.0
2025-03-09 08:28:54,586 [INFO]: 	nb vectors: 3725
2025-03-09 08:28:54,586 [INFO]: 	vectors dimension: 49152
2025-03-09 08:28:54,586 [INFO]: 	compression ratio: 0.999309332719237
2025-03-09 08:28:54,586 [INFO]: }
2025-03-09 08:28:54,586 [INFO]: 	>>> Finished "Creating the index" in 57.9701 secs
2025-03-09 08:28:54,586 [INFO]: >>> Finished "Launching the whole pipeline" in 57.9980 secs
2025-03-09 08:28:57: [retrieval_preprocessing] calculating distances ...
2025-03-09 08:29:00: [retrieval_preprocessing] finished and saved retrieval indices for episode 90007 [episode count 11/20]
[retrieval_preprocessing] for episode 93720 [episode count 12/20], we have num_retrieval=np.int64(4240) num_query=np.int64(150)
2025-03-09 08:29:01,201 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-09 08:29:02,006 [INFO]: Launching the whole pipeline 03/09/2025, 08:29:02
2025-03-09 08:29:02,006 [INFO]: Reading total number of vectors and dimension 03/09/2025, 08:29:02
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1102.31it/s]
2025-03-09 08:29:02,038 [INFO]: There are 4240 embeddings of dim 49152
2025-03-09 08:29:02,038 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0321 secs
2025-03-09 08:29:02,039 [INFO]: 	Compute estimated construction time of the index 03/09/2025, 08:29:02
2025-03-09 08:29:02,039 [INFO]: 		-> Train: 16.7 minutes
2025-03-09 08:29:02,039 [INFO]: 		-> Add: 2.3 seconds
2025-03-09 08:29:02,039 [INFO]: 		Total: 16.7 minutes
2025-03-09 08:29:02,039 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0005 secs
2025-03-09 08:29:02,039 [INFO]: 	Checking that your have enough memory available to create the index 03/09/2025, 08:29:02
2025-03-09 08:29:02,040 [INFO]: 875.0MB of memory will be needed to build the index (more might be used if you have more)
2025-03-09 08:29:02,040 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0005 secs
2025-03-09 08:29:02,040 [INFO]: 	Selecting most promising index types given data characteristics 03/09/2025, 08:29:02
2025-03-09 08:29:02,040 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-09 08:29:02,040 [INFO]: 	Creating the index 03/09/2025, 08:29:02
2025-03-09 08:29:02,040 [INFO]: 		-> Instanciate the index HNSW15 03/09/2025, 08:29:02
2025-03-09 08:29:02,043 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0028 secs
2025-03-09 08:29:02,044 [INFO]: 		-> Adding the vectors to the index 03/09/2025, 08:29:02
2025-03-09 08:29:02,044 [INFO]: The memory available for adding the vectors is 49.2GB(total available - used by the index)
2025-03-09 08:29:02,044 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/17 [00:00<?, ?it/s] 12%|█▏        | 2/17 [00:00<00:00, 18.58it/s] 41%|████      | 7/17 [00:00<00:00, 35.89it/s] 71%|███████   | 12/17 [00:00<00:00, 40.99it/s]100%|██████████| 17/17 [00:03<00:00,  3.45it/s]100%|██████████| 17/17 [00:03<00:00,  4.82it/s]
2025-03-09 08:29:05,579 [INFO]: 	Computing best hyperparameters for index knn.index 03/09/2025, 08:29:05
2025-03-09 08:29:46,913 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 41.3336 secs
2025-03-09 08:29:46,913 [INFO]: The best hyperparameters are: efSearch=218
2025-03-09 08:29:46,913 [INFO]: 	Compute fast metrics 03/09/2025, 08:29:46
  0%|          | 0/4 [00:00<?, ?it/s] 75%|███████▌  | 3/4 [00:00<00:00, 25.86it/s] 75%|███████▌  | 3/4 [00:00<00:00, 21.99it/s]
2025-03-09 08:30:09,023 [INFO]: 	>>> Finished "Compute fast metrics" in 22.1101 secs
2025-03-09 08:30:09,026 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 66.9818 secs
2025-03-09 08:30:09,026 [INFO]: {
2025-03-09 08:30:09,026 [INFO]: 	index_key: HNSW15
2025-03-09 08:30:09,026 [INFO]: 	index_param: efSearch=218
2025-03-09 08:30:09,026 [INFO]: 	index_path: knn.index
2025-03-09 08:30:09,026 [INFO]: 	size in bytes: 834194650
2025-03-09 08:30:09,026 [INFO]: 	avg_search_speed_ms: 9.046730687707043
2025-03-09 08:30:09,026 [INFO]: 	99p_search_speed_ms: 21.404045959934614
2025-03-09 08:30:09,026 [INFO]: 	reconstruction error %: 0.0
2025-03-09 08:30:09,026 [INFO]: 	nb vectors: 4240
2025-03-09 08:30:09,026 [INFO]: 	vectors dimension: 49152
2025-03-09 08:30:09,026 [INFO]: 	compression ratio: 0.9993086385773392
2025-03-09 08:30:09,026 [INFO]: }
2025-03-09 08:30:09,026 [INFO]: 	>>> Finished "Creating the index" in 66.9856 secs
2025-03-09 08:30:09,026 [INFO]: >>> Finished "Launching the whole pipeline" in 67.0198 secs
2025-03-09 08:30:09: [retrieval_preprocessing] calculating distances ...
2025-03-09 08:30:10: [retrieval_preprocessing] finished and saved retrieval indices for episode 93720 [episode count 12/20]
[retrieval_preprocessing] for episode 28570 [episode count 13/20], we have num_retrieval=np.int64(4180) num_query=np.int64(210)
2025-03-09 08:30:10,839 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-09 08:30:11,374 [INFO]: Launching the whole pipeline 03/09/2025, 08:30:11
2025-03-09 08:30:11,374 [INFO]: Reading total number of vectors and dimension 03/09/2025, 08:30:11
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1438.87it/s]
2025-03-09 08:30:11,398 [INFO]: There are 4180 embeddings of dim 49152
2025-03-09 08:30:11,398 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0240 secs
2025-03-09 08:30:11,398 [INFO]: 	Compute estimated construction time of the index 03/09/2025, 08:30:11
2025-03-09 08:30:11,398 [INFO]: 		-> Train: 16.7 minutes
2025-03-09 08:30:11,398 [INFO]: 		-> Add: 2.3 seconds
2025-03-09 08:30:11,398 [INFO]: 		Total: 16.7 minutes
2025-03-09 08:30:11,399 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0001 secs
2025-03-09 08:30:11,399 [INFO]: 	Checking that your have enough memory available to create the index 03/09/2025, 08:30:11
2025-03-09 08:30:11,399 [INFO]: 862.7MB of memory will be needed to build the index (more might be used if you have more)
2025-03-09 08:30:11,399 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0001 secs
2025-03-09 08:30:11,399 [INFO]: 	Selecting most promising index types given data characteristics 03/09/2025, 08:30:11
2025-03-09 08:30:11,399 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-09 08:30:11,399 [INFO]: 	Creating the index 03/09/2025, 08:30:11
2025-03-09 08:30:11,399 [INFO]: 		-> Instanciate the index HNSW15 03/09/2025, 08:30:11
2025-03-09 08:30:11,400 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0009 secs
2025-03-09 08:30:11,400 [INFO]: 		-> Adding the vectors to the index 03/09/2025, 08:30:11
2025-03-09 08:30:11,400 [INFO]: The memory available for adding the vectors is 49.2GB(total available - used by the index)
2025-03-09 08:30:11,400 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/17 [00:00<?, ?it/s]  6%|▌         | 1/17 [00:00<00:01,  8.98it/s] 41%|████      | 7/17 [00:00<00:00, 36.09it/s] 76%|███████▋  | 13/17 [00:00<00:00, 42.34it/s]100%|██████████| 17/17 [00:03<00:00,  4.54it/s]
2025-03-09 08:30:15,150 [INFO]: 	Computing best hyperparameters for index knn.index 03/09/2025, 08:30:15
2025-03-09 08:30:56,309 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 41.1590 secs
2025-03-09 08:30:56,309 [INFO]: The best hyperparameters are: efSearch=259
2025-03-09 08:30:56,309 [INFO]: 	Compute fast metrics 03/09/2025, 08:30:56
  0%|          | 0/4 [00:00<?, ?it/s] 75%|███████▌  | 3/4 [00:00<00:00, 25.37it/s] 75%|███████▌  | 3/4 [00:00<00:00, 21.79it/s]
2025-03-09 08:31:13,388 [INFO]: 	>>> Finished "Compute fast metrics" in 17.0787 secs
2025-03-09 08:31:13,391 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 61.9906 secs
2025-03-09 08:31:13,391 [INFO]: {
2025-03-09 08:31:13,391 [INFO]: 	index_key: HNSW15
2025-03-09 08:31:13,391 [INFO]: 	index_param: efSearch=259
2025-03-09 08:31:13,391 [INFO]: 	index_path: knn.index
2025-03-09 08:31:13,391 [INFO]: 	size in bytes: 822389950
2025-03-09 08:31:13,391 [INFO]: 	avg_search_speed_ms: 10.61376108394465
2025-03-09 08:31:13,391 [INFO]: 	99p_search_speed_ms: 21.88367770751939
2025-03-09 08:31:13,391 [INFO]: 	reconstruction error %: 0.0
2025-03-09 08:31:13,391 [INFO]: 	nb vectors: 4180
2025-03-09 08:31:13,391 [INFO]: 	vectors dimension: 49152
2025-03-09 08:31:13,391 [INFO]: 	compression ratio: 0.9993087099374208
2025-03-09 08:31:13,391 [INFO]: }
2025-03-09 08:31:13,391 [INFO]: 	>>> Finished "Creating the index" in 61.9920 secs
2025-03-09 08:31:13,391 [INFO]: >>> Finished "Launching the whole pipeline" in 62.0167 secs
2025-03-09 08:31:14: [retrieval_preprocessing] calculating distances ...
2025-03-09 08:31:15: [retrieval_preprocessing] finished and saved retrieval indices for episode 28570 [episode count 13/20]
[retrieval_preprocessing] for episode 45723 [episode count 14/20], we have num_retrieval=np.int64(4206) num_query=np.int64(184)
2025-03-09 08:31:15,877 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-09 08:31:16,425 [INFO]: Launching the whole pipeline 03/09/2025, 08:31:16
2025-03-09 08:31:16,425 [INFO]: Reading total number of vectors and dimension 03/09/2025, 08:31:16
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1661.77it/s]
2025-03-09 08:31:16,451 [INFO]: There are 4206 embeddings of dim 49152
2025-03-09 08:31:16,451 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0256 secs
2025-03-09 08:31:16,451 [INFO]: 	Compute estimated construction time of the index 03/09/2025, 08:31:16
2025-03-09 08:31:16,451 [INFO]: 		-> Train: 16.7 minutes
2025-03-09 08:31:16,451 [INFO]: 		-> Add: 2.3 seconds
2025-03-09 08:31:16,451 [INFO]: 		Total: 16.7 minutes
2025-03-09 08:31:16,451 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0001 secs
2025-03-09 08:31:16,451 [INFO]: 	Checking that your have enough memory available to create the index 03/09/2025, 08:31:16
2025-03-09 08:31:16,451 [INFO]: 868.0MB of memory will be needed to build the index (more might be used if you have more)
2025-03-09 08:31:16,451 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0002 secs
2025-03-09 08:31:16,451 [INFO]: 	Selecting most promising index types given data characteristics 03/09/2025, 08:31:16
2025-03-09 08:31:16,451 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-09 08:31:16,452 [INFO]: 	Creating the index 03/09/2025, 08:31:16
2025-03-09 08:31:16,452 [INFO]: 		-> Instanciate the index HNSW15 03/09/2025, 08:31:16
2025-03-09 08:31:16,453 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0010 secs
2025-03-09 08:31:16,453 [INFO]: 		-> Adding the vectors to the index 03/09/2025, 08:31:16
2025-03-09 08:31:16,453 [INFO]: The memory available for adding the vectors is 49.2GB(total available - used by the index)
2025-03-09 08:31:16,453 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/17 [00:00<?, ?it/s]  6%|▌         | 1/17 [00:00<00:01,  8.11it/s] 41%|████      | 7/17 [00:00<00:00, 32.63it/s] 76%|███████▋  | 13/17 [00:00<00:00, 40.57it/s]100%|██████████| 17/17 [00:04<00:00,  4.15it/s]
2025-03-09 08:31:20,551 [INFO]: 	Computing best hyperparameters for index knn.index 03/09/2025, 08:31:20
2025-03-09 08:31:59,979 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 39.4280 secs
2025-03-09 08:31:59,980 [INFO]: The best hyperparameters are: efSearch=216
2025-03-09 08:31:59,980 [INFO]: 	Compute fast metrics 03/09/2025, 08:31:59
  0%|          | 0/4 [00:00<?, ?it/s] 25%|██▌       | 1/4 [00:00<00:00,  8.81it/s] 75%|███████▌  | 3/4 [00:00<00:00, 14.16it/s]
2025-03-09 08:32:12,679 [INFO]: 	>>> Finished "Compute fast metrics" in 12.6983 secs
2025-03-09 08:32:12,681 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 56.2279 secs
2025-03-09 08:32:12,681 [INFO]: {
2025-03-09 08:32:12,681 [INFO]: 	index_key: HNSW15
2025-03-09 08:32:12,681 [INFO]: 	index_param: efSearch=216
2025-03-09 08:32:12,681 [INFO]: 	index_path: knn.index
2025-03-09 08:32:12,681 [INFO]: 	size in bytes: 827505250
2025-03-09 08:32:12,681 [INFO]: 	avg_search_speed_ms: 9.888217343675189
2025-03-09 08:32:12,681 [INFO]: 	99p_search_speed_ms: 22.984997462481253
2025-03-09 08:32:12,681 [INFO]: 	reconstruction error %: 0.0
2025-03-09 08:32:12,681 [INFO]: 	nb vectors: 4206
2025-03-09 08:32:12,681 [INFO]: 	vectors dimension: 49152
2025-03-09 08:32:12,681 [INFO]: 	compression ratio: 0.9993087632978763
2025-03-09 08:32:12,681 [INFO]: }
2025-03-09 08:32:12,681 [INFO]: 	>>> Finished "Creating the index" in 56.2295 secs
2025-03-09 08:32:12,681 [INFO]: >>> Finished "Launching the whole pipeline" in 56.2558 secs
2025-03-09 08:32:13: [retrieval_preprocessing] calculating distances ...
2025-03-09 08:32:13: [retrieval_preprocessing] finished and saved retrieval indices for episode 45723 [episode count 14/20]
[retrieval_preprocessing] for episode 40477 [episode count 15/20], we have num_retrieval=np.int64(4103) num_query=np.int64(287)
2025-03-09 08:32:14,273 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-09 08:32:14,774 [INFO]: Launching the whole pipeline 03/09/2025, 08:32:14
2025-03-09 08:32:14,774 [INFO]: Reading total number of vectors and dimension 03/09/2025, 08:32:14
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1413.65it/s]
2025-03-09 08:32:14,801 [INFO]: There are 4103 embeddings of dim 49152
2025-03-09 08:32:14,802 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0275 secs
2025-03-09 08:32:14,802 [INFO]: 	Compute estimated construction time of the index 03/09/2025, 08:32:14
2025-03-09 08:32:14,802 [INFO]: 		-> Train: 16.7 minutes
2025-03-09 08:32:14,802 [INFO]: 		-> Add: 2.3 seconds
2025-03-09 08:32:14,802 [INFO]: 		Total: 16.7 minutes
2025-03-09 08:32:14,802 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0001 secs
2025-03-09 08:32:14,802 [INFO]: 	Checking that your have enough memory available to create the index 03/09/2025, 08:32:14
2025-03-09 08:32:14,802 [INFO]: 846.8MB of memory will be needed to build the index (more might be used if you have more)
2025-03-09 08:32:14,802 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0001 secs
2025-03-09 08:32:14,802 [INFO]: 	Selecting most promising index types given data characteristics 03/09/2025, 08:32:14
2025-03-09 08:32:14,802 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-09 08:32:14,802 [INFO]: 	Creating the index 03/09/2025, 08:32:14
2025-03-09 08:32:14,802 [INFO]: 		-> Instanciate the index HNSW15 03/09/2025, 08:32:14
2025-03-09 08:32:14,803 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0011 secs
2025-03-09 08:32:14,803 [INFO]: 		-> Adding the vectors to the index 03/09/2025, 08:32:14
2025-03-09 08:32:14,804 [INFO]: The memory available for adding the vectors is 49.2GB(total available - used by the index)
2025-03-09 08:32:14,804 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/17 [00:00<?, ?it/s]  6%|▌         | 1/17 [00:00<00:02,  7.57it/s] 41%|████      | 7/17 [00:00<00:00, 32.11it/s] 76%|███████▋  | 13/17 [00:00<00:00, 40.90it/s]100%|██████████| 17/17 [00:03<00:00,  5.25it/s]
2025-03-09 08:32:18,047 [INFO]: 	Computing best hyperparameters for index knn.index 03/09/2025, 08:32:18
2025-03-09 08:33:01,715 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 43.6681 secs
2025-03-09 08:33:01,716 [INFO]: The best hyperparameters are: efSearch=221
2025-03-09 08:33:01,716 [INFO]: 	Compute fast metrics 03/09/2025, 08:33:01
  0%|          | 0/4 [00:00<?, ?it/s] 50%|█████     | 2/4 [00:00<00:00, 18.07it/s] 75%|███████▌  | 3/4 [00:00<00:00, 19.62it/s]
2025-03-09 08:33:16,106 [INFO]: 	>>> Finished "Compute fast metrics" in 14.3899 secs
2025-03-09 08:33:16,108 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 61.3048 secs
2025-03-09 08:33:16,108 [INFO]: {
2025-03-09 08:33:16,108 [INFO]: 	index_key: HNSW15
2025-03-09 08:33:16,108 [INFO]: 	index_param: efSearch=221
2025-03-09 08:33:16,109 [INFO]: 	index_path: knn.index
2025-03-09 08:33:16,109 [INFO]: 	size in bytes: 807240730
2025-03-09 08:33:16,109 [INFO]: 	avg_search_speed_ms: 9.218770078670937
2025-03-09 08:33:16,109 [INFO]: 	99p_search_speed_ms: 19.96725294739021
2025-03-09 08:33:16,109 [INFO]: 	reconstruction error %: 0.0
2025-03-09 08:33:16,109 [INFO]: 	nb vectors: 4103
2025-03-09 08:33:16,109 [INFO]: 	vectors dimension: 49152
2025-03-09 08:33:16,109 [INFO]: 	compression ratio: 0.9993086250739602
2025-03-09 08:33:16,109 [INFO]: }
2025-03-09 08:33:16,109 [INFO]: 	>>> Finished "Creating the index" in 61.3066 secs
2025-03-09 08:33:16,109 [INFO]: >>> Finished "Launching the whole pipeline" in 61.3346 secs
2025-03-09 08:33:17: [retrieval_preprocessing] calculating distances ...
2025-03-09 08:33:18: [retrieval_preprocessing] finished and saved retrieval indices for episode 40477 [episode count 15/20]
[retrieval_preprocessing] for episode 15522 [episode count 16/20], we have num_retrieval=np.int64(4232) num_query=np.int64(158)
2025-03-09 08:33:18,579 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-09 08:33:19,120 [INFO]: Launching the whole pipeline 03/09/2025, 08:33:19
2025-03-09 08:33:19,121 [INFO]: Reading total number of vectors and dimension 03/09/2025, 08:33:19
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1350.39it/s]
2025-03-09 08:33:19,144 [INFO]: There are 4232 embeddings of dim 49152
2025-03-09 08:33:19,145 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0240 secs
2025-03-09 08:33:19,145 [INFO]: 	Compute estimated construction time of the index 03/09/2025, 08:33:19
2025-03-09 08:33:19,145 [INFO]: 		-> Train: 16.7 minutes
2025-03-09 08:33:19,145 [INFO]: 		-> Add: 2.3 seconds
2025-03-09 08:33:19,145 [INFO]: 		Total: 16.7 minutes
2025-03-09 08:33:19,145 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0001 secs
2025-03-09 08:33:19,145 [INFO]: 	Checking that your have enough memory available to create the index 03/09/2025, 08:33:19
2025-03-09 08:33:19,145 [INFO]: 873.4MB of memory will be needed to build the index (more might be used if you have more)
2025-03-09 08:33:19,145 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0001 secs
2025-03-09 08:33:19,145 [INFO]: 	Selecting most promising index types given data characteristics 03/09/2025, 08:33:19
2025-03-09 08:33:19,145 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-09 08:33:19,145 [INFO]: 	Creating the index 03/09/2025, 08:33:19
2025-03-09 08:33:19,145 [INFO]: 		-> Instanciate the index HNSW15 03/09/2025, 08:33:19
2025-03-09 08:33:19,146 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0011 secs
2025-03-09 08:33:19,147 [INFO]: 		-> Adding the vectors to the index 03/09/2025, 08:33:19
2025-03-09 08:33:19,147 [INFO]: The memory available for adding the vectors is 49.2GB(total available - used by the index)
2025-03-09 08:33:19,147 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/17 [00:00<?, ?it/s]  6%|▌         | 1/17 [00:00<00:01,  8.41it/s] 41%|████      | 7/17 [00:00<00:00, 36.43it/s] 82%|████████▏ | 14/17 [00:00<00:00, 49.26it/s]100%|██████████| 17/17 [00:02<00:00,  5.88it/s]
2025-03-09 08:33:22,042 [INFO]: 	Computing best hyperparameters for index knn.index 03/09/2025, 08:33:22
2025-03-09 08:34:06,475 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 44.4325 secs
2025-03-09 08:34:06,475 [INFO]: The best hyperparameters are: efSearch=222
2025-03-09 08:34:06,475 [INFO]: 	Compute fast metrics 03/09/2025, 08:34:06
  0%|          | 0/4 [00:00<?, ?it/s] 50%|█████     | 2/4 [00:00<00:00, 18.10it/s] 75%|███████▌  | 3/4 [00:00<00:00, 19.59it/s]
2025-03-09 08:34:22,514 [INFO]: 	>>> Finished "Compute fast metrics" in 16.0393 secs
2025-03-09 08:34:22,517 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 63.3699 secs
2025-03-09 08:34:22,517 [INFO]: {
2025-03-09 08:34:22,517 [INFO]: 	index_key: HNSW15
2025-03-09 08:34:22,517 [INFO]: 	index_param: efSearch=222
2025-03-09 08:34:22,517 [INFO]: 	index_path: knn.index
2025-03-09 08:34:22,517 [INFO]: 	size in bytes: 832620550
2025-03-09 08:34:22,517 [INFO]: 	avg_search_speed_ms: 9.543477204354579
2025-03-09 08:34:22,517 [INFO]: 	99p_search_speed_ms: 21.669882778078303
2025-03-09 08:34:22,517 [INFO]: 	reconstruction error %: 0.0
2025-03-09 08:34:22,517 [INFO]: 	nb vectors: 4232
2025-03-09 08:34:22,517 [INFO]: 	vectors dimension: 49152
2025-03-09 08:34:22,517 [INFO]: 	compression ratio: 0.9993088160026797
2025-03-09 08:34:22,517 [INFO]: }
2025-03-09 08:34:22,517 [INFO]: 	>>> Finished "Creating the index" in 63.3715 secs
2025-03-09 08:34:22,517 [INFO]: >>> Finished "Launching the whole pipeline" in 63.3963 secs
2025-03-09 08:34:23: [retrieval_preprocessing] calculating distances ...
2025-03-09 08:34:23: [retrieval_preprocessing] finished and saved retrieval indices for episode 15522 [episode count 16/20]
[retrieval_preprocessing] for episode 71715 [episode count 17/20], we have num_retrieval=np.int64(4187) num_query=np.int64(203)
2025-03-09 08:34:24,113 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-09 08:34:24,634 [INFO]: Launching the whole pipeline 03/09/2025, 08:34:24
2025-03-09 08:34:24,634 [INFO]: Reading total number of vectors and dimension 03/09/2025, 08:34:24
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1653.91it/s]
2025-03-09 08:34:24,657 [INFO]: There are 4187 embeddings of dim 49152
2025-03-09 08:34:24,657 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0235 secs
2025-03-09 08:34:24,657 [INFO]: 	Compute estimated construction time of the index 03/09/2025, 08:34:24
2025-03-09 08:34:24,657 [INFO]: 		-> Train: 16.7 minutes
2025-03-09 08:34:24,657 [INFO]: 		-> Add: 2.3 seconds
2025-03-09 08:34:24,657 [INFO]: 		Total: 16.7 minutes
2025-03-09 08:34:24,657 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0001 secs
2025-03-09 08:34:24,658 [INFO]: 	Checking that your have enough memory available to create the index 03/09/2025, 08:34:24
2025-03-09 08:34:24,658 [INFO]: 864.1MB of memory will be needed to build the index (more might be used if you have more)
2025-03-09 08:34:24,658 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0001 secs
2025-03-09 08:34:24,658 [INFO]: 	Selecting most promising index types given data characteristics 03/09/2025, 08:34:24
2025-03-09 08:34:24,658 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-09 08:34:24,658 [INFO]: 	Creating the index 03/09/2025, 08:34:24
2025-03-09 08:34:24,658 [INFO]: 		-> Instanciate the index HNSW15 03/09/2025, 08:34:24
2025-03-09 08:34:24,659 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0008 secs
2025-03-09 08:34:24,659 [INFO]: 		-> Adding the vectors to the index 03/09/2025, 08:34:24
2025-03-09 08:34:24,659 [INFO]: The memory available for adding the vectors is 49.2GB(total available - used by the index)
2025-03-09 08:34:24,659 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/17 [00:00<?, ?it/s]  6%|▌         | 1/17 [00:00<00:01,  9.38it/s] 41%|████      | 7/17 [00:00<00:00, 37.09it/s] 71%|███████   | 12/17 [00:00<00:00, 40.09it/s]100%|██████████| 17/17 [00:03<00:00,  4.03it/s]100%|██████████| 17/17 [00:03<00:00,  5.51it/s]
2025-03-09 08:34:27,749 [INFO]: 	Computing best hyperparameters for index knn.index 03/09/2025, 08:34:27
2025-03-09 08:35:08,393 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 40.6429 secs
2025-03-09 08:35:08,393 [INFO]: The best hyperparameters are: efSearch=257
2025-03-09 08:35:08,393 [INFO]: 	Compute fast metrics 03/09/2025, 08:35:08
  0%|          | 0/4 [00:00<?, ?it/s] 50%|█████     | 2/4 [00:00<00:00, 17.52it/s] 75%|███████▌  | 3/4 [00:00<00:00, 18.99it/s]
2025-03-09 08:35:22,299 [INFO]: 	>>> Finished "Compute fast metrics" in 13.9055 secs
2025-03-09 08:35:22,302 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 57.6426 secs
2025-03-09 08:35:22,302 [INFO]: {
2025-03-09 08:35:22,302 [INFO]: 	index_key: HNSW15
2025-03-09 08:35:22,302 [INFO]: 	index_param: efSearch=257
2025-03-09 08:35:22,302 [INFO]: 	index_path: knn.index
2025-03-09 08:35:22,302 [INFO]: 	size in bytes: 823767130
2025-03-09 08:35:22,302 [INFO]: 	avg_search_speed_ms: 10.925926143043231
2025-03-09 08:35:22,302 [INFO]: 	99p_search_speed_ms: 23.861122550442822
2025-03-09 08:35:22,302 [INFO]: 	reconstruction error %: 0.0
2025-03-09 08:35:22,302 [INFO]: 	nb vectors: 4187
2025-03-09 08:35:22,302 [INFO]: 	vectors dimension: 49152
2025-03-09 08:35:22,302 [INFO]: 	compression ratio: 0.9993087439650572
2025-03-09 08:35:22,302 [INFO]: }
2025-03-09 08:35:22,302 [INFO]: 	>>> Finished "Creating the index" in 57.6441 secs
2025-03-09 08:35:22,302 [INFO]: >>> Finished "Launching the whole pipeline" in 57.6682 secs
2025-03-09 08:35:23: [retrieval_preprocessing] calculating distances ...
2025-03-09 08:35:24: [retrieval_preprocessing] finished and saved retrieval indices for episode 71715 [episode count 17/20]
[retrieval_preprocessing] for episode 72100 [episode count 18/20], we have num_retrieval=np.int64(4191) num_query=np.int64(199)
2025-03-09 08:35:24,948 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-09 08:35:25,589 [INFO]: Launching the whole pipeline 03/09/2025, 08:35:25
2025-03-09 08:35:25,589 [INFO]: Reading total number of vectors and dimension 03/09/2025, 08:35:25
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1466.03it/s]
2025-03-09 08:35:25,616 [INFO]: There are 4191 embeddings of dim 49152
2025-03-09 08:35:25,616 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0267 secs
2025-03-09 08:35:25,616 [INFO]: 	Compute estimated construction time of the index 03/09/2025, 08:35:25
2025-03-09 08:35:25,616 [INFO]: 		-> Train: 16.7 minutes
2025-03-09 08:35:25,616 [INFO]: 		-> Add: 2.3 seconds
2025-03-09 08:35:25,616 [INFO]: 		Total: 16.7 minutes
2025-03-09 08:35:25,616 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0001 secs
2025-03-09 08:35:25,616 [INFO]: 	Checking that your have enough memory available to create the index 03/09/2025, 08:35:25
2025-03-09 08:35:25,616 [INFO]: 864.9MB of memory will be needed to build the index (more might be used if you have more)
2025-03-09 08:35:25,617 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0002 secs
2025-03-09 08:35:25,617 [INFO]: 	Selecting most promising index types given data characteristics 03/09/2025, 08:35:25
2025-03-09 08:35:25,617 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-09 08:35:25,617 [INFO]: 	Creating the index 03/09/2025, 08:35:25
2025-03-09 08:35:25,617 [INFO]: 		-> Instanciate the index HNSW15 03/09/2025, 08:35:25
2025-03-09 08:35:25,618 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0010 secs
2025-03-09 08:35:25,618 [INFO]: 		-> Adding the vectors to the index 03/09/2025, 08:35:25
2025-03-09 08:35:25,618 [INFO]: The memory available for adding the vectors is 49.2GB(total available - used by the index)
2025-03-09 08:35:25,618 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/17 [00:00<?, ?it/s]  6%|▌         | 1/17 [00:00<00:01,  9.12it/s] 35%|███▌      | 6/17 [00:00<00:00, 31.80it/s] 59%|█████▉    | 10/17 [00:00<00:00, 34.91it/s] 88%|████████▊ | 15/17 [00:00<00:00, 40.22it/s]100%|██████████| 17/17 [00:03<00:00,  5.20it/s]
2025-03-09 08:35:28,891 [INFO]: 	Computing best hyperparameters for index knn.index 03/09/2025, 08:35:28
2025-03-09 08:36:13,964 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 45.0724 secs
2025-03-09 08:36:13,964 [INFO]: The best hyperparameters are: efSearch=218
2025-03-09 08:36:13,964 [INFO]: 	Compute fast metrics 03/09/2025, 08:36:13
  0%|          | 0/4 [00:00<?, ?it/s] 50%|█████     | 2/4 [00:00<00:00, 18.23it/s] 75%|███████▌  | 3/4 [00:00<00:00, 16.67it/s]
2025-03-09 08:36:35,818 [INFO]: 	>>> Finished "Compute fast metrics" in 21.8533 secs
2025-03-09 08:36:35,820 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 70.2022 secs
2025-03-09 08:36:35,820 [INFO]: {
2025-03-09 08:36:35,820 [INFO]: 	index_key: HNSW15
2025-03-09 08:36:35,820 [INFO]: 	index_param: efSearch=218
2025-03-09 08:36:35,820 [INFO]: 	index_path: knn.index
2025-03-09 08:36:35,820 [INFO]: 	size in bytes: 824554090
2025-03-09 08:36:35,820 [INFO]: 	avg_search_speed_ms: 10.103348964787644
2025-03-09 08:36:35,820 [INFO]: 	99p_search_speed_ms: 23.146178303286437
2025-03-09 08:36:35,820 [INFO]: 	reconstruction error %: 0.0
2025-03-09 08:36:35,820 [INFO]: 	nb vectors: 4191
2025-03-09 08:36:35,820 [INFO]: 	vectors dimension: 49152
2025-03-09 08:36:35,820 [INFO]: 	compression ratio: 0.9993087633583868
2025-03-09 08:36:35,820 [INFO]: }
2025-03-09 08:36:35,820 [INFO]: 	>>> Finished "Creating the index" in 70.2038 secs
2025-03-09 08:36:35,820 [INFO]: >>> Finished "Launching the whole pipeline" in 70.2312 secs
2025-03-09 08:36:36: [retrieval_preprocessing] calculating distances ...
2025-03-09 08:36:37: [retrieval_preprocessing] finished and saved retrieval indices for episode 72100 [episode count 18/20]
[retrieval_preprocessing] for episode 55589 [episode count 19/20], we have num_retrieval=np.int64(4071) num_query=np.int64(319)
2025-03-09 08:36:37,582 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-09 08:36:38,236 [INFO]: Launching the whole pipeline 03/09/2025, 08:36:38
2025-03-09 08:36:38,236 [INFO]: Reading total number of vectors and dimension 03/09/2025, 08:36:38
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1473.75it/s]
2025-03-09 08:36:38,262 [INFO]: There are 4071 embeddings of dim 49152
2025-03-09 08:36:38,262 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0266 secs
2025-03-09 08:36:38,262 [INFO]: 	Compute estimated construction time of the index 03/09/2025, 08:36:38
2025-03-09 08:36:38,262 [INFO]: 		-> Train: 16.7 minutes
2025-03-09 08:36:38,262 [INFO]: 		-> Add: 2.2 seconds
2025-03-09 08:36:38,263 [INFO]: 		Total: 16.7 minutes
2025-03-09 08:36:38,263 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0005 secs
2025-03-09 08:36:38,263 [INFO]: 	Checking that your have enough memory available to create the index 03/09/2025, 08:36:38
2025-03-09 08:36:38,263 [INFO]: 840.2MB of memory will be needed to build the index (more might be used if you have more)
2025-03-09 08:36:38,263 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0001 secs
2025-03-09 08:36:38,263 [INFO]: 	Selecting most promising index types given data characteristics 03/09/2025, 08:36:38
2025-03-09 08:36:38,263 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-09 08:36:38,263 [INFO]: 	Creating the index 03/09/2025, 08:36:38
2025-03-09 08:36:38,263 [INFO]: 		-> Instanciate the index HNSW15 03/09/2025, 08:36:38
2025-03-09 08:36:38,264 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0010 secs
2025-03-09 08:36:38,264 [INFO]: 		-> Adding the vectors to the index 03/09/2025, 08:36:38
2025-03-09 08:36:38,264 [INFO]: The memory available for adding the vectors is 49.3GB(total available - used by the index)
2025-03-09 08:36:38,265 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/17 [00:00<?, ?it/s]  6%|▌         | 1/17 [00:00<00:01,  8.90it/s] 35%|███▌      | 6/17 [00:00<00:00, 31.42it/s] 65%|██████▍   | 11/17 [00:00<00:00, 38.81it/s] 94%|█████████▍| 16/17 [00:00<00:00, 40.12it/s]100%|██████████| 17/17 [00:03<00:00,  4.43it/s]
2025-03-09 08:36:42,102 [INFO]: 	Computing best hyperparameters for index knn.index 03/09/2025, 08:36:42
2025-03-09 08:37:19,774 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 37.6718 secs
2025-03-09 08:37:19,774 [INFO]: The best hyperparameters are: efSearch=223
2025-03-09 08:37:19,774 [INFO]: 	Compute fast metrics 03/09/2025, 08:37:19
  0%|          | 0/4 [00:00<?, ?it/s] 25%|██▌       | 1/4 [00:00<00:00,  9.33it/s] 75%|███████▌  | 3/4 [00:00<00:00, 15.72it/s]
2025-03-09 08:37:32,735 [INFO]: 	>>> Finished "Compute fast metrics" in 12.9604 secs
2025-03-09 08:37:32,737 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 54.4727 secs
2025-03-09 08:37:32,737 [INFO]: {
2025-03-09 08:37:32,737 [INFO]: 	index_key: HNSW15
2025-03-09 08:37:32,737 [INFO]: 	index_param: efSearch=223
2025-03-09 08:37:32,737 [INFO]: 	index_path: knn.index
2025-03-09 08:37:32,737 [INFO]: 	size in bytes: 800944870
2025-03-09 08:37:32,737 [INFO]: 	avg_search_speed_ms: 9.21581843438717
2025-03-09 08:37:32,737 [INFO]: 	99p_search_speed_ms: 22.280296729877612
2025-03-09 08:37:32,737 [INFO]: 	reconstruction error %: 0.0
2025-03-09 08:37:32,737 [INFO]: 	nb vectors: 4071
2025-03-09 08:37:32,737 [INFO]: 	vectors dimension: 49152
2025-03-09 08:37:32,737 [INFO]: 	compression ratio: 0.9993086889987821
2025-03-09 08:37:32,737 [INFO]: }
2025-03-09 08:37:32,737 [INFO]: 	>>> Finished "Creating the index" in 54.4741 secs
2025-03-09 08:37:32,737 [INFO]: >>> Finished "Launching the whole pipeline" in 54.5018 secs
2025-03-09 08:37:34: [retrieval_preprocessing] calculating distances ...
2025-03-09 08:37:35: [retrieval_preprocessing] finished and saved retrieval indices for episode 55589 [episode count 19/20]
2025-03-09 08:37:35: [retrieval_preprocessing] finished for (3827924651, 'lid') [chosen_id count 5/10]
2025-03-09 08:37:36: [retrieval_preprocessing] concatenated all embeddings and indices for 20 episodes for (6612454114, 'block') [chosen_id count 6/10]
2025-03-09 08:37:36: [retrieval_preprocessing] we have num_total=2995 embedding_dim=49152
[retrieval_preprocessing] for episode 47488 [episode count 0/20], we have num_retrieval=np.int64(2864) num_query=np.int64(131)
2025-03-09 08:37:37,014 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-09 08:37:37,393 [INFO]: Launching the whole pipeline 03/09/2025, 08:37:37
2025-03-09 08:37:37,393 [INFO]: Reading total number of vectors and dimension 03/09/2025, 08:37:37
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1722.51it/s]
2025-03-09 08:37:37,418 [INFO]: There are 2864 embeddings of dim 49152
2025-03-09 08:37:37,419 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0255 secs
2025-03-09 08:37:37,419 [INFO]: 	Compute estimated construction time of the index 03/09/2025, 08:37:37
2025-03-09 08:37:37,419 [INFO]: 		-> Train: 16.7 minutes
2025-03-09 08:37:37,419 [INFO]: 		-> Add: 1.6 seconds
2025-03-09 08:37:37,419 [INFO]: 		Total: 16.7 minutes
2025-03-09 08:37:37,419 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0002 secs
2025-03-09 08:37:37,419 [INFO]: 	Checking that your have enough memory available to create the index 03/09/2025, 08:37:37
2025-03-09 08:37:37,419 [INFO]: 591.1MB of memory will be needed to build the index (more might be used if you have more)
2025-03-09 08:37:37,419 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0002 secs
2025-03-09 08:37:37,419 [INFO]: 	Selecting most promising index types given data characteristics 03/09/2025, 08:37:37
2025-03-09 08:37:37,419 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-09 08:37:37,419 [INFO]: 	Creating the index 03/09/2025, 08:37:37
2025-03-09 08:37:37,419 [INFO]: 		-> Instanciate the index HNSW15 03/09/2025, 08:37:37
2025-03-09 08:37:37,420 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0011 secs
2025-03-09 08:37:37,421 [INFO]: 		-> Adding the vectors to the index 03/09/2025, 08:37:37
2025-03-09 08:37:37,421 [INFO]: The memory available for adding the vectors is 49.5GB(total available - used by the index)
2025-03-09 08:37:37,421 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/12 [00:00<?, ?it/s]  8%|▊         | 1/12 [00:00<00:01,  9.72it/s] 58%|█████▊    | 7/12 [00:00<00:00, 36.43it/s] 92%|█████████▏| 11/12 [00:00<00:00, 35.18it/s]100%|██████████| 12/12 [00:02<00:00,  5.13it/s]
2025-03-09 08:37:39,764 [INFO]: 	Computing best hyperparameters for index knn.index 03/09/2025, 08:37:39
2025-03-09 08:38:09,360 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 29.5955 secs
2025-03-09 08:38:09,361 [INFO]: The best hyperparameters are: efSearch=369
2025-03-09 08:38:09,361 [INFO]: 	Compute fast metrics 03/09/2025, 08:38:09
  0%|          | 0/4 [00:00<?, ?it/s] 50%|█████     | 2/4 [00:00<00:00, 19.88it/s] 75%|███████▌  | 3/4 [00:00<00:00, 21.79it/s]
2025-03-09 08:38:25,835 [INFO]: 	>>> Finished "Compute fast metrics" in 16.4745 secs
2025-03-09 08:38:25,837 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 48.4166 secs
2025-03-09 08:38:25,837 [INFO]: {
2025-03-09 08:38:25,837 [INFO]: 	index_key: HNSW15
2025-03-09 08:38:25,837 [INFO]: 	index_param: efSearch=369
2025-03-09 08:38:25,837 [INFO]: 	index_path: knn.index
2025-03-09 08:38:25,837 [INFO]: 	size in bytes: 563474290
2025-03-09 08:38:25,837 [INFO]: 	avg_search_speed_ms: 11.514449319014512
2025-03-09 08:38:25,837 [INFO]: 	99p_search_speed_ms: 15.203547971323129
2025-03-09 08:38:25,837 [INFO]: 	reconstruction error %: 0.0
2025-03-09 08:38:25,837 [INFO]: 	nb vectors: 2864
2025-03-09 08:38:25,837 [INFO]: 	vectors dimension: 49152
2025-03-09 08:38:25,838 [INFO]: 	compression ratio: 0.999309679240201
2025-03-09 08:38:25,838 [INFO]: }
2025-03-09 08:38:25,838 [INFO]: 	>>> Finished "Creating the index" in 48.4183 secs
2025-03-09 08:38:25,838 [INFO]: >>> Finished "Launching the whole pipeline" in 48.4445 secs
2025-03-09 08:38:27: [retrieval_preprocessing] calculating distances ...
2025-03-09 08:38:27: [retrieval_preprocessing] finished and saved retrieval indices for episode 47488 [episode count 0/20]
[retrieval_preprocessing] for episode 26757 [episode count 1/20], we have num_retrieval=np.int64(2825) num_query=np.int64(170)
2025-03-09 08:38:28,102 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-09 08:38:28,514 [INFO]: Launching the whole pipeline 03/09/2025, 08:38:28
2025-03-09 08:38:28,514 [INFO]: Reading total number of vectors and dimension 03/09/2025, 08:38:28
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1193.26it/s]
2025-03-09 08:38:28,542 [INFO]: There are 2825 embeddings of dim 49152
2025-03-09 08:38:28,542 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0284 secs
2025-03-09 08:38:28,542 [INFO]: 	Compute estimated construction time of the index 03/09/2025, 08:38:28
2025-03-09 08:38:28,542 [INFO]: 		-> Train: 16.7 minutes
2025-03-09 08:38:28,543 [INFO]: 		-> Add: 1.6 seconds
2025-03-09 08:38:28,543 [INFO]: 		Total: 16.7 minutes
2025-03-09 08:38:28,543 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0004 secs
2025-03-09 08:38:28,543 [INFO]: 	Checking that your have enough memory available to create the index 03/09/2025, 08:38:28
2025-03-09 08:38:28,543 [INFO]: 583.0MB of memory will be needed to build the index (more might be used if you have more)
2025-03-09 08:38:28,543 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0004 secs
2025-03-09 08:38:28,544 [INFO]: 	Selecting most promising index types given data characteristics 03/09/2025, 08:38:28
2025-03-09 08:38:28,544 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-09 08:38:28,544 [INFO]: 	Creating the index 03/09/2025, 08:38:28
2025-03-09 08:38:28,544 [INFO]: 		-> Instanciate the index HNSW15 03/09/2025, 08:38:28
2025-03-09 08:38:28,547 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0027 secs
2025-03-09 08:38:28,547 [INFO]: 		-> Adding the vectors to the index 03/09/2025, 08:38:28
2025-03-09 08:38:28,547 [INFO]: The memory available for adding the vectors is 49.5GB(total available - used by the index)
2025-03-09 08:38:28,547 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/12 [00:00<?, ?it/s] 25%|██▌       | 3/12 [00:00<00:00, 26.58it/s] 83%|████████▎ | 10/12 [00:00<00:00, 47.39it/s]100%|██████████| 12/12 [00:01<00:00,  6.59it/s]
2025-03-09 08:38:30,373 [INFO]: 	Computing best hyperparameters for index knn.index 03/09/2025, 08:38:30
2025-03-09 08:38:56,342 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 25.9689 secs
2025-03-09 08:38:56,342 [INFO]: The best hyperparameters are: efSearch=310
2025-03-09 08:38:56,342 [INFO]: 	Compute fast metrics 03/09/2025, 08:38:56
  0%|          | 0/4 [00:00<?, ?it/s] 50%|█████     | 2/4 [00:00<00:00, 18.26it/s] 75%|███████▌  | 3/4 [00:00<00:00, 19.26it/s]
2025-03-09 08:39:12,385 [INFO]: 	>>> Finished "Compute fast metrics" in 16.0427 secs
2025-03-09 08:39:12,387 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 43.8399 secs
2025-03-09 08:39:12,387 [INFO]: {
2025-03-09 08:39:12,387 [INFO]: 	index_key: HNSW15
2025-03-09 08:39:12,387 [INFO]: 	index_param: efSearch=310
2025-03-09 08:39:12,387 [INFO]: 	index_path: knn.index
2025-03-09 08:39:12,387 [INFO]: 	size in bytes: 555801250
2025-03-09 08:39:12,387 [INFO]: 	avg_search_speed_ms: 10.950863322851056
2025-03-09 08:39:12,387 [INFO]: 	99p_search_speed_ms: 15.078728292137384
2025-03-09 08:39:12,387 [INFO]: 	reconstruction error %: 0.0
2025-03-09 08:39:12,387 [INFO]: 	nb vectors: 2825
2025-03-09 08:39:12,387 [INFO]: 	vectors dimension: 49152
2025-03-09 08:39:12,387 [INFO]: 	compression ratio: 0.999309735269577
2025-03-09 08:39:12,387 [INFO]: }
2025-03-09 08:39:12,387 [INFO]: 	>>> Finished "Creating the index" in 43.8434 secs
2025-03-09 08:39:12,387 [INFO]: >>> Finished "Launching the whole pipeline" in 43.8736 secs
2025-03-09 08:39:13: [retrieval_preprocessing] calculating distances ...
2025-03-09 08:39:13: [retrieval_preprocessing] finished and saved retrieval indices for episode 26757 [episode count 1/20]
[retrieval_preprocessing] for episode 42758 [episode count 2/20], we have num_retrieval=np.int64(2876) num_query=np.int64(119)
2025-03-09 08:39:14,140 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-09 08:39:14,519 [INFO]: Launching the whole pipeline 03/09/2025, 08:39:14
2025-03-09 08:39:14,520 [INFO]: Reading total number of vectors and dimension 03/09/2025, 08:39:14
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 2083.61it/s]
2025-03-09 08:39:14,543 [INFO]: There are 2876 embeddings of dim 49152
2025-03-09 08:39:14,543 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0237 secs
2025-03-09 08:39:14,543 [INFO]: 	Compute estimated construction time of the index 03/09/2025, 08:39:14
2025-03-09 08:39:14,543 [INFO]: 		-> Train: 16.7 minutes
2025-03-09 08:39:14,543 [INFO]: 		-> Add: 1.6 seconds
2025-03-09 08:39:14,543 [INFO]: 		Total: 16.7 minutes
2025-03-09 08:39:14,543 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0001 secs
2025-03-09 08:39:14,543 [INFO]: 	Checking that your have enough memory available to create the index 03/09/2025, 08:39:14
2025-03-09 08:39:14,544 [INFO]: 593.5MB of memory will be needed to build the index (more might be used if you have more)
2025-03-09 08:39:14,544 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0001 secs
2025-03-09 08:39:14,544 [INFO]: 	Selecting most promising index types given data characteristics 03/09/2025, 08:39:14
2025-03-09 08:39:14,544 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-09 08:39:14,544 [INFO]: 	Creating the index 03/09/2025, 08:39:14
2025-03-09 08:39:14,544 [INFO]: 		-> Instanciate the index HNSW15 03/09/2025, 08:39:14
2025-03-09 08:39:14,545 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0009 secs
2025-03-09 08:39:14,545 [INFO]: 		-> Adding the vectors to the index 03/09/2025, 08:39:14
2025-03-09 08:39:14,545 [INFO]: The memory available for adding the vectors is 49.5GB(total available - used by the index)
2025-03-09 08:39:14,545 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/12 [00:00<?, ?it/s] 17%|█▋        | 2/12 [00:00<00:00, 17.39it/s] 50%|█████     | 6/12 [00:00<00:00, 29.18it/s]100%|██████████| 12/12 [00:02<00:00,  4.94it/s]100%|██████████| 12/12 [00:02<00:00,  5.79it/s]
2025-03-09 08:39:16,618 [INFO]: 	Computing best hyperparameters for index knn.index 03/09/2025, 08:39:16
2025-03-09 08:39:43,097 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 26.4779 secs
2025-03-09 08:39:43,097 [INFO]: The best hyperparameters are: efSearch=207
2025-03-09 08:39:43,098 [INFO]: 	Compute fast metrics 03/09/2025, 08:39:43
  0%|          | 0/4 [00:00<?, ?it/s] 50%|█████     | 2/4 [00:00<00:00, 17.08it/s] 75%|███████▌  | 3/4 [00:00<00:00, 19.40it/s]
2025-03-09 08:39:58,126 [INFO]: 	>>> Finished "Compute fast metrics" in 15.0286 secs
2025-03-09 08:39:58,128 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 43.5835 secs
2025-03-09 08:39:58,128 [INFO]: {
2025-03-09 08:39:58,129 [INFO]: 	index_key: HNSW15
2025-03-09 08:39:58,129 [INFO]: 	index_param: efSearch=207
2025-03-09 08:39:58,129 [INFO]: 	index_path: knn.index
2025-03-09 08:39:58,129 [INFO]: 	size in bytes: 565835170
2025-03-09 08:39:58,129 [INFO]: 	avg_search_speed_ms: 8.305517482637827
2025-03-09 08:39:58,129 [INFO]: 	99p_search_speed_ms: 16.703043521847587
2025-03-09 08:39:58,129 [INFO]: 	reconstruction error %: 0.0
2025-03-09 08:39:58,129 [INFO]: 	nb vectors: 2876
2025-03-09 08:39:58,129 [INFO]: 	vectors dimension: 49152
2025-03-09 08:39:58,129 [INFO]: 	compression ratio: 0.9993097601197183
2025-03-09 08:39:58,129 [INFO]: }
2025-03-09 08:39:58,129 [INFO]: 	>>> Finished "Creating the index" in 43.5849 secs
2025-03-09 08:39:58,129 [INFO]: >>> Finished "Launching the whole pipeline" in 43.6092 secs
2025-03-09 08:39:58: [retrieval_preprocessing] calculating distances ...
2025-03-09 08:39:59: [retrieval_preprocessing] finished and saved retrieval indices for episode 42758 [episode count 2/20]
[retrieval_preprocessing] for episode 263 [episode count 3/20], we have num_retrieval=np.int64(2827) num_query=np.int64(168)
2025-03-09 08:39:59,391 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-09 08:39:59,863 [INFO]: Launching the whole pipeline 03/09/2025, 08:39:59
2025-03-09 08:39:59,864 [INFO]: Reading total number of vectors and dimension 03/09/2025, 08:39:59
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1159.61it/s]
2025-03-09 08:39:59,890 [INFO]: There are 2827 embeddings of dim 49152
2025-03-09 08:39:59,891 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0270 secs
2025-03-09 08:39:59,891 [INFO]: 	Compute estimated construction time of the index 03/09/2025, 08:39:59
2025-03-09 08:39:59,891 [INFO]: 		-> Train: 16.7 minutes
2025-03-09 08:39:59,891 [INFO]: 		-> Add: 1.6 seconds
2025-03-09 08:39:59,891 [INFO]: 		Total: 16.7 minutes
2025-03-09 08:39:59,891 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0002 secs
2025-03-09 08:39:59,891 [INFO]: 	Checking that your have enough memory available to create the index 03/09/2025, 08:39:59
2025-03-09 08:39:59,891 [INFO]: 583.4MB of memory will be needed to build the index (more might be used if you have more)
2025-03-09 08:39:59,891 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0001 secs
2025-03-09 08:39:59,891 [INFO]: 	Selecting most promising index types given data characteristics 03/09/2025, 08:39:59
2025-03-09 08:39:59,891 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-09 08:39:59,891 [INFO]: 	Creating the index 03/09/2025, 08:39:59
2025-03-09 08:39:59,891 [INFO]: 		-> Instanciate the index HNSW15 03/09/2025, 08:39:59
2025-03-09 08:39:59,892 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0009 secs
2025-03-09 08:39:59,892 [INFO]: 		-> Adding the vectors to the index 03/09/2025, 08:39:59
2025-03-09 08:39:59,892 [INFO]: The memory available for adding the vectors is 49.5GB(total available - used by the index)
2025-03-09 08:39:59,892 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/12 [00:00<?, ?it/s] 17%|█▋        | 2/12 [00:00<00:00, 16.58it/s] 58%|█████▊    | 7/12 [00:00<00:00, 34.43it/s]100%|██████████| 12/12 [00:02<00:00,  4.65it/s]100%|██████████| 12/12 [00:02<00:00,  5.62it/s]
2025-03-09 08:40:02,030 [INFO]: 	Computing best hyperparameters for index knn.index 03/09/2025, 08:40:02
2025-03-09 08:40:31,471 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 29.4408 secs
2025-03-09 08:40:31,471 [INFO]: The best hyperparameters are: efSearch=284
2025-03-09 08:40:31,471 [INFO]: 	Compute fast metrics 03/09/2025, 08:40:31
  0%|          | 0/4 [00:00<?, ?it/s] 50%|█████     | 2/4 [00:00<00:00, 18.21it/s] 75%|███████▌  | 3/4 [00:00<00:00, 19.12it/s]
2025-03-09 08:40:49,746 [INFO]: 	>>> Finished "Compute fast metrics" in 18.2743 secs
2025-03-09 08:40:49,747 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 49.8552 secs
2025-03-09 08:40:49,748 [INFO]: {
2025-03-09 08:40:49,748 [INFO]: 	index_key: HNSW15
2025-03-09 08:40:49,748 [INFO]: 	index_param: efSearch=284
2025-03-09 08:40:49,748 [INFO]: 	index_path: knn.index
2025-03-09 08:40:49,748 [INFO]: 	size in bytes: 556194730
2025-03-09 08:40:49,748 [INFO]: 	avg_search_speed_ms: 11.5200973361031
2025-03-09 08:40:49,748 [INFO]: 	99p_search_speed_ms: 20.30705858021975
2025-03-09 08:40:49,748 [INFO]: 	reconstruction error %: 0.0
2025-03-09 08:40:49,748 [INFO]: 	nb vectors: 2827
2025-03-09 08:40:49,748 [INFO]: 	vectors dimension: 49152
2025-03-09 08:40:49,748 [INFO]: 	compression ratio: 0.999309748943504
2025-03-09 08:40:49,748 [INFO]: }
2025-03-09 08:40:49,748 [INFO]: 	>>> Finished "Creating the index" in 49.8566 secs
2025-03-09 08:40:49,748 [INFO]: >>> Finished "Launching the whole pipeline" in 49.8842 secs
2025-03-09 08:40:50: [retrieval_preprocessing] calculating distances ...
2025-03-09 08:40:51: [retrieval_preprocessing] finished and saved retrieval indices for episode 263 [episode count 3/20]
[retrieval_preprocessing] for episode 35591 [episode count 4/20], we have num_retrieval=np.int64(2841) num_query=np.int64(154)
2025-03-09 08:40:51,663 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-09 08:40:52,184 [INFO]: Launching the whole pipeline 03/09/2025, 08:40:52
2025-03-09 08:40:52,184 [INFO]: Reading total number of vectors and dimension 03/09/2025, 08:40:52
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1035.63it/s]
2025-03-09 08:40:52,386 [INFO]: There are 2841 embeddings of dim 49152
2025-03-09 08:40:52,387 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.2026 secs
2025-03-09 08:40:52,387 [INFO]: 	Compute estimated construction time of the index 03/09/2025, 08:40:52
2025-03-09 08:40:52,387 [INFO]: 		-> Train: 16.7 minutes
2025-03-09 08:40:52,387 [INFO]: 		-> Add: 1.6 seconds
2025-03-09 08:40:52,387 [INFO]: 		Total: 16.7 minutes
2025-03-09 08:40:52,387 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0003 secs
2025-03-09 08:40:52,387 [INFO]: 	Checking that your have enough memory available to create the index 03/09/2025, 08:40:52
2025-03-09 08:40:52,387 [INFO]: 586.3MB of memory will be needed to build the index (more might be used if you have more)
2025-03-09 08:40:52,388 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0003 secs
2025-03-09 08:40:52,388 [INFO]: 	Selecting most promising index types given data characteristics 03/09/2025, 08:40:52
2025-03-09 08:40:52,388 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-09 08:40:52,388 [INFO]: 	Creating the index 03/09/2025, 08:40:52
2025-03-09 08:40:52,388 [INFO]: 		-> Instanciate the index HNSW15 03/09/2025, 08:40:52
2025-03-09 08:40:52,390 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0021 secs
2025-03-09 08:40:52,390 [INFO]: 		-> Adding the vectors to the index 03/09/2025, 08:40:52
2025-03-09 08:40:52,390 [INFO]: The memory available for adding the vectors is 49.5GB(total available - used by the index)
2025-03-09 08:40:52,390 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/12 [00:00<?, ?it/s] 17%|█▋        | 2/12 [00:00<00:00, 19.81it/s] 58%|█████▊    | 7/12 [00:00<00:00, 37.15it/s]100%|██████████| 12/12 [00:02<00:00,  4.33it/s]100%|██████████| 12/12 [00:02<00:00,  5.27it/s]
2025-03-09 08:40:54,671 [INFO]: 	Computing best hyperparameters for index knn.index 03/09/2025, 08:40:54
2025-03-09 08:41:28,422 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 33.7504 secs
2025-03-09 08:41:28,422 [INFO]: The best hyperparameters are: efSearch=265
2025-03-09 08:41:28,422 [INFO]: 	Compute fast metrics 03/09/2025, 08:41:28
  0%|          | 0/4 [00:00<?, ?it/s] 25%|██▌       | 1/4 [00:00<00:00,  9.50it/s] 75%|███████▌  | 3/4 [00:00<00:00, 16.52it/s]
2025-03-09 08:41:46,096 [INFO]: 	>>> Finished "Compute fast metrics" in 17.6744 secs
2025-03-09 08:41:46,098 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 53.7076 secs
2025-03-09 08:41:46,098 [INFO]: {
2025-03-09 08:41:46,098 [INFO]: 	index_key: HNSW15
2025-03-09 08:41:46,098 [INFO]: 	index_param: efSearch=265
2025-03-09 08:41:46,098 [INFO]: 	index_path: knn.index
2025-03-09 08:41:46,098 [INFO]: 	size in bytes: 558949210
2025-03-09 08:41:46,098 [INFO]: 	avg_search_speed_ms: 10.417072286994275
2025-03-09 08:41:46,098 [INFO]: 	99p_search_speed_ms: 24.39245880814268
2025-03-09 08:41:46,098 [INFO]: 	reconstruction error %: 0.0
2025-03-09 08:41:46,098 [INFO]: 	nb vectors: 2841
2025-03-09 08:41:46,098 [INFO]: 	vectors dimension: 49152
2025-03-09 08:41:46,098 [INFO]: 	compression ratio: 0.99930962958155
2025-03-09 08:41:46,098 [INFO]: }
2025-03-09 08:41:46,098 [INFO]: 	>>> Finished "Creating the index" in 53.7103 secs
2025-03-09 08:41:46,098 [INFO]: >>> Finished "Launching the whole pipeline" in 53.9142 secs
2025-03-09 08:41:47: [retrieval_preprocessing] calculating distances ...
2025-03-09 08:41:47: [retrieval_preprocessing] finished and saved retrieval indices for episode 35591 [episode count 4/20]
[retrieval_preprocessing] for episode 44684 [episode count 5/20], we have num_retrieval=np.int64(2829) num_query=np.int64(166)
2025-03-09 08:41:47,851 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-09 08:41:48,557 [INFO]: Launching the whole pipeline 03/09/2025, 08:41:48
2025-03-09 08:41:48,557 [INFO]: Reading total number of vectors and dimension 03/09/2025, 08:41:48
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1810.23it/s]
2025-03-09 08:41:48,583 [INFO]: There are 2829 embeddings of dim 49152
2025-03-09 08:41:48,584 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0267 secs
2025-03-09 08:41:48,584 [INFO]: 	Compute estimated construction time of the index 03/09/2025, 08:41:48
2025-03-09 08:41:48,584 [INFO]: 		-> Train: 16.7 minutes
2025-03-09 08:41:48,584 [INFO]: 		-> Add: 1.6 seconds
2025-03-09 08:41:48,585 [INFO]: 		Total: 16.7 minutes
2025-03-09 08:41:48,585 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0004 secs
2025-03-09 08:41:48,585 [INFO]: 	Checking that your have enough memory available to create the index 03/09/2025, 08:41:48
2025-03-09 08:41:48,585 [INFO]: 583.8MB of memory will be needed to build the index (more might be used if you have more)
2025-03-09 08:41:48,585 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0004 secs
2025-03-09 08:41:48,585 [INFO]: 	Selecting most promising index types given data characteristics 03/09/2025, 08:41:48
2025-03-09 08:41:48,585 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-09 08:41:48,585 [INFO]: 	Creating the index 03/09/2025, 08:41:48
2025-03-09 08:41:48,586 [INFO]: 		-> Instanciate the index HNSW15 03/09/2025, 08:41:48
2025-03-09 08:41:48,588 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0027 secs
2025-03-09 08:41:48,589 [INFO]: 		-> Adding the vectors to the index 03/09/2025, 08:41:48
2025-03-09 08:41:48,589 [INFO]: The memory available for adding the vectors is 49.5GB(total available - used by the index)
2025-03-09 08:41:48,589 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/12 [00:00<?, ?it/s] 17%|█▋        | 2/12 [00:00<00:00, 19.36it/s] 50%|█████     | 6/12 [00:00<00:00, 30.29it/s] 92%|█████████▏| 11/12 [00:00<00:00, 35.77it/s]100%|██████████| 12/12 [00:02<00:00,  5.13it/s]
2025-03-09 08:41:51,497 [INFO]: 	Computing best hyperparameters for index knn.index 03/09/2025, 08:41:51
2025-03-09 08:42:23,662 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 32.1649 secs
2025-03-09 08:42:23,662 [INFO]: The best hyperparameters are: efSearch=267
2025-03-09 08:42:23,662 [INFO]: 	Compute fast metrics 03/09/2025, 08:42:23
  0%|          | 0/4 [00:00<?, ?it/s] 75%|███████▌  | 3/4 [00:00<00:00, 25.42it/s]
2025-03-09 08:42:42,795 [INFO]: 	>>> Finished "Compute fast metrics" in 19.1327 secs
2025-03-09 08:42:43,589 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 54.9999 secs
2025-03-09 08:42:43,589 [INFO]: {
2025-03-09 08:42:43,589 [INFO]: 	index_key: HNSW15
2025-03-09 08:42:43,589 [INFO]: 	index_param: efSearch=267
2025-03-09 08:42:43,589 [INFO]: 	index_path: knn.index
2025-03-09 08:42:43,589 [INFO]: 	size in bytes: 556588210
2025-03-09 08:42:43,589 [INFO]: 	avg_search_speed_ms: 11.197630809056848
2025-03-09 08:42:43,589 [INFO]: 	99p_search_speed_ms: 26.46064865402878
2025-03-09 08:42:43,589 [INFO]: 	reconstruction error %: 0.0
2025-03-09 08:42:43,589 [INFO]: 	nb vectors: 2829
2025-03-09 08:42:43,589 [INFO]: 	vectors dimension: 49152
2025-03-09 08:42:43,589 [INFO]: 	compression ratio: 0.9993097625980975
2025-03-09 08:42:43,590 [INFO]: }
2025-03-09 08:42:43,590 [INFO]: 	>>> Finished "Creating the index" in 55.0041 secs
2025-03-09 08:42:43,590 [INFO]: >>> Finished "Launching the whole pipeline" in 55.0325 secs
2025-03-09 08:42:44: [retrieval_preprocessing] calculating distances ...
2025-03-09 08:42:45: [retrieval_preprocessing] finished and saved retrieval indices for episode 44684 [episode count 5/20]
[retrieval_preprocessing] for episode 69517 [episode count 6/20], we have num_retrieval=np.int64(2856) num_query=np.int64(139)
2025-03-09 08:42:45,760 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-09 08:42:46,440 [INFO]: Launching the whole pipeline 03/09/2025, 08:42:46
2025-03-09 08:42:46,440 [INFO]: Reading total number of vectors and dimension 03/09/2025, 08:42:46
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 2124.77it/s]
2025-03-09 08:42:46,466 [INFO]: There are 2856 embeddings of dim 49152
2025-03-09 08:42:46,466 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0262 secs
2025-03-09 08:42:46,466 [INFO]: 	Compute estimated construction time of the index 03/09/2025, 08:42:46
2025-03-09 08:42:46,466 [INFO]: 		-> Train: 16.7 minutes
2025-03-09 08:42:46,467 [INFO]: 		-> Add: 1.6 seconds
2025-03-09 08:42:46,467 [INFO]: 		Total: 16.7 minutes
2025-03-09 08:42:46,467 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0001 secs
2025-03-09 08:42:46,467 [INFO]: 	Checking that your have enough memory available to create the index 03/09/2025, 08:42:46
2025-03-09 08:42:46,467 [INFO]: 589.4MB of memory will be needed to build the index (more might be used if you have more)
2025-03-09 08:42:46,467 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0003 secs
2025-03-09 08:42:46,467 [INFO]: 	Selecting most promising index types given data characteristics 03/09/2025, 08:42:46
2025-03-09 08:42:46,467 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-09 08:42:46,467 [INFO]: 	Creating the index 03/09/2025, 08:42:46
2025-03-09 08:42:46,467 [INFO]: 		-> Instanciate the index HNSW15 03/09/2025, 08:42:46
2025-03-09 08:42:46,468 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0011 secs
2025-03-09 08:42:46,468 [INFO]: 		-> Adding the vectors to the index 03/09/2025, 08:42:46
2025-03-09 08:42:46,468 [INFO]: The memory available for adding the vectors is 49.5GB(total available - used by the index)
2025-03-09 08:42:46,468 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/12 [00:00<?, ?it/s] 17%|█▋        | 2/12 [00:00<00:00, 16.55it/s] 58%|█████▊    | 7/12 [00:00<00:00, 33.78it/s]100%|██████████| 12/12 [00:02<00:00,  4.18it/s]100%|██████████| 12/12 [00:02<00:00,  5.08it/s]
2025-03-09 08:42:48,832 [INFO]: 	Computing best hyperparameters for index knn.index 03/09/2025, 08:42:48
2025-03-09 08:43:19,649 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 30.8161 secs
2025-03-09 08:43:19,649 [INFO]: The best hyperparameters are: efSearch=267
2025-03-09 08:43:19,649 [INFO]: 	Compute fast metrics 03/09/2025, 08:43:19
  0%|          | 0/4 [00:00<?, ?it/s] 50%|█████     | 2/4 [00:00<00:00, 15.57it/s] 75%|███████▌  | 3/4 [00:00<00:00, 17.86it/s]
2025-03-09 08:43:36,955 [INFO]: 	>>> Finished "Compute fast metrics" in 17.3056 secs
2025-03-09 08:43:36,957 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 50.4884 secs
2025-03-09 08:43:36,957 [INFO]: {
2025-03-09 08:43:36,957 [INFO]: 	index_key: HNSW15
2025-03-09 08:43:36,957 [INFO]: 	index_param: efSearch=267
2025-03-09 08:43:36,957 [INFO]: 	index_path: knn.index
2025-03-09 08:43:36,957 [INFO]: 	size in bytes: 561900310
2025-03-09 08:43:36,957 [INFO]: 	avg_search_speed_ms: 10.509398741894127
2025-03-09 08:43:36,957 [INFO]: 	99p_search_speed_ms: 22.649796090554446
2025-03-09 08:43:36,957 [INFO]: 	reconstruction error %: 0.0
2025-03-09 08:43:36,957 [INFO]: 	nb vectors: 2856
2025-03-09 08:43:36,957 [INFO]: 	vectors dimension: 49152
2025-03-09 08:43:36,957 [INFO]: 	compression ratio: 0.9993097316497298
2025-03-09 08:43:36,957 [INFO]: }
2025-03-09 08:43:36,957 [INFO]: 	>>> Finished "Creating the index" in 50.4901 secs
2025-03-09 08:43:36,957 [INFO]: >>> Finished "Launching the whole pipeline" in 50.5171 secs
2025-03-09 08:43:37: [retrieval_preprocessing] calculating distances ...
2025-03-09 08:43:38: [retrieval_preprocessing] finished and saved retrieval indices for episode 69517 [episode count 6/20]
[retrieval_preprocessing] for episode 60816 [episode count 7/20], we have num_retrieval=np.int64(2762) num_query=np.int64(233)
2025-03-09 08:43:38,687 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-09 08:43:39,072 [INFO]: Launching the whole pipeline 03/09/2025, 08:43:39
2025-03-09 08:43:39,072 [INFO]: Reading total number of vectors and dimension 03/09/2025, 08:43:39
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1790.14it/s]
2025-03-09 08:43:39,095 [INFO]: There are 2762 embeddings of dim 49152
2025-03-09 08:43:39,095 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0232 secs
2025-03-09 08:43:39,096 [INFO]: 	Compute estimated construction time of the index 03/09/2025, 08:43:39
2025-03-09 08:43:39,096 [INFO]: 		-> Train: 16.7 minutes
2025-03-09 08:43:39,096 [INFO]: 		-> Add: 1.5 seconds
2025-03-09 08:43:39,096 [INFO]: 		Total: 16.7 minutes
2025-03-09 08:43:39,096 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0001 secs
2025-03-09 08:43:39,096 [INFO]: 	Checking that your have enough memory available to create the index 03/09/2025, 08:43:39
2025-03-09 08:43:39,096 [INFO]: 570.0MB of memory will be needed to build the index (more might be used if you have more)
2025-03-09 08:43:39,096 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0001 secs
2025-03-09 08:43:39,096 [INFO]: 	Selecting most promising index types given data characteristics 03/09/2025, 08:43:39
2025-03-09 08:43:39,096 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-09 08:43:39,096 [INFO]: 	Creating the index 03/09/2025, 08:43:39
2025-03-09 08:43:39,096 [INFO]: 		-> Instanciate the index HNSW15 03/09/2025, 08:43:39
2025-03-09 08:43:39,097 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0009 secs
2025-03-09 08:43:39,097 [INFO]: 		-> Adding the vectors to the index 03/09/2025, 08:43:39
2025-03-09 08:43:39,097 [INFO]: The memory available for adding the vectors is 49.5GB(total available - used by the index)
2025-03-09 08:43:39,097 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/11 [00:00<?, ?it/s] 18%|█▊        | 2/11 [00:00<00:00, 19.34it/s] 55%|█████▍    | 6/11 [00:00<00:00, 30.67it/s]100%|██████████| 11/11 [00:02<00:00,  4.41it/s]100%|██████████| 11/11 [00:02<00:00,  5.30it/s]
2025-03-09 08:43:41,178 [INFO]: 	Computing best hyperparameters for index knn.index 03/09/2025, 08:43:41
2025-03-09 08:44:09,943 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 28.7649 secs
2025-03-09 08:44:09,943 [INFO]: The best hyperparameters are: efSearch=334
2025-03-09 08:44:09,943 [INFO]: 	Compute fast metrics 03/09/2025, 08:44:09
  0%|          | 0/4 [00:00<?, ?it/s] 50%|█████     | 2/4 [00:00<00:00, 19.46it/s] 75%|███████▌  | 3/4 [00:00<00:00, 21.12it/s]
2025-03-09 08:44:25,225 [INFO]: 	>>> Finished "Compute fast metrics" in 15.2811 secs
2025-03-09 08:44:25,226 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 46.1293 secs
2025-03-09 08:44:25,226 [INFO]: {
2025-03-09 08:44:25,226 [INFO]: 	index_key: HNSW15
2025-03-09 08:44:25,226 [INFO]: 	index_param: efSearch=334
2025-03-09 08:44:25,226 [INFO]: 	index_path: knn.index
2025-03-09 08:44:25,226 [INFO]: 	size in bytes: 543406270
2025-03-09 08:44:25,226 [INFO]: 	avg_search_speed_ms: 11.89678307488676
2025-03-09 08:44:25,226 [INFO]: 	99p_search_speed_ms: 24.884287314489484
2025-03-09 08:44:25,226 [INFO]: 	reconstruction error %: 0.0
2025-03-09 08:44:25,226 [INFO]: 	nb vectors: 2762
2025-03-09 08:44:25,227 [INFO]: 	vectors dimension: 49152
2025-03-09 08:44:25,227 [INFO]: 	compression ratio: 0.9993099564346212
2025-03-09 08:44:25,227 [INFO]: }
2025-03-09 08:44:25,227 [INFO]: 	>>> Finished "Creating the index" in 46.1306 secs
2025-03-09 08:44:25,227 [INFO]: >>> Finished "Launching the whole pipeline" in 46.1543 secs
2025-03-09 08:44:27: [retrieval_preprocessing] calculating distances ...
2025-03-09 08:44:27: [retrieval_preprocessing] finished and saved retrieval indices for episode 60816 [episode count 7/20]
[retrieval_preprocessing] for episode 32529 [episode count 8/20], we have num_retrieval=np.int64(2873) num_query=np.int64(122)
2025-03-09 08:44:28,114 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-09 08:44:28,585 [INFO]: Launching the whole pipeline 03/09/2025, 08:44:28
2025-03-09 08:44:28,585 [INFO]: Reading total number of vectors and dimension 03/09/2025, 08:44:28
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1477.91it/s]
2025-03-09 08:44:28,920 [INFO]: There are 2873 embeddings of dim 49152
2025-03-09 08:44:28,920 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.3354 secs
2025-03-09 08:44:28,920 [INFO]: 	Compute estimated construction time of the index 03/09/2025, 08:44:28
2025-03-09 08:44:28,920 [INFO]: 		-> Train: 16.7 minutes
2025-03-09 08:44:28,921 [INFO]: 		-> Add: 1.6 seconds
2025-03-09 08:44:28,921 [INFO]: 		Total: 16.7 minutes
2025-03-09 08:44:28,921 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0003 secs
2025-03-09 08:44:28,921 [INFO]: 	Checking that your have enough memory available to create the index 03/09/2025, 08:44:28
2025-03-09 08:44:28,921 [INFO]: 592.9MB of memory will be needed to build the index (more might be used if you have more)
2025-03-09 08:44:28,921 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0005 secs
2025-03-09 08:44:28,921 [INFO]: 	Selecting most promising index types given data characteristics 03/09/2025, 08:44:28
2025-03-09 08:44:28,921 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-09 08:44:28,922 [INFO]: 	Creating the index 03/09/2025, 08:44:28
2025-03-09 08:44:28,922 [INFO]: 		-> Instanciate the index HNSW15 03/09/2025, 08:44:28
2025-03-09 08:44:28,925 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0027 secs
2025-03-09 08:44:28,925 [INFO]: 		-> Adding the vectors to the index 03/09/2025, 08:44:28
2025-03-09 08:44:28,925 [INFO]: The memory available for adding the vectors is 49.5GB(total available - used by the index)
2025-03-09 08:44:28,925 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/12 [00:00<?, ?it/s] 25%|██▌       | 3/12 [00:00<00:00, 26.23it/s] 75%|███████▌  | 9/12 [00:00<00:00, 44.70it/s]100%|██████████| 12/12 [00:01<00:00,  6.23it/s]
2025-03-09 08:44:30,858 [INFO]: 	Computing best hyperparameters for index knn.index 03/09/2025, 08:44:30
2025-03-09 08:44:56,411 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 25.5525 secs
2025-03-09 08:44:56,411 [INFO]: The best hyperparameters are: efSearch=285
2025-03-09 08:44:56,411 [INFO]: 	Compute fast metrics 03/09/2025, 08:44:56
  0%|          | 0/4 [00:00<?, ?it/s] 50%|█████     | 2/4 [00:00<00:00, 19.83it/s] 75%|███████▌  | 3/4 [00:00<00:00, 21.74it/s]
2025-03-09 08:45:14,434 [INFO]: 	>>> Finished "Compute fast metrics" in 18.0222 secs
2025-03-09 08:45:14,435 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 45.5102 secs
2025-03-09 08:45:14,435 [INFO]: {
2025-03-09 08:45:14,435 [INFO]: 	index_key: HNSW15
2025-03-09 08:45:14,435 [INFO]: 	index_param: efSearch=285
2025-03-09 08:45:14,435 [INFO]: 	index_path: knn.index
2025-03-09 08:45:14,435 [INFO]: 	size in bytes: 565244950
2025-03-09 08:45:14,435 [INFO]: 	avg_search_speed_ms: 9.894374012993142
2025-03-09 08:45:14,435 [INFO]: 	99p_search_speed_ms: 18.857454578392186
2025-03-09 08:45:14,436 [INFO]: 	reconstruction error %: 0.0
2025-03-09 08:45:14,436 [INFO]: 	nb vectors: 2873
2025-03-09 08:45:14,436 [INFO]: 	vectors dimension: 49152
2025-03-09 08:45:14,436 [INFO]: 	compression ratio: 0.9993097399631788
2025-03-09 08:45:14,436 [INFO]: }
2025-03-09 08:45:14,436 [INFO]: 	>>> Finished "Creating the index" in 45.5138 secs
2025-03-09 08:45:14,436 [INFO]: >>> Finished "Launching the whole pipeline" in 45.8509 secs
2025-03-09 08:45:15: [retrieval_preprocessing] calculating distances ...
2025-03-09 08:45:15: [retrieval_preprocessing] finished and saved retrieval indices for episode 32529 [episode count 8/20]
[retrieval_preprocessing] for episode 1810 [episode count 9/20], we have num_retrieval=np.int64(2853) num_query=np.int64(142)
2025-03-09 08:45:15,857 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-09 08:45:16,211 [INFO]: Launching the whole pipeline 03/09/2025, 08:45:16
2025-03-09 08:45:16,211 [INFO]: Reading total number of vectors and dimension 03/09/2025, 08:45:16
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1734.62it/s]
2025-03-09 08:45:16,238 [INFO]: There are 2853 embeddings of dim 49152
2025-03-09 08:45:16,239 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0272 secs
2025-03-09 08:45:16,239 [INFO]: 	Compute estimated construction time of the index 03/09/2025, 08:45:16
2025-03-09 08:45:16,239 [INFO]: 		-> Train: 16.7 minutes
2025-03-09 08:45:16,239 [INFO]: 		-> Add: 1.6 seconds
2025-03-09 08:45:16,239 [INFO]: 		Total: 16.7 minutes
2025-03-09 08:45:16,239 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0002 secs
2025-03-09 08:45:16,239 [INFO]: 	Checking that your have enough memory available to create the index 03/09/2025, 08:45:16
2025-03-09 08:45:16,239 [INFO]: 588.8MB of memory will be needed to build the index (more might be used if you have more)
2025-03-09 08:45:16,239 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0002 secs
2025-03-09 08:45:16,239 [INFO]: 	Selecting most promising index types given data characteristics 03/09/2025, 08:45:16
2025-03-09 08:45:16,239 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-09 08:45:16,239 [INFO]: 	Creating the index 03/09/2025, 08:45:16
2025-03-09 08:45:16,239 [INFO]: 		-> Instanciate the index HNSW15 03/09/2025, 08:45:16
2025-03-09 08:45:16,240 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0011 secs
2025-03-09 08:45:16,240 [INFO]: 		-> Adding the vectors to the index 03/09/2025, 08:45:16
2025-03-09 08:45:16,240 [INFO]: The memory available for adding the vectors is 49.5GB(total available - used by the index)
2025-03-09 08:45:16,241 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/12 [00:00<?, ?it/s] 17%|█▋        | 2/12 [00:00<00:00, 18.23it/s] 67%|██████▋   | 8/12 [00:00<00:00, 38.59it/s]100%|██████████| 12/12 [00:02<00:00,  4.78it/s]100%|██████████| 12/12 [00:02<00:00,  5.96it/s]
2025-03-09 08:45:18,257 [INFO]: 	Computing best hyperparameters for index knn.index 03/09/2025, 08:45:18
2025-03-09 08:45:52,642 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 34.3855 secs
2025-03-09 08:45:52,643 [INFO]: The best hyperparameters are: efSearch=262
2025-03-09 08:45:52,643 [INFO]: 	Compute fast metrics 03/09/2025, 08:45:52
  0%|          | 0/4 [00:00<?, ?it/s] 75%|███████▌  | 3/4 [00:00<00:00, 26.59it/s] 75%|███████▌  | 3/4 [00:00<00:00, 22.79it/s]
2025-03-09 08:46:12,496 [INFO]: 	>>> Finished "Compute fast metrics" in 19.8531 secs
2025-03-09 08:46:12,498 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 56.2574 secs
2025-03-09 08:46:12,498 [INFO]: {
2025-03-09 08:46:12,498 [INFO]: 	index_key: HNSW15
2025-03-09 08:46:12,498 [INFO]: 	index_param: efSearch=262
2025-03-09 08:46:12,498 [INFO]: 	index_path: knn.index
2025-03-09 08:46:12,498 [INFO]: 	size in bytes: 561310090
2025-03-09 08:46:12,498 [INFO]: 	avg_search_speed_ms: 9.585761422271753
2025-03-09 08:46:12,498 [INFO]: 	99p_search_speed_ms: 17.885246272198845
2025-03-09 08:46:12,498 [INFO]: 	reconstruction error %: 0.0
2025-03-09 08:46:12,498 [INFO]: 	nb vectors: 2853
2025-03-09 08:46:12,498 [INFO]: 	vectors dimension: 49152
2025-03-09 08:46:12,498 [INFO]: 	compression ratio: 0.999309711321954
2025-03-09 08:46:12,498 [INFO]: }
2025-03-09 08:46:12,498 [INFO]: 	>>> Finished "Creating the index" in 56.2590 secs
2025-03-09 08:46:12,498 [INFO]: >>> Finished "Launching the whole pipeline" in 56.2869 secs
2025-03-09 08:46:13: [retrieval_preprocessing] calculating distances ...
2025-03-09 08:46:13: [retrieval_preprocessing] finished and saved retrieval indices for episode 1810 [episode count 9/20]
[retrieval_preprocessing] for episode 22291 [episode count 10/20], we have num_retrieval=np.int64(2859) num_query=np.int64(136)
2025-03-09 08:46:14,056 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-09 08:46:14,910 [INFO]: Launching the whole pipeline 03/09/2025, 08:46:14
2025-03-09 08:46:14,910 [INFO]: Reading total number of vectors and dimension 03/09/2025, 08:46:14
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1757.88it/s]
2025-03-09 08:46:15,302 [INFO]: There are 2859 embeddings of dim 49152
2025-03-09 08:46:15,302 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.3922 secs
2025-03-09 08:46:15,302 [INFO]: 	Compute estimated construction time of the index 03/09/2025, 08:46:15
2025-03-09 08:46:15,302 [INFO]: 		-> Train: 16.7 minutes
2025-03-09 08:46:15,302 [INFO]: 		-> Add: 1.6 seconds
2025-03-09 08:46:15,302 [INFO]: 		Total: 16.7 minutes
2025-03-09 08:46:15,302 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0001 secs
2025-03-09 08:46:15,302 [INFO]: 	Checking that your have enough memory available to create the index 03/09/2025, 08:46:15
2025-03-09 08:46:15,302 [INFO]: 590.0MB of memory will be needed to build the index (more might be used if you have more)
2025-03-09 08:46:15,302 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0001 secs
2025-03-09 08:46:15,302 [INFO]: 	Selecting most promising index types given data characteristics 03/09/2025, 08:46:15
2025-03-09 08:46:15,302 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-09 08:46:15,302 [INFO]: 	Creating the index 03/09/2025, 08:46:15
2025-03-09 08:46:15,303 [INFO]: 		-> Instanciate the index HNSW15 03/09/2025, 08:46:15
2025-03-09 08:46:15,303 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0009 secs
2025-03-09 08:46:15,304 [INFO]: 		-> Adding the vectors to the index 03/09/2025, 08:46:15
2025-03-09 08:46:15,304 [INFO]: The memory available for adding the vectors is 49.5GB(total available - used by the index)
2025-03-09 08:46:15,304 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/12 [00:00<?, ?it/s] 17%|█▋        | 2/12 [00:00<00:00, 16.77it/s] 67%|██████▋   | 8/12 [00:00<00:00, 38.06it/s]100%|██████████| 12/12 [00:02<00:00,  4.27it/s]100%|██████████| 12/12 [00:02<00:00,  5.34it/s]
2025-03-09 08:46:17,552 [INFO]: 	Computing best hyperparameters for index knn.index 03/09/2025, 08:46:17
2025-03-09 08:46:51,487 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 33.9342 secs
2025-03-09 08:46:51,487 [INFO]: The best hyperparameters are: efSearch=252
2025-03-09 08:46:51,487 [INFO]: 	Compute fast metrics 03/09/2025, 08:46:51
  0%|          | 0/4 [00:00<?, ?it/s] 50%|█████     | 2/4 [00:00<00:00, 19.62it/s] 75%|███████▌  | 3/4 [00:00<00:00, 21.09it/s]
2025-03-09 08:47:05,963 [INFO]: 	>>> Finished "Compute fast metrics" in 14.4757 secs
2025-03-09 08:47:05,965 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 50.6610 secs
2025-03-09 08:47:05,965 [INFO]: {
2025-03-09 08:47:05,965 [INFO]: 	index_key: HNSW15
2025-03-09 08:47:05,965 [INFO]: 	index_param: efSearch=252
2025-03-09 08:47:05,965 [INFO]: 	index_path: knn.index
2025-03-09 08:47:05,965 [INFO]: 	size in bytes: 562490530
2025-03-09 08:47:05,965 [INFO]: 	avg_search_speed_ms: 9.959508122021028
2025-03-09 08:47:05,965 [INFO]: 	99p_search_speed_ms: 21.56157734105364
2025-03-09 08:47:05,965 [INFO]: 	reconstruction error %: 0.0
2025-03-09 08:47:05,965 [INFO]: 	nb vectors: 2859
2025-03-09 08:47:05,965 [INFO]: 	vectors dimension: 49152
2025-03-09 08:47:05,965 [INFO]: 	compression ratio: 0.999309751934846
2025-03-09 08:47:05,965 [INFO]: }
2025-03-09 08:47:05,965 [INFO]: 	>>> Finished "Creating the index" in 50.6624 secs
2025-03-09 08:47:05,965 [INFO]: >>> Finished "Launching the whole pipeline" in 51.0552 secs
2025-03-09 08:47:06: [retrieval_preprocessing] calculating distances ...
2025-03-09 08:47:07: [retrieval_preprocessing] finished and saved retrieval indices for episode 22291 [episode count 10/20]
[retrieval_preprocessing] for episode 17686 [episode count 11/20], we have num_retrieval=np.int64(2846) num_query=np.int64(149)
2025-03-09 08:47:07,579 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-09 08:47:07,923 [INFO]: Launching the whole pipeline 03/09/2025, 08:47:07
2025-03-09 08:47:07,923 [INFO]: Reading total number of vectors and dimension 03/09/2025, 08:47:07
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1749.08it/s]
2025-03-09 08:47:07,949 [INFO]: There are 2846 embeddings of dim 49152
2025-03-09 08:47:07,949 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0256 secs
2025-03-09 08:47:07,949 [INFO]: 	Compute estimated construction time of the index 03/09/2025, 08:47:07
2025-03-09 08:47:07,949 [INFO]: 		-> Train: 16.7 minutes
2025-03-09 08:47:07,949 [INFO]: 		-> Add: 1.6 seconds
2025-03-09 08:47:07,949 [INFO]: 		Total: 16.7 minutes
2025-03-09 08:47:07,949 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0001 secs
2025-03-09 08:47:07,949 [INFO]: 	Checking that your have enough memory available to create the index 03/09/2025, 08:47:07
2025-03-09 08:47:07,949 [INFO]: 587.3MB of memory will be needed to build the index (more might be used if you have more)
2025-03-09 08:47:07,949 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0002 secs
2025-03-09 08:47:07,949 [INFO]: 	Selecting most promising index types given data characteristics 03/09/2025, 08:47:07
2025-03-09 08:47:07,949 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-09 08:47:07,950 [INFO]: 	Creating the index 03/09/2025, 08:47:07
2025-03-09 08:47:07,950 [INFO]: 		-> Instanciate the index HNSW15 03/09/2025, 08:47:07
2025-03-09 08:47:07,951 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0011 secs
2025-03-09 08:47:07,951 [INFO]: 		-> Adding the vectors to the index 03/09/2025, 08:47:07
2025-03-09 08:47:07,951 [INFO]: The memory available for adding the vectors is 49.5GB(total available - used by the index)
2025-03-09 08:47:07,951 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/12 [00:00<?, ?it/s]  8%|▊         | 1/12 [00:00<00:01,  9.80it/s] 58%|█████▊    | 7/12 [00:00<00:00, 37.65it/s]100%|██████████| 12/12 [00:02<00:00,  4.47it/s]100%|██████████| 12/12 [00:02<00:00,  5.32it/s]
2025-03-09 08:47:10,209 [INFO]: 	Computing best hyperparameters for index knn.index 03/09/2025, 08:47:10
2025-03-09 08:47:43,050 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 32.8408 secs
2025-03-09 08:47:43,050 [INFO]: The best hyperparameters are: efSearch=256
2025-03-09 08:47:43,050 [INFO]: 	Compute fast metrics 03/09/2025, 08:47:43
  0%|          | 0/4 [00:00<?, ?it/s] 25%|██▌       | 1/4 [00:00<00:00,  8.53it/s] 75%|███████▌  | 3/4 [00:00<00:00, 13.63it/s]
2025-03-09 08:47:59,177 [INFO]: 	>>> Finished "Compute fast metrics" in 16.1267 secs
2025-03-09 08:47:59,179 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 51.2283 secs
2025-03-09 08:47:59,179 [INFO]: {
2025-03-09 08:47:59,179 [INFO]: 	index_key: HNSW15
2025-03-09 08:47:59,179 [INFO]: 	index_param: efSearch=256
2025-03-09 08:47:59,180 [INFO]: 	index_path: knn.index
2025-03-09 08:47:59,180 [INFO]: 	size in bytes: 559932910
2025-03-09 08:47:59,180 [INFO]: 	avg_search_speed_ms: 11.698804995894694
2025-03-09 08:47:59,180 [INFO]: 	99p_search_speed_ms: 24.725949028506875
2025-03-09 08:47:59,180 [INFO]: 	reconstruction error %: 0.0
2025-03-09 08:47:59,180 [INFO]: 	nb vectors: 2846
2025-03-09 08:47:59,180 [INFO]: 	vectors dimension: 49152
2025-03-09 08:47:59,180 [INFO]: 	compression ratio: 0.99930966372382
2025-03-09 08:47:59,180 [INFO]: }
2025-03-09 08:47:59,180 [INFO]: 	>>> Finished "Creating the index" in 51.2301 secs
2025-03-09 08:47:59,180 [INFO]: >>> Finished "Launching the whole pipeline" in 51.2563 secs
2025-03-09 08:48:00: [retrieval_preprocessing] calculating distances ...
2025-03-09 08:48:01: [retrieval_preprocessing] finished and saved retrieval indices for episode 17686 [episode count 11/20]
[retrieval_preprocessing] for episode 22679 [episode count 12/20], we have num_retrieval=np.int64(2825) num_query=np.int64(170)
2025-03-09 08:48:01,484 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-09 08:48:01,994 [INFO]: Launching the whole pipeline 03/09/2025, 08:48:01
2025-03-09 08:48:01,994 [INFO]: Reading total number of vectors and dimension 03/09/2025, 08:48:01
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 2073.31it/s]
2025-03-09 08:48:02,020 [INFO]: There are 2825 embeddings of dim 49152
2025-03-09 08:48:02,020 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0261 secs
2025-03-09 08:48:02,020 [INFO]: 	Compute estimated construction time of the index 03/09/2025, 08:48:02
2025-03-09 08:48:02,020 [INFO]: 		-> Train: 16.7 minutes
2025-03-09 08:48:02,020 [INFO]: 		-> Add: 1.6 seconds
2025-03-09 08:48:02,020 [INFO]: 		Total: 16.7 minutes
2025-03-09 08:48:02,020 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0001 secs
2025-03-09 08:48:02,020 [INFO]: 	Checking that your have enough memory available to create the index 03/09/2025, 08:48:02
2025-03-09 08:48:02,020 [INFO]: 583.0MB of memory will be needed to build the index (more might be used if you have more)
2025-03-09 08:48:02,020 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0002 secs
2025-03-09 08:48:02,020 [INFO]: 	Selecting most promising index types given data characteristics 03/09/2025, 08:48:02
2025-03-09 08:48:02,020 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-09 08:48:02,021 [INFO]: 	Creating the index 03/09/2025, 08:48:02
2025-03-09 08:48:02,021 [INFO]: 		-> Instanciate the index HNSW15 03/09/2025, 08:48:02
2025-03-09 08:48:02,022 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0011 secs
2025-03-09 08:48:02,022 [INFO]: 		-> Adding the vectors to the index 03/09/2025, 08:48:02
2025-03-09 08:48:02,022 [INFO]: The memory available for adding the vectors is 49.5GB(total available - used by the index)
2025-03-09 08:48:02,022 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/12 [00:00<?, ?it/s]  8%|▊         | 1/12 [00:00<00:01,  7.48it/s] 33%|███▎      | 4/12 [00:00<00:00, 18.99it/s] 58%|█████▊    | 7/12 [00:00<00:00, 23.11it/s] 83%|████████▎ | 10/12 [00:00<00:00, 25.18it/s]100%|██████████| 12/12 [00:02<00:00,  4.69it/s]
2025-03-09 08:48:04,585 [INFO]: 	Computing best hyperparameters for index knn.index 03/09/2025, 08:48:04
2025-03-09 08:48:35,522 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 30.9367 secs
2025-03-09 08:48:35,522 [INFO]: The best hyperparameters are: efSearch=205
2025-03-09 08:48:35,522 [INFO]: 	Compute fast metrics 03/09/2025, 08:48:35
  0%|          | 0/4 [00:00<?, ?it/s] 75%|███████▌  | 3/4 [00:00<00:00, 25.70it/s] 75%|███████▌  | 3/4 [00:00<00:00, 22.21it/s]
2025-03-09 08:48:53,348 [INFO]: 	>>> Finished "Compute fast metrics" in 17.8254 secs
2025-03-09 08:48:53,349 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 51.3276 secs
2025-03-09 08:48:53,350 [INFO]: {
2025-03-09 08:48:53,350 [INFO]: 	index_key: HNSW15
2025-03-09 08:48:53,350 [INFO]: 	index_param: efSearch=205
2025-03-09 08:48:53,350 [INFO]: 	index_path: knn.index
2025-03-09 08:48:53,350 [INFO]: 	size in bytes: 555801250
2025-03-09 08:48:53,350 [INFO]: 	avg_search_speed_ms: 8.583336643267087
2025-03-09 08:48:53,350 [INFO]: 	99p_search_speed_ms: 20.44549546204506
2025-03-09 08:48:53,350 [INFO]: 	reconstruction error %: 0.0
2025-03-09 08:48:53,350 [INFO]: 	nb vectors: 2825
2025-03-09 08:48:53,350 [INFO]: 	vectors dimension: 49152
2025-03-09 08:48:53,350 [INFO]: 	compression ratio: 0.999309735269577
2025-03-09 08:48:53,350 [INFO]: }
2025-03-09 08:48:53,350 [INFO]: 	>>> Finished "Creating the index" in 51.3292 secs
2025-03-09 08:48:53,350 [INFO]: >>> Finished "Launching the whole pipeline" in 51.3560 secs
2025-03-09 08:48:53: [retrieval_preprocessing] calculating distances ...
2025-03-09 08:48:54: [retrieval_preprocessing] finished and saved retrieval indices for episode 22679 [episode count 12/20]
[retrieval_preprocessing] for episode 11288 [episode count 13/20], we have num_retrieval=np.int64(2895) num_query=np.int64(100)
2025-03-09 08:48:54,855 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-09 08:48:55,400 [INFO]: Launching the whole pipeline 03/09/2025, 08:48:55
2025-03-09 08:48:55,400 [INFO]: Reading total number of vectors and dimension 03/09/2025, 08:48:55
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1213.28it/s]
2025-03-09 08:48:55,430 [INFO]: There are 2895 embeddings of dim 49152
2025-03-09 08:48:55,430 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0300 secs
2025-03-09 08:48:55,430 [INFO]: 	Compute estimated construction time of the index 03/09/2025, 08:48:55
2025-03-09 08:48:55,430 [INFO]: 		-> Train: 16.7 minutes
2025-03-09 08:48:55,430 [INFO]: 		-> Add: 1.6 seconds
2025-03-09 08:48:55,430 [INFO]: 		Total: 16.7 minutes
2025-03-09 08:48:55,430 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0001 secs
2025-03-09 08:48:55,430 [INFO]: 	Checking that your have enough memory available to create the index 03/09/2025, 08:48:55
2025-03-09 08:48:55,431 [INFO]: 597.5MB of memory will be needed to build the index (more might be used if you have more)
2025-03-09 08:48:55,431 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0002 secs
2025-03-09 08:48:55,431 [INFO]: 	Selecting most promising index types given data characteristics 03/09/2025, 08:48:55
2025-03-09 08:48:55,431 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-09 08:48:55,431 [INFO]: 	Creating the index 03/09/2025, 08:48:55
2025-03-09 08:48:55,431 [INFO]: 		-> Instanciate the index HNSW15 03/09/2025, 08:48:55
2025-03-09 08:48:55,432 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0014 secs
2025-03-09 08:48:55,433 [INFO]: 		-> Adding the vectors to the index 03/09/2025, 08:48:55
2025-03-09 08:48:55,433 [INFO]: The memory available for adding the vectors is 49.5GB(total available - used by the index)
2025-03-09 08:48:55,433 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/12 [00:00<?, ?it/s] 17%|█▋        | 2/12 [00:00<00:00, 19.07it/s] 67%|██████▋   | 8/12 [00:00<00:00, 39.31it/s]100%|██████████| 12/12 [00:02<00:00,  4.01it/s]100%|██████████| 12/12 [00:02<00:00,  5.04it/s]
2025-03-09 08:48:58,099 [INFO]: 	Computing best hyperparameters for index knn.index 03/09/2025, 08:48:58
2025-03-09 08:49:35,730 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 37.6303 secs
2025-03-09 08:49:35,730 [INFO]: The best hyperparameters are: efSearch=230
2025-03-09 08:49:35,730 [INFO]: 	Compute fast metrics 03/09/2025, 08:49:35
  0%|          | 0/4 [00:00<?, ?it/s] 75%|███████▌  | 3/4 [00:00<00:00, 27.01it/s] 75%|███████▌  | 3/4 [00:00<00:00, 23.13it/s]
2025-03-09 08:49:51,171 [INFO]: 	>>> Finished "Compute fast metrics" in 15.4405 secs
2025-03-09 08:49:51,172 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 55.7396 secs
2025-03-09 08:49:51,172 [INFO]: {
2025-03-09 08:49:51,172 [INFO]: 	index_key: HNSW15
2025-03-09 08:49:51,172 [INFO]: 	index_param: efSearch=230
2025-03-09 08:49:51,172 [INFO]: 	index_path: knn.index
2025-03-09 08:49:51,172 [INFO]: 	size in bytes: 569573290
2025-03-09 08:49:51,172 [INFO]: 	avg_search_speed_ms: 8.828095975434712
2025-03-09 08:49:51,172 [INFO]: 	99p_search_speed_ms: 17.125094132497914
2025-03-09 08:49:51,172 [INFO]: 	reconstruction error %: 0.0
2025-03-09 08:49:51,172 [INFO]: 	nb vectors: 2895
2025-03-09 08:49:51,172 [INFO]: 	vectors dimension: 49152
2025-03-09 08:49:51,172 [INFO]: 	compression ratio: 0.9993097815383863
2025-03-09 08:49:51,172 [INFO]: }
2025-03-09 08:49:51,172 [INFO]: 	>>> Finished "Creating the index" in 55.7415 secs
2025-03-09 08:49:51,173 [INFO]: >>> Finished "Launching the whole pipeline" in 55.7725 secs
2025-03-09 08:49:51: [retrieval_preprocessing] calculating distances ...
2025-03-09 08:49:52: [retrieval_preprocessing] finished and saved retrieval indices for episode 11288 [episode count 13/20]
[retrieval_preprocessing] for episode 87577 [episode count 14/20], we have num_retrieval=np.int64(2859) num_query=np.int64(136)
2025-03-09 08:49:52,276 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-09 08:49:52,593 [INFO]: Launching the whole pipeline 03/09/2025, 08:49:52
2025-03-09 08:49:52,593 [INFO]: Reading total number of vectors and dimension 03/09/2025, 08:49:52
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1717.57it/s]
2025-03-09 08:49:52,617 [INFO]: There are 2859 embeddings of dim 49152
2025-03-09 08:49:52,618 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0247 secs
2025-03-09 08:49:52,618 [INFO]: 	Compute estimated construction time of the index 03/09/2025, 08:49:52
2025-03-09 08:49:52,618 [INFO]: 		-> Train: 16.7 minutes
2025-03-09 08:49:52,618 [INFO]: 		-> Add: 1.6 seconds
2025-03-09 08:49:52,618 [INFO]: 		Total: 16.7 minutes
2025-03-09 08:49:52,618 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0001 secs
2025-03-09 08:49:52,618 [INFO]: 	Checking that your have enough memory available to create the index 03/09/2025, 08:49:52
2025-03-09 08:49:52,618 [INFO]: 590.0MB of memory will be needed to build the index (more might be used if you have more)
2025-03-09 08:49:52,618 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0002 secs
2025-03-09 08:49:52,618 [INFO]: 	Selecting most promising index types given data characteristics 03/09/2025, 08:49:52
2025-03-09 08:49:52,618 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-09 08:49:52,618 [INFO]: 	Creating the index 03/09/2025, 08:49:52
2025-03-09 08:49:52,618 [INFO]: 		-> Instanciate the index HNSW15 03/09/2025, 08:49:52
2025-03-09 08:49:52,619 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0011 secs
2025-03-09 08:49:52,620 [INFO]: 		-> Adding the vectors to the index 03/09/2025, 08:49:52
2025-03-09 08:49:52,620 [INFO]: The memory available for adding the vectors is 49.5GB(total available - used by the index)
2025-03-09 08:49:52,620 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/12 [00:00<?, ?it/s]  8%|▊         | 1/12 [00:00<00:01,  7.74it/s] 50%|█████     | 6/12 [00:00<00:00, 28.61it/s]100%|██████████| 12/12 [00:02<00:00,  4.94it/s]100%|██████████| 12/12 [00:02<00:00,  5.66it/s]
2025-03-09 08:49:54,744 [INFO]: 	Computing best hyperparameters for index knn.index 03/09/2025, 08:49:54
2025-03-09 08:50:28,921 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 34.1765 secs
2025-03-09 08:50:28,922 [INFO]: The best hyperparameters are: efSearch=224
2025-03-09 08:50:28,922 [INFO]: 	Compute fast metrics 03/09/2025, 08:50:28
  0%|          | 0/4 [00:00<?, ?it/s] 50%|█████     | 2/4 [00:00<00:00, 16.11it/s] 75%|███████▌  | 3/4 [00:00<00:00, 17.17it/s]
2025-03-09 08:50:44,410 [INFO]: 	>>> Finished "Compute fast metrics" in 15.4882 secs
2025-03-09 08:50:44,412 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 51.7923 secs
2025-03-09 08:50:44,412 [INFO]: {
2025-03-09 08:50:44,412 [INFO]: 	index_key: HNSW15
2025-03-09 08:50:44,412 [INFO]: 	index_param: efSearch=224
2025-03-09 08:50:44,412 [INFO]: 	index_path: knn.index
2025-03-09 08:50:44,412 [INFO]: 	size in bytes: 562490530
2025-03-09 08:50:44,412 [INFO]: 	avg_search_speed_ms: 9.805580696511065
2025-03-09 08:50:44,412 [INFO]: 	99p_search_speed_ms: 23.00457336939871
2025-03-09 08:50:44,412 [INFO]: 	reconstruction error %: 0.0
2025-03-09 08:50:44,412 [INFO]: 	nb vectors: 2859
2025-03-09 08:50:44,412 [INFO]: 	vectors dimension: 49152
2025-03-09 08:50:44,412 [INFO]: 	compression ratio: 0.999309751934846
2025-03-09 08:50:44,412 [INFO]: }
2025-03-09 08:50:44,412 [INFO]: 	>>> Finished "Creating the index" in 51.7940 secs
2025-03-09 08:50:44,412 [INFO]: >>> Finished "Launching the whole pipeline" in 51.8194 secs
2025-03-09 08:50:45: [retrieval_preprocessing] calculating distances ...
2025-03-09 08:50:45: [retrieval_preprocessing] finished and saved retrieval indices for episode 87577 [episode count 14/20]
[retrieval_preprocessing] for episode 7450 [episode count 15/20], we have num_retrieval=np.int64(2826) num_query=np.int64(169)
2025-03-09 08:50:45,709 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-09 08:50:46,074 [INFO]: Launching the whole pipeline 03/09/2025, 08:50:46
2025-03-09 08:50:46,074 [INFO]: Reading total number of vectors and dimension 03/09/2025, 08:50:46
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1018.03it/s]
2025-03-09 08:50:46,101 [INFO]: There are 2826 embeddings of dim 49152
2025-03-09 08:50:46,101 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0275 secs
2025-03-09 08:50:46,102 [INFO]: 	Compute estimated construction time of the index 03/09/2025, 08:50:46
2025-03-09 08:50:46,102 [INFO]: 		-> Train: 16.7 minutes
2025-03-09 08:50:46,102 [INFO]: 		-> Add: 1.6 seconds
2025-03-09 08:50:46,102 [INFO]: 		Total: 16.7 minutes
2025-03-09 08:50:46,102 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0001 secs
2025-03-09 08:50:46,102 [INFO]: 	Checking that your have enough memory available to create the index 03/09/2025, 08:50:46
2025-03-09 08:50:46,102 [INFO]: 583.2MB of memory will be needed to build the index (more might be used if you have more)
2025-03-09 08:50:46,102 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0002 secs
2025-03-09 08:50:46,102 [INFO]: 	Selecting most promising index types given data characteristics 03/09/2025, 08:50:46
2025-03-09 08:50:46,102 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-09 08:50:46,102 [INFO]: 	Creating the index 03/09/2025, 08:50:46
2025-03-09 08:50:46,102 [INFO]: 		-> Instanciate the index HNSW15 03/09/2025, 08:50:46
2025-03-09 08:50:46,103 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0012 secs
2025-03-09 08:50:46,103 [INFO]: 		-> Adding the vectors to the index 03/09/2025, 08:50:46
2025-03-09 08:50:46,104 [INFO]: The memory available for adding the vectors is 49.5GB(total available - used by the index)
2025-03-09 08:50:46,104 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/12 [00:00<?, ?it/s]  8%|▊         | 1/12 [00:00<00:01,  8.74it/s] 42%|████▏     | 5/12 [00:00<00:00, 24.46it/s] 92%|█████████▏| 11/12 [00:00<00:00, 36.76it/s]100%|██████████| 12/12 [00:02<00:00,  4.87it/s]
2025-03-09 08:50:48,570 [INFO]: 	Computing best hyperparameters for index knn.index 03/09/2025, 08:50:48
2025-03-09 08:51:23,838 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 35.2676 secs
2025-03-09 08:51:23,838 [INFO]: The best hyperparameters are: efSearch=228
2025-03-09 08:51:23,838 [INFO]: 	Compute fast metrics 03/09/2025, 08:51:23
  0%|          | 0/4 [00:00<?, ?it/s] 75%|███████▌  | 3/4 [00:00<00:00, 27.74it/s] 75%|███████▌  | 3/4 [00:00<00:00, 24.26it/s]
2025-03-09 08:51:41,685 [INFO]: 	>>> Finished "Compute fast metrics" in 17.8467 secs
2025-03-09 08:51:41,686 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 55.5829 secs
2025-03-09 08:51:41,687 [INFO]: {
2025-03-09 08:51:41,687 [INFO]: 	index_key: HNSW15
2025-03-09 08:51:41,687 [INFO]: 	index_param: efSearch=228
2025-03-09 08:51:41,687 [INFO]: 	index_path: knn.index
2025-03-09 08:51:41,687 [INFO]: 	size in bytes: 555997990
2025-03-09 08:51:41,687 [INFO]: 	avg_search_speed_ms: 8.910091675622073
2025-03-09 08:51:41,687 [INFO]: 	99p_search_speed_ms: 20.11200290871782
2025-03-09 08:51:41,687 [INFO]: 	reconstruction error %: 0.0
2025-03-09 08:51:41,687 [INFO]: 	nb vectors: 2826
2025-03-09 08:51:41,687 [INFO]: 	vectors dimension: 49152
2025-03-09 08:51:41,687 [INFO]: 	compression ratio: 0.9993097421089597
2025-03-09 08:51:41,687 [INFO]: }
2025-03-09 08:51:41,687 [INFO]: 	>>> Finished "Creating the index" in 55.5847 secs
2025-03-09 08:51:41,687 [INFO]: >>> Finished "Launching the whole pipeline" in 55.6129 secs
2025-03-09 08:51:42: [retrieval_preprocessing] calculating distances ...
2025-03-09 08:51:43: [retrieval_preprocessing] finished and saved retrieval indices for episode 7450 [episode count 15/20]
[retrieval_preprocessing] for episode 78236 [episode count 16/20], we have num_retrieval=np.int64(2846) num_query=np.int64(149)
2025-03-09 08:51:43,376 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-09 08:51:43,699 [INFO]: Launching the whole pipeline 03/09/2025, 08:51:43
2025-03-09 08:51:43,699 [INFO]: Reading total number of vectors and dimension 03/09/2025, 08:51:43
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1567.38it/s]
2025-03-09 08:51:43,725 [INFO]: There are 2846 embeddings of dim 49152
2025-03-09 08:51:43,725 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0259 secs
2025-03-09 08:51:43,725 [INFO]: 	Compute estimated construction time of the index 03/09/2025, 08:51:43
2025-03-09 08:51:43,725 [INFO]: 		-> Train: 16.7 minutes
2025-03-09 08:51:43,725 [INFO]: 		-> Add: 1.6 seconds
2025-03-09 08:51:43,725 [INFO]: 		Total: 16.7 minutes
2025-03-09 08:51:43,725 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0001 secs
2025-03-09 08:51:43,725 [INFO]: 	Checking that your have enough memory available to create the index 03/09/2025, 08:51:43
2025-03-09 08:51:43,726 [INFO]: 587.3MB of memory will be needed to build the index (more might be used if you have more)
2025-03-09 08:51:43,726 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0001 secs
2025-03-09 08:51:43,726 [INFO]: 	Selecting most promising index types given data characteristics 03/09/2025, 08:51:43
2025-03-09 08:51:43,726 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-09 08:51:43,726 [INFO]: 	Creating the index 03/09/2025, 08:51:43
2025-03-09 08:51:43,726 [INFO]: 		-> Instanciate the index HNSW15 03/09/2025, 08:51:43
2025-03-09 08:51:43,727 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0009 secs
2025-03-09 08:51:43,727 [INFO]: 		-> Adding the vectors to the index 03/09/2025, 08:51:43
2025-03-09 08:51:43,727 [INFO]: The memory available for adding the vectors is 49.5GB(total available - used by the index)
2025-03-09 08:51:43,727 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/12 [00:00<?, ?it/s]  8%|▊         | 1/12 [00:00<00:01,  9.31it/s] 58%|█████▊    | 7/12 [00:00<00:00, 36.62it/s]100%|██████████| 12/12 [00:02<00:00,  4.76it/s]100%|██████████| 12/12 [00:02<00:00,  5.65it/s]
2025-03-09 08:51:45,853 [INFO]: 	Computing best hyperparameters for index knn.index 03/09/2025, 08:51:45
2025-03-09 08:52:16,077 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 30.2242 secs
2025-03-09 08:52:16,077 [INFO]: The best hyperparameters are: efSearch=331
2025-03-09 08:52:16,078 [INFO]: 	Compute fast metrics 03/09/2025, 08:52:16
  0%|          | 0/4 [00:00<?, ?it/s] 50%|█████     | 2/4 [00:00<00:00, 18.85it/s] 75%|███████▌  | 3/4 [00:00<00:00, 20.50it/s]
2025-03-09 08:52:33,438 [INFO]: 	>>> Finished "Compute fast metrics" in 17.3604 secs
2025-03-09 08:52:33,440 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 49.7129 secs
2025-03-09 08:52:33,440 [INFO]: {
2025-03-09 08:52:33,440 [INFO]: 	index_key: HNSW15
2025-03-09 08:52:33,440 [INFO]: 	index_param: efSearch=331
2025-03-09 08:52:33,440 [INFO]: 	index_path: knn.index
2025-03-09 08:52:33,440 [INFO]: 	size in bytes: 559932910
2025-03-09 08:52:33,440 [INFO]: 	avg_search_speed_ms: 11.374203910500826
2025-03-09 08:52:33,440 [INFO]: 	99p_search_speed_ms: 20.176188594196
2025-03-09 08:52:33,440 [INFO]: 	reconstruction error %: 0.0
2025-03-09 08:52:33,440 [INFO]: 	nb vectors: 2846
2025-03-09 08:52:33,440 [INFO]: 	vectors dimension: 49152
2025-03-09 08:52:33,440 [INFO]: 	compression ratio: 0.99930966372382
2025-03-09 08:52:33,440 [INFO]: }
2025-03-09 08:52:33,440 [INFO]: 	>>> Finished "Creating the index" in 49.7143 secs
2025-03-09 08:52:33,440 [INFO]: >>> Finished "Launching the whole pipeline" in 49.7408 secs
2025-03-09 08:52:34: [retrieval_preprocessing] calculating distances ...
2025-03-09 08:52:34: [retrieval_preprocessing] finished and saved retrieval indices for episode 78236 [episode count 16/20]
[retrieval_preprocessing] for episode 33954 [episode count 17/20], we have num_retrieval=np.int64(2821) num_query=np.int64(174)
2025-03-09 08:52:35,017 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-09 08:52:35,398 [INFO]: Launching the whole pipeline 03/09/2025, 08:52:35
2025-03-09 08:52:35,398 [INFO]: Reading total number of vectors and dimension 03/09/2025, 08:52:35
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 2626.36it/s]
2025-03-09 08:52:35,424 [INFO]: There are 2821 embeddings of dim 49152
2025-03-09 08:52:35,424 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0264 secs
2025-03-09 08:52:35,424 [INFO]: 	Compute estimated construction time of the index 03/09/2025, 08:52:35
2025-03-09 08:52:35,424 [INFO]: 		-> Train: 16.7 minutes
2025-03-09 08:52:35,425 [INFO]: 		-> Add: 1.5 seconds
2025-03-09 08:52:35,425 [INFO]: 		Total: 16.7 minutes
2025-03-09 08:52:35,425 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0005 secs
2025-03-09 08:52:35,425 [INFO]: 	Checking that your have enough memory available to create the index 03/09/2025, 08:52:35
2025-03-09 08:52:35,425 [INFO]: 582.2MB of memory will be needed to build the index (more might be used if you have more)
2025-03-09 08:52:35,426 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0004 secs
2025-03-09 08:52:35,426 [INFO]: 	Selecting most promising index types given data characteristics 03/09/2025, 08:52:35
2025-03-09 08:52:35,426 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-09 08:52:35,426 [INFO]: 	Creating the index 03/09/2025, 08:52:35
2025-03-09 08:52:35,426 [INFO]: 		-> Instanciate the index HNSW15 03/09/2025, 08:52:35
2025-03-09 08:52:35,429 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0026 secs
2025-03-09 08:52:35,429 [INFO]: 		-> Adding the vectors to the index 03/09/2025, 08:52:35
2025-03-09 08:52:35,429 [INFO]: The memory available for adding the vectors is 49.5GB(total available - used by the index)
2025-03-09 08:52:35,429 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/12 [00:00<?, ?it/s] 17%|█▋        | 2/12 [00:00<00:00, 19.91it/s] 67%|██████▋   | 8/12 [00:00<00:00, 41.46it/s]100%|██████████| 12/12 [00:01<00:00,  6.12it/s]
2025-03-09 08:52:37,395 [INFO]: 	Computing best hyperparameters for index knn.index 03/09/2025, 08:52:37
2025-03-09 08:53:07,232 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 29.8364 secs
2025-03-09 08:53:07,232 [INFO]: The best hyperparameters are: efSearch=177
2025-03-09 08:53:07,232 [INFO]: 	Compute fast metrics 03/09/2025, 08:53:07
  0%|          | 0/4 [00:00<?, ?it/s] 50%|█████     | 2/4 [00:00<00:00, 16.60it/s] 75%|███████▌  | 3/4 [00:00<00:00, 14.97it/s]
2025-03-09 08:53:21,785 [INFO]: 	>>> Finished "Compute fast metrics" in 14.5525 secs
2025-03-09 08:53:21,786 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 46.3572 secs
2025-03-09 08:53:21,786 [INFO]: {
2025-03-09 08:53:21,786 [INFO]: 	index_key: HNSW15
2025-03-09 08:53:21,786 [INFO]: 	index_param: efSearch=177
2025-03-09 08:53:21,786 [INFO]: 	index_path: knn.index
2025-03-09 08:53:21,786 [INFO]: 	size in bytes: 555014230
2025-03-09 08:53:21,786 [INFO]: 	avg_search_speed_ms: 7.727346157041915
2025-03-09 08:53:21,786 [INFO]: 	99p_search_speed_ms: 18.047775151207993
2025-03-09 08:53:21,786 [INFO]: 	reconstruction error %: 0.0
2025-03-09 08:53:21,786 [INFO]: 	nb vectors: 2821
2025-03-09 08:53:21,786 [INFO]: 	vectors dimension: 49152
2025-03-09 08:53:21,786 [INFO]: 	compression ratio: 0.9993098158942699
2025-03-09 08:53:21,787 [INFO]: }
2025-03-09 08:53:21,787 [INFO]: 	>>> Finished "Creating the index" in 46.3607 secs
2025-03-09 08:53:21,787 [INFO]: >>> Finished "Launching the whole pipeline" in 46.3889 secs
2025-03-09 08:53:22: [retrieval_preprocessing] calculating distances ...
2025-03-09 08:53:23: [retrieval_preprocessing] finished and saved retrieval indices for episode 33954 [episode count 17/20]
[retrieval_preprocessing] for episode 56612 [episode count 18/20], we have num_retrieval=np.int64(2858) num_query=np.int64(137)
2025-03-09 08:53:23,313 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-09 08:53:23,763 [INFO]: Launching the whole pipeline 03/09/2025, 08:53:23
2025-03-09 08:53:23,764 [INFO]: Reading total number of vectors and dimension 03/09/2025, 08:53:23
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 2123.70it/s]
2025-03-09 08:53:23,790 [INFO]: There are 2858 embeddings of dim 49152
2025-03-09 08:53:23,790 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0266 secs
2025-03-09 08:53:23,790 [INFO]: 	Compute estimated construction time of the index 03/09/2025, 08:53:23
2025-03-09 08:53:23,790 [INFO]: 		-> Train: 16.7 minutes
2025-03-09 08:53:23,790 [INFO]: 		-> Add: 1.6 seconds
2025-03-09 08:53:23,791 [INFO]: 		Total: 16.7 minutes
2025-03-09 08:53:23,791 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0001 secs
2025-03-09 08:53:23,791 [INFO]: 	Checking that your have enough memory available to create the index 03/09/2025, 08:53:23
2025-03-09 08:53:23,791 [INFO]: 589.8MB of memory will be needed to build the index (more might be used if you have more)
2025-03-09 08:53:23,791 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0002 secs
2025-03-09 08:53:23,791 [INFO]: 	Selecting most promising index types given data characteristics 03/09/2025, 08:53:23
2025-03-09 08:53:23,791 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-09 08:53:23,791 [INFO]: 	Creating the index 03/09/2025, 08:53:23
2025-03-09 08:53:23,791 [INFO]: 		-> Instanciate the index HNSW15 03/09/2025, 08:53:23
2025-03-09 08:53:23,792 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0010 secs
2025-03-09 08:53:23,792 [INFO]: 		-> Adding the vectors to the index 03/09/2025, 08:53:23
2025-03-09 08:53:23,792 [INFO]: The memory available for adding the vectors is 49.5GB(total available - used by the index)
2025-03-09 08:53:23,792 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/12 [00:00<?, ?it/s]  8%|▊         | 1/12 [00:00<00:01,  9.81it/s] 58%|█████▊    | 7/12 [00:00<00:00, 37.76it/s]100%|██████████| 12/12 [00:02<00:00,  4.92it/s]100%|██████████| 12/12 [00:02<00:00,  5.84it/s]
2025-03-09 08:53:25,851 [INFO]: 	Computing best hyperparameters for index knn.index 03/09/2025, 08:53:25
2025-03-09 08:53:55,722 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 29.8709 secs
2025-03-09 08:53:55,722 [INFO]: The best hyperparameters are: efSearch=257
2025-03-09 08:53:55,723 [INFO]: 	Compute fast metrics 03/09/2025, 08:53:55
  0%|          | 0/4 [00:00<?, ?it/s] 75%|███████▌  | 3/4 [00:00<00:00, 26.14it/s] 75%|███████▌  | 3/4 [00:00<00:00, 22.44it/s]
2025-03-09 08:54:13,959 [INFO]: 	>>> Finished "Compute fast metrics" in 18.2366 secs
2025-03-09 08:54:13,961 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 50.1691 secs
2025-03-09 08:54:13,961 [INFO]: {
2025-03-09 08:54:13,961 [INFO]: 	index_key: HNSW15
2025-03-09 08:54:13,961 [INFO]: 	index_param: efSearch=257
2025-03-09 08:54:13,961 [INFO]: 	index_path: knn.index
2025-03-09 08:54:13,961 [INFO]: 	size in bytes: 562293790
2025-03-09 08:54:13,961 [INFO]: 	avg_search_speed_ms: 9.864468529776357
2025-03-09 08:54:13,961 [INFO]: 	99p_search_speed_ms: 20.649733217433095
2025-03-09 08:54:13,961 [INFO]: 	reconstruction error %: 0.0
2025-03-09 08:54:13,961 [INFO]: 	nb vectors: 2858
2025-03-09 08:54:13,961 [INFO]: 	vectors dimension: 49152
2025-03-09 08:54:13,962 [INFO]: 	compression ratio: 0.9993097451778722
2025-03-09 08:54:13,962 [INFO]: }
2025-03-09 08:54:13,962 [INFO]: 	>>> Finished "Creating the index" in 50.1705 secs
2025-03-09 08:54:13,962 [INFO]: >>> Finished "Launching the whole pipeline" in 50.1980 secs
2025-03-09 08:54:14: [retrieval_preprocessing] calculating distances ...
2025-03-09 08:54:15: [retrieval_preprocessing] finished and saved retrieval indices for episode 56612 [episode count 18/20]
[retrieval_preprocessing] for episode 69970 [episode count 19/20], we have num_retrieval=np.int64(2864) num_query=np.int64(131)
2025-03-09 08:54:15,550 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-09 08:54:15,918 [INFO]: Launching the whole pipeline 03/09/2025, 08:54:15
2025-03-09 08:54:15,918 [INFO]: Reading total number of vectors and dimension 03/09/2025, 08:54:15
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1535.25it/s]
2025-03-09 08:54:15,944 [INFO]: There are 2864 embeddings of dim 49152
2025-03-09 08:54:15,944 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0262 secs
2025-03-09 08:54:15,944 [INFO]: 	Compute estimated construction time of the index 03/09/2025, 08:54:15
2025-03-09 08:54:15,944 [INFO]: 		-> Train: 16.7 minutes
2025-03-09 08:54:15,944 [INFO]: 		-> Add: 1.6 seconds
2025-03-09 08:54:15,944 [INFO]: 		Total: 16.7 minutes
2025-03-09 08:54:15,944 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0001 secs
2025-03-09 08:54:15,944 [INFO]: 	Checking that your have enough memory available to create the index 03/09/2025, 08:54:15
2025-03-09 08:54:15,945 [INFO]: 591.1MB of memory will be needed to build the index (more might be used if you have more)
2025-03-09 08:54:15,945 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0001 secs
2025-03-09 08:54:15,945 [INFO]: 	Selecting most promising index types given data characteristics 03/09/2025, 08:54:15
2025-03-09 08:54:15,945 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-09 08:54:15,945 [INFO]: 	Creating the index 03/09/2025, 08:54:15
2025-03-09 08:54:15,945 [INFO]: 		-> Instanciate the index HNSW15 03/09/2025, 08:54:15
2025-03-09 08:54:15,946 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0009 secs
2025-03-09 08:54:15,946 [INFO]: 		-> Adding the vectors to the index 03/09/2025, 08:54:15
2025-03-09 08:54:15,946 [INFO]: The memory available for adding the vectors is 49.5GB(total available - used by the index)
2025-03-09 08:54:15,946 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/12 [00:00<?, ?it/s]  8%|▊         | 1/12 [00:00<00:01,  6.91it/s] 58%|█████▊    | 7/12 [00:00<00:00, 30.39it/s]100%|██████████| 12/12 [00:02<00:00,  4.69it/s]100%|██████████| 12/12 [00:02<00:00,  5.51it/s]
2025-03-09 08:54:18,127 [INFO]: 	Computing best hyperparameters for index knn.index 03/09/2025, 08:54:18
2025-03-09 08:54:47,398 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 29.2710 secs
2025-03-09 08:54:47,398 [INFO]: The best hyperparameters are: efSearch=285
2025-03-09 08:54:47,399 [INFO]: 	Compute fast metrics 03/09/2025, 08:54:47
  0%|          | 0/4 [00:00<?, ?it/s] 25%|██▌       | 1/4 [00:00<00:00,  9.81it/s] 75%|███████▌  | 3/4 [00:00<00:00, 18.60it/s]
2025-03-09 08:55:02,884 [INFO]: 	>>> Finished "Compute fast metrics" in 15.4857 secs
2025-03-09 08:55:02,886 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 46.9401 secs
2025-03-09 08:55:02,886 [INFO]: {
2025-03-09 08:55:02,886 [INFO]: 	index_key: HNSW15
2025-03-09 08:55:02,886 [INFO]: 	index_param: efSearch=285
2025-03-09 08:55:02,886 [INFO]: 	index_path: knn.index
2025-03-09 08:55:02,886 [INFO]: 	size in bytes: 563474290
2025-03-09 08:55:02,886 [INFO]: 	avg_search_speed_ms: 11.284515202259875
2025-03-09 08:55:02,886 [INFO]: 	99p_search_speed_ms: 26.201504212804135
2025-03-09 08:55:02,886 [INFO]: 	reconstruction error %: 0.0
2025-03-09 08:55:02,886 [INFO]: 	nb vectors: 2864
2025-03-09 08:55:02,886 [INFO]: 	vectors dimension: 49152
2025-03-09 08:55:02,886 [INFO]: 	compression ratio: 0.999309679240201
2025-03-09 08:55:02,886 [INFO]: }
2025-03-09 08:55:02,886 [INFO]: 	>>> Finished "Creating the index" in 46.9414 secs
2025-03-09 08:55:02,886 [INFO]: >>> Finished "Launching the whole pipeline" in 46.9682 secs
2025-03-09 08:55:03: [retrieval_preprocessing] calculating distances ...
2025-03-09 08:55:04: [retrieval_preprocessing] finished and saved retrieval indices for episode 69970 [episode count 19/20]
2025-03-09 08:55:04: [retrieval_preprocessing] finished for (6612454114, 'block') [chosen_id count 6/10]
2025-03-09 08:55:05: [retrieval_preprocessing] concatenated all embeddings and indices for 20 episodes for (2782099537, 'marker') [chosen_id count 7/10]
2025-03-09 08:55:05: [retrieval_preprocessing] we have num_total=2662 embedding_dim=49152
[retrieval_preprocessing] for episode 14978 [episode count 0/20], we have num_retrieval=np.int64(2531) num_query=np.int64(131)
2025-03-09 08:55:06,068 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-09 08:55:06,456 [INFO]: Launching the whole pipeline 03/09/2025, 08:55:06
2025-03-09 08:55:06,456 [INFO]: Reading total number of vectors and dimension 03/09/2025, 08:55:06
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1568.55it/s]
2025-03-09 08:55:06,481 [INFO]: There are 2531 embeddings of dim 49152
2025-03-09 08:55:06,481 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0254 secs
2025-03-09 08:55:06,481 [INFO]: 	Compute estimated construction time of the index 03/09/2025, 08:55:06
2025-03-09 08:55:06,481 [INFO]: 		-> Train: 16.7 minutes
2025-03-09 08:55:06,482 [INFO]: 		-> Add: 1.4 seconds
2025-03-09 08:55:06,482 [INFO]: 		Total: 16.7 minutes
2025-03-09 08:55:06,482 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0001 secs
2025-03-09 08:55:06,482 [INFO]: 	Checking that your have enough memory available to create the index 03/09/2025, 08:55:06
2025-03-09 08:55:06,482 [INFO]: 522.3MB of memory will be needed to build the index (more might be used if you have more)
2025-03-09 08:55:06,482 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0001 secs
2025-03-09 08:55:06,482 [INFO]: 	Selecting most promising index types given data characteristics 03/09/2025, 08:55:06
2025-03-09 08:55:06,482 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-09 08:55:06,482 [INFO]: 	Creating the index 03/09/2025, 08:55:06
2025-03-09 08:55:06,482 [INFO]: 		-> Instanciate the index HNSW15 03/09/2025, 08:55:06
2025-03-09 08:55:06,483 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0010 secs
2025-03-09 08:55:06,483 [INFO]: 		-> Adding the vectors to the index 03/09/2025, 08:55:06
2025-03-09 08:55:06,483 [INFO]: The memory available for adding the vectors is 49.5GB(total available - used by the index)
2025-03-09 08:55:06,483 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/10 [00:00<?, ?it/s] 20%|██        | 2/10 [00:00<00:00, 16.72it/s] 70%|███████   | 7/10 [00:00<00:00, 31.11it/s]100%|██████████| 10/10 [00:02<00:00,  4.60it/s]
2025-03-09 08:55:08,661 [INFO]: 	Computing best hyperparameters for index knn.index 03/09/2025, 08:55:08
2025-03-09 08:55:39,204 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 30.5424 secs
2025-03-09 08:55:39,204 [INFO]: The best hyperparameters are: efSearch=237
2025-03-09 08:55:39,204 [INFO]: 	Compute fast metrics 03/09/2025, 08:55:39
  0%|          | 0/4 [00:00<?, ?it/s] 75%|███████▌  | 3/4 [00:00<00:00, 25.83it/s] 75%|███████▌  | 3/4 [00:00<00:00, 22.36it/s]
2025-03-09 08:55:52,815 [INFO]: 	>>> Finished "Compute fast metrics" in 13.6103 secs
2025-03-09 08:55:52,816 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 46.3333 secs
2025-03-09 08:55:52,817 [INFO]: {
2025-03-09 08:55:52,817 [INFO]: 	index_key: HNSW15
2025-03-09 08:55:52,817 [INFO]: 	index_param: efSearch=237
2025-03-09 08:55:52,817 [INFO]: 	index_path: knn.index
2025-03-09 08:55:52,817 [INFO]: 	size in bytes: 497958610
2025-03-09 08:55:52,817 [INFO]: 	avg_search_speed_ms: 9.591483380886604
2025-03-09 08:55:52,817 [INFO]: 	99p_search_speed_ms: 19.87203049473464
2025-03-09 08:55:52,817 [INFO]: 	reconstruction error %: 0.0
2025-03-09 08:55:52,817 [INFO]: 	nb vectors: 2531
2025-03-09 08:55:52,817 [INFO]: 	vectors dimension: 49152
2025-03-09 08:55:52,817 [INFO]: 	compression ratio: 0.99930965748338
2025-03-09 08:55:52,817 [INFO]: }
2025-03-09 08:55:52,817 [INFO]: 	>>> Finished "Creating the index" in 46.3351 secs
2025-03-09 08:55:52,817 [INFO]: >>> Finished "Launching the whole pipeline" in 46.3611 secs
2025-03-09 08:55:53: [retrieval_preprocessing] calculating distances ...
2025-03-09 08:55:54: [retrieval_preprocessing] finished and saved retrieval indices for episode 14978 [episode count 0/20]
[retrieval_preprocessing] for episode 38277 [episode count 1/20], we have num_retrieval=np.int64(2537) num_query=np.int64(125)
2025-03-09 08:55:54,289 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-09 08:55:54,610 [INFO]: Launching the whole pipeline 03/09/2025, 08:55:54
2025-03-09 08:55:54,610 [INFO]: Reading total number of vectors and dimension 03/09/2025, 08:55:54
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 2428.66it/s]
2025-03-09 08:55:54,634 [INFO]: There are 2537 embeddings of dim 49152
2025-03-09 08:55:54,634 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0244 secs
2025-03-09 08:55:54,635 [INFO]: 	Compute estimated construction time of the index 03/09/2025, 08:55:54
2025-03-09 08:55:54,635 [INFO]: 		-> Train: 16.7 minutes
2025-03-09 08:55:54,635 [INFO]: 		-> Add: 1.4 seconds
2025-03-09 08:55:54,635 [INFO]: 		Total: 16.7 minutes
2025-03-09 08:55:54,635 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0005 secs
2025-03-09 08:55:54,635 [INFO]: 	Checking that your have enough memory available to create the index 03/09/2025, 08:55:54
2025-03-09 08:55:54,635 [INFO]: 523.6MB of memory will be needed to build the index (more might be used if you have more)
2025-03-09 08:55:54,636 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0004 secs
2025-03-09 08:55:54,636 [INFO]: 	Selecting most promising index types given data characteristics 03/09/2025, 08:55:54
2025-03-09 08:55:54,636 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-09 08:55:54,636 [INFO]: 	Creating the index 03/09/2025, 08:55:54
2025-03-09 08:55:54,636 [INFO]: 		-> Instanciate the index HNSW15 03/09/2025, 08:55:54
2025-03-09 08:55:54,639 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0026 secs
2025-03-09 08:55:54,639 [INFO]: 		-> Adding the vectors to the index 03/09/2025, 08:55:54
2025-03-09 08:55:54,639 [INFO]: The memory available for adding the vectors is 49.5GB(total available - used by the index)
2025-03-09 08:55:54,639 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/10 [00:00<?, ?it/s] 30%|███       | 3/10 [00:00<00:00, 28.42it/s] 90%|█████████ | 9/10 [00:00<00:00, 43.45it/s]100%|██████████| 10/10 [00:01<00:00,  5.71it/s]
2025-03-09 08:55:56,396 [INFO]: 	Computing best hyperparameters for index knn.index 03/09/2025, 08:55:56
2025-03-09 08:56:27,812 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 31.4162 secs
2025-03-09 08:56:27,812 [INFO]: The best hyperparameters are: efSearch=237
2025-03-09 08:56:27,812 [INFO]: 	Compute fast metrics 03/09/2025, 08:56:27
  0%|          | 0/4 [00:00<?, ?it/s] 75%|███████▌  | 3/4 [00:00<00:00, 25.41it/s] 75%|███████▌  | 3/4 [00:00<00:00, 21.88it/s]
2025-03-09 08:56:41,227 [INFO]: 	>>> Finished "Compute fast metrics" in 13.4147 secs
2025-03-09 08:56:41,229 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 46.5894 secs
2025-03-09 08:56:41,229 [INFO]: {
2025-03-09 08:56:41,229 [INFO]: 	index_key: HNSW15
2025-03-09 08:56:41,229 [INFO]: 	index_param: efSearch=237
2025-03-09 08:56:41,229 [INFO]: 	index_path: knn.index
2025-03-09 08:56:41,229 [INFO]: 	size in bytes: 499139050
2025-03-09 08:56:41,229 [INFO]: 	avg_search_speed_ms: 9.49276779408603
2025-03-09 08:56:41,229 [INFO]: 	99p_search_speed_ms: 18.91651746816933
2025-03-09 08:56:41,229 [INFO]: 	reconstruction error %: 0.0
2025-03-09 08:56:41,229 [INFO]: 	nb vectors: 2537
2025-03-09 08:56:41,229 [INFO]: 	vectors dimension: 49152
2025-03-09 08:56:41,229 [INFO]: 	compression ratio: 0.999309703378247
2025-03-09 08:56:41,229 [INFO]: }
2025-03-09 08:56:41,229 [INFO]: 	>>> Finished "Creating the index" in 46.5929 secs
2025-03-09 08:56:41,229 [INFO]: >>> Finished "Launching the whole pipeline" in 46.6190 secs
2025-03-09 08:56:42: [retrieval_preprocessing] calculating distances ...
2025-03-09 08:56:42: [retrieval_preprocessing] finished and saved retrieval indices for episode 38277 [episode count 1/20]
[retrieval_preprocessing] for episode 25735 [episode count 2/20], we have num_retrieval=np.int64(2554) num_query=np.int64(108)
2025-03-09 08:56:42,727 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-09 08:56:43,053 [INFO]: Launching the whole pipeline 03/09/2025, 08:56:43
2025-03-09 08:56:43,053 [INFO]: Reading total number of vectors and dimension 03/09/2025, 08:56:43
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1789.38it/s]
2025-03-09 08:56:43,076 [INFO]: There are 2554 embeddings of dim 49152
2025-03-09 08:56:43,077 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0232 secs
2025-03-09 08:56:43,077 [INFO]: 	Compute estimated construction time of the index 03/09/2025, 08:56:43
2025-03-09 08:56:43,077 [INFO]: 		-> Train: 16.7 minutes
2025-03-09 08:56:43,077 [INFO]: 		-> Add: 1.4 seconds
2025-03-09 08:56:43,077 [INFO]: 		Total: 16.7 minutes
2025-03-09 08:56:43,077 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0001 secs
2025-03-09 08:56:43,077 [INFO]: 	Checking that your have enough memory available to create the index 03/09/2025, 08:56:43
2025-03-09 08:56:43,077 [INFO]: 527.1MB of memory will be needed to build the index (more might be used if you have more)
2025-03-09 08:56:43,077 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0001 secs
2025-03-09 08:56:43,077 [INFO]: 	Selecting most promising index types given data characteristics 03/09/2025, 08:56:43
2025-03-09 08:56:43,077 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-09 08:56:43,077 [INFO]: 	Creating the index 03/09/2025, 08:56:43
2025-03-09 08:56:43,077 [INFO]: 		-> Instanciate the index HNSW15 03/09/2025, 08:56:43
2025-03-09 08:56:43,078 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0010 secs
2025-03-09 08:56:43,078 [INFO]: 		-> Adding the vectors to the index 03/09/2025, 08:56:43
2025-03-09 08:56:43,078 [INFO]: The memory available for adding the vectors is 49.5GB(total available - used by the index)
2025-03-09 08:56:43,078 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/11 [00:00<?, ?it/s] 18%|█▊        | 2/11 [00:00<00:00, 19.01it/s] 73%|███████▎  | 8/11 [00:00<00:00, 39.84it/s]100%|██████████| 11/11 [00:01<00:00,  6.06it/s]
2025-03-09 08:56:44,896 [INFO]: 	Computing best hyperparameters for index knn.index 03/09/2025, 08:56:44
2025-03-09 08:57:20,634 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 35.7375 secs
2025-03-09 08:57:20,635 [INFO]: The best hyperparameters are: efSearch=245
2025-03-09 08:57:20,635 [INFO]: 	Compute fast metrics 03/09/2025, 08:57:20
  0%|          | 0/4 [00:00<?, ?it/s] 50%|█████     | 2/4 [00:00<00:00, 19.54it/s] 75%|███████▌  | 3/4 [00:00<00:00, 19.03it/s]
2025-03-09 08:57:36,549 [INFO]: 	>>> Finished "Compute fast metrics" in 15.9144 secs
2025-03-09 08:57:36,551 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 53.4724 secs
2025-03-09 08:57:36,551 [INFO]: {
2025-03-09 08:57:36,551 [INFO]: 	index_key: HNSW15
2025-03-09 08:57:36,551 [INFO]: 	index_param: efSearch=245
2025-03-09 08:57:36,551 [INFO]: 	index_path: knn.index
2025-03-09 08:57:36,551 [INFO]: 	size in bytes: 502483750
2025-03-09 08:57:36,551 [INFO]: 	avg_search_speed_ms: 9.64658038525437
2025-03-09 08:57:36,551 [INFO]: 	99p_search_speed_ms: 18.268276266753713
2025-03-09 08:57:36,551 [INFO]: 	reconstruction error %: 0.0
2025-03-09 08:57:36,551 [INFO]: 	nb vectors: 2554
2025-03-09 08:57:36,551 [INFO]: 	vectors dimension: 49152
2025-03-09 08:57:36,551 [INFO]: 	compression ratio: 0.9993095935938227
2025-03-09 08:57:36,551 [INFO]: }
2025-03-09 08:57:36,551 [INFO]: 	>>> Finished "Creating the index" in 53.4743 secs
2025-03-09 08:57:36,552 [INFO]: >>> Finished "Launching the whole pipeline" in 53.4981 secs
2025-03-09 08:57:37: [retrieval_preprocessing] calculating distances ...
2025-03-09 08:57:37: [retrieval_preprocessing] finished and saved retrieval indices for episode 25735 [episode count 2/20]
[retrieval_preprocessing] for episode 3720 [episode count 3/20], we have num_retrieval=np.int64(2540) num_query=np.int64(122)
2025-03-09 08:57:37,808 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-09 08:57:38,156 [INFO]: Launching the whole pipeline 03/09/2025, 08:57:38
2025-03-09 08:57:38,156 [INFO]: Reading total number of vectors and dimension 03/09/2025, 08:57:38
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1806.33it/s]
2025-03-09 08:57:38,188 [INFO]: There are 2540 embeddings of dim 49152
2025-03-09 08:57:38,189 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0330 secs
2025-03-09 08:57:38,189 [INFO]: 	Compute estimated construction time of the index 03/09/2025, 08:57:38
2025-03-09 08:57:38,189 [INFO]: 		-> Train: 16.7 minutes
2025-03-09 08:57:38,189 [INFO]: 		-> Add: 1.4 seconds
2025-03-09 08:57:38,189 [INFO]: 		Total: 16.7 minutes
2025-03-09 08:57:38,189 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0001 secs
2025-03-09 08:57:38,189 [INFO]: 	Checking that your have enough memory available to create the index 03/09/2025, 08:57:38
2025-03-09 08:57:38,189 [INFO]: 524.2MB of memory will be needed to build the index (more might be used if you have more)
2025-03-09 08:57:38,189 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0002 secs
2025-03-09 08:57:38,189 [INFO]: 	Selecting most promising index types given data characteristics 03/09/2025, 08:57:38
2025-03-09 08:57:38,189 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-09 08:57:38,189 [INFO]: 	Creating the index 03/09/2025, 08:57:38
2025-03-09 08:57:38,189 [INFO]: 		-> Instanciate the index HNSW15 03/09/2025, 08:57:38
2025-03-09 08:57:38,191 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0012 secs
2025-03-09 08:57:38,191 [INFO]: 		-> Adding the vectors to the index 03/09/2025, 08:57:38
2025-03-09 08:57:38,191 [INFO]: The memory available for adding the vectors is 49.5GB(total available - used by the index)
2025-03-09 08:57:38,191 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/10 [00:00<?, ?it/s] 10%|█         | 1/10 [00:00<00:00,  9.93it/s] 70%|███████   | 7/10 [00:00<00:00, 35.98it/s]100%|██████████| 10/10 [00:01<00:00,  5.69it/s]
2025-03-09 08:57:39,952 [INFO]: 	Computing best hyperparameters for index knn.index 03/09/2025, 08:57:39
2025-03-09 08:58:04,837 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 24.8847 secs
2025-03-09 08:58:04,837 [INFO]: The best hyperparameters are: efSearch=255
2025-03-09 08:58:04,837 [INFO]: 	Compute fast metrics 03/09/2025, 08:58:04
  0%|          | 0/4 [00:00<?, ?it/s] 50%|█████     | 2/4 [00:00<00:00, 13.69it/s] 75%|███████▌  | 3/4 [00:00<00:00, 15.01it/s]
2025-03-09 08:58:19,318 [INFO]: 	>>> Finished "Compute fast metrics" in 14.4805 secs
2025-03-09 08:58:19,319 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 41.1285 secs
2025-03-09 08:58:19,320 [INFO]: {
2025-03-09 08:58:19,320 [INFO]: 	index_key: HNSW15
2025-03-09 08:58:19,320 [INFO]: 	index_param: efSearch=255
2025-03-09 08:58:19,320 [INFO]: 	index_path: knn.index
2025-03-09 08:58:19,320 [INFO]: 	size in bytes: 499729270
2025-03-09 08:58:19,320 [INFO]: 	avg_search_speed_ms: 10.54634048885129
2025-03-09 08:58:19,320 [INFO]: 	99p_search_speed_ms: 22.131872763857242
2025-03-09 08:58:19,320 [INFO]: 	reconstruction error %: 0.0
2025-03-09 08:58:19,320 [INFO]: 	nb vectors: 2540
2025-03-09 08:58:19,320 [INFO]: 	vectors dimension: 49152
2025-03-09 08:58:19,320 [INFO]: 	compression ratio: 0.9993097262443723
2025-03-09 08:58:19,320 [INFO]: }
2025-03-09 08:58:19,320 [INFO]: 	>>> Finished "Creating the index" in 41.1303 secs
2025-03-09 08:58:19,320 [INFO]: >>> Finished "Launching the whole pipeline" in 41.1640 secs
2025-03-09 08:58:20: [retrieval_preprocessing] calculating distances ...
2025-03-09 08:58:20: [retrieval_preprocessing] finished and saved retrieval indices for episode 3720 [episode count 3/20]
[retrieval_preprocessing] for episode 265 [episode count 4/20], we have num_retrieval=np.int64(2440) num_query=np.int64(222)
2025-03-09 08:58:20,829 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-09 08:58:21,200 [INFO]: Launching the whole pipeline 03/09/2025, 08:58:21
2025-03-09 08:58:21,201 [INFO]: Reading total number of vectors and dimension 03/09/2025, 08:58:21
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 2105.57it/s]
2025-03-09 08:58:21,224 [INFO]: There are 2440 embeddings of dim 49152
2025-03-09 08:58:21,225 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0240 secs
2025-03-09 08:58:21,225 [INFO]: 	Compute estimated construction time of the index 03/09/2025, 08:58:21
2025-03-09 08:58:21,225 [INFO]: 		-> Train: 16.7 minutes
2025-03-09 08:58:21,225 [INFO]: 		-> Add: 1.3 seconds
2025-03-09 08:58:21,225 [INFO]: 		Total: 16.7 minutes
2025-03-09 08:58:21,225 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0001 secs
2025-03-09 08:58:21,225 [INFO]: 	Checking that your have enough memory available to create the index 03/09/2025, 08:58:21
2025-03-09 08:58:21,225 [INFO]: 503.6MB of memory will be needed to build the index (more might be used if you have more)
2025-03-09 08:58:21,225 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0001 secs
2025-03-09 08:58:21,225 [INFO]: 	Selecting most promising index types given data characteristics 03/09/2025, 08:58:21
2025-03-09 08:58:21,225 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-09 08:58:21,225 [INFO]: 	Creating the index 03/09/2025, 08:58:21
2025-03-09 08:58:21,225 [INFO]: 		-> Instanciate the index HNSW15 03/09/2025, 08:58:21
2025-03-09 08:58:21,226 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0008 secs
2025-03-09 08:58:21,226 [INFO]: 		-> Adding the vectors to the index 03/09/2025, 08:58:21
2025-03-09 08:58:21,226 [INFO]: The memory available for adding the vectors is 49.6GB(total available - used by the index)
2025-03-09 08:58:21,226 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/10 [00:00<?, ?it/s] 10%|█         | 1/10 [00:00<00:01,  8.38it/s] 50%|█████     | 5/10 [00:00<00:00, 22.18it/s] 90%|█████████ | 9/10 [00:00<00:00, 29.07it/s]100%|██████████| 10/10 [00:01<00:00,  5.69it/s]
2025-03-09 08:58:22,988 [INFO]: 	Computing best hyperparameters for index knn.index 03/09/2025, 08:58:22
2025-03-09 08:58:46,547 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 23.5594 secs
2025-03-09 08:58:46,548 [INFO]: The best hyperparameters are: efSearch=310
2025-03-09 08:58:46,548 [INFO]: 	Compute fast metrics 03/09/2025, 08:58:46
  0%|          | 0/4 [00:00<?, ?it/s] 50%|█████     | 2/4 [00:00<00:00, 17.84it/s] 75%|███████▌  | 3/4 [00:00<00:00, 18.97it/s]
2025-03-09 08:59:01,396 [INFO]: 	>>> Finished "Compute fast metrics" in 14.8477 secs
2025-03-09 08:59:02,003 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 40.7767 secs
2025-03-09 08:59:02,003 [INFO]: {
2025-03-09 08:59:02,003 [INFO]: 	index_key: HNSW15
2025-03-09 08:59:02,003 [INFO]: 	index_param: efSearch=310
2025-03-09 08:59:02,003 [INFO]: 	index_path: knn.index
2025-03-09 08:59:02,003 [INFO]: 	size in bytes: 480054790
2025-03-09 08:59:02,003 [INFO]: 	avg_search_speed_ms: 12.077487274331766
2025-03-09 08:59:02,004 [INFO]: 	99p_search_speed_ms: 25.262958619277924
2025-03-09 08:59:02,004 [INFO]: 	reconstruction error %: 0.0
2025-03-09 08:59:02,004 [INFO]: 	nb vectors: 2440
2025-03-09 08:59:02,004 [INFO]: 	vectors dimension: 49152
2025-03-09 08:59:02,004 [INFO]: 	compression ratio: 0.9993099329349469
2025-03-09 08:59:02,004 [INFO]: }
2025-03-09 08:59:02,004 [INFO]: 	>>> Finished "Creating the index" in 40.7787 secs
2025-03-09 08:59:02,004 [INFO]: >>> Finished "Launching the whole pipeline" in 40.8033 secs
2025-03-09 08:59:03: [retrieval_preprocessing] calculating distances ...
2025-03-09 08:59:03: [retrieval_preprocessing] finished and saved retrieval indices for episode 265 [episode count 4/20]
[retrieval_preprocessing] for episode 78217 [episode count 5/20], we have num_retrieval=np.int64(2558) num_query=np.int64(104)
2025-03-09 08:59:04,120 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-09 08:59:04,404 [INFO]: Launching the whole pipeline 03/09/2025, 08:59:04
2025-03-09 08:59:04,404 [INFO]: Reading total number of vectors and dimension 03/09/2025, 08:59:04
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 2309.64it/s]
2025-03-09 08:59:04,426 [INFO]: There are 2558 embeddings of dim 49152
2025-03-09 08:59:04,426 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0217 secs
2025-03-09 08:59:04,426 [INFO]: 	Compute estimated construction time of the index 03/09/2025, 08:59:04
2025-03-09 08:59:04,426 [INFO]: 		-> Train: 16.7 minutes
2025-03-09 08:59:04,426 [INFO]: 		-> Add: 1.4 seconds
2025-03-09 08:59:04,426 [INFO]: 		Total: 16.7 minutes
2025-03-09 08:59:04,426 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0001 secs
2025-03-09 08:59:04,426 [INFO]: 	Checking that your have enough memory available to create the index 03/09/2025, 08:59:04
2025-03-09 08:59:04,426 [INFO]: 527.9MB of memory will be needed to build the index (more might be used if you have more)
2025-03-09 08:59:04,426 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0001 secs
2025-03-09 08:59:04,426 [INFO]: 	Selecting most promising index types given data characteristics 03/09/2025, 08:59:04
2025-03-09 08:59:04,426 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-09 08:59:04,426 [INFO]: 	Creating the index 03/09/2025, 08:59:04
2025-03-09 08:59:04,426 [INFO]: 		-> Instanciate the index HNSW15 03/09/2025, 08:59:04
2025-03-09 08:59:04,427 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0008 secs
2025-03-09 08:59:04,427 [INFO]: 		-> Adding the vectors to the index 03/09/2025, 08:59:04
2025-03-09 08:59:04,427 [INFO]: The memory available for adding the vectors is 49.5GB(total available - used by the index)
2025-03-09 08:59:04,427 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/11 [00:00<?, ?it/s] 27%|██▋       | 3/11 [00:00<00:00, 27.45it/s] 91%|█████████ | 10/11 [00:00<00:00, 49.09it/s]100%|██████████| 11/11 [00:01<00:00,  6.61it/s]
2025-03-09 08:59:06,095 [INFO]: 	Computing best hyperparameters for index knn.index 03/09/2025, 08:59:06
2025-03-09 08:59:33,037 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 26.9416 secs
2025-03-09 08:59:33,037 [INFO]: The best hyperparameters are: efSearch=302
2025-03-09 08:59:33,037 [INFO]: 	Compute fast metrics 03/09/2025, 08:59:33
  0%|          | 0/4 [00:00<?, ?it/s] 50%|█████     | 2/4 [00:00<00:00, 19.33it/s] 75%|███████▌  | 3/4 [00:00<00:00, 21.36it/s]
2025-03-09 08:59:51,828 [INFO]: 	>>> Finished "Compute fast metrics" in 18.7906 secs
2025-03-09 08:59:51,830 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 47.4023 secs
2025-03-09 08:59:51,830 [INFO]: {
2025-03-09 08:59:51,830 [INFO]: 	index_key: HNSW15
2025-03-09 08:59:51,830 [INFO]: 	index_param: efSearch=302
2025-03-09 08:59:51,830 [INFO]: 	index_path: knn.index
2025-03-09 08:59:51,830 [INFO]: 	size in bytes: 503270710
2025-03-09 08:59:51,830 [INFO]: 	avg_search_speed_ms: 10.782014206754333
2025-03-09 08:59:51,830 [INFO]: 	99p_search_speed_ms: 16.813388101290933
2025-03-09 08:59:51,830 [INFO]: 	reconstruction error %: 0.0
2025-03-09 08:59:51,830 [INFO]: 	nb vectors: 2558
2025-03-09 08:59:51,830 [INFO]: 	vectors dimension: 49152
2025-03-09 08:59:51,830 [INFO]: 	compression ratio: 0.999309624039118
2025-03-09 08:59:51,830 [INFO]: }
2025-03-09 08:59:51,830 [INFO]: 	>>> Finished "Creating the index" in 47.4036 secs
2025-03-09 08:59:51,830 [INFO]: >>> Finished "Launching the whole pipeline" in 47.4258 secs
2025-03-09 08:59:52: [retrieval_preprocessing] calculating distances ...
2025-03-09 08:59:53: [retrieval_preprocessing] finished and saved retrieval indices for episode 78217 [episode count 5/20]
[retrieval_preprocessing] for episode 53517 [episode count 6/20], we have num_retrieval=np.int64(2542) num_query=np.int64(120)
2025-03-09 08:59:53,356 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-09 08:59:53,711 [INFO]: Launching the whole pipeline 03/09/2025, 08:59:53
2025-03-09 08:59:53,711 [INFO]: Reading total number of vectors and dimension 03/09/2025, 08:59:53
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1496.36it/s]
2025-03-09 08:59:53,738 [INFO]: There are 2542 embeddings of dim 49152
2025-03-09 08:59:53,739 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0271 secs
2025-03-09 08:59:53,739 [INFO]: 	Compute estimated construction time of the index 03/09/2025, 08:59:53
2025-03-09 08:59:53,739 [INFO]: 		-> Train: 16.7 minutes
2025-03-09 08:59:53,739 [INFO]: 		-> Add: 1.4 seconds
2025-03-09 08:59:53,739 [INFO]: 		Total: 16.7 minutes
2025-03-09 08:59:53,739 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0003 secs
2025-03-09 08:59:53,739 [INFO]: 	Checking that your have enough memory available to create the index 03/09/2025, 08:59:53
2025-03-09 08:59:53,740 [INFO]: 524.6MB of memory will be needed to build the index (more might be used if you have more)
2025-03-09 08:59:53,740 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0004 secs
2025-03-09 08:59:53,740 [INFO]: 	Selecting most promising index types given data characteristics 03/09/2025, 08:59:53
2025-03-09 08:59:53,740 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-09 08:59:53,740 [INFO]: 	Creating the index 03/09/2025, 08:59:53
2025-03-09 08:59:53,740 [INFO]: 		-> Instanciate the index HNSW15 03/09/2025, 08:59:53
2025-03-09 08:59:53,743 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0026 secs
2025-03-09 08:59:53,743 [INFO]: 		-> Adding the vectors to the index 03/09/2025, 08:59:53
2025-03-09 08:59:53,743 [INFO]: The memory available for adding the vectors is 49.5GB(total available - used by the index)
2025-03-09 08:59:53,743 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/11 [00:00<?, ?it/s] 27%|██▋       | 3/11 [00:00<00:00, 25.58it/s] 82%|████████▏ | 9/11 [00:00<00:00, 41.95it/s]100%|██████████| 11/11 [00:02<00:00,  5.03it/s]
2025-03-09 08:59:55,935 [INFO]: 	Computing best hyperparameters for index knn.index 03/09/2025, 08:59:55
2025-03-09 09:00:21,601 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 25.6651 secs
2025-03-09 09:00:21,601 [INFO]: The best hyperparameters are: efSearch=241
2025-03-09 09:00:21,601 [INFO]: 	Compute fast metrics 03/09/2025, 09:00:21
  0%|          | 0/4 [00:00<?, ?it/s] 50%|█████     | 2/4 [00:00<00:00, 17.68it/s] 75%|███████▌  | 3/4 [00:00<00:00, 18.89it/s]
2025-03-09 09:00:35,431 [INFO]: 	>>> Finished "Compute fast metrics" in 13.8294 secs
2025-03-09 09:00:35,432 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 41.6892 secs
2025-03-09 09:00:35,433 [INFO]: {
2025-03-09 09:00:35,433 [INFO]: 	index_key: HNSW15
2025-03-09 09:00:35,433 [INFO]: 	index_param: efSearch=241
2025-03-09 09:00:35,433 [INFO]: 	index_path: knn.index
2025-03-09 09:00:35,433 [INFO]: 	size in bytes: 500122750
2025-03-09 09:00:35,433 [INFO]: 	avg_search_speed_ms: 10.292870310420716
2025-03-09 09:00:35,433 [INFO]: 	99p_search_speed_ms: 20.487629768904288
2025-03-09 09:00:35,433 [INFO]: 	reconstruction error %: 0.0
2025-03-09 09:00:35,433 [INFO]: 	nb vectors: 2542
2025-03-09 09:00:35,433 [INFO]: 	vectors dimension: 49152
2025-03-09 09:00:35,433 [INFO]: 	compression ratio: 0.999309741458472
2025-03-09 09:00:35,433 [INFO]: }
2025-03-09 09:00:35,433 [INFO]: 	>>> Finished "Creating the index" in 41.6926 secs
2025-03-09 09:00:35,433 [INFO]: >>> Finished "Launching the whole pipeline" in 41.7213 secs
2025-03-09 09:00:36: [retrieval_preprocessing] calculating distances ...
2025-03-09 09:00:36: [retrieval_preprocessing] finished and saved retrieval indices for episode 53517 [episode count 6/20]
[retrieval_preprocessing] for episode 77581 [episode count 7/20], we have num_retrieval=np.int64(2517) num_query=np.int64(145)
2025-03-09 09:00:36,742 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-09 09:00:37,863 [INFO]: Launching the whole pipeline 03/09/2025, 09:00:37
2025-03-09 09:00:37,863 [INFO]: Reading total number of vectors and dimension 03/09/2025, 09:00:37
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1154.82it/s]
2025-03-09 09:00:37,889 [INFO]: There are 2517 embeddings of dim 49152
2025-03-09 09:00:37,889 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0257 secs
2025-03-09 09:00:37,889 [INFO]: 	Compute estimated construction time of the index 03/09/2025, 09:00:37
2025-03-09 09:00:37,889 [INFO]: 		-> Train: 16.7 minutes
2025-03-09 09:00:37,889 [INFO]: 		-> Add: 1.4 seconds
2025-03-09 09:00:37,889 [INFO]: 		Total: 16.7 minutes
2025-03-09 09:00:37,889 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0001 secs
2025-03-09 09:00:37,889 [INFO]: 	Checking that your have enough memory available to create the index 03/09/2025, 09:00:37
2025-03-09 09:00:37,889 [INFO]: 519.4MB of memory will be needed to build the index (more might be used if you have more)
2025-03-09 09:00:37,889 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0001 secs
2025-03-09 09:00:37,889 [INFO]: 	Selecting most promising index types given data characteristics 03/09/2025, 09:00:37
2025-03-09 09:00:37,889 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-09 09:00:37,889 [INFO]: 	Creating the index 03/09/2025, 09:00:37
2025-03-09 09:00:37,889 [INFO]: 		-> Instanciate the index HNSW15 03/09/2025, 09:00:37
2025-03-09 09:00:37,890 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0010 secs
2025-03-09 09:00:37,890 [INFO]: 		-> Adding the vectors to the index 03/09/2025, 09:00:37
2025-03-09 09:00:37,890 [INFO]: The memory available for adding the vectors is 49.5GB(total available - used by the index)
2025-03-09 09:00:37,891 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/10 [00:00<?, ?it/s] 10%|█         | 1/10 [00:00<00:00,  9.19it/s] 70%|███████   | 7/10 [00:00<00:00, 34.13it/s]100%|██████████| 10/10 [00:01<00:00,  5.56it/s]
2025-03-09 09:00:39,695 [INFO]: 	Computing best hyperparameters for index knn.index 03/09/2025, 09:00:39
2025-03-09 09:01:11,632 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 31.9359 secs
2025-03-09 09:01:11,632 [INFO]: The best hyperparameters are: efSearch=237
2025-03-09 09:01:11,632 [INFO]: 	Compute fast metrics 03/09/2025, 09:01:11
  0%|          | 0/4 [00:00<?, ?it/s] 75%|███████▌  | 3/4 [00:00<00:00, 28.30it/s] 75%|███████▌  | 3/4 [00:00<00:00, 23.99it/s]
2025-03-09 09:01:28,849 [INFO]: 	>>> Finished "Compute fast metrics" in 17.2173 secs
2025-03-09 09:01:28,851 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 50.9606 secs
2025-03-09 09:01:28,851 [INFO]: {
2025-03-09 09:01:28,851 [INFO]: 	index_key: HNSW15
2025-03-09 09:01:28,851 [INFO]: 	index_param: efSearch=237
2025-03-09 09:01:28,851 [INFO]: 	index_path: knn.index
2025-03-09 09:01:28,851 [INFO]: 	size in bytes: 495204070
2025-03-09 09:01:28,851 [INFO]: 	avg_search_speed_ms: 8.788383756731498
2025-03-09 09:01:28,851 [INFO]: 	99p_search_speed_ms: 19.308597280178184
2025-03-09 09:01:28,851 [INFO]: 	reconstruction error %: 0.0
2025-03-09 09:01:28,851 [INFO]: 	nb vectors: 2517
2025-03-09 09:01:28,851 [INFO]: 	vectors dimension: 49152
2025-03-09 09:01:28,851 [INFO]: 	compression ratio: 0.9993099127799979
2025-03-09 09:01:28,851 [INFO]: }
2025-03-09 09:01:28,851 [INFO]: 	>>> Finished "Creating the index" in 50.9620 secs
2025-03-09 09:01:28,851 [INFO]: >>> Finished "Launching the whole pipeline" in 50.9883 secs
2025-03-09 09:01:29: [retrieval_preprocessing] calculating distances ...
2025-03-09 09:01:30: [retrieval_preprocessing] finished and saved retrieval indices for episode 77581 [episode count 7/20]
[retrieval_preprocessing] for episode 14096 [episode count 8/20], we have num_retrieval=np.int64(2512) num_query=np.int64(150)
2025-03-09 09:01:30,441 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-09 09:01:30,770 [INFO]: Launching the whole pipeline 03/09/2025, 09:01:30
2025-03-09 09:01:30,770 [INFO]: Reading total number of vectors and dimension 03/09/2025, 09:01:30
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1180.50it/s]
2025-03-09 09:01:30,796 [INFO]: There are 2512 embeddings of dim 49152
2025-03-09 09:01:30,796 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0262 secs
2025-03-09 09:01:30,796 [INFO]: 	Compute estimated construction time of the index 03/09/2025, 09:01:30
2025-03-09 09:01:30,796 [INFO]: 		-> Train: 16.7 minutes
2025-03-09 09:01:30,796 [INFO]: 		-> Add: 1.4 seconds
2025-03-09 09:01:30,796 [INFO]: 		Total: 16.7 minutes
2025-03-09 09:01:30,796 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0001 secs
2025-03-09 09:01:30,796 [INFO]: 	Checking that your have enough memory available to create the index 03/09/2025, 09:01:30
2025-03-09 09:01:30,796 [INFO]: 518.4MB of memory will be needed to build the index (more might be used if you have more)
2025-03-09 09:01:30,796 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0001 secs
2025-03-09 09:01:30,796 [INFO]: 	Selecting most promising index types given data characteristics 03/09/2025, 09:01:30
2025-03-09 09:01:30,796 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-09 09:01:30,796 [INFO]: 	Creating the index 03/09/2025, 09:01:30
2025-03-09 09:01:30,797 [INFO]: 		-> Instanciate the index HNSW15 03/09/2025, 09:01:30
2025-03-09 09:01:30,797 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0010 secs
2025-03-09 09:01:30,798 [INFO]: 		-> Adding the vectors to the index 03/09/2025, 09:01:30
2025-03-09 09:01:30,798 [INFO]: The memory available for adding the vectors is 49.5GB(total available - used by the index)
2025-03-09 09:01:30,798 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/10 [00:00<?, ?it/s] 20%|██        | 2/10 [00:00<00:00, 17.26it/s] 70%|███████   | 7/10 [00:00<00:00, 32.88it/s]100%|██████████| 10/10 [00:01<00:00,  5.44it/s]
2025-03-09 09:01:32,641 [INFO]: 	Computing best hyperparameters for index knn.index 03/09/2025, 09:01:32
2025-03-09 09:02:01,859 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 29.2180 secs
2025-03-09 09:02:01,859 [INFO]: The best hyperparameters are: efSearch=246
2025-03-09 09:02:01,859 [INFO]: 	Compute fast metrics 03/09/2025, 09:02:01
  0%|          | 0/4 [00:00<?, ?it/s] 75%|███████▌  | 3/4 [00:00<00:00, 26.10it/s] 75%|███████▌  | 3/4 [00:00<00:00, 22.51it/s]
2025-03-09 09:02:15,727 [INFO]: 	>>> Finished "Compute fast metrics" in 13.8676 secs
2025-03-09 09:02:15,729 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 44.9311 secs
2025-03-09 09:02:15,729 [INFO]: {
2025-03-09 09:02:15,729 [INFO]: 	index_key: HNSW15
2025-03-09 09:02:15,729 [INFO]: 	index_param: efSearch=246
2025-03-09 09:02:15,729 [INFO]: 	index_path: knn.index
2025-03-09 09:02:15,729 [INFO]: 	size in bytes: 494220370
2025-03-09 09:02:15,729 [INFO]: 	avg_search_speed_ms: 9.617294821789702
2025-03-09 09:02:15,729 [INFO]: 	99p_search_speed_ms: 20.315774970222257
2025-03-09 09:02:15,729 [INFO]: 	reconstruction error %: 0.0
2025-03-09 09:02:15,729 [INFO]: 	nb vectors: 2512
2025-03-09 09:02:15,729 [INFO]: 	vectors dimension: 49152
2025-03-09 09:02:15,729 [INFO]: 	compression ratio: 0.999309874661783
2025-03-09 09:02:15,729 [INFO]: }
2025-03-09 09:02:15,729 [INFO]: 	>>> Finished "Creating the index" in 44.9327 secs
2025-03-09 09:02:15,729 [INFO]: >>> Finished "Launching the whole pipeline" in 44.9594 secs
2025-03-09 09:02:16: [retrieval_preprocessing] calculating distances ...
2025-03-09 09:02:17: [retrieval_preprocessing] finished and saved retrieval indices for episode 14096 [episode count 8/20]
[retrieval_preprocessing] for episode 82832 [episode count 9/20], we have num_retrieval=np.int64(2521) num_query=np.int64(141)
2025-03-09 09:02:17,506 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-09 09:02:18,052 [INFO]: Launching the whole pipeline 03/09/2025, 09:02:18
2025-03-09 09:02:18,052 [INFO]: Reading total number of vectors and dimension 03/09/2025, 09:02:18
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 2009.73it/s]
2025-03-09 09:02:18,081 [INFO]: There are 2521 embeddings of dim 49152
2025-03-09 09:02:18,081 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0294 secs
2025-03-09 09:02:18,082 [INFO]: 	Compute estimated construction time of the index 03/09/2025, 09:02:18
2025-03-09 09:02:18,082 [INFO]: 		-> Train: 16.7 minutes
2025-03-09 09:02:18,082 [INFO]: 		-> Add: 1.4 seconds
2025-03-09 09:02:18,082 [INFO]: 		Total: 16.7 minutes
2025-03-09 09:02:18,083 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0007 secs
2025-03-09 09:02:18,083 [INFO]: 	Checking that your have enough memory available to create the index 03/09/2025, 09:02:18
2025-03-09 09:02:18,083 [INFO]: 520.3MB of memory will be needed to build the index (more might be used if you have more)
2025-03-09 09:02:18,084 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0005 secs
2025-03-09 09:02:18,084 [INFO]: 	Selecting most promising index types given data characteristics 03/09/2025, 09:02:18
2025-03-09 09:02:18,084 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-09 09:02:18,084 [INFO]: 	Creating the index 03/09/2025, 09:02:18
2025-03-09 09:02:18,085 [INFO]: 		-> Instanciate the index HNSW15 03/09/2025, 09:02:18
2025-03-09 09:02:18,090 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0053 secs
2025-03-09 09:02:18,090 [INFO]: 		-> Adding the vectors to the index 03/09/2025, 09:02:18
2025-03-09 09:02:18,091 [INFO]: The memory available for adding the vectors is 49.5GB(total available - used by the index)
2025-03-09 09:02:18,091 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/10 [00:00<?, ?it/s] 30%|███       | 3/10 [00:00<00:00, 27.49it/s] 90%|█████████ | 9/10 [00:00<00:00, 41.96it/s]100%|██████████| 10/10 [00:01<00:00,  5.63it/s]
2025-03-09 09:02:19,871 [INFO]: 	Computing best hyperparameters for index knn.index 03/09/2025, 09:02:19
2025-03-09 09:02:50,172 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 30.3007 secs
2025-03-09 09:02:50,172 [INFO]: The best hyperparameters are: efSearch=253
2025-03-09 09:02:50,172 [INFO]: 	Compute fast metrics 03/09/2025, 09:02:50
  0%|          | 0/4 [00:00<?, ?it/s] 75%|███████▌  | 3/4 [00:00<00:00, 25.84it/s] 75%|███████▌  | 3/4 [00:00<00:00, 22.61it/s]
2025-03-09 09:03:06,783 [INFO]: 	>>> Finished "Compute fast metrics" in 16.6107 secs
2025-03-09 09:03:06,785 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 48.6944 secs
2025-03-09 09:03:06,785 [INFO]: {
2025-03-09 09:03:06,785 [INFO]: 	index_key: HNSW15
2025-03-09 09:03:06,785 [INFO]: 	index_param: efSearch=253
2025-03-09 09:03:06,785 [INFO]: 	index_path: knn.index
2025-03-09 09:03:06,785 [INFO]: 	size in bytes: 495991090
2025-03-09 09:03:06,785 [INFO]: 	avg_search_speed_ms: 9.196069776782466
2025-03-09 09:03:06,785 [INFO]: 	99p_search_speed_ms: 18.968026034999532
2025-03-09 09:03:06,785 [INFO]: 	reconstruction error %: 0.0
2025-03-09 09:03:06,785 [INFO]: 	nb vectors: 2521
2025-03-09 09:03:06,785 [INFO]: 	vectors dimension: 49152
2025-03-09 09:03:06,785 [INFO]: 	compression ratio: 0.9993098222792671
2025-03-09 09:03:06,785 [INFO]: }
2025-03-09 09:03:06,785 [INFO]: 	>>> Finished "Creating the index" in 48.7007 secs
2025-03-09 09:03:06,785 [INFO]: >>> Finished "Launching the whole pipeline" in 48.7333 secs
2025-03-09 09:03:07: [retrieval_preprocessing] calculating distances ...
2025-03-09 09:03:08: [retrieval_preprocessing] finished and saved retrieval indices for episode 82832 [episode count 9/20]
[retrieval_preprocessing] for episode 17298 [episode count 10/20], we have num_retrieval=np.int64(2520) num_query=np.int64(142)
2025-03-09 09:03:08,354 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-09 09:03:08,660 [INFO]: Launching the whole pipeline 03/09/2025, 09:03:08
2025-03-09 09:03:08,660 [INFO]: Reading total number of vectors and dimension 03/09/2025, 09:03:08
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1448.31it/s]
2025-03-09 09:03:08,687 [INFO]: There are 2520 embeddings of dim 49152
2025-03-09 09:03:08,687 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0265 secs
2025-03-09 09:03:08,687 [INFO]: 	Compute estimated construction time of the index 03/09/2025, 09:03:08
2025-03-09 09:03:08,687 [INFO]: 		-> Train: 16.7 minutes
2025-03-09 09:03:08,687 [INFO]: 		-> Add: 1.4 seconds
2025-03-09 09:03:08,687 [INFO]: 		Total: 16.7 minutes
2025-03-09 09:03:08,687 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0001 secs
2025-03-09 09:03:08,687 [INFO]: 	Checking that your have enough memory available to create the index 03/09/2025, 09:03:08
2025-03-09 09:03:08,687 [INFO]: 520.1MB of memory will be needed to build the index (more might be used if you have more)
2025-03-09 09:03:08,687 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0002 secs
2025-03-09 09:03:08,687 [INFO]: 	Selecting most promising index types given data characteristics 03/09/2025, 09:03:08
2025-03-09 09:03:08,687 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-09 09:03:08,687 [INFO]: 	Creating the index 03/09/2025, 09:03:08
2025-03-09 09:03:08,688 [INFO]: 		-> Instanciate the index HNSW15 03/09/2025, 09:03:08
2025-03-09 09:03:08,689 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0011 secs
2025-03-09 09:03:08,689 [INFO]: 		-> Adding the vectors to the index 03/09/2025, 09:03:08
2025-03-09 09:03:08,689 [INFO]: The memory available for adding the vectors is 49.5GB(total available - used by the index)
2025-03-09 09:03:08,689 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/10 [00:00<?, ?it/s] 10%|█         | 1/10 [00:00<00:00,  9.07it/s] 70%|███████   | 7/10 [00:00<00:00, 34.41it/s]100%|██████████| 10/10 [00:01<00:00,  5.58it/s]
2025-03-09 09:03:10,482 [INFO]: 	Computing best hyperparameters for index knn.index 03/09/2025, 09:03:10
2025-03-09 09:03:36,369 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 25.8864 secs
2025-03-09 09:03:36,369 [INFO]: The best hyperparameters are: efSearch=184
2025-03-09 09:03:36,369 [INFO]: 	Compute fast metrics 03/09/2025, 09:03:36
  0%|          | 0/4 [00:00<?, ?it/s] 75%|███████▌  | 3/4 [00:00<00:00, 28.35it/s] 75%|███████▌  | 3/4 [00:00<00:00, 24.26it/s]
2025-03-09 09:03:50,705 [INFO]: 	>>> Finished "Compute fast metrics" in 14.3354 secs
2025-03-09 09:03:50,706 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 42.0177 secs
2025-03-09 09:03:50,707 [INFO]: {
2025-03-09 09:03:50,707 [INFO]: 	index_key: HNSW15
2025-03-09 09:03:50,707 [INFO]: 	index_param: efSearch=184
2025-03-09 09:03:50,707 [INFO]: 	index_path: knn.index
2025-03-09 09:03:50,707 [INFO]: 	size in bytes: 495794350
2025-03-09 09:03:50,707 [INFO]: 	avg_search_speed_ms: 8.27577089392025
2025-03-09 09:03:50,707 [INFO]: 	99p_search_speed_ms: 17.88881989428777
2025-03-09 09:03:50,707 [INFO]: 	reconstruction error %: 0.0
2025-03-09 09:03:50,707 [INFO]: 	nb vectors: 2520
2025-03-09 09:03:50,707 [INFO]: 	vectors dimension: 49152
2025-03-09 09:03:50,707 [INFO]: 	compression ratio: 0.9993098146439143
2025-03-09 09:03:50,707 [INFO]: }
2025-03-09 09:03:50,707 [INFO]: 	>>> Finished "Creating the index" in 42.0193 secs
2025-03-09 09:03:50,707 [INFO]: >>> Finished "Launching the whole pipeline" in 42.0464 secs
2025-03-09 09:03:51: [retrieval_preprocessing] calculating distances ...
2025-03-09 09:03:51: [retrieval_preprocessing] finished and saved retrieval indices for episode 17298 [episode count 10/20]
[retrieval_preprocessing] for episode 61207 [episode count 11/20], we have num_retrieval=np.int64(2516) num_query=np.int64(146)
2025-03-09 09:03:51,830 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-09 09:03:52,147 [INFO]: Launching the whole pipeline 03/09/2025, 09:03:52
2025-03-09 09:03:52,147 [INFO]: Reading total number of vectors and dimension 03/09/2025, 09:03:52
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1791.67it/s]
2025-03-09 09:03:52,175 [INFO]: There are 2516 embeddings of dim 49152
2025-03-09 09:03:52,176 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0283 secs
2025-03-09 09:03:52,176 [INFO]: 	Compute estimated construction time of the index 03/09/2025, 09:03:52
2025-03-09 09:03:52,176 [INFO]: 		-> Train: 16.7 minutes
2025-03-09 09:03:52,176 [INFO]: 		-> Add: 1.4 seconds
2025-03-09 09:03:52,176 [INFO]: 		Total: 16.7 minutes
2025-03-09 09:03:52,176 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0003 secs
2025-03-09 09:03:52,176 [INFO]: 	Checking that your have enough memory available to create the index 03/09/2025, 09:03:52
2025-03-09 09:03:52,177 [INFO]: 519.2MB of memory will be needed to build the index (more might be used if you have more)
2025-03-09 09:03:52,177 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0005 secs
2025-03-09 09:03:52,177 [INFO]: 	Selecting most promising index types given data characteristics 03/09/2025, 09:03:52
2025-03-09 09:03:52,177 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-09 09:03:52,177 [INFO]: 	Creating the index 03/09/2025, 09:03:52
2025-03-09 09:03:52,177 [INFO]: 		-> Instanciate the index HNSW15 03/09/2025, 09:03:52
2025-03-09 09:03:52,180 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0028 secs
2025-03-09 09:03:52,181 [INFO]: 		-> Adding the vectors to the index 03/09/2025, 09:03:52
2025-03-09 09:03:52,181 [INFO]: The memory available for adding the vectors is 49.5GB(total available - used by the index)
2025-03-09 09:03:52,181 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/10 [00:00<?, ?it/s] 30%|███       | 3/10 [00:00<00:00, 27.92it/s] 90%|█████████ | 9/10 [00:00<00:00, 43.34it/s]100%|██████████| 10/10 [00:02<00:00,  4.79it/s]
2025-03-09 09:03:54,276 [INFO]: 	Computing best hyperparameters for index knn.index 03/09/2025, 09:03:54
2025-03-09 09:04:23,957 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 29.6803 secs
2025-03-09 09:04:23,958 [INFO]: The best hyperparameters are: efSearch=272
2025-03-09 09:04:23,958 [INFO]: 	Compute fast metrics 03/09/2025, 09:04:23
  0%|          | 0/4 [00:00<?, ?it/s] 50%|█████     | 2/4 [00:00<00:00, 18.78it/s] 75%|███████▌  | 3/4 [00:00<00:00, 20.51it/s]
2025-03-09 09:04:39,376 [INFO]: 	>>> Finished "Compute fast metrics" in 15.4183 secs
2025-03-09 09:04:39,378 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 47.1973 secs
2025-03-09 09:04:39,378 [INFO]: {
2025-03-09 09:04:39,378 [INFO]: 	index_key: HNSW15
2025-03-09 09:04:39,378 [INFO]: 	index_param: efSearch=272
2025-03-09 09:04:39,378 [INFO]: 	index_path: knn.index
2025-03-09 09:04:39,378 [INFO]: 	size in bytes: 495007330
2025-03-09 09:04:39,378 [INFO]: 	avg_search_speed_ms: 10.774657531171748
2025-03-09 09:04:39,378 [INFO]: 	99p_search_speed_ms: 19.616774192545567
2025-03-09 09:04:39,378 [INFO]: 	reconstruction error %: 0.0
2025-03-09 09:04:39,378 [INFO]: 	nb vectors: 2516
2025-03-09 09:04:39,378 [INFO]: 	vectors dimension: 49152
2025-03-09 09:04:39,378 [INFO]: 	compression ratio: 0.999309905168475
2025-03-09 09:04:39,378 [INFO]: }
2025-03-09 09:04:39,378 [INFO]: 	>>> Finished "Creating the index" in 47.2011 secs
2025-03-09 09:04:39,379 [INFO]: >>> Finished "Launching the whole pipeline" in 47.2311 secs
2025-03-09 09:04:40: [retrieval_preprocessing] calculating distances ...
2025-03-09 09:04:41: [retrieval_preprocessing] finished and saved retrieval indices for episode 61207 [episode count 11/20]
[retrieval_preprocessing] for episode 60824 [episode count 12/20], we have num_retrieval=np.int64(2524) num_query=np.int64(138)
2025-03-09 09:04:41,238 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-09 09:04:41,567 [INFO]: Launching the whole pipeline 03/09/2025, 09:04:41
2025-03-09 09:04:41,568 [INFO]: Reading total number of vectors and dimension 03/09/2025, 09:04:41
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1400.44it/s]
2025-03-09 09:04:41,598 [INFO]: There are 2524 embeddings of dim 49152
2025-03-09 09:04:41,598 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0307 secs
2025-03-09 09:04:41,598 [INFO]: 	Compute estimated construction time of the index 03/09/2025, 09:04:41
2025-03-09 09:04:41,599 [INFO]: 		-> Train: 16.7 minutes
2025-03-09 09:04:41,599 [INFO]: 		-> Add: 1.4 seconds
2025-03-09 09:04:41,599 [INFO]: 		Total: 16.7 minutes
2025-03-09 09:04:41,599 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0005 secs
2025-03-09 09:04:41,599 [INFO]: 	Checking that your have enough memory available to create the index 03/09/2025, 09:04:41
2025-03-09 09:04:41,600 [INFO]: 520.9MB of memory will be needed to build the index (more might be used if you have more)
2025-03-09 09:04:41,600 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0004 secs
2025-03-09 09:04:41,600 [INFO]: 	Selecting most promising index types given data characteristics 03/09/2025, 09:04:41
2025-03-09 09:04:41,600 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-09 09:04:41,600 [INFO]: 	Creating the index 03/09/2025, 09:04:41
2025-03-09 09:04:41,600 [INFO]: 		-> Instanciate the index HNSW15 03/09/2025, 09:04:41
2025-03-09 09:04:41,603 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0027 secs
2025-03-09 09:04:41,603 [INFO]: 		-> Adding the vectors to the index 03/09/2025, 09:04:41
2025-03-09 09:04:41,603 [INFO]: The memory available for adding the vectors is 49.5GB(total available - used by the index)
2025-03-09 09:04:41,604 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/10 [00:00<?, ?it/s] 20%|██        | 2/10 [00:00<00:00, 17.27it/s] 80%|████████  | 8/10 [00:00<00:00, 37.40it/s]100%|██████████| 10/10 [00:01<00:00,  5.19it/s]
2025-03-09 09:04:43,535 [INFO]: 	Computing best hyperparameters for index knn.index 03/09/2025, 09:04:43
2025-03-09 09:05:19,372 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 35.8358 secs
2025-03-09 09:05:19,372 [INFO]: The best hyperparameters are: efSearch=219
2025-03-09 09:05:19,372 [INFO]: 	Compute fast metrics 03/09/2025, 09:05:19
  0%|          | 0/4 [00:00<?, ?it/s] 50%|█████     | 2/4 [00:00<00:00, 17.13it/s] 75%|███████▌  | 3/4 [00:00<00:00, 19.35it/s]
2025-03-09 09:05:36,169 [INFO]: 	>>> Finished "Compute fast metrics" in 16.7973 secs
2025-03-09 09:05:36,171 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 54.5678 secs
2025-03-09 09:05:36,171 [INFO]: {
2025-03-09 09:05:36,171 [INFO]: 	index_key: HNSW15
2025-03-09 09:05:36,171 [INFO]: 	index_param: efSearch=219
2025-03-09 09:05:36,171 [INFO]: 	index_path: knn.index
2025-03-09 09:05:36,171 [INFO]: 	size in bytes: 496581310
2025-03-09 09:05:36,171 [INFO]: 	avg_search_speed_ms: 8.661708262551462
2025-03-09 09:05:36,171 [INFO]: 	99p_search_speed_ms: 11.524609462358061
2025-03-09 09:05:36,171 [INFO]: 	reconstruction error %: 0.0
2025-03-09 09:05:36,171 [INFO]: 	nb vectors: 2524
2025-03-09 09:05:36,171 [INFO]: 	vectors dimension: 49152
2025-03-09 09:05:36,171 [INFO]: 	compression ratio: 0.999309845149025
2025-03-09 09:05:36,171 [INFO]: }
2025-03-09 09:05:36,171 [INFO]: 	>>> Finished "Creating the index" in 54.5713 secs
2025-03-09 09:05:36,171 [INFO]: >>> Finished "Launching the whole pipeline" in 54.6039 secs
2025-03-09 09:05:37: [retrieval_preprocessing] calculating distances ...
2025-03-09 09:05:38: [retrieval_preprocessing] finished and saved retrieval indices for episode 60824 [episode count 12/20]
[retrieval_preprocessing] for episode 83324 [episode count 13/20], we have num_retrieval=np.int64(2501) num_query=np.int64(161)
2025-03-09 09:05:38,625 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-09 09:05:38,941 [INFO]: Launching the whole pipeline 03/09/2025, 09:05:38
2025-03-09 09:05:38,942 [INFO]: Reading total number of vectors and dimension 03/09/2025, 09:05:38
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1158.97it/s]
2025-03-09 09:05:38,971 [INFO]: There are 2501 embeddings of dim 49152
2025-03-09 09:05:38,972 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0300 secs
2025-03-09 09:05:38,972 [INFO]: 	Compute estimated construction time of the index 03/09/2025, 09:05:38
2025-03-09 09:05:38,972 [INFO]: 		-> Train: 16.7 minutes
2025-03-09 09:05:38,972 [INFO]: 		-> Add: 1.4 seconds
2025-03-09 09:05:38,972 [INFO]: 		Total: 16.7 minutes
2025-03-09 09:05:38,972 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0003 secs
2025-03-09 09:05:38,972 [INFO]: 	Checking that your have enough memory available to create the index 03/09/2025, 09:05:38
2025-03-09 09:05:38,972 [INFO]: 516.1MB of memory will be needed to build the index (more might be used if you have more)
2025-03-09 09:05:38,973 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0004 secs
2025-03-09 09:05:38,973 [INFO]: 	Selecting most promising index types given data characteristics 03/09/2025, 09:05:38
2025-03-09 09:05:38,973 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-09 09:05:38,973 [INFO]: 	Creating the index 03/09/2025, 09:05:38
2025-03-09 09:05:38,973 [INFO]: 		-> Instanciate the index HNSW15 03/09/2025, 09:05:38
2025-03-09 09:05:38,976 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0028 secs
2025-03-09 09:05:38,976 [INFO]: 		-> Adding the vectors to the index 03/09/2025, 09:05:38
2025-03-09 09:05:38,977 [INFO]: The memory available for adding the vectors is 49.5GB(total available - used by the index)
2025-03-09 09:05:38,977 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/10 [00:00<?, ?it/s] 30%|███       | 3/10 [00:00<00:00, 29.04it/s]100%|██████████| 10/10 [00:01<00:00,  5.78it/s]100%|██████████| 10/10 [00:01<00:00,  6.23it/s]
2025-03-09 09:05:40,588 [INFO]: 	Computing best hyperparameters for index knn.index 03/09/2025, 09:05:40
2025-03-09 09:06:10,398 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 29.8099 secs
2025-03-09 09:06:10,398 [INFO]: The best hyperparameters are: efSearch=248
2025-03-09 09:06:10,398 [INFO]: 	Compute fast metrics 03/09/2025, 09:06:10
  0%|          | 0/4 [00:00<?, ?it/s] 75%|███████▌  | 3/4 [00:00<00:00, 26.63it/s] 75%|███████▌  | 3/4 [00:00<00:00, 23.02it/s]
2025-03-09 09:06:27,471 [INFO]: 	>>> Finished "Compute fast metrics" in 17.0727 secs
2025-03-09 09:06:27,472 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 48.4958 secs
2025-03-09 09:06:27,472 [INFO]: {
2025-03-09 09:06:27,473 [INFO]: 	index_key: HNSW15
2025-03-09 09:06:27,473 [INFO]: 	index_param: efSearch=248
2025-03-09 09:06:27,473 [INFO]: 	index_path: knn.index
2025-03-09 09:06:27,473 [INFO]: 	size in bytes: 492056110
2025-03-09 09:06:27,473 [INFO]: 	avg_search_speed_ms: 9.368538627599817
2025-03-09 09:06:27,473 [INFO]: 	99p_search_speed_ms: 18.584578745067095
2025-03-09 09:06:27,473 [INFO]: 	reconstruction error %: 0.0
2025-03-09 09:06:27,473 [INFO]: 	nb vectors: 2501
2025-03-09 09:06:27,473 [INFO]: 	vectors dimension: 49152
2025-03-09 09:06:27,473 [INFO]: 	compression ratio: 0.9993100339715323
2025-03-09 09:06:27,473 [INFO]: }
2025-03-09 09:06:27,473 [INFO]: 	>>> Finished "Creating the index" in 48.4995 secs
2025-03-09 09:06:27,473 [INFO]: >>> Finished "Launching the whole pipeline" in 48.5311 secs
2025-03-09 09:06:28: [retrieval_preprocessing] calculating distances ...
2025-03-09 09:06:29: [retrieval_preprocessing] finished and saved retrieval indices for episode 83324 [episode count 13/20]
[retrieval_preprocessing] for episode 63100 [episode count 14/20], we have num_retrieval=np.int64(2529) num_query=np.int64(133)
2025-03-09 09:06:29,488 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-09 09:06:29,922 [INFO]: Launching the whole pipeline 03/09/2025, 09:06:29
2025-03-09 09:06:29,922 [INFO]: Reading total number of vectors and dimension 03/09/2025, 09:06:29
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1375.18it/s]
2025-03-09 09:06:29,949 [INFO]: There are 2529 embeddings of dim 49152
2025-03-09 09:06:29,949 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0268 secs
2025-03-09 09:06:29,949 [INFO]: 	Compute estimated construction time of the index 03/09/2025, 09:06:29
2025-03-09 09:06:29,949 [INFO]: 		-> Train: 16.7 minutes
2025-03-09 09:06:29,949 [INFO]: 		-> Add: 1.4 seconds
2025-03-09 09:06:29,950 [INFO]: 		Total: 16.7 minutes
2025-03-09 09:06:29,950 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0002 secs
2025-03-09 09:06:29,950 [INFO]: 	Checking that your have enough memory available to create the index 03/09/2025, 09:06:29
2025-03-09 09:06:29,950 [INFO]: 521.9MB of memory will be needed to build the index (more might be used if you have more)
2025-03-09 09:06:29,950 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0002 secs
2025-03-09 09:06:29,950 [INFO]: 	Selecting most promising index types given data characteristics 03/09/2025, 09:06:29
2025-03-09 09:06:29,950 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-09 09:06:29,950 [INFO]: 	Creating the index 03/09/2025, 09:06:29
2025-03-09 09:06:29,950 [INFO]: 		-> Instanciate the index HNSW15 03/09/2025, 09:06:29
2025-03-09 09:06:29,951 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0012 secs
2025-03-09 09:06:29,952 [INFO]: 		-> Adding the vectors to the index 03/09/2025, 09:06:29
2025-03-09 09:06:29,952 [INFO]: The memory available for adding the vectors is 49.5GB(total available - used by the index)
2025-03-09 09:06:29,952 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/10 [00:00<?, ?it/s] 10%|█         | 1/10 [00:00<00:00,  9.96it/s] 70%|███████   | 7/10 [00:00<00:00, 35.35it/s]100%|██████████| 10/10 [00:02<00:00,  4.79it/s]
2025-03-09 09:06:32,042 [INFO]: 	Computing best hyperparameters for index knn.index 03/09/2025, 09:06:32
2025-03-09 09:07:06,435 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 34.3925 secs
2025-03-09 09:07:06,435 [INFO]: The best hyperparameters are: efSearch=219
2025-03-09 09:07:06,435 [INFO]: 	Compute fast metrics 03/09/2025, 09:07:06
  0%|          | 0/4 [00:00<?, ?it/s] 75%|███████▌  | 3/4 [00:00<00:00, 25.40it/s] 75%|███████▌  | 3/4 [00:00<00:00, 21.82it/s]
2025-03-09 09:07:21,939 [INFO]: 	>>> Finished "Compute fast metrics" in 15.5040 secs
2025-03-09 09:07:21,940 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 51.9888 secs
2025-03-09 09:07:21,941 [INFO]: {
2025-03-09 09:07:21,941 [INFO]: 	index_key: HNSW15
2025-03-09 09:07:21,941 [INFO]: 	index_param: efSearch=219
2025-03-09 09:07:21,941 [INFO]: 	index_path: knn.index
2025-03-09 09:07:21,941 [INFO]: 	size in bytes: 497565130
2025-03-09 09:07:21,941 [INFO]: 	avg_search_speed_ms: 10.43074968371956
2025-03-09 09:07:21,941 [INFO]: 	99p_search_speed_ms: 22.570521985180676
2025-03-09 09:07:21,941 [INFO]: 	reconstruction error %: 0.0
2025-03-09 09:07:21,941 [INFO]: 	nb vectors: 2529
2025-03-09 09:07:21,941 [INFO]: 	vectors dimension: 49152
2025-03-09 09:07:21,941 [INFO]: 	compression ratio: 0.9993096421366988
2025-03-09 09:07:21,941 [INFO]: }
2025-03-09 09:07:21,941 [INFO]: 	>>> Finished "Creating the index" in 51.9907 secs
2025-03-09 09:07:21,941 [INFO]: >>> Finished "Launching the whole pipeline" in 52.0184 secs
2025-03-09 09:07:22: [retrieval_preprocessing] calculating distances ...
2025-03-09 09:07:23: [retrieval_preprocessing] finished and saved retrieval indices for episode 63100 [episode count 14/20]
[retrieval_preprocessing] for episode 75388 [episode count 15/20], we have num_retrieval=np.int64(2516) num_query=np.int64(146)
2025-03-09 09:07:23,249 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-09 09:07:23,630 [INFO]: Launching the whole pipeline 03/09/2025, 09:07:23
2025-03-09 09:07:23,630 [INFO]: Reading total number of vectors and dimension 03/09/2025, 09:07:23
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 2355.03it/s]
2025-03-09 09:07:23,653 [INFO]: There are 2516 embeddings of dim 49152
2025-03-09 09:07:23,654 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0231 secs
2025-03-09 09:07:23,654 [INFO]: 	Compute estimated construction time of the index 03/09/2025, 09:07:23
2025-03-09 09:07:23,654 [INFO]: 		-> Train: 16.7 minutes
2025-03-09 09:07:23,654 [INFO]: 		-> Add: 1.4 seconds
2025-03-09 09:07:23,654 [INFO]: 		Total: 16.7 minutes
2025-03-09 09:07:23,654 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0001 secs
2025-03-09 09:07:23,654 [INFO]: 	Checking that your have enough memory available to create the index 03/09/2025, 09:07:23
2025-03-09 09:07:23,654 [INFO]: 519.2MB of memory will be needed to build the index (more might be used if you have more)
2025-03-09 09:07:23,654 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0001 secs
2025-03-09 09:07:23,654 [INFO]: 	Selecting most promising index types given data characteristics 03/09/2025, 09:07:23
2025-03-09 09:07:23,654 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-09 09:07:23,654 [INFO]: 	Creating the index 03/09/2025, 09:07:23
2025-03-09 09:07:23,654 [INFO]: 		-> Instanciate the index HNSW15 03/09/2025, 09:07:23
2025-03-09 09:07:23,655 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0009 secs
2025-03-09 09:07:23,655 [INFO]: 		-> Adding the vectors to the index 03/09/2025, 09:07:23
2025-03-09 09:07:23,655 [INFO]: The memory available for adding the vectors is 49.5GB(total available - used by the index)
2025-03-09 09:07:23,655 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/10 [00:00<?, ?it/s] 30%|███       | 3/10 [00:00<00:00, 25.91it/s] 90%|█████████ | 9/10 [00:00<00:00, 41.11it/s]100%|██████████| 10/10 [00:02<00:00,  4.97it/s]
2025-03-09 09:07:25,669 [INFO]: 	Computing best hyperparameters for index knn.index 03/09/2025, 09:07:25
2025-03-09 09:07:57,283 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 31.6139 secs
2025-03-09 09:07:57,283 [INFO]: The best hyperparameters are: efSearch=248
2025-03-09 09:07:57,284 [INFO]: 	Compute fast metrics 03/09/2025, 09:07:57
  0%|          | 0/4 [00:00<?, ?it/s] 50%|█████     | 2/4 [00:00<00:00, 19.07it/s] 75%|███████▌  | 3/4 [00:00<00:00, 20.65it/s]
2025-03-09 09:08:12,457 [INFO]: 	>>> Finished "Compute fast metrics" in 15.1737 secs
2025-03-09 09:08:12,459 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 48.8038 secs
2025-03-09 09:08:12,459 [INFO]: {
2025-03-09 09:08:12,459 [INFO]: 	index_key: HNSW15
2025-03-09 09:08:12,459 [INFO]: 	index_param: efSearch=248
2025-03-09 09:08:12,459 [INFO]: 	index_path: knn.index
2025-03-09 09:08:12,459 [INFO]: 	size in bytes: 495007330
2025-03-09 09:08:12,459 [INFO]: 	avg_search_speed_ms: 10.558494940299813
2025-03-09 09:08:12,459 [INFO]: 	99p_search_speed_ms: 14.524691710248577
2025-03-09 09:08:12,459 [INFO]: 	reconstruction error %: 0.0
2025-03-09 09:08:12,459 [INFO]: 	nb vectors: 2516
2025-03-09 09:08:12,459 [INFO]: 	vectors dimension: 49152
2025-03-09 09:08:12,459 [INFO]: 	compression ratio: 0.999309905168475
2025-03-09 09:08:12,459 [INFO]: }
2025-03-09 09:08:12,459 [INFO]: 	>>> Finished "Creating the index" in 48.8053 secs
2025-03-09 09:08:12,459 [INFO]: >>> Finished "Launching the whole pipeline" in 48.8289 secs
2025-03-09 09:08:13: [retrieval_preprocessing] calculating distances ...
2025-03-09 09:08:13: [retrieval_preprocessing] finished and saved retrieval indices for episode 75388 [episode count 15/20]
[retrieval_preprocessing] for episode 56484 [episode count 16/20], we have num_retrieval=np.int64(2548) num_query=np.int64(114)
2025-03-09 09:08:13,939 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-09 09:08:14,360 [INFO]: Launching the whole pipeline 03/09/2025, 09:08:14
2025-03-09 09:08:14,360 [INFO]: Reading total number of vectors and dimension 03/09/2025, 09:08:14
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1430.53it/s]
2025-03-09 09:08:14,385 [INFO]: There are 2548 embeddings of dim 49152
2025-03-09 09:08:14,385 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0248 secs
2025-03-09 09:08:14,385 [INFO]: 	Compute estimated construction time of the index 03/09/2025, 09:08:14
2025-03-09 09:08:14,385 [INFO]: 		-> Train: 16.7 minutes
2025-03-09 09:08:14,385 [INFO]: 		-> Add: 1.4 seconds
2025-03-09 09:08:14,385 [INFO]: 		Total: 16.7 minutes
2025-03-09 09:08:14,385 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0001 secs
2025-03-09 09:08:14,385 [INFO]: 	Checking that your have enough memory available to create the index 03/09/2025, 09:08:14
2025-03-09 09:08:14,386 [INFO]: 525.8MB of memory will be needed to build the index (more might be used if you have more)
2025-03-09 09:08:14,386 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0002 secs
2025-03-09 09:08:14,386 [INFO]: 	Selecting most promising index types given data characteristics 03/09/2025, 09:08:14
2025-03-09 09:08:14,386 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-09 09:08:14,386 [INFO]: 	Creating the index 03/09/2025, 09:08:14
2025-03-09 09:08:14,386 [INFO]: 		-> Instanciate the index HNSW15 03/09/2025, 09:08:14
2025-03-09 09:08:14,387 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0010 secs
2025-03-09 09:08:14,387 [INFO]: 		-> Adding the vectors to the index 03/09/2025, 09:08:14
2025-03-09 09:08:14,387 [INFO]: The memory available for adding the vectors is 49.5GB(total available - used by the index)
2025-03-09 09:08:14,387 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/11 [00:00<?, ?it/s] 18%|█▊        | 2/11 [00:00<00:00, 17.30it/s] 64%|██████▎   | 7/11 [00:00<00:00, 35.13it/s]100%|██████████| 11/11 [00:02<00:00,  4.02it/s]100%|██████████| 11/11 [00:02<00:00,  5.00it/s]
2025-03-09 09:08:16,592 [INFO]: 	Computing best hyperparameters for index knn.index 03/09/2025, 09:08:16
2025-03-09 09:08:43,770 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 27.1785 secs
2025-03-09 09:08:43,771 [INFO]: The best hyperparameters are: efSearch=274
2025-03-09 09:08:43,771 [INFO]: 	Compute fast metrics 03/09/2025, 09:08:43
  0%|          | 0/4 [00:00<?, ?it/s] 75%|███████▌  | 3/4 [00:00<00:00, 27.74it/s] 75%|███████▌  | 3/4 [00:00<00:00, 23.58it/s]
2025-03-09 09:09:01,422 [INFO]: 	>>> Finished "Compute fast metrics" in 17.6510 secs
2025-03-09 09:09:01,424 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 47.0363 secs
2025-03-09 09:09:01,424 [INFO]: {
2025-03-09 09:09:01,424 [INFO]: 	index_key: HNSW15
2025-03-09 09:09:01,424 [INFO]: 	index_param: efSearch=274
2025-03-09 09:09:01,424 [INFO]: 	index_path: knn.index
2025-03-09 09:09:01,424 [INFO]: 	size in bytes: 501303310
2025-03-09 09:09:01,424 [INFO]: 	avg_search_speed_ms: 10.328514134166916
2025-03-09 09:09:01,424 [INFO]: 	99p_search_speed_ms: 22.296989394817516
2025-03-09 09:09:01,424 [INFO]: 	reconstruction error %: 0.0
2025-03-09 09:09:01,424 [INFO]: 	nb vectors: 2548
2025-03-09 09:09:01,424 [INFO]: 	vectors dimension: 49152
2025-03-09 09:09:01,424 [INFO]: 	compression ratio: 0.9993095477466526
2025-03-09 09:09:01,424 [INFO]: }
2025-03-09 09:09:01,424 [INFO]: 	>>> Finished "Creating the index" in 47.0380 secs
2025-03-09 09:09:01,424 [INFO]: >>> Finished "Launching the whole pipeline" in 47.0635 secs
2025-03-09 09:09:02: [retrieval_preprocessing] calculating distances ...
2025-03-09 09:09:02: [retrieval_preprocessing] finished and saved retrieval indices for episode 56484 [episode count 16/20]
[retrieval_preprocessing] for episode 35237 [episode count 17/20], we have num_retrieval=np.int64(2557) num_query=np.int64(105)
2025-03-09 09:09:03,033 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-09 09:09:03,698 [INFO]: Launching the whole pipeline 03/09/2025, 09:09:03
2025-03-09 09:09:03,699 [INFO]: Reading total number of vectors and dimension 03/09/2025, 09:09:03
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1779.51it/s]
2025-03-09 09:09:03,725 [INFO]: There are 2557 embeddings of dim 49152
2025-03-09 09:09:03,725 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0266 secs
2025-03-09 09:09:03,725 [INFO]: 	Compute estimated construction time of the index 03/09/2025, 09:09:03
2025-03-09 09:09:03,725 [INFO]: 		-> Train: 16.7 minutes
2025-03-09 09:09:03,725 [INFO]: 		-> Add: 1.4 seconds
2025-03-09 09:09:03,725 [INFO]: 		Total: 16.7 minutes
2025-03-09 09:09:03,725 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0001 secs
2025-03-09 09:09:03,725 [INFO]: 	Checking that your have enough memory available to create the index 03/09/2025, 09:09:03
2025-03-09 09:09:03,725 [INFO]: 527.7MB of memory will be needed to build the index (more might be used if you have more)
2025-03-09 09:09:03,726 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0002 secs
2025-03-09 09:09:03,726 [INFO]: 	Selecting most promising index types given data characteristics 03/09/2025, 09:09:03
2025-03-09 09:09:03,726 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-09 09:09:03,726 [INFO]: 	Creating the index 03/09/2025, 09:09:03
2025-03-09 09:09:03,726 [INFO]: 		-> Instanciate the index HNSW15 03/09/2025, 09:09:03
2025-03-09 09:09:03,727 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0008 secs
2025-03-09 09:09:03,727 [INFO]: 		-> Adding the vectors to the index 03/09/2025, 09:09:03
2025-03-09 09:09:03,727 [INFO]: The memory available for adding the vectors is 49.5GB(total available - used by the index)
2025-03-09 09:09:03,727 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/11 [00:00<?, ?it/s]  9%|▉         | 1/11 [00:00<00:01,  8.85it/s] 64%|██████▎   | 7/11 [00:00<00:00, 34.50it/s]100%|██████████| 11/11 [00:01<00:00,  4.66it/s]100%|██████████| 11/11 [00:01<00:00,  5.62it/s]
2025-03-09 09:09:05,688 [INFO]: 	Computing best hyperparameters for index knn.index 03/09/2025, 09:09:05
2025-03-09 09:09:37,748 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 32.0596 secs
2025-03-09 09:09:37,748 [INFO]: The best hyperparameters are: efSearch=262
2025-03-09 09:09:37,748 [INFO]: 	Compute fast metrics 03/09/2025, 09:09:37
  0%|          | 0/4 [00:00<?, ?it/s] 50%|█████     | 2/4 [00:00<00:00, 19.39it/s] 75%|███████▌  | 3/4 [00:00<00:00, 21.08it/s]
2025-03-09 09:09:51,227 [INFO]: 	>>> Finished "Compute fast metrics" in 13.4790 secs
2025-03-09 09:09:51,229 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 47.5018 secs
2025-03-09 09:09:51,229 [INFO]: {
2025-03-09 09:09:51,229 [INFO]: 	index_key: HNSW15
2025-03-09 09:09:51,229 [INFO]: 	index_param: efSearch=262
2025-03-09 09:09:51,229 [INFO]: 	index_path: knn.index
2025-03-09 09:09:51,229 [INFO]: 	size in bytes: 503073970
2025-03-09 09:09:51,229 [INFO]: 	avg_search_speed_ms: 10.744058002870846
2025-03-09 09:09:51,229 [INFO]: 	99p_search_speed_ms: 25.914881937205823
2025-03-09 09:09:51,229 [INFO]: 	reconstruction error %: 0.0
2025-03-09 09:09:51,229 [INFO]: 	nb vectors: 2557
2025-03-09 09:09:51,229 [INFO]: 	vectors dimension: 49152
2025-03-09 09:09:51,229 [INFO]: 	compression ratio: 0.999309616436724
2025-03-09 09:09:51,229 [INFO]: }
2025-03-09 09:09:51,229 [INFO]: 	>>> Finished "Creating the index" in 47.5031 secs
2025-03-09 09:09:51,229 [INFO]: >>> Finished "Launching the whole pipeline" in 47.5303 secs
2025-03-09 09:09:51: [retrieval_preprocessing] calculating distances ...
2025-03-09 09:09:52: [retrieval_preprocessing] finished and saved retrieval indices for episode 35237 [episode count 17/20]
[retrieval_preprocessing] for episode 15655 [episode count 18/20], we have num_retrieval=np.int64(2562) num_query=np.int64(100)
2025-03-09 09:09:52,392 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-09 09:09:52,711 [INFO]: Launching the whole pipeline 03/09/2025, 09:09:52
2025-03-09 09:09:52,712 [INFO]: Reading total number of vectors and dimension 03/09/2025, 09:09:52
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1066.17it/s]
2025-03-09 09:09:52,738 [INFO]: There are 2562 embeddings of dim 49152
2025-03-09 09:09:52,738 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0264 secs
2025-03-09 09:09:52,738 [INFO]: 	Compute estimated construction time of the index 03/09/2025, 09:09:52
2025-03-09 09:09:52,738 [INFO]: 		-> Train: 16.7 minutes
2025-03-09 09:09:52,739 [INFO]: 		-> Add: 1.4 seconds
2025-03-09 09:09:52,739 [INFO]: 		Total: 16.7 minutes
2025-03-09 09:09:52,739 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0005 secs
2025-03-09 09:09:52,739 [INFO]: 	Checking that your have enough memory available to create the index 03/09/2025, 09:09:52
2025-03-09 09:09:52,739 [INFO]: 528.7MB of memory will be needed to build the index (more might be used if you have more)
2025-03-09 09:09:52,740 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0004 secs
2025-03-09 09:09:52,740 [INFO]: 	Selecting most promising index types given data characteristics 03/09/2025, 09:09:52
2025-03-09 09:09:52,740 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-09 09:09:52,740 [INFO]: 	Creating the index 03/09/2025, 09:09:52
2025-03-09 09:09:52,740 [INFO]: 		-> Instanciate the index HNSW15 03/09/2025, 09:09:52
2025-03-09 09:09:52,741 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0009 secs
2025-03-09 09:09:52,741 [INFO]: 		-> Adding the vectors to the index 03/09/2025, 09:09:52
2025-03-09 09:09:52,741 [INFO]: The memory available for adding the vectors is 49.5GB(total available - used by the index)
2025-03-09 09:09:52,741 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/11 [00:00<?, ?it/s] 18%|█▊        | 2/11 [00:00<00:00, 16.81it/s] 64%|██████▎   | 7/11 [00:00<00:00, 33.48it/s]100%|██████████| 11/11 [00:02<00:00,  3.92it/s]100%|██████████| 11/11 [00:02<00:00,  4.87it/s]
2025-03-09 09:09:55,005 [INFO]: 	Computing best hyperparameters for index knn.index 03/09/2025, 09:09:55
2025-03-09 09:10:23,232 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 28.2263 secs
2025-03-09 09:10:23,232 [INFO]: The best hyperparameters are: efSearch=169
2025-03-09 09:10:23,232 [INFO]: 	Compute fast metrics 03/09/2025, 09:10:23
  0%|          | 0/4 [00:00<?, ?it/s] 50%|█████     | 2/4 [00:00<00:00, 13.77it/s] 75%|███████▌  | 3/4 [00:00<00:00, 14.75it/s]
2025-03-09 09:10:39,278 [INFO]: 	>>> Finished "Compute fast metrics" in 16.0455 secs
2025-03-09 09:10:39,280 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 46.5383 secs
2025-03-09 09:10:39,280 [INFO]: {
2025-03-09 09:10:39,280 [INFO]: 	index_key: HNSW15
2025-03-09 09:10:39,280 [INFO]: 	index_param: efSearch=169
2025-03-09 09:10:39,280 [INFO]: 	index_path: knn.index
2025-03-09 09:10:39,280 [INFO]: 	size in bytes: 504057670
2025-03-09 09:10:39,280 [INFO]: 	avg_search_speed_ms: 7.082220799785645
2025-03-09 09:10:39,280 [INFO]: 	99p_search_speed_ms: 10.773734492249808
2025-03-09 09:10:39,280 [INFO]: 	reconstruction error %: 0.0
2025-03-09 09:10:39,280 [INFO]: 	nb vectors: 2562
2025-03-09 09:10:39,280 [INFO]: 	vectors dimension: 49152
2025-03-09 09:10:39,280 [INFO]: 	compression ratio: 0.9993096543893479
2025-03-09 09:10:39,280 [INFO]: }
2025-03-09 09:10:39,280 [INFO]: 	>>> Finished "Creating the index" in 46.5398 secs
2025-03-09 09:10:39,280 [INFO]: >>> Finished "Launching the whole pipeline" in 46.5682 secs
2025-03-09 09:10:39: [retrieval_preprocessing] calculating distances ...
2025-03-09 09:10:39: [retrieval_preprocessing] finished and saved retrieval indices for episode 15655 [episode count 18/20]
[retrieval_preprocessing] for episode 28713 [episode count 19/20], we have num_retrieval=np.int64(2553) num_query=np.int64(109)
2025-03-09 09:10:40,092 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-09 09:10:41,372 [INFO]: Launching the whole pipeline 03/09/2025, 09:10:41
2025-03-09 09:10:41,373 [INFO]: Reading total number of vectors and dimension 03/09/2025, 09:10:41
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1617.55it/s]
2025-03-09 09:10:41,402 [INFO]: There are 2553 embeddings of dim 49152
2025-03-09 09:10:41,402 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0295 secs
2025-03-09 09:10:41,402 [INFO]: 	Compute estimated construction time of the index 03/09/2025, 09:10:41
2025-03-09 09:10:41,402 [INFO]: 		-> Train: 16.7 minutes
2025-03-09 09:10:41,402 [INFO]: 		-> Add: 1.4 seconds
2025-03-09 09:10:41,402 [INFO]: 		Total: 16.7 minutes
2025-03-09 09:10:41,402 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0001 secs
2025-03-09 09:10:41,402 [INFO]: 	Checking that your have enough memory available to create the index 03/09/2025, 09:10:41
2025-03-09 09:10:41,403 [INFO]: 526.9MB of memory will be needed to build the index (more might be used if you have more)
2025-03-09 09:10:41,403 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0002 secs
2025-03-09 09:10:41,403 [INFO]: 	Selecting most promising index types given data characteristics 03/09/2025, 09:10:41
2025-03-09 09:10:41,403 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-09 09:10:41,403 [INFO]: 	Creating the index 03/09/2025, 09:10:41
2025-03-09 09:10:41,403 [INFO]: 		-> Instanciate the index HNSW15 03/09/2025, 09:10:41
2025-03-09 09:10:41,404 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0013 secs
2025-03-09 09:10:41,404 [INFO]: 		-> Adding the vectors to the index 03/09/2025, 09:10:41
2025-03-09 09:10:41,404 [INFO]: The memory available for adding the vectors is 49.5GB(total available - used by the index)
2025-03-09 09:10:41,404 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/11 [00:00<?, ?it/s] 18%|█▊        | 2/11 [00:00<00:00, 18.21it/s] 64%|██████▎   | 7/11 [00:00<00:00, 32.51it/s]100%|██████████| 11/11 [00:02<00:00,  4.25it/s]100%|██████████| 11/11 [00:02<00:00,  5.26it/s]
2025-03-09 09:10:43,499 [INFO]: 	Computing best hyperparameters for index knn.index 03/09/2025, 09:10:43
2025-03-09 09:11:15,427 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 31.9274 secs
2025-03-09 09:11:15,427 [INFO]: The best hyperparameters are: efSearch=258
2025-03-09 09:11:15,427 [INFO]: 	Compute fast metrics 03/09/2025, 09:11:15
  0%|          | 0/4 [00:00<?, ?it/s] 75%|███████▌  | 3/4 [00:00<00:00, 25.74it/s] 75%|███████▌  | 3/4 [00:00<00:00, 22.29it/s]
2025-03-09 09:11:27,800 [INFO]: 	>>> Finished "Compute fast metrics" in 12.3723 secs
2025-03-09 09:11:27,802 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 46.3972 secs
2025-03-09 09:11:27,802 [INFO]: {
2025-03-09 09:11:27,802 [INFO]: 	index_key: HNSW15
2025-03-09 09:11:27,802 [INFO]: 	index_param: efSearch=258
2025-03-09 09:11:27,802 [INFO]: 	index_path: knn.index
2025-03-09 09:11:27,802 [INFO]: 	size in bytes: 502287010
2025-03-09 09:11:27,802 [INFO]: 	avg_search_speed_ms: 10.607242338065046
2025-03-09 09:11:27,802 [INFO]: 	99p_search_speed_ms: 23.2499263668433
2025-03-09 09:11:27,802 [INFO]: 	reconstruction error %: 0.0
2025-03-09 09:11:27,802 [INFO]: 	nb vectors: 2553
2025-03-09 09:11:27,802 [INFO]: 	vectors dimension: 49152
2025-03-09 09:11:27,802 [INFO]: 	compression ratio: 0.9993095859675926
2025-03-09 09:11:27,802 [INFO]: }
2025-03-09 09:11:27,802 [INFO]: 	>>> Finished "Creating the index" in 46.3991 secs
2025-03-09 09:11:27,802 [INFO]: >>> Finished "Launching the whole pipeline" in 46.4294 secs
2025-03-09 09:11:28: [retrieval_preprocessing] calculating distances ...
2025-03-09 09:11:28: [retrieval_preprocessing] finished and saved retrieval indices for episode 28713 [episode count 19/20]
2025-03-09 09:11:28: [retrieval_preprocessing] finished for (2782099537, 'marker') [chosen_id count 7/10]
2025-03-09 09:11:29: [retrieval_preprocessing] concatenated all embeddings and indices for 20 episodes for (8376714657, 'marker') [chosen_id count 8/10]
2025-03-09 09:11:29: [retrieval_preprocessing] we have num_total=3330 embedding_dim=49152
[retrieval_preprocessing] for episode 24576 [episode count 0/20], we have num_retrieval=np.int64(3162) num_query=np.int64(168)
2025-03-09 09:11:29,589 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-09 09:11:29,933 [INFO]: Launching the whole pipeline 03/09/2025, 09:11:29
2025-03-09 09:11:29,934 [INFO]: Reading total number of vectors and dimension 03/09/2025, 09:11:29
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1535.25it/s]
2025-03-09 09:11:29,958 [INFO]: There are 3162 embeddings of dim 49152
2025-03-09 09:11:29,958 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0247 secs
2025-03-09 09:11:29,958 [INFO]: 	Compute estimated construction time of the index 03/09/2025, 09:11:29
2025-03-09 09:11:29,958 [INFO]: 		-> Train: 16.7 minutes
2025-03-09 09:11:29,959 [INFO]: 		-> Add: 1.7 seconds
2025-03-09 09:11:29,959 [INFO]: 		Total: 16.7 minutes
2025-03-09 09:11:29,959 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0001 secs
2025-03-09 09:11:29,959 [INFO]: 	Checking that your have enough memory available to create the index 03/09/2025, 09:11:29
2025-03-09 09:11:29,959 [INFO]: 652.6MB of memory will be needed to build the index (more might be used if you have more)
2025-03-09 09:11:29,959 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0001 secs
2025-03-09 09:11:29,959 [INFO]: 	Selecting most promising index types given data characteristics 03/09/2025, 09:11:29
2025-03-09 09:11:29,959 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-09 09:11:29,959 [INFO]: 	Creating the index 03/09/2025, 09:11:29
2025-03-09 09:11:29,959 [INFO]: 		-> Instanciate the index HNSW15 03/09/2025, 09:11:29
2025-03-09 09:11:29,960 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0010 secs
2025-03-09 09:11:29,960 [INFO]: 		-> Adding the vectors to the index 03/09/2025, 09:11:29
2025-03-09 09:11:29,960 [INFO]: The memory available for adding the vectors is 49.4GB(total available - used by the index)
2025-03-09 09:11:29,960 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/13 [00:00<?, ?it/s] 15%|█▌        | 2/13 [00:00<00:00, 17.34it/s] 69%|██████▉   | 9/13 [00:00<00:00, 43.79it/s]100%|██████████| 13/13 [00:02<00:00,  5.63it/s]
2025-03-09 09:11:32,273 [INFO]: 	Computing best hyperparameters for index knn.index 03/09/2025, 09:11:32
2025-03-09 09:12:02,179 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 29.9059 secs
2025-03-09 09:12:02,180 [INFO]: The best hyperparameters are: efSearch=224
2025-03-09 09:12:02,180 [INFO]: 	Compute fast metrics 03/09/2025, 09:12:02
  0%|          | 0/4 [00:00<?, ?it/s] 25%|██▌       | 1/4 [00:00<00:00,  6.08it/s] 75%|███████▌  | 3/4 [00:00<00:00,  8.64it/s] 75%|███████▌  | 3/4 [00:00<00:00,  6.53it/s]
2025-03-09 09:12:21,442 [INFO]: 	>>> Finished "Compute fast metrics" in 19.2625 secs
2025-03-09 09:12:21,445 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 51.4849 secs
2025-03-09 09:12:21,445 [INFO]: {
2025-03-09 09:12:21,445 [INFO]: 	index_key: HNSW15
2025-03-09 09:12:21,445 [INFO]: 	index_param: efSearch=224
2025-03-09 09:12:21,445 [INFO]: 	index_path: knn.index
2025-03-09 09:12:21,445 [INFO]: 	size in bytes: 622103950
2025-03-09 09:12:21,445 [INFO]: 	avg_search_speed_ms: 9.244856333391063
2025-03-09 09:12:21,445 [INFO]: 	99p_search_speed_ms: 13.32905567251146
2025-03-09 09:12:21,445 [INFO]: 	reconstruction error %: 0.0
2025-03-09 09:12:21,445 [INFO]: 	nb vectors: 3162
2025-03-09 09:12:21,445 [INFO]: 	vectors dimension: 49152
2025-03-09 09:12:21,445 [INFO]: 	compression ratio: 0.9993096748541783
2025-03-09 09:12:21,445 [INFO]: }
2025-03-09 09:12:21,445 [INFO]: 	>>> Finished "Creating the index" in 51.4864 secs
2025-03-09 09:12:21,445 [INFO]: >>> Finished "Launching the whole pipeline" in 51.5118 secs
2025-03-09 09:12:22: [retrieval_preprocessing] calculating distances ...
2025-03-09 09:12:22: [retrieval_preprocessing] finished and saved retrieval indices for episode 24576 [episode count 0/20]
[retrieval_preprocessing] for episode 57344 [episode count 1/20], we have num_retrieval=np.int64(3202) num_query=np.int64(128)
2025-03-09 09:12:23,769 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-09 09:12:24,232 [INFO]: Launching the whole pipeline 03/09/2025, 09:12:24
2025-03-09 09:12:24,232 [INFO]: Reading total number of vectors and dimension 03/09/2025, 09:12:24
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1129.93it/s]
2025-03-09 09:12:24,262 [INFO]: There are 3202 embeddings of dim 49152
2025-03-09 09:12:24,262 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0296 secs
2025-03-09 09:12:24,262 [INFO]: 	Compute estimated construction time of the index 03/09/2025, 09:12:24
2025-03-09 09:12:24,262 [INFO]: 		-> Train: 16.7 minutes
2025-03-09 09:12:24,262 [INFO]: 		-> Add: 1.8 seconds
2025-03-09 09:12:24,262 [INFO]: 		Total: 16.7 minutes
2025-03-09 09:12:24,262 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0001 secs
2025-03-09 09:12:24,262 [INFO]: 	Checking that your have enough memory available to create the index 03/09/2025, 09:12:24
2025-03-09 09:12:24,262 [INFO]: 660.8MB of memory will be needed to build the index (more might be used if you have more)
2025-03-09 09:12:24,262 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0002 secs
2025-03-09 09:12:24,262 [INFO]: 	Selecting most promising index types given data characteristics 03/09/2025, 09:12:24
2025-03-09 09:12:24,262 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-09 09:12:24,262 [INFO]: 	Creating the index 03/09/2025, 09:12:24
2025-03-09 09:12:24,262 [INFO]: 		-> Instanciate the index HNSW15 03/09/2025, 09:12:24
2025-03-09 09:12:24,264 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0012 secs
2025-03-09 09:12:24,264 [INFO]: 		-> Adding the vectors to the index 03/09/2025, 09:12:24
2025-03-09 09:12:24,264 [INFO]: The memory available for adding the vectors is 49.4GB(total available - used by the index)
2025-03-09 09:12:24,264 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/13 [00:00<?, ?it/s]  8%|▊         | 1/13 [00:00<00:02,  5.92it/s] 23%|██▎       | 3/13 [00:00<00:01,  8.50it/s] 38%|███▊      | 5/13 [00:00<00:00, 10.02it/s] 54%|█████▍    | 7/13 [00:00<00:00, 10.71it/s] 69%|██████▉   | 9/13 [00:00<00:00, 11.09it/s] 85%|████████▍ | 11/13 [00:01<00:00, 11.41it/s]100%|██████████| 13/13 [00:03<00:00,  2.16it/s]100%|██████████| 13/13 [00:03<00:00,  3.75it/s]
2025-03-09 09:12:27,732 [INFO]: 	Computing best hyperparameters for index knn.index 03/09/2025, 09:12:27
2025-03-09 09:13:07,512 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 39.7789 secs
2025-03-09 09:13:07,512 [INFO]: The best hyperparameters are: efSearch=233
2025-03-09 09:13:07,512 [INFO]: 	Compute fast metrics 03/09/2025, 09:13:07
  0%|          | 0/4 [00:00<?, ?it/s] 25%|██▌       | 1/4 [00:00<00:00,  5.45it/s] 75%|███████▌  | 3/4 [00:00<00:00,  8.47it/s] 75%|███████▌  | 3/4 [00:00<00:00,  6.55it/s]
2025-03-09 09:13:22,488 [INFO]: 	>>> Finished "Compute fast metrics" in 14.9756 secs
2025-03-09 09:13:22,490 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 58.2260 secs
2025-03-09 09:13:22,490 [INFO]: {
2025-03-09 09:13:22,490 [INFO]: 	index_key: HNSW15
2025-03-09 09:13:22,490 [INFO]: 	index_param: efSearch=233
2025-03-09 09:13:22,490 [INFO]: 	index_path: knn.index
2025-03-09 09:13:22,490 [INFO]: 	size in bytes: 629973610
2025-03-09 09:13:22,490 [INFO]: 	avg_search_speed_ms: 10.226608196641024
2025-03-09 09:13:22,490 [INFO]: 	99p_search_speed_ms: 19.28462721640244
2025-03-09 09:13:22,490 [INFO]: 	reconstruction error %: 0.0
2025-03-09 09:13:22,490 [INFO]: 	nb vectors: 3202
2025-03-09 09:13:22,490 [INFO]: 	vectors dimension: 49152
2025-03-09 09:13:22,490 [INFO]: 	compression ratio: 0.9993098218828563
2025-03-09 09:13:22,490 [INFO]: }
2025-03-09 09:13:22,490 [INFO]: 	>>> Finished "Creating the index" in 58.2278 secs
2025-03-09 09:13:22,490 [INFO]: >>> Finished "Launching the whole pipeline" in 58.2581 secs
2025-03-09 09:13:24: [retrieval_preprocessing] calculating distances ...
2025-03-09 09:13:24: [retrieval_preprocessing] finished and saved retrieval indices for episode 57344 [episode count 1/20]
[retrieval_preprocessing] for episode 83973 [episode count 2/20], we have num_retrieval=np.int64(3109) num_query=np.int64(221)
2025-03-09 09:13:25,537 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-09 09:13:25,945 [INFO]: Launching the whole pipeline 03/09/2025, 09:13:25
2025-03-09 09:13:25,945 [INFO]: Reading total number of vectors and dimension 03/09/2025, 09:13:25
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1004.86it/s]
2025-03-09 09:13:25,972 [INFO]: There are 3109 embeddings of dim 49152
2025-03-09 09:13:25,972 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0270 secs
2025-03-09 09:13:25,972 [INFO]: 	Compute estimated construction time of the index 03/09/2025, 09:13:25
2025-03-09 09:13:25,973 [INFO]: 		-> Train: 16.7 minutes
2025-03-09 09:13:25,973 [INFO]: 		-> Add: 1.7 seconds
2025-03-09 09:13:25,973 [INFO]: 		Total: 16.7 minutes
2025-03-09 09:13:25,973 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0001 secs
2025-03-09 09:13:25,973 [INFO]: 	Checking that your have enough memory available to create the index 03/09/2025, 09:13:25
2025-03-09 09:13:25,973 [INFO]: 641.6MB of memory will be needed to build the index (more might be used if you have more)
2025-03-09 09:13:25,973 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0002 secs
2025-03-09 09:13:25,973 [INFO]: 	Selecting most promising index types given data characteristics 03/09/2025, 09:13:25
2025-03-09 09:13:25,973 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-09 09:13:25,973 [INFO]: 	Creating the index 03/09/2025, 09:13:25
2025-03-09 09:13:25,973 [INFO]: 		-> Instanciate the index HNSW15 03/09/2025, 09:13:25
2025-03-09 09:13:25,974 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0011 secs
2025-03-09 09:13:25,974 [INFO]: 		-> Adding the vectors to the index 03/09/2025, 09:13:25
2025-03-09 09:13:25,974 [INFO]: The memory available for adding the vectors is 49.4GB(total available - used by the index)
2025-03-09 09:13:25,974 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/13 [00:00<?, ?it/s]  8%|▊         | 1/13 [00:00<00:01,  6.56it/s] 38%|███▊      | 5/13 [00:00<00:00, 22.54it/s] 77%|███████▋  | 10/13 [00:00<00:00, 31.88it/s]100%|██████████| 13/13 [00:02<00:00,  4.85it/s]
2025-03-09 09:13:28,659 [INFO]: 	Computing best hyperparameters for index knn.index 03/09/2025, 09:13:28
2025-03-09 09:14:05,575 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 36.9159 secs
2025-03-09 09:14:05,576 [INFO]: The best hyperparameters are: efSearch=259
2025-03-09 09:14:05,576 [INFO]: 	Compute fast metrics 03/09/2025, 09:14:05
  0%|          | 0/4 [00:00<?, ?it/s] 25%|██▌       | 1/4 [00:00<00:00,  4.73it/s] 50%|█████     | 2/4 [00:00<00:00,  6.18it/s] 75%|███████▌  | 3/4 [00:00<00:00,  6.99it/s] 75%|███████▌  | 3/4 [00:00<00:00,  5.23it/s]
2025-03-09 09:14:24,240 [INFO]: 	>>> Finished "Compute fast metrics" in 18.6646 secs
2025-03-09 09:14:24,242 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 58.2682 secs
2025-03-09 09:14:24,243 [INFO]: {
2025-03-09 09:14:24,243 [INFO]: 	index_key: HNSW15
2025-03-09 09:14:24,243 [INFO]: 	index_param: efSearch=259
2025-03-09 09:14:24,243 [INFO]: 	index_path: knn.index
2025-03-09 09:14:24,243 [INFO]: 	size in bytes: 611676490
2025-03-09 09:14:24,243 [INFO]: 	avg_search_speed_ms: 11.08636836698919
2025-03-09 09:14:24,243 [INFO]: 	99p_search_speed_ms: 21.011712530162185
2025-03-09 09:14:24,243 [INFO]: 	reconstruction error %: 0.0
2025-03-09 09:14:24,243 [INFO]: 	nb vectors: 3109
2025-03-09 09:14:24,243 [INFO]: 	vectors dimension: 49152
2025-03-09 09:14:24,243 [INFO]: 	compression ratio: 0.9993097364261948
2025-03-09 09:14:24,243 [INFO]: }
2025-03-09 09:14:24,243 [INFO]: 	>>> Finished "Creating the index" in 58.2698 secs
2025-03-09 09:14:24,243 [INFO]: >>> Finished "Launching the whole pipeline" in 58.2974 secs
2025-03-09 09:14:26: [retrieval_preprocessing] calculating distances ...
2025-03-09 09:14:26: [retrieval_preprocessing] finished and saved retrieval indices for episode 83973 [episode count 2/20]
[retrieval_preprocessing] for episode 22540 [episode count 3/20], we have num_retrieval=np.int64(3163) num_query=np.int64(167)
2025-03-09 09:14:28,180 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-09 09:14:28,699 [INFO]: Launching the whole pipeline 03/09/2025, 09:14:28
2025-03-09 09:14:28,699 [INFO]: Reading total number of vectors and dimension 03/09/2025, 09:14:28
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1416.99it/s]
2025-03-09 09:14:28,728 [INFO]: There are 3163 embeddings of dim 49152
2025-03-09 09:14:28,728 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0288 secs
2025-03-09 09:14:28,728 [INFO]: 	Compute estimated construction time of the index 03/09/2025, 09:14:28
2025-03-09 09:14:28,728 [INFO]: 		-> Train: 16.7 minutes
2025-03-09 09:14:28,728 [INFO]: 		-> Add: 1.7 seconds
2025-03-09 09:14:28,728 [INFO]: 		Total: 16.7 minutes
2025-03-09 09:14:28,728 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0001 secs
2025-03-09 09:14:28,728 [INFO]: 	Checking that your have enough memory available to create the index 03/09/2025, 09:14:28
2025-03-09 09:14:28,728 [INFO]: 652.8MB of memory will be needed to build the index (more might be used if you have more)
2025-03-09 09:14:28,729 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0002 secs
2025-03-09 09:14:28,729 [INFO]: 	Selecting most promising index types given data characteristics 03/09/2025, 09:14:28
2025-03-09 09:14:28,729 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-09 09:14:28,729 [INFO]: 	Creating the index 03/09/2025, 09:14:28
2025-03-09 09:14:28,729 [INFO]: 		-> Instanciate the index HNSW15 03/09/2025, 09:14:28
2025-03-09 09:14:28,730 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0012 secs
2025-03-09 09:14:28,730 [INFO]: 		-> Adding the vectors to the index 03/09/2025, 09:14:28
2025-03-09 09:14:28,730 [INFO]: The memory available for adding the vectors is 49.4GB(total available - used by the index)
2025-03-09 09:14:28,730 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/13 [00:00<?, ?it/s]  8%|▊         | 1/13 [00:00<00:01,  6.08it/s] 15%|█▌        | 2/13 [00:00<00:01,  7.76it/s] 23%|██▎       | 3/13 [00:00<00:01,  8.59it/s] 31%|███       | 4/13 [00:00<00:01,  8.65it/s] 38%|███▊      | 5/13 [00:00<00:00,  8.72it/s] 46%|████▌     | 6/13 [00:00<00:00,  8.80it/s] 54%|█████▍    | 7/13 [00:00<00:00,  8.89it/s] 62%|██████▏   | 8/13 [00:00<00:00,  8.81it/s] 69%|██████▉   | 9/13 [00:01<00:00,  8.78it/s] 77%|███████▋  | 10/13 [00:01<00:00,  8.63it/s] 85%|████████▍ | 11/13 [00:01<00:00,  8.65it/s]100%|██████████| 13/13 [00:03<00:00,  1.58it/s]100%|██████████| 13/13 [00:03<00:00,  3.47it/s]
2025-03-09 09:14:32,475 [INFO]: 	Computing best hyperparameters for index knn.index 03/09/2025, 09:14:32
2025-03-09 09:15:07,030 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 34.5552 secs
2025-03-09 09:15:07,030 [INFO]: The best hyperparameters are: efSearch=255
2025-03-09 09:15:07,030 [INFO]: 	Compute fast metrics 03/09/2025, 09:15:07
  0%|          | 0/4 [00:00<?, ?it/s] 25%|██▌       | 1/4 [00:00<00:00,  6.20it/s] 75%|███████▌  | 3/4 [00:00<00:00, 10.03it/s] 75%|███████▌  | 3/4 [00:00<00:00,  7.68it/s]
2025-03-09 09:15:21,405 [INFO]: 	>>> Finished "Compute fast metrics" in 14.3750 secs
2025-03-09 09:15:21,902 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 53.1724 secs
2025-03-09 09:15:21,903 [INFO]: {
2025-03-09 09:15:21,903 [INFO]: 	index_key: HNSW15
2025-03-09 09:15:21,903 [INFO]: 	index_param: efSearch=255
2025-03-09 09:15:21,903 [INFO]: 	index_path: knn.index
2025-03-09 09:15:21,903 [INFO]: 	size in bytes: 622300690
2025-03-09 09:15:21,903 [INFO]: 	avg_search_speed_ms: 9.612457816659186
2025-03-09 09:15:21,903 [INFO]: 	99p_search_speed_ms: 15.638278704136598
2025-03-09 09:15:21,903 [INFO]: 	reconstruction error %: 0.0
2025-03-09 09:15:21,903 [INFO]: 	nb vectors: 3163
2025-03-09 09:15:21,903 [INFO]: 	vectors dimension: 49152
2025-03-09 09:15:21,903 [INFO]: 	compression ratio: 0.9993096809839629
2025-03-09 09:15:21,903 [INFO]: }
2025-03-09 09:15:21,903 [INFO]: 	>>> Finished "Creating the index" in 53.1748 secs
2025-03-09 09:15:21,904 [INFO]: >>> Finished "Launching the whole pipeline" in 53.2043 secs
2025-03-09 09:15:22: [retrieval_preprocessing] calculating distances ...
2025-03-09 09:15:23: [retrieval_preprocessing] finished and saved retrieval indices for episode 22540 [episode count 3/20]
[retrieval_preprocessing] for episode 83981 [episode count 4/20], we have num_retrieval=np.int64(3172) num_query=np.int64(158)
2025-03-09 09:15:24,122 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-09 09:15:24,502 [INFO]: Launching the whole pipeline 03/09/2025, 09:15:24
2025-03-09 09:15:24,502 [INFO]: Reading total number of vectors and dimension 03/09/2025, 09:15:24
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1891.03it/s]
2025-03-09 09:15:24,527 [INFO]: There are 3172 embeddings of dim 49152
2025-03-09 09:15:24,527 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0250 secs
2025-03-09 09:15:24,527 [INFO]: 	Compute estimated construction time of the index 03/09/2025, 09:15:24
2025-03-09 09:15:24,527 [INFO]: 		-> Train: 16.7 minutes
2025-03-09 09:15:24,527 [INFO]: 		-> Add: 1.7 seconds
2025-03-09 09:15:24,527 [INFO]: 		Total: 16.7 minutes
2025-03-09 09:15:24,527 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0001 secs
2025-03-09 09:15:24,527 [INFO]: 	Checking that your have enough memory available to create the index 03/09/2025, 09:15:24
2025-03-09 09:15:24,527 [INFO]: 654.6MB of memory will be needed to build the index (more might be used if you have more)
2025-03-09 09:15:24,527 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0001 secs
2025-03-09 09:15:24,527 [INFO]: 	Selecting most promising index types given data characteristics 03/09/2025, 09:15:24
2025-03-09 09:15:24,527 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-09 09:15:24,527 [INFO]: 	Creating the index 03/09/2025, 09:15:24
2025-03-09 09:15:24,528 [INFO]: 		-> Instanciate the index HNSW15 03/09/2025, 09:15:24
2025-03-09 09:15:24,529 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0011 secs
2025-03-09 09:15:24,529 [INFO]: 		-> Adding the vectors to the index 03/09/2025, 09:15:24
2025-03-09 09:15:24,529 [INFO]: The memory available for adding the vectors is 49.4GB(total available - used by the index)
2025-03-09 09:15:24,529 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/13 [00:00<?, ?it/s]  8%|▊         | 1/13 [00:00<00:02,  5.59it/s] 15%|█▌        | 2/13 [00:00<00:01,  7.31it/s] 23%|██▎       | 3/13 [00:00<00:01,  8.17it/s] 31%|███       | 4/13 [00:00<00:01,  7.53it/s] 38%|███▊      | 5/13 [00:00<00:01,  7.70it/s] 46%|████▌     | 6/13 [00:00<00:00,  8.22it/s] 54%|█████▍    | 7/13 [00:00<00:00,  8.60it/s] 69%|██████▉   | 9/13 [00:01<00:00,  8.38it/s] 77%|███████▋  | 10/13 [00:01<00:00,  8.54it/s] 85%|████████▍ | 11/13 [00:01<00:00,  8.66it/s] 92%|█████████▏| 12/13 [00:01<00:00,  8.37it/s]100%|██████████| 13/13 [00:03<00:00,  1.52it/s]100%|██████████| 13/13 [00:03<00:00,  3.72it/s]
2025-03-09 09:15:28,025 [INFO]: 	Computing best hyperparameters for index knn.index 03/09/2025, 09:15:28
2025-03-09 09:15:59,264 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 31.2387 secs
2025-03-09 09:15:59,264 [INFO]: The best hyperparameters are: efSearch=186
2025-03-09 09:15:59,264 [INFO]: 	Compute fast metrics 03/09/2025, 09:15:59
  0%|          | 0/4 [00:00<?, ?it/s] 25%|██▌       | 1/4 [00:00<00:00,  5.12it/s] 50%|█████     | 2/4 [00:00<00:00,  6.82it/s] 75%|███████▌  | 3/4 [00:00<00:00,  7.58it/s] 75%|███████▌  | 3/4 [00:00<00:00,  5.65it/s]
2025-03-09 09:16:17,743 [INFO]: 	>>> Finished "Compute fast metrics" in 18.4788 secs
2025-03-09 09:16:17,746 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 53.2168 secs
2025-03-09 09:16:17,746 [INFO]: {
2025-03-09 09:16:17,746 [INFO]: 	index_key: HNSW15
2025-03-09 09:16:17,746 [INFO]: 	index_param: efSearch=186
2025-03-09 09:16:17,746 [INFO]: 	index_path: knn.index
2025-03-09 09:16:17,746 [INFO]: 	size in bytes: 624071350
2025-03-09 09:16:17,746 [INFO]: 	avg_search_speed_ms: 8.599477271955406
2025-03-09 09:16:17,746 [INFO]: 	99p_search_speed_ms: 15.266669583506872
2025-03-09 09:16:17,746 [INFO]: 	reconstruction error %: 0.0
2025-03-09 09:16:17,746 [INFO]: 	nb vectors: 3172
2025-03-09 09:16:17,746 [INFO]: 	vectors dimension: 49152
2025-03-09 09:16:17,746 [INFO]: 	compression ratio: 0.9993097359781057
2025-03-09 09:16:17,746 [INFO]: }
2025-03-09 09:16:17,746 [INFO]: 	>>> Finished "Creating the index" in 53.2183 secs
2025-03-09 09:16:17,746 [INFO]: >>> Finished "Launching the whole pipeline" in 53.2439 secs
2025-03-09 09:16:18: [retrieval_preprocessing] calculating distances ...
2025-03-09 09:16:18: [retrieval_preprocessing] finished and saved retrieval indices for episode 83981 [episode count 4/20]
[retrieval_preprocessing] for episode 38926 [episode count 5/20], we have num_retrieval=np.int64(3163) num_query=np.int64(167)
2025-03-09 09:16:19,789 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-09 09:16:20,198 [INFO]: Launching the whole pipeline 03/09/2025, 09:16:20
2025-03-09 09:16:20,198 [INFO]: Reading total number of vectors and dimension 03/09/2025, 09:16:20
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1546.00it/s]
2025-03-09 09:16:20,223 [INFO]: There are 3163 embeddings of dim 49152
2025-03-09 09:16:20,223 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0256 secs
2025-03-09 09:16:20,223 [INFO]: 	Compute estimated construction time of the index 03/09/2025, 09:16:20
2025-03-09 09:16:20,223 [INFO]: 		-> Train: 16.7 minutes
2025-03-09 09:16:20,223 [INFO]: 		-> Add: 1.7 seconds
2025-03-09 09:16:20,223 [INFO]: 		Total: 16.7 minutes
2025-03-09 09:16:20,223 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0001 secs
2025-03-09 09:16:20,224 [INFO]: 	Checking that your have enough memory available to create the index 03/09/2025, 09:16:20
2025-03-09 09:16:20,224 [INFO]: 652.8MB of memory will be needed to build the index (more might be used if you have more)
2025-03-09 09:16:20,224 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0001 secs
2025-03-09 09:16:20,224 [INFO]: 	Selecting most promising index types given data characteristics 03/09/2025, 09:16:20
2025-03-09 09:16:20,224 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-09 09:16:20,224 [INFO]: 	Creating the index 03/09/2025, 09:16:20
2025-03-09 09:16:20,224 [INFO]: 		-> Instanciate the index HNSW15 03/09/2025, 09:16:20
2025-03-09 09:16:20,225 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0011 secs
2025-03-09 09:16:20,225 [INFO]: 		-> Adding the vectors to the index 03/09/2025, 09:16:20
2025-03-09 09:16:20,225 [INFO]: The memory available for adding the vectors is 49.4GB(total available - used by the index)
2025-03-09 09:16:20,225 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/13 [00:00<?, ?it/s]  8%|▊         | 1/13 [00:00<00:01,  6.92it/s] 23%|██▎       | 3/13 [00:00<00:00, 10.77it/s] 38%|███▊      | 5/13 [00:00<00:00, 11.66it/s] 54%|█████▍    | 7/13 [00:00<00:00, 12.02it/s] 69%|██████▉   | 9/13 [00:00<00:00, 12.46it/s] 85%|████████▍ | 11/13 [00:00<00:00, 12.18it/s]100%|██████████| 13/13 [00:03<00:00,  2.26it/s]100%|██████████| 13/13 [00:03<00:00,  3.99it/s]
2025-03-09 09:16:23,489 [INFO]: 	Computing best hyperparameters for index knn.index 03/09/2025, 09:16:23
2025-03-09 09:16:57,854 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 34.3649 secs
2025-03-09 09:16:57,854 [INFO]: The best hyperparameters are: efSearch=276
2025-03-09 09:16:57,854 [INFO]: 	Compute fast metrics 03/09/2025, 09:16:57
  0%|          | 0/4 [00:00<?, ?it/s] 25%|██▌       | 1/4 [00:00<00:00,  5.33it/s] 50%|█████     | 2/4 [00:00<00:00,  7.08it/s] 75%|███████▌  | 3/4 [00:00<00:00,  7.89it/s] 75%|███████▌  | 3/4 [00:00<00:00,  5.97it/s]
2025-03-09 09:17:21,338 [INFO]: 	>>> Finished "Compute fast metrics" in 23.4840 secs
2025-03-09 09:17:21,522 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 61.2969 secs
2025-03-09 09:17:21,522 [INFO]: {
2025-03-09 09:17:21,522 [INFO]: 	index_key: HNSW15
2025-03-09 09:17:21,522 [INFO]: 	index_param: efSearch=276
2025-03-09 09:17:21,523 [INFO]: 	index_path: knn.index
2025-03-09 09:17:21,523 [INFO]: 	size in bytes: 622300690
2025-03-09 09:17:21,523 [INFO]: 	avg_search_speed_ms: 9.921474054978702
2025-03-09 09:17:21,523 [INFO]: 	99p_search_speed_ms: 13.82825519656762
2025-03-09 09:17:21,523 [INFO]: 	reconstruction error %: 0.0
2025-03-09 09:17:21,523 [INFO]: 	nb vectors: 3163
2025-03-09 09:17:21,523 [INFO]: 	vectors dimension: 49152
2025-03-09 09:17:21,523 [INFO]: 	compression ratio: 0.9993096809839629
2025-03-09 09:17:21,523 [INFO]: }
2025-03-09 09:17:21,523 [INFO]: 	>>> Finished "Creating the index" in 61.2992 secs
2025-03-09 09:17:21,523 [INFO]: >>> Finished "Launching the whole pipeline" in 61.3255 secs
2025-03-09 09:17:22: [retrieval_preprocessing] calculating distances ...
2025-03-09 09:17:23: [retrieval_preprocessing] finished and saved retrieval indices for episode 38926 [episode count 5/20]
[retrieval_preprocessing] for episode 2063 [episode count 6/20], we have num_retrieval=np.int64(3196) num_query=np.int64(134)
2025-03-09 09:17:23,786 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-09 09:17:24,244 [INFO]: Launching the whole pipeline 03/09/2025, 09:17:24
2025-03-09 09:17:24,244 [INFO]: Reading total number of vectors and dimension 03/09/2025, 09:17:24
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1021.51it/s]
2025-03-09 09:17:24,274 [INFO]: There are 3196 embeddings of dim 49152
2025-03-09 09:17:24,275 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0303 secs
2025-03-09 09:17:24,275 [INFO]: 	Compute estimated construction time of the index 03/09/2025, 09:17:24
2025-03-09 09:17:24,275 [INFO]: 		-> Train: 16.7 minutes
2025-03-09 09:17:24,275 [INFO]: 		-> Add: 1.8 seconds
2025-03-09 09:17:24,275 [INFO]: 		Total: 16.7 minutes
2025-03-09 09:17:24,276 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0003 secs
2025-03-09 09:17:24,276 [INFO]: 	Checking that your have enough memory available to create the index 03/09/2025, 09:17:24
2025-03-09 09:17:24,276 [INFO]: 659.6MB of memory will be needed to build the index (more might be used if you have more)
2025-03-09 09:17:24,276 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0004 secs
2025-03-09 09:17:24,276 [INFO]: 	Selecting most promising index types given data characteristics 03/09/2025, 09:17:24
2025-03-09 09:17:24,276 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-09 09:17:24,277 [INFO]: 	Creating the index 03/09/2025, 09:17:24
2025-03-09 09:17:24,277 [INFO]: 		-> Instanciate the index HNSW15 03/09/2025, 09:17:24
2025-03-09 09:17:24,279 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0026 secs
2025-03-09 09:17:24,280 [INFO]: 		-> Adding the vectors to the index 03/09/2025, 09:17:24
2025-03-09 09:17:24,280 [INFO]: The memory available for adding the vectors is 49.4GB(total available - used by the index)
2025-03-09 09:17:24,280 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/13 [00:00<?, ?it/s]  8%|▊         | 1/13 [00:00<00:01,  7.05it/s] 23%|██▎       | 3/13 [00:00<00:00, 12.05it/s] 38%|███▊      | 5/13 [00:00<00:00, 11.73it/s] 54%|█████▍    | 7/13 [00:00<00:00, 11.94it/s] 69%|██████▉   | 9/13 [00:00<00:00, 12.57it/s] 85%|████████▍ | 11/13 [00:00<00:00, 11.91it/s]100%|██████████| 13/13 [00:03<00:00,  2.15it/s]100%|██████████| 13/13 [00:03<00:00,  3.84it/s]
2025-03-09 09:17:27,673 [INFO]: 	Computing best hyperparameters for index knn.index 03/09/2025, 09:17:27
2025-03-09 09:18:06,157 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 38.4834 secs
2025-03-09 09:18:06,157 [INFO]: The best hyperparameters are: efSearch=261
2025-03-09 09:18:06,157 [INFO]: 	Compute fast metrics 03/09/2025, 09:18:06
  0%|          | 0/4 [00:00<?, ?it/s] 25%|██▌       | 1/4 [00:00<00:00,  5.73it/s] 75%|███████▌  | 3/4 [00:00<00:00,  8.82it/s] 75%|███████▌  | 3/4 [00:00<00:00,  6.77it/s]
2025-03-09 09:18:25,757 [INFO]: 	>>> Finished "Compute fast metrics" in 19.5994 secs
2025-03-09 09:18:25,759 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 61.4794 secs
2025-03-09 09:18:25,759 [INFO]: {
2025-03-09 09:18:25,759 [INFO]: 	index_key: HNSW15
2025-03-09 09:18:25,759 [INFO]: 	index_param: efSearch=261
2025-03-09 09:18:25,759 [INFO]: 	index_path: knn.index
2025-03-09 09:18:25,759 [INFO]: 	size in bytes: 628793170
2025-03-09 09:18:25,759 [INFO]: 	avg_search_speed_ms: 10.76253484789206
2025-03-09 09:18:25,759 [INFO]: 	99p_search_speed_ms: 18.753380281850696
2025-03-09 09:18:25,759 [INFO]: 	reconstruction error %: 0.0
2025-03-09 09:18:25,759 [INFO]: 	nb vectors: 3196
2025-03-09 09:18:25,759 [INFO]: 	vectors dimension: 49152
2025-03-09 09:18:25,759 [INFO]: 	compression ratio: 0.9993097857599185
2025-03-09 09:18:25,759 [INFO]: }
2025-03-09 09:18:25,759 [INFO]: 	>>> Finished "Creating the index" in 61.4828 secs
2025-03-09 09:18:25,759 [INFO]: >>> Finished "Launching the whole pipeline" in 61.5151 secs
2025-03-09 09:18:26: [retrieval_preprocessing] calculating distances ...
2025-03-09 09:18:27: [retrieval_preprocessing] finished and saved retrieval indices for episode 2063 [episode count 6/20]
[retrieval_preprocessing] for episode 43026 [episode count 7/20], we have num_retrieval=np.int64(3202) num_query=np.int64(128)
2025-03-09 09:18:27,909 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-09 09:18:28,422 [INFO]: Launching the whole pipeline 03/09/2025, 09:18:28
2025-03-09 09:18:28,422 [INFO]: Reading total number of vectors and dimension 03/09/2025, 09:18:28
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1402.78it/s]
2025-03-09 09:18:28,452 [INFO]: There are 3202 embeddings of dim 49152
2025-03-09 09:18:28,452 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0296 secs
2025-03-09 09:18:28,452 [INFO]: 	Compute estimated construction time of the index 03/09/2025, 09:18:28
2025-03-09 09:18:28,453 [INFO]: 		-> Train: 16.7 minutes
2025-03-09 09:18:28,453 [INFO]: 		-> Add: 1.8 seconds
2025-03-09 09:18:28,453 [INFO]: 		Total: 16.7 minutes
2025-03-09 09:18:28,453 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0004 secs
2025-03-09 09:18:28,453 [INFO]: 	Checking that your have enough memory available to create the index 03/09/2025, 09:18:28
2025-03-09 09:18:28,453 [INFO]: 660.8MB of memory will be needed to build the index (more might be used if you have more)
2025-03-09 09:18:28,454 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0005 secs
2025-03-09 09:18:28,454 [INFO]: 	Selecting most promising index types given data characteristics 03/09/2025, 09:18:28
2025-03-09 09:18:28,454 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-09 09:18:28,454 [INFO]: 	Creating the index 03/09/2025, 09:18:28
2025-03-09 09:18:28,454 [INFO]: 		-> Instanciate the index HNSW15 03/09/2025, 09:18:28
2025-03-09 09:18:28,457 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0025 secs
2025-03-09 09:18:28,457 [INFO]: 		-> Adding the vectors to the index 03/09/2025, 09:18:28
2025-03-09 09:18:28,457 [INFO]: The memory available for adding the vectors is 49.4GB(total available - used by the index)
2025-03-09 09:18:28,457 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/13 [00:00<?, ?it/s]  8%|▊         | 1/13 [00:00<00:01,  9.77it/s] 23%|██▎       | 3/13 [00:00<00:00, 11.26it/s] 38%|███▊      | 5/13 [00:00<00:00, 11.81it/s] 54%|█████▍    | 7/13 [00:00<00:00, 11.97it/s] 69%|██████▉   | 9/13 [00:00<00:00, 12.11it/s] 85%|████████▍ | 11/13 [00:00<00:00, 12.05it/s]100%|██████████| 13/13 [00:03<00:00,  2.12it/s]100%|██████████| 13/13 [00:03<00:00,  3.79it/s]
2025-03-09 09:18:31,896 [INFO]: 	Computing best hyperparameters for index knn.index 03/09/2025, 09:18:31
2025-03-09 09:19:08,314 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 36.4171 secs
2025-03-09 09:19:08,314 [INFO]: The best hyperparameters are: efSearch=263
2025-03-09 09:19:08,314 [INFO]: 	Compute fast metrics 03/09/2025, 09:19:08
  0%|          | 0/4 [00:00<?, ?it/s] 25%|██▌       | 1/4 [00:00<00:00,  5.90it/s] 75%|███████▌  | 3/4 [00:00<00:00,  9.68it/s] 75%|███████▌  | 3/4 [00:00<00:00,  7.43it/s]
2025-03-09 09:19:23,485 [INFO]: 	>>> Finished "Compute fast metrics" in 15.1714 secs
2025-03-09 09:19:23,488 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 55.0311 secs
2025-03-09 09:19:23,488 [INFO]: {
2025-03-09 09:19:23,488 [INFO]: 	index_key: HNSW15
2025-03-09 09:19:23,488 [INFO]: 	index_param: efSearch=263
2025-03-09 09:19:23,488 [INFO]: 	index_path: knn.index
2025-03-09 09:19:23,488 [INFO]: 	size in bytes: 629973610
2025-03-09 09:19:23,488 [INFO]: 	avg_search_speed_ms: 10.276332437118144
2025-03-09 09:19:23,488 [INFO]: 	99p_search_speed_ms: 15.420655757188797
2025-03-09 09:19:23,488 [INFO]: 	reconstruction error %: 0.0
2025-03-09 09:19:23,488 [INFO]: 	nb vectors: 3202
2025-03-09 09:19:23,488 [INFO]: 	vectors dimension: 49152
2025-03-09 09:19:23,488 [INFO]: 	compression ratio: 0.9993098218828563
2025-03-09 09:19:23,488 [INFO]: }
2025-03-09 09:19:23,488 [INFO]: 	>>> Finished "Creating the index" in 55.0345 secs
2025-03-09 09:19:23,488 [INFO]: >>> Finished "Launching the whole pipeline" in 55.0660 secs
2025-03-09 09:19:24: [retrieval_preprocessing] calculating distances ...
2025-03-09 09:19:24: [retrieval_preprocessing] finished and saved retrieval indices for episode 43026 [episode count 7/20]
[retrieval_preprocessing] for episode 8214 [episode count 8/20], we have num_retrieval=np.int64(3152) num_query=np.int64(178)
2025-03-09 09:19:25,837 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-09 09:19:26,351 [INFO]: Launching the whole pipeline 03/09/2025, 09:19:26
2025-03-09 09:19:26,351 [INFO]: Reading total number of vectors and dimension 03/09/2025, 09:19:26
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1916.96it/s]
2025-03-09 09:19:26,700 [INFO]: There are 3152 embeddings of dim 49152
2025-03-09 09:19:26,701 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.3494 secs
2025-03-09 09:19:26,701 [INFO]: 	Compute estimated construction time of the index 03/09/2025, 09:19:26
2025-03-09 09:19:26,701 [INFO]: 		-> Train: 16.7 minutes
2025-03-09 09:19:26,701 [INFO]: 		-> Add: 1.7 seconds
2025-03-09 09:19:26,701 [INFO]: 		Total: 16.7 minutes
2025-03-09 09:19:26,701 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0002 secs
2025-03-09 09:19:26,701 [INFO]: 	Checking that your have enough memory available to create the index 03/09/2025, 09:19:26
2025-03-09 09:19:26,701 [INFO]: 650.5MB of memory will be needed to build the index (more might be used if you have more)
2025-03-09 09:19:26,702 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0004 secs
2025-03-09 09:19:26,702 [INFO]: 	Selecting most promising index types given data characteristics 03/09/2025, 09:19:26
2025-03-09 09:19:26,702 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-09 09:19:26,702 [INFO]: 	Creating the index 03/09/2025, 09:19:26
2025-03-09 09:19:26,702 [INFO]: 		-> Instanciate the index HNSW15 03/09/2025, 09:19:26
2025-03-09 09:19:26,704 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0019 secs
2025-03-09 09:19:26,704 [INFO]: 		-> Adding the vectors to the index 03/09/2025, 09:19:26
2025-03-09 09:19:26,704 [INFO]: The memory available for adding the vectors is 49.4GB(total available - used by the index)
2025-03-09 09:19:26,704 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/13 [00:00<?, ?it/s]  8%|▊         | 1/13 [00:00<00:02,  5.90it/s] 23%|██▎       | 3/13 [00:00<00:01,  9.74it/s] 38%|███▊      | 5/13 [00:00<00:00, 10.84it/s] 54%|█████▍    | 7/13 [00:00<00:00, 11.08it/s] 69%|██████▉   | 9/13 [00:00<00:00, 10.99it/s] 85%|████████▍ | 11/13 [00:01<00:00, 10.79it/s]100%|██████████| 13/13 [00:03<00:00,  1.97it/s]100%|██████████| 13/13 [00:03<00:00,  3.50it/s]
2025-03-09 09:19:30,423 [INFO]: 	Computing best hyperparameters for index knn.index 03/09/2025, 09:19:30
2025-03-09 09:20:04,790 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 34.3673 secs
2025-03-09 09:20:04,791 [INFO]: The best hyperparameters are: efSearch=255
2025-03-09 09:20:04,791 [INFO]: 	Compute fast metrics 03/09/2025, 09:20:04
  0%|          | 0/4 [00:00<?, ?it/s] 25%|██▌       | 1/4 [00:00<00:00,  6.29it/s] 75%|███████▌  | 3/4 [00:00<00:00,  9.51it/s] 75%|███████▌  | 3/4 [00:00<00:00,  7.36it/s]
2025-03-09 09:20:21,999 [INFO]: 	>>> Finished "Compute fast metrics" in 17.2085 secs
2025-03-09 09:20:22,001 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 55.2973 secs
2025-03-09 09:20:22,002 [INFO]: {
2025-03-09 09:20:22,002 [INFO]: 	index_key: HNSW15
2025-03-09 09:20:22,002 [INFO]: 	index_param: efSearch=255
2025-03-09 09:20:22,002 [INFO]: 	index_path: knn.index
2025-03-09 09:20:22,002 [INFO]: 	size in bytes: 620136550
2025-03-09 09:20:22,002 [INFO]: 	avg_search_speed_ms: 10.95354248543126
2025-03-09 09:20:22,002 [INFO]: 	99p_search_speed_ms: 18.862518081441518
2025-03-09 09:20:22,002 [INFO]: 	reconstruction error %: 0.0
2025-03-09 09:20:22,002 [INFO]: 	nb vectors: 3152
2025-03-09 09:20:22,002 [INFO]: 	vectors dimension: 49152
2025-03-09 09:20:22,002 [INFO]: 	compression ratio: 0.9993096133424163
2025-03-09 09:20:22,002 [INFO]: }
2025-03-09 09:20:22,002 [INFO]: 	>>> Finished "Creating the index" in 55.3000 secs
2025-03-09 09:20:22,002 [INFO]: >>> Finished "Launching the whole pipeline" in 55.6507 secs
2025-03-09 09:20:23: [retrieval_preprocessing] calculating distances ...
2025-03-09 09:20:23: [retrieval_preprocessing] finished and saved retrieval indices for episode 8214 [episode count 8/20]
[retrieval_preprocessing] for episode 28697 [episode count 9/20], we have num_retrieval=np.int64(3173) num_query=np.int64(157)
2025-03-09 09:20:24,755 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-09 09:20:25,160 [INFO]: Launching the whole pipeline 03/09/2025, 09:20:25
2025-03-09 09:20:25,160 [INFO]: Reading total number of vectors and dimension 03/09/2025, 09:20:25
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 2416.07it/s]
2025-03-09 09:20:25,183 [INFO]: There are 3173 embeddings of dim 49152
2025-03-09 09:20:25,183 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0233 secs
2025-03-09 09:20:25,183 [INFO]: 	Compute estimated construction time of the index 03/09/2025, 09:20:25
2025-03-09 09:20:25,183 [INFO]: 		-> Train: 16.7 minutes
2025-03-09 09:20:25,183 [INFO]: 		-> Add: 1.7 seconds
2025-03-09 09:20:25,183 [INFO]: 		Total: 16.7 minutes
2025-03-09 09:20:25,183 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0001 secs
2025-03-09 09:20:25,183 [INFO]: 	Checking that your have enough memory available to create the index 03/09/2025, 09:20:25
2025-03-09 09:20:25,183 [INFO]: 654.8MB of memory will be needed to build the index (more might be used if you have more)
2025-03-09 09:20:25,183 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0001 secs
2025-03-09 09:20:25,183 [INFO]: 	Selecting most promising index types given data characteristics 03/09/2025, 09:20:25
2025-03-09 09:20:25,183 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-09 09:20:25,183 [INFO]: 	Creating the index 03/09/2025, 09:20:25
2025-03-09 09:20:25,183 [INFO]: 		-> Instanciate the index HNSW15 03/09/2025, 09:20:25
2025-03-09 09:20:25,184 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0009 secs
2025-03-09 09:20:25,184 [INFO]: 		-> Adding the vectors to the index 03/09/2025, 09:20:25
2025-03-09 09:20:25,184 [INFO]: The memory available for adding the vectors is 49.4GB(total available - used by the index)
2025-03-09 09:20:25,184 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/13 [00:00<?, ?it/s]  8%|▊         | 1/13 [00:00<00:02,  5.65it/s] 15%|█▌        | 2/13 [00:00<00:01,  7.21it/s] 23%|██▎       | 3/13 [00:00<00:01,  8.13it/s] 38%|███▊      | 5/13 [00:00<00:00,  9.27it/s] 46%|████▌     | 6/13 [00:00<00:00,  9.03it/s] 54%|█████▍    | 7/13 [00:00<00:00,  8.89it/s] 62%|██████▏   | 8/13 [00:00<00:00,  8.79it/s] 69%|██████▉   | 9/13 [00:01<00:00,  8.82it/s] 85%|████████▍ | 11/13 [00:01<00:00, 10.69it/s]100%|██████████| 13/13 [00:03<00:00,  2.18it/s]100%|██████████| 13/13 [00:03<00:00,  4.03it/s]
2025-03-09 09:20:28,414 [INFO]: 	Computing best hyperparameters for index knn.index 03/09/2025, 09:20:28
2025-03-09 09:21:03,889 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 35.4748 secs
2025-03-09 09:21:03,889 [INFO]: The best hyperparameters are: efSearch=236
2025-03-09 09:21:03,889 [INFO]: 	Compute fast metrics 03/09/2025, 09:21:03
  0%|          | 0/4 [00:00<?, ?it/s] 25%|██▌       | 1/4 [00:00<00:00,  5.82it/s] 50%|█████     | 2/4 [00:00<00:00,  7.44it/s] 75%|███████▌  | 3/4 [00:00<00:00,  7.85it/s] 75%|███████▌  | 3/4 [00:00<00:00,  5.93it/s]
2025-03-09 09:21:20,624 [INFO]: 	>>> Finished "Compute fast metrics" in 16.7346 secs
2025-03-09 09:21:20,626 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 55.4419 secs
2025-03-09 09:21:20,626 [INFO]: {
2025-03-09 09:21:20,626 [INFO]: 	index_key: HNSW15
2025-03-09 09:21:20,626 [INFO]: 	index_param: efSearch=236
2025-03-09 09:21:20,626 [INFO]: 	index_path: knn.index
2025-03-09 09:21:20,626 [INFO]: 	size in bytes: 624268090
2025-03-09 09:21:20,626 [INFO]: 	avg_search_speed_ms: 9.502797025138227
2025-03-09 09:21:20,626 [INFO]: 	99p_search_speed_ms: 17.674221750348806
2025-03-09 09:21:20,627 [INFO]: 	reconstruction error %: 0.0
2025-03-09 09:21:20,627 [INFO]: 	nb vectors: 3173
2025-03-09 09:21:20,627 [INFO]: 	vectors dimension: 49152
2025-03-09 09:21:20,627 [INFO]: 	compression ratio: 0.9993097420693087
2025-03-09 09:21:20,627 [INFO]: }
2025-03-09 09:21:20,627 [INFO]: 	>>> Finished "Creating the index" in 55.4432 secs
2025-03-09 09:21:20,627 [INFO]: >>> Finished "Launching the whole pipeline" in 55.4670 secs
2025-03-09 09:21:21: [retrieval_preprocessing] calculating distances ...
2025-03-09 09:21:22: [retrieval_preprocessing] finished and saved retrieval indices for episode 28697 [episode count 9/20]
[retrieval_preprocessing] for episode 67609 [episode count 10/20], we have num_retrieval=np.int64(3200) num_query=np.int64(130)
2025-03-09 09:21:23,298 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-09 09:21:23,781 [INFO]: Launching the whole pipeline 03/09/2025, 09:21:23
2025-03-09 09:21:23,781 [INFO]: Reading total number of vectors and dimension 03/09/2025, 09:21:23
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1009.46it/s]
2025-03-09 09:21:23,807 [INFO]: There are 3200 embeddings of dim 49152
2025-03-09 09:21:23,808 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0261 secs
2025-03-09 09:21:23,808 [INFO]: 	Compute estimated construction time of the index 03/09/2025, 09:21:23
2025-03-09 09:21:23,808 [INFO]: 		-> Train: 16.7 minutes
2025-03-09 09:21:23,808 [INFO]: 		-> Add: 1.8 seconds
2025-03-09 09:21:23,808 [INFO]: 		Total: 16.7 minutes
2025-03-09 09:21:23,808 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0003 secs
2025-03-09 09:21:23,808 [INFO]: 	Checking that your have enough memory available to create the index 03/09/2025, 09:21:23
2025-03-09 09:21:23,809 [INFO]: 660.4MB of memory will be needed to build the index (more might be used if you have more)
2025-03-09 09:21:23,809 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0003 secs
2025-03-09 09:21:23,809 [INFO]: 	Selecting most promising index types given data characteristics 03/09/2025, 09:21:23
2025-03-09 09:21:23,809 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-09 09:21:23,809 [INFO]: 	Creating the index 03/09/2025, 09:21:23
2025-03-09 09:21:23,809 [INFO]: 		-> Instanciate the index HNSW15 03/09/2025, 09:21:23
2025-03-09 09:21:23,812 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0027 secs
2025-03-09 09:21:23,812 [INFO]: 		-> Adding the vectors to the index 03/09/2025, 09:21:23
2025-03-09 09:21:23,812 [INFO]: The memory available for adding the vectors is 49.4GB(total available - used by the index)
2025-03-09 09:21:23,813 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/13 [00:00<?, ?it/s]  8%|▊         | 1/13 [00:00<00:02,  6.00it/s] 23%|██▎       | 3/13 [00:00<00:01,  8.69it/s] 38%|███▊      | 5/13 [00:00<00:00, 10.27it/s] 54%|█████▍    | 7/13 [00:00<00:00, 11.80it/s] 69%|██████▉   | 9/13 [00:00<00:00, 12.56it/s] 85%|████████▍ | 11/13 [00:00<00:00, 12.97it/s]100%|██████████| 13/13 [00:03<00:00,  2.18it/s]100%|██████████| 13/13 [00:03<00:00,  3.84it/s]
2025-03-09 09:21:27,202 [INFO]: 	Computing best hyperparameters for index knn.index 03/09/2025, 09:21:27
2025-03-09 09:22:04,069 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 36.8659 secs
2025-03-09 09:22:04,069 [INFO]: The best hyperparameters are: efSearch=274
2025-03-09 09:22:04,069 [INFO]: 	Compute fast metrics 03/09/2025, 09:22:04
  0%|          | 0/4 [00:00<?, ?it/s] 25%|██▌       | 1/4 [00:00<00:00,  5.15it/s] 50%|█████     | 2/4 [00:00<00:00,  6.75it/s] 75%|███████▌  | 3/4 [00:00<00:00,  7.54it/s] 75%|███████▌  | 3/4 [00:00<00:00,  5.63it/s]
2025-03-09 09:22:24,089 [INFO]: 	>>> Finished "Compute fast metrics" in 20.0205 secs
2025-03-09 09:22:24,092 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 60.2798 secs
2025-03-09 09:22:24,092 [INFO]: {
2025-03-09 09:22:24,092 [INFO]: 	index_key: HNSW15
2025-03-09 09:22:24,092 [INFO]: 	index_param: efSearch=274
2025-03-09 09:22:24,092 [INFO]: 	index_path: knn.index
2025-03-09 09:22:24,092 [INFO]: 	size in bytes: 629580130
2025-03-09 09:22:24,092 [INFO]: 	avg_search_speed_ms: 10.910987790019913
2025-03-09 09:22:24,092 [INFO]: 	99p_search_speed_ms: 18.581002978608023
2025-03-09 09:22:24,092 [INFO]: 	reconstruction error %: 0.0
2025-03-09 09:22:24,092 [INFO]: 	nb vectors: 3200
2025-03-09 09:22:24,092 [INFO]: 	vectors dimension: 49152
2025-03-09 09:22:24,092 [INFO]: 	compression ratio: 0.999309809856928
2025-03-09 09:22:24,092 [INFO]: }
2025-03-09 09:22:24,092 [INFO]: 	>>> Finished "Creating the index" in 60.2833 secs
2025-03-09 09:22:24,093 [INFO]: >>> Finished "Launching the whole pipeline" in 60.3110 secs
2025-03-09 09:22:24: [retrieval_preprocessing] calculating distances ...
2025-03-09 09:22:25: [retrieval_preprocessing] finished and saved retrieval indices for episode 67609 [episode count 10/20]
[retrieval_preprocessing] for episode 59419 [episode count 11/20], we have num_retrieval=np.int64(3122) num_query=np.int64(208)
2025-03-09 09:22:26,130 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-09 09:22:26,522 [INFO]: Launching the whole pipeline 03/09/2025, 09:22:26
2025-03-09 09:22:26,522 [INFO]: Reading total number of vectors and dimension 03/09/2025, 09:22:26
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1554.02it/s]
2025-03-09 09:22:26,547 [INFO]: There are 3122 embeddings of dim 49152
2025-03-09 09:22:26,547 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0250 secs
2025-03-09 09:22:26,547 [INFO]: 	Compute estimated construction time of the index 03/09/2025, 09:22:26
2025-03-09 09:22:26,547 [INFO]: 		-> Train: 16.7 minutes
2025-03-09 09:22:26,547 [INFO]: 		-> Add: 1.7 seconds
2025-03-09 09:22:26,547 [INFO]: 		Total: 16.7 minutes
2025-03-09 09:22:26,547 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0001 secs
2025-03-09 09:22:26,547 [INFO]: 	Checking that your have enough memory available to create the index 03/09/2025, 09:22:26
2025-03-09 09:22:26,547 [INFO]: 644.3MB of memory will be needed to build the index (more might be used if you have more)
2025-03-09 09:22:26,547 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0001 secs
2025-03-09 09:22:26,547 [INFO]: 	Selecting most promising index types given data characteristics 03/09/2025, 09:22:26
2025-03-09 09:22:26,547 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-09 09:22:26,547 [INFO]: 	Creating the index 03/09/2025, 09:22:26
2025-03-09 09:22:26,547 [INFO]: 		-> Instanciate the index HNSW15 03/09/2025, 09:22:26
2025-03-09 09:22:26,548 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0010 secs
2025-03-09 09:22:26,548 [INFO]: 		-> Adding the vectors to the index 03/09/2025, 09:22:26
2025-03-09 09:22:26,549 [INFO]: The memory available for adding the vectors is 49.4GB(total available - used by the index)
2025-03-09 09:22:26,549 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/13 [00:00<?, ?it/s]  8%|▊         | 1/13 [00:00<00:02,  4.45it/s] 23%|██▎       | 3/13 [00:00<00:01,  9.16it/s] 38%|███▊      | 5/13 [00:00<00:00, 10.54it/s] 54%|█████▍    | 7/13 [00:00<00:00, 11.19it/s] 69%|██████▉   | 9/13 [00:00<00:00, 11.45it/s] 85%|████████▍ | 11/13 [00:01<00:00, 11.21it/s]100%|██████████| 13/13 [00:03<00:00,  2.29it/s]100%|██████████| 13/13 [00:03<00:00,  3.94it/s]
2025-03-09 09:22:29,854 [INFO]: 	Computing best hyperparameters for index knn.index 03/09/2025, 09:22:29
2025-03-09 09:23:03,923 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 34.0686 secs
2025-03-09 09:23:03,923 [INFO]: The best hyperparameters are: efSearch=278
2025-03-09 09:23:03,923 [INFO]: 	Compute fast metrics 03/09/2025, 09:23:03
  0%|          | 0/4 [00:00<?, ?it/s] 25%|██▌       | 1/4 [00:00<00:00,  6.13it/s] 75%|███████▌  | 3/4 [00:00<00:00,  9.72it/s] 75%|███████▌  | 3/4 [00:00<00:00,  7.48it/s]
2025-03-09 09:23:19,180 [INFO]: 	>>> Finished "Compute fast metrics" in 15.2566 secs
2025-03-09 09:23:19,182 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 52.6338 secs
2025-03-09 09:23:19,182 [INFO]: {
2025-03-09 09:23:19,182 [INFO]: 	index_key: HNSW15
2025-03-09 09:23:19,182 [INFO]: 	index_param: efSearch=278
2025-03-09 09:23:19,183 [INFO]: 	index_path: knn.index
2025-03-09 09:23:19,183 [INFO]: 	size in bytes: 614234110
2025-03-09 09:23:19,183 [INFO]: 	avg_search_speed_ms: 9.824024341371064
2025-03-09 09:23:19,183 [INFO]: 	99p_search_speed_ms: 14.404703257605435
2025-03-09 09:23:19,183 [INFO]: 	reconstruction error %: 0.0
2025-03-09 09:23:19,183 [INFO]: 	nb vectors: 3122
2025-03-09 09:23:19,183 [INFO]: 	vectors dimension: 49152
2025-03-09 09:23:19,183 [INFO]: 	compression ratio: 0.9993098169035256
2025-03-09 09:23:19,183 [INFO]: }
2025-03-09 09:23:19,183 [INFO]: 	>>> Finished "Creating the index" in 52.6353 secs
2025-03-09 09:23:19,183 [INFO]: >>> Finished "Launching the whole pipeline" in 52.6608 secs
2025-03-09 09:23:20: [retrieval_preprocessing] calculating distances ...
2025-03-09 09:23:21: [retrieval_preprocessing] finished and saved retrieval indices for episode 59419 [episode count 11/20]
[retrieval_preprocessing] for episode 51229 [episode count 12/20], we have num_retrieval=np.int64(3187) num_query=np.int64(143)
2025-03-09 09:23:22,111 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-09 09:23:22,545 [INFO]: Launching the whole pipeline 03/09/2025, 09:23:22
2025-03-09 09:23:22,545 [INFO]: Reading total number of vectors and dimension 03/09/2025, 09:23:22
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1679.06it/s]
2025-03-09 09:23:22,569 [INFO]: There are 3187 embeddings of dim 49152
2025-03-09 09:23:22,569 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0239 secs
2025-03-09 09:23:22,569 [INFO]: 	Compute estimated construction time of the index 03/09/2025, 09:23:22
2025-03-09 09:23:22,569 [INFO]: 		-> Train: 16.7 minutes
2025-03-09 09:23:22,569 [INFO]: 		-> Add: 1.8 seconds
2025-03-09 09:23:22,569 [INFO]: 		Total: 16.7 minutes
2025-03-09 09:23:22,569 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0001 secs
2025-03-09 09:23:22,569 [INFO]: 	Checking that your have enough memory available to create the index 03/09/2025, 09:23:22
2025-03-09 09:23:22,569 [INFO]: 657.7MB of memory will be needed to build the index (more might be used if you have more)
2025-03-09 09:23:22,569 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0001 secs
2025-03-09 09:23:22,569 [INFO]: 	Selecting most promising index types given data characteristics 03/09/2025, 09:23:22
2025-03-09 09:23:22,569 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-09 09:23:22,570 [INFO]: 	Creating the index 03/09/2025, 09:23:22
2025-03-09 09:23:22,570 [INFO]: 		-> Instanciate the index HNSW15 03/09/2025, 09:23:22
2025-03-09 09:23:22,571 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0009 secs
2025-03-09 09:23:22,571 [INFO]: 		-> Adding the vectors to the index 03/09/2025, 09:23:22
2025-03-09 09:23:22,571 [INFO]: The memory available for adding the vectors is 49.4GB(total available - used by the index)
2025-03-09 09:23:22,571 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/13 [00:00<?, ?it/s]  8%|▊         | 1/13 [00:00<00:02,  5.44it/s] 15%|█▌        | 2/13 [00:00<00:01,  7.17it/s] 23%|██▎       | 3/13 [00:00<00:01,  7.76it/s] 31%|███       | 4/13 [00:00<00:01,  8.16it/s] 38%|███▊      | 5/13 [00:00<00:00,  8.37it/s] 46%|████▌     | 6/13 [00:00<00:00,  8.54it/s] 54%|█████▍    | 7/13 [00:00<00:00,  8.68it/s] 62%|██████▏   | 8/13 [00:00<00:00,  8.72it/s] 69%|██████▉   | 9/13 [00:01<00:00,  8.70it/s] 77%|███████▋  | 10/13 [00:01<00:00,  8.75it/s] 85%|████████▍ | 11/13 [00:01<00:00,  8.81it/s] 92%|█████████▏| 12/13 [00:01<00:00,  8.83it/s]100%|██████████| 13/13 [00:03<00:00,  1.18it/s]100%|██████████| 13/13 [00:03<00:00,  3.28it/s]
2025-03-09 09:23:26,540 [INFO]: 	Computing best hyperparameters for index knn.index 03/09/2025, 09:23:26
2025-03-09 09:24:00,178 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 33.6381 secs
2025-03-09 09:24:00,179 [INFO]: The best hyperparameters are: efSearch=260
2025-03-09 09:24:00,179 [INFO]: 	Compute fast metrics 03/09/2025, 09:24:00
  0%|          | 0/4 [00:00<?, ?it/s] 25%|██▌       | 1/4 [00:00<00:00,  6.59it/s] 75%|███████▌  | 3/4 [00:00<00:00,  9.63it/s] 75%|███████▌  | 3/4 [00:00<00:00,  7.38it/s]
2025-03-09 09:24:15,305 [INFO]: 	>>> Finished "Compute fast metrics" in 15.1264 secs
2025-03-09 09:24:15,307 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 52.7367 secs
2025-03-09 09:24:15,307 [INFO]: {
2025-03-09 09:24:15,307 [INFO]: 	index_key: HNSW15
2025-03-09 09:24:15,307 [INFO]: 	index_param: efSearch=260
2025-03-09 09:24:15,307 [INFO]: 	index_path: knn.index
2025-03-09 09:24:15,307 [INFO]: 	size in bytes: 627022510
2025-03-09 09:24:15,308 [INFO]: 	avg_search_speed_ms: 10.854559435825653
2025-03-09 09:24:15,308 [INFO]: 	99p_search_speed_ms: 18.93909475766121
2025-03-09 09:24:15,308 [INFO]: 	reconstruction error %: 0.0
2025-03-09 09:24:15,308 [INFO]: 	nb vectors: 3187
2025-03-09 09:24:15,308 [INFO]: 	vectors dimension: 49152
2025-03-09 09:24:15,308 [INFO]: 	compression ratio: 0.9993097313204912
2025-03-09 09:24:15,308 [INFO]: }
2025-03-09 09:24:15,308 [INFO]: 	>>> Finished "Creating the index" in 52.7381 secs
2025-03-09 09:24:15,308 [INFO]: >>> Finished "Launching the whole pipeline" in 52.7625 secs
2025-03-09 09:24:16: [retrieval_preprocessing] calculating distances ...
2025-03-09 09:24:16: [retrieval_preprocessing] finished and saved retrieval indices for episode 51229 [episode count 12/20]
[retrieval_preprocessing] for episode 69665 [episode count 13/20], we have num_retrieval=np.int64(3174) num_query=np.int64(156)
2025-03-09 09:24:17,697 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-09 09:24:18,172 [INFO]: Launching the whole pipeline 03/09/2025, 09:24:18
2025-03-09 09:24:18,172 [INFO]: Reading total number of vectors and dimension 03/09/2025, 09:24:18
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1091.41it/s]
2025-03-09 09:24:18,198 [INFO]: There are 3174 embeddings of dim 49152
2025-03-09 09:24:18,199 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0266 secs
2025-03-09 09:24:18,199 [INFO]: 	Compute estimated construction time of the index 03/09/2025, 09:24:18
2025-03-09 09:24:18,199 [INFO]: 		-> Train: 16.7 minutes
2025-03-09 09:24:18,199 [INFO]: 		-> Add: 1.7 seconds
2025-03-09 09:24:18,199 [INFO]: 		Total: 16.7 minutes
2025-03-09 09:24:18,199 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0002 secs
2025-03-09 09:24:18,199 [INFO]: 	Checking that your have enough memory available to create the index 03/09/2025, 09:24:18
2025-03-09 09:24:18,199 [INFO]: 655.0MB of memory will be needed to build the index (more might be used if you have more)
2025-03-09 09:24:18,199 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0003 secs
2025-03-09 09:24:18,199 [INFO]: 	Selecting most promising index types given data characteristics 03/09/2025, 09:24:18
2025-03-09 09:24:18,199 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-09 09:24:18,199 [INFO]: 	Creating the index 03/09/2025, 09:24:18
2025-03-09 09:24:18,199 [INFO]: 		-> Instanciate the index HNSW15 03/09/2025, 09:24:18
2025-03-09 09:24:18,201 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0011 secs
2025-03-09 09:24:18,201 [INFO]: 		-> Adding the vectors to the index 03/09/2025, 09:24:18
2025-03-09 09:24:18,201 [INFO]: The memory available for adding the vectors is 49.4GB(total available - used by the index)
2025-03-09 09:24:18,201 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/13 [00:00<?, ?it/s]  8%|▊         | 1/13 [00:00<00:02,  5.80it/s] 23%|██▎       | 3/13 [00:00<00:01,  9.11it/s] 38%|███▊      | 5/13 [00:00<00:00,  9.90it/s] 54%|█████▍    | 7/13 [00:00<00:00, 10.23it/s] 69%|██████▉   | 9/13 [00:00<00:00, 10.57it/s] 85%|████████▍ | 11/13 [00:01<00:00, 10.83it/s]100%|██████████| 13/13 [00:03<00:00,  2.30it/s]100%|██████████| 13/13 [00:03<00:00,  3.91it/s]
2025-03-09 09:24:21,527 [INFO]: 	Computing best hyperparameters for index knn.index 03/09/2025, 09:24:21
2025-03-09 09:24:57,494 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 35.9671 secs
2025-03-09 09:24:57,494 [INFO]: The best hyperparameters are: efSearch=252
2025-03-09 09:24:57,495 [INFO]: 	Compute fast metrics 03/09/2025, 09:24:57
  0%|          | 0/4 [00:00<?, ?it/s] 25%|██▌       | 1/4 [00:00<00:00,  5.14it/s] 50%|█████     | 2/4 [00:00<00:00,  6.80it/s] 75%|███████▌  | 3/4 [00:00<00:00,  6.02it/s]
2025-03-09 09:25:11,565 [INFO]: 	>>> Finished "Compute fast metrics" in 14.0708 secs
2025-03-09 09:25:11,568 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 53.3669 secs
2025-03-09 09:25:11,568 [INFO]: {
2025-03-09 09:25:11,568 [INFO]: 	index_key: HNSW15
2025-03-09 09:25:11,568 [INFO]: 	index_param: efSearch=252
2025-03-09 09:25:11,568 [INFO]: 	index_path: knn.index
2025-03-09 09:25:11,568 [INFO]: 	size in bytes: 624464830
2025-03-09 09:25:11,568 [INFO]: 	avg_search_speed_ms: 10.035470712354543
2025-03-09 09:25:11,568 [INFO]: 	99p_search_speed_ms: 17.02630018815398
2025-03-09 09:25:11,568 [INFO]: 	reconstruction error %: 0.0
2025-03-09 09:25:11,568 [INFO]: 	nb vectors: 3174
2025-03-09 09:25:11,568 [INFO]: 	vectors dimension: 49152
2025-03-09 09:25:11,568 [INFO]: 	compression ratio: 0.9993097481566736
2025-03-09 09:25:11,568 [INFO]: }
2025-03-09 09:25:11,568 [INFO]: 	>>> Finished "Creating the index" in 53.3686 secs
2025-03-09 09:25:11,568 [INFO]: >>> Finished "Launching the whole pipeline" in 53.3961 secs
2025-03-09 09:25:12: [retrieval_preprocessing] calculating distances ...
2025-03-09 09:25:13: [retrieval_preprocessing] finished and saved retrieval indices for episode 69665 [episode count 13/20]
[retrieval_preprocessing] for episode 4130 [episode count 14/20], we have num_retrieval=np.int64(3139) num_query=np.int64(191)
2025-03-09 09:25:14,432 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-09 09:25:14,849 [INFO]: Launching the whole pipeline 03/09/2025, 09:25:14
2025-03-09 09:25:14,849 [INFO]: Reading total number of vectors and dimension 03/09/2025, 09:25:14
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1778.75it/s]
2025-03-09 09:25:14,873 [INFO]: There are 3139 embeddings of dim 49152
2025-03-09 09:25:14,873 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0235 secs
2025-03-09 09:25:14,873 [INFO]: 	Compute estimated construction time of the index 03/09/2025, 09:25:14
2025-03-09 09:25:14,873 [INFO]: 		-> Train: 16.7 minutes
2025-03-09 09:25:14,873 [INFO]: 		-> Add: 1.7 seconds
2025-03-09 09:25:14,873 [INFO]: 		Total: 16.7 minutes
2025-03-09 09:25:14,873 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0001 secs
2025-03-09 09:25:14,873 [INFO]: 	Checking that your have enough memory available to create the index 03/09/2025, 09:25:14
2025-03-09 09:25:14,873 [INFO]: 647.8MB of memory will be needed to build the index (more might be used if you have more)
2025-03-09 09:25:14,873 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0001 secs
2025-03-09 09:25:14,873 [INFO]: 	Selecting most promising index types given data characteristics 03/09/2025, 09:25:14
2025-03-09 09:25:14,873 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-09 09:25:14,873 [INFO]: 	Creating the index 03/09/2025, 09:25:14
2025-03-09 09:25:14,873 [INFO]: 		-> Instanciate the index HNSW15 03/09/2025, 09:25:14
2025-03-09 09:25:14,874 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0009 secs
2025-03-09 09:25:14,874 [INFO]: 		-> Adding the vectors to the index 03/09/2025, 09:25:14
2025-03-09 09:25:14,874 [INFO]: The memory available for adding the vectors is 49.4GB(total available - used by the index)
2025-03-09 09:25:14,874 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/13 [00:00<?, ?it/s]  8%|▊         | 1/13 [00:00<00:01,  6.45it/s] 23%|██▎       | 3/13 [00:00<00:00, 10.23it/s] 38%|███▊      | 5/13 [00:00<00:00, 11.41it/s] 54%|█████▍    | 7/13 [00:00<00:00, 11.62it/s] 69%|██████▉   | 9/13 [00:00<00:00, 12.09it/s] 85%|████████▍ | 11/13 [00:00<00:00, 12.44it/s]100%|██████████| 13/13 [00:03<00:00,  2.48it/s]100%|██████████| 13/13 [00:03<00:00,  4.28it/s]
2025-03-09 09:25:17,915 [INFO]: 	Computing best hyperparameters for index knn.index 03/09/2025, 09:25:17
2025-03-09 09:25:52,009 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 34.0937 secs
2025-03-09 09:25:52,009 [INFO]: The best hyperparameters are: efSearch=257
2025-03-09 09:25:52,009 [INFO]: 	Compute fast metrics 03/09/2025, 09:25:52
  0%|          | 0/4 [00:00<?, ?it/s] 25%|██▌       | 1/4 [00:00<00:00,  5.11it/s] 50%|█████     | 2/4 [00:00<00:00,  6.64it/s] 75%|███████▌  | 3/4 [00:00<00:00,  7.43it/s] 75%|███████▌  | 3/4 [00:00<00:00,  5.51it/s]
2025-03-09 09:26:07,863 [INFO]: 	>>> Finished "Compute fast metrics" in 15.8536 secs
2025-03-09 09:26:07,865 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 52.9907 secs
2025-03-09 09:26:07,865 [INFO]: {
2025-03-09 09:26:07,865 [INFO]: 	index_key: HNSW15
2025-03-09 09:26:07,865 [INFO]: 	index_param: efSearch=257
2025-03-09 09:26:07,865 [INFO]: 	index_path: knn.index
2025-03-09 09:26:07,865 [INFO]: 	size in bytes: 617578870
2025-03-09 09:26:07,865 [INFO]: 	avg_search_speed_ms: 10.542490911886912
2025-03-09 09:26:07,865 [INFO]: 	99p_search_speed_ms: 17.226672582328312
2025-03-09 09:26:07,865 [INFO]: 	reconstruction error %: 0.0
2025-03-09 09:26:07,865 [INFO]: 	nb vectors: 3139
2025-03-09 09:26:07,865 [INFO]: 	vectors dimension: 49152
2025-03-09 09:26:07,865 [INFO]: 	compression ratio: 0.9993096298777191
2025-03-09 09:26:07,865 [INFO]: }
2025-03-09 09:26:07,865 [INFO]: 	>>> Finished "Creating the index" in 52.9920 secs
2025-03-09 09:26:07,865 [INFO]: >>> Finished "Launching the whole pipeline" in 53.0161 secs
2025-03-09 09:26:09: [retrieval_preprocessing] calculating distances ...
2025-03-09 09:26:09: [retrieval_preprocessing] finished and saved retrieval indices for episode 4130 [episode count 14/20]
[retrieval_preprocessing] for episode 34850 [episode count 15/20], we have num_retrieval=np.int64(3151) num_query=np.int64(179)
2025-03-09 09:26:10,561 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-09 09:26:10,970 [INFO]: Launching the whole pipeline 03/09/2025, 09:26:10
2025-03-09 09:26:10,970 [INFO]: Reading total number of vectors and dimension 03/09/2025, 09:26:10
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 2285.72it/s]
2025-03-09 09:26:10,992 [INFO]: There are 3151 embeddings of dim 49152
2025-03-09 09:26:10,992 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0220 secs
2025-03-09 09:26:10,992 [INFO]: 	Compute estimated construction time of the index 03/09/2025, 09:26:10
2025-03-09 09:26:10,993 [INFO]: 		-> Train: 16.7 minutes
2025-03-09 09:26:10,993 [INFO]: 		-> Add: 1.7 seconds
2025-03-09 09:26:10,993 [INFO]: 		Total: 16.7 minutes
2025-03-09 09:26:10,993 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0001 secs
2025-03-09 09:26:10,993 [INFO]: 	Checking that your have enough memory available to create the index 03/09/2025, 09:26:10
2025-03-09 09:26:10,993 [INFO]: 650.3MB of memory will be needed to build the index (more might be used if you have more)
2025-03-09 09:26:10,993 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0001 secs
2025-03-09 09:26:10,993 [INFO]: 	Selecting most promising index types given data characteristics 03/09/2025, 09:26:10
2025-03-09 09:26:10,993 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-09 09:26:10,993 [INFO]: 	Creating the index 03/09/2025, 09:26:10
2025-03-09 09:26:10,993 [INFO]: 		-> Instanciate the index HNSW15 03/09/2025, 09:26:10
2025-03-09 09:26:10,994 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0009 secs
2025-03-09 09:26:10,994 [INFO]: 		-> Adding the vectors to the index 03/09/2025, 09:26:10
2025-03-09 09:26:10,994 [INFO]: The memory available for adding the vectors is 49.4GB(total available - used by the index)
2025-03-09 09:26:10,994 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/13 [00:00<?, ?it/s]  8%|▊         | 1/13 [00:00<00:02,  5.74it/s] 15%|█▌        | 2/13 [00:00<00:01,  7.44it/s] 23%|██▎       | 3/13 [00:00<00:01,  8.20it/s] 31%|███       | 4/13 [00:00<00:01,  8.58it/s] 46%|████▌     | 6/13 [00:00<00:00,  9.18it/s] 54%|█████▍    | 7/13 [00:00<00:00,  9.14it/s] 62%|██████▏   | 8/13 [00:00<00:00,  9.18it/s] 69%|██████▉   | 9/13 [00:01<00:00,  9.17it/s] 85%|████████▍ | 11/13 [00:01<00:00,  9.44it/s] 92%|█████████▏| 12/13 [00:01<00:00,  9.33it/s]100%|██████████| 13/13 [00:03<00:00,  1.40it/s]100%|██████████| 13/13 [00:03<00:00,  3.41it/s]
2025-03-09 09:26:14,804 [INFO]: 	Computing best hyperparameters for index knn.index 03/09/2025, 09:26:14
2025-03-09 09:26:50,439 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 35.6340 secs
2025-03-09 09:26:50,439 [INFO]: The best hyperparameters are: efSearch=260
2025-03-09 09:26:50,439 [INFO]: 	Compute fast metrics 03/09/2025, 09:26:50
  0%|          | 0/4 [00:00<?, ?it/s] 25%|██▌       | 1/4 [00:00<00:00,  5.50it/s] 50%|█████     | 2/4 [00:00<00:00,  7.32it/s] 75%|███████▌  | 3/4 [00:00<00:00,  8.09it/s] 75%|███████▌  | 3/4 [00:00<00:00,  6.04it/s]
2025-03-09 09:27:10,784 [INFO]: 	>>> Finished "Compute fast metrics" in 20.3446 secs
2025-03-09 09:27:10,786 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 59.7917 secs
2025-03-09 09:27:10,786 [INFO]: {
2025-03-09 09:27:10,786 [INFO]: 	index_key: HNSW15
2025-03-09 09:27:10,786 [INFO]: 	index_param: efSearch=260
2025-03-09 09:27:10,786 [INFO]: 	index_path: knn.index
2025-03-09 09:27:10,786 [INFO]: 	size in bytes: 619939810
2025-03-09 09:27:10,786 [INFO]: 	avg_search_speed_ms: 10.521967591743302
2025-03-09 09:27:10,786 [INFO]: 	99p_search_speed_ms: 17.438029986806214
2025-03-09 09:27:10,786 [INFO]: 	reconstruction error %: 0.0
2025-03-09 09:27:10,786 [INFO]: 	nb vectors: 3151
2025-03-09 09:27:10,786 [INFO]: 	vectors dimension: 49152
2025-03-09 09:27:10,786 [INFO]: 	compression ratio: 0.999309607169767
2025-03-09 09:27:10,786 [INFO]: }
2025-03-09 09:27:10,786 [INFO]: 	>>> Finished "Creating the index" in 59.7930 secs
2025-03-09 09:27:10,786 [INFO]: >>> Finished "Launching the whole pipeline" in 59.8155 secs
2025-03-09 09:27:11: [retrieval_preprocessing] calculating distances ...
2025-03-09 09:27:12: [retrieval_preprocessing] finished and saved retrieval indices for episode 34850 [episode count 15/20]
[retrieval_preprocessing] for episode 79905 [episode count 16/20], we have num_retrieval=np.int64(3168) num_query=np.int64(162)
2025-03-09 09:27:13,018 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-09 09:27:13,454 [INFO]: Launching the whole pipeline 03/09/2025, 09:27:13
2025-03-09 09:27:13,454 [INFO]: Reading total number of vectors and dimension 03/09/2025, 09:27:13
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1818.08it/s]
2025-03-09 09:27:13,483 [INFO]: There are 3168 embeddings of dim 49152
2025-03-09 09:27:13,483 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0286 secs
2025-03-09 09:27:13,483 [INFO]: 	Compute estimated construction time of the index 03/09/2025, 09:27:13
2025-03-09 09:27:13,483 [INFO]: 		-> Train: 16.7 minutes
2025-03-09 09:27:13,484 [INFO]: 		-> Add: 1.7 seconds
2025-03-09 09:27:13,484 [INFO]: 		Total: 16.7 minutes
2025-03-09 09:27:13,484 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0003 secs
2025-03-09 09:27:13,484 [INFO]: 	Checking that your have enough memory available to create the index 03/09/2025, 09:27:13
2025-03-09 09:27:13,484 [INFO]: 653.8MB of memory will be needed to build the index (more might be used if you have more)
2025-03-09 09:27:13,484 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0005 secs
2025-03-09 09:27:13,484 [INFO]: 	Selecting most promising index types given data characteristics 03/09/2025, 09:27:13
2025-03-09 09:27:13,484 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-09 09:27:13,485 [INFO]: 	Creating the index 03/09/2025, 09:27:13
2025-03-09 09:27:13,485 [INFO]: 		-> Instanciate the index HNSW15 03/09/2025, 09:27:13
2025-03-09 09:27:13,488 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0028 secs
2025-03-09 09:27:13,488 [INFO]: 		-> Adding the vectors to the index 03/09/2025, 09:27:13
2025-03-09 09:27:13,488 [INFO]: The memory available for adding the vectors is 49.4GB(total available - used by the index)
2025-03-09 09:27:13,488 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/13 [00:00<?, ?it/s]  8%|▊         | 1/13 [00:00<00:01,  8.01it/s] 23%|██▎       | 3/13 [00:00<00:00, 13.94it/s] 38%|███▊      | 5/13 [00:00<00:00, 10.50it/s] 54%|█████▍    | 7/13 [00:00<00:00,  9.61it/s] 69%|██████▉   | 9/13 [00:00<00:00, 10.63it/s] 85%|████████▍ | 11/13 [00:00<00:00, 11.78it/s]100%|██████████| 13/13 [00:03<00:00,  2.53it/s]100%|██████████| 13/13 [00:03<00:00,  4.31it/s]
2025-03-09 09:27:16,513 [INFO]: 	Computing best hyperparameters for index knn.index 03/09/2025, 09:27:16
2025-03-09 09:27:48,663 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 32.1490 secs
2025-03-09 09:27:48,663 [INFO]: The best hyperparameters are: efSearch=260
2025-03-09 09:27:48,663 [INFO]: 	Compute fast metrics 03/09/2025, 09:27:48
  0%|          | 0/4 [00:00<?, ?it/s] 25%|██▌       | 1/4 [00:00<00:00,  5.28it/s] 50%|█████     | 2/4 [00:00<00:00,  6.82it/s] 75%|███████▌  | 3/4 [00:00<00:00,  7.63it/s] 75%|███████▌  | 3/4 [00:00<00:00,  5.78it/s]
2025-03-09 09:28:06,429 [INFO]: 	>>> Finished "Compute fast metrics" in 17.7655 secs
2025-03-09 09:28:06,904 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 53.4162 secs
2025-03-09 09:28:06,904 [INFO]: {
2025-03-09 09:28:06,905 [INFO]: 	index_key: HNSW15
2025-03-09 09:28:06,905 [INFO]: 	index_param: efSearch=260
2025-03-09 09:28:06,905 [INFO]: 	index_path: knn.index
2025-03-09 09:28:06,905 [INFO]: 	size in bytes: 623284390
2025-03-09 09:28:06,905 [INFO]: 	avg_search_speed_ms: 10.56841179560161
2025-03-09 09:28:06,905 [INFO]: 	99p_search_speed_ms: 19.445263396482915
2025-03-09 09:28:06,905 [INFO]: 	reconstruction error %: 0.0
2025-03-09 09:28:06,905 [INFO]: 	nb vectors: 3168
2025-03-09 09:28:06,905 [INFO]: 	vectors dimension: 49152
2025-03-09 09:28:06,905 [INFO]: 	compression ratio: 0.9993097115748398
2025-03-09 09:28:06,905 [INFO]: }
2025-03-09 09:28:06,905 [INFO]: 	>>> Finished "Creating the index" in 53.4206 secs
2025-03-09 09:28:06,905 [INFO]: >>> Finished "Launching the whole pipeline" in 53.4510 secs
2025-03-09 09:28:07: [retrieval_preprocessing] calculating distances ...
2025-03-09 09:28:08: [retrieval_preprocessing] finished and saved retrieval indices for episode 79905 [episode count 16/20]
[retrieval_preprocessing] for episode 88097 [episode count 17/20], we have num_retrieval=np.int64(3192) num_query=np.int64(138)
2025-03-09 09:28:09,320 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-09 09:28:09,746 [INFO]: Launching the whole pipeline 03/09/2025, 09:28:09
2025-03-09 09:28:09,746 [INFO]: Reading total number of vectors and dimension 03/09/2025, 09:28:09
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1478.43it/s]
2025-03-09 09:28:09,771 [INFO]: There are 3192 embeddings of dim 49152
2025-03-09 09:28:09,771 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0250 secs
2025-03-09 09:28:09,771 [INFO]: 	Compute estimated construction time of the index 03/09/2025, 09:28:09
2025-03-09 09:28:09,771 [INFO]: 		-> Train: 16.7 minutes
2025-03-09 09:28:09,771 [INFO]: 		-> Add: 1.8 seconds
2025-03-09 09:28:09,771 [INFO]: 		Total: 16.7 minutes
2025-03-09 09:28:09,771 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0001 secs
2025-03-09 09:28:09,771 [INFO]: 	Checking that your have enough memory available to create the index 03/09/2025, 09:28:09
2025-03-09 09:28:09,771 [INFO]: 658.8MB of memory will be needed to build the index (more might be used if you have more)
2025-03-09 09:28:09,772 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0001 secs
2025-03-09 09:28:09,772 [INFO]: 	Selecting most promising index types given data characteristics 03/09/2025, 09:28:09
2025-03-09 09:28:09,772 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-09 09:28:09,772 [INFO]: 	Creating the index 03/09/2025, 09:28:09
2025-03-09 09:28:09,772 [INFO]: 		-> Instanciate the index HNSW15 03/09/2025, 09:28:09
2025-03-09 09:28:09,773 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0009 secs
2025-03-09 09:28:09,773 [INFO]: 		-> Adding the vectors to the index 03/09/2025, 09:28:09
2025-03-09 09:28:09,773 [INFO]: The memory available for adding the vectors is 49.4GB(total available - used by the index)
2025-03-09 09:28:09,773 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/13 [00:00<?, ?it/s]  8%|▊         | 1/13 [00:00<00:02,  5.99it/s] 23%|██▎       | 3/13 [00:00<00:01,  9.84it/s] 31%|███       | 4/13 [00:00<00:01,  8.63it/s] 38%|███▊      | 5/13 [00:00<00:00,  8.27it/s] 54%|█████▍    | 7/13 [00:00<00:00,  9.94it/s] 69%|██████▉   | 9/13 [00:00<00:00, 10.99it/s] 85%|████████▍ | 11/13 [00:01<00:00, 11.71it/s]100%|██████████| 13/13 [00:03<00:00,  2.31it/s]100%|██████████| 13/13 [00:03<00:00,  4.00it/s]
2025-03-09 09:28:13,027 [INFO]: 	Computing best hyperparameters for index knn.index 03/09/2025, 09:28:13
2025-03-09 09:28:47,912 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 34.8848 secs
2025-03-09 09:28:47,912 [INFO]: The best hyperparameters are: efSearch=294
2025-03-09 09:28:47,912 [INFO]: 	Compute fast metrics 03/09/2025, 09:28:47
  0%|          | 0/4 [00:00<?, ?it/s] 25%|██▌       | 1/4 [00:00<00:00,  5.31it/s] 75%|███████▌  | 3/4 [00:00<00:00,  8.10it/s] 75%|███████▌  | 3/4 [00:00<00:00,  6.11it/s]
2025-03-09 09:29:09,361 [INFO]: 	>>> Finished "Compute fast metrics" in 21.4488 secs
2025-03-09 09:29:09,363 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 59.5906 secs
2025-03-09 09:29:09,363 [INFO]: {
2025-03-09 09:29:09,363 [INFO]: 	index_key: HNSW15
2025-03-09 09:29:09,363 [INFO]: 	index_param: efSearch=294
2025-03-09 09:29:09,363 [INFO]: 	index_path: knn.index
2025-03-09 09:29:09,364 [INFO]: 	size in bytes: 628006210
2025-03-09 09:29:09,364 [INFO]: 	avg_search_speed_ms: 11.820245041824595
2025-03-09 09:29:09,364 [INFO]: 	99p_search_speed_ms: 22.457370441406944
2025-03-09 09:29:09,364 [INFO]: 	reconstruction error %: 0.0
2025-03-09 09:29:09,364 [INFO]: 	nb vectors: 3192
2025-03-09 09:29:09,364 [INFO]: 	vectors dimension: 49152
2025-03-09 09:29:09,364 [INFO]: 	compression ratio: 0.9993097616025166
2025-03-09 09:29:09,364 [INFO]: }
2025-03-09 09:29:09,364 [INFO]: 	>>> Finished "Creating the index" in 59.5920 secs
2025-03-09 09:29:09,364 [INFO]: >>> Finished "Launching the whole pipeline" in 59.6175 secs
2025-03-09 09:29:10: [retrieval_preprocessing] calculating distances ...
2025-03-09 09:29:10: [retrieval_preprocessing] finished and saved retrieval indices for episode 88097 [episode count 17/20]
[retrieval_preprocessing] for episode 12333 [episode count 18/20], we have num_retrieval=np.int64(3112) num_query=np.int64(218)
2025-03-09 09:29:11,838 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-09 09:29:12,218 [INFO]: Launching the whole pipeline 03/09/2025, 09:29:12
2025-03-09 09:29:12,218 [INFO]: Reading total number of vectors and dimension 03/09/2025, 09:29:12
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1436.90it/s]
2025-03-09 09:29:12,244 [INFO]: There are 3112 embeddings of dim 49152
2025-03-09 09:29:12,244 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0261 secs
2025-03-09 09:29:12,244 [INFO]: 	Compute estimated construction time of the index 03/09/2025, 09:29:12
2025-03-09 09:29:12,244 [INFO]: 		-> Train: 16.7 minutes
2025-03-09 09:29:12,244 [INFO]: 		-> Add: 1.7 seconds
2025-03-09 09:29:12,244 [INFO]: 		Total: 16.7 minutes
2025-03-09 09:29:12,244 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0001 secs
2025-03-09 09:29:12,244 [INFO]: 	Checking that your have enough memory available to create the index 03/09/2025, 09:29:12
2025-03-09 09:29:12,244 [INFO]: 642.2MB of memory will be needed to build the index (more might be used if you have more)
2025-03-09 09:29:12,244 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0002 secs
2025-03-09 09:29:12,244 [INFO]: 	Selecting most promising index types given data characteristics 03/09/2025, 09:29:12
2025-03-09 09:29:12,244 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-09 09:29:12,244 [INFO]: 	Creating the index 03/09/2025, 09:29:12
2025-03-09 09:29:12,244 [INFO]: 		-> Instanciate the index HNSW15 03/09/2025, 09:29:12
2025-03-09 09:29:12,246 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0012 secs
2025-03-09 09:29:12,246 [INFO]: 		-> Adding the vectors to the index 03/09/2025, 09:29:12
2025-03-09 09:29:12,246 [INFO]: The memory available for adding the vectors is 49.4GB(total available - used by the index)
2025-03-09 09:29:12,246 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/13 [00:00<?, ?it/s]  8%|▊         | 1/13 [00:00<00:02,  5.93it/s] 23%|██▎       | 3/13 [00:00<00:01,  9.99it/s] 38%|███▊      | 5/13 [00:00<00:00, 11.39it/s] 54%|█████▍    | 7/13 [00:00<00:00, 12.22it/s] 69%|██████▉   | 9/13 [00:00<00:00, 12.63it/s] 85%|████████▍ | 11/13 [00:00<00:00, 12.87it/s]100%|██████████| 13/13 [00:03<00:00,  2.43it/s]100%|██████████| 13/13 [00:03<00:00,  4.22it/s]
2025-03-09 09:29:15,332 [INFO]: 	Computing best hyperparameters for index knn.index 03/09/2025, 09:29:15
2025-03-09 09:29:51,244 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 35.9117 secs
2025-03-09 09:29:51,244 [INFO]: The best hyperparameters are: efSearch=199
2025-03-09 09:29:51,244 [INFO]: 	Compute fast metrics 03/09/2025, 09:29:51
  0%|          | 0/4 [00:00<?, ?it/s] 25%|██▌       | 1/4 [00:00<00:00,  6.05it/s] 75%|███████▌  | 3/4 [00:00<00:00,  9.80it/s] 75%|███████▌  | 3/4 [00:00<00:00,  7.49it/s]
2025-03-09 09:30:06,771 [INFO]: 	>>> Finished "Compute fast metrics" in 15.5267 secs
2025-03-09 09:30:06,773 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 54.5277 secs
2025-03-09 09:30:06,774 [INFO]: {
2025-03-09 09:30:06,774 [INFO]: 	index_key: HNSW15
2025-03-09 09:30:06,774 [INFO]: 	index_param: efSearch=199
2025-03-09 09:30:06,774 [INFO]: 	index_path: knn.index
2025-03-09 09:30:06,774 [INFO]: 	size in bytes: 612266710
2025-03-09 09:30:06,774 [INFO]: 	avg_search_speed_ms: 9.791789305041545
2025-03-09 09:30:06,774 [INFO]: 	99p_search_speed_ms: 19.90821231156583
2025-03-09 09:30:06,774 [INFO]: 	reconstruction error %: 0.0
2025-03-09 09:30:06,774 [INFO]: 	nb vectors: 3112
2025-03-09 09:30:06,774 [INFO]: 	vectors dimension: 49152
2025-03-09 09:30:06,774 [INFO]: 	compression ratio: 0.999309755057563
2025-03-09 09:30:06,774 [INFO]: }
2025-03-09 09:30:06,774 [INFO]: 	>>> Finished "Creating the index" in 54.5293 secs
2025-03-09 09:30:06,774 [INFO]: >>> Finished "Launching the whole pipeline" in 54.5561 secs
2025-03-09 09:30:07: [retrieval_preprocessing] calculating distances ...
2025-03-09 09:30:08: [retrieval_preprocessing] finished and saved retrieval indices for episode 12333 [episode count 18/20]
[retrieval_preprocessing] for episode 34863 [episode count 19/20], we have num_retrieval=np.int64(3131) num_query=np.int64(199)
2025-03-09 09:30:09,289 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-09 09:30:09,703 [INFO]: Launching the whole pipeline 03/09/2025, 09:30:09
2025-03-09 09:30:09,703 [INFO]: Reading total number of vectors and dimension 03/09/2025, 09:30:09
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1171.92it/s]
2025-03-09 09:30:09,730 [INFO]: There are 3131 embeddings of dim 49152
2025-03-09 09:30:09,730 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0276 secs
2025-03-09 09:30:09,731 [INFO]: 	Compute estimated construction time of the index 03/09/2025, 09:30:09
2025-03-09 09:30:09,731 [INFO]: 		-> Train: 16.7 minutes
2025-03-09 09:30:09,731 [INFO]: 		-> Add: 1.7 seconds
2025-03-09 09:30:09,731 [INFO]: 		Total: 16.7 minutes
2025-03-09 09:30:09,731 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0001 secs
2025-03-09 09:30:09,731 [INFO]: 	Checking that your have enough memory available to create the index 03/09/2025, 09:30:09
2025-03-09 09:30:09,731 [INFO]: 646.2MB of memory will be needed to build the index (more might be used if you have more)
2025-03-09 09:30:09,731 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0002 secs
2025-03-09 09:30:09,731 [INFO]: 	Selecting most promising index types given data characteristics 03/09/2025, 09:30:09
2025-03-09 09:30:09,731 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-09 09:30:09,731 [INFO]: 	Creating the index 03/09/2025, 09:30:09
2025-03-09 09:30:09,731 [INFO]: 		-> Instanciate the index HNSW15 03/09/2025, 09:30:09
2025-03-09 09:30:09,733 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0013 secs
2025-03-09 09:30:09,733 [INFO]: 		-> Adding the vectors to the index 03/09/2025, 09:30:09
2025-03-09 09:30:09,733 [INFO]: The memory available for adding the vectors is 49.4GB(total available - used by the index)
2025-03-09 09:30:09,733 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/13 [00:00<?, ?it/s]  8%|▊         | 1/13 [00:00<00:01,  6.90it/s] 23%|██▎       | 3/13 [00:00<00:00, 10.92it/s] 38%|███▊      | 5/13 [00:00<00:00, 11.67it/s] 54%|█████▍    | 7/13 [00:00<00:00, 11.97it/s] 69%|██████▉   | 9/13 [00:00<00:00, 12.10it/s] 85%|████████▍ | 11/13 [00:00<00:00, 12.35it/s]100%|██████████| 13/13 [00:03<00:00,  2.40it/s]100%|██████████| 13/13 [00:03<00:00,  4.18it/s]
2025-03-09 09:30:12,844 [INFO]: 	Computing best hyperparameters for index knn.index 03/09/2025, 09:30:12
2025-03-09 09:30:42,132 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 29.2879 secs
2025-03-09 09:30:42,132 [INFO]: The best hyperparameters are: efSearch=236
2025-03-09 09:30:42,132 [INFO]: 	Compute fast metrics 03/09/2025, 09:30:42
  0%|          | 0/4 [00:00<?, ?it/s] 25%|██▌       | 1/4 [00:00<00:00,  5.45it/s] 50%|█████     | 2/4 [00:00<00:00,  7.14it/s] 75%|███████▌  | 3/4 [00:00<00:00,  8.03it/s] 75%|███████▌  | 3/4 [00:00<00:00,  5.91it/s]
2025-03-09 09:31:01,405 [INFO]: 	>>> Finished "Compute fast metrics" in 19.2724 secs
2025-03-09 09:31:01,407 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 51.6743 secs
2025-03-09 09:31:01,407 [INFO]: {
2025-03-09 09:31:01,407 [INFO]: 	index_key: HNSW15
2025-03-09 09:31:01,407 [INFO]: 	index_param: efSearch=236
2025-03-09 09:31:01,407 [INFO]: 	index_path: knn.index
2025-03-09 09:31:01,407 [INFO]: 	size in bytes: 616004950
2025-03-09 09:31:01,407 [INFO]: 	avg_search_speed_ms: 9.948350291291428
2025-03-09 09:31:01,407 [INFO]: 	99p_search_speed_ms: 18.70177980512382
2025-03-09 09:31:01,407 [INFO]: 	reconstruction error %: 0.0
2025-03-09 09:31:01,407 [INFO]: 	nb vectors: 3131
2025-03-09 09:31:01,407 [INFO]: 	vectors dimension: 49152
2025-03-09 09:31:01,407 [INFO]: 	compression ratio: 0.9993095802233407
2025-03-09 09:31:01,407 [INFO]: }
2025-03-09 09:31:01,407 [INFO]: 	>>> Finished "Creating the index" in 51.6762 secs
2025-03-09 09:31:01,407 [INFO]: >>> Finished "Launching the whole pipeline" in 51.7046 secs
2025-03-09 09:31:02: [retrieval_preprocessing] calculating distances ...
2025-03-09 09:31:03: [retrieval_preprocessing] finished and saved retrieval indices for episode 34863 [episode count 19/20]
2025-03-09 09:31:03: [retrieval_preprocessing] finished for (8376714657, 'marker') [chosen_id count 8/10]
2025-03-09 09:31:06: [retrieval_preprocessing] concatenated all embeddings and indices for 20 episodes for (3452853472, 'drawer') [chosen_id count 9/10]
2025-03-09 09:31:06: [retrieval_preprocessing] we have num_total=4436 embedding_dim=49152
[retrieval_preprocessing] for episode 93188 [episode count 0/20], we have num_retrieval=np.int64(4231) num_query=np.int64(205)
2025-03-09 09:31:07,500 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-09 09:31:08,073 [INFO]: Launching the whole pipeline 03/09/2025, 09:31:08
2025-03-09 09:31:08,073 [INFO]: Reading total number of vectors and dimension 03/09/2025, 09:31:08
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1190.55it/s]
2025-03-09 09:31:08,100 [INFO]: There are 4231 embeddings of dim 49152
2025-03-09 09:31:08,100 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0275 secs
2025-03-09 09:31:08,100 [INFO]: 	Compute estimated construction time of the index 03/09/2025, 09:31:08
2025-03-09 09:31:08,100 [INFO]: 		-> Train: 16.7 minutes
2025-03-09 09:31:08,100 [INFO]: 		-> Add: 2.3 seconds
2025-03-09 09:31:08,100 [INFO]: 		Total: 16.7 minutes
2025-03-09 09:31:08,100 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0001 secs
2025-03-09 09:31:08,101 [INFO]: 	Checking that your have enough memory available to create the index 03/09/2025, 09:31:08
2025-03-09 09:31:08,101 [INFO]: 873.2MB of memory will be needed to build the index (more might be used if you have more)
2025-03-09 09:31:08,101 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0002 secs
2025-03-09 09:31:08,101 [INFO]: 	Selecting most promising index types given data characteristics 03/09/2025, 09:31:08
2025-03-09 09:31:08,101 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-09 09:31:08,101 [INFO]: 	Creating the index 03/09/2025, 09:31:08
2025-03-09 09:31:08,101 [INFO]: 		-> Instanciate the index HNSW15 03/09/2025, 09:31:08
2025-03-09 09:31:08,102 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0012 secs
2025-03-09 09:31:08,102 [INFO]: 		-> Adding the vectors to the index 03/09/2025, 09:31:08
2025-03-09 09:31:08,102 [INFO]: The memory available for adding the vectors is 49.2GB(total available - used by the index)
2025-03-09 09:31:08,102 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/17 [00:00<?, ?it/s]  6%|▌         | 1/17 [00:00<00:03,  4.66it/s] 12%|█▏        | 2/17 [00:00<00:02,  6.20it/s] 24%|██▎       | 4/17 [00:00<00:01,  8.37it/s] 35%|███▌      | 6/17 [00:00<00:01, 10.29it/s] 65%|██████▍   | 11/17 [00:00<00:00, 20.09it/s] 94%|█████████▍| 16/17 [00:00<00:00, 23.53it/s]100%|██████████| 17/17 [00:03<00:00,  4.36it/s]
2025-03-09 09:31:12,001 [INFO]: 	Computing best hyperparameters for index knn.index 03/09/2025, 09:31:12
2025-03-09 09:31:53,521 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 41.5197 secs
2025-03-09 09:31:53,522 [INFO]: The best hyperparameters are: efSearch=313
2025-03-09 09:31:53,522 [INFO]: 	Compute fast metrics 03/09/2025, 09:31:53
  0%|          | 0/4 [00:00<?, ?it/s] 25%|██▌       | 1/4 [00:00<00:00,  6.19it/s] 75%|███████▌  | 3/4 [00:00<00:00,  9.89it/s] 75%|███████▌  | 3/4 [00:00<00:00,  7.44it/s]
2025-03-09 09:32:13,499 [INFO]: 	>>> Finished "Compute fast metrics" in 19.9775 secs
2025-03-09 09:32:13,503 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 65.4003 secs
2025-03-09 09:32:13,503 [INFO]: {
2025-03-09 09:32:13,503 [INFO]: 	index_key: HNSW15
2025-03-09 09:32:13,503 [INFO]: 	index_param: efSearch=313
2025-03-09 09:32:13,503 [INFO]: 	index_path: knn.index
2025-03-09 09:32:13,503 [INFO]: 	size in bytes: 832423810
2025-03-09 09:32:13,503 [INFO]: 	avg_search_speed_ms: 12.690065334359572
2025-03-09 09:32:13,503 [INFO]: 	99p_search_speed_ms: 22.74651202606037
2025-03-09 09:32:13,503 [INFO]: 	reconstruction error %: 0.0
2025-03-09 09:32:13,503 [INFO]: 	nb vectors: 4231
2025-03-09 09:32:13,503 [INFO]: 	vectors dimension: 49152
2025-03-09 09:32:13,503 [INFO]: 	compression ratio: 0.9993088112172092
2025-03-09 09:32:13,503 [INFO]: }
2025-03-09 09:32:13,503 [INFO]: 	>>> Finished "Creating the index" in 65.4020 secs
2025-03-09 09:32:13,503 [INFO]: >>> Finished "Launching the whole pipeline" in 65.4303 secs
2025-03-09 09:32:15: [retrieval_preprocessing] calculating distances ...
2025-03-09 09:32:15: [retrieval_preprocessing] finished and saved retrieval indices for episode 93188 [episode count 0/20]
[retrieval_preprocessing] for episode 33799 [episode count 1/20], we have num_retrieval=np.int64(4230) num_query=np.int64(206)
2025-03-09 09:32:17,508 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-09 09:32:18,081 [INFO]: Launching the whole pipeline 03/09/2025, 09:32:18
2025-03-09 09:32:18,081 [INFO]: Reading total number of vectors and dimension 03/09/2025, 09:32:18
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1186.84it/s]
2025-03-09 09:32:18,107 [INFO]: There are 4230 embeddings of dim 49152
2025-03-09 09:32:18,107 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0259 secs
2025-03-09 09:32:18,107 [INFO]: 	Compute estimated construction time of the index 03/09/2025, 09:32:18
2025-03-09 09:32:18,107 [INFO]: 		-> Train: 16.7 minutes
2025-03-09 09:32:18,107 [INFO]: 		-> Add: 2.3 seconds
2025-03-09 09:32:18,107 [INFO]: 		Total: 16.7 minutes
2025-03-09 09:32:18,107 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0001 secs
2025-03-09 09:32:18,107 [INFO]: 	Checking that your have enough memory available to create the index 03/09/2025, 09:32:18
2025-03-09 09:32:18,107 [INFO]: 873.0MB of memory will be needed to build the index (more might be used if you have more)
2025-03-09 09:32:18,107 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0001 secs
2025-03-09 09:32:18,107 [INFO]: 	Selecting most promising index types given data characteristics 03/09/2025, 09:32:18
2025-03-09 09:32:18,107 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-09 09:32:18,107 [INFO]: 	Creating the index 03/09/2025, 09:32:18
2025-03-09 09:32:18,107 [INFO]: 		-> Instanciate the index HNSW15 03/09/2025, 09:32:18
2025-03-09 09:32:18,108 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0009 secs
2025-03-09 09:32:18,108 [INFO]: 		-> Adding the vectors to the index 03/09/2025, 09:32:18
2025-03-09 09:32:18,109 [INFO]: The memory available for adding the vectors is 49.2GB(total available - used by the index)
2025-03-09 09:32:18,109 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/17 [00:00<?, ?it/s]  6%|▌         | 1/17 [00:00<00:02,  5.70it/s] 18%|█▊        | 3/17 [00:00<00:01,  9.11it/s] 29%|██▉       | 5/17 [00:00<00:01, 10.32it/s] 41%|████      | 7/17 [00:00<00:00, 10.81it/s] 53%|█████▎    | 9/17 [00:00<00:00, 11.23it/s] 65%|██████▍   | 11/17 [00:01<00:00, 11.41it/s] 76%|███████▋  | 13/17 [00:01<00:00, 11.45it/s] 88%|████████▊ | 15/17 [00:01<00:00, 11.66it/s]100%|██████████| 17/17 [00:04<00:00,  1.94it/s]100%|██████████| 17/17 [00:04<00:00,  3.98it/s]
2025-03-09 09:32:22,380 [INFO]: 	Computing best hyperparameters for index knn.index 03/09/2025, 09:32:22
2025-03-09 09:32:59,367 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 36.9870 secs
2025-03-09 09:32:59,368 [INFO]: The best hyperparameters are: efSearch=253
2025-03-09 09:32:59,368 [INFO]: 	Compute fast metrics 03/09/2025, 09:32:59
  0%|          | 0/4 [00:00<?, ?it/s] 25%|██▌       | 1/4 [00:00<00:00,  5.69it/s] 50%|█████     | 2/4 [00:00<00:00,  7.20it/s] 75%|███████▌  | 3/4 [00:00<00:00,  7.82it/s] 75%|███████▌  | 3/4 [00:00<00:00,  5.87it/s]
2025-03-09 09:33:17,479 [INFO]: 	>>> Finished "Compute fast metrics" in 18.1117 secs
2025-03-09 09:33:17,483 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 59.3742 secs
2025-03-09 09:33:17,483 [INFO]: {
2025-03-09 09:33:17,483 [INFO]: 	index_key: HNSW15
2025-03-09 09:33:17,483 [INFO]: 	index_param: efSearch=253
2025-03-09 09:33:17,483 [INFO]: 	index_path: knn.index
2025-03-09 09:33:17,483 [INFO]: 	size in bytes: 832227070
2025-03-09 09:33:17,483 [INFO]: 	avg_search_speed_ms: 10.84587595477006
2025-03-09 09:33:17,483 [INFO]: 	99p_search_speed_ms: 18.86372030712664
2025-03-09 09:33:17,483 [INFO]: 	reconstruction error %: 0.0
2025-03-09 09:33:17,483 [INFO]: 	nb vectors: 4230
2025-03-09 09:33:17,483 [INFO]: 	vectors dimension: 49152
2025-03-09 09:33:17,483 [INFO]: 	compression ratio: 0.9993088064294761
2025-03-09 09:33:17,483 [INFO]: }
2025-03-09 09:33:17,483 [INFO]: 	>>> Finished "Creating the index" in 59.3756 secs
2025-03-09 09:33:17,483 [INFO]: >>> Finished "Launching the whole pipeline" in 59.4020 secs
2025-03-09 09:33:18: [retrieval_preprocessing] calculating distances ...
2025-03-09 09:33:19: [retrieval_preprocessing] finished and saved retrieval indices for episode 33799 [episode count 1/20]
[retrieval_preprocessing] for episode 42504 [episode count 2/20], we have num_retrieval=np.int64(4253) num_query=np.int64(183)
2025-03-09 09:33:21,461 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-09 09:33:22,044 [INFO]: Launching the whole pipeline 03/09/2025, 09:33:22
2025-03-09 09:33:22,044 [INFO]: Reading total number of vectors and dimension 03/09/2025, 09:33:22
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1191.23it/s]
2025-03-09 09:33:22,070 [INFO]: There are 4253 embeddings of dim 49152
2025-03-09 09:33:22,070 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0263 secs
2025-03-09 09:33:22,070 [INFO]: 	Compute estimated construction time of the index 03/09/2025, 09:33:22
2025-03-09 09:33:22,070 [INFO]: 		-> Train: 16.7 minutes
2025-03-09 09:33:22,071 [INFO]: 		-> Add: 2.3 seconds
2025-03-09 09:33:22,071 [INFO]: 		Total: 16.7 minutes
2025-03-09 09:33:22,071 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0001 secs
2025-03-09 09:33:22,071 [INFO]: 	Checking that your have enough memory available to create the index 03/09/2025, 09:33:22
2025-03-09 09:33:22,071 [INFO]: 877.7MB of memory will be needed to build the index (more might be used if you have more)
2025-03-09 09:33:22,071 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0003 secs
2025-03-09 09:33:22,071 [INFO]: 	Selecting most promising index types given data characteristics 03/09/2025, 09:33:22
2025-03-09 09:33:22,071 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-09 09:33:22,071 [INFO]: 	Creating the index 03/09/2025, 09:33:22
2025-03-09 09:33:22,071 [INFO]: 		-> Instanciate the index HNSW15 03/09/2025, 09:33:22
2025-03-09 09:33:22,072 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0012 secs
2025-03-09 09:33:22,072 [INFO]: 		-> Adding the vectors to the index 03/09/2025, 09:33:22
2025-03-09 09:33:22,072 [INFO]: The memory available for adding the vectors is 49.2GB(total available - used by the index)
2025-03-09 09:33:22,073 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/17 [00:00<?, ?it/s]  6%|▌         | 1/17 [00:00<00:02,  5.90it/s] 18%|█▊        | 3/17 [00:00<00:01,  9.34it/s] 29%|██▉       | 5/17 [00:00<00:01, 10.47it/s] 41%|████      | 7/17 [00:00<00:00, 10.81it/s] 53%|█████▎    | 9/17 [00:00<00:00, 10.98it/s] 65%|██████▍   | 11/17 [00:01<00:00, 11.02it/s] 76%|███████▋  | 13/17 [00:01<00:00, 10.98it/s] 88%|████████▊ | 15/17 [00:01<00:00, 10.93it/s]100%|██████████| 17/17 [00:04<00:00,  1.89it/s]100%|██████████| 17/17 [00:04<00:00,  3.89it/s]
2025-03-09 09:33:26,446 [INFO]: 	Computing best hyperparameters for index knn.index 03/09/2025, 09:33:26
2025-03-09 09:34:02,484 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 36.0375 secs
2025-03-09 09:34:02,485 [INFO]: The best hyperparameters are: efSearch=259
2025-03-09 09:34:02,485 [INFO]: 	Compute fast metrics 03/09/2025, 09:34:02
  0%|          | 0/4 [00:00<?, ?it/s] 25%|██▌       | 1/4 [00:00<00:00,  9.98it/s] 75%|███████▌  | 3/4 [00:01<00:00,  2.45it/s] 75%|███████▌  | 3/4 [00:01<00:00,  2.01it/s]
2025-03-09 09:34:24,460 [INFO]: 	>>> Finished "Compute fast metrics" in 21.9754 secs
2025-03-09 09:34:24,463 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 62.3905 secs
2025-03-09 09:34:24,463 [INFO]: {
2025-03-09 09:34:24,463 [INFO]: 	index_key: HNSW15
2025-03-09 09:34:24,463 [INFO]: 	index_param: efSearch=259
2025-03-09 09:34:24,463 [INFO]: 	index_path: knn.index
2025-03-09 09:34:24,463 [INFO]: 	size in bytes: 836752270
2025-03-09 09:34:24,463 [INFO]: 	avg_search_speed_ms: 9.991082960607615
2025-03-09 09:34:24,463 [INFO]: 	99p_search_speed_ms: 15.511037083342671
2025-03-09 09:34:24,463 [INFO]: 	reconstruction error %: 0.0
2025-03-09 09:34:24,463 [INFO]: 	nb vectors: 4253
2025-03-09 09:34:24,463 [INFO]: 	vectors dimension: 49152
2025-03-09 09:34:24,463 [INFO]: 	compression ratio: 0.9993087010089617
2025-03-09 09:34:24,464 [INFO]: }
2025-03-09 09:34:24,464 [INFO]: 	>>> Finished "Creating the index" in 62.3924 secs
2025-03-09 09:34:24,464 [INFO]: >>> Finished "Launching the whole pipeline" in 62.4196 secs
2025-03-09 09:34:26: [retrieval_preprocessing] calculating distances ...
2025-03-09 09:34:27: [retrieval_preprocessing] finished and saved retrieval indices for episode 42504 [episode count 2/20]
[retrieval_preprocessing] for episode 91148 [episode count 3/20], we have num_retrieval=np.int64(4235) num_query=np.int64(201)
2025-03-09 09:34:29,115 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-09 09:34:29,674 [INFO]: Launching the whole pipeline 03/09/2025, 09:34:29
2025-03-09 09:34:29,674 [INFO]: Reading total number of vectors and dimension 03/09/2025, 09:34:29
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1182.49it/s]
2025-03-09 09:34:29,701 [INFO]: There are 4235 embeddings of dim 49152
2025-03-09 09:34:29,701 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0269 secs
2025-03-09 09:34:29,701 [INFO]: 	Compute estimated construction time of the index 03/09/2025, 09:34:29
2025-03-09 09:34:29,701 [INFO]: 		-> Train: 16.7 minutes
2025-03-09 09:34:29,701 [INFO]: 		-> Add: 2.3 seconds
2025-03-09 09:34:29,701 [INFO]: 		Total: 16.7 minutes
2025-03-09 09:34:29,701 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0001 secs
2025-03-09 09:34:29,702 [INFO]: 	Checking that your have enough memory available to create the index 03/09/2025, 09:34:29
2025-03-09 09:34:29,702 [INFO]: 874.0MB of memory will be needed to build the index (more might be used if you have more)
2025-03-09 09:34:29,702 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0002 secs
2025-03-09 09:34:29,702 [INFO]: 	Selecting most promising index types given data characteristics 03/09/2025, 09:34:29
2025-03-09 09:34:29,702 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-09 09:34:29,702 [INFO]: 	Creating the index 03/09/2025, 09:34:29
2025-03-09 09:34:29,702 [INFO]: 		-> Instanciate the index HNSW15 03/09/2025, 09:34:29
2025-03-09 09:34:29,703 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0012 secs
2025-03-09 09:34:29,703 [INFO]: 		-> Adding the vectors to the index 03/09/2025, 09:34:29
2025-03-09 09:34:29,703 [INFO]: The memory available for adding the vectors is 49.2GB(total available - used by the index)
2025-03-09 09:34:29,703 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/17 [00:00<?, ?it/s]  6%|▌         | 1/17 [00:00<00:02,  6.12it/s] 18%|█▊        | 3/17 [00:00<00:01,  9.35it/s] 29%|██▉       | 5/17 [00:00<00:01, 10.62it/s] 41%|████      | 7/17 [00:00<00:00, 12.15it/s] 53%|█████▎    | 9/17 [00:00<00:00, 13.04it/s] 65%|██████▍   | 11/17 [00:00<00:00, 13.41it/s] 76%|███████▋  | 13/17 [00:01<00:00, 14.13it/s] 88%|████████▊ | 15/17 [00:01<00:00, 14.88it/s]100%|██████████| 17/17 [00:04<00:00,  1.85it/s]100%|██████████| 17/17 [00:04<00:00,  3.96it/s]
2025-03-09 09:34:34,012 [INFO]: 	Computing best hyperparameters for index knn.index 03/09/2025, 09:34:34
2025-03-09 09:35:11,912 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 37.8999 secs
2025-03-09 09:35:11,912 [INFO]: The best hyperparameters are: efSearch=239
2025-03-09 09:35:11,913 [INFO]: 	Compute fast metrics 03/09/2025, 09:35:11
  0%|          | 0/4 [00:00<?, ?it/s] 25%|██▌       | 1/4 [00:00<00:00,  5.61it/s] 50%|█████     | 2/4 [00:00<00:00,  6.81it/s] 75%|███████▌  | 3/4 [00:00<00:00,  7.49it/s] 75%|███████▌  | 3/4 [00:00<00:00,  5.67it/s]
2025-03-09 09:35:30,094 [INFO]: 	>>> Finished "Compute fast metrics" in 18.1817 secs
2025-03-09 09:35:30,097 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 60.3937 secs
2025-03-09 09:35:30,097 [INFO]: {
2025-03-09 09:35:30,097 [INFO]: 	index_key: HNSW15
2025-03-09 09:35:30,097 [INFO]: 	index_param: efSearch=239
2025-03-09 09:35:30,097 [INFO]: 	index_path: knn.index
2025-03-09 09:35:30,097 [INFO]: 	size in bytes: 833210830
2025-03-09 09:35:30,097 [INFO]: 	avg_search_speed_ms: 10.061605227267899
2025-03-09 09:35:30,097 [INFO]: 	99p_search_speed_ms: 16.510590249672532
2025-03-09 09:35:30,097 [INFO]: 	reconstruction error %: 0.0
2025-03-09 09:35:30,097 [INFO]: 	nb vectors: 4235
2025-03-09 09:35:30,097 [INFO]: 	vectors dimension: 49152
2025-03-09 09:35:30,097 [INFO]: 	compression ratio: 0.9993087583847176
2025-03-09 09:35:30,097 [INFO]: }
2025-03-09 09:35:30,097 [INFO]: 	>>> Finished "Creating the index" in 60.3955 secs
2025-03-09 09:35:30,097 [INFO]: >>> Finished "Launching the whole pipeline" in 60.4231 secs
2025-03-09 09:35:31: [retrieval_preprocessing] calculating distances ...
2025-03-09 09:35:31: [retrieval_preprocessing] finished and saved retrieval indices for episode 91148 [episode count 3/20]
[retrieval_preprocessing] for episode 22035 [episode count 4/20], we have num_retrieval=np.int64(4206) num_query=np.int64(230)
2025-03-09 09:35:33,084 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-09 09:35:33,771 [INFO]: Launching the whole pipeline 03/09/2025, 09:35:33
2025-03-09 09:35:33,772 [INFO]: Reading total number of vectors and dimension 03/09/2025, 09:35:33
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1292.15it/s]
2025-03-09 09:35:33,796 [INFO]: There are 4206 embeddings of dim 49152
2025-03-09 09:35:33,796 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0244 secs
2025-03-09 09:35:33,796 [INFO]: 	Compute estimated construction time of the index 03/09/2025, 09:35:33
2025-03-09 09:35:33,796 [INFO]: 		-> Train: 16.7 minutes
2025-03-09 09:35:33,796 [INFO]: 		-> Add: 2.3 seconds
2025-03-09 09:35:33,796 [INFO]: 		Total: 16.7 minutes
2025-03-09 09:35:33,796 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0001 secs
2025-03-09 09:35:33,796 [INFO]: 	Checking that your have enough memory available to create the index 03/09/2025, 09:35:33
2025-03-09 09:35:33,796 [INFO]: 868.0MB of memory will be needed to build the index (more might be used if you have more)
2025-03-09 09:35:33,796 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0001 secs
2025-03-09 09:35:33,796 [INFO]: 	Selecting most promising index types given data characteristics 03/09/2025, 09:35:33
2025-03-09 09:35:33,796 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-09 09:35:33,797 [INFO]: 	Creating the index 03/09/2025, 09:35:33
2025-03-09 09:35:33,797 [INFO]: 		-> Instanciate the index HNSW15 03/09/2025, 09:35:33
2025-03-09 09:35:33,798 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0009 secs
2025-03-09 09:35:33,798 [INFO]: 		-> Adding the vectors to the index 03/09/2025, 09:35:33
2025-03-09 09:35:33,798 [INFO]: The memory available for adding the vectors is 49.2GB(total available - used by the index)
2025-03-09 09:35:33,798 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/17 [00:00<?, ?it/s]  6%|▌         | 1/17 [00:00<00:03,  5.03it/s] 12%|█▏        | 2/17 [00:00<00:02,  5.07it/s] 18%|█▊        | 3/17 [00:00<00:02,  5.45it/s] 29%|██▉       | 5/17 [00:00<00:01,  7.51it/s] 35%|███▌      | 6/17 [00:00<00:01,  7.95it/s] 47%|████▋     | 8/17 [00:01<00:01,  8.68it/s] 53%|█████▎    | 9/17 [00:01<00:00,  8.71it/s] 59%|█████▉    | 10/17 [00:01<00:00,  8.81it/s] 65%|██████▍   | 11/17 [00:01<00:00,  8.80it/s] 76%|███████▋  | 13/17 [00:01<00:00,  9.71it/s] 88%|████████▊ | 15/17 [00:01<00:00, 10.68it/s]100%|██████████| 17/17 [00:04<00:00,  1.87it/s]100%|██████████| 17/17 [00:04<00:00,  3.85it/s]
2025-03-09 09:35:38,345 [INFO]: 	Computing best hyperparameters for index knn.index 03/09/2025, 09:35:38
2025-03-09 09:36:10,829 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 32.4836 secs
2025-03-09 09:36:10,829 [INFO]: The best hyperparameters are: efSearch=190
2025-03-09 09:36:10,829 [INFO]: 	Compute fast metrics 03/09/2025, 09:36:10
  0%|          | 0/4 [00:00<?, ?it/s] 25%|██▌       | 1/4 [00:00<00:00,  5.64it/s] 50%|█████     | 2/4 [00:00<00:00,  7.27it/s] 75%|███████▌  | 3/4 [00:00<00:00,  8.26it/s] 75%|███████▌  | 3/4 [00:00<00:00,  6.23it/s]
2025-03-09 09:36:26,748 [INFO]: 	>>> Finished "Compute fast metrics" in 15.9187 secs
2025-03-09 09:36:26,894 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 53.0967 secs
2025-03-09 09:36:26,895 [INFO]: {
2025-03-09 09:36:26,895 [INFO]: 	index_key: HNSW15
2025-03-09 09:36:26,895 [INFO]: 	index_param: efSearch=190
2025-03-09 09:36:26,895 [INFO]: 	index_path: knn.index
2025-03-09 09:36:26,895 [INFO]: 	size in bytes: 827505250
2025-03-09 09:36:26,895 [INFO]: 	avg_search_speed_ms: 8.980615349792453
2025-03-09 09:36:26,895 [INFO]: 	99p_search_speed_ms: 16.01505869068205
2025-03-09 09:36:26,895 [INFO]: 	reconstruction error %: 0.0
2025-03-09 09:36:26,895 [INFO]: 	nb vectors: 4206
2025-03-09 09:36:26,895 [INFO]: 	vectors dimension: 49152
2025-03-09 09:36:26,895 [INFO]: 	compression ratio: 0.9993087632978763
2025-03-09 09:36:26,895 [INFO]: }
2025-03-09 09:36:26,895 [INFO]: 	>>> Finished "Creating the index" in 53.0985 secs
2025-03-09 09:36:26,895 [INFO]: >>> Finished "Launching the whole pipeline" in 53.1235 secs
2025-03-09 09:36:27: [retrieval_preprocessing] calculating distances ...
2025-03-09 09:36:28: [retrieval_preprocessing] finished and saved retrieval indices for episode 22035 [episode count 4/20]
[retrieval_preprocessing] for episode 61972 [episode count 5/20], we have num_retrieval=np.int64(4248) num_query=np.int64(188)
2025-03-09 09:36:29,272 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-09 09:36:30,012 [INFO]: Launching the whole pipeline 03/09/2025, 09:36:30
2025-03-09 09:36:30,012 [INFO]: Reading total number of vectors and dimension 03/09/2025, 09:36:30
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1708.47it/s]
2025-03-09 09:36:30,053 [INFO]: There are 4248 embeddings of dim 49152
2025-03-09 09:36:30,053 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0409 secs
2025-03-09 09:36:30,053 [INFO]: 	Compute estimated construction time of the index 03/09/2025, 09:36:30
2025-03-09 09:36:30,053 [INFO]: 		-> Train: 16.7 minutes
2025-03-09 09:36:30,053 [INFO]: 		-> Add: 2.3 seconds
2025-03-09 09:36:30,053 [INFO]: 		Total: 16.7 minutes
2025-03-09 09:36:30,053 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0003 secs
2025-03-09 09:36:30,053 [INFO]: 	Checking that your have enough memory available to create the index 03/09/2025, 09:36:30
2025-03-09 09:36:30,054 [INFO]: 876.7MB of memory will be needed to build the index (more might be used if you have more)
2025-03-09 09:36:30,054 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0004 secs
2025-03-09 09:36:30,054 [INFO]: 	Selecting most promising index types given data characteristics 03/09/2025, 09:36:30
2025-03-09 09:36:30,054 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-09 09:36:30,054 [INFO]: 	Creating the index 03/09/2025, 09:36:30
2025-03-09 09:36:30,054 [INFO]: 		-> Instanciate the index HNSW15 03/09/2025, 09:36:30
2025-03-09 09:36:30,057 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0021 secs
2025-03-09 09:36:30,057 [INFO]: 		-> Adding the vectors to the index 03/09/2025, 09:36:30
2025-03-09 09:36:30,057 [INFO]: The memory available for adding the vectors is 49.2GB(total available - used by the index)
2025-03-09 09:36:30,057 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/17 [00:00<?, ?it/s] 12%|█▏        | 2/17 [00:00<00:00, 17.43it/s] 47%|████▋     | 8/17 [00:00<00:00, 39.64it/s] 76%|███████▋  | 13/17 [00:00<00:00, 39.30it/s]100%|██████████| 17/17 [00:03<00:00,  2.93it/s]100%|██████████| 17/17 [00:03<00:00,  4.27it/s]
2025-03-09 09:36:34,042 [INFO]: 	Computing best hyperparameters for index knn.index 03/09/2025, 09:36:34
2025-03-09 09:37:16,985 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 42.9428 secs
2025-03-09 09:37:16,986 [INFO]: The best hyperparameters are: efSearch=146
2025-03-09 09:37:16,986 [INFO]: 	Compute fast metrics 03/09/2025, 09:37:16
  0%|          | 0/4 [00:00<?, ?it/s] 25%|██▌       | 1/4 [00:00<00:00,  7.11it/s] 75%|███████▌  | 3/4 [00:00<00:00, 14.24it/s]
2025-03-09 09:37:32,410 [INFO]: 	>>> Finished "Compute fast metrics" in 15.4240 secs
2025-03-09 09:37:32,412 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 62.3556 secs
2025-03-09 09:37:32,413 [INFO]: {
2025-03-09 09:37:32,413 [INFO]: 	index_key: HNSW15
2025-03-09 09:37:32,413 [INFO]: 	index_param: efSearch=146
2025-03-09 09:37:32,413 [INFO]: 	index_path: knn.index
2025-03-09 09:37:32,413 [INFO]: 	size in bytes: 835768570
2025-03-09 09:37:32,413 [INFO]: 	avg_search_speed_ms: 9.058626387411715
2025-03-09 09:37:32,413 [INFO]: 	99p_search_speed_ms: 13.884143130853774
2025-03-09 09:37:32,413 [INFO]: 	reconstruction error %: 0.0
2025-03-09 09:37:32,413 [INFO]: 	nb vectors: 4248
2025-03-09 09:37:32,413 [INFO]: 	vectors dimension: 49152
2025-03-09 09:37:32,413 [INFO]: 	compression ratio: 0.999308677042019
2025-03-09 09:37:32,413 [INFO]: }
2025-03-09 09:37:32,413 [INFO]: 	>>> Finished "Creating the index" in 62.3586 secs
2025-03-09 09:37:32,413 [INFO]: >>> Finished "Launching the whole pipeline" in 62.4010 secs
2025-03-09 09:37:33: [retrieval_preprocessing] calculating distances ...
2025-03-09 09:37:33: [retrieval_preprocessing] finished and saved retrieval indices for episode 61972 [episode count 5/20]
[retrieval_preprocessing] for episode 77338 [episode count 6/20], we have num_retrieval=np.int64(4277) num_query=np.int64(159)
2025-03-09 09:37:34,950 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-09 09:37:35,579 [INFO]: Launching the whole pipeline 03/09/2025, 09:37:35
2025-03-09 09:37:35,579 [INFO]: Reading total number of vectors and dimension 03/09/2025, 09:37:35
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1637.76it/s]
2025-03-09 09:37:35,608 [INFO]: There are 4277 embeddings of dim 49152
2025-03-09 09:37:35,608 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0288 secs
2025-03-09 09:37:35,608 [INFO]: 	Compute estimated construction time of the index 03/09/2025, 09:37:35
2025-03-09 09:37:35,609 [INFO]: 		-> Train: 16.7 minutes
2025-03-09 09:37:35,609 [INFO]: 		-> Add: 2.3 seconds
2025-03-09 09:37:35,609 [INFO]: 		Total: 16.7 minutes
2025-03-09 09:37:35,609 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0004 secs
2025-03-09 09:37:35,609 [INFO]: 	Checking that your have enough memory available to create the index 03/09/2025, 09:37:35
2025-03-09 09:37:35,609 [INFO]: 882.7MB of memory will be needed to build the index (more might be used if you have more)
2025-03-09 09:37:35,610 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0004 secs
2025-03-09 09:37:35,610 [INFO]: 	Selecting most promising index types given data characteristics 03/09/2025, 09:37:35
2025-03-09 09:37:35,610 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-09 09:37:35,610 [INFO]: 	Creating the index 03/09/2025, 09:37:35
2025-03-09 09:37:35,610 [INFO]: 		-> Instanciate the index HNSW15 03/09/2025, 09:37:35
2025-03-09 09:37:35,613 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0028 secs
2025-03-09 09:37:35,613 [INFO]: 		-> Adding the vectors to the index 03/09/2025, 09:37:35
2025-03-09 09:37:35,613 [INFO]: The memory available for adding the vectors is 49.2GB(total available - used by the index)
2025-03-09 09:37:35,614 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/17 [00:00<?, ?it/s]  6%|▌         | 1/17 [00:00<00:02,  6.56it/s] 18%|█▊        | 3/17 [00:00<00:01, 10.11it/s] 29%|██▉       | 5/17 [00:00<00:01,  9.74it/s] 35%|███▌      | 6/17 [00:00<00:01,  9.65it/s] 47%|████▋     | 8/17 [00:00<00:00, 11.41it/s] 65%|██████▍   | 11/17 [00:00<00:00, 15.81it/s] 76%|███████▋  | 13/17 [00:01<00:00, 13.71it/s] 88%|████████▊ | 15/17 [00:01<00:00, 11.68it/s]100%|██████████| 17/17 [00:04<00:00,  1.61it/s]100%|██████████| 17/17 [00:04<00:00,  3.43it/s]
2025-03-09 09:37:40,579 [INFO]: 	Computing best hyperparameters for index knn.index 03/09/2025, 09:37:40
2025-03-09 09:38:21,450 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 40.8705 secs
2025-03-09 09:38:21,450 [INFO]: The best hyperparameters are: efSearch=147
2025-03-09 09:38:21,450 [INFO]: 	Compute fast metrics 03/09/2025, 09:38:21
  0%|          | 0/4 [00:00<?, ?it/s] 25%|██▌       | 1/4 [00:00<00:01,  2.98it/s] 50%|█████     | 2/4 [00:00<00:00,  4.68it/s] 75%|███████▌  | 3/4 [00:00<00:00,  5.72it/s] 75%|███████▌  | 3/4 [00:00<00:00,  4.21it/s]
2025-03-09 09:38:41,407 [INFO]: 	>>> Finished "Compute fast metrics" in 19.9565 secs
2025-03-09 09:38:41,410 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 65.7964 secs
2025-03-09 09:38:41,410 [INFO]: {
2025-03-09 09:38:41,410 [INFO]: 	index_key: HNSW15
2025-03-09 09:38:41,410 [INFO]: 	index_param: efSearch=147
2025-03-09 09:38:41,410 [INFO]: 	index_path: knn.index
2025-03-09 09:38:41,410 [INFO]: 	size in bytes: 841474090
2025-03-09 09:38:41,410 [INFO]: 	avg_search_speed_ms: 9.13829603543168
2025-03-09 09:38:41,410 [INFO]: 	99p_search_speed_ms: 15.513062067329876
2025-03-09 09:38:41,410 [INFO]: 	reconstruction error %: 0.0
2025-03-09 09:38:41,410 [INFO]: 	nb vectors: 4277
2025-03-09 09:38:41,410 [INFO]: 	vectors dimension: 49152
2025-03-09 09:38:41,410 [INFO]: 	compression ratio: 0.999308744016111
2025-03-09 09:38:41,410 [INFO]: }
2025-03-09 09:38:41,410 [INFO]: 	>>> Finished "Creating the index" in 65.8001 secs
2025-03-09 09:38:41,410 [INFO]: >>> Finished "Launching the whole pipeline" in 65.8307 secs
2025-03-09 09:38:41: [retrieval_preprocessing] calculating distances ...
2025-03-09 09:38:42: [retrieval_preprocessing] finished and saved retrieval indices for episode 77338 [episode count 6/20]
[retrieval_preprocessing] for episode 63009 [episode count 7/20], we have num_retrieval=np.int64(4242) num_query=np.int64(194)
2025-03-09 09:38:43,741 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-09 09:38:44,302 [INFO]: Launching the whole pipeline 03/09/2025, 09:38:44
2025-03-09 09:38:44,302 [INFO]: Reading total number of vectors and dimension 03/09/2025, 09:38:44
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1239.09it/s]
2025-03-09 09:38:44,330 [INFO]: There are 4242 embeddings of dim 49152
2025-03-09 09:38:44,330 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0275 secs
2025-03-09 09:38:44,330 [INFO]: 	Compute estimated construction time of the index 03/09/2025, 09:38:44
2025-03-09 09:38:44,330 [INFO]: 		-> Train: 16.7 minutes
2025-03-09 09:38:44,330 [INFO]: 		-> Add: 2.3 seconds
2025-03-09 09:38:44,330 [INFO]: 		Total: 16.7 minutes
2025-03-09 09:38:44,330 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0002 secs
2025-03-09 09:38:44,330 [INFO]: 	Checking that your have enough memory available to create the index 03/09/2025, 09:38:44
2025-03-09 09:38:44,330 [INFO]: 875.4MB of memory will be needed to build the index (more might be used if you have more)
2025-03-09 09:38:44,331 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0002 secs
2025-03-09 09:38:44,331 [INFO]: 	Selecting most promising index types given data characteristics 03/09/2025, 09:38:44
2025-03-09 09:38:44,331 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-09 09:38:44,331 [INFO]: 	Creating the index 03/09/2025, 09:38:44
2025-03-09 09:38:44,331 [INFO]: 		-> Instanciate the index HNSW15 03/09/2025, 09:38:44
2025-03-09 09:38:44,332 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0011 secs
2025-03-09 09:38:44,332 [INFO]: 		-> Adding the vectors to the index 03/09/2025, 09:38:44
2025-03-09 09:38:44,332 [INFO]: The memory available for adding the vectors is 49.2GB(total available - used by the index)
2025-03-09 09:38:44,332 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/17 [00:00<?, ?it/s]  6%|▌         | 1/17 [00:00<00:02,  6.32it/s] 18%|█▊        | 3/17 [00:00<00:01,  9.54it/s] 29%|██▉       | 5/17 [00:00<00:01, 10.68it/s] 41%|████      | 7/17 [00:00<00:00, 11.17it/s] 53%|█████▎    | 9/17 [00:00<00:00, 11.52it/s] 65%|██████▍   | 11/17 [00:00<00:00, 11.66it/s] 76%|███████▋  | 13/17 [00:01<00:00, 11.79it/s] 88%|████████▊ | 15/17 [00:01<00:00, 11.78it/s]100%|██████████| 17/17 [00:04<00:00,  1.68it/s]100%|██████████| 17/17 [00:04<00:00,  3.59it/s]
2025-03-09 09:38:49,078 [INFO]: 	Computing best hyperparameters for index knn.index 03/09/2025, 09:38:49
2025-03-09 09:39:26,324 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 37.2447 secs
2025-03-09 09:39:26,324 [INFO]: The best hyperparameters are: efSearch=146
2025-03-09 09:39:26,325 [INFO]: 	Compute fast metrics 03/09/2025, 09:39:26
  0%|          | 0/4 [00:00<?, ?it/s] 50%|█████     | 2/4 [00:00<00:00, 18.39it/s] 75%|███████▌  | 3/4 [00:00<00:00, 20.85it/s]
2025-03-09 09:39:41,503 [INFO]: 	>>> Finished "Compute fast metrics" in 15.1783 secs
2025-03-09 09:39:41,506 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 57.1742 secs
2025-03-09 09:39:41,506 [INFO]: {
2025-03-09 09:39:41,506 [INFO]: 	index_key: HNSW15
2025-03-09 09:39:41,507 [INFO]: 	index_param: efSearch=146
2025-03-09 09:39:41,507 [INFO]: 	index_path: knn.index
2025-03-09 09:39:41,507 [INFO]: 	size in bytes: 834588130
2025-03-09 09:39:41,507 [INFO]: 	avg_search_speed_ms: 7.572848465695808
2025-03-09 09:39:41,507 [INFO]: 	99p_search_speed_ms: 13.235045450273883
2025-03-09 09:39:41,507 [INFO]: 	reconstruction error %: 0.0
2025-03-09 09:39:41,507 [INFO]: 	nb vectors: 4242
2025-03-09 09:39:41,507 [INFO]: 	vectors dimension: 49152
2025-03-09 09:39:41,507 [INFO]: 	compression ratio: 0.9993086482071103
2025-03-09 09:39:41,507 [INFO]: }
2025-03-09 09:39:41,507 [INFO]: 	>>> Finished "Creating the index" in 57.1760 secs
2025-03-09 09:39:41,507 [INFO]: >>> Finished "Launching the whole pipeline" in 57.2042 secs
2025-03-09 09:39:42: [retrieval_preprocessing] calculating distances ...
2025-03-09 09:39:42: [retrieval_preprocessing] finished and saved retrieval indices for episode 63009 [episode count 7/20]
[retrieval_preprocessing] for episode 90150 [episode count 8/20], we have num_retrieval=np.int64(4228) num_query=np.int64(208)
2025-03-09 09:39:43,907 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-09 09:39:44,475 [INFO]: Launching the whole pipeline 03/09/2025, 09:39:44
2025-03-09 09:39:44,475 [INFO]: Reading total number of vectors and dimension 03/09/2025, 09:39:44
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1195.30it/s]
2025-03-09 09:39:44,501 [INFO]: There are 4228 embeddings of dim 49152
2025-03-09 09:39:44,501 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0264 secs
2025-03-09 09:39:44,502 [INFO]: 	Compute estimated construction time of the index 03/09/2025, 09:39:44
2025-03-09 09:39:44,502 [INFO]: 		-> Train: 16.7 minutes
2025-03-09 09:39:44,502 [INFO]: 		-> Add: 2.3 seconds
2025-03-09 09:39:44,502 [INFO]: 		Total: 16.7 minutes
2025-03-09 09:39:44,502 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0001 secs
2025-03-09 09:39:44,502 [INFO]: 	Checking that your have enough memory available to create the index 03/09/2025, 09:39:44
2025-03-09 09:39:44,502 [INFO]: 872.6MB of memory will be needed to build the index (more might be used if you have more)
2025-03-09 09:39:44,502 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0001 secs
2025-03-09 09:39:44,502 [INFO]: 	Selecting most promising index types given data characteristics 03/09/2025, 09:39:44
2025-03-09 09:39:44,502 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-09 09:39:44,502 [INFO]: 	Creating the index 03/09/2025, 09:39:44
2025-03-09 09:39:44,502 [INFO]: 		-> Instanciate the index HNSW15 03/09/2025, 09:39:44
2025-03-09 09:39:44,503 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0008 secs
2025-03-09 09:39:44,503 [INFO]: 		-> Adding the vectors to the index 03/09/2025, 09:39:44
2025-03-09 09:39:44,503 [INFO]: The memory available for adding the vectors is 49.2GB(total available - used by the index)
2025-03-09 09:39:44,503 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/17 [00:00<?, ?it/s]  6%|▌         | 1/17 [00:00<00:02,  7.90it/s] 18%|█▊        | 3/17 [00:00<00:01, 13.66it/s] 29%|██▉       | 5/17 [00:00<00:01, 11.16it/s] 41%|████      | 7/17 [00:00<00:00, 11.60it/s] 53%|█████▎    | 9/17 [00:00<00:00, 11.89it/s] 65%|██████▍   | 11/17 [00:00<00:00, 12.82it/s] 76%|███████▋  | 13/17 [00:01<00:00, 13.29it/s] 88%|████████▊ | 15/17 [00:01<00:00, 14.05it/s]100%|██████████| 17/17 [00:03<00:00,  2.04it/s]100%|██████████| 17/17 [00:03<00:00,  4.29it/s]
2025-03-09 09:39:48,469 [INFO]: 	Computing best hyperparameters for index knn.index 03/09/2025, 09:39:48
2025-03-09 09:40:26,705 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 38.2358 secs
2025-03-09 09:40:26,705 [INFO]: The best hyperparameters are: efSearch=219
2025-03-09 09:40:26,706 [INFO]: 	Compute fast metrics 03/09/2025, 09:40:26
  0%|          | 0/4 [00:00<?, ?it/s] 25%|██▌       | 1/4 [00:00<00:00,  7.69it/s] 75%|███████▌  | 3/4 [00:00<00:00, 12.43it/s] 75%|███████▌  | 3/4 [00:00<00:00,  9.66it/s]
2025-03-09 09:40:42,109 [INFO]: 	>>> Finished "Compute fast metrics" in 15.4029 secs
2025-03-09 09:40:42,112 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 57.6088 secs
2025-03-09 09:40:42,112 [INFO]: {
2025-03-09 09:40:42,112 [INFO]: 	index_key: HNSW15
2025-03-09 09:40:42,112 [INFO]: 	index_param: efSearch=219
2025-03-09 09:40:42,112 [INFO]: 	index_path: knn.index
2025-03-09 09:40:42,112 [INFO]: 	size in bytes: 831833590
2025-03-09 09:40:42,112 [INFO]: 	avg_search_speed_ms: 9.935119726427839
2025-03-09 09:40:42,112 [INFO]: 	99p_search_speed_ms: 15.545471156947295
2025-03-09 09:40:42,112 [INFO]: 	reconstruction error %: 0.0
2025-03-09 09:40:42,112 [INFO]: 	nb vectors: 4228
2025-03-09 09:40:42,112 [INFO]: 	vectors dimension: 49152
2025-03-09 09:40:42,112 [INFO]: 	compression ratio: 0.9993087968472155
2025-03-09 09:40:42,112 [INFO]: }
2025-03-09 09:40:42,112 [INFO]: 	>>> Finished "Creating the index" in 57.6102 secs
2025-03-09 09:40:42,112 [INFO]: >>> Finished "Launching the whole pipeline" in 57.6371 secs
2025-03-09 09:40:42: [retrieval_preprocessing] calculating distances ...
2025-03-09 09:40:43: [retrieval_preprocessing] finished and saved retrieval indices for episode 90150 [episode count 8/20]
[retrieval_preprocessing] for episode 67112 [episode count 9/20], we have num_retrieval=np.int64(4168) num_query=np.int64(268)
2025-03-09 09:40:44,841 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-09 09:40:45,397 [INFO]: Launching the whole pipeline 03/09/2025, 09:40:45
2025-03-09 09:40:45,397 [INFO]: Reading total number of vectors and dimension 03/09/2025, 09:40:45
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 2270.87it/s]
2025-03-09 09:40:45,422 [INFO]: There are 4168 embeddings of dim 49152
2025-03-09 09:40:45,422 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0251 secs
2025-03-09 09:40:45,423 [INFO]: 	Compute estimated construction time of the index 03/09/2025, 09:40:45
2025-03-09 09:40:45,423 [INFO]: 		-> Train: 16.7 minutes
2025-03-09 09:40:45,423 [INFO]: 		-> Add: 2.3 seconds
2025-03-09 09:40:45,423 [INFO]: 		Total: 16.7 minutes
2025-03-09 09:40:45,423 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0001 secs
2025-03-09 09:40:45,423 [INFO]: 	Checking that your have enough memory available to create the index 03/09/2025, 09:40:45
2025-03-09 09:40:45,423 [INFO]: 860.2MB of memory will be needed to build the index (more might be used if you have more)
2025-03-09 09:40:45,423 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0002 secs
2025-03-09 09:40:45,423 [INFO]: 	Selecting most promising index types given data characteristics 03/09/2025, 09:40:45
2025-03-09 09:40:45,423 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-09 09:40:45,423 [INFO]: 	Creating the index 03/09/2025, 09:40:45
2025-03-09 09:40:45,423 [INFO]: 		-> Instanciate the index HNSW15 03/09/2025, 09:40:45
2025-03-09 09:40:45,424 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0011 secs
2025-03-09 09:40:45,424 [INFO]: 		-> Adding the vectors to the index 03/09/2025, 09:40:45
2025-03-09 09:40:45,424 [INFO]: The memory available for adding the vectors is 49.2GB(total available - used by the index)
2025-03-09 09:40:45,425 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/17 [00:00<?, ?it/s]  6%|▌         | 1/17 [00:00<00:02,  5.99it/s] 18%|█▊        | 3/17 [00:00<00:01,  9.54it/s] 29%|██▉       | 5/17 [00:00<00:01, 11.26it/s] 41%|████      | 7/17 [00:00<00:00, 12.31it/s] 53%|█████▎    | 9/17 [00:00<00:00, 13.16it/s] 65%|██████▍   | 11/17 [00:00<00:00, 13.64it/s] 76%|███████▋  | 13/17 [00:01<00:00, 13.94it/s] 88%|████████▊ | 15/17 [00:01<00:00, 13.30it/s]100%|██████████| 17/17 [00:04<00:00,  1.97it/s]100%|██████████| 17/17 [00:04<00:00,  4.16it/s]
2025-03-09 09:40:49,512 [INFO]: 	Computing best hyperparameters for index knn.index 03/09/2025, 09:40:49
2025-03-09 09:41:23,027 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 33.5148 secs
2025-03-09 09:41:23,027 [INFO]: The best hyperparameters are: efSearch=224
2025-03-09 09:41:23,027 [INFO]: 	Compute fast metrics 03/09/2025, 09:41:23
  0%|          | 0/4 [00:00<?, ?it/s] 25%|██▌       | 1/4 [00:00<00:00,  5.66it/s] 50%|█████     | 2/4 [00:00<00:00,  7.54it/s] 75%|███████▌  | 3/4 [00:00<00:00,  8.48it/s] 75%|███████▌  | 3/4 [00:00<00:00,  6.39it/s]
2025-03-09 09:41:41,932 [INFO]: 	>>> Finished "Compute fast metrics" in 18.9047 secs
2025-03-09 09:41:41,934 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 56.5099 secs
2025-03-09 09:41:41,934 [INFO]: {
2025-03-09 09:41:41,935 [INFO]: 	index_key: HNSW15
2025-03-09 09:41:41,935 [INFO]: 	index_param: efSearch=224
2025-03-09 09:41:41,935 [INFO]: 	index_path: knn.index
2025-03-09 09:41:41,935 [INFO]: 	size in bytes: 820029070
2025-03-09 09:41:41,935 [INFO]: 	avg_search_speed_ms: 9.133853979162089
2025-03-09 09:41:41,935 [INFO]: 	99p_search_speed_ms: 17.20877592451869
2025-03-09 09:41:41,935 [INFO]: 	reconstruction error %: 0.0
2025-03-09 09:41:41,935 [INFO]: 	nb vectors: 4168
2025-03-09 09:41:41,935 [INFO]: 	vectors dimension: 49152
2025-03-09 09:41:41,935 [INFO]: 	compression ratio: 0.9993086513384215
2025-03-09 09:41:41,935 [INFO]: }
2025-03-09 09:41:41,935 [INFO]: 	>>> Finished "Creating the index" in 56.5115 secs
2025-03-09 09:41:41,935 [INFO]: >>> Finished "Launching the whole pipeline" in 56.5373 secs
2025-03-09 09:41:43: [retrieval_preprocessing] calculating distances ...
2025-03-09 09:41:43: [retrieval_preprocessing] finished and saved retrieval indices for episode 67112 [episode count 9/20]
[retrieval_preprocessing] for episode 58921 [episode count 10/20], we have num_retrieval=np.int64(4266) num_query=np.int64(170)
2025-03-09 09:41:44,875 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-09 09:41:45,803 [INFO]: Launching the whole pipeline 03/09/2025, 09:41:45
2025-03-09 09:41:45,803 [INFO]: Reading total number of vectors and dimension 03/09/2025, 09:41:45
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 2295.73it/s]
2025-03-09 09:41:45,826 [INFO]: There are 4266 embeddings of dim 49152
2025-03-09 09:41:45,826 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0229 secs
2025-03-09 09:41:45,826 [INFO]: 	Compute estimated construction time of the index 03/09/2025, 09:41:45
2025-03-09 09:41:45,826 [INFO]: 		-> Train: 16.7 minutes
2025-03-09 09:41:45,826 [INFO]: 		-> Add: 2.3 seconds
2025-03-09 09:41:45,826 [INFO]: 		Total: 16.7 minutes
2025-03-09 09:41:45,826 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0001 secs
2025-03-09 09:41:45,826 [INFO]: 	Checking that your have enough memory available to create the index 03/09/2025, 09:41:45
2025-03-09 09:41:45,827 [INFO]: 880.4MB of memory will be needed to build the index (more might be used if you have more)
2025-03-09 09:41:45,827 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0001 secs
2025-03-09 09:41:45,827 [INFO]: 	Selecting most promising index types given data characteristics 03/09/2025, 09:41:45
2025-03-09 09:41:45,827 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-09 09:41:45,827 [INFO]: 	Creating the index 03/09/2025, 09:41:45
2025-03-09 09:41:45,827 [INFO]: 		-> Instanciate the index HNSW15 03/09/2025, 09:41:45
2025-03-09 09:41:45,828 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0009 secs
2025-03-09 09:41:45,828 [INFO]: 		-> Adding the vectors to the index 03/09/2025, 09:41:45
2025-03-09 09:41:45,828 [INFO]: The memory available for adding the vectors is 49.2GB(total available - used by the index)
2025-03-09 09:41:45,828 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/17 [00:00<?, ?it/s]  6%|▌         | 1/17 [00:00<00:02,  7.40it/s] 18%|█▊        | 3/17 [00:00<00:01, 12.39it/s] 29%|██▉       | 5/17 [00:00<00:00, 13.74it/s] 41%|████      | 7/17 [00:00<00:00, 13.93it/s] 53%|█████▎    | 9/17 [00:00<00:00, 15.23it/s] 65%|██████▍   | 11/17 [00:00<00:00, 15.64it/s] 76%|███████▋  | 13/17 [00:00<00:00, 15.84it/s] 88%|████████▊ | 15/17 [00:01<00:00, 15.47it/s]100%|██████████| 17/17 [00:04<00:00,  1.82it/s]100%|██████████| 17/17 [00:04<00:00,  4.02it/s]
2025-03-09 09:41:50,069 [INFO]: 	Computing best hyperparameters for index knn.index 03/09/2025, 09:41:50
2025-03-09 09:42:26,114 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 36.0444 secs
2025-03-09 09:42:26,114 [INFO]: The best hyperparameters are: efSearch=186
2025-03-09 09:42:26,115 [INFO]: 	Compute fast metrics 03/09/2025, 09:42:26
  0%|          | 0/4 [00:00<?, ?it/s] 25%|██▌       | 1/4 [00:00<00:00,  5.94it/s] 75%|███████▌  | 3/4 [00:00<00:00,  9.53it/s] 75%|███████▌  | 3/4 [00:00<00:00,  7.35it/s]
2025-03-09 09:42:42,514 [INFO]: 	>>> Finished "Compute fast metrics" in 16.3994 secs
2025-03-09 09:42:42,517 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 56.6888 secs
2025-03-09 09:42:42,517 [INFO]: {
2025-03-09 09:42:42,517 [INFO]: 	index_key: HNSW15
2025-03-09 09:42:42,517 [INFO]: 	index_param: efSearch=186
2025-03-09 09:42:42,517 [INFO]: 	index_path: knn.index
2025-03-09 09:42:42,517 [INFO]: 	size in bytes: 839309890
2025-03-09 09:42:42,517 [INFO]: 	avg_search_speed_ms: 8.37335691625842
2025-03-09 09:42:42,517 [INFO]: 	99p_search_speed_ms: 13.777272161096331
2025-03-09 09:42:42,517 [INFO]: 	reconstruction error %: 0.0
2025-03-09 09:42:42,517 [INFO]: 	nb vectors: 4266
2025-03-09 09:42:42,517 [INFO]: 	vectors dimension: 49152
2025-03-09 09:42:42,517 [INFO]: 	compression ratio: 0.9993087630600898
2025-03-09 09:42:42,517 [INFO]: }
2025-03-09 09:42:42,517 [INFO]: 	>>> Finished "Creating the index" in 56.6903 secs
2025-03-09 09:42:42,517 [INFO]: >>> Finished "Launching the whole pipeline" in 56.7137 secs
2025-03-09 09:42:43: [retrieval_preprocessing] calculating distances ...
2025-03-09 09:42:43: [retrieval_preprocessing] finished and saved retrieval indices for episode 58921 [episode count 10/20]
[retrieval_preprocessing] for episode 62506 [episode count 11/20], we have num_retrieval=np.int64(4281) num_query=np.int64(155)
2025-03-09 09:42:44,973 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-09 09:42:45,623 [INFO]: Launching the whole pipeline 03/09/2025, 09:42:45
2025-03-09 09:42:45,623 [INFO]: Reading total number of vectors and dimension 03/09/2025, 09:42:45
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 2229.83it/s]
2025-03-09 09:42:45,649 [INFO]: There are 4281 embeddings of dim 49152
2025-03-09 09:42:45,650 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0268 secs
2025-03-09 09:42:45,650 [INFO]: 	Compute estimated construction time of the index 03/09/2025, 09:42:45
2025-03-09 09:42:45,650 [INFO]: 		-> Train: 16.7 minutes
2025-03-09 09:42:45,650 [INFO]: 		-> Add: 2.4 seconds
2025-03-09 09:42:45,650 [INFO]: 		Total: 16.7 minutes
2025-03-09 09:42:45,650 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0004 secs
2025-03-09 09:42:45,650 [INFO]: 	Checking that your have enough memory available to create the index 03/09/2025, 09:42:45
2025-03-09 09:42:45,651 [INFO]: 883.5MB of memory will be needed to build the index (more might be used if you have more)
2025-03-09 09:42:45,651 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0004 secs
2025-03-09 09:42:45,651 [INFO]: 	Selecting most promising index types given data characteristics 03/09/2025, 09:42:45
2025-03-09 09:42:45,651 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-09 09:42:45,651 [INFO]: 	Creating the index 03/09/2025, 09:42:45
2025-03-09 09:42:45,651 [INFO]: 		-> Instanciate the index HNSW15 03/09/2025, 09:42:45
2025-03-09 09:42:45,654 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0025 secs
2025-03-09 09:42:45,654 [INFO]: 		-> Adding the vectors to the index 03/09/2025, 09:42:45
2025-03-09 09:42:45,654 [INFO]: The memory available for adding the vectors is 49.2GB(total available - used by the index)
2025-03-09 09:42:45,654 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/17 [00:00<?, ?it/s]  6%|▌         | 1/17 [00:00<00:02,  6.03it/s] 18%|█▊        | 3/17 [00:00<00:01,  9.84it/s] 29%|██▉       | 5/17 [00:00<00:01, 11.07it/s] 41%|████      | 7/17 [00:00<00:00, 11.67it/s] 53%|█████▎    | 9/17 [00:00<00:00, 12.02it/s] 65%|██████▍   | 11/17 [00:00<00:00, 12.22it/s] 76%|███████▋  | 13/17 [00:01<00:00, 12.32it/s] 88%|████████▊ | 15/17 [00:01<00:00, 12.50it/s]100%|██████████| 17/17 [00:04<00:00,  1.93it/s]100%|██████████| 17/17 [00:04<00:00,  4.04it/s]
2025-03-09 09:42:49,870 [INFO]: 	Computing best hyperparameters for index knn.index 03/09/2025, 09:42:49
2025-03-09 09:43:28,597 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 38.7260 secs
2025-03-09 09:43:28,597 [INFO]: The best hyperparameters are: efSearch=223
2025-03-09 09:43:28,597 [INFO]: 	Compute fast metrics 03/09/2025, 09:43:28
  0%|          | 0/4 [00:00<?, ?it/s] 25%|██▌       | 1/4 [00:00<00:00,  6.15it/s] 75%|███████▌  | 3/4 [00:00<00:00, 10.51it/s] 75%|███████▌  | 3/4 [00:00<00:00,  8.25it/s]
2025-03-09 09:43:45,761 [INFO]: 	>>> Finished "Compute fast metrics" in 17.1638 secs
2025-03-09 09:43:45,764 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 60.1093 secs
2025-03-09 09:43:45,764 [INFO]: {
2025-03-09 09:43:45,764 [INFO]: 	index_key: HNSW15
2025-03-09 09:43:45,764 [INFO]: 	index_param: efSearch=223
2025-03-09 09:43:45,764 [INFO]: 	index_path: knn.index
2025-03-09 09:43:45,764 [INFO]: 	size in bytes: 842261110
2025-03-09 09:43:45,764 [INFO]: 	avg_search_speed_ms: 9.235012938594403
2025-03-09 09:43:45,764 [INFO]: 	99p_search_speed_ms: 14.403311344794991
2025-03-09 09:43:45,764 [INFO]: 	reconstruction error %: 0.0
2025-03-09 09:43:45,764 [INFO]: 	nb vectors: 4281
2025-03-09 09:43:45,764 [INFO]: 	vectors dimension: 49152
2025-03-09 09:43:45,764 [INFO]: 	compression ratio: 0.9993086918141098
2025-03-09 09:43:45,764 [INFO]: }
2025-03-09 09:43:45,764 [INFO]: 	>>> Finished "Creating the index" in 60.1125 secs
2025-03-09 09:43:45,764 [INFO]: >>> Finished "Launching the whole pipeline" in 60.1410 secs
2025-03-09 09:43:47: [retrieval_preprocessing] calculating distances ...
2025-03-09 09:43:47: [retrieval_preprocessing] finished and saved retrieval indices for episode 62506 [episode count 11/20]
[retrieval_preprocessing] for episode 95276 [episode count 12/20], we have num_retrieval=np.int64(3984) num_query=np.int64(452)
2025-03-09 09:43:48,743 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-09 09:43:49,238 [INFO]: Launching the whole pipeline 03/09/2025, 09:43:49
2025-03-09 09:43:49,238 [INFO]: Reading total number of vectors and dimension 03/09/2025, 09:43:49
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 2242.94it/s]
2025-03-09 09:43:49,262 [INFO]: There are 3984 embeddings of dim 49152
2025-03-09 09:43:49,262 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0241 secs
2025-03-09 09:43:49,262 [INFO]: 	Compute estimated construction time of the index 03/09/2025, 09:43:49
2025-03-09 09:43:49,262 [INFO]: 		-> Train: 16.7 minutes
2025-03-09 09:43:49,262 [INFO]: 		-> Add: 2.2 seconds
2025-03-09 09:43:49,262 [INFO]: 		Total: 16.7 minutes
2025-03-09 09:43:49,262 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0001 secs
2025-03-09 09:43:49,262 [INFO]: 	Checking that your have enough memory available to create the index 03/09/2025, 09:43:49
2025-03-09 09:43:49,262 [INFO]: 822.2MB of memory will be needed to build the index (more might be used if you have more)
2025-03-09 09:43:49,262 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0001 secs
2025-03-09 09:43:49,262 [INFO]: 	Selecting most promising index types given data characteristics 03/09/2025, 09:43:49
2025-03-09 09:43:49,262 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-09 09:43:49,262 [INFO]: 	Creating the index 03/09/2025, 09:43:49
2025-03-09 09:43:49,262 [INFO]: 		-> Instanciate the index HNSW15 03/09/2025, 09:43:49
2025-03-09 09:43:49,263 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0009 secs
2025-03-09 09:43:49,263 [INFO]: 		-> Adding the vectors to the index 03/09/2025, 09:43:49
2025-03-09 09:43:49,263 [INFO]: The memory available for adding the vectors is 49.3GB(total available - used by the index)
2025-03-09 09:43:49,263 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/16 [00:00<?, ?it/s]  6%|▋         | 1/16 [00:00<00:03,  4.93it/s] 12%|█▎        | 2/16 [00:00<00:02,  6.73it/s] 19%|█▉        | 3/16 [00:00<00:01,  7.58it/s] 25%|██▌       | 4/16 [00:00<00:01,  8.11it/s] 31%|███▏      | 5/16 [00:00<00:01,  8.48it/s] 38%|███▊      | 6/16 [00:00<00:01,  8.66it/s] 44%|████▍     | 7/16 [00:00<00:01,  8.73it/s] 50%|█████     | 8/16 [00:00<00:00,  8.78it/s] 56%|█████▋    | 9/16 [00:01<00:00,  8.84it/s] 62%|██████▎   | 10/16 [00:01<00:00,  8.89it/s] 69%|██████▉   | 11/16 [00:01<00:00,  8.98it/s] 75%|███████▌  | 12/16 [00:01<00:00,  8.97it/s] 88%|████████▊ | 14/16 [00:01<00:00,  9.95it/s]100%|██████████| 16/16 [00:04<00:00,  1.66it/s]100%|██████████| 16/16 [00:04<00:00,  3.71it/s]
2025-03-09 09:43:53,583 [INFO]: 	Computing best hyperparameters for index knn.index 03/09/2025, 09:43:53
2025-03-09 09:44:29,312 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 35.7288 secs
2025-03-09 09:44:29,313 [INFO]: The best hyperparameters are: efSearch=203
2025-03-09 09:44:29,313 [INFO]: 	Compute fast metrics 03/09/2025, 09:44:29
  0%|          | 0/4 [00:00<?, ?it/s] 25%|██▌       | 1/4 [00:00<00:00,  5.20it/s] 50%|█████     | 2/4 [00:00<00:00,  6.78it/s] 75%|███████▌  | 3/4 [00:00<00:00,  7.65it/s] 75%|███████▌  | 3/4 [00:00<00:00,  5.61it/s]
2025-03-09 09:44:47,805 [INFO]: 	>>> Finished "Compute fast metrics" in 18.4920 secs
2025-03-09 09:44:48,100 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 58.8365 secs
2025-03-09 09:44:48,100 [INFO]: {
2025-03-09 09:44:48,100 [INFO]: 	index_key: HNSW15
2025-03-09 09:44:48,100 [INFO]: 	index_param: efSearch=203
2025-03-09 09:44:48,100 [INFO]: 	index_path: knn.index
2025-03-09 09:44:48,100 [INFO]: 	size in bytes: 783828250
2025-03-09 09:44:48,100 [INFO]: 	avg_search_speed_ms: 9.741796424091877
2025-03-09 09:44:48,101 [INFO]: 	99p_search_speed_ms: 17.904115379787985
2025-03-09 09:44:48,101 [INFO]: 	reconstruction error %: 0.0
2025-03-09 09:44:48,101 [INFO]: 	nb vectors: 3984
2025-03-09 09:44:48,101 [INFO]: 	vectors dimension: 49152
2025-03-09 09:44:48,101 [INFO]: 	compression ratio: 0.999308550055449
2025-03-09 09:44:48,101 [INFO]: }
2025-03-09 09:44:48,101 [INFO]: 	>>> Finished "Creating the index" in 58.8386 secs
2025-03-09 09:44:48,101 [INFO]: >>> Finished "Launching the whole pipeline" in 58.8632 secs
2025-03-09 09:44:49: [retrieval_preprocessing] calculating distances ...
2025-03-09 09:44:51: [retrieval_preprocessing] finished and saved retrieval indices for episode 95276 [episode count 12/20]
[retrieval_preprocessing] for episode 83012 [episode count 13/20], we have num_retrieval=np.int64(4242) num_query=np.int64(194)
2025-03-09 09:44:52,245 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-09 09:44:52,915 [INFO]: Launching the whole pipeline 03/09/2025, 09:44:52
2025-03-09 09:44:52,916 [INFO]: Reading total number of vectors and dimension 03/09/2025, 09:44:52
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1036.14it/s]
2025-03-09 09:44:53,079 [INFO]: There are 4242 embeddings of dim 49152
2025-03-09 09:44:53,079 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.1639 secs
2025-03-09 09:44:53,080 [INFO]: 	Compute estimated construction time of the index 03/09/2025, 09:44:53
2025-03-09 09:44:53,080 [INFO]: 		-> Train: 16.7 minutes
2025-03-09 09:44:53,080 [INFO]: 		-> Add: 2.3 seconds
2025-03-09 09:44:53,080 [INFO]: 		Total: 16.7 minutes
2025-03-09 09:44:53,080 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0002 secs
2025-03-09 09:44:53,080 [INFO]: 	Checking that your have enough memory available to create the index 03/09/2025, 09:44:53
2025-03-09 09:44:53,080 [INFO]: 875.4MB of memory will be needed to build the index (more might be used if you have more)
2025-03-09 09:44:53,080 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0003 secs
2025-03-09 09:44:53,081 [INFO]: 	Selecting most promising index types given data characteristics 03/09/2025, 09:44:53
2025-03-09 09:44:53,081 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-09 09:44:53,081 [INFO]: 	Creating the index 03/09/2025, 09:44:53
2025-03-09 09:44:53,081 [INFO]: 		-> Instanciate the index HNSW15 03/09/2025, 09:44:53
2025-03-09 09:44:53,083 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0021 secs
2025-03-09 09:44:53,083 [INFO]: 		-> Adding the vectors to the index 03/09/2025, 09:44:53
2025-03-09 09:44:53,083 [INFO]: The memory available for adding the vectors is 49.2GB(total available - used by the index)
2025-03-09 09:44:53,083 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/17 [00:00<?, ?it/s]  6%|▌         | 1/17 [00:00<00:02,  5.91it/s] 18%|█▊        | 3/17 [00:00<00:01,  9.70it/s] 29%|██▉       | 5/17 [00:00<00:01, 10.05it/s] 41%|████      | 7/17 [00:00<00:00, 11.02it/s] 53%|█████▎    | 9/17 [00:00<00:00, 11.67it/s] 65%|██████▍   | 11/17 [00:00<00:00, 12.00it/s] 76%|███████▋  | 13/17 [00:01<00:00, 12.27it/s] 88%|████████▊ | 15/17 [00:01<00:00, 12.43it/s]100%|██████████| 17/17 [00:04<00:00,  1.67it/s]100%|██████████| 17/17 [00:04<00:00,  3.57it/s]
2025-03-09 09:44:57,855 [INFO]: 	Computing best hyperparameters for index knn.index 03/09/2025, 09:44:57
2025-03-09 09:45:37,269 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 39.4131 secs
2025-03-09 09:45:37,269 [INFO]: The best hyperparameters are: efSearch=185
2025-03-09 09:45:37,269 [INFO]: 	Compute fast metrics 03/09/2025, 09:45:37
  0%|          | 0/4 [00:00<?, ?it/s] 25%|██▌       | 1/4 [00:00<00:00,  5.48it/s] 50%|█████     | 2/4 [00:00<00:00,  7.09it/s] 75%|███████▌  | 3/4 [00:00<00:00,  7.03it/s]
2025-03-09 09:45:54,287 [INFO]: 	>>> Finished "Compute fast metrics" in 17.0173 secs
2025-03-09 09:45:54,290 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 61.2065 secs
2025-03-09 09:45:54,290 [INFO]: {
2025-03-09 09:45:54,290 [INFO]: 	index_key: HNSW15
2025-03-09 09:45:54,290 [INFO]: 	index_param: efSearch=185
2025-03-09 09:45:54,290 [INFO]: 	index_path: knn.index
2025-03-09 09:45:54,290 [INFO]: 	size in bytes: 834588130
2025-03-09 09:45:54,290 [INFO]: 	avg_search_speed_ms: 8.677858165857048
2025-03-09 09:45:54,290 [INFO]: 	99p_search_speed_ms: 12.98793091438711
2025-03-09 09:45:54,290 [INFO]: 	reconstruction error %: 0.0
2025-03-09 09:45:54,290 [INFO]: 	nb vectors: 4242
2025-03-09 09:45:54,290 [INFO]: 	vectors dimension: 49152
2025-03-09 09:45:54,290 [INFO]: 	compression ratio: 0.9993086482071103
2025-03-09 09:45:54,290 [INFO]: }
2025-03-09 09:45:54,290 [INFO]: 	>>> Finished "Creating the index" in 61.2094 secs
2025-03-09 09:45:54,290 [INFO]: >>> Finished "Launching the whole pipeline" in 61.3746 secs
2025-03-09 09:45:54: [retrieval_preprocessing] calculating distances ...
2025-03-09 09:45:55: [retrieval_preprocessing] finished and saved retrieval indices for episode 83012 [episode count 13/20]
[retrieval_preprocessing] for episode 47175 [episode count 14/20], we have num_retrieval=np.int64(4160) num_query=np.int64(276)
2025-03-09 09:45:56,944 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-09 09:45:57,505 [INFO]: Launching the whole pipeline 03/09/2025, 09:45:57
2025-03-09 09:45:57,505 [INFO]: Reading total number of vectors and dimension 03/09/2025, 09:45:57
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 2121.55it/s]
2025-03-09 09:45:57,531 [INFO]: There are 4160 embeddings of dim 49152
2025-03-09 09:45:57,532 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0267 secs
2025-03-09 09:45:57,532 [INFO]: 	Compute estimated construction time of the index 03/09/2025, 09:45:57
2025-03-09 09:45:57,532 [INFO]: 		-> Train: 16.7 minutes
2025-03-09 09:45:57,532 [INFO]: 		-> Add: 2.3 seconds
2025-03-09 09:45:57,532 [INFO]: 		Total: 16.7 minutes
2025-03-09 09:45:57,532 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0004 secs
2025-03-09 09:45:57,532 [INFO]: 	Checking that your have enough memory available to create the index 03/09/2025, 09:45:57
2025-03-09 09:45:57,533 [INFO]: 858.5MB of memory will be needed to build the index (more might be used if you have more)
2025-03-09 09:45:57,533 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0004 secs
2025-03-09 09:45:57,533 [INFO]: 	Selecting most promising index types given data characteristics 03/09/2025, 09:45:57
2025-03-09 09:45:57,533 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-09 09:45:57,533 [INFO]: 	Creating the index 03/09/2025, 09:45:57
2025-03-09 09:45:57,533 [INFO]: 		-> Instanciate the index HNSW15 03/09/2025, 09:45:57
2025-03-09 09:45:57,536 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0029 secs
2025-03-09 09:45:57,537 [INFO]: 		-> Adding the vectors to the index 03/09/2025, 09:45:57
2025-03-09 09:45:57,537 [INFO]: The memory available for adding the vectors is 49.2GB(total available - used by the index)
2025-03-09 09:45:57,537 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/17 [00:00<?, ?it/s]  6%|▌         | 1/17 [00:00<00:02,  6.36it/s] 18%|█▊        | 3/17 [00:00<00:01, 12.31it/s] 29%|██▉       | 5/17 [00:00<00:00, 12.75it/s] 41%|████      | 7/17 [00:00<00:00, 12.23it/s] 53%|█████▎    | 9/17 [00:00<00:00, 12.26it/s] 65%|██████▍   | 11/17 [00:00<00:00, 12.38it/s] 76%|███████▋  | 13/17 [00:01<00:00, 12.67it/s] 88%|████████▊ | 15/17 [00:01<00:00, 12.57it/s]100%|██████████| 17/17 [00:04<00:00,  1.97it/s]100%|██████████| 17/17 [00:04<00:00,  4.14it/s]
2025-03-09 09:46:01,647 [INFO]: 	Computing best hyperparameters for index knn.index 03/09/2025, 09:46:01
2025-03-09 09:46:38,631 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 36.9829 secs
2025-03-09 09:46:38,631 [INFO]: The best hyperparameters are: efSearch=231
2025-03-09 09:46:38,631 [INFO]: 	Compute fast metrics 03/09/2025, 09:46:38
  0%|          | 0/4 [00:00<?, ?it/s] 25%|██▌       | 1/4 [00:00<00:00,  5.16it/s] 50%|█████     | 2/4 [00:00<00:00,  6.95it/s] 75%|███████▌  | 3/4 [00:00<00:00,  7.68it/s] 75%|███████▌  | 3/4 [00:00<00:00,  5.70it/s]
2025-03-09 09:46:56,802 [INFO]: 	>>> Finished "Compute fast metrics" in 18.1711 secs
2025-03-09 09:46:56,806 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 59.2693 secs
2025-03-09 09:46:56,806 [INFO]: {
2025-03-09 09:46:56,806 [INFO]: 	index_key: HNSW15
2025-03-09 09:46:56,806 [INFO]: 	index_param: efSearch=231
2025-03-09 09:46:56,806 [INFO]: 	index_path: knn.index
2025-03-09 09:46:56,806 [INFO]: 	size in bytes: 818455150
2025-03-09 09:46:56,806 [INFO]: 	avg_search_speed_ms: 10.48388486284353
2025-03-09 09:46:56,806 [INFO]: 	99p_search_speed_ms: 19.89213656634093
2025-03-09 09:46:56,806 [INFO]: 	reconstruction error %: 0.0
2025-03-09 09:46:56,806 [INFO]: 	nb vectors: 4160
2025-03-09 09:46:56,806 [INFO]: 	vectors dimension: 49152
2025-03-09 09:46:56,806 [INFO]: 	compression ratio: 0.9993086120846084
2025-03-09 09:46:56,806 [INFO]: }
2025-03-09 09:46:56,806 [INFO]: 	>>> Finished "Creating the index" in 59.2731 secs
2025-03-09 09:46:56,806 [INFO]: >>> Finished "Launching the whole pipeline" in 59.3014 secs
2025-03-09 09:46:58: [retrieval_preprocessing] calculating distances ...
2025-03-09 09:46:59: [retrieval_preprocessing] finished and saved retrieval indices for episode 47175 [episode count 14/20]
[retrieval_preprocessing] for episode 55370 [episode count 15/20], we have num_retrieval=np.int64(4133) num_query=np.int64(303)
2025-03-09 09:47:00,740 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-09 09:47:01,300 [INFO]: Launching the whole pipeline 03/09/2025, 09:47:01
2025-03-09 09:47:01,301 [INFO]: Reading total number of vectors and dimension 03/09/2025, 09:47:01
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1459.90it/s]
2025-03-09 09:47:01,327 [INFO]: There are 4133 embeddings of dim 49152
2025-03-09 09:47:01,327 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0262 secs
2025-03-09 09:47:01,327 [INFO]: 	Compute estimated construction time of the index 03/09/2025, 09:47:01
2025-03-09 09:47:01,327 [INFO]: 		-> Train: 16.7 minutes
2025-03-09 09:47:01,327 [INFO]: 		-> Add: 2.3 seconds
2025-03-09 09:47:01,327 [INFO]: 		Total: 16.7 minutes
2025-03-09 09:47:01,327 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0001 secs
2025-03-09 09:47:01,327 [INFO]: 	Checking that your have enough memory available to create the index 03/09/2025, 09:47:01
2025-03-09 09:47:01,327 [INFO]: 853.0MB of memory will be needed to build the index (more might be used if you have more)
2025-03-09 09:47:01,327 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0001 secs
2025-03-09 09:47:01,327 [INFO]: 	Selecting most promising index types given data characteristics 03/09/2025, 09:47:01
2025-03-09 09:47:01,327 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-09 09:47:01,327 [INFO]: 	Creating the index 03/09/2025, 09:47:01
2025-03-09 09:47:01,327 [INFO]: 		-> Instanciate the index HNSW15 03/09/2025, 09:47:01
2025-03-09 09:47:01,328 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0010 secs
2025-03-09 09:47:01,328 [INFO]: 		-> Adding the vectors to the index 03/09/2025, 09:47:01
2025-03-09 09:47:01,329 [INFO]: The memory available for adding the vectors is 49.2GB(total available - used by the index)
2025-03-09 09:47:01,329 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/17 [00:00<?, ?it/s]  6%|▌         | 1/17 [00:00<00:02,  6.07it/s] 18%|█▊        | 3/17 [00:00<00:01, 10.33it/s] 29%|██▉       | 5/17 [00:00<00:01, 11.84it/s] 41%|████      | 7/17 [00:00<00:00, 12.37it/s] 53%|█████▎    | 9/17 [00:00<00:00, 12.66it/s] 65%|██████▍   | 11/17 [00:00<00:00, 12.69it/s] 76%|███████▋  | 13/17 [00:01<00:00, 12.73it/s] 88%|████████▊ | 15/17 [00:01<00:00, 13.02it/s]100%|██████████| 17/17 [00:04<00:00,  2.02it/s]100%|██████████| 17/17 [00:04<00:00,  4.22it/s]
2025-03-09 09:47:05,364 [INFO]: 	Computing best hyperparameters for index knn.index 03/09/2025, 09:47:05
2025-03-09 09:47:41,673 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 36.3089 secs
2025-03-09 09:47:41,674 [INFO]: The best hyperparameters are: efSearch=221
2025-03-09 09:47:41,674 [INFO]: 	Compute fast metrics 03/09/2025, 09:47:41
  0%|          | 0/4 [00:00<?, ?it/s] 25%|██▌       | 1/4 [00:00<00:00,  4.27it/s] 50%|█████     | 2/4 [00:00<00:00,  6.00it/s] 75%|███████▌  | 3/4 [00:00<00:00,  5.56it/s]
2025-03-09 09:48:00,848 [INFO]: 	>>> Finished "Compute fast metrics" in 19.1737 secs
2025-03-09 09:48:00,851 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 59.5221 secs
2025-03-09 09:48:00,851 [INFO]: {
2025-03-09 09:48:00,851 [INFO]: 	index_key: HNSW15
2025-03-09 09:48:00,851 [INFO]: 	index_param: efSearch=221
2025-03-09 09:48:00,851 [INFO]: 	index_path: knn.index
2025-03-09 09:48:00,851 [INFO]: 	size in bytes: 813143050
2025-03-09 09:48:00,851 [INFO]: 	avg_search_speed_ms: 10.596732490092231
2025-03-09 09:48:00,851 [INFO]: 	99p_search_speed_ms: 22.56006553536278
2025-03-09 09:48:00,851 [INFO]: 	reconstruction error %: 0.0
2025-03-09 09:48:00,851 [INFO]: 	nb vectors: 4133
2025-03-09 09:48:00,851 [INFO]: 	vectors dimension: 49152
2025-03-09 09:48:00,851 [INFO]: 	compression ratio: 0.9993086259545599
2025-03-09 09:48:00,851 [INFO]: }
2025-03-09 09:48:00,851 [INFO]: 	>>> Finished "Creating the index" in 59.5236 secs
2025-03-09 09:48:00,851 [INFO]: >>> Finished "Launching the whole pipeline" in 59.5505 secs
2025-03-09 09:48:02: [retrieval_preprocessing] calculating distances ...
2025-03-09 09:48:03: [retrieval_preprocessing] finished and saved retrieval indices for episode 55370 [episode count 15/20]
[retrieval_preprocessing] for episode 92750 [episode count 16/20], we have num_retrieval=np.int64(4180) num_query=np.int64(256)
2025-03-09 09:48:04,539 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-09 09:48:05,129 [INFO]: Launching the whole pipeline 03/09/2025, 09:48:05
2025-03-09 09:48:05,129 [INFO]: Reading total number of vectors and dimension 03/09/2025, 09:48:05
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1923.11it/s]
2025-03-09 09:48:05,155 [INFO]: There are 4180 embeddings of dim 49152
2025-03-09 09:48:05,155 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0255 secs
2025-03-09 09:48:05,155 [INFO]: 	Compute estimated construction time of the index 03/09/2025, 09:48:05
2025-03-09 09:48:05,155 [INFO]: 		-> Train: 16.7 minutes
2025-03-09 09:48:05,155 [INFO]: 		-> Add: 2.3 seconds
2025-03-09 09:48:05,155 [INFO]: 		Total: 16.7 minutes
2025-03-09 09:48:05,155 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0001 secs
2025-03-09 09:48:05,155 [INFO]: 	Checking that your have enough memory available to create the index 03/09/2025, 09:48:05
2025-03-09 09:48:05,155 [INFO]: 862.7MB of memory will be needed to build the index (more might be used if you have more)
2025-03-09 09:48:05,155 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0002 secs
2025-03-09 09:48:05,156 [INFO]: 	Selecting most promising index types given data characteristics 03/09/2025, 09:48:05
2025-03-09 09:48:05,156 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-09 09:48:05,156 [INFO]: 	Creating the index 03/09/2025, 09:48:05
2025-03-09 09:48:05,156 [INFO]: 		-> Instanciate the index HNSW15 03/09/2025, 09:48:05
2025-03-09 09:48:05,157 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0012 secs
2025-03-09 09:48:05,157 [INFO]: 		-> Adding the vectors to the index 03/09/2025, 09:48:05
2025-03-09 09:48:05,157 [INFO]: The memory available for adding the vectors is 49.2GB(total available - used by the index)
2025-03-09 09:48:05,157 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/17 [00:00<?, ?it/s]  6%|▌         | 1/17 [00:00<00:02,  5.44it/s] 18%|█▊        | 3/17 [00:00<00:01,  9.45it/s] 29%|██▉       | 5/17 [00:00<00:01, 11.02it/s] 41%|████      | 7/17 [00:00<00:00, 10.85it/s] 53%|█████▎    | 9/17 [00:00<00:00, 11.78it/s] 65%|██████▍   | 11/17 [00:00<00:00, 12.45it/s] 76%|███████▋  | 13/17 [00:01<00:00, 11.64it/s] 88%|████████▊ | 15/17 [00:01<00:00, 11.84it/s]100%|██████████| 17/17 [00:03<00:00,  2.10it/s]100%|██████████| 17/17 [00:03<00:00,  4.27it/s]
2025-03-09 09:48:09,217 [INFO]: 	Computing best hyperparameters for index knn.index 03/09/2025, 09:48:09
2025-03-09 09:48:42,842 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 33.6248 secs
2025-03-09 09:48:42,843 [INFO]: The best hyperparameters are: efSearch=262
2025-03-09 09:48:42,843 [INFO]: 	Compute fast metrics 03/09/2025, 09:48:42
  0%|          | 0/4 [00:00<?, ?it/s] 25%|██▌       | 1/4 [00:00<00:00,  5.75it/s] 50%|█████     | 2/4 [00:00<00:00,  7.17it/s] 75%|███████▌  | 3/4 [00:00<00:00,  7.82it/s] 75%|███████▌  | 3/4 [00:00<00:00,  5.91it/s]
2025-03-09 09:49:09,231 [INFO]: 	>>> Finished "Compute fast metrics" in 26.3885 secs
2025-03-09 09:49:09,234 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 64.0773 secs
2025-03-09 09:49:09,234 [INFO]: {
2025-03-09 09:49:09,234 [INFO]: 	index_key: HNSW15
2025-03-09 09:49:09,234 [INFO]: 	index_param: efSearch=262
2025-03-09 09:49:09,234 [INFO]: 	index_path: knn.index
2025-03-09 09:49:09,234 [INFO]: 	size in bytes: 822389950
2025-03-09 09:49:09,235 [INFO]: 	avg_search_speed_ms: 10.219794136554809
2025-03-09 09:49:09,235 [INFO]: 	99p_search_speed_ms: 13.609625352546573
2025-03-09 09:49:09,235 [INFO]: 	reconstruction error %: 0.0
2025-03-09 09:49:09,235 [INFO]: 	nb vectors: 4180
2025-03-09 09:49:09,235 [INFO]: 	vectors dimension: 49152
2025-03-09 09:49:09,235 [INFO]: 	compression ratio: 0.9993087099374208
2025-03-09 09:49:09,235 [INFO]: }
2025-03-09 09:49:09,235 [INFO]: 	>>> Finished "Creating the index" in 64.0790 secs
2025-03-09 09:49:09,235 [INFO]: >>> Finished "Launching the whole pipeline" in 64.1052 secs
2025-03-09 09:49:10: [retrieval_preprocessing] calculating distances ...
2025-03-09 09:49:11: [retrieval_preprocessing] finished and saved retrieval indices for episode 92750 [episode count 16/20]
[retrieval_preprocessing] for episode 80987 [episode count 17/20], we have num_retrieval=np.int64(4193) num_query=np.int64(243)
2025-03-09 09:49:12,988 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-09 09:49:13,600 [INFO]: Launching the whole pipeline 03/09/2025, 09:49:13
2025-03-09 09:49:13,600 [INFO]: Reading total number of vectors and dimension 03/09/2025, 09:49:13
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1368.90it/s]
2025-03-09 09:49:13,624 [INFO]: There are 4193 embeddings of dim 49152
2025-03-09 09:49:13,625 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0247 secs
2025-03-09 09:49:13,625 [INFO]: 	Compute estimated construction time of the index 03/09/2025, 09:49:13
2025-03-09 09:49:13,625 [INFO]: 		-> Train: 16.7 minutes
2025-03-09 09:49:13,625 [INFO]: 		-> Add: 2.3 seconds
2025-03-09 09:49:13,625 [INFO]: 		Total: 16.7 minutes
2025-03-09 09:49:13,625 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0003 secs
2025-03-09 09:49:13,625 [INFO]: 	Checking that your have enough memory available to create the index 03/09/2025, 09:49:13
2025-03-09 09:49:13,626 [INFO]: 865.3MB of memory will be needed to build the index (more might be used if you have more)
2025-03-09 09:49:13,626 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0004 secs
2025-03-09 09:49:13,626 [INFO]: 	Selecting most promising index types given data characteristics 03/09/2025, 09:49:13
2025-03-09 09:49:13,626 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-09 09:49:13,626 [INFO]: 	Creating the index 03/09/2025, 09:49:13
2025-03-09 09:49:13,627 [INFO]: 		-> Instanciate the index HNSW15 03/09/2025, 09:49:13
2025-03-09 09:49:13,630 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0030 secs
2025-03-09 09:49:13,630 [INFO]: 		-> Adding the vectors to the index 03/09/2025, 09:49:13
2025-03-09 09:49:13,630 [INFO]: The memory available for adding the vectors is 49.2GB(total available - used by the index)
2025-03-09 09:49:13,630 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/17 [00:00<?, ?it/s]  6%|▌         | 1/17 [00:00<00:02,  5.36it/s] 12%|█▏        | 2/17 [00:00<00:02,  7.24it/s] 18%|█▊        | 3/17 [00:00<00:01,  8.00it/s] 24%|██▎       | 4/17 [00:00<00:01,  8.40it/s] 29%|██▉       | 5/17 [00:00<00:01,  8.67it/s] 35%|███▌      | 6/17 [00:00<00:01,  8.82it/s] 47%|████▋     | 8/17 [00:00<00:00, 10.52it/s] 59%|█████▉    | 10/17 [00:01<00:00, 11.02it/s] 71%|███████   | 12/17 [00:01<00:00, 11.52it/s] 82%|████████▏ | 14/17 [00:01<00:00, 11.37it/s] 94%|█████████▍| 16/17 [00:01<00:00, 11.18it/s]100%|██████████| 17/17 [00:04<00:00,  3.54it/s]
2025-03-09 09:49:18,444 [INFO]: 	Computing best hyperparameters for index knn.index 03/09/2025, 09:49:18
2025-03-09 09:49:54,835 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 36.3908 secs
2025-03-09 09:49:54,835 [INFO]: The best hyperparameters are: efSearch=200
2025-03-09 09:49:54,835 [INFO]: 	Compute fast metrics 03/09/2025, 09:49:54
  0%|          | 0/4 [00:00<?, ?it/s] 25%|██▌       | 1/4 [00:00<00:00,  5.43it/s] 50%|█████     | 2/4 [00:00<00:00,  7.06it/s] 75%|███████▌  | 3/4 [00:00<00:00,  8.03it/s] 75%|███████▌  | 3/4 [00:00<00:00,  5.92it/s]
2025-03-09 09:50:11,739 [INFO]: 	>>> Finished "Compute fast metrics" in 16.9031 secs
2025-03-09 09:50:11,741 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 58.1111 secs
2025-03-09 09:50:11,741 [INFO]: {
2025-03-09 09:50:11,741 [INFO]: 	index_key: HNSW15
2025-03-09 09:50:11,741 [INFO]: 	index_param: efSearch=200
2025-03-09 09:50:11,741 [INFO]: 	index_path: knn.index
2025-03-09 09:50:11,741 [INFO]: 	size in bytes: 824947570
2025-03-09 09:50:11,741 [INFO]: 	avg_search_speed_ms: 8.767292999697556
2025-03-09 09:50:11,741 [INFO]: 	99p_search_speed_ms: 15.203151479363425
2025-03-09 09:50:11,741 [INFO]: 	reconstruction error %: 0.0
2025-03-09 09:50:11,741 [INFO]: 	nb vectors: 4193
2025-03-09 09:50:11,741 [INFO]: 	vectors dimension: 49152
2025-03-09 09:50:11,741 [INFO]: 	compression ratio: 0.9993087730411764
2025-03-09 09:50:11,741 [INFO]: }
2025-03-09 09:50:11,742 [INFO]: 	>>> Finished "Creating the index" in 58.1149 secs
2025-03-09 09:50:11,742 [INFO]: >>> Finished "Launching the whole pipeline" in 58.1416 secs
2025-03-09 09:50:12: [retrieval_preprocessing] calculating distances ...
2025-03-09 09:50:13: [retrieval_preprocessing] finished and saved retrieval indices for episode 80987 [episode count 17/20]
[retrieval_preprocessing] for episode 60530 [episode count 18/20], we have num_retrieval=np.int64(4261) num_query=np.int64(175)
2025-03-09 09:50:14,477 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-09 09:50:15,028 [INFO]: Launching the whole pipeline 03/09/2025, 09:50:15
2025-03-09 09:50:15,028 [INFO]: Reading total number of vectors and dimension 03/09/2025, 09:50:15
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1462.45it/s]
2025-03-09 09:50:15,055 [INFO]: There are 4261 embeddings of dim 49152
2025-03-09 09:50:15,056 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0279 secs
2025-03-09 09:50:15,056 [INFO]: 	Compute estimated construction time of the index 03/09/2025, 09:50:15
2025-03-09 09:50:15,056 [INFO]: 		-> Train: 16.7 minutes
2025-03-09 09:50:15,056 [INFO]: 		-> Add: 2.3 seconds
2025-03-09 09:50:15,056 [INFO]: 		Total: 16.7 minutes
2025-03-09 09:50:15,056 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0001 secs
2025-03-09 09:50:15,056 [INFO]: 	Checking that your have enough memory available to create the index 03/09/2025, 09:50:15
2025-03-09 09:50:15,056 [INFO]: 879.4MB of memory will be needed to build the index (more might be used if you have more)
2025-03-09 09:50:15,056 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0002 secs
2025-03-09 09:50:15,056 [INFO]: 	Selecting most promising index types given data characteristics 03/09/2025, 09:50:15
2025-03-09 09:50:15,056 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-09 09:50:15,056 [INFO]: 	Creating the index 03/09/2025, 09:50:15
2025-03-09 09:50:15,056 [INFO]: 		-> Instanciate the index HNSW15 03/09/2025, 09:50:15
2025-03-09 09:50:15,058 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0012 secs
2025-03-09 09:50:15,058 [INFO]: 		-> Adding the vectors to the index 03/09/2025, 09:50:15
2025-03-09 09:50:15,058 [INFO]: The memory available for adding the vectors is 49.2GB(total available - used by the index)
2025-03-09 09:50:15,058 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/17 [00:00<?, ?it/s]  6%|▌         | 1/17 [00:00<00:02,  6.39it/s] 18%|█▊        | 3/17 [00:00<00:01, 10.38it/s] 29%|██▉       | 5/17 [00:00<00:01, 11.79it/s] 41%|████      | 7/17 [00:00<00:00, 12.47it/s] 53%|█████▎    | 9/17 [00:00<00:00, 12.88it/s] 65%|██████▍   | 11/17 [00:00<00:00, 13.11it/s] 76%|███████▋  | 13/17 [00:01<00:00, 13.37it/s] 88%|████████▊ | 15/17 [00:01<00:00, 13.34it/s]100%|██████████| 17/17 [00:04<00:00,  1.98it/s]100%|██████████| 17/17 [00:04<00:00,  4.18it/s]
2025-03-09 09:50:19,138 [INFO]: 	Computing best hyperparameters for index knn.index 03/09/2025, 09:50:19
2025-03-09 09:50:59,447 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 40.3088 secs
2025-03-09 09:50:59,448 [INFO]: The best hyperparameters are: efSearch=215
2025-03-09 09:50:59,448 [INFO]: 	Compute fast metrics 03/09/2025, 09:50:59
  0%|          | 0/4 [00:00<?, ?it/s] 25%|██▌       | 1/4 [00:00<00:00,  5.26it/s] 50%|█████     | 2/4 [00:00<00:00,  7.10it/s] 75%|███████▌  | 3/4 [00:00<00:00,  7.93it/s] 75%|███████▌  | 3/4 [00:00<00:00,  5.91it/s]
2025-03-09 09:51:18,125 [INFO]: 	>>> Finished "Compute fast metrics" in 18.6774 secs
2025-03-09 09:51:18,129 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 63.0704 secs
2025-03-09 09:51:18,129 [INFO]: {
2025-03-09 09:51:18,129 [INFO]: 	index_key: HNSW15
2025-03-09 09:51:18,129 [INFO]: 	index_param: efSearch=215
2025-03-09 09:51:18,129 [INFO]: 	index_path: knn.index
2025-03-09 09:51:18,129 [INFO]: 	size in bytes: 838326190
2025-03-09 09:51:18,129 [INFO]: 	avg_search_speed_ms: 7.873477996876977
2025-03-09 09:51:18,129 [INFO]: 	99p_search_speed_ms: 11.500235022976987
2025-03-09 09:51:18,129 [INFO]: 	reconstruction error %: 0.0
2025-03-09 09:51:18,129 [INFO]: 	nb vectors: 4261
2025-03-09 09:51:18,129 [INFO]: 	vectors dimension: 49152
2025-03-09 09:51:18,129 [INFO]: 	compression ratio: 0.9993087392390783
2025-03-09 09:51:18,129 [INFO]: }
2025-03-09 09:51:18,129 [INFO]: 	>>> Finished "Creating the index" in 63.0725 secs
2025-03-09 09:51:18,129 [INFO]: >>> Finished "Launching the whole pipeline" in 63.1012 secs
2025-03-09 09:51:18: [retrieval_preprocessing] calculating distances ...
2025-03-09 09:51:19: [retrieval_preprocessing] finished and saved retrieval indices for episode 60530 [episode count 18/20]
[retrieval_preprocessing] for episode 24691 [episode count 19/20], we have num_retrieval=np.int64(4266) num_query=np.int64(170)
2025-03-09 09:51:20,976 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-09 09:51:21,591 [INFO]: Launching the whole pipeline 03/09/2025, 09:51:21
2025-03-09 09:51:21,592 [INFO]: Reading total number of vectors and dimension 03/09/2025, 09:51:21
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1030.79it/s]
2025-03-09 09:51:21,618 [INFO]: There are 4266 embeddings of dim 49152
2025-03-09 09:51:21,618 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0265 secs
2025-03-09 09:51:21,618 [INFO]: 	Compute estimated construction time of the index 03/09/2025, 09:51:21
2025-03-09 09:51:21,618 [INFO]: 		-> Train: 16.7 minutes
2025-03-09 09:51:21,618 [INFO]: 		-> Add: 2.3 seconds
2025-03-09 09:51:21,618 [INFO]: 		Total: 16.7 minutes
2025-03-09 09:51:21,618 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0001 secs
2025-03-09 09:51:21,618 [INFO]: 	Checking that your have enough memory available to create the index 03/09/2025, 09:51:21
2025-03-09 09:51:21,619 [INFO]: 880.4MB of memory will be needed to build the index (more might be used if you have more)
2025-03-09 09:51:21,619 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0002 secs
2025-03-09 09:51:21,619 [INFO]: 	Selecting most promising index types given data characteristics 03/09/2025, 09:51:21
2025-03-09 09:51:21,619 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-09 09:51:21,619 [INFO]: 	Creating the index 03/09/2025, 09:51:21
2025-03-09 09:51:21,619 [INFO]: 		-> Instanciate the index HNSW15 03/09/2025, 09:51:21
2025-03-09 09:51:21,620 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0012 secs
2025-03-09 09:51:21,620 [INFO]: 		-> Adding the vectors to the index 03/09/2025, 09:51:21
2025-03-09 09:51:21,620 [INFO]: The memory available for adding the vectors is 49.2GB(total available - used by the index)
2025-03-09 09:51:21,620 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/17 [00:00<?, ?it/s]  6%|▌         | 1/17 [00:00<00:02,  5.45it/s] 18%|█▊        | 3/17 [00:00<00:01,  9.24it/s] 29%|██▉       | 5/17 [00:00<00:01, 10.64it/s] 41%|████      | 7/17 [00:00<00:00, 11.01it/s] 53%|█████▎    | 9/17 [00:00<00:00, 11.35it/s] 65%|██████▍   | 11/17 [00:01<00:00, 11.61it/s] 76%|███████▋  | 13/17 [00:01<00:00, 11.29it/s] 88%|████████▊ | 15/17 [00:01<00:00, 11.28it/s]100%|██████████| 17/17 [00:04<00:00,  1.79it/s]100%|██████████| 17/17 [00:04<00:00,  3.75it/s]
2025-03-09 09:51:26,167 [INFO]: 	Computing best hyperparameters for index knn.index 03/09/2025, 09:51:26
2025-03-09 09:52:05,903 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 39.7348 secs
2025-03-09 09:52:05,903 [INFO]: The best hyperparameters are: efSearch=226
2025-03-09 09:52:05,903 [INFO]: 	Compute fast metrics 03/09/2025, 09:52:05
  0%|          | 0/4 [00:00<?, ?it/s] 25%|██▌       | 1/4 [00:00<00:00,  5.17it/s] 50%|█████     | 2/4 [00:00<00:00,  6.79it/s] 75%|███████▌  | 3/4 [00:00<00:00,  7.46it/s] 75%|███████▌  | 3/4 [00:00<00:00,  5.65it/s]
2025-03-09 09:52:33,425 [INFO]: 	>>> Finished "Compute fast metrics" in 27.5217 secs
2025-03-09 09:52:33,428 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 71.8076 secs
2025-03-09 09:52:33,428 [INFO]: {
2025-03-09 09:52:33,428 [INFO]: 	index_key: HNSW15
2025-03-09 09:52:33,428 [INFO]: 	index_param: efSearch=226
2025-03-09 09:52:33,428 [INFO]: 	index_path: knn.index
2025-03-09 09:52:33,428 [INFO]: 	size in bytes: 839309890
2025-03-09 09:52:33,428 [INFO]: 	avg_search_speed_ms: 9.312246899463902
2025-03-09 09:52:33,428 [INFO]: 	99p_search_speed_ms: 14.328742953948677
2025-03-09 09:52:33,428 [INFO]: 	reconstruction error %: 0.0
2025-03-09 09:52:33,428 [INFO]: 	nb vectors: 4266
2025-03-09 09:52:33,428 [INFO]: 	vectors dimension: 49152
2025-03-09 09:52:33,428 [INFO]: 	compression ratio: 0.9993087630600898
2025-03-09 09:52:33,428 [INFO]: }
2025-03-09 09:52:33,428 [INFO]: 	>>> Finished "Creating the index" in 71.8094 secs
2025-03-09 09:52:33,428 [INFO]: >>> Finished "Launching the whole pipeline" in 71.8366 secs
2025-03-09 09:52:34: [retrieval_preprocessing] calculating distances ...
2025-03-09 09:52:35: [retrieval_preprocessing] finished and saved retrieval indices for episode 24691 [episode count 19/20]
2025-03-09 09:52:35: [retrieval_preprocessing] finished for (3452853472, 'drawer') [chosen_id count 9/10]
2025-03-09 09:52:35: [retrieval_preprocessing] done for embedding_type='embeddings__wrist_image_left'!
