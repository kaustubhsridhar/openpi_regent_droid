nohup: ignoring input
2025-03-09 06:47:19: got the info dicts: there are 36687 groupings

2025-03-09 06:47:19: number of groupings with atleast 50 episodes [in the first 95658 episodes]: 105

these groupings have chosen_id-->num_episodes as

 {(1297764552, 'bottle'): 53, (2515873443, 'cloth'): 50, (5235850418, 'drawer'): 612, (5879622450, 'block'): 108, (1431810548, 'lid'): 51, (3485794757, 'marker'): 97, (8756300955, 'block'): 117, (1180576306, 'cloth'): 60, (9154343709, 'drawer'): 96, (6498288010, 'bottle'): 138, (8911427557, 'bottle'): 50, (1058976383, 'drawer'): 148, (4045730075, 'lid'): 61, (1712293193, 'marker'): 163, (65137982, 'block'): 100, (4329524892, 'cup'): 166, (484659531, 'marker'): 96, (-1, 'marker'): 1032, (6078642573, 'marker'): 54, (452818143, 'lid'): 221, (1461982682, 'cloth'): 76, (5235850418, 'block'): 97, (7495112204, 'marker'): 102, (666854965, 'marker'): 68, (395700094, 'block'): 72, (3827924651, 'lid'): 67, (6612454114, 'block'): 65, (2782099537, 'marker'): 75, (8376714657, 'marker'): 464, (3452853472, 'drawer'): 91, (9306310171, 'marker'): 97, (3816161570, 'drawer'): 78, (5511329841, 'marker'): 59, (3951366978, 'cup'): 112, (1959308322, 'marker'): 65, (3163748394, 'cup'): 127, (7644292911, 'marker'): 50, (1775582436, 'marker'): 98, (4706041793, 'cloth'): 142, (2370783071, 'block'): 50, (9551783935, 'drawer'): 65, (2782099537, 'cup'): 153, (7489911085, 'cloth'): 179, (5576515039, 'marker'): 50, (4465064685, 'marker'): 198, (9186164821, 'bottle'): 57, (5207831207, 'cup'): 139, (3774560981, 'cloth'): 99, (4823049285, 'bottle'): 234, (9130122211, 'marker'): 159, (6313680013, 'cup'): 50, (9088223759, 'bottle'): 99, (8098563998, 'lid'): 73, (9505766118, 'drawer'): 108, (441689524, 'mug'): 77, (8150285641, 'marker'): 63, (8456936732, 'bottle'): 54, (446878712, 'marker'): 83, (6093644330, 'cloth'): 52, (4345518188, 'lid'): 89, (5024387521, 'marker'): 60, (6498288010, 'lid'): 96, (4823049285, 'block'): 174, (6667529842, 'lid'): 90, (5507987860, 'marker'): 100, (8898968162, 'block'): 58, (-1, 'mug'): 228, (9965421062, 'bottle'): 63, (6357288647, 'lid'): 71, (5701580274, 'marker'): 67, (1469427884, 'marker'): 63, (9933578360, 'drawer'): 53, (1498834123, 'cup'): 77, (440287856, 'drawer'): 75, (376702246, 'cup'): 53, (9883209091, 'mug'): 201, (9934859632, 'marker'): 62, (4312815282, 'marker'): 66, (-1, 'cup'): 113, (8922050678, 'lid'): 64, (2883696971, 'cup'): 69, (9209350647, 'drawer'): 76, (6655265581, 'cup'): 51, (4345518188, 'cloth'): 91, (4545879864, 'marker'): 51, (818725642, 'block'): 63, (3854327802, 'bottle'): 97, (3951366978, 'lid'): 72, (5059283044, 'drawer'): 113, (4846810092, 'cloth'): 93, (8690198922, 'marker'): 65, (1477699675, 'marker'): 89, (4400212150, 'marker'): 52, (1526685371, 'marker'): 62, (6074146895, 'lid'): 59, (8911427557, 'cup'): 112, (8702636502, 'lid'): 90, (8172596608, 'cup'): 51, (1575177183, 'marker'): 59, (5414640868, 'lid'): 56, (1477699675, 'mug'): 57, (9228483020, 'marker'): 80, (2927338332, 'cloth'): 51, (52817038, 'block'): 54, (8815207926, 'block'): 54}
2025-03-09 06:47:19: [retrieval_preprocessing] starting retrieval preprocessing for embeddings__wrist_image_left
2025-03-09 06:47:20: [retrieval_preprocessing] concatenated all embeddings and indices for 20 episodes for (9306310171, 'marker') [chosen_id count 0/10]
2025-03-09 06:47:20: [retrieval_preprocessing] we have num_total=2594 embedding_dim=49152
[retrieval_preprocessing] for episode 26627 [episode count 0/20], we have num_retrieval=np.int64(2466) num_query=np.int64(128)
2025-03-09 06:47:20,236 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-09 06:47:20,546 [INFO]: Launching the whole pipeline 03/09/2025, 06:47:20
2025-03-09 06:47:20,546 [INFO]: Reading total number of vectors and dimension 03/09/2025, 06:47:20
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 684.45it/s]
2025-03-09 06:47:20,588 [INFO]: There are 2466 embeddings of dim 49152
2025-03-09 06:47:20,589 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0426 secs
2025-03-09 06:47:20,589 [INFO]: 	Compute estimated construction time of the index 03/09/2025, 06:47:20
2025-03-09 06:47:20,589 [INFO]: 		-> Train: 16.7 minutes
2025-03-09 06:47:20,589 [INFO]: 		-> Add: 1.4 seconds
2025-03-09 06:47:20,589 [INFO]: 		Total: 16.7 minutes
2025-03-09 06:47:20,589 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0002 secs
2025-03-09 06:47:20,589 [INFO]: 	Checking that your have enough memory available to create the index 03/09/2025, 06:47:20
2025-03-09 06:47:20,590 [INFO]: 508.9MB of memory will be needed to build the index (more might be used if you have more)
2025-03-09 06:47:20,590 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0007 secs
2025-03-09 06:47:20,590 [INFO]: 	Selecting most promising index types given data characteristics 03/09/2025, 06:47:20
2025-03-09 06:47:20,590 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-09 06:47:20,590 [INFO]: 	Creating the index 03/09/2025, 06:47:20
2025-03-09 06:47:20,590 [INFO]: 		-> Instanciate the index HNSW15 03/09/2025, 06:47:20
2025-03-09 06:47:20,591 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0013 secs
2025-03-09 06:47:20,591 [INFO]: 		-> Adding the vectors to the index 03/09/2025, 06:47:20
2025-03-09 06:47:20,592 [INFO]: The memory available for adding the vectors is 49.5GB(total available - used by the index)
2025-03-09 06:47:20,592 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/10 [00:00<?, ?it/s] 30%|███       | 3/10 [00:00<00:00, 27.06it/s]100%|██████████| 10/10 [00:01<00:00,  6.19it/s]100%|██████████| 10/10 [00:01<00:00,  6.65it/s]
2025-03-09 06:47:22,100 [INFO]: 	Computing best hyperparameters for index knn.index 03/09/2025, 06:47:22
2025-03-09 06:47:47,774 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 25.6737 secs
2025-03-09 06:47:47,775 [INFO]: The best hyperparameters are: efSearch=279
2025-03-09 06:47:47,775 [INFO]: 	Compute fast metrics 03/09/2025, 06:47:47
  0%|          | 0/4 [00:00<?, ?it/s] 50%|█████     | 2/4 [00:00<00:00, 18.74it/s] 75%|███████▌  | 3/4 [00:00<00:00, 21.45it/s]
2025-03-09 06:47:59,310 [INFO]: 	>>> Finished "Compute fast metrics" in 11.5349 secs
2025-03-09 06:47:59,311 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 38.7199 secs
2025-03-09 06:47:59,312 [INFO]: {
2025-03-09 06:47:59,312 [INFO]: 	index_key: HNSW15
2025-03-09 06:47:59,312 [INFO]: 	index_param: efSearch=279
2025-03-09 06:47:59,312 [INFO]: 	index_path: knn.index
2025-03-09 06:47:59,312 [INFO]: 	size in bytes: 485170090
2025-03-09 06:47:59,312 [INFO]: 	avg_search_speed_ms: 10.23379671158829
2025-03-09 06:47:59,312 [INFO]: 	99p_search_speed_ms: 18.73875200049953
2025-03-09 06:47:59,312 [INFO]: 	reconstruction error %: 0.0
2025-03-09 06:47:59,312 [INFO]: 	nb vectors: 2466
2025-03-09 06:47:59,312 [INFO]: 	vectors dimension: 49152
2025-03-09 06:47:59,312 [INFO]: 	compression ratio: 0.9993100110520003
2025-03-09 06:47:59,312 [INFO]: }
2025-03-09 06:47:59,312 [INFO]: 	>>> Finished "Creating the index" in 38.7219 secs
2025-03-09 06:47:59,312 [INFO]: >>> Finished "Launching the whole pipeline" in 38.7659 secs
2025-03-09 06:48:00: [retrieval_preprocessing] calculating distances ...
2025-03-09 06:48:00: [retrieval_preprocessing] finished and saved retrieval indices for episode 26627 [episode count 0/20]
[retrieval_preprocessing] for episode 44559 [episode count 1/20], we have num_retrieval=np.int64(2460) num_query=np.int64(134)
2025-03-09 06:48:00,835 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-09 06:48:01,250 [INFO]: Launching the whole pipeline 03/09/2025, 06:48:01
2025-03-09 06:48:01,250 [INFO]: Reading total number of vectors and dimension 03/09/2025, 06:48:01
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1224.97it/s]
2025-03-09 06:48:01,281 [INFO]: There are 2460 embeddings of dim 49152
2025-03-09 06:48:01,281 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0305 secs
2025-03-09 06:48:01,281 [INFO]: 	Compute estimated construction time of the index 03/09/2025, 06:48:01
2025-03-09 06:48:01,281 [INFO]: 		-> Train: 16.7 minutes
2025-03-09 06:48:01,281 [INFO]: 		-> Add: 1.4 seconds
2025-03-09 06:48:01,281 [INFO]: 		Total: 16.7 minutes
2025-03-09 06:48:01,281 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0001 secs
2025-03-09 06:48:01,281 [INFO]: 	Checking that your have enough memory available to create the index 03/09/2025, 06:48:01
2025-03-09 06:48:01,281 [INFO]: 507.7MB of memory will be needed to build the index (more might be used if you have more)
2025-03-09 06:48:01,281 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0002 secs
2025-03-09 06:48:01,281 [INFO]: 	Selecting most promising index types given data characteristics 03/09/2025, 06:48:01
2025-03-09 06:48:01,281 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-09 06:48:01,281 [INFO]: 	Creating the index 03/09/2025, 06:48:01
2025-03-09 06:48:01,281 [INFO]: 		-> Instanciate the index HNSW15 03/09/2025, 06:48:01
2025-03-09 06:48:01,282 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0009 secs
2025-03-09 06:48:01,282 [INFO]: 		-> Adding the vectors to the index 03/09/2025, 06:48:01
2025-03-09 06:48:01,282 [INFO]: The memory available for adding the vectors is 49.5GB(total available - used by the index)
2025-03-09 06:48:01,282 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/10 [00:00<?, ?it/s] 30%|███       | 3/10 [00:00<00:00, 26.52it/s] 90%|█████████ | 9/10 [00:00<00:00, 44.96it/s]100%|██████████| 10/10 [00:01<00:00,  5.03it/s]
2025-03-09 06:48:03,276 [INFO]: 	Computing best hyperparameters for index knn.index 03/09/2025, 06:48:03
2025-03-09 06:48:30,343 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 27.0669 secs
2025-03-09 06:48:30,343 [INFO]: The best hyperparameters are: efSearch=187
2025-03-09 06:48:30,343 [INFO]: 	Compute fast metrics 03/09/2025, 06:48:30
  0%|          | 0/4 [00:00<?, ?it/s] 50%|█████     | 2/4 [00:00<00:00, 19.63it/s] 75%|███████▌  | 3/4 [00:00<00:00, 21.50it/s]
2025-03-09 06:48:41,901 [INFO]: 	>>> Finished "Compute fast metrics" in 11.5576 secs
2025-03-09 06:48:41,903 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 40.6206 secs
2025-03-09 06:48:41,903 [INFO]: {
2025-03-09 06:48:41,903 [INFO]: 	index_key: HNSW15
2025-03-09 06:48:41,903 [INFO]: 	index_param: efSearch=187
2025-03-09 06:48:41,903 [INFO]: 	index_path: knn.index
2025-03-09 06:48:41,903 [INFO]: 	size in bytes: 483989650
2025-03-09 06:48:41,903 [INFO]: 	avg_search_speed_ms: 9.144314009503852
2025-03-09 06:48:41,903 [INFO]: 	99p_search_speed_ms: 22.81107483664527
2025-03-09 06:48:41,903 [INFO]: 	reconstruction error %: 0.0
2025-03-09 06:48:41,903 [INFO]: 	nb vectors: 2460
2025-03-09 06:48:41,903 [INFO]: 	vectors dimension: 49152
2025-03-09 06:48:41,903 [INFO]: 	compression ratio: 0.9993099645829203
2025-03-09 06:48:41,903 [INFO]: }
2025-03-09 06:48:41,903 [INFO]: 	>>> Finished "Creating the index" in 40.6221 secs
2025-03-09 06:48:41,903 [INFO]: >>> Finished "Launching the whole pipeline" in 40.6533 secs
2025-03-09 06:48:42: [retrieval_preprocessing] calculating distances ...
2025-03-09 06:48:42: [retrieval_preprocessing] finished and saved retrieval indices for episode 44559 [episode count 1/20]
[retrieval_preprocessing] for episode 50193 [episode count 2/20], we have num_retrieval=np.int64(2476) num_query=np.int64(118)
2025-03-09 06:48:43,174 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-09 06:48:43,496 [INFO]: Launching the whole pipeline 03/09/2025, 06:48:43
2025-03-09 06:48:43,496 [INFO]: Reading total number of vectors and dimension 03/09/2025, 06:48:43
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1575.03it/s]
2025-03-09 06:48:43,525 [INFO]: There are 2476 embeddings of dim 49152
2025-03-09 06:48:43,525 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0285 secs
2025-03-09 06:48:43,525 [INFO]: 	Compute estimated construction time of the index 03/09/2025, 06:48:43
2025-03-09 06:48:43,525 [INFO]: 		-> Train: 16.7 minutes
2025-03-09 06:48:43,525 [INFO]: 		-> Add: 1.4 seconds
2025-03-09 06:48:43,525 [INFO]: 		Total: 16.7 minutes
2025-03-09 06:48:43,525 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0001 secs
2025-03-09 06:48:43,525 [INFO]: 	Checking that your have enough memory available to create the index 03/09/2025, 06:48:43
2025-03-09 06:48:43,525 [INFO]: 511.0MB of memory will be needed to build the index (more might be used if you have more)
2025-03-09 06:48:43,525 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0001 secs
2025-03-09 06:48:43,525 [INFO]: 	Selecting most promising index types given data characteristics 03/09/2025, 06:48:43
2025-03-09 06:48:43,525 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-09 06:48:43,525 [INFO]: 	Creating the index 03/09/2025, 06:48:43
2025-03-09 06:48:43,525 [INFO]: 		-> Instanciate the index HNSW15 03/09/2025, 06:48:43
2025-03-09 06:48:43,526 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0009 secs
2025-03-09 06:48:43,526 [INFO]: 		-> Adding the vectors to the index 03/09/2025, 06:48:43
2025-03-09 06:48:43,526 [INFO]: The memory available for adding the vectors is 49.5GB(total available - used by the index)
2025-03-09 06:48:43,527 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/10 [00:00<?, ?it/s] 10%|█         | 1/10 [00:00<00:00,  9.59it/s] 60%|██████    | 6/10 [00:00<00:00, 32.25it/s]100%|██████████| 10/10 [00:01<00:00,  4.39it/s]100%|██████████| 10/10 [00:01<00:00,  5.25it/s]
2025-03-09 06:48:45,433 [INFO]: 	Computing best hyperparameters for index knn.index 03/09/2025, 06:48:45
2025-03-09 06:49:17,457 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 32.0231 secs
2025-03-09 06:49:17,457 [INFO]: The best hyperparameters are: efSearch=191
2025-03-09 06:49:17,457 [INFO]: 	Compute fast metrics 03/09/2025, 06:49:17
  0%|          | 0/4 [00:00<?, ?it/s] 50%|█████     | 2/4 [00:00<00:00, 18.61it/s] 75%|███████▌  | 3/4 [00:00<00:00, 20.68it/s]
2025-03-09 06:49:29,271 [INFO]: 	>>> Finished "Compute fast metrics" in 11.8143 secs
2025-03-09 06:49:29,273 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 45.7464 secs
2025-03-09 06:49:29,273 [INFO]: {
2025-03-09 06:49:29,273 [INFO]: 	index_key: HNSW15
2025-03-09 06:49:29,273 [INFO]: 	index_param: efSearch=191
2025-03-09 06:49:29,273 [INFO]: 	index_path: knn.index
2025-03-09 06:49:29,273 [INFO]: 	size in bytes: 487137490
2025-03-09 06:49:29,273 [INFO]: 	avg_search_speed_ms: 8.81860040315481
2025-03-09 06:49:29,273 [INFO]: 	99p_search_speed_ms: 21.366305262781715
2025-03-09 06:49:29,273 [INFO]: 	reconstruction error %: 0.0
2025-03-09 06:49:29,273 [INFO]: 	nb vectors: 2476
2025-03-09 06:49:29,273 [INFO]: 	vectors dimension: 49152
2025-03-09 06:49:29,273 [INFO]: 	compression ratio: 0.9993100880000018
2025-03-09 06:49:29,273 [INFO]: }
2025-03-09 06:49:29,273 [INFO]: 	>>> Finished "Creating the index" in 45.7477 secs
2025-03-09 06:49:29,273 [INFO]: >>> Finished "Launching the whole pipeline" in 45.7768 secs
2025-03-09 06:49:29: [retrieval_preprocessing] calculating distances ...
2025-03-09 06:49:30: [retrieval_preprocessing] finished and saved retrieval indices for episode 50193 [episode count 2/20]
[retrieval_preprocessing] for episode 57364 [episode count 3/20], we have num_retrieval=np.int64(2465) num_query=np.int64(129)
2025-03-09 06:49:30,247 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-09 06:49:30,562 [INFO]: Launching the whole pipeline 03/09/2025, 06:49:30
2025-03-09 06:49:30,562 [INFO]: Reading total number of vectors and dimension 03/09/2025, 06:49:30
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 2163.13it/s]
2025-03-09 06:49:30,590 [INFO]: There are 2465 embeddings of dim 49152
2025-03-09 06:49:30,590 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0278 secs
2025-03-09 06:49:30,590 [INFO]: 	Compute estimated construction time of the index 03/09/2025, 06:49:30
2025-03-09 06:49:30,590 [INFO]: 		-> Train: 16.7 minutes
2025-03-09 06:49:30,590 [INFO]: 		-> Add: 1.4 seconds
2025-03-09 06:49:30,590 [INFO]: 		Total: 16.7 minutes
2025-03-09 06:49:30,590 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0001 secs
2025-03-09 06:49:30,590 [INFO]: 	Checking that your have enough memory available to create the index 03/09/2025, 06:49:30
2025-03-09 06:49:30,590 [INFO]: 508.7MB of memory will be needed to build the index (more might be used if you have more)
2025-03-09 06:49:30,590 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0001 secs
2025-03-09 06:49:30,590 [INFO]: 	Selecting most promising index types given data characteristics 03/09/2025, 06:49:30
2025-03-09 06:49:30,590 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-09 06:49:30,591 [INFO]: 	Creating the index 03/09/2025, 06:49:30
2025-03-09 06:49:30,591 [INFO]: 		-> Instanciate the index HNSW15 03/09/2025, 06:49:30
2025-03-09 06:49:30,592 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0009 secs
2025-03-09 06:49:30,592 [INFO]: 		-> Adding the vectors to the index 03/09/2025, 06:49:30
2025-03-09 06:49:30,592 [INFO]: The memory available for adding the vectors is 49.5GB(total available - used by the index)
2025-03-09 06:49:30,592 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/10 [00:00<?, ?it/s] 20%|██        | 2/10 [00:00<00:00, 17.34it/s] 80%|████████  | 8/10 [00:00<00:00, 38.99it/s]100%|██████████| 10/10 [00:01<00:00,  5.08it/s]
2025-03-09 06:49:32,563 [INFO]: 	Computing best hyperparameters for index knn.index 03/09/2025, 06:49:32
2025-03-09 06:50:05,295 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 32.7313 secs
2025-03-09 06:50:05,295 [INFO]: The best hyperparameters are: efSearch=232
2025-03-09 06:50:05,295 [INFO]: 	Compute fast metrics 03/09/2025, 06:50:05
  0%|          | 0/4 [00:00<?, ?it/s] 25%|██▌       | 1/4 [00:00<00:00,  6.89it/s] 75%|███████▌  | 3/4 [00:00<00:00, 12.11it/s]
2025-03-09 06:50:19,454 [INFO]: 	>>> Finished "Compute fast metrics" in 14.1581 secs
2025-03-09 06:50:19,456 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 48.8639 secs
2025-03-09 06:50:19,456 [INFO]: {
2025-03-09 06:50:19,456 [INFO]: 	index_key: HNSW15
2025-03-09 06:50:19,456 [INFO]: 	index_param: efSearch=232
2025-03-09 06:50:19,456 [INFO]: 	index_path: knn.index
2025-03-09 06:50:19,456 [INFO]: 	size in bytes: 484973350
2025-03-09 06:50:19,456 [INFO]: 	avg_search_speed_ms: 11.000338246906535
2025-03-09 06:50:19,456 [INFO]: 	99p_search_speed_ms: 28.56952134519814
2025-03-09 06:50:19,456 [INFO]: 	reconstruction error %: 0.0
2025-03-09 06:50:19,456 [INFO]: 	nb vectors: 2465
2025-03-09 06:50:19,456 [INFO]: 	vectors dimension: 49152
2025-03-09 06:50:19,456 [INFO]: 	compression ratio: 0.999310003322863
2025-03-09 06:50:19,456 [INFO]: }
2025-03-09 06:50:19,456 [INFO]: 	>>> Finished "Creating the index" in 48.8654 secs
2025-03-09 06:50:19,456 [INFO]: >>> Finished "Launching the whole pipeline" in 48.8938 secs
2025-03-09 06:50:20: [retrieval_preprocessing] calculating distances ...
2025-03-09 06:50:20: [retrieval_preprocessing] finished and saved retrieval indices for episode 57364 [episode count 3/20]
[retrieval_preprocessing] for episode 81437 [episode count 4/20], we have num_retrieval=np.int64(2450) num_query=np.int64(144)
2025-03-09 06:50:21,215 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-09 06:50:21,547 [INFO]: Launching the whole pipeline 03/09/2025, 06:50:21
2025-03-09 06:50:21,547 [INFO]: Reading total number of vectors and dimension 03/09/2025, 06:50:21
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1334.07it/s]
2025-03-09 06:50:21,581 [INFO]: There are 2450 embeddings of dim 49152
2025-03-09 06:50:21,582 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0342 secs
2025-03-09 06:50:21,582 [INFO]: 	Compute estimated construction time of the index 03/09/2025, 06:50:21
2025-03-09 06:50:21,582 [INFO]: 		-> Train: 16.7 minutes
2025-03-09 06:50:21,582 [INFO]: 		-> Add: 1.3 seconds
2025-03-09 06:50:21,582 [INFO]: 		Total: 16.7 minutes
2025-03-09 06:50:21,582 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0001 secs
2025-03-09 06:50:21,582 [INFO]: 	Checking that your have enough memory available to create the index 03/09/2025, 06:50:21
2025-03-09 06:50:21,582 [INFO]: 505.6MB of memory will be needed to build the index (more might be used if you have more)
2025-03-09 06:50:21,582 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0001 secs
2025-03-09 06:50:21,582 [INFO]: 	Selecting most promising index types given data characteristics 03/09/2025, 06:50:21
2025-03-09 06:50:21,582 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-09 06:50:21,582 [INFO]: 	Creating the index 03/09/2025, 06:50:21
2025-03-09 06:50:21,582 [INFO]: 		-> Instanciate the index HNSW15 03/09/2025, 06:50:21
2025-03-09 06:50:21,583 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0010 secs
2025-03-09 06:50:21,583 [INFO]: 		-> Adding the vectors to the index 03/09/2025, 06:50:21
2025-03-09 06:50:21,583 [INFO]: The memory available for adding the vectors is 49.6GB(total available - used by the index)
2025-03-09 06:50:21,583 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/10 [00:00<?, ?it/s] 10%|█         | 1/10 [00:00<00:00,  9.92it/s] 60%|██████    | 6/10 [00:00<00:00, 30.81it/s]100%|██████████| 10/10 [00:02<00:00,  3.49it/s]100%|██████████| 10/10 [00:02<00:00,  4.21it/s]
2025-03-09 06:50:23,962 [INFO]: 	Computing best hyperparameters for index knn.index 03/09/2025, 06:50:23
2025-03-09 06:50:58,505 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 34.5428 secs
2025-03-09 06:50:58,505 [INFO]: The best hyperparameters are: efSearch=236
2025-03-09 06:50:58,505 [INFO]: 	Compute fast metrics 03/09/2025, 06:50:58
  0%|          | 0/4 [00:00<?, ?it/s] 25%|██▌       | 1/4 [00:00<00:00,  6.30it/s] 75%|███████▌  | 3/4 [00:00<00:00, 12.11it/s]
2025-03-09 06:51:10,180 [INFO]: 	>>> Finished "Compute fast metrics" in 11.6751 secs
2025-03-09 06:51:10,183 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 48.5996 secs
2025-03-09 06:51:10,183 [INFO]: {
2025-03-09 06:51:10,183 [INFO]: 	index_key: HNSW15
2025-03-09 06:51:10,183 [INFO]: 	index_param: efSearch=236
2025-03-09 06:51:10,183 [INFO]: 	index_path: knn.index
2025-03-09 06:51:10,183 [INFO]: 	size in bytes: 482022190
2025-03-09 06:51:10,183 [INFO]: 	avg_search_speed_ms: 10.991099084328328
2025-03-09 06:51:10,183 [INFO]: 	99p_search_speed_ms: 29.31612531654536
2025-03-09 06:51:10,183 [INFO]: 	reconstruction error %: 0.0
2025-03-09 06:51:10,183 [INFO]: 	nb vectors: 2450
2025-03-09 06:51:10,183 [INFO]: 	vectors dimension: 49152
2025-03-09 06:51:10,183 [INFO]: 	compression ratio: 0.9993100110183724
2025-03-09 06:51:10,183 [INFO]: }
2025-03-09 06:51:10,183 [INFO]: 	>>> Finished "Creating the index" in 48.6013 secs
2025-03-09 06:51:10,183 [INFO]: >>> Finished "Launching the whole pipeline" in 48.6361 secs
2025-03-09 06:51:11: [retrieval_preprocessing] calculating distances ...
2025-03-09 06:51:12: [retrieval_preprocessing] finished and saved retrieval indices for episode 81437 [episode count 4/20]
[retrieval_preprocessing] for episode 18465 [episode count 5/20], we have num_retrieval=np.int64(2455) num_query=np.int64(139)
2025-03-09 06:51:12,247 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-09 06:51:12,661 [INFO]: Launching the whole pipeline 03/09/2025, 06:51:12
2025-03-09 06:51:12,661 [INFO]: Reading total number of vectors and dimension 03/09/2025, 06:51:12
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1592.37it/s]
2025-03-09 06:51:12,692 [INFO]: There are 2455 embeddings of dim 49152
2025-03-09 06:51:12,692 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0305 secs
2025-03-09 06:51:12,692 [INFO]: 	Compute estimated construction time of the index 03/09/2025, 06:51:12
2025-03-09 06:51:12,692 [INFO]: 		-> Train: 16.7 minutes
2025-03-09 06:51:12,692 [INFO]: 		-> Add: 1.3 seconds
2025-03-09 06:51:12,692 [INFO]: 		Total: 16.7 minutes
2025-03-09 06:51:12,692 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0001 secs
2025-03-09 06:51:12,692 [INFO]: 	Checking that your have enough memory available to create the index 03/09/2025, 06:51:12
2025-03-09 06:51:12,692 [INFO]: 506.7MB of memory will be needed to build the index (more might be used if you have more)
2025-03-09 06:51:12,692 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0001 secs
2025-03-09 06:51:12,692 [INFO]: 	Selecting most promising index types given data characteristics 03/09/2025, 06:51:12
2025-03-09 06:51:12,692 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-09 06:51:12,692 [INFO]: 	Creating the index 03/09/2025, 06:51:12
2025-03-09 06:51:12,692 [INFO]: 		-> Instanciate the index HNSW15 03/09/2025, 06:51:12
2025-03-09 06:51:12,693 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0009 secs
2025-03-09 06:51:12,693 [INFO]: 		-> Adding the vectors to the index 03/09/2025, 06:51:12
2025-03-09 06:51:12,694 [INFO]: The memory available for adding the vectors is 49.6GB(total available - used by the index)
2025-03-09 06:51:12,694 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/10 [00:00<?, ?it/s] 20%|██        | 2/10 [00:00<00:00, 18.12it/s] 80%|████████  | 8/10 [00:00<00:00, 36.17it/s]100%|██████████| 10/10 [00:02<00:00,  4.05it/s]
2025-03-09 06:51:15,168 [INFO]: 	Computing best hyperparameters for index knn.index 03/09/2025, 06:51:15
2025-03-09 06:51:44,132 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 28.9630 secs
2025-03-09 06:51:44,132 [INFO]: The best hyperparameters are: efSearch=240
2025-03-09 06:51:44,132 [INFO]: 	Compute fast metrics 03/09/2025, 06:51:44
  0%|          | 0/4 [00:00<?, ?it/s] 50%|█████     | 2/4 [00:00<00:00, 18.79it/s] 75%|███████▌  | 3/4 [00:00<00:00, 20.21it/s]
2025-03-09 06:51:56,127 [INFO]: 	>>> Finished "Compute fast metrics" in 11.9954 secs
2025-03-09 06:51:56,129 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 43.4354 secs
2025-03-09 06:51:56,129 [INFO]: {
2025-03-09 06:51:56,129 [INFO]: 	index_key: HNSW15
2025-03-09 06:51:56,129 [INFO]: 	index_param: efSearch=240
2025-03-09 06:51:56,129 [INFO]: 	index_path: knn.index
2025-03-09 06:51:56,129 [INFO]: 	size in bytes: 483005950
2025-03-09 06:51:56,129 [INFO]: 	avg_search_speed_ms: 10.06860924206584
2025-03-09 06:51:56,129 [INFO]: 	99p_search_speed_ms: 13.76713926903904
2025-03-09 06:51:56,129 [INFO]: 	reconstruction error %: 0.0
2025-03-09 06:51:56,129 [INFO]: 	nb vectors: 2455
2025-03-09 06:51:56,129 [INFO]: 	vectors dimension: 49152
2025-03-09 06:51:56,129 [INFO]: 	compression ratio: 0.9993099256851805
2025-03-09 06:51:56,129 [INFO]: }
2025-03-09 06:51:56,129 [INFO]: 	>>> Finished "Creating the index" in 43.4367 secs
2025-03-09 06:51:56,129 [INFO]: >>> Finished "Launching the whole pipeline" in 43.4678 secs
2025-03-09 06:51:57: [retrieval_preprocessing] calculating distances ...
2025-03-09 06:51:57: [retrieval_preprocessing] finished and saved retrieval indices for episode 18465 [episode count 5/20]
[retrieval_preprocessing] for episode 57385 [episode count 6/20], we have num_retrieval=np.int64(2462) num_query=np.int64(132)
2025-03-09 06:51:57,739 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-09 06:51:58,092 [INFO]: Launching the whole pipeline 03/09/2025, 06:51:58
2025-03-09 06:51:58,092 [INFO]: Reading total number of vectors and dimension 03/09/2025, 06:51:58
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1517.48it/s]
2025-03-09 06:51:58,119 [INFO]: There are 2462 embeddings of dim 49152
2025-03-09 06:51:58,119 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0268 secs
2025-03-09 06:51:58,119 [INFO]: 	Compute estimated construction time of the index 03/09/2025, 06:51:58
2025-03-09 06:51:58,119 [INFO]: 		-> Train: 16.7 minutes
2025-03-09 06:51:58,119 [INFO]: 		-> Add: 1.4 seconds
2025-03-09 06:51:58,119 [INFO]: 		Total: 16.7 minutes
2025-03-09 06:51:58,119 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0001 secs
2025-03-09 06:51:58,119 [INFO]: 	Checking that your have enough memory available to create the index 03/09/2025, 06:51:58
2025-03-09 06:51:58,119 [INFO]: 508.1MB of memory will be needed to build the index (more might be used if you have more)
2025-03-09 06:51:58,119 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0001 secs
2025-03-09 06:51:58,119 [INFO]: 	Selecting most promising index types given data characteristics 03/09/2025, 06:51:58
2025-03-09 06:51:58,119 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-09 06:51:58,119 [INFO]: 	Creating the index 03/09/2025, 06:51:58
2025-03-09 06:51:58,119 [INFO]: 		-> Instanciate the index HNSW15 03/09/2025, 06:51:58
2025-03-09 06:51:58,120 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0009 secs
2025-03-09 06:51:58,120 [INFO]: 		-> Adding the vectors to the index 03/09/2025, 06:51:58
2025-03-09 06:51:58,120 [INFO]: The memory available for adding the vectors is 49.5GB(total available - used by the index)
2025-03-09 06:51:58,121 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/10 [00:00<?, ?it/s] 20%|██        | 2/10 [00:00<00:00, 17.69it/s] 70%|███████   | 7/10 [00:00<00:00, 35.32it/s]100%|██████████| 10/10 [00:01<00:00,  5.06it/s]
2025-03-09 06:52:00,098 [INFO]: 	Computing best hyperparameters for index knn.index 03/09/2025, 06:52:00
2025-03-09 06:52:32,524 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 32.4249 secs
2025-03-09 06:52:32,524 [INFO]: The best hyperparameters are: efSearch=228
2025-03-09 06:52:32,524 [INFO]: 	Compute fast metrics 03/09/2025, 06:52:32
  0%|          | 0/4 [00:00<?, ?it/s] 50%|█████     | 2/4 [00:00<00:00, 18.57it/s] 75%|███████▌  | 3/4 [00:00<00:00, 20.60it/s]
2025-03-09 06:52:44,492 [INFO]: 	>>> Finished "Compute fast metrics" in 11.9680 secs
2025-03-09 06:52:44,497 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 46.3761 secs
2025-03-09 06:52:44,497 [INFO]: {
2025-03-09 06:52:44,497 [INFO]: 	index_key: HNSW15
2025-03-09 06:52:44,497 [INFO]: 	index_param: efSearch=228
2025-03-09 06:52:44,497 [INFO]: 	index_path: knn.index
2025-03-09 06:52:44,497 [INFO]: 	size in bytes: 484383130
2025-03-09 06:52:44,497 [INFO]: 	avg_search_speed_ms: 10.397875792852249
2025-03-09 06:52:44,497 [INFO]: 	99p_search_speed_ms: 25.44645036570728
2025-03-09 06:52:44,497 [INFO]: 	reconstruction error %: 0.0
2025-03-09 06:52:44,497 [INFO]: 	nb vectors: 2462
2025-03-09 06:52:44,497 [INFO]: 	vectors dimension: 49152
2025-03-09 06:52:44,497 [INFO]: 	compression ratio: 0.9993099800977792
2025-03-09 06:52:44,497 [INFO]: }
2025-03-09 06:52:44,497 [INFO]: 	>>> Finished "Creating the index" in 46.3779 secs
2025-03-09 06:52:44,497 [INFO]: >>> Finished "Launching the whole pipeline" in 46.4052 secs
2025-03-09 06:52:45: [retrieval_preprocessing] calculating distances ...
2025-03-09 06:52:45: [retrieval_preprocessing] finished and saved retrieval indices for episode 57385 [episode count 6/20]
[retrieval_preprocessing] for episode 57897 [episode count 7/20], we have num_retrieval=np.int64(2468) num_query=np.int64(126)
2025-03-09 06:52:46,000 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-09 06:52:46,330 [INFO]: Launching the whole pipeline 03/09/2025, 06:52:46
2025-03-09 06:52:46,330 [INFO]: Reading total number of vectors and dimension 03/09/2025, 06:52:46
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1902.18it/s]
2025-03-09 06:52:46,359 [INFO]: There are 2468 embeddings of dim 49152
2025-03-09 06:52:46,359 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0294 secs
2025-03-09 06:52:46,359 [INFO]: 	Compute estimated construction time of the index 03/09/2025, 06:52:46
2025-03-09 06:52:46,360 [INFO]: 		-> Train: 16.7 minutes
2025-03-09 06:52:46,360 [INFO]: 		-> Add: 1.4 seconds
2025-03-09 06:52:46,360 [INFO]: 		Total: 16.7 minutes
2025-03-09 06:52:46,360 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0004 secs
2025-03-09 06:52:46,360 [INFO]: 	Checking that your have enough memory available to create the index 03/09/2025, 06:52:46
2025-03-09 06:52:46,360 [INFO]: 509.3MB of memory will be needed to build the index (more might be used if you have more)
2025-03-09 06:52:46,361 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0004 secs
2025-03-09 06:52:46,361 [INFO]: 	Selecting most promising index types given data characteristics 03/09/2025, 06:52:46
2025-03-09 06:52:46,361 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-09 06:52:46,361 [INFO]: 	Creating the index 03/09/2025, 06:52:46
2025-03-09 06:52:46,361 [INFO]: 		-> Instanciate the index HNSW15 03/09/2025, 06:52:46
2025-03-09 06:52:46,363 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0023 secs
2025-03-09 06:52:46,364 [INFO]: 		-> Adding the vectors to the index 03/09/2025, 06:52:46
2025-03-09 06:52:46,364 [INFO]: The memory available for adding the vectors is 49.5GB(total available - used by the index)
2025-03-09 06:52:46,364 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/10 [00:00<?, ?it/s] 20%|██        | 2/10 [00:00<00:00, 16.00it/s] 60%|██████    | 6/10 [00:00<00:00, 28.36it/s]100%|██████████| 10/10 [00:01<00:00,  4.10it/s]100%|██████████| 10/10 [00:01<00:00,  5.01it/s]
2025-03-09 06:52:48,365 [INFO]: 	Computing best hyperparameters for index knn.index 03/09/2025, 06:52:48
2025-03-09 06:53:21,625 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 33.2598 secs
2025-03-09 06:53:21,625 [INFO]: The best hyperparameters are: efSearch=179
2025-03-09 06:53:21,625 [INFO]: 	Compute fast metrics 03/09/2025, 06:53:21
  0%|          | 0/4 [00:00<?, ?it/s] 50%|█████     | 2/4 [00:00<00:00, 18.93it/s] 75%|███████▌  | 3/4 [00:00<00:00, 20.79it/s]
2025-03-09 06:53:33,472 [INFO]: 	>>> Finished "Compute fast metrics" in 11.8466 secs
2025-03-09 06:53:33,474 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 47.1105 secs
2025-03-09 06:53:33,474 [INFO]: {
2025-03-09 06:53:33,475 [INFO]: 	index_key: HNSW15
2025-03-09 06:53:33,475 [INFO]: 	index_param: efSearch=179
2025-03-09 06:53:33,475 [INFO]: 	index_path: knn.index
2025-03-09 06:53:33,475 [INFO]: 	size in bytes: 485563570
2025-03-09 06:53:33,475 [INFO]: 	avg_search_speed_ms: 8.564252833746476
2025-03-09 06:53:33,475 [INFO]: 	99p_search_speed_ms: 17.478058405686163
2025-03-09 06:53:33,475 [INFO]: 	reconstruction error %: 0.0
2025-03-09 06:53:33,475 [INFO]: 	nb vectors: 2468
2025-03-09 06:53:33,475 [INFO]: 	vectors dimension: 49152
2025-03-09 06:53:33,475 [INFO]: 	compression ratio: 0.9993100264914849
2025-03-09 06:53:33,475 [INFO]: }
2025-03-09 06:53:33,475 [INFO]: 	>>> Finished "Creating the index" in 47.1138 secs
2025-03-09 06:53:33,475 [INFO]: >>> Finished "Launching the whole pipeline" in 47.1451 secs
2025-03-09 06:53:34: [retrieval_preprocessing] calculating distances ...
2025-03-09 06:53:34: [retrieval_preprocessing] finished and saved retrieval indices for episode 57897 [episode count 7/20]
[retrieval_preprocessing] for episode 63020 [episode count 8/20], we have num_retrieval=np.int64(2457) num_query=np.int64(137)
2025-03-09 06:53:34,741 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-09 06:53:35,080 [INFO]: Launching the whole pipeline 03/09/2025, 06:53:35
2025-03-09 06:53:35,080 [INFO]: Reading total number of vectors and dimension 03/09/2025, 06:53:35
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 2155.35it/s]
2025-03-09 06:53:35,108 [INFO]: There are 2457 embeddings of dim 49152
2025-03-09 06:53:35,108 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0282 secs
2025-03-09 06:53:35,108 [INFO]: 	Compute estimated construction time of the index 03/09/2025, 06:53:35
2025-03-09 06:53:35,108 [INFO]: 		-> Train: 16.7 minutes
2025-03-09 06:53:35,108 [INFO]: 		-> Add: 1.3 seconds
2025-03-09 06:53:35,108 [INFO]: 		Total: 16.7 minutes
2025-03-09 06:53:35,108 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0001 secs
2025-03-09 06:53:35,108 [INFO]: 	Checking that your have enough memory available to create the index 03/09/2025, 06:53:35
2025-03-09 06:53:35,108 [INFO]: 507.1MB of memory will be needed to build the index (more might be used if you have more)
2025-03-09 06:53:35,108 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0001 secs
2025-03-09 06:53:35,108 [INFO]: 	Selecting most promising index types given data characteristics 03/09/2025, 06:53:35
2025-03-09 06:53:35,108 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-09 06:53:35,108 [INFO]: 	Creating the index 03/09/2025, 06:53:35
2025-03-09 06:53:35,108 [INFO]: 		-> Instanciate the index HNSW15 03/09/2025, 06:53:35
2025-03-09 06:53:35,109 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0009 secs
2025-03-09 06:53:35,109 [INFO]: 		-> Adding the vectors to the index 03/09/2025, 06:53:35
2025-03-09 06:53:35,110 [INFO]: The memory available for adding the vectors is 49.5GB(total available - used by the index)
2025-03-09 06:53:35,110 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/10 [00:00<?, ?it/s] 10%|█         | 1/10 [00:00<00:00,  9.41it/s] 60%|██████    | 6/10 [00:00<00:00, 29.35it/s]100%|██████████| 10/10 [00:01<00:00,  4.53it/s]100%|██████████| 10/10 [00:01<00:00,  5.39it/s]
2025-03-09 06:53:36,967 [INFO]: 	Computing best hyperparameters for index knn.index 03/09/2025, 06:53:36
2025-03-09 06:54:05,132 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 28.1644 secs
2025-03-09 06:54:05,132 [INFO]: The best hyperparameters are: efSearch=226
2025-03-09 06:54:05,133 [INFO]: 	Compute fast metrics 03/09/2025, 06:54:05
  0%|          | 0/4 [00:00<?, ?it/s] 50%|█████     | 2/4 [00:00<00:00, 18.80it/s] 75%|███████▌  | 3/4 [00:00<00:00, 20.61it/s]
2025-03-09 06:54:16,622 [INFO]: 	>>> Finished "Compute fast metrics" in 11.4893 secs
2025-03-09 06:54:16,624 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 41.5143 secs
2025-03-09 06:54:16,624 [INFO]: {
2025-03-09 06:54:16,624 [INFO]: 	index_key: HNSW15
2025-03-09 06:54:16,624 [INFO]: 	index_param: efSearch=226
2025-03-09 06:54:16,624 [INFO]: 	index_path: knn.index
2025-03-09 06:54:16,624 [INFO]: 	size in bytes: 483399430
2025-03-09 06:54:16,624 [INFO]: 	avg_search_speed_ms: 10.065143027528372
2025-03-09 06:54:16,624 [INFO]: 	99p_search_speed_ms: 15.903751915320747
2025-03-09 06:54:16,624 [INFO]: 	reconstruction error %: 0.0
2025-03-09 06:54:16,624 [INFO]: 	nb vectors: 2457
2025-03-09 06:54:16,624 [INFO]: 	vectors dimension: 49152
2025-03-09 06:54:16,624 [INFO]: 	compression ratio: 0.9993099412632738
2025-03-09 06:54:16,624 [INFO]: }
2025-03-09 06:54:16,624 [INFO]: 	>>> Finished "Creating the index" in 41.5157 secs
2025-03-09 06:54:16,624 [INFO]: >>> Finished "Launching the whole pipeline" in 41.5445 secs
2025-03-09 06:54:17: [retrieval_preprocessing] calculating distances ...
2025-03-09 06:54:17: [retrieval_preprocessing] finished and saved retrieval indices for episode 63020 [episode count 8/20]
[retrieval_preprocessing] for episode 2094 [episode count 9/20], we have num_retrieval=np.int64(2467) num_query=np.int64(127)
2025-03-09 06:54:18,174 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-09 06:54:18,566 [INFO]: Launching the whole pipeline 03/09/2025, 06:54:18
2025-03-09 06:54:18,566 [INFO]: Reading total number of vectors and dimension 03/09/2025, 06:54:18
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 2052.01it/s]
2025-03-09 06:54:18,595 [INFO]: There are 2467 embeddings of dim 49152
2025-03-09 06:54:18,595 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0295 secs
2025-03-09 06:54:18,595 [INFO]: 	Compute estimated construction time of the index 03/09/2025, 06:54:18
2025-03-09 06:54:18,596 [INFO]: 		-> Train: 16.7 minutes
2025-03-09 06:54:18,596 [INFO]: 		-> Add: 1.4 seconds
2025-03-09 06:54:18,596 [INFO]: 		Total: 16.7 minutes
2025-03-09 06:54:18,596 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0004 secs
2025-03-09 06:54:18,596 [INFO]: 	Checking that your have enough memory available to create the index 03/09/2025, 06:54:18
2025-03-09 06:54:18,596 [INFO]: 509.1MB of memory will be needed to build the index (more might be used if you have more)
2025-03-09 06:54:18,596 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0004 secs
2025-03-09 06:54:18,597 [INFO]: 	Selecting most promising index types given data characteristics 03/09/2025, 06:54:18
2025-03-09 06:54:18,597 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-09 06:54:18,597 [INFO]: 	Creating the index 03/09/2025, 06:54:18
2025-03-09 06:54:18,597 [INFO]: 		-> Instanciate the index HNSW15 03/09/2025, 06:54:18
2025-03-09 06:54:18,600 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0026 secs
2025-03-09 06:54:18,600 [INFO]: 		-> Adding the vectors to the index 03/09/2025, 06:54:18
2025-03-09 06:54:18,600 [INFO]: The memory available for adding the vectors is 49.5GB(total available - used by the index)
2025-03-09 06:54:18,600 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/10 [00:00<?, ?it/s] 30%|███       | 3/10 [00:00<00:00, 27.96it/s] 90%|█████████ | 9/10 [00:00<00:00, 44.18it/s]100%|██████████| 10/10 [00:01<00:00,  5.03it/s]
2025-03-09 06:54:20,595 [INFO]: 	Computing best hyperparameters for index knn.index 03/09/2025, 06:54:20
2025-03-09 06:54:53,442 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 32.8461 secs
2025-03-09 06:54:53,442 [INFO]: The best hyperparameters are: efSearch=218
2025-03-09 06:54:53,442 [INFO]: 	Compute fast metrics 03/09/2025, 06:54:53
  0%|          | 0/4 [00:00<?, ?it/s] 25%|██▌       | 1/4 [00:00<00:00,  4.94it/s] 50%|█████     | 2/4 [00:00<00:00,  6.17it/s] 75%|███████▌  | 3/4 [00:00<00:00,  6.68it/s] 75%|███████▌  | 3/4 [00:00<00:00,  5.02it/s]
2025-03-09 06:55:06,803 [INFO]: 	>>> Finished "Compute fast metrics" in 13.3612 secs
2025-03-09 06:55:06,806 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 48.2061 secs
2025-03-09 06:55:06,806 [INFO]: {
2025-03-09 06:55:06,806 [INFO]: 	index_key: HNSW15
2025-03-09 06:55:06,806 [INFO]: 	index_param: efSearch=218
2025-03-09 06:55:06,806 [INFO]: 	index_path: knn.index
2025-03-09 06:55:06,806 [INFO]: 	size in bytes: 485366830
2025-03-09 06:55:06,806 [INFO]: 	avg_search_speed_ms: 11.204379231617906
2025-03-09 06:55:06,806 [INFO]: 	99p_search_speed_ms: 14.540440747514369
2025-03-09 06:55:06,806 [INFO]: 	reconstruction error %: 0.0
2025-03-09 06:55:06,806 [INFO]: 	nb vectors: 2467
2025-03-09 06:55:06,806 [INFO]: 	vectors dimension: 49152
2025-03-09 06:55:06,806 [INFO]: 	compression ratio: 0.9993100187748718
2025-03-09 06:55:06,806 [INFO]: }
2025-03-09 06:55:06,806 [INFO]: 	>>> Finished "Creating the index" in 48.2095 secs
2025-03-09 06:55:06,806 [INFO]: >>> Finished "Launching the whole pipeline" in 48.2407 secs
2025-03-09 06:55:07: [retrieval_preprocessing] calculating distances ...
2025-03-09 06:55:07: [retrieval_preprocessing] finished and saved retrieval indices for episode 2094 [episode count 9/20]
[retrieval_preprocessing] for episode 5678 [episode count 10/20], we have num_retrieval=np.int64(2451) num_query=np.int64(143)
2025-03-09 06:55:08,572 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-09 06:55:08,915 [INFO]: Launching the whole pipeline 03/09/2025, 06:55:08
2025-03-09 06:55:08,915 [INFO]: Reading total number of vectors and dimension 03/09/2025, 06:55:08
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1119.08it/s]
2025-03-09 06:55:08,944 [INFO]: There are 2451 embeddings of dim 49152
2025-03-09 06:55:08,944 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0295 secs
2025-03-09 06:55:08,944 [INFO]: 	Compute estimated construction time of the index 03/09/2025, 06:55:08
2025-03-09 06:55:08,944 [INFO]: 		-> Train: 16.7 minutes
2025-03-09 06:55:08,944 [INFO]: 		-> Add: 1.3 seconds
2025-03-09 06:55:08,944 [INFO]: 		Total: 16.7 minutes
2025-03-09 06:55:08,944 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0001 secs
2025-03-09 06:55:08,944 [INFO]: 	Checking that your have enough memory available to create the index 03/09/2025, 06:55:08
2025-03-09 06:55:08,945 [INFO]: 505.8MB of memory will be needed to build the index (more might be used if you have more)
2025-03-09 06:55:08,945 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0002 secs
2025-03-09 06:55:08,945 [INFO]: 	Selecting most promising index types given data characteristics 03/09/2025, 06:55:08
2025-03-09 06:55:08,945 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-09 06:55:08,945 [INFO]: 	Creating the index 03/09/2025, 06:55:08
2025-03-09 06:55:08,945 [INFO]: 		-> Instanciate the index HNSW15 03/09/2025, 06:55:08
2025-03-09 06:55:08,946 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0011 secs
2025-03-09 06:55:08,946 [INFO]: 		-> Adding the vectors to the index 03/09/2025, 06:55:08
2025-03-09 06:55:08,946 [INFO]: The memory available for adding the vectors is 49.6GB(total available - used by the index)
2025-03-09 06:55:08,946 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/10 [00:00<?, ?it/s] 10%|█         | 1/10 [00:00<00:01,  5.29it/s] 20%|██        | 2/10 [00:00<00:01,  6.59it/s] 30%|███       | 3/10 [00:00<00:01,  6.87it/s] 40%|████      | 4/10 [00:00<00:00,  7.83it/s] 50%|█████     | 5/10 [00:00<00:00,  8.42it/s] 60%|██████    | 6/10 [00:00<00:00,  8.50it/s] 70%|███████   | 7/10 [00:00<00:00,  8.53it/s] 80%|████████  | 8/10 [00:01<00:00,  8.57it/s] 90%|█████████ | 9/10 [00:01<00:00,  8.37it/s]100%|██████████| 10/10 [00:03<00:00,  1.31it/s]100%|██████████| 10/10 [00:03<00:00,  2.99it/s]
2025-03-09 06:55:12,293 [INFO]: 	Computing best hyperparameters for index knn.index 03/09/2025, 06:55:12
2025-03-09 06:55:43,169 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 30.8749 secs
2025-03-09 06:55:43,170 [INFO]: The best hyperparameters are: efSearch=230
2025-03-09 06:55:43,170 [INFO]: 	Compute fast metrics 03/09/2025, 06:55:43
  0%|          | 0/4 [00:00<?, ?it/s] 50%|█████     | 2/4 [00:00<00:00, 18.82it/s] 75%|███████▌  | 3/4 [00:00<00:00, 20.03it/s]
2025-03-09 06:55:56,086 [INFO]: 	>>> Finished "Compute fast metrics" in 12.9155 secs
2025-03-09 06:55:56,088 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 47.1422 secs
2025-03-09 06:55:56,088 [INFO]: {
2025-03-09 06:55:56,089 [INFO]: 	index_key: HNSW15
2025-03-09 06:55:56,089 [INFO]: 	index_param: efSearch=230
2025-03-09 06:55:56,089 [INFO]: 	index_path: knn.index
2025-03-09 06:55:56,089 [INFO]: 	size in bytes: 482218930
2025-03-09 06:55:56,089 [INFO]: 	avg_search_speed_ms: 12.170576471767395
2025-03-09 06:55:56,089 [INFO]: 	99p_search_speed_ms: 19.91266537690534
2025-03-09 06:55:56,089 [INFO]: 	reconstruction error %: 0.0
2025-03-09 06:55:56,089 [INFO]: 	nb vectors: 2451
2025-03-09 06:55:56,089 [INFO]: 	vectors dimension: 49152
2025-03-09 06:55:56,089 [INFO]: 	compression ratio: 0.999310018791672
2025-03-09 06:55:56,089 [INFO]: }
2025-03-09 06:55:56,089 [INFO]: 	>>> Finished "Creating the index" in 47.1439 secs
2025-03-09 06:55:56,089 [INFO]: >>> Finished "Launching the whole pipeline" in 47.1740 secs
2025-03-09 06:55:56: [retrieval_preprocessing] calculating distances ...
2025-03-09 06:55:57: [retrieval_preprocessing] finished and saved retrieval indices for episode 5678 [episode count 10/20]
[retrieval_preprocessing] for episode 6706 [episode count 11/20], we have num_retrieval=np.int64(2465) num_query=np.int64(129)
2025-03-09 06:55:58,386 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-09 06:55:58,748 [INFO]: Launching the whole pipeline 03/09/2025, 06:55:58
2025-03-09 06:55:58,748 [INFO]: Reading total number of vectors and dimension 03/09/2025, 06:55:58
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1318.55it/s]
2025-03-09 06:55:58,775 [INFO]: There are 2465 embeddings of dim 49152
2025-03-09 06:55:58,775 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0269 secs
2025-03-09 06:55:58,775 [INFO]: 	Compute estimated construction time of the index 03/09/2025, 06:55:58
2025-03-09 06:55:58,775 [INFO]: 		-> Train: 16.7 minutes
2025-03-09 06:55:58,775 [INFO]: 		-> Add: 1.4 seconds
2025-03-09 06:55:58,775 [INFO]: 		Total: 16.7 minutes
2025-03-09 06:55:58,775 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0001 secs
2025-03-09 06:55:58,776 [INFO]: 	Checking that your have enough memory available to create the index 03/09/2025, 06:55:58
2025-03-09 06:55:58,776 [INFO]: 508.7MB of memory will be needed to build the index (more might be used if you have more)
2025-03-09 06:55:58,776 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0002 secs
2025-03-09 06:55:58,776 [INFO]: 	Selecting most promising index types given data characteristics 03/09/2025, 06:55:58
2025-03-09 06:55:58,776 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-09 06:55:58,776 [INFO]: 	Creating the index 03/09/2025, 06:55:58
2025-03-09 06:55:58,776 [INFO]: 		-> Instanciate the index HNSW15 03/09/2025, 06:55:58
2025-03-09 06:55:58,777 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0010 secs
2025-03-09 06:55:58,777 [INFO]: 		-> Adding the vectors to the index 03/09/2025, 06:55:58
2025-03-09 06:55:58,777 [INFO]: The memory available for adding the vectors is 49.5GB(total available - used by the index)
2025-03-09 06:55:58,777 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/10 [00:00<?, ?it/s] 10%|█         | 1/10 [00:00<00:02,  3.29it/s] 20%|██        | 2/10 [00:00<00:01,  4.99it/s] 30%|███       | 3/10 [00:00<00:01,  5.95it/s] 40%|████      | 4/10 [00:00<00:00,  6.56it/s] 50%|█████     | 5/10 [00:00<00:00,  7.07it/s] 60%|██████    | 6/10 [00:00<00:00,  7.29it/s] 70%|███████   | 7/10 [00:01<00:00,  7.64it/s] 80%|████████  | 8/10 [00:01<00:00,  7.92it/s] 90%|█████████ | 9/10 [00:01<00:00,  8.35it/s]100%|██████████| 10/10 [00:02<00:00,  1.64it/s]100%|██████████| 10/10 [00:02<00:00,  3.35it/s]
2025-03-09 06:56:01,766 [INFO]: 	Computing best hyperparameters for index knn.index 03/09/2025, 06:56:01
2025-03-09 06:56:29,963 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 28.1973 secs
2025-03-09 06:56:29,964 [INFO]: The best hyperparameters are: efSearch=251
2025-03-09 06:56:29,964 [INFO]: 	Compute fast metrics 03/09/2025, 06:56:29
  0%|          | 0/4 [00:00<?, ?it/s] 25%|██▌       | 1/4 [00:00<00:00,  5.38it/s] 75%|███████▌  | 3/4 [00:00<00:00,  8.28it/s] 75%|███████▌  | 3/4 [00:00<00:00,  6.34it/s]
2025-03-09 06:56:43,932 [INFO]: 	>>> Finished "Compute fast metrics" in 13.9675 secs
2025-03-09 06:56:43,934 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 45.1568 secs
2025-03-09 06:56:43,934 [INFO]: {
2025-03-09 06:56:43,934 [INFO]: 	index_key: HNSW15
2025-03-09 06:56:43,934 [INFO]: 	index_param: efSearch=251
2025-03-09 06:56:43,934 [INFO]: 	index_path: knn.index
2025-03-09 06:56:43,934 [INFO]: 	size in bytes: 484973350
2025-03-09 06:56:43,934 [INFO]: 	avg_search_speed_ms: 14.009735177542378
2025-03-09 06:56:43,934 [INFO]: 	99p_search_speed_ms: 36.20448240078987
2025-03-09 06:56:43,934 [INFO]: 	reconstruction error %: 0.0
2025-03-09 06:56:43,934 [INFO]: 	nb vectors: 2465
2025-03-09 06:56:43,934 [INFO]: 	vectors dimension: 49152
2025-03-09 06:56:43,934 [INFO]: 	compression ratio: 0.999310003322863
2025-03-09 06:56:43,934 [INFO]: }
2025-03-09 06:56:43,934 [INFO]: 	>>> Finished "Creating the index" in 45.1585 secs
2025-03-09 06:56:43,934 [INFO]: >>> Finished "Launching the whole pipeline" in 45.1861 secs
2025-03-09 06:56:44: [retrieval_preprocessing] calculating distances ...
2025-03-09 06:56:45: [retrieval_preprocessing] finished and saved retrieval indices for episode 6706 [episode count 11/20]
[retrieval_preprocessing] for episode 9267 [episode count 12/20], we have num_retrieval=np.int64(2467) num_query=np.int64(127)
2025-03-09 06:56:46,399 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-09 06:56:46,801 [INFO]: Launching the whole pipeline 03/09/2025, 06:56:46
2025-03-09 06:56:46,801 [INFO]: Reading total number of vectors and dimension 03/09/2025, 06:56:46
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1260.31it/s]
2025-03-09 06:56:46,827 [INFO]: There are 2467 embeddings of dim 49152
2025-03-09 06:56:46,827 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0259 secs
2025-03-09 06:56:46,827 [INFO]: 	Compute estimated construction time of the index 03/09/2025, 06:56:46
2025-03-09 06:56:46,827 [INFO]: 		-> Train: 16.7 minutes
2025-03-09 06:56:46,827 [INFO]: 		-> Add: 1.4 seconds
2025-03-09 06:56:46,827 [INFO]: 		Total: 16.7 minutes
2025-03-09 06:56:46,827 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0001 secs
2025-03-09 06:56:46,827 [INFO]: 	Checking that your have enough memory available to create the index 03/09/2025, 06:56:46
2025-03-09 06:56:46,827 [INFO]: 509.1MB of memory will be needed to build the index (more might be used if you have more)
2025-03-09 06:56:46,827 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0001 secs
2025-03-09 06:56:46,827 [INFO]: 	Selecting most promising index types given data characteristics 03/09/2025, 06:56:46
2025-03-09 06:56:46,827 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-09 06:56:46,828 [INFO]: 	Creating the index 03/09/2025, 06:56:46
2025-03-09 06:56:46,828 [INFO]: 		-> Instanciate the index HNSW15 03/09/2025, 06:56:46
2025-03-09 06:56:46,828 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0008 secs
2025-03-09 06:56:46,829 [INFO]: 		-> Adding the vectors to the index 03/09/2025, 06:56:46
2025-03-09 06:56:46,829 [INFO]: The memory available for adding the vectors is 49.5GB(total available - used by the index)
2025-03-09 06:56:46,829 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/10 [00:00<?, ?it/s] 10%|█         | 1/10 [00:00<00:01,  5.20it/s] 20%|██        | 2/10 [00:00<00:01,  6.56it/s] 30%|███       | 3/10 [00:00<00:00,  7.12it/s] 40%|████      | 4/10 [00:00<00:00,  7.31it/s] 50%|█████     | 5/10 [00:00<00:00,  7.29it/s] 60%|██████    | 6/10 [00:00<00:00,  7.17it/s] 70%|███████   | 7/10 [00:00<00:00,  7.18it/s] 90%|█████████ | 9/10 [00:01<00:00,  8.66it/s]100%|██████████| 10/10 [00:02<00:00,  1.87it/s]100%|██████████| 10/10 [00:02<00:00,  3.42it/s]
2025-03-09 06:56:49,763 [INFO]: 	Computing best hyperparameters for index knn.index 03/09/2025, 06:56:49
2025-03-09 06:57:20,389 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 30.6265 secs
2025-03-09 06:57:20,390 [INFO]: The best hyperparameters are: efSearch=234
2025-03-09 06:57:20,390 [INFO]: 	Compute fast metrics 03/09/2025, 06:57:20
  0%|          | 0/4 [00:00<?, ?it/s] 25%|██▌       | 1/4 [00:00<00:00,  6.87it/s] 75%|███████▌  | 3/4 [00:00<00:00, 11.00it/s] 75%|███████▌  | 3/4 [00:00<00:00,  8.30it/s]
2025-03-09 06:57:33,344 [INFO]: 	>>> Finished "Compute fast metrics" in 12.9539 secs
2025-03-09 06:57:33,346 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 46.5171 secs
2025-03-09 06:57:33,346 [INFO]: {
2025-03-09 06:57:33,346 [INFO]: 	index_key: HNSW15
2025-03-09 06:57:33,346 [INFO]: 	index_param: efSearch=234
2025-03-09 06:57:33,346 [INFO]: 	index_path: knn.index
2025-03-09 06:57:33,346 [INFO]: 	size in bytes: 485366830
2025-03-09 06:57:33,346 [INFO]: 	avg_search_speed_ms: 9.914958992385932
2025-03-09 06:57:33,346 [INFO]: 	99p_search_speed_ms: 16.533400621265173
2025-03-09 06:57:33,346 [INFO]: 	reconstruction error %: 0.0
2025-03-09 06:57:33,346 [INFO]: 	nb vectors: 2467
2025-03-09 06:57:33,346 [INFO]: 	vectors dimension: 49152
2025-03-09 06:57:33,346 [INFO]: 	compression ratio: 0.9993100187748718
2025-03-09 06:57:33,346 [INFO]: }
2025-03-09 06:57:33,346 [INFO]: 	>>> Finished "Creating the index" in 46.5186 secs
2025-03-09 06:57:33,346 [INFO]: >>> Finished "Launching the whole pipeline" in 46.5453 secs
2025-03-09 06:57:34: [retrieval_preprocessing] calculating distances ...
2025-03-09 06:57:34: [retrieval_preprocessing] finished and saved retrieval indices for episode 9267 [episode count 12/20]
[retrieval_preprocessing] for episode 73271 [episode count 13/20], we have num_retrieval=np.int64(2469) num_query=np.int64(125)
2025-03-09 06:57:35,666 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-09 06:57:36,005 [INFO]: Launching the whole pipeline 03/09/2025, 06:57:36
2025-03-09 06:57:36,005 [INFO]: Reading total number of vectors and dimension 03/09/2025, 06:57:36
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1278.36it/s]
2025-03-09 06:57:36,033 [INFO]: There are 2469 embeddings of dim 49152
2025-03-09 06:57:36,033 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0279 secs
2025-03-09 06:57:36,034 [INFO]: 	Compute estimated construction time of the index 03/09/2025, 06:57:36
2025-03-09 06:57:36,034 [INFO]: 		-> Train: 16.7 minutes
2025-03-09 06:57:36,034 [INFO]: 		-> Add: 1.4 seconds
2025-03-09 06:57:36,034 [INFO]: 		Total: 16.7 minutes
2025-03-09 06:57:36,034 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0004 secs
2025-03-09 06:57:36,034 [INFO]: 	Checking that your have enough memory available to create the index 03/09/2025, 06:57:36
2025-03-09 06:57:36,035 [INFO]: 509.5MB of memory will be needed to build the index (more might be used if you have more)
2025-03-09 06:57:36,035 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0005 secs
2025-03-09 06:57:36,035 [INFO]: 	Selecting most promising index types given data characteristics 03/09/2025, 06:57:36
2025-03-09 06:57:36,035 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-09 06:57:36,035 [INFO]: 	Creating the index 03/09/2025, 06:57:36
2025-03-09 06:57:36,035 [INFO]: 		-> Instanciate the index HNSW15 03/09/2025, 06:57:36
2025-03-09 06:57:36,038 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0026 secs
2025-03-09 06:57:36,038 [INFO]: 		-> Adding the vectors to the index 03/09/2025, 06:57:36
2025-03-09 06:57:36,038 [INFO]: The memory available for adding the vectors is 49.5GB(total available - used by the index)
2025-03-09 06:57:36,039 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/10 [00:00<?, ?it/s] 10%|█         | 1/10 [00:00<00:01,  5.32it/s] 20%|██        | 2/10 [00:00<00:01,  6.83it/s] 30%|███       | 3/10 [00:00<00:00,  7.64it/s] 40%|████      | 4/10 [00:00<00:00,  7.91it/s] 50%|█████     | 5/10 [00:00<00:00,  8.10it/s] 60%|██████    | 6/10 [00:00<00:00,  8.23it/s] 70%|███████   | 7/10 [00:00<00:00,  8.32it/s] 80%|████████  | 8/10 [00:01<00:00,  8.30it/s] 90%|█████████ | 9/10 [00:01<00:00,  8.42it/s]100%|██████████| 10/10 [00:02<00:00,  1.59it/s]100%|██████████| 10/10 [00:02<00:00,  3.45it/s]
2025-03-09 06:57:38,944 [INFO]: 	Computing best hyperparameters for index knn.index 03/09/2025, 06:57:38
2025-03-09 06:58:09,938 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 30.9941 secs
2025-03-09 06:58:09,939 [INFO]: The best hyperparameters are: efSearch=203
2025-03-09 06:58:09,939 [INFO]: 	Compute fast metrics 03/09/2025, 06:58:09
  0%|          | 0/4 [00:00<?, ?it/s] 25%|██▌       | 1/4 [00:00<00:00,  8.25it/s] 75%|███████▌  | 3/4 [00:00<00:00, 15.89it/s]
2025-03-09 06:58:22,061 [INFO]: 	>>> Finished "Compute fast metrics" in 12.1221 secs
2025-03-09 06:58:22,063 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 46.0246 secs
2025-03-09 06:58:22,063 [INFO]: {
2025-03-09 06:58:22,063 [INFO]: 	index_key: HNSW15
2025-03-09 06:58:22,063 [INFO]: 	index_param: efSearch=203
2025-03-09 06:58:22,063 [INFO]: 	index_path: knn.index
2025-03-09 06:58:22,063 [INFO]: 	size in bytes: 485760310
2025-03-09 06:58:22,063 [INFO]: 	avg_search_speed_ms: 8.199274582505899
2025-03-09 06:58:22,063 [INFO]: 	99p_search_speed_ms: 11.471674691420029
2025-03-09 06:58:22,063 [INFO]: 	reconstruction error %: 0.0
2025-03-09 06:58:22,063 [INFO]: 	nb vectors: 2469
2025-03-09 06:58:22,063 [INFO]: 	vectors dimension: 49152
2025-03-09 06:58:22,063 [INFO]: 	compression ratio: 0.9993100342018474
2025-03-09 06:58:22,063 [INFO]: }
2025-03-09 06:58:22,063 [INFO]: 	>>> Finished "Creating the index" in 46.0279 secs
2025-03-09 06:58:22,063 [INFO]: >>> Finished "Launching the whole pipeline" in 46.0578 secs
2025-03-09 06:58:22: [retrieval_preprocessing] calculating distances ...
2025-03-09 06:58:23: [retrieval_preprocessing] finished and saved retrieval indices for episode 73271 [episode count 13/20]
[retrieval_preprocessing] for episode 55864 [episode count 14/20], we have num_retrieval=np.int64(2465) num_query=np.int64(129)
2025-03-09 06:58:23,828 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-09 06:58:24,192 [INFO]: Launching the whole pipeline 03/09/2025, 06:58:24
2025-03-09 06:58:24,192 [INFO]: Reading total number of vectors and dimension 03/09/2025, 06:58:24
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1058.90it/s]
2025-03-09 06:58:24,225 [INFO]: There are 2465 embeddings of dim 49152
2025-03-09 06:58:24,226 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0339 secs
2025-03-09 06:58:24,226 [INFO]: 	Compute estimated construction time of the index 03/09/2025, 06:58:24
2025-03-09 06:58:24,226 [INFO]: 		-> Train: 16.7 minutes
2025-03-09 06:58:24,226 [INFO]: 		-> Add: 1.4 seconds
2025-03-09 06:58:24,226 [INFO]: 		Total: 16.7 minutes
2025-03-09 06:58:24,226 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0002 secs
2025-03-09 06:58:24,226 [INFO]: 	Checking that your have enough memory available to create the index 03/09/2025, 06:58:24
2025-03-09 06:58:24,226 [INFO]: 508.7MB of memory will be needed to build the index (more might be used if you have more)
2025-03-09 06:58:24,227 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0004 secs
2025-03-09 06:58:24,227 [INFO]: 	Selecting most promising index types given data characteristics 03/09/2025, 06:58:24
2025-03-09 06:58:24,227 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-09 06:58:24,227 [INFO]: 	Creating the index 03/09/2025, 06:58:24
2025-03-09 06:58:24,227 [INFO]: 		-> Instanciate the index HNSW15 03/09/2025, 06:58:24
2025-03-09 06:58:24,229 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0022 secs
2025-03-09 06:58:24,230 [INFO]: 		-> Adding the vectors to the index 03/09/2025, 06:58:24
2025-03-09 06:58:24,230 [INFO]: The memory available for adding the vectors is 49.5GB(total available - used by the index)
2025-03-09 06:58:24,230 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/10 [00:00<?, ?it/s] 10%|█         | 1/10 [00:00<00:01,  5.50it/s] 30%|███       | 3/10 [00:00<00:00,  8.78it/s] 50%|█████     | 5/10 [00:00<00:00, 10.03it/s] 70%|███████   | 7/10 [00:00<00:00, 10.58it/s] 90%|█████████ | 9/10 [00:00<00:00, 10.93it/s]100%|██████████| 10/10 [00:02<00:00,  4.10it/s]
2025-03-09 06:58:26,679 [INFO]: 	Computing best hyperparameters for index knn.index 03/09/2025, 06:58:26
2025-03-09 06:58:55,821 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 29.1411 secs
2025-03-09 06:58:55,821 [INFO]: The best hyperparameters are: efSearch=233
2025-03-09 06:58:55,821 [INFO]: 	Compute fast metrics 03/09/2025, 06:58:55
  0%|          | 0/4 [00:00<?, ?it/s] 25%|██▌       | 1/4 [00:00<00:00,  6.49it/s] 75%|███████▌  | 3/4 [00:00<00:00, 11.56it/s] 75%|███████▌  | 3/4 [00:00<00:00,  8.91it/s]
2025-03-09 06:59:09,794 [INFO]: 	>>> Finished "Compute fast metrics" in 13.9731 secs
2025-03-09 06:59:09,796 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 45.5661 secs
2025-03-09 06:59:09,796 [INFO]: {
2025-03-09 06:59:09,796 [INFO]: 	index_key: HNSW15
2025-03-09 06:59:09,796 [INFO]: 	index_param: efSearch=233
2025-03-09 06:59:09,796 [INFO]: 	index_path: knn.index
2025-03-09 06:59:09,796 [INFO]: 	size in bytes: 484973350
2025-03-09 06:59:09,796 [INFO]: 	avg_search_speed_ms: 9.28296326134724
2025-03-09 06:59:09,796 [INFO]: 	99p_search_speed_ms: 12.097467379644513
2025-03-09 06:59:09,796 [INFO]: 	reconstruction error %: 0.0
2025-03-09 06:59:09,796 [INFO]: 	nb vectors: 2465
2025-03-09 06:59:09,796 [INFO]: 	vectors dimension: 49152
2025-03-09 06:59:09,796 [INFO]: 	compression ratio: 0.999310003322863
2025-03-09 06:59:09,796 [INFO]: }
2025-03-09 06:59:09,796 [INFO]: 	>>> Finished "Creating the index" in 45.5691 secs
2025-03-09 06:59:09,796 [INFO]: >>> Finished "Launching the whole pipeline" in 45.6045 secs
2025-03-09 06:59:10: [retrieval_preprocessing] calculating distances ...
2025-03-09 06:59:11: [retrieval_preprocessing] finished and saved retrieval indices for episode 55864 [episode count 14/20]
[retrieval_preprocessing] for episode 78393 [episode count 15/20], we have num_retrieval=np.int64(2459) num_query=np.int64(135)
2025-03-09 06:59:11,959 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-09 06:59:12,370 [INFO]: Launching the whole pipeline 03/09/2025, 06:59:12
2025-03-09 06:59:12,370 [INFO]: Reading total number of vectors and dimension 03/09/2025, 06:59:12
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1494.23it/s]
2025-03-09 06:59:12,399 [INFO]: There are 2459 embeddings of dim 49152
2025-03-09 06:59:12,399 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0295 secs
2025-03-09 06:59:12,399 [INFO]: 	Compute estimated construction time of the index 03/09/2025, 06:59:12
2025-03-09 06:59:12,399 [INFO]: 		-> Train: 16.7 minutes
2025-03-09 06:59:12,399 [INFO]: 		-> Add: 1.4 seconds
2025-03-09 06:59:12,399 [INFO]: 		Total: 16.7 minutes
2025-03-09 06:59:12,399 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0001 secs
2025-03-09 06:59:12,399 [INFO]: 	Checking that your have enough memory available to create the index 03/09/2025, 06:59:12
2025-03-09 06:59:12,400 [INFO]: 507.5MB of memory will be needed to build the index (more might be used if you have more)
2025-03-09 06:59:12,400 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0001 secs
2025-03-09 06:59:12,400 [INFO]: 	Selecting most promising index types given data characteristics 03/09/2025, 06:59:12
2025-03-09 06:59:12,400 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-09 06:59:12,400 [INFO]: 	Creating the index 03/09/2025, 06:59:12
2025-03-09 06:59:12,400 [INFO]: 		-> Instanciate the index HNSW15 03/09/2025, 06:59:12
2025-03-09 06:59:12,401 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0009 secs
2025-03-09 06:59:12,401 [INFO]: 		-> Adding the vectors to the index 03/09/2025, 06:59:12
2025-03-09 06:59:12,401 [INFO]: The memory available for adding the vectors is 49.5GB(total available - used by the index)
2025-03-09 06:59:12,401 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/10 [00:00<?, ?it/s] 10%|█         | 1/10 [00:00<00:01,  5.73it/s] 30%|███       | 3/10 [00:00<00:00, 11.22it/s] 50%|█████     | 5/10 [00:00<00:00, 12.52it/s] 70%|███████   | 7/10 [00:00<00:00, 12.32it/s] 90%|█████████ | 9/10 [00:00<00:00, 12.12it/s]100%|██████████| 10/10 [00:02<00:00,  4.09it/s]
2025-03-09 06:59:14,850 [INFO]: 	Computing best hyperparameters for index knn.index 03/09/2025, 06:59:14
2025-03-09 06:59:44,725 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 29.8746 secs
2025-03-09 06:59:44,725 [INFO]: The best hyperparameters are: efSearch=256
2025-03-09 06:59:44,726 [INFO]: 	Compute fast metrics 03/09/2025, 06:59:44
  0%|          | 0/4 [00:00<?, ?it/s] 25%|██▌       | 1/4 [00:00<00:00,  4.80it/s] 50%|█████     | 2/4 [00:00<00:00,  6.28it/s] 75%|███████▌  | 3/4 [00:00<00:00,  6.98it/s] 75%|███████▌  | 3/4 [00:00<00:00,  5.26it/s]
2025-03-09 06:59:57,203 [INFO]: 	>>> Finished "Compute fast metrics" in 12.4774 secs
2025-03-09 06:59:57,205 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 44.8041 secs
2025-03-09 06:59:57,205 [INFO]: {
2025-03-09 06:59:57,205 [INFO]: 	index_key: HNSW15
2025-03-09 06:59:57,205 [INFO]: 	index_param: efSearch=256
2025-03-09 06:59:57,205 [INFO]: 	index_path: knn.index
2025-03-09 06:59:57,205 [INFO]: 	size in bytes: 483792910
2025-03-09 06:59:57,205 [INFO]: 	avg_search_speed_ms: 10.419678678590572
2025-03-09 06:59:57,205 [INFO]: 	99p_search_speed_ms: 14.83804018003866
2025-03-09 06:59:57,205 [INFO]: 	reconstruction error %: 0.0
2025-03-09 06:59:57,205 [INFO]: 	nb vectors: 2459
2025-03-09 06:59:57,205 [INFO]: 	vectors dimension: 49152
2025-03-09 06:59:57,205 [INFO]: 	compression ratio: 0.999309956816027
2025-03-09 06:59:57,205 [INFO]: }
2025-03-09 06:59:57,205 [INFO]: 	>>> Finished "Creating the index" in 44.8055 secs
2025-03-09 06:59:57,205 [INFO]: >>> Finished "Launching the whole pipeline" in 44.8355 secs
2025-03-09 06:59:58: [retrieval_preprocessing] calculating distances ...
2025-03-09 06:59:58: [retrieval_preprocessing] finished and saved retrieval indices for episode 78393 [episode count 15/20]
[retrieval_preprocessing] for episode 8776 [episode count 16/20], we have num_retrieval=np.int64(2477) num_query=np.int64(117)
2025-03-09 06:59:59,308 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-09 06:59:59,642 [INFO]: Launching the whole pipeline 03/09/2025, 06:59:59
2025-03-09 06:59:59,643 [INFO]: Reading total number of vectors and dimension 03/09/2025, 06:59:59
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1514.74it/s]
2025-03-09 06:59:59,667 [INFO]: There are 2477 embeddings of dim 49152
2025-03-09 06:59:59,668 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0250 secs
2025-03-09 06:59:59,668 [INFO]: 	Compute estimated construction time of the index 03/09/2025, 06:59:59
2025-03-09 06:59:59,668 [INFO]: 		-> Train: 16.7 minutes
2025-03-09 06:59:59,668 [INFO]: 		-> Add: 1.4 seconds
2025-03-09 06:59:59,668 [INFO]: 		Total: 16.7 minutes
2025-03-09 06:59:59,668 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0001 secs
2025-03-09 06:59:59,668 [INFO]: 	Checking that your have enough memory available to create the index 03/09/2025, 06:59:59
2025-03-09 06:59:59,668 [INFO]: 511.2MB of memory will be needed to build the index (more might be used if you have more)
2025-03-09 06:59:59,668 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0001 secs
2025-03-09 06:59:59,668 [INFO]: 	Selecting most promising index types given data characteristics 03/09/2025, 06:59:59
2025-03-09 06:59:59,668 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-09 06:59:59,668 [INFO]: 	Creating the index 03/09/2025, 06:59:59
2025-03-09 06:59:59,668 [INFO]: 		-> Instanciate the index HNSW15 03/09/2025, 06:59:59
2025-03-09 06:59:59,669 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0008 secs
2025-03-09 06:59:59,669 [INFO]: 		-> Adding the vectors to the index 03/09/2025, 06:59:59
2025-03-09 06:59:59,669 [INFO]: The memory available for adding the vectors is 49.5GB(total available - used by the index)
2025-03-09 06:59:59,669 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/10 [00:00<?, ?it/s] 10%|█         | 1/10 [00:00<00:01,  7.69it/s] 30%|███       | 3/10 [00:00<00:00, 11.89it/s] 50%|█████     | 5/10 [00:00<00:00, 11.97it/s] 70%|███████   | 7/10 [00:00<00:00, 11.78it/s] 90%|█████████ | 9/10 [00:00<00:00, 11.46it/s]100%|██████████| 10/10 [00:02<00:00,  4.30it/s]
2025-03-09 07:00:02,004 [INFO]: 	Computing best hyperparameters for index knn.index 03/09/2025, 07:00:02
2025-03-09 07:00:29,451 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 27.4463 secs
2025-03-09 07:00:29,451 [INFO]: The best hyperparameters are: efSearch=205
2025-03-09 07:00:29,451 [INFO]: 	Compute fast metrics 03/09/2025, 07:00:29
  0%|          | 0/4 [00:00<?, ?it/s] 25%|██▌       | 1/4 [00:00<00:00,  4.71it/s] 75%|███████▌  | 3/4 [00:00<00:00,  9.35it/s] 75%|███████▌  | 3/4 [00:00<00:00,  7.29it/s]
2025-03-09 07:00:41,845 [INFO]: 	>>> Finished "Compute fast metrics" in 12.3936 secs
2025-03-09 07:00:41,847 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 42.1779 secs
2025-03-09 07:00:41,847 [INFO]: {
2025-03-09 07:00:41,847 [INFO]: 	index_key: HNSW15
2025-03-09 07:00:41,847 [INFO]: 	index_param: efSearch=205
2025-03-09 07:00:41,847 [INFO]: 	index_path: knn.index
2025-03-09 07:00:41,847 [INFO]: 	size in bytes: 487334230
2025-03-09 07:00:41,847 [INFO]: 	avg_search_speed_ms: 8.504476364374122
2025-03-09 07:00:41,847 [INFO]: 	99p_search_speed_ms: 15.44900517910719
2025-03-09 07:00:41,847 [INFO]: 	reconstruction error %: 0.0
2025-03-09 07:00:41,847 [INFO]: 	nb vectors: 2477
2025-03-09 07:00:41,847 [INFO]: 	vectors dimension: 49152
2025-03-09 07:00:41,847 [INFO]: 	compression ratio: 0.9993100956606311
2025-03-09 07:00:41,847 [INFO]: }
2025-03-09 07:00:41,847 [INFO]: 	>>> Finished "Creating the index" in 42.1792 secs
2025-03-09 07:00:41,847 [INFO]: >>> Finished "Launching the whole pipeline" in 42.2047 secs
2025-03-09 07:00:42: [retrieval_preprocessing] calculating distances ...
2025-03-09 07:00:42: [retrieval_preprocessing] finished and saved retrieval indices for episode 8776 [episode count 16/20]
[retrieval_preprocessing] for episode 51786 [episode count 17/20], we have num_retrieval=np.int64(2464) num_query=np.int64(130)
2025-03-09 07:00:43,758 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-09 07:00:44,136 [INFO]: Launching the whole pipeline 03/09/2025, 07:00:44
2025-03-09 07:00:44,136 [INFO]: Reading total number of vectors and dimension 03/09/2025, 07:00:44
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1694.67it/s]
2025-03-09 07:00:44,163 [INFO]: There are 2464 embeddings of dim 49152
2025-03-09 07:00:44,163 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0276 secs
2025-03-09 07:00:44,164 [INFO]: 	Compute estimated construction time of the index 03/09/2025, 07:00:44
2025-03-09 07:00:44,164 [INFO]: 		-> Train: 16.7 minutes
2025-03-09 07:00:44,164 [INFO]: 		-> Add: 1.4 seconds
2025-03-09 07:00:44,164 [INFO]: 		Total: 16.7 minutes
2025-03-09 07:00:44,164 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0005 secs
2025-03-09 07:00:44,165 [INFO]: 	Checking that your have enough memory available to create the index 03/09/2025, 07:00:44
2025-03-09 07:00:44,165 [INFO]: 508.5MB of memory will be needed to build the index (more might be used if you have more)
2025-03-09 07:00:44,165 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0005 secs
2025-03-09 07:00:44,165 [INFO]: 	Selecting most promising index types given data characteristics 03/09/2025, 07:00:44
2025-03-09 07:00:44,166 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-09 07:00:44,166 [INFO]: 	Creating the index 03/09/2025, 07:00:44
2025-03-09 07:00:44,166 [INFO]: 		-> Instanciate the index HNSW15 03/09/2025, 07:00:44
2025-03-09 07:00:44,168 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0025 secs
2025-03-09 07:00:44,169 [INFO]: 		-> Adding the vectors to the index 03/09/2025, 07:00:44
2025-03-09 07:00:44,169 [INFO]: The memory available for adding the vectors is 49.5GB(total available - used by the index)
2025-03-09 07:00:44,169 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/10 [00:00<?, ?it/s] 10%|█         | 1/10 [00:00<00:01,  8.10it/s] 30%|███       | 3/10 [00:00<00:00, 12.05it/s] 50%|█████     | 5/10 [00:00<00:00, 13.74it/s] 70%|███████   | 7/10 [00:00<00:00, 12.65it/s] 90%|█████████ | 9/10 [00:00<00:00, 11.75it/s]100%|██████████| 10/10 [00:02<00:00,  3.84it/s]
2025-03-09 07:00:46,779 [INFO]: 	Computing best hyperparameters for index knn.index 03/09/2025, 07:00:46
2025-03-09 07:01:15,089 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 28.3098 secs
2025-03-09 07:01:15,089 [INFO]: The best hyperparameters are: efSearch=187
2025-03-09 07:01:15,089 [INFO]: 	Compute fast metrics 03/09/2025, 07:01:15
  0%|          | 0/4 [00:00<?, ?it/s] 25%|██▌       | 1/4 [00:00<00:00,  5.70it/s] 75%|███████▌  | 3/4 [00:00<00:00,  9.17it/s] 75%|███████▌  | 3/4 [00:00<00:00,  7.01it/s]
2025-03-09 07:01:28,425 [INFO]: 	>>> Finished "Compute fast metrics" in 13.3356 secs
2025-03-09 07:01:28,427 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 44.2581 secs
2025-03-09 07:01:28,427 [INFO]: {
2025-03-09 07:01:28,427 [INFO]: 	index_key: HNSW15
2025-03-09 07:01:28,427 [INFO]: 	index_param: efSearch=187
2025-03-09 07:01:28,427 [INFO]: 	index_path: knn.index
2025-03-09 07:01:28,427 [INFO]: 	size in bytes: 484776610
2025-03-09 07:01:28,427 [INFO]: 	avg_search_speed_ms: 8.116576868614375
2025-03-09 07:01:28,427 [INFO]: 	99p_search_speed_ms: 13.19310112157837
2025-03-09 07:01:28,427 [INFO]: 	reconstruction error %: 0.0
2025-03-09 07:01:28,427 [INFO]: 	nb vectors: 2464
2025-03-09 07:01:28,427 [INFO]: 	vectors dimension: 49152
2025-03-09 07:01:28,427 [INFO]: 	compression ratio: 0.9993099955874521
2025-03-09 07:01:28,427 [INFO]: }
2025-03-09 07:01:28,427 [INFO]: 	>>> Finished "Creating the index" in 44.2616 secs
2025-03-09 07:01:28,427 [INFO]: >>> Finished "Launching the whole pipeline" in 44.2914 secs
2025-03-09 07:01:28: [retrieval_preprocessing] calculating distances ...
2025-03-09 07:01:29: [retrieval_preprocessing] finished and saved retrieval indices for episode 51786 [episode count 17/20]
[retrieval_preprocessing] for episode 63570 [episode count 18/20], we have num_retrieval=np.int64(2466) num_query=np.int64(128)
2025-03-09 07:01:30,127 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-09 07:01:30,505 [INFO]: Launching the whole pipeline 03/09/2025, 07:01:30
2025-03-09 07:01:30,505 [INFO]: Reading total number of vectors and dimension 03/09/2025, 07:01:30
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1318.13it/s]
2025-03-09 07:01:30,534 [INFO]: There are 2466 embeddings of dim 49152
2025-03-09 07:01:30,535 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0299 secs
2025-03-09 07:01:30,535 [INFO]: 	Compute estimated construction time of the index 03/09/2025, 07:01:30
2025-03-09 07:01:30,535 [INFO]: 		-> Train: 16.7 minutes
2025-03-09 07:01:30,535 [INFO]: 		-> Add: 1.4 seconds
2025-03-09 07:01:30,535 [INFO]: 		Total: 16.7 minutes
2025-03-09 07:01:30,535 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0003 secs
2025-03-09 07:01:30,535 [INFO]: 	Checking that your have enough memory available to create the index 03/09/2025, 07:01:30
2025-03-09 07:01:30,536 [INFO]: 508.9MB of memory will be needed to build the index (more might be used if you have more)
2025-03-09 07:01:30,536 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0004 secs
2025-03-09 07:01:30,536 [INFO]: 	Selecting most promising index types given data characteristics 03/09/2025, 07:01:30
2025-03-09 07:01:30,536 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-09 07:01:30,536 [INFO]: 	Creating the index 03/09/2025, 07:01:30
2025-03-09 07:01:30,536 [INFO]: 		-> Instanciate the index HNSW15 03/09/2025, 07:01:30
2025-03-09 07:01:30,539 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0025 secs
2025-03-09 07:01:30,539 [INFO]: 		-> Adding the vectors to the index 03/09/2025, 07:01:30
2025-03-09 07:01:30,539 [INFO]: The memory available for adding the vectors is 49.5GB(total available - used by the index)
2025-03-09 07:01:30,539 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/10 [00:00<?, ?it/s] 10%|█         | 1/10 [00:00<00:01,  6.08it/s] 30%|███       | 3/10 [00:00<00:00,  9.35it/s] 50%|█████     | 5/10 [00:00<00:00, 10.41it/s] 70%|███████   | 7/10 [00:00<00:00, 10.86it/s] 90%|█████████ | 9/10 [00:00<00:00, 11.09it/s]100%|██████████| 10/10 [00:02<00:00,  3.84it/s]
2025-03-09 07:01:33,151 [INFO]: 	Computing best hyperparameters for index knn.index 03/09/2025, 07:01:33
2025-03-09 07:02:03,033 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 29.8808 secs
2025-03-09 07:02:03,033 [INFO]: The best hyperparameters are: efSearch=238
2025-03-09 07:02:03,033 [INFO]: 	Compute fast metrics 03/09/2025, 07:02:03
  0%|          | 0/4 [00:00<?, ?it/s] 25%|██▌       | 1/4 [00:00<00:00,  6.87it/s] 75%|███████▌  | 3/4 [00:00<00:00, 10.12it/s] 75%|███████▌  | 3/4 [00:00<00:00,  7.77it/s]
2025-03-09 07:02:15,568 [INFO]: 	>>> Finished "Compute fast metrics" in 12.5352 secs
2025-03-09 07:02:15,570 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 45.0309 secs
2025-03-09 07:02:15,570 [INFO]: {
2025-03-09 07:02:15,570 [INFO]: 	index_key: HNSW15
2025-03-09 07:02:15,570 [INFO]: 	index_param: efSearch=238
2025-03-09 07:02:15,570 [INFO]: 	index_path: knn.index
2025-03-09 07:02:15,570 [INFO]: 	size in bytes: 485170090
2025-03-09 07:02:15,570 [INFO]: 	avg_search_speed_ms: 9.7018385395881
2025-03-09 07:02:15,570 [INFO]: 	99p_search_speed_ms: 13.269919087179009
2025-03-09 07:02:15,570 [INFO]: 	reconstruction error %: 0.0
2025-03-09 07:02:15,570 [INFO]: 	nb vectors: 2466
2025-03-09 07:02:15,570 [INFO]: 	vectors dimension: 49152
2025-03-09 07:02:15,570 [INFO]: 	compression ratio: 0.9993100110520003
2025-03-09 07:02:15,570 [INFO]: }
2025-03-09 07:02:15,570 [INFO]: 	>>> Finished "Creating the index" in 45.0341 secs
2025-03-09 07:02:15,570 [INFO]: >>> Finished "Launching the whole pipeline" in 45.0656 secs
2025-03-09 07:02:16: [retrieval_preprocessing] calculating distances ...
2025-03-09 07:02:16: [retrieval_preprocessing] finished and saved retrieval indices for episode 63570 [episode count 18/20]
[retrieval_preprocessing] for episode 51799 [episode count 19/20], we have num_retrieval=np.int64(2477) num_query=np.int64(117)
2025-03-09 07:02:17,549 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-09 07:02:17,847 [INFO]: Launching the whole pipeline 03/09/2025, 07:02:17
2025-03-09 07:02:17,847 [INFO]: Reading total number of vectors and dimension 03/09/2025, 07:02:17
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1759.36it/s]
2025-03-09 07:02:17,871 [INFO]: There are 2477 embeddings of dim 49152
2025-03-09 07:02:17,872 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0241 secs
2025-03-09 07:02:17,872 [INFO]: 	Compute estimated construction time of the index 03/09/2025, 07:02:17
2025-03-09 07:02:17,872 [INFO]: 		-> Train: 16.7 minutes
2025-03-09 07:02:17,872 [INFO]: 		-> Add: 1.4 seconds
2025-03-09 07:02:17,872 [INFO]: 		Total: 16.7 minutes
2025-03-09 07:02:17,872 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0001 secs
2025-03-09 07:02:17,872 [INFO]: 	Checking that your have enough memory available to create the index 03/09/2025, 07:02:17
2025-03-09 07:02:17,872 [INFO]: 511.2MB of memory will be needed to build the index (more might be used if you have more)
2025-03-09 07:02:17,872 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0001 secs
2025-03-09 07:02:17,872 [INFO]: 	Selecting most promising index types given data characteristics 03/09/2025, 07:02:17
2025-03-09 07:02:17,872 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-09 07:02:17,872 [INFO]: 	Creating the index 03/09/2025, 07:02:17
2025-03-09 07:02:17,872 [INFO]: 		-> Instanciate the index HNSW15 03/09/2025, 07:02:17
2025-03-09 07:02:17,873 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0008 secs
2025-03-09 07:02:17,873 [INFO]: 		-> Adding the vectors to the index 03/09/2025, 07:02:17
2025-03-09 07:02:17,873 [INFO]: The memory available for adding the vectors is 49.5GB(total available - used by the index)
2025-03-09 07:02:17,873 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/10 [00:00<?, ?it/s] 10%|█         | 1/10 [00:00<00:01,  5.88it/s] 20%|██        | 2/10 [00:00<00:01,  7.64it/s] 30%|███       | 3/10 [00:00<00:00,  8.46it/s] 40%|████      | 4/10 [00:00<00:00,  8.98it/s] 50%|█████     | 5/10 [00:00<00:00,  9.14it/s] 60%|██████    | 6/10 [00:00<00:00,  9.27it/s] 70%|███████   | 7/10 [00:00<00:00,  9.16it/s] 80%|████████  | 8/10 [00:00<00:00,  8.99it/s] 90%|█████████ | 9/10 [00:01<00:00,  9.03it/s]100%|██████████| 10/10 [00:02<00:00,  1.70it/s]100%|██████████| 10/10 [00:02<00:00,  3.72it/s]
2025-03-09 07:02:20,569 [INFO]: 	Computing best hyperparameters for index knn.index 03/09/2025, 07:02:20
2025-03-09 07:02:51,199 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 30.6298 secs
2025-03-09 07:02:51,199 [INFO]: The best hyperparameters are: efSearch=241
2025-03-09 07:02:51,199 [INFO]: 	Compute fast metrics 03/09/2025, 07:02:51
  0%|          | 0/4 [00:00<?, ?it/s] 25%|██▌       | 1/4 [00:00<00:00,  5.95it/s] 50%|█████     | 2/4 [00:00<00:00,  7.28it/s] 75%|███████▌  | 3/4 [00:00<00:00,  8.07it/s] 75%|███████▌  | 3/4 [00:00<00:00,  5.91it/s]
2025-03-09 07:03:04,971 [INFO]: 	>>> Finished "Compute fast metrics" in 13.7719 secs
2025-03-09 07:03:04,974 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 47.1008 secs
2025-03-09 07:03:04,974 [INFO]: {
2025-03-09 07:03:04,974 [INFO]: 	index_key: HNSW15
2025-03-09 07:03:04,974 [INFO]: 	index_param: efSearch=241
2025-03-09 07:03:04,974 [INFO]: 	index_path: knn.index
2025-03-09 07:03:04,974 [INFO]: 	size in bytes: 487334230
2025-03-09 07:03:04,974 [INFO]: 	avg_search_speed_ms: 9.856939559866642
2025-03-09 07:03:04,974 [INFO]: 	99p_search_speed_ms: 19.71679420210421
2025-03-09 07:03:04,974 [INFO]: 	reconstruction error %: 0.0
2025-03-09 07:03:04,974 [INFO]: 	nb vectors: 2477
2025-03-09 07:03:04,974 [INFO]: 	vectors dimension: 49152
2025-03-09 07:03:04,974 [INFO]: 	compression ratio: 0.9993100956606311
2025-03-09 07:03:04,974 [INFO]: }
2025-03-09 07:03:04,974 [INFO]: 	>>> Finished "Creating the index" in 47.1021 secs
2025-03-09 07:03:04,974 [INFO]: >>> Finished "Launching the whole pipeline" in 47.1267 secs
2025-03-09 07:03:05: [retrieval_preprocessing] calculating distances ...
2025-03-09 07:03:06: [retrieval_preprocessing] finished and saved retrieval indices for episode 51799 [episode count 19/20]
2025-03-09 07:03:06: [retrieval_preprocessing] finished for (9306310171, 'marker') [chosen_id count 0/10]
2025-03-09 07:03:09: [retrieval_preprocessing] concatenated all embeddings and indices for 20 episodes for (3816161570, 'drawer') [chosen_id count 1/10]
2025-03-09 07:03:09: [retrieval_preprocessing] we have num_total=3005 embedding_dim=49152
[retrieval_preprocessing] for episode 81409 [episode count 0/20], we have num_retrieval=np.int64(2741) num_query=np.int64(264)
2025-03-09 07:03:10,586 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-09 07:03:11,094 [INFO]: Launching the whole pipeline 03/09/2025, 07:03:11
2025-03-09 07:03:11,094 [INFO]: Reading total number of vectors and dimension 03/09/2025, 07:03:11
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1161.86it/s]
2025-03-09 07:03:11,122 [INFO]: There are 2741 embeddings of dim 49152
2025-03-09 07:03:11,123 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0289 secs
2025-03-09 07:03:11,123 [INFO]: 	Compute estimated construction time of the index 03/09/2025, 07:03:11
2025-03-09 07:03:11,123 [INFO]: 		-> Train: 16.7 minutes
2025-03-09 07:03:11,123 [INFO]: 		-> Add: 1.5 seconds
2025-03-09 07:03:11,123 [INFO]: 		Total: 16.7 minutes
2025-03-09 07:03:11,123 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0002 secs
2025-03-09 07:03:11,123 [INFO]: 	Checking that your have enough memory available to create the index 03/09/2025, 07:03:11
2025-03-09 07:03:11,123 [INFO]: 565.7MB of memory will be needed to build the index (more might be used if you have more)
2025-03-09 07:03:11,123 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0002 secs
2025-03-09 07:03:11,123 [INFO]: 	Selecting most promising index types given data characteristics 03/09/2025, 07:03:11
2025-03-09 07:03:11,123 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-09 07:03:11,124 [INFO]: 	Creating the index 03/09/2025, 07:03:11
2025-03-09 07:03:11,124 [INFO]: 		-> Instanciate the index HNSW15 03/09/2025, 07:03:11
2025-03-09 07:03:11,125 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0010 secs
2025-03-09 07:03:11,125 [INFO]: 		-> Adding the vectors to the index 03/09/2025, 07:03:11
2025-03-09 07:03:11,125 [INFO]: The memory available for adding the vectors is 49.5GB(total available - used by the index)
2025-03-09 07:03:11,125 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/11 [00:00<?, ?it/s]  9%|▉         | 1/11 [00:00<00:01,  5.68it/s] 27%|██▋       | 3/11 [00:00<00:00,  8.66it/s] 45%|████▌     | 5/11 [00:00<00:00,  9.77it/s] 64%|██████▎   | 7/11 [00:00<00:00, 10.35it/s] 82%|████████▏ | 9/11 [00:00<00:00, 10.62it/s]100%|██████████| 11/11 [00:02<00:00,  2.49it/s]100%|██████████| 11/11 [00:02<00:00,  3.86it/s]
2025-03-09 07:03:13,984 [INFO]: 	Computing best hyperparameters for index knn.index 03/09/2025, 07:03:13
2025-03-09 07:03:40,848 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 26.8629 secs
2025-03-09 07:03:40,848 [INFO]: The best hyperparameters are: efSearch=231
2025-03-09 07:03:40,849 [INFO]: 	Compute fast metrics 03/09/2025, 07:03:40
  0%|          | 0/4 [00:00<?, ?it/s] 25%|██▌       | 1/4 [00:00<00:00,  6.67it/s] 75%|███████▌  | 3/4 [00:00<00:00, 10.21it/s] 75%|███████▌  | 3/4 [00:00<00:00,  7.76it/s]
2025-03-09 07:04:09,319 [INFO]: 	>>> Finished "Compute fast metrics" in 28.4701 secs
2025-03-09 07:04:09,321 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 58.1964 secs
2025-03-09 07:04:09,321 [INFO]: {
2025-03-09 07:04:09,321 [INFO]: 	index_key: HNSW15
2025-03-09 07:04:09,321 [INFO]: 	index_param: efSearch=231
2025-03-09 07:04:09,321 [INFO]: 	index_path: knn.index
2025-03-09 07:04:09,321 [INFO]: 	size in bytes: 539274670
2025-03-09 07:04:09,321 [INFO]: 	avg_search_speed_ms: 8.316444189283073
2025-03-09 07:04:09,321 [INFO]: 	99p_search_speed_ms: 15.11675802059472
2025-03-09 07:04:09,321 [INFO]: 	reconstruction error %: 0.0
2025-03-09 07:04:09,321 [INFO]: 	nb vectors: 2741
2025-03-09 07:04:09,321 [INFO]: 	vectors dimension: 49152
2025-03-09 07:04:09,321 [INFO]: 	compression ratio: 0.9993099212317909
2025-03-09 07:04:09,321 [INFO]: }
2025-03-09 07:04:09,321 [INFO]: 	>>> Finished "Creating the index" in 58.1979 secs
2025-03-09 07:04:09,322 [INFO]: >>> Finished "Launching the whole pipeline" in 58.2278 secs
2025-03-09 07:04:10: [retrieval_preprocessing] calculating distances ...
2025-03-09 07:04:11: [retrieval_preprocessing] finished and saved retrieval indices for episode 81409 [episode count 0/20]
[retrieval_preprocessing] for episode 15381 [episode count 1/20], we have num_retrieval=np.int64(2812) num_query=np.int64(193)
2025-03-09 07:04:12,651 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-09 07:04:13,024 [INFO]: Launching the whole pipeline 03/09/2025, 07:04:13
2025-03-09 07:04:13,024 [INFO]: Reading total number of vectors and dimension 03/09/2025, 07:04:13
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1022.50it/s]
2025-03-09 07:04:13,049 [INFO]: There are 2812 embeddings of dim 49152
2025-03-09 07:04:13,050 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0258 secs
2025-03-09 07:04:13,050 [INFO]: 	Compute estimated construction time of the index 03/09/2025, 07:04:13
2025-03-09 07:04:13,050 [INFO]: 		-> Train: 16.7 minutes
2025-03-09 07:04:13,050 [INFO]: 		-> Add: 1.5 seconds
2025-03-09 07:04:13,050 [INFO]: 		Total: 16.7 minutes
2025-03-09 07:04:13,050 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0001 secs
2025-03-09 07:04:13,050 [INFO]: 	Checking that your have enough memory available to create the index 03/09/2025, 07:04:13
2025-03-09 07:04:13,050 [INFO]: 580.3MB of memory will be needed to build the index (more might be used if you have more)
2025-03-09 07:04:13,050 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0001 secs
2025-03-09 07:04:13,050 [INFO]: 	Selecting most promising index types given data characteristics 03/09/2025, 07:04:13
2025-03-09 07:04:13,050 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-09 07:04:13,050 [INFO]: 	Creating the index 03/09/2025, 07:04:13
2025-03-09 07:04:13,050 [INFO]: 		-> Instanciate the index HNSW15 03/09/2025, 07:04:13
2025-03-09 07:04:13,051 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0009 secs
2025-03-09 07:04:13,051 [INFO]: 		-> Adding the vectors to the index 03/09/2025, 07:04:13
2025-03-09 07:04:13,051 [INFO]: The memory available for adding the vectors is 49.5GB(total available - used by the index)
2025-03-09 07:04:13,051 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/12 [00:00<?, ?it/s]  8%|▊         | 1/12 [00:00<00:01,  6.95it/s] 25%|██▌       | 3/12 [00:00<00:00, 11.55it/s] 42%|████▏     | 5/12 [00:00<00:00, 12.53it/s] 58%|█████▊    | 7/12 [00:00<00:00, 13.04it/s] 75%|███████▌  | 9/12 [00:00<00:00, 13.22it/s] 92%|█████████▏| 11/12 [00:00<00:00, 14.03it/s]100%|██████████| 12/12 [00:02<00:00,  4.73it/s]
2025-03-09 07:04:15,593 [INFO]: 	Computing best hyperparameters for index knn.index 03/09/2025, 07:04:15
2025-03-09 07:04:42,710 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 27.1172 secs
2025-03-09 07:04:42,711 [INFO]: The best hyperparameters are: efSearch=341
2025-03-09 07:04:42,711 [INFO]: 	Compute fast metrics 03/09/2025, 07:04:42
  0%|          | 0/4 [00:00<?, ?it/s] 25%|██▌       | 1/4 [00:00<00:00,  5.19it/s] 50%|█████     | 2/4 [00:00<00:00,  6.97it/s] 75%|███████▌  | 3/4 [00:00<00:00,  7.56it/s] 75%|███████▌  | 3/4 [00:00<00:00,  5.64it/s]
2025-03-09 07:04:56,496 [INFO]: 	>>> Finished "Compute fast metrics" in 13.7851 secs
2025-03-09 07:04:56,499 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 43.4473 secs
2025-03-09 07:04:56,499 [INFO]: {
2025-03-09 07:04:56,499 [INFO]: 	index_key: HNSW15
2025-03-09 07:04:56,499 [INFO]: 	index_param: efSearch=341
2025-03-09 07:04:56,499 [INFO]: 	index_path: knn.index
2025-03-09 07:04:56,499 [INFO]: 	size in bytes: 553243570
2025-03-09 07:04:56,499 [INFO]: 	avg_search_speed_ms: 10.53111699164698
2025-03-09 07:04:56,499 [INFO]: 	99p_search_speed_ms: 17.501840835902836
2025-03-09 07:04:56,499 [INFO]: 	reconstruction error %: 0.0
2025-03-09 07:04:56,499 [INFO]: 	nb vectors: 2812
2025-03-09 07:04:56,499 [INFO]: 	vectors dimension: 49152
2025-03-09 07:04:56,499 [INFO]: 	compression ratio: 0.9993097542914054
2025-03-09 07:04:56,499 [INFO]: }
2025-03-09 07:04:56,499 [INFO]: 	>>> Finished "Creating the index" in 43.4487 secs
2025-03-09 07:04:56,499 [INFO]: >>> Finished "Launching the whole pipeline" in 43.4752 secs
2025-03-09 07:04:58: [retrieval_preprocessing] calculating distances ...
2025-03-09 07:04:59: [retrieval_preprocessing] finished and saved retrieval indices for episode 15381 [episode count 1/20]
[retrieval_preprocessing] for episode 89624 [episode count 2/20], we have num_retrieval=np.int64(2886) num_query=np.int64(119)
2025-03-09 07:05:00,042 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-09 07:05:00,438 [INFO]: Launching the whole pipeline 03/09/2025, 07:05:00
2025-03-09 07:05:00,438 [INFO]: Reading total number of vectors and dimension 03/09/2025, 07:05:00
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1276.80it/s]
2025-03-09 07:05:00,464 [INFO]: There are 2886 embeddings of dim 49152
2025-03-09 07:05:00,464 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0257 secs
2025-03-09 07:05:00,464 [INFO]: 	Compute estimated construction time of the index 03/09/2025, 07:05:00
2025-03-09 07:05:00,464 [INFO]: 		-> Train: 16.7 minutes
2025-03-09 07:05:00,464 [INFO]: 		-> Add: 1.6 seconds
2025-03-09 07:05:00,464 [INFO]: 		Total: 16.7 minutes
2025-03-09 07:05:00,464 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0001 secs
2025-03-09 07:05:00,464 [INFO]: 	Checking that your have enough memory available to create the index 03/09/2025, 07:05:00
2025-03-09 07:05:00,464 [INFO]: 595.6MB of memory will be needed to build the index (more might be used if you have more)
2025-03-09 07:05:00,464 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0002 secs
2025-03-09 07:05:00,464 [INFO]: 	Selecting most promising index types given data characteristics 03/09/2025, 07:05:00
2025-03-09 07:05:00,464 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-09 07:05:00,464 [INFO]: 	Creating the index 03/09/2025, 07:05:00
2025-03-09 07:05:00,464 [INFO]: 		-> Instanciate the index HNSW15 03/09/2025, 07:05:00
2025-03-09 07:05:00,465 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0010 secs
2025-03-09 07:05:00,465 [INFO]: 		-> Adding the vectors to the index 03/09/2025, 07:05:00
2025-03-09 07:05:00,466 [INFO]: The memory available for adding the vectors is 49.5GB(total available - used by the index)
2025-03-09 07:05:00,466 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/12 [00:00<?, ?it/s]  8%|▊         | 1/12 [00:00<00:01,  7.62it/s] 25%|██▌       | 3/12 [00:00<00:00, 13.73it/s] 42%|████▏     | 5/12 [00:00<00:00, 14.08it/s] 58%|█████▊    | 7/12 [00:00<00:00, 13.37it/s] 75%|███████▌  | 9/12 [00:00<00:00, 13.21it/s] 92%|█████████▏| 11/12 [00:00<00:00, 13.51it/s]100%|██████████| 12/12 [00:02<00:00,  4.93it/s]
2025-03-09 07:05:02,901 [INFO]: 	Computing best hyperparameters for index knn.index 03/09/2025, 07:05:02
2025-03-09 07:05:28,894 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 25.9920 secs
2025-03-09 07:05:28,894 [INFO]: The best hyperparameters are: efSearch=182
2025-03-09 07:05:28,894 [INFO]: 	Compute fast metrics 03/09/2025, 07:05:28
  0%|          | 0/4 [00:00<?, ?it/s] 50%|█████     | 2/4 [00:00<00:00, 19.60it/s] 75%|███████▌  | 3/4 [00:00<00:00, 21.23it/s]
2025-03-09 07:05:41,397 [INFO]: 	>>> Finished "Compute fast metrics" in 12.5024 secs
2025-03-09 07:05:41,399 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 40.9338 secs
2025-03-09 07:05:41,399 [INFO]: {
2025-03-09 07:05:41,399 [INFO]: 	index_key: HNSW15
2025-03-09 07:05:41,399 [INFO]: 	index_param: efSearch=182
2025-03-09 07:05:41,399 [INFO]: 	index_path: knn.index
2025-03-09 07:05:41,399 [INFO]: 	size in bytes: 567802630
2025-03-09 07:05:41,399 [INFO]: 	avg_search_speed_ms: 7.393896103059576
2025-03-09 07:05:41,400 [INFO]: 	99p_search_speed_ms: 11.849376906175166
2025-03-09 07:05:41,400 [INFO]: 	reconstruction error %: 0.0
2025-03-09 07:05:41,400 [INFO]: 	nb vectors: 2886
2025-03-09 07:05:41,400 [INFO]: 	vectors dimension: 49152
2025-03-09 07:05:41,400 [INFO]: 	compression ratio: 0.9993097214079477
2025-03-09 07:05:41,400 [INFO]: }
2025-03-09 07:05:41,400 [INFO]: 	>>> Finished "Creating the index" in 40.9352 secs
2025-03-09 07:05:41,400 [INFO]: >>> Finished "Launching the whole pipeline" in 40.9615 secs
2025-03-09 07:05:41: [retrieval_preprocessing] calculating distances ...
2025-03-09 07:05:42: [retrieval_preprocessing] finished and saved retrieval indices for episode 89624 [episode count 2/20]
[retrieval_preprocessing] for episode 24605 [episode count 3/20], we have num_retrieval=np.int64(2833) num_query=np.int64(172)
2025-03-09 07:05:43,208 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-09 07:05:43,639 [INFO]: Launching the whole pipeline 03/09/2025, 07:05:43
2025-03-09 07:05:43,640 [INFO]: Reading total number of vectors and dimension 03/09/2025, 07:05:43
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1449.31it/s]
2025-03-09 07:05:43,667 [INFO]: There are 2833 embeddings of dim 49152
2025-03-09 07:05:43,667 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0279 secs
2025-03-09 07:05:43,668 [INFO]: 	Compute estimated construction time of the index 03/09/2025, 07:05:43
2025-03-09 07:05:43,668 [INFO]: 		-> Train: 16.7 minutes
2025-03-09 07:05:43,668 [INFO]: 		-> Add: 1.6 seconds
2025-03-09 07:05:43,668 [INFO]: 		Total: 16.7 minutes
2025-03-09 07:05:43,668 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0001 secs
2025-03-09 07:05:43,668 [INFO]: 	Checking that your have enough memory available to create the index 03/09/2025, 07:05:43
2025-03-09 07:05:43,668 [INFO]: 584.7MB of memory will be needed to build the index (more might be used if you have more)
2025-03-09 07:05:43,668 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0002 secs
2025-03-09 07:05:43,668 [INFO]: 	Selecting most promising index types given data characteristics 03/09/2025, 07:05:43
2025-03-09 07:05:43,668 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-09 07:05:43,668 [INFO]: 	Creating the index 03/09/2025, 07:05:43
2025-03-09 07:05:43,668 [INFO]: 		-> Instanciate the index HNSW15 03/09/2025, 07:05:43
2025-03-09 07:05:43,669 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0012 secs
2025-03-09 07:05:43,669 [INFO]: 		-> Adding the vectors to the index 03/09/2025, 07:05:43
2025-03-09 07:05:43,669 [INFO]: The memory available for adding the vectors is 49.5GB(total available - used by the index)
2025-03-09 07:05:43,670 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/12 [00:00<?, ?it/s]  8%|▊         | 1/12 [00:00<00:01,  6.40it/s] 25%|██▌       | 3/12 [00:00<00:00,  9.94it/s] 42%|████▏     | 5/12 [00:00<00:00, 10.95it/s] 58%|█████▊    | 7/12 [00:00<00:00, 11.48it/s] 75%|███████▌  | 9/12 [00:00<00:00, 11.87it/s] 92%|█████████▏| 11/12 [00:00<00:00, 11.99it/s]100%|██████████| 12/12 [00:02<00:00,  4.56it/s]
2025-03-09 07:05:46,306 [INFO]: 	Computing best hyperparameters for index knn.index 03/09/2025, 07:05:46
2025-03-09 07:06:15,227 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 28.9210 secs
2025-03-09 07:06:15,228 [INFO]: The best hyperparameters are: efSearch=390
2025-03-09 07:06:15,228 [INFO]: 	Compute fast metrics 03/09/2025, 07:06:15
  0%|          | 0/4 [00:00<?, ?it/s] 25%|██▌       | 1/4 [00:00<00:01,  1.59it/s] 50%|█████     | 2/4 [00:00<00:00,  2.69it/s] 75%|███████▌  | 3/4 [00:02<00:01,  1.05s/it] 75%|███████▌  | 3/4 [00:03<00:01,  1.19s/it]
2025-03-09 07:06:31,836 [INFO]: 	>>> Finished "Compute fast metrics" in 16.6086 secs
2025-03-09 07:06:31,838 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 48.1690 secs
2025-03-09 07:06:31,839 [INFO]: {
2025-03-09 07:06:31,839 [INFO]: 	index_key: HNSW15
2025-03-09 07:06:31,839 [INFO]: 	index_param: efSearch=390
2025-03-09 07:06:31,839 [INFO]: 	index_path: knn.index
2025-03-09 07:06:31,839 [INFO]: 	size in bytes: 557375290
2025-03-09 07:06:31,839 [INFO]: 	avg_search_speed_ms: 10.512155489006973
2025-03-09 07:06:31,839 [INFO]: 	99p_search_speed_ms: 14.779130928218365
2025-03-09 07:06:31,839 [INFO]: 	reconstruction error %: 0.0
2025-03-09 07:06:31,839 [INFO]: 	nb vectors: 2833
2025-03-09 07:06:31,839 [INFO]: 	vectors dimension: 49152
2025-03-09 07:06:31,839 [INFO]: 	compression ratio: 0.9993095747032489
2025-03-09 07:06:31,839 [INFO]: }
2025-03-09 07:06:31,839 [INFO]: 	>>> Finished "Creating the index" in 48.1707 secs
2025-03-09 07:06:31,839 [INFO]: >>> Finished "Launching the whole pipeline" in 48.1993 secs
2025-03-09 07:06:33: [retrieval_preprocessing] calculating distances ...
2025-03-09 07:06:34: [retrieval_preprocessing] finished and saved retrieval indices for episode 24605 [episode count 3/20]
[retrieval_preprocessing] for episode 20512 [episode count 4/20], we have num_retrieval=np.int64(2885) num_query=np.int64(120)
2025-03-09 07:06:35,020 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-09 07:06:35,449 [INFO]: Launching the whole pipeline 03/09/2025, 07:06:35
2025-03-09 07:06:35,449 [INFO]: Reading total number of vectors and dimension 03/09/2025, 07:06:35
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 2001.10it/s]
2025-03-09 07:06:35,474 [INFO]: There are 2885 embeddings of dim 49152
2025-03-09 07:06:35,474 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0249 secs
2025-03-09 07:06:35,474 [INFO]: 	Compute estimated construction time of the index 03/09/2025, 07:06:35
2025-03-09 07:06:35,474 [INFO]: 		-> Train: 16.7 minutes
2025-03-09 07:06:35,474 [INFO]: 		-> Add: 1.6 seconds
2025-03-09 07:06:35,474 [INFO]: 		Total: 16.7 minutes
2025-03-09 07:06:35,474 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0001 secs
2025-03-09 07:06:35,474 [INFO]: 	Checking that your have enough memory available to create the index 03/09/2025, 07:06:35
2025-03-09 07:06:35,474 [INFO]: 595.4MB of memory will be needed to build the index (more might be used if you have more)
2025-03-09 07:06:35,474 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0001 secs
2025-03-09 07:06:35,474 [INFO]: 	Selecting most promising index types given data characteristics 03/09/2025, 07:06:35
2025-03-09 07:06:35,474 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-09 07:06:35,474 [INFO]: 	Creating the index 03/09/2025, 07:06:35
2025-03-09 07:06:35,474 [INFO]: 		-> Instanciate the index HNSW15 03/09/2025, 07:06:35
2025-03-09 07:06:35,475 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0008 secs
2025-03-09 07:06:35,475 [INFO]: 		-> Adding the vectors to the index 03/09/2025, 07:06:35
2025-03-09 07:06:35,475 [INFO]: The memory available for adding the vectors is 49.5GB(total available - used by the index)
2025-03-09 07:06:35,475 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/12 [00:00<?, ?it/s]  8%|▊         | 1/12 [00:00<00:02,  5.47it/s] 25%|██▌       | 3/12 [00:00<00:01,  8.59it/s] 42%|████▏     | 5/12 [00:00<00:00,  8.91it/s] 50%|█████     | 6/12 [00:00<00:00,  9.09it/s] 58%|█████▊    | 7/12 [00:00<00:00,  8.86it/s] 67%|██████▋   | 8/12 [00:00<00:00,  8.71it/s] 75%|███████▌  | 9/12 [00:01<00:00,  8.33it/s] 83%|████████▎ | 10/12 [00:01<00:00,  8.35it/s] 92%|█████████▏| 11/12 [00:01<00:00,  8.58it/s]100%|██████████| 12/12 [00:03<00:00,  1.37it/s]100%|██████████| 12/12 [00:03<00:00,  3.44it/s]
2025-03-09 07:06:38,965 [INFO]: 	Computing best hyperparameters for index knn.index 03/09/2025, 07:06:38
2025-03-09 07:07:09,633 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 30.6680 secs
2025-03-09 07:07:09,634 [INFO]: The best hyperparameters are: efSearch=391
2025-03-09 07:07:09,634 [INFO]: 	Compute fast metrics 03/09/2025, 07:07:09
  0%|          | 0/4 [00:00<?, ?it/s] 25%|██▌       | 1/4 [00:00<00:00,  4.93it/s] 50%|█████     | 2/4 [00:01<00:01,  1.15it/s] 75%|███████▌  | 3/4 [00:01<00:00,  1.67it/s] 75%|███████▌  | 3/4 [00:02<00:00,  1.23it/s]
2025-03-09 07:07:31,718 [INFO]: 	>>> Finished "Compute fast metrics" in 22.0837 secs
2025-03-09 07:07:31,720 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 56.2448 secs
2025-03-09 07:07:31,720 [INFO]: {
2025-03-09 07:07:31,720 [INFO]: 	index_key: HNSW15
2025-03-09 07:07:31,720 [INFO]: 	index_param: efSearch=391
2025-03-09 07:07:31,720 [INFO]: 	index_path: knn.index
2025-03-09 07:07:31,720 [INFO]: 	size in bytes: 567605890
2025-03-09 07:07:31,720 [INFO]: 	avg_search_speed_ms: 11.82661231317674
2025-03-09 07:07:31,720 [INFO]: 	99p_search_speed_ms: 21.208695333916687
2025-03-09 07:07:31,720 [INFO]: 	reconstruction error %: 0.0
2025-03-09 07:07:31,720 [INFO]: 	nb vectors: 2885
2025-03-09 07:07:31,720 [INFO]: 	vectors dimension: 49152
2025-03-09 07:07:31,721 [INFO]: 	compression ratio: 0.9993097147036301
2025-03-09 07:07:31,721 [INFO]: }
2025-03-09 07:07:31,721 [INFO]: 	>>> Finished "Creating the index" in 56.2462 secs
2025-03-09 07:07:31,721 [INFO]: >>> Finished "Launching the whole pipeline" in 56.2716 secs
2025-03-09 07:07:33: [retrieval_preprocessing] calculating distances ...
2025-03-09 07:07:33: [retrieval_preprocessing] finished and saved retrieval indices for episode 20512 [episode count 4/20]
[retrieval_preprocessing] for episode 48680 [episode count 5/20], we have num_retrieval=np.int64(2905) num_query=np.int64(100)
2025-03-09 07:07:36,272 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-09 07:07:36,660 [INFO]: Launching the whole pipeline 03/09/2025, 07:07:36
2025-03-09 07:07:36,660 [INFO]: Reading total number of vectors and dimension 03/09/2025, 07:07:36
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1940.01it/s]
2025-03-09 07:07:36,682 [INFO]: There are 2905 embeddings of dim 49152
2025-03-09 07:07:36,682 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0216 secs
2025-03-09 07:07:36,682 [INFO]: 	Compute estimated construction time of the index 03/09/2025, 07:07:36
2025-03-09 07:07:36,682 [INFO]: 		-> Train: 16.7 minutes
2025-03-09 07:07:36,682 [INFO]: 		-> Add: 1.6 seconds
2025-03-09 07:07:36,682 [INFO]: 		Total: 16.7 minutes
2025-03-09 07:07:36,682 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0001 secs
2025-03-09 07:07:36,682 [INFO]: 	Checking that your have enough memory available to create the index 03/09/2025, 07:07:36
2025-03-09 07:07:36,682 [INFO]: 599.5MB of memory will be needed to build the index (more might be used if you have more)
2025-03-09 07:07:36,682 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0001 secs
2025-03-09 07:07:36,682 [INFO]: 	Selecting most promising index types given data characteristics 03/09/2025, 07:07:36
2025-03-09 07:07:36,682 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-09 07:07:36,682 [INFO]: 	Creating the index 03/09/2025, 07:07:36
2025-03-09 07:07:36,682 [INFO]: 		-> Instanciate the index HNSW15 03/09/2025, 07:07:36
2025-03-09 07:07:36,683 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0008 secs
2025-03-09 07:07:36,683 [INFO]: 		-> Adding the vectors to the index 03/09/2025, 07:07:36
2025-03-09 07:07:36,683 [INFO]: The memory available for adding the vectors is 49.5GB(total available - used by the index)
2025-03-09 07:07:36,683 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/12 [00:00<?, ?it/s]  8%|▊         | 1/12 [00:00<00:07,  1.49it/s] 17%|█▋        | 2/12 [00:01<00:10,  1.04s/it] 25%|██▌       | 3/12 [00:02<00:09,  1.03s/it] 33%|███▎      | 4/12 [00:03<00:06,  1.29it/s] 42%|████▏     | 5/12 [00:03<00:04,  1.62it/s] 58%|█████▊    | 7/12 [00:03<00:01,  2.98it/s] 75%|███████▌  | 9/12 [00:04<00:01,  2.79it/s]100%|██████████| 12/12 [00:06<00:00,  2.03it/s]100%|██████████| 12/12 [00:06<00:00,  1.84it/s]
2025-03-09 07:07:43,226 [INFO]: 	Computing best hyperparameters for index knn.index 03/09/2025, 07:07:43
2025-03-09 07:08:15,488 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 32.2610 secs
2025-03-09 07:08:15,488 [INFO]: The best hyperparameters are: efSearch=370
2025-03-09 07:08:15,488 [INFO]: 	Compute fast metrics 03/09/2025, 07:08:15
  0%|          | 0/4 [00:00<?, ?it/s] 25%|██▌       | 1/4 [00:00<00:02,  1.23it/s] 50%|█████     | 2/4 [00:02<00:02,  1.18s/it] 75%|███████▌  | 3/4 [00:02<00:00,  1.13it/s] 75%|███████▌  | 3/4 [00:03<00:01,  1.11s/it]
2025-03-09 07:08:34,072 [INFO]: 	>>> Finished "Compute fast metrics" in 18.5835 secs
2025-03-09 07:08:34,080 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 57.3967 secs
2025-03-09 07:08:34,080 [INFO]: {
2025-03-09 07:08:34,080 [INFO]: 	index_key: HNSW15
2025-03-09 07:08:34,080 [INFO]: 	index_param: efSearch=370
2025-03-09 07:08:34,080 [INFO]: 	index_path: knn.index
2025-03-09 07:08:34,080 [INFO]: 	size in bytes: 571540690
2025-03-09 07:08:34,080 [INFO]: 	avg_search_speed_ms: 10.788179307617447
2025-03-09 07:08:34,080 [INFO]: 	99p_search_speed_ms: 16.57869782764465
2025-03-09 07:08:34,080 [INFO]: 	reconstruction error %: 0.0
2025-03-09 07:08:34,080 [INFO]: 	nb vectors: 2905
2025-03-09 07:08:34,080 [INFO]: 	vectors dimension: 49152
2025-03-09 07:08:34,080 [INFO]: 	compression ratio: 0.9993098479130156
2025-03-09 07:08:34,080 [INFO]: }
2025-03-09 07:08:34,080 [INFO]: 	>>> Finished "Creating the index" in 57.3981 secs
2025-03-09 07:08:34,080 [INFO]: >>> Finished "Launching the whole pipeline" in 57.4202 secs
2025-03-09 07:08:35: [retrieval_preprocessing] calculating distances ...
2025-03-09 07:08:35: [retrieval_preprocessing] finished and saved retrieval indices for episode 48680 [episode count 5/20]
[retrieval_preprocessing] for episode 24623 [episode count 6/20], we have num_retrieval=np.int64(2815) num_query=np.int64(190)
2025-03-09 07:08:36,175 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-09 07:08:36,555 [INFO]: Launching the whole pipeline 03/09/2025, 07:08:36
2025-03-09 07:08:36,555 [INFO]: Reading total number of vectors and dimension 03/09/2025, 07:08:36
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 2490.68it/s]
2025-03-09 07:08:36,580 [INFO]: There are 2815 embeddings of dim 49152
2025-03-09 07:08:36,581 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0254 secs
2025-03-09 07:08:36,581 [INFO]: 	Compute estimated construction time of the index 03/09/2025, 07:08:36
2025-03-09 07:08:36,581 [INFO]: 		-> Train: 16.7 minutes
2025-03-09 07:08:36,581 [INFO]: 		-> Add: 1.5 seconds
2025-03-09 07:08:36,581 [INFO]: 		Total: 16.7 minutes
2025-03-09 07:08:36,581 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0001 secs
2025-03-09 07:08:36,581 [INFO]: 	Checking that your have enough memory available to create the index 03/09/2025, 07:08:36
2025-03-09 07:08:36,581 [INFO]: 580.9MB of memory will be needed to build the index (more might be used if you have more)
2025-03-09 07:08:36,581 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0002 secs
2025-03-09 07:08:36,581 [INFO]: 	Selecting most promising index types given data characteristics 03/09/2025, 07:08:36
2025-03-09 07:08:36,581 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-09 07:08:36,581 [INFO]: 	Creating the index 03/09/2025, 07:08:36
2025-03-09 07:08:36,581 [INFO]: 		-> Instanciate the index HNSW15 03/09/2025, 07:08:36
2025-03-09 07:08:36,583 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0013 secs
2025-03-09 07:08:36,583 [INFO]: 		-> Adding the vectors to the index 03/09/2025, 07:08:36
2025-03-09 07:08:36,583 [INFO]: The memory available for adding the vectors is 49.5GB(total available - used by the index)
2025-03-09 07:08:36,583 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/12 [00:00<?, ?it/s]  8%|▊         | 1/12 [00:00<00:01,  7.07it/s] 25%|██▌       | 3/12 [00:00<00:00,  9.79it/s] 42%|████▏     | 5/12 [00:00<00:00, 10.32it/s] 58%|█████▊    | 7/12 [00:00<00:00, 10.38it/s] 75%|███████▌  | 9/12 [00:00<00:00, 10.20it/s] 92%|█████████▏| 11/12 [00:01<00:00, 10.14it/s]100%|██████████| 12/12 [00:02<00:00,  4.38it/s]
2025-03-09 07:08:39,325 [INFO]: 	Computing best hyperparameters for index knn.index 03/09/2025, 07:08:39
2025-03-09 07:09:12,270 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 32.9453 secs
2025-03-09 07:09:12,271 [INFO]: The best hyperparameters are: efSearch=399
2025-03-09 07:09:12,271 [INFO]: 	Compute fast metrics 03/09/2025, 07:09:12
  0%|          | 0/4 [00:00<?, ?it/s] 25%|██▌       | 1/4 [00:00<00:00,  5.50it/s] 50%|█████     | 2/4 [00:00<00:00,  3.11it/s] 75%|███████▌  | 3/4 [00:01<00:00,  2.46it/s] 75%|███████▌  | 3/4 [00:01<00:00,  1.62it/s]
2025-03-09 07:09:31,525 [INFO]: 	>>> Finished "Compute fast metrics" in 19.2547 secs
2025-03-09 07:09:31,898 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 55.3155 secs
2025-03-09 07:09:31,898 [INFO]: {
2025-03-09 07:09:31,899 [INFO]: 	index_key: HNSW15
2025-03-09 07:09:31,899 [INFO]: 	index_param: efSearch=399
2025-03-09 07:09:31,899 [INFO]: 	index_path: knn.index
2025-03-09 07:09:31,899 [INFO]: 	size in bytes: 553833790
2025-03-09 07:09:31,899 [INFO]: 	avg_search_speed_ms: 11.423357250222077
2025-03-09 07:09:31,899 [INFO]: 	99p_search_speed_ms: 17.58497318951413
2025-03-09 07:09:31,899 [INFO]: 	reconstruction error %: 0.0
2025-03-09 07:09:31,899 [INFO]: 	nb vectors: 2815
2025-03-09 07:09:31,899 [INFO]: 	vectors dimension: 49152
2025-03-09 07:09:31,899 [INFO]: 	compression ratio: 0.9993097748694604
2025-03-09 07:09:31,899 [INFO]: }
2025-03-09 07:09:31,899 [INFO]: 	>>> Finished "Creating the index" in 55.3180 secs
2025-03-09 07:09:31,899 [INFO]: >>> Finished "Launching the whole pipeline" in 55.3441 secs
2025-03-09 07:09:34: [retrieval_preprocessing] calculating distances ...
2025-03-09 07:09:34: [retrieval_preprocessing] finished and saved retrieval indices for episode 24623 [episode count 6/20]
[retrieval_preprocessing] for episode 30264 [episode count 7/20], we have num_retrieval=np.int64(2852) num_query=np.int64(153)
2025-03-09 07:09:35,790 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-09 07:09:36,462 [INFO]: Launching the whole pipeline 03/09/2025, 07:09:36
2025-03-09 07:09:36,462 [INFO]: Reading total number of vectors and dimension 03/09/2025, 07:09:36
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1442.33it/s]
2025-03-09 07:09:36,492 [INFO]: There are 2852 embeddings of dim 49152
2025-03-09 07:09:36,492 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0298 secs
2025-03-09 07:09:36,492 [INFO]: 	Compute estimated construction time of the index 03/09/2025, 07:09:36
2025-03-09 07:09:36,492 [INFO]: 		-> Train: 16.7 minutes
2025-03-09 07:09:36,492 [INFO]: 		-> Add: 1.6 seconds
2025-03-09 07:09:36,492 [INFO]: 		Total: 16.7 minutes
2025-03-09 07:09:36,492 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0001 secs
2025-03-09 07:09:36,492 [INFO]: 	Checking that your have enough memory available to create the index 03/09/2025, 07:09:36
2025-03-09 07:09:36,492 [INFO]: 588.6MB of memory will be needed to build the index (more might be used if you have more)
2025-03-09 07:09:36,492 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0002 secs
2025-03-09 07:09:36,492 [INFO]: 	Selecting most promising index types given data characteristics 03/09/2025, 07:09:36
2025-03-09 07:09:36,492 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-09 07:09:36,492 [INFO]: 	Creating the index 03/09/2025, 07:09:36
2025-03-09 07:09:36,493 [INFO]: 		-> Instanciate the index HNSW15 03/09/2025, 07:09:36
2025-03-09 07:09:36,494 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0011 secs
2025-03-09 07:09:36,494 [INFO]: 		-> Adding the vectors to the index 03/09/2025, 07:09:36
2025-03-09 07:09:36,494 [INFO]: The memory available for adding the vectors is 49.5GB(total available - used by the index)
2025-03-09 07:09:36,494 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/12 [00:00<?, ?it/s]  8%|▊         | 1/12 [00:00<00:02,  4.41it/s] 17%|█▋        | 2/12 [00:00<00:02,  4.94it/s] 25%|██▌       | 3/12 [00:00<00:01,  5.16it/s] 33%|███▎      | 4/12 [00:01<00:03,  2.64it/s] 42%|████▏     | 5/12 [00:02<00:05,  1.31it/s] 50%|█████     | 6/12 [00:03<00:04,  1.36it/s] 67%|██████▋   | 8/12 [00:03<00:01,  2.34it/s] 75%|███████▌  | 9/12 [00:04<00:01,  1.92it/s] 83%|████████▎ | 10/12 [00:05<00:01,  1.81it/s] 92%|█████████▏| 11/12 [00:05<00:00,  2.12it/s]100%|██████████| 12/12 [00:07<00:00,  1.20it/s]100%|██████████| 12/12 [00:07<00:00,  1.70it/s]
2025-03-09 07:09:43,541 [INFO]: 	Computing best hyperparameters for index knn.index 03/09/2025, 07:09:43
2025-03-09 07:10:14,429 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 30.8874 secs
2025-03-09 07:10:14,429 [INFO]: The best hyperparameters are: efSearch=381
2025-03-09 07:10:14,429 [INFO]: 	Compute fast metrics 03/09/2025, 07:10:14
  0%|          | 0/4 [00:00<?, ?it/s] 25%|██▌       | 1/4 [00:00<00:00,  5.90it/s] 75%|███████▌  | 3/4 [00:00<00:00,  9.50it/s] 75%|███████▌  | 3/4 [00:00<00:00,  7.24it/s]
2025-03-09 07:10:26,859 [INFO]: 	>>> Finished "Compute fast metrics" in 12.4303 secs
2025-03-09 07:10:26,867 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 50.3728 secs
2025-03-09 07:10:26,867 [INFO]: {
2025-03-09 07:10:26,867 [INFO]: 	index_key: HNSW15
2025-03-09 07:10:26,867 [INFO]: 	index_param: efSearch=381
2025-03-09 07:10:26,867 [INFO]: 	index_path: knn.index
2025-03-09 07:10:26,867 [INFO]: 	size in bytes: 561113350
2025-03-09 07:10:26,867 [INFO]: 	avg_search_speed_ms: 11.223146204045408
2025-03-09 07:10:26,867 [INFO]: 	99p_search_speed_ms: 18.29891551751644
2025-03-09 07:10:26,867 [INFO]: 	reconstruction error %: 0.0
2025-03-09 07:10:26,867 [INFO]: 	nb vectors: 2852
2025-03-09 07:10:26,867 [INFO]: 	vectors dimension: 49152
2025-03-09 07:10:26,867 [INFO]: 	compression ratio: 0.9993097045365255
2025-03-09 07:10:26,867 [INFO]: }
2025-03-09 07:10:26,867 [INFO]: 	>>> Finished "Creating the index" in 50.3747 secs
2025-03-09 07:10:26,867 [INFO]: >>> Finished "Launching the whole pipeline" in 50.4051 secs
2025-03-09 07:10:28: [retrieval_preprocessing] calculating distances ...
2025-03-09 07:10:29: [retrieval_preprocessing] finished and saved retrieval indices for episode 30264 [episode count 7/20]
[retrieval_preprocessing] for episode 5689 [episode count 8/20], we have num_retrieval=np.int64(2767) num_query=np.int64(238)
2025-03-09 07:10:32,335 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-09 07:10:32,757 [INFO]: Launching the whole pipeline 03/09/2025, 07:10:32
2025-03-09 07:10:32,757 [INFO]: Reading total number of vectors and dimension 03/09/2025, 07:10:32
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1311.95it/s]
2025-03-09 07:10:32,783 [INFO]: There are 2767 embeddings of dim 49152
2025-03-09 07:10:32,783 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0264 secs
2025-03-09 07:10:32,783 [INFO]: 	Compute estimated construction time of the index 03/09/2025, 07:10:32
2025-03-09 07:10:32,783 [INFO]: 		-> Train: 16.7 minutes
2025-03-09 07:10:32,783 [INFO]: 		-> Add: 1.5 seconds
2025-03-09 07:10:32,784 [INFO]: 		Total: 16.7 minutes
2025-03-09 07:10:32,784 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0001 secs
2025-03-09 07:10:32,784 [INFO]: 	Checking that your have enough memory available to create the index 03/09/2025, 07:10:32
2025-03-09 07:10:32,784 [INFO]: 571.0MB of memory will be needed to build the index (more might be used if you have more)
2025-03-09 07:10:32,784 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0003 secs
2025-03-09 07:10:32,784 [INFO]: 	Selecting most promising index types given data characteristics 03/09/2025, 07:10:32
2025-03-09 07:10:32,784 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-09 07:10:32,784 [INFO]: 	Creating the index 03/09/2025, 07:10:32
2025-03-09 07:10:32,784 [INFO]: 		-> Instanciate the index HNSW15 03/09/2025, 07:10:32
2025-03-09 07:10:32,785 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0010 secs
2025-03-09 07:10:32,785 [INFO]: 		-> Adding the vectors to the index 03/09/2025, 07:10:32
2025-03-09 07:10:32,785 [INFO]: The memory available for adding the vectors is 49.5GB(total available - used by the index)
2025-03-09 07:10:32,785 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/11 [00:00<?, ?it/s]  9%|▉         | 1/11 [00:00<00:01,  7.14it/s] 55%|█████▍    | 6/11 [00:00<00:00, 27.73it/s]100%|██████████| 11/11 [00:02<00:00,  4.29it/s]100%|██████████| 11/11 [00:02<00:00,  5.00it/s]
2025-03-09 07:10:34,996 [INFO]: 	Computing best hyperparameters for index knn.index 03/09/2025, 07:10:34
2025-03-09 07:11:01,540 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 26.5439 secs
2025-03-09 07:11:01,541 [INFO]: The best hyperparameters are: efSearch=310
2025-03-09 07:11:01,541 [INFO]: 	Compute fast metrics 03/09/2025, 07:11:01
  0%|          | 0/4 [00:00<?, ?it/s] 25%|██▌       | 1/4 [00:00<00:00,  6.11it/s] 75%|███████▌  | 3/4 [00:00<00:00, 11.55it/s] 75%|███████▌  | 3/4 [00:00<00:00,  8.71it/s]
2025-03-09 07:11:13,819 [INFO]: 	>>> Finished "Compute fast metrics" in 12.2778 secs
2025-03-09 07:11:13,821 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 41.0360 secs
2025-03-09 07:11:13,821 [INFO]: {
2025-03-09 07:11:13,821 [INFO]: 	index_key: HNSW15
2025-03-09 07:11:13,821 [INFO]: 	index_param: efSearch=310
2025-03-09 07:11:13,821 [INFO]: 	index_path: knn.index
2025-03-09 07:11:13,821 [INFO]: 	size in bytes: 544390090
2025-03-09 07:11:13,821 [INFO]: 	avg_search_speed_ms: 9.57595258175085
2025-03-09 07:11:13,821 [INFO]: 	99p_search_speed_ms: 19.253924468066533
2025-03-09 07:11:13,821 [INFO]: 	reconstruction error %: 0.0
2025-03-09 07:11:13,821 [INFO]: 	nb vectors: 2767
2025-03-09 07:11:13,821 [INFO]: 	vectors dimension: 49152
2025-03-09 07:11:13,821 [INFO]: 	compression ratio: 0.9993097706830042
2025-03-09 07:11:13,821 [INFO]: }
2025-03-09 07:11:13,821 [INFO]: 	>>> Finished "Creating the index" in 41.0374 secs
2025-03-09 07:11:13,821 [INFO]: >>> Finished "Launching the whole pipeline" in 41.0645 secs
2025-03-09 07:11:15: [retrieval_preprocessing] calculating distances ...
2025-03-09 07:11:16: [retrieval_preprocessing] finished and saved retrieval indices for episode 5689 [episode count 8/20]
[retrieval_preprocessing] for episode 64577 [episode count 9/20], we have num_retrieval=np.int64(2891) num_query=np.int64(114)
2025-03-09 07:11:16,561 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-09 07:11:16,926 [INFO]: Launching the whole pipeline 03/09/2025, 07:11:16
2025-03-09 07:11:16,926 [INFO]: Reading total number of vectors and dimension 03/09/2025, 07:11:16
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 2232.20it/s]
2025-03-09 07:11:16,950 [INFO]: There are 2891 embeddings of dim 49152
2025-03-09 07:11:16,951 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0249 secs
2025-03-09 07:11:16,951 [INFO]: 	Compute estimated construction time of the index 03/09/2025, 07:11:16
2025-03-09 07:11:16,951 [INFO]: 		-> Train: 16.7 minutes
2025-03-09 07:11:16,951 [INFO]: 		-> Add: 1.6 seconds
2025-03-09 07:11:16,951 [INFO]: 		Total: 16.7 minutes
2025-03-09 07:11:16,951 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0002 secs
2025-03-09 07:11:16,951 [INFO]: 	Checking that your have enough memory available to create the index 03/09/2025, 07:11:16
2025-03-09 07:11:16,951 [INFO]: 596.6MB of memory will be needed to build the index (more might be used if you have more)
2025-03-09 07:11:16,951 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0001 secs
2025-03-09 07:11:16,951 [INFO]: 	Selecting most promising index types given data characteristics 03/09/2025, 07:11:16
2025-03-09 07:11:16,951 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-09 07:11:16,951 [INFO]: 	Creating the index 03/09/2025, 07:11:16
2025-03-09 07:11:16,951 [INFO]: 		-> Instanciate the index HNSW15 03/09/2025, 07:11:16
2025-03-09 07:11:16,952 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0007 secs
2025-03-09 07:11:16,952 [INFO]: 		-> Adding the vectors to the index 03/09/2025, 07:11:16
2025-03-09 07:11:16,952 [INFO]: The memory available for adding the vectors is 49.5GB(total available - used by the index)
2025-03-09 07:11:16,952 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/12 [00:00<?, ?it/s]  8%|▊         | 1/12 [00:00<00:01,  6.44it/s] 17%|█▋        | 2/12 [00:00<00:01,  7.72it/s] 25%|██▌       | 3/12 [00:00<00:01,  7.76it/s] 33%|███▎      | 4/12 [00:00<00:01,  7.63it/s] 42%|████▏     | 5/12 [00:00<00:01,  6.11it/s] 50%|█████     | 6/12 [00:00<00:00,  6.19it/s] 58%|█████▊    | 7/12 [00:01<00:00,  6.65it/s] 67%|██████▋   | 8/12 [00:01<00:00,  7.00it/s] 75%|███████▌  | 9/12 [00:01<00:00,  7.19it/s] 83%|████████▎ | 10/12 [00:01<00:00,  7.29it/s] 92%|█████████▏| 11/12 [00:01<00:00,  7.43it/s]100%|██████████| 12/12 [00:03<00:00,  1.42it/s]100%|██████████| 12/12 [00:03<00:00,  3.36it/s]
2025-03-09 07:11:20,522 [INFO]: 	Computing best hyperparameters for index knn.index 03/09/2025, 07:11:20
2025-03-09 07:11:53,350 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 32.8285 secs
2025-03-09 07:11:53,351 [INFO]: The best hyperparameters are: efSearch=362
2025-03-09 07:11:53,351 [INFO]: 	Compute fast metrics 03/09/2025, 07:11:53
  0%|          | 0/4 [00:00<?, ?it/s] 25%|██▌       | 1/4 [00:00<00:00,  3.00it/s] 50%|█████     | 2/4 [00:00<00:00,  4.86it/s] 75%|███████▌  | 3/4 [00:00<00:00,  5.05it/s]
2025-03-09 07:12:20,069 [INFO]: 	>>> Finished "Compute fast metrics" in 26.7184 secs
2025-03-09 07:12:20,073 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 63.1210 secs
2025-03-09 07:12:20,073 [INFO]: {
2025-03-09 07:12:20,073 [INFO]: 	index_key: HNSW15
2025-03-09 07:12:20,073 [INFO]: 	index_param: efSearch=362
2025-03-09 07:12:20,073 [INFO]: 	index_path: knn.index
2025-03-09 07:12:20,073 [INFO]: 	size in bytes: 568786330
2025-03-09 07:12:20,073 [INFO]: 	avg_search_speed_ms: 10.941086684816767
2025-03-09 07:12:20,073 [INFO]: 	99p_search_speed_ms: 18.666634000837803
2025-03-09 07:12:20,073 [INFO]: 	reconstruction error %: 0.0
2025-03-09 07:12:20,073 [INFO]: 	nb vectors: 2891
2025-03-09 07:12:20,073 [INFO]: 	vectors dimension: 49152
2025-03-09 07:12:20,073 [INFO]: 	compression ratio: 0.9993097548599665
2025-03-09 07:12:20,073 [INFO]: }
2025-03-09 07:12:20,073 [INFO]: 	>>> Finished "Creating the index" in 63.1222 secs
2025-03-09 07:12:20,073 [INFO]: >>> Finished "Launching the whole pipeline" in 63.1477 secs
2025-03-09 07:12:21: [retrieval_preprocessing] calculating distances ...
2025-03-09 07:12:21: [retrieval_preprocessing] finished and saved retrieval indices for episode 64577 [episode count 9/20]
[retrieval_preprocessing] for episode 7240 [episode count 10/20], we have num_retrieval=np.int64(2814) num_query=np.int64(191)
2025-03-09 07:12:22,654 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-09 07:12:23,063 [INFO]: Launching the whole pipeline 03/09/2025, 07:12:23
2025-03-09 07:12:23,063 [INFO]: Reading total number of vectors and dimension 03/09/2025, 07:12:23
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1950.84it/s]
2025-03-09 07:12:23,088 [INFO]: There are 2814 embeddings of dim 49152
2025-03-09 07:12:23,088 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0255 secs
2025-03-09 07:12:23,089 [INFO]: 	Compute estimated construction time of the index 03/09/2025, 07:12:23
2025-03-09 07:12:23,089 [INFO]: 		-> Train: 16.7 minutes
2025-03-09 07:12:23,089 [INFO]: 		-> Add: 1.5 seconds
2025-03-09 07:12:23,089 [INFO]: 		Total: 16.7 minutes
2025-03-09 07:12:23,089 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0004 secs
2025-03-09 07:12:23,089 [INFO]: 	Checking that your have enough memory available to create the index 03/09/2025, 07:12:23
2025-03-09 07:12:23,089 [INFO]: 580.7MB of memory will be needed to build the index (more might be used if you have more)
2025-03-09 07:12:23,090 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0004 secs
2025-03-09 07:12:23,090 [INFO]: 	Selecting most promising index types given data characteristics 03/09/2025, 07:12:23
2025-03-09 07:12:23,090 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-09 07:12:23,090 [INFO]: 	Creating the index 03/09/2025, 07:12:23
2025-03-09 07:12:23,090 [INFO]: 		-> Instanciate the index HNSW15 03/09/2025, 07:12:23
2025-03-09 07:12:23,093 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0028 secs
2025-03-09 07:12:23,093 [INFO]: 		-> Adding the vectors to the index 03/09/2025, 07:12:23
2025-03-09 07:12:23,093 [INFO]: The memory available for adding the vectors is 49.5GB(total available - used by the index)
2025-03-09 07:12:23,094 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/12 [00:00<?, ?it/s]  8%|▊         | 1/12 [00:00<00:01,  6.50it/s] 25%|██▌       | 3/12 [00:00<00:00,  9.43it/s] 33%|███▎      | 4/12 [00:00<00:00,  9.55it/s] 42%|████▏     | 5/12 [00:00<00:00,  9.40it/s] 50%|█████     | 6/12 [00:00<00:00,  9.28it/s] 58%|█████▊    | 7/12 [00:00<00:00,  9.20it/s] 67%|██████▋   | 8/12 [00:00<00:00,  9.17it/s] 75%|███████▌  | 9/12 [00:00<00:00,  9.22it/s] 83%|████████▎ | 10/12 [00:01<00:00,  9.02it/s] 92%|█████████▏| 11/12 [00:01<00:00,  9.05it/s]100%|██████████| 12/12 [00:03<00:00,  1.60it/s]100%|██████████| 12/12 [00:03<00:00,  3.97it/s]
2025-03-09 07:12:26,119 [INFO]: 	Computing best hyperparameters for index knn.index 03/09/2025, 07:12:26
2025-03-09 07:12:56,923 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 30.8040 secs
2025-03-09 07:12:56,923 [INFO]: The best hyperparameters are: efSearch=346
2025-03-09 07:12:56,924 [INFO]: 	Compute fast metrics 03/09/2025, 07:12:56
  0%|          | 0/4 [00:00<?, ?it/s] 25%|██▌       | 1/4 [00:00<00:00,  5.30it/s] 75%|███████▌  | 3/4 [00:00<00:00,  8.53it/s] 75%|███████▌  | 3/4 [00:00<00:00,  6.59it/s]
2025-03-09 07:13:09,669 [INFO]: 	>>> Finished "Compute fast metrics" in 12.7456 secs
2025-03-09 07:13:09,671 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 46.5782 secs
2025-03-09 07:13:09,672 [INFO]: {
2025-03-09 07:13:09,672 [INFO]: 	index_key: HNSW15
2025-03-09 07:13:09,672 [INFO]: 	index_param: efSearch=346
2025-03-09 07:13:09,672 [INFO]: 	index_path: knn.index
2025-03-09 07:13:09,672 [INFO]: 	size in bytes: 553637050
2025-03-09 07:13:09,672 [INFO]: 	avg_search_speed_ms: 10.840791015495281
2025-03-09 07:13:09,672 [INFO]: 	99p_search_speed_ms: 20.712657659314562
2025-03-09 07:13:09,672 [INFO]: 	reconstruction error %: 0.0
2025-03-09 07:13:09,672 [INFO]: 	nb vectors: 2814
2025-03-09 07:13:09,672 [INFO]: 	vectors dimension: 49152
2025-03-09 07:13:09,672 [INFO]: 	compression ratio: 0.9993097680149838
2025-03-09 07:13:09,672 [INFO]: }
2025-03-09 07:13:09,672 [INFO]: 	>>> Finished "Creating the index" in 46.5819 secs
2025-03-09 07:13:09,672 [INFO]: >>> Finished "Launching the whole pipeline" in 46.6089 secs
2025-03-09 07:13:11: [retrieval_preprocessing] calculating distances ...
2025-03-09 07:13:12: [retrieval_preprocessing] finished and saved retrieval indices for episode 7240 [episode count 10/20]
[retrieval_preprocessing] for episode 93768 [episode count 11/20], we have num_retrieval=np.int64(2890) num_query=np.int64(115)
2025-03-09 07:13:13,186 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-09 07:13:13,664 [INFO]: Launching the whole pipeline 03/09/2025, 07:13:13
2025-03-09 07:13:13,664 [INFO]: Reading total number of vectors and dimension 03/09/2025, 07:13:13
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1332.37it/s]
2025-03-09 07:13:13,693 [INFO]: There are 2890 embeddings of dim 49152
2025-03-09 07:13:13,693 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0291 secs
2025-03-09 07:13:13,694 [INFO]: 	Compute estimated construction time of the index 03/09/2025, 07:13:13
2025-03-09 07:13:13,694 [INFO]: 		-> Train: 16.7 minutes
2025-03-09 07:13:13,694 [INFO]: 		-> Add: 1.6 seconds
2025-03-09 07:13:13,694 [INFO]: 		Total: 16.7 minutes
2025-03-09 07:13:13,694 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0001 secs
2025-03-09 07:13:13,694 [INFO]: 	Checking that your have enough memory available to create the index 03/09/2025, 07:13:13
2025-03-09 07:13:13,694 [INFO]: 596.4MB of memory will be needed to build the index (more might be used if you have more)
2025-03-09 07:13:13,694 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0001 secs
2025-03-09 07:13:13,694 [INFO]: 	Selecting most promising index types given data characteristics 03/09/2025, 07:13:13
2025-03-09 07:13:13,694 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-09 07:13:13,694 [INFO]: 	Creating the index 03/09/2025, 07:13:13
2025-03-09 07:13:13,694 [INFO]: 		-> Instanciate the index HNSW15 03/09/2025, 07:13:13
2025-03-09 07:13:13,695 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0009 secs
2025-03-09 07:13:13,695 [INFO]: 		-> Adding the vectors to the index 03/09/2025, 07:13:13
2025-03-09 07:13:13,695 [INFO]: The memory available for adding the vectors is 49.5GB(total available - used by the index)
2025-03-09 07:13:13,695 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/12 [00:00<?, ?it/s]  8%|▊         | 1/12 [00:00<00:01,  7.14it/s] 25%|██▌       | 3/12 [00:00<00:00, 10.52it/s] 42%|████▏     | 5/12 [00:00<00:00, 11.46it/s] 58%|█████▊    | 7/12 [00:00<00:00, 11.76it/s] 75%|███████▌  | 9/12 [00:00<00:00, 11.77it/s] 92%|█████████▏| 11/12 [00:00<00:00, 11.65it/s]100%|██████████| 12/12 [00:02<00:00,  4.56it/s]
2025-03-09 07:13:16,329 [INFO]: 	Computing best hyperparameters for index knn.index 03/09/2025, 07:13:16
2025-03-09 07:13:42,597 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 26.2675 secs
2025-03-09 07:13:42,598 [INFO]: The best hyperparameters are: efSearch=437
2025-03-09 07:13:42,598 [INFO]: 	Compute fast metrics 03/09/2025, 07:13:42
  0%|          | 0/4 [00:00<?, ?it/s] 25%|██▌       | 1/4 [00:00<00:00,  6.89it/s] 75%|███████▌  | 3/4 [00:00<00:00, 10.12it/s] 75%|███████▌  | 3/4 [00:00<00:00,  7.71it/s]
2025-03-09 07:13:56,394 [INFO]: 	>>> Finished "Compute fast metrics" in 13.7967 secs
2025-03-09 07:13:56,396 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 42.7014 secs
2025-03-09 07:13:56,397 [INFO]: {
2025-03-09 07:13:56,397 [INFO]: 	index_key: HNSW15
2025-03-09 07:13:56,397 [INFO]: 	index_param: efSearch=437
2025-03-09 07:13:56,397 [INFO]: 	index_path: knn.index
2025-03-09 07:13:56,397 [INFO]: 	size in bytes: 568589590
2025-03-09 07:13:56,397 [INFO]: 	avg_search_speed_ms: 11.657765997836414
2025-03-09 07:13:56,397 [INFO]: 	99p_search_speed_ms: 16.871421176474538
2025-03-09 07:13:56,397 [INFO]: 	reconstruction error %: 0.0
2025-03-09 07:13:56,397 [INFO]: 	nb vectors: 2890
2025-03-09 07:13:56,397 [INFO]: 	vectors dimension: 49152
2025-03-09 07:13:56,397 [INFO]: 	compression ratio: 0.9993097481788226
2025-03-09 07:13:56,397 [INFO]: }
2025-03-09 07:13:56,397 [INFO]: 	>>> Finished "Creating the index" in 42.7031 secs
2025-03-09 07:13:56,397 [INFO]: >>> Finished "Launching the whole pipeline" in 42.7327 secs
2025-03-09 07:13:57: [retrieval_preprocessing] calculating distances ...
2025-03-09 07:13:58: [retrieval_preprocessing] finished and saved retrieval indices for episode 93768 [episode count 11/20]
[retrieval_preprocessing] for episode 17487 [episode count 12/20], we have num_retrieval=np.int64(2842) num_query=np.int64(163)
2025-03-09 07:13:58,984 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-09 07:13:59,330 [INFO]: Launching the whole pipeline 03/09/2025, 07:13:59
2025-03-09 07:13:59,330 [INFO]: Reading total number of vectors and dimension 03/09/2025, 07:13:59
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1664.41it/s]
2025-03-09 07:13:59,354 [INFO]: There are 2842 embeddings of dim 49152
2025-03-09 07:13:59,354 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0238 secs
2025-03-09 07:13:59,354 [INFO]: 	Compute estimated construction time of the index 03/09/2025, 07:13:59
2025-03-09 07:13:59,354 [INFO]: 		-> Train: 16.7 minutes
2025-03-09 07:13:59,354 [INFO]: 		-> Add: 1.6 seconds
2025-03-09 07:13:59,354 [INFO]: 		Total: 16.7 minutes
2025-03-09 07:13:59,354 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0001 secs
2025-03-09 07:13:59,354 [INFO]: 	Checking that your have enough memory available to create the index 03/09/2025, 07:13:59
2025-03-09 07:13:59,354 [INFO]: 586.5MB of memory will be needed to build the index (more might be used if you have more)
2025-03-09 07:13:59,354 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0001 secs
2025-03-09 07:13:59,354 [INFO]: 	Selecting most promising index types given data characteristics 03/09/2025, 07:13:59
2025-03-09 07:13:59,354 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-09 07:13:59,354 [INFO]: 	Creating the index 03/09/2025, 07:13:59
2025-03-09 07:13:59,354 [INFO]: 		-> Instanciate the index HNSW15 03/09/2025, 07:13:59
2025-03-09 07:13:59,355 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0010 secs
2025-03-09 07:13:59,355 [INFO]: 		-> Adding the vectors to the index 03/09/2025, 07:13:59
2025-03-09 07:13:59,355 [INFO]: The memory available for adding the vectors is 49.5GB(total available - used by the index)
2025-03-09 07:13:59,356 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/12 [00:00<?, ?it/s]  8%|▊         | 1/12 [00:00<00:02,  5.49it/s] 17%|█▋        | 2/12 [00:00<00:01,  6.97it/s] 25%|██▌       | 3/12 [00:00<00:01,  7.62it/s] 33%|███▎      | 4/12 [00:00<00:00,  8.26it/s] 50%|█████     | 6/12 [00:00<00:00,  9.63it/s] 58%|█████▊    | 7/12 [00:00<00:00,  9.69it/s] 75%|███████▌  | 9/12 [00:01<00:00,  9.57it/s] 83%|████████▎ | 10/12 [00:01<00:00,  9.29it/s] 92%|█████████▏| 11/12 [00:01<00:00,  9.06it/s]100%|██████████| 12/12 [00:03<00:00,  1.77it/s]100%|██████████| 12/12 [00:03<00:00,  3.91it/s]
2025-03-09 07:14:02,424 [INFO]: 	Computing best hyperparameters for index knn.index 03/09/2025, 07:14:02
2025-03-09 07:14:32,745 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 30.3208 secs
2025-03-09 07:14:32,746 [INFO]: The best hyperparameters are: efSearch=349
2025-03-09 07:14:32,746 [INFO]: 	Compute fast metrics 03/09/2025, 07:14:32
  0%|          | 0/4 [00:00<?, ?it/s] 25%|██▌       | 1/4 [00:00<00:00,  5.94it/s] 75%|███████▌  | 3/4 [00:00<00:00,  9.55it/s] 75%|███████▌  | 3/4 [00:00<00:00,  7.28it/s]
2025-03-09 07:14:46,496 [INFO]: 	>>> Finished "Compute fast metrics" in 13.7501 secs
2025-03-09 07:14:46,498 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 47.1426 secs
2025-03-09 07:14:46,498 [INFO]: {
2025-03-09 07:14:46,498 [INFO]: 	index_key: HNSW15
2025-03-09 07:14:46,498 [INFO]: 	index_param: efSearch=349
2025-03-09 07:14:46,498 [INFO]: 	index_path: knn.index
2025-03-09 07:14:46,498 [INFO]: 	size in bytes: 559145950
2025-03-09 07:14:46,498 [INFO]: 	avg_search_speed_ms: 10.28715209257425
2025-03-09 07:14:46,498 [INFO]: 	99p_search_speed_ms: 17.1353492885828
2025-03-09 07:14:46,498 [INFO]: 	reconstruction error %: 0.0
2025-03-09 07:14:46,498 [INFO]: 	nb vectors: 2842
2025-03-09 07:14:46,498 [INFO]: 	vectors dimension: 49152
2025-03-09 07:14:46,498 [INFO]: 	compression ratio: 0.9993096364196146
2025-03-09 07:14:46,498 [INFO]: }
2025-03-09 07:14:46,498 [INFO]: 	>>> Finished "Creating the index" in 47.1441 secs
2025-03-09 07:14:46,498 [INFO]: >>> Finished "Launching the whole pipeline" in 47.1684 secs
2025-03-09 07:14:48: [retrieval_preprocessing] calculating distances ...
2025-03-09 07:14:48: [retrieval_preprocessing] finished and saved retrieval indices for episode 17487 [episode count 12/20]
[retrieval_preprocessing] for episode 92250 [episode count 13/20], we have num_retrieval=np.int64(2889) num_query=np.int64(116)
2025-03-09 07:14:49,529 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-09 07:14:49,933 [INFO]: Launching the whole pipeline 03/09/2025, 07:14:49
2025-03-09 07:14:49,933 [INFO]: Reading total number of vectors and dimension 03/09/2025, 07:14:49
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1359.14it/s]
2025-03-09 07:14:49,960 [INFO]: There are 2889 embeddings of dim 49152
2025-03-09 07:14:49,960 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0268 secs
2025-03-09 07:14:49,960 [INFO]: 	Compute estimated construction time of the index 03/09/2025, 07:14:49
2025-03-09 07:14:49,960 [INFO]: 		-> Train: 16.7 minutes
2025-03-09 07:14:49,960 [INFO]: 		-> Add: 1.6 seconds
2025-03-09 07:14:49,960 [INFO]: 		Total: 16.7 minutes
2025-03-09 07:14:49,960 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0001 secs
2025-03-09 07:14:49,960 [INFO]: 	Checking that your have enough memory available to create the index 03/09/2025, 07:14:49
2025-03-09 07:14:49,960 [INFO]: 596.2MB of memory will be needed to build the index (more might be used if you have more)
2025-03-09 07:14:49,960 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0001 secs
2025-03-09 07:14:49,960 [INFO]: 	Selecting most promising index types given data characteristics 03/09/2025, 07:14:49
2025-03-09 07:14:49,960 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-09 07:14:49,960 [INFO]: 	Creating the index 03/09/2025, 07:14:49
2025-03-09 07:14:49,960 [INFO]: 		-> Instanciate the index HNSW15 03/09/2025, 07:14:49
2025-03-09 07:14:49,961 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0008 secs
2025-03-09 07:14:49,961 [INFO]: 		-> Adding the vectors to the index 03/09/2025, 07:14:49
2025-03-09 07:14:49,961 [INFO]: The memory available for adding the vectors is 49.5GB(total available - used by the index)
2025-03-09 07:14:49,961 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/12 [00:00<?, ?it/s]  8%|▊         | 1/12 [00:00<00:01,  6.69it/s] 25%|██▌       | 3/12 [00:00<00:00, 11.75it/s] 42%|████▏     | 5/12 [00:00<00:00, 12.12it/s] 58%|█████▊    | 7/12 [00:00<00:00, 12.29it/s] 75%|███████▌  | 9/12 [00:00<00:00, 11.96it/s] 92%|█████████▏| 11/12 [00:00<00:00, 11.67it/s]100%|██████████| 12/12 [00:02<00:00,  4.22it/s]
2025-03-09 07:14:52,811 [INFO]: 	Computing best hyperparameters for index knn.index 03/09/2025, 07:14:52
2025-03-09 07:15:20,548 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 27.7364 secs
2025-03-09 07:15:20,548 [INFO]: The best hyperparameters are: efSearch=379
2025-03-09 07:15:20,548 [INFO]: 	Compute fast metrics 03/09/2025, 07:15:20
  0%|          | 0/4 [00:00<?, ?it/s] 25%|██▌       | 1/4 [00:00<00:00,  5.87it/s] 75%|███████▌  | 3/4 [00:00<00:00,  8.96it/s] 75%|███████▌  | 3/4 [00:00<00:00,  7.78it/s]
2025-03-09 07:15:33,194 [INFO]: 	>>> Finished "Compute fast metrics" in 12.6453 secs
2025-03-09 07:15:33,196 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 43.2345 secs
2025-03-09 07:15:33,196 [INFO]: {
2025-03-09 07:15:33,196 [INFO]: 	index_key: HNSW15
2025-03-09 07:15:33,196 [INFO]: 	index_param: efSearch=379
2025-03-09 07:15:33,196 [INFO]: 	index_path: knn.index
2025-03-09 07:15:33,196 [INFO]: 	size in bytes: 568392850
2025-03-09 07:15:33,196 [INFO]: 	avg_search_speed_ms: 13.064916128920046
2025-03-09 07:15:33,196 [INFO]: 	99p_search_speed_ms: 25.974987074732827
2025-03-09 07:15:33,196 [INFO]: 	reconstruction error %: 0.0
2025-03-09 07:15:33,196 [INFO]: 	nb vectors: 2889
2025-03-09 07:15:33,196 [INFO]: 	vectors dimension: 49152
2025-03-09 07:15:33,196 [INFO]: 	compression ratio: 0.9993097414930536
2025-03-09 07:15:33,196 [INFO]: }
2025-03-09 07:15:33,196 [INFO]: 	>>> Finished "Creating the index" in 43.2358 secs
2025-03-09 07:15:33,196 [INFO]: >>> Finished "Launching the whole pipeline" in 43.2631 secs
2025-03-09 07:15:34: [retrieval_preprocessing] calculating distances ...
2025-03-09 07:15:35: [retrieval_preprocessing] finished and saved retrieval indices for episode 92250 [episode count 13/20]
[retrieval_preprocessing] for episode 83555 [episode count 14/20], we have num_retrieval=np.int64(2891) num_query=np.int64(114)
2025-03-09 07:15:36,170 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-09 07:15:36,668 [INFO]: Launching the whole pipeline 03/09/2025, 07:15:36
2025-03-09 07:15:36,668 [INFO]: Reading total number of vectors and dimension 03/09/2025, 07:15:36
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1434.93it/s]
2025-03-09 07:15:36,705 [INFO]: There are 2891 embeddings of dim 49152
2025-03-09 07:15:36,705 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0368 secs
2025-03-09 07:15:36,705 [INFO]: 	Compute estimated construction time of the index 03/09/2025, 07:15:36
2025-03-09 07:15:36,705 [INFO]: 		-> Train: 16.7 minutes
2025-03-09 07:15:36,705 [INFO]: 		-> Add: 1.6 seconds
2025-03-09 07:15:36,705 [INFO]: 		Total: 16.7 minutes
2025-03-09 07:15:36,705 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0001 secs
2025-03-09 07:15:36,705 [INFO]: 	Checking that your have enough memory available to create the index 03/09/2025, 07:15:36
2025-03-09 07:15:36,705 [INFO]: 596.6MB of memory will be needed to build the index (more might be used if you have more)
2025-03-09 07:15:36,705 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0002 secs
2025-03-09 07:15:36,705 [INFO]: 	Selecting most promising index types given data characteristics 03/09/2025, 07:15:36
2025-03-09 07:15:36,706 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-09 07:15:36,706 [INFO]: 	Creating the index 03/09/2025, 07:15:36
2025-03-09 07:15:36,706 [INFO]: 		-> Instanciate the index HNSW15 03/09/2025, 07:15:36
2025-03-09 07:15:36,707 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0013 secs
2025-03-09 07:15:36,707 [INFO]: 		-> Adding the vectors to the index 03/09/2025, 07:15:36
2025-03-09 07:15:36,707 [INFO]: The memory available for adding the vectors is 49.5GB(total available - used by the index)
2025-03-09 07:15:36,707 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/12 [00:00<?, ?it/s]  8%|▊         | 1/12 [00:00<00:02,  5.30it/s] 17%|█▋        | 2/12 [00:00<00:01,  6.56it/s] 25%|██▌       | 3/12 [00:00<00:01,  7.07it/s] 33%|███▎      | 4/12 [00:00<00:01,  7.12it/s] 42%|████▏     | 5/12 [00:00<00:00,  7.19it/s] 50%|█████     | 6/12 [00:00<00:00,  7.25it/s] 58%|█████▊    | 7/12 [00:00<00:00,  7.28it/s] 67%|██████▋   | 8/12 [00:01<00:00,  7.31it/s] 83%|████████▎ | 10/12 [00:01<00:00,  8.39it/s] 92%|█████████▏| 11/12 [00:01<00:00,  8.33it/s]100%|██████████| 12/12 [00:03<00:00,  1.64it/s]100%|██████████| 12/12 [00:03<00:00,  3.51it/s]
2025-03-09 07:15:40,126 [INFO]: 	Computing best hyperparameters for index knn.index 03/09/2025, 07:15:40
2025-03-09 07:16:10,698 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 30.5713 secs
2025-03-09 07:16:10,698 [INFO]: The best hyperparameters are: efSearch=346
2025-03-09 07:16:10,698 [INFO]: 	Compute fast metrics 03/09/2025, 07:16:10
  0%|          | 0/4 [00:00<?, ?it/s] 25%|██▌       | 1/4 [00:00<00:00,  5.55it/s] 75%|███████▌  | 3/4 [00:00<00:00,  7.99it/s] 75%|███████▌  | 3/4 [00:00<00:00,  5.99it/s]
2025-03-09 07:16:24,591 [INFO]: 	>>> Finished "Compute fast metrics" in 13.8933 secs
2025-03-09 07:16:24,594 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 47.8865 secs
2025-03-09 07:16:24,594 [INFO]: {
2025-03-09 07:16:24,594 [INFO]: 	index_key: HNSW15
2025-03-09 07:16:24,594 [INFO]: 	index_param: efSearch=346
2025-03-09 07:16:24,594 [INFO]: 	index_path: knn.index
2025-03-09 07:16:24,594 [INFO]: 	size in bytes: 568786330
2025-03-09 07:16:24,594 [INFO]: 	avg_search_speed_ms: 11.582095481032782
2025-03-09 07:16:24,594 [INFO]: 	99p_search_speed_ms: 20.934418903198097
2025-03-09 07:16:24,594 [INFO]: 	reconstruction error %: 0.0
2025-03-09 07:16:24,594 [INFO]: 	nb vectors: 2891
2025-03-09 07:16:24,594 [INFO]: 	vectors dimension: 49152
2025-03-09 07:16:24,594 [INFO]: 	compression ratio: 0.9993097548599665
2025-03-09 07:16:24,594 [INFO]: }
2025-03-09 07:16:24,594 [INFO]: 	>>> Finished "Creating the index" in 47.8883 secs
2025-03-09 07:16:24,594 [INFO]: >>> Finished "Launching the whole pipeline" in 47.9258 secs
2025-03-09 07:16:25: [retrieval_preprocessing] calculating distances ...
2025-03-09 07:16:26: [retrieval_preprocessing] finished and saved retrieval indices for episode 83555 [episode count 14/20]
[retrieval_preprocessing] for episode 84599 [episode count 15/20], we have num_retrieval=np.int64(2825) num_query=np.int64(180)
2025-03-09 07:16:27,346 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-09 07:16:27,823 [INFO]: Launching the whole pipeline 03/09/2025, 07:16:27
2025-03-09 07:16:27,823 [INFO]: Reading total number of vectors and dimension 03/09/2025, 07:16:27
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1288.18it/s]
2025-03-09 07:16:27,851 [INFO]: There are 2825 embeddings of dim 49152
2025-03-09 07:16:27,851 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0276 secs
2025-03-09 07:16:27,851 [INFO]: 	Compute estimated construction time of the index 03/09/2025, 07:16:27
2025-03-09 07:16:27,851 [INFO]: 		-> Train: 16.7 minutes
2025-03-09 07:16:27,851 [INFO]: 		-> Add: 1.6 seconds
2025-03-09 07:16:27,851 [INFO]: 		Total: 16.7 minutes
2025-03-09 07:16:27,851 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0001 secs
2025-03-09 07:16:27,851 [INFO]: 	Checking that your have enough memory available to create the index 03/09/2025, 07:16:27
2025-03-09 07:16:27,851 [INFO]: 583.0MB of memory will be needed to build the index (more might be used if you have more)
2025-03-09 07:16:27,852 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0003 secs
2025-03-09 07:16:27,852 [INFO]: 	Selecting most promising index types given data characteristics 03/09/2025, 07:16:27
2025-03-09 07:16:27,852 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-09 07:16:27,852 [INFO]: 	Creating the index 03/09/2025, 07:16:27
2025-03-09 07:16:27,852 [INFO]: 		-> Instanciate the index HNSW15 03/09/2025, 07:16:27
2025-03-09 07:16:27,853 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0009 secs
2025-03-09 07:16:27,853 [INFO]: 		-> Adding the vectors to the index 03/09/2025, 07:16:27
2025-03-09 07:16:27,853 [INFO]: The memory available for adding the vectors is 49.5GB(total available - used by the index)
2025-03-09 07:16:27,853 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/12 [00:00<?, ?it/s]  8%|▊         | 1/12 [00:00<00:01,  7.10it/s] 17%|█▋        | 2/12 [00:00<00:01,  8.04it/s] 25%|██▌       | 3/12 [00:00<00:01,  8.23it/s] 33%|███▎      | 4/12 [00:00<00:00,  8.33it/s] 42%|████▏     | 5/12 [00:00<00:00,  8.31it/s] 50%|█████     | 6/12 [00:00<00:00,  8.35it/s] 58%|█████▊    | 7/12 [00:00<00:00,  8.48it/s] 67%|██████▋   | 8/12 [00:00<00:00,  8.35it/s] 75%|███████▌  | 9/12 [00:01<00:00,  8.34it/s] 83%|████████▎ | 10/12 [00:01<00:00,  8.35it/s] 92%|█████████▏| 11/12 [00:01<00:00,  8.34it/s]100%|██████████| 12/12 [00:03<00:00,  1.62it/s]100%|██████████| 12/12 [00:03<00:00,  3.89it/s]
2025-03-09 07:16:30,942 [INFO]: 	Computing best hyperparameters for index knn.index 03/09/2025, 07:16:30
2025-03-09 07:16:58,385 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 27.4423 secs
2025-03-09 07:16:58,385 [INFO]: The best hyperparameters are: efSearch=386
2025-03-09 07:16:58,385 [INFO]: 	Compute fast metrics 03/09/2025, 07:16:58
  0%|          | 0/4 [00:00<?, ?it/s] 25%|██▌       | 1/4 [00:00<00:00,  5.86it/s] 75%|███████▌  | 3/4 [00:00<00:00,  9.39it/s] 75%|███████▌  | 3/4 [00:00<00:00,  7.02it/s]
2025-03-09 07:17:10,918 [INFO]: 	>>> Finished "Compute fast metrics" in 12.5331 secs
2025-03-09 07:17:10,920 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 43.0677 secs
2025-03-09 07:17:10,921 [INFO]: {
2025-03-09 07:17:10,921 [INFO]: 	index_key: HNSW15
2025-03-09 07:17:10,921 [INFO]: 	index_param: efSearch=386
2025-03-09 07:17:10,921 [INFO]: 	index_path: knn.index
2025-03-09 07:17:10,921 [INFO]: 	size in bytes: 555801250
2025-03-09 07:17:10,921 [INFO]: 	avg_search_speed_ms: 11.731630213589245
2025-03-09 07:17:10,921 [INFO]: 	99p_search_speed_ms: 21.47382165305318
2025-03-09 07:17:10,921 [INFO]: 	reconstruction error %: 0.0
2025-03-09 07:17:10,921 [INFO]: 	nb vectors: 2825
2025-03-09 07:17:10,921 [INFO]: 	vectors dimension: 49152
2025-03-09 07:17:10,921 [INFO]: 	compression ratio: 0.999309735269577
2025-03-09 07:17:10,921 [INFO]: }
2025-03-09 07:17:10,921 [INFO]: 	>>> Finished "Creating the index" in 43.0691 secs
2025-03-09 07:17:10,921 [INFO]: >>> Finished "Launching the whole pipeline" in 43.0976 secs
2025-03-09 07:17:13: [retrieval_preprocessing] calculating distances ...
2025-03-09 07:17:14: [retrieval_preprocessing] finished and saved retrieval indices for episode 84599 [episode count 15/20]
[retrieval_preprocessing] for episode 81016 [episode count 16/20], we have num_retrieval=np.int64(2888) num_query=np.int64(117)
2025-03-09 07:17:14,912 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-09 07:17:15,326 [INFO]: Launching the whole pipeline 03/09/2025, 07:17:15
2025-03-09 07:17:15,326 [INFO]: Reading total number of vectors and dimension 03/09/2025, 07:17:15
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 891.27it/s]
2025-03-09 07:17:15,355 [INFO]: There are 2888 embeddings of dim 49152
2025-03-09 07:17:15,356 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0300 secs
2025-03-09 07:17:15,356 [INFO]: 	Compute estimated construction time of the index 03/09/2025, 07:17:15
2025-03-09 07:17:15,356 [INFO]: 		-> Train: 16.7 minutes
2025-03-09 07:17:15,356 [INFO]: 		-> Add: 1.6 seconds
2025-03-09 07:17:15,356 [INFO]: 		Total: 16.7 minutes
2025-03-09 07:17:15,356 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0003 secs
2025-03-09 07:17:15,357 [INFO]: 	Checking that your have enough memory available to create the index 03/09/2025, 07:17:15
2025-03-09 07:17:15,357 [INFO]: 596.0MB of memory will be needed to build the index (more might be used if you have more)
2025-03-09 07:17:15,357 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0005 secs
2025-03-09 07:17:15,357 [INFO]: 	Selecting most promising index types given data characteristics 03/09/2025, 07:17:15
2025-03-09 07:17:15,357 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-09 07:17:15,357 [INFO]: 	Creating the index 03/09/2025, 07:17:15
2025-03-09 07:17:15,358 [INFO]: 		-> Instanciate the index HNSW15 03/09/2025, 07:17:15
2025-03-09 07:17:15,360 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0027 secs
2025-03-09 07:17:15,360 [INFO]: 		-> Adding the vectors to the index 03/09/2025, 07:17:15
2025-03-09 07:17:15,361 [INFO]: The memory available for adding the vectors is 49.5GB(total available - used by the index)
2025-03-09 07:17:15,361 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/12 [00:00<?, ?it/s]  8%|▊         | 1/12 [00:00<00:01,  5.97it/s] 25%|██▌       | 3/12 [00:00<00:01,  8.73it/s] 33%|███▎      | 4/12 [00:00<00:00,  9.12it/s] 42%|████▏     | 5/12 [00:00<00:00,  9.39it/s] 58%|█████▊    | 7/12 [00:00<00:00,  9.73it/s] 75%|███████▌  | 9/12 [00:00<00:00,  9.92it/s] 83%|████████▎ | 10/12 [00:01<00:00,  9.88it/s] 92%|█████████▏| 11/12 [00:01<00:00,  9.82it/s]100%|██████████| 12/12 [00:03<00:00,  1.72it/s]100%|██████████| 12/12 [00:03<00:00,  3.84it/s]
2025-03-09 07:17:18,488 [INFO]: 	Computing best hyperparameters for index knn.index 03/09/2025, 07:17:18
2025-03-09 07:17:45,481 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 26.9924 secs
2025-03-09 07:17:45,481 [INFO]: The best hyperparameters are: efSearch=239
2025-03-09 07:17:45,481 [INFO]: 	Compute fast metrics 03/09/2025, 07:17:45
  0%|          | 0/4 [00:00<?, ?it/s] 25%|██▌       | 1/4 [00:00<00:00,  5.25it/s] 50%|█████     | 2/4 [00:00<00:00,  6.82it/s] 75%|███████▌  | 3/4 [00:00<00:00,  7.62it/s] 75%|███████▌  | 3/4 [00:00<00:00,  5.70it/s]
2025-03-09 07:17:58,432 [INFO]: 	>>> Finished "Compute fast metrics" in 12.9511 secs
2025-03-09 07:17:58,434 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 43.0737 secs
2025-03-09 07:17:58,434 [INFO]: {
2025-03-09 07:17:58,434 [INFO]: 	index_key: HNSW15
2025-03-09 07:17:58,434 [INFO]: 	index_param: efSearch=239
2025-03-09 07:17:58,435 [INFO]: 	index_path: knn.index
2025-03-09 07:17:58,435 [INFO]: 	size in bytes: 568196110
2025-03-09 07:17:58,435 [INFO]: 	avg_search_speed_ms: 9.253746547342505
2025-03-09 07:17:58,435 [INFO]: 	99p_search_speed_ms: 16.11890029162173
2025-03-09 07:17:58,435 [INFO]: 	reconstruction error %: 0.0
2025-03-09 07:17:58,435 [INFO]: 	nb vectors: 2888
2025-03-09 07:17:58,435 [INFO]: 	vectors dimension: 49152
2025-03-09 07:17:58,435 [INFO]: 	compression ratio: 0.9993097348026546
2025-03-09 07:17:58,435 [INFO]: }
2025-03-09 07:17:58,435 [INFO]: 	>>> Finished "Creating the index" in 43.0772 secs
2025-03-09 07:17:58,435 [INFO]: >>> Finished "Launching the whole pipeline" in 43.1089 secs
2025-03-09 07:17:59: [retrieval_preprocessing] calculating distances ...
2025-03-09 07:17:59: [retrieval_preprocessing] finished and saved retrieval indices for episode 81016 [episode count 16/20]
[retrieval_preprocessing] for episode 33916 [episode count 17/20], we have num_retrieval=np.int64(2898) num_query=np.int64(107)
2025-03-09 07:18:00,389 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-09 07:18:00,794 [INFO]: Launching the whole pipeline 03/09/2025, 07:18:00
2025-03-09 07:18:00,794 [INFO]: Reading total number of vectors and dimension 03/09/2025, 07:18:00
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1529.09it/s]
2025-03-09 07:18:00,819 [INFO]: There are 2898 embeddings of dim 49152
2025-03-09 07:18:00,819 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0251 secs
2025-03-09 07:18:00,820 [INFO]: 	Compute estimated construction time of the index 03/09/2025, 07:18:00
2025-03-09 07:18:00,820 [INFO]: 		-> Train: 16.7 minutes
2025-03-09 07:18:00,820 [INFO]: 		-> Add: 1.6 seconds
2025-03-09 07:18:00,820 [INFO]: 		Total: 16.7 minutes
2025-03-09 07:18:00,820 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0001 secs
2025-03-09 07:18:00,820 [INFO]: 	Checking that your have enough memory available to create the index 03/09/2025, 07:18:00
2025-03-09 07:18:00,820 [INFO]: 598.1MB of memory will be needed to build the index (more might be used if you have more)
2025-03-09 07:18:00,820 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0001 secs
2025-03-09 07:18:00,820 [INFO]: 	Selecting most promising index types given data characteristics 03/09/2025, 07:18:00
2025-03-09 07:18:00,820 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-09 07:18:00,820 [INFO]: 	Creating the index 03/09/2025, 07:18:00
2025-03-09 07:18:00,820 [INFO]: 		-> Instanciate the index HNSW15 03/09/2025, 07:18:00
2025-03-09 07:18:00,821 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0010 secs
2025-03-09 07:18:00,821 [INFO]: 		-> Adding the vectors to the index 03/09/2025, 07:18:00
2025-03-09 07:18:00,821 [INFO]: The memory available for adding the vectors is 49.5GB(total available - used by the index)
2025-03-09 07:18:00,821 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/12 [00:00<?, ?it/s]  8%|▊         | 1/12 [00:00<00:02,  5.40it/s] 25%|██▌       | 3/12 [00:00<00:00,  9.00it/s] 42%|████▏     | 5/12 [00:00<00:00, 10.12it/s] 58%|█████▊    | 7/12 [00:00<00:00, 10.66it/s] 75%|███████▌  | 9/12 [00:00<00:00, 10.99it/s] 92%|█████████▏| 11/12 [00:01<00:00, 11.17it/s]100%|██████████| 12/12 [00:02<00:00,  4.15it/s]
2025-03-09 07:18:03,716 [INFO]: 	Computing best hyperparameters for index knn.index 03/09/2025, 07:18:03
2025-03-09 07:18:33,277 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 29.5602 secs
2025-03-09 07:18:33,277 [INFO]: The best hyperparameters are: efSearch=391
2025-03-09 07:18:33,277 [INFO]: 	Compute fast metrics 03/09/2025, 07:18:33
  0%|          | 0/4 [00:00<?, ?it/s] 25%|██▌       | 1/4 [00:00<00:00,  7.76it/s] 75%|███████▌  | 3/4 [00:00<00:00, 10.42it/s] 75%|███████▌  | 3/4 [00:00<00:00,  8.30it/s]
2025-03-09 07:18:45,878 [INFO]: 	>>> Finished "Compute fast metrics" in 12.6012 secs
2025-03-09 07:18:45,880 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 45.0593 secs
2025-03-09 07:18:45,880 [INFO]: {
2025-03-09 07:18:45,880 [INFO]: 	index_key: HNSW15
2025-03-09 07:18:45,880 [INFO]: 	index_param: efSearch=391
2025-03-09 07:18:45,881 [INFO]: 	index_path: knn.index
2025-03-09 07:18:45,881 [INFO]: 	size in bytes: 570163510
2025-03-09 07:18:45,881 [INFO]: 	avg_search_speed_ms: 11.280920299551248
2025-03-09 07:18:45,881 [INFO]: 	99p_search_speed_ms: 16.241616606712338
2025-03-09 07:18:45,881 [INFO]: 	reconstruction error %: 0.0
2025-03-09 07:18:45,881 [INFO]: 	nb vectors: 2898
2025-03-09 07:18:45,881 [INFO]: 	vectors dimension: 49152
2025-03-09 07:18:45,881 [INFO]: 	compression ratio: 0.9993098014988718
2025-03-09 07:18:45,881 [INFO]: }
2025-03-09 07:18:45,881 [INFO]: 	>>> Finished "Creating the index" in 45.0607 secs
2025-03-09 07:18:45,881 [INFO]: >>> Finished "Launching the whole pipeline" in 45.0863 secs
2025-03-09 07:18:47: [retrieval_preprocessing] calculating distances ...
2025-03-09 07:18:47: [retrieval_preprocessing] finished and saved retrieval indices for episode 33916 [episode count 17/20]
[retrieval_preprocessing] for episode 9341 [episode count 18/20], we have num_retrieval=np.int64(2854) num_query=np.int64(151)
2025-03-09 07:18:48,510 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-09 07:18:48,870 [INFO]: Launching the whole pipeline 03/09/2025, 07:18:48
2025-03-09 07:18:48,870 [INFO]: Reading total number of vectors and dimension 03/09/2025, 07:18:48
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1323.12it/s]
2025-03-09 07:18:48,894 [INFO]: There are 2854 embeddings of dim 49152
2025-03-09 07:18:48,894 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0243 secs
2025-03-09 07:18:48,894 [INFO]: 	Compute estimated construction time of the index 03/09/2025, 07:18:48
2025-03-09 07:18:48,894 [INFO]: 		-> Train: 16.7 minutes
2025-03-09 07:18:48,894 [INFO]: 		-> Add: 1.6 seconds
2025-03-09 07:18:48,894 [INFO]: 		Total: 16.7 minutes
2025-03-09 07:18:48,894 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0001 secs
2025-03-09 07:18:48,894 [INFO]: 	Checking that your have enough memory available to create the index 03/09/2025, 07:18:48
2025-03-09 07:18:48,894 [INFO]: 589.0MB of memory will be needed to build the index (more might be used if you have more)
2025-03-09 07:18:48,894 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0001 secs
2025-03-09 07:18:48,894 [INFO]: 	Selecting most promising index types given data characteristics 03/09/2025, 07:18:48
2025-03-09 07:18:48,894 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-09 07:18:48,894 [INFO]: 	Creating the index 03/09/2025, 07:18:48
2025-03-09 07:18:48,894 [INFO]: 		-> Instanciate the index HNSW15 03/09/2025, 07:18:48
2025-03-09 07:18:48,895 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0009 secs
2025-03-09 07:18:48,896 [INFO]: 		-> Adding the vectors to the index 03/09/2025, 07:18:48
2025-03-09 07:18:48,896 [INFO]: The memory available for adding the vectors is 49.5GB(total available - used by the index)
2025-03-09 07:18:48,896 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/12 [00:00<?, ?it/s]  8%|▊         | 1/12 [00:00<00:02,  5.41it/s] 17%|█▋        | 2/12 [00:00<00:01,  6.88it/s] 25%|██▌       | 3/12 [00:00<00:01,  7.51it/s] 33%|███▎      | 4/12 [00:00<00:01,  7.86it/s] 42%|████▏     | 5/12 [00:00<00:00,  8.21it/s] 50%|█████     | 6/12 [00:00<00:00,  8.31it/s] 58%|█████▊    | 7/12 [00:00<00:00,  8.46it/s] 67%|██████▋   | 8/12 [00:00<00:00,  8.49it/s] 75%|███████▌  | 9/12 [00:01<00:00,  8.52it/s] 83%|████████▎ | 10/12 [00:01<00:00,  8.61it/s] 92%|█████████▏| 11/12 [00:01<00:00,  8.61it/s]100%|██████████| 12/12 [00:03<00:00,  1.69it/s]100%|██████████| 12/12 [00:03<00:00,  3.97it/s]
2025-03-09 07:18:51,924 [INFO]: 	Computing best hyperparameters for index knn.index 03/09/2025, 07:18:51
2025-03-09 07:19:18,434 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 26.5095 secs
2025-03-09 07:19:18,434 [INFO]: The best hyperparameters are: efSearch=377
2025-03-09 07:19:18,434 [INFO]: 	Compute fast metrics 03/09/2025, 07:19:18
  0%|          | 0/4 [00:00<?, ?it/s] 25%|██▌       | 1/4 [00:00<00:00,  5.03it/s] 50%|█████     | 2/4 [00:00<00:00,  6.64it/s] 75%|███████▌  | 3/4 [00:00<00:00,  7.31it/s] 75%|███████▌  | 3/4 [00:00<00:00,  5.48it/s]
2025-03-09 07:19:31,497 [INFO]: 	>>> Finished "Compute fast metrics" in 13.0629 secs
2025-03-09 07:19:31,500 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 42.6039 secs
2025-03-09 07:19:31,500 [INFO]: {
2025-03-09 07:19:31,500 [INFO]: 	index_key: HNSW15
2025-03-09 07:19:31,500 [INFO]: 	index_param: efSearch=377
2025-03-09 07:19:31,500 [INFO]: 	index_path: knn.index
2025-03-09 07:19:31,500 [INFO]: 	size in bytes: 561506830
2025-03-09 07:19:31,500 [INFO]: 	avg_search_speed_ms: 11.618337290562716
2025-03-09 07:19:31,500 [INFO]: 	99p_search_speed_ms: 18.578392127528783
2025-03-09 07:19:31,500 [INFO]: 	reconstruction error %: 0.0
2025-03-09 07:19:31,500 [INFO]: 	nb vectors: 2854
2025-03-09 07:19:31,500 [INFO]: 	vectors dimension: 49152
2025-03-09 07:19:31,500 [INFO]: 	compression ratio: 0.9993097181026276
2025-03-09 07:19:31,500 [INFO]: }
2025-03-09 07:19:31,500 [INFO]: 	>>> Finished "Creating the index" in 42.6054 secs
2025-03-09 07:19:31,500 [INFO]: >>> Finished "Launching the whole pipeline" in 42.6302 secs
2025-03-09 07:19:33: [retrieval_preprocessing] calculating distances ...
2025-03-09 07:19:33: [retrieval_preprocessing] finished and saved retrieval indices for episode 9341 [episode count 18/20]
[retrieval_preprocessing] for episode 59518 [episode count 19/20], we have num_retrieval=np.int64(2917) num_query=np.int64(88)
2025-03-09 07:19:34,879 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-09 07:19:35,290 [INFO]: Launching the whole pipeline 03/09/2025, 07:19:35
2025-03-09 07:19:35,290 [INFO]: Reading total number of vectors and dimension 03/09/2025, 07:19:35
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1049.63it/s]
2025-03-09 07:19:35,315 [INFO]: There are 2917 embeddings of dim 49152
2025-03-09 07:19:35,316 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0258 secs
2025-03-09 07:19:35,316 [INFO]: 	Compute estimated construction time of the index 03/09/2025, 07:19:35
2025-03-09 07:19:35,316 [INFO]: 		-> Train: 16.7 minutes
2025-03-09 07:19:35,316 [INFO]: 		-> Add: 1.6 seconds
2025-03-09 07:19:35,316 [INFO]: 		Total: 16.7 minutes
2025-03-09 07:19:35,316 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0001 secs
2025-03-09 07:19:35,316 [INFO]: 	Checking that your have enough memory available to create the index 03/09/2025, 07:19:35
2025-03-09 07:19:35,316 [INFO]: 602.0MB of memory will be needed to build the index (more might be used if you have more)
2025-03-09 07:19:35,316 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0001 secs
2025-03-09 07:19:35,316 [INFO]: 	Selecting most promising index types given data characteristics 03/09/2025, 07:19:35
2025-03-09 07:19:35,316 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-09 07:19:35,316 [INFO]: 	Creating the index 03/09/2025, 07:19:35
2025-03-09 07:19:35,316 [INFO]: 		-> Instanciate the index HNSW15 03/09/2025, 07:19:35
2025-03-09 07:19:35,317 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0010 secs
2025-03-09 07:19:35,317 [INFO]: 		-> Adding the vectors to the index 03/09/2025, 07:19:35
2025-03-09 07:19:35,317 [INFO]: The memory available for adding the vectors is 49.5GB(total available - used by the index)
2025-03-09 07:19:35,317 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/12 [00:00<?, ?it/s]  8%|▊         | 1/12 [00:00<00:01,  6.05it/s] 17%|█▋        | 2/12 [00:00<00:01,  7.12it/s] 25%|██▌       | 3/12 [00:00<00:01,  7.66it/s] 33%|███▎      | 4/12 [00:00<00:01,  7.82it/s] 42%|████▏     | 5/12 [00:00<00:00,  8.10it/s] 50%|█████     | 6/12 [00:00<00:00,  8.06it/s] 58%|█████▊    | 7/12 [00:00<00:00,  8.21it/s] 67%|██████▋   | 8/12 [00:01<00:00,  8.17it/s] 75%|███████▌  | 9/12 [00:01<00:00,  8.20it/s] 92%|█████████▏| 11/12 [00:01<00:00,  9.63it/s]100%|██████████| 12/12 [00:03<00:00,  1.69it/s]100%|██████████| 12/12 [00:03<00:00,  3.59it/s]
2025-03-09 07:19:38,661 [INFO]: 	Computing best hyperparameters for index knn.index 03/09/2025, 07:19:38
2025-03-09 07:20:07,175 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 28.5140 secs
2025-03-09 07:20:07,175 [INFO]: The best hyperparameters are: efSearch=391
2025-03-09 07:20:07,175 [INFO]: 	Compute fast metrics 03/09/2025, 07:20:07
  0%|          | 0/4 [00:00<?, ?it/s] 25%|██▌       | 1/4 [00:00<00:00,  5.62it/s] 75%|███████▌  | 3/4 [00:00<00:00,  9.18it/s] 75%|███████▌  | 3/4 [00:00<00:00,  7.02it/s]
2025-03-09 07:20:19,814 [INFO]: 	>>> Finished "Compute fast metrics" in 12.6387 secs
2025-03-09 07:20:19,817 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 44.4997 secs
2025-03-09 07:20:19,817 [INFO]: {
2025-03-09 07:20:19,817 [INFO]: 	index_key: HNSW15
2025-03-09 07:20:19,817 [INFO]: 	index_param: efSearch=391
2025-03-09 07:20:19,817 [INFO]: 	index_path: knn.index
2025-03-09 07:20:19,817 [INFO]: 	size in bytes: 573901630
2025-03-09 07:20:19,817 [INFO]: 	avg_search_speed_ms: 11.665803993766303
2025-03-09 07:20:19,817 [INFO]: 	99p_search_speed_ms: 17.997491983696804
2025-03-09 07:20:19,817 [INFO]: 	reconstruction error %: 0.0
2025-03-09 07:20:19,817 [INFO]: 	nb vectors: 2917
2025-03-09 07:20:19,817 [INFO]: 	vectors dimension: 49152
2025-03-09 07:20:19,817 [INFO]: 	compression ratio: 0.9993098224864774
2025-03-09 07:20:19,817 [INFO]: }
2025-03-09 07:20:19,817 [INFO]: 	>>> Finished "Creating the index" in 44.5011 secs
2025-03-09 07:20:19,817 [INFO]: >>> Finished "Launching the whole pipeline" in 44.5274 secs
2025-03-09 07:20:21: [retrieval_preprocessing] calculating distances ...
2025-03-09 07:20:21: [retrieval_preprocessing] finished and saved retrieval indices for episode 59518 [episode count 19/20]
2025-03-09 07:20:21: [retrieval_preprocessing] finished for (3816161570, 'drawer') [chosen_id count 1/10]
2025-03-09 07:20:24: [retrieval_preprocessing] concatenated all embeddings and indices for 20 episodes for (5511329841, 'marker') [chosen_id count 2/10]
2025-03-09 07:20:24: [retrieval_preprocessing] we have num_total=5267 embedding_dim=49152
[retrieval_preprocessing] for episode 69249 [episode count 0/20], we have num_retrieval=np.int64(5043) num_query=np.int64(224)
2025-03-09 07:20:26,462 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-09 07:20:27,196 [INFO]: Launching the whole pipeline 03/09/2025, 07:20:27
2025-03-09 07:20:27,196 [INFO]: Reading total number of vectors and dimension 03/09/2025, 07:20:27
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1543.73it/s]
2025-03-09 07:20:27,221 [INFO]: There are 5043 embeddings of dim 49152
2025-03-09 07:20:27,221 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0248 secs
2025-03-09 07:20:27,221 [INFO]: 	Compute estimated construction time of the index 03/09/2025, 07:20:27
2025-03-09 07:20:27,221 [INFO]: 		-> Train: 16.7 minutes
2025-03-09 07:20:27,221 [INFO]: 		-> Add: 2.8 seconds
2025-03-09 07:20:27,221 [INFO]: 		Total: 16.7 minutes
2025-03-09 07:20:27,221 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0001 secs
2025-03-09 07:20:27,221 [INFO]: 	Checking that your have enough memory available to create the index 03/09/2025, 07:20:27
2025-03-09 07:20:27,221 [INFO]: 1.0GB of memory will be needed to build the index (more might be used if you have more)
2025-03-09 07:20:27,221 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0002 secs
2025-03-09 07:20:27,221 [INFO]: 	Selecting most promising index types given data characteristics 03/09/2025, 07:20:27
2025-03-09 07:20:27,221 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-09 07:20:27,221 [INFO]: 	Creating the index 03/09/2025, 07:20:27
2025-03-09 07:20:27,222 [INFO]: 		-> Instanciate the index HNSW15 03/09/2025, 07:20:27
2025-03-09 07:20:27,223 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0011 secs
2025-03-09 07:20:27,223 [INFO]: 		-> Adding the vectors to the index 03/09/2025, 07:20:27
2025-03-09 07:20:27,223 [INFO]: The memory available for adding the vectors is 49.1GB(total available - used by the index)
2025-03-09 07:20:27,223 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/20 [00:00<?, ?it/s]  5%|▌         | 1/20 [00:00<00:03,  5.26it/s] 15%|█▌        | 3/20 [00:00<00:01,  8.71it/s] 25%|██▌       | 5/20 [00:00<00:01,  9.93it/s] 35%|███▌      | 7/20 [00:00<00:01, 10.78it/s] 45%|████▌     | 9/20 [00:00<00:00, 11.34it/s] 55%|█████▌    | 11/20 [00:00<00:00, 12.63it/s] 65%|██████▌   | 13/20 [00:01<00:00, 13.85it/s] 75%|███████▌  | 15/20 [00:01<00:00, 14.61it/s] 85%|████████▌ | 17/20 [00:01<00:00, 14.92it/s] 95%|█████████▌| 19/20 [00:01<00:00, 15.23it/s]100%|██████████| 20/20 [00:04<00:00,  4.40it/s]
2025-03-09 07:20:31,777 [INFO]: 	Computing best hyperparameters for index knn.index 03/09/2025, 07:20:31
2025-03-09 07:21:13,728 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 41.9512 secs
2025-03-09 07:21:13,729 [INFO]: The best hyperparameters are: efSearch=257
2025-03-09 07:21:13,729 [INFO]: 	Compute fast metrics 03/09/2025, 07:21:13
  0%|          | 0/4 [00:00<?, ?it/s] 25%|██▌       | 1/4 [00:00<00:00,  6.18it/s] 50%|█████     | 2/4 [00:00<00:00,  7.84it/s] 75%|███████▌  | 3/4 [00:00<00:00,  8.22it/s] 75%|███████▌  | 3/4 [00:00<00:00,  6.09it/s]
2025-03-09 07:21:28,992 [INFO]: 	>>> Finished "Compute fast metrics" in 15.2636 secs
2025-03-09 07:21:28,996 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 61.7731 secs
2025-03-09 07:21:28,996 [INFO]: {
2025-03-09 07:21:28,996 [INFO]: 	index_key: HNSW15
2025-03-09 07:21:28,996 [INFO]: 	index_param: efSearch=257
2025-03-09 07:21:28,996 [INFO]: 	index_path: knn.index
2025-03-09 07:21:28,996 [INFO]: 	size in bytes: 992180290
2025-03-09 07:21:28,996 [INFO]: 	avg_search_speed_ms: 10.725732054861158
2025-03-09 07:21:28,996 [INFO]: 	99p_search_speed_ms: 18.091580688487735
2025-03-09 07:21:28,996 [INFO]: 	reconstruction error %: 0.0
2025-03-09 07:21:28,996 [INFO]: 	nb vectors: 5043
2025-03-09 07:21:28,996 [INFO]: 	vectors dimension: 49152
2025-03-09 07:21:28,996 [INFO]: 	compression ratio: 0.9993084462502274
2025-03-09 07:21:28,996 [INFO]: }
2025-03-09 07:21:28,996 [INFO]: 	>>> Finished "Creating the index" in 61.7746 secs
2025-03-09 07:21:28,996 [INFO]: >>> Finished "Launching the whole pipeline" in 61.8001 secs
2025-03-09 07:21:30: [retrieval_preprocessing] calculating distances ...
2025-03-09 07:21:31: [retrieval_preprocessing] finished and saved retrieval indices for episode 69249 [episode count 0/20]
[retrieval_preprocessing] for episode 50821 [episode count 1/20], we have num_retrieval=np.int64(4910) num_query=np.int64(357)
2025-03-09 07:21:32,734 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-09 07:21:33,520 [INFO]: Launching the whole pipeline 03/09/2025, 07:21:33
2025-03-09 07:21:33,521 [INFO]: Reading total number of vectors and dimension 03/09/2025, 07:21:33
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1530.77it/s]
2025-03-09 07:21:33,546 [INFO]: There are 4910 embeddings of dim 49152
2025-03-09 07:21:33,546 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0254 secs
2025-03-09 07:21:33,546 [INFO]: 	Compute estimated construction time of the index 03/09/2025, 07:21:33
2025-03-09 07:21:33,546 [INFO]: 		-> Train: 16.7 minutes
2025-03-09 07:21:33,546 [INFO]: 		-> Add: 2.7 seconds
2025-03-09 07:21:33,546 [INFO]: 		Total: 16.7 minutes
2025-03-09 07:21:33,546 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0001 secs
2025-03-09 07:21:33,546 [INFO]: 	Checking that your have enough memory available to create the index 03/09/2025, 07:21:33
2025-03-09 07:21:33,547 [INFO]: 1013.3MB of memory will be needed to build the index (more might be used if you have more)
2025-03-09 07:21:33,547 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0002 secs
2025-03-09 07:21:33,547 [INFO]: 	Selecting most promising index types given data characteristics 03/09/2025, 07:21:33
2025-03-09 07:21:33,547 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-09 07:21:33,547 [INFO]: 	Creating the index 03/09/2025, 07:21:33
2025-03-09 07:21:33,547 [INFO]: 		-> Instanciate the index HNSW15 03/09/2025, 07:21:33
2025-03-09 07:21:33,548 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0012 secs
2025-03-09 07:21:33,548 [INFO]: 		-> Adding the vectors to the index 03/09/2025, 07:21:33
2025-03-09 07:21:33,548 [INFO]: The memory available for adding the vectors is 49.1GB(total available - used by the index)
2025-03-09 07:21:33,548 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/20 [00:00<?, ?it/s]  5%|▌         | 1/20 [00:00<00:03,  6.19it/s] 15%|█▌        | 3/20 [00:00<00:01, 10.19it/s] 25%|██▌       | 5/20 [00:00<00:01, 11.59it/s] 35%|███▌      | 7/20 [00:00<00:01, 12.07it/s] 45%|████▌     | 9/20 [00:00<00:00, 12.07it/s] 55%|█████▌    | 11/20 [00:00<00:00, 11.71it/s] 65%|██████▌   | 13/20 [00:01<00:00, 11.44it/s] 75%|███████▌  | 15/20 [00:01<00:00, 11.17it/s] 85%|████████▌ | 17/20 [00:01<00:00, 10.91it/s] 95%|█████████▌| 19/20 [00:01<00:00, 10.69it/s]100%|██████████| 20/20 [00:05<00:00,  3.69it/s]
2025-03-09 07:21:38,968 [INFO]: 	Computing best hyperparameters for index knn.index 03/09/2025, 07:21:38
2025-03-09 07:22:21,610 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 42.6414 secs
2025-03-09 07:22:21,610 [INFO]: The best hyperparameters are: efSearch=174
2025-03-09 07:22:21,610 [INFO]: 	Compute fast metrics 03/09/2025, 07:22:21
  0%|          | 0/4 [00:00<?, ?it/s] 25%|██▌       | 1/4 [00:00<00:00,  5.81it/s] 75%|███████▌  | 3/4 [00:00<00:00,  9.39it/s] 75%|███████▌  | 3/4 [00:00<00:00,  7.15it/s]
2025-03-09 07:22:34,943 [INFO]: 	>>> Finished "Compute fast metrics" in 13.3332 secs
2025-03-09 07:22:34,947 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 61.3986 secs
2025-03-09 07:22:34,947 [INFO]: {
2025-03-09 07:22:34,947 [INFO]: 	index_key: HNSW15
2025-03-09 07:22:34,947 [INFO]: 	index_param: efSearch=174
2025-03-09 07:22:34,947 [INFO]: 	index_path: knn.index
2025-03-09 07:22:34,947 [INFO]: 	size in bytes: 966013030
2025-03-09 07:22:34,947 [INFO]: 	avg_search_speed_ms: 7.5953583139996965
2025-03-09 07:22:34,947 [INFO]: 	99p_search_speed_ms: 13.940945337526495
2025-03-09 07:22:34,947 [INFO]: 	reconstruction error %: 0.0
2025-03-09 07:22:34,947 [INFO]: 	nb vectors: 4910
2025-03-09 07:22:34,947 [INFO]: 	vectors dimension: 49152
2025-03-09 07:22:34,947 [INFO]: 	compression ratio: 0.999308756735921
2025-03-09 07:22:34,947 [INFO]: }
2025-03-09 07:22:34,947 [INFO]: 	>>> Finished "Creating the index" in 61.4005 secs
2025-03-09 07:22:34,947 [INFO]: >>> Finished "Launching the whole pipeline" in 61.4267 secs
2025-03-09 07:22:36: [retrieval_preprocessing] calculating distances ...
2025-03-09 07:22:37: [retrieval_preprocessing] finished and saved retrieval indices for episode 50821 [episode count 1/20]
[retrieval_preprocessing] for episode 71815 [episode count 2/20], we have num_retrieval=np.int64(4922) num_query=np.int64(345)
2025-03-09 07:22:37,959 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-09 07:22:38,741 [INFO]: Launching the whole pipeline 03/09/2025, 07:22:38
2025-03-09 07:22:38,741 [INFO]: Reading total number of vectors and dimension 03/09/2025, 07:22:38
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1410.32it/s]
2025-03-09 07:22:38,773 [INFO]: There are 4922 embeddings of dim 49152
2025-03-09 07:22:38,773 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0321 secs
2025-03-09 07:22:38,773 [INFO]: 	Compute estimated construction time of the index 03/09/2025, 07:22:38
2025-03-09 07:22:38,773 [INFO]: 		-> Train: 16.7 minutes
2025-03-09 07:22:38,773 [INFO]: 		-> Add: 2.7 seconds
2025-03-09 07:22:38,773 [INFO]: 		Total: 16.7 minutes
2025-03-09 07:22:38,773 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0001 secs
2025-03-09 07:22:38,773 [INFO]: 	Checking that your have enough memory available to create the index 03/09/2025, 07:22:38
2025-03-09 07:22:38,773 [INFO]: 1015.8MB of memory will be needed to build the index (more might be used if you have more)
2025-03-09 07:22:38,773 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0002 secs
2025-03-09 07:22:38,773 [INFO]: 	Selecting most promising index types given data characteristics 03/09/2025, 07:22:38
2025-03-09 07:22:38,773 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-09 07:22:38,773 [INFO]: 	Creating the index 03/09/2025, 07:22:38
2025-03-09 07:22:38,773 [INFO]: 		-> Instanciate the index HNSW15 03/09/2025, 07:22:38
2025-03-09 07:22:38,775 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0011 secs
2025-03-09 07:22:38,775 [INFO]: 		-> Adding the vectors to the index 03/09/2025, 07:22:38
2025-03-09 07:22:38,775 [INFO]: The memory available for adding the vectors is 49.1GB(total available - used by the index)
2025-03-09 07:22:38,775 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/20 [00:00<?, ?it/s]  5%|▌         | 1/20 [00:00<00:02,  8.33it/s] 30%|███       | 6/20 [00:00<00:00, 29.49it/s] 55%|█████▌    | 11/20 [00:00<00:00, 37.50it/s] 75%|███████▌  | 15/20 [00:00<00:00, 36.96it/s]100%|██████████| 20/20 [00:04<00:00,  2.77it/s]100%|██████████| 20/20 [00:04<00:00,  4.30it/s]
2025-03-09 07:22:43,436 [INFO]: 	Computing best hyperparameters for index knn.index 03/09/2025, 07:22:43
2025-03-09 07:23:32,888 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 49.4521 secs
2025-03-09 07:23:32,889 [INFO]: The best hyperparameters are: efSearch=176
2025-03-09 07:23:32,889 [INFO]: 	Compute fast metrics 03/09/2025, 07:23:32
  0%|          | 0/4 [00:00<?, ?it/s] 25%|██▌       | 1/4 [00:00<00:00,  5.18it/s] 50%|█████     | 2/4 [00:00<00:00,  7.06it/s] 75%|███████▌  | 3/4 [00:00<00:00,  8.09it/s] 75%|███████▌  | 3/4 [00:00<00:00,  5.98it/s]
2025-03-09 07:23:46,534 [INFO]: 	>>> Finished "Compute fast metrics" in 13.6445 secs
2025-03-09 07:23:46,542 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 67.7668 secs
2025-03-09 07:23:46,542 [INFO]: {
2025-03-09 07:23:46,542 [INFO]: 	index_key: HNSW15
2025-03-09 07:23:46,542 [INFO]: 	index_param: efSearch=176
2025-03-09 07:23:46,542 [INFO]: 	index_path: knn.index
2025-03-09 07:23:46,542 [INFO]: 	size in bytes: 968373970
2025-03-09 07:23:46,542 [INFO]: 	avg_search_speed_ms: 9.387054064312835
2025-03-09 07:23:46,542 [INFO]: 	99p_search_speed_ms: 17.026240483392016
2025-03-09 07:23:46,542 [INFO]: 	reconstruction error %: 0.0
2025-03-09 07:23:46,542 [INFO]: 	nb vectors: 4922
2025-03-09 07:23:46,542 [INFO]: 	vectors dimension: 49152
2025-03-09 07:23:46,542 [INFO]: 	compression ratio: 0.9993087443273594
2025-03-09 07:23:46,542 [INFO]: }
2025-03-09 07:23:46,542 [INFO]: 	>>> Finished "Creating the index" in 67.7687 secs
2025-03-09 07:23:46,542 [INFO]: >>> Finished "Launching the whole pipeline" in 67.8014 secs
2025-03-09 07:23:48: [retrieval_preprocessing] calculating distances ...
2025-03-09 07:23:50: [retrieval_preprocessing] finished and saved retrieval indices for episode 71815 [episode count 2/20]
[retrieval_preprocessing] for episode 24200 [episode count 3/20], we have num_retrieval=np.int64(5020) num_query=np.int64(247)
2025-03-09 07:23:50,779 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-09 07:23:51,510 [INFO]: Launching the whole pipeline 03/09/2025, 07:23:51
2025-03-09 07:23:51,510 [INFO]: Reading total number of vectors and dimension 03/09/2025, 07:23:51
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1385.63it/s]
2025-03-09 07:23:51,554 [INFO]: There are 5020 embeddings of dim 49152
2025-03-09 07:23:51,554 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0439 secs
2025-03-09 07:23:51,554 [INFO]: 	Compute estimated construction time of the index 03/09/2025, 07:23:51
2025-03-09 07:23:51,554 [INFO]: 		-> Train: 16.7 minutes
2025-03-09 07:23:51,554 [INFO]: 		-> Add: 2.8 seconds
2025-03-09 07:23:51,554 [INFO]: 		Total: 16.7 minutes
2025-03-09 07:23:51,554 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0001 secs
2025-03-09 07:23:51,554 [INFO]: 	Checking that your have enough memory available to create the index 03/09/2025, 07:23:51
2025-03-09 07:23:51,555 [INFO]: 1.0GB of memory will be needed to build the index (more might be used if you have more)
2025-03-09 07:23:51,555 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0002 secs
2025-03-09 07:23:51,555 [INFO]: 	Selecting most promising index types given data characteristics 03/09/2025, 07:23:51
2025-03-09 07:23:51,555 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-09 07:23:51,555 [INFO]: 	Creating the index 03/09/2025, 07:23:51
2025-03-09 07:23:51,555 [INFO]: 		-> Instanciate the index HNSW15 03/09/2025, 07:23:51
2025-03-09 07:23:51,556 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0010 secs
2025-03-09 07:23:51,556 [INFO]: 		-> Adding the vectors to the index 03/09/2025, 07:23:51
2025-03-09 07:23:51,556 [INFO]: The memory available for adding the vectors is 49.1GB(total available - used by the index)
2025-03-09 07:23:51,556 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/20 [00:00<?, ?it/s] 10%|█         | 2/20 [00:00<00:01, 17.77it/s] 35%|███▌      | 7/20 [00:00<00:00, 35.30it/s] 60%|██████    | 12/20 [00:00<00:00, 41.15it/s] 85%|████████▌ | 17/20 [00:00<00:00, 43.79it/s]100%|██████████| 20/20 [00:04<00:00,  4.11it/s]
2025-03-09 07:23:56,435 [INFO]: 	Computing best hyperparameters for index knn.index 03/09/2025, 07:23:56
2025-03-09 07:24:45,988 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 49.5531 secs
2025-03-09 07:24:45,999 [INFO]: The best hyperparameters are: efSearch=228
2025-03-09 07:24:45,999 [INFO]: 	Compute fast metrics 03/09/2025, 07:24:45
  0%|          | 0/4 [00:00<?, ?it/s] 25%|██▌       | 1/4 [00:00<00:00,  8.53it/s] 75%|███████▌  | 3/4 [00:00<00:00, 16.27it/s]
2025-03-09 07:24:58,793 [INFO]: 	>>> Finished "Compute fast metrics" in 12.7931 secs
2025-03-09 07:24:58,796 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 67.2401 secs
2025-03-09 07:24:58,796 [INFO]: {
2025-03-09 07:24:58,796 [INFO]: 	index_key: HNSW15
2025-03-09 07:24:58,796 [INFO]: 	index_param: efSearch=228
2025-03-09 07:24:58,796 [INFO]: 	index_path: knn.index
2025-03-09 07:24:58,796 [INFO]: 	size in bytes: 987655090
2025-03-09 07:24:58,796 [INFO]: 	avg_search_speed_ms: 10.734769255882169
2025-03-09 07:24:58,796 [INFO]: 	99p_search_speed_ms: 21.257373972330196
2025-03-09 07:24:58,796 [INFO]: 	reconstruction error %: 0.0
2025-03-09 07:24:58,796 [INFO]: 	nb vectors: 5020
2025-03-09 07:24:58,796 [INFO]: 	vectors dimension: 49152
2025-03-09 07:24:58,796 [INFO]: 	compression ratio: 0.9993085339133928
2025-03-09 07:24:58,796 [INFO]: }
2025-03-09 07:24:58,797 [INFO]: 	>>> Finished "Creating the index" in 67.2416 secs
2025-03-09 07:24:58,797 [INFO]: >>> Finished "Launching the whole pipeline" in 67.2863 secs
2025-03-09 07:25:00: [retrieval_preprocessing] calculating distances ...
2025-03-09 07:25:01: [retrieval_preprocessing] finished and saved retrieval indices for episode 24200 [episode count 3/20]
[retrieval_preprocessing] for episode 82955 [episode count 4/20], we have num_retrieval=np.int64(4934) num_query=np.int64(333)
2025-03-09 07:25:01,638 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-09 07:25:02,256 [INFO]: Launching the whole pipeline 03/09/2025, 07:25:02
2025-03-09 07:25:02,256 [INFO]: Reading total number of vectors and dimension 03/09/2025, 07:25:02
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 764.41it/s]
2025-03-09 07:25:02,289 [INFO]: There are 4934 embeddings of dim 49152
2025-03-09 07:25:02,289 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0329 secs
2025-03-09 07:25:02,290 [INFO]: 	Compute estimated construction time of the index 03/09/2025, 07:25:02
2025-03-09 07:25:02,290 [INFO]: 		-> Train: 16.7 minutes
2025-03-09 07:25:02,290 [INFO]: 		-> Add: 2.7 seconds
2025-03-09 07:25:02,290 [INFO]: 		Total: 16.7 minutes
2025-03-09 07:25:02,290 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0004 secs
2025-03-09 07:25:02,290 [INFO]: 	Checking that your have enough memory available to create the index 03/09/2025, 07:25:02
2025-03-09 07:25:02,290 [INFO]: 1018.3MB of memory will be needed to build the index (more might be used if you have more)
2025-03-09 07:25:02,291 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0005 secs
2025-03-09 07:25:02,291 [INFO]: 	Selecting most promising index types given data characteristics 03/09/2025, 07:25:02
2025-03-09 07:25:02,291 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-09 07:25:02,291 [INFO]: 	Creating the index 03/09/2025, 07:25:02
2025-03-09 07:25:02,292 [INFO]: 		-> Instanciate the index HNSW15 03/09/2025, 07:25:02
2025-03-09 07:25:02,294 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0027 secs
2025-03-09 07:25:02,295 [INFO]: 		-> Adding the vectors to the index 03/09/2025, 07:25:02
2025-03-09 07:25:02,295 [INFO]: The memory available for adding the vectors is 49.1GB(total available - used by the index)
2025-03-09 07:25:02,295 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/20 [00:00<?, ?it/s] 10%|█         | 2/20 [00:00<00:00, 18.25it/s] 40%|████      | 8/20 [00:00<00:00, 37.20it/s] 65%|██████▌   | 13/20 [00:00<00:00, 40.35it/s] 85%|████████▌ | 17/20 [00:00<00:00, 36.29it/s]100%|██████████| 20/20 [00:04<00:00,  4.36it/s]
2025-03-09 07:25:06,887 [INFO]: 	Computing best hyperparameters for index knn.index 03/09/2025, 07:25:06
2025-03-09 07:25:51,551 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 44.6639 secs
2025-03-09 07:25:51,551 [INFO]: The best hyperparameters are: efSearch=164
2025-03-09 07:25:51,551 [INFO]: 	Compute fast metrics 03/09/2025, 07:25:51
  0%|          | 0/4 [00:00<?, ?it/s] 50%|█████     | 2/4 [00:00<00:00, 17.25it/s] 75%|███████▌  | 3/4 [00:00<00:00, 18.30it/s]
2025-03-09 07:26:04,831 [INFO]: 	>>> Finished "Compute fast metrics" in 13.2801 secs
2025-03-09 07:26:04,835 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 62.5399 secs
2025-03-09 07:26:04,835 [INFO]: {
2025-03-09 07:26:04,835 [INFO]: 	index_key: HNSW15
2025-03-09 07:26:04,835 [INFO]: 	index_param: efSearch=164
2025-03-09 07:26:04,835 [INFO]: 	index_path: knn.index
2025-03-09 07:26:04,835 [INFO]: 	size in bytes: 970734910
2025-03-09 07:26:04,835 [INFO]: 	avg_search_speed_ms: 8.417815676543812
2025-03-09 07:26:04,835 [INFO]: 	99p_search_speed_ms: 18.63653663545845
2025-03-09 07:26:04,835 [INFO]: 	reconstruction error %: 0.0
2025-03-09 07:26:04,835 [INFO]: 	nb vectors: 4934
2025-03-09 07:26:04,835 [INFO]: 	vectors dimension: 49152
2025-03-09 07:26:04,835 [INFO]: 	compression ratio: 0.9993087319791559
2025-03-09 07:26:04,835 [INFO]: }
2025-03-09 07:26:04,835 [INFO]: 	>>> Finished "Creating the index" in 62.5435 secs
2025-03-09 07:26:04,835 [INFO]: >>> Finished "Launching the whole pipeline" in 62.5785 secs
2025-03-09 07:26:05: [retrieval_preprocessing] calculating distances ...
2025-03-09 07:26:06: [retrieval_preprocessing] finished and saved retrieval indices for episode 82955 [episode count 4/20]
[retrieval_preprocessing] for episode 75278 [episode count 5/20], we have num_retrieval=np.int64(5047) num_query=np.int64(220)
2025-03-09 07:26:07,445 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-09 07:26:08,179 [INFO]: Launching the whole pipeline 03/09/2025, 07:26:08
2025-03-09 07:26:08,179 [INFO]: Reading total number of vectors and dimension 03/09/2025, 07:26:08
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1425.18it/s]
2025-03-09 07:26:08,212 [INFO]: There are 5047 embeddings of dim 49152
2025-03-09 07:26:08,212 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0328 secs
2025-03-09 07:26:08,212 [INFO]: 	Compute estimated construction time of the index 03/09/2025, 07:26:08
2025-03-09 07:26:08,212 [INFO]: 		-> Train: 16.7 minutes
2025-03-09 07:26:08,212 [INFO]: 		-> Add: 2.8 seconds
2025-03-09 07:26:08,212 [INFO]: 		Total: 16.7 minutes
2025-03-09 07:26:08,212 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0001 secs
2025-03-09 07:26:08,212 [INFO]: 	Checking that your have enough memory available to create the index 03/09/2025, 07:26:08
2025-03-09 07:26:08,212 [INFO]: 1.0GB of memory will be needed to build the index (more might be used if you have more)
2025-03-09 07:26:08,212 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0002 secs
2025-03-09 07:26:08,212 [INFO]: 	Selecting most promising index types given data characteristics 03/09/2025, 07:26:08
2025-03-09 07:26:08,212 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-09 07:26:08,212 [INFO]: 	Creating the index 03/09/2025, 07:26:08
2025-03-09 07:26:08,212 [INFO]: 		-> Instanciate the index HNSW15 03/09/2025, 07:26:08
2025-03-09 07:26:08,213 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0009 secs
2025-03-09 07:26:08,213 [INFO]: 		-> Adding the vectors to the index 03/09/2025, 07:26:08
2025-03-09 07:26:08,213 [INFO]: The memory available for adding the vectors is 49.1GB(total available - used by the index)
2025-03-09 07:26:08,214 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/20 [00:00<?, ?it/s]  5%|▌         | 1/20 [00:00<00:02,  6.79it/s] 30%|███       | 6/20 [00:00<00:00, 27.50it/s] 50%|█████     | 10/20 [00:00<00:00, 32.30it/s] 70%|███████   | 14/20 [00:00<00:00, 35.04it/s] 95%|█████████▌| 19/20 [00:00<00:00, 39.53it/s]100%|██████████| 20/20 [00:04<00:00,  4.81it/s]
2025-03-09 07:26:12,376 [INFO]: 	Computing best hyperparameters for index knn.index 03/09/2025, 07:26:12
2025-03-09 07:26:59,901 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 47.5243 secs
2025-03-09 07:26:59,901 [INFO]: The best hyperparameters are: efSearch=122
2025-03-09 07:26:59,901 [INFO]: 	Compute fast metrics 03/09/2025, 07:26:59
  0%|          | 0/4 [00:00<?, ?it/s] 50%|█████     | 2/4 [00:00<00:00, 18.66it/s] 75%|███████▌  | 3/4 [00:00<00:00, 19.22it/s]
2025-03-09 07:27:16,933 [INFO]: 	>>> Finished "Compute fast metrics" in 17.0319 secs
2025-03-09 07:27:16,936 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 68.7227 secs
2025-03-09 07:27:16,936 [INFO]: {
2025-03-09 07:27:16,936 [INFO]: 	index_key: HNSW15
2025-03-09 07:27:16,936 [INFO]: 	index_param: efSearch=122
2025-03-09 07:27:16,936 [INFO]: 	index_path: knn.index
2025-03-09 07:27:16,936 [INFO]: 	size in bytes: 992967250
2025-03-09 07:27:16,936 [INFO]: 	avg_search_speed_ms: 6.190562572318703
2025-03-09 07:27:16,936 [INFO]: 	99p_search_speed_ms: 14.050394697114823
2025-03-09 07:27:16,936 [INFO]: 	reconstruction error %: 0.0
2025-03-09 07:27:16,936 [INFO]: 	nb vectors: 5047
2025-03-09 07:27:16,936 [INFO]: 	vectors dimension: 49152
2025-03-09 07:27:16,936 [INFO]: 	compression ratio: 0.9993084625902818
2025-03-09 07:27:16,936 [INFO]: }
2025-03-09 07:27:16,937 [INFO]: 	>>> Finished "Creating the index" in 68.7241 secs
2025-03-09 07:27:16,937 [INFO]: >>> Finished "Launching the whole pipeline" in 68.7575 secs
2025-03-09 07:27:17: [retrieval_preprocessing] calculating distances ...
2025-03-09 07:27:18: [retrieval_preprocessing] finished and saved retrieval indices for episode 75278 [episode count 5/20]
[retrieval_preprocessing] for episode 3087 [episode count 6/20], we have num_retrieval=np.int64(5024) num_query=np.int64(243)
2025-03-09 07:27:18,635 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-09 07:27:19,362 [INFO]: Launching the whole pipeline 03/09/2025, 07:27:19
2025-03-09 07:27:19,363 [INFO]: Reading total number of vectors and dimension 03/09/2025, 07:27:19
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1251.28it/s]
2025-03-09 07:27:19,395 [INFO]: There are 5024 embeddings of dim 49152
2025-03-09 07:27:19,395 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0328 secs
2025-03-09 07:27:19,395 [INFO]: 	Compute estimated construction time of the index 03/09/2025, 07:27:19
2025-03-09 07:27:19,395 [INFO]: 		-> Train: 16.7 minutes
2025-03-09 07:27:19,396 [INFO]: 		-> Add: 2.8 seconds
2025-03-09 07:27:19,396 [INFO]: 		Total: 16.7 minutes
2025-03-09 07:27:19,396 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0001 secs
2025-03-09 07:27:19,396 [INFO]: 	Checking that your have enough memory available to create the index 03/09/2025, 07:27:19
2025-03-09 07:27:19,396 [INFO]: 1.0GB of memory will be needed to build the index (more might be used if you have more)
2025-03-09 07:27:19,396 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0001 secs
2025-03-09 07:27:19,396 [INFO]: 	Selecting most promising index types given data characteristics 03/09/2025, 07:27:19
2025-03-09 07:27:19,396 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-09 07:27:19,396 [INFO]: 	Creating the index 03/09/2025, 07:27:19
2025-03-09 07:27:19,396 [INFO]: 		-> Instanciate the index HNSW15 03/09/2025, 07:27:19
2025-03-09 07:27:19,397 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0010 secs
2025-03-09 07:27:19,397 [INFO]: 		-> Adding the vectors to the index 03/09/2025, 07:27:19
2025-03-09 07:27:19,397 [INFO]: The memory available for adding the vectors is 49.1GB(total available - used by the index)
2025-03-09 07:27:19,397 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/20 [00:00<?, ?it/s]  5%|▌         | 1/20 [00:00<00:02,  7.37it/s] 30%|███       | 6/20 [00:00<00:00, 28.19it/s] 50%|█████     | 10/20 [00:00<00:00, 30.88it/s] 75%|███████▌  | 15/20 [00:00<00:00, 36.72it/s]100%|██████████| 20/20 [00:04<00:00,  3.32it/s]100%|██████████| 20/20 [00:04<00:00,  4.99it/s]
2025-03-09 07:27:23,408 [INFO]: 	Computing best hyperparameters for index knn.index 03/09/2025, 07:27:23
2025-03-09 07:28:08,814 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 45.4049 secs
2025-03-09 07:28:08,814 [INFO]: The best hyperparameters are: efSearch=208
2025-03-09 07:28:08,814 [INFO]: 	Compute fast metrics 03/09/2025, 07:28:08
  0%|          | 0/4 [00:00<?, ?it/s] 50%|█████     | 2/4 [00:00<00:00, 18.30it/s] 75%|███████▌  | 3/4 [00:00<00:00, 19.90it/s]
2025-03-09 07:28:23,246 [INFO]: 	>>> Finished "Compute fast metrics" in 14.4315 secs
2025-03-09 07:28:23,249 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 63.8516 secs
2025-03-09 07:28:23,249 [INFO]: {
2025-03-09 07:28:23,249 [INFO]: 	index_key: HNSW15
2025-03-09 07:28:23,249 [INFO]: 	index_param: efSearch=208
2025-03-09 07:28:23,249 [INFO]: 	index_path: knn.index
2025-03-09 07:28:23,249 [INFO]: 	size in bytes: 988442110
2025-03-09 07:28:23,249 [INFO]: 	avg_search_speed_ms: 9.956253186767151
2025-03-09 07:28:23,249 [INFO]: 	99p_search_speed_ms: 25.113236345350753
2025-03-09 07:28:23,249 [INFO]: 	reconstruction error %: 0.0
2025-03-09 07:28:23,249 [INFO]: 	nb vectors: 5024
2025-03-09 07:28:23,249 [INFO]: 	vectors dimension: 49152
2025-03-09 07:28:23,249 [INFO]: 	compression ratio: 0.9993084895988497
2025-03-09 07:28:23,249 [INFO]: }
2025-03-09 07:28:23,249 [INFO]: 	>>> Finished "Creating the index" in 63.8531 secs
2025-03-09 07:28:23,249 [INFO]: >>> Finished "Launching the whole pipeline" in 63.8864 secs
2025-03-09 07:28:24: [retrieval_preprocessing] calculating distances ...
2025-03-09 07:28:25: [retrieval_preprocessing] finished and saved retrieval indices for episode 3087 [episode count 6/20]
[retrieval_preprocessing] for episode 17039 [episode count 7/20], we have num_retrieval=np.int64(4983) num_query=np.int64(284)
2025-03-09 07:28:25,632 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-09 07:28:26,532 [INFO]: Launching the whole pipeline 03/09/2025, 07:28:26
2025-03-09 07:28:26,532 [INFO]: Reading total number of vectors and dimension 03/09/2025, 07:28:26
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1597.83it/s]
2025-03-09 07:28:26,580 [INFO]: There are 4983 embeddings of dim 49152
2025-03-09 07:28:26,580 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0481 secs
2025-03-09 07:28:26,580 [INFO]: 	Compute estimated construction time of the index 03/09/2025, 07:28:26
2025-03-09 07:28:26,580 [INFO]: 		-> Train: 16.7 minutes
2025-03-09 07:28:26,580 [INFO]: 		-> Add: 2.7 seconds
2025-03-09 07:28:26,580 [INFO]: 		Total: 16.7 minutes
2025-03-09 07:28:26,581 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0001 secs
2025-03-09 07:28:26,581 [INFO]: 	Checking that your have enough memory available to create the index 03/09/2025, 07:28:26
2025-03-09 07:28:26,581 [INFO]: 1.0GB of memory will be needed to build the index (more might be used if you have more)
2025-03-09 07:28:26,581 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0002 secs
2025-03-09 07:28:26,581 [INFO]: 	Selecting most promising index types given data characteristics 03/09/2025, 07:28:26
2025-03-09 07:28:26,581 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-09 07:28:26,581 [INFO]: 	Creating the index 03/09/2025, 07:28:26
2025-03-09 07:28:26,581 [INFO]: 		-> Instanciate the index HNSW15 03/09/2025, 07:28:26
2025-03-09 07:28:26,582 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0010 secs
2025-03-09 07:28:26,582 [INFO]: 		-> Adding the vectors to the index 03/09/2025, 07:28:26
2025-03-09 07:28:26,582 [INFO]: The memory available for adding the vectors is 49.1GB(total available - used by the index)
2025-03-09 07:28:26,582 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/20 [00:00<?, ?it/s]  5%|▌         | 1/20 [00:00<00:03,  5.84it/s] 25%|██▌       | 5/20 [00:00<00:00, 19.87it/s] 45%|████▌     | 9/20 [00:00<00:00, 27.06it/s] 65%|██████▌   | 13/20 [00:00<00:00, 31.09it/s] 85%|████████▌ | 17/20 [00:00<00:00, 29.47it/s]100%|██████████| 20/20 [00:04<00:00,  4.04it/s]
2025-03-09 07:28:31,540 [INFO]: 	Computing best hyperparameters for index knn.index 03/09/2025, 07:28:31
2025-03-09 07:29:16,586 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 45.0458 secs
2025-03-09 07:29:16,587 [INFO]: The best hyperparameters are: efSearch=200
2025-03-09 07:29:16,587 [INFO]: 	Compute fast metrics 03/09/2025, 07:29:16
  0%|          | 0/4 [00:00<?, ?it/s] 25%|██▌       | 1/4 [00:01<00:03,  1.13s/it] 75%|███████▌  | 3/4 [00:01<00:00,  2.97it/s] 75%|███████▌  | 3/4 [00:01<00:00,  2.22it/s]
2025-03-09 07:29:30,492 [INFO]: 	>>> Finished "Compute fast metrics" in 13.9051 secs
2025-03-09 07:29:30,495 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 63.9132 secs
2025-03-09 07:29:30,495 [INFO]: {
2025-03-09 07:29:30,495 [INFO]: 	index_key: HNSW15
2025-03-09 07:29:30,495 [INFO]: 	index_param: efSearch=200
2025-03-09 07:29:30,495 [INFO]: 	index_path: knn.index
2025-03-09 07:29:30,495 [INFO]: 	size in bytes: 980375410
2025-03-09 07:29:30,495 [INFO]: 	avg_search_speed_ms: 9.436364527484226
2025-03-09 07:29:30,495 [INFO]: 	99p_search_speed_ms: 17.52847272437067
2025-03-09 07:29:30,495 [INFO]: 	reconstruction error %: 0.0
2025-03-09 07:29:30,495 [INFO]: 	nb vectors: 4983
2025-03-09 07:29:30,495 [INFO]: 	vectors dimension: 49152
2025-03-09 07:29:30,495 [INFO]: 	compression ratio: 0.9993086872711342
2025-03-09 07:29:30,496 [INFO]: }
2025-03-09 07:29:30,496 [INFO]: 	>>> Finished "Creating the index" in 63.9147 secs
2025-03-09 07:29:30,496 [INFO]: >>> Finished "Launching the whole pipeline" in 63.9634 secs
2025-03-09 07:29:31: [retrieval_preprocessing] calculating distances ...
2025-03-09 07:29:32: [retrieval_preprocessing] finished and saved retrieval indices for episode 17039 [episode count 7/20]
[retrieval_preprocessing] for episode 78742 [episode count 8/20], we have num_retrieval=np.int64(4982) num_query=np.int64(285)
2025-03-09 07:29:33,158 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-09 07:29:33,894 [INFO]: Launching the whole pipeline 03/09/2025, 07:29:33
2025-03-09 07:29:33,894 [INFO]: Reading total number of vectors and dimension 03/09/2025, 07:29:33
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 948.08it/s]
2025-03-09 07:29:33,928 [INFO]: There are 4982 embeddings of dim 49152
2025-03-09 07:29:33,928 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0338 secs
2025-03-09 07:29:33,928 [INFO]: 	Compute estimated construction time of the index 03/09/2025, 07:29:33
2025-03-09 07:29:33,928 [INFO]: 		-> Train: 16.7 minutes
2025-03-09 07:29:33,928 [INFO]: 		-> Add: 2.7 seconds
2025-03-09 07:29:33,928 [INFO]: 		Total: 16.7 minutes
2025-03-09 07:29:33,928 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0001 secs
2025-03-09 07:29:33,928 [INFO]: 	Checking that your have enough memory available to create the index 03/09/2025, 07:29:33
2025-03-09 07:29:33,928 [INFO]: 1.0GB of memory will be needed to build the index (more might be used if you have more)
2025-03-09 07:29:33,928 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0002 secs
2025-03-09 07:29:33,928 [INFO]: 	Selecting most promising index types given data characteristics 03/09/2025, 07:29:33
2025-03-09 07:29:33,928 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-09 07:29:33,928 [INFO]: 	Creating the index 03/09/2025, 07:29:33
2025-03-09 07:29:33,929 [INFO]: 		-> Instanciate the index HNSW15 03/09/2025, 07:29:33
2025-03-09 07:29:33,930 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0014 secs
2025-03-09 07:29:33,930 [INFO]: 		-> Adding the vectors to the index 03/09/2025, 07:29:33
2025-03-09 07:29:33,930 [INFO]: The memory available for adding the vectors is 49.1GB(total available - used by the index)
2025-03-09 07:29:33,930 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/20 [00:00<?, ?it/s]  5%|▌         | 1/20 [00:00<00:02,  7.20it/s] 30%|███       | 6/20 [00:00<00:00, 28.53it/s] 55%|█████▌    | 11/20 [00:00<00:00, 37.25it/s] 80%|████████  | 16/20 [00:00<00:00, 41.70it/s]100%|██████████| 20/20 [00:03<00:00,  5.28it/s]
2025-03-09 07:29:37,719 [INFO]: 	Computing best hyperparameters for index knn.index 03/09/2025, 07:29:37
2025-03-09 07:30:27,183 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 49.4636 secs
2025-03-09 07:30:27,183 [INFO]: The best hyperparameters are: efSearch=199
2025-03-09 07:30:27,184 [INFO]: 	Compute fast metrics 03/09/2025, 07:30:27
  0%|          | 0/4 [00:00<?, ?it/s] 25%|██▌       | 1/4 [00:00<00:00,  8.52it/s] 75%|███████▌  | 3/4 [00:00<00:00, 16.01it/s]
2025-03-09 07:30:39,710 [INFO]: 	>>> Finished "Compute fast metrics" in 12.5268 secs
2025-03-09 07:30:39,713 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 65.7832 secs
2025-03-09 07:30:39,713 [INFO]: {
2025-03-09 07:30:39,713 [INFO]: 	index_key: HNSW15
2025-03-09 07:30:39,713 [INFO]: 	index_param: efSearch=199
2025-03-09 07:30:39,713 [INFO]: 	index_path: knn.index
2025-03-09 07:30:39,713 [INFO]: 	size in bytes: 980178670
2025-03-09 07:30:39,713 [INFO]: 	avg_search_speed_ms: 10.142320881335113
2025-03-09 07:30:39,713 [INFO]: 	99p_search_speed_ms: 21.121582586783916
2025-03-09 07:30:39,713 [INFO]: 	reconstruction error %: 0.0
2025-03-09 07:30:39,713 [INFO]: 	nb vectors: 4982
2025-03-09 07:30:39,713 [INFO]: 	vectors dimension: 49152
2025-03-09 07:30:39,714 [INFO]: 	compression ratio: 0.9993086831812
2025-03-09 07:30:39,714 [INFO]: }
2025-03-09 07:30:39,714 [INFO]: 	>>> Finished "Creating the index" in 65.7851 secs
2025-03-09 07:30:39,714 [INFO]: >>> Finished "Launching the whole pipeline" in 65.8195 secs
2025-03-09 07:30:41: [retrieval_preprocessing] calculating distances ...
2025-03-09 07:30:42: [retrieval_preprocessing] finished and saved retrieval indices for episode 78742 [episode count 8/20]
[retrieval_preprocessing] for episode 47127 [episode count 9/20], we have num_retrieval=np.int64(5033) num_query=np.int64(234)
2025-03-09 07:30:42,521 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-09 07:30:43,267 [INFO]: Launching the whole pipeline 03/09/2025, 07:30:43
2025-03-09 07:30:43,267 [INFO]: Reading total number of vectors and dimension 03/09/2025, 07:30:43
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1560.96it/s]
2025-03-09 07:30:43,298 [INFO]: There are 5033 embeddings of dim 49152
2025-03-09 07:30:43,299 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0316 secs
2025-03-09 07:30:43,299 [INFO]: 	Compute estimated construction time of the index 03/09/2025, 07:30:43
2025-03-09 07:30:43,299 [INFO]: 		-> Train: 16.7 minutes
2025-03-09 07:30:43,299 [INFO]: 		-> Add: 2.8 seconds
2025-03-09 07:30:43,299 [INFO]: 		Total: 16.7 minutes
2025-03-09 07:30:43,299 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0001 secs
2025-03-09 07:30:43,299 [INFO]: 	Checking that your have enough memory available to create the index 03/09/2025, 07:30:43
2025-03-09 07:30:43,299 [INFO]: 1.0GB of memory will be needed to build the index (more might be used if you have more)
2025-03-09 07:30:43,299 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0002 secs
2025-03-09 07:30:43,299 [INFO]: 	Selecting most promising index types given data characteristics 03/09/2025, 07:30:43
2025-03-09 07:30:43,299 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-09 07:30:43,299 [INFO]: 	Creating the index 03/09/2025, 07:30:43
2025-03-09 07:30:43,299 [INFO]: 		-> Instanciate the index HNSW15 03/09/2025, 07:30:43
2025-03-09 07:30:43,300 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0008 secs
2025-03-09 07:30:43,300 [INFO]: 		-> Adding the vectors to the index 03/09/2025, 07:30:43
2025-03-09 07:30:43,300 [INFO]: The memory available for adding the vectors is 49.1GB(total available - used by the index)
2025-03-09 07:30:43,301 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/20 [00:00<?, ?it/s]  5%|▌         | 1/20 [00:00<00:02,  6.94it/s] 25%|██▌       | 5/20 [00:00<00:00, 19.57it/s] 45%|████▌     | 9/20 [00:00<00:00, 26.40it/s] 70%|███████   | 14/20 [00:00<00:00, 32.98it/s] 95%|█████████▌| 19/20 [00:00<00:00, 36.90it/s]100%|██████████| 20/20 [00:04<00:00,  4.62it/s]
2025-03-09 07:30:47,630 [INFO]: 	Computing best hyperparameters for index knn.index 03/09/2025, 07:30:47
2025-03-09 07:31:41,197 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 53.5670 secs
2025-03-09 07:31:41,198 [INFO]: The best hyperparameters are: efSearch=189
2025-03-09 07:31:41,198 [INFO]: 	Compute fast metrics 03/09/2025, 07:31:41
  0%|          | 0/4 [00:00<?, ?it/s] 25%|██▌       | 1/4 [00:00<00:00,  3.42it/s] 75%|███████▌  | 3/4 [00:00<00:00,  8.57it/s]
2025-03-09 07:32:05,302 [INFO]: 	>>> Finished "Compute fast metrics" in 24.1041 secs
2025-03-09 07:32:05,305 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 82.0044 secs
2025-03-09 07:32:05,305 [INFO]: {
2025-03-09 07:32:05,305 [INFO]: 	index_key: HNSW15
2025-03-09 07:32:05,305 [INFO]: 	index_param: efSearch=189
2025-03-09 07:32:05,305 [INFO]: 	index_path: knn.index
2025-03-09 07:32:05,305 [INFO]: 	size in bytes: 990212770
2025-03-09 07:32:05,305 [INFO]: 	avg_search_speed_ms: 8.239945749862693
2025-03-09 07:32:05,305 [INFO]: 	99p_search_speed_ms: 19.674749483820015
2025-03-09 07:32:05,305 [INFO]: 	reconstruction error %: 0.0
2025-03-09 07:32:05,305 [INFO]: 	nb vectors: 5033
2025-03-09 07:32:05,305 [INFO]: 	vectors dimension: 49152
2025-03-09 07:32:05,305 [INFO]: 	compression ratio: 0.9993085263887276
2025-03-09 07:32:05,305 [INFO]: }
2025-03-09 07:32:05,305 [INFO]: 	>>> Finished "Creating the index" in 82.0058 secs
2025-03-09 07:32:05,305 [INFO]: >>> Finished "Launching the whole pipeline" in 82.0382 secs
2025-03-09 07:32:06: [retrieval_preprocessing] calculating distances ...
2025-03-09 07:32:06: [retrieval_preprocessing] finished and saved retrieval indices for episode 47127 [episode count 9/20]
[retrieval_preprocessing] for episode 15259 [episode count 10/20], we have num_retrieval=np.int64(5078) num_query=np.int64(189)
2025-03-09 07:32:07,504 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-09 07:32:08,504 [INFO]: Launching the whole pipeline 03/09/2025, 07:32:08
2025-03-09 07:32:08,504 [INFO]: Reading total number of vectors and dimension 03/09/2025, 07:32:08
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 2131.25it/s]
2025-03-09 07:32:08,534 [INFO]: There are 5078 embeddings of dim 49152
2025-03-09 07:32:08,535 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0309 secs
2025-03-09 07:32:08,535 [INFO]: 	Compute estimated construction time of the index 03/09/2025, 07:32:08
2025-03-09 07:32:08,535 [INFO]: 		-> Train: 16.7 minutes
2025-03-09 07:32:08,536 [INFO]: 		-> Add: 2.8 seconds
2025-03-09 07:32:08,536 [INFO]: 		Total: 16.7 minutes
2025-03-09 07:32:08,536 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0004 secs
2025-03-09 07:32:08,536 [INFO]: 	Checking that your have enough memory available to create the index 03/09/2025, 07:32:08
2025-03-09 07:32:08,536 [INFO]: 1.0GB of memory will be needed to build the index (more might be used if you have more)
2025-03-09 07:32:08,536 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0004 secs
2025-03-09 07:32:08,536 [INFO]: 	Selecting most promising index types given data characteristics 03/09/2025, 07:32:08
2025-03-09 07:32:08,536 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-09 07:32:08,537 [INFO]: 	Creating the index 03/09/2025, 07:32:08
2025-03-09 07:32:08,537 [INFO]: 		-> Instanciate the index HNSW15 03/09/2025, 07:32:08
2025-03-09 07:32:08,540 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0026 secs
2025-03-09 07:32:08,541 [INFO]: 		-> Adding the vectors to the index 03/09/2025, 07:32:08
2025-03-09 07:32:08,541 [INFO]: The memory available for adding the vectors is 49.1GB(total available - used by the index)
2025-03-09 07:32:08,541 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/20 [00:00<?, ?it/s] 10%|█         | 2/20 [00:00<00:00, 18.30it/s] 35%|███▌      | 7/20 [00:00<00:00, 35.16it/s] 60%|██████    | 12/20 [00:00<00:00, 39.20it/s] 85%|████████▌ | 17/20 [00:00<00:00, 40.78it/s]100%|██████████| 20/20 [00:04<00:00,  4.20it/s]
2025-03-09 07:32:13,314 [INFO]: 	Computing best hyperparameters for index knn.index 03/09/2025, 07:32:13
2025-03-09 07:32:59,244 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 45.9297 secs
2025-03-09 07:32:59,245 [INFO]: The best hyperparameters are: efSearch=206
2025-03-09 07:32:59,245 [INFO]: 	Compute fast metrics 03/09/2025, 07:32:59
  0%|          | 0/4 [00:00<?, ?it/s] 25%|██▌       | 1/4 [00:00<00:00,  9.77it/s] 75%|███████▌  | 3/4 [00:00<00:00, 18.08it/s]
2025-03-09 07:33:17,982 [INFO]: 	>>> Finished "Compute fast metrics" in 18.7373 secs
2025-03-09 07:33:17,985 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 69.4446 secs
2025-03-09 07:33:17,985 [INFO]: {
2025-03-09 07:33:17,985 [INFO]: 	index_key: HNSW15
2025-03-09 07:33:17,985 [INFO]: 	index_param: efSearch=206
2025-03-09 07:33:17,985 [INFO]: 	index_path: knn.index
2025-03-09 07:33:17,985 [INFO]: 	size in bytes: 999066250
2025-03-09 07:33:17,985 [INFO]: 	avg_search_speed_ms: 9.826032446206993
2025-03-09 07:33:17,985 [INFO]: 	99p_search_speed_ms: 20.129711991176016
2025-03-09 07:33:17,985 [INFO]: 	reconstruction error %: 0.0
2025-03-09 07:33:17,985 [INFO]: 	nb vectors: 5078
2025-03-09 07:33:17,986 [INFO]: 	vectors dimension: 49152
2025-03-09 07:33:17,986 [INFO]: 	compression ratio: 0.9993085283383359
2025-03-09 07:33:17,986 [INFO]: }
2025-03-09 07:33:17,986 [INFO]: 	>>> Finished "Creating the index" in 69.4483 secs
2025-03-09 07:33:17,986 [INFO]: >>> Finished "Launching the whole pipeline" in 69.4817 secs
2025-03-09 07:33:18: [retrieval_preprocessing] calculating distances ...
2025-03-09 07:33:19: [retrieval_preprocessing] finished and saved retrieval indices for episode 15259 [episode count 10/20]
[retrieval_preprocessing] for episode 28828 [episode count 11/20], we have num_retrieval=np.int64(5004) num_query=np.int64(263)
2025-03-09 07:33:25,833 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-09 07:33:26,531 [INFO]: Launching the whole pipeline 03/09/2025, 07:33:26
2025-03-09 07:33:26,531 [INFO]: Reading total number of vectors and dimension 03/09/2025, 07:33:26
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1409.85it/s]
2025-03-09 07:33:26,562 [INFO]: There are 5004 embeddings of dim 49152
2025-03-09 07:33:26,562 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0307 secs
2025-03-09 07:33:26,562 [INFO]: 	Compute estimated construction time of the index 03/09/2025, 07:33:26
2025-03-09 07:33:26,562 [INFO]: 		-> Train: 16.7 minutes
2025-03-09 07:33:26,562 [INFO]: 		-> Add: 2.7 seconds
2025-03-09 07:33:26,562 [INFO]: 		Total: 16.7 minutes
2025-03-09 07:33:26,562 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0001 secs
2025-03-09 07:33:26,562 [INFO]: 	Checking that your have enough memory available to create the index 03/09/2025, 07:33:26
2025-03-09 07:33:26,562 [INFO]: 1.0GB of memory will be needed to build the index (more might be used if you have more)
2025-03-09 07:33:26,562 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0002 secs
2025-03-09 07:33:26,562 [INFO]: 	Selecting most promising index types given data characteristics 03/09/2025, 07:33:26
2025-03-09 07:33:26,562 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-09 07:33:26,562 [INFO]: 	Creating the index 03/09/2025, 07:33:26
2025-03-09 07:33:26,562 [INFO]: 		-> Instanciate the index HNSW15 03/09/2025, 07:33:26
2025-03-09 07:33:26,563 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0010 secs
2025-03-09 07:33:26,564 [INFO]: 		-> Adding the vectors to the index 03/09/2025, 07:33:26
2025-03-09 07:33:26,564 [INFO]: The memory available for adding the vectors is 49.1GB(total available - used by the index)
2025-03-09 07:33:26,564 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/20 [00:00<?, ?it/s]  5%|▌         | 1/20 [00:00<00:01,  9.93it/s] 30%|███       | 6/20 [00:00<00:00, 31.05it/s] 55%|█████▌    | 11/20 [00:00<00:00, 37.03it/s] 80%|████████  | 16/20 [00:00<00:00, 39.89it/s]100%|██████████| 20/20 [00:04<00:00,  2.74it/s]100%|██████████| 20/20 [00:04<00:00,  4.35it/s]
2025-03-09 07:33:31,163 [INFO]: 	Computing best hyperparameters for index knn.index 03/09/2025, 07:33:31
2025-03-09 07:34:17,504 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 46.3403 secs
2025-03-09 07:34:17,504 [INFO]: The best hyperparameters are: efSearch=241
2025-03-09 07:34:17,504 [INFO]: 	Compute fast metrics 03/09/2025, 07:34:17
  0%|          | 0/4 [00:00<?, ?it/s] 25%|██▌       | 1/4 [00:00<00:00,  6.32it/s] 75%|███████▌  | 3/4 [00:00<00:00, 13.98it/s]
2025-03-09 07:34:31,930 [INFO]: 	>>> Finished "Compute fast metrics" in 14.4259 secs
2025-03-09 07:34:31,933 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 65.3695 secs
2025-03-09 07:34:31,933 [INFO]: {
2025-03-09 07:34:31,933 [INFO]: 	index_key: HNSW15
2025-03-09 07:34:31,933 [INFO]: 	index_param: efSearch=241
2025-03-09 07:34:31,933 [INFO]: 	index_path: knn.index
2025-03-09 07:34:31,933 [INFO]: 	size in bytes: 984507190
2025-03-09 07:34:31,933 [INFO]: 	avg_search_speed_ms: 12.318380005552154
2025-03-09 07:34:31,933 [INFO]: 	99p_search_speed_ms: 30.21491806954145
2025-03-09 07:34:31,933 [INFO]: 	reconstruction error %: 0.0
2025-03-09 07:34:31,933 [INFO]: 	nb vectors: 5004
2025-03-09 07:34:31,933 [INFO]: 	vectors dimension: 49152
2025-03-09 07:34:31,933 [INFO]: 	compression ratio: 0.9993085291738703
2025-03-09 07:34:31,933 [INFO]: }
2025-03-09 07:34:31,933 [INFO]: 	>>> Finished "Creating the index" in 65.3711 secs
2025-03-09 07:34:31,934 [INFO]: >>> Finished "Launching the whole pipeline" in 65.4025 secs
2025-03-09 07:34:33: [retrieval_preprocessing] calculating distances ...
2025-03-09 07:34:35: [retrieval_preprocessing] finished and saved retrieval indices for episode 28828 [episode count 11/20]
[retrieval_preprocessing] for episode 10910 [episode count 12/20], we have num_retrieval=np.int64(4885) num_query=np.int64(382)
2025-03-09 07:34:35,632 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-09 07:34:36,374 [INFO]: Launching the whole pipeline 03/09/2025, 07:34:36
2025-03-09 07:34:36,374 [INFO]: Reading total number of vectors and dimension 03/09/2025, 07:34:36
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1856.71it/s]
2025-03-09 07:34:36,405 [INFO]: There are 4885 embeddings of dim 49152
2025-03-09 07:34:36,405 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0308 secs
2025-03-09 07:34:36,405 [INFO]: 	Compute estimated construction time of the index 03/09/2025, 07:34:36
2025-03-09 07:34:36,405 [INFO]: 		-> Train: 16.7 minutes
2025-03-09 07:34:36,405 [INFO]: 		-> Add: 2.7 seconds
2025-03-09 07:34:36,405 [INFO]: 		Total: 16.7 minutes
2025-03-09 07:34:36,405 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0001 secs
2025-03-09 07:34:36,405 [INFO]: 	Checking that your have enough memory available to create the index 03/09/2025, 07:34:36
2025-03-09 07:34:36,405 [INFO]: 1008.1MB of memory will be needed to build the index (more might be used if you have more)
2025-03-09 07:34:36,405 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0001 secs
2025-03-09 07:34:36,405 [INFO]: 	Selecting most promising index types given data characteristics 03/09/2025, 07:34:36
2025-03-09 07:34:36,405 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-09 07:34:36,406 [INFO]: 	Creating the index 03/09/2025, 07:34:36
2025-03-09 07:34:36,406 [INFO]: 		-> Instanciate the index HNSW15 03/09/2025, 07:34:36
2025-03-09 07:34:36,407 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0009 secs
2025-03-09 07:34:36,407 [INFO]: 		-> Adding the vectors to the index 03/09/2025, 07:34:36
2025-03-09 07:34:36,407 [INFO]: The memory available for adding the vectors is 49.1GB(total available - used by the index)
2025-03-09 07:34:36,407 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/20 [00:00<?, ?it/s]  5%|▌         | 1/20 [00:00<00:02,  8.02it/s] 30%|███       | 6/20 [00:00<00:00, 29.76it/s] 55%|█████▌    | 11/20 [00:00<00:00, 37.39it/s] 80%|████████  | 16/20 [00:00<00:00, 41.70it/s]100%|██████████| 20/20 [00:04<00:00,  4.95it/s]
2025-03-09 07:34:40,451 [INFO]: 	Computing best hyperparameters for index knn.index 03/09/2025, 07:34:40
2025-03-09 07:35:23,897 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 43.4454 secs
2025-03-09 07:35:23,898 [INFO]: The best hyperparameters are: efSearch=244
2025-03-09 07:35:23,898 [INFO]: 	Compute fast metrics 03/09/2025, 07:35:23
  0%|          | 0/4 [00:00<?, ?it/s] 25%|██▌       | 1/4 [00:01<00:03,  1.32s/it] 50%|█████     | 2/4 [00:01<00:01,  1.28it/s] 75%|███████▌  | 3/4 [00:02<00:00,  1.10it/s] 75%|███████▌  | 3/4 [00:02<00:00,  1.07it/s]
2025-03-09 07:35:40,799 [INFO]: 	>>> Finished "Compute fast metrics" in 16.9014 secs
2025-03-09 07:35:40,802 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 64.3955 secs
2025-03-09 07:35:40,802 [INFO]: {
2025-03-09 07:35:40,802 [INFO]: 	index_key: HNSW15
2025-03-09 07:35:40,802 [INFO]: 	index_param: efSearch=244
2025-03-09 07:35:40,802 [INFO]: 	index_path: knn.index
2025-03-09 07:35:40,802 [INFO]: 	size in bytes: 961094470
2025-03-09 07:35:40,802 [INFO]: 	avg_search_speed_ms: 12.06605221550413
2025-03-09 07:35:40,802 [INFO]: 	99p_search_speed_ms: 22.900865105912104
2025-03-09 07:35:40,802 [INFO]: 	reconstruction error %: 0.0
2025-03-09 07:35:40,802 [INFO]: 	nb vectors: 4885
2025-03-09 07:35:40,802 [INFO]: 	vectors dimension: 49152
2025-03-09 07:35:40,802 [INFO]: 	compression ratio: 0.9993087151984134
2025-03-09 07:35:40,802 [INFO]: }
2025-03-09 07:35:40,802 [INFO]: 	>>> Finished "Creating the index" in 64.3969 secs
2025-03-09 07:35:40,802 [INFO]: >>> Finished "Launching the whole pipeline" in 64.4284 secs
2025-03-09 07:35:43: [retrieval_preprocessing] calculating distances ...
2025-03-09 07:35:45: [retrieval_preprocessing] finished and saved retrieval indices for episode 10910 [episode count 12/20]
[retrieval_preprocessing] for episode 1184 [episode count 13/20], we have num_retrieval=np.int64(4970) num_query=np.int64(297)
2025-03-09 07:35:46,155 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-09 07:35:47,155 [INFO]: Launching the whole pipeline 03/09/2025, 07:35:47
2025-03-09 07:35:47,155 [INFO]: Reading total number of vectors and dimension 03/09/2025, 07:35:47
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1774.99it/s]
2025-03-09 07:35:47,187 [INFO]: There are 4970 embeddings of dim 49152
2025-03-09 07:35:47,187 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0316 secs
2025-03-09 07:35:47,187 [INFO]: 	Compute estimated construction time of the index 03/09/2025, 07:35:47
2025-03-09 07:35:47,187 [INFO]: 		-> Train: 16.7 minutes
2025-03-09 07:35:47,187 [INFO]: 		-> Add: 2.7 seconds
2025-03-09 07:35:47,187 [INFO]: 		Total: 16.7 minutes
2025-03-09 07:35:47,187 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0001 secs
2025-03-09 07:35:47,187 [INFO]: 	Checking that your have enough memory available to create the index 03/09/2025, 07:35:47
2025-03-09 07:35:47,187 [INFO]: 1.0GB of memory will be needed to build the index (more might be used if you have more)
2025-03-09 07:35:47,187 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0002 secs
2025-03-09 07:35:47,187 [INFO]: 	Selecting most promising index types given data characteristics 03/09/2025, 07:35:47
2025-03-09 07:35:47,187 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-09 07:35:47,187 [INFO]: 	Creating the index 03/09/2025, 07:35:47
2025-03-09 07:35:47,188 [INFO]: 		-> Instanciate the index HNSW15 03/09/2025, 07:35:47
2025-03-09 07:35:47,189 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0011 secs
2025-03-09 07:35:47,189 [INFO]: 		-> Adding the vectors to the index 03/09/2025, 07:35:47
2025-03-09 07:35:47,189 [INFO]: The memory available for adding the vectors is 49.1GB(total available - used by the index)
2025-03-09 07:35:47,189 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/20 [00:00<?, ?it/s]  5%|▌         | 1/20 [00:00<00:02,  8.39it/s] 30%|███       | 6/20 [00:00<00:00, 28.80it/s] 50%|█████     | 10/20 [00:00<00:00, 30.19it/s] 70%|███████   | 14/20 [00:00<00:00, 31.80it/s] 90%|█████████ | 18/20 [00:00<00:00, 34.15it/s]100%|██████████| 20/20 [00:04<00:00,  4.04it/s]
2025-03-09 07:35:52,141 [INFO]: 	Computing best hyperparameters for index knn.index 03/09/2025, 07:35:52
2025-03-09 07:36:37,391 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 45.2492 secs
2025-03-09 07:36:37,391 [INFO]: The best hyperparameters are: efSearch=175
2025-03-09 07:36:37,391 [INFO]: 	Compute fast metrics 03/09/2025, 07:36:37
  0%|          | 0/4 [00:00<?, ?it/s] 25%|██▌       | 1/4 [00:00<00:00,  7.80it/s] 75%|███████▌  | 3/4 [00:00<00:00, 12.64it/s]
2025-03-09 07:36:50,213 [INFO]: 	>>> Finished "Compute fast metrics" in 12.8217 secs
2025-03-09 07:36:50,217 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 63.0277 secs
2025-03-09 07:36:50,217 [INFO]: {
2025-03-09 07:36:50,217 [INFO]: 	index_key: HNSW15
2025-03-09 07:36:50,217 [INFO]: 	index_param: efSearch=175
2025-03-09 07:36:50,217 [INFO]: 	index_path: knn.index
2025-03-09 07:36:50,217 [INFO]: 	size in bytes: 977817730
2025-03-09 07:36:50,217 [INFO]: 	avg_search_speed_ms: 8.466976631084215
2025-03-09 07:36:50,217 [INFO]: 	99p_search_speed_ms: 20.225455472245812
2025-03-09 07:36:50,217 [INFO]: 	reconstruction error %: 0.0
2025-03-09 07:36:50,217 [INFO]: 	nb vectors: 4970
2025-03-09 07:36:50,217 [INFO]: 	vectors dimension: 49152
2025-03-09 07:36:50,217 [INFO]: 	compression ratio: 0.999308695292322
2025-03-09 07:36:50,217 [INFO]: }
2025-03-09 07:36:50,217 [INFO]: 	>>> Finished "Creating the index" in 63.0295 secs
2025-03-09 07:36:50,217 [INFO]: >>> Finished "Launching the whole pipeline" in 63.0620 secs
2025-03-09 07:36:51: [retrieval_preprocessing] calculating distances ...
2025-03-09 07:36:52: [retrieval_preprocessing] finished and saved retrieval indices for episode 1184 [episode count 13/20]
[retrieval_preprocessing] for episode 74018 [episode count 14/20], we have num_retrieval=np.int64(4997) num_query=np.int64(270)
2025-03-09 07:36:53,416 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-09 07:36:54,059 [INFO]: Launching the whole pipeline 03/09/2025, 07:36:54
2025-03-09 07:36:54,059 [INFO]: Reading total number of vectors and dimension 03/09/2025, 07:36:54
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1360.02it/s]
2025-03-09 07:36:54,088 [INFO]: There are 4997 embeddings of dim 49152
2025-03-09 07:36:54,088 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0288 secs
2025-03-09 07:36:54,089 [INFO]: 	Compute estimated construction time of the index 03/09/2025, 07:36:54
2025-03-09 07:36:54,089 [INFO]: 		-> Train: 16.7 minutes
2025-03-09 07:36:54,089 [INFO]: 		-> Add: 2.7 seconds
2025-03-09 07:36:54,089 [INFO]: 		Total: 16.7 minutes
2025-03-09 07:36:54,089 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0003 secs
2025-03-09 07:36:54,089 [INFO]: 	Checking that your have enough memory available to create the index 03/09/2025, 07:36:54
2025-03-09 07:36:54,089 [INFO]: 1.0GB of memory will be needed to build the index (more might be used if you have more)
2025-03-09 07:36:54,090 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0005 secs
2025-03-09 07:36:54,090 [INFO]: 	Selecting most promising index types given data characteristics 03/09/2025, 07:36:54
2025-03-09 07:36:54,090 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-09 07:36:54,090 [INFO]: 	Creating the index 03/09/2025, 07:36:54
2025-03-09 07:36:54,090 [INFO]: 		-> Instanciate the index HNSW15 03/09/2025, 07:36:54
2025-03-09 07:36:54,093 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0028 secs
2025-03-09 07:36:54,093 [INFO]: 		-> Adding the vectors to the index 03/09/2025, 07:36:54
2025-03-09 07:36:54,093 [INFO]: The memory available for adding the vectors is 49.1GB(total available - used by the index)
2025-03-09 07:36:54,094 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/20 [00:00<?, ?it/s]  5%|▌         | 1/20 [00:00<00:04,  4.19it/s] 10%|█         | 2/20 [00:00<00:03,  5.74it/s] 40%|████      | 8/20 [00:00<00:00, 22.98it/s] 70%|███████   | 14/20 [00:00<00:00, 33.86it/s]100%|██████████| 20/20 [00:04<00:00,  3.64it/s]100%|██████████| 20/20 [00:04<00:00,  4.85it/s]
2025-03-09 07:36:58,225 [INFO]: 	Computing best hyperparameters for index knn.index 03/09/2025, 07:36:58
2025-03-09 07:37:42,179 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 43.9537 secs
2025-03-09 07:37:42,179 [INFO]: The best hyperparameters are: efSearch=176
2025-03-09 07:37:42,179 [INFO]: 	Compute fast metrics 03/09/2025, 07:37:42
  0%|          | 0/4 [00:00<?, ?it/s] 50%|█████     | 2/4 [00:00<00:00, 18.54it/s] 75%|███████▌  | 3/4 [00:00<00:00, 19.02it/s]
2025-03-09 07:37:55,040 [INFO]: 	>>> Finished "Compute fast metrics" in 12.8607 secs
2025-03-09 07:37:55,044 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 60.9504 secs
2025-03-09 07:37:55,044 [INFO]: {
2025-03-09 07:37:55,044 [INFO]: 	index_key: HNSW15
2025-03-09 07:37:55,044 [INFO]: 	index_param: efSearch=176
2025-03-09 07:37:55,044 [INFO]: 	index_path: knn.index
2025-03-09 07:37:55,044 [INFO]: 	size in bytes: 983130010
2025-03-09 07:37:55,044 [INFO]: 	avg_search_speed_ms: 8.518151015128934
2025-03-09 07:37:55,044 [INFO]: 	99p_search_speed_ms: 23.57142340391874
2025-03-09 07:37:55,044 [INFO]: 	reconstruction error %: 0.0
2025-03-09 07:37:55,044 [INFO]: 	nb vectors: 4997
2025-03-09 07:37:55,044 [INFO]: 	vectors dimension: 49152
2025-03-09 07:37:55,044 [INFO]: 	compression ratio: 0.9993085004088117
2025-03-09 07:37:55,044 [INFO]: }
2025-03-09 07:37:55,044 [INFO]: 	>>> Finished "Creating the index" in 60.9540 secs
2025-03-09 07:37:55,044 [INFO]: >>> Finished "Launching the whole pipeline" in 60.9846 secs
2025-03-09 07:37:56: [retrieval_preprocessing] calculating distances ...
2025-03-09 07:37:57: [retrieval_preprocessing] finished and saved retrieval indices for episode 74018 [episode count 14/20]
[retrieval_preprocessing] for episode 40357 [episode count 15/20], we have num_retrieval=np.int64(5092) num_query=np.int64(175)
2025-03-09 07:37:57,806 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-09 07:37:58,514 [INFO]: Launching the whole pipeline 03/09/2025, 07:37:58
2025-03-09 07:37:58,514 [INFO]: Reading total number of vectors and dimension 03/09/2025, 07:37:58
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 2090.88it/s]
2025-03-09 07:37:58,546 [INFO]: There are 5092 embeddings of dim 49152
2025-03-09 07:37:58,546 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0321 secs
2025-03-09 07:37:58,547 [INFO]: 	Compute estimated construction time of the index 03/09/2025, 07:37:58
2025-03-09 07:37:58,547 [INFO]: 		-> Train: 16.7 minutes
2025-03-09 07:37:58,547 [INFO]: 		-> Add: 2.8 seconds
2025-03-09 07:37:58,547 [INFO]: 		Total: 16.7 minutes
2025-03-09 07:37:58,547 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0001 secs
2025-03-09 07:37:58,547 [INFO]: 	Checking that your have enough memory available to create the index 03/09/2025, 07:37:58
2025-03-09 07:37:58,547 [INFO]: 1.0GB of memory will be needed to build the index (more might be used if you have more)
2025-03-09 07:37:58,547 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0003 secs
2025-03-09 07:37:58,547 [INFO]: 	Selecting most promising index types given data characteristics 03/09/2025, 07:37:58
2025-03-09 07:37:58,547 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-09 07:37:58,547 [INFO]: 	Creating the index 03/09/2025, 07:37:58
2025-03-09 07:37:58,547 [INFO]: 		-> Instanciate the index HNSW15 03/09/2025, 07:37:58
2025-03-09 07:37:58,549 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0018 secs
2025-03-09 07:37:58,549 [INFO]: 		-> Adding the vectors to the index 03/09/2025, 07:37:58
2025-03-09 07:37:58,549 [INFO]: The memory available for adding the vectors is 49.1GB(total available - used by the index)
2025-03-09 07:37:58,549 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/22 [00:00<?, ?it/s]  5%|▍         | 1/22 [00:00<00:04,  4.22it/s] 27%|██▋       | 6/22 [00:00<00:00, 19.91it/s] 50%|█████     | 11/22 [00:00<00:00, 29.32it/s] 73%|███████▎  | 16/22 [00:00<00:00, 35.18it/s] 95%|█████████▌| 21/22 [00:04<00:00,  3.24it/s]100%|██████████| 22/22 [00:04<00:00,  4.55it/s]
2025-03-09 07:38:03,389 [INFO]: 	Computing best hyperparameters for index knn.index 03/09/2025, 07:38:03
2025-03-09 07:38:48,589 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 45.2007 secs
2025-03-09 07:38:48,590 [INFO]: The best hyperparameters are: efSearch=210
2025-03-09 07:38:48,590 [INFO]: 	Compute fast metrics 03/09/2025, 07:38:48
  0%|          | 0/4 [00:00<?, ?it/s] 50%|█████     | 2/4 [00:00<00:00, 18.02it/s] 75%|███████▌  | 3/4 [00:00<00:00, 19.69it/s]
2025-03-09 07:39:01,742 [INFO]: 	>>> Finished "Compute fast metrics" in 13.1517 secs
2025-03-09 07:39:01,742 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 63.1927 secs
2025-03-09 07:39:01,742 [INFO]: {
2025-03-09 07:39:01,742 [INFO]: 	index_key: HNSW15
2025-03-09 07:39:01,742 [INFO]: 	index_param: efSearch=210
2025-03-09 07:39:01,742 [INFO]: 	index_path: knn.index
2025-03-09 07:39:01,742 [INFO]: 	size in bytes: 1001820670
2025-03-09 07:39:01,742 [INFO]: 	avg_search_speed_ms: 10.36519426635317
2025-03-09 07:39:01,742 [INFO]: 	99p_search_speed_ms: 23.241486065089713
2025-03-09 07:39:01,742 [INFO]: 	reconstruction error %: 0.0
2025-03-09 07:39:01,742 [INFO]: 	nb vectors: 5092
2025-03-09 07:39:01,742 [INFO]: 	vectors dimension: 49152
2025-03-09 07:39:01,742 [INFO]: 	compression ratio: 0.9993085249478831
2025-03-09 07:39:01,742 [INFO]: }
2025-03-09 07:39:01,742 [INFO]: 	>>> Finished "Creating the index" in 63.1949 secs
2025-03-09 07:39:01,742 [INFO]: >>> Finished "Launching the whole pipeline" in 63.2278 secs
2025-03-09 07:39:02: [retrieval_preprocessing] calculating distances ...
2025-03-09 07:39:03: [retrieval_preprocessing] finished and saved retrieval indices for episode 40357 [episode count 15/20]
[retrieval_preprocessing] for episode 3756 [episode count 16/20], we have num_retrieval=np.int64(5093) num_query=np.int64(174)
2025-03-09 07:39:03,650 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-09 07:39:04,330 [INFO]: Launching the whole pipeline 03/09/2025, 07:39:04
2025-03-09 07:39:04,330 [INFO]: Reading total number of vectors and dimension 03/09/2025, 07:39:04
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 2154.24it/s]
2025-03-09 07:39:04,357 [INFO]: There are 5093 embeddings of dim 49152
2025-03-09 07:39:04,357 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0267 secs
2025-03-09 07:39:04,357 [INFO]: 	Compute estimated construction time of the index 03/09/2025, 07:39:04
2025-03-09 07:39:04,357 [INFO]: 		-> Train: 16.7 minutes
2025-03-09 07:39:04,357 [INFO]: 		-> Add: 2.8 seconds
2025-03-09 07:39:04,357 [INFO]: 		Total: 16.7 minutes
2025-03-09 07:39:04,357 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0001 secs
2025-03-09 07:39:04,357 [INFO]: 	Checking that your have enough memory available to create the index 03/09/2025, 07:39:04
2025-03-09 07:39:04,357 [INFO]: 1.0GB of memory will be needed to build the index (more might be used if you have more)
2025-03-09 07:39:04,358 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0001 secs
2025-03-09 07:39:04,358 [INFO]: 	Selecting most promising index types given data characteristics 03/09/2025, 07:39:04
2025-03-09 07:39:04,358 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-09 07:39:04,358 [INFO]: 	Creating the index 03/09/2025, 07:39:04
2025-03-09 07:39:04,358 [INFO]: 		-> Instanciate the index HNSW15 03/09/2025, 07:39:04
2025-03-09 07:39:04,359 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0009 secs
2025-03-09 07:39:04,359 [INFO]: 		-> Adding the vectors to the index 03/09/2025, 07:39:04
2025-03-09 07:39:04,359 [INFO]: The memory available for adding the vectors is 49.1GB(total available - used by the index)
2025-03-09 07:39:04,359 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/22 [00:00<?, ?it/s]  5%|▍         | 1/22 [00:00<00:02,  9.07it/s] 23%|██▎       | 5/22 [00:00<00:00, 26.28it/s] 41%|████      | 9/22 [00:00<00:00, 30.74it/s] 64%|██████▎   | 14/22 [00:00<00:00, 35.56it/s] 86%|████████▋ | 19/22 [00:00<00:00, 38.00it/s]100%|██████████| 22/22 [00:05<00:00,  3.93it/s]
2025-03-09 07:39:09,967 [INFO]: 	Computing best hyperparameters for index knn.index 03/09/2025, 07:39:09
2025-03-09 07:39:55,988 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 46.0207 secs
2025-03-09 07:39:55,988 [INFO]: The best hyperparameters are: efSearch=196
2025-03-09 07:39:55,988 [INFO]: 	Compute fast metrics 03/09/2025, 07:39:55
  0%|          | 0/4 [00:00<?, ?it/s] 50%|█████     | 2/4 [00:00<00:00, 18.55it/s] 75%|███████▌  | 3/4 [00:00<00:00, 20.08it/s]
2025-03-09 07:40:08,852 [INFO]: 	>>> Finished "Compute fast metrics" in 12.8640 secs
2025-03-09 07:40:08,853 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 64.4939 secs
2025-03-09 07:40:08,853 [INFO]: {
2025-03-09 07:40:08,853 [INFO]: 	index_key: HNSW15
2025-03-09 07:40:08,853 [INFO]: 	index_param: efSearch=196
2025-03-09 07:40:08,853 [INFO]: 	index_path: knn.index
2025-03-09 07:40:08,853 [INFO]: 	size in bytes: 1002017410
2025-03-09 07:40:08,853 [INFO]: 	avg_search_speed_ms: 9.034902849638101
2025-03-09 07:40:08,853 [INFO]: 	99p_search_speed_ms: 19.902806396130472
2025-03-09 07:40:08,853 [INFO]: 	reconstruction error %: 0.0
2025-03-09 07:40:08,853 [INFO]: 	nb vectors: 5093
2025-03-09 07:40:08,853 [INFO]: 	vectors dimension: 49152
2025-03-09 07:40:08,853 [INFO]: 	compression ratio: 0.9993085289805493
2025-03-09 07:40:08,853 [INFO]: }
2025-03-09 07:40:08,853 [INFO]: 	>>> Finished "Creating the index" in 64.4957 secs
2025-03-09 07:40:08,853 [INFO]: >>> Finished "Launching the whole pipeline" in 64.5230 secs
2025-03-09 07:40:09: [retrieval_preprocessing] calculating distances ...
2025-03-09 07:40:10: [retrieval_preprocessing] finished and saved retrieval indices for episode 3756 [episode count 16/20]
[retrieval_preprocessing] for episode 51629 [episode count 17/20], we have num_retrieval=np.int64(5013) num_query=np.int64(254)
2025-03-09 07:40:10,593 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-09 07:40:11,244 [INFO]: Launching the whole pipeline 03/09/2025, 07:40:11
2025-03-09 07:40:11,245 [INFO]: Reading total number of vectors and dimension 03/09/2025, 07:40:11
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 2537.39it/s]
2025-03-09 07:40:11,271 [INFO]: There are 5013 embeddings of dim 49152
2025-03-09 07:40:11,272 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0270 secs
2025-03-09 07:40:11,272 [INFO]: 	Compute estimated construction time of the index 03/09/2025, 07:40:11
2025-03-09 07:40:11,272 [INFO]: 		-> Train: 16.7 minutes
2025-03-09 07:40:11,272 [INFO]: 		-> Add: 2.8 seconds
2025-03-09 07:40:11,272 [INFO]: 		Total: 16.7 minutes
2025-03-09 07:40:11,272 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0004 secs
2025-03-09 07:40:11,272 [INFO]: 	Checking that your have enough memory available to create the index 03/09/2025, 07:40:11
2025-03-09 07:40:11,273 [INFO]: 1.0GB of memory will be needed to build the index (more might be used if you have more)
2025-03-09 07:40:11,273 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0004 secs
2025-03-09 07:40:11,273 [INFO]: 	Selecting most promising index types given data characteristics 03/09/2025, 07:40:11
2025-03-09 07:40:11,273 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-09 07:40:11,273 [INFO]: 	Creating the index 03/09/2025, 07:40:11
2025-03-09 07:40:11,273 [INFO]: 		-> Instanciate the index HNSW15 03/09/2025, 07:40:11
2025-03-09 07:40:11,276 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0029 secs
2025-03-09 07:40:11,277 [INFO]: 		-> Adding the vectors to the index 03/09/2025, 07:40:11
2025-03-09 07:40:11,277 [INFO]: The memory available for adding the vectors is 49.1GB(total available - used by the index)
2025-03-09 07:40:11,277 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/20 [00:00<?, ?it/s] 10%|█         | 2/20 [00:00<00:00, 18.59it/s] 40%|████      | 8/20 [00:00<00:00, 38.61it/s] 65%|██████▌   | 13/20 [00:00<00:00, 43.44it/s] 90%|█████████ | 18/20 [00:00<00:00, 45.80it/s]100%|██████████| 20/20 [00:04<00:00,  4.90it/s]
2025-03-09 07:40:15,366 [INFO]: 	Computing best hyperparameters for index knn.index 03/09/2025, 07:40:15
2025-03-09 07:40:56,514 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 41.1476 secs
2025-03-09 07:40:56,514 [INFO]: The best hyperparameters are: efSearch=207
2025-03-09 07:40:56,514 [INFO]: 	Compute fast metrics 03/09/2025, 07:40:56
  0%|          | 0/4 [00:00<?, ?it/s] 50%|█████     | 2/4 [00:00<00:00, 18.46it/s] 75%|███████▌  | 3/4 [00:00<00:00, 19.77it/s]
2025-03-09 07:41:10,136 [INFO]: 	>>> Finished "Compute fast metrics" in 13.6217 secs
2025-03-09 07:41:10,138 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 58.8617 secs
2025-03-09 07:41:10,139 [INFO]: {
2025-03-09 07:41:10,139 [INFO]: 	index_key: HNSW15
2025-03-09 07:41:10,139 [INFO]: 	index_param: efSearch=207
2025-03-09 07:41:10,139 [INFO]: 	index_path: knn.index
2025-03-09 07:41:10,139 [INFO]: 	size in bytes: 986277850
2025-03-09 07:41:10,139 [INFO]: 	avg_search_speed_ms: 10.371609165138059
2025-03-09 07:41:10,139 [INFO]: 	99p_search_speed_ms: 22.376719468738884
2025-03-09 07:41:10,139 [INFO]: 	reconstruction error %: 0.0
2025-03-09 07:41:10,139 [INFO]: 	nb vectors: 5013
2025-03-09 07:41:10,139 [INFO]: 	vectors dimension: 49152
2025-03-09 07:41:10,139 [INFO]: 	compression ratio: 0.9993085660394786
2025-03-09 07:41:10,139 [INFO]: }
2025-03-09 07:41:10,139 [INFO]: 	>>> Finished "Creating the index" in 58.8656 secs
2025-03-09 07:41:10,139 [INFO]: >>> Finished "Launching the whole pipeline" in 58.8943 secs
2025-03-09 07:41:11: [retrieval_preprocessing] calculating distances ...
2025-03-09 07:41:11: [retrieval_preprocessing] finished and saved retrieval indices for episode 51629 [episode count 17/20]
[retrieval_preprocessing] for episode 19121 [episode count 18/20], we have num_retrieval=np.int64(5047) num_query=np.int64(220)
2025-03-09 07:41:12,391 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-09 07:41:13,295 [INFO]: Launching the whole pipeline 03/09/2025, 07:41:13
2025-03-09 07:41:13,295 [INFO]: Reading total number of vectors and dimension 03/09/2025, 07:41:13
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1713.36it/s]
2025-03-09 07:41:13,325 [INFO]: There are 5047 embeddings of dim 49152
2025-03-09 07:41:13,326 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0310 secs
2025-03-09 07:41:13,326 [INFO]: 	Compute estimated construction time of the index 03/09/2025, 07:41:13
2025-03-09 07:41:13,326 [INFO]: 		-> Train: 16.7 minutes
2025-03-09 07:41:13,326 [INFO]: 		-> Add: 2.8 seconds
2025-03-09 07:41:13,326 [INFO]: 		Total: 16.7 minutes
2025-03-09 07:41:13,327 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0004 secs
2025-03-09 07:41:13,327 [INFO]: 	Checking that your have enough memory available to create the index 03/09/2025, 07:41:13
2025-03-09 07:41:13,327 [INFO]: 1.0GB of memory will be needed to build the index (more might be used if you have more)
2025-03-09 07:41:13,327 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0005 secs
2025-03-09 07:41:13,327 [INFO]: 	Selecting most promising index types given data characteristics 03/09/2025, 07:41:13
2025-03-09 07:41:13,327 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-09 07:41:13,328 [INFO]: 	Creating the index 03/09/2025, 07:41:13
2025-03-09 07:41:13,328 [INFO]: 		-> Instanciate the index HNSW15 03/09/2025, 07:41:13
2025-03-09 07:41:13,331 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0028 secs
2025-03-09 07:41:13,331 [INFO]: 		-> Adding the vectors to the index 03/09/2025, 07:41:13
2025-03-09 07:41:13,331 [INFO]: The memory available for adding the vectors is 49.1GB(total available - used by the index)
2025-03-09 07:41:13,331 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/20 [00:00<?, ?it/s] 10%|█         | 2/20 [00:00<00:00, 18.61it/s] 35%|███▌      | 7/20 [00:00<00:00, 33.38it/s] 60%|██████    | 12/20 [00:00<00:00, 40.41it/s] 90%|█████████ | 18/20 [00:00<00:00, 44.60it/s]100%|██████████| 20/20 [00:04<00:00,  4.81it/s]
2025-03-09 07:41:17,495 [INFO]: 	Computing best hyperparameters for index knn.index 03/09/2025, 07:41:17
2025-03-09 07:42:00,018 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 42.5228 secs
2025-03-09 07:42:00,018 [INFO]: The best hyperparameters are: efSearch=232
2025-03-09 07:42:00,019 [INFO]: 	Compute fast metrics 03/09/2025, 07:42:00
  0%|          | 0/4 [00:00<?, ?it/s] 50%|█████     | 2/4 [00:00<00:00, 19.25it/s] 75%|███████▌  | 3/4 [00:00<00:00, 21.24it/s]
2025-03-09 07:42:13,082 [INFO]: 	>>> Finished "Compute fast metrics" in 13.0629 secs
2025-03-09 07:42:13,085 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 59.7536 secs
2025-03-09 07:42:13,085 [INFO]: {
2025-03-09 07:42:13,085 [INFO]: 	index_key: HNSW15
2025-03-09 07:42:13,085 [INFO]: 	index_param: efSearch=232
2025-03-09 07:42:13,085 [INFO]: 	index_path: knn.index
2025-03-09 07:42:13,085 [INFO]: 	size in bytes: 992967250
2025-03-09 07:42:13,085 [INFO]: 	avg_search_speed_ms: 10.139796132898113
2025-03-09 07:42:13,085 [INFO]: 	99p_search_speed_ms: 21.679302805569012
2025-03-09 07:42:13,085 [INFO]: 	reconstruction error %: 0.0
2025-03-09 07:42:13,085 [INFO]: 	nb vectors: 5047
2025-03-09 07:42:13,085 [INFO]: 	vectors dimension: 49152
2025-03-09 07:42:13,085 [INFO]: 	compression ratio: 0.9993084625902818
2025-03-09 07:42:13,085 [INFO]: }
2025-03-09 07:42:13,085 [INFO]: 	>>> Finished "Creating the index" in 59.7574 secs
2025-03-09 07:42:13,085 [INFO]: >>> Finished "Launching the whole pipeline" in 59.7902 secs
2025-03-09 07:42:14: [retrieval_preprocessing] calculating distances ...
2025-03-09 07:42:15: [retrieval_preprocessing] finished and saved retrieval indices for episode 19121 [episode count 18/20]
[retrieval_preprocessing] for episode 81457 [episode count 19/20], we have num_retrieval=np.int64(4996) num_query=np.int64(271)
2025-03-09 07:42:15,791 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-09 07:42:16,499 [INFO]: Launching the whole pipeline 03/09/2025, 07:42:16
2025-03-09 07:42:16,499 [INFO]: Reading total number of vectors and dimension 03/09/2025, 07:42:16
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1504.95it/s]
2025-03-09 07:42:16,527 [INFO]: There are 4996 embeddings of dim 49152
2025-03-09 07:42:16,527 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0278 secs
2025-03-09 07:42:16,527 [INFO]: 	Compute estimated construction time of the index 03/09/2025, 07:42:16
2025-03-09 07:42:16,527 [INFO]: 		-> Train: 16.7 minutes
2025-03-09 07:42:16,527 [INFO]: 		-> Add: 2.7 seconds
2025-03-09 07:42:16,527 [INFO]: 		Total: 16.7 minutes
2025-03-09 07:42:16,527 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0001 secs
2025-03-09 07:42:16,527 [INFO]: 	Checking that your have enough memory available to create the index 03/09/2025, 07:42:16
2025-03-09 07:42:16,527 [INFO]: 1.0GB of memory will be needed to build the index (more might be used if you have more)
2025-03-09 07:42:16,527 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0001 secs
2025-03-09 07:42:16,527 [INFO]: 	Selecting most promising index types given data characteristics 03/09/2025, 07:42:16
2025-03-09 07:42:16,527 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-09 07:42:16,527 [INFO]: 	Creating the index 03/09/2025, 07:42:16
2025-03-09 07:42:16,527 [INFO]: 		-> Instanciate the index HNSW15 03/09/2025, 07:42:16
2025-03-09 07:42:16,528 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0009 secs
2025-03-09 07:42:16,528 [INFO]: 		-> Adding the vectors to the index 03/09/2025, 07:42:16
2025-03-09 07:42:16,529 [INFO]: The memory available for adding the vectors is 49.1GB(total available - used by the index)
2025-03-09 07:42:16,529 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/20 [00:00<?, ?it/s]  5%|▌         | 1/20 [00:00<00:02,  7.96it/s] 35%|███▌      | 7/20 [00:00<00:00, 34.19it/s] 65%|██████▌   | 13/20 [00:00<00:00, 43.78it/s] 95%|█████████▌| 19/20 [00:00<00:00, 48.69it/s]100%|██████████| 20/20 [00:03<00:00,  5.11it/s]
2025-03-09 07:42:20,443 [INFO]: 	Computing best hyperparameters for index knn.index 03/09/2025, 07:42:20
2025-03-09 07:43:03,539 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 43.0954 secs
2025-03-09 07:43:03,539 [INFO]: The best hyperparameters are: efSearch=208
2025-03-09 07:43:03,539 [INFO]: 	Compute fast metrics 03/09/2025, 07:43:03
  0%|          | 0/4 [00:00<?, ?it/s] 50%|█████     | 2/4 [00:00<00:00, 18.86it/s] 75%|███████▌  | 3/4 [00:00<00:00, 20.19it/s]
2025-03-09 07:43:16,853 [INFO]: 	>>> Finished "Compute fast metrics" in 13.3143 secs
2025-03-09 07:43:16,856 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 60.3274 secs
2025-03-09 07:43:16,856 [INFO]: {
2025-03-09 07:43:16,856 [INFO]: 	index_key: HNSW15
2025-03-09 07:43:16,856 [INFO]: 	index_param: efSearch=208
2025-03-09 07:43:16,856 [INFO]: 	index_path: knn.index
2025-03-09 07:43:16,856 [INFO]: 	size in bytes: 982933270
2025-03-09 07:43:16,856 [INFO]: 	avg_search_speed_ms: 9.5999149885833
2025-03-09 07:43:16,856 [INFO]: 	99p_search_speed_ms: 23.756137860473196
2025-03-09 07:43:16,856 [INFO]: 	reconstruction error %: 0.0
2025-03-09 07:43:16,856 [INFO]: 	nb vectors: 4996
2025-03-09 07:43:16,856 [INFO]: 	vectors dimension: 49152
2025-03-09 07:43:16,856 [INFO]: 	compression ratio: 0.9993084962929376
2025-03-09 07:43:16,856 [INFO]: }
2025-03-09 07:43:16,856 [INFO]: 	>>> Finished "Creating the index" in 60.3288 secs
2025-03-09 07:43:16,856 [INFO]: >>> Finished "Launching the whole pipeline" in 60.3572 secs
2025-03-09 07:43:17: [retrieval_preprocessing] calculating distances ...
2025-03-09 07:43:18: [retrieval_preprocessing] finished and saved retrieval indices for episode 81457 [episode count 19/20]
2025-03-09 07:43:18: [retrieval_preprocessing] finished for (5511329841, 'marker') [chosen_id count 2/10]
2025-03-09 07:43:20: [retrieval_preprocessing] concatenated all embeddings and indices for 20 episodes for (3951366978, 'cup') [chosen_id count 3/10]
2025-03-09 07:43:20: [retrieval_preprocessing] we have num_total=2698 embedding_dim=49152
[retrieval_preprocessing] for episode 28160 [episode count 0/20], we have num_retrieval=np.int64(2528) num_query=np.int64(170)
2025-03-09 07:43:20,448 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-09 07:43:20,849 [INFO]: Launching the whole pipeline 03/09/2025, 07:43:20
2025-03-09 07:43:20,849 [INFO]: Reading total number of vectors and dimension 03/09/2025, 07:43:20
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1790.91it/s]
2025-03-09 07:43:20,877 [INFO]: There are 2528 embeddings of dim 49152
2025-03-09 07:43:20,877 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0279 secs
2025-03-09 07:43:20,877 [INFO]: 	Compute estimated construction time of the index 03/09/2025, 07:43:20
2025-03-09 07:43:20,877 [INFO]: 		-> Train: 16.7 minutes
2025-03-09 07:43:20,877 [INFO]: 		-> Add: 1.4 seconds
2025-03-09 07:43:20,877 [INFO]: 		Total: 16.7 minutes
2025-03-09 07:43:20,877 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0001 secs
2025-03-09 07:43:20,877 [INFO]: 	Checking that your have enough memory available to create the index 03/09/2025, 07:43:20
2025-03-09 07:43:20,878 [INFO]: 521.7MB of memory will be needed to build the index (more might be used if you have more)
2025-03-09 07:43:20,878 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0001 secs
2025-03-09 07:43:20,878 [INFO]: 	Selecting most promising index types given data characteristics 03/09/2025, 07:43:20
2025-03-09 07:43:20,878 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-09 07:43:20,878 [INFO]: 	Creating the index 03/09/2025, 07:43:20
2025-03-09 07:43:20,878 [INFO]: 		-> Instanciate the index HNSW15 03/09/2025, 07:43:20
2025-03-09 07:43:20,879 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0011 secs
2025-03-09 07:43:20,879 [INFO]: 		-> Adding the vectors to the index 03/09/2025, 07:43:20
2025-03-09 07:43:20,879 [INFO]: The memory available for adding the vectors is 49.5GB(total available - used by the index)
2025-03-09 07:43:20,879 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/10 [00:00<?, ?it/s] 20%|██        | 2/10 [00:00<00:00, 17.43it/s] 80%|████████  | 8/10 [00:00<00:00, 37.21it/s]100%|██████████| 10/10 [00:01<00:00,  5.21it/s]
2025-03-09 07:43:22,804 [INFO]: 	Computing best hyperparameters for index knn.index 03/09/2025, 07:43:22
2025-03-09 07:43:48,786 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 25.9823 secs
2025-03-09 07:43:48,787 [INFO]: The best hyperparameters are: efSearch=158
2025-03-09 07:43:48,787 [INFO]: 	Compute fast metrics 03/09/2025, 07:43:48
  0%|          | 0/4 [00:00<?, ?it/s] 25%|██▌       | 1/4 [00:00<00:00,  8.78it/s] 75%|███████▌  | 3/4 [00:00<00:00, 16.93it/s]
2025-03-09 07:44:02,162 [INFO]: 	>>> Finished "Compute fast metrics" in 13.3749 secs
2025-03-09 07:44:02,164 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 41.2845 secs
2025-03-09 07:44:02,164 [INFO]: {
2025-03-09 07:44:02,164 [INFO]: 	index_key: HNSW15
2025-03-09 07:44:02,164 [INFO]: 	index_param: efSearch=158
2025-03-09 07:44:02,164 [INFO]: 	index_path: knn.index
2025-03-09 07:44:02,164 [INFO]: 	size in bytes: 497368330
2025-03-09 07:44:02,164 [INFO]: 	avg_search_speed_ms: 7.899395460343815
2025-03-09 07:44:02,164 [INFO]: 	99p_search_speed_ms: 15.61228967038914
2025-03-09 07:44:02,164 [INFO]: 	reconstruction error %: 0.0
2025-03-09 07:44:02,164 [INFO]: 	nb vectors: 2528
2025-03-09 07:44:02,164 [INFO]: 	vectors dimension: 49152
2025-03-09 07:44:02,164 [INFO]: 	compression ratio: 0.9993097550059128
2025-03-09 07:44:02,164 [INFO]: }
2025-03-09 07:44:02,164 [INFO]: 	>>> Finished "Creating the index" in 41.2862 secs
2025-03-09 07:44:02,164 [INFO]: >>> Finished "Launching the whole pipeline" in 41.3148 secs
2025-03-09 07:44:02: [retrieval_preprocessing] calculating distances ...
2025-03-09 07:44:03: [retrieval_preprocessing] finished and saved retrieval indices for episode 28160 [episode count 0/20]
[retrieval_preprocessing] for episode 56339 [episode count 1/20], we have num_retrieval=np.int64(2515) num_query=np.int64(183)
2025-03-09 07:44:03,797 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-09 07:44:04,227 [INFO]: Launching the whole pipeline 03/09/2025, 07:44:04
2025-03-09 07:44:04,227 [INFO]: Reading total number of vectors and dimension 03/09/2025, 07:44:04
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1770.50it/s]
2025-03-09 07:44:04,259 [INFO]: There are 2515 embeddings of dim 49152
2025-03-09 07:44:04,260 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0327 secs
2025-03-09 07:44:04,260 [INFO]: 	Compute estimated construction time of the index 03/09/2025, 07:44:04
2025-03-09 07:44:04,260 [INFO]: 		-> Train: 16.7 minutes
2025-03-09 07:44:04,260 [INFO]: 		-> Add: 1.4 seconds
2025-03-09 07:44:04,260 [INFO]: 		Total: 16.7 minutes
2025-03-09 07:44:04,260 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0001 secs
2025-03-09 07:44:04,260 [INFO]: 	Checking that your have enough memory available to create the index 03/09/2025, 07:44:04
2025-03-09 07:44:04,260 [INFO]: 519.0MB of memory will be needed to build the index (more might be used if you have more)
2025-03-09 07:44:04,260 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0002 secs
2025-03-09 07:44:04,260 [INFO]: 	Selecting most promising index types given data characteristics 03/09/2025, 07:44:04
2025-03-09 07:44:04,260 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-09 07:44:04,260 [INFO]: 	Creating the index 03/09/2025, 07:44:04
2025-03-09 07:44:04,260 [INFO]: 		-> Instanciate the index HNSW15 03/09/2025, 07:44:04
2025-03-09 07:44:04,261 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0010 secs
2025-03-09 07:44:04,261 [INFO]: 		-> Adding the vectors to the index 03/09/2025, 07:44:04
2025-03-09 07:44:04,261 [INFO]: The memory available for adding the vectors is 49.5GB(total available - used by the index)
2025-03-09 07:44:04,261 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/10 [00:00<?, ?it/s] 10%|█         | 1/10 [00:00<00:01,  8.83it/s] 50%|█████     | 5/10 [00:00<00:00, 25.93it/s] 90%|█████████ | 9/10 [00:00<00:00, 31.93it/s]100%|██████████| 10/10 [00:02<00:00,  4.20it/s]
2025-03-09 07:44:06,646 [INFO]: 	Computing best hyperparameters for index knn.index 03/09/2025, 07:44:06
2025-03-09 07:44:39,460 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 32.8134 secs
2025-03-09 07:44:39,460 [INFO]: The best hyperparameters are: efSearch=243
2025-03-09 07:44:39,460 [INFO]: 	Compute fast metrics 03/09/2025, 07:44:39
  0%|          | 0/4 [00:00<?, ?it/s] 50%|█████     | 2/4 [00:00<00:00, 19.92it/s] 75%|███████▌  | 3/4 [00:00<00:00, 22.07it/s]
2025-03-09 07:44:53,401 [INFO]: 	>>> Finished "Compute fast metrics" in 13.9404 secs
2025-03-09 07:44:53,402 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 49.1410 secs
2025-03-09 07:44:53,403 [INFO]: {
2025-03-09 07:44:53,403 [INFO]: 	index_key: HNSW15
2025-03-09 07:44:53,403 [INFO]: 	index_param: efSearch=243
2025-03-09 07:44:53,403 [INFO]: 	index_path: knn.index
2025-03-09 07:44:53,403 [INFO]: 	size in bytes: 494810590
2025-03-09 07:44:53,403 [INFO]: 	avg_search_speed_ms: 9.816655497294253
2025-03-09 07:44:53,403 [INFO]: 	99p_search_speed_ms: 22.389221997000273
2025-03-09 07:44:53,403 [INFO]: 	reconstruction error %: 0.0
2025-03-09 07:44:53,403 [INFO]: 	nb vectors: 2515
2025-03-09 07:44:53,403 [INFO]: 	vectors dimension: 49152
2025-03-09 07:44:53,403 [INFO]: 	compression ratio: 0.9993098975508993
2025-03-09 07:44:53,403 [INFO]: }
2025-03-09 07:44:53,403 [INFO]: 	>>> Finished "Creating the index" in 49.1424 secs
2025-03-09 07:44:53,403 [INFO]: >>> Finished "Launching the whole pipeline" in 49.1757 secs
2025-03-09 07:44:54: [retrieval_preprocessing] calculating distances ...
2025-03-09 07:44:55: [retrieval_preprocessing] finished and saved retrieval indices for episode 56339 [episode count 1/20]
[retrieval_preprocessing] for episode 28184 [episode count 2/20], we have num_retrieval=np.int64(2597) num_query=np.int64(101)
2025-03-09 07:44:55,352 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-09 07:44:55,703 [INFO]: Launching the whole pipeline 03/09/2025, 07:44:55
2025-03-09 07:44:55,703 [INFO]: Reading total number of vectors and dimension 03/09/2025, 07:44:55
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 2139.95it/s]
2025-03-09 07:44:55,732 [INFO]: There are 2597 embeddings of dim 49152
2025-03-09 07:44:55,732 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0297 secs
2025-03-09 07:44:55,733 [INFO]: 	Compute estimated construction time of the index 03/09/2025, 07:44:55
2025-03-09 07:44:55,733 [INFO]: 		-> Train: 16.7 minutes
2025-03-09 07:44:55,733 [INFO]: 		-> Add: 1.4 seconds
2025-03-09 07:44:55,733 [INFO]: 		Total: 16.7 minutes
2025-03-09 07:44:55,733 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0004 secs
2025-03-09 07:44:55,733 [INFO]: 	Checking that your have enough memory available to create the index 03/09/2025, 07:44:55
2025-03-09 07:44:55,733 [INFO]: 536.0MB of memory will be needed to build the index (more might be used if you have more)
2025-03-09 07:44:55,734 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0005 secs
2025-03-09 07:44:55,734 [INFO]: 	Selecting most promising index types given data characteristics 03/09/2025, 07:44:55
2025-03-09 07:44:55,734 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-09 07:44:55,734 [INFO]: 	Creating the index 03/09/2025, 07:44:55
2025-03-09 07:44:55,734 [INFO]: 		-> Instanciate the index HNSW15 03/09/2025, 07:44:55
2025-03-09 07:44:55,737 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0029 secs
2025-03-09 07:44:55,737 [INFO]: 		-> Adding the vectors to the index 03/09/2025, 07:44:55
2025-03-09 07:44:55,738 [INFO]: The memory available for adding the vectors is 49.5GB(total available - used by the index)
2025-03-09 07:44:55,738 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/11 [00:00<?, ?it/s] 27%|██▋       | 3/11 [00:00<00:00, 25.47it/s] 64%|██████▎   | 7/11 [00:00<00:00, 32.26it/s]100%|██████████| 11/11 [00:02<00:00,  3.83it/s]100%|██████████| 11/11 [00:02<00:00,  4.88it/s]
2025-03-09 07:44:57,998 [INFO]: 	Computing best hyperparameters for index knn.index 03/09/2025, 07:44:57
2025-03-09 07:45:27,306 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 29.3081 secs
2025-03-09 07:45:27,306 [INFO]: The best hyperparameters are: efSearch=230
2025-03-09 07:45:27,306 [INFO]: 	Compute fast metrics 03/09/2025, 07:45:27
  0%|          | 0/4 [00:00<?, ?it/s] 50%|█████     | 2/4 [00:00<00:00, 16.96it/s] 75%|███████▌  | 3/4 [00:00<00:00, 18.46it/s]
2025-03-09 07:45:40,199 [INFO]: 	>>> Finished "Compute fast metrics" in 12.8926 secs
2025-03-09 07:45:40,201 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 44.4630 secs
2025-03-09 07:45:40,201 [INFO]: {
2025-03-09 07:45:40,201 [INFO]: 	index_key: HNSW15
2025-03-09 07:45:40,201 [INFO]: 	index_param: efSearch=230
2025-03-09 07:45:40,201 [INFO]: 	index_path: knn.index
2025-03-09 07:45:40,201 [INFO]: 	size in bytes: 510943810
2025-03-09 07:45:40,201 [INFO]: 	avg_search_speed_ms: 9.495260593713972
2025-03-09 07:45:40,201 [INFO]: 	99p_search_speed_ms: 22.09192381240428
2025-03-09 07:45:40,201 [INFO]: 	reconstruction error %: 0.0
2025-03-09 07:45:40,201 [INFO]: 	nb vectors: 2597
2025-03-09 07:45:40,201 [INFO]: 	vectors dimension: 49152
2025-03-09 07:45:40,201 [INFO]: 	compression ratio: 0.9993094465710427
2025-03-09 07:45:40,201 [INFO]: }
2025-03-09 07:45:40,201 [INFO]: 	>>> Finished "Creating the index" in 44.4669 secs
2025-03-09 07:45:40,201 [INFO]: >>> Finished "Launching the whole pipeline" in 44.4983 secs
2025-03-09 07:45:40: [retrieval_preprocessing] calculating distances ...
2025-03-09 07:45:41: [retrieval_preprocessing] finished and saved retrieval indices for episode 28184 [episode count 2/20]
[retrieval_preprocessing] for episode 38936 [episode count 3/20], we have num_retrieval=np.int64(2575) num_query=np.int64(123)
2025-03-09 07:45:41,429 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-09 07:45:41,770 [INFO]: Launching the whole pipeline 03/09/2025, 07:45:41
2025-03-09 07:45:41,770 [INFO]: Reading total number of vectors and dimension 03/09/2025, 07:45:41
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 2219.21it/s]
2025-03-09 07:45:41,799 [INFO]: There are 2575 embeddings of dim 49152
2025-03-09 07:45:41,799 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0289 secs
2025-03-09 07:45:41,800 [INFO]: 	Compute estimated construction time of the index 03/09/2025, 07:45:41
2025-03-09 07:45:41,800 [INFO]: 		-> Train: 16.7 minutes
2025-03-09 07:45:41,800 [INFO]: 		-> Add: 1.4 seconds
2025-03-09 07:45:41,800 [INFO]: 		Total: 16.7 minutes
2025-03-09 07:45:41,800 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0002 secs
2025-03-09 07:45:41,800 [INFO]: 	Checking that your have enough memory available to create the index 03/09/2025, 07:45:41
2025-03-09 07:45:41,800 [INFO]: 531.4MB of memory will be needed to build the index (more might be used if you have more)
2025-03-09 07:45:41,800 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0004 secs
2025-03-09 07:45:41,801 [INFO]: 	Selecting most promising index types given data characteristics 03/09/2025, 07:45:41
2025-03-09 07:45:41,801 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-09 07:45:41,801 [INFO]: 	Creating the index 03/09/2025, 07:45:41
2025-03-09 07:45:41,801 [INFO]: 		-> Instanciate the index HNSW15 03/09/2025, 07:45:41
2025-03-09 07:45:41,803 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0020 secs
2025-03-09 07:45:41,803 [INFO]: 		-> Adding the vectors to the index 03/09/2025, 07:45:41
2025-03-09 07:45:41,804 [INFO]: The memory available for adding the vectors is 49.5GB(total available - used by the index)
2025-03-09 07:45:41,804 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/11 [00:00<?, ?it/s] 18%|█▊        | 2/11 [00:00<00:00, 17.64it/s] 55%|█████▍    | 6/11 [00:00<00:00, 27.62it/s]100%|██████████| 11/11 [00:01<00:00,  4.64it/s]100%|██████████| 11/11 [00:01<00:00,  5.53it/s]
2025-03-09 07:45:43,797 [INFO]: 	Computing best hyperparameters for index knn.index 03/09/2025, 07:45:43
2025-03-09 07:46:19,395 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 35.5972 secs
2025-03-09 07:46:19,395 [INFO]: The best hyperparameters are: efSearch=254
2025-03-09 07:46:19,395 [INFO]: 	Compute fast metrics 03/09/2025, 07:46:19
  0%|          | 0/4 [00:00<?, ?it/s] 75%|███████▌  | 3/4 [00:00<00:00, 27.62it/s] 75%|███████▌  | 3/4 [00:00<00:00, 23.64it/s]
2025-03-09 07:46:36,739 [INFO]: 	>>> Finished "Compute fast metrics" in 17.3434 secs
2025-03-09 07:46:36,740 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 54.9366 secs
2025-03-09 07:46:36,740 [INFO]: {
2025-03-09 07:46:36,740 [INFO]: 	index_key: HNSW15
2025-03-09 07:46:36,740 [INFO]: 	index_param: efSearch=254
2025-03-09 07:46:36,740 [INFO]: 	index_path: knn.index
2025-03-09 07:46:36,740 [INFO]: 	size in bytes: 506615410
2025-03-09 07:46:36,740 [INFO]: 	avg_search_speed_ms: 9.610790861090583
2025-03-09 07:46:36,740 [INFO]: 	99p_search_speed_ms: 18.524866877123703
2025-03-09 07:46:36,740 [INFO]: 	reconstruction error %: 0.0
2025-03-09 07:46:36,740 [INFO]: 	nb vectors: 2575
2025-03-09 07:46:36,740 [INFO]: 	vectors dimension: 49152
2025-03-09 07:46:36,740 [INFO]: 	compression ratio: 0.9993095156738323
2025-03-09 07:46:36,740 [INFO]: }
2025-03-09 07:46:36,740 [INFO]: 	>>> Finished "Creating the index" in 54.9396 secs
2025-03-09 07:46:36,740 [INFO]: >>> Finished "Launching the whole pipeline" in 54.9701 secs
2025-03-09 07:46:37: [retrieval_preprocessing] calculating distances ...
2025-03-09 07:46:37: [retrieval_preprocessing] finished and saved retrieval indices for episode 38936 [episode count 3/20]
[retrieval_preprocessing] for episode 2076 [episode count 4/20], we have num_retrieval=np.int64(2591) num_query=np.int64(107)
2025-03-09 07:46:38,116 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-09 07:46:38,479 [INFO]: Launching the whole pipeline 03/09/2025, 07:46:38
2025-03-09 07:46:38,480 [INFO]: Reading total number of vectors and dimension 03/09/2025, 07:46:38
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1589.35it/s]
2025-03-09 07:46:38,510 [INFO]: There are 2591 embeddings of dim 49152
2025-03-09 07:46:38,510 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0309 secs
2025-03-09 07:46:38,510 [INFO]: 	Compute estimated construction time of the index 03/09/2025, 07:46:38
2025-03-09 07:46:38,511 [INFO]: 		-> Train: 16.7 minutes
2025-03-09 07:46:38,511 [INFO]: 		-> Add: 1.4 seconds
2025-03-09 07:46:38,511 [INFO]: 		Total: 16.7 minutes
2025-03-09 07:46:38,511 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0001 secs
2025-03-09 07:46:38,511 [INFO]: 	Checking that your have enough memory available to create the index 03/09/2025, 07:46:38
2025-03-09 07:46:38,511 [INFO]: 534.7MB of memory will be needed to build the index (more might be used if you have more)
2025-03-09 07:46:38,511 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0002 secs
2025-03-09 07:46:38,511 [INFO]: 	Selecting most promising index types given data characteristics 03/09/2025, 07:46:38
2025-03-09 07:46:38,511 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-09 07:46:38,511 [INFO]: 	Creating the index 03/09/2025, 07:46:38
2025-03-09 07:46:38,511 [INFO]: 		-> Instanciate the index HNSW15 03/09/2025, 07:46:38
2025-03-09 07:46:38,512 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0008 secs
2025-03-09 07:46:38,512 [INFO]: 		-> Adding the vectors to the index 03/09/2025, 07:46:38
2025-03-09 07:46:38,512 [INFO]: The memory available for adding the vectors is 49.5GB(total available - used by the index)
2025-03-09 07:46:38,512 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/11 [00:00<?, ?it/s] 18%|█▊        | 2/11 [00:00<00:00, 15.56it/s] 55%|█████▍    | 6/11 [00:00<00:00, 27.76it/s]100%|██████████| 11/11 [00:02<00:00,  4.19it/s]100%|██████████| 11/11 [00:02<00:00,  5.01it/s]
2025-03-09 07:46:40,710 [INFO]: 	Computing best hyperparameters for index knn.index 03/09/2025, 07:46:40
2025-03-09 07:47:15,646 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 34.9355 secs
2025-03-09 07:47:15,646 [INFO]: The best hyperparameters are: efSearch=224
2025-03-09 07:47:15,646 [INFO]: 	Compute fast metrics 03/09/2025, 07:47:15
  0%|          | 0/4 [00:00<?, ?it/s] 50%|█████     | 2/4 [00:00<00:00, 19.61it/s] 75%|███████▌  | 3/4 [00:00<00:00, 21.37it/s]
2025-03-09 07:47:27,858 [INFO]: 	>>> Finished "Compute fast metrics" in 12.2119 secs
2025-03-09 07:47:27,860 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 49.3477 secs
2025-03-09 07:47:27,860 [INFO]: {
2025-03-09 07:47:27,860 [INFO]: 	index_key: HNSW15
2025-03-09 07:47:27,860 [INFO]: 	index_param: efSearch=224
2025-03-09 07:47:27,860 [INFO]: 	index_path: knn.index
2025-03-09 07:47:27,860 [INFO]: 	size in bytes: 509763370
2025-03-09 07:47:27,860 [INFO]: 	avg_search_speed_ms: 8.74029130890445
2025-03-09 07:47:27,860 [INFO]: 	99p_search_speed_ms: 17.91852352209387
2025-03-09 07:47:27,860 [INFO]: 	reconstruction error %: 0.0
2025-03-09 07:47:27,860 [INFO]: 	nb vectors: 2591
2025-03-09 07:47:27,860 [INFO]: 	vectors dimension: 49152
2025-03-09 07:47:27,860 [INFO]: 	compression ratio: 0.9993094011442996
2025-03-09 07:47:27,860 [INFO]: }
2025-03-09 07:47:27,860 [INFO]: 	>>> Finished "Creating the index" in 49.3489 secs
2025-03-09 07:47:27,860 [INFO]: >>> Finished "Launching the whole pipeline" in 49.3805 secs
2025-03-09 07:47:28: [retrieval_preprocessing] calculating distances ...
2025-03-09 07:47:28: [retrieval_preprocessing] finished and saved retrieval indices for episode 2076 [episode count 4/20]
[retrieval_preprocessing] for episode 83484 [episode count 5/20], we have num_retrieval=np.int64(2577) num_query=np.int64(121)
2025-03-09 07:47:28,891 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-09 07:47:29,236 [INFO]: Launching the whole pipeline 03/09/2025, 07:47:29
2025-03-09 07:47:29,236 [INFO]: Reading total number of vectors and dimension 03/09/2025, 07:47:29
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1493.70it/s]
2025-03-09 07:47:29,260 [INFO]: There are 2577 embeddings of dim 49152
2025-03-09 07:47:29,260 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0246 secs
2025-03-09 07:47:29,260 [INFO]: 	Compute estimated construction time of the index 03/09/2025, 07:47:29
2025-03-09 07:47:29,260 [INFO]: 		-> Train: 16.7 minutes
2025-03-09 07:47:29,260 [INFO]: 		-> Add: 1.4 seconds
2025-03-09 07:47:29,261 [INFO]: 		Total: 16.7 minutes
2025-03-09 07:47:29,261 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0001 secs
2025-03-09 07:47:29,261 [INFO]: 	Checking that your have enough memory available to create the index 03/09/2025, 07:47:29
2025-03-09 07:47:29,261 [INFO]: 531.8MB of memory will be needed to build the index (more might be used if you have more)
2025-03-09 07:47:29,261 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0001 secs
2025-03-09 07:47:29,261 [INFO]: 	Selecting most promising index types given data characteristics 03/09/2025, 07:47:29
2025-03-09 07:47:29,261 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-09 07:47:29,261 [INFO]: 	Creating the index 03/09/2025, 07:47:29
2025-03-09 07:47:29,261 [INFO]: 		-> Instanciate the index HNSW15 03/09/2025, 07:47:29
2025-03-09 07:47:29,262 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0009 secs
2025-03-09 07:47:29,262 [INFO]: 		-> Adding the vectors to the index 03/09/2025, 07:47:29
2025-03-09 07:47:29,262 [INFO]: The memory available for adding the vectors is 49.5GB(total available - used by the index)
2025-03-09 07:47:29,262 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/11 [00:00<?, ?it/s]  9%|▉         | 1/11 [00:00<00:01,  9.73it/s] 55%|█████▍    | 6/11 [00:00<00:00, 32.54it/s]100%|██████████| 11/11 [00:02<00:00,  4.59it/s]100%|██████████| 11/11 [00:02<00:00,  5.38it/s]
2025-03-09 07:47:31,307 [INFO]: 	Computing best hyperparameters for index knn.index 03/09/2025, 07:47:31
2025-03-09 07:48:03,340 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 32.0328 secs
2025-03-09 07:48:03,340 [INFO]: The best hyperparameters are: efSearch=256
2025-03-09 07:48:03,340 [INFO]: 	Compute fast metrics 03/09/2025, 07:48:03
  0%|          | 0/4 [00:00<?, ?it/s] 50%|█████     | 2/4 [00:00<00:00, 17.45it/s] 75%|███████▌  | 3/4 [00:00<00:00, 18.95it/s]
2025-03-09 07:48:15,320 [INFO]: 	>>> Finished "Compute fast metrics" in 11.9801 secs
2025-03-09 07:48:15,322 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 46.0601 secs
2025-03-09 07:48:15,322 [INFO]: {
2025-03-09 07:48:15,322 [INFO]: 	index_key: HNSW15
2025-03-09 07:48:15,322 [INFO]: 	index_param: efSearch=256
2025-03-09 07:48:15,322 [INFO]: 	index_path: knn.index
2025-03-09 07:48:15,322 [INFO]: 	size in bytes: 507008950
2025-03-09 07:48:15,322 [INFO]: 	avg_search_speed_ms: 12.019074654884976
2025-03-09 07:48:15,322 [INFO]: 	99p_search_speed_ms: 27.279946005437495
2025-03-09 07:48:15,322 [INFO]: 	reconstruction error %: 0.0
2025-03-09 07:48:15,322 [INFO]: 	nb vectors: 2577
2025-03-09 07:48:15,322 [INFO]: 	vectors dimension: 49152
2025-03-09 07:48:15,322 [INFO]: 	compression ratio: 0.9993094125853202
2025-03-09 07:48:15,322 [INFO]: }
2025-03-09 07:48:15,322 [INFO]: 	>>> Finished "Creating the index" in 46.0614 secs
2025-03-09 07:48:15,322 [INFO]: >>> Finished "Launching the whole pipeline" in 46.0867 secs
2025-03-09 07:48:16: [retrieval_preprocessing] calculating distances ...
2025-03-09 07:48:16: [retrieval_preprocessing] finished and saved retrieval indices for episode 83484 [episode count 5/20]
[retrieval_preprocessing] for episode 94750 [episode count 6/20], we have num_retrieval=np.int64(2562) num_query=np.int64(136)
2025-03-09 07:48:16,656 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-09 07:48:17,005 [INFO]: Launching the whole pipeline 03/09/2025, 07:48:17
2025-03-09 07:48:17,005 [INFO]: Reading total number of vectors and dimension 03/09/2025, 07:48:17
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1774.24it/s]
2025-03-09 07:48:17,039 [INFO]: There are 2562 embeddings of dim 49152
2025-03-09 07:48:17,040 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0342 secs
2025-03-09 07:48:17,040 [INFO]: 	Compute estimated construction time of the index 03/09/2025, 07:48:17
2025-03-09 07:48:17,040 [INFO]: 		-> Train: 16.7 minutes
2025-03-09 07:48:17,040 [INFO]: 		-> Add: 1.4 seconds
2025-03-09 07:48:17,040 [INFO]: 		Total: 16.7 minutes
2025-03-09 07:48:17,040 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0004 secs
2025-03-09 07:48:17,040 [INFO]: 	Checking that your have enough memory available to create the index 03/09/2025, 07:48:17
2025-03-09 07:48:17,041 [INFO]: 528.7MB of memory will be needed to build the index (more might be used if you have more)
2025-03-09 07:48:17,041 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0010 secs
2025-03-09 07:48:17,042 [INFO]: 	Selecting most promising index types given data characteristics 03/09/2025, 07:48:17
2025-03-09 07:48:17,042 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-09 07:48:17,042 [INFO]: 	Creating the index 03/09/2025, 07:48:17
2025-03-09 07:48:17,042 [INFO]: 		-> Instanciate the index HNSW15 03/09/2025, 07:48:17
2025-03-09 07:48:17,045 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0028 secs
2025-03-09 07:48:17,045 [INFO]: 		-> Adding the vectors to the index 03/09/2025, 07:48:17
2025-03-09 07:48:17,045 [INFO]: The memory available for adding the vectors is 49.5GB(total available - used by the index)
2025-03-09 07:48:17,046 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/11 [00:00<?, ?it/s] 27%|██▋       | 3/11 [00:00<00:00, 25.95it/s] 82%|████████▏ | 9/11 [00:00<00:00, 40.42it/s]100%|██████████| 11/11 [00:02<00:00,  4.36it/s]
2025-03-09 07:48:19,575 [INFO]: 	Computing best hyperparameters for index knn.index 03/09/2025, 07:48:19
2025-03-09 07:48:55,649 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 36.0738 secs
2025-03-09 07:48:55,649 [INFO]: The best hyperparameters are: efSearch=218
2025-03-09 07:48:55,649 [INFO]: 	Compute fast metrics 03/09/2025, 07:48:55
  0%|          | 0/4 [00:00<?, ?it/s] 75%|███████▌  | 3/4 [00:00<00:00, 21.40it/s] 75%|███████▌  | 3/4 [00:00<00:00, 17.95it/s]
2025-03-09 07:49:09,606 [INFO]: 	>>> Finished "Compute fast metrics" in 13.9564 secs
2025-03-09 07:49:09,608 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 52.5621 secs
2025-03-09 07:49:09,608 [INFO]: {
2025-03-09 07:49:09,608 [INFO]: 	index_key: HNSW15
2025-03-09 07:49:09,608 [INFO]: 	index_param: efSearch=218
2025-03-09 07:49:09,608 [INFO]: 	index_path: knn.index
2025-03-09 07:49:09,608 [INFO]: 	size in bytes: 504057670
2025-03-09 07:49:09,608 [INFO]: 	avg_search_speed_ms: 9.471841094365155
2025-03-09 07:49:09,608 [INFO]: 	99p_search_speed_ms: 22.32556596398354
2025-03-09 07:49:09,608 [INFO]: 	reconstruction error %: 0.0
2025-03-09 07:49:09,608 [INFO]: 	nb vectors: 2562
2025-03-09 07:49:09,608 [INFO]: 	vectors dimension: 49152
2025-03-09 07:49:09,608 [INFO]: 	compression ratio: 0.9993096543893479
2025-03-09 07:49:09,608 [INFO]: }
2025-03-09 07:49:09,608 [INFO]: 	>>> Finished "Creating the index" in 52.5659 secs
2025-03-09 07:49:09,608 [INFO]: >>> Finished "Launching the whole pipeline" in 52.6025 secs
2025-03-09 07:49:10: [retrieval_preprocessing] calculating distances ...
2025-03-09 07:49:10: [retrieval_preprocessing] finished and saved retrieval indices for episode 94750 [episode count 6/20]
[retrieval_preprocessing] for episode 65567 [episode count 7/20], we have num_retrieval=np.int64(2578) num_query=np.int64(120)
2025-03-09 07:49:10,920 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-09 07:49:11,319 [INFO]: Launching the whole pipeline 03/09/2025, 07:49:11
2025-03-09 07:49:11,319 [INFO]: Reading total number of vectors and dimension 03/09/2025, 07:49:11
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1311.13it/s]
2025-03-09 07:49:11,348 [INFO]: There are 2578 embeddings of dim 49152
2025-03-09 07:49:11,349 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0297 secs
2025-03-09 07:49:11,349 [INFO]: 	Compute estimated construction time of the index 03/09/2025, 07:49:11
2025-03-09 07:49:11,349 [INFO]: 		-> Train: 16.7 minutes
2025-03-09 07:49:11,349 [INFO]: 		-> Add: 1.4 seconds
2025-03-09 07:49:11,349 [INFO]: 		Total: 16.7 minutes
2025-03-09 07:49:11,349 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0001 secs
2025-03-09 07:49:11,349 [INFO]: 	Checking that your have enough memory available to create the index 03/09/2025, 07:49:11
2025-03-09 07:49:11,349 [INFO]: 532.0MB of memory will be needed to build the index (more might be used if you have more)
2025-03-09 07:49:11,349 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0002 secs
2025-03-09 07:49:11,349 [INFO]: 	Selecting most promising index types given data characteristics 03/09/2025, 07:49:11
2025-03-09 07:49:11,349 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-09 07:49:11,349 [INFO]: 	Creating the index 03/09/2025, 07:49:11
2025-03-09 07:49:11,349 [INFO]: 		-> Instanciate the index HNSW15 03/09/2025, 07:49:11
2025-03-09 07:49:11,350 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0010 secs
2025-03-09 07:49:11,350 [INFO]: 		-> Adding the vectors to the index 03/09/2025, 07:49:11
2025-03-09 07:49:11,351 [INFO]: The memory available for adding the vectors is 49.5GB(total available - used by the index)
2025-03-09 07:49:11,351 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/11 [00:00<?, ?it/s]  9%|▉         | 1/11 [00:00<00:01,  9.19it/s] 55%|█████▍    | 6/11 [00:00<00:00, 28.46it/s] 91%|█████████ | 10/11 [00:00<00:00, 29.47it/s]100%|██████████| 11/11 [00:02<00:00,  4.25it/s]
2025-03-09 07:49:13,943 [INFO]: 	Computing best hyperparameters for index knn.index 03/09/2025, 07:49:13
2025-03-09 07:49:50,162 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 36.2187 secs
2025-03-09 07:49:50,162 [INFO]: The best hyperparameters are: efSearch=232
2025-03-09 07:49:50,162 [INFO]: 	Compute fast metrics 03/09/2025, 07:49:50
  0%|          | 0/4 [00:00<?, ?it/s] 50%|█████     | 2/4 [00:00<00:00, 16.38it/s] 75%|███████▌  | 3/4 [00:00<00:00, 14.99it/s]
2025-03-09 07:50:03,814 [INFO]: 	>>> Finished "Compute fast metrics" in 13.6521 secs
2025-03-09 07:50:03,817 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 52.4660 secs
2025-03-09 07:50:03,817 [INFO]: {
2025-03-09 07:50:03,817 [INFO]: 	index_key: HNSW15
2025-03-09 07:50:03,817 [INFO]: 	index_param: efSearch=232
2025-03-09 07:50:03,817 [INFO]: 	index_path: knn.index
2025-03-09 07:50:03,817 [INFO]: 	size in bytes: 507205690
2025-03-09 07:50:03,817 [INFO]: 	avg_search_speed_ms: 10.962552019280562
2025-03-09 07:50:03,817 [INFO]: 	99p_search_speed_ms: 21.671928467694666
2025-03-09 07:50:03,817 [INFO]: 	reconstruction error %: 0.0
2025-03-09 07:50:03,817 [INFO]: 	nb vectors: 2578
2025-03-09 07:50:03,817 [INFO]: 	vectors dimension: 49152
2025-03-09 07:50:03,817 [INFO]: 	compression ratio: 0.9993094202078057
2025-03-09 07:50:03,817 [INFO]: }
2025-03-09 07:50:03,817 [INFO]: 	>>> Finished "Creating the index" in 52.4677 secs
2025-03-09 07:50:03,817 [INFO]: >>> Finished "Launching the whole pipeline" in 52.4981 secs
2025-03-09 07:50:04: [retrieval_preprocessing] calculating distances ...
2025-03-09 07:50:05: [retrieval_preprocessing] finished and saved retrieval indices for episode 65567 [episode count 7/20]
[retrieval_preprocessing] for episode 11299 [episode count 8/20], we have num_retrieval=np.int64(2548) num_query=np.int64(150)
2025-03-09 07:50:05,214 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-09 07:50:05,506 [INFO]: Launching the whole pipeline 03/09/2025, 07:50:05
2025-03-09 07:50:05,506 [INFO]: Reading total number of vectors and dimension 03/09/2025, 07:50:05
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1741.82it/s]
2025-03-09 07:50:05,534 [INFO]: There are 2548 embeddings of dim 49152
2025-03-09 07:50:05,534 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0277 secs
2025-03-09 07:50:05,534 [INFO]: 	Compute estimated construction time of the index 03/09/2025, 07:50:05
2025-03-09 07:50:05,534 [INFO]: 		-> Train: 16.7 minutes
2025-03-09 07:50:05,534 [INFO]: 		-> Add: 1.4 seconds
2025-03-09 07:50:05,534 [INFO]: 		Total: 16.7 minutes
2025-03-09 07:50:05,534 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0001 secs
2025-03-09 07:50:05,534 [INFO]: 	Checking that your have enough memory available to create the index 03/09/2025, 07:50:05
2025-03-09 07:50:05,534 [INFO]: 525.8MB of memory will be needed to build the index (more might be used if you have more)
2025-03-09 07:50:05,534 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0001 secs
2025-03-09 07:50:05,534 [INFO]: 	Selecting most promising index types given data characteristics 03/09/2025, 07:50:05
2025-03-09 07:50:05,534 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-09 07:50:05,534 [INFO]: 	Creating the index 03/09/2025, 07:50:05
2025-03-09 07:50:05,534 [INFO]: 		-> Instanciate the index HNSW15 03/09/2025, 07:50:05
2025-03-09 07:50:05,535 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0008 secs
2025-03-09 07:50:05,535 [INFO]: 		-> Adding the vectors to the index 03/09/2025, 07:50:05
2025-03-09 07:50:05,535 [INFO]: The memory available for adding the vectors is 49.5GB(total available - used by the index)
2025-03-09 07:50:05,535 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/11 [00:00<?, ?it/s]  9%|▉         | 1/11 [00:00<00:01,  9.43it/s] 64%|██████▎   | 7/11 [00:00<00:00, 35.40it/s]100%|██████████| 11/11 [00:02<00:00,  4.54it/s]100%|██████████| 11/11 [00:02<00:00,  5.49it/s]
2025-03-09 07:50:07,542 [INFO]: 	Computing best hyperparameters for index knn.index 03/09/2025, 07:50:07
2025-03-09 07:50:43,185 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 35.6424 secs
2025-03-09 07:50:43,185 [INFO]: The best hyperparameters are: efSearch=239
2025-03-09 07:50:43,185 [INFO]: 	Compute fast metrics 03/09/2025, 07:50:43
  0%|          | 0/4 [00:00<?, ?it/s] 50%|█████     | 2/4 [00:00<00:00, 19.00it/s] 75%|███████▌  | 3/4 [00:00<00:00, 21.02it/s]
2025-03-09 07:50:56,295 [INFO]: 	>>> Finished "Compute fast metrics" in 13.1095 secs
2025-03-09 07:50:56,296 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 50.7609 secs
2025-03-09 07:50:56,296 [INFO]: {
2025-03-09 07:50:56,296 [INFO]: 	index_key: HNSW15
2025-03-09 07:50:56,296 [INFO]: 	index_param: efSearch=239
2025-03-09 07:50:56,296 [INFO]: 	index_path: knn.index
2025-03-09 07:50:56,296 [INFO]: 	size in bytes: 501303310
2025-03-09 07:50:56,296 [INFO]: 	avg_search_speed_ms: 9.947819549784954
2025-03-09 07:50:56,296 [INFO]: 	99p_search_speed_ms: 23.105839202180515
2025-03-09 07:50:56,296 [INFO]: 	reconstruction error %: 0.0
2025-03-09 07:50:56,296 [INFO]: 	nb vectors: 2548
2025-03-09 07:50:56,296 [INFO]: 	vectors dimension: 49152
2025-03-09 07:50:56,296 [INFO]: 	compression ratio: 0.9993095477466526
2025-03-09 07:50:56,296 [INFO]: }
2025-03-09 07:50:56,296 [INFO]: 	>>> Finished "Creating the index" in 50.7622 secs
2025-03-09 07:50:56,297 [INFO]: >>> Finished "Launching the whole pipeline" in 50.7905 secs
2025-03-09 07:50:57: [retrieval_preprocessing] calculating distances ...
2025-03-09 07:50:57: [retrieval_preprocessing] finished and saved retrieval indices for episode 11299 [episode count 8/20]
[retrieval_preprocessing] for episode 84532 [episode count 9/20], we have num_retrieval=np.int64(2546) num_query=np.int64(152)
2025-03-09 07:50:57,967 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-09 07:50:58,487 [INFO]: Launching the whole pipeline 03/09/2025, 07:50:58
2025-03-09 07:50:58,487 [INFO]: Reading total number of vectors and dimension 03/09/2025, 07:50:58
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1222.47it/s]
2025-03-09 07:50:58,516 [INFO]: There are 2546 embeddings of dim 49152
2025-03-09 07:50:58,517 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0298 secs
2025-03-09 07:50:58,517 [INFO]: 	Compute estimated construction time of the index 03/09/2025, 07:50:58
2025-03-09 07:50:58,517 [INFO]: 		-> Train: 16.7 minutes
2025-03-09 07:50:58,517 [INFO]: 		-> Add: 1.4 seconds
2025-03-09 07:50:58,517 [INFO]: 		Total: 16.7 minutes
2025-03-09 07:50:58,517 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0003 secs
2025-03-09 07:50:58,518 [INFO]: 	Checking that your have enough memory available to create the index 03/09/2025, 07:50:58
2025-03-09 07:50:58,518 [INFO]: 525.4MB of memory will be needed to build the index (more might be used if you have more)
2025-03-09 07:50:58,518 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0005 secs
2025-03-09 07:50:58,518 [INFO]: 	Selecting most promising index types given data characteristics 03/09/2025, 07:50:58
2025-03-09 07:50:58,518 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-09 07:50:58,518 [INFO]: 	Creating the index 03/09/2025, 07:50:58
2025-03-09 07:50:58,519 [INFO]: 		-> Instanciate the index HNSW15 03/09/2025, 07:50:58
2025-03-09 07:50:58,521 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0027 secs
2025-03-09 07:50:58,522 [INFO]: 		-> Adding the vectors to the index 03/09/2025, 07:50:58
2025-03-09 07:50:58,522 [INFO]: The memory available for adding the vectors is 49.5GB(total available - used by the index)
2025-03-09 07:50:58,522 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/11 [00:00<?, ?it/s] 27%|██▋       | 3/11 [00:00<00:00, 25.03it/s] 73%|███████▎  | 8/11 [00:00<00:00, 38.32it/s]100%|██████████| 11/11 [00:01<00:00,  5.56it/s]
2025-03-09 07:51:00,507 [INFO]: 	Computing best hyperparameters for index knn.index 03/09/2025, 07:51:00
2025-03-09 07:51:32,095 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 31.5883 secs
2025-03-09 07:51:32,096 [INFO]: The best hyperparameters are: efSearch=270
2025-03-09 07:51:32,096 [INFO]: 	Compute fast metrics 03/09/2025, 07:51:32
  0%|          | 0/4 [00:00<?, ?it/s] 50%|█████     | 2/4 [00:00<00:00, 16.81it/s] 75%|███████▌  | 3/4 [00:00<00:00, 17.84it/s]
2025-03-09 07:51:46,930 [INFO]: 	>>> Finished "Compute fast metrics" in 14.8339 secs
2025-03-09 07:51:46,932 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 48.4106 secs
2025-03-09 07:51:46,933 [INFO]: {
2025-03-09 07:51:46,933 [INFO]: 	index_key: HNSW15
2025-03-09 07:51:46,933 [INFO]: 	index_param: efSearch=270
2025-03-09 07:51:46,933 [INFO]: 	index_path: knn.index
2025-03-09 07:51:46,933 [INFO]: 	size in bytes: 500909830
2025-03-09 07:51:46,933 [INFO]: 	avg_search_speed_ms: 11.701315567605416
2025-03-09 07:51:46,933 [INFO]: 	99p_search_speed_ms: 20.65410683862865
2025-03-09 07:51:46,933 [INFO]: 	reconstruction error %: 0.0
2025-03-09 07:51:46,933 [INFO]: 	nb vectors: 2546
2025-03-09 07:51:46,933 [INFO]: 	vectors dimension: 49152
2025-03-09 07:51:46,933 [INFO]: 	compression ratio: 0.9993095324162434
2025-03-09 07:51:46,933 [INFO]: }
2025-03-09 07:51:46,933 [INFO]: 	>>> Finished "Creating the index" in 48.4143 secs
2025-03-09 07:51:46,933 [INFO]: >>> Finished "Launching the whole pipeline" in 48.4459 secs
2025-03-09 07:51:48: [retrieval_preprocessing] calculating distances ...
2025-03-09 07:51:48: [retrieval_preprocessing] finished and saved retrieval indices for episode 84532 [episode count 9/20]
[retrieval_preprocessing] for episode 13879 [episode count 10/20], we have num_retrieval=np.int64(2589) num_query=np.int64(109)
2025-03-09 07:51:49,149 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-09 07:51:49,551 [INFO]: Launching the whole pipeline 03/09/2025, 07:51:49
2025-03-09 07:51:49,551 [INFO]: Reading total number of vectors and dimension 03/09/2025, 07:51:49
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1504.41it/s]
2025-03-09 07:51:49,576 [INFO]: There are 2589 embeddings of dim 49152
2025-03-09 07:51:49,576 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0249 secs
2025-03-09 07:51:49,576 [INFO]: 	Compute estimated construction time of the index 03/09/2025, 07:51:49
2025-03-09 07:51:49,576 [INFO]: 		-> Train: 16.7 minutes
2025-03-09 07:51:49,576 [INFO]: 		-> Add: 1.4 seconds
2025-03-09 07:51:49,576 [INFO]: 		Total: 16.7 minutes
2025-03-09 07:51:49,576 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0001 secs
2025-03-09 07:51:49,576 [INFO]: 	Checking that your have enough memory available to create the index 03/09/2025, 07:51:49
2025-03-09 07:51:49,576 [INFO]: 534.3MB of memory will be needed to build the index (more might be used if you have more)
2025-03-09 07:51:49,576 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0001 secs
2025-03-09 07:51:49,576 [INFO]: 	Selecting most promising index types given data characteristics 03/09/2025, 07:51:49
2025-03-09 07:51:49,576 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-09 07:51:49,576 [INFO]: 	Creating the index 03/09/2025, 07:51:49
2025-03-09 07:51:49,576 [INFO]: 		-> Instanciate the index HNSW15 03/09/2025, 07:51:49
2025-03-09 07:51:49,577 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0010 secs
2025-03-09 07:51:49,577 [INFO]: 		-> Adding the vectors to the index 03/09/2025, 07:51:49
2025-03-09 07:51:49,577 [INFO]: The memory available for adding the vectors is 49.5GB(total available - used by the index)
2025-03-09 07:51:49,577 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/11 [00:00<?, ?it/s]  9%|▉         | 1/11 [00:00<00:01,  9.70it/s] 64%|██████▎   | 7/11 [00:00<00:00, 37.60it/s]100%|██████████| 11/11 [00:02<00:00,  3.80it/s]100%|██████████| 11/11 [00:02<00:00,  4.63it/s]
2025-03-09 07:51:51,956 [INFO]: 	Computing best hyperparameters for index knn.index 03/09/2025, 07:51:51
2025-03-09 07:52:23,830 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 31.8743 secs
2025-03-09 07:52:23,830 [INFO]: The best hyperparameters are: efSearch=227
2025-03-09 07:52:23,830 [INFO]: 	Compute fast metrics 03/09/2025, 07:52:23
  0%|          | 0/4 [00:00<?, ?it/s] 50%|█████     | 2/4 [00:00<00:00, 19.42it/s] 75%|███████▌  | 3/4 [00:00<00:00, 21.51it/s]
2025-03-09 07:52:39,336 [INFO]: 	>>> Finished "Compute fast metrics" in 15.5057 secs
2025-03-09 07:52:39,695 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 50.1175 secs
2025-03-09 07:52:39,695 [INFO]: {
2025-03-09 07:52:39,695 [INFO]: 	index_key: HNSW15
2025-03-09 07:52:39,695 [INFO]: 	index_param: efSearch=227
2025-03-09 07:52:39,695 [INFO]: 	index_path: knn.index
2025-03-09 07:52:39,695 [INFO]: 	size in bytes: 509369890
2025-03-09 07:52:39,695 [INFO]: 	avg_search_speed_ms: 9.515146508205596
2025-03-09 07:52:39,696 [INFO]: 	99p_search_speed_ms: 22.576801038812846
2025-03-09 07:52:39,696 [INFO]: 	reconstruction error %: 0.0
2025-03-09 07:52:39,696 [INFO]: 	nb vectors: 2589
2025-03-09 07:52:39,696 [INFO]: 	vectors dimension: 49152
2025-03-09 07:52:39,696 [INFO]: 	compression ratio: 0.9993093859552633
2025-03-09 07:52:39,696 [INFO]: }
2025-03-09 07:52:39,696 [INFO]: 	>>> Finished "Creating the index" in 50.1196 secs
2025-03-09 07:52:39,696 [INFO]: >>> Finished "Launching the whole pipeline" in 50.1451 secs
2025-03-09 07:52:40: [retrieval_preprocessing] calculating distances ...
2025-03-09 07:52:40: [retrieval_preprocessing] finished and saved retrieval indices for episode 13879 [episode count 10/20]
[retrieval_preprocessing] for episode 93755 [episode count 11/20], we have num_retrieval=np.int64(2583) num_query=np.int64(115)
2025-03-09 07:52:40,954 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-09 07:52:41,322 [INFO]: Launching the whole pipeline 03/09/2025, 07:52:41
2025-03-09 07:52:41,322 [INFO]: Reading total number of vectors and dimension 03/09/2025, 07:52:41
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1375.18it/s]
2025-03-09 07:52:41,352 [INFO]: There are 2583 embeddings of dim 49152
2025-03-09 07:52:41,352 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0298 secs
2025-03-09 07:52:41,352 [INFO]: 	Compute estimated construction time of the index 03/09/2025, 07:52:41
2025-03-09 07:52:41,352 [INFO]: 		-> Train: 16.7 minutes
2025-03-09 07:52:41,352 [INFO]: 		-> Add: 1.4 seconds
2025-03-09 07:52:41,352 [INFO]: 		Total: 16.7 minutes
2025-03-09 07:52:41,352 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0001 secs
2025-03-09 07:52:41,352 [INFO]: 	Checking that your have enough memory available to create the index 03/09/2025, 07:52:41
2025-03-09 07:52:41,352 [INFO]: 533.1MB of memory will be needed to build the index (more might be used if you have more)
2025-03-09 07:52:41,352 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0001 secs
2025-03-09 07:52:41,352 [INFO]: 	Selecting most promising index types given data characteristics 03/09/2025, 07:52:41
2025-03-09 07:52:41,352 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-09 07:52:41,352 [INFO]: 	Creating the index 03/09/2025, 07:52:41
2025-03-09 07:52:41,352 [INFO]: 		-> Instanciate the index HNSW15 03/09/2025, 07:52:41
2025-03-09 07:52:41,353 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0009 secs
2025-03-09 07:52:41,353 [INFO]: 		-> Adding the vectors to the index 03/09/2025, 07:52:41
2025-03-09 07:52:41,354 [INFO]: The memory available for adding the vectors is 49.5GB(total available - used by the index)
2025-03-09 07:52:41,354 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/11 [00:00<?, ?it/s]  9%|▉         | 1/11 [00:00<00:01,  8.32it/s] 45%|████▌     | 5/11 [00:00<00:00, 23.46it/s] 91%|█████████ | 10/11 [00:00<00:00, 33.98it/s]100%|██████████| 11/11 [00:02<00:00,  5.25it/s]
2025-03-09 07:52:43,453 [INFO]: 	Computing best hyperparameters for index knn.index 03/09/2025, 07:52:43
2025-03-09 07:53:20,717 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 37.2633 secs
2025-03-09 07:53:20,717 [INFO]: The best hyperparameters are: efSearch=225
2025-03-09 07:53:20,717 [INFO]: 	Compute fast metrics 03/09/2025, 07:53:20
  0%|          | 0/4 [00:00<?, ?it/s] 50%|█████     | 2/4 [00:00<00:00, 17.95it/s] 75%|███████▌  | 3/4 [00:00<00:00, 18.70it/s]
2025-03-09 07:53:32,892 [INFO]: 	>>> Finished "Compute fast metrics" in 12.1742 secs
2025-03-09 07:53:32,995 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 51.6413 secs
2025-03-09 07:53:32,995 [INFO]: {
2025-03-09 07:53:32,995 [INFO]: 	index_key: HNSW15
2025-03-09 07:53:32,995 [INFO]: 	index_param: efSearch=225
2025-03-09 07:53:32,995 [INFO]: 	index_path: knn.index
2025-03-09 07:53:32,995 [INFO]: 	size in bytes: 508189390
2025-03-09 07:53:32,996 [INFO]: 	avg_search_speed_ms: 10.314049141135873
2025-03-09 07:53:32,996 [INFO]: 	99p_search_speed_ms: 20.208860358688945
2025-03-09 07:53:32,996 [INFO]: 	reconstruction error %: 0.0
2025-03-09 07:53:32,996 [INFO]: 	nb vectors: 2583
2025-03-09 07:53:32,996 [INFO]: 	vectors dimension: 49152
2025-03-09 07:53:32,996 [INFO]: 	compression ratio: 0.9993094582317037
2025-03-09 07:53:32,996 [INFO]: }
2025-03-09 07:53:32,996 [INFO]: 	>>> Finished "Creating the index" in 51.6434 secs
2025-03-09 07:53:32,996 [INFO]: >>> Finished "Launching the whole pipeline" in 51.6738 secs
2025-03-09 07:53:33: [retrieval_preprocessing] calculating distances ...
2025-03-09 07:53:33: [retrieval_preprocessing] finished and saved retrieval indices for episode 93755 [episode count 11/20]
[retrieval_preprocessing] for episode 43580 [episode count 12/20], we have num_retrieval=np.int64(2561) num_query=np.int64(137)
2025-03-09 07:53:34,084 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-09 07:53:34,427 [INFO]: Launching the whole pipeline 03/09/2025, 07:53:34
2025-03-09 07:53:34,428 [INFO]: Reading total number of vectors and dimension 03/09/2025, 07:53:34
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1778.00it/s]
2025-03-09 07:53:34,457 [INFO]: There are 2561 embeddings of dim 49152
2025-03-09 07:53:34,457 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0292 secs
2025-03-09 07:53:34,457 [INFO]: 	Compute estimated construction time of the index 03/09/2025, 07:53:34
2025-03-09 07:53:34,457 [INFO]: 		-> Train: 16.7 minutes
2025-03-09 07:53:34,457 [INFO]: 		-> Add: 1.4 seconds
2025-03-09 07:53:34,457 [INFO]: 		Total: 16.7 minutes
2025-03-09 07:53:34,457 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0001 secs
2025-03-09 07:53:34,457 [INFO]: 	Checking that your have enough memory available to create the index 03/09/2025, 07:53:34
2025-03-09 07:53:34,457 [INFO]: 528.5MB of memory will be needed to build the index (more might be used if you have more)
2025-03-09 07:53:34,457 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0001 secs
2025-03-09 07:53:34,457 [INFO]: 	Selecting most promising index types given data characteristics 03/09/2025, 07:53:34
2025-03-09 07:53:34,457 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-09 07:53:34,457 [INFO]: 	Creating the index 03/09/2025, 07:53:34
2025-03-09 07:53:34,457 [INFO]: 		-> Instanciate the index HNSW15 03/09/2025, 07:53:34
2025-03-09 07:53:34,458 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0010 secs
2025-03-09 07:53:34,458 [INFO]: 		-> Adding the vectors to the index 03/09/2025, 07:53:34
2025-03-09 07:53:34,458 [INFO]: The memory available for adding the vectors is 49.5GB(total available - used by the index)
2025-03-09 07:53:34,459 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/11 [00:00<?, ?it/s]  9%|▉         | 1/11 [00:00<00:01,  7.77it/s] 55%|█████▍    | 6/11 [00:00<00:00, 27.71it/s]100%|██████████| 11/11 [00:02<00:00,  3.88it/s]100%|██████████| 11/11 [00:02<00:00,  4.54it/s]
2025-03-09 07:53:36,882 [INFO]: 	Computing best hyperparameters for index knn.index 03/09/2025, 07:53:36
2025-03-09 07:54:08,201 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 31.3182 secs
2025-03-09 07:54:08,201 [INFO]: The best hyperparameters are: efSearch=245
2025-03-09 07:54:08,201 [INFO]: 	Compute fast metrics 03/09/2025, 07:54:08
  0%|          | 0/4 [00:00<?, ?it/s] 50%|█████     | 2/4 [00:00<00:00, 19.57it/s] 75%|███████▌  | 3/4 [00:00<00:00, 20.75it/s]
2025-03-09 07:54:23,019 [INFO]: 	>>> Finished "Compute fast metrics" in 14.8182 secs
2025-03-09 07:54:23,021 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 48.5627 secs
2025-03-09 07:54:23,021 [INFO]: {
2025-03-09 07:54:23,021 [INFO]: 	index_key: HNSW15
2025-03-09 07:54:23,021 [INFO]: 	index_param: efSearch=245
2025-03-09 07:54:23,021 [INFO]: 	index_path: knn.index
2025-03-09 07:54:23,021 [INFO]: 	size in bytes: 503860930
2025-03-09 07:54:23,021 [INFO]: 	avg_search_speed_ms: 11.762306269818586
2025-03-09 07:54:23,021 [INFO]: 	99p_search_speed_ms: 25.751855573616922
2025-03-09 07:54:23,021 [INFO]: 	reconstruction error %: 0.0
2025-03-09 07:54:23,021 [INFO]: 	nb vectors: 2561
2025-03-09 07:54:23,021 [INFO]: 	vectors dimension: 49152
2025-03-09 07:54:23,021 [INFO]: 	compression ratio: 0.9993096468106785
2025-03-09 07:54:23,021 [INFO]: }
2025-03-09 07:54:23,022 [INFO]: 	>>> Finished "Creating the index" in 48.5641 secs
2025-03-09 07:54:23,022 [INFO]: >>> Finished "Launching the whole pipeline" in 48.5939 secs
2025-03-09 07:54:24: [retrieval_preprocessing] calculating distances ...
2025-03-09 07:54:24: [retrieval_preprocessing] finished and saved retrieval indices for episode 43580 [episode count 12/20]
[retrieval_preprocessing] for episode 91708 [episode count 13/20], we have num_retrieval=np.int64(2555) num_query=np.int64(143)
2025-03-09 07:54:24,658 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-09 07:54:25,032 [INFO]: Launching the whole pipeline 03/09/2025, 07:54:25
2025-03-09 07:54:25,032 [INFO]: Reading total number of vectors and dimension 03/09/2025, 07:54:25
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1129.32it/s]
2025-03-09 07:54:25,065 [INFO]: There are 2555 embeddings of dim 49152
2025-03-09 07:54:25,066 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0332 secs
2025-03-09 07:54:25,066 [INFO]: 	Compute estimated construction time of the index 03/09/2025, 07:54:25
2025-03-09 07:54:25,066 [INFO]: 		-> Train: 16.7 minutes
2025-03-09 07:54:25,066 [INFO]: 		-> Add: 1.4 seconds
2025-03-09 07:54:25,066 [INFO]: 		Total: 16.7 minutes
2025-03-09 07:54:25,066 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0001 secs
2025-03-09 07:54:25,066 [INFO]: 	Checking that your have enough memory available to create the index 03/09/2025, 07:54:25
2025-03-09 07:54:25,066 [INFO]: 527.3MB of memory will be needed to build the index (more might be used if you have more)
2025-03-09 07:54:25,066 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0002 secs
2025-03-09 07:54:25,066 [INFO]: 	Selecting most promising index types given data characteristics 03/09/2025, 07:54:25
2025-03-09 07:54:25,066 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-09 07:54:25,066 [INFO]: 	Creating the index 03/09/2025, 07:54:25
2025-03-09 07:54:25,066 [INFO]: 		-> Instanciate the index HNSW15 03/09/2025, 07:54:25
2025-03-09 07:54:25,067 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0010 secs
2025-03-09 07:54:25,067 [INFO]: 		-> Adding the vectors to the index 03/09/2025, 07:54:25
2025-03-09 07:54:25,067 [INFO]: The memory available for adding the vectors is 49.5GB(total available - used by the index)
2025-03-09 07:54:25,067 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/11 [00:00<?, ?it/s]  9%|▉         | 1/11 [00:00<00:01,  6.22it/s] 45%|████▌     | 5/11 [00:00<00:00, 19.50it/s] 82%|████████▏ | 9/11 [00:00<00:00, 25.85it/s]100%|██████████| 11/11 [00:02<00:00,  4.82it/s]
2025-03-09 07:54:27,355 [INFO]: 	Computing best hyperparameters for index knn.index 03/09/2025, 07:54:27
2025-03-09 07:55:03,970 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 36.6146 secs
2025-03-09 07:55:03,970 [INFO]: The best hyperparameters are: efSearch=226
2025-03-09 07:55:03,970 [INFO]: 	Compute fast metrics 03/09/2025, 07:55:03
  0%|          | 0/4 [00:00<?, ?it/s] 50%|█████     | 2/4 [00:00<00:00, 17.29it/s] 75%|███████▌  | 3/4 [00:00<00:00, 18.82it/s]
2025-03-09 07:55:18,952 [INFO]: 	>>> Finished "Compute fast metrics" in 14.9817 secs
2025-03-09 07:55:18,953 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 53.8858 secs
2025-03-09 07:55:18,953 [INFO]: {
2025-03-09 07:55:18,953 [INFO]: 	index_key: HNSW15
2025-03-09 07:55:18,953 [INFO]: 	index_param: efSearch=226
2025-03-09 07:55:18,953 [INFO]: 	index_path: knn.index
2025-03-09 07:55:18,953 [INFO]: 	size in bytes: 502680490
2025-03-09 07:55:18,953 [INFO]: 	avg_search_speed_ms: 9.7581207779486
2025-03-09 07:55:18,953 [INFO]: 	99p_search_speed_ms: 22.085017412900925
2025-03-09 07:55:18,953 [INFO]: 	reconstruction error %: 0.0
2025-03-09 07:55:18,953 [INFO]: 	nb vectors: 2555
2025-03-09 07:55:18,953 [INFO]: 	vectors dimension: 49152
2025-03-09 07:55:18,953 [INFO]: 	compression ratio: 0.9993096012140833
2025-03-09 07:55:18,953 [INFO]: }
2025-03-09 07:55:18,953 [INFO]: 	>>> Finished "Creating the index" in 53.8873 secs
2025-03-09 07:55:18,954 [INFO]: >>> Finished "Launching the whole pipeline" in 53.9212 secs
2025-03-09 07:55:19: [retrieval_preprocessing] calculating distances ...
2025-03-09 07:55:20: [retrieval_preprocessing] finished and saved retrieval indices for episode 91708 [episode count 13/20]
[retrieval_preprocessing] for episode 17470 [episode count 14/20], we have num_retrieval=np.int64(2584) num_query=np.int64(114)
2025-03-09 07:55:20,455 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-09 07:55:20,930 [INFO]: Launching the whole pipeline 03/09/2025, 07:55:20
2025-03-09 07:55:20,930 [INFO]: Reading total number of vectors and dimension 03/09/2025, 07:55:20
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1536.38it/s]
2025-03-09 07:55:20,960 [INFO]: There are 2584 embeddings of dim 49152
2025-03-09 07:55:20,960 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0297 secs
2025-03-09 07:55:20,960 [INFO]: 	Compute estimated construction time of the index 03/09/2025, 07:55:20
2025-03-09 07:55:20,960 [INFO]: 		-> Train: 16.7 minutes
2025-03-09 07:55:20,960 [INFO]: 		-> Add: 1.4 seconds
2025-03-09 07:55:20,960 [INFO]: 		Total: 16.7 minutes
2025-03-09 07:55:20,960 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0001 secs
2025-03-09 07:55:20,960 [INFO]: 	Checking that your have enough memory available to create the index 03/09/2025, 07:55:20
2025-03-09 07:55:20,961 [INFO]: 533.3MB of memory will be needed to build the index (more might be used if you have more)
2025-03-09 07:55:20,961 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0002 secs
2025-03-09 07:55:20,961 [INFO]: 	Selecting most promising index types given data characteristics 03/09/2025, 07:55:20
2025-03-09 07:55:20,961 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-09 07:55:20,961 [INFO]: 	Creating the index 03/09/2025, 07:55:20
2025-03-09 07:55:20,961 [INFO]: 		-> Instanciate the index HNSW15 03/09/2025, 07:55:20
2025-03-09 07:55:20,962 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0011 secs
2025-03-09 07:55:20,962 [INFO]: 		-> Adding the vectors to the index 03/09/2025, 07:55:20
2025-03-09 07:55:20,962 [INFO]: The memory available for adding the vectors is 49.5GB(total available - used by the index)
2025-03-09 07:55:20,962 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/11 [00:00<?, ?it/s] 18%|█▊        | 2/11 [00:00<00:00, 17.62it/s] 64%|██████▎   | 7/11 [00:00<00:00, 33.48it/s]100%|██████████| 11/11 [00:02<00:00,  4.05it/s]100%|██████████| 11/11 [00:02<00:00,  5.02it/s]
2025-03-09 07:55:23,157 [INFO]: 	Computing best hyperparameters for index knn.index 03/09/2025, 07:55:23
2025-03-09 07:55:59,581 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 36.4233 secs
2025-03-09 07:55:59,581 [INFO]: The best hyperparameters are: efSearch=245
2025-03-09 07:55:59,581 [INFO]: 	Compute fast metrics 03/09/2025, 07:55:59
  0%|          | 0/4 [00:00<?, ?it/s] 50%|█████     | 2/4 [00:00<00:00, 18.39it/s] 75%|███████▌  | 3/4 [00:00<00:00, 19.18it/s]
2025-03-09 07:56:12,896 [INFO]: 	>>> Finished "Compute fast metrics" in 13.3142 secs
2025-03-09 07:56:12,898 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 51.9356 secs
2025-03-09 07:56:12,898 [INFO]: {
2025-03-09 07:56:12,898 [INFO]: 	index_key: HNSW15
2025-03-09 07:56:12,898 [INFO]: 	index_param: efSearch=245
2025-03-09 07:56:12,898 [INFO]: 	index_path: knn.index
2025-03-09 07:56:12,898 [INFO]: 	size in bytes: 508386130
2025-03-09 07:56:12,898 [INFO]: 	avg_search_speed_ms: 9.842774022955403
2025-03-09 07:56:12,898 [INFO]: 	99p_search_speed_ms: 19.368589203804735
2025-03-09 07:56:12,898 [INFO]: 	reconstruction error %: 0.0
2025-03-09 07:56:12,898 [INFO]: 	nb vectors: 2584
2025-03-09 07:56:12,898 [INFO]: 	vectors dimension: 49152
2025-03-09 07:56:12,898 [INFO]: 	compression ratio: 0.9993094658188255
2025-03-09 07:56:12,898 [INFO]: }
2025-03-09 07:56:12,898 [INFO]: 	>>> Finished "Creating the index" in 51.9373 secs
2025-03-09 07:56:12,898 [INFO]: >>> Finished "Launching the whole pipeline" in 51.9676 secs
2025-03-09 07:56:13: [retrieval_preprocessing] calculating distances ...
2025-03-09 07:56:14: [retrieval_preprocessing] finished and saved retrieval indices for episode 17470 [episode count 14/20]
[retrieval_preprocessing] for episode 88130 [episode count 15/20], we have num_retrieval=np.int64(2529) num_query=np.int64(169)
2025-03-09 07:56:14,308 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-09 07:56:14,637 [INFO]: Launching the whole pipeline 03/09/2025, 07:56:14
2025-03-09 07:56:14,637 [INFO]: Reading total number of vectors and dimension 03/09/2025, 07:56:14
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1038.97it/s]
2025-03-09 07:56:14,668 [INFO]: There are 2529 embeddings of dim 49152
2025-03-09 07:56:14,669 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0312 secs
2025-03-09 07:56:14,669 [INFO]: 	Compute estimated construction time of the index 03/09/2025, 07:56:14
2025-03-09 07:56:14,669 [INFO]: 		-> Train: 16.7 minutes
2025-03-09 07:56:14,669 [INFO]: 		-> Add: 1.4 seconds
2025-03-09 07:56:14,669 [INFO]: 		Total: 16.7 minutes
2025-03-09 07:56:14,669 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0001 secs
2025-03-09 07:56:14,669 [INFO]: 	Checking that your have enough memory available to create the index 03/09/2025, 07:56:14
2025-03-09 07:56:14,669 [INFO]: 521.9MB of memory will be needed to build the index (more might be used if you have more)
2025-03-09 07:56:14,669 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0001 secs
2025-03-09 07:56:14,669 [INFO]: 	Selecting most promising index types given data characteristics 03/09/2025, 07:56:14
2025-03-09 07:56:14,669 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-09 07:56:14,669 [INFO]: 	Creating the index 03/09/2025, 07:56:14
2025-03-09 07:56:14,669 [INFO]: 		-> Instanciate the index HNSW15 03/09/2025, 07:56:14
2025-03-09 07:56:14,670 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0010 secs
2025-03-09 07:56:14,670 [INFO]: 		-> Adding the vectors to the index 03/09/2025, 07:56:14
2025-03-09 07:56:14,670 [INFO]: The memory available for adding the vectors is 49.5GB(total available - used by the index)
2025-03-09 07:56:14,670 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/10 [00:00<?, ?it/s] 20%|██        | 2/10 [00:00<00:00, 16.66it/s] 80%|████████  | 8/10 [00:00<00:00, 36.29it/s]100%|██████████| 10/10 [00:01<00:00,  5.02it/s]
2025-03-09 07:56:16,667 [INFO]: 	Computing best hyperparameters for index knn.index 03/09/2025, 07:56:16
2025-03-09 07:56:50,453 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 33.7864 secs
2025-03-09 07:56:50,453 [INFO]: The best hyperparameters are: efSearch=261
2025-03-09 07:56:50,454 [INFO]: 	Compute fast metrics 03/09/2025, 07:56:50
  0%|          | 0/4 [00:00<?, ?it/s] 50%|█████     | 2/4 [00:00<00:00, 17.89it/s] 75%|███████▌  | 3/4 [00:00<00:00, 18.36it/s]
2025-03-09 07:57:07,457 [INFO]: 	>>> Finished "Compute fast metrics" in 17.0036 secs
2025-03-09 07:57:07,459 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 52.7885 secs
2025-03-09 07:57:07,459 [INFO]: {
2025-03-09 07:57:07,459 [INFO]: 	index_key: HNSW15
2025-03-09 07:57:07,459 [INFO]: 	index_param: efSearch=261
2025-03-09 07:57:07,459 [INFO]: 	index_path: knn.index
2025-03-09 07:57:07,459 [INFO]: 	size in bytes: 497565130
2025-03-09 07:57:07,459 [INFO]: 	avg_search_speed_ms: 10.741058869335388
2025-03-09 07:57:07,459 [INFO]: 	99p_search_speed_ms: 22.8264488046989
2025-03-09 07:57:07,459 [INFO]: 	reconstruction error %: 0.0
2025-03-09 07:57:07,459 [INFO]: 	nb vectors: 2529
2025-03-09 07:57:07,459 [INFO]: 	vectors dimension: 49152
2025-03-09 07:57:07,459 [INFO]: 	compression ratio: 0.9993096421366988
2025-03-09 07:57:07,459 [INFO]: }
2025-03-09 07:57:07,459 [INFO]: 	>>> Finished "Creating the index" in 52.7899 secs
2025-03-09 07:57:07,459 [INFO]: >>> Finished "Launching the whole pipeline" in 52.8216 secs
2025-03-09 07:57:08: [retrieval_preprocessing] calculating distances ...
2025-03-09 07:57:09: [retrieval_preprocessing] finished and saved retrieval indices for episode 88130 [episode count 15/20]
[retrieval_preprocessing] for episode 91714 [episode count 16/20], we have num_retrieval=np.int64(2597) num_query=np.int64(101)
2025-03-09 07:57:09,501 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-09 07:57:09,838 [INFO]: Launching the whole pipeline 03/09/2025, 07:57:09
2025-03-09 07:57:09,838 [INFO]: Reading total number of vectors and dimension 03/09/2025, 07:57:09
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1416.99it/s]
2025-03-09 07:57:09,865 [INFO]: There are 2597 embeddings of dim 49152
2025-03-09 07:57:09,866 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0274 secs
2025-03-09 07:57:09,866 [INFO]: 	Compute estimated construction time of the index 03/09/2025, 07:57:09
2025-03-09 07:57:09,866 [INFO]: 		-> Train: 16.7 minutes
2025-03-09 07:57:09,866 [INFO]: 		-> Add: 1.4 seconds
2025-03-09 07:57:09,866 [INFO]: 		Total: 16.7 minutes
2025-03-09 07:57:09,866 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0001 secs
2025-03-09 07:57:09,866 [INFO]: 	Checking that your have enough memory available to create the index 03/09/2025, 07:57:09
2025-03-09 07:57:09,866 [INFO]: 536.0MB of memory will be needed to build the index (more might be used if you have more)
2025-03-09 07:57:09,866 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0001 secs
2025-03-09 07:57:09,866 [INFO]: 	Selecting most promising index types given data characteristics 03/09/2025, 07:57:09
2025-03-09 07:57:09,866 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-09 07:57:09,866 [INFO]: 	Creating the index 03/09/2025, 07:57:09
2025-03-09 07:57:09,866 [INFO]: 		-> Instanciate the index HNSW15 03/09/2025, 07:57:09
2025-03-09 07:57:09,867 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0009 secs
2025-03-09 07:57:09,867 [INFO]: 		-> Adding the vectors to the index 03/09/2025, 07:57:09
2025-03-09 07:57:09,867 [INFO]: The memory available for adding the vectors is 49.5GB(total available - used by the index)
2025-03-09 07:57:09,868 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/11 [00:00<?, ?it/s]  9%|▉         | 1/11 [00:00<00:01,  8.92it/s] 55%|█████▍    | 6/11 [00:00<00:00, 31.08it/s] 91%|█████████ | 10/11 [00:00<00:00, 32.80it/s]100%|██████████| 11/11 [00:02<00:00,  5.04it/s]
2025-03-09 07:57:12,053 [INFO]: 	Computing best hyperparameters for index knn.index 03/09/2025, 07:57:12
2025-03-09 07:57:48,156 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 36.1026 secs
2025-03-09 07:57:48,156 [INFO]: The best hyperparameters are: efSearch=243
2025-03-09 07:57:48,156 [INFO]: 	Compute fast metrics 03/09/2025, 07:57:48
  0%|          | 0/4 [00:00<?, ?it/s] 75%|███████▌  | 3/4 [00:00<00:00, 26.03it/s] 75%|███████▌  | 3/4 [00:00<00:00, 22.10it/s]
2025-03-09 07:58:02,823 [INFO]: 	>>> Finished "Compute fast metrics" in 14.6673 secs
2025-03-09 07:58:02,825 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 52.9573 secs
2025-03-09 07:58:02,825 [INFO]: {
2025-03-09 07:58:02,825 [INFO]: 	index_key: HNSW15
2025-03-09 07:58:02,825 [INFO]: 	index_param: efSearch=243
2025-03-09 07:58:02,825 [INFO]: 	index_path: knn.index
2025-03-09 07:58:02,825 [INFO]: 	size in bytes: 510943810
2025-03-09 07:58:02,825 [INFO]: 	avg_search_speed_ms: 10.470039084192893
2025-03-09 07:58:02,825 [INFO]: 	99p_search_speed_ms: 23.19298488087953
2025-03-09 07:58:02,825 [INFO]: 	reconstruction error %: 0.0
2025-03-09 07:58:02,825 [INFO]: 	nb vectors: 2597
2025-03-09 07:58:02,825 [INFO]: 	vectors dimension: 49152
2025-03-09 07:58:02,825 [INFO]: 	compression ratio: 0.9993094465710427
2025-03-09 07:58:02,825 [INFO]: }
2025-03-09 07:58:02,825 [INFO]: 	>>> Finished "Creating the index" in 52.9592 secs
2025-03-09 07:58:02,826 [INFO]: >>> Finished "Launching the whole pipeline" in 52.9872 secs
2025-03-09 07:58:03: [retrieval_preprocessing] calculating distances ...
2025-03-09 07:58:03: [retrieval_preprocessing] finished and saved retrieval indices for episode 91714 [episode count 16/20]
[retrieval_preprocessing] for episode 11334 [episode count 17/20], we have num_retrieval=np.int64(2547) num_query=np.int64(151)
2025-03-09 07:58:04,062 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-09 07:58:04,405 [INFO]: Launching the whole pipeline 03/09/2025, 07:58:04
2025-03-09 07:58:04,406 [INFO]: Reading total number of vectors and dimension 03/09/2025, 07:58:04
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1641.61it/s]
2025-03-09 07:58:04,436 [INFO]: There are 2547 embeddings of dim 49152
2025-03-09 07:58:04,436 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0308 secs
2025-03-09 07:58:04,436 [INFO]: 	Compute estimated construction time of the index 03/09/2025, 07:58:04
2025-03-09 07:58:04,436 [INFO]: 		-> Train: 16.7 minutes
2025-03-09 07:58:04,436 [INFO]: 		-> Add: 1.4 seconds
2025-03-09 07:58:04,436 [INFO]: 		Total: 16.7 minutes
2025-03-09 07:58:04,437 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0001 secs
2025-03-09 07:58:04,437 [INFO]: 	Checking that your have enough memory available to create the index 03/09/2025, 07:58:04
2025-03-09 07:58:04,437 [INFO]: 525.6MB of memory will be needed to build the index (more might be used if you have more)
2025-03-09 07:58:04,437 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0001 secs
2025-03-09 07:58:04,437 [INFO]: 	Selecting most promising index types given data characteristics 03/09/2025, 07:58:04
2025-03-09 07:58:04,437 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-09 07:58:04,437 [INFO]: 	Creating the index 03/09/2025, 07:58:04
2025-03-09 07:58:04,437 [INFO]: 		-> Instanciate the index HNSW15 03/09/2025, 07:58:04
2025-03-09 07:58:04,438 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0009 secs
2025-03-09 07:58:04,438 [INFO]: 		-> Adding the vectors to the index 03/09/2025, 07:58:04
2025-03-09 07:58:04,438 [INFO]: The memory available for adding the vectors is 49.5GB(total available - used by the index)
2025-03-09 07:58:04,438 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/11 [00:00<?, ?it/s] 18%|█▊        | 2/11 [00:00<00:00, 17.46it/s] 73%|███████▎  | 8/11 [00:00<00:00, 38.25it/s]100%|██████████| 11/11 [00:01<00:00,  5.81it/s]
2025-03-09 07:58:06,335 [INFO]: 	Computing best hyperparameters for index knn.index 03/09/2025, 07:58:06
2025-03-09 07:58:37,283 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 30.9479 secs
2025-03-09 07:58:37,283 [INFO]: The best hyperparameters are: efSearch=198
2025-03-09 07:58:37,283 [INFO]: 	Compute fast metrics 03/09/2025, 07:58:37
  0%|          | 0/4 [00:00<?, ?it/s] 25%|██▌       | 1/4 [00:00<00:00,  9.77it/s] 75%|███████▌  | 3/4 [00:00<00:00, 15.62it/s]
2025-03-09 07:58:51,841 [INFO]: 	>>> Finished "Compute fast metrics" in 14.5572 secs
2025-03-09 07:58:51,842 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 47.4046 secs
2025-03-09 07:58:51,843 [INFO]: {
2025-03-09 07:58:51,843 [INFO]: 	index_key: HNSW15
2025-03-09 07:58:51,843 [INFO]: 	index_param: efSearch=198
2025-03-09 07:58:51,843 [INFO]: 	index_path: knn.index
2025-03-09 07:58:51,843 [INFO]: 	size in bytes: 501106570
2025-03-09 07:58:51,843 [INFO]: 	avg_search_speed_ms: 8.597847666456873
2025-03-09 07:58:51,843 [INFO]: 	99p_search_speed_ms: 17.735486342571672
2025-03-09 07:58:51,843 [INFO]: 	reconstruction error %: 0.0
2025-03-09 07:58:51,843 [INFO]: 	nb vectors: 2547
2025-03-09 07:58:51,843 [INFO]: 	vectors dimension: 49152
2025-03-09 07:58:51,843 [INFO]: 	compression ratio: 0.9993095400844575
2025-03-09 07:58:51,843 [INFO]: }
2025-03-09 07:58:51,843 [INFO]: 	>>> Finished "Creating the index" in 47.4060 secs
2025-03-09 07:58:51,843 [INFO]: >>> Finished "Launching the whole pipeline" in 47.4373 secs
2025-03-09 07:58:52: [retrieval_preprocessing] calculating distances ...
2025-03-09 07:58:52: [retrieval_preprocessing] finished and saved retrieval indices for episode 11334 [episode count 17/20]
[retrieval_preprocessing] for episode 45646 [episode count 18/20], we have num_retrieval=np.int64(2565) num_query=np.int64(133)
2025-03-09 07:58:53,106 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-09 07:58:53,541 [INFO]: Launching the whole pipeline 03/09/2025, 07:58:53
2025-03-09 07:58:53,541 [INFO]: Reading total number of vectors and dimension 03/09/2025, 07:58:53
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1337.04it/s]
2025-03-09 07:58:53,572 [INFO]: There are 2565 embeddings of dim 49152
2025-03-09 07:58:53,572 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0308 secs
2025-03-09 07:58:53,572 [INFO]: 	Compute estimated construction time of the index 03/09/2025, 07:58:53
2025-03-09 07:58:53,572 [INFO]: 		-> Train: 16.7 minutes
2025-03-09 07:58:53,572 [INFO]: 		-> Add: 1.4 seconds
2025-03-09 07:58:53,572 [INFO]: 		Total: 16.7 minutes
2025-03-09 07:58:53,572 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0001 secs
2025-03-09 07:58:53,572 [INFO]: 	Checking that your have enough memory available to create the index 03/09/2025, 07:58:53
2025-03-09 07:58:53,572 [INFO]: 529.4MB of memory will be needed to build the index (more might be used if you have more)
2025-03-09 07:58:53,573 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0002 secs
2025-03-09 07:58:53,573 [INFO]: 	Selecting most promising index types given data characteristics 03/09/2025, 07:58:53
2025-03-09 07:58:53,573 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-09 07:58:53,573 [INFO]: 	Creating the index 03/09/2025, 07:58:53
2025-03-09 07:58:53,573 [INFO]: 		-> Instanciate the index HNSW15 03/09/2025, 07:58:53
2025-03-09 07:58:53,574 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0012 secs
2025-03-09 07:58:53,574 [INFO]: 		-> Adding the vectors to the index 03/09/2025, 07:58:53
2025-03-09 07:58:53,574 [INFO]: The memory available for adding the vectors is 49.5GB(total available - used by the index)
2025-03-09 07:58:53,574 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/11 [00:00<?, ?it/s] 18%|█▊        | 2/11 [00:00<00:00, 17.38it/s] 64%|██████▎   | 7/11 [00:00<00:00, 33.92it/s]100%|██████████| 11/11 [00:02<00:00,  4.18it/s]100%|██████████| 11/11 [00:02<00:00,  5.18it/s]
2025-03-09 07:58:55,701 [INFO]: 	Computing best hyperparameters for index knn.index 03/09/2025, 07:58:55
2025-03-09 07:59:32,017 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 36.3158 secs
2025-03-09 07:59:32,017 [INFO]: The best hyperparameters are: efSearch=250
2025-03-09 07:59:32,017 [INFO]: 	Compute fast metrics 03/09/2025, 07:59:32
  0%|          | 0/4 [00:00<?, ?it/s] 25%|██▌       | 1/4 [00:00<00:00,  9.25it/s] 75%|███████▌  | 3/4 [00:00<00:00, 15.54it/s]
2025-03-09 07:59:49,593 [INFO]: 	>>> Finished "Compute fast metrics" in 17.5756 secs
2025-03-09 07:59:49,964 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 56.3895 secs
2025-03-09 07:59:49,964 [INFO]: {
2025-03-09 07:59:49,964 [INFO]: 	index_key: HNSW15
2025-03-09 07:59:49,964 [INFO]: 	index_param: efSearch=250
2025-03-09 07:59:49,964 [INFO]: 	index_path: knn.index
2025-03-09 07:59:49,964 [INFO]: 	size in bytes: 504647890
2025-03-09 07:59:49,964 [INFO]: 	avg_search_speed_ms: 10.15187938920549
2025-03-09 07:59:49,965 [INFO]: 	99p_search_speed_ms: 20.341684168670316
2025-03-09 07:59:49,965 [INFO]: 	reconstruction error %: 0.0
2025-03-09 07:59:49,965 [INFO]: 	nb vectors: 2565
2025-03-09 07:59:49,965 [INFO]: 	vectors dimension: 49152
2025-03-09 07:59:49,965 [INFO]: 	compression ratio: 0.9993096770899013
2025-03-09 07:59:49,965 [INFO]: }
2025-03-09 07:59:49,965 [INFO]: 	>>> Finished "Creating the index" in 56.3921 secs
2025-03-09 07:59:49,965 [INFO]: >>> Finished "Launching the whole pipeline" in 56.4236 secs
2025-03-09 07:59:50: [retrieval_preprocessing] calculating distances ...
2025-03-09 07:59:51: [retrieval_preprocessing] finished and saved retrieval indices for episode 45646 [episode count 18/20]
[retrieval_preprocessing] for episode 24656 [episode count 19/20], we have num_retrieval=np.int64(2535) num_query=np.int64(163)
2025-03-09 07:59:51,625 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-09 07:59:51,966 [INFO]: Launching the whole pipeline 03/09/2025, 07:59:51
2025-03-09 07:59:51,966 [INFO]: Reading total number of vectors and dimension 03/09/2025, 07:59:51
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1217.50it/s]
2025-03-09 07:59:51,998 [INFO]: There are 2535 embeddings of dim 49152
2025-03-09 07:59:51,998 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0321 secs
2025-03-09 07:59:51,998 [INFO]: 	Compute estimated construction time of the index 03/09/2025, 07:59:51
2025-03-09 07:59:51,998 [INFO]: 		-> Train: 16.7 minutes
2025-03-09 07:59:51,998 [INFO]: 		-> Add: 1.4 seconds
2025-03-09 07:59:51,998 [INFO]: 		Total: 16.7 minutes
2025-03-09 07:59:51,998 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0001 secs
2025-03-09 07:59:51,998 [INFO]: 	Checking that your have enough memory available to create the index 03/09/2025, 07:59:51
2025-03-09 07:59:51,998 [INFO]: 523.2MB of memory will be needed to build the index (more might be used if you have more)
2025-03-09 07:59:51,998 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0001 secs
2025-03-09 07:59:51,998 [INFO]: 	Selecting most promising index types given data characteristics 03/09/2025, 07:59:51
2025-03-09 07:59:51,998 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-09 07:59:51,998 [INFO]: 	Creating the index 03/09/2025, 07:59:51
2025-03-09 07:59:51,998 [INFO]: 		-> Instanciate the index HNSW15 03/09/2025, 07:59:51
2025-03-09 07:59:51,999 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0010 secs
2025-03-09 07:59:52,000 [INFO]: 		-> Adding the vectors to the index 03/09/2025, 07:59:52
2025-03-09 07:59:52,000 [INFO]: The memory available for adding the vectors is 49.5GB(total available - used by the index)
2025-03-09 07:59:52,000 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/10 [00:00<?, ?it/s] 10%|█         | 1/10 [00:00<00:00,  9.17it/s] 70%|███████   | 7/10 [00:00<00:00, 35.78it/s]100%|██████████| 10/10 [00:01<00:00,  5.10it/s]
2025-03-09 07:59:53,963 [INFO]: 	Computing best hyperparameters for index knn.index 03/09/2025, 07:59:53
2025-03-09 08:00:23,553 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 29.5890 secs
2025-03-09 08:00:23,553 [INFO]: The best hyperparameters are: efSearch=205
2025-03-09 08:00:23,553 [INFO]: 	Compute fast metrics 03/09/2025, 08:00:23
  0%|          | 0/4 [00:00<?, ?it/s] 50%|█████     | 2/4 [00:00<00:00, 18.59it/s] 75%|███████▌  | 3/4 [00:00<00:00, 20.42it/s]
2025-03-09 08:00:38,484 [INFO]: 	>>> Finished "Compute fast metrics" in 14.9310 secs
2025-03-09 08:00:38,486 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 46.4864 secs
2025-03-09 08:00:38,486 [INFO]: {
2025-03-09 08:00:38,486 [INFO]: 	index_key: HNSW15
2025-03-09 08:00:38,486 [INFO]: 	index_param: efSearch=205
2025-03-09 08:00:38,486 [INFO]: 	index_path: knn.index
2025-03-09 08:00:38,486 [INFO]: 	size in bytes: 498745570
2025-03-09 08:00:38,486 [INFO]: 	avg_search_speed_ms: 9.325275355307108
2025-03-09 08:00:38,486 [INFO]: 	99p_search_speed_ms: 21.876484053209413
2025-03-09 08:00:38,486 [INFO]: 	reconstruction error %: 0.0
2025-03-09 08:00:38,486 [INFO]: 	nb vectors: 2535
2025-03-09 08:00:38,486 [INFO]: 	vectors dimension: 49152
2025-03-09 08:00:38,486 [INFO]: 	compression ratio: 0.9993096881040968
2025-03-09 08:00:38,486 [INFO]: }
2025-03-09 08:00:38,486 [INFO]: 	>>> Finished "Creating the index" in 46.4880 secs
2025-03-09 08:00:38,486 [INFO]: >>> Finished "Launching the whole pipeline" in 46.5207 secs
2025-03-09 08:00:39: [retrieval_preprocessing] calculating distances ...
2025-03-09 08:00:39: [retrieval_preprocessing] finished and saved retrieval indices for episode 24656 [episode count 19/20]
2025-03-09 08:00:39: [retrieval_preprocessing] finished for (3951366978, 'cup') [chosen_id count 3/10]
2025-03-09 08:00:41: [retrieval_preprocessing] concatenated all embeddings and indices for 20 episodes for (1959308322, 'marker') [chosen_id count 4/10]
2025-03-09 08:00:41: [retrieval_preprocessing] we have num_total=4705 embedding_dim=49152
[retrieval_preprocessing] for episode 52992 [episode count 0/20], we have num_retrieval=np.int64(4178) num_query=np.int64(527)
2025-03-09 08:00:41,670 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-09 08:00:42,212 [INFO]: Launching the whole pipeline 03/09/2025, 08:00:42
2025-03-09 08:00:42,212 [INFO]: Reading total number of vectors and dimension 03/09/2025, 08:00:42
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1474.27it/s]
2025-03-09 08:00:42,242 [INFO]: There are 4178 embeddings of dim 49152
2025-03-09 08:00:42,242 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0301 secs
2025-03-09 08:00:42,243 [INFO]: 	Compute estimated construction time of the index 03/09/2025, 08:00:42
2025-03-09 08:00:42,243 [INFO]: 		-> Train: 16.7 minutes
2025-03-09 08:00:42,243 [INFO]: 		-> Add: 2.3 seconds
2025-03-09 08:00:42,243 [INFO]: 		Total: 16.7 minutes
2025-03-09 08:00:42,243 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0004 secs
2025-03-09 08:00:42,243 [INFO]: 	Checking that your have enough memory available to create the index 03/09/2025, 08:00:42
2025-03-09 08:00:42,243 [INFO]: 862.2MB of memory will be needed to build the index (more might be used if you have more)
2025-03-09 08:00:42,244 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0004 secs
2025-03-09 08:00:42,244 [INFO]: 	Selecting most promising index types given data characteristics 03/09/2025, 08:00:42
2025-03-09 08:00:42,244 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-09 08:00:42,244 [INFO]: 	Creating the index 03/09/2025, 08:00:42
2025-03-09 08:00:42,244 [INFO]: 		-> Instanciate the index HNSW15 03/09/2025, 08:00:42
2025-03-09 08:00:42,247 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0026 secs
2025-03-09 08:00:42,247 [INFO]: 		-> Adding the vectors to the index 03/09/2025, 08:00:42
2025-03-09 08:00:42,247 [INFO]: The memory available for adding the vectors is 49.2GB(total available - used by the index)
2025-03-09 08:00:42,247 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/17 [00:00<?, ?it/s] 12%|█▏        | 2/17 [00:00<00:00, 19.96it/s] 41%|████      | 7/17 [00:00<00:00, 37.60it/s] 76%|███████▋  | 13/17 [00:00<00:00, 43.87it/s]100%|██████████| 17/17 [00:03<00:00,  5.18it/s]
2025-03-09 08:00:45,535 [INFO]: 	Computing best hyperparameters for index knn.index 03/09/2025, 08:00:45
2025-03-09 08:01:26,495 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 40.9593 secs
2025-03-09 08:01:26,495 [INFO]: The best hyperparameters are: efSearch=309
2025-03-09 08:01:26,495 [INFO]: 	Compute fast metrics 03/09/2025, 08:01:26
  0%|          | 0/4 [00:00<?, ?it/s] 50%|█████     | 2/4 [00:00<00:00, 17.35it/s] 75%|███████▌  | 3/4 [00:00<00:00, 14.13it/s]
2025-03-09 08:01:42,940 [INFO]: 	>>> Finished "Compute fast metrics" in 16.4447 secs
2025-03-09 08:01:42,943 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 60.6955 secs
2025-03-09 08:01:42,943 [INFO]: {
2025-03-09 08:01:42,943 [INFO]: 	index_key: HNSW15
2025-03-09 08:01:42,943 [INFO]: 	index_param: efSearch=309
2025-03-09 08:01:42,943 [INFO]: 	index_path: knn.index
2025-03-09 08:01:42,943 [INFO]: 	size in bytes: 821996470
2025-03-09 08:01:42,943 [INFO]: 	avg_search_speed_ms: 13.66020905522256
2025-03-09 08:01:42,943 [INFO]: 	99p_search_speed_ms: 32.10043050348752
2025-03-09 08:01:42,943 [INFO]: 	reconstruction error %: 0.0
2025-03-09 08:01:42,943 [INFO]: 	nb vectors: 4178
2025-03-09 08:01:42,943 [INFO]: 	vectors dimension: 49152
2025-03-09 08:01:42,943 [INFO]: 	compression ratio: 0.9993087001942964
2025-03-09 08:01:42,943 [INFO]: }
2025-03-09 08:01:42,943 [INFO]: 	>>> Finished "Creating the index" in 60.6991 secs
2025-03-09 08:01:42,943 [INFO]: >>> Finished "Launching the whole pipeline" in 60.7311 secs
2025-03-09 08:01:47: [retrieval_preprocessing] calculating distances ...
2025-03-09 08:01:49: [retrieval_preprocessing] finished and saved retrieval indices for episode 52992 [episode count 0/20]
[retrieval_preprocessing] for episode 38273 [episode count 1/20], we have num_retrieval=np.int64(4444) num_query=np.int64(261)
2025-03-09 08:01:50,354 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-09 08:01:51,242 [INFO]: Launching the whole pipeline 03/09/2025, 08:01:51
2025-03-09 08:01:51,242 [INFO]: Reading total number of vectors and dimension 03/09/2025, 08:01:51
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1155.77it/s]
2025-03-09 08:01:51,271 [INFO]: There are 4444 embeddings of dim 49152
2025-03-09 08:01:51,271 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0293 secs
2025-03-09 08:01:51,272 [INFO]: 	Compute estimated construction time of the index 03/09/2025, 08:01:51
2025-03-09 08:01:51,272 [INFO]: 		-> Train: 16.7 minutes
2025-03-09 08:01:51,272 [INFO]: 		-> Add: 2.4 seconds
2025-03-09 08:01:51,272 [INFO]: 		Total: 16.7 minutes
2025-03-09 08:01:51,272 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0001 secs
2025-03-09 08:01:51,272 [INFO]: 	Checking that your have enough memory available to create the index 03/09/2025, 08:01:51
2025-03-09 08:01:51,272 [INFO]: 917.1MB of memory will be needed to build the index (more might be used if you have more)
2025-03-09 08:01:51,272 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0002 secs
2025-03-09 08:01:51,272 [INFO]: 	Selecting most promising index types given data characteristics 03/09/2025, 08:01:51
2025-03-09 08:01:51,272 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-09 08:01:51,272 [INFO]: 	Creating the index 03/09/2025, 08:01:51
2025-03-09 08:01:51,272 [INFO]: 		-> Instanciate the index HNSW15 03/09/2025, 08:01:51
2025-03-09 08:01:51,273 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0012 secs
2025-03-09 08:01:51,273 [INFO]: 		-> Adding the vectors to the index 03/09/2025, 08:01:51
2025-03-09 08:01:51,273 [INFO]: The memory available for adding the vectors is 49.2GB(total available - used by the index)
2025-03-09 08:01:51,274 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/18 [00:00<?, ?it/s]  6%|▌         | 1/18 [00:00<00:02,  7.95it/s] 39%|███▉      | 7/18 [00:00<00:00, 32.68it/s] 72%|███████▏  | 13/18 [00:00<00:00, 41.09it/s]100%|██████████| 18/18 [00:04<00:00,  3.12it/s]100%|██████████| 18/18 [00:04<00:00,  4.30it/s]
2025-03-09 08:01:55,464 [INFO]: 	Computing best hyperparameters for index knn.index 03/09/2025, 08:01:55
2025-03-09 08:02:39,664 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 44.1989 secs
2025-03-09 08:02:39,664 [INFO]: The best hyperparameters are: efSearch=260
2025-03-09 08:02:39,664 [INFO]: 	Compute fast metrics 03/09/2025, 08:02:39
  0%|          | 0/4 [00:00<?, ?it/s] 50%|█████     | 2/4 [00:00<00:00, 19.87it/s] 75%|███████▌  | 3/4 [00:00<00:00, 19.20it/s]
2025-03-09 08:02:55,691 [INFO]: 	>>> Finished "Compute fast metrics" in 16.0265 secs
2025-03-09 08:02:55,693 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 64.4200 secs
2025-03-09 08:02:55,693 [INFO]: {
2025-03-09 08:02:55,693 [INFO]: 	index_key: HNSW15
2025-03-09 08:02:55,694 [INFO]: 	index_param: efSearch=260
2025-03-09 08:02:55,694 [INFO]: 	index_path: knn.index
2025-03-09 08:02:55,694 [INFO]: 	size in bytes: 874330450
2025-03-09 08:02:55,694 [INFO]: 	avg_search_speed_ms: 10.528346142780624
2025-03-09 08:02:55,694 [INFO]: 	99p_search_speed_ms: 23.582569137215607
2025-03-09 08:02:55,694 [INFO]: 	reconstruction error %: 0.0
2025-03-09 08:02:55,694 [INFO]: 	nb vectors: 4444
2025-03-09 08:02:55,694 [INFO]: 	vectors dimension: 49152
2025-03-09 08:02:55,694 [INFO]: 	compression ratio: 0.9993086160958937
2025-03-09 08:02:55,694 [INFO]: }
2025-03-09 08:02:55,694 [INFO]: 	>>> Finished "Creating the index" in 64.4216 secs
2025-03-09 08:02:55,694 [INFO]: >>> Finished "Launching the whole pipeline" in 64.4516 secs
2025-03-09 08:02:57: [retrieval_preprocessing] calculating distances ...
2025-03-09 08:02:58: [retrieval_preprocessing] finished and saved retrieval indices for episode 38273 [episode count 1/20]
[retrieval_preprocessing] for episode 69633 [episode count 2/20], we have num_retrieval=np.int64(4532) num_query=np.int64(173)
2025-03-09 08:02:58,346 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-09 08:02:58,874 [INFO]: Launching the whole pipeline 03/09/2025, 08:02:58
2025-03-09 08:02:58,874 [INFO]: Reading total number of vectors and dimension 03/09/2025, 08:02:58
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1551.72it/s]
2025-03-09 08:02:58,902 [INFO]: There are 4532 embeddings of dim 49152
2025-03-09 08:02:58,902 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0282 secs
2025-03-09 08:02:58,902 [INFO]: 	Compute estimated construction time of the index 03/09/2025, 08:02:58
2025-03-09 08:02:58,902 [INFO]: 		-> Train: 16.7 minutes
2025-03-09 08:02:58,903 [INFO]: 		-> Add: 2.5 seconds
2025-03-09 08:02:58,903 [INFO]: 		Total: 16.7 minutes
2025-03-09 08:02:58,903 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0005 secs
2025-03-09 08:02:58,903 [INFO]: 	Checking that your have enough memory available to create the index 03/09/2025, 08:02:58
2025-03-09 08:02:58,903 [INFO]: 935.3MB of memory will be needed to build the index (more might be used if you have more)
2025-03-09 08:02:58,904 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0005 secs
2025-03-09 08:02:58,904 [INFO]: 	Selecting most promising index types given data characteristics 03/09/2025, 08:02:58
2025-03-09 08:02:58,904 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-09 08:02:58,904 [INFO]: 	Creating the index 03/09/2025, 08:02:58
2025-03-09 08:02:58,904 [INFO]: 		-> Instanciate the index HNSW15 03/09/2025, 08:02:58
2025-03-09 08:02:58,907 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0029 secs
2025-03-09 08:02:58,908 [INFO]: 		-> Adding the vectors to the index 03/09/2025, 08:02:58
2025-03-09 08:02:58,908 [INFO]: The memory available for adding the vectors is 49.2GB(total available - used by the index)
2025-03-09 08:02:58,908 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/18 [00:00<?, ?it/s] 11%|█         | 2/18 [00:00<00:01, 15.71it/s] 44%|████▍     | 8/18 [00:00<00:00, 35.58it/s] 72%|███████▏  | 13/18 [00:00<00:00, 40.33it/s]100%|██████████| 18/18 [00:04<00:00,  3.01it/s]100%|██████████| 18/18 [00:04<00:00,  4.28it/s]
2025-03-09 08:03:03,119 [INFO]: 	Computing best hyperparameters for index knn.index 03/09/2025, 08:03:03
2025-03-09 08:03:50,095 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 46.9763 secs
2025-03-09 08:03:50,096 [INFO]: The best hyperparameters are: efSearch=239
2025-03-09 08:03:50,096 [INFO]: 	Compute fast metrics 03/09/2025, 08:03:50
  0%|          | 0/4 [00:00<?, ?it/s] 50%|█████     | 2/4 [00:00<00:00, 19.22it/s] 75%|███████▌  | 3/4 [00:00<00:00, 20.50it/s]
2025-03-09 08:04:06,122 [INFO]: 	>>> Finished "Compute fast metrics" in 16.0261 secs
2025-03-09 08:04:06,125 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 67.2169 secs
2025-03-09 08:04:06,125 [INFO]: {
2025-03-09 08:04:06,125 [INFO]: 	index_key: HNSW15
2025-03-09 08:04:06,125 [INFO]: 	index_param: efSearch=239
2025-03-09 08:04:06,125 [INFO]: 	index_path: knn.index
2025-03-09 08:04:06,125 [INFO]: 	size in bytes: 891643750
2025-03-09 08:04:06,125 [INFO]: 	avg_search_speed_ms: 9.60970544936198
2025-03-09 08:04:06,125 [INFO]: 	99p_search_speed_ms: 22.033656993880793
2025-03-09 08:04:06,125 [INFO]: 	reconstruction error %: 0.0
2025-03-09 08:04:06,125 [INFO]: 	nb vectors: 4532
2025-03-09 08:04:06,125 [INFO]: 	vectors dimension: 49152
2025-03-09 08:04:06,125 [INFO]: 	compression ratio: 0.9993088113946854
2025-03-09 08:04:06,125 [INFO]: }
2025-03-09 08:04:06,125 [INFO]: 	>>> Finished "Creating the index" in 67.2208 secs
2025-03-09 08:04:06,125 [INFO]: >>> Finished "Launching the whole pipeline" in 67.2510 secs
2025-03-09 08:04:07: [retrieval_preprocessing] calculating distances ...
2025-03-09 08:04:07: [retrieval_preprocessing] finished and saved retrieval indices for episode 69633 [episode count 2/20]
[retrieval_preprocessing] for episode 8837 [episode count 3/20], we have num_retrieval=np.int64(4470) num_query=np.int64(235)
2025-03-09 08:04:08,317 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-09 08:04:09,091 [INFO]: Launching the whole pipeline 03/09/2025, 08:04:09
2025-03-09 08:04:09,091 [INFO]: Reading total number of vectors and dimension 03/09/2025, 08:04:09
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1607.01it/s]
2025-03-09 08:04:09,115 [INFO]: There are 4470 embeddings of dim 49152
2025-03-09 08:04:09,115 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0242 secs
2025-03-09 08:04:09,115 [INFO]: 	Compute estimated construction time of the index 03/09/2025, 08:04:09
2025-03-09 08:04:09,115 [INFO]: 		-> Train: 16.7 minutes
2025-03-09 08:04:09,115 [INFO]: 		-> Add: 2.5 seconds
2025-03-09 08:04:09,115 [INFO]: 		Total: 16.7 minutes
2025-03-09 08:04:09,115 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0001 secs
2025-03-09 08:04:09,115 [INFO]: 	Checking that your have enough memory available to create the index 03/09/2025, 08:04:09
2025-03-09 08:04:09,115 [INFO]: 922.5MB of memory will be needed to build the index (more might be used if you have more)
2025-03-09 08:04:09,116 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0001 secs
2025-03-09 08:04:09,116 [INFO]: 	Selecting most promising index types given data characteristics 03/09/2025, 08:04:09
2025-03-09 08:04:09,116 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-09 08:04:09,116 [INFO]: 	Creating the index 03/09/2025, 08:04:09
2025-03-09 08:04:09,116 [INFO]: 		-> Instanciate the index HNSW15 03/09/2025, 08:04:09
2025-03-09 08:04:09,117 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0009 secs
2025-03-09 08:04:09,117 [INFO]: 		-> Adding the vectors to the index 03/09/2025, 08:04:09
2025-03-09 08:04:09,117 [INFO]: The memory available for adding the vectors is 49.2GB(total available - used by the index)
2025-03-09 08:04:09,117 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/18 [00:00<?, ?it/s] 11%|█         | 2/18 [00:00<00:01, 13.02it/s] 33%|███▎      | 6/18 [00:00<00:00, 25.13it/s] 61%|██████    | 11/18 [00:00<00:00, 33.30it/s] 83%|████████▎ | 15/18 [00:00<00:00, 33.95it/s]100%|██████████| 18/18 [00:03<00:00,  4.51it/s]
2025-03-09 08:04:13,232 [INFO]: 	Computing best hyperparameters for index knn.index 03/09/2025, 08:04:13
2025-03-09 08:04:59,291 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 46.0582 secs
2025-03-09 08:04:59,291 [INFO]: The best hyperparameters are: efSearch=235
2025-03-09 08:04:59,291 [INFO]: 	Compute fast metrics 03/09/2025, 08:04:59
  0%|          | 0/4 [00:00<?, ?it/s] 50%|█████     | 2/4 [00:00<00:00, 18.32it/s] 75%|███████▌  | 3/4 [00:00<00:00, 19.84it/s]
2025-03-09 08:05:19,728 [INFO]: 	>>> Finished "Compute fast metrics" in 20.4372 secs
2025-03-09 08:05:19,731 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 70.6141 secs
2025-03-09 08:05:19,731 [INFO]: {
2025-03-09 08:05:19,731 [INFO]: 	index_key: HNSW15
2025-03-09 08:05:19,731 [INFO]: 	index_param: efSearch=235
2025-03-09 08:05:19,731 [INFO]: 	index_path: knn.index
2025-03-09 08:05:19,731 [INFO]: 	size in bytes: 879445750
2025-03-09 08:05:19,731 [INFO]: 	avg_search_speed_ms: 10.1005274042807
2025-03-09 08:05:19,731 [INFO]: 	99p_search_speed_ms: 20.18587007187307
2025-03-09 08:05:19,731 [INFO]: 	reconstruction error %: 0.0
2025-03-09 08:05:19,731 [INFO]: 	nb vectors: 4470
2025-03-09 08:05:19,731 [INFO]: 	vectors dimension: 49152
2025-03-09 08:05:19,731 [INFO]: 	compression ratio: 0.9993086668506841
2025-03-09 08:05:19,731 [INFO]: }
2025-03-09 08:05:19,731 [INFO]: 	>>> Finished "Creating the index" in 70.6155 secs
2025-03-09 08:05:19,731 [INFO]: >>> Finished "Launching the whole pipeline" in 70.6404 secs
2025-03-09 08:05:21: [retrieval_preprocessing] calculating distances ...
2025-03-09 08:05:21: [retrieval_preprocessing] finished and saved retrieval indices for episode 8837 [episode count 3/20]
[retrieval_preprocessing] for episode 52102 [episode count 4/20], we have num_retrieval=np.int64(4476) num_query=np.int64(229)
2025-03-09 08:05:22,338 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-09 08:05:23,796 [INFO]: Launching the whole pipeline 03/09/2025, 08:05:23
2025-03-09 08:05:23,796 [INFO]: Reading total number of vectors and dimension 03/09/2025, 08:05:23
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 2184.53it/s]
2025-03-09 08:05:23,830 [INFO]: There are 4476 embeddings of dim 49152
2025-03-09 08:05:23,830 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0345 secs
2025-03-09 08:05:23,830 [INFO]: 	Compute estimated construction time of the index 03/09/2025, 08:05:23
2025-03-09 08:05:23,830 [INFO]: 		-> Train: 16.7 minutes
2025-03-09 08:05:23,830 [INFO]: 		-> Add: 2.5 seconds
2025-03-09 08:05:23,830 [INFO]: 		Total: 16.7 minutes
2025-03-09 08:05:23,830 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0001 secs
2025-03-09 08:05:23,830 [INFO]: 	Checking that your have enough memory available to create the index 03/09/2025, 08:05:23
2025-03-09 08:05:23,831 [INFO]: 923.7MB of memory will be needed to build the index (more might be used if you have more)
2025-03-09 08:05:23,831 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0002 secs
2025-03-09 08:05:23,831 [INFO]: 	Selecting most promising index types given data characteristics 03/09/2025, 08:05:23
2025-03-09 08:05:23,831 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-09 08:05:23,831 [INFO]: 	Creating the index 03/09/2025, 08:05:23
2025-03-09 08:05:23,831 [INFO]: 		-> Instanciate the index HNSW15 03/09/2025, 08:05:23
2025-03-09 08:05:23,832 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0008 secs
2025-03-09 08:05:23,832 [INFO]: 		-> Adding the vectors to the index 03/09/2025, 08:05:23
2025-03-09 08:05:23,832 [INFO]: The memory available for adding the vectors is 49.2GB(total available - used by the index)
2025-03-09 08:05:23,832 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/18 [00:00<?, ?it/s]  6%|▌         | 1/18 [00:00<00:02,  8.43it/s] 33%|███▎      | 6/18 [00:00<00:00, 30.89it/s] 61%|██████    | 11/18 [00:00<00:00, 38.87it/s] 89%|████████▉ | 16/18 [00:00<00:00, 42.75it/s]100%|██████████| 18/18 [00:03<00:00,  4.96it/s]
2025-03-09 08:05:27,468 [INFO]: 	Computing best hyperparameters for index knn.index 03/09/2025, 08:05:27
2025-03-09 08:06:13,185 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 45.7168 secs
2025-03-09 08:06:13,185 [INFO]: The best hyperparameters are: efSearch=238
2025-03-09 08:06:13,185 [INFO]: 	Compute fast metrics 03/09/2025, 08:06:13
  0%|          | 0/4 [00:00<?, ?it/s] 50%|█████     | 2/4 [00:00<00:00, 18.87it/s] 75%|███████▌  | 3/4 [00:00<00:00, 21.19it/s]
2025-03-09 08:06:33,433 [INFO]: 	>>> Finished "Compute fast metrics" in 20.2473 secs
2025-03-09 08:06:33,435 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 69.6030 secs
2025-03-09 08:06:33,435 [INFO]: {
2025-03-09 08:06:33,435 [INFO]: 	index_key: HNSW15
2025-03-09 08:06:33,435 [INFO]: 	index_param: efSearch=238
2025-03-09 08:06:33,435 [INFO]: 	index_path: knn.index
2025-03-09 08:06:33,435 [INFO]: 	size in bytes: 880626250
2025-03-09 08:06:33,435 [INFO]: 	avg_search_speed_ms: 9.123980637638061
2025-03-09 08:06:33,436 [INFO]: 	99p_search_speed_ms: 19.979377987328903
2025-03-09 08:06:33,436 [INFO]: 	reconstruction error %: 0.0
2025-03-09 08:06:33,436 [INFO]: 	nb vectors: 4476
2025-03-09 08:06:33,436 [INFO]: 	vectors dimension: 49152
2025-03-09 08:06:33,436 [INFO]: 	compression ratio: 0.9993086261055698
2025-03-09 08:06:33,436 [INFO]: }
2025-03-09 08:06:33,436 [INFO]: 	>>> Finished "Creating the index" in 69.6043 secs
2025-03-09 08:06:33,436 [INFO]: >>> Finished "Launching the whole pipeline" in 69.6399 secs
2025-03-09 08:06:35: [retrieval_preprocessing] calculating distances ...
2025-03-09 08:06:35: [retrieval_preprocessing] finished and saved retrieval indices for episode 52102 [episode count 4/20]
[retrieval_preprocessing] for episode 18567 [episode count 5/20], we have num_retrieval=np.int64(4524) num_query=np.int64(181)
2025-03-09 08:06:36,105 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-09 08:06:36,705 [INFO]: Launching the whole pipeline 03/09/2025, 08:06:36
2025-03-09 08:06:36,705 [INFO]: Reading total number of vectors and dimension 03/09/2025, 08:06:36
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1525.76it/s]
2025-03-09 08:06:36,730 [INFO]: There are 4524 embeddings of dim 49152
2025-03-09 08:06:36,730 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0242 secs
2025-03-09 08:06:36,730 [INFO]: 	Compute estimated construction time of the index 03/09/2025, 08:06:36
2025-03-09 08:06:36,730 [INFO]: 		-> Train: 16.7 minutes
2025-03-09 08:06:36,730 [INFO]: 		-> Add: 2.5 seconds
2025-03-09 08:06:36,730 [INFO]: 		Total: 16.7 minutes
2025-03-09 08:06:36,730 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0001 secs
2025-03-09 08:06:36,730 [INFO]: 	Checking that your have enough memory available to create the index 03/09/2025, 08:06:36
2025-03-09 08:06:36,730 [INFO]: 933.6MB of memory will be needed to build the index (more might be used if you have more)
2025-03-09 08:06:36,730 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0002 secs
2025-03-09 08:06:36,730 [INFO]: 	Selecting most promising index types given data characteristics 03/09/2025, 08:06:36
2025-03-09 08:06:36,730 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-09 08:06:36,730 [INFO]: 	Creating the index 03/09/2025, 08:06:36
2025-03-09 08:06:36,730 [INFO]: 		-> Instanciate the index HNSW15 03/09/2025, 08:06:36
2025-03-09 08:06:36,731 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0009 secs
2025-03-09 08:06:36,732 [INFO]: 		-> Adding the vectors to the index 03/09/2025, 08:06:36
2025-03-09 08:06:36,732 [INFO]: The memory available for adding the vectors is 49.2GB(total available - used by the index)
2025-03-09 08:06:36,732 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/18 [00:00<?, ?it/s]  6%|▌         | 1/18 [00:00<00:01,  9.01it/s] 39%|███▉      | 7/18 [00:00<00:00, 34.85it/s] 72%|███████▏  | 13/18 [00:00<00:00, 42.99it/s]100%|██████████| 18/18 [00:03<00:00,  3.52it/s]100%|██████████| 18/18 [00:03<00:00,  4.85it/s]
2025-03-09 08:06:40,447 [INFO]: 	Computing best hyperparameters for index knn.index 03/09/2025, 08:06:40
2025-03-09 08:07:25,987 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 45.5389 secs
2025-03-09 08:07:25,987 [INFO]: The best hyperparameters are: efSearch=256
2025-03-09 08:07:25,987 [INFO]: 	Compute fast metrics 03/09/2025, 08:07:25
  0%|          | 0/4 [00:00<?, ?it/s] 50%|█████     | 2/4 [00:00<00:00, 16.86it/s] 75%|███████▌  | 3/4 [00:00<00:00, 18.55it/s]
2025-03-09 08:07:41,965 [INFO]: 	>>> Finished "Compute fast metrics" in 15.9780 secs
2025-03-09 08:07:43,310 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 66.5782 secs
2025-03-09 08:07:43,310 [INFO]: {
2025-03-09 08:07:43,310 [INFO]: 	index_key: HNSW15
2025-03-09 08:07:43,310 [INFO]: 	index_param: efSearch=256
2025-03-09 08:07:43,310 [INFO]: 	index_path: knn.index
2025-03-09 08:07:43,310 [INFO]: 	size in bytes: 890069830
2025-03-09 08:07:43,310 [INFO]: 	avg_search_speed_ms: 10.483725334466893
2025-03-09 08:07:43,311 [INFO]: 	99p_search_speed_ms: 24.220200190320615
2025-03-09 08:07:43,311 [INFO]: 	reconstruction error %: 0.0
2025-03-09 08:07:43,311 [INFO]: 	nb vectors: 4524
2025-03-09 08:07:43,311 [INFO]: 	vectors dimension: 49152
2025-03-09 08:07:43,311 [INFO]: 	compression ratio: 0.9993087755822484
2025-03-09 08:07:43,311 [INFO]: }
2025-03-09 08:07:43,311 [INFO]: 	>>> Finished "Creating the index" in 66.5804 secs
2025-03-09 08:07:43,311 [INFO]: >>> Finished "Launching the whole pipeline" in 66.6055 secs
2025-03-09 08:07:44: [retrieval_preprocessing] calculating distances ...
2025-03-09 08:07:45: [retrieval_preprocessing] finished and saved retrieval indices for episode 18567 [episode count 5/20]
[retrieval_preprocessing] for episode 81797 [episode count 6/20], we have num_retrieval=np.int64(4490) num_query=np.int64(215)
2025-03-09 08:07:45,385 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-09 08:07:45,896 [INFO]: Launching the whole pipeline 03/09/2025, 08:07:45
2025-03-09 08:07:45,897 [INFO]: Reading total number of vectors and dimension 03/09/2025, 08:07:45
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1427.61it/s]
2025-03-09 08:07:45,921 [INFO]: There are 4490 embeddings of dim 49152
2025-03-09 08:07:45,921 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0244 secs
2025-03-09 08:07:45,921 [INFO]: 	Compute estimated construction time of the index 03/09/2025, 08:07:45
2025-03-09 08:07:45,921 [INFO]: 		-> Train: 16.7 minutes
2025-03-09 08:07:45,921 [INFO]: 		-> Add: 2.5 seconds
2025-03-09 08:07:45,921 [INFO]: 		Total: 16.7 minutes
2025-03-09 08:07:45,921 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0001 secs
2025-03-09 08:07:45,921 [INFO]: 	Checking that your have enough memory available to create the index 03/09/2025, 08:07:45
2025-03-09 08:07:45,921 [INFO]: 926.6MB of memory will be needed to build the index (more might be used if you have more)
2025-03-09 08:07:45,922 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0001 secs
2025-03-09 08:07:45,922 [INFO]: 	Selecting most promising index types given data characteristics 03/09/2025, 08:07:45
2025-03-09 08:07:45,922 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-09 08:07:45,922 [INFO]: 	Creating the index 03/09/2025, 08:07:45
2025-03-09 08:07:45,922 [INFO]: 		-> Instanciate the index HNSW15 03/09/2025, 08:07:45
2025-03-09 08:07:45,923 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0009 secs
2025-03-09 08:07:45,923 [INFO]: 		-> Adding the vectors to the index 03/09/2025, 08:07:45
2025-03-09 08:07:45,923 [INFO]: The memory available for adding the vectors is 49.2GB(total available - used by the index)
2025-03-09 08:07:45,923 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/18 [00:00<?, ?it/s]  6%|▌         | 1/18 [00:00<00:01,  8.50it/s] 33%|███▎      | 6/18 [00:00<00:00, 29.61it/s] 67%|██████▋   | 12/18 [00:00<00:00, 42.48it/s]100%|██████████| 18/18 [00:03<00:00,  3.92it/s]100%|██████████| 18/18 [00:03<00:00,  5.18it/s]
2025-03-09 08:07:49,403 [INFO]: 	Computing best hyperparameters for index knn.index 03/09/2025, 08:07:49
2025-03-09 08:08:34,861 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 45.4566 secs
2025-03-09 08:08:34,861 [INFO]: The best hyperparameters are: efSearch=257
2025-03-09 08:08:34,861 [INFO]: 	Compute fast metrics 03/09/2025, 08:08:34
  0%|          | 0/4 [00:00<?, ?it/s] 50%|█████     | 2/4 [00:00<00:00, 17.28it/s] 75%|███████▌  | 3/4 [00:00<00:00, 18.26it/s]
2025-03-09 08:08:50,883 [INFO]: 	>>> Finished "Compute fast metrics" in 16.0217 secs
2025-03-09 08:08:50,886 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 64.9629 secs
2025-03-09 08:08:50,886 [INFO]: {
2025-03-09 08:08:50,886 [INFO]: 	index_key: HNSW15
2025-03-09 08:08:50,886 [INFO]: 	index_param: efSearch=257
2025-03-09 08:08:50,886 [INFO]: 	index_path: knn.index
2025-03-09 08:08:50,886 [INFO]: 	size in bytes: 883380610
2025-03-09 08:08:50,886 [INFO]: 	avg_search_speed_ms: 11.055479165248943
2025-03-09 08:08:50,886 [INFO]: 	99p_search_speed_ms: 24.145162748172883
2025-03-09 08:08:50,886 [INFO]: 	reconstruction error %: 0.0
2025-03-09 08:08:50,886 [INFO]: 	nb vectors: 4490
2025-03-09 08:08:50,886 [INFO]: 	vectors dimension: 49152
2025-03-09 08:08:50,886 [INFO]: 	compression ratio: 0.9993086898296307
2025-03-09 08:08:50,886 [INFO]: }
2025-03-09 08:08:50,886 [INFO]: 	>>> Finished "Creating the index" in 64.9644 secs
2025-03-09 08:08:50,886 [INFO]: >>> Finished "Launching the whole pipeline" in 64.9895 secs
2025-03-09 08:08:52: [retrieval_preprocessing] calculating distances ...
2025-03-09 08:08:53: [retrieval_preprocessing] finished and saved retrieval indices for episode 81797 [episode count 6/20]
[retrieval_preprocessing] for episode 62987 [episode count 7/20], we have num_retrieval=np.int64(4572) num_query=np.int64(133)
2025-03-09 08:08:53,538 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-09 08:08:54,121 [INFO]: Launching the whole pipeline 03/09/2025, 08:08:54
2025-03-09 08:08:54,121 [INFO]: Reading total number of vectors and dimension 03/09/2025, 08:08:54
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1161.54it/s]
2025-03-09 08:08:54,147 [INFO]: There are 4572 embeddings of dim 49152
2025-03-09 08:08:54,148 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0261 secs
2025-03-09 08:08:54,148 [INFO]: 	Compute estimated construction time of the index 03/09/2025, 08:08:54
2025-03-09 08:08:54,148 [INFO]: 		-> Train: 16.7 minutes
2025-03-09 08:08:54,148 [INFO]: 		-> Add: 2.5 seconds
2025-03-09 08:08:54,148 [INFO]: 		Total: 16.7 minutes
2025-03-09 08:08:54,148 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0001 secs
2025-03-09 08:08:54,148 [INFO]: 	Checking that your have enough memory available to create the index 03/09/2025, 08:08:54
2025-03-09 08:08:54,148 [INFO]: 943.6MB of memory will be needed to build the index (more might be used if you have more)
2025-03-09 08:08:54,148 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0001 secs
2025-03-09 08:08:54,148 [INFO]: 	Selecting most promising index types given data characteristics 03/09/2025, 08:08:54
2025-03-09 08:08:54,148 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-09 08:08:54,148 [INFO]: 	Creating the index 03/09/2025, 08:08:54
2025-03-09 08:08:54,148 [INFO]: 		-> Instanciate the index HNSW15 03/09/2025, 08:08:54
2025-03-09 08:08:54,149 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0010 secs
2025-03-09 08:08:54,149 [INFO]: 		-> Adding the vectors to the index 03/09/2025, 08:08:54
2025-03-09 08:08:54,149 [INFO]: The memory available for adding the vectors is 49.2GB(total available - used by the index)
2025-03-09 08:08:54,149 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/18 [00:00<?, ?it/s]  6%|▌         | 1/18 [00:00<00:02,  7.43it/s] 33%|███▎      | 6/18 [00:00<00:00, 29.31it/s] 61%|██████    | 11/18 [00:00<00:00, 37.68it/s] 94%|█████████▍| 17/18 [00:00<00:00, 43.00it/s]100%|██████████| 18/18 [00:03<00:00,  4.82it/s]
2025-03-09 08:08:57,885 [INFO]: 	Computing best hyperparameters for index knn.index 03/09/2025, 08:08:57
2025-03-09 08:09:37,860 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 39.9753 secs
2025-03-09 08:09:37,861 [INFO]: The best hyperparameters are: efSearch=282
2025-03-09 08:09:37,861 [INFO]: 	Compute fast metrics 03/09/2025, 08:09:37
  0%|          | 0/4 [00:00<?, ?it/s] 75%|███████▌  | 3/4 [00:00<00:00, 25.38it/s] 75%|███████▌  | 3/4 [00:00<00:00, 21.84it/s]
2025-03-09 08:09:55,516 [INFO]: 	>>> Finished "Compute fast metrics" in 17.6546 secs
2025-03-09 08:09:55,519 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 61.3693 secs
2025-03-09 08:09:55,519 [INFO]: {
2025-03-09 08:09:55,519 [INFO]: 	index_key: HNSW15
2025-03-09 08:09:55,519 [INFO]: 	index_param: efSearch=282
2025-03-09 08:09:55,519 [INFO]: 	index_path: knn.index
2025-03-09 08:09:55,519 [INFO]: 	size in bytes: 899513590
2025-03-09 08:09:55,519 [INFO]: 	avg_search_speed_ms: 10.959263925664004
2025-03-09 08:09:55,519 [INFO]: 	99p_search_speed_ms: 24.20214991085231
2025-03-09 08:09:55,519 [INFO]: 	reconstruction error %: 0.0
2025-03-09 08:09:55,519 [INFO]: 	nb vectors: 4572
2025-03-09 08:09:55,519 [INFO]: 	vectors dimension: 49152
2025-03-09 08:09:55,519 [INFO]: 	compression ratio: 0.9993087219504933
2025-03-09 08:09:55,519 [INFO]: }
2025-03-09 08:09:55,519 [INFO]: 	>>> Finished "Creating the index" in 61.3710 secs
2025-03-09 08:09:55,519 [INFO]: >>> Finished "Launching the whole pipeline" in 61.3976 secs
2025-03-09 08:09:56: [retrieval_preprocessing] calculating distances ...
2025-03-09 08:09:57: [retrieval_preprocessing] finished and saved retrieval indices for episode 62987 [episode count 7/20]
[retrieval_preprocessing] for episode 34572 [episode count 8/20], we have num_retrieval=np.int64(4482) num_query=np.int64(223)
2025-03-09 08:09:57,522 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-09 08:09:58,127 [INFO]: Launching the whole pipeline 03/09/2025, 08:09:58
2025-03-09 08:09:58,128 [INFO]: Reading total number of vectors and dimension 03/09/2025, 08:09:58
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1468.59it/s]
2025-03-09 08:09:58,150 [INFO]: There are 4482 embeddings of dim 49152
2025-03-09 08:09:58,150 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0222 secs
2025-03-09 08:09:58,150 [INFO]: 	Compute estimated construction time of the index 03/09/2025, 08:09:58
2025-03-09 08:09:58,150 [INFO]: 		-> Train: 16.7 minutes
2025-03-09 08:09:58,150 [INFO]: 		-> Add: 2.5 seconds
2025-03-09 08:09:58,150 [INFO]: 		Total: 16.7 minutes
2025-03-09 08:09:58,150 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0001 secs
2025-03-09 08:09:58,150 [INFO]: 	Checking that your have enough memory available to create the index 03/09/2025, 08:09:58
2025-03-09 08:09:58,150 [INFO]: 925.0MB of memory will be needed to build the index (more might be used if you have more)
2025-03-09 08:09:58,150 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0001 secs
2025-03-09 08:09:58,150 [INFO]: 	Selecting most promising index types given data characteristics 03/09/2025, 08:09:58
2025-03-09 08:09:58,150 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-09 08:09:58,150 [INFO]: 	Creating the index 03/09/2025, 08:09:58
2025-03-09 08:09:58,150 [INFO]: 		-> Instanciate the index HNSW15 03/09/2025, 08:09:58
2025-03-09 08:09:58,151 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0008 secs
2025-03-09 08:09:58,151 [INFO]: 		-> Adding the vectors to the index 03/09/2025, 08:09:58
2025-03-09 08:09:58,151 [INFO]: The memory available for adding the vectors is 49.2GB(total available - used by the index)
2025-03-09 08:09:58,151 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/18 [00:00<?, ?it/s]  6%|▌         | 1/18 [00:00<00:02,  7.38it/s] 33%|███▎      | 6/18 [00:00<00:00, 27.90it/s] 61%|██████    | 11/18 [00:00<00:00, 35.70it/s] 89%|████████▉ | 16/18 [00:00<00:00, 39.25it/s]100%|██████████| 18/18 [00:03<00:00,  5.10it/s]
2025-03-09 08:10:01,686 [INFO]: 	Computing best hyperparameters for index knn.index 03/09/2025, 08:10:01
2025-03-09 08:10:43,469 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 41.7830 secs
2025-03-09 08:10:43,469 [INFO]: The best hyperparameters are: efSearch=200
2025-03-09 08:10:43,469 [INFO]: 	Compute fast metrics 03/09/2025, 08:10:43
  0%|          | 0/4 [00:00<?, ?it/s] 50%|█████     | 2/4 [00:00<00:00, 19.27it/s] 75%|███████▌  | 3/4 [00:00<00:00, 18.40it/s]
2025-03-09 08:10:59,870 [INFO]: 	>>> Finished "Compute fast metrics" in 16.4001 secs
2025-03-09 08:10:59,872 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 61.7210 secs
2025-03-09 08:10:59,873 [INFO]: {
2025-03-09 08:10:59,873 [INFO]: 	index_key: HNSW15
2025-03-09 08:10:59,873 [INFO]: 	index_param: efSearch=200
2025-03-09 08:10:59,873 [INFO]: 	index_path: knn.index
2025-03-09 08:10:59,873 [INFO]: 	size in bytes: 881806690
2025-03-09 08:10:59,873 [INFO]: 	avg_search_speed_ms: 8.60561824543161
2025-03-09 08:10:59,873 [INFO]: 	99p_search_speed_ms: 18.776579678524303
2025-03-09 08:10:59,873 [INFO]: 	reconstruction error %: 0.0
2025-03-09 08:10:59,873 [INFO]: 	nb vectors: 4482
2025-03-09 08:10:59,873 [INFO]: 	vectors dimension: 49152
2025-03-09 08:10:59,873 [INFO]: 	compression ratio: 0.9993086534646273
2025-03-09 08:10:59,873 [INFO]: }
2025-03-09 08:10:59,873 [INFO]: 	>>> Finished "Creating the index" in 61.7224 secs
2025-03-09 08:10:59,873 [INFO]: >>> Finished "Launching the whole pipeline" in 61.7452 secs
2025-03-09 08:11:00: [retrieval_preprocessing] calculating distances ...
2025-03-09 08:11:01: [retrieval_preprocessing] finished and saved retrieval indices for episode 34572 [episode count 8/20]
[retrieval_preprocessing] for episode 68237 [episode count 9/20], we have num_retrieval=np.int64(4487) num_query=np.int64(218)
2025-03-09 08:11:02,067 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-09 08:11:02,648 [INFO]: Launching the whole pipeline 03/09/2025, 08:11:02
2025-03-09 08:11:02,648 [INFO]: Reading total number of vectors and dimension 03/09/2025, 08:11:02
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1478.95it/s]
2025-03-09 08:11:02,675 [INFO]: There are 4487 embeddings of dim 49152
2025-03-09 08:11:02,675 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0267 secs
2025-03-09 08:11:02,675 [INFO]: 	Compute estimated construction time of the index 03/09/2025, 08:11:02
2025-03-09 08:11:02,675 [INFO]: 		-> Train: 16.7 minutes
2025-03-09 08:11:02,675 [INFO]: 		-> Add: 2.5 seconds
2025-03-09 08:11:02,675 [INFO]: 		Total: 16.7 minutes
2025-03-09 08:11:02,675 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0001 secs
2025-03-09 08:11:02,675 [INFO]: 	Checking that your have enough memory available to create the index 03/09/2025, 08:11:02
2025-03-09 08:11:02,675 [INFO]: 926.0MB of memory will be needed to build the index (more might be used if you have more)
2025-03-09 08:11:02,675 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0001 secs
2025-03-09 08:11:02,675 [INFO]: 	Selecting most promising index types given data characteristics 03/09/2025, 08:11:02
2025-03-09 08:11:02,675 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-09 08:11:02,675 [INFO]: 	Creating the index 03/09/2025, 08:11:02
2025-03-09 08:11:02,676 [INFO]: 		-> Instanciate the index HNSW15 03/09/2025, 08:11:02
2025-03-09 08:11:02,677 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0009 secs
2025-03-09 08:11:02,677 [INFO]: 		-> Adding the vectors to the index 03/09/2025, 08:11:02
2025-03-09 08:11:02,677 [INFO]: The memory available for adding the vectors is 49.2GB(total available - used by the index)
2025-03-09 08:11:02,677 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/18 [00:00<?, ?it/s]  6%|▌         | 1/18 [00:00<00:02,  6.46it/s] 33%|███▎      | 6/18 [00:00<00:00, 27.31it/s] 61%|██████    | 11/18 [00:00<00:00, 35.87it/s] 89%|████████▉ | 16/18 [00:00<00:00, 39.96it/s]100%|██████████| 18/18 [00:04<00:00,  4.17it/s]
2025-03-09 08:11:06,996 [INFO]: 	Computing best hyperparameters for index knn.index 03/09/2025, 08:11:06
2025-03-09 08:11:46,235 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 39.2386 secs
2025-03-09 08:11:46,235 [INFO]: The best hyperparameters are: efSearch=174
2025-03-09 08:11:46,235 [INFO]: 	Compute fast metrics 03/09/2025, 08:11:46
  0%|          | 0/4 [00:00<?, ?it/s] 50%|█████     | 2/4 [00:00<00:00, 19.59it/s] 75%|███████▌  | 3/4 [00:00<00:00, 20.91it/s]
2025-03-09 08:12:01,932 [INFO]: 	>>> Finished "Compute fast metrics" in 15.6965 secs
2025-03-09 08:12:02,155 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 59.4788 secs
2025-03-09 08:12:02,156 [INFO]: {
2025-03-09 08:12:02,156 [INFO]: 	index_key: HNSW15
2025-03-09 08:12:02,156 [INFO]: 	index_param: efSearch=174
2025-03-09 08:12:02,156 [INFO]: 	index_path: knn.index
2025-03-09 08:12:02,156 [INFO]: 	size in bytes: 882790390
2025-03-09 08:12:02,156 [INFO]: 	avg_search_speed_ms: 7.328212205252368
2025-03-09 08:12:02,156 [INFO]: 	99p_search_speed_ms: 15.22503963671624
2025-03-09 08:12:02,156 [INFO]: 	reconstruction error %: 0.0
2025-03-09 08:12:02,156 [INFO]: 	nb vectors: 4487
2025-03-09 08:12:02,156 [INFO]: 	vectors dimension: 49152
2025-03-09 08:12:02,156 [INFO]: 	compression ratio: 0.9993086762079502
2025-03-09 08:12:02,156 [INFO]: }
2025-03-09 08:12:02,156 [INFO]: 	>>> Finished "Creating the index" in 59.4810 secs
2025-03-09 08:12:02,157 [INFO]: >>> Finished "Launching the whole pipeline" in 59.5083 secs
2025-03-09 08:12:02: [retrieval_preprocessing] calculating distances ...
2025-03-09 08:12:03: [retrieval_preprocessing] finished and saved retrieval indices for episode 68237 [episode count 9/20]
[retrieval_preprocessing] for episode 15376 [episode count 10/20], we have num_retrieval=np.int64(4295) num_query=np.int64(410)
2025-03-09 08:12:03,899 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-09 08:12:04,446 [INFO]: Launching the whole pipeline 03/09/2025, 08:12:04
2025-03-09 08:12:04,446 [INFO]: Reading total number of vectors and dimension 03/09/2025, 08:12:04
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1446.31it/s]
2025-03-09 08:12:04,471 [INFO]: There are 4295 embeddings of dim 49152
2025-03-09 08:12:04,471 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0253 secs
2025-03-09 08:12:04,471 [INFO]: 	Compute estimated construction time of the index 03/09/2025, 08:12:04
2025-03-09 08:12:04,471 [INFO]: 		-> Train: 16.7 minutes
2025-03-09 08:12:04,471 [INFO]: 		-> Add: 2.4 seconds
2025-03-09 08:12:04,471 [INFO]: 		Total: 16.7 minutes
2025-03-09 08:12:04,471 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0001 secs
2025-03-09 08:12:04,471 [INFO]: 	Checking that your have enough memory available to create the index 03/09/2025, 08:12:04
2025-03-09 08:12:04,472 [INFO]: 886.4MB of memory will be needed to build the index (more might be used if you have more)
2025-03-09 08:12:04,472 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0002 secs
2025-03-09 08:12:04,472 [INFO]: 	Selecting most promising index types given data characteristics 03/09/2025, 08:12:04
2025-03-09 08:12:04,472 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-09 08:12:04,472 [INFO]: 	Creating the index 03/09/2025, 08:12:04
2025-03-09 08:12:04,472 [INFO]: 		-> Instanciate the index HNSW15 03/09/2025, 08:12:04
2025-03-09 08:12:04,473 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0011 secs
2025-03-09 08:12:04,473 [INFO]: 		-> Adding the vectors to the index 03/09/2025, 08:12:04
2025-03-09 08:12:04,473 [INFO]: The memory available for adding the vectors is 49.2GB(total available - used by the index)
2025-03-09 08:12:04,473 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/17 [00:00<?, ?it/s]  6%|▌         | 1/17 [00:00<00:01,  8.63it/s] 41%|████      | 7/17 [00:00<00:00, 34.66it/s] 76%|███████▋  | 13/17 [00:00<00:00, 43.74it/s]100%|██████████| 17/17 [00:03<00:00,  5.30it/s]
2025-03-09 08:12:07,681 [INFO]: 	Computing best hyperparameters for index knn.index 03/09/2025, 08:12:07
2025-03-09 08:12:45,227 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 37.5447 secs
2025-03-09 08:12:45,227 [INFO]: The best hyperparameters are: efSearch=226
2025-03-09 08:12:45,227 [INFO]: 	Compute fast metrics 03/09/2025, 08:12:45
  0%|          | 0/4 [00:00<?, ?it/s] 50%|█████     | 2/4 [00:00<00:00, 18.82it/s] 75%|███████▌  | 3/4 [00:00<00:00, 20.65it/s]
2025-03-09 08:13:08,308 [INFO]: 	>>> Finished "Compute fast metrics" in 23.0806 secs
2025-03-09 08:13:08,310 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 63.8370 secs
2025-03-09 08:13:08,310 [INFO]: {
2025-03-09 08:13:08,310 [INFO]: 	index_key: HNSW15
2025-03-09 08:13:08,310 [INFO]: 	index_param: efSearch=226
2025-03-09 08:13:08,310 [INFO]: 	index_path: knn.index
2025-03-09 08:13:08,310 [INFO]: 	size in bytes: 845015590
2025-03-09 08:13:08,310 [INFO]: 	avg_search_speed_ms: 8.788685189758105
2025-03-09 08:13:08,310 [INFO]: 	99p_search_speed_ms: 16.049643745645877
2025-03-09 08:13:08,310 [INFO]: 	reconstruction error %: 0.0
2025-03-09 08:13:08,310 [INFO]: 	nb vectors: 4295
2025-03-09 08:13:08,310 [INFO]: 	vectors dimension: 49152
2025-03-09 08:13:08,310 [INFO]: 	compression ratio: 0.9993086163061204
2025-03-09 08:13:08,310 [INFO]: }
2025-03-09 08:13:08,310 [INFO]: 	>>> Finished "Creating the index" in 63.8386 secs
2025-03-09 08:13:08,310 [INFO]: >>> Finished "Launching the whole pipeline" in 63.8644 secs
2025-03-09 08:13:10: [retrieval_preprocessing] calculating distances ...
2025-03-09 08:13:11: [retrieval_preprocessing] finished and saved retrieval indices for episode 15376 [episode count 10/20]
[retrieval_preprocessing] for episode 19602 [episode count 11/20], we have num_retrieval=np.int64(4534) num_query=np.int64(171)
2025-03-09 08:13:11,888 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-09 08:13:12,446 [INFO]: Launching the whole pipeline 03/09/2025, 08:13:12
2025-03-09 08:13:12,446 [INFO]: Reading total number of vectors and dimension 03/09/2025, 08:13:12
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 2129.09it/s]
2025-03-09 08:13:12,469 [INFO]: There are 4534 embeddings of dim 49152
2025-03-09 08:13:12,470 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0233 secs
2025-03-09 08:13:12,470 [INFO]: 	Compute estimated construction time of the index 03/09/2025, 08:13:12
2025-03-09 08:13:12,470 [INFO]: 		-> Train: 16.7 minutes
2025-03-09 08:13:12,470 [INFO]: 		-> Add: 2.5 seconds
2025-03-09 08:13:12,470 [INFO]: 		Total: 16.7 minutes
2025-03-09 08:13:12,470 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0001 secs
2025-03-09 08:13:12,470 [INFO]: 	Checking that your have enough memory available to create the index 03/09/2025, 08:13:12
2025-03-09 08:13:12,470 [INFO]: 935.7MB of memory will be needed to build the index (more might be used if you have more)
2025-03-09 08:13:12,470 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0001 secs
2025-03-09 08:13:12,470 [INFO]: 	Selecting most promising index types given data characteristics 03/09/2025, 08:13:12
2025-03-09 08:13:12,470 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-09 08:13:12,470 [INFO]: 	Creating the index 03/09/2025, 08:13:12
2025-03-09 08:13:12,470 [INFO]: 		-> Instanciate the index HNSW15 03/09/2025, 08:13:12
2025-03-09 08:13:12,471 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0010 secs
2025-03-09 08:13:12,471 [INFO]: 		-> Adding the vectors to the index 03/09/2025, 08:13:12
2025-03-09 08:13:12,471 [INFO]: The memory available for adding the vectors is 49.2GB(total available - used by the index)
2025-03-09 08:13:12,471 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/18 [00:00<?, ?it/s]  6%|▌         | 1/18 [00:00<00:01,  9.54it/s] 28%|██▊       | 5/18 [00:00<00:00, 25.31it/s] 61%|██████    | 11/18 [00:00<00:00, 38.12it/s] 94%|█████████▍| 17/18 [00:00<00:00, 43.99it/s]100%|██████████| 18/18 [00:03<00:00,  4.72it/s]
2025-03-09 08:13:16,286 [INFO]: 	Computing best hyperparameters for index knn.index 03/09/2025, 08:13:16
2025-03-09 08:14:01,106 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 44.8195 secs
2025-03-09 08:14:01,106 [INFO]: The best hyperparameters are: efSearch=246
2025-03-09 08:14:01,106 [INFO]: 	Compute fast metrics 03/09/2025, 08:14:01
  0%|          | 0/4 [00:00<?, ?it/s] 75%|███████▌  | 3/4 [00:00<00:00, 28.57it/s] 75%|███████▌  | 3/4 [00:00<00:00, 24.19it/s]
2025-03-09 08:14:21,920 [INFO]: 	>>> Finished "Compute fast metrics" in 20.8138 secs
2025-03-09 08:14:22,224 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 69.7523 secs
2025-03-09 08:14:22,224 [INFO]: {
2025-03-09 08:14:22,224 [INFO]: 	index_key: HNSW15
2025-03-09 08:14:22,224 [INFO]: 	index_param: efSearch=246
2025-03-09 08:14:22,224 [INFO]: 	index_path: knn.index
2025-03-09 08:14:22,224 [INFO]: 	size in bytes: 892037230
2025-03-09 08:14:22,224 [INFO]: 	avg_search_speed_ms: 9.525829936333356
2025-03-09 08:14:22,224 [INFO]: 	99p_search_speed_ms: 22.646377240307626
2025-03-09 08:14:22,224 [INFO]: 	reconstruction error %: 0.0
2025-03-09 08:14:22,225 [INFO]: 	nb vectors: 4534
2025-03-09 08:14:22,225 [INFO]: 	vectors dimension: 49152
2025-03-09 08:14:22,225 [INFO]: 	compression ratio: 0.9993088203280485
2025-03-09 08:14:22,225 [INFO]: }
2025-03-09 08:14:22,225 [INFO]: 	>>> Finished "Creating the index" in 69.7547 secs
2025-03-09 08:14:22,225 [INFO]: >>> Finished "Launching the whole pipeline" in 69.7786 secs
2025-03-09 08:14:23: [retrieval_preprocessing] calculating distances ...
2025-03-09 08:14:23: [retrieval_preprocessing] finished and saved retrieval indices for episode 19602 [episode count 11/20]
[retrieval_preprocessing] for episode 55956 [episode count 12/20], we have num_retrieval=np.int64(4506) num_query=np.int64(199)
2025-03-09 08:14:24,362 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-09 08:14:25,060 [INFO]: Launching the whole pipeline 03/09/2025, 08:14:25
2025-03-09 08:14:25,060 [INFO]: Reading total number of vectors and dimension 03/09/2025, 08:14:25
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1197.00it/s]
2025-03-09 08:14:25,085 [INFO]: There are 4506 embeddings of dim 49152
2025-03-09 08:14:25,085 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0256 secs
2025-03-09 08:14:25,085 [INFO]: 	Compute estimated construction time of the index 03/09/2025, 08:14:25
2025-03-09 08:14:25,085 [INFO]: 		-> Train: 16.7 minutes
2025-03-09 08:14:25,085 [INFO]: 		-> Add: 2.5 seconds
2025-03-09 08:14:25,085 [INFO]: 		Total: 16.7 minutes
2025-03-09 08:14:25,085 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0001 secs
2025-03-09 08:14:25,086 [INFO]: 	Checking that your have enough memory available to create the index 03/09/2025, 08:14:25
2025-03-09 08:14:25,086 [INFO]: 929.9MB of memory will be needed to build the index (more might be used if you have more)
2025-03-09 08:14:25,086 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0001 secs
2025-03-09 08:14:25,086 [INFO]: 	Selecting most promising index types given data characteristics 03/09/2025, 08:14:25
2025-03-09 08:14:25,086 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-09 08:14:25,086 [INFO]: 	Creating the index 03/09/2025, 08:14:25
2025-03-09 08:14:25,086 [INFO]: 		-> Instanciate the index HNSW15 03/09/2025, 08:14:25
2025-03-09 08:14:25,087 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0011 secs
2025-03-09 08:14:25,087 [INFO]: 		-> Adding the vectors to the index 03/09/2025, 08:14:25
2025-03-09 08:14:25,087 [INFO]: The memory available for adding the vectors is 49.2GB(total available - used by the index)
2025-03-09 08:14:25,087 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/18 [00:00<?, ?it/s]  6%|▌         | 1/18 [00:00<00:02,  7.68it/s] 28%|██▊       | 5/18 [00:00<00:00, 22.83it/s] 61%|██████    | 11/18 [00:00<00:00, 35.84it/s] 94%|█████████▍| 17/18 [00:00<00:00, 41.87it/s]100%|██████████| 18/18 [00:03<00:00,  4.96it/s]
2025-03-09 08:14:28,718 [INFO]: 	Computing best hyperparameters for index knn.index 03/09/2025, 08:14:28
2025-03-09 08:15:10,483 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 41.7647 secs
2025-03-09 08:15:10,483 [INFO]: The best hyperparameters are: efSearch=327
2025-03-09 08:15:10,483 [INFO]: 	Compute fast metrics 03/09/2025, 08:15:10
  0%|          | 0/4 [00:00<?, ?it/s] 75%|███████▌  | 3/4 [00:00<00:00, 27.90it/s] 75%|███████▌  | 3/4 [00:00<00:00, 23.75it/s]
2025-03-09 08:15:29,285 [INFO]: 	>>> Finished "Compute fast metrics" in 18.8014 secs
2025-03-09 08:15:29,287 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 64.2000 secs
2025-03-09 08:15:29,287 [INFO]: {
2025-03-09 08:15:29,287 [INFO]: 	index_key: HNSW15
2025-03-09 08:15:29,287 [INFO]: 	index_param: efSearch=327
2025-03-09 08:15:29,287 [INFO]: 	index_path: knn.index
2025-03-09 08:15:29,287 [INFO]: 	size in bytes: 886528510
2025-03-09 08:15:29,287 [INFO]: 	avg_search_speed_ms: 11.013789258595754
2025-03-09 08:15:29,287 [INFO]: 	99p_search_speed_ms: 17.53281809156756
2025-03-09 08:15:29,287 [INFO]: 	reconstruction error %: 0.0
2025-03-09 08:15:29,287 [INFO]: 	nb vectors: 4506
2025-03-09 08:15:29,287 [INFO]: 	vectors dimension: 49152
2025-03-09 08:15:29,287 [INFO]: 	compression ratio: 0.999308694539333
2025-03-09 08:15:29,287 [INFO]: }
2025-03-09 08:15:29,287 [INFO]: 	>>> Finished "Creating the index" in 64.2016 secs
2025-03-09 08:15:29,287 [INFO]: >>> Finished "Launching the whole pipeline" in 64.2278 secs
2025-03-09 08:15:30: [retrieval_preprocessing] calculating distances ...
2025-03-09 08:15:31: [retrieval_preprocessing] finished and saved retrieval indices for episode 55956 [episode count 12/20]
[retrieval_preprocessing] for episode 32664 [episode count 13/20], we have num_retrieval=np.int64(4410) num_query=np.int64(295)
2025-03-09 08:15:31,836 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-09 08:15:32,348 [INFO]: Launching the whole pipeline 03/09/2025, 08:15:32
2025-03-09 08:15:32,349 [INFO]: Reading total number of vectors and dimension 03/09/2025, 08:15:32
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1540.89it/s]
2025-03-09 08:15:32,373 [INFO]: There are 4410 embeddings of dim 49152
2025-03-09 08:15:32,374 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0254 secs
2025-03-09 08:15:32,374 [INFO]: 	Compute estimated construction time of the index 03/09/2025, 08:15:32
2025-03-09 08:15:32,374 [INFO]: 		-> Train: 16.7 minutes
2025-03-09 08:15:32,374 [INFO]: 		-> Add: 2.4 seconds
2025-03-09 08:15:32,375 [INFO]: 		Total: 16.7 minutes
2025-03-09 08:15:32,375 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0004 secs
2025-03-09 08:15:32,375 [INFO]: 	Checking that your have enough memory available to create the index 03/09/2025, 08:15:32
2025-03-09 08:15:32,375 [INFO]: 910.1MB of memory will be needed to build the index (more might be used if you have more)
2025-03-09 08:15:32,375 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0004 secs
2025-03-09 08:15:32,375 [INFO]: 	Selecting most promising index types given data characteristics 03/09/2025, 08:15:32
2025-03-09 08:15:32,375 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-09 08:15:32,375 [INFO]: 	Creating the index 03/09/2025, 08:15:32
2025-03-09 08:15:32,376 [INFO]: 		-> Instanciate the index HNSW15 03/09/2025, 08:15:32
2025-03-09 08:15:32,378 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0026 secs
2025-03-09 08:15:32,378 [INFO]: 		-> Adding the vectors to the index 03/09/2025, 08:15:32
2025-03-09 08:15:32,379 [INFO]: The memory available for adding the vectors is 49.2GB(total available - used by the index)
2025-03-09 08:15:32,379 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/18 [00:00<?, ?it/s] 17%|█▋        | 3/18 [00:00<00:00, 27.28it/s] 50%|█████     | 9/18 [00:00<00:00, 44.91it/s] 83%|████████▎ | 15/18 [00:00<00:00, 51.22it/s]100%|██████████| 18/18 [00:03<00:00,  5.84it/s]
2025-03-09 08:15:35,466 [INFO]: 	Computing best hyperparameters for index knn.index 03/09/2025, 08:15:35
2025-03-09 08:16:13,678 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 38.2115 secs
2025-03-09 08:16:13,679 [INFO]: The best hyperparameters are: efSearch=260
2025-03-09 08:16:13,679 [INFO]: 	Compute fast metrics 03/09/2025, 08:16:13
  0%|          | 0/4 [00:00<?, ?it/s] 50%|█████     | 2/4 [00:00<00:00, 16.78it/s] 75%|███████▌  | 3/4 [00:00<00:00, 17.98it/s]
2025-03-09 08:16:33,921 [INFO]: 	>>> Finished "Compute fast metrics" in 20.2418 secs
2025-03-09 08:16:33,923 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 61.5446 secs
2025-03-09 08:16:33,923 [INFO]: {
2025-03-09 08:16:33,923 [INFO]: 	index_key: HNSW15
2025-03-09 08:16:33,923 [INFO]: 	index_param: efSearch=260
2025-03-09 08:16:33,923 [INFO]: 	index_path: knn.index
2025-03-09 08:16:33,923 [INFO]: 	size in bytes: 867641110
2025-03-09 08:16:33,923 [INFO]: 	avg_search_speed_ms: 11.406538368201684
2025-03-09 08:16:33,923 [INFO]: 	99p_search_speed_ms: 24.881813423708085
2025-03-09 08:16:33,923 [INFO]: 	reconstruction error %: 0.0
2025-03-09 08:16:33,923 [INFO]: 	nb vectors: 4410
2025-03-09 08:16:33,923 [INFO]: 	vectors dimension: 49152
2025-03-09 08:16:33,923 [INFO]: 	compression ratio: 0.9993086657684996
2025-03-09 08:16:33,923 [INFO]: }
2025-03-09 08:16:33,923 [INFO]: 	>>> Finished "Creating the index" in 61.5479 secs
2025-03-09 08:16:33,923 [INFO]: >>> Finished "Launching the whole pipeline" in 61.5749 secs
2025-03-09 08:16:36: [retrieval_preprocessing] calculating distances ...
2025-03-09 08:16:37: [retrieval_preprocessing] finished and saved retrieval indices for episode 32664 [episode count 13/20]
[retrieval_preprocessing] for episode 41241 [episode count 14/20], we have num_retrieval=np.int64(4506) num_query=np.int64(199)
2025-03-09 08:16:37,850 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-09 08:16:39,205 [INFO]: Launching the whole pipeline 03/09/2025, 08:16:39
2025-03-09 08:16:39,205 [INFO]: Reading total number of vectors and dimension 03/09/2025, 08:16:39
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1146.61it/s]
2025-03-09 08:16:39,232 [INFO]: There are 4506 embeddings of dim 49152
2025-03-09 08:16:39,232 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0269 secs
2025-03-09 08:16:39,232 [INFO]: 	Compute estimated construction time of the index 03/09/2025, 08:16:39
2025-03-09 08:16:39,232 [INFO]: 		-> Train: 16.7 minutes
2025-03-09 08:16:39,232 [INFO]: 		-> Add: 2.5 seconds
2025-03-09 08:16:39,232 [INFO]: 		Total: 16.7 minutes
2025-03-09 08:16:39,232 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0001 secs
2025-03-09 08:16:39,232 [INFO]: 	Checking that your have enough memory available to create the index 03/09/2025, 08:16:39
2025-03-09 08:16:39,232 [INFO]: 929.9MB of memory will be needed to build the index (more might be used if you have more)
2025-03-09 08:16:39,233 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0002 secs
2025-03-09 08:16:39,233 [INFO]: 	Selecting most promising index types given data characteristics 03/09/2025, 08:16:39
2025-03-09 08:16:39,233 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-09 08:16:39,233 [INFO]: 	Creating the index 03/09/2025, 08:16:39
2025-03-09 08:16:39,233 [INFO]: 		-> Instanciate the index HNSW15 03/09/2025, 08:16:39
2025-03-09 08:16:39,234 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0012 secs
2025-03-09 08:16:39,234 [INFO]: 		-> Adding the vectors to the index 03/09/2025, 08:16:39
2025-03-09 08:16:39,234 [INFO]: The memory available for adding the vectors is 49.2GB(total available - used by the index)
2025-03-09 08:16:39,234 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/18 [00:00<?, ?it/s]  6%|▌         | 1/18 [00:00<00:02,  8.34it/s] 39%|███▉      | 7/18 [00:00<00:00, 34.87it/s] 72%|███████▏  | 13/18 [00:00<00:00, 43.74it/s]100%|██████████| 18/18 [00:03<00:00,  3.47it/s]100%|██████████| 18/18 [00:03<00:00,  4.78it/s]
2025-03-09 08:16:43,000 [INFO]: 	Computing best hyperparameters for index knn.index 03/09/2025, 08:16:43
2025-03-09 08:17:28,228 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 45.2275 secs
2025-03-09 08:17:28,228 [INFO]: The best hyperparameters are: efSearch=241
2025-03-09 08:17:28,228 [INFO]: 	Compute fast metrics 03/09/2025, 08:17:28
  0%|          | 0/4 [00:00<?, ?it/s] 50%|█████     | 2/4 [00:00<00:00, 18.19it/s] 75%|███████▌  | 3/4 [00:00<00:00, 19.50it/s]
2025-03-09 08:17:47,048 [INFO]: 	>>> Finished "Compute fast metrics" in 18.8202 secs
2025-03-09 08:17:47,052 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 67.8182 secs
2025-03-09 08:17:47,052 [INFO]: {
2025-03-09 08:17:47,052 [INFO]: 	index_key: HNSW15
2025-03-09 08:17:47,052 [INFO]: 	index_param: efSearch=241
2025-03-09 08:17:47,052 [INFO]: 	index_path: knn.index
2025-03-09 08:17:47,052 [INFO]: 	size in bytes: 886528510
2025-03-09 08:17:47,053 [INFO]: 	avg_search_speed_ms: 9.765562781922199
2025-03-09 08:17:47,053 [INFO]: 	99p_search_speed_ms: 18.46331087639554
2025-03-09 08:17:47,053 [INFO]: 	reconstruction error %: 0.0
2025-03-09 08:17:47,053 [INFO]: 	nb vectors: 4506
2025-03-09 08:17:47,053 [INFO]: 	vectors dimension: 49152
2025-03-09 08:17:47,053 [INFO]: 	compression ratio: 0.999308694539333
2025-03-09 08:17:47,053 [INFO]: }
2025-03-09 08:17:47,053 [INFO]: 	>>> Finished "Creating the index" in 67.8199 secs
2025-03-09 08:17:47,053 [INFO]: >>> Finished "Launching the whole pipeline" in 67.8475 secs
2025-03-09 08:17:48: [retrieval_preprocessing] calculating distances ...
2025-03-09 08:17:49: [retrieval_preprocessing] finished and saved retrieval indices for episode 41241 [episode count 14/20]
[retrieval_preprocessing] for episode 47643 [episode count 15/20], we have num_retrieval=np.int64(4453) num_query=np.int64(252)
2025-03-09 08:17:49,690 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-09 08:17:50,321 [INFO]: Launching the whole pipeline 03/09/2025, 08:17:50
2025-03-09 08:17:50,321 [INFO]: Reading total number of vectors and dimension 03/09/2025, 08:17:50
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1401.37it/s]
2025-03-09 08:17:50,346 [INFO]: There are 4453 embeddings of dim 49152
2025-03-09 08:17:50,346 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0249 secs
2025-03-09 08:17:50,346 [INFO]: 	Compute estimated construction time of the index 03/09/2025, 08:17:50
2025-03-09 08:17:50,346 [INFO]: 		-> Train: 16.7 minutes
2025-03-09 08:17:50,346 [INFO]: 		-> Add: 2.4 seconds
2025-03-09 08:17:50,346 [INFO]: 		Total: 16.7 minutes
2025-03-09 08:17:50,346 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0001 secs
2025-03-09 08:17:50,346 [INFO]: 	Checking that your have enough memory available to create the index 03/09/2025, 08:17:50
2025-03-09 08:17:50,346 [INFO]: 919.0MB of memory will be needed to build the index (more might be used if you have more)
2025-03-09 08:17:50,346 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0001 secs
2025-03-09 08:17:50,346 [INFO]: 	Selecting most promising index types given data characteristics 03/09/2025, 08:17:50
2025-03-09 08:17:50,346 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-09 08:17:50,347 [INFO]: 	Creating the index 03/09/2025, 08:17:50
2025-03-09 08:17:50,347 [INFO]: 		-> Instanciate the index HNSW15 03/09/2025, 08:17:50
2025-03-09 08:17:50,347 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0008 secs
2025-03-09 08:17:50,348 [INFO]: 		-> Adding the vectors to the index 03/09/2025, 08:17:50
2025-03-09 08:17:50,348 [INFO]: The memory available for adding the vectors is 49.2GB(total available - used by the index)
2025-03-09 08:17:50,348 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/18 [00:00<?, ?it/s]  6%|▌         | 1/18 [00:00<00:02,  7.45it/s] 33%|███▎      | 6/18 [00:00<00:00, 28.88it/s] 61%|██████    | 11/18 [00:00<00:00, 34.10it/s] 94%|█████████▍| 17/18 [00:00<00:00, 40.85it/s]100%|██████████| 18/18 [00:03<00:00,  5.35it/s]
2025-03-09 08:17:53,716 [INFO]: 	Computing best hyperparameters for index knn.index 03/09/2025, 08:17:53
2025-03-09 08:18:33,311 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 39.5948 secs
2025-03-09 08:18:33,312 [INFO]: The best hyperparameters are: efSearch=282
2025-03-09 08:18:33,312 [INFO]: 	Compute fast metrics 03/09/2025, 08:18:33
  0%|          | 0/4 [00:00<?, ?it/s] 75%|███████▌  | 3/4 [00:00<00:00, 25.66it/s] 75%|███████▌  | 3/4 [00:00<00:00, 21.02it/s]
2025-03-09 08:18:49,953 [INFO]: 	>>> Finished "Compute fast metrics" in 16.6410 secs
2025-03-09 08:18:49,959 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 59.6112 secs
2025-03-09 08:18:49,960 [INFO]: {
2025-03-09 08:18:49,960 [INFO]: 	index_key: HNSW15
2025-03-09 08:18:49,960 [INFO]: 	index_param: efSearch=282
2025-03-09 08:18:49,960 [INFO]: 	index_path: knn.index
2025-03-09 08:18:49,960 [INFO]: 	size in bytes: 876101170
2025-03-09 08:18:49,960 [INFO]: 	avg_search_speed_ms: 11.838454147249724
2025-03-09 08:18:49,960 [INFO]: 	99p_search_speed_ms: 26.505731195211382
2025-03-09 08:18:49,960 [INFO]: 	reconstruction error %: 0.0
2025-03-09 08:18:49,960 [INFO]: 	nb vectors: 4453
2025-03-09 08:18:49,960 [INFO]: 	vectors dimension: 49152
2025-03-09 08:18:49,960 [INFO]: 	compression ratio: 0.9993085889840781
2025-03-09 08:18:49,960 [INFO]: }
2025-03-09 08:18:49,960 [INFO]: 	>>> Finished "Creating the index" in 59.6133 secs
2025-03-09 08:18:49,960 [INFO]: >>> Finished "Launching the whole pipeline" in 59.6387 secs
2025-03-09 08:18:51: [retrieval_preprocessing] calculating distances ...
2025-03-09 08:18:52: [retrieval_preprocessing] finished and saved retrieval indices for episode 47643 [episode count 15/20]
[retrieval_preprocessing] for episode 76827 [episode count 16/20], we have num_retrieval=np.int64(4503) num_query=np.int64(202)
2025-03-09 08:18:53,283 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-09 08:18:54,060 [INFO]: Launching the whole pipeline 03/09/2025, 08:18:54
2025-03-09 08:18:54,060 [INFO]: Reading total number of vectors and dimension 03/09/2025, 08:18:54
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1160.89it/s]
2025-03-09 08:18:54,088 [INFO]: There are 4503 embeddings of dim 49152
2025-03-09 08:18:54,088 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0278 secs
2025-03-09 08:18:54,088 [INFO]: 	Compute estimated construction time of the index 03/09/2025, 08:18:54
2025-03-09 08:18:54,088 [INFO]: 		-> Train: 16.7 minutes
2025-03-09 08:18:54,088 [INFO]: 		-> Add: 2.5 seconds
2025-03-09 08:18:54,088 [INFO]: 		Total: 16.7 minutes
2025-03-09 08:18:54,088 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0001 secs
2025-03-09 08:18:54,088 [INFO]: 	Checking that your have enough memory available to create the index 03/09/2025, 08:18:54
2025-03-09 08:18:54,088 [INFO]: 929.3MB of memory will be needed to build the index (more might be used if you have more)
2025-03-09 08:18:54,089 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0002 secs
2025-03-09 08:18:54,089 [INFO]: 	Selecting most promising index types given data characteristics 03/09/2025, 08:18:54
2025-03-09 08:18:54,089 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-09 08:18:54,089 [INFO]: 	Creating the index 03/09/2025, 08:18:54
2025-03-09 08:18:54,089 [INFO]: 		-> Instanciate the index HNSW15 03/09/2025, 08:18:54
2025-03-09 08:18:54,090 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0011 secs
2025-03-09 08:18:54,090 [INFO]: 		-> Adding the vectors to the index 03/09/2025, 08:18:54
2025-03-09 08:18:54,090 [INFO]: The memory available for adding the vectors is 49.2GB(total available - used by the index)
2025-03-09 08:18:54,090 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/18 [00:00<?, ?it/s] 11%|█         | 2/18 [00:00<00:00, 16.41it/s] 39%|███▉      | 7/18 [00:00<00:00, 31.63it/s] 67%|██████▋   | 12/18 [00:00<00:00, 36.69it/s] 89%|████████▉ | 16/18 [00:00<00:00, 33.24it/s]100%|██████████| 18/18 [00:04<00:00,  4.46it/s]
2025-03-09 08:18:58,133 [INFO]: 	Computing best hyperparameters for index knn.index 03/09/2025, 08:18:58
2025-03-09 08:19:40,700 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 42.5674 secs
2025-03-09 08:19:40,701 [INFO]: The best hyperparameters are: efSearch=247
2025-03-09 08:19:40,701 [INFO]: 	Compute fast metrics 03/09/2025, 08:19:40
  0%|          | 0/4 [00:00<?, ?it/s] 25%|██▌       | 1/4 [00:00<00:00,  8.89it/s] 75%|███████▌  | 3/4 [00:00<00:00, 12.55it/s]
2025-03-09 08:19:59,860 [INFO]: 	>>> Finished "Compute fast metrics" in 19.1592 secs
2025-03-09 08:19:59,863 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 65.7730 secs
2025-03-09 08:19:59,863 [INFO]: {
2025-03-09 08:19:59,863 [INFO]: 	index_key: HNSW15
2025-03-09 08:19:59,863 [INFO]: 	index_param: efSearch=247
2025-03-09 08:19:59,863 [INFO]: 	index_path: knn.index
2025-03-09 08:19:59,863 [INFO]: 	size in bytes: 885938290
2025-03-09 08:19:59,863 [INFO]: 	avg_search_speed_ms: 10.118394873987345
2025-03-09 08:19:59,863 [INFO]: 	99p_search_speed_ms: 20.539202829822898
2025-03-09 08:19:59,863 [INFO]: 	reconstruction error %: 0.0
2025-03-09 08:19:59,863 [INFO]: 	nb vectors: 4503
2025-03-09 08:19:59,863 [INFO]: 	vectors dimension: 49152
2025-03-09 08:19:59,863 [INFO]: 	compression ratio: 0.9993086809691903
2025-03-09 08:19:59,863 [INFO]: }
2025-03-09 08:19:59,863 [INFO]: 	>>> Finished "Creating the index" in 65.7747 secs
2025-03-09 08:19:59,863 [INFO]: >>> Finished "Launching the whole pipeline" in 65.8032 secs
2025-03-09 08:20:01: [retrieval_preprocessing] calculating distances ...
2025-03-09 08:20:01: [retrieval_preprocessing] finished and saved retrieval indices for episode 76827 [episode count 16/20]
[retrieval_preprocessing] for episode 41501 [episode count 17/20], we have num_retrieval=np.int64(4500) num_query=np.int64(205)
2025-03-09 08:20:02,318 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-09 08:20:02,936 [INFO]: Launching the whole pipeline 03/09/2025, 08:20:02
2025-03-09 08:20:02,936 [INFO]: Reading total number of vectors and dimension 03/09/2025, 08:20:02
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1379.25it/s]
2025-03-09 08:20:02,966 [INFO]: There are 4500 embeddings of dim 49152
2025-03-09 08:20:02,966 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0293 secs
2025-03-09 08:20:02,966 [INFO]: 	Compute estimated construction time of the index 03/09/2025, 08:20:02
2025-03-09 08:20:02,966 [INFO]: 		-> Train: 16.7 minutes
2025-03-09 08:20:02,966 [INFO]: 		-> Add: 2.5 seconds
2025-03-09 08:20:02,966 [INFO]: 		Total: 16.7 minutes
2025-03-09 08:20:02,966 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0001 secs
2025-03-09 08:20:02,966 [INFO]: 	Checking that your have enough memory available to create the index 03/09/2025, 08:20:02
2025-03-09 08:20:02,966 [INFO]: 928.7MB of memory will be needed to build the index (more might be used if you have more)
2025-03-09 08:20:02,966 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0002 secs
2025-03-09 08:20:02,966 [INFO]: 	Selecting most promising index types given data characteristics 03/09/2025, 08:20:02
2025-03-09 08:20:02,966 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-09 08:20:02,966 [INFO]: 	Creating the index 03/09/2025, 08:20:02
2025-03-09 08:20:02,966 [INFO]: 		-> Instanciate the index HNSW15 03/09/2025, 08:20:02
2025-03-09 08:20:02,967 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0011 secs
2025-03-09 08:20:02,968 [INFO]: 		-> Adding the vectors to the index 03/09/2025, 08:20:02
2025-03-09 08:20:02,968 [INFO]: The memory available for adding the vectors is 49.2GB(total available - used by the index)
2025-03-09 08:20:02,968 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/18 [00:00<?, ?it/s]  6%|▌         | 1/18 [00:00<00:02,  7.31it/s] 28%|██▊       | 5/18 [00:00<00:00, 23.11it/s] 56%|█████▌    | 10/18 [00:00<00:00, 31.68it/s] 83%|████████▎ | 15/18 [00:00<00:00, 35.96it/s]100%|██████████| 18/18 [00:03<00:00,  4.70it/s]
2025-03-09 08:20:06,798 [INFO]: 	Computing best hyperparameters for index knn.index 03/09/2025, 08:20:06
2025-03-09 08:20:46,696 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 39.8975 secs
2025-03-09 08:20:46,696 [INFO]: The best hyperparameters are: efSearch=263
2025-03-09 08:20:46,696 [INFO]: 	Compute fast metrics 03/09/2025, 08:20:46
  0%|          | 0/4 [00:00<?, ?it/s] 50%|█████     | 2/4 [00:00<00:00, 19.27it/s] 75%|███████▌  | 3/4 [00:00<00:00, 21.40it/s]
2025-03-09 08:21:02,500 [INFO]: 	>>> Finished "Compute fast metrics" in 15.8036 secs
2025-03-09 08:21:02,502 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 59.5345 secs
2025-03-09 08:21:02,502 [INFO]: {
2025-03-09 08:21:02,502 [INFO]: 	index_key: HNSW15
2025-03-09 08:21:02,502 [INFO]: 	index_param: efSearch=263
2025-03-09 08:21:02,502 [INFO]: 	index_path: knn.index
2025-03-09 08:21:02,502 [INFO]: 	size in bytes: 885348070
2025-03-09 08:21:02,502 [INFO]: 	avg_search_speed_ms: 9.865882538747652
2025-03-09 08:21:02,502 [INFO]: 	99p_search_speed_ms: 17.97623206861318
2025-03-09 08:21:02,502 [INFO]: 	reconstruction error %: 0.0
2025-03-09 08:21:02,503 [INFO]: 	nb vectors: 4500
2025-03-09 08:21:02,503 [INFO]: 	vectors dimension: 49152
2025-03-09 08:21:02,503 [INFO]: 	compression ratio: 0.9993086673809545
2025-03-09 08:21:02,503 [INFO]: }
2025-03-09 08:21:02,503 [INFO]: 	>>> Finished "Creating the index" in 59.5362 secs
2025-03-09 08:21:02,503 [INFO]: >>> Finished "Launching the whole pipeline" in 59.5661 secs
2025-03-09 08:21:03: [retrieval_preprocessing] calculating distances ...
2025-03-09 08:21:04: [retrieval_preprocessing] finished and saved retrieval indices for episode 41501 [episode count 17/20]
[retrieval_preprocessing] for episode 76955 [episode count 18/20], we have num_retrieval=np.int64(4511) num_query=np.int64(194)
2025-03-09 08:21:04,527 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-09 08:21:05,638 [INFO]: Launching the whole pipeline 03/09/2025, 08:21:05
2025-03-09 08:21:05,638 [INFO]: Reading total number of vectors and dimension 03/09/2025, 08:21:05
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1818.08it/s]
2025-03-09 08:21:05,665 [INFO]: There are 4511 embeddings of dim 49152
2025-03-09 08:21:05,665 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0265 secs
2025-03-09 08:21:05,665 [INFO]: 	Compute estimated construction time of the index 03/09/2025, 08:21:05
2025-03-09 08:21:05,665 [INFO]: 		-> Train: 16.7 minutes
2025-03-09 08:21:05,665 [INFO]: 		-> Add: 2.5 seconds
2025-03-09 08:21:05,665 [INFO]: 		Total: 16.7 minutes
2025-03-09 08:21:05,666 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0003 secs
2025-03-09 08:21:05,666 [INFO]: 	Checking that your have enough memory available to create the index 03/09/2025, 08:21:05
2025-03-09 08:21:05,666 [INFO]: 931.0MB of memory will be needed to build the index (more might be used if you have more)
2025-03-09 08:21:05,666 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0004 secs
2025-03-09 08:21:05,666 [INFO]: 	Selecting most promising index types given data characteristics 03/09/2025, 08:21:05
2025-03-09 08:21:05,666 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-09 08:21:05,667 [INFO]: 	Creating the index 03/09/2025, 08:21:05
2025-03-09 08:21:05,667 [INFO]: 		-> Instanciate the index HNSW15 03/09/2025, 08:21:05
2025-03-09 08:21:05,670 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0029 secs
2025-03-09 08:21:05,670 [INFO]: 		-> Adding the vectors to the index 03/09/2025, 08:21:05
2025-03-09 08:21:05,670 [INFO]: The memory available for adding the vectors is 49.2GB(total available - used by the index)
2025-03-09 08:21:05,671 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/18 [00:00<?, ?it/s] 17%|█▋        | 3/18 [00:00<00:00, 25.71it/s] 50%|█████     | 9/18 [00:00<00:00, 42.92it/s] 83%|████████▎ | 15/18 [00:00<00:00, 48.91it/s]100%|██████████| 18/18 [00:03<00:00,  4.82it/s]
2025-03-09 08:21:09,412 [INFO]: 	Computing best hyperparameters for index knn.index 03/09/2025, 08:21:09
2025-03-09 08:21:51,547 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 42.1350 secs
2025-03-09 08:21:51,548 [INFO]: The best hyperparameters are: efSearch=268
2025-03-09 08:21:51,548 [INFO]: 	Compute fast metrics 03/09/2025, 08:21:51
  0%|          | 0/4 [00:00<?, ?it/s] 50%|█████     | 2/4 [00:00<00:00, 19.14it/s] 75%|███████▌  | 3/4 [00:00<00:00, 21.05it/s]
2025-03-09 08:22:06,248 [INFO]: 	>>> Finished "Compute fast metrics" in 14.7004 secs
2025-03-09 08:22:06,251 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 60.5804 secs
2025-03-09 08:22:06,251 [INFO]: {
2025-03-09 08:22:06,251 [INFO]: 	index_key: HNSW15
2025-03-09 08:22:06,251 [INFO]: 	index_param: efSearch=268
2025-03-09 08:22:06,251 [INFO]: 	index_path: knn.index
2025-03-09 08:22:06,251 [INFO]: 	size in bytes: 887512210
2025-03-09 08:22:06,251 [INFO]: 	avg_search_speed_ms: 10.71529046979352
2025-03-09 08:22:06,251 [INFO]: 	99p_search_speed_ms: 21.53820354491472
2025-03-09 08:22:06,251 [INFO]: 	reconstruction error %: 0.0
2025-03-09 08:22:06,251 [INFO]: 	nb vectors: 4511
2025-03-09 08:22:06,251 [INFO]: 	vectors dimension: 49152
2025-03-09 08:22:06,251 [INFO]: 	compression ratio: 0.9993087171161285
2025-03-09 08:22:06,251 [INFO]: }
2025-03-09 08:22:06,251 [INFO]: 	>>> Finished "Creating the index" in 60.5844 secs
2025-03-09 08:22:06,251 [INFO]: >>> Finished "Launching the whole pipeline" in 60.6127 secs
2025-03-09 08:22:07: [retrieval_preprocessing] calculating distances ...
2025-03-09 08:22:08: [retrieval_preprocessing] finished and saved retrieval indices for episode 76955 [episode count 18/20]
[retrieval_preprocessing] for episode 46370 [episode count 19/20], we have num_retrieval=np.int64(4522) num_query=np.int64(183)
2025-03-09 08:22:08,594 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-09 08:22:09,174 [INFO]: Launching the whole pipeline 03/09/2025, 08:22:09
2025-03-09 08:22:09,174 [INFO]: Reading total number of vectors and dimension 03/09/2025, 08:22:09
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1485.76it/s]
2025-03-09 08:22:09,199 [INFO]: There are 4522 embeddings of dim 49152
2025-03-09 08:22:09,200 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0258 secs
2025-03-09 08:22:09,200 [INFO]: 	Compute estimated construction time of the index 03/09/2025, 08:22:09
2025-03-09 08:22:09,200 [INFO]: 		-> Train: 16.7 minutes
2025-03-09 08:22:09,200 [INFO]: 		-> Add: 2.5 seconds
2025-03-09 08:22:09,200 [INFO]: 		Total: 16.7 minutes
2025-03-09 08:22:09,200 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0001 secs
2025-03-09 08:22:09,200 [INFO]: 	Checking that your have enough memory available to create the index 03/09/2025, 08:22:09
2025-03-09 08:22:09,200 [INFO]: 933.2MB of memory will be needed to build the index (more might be used if you have more)
2025-03-09 08:22:09,200 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0001 secs
2025-03-09 08:22:09,200 [INFO]: 	Selecting most promising index types given data characteristics 03/09/2025, 08:22:09
2025-03-09 08:22:09,200 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-09 08:22:09,200 [INFO]: 	Creating the index 03/09/2025, 08:22:09
2025-03-09 08:22:09,200 [INFO]: 		-> Instanciate the index HNSW15 03/09/2025, 08:22:09
2025-03-09 08:22:09,201 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0010 secs
2025-03-09 08:22:09,201 [INFO]: 		-> Adding the vectors to the index 03/09/2025, 08:22:09
2025-03-09 08:22:09,201 [INFO]: The memory available for adding the vectors is 49.2GB(total available - used by the index)
2025-03-09 08:22:09,201 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/18 [00:00<?, ?it/s]  6%|▌         | 1/18 [00:00<00:01,  8.64it/s] 39%|███▉      | 7/18 [00:00<00:00, 33.74it/s] 72%|███████▏  | 13/18 [00:00<00:00, 41.69it/s]100%|██████████| 18/18 [00:03<00:00,  3.82it/s]100%|██████████| 18/18 [00:03<00:00,  5.24it/s]
2025-03-09 08:22:12,643 [INFO]: 	Computing best hyperparameters for index knn.index 03/09/2025, 08:22:12
2025-03-09 08:22:55,076 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 42.4320 secs
2025-03-09 08:22:55,076 [INFO]: The best hyperparameters are: efSearch=279
2025-03-09 08:22:55,076 [INFO]: 	Compute fast metrics 03/09/2025, 08:22:55
  0%|          | 0/4 [00:00<?, ?it/s] 25%|██▌       | 1/4 [00:00<00:00,  6.88it/s] 75%|███████▌  | 3/4 [00:00<00:00, 12.88it/s] 75%|███████▌  | 3/4 [00:00<00:00,  9.95it/s]
2025-03-09 08:23:13,944 [INFO]: 	>>> Finished "Compute fast metrics" in 18.8679 secs
2025-03-09 08:23:13,950 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 64.7487 secs
2025-03-09 08:23:13,950 [INFO]: {
2025-03-09 08:23:13,950 [INFO]: 	index_key: HNSW15
2025-03-09 08:23:13,950 [INFO]: 	index_param: efSearch=279
2025-03-09 08:23:13,950 [INFO]: 	index_path: knn.index
2025-03-09 08:23:13,950 [INFO]: 	size in bytes: 889676350
2025-03-09 08:23:13,950 [INFO]: 	avg_search_speed_ms: 13.005444568355406
2025-03-09 08:23:13,950 [INFO]: 	99p_search_speed_ms: 30.75762544758612
2025-03-09 08:23:13,950 [INFO]: 	reconstruction error %: 0.0
2025-03-09 08:23:13,950 [INFO]: 	nb vectors: 4522
2025-03-09 08:23:13,950 [INFO]: 	vectors dimension: 49152
2025-03-09 08:23:13,950 [INFO]: 	compression ratio: 0.9993087666093405
2025-03-09 08:23:13,950 [INFO]: }
2025-03-09 08:23:13,950 [INFO]: 	>>> Finished "Creating the index" in 64.7503 secs
2025-03-09 08:23:13,950 [INFO]: >>> Finished "Launching the whole pipeline" in 64.7768 secs
2025-03-09 08:23:15: [retrieval_preprocessing] calculating distances ...
2025-03-09 08:23:16: [retrieval_preprocessing] finished and saved retrieval indices for episode 46370 [episode count 19/20]
2025-03-09 08:23:16: [retrieval_preprocessing] finished for (1959308322, 'marker') [chosen_id count 4/10]
2025-03-09 08:23:17: [retrieval_preprocessing] concatenated all embeddings and indices for 20 episodes for (3163748394, 'cup') [chosen_id count 5/10]
2025-03-09 08:23:17: [retrieval_preprocessing] we have num_total=2524 embedding_dim=49152
[retrieval_preprocessing] for episode 20483 [episode count 0/20], we have num_retrieval=np.int64(2402) num_query=np.int64(122)
2025-03-09 08:23:18,040 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-09 08:23:18,342 [INFO]: Launching the whole pipeline 03/09/2025, 08:23:18
2025-03-09 08:23:18,342 [INFO]: Reading total number of vectors and dimension 03/09/2025, 08:23:18
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1723.92it/s]
2025-03-09 08:23:18,372 [INFO]: There are 2402 embeddings of dim 49152
2025-03-09 08:23:18,372 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0293 secs
2025-03-09 08:23:18,372 [INFO]: 	Compute estimated construction time of the index 03/09/2025, 08:23:18
2025-03-09 08:23:18,372 [INFO]: 		-> Train: 16.7 minutes
2025-03-09 08:23:18,372 [INFO]: 		-> Add: 1.3 seconds
2025-03-09 08:23:18,372 [INFO]: 		Total: 16.7 minutes
2025-03-09 08:23:18,372 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0001 secs
2025-03-09 08:23:18,372 [INFO]: 	Checking that your have enough memory available to create the index 03/09/2025, 08:23:18
2025-03-09 08:23:18,372 [INFO]: 495.7MB of memory will be needed to build the index (more might be used if you have more)
2025-03-09 08:23:18,372 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0001 secs
2025-03-09 08:23:18,372 [INFO]: 	Selecting most promising index types given data characteristics 03/09/2025, 08:23:18
2025-03-09 08:23:18,372 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-09 08:23:18,372 [INFO]: 	Creating the index 03/09/2025, 08:23:18
2025-03-09 08:23:18,372 [INFO]: 		-> Instanciate the index HNSW15 03/09/2025, 08:23:18
2025-03-09 08:23:18,373 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0009 secs
2025-03-09 08:23:18,373 [INFO]: 		-> Adding the vectors to the index 03/09/2025, 08:23:18
2025-03-09 08:23:18,373 [INFO]: The memory available for adding the vectors is 49.6GB(total available - used by the index)
2025-03-09 08:23:18,373 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/10 [00:00<?, ?it/s] 10%|█         | 1/10 [00:00<00:01,  7.65it/s] 60%|██████    | 6/10 [00:00<00:00, 28.16it/s]100%|██████████| 10/10 [00:01<00:00,  4.22it/s]100%|██████████| 10/10 [00:01<00:00,  5.01it/s]
2025-03-09 08:23:20,371 [INFO]: 	Computing best hyperparameters for index knn.index 03/09/2025, 08:23:20
2025-03-09 08:23:47,552 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 27.1805 secs
2025-03-09 08:23:47,552 [INFO]: The best hyperparameters are: efSearch=184
2025-03-09 08:23:47,552 [INFO]: 	Compute fast metrics 03/09/2025, 08:23:47
  0%|          | 0/4 [00:00<?, ?it/s] 50%|█████     | 2/4 [00:00<00:00, 19.25it/s] 75%|███████▌  | 3/4 [00:00<00:00, 21.34it/s]
2025-03-09 08:24:04,690 [INFO]: 	>>> Finished "Compute fast metrics" in 17.1374 secs
2025-03-09 08:24:04,691 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 46.3178 secs
2025-03-09 08:24:04,691 [INFO]: {
2025-03-09 08:24:04,691 [INFO]: 	index_key: HNSW15
2025-03-09 08:24:04,691 [INFO]: 	index_param: efSearch=184
2025-03-09 08:24:04,691 [INFO]: 	index_path: knn.index
2025-03-09 08:24:04,691 [INFO]: 	size in bytes: 472578610
2025-03-09 08:24:04,691 [INFO]: 	avg_search_speed_ms: 9.347825285230076
2025-03-09 08:24:04,691 [INFO]: 	99p_search_speed_ms: 23.812402326147996
2025-03-09 08:24:04,691 [INFO]: 	reconstruction error %: 0.0
2025-03-09 08:24:04,691 [INFO]: 	nb vectors: 2402
2025-03-09 08:24:04,691 [INFO]: 	vectors dimension: 49152
2025-03-09 08:24:04,691 [INFO]: 	compression ratio: 0.9993097571639986
2025-03-09 08:24:04,691 [INFO]: }
2025-03-09 08:24:04,691 [INFO]: 	>>> Finished "Creating the index" in 46.3192 secs
2025-03-09 08:24:04,691 [INFO]: >>> Finished "Launching the whole pipeline" in 46.3490 secs
2025-03-09 08:24:05: [retrieval_preprocessing] calculating distances ...
2025-03-09 08:24:05: [retrieval_preprocessing] finished and saved retrieval indices for episode 20483 [episode count 0/20]
[retrieval_preprocessing] for episode 5124 [episode count 1/20], we have num_retrieval=np.int64(2289) num_query=np.int64(235)
2025-03-09 08:24:05,648 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-09 08:24:05,974 [INFO]: Launching the whole pipeline 03/09/2025, 08:24:05
2025-03-09 08:24:05,974 [INFO]: Reading total number of vectors and dimension 03/09/2025, 08:24:05
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1145.98it/s]
2025-03-09 08:24:06,005 [INFO]: There are 2289 embeddings of dim 49152
2025-03-09 08:24:06,006 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0319 secs
2025-03-09 08:24:06,006 [INFO]: 	Compute estimated construction time of the index 03/09/2025, 08:24:06
2025-03-09 08:24:06,007 [INFO]: 		-> Train: 16.7 minutes
2025-03-09 08:24:06,007 [INFO]: 		-> Add: 1.3 seconds
2025-03-09 08:24:06,007 [INFO]: 		Total: 16.7 minutes
2025-03-09 08:24:06,007 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0009 secs
2025-03-09 08:24:06,007 [INFO]: 	Checking that your have enough memory available to create the index 03/09/2025, 08:24:06
2025-03-09 08:24:06,008 [INFO]: 472.4MB of memory will be needed to build the index (more might be used if you have more)
2025-03-09 08:24:06,008 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0005 secs
2025-03-09 08:24:06,008 [INFO]: 	Selecting most promising index types given data characteristics 03/09/2025, 08:24:06
2025-03-09 08:24:06,009 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-09 08:24:06,009 [INFO]: 	Creating the index 03/09/2025, 08:24:06
2025-03-09 08:24:06,009 [INFO]: 		-> Instanciate the index HNSW15 03/09/2025, 08:24:06
2025-03-09 08:24:06,013 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0035 secs
2025-03-09 08:24:06,013 [INFO]: 		-> Adding the vectors to the index 03/09/2025, 08:24:06
2025-03-09 08:24:06,014 [INFO]: The memory available for adding the vectors is 49.6GB(total available - used by the index)
2025-03-09 08:24:06,014 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/10 [00:00<?, ?it/s] 20%|██        | 2/10 [00:00<00:00, 19.11it/s] 50%|█████     | 5/10 [00:00<00:00, 22.11it/s] 80%|████████  | 8/10 [00:00<00:00, 22.98it/s]100%|██████████| 10/10 [00:02<00:00,  4.97it/s]
2025-03-09 08:24:08,031 [INFO]: 	Computing best hyperparameters for index knn.index 03/09/2025, 08:24:08
2025-03-09 08:24:35,602 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 27.5705 secs
2025-03-09 08:24:35,602 [INFO]: The best hyperparameters are: efSearch=162
2025-03-09 08:24:35,602 [INFO]: 	Compute fast metrics 03/09/2025, 08:24:35
  0%|          | 0/4 [00:00<?, ?it/s] 75%|███████▌  | 3/4 [00:00<00:00, 25.87it/s] 75%|███████▌  | 3/4 [00:00<00:00, 21.97it/s]
2025-03-09 08:24:52,016 [INFO]: 	>>> Finished "Compute fast metrics" in 16.4140 secs
2025-03-09 08:24:52,018 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 46.0047 secs
2025-03-09 08:24:52,018 [INFO]: {
2025-03-09 08:24:52,018 [INFO]: 	index_key: HNSW15
2025-03-09 08:24:52,018 [INFO]: 	index_param: efSearch=162
2025-03-09 08:24:52,018 [INFO]: 	index_path: knn.index
2025-03-09 08:24:52,018 [INFO]: 	size in bytes: 450346690
2025-03-09 08:24:52,018 [INFO]: 	avg_search_speed_ms: 7.972876194669929
2025-03-09 08:24:52,018 [INFO]: 	99p_search_speed_ms: 17.516786863561723
2025-03-09 08:24:52,018 [INFO]: 	reconstruction error %: 0.0
2025-03-09 08:24:52,018 [INFO]: 	nb vectors: 2289
2025-03-09 08:24:52,018 [INFO]: 	vectors dimension: 49152
2025-03-09 08:24:52,018 [INFO]: 	compression ratio: 0.9993094697776063
2025-03-09 08:24:52,018 [INFO]: }
2025-03-09 08:24:52,019 [INFO]: 	>>> Finished "Creating the index" in 46.0095 secs
2025-03-09 08:24:52,019 [INFO]: >>> Finished "Launching the whole pipeline" in 46.0448 secs
2025-03-09 08:24:53: [retrieval_preprocessing] calculating distances ...
2025-03-09 08:24:53: [retrieval_preprocessing] finished and saved retrieval indices for episode 5124 [episode count 1/20]
[retrieval_preprocessing] for episode 26628 [episode count 2/20], we have num_retrieval=np.int64(2407) num_query=np.int64(117)
2025-03-09 08:24:54,172 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-09 08:24:54,483 [INFO]: Launching the whole pipeline 03/09/2025, 08:24:54
2025-03-09 08:24:54,483 [INFO]: Reading total number of vectors and dimension 03/09/2025, 08:24:54
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1023.50it/s]
2025-03-09 08:24:54,513 [INFO]: There are 2407 embeddings of dim 49152
2025-03-09 08:24:54,513 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0305 secs
2025-03-09 08:24:54,513 [INFO]: 	Compute estimated construction time of the index 03/09/2025, 08:24:54
2025-03-09 08:24:54,513 [INFO]: 		-> Train: 16.7 minutes
2025-03-09 08:24:54,513 [INFO]: 		-> Add: 1.3 seconds
2025-03-09 08:24:54,514 [INFO]: 		Total: 16.7 minutes
2025-03-09 08:24:54,514 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0001 secs
2025-03-09 08:24:54,514 [INFO]: 	Checking that your have enough memory available to create the index 03/09/2025, 08:24:54
2025-03-09 08:24:54,514 [INFO]: 496.7MB of memory will be needed to build the index (more might be used if you have more)
2025-03-09 08:24:54,514 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0001 secs
2025-03-09 08:24:54,514 [INFO]: 	Selecting most promising index types given data characteristics 03/09/2025, 08:24:54
2025-03-09 08:24:54,514 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-09 08:24:54,514 [INFO]: 	Creating the index 03/09/2025, 08:24:54
2025-03-09 08:24:54,514 [INFO]: 		-> Instanciate the index HNSW15 03/09/2025, 08:24:54
2025-03-09 08:24:54,515 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0010 secs
2025-03-09 08:24:54,515 [INFO]: 		-> Adding the vectors to the index 03/09/2025, 08:24:54
2025-03-09 08:24:54,515 [INFO]: The memory available for adding the vectors is 49.6GB(total available - used by the index)
2025-03-09 08:24:54,515 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/10 [00:00<?, ?it/s] 10%|█         | 1/10 [00:00<00:01,  7.40it/s] 50%|█████     | 5/10 [00:00<00:00, 23.10it/s]100%|██████████| 10/10 [00:01<00:00,  4.37it/s]100%|██████████| 10/10 [00:02<00:00,  5.00it/s]
2025-03-09 08:24:56,520 [INFO]: 	Computing best hyperparameters for index knn.index 03/09/2025, 08:24:56
2025-03-09 08:25:23,534 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 27.0139 secs
2025-03-09 08:25:23,534 [INFO]: The best hyperparameters are: efSearch=279
2025-03-09 08:25:23,534 [INFO]: 	Compute fast metrics 03/09/2025, 08:25:23
  0%|          | 0/4 [00:00<?, ?it/s] 50%|█████     | 2/4 [00:00<00:00, 18.27it/s] 75%|███████▌  | 3/4 [00:00<00:00, 19.89it/s]
2025-03-09 08:25:36,274 [INFO]: 	>>> Finished "Compute fast metrics" in 12.7401 secs
2025-03-09 08:25:36,276 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 41.7614 secs
2025-03-09 08:25:36,277 [INFO]: {
2025-03-09 08:25:36,277 [INFO]: 	index_key: HNSW15
2025-03-09 08:25:36,277 [INFO]: 	index_param: efSearch=279
2025-03-09 08:25:36,277 [INFO]: 	index_path: knn.index
2025-03-09 08:25:36,277 [INFO]: 	size in bytes: 473562370
2025-03-09 08:25:36,277 [INFO]: 	avg_search_speed_ms: 12.487116979581403
2025-03-09 08:25:36,277 [INFO]: 	99p_search_speed_ms: 25.077606525737796
2025-03-09 08:25:36,277 [INFO]: 	reconstruction error %: 0.0
2025-03-09 08:25:36,277 [INFO]: 	nb vectors: 2407
2025-03-09 08:25:36,277 [INFO]: 	vectors dimension: 49152
2025-03-09 08:25:36,277 [INFO]: 	compression ratio: 0.9993096706564755
2025-03-09 08:25:36,277 [INFO]: }
2025-03-09 08:25:36,277 [INFO]: 	>>> Finished "Creating the index" in 41.7630 secs
2025-03-09 08:25:36,277 [INFO]: >>> Finished "Launching the whole pipeline" in 41.7940 secs
2025-03-09 08:25:37: [retrieval_preprocessing] calculating distances ...
2025-03-09 08:25:37: [retrieval_preprocessing] finished and saved retrieval indices for episode 26628 [episode count 2/20]
[retrieval_preprocessing] for episode 8198 [episode count 3/20], we have num_retrieval=np.int64(2368) num_query=np.int64(156)
2025-03-09 08:25:38,259 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-09 08:25:38,635 [INFO]: Launching the whole pipeline 03/09/2025, 08:25:38
2025-03-09 08:25:38,635 [INFO]: Reading total number of vectors and dimension 03/09/2025, 08:25:38
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 2116.20it/s]
2025-03-09 08:25:38,658 [INFO]: There are 2368 embeddings of dim 49152
2025-03-09 08:25:38,658 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0225 secs
2025-03-09 08:25:38,658 [INFO]: 	Compute estimated construction time of the index 03/09/2025, 08:25:38
2025-03-09 08:25:38,658 [INFO]: 		-> Train: 16.7 minutes
2025-03-09 08:25:38,658 [INFO]: 		-> Add: 1.3 seconds
2025-03-09 08:25:38,658 [INFO]: 		Total: 16.7 minutes
2025-03-09 08:25:38,658 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0001 secs
2025-03-09 08:25:38,658 [INFO]: 	Checking that your have enough memory available to create the index 03/09/2025, 08:25:38
2025-03-09 08:25:38,658 [INFO]: 488.7MB of memory will be needed to build the index (more might be used if you have more)
2025-03-09 08:25:38,658 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0001 secs
2025-03-09 08:25:38,658 [INFO]: 	Selecting most promising index types given data characteristics 03/09/2025, 08:25:38
2025-03-09 08:25:38,658 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-09 08:25:38,658 [INFO]: 	Creating the index 03/09/2025, 08:25:38
2025-03-09 08:25:38,659 [INFO]: 		-> Instanciate the index HNSW15 03/09/2025, 08:25:38
2025-03-09 08:25:38,659 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0009 secs
2025-03-09 08:25:38,660 [INFO]: 		-> Adding the vectors to the index 03/09/2025, 08:25:38
2025-03-09 08:25:38,660 [INFO]: The memory available for adding the vectors is 49.6GB(total available - used by the index)
2025-03-09 08:25:38,660 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/10 [00:00<?, ?it/s] 10%|█         | 1/10 [00:00<00:01,  8.13it/s] 60%|██████    | 6/10 [00:00<00:00, 29.98it/s]100%|██████████| 10/10 [00:02<00:00,  3.58it/s]100%|██████████| 10/10 [00:02<00:00,  4.30it/s]
2025-03-09 08:25:40,988 [INFO]: 	Computing best hyperparameters for index knn.index 03/09/2025, 08:25:40
2025-03-09 08:26:09,993 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 29.0046 secs
2025-03-09 08:26:09,994 [INFO]: The best hyperparameters are: efSearch=189
2025-03-09 08:26:09,994 [INFO]: 	Compute fast metrics 03/09/2025, 08:26:09
  0%|          | 0/4 [00:00<?, ?it/s] 50%|█████     | 2/4 [00:00<00:00, 18.82it/s] 75%|███████▌  | 3/4 [00:00<00:00, 20.78it/s]
2025-03-09 08:26:24,587 [INFO]: 	>>> Finished "Compute fast metrics" in 14.5934 secs
2025-03-09 08:26:24,589 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 45.9291 secs
2025-03-09 08:26:24,589 [INFO]: {
2025-03-09 08:26:24,589 [INFO]: 	index_key: HNSW15
2025-03-09 08:26:24,589 [INFO]: 	index_param: efSearch=189
2025-03-09 08:26:24,589 [INFO]: 	index_path: knn.index
2025-03-09 08:26:24,589 [INFO]: 	size in bytes: 465889390
2025-03-09 08:26:24,589 [INFO]: 	avg_search_speed_ms: 8.370038998901657
2025-03-09 08:26:24,589 [INFO]: 	99p_search_speed_ms: 13.480009078048164
2025-03-09 08:26:24,589 [INFO]: 	reconstruction error %: 0.0
2025-03-09 08:26:24,589 [INFO]: 	nb vectors: 2368
2025-03-09 08:26:24,589 [INFO]: 	vectors dimension: 49152
2025-03-09 08:26:24,589 [INFO]: 	compression ratio: 0.999309608660545
2025-03-09 08:26:24,589 [INFO]: }
2025-03-09 08:26:24,589 [INFO]: 	>>> Finished "Creating the index" in 45.9305 secs
2025-03-09 08:26:24,589 [INFO]: >>> Finished "Launching the whole pipeline" in 45.9536 secs
2025-03-09 08:26:26: [retrieval_preprocessing] calculating distances ...
2025-03-09 08:26:27: [retrieval_preprocessing] finished and saved retrieval indices for episode 8198 [episode count 3/20]
[retrieval_preprocessing] for episode 26637 [episode count 4/20], we have num_retrieval=np.int64(2384) num_query=np.int64(140)
2025-03-09 08:26:27,559 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-09 08:26:27,852 [INFO]: Launching the whole pipeline 03/09/2025, 08:26:27
2025-03-09 08:26:27,852 [INFO]: Reading total number of vectors and dimension 03/09/2025, 08:26:27
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1208.38it/s]
2025-03-09 08:26:27,882 [INFO]: There are 2384 embeddings of dim 49152
2025-03-09 08:26:27,882 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0296 secs
2025-03-09 08:26:27,882 [INFO]: 	Compute estimated construction time of the index 03/09/2025, 08:26:27
2025-03-09 08:26:27,882 [INFO]: 		-> Train: 16.7 minutes
2025-03-09 08:26:27,882 [INFO]: 		-> Add: 1.3 seconds
2025-03-09 08:26:27,882 [INFO]: 		Total: 16.7 minutes
2025-03-09 08:26:27,882 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0001 secs
2025-03-09 08:26:27,882 [INFO]: 	Checking that your have enough memory available to create the index 03/09/2025, 08:26:27
2025-03-09 08:26:27,882 [INFO]: 492.0MB of memory will be needed to build the index (more might be used if you have more)
2025-03-09 08:26:27,882 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0001 secs
2025-03-09 08:26:27,882 [INFO]: 	Selecting most promising index types given data characteristics 03/09/2025, 08:26:27
2025-03-09 08:26:27,883 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-09 08:26:27,883 [INFO]: 	Creating the index 03/09/2025, 08:26:27
2025-03-09 08:26:27,883 [INFO]: 		-> Instanciate the index HNSW15 03/09/2025, 08:26:27
2025-03-09 08:26:27,884 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0010 secs
2025-03-09 08:26:27,884 [INFO]: 		-> Adding the vectors to the index 03/09/2025, 08:26:27
2025-03-09 08:26:27,884 [INFO]: The memory available for adding the vectors is 49.6GB(total available - used by the index)
2025-03-09 08:26:27,884 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/10 [00:00<?, ?it/s] 20%|██        | 2/10 [00:00<00:00, 19.36it/s] 90%|█████████ | 9/10 [00:00<00:00, 45.74it/s]100%|██████████| 10/10 [00:01<00:00,  5.40it/s]
2025-03-09 08:26:29,737 [INFO]: 	Computing best hyperparameters for index knn.index 03/09/2025, 08:26:29
2025-03-09 08:26:56,087 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 26.3495 secs
2025-03-09 08:26:56,088 [INFO]: The best hyperparameters are: efSearch=263
2025-03-09 08:26:56,088 [INFO]: 	Compute fast metrics 03/09/2025, 08:26:56
  0%|          | 0/4 [00:00<?, ?it/s] 50%|█████     | 2/4 [00:00<00:00, 18.59it/s] 75%|███████▌  | 3/4 [00:00<00:00, 16.02it/s]
2025-03-09 08:27:10,951 [INFO]: 	>>> Finished "Compute fast metrics" in 14.8634 secs
2025-03-09 08:27:10,953 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 43.0690 secs
2025-03-09 08:27:10,953 [INFO]: {
2025-03-09 08:27:10,953 [INFO]: 	index_key: HNSW15
2025-03-09 08:27:10,953 [INFO]: 	index_param: efSearch=263
2025-03-09 08:27:10,953 [INFO]: 	index_path: knn.index
2025-03-09 08:27:10,953 [INFO]: 	size in bytes: 469037230
2025-03-09 08:27:10,953 [INFO]: 	avg_search_speed_ms: 12.004245202015696
2025-03-09 08:27:10,953 [INFO]: 	99p_search_speed_ms: 28.634192198514935
2025-03-09 08:27:10,953 [INFO]: 	reconstruction error %: 0.0
2025-03-09 08:27:10,953 [INFO]: 	nb vectors: 2384
2025-03-09 08:27:10,953 [INFO]: 	vectors dimension: 49152
2025-03-09 08:27:10,953 [INFO]: 	compression ratio: 0.999309739229016
2025-03-09 08:27:10,953 [INFO]: }
2025-03-09 08:27:10,953 [INFO]: 	>>> Finished "Creating the index" in 43.0706 secs
2025-03-09 08:27:10,953 [INFO]: >>> Finished "Launching the whole pipeline" in 43.1007 secs
2025-03-09 08:27:11: [retrieval_preprocessing] calculating distances ...
2025-03-09 08:27:12: [retrieval_preprocessing] finished and saved retrieval indices for episode 26637 [episode count 4/20]
[retrieval_preprocessing] for episode 80400 [episode count 5/20], we have num_retrieval=np.int64(2398) num_query=np.int64(126)
2025-03-09 08:27:12,591 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-09 08:27:12,912 [INFO]: Launching the whole pipeline 03/09/2025, 08:27:12
2025-03-09 08:27:12,912 [INFO]: Reading total number of vectors and dimension 03/09/2025, 08:27:12
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1743.99it/s]
2025-03-09 08:27:12,938 [INFO]: There are 2398 embeddings of dim 49152
2025-03-09 08:27:12,938 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0259 secs
2025-03-09 08:27:12,938 [INFO]: 	Compute estimated construction time of the index 03/09/2025, 08:27:12
2025-03-09 08:27:12,938 [INFO]: 		-> Train: 16.7 minutes
2025-03-09 08:27:12,938 [INFO]: 		-> Add: 1.3 seconds
2025-03-09 08:27:12,938 [INFO]: 		Total: 16.7 minutes
2025-03-09 08:27:12,938 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0003 secs
2025-03-09 08:27:12,939 [INFO]: 	Checking that your have enough memory available to create the index 03/09/2025, 08:27:12
2025-03-09 08:27:12,939 [INFO]: 494.9MB of memory will be needed to build the index (more might be used if you have more)
2025-03-09 08:27:12,939 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0005 secs
2025-03-09 08:27:12,939 [INFO]: 	Selecting most promising index types given data characteristics 03/09/2025, 08:27:12
2025-03-09 08:27:12,939 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-09 08:27:12,940 [INFO]: 	Creating the index 03/09/2025, 08:27:12
2025-03-09 08:27:12,940 [INFO]: 		-> Instanciate the index HNSW15 03/09/2025, 08:27:12
2025-03-09 08:27:12,942 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0027 secs
2025-03-09 08:27:12,943 [INFO]: 		-> Adding the vectors to the index 03/09/2025, 08:27:12
2025-03-09 08:27:12,943 [INFO]: The memory available for adding the vectors is 49.6GB(total available - used by the index)
2025-03-09 08:27:12,943 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/10 [00:00<?, ?it/s] 30%|███       | 3/10 [00:00<00:00, 28.77it/s] 90%|█████████ | 9/10 [00:00<00:00, 41.63it/s]100%|██████████| 10/10 [00:01<00:00,  5.29it/s]
2025-03-09 08:27:14,839 [INFO]: 	Computing best hyperparameters for index knn.index 03/09/2025, 08:27:14
2025-03-09 08:27:45,309 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 30.4692 secs
2025-03-09 08:27:45,309 [INFO]: The best hyperparameters are: efSearch=210
2025-03-09 08:27:45,309 [INFO]: 	Compute fast metrics 03/09/2025, 08:27:45
  0%|          | 0/4 [00:00<?, ?it/s] 75%|███████▌  | 3/4 [00:00<00:00, 26.53it/s] 75%|███████▌  | 3/4 [00:00<00:00, 22.56it/s]
2025-03-09 08:28:03,611 [INFO]: 	>>> Finished "Compute fast metrics" in 18.3020 secs
2025-03-09 08:28:03,613 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 50.6698 secs
2025-03-09 08:28:03,613 [INFO]: {
2025-03-09 08:28:03,613 [INFO]: 	index_key: HNSW15
2025-03-09 08:28:03,613 [INFO]: 	index_param: efSearch=210
2025-03-09 08:28:03,613 [INFO]: 	index_path: knn.index
2025-03-09 08:28:03,613 [INFO]: 	size in bytes: 471791650
2025-03-09 08:28:03,613 [INFO]: 	avg_search_speed_ms: 9.149084180808215
2025-03-09 08:28:03,613 [INFO]: 	99p_search_speed_ms: 20.970033416524487
2025-03-09 08:28:03,613 [INFO]: 	reconstruction error %: 0.0
2025-03-09 08:28:03,613 [INFO]: 	nb vectors: 2398
2025-03-09 08:28:03,613 [INFO]: 	vectors dimension: 49152
2025-03-09 08:28:03,613 [INFO]: 	compression ratio: 0.9993097249601598
2025-03-09 08:28:03,613 [INFO]: }
2025-03-09 08:28:03,613 [INFO]: 	>>> Finished "Creating the index" in 50.6734 secs
2025-03-09 08:28:03,613 [INFO]: >>> Finished "Launching the whole pipeline" in 50.7011 secs
2025-03-09 08:28:04: [retrieval_preprocessing] calculating distances ...
2025-03-09 08:28:04: [retrieval_preprocessing] finished and saved retrieval indices for episode 80400 [episode count 5/20]
[retrieval_preprocessing] for episode 5139 [episode count 6/20], we have num_retrieval=np.int64(2409) num_query=np.int64(115)
2025-03-09 08:28:04,906 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-09 08:28:05,208 [INFO]: Launching the whole pipeline 03/09/2025, 08:28:05
2025-03-09 08:28:05,208 [INFO]: Reading total number of vectors and dimension 03/09/2025, 08:28:05
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1671.70it/s]
2025-03-09 08:28:05,233 [INFO]: There are 2409 embeddings of dim 49152
2025-03-09 08:28:05,233 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0246 secs
2025-03-09 08:28:05,233 [INFO]: 	Compute estimated construction time of the index 03/09/2025, 08:28:05
2025-03-09 08:28:05,233 [INFO]: 		-> Train: 16.7 minutes
2025-03-09 08:28:05,233 [INFO]: 		-> Add: 1.3 seconds
2025-03-09 08:28:05,233 [INFO]: 		Total: 16.7 minutes
2025-03-09 08:28:05,233 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0001 secs
2025-03-09 08:28:05,233 [INFO]: 	Checking that your have enough memory available to create the index 03/09/2025, 08:28:05
2025-03-09 08:28:05,233 [INFO]: 497.2MB of memory will be needed to build the index (more might be used if you have more)
2025-03-09 08:28:05,233 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0001 secs
2025-03-09 08:28:05,233 [INFO]: 	Selecting most promising index types given data characteristics 03/09/2025, 08:28:05
2025-03-09 08:28:05,233 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-09 08:28:05,233 [INFO]: 	Creating the index 03/09/2025, 08:28:05
2025-03-09 08:28:05,234 [INFO]: 		-> Instanciate the index HNSW15 03/09/2025, 08:28:05
2025-03-09 08:28:05,234 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0009 secs
2025-03-09 08:28:05,234 [INFO]: 		-> Adding the vectors to the index 03/09/2025, 08:28:05
2025-03-09 08:28:05,235 [INFO]: The memory available for adding the vectors is 49.6GB(total available - used by the index)
2025-03-09 08:28:05,235 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/10 [00:00<?, ?it/s] 10%|█         | 1/10 [00:00<00:01,  8.76it/s] 70%|███████   | 7/10 [00:00<00:00, 34.45it/s]100%|██████████| 10/10 [00:02<00:00,  4.93it/s]
2025-03-09 08:28:07,268 [INFO]: 	Computing best hyperparameters for index knn.index 03/09/2025, 08:28:07
2025-03-09 08:28:36,499 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 29.2312 secs
2025-03-09 08:28:36,500 [INFO]: The best hyperparameters are: efSearch=263
2025-03-09 08:28:36,500 [INFO]: 	Compute fast metrics 03/09/2025, 08:28:36
  0%|          | 0/4 [00:00<?, ?it/s] 50%|█████     | 2/4 [00:00<00:00, 19.10it/s] 75%|███████▌  | 3/4 [00:00<00:00, 18.30it/s]
2025-03-09 08:28:51,109 [INFO]: 	>>> Finished "Compute fast metrics" in 14.6094 secs
2025-03-09 08:28:51,111 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 45.8763 secs
2025-03-09 08:28:51,111 [INFO]: {
2025-03-09 08:28:51,111 [INFO]: 	index_key: HNSW15
2025-03-09 08:28:51,111 [INFO]: 	index_param: efSearch=263
2025-03-09 08:28:51,111 [INFO]: 	index_path: knn.index
2025-03-09 08:28:51,111 [INFO]: 	size in bytes: 473955850
2025-03-09 08:28:51,111 [INFO]: 	avg_search_speed_ms: 11.781594077030853
2025-03-09 08:28:51,111 [INFO]: 	99p_search_speed_ms: 23.771431650966406
2025-03-09 08:28:51,111 [INFO]: 	reconstruction error %: 0.0
2025-03-09 08:28:51,111 [INFO]: 	nb vectors: 2409
2025-03-09 08:28:51,111 [INFO]: 	vectors dimension: 49152
2025-03-09 08:28:51,111 [INFO]: 	compression ratio: 0.9993096867566884
2025-03-09 08:28:51,111 [INFO]: }
2025-03-09 08:28:51,111 [INFO]: 	>>> Finished "Creating the index" in 45.8777 secs
2025-03-09 08:28:51,111 [INFO]: >>> Finished "Launching the whole pipeline" in 45.9028 secs
2025-03-09 08:28:52: [retrieval_preprocessing] calculating distances ...
2025-03-09 08:28:52: [retrieval_preprocessing] finished and saved retrieval indices for episode 5139 [episode count 6/20]
[retrieval_preprocessing] for episode 24087 [episode count 7/20], we have num_retrieval=np.int64(2383) num_query=np.int64(141)
2025-03-09 08:28:52,604 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-09 08:28:52,937 [INFO]: Launching the whole pipeline 03/09/2025, 08:28:52
2025-03-09 08:28:52,937 [INFO]: Reading total number of vectors and dimension 03/09/2025, 08:28:52
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1335.77it/s]
2025-03-09 08:28:52,979 [INFO]: There are 2383 embeddings of dim 49152
2025-03-09 08:28:52,979 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0422 secs
2025-03-09 08:28:52,979 [INFO]: 	Compute estimated construction time of the index 03/09/2025, 08:28:52
2025-03-09 08:28:52,979 [INFO]: 		-> Train: 16.7 minutes
2025-03-09 08:28:52,980 [INFO]: 		-> Add: 1.3 seconds
2025-03-09 08:28:52,980 [INFO]: 		Total: 16.7 minutes
2025-03-09 08:28:52,980 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0003 secs
2025-03-09 08:28:52,980 [INFO]: 	Checking that your have enough memory available to create the index 03/09/2025, 08:28:52
2025-03-09 08:28:52,980 [INFO]: 491.8MB of memory will be needed to build the index (more might be used if you have more)
2025-03-09 08:28:52,980 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0004 secs
2025-03-09 08:28:52,980 [INFO]: 	Selecting most promising index types given data characteristics 03/09/2025, 08:28:52
2025-03-09 08:28:52,980 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-09 08:28:52,980 [INFO]: 	Creating the index 03/09/2025, 08:28:52
2025-03-09 08:28:52,980 [INFO]: 		-> Instanciate the index HNSW15 03/09/2025, 08:28:52
2025-03-09 08:28:52,983 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0020 secs
2025-03-09 08:28:52,983 [INFO]: 		-> Adding the vectors to the index 03/09/2025, 08:28:52
2025-03-09 08:28:52,983 [INFO]: The memory available for adding the vectors is 49.6GB(total available - used by the index)
2025-03-09 08:28:52,983 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/10 [00:00<?, ?it/s] 20%|██        | 2/10 [00:00<00:00, 17.31it/s] 60%|██████    | 6/10 [00:00<00:00, 27.62it/s]100%|██████████| 10/10 [00:02<00:00,  3.80it/s]100%|██████████| 10/10 [00:02<00:00,  4.67it/s]
2025-03-09 08:28:55,129 [INFO]: 	Computing best hyperparameters for index knn.index 03/09/2025, 08:28:55
2025-03-09 08:29:23,884 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 28.7549 secs
2025-03-09 08:29:23,884 [INFO]: The best hyperparameters are: efSearch=247
2025-03-09 08:29:23,885 [INFO]: 	Compute fast metrics 03/09/2025, 08:29:23
  0%|          | 0/4 [00:00<?, ?it/s] 50%|█████     | 2/4 [00:00<00:00, 18.77it/s] 75%|███████▌  | 3/4 [00:00<00:00, 17.25it/s]
2025-03-09 08:29:38,941 [INFO]: 	>>> Finished "Compute fast metrics" in 15.0566 secs
2025-03-09 08:29:38,943 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 45.9601 secs
2025-03-09 08:29:38,944 [INFO]: {
2025-03-09 08:29:38,944 [INFO]: 	index_key: HNSW15
2025-03-09 08:29:38,944 [INFO]: 	index_param: efSearch=247
2025-03-09 08:29:38,944 [INFO]: 	index_path: knn.index
2025-03-09 08:29:38,944 [INFO]: 	size in bytes: 468840490
2025-03-09 08:29:38,944 [INFO]: 	avg_search_speed_ms: 10.843162890775927
2025-03-09 08:29:38,944 [INFO]: 	99p_search_speed_ms: 24.648797912523143
2025-03-09 08:29:38,944 [INFO]: 	reconstruction error %: 0.0
2025-03-09 08:29:38,944 [INFO]: 	nb vectors: 2383
2025-03-09 08:29:38,944 [INFO]: 	vectors dimension: 49152
2025-03-09 08:29:38,944 [INFO]: 	compression ratio: 0.9993097311198528
2025-03-09 08:29:38,944 [INFO]: }
2025-03-09 08:29:38,944 [INFO]: 	>>> Finished "Creating the index" in 45.9634 secs
2025-03-09 08:29:38,944 [INFO]: >>> Finished "Launching the whole pipeline" in 46.0070 secs
2025-03-09 08:29:40: [retrieval_preprocessing] calculating distances ...
2025-03-09 08:29:40: [retrieval_preprocessing] finished and saved retrieval indices for episode 24087 [episode count 7/20]
[retrieval_preprocessing] for episode 36887 [episode count 8/20], we have num_retrieval=np.int64(2382) num_query=np.int64(142)
2025-03-09 08:29:40,787 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-09 08:29:41,125 [INFO]: Launching the whole pipeline 03/09/2025, 08:29:41
2025-03-09 08:29:41,125 [INFO]: Reading total number of vectors and dimension 03/09/2025, 08:29:41
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1831.57it/s]
2025-03-09 08:29:41,150 [INFO]: There are 2382 embeddings of dim 49152
2025-03-09 08:29:41,151 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0251 secs
2025-03-09 08:29:41,151 [INFO]: 	Compute estimated construction time of the index 03/09/2025, 08:29:41
2025-03-09 08:29:41,151 [INFO]: 		-> Train: 16.7 minutes
2025-03-09 08:29:41,151 [INFO]: 		-> Add: 1.3 seconds
2025-03-09 08:29:41,151 [INFO]: 		Total: 16.7 minutes
2025-03-09 08:29:41,151 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0002 secs
2025-03-09 08:29:41,151 [INFO]: 	Checking that your have enough memory available to create the index 03/09/2025, 08:29:41
2025-03-09 08:29:41,151 [INFO]: 491.6MB of memory will be needed to build the index (more might be used if you have more)
2025-03-09 08:29:41,151 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0001 secs
2025-03-09 08:29:41,151 [INFO]: 	Selecting most promising index types given data characteristics 03/09/2025, 08:29:41
2025-03-09 08:29:41,151 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-09 08:29:41,151 [INFO]: 	Creating the index 03/09/2025, 08:29:41
2025-03-09 08:29:41,151 [INFO]: 		-> Instanciate the index HNSW15 03/09/2025, 08:29:41
2025-03-09 08:29:41,152 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0010 secs
2025-03-09 08:29:41,152 [INFO]: 		-> Adding the vectors to the index 03/09/2025, 08:29:41
2025-03-09 08:29:41,152 [INFO]: The memory available for adding the vectors is 49.6GB(total available - used by the index)
2025-03-09 08:29:41,152 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/10 [00:00<?, ?it/s] 20%|██        | 2/10 [00:00<00:00, 17.62it/s] 60%|██████    | 6/10 [00:00<00:00, 26.28it/s]100%|██████████| 10/10 [00:02<00:00,  3.61it/s]100%|██████████| 10/10 [00:02<00:00,  4.43it/s]
2025-03-09 08:29:43,411 [INFO]: 	Computing best hyperparameters for index knn.index 03/09/2025, 08:29:43
2025-03-09 08:30:11,061 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 27.6501 secs
2025-03-09 08:30:11,062 [INFO]: The best hyperparameters are: efSearch=267
2025-03-09 08:30:11,062 [INFO]: 	Compute fast metrics 03/09/2025, 08:30:11
  0%|          | 0/4 [00:00<?, ?it/s] 50%|█████     | 2/4 [00:00<00:00, 16.69it/s] 75%|███████▌  | 3/4 [00:00<00:00, 17.73it/s]
2025-03-09 08:30:27,338 [INFO]: 	>>> Finished "Compute fast metrics" in 16.2763 secs
2025-03-09 08:30:27,339 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 46.1871 secs
2025-03-09 08:30:27,340 [INFO]: {
2025-03-09 08:30:27,340 [INFO]: 	index_key: HNSW15
2025-03-09 08:30:27,340 [INFO]: 	index_param: efSearch=267
2025-03-09 08:30:27,340 [INFO]: 	index_path: knn.index
2025-03-09 08:30:27,340 [INFO]: 	size in bytes: 468643750
2025-03-09 08:30:27,340 [INFO]: 	avg_search_speed_ms: 11.612725083128863
2025-03-09 08:30:27,340 [INFO]: 	99p_search_speed_ms: 26.72298094257712
2025-03-09 08:30:27,340 [INFO]: 	reconstruction error %: 0.0
2025-03-09 08:30:27,340 [INFO]: 	nb vectors: 2382
2025-03-09 08:30:27,340 [INFO]: 	vectors dimension: 49152
2025-03-09 08:30:27,340 [INFO]: 	compression ratio: 0.9993097230038809
2025-03-09 08:30:27,340 [INFO]: }
2025-03-09 08:30:27,340 [INFO]: 	>>> Finished "Creating the index" in 46.1885 secs
2025-03-09 08:30:27,340 [INFO]: >>> Finished "Launching the whole pipeline" in 46.2143 secs
2025-03-09 08:30:28: [retrieval_preprocessing] calculating distances ...
2025-03-09 08:30:28: [retrieval_preprocessing] finished and saved retrieval indices for episode 36887 [episode count 8/20]
[retrieval_preprocessing] for episode 25628 [episode count 9/20], we have num_retrieval=np.int64(2423) num_query=np.int64(101)
2025-03-09 08:30:29,126 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-09 08:30:29,425 [INFO]: Launching the whole pipeline 03/09/2025, 08:30:29
2025-03-09 08:30:29,425 [INFO]: Reading total number of vectors and dimension 03/09/2025, 08:30:29
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1807.89it/s]
2025-03-09 08:30:29,453 [INFO]: There are 2423 embeddings of dim 49152
2025-03-09 08:30:29,453 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0283 secs
2025-03-09 08:30:29,453 [INFO]: 	Compute estimated construction time of the index 03/09/2025, 08:30:29
2025-03-09 08:30:29,453 [INFO]: 		-> Train: 16.7 minutes
2025-03-09 08:30:29,453 [INFO]: 		-> Add: 1.3 seconds
2025-03-09 08:30:29,454 [INFO]: 		Total: 16.7 minutes
2025-03-09 08:30:29,454 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0001 secs
2025-03-09 08:30:29,454 [INFO]: 	Checking that your have enough memory available to create the index 03/09/2025, 08:30:29
2025-03-09 08:30:29,454 [INFO]: 500.0MB of memory will be needed to build the index (more might be used if you have more)
2025-03-09 08:30:29,454 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0001 secs
2025-03-09 08:30:29,454 [INFO]: 	Selecting most promising index types given data characteristics 03/09/2025, 08:30:29
2025-03-09 08:30:29,454 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-09 08:30:29,454 [INFO]: 	Creating the index 03/09/2025, 08:30:29
2025-03-09 08:30:29,454 [INFO]: 		-> Instanciate the index HNSW15 03/09/2025, 08:30:29
2025-03-09 08:30:29,455 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0010 secs
2025-03-09 08:30:29,455 [INFO]: 		-> Adding the vectors to the index 03/09/2025, 08:30:29
2025-03-09 08:30:29,455 [INFO]: The memory available for adding the vectors is 49.6GB(total available - used by the index)
2025-03-09 08:30:29,455 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/10 [00:00<?, ?it/s] 10%|█         | 1/10 [00:00<00:01,  8.95it/s] 70%|███████   | 7/10 [00:00<00:00, 35.28it/s]100%|██████████| 10/10 [00:01<00:00,  5.18it/s]
2025-03-09 08:30:31,388 [INFO]: 	Computing best hyperparameters for index knn.index 03/09/2025, 08:30:31
2025-03-09 08:31:00,184 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 28.7950 secs
2025-03-09 08:31:00,184 [INFO]: The best hyperparameters are: efSearch=271
2025-03-09 08:31:00,184 [INFO]: 	Compute fast metrics 03/09/2025, 08:31:00
  0%|          | 0/4 [00:00<?, ?it/s] 75%|███████▌  | 3/4 [00:00<00:00, 26.33it/s] 75%|███████▌  | 3/4 [00:00<00:00, 22.80it/s]
2025-03-09 08:31:15,224 [INFO]: 	>>> Finished "Compute fast metrics" in 15.0396 secs
2025-03-09 08:31:15,225 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 45.7701 secs
2025-03-09 08:31:15,225 [INFO]: {
2025-03-09 08:31:15,225 [INFO]: 	index_key: HNSW15
2025-03-09 08:31:15,225 [INFO]: 	index_param: efSearch=271
2025-03-09 08:31:15,225 [INFO]: 	index_path: knn.index
2025-03-09 08:31:15,225 [INFO]: 	size in bytes: 476710210
2025-03-09 08:31:15,225 [INFO]: 	avg_search_speed_ms: 11.863200473438944
2025-03-09 08:31:15,225 [INFO]: 	99p_search_speed_ms: 26.60001018550249
2025-03-09 08:31:15,225 [INFO]: 	reconstruction error %: 0.0
2025-03-09 08:31:15,225 [INFO]: 	nb vectors: 2423
2025-03-09 08:31:15,225 [INFO]: 	vectors dimension: 49152
2025-03-09 08:31:15,225 [INFO]: 	compression ratio: 0.9993097987139818
2025-03-09 08:31:15,225 [INFO]: }
2025-03-09 08:31:15,225 [INFO]: 	>>> Finished "Creating the index" in 45.7716 secs
2025-03-09 08:31:15,225 [INFO]: >>> Finished "Launching the whole pipeline" in 45.8005 secs
2025-03-09 08:31:16: [retrieval_preprocessing] calculating distances ...
2025-03-09 08:31:16: [retrieval_preprocessing] finished and saved retrieval indices for episode 25628 [episode count 9/20]
[retrieval_preprocessing] for episode 53278 [episode count 10/20], we have num_retrieval=np.int64(2421) num_query=np.int64(103)
2025-03-09 08:31:16,478 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-09 08:31:16,834 [INFO]: Launching the whole pipeline 03/09/2025, 08:31:16
2025-03-09 08:31:16,834 [INFO]: Reading total number of vectors and dimension 03/09/2025, 08:31:16
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1262.58it/s]
2025-03-09 08:31:16,861 [INFO]: There are 2421 embeddings of dim 49152
2025-03-09 08:31:16,861 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0271 secs
2025-03-09 08:31:16,861 [INFO]: 	Compute estimated construction time of the index 03/09/2025, 08:31:16
2025-03-09 08:31:16,861 [INFO]: 		-> Train: 16.7 minutes
2025-03-09 08:31:16,861 [INFO]: 		-> Add: 1.3 seconds
2025-03-09 08:31:16,861 [INFO]: 		Total: 16.7 minutes
2025-03-09 08:31:16,861 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0001 secs
2025-03-09 08:31:16,861 [INFO]: 	Checking that your have enough memory available to create the index 03/09/2025, 08:31:16
2025-03-09 08:31:16,861 [INFO]: 499.6MB of memory will be needed to build the index (more might be used if you have more)
2025-03-09 08:31:16,861 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0001 secs
2025-03-09 08:31:16,861 [INFO]: 	Selecting most promising index types given data characteristics 03/09/2025, 08:31:16
2025-03-09 08:31:16,861 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-09 08:31:16,861 [INFO]: 	Creating the index 03/09/2025, 08:31:16
2025-03-09 08:31:16,861 [INFO]: 		-> Instanciate the index HNSW15 03/09/2025, 08:31:16
2025-03-09 08:31:16,862 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0009 secs
2025-03-09 08:31:16,862 [INFO]: 		-> Adding the vectors to the index 03/09/2025, 08:31:16
2025-03-09 08:31:16,862 [INFO]: The memory available for adding the vectors is 49.6GB(total available - used by the index)
2025-03-09 08:31:16,863 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/10 [00:00<?, ?it/s] 20%|██        | 2/10 [00:00<00:00, 16.21it/s] 80%|████████  | 8/10 [00:00<00:00, 37.51it/s]100%|██████████| 10/10 [00:02<00:00,  3.83it/s]
2025-03-09 08:31:19,476 [INFO]: 	Computing best hyperparameters for index knn.index 03/09/2025, 08:31:19
2025-03-09 08:31:45,439 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 25.9631 secs
2025-03-09 08:31:45,439 [INFO]: The best hyperparameters are: efSearch=256
2025-03-09 08:31:45,439 [INFO]: 	Compute fast metrics 03/09/2025, 08:31:45
  0%|          | 0/4 [00:00<?, ?it/s] 50%|█████     | 2/4 [00:00<00:00, 19.46it/s] 75%|███████▌  | 3/4 [00:00<00:00, 21.37it/s]
2025-03-09 08:31:59,641 [INFO]: 	>>> Finished "Compute fast metrics" in 14.2015 secs
2025-03-09 08:31:59,643 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 42.7800 secs
2025-03-09 08:31:59,643 [INFO]: {
2025-03-09 08:31:59,643 [INFO]: 	index_key: HNSW15
2025-03-09 08:31:59,643 [INFO]: 	index_param: efSearch=256
2025-03-09 08:31:59,643 [INFO]: 	index_path: knn.index
2025-03-09 08:31:59,643 [INFO]: 	size in bytes: 476316730
2025-03-09 08:31:59,643 [INFO]: 	avg_search_speed_ms: 10.876035229707865
2025-03-09 08:31:59,643 [INFO]: 	99p_search_speed_ms: 26.52691092807799
2025-03-09 08:31:59,643 [INFO]: 	reconstruction error %: 0.0
2025-03-09 08:31:59,643 [INFO]: 	nb vectors: 2421
2025-03-09 08:31:59,643 [INFO]: 	vectors dimension: 49152
2025-03-09 08:31:59,643 [INFO]: 	compression ratio: 0.999309782799357
2025-03-09 08:31:59,643 [INFO]: }
2025-03-09 08:31:59,643 [INFO]: 	>>> Finished "Creating the index" in 42.7816 secs
2025-03-09 08:31:59,643 [INFO]: >>> Finished "Launching the whole pipeline" in 42.8092 secs
2025-03-09 08:32:00: [retrieval_preprocessing] calculating distances ...
2025-03-09 08:32:00: [retrieval_preprocessing] finished and saved retrieval indices for episode 53278 [episode count 10/20]
[retrieval_preprocessing] for episode 76858 [episode count 11/20], we have num_retrieval=np.int64(2434) num_query=np.int64(90)
2025-03-09 08:32:01,052 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-09 08:32:01,397 [INFO]: Launching the whole pipeline 03/09/2025, 08:32:01
2025-03-09 08:32:01,397 [INFO]: Reading total number of vectors and dimension 03/09/2025, 08:32:01
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 2526.69it/s]
2025-03-09 08:32:01,427 [INFO]: There are 2434 embeddings of dim 49152
2025-03-09 08:32:01,428 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0306 secs
2025-03-09 08:32:01,428 [INFO]: 	Compute estimated construction time of the index 03/09/2025, 08:32:01
2025-03-09 08:32:01,428 [INFO]: 		-> Train: 16.7 minutes
2025-03-09 08:32:01,428 [INFO]: 		-> Add: 1.3 seconds
2025-03-09 08:32:01,428 [INFO]: 		Total: 16.7 minutes
2025-03-09 08:32:01,428 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0001 secs
2025-03-09 08:32:01,428 [INFO]: 	Checking that your have enough memory available to create the index 03/09/2025, 08:32:01
2025-03-09 08:32:01,428 [INFO]: 502.3MB of memory will be needed to build the index (more might be used if you have more)
2025-03-09 08:32:01,428 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0001 secs
2025-03-09 08:32:01,428 [INFO]: 	Selecting most promising index types given data characteristics 03/09/2025, 08:32:01
2025-03-09 08:32:01,428 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-09 08:32:01,428 [INFO]: 	Creating the index 03/09/2025, 08:32:01
2025-03-09 08:32:01,428 [INFO]: 		-> Instanciate the index HNSW15 03/09/2025, 08:32:01
2025-03-09 08:32:01,429 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0009 secs
2025-03-09 08:32:01,429 [INFO]: 		-> Adding the vectors to the index 03/09/2025, 08:32:01
2025-03-09 08:32:01,429 [INFO]: The memory available for adding the vectors is 49.6GB(total available - used by the index)
2025-03-09 08:32:01,429 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/10 [00:00<?, ?it/s] 10%|█         | 1/10 [00:00<00:00,  9.30it/s] 50%|█████     | 5/10 [00:00<00:00, 24.13it/s]100%|██████████| 10/10 [00:02<00:00,  3.59it/s]100%|██████████| 10/10 [00:02<00:00,  4.17it/s]
2025-03-09 08:32:03,832 [INFO]: 	Computing best hyperparameters for index knn.index 03/09/2025, 08:32:03
2025-03-09 08:32:33,139 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 29.3062 secs
2025-03-09 08:32:33,139 [INFO]: The best hyperparameters are: efSearch=251
2025-03-09 08:32:33,139 [INFO]: 	Compute fast metrics 03/09/2025, 08:32:33
  0%|          | 0/4 [00:00<?, ?it/s] 25%|██▌       | 1/4 [00:00<00:00,  9.49it/s] 75%|███████▌  | 3/4 [00:00<00:00, 14.49it/s]
2025-03-09 08:32:47,106 [INFO]: 	>>> Finished "Compute fast metrics" in 13.9667 secs
2025-03-09 08:32:47,108 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 45.6788 secs
2025-03-09 08:32:47,108 [INFO]: {
2025-03-09 08:32:47,108 [INFO]: 	index_key: HNSW15
2025-03-09 08:32:47,108 [INFO]: 	index_param: efSearch=251
2025-03-09 08:32:47,108 [INFO]: 	index_path: knn.index
2025-03-09 08:32:47,108 [INFO]: 	size in bytes: 478874350
2025-03-09 08:32:47,108 [INFO]: 	avg_search_speed_ms: 11.306620514977954
2025-03-09 08:32:47,108 [INFO]: 	99p_search_speed_ms: 24.619088936597063
2025-03-09 08:32:47,108 [INFO]: 	reconstruction error %: 0.0
2025-03-09 08:32:47,108 [INFO]: 	nb vectors: 2434
2025-03-09 08:32:47,108 [INFO]: 	vectors dimension: 49152
2025-03-09 08:32:47,108 [INFO]: 	compression ratio: 0.9993098857769267
2025-03-09 08:32:47,108 [INFO]: }
2025-03-09 08:32:47,108 [INFO]: 	>>> Finished "Creating the index" in 45.6801 secs
2025-03-09 08:32:47,108 [INFO]: >>> Finished "Launching the whole pipeline" in 45.7112 secs
2025-03-09 08:32:47: [retrieval_preprocessing] calculating distances ...
2025-03-09 08:32:48: [retrieval_preprocessing] finished and saved retrieval indices for episode 76858 [episode count 11/20]
[retrieval_preprocessing] for episode 31292 [episode count 12/20], we have num_retrieval=np.int64(2375) num_query=np.int64(149)
2025-03-09 08:32:48,238 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-09 08:32:48,522 [INFO]: Launching the whole pipeline 03/09/2025, 08:32:48
2025-03-09 08:32:48,522 [INFO]: Reading total number of vectors and dimension 03/09/2025, 08:32:48
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 2319.86it/s]
2025-03-09 08:32:48,546 [INFO]: There are 2375 embeddings of dim 49152
2025-03-09 08:32:48,546 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0237 secs
2025-03-09 08:32:48,546 [INFO]: 	Compute estimated construction time of the index 03/09/2025, 08:32:48
2025-03-09 08:32:48,546 [INFO]: 		-> Train: 16.7 minutes
2025-03-09 08:32:48,546 [INFO]: 		-> Add: 1.3 seconds
2025-03-09 08:32:48,546 [INFO]: 		Total: 16.7 minutes
2025-03-09 08:32:48,546 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0001 secs
2025-03-09 08:32:48,546 [INFO]: 	Checking that your have enough memory available to create the index 03/09/2025, 08:32:48
2025-03-09 08:32:48,546 [INFO]: 490.1MB of memory will be needed to build the index (more might be used if you have more)
2025-03-09 08:32:48,546 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0001 secs
2025-03-09 08:32:48,546 [INFO]: 	Selecting most promising index types given data characteristics 03/09/2025, 08:32:48
2025-03-09 08:32:48,546 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-09 08:32:48,546 [INFO]: 	Creating the index 03/09/2025, 08:32:48
2025-03-09 08:32:48,546 [INFO]: 		-> Instanciate the index HNSW15 03/09/2025, 08:32:48
2025-03-09 08:32:48,547 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0009 secs
2025-03-09 08:32:48,547 [INFO]: 		-> Adding the vectors to the index 03/09/2025, 08:32:48
2025-03-09 08:32:48,547 [INFO]: The memory available for adding the vectors is 49.6GB(total available - used by the index)
2025-03-09 08:32:48,547 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/10 [00:00<?, ?it/s] 10%|█         | 1/10 [00:00<00:01,  7.80it/s] 70%|███████   | 7/10 [00:00<00:00, 33.03it/s]100%|██████████| 10/10 [00:01<00:00,  5.26it/s]
2025-03-09 08:32:50,450 [INFO]: 	Computing best hyperparameters for index knn.index 03/09/2025, 08:32:50
2025-03-09 08:33:18,438 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 27.9879 secs
2025-03-09 08:33:18,439 [INFO]: The best hyperparameters are: efSearch=282
2025-03-09 08:33:18,439 [INFO]: 	Compute fast metrics 03/09/2025, 08:33:18
  0%|          | 0/4 [00:00<?, ?it/s] 75%|███████▌  | 3/4 [00:00<00:00, 26.35it/s] 75%|███████▌  | 3/4 [00:00<00:00, 22.99it/s]
2025-03-09 08:33:32,434 [INFO]: 	>>> Finished "Compute fast metrics" in 13.9954 secs
2025-03-09 08:33:32,436 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 43.8884 secs
2025-03-09 08:33:32,436 [INFO]: {
2025-03-09 08:33:32,436 [INFO]: 	index_key: HNSW15
2025-03-09 08:33:32,436 [INFO]: 	index_param: efSearch=282
2025-03-09 08:33:32,436 [INFO]: 	index_path: knn.index
2025-03-09 08:33:32,436 [INFO]: 	size in bytes: 467266570
2025-03-09 08:33:32,436 [INFO]: 	avg_search_speed_ms: 11.159551753995142
2025-03-09 08:33:32,436 [INFO]: 	99p_search_speed_ms: 24.815080733969786
2025-03-09 08:33:32,436 [INFO]: 	reconstruction error %: 0.0
2025-03-09 08:33:32,436 [INFO]: 	nb vectors: 2375
2025-03-09 08:33:32,436 [INFO]: 	vectors dimension: 49152
2025-03-09 08:33:32,436 [INFO]: 	compression ratio: 0.9993096660007156
2025-03-09 08:33:32,436 [INFO]: }
2025-03-09 08:33:32,436 [INFO]: 	>>> Finished "Creating the index" in 43.8898 secs
2025-03-09 08:33:32,436 [INFO]: >>> Finished "Launching the whole pipeline" in 43.9140 secs
2025-03-09 08:33:33: [retrieval_preprocessing] calculating distances ...
2025-03-09 08:33:34: [retrieval_preprocessing] finished and saved retrieval indices for episode 31292 [episode count 12/20]
[retrieval_preprocessing] for episode 31293 [episode count 13/20], we have num_retrieval=np.int64(2411) num_query=np.int64(113)
2025-03-09 08:33:34,379 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-09 08:33:34,663 [INFO]: Launching the whole pipeline 03/09/2025, 08:33:34
2025-03-09 08:33:34,663 [INFO]: Reading total number of vectors and dimension 03/09/2025, 08:33:34
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 2256.22it/s]
2025-03-09 08:33:34,691 [INFO]: There are 2411 embeddings of dim 49152
2025-03-09 08:33:34,691 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0275 secs
2025-03-09 08:33:34,691 [INFO]: 	Compute estimated construction time of the index 03/09/2025, 08:33:34
2025-03-09 08:33:34,691 [INFO]: 		-> Train: 16.7 minutes
2025-03-09 08:33:34,691 [INFO]: 		-> Add: 1.3 seconds
2025-03-09 08:33:34,691 [INFO]: 		Total: 16.7 minutes
2025-03-09 08:33:34,691 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0001 secs
2025-03-09 08:33:34,691 [INFO]: 	Checking that your have enough memory available to create the index 03/09/2025, 08:33:34
2025-03-09 08:33:34,691 [INFO]: 497.6MB of memory will be needed to build the index (more might be used if you have more)
2025-03-09 08:33:34,691 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0001 secs
2025-03-09 08:33:34,691 [INFO]: 	Selecting most promising index types given data characteristics 03/09/2025, 08:33:34
2025-03-09 08:33:34,691 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-09 08:33:34,691 [INFO]: 	Creating the index 03/09/2025, 08:33:34
2025-03-09 08:33:34,691 [INFO]: 		-> Instanciate the index HNSW15 03/09/2025, 08:33:34
2025-03-09 08:33:34,692 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0009 secs
2025-03-09 08:33:34,692 [INFO]: 		-> Adding the vectors to the index 03/09/2025, 08:33:34
2025-03-09 08:33:34,692 [INFO]: The memory available for adding the vectors is 49.6GB(total available - used by the index)
2025-03-09 08:33:34,693 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/10 [00:00<?, ?it/s] 20%|██        | 2/10 [00:00<00:00, 17.78it/s] 80%|████████  | 8/10 [00:00<00:00, 37.60it/s]100%|██████████| 10/10 [00:01<00:00,  5.01it/s]
2025-03-09 08:33:36,691 [INFO]: 	Computing best hyperparameters for index knn.index 03/09/2025, 08:33:36
2025-03-09 08:34:03,831 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 27.1402 secs
2025-03-09 08:34:03,832 [INFO]: The best hyperparameters are: efSearch=228
2025-03-09 08:34:03,832 [INFO]: 	Compute fast metrics 03/09/2025, 08:34:03
  0%|          | 0/4 [00:00<?, ?it/s] 75%|███████▌  | 3/4 [00:00<00:00, 27.62it/s] 75%|███████▌  | 3/4 [00:00<00:00, 23.58it/s]
2025-03-09 08:34:18,278 [INFO]: 	>>> Finished "Compute fast metrics" in 14.4466 secs
2025-03-09 08:34:18,280 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 43.5874 secs
2025-03-09 08:34:18,280 [INFO]: {
2025-03-09 08:34:18,280 [INFO]: 	index_key: HNSW15
2025-03-09 08:34:18,280 [INFO]: 	index_param: efSearch=228
2025-03-09 08:34:18,280 [INFO]: 	index_path: knn.index
2025-03-09 08:34:18,280 [INFO]: 	size in bytes: 474349330
2025-03-09 08:34:18,280 [INFO]: 	avg_search_speed_ms: 9.7453494791802
2025-03-09 08:34:18,280 [INFO]: 	99p_search_speed_ms: 23.173006309662014
2025-03-09 08:34:18,280 [INFO]: 	reconstruction error %: 0.0
2025-03-09 08:34:18,280 [INFO]: 	nb vectors: 2411
2025-03-09 08:34:18,280 [INFO]: 	vectors dimension: 49152
2025-03-09 08:34:18,280 [INFO]: 	compression ratio: 0.9993097028301906
2025-03-09 08:34:18,280 [INFO]: }
2025-03-09 08:34:18,280 [INFO]: 	>>> Finished "Creating the index" in 43.5887 secs
2025-03-09 08:34:18,280 [INFO]: >>> Finished "Launching the whole pipeline" in 43.6167 secs
2025-03-09 08:34:19: [retrieval_preprocessing] calculating distances ...
2025-03-09 08:34:19: [retrieval_preprocessing] finished and saved retrieval indices for episode 31293 [episode count 13/20]
[retrieval_preprocessing] for episode 61501 [episode count 14/20], we have num_retrieval=np.int64(2408) num_query=np.int64(116)
2025-03-09 08:34:19,739 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-09 08:34:20,091 [INFO]: Launching the whole pipeline 03/09/2025, 08:34:20
2025-03-09 08:34:20,091 [INFO]: Reading total number of vectors and dimension 03/09/2025, 08:34:20
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 2221.56it/s]
2025-03-09 08:34:20,116 [INFO]: There are 2408 embeddings of dim 49152
2025-03-09 08:34:20,116 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0248 secs
2025-03-09 08:34:20,116 [INFO]: 	Compute estimated construction time of the index 03/09/2025, 08:34:20
2025-03-09 08:34:20,116 [INFO]: 		-> Train: 16.7 minutes
2025-03-09 08:34:20,116 [INFO]: 		-> Add: 1.3 seconds
2025-03-09 08:34:20,117 [INFO]: 		Total: 16.7 minutes
2025-03-09 08:34:20,117 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0001 secs
2025-03-09 08:34:20,117 [INFO]: 	Checking that your have enough memory available to create the index 03/09/2025, 08:34:20
2025-03-09 08:34:20,117 [INFO]: 497.0MB of memory will be needed to build the index (more might be used if you have more)
2025-03-09 08:34:20,117 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0001 secs
2025-03-09 08:34:20,117 [INFO]: 	Selecting most promising index types given data characteristics 03/09/2025, 08:34:20
2025-03-09 08:34:20,117 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-09 08:34:20,117 [INFO]: 	Creating the index 03/09/2025, 08:34:20
2025-03-09 08:34:20,117 [INFO]: 		-> Instanciate the index HNSW15 03/09/2025, 08:34:20
2025-03-09 08:34:20,118 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0009 secs
2025-03-09 08:34:20,118 [INFO]: 		-> Adding the vectors to the index 03/09/2025, 08:34:20
2025-03-09 08:34:20,118 [INFO]: The memory available for adding the vectors is 49.6GB(total available - used by the index)
2025-03-09 08:34:20,118 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/10 [00:00<?, ?it/s] 20%|██        | 2/10 [00:00<00:00, 18.31it/s] 80%|████████  | 8/10 [00:00<00:00, 39.28it/s]100%|██████████| 10/10 [00:01<00:00,  5.36it/s]
2025-03-09 08:34:21,986 [INFO]: 	Computing best hyperparameters for index knn.index 03/09/2025, 08:34:21
2025-03-09 08:34:47,030 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 25.0431 secs
2025-03-09 08:34:47,030 [INFO]: The best hyperparameters are: efSearch=220
2025-03-09 08:34:47,030 [INFO]: 	Compute fast metrics 03/09/2025, 08:34:47
  0%|          | 0/4 [00:00<?, ?it/s] 75%|███████▌  | 3/4 [00:00<00:00, 25.52it/s] 75%|███████▌  | 3/4 [00:00<00:00, 21.93it/s]
2025-03-09 08:35:01,286 [INFO]: 	>>> Finished "Compute fast metrics" in 14.2562 secs
2025-03-09 08:35:01,340 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 41.2223 secs
2025-03-09 08:35:01,341 [INFO]: {
2025-03-09 08:35:01,341 [INFO]: 	index_key: HNSW15
2025-03-09 08:35:01,341 [INFO]: 	index_param: efSearch=220
2025-03-09 08:35:01,341 [INFO]: 	index_path: knn.index
2025-03-09 08:35:01,341 [INFO]: 	size in bytes: 473759110
2025-03-09 08:35:01,341 [INFO]: 	avg_search_speed_ms: 10.323678918703775
2025-03-09 08:35:01,341 [INFO]: 	99p_search_speed_ms: 22.563055101782037
2025-03-09 08:35:01,341 [INFO]: 	reconstruction error %: 0.0
2025-03-09 08:35:01,341 [INFO]: 	nb vectors: 2408
2025-03-09 08:35:01,341 [INFO]: 	vectors dimension: 49152
2025-03-09 08:35:01,341 [INFO]: 	compression ratio: 0.9993096787099249
2025-03-09 08:35:01,341 [INFO]: }
2025-03-09 08:35:01,341 [INFO]: 	>>> Finished "Creating the index" in 41.2244 secs
2025-03-09 08:35:01,341 [INFO]: >>> Finished "Launching the whole pipeline" in 41.2499 secs
2025-03-09 08:35:01: [retrieval_preprocessing] calculating distances ...
2025-03-09 08:35:02: [retrieval_preprocessing] finished and saved retrieval indices for episode 61501 [episode count 14/20]
[retrieval_preprocessing] for episode 5187 [episode count 15/20], we have num_retrieval=np.int64(2443) num_query=np.int64(81)
2025-03-09 08:35:02,439 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-09 08:35:02,770 [INFO]: Launching the whole pipeline 03/09/2025, 08:35:02
2025-03-09 08:35:02,770 [INFO]: Reading total number of vectors and dimension 03/09/2025, 08:35:02
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 2251.37it/s]
2025-03-09 08:35:02,799 [INFO]: There are 2443 embeddings of dim 49152
2025-03-09 08:35:02,799 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0285 secs
2025-03-09 08:35:02,799 [INFO]: 	Compute estimated construction time of the index 03/09/2025, 08:35:02
2025-03-09 08:35:02,799 [INFO]: 		-> Train: 16.7 minutes
2025-03-09 08:35:02,799 [INFO]: 		-> Add: 1.3 seconds
2025-03-09 08:35:02,799 [INFO]: 		Total: 16.7 minutes
2025-03-09 08:35:02,799 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0001 secs
2025-03-09 08:35:02,799 [INFO]: 	Checking that your have enough memory available to create the index 03/09/2025, 08:35:02
2025-03-09 08:35:02,799 [INFO]: 504.2MB of memory will be needed to build the index (more might be used if you have more)
2025-03-09 08:35:02,799 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0001 secs
2025-03-09 08:35:02,799 [INFO]: 	Selecting most promising index types given data characteristics 03/09/2025, 08:35:02
2025-03-09 08:35:02,799 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-09 08:35:02,799 [INFO]: 	Creating the index 03/09/2025, 08:35:02
2025-03-09 08:35:02,800 [INFO]: 		-> Instanciate the index HNSW15 03/09/2025, 08:35:02
2025-03-09 08:35:02,800 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0009 secs
2025-03-09 08:35:02,801 [INFO]: 		-> Adding the vectors to the index 03/09/2025, 08:35:02
2025-03-09 08:35:02,801 [INFO]: The memory available for adding the vectors is 49.6GB(total available - used by the index)
2025-03-09 08:35:02,801 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/10 [00:00<?, ?it/s] 20%|██        | 2/10 [00:00<00:00, 18.93it/s] 80%|████████  | 8/10 [00:00<00:00, 39.96it/s]100%|██████████| 10/10 [00:01<00:00,  5.09it/s]
2025-03-09 08:35:04,768 [INFO]: 	Computing best hyperparameters for index knn.index 03/09/2025, 08:35:04
2025-03-09 08:35:34,330 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 29.5618 secs
2025-03-09 08:35:34,330 [INFO]: The best hyperparameters are: efSearch=287
2025-03-09 08:35:34,331 [INFO]: 	Compute fast metrics 03/09/2025, 08:35:34
  0%|          | 0/4 [00:00<?, ?it/s] 50%|█████     | 2/4 [00:00<00:00, 19.15it/s] 75%|███████▌  | 3/4 [00:00<00:00, 20.03it/s]
2025-03-09 08:35:48,769 [INFO]: 	>>> Finished "Compute fast metrics" in 14.4380 secs
2025-03-09 08:35:48,770 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 45.9696 secs
2025-03-09 08:35:48,770 [INFO]: {
2025-03-09 08:35:48,770 [INFO]: 	index_key: HNSW15
2025-03-09 08:35:48,770 [INFO]: 	index_param: efSearch=287
2025-03-09 08:35:48,770 [INFO]: 	index_path: knn.index
2025-03-09 08:35:48,770 [INFO]: 	size in bytes: 480645010
2025-03-09 08:35:48,770 [INFO]: 	avg_search_speed_ms: 12.055133076956922
2025-03-09 08:35:48,770 [INFO]: 	99p_search_speed_ms: 17.632857025600995
2025-03-09 08:35:48,770 [INFO]: 	reconstruction error %: 0.0
2025-03-09 08:35:48,770 [INFO]: 	nb vectors: 2443
2025-03-09 08:35:48,770 [INFO]: 	vectors dimension: 49152
2025-03-09 08:35:48,770 [INFO]: 	compression ratio: 0.9993099564270936
2025-03-09 08:35:48,770 [INFO]: }
2025-03-09 08:35:48,770 [INFO]: 	>>> Finished "Creating the index" in 45.9709 secs
2025-03-09 08:35:48,770 [INFO]: >>> Finished "Launching the whole pipeline" in 46.0000 secs
2025-03-09 08:35:49: [retrieval_preprocessing] calculating distances ...
2025-03-09 08:35:49: [retrieval_preprocessing] finished and saved retrieval indices for episode 5187 [episode count 15/20]
[retrieval_preprocessing] for episode 59461 [episode count 16/20], we have num_retrieval=np.int64(2444) num_query=np.int64(80)
2025-03-09 08:35:49,924 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-09 08:35:50,310 [INFO]: Launching the whole pipeline 03/09/2025, 08:35:50
2025-03-09 08:35:50,310 [INFO]: Reading total number of vectors and dimension 03/09/2025, 08:35:50
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1731.75it/s]
2025-03-09 08:35:50,336 [INFO]: There are 2444 embeddings of dim 49152
2025-03-09 08:35:50,336 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0259 secs
2025-03-09 08:35:50,336 [INFO]: 	Compute estimated construction time of the index 03/09/2025, 08:35:50
2025-03-09 08:35:50,336 [INFO]: 		-> Train: 16.7 minutes
2025-03-09 08:35:50,336 [INFO]: 		-> Add: 1.3 seconds
2025-03-09 08:35:50,336 [INFO]: 		Total: 16.7 minutes
2025-03-09 08:35:50,336 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0001 secs
2025-03-09 08:35:50,337 [INFO]: 	Checking that your have enough memory available to create the index 03/09/2025, 08:35:50
2025-03-09 08:35:50,337 [INFO]: 504.4MB of memory will be needed to build the index (more might be used if you have more)
2025-03-09 08:35:50,337 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0002 secs
2025-03-09 08:35:50,337 [INFO]: 	Selecting most promising index types given data characteristics 03/09/2025, 08:35:50
2025-03-09 08:35:50,337 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-09 08:35:50,337 [INFO]: 	Creating the index 03/09/2025, 08:35:50
2025-03-09 08:35:50,337 [INFO]: 		-> Instanciate the index HNSW15 03/09/2025, 08:35:50
2025-03-09 08:35:50,338 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0011 secs
2025-03-09 08:35:50,338 [INFO]: 		-> Adding the vectors to the index 03/09/2025, 08:35:50
2025-03-09 08:35:50,338 [INFO]: The memory available for adding the vectors is 49.6GB(total available - used by the index)
2025-03-09 08:35:50,338 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/10 [00:00<?, ?it/s] 20%|██        | 2/10 [00:00<00:00, 19.59it/s] 80%|████████  | 8/10 [00:00<00:00, 40.88it/s]100%|██████████| 10/10 [00:02<00:00,  4.70it/s]
2025-03-09 08:35:52,468 [INFO]: 	Computing best hyperparameters for index knn.index 03/09/2025, 08:35:52
2025-03-09 08:36:18,211 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 25.7427 secs
2025-03-09 08:36:18,211 [INFO]: The best hyperparameters are: efSearch=351
2025-03-09 08:36:18,212 [INFO]: 	Compute fast metrics 03/09/2025, 08:36:18
  0%|          | 0/4 [00:00<?, ?it/s] 50%|█████     | 2/4 [00:00<00:00, 16.39it/s] 75%|███████▌  | 3/4 [00:00<00:00, 16.17it/s]
2025-03-09 08:36:35,825 [INFO]: 	>>> Finished "Compute fast metrics" in 17.6135 secs
2025-03-09 08:36:35,827 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 45.4885 secs
2025-03-09 08:36:35,827 [INFO]: {
2025-03-09 08:36:35,827 [INFO]: 	index_key: HNSW15
2025-03-09 08:36:35,827 [INFO]: 	index_param: efSearch=351
2025-03-09 08:36:35,827 [INFO]: 	index_path: knn.index
2025-03-09 08:36:35,827 [INFO]: 	size in bytes: 480841750
2025-03-09 08:36:35,827 [INFO]: 	avg_search_speed_ms: 16.18576846062884
2025-03-09 08:36:35,827 [INFO]: 	99p_search_speed_ms: 37.495597079396255
2025-03-09 08:36:35,827 [INFO]: 	reconstruction error %: 0.0
2025-03-09 08:36:35,827 [INFO]: 	nb vectors: 2444
2025-03-09 08:36:35,827 [INFO]: 	vectors dimension: 49152
2025-03-09 08:36:35,827 [INFO]: 	compression ratio: 0.9993099642449933
2025-03-09 08:36:35,827 [INFO]: }
2025-03-09 08:36:35,827 [INFO]: 	>>> Finished "Creating the index" in 45.4900 secs
2025-03-09 08:36:35,827 [INFO]: >>> Finished "Launching the whole pipeline" in 45.5165 secs
2025-03-09 08:36:37: [retrieval_preprocessing] calculating distances ...
2025-03-09 08:36:37: [retrieval_preprocessing] finished and saved retrieval indices for episode 59461 [episode count 16/20]
[retrieval_preprocessing] for episode 38470 [episode count 17/20], we have num_retrieval=np.int64(2438) num_query=np.int64(86)
2025-03-09 08:36:37,533 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-09 08:36:37,898 [INFO]: Launching the whole pipeline 03/09/2025, 08:36:37
2025-03-09 08:36:37,898 [INFO]: Reading total number of vectors and dimension 03/09/2025, 08:36:37
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1055.97it/s]
2025-03-09 08:36:37,932 [INFO]: There are 2438 embeddings of dim 49152
2025-03-09 08:36:37,932 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0347 secs
2025-03-09 08:36:37,933 [INFO]: 	Compute estimated construction time of the index 03/09/2025, 08:36:37
2025-03-09 08:36:37,933 [INFO]: 		-> Train: 16.7 minutes
2025-03-09 08:36:37,933 [INFO]: 		-> Add: 1.3 seconds
2025-03-09 08:36:37,933 [INFO]: 		Total: 16.7 minutes
2025-03-09 08:36:37,933 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0003 secs
2025-03-09 08:36:37,933 [INFO]: 	Checking that your have enough memory available to create the index 03/09/2025, 08:36:37
2025-03-09 08:36:37,933 [INFO]: 503.1MB of memory will be needed to build the index (more might be used if you have more)
2025-03-09 08:36:37,934 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0005 secs
2025-03-09 08:36:37,934 [INFO]: 	Selecting most promising index types given data characteristics 03/09/2025, 08:36:37
2025-03-09 08:36:37,934 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-09 08:36:37,934 [INFO]: 	Creating the index 03/09/2025, 08:36:37
2025-03-09 08:36:37,934 [INFO]: 		-> Instanciate the index HNSW15 03/09/2025, 08:36:37
2025-03-09 08:36:37,937 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0027 secs
2025-03-09 08:36:37,937 [INFO]: 		-> Adding the vectors to the index 03/09/2025, 08:36:37
2025-03-09 08:36:37,937 [INFO]: The memory available for adding the vectors is 49.6GB(total available - used by the index)
2025-03-09 08:36:37,937 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/10 [00:00<?, ?it/s] 10%|█         | 1/10 [00:00<00:01,  8.40it/s] 70%|███████   | 7/10 [00:00<00:00, 33.31it/s]100%|██████████| 10/10 [00:02<00:00,  4.13it/s]
2025-03-09 08:36:40,367 [INFO]: 	Computing best hyperparameters for index knn.index 03/09/2025, 08:36:40
2025-03-09 08:37:07,527 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 27.1596 secs
2025-03-09 08:37:07,527 [INFO]: The best hyperparameters are: efSearch=255
2025-03-09 08:37:07,527 [INFO]: 	Compute fast metrics 03/09/2025, 08:37:07
  0%|          | 0/4 [00:00<?, ?it/s] 50%|█████     | 2/4 [00:00<00:00, 18.20it/s] 75%|███████▌  | 3/4 [00:00<00:00, 19.54it/s]
2025-03-09 08:37:21,999 [INFO]: 	>>> Finished "Compute fast metrics" in 14.4717 secs
2025-03-09 08:37:22,001 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 44.0637 secs
2025-03-09 08:37:22,001 [INFO]: {
2025-03-09 08:37:22,001 [INFO]: 	index_key: HNSW15
2025-03-09 08:37:22,001 [INFO]: 	index_param: efSearch=255
2025-03-09 08:37:22,001 [INFO]: 	index_path: knn.index
2025-03-09 08:37:22,001 [INFO]: 	size in bytes: 479661310
2025-03-09 08:37:22,001 [INFO]: 	avg_search_speed_ms: 11.898624829507204
2025-03-09 08:37:22,001 [INFO]: 	99p_search_speed_ms: 25.602723658084884
2025-03-09 08:37:22,001 [INFO]: 	reconstruction error %: 0.0
2025-03-09 08:37:22,001 [INFO]: 	nb vectors: 2438
2025-03-09 08:37:22,001 [INFO]: 	vectors dimension: 49152
2025-03-09 08:37:22,001 [INFO]: 	compression ratio: 0.9993099172413968
2025-03-09 08:37:22,001 [INFO]: }
2025-03-09 08:37:22,001 [INFO]: 	>>> Finished "Creating the index" in 44.0672 secs
2025-03-09 08:37:22,001 [INFO]: >>> Finished "Launching the whole pipeline" in 44.1035 secs
2025-03-09 08:37:22: [retrieval_preprocessing] calculating distances ...
2025-03-09 08:37:23: [retrieval_preprocessing] finished and saved retrieval indices for episode 38470 [episode count 17/20]
[retrieval_preprocessing] for episode 48715 [episode count 18/20], we have num_retrieval=np.int64(2378) num_query=np.int64(146)
2025-03-09 08:37:23,206 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-09 08:37:23,617 [INFO]: Launching the whole pipeline 03/09/2025, 08:37:23
2025-03-09 08:37:23,617 [INFO]: Reading total number of vectors and dimension 03/09/2025, 08:37:23
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 2221.56it/s]
2025-03-09 08:37:23,642 [INFO]: There are 2378 embeddings of dim 49152
2025-03-09 08:37:23,642 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0249 secs
2025-03-09 08:37:23,642 [INFO]: 	Compute estimated construction time of the index 03/09/2025, 08:37:23
2025-03-09 08:37:23,643 [INFO]: 		-> Train: 16.7 minutes
2025-03-09 08:37:23,643 [INFO]: 		-> Add: 1.3 seconds
2025-03-09 08:37:23,643 [INFO]: 		Total: 16.7 minutes
2025-03-09 08:37:23,643 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0001 secs
2025-03-09 08:37:23,643 [INFO]: 	Checking that your have enough memory available to create the index 03/09/2025, 08:37:23
2025-03-09 08:37:23,643 [INFO]: 490.8MB of memory will be needed to build the index (more might be used if you have more)
2025-03-09 08:37:23,643 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0002 secs
2025-03-09 08:37:23,643 [INFO]: 	Selecting most promising index types given data characteristics 03/09/2025, 08:37:23
2025-03-09 08:37:23,643 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-09 08:37:23,643 [INFO]: 	Creating the index 03/09/2025, 08:37:23
2025-03-09 08:37:23,643 [INFO]: 		-> Instanciate the index HNSW15 03/09/2025, 08:37:23
2025-03-09 08:37:23,644 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0011 secs
2025-03-09 08:37:23,644 [INFO]: 		-> Adding the vectors to the index 03/09/2025, 08:37:23
2025-03-09 08:37:23,644 [INFO]: The memory available for adding the vectors is 49.6GB(total available - used by the index)
2025-03-09 08:37:23,645 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/10 [00:00<?, ?it/s] 20%|██        | 2/10 [00:00<00:00, 15.77it/s] 70%|███████   | 7/10 [00:00<00:00, 32.51it/s]100%|██████████| 10/10 [00:01<00:00,  5.43it/s]
2025-03-09 08:37:25,489 [INFO]: 	Computing best hyperparameters for index knn.index 03/09/2025, 08:37:25
2025-03-09 08:37:52,855 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 27.3651 secs
2025-03-09 08:37:52,855 [INFO]: The best hyperparameters are: efSearch=281
2025-03-09 08:37:52,855 [INFO]: 	Compute fast metrics 03/09/2025, 08:37:52
  0%|          | 0/4 [00:00<?, ?it/s] 50%|█████     | 2/4 [00:00<00:00, 18.66it/s] 75%|███████▌  | 3/4 [00:00<00:00, 19.81it/s]
2025-03-09 08:38:10,522 [INFO]: 	>>> Finished "Compute fast metrics" in 17.6665 secs
2025-03-09 08:38:10,523 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 46.8789 secs
2025-03-09 08:38:10,524 [INFO]: {
2025-03-09 08:38:10,524 [INFO]: 	index_key: HNSW15
2025-03-09 08:38:10,524 [INFO]: 	index_param: efSearch=281
2025-03-09 08:38:10,524 [INFO]: 	index_path: knn.index
2025-03-09 08:38:10,524 [INFO]: 	size in bytes: 467856790
2025-03-09 08:38:10,524 [INFO]: 	avg_search_speed_ms: 11.208168134741978
2025-03-09 08:38:10,524 [INFO]: 	99p_search_speed_ms: 18.997110184282064
2025-03-09 08:38:10,524 [INFO]: 	reconstruction error %: 0.0
2025-03-09 08:38:10,524 [INFO]: 	nb vectors: 2378
2025-03-09 08:38:10,524 [INFO]: 	vectors dimension: 49152
2025-03-09 08:38:10,524 [INFO]: 	compression ratio: 0.999309690471736
2025-03-09 08:38:10,524 [INFO]: }
2025-03-09 08:38:10,524 [INFO]: 	>>> Finished "Creating the index" in 46.8807 secs
2025-03-09 08:38:10,524 [INFO]: >>> Finished "Launching the whole pipeline" in 46.9063 secs
2025-03-09 08:38:11: [retrieval_preprocessing] calculating distances ...
2025-03-09 08:38:12: [retrieval_preprocessing] finished and saved retrieval indices for episode 48715 [episode count 18/20]
[retrieval_preprocessing] for episode 91725 [episode count 19/20], we have num_retrieval=np.int64(2359) num_query=np.int64(165)
2025-03-09 08:38:12,607 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-09 08:38:12,998 [INFO]: Launching the whole pipeline 03/09/2025, 08:38:12
2025-03-09 08:38:12,998 [INFO]: Reading total number of vectors and dimension 03/09/2025, 08:38:12
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1343.47it/s]
2025-03-09 08:38:13,033 [INFO]: There are 2359 embeddings of dim 49152
2025-03-09 08:38:13,033 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0349 secs
2025-03-09 08:38:13,033 [INFO]: 	Compute estimated construction time of the index 03/09/2025, 08:38:13
2025-03-09 08:38:13,033 [INFO]: 		-> Train: 16.7 minutes
2025-03-09 08:38:13,033 [INFO]: 		-> Add: 1.3 seconds
2025-03-09 08:38:13,033 [INFO]: 		Total: 16.7 minutes
2025-03-09 08:38:13,033 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0001 secs
2025-03-09 08:38:13,033 [INFO]: 	Checking that your have enough memory available to create the index 03/09/2025, 08:38:13
2025-03-09 08:38:13,033 [INFO]: 486.8MB of memory will be needed to build the index (more might be used if you have more)
2025-03-09 08:38:13,033 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0002 secs
2025-03-09 08:38:13,033 [INFO]: 	Selecting most promising index types given data characteristics 03/09/2025, 08:38:13
2025-03-09 08:38:13,033 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-09 08:38:13,033 [INFO]: 	Creating the index 03/09/2025, 08:38:13
2025-03-09 08:38:13,034 [INFO]: 		-> Instanciate the index HNSW15 03/09/2025, 08:38:13
2025-03-09 08:38:13,035 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0011 secs
2025-03-09 08:38:13,035 [INFO]: 		-> Adding the vectors to the index 03/09/2025, 08:38:13
2025-03-09 08:38:13,035 [INFO]: The memory available for adding the vectors is 49.6GB(total available - used by the index)
2025-03-09 08:38:13,035 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/10 [00:00<?, ?it/s] 10%|█         | 1/10 [00:00<00:00,  9.98it/s] 60%|██████    | 6/10 [00:00<00:00, 32.10it/s]100%|██████████| 10/10 [00:01<00:00,  4.67it/s]100%|██████████| 10/10 [00:01<00:00,  5.57it/s]
2025-03-09 08:38:14,833 [INFO]: 	Computing best hyperparameters for index knn.index 03/09/2025, 08:38:14
2025-03-09 08:38:40,417 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 25.5834 secs
2025-03-09 08:38:40,417 [INFO]: The best hyperparameters are: efSearch=211
2025-03-09 08:38:40,417 [INFO]: 	Compute fast metrics 03/09/2025, 08:38:40
  0%|          | 0/4 [00:00<?, ?it/s] 50%|█████     | 2/4 [00:00<00:00, 18.33it/s] 75%|███████▌  | 3/4 [00:00<00:00, 20.06it/s]
2025-03-09 08:38:58,663 [INFO]: 	>>> Finished "Compute fast metrics" in 18.2457 secs
2025-03-09 08:38:58,664 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 45.6292 secs
2025-03-09 08:38:58,664 [INFO]: {
2025-03-09 08:38:58,664 [INFO]: 	index_key: HNSW15
2025-03-09 08:38:58,664 [INFO]: 	index_param: efSearch=211
2025-03-09 08:38:58,664 [INFO]: 	index_path: knn.index
2025-03-09 08:38:58,664 [INFO]: 	size in bytes: 464118670
2025-03-09 08:38:58,664 [INFO]: 	avg_search_speed_ms: 8.361874665110294
2025-03-09 08:38:58,664 [INFO]: 	99p_search_speed_ms: 12.762520753312856
2025-03-09 08:38:58,664 [INFO]: 	reconstruction error %: 0.0
2025-03-09 08:38:58,664 [INFO]: 	nb vectors: 2359
2025-03-09 08:38:58,664 [INFO]: 	vectors dimension: 49152
2025-03-09 08:38:58,664 [INFO]: 	compression ratio: 0.9993096636254689
2025-03-09 08:38:58,664 [INFO]: }
2025-03-09 08:38:58,664 [INFO]: 	>>> Finished "Creating the index" in 45.6309 secs
2025-03-09 08:38:58,664 [INFO]: >>> Finished "Launching the whole pipeline" in 45.6665 secs
2025-03-09 08:38:59: [retrieval_preprocessing] calculating distances ...
2025-03-09 08:38:59: [retrieval_preprocessing] finished and saved retrieval indices for episode 91725 [episode count 19/20]
2025-03-09 08:38:59: [retrieval_preprocessing] finished for (3163748394, 'cup') [chosen_id count 5/10]
2025-03-09 08:39:02: [retrieval_preprocessing] concatenated all embeddings and indices for 20 episodes for (7644292911, 'marker') [chosen_id count 6/10]
2025-03-09 08:39:02: [retrieval_preprocessing] we have num_total=5482 embedding_dim=49152
[retrieval_preprocessing] for episode 3716 [episode count 0/20], we have num_retrieval=np.int64(5296) num_query=np.int64(186)
2025-03-09 08:39:03,436 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-09 08:39:04,391 [INFO]: Launching the whole pipeline 03/09/2025, 08:39:04
2025-03-09 08:39:04,391 [INFO]: Reading total number of vectors and dimension 03/09/2025, 08:39:04
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1352.56it/s]
2025-03-09 08:39:04,422 [INFO]: There are 5296 embeddings of dim 49152
2025-03-09 08:39:04,423 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0320 secs
2025-03-09 08:39:04,423 [INFO]: 	Compute estimated construction time of the index 03/09/2025, 08:39:04
2025-03-09 08:39:04,423 [INFO]: 		-> Train: 16.7 minutes
2025-03-09 08:39:04,423 [INFO]: 		-> Add: 2.9 seconds
2025-03-09 08:39:04,423 [INFO]: 		Total: 16.7 minutes
2025-03-09 08:39:04,423 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0001 secs
2025-03-09 08:39:04,423 [INFO]: 	Checking that your have enough memory available to create the index 03/09/2025, 08:39:04
2025-03-09 08:39:04,423 [INFO]: 1.1GB of memory will be needed to build the index (more might be used if you have more)
2025-03-09 08:39:04,423 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0003 secs
2025-03-09 08:39:04,423 [INFO]: 	Selecting most promising index types given data characteristics 03/09/2025, 08:39:04
2025-03-09 08:39:04,424 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-09 08:39:04,424 [INFO]: 	Creating the index 03/09/2025, 08:39:04
2025-03-09 08:39:04,424 [INFO]: 		-> Instanciate the index HNSW15 03/09/2025, 08:39:04
2025-03-09 08:39:04,425 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0010 secs
2025-03-09 08:39:04,425 [INFO]: 		-> Adding the vectors to the index 03/09/2025, 08:39:04
2025-03-09 08:39:04,425 [INFO]: The memory available for adding the vectors is 49.0GB(total available - used by the index)
2025-03-09 08:39:04,425 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/22 [00:00<?, ?it/s]  5%|▍         | 1/22 [00:00<00:02,  9.60it/s] 27%|██▋       | 6/22 [00:00<00:00, 31.70it/s] 50%|█████     | 11/22 [00:00<00:00, 38.99it/s] 73%|███████▎  | 16/22 [00:00<00:00, 42.49it/s] 95%|█████████▌| 21/22 [00:03<00:00,  3.50it/s]100%|██████████| 22/22 [00:04<00:00,  4.83it/s]
2025-03-09 08:39:08,987 [INFO]: 	Computing best hyperparameters for index knn.index 03/09/2025, 08:39:08
2025-03-09 08:39:49,392 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 40.4053 secs
2025-03-09 08:39:49,393 [INFO]: The best hyperparameters are: efSearch=224
2025-03-09 08:39:49,393 [INFO]: 	Compute fast metrics 03/09/2025, 08:39:49
  0%|          | 0/4 [00:00<?, ?it/s] 50%|█████     | 2/4 [00:00<00:00, 18.13it/s] 75%|███████▌  | 3/4 [00:00<00:00, 19.63it/s]
2025-03-09 08:40:04,437 [INFO]: 	>>> Finished "Compute fast metrics" in 15.0442 secs
2025-03-09 08:40:04,437 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 60.0125 secs
2025-03-09 08:40:04,437 [INFO]: {
2025-03-09 08:40:04,437 [INFO]: 	index_key: HNSW15
2025-03-09 08:40:04,437 [INFO]: 	index_param: efSearch=224
2025-03-09 08:40:04,437 [INFO]: 	index_path: knn.index
2025-03-09 08:40:04,437 [INFO]: 	size in bytes: 1041956710
2025-03-09 08:40:04,437 [INFO]: 	avg_search_speed_ms: 11.422572220775583
2025-03-09 08:40:04,437 [INFO]: 	99p_search_speed_ms: 19.891132542397827
2025-03-09 08:40:04,438 [INFO]: 	reconstruction error %: 0.0
2025-03-09 08:40:04,438 [INFO]: 	nb vectors: 5296
2025-03-09 08:40:04,438 [INFO]: 	vectors dimension: 49152
2025-03-09 08:40:04,438 [INFO]: 	compression ratio: 0.9993082802835446
2025-03-09 08:40:04,438 [INFO]: }
2025-03-09 08:40:04,438 [INFO]: 	>>> Finished "Creating the index" in 60.0140 secs
2025-03-09 08:40:04,438 [INFO]: >>> Finished "Launching the whole pipeline" in 60.0469 secs
2025-03-09 08:40:05: [retrieval_preprocessing] calculating distances ...
2025-03-09 08:40:05: [retrieval_preprocessing] finished and saved retrieval indices for episode 3716 [episode count 0/20]
[retrieval_preprocessing] for episode 68868 [episode count 1/20], we have num_retrieval=np.int64(5278) num_query=np.int64(204)
2025-03-09 08:40:06,321 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-09 08:40:07,113 [INFO]: Launching the whole pipeline 03/09/2025, 08:40:07
2025-03-09 08:40:07,114 [INFO]: Reading total number of vectors and dimension 03/09/2025, 08:40:07
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1716.16it/s]
2025-03-09 08:40:07,140 [INFO]: There are 5278 embeddings of dim 49152
2025-03-09 08:40:07,140 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0263 secs
2025-03-09 08:40:07,140 [INFO]: 	Compute estimated construction time of the index 03/09/2025, 08:40:07
2025-03-09 08:40:07,140 [INFO]: 		-> Train: 16.7 minutes
2025-03-09 08:40:07,140 [INFO]: 		-> Add: 2.9 seconds
2025-03-09 08:40:07,140 [INFO]: 		Total: 16.7 minutes
2025-03-09 08:40:07,140 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0002 secs
2025-03-09 08:40:07,140 [INFO]: 	Checking that your have enough memory available to create the index 03/09/2025, 08:40:07
2025-03-09 08:40:07,140 [INFO]: 1.1GB of memory will be needed to build the index (more might be used if you have more)
2025-03-09 08:40:07,140 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0001 secs
2025-03-09 08:40:07,140 [INFO]: 	Selecting most promising index types given data characteristics 03/09/2025, 08:40:07
2025-03-09 08:40:07,140 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-09 08:40:07,141 [INFO]: 	Creating the index 03/09/2025, 08:40:07
2025-03-09 08:40:07,141 [INFO]: 		-> Instanciate the index HNSW15 03/09/2025, 08:40:07
2025-03-09 08:40:07,142 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0009 secs
2025-03-09 08:40:07,142 [INFO]: 		-> Adding the vectors to the index 03/09/2025, 08:40:07
2025-03-09 08:40:07,142 [INFO]: The memory available for adding the vectors is 49.0GB(total available - used by the index)
2025-03-09 08:40:07,142 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/22 [00:00<?, ?it/s]  5%|▍         | 1/22 [00:00<00:02,  8.83it/s] 27%|██▋       | 6/22 [00:00<00:00, 31.62it/s] 50%|█████     | 11/22 [00:00<00:00, 39.59it/s] 73%|███████▎  | 16/22 [00:00<00:00, 41.45it/s] 95%|█████████▌| 21/22 [00:04<00:00,  3.22it/s]100%|██████████| 22/22 [00:05<00:00,  4.26it/s]
2025-03-09 08:40:12,314 [INFO]: 	Computing best hyperparameters for index knn.index 03/09/2025, 08:40:12
2025-03-09 08:41:07,471 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 55.1562 secs
2025-03-09 08:41:07,475 [INFO]: The best hyperparameters are: efSearch=176
2025-03-09 08:41:07,475 [INFO]: 	Compute fast metrics 03/09/2025, 08:41:07
  0%|          | 0/4 [00:00<?, ?it/s] 50%|█████     | 2/4 [00:00<00:00, 18.10it/s] 75%|███████▌  | 3/4 [00:00<00:00, 19.58it/s]
2025-03-09 08:41:25,667 [INFO]: 	>>> Finished "Compute fast metrics" in 18.1915 secs
2025-03-09 08:41:25,667 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 78.5258 secs
2025-03-09 08:41:25,668 [INFO]: {
2025-03-09 08:41:25,668 [INFO]: 	index_key: HNSW15
2025-03-09 08:41:25,668 [INFO]: 	index_param: efSearch=176
2025-03-09 08:41:25,668 [INFO]: 	index_path: knn.index
2025-03-09 08:41:25,668 [INFO]: 	size in bytes: 1038415330
2025-03-09 08:41:25,668 [INFO]: 	avg_search_speed_ms: 9.666676946650236
2025-03-09 08:41:25,668 [INFO]: 	99p_search_speed_ms: 21.114611336961378
2025-03-09 08:41:25,668 [INFO]: 	reconstruction error %: 0.0
2025-03-09 08:41:25,668 [INFO]: 	nb vectors: 5278
2025-03-09 08:41:25,668 [INFO]: 	vectors dimension: 49152
2025-03-09 08:41:25,668 [INFO]: 	compression ratio: 0.9993082671458635
2025-03-09 08:41:25,668 [INFO]: }
2025-03-09 08:41:25,668 [INFO]: 	>>> Finished "Creating the index" in 78.5271 secs
2025-03-09 08:41:25,668 [INFO]: >>> Finished "Launching the whole pipeline" in 78.5541 secs
2025-03-09 08:41:26: [retrieval_preprocessing] calculating distances ...
2025-03-09 08:41:27: [retrieval_preprocessing] finished and saved retrieval indices for episode 68868 [episode count 1/20]
[retrieval_preprocessing] for episode 22023 [episode count 2/20], we have num_retrieval=np.int64(5164) num_query=np.int64(318)
2025-03-09 08:41:27,710 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-09 08:41:28,781 [INFO]: Launching the whole pipeline 03/09/2025, 08:41:28
2025-03-09 08:41:28,781 [INFO]: Reading total number of vectors and dimension 03/09/2025, 08:41:28
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 999.83it/s]
2025-03-09 08:41:28,811 [INFO]: There are 5164 embeddings of dim 49152
2025-03-09 08:41:28,811 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0295 secs
2025-03-09 08:41:28,811 [INFO]: 	Compute estimated construction time of the index 03/09/2025, 08:41:28
2025-03-09 08:41:28,811 [INFO]: 		-> Train: 16.7 minutes
2025-03-09 08:41:28,811 [INFO]: 		-> Add: 2.8 seconds
2025-03-09 08:41:28,811 [INFO]: 		Total: 16.7 minutes
2025-03-09 08:41:28,811 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0001 secs
2025-03-09 08:41:28,811 [INFO]: 	Checking that your have enough memory available to create the index 03/09/2025, 08:41:28
2025-03-09 08:41:28,811 [INFO]: 1.0GB of memory will be needed to build the index (more might be used if you have more)
2025-03-09 08:41:28,811 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0001 secs
2025-03-09 08:41:28,811 [INFO]: 	Selecting most promising index types given data characteristics 03/09/2025, 08:41:28
2025-03-09 08:41:28,811 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-09 08:41:28,811 [INFO]: 	Creating the index 03/09/2025, 08:41:28
2025-03-09 08:41:28,811 [INFO]: 		-> Instanciate the index HNSW15 03/09/2025, 08:41:28
2025-03-09 08:41:28,812 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0009 secs
2025-03-09 08:41:28,812 [INFO]: 		-> Adding the vectors to the index 03/09/2025, 08:41:28
2025-03-09 08:41:28,813 [INFO]: The memory available for adding the vectors is 49.1GB(total available - used by the index)
2025-03-09 08:41:28,813 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/22 [00:00<?, ?it/s]  5%|▍         | 1/22 [00:00<00:02,  7.43it/s] 27%|██▋       | 6/22 [00:00<00:00, 29.12it/s] 45%|████▌     | 10/22 [00:00<00:00, 31.66it/s] 73%|███████▎  | 16/22 [00:00<00:00, 39.70it/s] 95%|█████████▌| 21/22 [00:04<00:00,  3.24it/s]100%|██████████| 22/22 [00:04<00:00,  4.41it/s]
2025-03-09 08:41:33,803 [INFO]: 	Computing best hyperparameters for index knn.index 03/09/2025, 08:41:33
2025-03-09 08:42:24,967 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 51.1639 secs
2025-03-09 08:42:24,968 [INFO]: The best hyperparameters are: efSearch=228
2025-03-09 08:42:24,968 [INFO]: 	Compute fast metrics 03/09/2025, 08:42:24
  0%|          | 0/4 [00:00<?, ?it/s] 25%|██▌       | 1/4 [00:00<00:00,  6.75it/s] 75%|███████▌  | 3/4 [00:00<00:00, 11.87it/s]
2025-03-09 08:42:45,856 [INFO]: 	>>> Finished "Compute fast metrics" in 20.8881 secs
2025-03-09 08:42:45,857 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 77.0443 secs
2025-03-09 08:42:45,857 [INFO]: {
2025-03-09 08:42:45,857 [INFO]: 	index_key: HNSW15
2025-03-09 08:42:45,857 [INFO]: 	index_param: efSearch=228
2025-03-09 08:42:45,857 [INFO]: 	index_path: knn.index
2025-03-09 08:42:45,857 [INFO]: 	size in bytes: 1015986310
2025-03-09 08:42:45,857 [INFO]: 	avg_search_speed_ms: 11.564467531881926
2025-03-09 08:42:45,857 [INFO]: 	99p_search_speed_ms: 26.23069560155273
2025-03-09 08:42:45,857 [INFO]: 	reconstruction error %: 0.0
2025-03-09 08:42:45,857 [INFO]: 	nb vectors: 5164
2025-03-09 08:42:45,857 [INFO]: 	vectors dimension: 49152
2025-03-09 08:42:45,857 [INFO]: 	compression ratio: 0.9993084572173024
2025-03-09 08:42:45,857 [INFO]: }
2025-03-09 08:42:45,857 [INFO]: 	>>> Finished "Creating the index" in 77.0457 secs
2025-03-09 08:42:45,857 [INFO]: >>> Finished "Launching the whole pipeline" in 77.0757 secs
2025-03-09 08:42:48: [retrieval_preprocessing] calculating distances ...
2025-03-09 08:42:49: [retrieval_preprocessing] finished and saved retrieval indices for episode 22023 [episode count 2/20]
[retrieval_preprocessing] for episode 38280 [episode count 3/20], we have num_retrieval=np.int64(5141) num_query=np.int64(341)
2025-03-09 08:42:51,655 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-09 08:42:52,353 [INFO]: Launching the whole pipeline 03/09/2025, 08:42:52
2025-03-09 08:42:52,354 [INFO]: Reading total number of vectors and dimension 03/09/2025, 08:42:52
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1606.40it/s]
2025-03-09 08:42:52,389 [INFO]: There are 5141 embeddings of dim 49152
2025-03-09 08:42:52,389 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0355 secs
2025-03-09 08:42:52,389 [INFO]: 	Compute estimated construction time of the index 03/09/2025, 08:42:52
2025-03-09 08:42:52,389 [INFO]: 		-> Train: 16.7 minutes
2025-03-09 08:42:52,390 [INFO]: 		-> Add: 2.8 seconds
2025-03-09 08:42:52,390 [INFO]: 		Total: 16.7 minutes
2025-03-09 08:42:52,390 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0004 secs
2025-03-09 08:42:52,390 [INFO]: 	Checking that your have enough memory available to create the index 03/09/2025, 08:42:52
2025-03-09 08:42:52,390 [INFO]: 1.0GB of memory will be needed to build the index (more might be used if you have more)
2025-03-09 08:42:52,391 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0006 secs
2025-03-09 08:42:52,391 [INFO]: 	Selecting most promising index types given data characteristics 03/09/2025, 08:42:52
2025-03-09 08:42:52,391 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-09 08:42:52,391 [INFO]: 	Creating the index 03/09/2025, 08:42:52
2025-03-09 08:42:52,391 [INFO]: 		-> Instanciate the index HNSW15 03/09/2025, 08:42:52
2025-03-09 08:42:52,394 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0029 secs
2025-03-09 08:42:52,394 [INFO]: 		-> Adding the vectors to the index 03/09/2025, 08:42:52
2025-03-09 08:42:52,394 [INFO]: The memory available for adding the vectors is 49.1GB(total available - used by the index)
2025-03-09 08:42:52,395 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/22 [00:00<?, ?it/s]  5%|▍         | 1/22 [00:00<00:03,  5.64it/s] 14%|█▎        | 3/22 [00:00<00:02,  9.42it/s] 23%|██▎       | 5/22 [00:00<00:01, 10.83it/s] 32%|███▏      | 7/22 [00:00<00:01, 11.50it/s] 41%|████      | 9/22 [00:00<00:01, 11.87it/s] 50%|█████     | 11/22 [00:00<00:00, 12.08it/s] 59%|█████▉    | 13/22 [00:01<00:00, 12.32it/s] 68%|██████▊   | 15/22 [00:01<00:00, 12.30it/s] 77%|███████▋  | 17/22 [00:01<00:00, 12.40it/s] 86%|████████▋ | 19/22 [00:01<00:00, 12.51it/s] 95%|█████████▌| 21/22 [00:06<00:00,  1.30it/s]100%|██████████| 22/22 [00:07<00:00,  1.27it/s]100%|██████████| 22/22 [00:07<00:00,  3.09it/s]
2025-03-09 08:42:59,522 [INFO]: 	Computing best hyperparameters for index knn.index 03/09/2025, 08:42:59
2025-03-09 08:43:49,925 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 50.4034 secs
2025-03-09 08:43:49,925 [INFO]: The best hyperparameters are: efSearch=246
2025-03-09 08:43:49,926 [INFO]: 	Compute fast metrics 03/09/2025, 08:43:49
  0%|          | 0/4 [00:00<?, ?it/s] 50%|█████     | 2/4 [00:00<00:00, 18.83it/s] 75%|███████▌  | 3/4 [00:00<00:00, 20.18it/s]
2025-03-09 08:44:08,744 [INFO]: 	>>> Finished "Compute fast metrics" in 18.8180 secs
2025-03-09 08:44:08,745 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 76.3506 secs
2025-03-09 08:44:08,745 [INFO]: {
2025-03-09 08:44:08,745 [INFO]: 	index_key: HNSW15
2025-03-09 08:44:08,745 [INFO]: 	index_param: efSearch=246
2025-03-09 08:44:08,745 [INFO]: 	index_path: knn.index
2025-03-09 08:44:08,745 [INFO]: 	size in bytes: 1011461170
2025-03-09 08:44:08,745 [INFO]: 	avg_search_speed_ms: 13.869475503871929
2025-03-09 08:44:08,745 [INFO]: 	99p_search_speed_ms: 28.984527615830267
2025-03-09 08:44:08,745 [INFO]: 	reconstruction error %: 0.0
2025-03-09 08:44:08,745 [INFO]: 	nb vectors: 5141
2025-03-09 08:44:08,745 [INFO]: 	vectors dimension: 49152
2025-03-09 08:44:08,745 [INFO]: 	compression ratio: 0.9993084835871653
2025-03-09 08:44:08,745 [INFO]: }
2025-03-09 08:44:08,745 [INFO]: 	>>> Finished "Creating the index" in 76.3543 secs
2025-03-09 08:44:08,745 [INFO]: >>> Finished "Launching the whole pipeline" in 76.3919 secs
2025-03-09 08:44:11: [retrieval_preprocessing] calculating distances ...
2025-03-09 08:44:13: [retrieval_preprocessing] finished and saved retrieval indices for episode 38280 [episode count 3/20]
[retrieval_preprocessing] for episode 85896 [episode count 4/20], we have num_retrieval=np.int64(5147) num_query=np.int64(335)
2025-03-09 08:44:15,461 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-09 08:44:16,348 [INFO]: Launching the whole pipeline 03/09/2025, 08:44:16
2025-03-09 08:44:16,348 [INFO]: Reading total number of vectors and dimension 03/09/2025, 08:44:16
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1120.27it/s]
2025-03-09 08:44:16,381 [INFO]: There are 5147 embeddings of dim 49152
2025-03-09 08:44:16,381 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0330 secs
2025-03-09 08:44:16,381 [INFO]: 	Compute estimated construction time of the index 03/09/2025, 08:44:16
2025-03-09 08:44:16,381 [INFO]: 		-> Train: 16.7 minutes
2025-03-09 08:44:16,381 [INFO]: 		-> Add: 2.8 seconds
2025-03-09 08:44:16,381 [INFO]: 		Total: 16.7 minutes
2025-03-09 08:44:16,381 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0002 secs
2025-03-09 08:44:16,381 [INFO]: 	Checking that your have enough memory available to create the index 03/09/2025, 08:44:16
2025-03-09 08:44:16,381 [INFO]: 1.0GB of memory will be needed to build the index (more might be used if you have more)
2025-03-09 08:44:16,382 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0002 secs
2025-03-09 08:44:16,382 [INFO]: 	Selecting most promising index types given data characteristics 03/09/2025, 08:44:16
2025-03-09 08:44:16,382 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-09 08:44:16,382 [INFO]: 	Creating the index 03/09/2025, 08:44:16
2025-03-09 08:44:16,382 [INFO]: 		-> Instanciate the index HNSW15 03/09/2025, 08:44:16
2025-03-09 08:44:16,383 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0012 secs
2025-03-09 08:44:16,383 [INFO]: 		-> Adding the vectors to the index 03/09/2025, 08:44:16
2025-03-09 08:44:16,383 [INFO]: The memory available for adding the vectors is 49.1GB(total available - used by the index)
2025-03-09 08:44:16,383 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/22 [00:00<?, ?it/s]  5%|▍         | 1/22 [00:00<00:04,  4.92it/s]  9%|▉         | 2/22 [00:00<00:03,  6.64it/s] 14%|█▎        | 3/22 [00:00<00:02,  7.37it/s] 18%|█▊        | 4/22 [00:00<00:02,  7.85it/s] 23%|██▎       | 5/22 [00:00<00:02,  8.07it/s] 27%|██▋       | 6/22 [00:00<00:01,  8.35it/s] 32%|███▏      | 7/22 [00:00<00:01,  8.54it/s] 36%|███▋      | 8/22 [00:01<00:01,  8.60it/s] 41%|████      | 9/22 [00:01<00:01,  8.50it/s] 45%|████▌     | 10/22 [00:01<00:01,  8.60it/s] 50%|█████     | 11/22 [00:01<00:01,  8.68it/s] 55%|█████▍    | 12/22 [00:01<00:01,  8.64it/s] 59%|█████▉    | 13/22 [00:01<00:01,  8.69it/s] 64%|██████▎   | 14/22 [00:01<00:00,  8.73it/s] 68%|██████▊   | 15/22 [00:01<00:00,  8.86it/s] 73%|███████▎  | 16/22 [00:01<00:00,  8.83it/s] 77%|███████▋  | 17/22 [00:02<00:00,  8.81it/s] 82%|████████▏ | 18/22 [00:02<00:00,  8.70it/s] 86%|████████▋ | 19/22 [00:02<00:00,  8.74it/s] 91%|█████████ | 20/22 [00:02<00:00,  8.83it/s] 95%|█████████▌| 21/22 [00:06<00:01,  1.36s/it]100%|██████████| 22/22 [00:07<00:00,  1.22s/it]100%|██████████| 22/22 [00:07<00:00,  2.92it/s]
2025-03-09 08:44:23,925 [INFO]: 	Computing best hyperparameters for index knn.index 03/09/2025, 08:44:23
2025-03-09 08:45:07,936 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 44.0110 secs
2025-03-09 08:45:07,936 [INFO]: The best hyperparameters are: efSearch=234
2025-03-09 08:45:07,937 [INFO]: 	Compute fast metrics 03/09/2025, 08:45:07
  0%|          | 0/4 [00:00<?, ?it/s] 50%|█████     | 2/4 [00:00<00:00, 18.96it/s] 75%|███████▌  | 3/4 [00:00<00:00, 20.87it/s]
2025-03-09 08:45:26,577 [INFO]: 	>>> Finished "Compute fast metrics" in 18.6406 secs
2025-03-09 08:45:26,578 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 70.1948 secs
2025-03-09 08:45:26,578 [INFO]: {
2025-03-09 08:45:26,578 [INFO]: 	index_key: HNSW15
2025-03-09 08:45:26,578 [INFO]: 	index_param: efSearch=234
2025-03-09 08:45:26,578 [INFO]: 	index_path: knn.index
2025-03-09 08:45:26,578 [INFO]: 	size in bytes: 1012641610
2025-03-09 08:45:26,578 [INFO]: 	avg_search_speed_ms: 12.374496296375106
2025-03-09 08:45:26,578 [INFO]: 	99p_search_speed_ms: 23.76246392726897
2025-03-09 08:45:26,578 [INFO]: 	reconstruction error %: 0.0
2025-03-09 08:45:26,578 [INFO]: 	nb vectors: 5147
2025-03-09 08:45:26,578 [INFO]: 	vectors dimension: 49152
2025-03-09 08:45:26,578 [INFO]: 	compression ratio: 0.9993085075775229
2025-03-09 08:45:26,579 [INFO]: }
2025-03-09 08:45:26,579 [INFO]: 	>>> Finished "Creating the index" in 70.1968 secs
2025-03-09 08:45:26,579 [INFO]: >>> Finished "Launching the whole pipeline" in 70.2307 secs
2025-03-09 08:45:29: [retrieval_preprocessing] calculating distances ...
2025-03-09 08:45:30: [retrieval_preprocessing] finished and saved retrieval indices for episode 85896 [episode count 4/20]
[retrieval_preprocessing] for episode 26506 [episode count 5/20], we have num_retrieval=np.int64(5275) num_query=np.int64(207)
2025-03-09 08:45:30,658 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-09 08:45:31,501 [INFO]: Launching the whole pipeline 03/09/2025, 08:45:31
2025-03-09 08:45:31,501 [INFO]: Reading total number of vectors and dimension 03/09/2025, 08:45:31
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1358.26it/s]
2025-03-09 08:45:31,537 [INFO]: There are 5275 embeddings of dim 49152
2025-03-09 08:45:31,537 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0360 secs
2025-03-09 08:45:31,537 [INFO]: 	Compute estimated construction time of the index 03/09/2025, 08:45:31
2025-03-09 08:45:31,537 [INFO]: 		-> Train: 16.7 minutes
2025-03-09 08:45:31,537 [INFO]: 		-> Add: 2.9 seconds
2025-03-09 08:45:31,537 [INFO]: 		Total: 16.7 minutes
2025-03-09 08:45:31,537 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0001 secs
2025-03-09 08:45:31,537 [INFO]: 	Checking that your have enough memory available to create the index 03/09/2025, 08:45:31
2025-03-09 08:45:31,537 [INFO]: 1.1GB of memory will be needed to build the index (more might be used if you have more)
2025-03-09 08:45:31,537 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0002 secs
2025-03-09 08:45:31,537 [INFO]: 	Selecting most promising index types given data characteristics 03/09/2025, 08:45:31
2025-03-09 08:45:31,538 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-09 08:45:31,538 [INFO]: 	Creating the index 03/09/2025, 08:45:31
2025-03-09 08:45:31,538 [INFO]: 		-> Instanciate the index HNSW15 03/09/2025, 08:45:31
2025-03-09 08:45:31,539 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0013 secs
2025-03-09 08:45:31,539 [INFO]: 		-> Adding the vectors to the index 03/09/2025, 08:45:31
2025-03-09 08:45:31,539 [INFO]: The memory available for adding the vectors is 49.0GB(total available - used by the index)
2025-03-09 08:45:31,539 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/22 [00:00<?, ?it/s]  5%|▍         | 1/22 [00:00<00:02,  8.39it/s] 27%|██▋       | 6/22 [00:00<00:00, 30.15it/s] 50%|█████     | 11/22 [00:00<00:00, 38.04it/s] 73%|███████▎  | 16/22 [00:00<00:00, 42.54it/s] 95%|█████████▌| 21/22 [00:03<00:00,  3.49it/s]100%|██████████| 22/22 [00:04<00:00,  4.78it/s]
2025-03-09 08:45:36,148 [INFO]: 	Computing best hyperparameters for index knn.index 03/09/2025, 08:45:36
2025-03-09 08:46:22,458 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 46.3097 secs
2025-03-09 08:46:22,458 [INFO]: The best hyperparameters are: efSearch=229
2025-03-09 08:46:22,458 [INFO]: 	Compute fast metrics 03/09/2025, 08:46:22
  0%|          | 0/4 [00:00<?, ?it/s] 50%|█████     | 2/4 [00:00<00:00, 18.54it/s] 75%|███████▌  | 3/4 [00:00<00:00, 20.50it/s]
2025-03-09 08:46:41,112 [INFO]: 	>>> Finished "Compute fast metrics" in 18.6540 secs
2025-03-09 08:46:41,112 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 69.5734 secs
2025-03-09 08:46:41,113 [INFO]: {
2025-03-09 08:46:41,113 [INFO]: 	index_key: HNSW15
2025-03-09 08:46:41,113 [INFO]: 	index_param: efSearch=229
2025-03-09 08:46:41,113 [INFO]: 	index_path: knn.index
2025-03-09 08:46:41,113 [INFO]: 	size in bytes: 1037825110
2025-03-09 08:46:41,113 [INFO]: 	avg_search_speed_ms: 10.51103659859514
2025-03-09 08:46:41,113 [INFO]: 	99p_search_speed_ms: 25.198701107874516
2025-03-09 08:46:41,113 [INFO]: 	reconstruction error %: 0.0
2025-03-09 08:46:41,113 [INFO]: 	nb vectors: 5275
2025-03-09 08:46:41,113 [INFO]: 	vectors dimension: 49152
2025-03-09 08:46:41,113 [INFO]: 	compression ratio: 0.9993082553186635
2025-03-09 08:46:41,113 [INFO]: }
2025-03-09 08:46:41,113 [INFO]: 	>>> Finished "Creating the index" in 69.5751 secs
2025-03-09 08:46:41,113 [INFO]: >>> Finished "Launching the whole pipeline" in 69.6119 secs
2025-03-09 08:46:42: [retrieval_preprocessing] calculating distances ...
2025-03-09 08:46:43: [retrieval_preprocessing] finished and saved retrieval indices for episode 26506 [episode count 5/20]
[retrieval_preprocessing] for episode 88839 [episode count 6/20], we have num_retrieval=np.int64(4808) num_query=np.int64(674)
2025-03-09 08:46:44,036 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-09 08:46:44,627 [INFO]: Launching the whole pipeline 03/09/2025, 08:46:44
2025-03-09 08:46:44,627 [INFO]: Reading total number of vectors and dimension 03/09/2025, 08:46:44
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1178.51it/s]
2025-03-09 08:46:44,658 [INFO]: There are 4808 embeddings of dim 49152
2025-03-09 08:46:44,658 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0317 secs
2025-03-09 08:46:44,658 [INFO]: 	Compute estimated construction time of the index 03/09/2025, 08:46:44
2025-03-09 08:46:44,659 [INFO]: 		-> Train: 16.7 minutes
2025-03-09 08:46:44,659 [INFO]: 		-> Add: 2.6 seconds
2025-03-09 08:46:44,659 [INFO]: 		Total: 16.7 minutes
2025-03-09 08:46:44,659 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0001 secs
2025-03-09 08:46:44,659 [INFO]: 	Checking that your have enough memory available to create the index 03/09/2025, 08:46:44
2025-03-09 08:46:44,659 [INFO]: 992.3MB of memory will be needed to build the index (more might be used if you have more)
2025-03-09 08:46:44,659 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0002 secs
2025-03-09 08:46:44,659 [INFO]: 	Selecting most promising index types given data characteristics 03/09/2025, 08:46:44
2025-03-09 08:46:44,659 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-09 08:46:44,659 [INFO]: 	Creating the index 03/09/2025, 08:46:44
2025-03-09 08:46:44,659 [INFO]: 		-> Instanciate the index HNSW15 03/09/2025, 08:46:44
2025-03-09 08:46:44,660 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0012 secs
2025-03-09 08:46:44,660 [INFO]: 		-> Adding the vectors to the index 03/09/2025, 08:46:44
2025-03-09 08:46:44,661 [INFO]: The memory available for adding the vectors is 49.1GB(total available - used by the index)
2025-03-09 08:46:44,661 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/19 [00:00<?, ?it/s]  5%|▌         | 1/19 [00:00<00:03,  4.96it/s] 32%|███▏      | 6/19 [00:00<00:00, 22.71it/s] 63%|██████▎   | 12/19 [00:00<00:00, 34.95it/s] 95%|█████████▍| 18/19 [00:00<00:00, 41.80it/s]100%|██████████| 19/19 [00:04<00:00,  4.38it/s]
2025-03-09 08:46:49,003 [INFO]: 	Computing best hyperparameters for index knn.index 03/09/2025, 08:46:49
2025-03-09 08:47:34,116 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 45.1126 secs
2025-03-09 08:47:34,116 [INFO]: The best hyperparameters are: efSearch=248
2025-03-09 08:47:34,116 [INFO]: 	Compute fast metrics 03/09/2025, 08:47:34
  0%|          | 0/4 [00:00<?, ?it/s] 50%|█████     | 2/4 [00:00<00:00, 17.97it/s] 75%|███████▌  | 3/4 [00:00<00:00, 19.02it/s]
2025-03-09 08:47:48,840 [INFO]: 	>>> Finished "Compute fast metrics" in 14.7233 secs
2025-03-09 08:47:48,843 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 64.1820 secs
2025-03-09 08:47:48,843 [INFO]: {
2025-03-09 08:47:48,843 [INFO]: 	index_key: HNSW15
2025-03-09 08:47:48,843 [INFO]: 	index_param: efSearch=248
2025-03-09 08:47:48,843 [INFO]: 	index_path: knn.index
2025-03-09 08:47:48,843 [INFO]: 	size in bytes: 945945250
2025-03-09 08:47:48,843 [INFO]: 	avg_search_speed_ms: 13.21693046985482
2025-03-09 08:47:48,843 [INFO]: 	99p_search_speed_ms: 31.123165786266284
2025-03-09 08:47:48,843 [INFO]: 	reconstruction error %: 0.0
2025-03-09 08:47:48,843 [INFO]: 	nb vectors: 4808
2025-03-09 08:47:48,843 [INFO]: 	vectors dimension: 49152
2025-03-09 08:47:48,843 [INFO]: 	compression ratio: 0.9993086428627872
2025-03-09 08:47:48,843 [INFO]: }
2025-03-09 08:47:48,843 [INFO]: 	>>> Finished "Creating the index" in 64.1838 secs
2025-03-09 08:47:48,843 [INFO]: >>> Finished "Launching the whole pipeline" in 64.2163 secs
2025-03-09 08:47:54: [retrieval_preprocessing] calculating distances ...
2025-03-09 08:47:57: [retrieval_preprocessing] finished and saved retrieval indices for episode 88839 [episode count 6/20]
[retrieval_preprocessing] for episode 396 [episode count 7/20], we have num_retrieval=np.int64(5198) num_query=np.int64(284)
2025-03-09 08:47:57,873 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-09 08:47:58,633 [INFO]: Launching the whole pipeline 03/09/2025, 08:47:58
2025-03-09 08:47:58,633 [INFO]: Reading total number of vectors and dimension 03/09/2025, 08:47:58
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 2108.75it/s]
2025-03-09 08:47:58,660 [INFO]: There are 5198 embeddings of dim 49152
2025-03-09 08:47:58,660 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0276 secs
2025-03-09 08:47:58,660 [INFO]: 	Compute estimated construction time of the index 03/09/2025, 08:47:58
2025-03-09 08:47:58,660 [INFO]: 		-> Train: 16.7 minutes
2025-03-09 08:47:58,661 [INFO]: 		-> Add: 2.9 seconds
2025-03-09 08:47:58,661 [INFO]: 		Total: 16.7 minutes
2025-03-09 08:47:58,661 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0001 secs
2025-03-09 08:47:58,661 [INFO]: 	Checking that your have enough memory available to create the index 03/09/2025, 08:47:58
2025-03-09 08:47:58,661 [INFO]: 1.0GB of memory will be needed to build the index (more might be used if you have more)
2025-03-09 08:47:58,661 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0001 secs
2025-03-09 08:47:58,661 [INFO]: 	Selecting most promising index types given data characteristics 03/09/2025, 08:47:58
2025-03-09 08:47:58,661 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-09 08:47:58,661 [INFO]: 	Creating the index 03/09/2025, 08:47:58
2025-03-09 08:47:58,661 [INFO]: 		-> Instanciate the index HNSW15 03/09/2025, 08:47:58
2025-03-09 08:47:58,662 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0009 secs
2025-03-09 08:47:58,662 [INFO]: 		-> Adding the vectors to the index 03/09/2025, 08:47:58
2025-03-09 08:47:58,662 [INFO]: The memory available for adding the vectors is 49.0GB(total available - used by the index)
2025-03-09 08:47:58,662 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/22 [00:00<?, ?it/s]  5%|▍         | 1/22 [00:00<00:05,  3.54it/s] 27%|██▋       | 6/22 [00:00<00:00, 17.76it/s] 50%|█████     | 11/22 [00:00<00:00, 25.78it/s] 73%|███████▎  | 16/22 [00:00<00:00, 30.75it/s] 91%|█████████ | 20/22 [00:00<00:00, 33.22it/s]100%|██████████| 22/22 [00:06<00:00,  3.49it/s]
2025-03-09 08:48:04,976 [INFO]: 	Computing best hyperparameters for index knn.index 03/09/2025, 08:48:04
2025-03-09 08:48:55,615 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 50.6385 secs
2025-03-09 08:48:55,615 [INFO]: The best hyperparameters are: efSearch=214
2025-03-09 08:48:55,615 [INFO]: 	Compute fast metrics 03/09/2025, 08:48:55
  0%|          | 0/4 [00:00<?, ?it/s] 50%|█████     | 2/4 [00:00<00:00, 18.74it/s] 75%|███████▌  | 3/4 [00:00<00:00, 20.77it/s]
2025-03-09 08:49:10,109 [INFO]: 	>>> Finished "Compute fast metrics" in 14.4940 secs
2025-03-09 08:49:10,109 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 71.4475 secs
2025-03-09 08:49:10,110 [INFO]: {
2025-03-09 08:49:10,110 [INFO]: 	index_key: HNSW15
2025-03-09 08:49:10,110 [INFO]: 	index_param: efSearch=214
2025-03-09 08:49:10,110 [INFO]: 	index_path: knn.index
2025-03-09 08:49:10,110 [INFO]: 	size in bytes: 1022675710
2025-03-09 08:49:10,110 [INFO]: 	avg_search_speed_ms: 10.435880565751415
2025-03-09 08:49:10,110 [INFO]: 	99p_search_speed_ms: 20.967471553012725
2025-03-09 08:49:10,110 [INFO]: 	reconstruction error %: 0.0
2025-03-09 08:49:10,110 [INFO]: 	nb vectors: 5198
2025-03-09 08:49:10,110 [INFO]: 	vectors dimension: 49152
2025-03-09 08:49:10,110 [INFO]: 	compression ratio: 0.9993083574850917
2025-03-09 08:49:10,110 [INFO]: }
2025-03-09 08:49:10,110 [INFO]: 	>>> Finished "Creating the index" in 71.4487 secs
2025-03-09 08:49:10,110 [INFO]: >>> Finished "Launching the whole pipeline" in 71.4770 secs
2025-03-09 08:49:11: [retrieval_preprocessing] calculating distances ...
2025-03-09 08:49:12: [retrieval_preprocessing] finished and saved retrieval indices for episode 396 [episode count 7/20]
[retrieval_preprocessing] for episode 77452 [episode count 8/20], we have num_retrieval=np.int64(5187) num_query=np.int64(295)
2025-03-09 08:49:13,006 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-09 08:49:13,639 [INFO]: Launching the whole pipeline 03/09/2025, 08:49:13
2025-03-09 08:49:13,639 [INFO]: Reading total number of vectors and dimension 03/09/2025, 08:49:13
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1592.98it/s]
2025-03-09 08:49:13,668 [INFO]: There are 5187 embeddings of dim 49152
2025-03-09 08:49:13,668 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0287 secs
2025-03-09 08:49:13,668 [INFO]: 	Compute estimated construction time of the index 03/09/2025, 08:49:13
2025-03-09 08:49:13,668 [INFO]: 		-> Train: 16.7 minutes
2025-03-09 08:49:13,668 [INFO]: 		-> Add: 2.8 seconds
2025-03-09 08:49:13,668 [INFO]: 		Total: 16.7 minutes
2025-03-09 08:49:13,668 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0001 secs
2025-03-09 08:49:13,668 [INFO]: 	Checking that your have enough memory available to create the index 03/09/2025, 08:49:13
2025-03-09 08:49:13,668 [INFO]: 1.0GB of memory will be needed to build the index (more might be used if you have more)
2025-03-09 08:49:13,668 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0001 secs
2025-03-09 08:49:13,669 [INFO]: 	Selecting most promising index types given data characteristics 03/09/2025, 08:49:13
2025-03-09 08:49:13,669 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-09 08:49:13,669 [INFO]: 	Creating the index 03/09/2025, 08:49:13
2025-03-09 08:49:13,669 [INFO]: 		-> Instanciate the index HNSW15 03/09/2025, 08:49:13
2025-03-09 08:49:13,670 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0010 secs
2025-03-09 08:49:13,670 [INFO]: 		-> Adding the vectors to the index 03/09/2025, 08:49:13
2025-03-09 08:49:13,670 [INFO]: The memory available for adding the vectors is 49.0GB(total available - used by the index)
2025-03-09 08:49:13,670 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/22 [00:00<?, ?it/s]  5%|▍         | 1/22 [00:00<00:02,  7.45it/s] 18%|█▊        | 4/22 [00:00<00:01, 15.33it/s] 36%|███▋      | 8/22 [00:00<00:00, 23.79it/s] 59%|█████▉    | 13/22 [00:00<00:00, 32.32it/s] 82%|████████▏ | 18/22 [00:00<00:00, 37.94it/s]100%|██████████| 22/22 [00:05<00:00,  2.33it/s]100%|██████████| 22/22 [00:05<00:00,  3.92it/s]
2025-03-09 08:49:19,290 [INFO]: 	Computing best hyperparameters for index knn.index 03/09/2025, 08:49:19
2025-03-09 08:50:08,171 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 48.8809 secs
2025-03-09 08:50:08,171 [INFO]: The best hyperparameters are: efSearch=228
2025-03-09 08:50:08,171 [INFO]: 	Compute fast metrics 03/09/2025, 08:50:08
  0%|          | 0/4 [00:00<?, ?it/s] 25%|██▌       | 1/4 [00:00<00:00,  7.85it/s] 75%|███████▌  | 3/4 [00:00<00:00, 16.11it/s]
2025-03-09 08:50:24,671 [INFO]: 	>>> Finished "Compute fast metrics" in 16.5001 secs
2025-03-09 08:50:24,672 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 71.0022 secs
2025-03-09 08:50:24,672 [INFO]: {
2025-03-09 08:50:24,672 [INFO]: 	index_key: HNSW15
2025-03-09 08:50:24,672 [INFO]: 	index_param: efSearch=228
2025-03-09 08:50:24,672 [INFO]: 	index_path: knn.index
2025-03-09 08:50:24,672 [INFO]: 	size in bytes: 1020511510
2025-03-09 08:50:24,672 [INFO]: 	avg_search_speed_ms: 11.756113457321666
2025-03-09 08:50:24,672 [INFO]: 	99p_search_speed_ms: 27.258751448243856
2025-03-09 08:50:24,672 [INFO]: 	reconstruction error %: 0.0
2025-03-09 08:50:24,672 [INFO]: 	nb vectors: 5187
2025-03-09 08:50:24,672 [INFO]: 	vectors dimension: 49152
2025-03-09 08:50:24,673 [INFO]: 	compression ratio: 0.9993083723279123
2025-03-09 08:50:24,673 [INFO]: }
2025-03-09 08:50:24,673 [INFO]: 	>>> Finished "Creating the index" in 71.0039 secs
2025-03-09 08:50:24,673 [INFO]: >>> Finished "Launching the whole pipeline" in 71.0333 secs
2025-03-09 08:50:27: [retrieval_preprocessing] calculating distances ...
2025-03-09 08:50:28: [retrieval_preprocessing] finished and saved retrieval indices for episode 77452 [episode count 8/20]
[retrieval_preprocessing] for episode 29717 [episode count 9/20], we have num_retrieval=np.int64(5215) num_query=np.int64(267)
2025-03-09 08:50:28,766 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-09 08:50:29,685 [INFO]: Launching the whole pipeline 03/09/2025, 08:50:29
2025-03-09 08:50:29,685 [INFO]: Reading total number of vectors and dimension 03/09/2025, 08:50:29
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1167.03it/s]
2025-03-09 08:50:29,714 [INFO]: There are 5215 embeddings of dim 49152
2025-03-09 08:50:29,714 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0292 secs
2025-03-09 08:50:29,714 [INFO]: 	Compute estimated construction time of the index 03/09/2025, 08:50:29
2025-03-09 08:50:29,715 [INFO]: 		-> Train: 16.7 minutes
2025-03-09 08:50:29,715 [INFO]: 		-> Add: 2.9 seconds
2025-03-09 08:50:29,715 [INFO]: 		Total: 16.7 minutes
2025-03-09 08:50:29,715 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0001 secs
2025-03-09 08:50:29,715 [INFO]: 	Checking that your have enough memory available to create the index 03/09/2025, 08:50:29
2025-03-09 08:50:29,715 [INFO]: 1.1GB of memory will be needed to build the index (more might be used if you have more)
2025-03-09 08:50:29,715 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0002 secs
2025-03-09 08:50:29,716 [INFO]: 	Selecting most promising index types given data characteristics 03/09/2025, 08:50:29
2025-03-09 08:50:29,716 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-09 08:50:29,716 [INFO]: 	Creating the index 03/09/2025, 08:50:29
2025-03-09 08:50:29,716 [INFO]: 		-> Instanciate the index HNSW15 03/09/2025, 08:50:29
2025-03-09 08:50:29,717 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0011 secs
2025-03-09 08:50:29,717 [INFO]: 		-> Adding the vectors to the index 03/09/2025, 08:50:29
2025-03-09 08:50:29,717 [INFO]: The memory available for adding the vectors is 49.0GB(total available - used by the index)
2025-03-09 08:50:29,717 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/22 [00:00<?, ?it/s]  5%|▍         | 1/22 [00:00<00:02,  9.90it/s] 32%|███▏      | 7/22 [00:00<00:00, 37.86it/s] 59%|█████▉    | 13/22 [00:00<00:00, 45.74it/s] 82%|████████▏ | 18/22 [00:00<00:00, 45.32it/s]100%|██████████| 22/22 [00:05<00:00,  4.02it/s]
2025-03-09 08:50:35,197 [INFO]: 	Computing best hyperparameters for index knn.index 03/09/2025, 08:50:35
2025-03-09 08:51:22,999 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 47.8023 secs
2025-03-09 08:51:22,999 [INFO]: The best hyperparameters are: efSearch=228
2025-03-09 08:51:22,999 [INFO]: 	Compute fast metrics 03/09/2025, 08:51:22
  0%|          | 0/4 [00:00<?, ?it/s] 50%|█████     | 2/4 [00:00<00:00, 16.61it/s] 75%|███████▌  | 3/4 [00:00<00:00, 18.26it/s]
2025-03-09 08:51:46,877 [INFO]: 	>>> Finished "Compute fast metrics" in 23.8778 secs
2025-03-09 08:51:46,878 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 77.1607 secs
2025-03-09 08:51:46,878 [INFO]: {
2025-03-09 08:51:46,878 [INFO]: 	index_key: HNSW15
2025-03-09 08:51:46,878 [INFO]: 	index_param: efSearch=228
2025-03-09 08:51:46,878 [INFO]: 	index_path: knn.index
2025-03-09 08:51:46,878 [INFO]: 	size in bytes: 1026020350
2025-03-09 08:51:46,878 [INFO]: 	avg_search_speed_ms: 10.535403767902919
2025-03-09 08:51:46,878 [INFO]: 	99p_search_speed_ms: 22.845687409862876
2025-03-09 08:51:46,878 [INFO]: 	reconstruction error %: 0.0
2025-03-09 08:51:46,878 [INFO]: 	nb vectors: 5215
2025-03-09 08:51:46,878 [INFO]: 	vectors dimension: 49152
2025-03-09 08:51:46,878 [INFO]: 	compression ratio: 0.9993083665445817
2025-03-09 08:51:46,878 [INFO]: }
2025-03-09 08:51:46,878 [INFO]: 	>>> Finished "Creating the index" in 77.1622 secs
2025-03-09 08:51:46,878 [INFO]: >>> Finished "Launching the whole pipeline" in 77.1928 secs
2025-03-09 08:51:48: [retrieval_preprocessing] calculating distances ...
2025-03-09 08:51:49: [retrieval_preprocessing] finished and saved retrieval indices for episode 29717 [episode count 9/20]
[retrieval_preprocessing] for episode 88216 [episode count 10/20], we have num_retrieval=np.int64(5232) num_query=np.int64(250)
2025-03-09 08:51:50,265 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-09 08:51:51,195 [INFO]: Launching the whole pipeline 03/09/2025, 08:51:51
2025-03-09 08:51:51,195 [INFO]: Reading total number of vectors and dimension 03/09/2025, 08:51:51
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1386.55it/s]
2025-03-09 08:51:51,227 [INFO]: There are 5232 embeddings of dim 49152
2025-03-09 08:51:51,228 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0327 secs
2025-03-09 08:51:51,228 [INFO]: 	Compute estimated construction time of the index 03/09/2025, 08:51:51
2025-03-09 08:51:51,228 [INFO]: 		-> Train: 16.7 minutes
2025-03-09 08:51:51,228 [INFO]: 		-> Add: 2.9 seconds
2025-03-09 08:51:51,228 [INFO]: 		Total: 16.7 minutes
2025-03-09 08:51:51,228 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0002 secs
2025-03-09 08:51:51,228 [INFO]: 	Checking that your have enough memory available to create the index 03/09/2025, 08:51:51
2025-03-09 08:51:51,228 [INFO]: 1.1GB of memory will be needed to build the index (more might be used if you have more)
2025-03-09 08:51:51,228 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0002 secs
2025-03-09 08:51:51,228 [INFO]: 	Selecting most promising index types given data characteristics 03/09/2025, 08:51:51
2025-03-09 08:51:51,228 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-09 08:51:51,228 [INFO]: 	Creating the index 03/09/2025, 08:51:51
2025-03-09 08:51:51,228 [INFO]: 		-> Instanciate the index HNSW15 03/09/2025, 08:51:51
2025-03-09 08:51:51,230 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0012 secs
2025-03-09 08:51:51,230 [INFO]: 		-> Adding the vectors to the index 03/09/2025, 08:51:51
2025-03-09 08:51:51,230 [INFO]: The memory available for adding the vectors is 49.0GB(total available - used by the index)
2025-03-09 08:51:51,230 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/22 [00:00<?, ?it/s]  5%|▍         | 1/22 [00:00<00:02,  8.74it/s] 27%|██▋       | 6/22 [00:00<00:00, 27.94it/s] 55%|█████▍    | 12/22 [00:00<00:00, 38.38it/s] 82%|████████▏ | 18/22 [00:00<00:00, 43.39it/s]100%|██████████| 22/22 [00:04<00:00,  4.61it/s]
2025-03-09 08:51:56,009 [INFO]: 	Computing best hyperparameters for index knn.index 03/09/2025, 08:51:56
2025-03-09 08:52:34,844 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 38.8355 secs
2025-03-09 08:52:34,844 [INFO]: The best hyperparameters are: efSearch=228
2025-03-09 08:52:34,844 [INFO]: 	Compute fast metrics 03/09/2025, 08:52:34
  0%|          | 0/4 [00:00<?, ?it/s] 25%|██▌       | 1/4 [00:00<00:00,  9.43it/s] 75%|███████▌  | 3/4 [00:00<00:00, 18.77it/s]
2025-03-09 08:52:57,412 [INFO]: 	>>> Finished "Compute fast metrics" in 22.5672 secs
2025-03-09 08:52:57,421 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 66.1910 secs
2025-03-09 08:52:57,421 [INFO]: {
2025-03-09 08:52:57,421 [INFO]: 	index_key: HNSW15
2025-03-09 08:52:57,421 [INFO]: 	index_param: efSearch=228
2025-03-09 08:52:57,421 [INFO]: 	index_path: knn.index
2025-03-09 08:52:57,421 [INFO]: 	size in bytes: 1029365110
2025-03-09 08:52:57,421 [INFO]: 	avg_search_speed_ms: 10.960416582964875
2025-03-09 08:52:57,421 [INFO]: 	99p_search_speed_ms: 25.227763140574098
2025-03-09 08:52:57,421 [INFO]: 	reconstruction error %: 0.0
2025-03-09 08:52:57,421 [INFO]: 	nb vectors: 5232
2025-03-09 08:52:57,421 [INFO]: 	vectors dimension: 49152
2025-03-09 08:52:57,421 [INFO]: 	compression ratio: 0.9993082590491142
2025-03-09 08:52:57,421 [INFO]: }
2025-03-09 08:52:57,421 [INFO]: 	>>> Finished "Creating the index" in 66.1929 secs
2025-03-09 08:52:57,421 [INFO]: >>> Finished "Launching the whole pipeline" in 66.2264 secs
2025-03-09 08:52:59: [retrieval_preprocessing] calculating distances ...
2025-03-09 08:53:00: [retrieval_preprocessing] finished and saved retrieval indices for episode 88216 [episode count 10/20]
[retrieval_preprocessing] for episode 3483 [episode count 11/20], we have num_retrieval=np.int64(5196) num_query=np.int64(286)
2025-03-09 08:53:00,511 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-09 08:53:01,134 [INFO]: Launching the whole pipeline 03/09/2025, 08:53:01
2025-03-09 08:53:01,134 [INFO]: Reading total number of vectors and dimension 03/09/2025, 08:53:01
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 2229.83it/s]
2025-03-09 08:53:01,161 [INFO]: There are 5196 embeddings of dim 49152
2025-03-09 08:53:01,161 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0271 secs
2025-03-09 08:53:01,161 [INFO]: 	Compute estimated construction time of the index 03/09/2025, 08:53:01
2025-03-09 08:53:01,162 [INFO]: 		-> Train: 16.7 minutes
2025-03-09 08:53:01,162 [INFO]: 		-> Add: 2.9 seconds
2025-03-09 08:53:01,162 [INFO]: 		Total: 16.7 minutes
2025-03-09 08:53:01,162 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0001 secs
2025-03-09 08:53:01,162 [INFO]: 	Checking that your have enough memory available to create the index 03/09/2025, 08:53:01
2025-03-09 08:53:01,162 [INFO]: 1.0GB of memory will be needed to build the index (more might be used if you have more)
2025-03-09 08:53:01,162 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0001 secs
2025-03-09 08:53:01,162 [INFO]: 	Selecting most promising index types given data characteristics 03/09/2025, 08:53:01
2025-03-09 08:53:01,162 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-09 08:53:01,162 [INFO]: 	Creating the index 03/09/2025, 08:53:01
2025-03-09 08:53:01,162 [INFO]: 		-> Instanciate the index HNSW15 03/09/2025, 08:53:01
2025-03-09 08:53:01,163 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0010 secs
2025-03-09 08:53:01,163 [INFO]: 		-> Adding the vectors to the index 03/09/2025, 08:53:01
2025-03-09 08:53:01,163 [INFO]: The memory available for adding the vectors is 49.0GB(total available - used by the index)
2025-03-09 08:53:01,163 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/22 [00:00<?, ?it/s]  5%|▍         | 1/22 [00:00<00:02,  7.60it/s] 27%|██▋       | 6/22 [00:00<00:00, 29.28it/s] 55%|█████▍    | 12/22 [00:00<00:00, 41.06it/s] 82%|████████▏ | 18/22 [00:00<00:00, 45.58it/s]100%|██████████| 22/22 [00:06<00:00,  3.57it/s]
2025-03-09 08:53:07,325 [INFO]: 	Computing best hyperparameters for index knn.index 03/09/2025, 08:53:07
2025-03-09 08:53:52,573 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 45.2475 secs
2025-03-09 08:53:52,573 [INFO]: The best hyperparameters are: efSearch=239
2025-03-09 08:53:52,573 [INFO]: 	Compute fast metrics 03/09/2025, 08:53:52
  0%|          | 0/4 [00:00<?, ?it/s] 50%|█████     | 2/4 [00:00<00:00, 18.98it/s] 75%|███████▌  | 3/4 [00:00<00:00, 20.66it/s]
2025-03-09 08:54:14,842 [INFO]: 	>>> Finished "Compute fast metrics" in 22.2687 secs
2025-03-09 08:54:14,843 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 73.6794 secs
2025-03-09 08:54:14,843 [INFO]: {
2025-03-09 08:54:14,843 [INFO]: 	index_key: HNSW15
2025-03-09 08:54:14,843 [INFO]: 	index_param: efSearch=239
2025-03-09 08:54:14,843 [INFO]: 	index_path: knn.index
2025-03-09 08:54:14,843 [INFO]: 	size in bytes: 1022282230
2025-03-09 08:54:14,843 [INFO]: 	avg_search_speed_ms: 10.776698889646374
2025-03-09 08:54:14,843 [INFO]: 	99p_search_speed_ms: 22.792880928609524
2025-03-09 08:54:14,843 [INFO]: 	reconstruction error %: 0.0
2025-03-09 08:54:14,843 [INFO]: 	nb vectors: 5196
2025-03-09 08:54:14,843 [INFO]: 	vectors dimension: 49152
2025-03-09 08:54:14,843 [INFO]: 	compression ratio: 0.9993083495151823
2025-03-09 08:54:14,843 [INFO]: }
2025-03-09 08:54:14,843 [INFO]: 	>>> Finished "Creating the index" in 73.6809 secs
2025-03-09 08:54:14,843 [INFO]: >>> Finished "Launching the whole pipeline" in 73.7085 secs
2025-03-09 08:54:16: [retrieval_preprocessing] calculating distances ...
2025-03-09 08:54:17: [retrieval_preprocessing] finished and saved retrieval indices for episode 3483 [episode count 11/20]
[retrieval_preprocessing] for episode 70556 [episode count 12/20], we have num_retrieval=np.int64(5284) num_query=np.int64(198)
2025-03-09 08:54:18,007 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-09 08:54:18,699 [INFO]: Launching the whole pipeline 03/09/2025, 08:54:18
2025-03-09 08:54:18,699 [INFO]: Reading total number of vectors and dimension 03/09/2025, 08:54:18
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1198.37it/s]
2025-03-09 08:54:18,727 [INFO]: There are 5284 embeddings of dim 49152
2025-03-09 08:54:18,727 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0278 secs
2025-03-09 08:54:18,727 [INFO]: 	Compute estimated construction time of the index 03/09/2025, 08:54:18
2025-03-09 08:54:18,727 [INFO]: 		-> Train: 16.7 minutes
2025-03-09 08:54:18,727 [INFO]: 		-> Add: 2.9 seconds
2025-03-09 08:54:18,727 [INFO]: 		Total: 16.7 minutes
2025-03-09 08:54:18,727 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0001 secs
2025-03-09 08:54:18,727 [INFO]: 	Checking that your have enough memory available to create the index 03/09/2025, 08:54:18
2025-03-09 08:54:18,727 [INFO]: 1.1GB of memory will be needed to build the index (more might be used if you have more)
2025-03-09 08:54:18,727 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0001 secs
2025-03-09 08:54:18,727 [INFO]: 	Selecting most promising index types given data characteristics 03/09/2025, 08:54:18
2025-03-09 08:54:18,727 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-09 08:54:18,727 [INFO]: 	Creating the index 03/09/2025, 08:54:18
2025-03-09 08:54:18,727 [INFO]: 		-> Instanciate the index HNSW15 03/09/2025, 08:54:18
2025-03-09 08:54:18,729 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0011 secs
2025-03-09 08:54:18,729 [INFO]: 		-> Adding the vectors to the index 03/09/2025, 08:54:18
2025-03-09 08:54:18,729 [INFO]: The memory available for adding the vectors is 49.0GB(total available - used by the index)
2025-03-09 08:54:18,729 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/22 [00:00<?, ?it/s]  5%|▍         | 1/22 [00:00<00:02,  8.40it/s] 27%|██▋       | 6/22 [00:00<00:00, 30.63it/s] 55%|█████▍    | 12/22 [00:00<00:00, 42.45it/s] 77%|███████▋  | 17/22 [00:00<00:00, 41.64it/s]100%|██████████| 22/22 [00:04<00:00,  3.04it/s]100%|██████████| 22/22 [00:04<00:00,  4.72it/s]
2025-03-09 08:54:23,393 [INFO]: 	Computing best hyperparameters for index knn.index 03/09/2025, 08:54:23
2025-03-09 08:55:10,279 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 46.8856 secs
2025-03-09 08:55:10,279 [INFO]: The best hyperparameters are: efSearch=193
2025-03-09 08:55:10,279 [INFO]: 	Compute fast metrics 03/09/2025, 08:55:10
  0%|          | 0/4 [00:00<?, ?it/s] 50%|█████     | 2/4 [00:00<00:00, 19.48it/s] 75%|███████▌  | 3/4 [00:00<00:00, 20.81it/s]
2025-03-09 08:55:30,776 [INFO]: 	>>> Finished "Compute fast metrics" in 20.4969 secs
2025-03-09 08:55:30,777 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 72.0479 secs
2025-03-09 08:55:30,777 [INFO]: {
2025-03-09 08:55:30,777 [INFO]: 	index_key: HNSW15
2025-03-09 08:55:30,777 [INFO]: 	index_param: efSearch=193
2025-03-09 08:55:30,777 [INFO]: 	index_path: knn.index
2025-03-09 08:55:30,777 [INFO]: 	size in bytes: 1039595770
2025-03-09 08:55:30,777 [INFO]: 	avg_search_speed_ms: 8.80379311223543
2025-03-09 08:55:30,777 [INFO]: 	99p_search_speed_ms: 17.384251952171358
2025-03-09 08:55:30,777 [INFO]: 	reconstruction error %: 0.0
2025-03-09 08:55:30,777 [INFO]: 	nb vectors: 5284
2025-03-09 08:55:30,777 [INFO]: 	vectors dimension: 49152
2025-03-09 08:55:30,777 [INFO]: 	compression ratio: 0.999308290759975
2025-03-09 08:55:30,777 [INFO]: }
2025-03-09 08:55:30,777 [INFO]: 	>>> Finished "Creating the index" in 72.0494 secs
2025-03-09 08:55:30,777 [INFO]: >>> Finished "Launching the whole pipeline" in 72.0779 secs
2025-03-09 08:55:31: [retrieval_preprocessing] calculating distances ...
2025-03-09 08:55:32: [retrieval_preprocessing] finished and saved retrieval indices for episode 70556 [episode count 12/20]
[retrieval_preprocessing] for episode 79515 [episode count 13/20], we have num_retrieval=np.int64(5281) num_query=np.int64(201)
2025-03-09 08:55:32,738 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-09 08:55:33,843 [INFO]: Launching the whole pipeline 03/09/2025, 08:55:33
2025-03-09 08:55:33,843 [INFO]: Reading total number of vectors and dimension 03/09/2025, 08:55:33
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1163.79it/s]
2025-03-09 08:55:33,873 [INFO]: There are 5281 embeddings of dim 49152
2025-03-09 08:55:33,874 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0301 secs
2025-03-09 08:55:33,874 [INFO]: 	Compute estimated construction time of the index 03/09/2025, 08:55:33
2025-03-09 08:55:33,874 [INFO]: 		-> Train: 16.7 minutes
2025-03-09 08:55:33,874 [INFO]: 		-> Add: 2.9 seconds
2025-03-09 08:55:33,874 [INFO]: 		Total: 16.7 minutes
2025-03-09 08:55:33,874 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0001 secs
2025-03-09 08:55:33,874 [INFO]: 	Checking that your have enough memory available to create the index 03/09/2025, 08:55:33
2025-03-09 08:55:33,874 [INFO]: 1.1GB of memory will be needed to build the index (more might be used if you have more)
2025-03-09 08:55:33,874 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0002 secs
2025-03-09 08:55:33,874 [INFO]: 	Selecting most promising index types given data characteristics 03/09/2025, 08:55:33
2025-03-09 08:55:33,874 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-09 08:55:33,874 [INFO]: 	Creating the index 03/09/2025, 08:55:33
2025-03-09 08:55:33,874 [INFO]: 		-> Instanciate the index HNSW15 03/09/2025, 08:55:33
2025-03-09 08:55:33,875 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0011 secs
2025-03-09 08:55:33,875 [INFO]: 		-> Adding the vectors to the index 03/09/2025, 08:55:33
2025-03-09 08:55:33,876 [INFO]: The memory available for adding the vectors is 49.0GB(total available - used by the index)
2025-03-09 08:55:33,876 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/22 [00:00<?, ?it/s]  5%|▍         | 1/22 [00:00<00:02,  7.40it/s] 27%|██▋       | 6/22 [00:00<00:00, 28.43it/s] 50%|█████     | 11/22 [00:00<00:00, 35.15it/s] 73%|███████▎  | 16/22 [00:00<00:00, 37.29it/s] 91%|█████████ | 20/22 [00:00<00:00, 35.31it/s]100%|██████████| 22/22 [00:05<00:00,  4.01it/s]
2025-03-09 08:55:39,359 [INFO]: 	Computing best hyperparameters for index knn.index 03/09/2025, 08:55:39
2025-03-09 08:56:28,925 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 49.5665 secs
2025-03-09 08:56:28,926 [INFO]: The best hyperparameters are: efSearch=209
2025-03-09 08:56:28,926 [INFO]: 	Compute fast metrics 03/09/2025, 08:56:28
  0%|          | 0/4 [00:00<?, ?it/s] 75%|███████▌  | 3/4 [00:00<00:00, 25.60it/s] 75%|███████▌  | 3/4 [00:00<00:00, 21.96it/s]
2025-03-09 08:56:45,332 [INFO]: 	>>> Finished "Compute fast metrics" in 16.4057 secs
2025-03-09 08:56:45,332 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 71.4564 secs
2025-03-09 08:56:45,332 [INFO]: {
2025-03-09 08:56:45,332 [INFO]: 	index_key: HNSW15
2025-03-09 08:56:45,332 [INFO]: 	index_param: efSearch=209
2025-03-09 08:56:45,332 [INFO]: 	index_path: knn.index
2025-03-09 08:56:45,332 [INFO]: 	size in bytes: 1039005550
2025-03-09 08:56:45,332 [INFO]: 	avg_search_speed_ms: 9.702439243777878
2025-03-09 08:56:45,332 [INFO]: 	99p_search_speed_ms: 19.359291880391563
2025-03-09 08:56:45,332 [INFO]: 	reconstruction error %: 0.0
2025-03-09 08:56:45,332 [INFO]: 	nb vectors: 5281
2025-03-09 08:56:45,332 [INFO]: 	vectors dimension: 49152
2025-03-09 08:56:45,332 [INFO]: 	compression ratio: 0.9993082789596264
2025-03-09 08:56:45,332 [INFO]: }
2025-03-09 08:56:45,332 [INFO]: 	>>> Finished "Creating the index" in 71.4580 secs
2025-03-09 08:56:45,332 [INFO]: >>> Finished "Launching the whole pipeline" in 71.4887 secs
2025-03-09 08:56:46: [retrieval_preprocessing] calculating distances ...
2025-03-09 08:56:46: [retrieval_preprocessing] finished and saved retrieval indices for episode 79515 [episode count 13/20]
[retrieval_preprocessing] for episode 82076 [episode count 14/20], we have num_retrieval=np.int64(5259) num_query=np.int64(223)
2025-03-09 08:56:47,267 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-09 08:56:47,909 [INFO]: Launching the whole pipeline 03/09/2025, 08:56:47
2025-03-09 08:56:47,909 [INFO]: Reading total number of vectors and dimension 03/09/2025, 08:56:47
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1653.91it/s]
2025-03-09 08:56:47,935 [INFO]: There are 5259 embeddings of dim 49152
2025-03-09 08:56:47,936 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0267 secs
2025-03-09 08:56:47,936 [INFO]: 	Compute estimated construction time of the index 03/09/2025, 08:56:47
2025-03-09 08:56:47,936 [INFO]: 		-> Train: 16.7 minutes
2025-03-09 08:56:47,936 [INFO]: 		-> Add: 2.9 seconds
2025-03-09 08:56:47,936 [INFO]: 		Total: 16.7 minutes
2025-03-09 08:56:47,936 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0001 secs
2025-03-09 08:56:47,936 [INFO]: 	Checking that your have enough memory available to create the index 03/09/2025, 08:56:47
2025-03-09 08:56:47,936 [INFO]: 1.1GB of memory will be needed to build the index (more might be used if you have more)
2025-03-09 08:56:47,936 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0001 secs
2025-03-09 08:56:47,936 [INFO]: 	Selecting most promising index types given data characteristics 03/09/2025, 08:56:47
2025-03-09 08:56:47,936 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-09 08:56:47,936 [INFO]: 	Creating the index 03/09/2025, 08:56:47
2025-03-09 08:56:47,936 [INFO]: 		-> Instanciate the index HNSW15 03/09/2025, 08:56:47
2025-03-09 08:56:47,937 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0008 secs
2025-03-09 08:56:47,937 [INFO]: 		-> Adding the vectors to the index 03/09/2025, 08:56:47
2025-03-09 08:56:47,937 [INFO]: The memory available for adding the vectors is 49.0GB(total available - used by the index)
2025-03-09 08:56:47,937 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/22 [00:00<?, ?it/s]  5%|▍         | 1/22 [00:00<00:02,  7.95it/s] 32%|███▏      | 7/22 [00:00<00:00, 32.68it/s] 59%|█████▉    | 13/22 [00:00<00:00, 40.80it/s] 82%|████████▏ | 18/22 [00:00<00:00, 43.80it/s]100%|██████████| 22/22 [00:04<00:00,  4.89it/s]
2025-03-09 08:56:52,439 [INFO]: 	Computing best hyperparameters for index knn.index 03/09/2025, 08:56:52
2025-03-09 08:57:38,571 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 46.1314 secs
2025-03-09 08:57:38,571 [INFO]: The best hyperparameters are: efSearch=229
2025-03-09 08:57:38,571 [INFO]: 	Compute fast metrics 03/09/2025, 08:57:38
  0%|          | 0/4 [00:00<?, ?it/s] 50%|█████     | 2/4 [00:00<00:00, 18.53it/s] 75%|███████▌  | 3/4 [00:00<00:00, 20.04it/s]
2025-03-09 08:57:57,313 [INFO]: 	>>> Finished "Compute fast metrics" in 18.7421 secs
2025-03-09 08:57:57,313 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 69.3763 secs
2025-03-09 08:57:57,313 [INFO]: {
2025-03-09 08:57:57,313 [INFO]: 	index_key: HNSW15
2025-03-09 08:57:57,313 [INFO]: 	index_param: efSearch=229
2025-03-09 08:57:57,313 [INFO]: 	index_path: knn.index
2025-03-09 08:57:57,313 [INFO]: 	size in bytes: 1034677270
2025-03-09 08:57:57,314 [INFO]: 	avg_search_speed_ms: 10.802603245523736
2025-03-09 08:57:57,314 [INFO]: 	99p_search_speed_ms: 23.753159737680107
2025-03-09 08:57:57,314 [INFO]: 	reconstruction error %: 0.0
2025-03-09 08:57:57,314 [INFO]: 	nb vectors: 5259
2025-03-09 08:57:57,314 [INFO]: 	vectors dimension: 49152
2025-03-09 08:57:57,314 [INFO]: 	compression ratio: 0.999308192012375
2025-03-09 08:57:57,314 [INFO]: }
2025-03-09 08:57:57,314 [INFO]: 	>>> Finished "Creating the index" in 69.3775 secs
2025-03-09 08:57:57,314 [INFO]: >>> Finished "Launching the whole pipeline" in 69.4048 secs
2025-03-09 08:57:58: [retrieval_preprocessing] calculating distances ...
2025-03-09 08:57:59: [retrieval_preprocessing] finished and saved retrieval indices for episode 82076 [episode count 14/20]
[retrieval_preprocessing] for episode 68385 [episode count 15/20], we have num_retrieval=np.int64(5276) num_query=np.int64(206)
2025-03-09 08:57:59,710 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-09 08:58:00,335 [INFO]: Launching the whole pipeline 03/09/2025, 08:58:00
2025-03-09 08:58:00,335 [INFO]: Reading total number of vectors and dimension 03/09/2025, 08:58:00
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1489.45it/s]
2025-03-09 08:58:00,362 [INFO]: There are 5276 embeddings of dim 49152
2025-03-09 08:58:00,362 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0268 secs
2025-03-09 08:58:00,362 [INFO]: 	Compute estimated construction time of the index 03/09/2025, 08:58:00
2025-03-09 08:58:00,362 [INFO]: 		-> Train: 16.7 minutes
2025-03-09 08:58:00,362 [INFO]: 		-> Add: 2.9 seconds
2025-03-09 08:58:00,362 [INFO]: 		Total: 16.7 minutes
2025-03-09 08:58:00,362 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0001 secs
2025-03-09 08:58:00,362 [INFO]: 	Checking that your have enough memory available to create the index 03/09/2025, 08:58:00
2025-03-09 08:58:00,362 [INFO]: 1.1GB of memory will be needed to build the index (more might be used if you have more)
2025-03-09 08:58:00,362 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0001 secs
2025-03-09 08:58:00,362 [INFO]: 	Selecting most promising index types given data characteristics 03/09/2025, 08:58:00
2025-03-09 08:58:00,362 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-09 08:58:00,362 [INFO]: 	Creating the index 03/09/2025, 08:58:00
2025-03-09 08:58:00,362 [INFO]: 		-> Instanciate the index HNSW15 03/09/2025, 08:58:00
2025-03-09 08:58:00,363 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0010 secs
2025-03-09 08:58:00,364 [INFO]: 		-> Adding the vectors to the index 03/09/2025, 08:58:00
2025-03-09 08:58:00,364 [INFO]: The memory available for adding the vectors is 49.0GB(total available - used by the index)
2025-03-09 08:58:00,364 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/22 [00:00<?, ?it/s]  5%|▍         | 1/22 [00:00<00:02,  9.63it/s] 32%|███▏      | 7/22 [00:00<00:00, 37.46it/s] 59%|█████▉    | 13/22 [00:00<00:00, 46.40it/s] 86%|████████▋ | 19/22 [00:00<00:00, 50.46it/s]100%|██████████| 22/22 [00:04<00:00,  4.76it/s]
2025-03-09 08:58:04,985 [INFO]: 	Computing best hyperparameters for index knn.index 03/09/2025, 08:58:04
2025-03-09 08:58:45,445 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 40.4599 secs
2025-03-09 08:58:45,445 [INFO]: The best hyperparameters are: efSearch=282
2025-03-09 08:58:45,445 [INFO]: 	Compute fast metrics 03/09/2025, 08:58:45
  0%|          | 0/4 [00:00<?, ?it/s] 75%|███████▌  | 3/4 [00:00<00:00, 27.25it/s] 75%|███████▌  | 3/4 [00:00<00:00, 23.14it/s]
2025-03-09 08:59:02,438 [INFO]: 	>>> Finished "Compute fast metrics" in 16.9924 secs
2025-03-09 08:59:02,438 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 62.0746 secs
2025-03-09 08:59:02,438 [INFO]: {
2025-03-09 08:59:02,438 [INFO]: 	index_key: HNSW15
2025-03-09 08:59:02,438 [INFO]: 	index_param: efSearch=282
2025-03-09 08:59:02,438 [INFO]: 	index_path: knn.index
2025-03-09 08:59:02,438 [INFO]: 	size in bytes: 1038021850
2025-03-09 08:59:02,438 [INFO]: 	avg_search_speed_ms: 12.578551775523982
2025-03-09 08:59:02,438 [INFO]: 	99p_search_speed_ms: 26.14727139938622
2025-03-09 08:59:02,438 [INFO]: 	reconstruction error %: 0.0
2025-03-09 08:59:02,438 [INFO]: 	nb vectors: 5276
2025-03-09 08:59:02,438 [INFO]: 	vectors dimension: 49152
2025-03-09 08:59:02,438 [INFO]: 	compression ratio: 0.999308259262558
2025-03-09 08:59:02,438 [INFO]: }
2025-03-09 08:59:02,438 [INFO]: 	>>> Finished "Creating the index" in 62.0761 secs
2025-03-09 08:59:02,439 [INFO]: >>> Finished "Launching the whole pipeline" in 62.1035 secs
2025-03-09 08:59:03: [retrieval_preprocessing] calculating distances ...
2025-03-09 08:59:04: [retrieval_preprocessing] finished and saved retrieval indices for episode 68385 [episode count 15/20]
[retrieval_preprocessing] for episode 81314 [episode count 16/20], we have num_retrieval=np.int64(5205) num_query=np.int64(277)
2025-03-09 08:59:04,916 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-09 08:59:05,602 [INFO]: Launching the whole pipeline 03/09/2025, 08:59:05
2025-03-09 08:59:05,602 [INFO]: Reading total number of vectors and dimension 03/09/2025, 08:59:05
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1357.82it/s]
2025-03-09 08:59:05,632 [INFO]: There are 5205 embeddings of dim 49152
2025-03-09 08:59:05,632 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0299 secs
2025-03-09 08:59:05,632 [INFO]: 	Compute estimated construction time of the index 03/09/2025, 08:59:05
2025-03-09 08:59:05,632 [INFO]: 		-> Train: 16.7 minutes
2025-03-09 08:59:05,633 [INFO]: 		-> Add: 2.9 seconds
2025-03-09 08:59:05,633 [INFO]: 		Total: 16.7 minutes
2025-03-09 08:59:05,633 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0001 secs
2025-03-09 08:59:05,633 [INFO]: 	Checking that your have enough memory available to create the index 03/09/2025, 08:59:05
2025-03-09 08:59:05,633 [INFO]: 1.0GB of memory will be needed to build the index (more might be used if you have more)
2025-03-09 08:59:05,633 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0002 secs
2025-03-09 08:59:05,633 [INFO]: 	Selecting most promising index types given data characteristics 03/09/2025, 08:59:05
2025-03-09 08:59:05,633 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-09 08:59:05,633 [INFO]: 	Creating the index 03/09/2025, 08:59:05
2025-03-09 08:59:05,633 [INFO]: 		-> Instanciate the index HNSW15 03/09/2025, 08:59:05
2025-03-09 08:59:05,634 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0010 secs
2025-03-09 08:59:05,634 [INFO]: 		-> Adding the vectors to the index 03/09/2025, 08:59:05
2025-03-09 08:59:05,634 [INFO]: The memory available for adding the vectors is 49.0GB(total available - used by the index)
2025-03-09 08:59:05,634 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/22 [00:00<?, ?it/s]  5%|▍         | 1/22 [00:00<00:02,  7.69it/s] 27%|██▋       | 6/22 [00:00<00:00, 28.33it/s] 45%|████▌     | 10/22 [00:00<00:00, 32.47it/s] 73%|███████▎  | 16/22 [00:00<00:00, 40.67it/s] 95%|█████████▌| 21/22 [00:04<00:00,  3.14it/s]100%|██████████| 22/22 [00:04<00:00,  4.42it/s]
2025-03-09 08:59:10,618 [INFO]: 	Computing best hyperparameters for index knn.index 03/09/2025, 08:59:10
2025-03-09 08:59:57,211 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 46.5923 secs
2025-03-09 08:59:57,211 [INFO]: The best hyperparameters are: efSearch=221
2025-03-09 08:59:57,211 [INFO]: 	Compute fast metrics 03/09/2025, 08:59:57
  0%|          | 0/4 [00:00<?, ?it/s] 50%|█████     | 2/4 [00:00<00:00, 19.74it/s] 75%|███████▌  | 3/4 [00:00<00:00, 21.35it/s]
2025-03-09 09:00:17,603 [INFO]: 	>>> Finished "Compute fast metrics" in 20.3916 secs
2025-03-09 09:00:17,603 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 71.9694 secs
2025-03-09 09:00:17,604 [INFO]: {
2025-03-09 09:00:17,604 [INFO]: 	index_key: HNSW15
2025-03-09 09:00:17,604 [INFO]: 	index_param: efSearch=221
2025-03-09 09:00:17,604 [INFO]: 	index_path: knn.index
2025-03-09 09:00:17,604 [INFO]: 	size in bytes: 1024052950
2025-03-09 09:00:17,604 [INFO]: 	avg_search_speed_ms: 9.322604826301726
2025-03-09 09:00:17,604 [INFO]: 	99p_search_speed_ms: 13.398845735937357
2025-03-09 09:00:17,604 [INFO]: 	reconstruction error %: 0.0
2025-03-09 09:00:17,604 [INFO]: 	nb vectors: 5205
2025-03-09 09:00:17,604 [INFO]: 	vectors dimension: 49152
2025-03-09 09:00:17,604 [INFO]: 	compression ratio: 0.9993083267813446
2025-03-09 09:00:17,604 [INFO]: }
2025-03-09 09:00:17,604 [INFO]: 	>>> Finished "Creating the index" in 71.9712 secs
2025-03-09 09:00:17,604 [INFO]: >>> Finished "Launching the whole pipeline" in 72.0017 secs
2025-03-09 09:00:19: [retrieval_preprocessing] calculating distances ...
2025-03-09 09:00:20: [retrieval_preprocessing] finished and saved retrieval indices for episode 81314 [episode count 16/20]
[retrieval_preprocessing] for episode 41127 [episode count 17/20], we have num_retrieval=np.int64(5296) num_query=np.int64(186)
2025-03-09 09:00:20,757 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-09 09:00:21,444 [INFO]: Launching the whole pipeline 03/09/2025, 09:00:21
2025-03-09 09:00:21,444 [INFO]: Reading total number of vectors and dimension 03/09/2025, 09:00:21
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1827.58it/s]
2025-03-09 09:00:21,473 [INFO]: There are 5296 embeddings of dim 49152
2025-03-09 09:00:21,473 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0285 secs
2025-03-09 09:00:21,473 [INFO]: 	Compute estimated construction time of the index 03/09/2025, 09:00:21
2025-03-09 09:00:21,473 [INFO]: 		-> Train: 16.7 minutes
2025-03-09 09:00:21,473 [INFO]: 		-> Add: 2.9 seconds
2025-03-09 09:00:21,473 [INFO]: 		Total: 16.7 minutes
2025-03-09 09:00:21,473 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0001 secs
2025-03-09 09:00:21,473 [INFO]: 	Checking that your have enough memory available to create the index 03/09/2025, 09:00:21
2025-03-09 09:00:21,473 [INFO]: 1.1GB of memory will be needed to build the index (more might be used if you have more)
2025-03-09 09:00:21,473 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0001 secs
2025-03-09 09:00:21,473 [INFO]: 	Selecting most promising index types given data characteristics 03/09/2025, 09:00:21
2025-03-09 09:00:21,473 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-09 09:00:21,473 [INFO]: 	Creating the index 03/09/2025, 09:00:21
2025-03-09 09:00:21,473 [INFO]: 		-> Instanciate the index HNSW15 03/09/2025, 09:00:21
2025-03-09 09:00:21,474 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0009 secs
2025-03-09 09:00:21,474 [INFO]: 		-> Adding the vectors to the index 03/09/2025, 09:00:21
2025-03-09 09:00:21,474 [INFO]: The memory available for adding the vectors is 49.0GB(total available - used by the index)
2025-03-09 09:00:21,474 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/22 [00:00<?, ?it/s]  5%|▍         | 1/22 [00:00<00:02,  8.11it/s] 32%|███▏      | 7/22 [00:00<00:00, 33.51it/s] 59%|█████▉    | 13/22 [00:00<00:00, 41.56it/s] 86%|████████▋ | 19/22 [00:00<00:00, 46.02it/s]100%|██████████| 22/22 [00:04<00:00,  4.68it/s]
2025-03-09 09:00:26,178 [INFO]: 	Computing best hyperparameters for index knn.index 03/09/2025, 09:00:26
2025-03-09 09:01:12,365 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 46.1866 secs
2025-03-09 09:01:12,365 [INFO]: The best hyperparameters are: efSearch=236
2025-03-09 09:01:12,365 [INFO]: 	Compute fast metrics 03/09/2025, 09:01:12
  0%|          | 0/4 [00:00<?, ?it/s] 75%|███████▌  | 3/4 [00:00<00:00, 25.28it/s] 75%|███████▌  | 3/4 [00:00<00:00, 21.69it/s]
2025-03-09 09:01:34,836 [INFO]: 	>>> Finished "Compute fast metrics" in 22.4709 secs
2025-03-09 09:01:34,836 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 73.3618 secs
2025-03-09 09:01:34,836 [INFO]: {
2025-03-09 09:01:34,836 [INFO]: 	index_key: HNSW15
2025-03-09 09:01:34,836 [INFO]: 	index_param: efSearch=236
2025-03-09 09:01:34,836 [INFO]: 	index_path: knn.index
2025-03-09 09:01:34,836 [INFO]: 	size in bytes: 1041956710
2025-03-09 09:01:34,836 [INFO]: 	avg_search_speed_ms: 10.90450288447874
2025-03-09 09:01:34,836 [INFO]: 	99p_search_speed_ms: 24.402699789498016
2025-03-09 09:01:34,836 [INFO]: 	reconstruction error %: 0.0
2025-03-09 09:01:34,836 [INFO]: 	nb vectors: 5296
2025-03-09 09:01:34,836 [INFO]: 	vectors dimension: 49152
2025-03-09 09:01:34,836 [INFO]: 	compression ratio: 0.9993082802835446
2025-03-09 09:01:34,836 [INFO]: }
2025-03-09 09:01:34,836 [INFO]: 	>>> Finished "Creating the index" in 73.3630 secs
2025-03-09 09:01:34,836 [INFO]: >>> Finished "Launching the whole pipeline" in 73.3921 secs
2025-03-09 09:01:36: [retrieval_preprocessing] calculating distances ...
2025-03-09 09:01:36: [retrieval_preprocessing] finished and saved retrieval indices for episode 41127 [episode count 17/20]
[retrieval_preprocessing] for episode 89128 [episode count 18/20], we have num_retrieval=np.int64(5213) num_query=np.int64(269)
2025-03-09 09:01:36,897 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-09 09:01:38,768 [INFO]: Launching the whole pipeline 03/09/2025, 09:01:38
2025-03-09 09:01:38,768 [INFO]: Reading total number of vectors and dimension 03/09/2025, 09:01:38
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1384.72it/s]
2025-03-09 09:01:38,800 [INFO]: There are 5213 embeddings of dim 49152
2025-03-09 09:01:38,801 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0328 secs
2025-03-09 09:01:38,801 [INFO]: 	Compute estimated construction time of the index 03/09/2025, 09:01:38
2025-03-09 09:01:38,801 [INFO]: 		-> Train: 16.7 minutes
2025-03-09 09:01:38,802 [INFO]: 		-> Add: 2.9 seconds
2025-03-09 09:01:38,802 [INFO]: 		Total: 16.7 minutes
2025-03-09 09:01:38,802 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0005 secs
2025-03-09 09:01:38,802 [INFO]: 	Checking that your have enough memory available to create the index 03/09/2025, 09:01:38
2025-03-09 09:01:38,802 [INFO]: 1.1GB of memory will be needed to build the index (more might be used if you have more)
2025-03-09 09:01:38,802 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0005 secs
2025-03-09 09:01:38,803 [INFO]: 	Selecting most promising index types given data characteristics 03/09/2025, 09:01:38
2025-03-09 09:01:38,803 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-09 09:01:38,803 [INFO]: 	Creating the index 03/09/2025, 09:01:38
2025-03-09 09:01:38,803 [INFO]: 		-> Instanciate the index HNSW15 03/09/2025, 09:01:38
2025-03-09 09:01:38,806 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0027 secs
2025-03-09 09:01:38,806 [INFO]: 		-> Adding the vectors to the index 03/09/2025, 09:01:38
2025-03-09 09:01:38,807 [INFO]: The memory available for adding the vectors is 49.0GB(total available - used by the index)
2025-03-09 09:01:38,807 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/22 [00:00<?, ?it/s]  9%|▉         | 2/22 [00:00<00:01, 17.52it/s] 32%|███▏      | 7/22 [00:00<00:00, 33.09it/s] 55%|█████▍    | 12/22 [00:00<00:00, 38.20it/s] 77%|███████▋  | 17/22 [00:00<00:00, 40.45it/s]100%|██████████| 22/22 [00:04<00:00,  2.88it/s]100%|██████████| 22/22 [00:04<00:00,  4.57it/s]
2025-03-09 09:01:43,625 [INFO]: 	Computing best hyperparameters for index knn.index 03/09/2025, 09:01:43
2025-03-09 09:02:29,675 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 46.0503 secs
2025-03-09 09:02:29,676 [INFO]: The best hyperparameters are: efSearch=215
2025-03-09 09:02:29,676 [INFO]: 	Compute fast metrics 03/09/2025, 09:02:29
  0%|          | 0/4 [00:00<?, ?it/s] 25%|██▌       | 1/4 [00:00<00:00,  8.28it/s] 75%|███████▌  | 3/4 [00:00<00:00, 16.09it/s]
2025-03-09 09:02:47,437 [INFO]: 	>>> Finished "Compute fast metrics" in 17.7608 secs
2025-03-09 09:02:47,437 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 68.6308 secs
2025-03-09 09:02:47,437 [INFO]: {
2025-03-09 09:02:47,437 [INFO]: 	index_key: HNSW15
2025-03-09 09:02:47,437 [INFO]: 	index_param: efSearch=215
2025-03-09 09:02:47,437 [INFO]: 	index_path: knn.index
2025-03-09 09:02:47,437 [INFO]: 	size in bytes: 1025626870
2025-03-09 09:02:47,437 [INFO]: 	avg_search_speed_ms: 11.01698700081155
2025-03-09 09:02:47,437 [INFO]: 	99p_search_speed_ms: 25.620871037244783
2025-03-09 09:02:47,437 [INFO]: 	reconstruction error %: 0.0
2025-03-09 09:02:47,437 [INFO]: 	nb vectors: 5213
2025-03-09 09:02:47,437 [INFO]: 	vectors dimension: 49152
2025-03-09 09:02:47,437 [INFO]: 	compression ratio: 0.9993083586041384
2025-03-09 09:02:47,437 [INFO]: }
2025-03-09 09:02:47,437 [INFO]: 	>>> Finished "Creating the index" in 68.6342 secs
2025-03-09 09:02:47,437 [INFO]: >>> Finished "Launching the whole pipeline" in 68.6694 secs
2025-03-09 09:02:48: [retrieval_preprocessing] calculating distances ...
2025-03-09 09:02:49: [retrieval_preprocessing] finished and saved retrieval indices for episode 89128 [episode count 18/20]
[retrieval_preprocessing] for episode 35119 [episode count 19/20], we have num_retrieval=np.int64(5207) num_query=np.int64(275)
2025-03-09 09:02:49,672 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-09 09:02:50,430 [INFO]: Launching the whole pipeline 03/09/2025, 09:02:50
2025-03-09 09:02:50,430 [INFO]: Reading total number of vectors and dimension 03/09/2025, 09:02:50
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1261.07it/s]
2025-03-09 09:02:50,460 [INFO]: There are 5207 embeddings of dim 49152
2025-03-09 09:02:50,460 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0295 secs
2025-03-09 09:02:50,460 [INFO]: 	Compute estimated construction time of the index 03/09/2025, 09:02:50
2025-03-09 09:02:50,460 [INFO]: 		-> Train: 16.7 minutes
2025-03-09 09:02:50,460 [INFO]: 		-> Add: 2.9 seconds
2025-03-09 09:02:50,460 [INFO]: 		Total: 16.7 minutes
2025-03-09 09:02:50,460 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0001 secs
2025-03-09 09:02:50,460 [INFO]: 	Checking that your have enough memory available to create the index 03/09/2025, 09:02:50
2025-03-09 09:02:50,460 [INFO]: 1.0GB of memory will be needed to build the index (more might be used if you have more)
2025-03-09 09:02:50,460 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0001 secs
2025-03-09 09:02:50,460 [INFO]: 	Selecting most promising index types given data characteristics 03/09/2025, 09:02:50
2025-03-09 09:02:50,460 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-09 09:02:50,460 [INFO]: 	Creating the index 03/09/2025, 09:02:50
2025-03-09 09:02:50,461 [INFO]: 		-> Instanciate the index HNSW15 03/09/2025, 09:02:50
2025-03-09 09:02:50,461 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0010 secs
2025-03-09 09:02:50,462 [INFO]: 		-> Adding the vectors to the index 03/09/2025, 09:02:50
2025-03-09 09:02:50,462 [INFO]: The memory available for adding the vectors is 49.0GB(total available - used by the index)
2025-03-09 09:02:50,462 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/22 [00:00<?, ?it/s]  5%|▍         | 1/22 [00:00<00:02,  8.30it/s] 32%|███▏      | 7/22 [00:00<00:00, 35.57it/s] 59%|█████▉    | 13/22 [00:00<00:00, 45.98it/s] 86%|████████▋ | 19/22 [00:00<00:00, 51.14it/s]100%|██████████| 22/22 [00:04<00:00,  4.56it/s]
2025-03-09 09:02:55,293 [INFO]: 	Computing best hyperparameters for index knn.index 03/09/2025, 09:02:55
2025-03-09 09:03:36,665 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 41.3713 secs
2025-03-09 09:03:36,665 [INFO]: The best hyperparameters are: efSearch=221
2025-03-09 09:03:36,665 [INFO]: 	Compute fast metrics 03/09/2025, 09:03:36
  0%|          | 0/4 [00:00<?, ?it/s] 75%|███████▌  | 3/4 [00:00<00:00, 27.16it/s] 75%|███████▌  | 3/4 [00:00<00:00, 21.54it/s]
2025-03-09 09:03:52,123 [INFO]: 	>>> Finished "Compute fast metrics" in 15.4584 secs
2025-03-09 09:03:52,124 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 61.6622 secs
2025-03-09 09:03:52,124 [INFO]: {
2025-03-09 09:03:52,124 [INFO]: 	index_key: HNSW15
2025-03-09 09:03:52,124 [INFO]: 	index_param: efSearch=221
2025-03-09 09:03:52,124 [INFO]: 	index_path: knn.index
2025-03-09 09:03:52,124 [INFO]: 	size in bytes: 1024446430
2025-03-09 09:03:52,124 [INFO]: 	avg_search_speed_ms: 10.386617863183282
2025-03-09 09:03:52,124 [INFO]: 	99p_search_speed_ms: 21.758929798379537
2025-03-09 09:03:52,124 [INFO]: 	reconstruction error %: 0.0
2025-03-09 09:03:52,124 [INFO]: 	nb vectors: 5207
2025-03-09 09:03:52,124 [INFO]: 	vectors dimension: 49152
2025-03-09 09:03:52,124 [INFO]: 	compression ratio: 0.9993083347462102
2025-03-09 09:03:52,124 [INFO]: }
2025-03-09 09:03:52,124 [INFO]: 	>>> Finished "Creating the index" in 61.6636 secs
2025-03-09 09:03:52,124 [INFO]: >>> Finished "Launching the whole pipeline" in 61.6936 secs
2025-03-09 09:03:53: [retrieval_preprocessing] calculating distances ...
2025-03-09 09:03:54: [retrieval_preprocessing] finished and saved retrieval indices for episode 35119 [episode count 19/20]
2025-03-09 09:03:54: [retrieval_preprocessing] finished for (7644292911, 'marker') [chosen_id count 6/10]
2025-03-09 09:03:56: [retrieval_preprocessing] concatenated all embeddings and indices for 20 episodes for (1775582436, 'marker') [chosen_id count 7/10]
2025-03-09 09:03:56: [retrieval_preprocessing] we have num_total=3055 embedding_dim=49152
[retrieval_preprocessing] for episode 2050 [episode count 0/20], we have num_retrieval=np.int64(2939) num_query=np.int64(116)
2025-03-09 09:03:56,320 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-09 09:03:56,841 [INFO]: Launching the whole pipeline 03/09/2025, 09:03:56
2025-03-09 09:03:56,842 [INFO]: Reading total number of vectors and dimension 03/09/2025, 09:03:56
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 2200.58it/s]
2025-03-09 09:03:56,875 [INFO]: There are 2939 embeddings of dim 49152
2025-03-09 09:03:56,875 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0338 secs
2025-03-09 09:03:56,875 [INFO]: 	Compute estimated construction time of the index 03/09/2025, 09:03:56
2025-03-09 09:03:56,876 [INFO]: 		-> Train: 16.7 minutes
2025-03-09 09:03:56,876 [INFO]: 		-> Add: 1.6 seconds
2025-03-09 09:03:56,876 [INFO]: 		Total: 16.7 minutes
2025-03-09 09:03:56,876 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0001 secs
2025-03-09 09:03:56,876 [INFO]: 	Checking that your have enough memory available to create the index 03/09/2025, 09:03:56
2025-03-09 09:03:56,876 [INFO]: 606.5MB of memory will be needed to build the index (more might be used if you have more)
2025-03-09 09:03:56,876 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0002 secs
2025-03-09 09:03:56,876 [INFO]: 	Selecting most promising index types given data characteristics 03/09/2025, 09:03:56
2025-03-09 09:03:56,876 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-09 09:03:56,876 [INFO]: 	Creating the index 03/09/2025, 09:03:56
2025-03-09 09:03:56,876 [INFO]: 		-> Instanciate the index HNSW15 03/09/2025, 09:03:56
2025-03-09 09:03:56,877 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0011 secs
2025-03-09 09:03:56,877 [INFO]: 		-> Adding the vectors to the index 03/09/2025, 09:03:56
2025-03-09 09:03:56,877 [INFO]: The memory available for adding the vectors is 49.5GB(total available - used by the index)
2025-03-09 09:03:56,877 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/12 [00:00<?, ?it/s] 17%|█▋        | 2/12 [00:00<00:00, 17.38it/s] 50%|█████     | 6/12 [00:00<00:00, 27.55it/s] 92%|█████████▏| 11/12 [00:00<00:00, 36.61it/s]100%|██████████| 12/12 [00:02<00:00,  5.07it/s]
2025-03-09 09:03:59,249 [INFO]: 	Computing best hyperparameters for index knn.index 03/09/2025, 09:03:59
2025-03-09 09:04:31,752 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 32.5025 secs
2025-03-09 09:04:31,752 [INFO]: The best hyperparameters are: efSearch=261
2025-03-09 09:04:31,752 [INFO]: 	Compute fast metrics 03/09/2025, 09:04:31
  0%|          | 0/4 [00:00<?, ?it/s] 50%|█████     | 2/4 [00:00<00:00, 19.72it/s] 75%|███████▌  | 3/4 [00:00<00:00, 21.27it/s]
2025-03-09 09:04:46,855 [INFO]: 	>>> Finished "Compute fast metrics" in 15.1027 secs
2025-03-09 09:04:46,857 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 49.9797 secs
2025-03-09 09:04:46,857 [INFO]: {
2025-03-09 09:04:46,857 [INFO]: 	index_key: HNSW15
2025-03-09 09:04:46,857 [INFO]: 	index_param: efSearch=261
2025-03-09 09:04:46,857 [INFO]: 	index_path: knn.index
2025-03-09 09:04:46,857 [INFO]: 	size in bytes: 578230030
2025-03-09 09:04:46,857 [INFO]: 	avg_search_speed_ms: 11.376680984809164
2025-03-09 09:04:46,857 [INFO]: 	99p_search_speed_ms: 24.137446065433327
2025-03-09 09:04:46,857 [INFO]: 	reconstruction error %: 0.0
2025-03-09 09:04:46,857 [INFO]: 	nb vectors: 2939
2025-03-09 09:04:46,857 [INFO]: 	vectors dimension: 49152
2025-03-09 09:04:46,857 [INFO]: 	compression ratio: 0.9993097591282141
2025-03-09 09:04:46,857 [INFO]: }
2025-03-09 09:04:46,857 [INFO]: 	>>> Finished "Creating the index" in 49.9813 secs
2025-03-09 09:04:46,857 [INFO]: >>> Finished "Launching the whole pipeline" in 50.0158 secs
2025-03-09 09:04:47: [retrieval_preprocessing] calculating distances ...
2025-03-09 09:04:48: [retrieval_preprocessing] finished and saved retrieval indices for episode 2050 [episode count 0/20]
[retrieval_preprocessing] for episode 38403 [episode count 1/20], we have num_retrieval=np.int64(2892) num_query=np.int64(163)
2025-03-09 09:04:48,453 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-09 09:04:48,982 [INFO]: Launching the whole pipeline 03/09/2025, 09:04:48
2025-03-09 09:04:48,983 [INFO]: Reading total number of vectors and dimension 03/09/2025, 09:04:48
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 2007.80it/s]
2025-03-09 09:04:49,014 [INFO]: There are 2892 embeddings of dim 49152
2025-03-09 09:04:49,014 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0313 secs
2025-03-09 09:04:49,014 [INFO]: 	Compute estimated construction time of the index 03/09/2025, 09:04:49
2025-03-09 09:04:49,014 [INFO]: 		-> Train: 16.7 minutes
2025-03-09 09:04:49,014 [INFO]: 		-> Add: 1.6 seconds
2025-03-09 09:04:49,014 [INFO]: 		Total: 16.7 minutes
2025-03-09 09:04:49,014 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0001 secs
2025-03-09 09:04:49,014 [INFO]: 	Checking that your have enough memory available to create the index 03/09/2025, 09:04:49
2025-03-09 09:04:49,014 [INFO]: 596.8MB of memory will be needed to build the index (more might be used if you have more)
2025-03-09 09:04:49,014 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0002 secs
2025-03-09 09:04:49,014 [INFO]: 	Selecting most promising index types given data characteristics 03/09/2025, 09:04:49
2025-03-09 09:04:49,015 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-09 09:04:49,015 [INFO]: 	Creating the index 03/09/2025, 09:04:49
2025-03-09 09:04:49,015 [INFO]: 		-> Instanciate the index HNSW15 03/09/2025, 09:04:49
2025-03-09 09:04:49,016 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0012 secs
2025-03-09 09:04:49,016 [INFO]: 		-> Adding the vectors to the index 03/09/2025, 09:04:49
2025-03-09 09:04:49,016 [INFO]: The memory available for adding the vectors is 49.5GB(total available - used by the index)
2025-03-09 09:04:49,016 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/12 [00:00<?, ?it/s]  8%|▊         | 1/12 [00:00<00:01,  7.23it/s] 50%|█████     | 6/12 [00:00<00:00, 26.72it/s] 92%|█████████▏| 11/12 [00:00<00:00, 33.93it/s]100%|██████████| 12/12 [00:02<00:00,  4.21it/s]
2025-03-09 09:04:51,869 [INFO]: 	Computing best hyperparameters for index knn.index 03/09/2025, 09:04:51
2025-03-09 09:05:20,431 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 28.5612 secs
2025-03-09 09:05:20,431 [INFO]: The best hyperparameters are: efSearch=254
2025-03-09 09:05:20,431 [INFO]: 	Compute fast metrics 03/09/2025, 09:05:20
  0%|          | 0/4 [00:00<?, ?it/s] 75%|███████▌  | 3/4 [00:00<00:00, 26.75it/s] 75%|███████▌  | 3/4 [00:00<00:00, 23.08it/s]
2025-03-09 09:05:38,017 [INFO]: 	>>> Finished "Compute fast metrics" in 17.5858 secs
2025-03-09 09:05:38,018 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 49.0022 secs
2025-03-09 09:05:38,018 [INFO]: {
2025-03-09 09:05:38,018 [INFO]: 	index_key: HNSW15
2025-03-09 09:05:38,018 [INFO]: 	index_param: efSearch=254
2025-03-09 09:05:38,018 [INFO]: 	index_path: knn.index
2025-03-09 09:05:38,018 [INFO]: 	size in bytes: 568983070
2025-03-09 09:05:38,018 [INFO]: 	avg_search_speed_ms: 9.27093595182618
2025-03-09 09:05:38,018 [INFO]: 	99p_search_speed_ms: 14.796363702043893
2025-03-09 09:05:38,018 [INFO]: 	reconstruction error %: 0.0
2025-03-09 09:05:38,018 [INFO]: 	nb vectors: 2892
2025-03-09 09:05:38,018 [INFO]: 	vectors dimension: 49152
2025-03-09 09:05:38,019 [INFO]: 	compression ratio: 0.99930976153649
2025-03-09 09:05:38,019 [INFO]: }
2025-03-09 09:05:38,019 [INFO]: 	>>> Finished "Creating the index" in 49.0039 secs
2025-03-09 09:05:38,019 [INFO]: >>> Finished "Launching the whole pipeline" in 49.0360 secs
2025-03-09 09:05:38: [retrieval_preprocessing] calculating distances ...
2025-03-09 09:05:39: [retrieval_preprocessing] finished and saved retrieval indices for episode 38403 [episode count 1/20]
[retrieval_preprocessing] for episode 53764 [episode count 2/20], we have num_retrieval=np.int64(2903) num_query=np.int64(152)
2025-03-09 09:05:39,538 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-09 09:05:39,937 [INFO]: Launching the whole pipeline 03/09/2025, 09:05:39
2025-03-09 09:05:39,937 [INFO]: Reading total number of vectors and dimension 03/09/2025, 09:05:39
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1901.32it/s]
2025-03-09 09:05:39,966 [INFO]: There are 2903 embeddings of dim 49152
2025-03-09 09:05:39,966 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0292 secs
2025-03-09 09:05:39,966 [INFO]: 	Compute estimated construction time of the index 03/09/2025, 09:05:39
2025-03-09 09:05:39,966 [INFO]: 		-> Train: 16.7 minutes
2025-03-09 09:05:39,966 [INFO]: 		-> Add: 1.6 seconds
2025-03-09 09:05:39,966 [INFO]: 		Total: 16.7 minutes
2025-03-09 09:05:39,966 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0001 secs
2025-03-09 09:05:39,966 [INFO]: 	Checking that your have enough memory available to create the index 03/09/2025, 09:05:39
2025-03-09 09:05:39,966 [INFO]: 599.1MB of memory will be needed to build the index (more might be used if you have more)
2025-03-09 09:05:39,966 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0002 secs
2025-03-09 09:05:39,967 [INFO]: 	Selecting most promising index types given data characteristics 03/09/2025, 09:05:39
2025-03-09 09:05:39,967 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-09 09:05:39,967 [INFO]: 	Creating the index 03/09/2025, 09:05:39
2025-03-09 09:05:39,967 [INFO]: 		-> Instanciate the index HNSW15 03/09/2025, 09:05:39
2025-03-09 09:05:39,967 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0008 secs
2025-03-09 09:05:39,968 [INFO]: 		-> Adding the vectors to the index 03/09/2025, 09:05:39
2025-03-09 09:05:39,968 [INFO]: The memory available for adding the vectors is 49.5GB(total available - used by the index)
2025-03-09 09:05:39,968 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/12 [00:00<?, ?it/s]  8%|▊         | 1/12 [00:00<00:01,  9.01it/s] 50%|█████     | 6/12 [00:00<00:00, 30.07it/s] 92%|█████████▏| 11/12 [00:00<00:00, 36.64it/s]100%|██████████| 12/12 [00:02<00:00,  5.52it/s]
2025-03-09 09:05:42,144 [INFO]: 	Computing best hyperparameters for index knn.index 03/09/2025, 09:05:42
2025-03-09 09:06:14,192 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 32.0481 secs
2025-03-09 09:06:14,192 [INFO]: The best hyperparameters are: efSearch=295
2025-03-09 09:06:14,193 [INFO]: 	Compute fast metrics 03/09/2025, 09:06:14
  0%|          | 0/4 [00:00<?, ?it/s] 50%|█████     | 2/4 [00:00<00:00, 19.84it/s] 75%|███████▌  | 3/4 [00:00<00:00, 21.85it/s]
2025-03-09 09:06:30,764 [INFO]: 	>>> Finished "Compute fast metrics" in 16.5710 secs
2025-03-09 09:06:30,766 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 50.7980 secs
2025-03-09 09:06:30,766 [INFO]: {
2025-03-09 09:06:30,766 [INFO]: 	index_key: HNSW15
2025-03-09 09:06:30,766 [INFO]: 	index_param: efSearch=295
2025-03-09 09:06:30,766 [INFO]: 	index_path: knn.index
2025-03-09 09:06:30,766 [INFO]: 	size in bytes: 571147210
2025-03-09 09:06:30,766 [INFO]: 	avg_search_speed_ms: 11.306850906556187
2025-03-09 09:06:30,766 [INFO]: 	99p_search_speed_ms: 24.563921177759756
2025-03-09 09:06:30,766 [INFO]: 	reconstruction error %: 0.0
2025-03-09 09:06:30,766 [INFO]: 	nb vectors: 2903
2025-03-09 09:06:30,766 [INFO]: 	vectors dimension: 49152
2025-03-09 09:06:30,766 [INFO]: 	compression ratio: 0.9993098346746717
2025-03-09 09:06:30,766 [INFO]: }
2025-03-09 09:06:30,766 [INFO]: 	>>> Finished "Creating the index" in 50.7994 secs
2025-03-09 09:06:30,766 [INFO]: >>> Finished "Launching the whole pipeline" in 50.8293 secs
2025-03-09 09:06:32: [retrieval_preprocessing] calculating distances ...
2025-03-09 09:06:32: [retrieval_preprocessing] finished and saved retrieval indices for episode 53764 [episode count 2/20]
[retrieval_preprocessing] for episode 50696 [episode count 3/20], we have num_retrieval=np.int64(2922) num_query=np.int64(133)
2025-03-09 09:06:32,946 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-09 09:06:33,332 [INFO]: Launching the whole pipeline 03/09/2025, 09:06:33
2025-03-09 09:06:33,332 [INFO]: Reading total number of vectors and dimension 03/09/2025, 09:06:33
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 2192.53it/s]
2025-03-09 09:06:33,366 [INFO]: There are 2922 embeddings of dim 49152
2025-03-09 09:06:33,367 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0343 secs
2025-03-09 09:06:33,367 [INFO]: 	Compute estimated construction time of the index 03/09/2025, 09:06:33
2025-03-09 09:06:33,367 [INFO]: 		-> Train: 16.7 minutes
2025-03-09 09:06:33,367 [INFO]: 		-> Add: 1.6 seconds
2025-03-09 09:06:33,367 [INFO]: 		Total: 16.7 minutes
2025-03-09 09:06:33,367 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0003 secs
2025-03-09 09:06:33,367 [INFO]: 	Checking that your have enough memory available to create the index 03/09/2025, 09:06:33
2025-03-09 09:06:33,367 [INFO]: 603.0MB of memory will be needed to build the index (more might be used if you have more)
2025-03-09 09:06:33,367 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0002 secs
2025-03-09 09:06:33,367 [INFO]: 	Selecting most promising index types given data characteristics 03/09/2025, 09:06:33
2025-03-09 09:06:33,367 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-09 09:06:33,367 [INFO]: 	Creating the index 03/09/2025, 09:06:33
2025-03-09 09:06:33,367 [INFO]: 		-> Instanciate the index HNSW15 03/09/2025, 09:06:33
2025-03-09 09:06:33,369 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0012 secs
2025-03-09 09:06:33,369 [INFO]: 		-> Adding the vectors to the index 03/09/2025, 09:06:33
2025-03-09 09:06:33,369 [INFO]: The memory available for adding the vectors is 49.5GB(total available - used by the index)
2025-03-09 09:06:33,369 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/12 [00:00<?, ?it/s]  8%|▊         | 1/12 [00:00<00:01,  8.51it/s] 58%|█████▊    | 7/12 [00:00<00:00, 33.33it/s]100%|██████████| 12/12 [00:02<00:00,  3.78it/s]100%|██████████| 12/12 [00:02<00:00,  4.51it/s]
2025-03-09 09:06:36,037 [INFO]: 	Computing best hyperparameters for index knn.index 03/09/2025, 09:06:36
2025-03-09 09:07:06,291 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 30.2543 secs
2025-03-09 09:07:06,292 [INFO]: The best hyperparameters are: efSearch=246
2025-03-09 09:07:06,292 [INFO]: 	Compute fast metrics 03/09/2025, 09:07:06
  0%|          | 0/4 [00:00<?, ?it/s] 25%|██▌       | 1/4 [00:00<00:00,  9.75it/s] 75%|███████▌  | 3/4 [00:00<00:00, 18.70it/s]
2025-03-09 09:07:22,456 [INFO]: 	>>> Finished "Compute fast metrics" in 16.1644 secs
2025-03-09 09:07:22,458 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 49.0895 secs
2025-03-09 09:07:22,458 [INFO]: {
2025-03-09 09:07:22,458 [INFO]: 	index_key: HNSW15
2025-03-09 09:07:22,458 [INFO]: 	index_param: efSearch=246
2025-03-09 09:07:22,458 [INFO]: 	index_path: knn.index
2025-03-09 09:07:22,458 [INFO]: 	size in bytes: 574885330
2025-03-09 09:07:22,458 [INFO]: 	avg_search_speed_ms: 10.599329844423002
2025-03-09 09:07:22,459 [INFO]: 	99p_search_speed_ms: 20.647321823053062
2025-03-09 09:07:22,459 [INFO]: 	reconstruction error %: 0.0
2025-03-09 09:07:22,459 [INFO]: 	nb vectors: 2922
2025-03-09 09:07:22,459 [INFO]: 	vectors dimension: 49152
2025-03-09 09:07:22,459 [INFO]: 	compression ratio: 0.9993098554106433
2025-03-09 09:07:22,459 [INFO]: }
2025-03-09 09:07:22,459 [INFO]: 	>>> Finished "Creating the index" in 49.0912 secs
2025-03-09 09:07:22,459 [INFO]: >>> Finished "Launching the whole pipeline" in 49.1264 secs
2025-03-09 09:07:23: [retrieval_preprocessing] calculating distances ...
2025-03-09 09:07:23: [retrieval_preprocessing] finished and saved retrieval indices for episode 50696 [episode count 3/20]
[retrieval_preprocessing] for episode 66579 [episode count 4/20], we have num_retrieval=np.int64(2936) num_query=np.int64(119)
2025-03-09 09:07:23,927 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-09 09:07:24,320 [INFO]: Launching the whole pipeline 03/09/2025, 09:07:24
2025-03-09 09:07:24,320 [INFO]: Reading total number of vectors and dimension 03/09/2025, 09:07:24
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 2032.12it/s]
2025-03-09 09:07:24,350 [INFO]: There are 2936 embeddings of dim 49152
2025-03-09 09:07:24,350 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0297 secs
2025-03-09 09:07:24,350 [INFO]: 	Compute estimated construction time of the index 03/09/2025, 09:07:24
2025-03-09 09:07:24,350 [INFO]: 		-> Train: 16.7 minutes
2025-03-09 09:07:24,350 [INFO]: 		-> Add: 1.6 seconds
2025-03-09 09:07:24,350 [INFO]: 		Total: 16.7 minutes
2025-03-09 09:07:24,350 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0001 secs
2025-03-09 09:07:24,350 [INFO]: 	Checking that your have enough memory available to create the index 03/09/2025, 09:07:24
2025-03-09 09:07:24,351 [INFO]: 605.9MB of memory will be needed to build the index (more might be used if you have more)
2025-03-09 09:07:24,351 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0001 secs
2025-03-09 09:07:24,351 [INFO]: 	Selecting most promising index types given data characteristics 03/09/2025, 09:07:24
2025-03-09 09:07:24,351 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-09 09:07:24,351 [INFO]: 	Creating the index 03/09/2025, 09:07:24
2025-03-09 09:07:24,351 [INFO]: 		-> Instanciate the index HNSW15 03/09/2025, 09:07:24
2025-03-09 09:07:24,352 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0009 secs
2025-03-09 09:07:24,352 [INFO]: 		-> Adding the vectors to the index 03/09/2025, 09:07:24
2025-03-09 09:07:24,352 [INFO]: The memory available for adding the vectors is 49.5GB(total available - used by the index)
2025-03-09 09:07:24,352 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/12 [00:00<?, ?it/s]  8%|▊         | 1/12 [00:00<00:01,  7.17it/s] 50%|█████     | 6/12 [00:00<00:00, 26.39it/s] 92%|█████████▏| 11/12 [00:00<00:00, 33.95it/s]100%|██████████| 12/12 [00:02<00:00,  4.08it/s]
2025-03-09 09:07:27,299 [INFO]: 	Computing best hyperparameters for index knn.index 03/09/2025, 09:07:27
2025-03-09 09:07:58,179 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 30.8805 secs
2025-03-09 09:07:58,180 [INFO]: The best hyperparameters are: efSearch=288
2025-03-09 09:07:58,180 [INFO]: 	Compute fast metrics 03/09/2025, 09:07:58
  0%|          | 0/4 [00:00<?, ?it/s] 50%|█████     | 2/4 [00:00<00:00, 18.49it/s] 75%|███████▌  | 3/4 [00:00<00:00, 20.07it/s]
2025-03-09 09:08:14,163 [INFO]: 	>>> Finished "Compute fast metrics" in 15.9832 secs
2025-03-09 09:08:14,165 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 49.8131 secs
2025-03-09 09:08:14,165 [INFO]: {
2025-03-09 09:08:14,165 [INFO]: 	index_key: HNSW15
2025-03-09 09:08:14,165 [INFO]: 	index_param: efSearch=288
2025-03-09 09:08:14,165 [INFO]: 	index_path: knn.index
2025-03-09 09:08:14,165 [INFO]: 	size in bytes: 577639810
2025-03-09 09:08:14,165 [INFO]: 	avg_search_speed_ms: 13.172004114203302
2025-03-09 09:08:14,165 [INFO]: 	99p_search_speed_ms: 19.934342144988474
2025-03-09 09:08:14,165 [INFO]: 	reconstruction error %: 0.0
2025-03-09 09:08:14,165 [INFO]: 	nb vectors: 2936
2025-03-09 09:08:14,165 [INFO]: 	vectors dimension: 49152
2025-03-09 09:08:14,165 [INFO]: 	compression ratio: 0.9993097394031758
2025-03-09 09:08:14,165 [INFO]: }
2025-03-09 09:08:14,165 [INFO]: 	>>> Finished "Creating the index" in 49.8146 secs
2025-03-09 09:08:14,165 [INFO]: >>> Finished "Launching the whole pipeline" in 49.8450 secs
2025-03-09 09:08:14: [retrieval_preprocessing] calculating distances ...
2025-03-09 09:08:15: [retrieval_preprocessing] finished and saved retrieval indices for episode 66579 [episode count 4/20]
[retrieval_preprocessing] for episode 91672 [episode count 5/20], we have num_retrieval=np.int64(2910) num_query=np.int64(145)
2025-03-09 09:08:15,929 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-09 09:08:16,434 [INFO]: Launching the whole pipeline 03/09/2025, 09:08:16
2025-03-09 09:08:16,434 [INFO]: Reading total number of vectors and dimension 03/09/2025, 09:08:16
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1267.54it/s]
2025-03-09 09:08:16,468 [INFO]: There are 2910 embeddings of dim 49152
2025-03-09 09:08:16,469 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0343 secs
2025-03-09 09:08:16,469 [INFO]: 	Compute estimated construction time of the index 03/09/2025, 09:08:16
2025-03-09 09:08:16,469 [INFO]: 		-> Train: 16.7 minutes
2025-03-09 09:08:16,469 [INFO]: 		-> Add: 1.6 seconds
2025-03-09 09:08:16,469 [INFO]: 		Total: 16.7 minutes
2025-03-09 09:08:16,469 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0003 secs
2025-03-09 09:08:16,469 [INFO]: 	Checking that your have enough memory available to create the index 03/09/2025, 09:08:16
2025-03-09 09:08:16,470 [INFO]: 600.6MB of memory will be needed to build the index (more might be used if you have more)
2025-03-09 09:08:16,470 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0005 secs
2025-03-09 09:08:16,470 [INFO]: 	Selecting most promising index types given data characteristics 03/09/2025, 09:08:16
2025-03-09 09:08:16,470 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-09 09:08:16,470 [INFO]: 	Creating the index 03/09/2025, 09:08:16
2025-03-09 09:08:16,470 [INFO]: 		-> Instanciate the index HNSW15 03/09/2025, 09:08:16
2025-03-09 09:08:16,473 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0028 secs
2025-03-09 09:08:16,473 [INFO]: 		-> Adding the vectors to the index 03/09/2025, 09:08:16
2025-03-09 09:08:16,474 [INFO]: The memory available for adding the vectors is 49.5GB(total available - used by the index)
2025-03-09 09:08:16,474 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/12 [00:00<?, ?it/s]  8%|▊         | 1/12 [00:00<00:01,  5.85it/s] 17%|█▋        | 2/12 [00:00<00:01,  7.38it/s] 25%|██▌       | 3/12 [00:00<00:01,  8.01it/s] 33%|███▎      | 4/12 [00:00<00:00,  8.35it/s] 42%|████▏     | 5/12 [00:00<00:00,  8.53it/s] 50%|█████     | 6/12 [00:00<00:00,  8.64it/s] 58%|█████▊    | 7/12 [00:00<00:00,  8.56it/s] 67%|██████▋   | 8/12 [00:00<00:00,  8.32it/s] 75%|███████▌  | 9/12 [00:01<00:00,  8.26it/s] 83%|████████▎ | 10/12 [00:01<00:00,  8.33it/s] 92%|█████████▏| 11/12 [00:01<00:00,  8.38it/s]100%|██████████| 12/12 [00:03<00:00,  1.27it/s]100%|██████████| 12/12 [00:03<00:00,  3.29it/s]
2025-03-09 09:08:20,135 [INFO]: 	Computing best hyperparameters for index knn.index 03/09/2025, 09:08:20
2025-03-09 09:09:01,652 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 41.5157 secs
2025-03-09 09:09:01,652 [INFO]: The best hyperparameters are: efSearch=193
2025-03-09 09:09:01,652 [INFO]: 	Compute fast metrics 03/09/2025, 09:09:01
  0%|          | 0/4 [00:00<?, ?it/s] 50%|█████     | 2/4 [00:00<00:00, 17.76it/s] 75%|███████▌  | 3/4 [00:00<00:00, 18.95it/s]
2025-03-09 09:09:15,591 [INFO]: 	>>> Finished "Compute fast metrics" in 13.9382 secs
2025-03-09 09:09:15,594 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 59.1204 secs
2025-03-09 09:09:15,594 [INFO]: {
2025-03-09 09:09:15,594 [INFO]: 	index_key: HNSW15
2025-03-09 09:09:15,594 [INFO]: 	index_param: efSearch=193
2025-03-09 09:09:15,594 [INFO]: 	index_path: knn.index
2025-03-09 09:09:15,594 [INFO]: 	size in bytes: 572524390
2025-03-09 09:09:15,594 [INFO]: 	avg_search_speed_ms: 10.200130536781662
2025-03-09 09:09:15,594 [INFO]: 	99p_search_speed_ms: 21.285199450794618
2025-03-09 09:09:15,594 [INFO]: 	reconstruction error %: 0.0
2025-03-09 09:09:15,594 [INFO]: 	nb vectors: 2910
2025-03-09 09:09:15,594 [INFO]: 	vectors dimension: 49152
2025-03-09 09:09:15,594 [INFO]: 	compression ratio: 0.9993098809292649
2025-03-09 09:09:15,594 [INFO]: }
2025-03-09 09:09:15,594 [INFO]: 	>>> Finished "Creating the index" in 59.1242 secs
2025-03-09 09:09:15,594 [INFO]: >>> Finished "Launching the whole pipeline" in 59.1603 secs
2025-03-09 09:09:16: [retrieval_preprocessing] calculating distances ...
2025-03-09 09:09:16: [retrieval_preprocessing] finished and saved retrieval indices for episode 91672 [episode count 5/20]
[retrieval_preprocessing] for episode 53280 [episode count 6/20], we have num_retrieval=np.int64(2920) num_query=np.int64(135)
2025-03-09 09:09:17,169 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-09 09:09:17,653 [INFO]: Launching the whole pipeline 03/09/2025, 09:09:17
2025-03-09 09:09:17,654 [INFO]: Reading total number of vectors and dimension 03/09/2025, 09:09:17
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1383.35it/s]
2025-03-09 09:09:17,689 [INFO]: There are 2920 embeddings of dim 49152
2025-03-09 09:09:17,689 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0356 secs
2025-03-09 09:09:17,689 [INFO]: 	Compute estimated construction time of the index 03/09/2025, 09:09:17
2025-03-09 09:09:17,690 [INFO]: 		-> Train: 16.7 minutes
2025-03-09 09:09:17,690 [INFO]: 		-> Add: 1.6 seconds
2025-03-09 09:09:17,690 [INFO]: 		Total: 16.7 minutes
2025-03-09 09:09:17,690 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0003 secs
2025-03-09 09:09:17,690 [INFO]: 	Checking that your have enough memory available to create the index 03/09/2025, 09:09:17
2025-03-09 09:09:17,690 [INFO]: 602.6MB of memory will be needed to build the index (more might be used if you have more)
2025-03-09 09:09:17,691 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0005 secs
2025-03-09 09:09:17,691 [INFO]: 	Selecting most promising index types given data characteristics 03/09/2025, 09:09:17
2025-03-09 09:09:17,691 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-09 09:09:17,691 [INFO]: 	Creating the index 03/09/2025, 09:09:17
2025-03-09 09:09:17,691 [INFO]: 		-> Instanciate the index HNSW15 03/09/2025, 09:09:17
2025-03-09 09:09:17,694 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0027 secs
2025-03-09 09:09:17,694 [INFO]: 		-> Adding the vectors to the index 03/09/2025, 09:09:17
2025-03-09 09:09:17,694 [INFO]: The memory available for adding the vectors is 49.5GB(total available - used by the index)
2025-03-09 09:09:17,695 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/12 [00:00<?, ?it/s] 25%|██▌       | 3/12 [00:00<00:00, 27.13it/s] 75%|███████▌  | 9/12 [00:00<00:00, 42.17it/s]100%|██████████| 12/12 [00:02<00:00,  5.14it/s]
2025-03-09 09:09:20,033 [INFO]: 	Computing best hyperparameters for index knn.index 03/09/2025, 09:09:20
2025-03-09 09:09:56,659 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 36.6258 secs
2025-03-09 09:09:56,659 [INFO]: The best hyperparameters are: efSearch=245
2025-03-09 09:09:56,659 [INFO]: 	Compute fast metrics 03/09/2025, 09:09:56
  0%|          | 0/4 [00:00<?, ?it/s] 75%|███████▌  | 3/4 [00:00<00:00, 27.61it/s] 75%|███████▌  | 3/4 [00:00<00:00, 23.51it/s]
2025-03-09 09:10:12,719 [INFO]: 	>>> Finished "Compute fast metrics" in 16.0597 secs
2025-03-09 09:10:12,722 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 55.0278 secs
2025-03-09 09:10:12,722 [INFO]: {
2025-03-09 09:10:12,722 [INFO]: 	index_key: HNSW15
2025-03-09 09:10:12,722 [INFO]: 	index_param: efSearch=245
2025-03-09 09:10:12,722 [INFO]: 	index_path: knn.index
2025-03-09 09:10:12,722 [INFO]: 	size in bytes: 574491850
2025-03-09 09:10:12,722 [INFO]: 	avg_search_speed_ms: 9.723148017486356
2025-03-09 09:10:12,723 [INFO]: 	99p_search_speed_ms: 20.647748075425646
2025-03-09 09:10:12,723 [INFO]: 	reconstruction error %: 0.0
2025-03-09 09:10:12,723 [INFO]: 	nb vectors: 2920
2025-03-09 09:10:12,723 [INFO]: 	vectors dimension: 49152
2025-03-09 09:10:12,723 [INFO]: 	compression ratio: 0.9993098422545071
2025-03-09 09:10:12,723 [INFO]: }
2025-03-09 09:10:12,723 [INFO]: 	>>> Finished "Creating the index" in 55.0315 secs
2025-03-09 09:10:12,723 [INFO]: >>> Finished "Launching the whole pipeline" in 55.0691 secs
2025-03-09 09:10:13: [retrieval_preprocessing] calculating distances ...
2025-03-09 09:10:14: [retrieval_preprocessing] finished and saved retrieval indices for episode 53280 [episode count 6/20]
[retrieval_preprocessing] for episode 15915 [episode count 7/20], we have num_retrieval=np.int64(2923) num_query=np.int64(132)
2025-03-09 09:10:15,750 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-09 09:10:16,358 [INFO]: Launching the whole pipeline 03/09/2025, 09:10:16
2025-03-09 09:10:16,358 [INFO]: Reading total number of vectors and dimension 03/09/2025, 09:10:16
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1314.01it/s]
2025-03-09 09:10:16,409 [INFO]: There are 2923 embeddings of dim 49152
2025-03-09 09:10:16,409 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0508 secs
2025-03-09 09:10:16,409 [INFO]: 	Compute estimated construction time of the index 03/09/2025, 09:10:16
2025-03-09 09:10:16,409 [INFO]: 		-> Train: 16.7 minutes
2025-03-09 09:10:16,409 [INFO]: 		-> Add: 1.6 seconds
2025-03-09 09:10:16,409 [INFO]: 		Total: 16.7 minutes
2025-03-09 09:10:16,409 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0002 secs
2025-03-09 09:10:16,409 [INFO]: 	Checking that your have enough memory available to create the index 03/09/2025, 09:10:16
2025-03-09 09:10:16,410 [INFO]: 603.2MB of memory will be needed to build the index (more might be used if you have more)
2025-03-09 09:10:16,410 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0003 secs
2025-03-09 09:10:16,410 [INFO]: 	Selecting most promising index types given data characteristics 03/09/2025, 09:10:16
2025-03-09 09:10:16,410 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-09 09:10:16,410 [INFO]: 	Creating the index 03/09/2025, 09:10:16
2025-03-09 09:10:16,410 [INFO]: 		-> Instanciate the index HNSW15 03/09/2025, 09:10:16
2025-03-09 09:10:16,412 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0019 secs
2025-03-09 09:10:16,412 [INFO]: 		-> Adding the vectors to the index 03/09/2025, 09:10:16
2025-03-09 09:10:16,412 [INFO]: The memory available for adding the vectors is 49.5GB(total available - used by the index)
2025-03-09 09:10:16,412 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/12 [00:00<?, ?it/s]  8%|▊         | 1/12 [00:00<00:01,  5.75it/s] 25%|██▌       | 3/12 [00:00<00:00, 10.77it/s] 58%|█████▊    | 7/12 [00:00<00:00, 21.33it/s] 92%|█████████▏| 11/12 [00:00<00:00, 27.25it/s]100%|██████████| 12/12 [00:02<00:00,  4.36it/s]
2025-03-09 09:10:19,168 [INFO]: 	Computing best hyperparameters for index knn.index 03/09/2025, 09:10:19
2025-03-09 09:10:53,007 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 33.8385 secs
2025-03-09 09:10:53,007 [INFO]: The best hyperparameters are: efSearch=196
2025-03-09 09:10:53,007 [INFO]: 	Compute fast metrics 03/09/2025, 09:10:53
  0%|          | 0/4 [00:00<?, ?it/s] 25%|██▌       | 1/4 [00:00<00:00,  3.93it/s] 50%|█████     | 2/4 [00:00<00:00,  5.72it/s] 75%|███████▌  | 3/4 [00:00<00:00,  6.84it/s] 75%|███████▌  | 3/4 [00:00<00:00,  5.02it/s]
2025-03-09 09:11:07,863 [INFO]: 	>>> Finished "Compute fast metrics" in 14.8554 secs
2025-03-09 09:11:07,864 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 51.4524 secs
2025-03-09 09:11:07,865 [INFO]: {
2025-03-09 09:11:07,865 [INFO]: 	index_key: HNSW15
2025-03-09 09:11:07,865 [INFO]: 	index_param: efSearch=196
2025-03-09 09:11:07,865 [INFO]: 	index_path: knn.index
2025-03-09 09:11:07,865 [INFO]: 	size in bytes: 575082070
2025-03-09 09:11:07,865 [INFO]: 	avg_search_speed_ms: 7.799276742828478
2025-03-09 09:11:07,865 [INFO]: 	99p_search_speed_ms: 11.675911378115417
2025-03-09 09:11:07,865 [INFO]: 	reconstruction error %: 0.0
2025-03-09 09:11:07,865 [INFO]: 	nb vectors: 2923
2025-03-09 09:11:07,865 [INFO]: 	vectors dimension: 49152
2025-03-09 09:11:07,865 [INFO]: 	compression ratio: 0.9993098619819603
2025-03-09 09:11:07,865 [INFO]: }
2025-03-09 09:11:07,865 [INFO]: 	>>> Finished "Creating the index" in 51.4550 secs
2025-03-09 09:11:07,865 [INFO]: >>> Finished "Launching the whole pipeline" in 51.5069 secs
2025-03-09 09:11:08: [retrieval_preprocessing] calculating distances ...
2025-03-09 09:11:08: [retrieval_preprocessing] finished and saved retrieval indices for episode 15915 [episode count 7/20]
[retrieval_preprocessing] for episode 67120 [episode count 8/20], we have num_retrieval=np.int64(2747) num_query=np.int64(308)
2025-03-09 09:11:08,868 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-09 09:11:09,214 [INFO]: Launching the whole pipeline 03/09/2025, 09:11:09
2025-03-09 09:11:09,214 [INFO]: Reading total number of vectors and dimension 03/09/2025, 09:11:09
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1503.33it/s]
2025-03-09 09:11:09,246 [INFO]: There are 2747 embeddings of dim 49152
2025-03-09 09:11:09,247 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0323 secs
2025-03-09 09:11:09,247 [INFO]: 	Compute estimated construction time of the index 03/09/2025, 09:11:09
2025-03-09 09:11:09,247 [INFO]: 		-> Train: 16.7 minutes
2025-03-09 09:11:09,247 [INFO]: 		-> Add: 1.5 seconds
2025-03-09 09:11:09,247 [INFO]: 		Total: 16.7 minutes
2025-03-09 09:11:09,247 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0001 secs
2025-03-09 09:11:09,247 [INFO]: 	Checking that your have enough memory available to create the index 03/09/2025, 09:11:09
2025-03-09 09:11:09,247 [INFO]: 566.9MB of memory will be needed to build the index (more might be used if you have more)
2025-03-09 09:11:09,247 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0002 secs
2025-03-09 09:11:09,247 [INFO]: 	Selecting most promising index types given data characteristics 03/09/2025, 09:11:09
2025-03-09 09:11:09,247 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-09 09:11:09,247 [INFO]: 	Creating the index 03/09/2025, 09:11:09
2025-03-09 09:11:09,247 [INFO]: 		-> Instanciate the index HNSW15 03/09/2025, 09:11:09
2025-03-09 09:11:09,248 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0010 secs
2025-03-09 09:11:09,248 [INFO]: 		-> Adding the vectors to the index 03/09/2025, 09:11:09
2025-03-09 09:11:09,248 [INFO]: The memory available for adding the vectors is 49.5GB(total available - used by the index)
2025-03-09 09:11:09,248 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/11 [00:00<?, ?it/s] 18%|█▊        | 2/11 [00:00<00:00, 18.20it/s] 73%|███████▎  | 8/11 [00:00<00:00, 41.67it/s]100%|██████████| 11/11 [00:01<00:00,  5.61it/s]
2025-03-09 09:11:11,213 [INFO]: 	Computing best hyperparameters for index knn.index 03/09/2025, 09:11:11
2025-03-09 09:11:46,080 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 34.8663 secs
2025-03-09 09:11:46,080 [INFO]: The best hyperparameters are: efSearch=278
2025-03-09 09:11:46,080 [INFO]: 	Compute fast metrics 03/09/2025, 09:11:46
  0%|          | 0/4 [00:00<?, ?it/s] 50%|█████     | 2/4 [00:00<00:00, 19.20it/s] 75%|███████▌  | 3/4 [00:00<00:00, 20.82it/s]
2025-03-09 09:12:04,849 [INFO]: 	>>> Finished "Compute fast metrics" in 18.7692 secs
2025-03-09 09:12:05,012 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 55.7634 secs
2025-03-09 09:12:05,012 [INFO]: {
2025-03-09 09:12:05,012 [INFO]: 	index_key: HNSW15
2025-03-09 09:12:05,012 [INFO]: 	index_param: efSearch=278
2025-03-09 09:12:05,012 [INFO]: 	index_path: knn.index
2025-03-09 09:12:05,012 [INFO]: 	size in bytes: 540455110
2025-03-09 09:12:05,013 [INFO]: 	avg_search_speed_ms: 10.053319136738478
2025-03-09 09:12:05,013 [INFO]: 	99p_search_speed_ms: 15.558610628359014
2025-03-09 09:12:05,013 [INFO]: 	reconstruction error %: 0.0
2025-03-09 09:12:05,013 [INFO]: 	nb vectors: 2747
2025-03-09 09:12:05,013 [INFO]: 	vectors dimension: 49152
2025-03-09 09:12:05,013 [INFO]: 	compression ratio: 0.999309963042074
2025-03-09 09:12:05,013 [INFO]: }
2025-03-09 09:12:05,013 [INFO]: 	>>> Finished "Creating the index" in 55.7657 secs
2025-03-09 09:12:05,013 [INFO]: >>> Finished "Launching the whole pipeline" in 55.7988 secs
2025-03-09 09:12:06: [retrieval_preprocessing] calculating distances ...
2025-03-09 09:12:07: [retrieval_preprocessing] finished and saved retrieval indices for episode 67120 [episode count 8/20]
[retrieval_preprocessing] for episode 11827 [episode count 9/20], we have num_retrieval=np.int64(2901) num_query=np.int64(154)
2025-03-09 09:12:07,854 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-09 09:12:08,183 [INFO]: Launching the whole pipeline 03/09/2025, 09:12:08
2025-03-09 09:12:08,183 [INFO]: Reading total number of vectors and dimension 03/09/2025, 09:12:08
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1225.33it/s]
2025-03-09 09:12:08,214 [INFO]: There are 2901 embeddings of dim 49152
2025-03-09 09:12:08,214 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0306 secs
2025-03-09 09:12:08,214 [INFO]: 	Compute estimated construction time of the index 03/09/2025, 09:12:08
2025-03-09 09:12:08,214 [INFO]: 		-> Train: 16.7 minutes
2025-03-09 09:12:08,214 [INFO]: 		-> Add: 1.6 seconds
2025-03-09 09:12:08,214 [INFO]: 		Total: 16.7 minutes
2025-03-09 09:12:08,214 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0001 secs
2025-03-09 09:12:08,214 [INFO]: 	Checking that your have enough memory available to create the index 03/09/2025, 09:12:08
2025-03-09 09:12:08,214 [INFO]: 598.7MB of memory will be needed to build the index (more might be used if you have more)
2025-03-09 09:12:08,214 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0002 secs
2025-03-09 09:12:08,214 [INFO]: 	Selecting most promising index types given data characteristics 03/09/2025, 09:12:08
2025-03-09 09:12:08,214 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-09 09:12:08,214 [INFO]: 	Creating the index 03/09/2025, 09:12:08
2025-03-09 09:12:08,214 [INFO]: 		-> Instanciate the index HNSW15 03/09/2025, 09:12:08
2025-03-09 09:12:08,216 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0014 secs
2025-03-09 09:12:08,216 [INFO]: 		-> Adding the vectors to the index 03/09/2025, 09:12:08
2025-03-09 09:12:08,216 [INFO]: The memory available for adding the vectors is 49.5GB(total available - used by the index)
2025-03-09 09:12:08,216 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/12 [00:00<?, ?it/s] 25%|██▌       | 3/12 [00:00<00:00, 25.86it/s] 75%|███████▌  | 9/12 [00:00<00:00, 43.39it/s]100%|██████████| 12/12 [00:02<00:00,  5.84it/s]
2025-03-09 09:12:10,273 [INFO]: 	Computing best hyperparameters for index knn.index 03/09/2025, 09:12:10
2025-03-09 09:12:38,198 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 27.9248 secs
2025-03-09 09:12:38,198 [INFO]: The best hyperparameters are: efSearch=285
2025-03-09 09:12:38,199 [INFO]: 	Compute fast metrics 03/09/2025, 09:12:38
  0%|          | 0/4 [00:00<?, ?it/s] 75%|███████▌  | 3/4 [00:00<00:00, 26.94it/s] 75%|███████▌  | 3/4 [00:00<00:00, 23.51it/s]
2025-03-09 09:12:52,145 [INFO]: 	>>> Finished "Compute fast metrics" in 13.9468 secs
2025-03-09 09:12:52,662 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 44.4454 secs
2025-03-09 09:12:52,662 [INFO]: {
2025-03-09 09:12:52,662 [INFO]: 	index_key: HNSW15
2025-03-09 09:12:52,662 [INFO]: 	index_param: efSearch=285
2025-03-09 09:12:52,662 [INFO]: 	index_path: knn.index
2025-03-09 09:12:52,663 [INFO]: 	size in bytes: 570753730
2025-03-09 09:12:52,663 [INFO]: 	avg_search_speed_ms: 10.374986313242868
2025-03-09 09:12:52,663 [INFO]: 	99p_search_speed_ms: 21.311641233041883
2025-03-09 09:12:52,663 [INFO]: 	reconstruction error %: 0.0
2025-03-09 09:12:52,663 [INFO]: 	nb vectors: 2901
2025-03-09 09:12:52,663 [INFO]: 	vectors dimension: 49152
2025-03-09 09:12:52,663 [INFO]: 	compression ratio: 0.9993098214180747
2025-03-09 09:12:52,663 [INFO]: }
2025-03-09 09:12:52,663 [INFO]: 	>>> Finished "Creating the index" in 44.4486 secs
2025-03-09 09:12:52,663 [INFO]: >>> Finished "Launching the whole pipeline" in 44.4800 secs
2025-03-09 09:12:53: [retrieval_preprocessing] calculating distances ...
2025-03-09 09:12:54: [retrieval_preprocessing] finished and saved retrieval indices for episode 11827 [episode count 9/20]
[retrieval_preprocessing] for episode 63541 [episode count 10/20], we have num_retrieval=np.int64(2885) num_query=np.int64(170)
2025-03-09 09:12:54,572 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-09 09:12:55,000 [INFO]: Launching the whole pipeline 03/09/2025, 09:12:55
2025-03-09 09:12:55,000 [INFO]: Reading total number of vectors and dimension 03/09/2025, 09:12:55
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 2209.85it/s]
2025-03-09 09:12:55,027 [INFO]: There are 2885 embeddings of dim 49152
2025-03-09 09:12:55,027 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0272 secs
2025-03-09 09:12:55,027 [INFO]: 	Compute estimated construction time of the index 03/09/2025, 09:12:55
2025-03-09 09:12:55,027 [INFO]: 		-> Train: 16.7 minutes
2025-03-09 09:12:55,027 [INFO]: 		-> Add: 1.6 seconds
2025-03-09 09:12:55,027 [INFO]: 		Total: 16.7 minutes
2025-03-09 09:12:55,027 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0001 secs
2025-03-09 09:12:55,027 [INFO]: 	Checking that your have enough memory available to create the index 03/09/2025, 09:12:55
2025-03-09 09:12:55,027 [INFO]: 595.4MB of memory will be needed to build the index (more might be used if you have more)
2025-03-09 09:12:55,027 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0001 secs
2025-03-09 09:12:55,028 [INFO]: 	Selecting most promising index types given data characteristics 03/09/2025, 09:12:55
2025-03-09 09:12:55,028 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-09 09:12:55,028 [INFO]: 	Creating the index 03/09/2025, 09:12:55
2025-03-09 09:12:55,028 [INFO]: 		-> Instanciate the index HNSW15 03/09/2025, 09:12:55
2025-03-09 09:12:55,029 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0010 secs
2025-03-09 09:12:55,029 [INFO]: 		-> Adding the vectors to the index 03/09/2025, 09:12:55
2025-03-09 09:12:55,029 [INFO]: The memory available for adding the vectors is 49.5GB(total available - used by the index)
2025-03-09 09:12:55,029 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/12 [00:00<?, ?it/s] 17%|█▋        | 2/12 [00:00<00:00, 18.82it/s] 67%|██████▋   | 8/12 [00:00<00:00, 41.58it/s]100%|██████████| 12/12 [00:02<00:00,  5.41it/s]
2025-03-09 09:12:57,249 [INFO]: 	Computing best hyperparameters for index knn.index 03/09/2025, 09:12:57
2025-03-09 09:13:32,799 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 35.5496 secs
2025-03-09 09:13:32,799 [INFO]: The best hyperparameters are: efSearch=280
2025-03-09 09:13:32,800 [INFO]: 	Compute fast metrics 03/09/2025, 09:13:32
  0%|          | 0/4 [00:00<?, ?it/s] 25%|██▌       | 1/4 [00:00<00:00,  3.10it/s] 75%|███████▌  | 3/4 [00:00<00:00,  7.89it/s]
2025-03-09 09:13:50,749 [INFO]: 	>>> Finished "Compute fast metrics" in 17.9499 secs
2025-03-09 09:13:50,751 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 55.7224 secs
2025-03-09 09:13:50,751 [INFO]: {
2025-03-09 09:13:50,751 [INFO]: 	index_key: HNSW15
2025-03-09 09:13:50,751 [INFO]: 	index_param: efSearch=280
2025-03-09 09:13:50,751 [INFO]: 	index_path: knn.index
2025-03-09 09:13:50,751 [INFO]: 	size in bytes: 567605890
2025-03-09 09:13:50,751 [INFO]: 	avg_search_speed_ms: 11.787054450081133
2025-03-09 09:13:50,751 [INFO]: 	99p_search_speed_ms: 26.692957319319245
2025-03-09 09:13:50,751 [INFO]: 	reconstruction error %: 0.0
2025-03-09 09:13:50,751 [INFO]: 	nb vectors: 2885
2025-03-09 09:13:50,752 [INFO]: 	vectors dimension: 49152
2025-03-09 09:13:50,752 [INFO]: 	compression ratio: 0.9993097147036301
2025-03-09 09:13:50,752 [INFO]: }
2025-03-09 09:13:50,752 [INFO]: 	>>> Finished "Creating the index" in 55.7239 secs
2025-03-09 09:13:50,752 [INFO]: >>> Finished "Launching the whole pipeline" in 55.7517 secs
2025-03-09 09:13:51: [retrieval_preprocessing] calculating distances ...
2025-03-09 09:13:52: [retrieval_preprocessing] finished and saved retrieval indices for episode 63541 [episode count 10/20]
[retrieval_preprocessing] for episode 47671 [episode count 11/20], we have num_retrieval=np.int64(2912) num_query=np.int64(143)
2025-03-09 09:13:52,416 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-09 09:13:52,845 [INFO]: Launching the whole pipeline 03/09/2025, 09:13:52
2025-03-09 09:13:52,845 [INFO]: Reading total number of vectors and dimension 03/09/2025, 09:13:52
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1855.89it/s]
2025-03-09 09:13:52,871 [INFO]: There are 2912 embeddings of dim 49152
2025-03-09 09:13:52,871 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0265 secs
2025-03-09 09:13:52,871 [INFO]: 	Compute estimated construction time of the index 03/09/2025, 09:13:52
2025-03-09 09:13:52,872 [INFO]: 		-> Train: 16.7 minutes
2025-03-09 09:13:52,872 [INFO]: 		-> Add: 1.6 seconds
2025-03-09 09:13:52,872 [INFO]: 		Total: 16.7 minutes
2025-03-09 09:13:52,872 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0001 secs
2025-03-09 09:13:52,872 [INFO]: 	Checking that your have enough memory available to create the index 03/09/2025, 09:13:52
2025-03-09 09:13:52,872 [INFO]: 601.0MB of memory will be needed to build the index (more might be used if you have more)
2025-03-09 09:13:52,872 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0001 secs
2025-03-09 09:13:52,872 [INFO]: 	Selecting most promising index types given data characteristics 03/09/2025, 09:13:52
2025-03-09 09:13:52,872 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-09 09:13:52,872 [INFO]: 	Creating the index 03/09/2025, 09:13:52
2025-03-09 09:13:52,872 [INFO]: 		-> Instanciate the index HNSW15 03/09/2025, 09:13:52
2025-03-09 09:13:52,873 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0009 secs
2025-03-09 09:13:52,873 [INFO]: 		-> Adding the vectors to the index 03/09/2025, 09:13:52
2025-03-09 09:13:52,873 [INFO]: The memory available for adding the vectors is 49.5GB(total available - used by the index)
2025-03-09 09:13:52,873 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/12 [00:00<?, ?it/s] 17%|█▋        | 2/12 [00:00<00:00, 18.20it/s] 67%|██████▋   | 8/12 [00:00<00:00, 39.09it/s]100%|██████████| 12/12 [00:02<00:00,  3.86it/s]100%|██████████| 12/12 [00:02<00:00,  4.86it/s]
2025-03-09 09:13:55,342 [INFO]: 	Computing best hyperparameters for index knn.index 03/09/2025, 09:13:55
2025-03-09 09:14:29,199 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 33.8561 secs
2025-03-09 09:14:29,199 [INFO]: The best hyperparameters are: efSearch=260
2025-03-09 09:14:29,199 [INFO]: 	Compute fast metrics 03/09/2025, 09:14:29
  0%|          | 0/4 [00:00<?, ?it/s] 50%|█████     | 2/4 [00:00<00:00, 18.76it/s] 75%|███████▌  | 3/4 [00:00<00:00, 18.57it/s]
2025-03-09 09:14:46,979 [INFO]: 	>>> Finished "Compute fast metrics" in 17.7793 secs
2025-03-09 09:14:46,981 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 54.1075 secs
2025-03-09 09:14:46,981 [INFO]: {
2025-03-09 09:14:46,981 [INFO]: 	index_key: HNSW15
2025-03-09 09:14:46,981 [INFO]: 	index_param: efSearch=260
2025-03-09 09:14:46,981 [INFO]: 	index_path: knn.index
2025-03-09 09:14:46,981 [INFO]: 	size in bytes: 572917870
2025-03-09 09:14:46,981 [INFO]: 	avg_search_speed_ms: 9.860737750506951
2025-03-09 09:14:46,981 [INFO]: 	99p_search_speed_ms: 21.774005063343793
2025-03-09 09:14:46,981 [INFO]: 	reconstruction error %: 0.0
2025-03-09 09:14:46,981 [INFO]: 	nb vectors: 2912
2025-03-09 09:14:46,981 [INFO]: 	vectors dimension: 49152
2025-03-09 09:14:46,981 [INFO]: 	compression ratio: 0.9993098941040188
2025-03-09 09:14:46,981 [INFO]: }
2025-03-09 09:14:46,981 [INFO]: 	>>> Finished "Creating the index" in 54.1089 secs
2025-03-09 09:14:46,981 [INFO]: >>> Finished "Launching the whole pipeline" in 54.1360 secs
2025-03-09 09:14:48: [retrieval_preprocessing] calculating distances ...
2025-03-09 09:14:49: [retrieval_preprocessing] finished and saved retrieval indices for episode 47671 [episode count 11/20]
[retrieval_preprocessing] for episode 84025 [episode count 12/20], we have num_retrieval=np.int64(2900) num_query=np.int64(155)
2025-03-09 09:14:49,341 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-09 09:14:49,862 [INFO]: Launching the whole pipeline 03/09/2025, 09:14:49
2025-03-09 09:14:49,863 [INFO]: Reading total number of vectors and dimension 03/09/2025, 09:14:49
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 2021.35it/s]
2025-03-09 09:14:49,896 [INFO]: There are 2900 embeddings of dim 49152
2025-03-09 09:14:49,897 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0342 secs
2025-03-09 09:14:49,897 [INFO]: 	Compute estimated construction time of the index 03/09/2025, 09:14:49
2025-03-09 09:14:49,897 [INFO]: 		-> Train: 16.7 minutes
2025-03-09 09:14:49,898 [INFO]: 		-> Add: 1.6 seconds
2025-03-09 09:14:49,898 [INFO]: 		Total: 16.7 minutes
2025-03-09 09:14:49,898 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0005 secs
2025-03-09 09:14:49,898 [INFO]: 	Checking that your have enough memory available to create the index 03/09/2025, 09:14:49
2025-03-09 09:14:49,898 [INFO]: 598.5MB of memory will be needed to build the index (more might be used if you have more)
2025-03-09 09:14:49,898 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0005 secs
2025-03-09 09:14:49,899 [INFO]: 	Selecting most promising index types given data characteristics 03/09/2025, 09:14:49
2025-03-09 09:14:49,899 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-09 09:14:49,899 [INFO]: 	Creating the index 03/09/2025, 09:14:49
2025-03-09 09:14:49,899 [INFO]: 		-> Instanciate the index HNSW15 03/09/2025, 09:14:49
2025-03-09 09:14:49,902 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0028 secs
2025-03-09 09:14:49,902 [INFO]: 		-> Adding the vectors to the index 03/09/2025, 09:14:49
2025-03-09 09:14:49,902 [INFO]: The memory available for adding the vectors is 49.5GB(total available - used by the index)
2025-03-09 09:14:49,902 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/12 [00:00<?, ?it/s] 17%|█▋        | 2/12 [00:00<00:00, 18.78it/s] 58%|█████▊    | 7/12 [00:00<00:00, 33.60it/s] 92%|█████████▏| 11/12 [00:00<00:00, 32.78it/s]100%|██████████| 12/12 [00:02<00:00,  4.74it/s]
2025-03-09 09:14:52,441 [INFO]: 	Computing best hyperparameters for index knn.index 03/09/2025, 09:14:52
2025-03-09 09:15:27,379 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 34.9370 secs
2025-03-09 09:15:27,379 [INFO]: The best hyperparameters are: efSearch=294
2025-03-09 09:15:27,379 [INFO]: 	Compute fast metrics 03/09/2025, 09:15:27
  0%|          | 0/4 [00:00<?, ?it/s] 50%|█████     | 2/4 [00:00<00:00, 17.46it/s] 75%|███████▌  | 3/4 [00:00<00:00, 19.64it/s]
2025-03-09 09:15:44,030 [INFO]: 	>>> Finished "Compute fast metrics" in 16.6501 secs
2025-03-09 09:15:44,032 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 54.1293 secs
2025-03-09 09:15:44,032 [INFO]: {
2025-03-09 09:15:44,032 [INFO]: 	index_key: HNSW15
2025-03-09 09:15:44,032 [INFO]: 	index_param: efSearch=294
2025-03-09 09:15:44,032 [INFO]: 	index_path: knn.index
2025-03-09 09:15:44,032 [INFO]: 	size in bytes: 570556990
2025-03-09 09:15:44,032 [INFO]: 	avg_search_speed_ms: 11.456313227246785
2025-03-09 09:15:44,032 [INFO]: 	99p_search_speed_ms: 22.27726000361142
2025-03-09 09:15:44,032 [INFO]: 	reconstruction error %: 0.0
2025-03-09 09:15:44,032 [INFO]: 	nb vectors: 2900
2025-03-09 09:15:44,032 [INFO]: 	vectors dimension: 49152
2025-03-09 09:15:44,032 [INFO]: 	compression ratio: 0.9993098147829194
2025-03-09 09:15:44,032 [INFO]: }
2025-03-09 09:15:44,032 [INFO]: 	>>> Finished "Creating the index" in 54.1330 secs
2025-03-09 09:15:44,032 [INFO]: >>> Finished "Launching the whole pipeline" in 54.1693 secs
2025-03-09 09:15:45: [retrieval_preprocessing] calculating distances ...
2025-03-09 09:15:45: [retrieval_preprocessing] finished and saved retrieval indices for episode 84025 [episode count 12/20]
[retrieval_preprocessing] for episode 2111 [episode count 13/20], we have num_retrieval=np.int64(2935) num_query=np.int64(120)
2025-03-09 09:15:45,775 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-09 09:15:46,234 [INFO]: Launching the whole pipeline 03/09/2025, 09:15:46
2025-03-09 09:15:46,234 [INFO]: Reading total number of vectors and dimension 03/09/2025, 09:15:46
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1556.91it/s]
2025-03-09 09:15:46,263 [INFO]: There are 2935 embeddings of dim 49152
2025-03-09 09:15:46,263 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0296 secs
2025-03-09 09:15:46,263 [INFO]: 	Compute estimated construction time of the index 03/09/2025, 09:15:46
2025-03-09 09:15:46,263 [INFO]: 		-> Train: 16.7 minutes
2025-03-09 09:15:46,263 [INFO]: 		-> Add: 1.6 seconds
2025-03-09 09:15:46,264 [INFO]: 		Total: 16.7 minutes
2025-03-09 09:15:46,264 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0001 secs
2025-03-09 09:15:46,264 [INFO]: 	Checking that your have enough memory available to create the index 03/09/2025, 09:15:46
2025-03-09 09:15:46,264 [INFO]: 605.7MB of memory will be needed to build the index (more might be used if you have more)
2025-03-09 09:15:46,264 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0002 secs
2025-03-09 09:15:46,264 [INFO]: 	Selecting most promising index types given data characteristics 03/09/2025, 09:15:46
2025-03-09 09:15:46,264 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-09 09:15:46,264 [INFO]: 	Creating the index 03/09/2025, 09:15:46
2025-03-09 09:15:46,264 [INFO]: 		-> Instanciate the index HNSW15 03/09/2025, 09:15:46
2025-03-09 09:15:46,265 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0011 secs
2025-03-09 09:15:46,265 [INFO]: 		-> Adding the vectors to the index 03/09/2025, 09:15:46
2025-03-09 09:15:46,265 [INFO]: The memory available for adding the vectors is 49.5GB(total available - used by the index)
2025-03-09 09:15:46,265 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/12 [00:00<?, ?it/s]  8%|▊         | 1/12 [00:00<00:01,  8.61it/s] 58%|█████▊    | 7/12 [00:00<00:00, 35.21it/s]100%|██████████| 12/12 [00:02<00:00,  4.11it/s]100%|██████████| 12/12 [00:02<00:00,  4.90it/s]
2025-03-09 09:15:48,720 [INFO]: 	Computing best hyperparameters for index knn.index 03/09/2025, 09:15:48
2025-03-09 09:16:19,053 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 30.3332 secs
2025-03-09 09:16:19,053 [INFO]: The best hyperparameters are: efSearch=272
2025-03-09 09:16:19,053 [INFO]: 	Compute fast metrics 03/09/2025, 09:16:19
  0%|          | 0/4 [00:00<?, ?it/s] 50%|█████     | 2/4 [00:00<00:00, 17.59it/s] 75%|███████▌  | 3/4 [00:00<00:00, 18.67it/s]
2025-03-09 09:16:35,360 [INFO]: 	>>> Finished "Compute fast metrics" in 16.3070 secs
2025-03-09 09:16:35,362 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 49.0970 secs
2025-03-09 09:16:35,362 [INFO]: {
2025-03-09 09:16:35,362 [INFO]: 	index_key: HNSW15
2025-03-09 09:16:35,362 [INFO]: 	index_param: efSearch=272
2025-03-09 09:16:35,362 [INFO]: 	index_path: knn.index
2025-03-09 09:16:35,362 [INFO]: 	size in bytes: 577443070
2025-03-09 09:16:35,362 [INFO]: 	avg_search_speed_ms: 10.829496473825872
2025-03-09 09:16:35,362 [INFO]: 	99p_search_speed_ms: 21.711850042920553
2025-03-09 09:16:35,362 [INFO]: 	reconstruction error %: 0.0
2025-03-09 09:16:35,363 [INFO]: 	nb vectors: 2935
2025-03-09 09:16:35,363 [INFO]: 	vectors dimension: 49152
2025-03-09 09:16:35,363 [INFO]: 	compression ratio: 0.9993097328192024
2025-03-09 09:16:35,363 [INFO]: }
2025-03-09 09:16:35,363 [INFO]: 	>>> Finished "Creating the index" in 49.0987 secs
2025-03-09 09:16:35,363 [INFO]: >>> Finished "Launching the whole pipeline" in 49.1289 secs
2025-03-09 09:16:36: [retrieval_preprocessing] calculating distances ...
2025-03-09 09:16:36: [retrieval_preprocessing] finished and saved retrieval indices for episode 2111 [episode count 13/20]
[retrieval_preprocessing] for episode 8260 [episode count 14/20], we have num_retrieval=np.int64(2926) num_query=np.int64(129)
2025-03-09 09:16:36,836 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-09 09:16:37,220 [INFO]: Launching the whole pipeline 03/09/2025, 09:16:37
2025-03-09 09:16:37,220 [INFO]: Reading total number of vectors and dimension 03/09/2025, 09:16:37
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1080.45it/s]
2025-03-09 09:16:37,249 [INFO]: There are 2926 embeddings of dim 49152
2025-03-09 09:16:37,249 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0288 secs
2025-03-09 09:16:37,249 [INFO]: 	Compute estimated construction time of the index 03/09/2025, 09:16:37
2025-03-09 09:16:37,249 [INFO]: 		-> Train: 16.7 minutes
2025-03-09 09:16:37,249 [INFO]: 		-> Add: 1.6 seconds
2025-03-09 09:16:37,249 [INFO]: 		Total: 16.7 minutes
2025-03-09 09:16:37,249 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0001 secs
2025-03-09 09:16:37,249 [INFO]: 	Checking that your have enough memory available to create the index 03/09/2025, 09:16:37
2025-03-09 09:16:37,249 [INFO]: 603.9MB of memory will be needed to build the index (more might be used if you have more)
2025-03-09 09:16:37,250 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0001 secs
2025-03-09 09:16:37,250 [INFO]: 	Selecting most promising index types given data characteristics 03/09/2025, 09:16:37
2025-03-09 09:16:37,250 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-09 09:16:37,250 [INFO]: 	Creating the index 03/09/2025, 09:16:37
2025-03-09 09:16:37,250 [INFO]: 		-> Instanciate the index HNSW15 03/09/2025, 09:16:37
2025-03-09 09:16:37,251 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0009 secs
2025-03-09 09:16:37,251 [INFO]: 		-> Adding the vectors to the index 03/09/2025, 09:16:37
2025-03-09 09:16:37,251 [INFO]: The memory available for adding the vectors is 49.5GB(total available - used by the index)
2025-03-09 09:16:37,251 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/12 [00:00<?, ?it/s]  8%|▊         | 1/12 [00:00<00:01,  9.14it/s] 50%|█████     | 6/12 [00:00<00:00, 29.56it/s]100%|██████████| 12/12 [00:02<00:00,  4.89it/s]100%|██████████| 12/12 [00:02<00:00,  5.62it/s]
2025-03-09 09:16:39,390 [INFO]: 	Computing best hyperparameters for index knn.index 03/09/2025, 09:16:39
2025-03-09 09:17:11,710 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 32.3192 secs
2025-03-09 09:17:11,710 [INFO]: The best hyperparameters are: efSearch=319
2025-03-09 09:17:11,710 [INFO]: 	Compute fast metrics 03/09/2025, 09:17:11
  0%|          | 0/4 [00:00<?, ?it/s] 50%|█████     | 2/4 [00:00<00:00, 17.62it/s] 75%|███████▌  | 3/4 [00:00<00:00, 20.08it/s]
2025-03-09 09:17:30,081 [INFO]: 	>>> Finished "Compute fast metrics" in 18.3710 secs
2025-03-09 09:17:30,083 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 52.8322 secs
2025-03-09 09:17:30,083 [INFO]: {
2025-03-09 09:17:30,083 [INFO]: 	index_key: HNSW15
2025-03-09 09:17:30,083 [INFO]: 	index_param: efSearch=319
2025-03-09 09:17:30,083 [INFO]: 	index_path: knn.index
2025-03-09 09:17:30,083 [INFO]: 	size in bytes: 575672290
2025-03-09 09:17:30,083 [INFO]: 	avg_search_speed_ms: 13.072520713291429
2025-03-09 09:17:30,083 [INFO]: 	99p_search_speed_ms: 21.136084785684947
2025-03-09 09:17:30,083 [INFO]: 	reconstruction error %: 0.0
2025-03-09 09:17:30,083 [INFO]: 	nb vectors: 2926
2025-03-09 09:17:30,083 [INFO]: 	vectors dimension: 49152
2025-03-09 09:17:30,083 [INFO]: 	compression ratio: 0.9993098816689614
2025-03-09 09:17:30,083 [INFO]: }
2025-03-09 09:17:30,083 [INFO]: 	>>> Finished "Creating the index" in 52.8335 secs
2025-03-09 09:17:30,083 [INFO]: >>> Finished "Launching the whole pipeline" in 52.8629 secs
2025-03-09 09:17:30: [retrieval_preprocessing] calculating distances ...
2025-03-09 09:17:31: [retrieval_preprocessing] finished and saved retrieval indices for episode 8260 [episode count 14/20]
[retrieval_preprocessing] for episode 12365 [episode count 15/20], we have num_retrieval=np.int64(2929) num_query=np.int64(126)
2025-03-09 09:17:31,566 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-09 09:17:31,968 [INFO]: Launching the whole pipeline 03/09/2025, 09:17:31
2025-03-09 09:17:31,969 [INFO]: Reading total number of vectors and dimension 03/09/2025, 09:17:31
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 2174.34it/s]
2025-03-09 09:17:32,002 [INFO]: There are 2929 embeddings of dim 49152
2025-03-09 09:17:32,002 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0336 secs
2025-03-09 09:17:32,002 [INFO]: 	Compute estimated construction time of the index 03/09/2025, 09:17:32
2025-03-09 09:17:32,002 [INFO]: 		-> Train: 16.7 minutes
2025-03-09 09:17:32,002 [INFO]: 		-> Add: 1.6 seconds
2025-03-09 09:17:32,002 [INFO]: 		Total: 16.7 minutes
2025-03-09 09:17:32,002 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0001 secs
2025-03-09 09:17:32,002 [INFO]: 	Checking that your have enough memory available to create the index 03/09/2025, 09:17:32
2025-03-09 09:17:32,002 [INFO]: 604.5MB of memory will be needed to build the index (more might be used if you have more)
2025-03-09 09:17:32,003 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0001 secs
2025-03-09 09:17:32,003 [INFO]: 	Selecting most promising index types given data characteristics 03/09/2025, 09:17:32
2025-03-09 09:17:32,003 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-09 09:17:32,003 [INFO]: 	Creating the index 03/09/2025, 09:17:32
2025-03-09 09:17:32,003 [INFO]: 		-> Instanciate the index HNSW15 03/09/2025, 09:17:32
2025-03-09 09:17:32,003 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0008 secs
2025-03-09 09:17:32,004 [INFO]: 		-> Adding the vectors to the index 03/09/2025, 09:17:32
2025-03-09 09:17:32,004 [INFO]: The memory available for adding the vectors is 49.5GB(total available - used by the index)
2025-03-09 09:17:32,004 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/12 [00:00<?, ?it/s]  8%|▊         | 1/12 [00:00<00:01,  9.17it/s] 50%|█████     | 6/12 [00:00<00:00, 31.47it/s] 83%|████████▎ | 10/12 [00:00<00:00, 33.42it/s]100%|██████████| 12/12 [00:02<00:00,  4.99it/s]
2025-03-09 09:17:34,412 [INFO]: 	Computing best hyperparameters for index knn.index 03/09/2025, 09:17:34
2025-03-09 09:18:03,926 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 29.5133 secs
2025-03-09 09:18:03,926 [INFO]: The best hyperparameters are: efSearch=272
2025-03-09 09:18:03,926 [INFO]: 	Compute fast metrics 03/09/2025, 09:18:03
  0%|          | 0/4 [00:00<?, ?it/s] 50%|█████     | 2/4 [00:00<00:00, 18.54it/s] 75%|███████▌  | 3/4 [00:00<00:00, 19.66it/s]
2025-03-09 09:18:22,140 [INFO]: 	>>> Finished "Compute fast metrics" in 18.2141 secs
2025-03-09 09:18:22,142 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 50.1381 secs
2025-03-09 09:18:22,142 [INFO]: {
2025-03-09 09:18:22,142 [INFO]: 	index_key: HNSW15
2025-03-09 09:18:22,142 [INFO]: 	index_param: efSearch=272
2025-03-09 09:18:22,142 [INFO]: 	index_path: knn.index
2025-03-09 09:18:22,142 [INFO]: 	size in bytes: 576262510
2025-03-09 09:18:22,142 [INFO]: 	avg_search_speed_ms: 10.60776129855813
2025-03-09 09:18:22,142 [INFO]: 	99p_search_speed_ms: 23.04061376024039
2025-03-09 09:18:22,142 [INFO]: 	reconstruction error %: 0.0
2025-03-09 09:18:22,142 [INFO]: 	nb vectors: 2929
2025-03-09 09:18:22,142 [INFO]: 	vectors dimension: 49152
2025-03-09 09:18:22,142 [INFO]: 	compression ratio: 0.9993099013156348
2025-03-09 09:18:22,142 [INFO]: }
2025-03-09 09:18:22,142 [INFO]: 	>>> Finished "Creating the index" in 50.1394 secs
2025-03-09 09:18:22,142 [INFO]: >>> Finished "Launching the whole pipeline" in 50.1736 secs
2025-03-09 09:18:22: [retrieval_preprocessing] calculating distances ...
2025-03-09 09:18:23: [retrieval_preprocessing] finished and saved retrieval indices for episode 12365 [episode count 15/20]
[retrieval_preprocessing] for episode 87123 [episode count 16/20], we have num_retrieval=np.int64(2893) num_query=np.int64(162)
2025-03-09 09:18:23,480 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-09 09:18:23,961 [INFO]: Launching the whole pipeline 03/09/2025, 09:18:23
2025-03-09 09:18:23,961 [INFO]: Reading total number of vectors and dimension 03/09/2025, 09:18:23
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1269.46it/s]
2025-03-09 09:18:23,990 [INFO]: There are 2893 embeddings of dim 49152
2025-03-09 09:18:23,990 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0293 secs
2025-03-09 09:18:23,991 [INFO]: 	Compute estimated construction time of the index 03/09/2025, 09:18:23
2025-03-09 09:18:23,991 [INFO]: 		-> Train: 16.7 minutes
2025-03-09 09:18:23,991 [INFO]: 		-> Add: 1.6 seconds
2025-03-09 09:18:23,991 [INFO]: 		Total: 16.7 minutes
2025-03-09 09:18:23,991 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0004 secs
2025-03-09 09:18:23,991 [INFO]: 	Checking that your have enough memory available to create the index 03/09/2025, 09:18:23
2025-03-09 09:18:23,991 [INFO]: 597.0MB of memory will be needed to build the index (more might be used if you have more)
2025-03-09 09:18:23,992 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0004 secs
2025-03-09 09:18:23,992 [INFO]: 	Selecting most promising index types given data characteristics 03/09/2025, 09:18:23
2025-03-09 09:18:23,992 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-09 09:18:23,992 [INFO]: 	Creating the index 03/09/2025, 09:18:23
2025-03-09 09:18:23,992 [INFO]: 		-> Instanciate the index HNSW15 03/09/2025, 09:18:23
2025-03-09 09:18:23,995 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0025 secs
2025-03-09 09:18:23,995 [INFO]: 		-> Adding the vectors to the index 03/09/2025, 09:18:23
2025-03-09 09:18:23,995 [INFO]: The memory available for adding the vectors is 49.5GB(total available - used by the index)
2025-03-09 09:18:23,995 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/12 [00:00<?, ?it/s] 17%|█▋        | 2/12 [00:00<00:00, 17.69it/s] 58%|█████▊    | 7/12 [00:00<00:00, 34.48it/s]100%|██████████| 12/12 [00:02<00:00,  3.73it/s]100%|██████████| 12/12 [00:02<00:00,  4.56it/s]
2025-03-09 09:18:26,862 [INFO]: 	Computing best hyperparameters for index knn.index 03/09/2025, 09:18:26
2025-03-09 09:19:02,863 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 35.9997 secs
2025-03-09 09:19:02,863 [INFO]: The best hyperparameters are: efSearch=239
2025-03-09 09:19:02,863 [INFO]: 	Compute fast metrics 03/09/2025, 09:19:02
  0%|          | 0/4 [00:00<?, ?it/s] 75%|███████▌  | 3/4 [00:00<00:00, 25.96it/s] 75%|███████▌  | 3/4 [00:00<00:00, 22.03it/s]
2025-03-09 09:19:19,257 [INFO]: 	>>> Finished "Compute fast metrics" in 16.3937 secs
2025-03-09 09:19:19,259 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 55.2636 secs
2025-03-09 09:19:19,259 [INFO]: {
2025-03-09 09:19:19,259 [INFO]: 	index_key: HNSW15
2025-03-09 09:19:19,259 [INFO]: 	index_param: efSearch=239
2025-03-09 09:19:19,259 [INFO]: 	index_path: knn.index
2025-03-09 09:19:19,259 [INFO]: 	size in bytes: 569179810
2025-03-09 09:19:19,259 [INFO]: 	avg_search_speed_ms: 9.860733187577413
2025-03-09 09:19:19,259 [INFO]: 	99p_search_speed_ms: 20.78634054400027
2025-03-09 09:19:19,259 [INFO]: 	reconstruction error %: 0.0
2025-03-09 09:19:19,259 [INFO]: 	nb vectors: 2893
2025-03-09 09:19:19,259 [INFO]: 	vectors dimension: 49152
2025-03-09 09:19:19,259 [INFO]: 	compression ratio: 0.999309768208398
2025-03-09 09:19:19,259 [INFO]: }
2025-03-09 09:19:19,259 [INFO]: 	>>> Finished "Creating the index" in 55.2670 secs
2025-03-09 09:19:19,259 [INFO]: >>> Finished "Launching the whole pipeline" in 55.2979 secs
2025-03-09 09:19:20: [retrieval_preprocessing] calculating distances ...
2025-03-09 09:19:20: [retrieval_preprocessing] finished and saved retrieval indices for episode 87123 [episode count 16/20]
[retrieval_preprocessing] for episode 73303 [episode count 17/20], we have num_retrieval=np.int64(2933) num_query=np.int64(122)
2025-03-09 09:19:21,013 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-09 09:19:21,466 [INFO]: Launching the whole pipeline 03/09/2025, 09:19:21
2025-03-09 09:19:21,466 [INFO]: Reading total number of vectors and dimension 03/09/2025, 09:19:21
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1567.96it/s]
2025-03-09 09:19:21,501 [INFO]: There are 2933 embeddings of dim 49152
2025-03-09 09:19:21,501 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0350 secs
2025-03-09 09:19:21,502 [INFO]: 	Compute estimated construction time of the index 03/09/2025, 09:19:21
2025-03-09 09:19:21,502 [INFO]: 		-> Train: 16.7 minutes
2025-03-09 09:19:21,502 [INFO]: 		-> Add: 1.6 seconds
2025-03-09 09:19:21,502 [INFO]: 		Total: 16.7 minutes
2025-03-09 09:19:21,502 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0001 secs
2025-03-09 09:19:21,502 [INFO]: 	Checking that your have enough memory available to create the index 03/09/2025, 09:19:21
2025-03-09 09:19:21,502 [INFO]: 605.3MB of memory will be needed to build the index (more might be used if you have more)
2025-03-09 09:19:21,502 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0001 secs
2025-03-09 09:19:21,502 [INFO]: 	Selecting most promising index types given data characteristics 03/09/2025, 09:19:21
2025-03-09 09:19:21,502 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-09 09:19:21,502 [INFO]: 	Creating the index 03/09/2025, 09:19:21
2025-03-09 09:19:21,502 [INFO]: 		-> Instanciate the index HNSW15 03/09/2025, 09:19:21
2025-03-09 09:19:21,503 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0009 secs
2025-03-09 09:19:21,503 [INFO]: 		-> Adding the vectors to the index 03/09/2025, 09:19:21
2025-03-09 09:19:21,503 [INFO]: The memory available for adding the vectors is 49.5GB(total available - used by the index)
2025-03-09 09:19:21,503 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/12 [00:00<?, ?it/s]  8%|▊         | 1/12 [00:00<00:01,  7.66it/s] 50%|█████     | 6/12 [00:00<00:00, 27.54it/s] 75%|███████▌  | 9/12 [00:00<00:00, 28.28it/s]100%|██████████| 12/12 [00:02<00:00,  3.52it/s]100%|██████████| 12/12 [00:02<00:00,  4.96it/s]
2025-03-09 09:19:23,928 [INFO]: 	Computing best hyperparameters for index knn.index 03/09/2025, 09:19:23
2025-03-09 09:20:02,896 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 38.9681 secs
2025-03-09 09:20:02,897 [INFO]: The best hyperparameters are: efSearch=201
2025-03-09 09:20:02,897 [INFO]: 	Compute fast metrics 03/09/2025, 09:20:02
  0%|          | 0/4 [00:00<?, ?it/s] 75%|███████▌  | 3/4 [00:00<00:00, 26.56it/s] 75%|███████▌  | 3/4 [00:00<00:00, 22.63it/s]
2025-03-09 09:20:17,937 [INFO]: 	>>> Finished "Compute fast metrics" in 15.0406 secs
2025-03-09 09:20:17,939 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 56.4358 secs
2025-03-09 09:20:17,939 [INFO]: {
2025-03-09 09:20:17,939 [INFO]: 	index_key: HNSW15
2025-03-09 09:20:17,939 [INFO]: 	index_param: efSearch=201
2025-03-09 09:20:17,939 [INFO]: 	index_path: knn.index
2025-03-09 09:20:17,939 [INFO]: 	size in bytes: 577049590
2025-03-09 09:20:17,939 [INFO]: 	avg_search_speed_ms: 8.390007382563484
2025-03-09 09:20:17,939 [INFO]: 	99p_search_speed_ms: 19.253296523820552
2025-03-09 09:20:17,939 [INFO]: 	reconstruction error %: 0.0
2025-03-09 09:20:17,939 [INFO]: 	nb vectors: 2933
2025-03-09 09:20:17,939 [INFO]: 	vectors dimension: 49152
2025-03-09 09:20:17,939 [INFO]: 	compression ratio: 0.9993097196377871
2025-03-09 09:20:17,939 [INFO]: }
2025-03-09 09:20:17,939 [INFO]: 	>>> Finished "Creating the index" in 56.4373 secs
2025-03-09 09:20:17,939 [INFO]: >>> Finished "Launching the whole pipeline" in 56.4730 secs
2025-03-09 09:20:18: [retrieval_preprocessing] calculating distances ...
2025-03-09 09:20:18: [retrieval_preprocessing] finished and saved retrieval indices for episode 73303 [episode count 17/20]
[retrieval_preprocessing] for episode 5209 [episode count 18/20], we have num_retrieval=np.int64(2864) num_query=np.int64(191)
2025-03-09 09:20:19,043 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-09 09:20:19,384 [INFO]: Launching the whole pipeline 03/09/2025, 09:20:19
2025-03-09 09:20:19,384 [INFO]: Reading total number of vectors and dimension 03/09/2025, 09:20:19
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1878.33it/s]
2025-03-09 09:20:19,411 [INFO]: There are 2864 embeddings of dim 49152
2025-03-09 09:20:19,411 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0272 secs
2025-03-09 09:20:19,411 [INFO]: 	Compute estimated construction time of the index 03/09/2025, 09:20:19
2025-03-09 09:20:19,411 [INFO]: 		-> Train: 16.7 minutes
2025-03-09 09:20:19,411 [INFO]: 		-> Add: 1.6 seconds
2025-03-09 09:20:19,411 [INFO]: 		Total: 16.7 minutes
2025-03-09 09:20:19,411 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0001 secs
2025-03-09 09:20:19,411 [INFO]: 	Checking that your have enough memory available to create the index 03/09/2025, 09:20:19
2025-03-09 09:20:19,412 [INFO]: 591.1MB of memory will be needed to build the index (more might be used if you have more)
2025-03-09 09:20:19,412 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0001 secs
2025-03-09 09:20:19,412 [INFO]: 	Selecting most promising index types given data characteristics 03/09/2025, 09:20:19
2025-03-09 09:20:19,412 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-09 09:20:19,412 [INFO]: 	Creating the index 03/09/2025, 09:20:19
2025-03-09 09:20:19,412 [INFO]: 		-> Instanciate the index HNSW15 03/09/2025, 09:20:19
2025-03-09 09:20:19,413 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0009 secs
2025-03-09 09:20:19,413 [INFO]: 		-> Adding the vectors to the index 03/09/2025, 09:20:19
2025-03-09 09:20:19,413 [INFO]: The memory available for adding the vectors is 49.5GB(total available - used by the index)
2025-03-09 09:20:19,413 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/12 [00:00<?, ?it/s]  8%|▊         | 1/12 [00:00<00:01,  8.85it/s] 42%|████▏     | 5/12 [00:00<00:00, 23.96it/s] 75%|███████▌  | 9/12 [00:00<00:00, 30.27it/s]100%|██████████| 12/12 [00:02<00:00,  5.51it/s]
2025-03-09 09:20:21,592 [INFO]: 	Computing best hyperparameters for index knn.index 03/09/2025, 09:20:21
2025-03-09 09:21:01,378 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 39.7850 secs
2025-03-09 09:21:01,379 [INFO]: The best hyperparameters are: efSearch=214
2025-03-09 09:21:01,379 [INFO]: 	Compute fast metrics 03/09/2025, 09:21:01
  0%|          | 0/4 [00:00<?, ?it/s] 50%|█████     | 2/4 [00:00<00:00, 16.91it/s] 75%|███████▌  | 3/4 [00:00<00:00, 15.18it/s]
2025-03-09 09:21:19,028 [INFO]: 	>>> Finished "Compute fast metrics" in 17.6486 secs
2025-03-09 09:21:19,030 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 59.6166 secs
2025-03-09 09:21:19,030 [INFO]: {
2025-03-09 09:21:19,030 [INFO]: 	index_key: HNSW15
2025-03-09 09:21:19,030 [INFO]: 	index_param: efSearch=214
2025-03-09 09:21:19,030 [INFO]: 	index_path: knn.index
2025-03-09 09:21:19,030 [INFO]: 	size in bytes: 563474290
2025-03-09 09:21:19,030 [INFO]: 	avg_search_speed_ms: 8.33129579356561
2025-03-09 09:21:19,030 [INFO]: 	99p_search_speed_ms: 18.547155591659244
2025-03-09 09:21:19,030 [INFO]: 	reconstruction error %: 0.0
2025-03-09 09:21:19,030 [INFO]: 	nb vectors: 2864
2025-03-09 09:21:19,030 [INFO]: 	vectors dimension: 49152
2025-03-09 09:21:19,030 [INFO]: 	compression ratio: 0.999309679240201
2025-03-09 09:21:19,030 [INFO]: }
2025-03-09 09:21:19,030 [INFO]: 	>>> Finished "Creating the index" in 59.6181 secs
2025-03-09 09:21:19,030 [INFO]: >>> Finished "Launching the whole pipeline" in 59.6460 secs
2025-03-09 09:21:19: [retrieval_preprocessing] calculating distances ...
2025-03-09 09:21:20: [retrieval_preprocessing] finished and saved retrieval indices for episode 5209 [episode count 18/20]
[retrieval_preprocessing] for episode 41053 [episode count 19/20], we have num_retrieval=np.int64(2875) num_query=np.int64(180)
2025-03-09 09:21:20,596 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-09 09:21:21,062 [INFO]: Launching the whole pipeline 03/09/2025, 09:21:21
2025-03-09 09:21:21,062 [INFO]: Reading total number of vectors and dimension 03/09/2025, 09:21:21
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1226.40it/s]
2025-03-09 09:21:21,090 [INFO]: There are 2875 embeddings of dim 49152
2025-03-09 09:21:21,090 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0284 secs
2025-03-09 09:21:21,090 [INFO]: 	Compute estimated construction time of the index 03/09/2025, 09:21:21
2025-03-09 09:21:21,090 [INFO]: 		-> Train: 16.7 minutes
2025-03-09 09:21:21,091 [INFO]: 		-> Add: 1.6 seconds
2025-03-09 09:21:21,091 [INFO]: 		Total: 16.7 minutes
2025-03-09 09:21:21,091 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0002 secs
2025-03-09 09:21:21,091 [INFO]: 	Checking that your have enough memory available to create the index 03/09/2025, 09:21:21
2025-03-09 09:21:21,091 [INFO]: 593.3MB of memory will be needed to build the index (more might be used if you have more)
2025-03-09 09:21:21,091 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0003 secs
2025-03-09 09:21:21,091 [INFO]: 	Selecting most promising index types given data characteristics 03/09/2025, 09:21:21
2025-03-09 09:21:21,091 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-09 09:21:21,091 [INFO]: 	Creating the index 03/09/2025, 09:21:21
2025-03-09 09:21:21,091 [INFO]: 		-> Instanciate the index HNSW15 03/09/2025, 09:21:21
2025-03-09 09:21:21,093 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0012 secs
2025-03-09 09:21:21,093 [INFO]: 		-> Adding the vectors to the index 03/09/2025, 09:21:21
2025-03-09 09:21:21,093 [INFO]: The memory available for adding the vectors is 49.5GB(total available - used by the index)
2025-03-09 09:21:21,093 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/12 [00:00<?, ?it/s] 17%|█▋        | 2/12 [00:00<00:00, 19.09it/s] 67%|██████▋   | 8/12 [00:00<00:00, 38.35it/s]100%|██████████| 12/12 [00:02<00:00,  4.51it/s]100%|██████████| 12/12 [00:02<00:00,  5.64it/s]
2025-03-09 09:21:23,223 [INFO]: 	Computing best hyperparameters for index knn.index 03/09/2025, 09:21:23
2025-03-09 09:21:52,503 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 29.2797 secs
2025-03-09 09:21:52,503 [INFO]: The best hyperparameters are: efSearch=259
2025-03-09 09:21:52,503 [INFO]: 	Compute fast metrics 03/09/2025, 09:21:52
  0%|          | 0/4 [00:00<?, ?it/s] 75%|███████▌  | 3/4 [00:00<00:00, 25.81it/s] 75%|███████▌  | 3/4 [00:00<00:00, 22.13it/s]
2025-03-09 09:22:10,576 [INFO]: 	>>> Finished "Compute fast metrics" in 18.0725 secs
2025-03-09 09:22:10,579 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 49.4862 secs
2025-03-09 09:22:10,579 [INFO]: {
2025-03-09 09:22:10,579 [INFO]: 	index_key: HNSW15
2025-03-09 09:22:10,579 [INFO]: 	index_param: efSearch=259
2025-03-09 09:22:10,579 [INFO]: 	index_path: knn.index
2025-03-09 09:22:10,579 [INFO]: 	size in bytes: 565638430
2025-03-09 09:22:10,579 [INFO]: 	avg_search_speed_ms: 9.919809869773287
2025-03-09 09:22:10,579 [INFO]: 	99p_search_speed_ms: 17.878959283698347
2025-03-09 09:22:10,579 [INFO]: 	reconstruction error %: 0.0
2025-03-09 09:22:10,579 [INFO]: 	nb vectors: 2875
2025-03-09 09:22:10,579 [INFO]: 	vectors dimension: 49152
2025-03-09 09:22:10,579 [INFO]: 	compression ratio: 0.9993097534055456
2025-03-09 09:22:10,579 [INFO]: }
2025-03-09 09:22:10,579 [INFO]: 	>>> Finished "Creating the index" in 49.4880 secs
2025-03-09 09:22:10,579 [INFO]: >>> Finished "Launching the whole pipeline" in 49.5174 secs
2025-03-09 09:22:11: [retrieval_preprocessing] calculating distances ...
2025-03-09 09:22:12: [retrieval_preprocessing] finished and saved retrieval indices for episode 41053 [episode count 19/20]
2025-03-09 09:22:12: [retrieval_preprocessing] finished for (1775582436, 'marker') [chosen_id count 7/10]
2025-03-09 09:22:14: [retrieval_preprocessing] concatenated all embeddings and indices for 20 episodes for (4706041793, 'cloth') [chosen_id count 8/10]
2025-03-09 09:22:14: [retrieval_preprocessing] we have num_total=3389 embedding_dim=49152
[retrieval_preprocessing] for episode 20480 [episode count 0/20], we have num_retrieval=np.int64(3272) num_query=np.int64(117)
2025-03-09 09:22:14,294 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-09 09:22:14,738 [INFO]: Launching the whole pipeline 03/09/2025, 09:22:14
2025-03-09 09:22:14,738 [INFO]: Reading total number of vectors and dimension 03/09/2025, 09:22:14
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1543.73it/s]
2025-03-09 09:22:14,766 [INFO]: There are 3272 embeddings of dim 49152
2025-03-09 09:22:14,766 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0275 secs
2025-03-09 09:22:14,766 [INFO]: 	Compute estimated construction time of the index 03/09/2025, 09:22:14
2025-03-09 09:22:14,766 [INFO]: 		-> Train: 16.7 minutes
2025-03-09 09:22:14,766 [INFO]: 		-> Add: 1.8 seconds
2025-03-09 09:22:14,767 [INFO]: 		Total: 16.7 minutes
2025-03-09 09:22:14,767 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0001 secs
2025-03-09 09:22:14,767 [INFO]: 	Checking that your have enough memory available to create the index 03/09/2025, 09:22:14
2025-03-09 09:22:14,767 [INFO]: 675.3MB of memory will be needed to build the index (more might be used if you have more)
2025-03-09 09:22:14,767 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0002 secs
2025-03-09 09:22:14,767 [INFO]: 	Selecting most promising index types given data characteristics 03/09/2025, 09:22:14
2025-03-09 09:22:14,767 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-09 09:22:14,767 [INFO]: 	Creating the index 03/09/2025, 09:22:14
2025-03-09 09:22:14,767 [INFO]: 		-> Instanciate the index HNSW15 03/09/2025, 09:22:14
2025-03-09 09:22:14,768 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0010 secs
2025-03-09 09:22:14,768 [INFO]: 		-> Adding the vectors to the index 03/09/2025, 09:22:14
2025-03-09 09:22:14,768 [INFO]: The memory available for adding the vectors is 49.4GB(total available - used by the index)
2025-03-09 09:22:14,768 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/13 [00:00<?, ?it/s] 15%|█▌        | 2/13 [00:00<00:00, 19.68it/s] 54%|█████▍    | 7/13 [00:00<00:00, 36.83it/s] 92%|█████████▏| 12/13 [00:00<00:00, 42.12it/s]100%|██████████| 13/13 [00:02<00:00,  4.68it/s]
2025-03-09 09:22:17,548 [INFO]: 	Computing best hyperparameters for index knn.index 03/09/2025, 09:22:17
2025-03-09 09:22:53,037 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 35.4886 secs
2025-03-09 09:22:53,037 [INFO]: The best hyperparameters are: efSearch=199
2025-03-09 09:22:53,038 [INFO]: 	Compute fast metrics 03/09/2025, 09:22:53
  0%|          | 0/4 [00:00<?, ?it/s] 50%|█████     | 2/4 [00:00<00:00, 19.69it/s] 75%|███████▌  | 3/4 [00:00<00:00, 21.88it/s]
2025-03-09 09:23:08,007 [INFO]: 	>>> Finished "Compute fast metrics" in 14.9689 secs
2025-03-09 09:23:08,009 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 53.2403 secs
2025-03-09 09:23:08,009 [INFO]: {
2025-03-09 09:23:08,009 [INFO]: 	index_key: HNSW15
2025-03-09 09:23:08,009 [INFO]: 	index_param: efSearch=199
2025-03-09 09:23:08,009 [INFO]: 	index_path: knn.index
2025-03-09 09:23:08,009 [INFO]: 	size in bytes: 643746190
2025-03-09 09:23:08,009 [INFO]: 	avg_search_speed_ms: 10.834776466557136
2025-03-09 09:23:08,009 [INFO]: 	99p_search_speed_ms: 22.600226087961342
2025-03-09 09:23:08,009 [INFO]: 	reconstruction error %: 0.0
2025-03-09 09:23:08,009 [INFO]: 	nb vectors: 3272
2025-03-09 09:23:08,009 [INFO]: 	vectors dimension: 49152
2025-03-09 09:23:08,009 [INFO]: 	compression ratio: 0.9993090227066043
2025-03-09 09:23:08,009 [INFO]: }
2025-03-09 09:23:08,009 [INFO]: 	>>> Finished "Creating the index" in 53.2419 secs
2025-03-09 09:23:08,009 [INFO]: >>> Finished "Launching the whole pipeline" in 53.2706 secs
2025-03-09 09:23:08: [retrieval_preprocessing] calculating distances ...
2025-03-09 09:23:08: [retrieval_preprocessing] finished and saved retrieval indices for episode 20480 [episode count 0/20]
[retrieval_preprocessing] for episode 48136 [episode count 1/20], we have num_retrieval=np.int64(3208) num_query=np.int64(181)
2025-03-09 09:23:09,163 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-09 09:23:09,515 [INFO]: Launching the whole pipeline 03/09/2025, 09:23:09
2025-03-09 09:23:09,515 [INFO]: Reading total number of vectors and dimension 03/09/2025, 09:23:09
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1579.18it/s]
2025-03-09 09:23:09,542 [INFO]: There are 3208 embeddings of dim 49152
2025-03-09 09:23:09,542 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0273 secs
2025-03-09 09:23:09,542 [INFO]: 	Compute estimated construction time of the index 03/09/2025, 09:23:09
2025-03-09 09:23:09,542 [INFO]: 		-> Train: 16.7 minutes
2025-03-09 09:23:09,542 [INFO]: 		-> Add: 1.8 seconds
2025-03-09 09:23:09,542 [INFO]: 		Total: 16.7 minutes
2025-03-09 09:23:09,542 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0001 secs
2025-03-09 09:23:09,542 [INFO]: 	Checking that your have enough memory available to create the index 03/09/2025, 09:23:09
2025-03-09 09:23:09,543 [INFO]: 662.1MB of memory will be needed to build the index (more might be used if you have more)
2025-03-09 09:23:09,543 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0001 secs
2025-03-09 09:23:09,543 [INFO]: 	Selecting most promising index types given data characteristics 03/09/2025, 09:23:09
2025-03-09 09:23:09,543 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-09 09:23:09,543 [INFO]: 	Creating the index 03/09/2025, 09:23:09
2025-03-09 09:23:09,543 [INFO]: 		-> Instanciate the index HNSW15 03/09/2025, 09:23:09
2025-03-09 09:23:09,544 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0011 secs
2025-03-09 09:23:09,544 [INFO]: 		-> Adding the vectors to the index 03/09/2025, 09:23:09
2025-03-09 09:23:09,544 [INFO]: The memory available for adding the vectors is 49.4GB(total available - used by the index)
2025-03-09 09:23:09,544 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/13 [00:00<?, ?it/s]  8%|▊         | 1/13 [00:00<00:01,  9.92it/s] 54%|█████▍    | 7/13 [00:00<00:00, 36.51it/s]100%|██████████| 13/13 [00:02<00:00,  4.90it/s]100%|██████████| 13/13 [00:02<00:00,  5.73it/s]
2025-03-09 09:23:11,814 [INFO]: 	Computing best hyperparameters for index knn.index 03/09/2025, 09:23:11
2025-03-09 09:23:40,622 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 28.8071 secs
2025-03-09 09:23:40,622 [INFO]: The best hyperparameters are: efSearch=136
2025-03-09 09:23:40,622 [INFO]: 	Compute fast metrics 03/09/2025, 09:23:40
  0%|          | 0/4 [00:00<?, ?it/s] 50%|█████     | 2/4 [00:00<00:00, 19.88it/s] 75%|███████▌  | 3/4 [00:00<00:00, 20.73it/s]
2025-03-09 09:23:57,664 [INFO]: 	>>> Finished "Compute fast metrics" in 17.0422 secs
2025-03-09 09:23:57,666 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 48.1221 secs
2025-03-09 09:23:57,666 [INFO]: {
2025-03-09 09:23:57,666 [INFO]: 	index_key: HNSW15
2025-03-09 09:23:57,666 [INFO]: 	index_param: efSearch=136
2025-03-09 09:23:57,666 [INFO]: 	index_path: knn.index
2025-03-09 09:23:57,666 [INFO]: 	size in bytes: 631154110
2025-03-09 09:23:57,666 [INFO]: 	avg_search_speed_ms: 8.104344545388097
2025-03-09 09:23:57,666 [INFO]: 	99p_search_speed_ms: 17.042400699574504
2025-03-09 09:23:57,666 [INFO]: 	reconstruction error %: 0.0
2025-03-09 09:23:57,666 [INFO]: 	nb vectors: 3208
2025-03-09 09:23:57,666 [INFO]: 	vectors dimension: 49152
2025-03-09 09:23:57,666 [INFO]: 	compression ratio: 0.9993097628723355
2025-03-09 09:23:57,666 [INFO]: }
2025-03-09 09:23:57,666 [INFO]: 	>>> Finished "Creating the index" in 48.1238 secs
2025-03-09 09:23:57,666 [INFO]: >>> Finished "Launching the whole pipeline" in 48.1516 secs
2025-03-09 09:23:58: [retrieval_preprocessing] calculating distances ...
2025-03-09 09:23:58: [retrieval_preprocessing] finished and saved retrieval indices for episode 48136 [episode count 1/20]
[retrieval_preprocessing] for episode 55309 [episode count 2/20], we have num_retrieval=np.int64(3285) num_query=np.int64(104)
2025-03-09 09:23:59,180 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-09 09:23:59,599 [INFO]: Launching the whole pipeline 03/09/2025, 09:23:59
2025-03-09 09:23:59,599 [INFO]: Reading total number of vectors and dimension 03/09/2025, 09:23:59
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1871.62it/s]
2025-03-09 09:23:59,626 [INFO]: There are 3285 embeddings of dim 49152
2025-03-09 09:23:59,626 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0274 secs
2025-03-09 09:23:59,626 [INFO]: 	Compute estimated construction time of the index 03/09/2025, 09:23:59
2025-03-09 09:23:59,626 [INFO]: 		-> Train: 16.7 minutes
2025-03-09 09:23:59,626 [INFO]: 		-> Add: 1.8 seconds
2025-03-09 09:23:59,626 [INFO]: 		Total: 16.7 minutes
2025-03-09 09:23:59,626 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0001 secs
2025-03-09 09:23:59,626 [INFO]: 	Checking that your have enough memory available to create the index 03/09/2025, 09:23:59
2025-03-09 09:23:59,627 [INFO]: 677.9MB of memory will be needed to build the index (more might be used if you have more)
2025-03-09 09:23:59,627 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0001 secs
2025-03-09 09:23:59,627 [INFO]: 	Selecting most promising index types given data characteristics 03/09/2025, 09:23:59
2025-03-09 09:23:59,627 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-09 09:23:59,627 [INFO]: 	Creating the index 03/09/2025, 09:23:59
2025-03-09 09:23:59,627 [INFO]: 		-> Instanciate the index HNSW15 03/09/2025, 09:23:59
2025-03-09 09:23:59,628 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0009 secs
2025-03-09 09:23:59,628 [INFO]: 		-> Adding the vectors to the index 03/09/2025, 09:23:59
2025-03-09 09:23:59,628 [INFO]: The memory available for adding the vectors is 49.4GB(total available - used by the index)
2025-03-09 09:23:59,628 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/13 [00:00<?, ?it/s] 15%|█▌        | 2/13 [00:00<00:00, 18.22it/s] 62%|██████▏   | 8/13 [00:00<00:00, 38.15it/s]100%|██████████| 13/13 [00:02<00:00,  3.84it/s]100%|██████████| 13/13 [00:02<00:00,  4.74it/s]
2025-03-09 09:24:02,372 [INFO]: 	Computing best hyperparameters for index knn.index 03/09/2025, 09:24:02
2025-03-09 09:24:33,708 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 31.3353 secs
2025-03-09 09:24:33,708 [INFO]: The best hyperparameters are: efSearch=207
2025-03-09 09:24:33,708 [INFO]: 	Compute fast metrics 03/09/2025, 09:24:33
  0%|          | 0/4 [00:00<?, ?it/s] 75%|███████▌  | 3/4 [00:00<00:00, 27.13it/s] 75%|███████▌  | 3/4 [00:00<00:00, 23.10it/s]
2025-03-09 09:24:50,967 [INFO]: 	>>> Finished "Compute fast metrics" in 17.2588 secs
2025-03-09 09:24:50,969 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 51.3414 secs
2025-03-09 09:24:50,969 [INFO]: {
2025-03-09 09:24:50,969 [INFO]: 	index_key: HNSW15
2025-03-09 09:24:50,969 [INFO]: 	index_param: efSearch=207
2025-03-09 09:24:50,969 [INFO]: 	index_path: knn.index
2025-03-09 09:24:50,969 [INFO]: 	size in bytes: 646303870
2025-03-09 09:24:50,969 [INFO]: 	avg_search_speed_ms: 11.860703565301826
2025-03-09 09:24:50,969 [INFO]: 	99p_search_speed_ms: 25.598848722875132
2025-03-09 09:24:50,969 [INFO]: 	reconstruction error %: 0.0
2025-03-09 09:24:50,969 [INFO]: 	nb vectors: 3285
2025-03-09 09:24:50,969 [INFO]: 	vectors dimension: 49152
2025-03-09 09:24:50,969 [INFO]: 	compression ratio: 0.9993090092435931
2025-03-09 09:24:50,969 [INFO]: }
2025-03-09 09:24:50,969 [INFO]: 	>>> Finished "Creating the index" in 51.3427 secs
2025-03-09 09:24:50,969 [INFO]: >>> Finished "Launching the whole pipeline" in 51.3706 secs
2025-03-09 09:24:51: [retrieval_preprocessing] calculating distances ...
2025-03-09 09:24:52: [retrieval_preprocessing] finished and saved retrieval indices for episode 55309 [episode count 2/20]
[retrieval_preprocessing] for episode 39950 [episode count 3/20], we have num_retrieval=np.int64(3234) num_query=np.int64(155)
2025-03-09 09:24:52,346 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-09 09:24:52,958 [INFO]: Launching the whole pipeline 03/09/2025, 09:24:52
2025-03-09 09:24:52,958 [INFO]: Reading total number of vectors and dimension 03/09/2025, 09:24:52
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 2336.66it/s]
2025-03-09 09:24:52,983 [INFO]: There are 3234 embeddings of dim 49152
2025-03-09 09:24:52,983 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0252 secs
2025-03-09 09:24:52,983 [INFO]: 	Compute estimated construction time of the index 03/09/2025, 09:24:52
2025-03-09 09:24:52,983 [INFO]: 		-> Train: 16.7 minutes
2025-03-09 09:24:52,983 [INFO]: 		-> Add: 1.8 seconds
2025-03-09 09:24:52,983 [INFO]: 		Total: 16.7 minutes
2025-03-09 09:24:52,983 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0001 secs
2025-03-09 09:24:52,984 [INFO]: 	Checking that your have enough memory available to create the index 03/09/2025, 09:24:52
2025-03-09 09:24:52,984 [INFO]: 667.4MB of memory will be needed to build the index (more might be used if you have more)
2025-03-09 09:24:52,984 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0001 secs
2025-03-09 09:24:52,984 [INFO]: 	Selecting most promising index types given data characteristics 03/09/2025, 09:24:52
2025-03-09 09:24:52,984 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-09 09:24:52,984 [INFO]: 	Creating the index 03/09/2025, 09:24:52
2025-03-09 09:24:52,984 [INFO]: 		-> Instanciate the index HNSW15 03/09/2025, 09:24:52
2025-03-09 09:24:52,985 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0009 secs
2025-03-09 09:24:52,985 [INFO]: 		-> Adding the vectors to the index 03/09/2025, 09:24:52
2025-03-09 09:24:52,985 [INFO]: The memory available for adding the vectors is 49.4GB(total available - used by the index)
2025-03-09 09:24:52,985 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/13 [00:00<?, ?it/s]  8%|▊         | 1/13 [00:00<00:01,  8.61it/s] 54%|█████▍    | 7/13 [00:00<00:00, 34.99it/s]100%|██████████| 13/13 [00:02<00:00,  4.28it/s]100%|██████████| 13/13 [00:02<00:00,  5.02it/s]
2025-03-09 09:24:55,578 [INFO]: 	Computing best hyperparameters for index knn.index 03/09/2025, 09:24:55
2025-03-09 09:25:33,537 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 37.9588 secs
2025-03-09 09:25:33,538 [INFO]: The best hyperparameters are: efSearch=159
2025-03-09 09:25:33,538 [INFO]: 	Compute fast metrics 03/09/2025, 09:25:33
  0%|          | 0/4 [00:00<?, ?it/s] 50%|█████     | 2/4 [00:00<00:00, 19.47it/s] 75%|███████▌  | 3/4 [00:00<00:00, 21.78it/s]
2025-03-09 09:25:52,392 [INFO]: 	>>> Finished "Compute fast metrics" in 18.8542 secs
2025-03-09 09:25:52,394 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 59.4091 secs
2025-03-09 09:25:52,394 [INFO]: {
2025-03-09 09:25:52,394 [INFO]: 	index_key: HNSW15
2025-03-09 09:25:52,394 [INFO]: 	index_param: efSearch=159
2025-03-09 09:25:52,394 [INFO]: 	index_path: knn.index
2025-03-09 09:25:52,394 [INFO]: 	size in bytes: 636269710
2025-03-09 09:25:52,394 [INFO]: 	avg_search_speed_ms: 8.619065162653488
2025-03-09 09:25:52,394 [INFO]: 	99p_search_speed_ms: 19.113073721528057
2025-03-09 09:25:52,394 [INFO]: 	reconstruction error %: 0.0
2025-03-09 09:25:52,394 [INFO]: 	nb vectors: 3234
2025-03-09 09:25:52,394 [INFO]: 	vectors dimension: 49152
2025-03-09 09:25:52,394 [INFO]: 	compression ratio: 0.9993093526328638
2025-03-09 09:25:52,394 [INFO]: }
2025-03-09 09:25:52,394 [INFO]: 	>>> Finished "Creating the index" in 59.4105 secs
2025-03-09 09:25:52,394 [INFO]: >>> Finished "Launching the whole pipeline" in 59.4362 secs
2025-03-09 09:25:52: [retrieval_preprocessing] calculating distances ...
2025-03-09 09:25:53: [retrieval_preprocessing] finished and saved retrieval indices for episode 39950 [episode count 3/20]
[retrieval_preprocessing] for episode 75280 [episode count 4/20], we have num_retrieval=np.int64(3226) num_query=np.int64(163)
2025-03-09 09:25:53,708 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-09 09:25:54,731 [INFO]: Launching the whole pipeline 03/09/2025, 09:25:54
2025-03-09 09:25:54,731 [INFO]: Reading total number of vectors and dimension 03/09/2025, 09:25:54
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1586.95it/s]
2025-03-09 09:25:54,761 [INFO]: There are 3226 embeddings of dim 49152
2025-03-09 09:25:54,761 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0301 secs
2025-03-09 09:25:54,761 [INFO]: 	Compute estimated construction time of the index 03/09/2025, 09:25:54
2025-03-09 09:25:54,761 [INFO]: 		-> Train: 16.7 minutes
2025-03-09 09:25:54,761 [INFO]: 		-> Add: 1.8 seconds
2025-03-09 09:25:54,761 [INFO]: 		Total: 16.7 minutes
2025-03-09 09:25:54,761 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0001 secs
2025-03-09 09:25:54,761 [INFO]: 	Checking that your have enough memory available to create the index 03/09/2025, 09:25:54
2025-03-09 09:25:54,761 [INFO]: 665.8MB of memory will be needed to build the index (more might be used if you have more)
2025-03-09 09:25:54,761 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0002 secs
2025-03-09 09:25:54,761 [INFO]: 	Selecting most promising index types given data characteristics 03/09/2025, 09:25:54
2025-03-09 09:25:54,761 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-09 09:25:54,761 [INFO]: 	Creating the index 03/09/2025, 09:25:54
2025-03-09 09:25:54,761 [INFO]: 		-> Instanciate the index HNSW15 03/09/2025, 09:25:54
2025-03-09 09:25:54,762 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0009 secs
2025-03-09 09:25:54,762 [INFO]: 		-> Adding the vectors to the index 03/09/2025, 09:25:54
2025-03-09 09:25:54,762 [INFO]: The memory available for adding the vectors is 49.4GB(total available - used by the index)
2025-03-09 09:25:54,762 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/13 [00:00<?, ?it/s]  8%|▊         | 1/13 [00:00<00:01,  8.08it/s] 46%|████▌     | 6/13 [00:00<00:00, 28.97it/s] 85%|████████▍ | 11/13 [00:00<00:00, 36.72it/s]100%|██████████| 13/13 [00:03<00:00,  3.90it/s]
2025-03-09 09:25:58,098 [INFO]: 	Computing best hyperparameters for index knn.index 03/09/2025, 09:25:58
2025-03-09 09:26:31,374 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 33.2755 secs
2025-03-09 09:26:31,374 [INFO]: The best hyperparameters are: efSearch=185
2025-03-09 09:26:31,374 [INFO]: 	Compute fast metrics 03/09/2025, 09:26:31
  0%|          | 0/4 [00:00<?, ?it/s] 50%|█████     | 2/4 [00:00<00:00, 18.46it/s] 75%|███████▌  | 3/4 [00:00<00:00, 18.95it/s]
2025-03-09 09:26:47,339 [INFO]: 	>>> Finished "Compute fast metrics" in 15.9644 secs
2025-03-09 09:26:47,341 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 52.5782 secs
2025-03-09 09:26:47,341 [INFO]: {
2025-03-09 09:26:47,341 [INFO]: 	index_key: HNSW15
2025-03-09 09:26:47,341 [INFO]: 	index_param: efSearch=185
2025-03-09 09:26:47,341 [INFO]: 	index_path: knn.index
2025-03-09 09:26:47,341 [INFO]: 	size in bytes: 634695670
2025-03-09 09:26:47,341 [INFO]: 	avg_search_speed_ms: 9.265420146621384
2025-03-09 09:26:47,341 [INFO]: 	99p_search_speed_ms: 18.134864051826312
2025-03-09 09:26:47,341 [INFO]: 	reconstruction error %: 0.0
2025-03-09 09:26:47,341 [INFO]: 	nb vectors: 3226
2025-03-09 09:26:47,341 [INFO]: 	vectors dimension: 49152
2025-03-09 09:26:47,341 [INFO]: 	compression ratio: 0.9993094926896224
2025-03-09 09:26:47,341 [INFO]: }
2025-03-09 09:26:47,341 [INFO]: 	>>> Finished "Creating the index" in 52.5795 secs
2025-03-09 09:26:47,341 [INFO]: >>> Finished "Launching the whole pipeline" in 52.6103 secs
2025-03-09 09:26:48: [retrieval_preprocessing] calculating distances ...
2025-03-09 09:26:48: [retrieval_preprocessing] finished and saved retrieval indices for episode 75280 [episode count 4/20]
[retrieval_preprocessing] for episode 51732 [episode count 5/20], we have num_retrieval=np.int64(3288) num_query=np.int64(101)
2025-03-09 09:26:48,727 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-09 09:26:49,601 [INFO]: Launching the whole pipeline 03/09/2025, 09:26:49
2025-03-09 09:26:49,601 [INFO]: Reading total number of vectors and dimension 03/09/2025, 09:26:49
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 2279.51it/s]
2025-03-09 09:26:49,626 [INFO]: There are 3288 embeddings of dim 49152
2025-03-09 09:26:49,627 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0254 secs
2025-03-09 09:26:49,627 [INFO]: 	Compute estimated construction time of the index 03/09/2025, 09:26:49
2025-03-09 09:26:49,627 [INFO]: 		-> Train: 16.7 minutes
2025-03-09 09:26:49,627 [INFO]: 		-> Add: 1.8 seconds
2025-03-09 09:26:49,627 [INFO]: 		Total: 16.7 minutes
2025-03-09 09:26:49,627 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0001 secs
2025-03-09 09:26:49,627 [INFO]: 	Checking that your have enough memory available to create the index 03/09/2025, 09:26:49
2025-03-09 09:26:49,627 [INFO]: 678.6MB of memory will be needed to build the index (more might be used if you have more)
2025-03-09 09:26:49,627 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0001 secs
2025-03-09 09:26:49,627 [INFO]: 	Selecting most promising index types given data characteristics 03/09/2025, 09:26:49
2025-03-09 09:26:49,627 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-09 09:26:49,627 [INFO]: 	Creating the index 03/09/2025, 09:26:49
2025-03-09 09:26:49,627 [INFO]: 		-> Instanciate the index HNSW15 03/09/2025, 09:26:49
2025-03-09 09:26:49,628 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0009 secs
2025-03-09 09:26:49,628 [INFO]: 		-> Adding the vectors to the index 03/09/2025, 09:26:49
2025-03-09 09:26:49,628 [INFO]: The memory available for adding the vectors is 49.4GB(total available - used by the index)
2025-03-09 09:26:49,628 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/13 [00:00<?, ?it/s]  8%|▊         | 1/13 [00:00<00:01,  7.78it/s] 54%|█████▍    | 7/13 [00:00<00:00, 34.53it/s]100%|██████████| 13/13 [00:02<00:00,  4.40it/s]100%|██████████| 13/13 [00:02<00:00,  5.15it/s]
2025-03-09 09:26:52,157 [INFO]: 	Computing best hyperparameters for index knn.index 03/09/2025, 09:26:52
2025-03-09 09:27:24,966 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 32.8088 secs
2025-03-09 09:27:24,966 [INFO]: The best hyperparameters are: efSearch=188
2025-03-09 09:27:24,966 [INFO]: 	Compute fast metrics 03/09/2025, 09:27:24
  0%|          | 0/4 [00:00<?, ?it/s] 50%|█████     | 2/4 [00:00<00:00, 18.48it/s] 75%|███████▌  | 3/4 [00:00<00:00, 20.10it/s]
2025-03-09 09:27:39,421 [INFO]: 	>>> Finished "Compute fast metrics" in 14.4548 secs
2025-03-09 09:27:39,423 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 49.7949 secs
2025-03-09 09:27:39,423 [INFO]: {
2025-03-09 09:27:39,423 [INFO]: 	index_key: HNSW15
2025-03-09 09:27:39,423 [INFO]: 	index_param: efSearch=188
2025-03-09 09:27:39,423 [INFO]: 	index_path: knn.index
2025-03-09 09:27:39,423 [INFO]: 	size in bytes: 646894090
2025-03-09 09:27:39,423 [INFO]: 	avg_search_speed_ms: 10.69458412967702
2025-03-09 09:27:39,423 [INFO]: 	99p_search_speed_ms: 21.77734125405548
2025-03-09 09:27:39,423 [INFO]: 	reconstruction error %: 0.0
2025-03-09 09:27:39,423 [INFO]: 	nb vectors: 3288
2025-03-09 09:27:39,423 [INFO]: 	vectors dimension: 49152
2025-03-09 09:27:39,423 [INFO]: 	compression ratio: 0.9993090275411235
2025-03-09 09:27:39,423 [INFO]: }
2025-03-09 09:27:39,423 [INFO]: 	>>> Finished "Creating the index" in 49.7963 secs
2025-03-09 09:27:39,424 [INFO]: >>> Finished "Launching the whole pipeline" in 49.8224 secs
2025-03-09 09:27:39: [retrieval_preprocessing] calculating distances ...
2025-03-09 09:27:40: [retrieval_preprocessing] finished and saved retrieval indices for episode 51732 [episode count 5/20]
[retrieval_preprocessing] for episode 50720 [episode count 6/20], we have num_retrieval=np.int64(3216) num_query=np.int64(173)
2025-03-09 09:27:40,583 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-09 09:27:41,112 [INFO]: Launching the whole pipeline 03/09/2025, 09:27:41
2025-03-09 09:27:41,112 [INFO]: Reading total number of vectors and dimension 03/09/2025, 09:27:41
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 2540.46it/s]
2025-03-09 09:27:41,140 [INFO]: There are 3216 embeddings of dim 49152
2025-03-09 09:27:41,140 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0282 secs
2025-03-09 09:27:41,140 [INFO]: 	Compute estimated construction time of the index 03/09/2025, 09:27:41
2025-03-09 09:27:41,140 [INFO]: 		-> Train: 16.7 minutes
2025-03-09 09:27:41,140 [INFO]: 		-> Add: 1.8 seconds
2025-03-09 09:27:41,141 [INFO]: 		Total: 16.7 minutes
2025-03-09 09:27:41,141 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0002 secs
2025-03-09 09:27:41,141 [INFO]: 	Checking that your have enough memory available to create the index 03/09/2025, 09:27:41
2025-03-09 09:27:41,141 [INFO]: 663.7MB of memory will be needed to build the index (more might be used if you have more)
2025-03-09 09:27:41,141 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0002 secs
2025-03-09 09:27:41,141 [INFO]: 	Selecting most promising index types given data characteristics 03/09/2025, 09:27:41
2025-03-09 09:27:41,141 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-09 09:27:41,141 [INFO]: 	Creating the index 03/09/2025, 09:27:41
2025-03-09 09:27:41,141 [INFO]: 		-> Instanciate the index HNSW15 03/09/2025, 09:27:41
2025-03-09 09:27:41,142 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0012 secs
2025-03-09 09:27:41,142 [INFO]: 		-> Adding the vectors to the index 03/09/2025, 09:27:41
2025-03-09 09:27:41,142 [INFO]: The memory available for adding the vectors is 49.4GB(total available - used by the index)
2025-03-09 09:27:41,142 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/13 [00:00<?, ?it/s]  8%|▊         | 1/13 [00:00<00:01,  7.66it/s] 46%|████▌     | 6/13 [00:00<00:00, 29.42it/s] 92%|█████████▏| 12/13 [00:00<00:00, 39.47it/s]100%|██████████| 13/13 [00:02<00:00,  4.77it/s]
2025-03-09 09:27:43,870 [INFO]: 	Computing best hyperparameters for index knn.index 03/09/2025, 09:27:43
2025-03-09 09:28:17,038 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 33.1674 secs
2025-03-09 09:28:17,038 [INFO]: The best hyperparameters are: efSearch=145
2025-03-09 09:28:17,038 [INFO]: 	Compute fast metrics 03/09/2025, 09:28:17
  0%|          | 0/4 [00:00<?, ?it/s] 50%|█████     | 2/4 [00:00<00:00, 17.75it/s] 75%|███████▌  | 3/4 [00:00<00:00, 19.06it/s]
2025-03-09 09:28:32,516 [INFO]: 	>>> Finished "Compute fast metrics" in 15.4775 secs
2025-03-09 09:28:32,550 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 51.4072 secs
2025-03-09 09:28:32,550 [INFO]: {
2025-03-09 09:28:32,550 [INFO]: 	index_key: HNSW15
2025-03-09 09:28:32,550 [INFO]: 	index_param: efSearch=145
2025-03-09 09:28:32,550 [INFO]: 	index_path: knn.index
2025-03-09 09:28:32,550 [INFO]: 	size in bytes: 632728030
2025-03-09 09:28:32,550 [INFO]: 	avg_search_speed_ms: 8.663070003917335
2025-03-09 09:28:32,550 [INFO]: 	99p_search_speed_ms: 15.369765479117634
2025-03-09 09:28:32,550 [INFO]: 	reconstruction error %: 0.0
2025-03-09 09:28:32,550 [INFO]: 	nb vectors: 3216
2025-03-09 09:28:32,550 [INFO]: 	vectors dimension: 49152
2025-03-09 09:28:32,550 [INFO]: 	compression ratio: 0.9993098108835166
2025-03-09 09:28:32,550 [INFO]: }
2025-03-09 09:28:32,550 [INFO]: 	>>> Finished "Creating the index" in 51.4093 secs
2025-03-09 09:28:32,550 [INFO]: >>> Finished "Launching the whole pipeline" in 51.4383 secs
2025-03-09 09:28:33: [retrieval_preprocessing] calculating distances ...
2025-03-09 09:28:33: [retrieval_preprocessing] finished and saved retrieval indices for episode 50720 [episode count 6/20]
[retrieval_preprocessing] for episode 79403 [episode count 7/20], we have num_retrieval=np.int64(3143) num_query=np.int64(246)
2025-03-09 09:28:34,244 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-09 09:28:34,729 [INFO]: Launching the whole pipeline 03/09/2025, 09:28:34
2025-03-09 09:28:34,730 [INFO]: Reading total number of vectors and dimension 03/09/2025, 09:28:34
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1522.99it/s]
2025-03-09 09:28:34,761 [INFO]: There are 3143 embeddings of dim 49152
2025-03-09 09:28:34,761 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0315 secs
2025-03-09 09:28:34,761 [INFO]: 	Compute estimated construction time of the index 03/09/2025, 09:28:34
2025-03-09 09:28:34,761 [INFO]: 		-> Train: 16.7 minutes
2025-03-09 09:28:34,761 [INFO]: 		-> Add: 1.7 seconds
2025-03-09 09:28:34,761 [INFO]: 		Total: 16.7 minutes
2025-03-09 09:28:34,761 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0001 secs
2025-03-09 09:28:34,761 [INFO]: 	Checking that your have enough memory available to create the index 03/09/2025, 09:28:34
2025-03-09 09:28:34,762 [INFO]: 648.6MB of memory will be needed to build the index (more might be used if you have more)
2025-03-09 09:28:34,762 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0002 secs
2025-03-09 09:28:34,762 [INFO]: 	Selecting most promising index types given data characteristics 03/09/2025, 09:28:34
2025-03-09 09:28:34,762 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-09 09:28:34,762 [INFO]: 	Creating the index 03/09/2025, 09:28:34
2025-03-09 09:28:34,762 [INFO]: 		-> Instanciate the index HNSW15 03/09/2025, 09:28:34
2025-03-09 09:28:34,763 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0012 secs
2025-03-09 09:28:34,763 [INFO]: 		-> Adding the vectors to the index 03/09/2025, 09:28:34
2025-03-09 09:28:34,763 [INFO]: The memory available for adding the vectors is 49.4GB(total available - used by the index)
2025-03-09 09:28:34,763 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/13 [00:00<?, ?it/s] 15%|█▌        | 2/13 [00:00<00:00, 16.98it/s] 54%|█████▍    | 7/13 [00:00<00:00, 34.30it/s]100%|██████████| 13/13 [00:02<00:00,  3.83it/s]100%|██████████| 13/13 [00:02<00:00,  4.59it/s]
2025-03-09 09:28:37,600 [INFO]: 	Computing best hyperparameters for index knn.index 03/09/2025, 09:28:37
2025-03-09 09:29:10,035 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 32.4351 secs
2025-03-09 09:29:10,035 [INFO]: The best hyperparameters are: efSearch=186
2025-03-09 09:29:10,035 [INFO]: 	Compute fast metrics 03/09/2025, 09:29:10
  0%|          | 0/4 [00:00<?, ?it/s] 75%|███████▌  | 3/4 [00:00<00:00, 27.12it/s] 75%|███████▌  | 3/4 [00:00<00:00, 23.13it/s]
2025-03-09 09:29:30,535 [INFO]: 	>>> Finished "Compute fast metrics" in 20.4998 secs
2025-03-09 09:29:30,537 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 55.7739 secs
2025-03-09 09:29:30,538 [INFO]: {
2025-03-09 09:29:30,538 [INFO]: 	index_key: HNSW15
2025-03-09 09:29:30,538 [INFO]: 	index_param: efSearch=186
2025-03-09 09:29:30,538 [INFO]: 	index_path: knn.index
2025-03-09 09:29:30,538 [INFO]: 	size in bytes: 618365830
2025-03-09 09:29:30,538 [INFO]: 	avg_search_speed_ms: 9.95809155603522
2025-03-09 09:29:30,538 [INFO]: 	99p_search_speed_ms: 15.258198061492296
2025-03-09 09:29:30,538 [INFO]: 	reconstruction error %: 0.0
2025-03-09 09:29:30,538 [INFO]: 	nb vectors: 3143
2025-03-09 09:29:30,538 [INFO]: 	vectors dimension: 49152
2025-03-09 09:29:30,538 [INFO]: 	compression ratio: 0.9993096546101197
2025-03-09 09:29:30,538 [INFO]: }
2025-03-09 09:29:30,538 [INFO]: 	>>> Finished "Creating the index" in 55.7761 secs
2025-03-09 09:29:30,538 [INFO]: >>> Finished "Launching the whole pipeline" in 55.8083 secs
2025-03-09 09:29:31: [retrieval_preprocessing] calculating distances ...
2025-03-09 09:29:32: [retrieval_preprocessing] finished and saved retrieval indices for episode 79403 [episode count 7/20]
[retrieval_preprocessing] for episode 13356 [episode count 8/20], we have num_retrieval=np.int64(3275) num_query=np.int64(114)
2025-03-09 09:29:33,021 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-09 09:29:33,644 [INFO]: Launching the whole pipeline 03/09/2025, 09:29:33
2025-03-09 09:29:33,644 [INFO]: Reading total number of vectors and dimension 03/09/2025, 09:29:33
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 2110.87it/s]
2025-03-09 09:29:33,674 [INFO]: There are 3275 embeddings of dim 49152
2025-03-09 09:29:33,674 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0296 secs
2025-03-09 09:29:33,674 [INFO]: 	Compute estimated construction time of the index 03/09/2025, 09:29:33
2025-03-09 09:29:33,674 [INFO]: 		-> Train: 16.7 minutes
2025-03-09 09:29:33,674 [INFO]: 		-> Add: 1.8 seconds
2025-03-09 09:29:33,674 [INFO]: 		Total: 16.7 minutes
2025-03-09 09:29:33,674 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0001 secs
2025-03-09 09:29:33,674 [INFO]: 	Checking that your have enough memory available to create the index 03/09/2025, 09:29:33
2025-03-09 09:29:33,675 [INFO]: 675.9MB of memory will be needed to build the index (more might be used if you have more)
2025-03-09 09:29:33,675 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0002 secs
2025-03-09 09:29:33,675 [INFO]: 	Selecting most promising index types given data characteristics 03/09/2025, 09:29:33
2025-03-09 09:29:33,675 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-09 09:29:33,675 [INFO]: 	Creating the index 03/09/2025, 09:29:33
2025-03-09 09:29:33,675 [INFO]: 		-> Instanciate the index HNSW15 03/09/2025, 09:29:33
2025-03-09 09:29:33,676 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0010 secs
2025-03-09 09:29:33,676 [INFO]: 		-> Adding the vectors to the index 03/09/2025, 09:29:33
2025-03-09 09:29:33,676 [INFO]: The memory available for adding the vectors is 49.4GB(total available - used by the index)
2025-03-09 09:29:33,676 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/13 [00:00<?, ?it/s]  8%|▊         | 1/13 [00:00<00:01,  8.63it/s] 31%|███       | 4/13 [00:00<00:00, 19.72it/s] 69%|██████▉   | 9/13 [00:00<00:00, 30.43it/s]100%|██████████| 13/13 [00:03<00:00,  2.77it/s]100%|██████████| 13/13 [00:03<00:00,  3.68it/s]
2025-03-09 09:29:37,213 [INFO]: 	Computing best hyperparameters for index knn.index 03/09/2025, 09:29:37
2025-03-09 09:30:11,922 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 34.7083 secs
2025-03-09 09:30:11,922 [INFO]: The best hyperparameters are: efSearch=172
2025-03-09 09:30:11,922 [INFO]: 	Compute fast metrics 03/09/2025, 09:30:11
  0%|          | 0/4 [00:00<?, ?it/s] 25%|██▌       | 1/4 [00:00<00:00,  8.81it/s] 75%|███████▌  | 3/4 [00:00<00:00, 17.62it/s]
2025-03-09 09:30:27,427 [INFO]: 	>>> Finished "Compute fast metrics" in 15.5049 secs
2025-03-09 09:30:27,429 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 53.7529 secs
2025-03-09 09:30:27,429 [INFO]: {
2025-03-09 09:30:27,429 [INFO]: 	index_key: HNSW15
2025-03-09 09:30:27,429 [INFO]: 	index_param: efSearch=172
2025-03-09 09:30:27,429 [INFO]: 	index_path: knn.index
2025-03-09 09:30:27,429 [INFO]: 	size in bytes: 644336410
2025-03-09 09:30:27,429 [INFO]: 	avg_search_speed_ms: 9.469728337232178
2025-03-09 09:30:27,429 [INFO]: 	99p_search_speed_ms: 18.979944230522964
2025-03-09 09:30:27,429 [INFO]: 	reconstruction error %: 0.0
2025-03-09 09:30:27,429 [INFO]: 	nb vectors: 3275
2025-03-09 09:30:27,429 [INFO]: 	vectors dimension: 49152
2025-03-09 09:30:27,429 [INFO]: 	compression ratio: 0.9993090410644341
2025-03-09 09:30:27,429 [INFO]: }
2025-03-09 09:30:27,429 [INFO]: 	>>> Finished "Creating the index" in 53.7545 secs
2025-03-09 09:30:27,429 [INFO]: >>> Finished "Launching the whole pipeline" in 53.7848 secs
2025-03-09 09:30:27: [retrieval_preprocessing] calculating distances ...
2025-03-09 09:30:28: [retrieval_preprocessing] finished and saved retrieval indices for episode 13356 [episode count 8/20]
[retrieval_preprocessing] for episode 35384 [episode count 9/20], we have num_retrieval=np.int64(2978) num_query=np.int64(411)
2025-03-09 09:30:28,509 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-09 09:30:28,875 [INFO]: Launching the whole pipeline 03/09/2025, 09:30:28
2025-03-09 09:30:28,875 [INFO]: Reading total number of vectors and dimension 03/09/2025, 09:30:28
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1235.80it/s]
2025-03-09 09:30:28,904 [INFO]: There are 2978 embeddings of dim 49152
2025-03-09 09:30:28,904 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0290 secs
2025-03-09 09:30:28,904 [INFO]: 	Compute estimated construction time of the index 03/09/2025, 09:30:28
2025-03-09 09:30:28,904 [INFO]: 		-> Train: 16.7 minutes
2025-03-09 09:30:28,904 [INFO]: 		-> Add: 1.6 seconds
2025-03-09 09:30:28,904 [INFO]: 		Total: 16.7 minutes
2025-03-09 09:30:28,904 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0001 secs
2025-03-09 09:30:28,904 [INFO]: 	Checking that your have enough memory available to create the index 03/09/2025, 09:30:28
2025-03-09 09:30:28,905 [INFO]: 614.6MB of memory will be needed to build the index (more might be used if you have more)
2025-03-09 09:30:28,905 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0001 secs
2025-03-09 09:30:28,905 [INFO]: 	Selecting most promising index types given data characteristics 03/09/2025, 09:30:28
2025-03-09 09:30:28,905 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-09 09:30:28,905 [INFO]: 	Creating the index 03/09/2025, 09:30:28
2025-03-09 09:30:28,905 [INFO]: 		-> Instanciate the index HNSW15 03/09/2025, 09:30:28
2025-03-09 09:30:28,906 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0009 secs
2025-03-09 09:30:28,906 [INFO]: 		-> Adding the vectors to the index 03/09/2025, 09:30:28
2025-03-09 09:30:28,906 [INFO]: The memory available for adding the vectors is 49.5GB(total available - used by the index)
2025-03-09 09:30:28,906 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/12 [00:00<?, ?it/s]  8%|▊         | 1/12 [00:00<00:01,  9.32it/s] 58%|█████▊    | 7/12 [00:00<00:00, 38.02it/s]100%|██████████| 12/12 [00:02<00:00,  4.33it/s]100%|██████████| 12/12 [00:02<00:00,  5.16it/s]
2025-03-09 09:30:31,236 [INFO]: 	Computing best hyperparameters for index knn.index 03/09/2025, 09:30:31
2025-03-09 09:31:01,183 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 29.9471 secs
2025-03-09 09:31:01,183 [INFO]: The best hyperparameters are: efSearch=213
2025-03-09 09:31:01,183 [INFO]: 	Compute fast metrics 03/09/2025, 09:31:01
  0%|          | 0/4 [00:00<?, ?it/s] 75%|███████▌  | 3/4 [00:00<00:00, 25.16it/s] 75%|███████▌  | 3/4 [00:00<00:00, 21.53it/s]
2025-03-09 09:31:16,740 [INFO]: 	>>> Finished "Compute fast metrics" in 15.5564 secs
2025-03-09 09:31:16,742 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 47.8360 secs
2025-03-09 09:31:16,742 [INFO]: {
2025-03-09 09:31:16,742 [INFO]: 	index_key: HNSW15
2025-03-09 09:31:16,742 [INFO]: 	index_param: efSearch=213
2025-03-09 09:31:16,742 [INFO]: 	index_path: knn.index
2025-03-09 09:31:16,742 [INFO]: 	size in bytes: 585903130
2025-03-09 09:31:16,742 [INFO]: 	avg_search_speed_ms: 12.148944833593156
2025-03-09 09:31:16,742 [INFO]: 	99p_search_speed_ms: 23.014504583552476
2025-03-09 09:31:16,742 [INFO]: 	reconstruction error %: 0.0
2025-03-09 09:31:16,742 [INFO]: 	nb vectors: 2978
2025-03-09 09:31:16,742 [INFO]: 	vectors dimension: 49152
2025-03-09 09:31:16,742 [INFO]: 	compression ratio: 0.9993096025959104
2025-03-09 09:31:16,742 [INFO]: }
2025-03-09 09:31:16,742 [INFO]: 	>>> Finished "Creating the index" in 47.8373 secs
2025-03-09 09:31:16,742 [INFO]: >>> Finished "Launching the whole pipeline" in 47.8669 secs
2025-03-09 09:31:18: [retrieval_preprocessing] calculating distances ...
2025-03-09 09:31:20: [retrieval_preprocessing] finished and saved retrieval indices for episode 35384 [episode count 9/20]
[retrieval_preprocessing] for episode 24137 [episode count 10/20], we have num_retrieval=np.int64(3290) num_query=np.int64(99)
2025-03-09 09:31:20,308 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-09 09:31:20,732 [INFO]: Launching the whole pipeline 03/09/2025, 09:31:20
2025-03-09 09:31:20,732 [INFO]: Reading total number of vectors and dimension 03/09/2025, 09:31:20
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1212.23it/s]
2025-03-09 09:31:20,760 [INFO]: There are 3290 embeddings of dim 49152
2025-03-09 09:31:20,760 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0279 secs
2025-03-09 09:31:20,760 [INFO]: 	Compute estimated construction time of the index 03/09/2025, 09:31:20
2025-03-09 09:31:20,761 [INFO]: 		-> Train: 16.7 minutes
2025-03-09 09:31:20,761 [INFO]: 		-> Add: 1.8 seconds
2025-03-09 09:31:20,761 [INFO]: 		Total: 16.7 minutes
2025-03-09 09:31:20,761 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0001 secs
2025-03-09 09:31:20,761 [INFO]: 	Checking that your have enough memory available to create the index 03/09/2025, 09:31:20
2025-03-09 09:31:20,761 [INFO]: 679.0MB of memory will be needed to build the index (more might be used if you have more)
2025-03-09 09:31:20,761 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0001 secs
2025-03-09 09:31:20,761 [INFO]: 	Selecting most promising index types given data characteristics 03/09/2025, 09:31:20
2025-03-09 09:31:20,761 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-09 09:31:20,761 [INFO]: 	Creating the index 03/09/2025, 09:31:20
2025-03-09 09:31:20,761 [INFO]: 		-> Instanciate the index HNSW15 03/09/2025, 09:31:20
2025-03-09 09:31:20,762 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0010 secs
2025-03-09 09:31:20,762 [INFO]: 		-> Adding the vectors to the index 03/09/2025, 09:31:20
2025-03-09 09:31:20,762 [INFO]: The memory available for adding the vectors is 49.4GB(total available - used by the index)
2025-03-09 09:31:20,762 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/13 [00:00<?, ?it/s]  8%|▊         | 1/13 [00:00<00:01,  8.64it/s] 46%|████▌     | 6/13 [00:00<00:00, 30.62it/s] 85%|████████▍ | 11/13 [00:00<00:00, 38.69it/s]100%|██████████| 13/13 [00:02<00:00,  4.53it/s]
2025-03-09 09:31:23,636 [INFO]: 	Computing best hyperparameters for index knn.index 03/09/2025, 09:31:23
2025-03-09 09:31:57,030 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 33.3942 secs
2025-03-09 09:31:57,030 [INFO]: The best hyperparameters are: efSearch=193
2025-03-09 09:31:57,030 [INFO]: 	Compute fast metrics 03/09/2025, 09:31:57
  0%|          | 0/4 [00:00<?, ?it/s] 50%|█████     | 2/4 [00:00<00:00, 18.81it/s] 75%|███████▌  | 3/4 [00:00<00:00, 20.48it/s]
2025-03-09 09:32:12,786 [INFO]: 	>>> Finished "Compute fast metrics" in 15.7554 secs
2025-03-09 09:32:12,788 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 52.0260 secs
2025-03-09 09:32:12,788 [INFO]: {
2025-03-09 09:32:12,788 [INFO]: 	index_key: HNSW15
2025-03-09 09:32:12,788 [INFO]: 	index_param: efSearch=193
2025-03-09 09:32:12,788 [INFO]: 	index_path: knn.index
2025-03-09 09:32:12,788 [INFO]: 	size in bytes: 647287570
2025-03-09 09:32:12,788 [INFO]: 	avg_search_speed_ms: 11.354770919965596
2025-03-09 09:32:12,788 [INFO]: 	99p_search_speed_ms: 25.327762076631195
2025-03-09 09:32:12,788 [INFO]: 	reconstruction error %: 0.0
2025-03-09 09:32:12,788 [INFO]: 	nb vectors: 3290
2025-03-09 09:32:12,788 [INFO]: 	vectors dimension: 49152
2025-03-09 09:32:12,788 [INFO]: 	compression ratio: 0.9993090397209389
2025-03-09 09:32:12,788 [INFO]: }
2025-03-09 09:32:12,788 [INFO]: 	>>> Finished "Creating the index" in 52.0275 secs
2025-03-09 09:32:12,788 [INFO]: >>> Finished "Launching the whole pipeline" in 52.0560 secs
2025-03-09 09:32:13: [retrieval_preprocessing] calculating distances ...
2025-03-09 09:32:14: [retrieval_preprocessing] finished and saved retrieval indices for episode 24137 [episode count 10/20]
[retrieval_preprocessing] for episode 46667 [episode count 11/20], we have num_retrieval=np.int64(3014) num_query=np.int64(375)
2025-03-09 09:32:14,407 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-09 09:32:14,964 [INFO]: Launching the whole pipeline 03/09/2025, 09:32:14
2025-03-09 09:32:14,964 [INFO]: Reading total number of vectors and dimension 03/09/2025, 09:32:14
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1691.25it/s]
2025-03-09 09:32:14,993 [INFO]: There are 3014 embeddings of dim 49152
2025-03-09 09:32:14,993 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0290 secs
2025-03-09 09:32:14,993 [INFO]: 	Compute estimated construction time of the index 03/09/2025, 09:32:14
2025-03-09 09:32:14,993 [INFO]: 		-> Train: 16.7 minutes
2025-03-09 09:32:14,993 [INFO]: 		-> Add: 1.7 seconds
2025-03-09 09:32:14,993 [INFO]: 		Total: 16.7 minutes
2025-03-09 09:32:14,993 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0001 secs
2025-03-09 09:32:14,993 [INFO]: 	Checking that your have enough memory available to create the index 03/09/2025, 09:32:14
2025-03-09 09:32:14,993 [INFO]: 622.0MB of memory will be needed to build the index (more might be used if you have more)
2025-03-09 09:32:14,993 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0001 secs
2025-03-09 09:32:14,993 [INFO]: 	Selecting most promising index types given data characteristics 03/09/2025, 09:32:14
2025-03-09 09:32:14,993 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-09 09:32:14,993 [INFO]: 	Creating the index 03/09/2025, 09:32:14
2025-03-09 09:32:14,993 [INFO]: 		-> Instanciate the index HNSW15 03/09/2025, 09:32:14
2025-03-09 09:32:14,994 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0007 secs
2025-03-09 09:32:14,994 [INFO]: 		-> Adding the vectors to the index 03/09/2025, 09:32:14
2025-03-09 09:32:14,994 [INFO]: The memory available for adding the vectors is 49.4GB(total available - used by the index)
2025-03-09 09:32:14,994 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/12 [00:00<?, ?it/s]  8%|▊         | 1/12 [00:00<00:01,  9.27it/s] 50%|█████     | 6/12 [00:00<00:00, 31.06it/s] 92%|█████████▏| 11/12 [00:00<00:00, 38.22it/s]100%|██████████| 12/12 [00:02<00:00,  4.19it/s]
2025-03-09 09:32:17,861 [INFO]: 	Computing best hyperparameters for index knn.index 03/09/2025, 09:32:17
2025-03-09 09:32:49,480 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 31.6184 secs
2025-03-09 09:32:49,481 [INFO]: The best hyperparameters are: efSearch=164
2025-03-09 09:32:49,481 [INFO]: 	Compute fast metrics 03/09/2025, 09:32:49
  0%|          | 0/4 [00:00<?, ?it/s] 75%|███████▌  | 3/4 [00:00<00:00, 25.63it/s] 75%|███████▌  | 3/4 [00:00<00:00, 22.09it/s]
2025-03-09 09:33:05,917 [INFO]: 	>>> Finished "Compute fast metrics" in 16.4358 secs
2025-03-09 09:33:05,919 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 50.9246 secs
2025-03-09 09:33:05,919 [INFO]: {
2025-03-09 09:33:05,919 [INFO]: 	index_key: HNSW15
2025-03-09 09:33:05,919 [INFO]: 	index_param: efSearch=164
2025-03-09 09:33:05,919 [INFO]: 	index_path: knn.index
2025-03-09 09:33:05,919 [INFO]: 	size in bytes: 592985770
2025-03-09 09:33:05,919 [INFO]: 	avg_search_speed_ms: 8.835058699628542
2025-03-09 09:33:05,919 [INFO]: 	99p_search_speed_ms: 14.295901162549855
2025-03-09 09:33:05,919 [INFO]: 	reconstruction error %: 0.0
2025-03-09 09:33:05,919 [INFO]: 	nb vectors: 3014
2025-03-09 09:33:05,919 [INFO]: 	vectors dimension: 49152
2025-03-09 09:33:05,919 [INFO]: 	compression ratio: 0.9993098350403923
2025-03-09 09:33:05,919 [INFO]: }
2025-03-09 09:33:05,919 [INFO]: 	>>> Finished "Creating the index" in 50.9258 secs
2025-03-09 09:33:05,919 [INFO]: >>> Finished "Launching the whole pipeline" in 50.9554 secs
2025-03-09 09:33:07: [retrieval_preprocessing] calculating distances ...
2025-03-09 09:33:08: [retrieval_preprocessing] finished and saved retrieval indices for episode 46667 [episode count 11/20]
[retrieval_preprocessing] for episode 17499 [episode count 12/20], we have num_retrieval=np.int64(3305) num_query=np.int64(84)
2025-03-09 09:33:08,594 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-09 09:33:09,018 [INFO]: Launching the whole pipeline 03/09/2025, 09:33:09
2025-03-09 09:33:09,018 [INFO]: Reading total number of vectors and dimension 03/09/2025, 09:33:09
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1500.65it/s]
2025-03-09 09:33:09,046 [INFO]: There are 3305 embeddings of dim 49152
2025-03-09 09:33:09,047 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0285 secs
2025-03-09 09:33:09,047 [INFO]: 	Compute estimated construction time of the index 03/09/2025, 09:33:09
2025-03-09 09:33:09,047 [INFO]: 		-> Train: 16.7 minutes
2025-03-09 09:33:09,047 [INFO]: 		-> Add: 1.8 seconds
2025-03-09 09:33:09,047 [INFO]: 		Total: 16.7 minutes
2025-03-09 09:33:09,047 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0002 secs
2025-03-09 09:33:09,047 [INFO]: 	Checking that your have enough memory available to create the index 03/09/2025, 09:33:09
2025-03-09 09:33:09,047 [INFO]: 682.1MB of memory will be needed to build the index (more might be used if you have more)
2025-03-09 09:33:09,047 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0001 secs
2025-03-09 09:33:09,047 [INFO]: 	Selecting most promising index types given data characteristics 03/09/2025, 09:33:09
2025-03-09 09:33:09,047 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-09 09:33:09,047 [INFO]: 	Creating the index 03/09/2025, 09:33:09
2025-03-09 09:33:09,047 [INFO]: 		-> Instanciate the index HNSW15 03/09/2025, 09:33:09
2025-03-09 09:33:09,048 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0010 secs
2025-03-09 09:33:09,048 [INFO]: 		-> Adding the vectors to the index 03/09/2025, 09:33:09
2025-03-09 09:33:09,048 [INFO]: The memory available for adding the vectors is 49.4GB(total available - used by the index)
2025-03-09 09:33:09,048 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/14 [00:00<?, ?it/s] 14%|█▍        | 2/14 [00:00<00:00, 18.31it/s] 57%|█████▋    | 8/14 [00:00<00:00, 40.21it/s]100%|██████████| 14/14 [00:03<00:00,  3.70it/s]100%|██████████| 14/14 [00:03<00:00,  4.50it/s]
2025-03-09 09:33:12,166 [INFO]: 	Computing best hyperparameters for index knn.index 03/09/2025, 09:33:12
2025-03-09 09:33:47,577 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 35.4103 secs
2025-03-09 09:33:47,577 [INFO]: The best hyperparameters are: efSearch=182
2025-03-09 09:33:47,577 [INFO]: 	Compute fast metrics 03/09/2025, 09:33:47
  0%|          | 0/4 [00:00<?, ?it/s] 50%|█████     | 2/4 [00:00<00:00, 17.63it/s] 75%|███████▌  | 3/4 [00:00<00:00, 19.55it/s]
2025-03-09 09:34:01,356 [INFO]: 	>>> Finished "Compute fast metrics" in 13.7794 secs
2025-03-09 09:34:01,359 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 52.3102 secs
2025-03-09 09:34:01,359 [INFO]: {
2025-03-09 09:34:01,359 [INFO]: 	index_key: HNSW15
2025-03-09 09:34:01,359 [INFO]: 	index_param: efSearch=182
2025-03-09 09:34:01,359 [INFO]: 	index_path: knn.index
2025-03-09 09:34:01,359 [INFO]: 	size in bytes: 650238730
2025-03-09 09:34:01,359 [INFO]: 	avg_search_speed_ms: 9.284230949554129
2025-03-09 09:34:01,359 [INFO]: 	99p_search_speed_ms: 15.2125897933729
2025-03-09 09:34:01,359 [INFO]: 	reconstruction error %: 0.0
2025-03-09 09:34:01,359 [INFO]: 	nb vectors: 3305
2025-03-09 09:34:01,359 [INFO]: 	vectors dimension: 49152
2025-03-09 09:34:01,359 [INFO]: 	compression ratio: 0.9993090383896388
2025-03-09 09:34:01,359 [INFO]: }
2025-03-09 09:34:01,359 [INFO]: 	>>> Finished "Creating the index" in 52.3117 secs
2025-03-09 09:34:01,359 [INFO]: >>> Finished "Launching the whole pipeline" in 52.3408 secs
2025-03-09 09:34:01: [retrieval_preprocessing] calculating distances ...
2025-03-09 09:34:02: [retrieval_preprocessing] finished and saved retrieval indices for episode 17499 [episode count 12/20]
[retrieval_preprocessing] for episode 71259 [episode count 13/20], we have num_retrieval=np.int64(3254) num_query=np.int64(135)
2025-03-09 09:34:02,240 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-09 09:34:02,715 [INFO]: Launching the whole pipeline 03/09/2025, 09:34:02
2025-03-09 09:34:02,715 [INFO]: Reading total number of vectors and dimension 03/09/2025, 09:34:02
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1149.44it/s]
2025-03-09 09:34:03,157 [INFO]: There are 3254 embeddings of dim 49152
2025-03-09 09:34:03,158 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.4423 secs
2025-03-09 09:34:03,158 [INFO]: 	Compute estimated construction time of the index 03/09/2025, 09:34:03
2025-03-09 09:34:03,158 [INFO]: 		-> Train: 16.7 minutes
2025-03-09 09:34:03,158 [INFO]: 		-> Add: 1.8 seconds
2025-03-09 09:34:03,158 [INFO]: 		Total: 16.7 minutes
2025-03-09 09:34:03,158 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0004 secs
2025-03-09 09:34:03,159 [INFO]: 	Checking that your have enough memory available to create the index 03/09/2025, 09:34:03
2025-03-09 09:34:03,159 [INFO]: 671.5MB of memory will be needed to build the index (more might be used if you have more)
2025-03-09 09:34:03,159 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0005 secs
2025-03-09 09:34:03,159 [INFO]: 	Selecting most promising index types given data characteristics 03/09/2025, 09:34:03
2025-03-09 09:34:03,159 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-09 09:34:03,159 [INFO]: 	Creating the index 03/09/2025, 09:34:03
2025-03-09 09:34:03,160 [INFO]: 		-> Instanciate the index HNSW15 03/09/2025, 09:34:03
2025-03-09 09:34:03,162 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0026 secs
2025-03-09 09:34:03,162 [INFO]: 		-> Adding the vectors to the index 03/09/2025, 09:34:03
2025-03-09 09:34:03,163 [INFO]: The memory available for adding the vectors is 49.4GB(total available - used by the index)
2025-03-09 09:34:03,163 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/13 [00:00<?, ?it/s] 15%|█▌        | 2/13 [00:00<00:00, 19.22it/s] 62%|██████▏   | 8/13 [00:00<00:00, 40.21it/s]100%|██████████| 13/13 [00:02<00:00,  3.87it/s]100%|██████████| 13/13 [00:02<00:00,  4.79it/s]
2025-03-09 09:34:05,885 [INFO]: 	Computing best hyperparameters for index knn.index 03/09/2025, 09:34:05
2025-03-09 09:34:42,416 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 36.5309 secs
2025-03-09 09:34:42,416 [INFO]: The best hyperparameters are: efSearch=152
2025-03-09 09:34:42,416 [INFO]: 	Compute fast metrics 03/09/2025, 09:34:42
  0%|          | 0/4 [00:00<?, ?it/s] 50%|█████     | 2/4 [00:00<00:00, 18.94it/s] 75%|███████▌  | 3/4 [00:00<00:00, 21.02it/s]
2025-03-09 09:34:56,383 [INFO]: 	>>> Finished "Compute fast metrics" in 13.9663 secs
2025-03-09 09:34:56,385 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 53.2219 secs
2025-03-09 09:34:56,385 [INFO]: {
2025-03-09 09:34:56,385 [INFO]: 	index_key: HNSW15
2025-03-09 09:34:56,385 [INFO]: 	index_param: efSearch=152
2025-03-09 09:34:56,385 [INFO]: 	index_path: knn.index
2025-03-09 09:34:56,385 [INFO]: 	size in bytes: 640204690
2025-03-09 09:34:56,385 [INFO]: 	avg_search_speed_ms: 9.531819825375841
2025-03-09 09:34:56,385 [INFO]: 	99p_search_speed_ms: 22.957269418984644
2025-03-09 09:34:56,385 [INFO]: 	reconstruction error %: 0.0
2025-03-09 09:34:56,385 [INFO]: 	nb vectors: 3254
2025-03-09 09:34:56,385 [INFO]: 	vectors dimension: 49152
2025-03-09 09:34:56,385 [INFO]: 	compression ratio: 0.9993091928145669
2025-03-09 09:34:56,385 [INFO]: }
2025-03-09 09:34:56,385 [INFO]: 	>>> Finished "Creating the index" in 53.2253 secs
2025-03-09 09:34:56,385 [INFO]: >>> Finished "Launching the whole pipeline" in 53.6694 secs
2025-03-09 09:34:56: [retrieval_preprocessing] calculating distances ...
2025-03-09 09:34:57: [retrieval_preprocessing] finished and saved retrieval indices for episode 71259 [episode count 13/20]
[retrieval_preprocessing] for episode 66664 [episode count 14/20], we have num_retrieval=np.int64(3211) num_query=np.int64(178)
2025-03-09 09:34:57,404 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-09 09:34:57,796 [INFO]: Launching the whole pipeline 03/09/2025, 09:34:57
2025-03-09 09:34:57,796 [INFO]: Reading total number of vectors and dimension 03/09/2025, 09:34:57
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1387.46it/s]
2025-03-09 09:34:57,823 [INFO]: There are 3211 embeddings of dim 49152
2025-03-09 09:34:57,823 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0272 secs
2025-03-09 09:34:57,823 [INFO]: 	Compute estimated construction time of the index 03/09/2025, 09:34:57
2025-03-09 09:34:57,823 [INFO]: 		-> Train: 16.7 minutes
2025-03-09 09:34:57,823 [INFO]: 		-> Add: 1.8 seconds
2025-03-09 09:34:57,823 [INFO]: 		Total: 16.7 minutes
2025-03-09 09:34:57,823 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0001 secs
2025-03-09 09:34:57,823 [INFO]: 	Checking that your have enough memory available to create the index 03/09/2025, 09:34:57
2025-03-09 09:34:57,823 [INFO]: 662.7MB of memory will be needed to build the index (more might be used if you have more)
2025-03-09 09:34:57,823 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0001 secs
2025-03-09 09:34:57,824 [INFO]: 	Selecting most promising index types given data characteristics 03/09/2025, 09:34:57
2025-03-09 09:34:57,824 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-09 09:34:57,824 [INFO]: 	Creating the index 03/09/2025, 09:34:57
2025-03-09 09:34:57,824 [INFO]: 		-> Instanciate the index HNSW15 03/09/2025, 09:34:57
2025-03-09 09:34:57,825 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0009 secs
2025-03-09 09:34:57,825 [INFO]: 		-> Adding the vectors to the index 03/09/2025, 09:34:57
2025-03-09 09:34:57,825 [INFO]: The memory available for adding the vectors is 49.4GB(total available - used by the index)
2025-03-09 09:34:57,825 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/13 [00:00<?, ?it/s] 23%|██▎       | 3/13 [00:00<00:00, 26.90it/s] 77%|███████▋  | 10/13 [00:00<00:00, 47.15it/s]100%|██████████| 13/13 [00:02<00:00,  4.74it/s]
2025-03-09 09:35:00,572 [INFO]: 	Computing best hyperparameters for index knn.index 03/09/2025, 09:35:00
2025-03-09 09:35:36,697 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 36.1246 secs
2025-03-09 09:35:36,697 [INFO]: The best hyperparameters are: efSearch=207
2025-03-09 09:35:36,697 [INFO]: 	Compute fast metrics 03/09/2025, 09:35:36
  0%|          | 0/4 [00:00<?, ?it/s] 50%|█████     | 2/4 [00:00<00:00, 17.79it/s] 75%|███████▌  | 3/4 [00:00<00:00, 19.34it/s]
2025-03-09 09:35:50,109 [INFO]: 	>>> Finished "Compute fast metrics" in 13.4115 secs
2025-03-09 09:35:50,110 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 52.2856 secs
2025-03-09 09:35:50,110 [INFO]: {
2025-03-09 09:35:50,110 [INFO]: 	index_key: HNSW15
2025-03-09 09:35:50,110 [INFO]: 	index_param: efSearch=207
2025-03-09 09:35:50,110 [INFO]: 	index_path: knn.index
2025-03-09 09:35:50,110 [INFO]: 	size in bytes: 631744330
2025-03-09 09:35:50,110 [INFO]: 	avg_search_speed_ms: 11.42285957445548
2025-03-09 09:35:50,111 [INFO]: 	99p_search_speed_ms: 16.996726510114968
2025-03-09 09:35:50,111 [INFO]: 	reconstruction error %: 0.0
2025-03-09 09:35:50,111 [INFO]: 	nb vectors: 3211
2025-03-09 09:35:50,111 [INFO]: 	vectors dimension: 49152
2025-03-09 09:35:50,111 [INFO]: 	compression ratio: 0.9993097809045631
2025-03-09 09:35:50,111 [INFO]: }
2025-03-09 09:35:50,111 [INFO]: 	>>> Finished "Creating the index" in 52.2870 secs
2025-03-09 09:35:50,111 [INFO]: >>> Finished "Launching the whole pipeline" in 52.3147 secs
2025-03-09 09:35:50: [retrieval_preprocessing] calculating distances ...
2025-03-09 09:35:51: [retrieval_preprocessing] finished and saved retrieval indices for episode 66664 [episode count 14/20]
[retrieval_preprocessing] for episode 58989 [episode count 15/20], we have num_retrieval=np.int64(3184) num_query=np.int64(205)
2025-03-09 09:35:51,680 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-09 09:35:52,301 [INFO]: Launching the whole pipeline 03/09/2025, 09:35:52
2025-03-09 09:35:52,301 [INFO]: Reading total number of vectors and dimension 03/09/2025, 09:35:52
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1573.85it/s]
2025-03-09 09:35:52,331 [INFO]: There are 3184 embeddings of dim 49152
2025-03-09 09:35:52,332 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0305 secs
2025-03-09 09:35:52,332 [INFO]: 	Compute estimated construction time of the index 03/09/2025, 09:35:52
2025-03-09 09:35:52,332 [INFO]: 		-> Train: 16.7 minutes
2025-03-09 09:35:52,332 [INFO]: 		-> Add: 1.7 seconds
2025-03-09 09:35:52,332 [INFO]: 		Total: 16.7 minutes
2025-03-09 09:35:52,333 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0003 secs
2025-03-09 09:35:52,333 [INFO]: 	Checking that your have enough memory available to create the index 03/09/2025, 09:35:52
2025-03-09 09:35:52,333 [INFO]: 657.1MB of memory will be needed to build the index (more might be used if you have more)
2025-03-09 09:35:52,333 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0004 secs
2025-03-09 09:35:52,333 [INFO]: 	Selecting most promising index types given data characteristics 03/09/2025, 09:35:52
2025-03-09 09:35:52,333 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-09 09:35:52,333 [INFO]: 	Creating the index 03/09/2025, 09:35:52
2025-03-09 09:35:52,334 [INFO]: 		-> Instanciate the index HNSW15 03/09/2025, 09:35:52
2025-03-09 09:35:52,336 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0020 secs
2025-03-09 09:35:52,336 [INFO]: 		-> Adding the vectors to the index 03/09/2025, 09:35:52
2025-03-09 09:35:52,336 [INFO]: The memory available for adding the vectors is 49.4GB(total available - used by the index)
2025-03-09 09:35:52,336 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/13 [00:00<?, ?it/s] 15%|█▌        | 2/13 [00:00<00:00, 16.52it/s] 46%|████▌     | 6/13 [00:00<00:00, 28.20it/s] 85%|████████▍ | 11/13 [00:00<00:00, 34.59it/s]100%|██████████| 13/13 [00:03<00:00,  4.07it/s]
2025-03-09 09:35:55,535 [INFO]: 	Computing best hyperparameters for index knn.index 03/09/2025, 09:35:55
2025-03-09 09:36:27,991 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 32.4559 secs
2025-03-09 09:36:27,991 [INFO]: The best hyperparameters are: efSearch=94
2025-03-09 09:36:27,991 [INFO]: 	Compute fast metrics 03/09/2025, 09:36:27
  0%|          | 0/4 [00:00<?, ?it/s] 25%|██▌       | 1/4 [00:00<00:00,  6.80it/s] 75%|███████▌  | 3/4 [00:00<00:00, 12.40it/s] 75%|███████▌  | 3/4 [00:00<00:00, 10.54it/s]
2025-03-09 09:36:42,052 [INFO]: 	>>> Finished "Compute fast metrics" in 14.0605 secs
2025-03-09 09:36:42,054 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 49.7179 secs
2025-03-09 09:36:42,054 [INFO]: {
2025-03-09 09:36:42,054 [INFO]: 	index_key: HNSW15
2025-03-09 09:36:42,054 [INFO]: 	index_param: efSearch=94
2025-03-09 09:36:42,054 [INFO]: 	index_path: knn.index
2025-03-09 09:36:42,054 [INFO]: 	size in bytes: 626432290
2025-03-09 09:36:42,054 [INFO]: 	avg_search_speed_ms: 6.481698297877987
2025-03-09 09:36:42,054 [INFO]: 	99p_search_speed_ms: 15.18106434494257
2025-03-09 09:36:42,054 [INFO]: 	reconstruction error %: 0.0
2025-03-09 09:36:42,054 [INFO]: 	nb vectors: 3184
2025-03-09 09:36:42,054 [INFO]: 	vectors dimension: 49152
2025-03-09 09:36:42,054 [INFO]: 	compression ratio: 0.9993097131056256
2025-03-09 09:36:42,054 [INFO]: }
2025-03-09 09:36:42,054 [INFO]: 	>>> Finished "Creating the index" in 49.7207 secs
2025-03-09 09:36:42,054 [INFO]: >>> Finished "Launching the whole pipeline" in 49.7528 secs
2025-03-09 09:36:42: [retrieval_preprocessing] calculating distances ...
2025-03-09 09:36:42: [retrieval_preprocessing] finished and saved retrieval indices for episode 58989 [episode count 15/20]
[retrieval_preprocessing] for episode 6259 [episode count 16/20], we have num_retrieval=np.int64(3277) num_query=np.int64(112)
2025-03-09 09:36:43,256 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-09 09:36:43,695 [INFO]: Launching the whole pipeline 03/09/2025, 09:36:43
2025-03-09 09:36:43,695 [INFO]: Reading total number of vectors and dimension 03/09/2025, 09:36:43
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1153.87it/s]
2025-03-09 09:36:43,724 [INFO]: There are 3277 embeddings of dim 49152
2025-03-09 09:36:43,724 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0294 secs
2025-03-09 09:36:43,724 [INFO]: 	Compute estimated construction time of the index 03/09/2025, 09:36:43
2025-03-09 09:36:43,724 [INFO]: 		-> Train: 16.7 minutes
2025-03-09 09:36:43,724 [INFO]: 		-> Add: 1.8 seconds
2025-03-09 09:36:43,724 [INFO]: 		Total: 16.7 minutes
2025-03-09 09:36:43,724 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0001 secs
2025-03-09 09:36:43,724 [INFO]: 	Checking that your have enough memory available to create the index 03/09/2025, 09:36:43
2025-03-09 09:36:43,725 [INFO]: 676.3MB of memory will be needed to build the index (more might be used if you have more)
2025-03-09 09:36:43,725 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0002 secs
2025-03-09 09:36:43,725 [INFO]: 	Selecting most promising index types given data characteristics 03/09/2025, 09:36:43
2025-03-09 09:36:43,725 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-09 09:36:43,725 [INFO]: 	Creating the index 03/09/2025, 09:36:43
2025-03-09 09:36:43,725 [INFO]: 		-> Instanciate the index HNSW15 03/09/2025, 09:36:43
2025-03-09 09:36:43,726 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0010 secs
2025-03-09 09:36:43,726 [INFO]: 		-> Adding the vectors to the index 03/09/2025, 09:36:43
2025-03-09 09:36:43,726 [INFO]: The memory available for adding the vectors is 49.4GB(total available - used by the index)
2025-03-09 09:36:43,726 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/13 [00:00<?, ?it/s]  8%|▊         | 1/13 [00:00<00:01,  8.10it/s] 54%|█████▍    | 7/13 [00:00<00:00, 33.29it/s]100%|██████████| 13/13 [00:03<00:00,  3.59it/s]100%|██████████| 13/13 [00:03<00:00,  4.22it/s]
2025-03-09 09:36:46,809 [INFO]: 	Computing best hyperparameters for index knn.index 03/09/2025, 09:36:46
2025-03-09 09:37:25,398 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 38.5884 secs
2025-03-09 09:37:25,398 [INFO]: The best hyperparameters are: efSearch=172
2025-03-09 09:37:25,398 [INFO]: 	Compute fast metrics 03/09/2025, 09:37:25
  0%|          | 0/4 [00:00<?, ?it/s] 50%|█████     | 2/4 [00:00<00:00, 19.35it/s] 75%|███████▌  | 3/4 [00:00<00:00, 21.11it/s]
2025-03-09 09:37:42,036 [INFO]: 	>>> Finished "Compute fast metrics" in 16.6379 secs
2025-03-09 09:37:42,038 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 58.3121 secs
2025-03-09 09:37:42,038 [INFO]: {
2025-03-09 09:37:42,038 [INFO]: 	index_key: HNSW15
2025-03-09 09:37:42,038 [INFO]: 	index_param: efSearch=172
2025-03-09 09:37:42,038 [INFO]: 	index_path: knn.index
2025-03-09 09:37:42,038 [INFO]: 	size in bytes: 644729890
2025-03-09 09:37:42,038 [INFO]: 	avg_search_speed_ms: 10.878316072293105
2025-03-09 09:37:42,038 [INFO]: 	99p_search_speed_ms: 24.875404979102285
2025-03-09 09:37:42,038 [INFO]: 	reconstruction error %: 0.0
2025-03-09 09:37:42,038 [INFO]: 	nb vectors: 3277
2025-03-09 09:37:42,038 [INFO]: 	vectors dimension: 49152
2025-03-09 09:37:42,038 [INFO]: 	compression ratio: 0.9993090532843142
2025-03-09 09:37:42,038 [INFO]: }
2025-03-09 09:37:42,038 [INFO]: 	>>> Finished "Creating the index" in 58.3137 secs
2025-03-09 09:37:42,038 [INFO]: >>> Finished "Launching the whole pipeline" in 58.3438 secs
2025-03-09 09:37:42: [retrieval_preprocessing] calculating distances ...
2025-03-09 09:37:43: [retrieval_preprocessing] finished and saved retrieval indices for episode 6259 [episode count 16/20]
[retrieval_preprocessing] for episode 82549 [episode count 17/20], we have num_retrieval=np.int64(3243) num_query=np.int64(146)
2025-03-09 09:37:43,265 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-09 09:37:43,846 [INFO]: Launching the whole pipeline 03/09/2025, 09:37:43
2025-03-09 09:37:43,846 [INFO]: Reading total number of vectors and dimension 03/09/2025, 09:37:43
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1411.75it/s]
2025-03-09 09:37:43,876 [INFO]: There are 3243 embeddings of dim 49152
2025-03-09 09:37:43,876 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0298 secs
2025-03-09 09:37:43,876 [INFO]: 	Compute estimated construction time of the index 03/09/2025, 09:37:43
2025-03-09 09:37:43,876 [INFO]: 		-> Train: 16.7 minutes
2025-03-09 09:37:43,876 [INFO]: 		-> Add: 1.8 seconds
2025-03-09 09:37:43,876 [INFO]: 		Total: 16.7 minutes
2025-03-09 09:37:43,876 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0001 secs
2025-03-09 09:37:43,876 [INFO]: 	Checking that your have enough memory available to create the index 03/09/2025, 09:37:43
2025-03-09 09:37:43,877 [INFO]: 669.3MB of memory will be needed to build the index (more might be used if you have more)
2025-03-09 09:37:43,877 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0006 secs
2025-03-09 09:37:43,877 [INFO]: 	Selecting most promising index types given data characteristics 03/09/2025, 09:37:43
2025-03-09 09:37:43,877 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-09 09:37:43,877 [INFO]: 	Creating the index 03/09/2025, 09:37:43
2025-03-09 09:37:43,877 [INFO]: 		-> Instanciate the index HNSW15 03/09/2025, 09:37:43
2025-03-09 09:37:43,878 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0010 secs
2025-03-09 09:37:43,878 [INFO]: 		-> Adding the vectors to the index 03/09/2025, 09:37:43
2025-03-09 09:37:43,878 [INFO]: The memory available for adding the vectors is 49.4GB(total available - used by the index)
2025-03-09 09:37:43,878 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/13 [00:00<?, ?it/s] 15%|█▌        | 2/13 [00:00<00:00, 17.90it/s] 62%|██████▏   | 8/13 [00:00<00:00, 37.61it/s]100%|██████████| 13/13 [00:03<00:00,  3.49it/s]100%|██████████| 13/13 [00:03<00:00,  4.31it/s]
2025-03-09 09:37:46,895 [INFO]: 	Computing best hyperparameters for index knn.index 03/09/2025, 09:37:46
2025-03-09 09:38:22,833 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 35.9367 secs
2025-03-09 09:38:22,833 [INFO]: The best hyperparameters are: efSearch=170
2025-03-09 09:38:22,833 [INFO]: 	Compute fast metrics 03/09/2025, 09:38:22
  0%|          | 0/4 [00:00<?, ?it/s] 75%|███████▌  | 3/4 [00:00<00:00, 25.42it/s] 75%|███████▌  | 3/4 [00:00<00:00, 21.94it/s]
2025-03-09 09:38:40,718 [INFO]: 	>>> Finished "Compute fast metrics" in 17.8849 secs
2025-03-09 09:38:40,720 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 56.8412 secs
2025-03-09 09:38:40,720 [INFO]: {
2025-03-09 09:38:40,720 [INFO]: 	index_key: HNSW15
2025-03-09 09:38:40,720 [INFO]: 	index_param: efSearch=170
2025-03-09 09:38:40,720 [INFO]: 	index_path: knn.index
2025-03-09 09:38:40,720 [INFO]: 	size in bytes: 638040490
2025-03-09 09:38:40,720 [INFO]: 	avg_search_speed_ms: 9.651899413730677
2025-03-09 09:38:40,720 [INFO]: 	99p_search_speed_ms: 19.792892935220262
2025-03-09 09:38:40,720 [INFO]: 	reconstruction error %: 0.0
2025-03-09 09:38:40,720 [INFO]: 	nb vectors: 3243
2025-03-09 09:38:40,720 [INFO]: 	vectors dimension: 49152
2025-03-09 09:38:40,720 [INFO]: 	compression ratio: 0.9993092193882555
2025-03-09 09:38:40,720 [INFO]: }
2025-03-09 09:38:40,720 [INFO]: 	>>> Finished "Creating the index" in 56.8426 secs
2025-03-09 09:38:40,720 [INFO]: >>> Finished "Launching the whole pipeline" in 56.8735 secs
2025-03-09 09:38:41: [retrieval_preprocessing] calculating distances ...
2025-03-09 09:38:41: [retrieval_preprocessing] finished and saved retrieval indices for episode 82549 [episode count 17/20]
[retrieval_preprocessing] for episode 71804 [episode count 18/20], we have num_retrieval=np.int64(3219) num_query=np.int64(170)
2025-03-09 09:38:42,225 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-09 09:38:42,773 [INFO]: Launching the whole pipeline 03/09/2025, 09:38:42
2025-03-09 09:38:42,773 [INFO]: Reading total number of vectors and dimension 03/09/2025, 09:38:42
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 2147.62it/s]
2025-03-09 09:38:42,804 [INFO]: There are 3219 embeddings of dim 49152
2025-03-09 09:38:42,804 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0311 secs
2025-03-09 09:38:42,804 [INFO]: 	Compute estimated construction time of the index 03/09/2025, 09:38:42
2025-03-09 09:38:42,804 [INFO]: 		-> Train: 16.7 minutes
2025-03-09 09:38:42,804 [INFO]: 		-> Add: 1.8 seconds
2025-03-09 09:38:42,804 [INFO]: 		Total: 16.7 minutes
2025-03-09 09:38:42,805 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0006 secs
2025-03-09 09:38:42,805 [INFO]: 	Checking that your have enough memory available to create the index 03/09/2025, 09:38:42
2025-03-09 09:38:42,805 [INFO]: 664.3MB of memory will be needed to build the index (more might be used if you have more)
2025-03-09 09:38:42,805 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0002 secs
2025-03-09 09:38:42,805 [INFO]: 	Selecting most promising index types given data characteristics 03/09/2025, 09:38:42
2025-03-09 09:38:42,805 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-09 09:38:42,805 [INFO]: 	Creating the index 03/09/2025, 09:38:42
2025-03-09 09:38:42,805 [INFO]: 		-> Instanciate the index HNSW15 03/09/2025, 09:38:42
2025-03-09 09:38:42,807 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0014 secs
2025-03-09 09:38:42,807 [INFO]: 		-> Adding the vectors to the index 03/09/2025, 09:38:42
2025-03-09 09:38:42,807 [INFO]: The memory available for adding the vectors is 49.4GB(total available - used by the index)
2025-03-09 09:38:42,807 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/13 [00:00<?, ?it/s] 23%|██▎       | 3/13 [00:00<00:00, 25.38it/s] 69%|██████▉   | 9/13 [00:00<00:00, 40.05it/s]100%|██████████| 13/13 [00:02<00:00,  3.81it/s]100%|██████████| 13/13 [00:02<00:00,  4.93it/s]
2025-03-09 09:38:45,450 [INFO]: 	Computing best hyperparameters for index knn.index 03/09/2025, 09:38:45
2025-03-09 09:39:17,184 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 31.7331 secs
2025-03-09 09:39:17,184 [INFO]: The best hyperparameters are: efSearch=216
2025-03-09 09:39:17,184 [INFO]: 	Compute fast metrics 03/09/2025, 09:39:17
  0%|          | 0/4 [00:00<?, ?it/s] 50%|█████     | 2/4 [00:00<00:00, 18.25it/s] 75%|███████▌  | 3/4 [00:00<00:00, 18.39it/s]
2025-03-09 09:39:35,105 [INFO]: 	>>> Finished "Compute fast metrics" in 17.9206 secs
2025-03-09 09:39:35,106 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 52.2994 secs
2025-03-09 09:39:35,107 [INFO]: {
2025-03-09 09:39:35,107 [INFO]: 	index_key: HNSW15
2025-03-09 09:39:35,107 [INFO]: 	index_param: efSearch=216
2025-03-09 09:39:35,107 [INFO]: 	index_path: knn.index
2025-03-09 09:39:35,107 [INFO]: 	size in bytes: 633318310
2025-03-09 09:39:35,107 [INFO]: 	avg_search_speed_ms: 10.855544133245314
2025-03-09 09:39:35,107 [INFO]: 	99p_search_speed_ms: 17.538921581581185
2025-03-09 09:39:35,107 [INFO]: 	reconstruction error %: 0.0
2025-03-09 09:39:35,107 [INFO]: 	nb vectors: 3219
2025-03-09 09:39:35,107 [INFO]: 	vectors dimension: 49152
2025-03-09 09:39:35,107 [INFO]: 	compression ratio: 0.9993097341524833
2025-03-09 09:39:35,107 [INFO]: }
2025-03-09 09:39:35,107 [INFO]: 	>>> Finished "Creating the index" in 52.3015 secs
2025-03-09 09:39:35,107 [INFO]: >>> Finished "Launching the whole pipeline" in 52.3338 secs
2025-03-09 09:39:36: [retrieval_preprocessing] calculating distances ...
2025-03-09 09:39:36: [retrieval_preprocessing] finished and saved retrieval indices for episode 71804 [episode count 18/20]
[retrieval_preprocessing] for episode 63613 [episode count 19/20], we have num_retrieval=np.int64(3269) num_query=np.int64(120)
2025-03-09 09:39:38,430 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-09 09:39:38,947 [INFO]: Launching the whole pipeline 03/09/2025, 09:39:38
2025-03-09 09:39:38,947 [INFO]: Reading total number of vectors and dimension 03/09/2025, 09:39:38
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1016.80it/s]
2025-03-09 09:39:39,002 [INFO]: There are 3269 embeddings of dim 49152
2025-03-09 09:39:39,003 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0554 secs
2025-03-09 09:39:39,003 [INFO]: 	Compute estimated construction time of the index 03/09/2025, 09:39:39
2025-03-09 09:39:39,004 [INFO]: 		-> Train: 16.7 minutes
2025-03-09 09:39:39,004 [INFO]: 		-> Add: 1.8 seconds
2025-03-09 09:39:39,004 [INFO]: 		Total: 16.7 minutes
2025-03-09 09:39:39,004 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0004 secs
2025-03-09 09:39:39,004 [INFO]: 	Checking that your have enough memory available to create the index 03/09/2025, 09:39:39
2025-03-09 09:39:39,004 [INFO]: 674.6MB of memory will be needed to build the index (more might be used if you have more)
2025-03-09 09:39:39,004 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0004 secs
2025-03-09 09:39:39,005 [INFO]: 	Selecting most promising index types given data characteristics 03/09/2025, 09:39:39
2025-03-09 09:39:39,005 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-09 09:39:39,005 [INFO]: 	Creating the index 03/09/2025, 09:39:39
2025-03-09 09:39:39,005 [INFO]: 		-> Instanciate the index HNSW15 03/09/2025, 09:39:39
2025-03-09 09:39:39,007 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0024 secs
2025-03-09 09:39:39,008 [INFO]: 		-> Adding the vectors to the index 03/09/2025, 09:39:39
2025-03-09 09:39:39,008 [INFO]: The memory available for adding the vectors is 49.4GB(total available - used by the index)
2025-03-09 09:39:39,008 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/13 [00:00<?, ?it/s]  8%|▊         | 1/13 [00:00<00:01,  8.88it/s] 46%|████▌     | 6/13 [00:00<00:00, 29.62it/s] 85%|████████▍ | 11/13 [00:00<00:00, 36.62it/s]100%|██████████| 13/13 [00:03<00:00,  4.27it/s]
2025-03-09 09:39:42,057 [INFO]: 	Computing best hyperparameters for index knn.index 03/09/2025, 09:39:42
2025-03-09 09:40:12,715 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 30.6579 secs
2025-03-09 09:40:12,716 [INFO]: The best hyperparameters are: efSearch=187
2025-03-09 09:40:12,716 [INFO]: 	Compute fast metrics 03/09/2025, 09:40:12
  0%|          | 0/4 [00:00<?, ?it/s] 50%|█████     | 2/4 [00:00<00:00, 19.09it/s] 75%|███████▌  | 3/4 [00:00<00:00, 21.33it/s]
2025-03-09 09:40:29,850 [INFO]: 	>>> Finished "Compute fast metrics" in 17.1344 secs
2025-03-09 09:40:29,852 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 50.8440 secs
2025-03-09 09:40:29,852 [INFO]: {
2025-03-09 09:40:29,852 [INFO]: 	index_key: HNSW15
2025-03-09 09:40:29,852 [INFO]: 	index_param: efSearch=187
2025-03-09 09:40:29,852 [INFO]: 	index_path: knn.index
2025-03-09 09:40:29,852 [INFO]: 	size in bytes: 643155970
2025-03-09 09:40:29,852 [INFO]: 	avg_search_speed_ms: 10.507250871380181
2025-03-09 09:40:29,852 [INFO]: 	99p_search_speed_ms: 22.2413590992801
2025-03-09 09:40:29,852 [INFO]: 	reconstruction error %: 0.0
2025-03-09 09:40:29,852 [INFO]: 	nb vectors: 3269
2025-03-09 09:40:29,852 [INFO]: 	vectors dimension: 49152
2025-03-09 09:40:29,852 [INFO]: 	compression ratio: 0.9993090043150809
2025-03-09 09:40:29,852 [INFO]: }
2025-03-09 09:40:29,852 [INFO]: 	>>> Finished "Creating the index" in 50.8475 secs
2025-03-09 09:40:29,852 [INFO]: >>> Finished "Launching the whole pipeline" in 50.9049 secs
2025-03-09 09:40:30: [retrieval_preprocessing] calculating distances ...
2025-03-09 09:40:30: [retrieval_preprocessing] finished and saved retrieval indices for episode 63613 [episode count 19/20]
2025-03-09 09:40:30: [retrieval_preprocessing] finished for (4706041793, 'cloth') [chosen_id count 8/10]
2025-03-09 09:40:33: [retrieval_preprocessing] concatenated all embeddings and indices for 20 episodes for (2370783071, 'block') [chosen_id count 9/10]
2025-03-09 09:40:33: [retrieval_preprocessing] we have num_total=8990 embedding_dim=49152
[retrieval_preprocessing] for episode 2944 [episode count 0/20], we have num_retrieval=np.int64(8703) num_query=np.int64(287)
2025-03-09 09:40:34,686 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-09 09:40:35,853 [INFO]: Launching the whole pipeline 03/09/2025, 09:40:35
2025-03-09 09:40:35,853 [INFO]: Reading total number of vectors and dimension 03/09/2025, 09:40:35
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 2299.51it/s]
2025-03-09 09:40:35,884 [INFO]: There are 8703 embeddings of dim 49152
2025-03-09 09:40:35,884 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0313 secs
2025-03-09 09:40:35,884 [INFO]: 	Compute estimated construction time of the index 03/09/2025, 09:40:35
2025-03-09 09:40:35,884 [INFO]: 		-> Train: 16.7 minutes
2025-03-09 09:40:35,884 [INFO]: 		-> Add: 4.8 seconds
2025-03-09 09:40:35,884 [INFO]: 		Total: 16.7 minutes
2025-03-09 09:40:35,884 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0001 secs
2025-03-09 09:40:35,884 [INFO]: 	Checking that your have enough memory available to create the index 03/09/2025, 09:40:35
2025-03-09 09:40:35,885 [INFO]: 1.8GB of memory will be needed to build the index (more might be used if you have more)
2025-03-09 09:40:35,885 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0001 secs
2025-03-09 09:40:35,885 [INFO]: 	Selecting most promising index types given data characteristics 03/09/2025, 09:40:35
2025-03-09 09:40:35,885 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-09 09:40:35,885 [INFO]: 	Creating the index 03/09/2025, 09:40:35
2025-03-09 09:40:35,885 [INFO]: 		-> Instanciate the index HNSW15 03/09/2025, 09:40:35
2025-03-09 09:40:35,886 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0009 secs
2025-03-09 09:40:35,886 [INFO]: 		-> Adding the vectors to the index 03/09/2025, 09:40:35
2025-03-09 09:40:35,886 [INFO]: The memory available for adding the vectors is 48.4GB(total available - used by the index)
2025-03-09 09:40:35,886 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/36 [00:00<?, ?it/s]  3%|▎         | 1/36 [00:00<00:06,  5.57it/s] 17%|█▋        | 6/36 [00:00<00:01, 24.59it/s] 33%|███▎      | 12/36 [00:00<00:00, 35.66it/s] 50%|█████     | 18/36 [00:00<00:00, 41.21it/s] 64%|██████▍   | 23/36 [00:04<00:04,  3.15it/s] 81%|████████  | 29/36 [00:04<00:01,  4.88it/s] 94%|█████████▍| 34/36 [00:04<00:00,  6.78it/s]100%|██████████| 36/36 [00:07<00:00,  4.55it/s]
2025-03-09 09:40:43,795 [INFO]: 	Computing best hyperparameters for index knn.index 03/09/2025, 09:40:43
2025-03-09 09:41:56,515 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 72.7194 secs
2025-03-09 09:41:56,516 [INFO]: The best hyperparameters are: efSearch=164
2025-03-09 09:41:56,516 [INFO]: 	Compute fast metrics 03/09/2025, 09:41:56
  0%|          | 0/4 [00:00<?, ?it/s] 50%|█████     | 2/4 [00:00<00:00, 17.44it/s] 75%|███████▌  | 3/4 [00:00<00:00, 18.70it/s]
2025-03-09 09:42:20,019 [INFO]: 	>>> Finished "Compute fast metrics" in 23.5028 secs
2025-03-09 09:42:20,021 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 104.1349 secs
2025-03-09 09:42:20,021 [INFO]: {
2025-03-09 09:42:20,021 [INFO]: 	index_key: HNSW15
2025-03-09 09:42:20,021 [INFO]: 	index_param: efSearch=164
2025-03-09 09:42:20,021 [INFO]: 	index_path: knn.index
2025-03-09 09:42:20,021 [INFO]: 	size in bytes: 1712263570
2025-03-09 09:42:20,021 [INFO]: 	avg_search_speed_ms: 9.296447848364517
2025-03-09 09:42:20,021 [INFO]: 	99p_search_speed_ms: 19.223044102545828
2025-03-09 09:42:20,021 [INFO]: 	reconstruction error %: 0.0
2025-03-09 09:42:20,021 [INFO]: 	nb vectors: 8703
2025-03-09 09:42:20,021 [INFO]: 	vectors dimension: 49152
2025-03-09 09:42:20,021 [INFO]: 	compression ratio: 0.9993084324044809
2025-03-09 09:42:20,021 [INFO]: }
2025-03-09 09:42:20,021 [INFO]: 	>>> Finished "Creating the index" in 104.1363 secs
2025-03-09 09:42:20,021 [INFO]: >>> Finished "Launching the whole pipeline" in 104.1681 secs
2025-03-09 09:42:20: [retrieval_preprocessing] calculating distances ...
2025-03-09 09:42:21: [retrieval_preprocessing] finished and saved retrieval indices for episode 2944 [episode count 0/20]
[retrieval_preprocessing] for episode 1670 [episode count 1/20], we have num_retrieval=np.int64(8519) num_query=np.int64(471)
2025-03-09 09:42:22,614 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-09 09:42:23,940 [INFO]: Launching the whole pipeline 03/09/2025, 09:42:23
2025-03-09 09:42:23,940 [INFO]: Reading total number of vectors and dimension 03/09/2025, 09:42:23
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1637.12it/s]
2025-03-09 09:42:23,974 [INFO]: There are 8519 embeddings of dim 49152
2025-03-09 09:42:23,974 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0342 secs
2025-03-09 09:42:23,974 [INFO]: 	Compute estimated construction time of the index 03/09/2025, 09:42:23
2025-03-09 09:42:23,974 [INFO]: 		-> Train: 16.7 minutes
2025-03-09 09:42:23,974 [INFO]: 		-> Add: 4.7 seconds
2025-03-09 09:42:23,974 [INFO]: 		Total: 16.7 minutes
2025-03-09 09:42:23,974 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0001 secs
2025-03-09 09:42:23,974 [INFO]: 	Checking that your have enough memory available to create the index 03/09/2025, 09:42:23
2025-03-09 09:42:23,974 [INFO]: 1.7GB of memory will be needed to build the index (more might be used if you have more)
2025-03-09 09:42:23,974 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0002 secs
2025-03-09 09:42:23,974 [INFO]: 	Selecting most promising index types given data characteristics 03/09/2025, 09:42:23
2025-03-09 09:42:23,974 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-09 09:42:23,974 [INFO]: 	Creating the index 03/09/2025, 09:42:23
2025-03-09 09:42:23,975 [INFO]: 		-> Instanciate the index HNSW15 03/09/2025, 09:42:23
2025-03-09 09:42:23,976 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0009 secs
2025-03-09 09:42:23,976 [INFO]: 		-> Adding the vectors to the index 03/09/2025, 09:42:23
2025-03-09 09:42:23,976 [INFO]: The memory available for adding the vectors is 48.4GB(total available - used by the index)
2025-03-09 09:42:23,976 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/35 [00:00<?, ?it/s]  3%|▎         | 1/35 [00:00<00:05,  6.02it/s] 17%|█▋        | 6/35 [00:00<00:01, 24.81it/s] 31%|███▏      | 11/35 [00:00<00:00, 34.10it/s] 46%|████▌     | 16/35 [00:00<00:00, 39.50it/s] 60%|██████    | 21/35 [00:03<00:04,  3.49it/s] 77%|███████▋  | 27/35 [00:04<00:01,  5.56it/s] 94%|█████████▍| 33/35 [00:04<00:00,  8.24it/s]100%|██████████| 35/35 [00:07<00:00,  4.76it/s]
2025-03-09 09:42:31,328 [INFO]: 	Computing best hyperparameters for index knn.index 03/09/2025, 09:42:31
2025-03-09 09:43:31,074 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 59.7452 secs
2025-03-09 09:43:31,074 [INFO]: The best hyperparameters are: efSearch=173
2025-03-09 09:43:31,074 [INFO]: 	Compute fast metrics 03/09/2025, 09:43:31
  0%|          | 0/4 [00:00<?, ?it/s] 50%|█████     | 2/4 [00:00<00:00, 19.10it/s] 75%|███████▌  | 3/4 [00:00<00:00, 21.11it/s]
2025-03-09 09:44:10,058 [INFO]: 	>>> Finished "Compute fast metrics" in 38.9841 secs
2025-03-09 09:44:10,061 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 106.0851 secs
2025-03-09 09:44:10,061 [INFO]: {
2025-03-09 09:44:10,061 [INFO]: 	index_key: HNSW15
2025-03-09 09:44:10,061 [INFO]: 	index_param: efSearch=173
2025-03-09 09:44:10,061 [INFO]: 	index_path: knn.index
2025-03-09 09:44:10,061 [INFO]: 	size in bytes: 1676062810
2025-03-09 09:44:10,061 [INFO]: 	avg_search_speed_ms: 8.164717040537875
2025-03-09 09:44:10,061 [INFO]: 	99p_search_speed_ms: 17.559121269732714
2025-03-09 09:44:10,061 [INFO]: 	reconstruction error %: 0.0
2025-03-09 09:44:10,061 [INFO]: 	nb vectors: 8519
2025-03-09 09:44:10,061 [INFO]: 	vectors dimension: 49152
2025-03-09 09:44:10,061 [INFO]: 	compression ratio: 0.9993083445363243
2025-03-09 09:44:10,061 [INFO]: }
2025-03-09 09:44:10,061 [INFO]: 	>>> Finished "Creating the index" in 106.0868 secs
2025-03-09 09:44:10,061 [INFO]: >>> Finished "Launching the whole pipeline" in 106.1216 secs
2025-03-09 09:44:12: [retrieval_preprocessing] calculating distances ...
2025-03-09 09:44:14: [retrieval_preprocessing] finished and saved retrieval indices for episode 1670 [episode count 1/20]
[retrieval_preprocessing] for episode 79501 [episode count 2/20], we have num_retrieval=np.int64(8499) num_query=np.int64(491)
2025-03-09 09:44:15,420 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-09 09:44:16,805 [INFO]: Launching the whole pipeline 03/09/2025, 09:44:16
2025-03-09 09:44:16,805 [INFO]: Reading total number of vectors and dimension 03/09/2025, 09:44:16
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1143.80it/s]
2025-03-09 09:44:16,839 [INFO]: There are 8499 embeddings of dim 49152
2025-03-09 09:44:16,840 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0343 secs
2025-03-09 09:44:16,840 [INFO]: 	Compute estimated construction time of the index 03/09/2025, 09:44:16
2025-03-09 09:44:16,840 [INFO]: 		-> Train: 16.7 minutes
2025-03-09 09:44:16,840 [INFO]: 		-> Add: 4.7 seconds
2025-03-09 09:44:16,840 [INFO]: 		Total: 16.7 minutes
2025-03-09 09:44:16,840 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0001 secs
2025-03-09 09:44:16,840 [INFO]: 	Checking that your have enough memory available to create the index 03/09/2025, 09:44:16
2025-03-09 09:44:16,840 [INFO]: 1.7GB of memory will be needed to build the index (more might be used if you have more)
2025-03-09 09:44:16,840 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0002 secs
2025-03-09 09:44:16,840 [INFO]: 	Selecting most promising index types given data characteristics 03/09/2025, 09:44:16
2025-03-09 09:44:16,840 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-09 09:44:16,840 [INFO]: 	Creating the index 03/09/2025, 09:44:16
2025-03-09 09:44:16,840 [INFO]: 		-> Instanciate the index HNSW15 03/09/2025, 09:44:16
2025-03-09 09:44:16,841 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0009 secs
2025-03-09 09:44:16,841 [INFO]: 		-> Adding the vectors to the index 03/09/2025, 09:44:16
2025-03-09 09:44:16,841 [INFO]: The memory available for adding the vectors is 48.4GB(total available - used by the index)
2025-03-09 09:44:16,841 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/35 [00:00<?, ?it/s]  3%|▎         | 1/35 [00:00<00:05,  6.74it/s] 20%|██        | 7/35 [00:00<00:00, 31.68it/s] 37%|███▋      | 13/35 [00:00<00:00, 43.00it/s] 54%|█████▍    | 19/35 [00:00<00:00, 49.05it/s] 71%|███████▏  | 25/35 [00:03<00:02,  4.33it/s] 89%|████████▊ | 31/35 [00:03<00:00,  6.45it/s]100%|██████████| 35/35 [00:07<00:00,  4.99it/s]
2025-03-09 09:44:23,862 [INFO]: 	Computing best hyperparameters for index knn.index 03/09/2025, 09:44:23
2025-03-09 09:45:21,123 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 57.2613 secs
2025-03-09 09:45:21,124 [INFO]: The best hyperparameters are: efSearch=192
2025-03-09 09:45:21,124 [INFO]: 	Compute fast metrics 03/09/2025, 09:45:21
  0%|          | 0/4 [00:00<?, ?it/s] 50%|█████     | 2/4 [00:00<00:00, 18.62it/s] 75%|███████▌  | 3/4 [00:00<00:00, 20.47it/s]
2025-03-09 09:45:42,686 [INFO]: 	>>> Finished "Compute fast metrics" in 21.5618 secs
2025-03-09 09:45:42,688 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 85.8467 secs
2025-03-09 09:45:42,688 [INFO]: {
2025-03-09 09:45:42,688 [INFO]: 	index_key: HNSW15
2025-03-09 09:45:42,688 [INFO]: 	index_param: efSearch=192
2025-03-09 09:45:42,688 [INFO]: 	index_path: knn.index
2025-03-09 09:45:42,688 [INFO]: 	size in bytes: 1672127950
2025-03-09 09:45:42,688 [INFO]: 	avg_search_speed_ms: 9.472404146932108
2025-03-09 09:45:42,688 [INFO]: 	99p_search_speed_ms: 18.728086154442288
2025-03-09 09:45:42,688 [INFO]: 	reconstruction error %: 0.0
2025-03-09 09:45:42,688 [INFO]: 	nb vectors: 8499
2025-03-09 09:45:42,688 [INFO]: 	vectors dimension: 49152
2025-03-09 09:45:42,688 [INFO]: 	compression ratio: 0.9993083316381381
2025-03-09 09:45:42,688 [INFO]: }
2025-03-09 09:45:42,688 [INFO]: 	>>> Finished "Creating the index" in 85.8481 secs
2025-03-09 09:45:42,688 [INFO]: >>> Finished "Launching the whole pipeline" in 85.8829 secs
2025-03-09 09:45:44: [retrieval_preprocessing] calculating distances ...
2025-03-09 09:45:46: [retrieval_preprocessing] finished and saved retrieval indices for episode 79501 [episode count 2/20]
[retrieval_preprocessing] for episode 29966 [episode count 3/20], we have num_retrieval=np.int64(8392) num_query=np.int64(598)
2025-03-09 09:45:47,165 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-09 09:45:48,256 [INFO]: Launching the whole pipeline 03/09/2025, 09:45:48
2025-03-09 09:45:48,256 [INFO]: Reading total number of vectors and dimension 03/09/2025, 09:45:48
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1556.91it/s]
2025-03-09 09:45:48,289 [INFO]: There are 8392 embeddings of dim 49152
2025-03-09 09:45:48,289 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0325 secs
2025-03-09 09:45:48,289 [INFO]: 	Compute estimated construction time of the index 03/09/2025, 09:45:48
2025-03-09 09:45:48,289 [INFO]: 		-> Train: 16.7 minutes
2025-03-09 09:45:48,289 [INFO]: 		-> Add: 4.6 seconds
2025-03-09 09:45:48,289 [INFO]: 		Total: 16.7 minutes
2025-03-09 09:45:48,289 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0001 secs
2025-03-09 09:45:48,289 [INFO]: 	Checking that your have enough memory available to create the index 03/09/2025, 09:45:48
2025-03-09 09:45:48,289 [INFO]: 1.7GB of memory will be needed to build the index (more might be used if you have more)
2025-03-09 09:45:48,289 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0001 secs
2025-03-09 09:45:48,289 [INFO]: 	Selecting most promising index types given data characteristics 03/09/2025, 09:45:48
2025-03-09 09:45:48,289 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-09 09:45:48,289 [INFO]: 	Creating the index 03/09/2025, 09:45:48
2025-03-09 09:45:48,289 [INFO]: 		-> Instanciate the index HNSW15 03/09/2025, 09:45:48
2025-03-09 09:45:48,290 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0008 secs
2025-03-09 09:45:48,290 [INFO]: 		-> Adding the vectors to the index 03/09/2025, 09:45:48
2025-03-09 09:45:48,290 [INFO]: The memory available for adding the vectors is 48.5GB(total available - used by the index)
2025-03-09 09:45:48,290 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/35 [00:00<?, ?it/s]  3%|▎         | 1/35 [00:00<00:03,  9.12it/s] 14%|█▍        | 5/35 [00:00<00:01, 25.84it/s] 29%|██▊       | 10/35 [00:00<00:00, 35.55it/s] 43%|████▎     | 15/35 [00:00<00:00, 39.73it/s] 57%|█████▋    | 20/35 [00:00<00:00, 42.54it/s] 71%|███████▏  | 25/35 [00:04<00:02,  3.39it/s] 91%|█████████▏| 32/35 [00:04<00:00,  5.62it/s]100%|██████████| 35/35 [00:07<00:00,  4.84it/s]
2025-03-09 09:45:55,530 [INFO]: 	Computing best hyperparameters for index knn.index 03/09/2025, 09:45:55
2025-03-09 09:46:54,139 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 58.6083 secs
2025-03-09 09:46:54,139 [INFO]: The best hyperparameters are: efSearch=228
2025-03-09 09:46:54,139 [INFO]: 	Compute fast metrics 03/09/2025, 09:46:54
  0%|          | 0/4 [00:00<?, ?it/s] 50%|█████     | 2/4 [00:00<00:00, 19.11it/s] 75%|███████▌  | 3/4 [00:00<00:00, 21.09it/s]
2025-03-09 09:47:19,883 [INFO]: 	>>> Finished "Compute fast metrics" in 25.7437 secs
2025-03-09 09:47:19,885 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 91.5947 secs
2025-03-09 09:47:19,885 [INFO]: {
2025-03-09 09:47:19,885 [INFO]: 	index_key: HNSW15
2025-03-09 09:47:19,885 [INFO]: 	index_param: efSearch=228
2025-03-09 09:47:19,885 [INFO]: 	index_path: knn.index
2025-03-09 09:47:19,885 [INFO]: 	size in bytes: 1651076290
2025-03-09 09:47:19,885 [INFO]: 	avg_search_speed_ms: 11.58478911502043
2025-03-09 09:47:19,885 [INFO]: 	99p_search_speed_ms: 26.35981372091919
2025-03-09 09:47:19,885 [INFO]: 	reconstruction error %: 0.0
2025-03-09 09:47:19,885 [INFO]: 	nb vectors: 8392
2025-03-09 09:47:19,885 [INFO]: 	vectors dimension: 49152
2025-03-09 09:47:19,885 [INFO]: 	compression ratio: 0.999308357822763
2025-03-09 09:47:19,885 [INFO]: }
2025-03-09 09:47:19,885 [INFO]: 	>>> Finished "Creating the index" in 91.5959 secs
2025-03-09 09:47:19,885 [INFO]: >>> Finished "Launching the whole pipeline" in 91.6290 secs
2025-03-09 09:47:24: [retrieval_preprocessing] calculating distances ...
2025-03-09 09:47:26: [retrieval_preprocessing] finished and saved retrieval indices for episode 29966 [episode count 3/20]
[retrieval_preprocessing] for episode 30608 [episode count 4/20], we have num_retrieval=np.int64(8752) num_query=np.int64(238)
2025-03-09 09:47:27,245 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-09 09:47:28,653 [INFO]: Launching the whole pipeline 03/09/2025, 09:47:28
2025-03-09 09:47:28,653 [INFO]: Reading total number of vectors and dimension 03/09/2025, 09:47:28
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1844.46it/s]
2025-03-09 09:47:28,696 [INFO]: There are 8752 embeddings of dim 49152
2025-03-09 09:47:28,696 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0431 secs
2025-03-09 09:47:28,696 [INFO]: 	Compute estimated construction time of the index 03/09/2025, 09:47:28
2025-03-09 09:47:28,697 [INFO]: 		-> Train: 16.7 minutes
2025-03-09 09:47:28,697 [INFO]: 		-> Add: 4.8 seconds
2025-03-09 09:47:28,697 [INFO]: 		Total: 16.7 minutes
2025-03-09 09:47:28,697 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0005 secs
2025-03-09 09:47:28,697 [INFO]: 	Checking that your have enough memory available to create the index 03/09/2025, 09:47:28
2025-03-09 09:47:28,698 [INFO]: 1.8GB of memory will be needed to build the index (more might be used if you have more)
2025-03-09 09:47:28,698 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0005 secs
2025-03-09 09:47:28,698 [INFO]: 	Selecting most promising index types given data characteristics 03/09/2025, 09:47:28
2025-03-09 09:47:28,698 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-09 09:47:28,698 [INFO]: 	Creating the index 03/09/2025, 09:47:28
2025-03-09 09:47:28,698 [INFO]: 		-> Instanciate the index HNSW15 03/09/2025, 09:47:28
2025-03-09 09:47:28,701 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0027 secs
2025-03-09 09:47:28,702 [INFO]: 		-> Adding the vectors to the index 03/09/2025, 09:47:28
2025-03-09 09:47:28,702 [INFO]: The memory available for adding the vectors is 48.4GB(total available - used by the index)
2025-03-09 09:47:28,702 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/36 [00:00<?, ?it/s]  3%|▎         | 1/36 [00:00<00:05,  6.52it/s] 14%|█▍        | 5/36 [00:00<00:01, 22.42it/s] 25%|██▌       | 9/36 [00:00<00:00, 29.41it/s] 36%|███▌      | 13/36 [00:00<00:00, 33.10it/s] 47%|████▋     | 17/36 [00:00<00:00, 35.24it/s] 58%|█████▊    | 21/36 [00:04<00:05,  2.53it/s] 75%|███████▌  | 27/36 [00:04<00:02,  4.31it/s] 94%|█████████▍| 34/36 [00:05<00:00,  7.06it/s]100%|██████████| 36/36 [00:08<00:00,  4.37it/s]
2025-03-09 09:47:36,956 [INFO]: 	Computing best hyperparameters for index knn.index 03/09/2025, 09:47:36
2025-03-09 09:48:35,723 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 58.7672 secs
2025-03-09 09:48:35,724 [INFO]: The best hyperparameters are: efSearch=175
2025-03-09 09:48:35,724 [INFO]: 	Compute fast metrics 03/09/2025, 09:48:35
  0%|          | 0/4 [00:00<?, ?it/s] 50%|█████     | 2/4 [00:00<00:00, 19.39it/s] 75%|███████▌  | 3/4 [00:00<00:00, 21.28it/s]
2025-03-09 09:49:07,220 [INFO]: 	>>> Finished "Compute fast metrics" in 31.4958 secs
2025-03-09 09:49:07,222 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 98.5200 secs
2025-03-09 09:49:07,222 [INFO]: {
2025-03-09 09:49:07,222 [INFO]: 	index_key: HNSW15
2025-03-09 09:49:07,222 [INFO]: 	index_param: efSearch=175
2025-03-09 09:49:07,222 [INFO]: 	index_path: knn.index
2025-03-09 09:49:07,222 [INFO]: 	size in bytes: 1721903950
2025-03-09 09:49:07,222 [INFO]: 	avg_search_speed_ms: 8.295103973225624
2025-03-09 09:49:07,222 [INFO]: 	99p_search_speed_ms: 14.623421314172457
2025-03-09 09:49:07,222 [INFO]: 	reconstruction error %: 0.0
2025-03-09 09:49:07,222 [INFO]: 	nb vectors: 8752
2025-03-09 09:49:07,222 [INFO]: 	vectors dimension: 49152
2025-03-09 09:49:07,222 [INFO]: 	compression ratio: 0.9993084782690695
2025-03-09 09:49:07,222 [INFO]: }
2025-03-09 09:49:07,222 [INFO]: 	>>> Finished "Creating the index" in 98.5236 secs
2025-03-09 09:49:07,222 [INFO]: >>> Finished "Launching the whole pipeline" in 98.5690 secs
2025-03-09 09:49:08: [retrieval_preprocessing] calculating distances ...
2025-03-09 09:49:09: [retrieval_preprocessing] finished and saved retrieval indices for episode 30608 [episode count 4/20]
[retrieval_preprocessing] for episode 63249 [episode count 5/20], we have num_retrieval=np.int64(8397) num_query=np.int64(593)
2025-03-09 09:49:09,784 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-09 09:49:10,811 [INFO]: Launching the whole pipeline 03/09/2025, 09:49:10
2025-03-09 09:49:10,811 [INFO]: Reading total number of vectors and dimension 03/09/2025, 09:49:10
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1968.23it/s]
2025-03-09 09:49:10,847 [INFO]: There are 8397 embeddings of dim 49152
2025-03-09 09:49:10,847 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0356 secs
2025-03-09 09:49:10,847 [INFO]: 	Compute estimated construction time of the index 03/09/2025, 09:49:10
2025-03-09 09:49:10,847 [INFO]: 		-> Train: 16.7 minutes
2025-03-09 09:49:10,847 [INFO]: 		-> Add: 4.6 seconds
2025-03-09 09:49:10,847 [INFO]: 		Total: 16.7 minutes
2025-03-09 09:49:10,847 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0001 secs
2025-03-09 09:49:10,847 [INFO]: 	Checking that your have enough memory available to create the index 03/09/2025, 09:49:10
2025-03-09 09:49:10,847 [INFO]: 1.7GB of memory will be needed to build the index (more might be used if you have more)
2025-03-09 09:49:10,847 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0002 secs
2025-03-09 09:49:10,847 [INFO]: 	Selecting most promising index types given data characteristics 03/09/2025, 09:49:10
2025-03-09 09:49:10,848 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-09 09:49:10,848 [INFO]: 	Creating the index 03/09/2025, 09:49:10
2025-03-09 09:49:10,848 [INFO]: 		-> Instanciate the index HNSW15 03/09/2025, 09:49:10
2025-03-09 09:49:10,849 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0010 secs
2025-03-09 09:49:10,849 [INFO]: 		-> Adding the vectors to the index 03/09/2025, 09:49:10
2025-03-09 09:49:10,849 [INFO]: The memory available for adding the vectors is 48.5GB(total available - used by the index)
2025-03-09 09:49:10,849 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/35 [00:00<?, ?it/s]  3%|▎         | 1/35 [00:00<00:04,  8.31it/s] 20%|██        | 7/35 [00:00<00:00, 34.86it/s] 37%|███▋      | 13/35 [00:00<00:00, 44.20it/s] 54%|█████▍    | 19/35 [00:00<00:00, 49.01it/s] 69%|██████▊   | 24/35 [00:03<00:02,  4.47it/s] 89%|████████▊ | 31/35 [00:03<00:00,  7.21it/s]100%|██████████| 35/35 [00:06<00:00,  5.65it/s]
2025-03-09 09:49:17,893 [INFO]: 	Computing best hyperparameters for index knn.index 03/09/2025, 09:49:17
2025-03-09 09:50:12,734 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 54.8399 secs
2025-03-09 09:50:12,734 [INFO]: The best hyperparameters are: efSearch=247
2025-03-09 09:50:12,734 [INFO]: 	Compute fast metrics 03/09/2025, 09:50:12
  0%|          | 0/4 [00:00<?, ?it/s] 50%|█████     | 2/4 [00:00<00:00, 19.54it/s] 75%|███████▌  | 3/4 [00:00<00:00, 18.31it/s]
2025-03-09 09:50:41,721 [INFO]: 	>>> Finished "Compute fast metrics" in 28.9867 secs
2025-03-09 09:50:41,726 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 90.8768 secs
2025-03-09 09:50:41,726 [INFO]: {
2025-03-09 09:50:41,726 [INFO]: 	index_key: HNSW15
2025-03-09 09:50:41,726 [INFO]: 	index_param: efSearch=247
2025-03-09 09:50:41,726 [INFO]: 	index_path: knn.index
2025-03-09 09:50:41,726 [INFO]: 	size in bytes: 1652059990
2025-03-09 09:50:41,726 [INFO]: 	avg_search_speed_ms: 12.08460568630357
2025-03-09 09:50:41,726 [INFO]: 	99p_search_speed_ms: 28.39029730996119
2025-03-09 09:50:41,726 [INFO]: 	reconstruction error %: 0.0
2025-03-09 09:50:41,726 [INFO]: 	nb vectors: 8397
2025-03-09 09:50:41,726 [INFO]: 	vectors dimension: 49152
2025-03-09 09:50:41,726 [INFO]: 	compression ratio: 0.9993083701518611
2025-03-09 09:50:41,726 [INFO]: }
2025-03-09 09:50:41,726 [INFO]: 	>>> Finished "Creating the index" in 90.8784 secs
2025-03-09 09:50:41,726 [INFO]: >>> Finished "Launching the whole pipeline" in 90.9146 secs
2025-03-09 09:50:46: [retrieval_preprocessing] calculating distances ...
2025-03-09 09:50:49: [retrieval_preprocessing] finished and saved retrieval indices for episode 63249 [episode count 5/20]
[retrieval_preprocessing] for episode 67089 [episode count 6/20], we have num_retrieval=np.int64(8556) num_query=np.int64(434)
2025-03-09 09:50:50,002 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-09 09:50:51,388 [INFO]: Launching the whole pipeline 03/09/2025, 09:50:51
2025-03-09 09:50:51,388 [INFO]: Reading total number of vectors and dimension 03/09/2025, 09:50:51
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1241.29it/s]
2025-03-09 09:50:51,432 [INFO]: There are 8556 embeddings of dim 49152
2025-03-09 09:50:51,433 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0441 secs
2025-03-09 09:50:51,433 [INFO]: 	Compute estimated construction time of the index 03/09/2025, 09:50:51
2025-03-09 09:50:51,433 [INFO]: 		-> Train: 16.7 minutes
2025-03-09 09:50:51,433 [INFO]: 		-> Add: 4.7 seconds
2025-03-09 09:50:51,433 [INFO]: 		Total: 16.7 minutes
2025-03-09 09:50:51,433 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0001 secs
2025-03-09 09:50:51,433 [INFO]: 	Checking that your have enough memory available to create the index 03/09/2025, 09:50:51
2025-03-09 09:50:51,433 [INFO]: 1.7GB of memory will be needed to build the index (more might be used if you have more)
2025-03-09 09:50:51,433 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0002 secs
2025-03-09 09:50:51,433 [INFO]: 	Selecting most promising index types given data characteristics 03/09/2025, 09:50:51
2025-03-09 09:50:51,433 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-09 09:50:51,433 [INFO]: 	Creating the index 03/09/2025, 09:50:51
2025-03-09 09:50:51,433 [INFO]: 		-> Instanciate the index HNSW15 03/09/2025, 09:50:51
2025-03-09 09:50:51,435 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0012 secs
2025-03-09 09:50:51,435 [INFO]: 		-> Adding the vectors to the index 03/09/2025, 09:50:51
2025-03-09 09:50:51,435 [INFO]: The memory available for adding the vectors is 48.4GB(total available - used by the index)
2025-03-09 09:50:51,435 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/35 [00:00<?, ?it/s]  3%|▎         | 1/35 [00:00<00:04,  8.06it/s] 17%|█▋        | 6/35 [00:00<00:00, 29.70it/s] 34%|███▍      | 12/35 [00:00<00:00, 39.81it/s] 49%|████▊     | 17/35 [00:00<00:00, 40.45it/s] 63%|██████▎   | 22/35 [00:03<00:03,  3.61it/s] 77%|███████▋  | 27/35 [00:04<00:01,  5.31it/s] 97%|█████████▋| 34/35 [00:04<00:00,  8.49it/s]100%|██████████| 35/35 [00:07<00:00,  4.89it/s]
2025-03-09 09:50:58,595 [INFO]: 	Computing best hyperparameters for index knn.index 03/09/2025, 09:50:58
2025-03-09 09:51:58,195 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 59.5992 secs
2025-03-09 09:51:58,195 [INFO]: The best hyperparameters are: efSearch=235
2025-03-09 09:51:58,195 [INFO]: 	Compute fast metrics 03/09/2025, 09:51:58
  0%|          | 0/4 [00:00<?, ?it/s] 50%|█████     | 2/4 [00:00<00:00, 19.23it/s] 75%|███████▌  | 3/4 [00:00<00:00, 21.17it/s]
2025-03-09 09:52:25,719 [INFO]: 	>>> Finished "Compute fast metrics" in 27.5240 secs
2025-03-09 09:52:25,721 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 94.2863 secs
2025-03-09 09:52:25,721 [INFO]: {
2025-03-09 09:52:25,721 [INFO]: 	index_key: HNSW15
2025-03-09 09:52:25,721 [INFO]: 	index_param: efSearch=235
2025-03-09 09:52:25,721 [INFO]: 	index_path: knn.index
2025-03-09 09:52:25,721 [INFO]: 	size in bytes: 1683342310
2025-03-09 09:52:25,721 [INFO]: 	avg_search_speed_ms: 10.846586493672218
2025-03-09 09:52:25,721 [INFO]: 	99p_search_speed_ms: 17.690112898126237
2025-03-09 09:52:25,721 [INFO]: 	reconstruction error %: 0.0
2025-03-09 09:52:25,721 [INFO]: 	nb vectors: 8556
2025-03-09 09:52:25,721 [INFO]: 	vectors dimension: 49152
2025-03-09 09:52:25,721 [INFO]: 	compression ratio: 0.9993083628961955
2025-03-09 09:52:25,721 [INFO]: }
2025-03-09 09:52:25,721 [INFO]: 	>>> Finished "Creating the index" in 94.2880 secs
2025-03-09 09:52:25,721 [INFO]: >>> Finished "Launching the whole pipeline" in 94.3329 secs
2025-03-09 09:52:27: [retrieval_preprocessing] calculating distances ...
2025-03-09 09:52:29: [retrieval_preprocessing] finished and saved retrieval indices for episode 67089 [episode count 6/20]
[retrieval_preprocessing] for episode 11029 [episode count 7/20], we have num_retrieval=np.int64(8656) num_query=np.int64(334)
2025-03-09 09:52:30,238 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-09 09:52:31,236 [INFO]: Launching the whole pipeline 03/09/2025, 09:52:31
2025-03-09 09:52:31,236 [INFO]: Reading total number of vectors and dimension 03/09/2025, 09:52:31
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1349.95it/s]
2025-03-09 09:52:31,273 [INFO]: There are 8656 embeddings of dim 49152
2025-03-09 09:52:31,274 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0379 secs
2025-03-09 09:52:31,274 [INFO]: 	Compute estimated construction time of the index 03/09/2025, 09:52:31
2025-03-09 09:52:31,275 [INFO]: 		-> Train: 16.7 minutes
2025-03-09 09:52:31,275 [INFO]: 		-> Add: 4.8 seconds
2025-03-09 09:52:31,275 [INFO]: 		Total: 16.7 minutes
2025-03-09 09:52:31,275 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0006 secs
2025-03-09 09:52:31,275 [INFO]: 	Checking that your have enough memory available to create the index 03/09/2025, 09:52:31
2025-03-09 09:52:31,275 [INFO]: 1.7GB of memory will be needed to build the index (more might be used if you have more)
2025-03-09 09:52:31,276 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0006 secs
2025-03-09 09:52:31,276 [INFO]: 	Selecting most promising index types given data characteristics 03/09/2025, 09:52:31
2025-03-09 09:52:31,276 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-09 09:52:31,276 [INFO]: 	Creating the index 03/09/2025, 09:52:31
2025-03-09 09:52:31,276 [INFO]: 		-> Instanciate the index HNSW15 03/09/2025, 09:52:31
2025-03-09 09:52:31,280 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0033 secs
2025-03-09 09:52:31,280 [INFO]: 		-> Adding the vectors to the index 03/09/2025, 09:52:31
2025-03-09 09:52:31,280 [INFO]: The memory available for adding the vectors is 48.4GB(total available - used by the index)
2025-03-09 09:52:31,280 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/36 [00:00<?, ?it/s]  3%|▎         | 1/36 [00:00<00:03,  9.98it/s] 17%|█▋        | 6/36 [00:00<00:00, 31.95it/s] 28%|██▊       | 10/36 [00:00<00:00, 33.44it/s] 42%|████▏     | 15/36 [00:00<00:00, 39.52it/s] 56%|█████▌    | 20/36 [00:00<00:00, 43.09it/s] 69%|██████▉   | 25/36 [00:04<00:03,  3.62it/s] 89%|████████▉ | 32/36 [00:04<00:00,  6.02it/s]100%|██████████| 36/36 [00:06<00:00,  5.15it/s]
2025-03-09 09:52:38,282 [INFO]: 	Computing best hyperparameters for index knn.index 03/09/2025, 09:52:38
2025-03-09 09:53:34,295 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 56.0126 secs
2025-03-09 09:53:34,295 [INFO]: The best hyperparameters are: efSearch=212
2025-03-09 09:53:34,295 [INFO]: 	Compute fast metrics 03/09/2025, 09:53:34
  0%|          | 0/4 [00:00<?, ?it/s] 50%|█████     | 2/4 [00:00<00:00, 19.14it/s] 75%|███████▌  | 3/4 [00:00<00:00, 21.56it/s]
2025-03-09 09:54:03,049 [INFO]: 	>>> Finished "Compute fast metrics" in 28.7535 secs
2025-03-09 09:54:03,051 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 91.7712 secs
2025-03-09 09:54:03,052 [INFO]: {
2025-03-09 09:54:03,052 [INFO]: 	index_key: HNSW15
2025-03-09 09:54:03,052 [INFO]: 	index_param: efSearch=212
2025-03-09 09:54:03,052 [INFO]: 	index_path: knn.index
2025-03-09 09:54:03,052 [INFO]: 	size in bytes: 1703016730
2025-03-09 09:54:03,052 [INFO]: 	avg_search_speed_ms: 10.054374974333312
2025-03-09 09:54:03,052 [INFO]: 	99p_search_speed_ms: 24.780488787218914
2025-03-09 09:54:03,052 [INFO]: 	reconstruction error %: 0.0
2025-03-09 09:54:03,052 [INFO]: 	nb vectors: 8656
2025-03-09 09:54:03,052 [INFO]: 	vectors dimension: 49152
2025-03-09 09:54:03,052 [INFO]: 	compression ratio: 0.9993083555908462
2025-03-09 09:54:03,052 [INFO]: }
2025-03-09 09:54:03,052 [INFO]: 	>>> Finished "Creating the index" in 91.7755 secs
2025-03-09 09:54:03,052 [INFO]: >>> Finished "Launching the whole pipeline" in 91.8160 secs
2025-03-09 09:54:04: [retrieval_preprocessing] calculating distances ...
2025-03-09 09:54:05: [retrieval_preprocessing] finished and saved retrieval indices for episode 11029 [episode count 7/20]
[retrieval_preprocessing] for episode 24086 [episode count 8/20], we have num_retrieval=np.int64(8581) num_query=np.int64(409)
2025-03-09 09:54:06,448 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-09 09:54:08,354 [INFO]: Launching the whole pipeline 03/09/2025, 09:54:08
2025-03-09 09:54:08,354 [INFO]: Reading total number of vectors and dimension 03/09/2025, 09:54:08
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1230.72it/s]
2025-03-09 09:54:08,386 [INFO]: There are 8581 embeddings of dim 49152
2025-03-09 09:54:08,387 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0321 secs
2025-03-09 09:54:08,387 [INFO]: 	Compute estimated construction time of the index 03/09/2025, 09:54:08
2025-03-09 09:54:08,387 [INFO]: 		-> Train: 16.7 minutes
2025-03-09 09:54:08,387 [INFO]: 		-> Add: 4.7 seconds
2025-03-09 09:54:08,387 [INFO]: 		Total: 16.7 minutes
2025-03-09 09:54:08,387 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0002 secs
2025-03-09 09:54:08,387 [INFO]: 	Checking that your have enough memory available to create the index 03/09/2025, 09:54:08
2025-03-09 09:54:08,387 [INFO]: 1.7GB of memory will be needed to build the index (more might be used if you have more)
2025-03-09 09:54:08,387 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0002 secs
2025-03-09 09:54:08,387 [INFO]: 	Selecting most promising index types given data characteristics 03/09/2025, 09:54:08
2025-03-09 09:54:08,387 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-09 09:54:08,387 [INFO]: 	Creating the index 03/09/2025, 09:54:08
2025-03-09 09:54:08,387 [INFO]: 		-> Instanciate the index HNSW15 03/09/2025, 09:54:08
2025-03-09 09:54:08,388 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0008 secs
2025-03-09 09:54:08,388 [INFO]: 		-> Adding the vectors to the index 03/09/2025, 09:54:08
2025-03-09 09:54:08,388 [INFO]: The memory available for adding the vectors is 48.4GB(total available - used by the index)
2025-03-09 09:54:08,388 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/35 [00:00<?, ?it/s]  3%|▎         | 1/35 [00:00<00:03,  9.39it/s] 17%|█▋        | 6/35 [00:00<00:00, 29.45it/s] 31%|███▏      | 11/35 [00:00<00:00, 38.01it/s] 43%|████▎     | 15/35 [00:00<00:00, 37.93it/s] 57%|█████▋    | 20/35 [00:00<00:00, 41.98it/s] 71%|███████▏  | 25/35 [00:04<00:02,  3.66it/s] 91%|█████████▏| 32/35 [00:04<00:00,  6.10it/s]100%|██████████| 35/35 [00:06<00:00,  5.10it/s]
2025-03-09 09:54:15,261 [INFO]: 	Computing best hyperparameters for index knn.index 03/09/2025, 09:54:15
2025-03-09 09:55:10,458 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 55.1967 secs
2025-03-09 09:55:10,458 [INFO]: The best hyperparameters are: efSearch=154
2025-03-09 09:55:10,458 [INFO]: 	Compute fast metrics 03/09/2025, 09:55:10
  0%|          | 0/4 [00:00<?, ?it/s] 50%|█████     | 2/4 [00:00<00:00, 19.03it/s] 75%|███████▌  | 3/4 [00:00<00:00, 21.10it/s]
2025-03-09 09:55:36,524 [INFO]: 	>>> Finished "Compute fast metrics" in 26.0659 secs
2025-03-09 09:55:36,526 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 88.1379 secs
2025-03-09 09:55:36,526 [INFO]: {
2025-03-09 09:55:36,526 [INFO]: 	index_key: HNSW15
2025-03-09 09:55:36,526 [INFO]: 	index_param: efSearch=154
2025-03-09 09:55:36,526 [INFO]: 	index_path: knn.index
2025-03-09 09:55:36,526 [INFO]: 	size in bytes: 1688260870
2025-03-09 09:55:36,526 [INFO]: 	avg_search_speed_ms: 7.318247685251188
2025-03-09 09:55:36,526 [INFO]: 	99p_search_speed_ms: 13.359566323924808
2025-03-09 09:55:36,526 [INFO]: 	reconstruction error %: 0.0
2025-03-09 09:55:36,526 [INFO]: 	nb vectors: 8581
2025-03-09 09:55:36,526 [INFO]: 	vectors dimension: 49152
2025-03-09 09:55:36,526 [INFO]: 	compression ratio: 0.9993083876901085
2025-03-09 09:55:36,526 [INFO]: }
2025-03-09 09:55:36,527 [INFO]: 	>>> Finished "Creating the index" in 88.1391 secs
2025-03-09 09:55:36,527 [INFO]: >>> Finished "Launching the whole pipeline" in 88.1721 secs
2025-03-09 09:55:37: [retrieval_preprocessing] calculating distances ...
2025-03-09 09:55:38: [retrieval_preprocessing] finished and saved retrieval indices for episode 24086 [episode count 8/20]
[retrieval_preprocessing] for episode 24215 [episode count 9/20], we have num_retrieval=np.int64(8538) num_query=np.int64(452)
2025-03-09 09:55:39,487 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-09 09:55:40,533 [INFO]: Launching the whole pipeline 03/09/2025, 09:55:40
2025-03-09 09:55:40,533 [INFO]: Reading total number of vectors and dimension 03/09/2025, 09:55:40
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1212.93it/s]
2025-03-09 09:55:40,570 [INFO]: There are 8538 embeddings of dim 49152
2025-03-09 09:55:40,570 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0371 secs
2025-03-09 09:55:40,570 [INFO]: 	Compute estimated construction time of the index 03/09/2025, 09:55:40
2025-03-09 09:55:40,571 [INFO]: 		-> Train: 16.7 minutes
2025-03-09 09:55:40,571 [INFO]: 		-> Add: 4.7 seconds
2025-03-09 09:55:40,571 [INFO]: 		Total: 16.7 minutes
2025-03-09 09:55:40,571 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0006 secs
2025-03-09 09:55:40,571 [INFO]: 	Checking that your have enough memory available to create the index 03/09/2025, 09:55:40
2025-03-09 09:55:40,572 [INFO]: 1.7GB of memory will be needed to build the index (more might be used if you have more)
2025-03-09 09:55:40,572 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0005 secs
2025-03-09 09:55:40,572 [INFO]: 	Selecting most promising index types given data characteristics 03/09/2025, 09:55:40
2025-03-09 09:55:40,572 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-09 09:55:40,572 [INFO]: 	Creating the index 03/09/2025, 09:55:40
2025-03-09 09:55:40,572 [INFO]: 		-> Instanciate the index HNSW15 03/09/2025, 09:55:40
2025-03-09 09:55:40,575 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0028 secs
2025-03-09 09:55:40,576 [INFO]: 		-> Adding the vectors to the index 03/09/2025, 09:55:40
2025-03-09 09:55:40,576 [INFO]: The memory available for adding the vectors is 48.4GB(total available - used by the index)
2025-03-09 09:55:40,576 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/35 [00:00<?, ?it/s]  3%|▎         | 1/35 [00:00<00:04,  8.29it/s] 20%|██        | 7/35 [00:00<00:00, 35.34it/s] 37%|███▋      | 13/35 [00:00<00:00, 45.88it/s] 54%|█████▍    | 19/35 [00:00<00:00, 51.09it/s] 71%|███████▏  | 25/35 [00:04<00:02,  3.95it/s] 91%|█████████▏| 32/35 [00:04<00:00,  6.28it/s]100%|██████████| 35/35 [00:07<00:00,  4.73it/s]
2025-03-09 09:55:47,986 [INFO]: 	Computing best hyperparameters for index knn.index 03/09/2025, 09:55:47
2025-03-09 09:56:48,917 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 60.9300 secs
2025-03-09 09:56:48,917 [INFO]: The best hyperparameters are: efSearch=189
2025-03-09 09:56:48,917 [INFO]: 	Compute fast metrics 03/09/2025, 09:56:48
  0%|          | 0/4 [00:00<?, ?it/s] 75%|███████▌  | 3/4 [00:00<00:00, 26.23it/s] 75%|███████▌  | 3/4 [00:00<00:00, 22.44it/s]
2025-03-09 09:57:19,855 [INFO]: 	>>> Finished "Compute fast metrics" in 30.9380 secs
2025-03-09 09:57:19,857 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 99.2815 secs
2025-03-09 09:57:19,857 [INFO]: {
2025-03-09 09:57:19,857 [INFO]: 	index_key: HNSW15
2025-03-09 09:57:19,857 [INFO]: 	index_param: efSearch=189
2025-03-09 09:57:19,857 [INFO]: 	index_path: knn.index
2025-03-09 09:57:19,857 [INFO]: 	size in bytes: 1679800870
2025-03-09 09:57:19,857 [INFO]: 	avg_search_speed_ms: 9.551274211260685
2025-03-09 09:57:19,857 [INFO]: 	99p_search_speed_ms: 20.37925558164713
2025-03-09 09:57:19,857 [INFO]: 	reconstruction error %: 0.0
2025-03-09 09:57:19,857 [INFO]: 	nb vectors: 8538
2025-03-09 09:57:19,857 [INFO]: 	vectors dimension: 49152
2025-03-09 09:57:19,857 [INFO]: 	compression ratio: 0.9993083906427552
2025-03-09 09:57:19,857 [INFO]: }
2025-03-09 09:57:19,857 [INFO]: 	>>> Finished "Creating the index" in 99.2853 secs
2025-03-09 09:57:19,857 [INFO]: >>> Finished "Launching the whole pipeline" in 99.3244 secs
2025-03-09 09:57:21: [retrieval_preprocessing] calculating distances ...
2025-03-09 09:57:23: [retrieval_preprocessing] finished and saved retrieval indices for episode 24215 [episode count 9/20]
[retrieval_preprocessing] for episode 33558 [episode count 10/20], we have num_retrieval=np.int64(8687) num_query=np.int64(303)
2025-03-09 09:57:24,116 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-09 09:57:25,629 [INFO]: Launching the whole pipeline 03/09/2025, 09:57:25
2025-03-09 09:57:25,629 [INFO]: Reading total number of vectors and dimension 03/09/2025, 09:57:25
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1633.93it/s]
2025-03-09 09:57:25,668 [INFO]: There are 8687 embeddings of dim 49152
2025-03-09 09:57:25,668 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0388 secs
2025-03-09 09:57:25,668 [INFO]: 	Compute estimated construction time of the index 03/09/2025, 09:57:25
2025-03-09 09:57:25,668 [INFO]: 		-> Train: 16.7 minutes
2025-03-09 09:57:25,669 [INFO]: 		-> Add: 4.8 seconds
2025-03-09 09:57:25,669 [INFO]: 		Total: 16.7 minutes
2025-03-09 09:57:25,669 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0004 secs
2025-03-09 09:57:25,669 [INFO]: 	Checking that your have enough memory available to create the index 03/09/2025, 09:57:25
2025-03-09 09:57:25,669 [INFO]: 1.8GB of memory will be needed to build the index (more might be used if you have more)
2025-03-09 09:57:25,669 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0005 secs
2025-03-09 09:57:25,669 [INFO]: 	Selecting most promising index types given data characteristics 03/09/2025, 09:57:25
2025-03-09 09:57:25,669 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-09 09:57:25,670 [INFO]: 	Creating the index 03/09/2025, 09:57:25
2025-03-09 09:57:25,670 [INFO]: 		-> Instanciate the index HNSW15 03/09/2025, 09:57:25
2025-03-09 09:57:25,673 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0029 secs
2025-03-09 09:57:25,673 [INFO]: 		-> Adding the vectors to the index 03/09/2025, 09:57:25
2025-03-09 09:57:25,673 [INFO]: The memory available for adding the vectors is 48.4GB(total available - used by the index)
2025-03-09 09:57:25,673 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/36 [00:00<?, ?it/s]  3%|▎         | 1/36 [00:00<00:04,  8.61it/s] 17%|█▋        | 6/36 [00:00<00:01, 29.53it/s] 31%|███       | 11/36 [00:00<00:00, 36.33it/s] 42%|████▏     | 15/36 [00:00<00:00, 34.31it/s] 53%|█████▎    | 19/36 [00:00<00:00, 27.94it/s] 61%|██████    | 22/36 [00:04<00:05,  2.50it/s] 78%|███████▊  | 28/36 [00:04<00:01,  4.33it/s] 94%|█████████▍| 34/36 [00:04<00:00,  6.74it/s]100%|██████████| 36/36 [00:07<00:00,  4.56it/s]
2025-03-09 09:57:33,572 [INFO]: 	Computing best hyperparameters for index knn.index 03/09/2025, 09:57:33
2025-03-09 09:58:29,833 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 56.2597 secs
2025-03-09 09:58:29,833 [INFO]: The best hyperparameters are: efSearch=205
2025-03-09 09:58:29,833 [INFO]: 	Compute fast metrics 03/09/2025, 09:58:29
  0%|          | 0/4 [00:00<?, ?it/s] 50%|█████     | 2/4 [00:00<00:00, 18.08it/s] 75%|███████▌  | 3/4 [00:00<00:00, 20.06it/s]
2025-03-09 09:58:57,972 [INFO]: 	>>> Finished "Compute fast metrics" in 28.1387 secs
2025-03-09 09:58:57,974 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 92.3008 secs
2025-03-09 09:58:57,974 [INFO]: {
2025-03-09 09:58:57,974 [INFO]: 	index_key: HNSW15
2025-03-09 09:58:57,974 [INFO]: 	index_param: efSearch=205
2025-03-09 09:58:57,974 [INFO]: 	index_path: knn.index
2025-03-09 09:58:57,974 [INFO]: 	size in bytes: 1709115730
2025-03-09 09:58:57,974 [INFO]: 	avg_search_speed_ms: 10.03459913547757
2025-03-09 09:58:57,974 [INFO]: 	99p_search_speed_ms: 20.999108236283046
2025-03-09 09:58:57,974 [INFO]: 	reconstruction error %: 0.0
2025-03-09 09:58:57,974 [INFO]: 	nb vectors: 8687
2025-03-09 09:58:57,974 [INFO]: 	vectors dimension: 49152
2025-03-09 09:58:57,974 [INFO]: 	compression ratio: 0.9993083944058019
2025-03-09 09:58:57,974 [INFO]: }
2025-03-09 09:58:57,974 [INFO]: 	>>> Finished "Creating the index" in 92.3046 secs
2025-03-09 09:58:57,974 [INFO]: >>> Finished "Launching the whole pipeline" in 92.3451 secs
2025-03-09 09:58:59: [retrieval_preprocessing] calculating distances ...
2025-03-09 09:58:59: [retrieval_preprocessing] finished and saved retrieval indices for episode 33558 [episode count 10/20]
[retrieval_preprocessing] for episode 91289 [episode count 11/20], we have num_retrieval=np.int64(8077) num_query=np.int64(913)
2025-03-09 09:59:00,572 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-09 09:59:01,574 [INFO]: Launching the whole pipeline 03/09/2025, 09:59:01
2025-03-09 09:59:01,574 [INFO]: Reading total number of vectors and dimension 03/09/2025, 09:59:01
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 2131.25it/s]
2025-03-09 09:59:01,605 [INFO]: There are 8077 embeddings of dim 49152
2025-03-09 09:59:01,605 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0310 secs
2025-03-09 09:59:01,605 [INFO]: 	Compute estimated construction time of the index 03/09/2025, 09:59:01
2025-03-09 09:59:01,605 [INFO]: 		-> Train: 16.7 minutes
2025-03-09 09:59:01,605 [INFO]: 		-> Add: 4.4 seconds
2025-03-09 09:59:01,605 [INFO]: 		Total: 16.7 minutes
2025-03-09 09:59:01,605 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0001 secs
2025-03-09 09:59:01,605 [INFO]: 	Checking that your have enough memory available to create the index 03/09/2025, 09:59:01
2025-03-09 09:59:01,606 [INFO]: 1.6GB of memory will be needed to build the index (more might be used if you have more)
2025-03-09 09:59:01,606 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0001 secs
2025-03-09 09:59:01,606 [INFO]: 	Selecting most promising index types given data characteristics 03/09/2025, 09:59:01
2025-03-09 09:59:01,606 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-09 09:59:01,606 [INFO]: 	Creating the index 03/09/2025, 09:59:01
2025-03-09 09:59:01,606 [INFO]: 		-> Instanciate the index HNSW15 03/09/2025, 09:59:01
2025-03-09 09:59:01,607 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0008 secs
2025-03-09 09:59:01,607 [INFO]: 		-> Adding the vectors to the index 03/09/2025, 09:59:01
2025-03-09 09:59:01,607 [INFO]: The memory available for adding the vectors is 48.5GB(total available - used by the index)
2025-03-09 09:59:01,607 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/33 [00:00<?, ?it/s]  3%|▎         | 1/33 [00:00<00:04,  7.84it/s] 21%|██        | 7/33 [00:00<00:00, 34.07it/s] 39%|███▉      | 13/33 [00:00<00:00, 43.77it/s] 58%|█████▊    | 19/33 [00:00<00:00, 48.55it/s] 73%|███████▎  | 24/33 [00:03<00:02,  3.95it/s] 88%|████████▊ | 29/33 [00:04<00:00,  5.66it/s]100%|██████████| 33/33 [00:06<00:00,  3.22it/s]100%|██████████| 33/33 [00:06<00:00,  4.94it/s]
2025-03-09 09:59:08,298 [INFO]: 	Computing best hyperparameters for index knn.index 03/09/2025, 09:59:08
2025-03-09 10:00:02,446 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 54.1465 secs
2025-03-09 10:00:02,446 [INFO]: The best hyperparameters are: efSearch=152
2025-03-09 10:00:02,446 [INFO]: 	Compute fast metrics 03/09/2025, 10:00:02
  0%|          | 0/4 [00:00<?, ?it/s] 50%|█████     | 2/4 [00:00<00:00, 17.76it/s] 75%|███████▌  | 3/4 [00:00<00:00, 19.79it/s]
2025-03-09 10:00:20,460 [INFO]: 	>>> Finished "Compute fast metrics" in 18.0141 secs
2025-03-09 10:00:20,462 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 78.8551 secs
2025-03-09 10:00:20,462 [INFO]: {
2025-03-09 10:00:20,462 [INFO]: 	index_key: HNSW15
2025-03-09 10:00:20,462 [INFO]: 	index_param: efSearch=152
2025-03-09 10:00:20,462 [INFO]: 	index_path: knn.index
2025-03-09 10:00:20,462 [INFO]: 	size in bytes: 1589102170
2025-03-09 10:00:20,462 [INFO]: 	avg_search_speed_ms: 8.009532263339926
2025-03-09 10:00:20,462 [INFO]: 	99p_search_speed_ms: 18.689169967547052
2025-03-09 10:00:20,462 [INFO]: 	reconstruction error %: 0.0
2025-03-09 10:00:20,462 [INFO]: 	nb vectors: 8077
2025-03-09 10:00:20,462 [INFO]: 	vectors dimension: 49152
2025-03-09 10:00:20,462 [INFO]: 	compression ratio: 0.9993081917445246
2025-03-09 10:00:20,462 [INFO]: }
2025-03-09 10:00:20,462 [INFO]: 	>>> Finished "Creating the index" in 78.8564 secs
2025-03-09 10:00:20,462 [INFO]: >>> Finished "Launching the whole pipeline" in 78.8879 secs
2025-03-09 10:00:22: [retrieval_preprocessing] calculating distances ...
2025-03-09 10:00:25: [retrieval_preprocessing] finished and saved retrieval indices for episode 91289 [episode count 11/20]
[retrieval_preprocessing] for episode 12826 [episode count 12/20], we have num_retrieval=np.int64(8146) num_query=np.int64(844)
2025-03-09 10:00:25,756 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-09 10:00:26,601 [INFO]: Launching the whole pipeline 03/09/2025, 10:00:26
2025-03-09 10:00:26,602 [INFO]: Reading total number of vectors and dimension 03/09/2025, 10:00:26
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 2055.02it/s]
2025-03-09 10:00:26,630 [INFO]: There are 8146 embeddings of dim 49152
2025-03-09 10:00:26,630 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0288 secs
2025-03-09 10:00:26,630 [INFO]: 	Compute estimated construction time of the index 03/09/2025, 10:00:26
2025-03-09 10:00:26,631 [INFO]: 		-> Train: 16.7 minutes
2025-03-09 10:00:26,631 [INFO]: 		-> Add: 4.5 seconds
2025-03-09 10:00:26,631 [INFO]: 		Total: 16.7 minutes
2025-03-09 10:00:26,631 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0001 secs
2025-03-09 10:00:26,631 [INFO]: 	Checking that your have enough memory available to create the index 03/09/2025, 10:00:26
2025-03-09 10:00:26,631 [INFO]: 1.6GB of memory will be needed to build the index (more might be used if you have more)
2025-03-09 10:00:26,631 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0002 secs
2025-03-09 10:00:26,631 [INFO]: 	Selecting most promising index types given data characteristics 03/09/2025, 10:00:26
2025-03-09 10:00:26,631 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-09 10:00:26,631 [INFO]: 	Creating the index 03/09/2025, 10:00:26
2025-03-09 10:00:26,631 [INFO]: 		-> Instanciate the index HNSW15 03/09/2025, 10:00:26
2025-03-09 10:00:26,632 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0009 secs
2025-03-09 10:00:26,632 [INFO]: 		-> Adding the vectors to the index 03/09/2025, 10:00:26
2025-03-09 10:00:26,632 [INFO]: The memory available for adding the vectors is 48.5GB(total available - used by the index)
2025-03-09 10:00:26,632 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/34 [00:00<?, ?it/s]  3%|▎         | 1/34 [00:00<00:03,  9.78it/s] 26%|██▋       | 9/34 [00:00<00:00, 48.14it/s] 50%|█████     | 17/34 [00:00<00:00, 61.05it/s] 71%|███████   | 24/34 [00:03<00:02,  4.43it/s] 91%|█████████ | 31/34 [00:04<00:00,  6.77it/s]100%|██████████| 34/34 [00:06<00:00,  5.04it/s]
2025-03-09 10:00:33,377 [INFO]: 	Computing best hyperparameters for index knn.index 03/09/2025, 10:00:33
2025-03-09 10:01:30,976 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 57.5983 secs
2025-03-09 10:01:30,976 [INFO]: The best hyperparameters are: efSearch=101
2025-03-09 10:01:30,976 [INFO]: 	Compute fast metrics 03/09/2025, 10:01:30
  0%|          | 0/4 [00:00<?, ?it/s] 75%|███████▌  | 3/4 [00:00<00:00, 25.58it/s] 75%|███████▌  | 3/4 [00:00<00:00, 22.30it/s]
2025-03-09 10:01:53,730 [INFO]: 	>>> Finished "Compute fast metrics" in 22.7538 secs
2025-03-09 10:01:53,732 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 87.0995 secs
2025-03-09 10:01:53,732 [INFO]: {
2025-03-09 10:01:53,732 [INFO]: 	index_key: HNSW15
2025-03-09 10:01:53,732 [INFO]: 	index_param: efSearch=101
2025-03-09 10:01:53,732 [INFO]: 	index_path: knn.index
2025-03-09 10:01:53,732 [INFO]: 	size in bytes: 1602677470
2025-03-09 10:01:53,732 [INFO]: 	avg_search_speed_ms: 5.623070734509588
2025-03-09 10:01:53,732 [INFO]: 	99p_search_speed_ms: 11.80810990277678
2025-03-09 10:01:53,732 [INFO]: 	reconstruction error %: 0.0
2025-03-09 10:01:53,732 [INFO]: 	nb vectors: 8146
2025-03-09 10:01:53,732 [INFO]: 	vectors dimension: 49152
2025-03-09 10:01:53,732 [INFO]: 	compression ratio: 0.9993082188894813
2025-03-09 10:01:53,732 [INFO]: }
2025-03-09 10:01:53,732 [INFO]: 	>>> Finished "Creating the index" in 87.1008 secs
2025-03-09 10:01:53,732 [INFO]: >>> Finished "Launching the whole pipeline" in 87.1303 secs
2025-03-09 10:01:55: [retrieval_preprocessing] calculating distances ...
2025-03-09 10:01:57: [retrieval_preprocessing] finished and saved retrieval indices for episode 12826 [episode count 12/20]
[retrieval_preprocessing] for episode 3482 [episode count 13/20], we have num_retrieval=np.int64(8699) num_query=np.int64(291)
2025-03-09 10:01:58,590 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-09 10:01:59,807 [INFO]: Launching the whole pipeline 03/09/2025, 10:01:59
2025-03-09 10:01:59,807 [INFO]: Reading total number of vectors and dimension 03/09/2025, 10:01:59
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1374.28it/s]
2025-03-09 10:01:59,841 [INFO]: There are 8699 embeddings of dim 49152
2025-03-09 10:01:59,842 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0347 secs
2025-03-09 10:01:59,842 [INFO]: 	Compute estimated construction time of the index 03/09/2025, 10:01:59
2025-03-09 10:01:59,842 [INFO]: 		-> Train: 16.7 minutes
2025-03-09 10:01:59,842 [INFO]: 		-> Add: 4.8 seconds
2025-03-09 10:01:59,842 [INFO]: 		Total: 16.7 minutes
2025-03-09 10:01:59,842 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0001 secs
2025-03-09 10:01:59,842 [INFO]: 	Checking that your have enough memory available to create the index 03/09/2025, 10:01:59
2025-03-09 10:01:59,842 [INFO]: 1.8GB of memory will be needed to build the index (more might be used if you have more)
2025-03-09 10:01:59,842 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0001 secs
2025-03-09 10:01:59,842 [INFO]: 	Selecting most promising index types given data characteristics 03/09/2025, 10:01:59
2025-03-09 10:01:59,842 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-09 10:01:59,842 [INFO]: 	Creating the index 03/09/2025, 10:01:59
2025-03-09 10:01:59,842 [INFO]: 		-> Instanciate the index HNSW15 03/09/2025, 10:01:59
2025-03-09 10:01:59,843 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0009 secs
2025-03-09 10:01:59,843 [INFO]: 		-> Adding the vectors to the index 03/09/2025, 10:01:59
2025-03-09 10:01:59,843 [INFO]: The memory available for adding the vectors is 48.4GB(total available - used by the index)
2025-03-09 10:01:59,843 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/36 [00:00<?, ?it/s]  3%|▎         | 1/36 [00:00<00:05,  6.90it/s] 17%|█▋        | 6/36 [00:00<00:01, 27.22it/s] 31%|███       | 11/36 [00:00<00:00, 34.88it/s] 42%|████▏     | 15/36 [00:00<00:00, 34.44it/s] 56%|█████▌    | 20/36 [00:00<00:00, 37.72it/s] 67%|██████▋   | 24/36 [00:04<00:03,  3.04it/s] 81%|████████  | 29/36 [00:04<00:01,  4.59it/s] 94%|█████████▍| 34/36 [00:04<00:00,  6.63it/s]100%|██████████| 36/36 [00:08<00:00,  4.38it/s]
2025-03-09 10:02:08,066 [INFO]: 	Computing best hyperparameters for index knn.index 03/09/2025, 10:02:08
2025-03-09 10:03:04,334 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 56.2680 secs
2025-03-09 10:03:04,335 [INFO]: The best hyperparameters are: efSearch=193
2025-03-09 10:03:04,335 [INFO]: 	Compute fast metrics 03/09/2025, 10:03:04
  0%|          | 0/4 [00:00<?, ?it/s] 25%|██▌       | 1/4 [00:00<00:00,  9.57it/s] 75%|███████▌  | 3/4 [00:00<00:00, 17.12it/s]
2025-03-09 10:03:25,547 [INFO]: 	>>> Finished "Compute fast metrics" in 21.2125 secs
2025-03-09 10:03:25,549 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 85.7058 secs
2025-03-09 10:03:25,549 [INFO]: {
2025-03-09 10:03:25,549 [INFO]: 	index_key: HNSW15
2025-03-09 10:03:25,549 [INFO]: 	index_param: efSearch=193
2025-03-09 10:03:25,549 [INFO]: 	index_path: knn.index
2025-03-09 10:03:25,549 [INFO]: 	size in bytes: 1711476610
2025-03-09 10:03:25,549 [INFO]: 	avg_search_speed_ms: 10.116726640777623
2025-03-09 10:03:25,549 [INFO]: 	99p_search_speed_ms: 19.489632463082675
2025-03-09 10:03:25,549 [INFO]: 	reconstruction error %: 0.0
2025-03-09 10:03:25,549 [INFO]: 	nb vectors: 8699
2025-03-09 10:03:25,549 [INFO]: 	vectors dimension: 49152
2025-03-09 10:03:25,549 [INFO]: 	compression ratio: 0.9993084229179153
2025-03-09 10:03:25,549 [INFO]: }
2025-03-09 10:03:25,549 [INFO]: 	>>> Finished "Creating the index" in 85.7072 secs
2025-03-09 10:03:25,549 [INFO]: >>> Finished "Launching the whole pipeline" in 85.7425 secs
2025-03-09 10:03:26: [retrieval_preprocessing] calculating distances ...
2025-03-09 10:03:27: [retrieval_preprocessing] finished and saved retrieval indices for episode 3482 [episode count 13/20]
[retrieval_preprocessing] for episode 10269 [episode count 14/20], we have num_retrieval=np.int64(8744) num_query=np.int64(246)
2025-03-09 10:03:28,322 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-09 10:03:29,383 [INFO]: Launching the whole pipeline 03/09/2025, 10:03:29
2025-03-09 10:03:29,383 [INFO]: Reading total number of vectors and dimension 03/09/2025, 10:03:29
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 2182.26it/s]
2025-03-09 10:03:29,415 [INFO]: There are 8744 embeddings of dim 49152
2025-03-09 10:03:29,416 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0322 secs
2025-03-09 10:03:29,416 [INFO]: 	Compute estimated construction time of the index 03/09/2025, 10:03:29
2025-03-09 10:03:29,416 [INFO]: 		-> Train: 16.7 minutes
2025-03-09 10:03:29,416 [INFO]: 		-> Add: 4.8 seconds
2025-03-09 10:03:29,416 [INFO]: 		Total: 16.7 minutes
2025-03-09 10:03:29,416 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0003 secs
2025-03-09 10:03:29,416 [INFO]: 	Checking that your have enough memory available to create the index 03/09/2025, 10:03:29
2025-03-09 10:03:29,417 [INFO]: 1.8GB of memory will be needed to build the index (more might be used if you have more)
2025-03-09 10:03:29,417 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0002 secs
2025-03-09 10:03:29,417 [INFO]: 	Selecting most promising index types given data characteristics 03/09/2025, 10:03:29
2025-03-09 10:03:29,417 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-09 10:03:29,417 [INFO]: 	Creating the index 03/09/2025, 10:03:29
2025-03-09 10:03:29,417 [INFO]: 		-> Instanciate the index HNSW15 03/09/2025, 10:03:29
2025-03-09 10:03:29,420 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0026 secs
2025-03-09 10:03:29,420 [INFO]: 		-> Adding the vectors to the index 03/09/2025, 10:03:29
2025-03-09 10:03:29,420 [INFO]: The memory available for adding the vectors is 48.4GB(total available - used by the index)
2025-03-09 10:03:29,420 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/36 [00:00<?, ?it/s]  3%|▎         | 1/36 [00:00<00:04,  8.75it/s] 19%|█▉        | 7/36 [00:00<00:00, 37.05it/s] 39%|███▉      | 14/36 [00:00<00:00, 48.59it/s] 58%|█████▊    | 21/36 [00:04<00:03,  3.85it/s] 72%|███████▏  | 26/36 [00:04<00:01,  5.44it/s] 92%|█████████▏| 33/36 [00:04<00:00,  8.44it/s]100%|██████████| 36/36 [00:07<00:00,  4.84it/s]
2025-03-09 10:03:36,862 [INFO]: 	Computing best hyperparameters for index knn.index 03/09/2025, 10:03:36
2025-03-09 10:04:32,232 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 55.3699 secs
2025-03-09 10:04:32,232 [INFO]: The best hyperparameters are: efSearch=199
2025-03-09 10:04:32,232 [INFO]: 	Compute fast metrics 03/09/2025, 10:04:32
  0%|          | 0/4 [00:00<?, ?it/s] 50%|█████     | 2/4 [00:00<00:00, 17.47it/s] 75%|███████▌  | 3/4 [00:00<00:00, 19.70it/s]
2025-03-09 10:04:55,140 [INFO]: 	>>> Finished "Compute fast metrics" in 22.9076 secs
2025-03-09 10:04:55,142 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 85.7219 secs
2025-03-09 10:04:55,142 [INFO]: {
2025-03-09 10:04:55,142 [INFO]: 	index_key: HNSW15
2025-03-09 10:04:55,142 [INFO]: 	index_param: efSearch=199
2025-03-09 10:04:55,142 [INFO]: 	index_path: knn.index
2025-03-09 10:04:55,142 [INFO]: 	size in bytes: 1720330030
2025-03-09 10:04:55,142 [INFO]: 	avg_search_speed_ms: 9.644514119266931
2025-03-09 10:04:55,142 [INFO]: 	99p_search_speed_ms: 19.475497966632254
2025-03-09 10:04:55,142 [INFO]: 	reconstruction error %: 0.0
2025-03-09 10:04:55,142 [INFO]: 	nb vectors: 8744
2025-03-09 10:04:55,142 [INFO]: 	vectors dimension: 49152
2025-03-09 10:04:55,142 [INFO]: 	compression ratio: 0.9993084594355421
2025-03-09 10:04:55,142 [INFO]: }
2025-03-09 10:04:55,142 [INFO]: 	>>> Finished "Creating the index" in 85.7253 secs
2025-03-09 10:04:55,142 [INFO]: >>> Finished "Launching the whole pipeline" in 85.7589 secs
2025-03-09 10:04:56: [retrieval_preprocessing] calculating distances ...
2025-03-09 10:04:56: [retrieval_preprocessing] finished and saved retrieval indices for episode 10269 [episode count 14/20]
[retrieval_preprocessing] for episode 8989 [episode count 15/20], we have num_retrieval=np.int64(8563) num_query=np.int64(427)
2025-03-09 10:04:57,555 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-09 10:04:58,663 [INFO]: Launching the whole pipeline 03/09/2025, 10:04:58
2025-03-09 10:04:58,663 [INFO]: Reading total number of vectors and dimension 03/09/2025, 10:04:58
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 2181.13it/s]
2025-03-09 10:04:58,695 [INFO]: There are 8563 embeddings of dim 49152
2025-03-09 10:04:58,695 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0313 secs
2025-03-09 10:04:58,695 [INFO]: 	Compute estimated construction time of the index 03/09/2025, 10:04:58
2025-03-09 10:04:58,695 [INFO]: 		-> Train: 16.7 minutes
2025-03-09 10:04:58,695 [INFO]: 		-> Add: 4.7 seconds
2025-03-09 10:04:58,695 [INFO]: 		Total: 16.7 minutes
2025-03-09 10:04:58,695 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0001 secs
2025-03-09 10:04:58,695 [INFO]: 	Checking that your have enough memory available to create the index 03/09/2025, 10:04:58
2025-03-09 10:04:58,695 [INFO]: 1.7GB of memory will be needed to build the index (more might be used if you have more)
2025-03-09 10:04:58,695 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0001 secs
2025-03-09 10:04:58,695 [INFO]: 	Selecting most promising index types given data characteristics 03/09/2025, 10:04:58
2025-03-09 10:04:58,695 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-09 10:04:58,695 [INFO]: 	Creating the index 03/09/2025, 10:04:58
2025-03-09 10:04:58,695 [INFO]: 		-> Instanciate the index HNSW15 03/09/2025, 10:04:58
2025-03-09 10:04:58,696 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0010 secs
2025-03-09 10:04:58,697 [INFO]: 		-> Adding the vectors to the index 03/09/2025, 10:04:58
2025-03-09 10:04:58,697 [INFO]: The memory available for adding the vectors is 48.4GB(total available - used by the index)
2025-03-09 10:04:58,697 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/35 [00:00<?, ?it/s]  3%|▎         | 1/35 [00:00<00:04,  7.03it/s] 20%|██        | 7/35 [00:00<00:00, 32.71it/s] 34%|███▍      | 12/35 [00:00<00:00, 38.61it/s] 51%|█████▏    | 18/35 [00:00<00:00, 45.65it/s] 66%|██████▌   | 23/35 [00:04<00:03,  3.38it/s] 83%|████████▎ | 29/35 [00:04<00:01,  5.26it/s]100%|██████████| 35/35 [00:07<00:00,  3.51it/s]100%|██████████| 35/35 [00:07<00:00,  4.82it/s]
2025-03-09 10:05:05,961 [INFO]: 	Computing best hyperparameters for index knn.index 03/09/2025, 10:05:05
2025-03-09 10:06:00,739 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 54.7776 secs
2025-03-09 10:06:00,739 [INFO]: The best hyperparameters are: efSearch=169
2025-03-09 10:06:00,739 [INFO]: 	Compute fast metrics 03/09/2025, 10:06:00
  0%|          | 0/4 [00:00<?, ?it/s] 50%|█████     | 2/4 [00:00<00:00, 19.87it/s] 75%|███████▌  | 3/4 [00:00<00:00, 22.56it/s]
2025-03-09 10:06:19,829 [INFO]: 	>>> Finished "Compute fast metrics" in 19.0897 secs
2025-03-09 10:06:19,831 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 81.1338 secs
2025-03-09 10:06:19,831 [INFO]: {
2025-03-09 10:06:19,831 [INFO]: 	index_key: HNSW15
2025-03-09 10:06:19,831 [INFO]: 	index_param: efSearch=169
2025-03-09 10:06:19,831 [INFO]: 	index_path: knn.index
2025-03-09 10:06:19,831 [INFO]: 	size in bytes: 1684719550
2025-03-09 10:06:19,831 [INFO]: 	avg_search_speed_ms: 8.484031038794846
2025-03-09 10:06:19,831 [INFO]: 	99p_search_speed_ms: 15.878473147749906
2025-03-09 10:06:19,831 [INFO]: 	reconstruction error %: 0.0
2025-03-09 10:06:19,831 [INFO]: 	nb vectors: 8563
2025-03-09 10:06:19,831 [INFO]: 	vectors dimension: 49152
2025-03-09 10:06:19,831 [INFO]: 	compression ratio: 0.9993083442285691
2025-03-09 10:06:19,831 [INFO]: }
2025-03-09 10:06:19,831 [INFO]: 	>>> Finished "Creating the index" in 81.1358 secs
2025-03-09 10:06:19,831 [INFO]: >>> Finished "Launching the whole pipeline" in 81.1677 secs
2025-03-09 10:06:21: [retrieval_preprocessing] calculating distances ...
2025-03-09 10:06:22: [retrieval_preprocessing] finished and saved retrieval indices for episode 8989 [episode count 15/20]
[retrieval_preprocessing] for episode 16030 [episode count 16/20], we have num_retrieval=np.int64(8685) num_query=np.int64(305)
2025-03-09 10:06:22,991 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-09 10:06:24,090 [INFO]: Launching the whole pipeline 03/09/2025, 10:06:24
2025-03-09 10:06:24,091 [INFO]: Reading total number of vectors and dimension 03/09/2025, 10:06:24
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 2114.06it/s]
2025-03-09 10:06:24,124 [INFO]: There are 8685 embeddings of dim 49152
2025-03-09 10:06:24,124 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0333 secs
2025-03-09 10:06:24,124 [INFO]: 	Compute estimated construction time of the index 03/09/2025, 10:06:24
2025-03-09 10:06:24,125 [INFO]: 		-> Train: 16.7 minutes
2025-03-09 10:06:24,125 [INFO]: 		-> Add: 4.8 seconds
2025-03-09 10:06:24,125 [INFO]: 		Total: 16.7 minutes
2025-03-09 10:06:24,125 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0004 secs
2025-03-09 10:06:24,125 [INFO]: 	Checking that your have enough memory available to create the index 03/09/2025, 10:06:24
2025-03-09 10:06:24,125 [INFO]: 1.8GB of memory will be needed to build the index (more might be used if you have more)
2025-03-09 10:06:24,125 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0004 secs
2025-03-09 10:06:24,126 [INFO]: 	Selecting most promising index types given data characteristics 03/09/2025, 10:06:24
2025-03-09 10:06:24,126 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-09 10:06:24,126 [INFO]: 	Creating the index 03/09/2025, 10:06:24
2025-03-09 10:06:24,126 [INFO]: 		-> Instanciate the index HNSW15 03/09/2025, 10:06:24
2025-03-09 10:06:24,129 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0026 secs
2025-03-09 10:06:24,129 [INFO]: 		-> Adding the vectors to the index 03/09/2025, 10:06:24
2025-03-09 10:06:24,129 [INFO]: The memory available for adding the vectors is 48.4GB(total available - used by the index)
2025-03-09 10:06:24,129 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/36 [00:00<?, ?it/s]  6%|▌         | 2/36 [00:00<00:01, 17.07it/s] 22%|██▏       | 8/36 [00:00<00:00, 38.47it/s] 39%|███▉      | 14/36 [00:00<00:00, 44.47it/s] 56%|█████▌    | 20/36 [00:00<00:00, 48.97it/s] 69%|██████▉   | 25/36 [00:04<00:03,  3.43it/s] 83%|████████▎ | 30/36 [00:04<00:01,  4.88it/s] 94%|█████████▍| 34/36 [00:04<00:00,  6.41it/s]100%|██████████| 36/36 [00:08<00:00,  4.42it/s]
2025-03-09 10:06:32,273 [INFO]: 	Computing best hyperparameters for index knn.index 03/09/2025, 10:06:32
2025-03-09 10:07:26,944 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 54.6702 secs
2025-03-09 10:07:26,944 [INFO]: The best hyperparameters are: efSearch=212
2025-03-09 10:07:26,944 [INFO]: 	Compute fast metrics 03/09/2025, 10:07:26
  0%|          | 0/4 [00:00<?, ?it/s] 50%|█████     | 2/4 [00:00<00:00, 17.37it/s] 75%|███████▌  | 3/4 [00:00<00:00, 18.09it/s]
2025-03-09 10:07:47,135 [INFO]: 	>>> Finished "Compute fast metrics" in 20.1909 secs
2025-03-09 10:07:47,137 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 83.0081 secs
2025-03-09 10:07:47,137 [INFO]: {
2025-03-09 10:07:47,137 [INFO]: 	index_key: HNSW15
2025-03-09 10:07:47,137 [INFO]: 	index_param: efSearch=212
2025-03-09 10:07:47,137 [INFO]: 	index_path: knn.index
2025-03-09 10:07:47,137 [INFO]: 	size in bytes: 1708722250
2025-03-09 10:07:47,137 [INFO]: 	avg_search_speed_ms: 10.04433463912936
2025-03-09 10:07:47,137 [INFO]: 	99p_search_speed_ms: 19.065949390642338
2025-03-09 10:07:47,137 [INFO]: 	reconstruction error %: 0.0
2025-03-09 10:07:47,138 [INFO]: 	nb vectors: 8685
2025-03-09 10:07:47,138 [INFO]: 	vectors dimension: 49152
2025-03-09 10:07:47,138 [INFO]: 	compression ratio: 0.999308389646123
2025-03-09 10:07:47,138 [INFO]: }
2025-03-09 10:07:47,138 [INFO]: 	>>> Finished "Creating the index" in 83.0116 secs
2025-03-09 10:07:47,138 [INFO]: >>> Finished "Launching the whole pipeline" in 83.0470 secs
2025-03-09 10:07:48: [retrieval_preprocessing] calculating distances ...
2025-03-09 10:07:49: [retrieval_preprocessing] finished and saved retrieval indices for episode 16030 [episode count 16/20]
[retrieval_preprocessing] for episode 32413 [episode count 17/20], we have num_retrieval=np.int64(8737) num_query=np.int64(253)
2025-03-09 10:07:50,138 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-09 10:07:51,176 [INFO]: Launching the whole pipeline 03/09/2025, 10:07:51
2025-03-09 10:07:51,176 [INFO]: Reading total number of vectors and dimension 03/09/2025, 10:07:51
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 2314.74it/s]
2025-03-09 10:07:51,207 [INFO]: There are 8737 embeddings of dim 49152
2025-03-09 10:07:51,208 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0318 secs
2025-03-09 10:07:51,208 [INFO]: 	Compute estimated construction time of the index 03/09/2025, 10:07:51
2025-03-09 10:07:51,208 [INFO]: 		-> Train: 16.7 minutes
2025-03-09 10:07:51,208 [INFO]: 		-> Add: 4.8 seconds
2025-03-09 10:07:51,208 [INFO]: 		Total: 16.7 minutes
2025-03-09 10:07:51,208 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0004 secs
2025-03-09 10:07:51,208 [INFO]: 	Checking that your have enough memory available to create the index 03/09/2025, 10:07:51
2025-03-09 10:07:51,209 [INFO]: 1.8GB of memory will be needed to build the index (more might be used if you have more)
2025-03-09 10:07:51,209 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0004 secs
2025-03-09 10:07:51,209 [INFO]: 	Selecting most promising index types given data characteristics 03/09/2025, 10:07:51
2025-03-09 10:07:51,209 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-09 10:07:51,209 [INFO]: 	Creating the index 03/09/2025, 10:07:51
2025-03-09 10:07:51,209 [INFO]: 		-> Instanciate the index HNSW15 03/09/2025, 10:07:51
2025-03-09 10:07:51,212 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0028 secs
2025-03-09 10:07:51,213 [INFO]: 		-> Adding the vectors to the index 03/09/2025, 10:07:51
2025-03-09 10:07:51,213 [INFO]: The memory available for adding the vectors is 48.4GB(total available - used by the index)
2025-03-09 10:07:51,213 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/36 [00:00<?, ?it/s]  6%|▌         | 2/36 [00:00<00:02, 16.39it/s] 22%|██▏       | 8/36 [00:00<00:00, 37.85it/s] 42%|████▏     | 15/36 [00:00<00:00, 49.21it/s] 58%|█████▊    | 21/36 [00:04<00:04,  3.64it/s] 75%|███████▌  | 27/36 [00:04<00:01,  5.56it/s] 92%|█████████▏| 33/36 [00:04<00:00,  8.07it/s]100%|██████████| 36/36 [00:07<00:00,  4.98it/s]
2025-03-09 10:07:58,444 [INFO]: 	Computing best hyperparameters for index knn.index 03/09/2025, 10:07:58
2025-03-09 10:08:53,345 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 54.9006 secs
2025-03-09 10:08:53,345 [INFO]: The best hyperparameters are: efSearch=194
2025-03-09 10:08:53,345 [INFO]: 	Compute fast metrics 03/09/2025, 10:08:53
  0%|          | 0/4 [00:00<?, ?it/s] 50%|█████     | 2/4 [00:00<00:00, 19.80it/s] 75%|███████▌  | 3/4 [00:00<00:00, 22.10it/s]
2025-03-09 10:09:10,557 [INFO]: 	>>> Finished "Compute fast metrics" in 17.2117 secs
2025-03-09 10:09:10,559 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 79.3460 secs
2025-03-09 10:09:10,559 [INFO]: {
2025-03-09 10:09:10,559 [INFO]: 	index_key: HNSW15
2025-03-09 10:09:10,559 [INFO]: 	index_param: efSearch=194
2025-03-09 10:09:10,559 [INFO]: 	index_path: knn.index
2025-03-09 10:09:10,559 [INFO]: 	size in bytes: 1718952790
2025-03-09 10:09:10,559 [INFO]: 	avg_search_speed_ms: 8.334232392565658
2025-03-09 10:09:10,559 [INFO]: 	99p_search_speed_ms: 14.614979994948953
2025-03-09 10:09:10,559 [INFO]: 	reconstruction error %: 0.0
2025-03-09 10:09:10,559 [INFO]: 	nb vectors: 8737
2025-03-09 10:09:10,559 [INFO]: 	vectors dimension: 49152
2025-03-09 10:09:10,559 [INFO]: 	compression ratio: 0.9993084778087478
2025-03-09 10:09:10,559 [INFO]: }
2025-03-09 10:09:10,559 [INFO]: 	>>> Finished "Creating the index" in 79.3497 secs
2025-03-09 10:09:10,559 [INFO]: >>> Finished "Launching the whole pipeline" in 79.3832 secs
2025-03-09 10:09:11: [retrieval_preprocessing] calculating distances ...
2025-03-09 10:09:12: [retrieval_preprocessing] finished and saved retrieval indices for episode 32413 [episode count 17/20]
[retrieval_preprocessing] for episode 41122 [episode count 18/20], we have num_retrieval=np.int64(8220) num_query=np.int64(770)
2025-03-09 10:09:13,047 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-09 10:09:13,946 [INFO]: Launching the whole pipeline 03/09/2025, 10:09:13
2025-03-09 10:09:13,946 [INFO]: Reading total number of vectors and dimension 03/09/2025, 10:09:13
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1798.59it/s]
2025-03-09 10:09:13,975 [INFO]: There are 8220 embeddings of dim 49152
2025-03-09 10:09:13,975 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0294 secs
2025-03-09 10:09:13,975 [INFO]: 	Compute estimated construction time of the index 03/09/2025, 10:09:13
2025-03-09 10:09:13,975 [INFO]: 		-> Train: 16.7 minutes
2025-03-09 10:09:13,975 [INFO]: 		-> Add: 4.5 seconds
2025-03-09 10:09:13,975 [INFO]: 		Total: 16.7 minutes
2025-03-09 10:09:13,975 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0001 secs
2025-03-09 10:09:13,975 [INFO]: 	Checking that your have enough memory available to create the index 03/09/2025, 10:09:13
2025-03-09 10:09:13,975 [INFO]: 1.7GB of memory will be needed to build the index (more might be used if you have more)
2025-03-09 10:09:13,975 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0001 secs
2025-03-09 10:09:13,975 [INFO]: 	Selecting most promising index types given data characteristics 03/09/2025, 10:09:13
2025-03-09 10:09:13,975 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-09 10:09:13,976 [INFO]: 	Creating the index 03/09/2025, 10:09:13
2025-03-09 10:09:13,976 [INFO]: 		-> Instanciate the index HNSW15 03/09/2025, 10:09:13
2025-03-09 10:09:13,976 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0009 secs
2025-03-09 10:09:13,977 [INFO]: 		-> Adding the vectors to the index 03/09/2025, 10:09:13
2025-03-09 10:09:13,977 [INFO]: The memory available for adding the vectors is 48.5GB(total available - used by the index)
2025-03-09 10:09:13,977 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/34 [00:00<?, ?it/s]  3%|▎         | 1/34 [00:00<00:04,  7.85it/s] 21%|██        | 7/34 [00:00<00:00, 35.21it/s] 41%|████      | 14/34 [00:00<00:00, 47.20it/s] 62%|██████▏   | 21/34 [00:03<00:02,  4.38it/s] 79%|███████▉  | 27/34 [00:03<00:01,  6.58it/s]100%|██████████| 34/34 [00:06<00:00,  4.36it/s]100%|██████████| 34/34 [00:06<00:00,  5.44it/s]
2025-03-09 10:09:20,226 [INFO]: 	Computing best hyperparameters for index knn.index 03/09/2025, 10:09:20
2025-03-09 10:10:10,512 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 50.2855 secs
2025-03-09 10:10:10,513 [INFO]: The best hyperparameters are: efSearch=213
2025-03-09 10:10:10,513 [INFO]: 	Compute fast metrics 03/09/2025, 10:10:10
  0%|          | 0/4 [00:00<?, ?it/s] 50%|█████     | 2/4 [00:00<00:00, 17.07it/s] 75%|███████▌  | 3/4 [00:00<00:00, 18.49it/s]
2025-03-09 10:10:27,570 [INFO]: 	>>> Finished "Compute fast metrics" in 17.0572 secs
2025-03-09 10:10:27,572 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 73.5950 secs
2025-03-09 10:10:27,572 [INFO]: {
2025-03-09 10:10:27,572 [INFO]: 	index_key: HNSW15
2025-03-09 10:10:27,572 [INFO]: 	index_param: efSearch=213
2025-03-09 10:10:27,572 [INFO]: 	index_path: knn.index
2025-03-09 10:10:27,572 [INFO]: 	size in bytes: 1617236590
2025-03-09 10:10:27,572 [INFO]: 	avg_search_speed_ms: 9.745379392017718
2025-03-09 10:10:27,572 [INFO]: 	99p_search_speed_ms: 17.18437485396862
2025-03-09 10:10:27,572 [INFO]: 	reconstruction error %: 0.0
2025-03-09 10:10:27,572 [INFO]: 	nb vectors: 8220
2025-03-09 10:10:27,572 [INFO]: 	vectors dimension: 49152
2025-03-09 10:10:27,572 [INFO]: 	compression ratio: 0.9993081840919763
2025-03-09 10:10:27,572 [INFO]: }
2025-03-09 10:10:27,572 [INFO]: 	>>> Finished "Creating the index" in 73.5963 secs
2025-03-09 10:10:27,572 [INFO]: >>> Finished "Launching the whole pipeline" in 73.6262 secs
2025-03-09 10:10:31: [retrieval_preprocessing] calculating distances ...
2025-03-09 10:10:33: [retrieval_preprocessing] finished and saved retrieval indices for episode 41122 [episode count 18/20]
[retrieval_preprocessing] for episode 95018 [episode count 19/20], we have num_retrieval=np.int64(8659) num_query=np.int64(331)
2025-03-09 10:10:34,145 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-09 10:10:35,209 [INFO]: Launching the whole pipeline 03/09/2025, 10:10:35
2025-03-09 10:10:35,210 [INFO]: Reading total number of vectors and dimension 03/09/2025, 10:10:35
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1640.32it/s]
2025-03-09 10:10:35,248 [INFO]: There are 8659 embeddings of dim 49152
2025-03-09 10:10:35,249 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0392 secs
2025-03-09 10:10:35,249 [INFO]: 	Compute estimated construction time of the index 03/09/2025, 10:10:35
2025-03-09 10:10:35,249 [INFO]: 		-> Train: 16.7 minutes
2025-03-09 10:10:35,249 [INFO]: 		-> Add: 4.8 seconds
2025-03-09 10:10:35,249 [INFO]: 		Total: 16.7 minutes
2025-03-09 10:10:35,250 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0003 secs
2025-03-09 10:10:35,250 [INFO]: 	Checking that your have enough memory available to create the index 03/09/2025, 10:10:35
2025-03-09 10:10:35,250 [INFO]: 1.7GB of memory will be needed to build the index (more might be used if you have more)
2025-03-09 10:10:35,250 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0004 secs
2025-03-09 10:10:35,250 [INFO]: 	Selecting most promising index types given data characteristics 03/09/2025, 10:10:35
2025-03-09 10:10:35,250 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-09 10:10:35,250 [INFO]: 	Creating the index 03/09/2025, 10:10:35
2025-03-09 10:10:35,250 [INFO]: 		-> Instanciate the index HNSW15 03/09/2025, 10:10:35
2025-03-09 10:10:35,254 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0030 secs
2025-03-09 10:10:35,254 [INFO]: 		-> Adding the vectors to the index 03/09/2025, 10:10:35
2025-03-09 10:10:35,254 [INFO]: The memory available for adding the vectors is 48.4GB(total available - used by the index)
2025-03-09 10:10:35,254 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/36 [00:00<?, ?it/s]  3%|▎         | 1/36 [00:00<00:03,  8.98it/s] 17%|█▋        | 6/36 [00:00<00:01, 29.61it/s] 33%|███▎      | 12/36 [00:00<00:00, 40.08it/s] 50%|█████     | 18/36 [00:00<00:00, 44.92it/s] 64%|██████▍   | 23/36 [00:03<00:03,  3.82it/s] 83%|████████▎ | 30/36 [00:04<00:00,  6.28it/s]100%|██████████| 36/36 [00:06<00:00,  3.91it/s]100%|██████████| 36/36 [00:06<00:00,  5.35it/s]
2025-03-09 10:10:41,984 [INFO]: 	Computing best hyperparameters for index knn.index 03/09/2025, 10:10:41
2025-03-09 10:11:34,657 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 52.6725 secs
2025-03-09 10:11:34,657 [INFO]: The best hyperparameters are: efSearch=188
2025-03-09 10:11:34,657 [INFO]: 	Compute fast metrics 03/09/2025, 10:11:34
  0%|          | 0/4 [00:00<?, ?it/s] 50%|█████     | 2/4 [00:00<00:00, 19.28it/s] 75%|███████▌  | 3/4 [00:00<00:00, 21.39it/s]
2025-03-09 10:11:53,344 [INFO]: 	>>> Finished "Compute fast metrics" in 18.6868 secs
2025-03-09 10:11:53,711 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 78.4569 secs
2025-03-09 10:11:53,711 [INFO]: {
2025-03-09 10:11:53,711 [INFO]: 	index_key: HNSW15
2025-03-09 10:11:53,711 [INFO]: 	index_param: efSearch=188
2025-03-09 10:11:53,711 [INFO]: 	index_path: knn.index
2025-03-09 10:11:53,711 [INFO]: 	size in bytes: 1703606950
2025-03-09 10:11:53,712 [INFO]: 	avg_search_speed_ms: 8.66384852267608
2025-03-09 10:11:53,712 [INFO]: 	99p_search_speed_ms: 15.750149814412001
2025-03-09 10:11:53,712 [INFO]: 	reconstruction error %: 0.0
2025-03-09 10:11:53,712 [INFO]: 	nb vectors: 8659
2025-03-09 10:11:53,712 [INFO]: 	vectors dimension: 49152
2025-03-09 10:11:53,712 [INFO]: 	compression ratio: 0.9993083627652494
2025-03-09 10:11:53,712 [INFO]: }
2025-03-09 10:11:53,712 [INFO]: 	>>> Finished "Creating the index" in 78.4615 secs
2025-03-09 10:11:53,712 [INFO]: >>> Finished "Launching the whole pipeline" in 78.5024 secs
2025-03-09 10:11:55: [retrieval_preprocessing] calculating distances ...
2025-03-09 10:11:56: [retrieval_preprocessing] finished and saved retrieval indices for episode 95018 [episode count 19/20]
2025-03-09 10:11:56: [retrieval_preprocessing] finished for (2370783071, 'block') [chosen_id count 9/10]
2025-03-09 10:11:56: [retrieval_preprocessing] done for embedding_type='embeddings__wrist_image_left'!
