nohup: ignoring input
2025-03-09 06:47:25: got the info dicts: there are 36687 groupings

2025-03-09 06:47:25: number of groupings with atleast 50 episodes [in the first 95658 episodes]: 105

these groupings have chosen_id-->num_episodes as

 {(1297764552, 'bottle'): 53, (2515873443, 'cloth'): 50, (5235850418, 'drawer'): 612, (5879622450, 'block'): 108, (1431810548, 'lid'): 51, (3485794757, 'marker'): 97, (8756300955, 'block'): 117, (1180576306, 'cloth'): 60, (9154343709, 'drawer'): 96, (6498288010, 'bottle'): 138, (8911427557, 'bottle'): 50, (1058976383, 'drawer'): 148, (4045730075, 'lid'): 61, (1712293193, 'marker'): 163, (65137982, 'block'): 100, (4329524892, 'cup'): 166, (484659531, 'marker'): 96, (-1, 'marker'): 1032, (6078642573, 'marker'): 54, (452818143, 'lid'): 221, (1461982682, 'cloth'): 76, (5235850418, 'block'): 97, (7495112204, 'marker'): 102, (666854965, 'marker'): 68, (395700094, 'block'): 72, (3827924651, 'lid'): 67, (6612454114, 'block'): 65, (2782099537, 'marker'): 75, (8376714657, 'marker'): 464, (3452853472, 'drawer'): 91, (9306310171, 'marker'): 97, (3816161570, 'drawer'): 78, (5511329841, 'marker'): 59, (3951366978, 'cup'): 112, (1959308322, 'marker'): 65, (3163748394, 'cup'): 127, (7644292911, 'marker'): 50, (1775582436, 'marker'): 98, (4706041793, 'cloth'): 142, (2370783071, 'block'): 50, (9551783935, 'drawer'): 65, (2782099537, 'cup'): 153, (7489911085, 'cloth'): 179, (5576515039, 'marker'): 50, (4465064685, 'marker'): 198, (9186164821, 'bottle'): 57, (5207831207, 'cup'): 139, (3774560981, 'cloth'): 99, (4823049285, 'bottle'): 234, (9130122211, 'marker'): 159, (6313680013, 'cup'): 50, (9088223759, 'bottle'): 99, (8098563998, 'lid'): 73, (9505766118, 'drawer'): 108, (441689524, 'mug'): 77, (8150285641, 'marker'): 63, (8456936732, 'bottle'): 54, (446878712, 'marker'): 83, (6093644330, 'cloth'): 52, (4345518188, 'lid'): 89, (5024387521, 'marker'): 60, (6498288010, 'lid'): 96, (4823049285, 'block'): 174, (6667529842, 'lid'): 90, (5507987860, 'marker'): 100, (8898968162, 'block'): 58, (-1, 'mug'): 228, (9965421062, 'bottle'): 63, (6357288647, 'lid'): 71, (5701580274, 'marker'): 67, (1469427884, 'marker'): 63, (9933578360, 'drawer'): 53, (1498834123, 'cup'): 77, (440287856, 'drawer'): 75, (376702246, 'cup'): 53, (9883209091, 'mug'): 201, (9934859632, 'marker'): 62, (4312815282, 'marker'): 66, (-1, 'cup'): 113, (8922050678, 'lid'): 64, (2883696971, 'cup'): 69, (9209350647, 'drawer'): 76, (6655265581, 'cup'): 51, (4345518188, 'cloth'): 91, (4545879864, 'marker'): 51, (818725642, 'block'): 63, (3854327802, 'bottle'): 97, (3951366978, 'lid'): 72, (5059283044, 'drawer'): 113, (4846810092, 'cloth'): 93, (8690198922, 'marker'): 65, (1477699675, 'marker'): 89, (4400212150, 'marker'): 52, (1526685371, 'marker'): 62, (6074146895, 'lid'): 59, (8911427557, 'cup'): 112, (8702636502, 'lid'): 90, (8172596608, 'cup'): 51, (1575177183, 'marker'): 59, (5414640868, 'lid'): 56, (1477699675, 'mug'): 57, (9228483020, 'marker'): 80, (2927338332, 'cloth'): 51, (52817038, 'block'): 54, (8815207926, 'block'): 54}
2025-03-09 06:47:26: [retrieval_preprocessing] starting retrieval preprocessing for embeddings__wrist_image_left
2025-03-09 06:47:26: [retrieval_preprocessing] concatenated all embeddings and indices for 20 episodes for (9551783935, 'drawer') [chosen_id count 0/10]
2025-03-09 06:47:26: [retrieval_preprocessing] we have num_total=6050 embedding_dim=49152
[retrieval_preprocessing] for episode 16771 [episode count 0/20], we have num_retrieval=np.int64(5765) num_query=np.int64(285)
2025-03-09 06:47:27,405 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-09 06:47:28,442 [INFO]: Launching the whole pipeline 03/09/2025, 06:47:28
2025-03-09 06:47:28,442 [INFO]: Reading total number of vectors and dimension 03/09/2025, 06:47:28
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 5127.51it/s]
2025-03-09 06:47:28,491 [INFO]: There are 5765 embeddings of dim 49152
2025-03-09 06:47:28,492 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0498 secs
2025-03-09 06:47:28,492 [INFO]: 	Compute estimated construction time of the index 03/09/2025, 06:47:28
2025-03-09 06:47:28,492 [INFO]: 		-> Train: 16.7 minutes
2025-03-09 06:47:28,493 [INFO]: 		-> Add: 3.2 seconds
2025-03-09 06:47:28,493 [INFO]: 		Total: 16.7 minutes
2025-03-09 06:47:28,493 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0004 secs
2025-03-09 06:47:28,493 [INFO]: 	Checking that your have enough memory available to create the index 03/09/2025, 06:47:28
2025-03-09 06:47:28,494 [INFO]: 1.2GB of memory will be needed to build the index (more might be used if you have more)
2025-03-09 06:47:28,494 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0015 secs
2025-03-09 06:47:28,495 [INFO]: 	Selecting most promising index types given data characteristics 03/09/2025, 06:47:28
2025-03-09 06:47:28,495 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-09 06:47:28,495 [INFO]: 	Creating the index 03/09/2025, 06:47:28
2025-03-09 06:47:28,495 [INFO]: 		-> Instanciate the index HNSW15 03/09/2025, 06:47:28
2025-03-09 06:47:28,498 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0028 secs
2025-03-09 06:47:28,498 [INFO]: 		-> Adding the vectors to the index 03/09/2025, 06:47:28
2025-03-09 06:47:28,498 [INFO]: The memory available for adding the vectors is 48.9GB(total available - used by the index)
2025-03-09 06:47:28,498 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/24 [00:00<?, ?it/s]  8%|▊         | 2/24 [00:00<00:01, 19.04it/s] 33%|███▎      | 8/24 [00:00<00:00, 40.18it/s] 58%|█████▊    | 14/24 [00:00<00:00, 46.52it/s] 83%|████████▎ | 20/24 [00:00<00:00, 48.41it/s]100%|██████████| 24/24 [00:04<00:00,  5.38it/s]
2025-03-09 06:47:32,967 [INFO]: 	Computing best hyperparameters for index knn.index 03/09/2025, 06:47:32
2025-03-09 06:48:18,572 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 45.6047 secs
2025-03-09 06:48:18,572 [INFO]: The best hyperparameters are: efSearch=211
2025-03-09 06:48:18,572 [INFO]: 	Compute fast metrics 03/09/2025, 06:48:18
  0%|          | 0/4 [00:00<?, ?it/s] 50%|█████     | 2/4 [00:00<00:00, 16.64it/s] 75%|███████▌  | 3/4 [00:00<00:00, 18.42it/s]
2025-03-09 06:48:31,485 [INFO]: 	>>> Finished "Compute fast metrics" in 12.9130 secs
2025-03-09 06:48:31,486 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 62.9880 secs
2025-03-09 06:48:31,486 [INFO]: {
2025-03-09 06:48:31,486 [INFO]: 	index_key: HNSW15
2025-03-09 06:48:31,486 [INFO]: 	index_param: efSearch=211
2025-03-09 06:48:31,486 [INFO]: 	index_path: knn.index
2025-03-09 06:48:31,486 [INFO]: 	size in bytes: 1134229750
2025-03-09 06:48:31,486 [INFO]: 	avg_search_speed_ms: 8.780341284084637
2025-03-09 06:48:31,486 [INFO]: 	99p_search_speed_ms: 16.451739827170968
2025-03-09 06:48:31,486 [INFO]: 	reconstruction error %: 0.0
2025-03-09 06:48:31,486 [INFO]: 	nb vectors: 5765
2025-03-09 06:48:31,486 [INFO]: 	vectors dimension: 49152
2025-03-09 06:48:31,486 [INFO]: 	compression ratio: 0.9993082265740252
2025-03-09 06:48:31,486 [INFO]: }
2025-03-09 06:48:31,486 [INFO]: 	>>> Finished "Creating the index" in 62.9916 secs
2025-03-09 06:48:31,487 [INFO]: >>> Finished "Launching the whole pipeline" in 63.0446 secs
2025-03-09 06:48:32: [retrieval_preprocessing] calculating distances ...
2025-03-09 06:48:33: [retrieval_preprocessing] finished and saved retrieval indices for episode 16771 [episode count 0/20]
[retrieval_preprocessing] for episode 1669 [episode count 1/20], we have num_retrieval=np.int64(5768) num_query=np.int64(282)
2025-03-09 06:48:34,157 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-09 06:48:34,950 [INFO]: Launching the whole pipeline 03/09/2025, 06:48:34
2025-03-09 06:48:34,950 [INFO]: Reading total number of vectors and dimension 03/09/2025, 06:48:34
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1091.41it/s]
2025-03-09 06:48:34,977 [INFO]: There are 5768 embeddings of dim 49152
2025-03-09 06:48:34,977 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0269 secs
2025-03-09 06:48:34,978 [INFO]: 	Compute estimated construction time of the index 03/09/2025, 06:48:34
2025-03-09 06:48:34,978 [INFO]: 		-> Train: 16.7 minutes
2025-03-09 06:48:34,978 [INFO]: 		-> Add: 3.2 seconds
2025-03-09 06:48:34,978 [INFO]: 		Total: 16.7 minutes
2025-03-09 06:48:34,978 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0003 secs
2025-03-09 06:48:34,978 [INFO]: 	Checking that your have enough memory available to create the index 03/09/2025, 06:48:34
2025-03-09 06:48:34,978 [INFO]: 1.2GB of memory will be needed to build the index (more might be used if you have more)
2025-03-09 06:48:34,979 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0005 secs
2025-03-09 06:48:34,979 [INFO]: 	Selecting most promising index types given data characteristics 03/09/2025, 06:48:34
2025-03-09 06:48:34,979 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-09 06:48:34,979 [INFO]: 	Creating the index 03/09/2025, 06:48:34
2025-03-09 06:48:34,979 [INFO]: 		-> Instanciate the index HNSW15 03/09/2025, 06:48:34
2025-03-09 06:48:34,982 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0026 secs
2025-03-09 06:48:34,982 [INFO]: 		-> Adding the vectors to the index 03/09/2025, 06:48:34
2025-03-09 06:48:34,982 [INFO]: The memory available for adding the vectors is 48.9GB(total available - used by the index)
2025-03-09 06:48:34,982 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/24 [00:00<?, ?it/s]  8%|▊         | 2/24 [00:00<00:01, 18.60it/s] 33%|███▎      | 8/24 [00:00<00:00, 39.92it/s] 58%|█████▊    | 14/24 [00:00<00:00, 46.78it/s] 83%|████████▎ | 20/24 [00:00<00:00, 49.99it/s]100%|██████████| 24/24 [00:05<00:00,  4.53it/s]
2025-03-09 06:48:40,287 [INFO]: 	Computing best hyperparameters for index knn.index 03/09/2025, 06:48:40
2025-03-09 06:49:33,279 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 52.9915 secs
2025-03-09 06:49:33,279 [INFO]: The best hyperparameters are: efSearch=202
2025-03-09 06:49:33,279 [INFO]: 	Compute fast metrics 03/09/2025, 06:49:33
  0%|          | 0/4 [00:00<?, ?it/s] 50%|█████     | 2/4 [00:00<00:00, 18.86it/s] 75%|███████▌  | 3/4 [00:00<00:00, 21.03it/s]
2025-03-09 06:49:46,942 [INFO]: 	>>> Finished "Compute fast metrics" in 13.6634 secs
2025-03-09 06:49:46,943 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 71.9611 secs
2025-03-09 06:49:46,943 [INFO]: {
2025-03-09 06:49:46,943 [INFO]: 	index_key: HNSW15
2025-03-09 06:49:46,943 [INFO]: 	index_param: efSearch=202
2025-03-09 06:49:46,943 [INFO]: 	index_path: knn.index
2025-03-09 06:49:46,943 [INFO]: 	size in bytes: 1134819970
2025-03-09 06:49:46,943 [INFO]: 	avg_search_speed_ms: 10.111105649264038
2025-03-09 06:49:46,943 [INFO]: 	99p_search_speed_ms: 24.70596038736403
2025-03-09 06:49:46,944 [INFO]: 	reconstruction error %: 0.0
2025-03-09 06:49:46,944 [INFO]: 	nb vectors: 5768
2025-03-09 06:49:46,944 [INFO]: 	vectors dimension: 49152
2025-03-09 06:49:46,944 [INFO]: 	compression ratio: 0.9993082374114372
2025-03-09 06:49:46,944 [INFO]: }
2025-03-09 06:49:46,944 [INFO]: 	>>> Finished "Creating the index" in 71.9644 secs
2025-03-09 06:49:46,944 [INFO]: >>> Finished "Launching the whole pipeline" in 71.9931 secs
2025-03-09 06:49:48: [retrieval_preprocessing] calculating distances ...
2025-03-09 06:49:49: [retrieval_preprocessing] finished and saved retrieval indices for episode 1669 [episode count 1/20]
[retrieval_preprocessing] for episode 48520 [episode count 2/20], we have num_retrieval=np.int64(5668) num_query=np.int64(382)
2025-03-09 06:49:49,612 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-09 06:49:50,384 [INFO]: Launching the whole pipeline 03/09/2025, 06:49:50
2025-03-09 06:49:50,385 [INFO]: Reading total number of vectors and dimension 03/09/2025, 06:49:50
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1710.56it/s]
2025-03-09 06:49:50,408 [INFO]: There are 5668 embeddings of dim 49152
2025-03-09 06:49:50,408 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0236 secs
2025-03-09 06:49:50,408 [INFO]: 	Compute estimated construction time of the index 03/09/2025, 06:49:50
2025-03-09 06:49:50,408 [INFO]: 		-> Train: 16.7 minutes
2025-03-09 06:49:50,408 [INFO]: 		-> Add: 3.1 seconds
2025-03-09 06:49:50,408 [INFO]: 		Total: 16.7 minutes
2025-03-09 06:49:50,408 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0001 secs
2025-03-09 06:49:50,408 [INFO]: 	Checking that your have enough memory available to create the index 03/09/2025, 06:49:50
2025-03-09 06:49:50,409 [INFO]: 1.1GB of memory will be needed to build the index (more might be used if you have more)
2025-03-09 06:49:50,409 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0001 secs
2025-03-09 06:49:50,409 [INFO]: 	Selecting most promising index types given data characteristics 03/09/2025, 06:49:50
2025-03-09 06:49:50,409 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-09 06:49:50,409 [INFO]: 	Creating the index 03/09/2025, 06:49:50
2025-03-09 06:49:50,409 [INFO]: 		-> Instanciate the index HNSW15 03/09/2025, 06:49:50
2025-03-09 06:49:50,410 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0009 secs
2025-03-09 06:49:50,410 [INFO]: 		-> Adding the vectors to the index 03/09/2025, 06:49:50
2025-03-09 06:49:50,410 [INFO]: The memory available for adding the vectors is 49.0GB(total available - used by the index)
2025-03-09 06:49:50,410 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/24 [00:00<?, ?it/s]  4%|▍         | 1/24 [00:00<00:07,  2.92it/s] 12%|█▎        | 3/24 [00:00<00:02,  7.82it/s] 25%|██▌       | 6/24 [00:00<00:01, 13.96it/s] 50%|█████     | 12/24 [00:00<00:00, 25.86it/s] 75%|███████▌  | 18/24 [00:00<00:00, 33.89it/s] 92%|█████████▏| 22/24 [00:04<00:00,  3.19it/s]100%|██████████| 24/24 [00:06<00:00,  3.96it/s]
2025-03-09 06:49:56,474 [INFO]: 	Computing best hyperparameters for index knn.index 03/09/2025, 06:49:56
2025-03-09 06:50:51,150 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 54.6750 secs
2025-03-09 06:50:51,150 [INFO]: The best hyperparameters are: efSearch=161
2025-03-09 06:50:51,150 [INFO]: 	Compute fast metrics 03/09/2025, 06:50:51
  0%|          | 0/4 [00:00<?, ?it/s] 50%|█████     | 2/4 [00:00<00:00, 19.02it/s] 75%|███████▌  | 3/4 [00:00<00:00, 20.27it/s]
2025-03-09 06:51:04,350 [INFO]: 	>>> Finished "Compute fast metrics" in 13.2002 secs
2025-03-09 06:51:04,352 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 73.9420 secs
2025-03-09 06:51:04,352 [INFO]: {
2025-03-09 06:51:04,352 [INFO]: 	index_key: HNSW15
2025-03-09 06:51:04,352 [INFO]: 	index_param: efSearch=161
2025-03-09 06:51:04,352 [INFO]: 	index_path: knn.index
2025-03-09 06:51:04,352 [INFO]: 	size in bytes: 1115145730
2025-03-09 06:51:04,352 [INFO]: 	avg_search_speed_ms: 8.444119082579729
2025-03-09 06:51:04,352 [INFO]: 	99p_search_speed_ms: 21.45845440682024
2025-03-09 06:51:04,352 [INFO]: 	reconstruction error %: 0.0
2025-03-09 06:51:04,352 [INFO]: 	nb vectors: 5668
2025-03-09 06:51:04,352 [INFO]: 	vectors dimension: 49152
2025-03-09 06:51:04,352 [INFO]: 	compression ratio: 0.9993080850518076
2025-03-09 06:51:04,352 [INFO]: }
2025-03-09 06:51:04,352 [INFO]: 	>>> Finished "Creating the index" in 73.9433 secs
2025-03-09 06:51:04,352 [INFO]: >>> Finished "Launching the whole pipeline" in 73.9675 secs
2025-03-09 06:51:05: [retrieval_preprocessing] calculating distances ...
2025-03-09 06:51:06: [retrieval_preprocessing] finished and saved retrieval indices for episode 48520 [episode count 2/20]
[retrieval_preprocessing] for episode 63754 [episode count 3/20], we have num_retrieval=np.int64(5791) num_query=np.int64(259)
2025-03-09 06:51:07,521 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-09 06:51:08,400 [INFO]: Launching the whole pipeline 03/09/2025, 06:51:08
2025-03-09 06:51:08,400 [INFO]: Reading total number of vectors and dimension 03/09/2025, 06:51:08
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1450.31it/s]
2025-03-09 06:51:08,424 [INFO]: There are 5791 embeddings of dim 49152
2025-03-09 06:51:08,425 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0248 secs
2025-03-09 06:51:08,425 [INFO]: 	Compute estimated construction time of the index 03/09/2025, 06:51:08
2025-03-09 06:51:08,425 [INFO]: 		-> Train: 16.7 minutes
2025-03-09 06:51:08,425 [INFO]: 		-> Add: 3.2 seconds
2025-03-09 06:51:08,425 [INFO]: 		Total: 16.7 minutes
2025-03-09 06:51:08,425 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0001 secs
2025-03-09 06:51:08,425 [INFO]: 	Checking that your have enough memory available to create the index 03/09/2025, 06:51:08
2025-03-09 06:51:08,425 [INFO]: 1.2GB of memory will be needed to build the index (more might be used if you have more)
2025-03-09 06:51:08,425 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0001 secs
2025-03-09 06:51:08,425 [INFO]: 	Selecting most promising index types given data characteristics 03/09/2025, 06:51:08
2025-03-09 06:51:08,425 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-09 06:51:08,425 [INFO]: 	Creating the index 03/09/2025, 06:51:08
2025-03-09 06:51:08,425 [INFO]: 		-> Instanciate the index HNSW15 03/09/2025, 06:51:08
2025-03-09 06:51:08,426 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0010 secs
2025-03-09 06:51:08,426 [INFO]: 		-> Adding the vectors to the index 03/09/2025, 06:51:08
2025-03-09 06:51:08,426 [INFO]: The memory available for adding the vectors is 48.9GB(total available - used by the index)
2025-03-09 06:51:08,426 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/24 [00:00<?, ?it/s]  4%|▍         | 1/24 [00:00<00:02,  8.53it/s] 29%|██▉       | 7/24 [00:00<00:00, 34.86it/s] 54%|█████▍    | 13/24 [00:00<00:00, 44.60it/s] 75%|███████▌  | 18/24 [00:00<00:00, 45.22it/s] 96%|█████████▌| 23/24 [00:04<00:00,  3.36it/s]100%|██████████| 24/24 [00:06<00:00,  3.95it/s]
2025-03-09 06:51:14,510 [INFO]: 	Computing best hyperparameters for index knn.index 03/09/2025, 06:51:14
2025-03-09 06:52:01,420 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 46.9102 secs
2025-03-09 06:52:01,420 [INFO]: The best hyperparameters are: efSearch=210
2025-03-09 06:52:01,420 [INFO]: 	Compute fast metrics 03/09/2025, 06:52:01
  0%|          | 0/4 [00:00<?, ?it/s] 75%|███████▌  | 3/4 [00:00<00:00, 25.66it/s]
2025-03-09 06:52:14,621 [INFO]: 	>>> Finished "Compute fast metrics" in 13.2001 secs
2025-03-09 06:52:14,622 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 66.1956 secs
2025-03-09 06:52:14,622 [INFO]: {
2025-03-09 06:52:14,622 [INFO]: 	index_key: HNSW15
2025-03-09 06:52:14,622 [INFO]: 	index_param: efSearch=210
2025-03-09 06:52:14,622 [INFO]: 	index_path: knn.index
2025-03-09 06:52:14,622 [INFO]: 	size in bytes: 1139345110
2025-03-09 06:52:14,622 [INFO]: 	avg_search_speed_ms: 10.982364688567515
2025-03-09 06:52:14,622 [INFO]: 	99p_search_speed_ms: 19.397147721610953
2025-03-09 06:52:14,622 [INFO]: 	reconstruction error %: 0.0
2025-03-09 06:52:14,622 [INFO]: 	nb vectors: 5791
2025-03-09 06:52:14,622 [INFO]: 	vectors dimension: 49152
2025-03-09 06:52:14,622 [INFO]: 	compression ratio: 0.9993082148744202
2025-03-09 06:52:14,622 [INFO]: }
2025-03-09 06:52:14,622 [INFO]: 	>>> Finished "Creating the index" in 66.1971 secs
2025-03-09 06:52:14,622 [INFO]: >>> Finished "Launching the whole pipeline" in 66.2225 secs
2025-03-09 06:52:16: [retrieval_preprocessing] calculating distances ...
2025-03-09 06:52:17: [retrieval_preprocessing] finished and saved retrieval indices for episode 63754 [episode count 3/20]
[retrieval_preprocessing] for episode 18317 [episode count 4/20], we have num_retrieval=np.int64(5834) num_query=np.int64(216)
2025-03-09 06:52:17,652 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-09 06:52:19,178 [INFO]: Launching the whole pipeline 03/09/2025, 06:52:19
2025-03-09 06:52:19,179 [INFO]: Reading total number of vectors and dimension 03/09/2025, 06:52:19
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1126.29it/s]
2025-03-09 06:52:19,209 [INFO]: There are 5834 embeddings of dim 49152
2025-03-09 06:52:19,210 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0310 secs
2025-03-09 06:52:19,210 [INFO]: 	Compute estimated construction time of the index 03/09/2025, 06:52:19
2025-03-09 06:52:19,210 [INFO]: 		-> Train: 16.7 minutes
2025-03-09 06:52:19,210 [INFO]: 		-> Add: 3.2 seconds
2025-03-09 06:52:19,210 [INFO]: 		Total: 16.7 minutes
2025-03-09 06:52:19,211 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0004 secs
2025-03-09 06:52:19,211 [INFO]: 	Checking that your have enough memory available to create the index 03/09/2025, 06:52:19
2025-03-09 06:52:19,211 [INFO]: 1.2GB of memory will be needed to build the index (more might be used if you have more)
2025-03-09 06:52:19,211 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0005 secs
2025-03-09 06:52:19,211 [INFO]: 	Selecting most promising index types given data characteristics 03/09/2025, 06:52:19
2025-03-09 06:52:19,212 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-09 06:52:19,212 [INFO]: 	Creating the index 03/09/2025, 06:52:19
2025-03-09 06:52:19,212 [INFO]: 		-> Instanciate the index HNSW15 03/09/2025, 06:52:19
2025-03-09 06:52:19,214 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0027 secs
2025-03-09 06:52:19,215 [INFO]: 		-> Adding the vectors to the index 03/09/2025, 06:52:19
2025-03-09 06:52:19,215 [INFO]: The memory available for adding the vectors is 48.9GB(total available - used by the index)
2025-03-09 06:52:19,215 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/24 [00:00<?, ?it/s]  4%|▍         | 1/24 [00:00<00:02,  9.30it/s] 25%|██▌       | 6/24 [00:00<00:00, 28.51it/s] 42%|████▏     | 10/24 [00:00<00:00, 32.85it/s] 58%|█████▊    | 14/24 [00:00<00:00, 34.77it/s] 75%|███████▌  | 18/24 [00:00<00:00, 36.51it/s] 92%|█████████▏| 22/24 [00:04<00:00,  3.03it/s]100%|██████████| 24/24 [00:05<00:00,  4.33it/s]
2025-03-09 06:52:24,768 [INFO]: 	Computing best hyperparameters for index knn.index 03/09/2025, 06:52:24
2025-03-09 06:53:13,847 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 49.0791 secs
2025-03-09 06:53:13,847 [INFO]: The best hyperparameters are: efSearch=196
2025-03-09 06:53:13,847 [INFO]: 	Compute fast metrics 03/09/2025, 06:53:13
  0%|          | 0/4 [00:00<?, ?it/s] 50%|█████     | 2/4 [00:00<00:00, 17.23it/s] 75%|███████▌  | 3/4 [00:00<00:00, 18.31it/s]
2025-03-09 06:53:27,443 [INFO]: 	>>> Finished "Compute fast metrics" in 13.5956 secs
2025-03-09 06:53:27,444 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 68.2291 secs
2025-03-09 06:53:27,444 [INFO]: {
2025-03-09 06:53:27,444 [INFO]: 	index_key: HNSW15
2025-03-09 06:53:27,444 [INFO]: 	index_param: efSearch=196
2025-03-09 06:53:27,444 [INFO]: 	index_path: knn.index
2025-03-09 06:53:27,444 [INFO]: 	size in bytes: 1147805110
2025-03-09 06:53:27,444 [INFO]: 	avg_search_speed_ms: 9.84346268856238
2025-03-09 06:53:27,444 [INFO]: 	99p_search_speed_ms: 16.843942936975512
2025-03-09 06:53:27,444 [INFO]: 	reconstruction error %: 0.0
2025-03-09 06:53:27,444 [INFO]: 	nb vectors: 5834
2025-03-09 06:53:27,444 [INFO]: 	vectors dimension: 49152
2025-03-09 06:53:27,444 [INFO]: 	compression ratio: 0.999308211827006
2025-03-09 06:53:27,444 [INFO]: }
2025-03-09 06:53:27,444 [INFO]: 	>>> Finished "Creating the index" in 68.2325 secs
2025-03-09 06:53:27,444 [INFO]: >>> Finished "Launching the whole pipeline" in 68.2657 secs
2025-03-09 06:53:28: [retrieval_preprocessing] calculating distances ...
2025-03-09 06:53:28: [retrieval_preprocessing] finished and saved retrieval indices for episode 18317 [episode count 4/20]
[retrieval_preprocessing] for episode 48528 [episode count 5/20], we have num_retrieval=np.int64(5602) num_query=np.int64(448)
2025-03-09 06:53:29,400 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-09 06:53:30,158 [INFO]: Launching the whole pipeline 03/09/2025, 06:53:30
2025-03-09 06:53:30,158 [INFO]: Reading total number of vectors and dimension 03/09/2025, 06:53:30
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1485.76it/s]
2025-03-09 06:53:30,183 [INFO]: There are 5602 embeddings of dim 49152
2025-03-09 06:53:30,184 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0252 secs
2025-03-09 06:53:30,184 [INFO]: 	Compute estimated construction time of the index 03/09/2025, 06:53:30
2025-03-09 06:53:30,184 [INFO]: 		-> Train: 16.7 minutes
2025-03-09 06:53:30,184 [INFO]: 		-> Add: 3.1 seconds
2025-03-09 06:53:30,184 [INFO]: 		Total: 16.7 minutes
2025-03-09 06:53:30,184 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0001 secs
2025-03-09 06:53:30,184 [INFO]: 	Checking that your have enough memory available to create the index 03/09/2025, 06:53:30
2025-03-09 06:53:30,184 [INFO]: 1.1GB of memory will be needed to build the index (more might be used if you have more)
2025-03-09 06:53:30,184 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0002 secs
2025-03-09 06:53:30,184 [INFO]: 	Selecting most promising index types given data characteristics 03/09/2025, 06:53:30
2025-03-09 06:53:30,184 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-09 06:53:30,184 [INFO]: 	Creating the index 03/09/2025, 06:53:30
2025-03-09 06:53:30,184 [INFO]: 		-> Instanciate the index HNSW15 03/09/2025, 06:53:30
2025-03-09 06:53:30,185 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0010 secs
2025-03-09 06:53:30,185 [INFO]: 		-> Adding the vectors to the index 03/09/2025, 06:53:30
2025-03-09 06:53:30,185 [INFO]: The memory available for adding the vectors is 49.0GB(total available - used by the index)
2025-03-09 06:53:30,185 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/24 [00:00<?, ?it/s]  4%|▍         | 1/24 [00:00<00:02,  8.31it/s] 25%|██▌       | 6/24 [00:00<00:00, 28.05it/s] 46%|████▌     | 11/24 [00:00<00:00, 36.24it/s] 67%|██████▋   | 16/24 [00:00<00:00, 40.39it/s] 88%|████████▊ | 21/24 [00:04<00:00,  3.24it/s]100%|██████████| 24/24 [00:05<00:00,  3.10it/s]100%|██████████| 24/24 [00:05<00:00,  4.50it/s]
2025-03-09 06:53:35,522 [INFO]: 	Computing best hyperparameters for index knn.index 03/09/2025, 06:53:35
2025-03-09 06:54:21,429 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 45.9070 secs
2025-03-09 06:54:21,429 [INFO]: The best hyperparameters are: efSearch=211
2025-03-09 06:54:21,429 [INFO]: 	Compute fast metrics 03/09/2025, 06:54:21
  0%|          | 0/4 [00:00<?, ?it/s] 50%|█████     | 2/4 [00:00<00:00, 18.46it/s] 75%|███████▌  | 3/4 [00:00<00:00, 19.94it/s]
2025-03-09 06:54:34,219 [INFO]: 	>>> Finished "Compute fast metrics" in 12.7891 secs
2025-03-09 06:54:34,220 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 64.0342 secs
2025-03-09 06:54:34,220 [INFO]: {
2025-03-09 06:54:34,220 [INFO]: 	index_key: HNSW15
2025-03-09 06:54:34,220 [INFO]: 	index_param: efSearch=211
2025-03-09 06:54:34,220 [INFO]: 	index_path: knn.index
2025-03-09 06:54:34,220 [INFO]: 	size in bytes: 1102160710
2025-03-09 06:54:34,220 [INFO]: 	avg_search_speed_ms: 9.318800034428506
2025-03-09 06:54:34,220 [INFO]: 	99p_search_speed_ms: 13.478012131527066
2025-03-09 06:54:34,220 [INFO]: 	reconstruction error %: 0.0
2025-03-09 06:54:34,220 [INFO]: 	nb vectors: 5602
2025-03-09 06:54:34,220 [INFO]: 	vectors dimension: 49152
2025-03-09 06:54:34,220 [INFO]: 	compression ratio: 0.9993080010990412
2025-03-09 06:54:34,220 [INFO]: }
2025-03-09 06:54:34,220 [INFO]: 	>>> Finished "Creating the index" in 64.0357 secs
2025-03-09 06:54:34,220 [INFO]: >>> Finished "Launching the whole pipeline" in 64.0615 secs
2025-03-09 06:54:36: [retrieval_preprocessing] calculating distances ...
2025-03-09 06:54:37: [retrieval_preprocessing] finished and saved retrieval indices for episode 48528 [episode count 5/20]
[retrieval_preprocessing] for episode 21777 [episode count 6/20], we have num_retrieval=np.int64(5892) num_query=np.int64(158)
2025-03-09 06:54:38,252 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-09 06:54:39,055 [INFO]: Launching the whole pipeline 03/09/2025, 06:54:39
2025-03-09 06:54:39,055 [INFO]: Reading total number of vectors and dimension 03/09/2025, 06:54:39
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1796.28it/s]
2025-03-09 06:54:39,078 [INFO]: There are 5892 embeddings of dim 49152
2025-03-09 06:54:39,078 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0236 secs
2025-03-09 06:54:39,079 [INFO]: 	Compute estimated construction time of the index 03/09/2025, 06:54:39
2025-03-09 06:54:39,079 [INFO]: 		-> Train: 16.7 minutes
2025-03-09 06:54:39,079 [INFO]: 		-> Add: 3.2 seconds
2025-03-09 06:54:39,079 [INFO]: 		Total: 16.7 minutes
2025-03-09 06:54:39,079 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0001 secs
2025-03-09 06:54:39,079 [INFO]: 	Checking that your have enough memory available to create the index 03/09/2025, 06:54:39
2025-03-09 06:54:39,079 [INFO]: 1.2GB of memory will be needed to build the index (more might be used if you have more)
2025-03-09 06:54:39,079 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0002 secs
2025-03-09 06:54:39,079 [INFO]: 	Selecting most promising index types given data characteristics 03/09/2025, 06:54:39
2025-03-09 06:54:39,079 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-09 06:54:39,079 [INFO]: 	Creating the index 03/09/2025, 06:54:39
2025-03-09 06:54:39,079 [INFO]: 		-> Instanciate the index HNSW15 03/09/2025, 06:54:39
2025-03-09 06:54:39,080 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0009 secs
2025-03-09 06:54:39,080 [INFO]: 		-> Adding the vectors to the index 03/09/2025, 06:54:39
2025-03-09 06:54:39,080 [INFO]: The memory available for adding the vectors is 48.9GB(total available - used by the index)
2025-03-09 06:54:39,080 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/25 [00:00<?, ?it/s]  4%|▍         | 1/25 [00:00<00:02,  9.10it/s] 24%|██▍       | 6/25 [00:00<00:00, 31.64it/s] 44%|████▍     | 11/25 [00:00<00:00, 39.20it/s] 64%|██████▍   | 16/25 [00:00<00:00, 42.86it/s] 84%|████████▍ | 21/25 [00:03<00:01,  3.55it/s]100%|██████████| 25/25 [00:05<00:00,  3.29it/s]100%|██████████| 25/25 [00:05<00:00,  4.73it/s]
2025-03-09 06:54:44,372 [INFO]: 	Computing best hyperparameters for index knn.index 03/09/2025, 06:54:44
2025-03-09 06:55:34,049 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 49.6764 secs
2025-03-09 06:55:34,050 [INFO]: The best hyperparameters are: efSearch=100
2025-03-09 06:55:34,050 [INFO]: 	Compute fast metrics 03/09/2025, 06:55:34
  0%|          | 0/4 [00:00<?, ?it/s] 25%|██▌       | 1/4 [00:00<00:00,  8.96it/s] 75%|███████▌  | 3/4 [00:00<00:00, 17.63it/s]
2025-03-09 06:55:47,521 [INFO]: 	>>> Finished "Compute fast metrics" in 13.4705 secs
2025-03-09 06:55:47,522 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 68.4415 secs
2025-03-09 06:55:47,522 [INFO]: {
2025-03-09 06:55:47,522 [INFO]: 	index_key: HNSW15
2025-03-09 06:55:47,522 [INFO]: 	index_param: efSearch=100
2025-03-09 06:55:47,522 [INFO]: 	index_path: knn.index
2025-03-09 06:55:47,522 [INFO]: 	size in bytes: 1159216210
2025-03-09 06:55:47,522 [INFO]: 	avg_search_speed_ms: 5.83578111773484
2025-03-09 06:55:47,522 [INFO]: 	99p_search_speed_ms: 15.060919225215907
2025-03-09 06:55:47,522 [INFO]: 	reconstruction error %: 0.0
2025-03-09 06:55:47,522 [INFO]: 	nb vectors: 5892
2025-03-09 06:55:47,522 [INFO]: 	vectors dimension: 49152
2025-03-09 06:55:47,522 [INFO]: 	compression ratio: 0.9993082619160407
2025-03-09 06:55:47,522 [INFO]: }
2025-03-09 06:55:47,522 [INFO]: 	>>> Finished "Creating the index" in 68.4428 secs
2025-03-09 06:55:47,522 [INFO]: >>> Finished "Launching the whole pipeline" in 68.4671 secs
2025-03-09 06:55:47: [retrieval_preprocessing] calculating distances ...
2025-03-09 06:55:48: [retrieval_preprocessing] finished and saved retrieval indices for episode 21777 [episode count 6/20]
[retrieval_preprocessing] for episode 50963 [episode count 7/20], we have num_retrieval=np.int64(5879) num_query=np.int64(171)
2025-03-09 06:55:49,130 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-09 06:55:50,012 [INFO]: Launching the whole pipeline 03/09/2025, 06:55:50
2025-03-09 06:55:50,012 [INFO]: Reading total number of vectors and dimension 03/09/2025, 06:55:50
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1020.26it/s]
2025-03-09 06:55:50,038 [INFO]: There are 5879 embeddings of dim 49152
2025-03-09 06:55:50,038 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0262 secs
2025-03-09 06:55:50,038 [INFO]: 	Compute estimated construction time of the index 03/09/2025, 06:55:50
2025-03-09 06:55:50,038 [INFO]: 		-> Train: 16.7 minutes
2025-03-09 06:55:50,038 [INFO]: 		-> Add: 3.2 seconds
2025-03-09 06:55:50,038 [INFO]: 		Total: 16.7 minutes
2025-03-09 06:55:50,038 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0001 secs
2025-03-09 06:55:50,038 [INFO]: 	Checking that your have enough memory available to create the index 03/09/2025, 06:55:50
2025-03-09 06:55:50,039 [INFO]: 1.2GB of memory will be needed to build the index (more might be used if you have more)
2025-03-09 06:55:50,039 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0002 secs
2025-03-09 06:55:50,039 [INFO]: 	Selecting most promising index types given data characteristics 03/09/2025, 06:55:50
2025-03-09 06:55:50,039 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-09 06:55:50,039 [INFO]: 	Creating the index 03/09/2025, 06:55:50
2025-03-09 06:55:50,039 [INFO]: 		-> Instanciate the index HNSW15 03/09/2025, 06:55:50
2025-03-09 06:55:50,040 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0009 secs
2025-03-09 06:55:50,040 [INFO]: 		-> Adding the vectors to the index 03/09/2025, 06:55:50
2025-03-09 06:55:50,040 [INFO]: The memory available for adding the vectors is 48.9GB(total available - used by the index)
2025-03-09 06:55:50,040 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/25 [00:00<?, ?it/s]  4%|▍         | 1/25 [00:00<00:02,  9.44it/s] 24%|██▍       | 6/25 [00:00<00:00, 28.96it/s] 44%|████▍     | 11/25 [00:00<00:00, 35.31it/s] 64%|██████▍   | 16/25 [00:00<00:00, 38.34it/s] 84%|████████▍ | 21/25 [00:04<00:01,  3.03it/s]100%|██████████| 25/25 [00:06<00:00,  2.73it/s]100%|██████████| 25/25 [00:06<00:00,  3.96it/s]
2025-03-09 06:55:56,349 [INFO]: 	Computing best hyperparameters for index knn.index 03/09/2025, 06:55:56
2025-03-09 06:56:53,814 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 57.4644 secs
2025-03-09 06:56:53,814 [INFO]: The best hyperparameters are: efSearch=179
2025-03-09 06:56:53,814 [INFO]: 	Compute fast metrics 03/09/2025, 06:56:53
  0%|          | 0/4 [00:00<?, ?it/s] 50%|█████     | 2/4 [00:00<00:00, 17.55it/s] 75%|███████▌  | 3/4 [00:00<00:00, 19.78it/s]
2025-03-09 06:57:06,619 [INFO]: 	>>> Finished "Compute fast metrics" in 12.8047 secs
2025-03-09 06:57:06,620 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 76.5801 secs
2025-03-09 06:57:06,620 [INFO]: {
2025-03-09 06:57:06,620 [INFO]: 	index_key: HNSW15
2025-03-09 06:57:06,620 [INFO]: 	index_param: efSearch=179
2025-03-09 06:57:06,620 [INFO]: 	index_path: knn.index
2025-03-09 06:57:06,620 [INFO]: 	size in bytes: 1156658530
2025-03-09 06:57:06,620 [INFO]: 	avg_search_speed_ms: 9.169739797817224
2025-03-09 06:57:06,620 [INFO]: 	99p_search_speed_ms: 21.039296337403353
2025-03-09 06:57:06,620 [INFO]: 	reconstruction error %: 0.0
2025-03-09 06:57:06,620 [INFO]: 	nb vectors: 5879
2025-03-09 06:57:06,620 [INFO]: 	vectors dimension: 49152
2025-03-09 06:57:06,620 [INFO]: 	compression ratio: 0.9993082677564311
2025-03-09 06:57:06,620 [INFO]: }
2025-03-09 06:57:06,620 [INFO]: 	>>> Finished "Creating the index" in 76.5814 secs
2025-03-09 06:57:06,620 [INFO]: >>> Finished "Launching the whole pipeline" in 76.6083 secs
2025-03-09 06:57:07: [retrieval_preprocessing] calculating distances ...
2025-03-09 06:57:07: [retrieval_preprocessing] finished and saved retrieval indices for episode 50963 [episode count 7/20]
[retrieval_preprocessing] for episode 80021 [episode count 8/20], we have num_retrieval=np.int64(5685) num_query=np.int64(365)
2025-03-09 06:57:08,743 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-09 06:57:09,510 [INFO]: Launching the whole pipeline 03/09/2025, 06:57:09
2025-03-09 06:57:09,510 [INFO]: Reading total number of vectors and dimension 03/09/2025, 06:57:09
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1485.76it/s]
2025-03-09 06:57:09,538 [INFO]: There are 5685 embeddings of dim 49152
2025-03-09 06:57:09,538 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0281 secs
2025-03-09 06:57:09,539 [INFO]: 	Compute estimated construction time of the index 03/09/2025, 06:57:09
2025-03-09 06:57:09,539 [INFO]: 		-> Train: 16.7 minutes
2025-03-09 06:57:09,539 [INFO]: 		-> Add: 3.1 seconds
2025-03-09 06:57:09,539 [INFO]: 		Total: 16.7 minutes
2025-03-09 06:57:09,539 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0006 secs
2025-03-09 06:57:09,540 [INFO]: 	Checking that your have enough memory available to create the index 03/09/2025, 06:57:09
2025-03-09 06:57:09,540 [INFO]: 1.1GB of memory will be needed to build the index (more might be used if you have more)
2025-03-09 06:57:09,540 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0004 secs
2025-03-09 06:57:09,540 [INFO]: 	Selecting most promising index types given data characteristics 03/09/2025, 06:57:09
2025-03-09 06:57:09,540 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-09 06:57:09,540 [INFO]: 	Creating the index 03/09/2025, 06:57:09
2025-03-09 06:57:09,541 [INFO]: 		-> Instanciate the index HNSW15 03/09/2025, 06:57:09
2025-03-09 06:57:09,543 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0026 secs
2025-03-09 06:57:09,544 [INFO]: 		-> Adding the vectors to the index 03/09/2025, 06:57:09
2025-03-09 06:57:09,544 [INFO]: The memory available for adding the vectors is 49.0GB(total available - used by the index)
2025-03-09 06:57:09,544 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/24 [00:00<?, ?it/s]  8%|▊         | 2/24 [00:00<00:01, 19.35it/s] 33%|███▎      | 8/24 [00:00<00:00, 40.55it/s] 58%|█████▊    | 14/24 [00:00<00:00, 46.46it/s] 83%|████████▎ | 20/24 [00:00<00:00, 49.56it/s]100%|██████████| 24/24 [00:04<00:00,  4.92it/s]
2025-03-09 06:57:14,428 [INFO]: 	Computing best hyperparameters for index knn.index 03/09/2025, 06:57:14
2025-03-09 06:58:02,910 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 48.4816 secs
2025-03-09 06:58:02,910 [INFO]: The best hyperparameters are: efSearch=199
2025-03-09 06:58:02,910 [INFO]: 	Compute fast metrics 03/09/2025, 06:58:02
  0%|          | 0/4 [00:00<?, ?it/s] 50%|█████     | 2/4 [00:00<00:00, 16.55it/s] 75%|███████▌  | 3/4 [00:00<00:00, 17.64it/s]
2025-03-09 06:58:16,878 [INFO]: 	>>> Finished "Compute fast metrics" in 13.9679 secs
2025-03-09 06:58:16,879 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 67.3353 secs
2025-03-09 06:58:16,879 [INFO]: {
2025-03-09 06:58:16,879 [INFO]: 	index_key: HNSW15
2025-03-09 06:58:16,879 [INFO]: 	index_param: efSearch=199
2025-03-09 06:58:16,879 [INFO]: 	index_path: knn.index
2025-03-09 06:58:16,879 [INFO]: 	size in bytes: 1118490370
2025-03-09 06:58:16,879 [INFO]: 	avg_search_speed_ms: 9.728120037912598
2025-03-09 06:58:16,879 [INFO]: 	99p_search_speed_ms: 15.79751308774577
2025-03-09 06:58:16,879 [INFO]: 	reconstruction error %: 0.0
2025-03-09 06:58:16,879 [INFO]: 	nb vectors: 5685
2025-03-09 06:58:16,879 [INFO]: 	vectors dimension: 49152
2025-03-09 06:58:16,879 [INFO]: 	compression ratio: 0.9993080941769753
2025-03-09 06:58:16,879 [INFO]: }
2025-03-09 06:58:16,879 [INFO]: 	>>> Finished "Creating the index" in 67.3388 secs
2025-03-09 06:58:16,879 [INFO]: >>> Finished "Launching the whole pipeline" in 67.3691 secs
2025-03-09 06:58:18: [retrieval_preprocessing] calculating distances ...
2025-03-09 06:58:19: [retrieval_preprocessing] finished and saved retrieval indices for episode 80021 [episode count 8/20]
[retrieval_preprocessing] for episode 7190 [episode count 9/20], we have num_retrieval=np.int64(5783) num_query=np.int64(267)
2025-03-09 06:58:19,772 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-09 06:58:20,613 [INFO]: Launching the whole pipeline 03/09/2025, 06:58:20
2025-03-09 06:58:20,613 [INFO]: Reading total number of vectors and dimension 03/09/2025, 06:58:20
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 935.39it/s]
2025-03-09 06:58:20,641 [INFO]: There are 5783 embeddings of dim 49152
2025-03-09 06:58:20,641 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0282 secs
2025-03-09 06:58:20,641 [INFO]: 	Compute estimated construction time of the index 03/09/2025, 06:58:20
2025-03-09 06:58:20,641 [INFO]: 		-> Train: 16.7 minutes
2025-03-09 06:58:20,641 [INFO]: 		-> Add: 3.2 seconds
2025-03-09 06:58:20,641 [INFO]: 		Total: 16.7 minutes
2025-03-09 06:58:20,641 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0001 secs
2025-03-09 06:58:20,641 [INFO]: 	Checking that your have enough memory available to create the index 03/09/2025, 06:58:20
2025-03-09 06:58:20,642 [INFO]: 1.2GB of memory will be needed to build the index (more might be used if you have more)
2025-03-09 06:58:20,642 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0002 secs
2025-03-09 06:58:20,642 [INFO]: 	Selecting most promising index types given data characteristics 03/09/2025, 06:58:20
2025-03-09 06:58:20,642 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-09 06:58:20,642 [INFO]: 	Creating the index 03/09/2025, 06:58:20
2025-03-09 06:58:20,642 [INFO]: 		-> Instanciate the index HNSW15 03/09/2025, 06:58:20
2025-03-09 06:58:20,643 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0009 secs
2025-03-09 06:58:20,643 [INFO]: 		-> Adding the vectors to the index 03/09/2025, 06:58:20
2025-03-09 06:58:20,643 [INFO]: The memory available for adding the vectors is 48.9GB(total available - used by the index)
2025-03-09 06:58:20,643 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/24 [00:00<?, ?it/s]  4%|▍         | 1/24 [00:00<00:03,  6.28it/s] 25%|██▌       | 6/24 [00:00<00:00, 24.51it/s] 46%|████▌     | 11/24 [00:00<00:00, 31.77it/s] 67%|██████▋   | 16/24 [00:00<00:00, 35.33it/s] 88%|████████▊ | 21/24 [00:03<00:00,  3.56it/s]100%|██████████| 24/24 [00:05<00:00,  3.24it/s]100%|██████████| 24/24 [00:05<00:00,  4.70it/s]
2025-03-09 06:58:25,750 [INFO]: 	Computing best hyperparameters for index knn.index 03/09/2025, 06:58:25
2025-03-09 06:59:14,592 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 48.8423 secs
2025-03-09 06:59:14,593 [INFO]: The best hyperparameters are: efSearch=186
2025-03-09 06:59:14,593 [INFO]: 	Compute fast metrics 03/09/2025, 06:59:14
  0%|          | 0/4 [00:00<?, ?it/s] 25%|██▌       | 1/4 [00:00<00:00,  9.52it/s] 75%|███████▌  | 3/4 [00:00<00:00, 16.12it/s]
2025-03-09 06:59:27,436 [INFO]: 	>>> Finished "Compute fast metrics" in 12.8436 secs
2025-03-09 06:59:27,437 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 66.7944 secs
2025-03-09 06:59:27,437 [INFO]: {
2025-03-09 06:59:27,437 [INFO]: 	index_key: HNSW15
2025-03-09 06:59:27,438 [INFO]: 	index_param: efSearch=186
2025-03-09 06:59:27,438 [INFO]: 	index_path: knn.index
2025-03-09 06:59:27,438 [INFO]: 	size in bytes: 1137771190
2025-03-09 06:59:27,438 [INFO]: 	avg_search_speed_ms: 8.793303252975132
2025-03-09 06:59:27,438 [INFO]: 	99p_search_speed_ms: 15.291112428531079
2025-03-09 06:59:27,438 [INFO]: 	reconstruction error %: 0.0
2025-03-09 06:59:27,438 [INFO]: 	nb vectors: 5783
2025-03-09 06:59:27,438 [INFO]: 	vectors dimension: 49152
2025-03-09 06:59:27,438 [INFO]: 	compression ratio: 0.9993081860334326
2025-03-09 06:59:27,438 [INFO]: }
2025-03-09 06:59:27,438 [INFO]: 	>>> Finished "Creating the index" in 66.7959 secs
2025-03-09 06:59:27,438 [INFO]: >>> Finished "Launching the whole pipeline" in 66.8247 secs
2025-03-09 06:59:28: [retrieval_preprocessing] calculating distances ...
2025-03-09 06:59:28: [retrieval_preprocessing] finished and saved retrieval indices for episode 7190 [episode count 9/20]
[retrieval_preprocessing] for episode 91413 [episode count 10/20], we have num_retrieval=np.int64(5769) num_query=np.int64(281)
2025-03-09 06:59:29,487 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-09 06:59:30,213 [INFO]: Launching the whole pipeline 03/09/2025, 06:59:30
2025-03-09 06:59:30,213 [INFO]: Reading total number of vectors and dimension 03/09/2025, 06:59:30
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1251.28it/s]
2025-03-09 06:59:30,242 [INFO]: There are 5769 embeddings of dim 49152
2025-03-09 06:59:30,243 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0298 secs
2025-03-09 06:59:30,243 [INFO]: 	Compute estimated construction time of the index 03/09/2025, 06:59:30
2025-03-09 06:59:30,243 [INFO]: 		-> Train: 16.7 minutes
2025-03-09 06:59:30,243 [INFO]: 		-> Add: 3.2 seconds
2025-03-09 06:59:30,243 [INFO]: 		Total: 16.7 minutes
2025-03-09 06:59:30,243 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0003 secs
2025-03-09 06:59:30,243 [INFO]: 	Checking that your have enough memory available to create the index 03/09/2025, 06:59:30
2025-03-09 06:59:30,243 [INFO]: 1.2GB of memory will be needed to build the index (more might be used if you have more)
2025-03-09 06:59:30,244 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0003 secs
2025-03-09 06:59:30,244 [INFO]: 	Selecting most promising index types given data characteristics 03/09/2025, 06:59:30
2025-03-09 06:59:30,244 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-09 06:59:30,244 [INFO]: 	Creating the index 03/09/2025, 06:59:30
2025-03-09 06:59:30,244 [INFO]: 		-> Instanciate the index HNSW15 03/09/2025, 06:59:30
2025-03-09 06:59:30,247 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0026 secs
2025-03-09 06:59:30,247 [INFO]: 		-> Adding the vectors to the index 03/09/2025, 06:59:30
2025-03-09 06:59:30,248 [INFO]: The memory available for adding the vectors is 48.9GB(total available - used by the index)
2025-03-09 06:59:30,248 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/24 [00:00<?, ?it/s]  8%|▊         | 2/24 [00:00<00:01, 18.12it/s] 29%|██▉       | 7/24 [00:00<00:00, 35.44it/s] 50%|█████     | 12/24 [00:00<00:00, 40.76it/s] 71%|███████   | 17/24 [00:00<00:00, 43.44it/s] 92%|█████████▏| 22/24 [00:03<00:00,  3.85it/s]100%|██████████| 24/24 [00:04<00:00,  5.04it/s]
2025-03-09 06:59:35,015 [INFO]: 	Computing best hyperparameters for index knn.index 03/09/2025, 06:59:35
2025-03-09 07:00:24,993 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 49.9772 secs
2025-03-09 07:00:24,993 [INFO]: The best hyperparameters are: efSearch=192
2025-03-09 07:00:24,993 [INFO]: 	Compute fast metrics 03/09/2025, 07:00:24
  0%|          | 0/4 [00:00<?, ?it/s] 50%|█████     | 2/4 [00:00<00:00, 18.71it/s] 75%|███████▌  | 3/4 [00:00<00:00, 20.22it/s]
2025-03-09 07:00:39,410 [INFO]: 	>>> Finished "Compute fast metrics" in 14.4172 secs
2025-03-09 07:00:39,411 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 69.1635 secs
2025-03-09 07:00:39,411 [INFO]: {
2025-03-09 07:00:39,411 [INFO]: 	index_key: HNSW15
2025-03-09 07:00:39,411 [INFO]: 	index_param: efSearch=192
2025-03-09 07:00:39,411 [INFO]: 	index_path: knn.index
2025-03-09 07:00:39,411 [INFO]: 	size in bytes: 1135016710
2025-03-09 07:00:39,411 [INFO]: 	avg_search_speed_ms: 8.140144166835956
2025-03-09 07:00:39,411 [INFO]: 	99p_search_speed_ms: 11.518829157575967
2025-03-09 07:00:39,411 [INFO]: 	reconstruction error %: 0.0
2025-03-09 07:00:39,411 [INFO]: 	nb vectors: 5769
2025-03-09 07:00:39,411 [INFO]: 	vectors dimension: 49152
2025-03-09 07:00:39,411 [INFO]: 	compression ratio: 0.9993082410214031
2025-03-09 07:00:39,411 [INFO]: }
2025-03-09 07:00:39,411 [INFO]: 	>>> Finished "Creating the index" in 69.1670 secs
2025-03-09 07:00:39,411 [INFO]: >>> Finished "Launching the whole pipeline" in 69.1986 secs
2025-03-09 07:00:40: [retrieval_preprocessing] calculating distances ...
2025-03-09 07:00:41: [retrieval_preprocessing] finished and saved retrieval indices for episode 91413 [episode count 10/20]
[retrieval_preprocessing] for episode 92568 [episode count 11/20], we have num_retrieval=np.int64(5766) num_query=np.int64(284)
2025-03-09 07:00:41,867 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-09 07:00:42,633 [INFO]: Launching the whole pipeline 03/09/2025, 07:00:42
2025-03-09 07:00:42,633 [INFO]: Reading total number of vectors and dimension 03/09/2025, 07:00:42
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1557.48it/s]
2025-03-09 07:00:42,660 [INFO]: There are 5766 embeddings of dim 49152
2025-03-09 07:00:42,660 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0270 secs
2025-03-09 07:00:42,660 [INFO]: 	Compute estimated construction time of the index 03/09/2025, 07:00:42
2025-03-09 07:00:42,660 [INFO]: 		-> Train: 16.7 minutes
2025-03-09 07:00:42,660 [INFO]: 		-> Add: 3.2 seconds
2025-03-09 07:00:42,660 [INFO]: 		Total: 16.7 minutes
2025-03-09 07:00:42,660 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0001 secs
2025-03-09 07:00:42,660 [INFO]: 	Checking that your have enough memory available to create the index 03/09/2025, 07:00:42
2025-03-09 07:00:42,661 [INFO]: 1.2GB of memory will be needed to build the index (more might be used if you have more)
2025-03-09 07:00:42,661 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0002 secs
2025-03-09 07:00:42,661 [INFO]: 	Selecting most promising index types given data characteristics 03/09/2025, 07:00:42
2025-03-09 07:00:42,661 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-09 07:00:42,661 [INFO]: 	Creating the index 03/09/2025, 07:00:42
2025-03-09 07:00:42,661 [INFO]: 		-> Instanciate the index HNSW15 03/09/2025, 07:00:42
2025-03-09 07:00:42,662 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0009 secs
2025-03-09 07:00:42,662 [INFO]: 		-> Adding the vectors to the index 03/09/2025, 07:00:42
2025-03-09 07:00:42,662 [INFO]: The memory available for adding the vectors is 48.9GB(total available - used by the index)
2025-03-09 07:00:42,662 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/24 [00:00<?, ?it/s]  4%|▍         | 1/24 [00:00<00:03,  6.92it/s] 25%|██▌       | 6/24 [00:00<00:00, 27.79it/s] 46%|████▌     | 11/24 [00:00<00:00, 36.34it/s] 67%|██████▋   | 16/24 [00:00<00:00, 40.83it/s] 88%|████████▊ | 21/24 [00:04<00:00,  3.18it/s]100%|██████████| 24/24 [00:05<00:00,  2.95it/s]100%|██████████| 24/24 [00:05<00:00,  4.31it/s]
2025-03-09 07:00:48,230 [INFO]: 	Computing best hyperparameters for index knn.index 03/09/2025, 07:00:48
2025-03-09 07:01:35,877 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 47.6461 secs
2025-03-09 07:01:35,877 [INFO]: The best hyperparameters are: efSearch=225
2025-03-09 07:01:35,877 [INFO]: 	Compute fast metrics 03/09/2025, 07:01:35
  0%|          | 0/4 [00:00<?, ?it/s] 50%|█████     | 2/4 [00:00<00:00, 18.11it/s] 75%|███████▌  | 3/4 [00:00<00:00, 19.67it/s]
2025-03-09 07:01:48,611 [INFO]: 	>>> Finished "Compute fast metrics" in 12.7333 secs
2025-03-09 07:01:48,612 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 65.9498 secs
2025-03-09 07:01:48,612 [INFO]: {
2025-03-09 07:01:48,612 [INFO]: 	index_key: HNSW15
2025-03-09 07:01:48,612 [INFO]: 	index_param: efSearch=225
2025-03-09 07:01:48,612 [INFO]: 	index_path: knn.index
2025-03-09 07:01:48,612 [INFO]: 	size in bytes: 1134426490
2025-03-09 07:01:48,612 [INFO]: 	avg_search_speed_ms: 9.223241800385633
2025-03-09 07:01:48,612 [INFO]: 	99p_search_speed_ms: 12.822414338588722
2025-03-09 07:01:48,612 [INFO]: 	reconstruction error %: 0.0
2025-03-09 07:01:48,612 [INFO]: 	nb vectors: 5766
2025-03-09 07:01:48,612 [INFO]: 	vectors dimension: 49152
2025-03-09 07:01:48,612 [INFO]: 	compression ratio: 0.9993082301877488
2025-03-09 07:01:48,612 [INFO]: }
2025-03-09 07:01:48,612 [INFO]: 	>>> Finished "Creating the index" in 65.9511 secs
2025-03-09 07:01:48,612 [INFO]: >>> Finished "Launching the whole pipeline" in 65.9787 secs
2025-03-09 07:01:49: [retrieval_preprocessing] calculating distances ...
2025-03-09 07:01:50: [retrieval_preprocessing] finished and saved retrieval indices for episode 92568 [episode count 11/20]
[retrieval_preprocessing] for episode 19353 [episode count 12/20], we have num_retrieval=np.int64(5766) num_query=np.int64(284)
2025-03-09 07:01:50,827 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-09 07:01:51,620 [INFO]: Launching the whole pipeline 03/09/2025, 07:01:51
2025-03-09 07:01:51,620 [INFO]: Reading total number of vectors and dimension 03/09/2025, 07:01:51
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1913.46it/s]
2025-03-09 07:01:51,646 [INFO]: There are 5766 embeddings of dim 49152
2025-03-09 07:01:51,646 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0255 secs
2025-03-09 07:01:51,646 [INFO]: 	Compute estimated construction time of the index 03/09/2025, 07:01:51
2025-03-09 07:01:51,646 [INFO]: 		-> Train: 16.7 minutes
2025-03-09 07:01:51,647 [INFO]: 		-> Add: 3.2 seconds
2025-03-09 07:01:51,647 [INFO]: 		Total: 16.7 minutes
2025-03-09 07:01:51,647 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0004 secs
2025-03-09 07:01:51,647 [INFO]: 	Checking that your have enough memory available to create the index 03/09/2025, 07:01:51
2025-03-09 07:01:51,647 [INFO]: 1.2GB of memory will be needed to build the index (more might be used if you have more)
2025-03-09 07:01:51,647 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0004 secs
2025-03-09 07:01:51,648 [INFO]: 	Selecting most promising index types given data characteristics 03/09/2025, 07:01:51
2025-03-09 07:01:51,648 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-09 07:01:51,648 [INFO]: 	Creating the index 03/09/2025, 07:01:51
2025-03-09 07:01:51,648 [INFO]: 		-> Instanciate the index HNSW15 03/09/2025, 07:01:51
2025-03-09 07:01:51,651 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0027 secs
2025-03-09 07:01:51,651 [INFO]: 		-> Adding the vectors to the index 03/09/2025, 07:01:51
2025-03-09 07:01:51,651 [INFO]: The memory available for adding the vectors is 48.9GB(total available - used by the index)
2025-03-09 07:01:51,651 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/24 [00:00<?, ?it/s]  8%|▊         | 2/24 [00:00<00:01, 19.35it/s] 33%|███▎      | 8/24 [00:00<00:00, 39.89it/s] 58%|█████▊    | 14/24 [00:00<00:00, 46.07it/s] 83%|████████▎ | 20/24 [00:00<00:00, 48.90it/s]100%|██████████| 24/24 [00:05<00:00,  4.62it/s]
2025-03-09 07:01:56,852 [INFO]: 	Computing best hyperparameters for index knn.index 03/09/2025, 07:01:56
2025-03-09 07:02:47,300 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 50.4484 secs
2025-03-09 07:02:47,301 [INFO]: The best hyperparameters are: efSearch=231
2025-03-09 07:02:47,301 [INFO]: 	Compute fast metrics 03/09/2025, 07:02:47
  0%|          | 0/4 [00:00<?, ?it/s] 50%|█████     | 2/4 [00:00<00:00, 19.80it/s] 75%|███████▌  | 3/4 [00:00<00:00, 21.36it/s]
2025-03-09 07:03:01,234 [INFO]: 	>>> Finished "Compute fast metrics" in 13.9329 secs
2025-03-09 07:03:01,235 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 69.5836 secs
2025-03-09 07:03:01,235 [INFO]: {
2025-03-09 07:03:01,235 [INFO]: 	index_key: HNSW15
2025-03-09 07:03:01,235 [INFO]: 	index_param: efSearch=231
2025-03-09 07:03:01,235 [INFO]: 	index_path: knn.index
2025-03-09 07:03:01,235 [INFO]: 	size in bytes: 1134426490
2025-03-09 07:03:01,235 [INFO]: 	avg_search_speed_ms: 9.36466804029741
2025-03-09 07:03:01,235 [INFO]: 	99p_search_speed_ms: 12.484128053765742
2025-03-09 07:03:01,235 [INFO]: 	reconstruction error %: 0.0
2025-03-09 07:03:01,235 [INFO]: 	nb vectors: 5766
2025-03-09 07:03:01,235 [INFO]: 	vectors dimension: 49152
2025-03-09 07:03:01,235 [INFO]: 	compression ratio: 0.9993082301877488
2025-03-09 07:03:01,235 [INFO]: }
2025-03-09 07:03:01,235 [INFO]: 	>>> Finished "Creating the index" in 69.5872 secs
2025-03-09 07:03:01,235 [INFO]: >>> Finished "Launching the whole pipeline" in 69.6147 secs
2025-03-09 07:03:03: [retrieval_preprocessing] calculating distances ...
2025-03-09 07:03:04: [retrieval_preprocessing] finished and saved retrieval indices for episode 19353 [episode count 12/20]
[retrieval_preprocessing] for episode 50208 [episode count 13/20], we have num_retrieval=np.int64(5722) num_query=np.int64(328)
2025-03-09 07:03:04,532 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-09 07:03:05,339 [INFO]: Launching the whole pipeline 03/09/2025, 07:03:05
2025-03-09 07:03:05,339 [INFO]: Reading total number of vectors and dimension 03/09/2025, 07:03:05
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1140.69it/s]
2025-03-09 07:03:05,364 [INFO]: There are 5722 embeddings of dim 49152
2025-03-09 07:03:05,365 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0257 secs
2025-03-09 07:03:05,365 [INFO]: 	Compute estimated construction time of the index 03/09/2025, 07:03:05
2025-03-09 07:03:05,365 [INFO]: 		-> Train: 16.7 minutes
2025-03-09 07:03:05,365 [INFO]: 		-> Add: 3.1 seconds
2025-03-09 07:03:05,365 [INFO]: 		Total: 16.7 minutes
2025-03-09 07:03:05,365 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0001 secs
2025-03-09 07:03:05,365 [INFO]: 	Checking that your have enough memory available to create the index 03/09/2025, 07:03:05
2025-03-09 07:03:05,365 [INFO]: 1.2GB of memory will be needed to build the index (more might be used if you have more)
2025-03-09 07:03:05,365 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0002 secs
2025-03-09 07:03:05,365 [INFO]: 	Selecting most promising index types given data characteristics 03/09/2025, 07:03:05
2025-03-09 07:03:05,365 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-09 07:03:05,365 [INFO]: 	Creating the index 03/09/2025, 07:03:05
2025-03-09 07:03:05,365 [INFO]: 		-> Instanciate the index HNSW15 03/09/2025, 07:03:05
2025-03-09 07:03:05,366 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0010 secs
2025-03-09 07:03:05,366 [INFO]: 		-> Adding the vectors to the index 03/09/2025, 07:03:05
2025-03-09 07:03:05,366 [INFO]: The memory available for adding the vectors is 49.0GB(total available - used by the index)
2025-03-09 07:03:05,366 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/24 [00:00<?, ?it/s]  4%|▍         | 1/24 [00:00<00:03,  7.25it/s] 25%|██▌       | 6/24 [00:00<00:00, 28.56it/s] 46%|████▌     | 11/24 [00:00<00:00, 35.02it/s] 67%|██████▋   | 16/24 [00:00<00:00, 37.85it/s] 88%|████████▊ | 21/24 [00:04<00:01,  2.93it/s]100%|██████████| 24/24 [00:06<00:00,  2.69it/s]100%|██████████| 24/24 [00:06<00:00,  3.96it/s]
2025-03-09 07:03:11,428 [INFO]: 	Computing best hyperparameters for index knn.index 03/09/2025, 07:03:11
2025-03-09 07:04:01,632 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 50.2045 secs
2025-03-09 07:04:01,633 [INFO]: The best hyperparameters are: efSearch=214
2025-03-09 07:04:01,633 [INFO]: 	Compute fast metrics 03/09/2025, 07:04:01
  0%|          | 0/4 [00:00<?, ?it/s] 75%|███████▌  | 3/4 [00:00<00:00, 27.30it/s] 75%|███████▌  | 3/4 [00:00<00:00, 23.33it/s]
2025-03-09 07:04:14,761 [INFO]: 	>>> Finished "Compute fast metrics" in 13.1285 secs
2025-03-09 07:04:14,762 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 69.3959 secs
2025-03-09 07:04:14,762 [INFO]: {
2025-03-09 07:04:14,762 [INFO]: 	index_key: HNSW15
2025-03-09 07:04:14,762 [INFO]: 	index_param: efSearch=214
2025-03-09 07:04:14,762 [INFO]: 	index_path: knn.index
2025-03-09 07:04:14,762 [INFO]: 	size in bytes: 1125769870
2025-03-09 07:04:14,762 [INFO]: 	avg_search_speed_ms: 9.72292152644326
2025-03-09 07:04:14,762 [INFO]: 	99p_search_speed_ms: 14.571599112823607
2025-03-09 07:04:14,762 [INFO]: 	reconstruction error %: 0.0
2025-03-09 07:04:14,762 [INFO]: 	nb vectors: 5722
2025-03-09 07:04:14,763 [INFO]: 	vectors dimension: 49152
2025-03-09 07:04:14,763 [INFO]: 	compression ratio: 0.9993081232490261
2025-03-09 07:04:14,763 [INFO]: }
2025-03-09 07:04:14,763 [INFO]: 	>>> Finished "Creating the index" in 69.3974 secs
2025-03-09 07:04:14,763 [INFO]: >>> Finished "Launching the whole pipeline" in 69.4237 secs
2025-03-09 07:04:16: [retrieval_preprocessing] calculating distances ...
2025-03-09 07:04:17: [retrieval_preprocessing] finished and saved retrieval indices for episode 50208 [episode count 13/20]
[retrieval_preprocessing] for episode 68256 [episode count 14/20], we have num_retrieval=np.int64(5694) num_query=np.int64(356)
2025-03-09 07:04:17,583 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-09 07:04:18,347 [INFO]: Launching the whole pipeline 03/09/2025, 07:04:18
2025-03-09 07:04:18,347 [INFO]: Reading total number of vectors and dimension 03/09/2025, 07:04:18
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1432.48it/s]
2025-03-09 07:04:18,375 [INFO]: There are 5694 embeddings of dim 49152
2025-03-09 07:04:18,375 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0286 secs
2025-03-09 07:04:18,376 [INFO]: 	Compute estimated construction time of the index 03/09/2025, 07:04:18
2025-03-09 07:04:18,376 [INFO]: 		-> Train: 16.7 minutes
2025-03-09 07:04:18,376 [INFO]: 		-> Add: 3.1 seconds
2025-03-09 07:04:18,376 [INFO]: 		Total: 16.7 minutes
2025-03-09 07:04:18,376 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0004 secs
2025-03-09 07:04:18,376 [INFO]: 	Checking that your have enough memory available to create the index 03/09/2025, 07:04:18
2025-03-09 07:04:18,376 [INFO]: 1.1GB of memory will be needed to build the index (more might be used if you have more)
2025-03-09 07:04:18,377 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0005 secs
2025-03-09 07:04:18,377 [INFO]: 	Selecting most promising index types given data characteristics 03/09/2025, 07:04:18
2025-03-09 07:04:18,377 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-09 07:04:18,377 [INFO]: 	Creating the index 03/09/2025, 07:04:18
2025-03-09 07:04:18,377 [INFO]: 		-> Instanciate the index HNSW15 03/09/2025, 07:04:18
2025-03-09 07:04:18,380 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0027 secs
2025-03-09 07:04:18,380 [INFO]: 		-> Adding the vectors to the index 03/09/2025, 07:04:18
2025-03-09 07:04:18,380 [INFO]: The memory available for adding the vectors is 49.0GB(total available - used by the index)
2025-03-09 07:04:18,381 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/24 [00:00<?, ?it/s]  8%|▊         | 2/24 [00:00<00:01, 17.12it/s] 33%|███▎      | 8/24 [00:00<00:00, 38.43it/s] 58%|█████▊    | 14/24 [00:00<00:00, 45.54it/s] 83%|████████▎ | 20/24 [00:00<00:00, 48.85it/s]100%|██████████| 24/24 [00:05<00:00,  4.30it/s]
2025-03-09 07:04:23,973 [INFO]: 	Computing best hyperparameters for index knn.index 03/09/2025, 07:04:23
2025-03-09 07:05:16,261 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 52.2882 secs
2025-03-09 07:05:16,261 [INFO]: The best hyperparameters are: efSearch=208
2025-03-09 07:05:16,261 [INFO]: 	Compute fast metrics 03/09/2025, 07:05:16
  0%|          | 0/4 [00:00<?, ?it/s] 50%|█████     | 2/4 [00:00<00:00, 18.24it/s] 75%|███████▌  | 3/4 [00:00<00:00, 19.75it/s]
2025-03-09 07:05:32,225 [INFO]: 	>>> Finished "Compute fast metrics" in 15.9633 secs
2025-03-09 07:05:32,226 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 73.8456 secs
2025-03-09 07:05:32,226 [INFO]: {
2025-03-09 07:05:32,226 [INFO]: 	index_key: HNSW15
2025-03-09 07:05:32,226 [INFO]: 	index_param: efSearch=208
2025-03-09 07:05:32,226 [INFO]: 	index_path: knn.index
2025-03-09 07:05:32,226 [INFO]: 	size in bytes: 1120261030
2025-03-09 07:05:32,226 [INFO]: 	avg_search_speed_ms: 9.1564658627064
2025-03-09 07:05:32,226 [INFO]: 	99p_search_speed_ms: 13.249903060495843
2025-03-09 07:05:32,226 [INFO]: 	reconstruction error %: 0.0
2025-03-09 07:05:32,226 [INFO]: 	nb vectors: 5694
2025-03-09 07:05:32,226 [INFO]: 	vectors dimension: 49152
2025-03-09 07:05:32,226 [INFO]: 	compression ratio: 0.9993081273210048
2025-03-09 07:05:32,226 [INFO]: }
2025-03-09 07:05:32,226 [INFO]: 	>>> Finished "Creating the index" in 73.8492 secs
2025-03-09 07:05:32,226 [INFO]: >>> Finished "Launching the whole pipeline" in 73.8795 secs
2025-03-09 07:05:33: [retrieval_preprocessing] calculating distances ...
2025-03-09 07:05:35: [retrieval_preprocessing] finished and saved retrieval indices for episode 68256 [episode count 14/20]
[retrieval_preprocessing] for episode 24994 [episode count 15/20], we have num_retrieval=np.int64(5728) num_query=np.int64(322)
2025-03-09 07:05:35,496 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-09 07:05:36,299 [INFO]: Launching the whole pipeline 03/09/2025, 07:05:36
2025-03-09 07:05:36,300 [INFO]: Reading total number of vectors and dimension 03/09/2025, 07:05:36
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1252.40it/s]
2025-03-09 07:05:36,325 [INFO]: There are 5728 embeddings of dim 49152
2025-03-09 07:05:36,325 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0254 secs
2025-03-09 07:05:36,325 [INFO]: 	Compute estimated construction time of the index 03/09/2025, 07:05:36
2025-03-09 07:05:36,325 [INFO]: 		-> Train: 16.7 minutes
2025-03-09 07:05:36,325 [INFO]: 		-> Add: 3.1 seconds
2025-03-09 07:05:36,325 [INFO]: 		Total: 16.7 minutes
2025-03-09 07:05:36,325 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0001 secs
2025-03-09 07:05:36,325 [INFO]: 	Checking that your have enough memory available to create the index 03/09/2025, 07:05:36
2025-03-09 07:05:36,325 [INFO]: 1.2GB of memory will be needed to build the index (more might be used if you have more)
2025-03-09 07:05:36,325 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0001 secs
2025-03-09 07:05:36,325 [INFO]: 	Selecting most promising index types given data characteristics 03/09/2025, 07:05:36
2025-03-09 07:05:36,325 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-09 07:05:36,325 [INFO]: 	Creating the index 03/09/2025, 07:05:36
2025-03-09 07:05:36,326 [INFO]: 		-> Instanciate the index HNSW15 03/09/2025, 07:05:36
2025-03-09 07:05:36,327 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0010 secs
2025-03-09 07:05:36,327 [INFO]: 		-> Adding the vectors to the index 03/09/2025, 07:05:36
2025-03-09 07:05:36,327 [INFO]: The memory available for adding the vectors is 49.0GB(total available - used by the index)
2025-03-09 07:05:36,327 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/24 [00:00<?, ?it/s]  4%|▍         | 1/24 [00:00<00:03,  6.88it/s] 25%|██▌       | 6/24 [00:00<00:00, 27.96it/s] 46%|████▌     | 11/24 [00:00<00:00, 36.79it/s] 67%|██████▋   | 16/24 [00:00<00:00, 40.52it/s] 88%|████████▊ | 21/24 [00:04<00:00,  3.29it/s]100%|██████████| 24/24 [00:05<00:00,  3.00it/s]100%|██████████| 24/24 [00:05<00:00,  4.40it/s]
2025-03-09 07:05:41,784 [INFO]: 	Computing best hyperparameters for index knn.index 03/09/2025, 07:05:41
2025-03-09 07:06:38,496 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 56.7124 secs
2025-03-09 07:06:38,497 [INFO]: The best hyperparameters are: efSearch=197
2025-03-09 07:06:38,497 [INFO]: 	Compute fast metrics 03/09/2025, 07:06:38
  0%|          | 0/4 [00:00<?, ?it/s] 50%|█████     | 2/4 [00:00<00:00, 18.89it/s] 75%|███████▌  | 3/4 [00:00<00:00, 20.57it/s]
2025-03-09 07:06:51,254 [INFO]: 	>>> Finished "Compute fast metrics" in 12.7570 secs
2025-03-09 07:06:51,255 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 74.9279 secs
2025-03-09 07:06:51,255 [INFO]: {
2025-03-09 07:06:51,255 [INFO]: 	index_key: HNSW15
2025-03-09 07:06:51,255 [INFO]: 	index_param: efSearch=197
2025-03-09 07:06:51,255 [INFO]: 	index_path: knn.index
2025-03-09 07:06:51,255 [INFO]: 	size in bytes: 1126950310
2025-03-09 07:06:51,255 [INFO]: 	avg_search_speed_ms: 8.332496104024662
2025-03-09 07:06:51,255 [INFO]: 	99p_search_speed_ms: 11.734860655851662
2025-03-09 07:06:51,255 [INFO]: 	reconstruction error %: 0.0
2025-03-09 07:06:51,255 [INFO]: 	nb vectors: 5728
2025-03-09 07:06:51,255 [INFO]: 	vectors dimension: 49152
2025-03-09 07:06:51,255 [INFO]: 	compression ratio: 0.9993081451834376
2025-03-09 07:06:51,255 [INFO]: }
2025-03-09 07:06:51,255 [INFO]: 	>>> Finished "Creating the index" in 74.9293 secs
2025-03-09 07:06:51,255 [INFO]: >>> Finished "Launching the whole pipeline" in 74.9553 secs
2025-03-09 07:06:52: [retrieval_preprocessing] calculating distances ...
2025-03-09 07:06:53: [retrieval_preprocessing] finished and saved retrieval indices for episode 24994 [episode count 15/20]
[retrieval_preprocessing] for episode 61730 [episode count 16/20], we have num_retrieval=np.int64(5705) num_query=np.int64(345)
2025-03-09 07:06:54,410 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-09 07:06:55,369 [INFO]: Launching the whole pipeline 03/09/2025, 07:06:55
2025-03-09 07:06:55,369 [INFO]: Reading total number of vectors and dimension 03/09/2025, 07:06:55
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1819.65it/s]
2025-03-09 07:06:55,392 [INFO]: There are 5705 embeddings of dim 49152
2025-03-09 07:06:55,392 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0235 secs
2025-03-09 07:06:55,393 [INFO]: 	Compute estimated construction time of the index 03/09/2025, 07:06:55
2025-03-09 07:06:55,393 [INFO]: 		-> Train: 16.7 minutes
2025-03-09 07:06:55,393 [INFO]: 		-> Add: 3.1 seconds
2025-03-09 07:06:55,393 [INFO]: 		Total: 16.7 minutes
2025-03-09 07:06:55,393 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0001 secs
2025-03-09 07:06:55,393 [INFO]: 	Checking that your have enough memory available to create the index 03/09/2025, 07:06:55
2025-03-09 07:06:55,393 [INFO]: 1.1GB of memory will be needed to build the index (more might be used if you have more)
2025-03-09 07:06:55,393 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0001 secs
2025-03-09 07:06:55,393 [INFO]: 	Selecting most promising index types given data characteristics 03/09/2025, 07:06:55
2025-03-09 07:06:55,393 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-09 07:06:55,393 [INFO]: 	Creating the index 03/09/2025, 07:06:55
2025-03-09 07:06:55,393 [INFO]: 		-> Instanciate the index HNSW15 03/09/2025, 07:06:55
2025-03-09 07:06:55,394 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0009 secs
2025-03-09 07:06:55,394 [INFO]: 		-> Adding the vectors to the index 03/09/2025, 07:06:55
2025-03-09 07:06:55,394 [INFO]: The memory available for adding the vectors is 49.0GB(total available - used by the index)
2025-03-09 07:06:55,394 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/24 [00:00<?, ?it/s]  4%|▍         | 1/24 [00:00<00:02,  8.86it/s] 29%|██▉       | 7/24 [00:00<00:00, 34.16it/s] 54%|█████▍    | 13/24 [00:00<00:00, 41.85it/s] 79%|███████▉  | 19/24 [00:00<00:00, 45.41it/s]100%|██████████| 24/24 [00:06<00:00,  2.37it/s]100%|██████████| 24/24 [00:06<00:00,  3.78it/s]
2025-03-09 07:07:01,739 [INFO]: 	Computing best hyperparameters for index knn.index 03/09/2025, 07:07:01
2025-03-09 07:07:49,965 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 48.2249 secs
2025-03-09 07:07:49,965 [INFO]: The best hyperparameters are: efSearch=216
2025-03-09 07:07:49,965 [INFO]: 	Compute fast metrics 03/09/2025, 07:07:49
  0%|          | 0/4 [00:00<?, ?it/s] 25%|██▌       | 1/4 [00:00<00:00,  9.03it/s] 75%|███████▌  | 3/4 [00:00<00:00, 16.77it/s]
2025-03-09 07:08:06,853 [INFO]: 	>>> Finished "Compute fast metrics" in 16.8873 secs
2025-03-09 07:08:06,854 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 71.4598 secs
2025-03-09 07:08:06,854 [INFO]: {
2025-03-09 07:08:06,854 [INFO]: 	index_key: HNSW15
2025-03-09 07:08:06,854 [INFO]: 	index_param: efSearch=216
2025-03-09 07:08:06,854 [INFO]: 	index_path: knn.index
2025-03-09 07:08:06,854 [INFO]: 	size in bytes: 1122425230
2025-03-09 07:08:06,854 [INFO]: 	avg_search_speed_ms: 9.735466429287865
2025-03-09 07:08:06,854 [INFO]: 	99p_search_speed_ms: 25.229320426005874
2025-03-09 07:08:06,854 [INFO]: 	reconstruction error %: 0.0
2025-03-09 07:08:06,854 [INFO]: 	nb vectors: 5705
2025-03-09 07:08:06,854 [INFO]: 	vectors dimension: 49152
2025-03-09 07:08:06,854 [INFO]: 	compression ratio: 0.9993081142696695
2025-03-09 07:08:06,854 [INFO]: }
2025-03-09 07:08:06,854 [INFO]: 	>>> Finished "Creating the index" in 71.4612 secs
2025-03-09 07:08:06,854 [INFO]: >>> Finished "Launching the whole pipeline" in 71.4852 secs
2025-03-09 07:08:07: [retrieval_preprocessing] calculating distances ...
2025-03-09 07:08:09: [retrieval_preprocessing] finished and saved retrieval indices for episode 61730 [episode count 16/20]
[retrieval_preprocessing] for episode 71076 [episode count 17/20], we have num_retrieval=np.int64(5865) num_query=np.int64(185)
2025-03-09 07:08:09,712 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-09 07:08:10,470 [INFO]: Launching the whole pipeline 03/09/2025, 07:08:10
2025-03-09 07:08:10,470 [INFO]: Reading total number of vectors and dimension 03/09/2025, 07:08:10
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1434.93it/s]
2025-03-09 07:08:10,494 [INFO]: There are 5865 embeddings of dim 49152
2025-03-09 07:08:10,494 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0242 secs
2025-03-09 07:08:10,494 [INFO]: 	Compute estimated construction time of the index 03/09/2025, 07:08:10
2025-03-09 07:08:10,494 [INFO]: 		-> Train: 16.7 minutes
2025-03-09 07:08:10,494 [INFO]: 		-> Add: 3.2 seconds
2025-03-09 07:08:10,494 [INFO]: 		Total: 16.7 minutes
2025-03-09 07:08:10,494 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0001 secs
2025-03-09 07:08:10,494 [INFO]: 	Checking that your have enough memory available to create the index 03/09/2025, 07:08:10
2025-03-09 07:08:10,494 [INFO]: 1.2GB of memory will be needed to build the index (more might be used if you have more)
2025-03-09 07:08:10,494 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0001 secs
2025-03-09 07:08:10,494 [INFO]: 	Selecting most promising index types given data characteristics 03/09/2025, 07:08:10
2025-03-09 07:08:10,494 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-09 07:08:10,494 [INFO]: 	Creating the index 03/09/2025, 07:08:10
2025-03-09 07:08:10,495 [INFO]: 		-> Instanciate the index HNSW15 03/09/2025, 07:08:10
2025-03-09 07:08:10,496 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0010 secs
2025-03-09 07:08:10,496 [INFO]: 		-> Adding the vectors to the index 03/09/2025, 07:08:10
2025-03-09 07:08:10,496 [INFO]: The memory available for adding the vectors is 48.9GB(total available - used by the index)
2025-03-09 07:08:10,496 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/25 [00:00<?, ?it/s]  4%|▍         | 1/25 [00:00<00:03,  7.49it/s] 28%|██▊       | 7/25 [00:00<00:00, 33.37it/s] 52%|█████▏    | 13/25 [00:00<00:00, 40.73it/s] 76%|███████▌  | 19/25 [00:00<00:00, 45.09it/s] 96%|█████████▌| 24/25 [00:05<00:00,  3.02it/s]100%|██████████| 25/25 [00:06<00:00,  3.94it/s]
2025-03-09 07:08:16,852 [INFO]: 	Computing best hyperparameters for index knn.index 03/09/2025, 07:08:16
2025-03-09 07:09:13,785 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 56.9327 secs
2025-03-09 07:09:13,785 [INFO]: The best hyperparameters are: efSearch=226
2025-03-09 07:09:13,785 [INFO]: 	Compute fast metrics 03/09/2025, 07:09:13
  0%|          | 0/4 [00:00<?, ?it/s] 25%|██▌       | 1/4 [00:00<00:00,  9.89it/s] 75%|███████▌  | 3/4 [00:00<00:00, 18.59it/s]
2025-03-09 07:09:31,724 [INFO]: 	>>> Finished "Compute fast metrics" in 17.9385 secs
2025-03-09 07:09:31,898 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 81.4025 secs
2025-03-09 07:09:31,899 [INFO]: {
2025-03-09 07:09:31,899 [INFO]: 	index_key: HNSW15
2025-03-09 07:09:31,899 [INFO]: 	index_param: efSearch=226
2025-03-09 07:09:31,899 [INFO]: 	index_path: knn.index
2025-03-09 07:09:31,899 [INFO]: 	size in bytes: 1153904110
2025-03-09 07:09:31,899 [INFO]: 	avg_search_speed_ms: 9.789837540697794
2025-03-09 07:09:31,899 [INFO]: 	99p_search_speed_ms: 20.394576827529804
2025-03-09 07:09:31,899 [INFO]: 	reconstruction error %: 0.0
2025-03-09 07:09:31,899 [INFO]: 	nb vectors: 5865
2025-03-09 07:09:31,899 [INFO]: 	vectors dimension: 49152
2025-03-09 07:09:31,899 [INFO]: 	compression ratio: 0.999308270078005
2025-03-09 07:09:31,899 [INFO]: }
2025-03-09 07:09:31,899 [INFO]: 	>>> Finished "Creating the index" in 81.4047 secs
2025-03-09 07:09:31,899 [INFO]: >>> Finished "Launching the whole pipeline" in 81.4294 secs
2025-03-09 07:09:32: [retrieval_preprocessing] calculating distances ...
2025-03-09 07:09:33: [retrieval_preprocessing] finished and saved retrieval indices for episode 71076 [episode count 17/20]
[retrieval_preprocessing] for episode 23848 [episode count 18/20], we have num_retrieval=np.int64(5853) num_query=np.int64(197)
2025-03-09 07:09:33,837 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-09 07:09:34,685 [INFO]: Launching the whole pipeline 03/09/2025, 07:09:34
2025-03-09 07:09:34,685 [INFO]: Reading total number of vectors and dimension 03/09/2025, 07:09:34
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1075.74it/s]
2025-03-09 07:09:34,712 [INFO]: There are 5853 embeddings of dim 49152
2025-03-09 07:09:34,712 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0268 secs
2025-03-09 07:09:34,712 [INFO]: 	Compute estimated construction time of the index 03/09/2025, 07:09:34
2025-03-09 07:09:34,712 [INFO]: 		-> Train: 16.7 minutes
2025-03-09 07:09:34,712 [INFO]: 		-> Add: 3.2 seconds
2025-03-09 07:09:34,712 [INFO]: 		Total: 16.7 minutes
2025-03-09 07:09:34,712 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0001 secs
2025-03-09 07:09:34,712 [INFO]: 	Checking that your have enough memory available to create the index 03/09/2025, 07:09:34
2025-03-09 07:09:34,713 [INFO]: 1.2GB of memory will be needed to build the index (more might be used if you have more)
2025-03-09 07:09:34,713 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0001 secs
2025-03-09 07:09:34,713 [INFO]: 	Selecting most promising index types given data characteristics 03/09/2025, 07:09:34
2025-03-09 07:09:34,713 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-09 07:09:34,713 [INFO]: 	Creating the index 03/09/2025, 07:09:34
2025-03-09 07:09:34,713 [INFO]: 		-> Instanciate the index HNSW15 03/09/2025, 07:09:34
2025-03-09 07:09:34,714 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0010 secs
2025-03-09 07:09:34,714 [INFO]: 		-> Adding the vectors to the index 03/09/2025, 07:09:34
2025-03-09 07:09:34,714 [INFO]: The memory available for adding the vectors is 48.9GB(total available - used by the index)
2025-03-09 07:09:34,714 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/25 [00:00<?, ?it/s]  4%|▍         | 1/25 [00:00<00:03,  7.90it/s] 20%|██        | 5/25 [00:00<00:00, 22.46it/s] 40%|████      | 10/25 [00:00<00:00, 30.78it/s] 60%|██████    | 15/25 [00:00<00:00, 34.87it/s] 76%|███████▌  | 19/25 [00:00<00:00, 36.09it/s] 92%|█████████▏| 23/25 [00:05<00:00,  2.48it/s]100%|██████████| 25/25 [00:06<00:00,  3.82it/s]
2025-03-09 07:09:41,258 [INFO]: 	Computing best hyperparameters for index knn.index 03/09/2025, 07:09:41
2025-03-09 07:10:34,186 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 52.9281 secs
2025-03-09 07:10:34,186 [INFO]: The best hyperparameters are: efSearch=191
2025-03-09 07:10:34,187 [INFO]: 	Compute fast metrics 03/09/2025, 07:10:34
  0%|          | 0/4 [00:00<?, ?it/s] 25%|██▌       | 1/4 [00:00<00:00,  8.25it/s] 75%|███████▌  | 3/4 [00:00<00:00, 16.20it/s]
2025-03-09 07:10:49,159 [INFO]: 	>>> Finished "Compute fast metrics" in 14.9720 secs
2025-03-09 07:10:49,162 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 74.4478 secs
2025-03-09 07:10:49,162 [INFO]: {
2025-03-09 07:10:49,162 [INFO]: 	index_key: HNSW15
2025-03-09 07:10:49,162 [INFO]: 	index_param: efSearch=191
2025-03-09 07:10:49,162 [INFO]: 	index_path: knn.index
2025-03-09 07:10:49,162 [INFO]: 	size in bytes: 1151543170
2025-03-09 07:10:49,162 [INFO]: 	avg_search_speed_ms: 9.532949478986362
2025-03-09 07:10:49,162 [INFO]: 	99p_search_speed_ms: 21.981622334569693
2025-03-09 07:10:49,162 [INFO]: 	reconstruction error %: 0.0
2025-03-09 07:10:49,162 [INFO]: 	nb vectors: 5853
2025-03-09 07:10:49,162 [INFO]: 	vectors dimension: 49152
2025-03-09 07:10:49,162 [INFO]: 	compression ratio: 0.9993082795150442
2025-03-09 07:10:49,162 [INFO]: }
2025-03-09 07:10:49,162 [INFO]: 	>>> Finished "Creating the index" in 74.4493 secs
2025-03-09 07:10:49,162 [INFO]: >>> Finished "Launching the whole pipeline" in 74.4767 secs
2025-03-09 07:10:50: [retrieval_preprocessing] calculating distances ...
2025-03-09 07:10:50: [retrieval_preprocessing] finished and saved retrieval indices for episode 23848 [episode count 18/20]
[retrieval_preprocessing] for episode 50728 [episode count 19/20], we have num_retrieval=np.int64(5415) num_query=np.int64(635)
2025-03-09 07:10:51,576 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-09 07:10:52,359 [INFO]: Launching the whole pipeline 03/09/2025, 07:10:52
2025-03-09 07:10:52,359 [INFO]: Reading total number of vectors and dimension 03/09/2025, 07:10:52
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1511.46it/s]
2025-03-09 07:10:52,383 [INFO]: There are 5415 embeddings of dim 49152
2025-03-09 07:10:52,383 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0245 secs
2025-03-09 07:10:52,383 [INFO]: 	Compute estimated construction time of the index 03/09/2025, 07:10:52
2025-03-09 07:10:52,384 [INFO]: 		-> Train: 16.7 minutes
2025-03-09 07:10:52,384 [INFO]: 		-> Add: 3.0 seconds
2025-03-09 07:10:52,384 [INFO]: 		Total: 16.7 minutes
2025-03-09 07:10:52,384 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0001 secs
2025-03-09 07:10:52,384 [INFO]: 	Checking that your have enough memory available to create the index 03/09/2025, 07:10:52
2025-03-09 07:10:52,384 [INFO]: 1.1GB of memory will be needed to build the index (more might be used if you have more)
2025-03-09 07:10:52,384 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0001 secs
2025-03-09 07:10:52,384 [INFO]: 	Selecting most promising index types given data characteristics 03/09/2025, 07:10:52
2025-03-09 07:10:52,384 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-09 07:10:52,384 [INFO]: 	Creating the index 03/09/2025, 07:10:52
2025-03-09 07:10:52,384 [INFO]: 		-> Instanciate the index HNSW15 03/09/2025, 07:10:52
2025-03-09 07:10:52,385 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0010 secs
2025-03-09 07:10:52,385 [INFO]: 		-> Adding the vectors to the index 03/09/2025, 07:10:52
2025-03-09 07:10:52,385 [INFO]: The memory available for adding the vectors is 49.0GB(total available - used by the index)
2025-03-09 07:10:52,385 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/23 [00:00<?, ?it/s]  9%|▊         | 2/23 [00:00<00:01, 18.43it/s] 35%|███▍      | 8/23 [00:00<00:00, 39.44it/s] 61%|██████    | 14/23 [00:00<00:00, 46.16it/s] 87%|████████▋ | 20/23 [00:00<00:00, 49.07it/s]100%|██████████| 23/23 [00:05<00:00,  4.33it/s]
2025-03-09 07:10:57,696 [INFO]: 	Computing best hyperparameters for index knn.index 03/09/2025, 07:10:57
2025-03-09 07:11:53,649 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 55.9520 secs
2025-03-09 07:11:53,649 [INFO]: The best hyperparameters are: efSearch=175
2025-03-09 07:11:53,649 [INFO]: 	Compute fast metrics 03/09/2025, 07:11:53
  0%|          | 0/4 [00:00<?, ?it/s] 25%|██▌       | 1/4 [00:00<00:00,  8.84it/s] 75%|███████▌  | 3/4 [00:00<00:00, 16.08it/s]
2025-03-09 07:12:10,977 [INFO]: 	>>> Finished "Compute fast metrics" in 17.3281 secs
2025-03-09 07:12:10,978 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 78.5931 secs
2025-03-09 07:12:10,978 [INFO]: {
2025-03-09 07:12:10,978 [INFO]: 	index_key: HNSW15
2025-03-09 07:12:10,978 [INFO]: 	index_param: efSearch=175
2025-03-09 07:12:10,978 [INFO]: 	index_path: knn.index
2025-03-09 07:12:10,978 [INFO]: 	size in bytes: 1065369550
2025-03-09 07:12:10,978 [INFO]: 	avg_search_speed_ms: 8.718172810913275
2025-03-09 07:12:10,978 [INFO]: 	99p_search_speed_ms: 20.915582994930446
2025-03-09 07:12:10,978 [INFO]: 	reconstruction error %: 0.0
2025-03-09 07:12:10,978 [INFO]: 	nb vectors: 5415
2025-03-09 07:12:10,978 [INFO]: 	vectors dimension: 49152
2025-03-09 07:12:10,978 [INFO]: 	compression ratio: 0.9993080053771013
2025-03-09 07:12:10,978 [INFO]: }
2025-03-09 07:12:10,978 [INFO]: 	>>> Finished "Creating the index" in 78.5944 secs
2025-03-09 07:12:10,978 [INFO]: >>> Finished "Launching the whole pipeline" in 78.6194 secs
2025-03-09 07:12:13: [retrieval_preprocessing] calculating distances ...
2025-03-09 07:12:15: [retrieval_preprocessing] finished and saved retrieval indices for episode 50728 [episode count 19/20]
2025-03-09 07:12:15: [retrieval_preprocessing] finished for (9551783935, 'drawer') [chosen_id count 0/10]
2025-03-09 07:12:17: [retrieval_preprocessing] concatenated all embeddings and indices for 20 episodes for (2782099537, 'cup') [chosen_id count 1/10]
2025-03-09 07:12:17: [retrieval_preprocessing] we have num_total=3063 embedding_dim=49152
[retrieval_preprocessing] for episode 92673 [episode count 0/20], we have num_retrieval=np.int64(2836) num_query=np.int64(227)
2025-03-09 07:12:17,660 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-09 07:12:18,347 [INFO]: Launching the whole pipeline 03/09/2025, 07:12:18
2025-03-09 07:12:18,348 [INFO]: Reading total number of vectors and dimension 03/09/2025, 07:12:18
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1119.68it/s]
2025-03-09 07:12:18,378 [INFO]: There are 2836 embeddings of dim 49152
2025-03-09 07:12:18,378 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0304 secs
2025-03-09 07:12:18,378 [INFO]: 	Compute estimated construction time of the index 03/09/2025, 07:12:18
2025-03-09 07:12:18,378 [INFO]: 		-> Train: 16.7 minutes
2025-03-09 07:12:18,378 [INFO]: 		-> Add: 1.6 seconds
2025-03-09 07:12:18,378 [INFO]: 		Total: 16.7 minutes
2025-03-09 07:12:18,378 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0001 secs
2025-03-09 07:12:18,378 [INFO]: 	Checking that your have enough memory available to create the index 03/09/2025, 07:12:18
2025-03-09 07:12:18,379 [INFO]: 585.3MB of memory will be needed to build the index (more might be used if you have more)
2025-03-09 07:12:18,379 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0002 secs
2025-03-09 07:12:18,379 [INFO]: 	Selecting most promising index types given data characteristics 03/09/2025, 07:12:18
2025-03-09 07:12:18,379 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-09 07:12:18,379 [INFO]: 	Creating the index 03/09/2025, 07:12:18
2025-03-09 07:12:18,379 [INFO]: 		-> Instanciate the index HNSW15 03/09/2025, 07:12:18
2025-03-09 07:12:18,380 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0012 secs
2025-03-09 07:12:18,380 [INFO]: 		-> Adding the vectors to the index 03/09/2025, 07:12:18
2025-03-09 07:12:18,381 [INFO]: The memory available for adding the vectors is 49.5GB(total available - used by the index)
2025-03-09 07:12:18,381 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/12 [00:00<?, ?it/s]  8%|▊         | 1/12 [00:00<00:01,  7.22it/s] 42%|████▏     | 5/12 [00:00<00:00, 22.56it/s] 75%|███████▌  | 9/12 [00:00<00:00, 29.18it/s]100%|██████████| 12/12 [00:02<00:00,  4.43it/s]
2025-03-09 07:12:21,096 [INFO]: 	Computing best hyperparameters for index knn.index 03/09/2025, 07:12:21
2025-03-09 07:12:53,789 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 32.6928 secs
2025-03-09 07:12:53,789 [INFO]: The best hyperparameters are: efSearch=228
2025-03-09 07:12:53,789 [INFO]: 	Compute fast metrics 03/09/2025, 07:12:53
  0%|          | 0/4 [00:00<?, ?it/s] 50%|█████     | 2/4 [00:00<00:00, 17.02it/s] 75%|███████▌  | 3/4 [00:00<00:00, 17.16it/s]
2025-03-09 07:13:06,878 [INFO]: 	>>> Finished "Compute fast metrics" in 13.0891 secs
2025-03-09 07:13:06,880 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 48.4994 secs
2025-03-09 07:13:06,880 [INFO]: {
2025-03-09 07:13:06,880 [INFO]: 	index_key: HNSW15
2025-03-09 07:13:06,880 [INFO]: 	index_param: efSearch=228
2025-03-09 07:13:06,880 [INFO]: 	index_path: knn.index
2025-03-09 07:13:06,880 [INFO]: 	size in bytes: 557965510
2025-03-09 07:13:06,880 [INFO]: 	avg_search_speed_ms: 9.147041609122232
2025-03-09 07:13:06,880 [INFO]: 	99p_search_speed_ms: 20.787387425079928
2025-03-09 07:13:06,880 [INFO]: 	reconstruction error %: 0.0
2025-03-09 07:13:06,880 [INFO]: 	nb vectors: 2836
2025-03-09 07:13:06,880 [INFO]: 	vectors dimension: 49152
2025-03-09 07:13:06,880 [INFO]: 	compression ratio: 0.9993095953188934
2025-03-09 07:13:06,880 [INFO]: }
2025-03-09 07:13:06,880 [INFO]: 	>>> Finished "Creating the index" in 48.5012 secs
2025-03-09 07:13:06,880 [INFO]: >>> Finished "Launching the whole pipeline" in 48.5326 secs
2025-03-09 07:13:08: [retrieval_preprocessing] calculating distances ...
2025-03-09 07:13:08: [retrieval_preprocessing] finished and saved retrieval indices for episode 92673 [episode count 0/20]
[retrieval_preprocessing] for episode 10243 [episode count 1/20], we have num_retrieval=np.int64(2927) num_query=np.int64(136)
2025-03-09 07:13:09,064 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-09 07:13:09,455 [INFO]: Launching the whole pipeline 03/09/2025, 07:13:09
2025-03-09 07:13:09,455 [INFO]: Reading total number of vectors and dimension 03/09/2025, 07:13:09
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1373.38it/s]
2025-03-09 07:13:09,480 [INFO]: There are 2927 embeddings of dim 49152
2025-03-09 07:13:09,480 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0252 secs
2025-03-09 07:13:09,480 [INFO]: 	Compute estimated construction time of the index 03/09/2025, 07:13:09
2025-03-09 07:13:09,480 [INFO]: 		-> Train: 16.7 minutes
2025-03-09 07:13:09,480 [INFO]: 		-> Add: 1.6 seconds
2025-03-09 07:13:09,480 [INFO]: 		Total: 16.7 minutes
2025-03-09 07:13:09,480 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0001 secs
2025-03-09 07:13:09,480 [INFO]: 	Checking that your have enough memory available to create the index 03/09/2025, 07:13:09
2025-03-09 07:13:09,480 [INFO]: 604.1MB of memory will be needed to build the index (more might be used if you have more)
2025-03-09 07:13:09,481 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0002 secs
2025-03-09 07:13:09,481 [INFO]: 	Selecting most promising index types given data characteristics 03/09/2025, 07:13:09
2025-03-09 07:13:09,481 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-09 07:13:09,481 [INFO]: 	Creating the index 03/09/2025, 07:13:09
2025-03-09 07:13:09,481 [INFO]: 		-> Instanciate the index HNSW15 03/09/2025, 07:13:09
2025-03-09 07:13:09,482 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0010 secs
2025-03-09 07:13:09,482 [INFO]: 		-> Adding the vectors to the index 03/09/2025, 07:13:09
2025-03-09 07:13:09,482 [INFO]: The memory available for adding the vectors is 49.5GB(total available - used by the index)
2025-03-09 07:13:09,482 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/12 [00:00<?, ?it/s] 17%|█▋        | 2/12 [00:00<00:00, 19.05it/s] 67%|██████▋   | 8/12 [00:00<00:00, 39.01it/s]100%|██████████| 12/12 [00:02<00:00,  4.63it/s]100%|██████████| 12/12 [00:02<00:00,  5.79it/s]
2025-03-09 07:13:11,559 [INFO]: 	Computing best hyperparameters for index knn.index 03/09/2025, 07:13:11
2025-03-09 07:13:50,457 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 38.8973 secs
2025-03-09 07:13:50,457 [INFO]: The best hyperparameters are: efSearch=233
2025-03-09 07:13:50,457 [INFO]: 	Compute fast metrics 03/09/2025, 07:13:50
  0%|          | 0/4 [00:00<?, ?it/s] 50%|█████     | 2/4 [00:00<00:00, 19.30it/s] 75%|███████▌  | 3/4 [00:00<00:00, 21.25it/s]
2025-03-09 07:14:02,224 [INFO]: 	>>> Finished "Compute fast metrics" in 11.7666 secs
2025-03-09 07:14:02,226 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 52.7441 secs
2025-03-09 07:14:02,226 [INFO]: {
2025-03-09 07:14:02,226 [INFO]: 	index_key: HNSW15
2025-03-09 07:14:02,226 [INFO]: 	index_param: efSearch=233
2025-03-09 07:14:02,226 [INFO]: 	index_path: knn.index
2025-03-09 07:14:02,226 [INFO]: 	size in bytes: 575869030
2025-03-09 07:14:02,226 [INFO]: 	avg_search_speed_ms: 9.163689865063766
2025-03-09 07:14:02,226 [INFO]: 	99p_search_speed_ms: 16.706547676585608
2025-03-09 07:14:02,226 [INFO]: 	reconstruction error %: 0.0
2025-03-09 07:14:02,226 [INFO]: 	nb vectors: 2927
2025-03-09 07:14:02,226 [INFO]: 	vectors dimension: 49152
2025-03-09 07:14:02,226 [INFO]: 	compression ratio: 0.9993098882223272
2025-03-09 07:14:02,226 [INFO]: }
2025-03-09 07:14:02,226 [INFO]: 	>>> Finished "Creating the index" in 52.7457 secs
2025-03-09 07:14:02,226 [INFO]: >>> Finished "Launching the whole pipeline" in 52.7716 secs
2025-03-09 07:14:02: [retrieval_preprocessing] calculating distances ...
2025-03-09 07:14:03: [retrieval_preprocessing] finished and saved retrieval indices for episode 10243 [episode count 1/20]
[retrieval_preprocessing] for episode 27652 [episode count 2/20], we have num_retrieval=np.int64(2896) num_query=np.int64(167)
2025-03-09 07:14:03,670 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-09 07:14:04,038 [INFO]: Launching the whole pipeline 03/09/2025, 07:14:04
2025-03-09 07:14:04,038 [INFO]: Reading total number of vectors and dimension 03/09/2025, 07:14:04
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1316.07it/s]
2025-03-09 07:14:04,063 [INFO]: There are 2896 embeddings of dim 49152
2025-03-09 07:14:04,064 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0251 secs
2025-03-09 07:14:04,064 [INFO]: 	Compute estimated construction time of the index 03/09/2025, 07:14:04
2025-03-09 07:14:04,064 [INFO]: 		-> Train: 16.7 minutes
2025-03-09 07:14:04,064 [INFO]: 		-> Add: 1.6 seconds
2025-03-09 07:14:04,064 [INFO]: 		Total: 16.7 minutes
2025-03-09 07:14:04,064 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0001 secs
2025-03-09 07:14:04,064 [INFO]: 	Checking that your have enough memory available to create the index 03/09/2025, 07:14:04
2025-03-09 07:14:04,064 [INFO]: 597.7MB of memory will be needed to build the index (more might be used if you have more)
2025-03-09 07:14:04,064 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0001 secs
2025-03-09 07:14:04,064 [INFO]: 	Selecting most promising index types given data characteristics 03/09/2025, 07:14:04
2025-03-09 07:14:04,064 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-09 07:14:04,064 [INFO]: 	Creating the index 03/09/2025, 07:14:04
2025-03-09 07:14:04,064 [INFO]: 		-> Instanciate the index HNSW15 03/09/2025, 07:14:04
2025-03-09 07:14:04,065 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0010 secs
2025-03-09 07:14:04,065 [INFO]: 		-> Adding the vectors to the index 03/09/2025, 07:14:04
2025-03-09 07:14:04,065 [INFO]: The memory available for adding the vectors is 49.5GB(total available - used by the index)
2025-03-09 07:14:04,065 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/12 [00:00<?, ?it/s]  8%|▊         | 1/12 [00:00<00:01,  7.17it/s] 50%|█████     | 6/12 [00:00<00:00, 26.75it/s] 92%|█████████▏| 11/12 [00:00<00:00, 35.68it/s]100%|██████████| 12/12 [00:02<00:00,  5.13it/s]
2025-03-09 07:14:06,408 [INFO]: 	Computing best hyperparameters for index knn.index 03/09/2025, 07:14:06
2025-03-09 07:14:43,603 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 37.1946 secs
2025-03-09 07:14:43,604 [INFO]: The best hyperparameters are: efSearch=227
2025-03-09 07:14:43,604 [INFO]: 	Compute fast metrics 03/09/2025, 07:14:43
  0%|          | 0/4 [00:00<?, ?it/s] 75%|███████▌  | 3/4 [00:00<00:00, 25.72it/s] 75%|███████▌  | 3/4 [00:00<00:00, 22.08it/s]
2025-03-09 07:14:55,441 [INFO]: 	>>> Finished "Compute fast metrics" in 11.8371 secs
2025-03-09 07:14:55,443 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 51.3777 secs
2025-03-09 07:14:55,443 [INFO]: {
2025-03-09 07:14:55,443 [INFO]: 	index_key: HNSW15
2025-03-09 07:14:55,443 [INFO]: 	index_param: efSearch=227
2025-03-09 07:14:55,443 [INFO]: 	index_path: knn.index
2025-03-09 07:14:55,443 [INFO]: 	size in bytes: 569770030
2025-03-09 07:14:55,443 [INFO]: 	avg_search_speed_ms: 9.022455968171009
2025-03-09 07:14:55,443 [INFO]: 	99p_search_speed_ms: 21.686723567545467
2025-03-09 07:14:55,443 [INFO]: 	reconstruction error %: 0.0
2025-03-09 07:14:55,443 [INFO]: 	nb vectors: 2896
2025-03-09 07:14:55,443 [INFO]: 	vectors dimension: 49152
2025-03-09 07:14:55,443 [INFO]: 	compression ratio: 0.9993097881964764
2025-03-09 07:14:55,443 [INFO]: }
2025-03-09 07:14:55,443 [INFO]: 	>>> Finished "Creating the index" in 51.3792 secs
2025-03-09 07:14:55,444 [INFO]: >>> Finished "Launching the whole pipeline" in 51.4050 secs
2025-03-09 07:14:56: [retrieval_preprocessing] calculating distances ...
2025-03-09 07:14:56: [retrieval_preprocessing] finished and saved retrieval indices for episode 27652 [episode count 2/20]
[retrieval_preprocessing] for episode 68617 [episode count 3/20], we have num_retrieval=np.int64(2937) num_query=np.int64(126)
2025-03-09 07:14:57,170 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-09 07:14:57,573 [INFO]: Launching the whole pipeline 03/09/2025, 07:14:57
2025-03-09 07:14:57,573 [INFO]: Reading total number of vectors and dimension 03/09/2025, 07:14:57
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1373.38it/s]
2025-03-09 07:14:57,600 [INFO]: There are 2937 embeddings of dim 49152
2025-03-09 07:14:57,601 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0273 secs
2025-03-09 07:14:57,601 [INFO]: 	Compute estimated construction time of the index 03/09/2025, 07:14:57
2025-03-09 07:14:57,601 [INFO]: 		-> Train: 16.7 minutes
2025-03-09 07:14:57,601 [INFO]: 		-> Add: 1.6 seconds
2025-03-09 07:14:57,601 [INFO]: 		Total: 16.7 minutes
2025-03-09 07:14:57,601 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0001 secs
2025-03-09 07:14:57,601 [INFO]: 	Checking that your have enough memory available to create the index 03/09/2025, 07:14:57
2025-03-09 07:14:57,601 [INFO]: 606.1MB of memory will be needed to build the index (more might be used if you have more)
2025-03-09 07:14:57,601 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0003 secs
2025-03-09 07:14:57,601 [INFO]: 	Selecting most promising index types given data characteristics 03/09/2025, 07:14:57
2025-03-09 07:14:57,601 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-09 07:14:57,601 [INFO]: 	Creating the index 03/09/2025, 07:14:57
2025-03-09 07:14:57,601 [INFO]: 		-> Instanciate the index HNSW15 03/09/2025, 07:14:57
2025-03-09 07:14:57,602 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0009 secs
2025-03-09 07:14:57,602 [INFO]: 		-> Adding the vectors to the index 03/09/2025, 07:14:57
2025-03-09 07:14:57,602 [INFO]: The memory available for adding the vectors is 49.5GB(total available - used by the index)
2025-03-09 07:14:57,602 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/12 [00:00<?, ?it/s]  8%|▊         | 1/12 [00:00<00:01,  7.59it/s] 58%|█████▊    | 7/12 [00:00<00:00, 33.19it/s]100%|██████████| 12/12 [00:02<00:00,  4.38it/s]100%|██████████| 12/12 [00:02<00:00,  5.19it/s]
2025-03-09 07:14:59,920 [INFO]: 	Computing best hyperparameters for index knn.index 03/09/2025, 07:14:59
2025-03-09 07:15:43,853 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 43.9328 secs
2025-03-09 07:15:43,853 [INFO]: The best hyperparameters are: efSearch=189
2025-03-09 07:15:43,853 [INFO]: 	Compute fast metrics 03/09/2025, 07:15:43
  0%|          | 0/4 [00:00<?, ?it/s] 50%|█████     | 2/4 [00:00<00:00, 18.51it/s] 75%|███████▌  | 3/4 [00:00<00:00, 20.53it/s]
2025-03-09 07:15:57,057 [INFO]: 	>>> Finished "Compute fast metrics" in 13.2037 secs
2025-03-09 07:15:57,059 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 59.4568 secs
2025-03-09 07:15:57,059 [INFO]: {
2025-03-09 07:15:57,059 [INFO]: 	index_key: HNSW15
2025-03-09 07:15:57,059 [INFO]: 	index_param: efSearch=189
2025-03-09 07:15:57,059 [INFO]: 	index_path: knn.index
2025-03-09 07:15:57,059 [INFO]: 	size in bytes: 577836550
2025-03-09 07:15:57,059 [INFO]: 	avg_search_speed_ms: 7.953575568706355
2025-03-09 07:15:57,059 [INFO]: 	99p_search_speed_ms: 19.323043311014796
2025-03-09 07:15:57,059 [INFO]: 	reconstruction error %: 0.0
2025-03-09 07:15:57,059 [INFO]: 	nb vectors: 2937
2025-03-09 07:15:57,059 [INFO]: 	vectors dimension: 49152
2025-03-09 07:15:57,059 [INFO]: 	compression ratio: 0.9993097459826659
2025-03-09 07:15:57,059 [INFO]: }
2025-03-09 07:15:57,059 [INFO]: 	>>> Finished "Creating the index" in 59.4581 secs
2025-03-09 07:15:57,059 [INFO]: >>> Finished "Launching the whole pipeline" in 59.4861 secs
2025-03-09 07:15:57: [retrieval_preprocessing] calculating distances ...
2025-03-09 07:15:58: [retrieval_preprocessing] finished and saved retrieval indices for episode 68617 [episode count 3/20]
[retrieval_preprocessing] for episode 36377 [episode count 4/20], we have num_retrieval=np.int64(2917) num_query=np.int64(146)
2025-03-09 07:15:58,444 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-09 07:15:58,965 [INFO]: Launching the whole pipeline 03/09/2025, 07:15:58
2025-03-09 07:15:58,965 [INFO]: Reading total number of vectors and dimension 03/09/2025, 07:15:58
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 12.86it/s]
2025-03-09 07:15:59,074 [INFO]: There are 2917 embeddings of dim 49152
2025-03-09 07:15:59,074 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.1089 secs
2025-03-09 07:15:59,075 [INFO]: 	Compute estimated construction time of the index 03/09/2025, 07:15:59
2025-03-09 07:15:59,075 [INFO]: 		-> Train: 16.7 minutes
2025-03-09 07:15:59,075 [INFO]: 		-> Add: 1.6 seconds
2025-03-09 07:15:59,075 [INFO]: 		Total: 16.7 minutes
2025-03-09 07:15:59,075 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0005 secs
2025-03-09 07:15:59,075 [INFO]: 	Checking that your have enough memory available to create the index 03/09/2025, 07:15:59
2025-03-09 07:15:59,076 [INFO]: 602.0MB of memory will be needed to build the index (more might be used if you have more)
2025-03-09 07:15:59,076 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0004 secs
2025-03-09 07:15:59,076 [INFO]: 	Selecting most promising index types given data characteristics 03/09/2025, 07:15:59
2025-03-09 07:15:59,076 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-09 07:15:59,076 [INFO]: 	Creating the index 03/09/2025, 07:15:59
2025-03-09 07:15:59,076 [INFO]: 		-> Instanciate the index HNSW15 03/09/2025, 07:15:59
2025-03-09 07:15:59,079 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0027 secs
2025-03-09 07:15:59,080 [INFO]: 		-> Adding the vectors to the index 03/09/2025, 07:15:59
2025-03-09 07:15:59,080 [INFO]: The memory available for adding the vectors is 49.5GB(total available - used by the index)
2025-03-09 07:15:59,080 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/12 [00:00<?, ?it/s] 17%|█▋        | 2/12 [00:00<00:00, 18.31it/s] 58%|█████▊    | 7/12 [00:00<00:00, 34.99it/s]100%|██████████| 12/12 [00:02<00:00,  4.60it/s]100%|██████████| 12/12 [00:02<00:00,  5.58it/s]
2025-03-09 07:16:01,235 [INFO]: 	Computing best hyperparameters for index knn.index 03/09/2025, 07:16:01
2025-03-09 07:16:30,645 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 29.4098 secs
2025-03-09 07:16:30,645 [INFO]: The best hyperparameters are: efSearch=259
2025-03-09 07:16:30,645 [INFO]: 	Compute fast metrics 03/09/2025, 07:16:30
  0%|          | 0/4 [00:00<?, ?it/s] 50%|█████     | 2/4 [00:00<00:00, 17.85it/s] 75%|███████▌  | 3/4 [00:00<00:00, 17.45it/s]
2025-03-09 07:16:43,332 [INFO]: 	>>> Finished "Compute fast metrics" in 12.6863 secs
2025-03-09 07:16:43,333 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 44.2535 secs
2025-03-09 07:16:43,333 [INFO]: {
2025-03-09 07:16:43,333 [INFO]: 	index_key: HNSW15
2025-03-09 07:16:43,333 [INFO]: 	index_param: efSearch=259
2025-03-09 07:16:43,333 [INFO]: 	index_path: knn.index
2025-03-09 07:16:43,333 [INFO]: 	size in bytes: 573901630
2025-03-09 07:16:43,333 [INFO]: 	avg_search_speed_ms: 9.43563395720151
2025-03-09 07:16:43,333 [INFO]: 	99p_search_speed_ms: 21.320080328732754
2025-03-09 07:16:43,333 [INFO]: 	reconstruction error %: 0.0
2025-03-09 07:16:43,333 [INFO]: 	nb vectors: 2917
2025-03-09 07:16:43,334 [INFO]: 	vectors dimension: 49152
2025-03-09 07:16:43,334 [INFO]: 	compression ratio: 0.9993098224864774
2025-03-09 07:16:43,334 [INFO]: }
2025-03-09 07:16:43,334 [INFO]: 	>>> Finished "Creating the index" in 44.2572 secs
2025-03-09 07:16:43,334 [INFO]: >>> Finished "Launching the whole pipeline" in 44.3681 secs
2025-03-09 07:16:44: [retrieval_preprocessing] calculating distances ...
2025-03-09 07:16:44: [retrieval_preprocessing] finished and saved retrieval indices for episode 36377 [episode count 4/20]
[retrieval_preprocessing] for episode 68128 [episode count 5/20], we have num_retrieval=np.int64(2918) num_query=np.int64(145)
2025-03-09 07:16:44,981 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-09 07:16:45,389 [INFO]: Launching the whole pipeline 03/09/2025, 07:16:45
2025-03-09 07:16:45,389 [INFO]: Reading total number of vectors and dimension 03/09/2025, 07:16:45
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1827.58it/s]
2025-03-09 07:16:45,413 [INFO]: There are 2918 embeddings of dim 49152
2025-03-09 07:16:45,413 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0241 secs
2025-03-09 07:16:45,413 [INFO]: 	Compute estimated construction time of the index 03/09/2025, 07:16:45
2025-03-09 07:16:45,413 [INFO]: 		-> Train: 16.7 minutes
2025-03-09 07:16:45,413 [INFO]: 		-> Add: 1.6 seconds
2025-03-09 07:16:45,413 [INFO]: 		Total: 16.7 minutes
2025-03-09 07:16:45,413 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0002 secs
2025-03-09 07:16:45,413 [INFO]: 	Checking that your have enough memory available to create the index 03/09/2025, 07:16:45
2025-03-09 07:16:45,413 [INFO]: 602.2MB of memory will be needed to build the index (more might be used if you have more)
2025-03-09 07:16:45,413 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0001 secs
2025-03-09 07:16:45,413 [INFO]: 	Selecting most promising index types given data characteristics 03/09/2025, 07:16:45
2025-03-09 07:16:45,413 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-09 07:16:45,413 [INFO]: 	Creating the index 03/09/2025, 07:16:45
2025-03-09 07:16:45,413 [INFO]: 		-> Instanciate the index HNSW15 03/09/2025, 07:16:45
2025-03-09 07:16:45,414 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0009 secs
2025-03-09 07:16:45,414 [INFO]: 		-> Adding the vectors to the index 03/09/2025, 07:16:45
2025-03-09 07:16:45,414 [INFO]: The memory available for adding the vectors is 49.5GB(total available - used by the index)
2025-03-09 07:16:45,415 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/12 [00:00<?, ?it/s] 17%|█▋        | 2/12 [00:00<00:00, 18.97it/s] 67%|██████▋   | 8/12 [00:00<00:00, 39.75it/s]100%|██████████| 12/12 [00:02<00:00,  4.59it/s]100%|██████████| 12/12 [00:02<00:00,  5.74it/s]
2025-03-09 07:16:47,508 [INFO]: 	Computing best hyperparameters for index knn.index 03/09/2025, 07:16:47
2025-03-09 07:17:19,206 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 31.6977 secs
2025-03-09 07:17:19,207 [INFO]: The best hyperparameters are: efSearch=219
2025-03-09 07:17:19,207 [INFO]: 	Compute fast metrics 03/09/2025, 07:17:19
  0%|          | 0/4 [00:00<?, ?it/s] 50%|█████     | 2/4 [00:00<00:00, 17.42it/s] 75%|███████▌  | 3/4 [00:00<00:00, 19.40it/s]
2025-03-09 07:17:32,813 [INFO]: 	>>> Finished "Compute fast metrics" in 13.6059 secs
2025-03-09 07:17:32,814 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 47.3999 secs
2025-03-09 07:17:32,814 [INFO]: {
2025-03-09 07:17:32,815 [INFO]: 	index_key: HNSW15
2025-03-09 07:17:32,815 [INFO]: 	index_param: efSearch=219
2025-03-09 07:17:32,815 [INFO]: 	index_path: knn.index
2025-03-09 07:17:32,815 [INFO]: 	size in bytes: 574098370
2025-03-09 07:17:32,815 [INFO]: 	avg_search_speed_ms: 9.350492872698146
2025-03-09 07:17:32,815 [INFO]: 	99p_search_speed_ms: 22.75819738162679
2025-03-09 07:17:32,815 [INFO]: 	reconstruction error %: 0.0
2025-03-09 07:17:32,815 [INFO]: 	nb vectors: 2918
2025-03-09 07:17:32,815 [INFO]: 	vectors dimension: 49152
2025-03-09 07:17:32,815 [INFO]: 	compression ratio: 0.9993098290803368
2025-03-09 07:17:32,815 [INFO]: }
2025-03-09 07:17:32,815 [INFO]: 	>>> Finished "Creating the index" in 47.4013 secs
2025-03-09 07:17:32,815 [INFO]: >>> Finished "Launching the whole pipeline" in 47.4260 secs
2025-03-09 07:17:33: [retrieval_preprocessing] calculating distances ...
2025-03-09 07:17:33: [retrieval_preprocessing] finished and saved retrieval indices for episode 68128 [episode count 5/20]
[retrieval_preprocessing] for episode 1060 [episode count 6/20], we have num_retrieval=np.int64(2890) num_query=np.int64(173)
2025-03-09 07:17:34,182 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-09 07:17:34,569 [INFO]: Launching the whole pipeline 03/09/2025, 07:17:34
2025-03-09 07:17:34,569 [INFO]: Reading total number of vectors and dimension 03/09/2025, 07:17:34
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1826.79it/s]
2025-03-09 07:17:34,593 [INFO]: There are 2890 embeddings of dim 49152
2025-03-09 07:17:34,593 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0241 secs
2025-03-09 07:17:34,593 [INFO]: 	Compute estimated construction time of the index 03/09/2025, 07:17:34
2025-03-09 07:17:34,593 [INFO]: 		-> Train: 16.7 minutes
2025-03-09 07:17:34,593 [INFO]: 		-> Add: 1.6 seconds
2025-03-09 07:17:34,593 [INFO]: 		Total: 16.7 minutes
2025-03-09 07:17:34,593 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0001 secs
2025-03-09 07:17:34,594 [INFO]: 	Checking that your have enough memory available to create the index 03/09/2025, 07:17:34
2025-03-09 07:17:34,594 [INFO]: 596.4MB of memory will be needed to build the index (more might be used if you have more)
2025-03-09 07:17:34,594 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0001 secs
2025-03-09 07:17:34,594 [INFO]: 	Selecting most promising index types given data characteristics 03/09/2025, 07:17:34
2025-03-09 07:17:34,594 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-09 07:17:34,594 [INFO]: 	Creating the index 03/09/2025, 07:17:34
2025-03-09 07:17:34,594 [INFO]: 		-> Instanciate the index HNSW15 03/09/2025, 07:17:34
2025-03-09 07:17:34,595 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0009 secs
2025-03-09 07:17:34,595 [INFO]: 		-> Adding the vectors to the index 03/09/2025, 07:17:34
2025-03-09 07:17:34,595 [INFO]: The memory available for adding the vectors is 49.5GB(total available - used by the index)
2025-03-09 07:17:34,595 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/12 [00:00<?, ?it/s]  8%|▊         | 1/12 [00:00<00:01,  9.27it/s] 42%|████▏     | 5/12 [00:00<00:00, 26.46it/s] 83%|████████▎ | 10/12 [00:00<00:00, 36.89it/s]100%|██████████| 12/12 [00:02<00:00,  4.75it/s]
2025-03-09 07:17:37,127 [INFO]: 	Computing best hyperparameters for index knn.index 03/09/2025, 07:17:37
2025-03-09 07:18:18,237 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 41.1103 secs
2025-03-09 07:18:18,238 [INFO]: The best hyperparameters are: efSearch=219
2025-03-09 07:18:18,238 [INFO]: 	Compute fast metrics 03/09/2025, 07:18:18
  0%|          | 0/4 [00:00<?, ?it/s] 75%|███████▌  | 3/4 [00:00<00:00, 26.91it/s] 75%|███████▌  | 3/4 [00:00<00:00, 22.83it/s]
2025-03-09 07:18:31,198 [INFO]: 	>>> Finished "Compute fast metrics" in 12.9606 secs
2025-03-09 07:18:31,201 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 56.6059 secs
2025-03-09 07:18:31,201 [INFO]: {
2025-03-09 07:18:31,201 [INFO]: 	index_key: HNSW15
2025-03-09 07:18:31,201 [INFO]: 	index_param: efSearch=219
2025-03-09 07:18:31,201 [INFO]: 	index_path: knn.index
2025-03-09 07:18:31,201 [INFO]: 	size in bytes: 568589590
2025-03-09 07:18:31,201 [INFO]: 	avg_search_speed_ms: 9.73620549630566
2025-03-09 07:18:31,201 [INFO]: 	99p_search_speed_ms: 20.723804808221757
2025-03-09 07:18:31,201 [INFO]: 	reconstruction error %: 0.0
2025-03-09 07:18:31,201 [INFO]: 	nb vectors: 2890
2025-03-09 07:18:31,201 [INFO]: 	vectors dimension: 49152
2025-03-09 07:18:31,201 [INFO]: 	compression ratio: 0.9993097481788226
2025-03-09 07:18:31,201 [INFO]: }
2025-03-09 07:18:31,201 [INFO]: 	>>> Finished "Creating the index" in 56.6077 secs
2025-03-09 07:18:31,202 [INFO]: >>> Finished "Launching the whole pipeline" in 56.6325 secs
2025-03-09 07:18:32: [retrieval_preprocessing] calculating distances ...
2025-03-09 07:18:32: [retrieval_preprocessing] finished and saved retrieval indices for episode 1060 [episode count 6/20]
[retrieval_preprocessing] for episode 71206 [episode count 7/20], we have num_retrieval=np.int64(2934) num_query=np.int64(129)
2025-03-09 07:18:33,203 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-09 07:18:33,854 [INFO]: Launching the whole pipeline 03/09/2025, 07:18:33
2025-03-09 07:18:33,854 [INFO]: Reading total number of vectors and dimension 03/09/2025, 07:18:33
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1204.22it/s]
2025-03-09 07:18:33,894 [INFO]: There are 2934 embeddings of dim 49152
2025-03-09 07:18:33,895 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0408 secs
2025-03-09 07:18:33,895 [INFO]: 	Compute estimated construction time of the index 03/09/2025, 07:18:33
2025-03-09 07:18:33,895 [INFO]: 		-> Train: 16.7 minutes
2025-03-09 07:18:33,895 [INFO]: 		-> Add: 1.6 seconds
2025-03-09 07:18:33,895 [INFO]: 		Total: 16.7 minutes
2025-03-09 07:18:33,895 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0002 secs
2025-03-09 07:18:33,895 [INFO]: 	Checking that your have enough memory available to create the index 03/09/2025, 07:18:33
2025-03-09 07:18:33,896 [INFO]: 605.5MB of memory will be needed to build the index (more might be used if you have more)
2025-03-09 07:18:33,896 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0003 secs
2025-03-09 07:18:33,896 [INFO]: 	Selecting most promising index types given data characteristics 03/09/2025, 07:18:33
2025-03-09 07:18:33,896 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-09 07:18:33,896 [INFO]: 	Creating the index 03/09/2025, 07:18:33
2025-03-09 07:18:33,896 [INFO]: 		-> Instanciate the index HNSW15 03/09/2025, 07:18:33
2025-03-09 07:18:33,898 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0020 secs
2025-03-09 07:18:33,898 [INFO]: 		-> Adding the vectors to the index 03/09/2025, 07:18:33
2025-03-09 07:18:33,898 [INFO]: The memory available for adding the vectors is 49.5GB(total available - used by the index)
2025-03-09 07:18:33,898 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/12 [00:00<?, ?it/s]  8%|▊         | 1/12 [00:00<00:01,  6.90it/s] 42%|████▏     | 5/12 [00:00<00:00, 23.19it/s] 83%|████████▎ | 10/12 [00:00<00:00, 31.30it/s]100%|██████████| 12/12 [00:02<00:00,  5.15it/s]
2025-03-09 07:18:36,234 [INFO]: 	Computing best hyperparameters for index knn.index 03/09/2025, 07:18:36
2025-03-09 07:19:07,235 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 31.0003 secs
2025-03-09 07:19:07,235 [INFO]: The best hyperparameters are: efSearch=239
2025-03-09 07:19:07,235 [INFO]: 	Compute fast metrics 03/09/2025, 07:19:07
  0%|          | 0/4 [00:00<?, ?it/s] 75%|███████▌  | 3/4 [00:00<00:00, 26.41it/s] 75%|███████▌  | 3/4 [00:00<00:00, 22.35it/s]
2025-03-09 07:19:22,739 [INFO]: 	>>> Finished "Compute fast metrics" in 15.5035 secs
2025-03-09 07:19:22,741 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 48.8425 secs
2025-03-09 07:19:22,741 [INFO]: {
2025-03-09 07:19:22,741 [INFO]: 	index_key: HNSW15
2025-03-09 07:19:22,741 [INFO]: 	index_param: efSearch=239
2025-03-09 07:19:22,741 [INFO]: 	index_path: knn.index
2025-03-09 07:19:22,741 [INFO]: 	size in bytes: 577246330
2025-03-09 07:19:22,741 [INFO]: 	avg_search_speed_ms: 9.716629511807964
2025-03-09 07:19:22,741 [INFO]: 	99p_search_speed_ms: 23.2905936893076
2025-03-09 07:19:22,741 [INFO]: 	reconstruction error %: 0.0
2025-03-09 07:19:22,741 [INFO]: 	nb vectors: 2934
2025-03-09 07:19:22,741 [INFO]: 	vectors dimension: 49152
2025-03-09 07:19:22,741 [INFO]: 	compression ratio: 0.999309726230741
2025-03-09 07:19:22,741 [INFO]: }
2025-03-09 07:19:22,741 [INFO]: 	>>> Finished "Creating the index" in 48.8451 secs
2025-03-09 07:19:22,741 [INFO]: >>> Finished "Launching the whole pipeline" in 48.8870 secs
2025-03-09 07:19:23: [retrieval_preprocessing] calculating distances ...
2025-03-09 07:19:23: [retrieval_preprocessing] finished and saved retrieval indices for episode 71206 [episode count 7/20]
[retrieval_preprocessing] for episode 45608 [episode count 8/20], we have num_retrieval=np.int64(2915) num_query=np.int64(148)
2025-03-09 07:19:24,238 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-09 07:19:24,969 [INFO]: Launching the whole pipeline 03/09/2025, 07:19:24
2025-03-09 07:19:24,969 [INFO]: Reading total number of vectors and dimension 03/09/2025, 07:19:24
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1253.90it/s]
2025-03-09 07:19:24,999 [INFO]: There are 2915 embeddings of dim 49152
2025-03-09 07:19:25,000 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0307 secs
2025-03-09 07:19:25,000 [INFO]: 	Compute estimated construction time of the index 03/09/2025, 07:19:25
2025-03-09 07:19:25,000 [INFO]: 		-> Train: 16.7 minutes
2025-03-09 07:19:25,000 [INFO]: 		-> Add: 1.6 seconds
2025-03-09 07:19:25,000 [INFO]: 		Total: 16.7 minutes
2025-03-09 07:19:25,000 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0002 secs
2025-03-09 07:19:25,000 [INFO]: 	Checking that your have enough memory available to create the index 03/09/2025, 07:19:25
2025-03-09 07:19:25,000 [INFO]: 601.6MB of memory will be needed to build the index (more might be used if you have more)
2025-03-09 07:19:25,000 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0002 secs
2025-03-09 07:19:25,000 [INFO]: 	Selecting most promising index types given data characteristics 03/09/2025, 07:19:25
2025-03-09 07:19:25,000 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-09 07:19:25,000 [INFO]: 	Creating the index 03/09/2025, 07:19:25
2025-03-09 07:19:25,001 [INFO]: 		-> Instanciate the index HNSW15 03/09/2025, 07:19:25
2025-03-09 07:19:25,002 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0014 secs
2025-03-09 07:19:25,002 [INFO]: 		-> Adding the vectors to the index 03/09/2025, 07:19:25
2025-03-09 07:19:25,002 [INFO]: The memory available for adding the vectors is 49.5GB(total available - used by the index)
2025-03-09 07:19:25,002 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/12 [00:00<?, ?it/s] 17%|█▋        | 2/12 [00:00<00:00, 19.10it/s] 58%|█████▊    | 7/12 [00:00<00:00, 35.68it/s]100%|██████████| 12/12 [00:02<00:00,  3.91it/s]100%|██████████| 12/12 [00:02<00:00,  4.78it/s]
2025-03-09 07:19:27,517 [INFO]: 	Computing best hyperparameters for index knn.index 03/09/2025, 07:19:27
2025-03-09 07:20:01,711 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 34.1931 secs
2025-03-09 07:20:01,711 [INFO]: The best hyperparameters are: efSearch=225
2025-03-09 07:20:01,711 [INFO]: 	Compute fast metrics 03/09/2025, 07:20:01
  0%|          | 0/4 [00:00<?, ?it/s] 50%|█████     | 2/4 [00:00<00:00, 18.28it/s] 75%|███████▌  | 3/4 [00:00<00:00, 19.99it/s]
2025-03-09 07:20:14,598 [INFO]: 	>>> Finished "Compute fast metrics" in 12.8861 secs
2025-03-09 07:20:14,599 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 49.5972 secs
2025-03-09 07:20:14,599 [INFO]: {
2025-03-09 07:20:14,599 [INFO]: 	index_key: HNSW15
2025-03-09 07:20:14,599 [INFO]: 	index_param: efSearch=225
2025-03-09 07:20:14,599 [INFO]: 	index_path: knn.index
2025-03-09 07:20:14,599 [INFO]: 	size in bytes: 573508150
2025-03-09 07:20:14,599 [INFO]: 	avg_search_speed_ms: 9.008996988235562
2025-03-09 07:20:14,600 [INFO]: 	99p_search_speed_ms: 20.137777763884515
2025-03-09 07:20:14,600 [INFO]: 	reconstruction error %: 0.0
2025-03-09 07:20:14,600 [INFO]: 	nb vectors: 2915
2025-03-09 07:20:14,600 [INFO]: 	vectors dimension: 49152
2025-03-09 07:20:14,600 [INFO]: 	compression ratio: 0.9993098092851863
2025-03-09 07:20:14,600 [INFO]: }
2025-03-09 07:20:14,600 [INFO]: 	>>> Finished "Creating the index" in 49.5991 secs
2025-03-09 07:20:14,600 [INFO]: >>> Finished "Launching the whole pipeline" in 49.6306 secs
2025-03-09 07:20:15: [retrieval_preprocessing] calculating distances ...
2025-03-09 07:20:15: [retrieval_preprocessing] finished and saved retrieval indices for episode 45608 [episode count 8/20]
[retrieval_preprocessing] for episode 10287 [episode count 9/20], we have num_retrieval=np.int64(2845) num_query=np.int64(218)
2025-03-09 07:20:15,875 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-09 07:20:16,287 [INFO]: Launching the whole pipeline 03/09/2025, 07:20:16
2025-03-09 07:20:16,287 [INFO]: Reading total number of vectors and dimension 03/09/2025, 07:20:16
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 2105.57it/s]
2025-03-09 07:20:16,318 [INFO]: There are 2845 embeddings of dim 49152
2025-03-09 07:20:16,318 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0308 secs
2025-03-09 07:20:16,318 [INFO]: 	Compute estimated construction time of the index 03/09/2025, 07:20:16
2025-03-09 07:20:16,318 [INFO]: 		-> Train: 16.7 minutes
2025-03-09 07:20:16,318 [INFO]: 		-> Add: 1.6 seconds
2025-03-09 07:20:16,318 [INFO]: 		Total: 16.7 minutes
2025-03-09 07:20:16,318 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0001 secs
2025-03-09 07:20:16,318 [INFO]: 	Checking that your have enough memory available to create the index 03/09/2025, 07:20:16
2025-03-09 07:20:16,319 [INFO]: 587.1MB of memory will be needed to build the index (more might be used if you have more)
2025-03-09 07:20:16,319 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0001 secs
2025-03-09 07:20:16,319 [INFO]: 	Selecting most promising index types given data characteristics 03/09/2025, 07:20:16
2025-03-09 07:20:16,319 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-09 07:20:16,319 [INFO]: 	Creating the index 03/09/2025, 07:20:16
2025-03-09 07:20:16,319 [INFO]: 		-> Instanciate the index HNSW15 03/09/2025, 07:20:16
2025-03-09 07:20:16,320 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0010 secs
2025-03-09 07:20:16,320 [INFO]: 		-> Adding the vectors to the index 03/09/2025, 07:20:16
2025-03-09 07:20:16,320 [INFO]: The memory available for adding the vectors is 49.5GB(total available - used by the index)
2025-03-09 07:20:16,320 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/12 [00:00<?, ?it/s]  8%|▊         | 1/12 [00:00<00:01,  7.46it/s] 50%|█████     | 6/12 [00:00<00:00, 27.86it/s] 92%|█████████▏| 11/12 [00:00<00:00, 35.28it/s]100%|██████████| 12/12 [00:02<00:00,  4.95it/s]
2025-03-09 07:20:18,751 [INFO]: 	Computing best hyperparameters for index knn.index 03/09/2025, 07:20:18
2025-03-09 07:20:48,242 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 29.4907 secs
2025-03-09 07:20:48,242 [INFO]: The best hyperparameters are: efSearch=224
2025-03-09 07:20:48,242 [INFO]: 	Compute fast metrics 03/09/2025, 07:20:48
  0%|          | 0/4 [00:00<?, ?it/s] 50%|█████     | 2/4 [00:00<00:00, 18.60it/s] 75%|███████▌  | 3/4 [00:00<00:00, 20.89it/s]
2025-03-09 07:20:59,874 [INFO]: 	>>> Finished "Compute fast metrics" in 11.6312 secs
2025-03-09 07:20:59,878 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 43.5576 secs
2025-03-09 07:20:59,878 [INFO]: {
2025-03-09 07:20:59,878 [INFO]: 	index_key: HNSW15
2025-03-09 07:20:59,878 [INFO]: 	index_param: efSearch=224
2025-03-09 07:20:59,878 [INFO]: 	index_path: knn.index
2025-03-09 07:20:59,878 [INFO]: 	size in bytes: 559736170
2025-03-09 07:20:59,878 [INFO]: 	avg_search_speed_ms: 8.466623284657636
2025-03-09 07:20:59,878 [INFO]: 	99p_search_speed_ms: 21.835599234327677
2025-03-09 07:20:59,878 [INFO]: 	reconstruction error %: 0.0
2025-03-09 07:20:59,878 [INFO]: 	nb vectors: 2845
2025-03-09 07:20:59,878 [INFO]: 	vectors dimension: 49152
2025-03-09 07:20:59,878 [INFO]: 	compression ratio: 0.9993096569049665
2025-03-09 07:20:59,878 [INFO]: }
2025-03-09 07:20:59,878 [INFO]: 	>>> Finished "Creating the index" in 43.5593 secs
2025-03-09 07:20:59,878 [INFO]: >>> Finished "Launching the whole pipeline" in 43.5907 secs
2025-03-09 07:21:00: [retrieval_preprocessing] calculating distances ...
2025-03-09 07:21:01: [retrieval_preprocessing] finished and saved retrieval indices for episode 10287 [episode count 9/20]
[retrieval_preprocessing] for episode 53296 [episode count 10/20], we have num_retrieval=np.int64(2867) num_query=np.int64(196)
2025-03-09 07:21:01,658 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-09 07:21:02,051 [INFO]: Launching the whole pipeline 03/09/2025, 07:21:02
2025-03-09 07:21:02,051 [INFO]: Reading total number of vectors and dimension 03/09/2025, 07:21:02
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1373.83it/s]
2025-03-09 07:21:02,075 [INFO]: There are 2867 embeddings of dim 49152
2025-03-09 07:21:02,076 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0245 secs
2025-03-09 07:21:02,076 [INFO]: 	Compute estimated construction time of the index 03/09/2025, 07:21:02
2025-03-09 07:21:02,076 [INFO]: 		-> Train: 16.7 minutes
2025-03-09 07:21:02,076 [INFO]: 		-> Add: 1.6 seconds
2025-03-09 07:21:02,076 [INFO]: 		Total: 16.7 minutes
2025-03-09 07:21:02,076 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0001 secs
2025-03-09 07:21:02,076 [INFO]: 	Checking that your have enough memory available to create the index 03/09/2025, 07:21:02
2025-03-09 07:21:02,076 [INFO]: 591.7MB of memory will be needed to build the index (more might be used if you have more)
2025-03-09 07:21:02,076 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0001 secs
2025-03-09 07:21:02,076 [INFO]: 	Selecting most promising index types given data characteristics 03/09/2025, 07:21:02
2025-03-09 07:21:02,076 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-09 07:21:02,076 [INFO]: 	Creating the index 03/09/2025, 07:21:02
2025-03-09 07:21:02,076 [INFO]: 		-> Instanciate the index HNSW15 03/09/2025, 07:21:02
2025-03-09 07:21:02,077 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0009 secs
2025-03-09 07:21:02,077 [INFO]: 		-> Adding the vectors to the index 03/09/2025, 07:21:02
2025-03-09 07:21:02,077 [INFO]: The memory available for adding the vectors is 49.5GB(total available - used by the index)
2025-03-09 07:21:02,077 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/12 [00:00<?, ?it/s]  8%|▊         | 1/12 [00:00<00:01,  7.97it/s] 58%|█████▊    | 7/12 [00:00<00:00, 32.39it/s]100%|██████████| 12/12 [00:02<00:00,  4.31it/s]100%|██████████| 12/12 [00:02<00:00,  5.11it/s]
2025-03-09 07:21:04,428 [INFO]: 	Computing best hyperparameters for index knn.index 03/09/2025, 07:21:04
2025-03-09 07:21:42,050 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 37.6220 secs
2025-03-09 07:21:42,050 [INFO]: The best hyperparameters are: efSearch=230
2025-03-09 07:21:42,050 [INFO]: 	Compute fast metrics 03/09/2025, 07:21:42
  0%|          | 0/4 [00:00<?, ?it/s] 75%|███████▌  | 3/4 [00:00<00:00, 28.77it/s] 75%|███████▌  | 3/4 [00:00<00:00, 22.54it/s]
2025-03-09 07:21:54,505 [INFO]: 	>>> Finished "Compute fast metrics" in 12.4544 secs
2025-03-09 07:21:54,507 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 52.4300 secs
2025-03-09 07:21:54,507 [INFO]: {
2025-03-09 07:21:54,507 [INFO]: 	index_key: HNSW15
2025-03-09 07:21:54,507 [INFO]: 	index_param: efSearch=230
2025-03-09 07:21:54,507 [INFO]: 	index_path: knn.index
2025-03-09 07:21:54,507 [INFO]: 	size in bytes: 564064510
2025-03-09 07:21:54,507 [INFO]: 	avg_search_speed_ms: 9.820407081517978
2025-03-09 07:21:54,507 [INFO]: 	99p_search_speed_ms: 21.313919993117455
2025-03-09 07:21:54,507 [INFO]: 	reconstruction error %: 0.0
2025-03-09 07:21:54,507 [INFO]: 	nb vectors: 2867
2025-03-09 07:21:54,507 [INFO]: 	vectors dimension: 49152
2025-03-09 07:21:54,507 [INFO]: 	compression ratio: 0.9993096995235528
2025-03-09 07:21:54,508 [INFO]: }
2025-03-09 07:21:54,508 [INFO]: 	>>> Finished "Creating the index" in 52.4316 secs
2025-03-09 07:21:54,508 [INFO]: >>> Finished "Launching the whole pipeline" in 52.4566 secs
2025-03-09 07:21:55: [retrieval_preprocessing] calculating distances ...
2025-03-09 07:21:56: [retrieval_preprocessing] finished and saved retrieval indices for episode 53296 [episode count 10/20]
[retrieval_preprocessing] for episode 54837 [episode count 11/20], we have num_retrieval=np.int64(2936) num_query=np.int64(127)
2025-03-09 07:21:56,537 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-09 07:21:56,924 [INFO]: Launching the whole pipeline 03/09/2025, 07:21:56
2025-03-09 07:21:56,925 [INFO]: Reading total number of vectors and dimension 03/09/2025, 07:21:56
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1422.76it/s]
2025-03-09 07:21:56,949 [INFO]: There are 2936 embeddings of dim 49152
2025-03-09 07:21:56,949 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0248 secs
2025-03-09 07:21:56,949 [INFO]: 	Compute estimated construction time of the index 03/09/2025, 07:21:56
2025-03-09 07:21:56,950 [INFO]: 		-> Train: 16.7 minutes
2025-03-09 07:21:56,950 [INFO]: 		-> Add: 1.6 seconds
2025-03-09 07:21:56,950 [INFO]: 		Total: 16.7 minutes
2025-03-09 07:21:56,950 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0001 secs
2025-03-09 07:21:56,950 [INFO]: 	Checking that your have enough memory available to create the index 03/09/2025, 07:21:56
2025-03-09 07:21:56,950 [INFO]: 605.9MB of memory will be needed to build the index (more might be used if you have more)
2025-03-09 07:21:56,950 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0001 secs
2025-03-09 07:21:56,950 [INFO]: 	Selecting most promising index types given data characteristics 03/09/2025, 07:21:56
2025-03-09 07:21:56,950 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-09 07:21:56,950 [INFO]: 	Creating the index 03/09/2025, 07:21:56
2025-03-09 07:21:56,950 [INFO]: 		-> Instanciate the index HNSW15 03/09/2025, 07:21:56
2025-03-09 07:21:56,951 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0010 secs
2025-03-09 07:21:56,951 [INFO]: 		-> Adding the vectors to the index 03/09/2025, 07:21:56
2025-03-09 07:21:56,951 [INFO]: The memory available for adding the vectors is 49.5GB(total available - used by the index)
2025-03-09 07:21:56,951 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/12 [00:00<?, ?it/s] 17%|█▋        | 2/12 [00:00<00:00, 17.37it/s] 67%|██████▋   | 8/12 [00:00<00:00, 39.34it/s]100%|██████████| 12/12 [00:02<00:00,  4.77it/s]100%|██████████| 12/12 [00:02<00:00,  5.95it/s]
2025-03-09 07:21:58,971 [INFO]: 	Computing best hyperparameters for index knn.index 03/09/2025, 07:21:58
2025-03-09 07:22:35,442 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 36.4709 secs
2025-03-09 07:22:35,443 [INFO]: The best hyperparameters are: efSearch=242
2025-03-09 07:22:35,443 [INFO]: 	Compute fast metrics 03/09/2025, 07:22:35
  0%|          | 0/4 [00:00<?, ?it/s] 50%|█████     | 2/4 [00:00<00:00, 18.93it/s] 75%|███████▌  | 3/4 [00:00<00:00, 20.41it/s]
2025-03-09 07:22:47,145 [INFO]: 	>>> Finished "Compute fast metrics" in 11.7023 secs
2025-03-09 07:22:47,147 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 50.1959 secs
2025-03-09 07:22:47,147 [INFO]: {
2025-03-09 07:22:47,147 [INFO]: 	index_key: HNSW15
2025-03-09 07:22:47,147 [INFO]: 	index_param: efSearch=242
2025-03-09 07:22:47,147 [INFO]: 	index_path: knn.index
2025-03-09 07:22:47,147 [INFO]: 	size in bytes: 577639810
2025-03-09 07:22:47,147 [INFO]: 	avg_search_speed_ms: 10.45404573782788
2025-03-09 07:22:47,147 [INFO]: 	99p_search_speed_ms: 20.272205434739586
2025-03-09 07:22:47,147 [INFO]: 	reconstruction error %: 0.0
2025-03-09 07:22:47,147 [INFO]: 	nb vectors: 2936
2025-03-09 07:22:47,147 [INFO]: 	vectors dimension: 49152
2025-03-09 07:22:47,147 [INFO]: 	compression ratio: 0.9993097394031758
2025-03-09 07:22:47,147 [INFO]: }
2025-03-09 07:22:47,147 [INFO]: 	>>> Finished "Creating the index" in 50.1975 secs
2025-03-09 07:22:47,147 [INFO]: >>> Finished "Launching the whole pipeline" in 50.2228 secs
2025-03-09 07:22:47: [retrieval_preprocessing] calculating distances ...
2025-03-09 07:22:48: [retrieval_preprocessing] finished and saved retrieval indices for episode 54837 [episode count 11/20]
[retrieval_preprocessing] for episode 70198 [episode count 12/20], we have num_retrieval=np.int64(2923) num_query=np.int64(140)
2025-03-09 07:22:48,597 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-09 07:22:49,034 [INFO]: Launching the whole pipeline 03/09/2025, 07:22:49
2025-03-09 07:22:49,034 [INFO]: Reading total number of vectors and dimension 03/09/2025, 07:22:49
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1367.56it/s]
2025-03-09 07:22:49,058 [INFO]: There are 2923 embeddings of dim 49152
2025-03-09 07:22:49,059 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0248 secs
2025-03-09 07:22:49,059 [INFO]: 	Compute estimated construction time of the index 03/09/2025, 07:22:49
2025-03-09 07:22:49,059 [INFO]: 		-> Train: 16.7 minutes
2025-03-09 07:22:49,059 [INFO]: 		-> Add: 1.6 seconds
2025-03-09 07:22:49,059 [INFO]: 		Total: 16.7 minutes
2025-03-09 07:22:49,059 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0003 secs
2025-03-09 07:22:49,059 [INFO]: 	Checking that your have enough memory available to create the index 03/09/2025, 07:22:49
2025-03-09 07:22:49,059 [INFO]: 603.2MB of memory will be needed to build the index (more might be used if you have more)
2025-03-09 07:22:49,059 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0002 secs
2025-03-09 07:22:49,059 [INFO]: 	Selecting most promising index types given data characteristics 03/09/2025, 07:22:49
2025-03-09 07:22:49,059 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-09 07:22:49,059 [INFO]: 	Creating the index 03/09/2025, 07:22:49
2025-03-09 07:22:49,059 [INFO]: 		-> Instanciate the index HNSW15 03/09/2025, 07:22:49
2025-03-09 07:22:49,060 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0011 secs
2025-03-09 07:22:49,061 [INFO]: 		-> Adding the vectors to the index 03/09/2025, 07:22:49
2025-03-09 07:22:49,061 [INFO]: The memory available for adding the vectors is 49.5GB(total available - used by the index)
2025-03-09 07:22:49,061 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/12 [00:00<?, ?it/s] 17%|█▋        | 2/12 [00:00<00:00, 16.12it/s] 50%|█████     | 6/12 [00:00<00:00, 28.01it/s] 83%|████████▎ | 10/12 [00:00<00:00, 32.47it/s]100%|██████████| 12/12 [00:02<00:00,  4.35it/s]
2025-03-09 07:22:51,823 [INFO]: 	Computing best hyperparameters for index knn.index 03/09/2025, 07:22:51
2025-03-09 07:23:27,516 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 35.6930 secs
2025-03-09 07:23:27,517 [INFO]: The best hyperparameters are: efSearch=240
2025-03-09 07:23:27,517 [INFO]: 	Compute fast metrics 03/09/2025, 07:23:27
  0%|          | 0/4 [00:00<?, ?it/s] 50%|█████     | 2/4 [00:00<00:00, 18.73it/s] 75%|███████▌  | 3/4 [00:00<00:00, 20.44it/s]
2025-03-09 07:23:40,874 [INFO]: 	>>> Finished "Compute fast metrics" in 13.3574 secs
2025-03-09 07:23:40,876 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 51.8155 secs
2025-03-09 07:23:40,876 [INFO]: {
2025-03-09 07:23:40,876 [INFO]: 	index_key: HNSW15
2025-03-09 07:23:40,876 [INFO]: 	index_param: efSearch=240
2025-03-09 07:23:40,876 [INFO]: 	index_path: knn.index
2025-03-09 07:23:40,876 [INFO]: 	size in bytes: 575082070
2025-03-09 07:23:40,876 [INFO]: 	avg_search_speed_ms: 9.049733962054571
2025-03-09 07:23:40,876 [INFO]: 	99p_search_speed_ms: 17.91428269818426
2025-03-09 07:23:40,876 [INFO]: 	reconstruction error %: 0.0
2025-03-09 07:23:40,876 [INFO]: 	nb vectors: 2923
2025-03-09 07:23:40,876 [INFO]: 	vectors dimension: 49152
2025-03-09 07:23:40,876 [INFO]: 	compression ratio: 0.9993098619819603
2025-03-09 07:23:40,876 [INFO]: }
2025-03-09 07:23:40,876 [INFO]: 	>>> Finished "Creating the index" in 51.8171 secs
2025-03-09 07:23:40,876 [INFO]: >>> Finished "Launching the whole pipeline" in 51.8428 secs
2025-03-09 07:23:41: [retrieval_preprocessing] calculating distances ...
2025-03-09 07:23:42: [retrieval_preprocessing] finished and saved retrieval indices for episode 70198 [episode count 12/20]
[retrieval_preprocessing] for episode 45632 [episode count 13/20], we have num_retrieval=np.int64(2890) num_query=np.int64(173)
2025-03-09 07:23:42,498 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-09 07:23:42,962 [INFO]: Launching the whole pipeline 03/09/2025, 07:23:42
2025-03-09 07:23:42,962 [INFO]: Reading total number of vectors and dimension 03/09/2025, 07:23:42
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1464.49it/s]
2025-03-09 07:23:42,985 [INFO]: There are 2890 embeddings of dim 49152
2025-03-09 07:23:42,985 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0236 secs
2025-03-09 07:23:42,985 [INFO]: 	Compute estimated construction time of the index 03/09/2025, 07:23:42
2025-03-09 07:23:42,986 [INFO]: 		-> Train: 16.7 minutes
2025-03-09 07:23:42,986 [INFO]: 		-> Add: 1.6 seconds
2025-03-09 07:23:42,986 [INFO]: 		Total: 16.7 minutes
2025-03-09 07:23:42,986 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0001 secs
2025-03-09 07:23:42,986 [INFO]: 	Checking that your have enough memory available to create the index 03/09/2025, 07:23:42
2025-03-09 07:23:42,986 [INFO]: 596.4MB of memory will be needed to build the index (more might be used if you have more)
2025-03-09 07:23:42,986 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0001 secs
2025-03-09 07:23:42,986 [INFO]: 	Selecting most promising index types given data characteristics 03/09/2025, 07:23:42
2025-03-09 07:23:42,986 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-09 07:23:42,986 [INFO]: 	Creating the index 03/09/2025, 07:23:42
2025-03-09 07:23:42,986 [INFO]: 		-> Instanciate the index HNSW15 03/09/2025, 07:23:42
2025-03-09 07:23:42,987 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0010 secs
2025-03-09 07:23:42,987 [INFO]: 		-> Adding the vectors to the index 03/09/2025, 07:23:42
2025-03-09 07:23:42,987 [INFO]: The memory available for adding the vectors is 49.5GB(total available - used by the index)
2025-03-09 07:23:42,987 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/12 [00:00<?, ?it/s]  8%|▊         | 1/12 [00:00<00:01,  7.99it/s] 50%|█████     | 6/12 [00:00<00:00, 29.63it/s] 92%|█████████▏| 11/12 [00:00<00:00, 37.51it/s]100%|██████████| 12/12 [00:02<00:00,  5.45it/s]
2025-03-09 07:23:45,192 [INFO]: 	Computing best hyperparameters for index knn.index 03/09/2025, 07:23:45
2025-03-09 07:24:21,986 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 36.7937 secs
2025-03-09 07:24:21,986 [INFO]: The best hyperparameters are: efSearch=243
2025-03-09 07:24:21,986 [INFO]: 	Compute fast metrics 03/09/2025, 07:24:21
  0%|          | 0/4 [00:00<?, ?it/s] 50%|█████     | 2/4 [00:00<00:00, 17.79it/s] 75%|███████▌  | 3/4 [00:00<00:00, 19.11it/s]
2025-03-09 07:24:38,448 [INFO]: 	>>> Finished "Compute fast metrics" in 16.4617 secs
2025-03-09 07:24:38,450 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 55.4633 secs
2025-03-09 07:24:38,451 [INFO]: {
2025-03-09 07:24:38,451 [INFO]: 	index_key: HNSW15
2025-03-09 07:24:38,451 [INFO]: 	index_param: efSearch=243
2025-03-09 07:24:38,451 [INFO]: 	index_path: knn.index
2025-03-09 07:24:38,451 [INFO]: 	size in bytes: 568589590
2025-03-09 07:24:38,451 [INFO]: 	avg_search_speed_ms: 9.503055423814786
2025-03-09 07:24:38,451 [INFO]: 	99p_search_speed_ms: 19.97490428388119
2025-03-09 07:24:38,451 [INFO]: 	reconstruction error %: 0.0
2025-03-09 07:24:38,451 [INFO]: 	nb vectors: 2890
2025-03-09 07:24:38,451 [INFO]: 	vectors dimension: 49152
2025-03-09 07:24:38,451 [INFO]: 	compression ratio: 0.9993097481788226
2025-03-09 07:24:38,451 [INFO]: }
2025-03-09 07:24:38,451 [INFO]: 	>>> Finished "Creating the index" in 55.4649 secs
2025-03-09 07:24:38,451 [INFO]: >>> Finished "Launching the whole pipeline" in 55.4890 secs
2025-03-09 07:24:39: [retrieval_preprocessing] calculating distances ...
2025-03-09 07:24:40: [retrieval_preprocessing] finished and saved retrieval indices for episode 45632 [episode count 13/20]
[retrieval_preprocessing] for episode 67139 [episode count 14/20], we have num_retrieval=np.int64(2921) num_query=np.int64(142)
2025-03-09 07:24:40,243 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-09 07:24:40,664 [INFO]: Launching the whole pipeline 03/09/2025, 07:24:40
2025-03-09 07:24:40,664 [INFO]: Reading total number of vectors and dimension 03/09/2025, 07:24:40
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1373.83it/s]
2025-03-09 07:24:40,688 [INFO]: There are 2921 embeddings of dim 49152
2025-03-09 07:24:40,688 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0235 secs
2025-03-09 07:24:40,688 [INFO]: 	Compute estimated construction time of the index 03/09/2025, 07:24:40
2025-03-09 07:24:40,688 [INFO]: 		-> Train: 16.7 minutes
2025-03-09 07:24:40,688 [INFO]: 		-> Add: 1.6 seconds
2025-03-09 07:24:40,688 [INFO]: 		Total: 16.7 minutes
2025-03-09 07:24:40,688 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0001 secs
2025-03-09 07:24:40,688 [INFO]: 	Checking that your have enough memory available to create the index 03/09/2025, 07:24:40
2025-03-09 07:24:40,688 [INFO]: 602.8MB of memory will be needed to build the index (more might be used if you have more)
2025-03-09 07:24:40,688 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0001 secs
2025-03-09 07:24:40,688 [INFO]: 	Selecting most promising index types given data characteristics 03/09/2025, 07:24:40
2025-03-09 07:24:40,688 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-09 07:24:40,688 [INFO]: 	Creating the index 03/09/2025, 07:24:40
2025-03-09 07:24:40,688 [INFO]: 		-> Instanciate the index HNSW15 03/09/2025, 07:24:40
2025-03-09 07:24:40,689 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0009 secs
2025-03-09 07:24:40,689 [INFO]: 		-> Adding the vectors to the index 03/09/2025, 07:24:40
2025-03-09 07:24:40,689 [INFO]: The memory available for adding the vectors is 49.5GB(total available - used by the index)
2025-03-09 07:24:40,689 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/12 [00:00<?, ?it/s] 17%|█▋        | 2/12 [00:00<00:00, 17.57it/s] 67%|██████▋   | 8/12 [00:00<00:00, 38.14it/s]100%|██████████| 12/12 [00:02<00:00,  4.50it/s]100%|██████████| 12/12 [00:02<00:00,  5.62it/s]
2025-03-09 07:24:42,829 [INFO]: 	Computing best hyperparameters for index knn.index 03/09/2025, 07:24:42
2025-03-09 07:25:18,623 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 35.7936 secs
2025-03-09 07:25:18,623 [INFO]: The best hyperparameters are: efSearch=224
2025-03-09 07:25:18,623 [INFO]: 	Compute fast metrics 03/09/2025, 07:25:18
  0%|          | 0/4 [00:00<?, ?it/s] 50%|█████     | 2/4 [00:00<00:00, 18.18it/s] 75%|███████▌  | 3/4 [00:00<00:00, 19.96it/s]
2025-03-09 07:25:30,280 [INFO]: 	>>> Finished "Compute fast metrics" in 11.6567 secs
2025-03-09 07:25:30,282 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 49.5922 secs
2025-03-09 07:25:30,282 [INFO]: {
2025-03-09 07:25:30,282 [INFO]: 	index_key: HNSW15
2025-03-09 07:25:30,282 [INFO]: 	index_param: efSearch=224
2025-03-09 07:25:30,282 [INFO]: 	index_path: knn.index
2025-03-09 07:25:30,282 [INFO]: 	size in bytes: 574688590
2025-03-09 07:25:30,282 [INFO]: 	avg_search_speed_ms: 8.929188047269625
2025-03-09 07:25:30,282 [INFO]: 	99p_search_speed_ms: 22.814113083295517
2025-03-09 07:25:30,282 [INFO]: 	reconstruction error %: 0.0
2025-03-09 07:25:30,282 [INFO]: 	nb vectors: 2921
2025-03-09 07:25:30,282 [INFO]: 	vectors dimension: 49152
2025-03-09 07:25:30,282 [INFO]: 	compression ratio: 0.9993098488348272
2025-03-09 07:25:30,282 [INFO]: }
2025-03-09 07:25:30,282 [INFO]: 	>>> Finished "Creating the index" in 49.5935 secs
2025-03-09 07:25:30,282 [INFO]: >>> Finished "Launching the whole pipeline" in 49.6175 secs
2025-03-09 07:25:30: [retrieval_preprocessing] calculating distances ...
2025-03-09 07:25:31: [retrieval_preprocessing] finished and saved retrieval indices for episode 67139 [episode count 14/20]
[retrieval_preprocessing] for episode 587 [episode count 15/20], we have num_retrieval=np.int64(2922) num_query=np.int64(141)
2025-03-09 07:25:31,467 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-09 07:25:31,816 [INFO]: Launching the whole pipeline 03/09/2025, 07:25:31
2025-03-09 07:25:31,816 [INFO]: Reading total number of vectors and dimension 03/09/2025, 07:25:31
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1546.00it/s]
2025-03-09 07:25:31,839 [INFO]: There are 2922 embeddings of dim 49152
2025-03-09 07:25:31,839 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0230 secs
2025-03-09 07:25:31,839 [INFO]: 	Compute estimated construction time of the index 03/09/2025, 07:25:31
2025-03-09 07:25:31,839 [INFO]: 		-> Train: 16.7 minutes
2025-03-09 07:25:31,839 [INFO]: 		-> Add: 1.6 seconds
2025-03-09 07:25:31,839 [INFO]: 		Total: 16.7 minutes
2025-03-09 07:25:31,839 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0001 secs
2025-03-09 07:25:31,839 [INFO]: 	Checking that your have enough memory available to create the index 03/09/2025, 07:25:31
2025-03-09 07:25:31,840 [INFO]: 603.0MB of memory will be needed to build the index (more might be used if you have more)
2025-03-09 07:25:31,840 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0001 secs
2025-03-09 07:25:31,840 [INFO]: 	Selecting most promising index types given data characteristics 03/09/2025, 07:25:31
2025-03-09 07:25:31,840 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-09 07:25:31,840 [INFO]: 	Creating the index 03/09/2025, 07:25:31
2025-03-09 07:25:31,840 [INFO]: 		-> Instanciate the index HNSW15 03/09/2025, 07:25:31
2025-03-09 07:25:31,841 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0009 secs
2025-03-09 07:25:31,841 [INFO]: 		-> Adding the vectors to the index 03/09/2025, 07:25:31
2025-03-09 07:25:31,841 [INFO]: The memory available for adding the vectors is 49.5GB(total available - used by the index)
2025-03-09 07:25:31,841 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/12 [00:00<?, ?it/s] 17%|█▋        | 2/12 [00:00<00:00, 18.05it/s] 67%|██████▋   | 8/12 [00:00<00:00, 41.19it/s]100%|██████████| 12/12 [00:01<00:00,  6.06it/s]
2025-03-09 07:25:33,823 [INFO]: 	Computing best hyperparameters for index knn.index 03/09/2025, 07:25:33
2025-03-09 07:26:14,348 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 40.5245 secs
2025-03-09 07:26:14,348 [INFO]: The best hyperparameters are: efSearch=202
2025-03-09 07:26:14,348 [INFO]: 	Compute fast metrics 03/09/2025, 07:26:14
  0%|          | 0/4 [00:00<?, ?it/s] 25%|██▌       | 1/4 [00:00<00:00,  9.62it/s] 75%|███████▌  | 3/4 [00:00<00:00, 17.78it/s]
2025-03-09 07:26:26,334 [INFO]: 	>>> Finished "Compute fast metrics" in 11.9861 secs
2025-03-09 07:26:26,336 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 54.4952 secs
2025-03-09 07:26:26,336 [INFO]: {
2025-03-09 07:26:26,336 [INFO]: 	index_key: HNSW15
2025-03-09 07:26:26,336 [INFO]: 	index_param: efSearch=202
2025-03-09 07:26:26,336 [INFO]: 	index_path: knn.index
2025-03-09 07:26:26,336 [INFO]: 	size in bytes: 574885330
2025-03-09 07:26:26,336 [INFO]: 	avg_search_speed_ms: 8.016606745793698
2025-03-09 07:26:26,336 [INFO]: 	99p_search_speed_ms: 19.271034738048904
2025-03-09 07:26:26,336 [INFO]: 	reconstruction error %: 0.0
2025-03-09 07:26:26,336 [INFO]: 	nb vectors: 2922
2025-03-09 07:26:26,336 [INFO]: 	vectors dimension: 49152
2025-03-09 07:26:26,336 [INFO]: 	compression ratio: 0.9993098554106433
2025-03-09 07:26:26,336 [INFO]: }
2025-03-09 07:26:26,336 [INFO]: 	>>> Finished "Creating the index" in 54.4966 secs
2025-03-09 07:26:26,336 [INFO]: >>> Finished "Launching the whole pipeline" in 54.5201 secs
2025-03-09 07:26:26: [retrieval_preprocessing] calculating distances ...
2025-03-09 07:26:27: [retrieval_preprocessing] finished and saved retrieval indices for episode 587 [episode count 15/20]
[retrieval_preprocessing] for episode 28235 [episode count 16/20], we have num_retrieval=np.int64(2935) num_query=np.int64(128)
2025-03-09 07:26:27,641 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-09 07:26:28,014 [INFO]: Launching the whole pipeline 03/09/2025, 07:26:28
2025-03-09 07:26:28,014 [INFO]: Reading total number of vectors and dimension 03/09/2025, 07:26:28
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 2132.34it/s]
2025-03-09 07:26:28,038 [INFO]: There are 2935 embeddings of dim 49152
2025-03-09 07:26:28,038 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0237 secs
2025-03-09 07:26:28,038 [INFO]: 	Compute estimated construction time of the index 03/09/2025, 07:26:28
2025-03-09 07:26:28,038 [INFO]: 		-> Train: 16.7 minutes
2025-03-09 07:26:28,038 [INFO]: 		-> Add: 1.6 seconds
2025-03-09 07:26:28,038 [INFO]: 		Total: 16.7 minutes
2025-03-09 07:26:28,038 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0001 secs
2025-03-09 07:26:28,038 [INFO]: 	Checking that your have enough memory available to create the index 03/09/2025, 07:26:28
2025-03-09 07:26:28,038 [INFO]: 605.7MB of memory will be needed to build the index (more might be used if you have more)
2025-03-09 07:26:28,038 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0001 secs
2025-03-09 07:26:28,038 [INFO]: 	Selecting most promising index types given data characteristics 03/09/2025, 07:26:28
2025-03-09 07:26:28,038 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-09 07:26:28,038 [INFO]: 	Creating the index 03/09/2025, 07:26:28
2025-03-09 07:26:28,038 [INFO]: 		-> Instanciate the index HNSW15 03/09/2025, 07:26:28
2025-03-09 07:26:28,039 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0010 secs
2025-03-09 07:26:28,039 [INFO]: 		-> Adding the vectors to the index 03/09/2025, 07:26:28
2025-03-09 07:26:28,039 [INFO]: The memory available for adding the vectors is 49.5GB(total available - used by the index)
2025-03-09 07:26:28,040 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/12 [00:00<?, ?it/s]  8%|▊         | 1/12 [00:00<00:01,  8.01it/s] 50%|█████     | 6/12 [00:00<00:00, 29.18it/s] 92%|█████████▏| 11/12 [00:00<00:00, 36.91it/s]100%|██████████| 12/12 [00:02<00:00,  4.88it/s]
2025-03-09 07:26:30,501 [INFO]: 	Computing best hyperparameters for index knn.index 03/09/2025, 07:26:30
2025-03-09 07:27:06,209 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 35.7072 secs
2025-03-09 07:27:06,209 [INFO]: The best hyperparameters are: efSearch=271
2025-03-09 07:27:06,209 [INFO]: 	Compute fast metrics 03/09/2025, 07:27:06
  0%|          | 0/4 [00:00<?, ?it/s] 50%|█████     | 2/4 [00:00<00:00, 16.76it/s] 75%|███████▌  | 3/4 [00:00<00:00, 17.86it/s]
2025-03-09 07:27:22,698 [INFO]: 	>>> Finished "Compute fast metrics" in 16.4890 secs
2025-03-09 07:27:22,701 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 54.6613 secs
2025-03-09 07:27:22,701 [INFO]: {
2025-03-09 07:27:22,701 [INFO]: 	index_key: HNSW15
2025-03-09 07:27:22,701 [INFO]: 	index_param: efSearch=271
2025-03-09 07:27:22,701 [INFO]: 	index_path: knn.index
2025-03-09 07:27:22,701 [INFO]: 	size in bytes: 577443070
2025-03-09 07:27:22,701 [INFO]: 	avg_search_speed_ms: 10.94412693144505
2025-03-09 07:27:22,701 [INFO]: 	99p_search_speed_ms: 23.869018470868472
2025-03-09 07:27:22,701 [INFO]: 	reconstruction error %: 0.0
2025-03-09 07:27:22,701 [INFO]: 	nb vectors: 2935
2025-03-09 07:27:22,701 [INFO]: 	vectors dimension: 49152
2025-03-09 07:27:22,701 [INFO]: 	compression ratio: 0.9993097328192024
2025-03-09 07:27:22,701 [INFO]: }
2025-03-09 07:27:22,701 [INFO]: 	>>> Finished "Creating the index" in 54.6629 secs
2025-03-09 07:27:22,701 [INFO]: >>> Finished "Launching the whole pipeline" in 54.6872 secs
2025-03-09 07:27:23: [retrieval_preprocessing] calculating distances ...
2025-03-09 07:27:24: [retrieval_preprocessing] finished and saved retrieval indices for episode 28235 [episode count 16/20]
[retrieval_preprocessing] for episode 87635 [episode count 17/20], we have num_retrieval=np.int64(2923) num_query=np.int64(140)
2025-03-09 07:27:24,293 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-09 07:27:24,782 [INFO]: Launching the whole pipeline 03/09/2025, 07:27:24
2025-03-09 07:27:24,782 [INFO]: Reading total number of vectors and dimension 03/09/2025, 07:27:24
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 2392.64it/s]
2025-03-09 07:27:24,806 [INFO]: There are 2923 embeddings of dim 49152
2025-03-09 07:27:24,806 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0241 secs
2025-03-09 07:27:24,807 [INFO]: 	Compute estimated construction time of the index 03/09/2025, 07:27:24
2025-03-09 07:27:24,807 [INFO]: 		-> Train: 16.7 minutes
2025-03-09 07:27:24,807 [INFO]: 		-> Add: 1.6 seconds
2025-03-09 07:27:24,807 [INFO]: 		Total: 16.7 minutes
2025-03-09 07:27:24,808 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0006 secs
2025-03-09 07:27:24,808 [INFO]: 	Checking that your have enough memory available to create the index 03/09/2025, 07:27:24
2025-03-09 07:27:24,808 [INFO]: 603.2MB of memory will be needed to build the index (more might be used if you have more)
2025-03-09 07:27:24,808 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0004 secs
2025-03-09 07:27:24,808 [INFO]: 	Selecting most promising index types given data characteristics 03/09/2025, 07:27:24
2025-03-09 07:27:24,808 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-09 07:27:24,809 [INFO]: 	Creating the index 03/09/2025, 07:27:24
2025-03-09 07:27:24,809 [INFO]: 		-> Instanciate the index HNSW15 03/09/2025, 07:27:24
2025-03-09 07:27:24,812 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0031 secs
2025-03-09 07:27:24,812 [INFO]: 		-> Adding the vectors to the index 03/09/2025, 07:27:24
2025-03-09 07:27:24,812 [INFO]: The memory available for adding the vectors is 49.5GB(total available - used by the index)
2025-03-09 07:27:24,813 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/12 [00:00<?, ?it/s] 25%|██▌       | 3/12 [00:00<00:00, 24.98it/s] 58%|█████▊    | 7/12 [00:00<00:00, 31.21it/s]100%|██████████| 12/12 [00:02<00:00,  4.40it/s]100%|██████████| 12/12 [00:02<00:00,  5.45it/s]
2025-03-09 07:27:27,020 [INFO]: 	Computing best hyperparameters for index knn.index 03/09/2025, 07:27:27
2025-03-09 07:28:04,781 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 37.7605 secs
2025-03-09 07:28:04,781 [INFO]: The best hyperparameters are: efSearch=216
2025-03-09 07:28:04,781 [INFO]: 	Compute fast metrics 03/09/2025, 07:28:04
  0%|          | 0/4 [00:00<?, ?it/s] 50%|█████     | 2/4 [00:00<00:00, 19.14it/s] 75%|███████▌  | 3/4 [00:00<00:00, 20.59it/s]
2025-03-09 07:28:18,182 [INFO]: 	>>> Finished "Compute fast metrics" in 13.4002 secs
2025-03-09 07:28:18,184 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 53.3715 secs
2025-03-09 07:28:18,184 [INFO]: {
2025-03-09 07:28:18,184 [INFO]: 	index_key: HNSW15
2025-03-09 07:28:18,184 [INFO]: 	index_param: efSearch=216
2025-03-09 07:28:18,184 [INFO]: 	index_path: knn.index
2025-03-09 07:28:18,184 [INFO]: 	size in bytes: 575082070
2025-03-09 07:28:18,184 [INFO]: 	avg_search_speed_ms: 8.576270780928663
2025-03-09 07:28:18,184 [INFO]: 	99p_search_speed_ms: 22.62302871095015
2025-03-09 07:28:18,184 [INFO]: 	reconstruction error %: 0.0
2025-03-09 07:28:18,184 [INFO]: 	nb vectors: 2923
2025-03-09 07:28:18,184 [INFO]: 	vectors dimension: 49152
2025-03-09 07:28:18,184 [INFO]: 	compression ratio: 0.9993098619819603
2025-03-09 07:28:18,184 [INFO]: }
2025-03-09 07:28:18,184 [INFO]: 	>>> Finished "Creating the index" in 53.3755 secs
2025-03-09 07:28:18,184 [INFO]: >>> Finished "Launching the whole pipeline" in 53.4018 secs
2025-03-09 07:28:18: [retrieval_preprocessing] calculating distances ...
2025-03-09 07:28:19: [retrieval_preprocessing] finished and saved retrieval indices for episode 87635 [episode count 17/20]
[retrieval_preprocessing] for episode 37974 [episode count 18/20], we have num_retrieval=np.int64(2956) num_query=np.int64(107)
2025-03-09 07:28:19,382 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-09 07:28:19,823 [INFO]: Launching the whole pipeline 03/09/2025, 07:28:19
2025-03-09 07:28:19,823 [INFO]: Reading total number of vectors and dimension 03/09/2025, 07:28:19
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1527.42it/s]
2025-03-09 07:28:19,846 [INFO]: There are 2956 embeddings of dim 49152
2025-03-09 07:28:19,846 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0236 secs
2025-03-09 07:28:19,847 [INFO]: 	Compute estimated construction time of the index 03/09/2025, 07:28:19
2025-03-09 07:28:19,847 [INFO]: 		-> Train: 16.7 minutes
2025-03-09 07:28:19,847 [INFO]: 		-> Add: 1.6 seconds
2025-03-09 07:28:19,847 [INFO]: 		Total: 16.7 minutes
2025-03-09 07:28:19,847 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0001 secs
2025-03-09 07:28:19,847 [INFO]: 	Checking that your have enough memory available to create the index 03/09/2025, 07:28:19
2025-03-09 07:28:19,847 [INFO]: 610.0MB of memory will be needed to build the index (more might be used if you have more)
2025-03-09 07:28:19,847 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0002 secs
2025-03-09 07:28:19,847 [INFO]: 	Selecting most promising index types given data characteristics 03/09/2025, 07:28:19
2025-03-09 07:28:19,847 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-09 07:28:19,847 [INFO]: 	Creating the index 03/09/2025, 07:28:19
2025-03-09 07:28:19,847 [INFO]: 		-> Instanciate the index HNSW15 03/09/2025, 07:28:19
2025-03-09 07:28:19,848 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0009 secs
2025-03-09 07:28:19,848 [INFO]: 		-> Adding the vectors to the index 03/09/2025, 07:28:19
2025-03-09 07:28:19,848 [INFO]: The memory available for adding the vectors is 49.5GB(total available - used by the index)
2025-03-09 07:28:19,848 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/12 [00:00<?, ?it/s]  8%|▊         | 1/12 [00:00<00:01,  6.62it/s] 50%|█████     | 6/12 [00:00<00:00, 27.23it/s] 92%|█████████▏| 11/12 [00:00<00:00, 35.85it/s]100%|██████████| 12/12 [00:02<00:00,  5.05it/s]
2025-03-09 07:28:22,227 [INFO]: 	Computing best hyperparameters for index knn.index 03/09/2025, 07:28:22
2025-03-09 07:29:00,705 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 38.4771 secs
2025-03-09 07:29:00,705 [INFO]: The best hyperparameters are: efSearch=233
2025-03-09 07:29:00,705 [INFO]: 	Compute fast metrics 03/09/2025, 07:29:00
  0%|          | 0/4 [00:00<?, ?it/s] 50%|█████     | 2/4 [00:00<00:00, 17.18it/s] 75%|███████▌  | 3/4 [00:00<00:00, 17.17it/s]
2025-03-09 07:29:13,500 [INFO]: 	>>> Finished "Compute fast metrics" in 12.7953 secs
2025-03-09 07:29:13,502 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 53.6542 secs
2025-03-09 07:29:13,503 [INFO]: {
2025-03-09 07:29:13,503 [INFO]: 	index_key: HNSW15
2025-03-09 07:29:13,503 [INFO]: 	index_param: efSearch=233
2025-03-09 07:29:13,503 [INFO]: 	index_path: knn.index
2025-03-09 07:29:13,503 [INFO]: 	size in bytes: 581574730
2025-03-09 07:29:13,503 [INFO]: 	avg_search_speed_ms: 9.297537790926443
2025-03-09 07:29:13,503 [INFO]: 	99p_search_speed_ms: 16.545229183975607
2025-03-09 07:29:13,503 [INFO]: 	reconstruction error %: 0.0
2025-03-09 07:29:13,503 [INFO]: 	nb vectors: 2956
2025-03-09 07:29:13,503 [INFO]: 	vectors dimension: 49152
2025-03-09 07:29:13,503 [INFO]: 	compression ratio: 0.9993096639532464
2025-03-09 07:29:13,503 [INFO]: }
2025-03-09 07:29:13,503 [INFO]: 	>>> Finished "Creating the index" in 53.6558 secs
2025-03-09 07:29:13,503 [INFO]: >>> Finished "Launching the whole pipeline" in 53.6801 secs
2025-03-09 07:29:14: [retrieval_preprocessing] calculating distances ...
2025-03-09 07:29:14: [retrieval_preprocessing] finished and saved retrieval indices for episode 37974 [episode count 18/20]
[retrieval_preprocessing] for episode 79448 [episode count 19/20], we have num_retrieval=np.int64(2909) num_query=np.int64(154)
2025-03-09 07:29:14,740 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-09 07:29:15,157 [INFO]: Launching the whole pipeline 03/09/2025, 07:29:15
2025-03-09 07:29:15,157 [INFO]: Reading total number of vectors and dimension 03/09/2025, 07:29:15
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1294.14it/s]
2025-03-09 07:29:15,187 [INFO]: There are 2909 embeddings of dim 49152
2025-03-09 07:29:15,187 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0298 secs
2025-03-09 07:29:15,187 [INFO]: 	Compute estimated construction time of the index 03/09/2025, 07:29:15
2025-03-09 07:29:15,188 [INFO]: 		-> Train: 16.7 minutes
2025-03-09 07:29:15,188 [INFO]: 		-> Add: 1.6 seconds
2025-03-09 07:29:15,188 [INFO]: 		Total: 16.7 minutes
2025-03-09 07:29:15,188 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0003 secs
2025-03-09 07:29:15,188 [INFO]: 	Checking that your have enough memory available to create the index 03/09/2025, 07:29:15
2025-03-09 07:29:15,188 [INFO]: 600.3MB of memory will be needed to build the index (more might be used if you have more)
2025-03-09 07:29:15,188 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0005 secs
2025-03-09 07:29:15,189 [INFO]: 	Selecting most promising index types given data characteristics 03/09/2025, 07:29:15
2025-03-09 07:29:15,189 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-09 07:29:15,189 [INFO]: 	Creating the index 03/09/2025, 07:29:15
2025-03-09 07:29:15,189 [INFO]: 		-> Instanciate the index HNSW15 03/09/2025, 07:29:15
2025-03-09 07:29:15,191 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0025 secs
2025-03-09 07:29:15,192 [INFO]: 		-> Adding the vectors to the index 03/09/2025, 07:29:15
2025-03-09 07:29:15,192 [INFO]: The memory available for adding the vectors is 49.5GB(total available - used by the index)
2025-03-09 07:29:15,192 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/12 [00:00<?, ?it/s] 17%|█▋        | 2/12 [00:00<00:00, 16.18it/s] 58%|█████▊    | 7/12 [00:00<00:00, 30.17it/s] 92%|█████████▏| 11/12 [00:00<00:00, 31.74it/s]100%|██████████| 12/12 [00:02<00:00,  5.59it/s]
2025-03-09 07:29:17,343 [INFO]: 	Computing best hyperparameters for index knn.index 03/09/2025, 07:29:17
2025-03-09 07:29:51,522 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 34.1788 secs
2025-03-09 07:29:51,522 [INFO]: The best hyperparameters are: efSearch=222
2025-03-09 07:29:51,522 [INFO]: 	Compute fast metrics 03/09/2025, 07:29:51
  0%|          | 0/4 [00:00<?, ?it/s] 25%|██▌       | 1/4 [00:01<00:04,  1.57s/it] 50%|█████     | 2/4 [00:02<00:02,  1.18s/it] 75%|███████▌  | 3/4 [00:03<00:00,  1.06it/s] 75%|███████▌  | 3/4 [00:03<00:01,  1.06s/it]
2025-03-09 07:30:07,059 [INFO]: 	>>> Finished "Compute fast metrics" in 15.5371 secs
2025-03-09 07:30:07,061 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 51.8694 secs
2025-03-09 07:30:07,061 [INFO]: {
2025-03-09 07:30:07,061 [INFO]: 	index_key: HNSW15
2025-03-09 07:30:07,061 [INFO]: 	index_param: efSearch=222
2025-03-09 07:30:07,061 [INFO]: 	index_path: knn.index
2025-03-09 07:30:07,061 [INFO]: 	size in bytes: 572327650
2025-03-09 07:30:07,061 [INFO]: 	avg_search_speed_ms: 8.065330343613882
2025-03-09 07:30:07,061 [INFO]: 	99p_search_speed_ms: 16.749728403519832
2025-03-09 07:30:07,061 [INFO]: 	reconstruction error %: 0.0
2025-03-09 07:30:07,062 [INFO]: 	nb vectors: 2909
2025-03-09 07:30:07,062 [INFO]: 	vectors dimension: 49152
2025-03-09 07:30:07,062 [INFO]: 	compression ratio: 0.9993098743350946
2025-03-09 07:30:07,062 [INFO]: }
2025-03-09 07:30:07,062 [INFO]: 	>>> Finished "Creating the index" in 51.8728 secs
2025-03-09 07:30:07,062 [INFO]: >>> Finished "Launching the whole pipeline" in 51.9041 secs
2025-03-09 07:30:07: [retrieval_preprocessing] calculating distances ...
2025-03-09 07:30:07: [retrieval_preprocessing] finished and saved retrieval indices for episode 79448 [episode count 19/20]
2025-03-09 07:30:07: [retrieval_preprocessing] finished for (2782099537, 'cup') [chosen_id count 1/10]
2025-03-09 07:30:12: [retrieval_preprocessing] concatenated all embeddings and indices for 20 episodes for (7489911085, 'cloth') [chosen_id count 2/10]
2025-03-09 07:30:12: [retrieval_preprocessing] we have num_total=3354 embedding_dim=49152
[retrieval_preprocessing] for episode 46593 [episode count 0/20], we have num_retrieval=np.int64(3243) num_query=np.int64(111)
2025-03-09 07:30:15,214 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-09 07:30:15,751 [INFO]: Launching the whole pipeline 03/09/2025, 07:30:15
2025-03-09 07:30:15,751 [INFO]: Reading total number of vectors and dimension 03/09/2025, 07:30:15
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1298.14it/s]
2025-03-09 07:30:15,781 [INFO]: There are 3243 embeddings of dim 49152
2025-03-09 07:30:15,782 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0303 secs
2025-03-09 07:30:15,782 [INFO]: 	Compute estimated construction time of the index 03/09/2025, 07:30:15
2025-03-09 07:30:15,782 [INFO]: 		-> Train: 16.7 minutes
2025-03-09 07:30:15,782 [INFO]: 		-> Add: 1.8 seconds
2025-03-09 07:30:15,782 [INFO]: 		Total: 16.7 minutes
2025-03-09 07:30:15,782 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0001 secs
2025-03-09 07:30:15,782 [INFO]: 	Checking that your have enough memory available to create the index 03/09/2025, 07:30:15
2025-03-09 07:30:15,782 [INFO]: 669.3MB of memory will be needed to build the index (more might be used if you have more)
2025-03-09 07:30:15,782 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0002 secs
2025-03-09 07:30:15,782 [INFO]: 	Selecting most promising index types given data characteristics 03/09/2025, 07:30:15
2025-03-09 07:30:15,782 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-09 07:30:15,782 [INFO]: 	Creating the index 03/09/2025, 07:30:15
2025-03-09 07:30:15,782 [INFO]: 		-> Instanciate the index HNSW15 03/09/2025, 07:30:15
2025-03-09 07:30:15,783 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0010 secs
2025-03-09 07:30:15,783 [INFO]: 		-> Adding the vectors to the index 03/09/2025, 07:30:15
2025-03-09 07:30:15,784 [INFO]: The memory available for adding the vectors is 49.4GB(total available - used by the index)
2025-03-09 07:30:15,784 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/13 [00:00<?, ?it/s] 15%|█▌        | 2/13 [00:00<00:00, 19.03it/s] 62%|██████▏   | 8/13 [00:00<00:00, 39.51it/s]100%|██████████| 13/13 [00:02<00:00,  3.95it/s]100%|██████████| 13/13 [00:02<00:00,  4.88it/s]
2025-03-09 07:30:18,453 [INFO]: 	Computing best hyperparameters for index knn.index 03/09/2025, 07:30:18
2025-03-09 07:30:58,581 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 40.1284 secs
2025-03-09 07:30:58,582 [INFO]: The best hyperparameters are: efSearch=172
2025-03-09 07:30:58,582 [INFO]: 	Compute fast metrics 03/09/2025, 07:30:58
  0%|          | 0/4 [00:00<?, ?it/s] 50%|█████     | 2/4 [00:00<00:00, 18.15it/s] 75%|███████▌  | 3/4 [00:00<00:00, 16.99it/s]
2025-03-09 07:31:12,912 [INFO]: 	>>> Finished "Compute fast metrics" in 14.3299 secs
2025-03-09 07:31:12,913 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 57.1298 secs
2025-03-09 07:31:12,913 [INFO]: {
2025-03-09 07:31:12,913 [INFO]: 	index_key: HNSW15
2025-03-09 07:31:12,913 [INFO]: 	index_param: efSearch=172
2025-03-09 07:31:12,913 [INFO]: 	index_path: knn.index
2025-03-09 07:31:12,914 [INFO]: 	size in bytes: 638040490
2025-03-09 07:31:12,914 [INFO]: 	avg_search_speed_ms: 9.388467435344634
2025-03-09 07:31:12,914 [INFO]: 	99p_search_speed_ms: 20.267562167718975
2025-03-09 07:31:12,914 [INFO]: 	reconstruction error %: 0.0
2025-03-09 07:31:12,914 [INFO]: 	nb vectors: 3243
2025-03-09 07:31:12,914 [INFO]: 	vectors dimension: 49152
2025-03-09 07:31:12,914 [INFO]: 	compression ratio: 0.9993092193882555
2025-03-09 07:31:12,914 [INFO]: }
2025-03-09 07:31:12,914 [INFO]: 	>>> Finished "Creating the index" in 57.1313 secs
2025-03-09 07:31:12,914 [INFO]: >>> Finished "Launching the whole pipeline" in 57.1623 secs
2025-03-09 07:31:13: [retrieval_preprocessing] calculating distances ...
2025-03-09 07:31:13: [retrieval_preprocessing] finished and saved retrieval indices for episode 46593 [episode count 0/20]
[retrieval_preprocessing] for episode 93700 [episode count 1/20], we have num_retrieval=np.int64(3235) num_query=np.int64(119)
2025-03-09 07:31:14,198 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-09 07:31:14,740 [INFO]: Launching the whole pipeline 03/09/2025, 07:31:14
2025-03-09 07:31:14,740 [INFO]: Reading total number of vectors and dimension 03/09/2025, 07:31:14
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1489.98it/s]
2025-03-09 07:31:14,763 [INFO]: There are 3235 embeddings of dim 49152
2025-03-09 07:31:14,763 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0231 secs
2025-03-09 07:31:14,763 [INFO]: 	Compute estimated construction time of the index 03/09/2025, 07:31:14
2025-03-09 07:31:14,763 [INFO]: 		-> Train: 16.7 minutes
2025-03-09 07:31:14,763 [INFO]: 		-> Add: 1.8 seconds
2025-03-09 07:31:14,763 [INFO]: 		Total: 16.7 minutes
2025-03-09 07:31:14,763 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0001 secs
2025-03-09 07:31:14,763 [INFO]: 	Checking that your have enough memory available to create the index 03/09/2025, 07:31:14
2025-03-09 07:31:14,764 [INFO]: 667.6MB of memory will be needed to build the index (more might be used if you have more)
2025-03-09 07:31:14,764 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0001 secs
2025-03-09 07:31:14,764 [INFO]: 	Selecting most promising index types given data characteristics 03/09/2025, 07:31:14
2025-03-09 07:31:14,764 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-09 07:31:14,764 [INFO]: 	Creating the index 03/09/2025, 07:31:14
2025-03-09 07:31:14,764 [INFO]: 		-> Instanciate the index HNSW15 03/09/2025, 07:31:14
2025-03-09 07:31:14,765 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0008 secs
2025-03-09 07:31:14,765 [INFO]: 		-> Adding the vectors to the index 03/09/2025, 07:31:14
2025-03-09 07:31:14,765 [INFO]: The memory available for adding the vectors is 49.4GB(total available - used by the index)
2025-03-09 07:31:14,765 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/13 [00:00<?, ?it/s]  8%|▊         | 1/13 [00:00<00:01,  8.47it/s] 46%|████▌     | 6/13 [00:00<00:00, 31.17it/s] 92%|█████████▏| 12/13 [00:00<00:00, 40.81it/s]100%|██████████| 13/13 [00:02<00:00,  4.47it/s]
2025-03-09 07:31:17,677 [INFO]: 	Computing best hyperparameters for index knn.index 03/09/2025, 07:31:17
2025-03-09 07:31:56,747 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 39.0690 secs
2025-03-09 07:31:56,747 [INFO]: The best hyperparameters are: efSearch=186
2025-03-09 07:31:56,747 [INFO]: 	Compute fast metrics 03/09/2025, 07:31:56
  0%|          | 0/4 [00:00<?, ?it/s] 25%|██▌       | 1/4 [00:00<00:00,  8.43it/s] 75%|███████▌  | 3/4 [00:00<00:00, 16.54it/s]
2025-03-09 07:32:08,698 [INFO]: 	>>> Finished "Compute fast metrics" in 11.9508 secs
2025-03-09 07:32:08,700 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 53.9355 secs
2025-03-09 07:32:08,700 [INFO]: {
2025-03-09 07:32:08,700 [INFO]: 	index_key: HNSW15
2025-03-09 07:32:08,700 [INFO]: 	index_param: efSearch=186
2025-03-09 07:32:08,700 [INFO]: 	index_path: knn.index
2025-03-09 07:32:08,700 [INFO]: 	size in bytes: 636466450
2025-03-09 07:32:08,700 [INFO]: 	avg_search_speed_ms: 9.25625644811187
2025-03-09 07:32:08,700 [INFO]: 	99p_search_speed_ms: 18.97806678898633
2025-03-09 07:32:08,700 [INFO]: 	reconstruction error %: 0.0
2025-03-09 07:32:08,700 [INFO]: 	nb vectors: 3235
2025-03-09 07:32:08,700 [INFO]: 	vectors dimension: 49152
2025-03-09 07:32:08,700 [INFO]: 	compression ratio: 0.9993093587258213
2025-03-09 07:32:08,700 [INFO]: }
2025-03-09 07:32:08,700 [INFO]: 	>>> Finished "Creating the index" in 53.9368 secs
2025-03-09 07:32:08,700 [INFO]: >>> Finished "Launching the whole pipeline" in 53.9605 secs
2025-03-09 07:32:09: [retrieval_preprocessing] calculating distances ...
2025-03-09 07:32:09: [retrieval_preprocessing] finished and saved retrieval indices for episode 93700 [episode count 1/20]
[retrieval_preprocessing] for episode 48648 [episode count 2/20], we have num_retrieval=np.int64(3167) num_query=np.int64(187)
2025-03-09 07:32:11,976 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-09 07:32:12,448 [INFO]: Launching the whole pipeline 03/09/2025, 07:32:12
2025-03-09 07:32:12,448 [INFO]: Reading total number of vectors and dimension 03/09/2025, 07:32:12
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 2071.26it/s]
2025-03-09 07:32:12,475 [INFO]: There are 3167 embeddings of dim 49152
2025-03-09 07:32:12,476 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0273 secs
2025-03-09 07:32:12,476 [INFO]: 	Compute estimated construction time of the index 03/09/2025, 07:32:12
2025-03-09 07:32:12,476 [INFO]: 		-> Train: 16.7 minutes
2025-03-09 07:32:12,476 [INFO]: 		-> Add: 1.7 seconds
2025-03-09 07:32:12,477 [INFO]: 		Total: 16.7 minutes
2025-03-09 07:32:12,477 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0007 secs
2025-03-09 07:32:12,477 [INFO]: 	Checking that your have enough memory available to create the index 03/09/2025, 07:32:12
2025-03-09 07:32:12,477 [INFO]: 653.6MB of memory will be needed to build the index (more might be used if you have more)
2025-03-09 07:32:12,478 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0005 secs
2025-03-09 07:32:12,478 [INFO]: 	Selecting most promising index types given data characteristics 03/09/2025, 07:32:12
2025-03-09 07:32:12,478 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-09 07:32:12,478 [INFO]: 	Creating the index 03/09/2025, 07:32:12
2025-03-09 07:32:12,478 [INFO]: 		-> Instanciate the index HNSW15 03/09/2025, 07:32:12
2025-03-09 07:32:12,481 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0031 secs
2025-03-09 07:32:12,482 [INFO]: 		-> Adding the vectors to the index 03/09/2025, 07:32:12
2025-03-09 07:32:12,482 [INFO]: The memory available for adding the vectors is 49.4GB(total available - used by the index)
2025-03-09 07:32:12,482 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/13 [00:00<?, ?it/s] 15%|█▌        | 2/13 [00:00<00:00, 14.57it/s] 31%|███       | 4/13 [00:00<00:00, 15.95it/s] 62%|██████▏   | 8/13 [00:00<00:00, 14.61it/s] 77%|███████▋  | 10/13 [00:00<00:00, 10.83it/s]100%|██████████| 13/13 [00:03<00:00,  2.60it/s]100%|██████████| 13/13 [00:03<00:00,  3.92it/s]
2025-03-09 07:32:15,801 [INFO]: 	Computing best hyperparameters for index knn.index 03/09/2025, 07:32:15
2025-03-09 07:32:50,273 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 34.4718 secs
2025-03-09 07:32:50,274 [INFO]: The best hyperparameters are: efSearch=193
2025-03-09 07:32:50,274 [INFO]: 	Compute fast metrics 03/09/2025, 07:32:50
  0%|          | 0/4 [00:00<?, ?it/s] 25%|██▌       | 1/4 [00:00<00:00,  4.62it/s] 50%|█████     | 2/4 [00:00<00:00,  2.38it/s] 75%|███████▌  | 3/4 [00:00<00:00,  3.63it/s]
2025-03-09 07:33:02,700 [INFO]: 	>>> Finished "Compute fast metrics" in 12.4257 secs
2025-03-09 07:33:02,705 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 50.2229 secs
2025-03-09 07:33:02,705 [INFO]: {
2025-03-09 07:33:02,705 [INFO]: 	index_key: HNSW15
2025-03-09 07:33:02,705 [INFO]: 	index_param: efSearch=193
2025-03-09 07:33:02,705 [INFO]: 	index_path: knn.index
2025-03-09 07:33:02,705 [INFO]: 	size in bytes: 623087650
2025-03-09 07:33:02,705 [INFO]: 	avg_search_speed_ms: 10.236461079196133
2025-03-09 07:33:02,705 [INFO]: 	99p_search_speed_ms: 23.22117284871638
2025-03-09 07:33:02,705 [INFO]: 	reconstruction error %: 0.0
2025-03-09 07:33:02,705 [INFO]: 	nb vectors: 3167
2025-03-09 07:33:02,705 [INFO]: 	vectors dimension: 49152
2025-03-09 07:33:02,705 [INFO]: 	compression ratio: 0.9993097054643917
2025-03-09 07:33:02,705 [INFO]: }
2025-03-09 07:33:02,705 [INFO]: 	>>> Finished "Creating the index" in 50.2270 secs
2025-03-09 07:33:02,705 [INFO]: >>> Finished "Launching the whole pipeline" in 50.2568 secs
2025-03-09 07:33:03: [retrieval_preprocessing] calculating distances ...
2025-03-09 07:33:04: [retrieval_preprocessing] finished and saved retrieval indices for episode 48648 [episode count 2/20]
[retrieval_preprocessing] for episode 54288 [episode count 3/20], we have num_retrieval=np.int64(3175) num_query=np.int64(179)
2025-03-09 07:33:04,470 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-09 07:33:05,096 [INFO]: Launching the whole pipeline 03/09/2025, 07:33:05
2025-03-09 07:33:05,096 [INFO]: Reading total number of vectors and dimension 03/09/2025, 07:33:05
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1485.24it/s]
2025-03-09 07:33:05,125 [INFO]: There are 3175 embeddings of dim 49152
2025-03-09 07:33:05,126 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0300 secs
2025-03-09 07:33:05,126 [INFO]: 	Compute estimated construction time of the index 03/09/2025, 07:33:05
2025-03-09 07:33:05,126 [INFO]: 		-> Train: 16.7 minutes
2025-03-09 07:33:05,126 [INFO]: 		-> Add: 1.7 seconds
2025-03-09 07:33:05,126 [INFO]: 		Total: 16.7 minutes
2025-03-09 07:33:05,126 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0001 secs
2025-03-09 07:33:05,126 [INFO]: 	Checking that your have enough memory available to create the index 03/09/2025, 07:33:05
2025-03-09 07:33:05,126 [INFO]: 655.2MB of memory will be needed to build the index (more might be used if you have more)
2025-03-09 07:33:05,126 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0002 secs
2025-03-09 07:33:05,126 [INFO]: 	Selecting most promising index types given data characteristics 03/09/2025, 07:33:05
2025-03-09 07:33:05,127 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-09 07:33:05,127 [INFO]: 	Creating the index 03/09/2025, 07:33:05
2025-03-09 07:33:05,127 [INFO]: 		-> Instanciate the index HNSW15 03/09/2025, 07:33:05
2025-03-09 07:33:05,129 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0019 secs
2025-03-09 07:33:05,129 [INFO]: 		-> Adding the vectors to the index 03/09/2025, 07:33:05
2025-03-09 07:33:05,129 [INFO]: The memory available for adding the vectors is 49.4GB(total available - used by the index)
2025-03-09 07:33:05,129 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/13 [00:00<?, ?it/s]  8%|▊         | 1/13 [00:00<00:01,  9.55it/s] 46%|████▌     | 6/13 [00:00<00:00, 30.65it/s] 85%|████████▍ | 11/13 [00:00<00:00, 37.27it/s]100%|██████████| 13/13 [00:02<00:00,  4.92it/s]
2025-03-09 07:33:07,778 [INFO]: 	Computing best hyperparameters for index knn.index 03/09/2025, 07:33:07
2025-03-09 07:33:46,654 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 38.8753 secs
2025-03-09 07:33:46,654 [INFO]: The best hyperparameters are: efSearch=195
2025-03-09 07:33:46,654 [INFO]: 	Compute fast metrics 03/09/2025, 07:33:46
  0%|          | 0/4 [00:00<?, ?it/s] 25%|██▌       | 1/4 [00:01<00:03,  1.14s/it] 50%|█████     | 2/4 [00:02<00:02,  1.43s/it] 75%|███████▌  | 3/4 [00:05<00:01,  1.86s/it] 75%|███████▌  | 3/4 [00:06<00:02,  2.29s/it]
2025-03-09 07:34:05,201 [INFO]: 	>>> Finished "Compute fast metrics" in 18.5469 secs
2025-03-09 07:34:05,205 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 60.0752 secs
2025-03-09 07:34:05,205 [INFO]: {
2025-03-09 07:34:05,205 [INFO]: 	index_key: HNSW15
2025-03-09 07:34:05,205 [INFO]: 	index_param: efSearch=195
2025-03-09 07:34:05,205 [INFO]: 	index_path: knn.index
2025-03-09 07:34:05,205 [INFO]: 	size in bytes: 624661570
2025-03-09 07:34:05,205 [INFO]: 	avg_search_speed_ms: 10.623069043318699
2025-03-09 07:34:05,205 [INFO]: 	99p_search_speed_ms: 23.155393460765485
2025-03-09 07:34:05,205 [INFO]: 	reconstruction error %: 0.0
2025-03-09 07:34:05,205 [INFO]: 	nb vectors: 3175
2025-03-09 07:34:05,205 [INFO]: 	vectors dimension: 49152
2025-03-09 07:34:05,205 [INFO]: 	compression ratio: 0.9993097542402041
2025-03-09 07:34:05,205 [INFO]: }
2025-03-09 07:34:05,205 [INFO]: 	>>> Finished "Creating the index" in 60.0780 secs
2025-03-09 07:34:05,205 [INFO]: >>> Finished "Launching the whole pipeline" in 60.1092 secs
2025-03-09 07:34:06: [retrieval_preprocessing] calculating distances ...
2025-03-09 07:34:06: [retrieval_preprocessing] finished and saved retrieval indices for episode 54288 [episode count 3/20]
[retrieval_preprocessing] for episode 52242 [episode count 4/20], we have num_retrieval=np.int64(3154) num_query=np.int64(200)
2025-03-09 07:34:06,964 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-09 07:34:07,460 [INFO]: Launching the whole pipeline 03/09/2025, 07:34:07
2025-03-09 07:34:07,460 [INFO]: Reading total number of vectors and dimension 03/09/2025, 07:34:07
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1546.57it/s]
2025-03-09 07:34:07,488 [INFO]: There are 3154 embeddings of dim 49152
2025-03-09 07:34:07,489 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0286 secs
2025-03-09 07:34:07,489 [INFO]: 	Compute estimated construction time of the index 03/09/2025, 07:34:07
2025-03-09 07:34:07,489 [INFO]: 		-> Train: 16.7 minutes
2025-03-09 07:34:07,489 [INFO]: 		-> Add: 1.7 seconds
2025-03-09 07:34:07,490 [INFO]: 		Total: 16.7 minutes
2025-03-09 07:34:07,490 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0005 secs
2025-03-09 07:34:07,490 [INFO]: 	Checking that your have enough memory available to create the index 03/09/2025, 07:34:07
2025-03-09 07:34:07,490 [INFO]: 650.9MB of memory will be needed to build the index (more might be used if you have more)
2025-03-09 07:34:07,490 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0005 secs
2025-03-09 07:34:07,491 [INFO]: 	Selecting most promising index types given data characteristics 03/09/2025, 07:34:07
2025-03-09 07:34:07,491 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-09 07:34:07,491 [INFO]: 	Creating the index 03/09/2025, 07:34:07
2025-03-09 07:34:07,491 [INFO]: 		-> Instanciate the index HNSW15 03/09/2025, 07:34:07
2025-03-09 07:34:07,494 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0026 secs
2025-03-09 07:34:07,494 [INFO]: 		-> Adding the vectors to the index 03/09/2025, 07:34:07
2025-03-09 07:34:07,494 [INFO]: The memory available for adding the vectors is 49.4GB(total available - used by the index)
2025-03-09 07:34:07,494 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/13 [00:00<?, ?it/s] 15%|█▌        | 2/13 [00:00<00:00, 16.50it/s] 46%|████▌     | 6/13 [00:00<00:00, 22.41it/s] 69%|██████▉   | 9/13 [00:00<00:00, 23.56it/s]100%|██████████| 13/13 [00:02<00:00,  3.49it/s]100%|██████████| 13/13 [00:02<00:00,  4.80it/s]
2025-03-09 07:34:10,207 [INFO]: 	Computing best hyperparameters for index knn.index 03/09/2025, 07:34:10
2025-03-09 07:34:51,608 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 41.4005 secs
2025-03-09 07:34:51,609 [INFO]: The best hyperparameters are: efSearch=150
2025-03-09 07:34:51,609 [INFO]: 	Compute fast metrics 03/09/2025, 07:34:51
  0%|          | 0/4 [00:00<?, ?it/s] 25%|██▌       | 1/4 [00:00<00:01,  2.72it/s] 50%|█████     | 2/4 [00:02<00:02,  1.21s/it] 75%|███████▌  | 3/4 [00:03<00:01,  1.45s/it] 75%|███████▌  | 3/4 [00:06<00:02,  2.27s/it]
2025-03-09 07:35:10,489 [INFO]: 	>>> Finished "Compute fast metrics" in 18.8799 secs
2025-03-09 07:35:10,491 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 62.9966 secs
2025-03-09 07:35:10,491 [INFO]: {
2025-03-09 07:35:10,491 [INFO]: 	index_key: HNSW15
2025-03-09 07:35:10,491 [INFO]: 	index_param: efSearch=150
2025-03-09 07:35:10,491 [INFO]: 	index_path: knn.index
2025-03-09 07:35:10,491 [INFO]: 	size in bytes: 620530030
2025-03-09 07:35:10,491 [INFO]: 	avg_search_speed_ms: 8.652138736665687
2025-03-09 07:35:10,491 [INFO]: 	99p_search_speed_ms: 22.23910042084755
2025-03-09 07:35:10,491 [INFO]: 	reconstruction error %: 0.0
2025-03-09 07:35:10,491 [INFO]: 	nb vectors: 3154
2025-03-09 07:35:10,491 [INFO]: 	vectors dimension: 49152
2025-03-09 07:35:10,491 [INFO]: 	compression ratio: 0.9993096256759725
2025-03-09 07:35:10,491 [INFO]: }
2025-03-09 07:35:10,491 [INFO]: 	>>> Finished "Creating the index" in 63.0002 secs
2025-03-09 07:35:10,491 [INFO]: >>> Finished "Launching the whole pipeline" in 63.0309 secs
2025-03-09 07:35:11: [retrieval_preprocessing] calculating distances ...
2025-03-09 07:35:11: [retrieval_preprocessing] finished and saved retrieval indices for episode 52242 [episode count 4/20]
[retrieval_preprocessing] for episode 8212 [episode count 5/20], we have num_retrieval=np.int64(3048) num_query=np.int64(306)
2025-03-09 07:35:12,231 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-09 07:35:12,770 [INFO]: Launching the whole pipeline 03/09/2025, 07:35:12
2025-03-09 07:35:12,771 [INFO]: Reading total number of vectors and dimension 03/09/2025, 07:35:12
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 2559.06it/s]
2025-03-09 07:35:12,794 [INFO]: There are 3048 embeddings of dim 49152
2025-03-09 07:35:12,794 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0237 secs
2025-03-09 07:35:12,794 [INFO]: 	Compute estimated construction time of the index 03/09/2025, 07:35:12
2025-03-09 07:35:12,794 [INFO]: 		-> Train: 16.7 minutes
2025-03-09 07:35:12,794 [INFO]: 		-> Add: 1.7 seconds
2025-03-09 07:35:12,794 [INFO]: 		Total: 16.7 minutes
2025-03-09 07:35:12,794 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0001 secs
2025-03-09 07:35:12,795 [INFO]: 	Checking that your have enough memory available to create the index 03/09/2025, 07:35:12
2025-03-09 07:35:12,795 [INFO]: 629.0MB of memory will be needed to build the index (more might be used if you have more)
2025-03-09 07:35:12,795 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0001 secs
2025-03-09 07:35:12,795 [INFO]: 	Selecting most promising index types given data characteristics 03/09/2025, 07:35:12
2025-03-09 07:35:12,795 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-09 07:35:12,795 [INFO]: 	Creating the index 03/09/2025, 07:35:12
2025-03-09 07:35:12,795 [INFO]: 		-> Instanciate the index HNSW15 03/09/2025, 07:35:12
2025-03-09 07:35:12,796 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0009 secs
2025-03-09 07:35:12,796 [INFO]: 		-> Adding the vectors to the index 03/09/2025, 07:35:12
2025-03-09 07:35:12,796 [INFO]: The memory available for adding the vectors is 49.4GB(total available - used by the index)
2025-03-09 07:35:12,796 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/12 [00:00<?, ?it/s]  8%|▊         | 1/12 [00:00<00:01,  9.86it/s] 50%|█████     | 6/12 [00:00<00:00, 33.19it/s] 92%|█████████▏| 11/12 [00:00<00:00, 40.36it/s]100%|██████████| 12/12 [00:02<00:00,  4.59it/s]
2025-03-09 07:35:15,416 [INFO]: 	Computing best hyperparameters for index knn.index 03/09/2025, 07:35:15
2025-03-09 07:35:53,581 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 38.1641 secs
2025-03-09 07:35:53,597 [INFO]: The best hyperparameters are: efSearch=147
2025-03-09 07:35:53,598 [INFO]: 	Compute fast metrics 03/09/2025, 07:35:53
  0%|          | 0/4 [00:00<?, ?it/s] 25%|██▌       | 1/4 [00:00<00:00,  5.56it/s] 75%|███████▌  | 3/4 [00:00<00:00, 12.47it/s]
2025-03-09 07:36:08,036 [INFO]: 	>>> Finished "Compute fast metrics" in 14.4382 secs
2025-03-09 07:36:08,038 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 55.2419 secs
2025-03-09 07:36:08,038 [INFO]: {
2025-03-09 07:36:08,038 [INFO]: 	index_key: HNSW15
2025-03-09 07:36:08,038 [INFO]: 	index_param: efSearch=147
2025-03-09 07:36:08,038 [INFO]: 	index_path: knn.index
2025-03-09 07:36:08,038 [INFO]: 	size in bytes: 599674990
2025-03-09 07:36:08,038 [INFO]: 	avg_search_speed_ms: 9.275044287997254
2025-03-09 07:36:08,038 [INFO]: 	99p_search_speed_ms: 20.293687325902283
2025-03-09 07:36:08,038 [INFO]: 	reconstruction error %: 0.0
2025-03-09 07:36:08,038 [INFO]: 	nb vectors: 3048
2025-03-09 07:36:08,038 [INFO]: 	vectors dimension: 49152
2025-03-09 07:36:08,038 [INFO]: 	compression ratio: 0.9993099495445025
2025-03-09 07:36:08,038 [INFO]: }
2025-03-09 07:36:08,038 [INFO]: 	>>> Finished "Creating the index" in 55.2433 secs
2025-03-09 07:36:08,038 [INFO]: >>> Finished "Launching the whole pipeline" in 55.2677 secs
2025-03-09 07:36:08: [retrieval_preprocessing] calculating distances ...
2025-03-09 07:36:09: [retrieval_preprocessing] finished and saved retrieval indices for episode 8212 [episode count 5/20]
[retrieval_preprocessing] for episode 65046 [episode count 6/20], we have num_retrieval=np.int64(3242) num_query=np.int64(112)
2025-03-09 07:36:10,160 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-09 07:36:10,590 [INFO]: Launching the whole pipeline 03/09/2025, 07:36:10
2025-03-09 07:36:10,590 [INFO]: Reading total number of vectors and dimension 03/09/2025, 07:36:10
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1149.44it/s]
2025-03-09 07:36:10,620 [INFO]: There are 3242 embeddings of dim 49152
2025-03-09 07:36:10,620 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0302 secs
2025-03-09 07:36:10,620 [INFO]: 	Compute estimated construction time of the index 03/09/2025, 07:36:10
2025-03-09 07:36:10,620 [INFO]: 		-> Train: 16.7 minutes
2025-03-09 07:36:10,620 [INFO]: 		-> Add: 1.8 seconds
2025-03-09 07:36:10,620 [INFO]: 		Total: 16.7 minutes
2025-03-09 07:36:10,620 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0001 secs
2025-03-09 07:36:10,620 [INFO]: 	Checking that your have enough memory available to create the index 03/09/2025, 07:36:10
2025-03-09 07:36:10,620 [INFO]: 669.1MB of memory will be needed to build the index (more might be used if you have more)
2025-03-09 07:36:10,620 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0002 secs
2025-03-09 07:36:10,621 [INFO]: 	Selecting most promising index types given data characteristics 03/09/2025, 07:36:10
2025-03-09 07:36:10,621 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-09 07:36:10,621 [INFO]: 	Creating the index 03/09/2025, 07:36:10
2025-03-09 07:36:10,621 [INFO]: 		-> Instanciate the index HNSW15 03/09/2025, 07:36:10
2025-03-09 07:36:10,622 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0011 secs
2025-03-09 07:36:10,622 [INFO]: 		-> Adding the vectors to the index 03/09/2025, 07:36:10
2025-03-09 07:36:10,622 [INFO]: The memory available for adding the vectors is 49.4GB(total available - used by the index)
2025-03-09 07:36:10,622 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/13 [00:00<?, ?it/s]  8%|▊         | 1/13 [00:00<00:02,  4.94it/s] 54%|█████▍    | 7/13 [00:00<00:00, 26.46it/s]100%|██████████| 13/13 [00:02<00:00,  3.90it/s]100%|██████████| 13/13 [00:02<00:00,  4.51it/s]
2025-03-09 07:36:13,508 [INFO]: 	Computing best hyperparameters for index knn.index 03/09/2025, 07:36:13
2025-03-09 07:36:54,433 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 40.9248 secs
2025-03-09 07:36:54,433 [INFO]: The best hyperparameters are: efSearch=171
2025-03-09 07:36:54,433 [INFO]: 	Compute fast metrics 03/09/2025, 07:36:54
  0%|          | 0/4 [00:00<?, ?it/s] 50%|█████     | 2/4 [00:00<00:00, 16.65it/s] 75%|███████▌  | 3/4 [00:00<00:00, 17.72it/s]
2025-03-09 07:37:06,209 [INFO]: 	>>> Finished "Compute fast metrics" in 11.7758 secs
2025-03-09 07:37:06,212 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 55.5902 secs
2025-03-09 07:37:06,212 [INFO]: {
2025-03-09 07:37:06,212 [INFO]: 	index_key: HNSW15
2025-03-09 07:37:06,212 [INFO]: 	index_param: efSearch=171
2025-03-09 07:37:06,212 [INFO]: 	index_path: knn.index
2025-03-09 07:37:06,212 [INFO]: 	size in bytes: 637843750
2025-03-09 07:37:06,212 [INFO]: 	avg_search_speed_ms: 9.727838689711394
2025-03-09 07:37:06,212 [INFO]: 	99p_search_speed_ms: 20.875333873555064
2025-03-09 07:37:06,212 [INFO]: 	reconstruction error %: 0.0
2025-03-09 07:37:06,212 [INFO]: 	nb vectors: 3242
2025-03-09 07:37:06,212 [INFO]: 	vectors dimension: 49152
2025-03-09 07:37:06,212 [INFO]: 	compression ratio: 0.9993092132673559
2025-03-09 07:37:06,212 [INFO]: }
2025-03-09 07:37:06,212 [INFO]: 	>>> Finished "Creating the index" in 55.5917 secs
2025-03-09 07:37:06,212 [INFO]: >>> Finished "Launching the whole pipeline" in 55.6225 secs
2025-03-09 07:37:06: [retrieval_preprocessing] calculating distances ...
2025-03-09 07:37:07: [retrieval_preprocessing] finished and saved retrieval indices for episode 65046 [episode count 6/20]
[retrieval_preprocessing] for episode 11803 [episode count 7/20], we have num_retrieval=np.int64(3018) num_query=np.int64(336)
2025-03-09 07:37:07,477 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-09 07:37:07,872 [INFO]: Launching the whole pipeline 03/09/2025, 07:37:07
2025-03-09 07:37:07,872 [INFO]: Reading total number of vectors and dimension 03/09/2025, 07:37:07
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1512.01it/s]
2025-03-09 07:37:07,902 [INFO]: There are 3018 embeddings of dim 49152
2025-03-09 07:37:07,902 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0298 secs
2025-03-09 07:37:07,902 [INFO]: 	Compute estimated construction time of the index 03/09/2025, 07:37:07
2025-03-09 07:37:07,903 [INFO]: 		-> Train: 16.7 minutes
2025-03-09 07:37:07,903 [INFO]: 		-> Add: 1.7 seconds
2025-03-09 07:37:07,903 [INFO]: 		Total: 16.7 minutes
2025-03-09 07:37:07,903 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0005 secs
2025-03-09 07:37:07,903 [INFO]: 	Checking that your have enough memory available to create the index 03/09/2025, 07:37:07
2025-03-09 07:37:07,903 [INFO]: 622.8MB of memory will be needed to build the index (more might be used if you have more)
2025-03-09 07:37:07,904 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0005 secs
2025-03-09 07:37:07,904 [INFO]: 	Selecting most promising index types given data characteristics 03/09/2025, 07:37:07
2025-03-09 07:37:07,904 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-09 07:37:07,904 [INFO]: 	Creating the index 03/09/2025, 07:37:07
2025-03-09 07:37:07,904 [INFO]: 		-> Instanciate the index HNSW15 03/09/2025, 07:37:07
2025-03-09 07:37:07,907 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0028 secs
2025-03-09 07:37:07,907 [INFO]: 		-> Adding the vectors to the index 03/09/2025, 07:37:07
2025-03-09 07:37:07,907 [INFO]: The memory available for adding the vectors is 49.4GB(total available - used by the index)
2025-03-09 07:37:07,908 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/12 [00:00<?, ?it/s] 25%|██▌       | 3/12 [00:00<00:00, 27.38it/s] 75%|███████▌  | 9/12 [00:00<00:00, 43.63it/s]100%|██████████| 12/12 [00:02<00:00,  4.47it/s]
2025-03-09 07:37:10,597 [INFO]: 	Computing best hyperparameters for index knn.index 03/09/2025, 07:37:10
2025-03-09 07:37:49,786 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 39.1890 secs
2025-03-09 07:37:49,787 [INFO]: The best hyperparameters are: efSearch=155
2025-03-09 07:37:49,787 [INFO]: 	Compute fast metrics 03/09/2025, 07:37:49
  0%|          | 0/4 [00:00<?, ?it/s] 25%|██▌       | 1/4 [00:00<00:00,  7.83it/s] 75%|███████▌  | 3/4 [00:00<00:00, 15.65it/s]
2025-03-09 07:38:03,286 [INFO]: 	>>> Finished "Compute fast metrics" in 13.4990 secs
2025-03-09 07:38:03,288 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 55.3808 secs
2025-03-09 07:38:03,288 [INFO]: {
2025-03-09 07:38:03,288 [INFO]: 	index_key: HNSW15
2025-03-09 07:38:03,288 [INFO]: 	index_param: efSearch=155
2025-03-09 07:38:03,288 [INFO]: 	index_path: knn.index
2025-03-09 07:38:03,288 [INFO]: 	size in bytes: 593772730
2025-03-09 07:38:03,288 [INFO]: 	avg_search_speed_ms: 9.589227245252648
2025-03-09 07:38:03,288 [INFO]: 	99p_search_speed_ms: 20.061377733945843
2025-03-09 07:38:03,288 [INFO]: 	reconstruction error %: 0.0
2025-03-09 07:38:03,288 [INFO]: 	nb vectors: 3018
2025-03-09 07:38:03,288 [INFO]: 	vectors dimension: 49152
2025-03-09 07:38:03,288 [INFO]: 	compression ratio: 0.9993098605252552
2025-03-09 07:38:03,288 [INFO]: }
2025-03-09 07:38:03,288 [INFO]: 	>>> Finished "Creating the index" in 55.3845 secs
2025-03-09 07:38:03,288 [INFO]: >>> Finished "Launching the whole pipeline" in 55.4162 secs
2025-03-09 07:38:04: [retrieval_preprocessing] calculating distances ...
2025-03-09 07:38:06: [retrieval_preprocessing] finished and saved retrieval indices for episode 11803 [episode count 7/20]
[retrieval_preprocessing] for episode 23581 [episode count 8/20], we have num_retrieval=np.int64(3256) num_query=np.int64(98)
2025-03-09 07:38:06,458 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-09 07:38:07,085 [INFO]: Launching the whole pipeline 03/09/2025, 07:38:07
2025-03-09 07:38:07,085 [INFO]: Reading total number of vectors and dimension 03/09/2025, 07:38:07
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 2012.62it/s]
2025-03-09 07:38:07,111 [INFO]: There are 3256 embeddings of dim 49152
2025-03-09 07:38:07,111 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0264 secs
2025-03-09 07:38:07,111 [INFO]: 	Compute estimated construction time of the index 03/09/2025, 07:38:07
2025-03-09 07:38:07,112 [INFO]: 		-> Train: 16.7 minutes
2025-03-09 07:38:07,112 [INFO]: 		-> Add: 1.8 seconds
2025-03-09 07:38:07,112 [INFO]: 		Total: 16.7 minutes
2025-03-09 07:38:07,112 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0001 secs
2025-03-09 07:38:07,112 [INFO]: 	Checking that your have enough memory available to create the index 03/09/2025, 07:38:07
2025-03-09 07:38:07,112 [INFO]: 672.0MB of memory will be needed to build the index (more might be used if you have more)
2025-03-09 07:38:07,112 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0001 secs
2025-03-09 07:38:07,112 [INFO]: 	Selecting most promising index types given data characteristics 03/09/2025, 07:38:07
2025-03-09 07:38:07,112 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-09 07:38:07,112 [INFO]: 	Creating the index 03/09/2025, 07:38:07
2025-03-09 07:38:07,112 [INFO]: 		-> Instanciate the index HNSW15 03/09/2025, 07:38:07
2025-03-09 07:38:07,113 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0009 secs
2025-03-09 07:38:07,113 [INFO]: 		-> Adding the vectors to the index 03/09/2025, 07:38:07
2025-03-09 07:38:07,113 [INFO]: The memory available for adding the vectors is 49.4GB(total available - used by the index)
2025-03-09 07:38:07,113 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/13 [00:00<?, ?it/s]  8%|▊         | 1/13 [00:00<00:01,  7.94it/s] 46%|████▌     | 6/13 [00:00<00:00, 27.81it/s] 85%|████████▍ | 11/13 [00:00<00:00, 34.74it/s]100%|██████████| 13/13 [00:03<00:00,  4.04it/s]
2025-03-09 07:38:10,337 [INFO]: 	Computing best hyperparameters for index knn.index 03/09/2025, 07:38:10
2025-03-09 07:38:46,182 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 35.8447 secs
2025-03-09 07:38:46,182 [INFO]: The best hyperparameters are: efSearch=147
2025-03-09 07:38:46,183 [INFO]: 	Compute fast metrics 03/09/2025, 07:38:46
  0%|          | 0/4 [00:00<?, ?it/s] 50%|█████     | 2/4 [00:00<00:00, 18.93it/s] 75%|███████▌  | 3/4 [00:00<00:00, 19.44it/s]
2025-03-09 07:38:58,048 [INFO]: 	>>> Finished "Compute fast metrics" in 11.8654 secs
2025-03-09 07:38:58,050 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 50.9372 secs
2025-03-09 07:38:58,050 [INFO]: {
2025-03-09 07:38:58,050 [INFO]: 	index_key: HNSW15
2025-03-09 07:38:58,050 [INFO]: 	index_param: efSearch=147
2025-03-09 07:38:58,050 [INFO]: 	index_path: knn.index
2025-03-09 07:38:58,050 [INFO]: 	size in bytes: 640598170
2025-03-09 07:38:58,050 [INFO]: 	avg_search_speed_ms: 9.169465931999735
2025-03-09 07:38:58,050 [INFO]: 	99p_search_speed_ms: 19.75146338809281
2025-03-09 07:38:58,050 [INFO]: 	reconstruction error %: 0.0
2025-03-09 07:38:58,050 [INFO]: 	nb vectors: 3256
2025-03-09 07:38:58,050 [INFO]: 	vectors dimension: 49152
2025-03-09 07:38:58,050 [INFO]: 	compression ratio: 0.9993092050200518
2025-03-09 07:38:58,050 [INFO]: }
2025-03-09 07:38:58,051 [INFO]: 	>>> Finished "Creating the index" in 50.9386 secs
2025-03-09 07:38:58,051 [INFO]: >>> Finished "Launching the whole pipeline" in 50.9656 secs
2025-03-09 07:38:58: [retrieval_preprocessing] calculating distances ...
2025-03-09 07:38:58: [retrieval_preprocessing] finished and saved retrieval indices for episode 23581 [episode count 8/20]
[retrieval_preprocessing] for episode 10782 [episode count 9/20], we have num_retrieval=np.int64(3197) num_query=np.int64(157)
2025-03-09 07:38:59,001 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-09 07:38:59,393 [INFO]: Launching the whole pipeline 03/09/2025, 07:38:59
2025-03-09 07:38:59,394 [INFO]: Reading total number of vectors and dimension 03/09/2025, 07:38:59
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1728.90it/s]
2025-03-09 07:38:59,422 [INFO]: There are 3197 embeddings of dim 49152
2025-03-09 07:38:59,422 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0283 secs
2025-03-09 07:38:59,422 [INFO]: 	Compute estimated construction time of the index 03/09/2025, 07:38:59
2025-03-09 07:38:59,422 [INFO]: 		-> Train: 16.7 minutes
2025-03-09 07:38:59,422 [INFO]: 		-> Add: 1.8 seconds
2025-03-09 07:38:59,422 [INFO]: 		Total: 16.7 minutes
2025-03-09 07:38:59,422 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0003 secs
2025-03-09 07:38:59,422 [INFO]: 	Checking that your have enough memory available to create the index 03/09/2025, 07:38:59
2025-03-09 07:38:59,423 [INFO]: 659.8MB of memory will be needed to build the index (more might be used if you have more)
2025-03-09 07:38:59,423 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0005 secs
2025-03-09 07:38:59,423 [INFO]: 	Selecting most promising index types given data characteristics 03/09/2025, 07:38:59
2025-03-09 07:38:59,423 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-09 07:38:59,423 [INFO]: 	Creating the index 03/09/2025, 07:38:59
2025-03-09 07:38:59,423 [INFO]: 		-> Instanciate the index HNSW15 03/09/2025, 07:38:59
2025-03-09 07:38:59,426 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0028 secs
2025-03-09 07:38:59,427 [INFO]: 		-> Adding the vectors to the index 03/09/2025, 07:38:59
2025-03-09 07:38:59,427 [INFO]: The memory available for adding the vectors is 49.4GB(total available - used by the index)
2025-03-09 07:38:59,427 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/13 [00:00<?, ?it/s] 15%|█▌        | 2/13 [00:00<00:00, 19.97it/s] 62%|██████▏   | 8/13 [00:00<00:00, 43.26it/s]100%|██████████| 13/13 [00:02<00:00,  4.34it/s]100%|██████████| 13/13 [00:02<00:00,  5.35it/s]
2025-03-09 07:39:01,860 [INFO]: 	Computing best hyperparameters for index knn.index 03/09/2025, 07:39:01
2025-03-09 07:39:37,454 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 35.5937 secs
2025-03-09 07:39:37,454 [INFO]: The best hyperparameters are: efSearch=157
2025-03-09 07:39:37,454 [INFO]: 	Compute fast metrics 03/09/2025, 07:39:37
  0%|          | 0/4 [00:00<?, ?it/s] 25%|██▌       | 1/4 [00:00<00:00,  4.93it/s] 50%|█████     | 2/4 [00:00<00:00,  6.44it/s] 75%|███████▌  | 3/4 [00:00<00:00,  7.77it/s]
2025-03-09 07:39:50,531 [INFO]: 	>>> Finished "Compute fast metrics" in 13.0769 secs
2025-03-09 07:39:50,534 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 51.1070 secs
2025-03-09 07:39:50,534 [INFO]: {
2025-03-09 07:39:50,534 [INFO]: 	index_key: HNSW15
2025-03-09 07:39:50,534 [INFO]: 	index_param: efSearch=157
2025-03-09 07:39:50,534 [INFO]: 	index_path: knn.index
2025-03-09 07:39:50,534 [INFO]: 	size in bytes: 628989910
2025-03-09 07:39:50,534 [INFO]: 	avg_search_speed_ms: 9.219497857478014
2025-03-09 07:39:50,534 [INFO]: 	99p_search_speed_ms: 18.774792822077885
2025-03-09 07:39:50,534 [INFO]: 	reconstruction error %: 0.0
2025-03-09 07:39:50,534 [INFO]: 	nb vectors: 3197
2025-03-09 07:39:50,534 [INFO]: 	vectors dimension: 49152
2025-03-09 07:39:50,534 [INFO]: 	compression ratio: 0.9993097917898238
2025-03-09 07:39:50,534 [INFO]: }
2025-03-09 07:39:50,534 [INFO]: 	>>> Finished "Creating the index" in 51.1106 secs
2025-03-09 07:39:50,534 [INFO]: >>> Finished "Launching the whole pipeline" in 51.1404 secs
2025-03-09 07:39:51: [retrieval_preprocessing] calculating distances ...
2025-03-09 07:39:51: [retrieval_preprocessing] finished and saved retrieval indices for episode 10782 [episode count 9/20]
[retrieval_preprocessing] for episode 41502 [episode count 10/20], we have num_retrieval=np.int64(3220) num_query=np.int64(134)
2025-03-09 07:39:51,809 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-09 07:39:52,230 [INFO]: Launching the whole pipeline 03/09/2025, 07:39:52
2025-03-09 07:39:52,231 [INFO]: Reading total number of vectors and dimension 03/09/2025, 07:39:52
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1167.35it/s]
2025-03-09 07:39:52,263 [INFO]: There are 3220 embeddings of dim 49152
2025-03-09 07:39:52,263 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0325 secs
2025-03-09 07:39:52,263 [INFO]: 	Compute estimated construction time of the index 03/09/2025, 07:39:52
2025-03-09 07:39:52,263 [INFO]: 		-> Train: 16.7 minutes
2025-03-09 07:39:52,263 [INFO]: 		-> Add: 1.8 seconds
2025-03-09 07:39:52,263 [INFO]: 		Total: 16.7 minutes
2025-03-09 07:39:52,263 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0001 secs
2025-03-09 07:39:52,263 [INFO]: 	Checking that your have enough memory available to create the index 03/09/2025, 07:39:52
2025-03-09 07:39:52,263 [INFO]: 664.5MB of memory will be needed to build the index (more might be used if you have more)
2025-03-09 07:39:52,264 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0002 secs
2025-03-09 07:39:52,264 [INFO]: 	Selecting most promising index types given data characteristics 03/09/2025, 07:39:52
2025-03-09 07:39:52,264 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-09 07:39:52,264 [INFO]: 	Creating the index 03/09/2025, 07:39:52
2025-03-09 07:39:52,264 [INFO]: 		-> Instanciate the index HNSW15 03/09/2025, 07:39:52
2025-03-09 07:39:52,265 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0009 secs
2025-03-09 07:39:52,265 [INFO]: 		-> Adding the vectors to the index 03/09/2025, 07:39:52
2025-03-09 07:39:52,265 [INFO]: The memory available for adding the vectors is 49.4GB(total available - used by the index)
2025-03-09 07:39:52,265 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/13 [00:00<?, ?it/s]  8%|▊         | 1/13 [00:00<00:01,  9.14it/s] 54%|█████▍    | 7/13 [00:00<00:00, 34.83it/s]100%|██████████| 13/13 [00:02<00:00,  3.90it/s]100%|██████████| 13/13 [00:02<00:00,  4.59it/s]
2025-03-09 07:39:55,101 [INFO]: 	Computing best hyperparameters for index knn.index 03/09/2025, 07:39:55
2025-03-09 07:40:32,080 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 36.9786 secs
2025-03-09 07:40:32,080 [INFO]: The best hyperparameters are: efSearch=165
2025-03-09 07:40:32,080 [INFO]: 	Compute fast metrics 03/09/2025, 07:40:32
  0%|          | 0/4 [00:00<?, ?it/s] 25%|██▌       | 1/4 [00:00<00:00,  8.82it/s] 75%|███████▌  | 3/4 [00:00<00:00, 12.47it/s]
2025-03-09 07:40:44,410 [INFO]: 	>>> Finished "Compute fast metrics" in 12.3289 secs
2025-03-09 07:40:44,412 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 52.1467 secs
2025-03-09 07:40:44,412 [INFO]: {
2025-03-09 07:40:44,412 [INFO]: 	index_key: HNSW15
2025-03-09 07:40:44,412 [INFO]: 	index_param: efSearch=165
2025-03-09 07:40:44,412 [INFO]: 	index_path: knn.index
2025-03-09 07:40:44,412 [INFO]: 	size in bytes: 633515050
2025-03-09 07:40:44,412 [INFO]: 	avg_search_speed_ms: 9.085874261205964
2025-03-09 07:40:44,412 [INFO]: 	99p_search_speed_ms: 18.699571955949068
2025-03-09 07:40:44,412 [INFO]: 	reconstruction error %: 0.0
2025-03-09 07:40:44,412 [INFO]: 	nb vectors: 3220
2025-03-09 07:40:44,412 [INFO]: 	vectors dimension: 49152
2025-03-09 07:40:44,412 [INFO]: 	compression ratio: 0.9993097401553444
2025-03-09 07:40:44,412 [INFO]: }
2025-03-09 07:40:44,412 [INFO]: 	>>> Finished "Creating the index" in 52.1483 secs
2025-03-09 07:40:44,412 [INFO]: >>> Finished "Launching the whole pipeline" in 52.1814 secs
2025-03-09 07:40:44: [retrieval_preprocessing] calculating distances ...
2025-03-09 07:40:45: [retrieval_preprocessing] finished and saved retrieval indices for episode 41502 [episode count 10/20]
[retrieval_preprocessing] for episode 66589 [episode count 11/20], we have num_retrieval=np.int64(3267) num_query=np.int64(87)
2025-03-09 07:40:45,524 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-09 07:40:45,983 [INFO]: Launching the whole pipeline 03/09/2025, 07:40:45
2025-03-09 07:40:45,983 [INFO]: Reading total number of vectors and dimension 03/09/2025, 07:40:45
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1424.70it/s]
2025-03-09 07:40:46,009 [INFO]: There are 3267 embeddings of dim 49152
2025-03-09 07:40:46,010 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0265 secs
2025-03-09 07:40:46,010 [INFO]: 	Compute estimated construction time of the index 03/09/2025, 07:40:46
2025-03-09 07:40:46,010 [INFO]: 		-> Train: 16.7 minutes
2025-03-09 07:40:46,010 [INFO]: 		-> Add: 1.8 seconds
2025-03-09 07:40:46,010 [INFO]: 		Total: 16.7 minutes
2025-03-09 07:40:46,010 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0001 secs
2025-03-09 07:40:46,010 [INFO]: 	Checking that your have enough memory available to create the index 03/09/2025, 07:40:46
2025-03-09 07:40:46,010 [INFO]: 674.2MB of memory will be needed to build the index (more might be used if you have more)
2025-03-09 07:40:46,010 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0002 secs
2025-03-09 07:40:46,010 [INFO]: 	Selecting most promising index types given data characteristics 03/09/2025, 07:40:46
2025-03-09 07:40:46,010 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-09 07:40:46,010 [INFO]: 	Creating the index 03/09/2025, 07:40:46
2025-03-09 07:40:46,010 [INFO]: 		-> Instanciate the index HNSW15 03/09/2025, 07:40:46
2025-03-09 07:40:46,011 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0010 secs
2025-03-09 07:40:46,011 [INFO]: 		-> Adding the vectors to the index 03/09/2025, 07:40:46
2025-03-09 07:40:46,011 [INFO]: The memory available for adding the vectors is 49.4GB(total available - used by the index)
2025-03-09 07:40:46,012 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/13 [00:00<?, ?it/s] 15%|█▌        | 2/13 [00:00<00:00, 18.45it/s] 54%|█████▍    | 7/13 [00:00<00:00, 35.82it/s]100%|██████████| 13/13 [00:02<00:00,  4.02it/s]100%|██████████| 13/13 [00:02<00:00,  4.82it/s]
2025-03-09 07:40:48,714 [INFO]: 	Computing best hyperparameters for index knn.index 03/09/2025, 07:40:48
2025-03-09 07:41:29,092 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 40.3774 secs
2025-03-09 07:41:29,093 [INFO]: The best hyperparameters are: efSearch=169
2025-03-09 07:41:29,093 [INFO]: 	Compute fast metrics 03/09/2025, 07:41:29
  0%|          | 0/4 [00:00<?, ?it/s] 50%|█████     | 2/4 [00:00<00:00, 18.58it/s] 75%|███████▌  | 3/4 [00:00<00:00, 20.67it/s]
2025-03-09 07:41:43,015 [INFO]: 	>>> Finished "Compute fast metrics" in 13.9226 secs
2025-03-09 07:41:43,017 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 57.0056 secs
2025-03-09 07:41:43,017 [INFO]: {
2025-03-09 07:41:43,017 [INFO]: 	index_key: HNSW15
2025-03-09 07:41:43,017 [INFO]: 	index_param: efSearch=169
2025-03-09 07:41:43,017 [INFO]: 	index_path: knn.index
2025-03-09 07:41:43,017 [INFO]: 	size in bytes: 642762490
2025-03-09 07:41:43,017 [INFO]: 	avg_search_speed_ms: 9.908657371480945
2025-03-09 07:41:43,017 [INFO]: 	99p_search_speed_ms: 21.7692271247506
2025-03-09 07:41:43,017 [INFO]: 	reconstruction error %: 0.0
2025-03-09 07:41:43,017 [INFO]: 	nb vectors: 3267
2025-03-09 07:41:43,017 [INFO]: 	vectors dimension: 49152
2025-03-09 07:41:43,017 [INFO]: 	compression ratio: 0.9993089920353007
2025-03-09 07:41:43,017 [INFO]: }
2025-03-09 07:41:43,017 [INFO]: 	>>> Finished "Creating the index" in 57.0071 secs
2025-03-09 07:41:43,017 [INFO]: >>> Finished "Launching the whole pipeline" in 57.0342 secs
2025-03-09 07:41:43: [retrieval_preprocessing] calculating distances ...
2025-03-09 07:41:43: [retrieval_preprocessing] finished and saved retrieval indices for episode 66589 [episode count 11/20]
[retrieval_preprocessing] for episode 11811 [episode count 12/20], we have num_retrieval=np.int64(3216) num_query=np.int64(138)
2025-03-09 07:41:43,975 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-09 07:41:44,383 [INFO]: Launching the whole pipeline 03/09/2025, 07:41:44
2025-03-09 07:41:44,383 [INFO]: Reading total number of vectors and dimension 03/09/2025, 07:41:44
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 2293.22it/s]
2025-03-09 07:41:44,411 [INFO]: There are 3216 embeddings of dim 49152
2025-03-09 07:41:44,411 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0279 secs
2025-03-09 07:41:44,411 [INFO]: 	Compute estimated construction time of the index 03/09/2025, 07:41:44
2025-03-09 07:41:44,411 [INFO]: 		-> Train: 16.7 minutes
2025-03-09 07:41:44,411 [INFO]: 		-> Add: 1.8 seconds
2025-03-09 07:41:44,412 [INFO]: 		Total: 16.7 minutes
2025-03-09 07:41:44,412 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0001 secs
2025-03-09 07:41:44,412 [INFO]: 	Checking that your have enough memory available to create the index 03/09/2025, 07:41:44
2025-03-09 07:41:44,412 [INFO]: 663.7MB of memory will be needed to build the index (more might be used if you have more)
2025-03-09 07:41:44,412 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0001 secs
2025-03-09 07:41:44,412 [INFO]: 	Selecting most promising index types given data characteristics 03/09/2025, 07:41:44
2025-03-09 07:41:44,412 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-09 07:41:44,412 [INFO]: 	Creating the index 03/09/2025, 07:41:44
2025-03-09 07:41:44,412 [INFO]: 		-> Instanciate the index HNSW15 03/09/2025, 07:41:44
2025-03-09 07:41:44,413 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0009 secs
2025-03-09 07:41:44,413 [INFO]: 		-> Adding the vectors to the index 03/09/2025, 07:41:44
2025-03-09 07:41:44,413 [INFO]: The memory available for adding the vectors is 49.4GB(total available - used by the index)
2025-03-09 07:41:44,413 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/13 [00:00<?, ?it/s] 15%|█▌        | 2/13 [00:00<00:00, 18.07it/s] 62%|██████▏   | 8/13 [00:00<00:00, 37.79it/s]100%|██████████| 13/13 [00:02<00:00,  4.03it/s]100%|██████████| 13/13 [00:02<00:00,  4.96it/s]
2025-03-09 07:41:47,035 [INFO]: 	Computing best hyperparameters for index knn.index 03/09/2025, 07:41:47
2025-03-09 07:42:21,327 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 34.2915 secs
2025-03-09 07:42:21,327 [INFO]: The best hyperparameters are: efSearch=172
2025-03-09 07:42:21,327 [INFO]: 	Compute fast metrics 03/09/2025, 07:42:21
  0%|          | 0/4 [00:00<?, ?it/s] 75%|███████▌  | 3/4 [00:00<00:00, 26.35it/s] 75%|███████▌  | 3/4 [00:00<00:00, 22.60it/s]
2025-03-09 07:42:35,154 [INFO]: 	>>> Finished "Compute fast metrics" in 13.8260 secs
2025-03-09 07:42:35,155 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 50.7425 secs
2025-03-09 07:42:35,156 [INFO]: {
2025-03-09 07:42:35,156 [INFO]: 	index_key: HNSW15
2025-03-09 07:42:35,156 [INFO]: 	index_param: efSearch=172
2025-03-09 07:42:35,156 [INFO]: 	index_path: knn.index
2025-03-09 07:42:35,156 [INFO]: 	size in bytes: 632728030
2025-03-09 07:42:35,156 [INFO]: 	avg_search_speed_ms: 9.267927334100989
2025-03-09 07:42:35,156 [INFO]: 	99p_search_speed_ms: 21.068420675583187
2025-03-09 07:42:35,156 [INFO]: 	reconstruction error %: 0.0
2025-03-09 07:42:35,156 [INFO]: 	nb vectors: 3216
2025-03-09 07:42:35,156 [INFO]: 	vectors dimension: 49152
2025-03-09 07:42:35,156 [INFO]: 	compression ratio: 0.9993098108835166
2025-03-09 07:42:35,156 [INFO]: }
2025-03-09 07:42:35,156 [INFO]: 	>>> Finished "Creating the index" in 50.7439 secs
2025-03-09 07:42:35,156 [INFO]: >>> Finished "Launching the whole pipeline" in 50.7723 secs
2025-03-09 07:42:35: [retrieval_preprocessing] calculating distances ...
2025-03-09 07:42:36: [retrieval_preprocessing] finished and saved retrieval indices for episode 11811 [episode count 12/20]
[retrieval_preprocessing] for episode 76839 [episode count 13/20], we have num_retrieval=np.int64(3152) num_query=np.int64(202)
2025-03-09 07:42:36,710 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-09 07:42:37,162 [INFO]: Launching the whole pipeline 03/09/2025, 07:42:37
2025-03-09 07:42:37,162 [INFO]: Reading total number of vectors and dimension 03/09/2025, 07:42:37
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 2213.35it/s]
2025-03-09 07:42:37,185 [INFO]: There are 3152 embeddings of dim 49152
2025-03-09 07:42:37,185 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0230 secs
2025-03-09 07:42:37,185 [INFO]: 	Compute estimated construction time of the index 03/09/2025, 07:42:37
2025-03-09 07:42:37,185 [INFO]: 		-> Train: 16.7 minutes
2025-03-09 07:42:37,185 [INFO]: 		-> Add: 1.7 seconds
2025-03-09 07:42:37,185 [INFO]: 		Total: 16.7 minutes
2025-03-09 07:42:37,185 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0001 secs
2025-03-09 07:42:37,185 [INFO]: 	Checking that your have enough memory available to create the index 03/09/2025, 07:42:37
2025-03-09 07:42:37,185 [INFO]: 650.5MB of memory will be needed to build the index (more might be used if you have more)
2025-03-09 07:42:37,185 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0001 secs
2025-03-09 07:42:37,185 [INFO]: 	Selecting most promising index types given data characteristics 03/09/2025, 07:42:37
2025-03-09 07:42:37,185 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-09 07:42:37,185 [INFO]: 	Creating the index 03/09/2025, 07:42:37
2025-03-09 07:42:37,185 [INFO]: 		-> Instanciate the index HNSW15 03/09/2025, 07:42:37
2025-03-09 07:42:37,186 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0009 secs
2025-03-09 07:42:37,186 [INFO]: 		-> Adding the vectors to the index 03/09/2025, 07:42:37
2025-03-09 07:42:37,186 [INFO]: The memory available for adding the vectors is 49.4GB(total available - used by the index)
2025-03-09 07:42:37,186 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/13 [00:00<?, ?it/s] 15%|█▌        | 2/13 [00:00<00:00, 17.63it/s] 54%|█████▍    | 7/13 [00:00<00:00, 32.32it/s]100%|██████████| 13/13 [00:02<00:00,  3.72it/s]100%|██████████| 13/13 [00:02<00:00,  4.46it/s]
2025-03-09 07:42:40,106 [INFO]: 	Computing best hyperparameters for index knn.index 03/09/2025, 07:42:40
2025-03-09 07:43:18,486 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 38.3798 secs
2025-03-09 07:43:18,486 [INFO]: The best hyperparameters are: efSearch=170
2025-03-09 07:43:18,486 [INFO]: 	Compute fast metrics 03/09/2025, 07:43:18
  0%|          | 0/4 [00:00<?, ?it/s] 50%|█████     | 2/4 [00:00<00:00, 17.71it/s] 75%|███████▌  | 3/4 [00:00<00:00, 19.19it/s]
2025-03-09 07:43:32,490 [INFO]: 	>>> Finished "Compute fast metrics" in 14.0039 secs
2025-03-09 07:43:32,492 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 55.3060 secs
2025-03-09 07:43:32,492 [INFO]: {
2025-03-09 07:43:32,492 [INFO]: 	index_key: HNSW15
2025-03-09 07:43:32,492 [INFO]: 	index_param: efSearch=170
2025-03-09 07:43:32,492 [INFO]: 	index_path: knn.index
2025-03-09 07:43:32,492 [INFO]: 	size in bytes: 620136550
2025-03-09 07:43:32,493 [INFO]: 	avg_search_speed_ms: 8.724433505329536
2025-03-09 07:43:32,493 [INFO]: 	99p_search_speed_ms: 20.589385461062164
2025-03-09 07:43:32,493 [INFO]: 	reconstruction error %: 0.0
2025-03-09 07:43:32,493 [INFO]: 	nb vectors: 3152
2025-03-09 07:43:32,493 [INFO]: 	vectors dimension: 49152
2025-03-09 07:43:32,493 [INFO]: 	compression ratio: 0.9993096133424163
2025-03-09 07:43:32,493 [INFO]: }
2025-03-09 07:43:32,493 [INFO]: 	>>> Finished "Creating the index" in 55.3072 secs
2025-03-09 07:43:32,493 [INFO]: >>> Finished "Launching the whole pipeline" in 55.3308 secs
2025-03-09 07:43:33: [retrieval_preprocessing] calculating distances ...
2025-03-09 07:43:33: [retrieval_preprocessing] finished and saved retrieval indices for episode 76839 [episode count 13/20]
[retrieval_preprocessing] for episode 18994 [episode count 14/20], we have num_retrieval=np.int64(3176) num_query=np.int64(178)
2025-03-09 07:43:34,063 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-09 07:43:34,502 [INFO]: Launching the whole pipeline 03/09/2025, 07:43:34
2025-03-09 07:43:34,502 [INFO]: Reading total number of vectors and dimension 03/09/2025, 07:43:34
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1571.49it/s]
2025-03-09 07:43:34,527 [INFO]: There are 3176 embeddings of dim 49152
2025-03-09 07:43:34,527 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0250 secs
2025-03-09 07:43:34,527 [INFO]: 	Compute estimated construction time of the index 03/09/2025, 07:43:34
2025-03-09 07:43:34,527 [INFO]: 		-> Train: 16.7 minutes
2025-03-09 07:43:34,527 [INFO]: 		-> Add: 1.7 seconds
2025-03-09 07:43:34,527 [INFO]: 		Total: 16.7 minutes
2025-03-09 07:43:34,527 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0001 secs
2025-03-09 07:43:34,527 [INFO]: 	Checking that your have enough memory available to create the index 03/09/2025, 07:43:34
2025-03-09 07:43:34,527 [INFO]: 655.4MB of memory will be needed to build the index (more might be used if you have more)
2025-03-09 07:43:34,527 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0001 secs
2025-03-09 07:43:34,527 [INFO]: 	Selecting most promising index types given data characteristics 03/09/2025, 07:43:34
2025-03-09 07:43:34,527 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-09 07:43:34,527 [INFO]: 	Creating the index 03/09/2025, 07:43:34
2025-03-09 07:43:34,528 [INFO]: 		-> Instanciate the index HNSW15 03/09/2025, 07:43:34
2025-03-09 07:43:34,528 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0008 secs
2025-03-09 07:43:34,528 [INFO]: 		-> Adding the vectors to the index 03/09/2025, 07:43:34
2025-03-09 07:43:34,528 [INFO]: The memory available for adding the vectors is 49.4GB(total available - used by the index)
2025-03-09 07:43:34,529 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/13 [00:00<?, ?it/s]  8%|▊         | 1/13 [00:00<00:01,  8.39it/s] 54%|█████▍    | 7/13 [00:00<00:00, 29.96it/s]100%|██████████| 13/13 [00:02<00:00,  4.28it/s]100%|██████████| 13/13 [00:02<00:00,  4.99it/s]
2025-03-09 07:43:37,137 [INFO]: 	Computing best hyperparameters for index knn.index 03/09/2025, 07:43:37
2025-03-09 07:44:12,697 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 35.5599 secs
2025-03-09 07:44:12,697 [INFO]: The best hyperparameters are: efSearch=155
2025-03-09 07:44:12,697 [INFO]: 	Compute fast metrics 03/09/2025, 07:44:12
  0%|          | 0/4 [00:00<?, ?it/s] 50%|█████     | 2/4 [00:00<00:00, 18.45it/s] 75%|███████▌  | 3/4 [00:00<00:00, 20.19it/s]
2025-03-09 07:44:25,221 [INFO]: 	>>> Finished "Compute fast metrics" in 12.5233 secs
2025-03-09 07:44:25,223 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 50.6941 secs
2025-03-09 07:44:25,223 [INFO]: {
2025-03-09 07:44:25,223 [INFO]: 	index_key: HNSW15
2025-03-09 07:44:25,223 [INFO]: 	index_param: efSearch=155
2025-03-09 07:44:25,223 [INFO]: 	index_path: knn.index
2025-03-09 07:44:25,223 [INFO]: 	size in bytes: 624858310
2025-03-09 07:44:25,223 [INFO]: 	avg_search_speed_ms: 9.475707374645564
2025-03-09 07:44:25,223 [INFO]: 	99p_search_speed_ms: 19.227531338110573
2025-03-09 07:44:25,223 [INFO]: 	reconstruction error %: 0.0
2025-03-09 07:44:25,223 [INFO]: 	nb vectors: 3176
2025-03-09 07:44:25,223 [INFO]: 	vectors dimension: 49152
2025-03-09 07:44:25,223 [INFO]: 	compression ratio: 0.9993097603199036
2025-03-09 07:44:25,223 [INFO]: }
2025-03-09 07:44:25,223 [INFO]: 	>>> Finished "Creating the index" in 50.6954 secs
2025-03-09 07:44:25,223 [INFO]: >>> Finished "Launching the whole pipeline" in 50.7208 secs
2025-03-09 07:44:25: [retrieval_preprocessing] calculating distances ...
2025-03-09 07:44:26: [retrieval_preprocessing] finished and saved retrieval indices for episode 18994 [episode count 14/20]
[retrieval_preprocessing] for episode 47155 [episode count 15/20], we have num_retrieval=np.int64(3252) num_query=np.int64(102)
2025-03-09 07:44:26,534 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-09 07:44:26,956 [INFO]: Launching the whole pipeline 03/09/2025, 07:44:26
2025-03-09 07:44:26,956 [INFO]: Reading total number of vectors and dimension 03/09/2025, 07:44:26
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1481.04it/s]
2025-03-09 07:44:26,980 [INFO]: There are 3252 embeddings of dim 49152
2025-03-09 07:44:26,980 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0242 secs
2025-03-09 07:44:26,980 [INFO]: 	Compute estimated construction time of the index 03/09/2025, 07:44:26
2025-03-09 07:44:26,980 [INFO]: 		-> Train: 16.7 minutes
2025-03-09 07:44:26,980 [INFO]: 		-> Add: 1.8 seconds
2025-03-09 07:44:26,980 [INFO]: 		Total: 16.7 minutes
2025-03-09 07:44:26,980 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0001 secs
2025-03-09 07:44:26,980 [INFO]: 	Checking that your have enough memory available to create the index 03/09/2025, 07:44:26
2025-03-09 07:44:26,981 [INFO]: 671.1MB of memory will be needed to build the index (more might be used if you have more)
2025-03-09 07:44:26,981 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0001 secs
2025-03-09 07:44:26,981 [INFO]: 	Selecting most promising index types given data characteristics 03/09/2025, 07:44:26
2025-03-09 07:44:26,981 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-09 07:44:26,981 [INFO]: 	Creating the index 03/09/2025, 07:44:26
2025-03-09 07:44:26,981 [INFO]: 		-> Instanciate the index HNSW15 03/09/2025, 07:44:26
2025-03-09 07:44:26,982 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0009 secs
2025-03-09 07:44:26,982 [INFO]: 		-> Adding the vectors to the index 03/09/2025, 07:44:26
2025-03-09 07:44:26,982 [INFO]: The memory available for adding the vectors is 49.4GB(total available - used by the index)
2025-03-09 07:44:26,982 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/13 [00:00<?, ?it/s]  8%|▊         | 1/13 [00:00<00:01,  9.86it/s] 54%|█████▍    | 7/13 [00:00<00:00, 36.64it/s]100%|██████████| 13/13 [00:02<00:00,  4.15it/s]100%|██████████| 13/13 [00:02<00:00,  4.88it/s]
2025-03-09 07:44:29,649 [INFO]: 	Computing best hyperparameters for index knn.index 03/09/2025, 07:44:29
2025-03-09 07:45:06,171 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 36.5207 secs
2025-03-09 07:45:06,171 [INFO]: The best hyperparameters are: efSearch=180
2025-03-09 07:45:06,171 [INFO]: 	Compute fast metrics 03/09/2025, 07:45:06
  0%|          | 0/4 [00:00<?, ?it/s] 50%|█████     | 2/4 [00:00<00:00, 19.78it/s] 75%|███████▌  | 3/4 [00:00<00:00, 22.22it/s]
2025-03-09 07:45:19,308 [INFO]: 	>>> Finished "Compute fast metrics" in 13.1369 secs
2025-03-09 07:45:19,310 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 52.3280 secs
2025-03-09 07:45:19,310 [INFO]: {
2025-03-09 07:45:19,310 [INFO]: 	index_key: HNSW15
2025-03-09 07:45:19,310 [INFO]: 	index_param: efSearch=180
2025-03-09 07:45:19,310 [INFO]: 	index_path: knn.index
2025-03-09 07:45:19,310 [INFO]: 	size in bytes: 639811210
2025-03-09 07:45:19,310 [INFO]: 	avg_search_speed_ms: 9.286737039437934
2025-03-09 07:45:19,310 [INFO]: 	99p_search_speed_ms: 20.439002085477114
2025-03-09 07:45:19,310 [INFO]: 	reconstruction error %: 0.0
2025-03-09 07:45:19,310 [INFO]: 	nb vectors: 3252
2025-03-09 07:45:19,310 [INFO]: 	vectors dimension: 49152
2025-03-09 07:45:19,310 [INFO]: 	compression ratio: 0.9993091805940693
2025-03-09 07:45:19,310 [INFO]: }
2025-03-09 07:45:19,310 [INFO]: 	>>> Finished "Creating the index" in 52.3295 secs
2025-03-09 07:45:19,310 [INFO]: >>> Finished "Launching the whole pipeline" in 52.3543 secs
2025-03-09 07:45:19: [retrieval_preprocessing] calculating distances ...
2025-03-09 07:45:20: [retrieval_preprocessing] finished and saved retrieval indices for episode 47155 [episode count 15/20]
[retrieval_preprocessing] for episode 46132 [episode count 16/20], we have num_retrieval=np.int64(3258) num_query=np.int64(96)
2025-03-09 07:45:20,431 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-09 07:45:20,905 [INFO]: Launching the whole pipeline 03/09/2025, 07:45:20
2025-03-09 07:45:20,905 [INFO]: Reading total number of vectors and dimension 03/09/2025, 07:45:20
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1718.27it/s]
2025-03-09 07:45:20,931 [INFO]: There are 3258 embeddings of dim 49152
2025-03-09 07:45:20,932 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0260 secs
2025-03-09 07:45:20,932 [INFO]: 	Compute estimated construction time of the index 03/09/2025, 07:45:20
2025-03-09 07:45:20,932 [INFO]: 		-> Train: 16.7 minutes
2025-03-09 07:45:20,932 [INFO]: 		-> Add: 1.8 seconds
2025-03-09 07:45:20,932 [INFO]: 		Total: 16.7 minutes
2025-03-09 07:45:20,932 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0001 secs
2025-03-09 07:45:20,932 [INFO]: 	Checking that your have enough memory available to create the index 03/09/2025, 07:45:20
2025-03-09 07:45:20,932 [INFO]: 672.4MB of memory will be needed to build the index (more might be used if you have more)
2025-03-09 07:45:20,932 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0002 secs
2025-03-09 07:45:20,932 [INFO]: 	Selecting most promising index types given data characteristics 03/09/2025, 07:45:20
2025-03-09 07:45:20,932 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-09 07:45:20,932 [INFO]: 	Creating the index 03/09/2025, 07:45:20
2025-03-09 07:45:20,932 [INFO]: 		-> Instanciate the index HNSW15 03/09/2025, 07:45:20
2025-03-09 07:45:20,933 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0008 secs
2025-03-09 07:45:20,933 [INFO]: 		-> Adding the vectors to the index 03/09/2025, 07:45:20
2025-03-09 07:45:20,933 [INFO]: The memory available for adding the vectors is 49.4GB(total available - used by the index)
2025-03-09 07:45:20,933 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/13 [00:00<?, ?it/s] 15%|█▌        | 2/13 [00:00<00:00, 17.16it/s] 54%|█████▍    | 7/13 [00:00<00:00, 32.69it/s] 85%|████████▍ | 11/13 [00:00<00:00, 34.19it/s]100%|██████████| 13/13 [00:02<00:00,  4.42it/s]
2025-03-09 07:45:23,876 [INFO]: 	Computing best hyperparameters for index knn.index 03/09/2025, 07:45:23
2025-03-09 07:45:59,455 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 35.5786 secs
2025-03-09 07:45:59,455 [INFO]: The best hyperparameters are: efSearch=154
2025-03-09 07:45:59,456 [INFO]: 	Compute fast metrics 03/09/2025, 07:45:59
  0%|          | 0/4 [00:00<?, ?it/s] 50%|█████     | 2/4 [00:00<00:00, 16.89it/s] 75%|███████▌  | 3/4 [00:00<00:00, 17.94it/s]
2025-03-09 07:46:12,317 [INFO]: 	>>> Finished "Compute fast metrics" in 12.8615 secs
2025-03-09 07:46:12,320 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 51.3863 secs
2025-03-09 07:46:12,320 [INFO]: {
2025-03-09 07:46:12,320 [INFO]: 	index_key: HNSW15
2025-03-09 07:46:12,320 [INFO]: 	index_param: efSearch=154
2025-03-09 07:46:12,320 [INFO]: 	index_path: knn.index
2025-03-09 07:46:12,320 [INFO]: 	size in bytes: 640991710
2025-03-09 07:46:12,320 [INFO]: 	avg_search_speed_ms: 9.27173935953248
2025-03-09 07:46:12,320 [INFO]: 	99p_search_speed_ms: 19.91304804105312
2025-03-09 07:46:12,320 [INFO]: 	reconstruction error %: 0.0
2025-03-09 07:46:12,320 [INFO]: 	nb vectors: 3258
2025-03-09 07:46:12,320 [INFO]: 	vectors dimension: 49152
2025-03-09 07:46:12,320 [INFO]: 	compression ratio: 0.9993091236702578
2025-03-09 07:46:12,320 [INFO]: }
2025-03-09 07:46:12,320 [INFO]: 	>>> Finished "Creating the index" in 51.3876 secs
2025-03-09 07:46:12,320 [INFO]: >>> Finished "Launching the whole pipeline" in 51.4143 secs
2025-03-09 07:46:12: [retrieval_preprocessing] calculating distances ...
2025-03-09 07:46:12: [retrieval_preprocessing] finished and saved retrieval indices for episode 46132 [episode count 16/20]
[retrieval_preprocessing] for episode 43573 [episode count 17/20], we have num_retrieval=np.int64(3156) num_query=np.int64(198)
2025-03-09 07:46:13,247 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-09 07:46:13,684 [INFO]: Launching the whole pipeline 03/09/2025, 07:46:13
2025-03-09 07:46:13,685 [INFO]: Reading total number of vectors and dimension 03/09/2025, 07:46:13
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1204.91it/s]
2025-03-09 07:46:13,713 [INFO]: There are 3156 embeddings of dim 49152
2025-03-09 07:46:13,713 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0284 secs
2025-03-09 07:46:13,713 [INFO]: 	Compute estimated construction time of the index 03/09/2025, 07:46:13
2025-03-09 07:46:13,713 [INFO]: 		-> Train: 16.7 minutes
2025-03-09 07:46:13,714 [INFO]: 		-> Add: 1.7 seconds
2025-03-09 07:46:13,714 [INFO]: 		Total: 16.7 minutes
2025-03-09 07:46:13,714 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0003 secs
2025-03-09 07:46:13,714 [INFO]: 	Checking that your have enough memory available to create the index 03/09/2025, 07:46:13
2025-03-09 07:46:13,714 [INFO]: 651.3MB of memory will be needed to build the index (more might be used if you have more)
2025-03-09 07:46:13,714 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0005 secs
2025-03-09 07:46:13,714 [INFO]: 	Selecting most promising index types given data characteristics 03/09/2025, 07:46:13
2025-03-09 07:46:13,715 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-09 07:46:13,715 [INFO]: 	Creating the index 03/09/2025, 07:46:13
2025-03-09 07:46:13,716 [INFO]: 		-> Instanciate the index HNSW15 03/09/2025, 07:46:13
2025-03-09 07:46:13,718 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0026 secs
2025-03-09 07:46:13,718 [INFO]: 		-> Adding the vectors to the index 03/09/2025, 07:46:13
2025-03-09 07:46:13,719 [INFO]: The memory available for adding the vectors is 49.4GB(total available - used by the index)
2025-03-09 07:46:13,719 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/13 [00:00<?, ?it/s] 15%|█▌        | 2/13 [00:00<00:00, 14.89it/s] 54%|█████▍    | 7/13 [00:00<00:00, 32.68it/s] 92%|█████████▏| 12/13 [00:00<00:00, 39.45it/s]100%|██████████| 13/13 [00:02<00:00,  4.39it/s]
2025-03-09 07:46:16,686 [INFO]: 	Computing best hyperparameters for index knn.index 03/09/2025, 07:46:16
2025-03-09 07:46:51,276 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 34.5894 secs
2025-03-09 07:46:51,276 [INFO]: The best hyperparameters are: efSearch=159
2025-03-09 07:46:51,276 [INFO]: 	Compute fast metrics 03/09/2025, 07:46:51
  0%|          | 0/4 [00:00<?, ?it/s] 50%|█████     | 2/4 [00:00<00:00, 17.20it/s] 75%|███████▌  | 3/4 [00:00<00:00, 18.12it/s]
2025-03-09 07:47:07,196 [INFO]: 	>>> Finished "Compute fast metrics" in 15.9192 secs
2025-03-09 07:47:07,197 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 53.4789 secs
2025-03-09 07:47:07,198 [INFO]: {
2025-03-09 07:47:07,198 [INFO]: 	index_key: HNSW15
2025-03-09 07:47:07,198 [INFO]: 	index_param: efSearch=159
2025-03-09 07:47:07,198 [INFO]: 	index_path: knn.index
2025-03-09 07:47:07,198 [INFO]: 	size in bytes: 620923510
2025-03-09 07:47:07,198 [INFO]: 	avg_search_speed_ms: 9.34491399109851
2025-03-09 07:47:07,198 [INFO]: 	99p_search_speed_ms: 22.313604699447733
2025-03-09 07:47:07,198 [INFO]: 	reconstruction error %: 0.0
2025-03-09 07:47:07,198 [INFO]: 	nb vectors: 3156
2025-03-09 07:47:07,198 [INFO]: 	vectors dimension: 49152
2025-03-09 07:47:07,198 [INFO]: 	compression ratio: 0.9993096379938972
2025-03-09 07:47:07,198 [INFO]: }
2025-03-09 07:47:07,198 [INFO]: 	>>> Finished "Creating the index" in 53.4823 secs
2025-03-09 07:47:07,198 [INFO]: >>> Finished "Launching the whole pipeline" in 53.5132 secs
2025-03-09 07:47:07: [retrieval_preprocessing] calculating distances ...
2025-03-09 07:47:08: [retrieval_preprocessing] finished and saved retrieval indices for episode 43573 [episode count 17/20]
[retrieval_preprocessing] for episode 72248 [episode count 18/20], we have num_retrieval=np.int64(3187) num_query=np.int64(167)
2025-03-09 07:47:08,857 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-09 07:47:09,317 [INFO]: Launching the whole pipeline 03/09/2025, 07:47:09
2025-03-09 07:47:09,317 [INFO]: Reading total number of vectors and dimension 03/09/2025, 07:47:09
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1458.89it/s]
2025-03-09 07:47:09,346 [INFO]: There are 3187 embeddings of dim 49152
2025-03-09 07:47:09,346 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0293 secs
2025-03-09 07:47:09,346 [INFO]: 	Compute estimated construction time of the index 03/09/2025, 07:47:09
2025-03-09 07:47:09,347 [INFO]: 		-> Train: 16.7 minutes
2025-03-09 07:47:09,347 [INFO]: 		-> Add: 1.8 seconds
2025-03-09 07:47:09,347 [INFO]: 		Total: 16.7 minutes
2025-03-09 07:47:09,347 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0007 secs
2025-03-09 07:47:09,347 [INFO]: 	Checking that your have enough memory available to create the index 03/09/2025, 07:47:09
2025-03-09 07:47:09,348 [INFO]: 657.7MB of memory will be needed to build the index (more might be used if you have more)
2025-03-09 07:47:09,348 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0005 secs
2025-03-09 07:47:09,348 [INFO]: 	Selecting most promising index types given data characteristics 03/09/2025, 07:47:09
2025-03-09 07:47:09,348 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-09 07:47:09,348 [INFO]: 	Creating the index 03/09/2025, 07:47:09
2025-03-09 07:47:09,348 [INFO]: 		-> Instanciate the index HNSW15 03/09/2025, 07:47:09
2025-03-09 07:47:09,351 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0028 secs
2025-03-09 07:47:09,351 [INFO]: 		-> Adding the vectors to the index 03/09/2025, 07:47:09
2025-03-09 07:47:09,352 [INFO]: The memory available for adding the vectors is 49.4GB(total available - used by the index)
2025-03-09 07:47:09,352 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/13 [00:00<?, ?it/s]  8%|▊         | 1/13 [00:00<00:01,  8.91it/s] 46%|████▌     | 6/13 [00:00<00:00, 30.96it/s] 85%|████████▍ | 11/13 [00:00<00:00, 38.05it/s]100%|██████████| 13/13 [00:02<00:00,  4.37it/s]
2025-03-09 07:47:12,331 [INFO]: 	Computing best hyperparameters for index knn.index 03/09/2025, 07:47:12
2025-03-09 07:47:51,292 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 38.9600 secs
2025-03-09 07:47:51,292 [INFO]: The best hyperparameters are: efSearch=161
2025-03-09 07:47:51,292 [INFO]: 	Compute fast metrics 03/09/2025, 07:47:51
  0%|          | 0/4 [00:00<?, ?it/s] 25%|██▌       | 1/4 [00:00<00:00,  7.75it/s] 75%|███████▌  | 3/4 [00:00<00:00, 14.96it/s]
2025-03-09 07:48:03,972 [INFO]: 	>>> Finished "Compute fast metrics" in 12.6800 secs
2025-03-09 07:48:03,974 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 54.6227 secs
2025-03-09 07:48:03,975 [INFO]: {
2025-03-09 07:48:03,975 [INFO]: 	index_key: HNSW15
2025-03-09 07:48:03,975 [INFO]: 	index_param: efSearch=161
2025-03-09 07:48:03,975 [INFO]: 	index_path: knn.index
2025-03-09 07:48:03,975 [INFO]: 	size in bytes: 627022510
2025-03-09 07:48:03,975 [INFO]: 	avg_search_speed_ms: 9.805202410401156
2025-03-09 07:48:03,975 [INFO]: 	99p_search_speed_ms: 20.463938231114298
2025-03-09 07:48:03,975 [INFO]: 	reconstruction error %: 0.0
2025-03-09 07:48:03,975 [INFO]: 	nb vectors: 3187
2025-03-09 07:48:03,975 [INFO]: 	vectors dimension: 49152
2025-03-09 07:48:03,975 [INFO]: 	compression ratio: 0.9993097313204912
2025-03-09 07:48:03,975 [INFO]: }
2025-03-09 07:48:03,975 [INFO]: 	>>> Finished "Creating the index" in 54.6267 secs
2025-03-09 07:48:03,975 [INFO]: >>> Finished "Launching the whole pipeline" in 54.6581 secs
2025-03-09 07:48:04: [retrieval_preprocessing] calculating distances ...
2025-03-09 07:48:05: [retrieval_preprocessing] finished and saved retrieval indices for episode 72248 [episode count 18/20]
[retrieval_preprocessing] for episode 83517 [episode count 19/20], we have num_retrieval=np.int64(3107) num_query=np.int64(247)
2025-03-09 07:48:05,494 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-09 07:48:06,066 [INFO]: Launching the whole pipeline 03/09/2025, 07:48:06
2025-03-09 07:48:06,066 [INFO]: Reading total number of vectors and dimension 03/09/2025, 07:48:06
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1709.17it/s]
2025-03-09 07:48:06,096 [INFO]: There are 3107 embeddings of dim 49152
2025-03-09 07:48:06,097 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0305 secs
2025-03-09 07:48:06,097 [INFO]: 	Compute estimated construction time of the index 03/09/2025, 07:48:06
2025-03-09 07:48:06,097 [INFO]: 		-> Train: 16.7 minutes
2025-03-09 07:48:06,097 [INFO]: 		-> Add: 1.7 seconds
2025-03-09 07:48:06,097 [INFO]: 		Total: 16.7 minutes
2025-03-09 07:48:06,097 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0003 secs
2025-03-09 07:48:06,097 [INFO]: 	Checking that your have enough memory available to create the index 03/09/2025, 07:48:06
2025-03-09 07:48:06,098 [INFO]: 641.2MB of memory will be needed to build the index (more might be used if you have more)
2025-03-09 07:48:06,098 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0005 secs
2025-03-09 07:48:06,098 [INFO]: 	Selecting most promising index types given data characteristics 03/09/2025, 07:48:06
2025-03-09 07:48:06,098 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-09 07:48:06,098 [INFO]: 	Creating the index 03/09/2025, 07:48:06
2025-03-09 07:48:06,098 [INFO]: 		-> Instanciate the index HNSW15 03/09/2025, 07:48:06
2025-03-09 07:48:06,101 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0028 secs
2025-03-09 07:48:06,101 [INFO]: 		-> Adding the vectors to the index 03/09/2025, 07:48:06
2025-03-09 07:48:06,102 [INFO]: The memory available for adding the vectors is 49.4GB(total available - used by the index)
2025-03-09 07:48:06,102 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/13 [00:00<?, ?it/s] 15%|█▌        | 2/13 [00:00<00:00, 17.22it/s] 54%|█████▍    | 7/13 [00:00<00:00, 33.02it/s] 85%|████████▍ | 11/13 [00:00<00:00, 32.52it/s]100%|██████████| 13/13 [00:02<00:00,  4.72it/s]
2025-03-09 07:48:08,859 [INFO]: 	Computing best hyperparameters for index knn.index 03/09/2025, 07:48:08
2025-03-09 07:48:49,117 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 40.2569 secs
2025-03-09 07:48:49,117 [INFO]: The best hyperparameters are: efSearch=157
2025-03-09 07:48:49,117 [INFO]: 	Compute fast metrics 03/09/2025, 07:48:49
  0%|          | 0/4 [00:00<?, ?it/s] 25%|██▌       | 1/4 [00:00<00:00,  8.11it/s] 75%|███████▌  | 3/4 [00:00<00:00, 15.09it/s]
2025-03-09 07:49:04,523 [INFO]: 	>>> Finished "Compute fast metrics" in 15.4063 secs
2025-03-09 07:49:04,525 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 58.4236 secs
2025-03-09 07:49:04,525 [INFO]: {
2025-03-09 07:49:04,525 [INFO]: 	index_key: HNSW15
2025-03-09 07:49:04,525 [INFO]: 	index_param: efSearch=157
2025-03-09 07:49:04,525 [INFO]: 	index_path: knn.index
2025-03-09 07:49:04,525 [INFO]: 	size in bytes: 611283010
2025-03-09 07:49:04,525 [INFO]: 	avg_search_speed_ms: 8.491626832948867
2025-03-09 07:49:04,525 [INFO]: 	99p_search_speed_ms: 19.76166256237775
2025-03-09 07:49:04,525 [INFO]: 	reconstruction error %: 0.0
2025-03-09 07:49:04,525 [INFO]: 	nb vectors: 3107
2025-03-09 07:49:04,525 [INFO]: 	vectors dimension: 49152
2025-03-09 07:49:04,525 [INFO]: 	compression ratio: 0.9993097239852945
2025-03-09 07:49:04,525 [INFO]: }
2025-03-09 07:49:04,525 [INFO]: 	>>> Finished "Creating the index" in 58.4272 secs
2025-03-09 07:49:04,525 [INFO]: >>> Finished "Launching the whole pipeline" in 58.4595 secs
2025-03-09 07:49:05: [retrieval_preprocessing] calculating distances ...
2025-03-09 07:49:06: [retrieval_preprocessing] finished and saved retrieval indices for episode 83517 [episode count 19/20]
2025-03-09 07:49:06: [retrieval_preprocessing] finished for (7489911085, 'cloth') [chosen_id count 2/10]
2025-03-09 07:49:08: [retrieval_preprocessing] concatenated all embeddings and indices for 20 episodes for (5576515039, 'marker') [chosen_id count 3/10]
2025-03-09 07:49:08: [retrieval_preprocessing] we have num_total=5594 embedding_dim=49152
[retrieval_preprocessing] for episode 57858 [episode count 0/20], we have num_retrieval=np.int64(5397) num_query=np.int64(197)
2025-03-09 07:49:09,038 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-09 07:49:09,904 [INFO]: Launching the whole pipeline 03/09/2025, 07:49:09
2025-03-09 07:49:09,904 [INFO]: Reading total number of vectors and dimension 03/09/2025, 07:49:09
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 2137.77it/s]
2025-03-09 07:49:09,930 [INFO]: There are 5397 embeddings of dim 49152
2025-03-09 07:49:09,930 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0263 secs
2025-03-09 07:49:09,930 [INFO]: 	Compute estimated construction time of the index 03/09/2025, 07:49:09
2025-03-09 07:49:09,931 [INFO]: 		-> Train: 16.7 minutes
2025-03-09 07:49:09,931 [INFO]: 		-> Add: 3.0 seconds
2025-03-09 07:49:09,931 [INFO]: 		Total: 16.7 minutes
2025-03-09 07:49:09,931 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0001 secs
2025-03-09 07:49:09,931 [INFO]: 	Checking that your have enough memory available to create the index 03/09/2025, 07:49:09
2025-03-09 07:49:09,931 [INFO]: 1.1GB of memory will be needed to build the index (more might be used if you have more)
2025-03-09 07:49:09,931 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0003 secs
2025-03-09 07:49:09,931 [INFO]: 	Selecting most promising index types given data characteristics 03/09/2025, 07:49:09
2025-03-09 07:49:09,931 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-09 07:49:09,931 [INFO]: 	Creating the index 03/09/2025, 07:49:09
2025-03-09 07:49:09,931 [INFO]: 		-> Instanciate the index HNSW15 03/09/2025, 07:49:09
2025-03-09 07:49:09,932 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0011 secs
2025-03-09 07:49:09,932 [INFO]: 		-> Adding the vectors to the index 03/09/2025, 07:49:09
2025-03-09 07:49:09,932 [INFO]: The memory available for adding the vectors is 49.0GB(total available - used by the index)
2025-03-09 07:49:09,932 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/23 [00:00<?, ?it/s]  4%|▍         | 1/23 [00:00<00:02,  8.80it/s] 26%|██▌       | 6/23 [00:00<00:00, 30.06it/s] 43%|████▎     | 10/23 [00:00<00:00, 31.12it/s] 65%|██████▌   | 15/23 [00:00<00:00, 37.29it/s] 87%|████████▋ | 20/23 [00:00<00:00, 40.96it/s]100%|██████████| 23/23 [00:05<00:00,  4.00it/s]
2025-03-09 07:49:15,680 [INFO]: 	Computing best hyperparameters for index knn.index 03/09/2025, 07:49:15
2025-03-09 07:50:03,423 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 47.7425 secs
2025-03-09 07:50:03,423 [INFO]: The best hyperparameters are: efSearch=226
2025-03-09 07:50:03,424 [INFO]: 	Compute fast metrics 03/09/2025, 07:50:03
  0%|          | 0/4 [00:00<?, ?it/s] 50%|█████     | 2/4 [00:00<00:00, 19.94it/s] 75%|███████▌  | 3/4 [00:00<00:00, 19.95it/s]
2025-03-09 07:50:19,475 [INFO]: 	>>> Finished "Compute fast metrics" in 16.0514 secs
2025-03-09 07:50:19,476 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 69.5434 secs
2025-03-09 07:50:19,476 [INFO]: {
2025-03-09 07:50:19,476 [INFO]: 	index_key: HNSW15
2025-03-09 07:50:19,476 [INFO]: 	index_param: efSearch=226
2025-03-09 07:50:19,476 [INFO]: 	index_path: knn.index
2025-03-09 07:50:19,476 [INFO]: 	size in bytes: 1061828170
2025-03-09 07:50:19,476 [INFO]: 	avg_search_speed_ms: 9.017919340339716
2025-03-09 07:50:19,476 [INFO]: 	99p_search_speed_ms: 15.530627528205533
2025-03-09 07:50:19,476 [INFO]: 	reconstruction error %: 0.0
2025-03-09 07:50:19,476 [INFO]: 	nb vectors: 5397
2025-03-09 07:50:19,476 [INFO]: 	vectors dimension: 49152
2025-03-09 07:50:19,476 [INFO]: 	compression ratio: 0.9993079916122398
2025-03-09 07:50:19,476 [INFO]: }
2025-03-09 07:50:19,476 [INFO]: 	>>> Finished "Creating the index" in 69.5449 secs
2025-03-09 07:50:19,476 [INFO]: >>> Finished "Launching the whole pipeline" in 69.5719 secs
2025-03-09 07:50:20: [retrieval_preprocessing] calculating distances ...
2025-03-09 07:50:21: [retrieval_preprocessing] finished and saved retrieval indices for episode 57858 [episode count 0/20]
[retrieval_preprocessing] for episode 5767 [episode count 1/20], we have num_retrieval=np.int64(5148) num_query=np.int64(446)
2025-03-09 07:50:21,617 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-09 07:50:22,304 [INFO]: Launching the whole pipeline 03/09/2025, 07:50:22
2025-03-09 07:50:22,305 [INFO]: Reading total number of vectors and dimension 03/09/2025, 07:50:22
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1444.32it/s]
2025-03-09 07:50:22,333 [INFO]: There are 5148 embeddings of dim 49152
2025-03-09 07:50:22,333 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0289 secs
2025-03-09 07:50:22,334 [INFO]: 	Compute estimated construction time of the index 03/09/2025, 07:50:22
2025-03-09 07:50:22,334 [INFO]: 		-> Train: 16.7 minutes
2025-03-09 07:50:22,334 [INFO]: 		-> Add: 2.8 seconds
2025-03-09 07:50:22,334 [INFO]: 		Total: 16.7 minutes
2025-03-09 07:50:22,334 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0001 secs
2025-03-09 07:50:22,334 [INFO]: 	Checking that your have enough memory available to create the index 03/09/2025, 07:50:22
2025-03-09 07:50:22,334 [INFO]: 1.0GB of memory will be needed to build the index (more might be used if you have more)
2025-03-09 07:50:22,334 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0002 secs
2025-03-09 07:50:22,334 [INFO]: 	Selecting most promising index types given data characteristics 03/09/2025, 07:50:22
2025-03-09 07:50:22,334 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-09 07:50:22,334 [INFO]: 	Creating the index 03/09/2025, 07:50:22
2025-03-09 07:50:22,334 [INFO]: 		-> Instanciate the index HNSW15 03/09/2025, 07:50:22
2025-03-09 07:50:22,335 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0012 secs
2025-03-09 07:50:22,335 [INFO]: 		-> Adding the vectors to the index 03/09/2025, 07:50:22
2025-03-09 07:50:22,335 [INFO]: The memory available for adding the vectors is 49.1GB(total available - used by the index)
2025-03-09 07:50:22,336 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/22 [00:00<?, ?it/s]  5%|▍         | 1/22 [00:00<00:02,  9.85it/s] 27%|██▋       | 6/22 [00:00<00:00, 32.75it/s] 50%|█████     | 11/22 [00:00<00:00, 39.67it/s] 77%|███████▋  | 17/22 [00:00<00:00, 46.32it/s]100%|██████████| 22/22 [00:05<00:00,  2.64it/s]100%|██████████| 22/22 [00:05<00:00,  4.09it/s]
2025-03-09 07:50:27,720 [INFO]: 	Computing best hyperparameters for index knn.index 03/09/2025, 07:50:27
2025-03-09 07:51:13,870 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 46.1497 secs
2025-03-09 07:51:13,871 [INFO]: The best hyperparameters are: efSearch=256
2025-03-09 07:51:13,871 [INFO]: 	Compute fast metrics 03/09/2025, 07:51:13
  0%|          | 0/4 [00:00<?, ?it/s] 50%|█████     | 2/4 [00:00<00:00, 19.52it/s] 75%|███████▌  | 3/4 [00:00<00:00, 21.46it/s]
2025-03-09 07:51:35,816 [INFO]: 	>>> Finished "Compute fast metrics" in 21.9452 secs
2025-03-09 07:51:35,816 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 73.4808 secs
2025-03-09 07:51:35,816 [INFO]: {
2025-03-09 07:51:35,816 [INFO]: 	index_key: HNSW15
2025-03-09 07:51:35,816 [INFO]: 	index_param: efSearch=256
2025-03-09 07:51:35,816 [INFO]: 	index_path: knn.index
2025-03-09 07:51:35,816 [INFO]: 	size in bytes: 1012838410
2025-03-09 07:51:35,816 [INFO]: 	avg_search_speed_ms: 10.47199422972877
2025-03-09 07:51:35,816 [INFO]: 	99p_search_speed_ms: 15.850921499077243
2025-03-09 07:51:35,816 [INFO]: 	reconstruction error %: 0.0
2025-03-09 07:51:35,816 [INFO]: 	nb vectors: 5148
2025-03-09 07:51:35,816 [INFO]: 	vectors dimension: 49152
2025-03-09 07:51:35,817 [INFO]: 	compression ratio: 0.999308452371983
2025-03-09 07:51:35,817 [INFO]: }
2025-03-09 07:51:35,817 [INFO]: 	>>> Finished "Creating the index" in 73.4825 secs
2025-03-09 07:51:35,817 [INFO]: >>> Finished "Launching the whole pipeline" in 73.5120 secs
2025-03-09 07:51:39: [retrieval_preprocessing] calculating distances ...
2025-03-09 07:51:40: [retrieval_preprocessing] finished and saved retrieval indices for episode 5767 [episode count 1/20]
[retrieval_preprocessing] for episode 38667 [episode count 2/20], we have num_retrieval=np.int64(5219) num_query=np.int64(375)
2025-03-09 07:51:41,446 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-09 07:51:42,182 [INFO]: Launching the whole pipeline 03/09/2025, 07:51:42
2025-03-09 07:51:42,182 [INFO]: Reading total number of vectors and dimension 03/09/2025, 07:51:42
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1140.38it/s]
2025-03-09 07:51:42,211 [INFO]: There are 5219 embeddings of dim 49152
2025-03-09 07:51:42,211 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0293 secs
2025-03-09 07:51:42,211 [INFO]: 	Compute estimated construction time of the index 03/09/2025, 07:51:42
2025-03-09 07:51:42,211 [INFO]: 		-> Train: 16.7 minutes
2025-03-09 07:51:42,211 [INFO]: 		-> Add: 2.9 seconds
2025-03-09 07:51:42,211 [INFO]: 		Total: 16.7 minutes
2025-03-09 07:51:42,211 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0001 secs
2025-03-09 07:51:42,211 [INFO]: 	Checking that your have enough memory available to create the index 03/09/2025, 07:51:42
2025-03-09 07:51:42,211 [INFO]: 1.1GB of memory will be needed to build the index (more might be used if you have more)
2025-03-09 07:51:42,212 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0002 secs
2025-03-09 07:51:42,212 [INFO]: 	Selecting most promising index types given data characteristics 03/09/2025, 07:51:42
2025-03-09 07:51:42,212 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-09 07:51:42,212 [INFO]: 	Creating the index 03/09/2025, 07:51:42
2025-03-09 07:51:42,212 [INFO]: 		-> Instanciate the index HNSW15 03/09/2025, 07:51:42
2025-03-09 07:51:42,213 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0012 secs
2025-03-09 07:51:42,213 [INFO]: 		-> Adding the vectors to the index 03/09/2025, 07:51:42
2025-03-09 07:51:42,213 [INFO]: The memory available for adding the vectors is 49.0GB(total available - used by the index)
2025-03-09 07:51:42,213 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/22 [00:00<?, ?it/s]  5%|▍         | 1/22 [00:00<00:02,  8.58it/s] 32%|███▏      | 7/22 [00:00<00:00, 34.18it/s] 59%|█████▉    | 13/22 [00:00<00:00, 42.23it/s] 82%|████████▏ | 18/22 [00:00<00:00, 44.27it/s]100%|██████████| 22/22 [00:05<00:00,  4.11it/s]
2025-03-09 07:51:47,577 [INFO]: 	Computing best hyperparameters for index knn.index 03/09/2025, 07:51:47
2025-03-09 07:52:36,994 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 49.4163 secs
2025-03-09 07:52:36,994 [INFO]: The best hyperparameters are: efSearch=232
2025-03-09 07:52:36,994 [INFO]: 	Compute fast metrics 03/09/2025, 07:52:36
  0%|          | 0/4 [00:00<?, ?it/s] 50%|█████     | 2/4 [00:00<00:00, 18.81it/s] 75%|███████▌  | 3/4 [00:00<00:00, 16.29it/s]
2025-03-09 07:52:52,341 [INFO]: 	>>> Finished "Compute fast metrics" in 15.3473 secs
2025-03-09 07:52:52,342 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 70.1290 secs
2025-03-09 07:52:52,342 [INFO]: {
2025-03-09 07:52:52,342 [INFO]: 	index_key: HNSW15
2025-03-09 07:52:52,342 [INFO]: 	index_param: efSearch=232
2025-03-09 07:52:52,342 [INFO]: 	index_path: knn.index
2025-03-09 07:52:52,342 [INFO]: 	size in bytes: 1026807310
2025-03-09 07:52:52,342 [INFO]: 	avg_search_speed_ms: 11.431490171700716
2025-03-09 07:52:52,342 [INFO]: 	99p_search_speed_ms: 23.99660390336066
2025-03-09 07:52:52,342 [INFO]: 	reconstruction error %: 0.0
2025-03-09 07:52:52,342 [INFO]: 	nb vectors: 5219
2025-03-09 07:52:52,342 [INFO]: 	vectors dimension: 49152
2025-03-09 07:52:52,342 [INFO]: 	compression ratio: 0.9993083824072113
2025-03-09 07:52:52,342 [INFO]: }
2025-03-09 07:52:52,342 [INFO]: 	>>> Finished "Creating the index" in 70.1306 secs
2025-03-09 07:52:52,342 [INFO]: >>> Finished "Launching the whole pipeline" in 70.1606 secs
2025-03-09 07:52:55: [retrieval_preprocessing] calculating distances ...
2025-03-09 07:52:56: [retrieval_preprocessing] finished and saved retrieval indices for episode 38667 [episode count 2/20]
[retrieval_preprocessing] for episode 4749 [episode count 3/20], we have num_retrieval=np.int64(5375) num_query=np.int64(219)
2025-03-09 07:52:57,263 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-09 07:52:58,186 [INFO]: Launching the whole pipeline 03/09/2025, 07:52:58
2025-03-09 07:52:58,186 [INFO]: Reading total number of vectors and dimension 03/09/2025, 07:52:58
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1112.55it/s]
2025-03-09 07:52:58,218 [INFO]: There are 5375 embeddings of dim 49152
2025-03-09 07:52:58,219 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0326 secs
2025-03-09 07:52:58,219 [INFO]: 	Compute estimated construction time of the index 03/09/2025, 07:52:58
2025-03-09 07:52:58,219 [INFO]: 		-> Train: 16.7 minutes
2025-03-09 07:52:58,219 [INFO]: 		-> Add: 3.0 seconds
2025-03-09 07:52:58,220 [INFO]: 		Total: 16.7 minutes
2025-03-09 07:52:58,220 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0004 secs
2025-03-09 07:52:58,220 [INFO]: 	Checking that your have enough memory available to create the index 03/09/2025, 07:52:58
2025-03-09 07:52:58,220 [INFO]: 1.1GB of memory will be needed to build the index (more might be used if you have more)
2025-03-09 07:52:58,220 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0005 secs
2025-03-09 07:52:58,220 [INFO]: 	Selecting most promising index types given data characteristics 03/09/2025, 07:52:58
2025-03-09 07:52:58,220 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-09 07:52:58,221 [INFO]: 	Creating the index 03/09/2025, 07:52:58
2025-03-09 07:52:58,221 [INFO]: 		-> Instanciate the index HNSW15 03/09/2025, 07:52:58
2025-03-09 07:52:58,223 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0026 secs
2025-03-09 07:52:58,224 [INFO]: 		-> Adding the vectors to the index 03/09/2025, 07:52:58
2025-03-09 07:52:58,224 [INFO]: The memory available for adding the vectors is 49.0GB(total available - used by the index)
2025-03-09 07:52:58,224 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/23 [00:00<?, ?it/s]  4%|▍         | 1/23 [00:00<00:02,  8.33it/s] 26%|██▌       | 6/23 [00:00<00:00, 29.48it/s] 48%|████▊     | 11/23 [00:00<00:00, 37.52it/s] 70%|██████▉   | 16/23 [00:00<00:00, 41.90it/s] 91%|█████████▏| 21/23 [00:04<00:00,  3.35it/s]100%|██████████| 23/23 [00:04<00:00,  4.72it/s]
2025-03-09 07:53:03,101 [INFO]: 	Computing best hyperparameters for index knn.index 03/09/2025, 07:53:03
2025-03-09 07:53:55,885 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 52.7833 secs
2025-03-09 07:53:55,885 [INFO]: The best hyperparameters are: efSearch=195
2025-03-09 07:53:55,885 [INFO]: 	Compute fast metrics 03/09/2025, 07:53:55
  0%|          | 0/4 [00:00<?, ?it/s] 50%|█████     | 2/4 [00:00<00:00, 19.12it/s] 75%|███████▌  | 3/4 [00:00<00:00, 20.86it/s]
2025-03-09 07:54:12,499 [INFO]: 	>>> Finished "Compute fast metrics" in 16.6136 secs
2025-03-09 07:54:12,499 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 74.2757 secs
2025-03-09 07:54:12,500 [INFO]: {
2025-03-09 07:54:12,500 [INFO]: 	index_key: HNSW15
2025-03-09 07:54:12,500 [INFO]: 	index_param: efSearch=195
2025-03-09 07:54:12,500 [INFO]: 	index_path: knn.index
2025-03-09 07:54:12,500 [INFO]: 	size in bytes: 1057499710
2025-03-09 07:54:12,500 [INFO]: 	avg_search_speed_ms: 8.244908494822626
2025-03-09 07:54:12,500 [INFO]: 	99p_search_speed_ms: 18.983054803684343
2025-03-09 07:54:12,500 [INFO]: 	reconstruction error %: 0.0
2025-03-09 07:54:12,500 [INFO]: 	nb vectors: 5375
2025-03-09 07:54:12,500 [INFO]: 	vectors dimension: 49152
2025-03-09 07:54:12,500 [INFO]: 	compression ratio: 0.9993080754603706
2025-03-09 07:54:12,500 [INFO]: }
2025-03-09 07:54:12,500 [INFO]: 	>>> Finished "Creating the index" in 74.2792 secs
2025-03-09 07:54:12,500 [INFO]: >>> Finished "Launching the whole pipeline" in 74.3137 secs
2025-03-09 07:54:13: [retrieval_preprocessing] calculating distances ...
2025-03-09 07:54:14: [retrieval_preprocessing] finished and saved retrieval indices for episode 4749 [episode count 3/20]
[retrieval_preprocessing] for episode 6677 [episode count 4/20], we have num_retrieval=np.int64(5376) num_query=np.int64(218)
2025-03-09 07:54:14,752 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-09 07:54:15,456 [INFO]: Launching the whole pipeline 03/09/2025, 07:54:15
2025-03-09 07:54:15,456 [INFO]: Reading total number of vectors and dimension 03/09/2025, 07:54:15
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 2189.09it/s]
2025-03-09 07:54:15,482 [INFO]: There are 5376 embeddings of dim 49152
2025-03-09 07:54:15,482 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0262 secs
2025-03-09 07:54:15,482 [INFO]: 	Compute estimated construction time of the index 03/09/2025, 07:54:15
2025-03-09 07:54:15,482 [INFO]: 		-> Train: 16.7 minutes
2025-03-09 07:54:15,482 [INFO]: 		-> Add: 3.0 seconds
2025-03-09 07:54:15,482 [INFO]: 		Total: 16.7 minutes
2025-03-09 07:54:15,482 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0001 secs
2025-03-09 07:54:15,482 [INFO]: 	Checking that your have enough memory available to create the index 03/09/2025, 07:54:15
2025-03-09 07:54:15,483 [INFO]: 1.1GB of memory will be needed to build the index (more might be used if you have more)
2025-03-09 07:54:15,483 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0002 secs
2025-03-09 07:54:15,483 [INFO]: 	Selecting most promising index types given data characteristics 03/09/2025, 07:54:15
2025-03-09 07:54:15,483 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-09 07:54:15,483 [INFO]: 	Creating the index 03/09/2025, 07:54:15
2025-03-09 07:54:15,483 [INFO]: 		-> Instanciate the index HNSW15 03/09/2025, 07:54:15
2025-03-09 07:54:15,484 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0013 secs
2025-03-09 07:54:15,484 [INFO]: 		-> Adding the vectors to the index 03/09/2025, 07:54:15
2025-03-09 07:54:15,485 [INFO]: The memory available for adding the vectors is 49.0GB(total available - used by the index)
2025-03-09 07:54:15,485 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/23 [00:00<?, ?it/s]  9%|▊         | 2/23 [00:00<00:01, 13.66it/s] 30%|███       | 7/23 [00:00<00:00, 30.05it/s] 52%|█████▏    | 12/23 [00:00<00:00, 37.83it/s] 74%|███████▍  | 17/23 [00:00<00:00, 39.04it/s] 96%|█████████▌| 22/23 [00:04<00:00,  2.91it/s]100%|██████████| 23/23 [00:05<00:00,  4.02it/s]
2025-03-09 07:54:21,216 [INFO]: 	Computing best hyperparameters for index knn.index 03/09/2025, 07:54:21
2025-03-09 07:55:09,919 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 48.7031 secs
2025-03-09 07:55:09,919 [INFO]: The best hyperparameters are: efSearch=240
2025-03-09 07:55:09,919 [INFO]: 	Compute fast metrics 03/09/2025, 07:55:09
  0%|          | 0/4 [00:00<?, ?it/s] 50%|█████     | 2/4 [00:00<00:00, 18.55it/s] 75%|███████▌  | 3/4 [00:00<00:00, 20.01it/s]
2025-03-09 07:55:25,846 [INFO]: 	>>> Finished "Compute fast metrics" in 15.9263 secs
2025-03-09 07:55:25,846 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 70.3619 secs
2025-03-09 07:55:25,847 [INFO]: {
2025-03-09 07:55:25,847 [INFO]: 	index_key: HNSW15
2025-03-09 07:55:25,847 [INFO]: 	index_param: efSearch=240
2025-03-09 07:55:25,847 [INFO]: 	index_path: knn.index
2025-03-09 07:55:25,847 [INFO]: 	size in bytes: 1057696450
2025-03-09 07:55:25,847 [INFO]: 	avg_search_speed_ms: 9.992870521712137
2025-03-09 07:55:25,847 [INFO]: 	99p_search_speed_ms: 22.922102129086852
2025-03-09 07:55:25,847 [INFO]: 	reconstruction error %: 0.0
2025-03-09 07:55:25,847 [INFO]: 	nb vectors: 5376
2025-03-09 07:55:25,847 [INFO]: 	vectors dimension: 49152
2025-03-09 07:55:25,847 [INFO]: 	compression ratio: 0.9993080793643583
2025-03-09 07:55:25,847 [INFO]: }
2025-03-09 07:55:25,847 [INFO]: 	>>> Finished "Creating the index" in 70.3637 secs
2025-03-09 07:55:25,847 [INFO]: >>> Finished "Launching the whole pipeline" in 70.3907 secs
2025-03-09 07:55:27: [retrieval_preprocessing] calculating distances ...
2025-03-09 07:55:28: [retrieval_preprocessing] finished and saved retrieval indices for episode 6677 [episode count 4/20]
[retrieval_preprocessing] for episode 9109 [episode count 5/20], we have num_retrieval=np.int64(5025) num_query=np.int64(569)
2025-03-09 07:55:29,126 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-09 07:55:29,839 [INFO]: Launching the whole pipeline 03/09/2025, 07:55:29
2025-03-09 07:55:29,839 [INFO]: Reading total number of vectors and dimension 03/09/2025, 07:55:29
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1784.81it/s]
2025-03-09 07:55:29,864 [INFO]: There are 5025 embeddings of dim 49152
2025-03-09 07:55:29,865 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0256 secs
2025-03-09 07:55:29,865 [INFO]: 	Compute estimated construction time of the index 03/09/2025, 07:55:29
2025-03-09 07:55:29,865 [INFO]: 		-> Train: 16.7 minutes
2025-03-09 07:55:29,865 [INFO]: 		-> Add: 2.8 seconds
2025-03-09 07:55:29,865 [INFO]: 		Total: 16.7 minutes
2025-03-09 07:55:29,865 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0001 secs
2025-03-09 07:55:29,865 [INFO]: 	Checking that your have enough memory available to create the index 03/09/2025, 07:55:29
2025-03-09 07:55:29,865 [INFO]: 1.0GB of memory will be needed to build the index (more might be used if you have more)
2025-03-09 07:55:29,865 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0001 secs
2025-03-09 07:55:29,865 [INFO]: 	Selecting most promising index types given data characteristics 03/09/2025, 07:55:29
2025-03-09 07:55:29,865 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-09 07:55:29,865 [INFO]: 	Creating the index 03/09/2025, 07:55:29
2025-03-09 07:55:29,865 [INFO]: 		-> Instanciate the index HNSW15 03/09/2025, 07:55:29
2025-03-09 07:55:29,866 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0009 secs
2025-03-09 07:55:29,866 [INFO]: 		-> Adding the vectors to the index 03/09/2025, 07:55:29
2025-03-09 07:55:29,866 [INFO]: The memory available for adding the vectors is 49.1GB(total available - used by the index)
2025-03-09 07:55:29,866 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/20 [00:00<?, ?it/s]  5%|▌         | 1/20 [00:00<00:02,  8.40it/s] 35%|███▌      | 7/20 [00:00<00:00, 34.07it/s] 65%|██████▌   | 13/20 [00:00<00:00, 42.68it/s] 95%|█████████▌| 19/20 [00:00<00:00, 46.57it/s]100%|██████████| 20/20 [00:05<00:00,  3.78it/s]
2025-03-09 07:55:35,155 [INFO]: 	Computing best hyperparameters for index knn.index 03/09/2025, 07:55:35
2025-03-09 07:56:19,065 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 43.9093 secs
2025-03-09 07:56:19,065 [INFO]: The best hyperparameters are: efSearch=256
2025-03-09 07:56:19,065 [INFO]: 	Compute fast metrics 03/09/2025, 07:56:19
  0%|          | 0/4 [00:00<?, ?it/s] 50%|█████     | 2/4 [00:00<00:00, 18.42it/s] 75%|███████▌  | 3/4 [00:00<00:00, 19.81it/s]
2025-03-09 07:56:33,794 [INFO]: 	>>> Finished "Compute fast metrics" in 14.7293 secs
2025-03-09 07:56:33,797 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 63.9307 secs
2025-03-09 07:56:33,797 [INFO]: {
2025-03-09 07:56:33,797 [INFO]: 	index_key: HNSW15
2025-03-09 07:56:33,797 [INFO]: 	index_param: efSearch=256
2025-03-09 07:56:33,797 [INFO]: 	index_path: knn.index
2025-03-09 07:56:33,797 [INFO]: 	size in bytes: 988638850
2025-03-09 07:56:33,797 [INFO]: 	avg_search_speed_ms: 10.088836331828286
2025-03-09 07:56:33,797 [INFO]: 	99p_search_speed_ms: 20.41221344843507
2025-03-09 07:56:33,797 [INFO]: 	reconstruction error %: 0.0
2025-03-09 07:56:33,797 [INFO]: 	nb vectors: 5025
2025-03-09 07:56:33,797 [INFO]: 	vectors dimension: 49152
2025-03-09 07:56:33,797 [INFO]: 	compression ratio: 0.9993084936931216
2025-03-09 07:56:33,797 [INFO]: }
2025-03-09 07:56:33,797 [INFO]: 	>>> Finished "Creating the index" in 63.9321 secs
2025-03-09 07:56:33,797 [INFO]: >>> Finished "Launching the whole pipeline" in 63.9583 secs
2025-03-09 07:56:38: [retrieval_preprocessing] calculating distances ...
2025-03-09 07:56:40: [retrieval_preprocessing] finished and saved retrieval indices for episode 9109 [episode count 5/20]
[retrieval_preprocessing] for episode 76954 [episode count 6/20], we have num_retrieval=np.int64(5394) num_query=np.int64(200)
2025-03-09 07:56:41,112 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-09 07:56:42,020 [INFO]: Launching the whole pipeline 03/09/2025, 07:56:42
2025-03-09 07:56:42,020 [INFO]: Reading total number of vectors and dimension 03/09/2025, 07:56:42
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1439.36it/s]
2025-03-09 07:56:42,047 [INFO]: There are 5394 embeddings of dim 49152
2025-03-09 07:56:42,048 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0278 secs
2025-03-09 07:56:42,048 [INFO]: 	Compute estimated construction time of the index 03/09/2025, 07:56:42
2025-03-09 07:56:42,048 [INFO]: 		-> Train: 16.7 minutes
2025-03-09 07:56:42,048 [INFO]: 		-> Add: 3.0 seconds
2025-03-09 07:56:42,048 [INFO]: 		Total: 16.7 minutes
2025-03-09 07:56:42,048 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0001 secs
2025-03-09 07:56:42,048 [INFO]: 	Checking that your have enough memory available to create the index 03/09/2025, 07:56:42
2025-03-09 07:56:42,048 [INFO]: 1.1GB of memory will be needed to build the index (more might be used if you have more)
2025-03-09 07:56:42,048 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0002 secs
2025-03-09 07:56:42,048 [INFO]: 	Selecting most promising index types given data characteristics 03/09/2025, 07:56:42
2025-03-09 07:56:42,048 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-09 07:56:42,048 [INFO]: 	Creating the index 03/09/2025, 07:56:42
2025-03-09 07:56:42,048 [INFO]: 		-> Instanciate the index HNSW15 03/09/2025, 07:56:42
2025-03-09 07:56:42,049 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0011 secs
2025-03-09 07:56:42,049 [INFO]: 		-> Adding the vectors to the index 03/09/2025, 07:56:42
2025-03-09 07:56:42,049 [INFO]: The memory available for adding the vectors is 49.0GB(total available - used by the index)
2025-03-09 07:56:42,049 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/23 [00:00<?, ?it/s]  4%|▍         | 1/23 [00:00<00:02,  9.23it/s] 30%|███       | 7/23 [00:00<00:00, 34.60it/s] 57%|█████▋    | 13/23 [00:00<00:00, 42.92it/s] 83%|████████▎ | 19/23 [00:00<00:00, 46.27it/s]100%|██████████| 23/23 [00:04<00:00,  4.61it/s]
2025-03-09 07:56:47,042 [INFO]: 	Computing best hyperparameters for index knn.index 03/09/2025, 07:56:47
2025-03-09 07:57:32,919 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 45.8774 secs
2025-03-09 07:57:32,920 [INFO]: The best hyperparameters are: efSearch=232
2025-03-09 07:57:32,920 [INFO]: 	Compute fast metrics 03/09/2025, 07:57:32
  0%|          | 0/4 [00:00<?, ?it/s] 25%|██▌       | 1/4 [00:00<00:00,  8.64it/s] 75%|███████▌  | 3/4 [00:00<00:00, 13.73it/s] 75%|███████▌  | 3/4 [00:00<00:00, 11.22it/s]
2025-03-09 07:57:48,057 [INFO]: 	>>> Finished "Compute fast metrics" in 15.1377 secs
2025-03-09 07:57:48,058 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 66.0086 secs
2025-03-09 07:57:48,058 [INFO]: {
2025-03-09 07:57:48,058 [INFO]: 	index_key: HNSW15
2025-03-09 07:57:48,058 [INFO]: 	index_param: efSearch=232
2025-03-09 07:57:48,058 [INFO]: 	index_path: knn.index
2025-03-09 07:57:48,058 [INFO]: 	size in bytes: 1061237950
2025-03-09 07:57:48,058 [INFO]: 	avg_search_speed_ms: 9.270391391807747
2025-03-09 07:57:48,058 [INFO]: 	99p_search_speed_ms: 16.38916531112045
2025-03-09 07:57:48,058 [INFO]: 	reconstruction error %: 0.0
2025-03-09 07:57:48,058 [INFO]: 	nb vectors: 5394
2025-03-09 07:57:48,058 [INFO]: 	vectors dimension: 49152
2025-03-09 07:57:48,058 [INFO]: 	compression ratio: 0.9993079798927281
2025-03-09 07:57:48,058 [INFO]: }
2025-03-09 07:57:48,058 [INFO]: 	>>> Finished "Creating the index" in 66.0102 secs
2025-03-09 07:57:48,058 [INFO]: >>> Finished "Launching the whole pipeline" in 66.0387 secs
2025-03-09 07:57:49: [retrieval_preprocessing] calculating distances ...
2025-03-09 07:57:50: [retrieval_preprocessing] finished and saved retrieval indices for episode 76954 [episode count 6/20]
[retrieval_preprocessing] for episode 77731 [episode count 7/20], we have num_retrieval=np.int64(5455) num_query=np.int64(139)
2025-03-09 07:57:50,768 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-09 07:57:51,622 [INFO]: Launching the whole pipeline 03/09/2025, 07:57:51
2025-03-09 07:57:51,622 [INFO]: Reading total number of vectors and dimension 03/09/2025, 07:57:51
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 2024.28it/s]
2025-03-09 07:57:51,647 [INFO]: There are 5455 embeddings of dim 49152
2025-03-09 07:57:51,648 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0252 secs
2025-03-09 07:57:51,648 [INFO]: 	Compute estimated construction time of the index 03/09/2025, 07:57:51
2025-03-09 07:57:51,648 [INFO]: 		-> Train: 16.7 minutes
2025-03-09 07:57:51,648 [INFO]: 		-> Add: 3.0 seconds
2025-03-09 07:57:51,648 [INFO]: 		Total: 16.7 minutes
2025-03-09 07:57:51,648 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0001 secs
2025-03-09 07:57:51,648 [INFO]: 	Checking that your have enough memory available to create the index 03/09/2025, 07:57:51
2025-03-09 07:57:51,648 [INFO]: 1.1GB of memory will be needed to build the index (more might be used if you have more)
2025-03-09 07:57:51,648 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0002 secs
2025-03-09 07:57:51,648 [INFO]: 	Selecting most promising index types given data characteristics 03/09/2025, 07:57:51
2025-03-09 07:57:51,648 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-09 07:57:51,648 [INFO]: 	Creating the index 03/09/2025, 07:57:51
2025-03-09 07:57:51,648 [INFO]: 		-> Instanciate the index HNSW15 03/09/2025, 07:57:51
2025-03-09 07:57:51,649 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0011 secs
2025-03-09 07:57:51,649 [INFO]: 		-> Adding the vectors to the index 03/09/2025, 07:57:51
2025-03-09 07:57:51,650 [INFO]: The memory available for adding the vectors is 49.0GB(total available - used by the index)
2025-03-09 07:57:51,650 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/23 [00:00<?, ?it/s]  4%|▍         | 1/23 [00:00<00:03,  5.79it/s] 26%|██▌       | 6/23 [00:00<00:00, 24.29it/s] 43%|████▎     | 10/23 [00:00<00:00, 28.40it/s] 70%|██████▉   | 16/23 [00:00<00:00, 37.46it/s] 91%|█████████▏| 21/23 [00:04<00:00,  3.39it/s]100%|██████████| 23/23 [00:04<00:00,  4.60it/s]
2025-03-09 07:57:56,652 [INFO]: 	Computing best hyperparameters for index knn.index 03/09/2025, 07:57:56
2025-03-09 07:58:48,341 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 51.6888 secs
2025-03-09 07:58:48,341 [INFO]: The best hyperparameters are: efSearch=235
2025-03-09 07:58:48,341 [INFO]: 	Compute fast metrics 03/09/2025, 07:58:48
  0%|          | 0/4 [00:00<?, ?it/s] 50%|█████     | 2/4 [00:00<00:00, 18.40it/s] 75%|███████▌  | 3/4 [00:00<00:00, 19.76it/s]
2025-03-09 07:59:02,847 [INFO]: 	>>> Finished "Compute fast metrics" in 14.5059 secs
2025-03-09 07:59:02,848 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 71.1987 secs
2025-03-09 07:59:02,848 [INFO]: {
2025-03-09 07:59:02,848 [INFO]: 	index_key: HNSW15
2025-03-09 07:59:02,848 [INFO]: 	index_param: efSearch=235
2025-03-09 07:59:02,848 [INFO]: 	index_path: knn.index
2025-03-09 07:59:02,848 [INFO]: 	size in bytes: 1073239330
2025-03-09 07:59:02,848 [INFO]: 	avg_search_speed_ms: 9.572500446098344
2025-03-09 07:59:02,848 [INFO]: 	99p_search_speed_ms: 21.38274723663925
2025-03-09 07:59:02,848 [INFO]: 	reconstruction error %: 0.0
2025-03-09 07:59:02,848 [INFO]: 	nb vectors: 5455
2025-03-09 07:59:02,848 [INFO]: 	vectors dimension: 49152
2025-03-09 07:59:02,848 [INFO]: 	compression ratio: 0.9993079921884711
2025-03-09 07:59:02,848 [INFO]: }
2025-03-09 07:59:02,849 [INFO]: 	>>> Finished "Creating the index" in 71.2003 secs
2025-03-09 07:59:02,849 [INFO]: >>> Finished "Launching the whole pipeline" in 71.2262 secs
2025-03-09 07:59:03: [retrieval_preprocessing] calculating distances ...
2025-03-09 07:59:04: [retrieval_preprocessing] finished and saved retrieval indices for episode 77731 [episode count 7/20]
[retrieval_preprocessing] for episode 58277 [episode count 8/20], we have num_retrieval=np.int64(5406) num_query=np.int64(188)
2025-03-09 07:59:04,668 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-09 07:59:05,415 [INFO]: Launching the whole pipeline 03/09/2025, 07:59:05
2025-03-09 07:59:05,415 [INFO]: Reading total number of vectors and dimension 03/09/2025, 07:59:05
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1449.81it/s]
2025-03-09 07:59:05,441 [INFO]: There are 5406 embeddings of dim 49152
2025-03-09 07:59:05,441 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0254 secs
2025-03-09 07:59:05,441 [INFO]: 	Compute estimated construction time of the index 03/09/2025, 07:59:05
2025-03-09 07:59:05,441 [INFO]: 		-> Train: 16.7 minutes
2025-03-09 07:59:05,441 [INFO]: 		-> Add: 3.0 seconds
2025-03-09 07:59:05,441 [INFO]: 		Total: 16.7 minutes
2025-03-09 07:59:05,441 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0001 secs
2025-03-09 07:59:05,441 [INFO]: 	Checking that your have enough memory available to create the index 03/09/2025, 07:59:05
2025-03-09 07:59:05,441 [INFO]: 1.1GB of memory will be needed to build the index (more might be used if you have more)
2025-03-09 07:59:05,441 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0001 secs
2025-03-09 07:59:05,441 [INFO]: 	Selecting most promising index types given data characteristics 03/09/2025, 07:59:05
2025-03-09 07:59:05,441 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-09 07:59:05,441 [INFO]: 	Creating the index 03/09/2025, 07:59:05
2025-03-09 07:59:05,441 [INFO]: 		-> Instanciate the index HNSW15 03/09/2025, 07:59:05
2025-03-09 07:59:05,442 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0009 secs
2025-03-09 07:59:05,442 [INFO]: 		-> Adding the vectors to the index 03/09/2025, 07:59:05
2025-03-09 07:59:05,442 [INFO]: The memory available for adding the vectors is 49.0GB(total available - used by the index)
2025-03-09 07:59:05,442 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/23 [00:00<?, ?it/s]  4%|▍         | 1/23 [00:00<00:02,  9.57it/s] 30%|███       | 7/23 [00:00<00:00, 36.76it/s] 57%|█████▋    | 13/23 [00:00<00:00, 45.55it/s] 83%|████████▎ | 19/23 [00:00<00:00, 49.67it/s]100%|██████████| 23/23 [00:04<00:00,  4.77it/s]
2025-03-09 07:59:10,265 [INFO]: 	Computing best hyperparameters for index knn.index 03/09/2025, 07:59:10
2025-03-09 07:59:57,232 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 46.9667 secs
2025-03-09 07:59:57,232 [INFO]: The best hyperparameters are: efSearch=192
2025-03-09 07:59:57,232 [INFO]: 	Compute fast metrics 03/09/2025, 07:59:57
  0%|          | 0/4 [00:00<?, ?it/s] 50%|█████     | 2/4 [00:00<00:00, 17.36it/s] 75%|███████▌  | 3/4 [00:00<00:00, 18.31it/s]
2025-03-09 08:00:13,276 [INFO]: 	>>> Finished "Compute fast metrics" in 16.0437 secs
2025-03-09 08:00:13,276 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 67.8340 secs
2025-03-09 08:00:13,277 [INFO]: {
2025-03-09 08:00:13,277 [INFO]: 	index_key: HNSW15
2025-03-09 08:00:13,277 [INFO]: 	index_param: efSearch=192
2025-03-09 08:00:13,277 [INFO]: 	index_path: knn.index
2025-03-09 08:00:13,277 [INFO]: 	size in bytes: 1063598830
2025-03-09 08:00:13,277 [INFO]: 	avg_search_speed_ms: 8.922871318126528
2025-03-09 08:00:13,277 [INFO]: 	99p_search_speed_ms: 18.49540499970316
2025-03-09 08:00:13,277 [INFO]: 	reconstruction error %: 0.0
2025-03-09 08:00:13,277 [INFO]: 	nb vectors: 5406
2025-03-09 08:00:13,277 [INFO]: 	vectors dimension: 49152
2025-03-09 08:00:13,277 [INFO]: 	compression ratio: 0.9993080266927334
2025-03-09 08:00:13,277 [INFO]: }
2025-03-09 08:00:13,277 [INFO]: 	>>> Finished "Creating the index" in 67.8353 secs
2025-03-09 08:00:13,277 [INFO]: >>> Finished "Launching the whole pipeline" in 67.8613 secs
2025-03-09 08:00:14: [retrieval_preprocessing] calculating distances ...
2025-03-09 08:00:14: [retrieval_preprocessing] finished and saved retrieval indices for episode 58277 [episode count 8/20]
[retrieval_preprocessing] for episode 27815 [episode count 9/20], we have num_retrieval=np.int64(5483) num_query=np.int64(111)
2025-03-09 08:00:15,146 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-09 08:00:15,857 [INFO]: Launching the whole pipeline 03/09/2025, 08:00:15
2025-03-09 08:00:15,858 [INFO]: Reading total number of vectors and dimension 03/09/2025, 08:00:15
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1409.85it/s]
2025-03-09 08:00:15,883 [INFO]: There are 5483 embeddings of dim 49152
2025-03-09 08:00:15,883 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0255 secs
2025-03-09 08:00:15,883 [INFO]: 	Compute estimated construction time of the index 03/09/2025, 08:00:15
2025-03-09 08:00:15,883 [INFO]: 		-> Train: 16.7 minutes
2025-03-09 08:00:15,883 [INFO]: 		-> Add: 3.0 seconds
2025-03-09 08:00:15,883 [INFO]: 		Total: 16.7 minutes
2025-03-09 08:00:15,883 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0001 secs
2025-03-09 08:00:15,883 [INFO]: 	Checking that your have enough memory available to create the index 03/09/2025, 08:00:15
2025-03-09 08:00:15,883 [INFO]: 1.1GB of memory will be needed to build the index (more might be used if you have more)
2025-03-09 08:00:15,884 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0001 secs
2025-03-09 08:00:15,884 [INFO]: 	Selecting most promising index types given data characteristics 03/09/2025, 08:00:15
2025-03-09 08:00:15,884 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-09 08:00:15,884 [INFO]: 	Creating the index 03/09/2025, 08:00:15
2025-03-09 08:00:15,884 [INFO]: 		-> Instanciate the index HNSW15 03/09/2025, 08:00:15
2025-03-09 08:00:15,885 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0011 secs
2025-03-09 08:00:15,885 [INFO]: 		-> Adding the vectors to the index 03/09/2025, 08:00:15
2025-03-09 08:00:15,885 [INFO]: The memory available for adding the vectors is 49.0GB(total available - used by the index)
2025-03-09 08:00:15,885 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/23 [00:00<?, ?it/s]  4%|▍         | 1/23 [00:00<00:02,  8.63it/s] 26%|██▌       | 6/23 [00:00<00:00, 30.03it/s] 48%|████▊     | 11/23 [00:00<00:00, 38.45it/s] 70%|██████▉   | 16/23 [00:00<00:00, 42.78it/s] 91%|█████████▏| 21/23 [00:04<00:00,  3.19it/s]100%|██████████| 23/23 [00:05<00:00,  4.31it/s]
2025-03-09 08:00:21,220 [INFO]: 	Computing best hyperparameters for index knn.index 03/09/2025, 08:00:21
2025-03-09 08:01:13,209 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 51.9881 secs
2025-03-09 08:01:13,209 [INFO]: The best hyperparameters are: efSearch=193
2025-03-09 08:01:13,209 [INFO]: 	Compute fast metrics 03/09/2025, 08:01:13
  0%|          | 0/4 [00:00<?, ?it/s] 75%|███████▌  | 3/4 [00:00<00:00, 27.71it/s] 75%|███████▌  | 3/4 [00:00<00:00, 23.77it/s]
2025-03-09 08:01:37,510 [INFO]: 	>>> Finished "Compute fast metrics" in 24.3006 secs
2025-03-09 08:01:37,510 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 81.6254 secs
2025-03-09 08:01:37,511 [INFO]: {
2025-03-09 08:01:37,511 [INFO]: 	index_key: HNSW15
2025-03-09 08:01:37,511 [INFO]: 	index_param: efSearch=193
2025-03-09 08:01:37,511 [INFO]: 	index_path: knn.index
2025-03-09 08:01:37,511 [INFO]: 	size in bytes: 1078748170
2025-03-09 08:01:37,511 [INFO]: 	avg_search_speed_ms: 8.43543957304021
2025-03-09 08:01:37,511 [INFO]: 	99p_search_speed_ms: 21.087671082932534
2025-03-09 08:01:37,511 [INFO]: 	reconstruction error %: 0.0
2025-03-09 08:01:37,511 [INFO]: 	nb vectors: 5483
2025-03-09 08:01:37,511 [INFO]: 	vectors dimension: 49152
2025-03-09 08:01:37,511 [INFO]: 	compression ratio: 0.9993079886290792
2025-03-09 08:01:37,511 [INFO]: }
2025-03-09 08:01:37,511 [INFO]: 	>>> Finished "Creating the index" in 81.6271 secs
2025-03-09 08:01:37,511 [INFO]: >>> Finished "Launching the whole pipeline" in 81.6532 secs
2025-03-09 08:01:38: [retrieval_preprocessing] calculating distances ...
2025-03-09 08:01:38: [retrieval_preprocessing] finished and saved retrieval indices for episode 27815 [episode count 9/20]
[retrieval_preprocessing] for episode 1583 [episode count 10/20], we have num_retrieval=np.int64(5389) num_query=np.int64(205)
2025-03-09 08:01:39,029 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-09 08:01:39,777 [INFO]: Launching the whole pipeline 03/09/2025, 08:01:39
2025-03-09 08:01:39,777 [INFO]: Reading total number of vectors and dimension 03/09/2025, 08:01:39
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1787.85it/s]
2025-03-09 08:01:39,802 [INFO]: There are 5389 embeddings of dim 49152
2025-03-09 08:01:39,802 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0253 secs
2025-03-09 08:01:39,802 [INFO]: 	Compute estimated construction time of the index 03/09/2025, 08:01:39
2025-03-09 08:01:39,803 [INFO]: 		-> Train: 16.7 minutes
2025-03-09 08:01:39,803 [INFO]: 		-> Add: 3.0 seconds
2025-03-09 08:01:39,803 [INFO]: 		Total: 16.7 minutes
2025-03-09 08:01:39,803 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0001 secs
2025-03-09 08:01:39,803 [INFO]: 	Checking that your have enough memory available to create the index 03/09/2025, 08:01:39
2025-03-09 08:01:39,803 [INFO]: 1.1GB of memory will be needed to build the index (more might be used if you have more)
2025-03-09 08:01:39,803 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0003 secs
2025-03-09 08:01:39,803 [INFO]: 	Selecting most promising index types given data characteristics 03/09/2025, 08:01:39
2025-03-09 08:01:39,803 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-09 08:01:39,803 [INFO]: 	Creating the index 03/09/2025, 08:01:39
2025-03-09 08:01:39,803 [INFO]: 		-> Instanciate the index HNSW15 03/09/2025, 08:01:39
2025-03-09 08:01:39,804 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0009 secs
2025-03-09 08:01:39,804 [INFO]: 		-> Adding the vectors to the index 03/09/2025, 08:01:39
2025-03-09 08:01:39,804 [INFO]: The memory available for adding the vectors is 49.0GB(total available - used by the index)
2025-03-09 08:01:39,804 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/23 [00:00<?, ?it/s]  4%|▍         | 1/23 [00:00<00:03,  6.84it/s] 30%|███       | 7/23 [00:00<00:00, 30.59it/s] 57%|█████▋    | 13/23 [00:00<00:00, 39.57it/s] 83%|████████▎ | 19/23 [00:00<00:00, 44.09it/s]100%|██████████| 23/23 [00:05<00:00,  4.40it/s]
2025-03-09 08:01:45,030 [INFO]: 	Computing best hyperparameters for index knn.index 03/09/2025, 08:01:45
2025-03-09 08:02:38,136 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 53.1068 secs
2025-03-09 08:02:38,137 [INFO]: The best hyperparameters are: efSearch=230
2025-03-09 08:02:38,137 [INFO]: 	Compute fast metrics 03/09/2025, 08:02:38
  0%|          | 0/4 [00:00<?, ?it/s] 50%|█████     | 2/4 [00:00<00:00, 18.16it/s] 75%|███████▌  | 3/4 [00:00<00:00, 19.76it/s]
2025-03-09 08:02:55,823 [INFO]: 	>>> Finished "Compute fast metrics" in 17.6860 secs
2025-03-09 08:02:55,823 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 76.0190 secs
2025-03-09 08:02:55,823 [INFO]: {
2025-03-09 08:02:55,823 [INFO]: 	index_key: HNSW15
2025-03-09 08:02:55,823 [INFO]: 	index_param: efSearch=230
2025-03-09 08:02:55,823 [INFO]: 	index_path: knn.index
2025-03-09 08:02:55,823 [INFO]: 	size in bytes: 1060254190
2025-03-09 08:02:55,823 [INFO]: 	avg_search_speed_ms: 9.215897250886199
2025-03-09 08:02:55,823 [INFO]: 	99p_search_speed_ms: 21.607039272785194
2025-03-09 08:02:55,823 [INFO]: 	reconstruction error %: 0.0
2025-03-09 08:02:55,823 [INFO]: 	nb vectors: 5389
2025-03-09 08:02:55,823 [INFO]: 	vectors dimension: 49152
2025-03-09 08:02:55,823 [INFO]: 	compression ratio: 0.9993080168822535
2025-03-09 08:02:55,823 [INFO]: }
2025-03-09 08:02:55,824 [INFO]: 	>>> Finished "Creating the index" in 76.0204 secs
2025-03-09 08:02:55,824 [INFO]: >>> Finished "Launching the whole pipeline" in 76.0464 secs
2025-03-09 08:02:57: [retrieval_preprocessing] calculating distances ...
2025-03-09 08:02:57: [retrieval_preprocessing] finished and saved retrieval indices for episode 1583 [episode count 10/20]
[retrieval_preprocessing] for episode 6447 [episode count 11/20], we have num_retrieval=np.int64(5321) num_query=np.int64(273)
2025-03-09 08:02:58,288 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-09 08:02:58,928 [INFO]: Launching the whole pipeline 03/09/2025, 08:02:58
2025-03-09 08:02:58,928 [INFO]: Reading total number of vectors and dimension 03/09/2025, 08:02:58
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1535.81it/s]
2025-03-09 08:02:58,957 [INFO]: There are 5321 embeddings of dim 49152
2025-03-09 08:02:58,958 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0300 secs
2025-03-09 08:02:58,958 [INFO]: 	Compute estimated construction time of the index 03/09/2025, 08:02:58
2025-03-09 08:02:58,959 [INFO]: 		-> Train: 16.7 minutes
2025-03-09 08:02:58,959 [INFO]: 		-> Add: 2.9 seconds
2025-03-09 08:02:58,960 [INFO]: 		Total: 16.7 minutes
2025-03-09 08:02:58,960 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0010 secs
2025-03-09 08:02:58,960 [INFO]: 	Checking that your have enough memory available to create the index 03/09/2025, 08:02:58
2025-03-09 08:02:58,961 [INFO]: 1.1GB of memory will be needed to build the index (more might be used if you have more)
2025-03-09 08:02:58,961 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0007 secs
2025-03-09 08:02:58,961 [INFO]: 	Selecting most promising index types given data characteristics 03/09/2025, 08:02:58
2025-03-09 08:02:58,962 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-09 08:02:58,962 [INFO]: 	Creating the index 03/09/2025, 08:02:58
2025-03-09 08:02:58,962 [INFO]: 		-> Instanciate the index HNSW15 03/09/2025, 08:02:58
2025-03-09 08:02:58,967 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0044 secs
2025-03-09 08:02:58,967 [INFO]: 		-> Adding the vectors to the index 03/09/2025, 08:02:58
2025-03-09 08:02:58,968 [INFO]: The memory available for adding the vectors is 49.0GB(total available - used by the index)
2025-03-09 08:02:58,968 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/22 [00:00<?, ?it/s]  9%|▉         | 2/22 [00:00<00:01, 19.20it/s] 36%|███▋      | 8/22 [00:00<00:00, 40.76it/s] 64%|██████▎   | 14/22 [00:00<00:00, 47.36it/s] 91%|█████████ | 20/22 [00:00<00:00, 49.81it/s]100%|██████████| 22/22 [00:05<00:00,  4.22it/s]
2025-03-09 08:03:04,187 [INFO]: 	Computing best hyperparameters for index knn.index 03/09/2025, 08:03:04
2025-03-09 08:03:57,201 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 53.0134 secs
2025-03-09 08:03:57,201 [INFO]: The best hyperparameters are: efSearch=213
2025-03-09 08:03:57,201 [INFO]: 	Compute fast metrics 03/09/2025, 08:03:57
  0%|          | 0/4 [00:00<?, ?it/s] 75%|███████▌  | 3/4 [00:00<00:00, 27.19it/s] 75%|███████▌  | 3/4 [00:00<00:00, 23.22it/s]
2025-03-09 08:04:13,822 [INFO]: 	>>> Finished "Compute fast metrics" in 16.6204 secs
2025-03-09 08:04:13,822 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 74.8548 secs
2025-03-09 08:04:13,822 [INFO]: {
2025-03-09 08:04:13,822 [INFO]: 	index_key: HNSW15
2025-03-09 08:04:13,822 [INFO]: 	index_param: efSearch=213
2025-03-09 08:04:13,822 [INFO]: 	index_path: knn.index
2025-03-09 08:04:13,822 [INFO]: 	size in bytes: 1046875390
2025-03-09 08:04:13,822 [INFO]: 	avg_search_speed_ms: 9.982622812033636
2025-03-09 08:04:13,822 [INFO]: 	99p_search_speed_ms: 20.458750021643937
2025-03-09 08:04:13,822 [INFO]: 	reconstruction error %: 0.0
2025-03-09 08:04:13,822 [INFO]: 	nb vectors: 5321
2025-03-09 08:04:13,822 [INFO]: 	vectors dimension: 49152
2025-03-09 08:04:13,822 [INFO]: 	compression ratio: 0.9993082061084653
2025-03-09 08:04:13,822 [INFO]: }
2025-03-09 08:04:13,822 [INFO]: 	>>> Finished "Creating the index" in 74.8605 secs
2025-03-09 08:04:13,822 [INFO]: >>> Finished "Launching the whole pipeline" in 74.8943 secs
2025-03-09 08:04:15: [retrieval_preprocessing] calculating distances ...
2025-03-09 08:04:16: [retrieval_preprocessing] finished and saved retrieval indices for episode 6447 [episode count 11/20]
[retrieval_preprocessing] for episode 75567 [episode count 12/20], we have num_retrieval=np.int64(5257) num_query=np.int64(337)
2025-03-09 08:04:17,564 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-09 08:04:18,358 [INFO]: Launching the whole pipeline 03/09/2025, 08:04:18
2025-03-09 08:04:18,358 [INFO]: Reading total number of vectors and dimension 03/09/2025, 08:04:18
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1783.29it/s]
2025-03-09 08:04:18,383 [INFO]: There are 5257 embeddings of dim 49152
2025-03-09 08:04:18,383 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0244 secs
2025-03-09 08:04:18,383 [INFO]: 	Compute estimated construction time of the index 03/09/2025, 08:04:18
2025-03-09 08:04:18,383 [INFO]: 		-> Train: 16.7 minutes
2025-03-09 08:04:18,383 [INFO]: 		-> Add: 2.9 seconds
2025-03-09 08:04:18,383 [INFO]: 		Total: 16.7 minutes
2025-03-09 08:04:18,383 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0001 secs
2025-03-09 08:04:18,383 [INFO]: 	Checking that your have enough memory available to create the index 03/09/2025, 08:04:18
2025-03-09 08:04:18,383 [INFO]: 1.1GB of memory will be needed to build the index (more might be used if you have more)
2025-03-09 08:04:18,383 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0002 secs
2025-03-09 08:04:18,383 [INFO]: 	Selecting most promising index types given data characteristics 03/09/2025, 08:04:18
2025-03-09 08:04:18,383 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-09 08:04:18,383 [INFO]: 	Creating the index 03/09/2025, 08:04:18
2025-03-09 08:04:18,384 [INFO]: 		-> Instanciate the index HNSW15 03/09/2025, 08:04:18
2025-03-09 08:04:18,384 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0008 secs
2025-03-09 08:04:18,384 [INFO]: 		-> Adding the vectors to the index 03/09/2025, 08:04:18
2025-03-09 08:04:18,384 [INFO]: The memory available for adding the vectors is 49.0GB(total available - used by the index)
2025-03-09 08:04:18,384 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/22 [00:00<?, ?it/s]  5%|▍         | 1/22 [00:00<00:03,  5.75it/s] 23%|██▎       | 5/22 [00:00<00:00, 20.96it/s] 41%|████      | 9/22 [00:00<00:00, 28.26it/s] 59%|█████▉    | 13/22 [00:00<00:00, 30.77it/s] 77%|███████▋  | 17/22 [00:00<00:00, 33.52it/s] 95%|█████████▌| 21/22 [00:04<00:00,  2.65it/s]100%|██████████| 22/22 [00:05<00:00,  4.19it/s]
2025-03-09 08:04:23,635 [INFO]: 	Computing best hyperparameters for index knn.index 03/09/2025, 08:04:23
2025-03-09 08:05:10,671 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 47.0354 secs
2025-03-09 08:05:10,671 [INFO]: The best hyperparameters are: efSearch=219
2025-03-09 08:05:10,671 [INFO]: 	Compute fast metrics 03/09/2025, 08:05:10
  0%|          | 0/4 [00:00<?, ?it/s] 50%|█████     | 2/4 [00:00<00:00, 18.05it/s] 75%|███████▌  | 3/4 [00:00<00:00, 18.83it/s]
2025-03-09 08:05:29,980 [INFO]: 	>>> Finished "Compute fast metrics" in 19.3092 secs
2025-03-09 08:05:29,981 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 71.5964 secs
2025-03-09 08:05:29,981 [INFO]: {
2025-03-09 08:05:29,981 [INFO]: 	index_key: HNSW15
2025-03-09 08:05:29,981 [INFO]: 	index_param: efSearch=219
2025-03-09 08:05:29,981 [INFO]: 	index_path: knn.index
2025-03-09 08:05:29,981 [INFO]: 	size in bytes: 1034283730
2025-03-09 08:05:29,981 [INFO]: 	avg_search_speed_ms: 9.316072489258103
2025-03-09 08:05:29,981 [INFO]: 	99p_search_speed_ms: 20.62163431663066
2025-03-09 08:05:29,981 [INFO]: 	reconstruction error %: 0.0
2025-03-09 08:05:29,981 [INFO]: 	nb vectors: 5257
2025-03-09 08:05:29,981 [INFO]: 	vectors dimension: 49152
2025-03-09 08:05:29,981 [INFO]: 	compression ratio: 0.9993082420430224
2025-03-09 08:05:29,981 [INFO]: }
2025-03-09 08:05:29,981 [INFO]: 	>>> Finished "Creating the index" in 71.5976 secs
2025-03-09 08:05:29,981 [INFO]: >>> Finished "Launching the whole pipeline" in 71.6228 secs
2025-03-09 08:05:31: [retrieval_preprocessing] calculating distances ...
2025-03-09 08:05:32: [retrieval_preprocessing] finished and saved retrieval indices for episode 75567 [episode count 12/20]
[retrieval_preprocessing] for episode 93487 [episode count 13/20], we have num_retrieval=np.int64(5406) num_query=np.int64(188)
2025-03-09 08:05:33,295 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-09 08:05:34,099 [INFO]: Launching the whole pipeline 03/09/2025, 08:05:34
2025-03-09 08:05:34,099 [INFO]: Reading total number of vectors and dimension 03/09/2025, 08:05:34
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 955.42it/s]
2025-03-09 08:05:34,132 [INFO]: There are 5406 embeddings of dim 49152
2025-03-09 08:05:34,133 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0332 secs
2025-03-09 08:05:34,133 [INFO]: 	Compute estimated construction time of the index 03/09/2025, 08:05:34
2025-03-09 08:05:34,133 [INFO]: 		-> Train: 16.7 minutes
2025-03-09 08:05:34,134 [INFO]: 		-> Add: 3.0 seconds
2025-03-09 08:05:34,134 [INFO]: 		Total: 16.7 minutes
2025-03-09 08:05:34,134 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0004 secs
2025-03-09 08:05:34,134 [INFO]: 	Checking that your have enough memory available to create the index 03/09/2025, 08:05:34
2025-03-09 08:05:34,134 [INFO]: 1.1GB of memory will be needed to build the index (more might be used if you have more)
2025-03-09 08:05:34,134 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0004 secs
2025-03-09 08:05:34,134 [INFO]: 	Selecting most promising index types given data characteristics 03/09/2025, 08:05:34
2025-03-09 08:05:34,134 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-09 08:05:34,134 [INFO]: 	Creating the index 03/09/2025, 08:05:34
2025-03-09 08:05:34,134 [INFO]: 		-> Instanciate the index HNSW15 03/09/2025, 08:05:34
2025-03-09 08:05:34,136 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0015 secs
2025-03-09 08:05:34,136 [INFO]: 		-> Adding the vectors to the index 03/09/2025, 08:05:34
2025-03-09 08:05:34,136 [INFO]: The memory available for adding the vectors is 49.0GB(total available - used by the index)
2025-03-09 08:05:34,137 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/23 [00:00<?, ?it/s]  4%|▍         | 1/23 [00:00<00:03,  7.14it/s] 26%|██▌       | 6/23 [00:00<00:00, 26.74it/s] 43%|████▎     | 10/23 [00:00<00:00, 30.15it/s] 61%|██████    | 14/23 [00:00<00:00, 33.27it/s] 83%|████████▎ | 19/23 [00:00<00:00, 37.52it/s]100%|██████████| 23/23 [00:05<00:00,  2.52it/s]100%|██████████| 23/23 [00:05<00:00,  4.42it/s]
2025-03-09 08:05:39,345 [INFO]: 	Computing best hyperparameters for index knn.index 03/09/2025, 08:05:39
2025-03-09 08:06:28,856 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 49.5098 secs
2025-03-09 08:06:28,856 [INFO]: The best hyperparameters are: efSearch=232
2025-03-09 08:06:28,856 [INFO]: 	Compute fast metrics 03/09/2025, 08:06:28
  0%|          | 0/4 [00:00<?, ?it/s] 75%|███████▌  | 3/4 [00:00<00:00, 26.96it/s] 75%|███████▌  | 3/4 [00:00<00:00, 21.97it/s]
2025-03-09 08:06:46,706 [INFO]: 	>>> Finished "Compute fast metrics" in 17.8498 secs
2025-03-09 08:06:46,706 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 72.5700 secs
2025-03-09 08:06:46,706 [INFO]: {
2025-03-09 08:06:46,707 [INFO]: 	index_key: HNSW15
2025-03-09 08:06:46,707 [INFO]: 	index_param: efSearch=232
2025-03-09 08:06:46,707 [INFO]: 	index_path: knn.index
2025-03-09 08:06:46,707 [INFO]: 	size in bytes: 1063598830
2025-03-09 08:06:46,707 [INFO]: 	avg_search_speed_ms: 9.97135254154251
2025-03-09 08:06:46,707 [INFO]: 	99p_search_speed_ms: 23.39873846620322
2025-03-09 08:06:46,707 [INFO]: 	reconstruction error %: 0.0
2025-03-09 08:06:46,707 [INFO]: 	nb vectors: 5406
2025-03-09 08:06:46,707 [INFO]: 	vectors dimension: 49152
2025-03-09 08:06:46,707 [INFO]: 	compression ratio: 0.9993080266927334
2025-03-09 08:06:46,707 [INFO]: }
2025-03-09 08:06:46,707 [INFO]: 	>>> Finished "Creating the index" in 72.5722 secs
2025-03-09 08:06:46,707 [INFO]: >>> Finished "Launching the whole pipeline" in 72.6072 secs
2025-03-09 08:06:48: [retrieval_preprocessing] calculating distances ...
2025-03-09 08:06:49: [retrieval_preprocessing] finished and saved retrieval indices for episode 93487 [episode count 13/20]
[retrieval_preprocessing] for episode 25910 [episode count 14/20], we have num_retrieval=np.int64(5321) num_query=np.int64(273)
2025-03-09 08:06:49,763 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-09 08:06:50,793 [INFO]: Launching the whole pipeline 03/09/2025, 08:06:50
2025-03-09 08:06:50,793 [INFO]: Reading total number of vectors and dimension 03/09/2025, 08:06:50
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1398.10it/s]
2025-03-09 08:06:50,822 [INFO]: There are 5321 embeddings of dim 49152
2025-03-09 08:06:50,822 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0293 secs
2025-03-09 08:06:50,822 [INFO]: 	Compute estimated construction time of the index 03/09/2025, 08:06:50
2025-03-09 08:06:50,822 [INFO]: 		-> Train: 16.7 minutes
2025-03-09 08:06:50,823 [INFO]: 		-> Add: 2.9 seconds
2025-03-09 08:06:50,823 [INFO]: 		Total: 16.7 minutes
2025-03-09 08:06:50,823 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0001 secs
2025-03-09 08:06:50,823 [INFO]: 	Checking that your have enough memory available to create the index 03/09/2025, 08:06:50
2025-03-09 08:06:50,823 [INFO]: 1.1GB of memory will be needed to build the index (more might be used if you have more)
2025-03-09 08:06:50,823 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0003 secs
2025-03-09 08:06:50,823 [INFO]: 	Selecting most promising index types given data characteristics 03/09/2025, 08:06:50
2025-03-09 08:06:50,823 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-09 08:06:50,823 [INFO]: 	Creating the index 03/09/2025, 08:06:50
2025-03-09 08:06:50,823 [INFO]: 		-> Instanciate the index HNSW15 03/09/2025, 08:06:50
2025-03-09 08:06:50,824 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0012 secs
2025-03-09 08:06:50,825 [INFO]: 		-> Adding the vectors to the index 03/09/2025, 08:06:50
2025-03-09 08:06:50,825 [INFO]: The memory available for adding the vectors is 49.0GB(total available - used by the index)
2025-03-09 08:06:50,825 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/22 [00:00<?, ?it/s]  5%|▍         | 1/22 [00:00<00:02,  7.33it/s] 27%|██▋       | 6/22 [00:00<00:00, 28.15it/s] 50%|█████     | 11/22 [00:00<00:00, 35.64it/s] 73%|███████▎  | 16/22 [00:00<00:00, 39.07it/s] 95%|█████████▌| 21/22 [00:04<00:00,  3.03it/s]100%|██████████| 22/22 [00:05<00:00,  4.17it/s]
2025-03-09 08:06:56,098 [INFO]: 	Computing best hyperparameters for index knn.index 03/09/2025, 08:06:56
2025-03-09 08:07:42,969 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 46.8709 secs
2025-03-09 08:07:42,969 [INFO]: The best hyperparameters are: efSearch=241
2025-03-09 08:07:42,969 [INFO]: 	Compute fast metrics 03/09/2025, 08:07:42
  0%|          | 0/4 [00:00<?, ?it/s] 75%|███████▌  | 3/4 [00:00<00:00, 27.18it/s] 75%|███████▌  | 3/4 [00:00<00:00, 23.31it/s]
2025-03-09 08:08:05,092 [INFO]: 	>>> Finished "Compute fast metrics" in 22.1224 secs
2025-03-09 08:08:05,092 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 74.2676 secs
2025-03-09 08:08:05,092 [INFO]: {
2025-03-09 08:08:05,092 [INFO]: 	index_key: HNSW15
2025-03-09 08:08:05,092 [INFO]: 	index_param: efSearch=241
2025-03-09 08:08:05,092 [INFO]: 	index_path: knn.index
2025-03-09 08:08:05,092 [INFO]: 	size in bytes: 1046875390
2025-03-09 08:08:05,092 [INFO]: 	avg_search_speed_ms: 9.143308603793887
2025-03-09 08:08:05,092 [INFO]: 	99p_search_speed_ms: 18.62820031354201
2025-03-09 08:08:05,092 [INFO]: 	reconstruction error %: 0.0
2025-03-09 08:08:05,092 [INFO]: 	nb vectors: 5321
2025-03-09 08:08:05,092 [INFO]: 	vectors dimension: 49152
2025-03-09 08:08:05,092 [INFO]: 	compression ratio: 0.9993082061084653
2025-03-09 08:08:05,092 [INFO]: }
2025-03-09 08:08:05,092 [INFO]: 	>>> Finished "Creating the index" in 74.2693 secs
2025-03-09 08:08:05,092 [INFO]: >>> Finished "Launching the whole pipeline" in 74.2995 secs
2025-03-09 08:08:07: [retrieval_preprocessing] calculating distances ...
2025-03-09 08:08:08: [retrieval_preprocessing] finished and saved retrieval indices for episode 25910 [episode count 14/20]
[retrieval_preprocessing] for episode 37430 [episode count 15/20], we have num_retrieval=np.int64(5399) num_query=np.int64(195)
2025-03-09 08:08:08,562 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-09 08:08:09,307 [INFO]: Launching the whole pipeline 03/09/2025, 08:08:09
2025-03-09 08:08:09,307 [INFO]: Reading total number of vectors and dimension 03/09/2025, 08:08:09
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 2253.79it/s]
2025-03-09 08:08:09,331 [INFO]: There are 5399 embeddings of dim 49152
2025-03-09 08:08:09,331 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0239 secs
2025-03-09 08:08:09,332 [INFO]: 	Compute estimated construction time of the index 03/09/2025, 08:08:09
2025-03-09 08:08:09,332 [INFO]: 		-> Train: 16.7 minutes
2025-03-09 08:08:09,332 [INFO]: 		-> Add: 3.0 seconds
2025-03-09 08:08:09,332 [INFO]: 		Total: 16.7 minutes
2025-03-09 08:08:09,332 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0001 secs
2025-03-09 08:08:09,332 [INFO]: 	Checking that your have enough memory available to create the index 03/09/2025, 08:08:09
2025-03-09 08:08:09,332 [INFO]: 1.1GB of memory will be needed to build the index (more might be used if you have more)
2025-03-09 08:08:09,332 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0001 secs
2025-03-09 08:08:09,332 [INFO]: 	Selecting most promising index types given data characteristics 03/09/2025, 08:08:09
2025-03-09 08:08:09,332 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-09 08:08:09,332 [INFO]: 	Creating the index 03/09/2025, 08:08:09
2025-03-09 08:08:09,332 [INFO]: 		-> Instanciate the index HNSW15 03/09/2025, 08:08:09
2025-03-09 08:08:09,333 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0008 secs
2025-03-09 08:08:09,333 [INFO]: 		-> Adding the vectors to the index 03/09/2025, 08:08:09
2025-03-09 08:08:09,333 [INFO]: The memory available for adding the vectors is 49.0GB(total available - used by the index)
2025-03-09 08:08:09,333 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/23 [00:00<?, ?it/s]  4%|▍         | 1/23 [00:00<00:03,  6.74it/s] 22%|██▏       | 5/23 [00:00<00:00, 22.65it/s] 48%|████▊     | 11/23 [00:00<00:00, 35.15it/s] 74%|███████▍  | 17/23 [00:00<00:00, 41.75it/s] 96%|█████████▌| 22/23 [00:04<00:00,  3.23it/s]100%|██████████| 23/23 [00:05<00:00,  4.12it/s]
2025-03-09 08:08:14,912 [INFO]: 	Computing best hyperparameters for index knn.index 03/09/2025, 08:08:14
2025-03-09 08:09:05,871 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 50.9588 secs
2025-03-09 08:09:05,872 [INFO]: The best hyperparameters are: efSearch=242
2025-03-09 08:09:05,872 [INFO]: 	Compute fast metrics 03/09/2025, 08:09:05
  0%|          | 0/4 [00:00<?, ?it/s] 50%|█████     | 2/4 [00:00<00:00, 19.99it/s] 75%|███████▌  | 3/4 [00:00<00:00, 21.26it/s]
2025-03-09 08:09:24,811 [INFO]: 	>>> Finished "Compute fast metrics" in 18.9390 secs
2025-03-09 08:09:24,812 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 75.4791 secs
2025-03-09 08:09:24,812 [INFO]: {
2025-03-09 08:09:24,812 [INFO]: 	index_key: HNSW15
2025-03-09 08:09:24,812 [INFO]: 	index_param: efSearch=242
2025-03-09 08:09:24,812 [INFO]: 	index_path: knn.index
2025-03-09 08:09:24,812 [INFO]: 	size in bytes: 1062221650
2025-03-09 08:09:24,812 [INFO]: 	avg_search_speed_ms: 9.655493102575793
2025-03-09 08:09:24,812 [INFO]: 	99p_search_speed_ms: 24.91274911444644
2025-03-09 08:09:24,812 [INFO]: 	reconstruction error %: 0.0
2025-03-09 08:09:24,812 [INFO]: 	nb vectors: 5399
2025-03-09 08:09:24,812 [INFO]: 	vectors dimension: 49152
2025-03-09 08:09:24,812 [INFO]: 	compression ratio: 0.9993079994180123
2025-03-09 08:09:24,812 [INFO]: }
2025-03-09 08:09:24,812 [INFO]: 	>>> Finished "Creating the index" in 75.4803 secs
2025-03-09 08:09:24,812 [INFO]: >>> Finished "Launching the whole pipeline" in 75.5047 secs
2025-03-09 08:09:26: [retrieval_preprocessing] calculating distances ...
2025-03-09 08:09:27: [retrieval_preprocessing] finished and saved retrieval indices for episode 37430 [episode count 15/20]
[retrieval_preprocessing] for episode 43062 [episode count 16/20], we have num_retrieval=np.int64(5004) num_query=np.int64(590)
2025-03-09 08:09:27,674 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-09 08:09:28,583 [INFO]: Launching the whole pipeline 03/09/2025, 08:09:28
2025-03-09 08:09:28,583 [INFO]: Reading total number of vectors and dimension 03/09/2025, 08:09:28
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1294.94it/s]
2025-03-09 08:09:28,613 [INFO]: There are 5004 embeddings of dim 49152
2025-03-09 08:09:28,613 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0299 secs
2025-03-09 08:09:28,613 [INFO]: 	Compute estimated construction time of the index 03/09/2025, 08:09:28
2025-03-09 08:09:28,613 [INFO]: 		-> Train: 16.7 minutes
2025-03-09 08:09:28,613 [INFO]: 		-> Add: 2.7 seconds
2025-03-09 08:09:28,613 [INFO]: 		Total: 16.7 minutes
2025-03-09 08:09:28,613 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0001 secs
2025-03-09 08:09:28,613 [INFO]: 	Checking that your have enough memory available to create the index 03/09/2025, 08:09:28
2025-03-09 08:09:28,613 [INFO]: 1.0GB of memory will be needed to build the index (more might be used if you have more)
2025-03-09 08:09:28,613 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0002 secs
2025-03-09 08:09:28,613 [INFO]: 	Selecting most promising index types given data characteristics 03/09/2025, 08:09:28
2025-03-09 08:09:28,613 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-09 08:09:28,613 [INFO]: 	Creating the index 03/09/2025, 08:09:28
2025-03-09 08:09:28,614 [INFO]: 		-> Instanciate the index HNSW15 03/09/2025, 08:09:28
2025-03-09 08:09:28,615 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0011 secs
2025-03-09 08:09:28,615 [INFO]: 		-> Adding the vectors to the index 03/09/2025, 08:09:28
2025-03-09 08:09:28,615 [INFO]: The memory available for adding the vectors is 49.1GB(total available - used by the index)
2025-03-09 08:09:28,615 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/20 [00:00<?, ?it/s]  5%|▌         | 1/20 [00:00<00:02,  8.34it/s] 30%|███       | 6/20 [00:00<00:00, 27.88it/s] 55%|█████▌    | 11/20 [00:00<00:00, 36.10it/s] 80%|████████  | 16/20 [00:00<00:00, 40.21it/s]100%|██████████| 20/20 [00:04<00:00,  4.67it/s]
2025-03-09 08:09:32,897 [INFO]: 	Computing best hyperparameters for index knn.index 03/09/2025, 08:09:32
2025-03-09 08:10:21,623 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 48.7259 secs
2025-03-09 08:10:21,623 [INFO]: The best hyperparameters are: efSearch=226
2025-03-09 08:10:21,623 [INFO]: 	Compute fast metrics 03/09/2025, 08:10:21
  0%|          | 0/4 [00:00<?, ?it/s] 50%|█████     | 2/4 [00:00<00:00, 18.21it/s] 75%|███████▌  | 3/4 [00:00<00:00, 19.09it/s]
2025-03-09 08:10:39,176 [INFO]: 	>>> Finished "Compute fast metrics" in 17.5526 secs
2025-03-09 08:10:39,179 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 70.5640 secs
2025-03-09 08:10:39,179 [INFO]: {
2025-03-09 08:10:39,179 [INFO]: 	index_key: HNSW15
2025-03-09 08:10:39,179 [INFO]: 	index_param: efSearch=226
2025-03-09 08:10:39,179 [INFO]: 	index_path: knn.index
2025-03-09 08:10:39,179 [INFO]: 	size in bytes: 984507190
2025-03-09 08:10:39,179 [INFO]: 	avg_search_speed_ms: 9.25692761205757
2025-03-09 08:10:39,179 [INFO]: 	99p_search_speed_ms: 18.929761694744254
2025-03-09 08:10:39,179 [INFO]: 	reconstruction error %: 0.0
2025-03-09 08:10:39,179 [INFO]: 	nb vectors: 5004
2025-03-09 08:10:39,179 [INFO]: 	vectors dimension: 49152
2025-03-09 08:10:39,179 [INFO]: 	compression ratio: 0.9993085291738703
2025-03-09 08:10:39,179 [INFO]: }
2025-03-09 08:10:39,179 [INFO]: 	>>> Finished "Creating the index" in 70.5658 secs
2025-03-09 08:10:39,179 [INFO]: >>> Finished "Launching the whole pipeline" in 70.5964 secs
2025-03-09 08:10:41: [retrieval_preprocessing] calculating distances ...
2025-03-09 08:10:43: [retrieval_preprocessing] finished and saved retrieval indices for episode 43062 [episode count 16/20]
[retrieval_preprocessing] for episode 39865 [episode count 17/20], we have num_retrieval=np.int64(5371) num_query=np.int64(223)
2025-03-09 08:10:44,079 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-09 08:10:45,464 [INFO]: Launching the whole pipeline 03/09/2025, 08:10:45
2025-03-09 08:10:45,464 [INFO]: Reading total number of vectors and dimension 03/09/2025, 08:10:45
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 2178.86it/s]
2025-03-09 08:10:45,487 [INFO]: There are 5371 embeddings of dim 49152
2025-03-09 08:10:45,488 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0238 secs
2025-03-09 08:10:45,488 [INFO]: 	Compute estimated construction time of the index 03/09/2025, 08:10:45
2025-03-09 08:10:45,488 [INFO]: 		-> Train: 16.7 minutes
2025-03-09 08:10:45,488 [INFO]: 		-> Add: 3.0 seconds
2025-03-09 08:10:45,488 [INFO]: 		Total: 16.7 minutes
2025-03-09 08:10:45,488 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0001 secs
2025-03-09 08:10:45,488 [INFO]: 	Checking that your have enough memory available to create the index 03/09/2025, 08:10:45
2025-03-09 08:10:45,488 [INFO]: 1.1GB of memory will be needed to build the index (more might be used if you have more)
2025-03-09 08:10:45,488 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0001 secs
2025-03-09 08:10:45,488 [INFO]: 	Selecting most promising index types given data characteristics 03/09/2025, 08:10:45
2025-03-09 08:10:45,488 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-09 08:10:45,488 [INFO]: 	Creating the index 03/09/2025, 08:10:45
2025-03-09 08:10:45,488 [INFO]: 		-> Instanciate the index HNSW15 03/09/2025, 08:10:45
2025-03-09 08:10:45,489 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0010 secs
2025-03-09 08:10:45,489 [INFO]: 		-> Adding the vectors to the index 03/09/2025, 08:10:45
2025-03-09 08:10:45,489 [INFO]: The memory available for adding the vectors is 49.0GB(total available - used by the index)
2025-03-09 08:10:45,489 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/23 [00:00<?, ?it/s]  4%|▍         | 1/23 [00:00<00:02,  9.00it/s] 30%|███       | 7/23 [00:00<00:00, 35.84it/s] 57%|█████▋    | 13/23 [00:00<00:00, 45.13it/s] 78%|███████▊  | 18/23 [00:00<00:00, 44.90it/s]100%|██████████| 23/23 [00:04<00:00,  3.07it/s]100%|██████████| 23/23 [00:04<00:00,  4.87it/s]
2025-03-09 08:10:50,212 [INFO]: 	Computing best hyperparameters for index knn.index 03/09/2025, 08:10:50
2025-03-09 08:11:34,038 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 43.8251 secs
2025-03-09 08:11:34,038 [INFO]: The best hyperparameters are: efSearch=198
2025-03-09 08:11:34,038 [INFO]: 	Compute fast metrics 03/09/2025, 08:11:34
  0%|          | 0/4 [00:00<?, ?it/s] 25%|██▌       | 1/4 [00:00<00:00,  7.72it/s] 75%|███████▌  | 3/4 [00:00<00:00, 14.65it/s]
2025-03-09 08:11:49,299 [INFO]: 	>>> Finished "Compute fast metrics" in 15.2611 secs
2025-03-09 08:11:49,300 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 63.8103 secs
2025-03-09 08:11:49,300 [INFO]: {
2025-03-09 08:11:49,300 [INFO]: 	index_key: HNSW15
2025-03-09 08:11:49,300 [INFO]: 	index_param: efSearch=198
2025-03-09 08:11:49,300 [INFO]: 	index_path: knn.index
2025-03-09 08:11:49,300 [INFO]: 	size in bytes: 1056712690
2025-03-09 08:11:49,300 [INFO]: 	avg_search_speed_ms: 9.471453947877638
2025-03-09 08:11:49,300 [INFO]: 	99p_search_speed_ms: 19.67259449884298
2025-03-09 08:11:49,300 [INFO]: 	reconstruction error %: 0.0
2025-03-09 08:11:49,300 [INFO]: 	nb vectors: 5371
2025-03-09 08:11:49,300 [INFO]: 	vectors dimension: 49152
2025-03-09 08:11:49,300 [INFO]: 	compression ratio: 0.9993081165704558
2025-03-09 08:11:49,300 [INFO]: }
2025-03-09 08:11:49,300 [INFO]: 	>>> Finished "Creating the index" in 63.8118 secs
2025-03-09 08:11:49,300 [INFO]: >>> Finished "Launching the whole pipeline" in 63.8362 secs
2025-03-09 08:11:50: [retrieval_preprocessing] calculating distances ...
2025-03-09 08:11:50: [retrieval_preprocessing] finished and saved retrieval indices for episode 39865 [episode count 17/20]
[retrieval_preprocessing] for episode 44090 [episode count 18/20], we have num_retrieval=np.int64(5444) num_query=np.int64(150)
2025-03-09 08:11:51,313 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-09 08:11:52,041 [INFO]: Launching the whole pipeline 03/09/2025, 08:11:52
2025-03-09 08:11:52,041 [INFO]: Reading total number of vectors and dimension 03/09/2025, 08:11:52
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1651.30it/s]
2025-03-09 08:11:52,067 [INFO]: There are 5444 embeddings of dim 49152
2025-03-09 08:11:52,068 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0264 secs
2025-03-09 08:11:52,068 [INFO]: 	Compute estimated construction time of the index 03/09/2025, 08:11:52
2025-03-09 08:11:52,068 [INFO]: 		-> Train: 16.7 minutes
2025-03-09 08:11:52,068 [INFO]: 		-> Add: 3.0 seconds
2025-03-09 08:11:52,068 [INFO]: 		Total: 16.7 minutes
2025-03-09 08:11:52,068 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0001 secs
2025-03-09 08:11:52,068 [INFO]: 	Checking that your have enough memory available to create the index 03/09/2025, 08:11:52
2025-03-09 08:11:52,068 [INFO]: 1.1GB of memory will be needed to build the index (more might be used if you have more)
2025-03-09 08:11:52,068 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0002 secs
2025-03-09 08:11:52,068 [INFO]: 	Selecting most promising index types given data characteristics 03/09/2025, 08:11:52
2025-03-09 08:11:52,068 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-09 08:11:52,068 [INFO]: 	Creating the index 03/09/2025, 08:11:52
2025-03-09 08:11:52,068 [INFO]: 		-> Instanciate the index HNSW15 03/09/2025, 08:11:52
2025-03-09 08:11:52,069 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0010 secs
2025-03-09 08:11:52,069 [INFO]: 		-> Adding the vectors to the index 03/09/2025, 08:11:52
2025-03-09 08:11:52,069 [INFO]: The memory available for adding the vectors is 49.0GB(total available - used by the index)
2025-03-09 08:11:52,069 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/23 [00:00<?, ?it/s]  4%|▍         | 1/23 [00:00<00:03,  7.33it/s] 26%|██▌       | 6/23 [00:00<00:00, 26.76it/s] 48%|████▊     | 11/23 [00:00<00:00, 34.97it/s] 74%|███████▍  | 17/23 [00:00<00:00, 41.52it/s] 96%|█████████▌| 22/23 [00:04<00:00,  3.64it/s]100%|██████████| 23/23 [00:04<00:00,  4.78it/s]
2025-03-09 08:11:56,888 [INFO]: 	Computing best hyperparameters for index knn.index 03/09/2025, 08:11:56
2025-03-09 08:12:43,887 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 46.9987 secs
2025-03-09 08:12:43,887 [INFO]: The best hyperparameters are: efSearch=226
2025-03-09 08:12:43,887 [INFO]: 	Compute fast metrics 03/09/2025, 08:12:43
  0%|          | 0/4 [00:00<?, ?it/s] 50%|█████     | 2/4 [00:00<00:00, 19.80it/s] 75%|███████▌  | 3/4 [00:00<00:00, 21.49it/s]
2025-03-09 08:13:11,014 [INFO]: 	>>> Finished "Compute fast metrics" in 27.1270 secs
2025-03-09 08:13:11,014 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 78.9451 secs
2025-03-09 08:13:11,015 [INFO]: {
2025-03-09 08:13:11,015 [INFO]: 	index_key: HNSW15
2025-03-09 08:13:11,015 [INFO]: 	index_param: efSearch=226
2025-03-09 08:13:11,015 [INFO]: 	index_path: knn.index
2025-03-09 08:13:11,015 [INFO]: 	size in bytes: 1071075070
2025-03-09 08:13:11,015 [INFO]: 	avg_search_speed_ms: 9.150456138251712
2025-03-09 08:13:11,015 [INFO]: 	99p_search_speed_ms: 20.761250760406146
2025-03-09 08:13:11,015 [INFO]: 	reconstruction error %: 0.0
2025-03-09 08:13:11,015 [INFO]: 	nb vectors: 5444
2025-03-09 08:13:11,015 [INFO]: 	vectors dimension: 49152
2025-03-09 08:13:11,015 [INFO]: 	compression ratio: 0.9993080615721921
2025-03-09 08:13:11,015 [INFO]: }
2025-03-09 08:13:11,015 [INFO]: 	>>> Finished "Creating the index" in 78.9466 secs
2025-03-09 08:13:11,015 [INFO]: >>> Finished "Launching the whole pipeline" in 78.9736 secs
2025-03-09 08:13:11: [retrieval_preprocessing] calculating distances ...
2025-03-09 08:13:12: [retrieval_preprocessing] finished and saved retrieval indices for episode 44090 [episode count 18/20]
[retrieval_preprocessing] for episode 92729 [episode count 19/20], we have num_retrieval=np.int64(5096) num_query=np.int64(498)
2025-03-09 08:13:12,678 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-09 08:13:13,322 [INFO]: Launching the whole pipeline 03/09/2025, 08:13:13
2025-03-09 08:13:13,323 [INFO]: Reading total number of vectors and dimension 03/09/2025, 08:13:13
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1112.84it/s]
2025-03-09 08:13:13,347 [INFO]: There are 5096 embeddings of dim 49152
2025-03-09 08:13:13,347 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0246 secs
2025-03-09 08:13:13,348 [INFO]: 	Compute estimated construction time of the index 03/09/2025, 08:13:13
2025-03-09 08:13:13,348 [INFO]: 		-> Train: 16.7 minutes
2025-03-09 08:13:13,348 [INFO]: 		-> Add: 2.8 seconds
2025-03-09 08:13:13,348 [INFO]: 		Total: 16.7 minutes
2025-03-09 08:13:13,348 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0003 secs
2025-03-09 08:13:13,348 [INFO]: 	Checking that your have enough memory available to create the index 03/09/2025, 08:13:13
2025-03-09 08:13:13,348 [INFO]: 1.0GB of memory will be needed to build the index (more might be used if you have more)
2025-03-09 08:13:13,348 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0004 secs
2025-03-09 08:13:13,349 [INFO]: 	Selecting most promising index types given data characteristics 03/09/2025, 08:13:13
2025-03-09 08:13:13,349 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-09 08:13:13,349 [INFO]: 	Creating the index 03/09/2025, 08:13:13
2025-03-09 08:13:13,349 [INFO]: 		-> Instanciate the index HNSW15 03/09/2025, 08:13:13
2025-03-09 08:13:13,351 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0026 secs
2025-03-09 08:13:13,352 [INFO]: 		-> Adding the vectors to the index 03/09/2025, 08:13:13
2025-03-09 08:13:13,352 [INFO]: The memory available for adding the vectors is 49.1GB(total available - used by the index)
2025-03-09 08:13:13,352 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/22 [00:00<?, ?it/s]  9%|▉         | 2/22 [00:00<00:01, 18.71it/s] 32%|███▏      | 7/22 [00:00<00:00, 35.00it/s] 50%|█████     | 11/22 [00:00<00:00, 33.28it/s] 73%|███████▎  | 16/22 [00:00<00:00, 37.58it/s] 95%|█████████▌| 21/22 [00:04<00:00,  2.79it/s]100%|██████████| 22/22 [00:05<00:00,  4.21it/s]
2025-03-09 08:13:18,588 [INFO]: 	Computing best hyperparameters for index knn.index 03/09/2025, 08:13:18
2025-03-09 08:14:01,694 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 43.1057 secs
2025-03-09 08:14:01,694 [INFO]: The best hyperparameters are: efSearch=229
2025-03-09 08:14:01,694 [INFO]: 	Compute fast metrics 03/09/2025, 08:14:01
  0%|          | 0/4 [00:00<?, ?it/s] 75%|███████▌  | 3/4 [00:00<00:00, 26.09it/s] 75%|███████▌  | 3/4 [00:00<00:00, 22.15it/s]
2025-03-09 08:14:22,579 [INFO]: 	>>> Finished "Compute fast metrics" in 20.8847 secs
2025-03-09 08:14:22,579 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 69.2274 secs
2025-03-09 08:14:22,579 [INFO]: {
2025-03-09 08:14:22,579 [INFO]: 	index_key: HNSW15
2025-03-09 08:14:22,579 [INFO]: 	index_param: efSearch=229
2025-03-09 08:14:22,579 [INFO]: 	index_path: knn.index
2025-03-09 08:14:22,579 [INFO]: 	size in bytes: 1002607630
2025-03-09 08:14:22,579 [INFO]: 	avg_search_speed_ms: 9.171160687047964
2025-03-09 08:14:22,579 [INFO]: 	99p_search_speed_ms: 20.835147472098456
2025-03-09 08:14:22,579 [INFO]: 	reconstruction error %: 0.0
2025-03-09 08:14:22,579 [INFO]: 	nb vectors: 5096
2025-03-09 08:14:22,579 [INFO]: 	vectors dimension: 49152
2025-03-09 08:14:22,579 [INFO]: 	compression ratio: 0.9993085410690521
2025-03-09 08:14:22,579 [INFO]: }
2025-03-09 08:14:22,579 [INFO]: 	>>> Finished "Creating the index" in 69.2307 secs
2025-03-09 08:14:22,580 [INFO]: >>> Finished "Launching the whole pipeline" in 69.2569 secs
2025-03-09 08:14:26: [retrieval_preprocessing] calculating distances ...
2025-03-09 08:14:28: [retrieval_preprocessing] finished and saved retrieval indices for episode 92729 [episode count 19/20]
2025-03-09 08:14:28: [retrieval_preprocessing] finished for (5576515039, 'marker') [chosen_id count 3/10]
2025-03-09 08:14:30: [retrieval_preprocessing] concatenated all embeddings and indices for 20 episodes for (4465064685, 'marker') [chosen_id count 4/10]
2025-03-09 08:14:30: [retrieval_preprocessing] we have num_total=3181 embedding_dim=49152
[retrieval_preprocessing] for episode 24578 [episode count 0/20], we have num_retrieval=np.int64(3041) num_query=np.int64(140)
2025-03-09 08:14:30,461 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-09 08:14:30,975 [INFO]: Launching the whole pipeline 03/09/2025, 08:14:30
2025-03-09 08:14:30,975 [INFO]: Reading total number of vectors and dimension 03/09/2025, 08:14:30
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1508.20it/s]
2025-03-09 08:14:31,005 [INFO]: There are 3041 embeddings of dim 49152
2025-03-09 08:14:31,005 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0295 secs
2025-03-09 08:14:31,005 [INFO]: 	Compute estimated construction time of the index 03/09/2025, 08:14:31
2025-03-09 08:14:31,005 [INFO]: 		-> Train: 16.7 minutes
2025-03-09 08:14:31,005 [INFO]: 		-> Add: 1.7 seconds
2025-03-09 08:14:31,005 [INFO]: 		Total: 16.7 minutes
2025-03-09 08:14:31,005 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0001 secs
2025-03-09 08:14:31,005 [INFO]: 	Checking that your have enough memory available to create the index 03/09/2025, 08:14:31
2025-03-09 08:14:31,005 [INFO]: 627.6MB of memory will be needed to build the index (more might be used if you have more)
2025-03-09 08:14:31,005 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0002 secs
2025-03-09 08:14:31,005 [INFO]: 	Selecting most promising index types given data characteristics 03/09/2025, 08:14:31
2025-03-09 08:14:31,005 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-09 08:14:31,005 [INFO]: 	Creating the index 03/09/2025, 08:14:31
2025-03-09 08:14:31,005 [INFO]: 		-> Instanciate the index HNSW15 03/09/2025, 08:14:31
2025-03-09 08:14:31,007 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0011 secs
2025-03-09 08:14:31,007 [INFO]: 		-> Adding the vectors to the index 03/09/2025, 08:14:31
2025-03-09 08:14:31,007 [INFO]: The memory available for adding the vectors is 49.4GB(total available - used by the index)
2025-03-09 08:14:31,007 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/12 [00:00<?, ?it/s]  8%|▊         | 1/12 [00:00<00:01,  8.85it/s] 33%|███▎      | 4/12 [00:00<00:00, 19.97it/s] 75%|███████▌  | 9/12 [00:00<00:00, 32.56it/s]100%|██████████| 12/12 [00:02<00:00,  4.50it/s]
2025-03-09 08:14:33,675 [INFO]: 	Computing best hyperparameters for index knn.index 03/09/2025, 08:14:33
2025-03-09 08:15:06,792 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 33.1161 secs
2025-03-09 08:15:06,792 [INFO]: The best hyperparameters are: efSearch=322
2025-03-09 08:15:06,792 [INFO]: 	Compute fast metrics 03/09/2025, 08:15:06
  0%|          | 0/4 [00:00<?, ?it/s] 75%|███████▌  | 3/4 [00:00<00:00, 26.23it/s] 75%|███████▌  | 3/4 [00:00<00:00, 22.62it/s]
2025-03-09 08:15:22,008 [INFO]: 	>>> Finished "Compute fast metrics" in 15.2160 secs
2025-03-09 08:15:22,010 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 51.0029 secs
2025-03-09 08:15:22,010 [INFO]: {
2025-03-09 08:15:22,010 [INFO]: 	index_key: HNSW15
2025-03-09 08:15:22,010 [INFO]: 	index_param: efSearch=322
2025-03-09 08:15:22,010 [INFO]: 	index_path: knn.index
2025-03-09 08:15:22,010 [INFO]: 	size in bytes: 598297810
2025-03-09 08:15:22,010 [INFO]: 	avg_search_speed_ms: 10.796774119970578
2025-03-09 08:15:22,010 [INFO]: 	99p_search_speed_ms: 18.855572282336652
2025-03-09 08:15:22,010 [INFO]: 	reconstruction error %: 0.0
2025-03-09 08:15:22,010 [INFO]: 	nb vectors: 3041
2025-03-09 08:15:22,010 [INFO]: 	vectors dimension: 49152
2025-03-09 08:15:22,010 [INFO]: 	compression ratio: 0.9993099055468714
2025-03-09 08:15:22,010 [INFO]: }
2025-03-09 08:15:22,010 [INFO]: 	>>> Finished "Creating the index" in 51.0044 secs
2025-03-09 08:15:22,010 [INFO]: >>> Finished "Launching the whole pipeline" in 51.0346 secs
2025-03-09 08:15:22: [retrieval_preprocessing] calculating distances ...
2025-03-09 08:15:23: [retrieval_preprocessing] finished and saved retrieval indices for episode 24578 [episode count 0/20]
[retrieval_preprocessing] for episode 20996 [episode count 1/20], we have num_retrieval=np.int64(2959) num_query=np.int64(222)
2025-03-09 08:15:23,507 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-09 08:15:23,848 [INFO]: Launching the whole pipeline 03/09/2025, 08:15:23
2025-03-09 08:15:23,848 [INFO]: Reading total number of vectors and dimension 03/09/2025, 08:15:23
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1535.81it/s]
2025-03-09 08:15:23,871 [INFO]: There are 2959 embeddings of dim 49152
2025-03-09 08:15:23,872 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0236 secs
2025-03-09 08:15:23,872 [INFO]: 	Compute estimated construction time of the index 03/09/2025, 08:15:23
2025-03-09 08:15:23,872 [INFO]: 		-> Train: 16.7 minutes
2025-03-09 08:15:23,872 [INFO]: 		-> Add: 1.6 seconds
2025-03-09 08:15:23,872 [INFO]: 		Total: 16.7 minutes
2025-03-09 08:15:23,872 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0001 secs
2025-03-09 08:15:23,872 [INFO]: 	Checking that your have enough memory available to create the index 03/09/2025, 08:15:23
2025-03-09 08:15:23,872 [INFO]: 610.7MB of memory will be needed to build the index (more might be used if you have more)
2025-03-09 08:15:23,872 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0001 secs
2025-03-09 08:15:23,872 [INFO]: 	Selecting most promising index types given data characteristics 03/09/2025, 08:15:23
2025-03-09 08:15:23,872 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-09 08:15:23,872 [INFO]: 	Creating the index 03/09/2025, 08:15:23
2025-03-09 08:15:23,872 [INFO]: 		-> Instanciate the index HNSW15 03/09/2025, 08:15:23
2025-03-09 08:15:23,873 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0009 secs
2025-03-09 08:15:23,873 [INFO]: 		-> Adding the vectors to the index 03/09/2025, 08:15:23
2025-03-09 08:15:23,873 [INFO]: The memory available for adding the vectors is 49.5GB(total available - used by the index)
2025-03-09 08:15:23,873 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/12 [00:00<?, ?it/s]  8%|▊         | 1/12 [00:00<00:01,  9.70it/s] 58%|█████▊    | 7/12 [00:00<00:00, 38.02it/s]100%|██████████| 12/12 [00:01<00:00,  5.17it/s]100%|██████████| 12/12 [00:01<00:00,  6.12it/s]
2025-03-09 08:15:25,838 [INFO]: 	Computing best hyperparameters for index knn.index 03/09/2025, 08:15:25
2025-03-09 08:15:53,788 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 27.9501 secs
2025-03-09 08:15:53,788 [INFO]: The best hyperparameters are: efSearch=316
2025-03-09 08:15:53,788 [INFO]: 	Compute fast metrics 03/09/2025, 08:15:53
  0%|          | 0/4 [00:00<?, ?it/s] 75%|███████▌  | 3/4 [00:00<00:00, 29.15it/s] 75%|███████▌  | 3/4 [00:00<00:00, 24.80it/s]
2025-03-09 08:16:11,126 [INFO]: 	>>> Finished "Compute fast metrics" in 17.3383 secs
2025-03-09 08:16:11,128 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 47.2547 secs
2025-03-09 08:16:11,128 [INFO]: {
2025-03-09 08:16:11,128 [INFO]: 	index_key: HNSW15
2025-03-09 08:16:11,128 [INFO]: 	index_param: efSearch=316
2025-03-09 08:16:11,128 [INFO]: 	index_path: knn.index
2025-03-09 08:16:11,128 [INFO]: 	size in bytes: 582164950
2025-03-09 08:16:11,128 [INFO]: 	avg_search_speed_ms: 10.697732975128739
2025-03-09 08:16:11,128 [INFO]: 	99p_search_speed_ms: 18.91124180983752
2025-03-09 08:16:11,128 [INFO]: 	reconstruction error %: 0.0
2025-03-09 08:16:11,128 [INFO]: 	nb vectors: 2959
2025-03-09 08:16:11,128 [INFO]: 	vectors dimension: 49152
2025-03-09 08:16:11,128 [INFO]: 	compression ratio: 0.9993096836214547
2025-03-09 08:16:11,128 [INFO]: }
2025-03-09 08:16:11,128 [INFO]: 	>>> Finished "Creating the index" in 47.2561 secs
2025-03-09 08:16:11,128 [INFO]: >>> Finished "Launching the whole pipeline" in 47.2802 secs
2025-03-09 08:16:12: [retrieval_preprocessing] calculating distances ...
2025-03-09 08:16:13: [retrieval_preprocessing] finished and saved retrieval indices for episode 20996 [episode count 1/20]
[retrieval_preprocessing] for episode 517 [episode count 2/20], we have num_retrieval=np.int64(3022) num_query=np.int64(159)
2025-03-09 08:16:13,840 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-09 08:16:14,316 [INFO]: Launching the whole pipeline 03/09/2025, 08:16:14
2025-03-09 08:16:14,316 [INFO]: Reading total number of vectors and dimension 03/09/2025, 08:16:14
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1435.42it/s]
2025-03-09 08:16:14,344 [INFO]: There are 3022 embeddings of dim 49152
2025-03-09 08:16:14,344 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0284 secs
2025-03-09 08:16:14,344 [INFO]: 	Compute estimated construction time of the index 03/09/2025, 08:16:14
2025-03-09 08:16:14,345 [INFO]: 		-> Train: 16.7 minutes
2025-03-09 08:16:14,345 [INFO]: 		-> Add: 1.7 seconds
2025-03-09 08:16:14,345 [INFO]: 		Total: 16.7 minutes
2025-03-09 08:16:14,345 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0001 secs
2025-03-09 08:16:14,345 [INFO]: 	Checking that your have enough memory available to create the index 03/09/2025, 08:16:14
2025-03-09 08:16:14,345 [INFO]: 623.7MB of memory will be needed to build the index (more might be used if you have more)
2025-03-09 08:16:14,345 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0002 secs
2025-03-09 08:16:14,345 [INFO]: 	Selecting most promising index types given data characteristics 03/09/2025, 08:16:14
2025-03-09 08:16:14,345 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-09 08:16:14,345 [INFO]: 	Creating the index 03/09/2025, 08:16:14
2025-03-09 08:16:14,345 [INFO]: 		-> Instanciate the index HNSW15 03/09/2025, 08:16:14
2025-03-09 08:16:14,346 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0012 secs
2025-03-09 08:16:14,346 [INFO]: 		-> Adding the vectors to the index 03/09/2025, 08:16:14
2025-03-09 08:16:14,347 [INFO]: The memory available for adding the vectors is 49.4GB(total available - used by the index)
2025-03-09 08:16:14,347 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/12 [00:00<?, ?it/s] 17%|█▋        | 2/12 [00:00<00:00, 18.24it/s] 75%|███████▌  | 9/12 [00:00<00:00, 45.49it/s]100%|██████████| 12/12 [00:02<00:00,  5.32it/s]
2025-03-09 08:16:16,606 [INFO]: 	Computing best hyperparameters for index knn.index 03/09/2025, 08:16:16
2025-03-09 08:16:48,116 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 31.5093 secs
2025-03-09 08:16:48,116 [INFO]: The best hyperparameters are: efSearch=261
2025-03-09 08:16:48,116 [INFO]: 	Compute fast metrics 03/09/2025, 08:16:48
  0%|          | 0/4 [00:00<?, ?it/s] 50%|█████     | 2/4 [00:00<00:00, 19.43it/s] 75%|███████▌  | 3/4 [00:00<00:00, 21.17it/s]
2025-03-09 08:17:05,006 [INFO]: 	>>> Finished "Compute fast metrics" in 16.8901 secs
2025-03-09 08:17:05,008 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 50.6616 secs
2025-03-09 08:17:05,008 [INFO]: {
2025-03-09 08:17:05,008 [INFO]: 	index_key: HNSW15
2025-03-09 08:17:05,008 [INFO]: 	index_param: efSearch=261
2025-03-09 08:17:05,008 [INFO]: 	index_path: knn.index
2025-03-09 08:17:05,008 [INFO]: 	size in bytes: 594559690
2025-03-09 08:17:05,008 [INFO]: 	avg_search_speed_ms: 10.460084313711844
2025-03-09 08:17:05,008 [INFO]: 	99p_search_speed_ms: 21.51348419720308
2025-03-09 08:17:05,008 [INFO]: 	reconstruction error %: 0.0
2025-03-09 08:17:05,008 [INFO]: 	nb vectors: 3022
2025-03-09 08:17:05,008 [INFO]: 	vectors dimension: 49152
2025-03-09 08:17:05,008 [INFO]: 	compression ratio: 0.9993098859426545
2025-03-09 08:17:05,008 [INFO]: }
2025-03-09 08:17:05,008 [INFO]: 	>>> Finished "Creating the index" in 50.6633 secs
2025-03-09 08:17:05,008 [INFO]: >>> Finished "Launching the whole pipeline" in 50.6925 secs
2025-03-09 08:17:05: [retrieval_preprocessing] calculating distances ...
2025-03-09 08:17:06: [retrieval_preprocessing] finished and saved retrieval indices for episode 517 [episode count 2/20]
[retrieval_preprocessing] for episode 32772 [episode count 3/20], we have num_retrieval=np.int64(3002) num_query=np.int64(179)
2025-03-09 08:17:06,671 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-09 08:17:07,154 [INFO]: Launching the whole pipeline 03/09/2025, 08:17:07
2025-03-09 08:17:07,154 [INFO]: Reading total number of vectors and dimension 03/09/2025, 08:17:07
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1538.07it/s]
2025-03-09 08:17:07,178 [INFO]: There are 3002 embeddings of dim 49152
2025-03-09 08:17:07,179 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0242 secs
2025-03-09 08:17:07,179 [INFO]: 	Compute estimated construction time of the index 03/09/2025, 08:17:07
2025-03-09 08:17:07,179 [INFO]: 		-> Train: 16.7 minutes
2025-03-09 08:17:07,179 [INFO]: 		-> Add: 1.6 seconds
2025-03-09 08:17:07,179 [INFO]: 		Total: 16.7 minutes
2025-03-09 08:17:07,179 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0002 secs
2025-03-09 08:17:07,179 [INFO]: 	Checking that your have enough memory available to create the index 03/09/2025, 08:17:07
2025-03-09 08:17:07,179 [INFO]: 619.5MB of memory will be needed to build the index (more might be used if you have more)
2025-03-09 08:17:07,179 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0001 secs
2025-03-09 08:17:07,179 [INFO]: 	Selecting most promising index types given data characteristics 03/09/2025, 08:17:07
2025-03-09 08:17:07,179 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-09 08:17:07,179 [INFO]: 	Creating the index 03/09/2025, 08:17:07
2025-03-09 08:17:07,179 [INFO]: 		-> Instanciate the index HNSW15 03/09/2025, 08:17:07
2025-03-09 08:17:07,181 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0012 secs
2025-03-09 08:17:07,181 [INFO]: 		-> Adding the vectors to the index 03/09/2025, 08:17:07
2025-03-09 08:17:07,181 [INFO]: The memory available for adding the vectors is 49.4GB(total available - used by the index)
2025-03-09 08:17:07,181 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/12 [00:00<?, ?it/s] 17%|█▋        | 2/12 [00:00<00:00, 19.31it/s] 58%|█████▊    | 7/12 [00:00<00:00, 30.23it/s]100%|██████████| 12/12 [00:02<00:00,  4.01it/s]100%|██████████| 12/12 [00:02<00:00,  4.88it/s]
2025-03-09 08:17:09,645 [INFO]: 	Computing best hyperparameters for index knn.index 03/09/2025, 08:17:09
2025-03-09 08:17:40,483 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 30.8381 secs
2025-03-09 08:17:40,484 [INFO]: The best hyperparameters are: efSearch=267
2025-03-09 08:17:40,484 [INFO]: 	Compute fast metrics 03/09/2025, 08:17:40
  0%|          | 0/4 [00:00<?, ?it/s] 50%|█████     | 2/4 [00:00<00:00, 19.12it/s] 75%|███████▌  | 3/4 [00:00<00:00, 20.67it/s]
2025-03-09 08:17:56,772 [INFO]: 	>>> Finished "Compute fast metrics" in 16.2887 secs
2025-03-09 08:17:56,774 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 49.5934 secs
2025-03-09 08:17:56,774 [INFO]: {
2025-03-09 08:17:56,774 [INFO]: 	index_key: HNSW15
2025-03-09 08:17:56,774 [INFO]: 	index_param: efSearch=267
2025-03-09 08:17:56,774 [INFO]: 	index_path: knn.index
2025-03-09 08:17:56,774 [INFO]: 	size in bytes: 590624890
2025-03-09 08:17:56,774 [INFO]: 	avg_search_speed_ms: 10.958370361691351
2025-03-09 08:17:56,774 [INFO]: 	99p_search_speed_ms: 21.922441273927685
2025-03-09 08:17:56,774 [INFO]: 	reconstruction error %: 0.0
2025-03-09 08:17:56,774 [INFO]: 	nb vectors: 3002
2025-03-09 08:17:56,774 [INFO]: 	vectors dimension: 49152
2025-03-09 08:17:56,774 [INFO]: 	compression ratio: 0.9993097581783253
2025-03-09 08:17:56,774 [INFO]: }
2025-03-09 08:17:56,774 [INFO]: 	>>> Finished "Creating the index" in 49.5951 secs
2025-03-09 08:17:56,774 [INFO]: >>> Finished "Launching the whole pipeline" in 49.6201 secs
2025-03-09 08:17:57: [retrieval_preprocessing] calculating distances ...
2025-03-09 08:17:58: [retrieval_preprocessing] finished and saved retrieval indices for episode 32772 [episode count 3/20]
[retrieval_preprocessing] for episode 32775 [episode count 4/20], we have num_retrieval=np.int64(3023) num_query=np.int64(158)
2025-03-09 08:17:58,662 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-09 08:17:59,083 [INFO]: Launching the whole pipeline 03/09/2025, 08:17:59
2025-03-09 08:17:59,083 [INFO]: Reading total number of vectors and dimension 03/09/2025, 08:17:59
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1857.53it/s]
2025-03-09 08:17:59,108 [INFO]: There are 3023 embeddings of dim 49152
2025-03-09 08:17:59,108 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0248 secs
2025-03-09 08:17:59,108 [INFO]: 	Compute estimated construction time of the index 03/09/2025, 08:17:59
2025-03-09 08:17:59,108 [INFO]: 		-> Train: 16.7 minutes
2025-03-09 08:17:59,108 [INFO]: 		-> Add: 1.7 seconds
2025-03-09 08:17:59,108 [INFO]: 		Total: 16.7 minutes
2025-03-09 08:17:59,108 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0001 secs
2025-03-09 08:17:59,108 [INFO]: 	Checking that your have enough memory available to create the index 03/09/2025, 08:17:59
2025-03-09 08:17:59,108 [INFO]: 623.9MB of memory will be needed to build the index (more might be used if you have more)
2025-03-09 08:17:59,108 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0002 secs
2025-03-09 08:17:59,108 [INFO]: 	Selecting most promising index types given data characteristics 03/09/2025, 08:17:59
2025-03-09 08:17:59,108 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-09 08:17:59,108 [INFO]: 	Creating the index 03/09/2025, 08:17:59
2025-03-09 08:17:59,108 [INFO]: 		-> Instanciate the index HNSW15 03/09/2025, 08:17:59
2025-03-09 08:17:59,110 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0012 secs
2025-03-09 08:17:59,110 [INFO]: 		-> Adding the vectors to the index 03/09/2025, 08:17:59
2025-03-09 08:17:59,110 [INFO]: The memory available for adding the vectors is 49.4GB(total available - used by the index)
2025-03-09 08:17:59,110 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/12 [00:00<?, ?it/s]  8%|▊         | 1/12 [00:00<00:01,  9.21it/s] 50%|█████     | 6/12 [00:00<00:00, 31.45it/s] 92%|█████████▏| 11/12 [00:00<00:00, 37.04it/s]100%|██████████| 12/12 [00:02<00:00,  4.57it/s]
2025-03-09 08:18:01,742 [INFO]: 	Computing best hyperparameters for index knn.index 03/09/2025, 08:18:01
2025-03-09 08:18:33,204 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 31.4610 secs
2025-03-09 08:18:33,204 [INFO]: The best hyperparameters are: efSearch=290
2025-03-09 08:18:33,204 [INFO]: 	Compute fast metrics 03/09/2025, 08:18:33
  0%|          | 0/4 [00:00<?, ?it/s] 50%|█████     | 2/4 [00:00<00:00, 17.36it/s] 75%|███████▌  | 3/4 [00:00<00:00, 19.51it/s]
2025-03-09 08:18:49,200 [INFO]: 	>>> Finished "Compute fast metrics" in 15.9954 secs
2025-03-09 08:18:49,216 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 50.1064 secs
2025-03-09 08:18:49,216 [INFO]: {
2025-03-09 08:18:49,216 [INFO]: 	index_key: HNSW15
2025-03-09 08:18:49,216 [INFO]: 	index_param: efSearch=290
2025-03-09 08:18:49,216 [INFO]: 	index_path: knn.index
2025-03-09 08:18:49,216 [INFO]: 	size in bytes: 594756430
2025-03-09 08:18:49,217 [INFO]: 	avg_search_speed_ms: 11.553182828833734
2025-03-09 08:18:49,217 [INFO]: 	99p_search_speed_ms: 26.332928042393178
2025-03-09 08:18:49,217 [INFO]: 	reconstruction error %: 0.0
2025-03-09 08:18:49,217 [INFO]: 	nb vectors: 3023
2025-03-09 08:18:49,217 [INFO]: 	vectors dimension: 49152
2025-03-09 08:18:49,217 [INFO]: 	compression ratio: 0.9993098922864945
2025-03-09 08:18:49,217 [INFO]: }
2025-03-09 08:18:49,217 [INFO]: 	>>> Finished "Creating the index" in 50.1082 secs
2025-03-09 08:18:49,217 [INFO]: >>> Finished "Launching the whole pipeline" in 50.1338 secs
2025-03-09 08:18:50: [retrieval_preprocessing] calculating distances ...
2025-03-09 08:18:50: [retrieval_preprocessing] finished and saved retrieval indices for episode 32775 [episode count 4/20]
[retrieval_preprocessing] for episode 84485 [episode count 5/20], we have num_retrieval=np.int64(3009) num_query=np.int64(172)
2025-03-09 08:18:51,135 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-09 08:18:51,549 [INFO]: Launching the whole pipeline 03/09/2025, 08:18:51
2025-03-09 08:18:51,550 [INFO]: Reading total number of vectors and dimension 03/09/2025, 08:18:51
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1377.44it/s]
2025-03-09 08:18:51,574 [INFO]: There are 3009 embeddings of dim 49152
2025-03-09 08:18:51,574 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0246 secs
2025-03-09 08:18:51,574 [INFO]: 	Compute estimated construction time of the index 03/09/2025, 08:18:51
2025-03-09 08:18:51,574 [INFO]: 		-> Train: 16.7 minutes
2025-03-09 08:18:51,574 [INFO]: 		-> Add: 1.7 seconds
2025-03-09 08:18:51,574 [INFO]: 		Total: 16.7 minutes
2025-03-09 08:18:51,574 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0002 secs
2025-03-09 08:18:51,575 [INFO]: 	Checking that your have enough memory available to create the index 03/09/2025, 08:18:51
2025-03-09 08:18:51,575 [INFO]: 621.0MB of memory will be needed to build the index (more might be used if you have more)
2025-03-09 08:18:51,575 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0004 secs
2025-03-09 08:18:51,575 [INFO]: 	Selecting most promising index types given data characteristics 03/09/2025, 08:18:51
2025-03-09 08:18:51,575 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-09 08:18:51,575 [INFO]: 	Creating the index 03/09/2025, 08:18:51
2025-03-09 08:18:51,575 [INFO]: 		-> Instanciate the index HNSW15 03/09/2025, 08:18:51
2025-03-09 08:18:51,578 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0020 secs
2025-03-09 08:18:51,578 [INFO]: 		-> Adding the vectors to the index 03/09/2025, 08:18:51
2025-03-09 08:18:51,578 [INFO]: The memory available for adding the vectors is 49.4GB(total available - used by the index)
2025-03-09 08:18:51,578 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/12 [00:00<?, ?it/s] 17%|█▋        | 2/12 [00:00<00:00, 18.83it/s] 58%|█████▊    | 7/12 [00:00<00:00, 36.52it/s]100%|██████████| 12/12 [00:02<00:00,  3.78it/s]100%|██████████| 12/12 [00:02<00:00,  4.62it/s]
2025-03-09 08:18:54,179 [INFO]: 	Computing best hyperparameters for index knn.index 03/09/2025, 08:18:54
2025-03-09 08:19:27,139 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 32.9595 secs
2025-03-09 08:19:27,139 [INFO]: The best hyperparameters are: efSearch=263
2025-03-09 08:19:27,139 [INFO]: 	Compute fast metrics 03/09/2025, 08:19:27
  0%|          | 0/4 [00:00<?, ?it/s] 75%|███████▌  | 3/4 [00:00<00:00, 25.73it/s] 75%|███████▌  | 3/4 [00:00<00:00, 21.78it/s]
2025-03-09 08:19:41,175 [INFO]: 	>>> Finished "Compute fast metrics" in 14.0357 secs
2025-03-09 08:19:41,177 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 49.5991 secs
2025-03-09 08:19:41,177 [INFO]: {
2025-03-09 08:19:41,177 [INFO]: 	index_key: HNSW15
2025-03-09 08:19:41,177 [INFO]: 	index_param: efSearch=263
2025-03-09 08:19:41,177 [INFO]: 	index_path: knn.index
2025-03-09 08:19:41,177 [INFO]: 	size in bytes: 592002070
2025-03-09 08:19:41,177 [INFO]: 	avg_search_speed_ms: 10.677601670967604
2025-03-09 08:19:41,177 [INFO]: 	99p_search_speed_ms: 21.514548808336254
2025-03-09 08:19:41,177 [INFO]: 	reconstruction error %: 0.0
2025-03-09 08:19:41,177 [INFO]: 	nb vectors: 3009
2025-03-09 08:19:41,177 [INFO]: 	vectors dimension: 49152
2025-03-09 08:19:41,177 [INFO]: 	compression ratio: 0.9993098030890332
2025-03-09 08:19:41,177 [INFO]: }
2025-03-09 08:19:41,177 [INFO]: 	>>> Finished "Creating the index" in 49.6018 secs
2025-03-09 08:19:41,177 [INFO]: >>> Finished "Launching the whole pipeline" in 49.6276 secs
2025-03-09 08:19:42: [retrieval_preprocessing] calculating distances ...
2025-03-09 08:19:42: [retrieval_preprocessing] finished and saved retrieval indices for episode 84485 [episode count 5/20]
[retrieval_preprocessing] for episode 83983 [episode count 6/20], we have num_retrieval=np.int64(3040) num_query=np.int64(141)
2025-03-09 08:19:42,824 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-09 08:19:43,183 [INFO]: Launching the whole pipeline 03/09/2025, 08:19:43
2025-03-09 08:19:43,183 [INFO]: Reading total number of vectors and dimension 03/09/2025, 08:19:43
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1880.85it/s]
2025-03-09 08:19:43,205 [INFO]: There are 3040 embeddings of dim 49152
2025-03-09 08:19:43,205 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0224 secs
2025-03-09 08:19:43,205 [INFO]: 	Compute estimated construction time of the index 03/09/2025, 08:19:43
2025-03-09 08:19:43,206 [INFO]: 		-> Train: 16.7 minutes
2025-03-09 08:19:43,206 [INFO]: 		-> Add: 1.7 seconds
2025-03-09 08:19:43,206 [INFO]: 		Total: 16.7 minutes
2025-03-09 08:19:43,206 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0001 secs
2025-03-09 08:19:43,206 [INFO]: 	Checking that your have enough memory available to create the index 03/09/2025, 08:19:43
2025-03-09 08:19:43,206 [INFO]: 627.4MB of memory will be needed to build the index (more might be used if you have more)
2025-03-09 08:19:43,206 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0001 secs
2025-03-09 08:19:43,206 [INFO]: 	Selecting most promising index types given data characteristics 03/09/2025, 08:19:43
2025-03-09 08:19:43,206 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-09 08:19:43,206 [INFO]: 	Creating the index 03/09/2025, 08:19:43
2025-03-09 08:19:43,206 [INFO]: 		-> Instanciate the index HNSW15 03/09/2025, 08:19:43
2025-03-09 08:19:43,207 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0009 secs
2025-03-09 08:19:43,207 [INFO]: 		-> Adding the vectors to the index 03/09/2025, 08:19:43
2025-03-09 08:19:43,207 [INFO]: The memory available for adding the vectors is 49.4GB(total available - used by the index)
2025-03-09 08:19:43,207 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/12 [00:00<?, ?it/s]  8%|▊         | 1/12 [00:00<00:01,  9.92it/s] 58%|█████▊    | 7/12 [00:00<00:00, 38.38it/s]100%|██████████| 12/12 [00:02<00:00,  4.78it/s]100%|██████████| 12/12 [00:02<00:00,  5.68it/s]
2025-03-09 08:19:45,323 [INFO]: 	Computing best hyperparameters for index knn.index 03/09/2025, 08:19:45
2025-03-09 08:20:18,210 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 32.8865 secs
2025-03-09 08:20:18,210 [INFO]: The best hyperparameters are: efSearch=265
2025-03-09 08:20:18,210 [INFO]: 	Compute fast metrics 03/09/2025, 08:20:18
  0%|          | 0/4 [00:00<?, ?it/s] 50%|█████     | 2/4 [00:00<00:00, 19.27it/s] 75%|███████▌  | 3/4 [00:00<00:00, 20.78it/s]
2025-03-09 08:20:37,478 [INFO]: 	>>> Finished "Compute fast metrics" in 19.2681 secs
2025-03-09 08:20:37,480 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 54.2728 secs
2025-03-09 08:20:37,480 [INFO]: {
2025-03-09 08:20:37,480 [INFO]: 	index_key: HNSW15
2025-03-09 08:20:37,480 [INFO]: 	index_param: efSearch=265
2025-03-09 08:20:37,480 [INFO]: 	index_path: knn.index
2025-03-09 08:20:37,480 [INFO]: 	size in bytes: 598101070
2025-03-09 08:20:37,480 [INFO]: 	avg_search_speed_ms: 10.165601511148934
2025-03-09 08:20:37,480 [INFO]: 	99p_search_speed_ms: 22.0963946939446
2025-03-09 08:20:37,480 [INFO]: 	reconstruction error %: 0.0
2025-03-09 08:20:37,480 [INFO]: 	nb vectors: 3040
2025-03-09 08:20:37,480 [INFO]: 	vectors dimension: 49152
2025-03-09 08:20:37,480 [INFO]: 	compression ratio: 0.9993098992449554
2025-03-09 08:20:37,480 [INFO]: }
2025-03-09 08:20:37,480 [INFO]: 	>>> Finished "Creating the index" in 54.2742 secs
2025-03-09 08:20:37,480 [INFO]: >>> Finished "Launching the whole pipeline" in 54.2973 secs
2025-03-09 08:20:38: [retrieval_preprocessing] calculating distances ...
2025-03-09 08:20:38: [retrieval_preprocessing] finished and saved retrieval indices for episode 83983 [episode count 6/20]
[retrieval_preprocessing] for episode 61980 [episode count 7/20], we have num_retrieval=np.int64(3033) num_query=np.int64(148)
2025-03-09 08:20:39,212 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-09 08:20:39,573 [INFO]: Launching the whole pipeline 03/09/2025, 08:20:39
2025-03-09 08:20:39,574 [INFO]: Reading total number of vectors and dimension 03/09/2025, 08:20:39
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 2629.66it/s]
2025-03-09 08:20:39,597 [INFO]: There are 3033 embeddings of dim 49152
2025-03-09 08:20:39,597 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0234 secs
2025-03-09 08:20:39,597 [INFO]: 	Compute estimated construction time of the index 03/09/2025, 08:20:39
2025-03-09 08:20:39,597 [INFO]: 		-> Train: 16.7 minutes
2025-03-09 08:20:39,597 [INFO]: 		-> Add: 1.7 seconds
2025-03-09 08:20:39,597 [INFO]: 		Total: 16.7 minutes
2025-03-09 08:20:39,597 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0001 secs
2025-03-09 08:20:39,597 [INFO]: 	Checking that your have enough memory available to create the index 03/09/2025, 08:20:39
2025-03-09 08:20:39,597 [INFO]: 625.9MB of memory will be needed to build the index (more might be used if you have more)
2025-03-09 08:20:39,597 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0001 secs
2025-03-09 08:20:39,597 [INFO]: 	Selecting most promising index types given data characteristics 03/09/2025, 08:20:39
2025-03-09 08:20:39,598 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-09 08:20:39,598 [INFO]: 	Creating the index 03/09/2025, 08:20:39
2025-03-09 08:20:39,598 [INFO]: 		-> Instanciate the index HNSW15 03/09/2025, 08:20:39
2025-03-09 08:20:39,599 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0010 secs
2025-03-09 08:20:39,599 [INFO]: 		-> Adding the vectors to the index 03/09/2025, 08:20:39
2025-03-09 08:20:39,599 [INFO]: The memory available for adding the vectors is 49.4GB(total available - used by the index)
2025-03-09 08:20:39,599 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/12 [00:00<?, ?it/s]  8%|▊         | 1/12 [00:00<00:01,  9.65it/s] 58%|█████▊    | 7/12 [00:00<00:00, 35.41it/s]100%|██████████| 12/12 [00:02<00:00,  4.43it/s]100%|██████████| 12/12 [00:02<00:00,  5.27it/s]
2025-03-09 08:20:41,878 [INFO]: 	Computing best hyperparameters for index knn.index 03/09/2025, 08:20:41
2025-03-09 08:21:09,847 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 27.9683 secs
2025-03-09 08:21:09,847 [INFO]: The best hyperparameters are: efSearch=238
2025-03-09 08:21:09,847 [INFO]: 	Compute fast metrics 03/09/2025, 08:21:09
  0%|          | 0/4 [00:00<?, ?it/s] 25%|██▌       | 1/4 [00:00<00:00,  6.99it/s] 75%|███████▌  | 3/4 [00:00<00:00, 12.21it/s]
2025-03-09 08:21:24,393 [INFO]: 	>>> Finished "Compute fast metrics" in 14.5459 secs
2025-03-09 08:21:24,395 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 44.7965 secs
2025-03-09 08:21:24,395 [INFO]: {
2025-03-09 08:21:24,395 [INFO]: 	index_key: HNSW15
2025-03-09 08:21:24,395 [INFO]: 	index_param: efSearch=238
2025-03-09 08:21:24,395 [INFO]: 	index_path: knn.index
2025-03-09 08:21:24,395 [INFO]: 	size in bytes: 596723890
2025-03-09 08:21:24,395 [INFO]: 	avg_search_speed_ms: 8.935527068388183
2025-03-09 08:21:24,395 [INFO]: 	99p_search_speed_ms: 12.585514108650385
2025-03-09 08:21:24,396 [INFO]: 	reconstruction error %: 0.0
2025-03-09 08:21:24,396 [INFO]: 	nb vectors: 3033
2025-03-09 08:21:24,396 [INFO]: 	vectors dimension: 49152
2025-03-09 08:21:24,396 [INFO]: 	compression ratio: 0.9993098550151897
2025-03-09 08:21:24,396 [INFO]: }
2025-03-09 08:21:24,396 [INFO]: 	>>> Finished "Creating the index" in 44.7980 secs
2025-03-09 08:21:24,396 [INFO]: >>> Finished "Launching the whole pipeline" in 44.8220 secs
2025-03-09 08:21:25: [retrieval_preprocessing] calculating distances ...
2025-03-09 08:21:26: [retrieval_preprocessing] finished and saved retrieval indices for episode 61980 [episode count 7/20]
[retrieval_preprocessing] for episode 22563 [episode count 8/20], we have num_retrieval=np.int64(3034) num_query=np.int64(147)
2025-03-09 08:21:26,281 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-09 08:21:26,668 [INFO]: Launching the whole pipeline 03/09/2025, 08:21:26
2025-03-09 08:21:26,668 [INFO]: Reading total number of vectors and dimension 03/09/2025, 08:21:26
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1612.57it/s]
2025-03-09 08:21:26,691 [INFO]: There are 3034 embeddings of dim 49152
2025-03-09 08:21:26,691 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0231 secs
2025-03-09 08:21:26,691 [INFO]: 	Compute estimated construction time of the index 03/09/2025, 08:21:26
2025-03-09 08:21:26,691 [INFO]: 		-> Train: 16.7 minutes
2025-03-09 08:21:26,691 [INFO]: 		-> Add: 1.7 seconds
2025-03-09 08:21:26,691 [INFO]: 		Total: 16.7 minutes
2025-03-09 08:21:26,691 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0001 secs
2025-03-09 08:21:26,691 [INFO]: 	Checking that your have enough memory available to create the index 03/09/2025, 08:21:26
2025-03-09 08:21:26,691 [INFO]: 626.1MB of memory will be needed to build the index (more might be used if you have more)
2025-03-09 08:21:26,691 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0001 secs
2025-03-09 08:21:26,691 [INFO]: 	Selecting most promising index types given data characteristics 03/09/2025, 08:21:26
2025-03-09 08:21:26,691 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-09 08:21:26,691 [INFO]: 	Creating the index 03/09/2025, 08:21:26
2025-03-09 08:21:26,691 [INFO]: 		-> Instanciate the index HNSW15 03/09/2025, 08:21:26
2025-03-09 08:21:26,692 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0009 secs
2025-03-09 08:21:26,692 [INFO]: 		-> Adding the vectors to the index 03/09/2025, 08:21:26
2025-03-09 08:21:26,693 [INFO]: The memory available for adding the vectors is 49.4GB(total available - used by the index)
2025-03-09 08:21:26,693 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/12 [00:00<?, ?it/s]  8%|▊         | 1/12 [00:00<00:01,  7.83it/s] 58%|█████▊    | 7/12 [00:00<00:00, 32.31it/s]100%|██████████| 12/12 [00:02<00:00,  3.66it/s]100%|██████████| 12/12 [00:02<00:00,  4.37it/s]
2025-03-09 08:21:29,446 [INFO]: 	Computing best hyperparameters for index knn.index 03/09/2025, 08:21:29
2025-03-09 08:21:58,222 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 28.7757 secs
2025-03-09 08:21:58,222 [INFO]: The best hyperparameters are: efSearch=158
2025-03-09 08:21:58,222 [INFO]: 	Compute fast metrics 03/09/2025, 08:21:58
  0%|          | 0/4 [00:00<?, ?it/s] 50%|█████     | 2/4 [00:00<00:00, 17.08it/s] 75%|███████▌  | 3/4 [00:00<00:00, 18.19it/s]
2025-03-09 08:22:14,153 [INFO]: 	>>> Finished "Compute fast metrics" in 15.9310 secs
2025-03-09 08:22:14,155 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 47.4626 secs
2025-03-09 08:22:14,155 [INFO]: {
2025-03-09 08:22:14,155 [INFO]: 	index_key: HNSW15
2025-03-09 08:22:14,155 [INFO]: 	index_param: efSearch=158
2025-03-09 08:22:14,155 [INFO]: 	index_path: knn.index
2025-03-09 08:22:14,155 [INFO]: 	size in bytes: 596920630
2025-03-09 08:22:14,155 [INFO]: 	avg_search_speed_ms: 7.226603970704116
2025-03-09 08:22:14,155 [INFO]: 	99p_search_speed_ms: 14.601130846422167
2025-03-09 08:22:14,155 [INFO]: 	reconstruction error %: 0.0
2025-03-09 08:22:14,155 [INFO]: 	nb vectors: 3034
2025-03-09 08:22:14,155 [INFO]: 	vectors dimension: 49152
2025-03-09 08:22:14,155 [INFO]: 	compression ratio: 0.9993098613462229
2025-03-09 08:22:14,155 [INFO]: }
2025-03-09 08:22:14,155 [INFO]: 	>>> Finished "Creating the index" in 47.4639 secs
2025-03-09 08:22:14,155 [INFO]: >>> Finished "Launching the whole pipeline" in 47.4875 secs
2025-03-09 08:22:14: [retrieval_preprocessing] calculating distances ...
2025-03-09 08:22:14: [retrieval_preprocessing] finished and saved retrieval indices for episode 22563 [episode count 8/20]
[retrieval_preprocessing] for episode 88612 [episode count 9/20], we have num_retrieval=np.int64(3065) num_query=np.int64(116)
2025-03-09 08:22:15,078 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-09 08:22:15,448 [INFO]: Launching the whole pipeline 03/09/2025, 08:22:15
2025-03-09 08:22:15,448 [INFO]: Reading total number of vectors and dimension 03/09/2025, 08:22:15
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1550.00it/s]
2025-03-09 08:22:15,471 [INFO]: There are 3065 embeddings of dim 49152
2025-03-09 08:22:15,472 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0237 secs
2025-03-09 08:22:15,472 [INFO]: 	Compute estimated construction time of the index 03/09/2025, 08:22:15
2025-03-09 08:22:15,472 [INFO]: 		-> Train: 16.7 minutes
2025-03-09 08:22:15,472 [INFO]: 		-> Add: 1.7 seconds
2025-03-09 08:22:15,472 [INFO]: 		Total: 16.7 minutes
2025-03-09 08:22:15,472 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0001 secs
2025-03-09 08:22:15,472 [INFO]: 	Checking that your have enough memory available to create the index 03/09/2025, 08:22:15
2025-03-09 08:22:15,472 [INFO]: 632.5MB of memory will be needed to build the index (more might be used if you have more)
2025-03-09 08:22:15,472 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0001 secs
2025-03-09 08:22:15,472 [INFO]: 	Selecting most promising index types given data characteristics 03/09/2025, 08:22:15
2025-03-09 08:22:15,472 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-09 08:22:15,472 [INFO]: 	Creating the index 03/09/2025, 08:22:15
2025-03-09 08:22:15,472 [INFO]: 		-> Instanciate the index HNSW15 03/09/2025, 08:22:15
2025-03-09 08:22:15,473 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0009 secs
2025-03-09 08:22:15,473 [INFO]: 		-> Adding the vectors to the index 03/09/2025, 08:22:15
2025-03-09 08:22:15,473 [INFO]: The memory available for adding the vectors is 49.4GB(total available - used by the index)
2025-03-09 08:22:15,473 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/13 [00:00<?, ?it/s] 15%|█▌        | 2/13 [00:00<00:00, 17.17it/s] 62%|██████▏   | 8/13 [00:00<00:00, 38.64it/s]100%|██████████| 13/13 [00:02<00:00,  4.86it/s]100%|██████████| 13/13 [00:02<00:00,  5.94it/s]
2025-03-09 08:22:17,666 [INFO]: 	Computing best hyperparameters for index knn.index 03/09/2025, 08:22:17
2025-03-09 08:22:49,922 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 32.2558 secs
2025-03-09 08:22:49,922 [INFO]: The best hyperparameters are: efSearch=247
2025-03-09 08:22:49,922 [INFO]: 	Compute fast metrics 03/09/2025, 08:22:49
  0%|          | 0/4 [00:00<?, ?it/s] 50%|█████     | 2/4 [00:00<00:00, 14.37it/s] 75%|███████▌  | 3/4 [00:00<00:00, 12.93it/s]
2025-03-09 08:23:07,939 [INFO]: 	>>> Finished "Compute fast metrics" in 18.0171 secs
2025-03-09 08:23:07,941 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 52.4678 secs
2025-03-09 08:23:07,941 [INFO]: {
2025-03-09 08:23:07,941 [INFO]: 	index_key: HNSW15
2025-03-09 08:23:07,941 [INFO]: 	index_param: efSearch=247
2025-03-09 08:23:07,942 [INFO]: 	index_path: knn.index
2025-03-09 08:23:07,942 [INFO]: 	size in bytes: 603019750
2025-03-09 08:23:07,942 [INFO]: 	avg_search_speed_ms: 12.261326542048824
2025-03-09 08:23:07,942 [INFO]: 	99p_search_speed_ms: 25.074047211091965
2025-03-09 08:23:07,942 [INFO]: 	reconstruction error %: 0.0
2025-03-09 08:23:07,942 [INFO]: 	nb vectors: 3065
2025-03-09 08:23:07,942 [INFO]: 	vectors dimension: 49152
2025-03-09 08:23:07,942 [INFO]: 	compression ratio: 0.9993097572674858
2025-03-09 08:23:07,942 [INFO]: }
2025-03-09 08:23:07,942 [INFO]: 	>>> Finished "Creating the index" in 52.4696 secs
2025-03-09 08:23:07,942 [INFO]: >>> Finished "Launching the whole pipeline" in 52.4939 secs
2025-03-09 08:23:08: [retrieval_preprocessing] calculating distances ...
2025-03-09 08:23:09: [retrieval_preprocessing] finished and saved retrieval indices for episode 88612 [episode count 9/20]
[retrieval_preprocessing] for episode 6182 [episode count 10/20], we have num_retrieval=np.int64(3028) num_query=np.int64(153)
2025-03-09 08:23:09,711 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-09 08:23:10,088 [INFO]: Launching the whole pipeline 03/09/2025, 08:23:10
2025-03-09 08:23:10,088 [INFO]: Reading total number of vectors and dimension 03/09/2025, 08:23:10
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1700.16it/s]
2025-03-09 08:23:10,114 [INFO]: There are 3028 embeddings of dim 49152
2025-03-09 08:23:10,114 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0257 secs
2025-03-09 08:23:10,114 [INFO]: 	Compute estimated construction time of the index 03/09/2025, 08:23:10
2025-03-09 08:23:10,114 [INFO]: 		-> Train: 16.7 minutes
2025-03-09 08:23:10,114 [INFO]: 		-> Add: 1.7 seconds
2025-03-09 08:23:10,114 [INFO]: 		Total: 16.7 minutes
2025-03-09 08:23:10,114 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0001 secs
2025-03-09 08:23:10,114 [INFO]: 	Checking that your have enough memory available to create the index 03/09/2025, 08:23:10
2025-03-09 08:23:10,114 [INFO]: 624.9MB of memory will be needed to build the index (more might be used if you have more)
2025-03-09 08:23:10,114 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0001 secs
2025-03-09 08:23:10,114 [INFO]: 	Selecting most promising index types given data characteristics 03/09/2025, 08:23:10
2025-03-09 08:23:10,114 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-09 08:23:10,114 [INFO]: 	Creating the index 03/09/2025, 08:23:10
2025-03-09 08:23:10,114 [INFO]: 		-> Instanciate the index HNSW15 03/09/2025, 08:23:10
2025-03-09 08:23:10,115 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0010 secs
2025-03-09 08:23:10,116 [INFO]: 		-> Adding the vectors to the index 03/09/2025, 08:23:10
2025-03-09 08:23:10,116 [INFO]: The memory available for adding the vectors is 49.4GB(total available - used by the index)
2025-03-09 08:23:10,116 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/12 [00:00<?, ?it/s]  8%|▊         | 1/12 [00:00<00:01,  9.80it/s] 50%|█████     | 6/12 [00:00<00:00, 32.23it/s] 83%|████████▎ | 10/12 [00:00<00:00, 29.89it/s]100%|██████████| 12/12 [00:02<00:00,  4.17it/s]
2025-03-09 08:23:12,998 [INFO]: 	Computing best hyperparameters for index knn.index 03/09/2025, 08:23:12
2025-03-09 08:23:48,597 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 35.5990 secs
2025-03-09 08:23:48,597 [INFO]: The best hyperparameters are: efSearch=254
2025-03-09 08:23:48,597 [INFO]: 	Compute fast metrics 03/09/2025, 08:23:48
  0%|          | 0/4 [00:00<?, ?it/s] 75%|███████▌  | 3/4 [00:00<00:00, 25.22it/s] 75%|███████▌  | 3/4 [00:00<00:00, 21.32it/s]
2025-03-09 08:24:05,890 [INFO]: 	>>> Finished "Compute fast metrics" in 17.2924 secs
2025-03-09 08:24:05,892 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 55.7761 secs
2025-03-09 08:24:05,892 [INFO]: {
2025-03-09 08:24:05,892 [INFO]: 	index_key: HNSW15
2025-03-09 08:24:05,892 [INFO]: 	index_param: efSearch=254
2025-03-09 08:24:05,892 [INFO]: 	index_path: knn.index
2025-03-09 08:24:05,892 [INFO]: 	size in bytes: 595740130
2025-03-09 08:24:05,892 [INFO]: 	avg_search_speed_ms: 10.770763216672547
2025-03-09 08:24:05,892 [INFO]: 	99p_search_speed_ms: 29.55562338232995
2025-03-09 08:24:05,892 [INFO]: 	reconstruction error %: 0.0
2025-03-09 08:24:05,892 [INFO]: 	nb vectors: 3028
2025-03-09 08:24:05,892 [INFO]: 	vectors dimension: 49152
2025-03-09 08:24:05,892 [INFO]: 	compression ratio: 0.999309923942844
2025-03-09 08:24:05,892 [INFO]: }
2025-03-09 08:24:05,892 [INFO]: 	>>> Finished "Creating the index" in 55.7777 secs
2025-03-09 08:24:05,892 [INFO]: >>> Finished "Launching the whole pipeline" in 55.8040 secs
2025-03-09 08:24:07: [retrieval_preprocessing] calculating distances ...
2025-03-09 08:24:07: [retrieval_preprocessing] finished and saved retrieval indices for episode 6182 [episode count 10/20]
[retrieval_preprocessing] for episode 93734 [episode count 11/20], we have num_retrieval=np.int64(3048) num_query=np.int64(133)
2025-03-09 08:24:07,917 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-09 08:24:08,352 [INFO]: Launching the whole pipeline 03/09/2025, 08:24:08
2025-03-09 08:24:08,352 [INFO]: Reading total number of vectors and dimension 03/09/2025, 08:24:08
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1741.10it/s]
2025-03-09 08:24:08,378 [INFO]: There are 3048 embeddings of dim 49152
2025-03-09 08:24:08,378 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0262 secs
2025-03-09 08:24:08,378 [INFO]: 	Compute estimated construction time of the index 03/09/2025, 08:24:08
2025-03-09 08:24:08,378 [INFO]: 		-> Train: 16.7 minutes
2025-03-09 08:24:08,378 [INFO]: 		-> Add: 1.7 seconds
2025-03-09 08:24:08,378 [INFO]: 		Total: 16.7 minutes
2025-03-09 08:24:08,378 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0001 secs
2025-03-09 08:24:08,378 [INFO]: 	Checking that your have enough memory available to create the index 03/09/2025, 08:24:08
2025-03-09 08:24:08,379 [INFO]: 629.0MB of memory will be needed to build the index (more might be used if you have more)
2025-03-09 08:24:08,379 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0002 secs
2025-03-09 08:24:08,379 [INFO]: 	Selecting most promising index types given data characteristics 03/09/2025, 08:24:08
2025-03-09 08:24:08,379 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-09 08:24:08,379 [INFO]: 	Creating the index 03/09/2025, 08:24:08
2025-03-09 08:24:08,379 [INFO]: 		-> Instanciate the index HNSW15 03/09/2025, 08:24:08
2025-03-09 08:24:08,380 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0011 secs
2025-03-09 08:24:08,380 [INFO]: 		-> Adding the vectors to the index 03/09/2025, 08:24:08
2025-03-09 08:24:08,380 [INFO]: The memory available for adding the vectors is 49.4GB(total available - used by the index)
2025-03-09 08:24:08,380 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/12 [00:00<?, ?it/s] 17%|█▋        | 2/12 [00:00<00:00, 16.93it/s] 67%|██████▋   | 8/12 [00:00<00:00, 38.80it/s]100%|██████████| 12/12 [00:02<00:00,  4.11it/s]100%|██████████| 12/12 [00:02<00:00,  5.15it/s]
2025-03-09 08:24:10,711 [INFO]: 	Computing best hyperparameters for index knn.index 03/09/2025, 08:24:10
2025-03-09 08:24:42,347 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 31.6352 secs
2025-03-09 08:24:42,347 [INFO]: The best hyperparameters are: efSearch=177
2025-03-09 08:24:42,347 [INFO]: 	Compute fast metrics 03/09/2025, 08:24:42
  0%|          | 0/4 [00:00<?, ?it/s] 25%|██▌       | 1/4 [00:00<00:00,  9.67it/s] 75%|███████▌  | 3/4 [00:00<00:00, 17.95it/s]
2025-03-09 08:24:59,022 [INFO]: 	>>> Finished "Compute fast metrics" in 16.6748 secs
2025-03-09 08:24:59,024 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 50.6433 secs
2025-03-09 08:24:59,024 [INFO]: {
2025-03-09 08:24:59,024 [INFO]: 	index_key: HNSW15
2025-03-09 08:24:59,024 [INFO]: 	index_param: efSearch=177
2025-03-09 08:24:59,024 [INFO]: 	index_path: knn.index
2025-03-09 08:24:59,024 [INFO]: 	size in bytes: 599674990
2025-03-09 08:24:59,024 [INFO]: 	avg_search_speed_ms: 8.21308264060004
2025-03-09 08:24:59,024 [INFO]: 	99p_search_speed_ms: 12.703534539323297
2025-03-09 08:24:59,024 [INFO]: 	reconstruction error %: 0.0
2025-03-09 08:24:59,024 [INFO]: 	nb vectors: 3048
2025-03-09 08:24:59,024 [INFO]: 	vectors dimension: 49152
2025-03-09 08:24:59,024 [INFO]: 	compression ratio: 0.9993099495445025
2025-03-09 08:24:59,024 [INFO]: }
2025-03-09 08:24:59,024 [INFO]: 	>>> Finished "Creating the index" in 50.6449 secs
2025-03-09 08:24:59,024 [INFO]: >>> Finished "Launching the whole pipeline" in 50.6719 secs
2025-03-09 08:24:59: [retrieval_preprocessing] calculating distances ...
2025-03-09 08:25:00: [retrieval_preprocessing] finished and saved retrieval indices for episode 93734 [episode count 11/20]
[retrieval_preprocessing] for episode 84009 [episode count 12/20], we have num_retrieval=np.int64(3003) num_query=np.int64(178)
2025-03-09 08:25:00,441 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-09 08:25:00,832 [INFO]: Launching the whole pipeline 03/09/2025, 08:25:00
2025-03-09 08:25:00,832 [INFO]: Reading total number of vectors and dimension 03/09/2025, 08:25:00
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1665.07it/s]
2025-03-09 08:25:00,857 [INFO]: There are 3003 embeddings of dim 49152
2025-03-09 08:25:00,857 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0247 secs
2025-03-09 08:25:00,857 [INFO]: 	Compute estimated construction time of the index 03/09/2025, 08:25:00
2025-03-09 08:25:00,857 [INFO]: 		-> Train: 16.7 minutes
2025-03-09 08:25:00,857 [INFO]: 		-> Add: 1.6 seconds
2025-03-09 08:25:00,857 [INFO]: 		Total: 16.7 minutes
2025-03-09 08:25:00,857 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0001 secs
2025-03-09 08:25:00,857 [INFO]: 	Checking that your have enough memory available to create the index 03/09/2025, 08:25:00
2025-03-09 08:25:00,857 [INFO]: 619.7MB of memory will be needed to build the index (more might be used if you have more)
2025-03-09 08:25:00,857 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0001 secs
2025-03-09 08:25:00,857 [INFO]: 	Selecting most promising index types given data characteristics 03/09/2025, 08:25:00
2025-03-09 08:25:00,857 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-09 08:25:00,857 [INFO]: 	Creating the index 03/09/2025, 08:25:00
2025-03-09 08:25:00,857 [INFO]: 		-> Instanciate the index HNSW15 03/09/2025, 08:25:00
2025-03-09 08:25:00,858 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0009 secs
2025-03-09 08:25:00,858 [INFO]: 		-> Adding the vectors to the index 03/09/2025, 08:25:00
2025-03-09 08:25:00,858 [INFO]: The memory available for adding the vectors is 49.4GB(total available - used by the index)
2025-03-09 08:25:00,858 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/12 [00:00<?, ?it/s]  8%|▊         | 1/12 [00:00<00:01,  8.05it/s] 50%|█████     | 6/12 [00:00<00:00, 29.49it/s] 92%|█████████▏| 11/12 [00:00<00:00, 34.74it/s]100%|██████████| 12/12 [00:02<00:00,  4.86it/s]
2025-03-09 08:25:03,329 [INFO]: 	Computing best hyperparameters for index knn.index 03/09/2025, 08:25:03
2025-03-09 08:25:33,275 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 29.9453 secs
2025-03-09 08:25:33,275 [INFO]: The best hyperparameters are: efSearch=254
2025-03-09 08:25:33,275 [INFO]: 	Compute fast metrics 03/09/2025, 08:25:33
  0%|          | 0/4 [00:00<?, ?it/s] 50%|█████     | 2/4 [00:00<00:00, 16.94it/s] 75%|███████▌  | 3/4 [00:00<00:00, 15.28it/s]
2025-03-09 08:25:48,285 [INFO]: 	>>> Finished "Compute fast metrics" in 15.0091 secs
2025-03-09 08:25:48,286 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 47.4281 secs
2025-03-09 08:25:48,287 [INFO]: {
2025-03-09 08:25:48,287 [INFO]: 	index_key: HNSW15
2025-03-09 08:25:48,287 [INFO]: 	index_param: efSearch=254
2025-03-09 08:25:48,287 [INFO]: 	index_path: knn.index
2025-03-09 08:25:48,287 [INFO]: 	size in bytes: 590821630
2025-03-09 08:25:48,287 [INFO]: 	avg_search_speed_ms: 10.906310727913237
2025-03-09 08:25:48,287 [INFO]: 	99p_search_speed_ms: 21.766204787418246
2025-03-09 08:25:48,287 [INFO]: 	reconstruction error %: 0.0
2025-03-09 08:25:48,287 [INFO]: 	nb vectors: 3003
2025-03-09 08:25:48,287 [INFO]: 	vectors dimension: 49152
2025-03-09 08:25:48,287 [INFO]: 	compression ratio: 0.9993097646069593
2025-03-09 08:25:48,287 [INFO]: }
2025-03-09 08:25:48,287 [INFO]: 	>>> Finished "Creating the index" in 47.4298 secs
2025-03-09 08:25:48,287 [INFO]: >>> Finished "Launching the whole pipeline" in 47.4551 secs
2025-03-09 08:25:49: [retrieval_preprocessing] calculating distances ...
2025-03-09 08:25:49: [retrieval_preprocessing] finished and saved retrieval indices for episode 84009 [episode count 12/20]
[retrieval_preprocessing] for episode 59946 [episode count 13/20], we have num_retrieval=np.int64(3025) num_query=np.int64(156)
2025-03-09 08:25:49,985 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-09 08:25:50,403 [INFO]: Launching the whole pipeline 03/09/2025, 08:25:50
2025-03-09 08:25:50,403 [INFO]: Reading total number of vectors and dimension 03/09/2025, 08:25:50
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 2508.56it/s]
2025-03-09 08:25:50,424 [INFO]: There are 3025 embeddings of dim 49152
2025-03-09 08:25:50,425 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0214 secs
2025-03-09 08:25:50,425 [INFO]: 	Compute estimated construction time of the index 03/09/2025, 08:25:50
2025-03-09 08:25:50,425 [INFO]: 		-> Train: 16.7 minutes
2025-03-09 08:25:50,425 [INFO]: 		-> Add: 1.7 seconds
2025-03-09 08:25:50,425 [INFO]: 		Total: 16.7 minutes
2025-03-09 08:25:50,425 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0001 secs
2025-03-09 08:25:50,425 [INFO]: 	Checking that your have enough memory available to create the index 03/09/2025, 08:25:50
2025-03-09 08:25:50,425 [INFO]: 624.3MB of memory will be needed to build the index (more might be used if you have more)
2025-03-09 08:25:50,425 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0001 secs
2025-03-09 08:25:50,425 [INFO]: 	Selecting most promising index types given data characteristics 03/09/2025, 08:25:50
2025-03-09 08:25:50,425 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-09 08:25:50,425 [INFO]: 	Creating the index 03/09/2025, 08:25:50
2025-03-09 08:25:50,425 [INFO]: 		-> Instanciate the index HNSW15 03/09/2025, 08:25:50
2025-03-09 08:25:50,426 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0009 secs
2025-03-09 08:25:50,426 [INFO]: 		-> Adding the vectors to the index 03/09/2025, 08:25:50
2025-03-09 08:25:50,426 [INFO]: The memory available for adding the vectors is 49.4GB(total available - used by the index)
2025-03-09 08:25:50,426 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/12 [00:00<?, ?it/s] 17%|█▋        | 2/12 [00:00<00:00, 17.28it/s] 58%|█████▊    | 7/12 [00:00<00:00, 34.62it/s]100%|██████████| 12/12 [00:02<00:00,  4.21it/s]100%|██████████| 12/12 [00:02<00:00,  5.12it/s]
2025-03-09 08:25:52,772 [INFO]: 	Computing best hyperparameters for index knn.index 03/09/2025, 08:25:52
2025-03-09 08:26:25,402 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 32.6301 secs
2025-03-09 08:26:25,403 [INFO]: The best hyperparameters are: efSearch=307
2025-03-09 08:26:25,403 [INFO]: 	Compute fast metrics 03/09/2025, 08:26:25
  0%|          | 0/4 [00:00<?, ?it/s] 75%|███████▌  | 3/4 [00:00<00:00, 25.67it/s] 75%|███████▌  | 3/4 [00:00<00:00, 21.90it/s]
2025-03-09 08:26:43,044 [INFO]: 	>>> Finished "Compute fast metrics" in 17.6412 secs
2025-03-09 08:26:43,046 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 52.6200 secs
2025-03-09 08:26:43,046 [INFO]: {
2025-03-09 08:26:43,046 [INFO]: 	index_key: HNSW15
2025-03-09 08:26:43,046 [INFO]: 	index_param: efSearch=307
2025-03-09 08:26:43,046 [INFO]: 	index_path: knn.index
2025-03-09 08:26:43,046 [INFO]: 	size in bytes: 595149910
2025-03-09 08:26:43,046 [INFO]: 	avg_search_speed_ms: 12.853611868765483
2025-03-09 08:26:43,046 [INFO]: 	99p_search_speed_ms: 25.363655551336723
2025-03-09 08:26:43,046 [INFO]: 	reconstruction error %: 0.0
2025-03-09 08:26:43,047 [INFO]: 	nb vectors: 3025
2025-03-09 08:26:43,047 [INFO]: 	vectors dimension: 49152
2025-03-09 08:26:43,047 [INFO]: 	compression ratio: 0.999309904961592
2025-03-09 08:26:43,047 [INFO]: }
2025-03-09 08:26:43,047 [INFO]: 	>>> Finished "Creating the index" in 52.6215 secs
2025-03-09 08:26:43,047 [INFO]: >>> Finished "Launching the whole pipeline" in 52.6433 secs
2025-03-09 08:26:44: [retrieval_preprocessing] calculating distances ...
2025-03-09 08:26:44: [retrieval_preprocessing] finished and saved retrieval indices for episode 59946 [episode count 13/20]
[retrieval_preprocessing] for episode 10795 [episode count 14/20], we have num_retrieval=np.int64(3005) num_query=np.int64(176)
2025-03-09 08:26:45,270 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-09 08:26:45,673 [INFO]: Launching the whole pipeline 03/09/2025, 08:26:45
2025-03-09 08:26:45,673 [INFO]: Reading total number of vectors and dimension 03/09/2025, 08:26:45
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 948.51it/s]
2025-03-09 08:26:45,702 [INFO]: There are 3005 embeddings of dim 49152
2025-03-09 08:26:45,703 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0301 secs
2025-03-09 08:26:45,703 [INFO]: 	Compute estimated construction time of the index 03/09/2025, 08:26:45
2025-03-09 08:26:45,703 [INFO]: 		-> Train: 16.7 minutes
2025-03-09 08:26:45,703 [INFO]: 		-> Add: 1.7 seconds
2025-03-09 08:26:45,703 [INFO]: 		Total: 16.7 minutes
2025-03-09 08:26:45,703 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0003 secs
2025-03-09 08:26:45,703 [INFO]: 	Checking that your have enough memory available to create the index 03/09/2025, 08:26:45
2025-03-09 08:26:45,704 [INFO]: 620.2MB of memory will be needed to build the index (more might be used if you have more)
2025-03-09 08:26:45,704 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0003 secs
2025-03-09 08:26:45,704 [INFO]: 	Selecting most promising index types given data characteristics 03/09/2025, 08:26:45
2025-03-09 08:26:45,704 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-09 08:26:45,704 [INFO]: 	Creating the index 03/09/2025, 08:26:45
2025-03-09 08:26:45,704 [INFO]: 		-> Instanciate the index HNSW15 03/09/2025, 08:26:45
2025-03-09 08:26:45,707 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0028 secs
2025-03-09 08:26:45,707 [INFO]: 		-> Adding the vectors to the index 03/09/2025, 08:26:45
2025-03-09 08:26:45,708 [INFO]: The memory available for adding the vectors is 49.4GB(total available - used by the index)
2025-03-09 08:26:45,708 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/12 [00:00<?, ?it/s]  8%|▊         | 1/12 [00:00<00:01,  9.11it/s] 58%|█████▊    | 7/12 [00:00<00:00, 35.30it/s]100%|██████████| 12/12 [00:02<00:00,  3.95it/s]100%|██████████| 12/12 [00:02<00:00,  4.71it/s]
2025-03-09 08:26:48,261 [INFO]: 	Computing best hyperparameters for index knn.index 03/09/2025, 08:26:48
2025-03-09 08:27:25,549 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 37.2878 secs
2025-03-09 08:27:25,550 [INFO]: The best hyperparameters are: efSearch=247
2025-03-09 08:27:25,550 [INFO]: 	Compute fast metrics 03/09/2025, 08:27:25
  0%|          | 0/4 [00:00<?, ?it/s] 50%|█████     | 2/4 [00:00<00:00, 18.18it/s] 75%|███████▌  | 3/4 [00:00<00:00, 19.62it/s]
2025-03-09 08:27:43,314 [INFO]: 	>>> Finished "Compute fast metrics" in 17.7644 secs
2025-03-09 08:27:43,316 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 57.6090 secs
2025-03-09 08:27:43,317 [INFO]: {
2025-03-09 08:27:43,317 [INFO]: 	index_key: HNSW15
2025-03-09 08:27:43,317 [INFO]: 	index_param: efSearch=247
2025-03-09 08:27:43,317 [INFO]: 	index_path: knn.index
2025-03-09 08:27:43,317 [INFO]: 	size in bytes: 591215110
2025-03-09 08:27:43,317 [INFO]: 	avg_search_speed_ms: 10.95293782807495
2025-03-09 08:27:43,317 [INFO]: 	99p_search_speed_ms: 23.54162823408842
2025-03-09 08:27:43,317 [INFO]: 	reconstruction error %: 0.0
2025-03-09 08:27:43,317 [INFO]: 	nb vectors: 3005
2025-03-09 08:27:43,317 [INFO]: 	vectors dimension: 49152
2025-03-09 08:27:43,317 [INFO]: 	compression ratio: 0.9993097774513916
2025-03-09 08:27:43,317 [INFO]: }
2025-03-09 08:27:43,317 [INFO]: 	>>> Finished "Creating the index" in 57.6127 secs
2025-03-09 08:27:43,317 [INFO]: >>> Finished "Launching the whole pipeline" in 57.6442 secs
2025-03-09 08:27:44: [retrieval_preprocessing] calculating distances ...
2025-03-09 08:27:45: [retrieval_preprocessing] finished and saved retrieval indices for episode 10795 [episode count 14/20]
[retrieval_preprocessing] for episode 79404 [episode count 15/20], we have num_retrieval=np.int64(3101) num_query=np.int64(80)
2025-03-09 08:27:46,634 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-09 08:27:47,322 [INFO]: Launching the whole pipeline 03/09/2025, 08:27:47
2025-03-09 08:27:47,323 [INFO]: Reading total number of vectors and dimension 03/09/2025, 08:27:47
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1010.92it/s]
2025-03-09 08:27:47,362 [INFO]: There are 3101 embeddings of dim 49152
2025-03-09 08:27:47,362 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0396 secs
2025-03-09 08:27:47,362 [INFO]: 	Compute estimated construction time of the index 03/09/2025, 08:27:47
2025-03-09 08:27:47,363 [INFO]: 		-> Train: 16.7 minutes
2025-03-09 08:27:47,363 [INFO]: 		-> Add: 1.7 seconds
2025-03-09 08:27:47,363 [INFO]: 		Total: 16.7 minutes
2025-03-09 08:27:47,363 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0005 secs
2025-03-09 08:27:47,363 [INFO]: 	Checking that your have enough memory available to create the index 03/09/2025, 08:27:47
2025-03-09 08:27:47,364 [INFO]: 640.0MB of memory will be needed to build the index (more might be used if you have more)
2025-03-09 08:27:47,364 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0007 secs
2025-03-09 08:27:47,364 [INFO]: 	Selecting most promising index types given data characteristics 03/09/2025, 08:27:47
2025-03-09 08:27:47,364 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-09 08:27:47,364 [INFO]: 	Creating the index 03/09/2025, 08:27:47
2025-03-09 08:27:47,365 [INFO]: 		-> Instanciate the index HNSW15 03/09/2025, 08:27:47
2025-03-09 08:27:47,368 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0028 secs
2025-03-09 08:27:47,368 [INFO]: 		-> Adding the vectors to the index 03/09/2025, 08:27:47
2025-03-09 08:27:47,368 [INFO]: The memory available for adding the vectors is 49.4GB(total available - used by the index)
2025-03-09 08:27:47,368 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/13 [00:00<?, ?it/s]  8%|▊         | 1/13 [00:00<00:02,  4.86it/s] 15%|█▌        | 2/13 [00:00<00:01,  6.25it/s] 23%|██▎       | 3/13 [00:00<00:01,  6.90it/s] 31%|███       | 4/13 [00:00<00:01,  7.29it/s] 38%|███▊      | 5/13 [00:00<00:01,  7.42it/s] 46%|████▌     | 6/13 [00:00<00:00,  7.68it/s] 54%|█████▍    | 7/13 [00:00<00:00,  7.94it/s] 62%|██████▏   | 8/13 [00:01<00:00,  8.01it/s] 85%|████████▍ | 11/13 [00:01<00:00, 13.13it/s]100%|██████████| 13/13 [00:03<00:00,  2.01it/s]100%|██████████| 13/13 [00:03<00:00,  3.48it/s]
2025-03-09 08:27:51,109 [INFO]: 	Computing best hyperparameters for index knn.index 03/09/2025, 08:27:51
2025-03-09 08:28:28,942 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 37.8332 secs
2025-03-09 08:28:28,943 [INFO]: The best hyperparameters are: efSearch=252
2025-03-09 08:28:28,943 [INFO]: 	Compute fast metrics 03/09/2025, 08:28:28
  0%|          | 0/4 [00:00<?, ?it/s] 50%|█████     | 2/4 [00:00<00:00, 17.33it/s] 75%|███████▌  | 3/4 [00:00<00:00, 17.13it/s]
2025-03-09 08:28:45,888 [INFO]: 	>>> Finished "Compute fast metrics" in 16.9448 secs
2025-03-09 08:28:45,891 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 58.5232 secs
2025-03-09 08:28:45,891 [INFO]: {
2025-03-09 08:28:45,892 [INFO]: 	index_key: HNSW15
2025-03-09 08:28:45,892 [INFO]: 	index_param: efSearch=252
2025-03-09 08:28:45,892 [INFO]: 	index_path: knn.index
2025-03-09 08:28:45,892 [INFO]: 	size in bytes: 610102510
2025-03-09 08:28:45,892 [INFO]: 	avg_search_speed_ms: 10.718302719735759
2025-03-09 08:28:45,892 [INFO]: 	99p_search_speed_ms: 21.671889482531697
2025-03-09 08:28:45,892 [INFO]: 	reconstruction error %: 0.0
2025-03-09 08:28:45,892 [INFO]: 	nb vectors: 3101
2025-03-09 08:28:45,892 [INFO]: 	vectors dimension: 49152
2025-03-09 08:28:45,892 [INFO]: 	compression ratio: 0.9993097848425505
2025-03-09 08:28:45,892 [INFO]: }
2025-03-09 08:28:45,892 [INFO]: 	>>> Finished "Creating the index" in 58.5273 secs
2025-03-09 08:28:45,892 [INFO]: >>> Finished "Launching the whole pipeline" in 58.5693 secs
2025-03-09 08:28:46: [retrieval_preprocessing] calculating distances ...
2025-03-09 08:28:47: [retrieval_preprocessing] finished and saved retrieval indices for episode 79404 [episode count 15/20]
[retrieval_preprocessing] for episode 41005 [episode count 16/20], we have num_retrieval=np.int64(3058) num_query=np.int64(123)
2025-03-09 08:28:47,305 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-09 08:28:47,835 [INFO]: Launching the whole pipeline 03/09/2025, 08:28:47
2025-03-09 08:28:47,835 [INFO]: Reading total number of vectors and dimension 03/09/2025, 08:28:47
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1391.61it/s]
2025-03-09 08:28:47,866 [INFO]: There are 3058 embeddings of dim 49152
2025-03-09 08:28:47,866 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0305 secs
2025-03-09 08:28:47,866 [INFO]: 	Compute estimated construction time of the index 03/09/2025, 08:28:47
2025-03-09 08:28:47,866 [INFO]: 		-> Train: 16.7 minutes
2025-03-09 08:28:47,866 [INFO]: 		-> Add: 1.7 seconds
2025-03-09 08:28:47,866 [INFO]: 		Total: 16.7 minutes
2025-03-09 08:28:47,866 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0001 secs
2025-03-09 08:28:47,866 [INFO]: 	Checking that your have enough memory available to create the index 03/09/2025, 08:28:47
2025-03-09 08:28:47,866 [INFO]: 631.1MB of memory will be needed to build the index (more might be used if you have more)
2025-03-09 08:28:47,866 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0002 secs
2025-03-09 08:28:47,866 [INFO]: 	Selecting most promising index types given data characteristics 03/09/2025, 08:28:47
2025-03-09 08:28:47,866 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-09 08:28:47,866 [INFO]: 	Creating the index 03/09/2025, 08:28:47
2025-03-09 08:28:47,866 [INFO]: 		-> Instanciate the index HNSW15 03/09/2025, 08:28:47
2025-03-09 08:28:47,868 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0012 secs
2025-03-09 08:28:47,868 [INFO]: 		-> Adding the vectors to the index 03/09/2025, 08:28:47
2025-03-09 08:28:47,868 [INFO]: The memory available for adding the vectors is 49.4GB(total available - used by the index)
2025-03-09 08:28:47,868 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/13 [00:00<?, ?it/s] 15%|█▌        | 2/13 [00:00<00:00, 17.74it/s] 54%|█████▍    | 7/13 [00:00<00:00, 29.63it/s] 92%|█████████▏| 12/13 [00:00<00:00, 37.51it/s]100%|██████████| 13/13 [00:02<00:00,  5.09it/s]
2025-03-09 08:28:50,425 [INFO]: 	Computing best hyperparameters for index knn.index 03/09/2025, 08:28:50
2025-03-09 08:29:25,552 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 35.1262 secs
2025-03-09 08:29:25,552 [INFO]: The best hyperparameters are: efSearch=246
2025-03-09 08:29:25,552 [INFO]: 	Compute fast metrics 03/09/2025, 08:29:25
  0%|          | 0/4 [00:00<?, ?it/s] 50%|█████     | 2/4 [00:00<00:00, 18.81it/s] 75%|███████▌  | 3/4 [00:00<00:00, 20.41it/s]
2025-03-09 08:29:41,136 [INFO]: 	>>> Finished "Compute fast metrics" in 15.5832 secs
2025-03-09 08:29:41,138 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 53.2697 secs
2025-03-09 08:29:41,138 [INFO]: {
2025-03-09 08:29:41,138 [INFO]: 	index_key: HNSW15
2025-03-09 08:29:41,138 [INFO]: 	index_param: efSearch=246
2025-03-09 08:29:41,138 [INFO]: 	index_path: knn.index
2025-03-09 08:29:41,138 [INFO]: 	size in bytes: 601642510
2025-03-09 08:29:41,138 [INFO]: 	avg_search_speed_ms: 11.405548298251995
2025-03-09 08:29:41,138 [INFO]: 	99p_search_speed_ms: 25.507276768330488
2025-03-09 08:29:41,138 [INFO]: 	reconstruction error %: 0.0
2025-03-09 08:29:41,138 [INFO]: 	nb vectors: 3058
2025-03-09 08:29:41,138 [INFO]: 	vectors dimension: 49152
2025-03-09 08:29:41,138 [INFO]: 	compression ratio: 0.9993098127324813
2025-03-09 08:29:41,138 [INFO]: }
2025-03-09 08:29:41,138 [INFO]: 	>>> Finished "Creating the index" in 53.2715 secs
2025-03-09 08:29:41,138 [INFO]: >>> Finished "Launching the whole pipeline" in 53.3027 secs
2025-03-09 08:29:41: [retrieval_preprocessing] calculating distances ...
2025-03-09 08:29:42: [retrieval_preprocessing] finished and saved retrieval indices for episode 41005 [episode count 16/20]
[retrieval_preprocessing] for episode 74286 [episode count 17/20], we have num_retrieval=np.int64(2912) num_query=np.int64(269)
2025-03-09 08:29:42,717 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-09 08:29:43,159 [INFO]: Launching the whole pipeline 03/09/2025, 08:29:43
2025-03-09 08:29:43,159 [INFO]: Reading total number of vectors and dimension 03/09/2025, 08:29:43
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1312.77it/s]
2025-03-09 08:29:43,187 [INFO]: There are 2912 embeddings of dim 49152
2025-03-09 08:29:43,187 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0281 secs
2025-03-09 08:29:43,187 [INFO]: 	Compute estimated construction time of the index 03/09/2025, 08:29:43
2025-03-09 08:29:43,187 [INFO]: 		-> Train: 16.7 minutes
2025-03-09 08:29:43,187 [INFO]: 		-> Add: 1.6 seconds
2025-03-09 08:29:43,187 [INFO]: 		Total: 16.7 minutes
2025-03-09 08:29:43,187 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0001 secs
2025-03-09 08:29:43,187 [INFO]: 	Checking that your have enough memory available to create the index 03/09/2025, 08:29:43
2025-03-09 08:29:43,188 [INFO]: 601.0MB of memory will be needed to build the index (more might be used if you have more)
2025-03-09 08:29:43,188 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0002 secs
2025-03-09 08:29:43,188 [INFO]: 	Selecting most promising index types given data characteristics 03/09/2025, 08:29:43
2025-03-09 08:29:43,188 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-09 08:29:43,188 [INFO]: 	Creating the index 03/09/2025, 08:29:43
2025-03-09 08:29:43,188 [INFO]: 		-> Instanciate the index HNSW15 03/09/2025, 08:29:43
2025-03-09 08:29:43,189 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0013 secs
2025-03-09 08:29:43,189 [INFO]: 		-> Adding the vectors to the index 03/09/2025, 08:29:43
2025-03-09 08:29:43,189 [INFO]: The memory available for adding the vectors is 49.5GB(total available - used by the index)
2025-03-09 08:29:43,189 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/12 [00:00<?, ?it/s] 17%|█▋        | 2/12 [00:00<00:00, 19.18it/s] 67%|██████▋   | 8/12 [00:00<00:00, 38.17it/s]100%|██████████| 12/12 [00:02<00:00,  4.21it/s]100%|██████████| 12/12 [00:02<00:00,  5.28it/s]
2025-03-09 08:29:45,466 [INFO]: 	Computing best hyperparameters for index knn.index 03/09/2025, 08:29:45
2025-03-09 08:30:19,589 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 34.1229 secs
2025-03-09 08:30:19,589 [INFO]: The best hyperparameters are: efSearch=228
2025-03-09 08:30:19,589 [INFO]: 	Compute fast metrics 03/09/2025, 08:30:19
  0%|          | 0/4 [00:00<?, ?it/s] 50%|█████     | 2/4 [00:00<00:00, 19.71it/s] 75%|███████▌  | 3/4 [00:00<00:00, 21.66it/s]
2025-03-09 08:30:33,365 [INFO]: 	>>> Finished "Compute fast metrics" in 13.7757 secs
2025-03-09 08:30:33,368 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 50.1791 secs
2025-03-09 08:30:33,369 [INFO]: {
2025-03-09 08:30:33,369 [INFO]: 	index_key: HNSW15
2025-03-09 08:30:33,369 [INFO]: 	index_param: efSearch=228
2025-03-09 08:30:33,369 [INFO]: 	index_path: knn.index
2025-03-09 08:30:33,369 [INFO]: 	size in bytes: 572917870
2025-03-09 08:30:33,369 [INFO]: 	avg_search_speed_ms: 9.349315546923012
2025-03-09 08:30:33,369 [INFO]: 	99p_search_speed_ms: 22.605812973342815
2025-03-09 08:30:33,369 [INFO]: 	reconstruction error %: 0.0
2025-03-09 08:30:33,369 [INFO]: 	nb vectors: 2912
2025-03-09 08:30:33,369 [INFO]: 	vectors dimension: 49152
2025-03-09 08:30:33,369 [INFO]: 	compression ratio: 0.9993098941040188
2025-03-09 08:30:33,369 [INFO]: }
2025-03-09 08:30:33,369 [INFO]: 	>>> Finished "Creating the index" in 50.1813 secs
2025-03-09 08:30:33,369 [INFO]: >>> Finished "Launching the whole pipeline" in 50.2102 secs
2025-03-09 08:30:34: [retrieval_preprocessing] calculating distances ...
2025-03-09 08:30:35: [retrieval_preprocessing] finished and saved retrieval indices for episode 74286 [episode count 17/20]
[retrieval_preprocessing] for episode 90154 [episode count 18/20], we have num_retrieval=np.int64(3048) num_query=np.int64(133)
2025-03-09 08:30:36,223 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-09 08:30:36,707 [INFO]: Launching the whole pipeline 03/09/2025, 08:30:36
2025-03-09 08:30:36,707 [INFO]: Reading total number of vectors and dimension 03/09/2025, 08:30:36
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 2240.55it/s]
2025-03-09 08:30:36,731 [INFO]: There are 3048 embeddings of dim 49152
2025-03-09 08:30:36,732 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0241 secs
2025-03-09 08:30:36,732 [INFO]: 	Compute estimated construction time of the index 03/09/2025, 08:30:36
2025-03-09 08:30:36,732 [INFO]: 		-> Train: 16.7 minutes
2025-03-09 08:30:36,732 [INFO]: 		-> Add: 1.7 seconds
2025-03-09 08:30:36,732 [INFO]: 		Total: 16.7 minutes
2025-03-09 08:30:36,732 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0001 secs
2025-03-09 08:30:36,732 [INFO]: 	Checking that your have enough memory available to create the index 03/09/2025, 08:30:36
2025-03-09 08:30:36,732 [INFO]: 629.0MB of memory will be needed to build the index (more might be used if you have more)
2025-03-09 08:30:36,732 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0001 secs
2025-03-09 08:30:36,732 [INFO]: 	Selecting most promising index types given data characteristics 03/09/2025, 08:30:36
2025-03-09 08:30:36,732 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-09 08:30:36,732 [INFO]: 	Creating the index 03/09/2025, 08:30:36
2025-03-09 08:30:36,732 [INFO]: 		-> Instanciate the index HNSW15 03/09/2025, 08:30:36
2025-03-09 08:30:36,733 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0010 secs
2025-03-09 08:30:36,733 [INFO]: 		-> Adding the vectors to the index 03/09/2025, 08:30:36
2025-03-09 08:30:36,733 [INFO]: The memory available for adding the vectors is 49.4GB(total available - used by the index)
2025-03-09 08:30:36,733 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/12 [00:00<?, ?it/s] 17%|█▋        | 2/12 [00:00<00:00, 16.89it/s] 67%|██████▋   | 8/12 [00:00<00:00, 37.15it/s]100%|██████████| 12/12 [00:02<00:00,  4.17it/s]100%|██████████| 12/12 [00:02<00:00,  5.22it/s]
2025-03-09 08:30:39,035 [INFO]: 	Computing best hyperparameters for index knn.index 03/09/2025, 08:30:39
2025-03-09 08:31:08,089 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 29.0528 secs
2025-03-09 08:31:08,089 [INFO]: The best hyperparameters are: efSearch=248
2025-03-09 08:31:08,089 [INFO]: 	Compute fast metrics 03/09/2025, 08:31:08
  0%|          | 0/4 [00:00<?, ?it/s] 25%|██▌       | 1/4 [00:00<00:00,  8.16it/s] 75%|███████▌  | 3/4 [00:00<00:00, 15.42it/s]
2025-03-09 08:31:23,501 [INFO]: 	>>> Finished "Compute fast metrics" in 15.4114 secs
2025-03-09 08:31:23,504 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 46.7704 secs
2025-03-09 08:31:23,504 [INFO]: {
2025-03-09 08:31:23,504 [INFO]: 	index_key: HNSW15
2025-03-09 08:31:23,504 [INFO]: 	index_param: efSearch=248
2025-03-09 08:31:23,504 [INFO]: 	index_path: knn.index
2025-03-09 08:31:23,504 [INFO]: 	size in bytes: 599674990
2025-03-09 08:31:23,504 [INFO]: 	avg_search_speed_ms: 13.231056725123414
2025-03-09 08:31:23,504 [INFO]: 	99p_search_speed_ms: 21.141945431008963
2025-03-09 08:31:23,504 [INFO]: 	reconstruction error %: 0.0
2025-03-09 08:31:23,504 [INFO]: 	nb vectors: 3048
2025-03-09 08:31:23,504 [INFO]: 	vectors dimension: 49152
2025-03-09 08:31:23,504 [INFO]: 	compression ratio: 0.9993099495445025
2025-03-09 08:31:23,504 [INFO]: }
2025-03-09 08:31:23,504 [INFO]: 	>>> Finished "Creating the index" in 46.7720 secs
2025-03-09 08:31:23,504 [INFO]: >>> Finished "Launching the whole pipeline" in 46.7967 secs
2025-03-09 08:31:24: [retrieval_preprocessing] calculating distances ...
2025-03-09 08:31:25: [retrieval_preprocessing] finished and saved retrieval indices for episode 90154 [episode count 18/20]
[retrieval_preprocessing] for episode 93738 [episode count 19/20], we have num_retrieval=np.int64(2983) num_query=np.int64(198)
2025-03-09 08:31:26,177 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-09 08:31:26,644 [INFO]: Launching the whole pipeline 03/09/2025, 08:31:26
2025-03-09 08:31:26,645 [INFO]: Reading total number of vectors and dimension 03/09/2025, 08:31:26
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1210.48it/s]
2025-03-09 08:31:26,673 [INFO]: There are 2983 embeddings of dim 49152
2025-03-09 08:31:26,674 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0292 secs
2025-03-09 08:31:26,674 [INFO]: 	Compute estimated construction time of the index 03/09/2025, 08:31:26
2025-03-09 08:31:26,674 [INFO]: 		-> Train: 16.7 minutes
2025-03-09 08:31:26,674 [INFO]: 		-> Add: 1.6 seconds
2025-03-09 08:31:26,674 [INFO]: 		Total: 16.7 minutes
2025-03-09 08:31:26,674 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0001 secs
2025-03-09 08:31:26,674 [INFO]: 	Checking that your have enough memory available to create the index 03/09/2025, 08:31:26
2025-03-09 08:31:26,674 [INFO]: 615.6MB of memory will be needed to build the index (more might be used if you have more)
2025-03-09 08:31:26,674 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0002 secs
2025-03-09 08:31:26,674 [INFO]: 	Selecting most promising index types given data characteristics 03/09/2025, 08:31:26
2025-03-09 08:31:26,674 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-09 08:31:26,674 [INFO]: 	Creating the index 03/09/2025, 08:31:26
2025-03-09 08:31:26,674 [INFO]: 		-> Instanciate the index HNSW15 03/09/2025, 08:31:26
2025-03-09 08:31:26,676 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0014 secs
2025-03-09 08:31:26,676 [INFO]: 		-> Adding the vectors to the index 03/09/2025, 08:31:26
2025-03-09 08:31:26,676 [INFO]: The memory available for adding the vectors is 49.5GB(total available - used by the index)
2025-03-09 08:31:26,676 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/12 [00:00<?, ?it/s]  8%|▊         | 1/12 [00:00<00:01,  6.87it/s] 25%|██▌       | 3/12 [00:00<00:00, 10.42it/s] 42%|████▏     | 5/12 [00:00<00:00, 10.91it/s] 58%|█████▊    | 7/12 [00:00<00:00, 11.29it/s] 75%|███████▌  | 9/12 [00:00<00:00, 11.66it/s] 92%|█████████▏| 11/12 [00:00<00:00, 11.84it/s]100%|██████████| 12/12 [00:03<00:00,  3.69it/s]
2025-03-09 08:31:29,938 [INFO]: 	Computing best hyperparameters for index knn.index 03/09/2025, 08:31:29
2025-03-09 08:32:11,628 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 41.6887 secs
2025-03-09 08:32:11,628 [INFO]: The best hyperparameters are: efSearch=237
2025-03-09 08:32:11,628 [INFO]: 	Compute fast metrics 03/09/2025, 08:32:11
  0%|          | 0/4 [00:00<?, ?it/s] 50%|█████     | 2/4 [00:00<00:00, 18.90it/s] 75%|███████▌  | 3/4 [00:00<00:00, 20.67it/s]
2025-03-09 08:32:28,518 [INFO]: 	>>> Finished "Compute fast metrics" in 16.8895 secs
2025-03-09 08:32:28,520 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 61.8437 secs
2025-03-09 08:32:28,520 [INFO]: {
2025-03-09 08:32:28,520 [INFO]: 	index_key: HNSW15
2025-03-09 08:32:28,520 [INFO]: 	index_param: efSearch=237
2025-03-09 08:32:28,520 [INFO]: 	index_path: knn.index
2025-03-09 08:32:28,520 [INFO]: 	size in bytes: 586886830
2025-03-09 08:32:28,520 [INFO]: 	avg_search_speed_ms: 10.190654556465379
2025-03-09 08:32:28,520 [INFO]: 	99p_search_speed_ms: 25.164286000654116
2025-03-09 08:32:28,520 [INFO]: 	reconstruction error %: 0.0
2025-03-09 08:32:28,520 [INFO]: 	nb vectors: 2983
2025-03-09 08:32:28,520 [INFO]: 	vectors dimension: 49152
2025-03-09 08:32:28,520 [INFO]: 	compression ratio: 0.9993096352153618
2025-03-09 08:32:28,520 [INFO]: }
2025-03-09 08:32:28,520 [INFO]: 	>>> Finished "Creating the index" in 61.8457 secs
2025-03-09 08:32:28,520 [INFO]: >>> Finished "Launching the whole pipeline" in 61.8756 secs
2025-03-09 08:32:29: [retrieval_preprocessing] calculating distances ...
2025-03-09 08:32:30: [retrieval_preprocessing] finished and saved retrieval indices for episode 93738 [episode count 19/20]
2025-03-09 08:32:30: [retrieval_preprocessing] finished for (4465064685, 'marker') [chosen_id count 4/10]
2025-03-09 08:32:32: [retrieval_preprocessing] concatenated all embeddings and indices for 20 episodes for (9186164821, 'bottle') [chosen_id count 5/10]
2025-03-09 08:32:32: [retrieval_preprocessing] we have num_total=6288 embedding_dim=49152
[retrieval_preprocessing] for episode 20737 [episode count 0/20], we have num_retrieval=np.int64(6062) num_query=np.int64(226)
2025-03-09 08:32:33,301 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-09 08:32:34,084 [INFO]: Launching the whole pipeline 03/09/2025, 08:32:34
2025-03-09 08:32:34,084 [INFO]: Reading total number of vectors and dimension 03/09/2025, 08:32:34
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1386.09it/s]
2025-03-09 08:32:34,111 [INFO]: There are 6062 embeddings of dim 49152
2025-03-09 08:32:34,111 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0268 secs
2025-03-09 08:32:34,111 [INFO]: 	Compute estimated construction time of the index 03/09/2025, 08:32:34
2025-03-09 08:32:34,111 [INFO]: 		-> Train: 16.7 minutes
2025-03-09 08:32:34,111 [INFO]: 		-> Add: 3.3 seconds
2025-03-09 08:32:34,111 [INFO]: 		Total: 16.7 minutes
2025-03-09 08:32:34,111 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0001 secs
2025-03-09 08:32:34,111 [INFO]: 	Checking that your have enough memory available to create the index 03/09/2025, 08:32:34
2025-03-09 08:32:34,111 [INFO]: 1.2GB of memory will be needed to build the index (more might be used if you have more)
2025-03-09 08:32:34,112 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0002 secs
2025-03-09 08:32:34,112 [INFO]: 	Selecting most promising index types given data characteristics 03/09/2025, 08:32:34
2025-03-09 08:32:34,112 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-09 08:32:34,112 [INFO]: 	Creating the index 03/09/2025, 08:32:34
2025-03-09 08:32:34,112 [INFO]: 		-> Instanciate the index HNSW15 03/09/2025, 08:32:34
2025-03-09 08:32:34,113 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0010 secs
2025-03-09 08:32:34,113 [INFO]: 		-> Adding the vectors to the index 03/09/2025, 08:32:34
2025-03-09 08:32:34,113 [INFO]: The memory available for adding the vectors is 48.9GB(total available - used by the index)
2025-03-09 08:32:34,113 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/25 [00:00<?, ?it/s]  4%|▍         | 1/25 [00:00<00:02,  8.25it/s] 24%|██▍       | 6/25 [00:00<00:00, 27.67it/s] 40%|████      | 10/25 [00:00<00:00, 32.64it/s] 60%|██████    | 15/25 [00:00<00:00, 36.32it/s] 80%|████████  | 20/25 [00:00<00:00, 38.23it/s] 96%|█████████▌| 24/25 [00:05<00:00,  2.54it/s]100%|██████████| 25/25 [00:07<00:00,  3.46it/s]
2025-03-09 08:32:41,346 [INFO]: 	Computing best hyperparameters for index knn.index 03/09/2025, 08:32:41
2025-03-09 08:33:38,797 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 57.4505 secs
2025-03-09 08:33:38,798 [INFO]: The best hyperparameters are: efSearch=111
2025-03-09 08:33:38,798 [INFO]: 	Compute fast metrics 03/09/2025, 08:33:38
  0%|          | 0/4 [00:00<?, ?it/s] 75%|███████▌  | 3/4 [00:00<00:00, 25.04it/s] 75%|███████▌  | 3/4 [00:00<00:00, 21.29it/s]
2025-03-09 08:33:55,428 [INFO]: 	>>> Finished "Compute fast metrics" in 16.6303 secs
2025-03-09 08:33:55,430 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 81.3170 secs
2025-03-09 08:33:55,430 [INFO]: {
2025-03-09 08:33:55,430 [INFO]: 	index_key: HNSW15
2025-03-09 08:33:55,430 [INFO]: 	index_param: efSearch=111
2025-03-09 08:33:55,430 [INFO]: 	index_path: knn.index
2025-03-09 08:33:55,430 [INFO]: 	size in bytes: 1192662790
2025-03-09 08:33:55,430 [INFO]: 	avg_search_speed_ms: 8.389429017571707
2025-03-09 08:33:55,430 [INFO]: 	99p_search_speed_ms: 19.857694536913183
2025-03-09 08:33:55,430 [INFO]: 	reconstruction error %: 0.0
2025-03-09 08:33:55,430 [INFO]: 	nb vectors: 6062
2025-03-09 08:33:55,430 [INFO]: 	vectors dimension: 49152
2025-03-09 08:33:55,430 [INFO]: 	compression ratio: 0.999308191714441
2025-03-09 08:33:55,430 [INFO]: }
2025-03-09 08:33:55,430 [INFO]: 	>>> Finished "Creating the index" in 81.3186 secs
2025-03-09 08:33:55,430 [INFO]: >>> Finished "Launching the whole pipeline" in 81.3461 secs
2025-03-09 08:33:56: [retrieval_preprocessing] calculating distances ...
2025-03-09 08:33:57: [retrieval_preprocessing] finished and saved retrieval indices for episode 20737 [episode count 0/20]
[retrieval_preprocessing] for episode 38275 [episode count 1/20], we have num_retrieval=np.int64(5829) num_query=np.int64(459)
2025-03-09 08:33:57,853 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-09 08:33:58,757 [INFO]: Launching the whole pipeline 03/09/2025, 08:33:58
2025-03-09 08:33:58,757 [INFO]: Reading total number of vectors and dimension 03/09/2025, 08:33:58
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1053.85it/s]
2025-03-09 08:33:58,786 [INFO]: There are 5829 embeddings of dim 49152
2025-03-09 08:33:58,786 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0284 secs
2025-03-09 08:33:58,786 [INFO]: 	Compute estimated construction time of the index 03/09/2025, 08:33:58
2025-03-09 08:33:58,786 [INFO]: 		-> Train: 16.7 minutes
2025-03-09 08:33:58,786 [INFO]: 		-> Add: 3.2 seconds
2025-03-09 08:33:58,787 [INFO]: 		Total: 16.7 minutes
2025-03-09 08:33:58,787 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0009 secs
2025-03-09 08:33:58,787 [INFO]: 	Checking that your have enough memory available to create the index 03/09/2025, 08:33:58
2025-03-09 08:33:58,787 [INFO]: 1.2GB of memory will be needed to build the index (more might be used if you have more)
2025-03-09 08:33:58,787 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0002 secs
2025-03-09 08:33:58,787 [INFO]: 	Selecting most promising index types given data characteristics 03/09/2025, 08:33:58
2025-03-09 08:33:58,787 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-09 08:33:58,787 [INFO]: 	Creating the index 03/09/2025, 08:33:58
2025-03-09 08:33:58,787 [INFO]: 		-> Instanciate the index HNSW15 03/09/2025, 08:33:58
2025-03-09 08:33:58,789 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0014 secs
2025-03-09 08:33:58,789 [INFO]: 		-> Adding the vectors to the index 03/09/2025, 08:33:58
2025-03-09 08:33:58,789 [INFO]: The memory available for adding the vectors is 48.9GB(total available - used by the index)
2025-03-09 08:33:58,789 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/24 [00:00<?, ?it/s]  8%|▊         | 2/24 [00:00<00:01, 17.27it/s] 29%|██▉       | 7/24 [00:00<00:00, 34.55it/s] 46%|████▌     | 11/24 [00:00<00:00, 36.33it/s] 71%|███████   | 17/24 [00:00<00:00, 43.56it/s] 92%|█████████▏| 22/24 [00:04<00:00,  2.94it/s]100%|██████████| 24/24 [00:06<00:00,  3.81it/s]
2025-03-09 08:34:05,089 [INFO]: 	Computing best hyperparameters for index knn.index 03/09/2025, 08:34:05
2025-03-09 08:34:54,134 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 49.0445 secs
2025-03-09 08:34:54,135 [INFO]: The best hyperparameters are: efSearch=141
2025-03-09 08:34:54,135 [INFO]: 	Compute fast metrics 03/09/2025, 08:34:54
  0%|          | 0/4 [00:00<?, ?it/s] 50%|█████     | 2/4 [00:00<00:00, 18.81it/s] 75%|███████▌  | 3/4 [00:00<00:00, 20.09it/s]
2025-03-09 08:35:12,691 [INFO]: 	>>> Finished "Compute fast metrics" in 18.5559 secs
2025-03-09 08:35:12,692 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 73.9029 secs
2025-03-09 08:35:12,692 [INFO]: {
2025-03-09 08:35:12,692 [INFO]: 	index_key: HNSW15
2025-03-09 08:35:12,692 [INFO]: 	index_param: efSearch=141
2025-03-09 08:35:12,692 [INFO]: 	index_path: knn.index
2025-03-09 08:35:12,692 [INFO]: 	size in bytes: 1146821410
2025-03-09 08:35:12,692 [INFO]: 	avg_search_speed_ms: 8.59562574531339
2025-03-09 08:35:12,692 [INFO]: 	99p_search_speed_ms: 18.24986871564758
2025-03-09 08:35:12,692 [INFO]: 	reconstruction error %: 0.0
2025-03-09 08:35:12,692 [INFO]: 	nb vectors: 5829
2025-03-09 08:35:12,692 [INFO]: 	vectors dimension: 49152
2025-03-09 08:35:12,692 [INFO]: 	compression ratio: 0.9993081939410252
2025-03-09 08:35:12,692 [INFO]: }
2025-03-09 08:35:12,692 [INFO]: 	>>> Finished "Creating the index" in 73.9048 secs
2025-03-09 08:35:12,692 [INFO]: >>> Finished "Launching the whole pipeline" in 73.9347 secs
2025-03-09 08:35:14: [retrieval_preprocessing] calculating distances ...
2025-03-09 08:35:16: [retrieval_preprocessing] finished and saved retrieval indices for episode 38275 [episode count 1/20]
[retrieval_preprocessing] for episode 11652 [episode count 2/20], we have num_retrieval=np.int64(5942) num_query=np.int64(346)
2025-03-09 08:35:17,047 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-09 08:35:17,985 [INFO]: Launching the whole pipeline 03/09/2025, 08:35:17
2025-03-09 08:35:17,986 [INFO]: Reading total number of vectors and dimension 03/09/2025, 08:35:17
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1371.58it/s]
2025-03-09 08:35:18,011 [INFO]: There are 5942 embeddings of dim 49152
2025-03-09 08:35:18,012 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0260 secs
2025-03-09 08:35:18,012 [INFO]: 	Compute estimated construction time of the index 03/09/2025, 08:35:18
2025-03-09 08:35:18,012 [INFO]: 		-> Train: 16.7 minutes
2025-03-09 08:35:18,012 [INFO]: 		-> Add: 3.3 seconds
2025-03-09 08:35:18,012 [INFO]: 		Total: 16.7 minutes
2025-03-09 08:35:18,012 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0001 secs
2025-03-09 08:35:18,012 [INFO]: 	Checking that your have enough memory available to create the index 03/09/2025, 08:35:18
2025-03-09 08:35:18,012 [INFO]: 1.2GB of memory will be needed to build the index (more might be used if you have more)
2025-03-09 08:35:18,012 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0002 secs
2025-03-09 08:35:18,012 [INFO]: 	Selecting most promising index types given data characteristics 03/09/2025, 08:35:18
2025-03-09 08:35:18,012 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-09 08:35:18,012 [INFO]: 	Creating the index 03/09/2025, 08:35:18
2025-03-09 08:35:18,012 [INFO]: 		-> Instanciate the index HNSW15 03/09/2025, 08:35:18
2025-03-09 08:35:18,013 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0011 secs
2025-03-09 08:35:18,014 [INFO]: 		-> Adding the vectors to the index 03/09/2025, 08:35:18
2025-03-09 08:35:18,014 [INFO]: The memory available for adding the vectors is 48.9GB(total available - used by the index)
2025-03-09 08:35:18,014 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/25 [00:00<?, ?it/s]  8%|▊         | 2/25 [00:00<00:01, 18.48it/s] 28%|██▊       | 7/25 [00:00<00:00, 35.96it/s] 48%|████▊     | 12/25 [00:00<00:00, 41.59it/s] 68%|██████▊   | 17/25 [00:00<00:00, 40.71it/s] 88%|████████▊ | 22/25 [00:04<00:01,  2.96it/s]100%|██████████| 25/25 [00:06<00:00,  2.52it/s]100%|██████████| 25/25 [00:06<00:00,  3.89it/s]
2025-03-09 08:35:24,705 [INFO]: 	Computing best hyperparameters for index knn.index 03/09/2025, 08:35:24
2025-03-09 08:36:12,958 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 48.2525 secs
2025-03-09 08:36:12,958 [INFO]: The best hyperparameters are: efSearch=116
2025-03-09 08:36:12,958 [INFO]: 	Compute fast metrics 03/09/2025, 08:36:12
  0%|          | 0/4 [00:00<?, ?it/s] 50%|█████     | 2/4 [00:00<00:00, 18.07it/s] 75%|███████▌  | 3/4 [00:00<00:00, 19.34it/s]
2025-03-09 08:36:37,238 [INFO]: 	>>> Finished "Compute fast metrics" in 24.2797 secs
2025-03-09 08:36:37,239 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 79.2257 secs
2025-03-09 08:36:37,239 [INFO]: {
2025-03-09 08:36:37,239 [INFO]: 	index_key: HNSW15
2025-03-09 08:36:37,239 [INFO]: 	index_param: efSearch=116
2025-03-09 08:36:37,239 [INFO]: 	index_path: knn.index
2025-03-09 08:36:37,239 [INFO]: 	size in bytes: 1169053570
2025-03-09 08:36:37,239 [INFO]: 	avg_search_speed_ms: 8.149415482489882
2025-03-09 08:36:37,239 [INFO]: 	99p_search_speed_ms: 19.331590216606855
2025-03-09 08:36:37,240 [INFO]: 	reconstruction error %: 0.0
2025-03-09 08:36:37,240 [INFO]: 	nb vectors: 5942
2025-03-09 08:36:37,240 [INFO]: 	vectors dimension: 49152
2025-03-09 08:36:37,240 [INFO]: 	compression ratio: 0.9993081292245658
2025-03-09 08:36:37,240 [INFO]: }
2025-03-09 08:36:37,240 [INFO]: 	>>> Finished "Creating the index" in 79.2273 secs
2025-03-09 08:36:37,240 [INFO]: >>> Finished "Launching the whole pipeline" in 79.2540 secs
2025-03-09 08:36:38: [retrieval_preprocessing] calculating distances ...
2025-03-09 08:36:39: [retrieval_preprocessing] finished and saved retrieval indices for episode 11652 [episode count 2/20]
[retrieval_preprocessing] for episode 6405 [episode count 3/20], we have num_retrieval=np.int64(6093) num_query=np.int64(195)
2025-03-09 08:36:40,506 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-09 08:36:41,398 [INFO]: Launching the whole pipeline 03/09/2025, 08:36:41
2025-03-09 08:36:41,398 [INFO]: Reading total number of vectors and dimension 03/09/2025, 08:36:41
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 897.75it/s]
2025-03-09 08:36:41,433 [INFO]: There are 6093 embeddings of dim 49152
2025-03-09 08:36:41,434 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0353 secs
2025-03-09 08:36:41,434 [INFO]: 	Compute estimated construction time of the index 03/09/2025, 08:36:41
2025-03-09 08:36:41,434 [INFO]: 		-> Train: 16.7 minutes
2025-03-09 08:36:41,434 [INFO]: 		-> Add: 3.3 seconds
2025-03-09 08:36:41,434 [INFO]: 		Total: 16.7 minutes
2025-03-09 08:36:41,434 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0001 secs
2025-03-09 08:36:41,434 [INFO]: 	Checking that your have enough memory available to create the index 03/09/2025, 08:36:41
2025-03-09 08:36:41,434 [INFO]: 1.2GB of memory will be needed to build the index (more might be used if you have more)
2025-03-09 08:36:41,434 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0001 secs
2025-03-09 08:36:41,434 [INFO]: 	Selecting most promising index types given data characteristics 03/09/2025, 08:36:41
2025-03-09 08:36:41,434 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-09 08:36:41,434 [INFO]: 	Creating the index 03/09/2025, 08:36:41
2025-03-09 08:36:41,434 [INFO]: 		-> Instanciate the index HNSW15 03/09/2025, 08:36:41
2025-03-09 08:36:41,435 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0009 secs
2025-03-09 08:36:41,435 [INFO]: 		-> Adding the vectors to the index 03/09/2025, 08:36:41
2025-03-09 08:36:41,435 [INFO]: The memory available for adding the vectors is 48.9GB(total available - used by the index)
2025-03-09 08:36:41,435 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/25 [00:00<?, ?it/s]  4%|▍         | 1/25 [00:00<00:02,  8.09it/s] 16%|█▌        | 4/25 [00:00<00:01, 18.55it/s] 36%|███▌      | 9/25 [00:00<00:00, 29.42it/s] 56%|█████▌    | 14/25 [00:00<00:00, 33.69it/s] 76%|███████▌  | 19/25 [00:00<00:00, 37.86it/s] 92%|█████████▏| 23/25 [00:04<00:00,  2.78it/s]100%|██████████| 25/25 [00:07<00:00,  3.43it/s]
2025-03-09 08:36:48,734 [INFO]: 	Computing best hyperparameters for index knn.index 03/09/2025, 08:36:48
2025-03-09 08:37:45,415 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 56.6802 secs
2025-03-09 08:37:45,415 [INFO]: The best hyperparameters are: efSearch=196
2025-03-09 08:37:45,415 [INFO]: 	Compute fast metrics 03/09/2025, 08:37:45
  0%|          | 0/4 [00:00<?, ?it/s] 25%|██▌       | 1/4 [00:00<00:00,  9.81it/s] 75%|███████▌  | 3/4 [00:00<00:00, 18.48it/s]
2025-03-09 08:38:02,640 [INFO]: 	>>> Finished "Compute fast metrics" in 17.2248 secs
2025-03-09 08:38:02,642 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 81.2061 secs
2025-03-09 08:38:02,642 [INFO]: {
2025-03-09 08:38:02,642 [INFO]: 	index_key: HNSW15
2025-03-09 08:38:02,642 [INFO]: 	index_param: efSearch=196
2025-03-09 08:38:02,642 [INFO]: 	index_path: knn.index
2025-03-09 08:38:02,642 [INFO]: 	size in bytes: 1198761850
2025-03-09 08:38:02,642 [INFO]: 	avg_search_speed_ms: 11.983311343045827
2025-03-09 08:38:02,642 [INFO]: 	99p_search_speed_ms: 26.72304297331718
2025-03-09 08:38:02,642 [INFO]: 	reconstruction error %: 0.0
2025-03-09 08:38:02,642 [INFO]: 	nb vectors: 6093
2025-03-09 08:38:02,642 [INFO]: 	vectors dimension: 49152
2025-03-09 08:38:02,642 [INFO]: 	compression ratio: 0.999308197870995
2025-03-09 08:38:02,642 [INFO]: }
2025-03-09 08:38:02,642 [INFO]: 	>>> Finished "Creating the index" in 81.2077 secs
2025-03-09 08:38:02,642 [INFO]: >>> Finished "Launching the whole pipeline" in 81.2436 secs
2025-03-09 08:38:04: [retrieval_preprocessing] calculating distances ...
2025-03-09 08:38:04: [retrieval_preprocessing] finished and saved retrieval indices for episode 6405 [episode count 3/20]
[retrieval_preprocessing] for episode 58759 [episode count 4/20], we have num_retrieval=np.int64(5744) num_query=np.int64(544)
2025-03-09 08:38:07,676 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-09 08:38:08,520 [INFO]: Launching the whole pipeline 03/09/2025, 08:38:08
2025-03-09 08:38:08,521 [INFO]: Reading total number of vectors and dimension 03/09/2025, 08:38:08
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1254.28it/s]
2025-03-09 08:38:08,550 [INFO]: There are 5744 embeddings of dim 49152
2025-03-09 08:38:08,550 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0295 secs
2025-03-09 08:38:08,550 [INFO]: 	Compute estimated construction time of the index 03/09/2025, 08:38:08
2025-03-09 08:38:08,550 [INFO]: 		-> Train: 16.7 minutes
2025-03-09 08:38:08,550 [INFO]: 		-> Add: 3.2 seconds
2025-03-09 08:38:08,550 [INFO]: 		Total: 16.7 minutes
2025-03-09 08:38:08,550 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0001 secs
2025-03-09 08:38:08,550 [INFO]: 	Checking that your have enough memory available to create the index 03/09/2025, 08:38:08
2025-03-09 08:38:08,551 [INFO]: 1.2GB of memory will be needed to build the index (more might be used if you have more)
2025-03-09 08:38:08,551 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0002 secs
2025-03-09 08:38:08,551 [INFO]: 	Selecting most promising index types given data characteristics 03/09/2025, 08:38:08
2025-03-09 08:38:08,551 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-09 08:38:08,551 [INFO]: 	Creating the index 03/09/2025, 08:38:08
2025-03-09 08:38:08,551 [INFO]: 		-> Instanciate the index HNSW15 03/09/2025, 08:38:08
2025-03-09 08:38:08,552 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0013 secs
2025-03-09 08:38:08,552 [INFO]: 		-> Adding the vectors to the index 03/09/2025, 08:38:08
2025-03-09 08:38:08,552 [INFO]: The memory available for adding the vectors is 48.9GB(total available - used by the index)
2025-03-09 08:38:08,552 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/24 [00:00<?, ?it/s]  4%|▍         | 1/24 [00:00<00:02,  8.05it/s]  8%|▊         | 2/24 [00:00<00:03,  6.58it/s] 12%|█▎        | 3/24 [00:00<00:02,  7.39it/s] 21%|██        | 5/24 [00:00<00:01,  9.95it/s] 29%|██▉       | 7/24 [00:00<00:01, 10.93it/s] 38%|███▊      | 9/24 [00:00<00:01, 11.34it/s] 46%|████▌     | 11/24 [00:01<00:01, 11.68it/s] 54%|█████▍    | 13/24 [00:01<00:00, 12.89it/s] 62%|██████▎   | 15/24 [00:01<00:00, 13.47it/s] 71%|███████   | 17/24 [00:01<00:00, 12.96it/s] 79%|███████▉  | 19/24 [00:01<00:00, 12.80it/s] 88%|████████▊ | 21/24 [00:06<00:02,  1.31it/s] 92%|█████████▏| 22/24 [00:06<00:01,  1.54it/s] 96%|█████████▌| 23/24 [00:06<00:00,  1.85it/s]100%|██████████| 24/24 [00:08<00:00,  1.27it/s]100%|██████████| 24/24 [00:08<00:00,  2.95it/s]
2025-03-09 08:38:16,688 [INFO]: 	Computing best hyperparameters for index knn.index 03/09/2025, 08:38:16
2025-03-09 08:39:07,162 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 50.4735 secs
2025-03-09 08:39:07,162 [INFO]: The best hyperparameters are: efSearch=159
2025-03-09 08:39:07,162 [INFO]: 	Compute fast metrics 03/09/2025, 08:39:07
  0%|          | 0/4 [00:00<?, ?it/s] 25%|██▌       | 1/4 [00:00<00:00,  5.19it/s] 50%|█████     | 2/4 [00:00<00:00,  6.71it/s] 75%|███████▌  | 3/4 [00:00<00:00,  7.45it/s] 75%|███████▌  | 3/4 [00:00<00:00,  5.65it/s]
2025-03-09 08:39:27,893 [INFO]: 	>>> Finished "Compute fast metrics" in 20.7306 secs
2025-03-09 08:39:27,894 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 79.3419 secs
2025-03-09 08:39:27,894 [INFO]: {
2025-03-09 08:39:27,894 [INFO]: 	index_key: HNSW15
2025-03-09 08:39:27,894 [INFO]: 	index_param: efSearch=159
2025-03-09 08:39:27,894 [INFO]: 	index_path: knn.index
2025-03-09 08:39:27,894 [INFO]: 	size in bytes: 1130098210
2025-03-09 08:39:27,894 [INFO]: 	avg_search_speed_ms: 9.308874414144586
2025-03-09 08:39:27,894 [INFO]: 	99p_search_speed_ms: 14.293682677671308
2025-03-09 08:39:27,894 [INFO]: 	reconstruction error %: 0.0
2025-03-09 08:39:27,894 [INFO]: 	nb vectors: 5744
2025-03-09 08:39:27,894 [INFO]: 	vectors dimension: 49152
2025-03-09 08:39:27,894 [INFO]: 	compression ratio: 0.9993081503951767
2025-03-09 08:39:27,894 [INFO]: }
2025-03-09 08:39:27,894 [INFO]: 	>>> Finished "Creating the index" in 79.3437 secs
2025-03-09 08:39:27,894 [INFO]: >>> Finished "Launching the whole pipeline" in 79.3740 secs
2025-03-09 08:39:29: [retrieval_preprocessing] calculating distances ...
2025-03-09 08:39:32: [retrieval_preprocessing] finished and saved retrieval indices for episode 58759 [episode count 4/20]
[retrieval_preprocessing] for episode 75015 [episode count 5/20], we have num_retrieval=np.int64(5965) num_query=np.int64(323)
2025-03-09 08:39:33,877 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-09 08:39:34,570 [INFO]: Launching the whole pipeline 03/09/2025, 08:39:34
2025-03-09 08:39:34,570 [INFO]: Reading total number of vectors and dimension 03/09/2025, 08:39:34
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1479.47it/s]
2025-03-09 08:39:34,596 [INFO]: There are 5965 embeddings of dim 49152
2025-03-09 08:39:34,596 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0258 secs
2025-03-09 08:39:34,596 [INFO]: 	Compute estimated construction time of the index 03/09/2025, 08:39:34
2025-03-09 08:39:34,596 [INFO]: 		-> Train: 16.7 minutes
2025-03-09 08:39:34,596 [INFO]: 		-> Add: 3.3 seconds
2025-03-09 08:39:34,596 [INFO]: 		Total: 16.7 minutes
2025-03-09 08:39:34,596 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0001 secs
2025-03-09 08:39:34,596 [INFO]: 	Checking that your have enough memory available to create the index 03/09/2025, 08:39:34
2025-03-09 08:39:34,596 [INFO]: 1.2GB of memory will be needed to build the index (more might be used if you have more)
2025-03-09 08:39:34,596 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0001 secs
2025-03-09 08:39:34,596 [INFO]: 	Selecting most promising index types given data characteristics 03/09/2025, 08:39:34
2025-03-09 08:39:34,596 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-09 08:39:34,596 [INFO]: 	Creating the index 03/09/2025, 08:39:34
2025-03-09 08:39:34,596 [INFO]: 		-> Instanciate the index HNSW15 03/09/2025, 08:39:34
2025-03-09 08:39:34,597 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0009 secs
2025-03-09 08:39:34,597 [INFO]: 		-> Adding the vectors to the index 03/09/2025, 08:39:34
2025-03-09 08:39:34,597 [INFO]: The memory available for adding the vectors is 48.9GB(total available - used by the index)
2025-03-09 08:39:34,597 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/25 [00:00<?, ?it/s]  4%|▍         | 1/25 [00:00<00:04,  5.52it/s] 12%|█▏        | 3/25 [00:00<00:02, 10.02it/s] 20%|██        | 5/25 [00:00<00:01, 11.66it/s] 28%|██▊       | 7/25 [00:00<00:01, 12.15it/s] 36%|███▌      | 9/25 [00:00<00:01, 12.56it/s] 44%|████▍     | 11/25 [00:00<00:01, 12.67it/s] 52%|█████▏    | 13/25 [00:01<00:00, 12.88it/s] 60%|██████    | 15/25 [00:01<00:00, 12.87it/s] 68%|██████▊   | 17/25 [00:01<00:00, 12.96it/s] 76%|███████▌  | 19/25 [00:01<00:00, 12.96it/s] 84%|████████▍ | 21/25 [00:05<00:02,  1.66it/s] 88%|████████▊ | 22/25 [00:05<00:01,  1.94it/s] 96%|█████████▌| 24/25 [00:05<00:00,  2.69it/s]100%|██████████| 25/25 [00:07<00:00,  1.64it/s]100%|██████████| 25/25 [00:07<00:00,  3.57it/s]
2025-03-09 08:39:41,606 [INFO]: 	Computing best hyperparameters for index knn.index 03/09/2025, 08:39:41
2025-03-09 08:40:32,437 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 50.8302 secs
2025-03-09 08:40:32,437 [INFO]: The best hyperparameters are: efSearch=201
2025-03-09 08:40:32,437 [INFO]: 	Compute fast metrics 03/09/2025, 08:40:32
  0%|          | 0/4 [00:00<?, ?it/s] 25%|██▌       | 1/4 [00:00<00:00,  5.02it/s] 50%|█████     | 2/4 [00:00<00:00,  6.57it/s] 75%|███████▌  | 3/4 [00:00<00:00,  7.19it/s] 75%|███████▌  | 3/4 [00:00<00:00,  5.40it/s]
2025-03-09 08:40:55,667 [INFO]: 	>>> Finished "Compute fast metrics" in 23.2297 secs
2025-03-09 08:40:55,668 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 81.0710 secs
2025-03-09 08:40:55,668 [INFO]: {
2025-03-09 08:40:55,669 [INFO]: 	index_key: HNSW15
2025-03-09 08:40:55,669 [INFO]: 	index_param: efSearch=201
2025-03-09 08:40:55,669 [INFO]: 	index_path: knn.index
2025-03-09 08:40:55,669 [INFO]: 	size in bytes: 1173578590
2025-03-09 08:40:55,669 [INFO]: 	avg_search_speed_ms: 12.496717836063695
2025-03-09 08:40:55,669 [INFO]: 	99p_search_speed_ms: 39.7130420897156
2025-03-09 08:40:55,669 [INFO]: 	reconstruction error %: 0.0
2025-03-09 08:40:55,669 [INFO]: 	nb vectors: 5965
2025-03-09 08:40:55,669 [INFO]: 	vectors dimension: 49152
2025-03-09 08:40:55,669 [INFO]: 	compression ratio: 0.9993082099427189
2025-03-09 08:40:55,669 [INFO]: }
2025-03-09 08:40:55,669 [INFO]: 	>>> Finished "Creating the index" in 81.0724 secs
2025-03-09 08:40:55,669 [INFO]: >>> Finished "Launching the whole pipeline" in 81.0988 secs
2025-03-09 08:40:57: [retrieval_preprocessing] calculating distances ...
2025-03-09 08:40:59: [retrieval_preprocessing] finished and saved retrieval indices for episode 75015 [episode count 5/20]
[retrieval_preprocessing] for episode 22537 [episode count 6/20], we have num_retrieval=np.int64(6049) num_query=np.int64(239)
2025-03-09 08:41:00,068 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-09 08:41:01,212 [INFO]: Launching the whole pipeline 03/09/2025, 08:41:01
2025-03-09 08:41:01,212 [INFO]: Reading total number of vectors and dimension 03/09/2025, 08:41:01
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1749.08it/s]
2025-03-09 08:41:01,243 [INFO]: There are 6049 embeddings of dim 49152
2025-03-09 08:41:01,243 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0306 secs
2025-03-09 08:41:01,243 [INFO]: 	Compute estimated construction time of the index 03/09/2025, 08:41:01
2025-03-09 08:41:01,243 [INFO]: 		-> Train: 16.7 minutes
2025-03-09 08:41:01,243 [INFO]: 		-> Add: 3.3 seconds
2025-03-09 08:41:01,243 [INFO]: 		Total: 16.7 minutes
2025-03-09 08:41:01,243 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0001 secs
2025-03-09 08:41:01,243 [INFO]: 	Checking that your have enough memory available to create the index 03/09/2025, 08:41:01
2025-03-09 08:41:01,243 [INFO]: 1.2GB of memory will be needed to build the index (more might be used if you have more)
2025-03-09 08:41:01,243 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0002 secs
2025-03-09 08:41:01,244 [INFO]: 	Selecting most promising index types given data characteristics 03/09/2025, 08:41:01
2025-03-09 08:41:01,244 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-09 08:41:01,244 [INFO]: 	Creating the index 03/09/2025, 08:41:01
2025-03-09 08:41:01,244 [INFO]: 		-> Instanciate the index HNSW15 03/09/2025, 08:41:01
2025-03-09 08:41:01,245 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0013 secs
2025-03-09 08:41:01,245 [INFO]: 		-> Adding the vectors to the index 03/09/2025, 08:41:01
2025-03-09 08:41:01,245 [INFO]: The memory available for adding the vectors is 48.9GB(total available - used by the index)
2025-03-09 08:41:01,245 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/25 [00:00<?, ?it/s]  4%|▍         | 1/25 [00:00<00:03,  6.04it/s] 24%|██▍       | 6/25 [00:00<00:00, 23.08it/s] 44%|████▍     | 11/25 [00:00<00:00, 30.98it/s] 60%|██████    | 15/25 [00:00<00:00, 32.28it/s] 80%|████████  | 20/25 [00:00<00:00, 36.14it/s] 96%|█████████▌| 24/25 [00:05<00:00,  2.64it/s]100%|██████████| 25/25 [00:07<00:00,  3.50it/s]
2025-03-09 08:41:08,390 [INFO]: 	Computing best hyperparameters for index knn.index 03/09/2025, 08:41:08
2025-03-09 08:42:07,632 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 59.2415 secs
2025-03-09 08:42:07,632 [INFO]: The best hyperparameters are: efSearch=145
2025-03-09 08:42:07,632 [INFO]: 	Compute fast metrics 03/09/2025, 08:42:07
  0%|          | 0/4 [00:00<?, ?it/s] 25%|██▌       | 1/4 [00:00<00:00,  6.74it/s] 75%|███████▌  | 3/4 [00:00<00:00, 10.76it/s] 75%|███████▌  | 3/4 [00:00<00:00,  8.04it/s]
2025-03-09 08:42:29,634 [INFO]: 	>>> Finished "Compute fast metrics" in 22.0012 secs
2025-03-09 08:42:29,635 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 88.3902 secs
2025-03-09 08:42:29,636 [INFO]: {
2025-03-09 08:42:29,636 [INFO]: 	index_key: HNSW15
2025-03-09 08:42:29,636 [INFO]: 	index_param: efSearch=145
2025-03-09 08:42:29,636 [INFO]: 	index_path: knn.index
2025-03-09 08:42:29,636 [INFO]: 	size in bytes: 1190105110
2025-03-09 08:42:29,636 [INFO]: 	avg_search_speed_ms: 9.990583562601978
2025-03-09 08:42:29,636 [INFO]: 	99p_search_speed_ms: 19.67583899386227
2025-03-09 08:42:29,636 [INFO]: 	reconstruction error %: 0.0
2025-03-09 08:42:29,636 [INFO]: 	nb vectors: 6049
2025-03-09 08:42:29,636 [INFO]: 	vectors dimension: 49152
2025-03-09 08:42:29,636 [INFO]: 	compression ratio: 0.999308197239822
2025-03-09 08:42:29,636 [INFO]: }
2025-03-09 08:42:29,636 [INFO]: 	>>> Finished "Creating the index" in 88.3921 secs
2025-03-09 08:42:29,636 [INFO]: >>> Finished "Launching the whole pipeline" in 88.4236 secs
2025-03-09 08:42:30: [retrieval_preprocessing] calculating distances ...
2025-03-09 08:42:31: [retrieval_preprocessing] finished and saved retrieval indices for episode 22537 [episode count 6/20]
[retrieval_preprocessing] for episode 5778 [episode count 7/20], we have num_retrieval=np.int64(5881) num_query=np.int64(407)
2025-03-09 08:42:32,444 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-09 08:42:33,418 [INFO]: Launching the whole pipeline 03/09/2025, 08:42:33
2025-03-09 08:42:33,418 [INFO]: Reading total number of vectors and dimension 03/09/2025, 08:42:33
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1102.02it/s]
2025-03-09 08:42:33,452 [INFO]: There are 5881 embeddings of dim 49152
2025-03-09 08:42:33,452 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0336 secs
2025-03-09 08:42:33,452 [INFO]: 	Compute estimated construction time of the index 03/09/2025, 08:42:33
2025-03-09 08:42:33,452 [INFO]: 		-> Train: 16.7 minutes
2025-03-09 08:42:33,452 [INFO]: 		-> Add: 3.2 seconds
2025-03-09 08:42:33,452 [INFO]: 		Total: 16.7 minutes
2025-03-09 08:42:33,452 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0002 secs
2025-03-09 08:42:33,452 [INFO]: 	Checking that your have enough memory available to create the index 03/09/2025, 08:42:33
2025-03-09 08:42:33,453 [INFO]: 1.2GB of memory will be needed to build the index (more might be used if you have more)
2025-03-09 08:42:33,453 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0003 secs
2025-03-09 08:42:33,453 [INFO]: 	Selecting most promising index types given data characteristics 03/09/2025, 08:42:33
2025-03-09 08:42:33,453 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-09 08:42:33,453 [INFO]: 	Creating the index 03/09/2025, 08:42:33
2025-03-09 08:42:33,453 [INFO]: 		-> Instanciate the index HNSW15 03/09/2025, 08:42:33
2025-03-09 08:42:33,454 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0013 secs
2025-03-09 08:42:33,454 [INFO]: 		-> Adding the vectors to the index 03/09/2025, 08:42:33
2025-03-09 08:42:33,454 [INFO]: The memory available for adding the vectors is 48.9GB(total available - used by the index)
2025-03-09 08:42:33,455 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/25 [00:00<?, ?it/s]  4%|▍         | 1/25 [00:00<00:03,  7.01it/s] 28%|██▊       | 7/25 [00:00<00:00, 32.46it/s] 52%|█████▏    | 13/25 [00:00<00:00, 42.59it/s] 76%|███████▌  | 19/25 [00:00<00:00, 46.62it/s] 96%|█████████▌| 24/25 [00:05<00:00,  2.89it/s]100%|██████████| 25/25 [00:07<00:00,  3.49it/s]
2025-03-09 08:42:40,626 [INFO]: 	Computing best hyperparameters for index knn.index 03/09/2025, 08:42:40
2025-03-09 08:43:31,574 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 50.9480 secs
2025-03-09 08:43:31,575 [INFO]: The best hyperparameters are: efSearch=190
2025-03-09 08:43:31,575 [INFO]: 	Compute fast metrics 03/09/2025, 08:43:31
  0%|          | 0/4 [00:00<?, ?it/s] 25%|██▌       | 1/4 [00:00<00:00,  5.79it/s] 50%|█████     | 2/4 [00:00<00:00,  7.20it/s] 75%|███████▌  | 3/4 [00:00<00:00,  7.84it/s] 75%|███████▌  | 3/4 [00:00<00:00,  5.92it/s]
2025-03-09 08:43:51,878 [INFO]: 	>>> Finished "Compute fast metrics" in 20.3032 secs
2025-03-09 08:43:52,428 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 78.9736 secs
2025-03-09 08:43:52,428 [INFO]: {
2025-03-09 08:43:52,429 [INFO]: 	index_key: HNSW15
2025-03-09 08:43:52,429 [INFO]: 	index_param: efSearch=190
2025-03-09 08:43:52,429 [INFO]: 	index_path: knn.index
2025-03-09 08:43:52,429 [INFO]: 	size in bytes: 1157052010
2025-03-09 08:43:52,429 [INFO]: 	avg_search_speed_ms: 12.182437285869389
2025-03-09 08:43:52,429 [INFO]: 	99p_search_speed_ms: 24.964001914486275
2025-03-09 08:43:52,429 [INFO]: 	reconstruction error %: 0.0
2025-03-09 08:43:52,429 [INFO]: 	nb vectors: 5881
2025-03-09 08:43:52,429 [INFO]: 	vectors dimension: 49152
2025-03-09 08:43:52,429 [INFO]: 	compression ratio: 0.9993082748285447
2025-03-09 08:43:52,429 [INFO]: }
2025-03-09 08:43:52,429 [INFO]: 	>>> Finished "Creating the index" in 78.9762 secs
2025-03-09 08:43:52,429 [INFO]: >>> Finished "Launching the whole pipeline" in 79.0109 secs
2025-03-09 08:43:54: [retrieval_preprocessing] calculating distances ...
2025-03-09 08:43:55: [retrieval_preprocessing] finished and saved retrieval indices for episode 5778 [episode count 7/20]
[retrieval_preprocessing] for episode 7828 [episode count 8/20], we have num_retrieval=np.int64(6034) num_query=np.int64(254)
2025-03-09 08:43:57,756 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-09 08:43:58,549 [INFO]: Launching the whole pipeline 03/09/2025, 08:43:58
2025-03-09 08:43:58,549 [INFO]: Reading total number of vectors and dimension 03/09/2025, 08:43:58
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1213.63it/s]
2025-03-09 08:43:58,579 [INFO]: There are 6034 embeddings of dim 49152
2025-03-09 08:43:58,579 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0305 secs
2025-03-09 08:43:58,579 [INFO]: 	Compute estimated construction time of the index 03/09/2025, 08:43:58
2025-03-09 08:43:58,580 [INFO]: 		-> Train: 16.7 minutes
2025-03-09 08:43:58,580 [INFO]: 		-> Add: 3.3 seconds
2025-03-09 08:43:58,580 [INFO]: 		Total: 16.7 minutes
2025-03-09 08:43:58,580 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0002 secs
2025-03-09 08:43:58,580 [INFO]: 	Checking that your have enough memory available to create the index 03/09/2025, 08:43:58
2025-03-09 08:43:58,580 [INFO]: 1.2GB of memory will be needed to build the index (more might be used if you have more)
2025-03-09 08:43:58,580 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0002 secs
2025-03-09 08:43:58,580 [INFO]: 	Selecting most promising index types given data characteristics 03/09/2025, 08:43:58
2025-03-09 08:43:58,580 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-09 08:43:58,580 [INFO]: 	Creating the index 03/09/2025, 08:43:58
2025-03-09 08:43:58,580 [INFO]: 		-> Instanciate the index HNSW15 03/09/2025, 08:43:58
2025-03-09 08:43:58,581 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0012 secs
2025-03-09 08:43:58,581 [INFO]: 		-> Adding the vectors to the index 03/09/2025, 08:43:58
2025-03-09 08:43:58,581 [INFO]: The memory available for adding the vectors is 48.9GB(total available - used by the index)
2025-03-09 08:43:58,582 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/25 [00:00<?, ?it/s]  4%|▍         | 1/25 [00:00<00:05,  4.60it/s]  8%|▊         | 2/25 [00:00<00:03,  6.38it/s] 12%|█▏        | 3/25 [00:00<00:03,  7.29it/s] 16%|█▌        | 4/25 [00:00<00:02,  7.82it/s] 20%|██        | 5/25 [00:00<00:02,  8.07it/s] 24%|██▍       | 6/25 [00:00<00:02,  8.27it/s] 28%|██▊       | 7/25 [00:00<00:02,  8.52it/s] 32%|███▏      | 8/25 [00:01<00:01,  8.60it/s] 36%|███▌      | 9/25 [00:01<00:01,  8.62it/s] 40%|████      | 10/25 [00:01<00:01,  8.53it/s] 44%|████▍     | 11/25 [00:01<00:01,  8.59it/s] 48%|████▊     | 12/25 [00:01<00:01,  8.64it/s] 52%|█████▏    | 13/25 [00:01<00:01,  8.63it/s] 56%|█████▌    | 14/25 [00:01<00:01,  8.59it/s] 64%|██████▍   | 16/25 [00:01<00:00,  9.73it/s] 72%|███████▏  | 18/25 [00:02<00:00, 10.52it/s] 80%|████████  | 20/25 [00:02<00:00, 10.87it/s] 88%|████████▊ | 22/25 [00:06<00:02,  1.23it/s] 96%|█████████▌| 24/25 [00:06<00:00,  1.75it/s]100%|██████████| 25/25 [00:08<00:00,  1.25it/s]100%|██████████| 25/25 [00:08<00:00,  2.92it/s]
2025-03-09 08:44:07,140 [INFO]: 	Computing best hyperparameters for index knn.index 03/09/2025, 08:44:07
2025-03-09 08:44:53,233 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 46.0930 secs
2025-03-09 08:44:53,234 [INFO]: The best hyperparameters are: efSearch=203
2025-03-09 08:44:53,234 [INFO]: 	Compute fast metrics 03/09/2025, 08:44:53
  0%|          | 0/4 [00:00<?, ?it/s] 25%|██▌       | 1/4 [00:00<00:00,  5.99it/s] 75%|███████▌  | 3/4 [00:00<00:00,  9.68it/s] 75%|███████▌  | 3/4 [00:00<00:00,  7.45it/s]
2025-03-09 08:45:19,437 [INFO]: 	>>> Finished "Compute fast metrics" in 26.2033 secs
2025-03-09 08:45:19,438 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 80.8569 secs
2025-03-09 08:45:19,439 [INFO]: {
2025-03-09 08:45:19,439 [INFO]: 	index_key: HNSW15
2025-03-09 08:45:19,439 [INFO]: 	index_param: efSearch=203
2025-03-09 08:45:19,439 [INFO]: 	index_path: knn.index
2025-03-09 08:45:19,439 [INFO]: 	size in bytes: 1187153950
2025-03-09 08:45:19,439 [INFO]: 	avg_search_speed_ms: 10.678532366117059
2025-03-09 08:45:19,439 [INFO]: 	99p_search_speed_ms: 16.57811965793371
2025-03-09 08:45:19,439 [INFO]: 	reconstruction error %: 0.0
2025-03-09 08:45:19,439 [INFO]: 	nb vectors: 6034
2025-03-09 08:45:19,439 [INFO]: 	vectors dimension: 49152
2025-03-09 08:45:19,439 [INFO]: 	compression ratio: 0.9993081958746799
2025-03-09 08:45:19,439 [INFO]: }
2025-03-09 08:45:19,439 [INFO]: 	>>> Finished "Creating the index" in 80.8587 secs
2025-03-09 08:45:19,439 [INFO]: >>> Finished "Launching the whole pipeline" in 80.8900 secs
2025-03-09 08:45:21: [retrieval_preprocessing] calculating distances ...
2025-03-09 08:45:22: [retrieval_preprocessing] finished and saved retrieval indices for episode 7828 [episode count 8/20]
[retrieval_preprocessing] for episode 58775 [episode count 9/20], we have num_retrieval=np.int64(6050) num_query=np.int64(238)
2025-03-09 08:45:24,699 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-09 08:45:25,557 [INFO]: Launching the whole pipeline 03/09/2025, 08:45:25
2025-03-09 08:45:25,557 [INFO]: Reading total number of vectors and dimension 03/09/2025, 08:45:25
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1094.83it/s]
2025-03-09 08:45:25,586 [INFO]: There are 6050 embeddings of dim 49152
2025-03-09 08:45:25,587 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0292 secs
2025-03-09 08:45:25,587 [INFO]: 	Compute estimated construction time of the index 03/09/2025, 08:45:25
2025-03-09 08:45:25,587 [INFO]: 		-> Train: 16.7 minutes
2025-03-09 08:45:25,587 [INFO]: 		-> Add: 3.3 seconds
2025-03-09 08:45:25,587 [INFO]: 		Total: 16.7 minutes
2025-03-09 08:45:25,587 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0002 secs
2025-03-09 08:45:25,587 [INFO]: 	Checking that your have enough memory available to create the index 03/09/2025, 08:45:25
2025-03-09 08:45:25,587 [INFO]: 1.2GB of memory will be needed to build the index (more might be used if you have more)
2025-03-09 08:45:25,587 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0002 secs
2025-03-09 08:45:25,587 [INFO]: 	Selecting most promising index types given data characteristics 03/09/2025, 08:45:25
2025-03-09 08:45:25,587 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-09 08:45:25,587 [INFO]: 	Creating the index 03/09/2025, 08:45:25
2025-03-09 08:45:25,587 [INFO]: 		-> Instanciate the index HNSW15 03/09/2025, 08:45:25
2025-03-09 08:45:25,589 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0013 secs
2025-03-09 08:45:25,589 [INFO]: 		-> Adding the vectors to the index 03/09/2025, 08:45:25
2025-03-09 08:45:25,589 [INFO]: The memory available for adding the vectors is 48.9GB(total available - used by the index)
2025-03-09 08:45:25,589 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/25 [00:00<?, ?it/s]  4%|▍         | 1/25 [00:00<00:04,  4.86it/s]  8%|▊         | 2/25 [00:00<00:03,  6.36it/s] 12%|█▏        | 3/25 [00:00<00:03,  7.04it/s] 16%|█▌        | 4/25 [00:00<00:02,  7.64it/s] 20%|██        | 5/25 [00:00<00:02,  7.83it/s] 24%|██▍       | 6/25 [00:00<00:02,  8.10it/s] 28%|██▊       | 7/25 [00:00<00:02,  8.27it/s] 32%|███▏      | 8/25 [00:01<00:02,  8.14it/s] 36%|███▌      | 9/25 [00:01<00:02,  7.93it/s] 40%|████      | 10/25 [00:01<00:01,  7.89it/s] 44%|████▍     | 11/25 [00:01<00:01,  8.08it/s] 48%|████▊     | 12/25 [00:01<00:01,  8.26it/s] 52%|█████▏    | 13/25 [00:01<00:01,  8.34it/s] 56%|█████▌    | 14/25 [00:01<00:01,  8.29it/s] 64%|██████▍   | 16/25 [00:01<00:00,  9.41it/s] 72%|███████▏  | 18/25 [00:02<00:00, 10.12it/s] 80%|████████  | 20/25 [00:02<00:00, 10.51it/s] 88%|████████▊ | 22/25 [00:06<00:02,  1.18it/s] 96%|█████████▌| 24/25 [00:07<00:00,  1.69it/s]100%|██████████| 25/25 [00:08<00:00,  1.22it/s]100%|██████████| 25/25 [00:08<00:00,  2.83it/s]
2025-03-09 08:45:34,433 [INFO]: 	Computing best hyperparameters for index knn.index 03/09/2025, 08:45:34
2025-03-09 08:46:21,841 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 47.4085 secs
2025-03-09 08:46:21,842 [INFO]: The best hyperparameters are: efSearch=163
2025-03-09 08:46:21,842 [INFO]: 	Compute fast metrics 03/09/2025, 08:46:21
  0%|          | 0/4 [00:00<?, ?it/s] 25%|██▌       | 1/4 [00:00<00:00,  6.69it/s] 75%|███████▌  | 3/4 [00:00<00:00, 10.08it/s] 75%|███████▌  | 3/4 [00:00<00:00,  7.76it/s]
2025-03-09 08:46:41,922 [INFO]: 	>>> Finished "Compute fast metrics" in 20.0799 secs
2025-03-09 08:46:41,923 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 76.3347 secs
2025-03-09 08:46:41,924 [INFO]: {
2025-03-09 08:46:41,924 [INFO]: 	index_key: HNSW15
2025-03-09 08:46:41,924 [INFO]: 	index_param: efSearch=163
2025-03-09 08:46:41,924 [INFO]: 	index_path: knn.index
2025-03-09 08:46:41,924 [INFO]: 	size in bytes: 1190301850
2025-03-09 08:46:41,924 [INFO]: 	avg_search_speed_ms: 9.682380725266295
2025-03-09 08:46:41,924 [INFO]: 	99p_search_speed_ms: 17.693289304152124
2025-03-09 08:46:41,924 [INFO]: 	reconstruction error %: 0.0
2025-03-09 08:46:41,924 [INFO]: 	nb vectors: 6050
2025-03-09 08:46:41,924 [INFO]: 	vectors dimension: 49152
2025-03-09 08:46:41,924 [INFO]: 	compression ratio: 0.999308200688758
2025-03-09 08:46:41,924 [INFO]: }
2025-03-09 08:46:41,924 [INFO]: 	>>> Finished "Creating the index" in 76.3365 secs
2025-03-09 08:46:41,924 [INFO]: >>> Finished "Launching the whole pipeline" in 76.3664 secs
2025-03-09 08:46:42: [retrieval_preprocessing] calculating distances ...
2025-03-09 08:46:43: [retrieval_preprocessing] finished and saved retrieval indices for episode 58775 [episode count 9/20]
[retrieval_preprocessing] for episode 27032 [episode count 10/20], we have num_retrieval=np.int64(6047) num_query=np.int64(241)
2025-03-09 08:46:45,562 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-09 08:46:46,483 [INFO]: Launching the whole pipeline 03/09/2025, 08:46:46
2025-03-09 08:46:46,483 [INFO]: Reading total number of vectors and dimension 03/09/2025, 08:46:46
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 972.25it/s]
2025-03-09 08:46:46,510 [INFO]: There are 6047 embeddings of dim 49152
2025-03-09 08:46:46,510 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0268 secs
2025-03-09 08:46:46,510 [INFO]: 	Compute estimated construction time of the index 03/09/2025, 08:46:46
2025-03-09 08:46:46,510 [INFO]: 		-> Train: 16.7 minutes
2025-03-09 08:46:46,510 [INFO]: 		-> Add: 3.3 seconds
2025-03-09 08:46:46,510 [INFO]: 		Total: 16.7 minutes
2025-03-09 08:46:46,510 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0001 secs
2025-03-09 08:46:46,510 [INFO]: 	Checking that your have enough memory available to create the index 03/09/2025, 08:46:46
2025-03-09 08:46:46,510 [INFO]: 1.2GB of memory will be needed to build the index (more might be used if you have more)
2025-03-09 08:46:46,510 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0001 secs
2025-03-09 08:46:46,510 [INFO]: 	Selecting most promising index types given data characteristics 03/09/2025, 08:46:46
2025-03-09 08:46:46,510 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-09 08:46:46,510 [INFO]: 	Creating the index 03/09/2025, 08:46:46
2025-03-09 08:46:46,510 [INFO]: 		-> Instanciate the index HNSW15 03/09/2025, 08:46:46
2025-03-09 08:46:46,511 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0009 secs
2025-03-09 08:46:46,511 [INFO]: 		-> Adding the vectors to the index 03/09/2025, 08:46:46
2025-03-09 08:46:46,512 [INFO]: The memory available for adding the vectors is 48.9GB(total available - used by the index)
2025-03-09 08:46:46,512 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/25 [00:00<?, ?it/s]  4%|▍         | 1/25 [00:00<00:04,  5.33it/s] 12%|█▏        | 3/25 [00:00<00:02,  8.76it/s] 20%|██        | 5/25 [00:00<00:02,  9.46it/s] 28%|██▊       | 7/25 [00:00<00:01,  9.97it/s] 36%|███▌      | 9/25 [00:00<00:01, 10.40it/s] 44%|████▍     | 11/25 [00:01<00:01, 10.65it/s] 52%|█████▏    | 13/25 [00:01<00:01, 10.88it/s] 60%|██████    | 15/25 [00:01<00:00, 10.97it/s] 68%|██████▊   | 17/25 [00:01<00:00, 11.09it/s] 76%|███████▌  | 19/25 [00:01<00:00, 10.70it/s] 84%|████████▍ | 21/25 [00:05<00:02,  1.45it/s] 92%|█████████▏| 23/25 [00:06<00:01,  1.97it/s]100%|██████████| 25/25 [00:08<00:00,  1.53it/s]100%|██████████| 25/25 [00:08<00:00,  3.10it/s]
2025-03-09 08:46:54,591 [INFO]: 	Computing best hyperparameters for index knn.index 03/09/2025, 08:46:54
2025-03-09 08:47:43,032 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 48.4407 secs
2025-03-09 08:47:43,033 [INFO]: The best hyperparameters are: efSearch=108
2025-03-09 08:47:43,033 [INFO]: 	Compute fast metrics 03/09/2025, 08:47:43
  0%|          | 0/4 [00:00<?, ?it/s] 25%|██▌       | 1/4 [00:00<00:00,  5.20it/s] 50%|█████     | 2/4 [00:00<00:00,  6.65it/s] 75%|███████▌  | 3/4 [00:00<00:00,  7.42it/s] 75%|███████▌  | 3/4 [00:00<00:00,  5.56it/s]
2025-03-09 08:48:05,459 [INFO]: 	>>> Finished "Compute fast metrics" in 22.4265 secs
2025-03-09 08:48:05,461 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 78.9494 secs
2025-03-09 08:48:05,461 [INFO]: {
2025-03-09 08:48:05,461 [INFO]: 	index_key: HNSW15
2025-03-09 08:48:05,461 [INFO]: 	index_param: efSearch=108
2025-03-09 08:48:05,461 [INFO]: 	index_path: knn.index
2025-03-09 08:48:05,461 [INFO]: 	size in bytes: 1189711630
2025-03-09 08:48:05,461 [INFO]: 	avg_search_speed_ms: 7.937895124659795
2025-03-09 08:48:05,461 [INFO]: 	99p_search_speed_ms: 13.860098109580603
2025-03-09 08:48:05,461 [INFO]: 	reconstruction error %: 0.0
2025-03-09 08:48:05,461 [INFO]: 	nb vectors: 6047
2025-03-09 08:48:05,461 [INFO]: 	vectors dimension: 49152
2025-03-09 08:48:05,461 [INFO]: 	compression ratio: 0.9993081903385277
2025-03-09 08:48:05,461 [INFO]: }
2025-03-09 08:48:05,461 [INFO]: 	>>> Finished "Creating the index" in 78.9508 secs
2025-03-09 08:48:05,461 [INFO]: >>> Finished "Launching the whole pipeline" in 78.9781 secs
2025-03-09 08:48:06: [retrieval_preprocessing] calculating distances ...
2025-03-09 08:48:07: [retrieval_preprocessing] finished and saved retrieval indices for episode 27032 [episode count 10/20]
[retrieval_preprocessing] for episode 66559 [episode count 11/20], we have num_retrieval=np.int64(5680) num_query=np.int64(608)
2025-03-09 08:48:09,308 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-09 08:48:10,173 [INFO]: Launching the whole pipeline 03/09/2025, 08:48:10
2025-03-09 08:48:10,174 [INFO]: Reading total number of vectors and dimension 03/09/2025, 08:48:10
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1293.74it/s]
2025-03-09 08:48:10,199 [INFO]: There are 5680 embeddings of dim 49152
2025-03-09 08:48:10,199 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0258 secs
2025-03-09 08:48:10,199 [INFO]: 	Compute estimated construction time of the index 03/09/2025, 08:48:10
2025-03-09 08:48:10,199 [INFO]: 		-> Train: 16.7 minutes
2025-03-09 08:48:10,199 [INFO]: 		-> Add: 3.1 seconds
2025-03-09 08:48:10,199 [INFO]: 		Total: 16.7 minutes
2025-03-09 08:48:10,199 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0001 secs
2025-03-09 08:48:10,200 [INFO]: 	Checking that your have enough memory available to create the index 03/09/2025, 08:48:10
2025-03-09 08:48:10,200 [INFO]: 1.1GB of memory will be needed to build the index (more might be used if you have more)
2025-03-09 08:48:10,200 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0001 secs
2025-03-09 08:48:10,200 [INFO]: 	Selecting most promising index types given data characteristics 03/09/2025, 08:48:10
2025-03-09 08:48:10,200 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-09 08:48:10,200 [INFO]: 	Creating the index 03/09/2025, 08:48:10
2025-03-09 08:48:10,200 [INFO]: 		-> Instanciate the index HNSW15 03/09/2025, 08:48:10
2025-03-09 08:48:10,201 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0010 secs
2025-03-09 08:48:10,201 [INFO]: 		-> Adding the vectors to the index 03/09/2025, 08:48:10
2025-03-09 08:48:10,201 [INFO]: The memory available for adding the vectors is 49.0GB(total available - used by the index)
2025-03-09 08:48:10,201 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/24 [00:00<?, ?it/s]  4%|▍         | 1/24 [00:00<00:04,  5.70it/s] 12%|█▎        | 3/24 [00:00<00:02,  9.01it/s] 21%|██        | 5/24 [00:00<00:01, 10.24it/s] 29%|██▉       | 7/24 [00:00<00:01, 10.95it/s] 38%|███▊      | 9/24 [00:00<00:01, 11.29it/s] 46%|████▌     | 11/24 [00:01<00:01, 11.54it/s] 54%|█████▍    | 13/24 [00:01<00:00, 11.73it/s] 62%|██████▎   | 15/24 [00:01<00:00, 11.51it/s] 71%|███████   | 17/24 [00:01<00:00, 11.70it/s] 79%|███████▉  | 19/24 [00:01<00:00, 11.78it/s] 88%|████████▊ | 21/24 [00:05<00:01,  1.59it/s] 96%|█████████▌| 23/24 [00:05<00:00,  2.15it/s]100%|██████████| 24/24 [00:06<00:00,  1.60it/s]100%|██████████| 24/24 [00:06<00:00,  3.45it/s]
2025-03-09 08:48:17,164 [INFO]: 	Computing best hyperparameters for index knn.index 03/09/2025, 08:48:17
2025-03-09 08:49:01,611 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 44.4463 secs
2025-03-09 08:49:01,611 [INFO]: The best hyperparameters are: efSearch=128
2025-03-09 08:49:01,611 [INFO]: 	Compute fast metrics 03/09/2025, 08:49:01
  0%|          | 0/4 [00:00<?, ?it/s] 25%|██▌       | 1/4 [00:00<00:00,  6.02it/s] 75%|███████▌  | 3/4 [00:00<00:00, 10.11it/s] 75%|███████▌  | 3/4 [00:00<00:00,  7.78it/s]
2025-03-09 08:49:18,441 [INFO]: 	>>> Finished "Compute fast metrics" in 16.8297 secs
2025-03-09 08:49:18,442 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 68.2408 secs
2025-03-09 08:49:18,442 [INFO]: {
2025-03-09 08:49:18,442 [INFO]: 	index_key: HNSW15
2025-03-09 08:49:18,442 [INFO]: 	index_param: efSearch=128
2025-03-09 08:49:18,442 [INFO]: 	index_path: knn.index
2025-03-09 08:49:18,442 [INFO]: 	size in bytes: 1117506670
2025-03-09 08:49:18,442 [INFO]: 	avg_search_speed_ms: 8.037674888538742
2025-03-09 08:49:18,442 [INFO]: 	99p_search_speed_ms: 13.038531935308121
2025-03-09 08:49:18,442 [INFO]: 	reconstruction error %: 0.0
2025-03-09 08:49:18,442 [INFO]: 	nb vectors: 5680
2025-03-09 08:49:18,442 [INFO]: 	vectors dimension: 49152
2025-03-09 08:49:18,442 [INFO]: 	compression ratio: 0.9993080757182415
2025-03-09 08:49:18,442 [INFO]: }
2025-03-09 08:49:18,442 [INFO]: 	>>> Finished "Creating the index" in 68.2422 secs
2025-03-09 08:49:18,442 [INFO]: >>> Finished "Launching the whole pipeline" in 68.2686 secs
2025-03-09 08:49:19: [retrieval_preprocessing] calculating distances ...
2025-03-09 08:49:22: [retrieval_preprocessing] finished and saved retrieval indices for episode 66559 [episode count 11/20]
[retrieval_preprocessing] for episode 38173 [episode count 12/20], we have num_retrieval=np.int64(5977) num_query=np.int64(311)
2025-03-09 08:49:24,269 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-09 08:49:25,098 [INFO]: Launching the whole pipeline 03/09/2025, 08:49:25
2025-03-09 08:49:25,098 [INFO]: Reading total number of vectors and dimension 03/09/2025, 08:49:25
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1425.18it/s]
2025-03-09 08:49:25,129 [INFO]: There are 5977 embeddings of dim 49152
2025-03-09 08:49:25,130 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0314 secs
2025-03-09 08:49:25,130 [INFO]: 	Compute estimated construction time of the index 03/09/2025, 08:49:25
2025-03-09 08:49:25,130 [INFO]: 		-> Train: 16.7 minutes
2025-03-09 08:49:25,131 [INFO]: 		-> Add: 3.3 seconds
2025-03-09 08:49:25,131 [INFO]: 		Total: 16.7 minutes
2025-03-09 08:49:25,131 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0006 secs
2025-03-09 08:49:25,131 [INFO]: 	Checking that your have enough memory available to create the index 03/09/2025, 08:49:25
2025-03-09 08:49:25,131 [INFO]: 1.2GB of memory will be needed to build the index (more might be used if you have more)
2025-03-09 08:49:25,132 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0005 secs
2025-03-09 08:49:25,132 [INFO]: 	Selecting most promising index types given data characteristics 03/09/2025, 08:49:25
2025-03-09 08:49:25,132 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-09 08:49:25,132 [INFO]: 	Creating the index 03/09/2025, 08:49:25
2025-03-09 08:49:25,132 [INFO]: 		-> Instanciate the index HNSW15 03/09/2025, 08:49:25
2025-03-09 08:49:25,135 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0030 secs
2025-03-09 08:49:25,135 [INFO]: 		-> Adding the vectors to the index 03/09/2025, 08:49:25
2025-03-09 08:49:25,136 [INFO]: The memory available for adding the vectors is 48.9GB(total available - used by the index)
2025-03-09 08:49:25,136 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/25 [00:00<?, ?it/s]  4%|▍         | 1/25 [00:00<00:04,  5.46it/s] 12%|█▏        | 3/25 [00:00<00:02,  9.33it/s] 20%|██        | 5/25 [00:00<00:01, 10.65it/s] 28%|██▊       | 7/25 [00:00<00:01, 11.38it/s] 36%|███▌      | 9/25 [00:00<00:01, 11.74it/s] 44%|████▍     | 11/25 [00:00<00:01, 11.96it/s] 52%|█████▏    | 13/25 [00:01<00:01, 11.94it/s] 60%|██████    | 15/25 [00:01<00:00, 11.95it/s] 68%|██████▊   | 17/25 [00:01<00:00, 12.17it/s] 76%|███████▌  | 19/25 [00:01<00:00, 12.25it/s] 84%|████████▍ | 21/25 [00:05<00:02,  1.65it/s] 92%|█████████▏| 23/25 [00:05<00:00,  2.23it/s]100%|██████████| 25/25 [00:07<00:00,  1.71it/s]100%|██████████| 25/25 [00:07<00:00,  3.47it/s]
2025-03-09 08:49:32,343 [INFO]: 	Computing best hyperparameters for index knn.index 03/09/2025, 08:49:32
2025-03-09 08:50:17,233 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 44.8894 secs
2025-03-09 08:50:17,233 [INFO]: The best hyperparameters are: efSearch=147
2025-03-09 08:50:17,233 [INFO]: 	Compute fast metrics 03/09/2025, 08:50:17
  0%|          | 0/4 [00:00<?, ?it/s] 25%|██▌       | 1/4 [00:00<00:00,  5.16it/s] 50%|█████     | 2/4 [00:00<00:00,  6.74it/s] 75%|███████▌  | 3/4 [00:00<00:00,  7.43it/s] 75%|███████▌  | 3/4 [00:00<00:00,  5.60it/s]
2025-03-09 08:50:34,994 [INFO]: 	>>> Finished "Compute fast metrics" in 17.7605 secs
2025-03-09 08:50:34,995 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 69.8594 secs
2025-03-09 08:50:34,995 [INFO]: {
2025-03-09 08:50:34,995 [INFO]: 	index_key: HNSW15
2025-03-09 08:50:34,995 [INFO]: 	index_param: efSearch=147
2025-03-09 08:50:34,995 [INFO]: 	index_path: knn.index
2025-03-09 08:50:34,995 [INFO]: 	size in bytes: 1175939470
2025-03-09 08:50:34,995 [INFO]: 	avg_search_speed_ms: 9.86177547875226
2025-03-09 08:50:34,995 [INFO]: 	99p_search_speed_ms: 16.948470778297633
2025-03-09 08:50:34,995 [INFO]: 	reconstruction error %: 0.0
2025-03-09 08:50:34,995 [INFO]: 	nb vectors: 5977
2025-03-09 08:50:34,995 [INFO]: 	vectors dimension: 49152
2025-03-09 08:50:34,995 [INFO]: 	compression ratio: 0.9993082518099338
2025-03-09 08:50:34,995 [INFO]: }
2025-03-09 08:50:34,995 [INFO]: 	>>> Finished "Creating the index" in 69.8632 secs
2025-03-09 08:50:34,995 [INFO]: >>> Finished "Launching the whole pipeline" in 69.8967 secs
2025-03-09 08:50:36: [retrieval_preprocessing] calculating distances ...
2025-03-09 08:50:37: [retrieval_preprocessing] finished and saved retrieval indices for episode 38173 [episode count 12/20]
[retrieval_preprocessing] for episode 58014 [episode count 13/20], we have num_retrieval=np.int64(6122) num_query=np.int64(166)
2025-03-09 08:50:38,884 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-09 08:50:39,713 [INFO]: Launching the whole pipeline 03/09/2025, 08:50:39
2025-03-09 08:50:39,713 [INFO]: Reading total number of vectors and dimension 03/09/2025, 08:50:39
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1999.19it/s]
2025-03-09 08:50:39,737 [INFO]: There are 6122 embeddings of dim 49152
2025-03-09 08:50:39,737 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0237 secs
2025-03-09 08:50:39,737 [INFO]: 	Compute estimated construction time of the index 03/09/2025, 08:50:39
2025-03-09 08:50:39,737 [INFO]: 		-> Train: 16.7 minutes
2025-03-09 08:50:39,737 [INFO]: 		-> Add: 3.4 seconds
2025-03-09 08:50:39,737 [INFO]: 		Total: 16.7 minutes
2025-03-09 08:50:39,737 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0001 secs
2025-03-09 08:50:39,737 [INFO]: 	Checking that your have enough memory available to create the index 03/09/2025, 08:50:39
2025-03-09 08:50:39,737 [INFO]: 1.2GB of memory will be needed to build the index (more might be used if you have more)
2025-03-09 08:50:39,737 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0001 secs
2025-03-09 08:50:39,737 [INFO]: 	Selecting most promising index types given data characteristics 03/09/2025, 08:50:39
2025-03-09 08:50:39,737 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-09 08:50:39,737 [INFO]: 	Creating the index 03/09/2025, 08:50:39
2025-03-09 08:50:39,737 [INFO]: 		-> Instanciate the index HNSW15 03/09/2025, 08:50:39
2025-03-09 08:50:39,738 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0009 secs
2025-03-09 08:50:39,738 [INFO]: 		-> Adding the vectors to the index 03/09/2025, 08:50:39
2025-03-09 08:50:39,738 [INFO]: The memory available for adding the vectors is 48.9GB(total available - used by the index)
2025-03-09 08:50:39,738 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/26 [00:00<?, ?it/s]  4%|▍         | 1/26 [00:00<00:04,  5.10it/s] 12%|█▏        | 3/26 [00:00<00:02,  9.17it/s] 19%|█▉        | 5/26 [00:00<00:01, 10.67it/s] 27%|██▋       | 7/26 [00:00<00:01, 10.80it/s] 35%|███▍      | 9/26 [00:00<00:01, 10.70it/s] 42%|████▏     | 11/26 [00:01<00:01, 10.59it/s] 50%|█████     | 13/26 [00:01<00:01, 10.70it/s] 58%|█████▊    | 15/26 [00:01<00:01, 10.61it/s] 65%|██████▌   | 17/26 [00:01<00:00, 10.72it/s] 73%|███████▎  | 19/26 [00:01<00:00, 10.76it/s] 81%|████████  | 21/26 [00:05<00:03,  1.44it/s] 88%|████████▊ | 23/26 [00:06<00:01,  1.96it/s] 96%|█████████▌| 25/26 [00:06<00:00,  2.64it/s]100%|██████████| 26/26 [00:08<00:00,  1.50it/s]100%|██████████| 26/26 [00:08<00:00,  3.15it/s]
2025-03-09 08:50:47,991 [INFO]: 	Computing best hyperparameters for index knn.index 03/09/2025, 08:50:47
2025-03-09 08:51:40,280 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 52.2892 secs
2025-03-09 08:51:40,281 [INFO]: The best hyperparameters are: efSearch=178
2025-03-09 08:51:40,281 [INFO]: 	Compute fast metrics 03/09/2025, 08:51:40
  0%|          | 0/4 [00:00<?, ?it/s] 25%|██▌       | 1/4 [00:00<00:00,  3.48it/s] 50%|█████     | 2/4 [00:00<00:00,  4.59it/s] 75%|███████▌  | 3/4 [00:00<00:00,  5.93it/s] 75%|███████▌  | 3/4 [00:00<00:00,  4.50it/s]
2025-03-09 08:51:58,701 [INFO]: 	>>> Finished "Compute fast metrics" in 18.4202 secs
2025-03-09 08:51:58,702 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 78.9639 secs
2025-03-09 08:51:58,702 [INFO]: {
2025-03-09 08:51:58,702 [INFO]: 	index_key: HNSW15
2025-03-09 08:51:58,702 [INFO]: 	index_param: efSearch=178
2025-03-09 08:51:58,702 [INFO]: 	index_path: knn.index
2025-03-09 08:51:58,702 [INFO]: 	size in bytes: 1204467370
2025-03-09 08:51:58,702 [INFO]: 	avg_search_speed_ms: 10.920451712280137
2025-03-09 08:51:58,702 [INFO]: 	99p_search_speed_ms: 18.08850330999121
2025-03-09 08:51:58,702 [INFO]: 	reconstruction error %: 0.0
2025-03-09 08:51:58,702 [INFO]: 	nb vectors: 6122
2025-03-09 08:51:58,703 [INFO]: 	vectors dimension: 49152
2025-03-09 08:51:58,703 [INFO]: 	compression ratio: 0.9993082469307575
2025-03-09 08:51:58,703 [INFO]: }
2025-03-09 08:51:58,703 [INFO]: 	>>> Finished "Creating the index" in 78.9653 secs
2025-03-09 08:51:58,703 [INFO]: >>> Finished "Launching the whole pipeline" in 78.9895 secs
2025-03-09 08:51:59: [retrieval_preprocessing] calculating distances ...
2025-03-09 08:52:00: [retrieval_preprocessing] finished and saved retrieval indices for episode 58014 [episode count 13/20]
[retrieval_preprocessing] for episode 73631 [episode count 14/20], we have num_retrieval=np.int64(5895) num_query=np.int64(393)
2025-03-09 08:52:02,071 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-09 08:52:02,846 [INFO]: Launching the whole pipeline 03/09/2025, 08:52:02
2025-03-09 08:52:02,846 [INFO]: Reading total number of vectors and dimension 03/09/2025, 08:52:02
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1259.93it/s]
2025-03-09 08:52:02,873 [INFO]: There are 5895 embeddings of dim 49152
2025-03-09 08:52:02,873 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0267 secs
2025-03-09 08:52:02,873 [INFO]: 	Compute estimated construction time of the index 03/09/2025, 08:52:02
2025-03-09 08:52:02,873 [INFO]: 		-> Train: 16.7 minutes
2025-03-09 08:52:02,873 [INFO]: 		-> Add: 3.2 seconds
2025-03-09 08:52:02,873 [INFO]: 		Total: 16.7 minutes
2025-03-09 08:52:02,873 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0001 secs
2025-03-09 08:52:02,873 [INFO]: 	Checking that your have enough memory available to create the index 03/09/2025, 08:52:02
2025-03-09 08:52:02,873 [INFO]: 1.2GB of memory will be needed to build the index (more might be used if you have more)
2025-03-09 08:52:02,874 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0001 secs
2025-03-09 08:52:02,874 [INFO]: 	Selecting most promising index types given data characteristics 03/09/2025, 08:52:02
2025-03-09 08:52:02,874 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-09 08:52:02,874 [INFO]: 	Creating the index 03/09/2025, 08:52:02
2025-03-09 08:52:02,874 [INFO]: 		-> Instanciate the index HNSW15 03/09/2025, 08:52:02
2025-03-09 08:52:02,875 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0011 secs
2025-03-09 08:52:02,875 [INFO]: 		-> Adding the vectors to the index 03/09/2025, 08:52:02
2025-03-09 08:52:02,875 [INFO]: The memory available for adding the vectors is 48.9GB(total available - used by the index)
2025-03-09 08:52:02,875 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/25 [00:00<?, ?it/s]  4%|▍         | 1/25 [00:00<00:04,  5.68it/s] 12%|█▏        | 3/25 [00:00<00:02,  9.50it/s] 20%|██        | 5/25 [00:00<00:01, 10.83it/s] 28%|██▊       | 7/25 [00:00<00:01, 11.54it/s] 36%|███▌      | 9/25 [00:00<00:01, 11.88it/s] 44%|████▍     | 11/25 [00:00<00:01, 12.07it/s] 52%|█████▏    | 13/25 [00:01<00:00, 12.16it/s] 60%|██████    | 15/25 [00:01<00:00, 12.37it/s] 68%|██████▊   | 17/25 [00:01<00:00, 12.57it/s] 76%|███████▌  | 19/25 [00:01<00:00, 12.64it/s] 84%|████████▍ | 21/25 [00:05<00:02,  1.41it/s] 92%|█████████▏| 23/25 [00:06<00:01,  1.92it/s]100%|██████████| 25/25 [00:07<00:00,  1.60it/s]100%|██████████| 25/25 [00:07<00:00,  3.22it/s]
2025-03-09 08:52:10,650 [INFO]: 	Computing best hyperparameters for index knn.index 03/09/2025, 08:52:10
2025-03-09 08:52:56,511 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 45.8603 secs
2025-03-09 08:52:56,511 [INFO]: The best hyperparameters are: efSearch=187
2025-03-09 08:52:56,511 [INFO]: 	Compute fast metrics 03/09/2025, 08:52:56
  0%|          | 0/4 [00:00<?, ?it/s] 25%|██▌       | 1/4 [00:00<00:00,  5.45it/s] 75%|███████▌  | 3/4 [00:00<00:00,  8.47it/s] 75%|███████▌  | 3/4 [00:00<00:00,  6.41it/s]
2025-03-09 08:53:16,479 [INFO]: 	>>> Finished "Compute fast metrics" in 19.9674 secs
2025-03-09 08:53:16,480 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 73.6051 secs
2025-03-09 08:53:16,480 [INFO]: {
2025-03-09 08:53:16,480 [INFO]: 	index_key: HNSW15
2025-03-09 08:53:16,480 [INFO]: 	index_param: efSearch=187
2025-03-09 08:53:16,480 [INFO]: 	index_path: knn.index
2025-03-09 08:53:16,480 [INFO]: 	size in bytes: 1159806490
2025-03-09 08:53:16,480 [INFO]: 	avg_search_speed_ms: 12.33021609724009
2025-03-09 08:53:16,480 [INFO]: 	99p_search_speed_ms: 22.237092186696824
2025-03-09 08:53:16,480 [INFO]: 	reconstruction error %: 0.0
2025-03-09 08:53:16,480 [INFO]: 	nb vectors: 5895
2025-03-09 08:53:16,480 [INFO]: 	vectors dimension: 49152
2025-03-09 08:53:16,480 [INFO]: 	compression ratio: 0.9993082208050069
2025-03-09 08:53:16,480 [INFO]: }
2025-03-09 08:53:16,480 [INFO]: 	>>> Finished "Creating the index" in 73.6067 secs
2025-03-09 08:53:16,480 [INFO]: >>> Finished "Launching the whole pipeline" in 73.6339 secs
2025-03-09 08:53:18: [retrieval_preprocessing] calculating distances ...
2025-03-09 08:53:19: [retrieval_preprocessing] finished and saved retrieval indices for episode 73631 [episode count 14/20]
[retrieval_preprocessing] for episode 87969 [episode count 15/20], we have num_retrieval=np.int64(5998) num_query=np.int64(290)
2025-03-09 08:53:21,543 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-09 08:53:22,307 [INFO]: Launching the whole pipeline 03/09/2025, 08:53:22
2025-03-09 08:53:22,308 [INFO]: Reading total number of vectors and dimension 03/09/2025, 08:53:22
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1135.74it/s]
2025-03-09 08:53:22,334 [INFO]: There are 5998 embeddings of dim 49152
2025-03-09 08:53:22,335 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0271 secs
2025-03-09 08:53:22,335 [INFO]: 	Compute estimated construction time of the index 03/09/2025, 08:53:22
2025-03-09 08:53:22,335 [INFO]: 		-> Train: 16.7 minutes
2025-03-09 08:53:22,335 [INFO]: 		-> Add: 3.3 seconds
2025-03-09 08:53:22,335 [INFO]: 		Total: 16.7 minutes
2025-03-09 08:53:22,335 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0001 secs
2025-03-09 08:53:22,335 [INFO]: 	Checking that your have enough memory available to create the index 03/09/2025, 08:53:22
2025-03-09 08:53:22,335 [INFO]: 1.2GB of memory will be needed to build the index (more might be used if you have more)
2025-03-09 08:53:22,335 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0002 secs
2025-03-09 08:53:22,335 [INFO]: 	Selecting most promising index types given data characteristics 03/09/2025, 08:53:22
2025-03-09 08:53:22,335 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-09 08:53:22,335 [INFO]: 	Creating the index 03/09/2025, 08:53:22
2025-03-09 08:53:22,335 [INFO]: 		-> Instanciate the index HNSW15 03/09/2025, 08:53:22
2025-03-09 08:53:22,336 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0011 secs
2025-03-09 08:53:22,336 [INFO]: 		-> Adding the vectors to the index 03/09/2025, 08:53:22
2025-03-09 08:53:22,337 [INFO]: The memory available for adding the vectors is 48.9GB(total available - used by the index)
2025-03-09 08:53:22,337 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/25 [00:00<?, ?it/s]  4%|▍         | 1/25 [00:00<00:04,  5.93it/s] 12%|█▏        | 3/25 [00:00<00:02,  9.96it/s] 20%|██        | 5/25 [00:00<00:01, 11.27it/s] 28%|██▊       | 7/25 [00:00<00:01, 11.96it/s] 36%|███▌      | 9/25 [00:00<00:01, 12.44it/s] 44%|████▍     | 11/25 [00:00<00:01, 12.54it/s] 52%|█████▏    | 13/25 [00:01<00:00, 12.57it/s] 60%|██████    | 15/25 [00:01<00:00, 12.58it/s] 68%|██████▊   | 17/25 [00:01<00:00, 12.69it/s] 76%|███████▌  | 19/25 [00:01<00:00, 12.40it/s] 84%|████████▍ | 21/25 [00:06<00:02,  1.36it/s] 92%|█████████▏| 23/25 [00:06<00:01,  1.86it/s]100%|██████████| 25/25 [00:08<00:00,  1.51it/s]100%|██████████| 25/25 [00:08<00:00,  3.09it/s]
2025-03-09 08:53:30,427 [INFO]: 	Computing best hyperparameters for index knn.index 03/09/2025, 08:53:30
2025-03-09 08:54:21,262 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 50.8344 secs
2025-03-09 08:54:21,262 [INFO]: The best hyperparameters are: efSearch=168
2025-03-09 08:54:21,263 [INFO]: 	Compute fast metrics 03/09/2025, 08:54:21
  0%|          | 0/4 [00:00<?, ?it/s] 25%|██▌       | 1/4 [00:00<00:00,  5.54it/s] 50%|█████     | 2/4 [00:00<00:00,  7.16it/s] 75%|███████▌  | 3/4 [00:00<00:00,  7.58it/s] 75%|███████▌  | 3/4 [00:00<00:00,  5.65it/s]
2025-03-09 08:54:48,873 [INFO]: 	>>> Finished "Compute fast metrics" in 27.6099 secs
2025-03-09 08:54:48,874 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 86.5371 secs
2025-03-09 08:54:48,874 [INFO]: {
2025-03-09 08:54:48,874 [INFO]: 	index_key: HNSW15
2025-03-09 08:54:48,874 [INFO]: 	index_param: efSearch=168
2025-03-09 08:54:48,874 [INFO]: 	index_path: knn.index
2025-03-09 08:54:48,874 [INFO]: 	size in bytes: 1180071070
2025-03-09 08:54:48,874 [INFO]: 	avg_search_speed_ms: 10.680869652274756
2025-03-09 08:54:48,874 [INFO]: 	99p_search_speed_ms: 20.614075672347088
2025-03-09 08:54:48,874 [INFO]: 	reconstruction error %: 0.0
2025-03-09 08:54:48,874 [INFO]: 	nb vectors: 5998
2025-03-09 08:54:48,874 [INFO]: 	vectors dimension: 49152
2025-03-09 08:54:48,874 [INFO]: 	compression ratio: 0.9993082738652342
2025-03-09 08:54:48,874 [INFO]: }
2025-03-09 08:54:48,874 [INFO]: 	>>> Finished "Creating the index" in 86.5387 secs
2025-03-09 08:54:48,874 [INFO]: >>> Finished "Launching the whole pipeline" in 86.5664 secs
2025-03-09 08:54:49: [retrieval_preprocessing] calculating distances ...
2025-03-09 08:54:51: [retrieval_preprocessing] finished and saved retrieval indices for episode 87969 [episode count 15/20]
[retrieval_preprocessing] for episode 547 [episode count 16/20], we have num_retrieval=np.int64(6083) num_query=np.int64(205)
2025-03-09 08:54:52,688 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-09 08:54:53,540 [INFO]: Launching the whole pipeline 03/09/2025, 08:54:53
2025-03-09 08:54:53,540 [INFO]: Reading total number of vectors and dimension 03/09/2025, 08:54:53
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1482.61it/s]
2025-03-09 08:54:53,569 [INFO]: There are 6083 embeddings of dim 49152
2025-03-09 08:54:53,570 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0296 secs
2025-03-09 08:54:53,570 [INFO]: 	Compute estimated construction time of the index 03/09/2025, 08:54:53
2025-03-09 08:54:53,570 [INFO]: 		-> Train: 16.7 minutes
2025-03-09 08:54:53,571 [INFO]: 		-> Add: 3.3 seconds
2025-03-09 08:54:53,571 [INFO]: 		Total: 16.7 minutes
2025-03-09 08:54:53,571 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0004 secs
2025-03-09 08:54:53,571 [INFO]: 	Checking that your have enough memory available to create the index 03/09/2025, 08:54:53
2025-03-09 08:54:53,571 [INFO]: 1.2GB of memory will be needed to build the index (more might be used if you have more)
2025-03-09 08:54:53,571 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0005 secs
2025-03-09 08:54:53,572 [INFO]: 	Selecting most promising index types given data characteristics 03/09/2025, 08:54:53
2025-03-09 08:54:53,572 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-09 08:54:53,572 [INFO]: 	Creating the index 03/09/2025, 08:54:53
2025-03-09 08:54:53,572 [INFO]: 		-> Instanciate the index HNSW15 03/09/2025, 08:54:53
2025-03-09 08:54:53,575 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0026 secs
2025-03-09 08:54:53,575 [INFO]: 		-> Adding the vectors to the index 03/09/2025, 08:54:53
2025-03-09 08:54:53,575 [INFO]: The memory available for adding the vectors is 48.9GB(total available - used by the index)
2025-03-09 08:54:53,575 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/25 [00:00<?, ?it/s]  4%|▍         | 1/25 [00:00<00:04,  5.69it/s] 12%|█▏        | 3/25 [00:00<00:02,  9.21it/s] 20%|██        | 5/25 [00:00<00:01, 10.52it/s] 28%|██▊       | 7/25 [00:00<00:01, 11.60it/s] 36%|███▌      | 9/25 [00:00<00:01, 12.14it/s] 44%|████▍     | 11/25 [00:00<00:01, 12.45it/s] 52%|█████▏    | 13/25 [00:01<00:00, 12.65it/s] 60%|██████    | 15/25 [00:01<00:00, 12.75it/s] 68%|██████▊   | 17/25 [00:01<00:00, 12.87it/s] 76%|███████▌  | 19/25 [00:01<00:00, 13.83it/s] 84%|████████▍ | 21/25 [00:06<00:03,  1.28it/s] 92%|█████████▏| 23/25 [00:06<00:01,  1.77it/s]100%|██████████| 25/25 [00:08<00:00,  1.39it/s]100%|██████████| 25/25 [00:08<00:00,  2.91it/s]
2025-03-09 08:55:02,164 [INFO]: 	Computing best hyperparameters for index knn.index 03/09/2025, 08:55:02
2025-03-09 08:55:51,599 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 49.4347 secs
2025-03-09 08:55:51,599 [INFO]: The best hyperparameters are: efSearch=151
2025-03-09 08:55:51,599 [INFO]: 	Compute fast metrics 03/09/2025, 08:55:51
  0%|          | 0/4 [00:00<?, ?it/s] 25%|██▌       | 1/4 [00:00<00:00,  6.20it/s] 50%|█████     | 2/4 [00:00<00:00,  7.50it/s] 75%|███████▌  | 3/4 [00:00<00:00,  7.98it/s] 75%|███████▌  | 3/4 [00:00<00:00,  6.05it/s]
2025-03-09 08:56:09,257 [INFO]: 	>>> Finished "Compute fast metrics" in 17.6574 secs
2025-03-09 08:56:09,258 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 75.6830 secs
2025-03-09 08:56:09,258 [INFO]: {
2025-03-09 08:56:09,258 [INFO]: 	index_key: HNSW15
2025-03-09 08:56:09,258 [INFO]: 	index_param: efSearch=151
2025-03-09 08:56:09,258 [INFO]: 	index_path: knn.index
2025-03-09 08:56:09,258 [INFO]: 	size in bytes: 1196794450
2025-03-09 08:56:09,258 [INFO]: 	avg_search_speed_ms: 8.639745433374518
2025-03-09 08:56:09,258 [INFO]: 	99p_search_speed_ms: 16.200032215565468
2025-03-09 08:56:09,258 [INFO]: 	reconstruction error %: 0.0
2025-03-09 08:56:09,258 [INFO]: 	nb vectors: 6083
2025-03-09 08:56:09,258 [INFO]: 	vectors dimension: 49152
2025-03-09 08:56:09,258 [INFO]: 	compression ratio: 0.9993081635697759
2025-03-09 08:56:09,258 [INFO]: }
2025-03-09 08:56:09,258 [INFO]: 	>>> Finished "Creating the index" in 75.6865 secs
2025-03-09 08:56:09,258 [INFO]: >>> Finished "Launching the whole pipeline" in 75.7180 secs
2025-03-09 08:56:10: [retrieval_preprocessing] calculating distances ...
2025-03-09 08:56:11: [retrieval_preprocessing] finished and saved retrieval indices for episode 547 [episode count 16/20]
[retrieval_preprocessing] for episode 52260 [episode count 17/20], we have num_retrieval=np.int64(5976) num_query=np.int64(312)
2025-03-09 08:56:13,155 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-09 08:56:13,960 [INFO]: Launching the whole pipeline 03/09/2025, 08:56:13
2025-03-09 08:56:13,960 [INFO]: Reading total number of vectors and dimension 03/09/2025, 08:56:13
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1232.89it/s]
2025-03-09 08:56:13,985 [INFO]: There are 5976 embeddings of dim 49152
2025-03-09 08:56:13,986 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0256 secs
2025-03-09 08:56:13,986 [INFO]: 	Compute estimated construction time of the index 03/09/2025, 08:56:13
2025-03-09 08:56:13,986 [INFO]: 		-> Train: 16.7 minutes
2025-03-09 08:56:13,986 [INFO]: 		-> Add: 3.3 seconds
2025-03-09 08:56:13,986 [INFO]: 		Total: 16.7 minutes
2025-03-09 08:56:13,986 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0001 secs
2025-03-09 08:56:13,986 [INFO]: 	Checking that your have enough memory available to create the index 03/09/2025, 08:56:13
2025-03-09 08:56:13,986 [INFO]: 1.2GB of memory will be needed to build the index (more might be used if you have more)
2025-03-09 08:56:13,986 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0001 secs
2025-03-09 08:56:13,986 [INFO]: 	Selecting most promising index types given data characteristics 03/09/2025, 08:56:13
2025-03-09 08:56:13,986 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-09 08:56:13,986 [INFO]: 	Creating the index 03/09/2025, 08:56:13
2025-03-09 08:56:13,986 [INFO]: 		-> Instanciate the index HNSW15 03/09/2025, 08:56:13
2025-03-09 08:56:13,987 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0011 secs
2025-03-09 08:56:13,987 [INFO]: 		-> Adding the vectors to the index 03/09/2025, 08:56:13
2025-03-09 08:56:13,987 [INFO]: The memory available for adding the vectors is 48.9GB(total available - used by the index)
2025-03-09 08:56:13,987 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/25 [00:00<?, ?it/s]  4%|▍         | 1/25 [00:00<00:05,  4.55it/s] 12%|█▏        | 3/25 [00:00<00:02,  8.43it/s] 20%|██        | 5/25 [00:00<00:01, 10.32it/s] 28%|██▊       | 7/25 [00:00<00:01, 11.01it/s] 36%|███▌      | 9/25 [00:00<00:01, 10.29it/s] 44%|████▍     | 11/25 [00:01<00:01, 10.21it/s] 52%|█████▏    | 13/25 [00:01<00:01, 10.36it/s] 60%|██████    | 15/25 [00:01<00:00, 10.57it/s] 68%|██████▊   | 17/25 [00:01<00:00, 11.04it/s] 76%|███████▌  | 19/25 [00:01<00:00, 11.91it/s] 84%|████████▍ | 21/25 [00:05<00:02,  1.60it/s] 92%|█████████▏| 23/25 [00:05<00:00,  2.17it/s]100%|██████████| 25/25 [00:07<00:00,  1.73it/s]100%|██████████| 25/25 [00:07<00:00,  3.40it/s]
2025-03-09 08:56:21,336 [INFO]: 	Computing best hyperparameters for index knn.index 03/09/2025, 08:56:21
2025-03-09 08:57:10,261 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 48.9243 secs
2025-03-09 08:57:10,261 [INFO]: The best hyperparameters are: efSearch=208
2025-03-09 08:57:10,261 [INFO]: 	Compute fast metrics 03/09/2025, 08:57:10
  0%|          | 0/4 [00:00<?, ?it/s] 25%|██▌       | 1/4 [00:00<00:00,  5.03it/s] 50%|█████     | 2/4 [00:00<00:00,  6.81it/s] 75%|███████▌  | 3/4 [00:00<00:00,  7.59it/s] 75%|███████▌  | 3/4 [00:00<00:00,  5.66it/s]
2025-03-09 08:57:35,257 [INFO]: 	>>> Finished "Compute fast metrics" in 24.9955 secs
2025-03-09 08:57:35,258 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 81.2705 secs
2025-03-09 08:57:35,258 [INFO]: {
2025-03-09 08:57:35,258 [INFO]: 	index_key: HNSW15
2025-03-09 08:57:35,258 [INFO]: 	index_param: efSearch=208
2025-03-09 08:57:35,258 [INFO]: 	index_path: knn.index
2025-03-09 08:57:35,258 [INFO]: 	size in bytes: 1175742730
2025-03-09 08:57:35,258 [INFO]: 	avg_search_speed_ms: 11.73717747857803
2025-03-09 08:57:35,258 [INFO]: 	99p_search_speed_ms: 19.43088257452473
2025-03-09 08:57:35,258 [INFO]: 	reconstruction error %: 0.0
2025-03-09 08:57:35,258 [INFO]: 	nb vectors: 5976
2025-03-09 08:57:35,258 [INFO]: 	vectors dimension: 49152
2025-03-09 08:57:35,258 [INFO]: 	compression ratio: 0.999308248327421
2025-03-09 08:57:35,258 [INFO]: }
2025-03-09 08:57:35,258 [INFO]: 	>>> Finished "Creating the index" in 81.2721 secs
2025-03-09 08:57:35,258 [INFO]: >>> Finished "Launching the whole pipeline" in 81.2983 secs
2025-03-09 08:57:37: [retrieval_preprocessing] calculating distances ...
2025-03-09 08:57:38: [retrieval_preprocessing] finished and saved retrieval indices for episode 52260 [episode count 17/20]
[retrieval_preprocessing] for episode 28581 [episode count 18/20], we have num_retrieval=np.int64(6054) num_query=np.int64(234)
2025-03-09 08:57:41,017 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-09 08:57:42,007 [INFO]: Launching the whole pipeline 03/09/2025, 08:57:42
2025-03-09 08:57:42,007 [INFO]: Reading total number of vectors and dimension 03/09/2025, 08:57:42
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 2152.03it/s]
2025-03-09 08:57:42,032 [INFO]: There are 6054 embeddings of dim 49152
2025-03-09 08:57:42,032 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0251 secs
2025-03-09 08:57:42,032 [INFO]: 	Compute estimated construction time of the index 03/09/2025, 08:57:42
2025-03-09 08:57:42,032 [INFO]: 		-> Train: 16.7 minutes
2025-03-09 08:57:42,032 [INFO]: 		-> Add: 3.3 seconds
2025-03-09 08:57:42,032 [INFO]: 		Total: 16.7 minutes
2025-03-09 08:57:42,032 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0001 secs
2025-03-09 08:57:42,032 [INFO]: 	Checking that your have enough memory available to create the index 03/09/2025, 08:57:42
2025-03-09 08:57:42,033 [INFO]: 1.2GB of memory will be needed to build the index (more might be used if you have more)
2025-03-09 08:57:42,033 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0001 secs
2025-03-09 08:57:42,033 [INFO]: 	Selecting most promising index types given data characteristics 03/09/2025, 08:57:42
2025-03-09 08:57:42,033 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-09 08:57:42,033 [INFO]: 	Creating the index 03/09/2025, 08:57:42
2025-03-09 08:57:42,033 [INFO]: 		-> Instanciate the index HNSW15 03/09/2025, 08:57:42
2025-03-09 08:57:42,034 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0011 secs
2025-03-09 08:57:42,034 [INFO]: 		-> Adding the vectors to the index 03/09/2025, 08:57:42
2025-03-09 08:57:42,034 [INFO]: The memory available for adding the vectors is 48.9GB(total available - used by the index)
2025-03-09 08:57:42,034 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/25 [00:00<?, ?it/s]  4%|▍         | 1/25 [00:00<00:04,  5.01it/s]  8%|▊         | 2/25 [00:00<00:03,  6.79it/s] 12%|█▏        | 3/25 [00:00<00:02,  7.50it/s] 16%|█▌        | 4/25 [00:00<00:02,  8.01it/s] 20%|██        | 5/25 [00:00<00:02,  8.48it/s] 24%|██▍       | 6/25 [00:00<00:02,  7.62it/s] 28%|██▊       | 7/25 [00:00<00:02,  8.13it/s] 32%|███▏      | 8/25 [00:01<00:02,  8.43it/s] 36%|███▌      | 9/25 [00:01<00:01,  8.68it/s] 40%|████      | 10/25 [00:01<00:01,  8.84it/s] 44%|████▍     | 11/25 [00:01<00:01,  8.95it/s] 48%|████▊     | 12/25 [00:01<00:01,  9.12it/s] 52%|█████▏    | 13/25 [00:01<00:01,  9.19it/s] 56%|█████▌    | 14/25 [00:01<00:01,  9.19it/s] 60%|██████    | 15/25 [00:01<00:01,  9.21it/s] 64%|██████▍   | 16/25 [00:01<00:00,  9.20it/s] 68%|██████▊   | 17/25 [00:01<00:00,  9.33it/s] 76%|███████▌  | 19/25 [00:02<00:00, 10.86it/s] 84%|████████▍ | 21/25 [00:06<00:03,  1.12it/s] 88%|████████▊ | 22/25 [00:06<00:02,  1.40it/s] 96%|█████████▌| 24/25 [00:06<00:00,  2.11it/s]100%|██████████| 25/25 [00:09<00:00,  1.12it/s]100%|██████████| 25/25 [00:09<00:00,  2.77it/s]
2025-03-09 08:57:51,075 [INFO]: 	Computing best hyperparameters for index knn.index 03/09/2025, 08:57:51
2025-03-09 08:58:38,660 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 47.5845 secs
2025-03-09 08:58:38,661 [INFO]: The best hyperparameters are: efSearch=195
2025-03-09 08:58:38,661 [INFO]: 	Compute fast metrics 03/09/2025, 08:58:38
  0%|          | 0/4 [00:00<?, ?it/s] 25%|██▌       | 1/4 [00:00<00:01,  1.82it/s] 50%|█████     | 2/4 [00:00<00:00,  3.42it/s] 75%|███████▌  | 3/4 [00:00<00:00,  4.70it/s] 75%|███████▌  | 3/4 [00:00<00:00,  3.39it/s]
2025-03-09 08:58:56,424 [INFO]: 	>>> Finished "Compute fast metrics" in 17.7635 secs
2025-03-09 08:58:56,669 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 74.6348 secs
2025-03-09 08:58:56,669 [INFO]: {
2025-03-09 08:58:56,669 [INFO]: 	index_key: HNSW15
2025-03-09 08:58:56,669 [INFO]: 	index_param: efSearch=195
2025-03-09 08:58:56,669 [INFO]: 	index_path: knn.index
2025-03-09 08:58:56,670 [INFO]: 	size in bytes: 1191088810
2025-03-09 08:58:56,670 [INFO]: 	avg_search_speed_ms: 11.611694155009971
2025-03-09 08:58:56,670 [INFO]: 	99p_search_speed_ms: 22.131642233580344
2025-03-09 08:58:56,670 [INFO]: 	reconstruction error %: 0.0
2025-03-09 08:58:56,670 [INFO]: 	nb vectors: 6054
2025-03-09 08:58:56,670 [INFO]: 	vectors dimension: 49152
2025-03-09 08:58:56,670 [INFO]: 	compression ratio: 0.9993082144731088
2025-03-09 08:58:56,670 [INFO]: }
2025-03-09 08:58:56,670 [INFO]: 	>>> Finished "Creating the index" in 74.6371 secs
2025-03-09 08:58:56,670 [INFO]: >>> Finished "Launching the whole pipeline" in 74.6629 secs
2025-03-09 08:58:57: [retrieval_preprocessing] calculating distances ...
2025-03-09 08:58:58: [retrieval_preprocessing] finished and saved retrieval indices for episode 28581 [episode count 18/20]
[retrieval_preprocessing] for episode 45350 [episode count 19/20], we have num_retrieval=np.int64(5991) num_query=np.int64(297)
2025-03-09 08:59:00,528 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-09 08:59:02,071 [INFO]: Launching the whole pipeline 03/09/2025, 08:59:02
2025-03-09 08:59:02,071 [INFO]: Reading total number of vectors and dimension 03/09/2025, 08:59:02
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1294.94it/s]
2025-03-09 08:59:02,103 [INFO]: There are 5991 embeddings of dim 49152
2025-03-09 08:59:02,103 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0321 secs
2025-03-09 08:59:02,103 [INFO]: 	Compute estimated construction time of the index 03/09/2025, 08:59:02
2025-03-09 08:59:02,103 [INFO]: 		-> Train: 16.7 minutes
2025-03-09 08:59:02,103 [INFO]: 		-> Add: 3.3 seconds
2025-03-09 08:59:02,103 [INFO]: 		Total: 16.7 minutes
2025-03-09 08:59:02,103 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0001 secs
2025-03-09 08:59:02,103 [INFO]: 	Checking that your have enough memory available to create the index 03/09/2025, 08:59:02
2025-03-09 08:59:02,103 [INFO]: 1.2GB of memory will be needed to build the index (more might be used if you have more)
2025-03-09 08:59:02,103 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0001 secs
2025-03-09 08:59:02,103 [INFO]: 	Selecting most promising index types given data characteristics 03/09/2025, 08:59:02
2025-03-09 08:59:02,103 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-09 08:59:02,103 [INFO]: 	Creating the index 03/09/2025, 08:59:02
2025-03-09 08:59:02,103 [INFO]: 		-> Instanciate the index HNSW15 03/09/2025, 08:59:02
2025-03-09 08:59:02,104 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0009 secs
2025-03-09 08:59:02,104 [INFO]: 		-> Adding the vectors to the index 03/09/2025, 08:59:02
2025-03-09 08:59:02,105 [INFO]: The memory available for adding the vectors is 48.9GB(total available - used by the index)
2025-03-09 08:59:02,105 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/25 [00:00<?, ?it/s]  4%|▍         | 1/25 [00:00<00:04,  4.97it/s] 12%|█▏        | 3/25 [00:00<00:02,  8.91it/s] 20%|██        | 5/25 [00:00<00:02,  9.84it/s] 28%|██▊       | 7/25 [00:00<00:01, 10.55it/s] 36%|███▌      | 9/25 [00:00<00:01, 10.48it/s] 44%|████▍     | 11/25 [00:01<00:01,  9.99it/s] 52%|█████▏    | 13/25 [00:01<00:01,  9.66it/s] 56%|█████▌    | 14/25 [00:01<00:01,  9.47it/s] 60%|██████    | 15/25 [00:01<00:01,  9.38it/s] 64%|██████▍   | 16/25 [00:01<00:00,  9.34it/s] 68%|██████▊   | 17/25 [00:01<00:00,  9.34it/s] 72%|███████▏  | 18/25 [00:01<00:00,  9.23it/s] 76%|███████▌  | 19/25 [00:02<00:00,  9.26it/s] 80%|████████  | 20/25 [00:02<00:00,  9.29it/s] 84%|████████▍ | 21/25 [00:05<00:04,  1.09s/it] 92%|█████████▏| 23/25 [00:05<00:01,  1.56it/s]100%|██████████| 25/25 [00:07<00:00,  1.29it/s]100%|██████████| 25/25 [00:07<00:00,  3.20it/s]
2025-03-09 08:59:09,927 [INFO]: 	Computing best hyperparameters for index knn.index 03/09/2025, 08:59:09
2025-03-09 08:59:57,718 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 47.7905 secs
2025-03-09 08:59:57,718 [INFO]: The best hyperparameters are: efSearch=200
2025-03-09 08:59:57,718 [INFO]: 	Compute fast metrics 03/09/2025, 08:59:57
  0%|          | 0/4 [00:00<?, ?it/s] 25%|██▌       | 1/4 [00:00<00:00,  5.76it/s] 75%|███████▌  | 3/4 [00:00<00:00,  9.22it/s] 75%|███████▌  | 3/4 [00:00<00:00,  7.22it/s]
2025-03-09 09:00:21,707 [INFO]: 	>>> Finished "Compute fast metrics" in 23.9885 secs
2025-03-09 09:00:21,708 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 79.6036 secs
2025-03-09 09:00:21,708 [INFO]: {
2025-03-09 09:00:21,708 [INFO]: 	index_key: HNSW15
2025-03-09 09:00:21,708 [INFO]: 	index_param: efSearch=200
2025-03-09 09:00:21,708 [INFO]: 	index_path: knn.index
2025-03-09 09:00:21,708 [INFO]: 	size in bytes: 1178693830
2025-03-09 09:00:21,708 [INFO]: 	avg_search_speed_ms: 11.191203070375277
2025-03-09 09:00:21,708 [INFO]: 	99p_search_speed_ms: 16.064596800133582
2025-03-09 09:00:21,708 [INFO]: 	reconstruction error %: 0.0
2025-03-09 09:00:21,708 [INFO]: 	nb vectors: 5991
2025-03-09 09:00:21,708 [INFO]: 	vectors dimension: 49152
2025-03-09 09:00:21,708 [INFO]: 	compression ratio: 0.9993083004430421
2025-03-09 09:00:21,708 [INFO]: }
2025-03-09 09:00:21,708 [INFO]: 	>>> Finished "Creating the index" in 79.6049 secs
2025-03-09 09:00:21,708 [INFO]: >>> Finished "Launching the whole pipeline" in 79.6375 secs
2025-03-09 09:00:23: [retrieval_preprocessing] calculating distances ...
2025-03-09 09:00:24: [retrieval_preprocessing] finished and saved retrieval indices for episode 45350 [episode count 19/20]
2025-03-09 09:00:24: [retrieval_preprocessing] finished for (9186164821, 'bottle') [chosen_id count 5/10]
2025-03-09 09:00:30: [retrieval_preprocessing] concatenated all embeddings and indices for 20 episodes for (5207831207, 'cup') [chosen_id count 6/10]
2025-03-09 09:00:30: [retrieval_preprocessing] we have num_total=9097 embedding_dim=49152
[retrieval_preprocessing] for episode 53248 [episode count 0/20], we have num_retrieval=np.int64(8535) num_query=np.int64(562)
2025-03-09 09:00:33,723 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-09 09:00:34,839 [INFO]: Launching the whole pipeline 03/09/2025, 09:00:34
2025-03-09 09:00:34,839 [INFO]: Reading total number of vectors and dimension 03/09/2025, 09:00:34
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1314.42it/s]
2025-03-09 09:00:34,866 [INFO]: There are 8535 embeddings of dim 49152
2025-03-09 09:00:34,866 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0268 secs
2025-03-09 09:00:34,866 [INFO]: 	Compute estimated construction time of the index 03/09/2025, 09:00:34
2025-03-09 09:00:34,866 [INFO]: 		-> Train: 16.7 minutes
2025-03-09 09:00:34,866 [INFO]: 		-> Add: 4.7 seconds
2025-03-09 09:00:34,866 [INFO]: 		Total: 16.7 minutes
2025-03-09 09:00:34,866 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0001 secs
2025-03-09 09:00:34,866 [INFO]: 	Checking that your have enough memory available to create the index 03/09/2025, 09:00:34
2025-03-09 09:00:34,866 [INFO]: 1.7GB of memory will be needed to build the index (more might be used if you have more)
2025-03-09 09:00:34,866 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0002 secs
2025-03-09 09:00:34,866 [INFO]: 	Selecting most promising index types given data characteristics 03/09/2025, 09:00:34
2025-03-09 09:00:34,867 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-09 09:00:34,867 [INFO]: 	Creating the index 03/09/2025, 09:00:34
2025-03-09 09:00:34,867 [INFO]: 		-> Instanciate the index HNSW15 03/09/2025, 09:00:34
2025-03-09 09:00:34,868 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0012 secs
2025-03-09 09:00:34,868 [INFO]: 		-> Adding the vectors to the index 03/09/2025, 09:00:34
2025-03-09 09:00:34,868 [INFO]: The memory available for adding the vectors is 48.4GB(total available - used by the index)
2025-03-09 09:00:34,868 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/35 [00:00<?, ?it/s]  3%|▎         | 1/35 [00:00<00:06,  5.01it/s]  9%|▊         | 3/35 [00:00<00:03,  8.61it/s] 14%|█▍        | 5/35 [00:00<00:03,  9.56it/s] 20%|██        | 7/35 [00:00<00:02, 11.12it/s] 26%|██▌       | 9/35 [00:00<00:02, 12.63it/s] 31%|███▏      | 11/35 [00:00<00:01, 14.07it/s] 37%|███▋      | 13/35 [00:01<00:01, 15.24it/s] 43%|████▎     | 15/35 [00:01<00:01, 16.03it/s] 49%|████▊     | 17/35 [00:01<00:01, 16.57it/s] 54%|█████▍    | 19/35 [00:01<00:00, 16.94it/s] 60%|██████    | 21/35 [00:04<00:07,  1.77it/s] 66%|██████▌   | 23/35 [00:04<00:05,  2.37it/s] 71%|███████▏  | 25/35 [00:05<00:03,  3.11it/s] 77%|███████▋  | 27/35 [00:05<00:02,  3.99it/s] 83%|████████▎ | 29/35 [00:05<00:01,  4.92it/s] 89%|████████▊ | 31/35 [00:05<00:00,  5.98it/s] 94%|█████████▍| 33/35 [00:05<00:00,  7.07it/s]100%|██████████| 35/35 [00:08<00:00,  1.81it/s]100%|██████████| 35/35 [00:08<00:00,  3.95it/s]
2025-03-09 09:00:43,736 [INFO]: 	Computing best hyperparameters for index knn.index 03/09/2025, 09:00:43
2025-03-09 09:01:48,066 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 64.3294 secs
2025-03-09 09:01:48,067 [INFO]: The best hyperparameters are: efSearch=226
2025-03-09 09:01:48,067 [INFO]: 	Compute fast metrics 03/09/2025, 09:01:48
  0%|          | 0/4 [00:00<?, ?it/s] 25%|██▌       | 1/4 [00:00<00:00,  6.47it/s] 75%|███████▌  | 3/4 [00:00<00:00,  9.72it/s] 75%|███████▌  | 3/4 [00:00<00:00,  6.99it/s]
2025-03-09 09:02:06,848 [INFO]: 	>>> Finished "Compute fast metrics" in 18.7817 secs
2025-03-09 09:02:06,851 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 91.9827 secs
2025-03-09 09:02:06,851 [INFO]: {
2025-03-09 09:02:06,851 [INFO]: 	index_key: HNSW15
2025-03-09 09:02:06,851 [INFO]: 	index_param: efSearch=226
2025-03-09 09:02:06,851 [INFO]: 	index_path: knn.index
2025-03-09 09:02:06,851 [INFO]: 	size in bytes: 1679210650
2025-03-09 09:02:06,851 [INFO]: 	avg_search_speed_ms: 11.904378835710563
2025-03-09 09:02:06,851 [INFO]: 	99p_search_speed_ms: 23.314621592871845
2025-03-09 09:02:06,851 [INFO]: 	reconstruction error %: 0.0
2025-03-09 09:02:06,851 [INFO]: 	nb vectors: 8535
2025-03-09 09:02:06,851 [INFO]: 	vectors dimension: 49152
2025-03-09 09:02:06,851 [INFO]: 	compression ratio: 0.9993083833764393
2025-03-09 09:02:06,851 [INFO]: }
2025-03-09 09:02:06,851 [INFO]: 	>>> Finished "Creating the index" in 91.9845 secs
2025-03-09 09:02:06,851 [INFO]: >>> Finished "Launching the whole pipeline" in 92.0119 secs
2025-03-09 09:02:09: [retrieval_preprocessing] calculating distances ...
2025-03-09 09:02:11: [retrieval_preprocessing] finished and saved retrieval indices for episode 53248 [episode count 0/20]
[retrieval_preprocessing] for episode 2561 [episode count 1/20], we have num_retrieval=np.int64(8781) num_query=np.int64(316)
2025-03-09 09:02:14,235 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-09 09:02:15,422 [INFO]: Launching the whole pipeline 03/09/2025, 09:02:15
2025-03-09 09:02:15,422 [INFO]: Reading total number of vectors and dimension 03/09/2025, 09:02:15
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1447.81it/s]
2025-03-09 09:02:15,448 [INFO]: There are 8781 embeddings of dim 49152
2025-03-09 09:02:15,449 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0264 secs
2025-03-09 09:02:15,449 [INFO]: 	Compute estimated construction time of the index 03/09/2025, 09:02:15
2025-03-09 09:02:15,449 [INFO]: 		-> Train: 16.7 minutes
2025-03-09 09:02:15,449 [INFO]: 		-> Add: 4.8 seconds
2025-03-09 09:02:15,449 [INFO]: 		Total: 16.7 minutes
2025-03-09 09:02:15,449 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0001 secs
2025-03-09 09:02:15,449 [INFO]: 	Checking that your have enough memory available to create the index 03/09/2025, 09:02:15
2025-03-09 09:02:15,449 [INFO]: 1.8GB of memory will be needed to build the index (more might be used if you have more)
2025-03-09 09:02:15,449 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0002 secs
2025-03-09 09:02:15,449 [INFO]: 	Selecting most promising index types given data characteristics 03/09/2025, 09:02:15
2025-03-09 09:02:15,449 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-09 09:02:15,449 [INFO]: 	Creating the index 03/09/2025, 09:02:15
2025-03-09 09:02:15,449 [INFO]: 		-> Instanciate the index HNSW15 03/09/2025, 09:02:15
2025-03-09 09:02:15,450 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0012 secs
2025-03-09 09:02:15,450 [INFO]: 		-> Adding the vectors to the index 03/09/2025, 09:02:15
2025-03-09 09:02:15,450 [INFO]: The memory available for adding the vectors is 48.4GB(total available - used by the index)
2025-03-09 09:02:15,451 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/36 [00:00<?, ?it/s]  3%|▎         | 1/36 [00:00<00:06,  5.11it/s]  8%|▊         | 3/36 [00:00<00:03,  8.87it/s] 14%|█▍        | 5/36 [00:00<00:02, 10.45it/s] 19%|█▉        | 7/36 [00:00<00:02, 11.41it/s] 25%|██▌       | 9/36 [00:00<00:02, 11.96it/s] 31%|███       | 11/36 [00:00<00:02, 12.17it/s] 36%|███▌      | 13/36 [00:01<00:01, 12.50it/s] 42%|████▏     | 15/36 [00:01<00:01, 12.70it/s] 47%|████▋     | 17/36 [00:01<00:01, 12.80it/s] 53%|█████▎    | 19/36 [00:01<00:01, 12.82it/s] 58%|█████▊    | 21/36 [00:05<00:08,  1.73it/s] 61%|██████    | 22/36 [00:05<00:06,  2.03it/s] 67%|██████▋   | 24/36 [00:05<00:04,  2.82it/s] 72%|███████▏  | 26/36 [00:05<00:02,  3.77it/s] 78%|███████▊  | 28/36 [00:05<00:01,  4.83it/s] 83%|████████▎ | 30/36 [00:05<00:01,  5.96it/s] 89%|████████▉ | 32/36 [00:05<00:00,  7.12it/s] 94%|█████████▍| 34/36 [00:06<00:00,  7.48it/s]100%|██████████| 36/36 [00:09<00:00,  1.65it/s]100%|██████████| 36/36 [00:09<00:00,  3.77it/s]
2025-03-09 09:02:24,996 [INFO]: 	Computing best hyperparameters for index knn.index 03/09/2025, 09:02:24
2025-03-09 09:03:31,968 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 66.9716 secs
2025-03-09 09:03:31,968 [INFO]: The best hyperparameters are: efSearch=278
2025-03-09 09:03:31,969 [INFO]: 	Compute fast metrics 03/09/2025, 09:03:31
  0%|          | 0/4 [00:00<?, ?it/s] 25%|██▌       | 1/4 [00:00<00:00,  5.58it/s] 75%|███████▌  | 3/4 [00:00<00:00, 11.15it/s] 75%|███████▌  | 3/4 [00:00<00:00,  7.62it/s]
2025-03-09 09:03:50,335 [INFO]: 	>>> Finished "Compute fast metrics" in 18.3663 secs
2025-03-09 09:03:50,337 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 94.8867 secs
2025-03-09 09:03:50,337 [INFO]: {
2025-03-09 09:03:50,337 [INFO]: 	index_key: HNSW15
2025-03-09 09:03:50,337 [INFO]: 	index_param: efSearch=278
2025-03-09 09:03:50,337 [INFO]: 	index_path: knn.index
2025-03-09 09:03:50,337 [INFO]: 	size in bytes: 1727609590
2025-03-09 09:03:50,337 [INFO]: 	avg_search_speed_ms: 10.908367015392985
2025-03-09 09:03:50,337 [INFO]: 	99p_search_speed_ms: 21.63750463863836
2025-03-09 09:03:50,337 [INFO]: 	reconstruction error %: 0.0
2025-03-09 09:03:50,337 [INFO]: 	nb vectors: 8781
2025-03-09 09:03:50,337 [INFO]: 	vectors dimension: 49152
2025-03-09 09:03:50,337 [INFO]: 	compression ratio: 0.9993084421347765
2025-03-09 09:03:50,337 [INFO]: }
2025-03-09 09:03:50,337 [INFO]: 	>>> Finished "Creating the index" in 94.8884 secs
2025-03-09 09:03:50,338 [INFO]: >>> Finished "Launching the whole pipeline" in 94.9154 secs
2025-03-09 09:03:52: [retrieval_preprocessing] calculating distances ...
2025-03-09 09:03:54: [retrieval_preprocessing] finished and saved retrieval indices for episode 2561 [episode count 1/20]
[retrieval_preprocessing] for episode 52227 [episode count 2/20], we have num_retrieval=np.int64(8721) num_query=np.int64(376)
2025-03-09 09:03:56,984 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-09 09:03:58,239 [INFO]: Launching the whole pipeline 03/09/2025, 09:03:58
2025-03-09 09:03:58,240 [INFO]: Reading total number of vectors and dimension 03/09/2025, 09:03:58
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1687.85it/s]
2025-03-09 09:03:58,264 [INFO]: There are 8721 embeddings of dim 49152
2025-03-09 09:03:58,264 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0241 secs
2025-03-09 09:03:58,264 [INFO]: 	Compute estimated construction time of the index 03/09/2025, 09:03:58
2025-03-09 09:03:58,264 [INFO]: 		-> Train: 16.7 minutes
2025-03-09 09:03:58,264 [INFO]: 		-> Add: 4.8 seconds
2025-03-09 09:03:58,264 [INFO]: 		Total: 16.7 minutes
2025-03-09 09:03:58,264 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0001 secs
2025-03-09 09:03:58,264 [INFO]: 	Checking that your have enough memory available to create the index 03/09/2025, 09:03:58
2025-03-09 09:03:58,264 [INFO]: 1.8GB of memory will be needed to build the index (more might be used if you have more)
2025-03-09 09:03:58,264 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0001 secs
2025-03-09 09:03:58,264 [INFO]: 	Selecting most promising index types given data characteristics 03/09/2025, 09:03:58
2025-03-09 09:03:58,264 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-09 09:03:58,264 [INFO]: 	Creating the index 03/09/2025, 09:03:58
2025-03-09 09:03:58,264 [INFO]: 		-> Instanciate the index HNSW15 03/09/2025, 09:03:58
2025-03-09 09:03:58,265 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0010 secs
2025-03-09 09:03:58,265 [INFO]: 		-> Adding the vectors to the index 03/09/2025, 09:03:58
2025-03-09 09:03:58,265 [INFO]: The memory available for adding the vectors is 48.4GB(total available - used by the index)
2025-03-09 09:03:58,265 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/36 [00:00<?, ?it/s]  3%|▎         | 1/36 [00:00<00:07,  4.60it/s]  6%|▌         | 2/36 [00:00<00:05,  6.37it/s]  8%|▊         | 3/36 [00:00<00:04,  7.08it/s] 11%|█         | 4/36 [00:00<00:04,  7.53it/s] 14%|█▍        | 5/36 [00:00<00:03,  7.81it/s] 17%|█▋        | 6/36 [00:00<00:03,  8.01it/s] 19%|█▉        | 7/36 [00:00<00:03,  8.15it/s] 22%|██▏       | 8/36 [00:01<00:03,  8.32it/s] 25%|██▌       | 9/36 [00:01<00:03,  8.48it/s] 31%|███       | 11/36 [00:01<00:02,  8.98it/s] 33%|███▎      | 12/36 [00:01<00:02,  9.00it/s] 36%|███▌      | 13/36 [00:01<00:02,  8.02it/s] 39%|███▉      | 14/36 [00:01<00:02,  7.62it/s] 44%|████▍     | 16/36 [00:01<00:02,  8.88it/s] 50%|█████     | 18/36 [00:02<00:01, 10.03it/s] 56%|█████▌    | 20/36 [00:02<00:01, 10.77it/s] 61%|██████    | 22/36 [00:05<00:08,  1.56it/s] 67%|██████▋   | 24/36 [00:05<00:05,  2.20it/s] 72%|███████▏  | 26/36 [00:06<00:03,  2.98it/s] 78%|███████▊  | 28/36 [00:06<00:02,  3.91it/s] 83%|████████▎ | 30/36 [00:06<00:01,  4.98it/s] 89%|████████▉ | 32/36 [00:06<00:00,  6.12it/s] 94%|█████████▍| 34/36 [00:06<00:00,  7.26it/s]100%|██████████| 36/36 [00:09<00:00,  1.76it/s]100%|██████████| 36/36 [00:09<00:00,  3.68it/s]
2025-03-09 09:04:08,042 [INFO]: 	Computing best hyperparameters for index knn.index 03/09/2025, 09:04:08
2025-03-09 09:05:07,866 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 59.8236 secs
2025-03-09 09:05:07,866 [INFO]: The best hyperparameters are: efSearch=256
2025-03-09 09:05:07,866 [INFO]: 	Compute fast metrics 03/09/2025, 09:05:07
  0%|          | 0/4 [00:00<?, ?it/s] 25%|██▌       | 1/4 [00:00<00:00,  5.39it/s] 75%|███████▌  | 3/4 [00:00<00:00, 10.68it/s] 75%|███████▌  | 3/4 [00:00<00:00,  7.36it/s]
2025-03-09 09:05:29,410 [INFO]: 	>>> Finished "Compute fast metrics" in 21.5433 secs
2025-03-09 09:05:29,412 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 91.1468 secs
2025-03-09 09:05:29,412 [INFO]: {
2025-03-09 09:05:29,412 [INFO]: 	index_key: HNSW15
2025-03-09 09:05:29,412 [INFO]: 	index_param: efSearch=256
2025-03-09 09:05:29,412 [INFO]: 	index_path: knn.index
2025-03-09 09:05:29,412 [INFO]: 	size in bytes: 1715804890
2025-03-09 09:05:29,412 [INFO]: 	avg_search_speed_ms: 10.334961289493751
2025-03-09 09:05:29,412 [INFO]: 	99p_search_speed_ms: 17.922518365085136
2025-03-09 09:05:29,412 [INFO]: 	reconstruction error %: 0.0
2025-03-09 09:05:29,412 [INFO]: 	nb vectors: 8721
2025-03-09 09:05:29,412 [INFO]: 	vectors dimension: 49152
2025-03-09 09:05:29,412 [INFO]: 	compression ratio: 0.9993084749863371
2025-03-09 09:05:29,412 [INFO]: }
2025-03-09 09:05:29,412 [INFO]: 	>>> Finished "Creating the index" in 91.1481 secs
2025-03-09 09:05:29,412 [INFO]: >>> Finished "Launching the whole pipeline" in 91.1728 secs
2025-03-09 09:05:31: [retrieval_preprocessing] calculating distances ...
2025-03-09 09:05:33: [retrieval_preprocessing] finished and saved retrieval indices for episode 52227 [episode count 2/20]
[retrieval_preprocessing] for episode 95246 [episode count 3/20], we have num_retrieval=np.int64(8339) num_query=np.int64(758)
2025-03-09 09:05:35,527 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-09 09:05:36,598 [INFO]: Launching the whole pipeline 03/09/2025, 09:05:36
2025-03-09 09:05:36,598 [INFO]: Reading total number of vectors and dimension 03/09/2025, 09:05:36
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1757.14it/s]
2025-03-09 09:05:36,623 [INFO]: There are 8339 embeddings of dim 49152
2025-03-09 09:05:36,624 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0260 secs
2025-03-09 09:05:36,624 [INFO]: 	Compute estimated construction time of the index 03/09/2025, 09:05:36
2025-03-09 09:05:36,624 [INFO]: 		-> Train: 16.7 minutes
2025-03-09 09:05:36,624 [INFO]: 		-> Add: 4.6 seconds
2025-03-09 09:05:36,624 [INFO]: 		Total: 16.7 minutes
2025-03-09 09:05:36,625 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0005 secs
2025-03-09 09:05:36,625 [INFO]: 	Checking that your have enough memory available to create the index 03/09/2025, 09:05:36
2025-03-09 09:05:36,625 [INFO]: 1.7GB of memory will be needed to build the index (more might be used if you have more)
2025-03-09 09:05:36,625 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0004 secs
2025-03-09 09:05:36,625 [INFO]: 	Selecting most promising index types given data characteristics 03/09/2025, 09:05:36
2025-03-09 09:05:36,625 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-09 09:05:36,625 [INFO]: 	Creating the index 03/09/2025, 09:05:36
2025-03-09 09:05:36,626 [INFO]: 		-> Instanciate the index HNSW15 03/09/2025, 09:05:36
2025-03-09 09:05:36,628 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0025 secs
2025-03-09 09:05:36,629 [INFO]: 		-> Adding the vectors to the index 03/09/2025, 09:05:36
2025-03-09 09:05:36,629 [INFO]: The memory available for adding the vectors is 48.5GB(total available - used by the index)
2025-03-09 09:05:36,629 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/34 [00:00<?, ?it/s]  3%|▎         | 1/34 [00:00<00:09,  3.60it/s]  6%|▌         | 2/34 [00:00<00:06,  4.86it/s]  9%|▉         | 3/34 [00:00<00:05,  6.05it/s] 12%|█▏        | 4/34 [00:00<00:04,  6.80it/s] 15%|█▍        | 5/34 [00:00<00:03,  7.31it/s] 18%|█▊        | 6/34 [00:00<00:03,  7.68it/s] 21%|██        | 7/34 [00:01<00:03,  7.93it/s] 24%|██▎       | 8/34 [00:01<00:03,  8.06it/s] 26%|██▋       | 9/34 [00:01<00:03,  8.18it/s] 29%|██▉       | 10/34 [00:01<00:02,  8.26it/s] 32%|███▏      | 11/34 [00:01<00:02,  8.36it/s] 35%|███▌      | 12/34 [00:01<00:02,  8.61it/s] 38%|███▊      | 13/34 [00:01<00:02,  8.76it/s] 41%|████      | 14/34 [00:01<00:02,  8.87it/s] 44%|████▍     | 15/34 [00:01<00:02,  8.88it/s] 50%|█████     | 17/34 [00:02<00:01,  9.97it/s] 56%|█████▌    | 19/34 [00:02<00:01, 11.02it/s] 62%|██████▏   | 21/34 [00:05<00:09,  1.44it/s] 68%|██████▊   | 23/34 [00:05<00:05,  2.05it/s] 74%|███████▎  | 25/34 [00:06<00:03,  2.82it/s] 79%|███████▉  | 27/34 [00:06<00:01,  3.75it/s] 85%|████████▌ | 29/34 [00:06<00:01,  4.78it/s] 91%|█████████ | 31/34 [00:06<00:00,  5.86it/s] 97%|█████████▋| 33/34 [00:06<00:00,  6.92it/s]100%|██████████| 34/34 [00:09<00:00,  3.48it/s]
2025-03-09 09:05:46,421 [INFO]: 	Computing best hyperparameters for index knn.index 03/09/2025, 09:05:46
2025-03-09 09:06:49,154 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 62.7324 secs
2025-03-09 09:06:49,154 [INFO]: The best hyperparameters are: efSearch=196
2025-03-09 09:06:49,154 [INFO]: 	Compute fast metrics 03/09/2025, 09:06:49
  0%|          | 0/4 [00:00<?, ?it/s] 25%|██▌       | 1/4 [00:00<00:00,  5.20it/s] 50%|█████     | 2/4 [00:00<00:00,  6.66it/s] 75%|███████▌  | 3/4 [00:00<00:00,  7.08it/s] 75%|███████▌  | 3/4 [00:00<00:00,  5.24it/s]
2025-03-09 09:07:14,185 [INFO]: 	>>> Finished "Compute fast metrics" in 25.0311 secs
2025-03-09 09:07:14,188 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 97.5593 secs
2025-03-09 09:07:14,188 [INFO]: {
2025-03-09 09:07:14,188 [INFO]: 	index_key: HNSW15
2025-03-09 09:07:14,188 [INFO]: 	index_param: efSearch=196
2025-03-09 09:07:14,188 [INFO]: 	index_path: knn.index
2025-03-09 09:07:14,188 [INFO]: 	size in bytes: 1640648890
2025-03-09 09:07:14,188 [INFO]: 	avg_search_speed_ms: 9.386675150085573
2025-03-09 09:07:14,188 [INFO]: 	99p_search_speed_ms: 17.957151466980573
2025-03-09 09:07:14,188 [INFO]: 	reconstruction error %: 0.0
2025-03-09 09:07:14,188 [INFO]: 	nb vectors: 8339
2025-03-09 09:07:14,188 [INFO]: 	vectors dimension: 49152
2025-03-09 09:07:14,188 [INFO]: 	compression ratio: 0.99930833586216
2025-03-09 09:07:14,188 [INFO]: }
2025-03-09 09:07:14,188 [INFO]: 	>>> Finished "Creating the index" in 97.5628 secs
2025-03-09 09:07:14,188 [INFO]: >>> Finished "Launching the whole pipeline" in 97.5906 secs
2025-03-09 09:07:17: [retrieval_preprocessing] calculating distances ...
2025-03-09 09:07:21: [retrieval_preprocessing] finished and saved retrieval indices for episode 95246 [episode count 3/20]
[retrieval_preprocessing] for episode 39439 [episode count 4/20], we have num_retrieval=np.int64(8493) num_query=np.int64(604)
2025-03-09 09:07:22,382 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-09 09:07:23,583 [INFO]: Launching the whole pipeline 03/09/2025, 09:07:23
2025-03-09 09:07:23,583 [INFO]: Reading total number of vectors and dimension 03/09/2025, 09:07:23
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1293.34it/s]
2025-03-09 09:07:23,612 [INFO]: There are 8493 embeddings of dim 49152
2025-03-09 09:07:23,612 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0296 secs
2025-03-09 09:07:23,612 [INFO]: 	Compute estimated construction time of the index 03/09/2025, 09:07:23
2025-03-09 09:07:23,613 [INFO]: 		-> Train: 16.7 minutes
2025-03-09 09:07:23,613 [INFO]: 		-> Add: 4.7 seconds
2025-03-09 09:07:23,613 [INFO]: 		Total: 16.7 minutes
2025-03-09 09:07:23,613 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0003 secs
2025-03-09 09:07:23,613 [INFO]: 	Checking that your have enough memory available to create the index 03/09/2025, 09:07:23
2025-03-09 09:07:23,613 [INFO]: 1.7GB of memory will be needed to build the index (more might be used if you have more)
2025-03-09 09:07:23,613 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0005 secs
2025-03-09 09:07:23,614 [INFO]: 	Selecting most promising index types given data characteristics 03/09/2025, 09:07:23
2025-03-09 09:07:23,614 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-09 09:07:23,614 [INFO]: 	Creating the index 03/09/2025, 09:07:23
2025-03-09 09:07:23,614 [INFO]: 		-> Instanciate the index HNSW15 03/09/2025, 09:07:23
2025-03-09 09:07:23,617 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0031 secs
2025-03-09 09:07:23,618 [INFO]: 		-> Adding the vectors to the index 03/09/2025, 09:07:23
2025-03-09 09:07:23,618 [INFO]: The memory available for adding the vectors is 48.4GB(total available - used by the index)
2025-03-09 09:07:23,618 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/35 [00:00<?, ?it/s]  3%|▎         | 1/35 [00:00<00:06,  5.32it/s]  9%|▊         | 3/35 [00:00<00:03,  9.20it/s] 14%|█▍        | 5/35 [00:00<00:02, 10.59it/s] 20%|██        | 7/35 [00:00<00:02, 11.42it/s] 26%|██▌       | 9/35 [00:00<00:02, 11.84it/s] 31%|███▏      | 11/35 [00:00<00:01, 12.11it/s] 37%|███▋      | 13/35 [00:01<00:01, 12.34it/s] 43%|████▎     | 15/35 [00:01<00:01, 12.31it/s] 49%|████▊     | 17/35 [00:01<00:01, 12.30it/s] 54%|█████▍    | 19/35 [00:01<00:01, 12.15it/s] 60%|██████    | 21/35 [00:04<00:07,  1.87it/s] 63%|██████▎   | 22/35 [00:04<00:05,  2.19it/s] 69%|██████▊   | 24/35 [00:05<00:03,  3.01it/s] 74%|███████▍  | 26/35 [00:05<00:02,  3.95it/s] 80%|████████  | 28/35 [00:05<00:01,  4.93it/s] 86%|████████▌ | 30/35 [00:05<00:00,  5.97it/s] 91%|█████████▏| 32/35 [00:05<00:00,  6.98it/s] 97%|█████████▋| 34/35 [00:05<00:00,  7.82it/s]100%|██████████| 35/35 [00:08<00:00,  3.99it/s]
2025-03-09 09:07:32,403 [INFO]: 	Computing best hyperparameters for index knn.index 03/09/2025, 09:07:32
2025-03-09 09:08:28,413 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 56.0096 secs
2025-03-09 09:08:28,414 [INFO]: The best hyperparameters are: efSearch=275
2025-03-09 09:08:28,414 [INFO]: 	Compute fast metrics 03/09/2025, 09:08:28
  0%|          | 0/4 [00:00<?, ?it/s] 50%|█████     | 2/4 [00:00<00:00, 18.52it/s] 75%|███████▌  | 3/4 [00:00<00:00, 20.47it/s]
2025-03-09 09:08:47,449 [INFO]: 	>>> Finished "Compute fast metrics" in 19.0357 secs
2025-03-09 09:08:47,452 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 83.8339 secs
2025-03-09 09:08:47,452 [INFO]: {
2025-03-09 09:08:47,452 [INFO]: 	index_key: HNSW15
2025-03-09 09:08:47,452 [INFO]: 	index_param: efSearch=275
2025-03-09 09:08:47,452 [INFO]: 	index_path: knn.index
2025-03-09 09:08:47,452 [INFO]: 	size in bytes: 1670947510
2025-03-09 09:08:47,452 [INFO]: 	avg_search_speed_ms: 10.607297024378516
2025-03-09 09:08:47,452 [INFO]: 	99p_search_speed_ms: 17.61358916293831
2025-03-09 09:08:47,452 [INFO]: 	reconstruction error %: 0.0
2025-03-09 09:08:47,452 [INFO]: 	nb vectors: 8493
2025-03-09 09:08:47,452 [INFO]: 	vectors dimension: 49152
2025-03-09 09:08:47,452 [INFO]: 	compression ratio: 0.9993083169919562
2025-03-09 09:08:47,452 [INFO]: }
2025-03-09 09:08:47,452 [INFO]: 	>>> Finished "Creating the index" in 83.8381 secs
2025-03-09 09:08:47,452 [INFO]: >>> Finished "Launching the whole pipeline" in 83.8693 secs
2025-03-09 09:08:51: [retrieval_preprocessing] calculating distances ...
2025-03-09 09:08:53: [retrieval_preprocessing] finished and saved retrieval indices for episode 39439 [episode count 4/20]
[retrieval_preprocessing] for episode 23569 [episode count 5/20], we have num_retrieval=np.int64(8697) num_query=np.int64(400)
2025-03-09 09:08:55,932 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-09 09:08:57,316 [INFO]: Launching the whole pipeline 03/09/2025, 09:08:57
2025-03-09 09:08:57,316 [INFO]: Reading total number of vectors and dimension 03/09/2025, 09:08:57
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1030.79it/s]
2025-03-09 09:08:57,344 [INFO]: There are 8697 embeddings of dim 49152
2025-03-09 09:08:57,344 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0283 secs
2025-03-09 09:08:57,344 [INFO]: 	Compute estimated construction time of the index 03/09/2025, 09:08:57
2025-03-09 09:08:57,344 [INFO]: 		-> Train: 16.7 minutes
2025-03-09 09:08:57,344 [INFO]: 		-> Add: 4.8 seconds
2025-03-09 09:08:57,344 [INFO]: 		Total: 16.7 minutes
2025-03-09 09:08:57,344 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0001 secs
2025-03-09 09:08:57,344 [INFO]: 	Checking that your have enough memory available to create the index 03/09/2025, 09:08:57
2025-03-09 09:08:57,345 [INFO]: 1.8GB of memory will be needed to build the index (more might be used if you have more)
2025-03-09 09:08:57,345 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0002 secs
2025-03-09 09:08:57,345 [INFO]: 	Selecting most promising index types given data characteristics 03/09/2025, 09:08:57
2025-03-09 09:08:57,345 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-09 09:08:57,345 [INFO]: 	Creating the index 03/09/2025, 09:08:57
2025-03-09 09:08:57,345 [INFO]: 		-> Instanciate the index HNSW15 03/09/2025, 09:08:57
2025-03-09 09:08:57,346 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0010 secs
2025-03-09 09:08:57,346 [INFO]: 		-> Adding the vectors to the index 03/09/2025, 09:08:57
2025-03-09 09:08:57,346 [INFO]: The memory available for adding the vectors is 48.4GB(total available - used by the index)
2025-03-09 09:08:57,346 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/36 [00:00<?, ?it/s]  3%|▎         | 1/36 [00:00<00:06,  5.41it/s]  8%|▊         | 3/36 [00:00<00:03, 10.06it/s] 14%|█▍        | 5/36 [00:00<00:02, 12.09it/s] 19%|█▉        | 7/36 [00:00<00:02, 11.50it/s] 25%|██▌       | 9/36 [00:00<00:02, 11.19it/s] 31%|███       | 11/36 [00:01<00:02, 10.85it/s] 36%|███▌      | 13/36 [00:01<00:02, 10.80it/s] 42%|████▏     | 15/36 [00:01<00:02, 10.35it/s] 47%|████▋     | 17/36 [00:01<00:01, 10.21it/s] 53%|█████▎    | 19/36 [00:01<00:01, 10.05it/s] 58%|█████▊    | 21/36 [00:05<00:10,  1.49it/s] 64%|██████▍   | 23/36 [00:05<00:06,  2.03it/s] 69%|██████▉   | 25/36 [00:06<00:04,  2.71it/s] 75%|███████▌  | 27/36 [00:06<00:02,  3.54it/s] 81%|████████  | 29/36 [00:06<00:01,  4.54it/s] 86%|████████▌ | 31/36 [00:06<00:00,  5.67it/s] 92%|█████████▏| 33/36 [00:06<00:00,  6.83it/s] 97%|█████████▋| 35/36 [00:06<00:00,  7.99it/s]100%|██████████| 36/36 [00:10<00:00,  3.47it/s]
2025-03-09 09:09:07,720 [INFO]: 	Computing best hyperparameters for index knn.index 03/09/2025, 09:09:07
2025-03-09 09:10:05,006 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 57.2858 secs
2025-03-09 09:10:05,006 [INFO]: The best hyperparameters are: efSearch=271
2025-03-09 09:10:05,006 [INFO]: 	Compute fast metrics 03/09/2025, 09:10:05
  0%|          | 0/4 [00:00<?, ?it/s] 25%|██▌       | 1/4 [00:00<00:00,  5.60it/s] 50%|█████     | 2/4 [00:00<00:00,  7.39it/s] 75%|███████▌  | 3/4 [00:00<00:00,  8.26it/s] 75%|███████▌  | 3/4 [00:00<00:00,  6.18it/s]
2025-03-09 09:10:24,598 [INFO]: 	>>> Finished "Compute fast metrics" in 19.5919 secs
2025-03-09 09:10:24,601 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 87.2549 secs
2025-03-09 09:10:24,601 [INFO]: {
2025-03-09 09:10:24,601 [INFO]: 	index_key: HNSW15
2025-03-09 09:10:24,601 [INFO]: 	index_param: efSearch=271
2025-03-09 09:10:24,601 [INFO]: 	index_path: knn.index
2025-03-09 09:10:24,601 [INFO]: 	size in bytes: 1711083130
2025-03-09 09:10:24,601 [INFO]: 	avg_search_speed_ms: 12.56829454889989
2025-03-09 09:10:24,601 [INFO]: 	99p_search_speed_ms: 21.499745605979076
2025-03-09 09:10:24,601 [INFO]: 	reconstruction error %: 0.0
2025-03-09 09:10:24,601 [INFO]: 	nb vectors: 8697
2025-03-09 09:10:24,601 [INFO]: 	vectors dimension: 49152
2025-03-09 09:10:24,601 [INFO]: 	compression ratio: 0.9993084181713603
2025-03-09 09:10:24,601 [INFO]: }
2025-03-09 09:10:24,601 [INFO]: 	>>> Finished "Creating the index" in 87.2564 secs
2025-03-09 09:10:24,601 [INFO]: >>> Finished "Launching the whole pipeline" in 87.2854 secs
2025-03-09 09:10:28: [retrieval_preprocessing] calculating distances ...
2025-03-09 09:10:30: [retrieval_preprocessing] finished and saved retrieval indices for episode 23569 [episode count 5/20]
[retrieval_preprocessing] for episode 19987 [episode count 6/20], we have num_retrieval=np.int64(8718) num_query=np.int64(379)
2025-03-09 09:10:34,047 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-09 09:10:35,070 [INFO]: Launching the whole pipeline 03/09/2025, 09:10:35
2025-03-09 09:10:35,070 [INFO]: Reading total number of vectors and dimension 03/09/2025, 09:10:35
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1539.19it/s]
2025-03-09 09:10:35,095 [INFO]: There are 8718 embeddings of dim 49152
2025-03-09 09:10:35,095 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0251 secs
2025-03-09 09:10:35,095 [INFO]: 	Compute estimated construction time of the index 03/09/2025, 09:10:35
2025-03-09 09:10:35,095 [INFO]: 		-> Train: 16.7 minutes
2025-03-09 09:10:35,095 [INFO]: 		-> Add: 4.8 seconds
2025-03-09 09:10:35,095 [INFO]: 		Total: 16.7 minutes
2025-03-09 09:10:35,095 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0001 secs
2025-03-09 09:10:35,095 [INFO]: 	Checking that your have enough memory available to create the index 03/09/2025, 09:10:35
2025-03-09 09:10:35,095 [INFO]: 1.8GB of memory will be needed to build the index (more might be used if you have more)
2025-03-09 09:10:35,096 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0002 secs
2025-03-09 09:10:35,096 [INFO]: 	Selecting most promising index types given data characteristics 03/09/2025, 09:10:35
2025-03-09 09:10:35,096 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-09 09:10:35,096 [INFO]: 	Creating the index 03/09/2025, 09:10:35
2025-03-09 09:10:35,096 [INFO]: 		-> Instanciate the index HNSW15 03/09/2025, 09:10:35
2025-03-09 09:10:35,097 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0009 secs
2025-03-09 09:10:35,097 [INFO]: 		-> Adding the vectors to the index 03/09/2025, 09:10:35
2025-03-09 09:10:35,097 [INFO]: The memory available for adding the vectors is 48.4GB(total available - used by the index)
2025-03-09 09:10:35,097 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/36 [00:00<?, ?it/s]  3%|▎         | 1/36 [00:00<00:04,  7.20it/s]  6%|▌         | 2/36 [00:00<00:05,  6.66it/s]  8%|▊         | 3/36 [00:00<00:04,  7.56it/s] 11%|█         | 4/36 [00:00<00:03,  8.18it/s] 14%|█▍        | 5/36 [00:00<00:03,  8.48it/s] 17%|█▋        | 6/36 [00:00<00:03,  8.64it/s] 19%|█▉        | 7/36 [00:00<00:03,  8.89it/s] 22%|██▏       | 8/36 [00:00<00:03,  8.92it/s] 25%|██▌       | 9/36 [00:01<00:03,  8.95it/s] 28%|██▊       | 10/36 [00:01<00:02,  8.91it/s] 33%|███▎      | 12/36 [00:01<00:02, 10.32it/s] 39%|███▉      | 14/36 [00:01<00:02,  9.76it/s] 42%|████▏     | 15/36 [00:01<00:02,  9.61it/s] 44%|████▍     | 16/36 [00:01<00:02,  9.47it/s] 50%|█████     | 18/36 [00:01<00:01, 10.62it/s] 56%|█████▌    | 20/36 [00:02<00:01, 11.30it/s] 61%|██████    | 22/36 [00:05<00:08,  1.70it/s] 67%|██████▋   | 24/36 [00:05<00:05,  2.38it/s] 72%|███████▏  | 26/36 [00:05<00:03,  3.22it/s] 78%|███████▊  | 28/36 [00:05<00:01,  4.19it/s] 83%|████████▎ | 30/36 [00:05<00:01,  5.26it/s] 89%|████████▉ | 32/36 [00:05<00:00,  6.35it/s] 94%|█████████▍| 34/36 [00:06<00:00,  7.53it/s]100%|██████████| 36/36 [00:09<00:00,  1.73it/s]100%|██████████| 36/36 [00:09<00:00,  3.86it/s]
2025-03-09 09:10:45,192 [INFO]: 	Computing best hyperparameters for index knn.index 03/09/2025, 09:10:45
2025-03-09 09:11:44,458 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 59.2662 secs
2025-03-09 09:11:44,459 [INFO]: The best hyperparameters are: efSearch=250
2025-03-09 09:11:44,459 [INFO]: 	Compute fast metrics 03/09/2025, 09:11:44
  0%|          | 0/4 [00:00<?, ?it/s] 25%|██▌       | 1/4 [00:00<00:00,  6.18it/s] 75%|███████▌  | 3/4 [00:00<00:00,  9.01it/s] 75%|███████▌  | 3/4 [00:00<00:00,  8.14it/s]
2025-03-09 09:12:11,760 [INFO]: 	>>> Finished "Compute fast metrics" in 27.3012 secs
2025-03-09 09:12:11,763 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 96.6663 secs
2025-03-09 09:12:11,763 [INFO]: {
2025-03-09 09:12:11,763 [INFO]: 	index_key: HNSW15
2025-03-09 09:12:11,763 [INFO]: 	index_param: efSearch=250
2025-03-09 09:12:11,763 [INFO]: 	index_path: knn.index
2025-03-09 09:12:11,763 [INFO]: 	size in bytes: 1715214670
2025-03-09 09:12:11,763 [INFO]: 	avg_search_speed_ms: 9.859178964043114
2025-03-09 09:12:11,763 [INFO]: 	99p_search_speed_ms: 19.629945191554725
2025-03-09 09:12:11,763 [INFO]: 	reconstruction error %: 0.0
2025-03-09 09:12:11,763 [INFO]: 	nb vectors: 8718
2025-03-09 09:12:11,763 [INFO]: 	vectors dimension: 49152
2025-03-09 09:12:11,763 [INFO]: 	compression ratio: 0.9993084679015718
2025-03-09 09:12:11,763 [INFO]: }
2025-03-09 09:12:11,763 [INFO]: 	>>> Finished "Creating the index" in 96.6678 secs
2025-03-09 09:12:11,764 [INFO]: >>> Finished "Launching the whole pipeline" in 96.6936 secs
2025-03-09 09:12:14: [retrieval_preprocessing] calculating distances ...
2025-03-09 09:12:16: [retrieval_preprocessing] finished and saved retrieval indices for episode 19987 [episode count 6/20]
[retrieval_preprocessing] for episode 52760 [episode count 7/20], we have num_retrieval=np.int64(8643) num_query=np.int64(454)
2025-03-09 09:12:19,396 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-09 09:12:20,528 [INFO]: Launching the whole pipeline 03/09/2025, 09:12:20
2025-03-09 09:12:20,528 [INFO]: Reading total number of vectors and dimension 03/09/2025, 09:12:20
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1088.02it/s]
2025-03-09 09:12:20,554 [INFO]: There are 8643 embeddings of dim 49152
2025-03-09 09:12:20,555 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0266 secs
2025-03-09 09:12:20,555 [INFO]: 	Compute estimated construction time of the index 03/09/2025, 09:12:20
2025-03-09 09:12:20,555 [INFO]: 		-> Train: 16.7 minutes
2025-03-09 09:12:20,555 [INFO]: 		-> Add: 4.7 seconds
2025-03-09 09:12:20,555 [INFO]: 		Total: 16.7 minutes
2025-03-09 09:12:20,555 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0002 secs
2025-03-09 09:12:20,555 [INFO]: 	Checking that your have enough memory available to create the index 03/09/2025, 09:12:20
2025-03-09 09:12:20,555 [INFO]: 1.7GB of memory will be needed to build the index (more might be used if you have more)
2025-03-09 09:12:20,555 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0002 secs
2025-03-09 09:12:20,555 [INFO]: 	Selecting most promising index types given data characteristics 03/09/2025, 09:12:20
2025-03-09 09:12:20,555 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-09 09:12:20,555 [INFO]: 	Creating the index 03/09/2025, 09:12:20
2025-03-09 09:12:20,555 [INFO]: 		-> Instanciate the index HNSW15 03/09/2025, 09:12:20
2025-03-09 09:12:20,557 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0012 secs
2025-03-09 09:12:20,557 [INFO]: 		-> Adding the vectors to the index 03/09/2025, 09:12:20
2025-03-09 09:12:20,557 [INFO]: The memory available for adding the vectors is 48.4GB(total available - used by the index)
2025-03-09 09:12:20,557 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/36 [00:00<?, ?it/s]  3%|▎         | 1/36 [00:00<00:07,  4.87it/s]  6%|▌         | 2/36 [00:00<00:04,  6.91it/s]  8%|▊         | 3/36 [00:00<00:04,  7.86it/s] 11%|█         | 4/36 [00:00<00:03,  8.43it/s] 17%|█▋        | 6/36 [00:00<00:03,  9.37it/s] 19%|█▉        | 7/36 [00:00<00:03,  9.41it/s] 28%|██▊       | 10/36 [00:00<00:01, 14.37it/s] 33%|███▎      | 12/36 [00:01<00:01, 14.27it/s] 39%|███▉      | 14/36 [00:01<00:01, 11.89it/s] 44%|████▍     | 16/36 [00:01<00:01, 10.66it/s] 50%|█████     | 18/36 [00:01<00:01, 10.11it/s] 56%|█████▌    | 20/36 [00:01<00:01, 10.79it/s] 61%|██████    | 22/36 [00:05<00:08,  1.71it/s] 64%|██████▍   | 23/36 [00:05<00:06,  2.01it/s] 67%|██████▋   | 24/36 [00:05<00:05,  2.40it/s] 69%|██████▉   | 25/36 [00:05<00:03,  2.87it/s] 72%|███████▏  | 26/36 [00:05<00:02,  3.44it/s] 75%|███████▌  | 27/36 [00:05<00:02,  4.09it/s] 78%|███████▊  | 28/36 [00:05<00:01,  4.76it/s] 81%|████████  | 29/36 [00:06<00:01,  5.46it/s] 83%|████████▎ | 30/36 [00:06<00:00,  6.11it/s] 86%|████████▌ | 31/36 [00:06<00:00,  6.46it/s] 89%|████████▉ | 32/36 [00:06<00:00,  7.03it/s] 92%|█████████▏| 33/36 [00:06<00:00,  7.62it/s] 97%|█████████▋| 35/36 [00:06<00:00,  8.87it/s]100%|██████████| 36/36 [00:09<00:00,  1.20it/s]100%|██████████| 36/36 [00:09<00:00,  3.69it/s]
2025-03-09 09:12:30,310 [INFO]: 	Computing best hyperparameters for index knn.index 03/09/2025, 09:12:30
2025-03-09 09:13:31,470 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 61.1588 secs
2025-03-09 09:13:31,470 [INFO]: The best hyperparameters are: efSearch=274
2025-03-09 09:13:31,470 [INFO]: 	Compute fast metrics 03/09/2025, 09:13:31
  0%|          | 0/4 [00:00<?, ?it/s] 25%|██▌       | 1/4 [00:00<00:00,  5.37it/s] 50%|█████     | 2/4 [00:00<00:00,  7.22it/s] 75%|███████▌  | 3/4 [00:00<00:00,  7.96it/s] 75%|███████▌  | 3/4 [00:00<00:00,  5.96it/s]
2025-03-09 09:13:55,148 [INFO]: 	>>> Finished "Compute fast metrics" in 23.6781 secs
2025-03-09 09:13:55,151 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 94.5941 secs
2025-03-09 09:13:55,151 [INFO]: {
2025-03-09 09:13:55,151 [INFO]: 	index_key: HNSW15
2025-03-09 09:13:55,151 [INFO]: 	index_param: efSearch=274
2025-03-09 09:13:55,151 [INFO]: 	index_path: knn.index
2025-03-09 09:13:55,151 [INFO]: 	size in bytes: 1700459050
2025-03-09 09:13:55,151 [INFO]: 	avg_search_speed_ms: 11.61788393630842
2025-03-09 09:13:55,151 [INFO]: 	99p_search_speed_ms: 22.8731163777411
2025-03-09 09:13:55,151 [INFO]: 	reconstruction error %: 0.0
2025-03-09 09:13:55,151 [INFO]: 	nb vectors: 8643
2025-03-09 09:13:55,151 [INFO]: 	vectors dimension: 49152
2025-03-09 09:13:55,151 [INFO]: 	compression ratio: 0.9993083597043987
2025-03-09 09:13:55,151 [INFO]: }
2025-03-09 09:13:55,151 [INFO]: 	>>> Finished "Creating the index" in 94.5960 secs
2025-03-09 09:13:55,151 [INFO]: >>> Finished "Launching the whole pipeline" in 94.6233 secs
2025-03-09 09:13:58: [retrieval_preprocessing] calculating distances ...
2025-03-09 09:14:01: [retrieval_preprocessing] finished and saved retrieval indices for episode 52760 [episode count 7/20]
[retrieval_preprocessing] for episode 2586 [episode count 8/20], we have num_retrieval=np.int64(8829) num_query=np.int64(268)
2025-03-09 09:14:03,882 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-09 09:14:05,336 [INFO]: Launching the whole pipeline 03/09/2025, 09:14:05
2025-03-09 09:14:05,336 [INFO]: Reading total number of vectors and dimension 03/09/2025, 09:14:05
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1195.98it/s]
2025-03-09 09:14:05,365 [INFO]: There are 8829 embeddings of dim 49152
2025-03-09 09:14:05,366 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0297 secs
2025-03-09 09:14:05,366 [INFO]: 	Compute estimated construction time of the index 03/09/2025, 09:14:05
2025-03-09 09:14:05,366 [INFO]: 		-> Train: 16.7 minutes
2025-03-09 09:14:05,366 [INFO]: 		-> Add: 4.8 seconds
2025-03-09 09:14:05,366 [INFO]: 		Total: 16.7 minutes
2025-03-09 09:14:05,367 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0004 secs
2025-03-09 09:14:05,367 [INFO]: 	Checking that your have enough memory available to create the index 03/09/2025, 09:14:05
2025-03-09 09:14:05,367 [INFO]: 1.8GB of memory will be needed to build the index (more might be used if you have more)
2025-03-09 09:14:05,367 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0005 secs
2025-03-09 09:14:05,367 [INFO]: 	Selecting most promising index types given data characteristics 03/09/2025, 09:14:05
2025-03-09 09:14:05,368 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-09 09:14:05,368 [INFO]: 	Creating the index 03/09/2025, 09:14:05
2025-03-09 09:14:05,368 [INFO]: 		-> Instanciate the index HNSW15 03/09/2025, 09:14:05
2025-03-09 09:14:05,371 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0029 secs
2025-03-09 09:14:05,371 [INFO]: 		-> Adding the vectors to the index 03/09/2025, 09:14:05
2025-03-09 09:14:05,371 [INFO]: The memory available for adding the vectors is 48.4GB(total available - used by the index)
2025-03-09 09:14:05,371 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/36 [00:00<?, ?it/s]  3%|▎         | 1/36 [00:00<00:06,  5.04it/s]  8%|▊         | 3/36 [00:00<00:03, 10.07it/s] 14%|█▍        | 5/36 [00:00<00:02, 11.30it/s] 19%|█▉        | 7/36 [00:00<00:02, 12.05it/s] 25%|██▌       | 9/36 [00:00<00:02, 12.41it/s] 31%|███       | 11/36 [00:00<00:02, 12.44it/s] 36%|███▌      | 13/36 [00:01<00:01, 12.50it/s] 42%|████▏     | 15/36 [00:01<00:01, 12.42it/s] 47%|████▋     | 17/36 [00:01<00:01, 12.41it/s] 53%|█████▎    | 19/36 [00:01<00:01, 13.50it/s] 58%|█████▊    | 21/36 [00:04<00:08,  1.87it/s] 64%|██████▍   | 23/36 [00:04<00:05,  2.52it/s] 69%|██████▉   | 25/36 [00:05<00:03,  3.34it/s] 75%|███████▌  | 27/36 [00:05<00:02,  4.32it/s] 81%|████████  | 29/36 [00:05<00:01,  5.39it/s] 86%|████████▌ | 31/36 [00:05<00:00,  6.57it/s] 92%|█████████▏| 33/36 [00:05<00:00,  7.72it/s] 97%|█████████▋| 35/36 [00:05<00:00,  8.82it/s]100%|██████████| 36/36 [00:08<00:00,  4.03it/s]
2025-03-09 09:14:14,312 [INFO]: 	Computing best hyperparameters for index knn.index 03/09/2025, 09:14:14
2025-03-09 09:15:15,898 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 61.5858 secs
2025-03-09 09:15:15,898 [INFO]: The best hyperparameters are: efSearch=260
2025-03-09 09:15:15,899 [INFO]: 	Compute fast metrics 03/09/2025, 09:15:15
  0%|          | 0/4 [00:00<?, ?it/s] 25%|██▌       | 1/4 [00:00<00:00,  5.62it/s] 50%|█████     | 2/4 [00:00<00:00,  7.15it/s] 75%|███████▌  | 3/4 [00:00<00:00,  7.86it/s] 75%|███████▌  | 3/4 [00:00<00:00,  5.93it/s]
2025-03-09 09:15:44,559 [INFO]: 	>>> Finished "Compute fast metrics" in 28.6600 secs
2025-03-09 09:15:44,561 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 99.1903 secs
2025-03-09 09:15:44,562 [INFO]: {
2025-03-09 09:15:44,562 [INFO]: 	index_key: HNSW15
2025-03-09 09:15:44,562 [INFO]: 	index_param: efSearch=260
2025-03-09 09:15:44,562 [INFO]: 	index_path: knn.index
2025-03-09 09:15:44,562 [INFO]: 	size in bytes: 1737053290
2025-03-09 09:15:44,562 [INFO]: 	avg_search_speed_ms: 9.862409343417639
2025-03-09 09:15:44,562 [INFO]: 	99p_search_speed_ms: 16.948853712528944
2025-03-09 09:15:44,562 [INFO]: 	reconstruction error %: 0.0
2025-03-09 09:15:44,562 [INFO]: 	nb vectors: 8829
2025-03-09 09:15:44,562 [INFO]: 	vectors dimension: 49152
2025-03-09 09:15:44,562 [INFO]: 	compression ratio: 0.9993084506923792
2025-03-09 09:15:44,562 [INFO]: }
2025-03-09 09:15:44,562 [INFO]: 	>>> Finished "Creating the index" in 99.1940 secs
2025-03-09 09:15:44,562 [INFO]: >>> Finished "Launching the whole pipeline" in 99.2257 secs
2025-03-09 09:15:46: [retrieval_preprocessing] calculating distances ...
2025-03-09 09:15:47: [retrieval_preprocessing] finished and saved retrieval indices for episode 2586 [episode count 8/20]
[retrieval_preprocessing] for episode 91164 [episode count 9/20], we have num_retrieval=np.int64(8782) num_query=np.int64(315)
2025-03-09 09:15:50,486 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-09 09:15:51,565 [INFO]: Launching the whole pipeline 03/09/2025, 09:15:51
2025-03-09 09:15:51,565 [INFO]: Reading total number of vectors and dimension 03/09/2025, 09:15:51
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1506.57it/s]
2025-03-09 09:15:51,591 [INFO]: There are 8782 embeddings of dim 49152
2025-03-09 09:15:51,591 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0257 secs
2025-03-09 09:15:51,591 [INFO]: 	Compute estimated construction time of the index 03/09/2025, 09:15:51
2025-03-09 09:15:51,591 [INFO]: 		-> Train: 16.7 minutes
2025-03-09 09:15:51,591 [INFO]: 		-> Add: 4.8 seconds
2025-03-09 09:15:51,591 [INFO]: 		Total: 16.7 minutes
2025-03-09 09:15:51,591 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0001 secs
2025-03-09 09:15:51,591 [INFO]: 	Checking that your have enough memory available to create the index 03/09/2025, 09:15:51
2025-03-09 09:15:51,591 [INFO]: 1.8GB of memory will be needed to build the index (more might be used if you have more)
2025-03-09 09:15:51,591 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0002 secs
2025-03-09 09:15:51,592 [INFO]: 	Selecting most promising index types given data characteristics 03/09/2025, 09:15:51
2025-03-09 09:15:51,592 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-09 09:15:51,592 [INFO]: 	Creating the index 03/09/2025, 09:15:51
2025-03-09 09:15:51,592 [INFO]: 		-> Instanciate the index HNSW15 03/09/2025, 09:15:51
2025-03-09 09:15:51,593 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0010 secs
2025-03-09 09:15:51,593 [INFO]: 		-> Adding the vectors to the index 03/09/2025, 09:15:51
2025-03-09 09:15:51,593 [INFO]: The memory available for adding the vectors is 48.4GB(total available - used by the index)
2025-03-09 09:15:51,593 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/36 [00:00<?, ?it/s]  3%|▎         | 1/36 [00:00<00:07,  4.58it/s]  6%|▌         | 2/36 [00:00<00:05,  6.50it/s]  8%|▊         | 3/36 [00:00<00:04,  7.48it/s] 11%|█         | 4/36 [00:00<00:03,  8.05it/s] 14%|█▍        | 5/36 [00:00<00:03,  8.40it/s] 17%|█▋        | 6/36 [00:00<00:03,  8.64it/s] 19%|█▉        | 7/36 [00:00<00:03,  8.94it/s] 22%|██▏       | 8/36 [00:00<00:03,  9.00it/s] 25%|██▌       | 9/36 [00:01<00:02,  9.03it/s] 28%|██▊       | 10/36 [00:01<00:02,  9.02it/s] 31%|███       | 11/36 [00:01<00:02,  9.05it/s] 33%|███▎      | 12/36 [00:01<00:02,  9.13it/s] 36%|███▌      | 13/36 [00:01<00:02,  9.06it/s] 39%|███▉      | 14/36 [00:01<00:02,  8.94it/s] 44%|████▍     | 16/36 [00:01<00:01, 10.11it/s] 50%|█████     | 18/36 [00:01<00:01, 11.06it/s] 56%|█████▌    | 20/36 [00:02<00:01, 11.27it/s] 61%|██████    | 22/36 [00:05<00:09,  1.44it/s] 67%|██████▋   | 24/36 [00:06<00:05,  2.03it/s] 72%|███████▏  | 26/36 [00:06<00:03,  2.78it/s] 78%|███████▊  | 28/36 [00:06<00:02,  3.68it/s] 83%|████████▎ | 30/36 [00:06<00:01,  4.74it/s] 89%|████████▉ | 32/36 [00:06<00:00,  5.90it/s] 94%|█████████▍| 34/36 [00:06<00:00,  7.07it/s]100%|██████████| 36/36 [00:09<00:00,  1.77it/s]100%|██████████| 36/36 [00:09<00:00,  3.65it/s]
2025-03-09 09:16:01,709 [INFO]: 	Computing best hyperparameters for index knn.index 03/09/2025, 09:16:01
2025-03-09 09:16:57,352 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 55.6427 secs
2025-03-09 09:16:57,352 [INFO]: The best hyperparameters are: efSearch=276
2025-03-09 09:16:57,352 [INFO]: 	Compute fast metrics 03/09/2025, 09:16:57
  0%|          | 0/4 [00:00<?, ?it/s] 25%|██▌       | 1/4 [00:00<00:00,  5.87it/s] 75%|███████▌  | 3/4 [00:00<00:00, 11.31it/s] 75%|███████▌  | 3/4 [00:00<00:00,  8.91it/s]
2025-03-09 09:17:35,437 [INFO]: 	>>> Finished "Compute fast metrics" in 38.0845 secs
2025-03-09 09:17:35,439 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 103.8466 secs
2025-03-09 09:17:35,440 [INFO]: {
2025-03-09 09:17:35,440 [INFO]: 	index_key: HNSW15
2025-03-09 09:17:35,440 [INFO]: 	index_param: efSearch=276
2025-03-09 09:17:35,440 [INFO]: 	index_path: knn.index
2025-03-09 09:17:35,440 [INFO]: 	size in bytes: 1727806330
2025-03-09 09:17:35,440 [INFO]: 	avg_search_speed_ms: 11.478473476468919
2025-03-09 09:17:35,440 [INFO]: 	99p_search_speed_ms: 19.37970723956823
2025-03-09 09:17:35,440 [INFO]: 	reconstruction error %: 0.0
2025-03-09 09:17:35,440 [INFO]: 	nb vectors: 8782
2025-03-09 09:17:35,440 [INFO]: 	vectors dimension: 49152
2025-03-09 09:17:35,440 [INFO]: 	compression ratio: 0.9993084444828952
2025-03-09 09:17:35,440 [INFO]: }
2025-03-09 09:17:35,440 [INFO]: 	>>> Finished "Creating the index" in 103.8481 secs
2025-03-09 09:17:35,440 [INFO]: >>> Finished "Launching the whole pipeline" in 103.8747 secs
2025-03-09 09:17:37: [retrieval_preprocessing] calculating distances ...
2025-03-09 09:17:39: [retrieval_preprocessing] finished and saved retrieval indices for episode 91164 [episode count 9/20]
[retrieval_preprocessing] for episode 31773 [episode count 10/20], we have num_retrieval=np.int64(8450) num_query=np.int64(647)
2025-03-09 09:17:43,393 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-09 09:17:44,508 [INFO]: Launching the whole pipeline 03/09/2025, 09:17:44
2025-03-09 09:17:44,508 [INFO]: Reading total number of vectors and dimension 03/09/2025, 09:17:44
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1456.36it/s]
2025-03-09 09:17:44,533 [INFO]: There are 8450 embeddings of dim 49152
2025-03-09 09:17:44,533 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0254 secs
2025-03-09 09:17:44,533 [INFO]: 	Compute estimated construction time of the index 03/09/2025, 09:17:44
2025-03-09 09:17:44,534 [INFO]: 		-> Train: 16.7 minutes
2025-03-09 09:17:44,534 [INFO]: 		-> Add: 4.6 seconds
2025-03-09 09:17:44,534 [INFO]: 		Total: 16.7 minutes
2025-03-09 09:17:44,534 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0001 secs
2025-03-09 09:17:44,534 [INFO]: 	Checking that your have enough memory available to create the index 03/09/2025, 09:17:44
2025-03-09 09:17:44,534 [INFO]: 1.7GB of memory will be needed to build the index (more might be used if you have more)
2025-03-09 09:17:44,534 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0001 secs
2025-03-09 09:17:44,534 [INFO]: 	Selecting most promising index types given data characteristics 03/09/2025, 09:17:44
2025-03-09 09:17:44,534 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-09 09:17:44,534 [INFO]: 	Creating the index 03/09/2025, 09:17:44
2025-03-09 09:17:44,534 [INFO]: 		-> Instanciate the index HNSW15 03/09/2025, 09:17:44
2025-03-09 09:17:44,535 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0010 secs
2025-03-09 09:17:44,535 [INFO]: 		-> Adding the vectors to the index 03/09/2025, 09:17:44
2025-03-09 09:17:44,535 [INFO]: The memory available for adding the vectors is 48.5GB(total available - used by the index)
2025-03-09 09:17:44,535 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/35 [00:00<?, ?it/s]  3%|▎         | 1/35 [00:00<00:08,  3.88it/s]  9%|▊         | 3/35 [00:00<00:04,  7.95it/s] 14%|█▍        | 5/35 [00:00<00:03,  9.90it/s] 20%|██        | 7/35 [00:00<00:02, 10.89it/s] 26%|██▌       | 9/35 [00:00<00:02, 11.47it/s] 31%|███▏      | 11/35 [00:01<00:02, 11.90it/s] 37%|███▋      | 13/35 [00:01<00:01, 12.23it/s] 43%|████▎     | 15/35 [00:01<00:01, 12.42it/s] 49%|████▊     | 17/35 [00:01<00:01, 12.48it/s] 54%|█████▍    | 19/35 [00:01<00:01, 12.49it/s] 60%|██████    | 21/35 [00:05<00:08,  1.66it/s] 63%|██████▎   | 22/35 [00:05<00:06,  1.94it/s] 69%|██████▊   | 24/35 [00:05<00:04,  2.70it/s] 74%|███████▍  | 26/35 [00:05<00:02,  3.58it/s] 80%|████████  | 28/35 [00:05<00:01,  4.56it/s] 86%|████████▌ | 30/35 [00:06<00:00,  5.59it/s] 91%|█████████▏| 32/35 [00:06<00:00,  6.54it/s] 97%|█████████▋| 34/35 [00:06<00:00,  7.63it/s]100%|██████████| 35/35 [00:09<00:00,  3.69it/s]
2025-03-09 09:17:54,017 [INFO]: 	Computing best hyperparameters for index knn.index 03/09/2025, 09:17:54
2025-03-09 09:18:50,103 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 56.0851 secs
2025-03-09 09:18:50,103 [INFO]: The best hyperparameters are: efSearch=244
2025-03-09 09:18:50,103 [INFO]: 	Compute fast metrics 03/09/2025, 09:18:50
  0%|          | 0/4 [00:00<?, ?it/s] 25%|██▌       | 1/4 [00:00<00:00,  5.93it/s] 50%|█████     | 2/4 [00:00<00:00,  7.43it/s] 75%|███████▌  | 3/4 [00:00<00:00,  7.83it/s] 75%|███████▌  | 3/4 [00:00<00:00,  5.88it/s]
2025-03-09 09:19:09,518 [INFO]: 	>>> Finished "Compute fast metrics" in 19.4144 secs
2025-03-09 09:19:09,520 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 84.9851 secs
2025-03-09 09:19:09,520 [INFO]: {
2025-03-09 09:19:09,520 [INFO]: 	index_key: HNSW15
2025-03-09 09:19:09,520 [INFO]: 	index_param: efSearch=244
2025-03-09 09:19:09,520 [INFO]: 	index_path: knn.index
2025-03-09 09:19:09,520 [INFO]: 	size in bytes: 1662487450
2025-03-09 09:19:09,520 [INFO]: 	avg_search_speed_ms: 10.526916930991176
2025-03-09 09:19:09,520 [INFO]: 	99p_search_speed_ms: 19.506500172428787
2025-03-09 09:19:09,520 [INFO]: 	reconstruction error %: 0.0
2025-03-09 09:19:09,520 [INFO]: 	nb vectors: 8450
2025-03-09 09:19:09,520 [INFO]: 	vectors dimension: 49152
2025-03-09 09:19:09,521 [INFO]: 	compression ratio: 0.9993083556811211
2025-03-09 09:19:09,521 [INFO]: }
2025-03-09 09:19:09,521 [INFO]: 	>>> Finished "Creating the index" in 84.9866 secs
2025-03-09 09:19:09,521 [INFO]: >>> Finished "Launching the whole pipeline" in 85.0125 secs
2025-03-09 09:19:12: [retrieval_preprocessing] calculating distances ...
2025-03-09 09:19:15: [retrieval_preprocessing] finished and saved retrieval indices for episode 31773 [episode count 10/20]
[retrieval_preprocessing] for episode 75810 [episode count 11/20], we have num_retrieval=np.int64(8582) num_query=np.int64(515)
2025-03-09 09:19:18,277 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-09 09:19:19,480 [INFO]: Launching the whole pipeline 03/09/2025, 09:19:19
2025-03-09 09:19:19,481 [INFO]: Reading total number of vectors and dimension 03/09/2025, 09:19:19
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1041.29it/s]
2025-03-09 09:19:19,507 [INFO]: There are 8582 embeddings of dim 49152
2025-03-09 09:19:19,508 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0271 secs
2025-03-09 09:19:19,508 [INFO]: 	Compute estimated construction time of the index 03/09/2025, 09:19:19
2025-03-09 09:19:19,508 [INFO]: 		-> Train: 16.7 minutes
2025-03-09 09:19:19,508 [INFO]: 		-> Add: 4.7 seconds
2025-03-09 09:19:19,508 [INFO]: 		Total: 16.7 minutes
2025-03-09 09:19:19,508 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0001 secs
2025-03-09 09:19:19,508 [INFO]: 	Checking that your have enough memory available to create the index 03/09/2025, 09:19:19
2025-03-09 09:19:19,508 [INFO]: 1.7GB of memory will be needed to build the index (more might be used if you have more)
2025-03-09 09:19:19,508 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0001 secs
2025-03-09 09:19:19,508 [INFO]: 	Selecting most promising index types given data characteristics 03/09/2025, 09:19:19
2025-03-09 09:19:19,508 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-09 09:19:19,508 [INFO]: 	Creating the index 03/09/2025, 09:19:19
2025-03-09 09:19:19,508 [INFO]: 		-> Instanciate the index HNSW15 03/09/2025, 09:19:19
2025-03-09 09:19:19,509 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0010 secs
2025-03-09 09:19:19,509 [INFO]: 		-> Adding the vectors to the index 03/09/2025, 09:19:19
2025-03-09 09:19:19,509 [INFO]: The memory available for adding the vectors is 48.4GB(total available - used by the index)
2025-03-09 09:19:19,509 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/35 [00:00<?, ?it/s]  3%|▎         | 1/35 [00:00<00:07,  4.69it/s]  9%|▊         | 3/35 [00:00<00:03,  8.25it/s] 14%|█▍        | 5/35 [00:00<00:03,  9.93it/s] 20%|██        | 7/35 [00:00<00:02, 10.88it/s] 26%|██▌       | 9/35 [00:00<00:02, 11.44it/s] 31%|███▏      | 11/35 [00:01<00:02, 11.60it/s] 37%|███▋      | 13/35 [00:01<00:01, 11.57it/s] 43%|████▎     | 15/35 [00:01<00:01, 11.58it/s] 49%|████▊     | 17/35 [00:01<00:01, 11.55it/s] 54%|█████▍    | 19/35 [00:01<00:01, 11.32it/s] 60%|██████    | 21/35 [00:05<00:08,  1.64it/s] 63%|██████▎   | 22/35 [00:05<00:06,  1.93it/s] 66%|██████▌   | 23/35 [00:05<00:05,  2.31it/s] 71%|███████▏  | 25/35 [00:05<00:03,  3.24it/s] 77%|███████▋  | 27/35 [00:05<00:01,  4.26it/s] 83%|████████▎ | 29/35 [00:06<00:01,  5.29it/s] 86%|████████▌ | 30/35 [00:06<00:00,  5.80it/s] 91%|█████████▏| 32/35 [00:06<00:00,  6.85it/s] 97%|█████████▋| 34/35 [00:06<00:00,  7.73it/s]100%|██████████| 35/35 [00:10<00:00,  3.34it/s]
2025-03-09 09:19:30,012 [INFO]: 	Computing best hyperparameters for index knn.index 03/09/2025, 09:19:30
2025-03-09 09:20:24,602 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 54.5890 secs
2025-03-09 09:20:24,602 [INFO]: The best hyperparameters are: efSearch=246
2025-03-09 09:20:24,602 [INFO]: 	Compute fast metrics 03/09/2025, 09:20:24
  0%|          | 0/4 [00:00<?, ?it/s] 25%|██▌       | 1/4 [00:00<00:00,  5.47it/s] 50%|█████     | 2/4 [00:00<00:00,  7.04it/s] 75%|███████▌  | 3/4 [00:00<00:00,  7.86it/s] 75%|███████▌  | 3/4 [00:00<00:00,  5.87it/s]
2025-03-09 09:20:47,687 [INFO]: 	>>> Finished "Compute fast metrics" in 23.0848 secs
2025-03-09 09:20:47,689 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 88.1798 secs
2025-03-09 09:20:47,689 [INFO]: {
2025-03-09 09:20:47,689 [INFO]: 	index_key: HNSW15
2025-03-09 09:20:47,689 [INFO]: 	index_param: efSearch=246
2025-03-09 09:20:47,689 [INFO]: 	index_path: knn.index
2025-03-09 09:20:47,689 [INFO]: 	size in bytes: 1688457610
2025-03-09 09:20:47,689 [INFO]: 	avg_search_speed_ms: 10.19402480491697
2025-03-09 09:20:47,689 [INFO]: 	99p_search_speed_ms: 17.017723505850853
2025-03-09 09:20:47,689 [INFO]: 	reconstruction error %: 0.0
2025-03-09 09:20:47,689 [INFO]: 	nb vectors: 8582
2025-03-09 09:20:47,689 [INFO]: 	vectors dimension: 49152
2025-03-09 09:20:47,689 [INFO]: 	compression ratio: 0.9993083900992931
2025-03-09 09:20:47,689 [INFO]: }
2025-03-09 09:20:47,689 [INFO]: 	>>> Finished "Creating the index" in 88.1813 secs
2025-03-09 09:20:47,690 [INFO]: >>> Finished "Launching the whole pipeline" in 88.2090 secs
2025-03-09 09:20:51: [retrieval_preprocessing] calculating distances ...
2025-03-09 09:20:53: [retrieval_preprocessing] finished and saved retrieval indices for episode 75810 [episode count 11/20]
[retrieval_preprocessing] for episode 93220 [episode count 12/20], we have num_retrieval=np.int64(8634) num_query=np.int64(463)
2025-03-09 09:20:56,255 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-09 09:20:57,491 [INFO]: Launching the whole pipeline 03/09/2025, 09:20:57
2025-03-09 09:20:57,491 [INFO]: Reading total number of vectors and dimension 03/09/2025, 09:20:57
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1162.82it/s]
2025-03-09 09:20:57,518 [INFO]: There are 8634 embeddings of dim 49152
2025-03-09 09:20:57,518 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0278 secs
2025-03-09 09:20:57,519 [INFO]: 	Compute estimated construction time of the index 03/09/2025, 09:20:57
2025-03-09 09:20:57,519 [INFO]: 		-> Train: 16.7 minutes
2025-03-09 09:20:57,519 [INFO]: 		-> Add: 4.7 seconds
2025-03-09 09:20:57,519 [INFO]: 		Total: 16.7 minutes
2025-03-09 09:20:57,519 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0001 secs
2025-03-09 09:20:57,519 [INFO]: 	Checking that your have enough memory available to create the index 03/09/2025, 09:20:57
2025-03-09 09:20:57,519 [INFO]: 1.7GB of memory will be needed to build the index (more might be used if you have more)
2025-03-09 09:20:57,519 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0003 secs
2025-03-09 09:20:57,519 [INFO]: 	Selecting most promising index types given data characteristics 03/09/2025, 09:20:57
2025-03-09 09:20:57,519 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-09 09:20:57,519 [INFO]: 	Creating the index 03/09/2025, 09:20:57
2025-03-09 09:20:57,519 [INFO]: 		-> Instanciate the index HNSW15 03/09/2025, 09:20:57
2025-03-09 09:20:57,520 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0011 secs
2025-03-09 09:20:57,520 [INFO]: 		-> Adding the vectors to the index 03/09/2025, 09:20:57
2025-03-09 09:20:57,521 [INFO]: The memory available for adding the vectors is 48.4GB(total available - used by the index)
2025-03-09 09:20:57,521 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/35 [00:00<?, ?it/s]  3%|▎         | 1/35 [00:00<00:07,  4.63it/s]  6%|▌         | 2/35 [00:00<00:05,  6.36it/s]  9%|▊         | 3/35 [00:00<00:04,  7.27it/s] 11%|█▏        | 4/35 [00:00<00:03,  7.80it/s] 14%|█▍        | 5/35 [00:00<00:03,  8.13it/s] 17%|█▋        | 6/35 [00:00<00:03,  8.29it/s] 20%|██        | 7/35 [00:00<00:03,  8.46it/s] 23%|██▎       | 8/35 [00:01<00:03,  8.54it/s] 26%|██▌       | 9/35 [00:01<00:03,  8.62it/s] 29%|██▊       | 10/35 [00:01<00:02,  8.74it/s] 31%|███▏      | 11/35 [00:01<00:02,  8.70it/s] 37%|███▋      | 13/35 [00:01<00:02,  9.35it/s] 40%|████      | 14/35 [00:01<00:02,  9.18it/s] 43%|████▎     | 15/35 [00:01<00:02,  8.97it/s] 46%|████▌     | 16/35 [00:01<00:02,  8.94it/s] 49%|████▊     | 17/35 [00:02<00:02,  8.98it/s] 51%|█████▏    | 18/35 [00:02<00:01,  8.84it/s] 57%|█████▋    | 20/35 [00:02<00:01,  9.88it/s] 60%|██████    | 21/35 [00:05<00:13,  1.06it/s] 66%|██████▌   | 23/35 [00:06<00:07,  1.68it/s] 71%|███████▏  | 25/35 [00:06<00:04,  2.48it/s] 77%|███████▋  | 27/35 [00:06<00:02,  3.44it/s] 83%|████████▎ | 29/35 [00:06<00:01,  4.56it/s] 89%|████████▊ | 31/35 [00:06<00:00,  5.77it/s] 94%|█████████▍| 33/35 [00:06<00:00,  6.98it/s]100%|██████████| 35/35 [00:09<00:00,  1.70it/s]100%|██████████| 35/35 [00:09<00:00,  3.51it/s]
2025-03-09 09:21:07,509 [INFO]: 	Computing best hyperparameters for index knn.index 03/09/2025, 09:21:07
2025-03-09 09:22:03,290 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 55.7801 secs
2025-03-09 09:22:03,290 [INFO]: The best hyperparameters are: efSearch=282
2025-03-09 09:22:03,290 [INFO]: 	Compute fast metrics 03/09/2025, 09:22:03
  0%|          | 0/4 [00:00<?, ?it/s] 25%|██▌       | 1/4 [00:00<00:00,  5.54it/s] 50%|█████     | 2/4 [00:00<00:00,  7.05it/s] 75%|███████▌  | 3/4 [00:00<00:00,  7.53it/s] 75%|███████▌  | 3/4 [00:00<00:00,  5.39it/s]
2025-03-09 09:22:32,146 [INFO]: 	>>> Finished "Compute fast metrics" in 28.8553 secs
2025-03-09 09:22:32,148 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 94.6276 secs
2025-03-09 09:22:32,148 [INFO]: {
2025-03-09 09:22:32,148 [INFO]: 	index_key: HNSW15
2025-03-09 09:22:32,148 [INFO]: 	index_param: efSearch=282
2025-03-09 09:22:32,148 [INFO]: 	index_path: knn.index
2025-03-09 09:22:32,148 [INFO]: 	size in bytes: 1698688270
2025-03-09 09:22:32,148 [INFO]: 	avg_search_speed_ms: 11.712628225599627
2025-03-09 09:22:32,148 [INFO]: 	99p_search_speed_ms: 23.004257392603908
2025-03-09 09:22:32,148 [INFO]: 	reconstruction error %: 0.0
2025-03-09 09:22:32,148 [INFO]: 	nb vectors: 8634
2025-03-09 09:22:32,148 [INFO]: 	vectors dimension: 49152
2025-03-09 09:22:32,148 [INFO]: 	compression ratio: 0.9993084087170391
2025-03-09 09:22:32,148 [INFO]: }
2025-03-09 09:22:32,148 [INFO]: 	>>> Finished "Creating the index" in 94.6292 secs
2025-03-09 09:22:32,148 [INFO]: >>> Finished "Launching the whole pipeline" in 94.6579 secs
2025-03-09 09:22:35: [retrieval_preprocessing] calculating distances ...
2025-03-09 09:22:36: [retrieval_preprocessing] finished and saved retrieval indices for episode 93220 [episode count 12/20]
[retrieval_preprocessing] for episode 38443 [episode count 13/20], we have num_retrieval=np.int64(8731) num_query=np.int64(366)
2025-03-09 09:22:39,245 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-09 09:22:40,523 [INFO]: Launching the whole pipeline 03/09/2025, 09:22:40
2025-03-09 09:22:40,523 [INFO]: Reading total number of vectors and dimension 03/09/2025, 09:22:40
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1281.88it/s]
2025-03-09 09:22:40,551 [INFO]: There are 8731 embeddings of dim 49152
2025-03-09 09:22:40,552 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0285 secs
2025-03-09 09:22:40,552 [INFO]: 	Compute estimated construction time of the index 03/09/2025, 09:22:40
2025-03-09 09:22:40,552 [INFO]: 		-> Train: 16.7 minutes
2025-03-09 09:22:40,552 [INFO]: 		-> Add: 4.8 seconds
2025-03-09 09:22:40,552 [INFO]: 		Total: 16.7 minutes
2025-03-09 09:22:40,552 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0001 secs
2025-03-09 09:22:40,552 [INFO]: 	Checking that your have enough memory available to create the index 03/09/2025, 09:22:40
2025-03-09 09:22:40,552 [INFO]: 1.8GB of memory will be needed to build the index (more might be used if you have more)
2025-03-09 09:22:40,552 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0002 secs
2025-03-09 09:22:40,552 [INFO]: 	Selecting most promising index types given data characteristics 03/09/2025, 09:22:40
2025-03-09 09:22:40,552 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-09 09:22:40,552 [INFO]: 	Creating the index 03/09/2025, 09:22:40
2025-03-09 09:22:40,552 [INFO]: 		-> Instanciate the index HNSW15 03/09/2025, 09:22:40
2025-03-09 09:22:40,554 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0017 secs
2025-03-09 09:22:40,554 [INFO]: 		-> Adding the vectors to the index 03/09/2025, 09:22:40
2025-03-09 09:22:40,554 [INFO]: The memory available for adding the vectors is 48.4GB(total available - used by the index)
2025-03-09 09:22:40,554 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/36 [00:00<?, ?it/s]  3%|▎         | 1/36 [00:00<00:07,  4.59it/s]  8%|▊         | 3/36 [00:00<00:03,  8.95it/s] 14%|█▍        | 5/36 [00:00<00:02, 12.13it/s] 19%|█▉        | 7/36 [00:00<00:02, 13.73it/s] 25%|██▌       | 9/36 [00:00<00:01, 14.26it/s] 31%|███       | 11/36 [00:00<00:01, 13.25it/s] 36%|███▌      | 13/36 [00:01<00:01, 12.83it/s] 42%|████▏     | 15/36 [00:01<00:01, 12.59it/s] 47%|████▋     | 17/36 [00:01<00:01, 12.45it/s] 53%|█████▎    | 19/36 [00:01<00:01, 12.13it/s] 58%|█████▊    | 21/36 [00:05<00:10,  1.37it/s] 64%|██████▍   | 23/36 [00:06<00:06,  1.87it/s] 69%|██████▉   | 25/36 [00:06<00:04,  2.55it/s] 75%|███████▌  | 27/36 [00:06<00:02,  3.33it/s] 81%|████████  | 29/36 [00:06<00:01,  4.27it/s] 86%|████████▌ | 31/36 [00:06<00:00,  5.29it/s] 92%|█████████▏| 33/36 [00:06<00:00,  6.38it/s] 97%|█████████▋| 35/36 [00:07<00:00,  6.86it/s]100%|██████████| 36/36 [00:10<00:00,  3.39it/s]
2025-03-09 09:22:51,189 [INFO]: 	Computing best hyperparameters for index knn.index 03/09/2025, 09:22:51
2025-03-09 09:23:47,743 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 56.5528 secs
2025-03-09 09:23:47,743 [INFO]: The best hyperparameters are: efSearch=248
2025-03-09 09:23:47,743 [INFO]: 	Compute fast metrics 03/09/2025, 09:23:47
  0%|          | 0/4 [00:00<?, ?it/s] 25%|██▌       | 1/4 [00:00<00:00,  5.58it/s] 50%|█████     | 2/4 [00:00<00:00,  7.32it/s] 75%|███████▌  | 3/4 [00:00<00:00,  8.33it/s] 75%|███████▌  | 3/4 [00:00<00:00,  6.18it/s]
2025-03-09 09:24:06,082 [INFO]: 	>>> Finished "Compute fast metrics" in 18.3389 secs
2025-03-09 09:24:06,085 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 85.5306 secs
2025-03-09 09:24:06,085 [INFO]: {
2025-03-09 09:24:06,085 [INFO]: 	index_key: HNSW15
2025-03-09 09:24:06,085 [INFO]: 	index_param: efSearch=248
2025-03-09 09:24:06,085 [INFO]: 	index_path: knn.index
2025-03-09 09:24:06,085 [INFO]: 	size in bytes: 1717772350
2025-03-09 09:24:06,085 [INFO]: 	avg_search_speed_ms: 12.824564626237425
2025-03-09 09:24:06,085 [INFO]: 	99p_search_speed_ms: 25.89179895585405
2025-03-09 09:24:06,085 [INFO]: 	reconstruction error %: 0.0
2025-03-09 09:24:06,085 [INFO]: 	nb vectors: 8731
2025-03-09 09:24:06,085 [INFO]: 	vectors dimension: 49152
2025-03-09 09:24:06,085 [INFO]: 	compression ratio: 0.9993084636622542
2025-03-09 09:24:06,085 [INFO]: }
2025-03-09 09:24:06,085 [INFO]: 	>>> Finished "Creating the index" in 85.5330 secs
2025-03-09 09:24:06,085 [INFO]: >>> Finished "Launching the whole pipeline" in 85.5622 secs
2025-03-09 09:24:08: [retrieval_preprocessing] calculating distances ...
2025-03-09 09:24:10: [retrieval_preprocessing] finished and saved retrieval indices for episode 38443 [episode count 13/20]
[retrieval_preprocessing] for episode 53291 [episode count 14/20], we have num_retrieval=np.int64(8609) num_query=np.int64(488)
2025-03-09 09:24:12,771 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-09 09:24:13,968 [INFO]: Launching the whole pipeline 03/09/2025, 09:24:13
2025-03-09 09:24:13,968 [INFO]: Reading total number of vectors and dimension 03/09/2025, 09:24:13
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 978.61it/s]
2025-03-09 09:24:13,994 [INFO]: There are 8609 embeddings of dim 49152
2025-03-09 09:24:13,994 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0267 secs
2025-03-09 09:24:13,995 [INFO]: 	Compute estimated construction time of the index 03/09/2025, 09:24:13
2025-03-09 09:24:13,995 [INFO]: 		-> Train: 16.7 minutes
2025-03-09 09:24:13,995 [INFO]: 		-> Add: 4.7 seconds
2025-03-09 09:24:13,995 [INFO]: 		Total: 16.7 minutes
2025-03-09 09:24:13,995 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0001 secs
2025-03-09 09:24:13,995 [INFO]: 	Checking that your have enough memory available to create the index 03/09/2025, 09:24:13
2025-03-09 09:24:13,995 [INFO]: 1.7GB of memory will be needed to build the index (more might be used if you have more)
2025-03-09 09:24:13,995 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0003 secs
2025-03-09 09:24:13,995 [INFO]: 	Selecting most promising index types given data characteristics 03/09/2025, 09:24:13
2025-03-09 09:24:13,995 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-09 09:24:13,995 [INFO]: 	Creating the index 03/09/2025, 09:24:13
2025-03-09 09:24:13,995 [INFO]: 		-> Instanciate the index HNSW15 03/09/2025, 09:24:13
2025-03-09 09:24:13,996 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0010 secs
2025-03-09 09:24:13,996 [INFO]: 		-> Adding the vectors to the index 03/09/2025, 09:24:13
2025-03-09 09:24:13,996 [INFO]: The memory available for adding the vectors is 48.4GB(total available - used by the index)
2025-03-09 09:24:13,996 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/35 [00:00<?, ?it/s]  3%|▎         | 1/35 [00:00<00:07,  4.40it/s]  6%|▌         | 2/35 [00:00<00:05,  6.22it/s]  9%|▊         | 3/35 [00:00<00:04,  7.22it/s] 11%|█▏        | 4/35 [00:00<00:03,  7.91it/s] 14%|█▍        | 5/35 [00:00<00:03,  8.37it/s] 17%|█▋        | 6/35 [00:00<00:03,  8.76it/s] 23%|██▎       | 8/35 [00:00<00:02,  9.22it/s] 26%|██▌       | 9/35 [00:01<00:02,  9.20it/s] 29%|██▊       | 10/35 [00:01<00:02,  9.25it/s] 34%|███▍      | 12/35 [00:01<00:02,  9.96it/s] 37%|███▋      | 13/35 [00:01<00:02,  9.70it/s] 40%|████      | 14/35 [00:01<00:02,  9.45it/s] 43%|████▎     | 15/35 [00:01<00:02,  9.30it/s] 46%|████▌     | 16/35 [00:01<00:02,  9.20it/s] 51%|█████▏    | 18/35 [00:01<00:01, 10.37it/s] 57%|█████▋    | 20/35 [00:02<00:01, 10.95it/s] 63%|██████▎   | 22/35 [00:05<00:08,  1.55it/s] 69%|██████▊   | 24/35 [00:05<00:04,  2.20it/s] 74%|███████▍  | 26/35 [00:05<00:02,  3.01it/s] 80%|████████  | 28/35 [00:05<00:01,  3.91it/s] 86%|████████▌ | 30/35 [00:06<00:01,  4.88it/s] 91%|█████████▏| 32/35 [00:06<00:00,  5.82it/s] 97%|█████████▋| 34/35 [00:06<00:00,  6.81it/s]100%|██████████| 35/35 [00:10<00:00,  3.50it/s]
2025-03-09 09:24:24,012 [INFO]: 	Computing best hyperparameters for index knn.index 03/09/2025, 09:24:24
2025-03-09 09:25:24,689 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 60.6759 secs
2025-03-09 09:25:24,689 [INFO]: The best hyperparameters are: efSearch=246
2025-03-09 09:25:24,689 [INFO]: 	Compute fast metrics 03/09/2025, 09:25:24
  0%|          | 0/4 [00:00<?, ?it/s] 25%|██▌       | 1/4 [00:00<00:00,  3.24it/s] 50%|█████     | 2/4 [00:00<00:00,  5.15it/s] 75%|███████▌  | 3/4 [00:00<00:00,  6.48it/s] 75%|███████▌  | 3/4 [00:00<00:00,  4.73it/s]
2025-03-09 09:25:49,313 [INFO]: 	>>> Finished "Compute fast metrics" in 24.6233 secs
2025-03-09 09:25:49,316 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 95.3193 secs
2025-03-09 09:25:49,316 [INFO]: {
2025-03-09 09:25:49,316 [INFO]: 	index_key: HNSW15
2025-03-09 09:25:49,316 [INFO]: 	index_param: efSearch=246
2025-03-09 09:25:49,316 [INFO]: 	index_path: knn.index
2025-03-09 09:25:49,316 [INFO]: 	size in bytes: 1693769650
2025-03-09 09:25:49,316 [INFO]: 	avg_search_speed_ms: 10.340881262084368
2025-03-09 09:25:49,316 [INFO]: 	99p_search_speed_ms: 21.002147314138718
2025-03-09 09:25:49,316 [INFO]: 	reconstruction error %: 0.0
2025-03-09 09:25:49,316 [INFO]: 	nb vectors: 8609
2025-03-09 09:25:49,316 [INFO]: 	vectors dimension: 49152
2025-03-09 09:25:49,316 [INFO]: 	compression ratio: 0.9993084195362693
2025-03-09 09:25:49,316 [INFO]: }
2025-03-09 09:25:49,316 [INFO]: 	>>> Finished "Creating the index" in 95.3208 secs
2025-03-09 09:25:49,316 [INFO]: >>> Finished "Launching the whole pipeline" in 95.3482 secs
2025-03-09 09:25:52: [retrieval_preprocessing] calculating distances ...
2025-03-09 09:25:54: [retrieval_preprocessing] finished and saved retrieval indices for episode 53291 [episode count 14/20]
[retrieval_preprocessing] for episode 86574 [episode count 15/20], we have num_retrieval=np.int64(8802) num_query=np.int64(295)
2025-03-09 09:25:57,650 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-09 09:25:58,979 [INFO]: Launching the whole pipeline 03/09/2025, 09:25:58
2025-03-09 09:25:58,979 [INFO]: Reading total number of vectors and dimension 03/09/2025, 09:25:58
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1274.48it/s]
2025-03-09 09:25:59,009 [INFO]: There are 8802 embeddings of dim 49152
2025-03-09 09:25:59,009 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0299 secs
2025-03-09 09:25:59,009 [INFO]: 	Compute estimated construction time of the index 03/09/2025, 09:25:59
2025-03-09 09:25:59,010 [INFO]: 		-> Train: 16.7 minutes
2025-03-09 09:25:59,010 [INFO]: 		-> Add: 4.8 seconds
2025-03-09 09:25:59,010 [INFO]: 		Total: 16.7 minutes
2025-03-09 09:25:59,010 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0005 secs
2025-03-09 09:25:59,010 [INFO]: 	Checking that your have enough memory available to create the index 03/09/2025, 09:25:59
2025-03-09 09:25:59,010 [INFO]: 1.8GB of memory will be needed to build the index (more might be used if you have more)
2025-03-09 09:25:59,011 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0005 secs
2025-03-09 09:25:59,011 [INFO]: 	Selecting most promising index types given data characteristics 03/09/2025, 09:25:59
2025-03-09 09:25:59,011 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-09 09:25:59,011 [INFO]: 	Creating the index 03/09/2025, 09:25:59
2025-03-09 09:25:59,011 [INFO]: 		-> Instanciate the index HNSW15 03/09/2025, 09:25:59
2025-03-09 09:25:59,014 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0028 secs
2025-03-09 09:25:59,014 [INFO]: 		-> Adding the vectors to the index 03/09/2025, 09:25:59
2025-03-09 09:25:59,015 [INFO]: The memory available for adding the vectors is 48.4GB(total available - used by the index)
2025-03-09 09:25:59,015 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/36 [00:00<?, ?it/s]  3%|▎         | 1/36 [00:00<00:07,  4.94it/s]  8%|▊         | 3/36 [00:00<00:03,  8.88it/s] 14%|█▍        | 5/36 [00:00<00:03, 10.24it/s] 19%|█▉        | 7/36 [00:00<00:02, 11.12it/s] 25%|██▌       | 9/36 [00:00<00:02, 11.55it/s] 31%|███       | 11/36 [00:01<00:02, 11.72it/s] 36%|███▌      | 13/36 [00:01<00:01, 12.42it/s] 42%|████▏     | 15/36 [00:01<00:01, 12.39it/s] 47%|████▋     | 17/36 [00:01<00:01, 12.36it/s] 53%|█████▎    | 19/36 [00:01<00:01, 12.30it/s] 58%|█████▊    | 21/36 [00:05<00:08,  1.74it/s] 64%|██████▍   | 23/36 [00:05<00:05,  2.34it/s] 69%|██████▉   | 25/36 [00:05<00:03,  3.10it/s] 75%|███████▌  | 27/36 [00:05<00:02,  4.02it/s] 81%|████████  | 29/36 [00:05<00:01,  5.06it/s] 86%|████████▌ | 31/36 [00:05<00:00,  6.16it/s] 92%|█████████▏| 33/36 [00:06<00:00,  7.24it/s] 97%|█████████▋| 35/36 [00:06<00:00,  8.27it/s]100%|██████████| 36/36 [00:09<00:00,  3.92it/s]
2025-03-09 09:26:08,202 [INFO]: 	Computing best hyperparameters for index knn.index 03/09/2025, 09:26:08
2025-03-09 09:27:07,589 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 59.3866 secs
2025-03-09 09:27:07,590 [INFO]: The best hyperparameters are: efSearch=243
2025-03-09 09:27:07,590 [INFO]: 	Compute fast metrics 03/09/2025, 09:27:07
  0%|          | 0/4 [00:00<?, ?it/s] 25%|██▌       | 1/4 [00:00<00:00,  5.23it/s] 50%|█████     | 2/4 [00:00<00:00,  6.93it/s] 75%|███████▌  | 3/4 [00:00<00:00,  7.71it/s] 75%|███████▌  | 3/4 [00:00<00:00,  5.75it/s]
2025-03-09 09:27:29,777 [INFO]: 	>>> Finished "Compute fast metrics" in 22.1873 secs
2025-03-09 09:27:29,780 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 90.7652 secs
2025-03-09 09:27:29,780 [INFO]: {
2025-03-09 09:27:29,780 [INFO]: 	index_key: HNSW15
2025-03-09 09:27:29,780 [INFO]: 	index_param: efSearch=243
2025-03-09 09:27:29,780 [INFO]: 	index_path: knn.index
2025-03-09 09:27:29,780 [INFO]: 	size in bytes: 1731741310
2025-03-09 09:27:29,780 [INFO]: 	avg_search_speed_ms: 10.652300271158989
2025-03-09 09:27:29,780 [INFO]: 	99p_search_speed_ms: 20.222668880596757
2025-03-09 09:27:29,780 [INFO]: 	reconstruction error %: 0.0
2025-03-09 09:27:29,780 [INFO]: 	nb vectors: 8802
2025-03-09 09:27:29,780 [INFO]: 	vectors dimension: 49152
2025-03-09 09:27:29,780 [INFO]: 	compression ratio: 0.9993083874634832
2025-03-09 09:27:29,780 [INFO]: }
2025-03-09 09:27:29,780 [INFO]: 	>>> Finished "Creating the index" in 90.7690 secs
2025-03-09 09:27:29,780 [INFO]: >>> Finished "Launching the whole pipeline" in 90.8009 secs
2025-03-09 09:27:31: [retrieval_preprocessing] calculating distances ...
2025-03-09 09:27:32: [retrieval_preprocessing] finished and saved retrieval indices for episode 86574 [episode count 15/20]
[retrieval_preprocessing] for episode 12847 [episode count 16/20], we have num_retrieval=np.int64(8650) num_query=np.int64(447)
2025-03-09 09:27:35,613 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-09 09:27:37,007 [INFO]: Launching the whole pipeline 03/09/2025, 09:27:37
2025-03-09 09:27:37,007 [INFO]: Reading total number of vectors and dimension 03/09/2025, 09:27:37
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1627.59it/s]
2025-03-09 09:27:37,031 [INFO]: There are 8650 embeddings of dim 49152
2025-03-09 09:27:37,032 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0247 secs
2025-03-09 09:27:37,032 [INFO]: 	Compute estimated construction time of the index 03/09/2025, 09:27:37
2025-03-09 09:27:37,032 [INFO]: 		-> Train: 16.7 minutes
2025-03-09 09:27:37,032 [INFO]: 		-> Add: 4.8 seconds
2025-03-09 09:27:37,032 [INFO]: 		Total: 16.7 minutes
2025-03-09 09:27:37,032 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0002 secs
2025-03-09 09:27:37,032 [INFO]: 	Checking that your have enough memory available to create the index 03/09/2025, 09:27:37
2025-03-09 09:27:37,032 [INFO]: 1.7GB of memory will be needed to build the index (more might be used if you have more)
2025-03-09 09:27:37,032 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0002 secs
2025-03-09 09:27:37,032 [INFO]: 	Selecting most promising index types given data characteristics 03/09/2025, 09:27:37
2025-03-09 09:27:37,032 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-09 09:27:37,032 [INFO]: 	Creating the index 03/09/2025, 09:27:37
2025-03-09 09:27:37,032 [INFO]: 		-> Instanciate the index HNSW15 03/09/2025, 09:27:37
2025-03-09 09:27:37,034 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0012 secs
2025-03-09 09:27:37,034 [INFO]: 		-> Adding the vectors to the index 03/09/2025, 09:27:37
2025-03-09 09:27:37,034 [INFO]: The memory available for adding the vectors is 48.4GB(total available - used by the index)
2025-03-09 09:27:37,034 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/36 [00:00<?, ?it/s]  3%|▎         | 1/36 [00:00<00:07,  4.55it/s]  6%|▌         | 2/36 [00:00<00:05,  6.30it/s]  8%|▊         | 3/36 [00:00<00:04,  7.18it/s] 11%|█         | 4/36 [00:00<00:04,  7.69it/s] 14%|█▍        | 5/36 [00:00<00:03,  8.01it/s] 17%|█▋        | 6/36 [00:00<00:03,  8.16it/s] 19%|█▉        | 7/36 [00:00<00:03,  8.28it/s] 22%|██▏       | 8/36 [00:01<00:03,  8.05it/s] 25%|██▌       | 9/36 [00:01<00:03,  8.03it/s] 28%|██▊       | 10/36 [00:01<00:03,  8.12it/s] 31%|███       | 11/36 [00:01<00:03,  8.15it/s] 33%|███▎      | 12/36 [00:01<00:02,  8.19it/s] 36%|███▌      | 13/36 [00:01<00:02,  8.21it/s] 39%|███▉      | 14/36 [00:01<00:02,  8.20it/s] 42%|████▏     | 15/36 [00:01<00:02,  8.21it/s] 44%|████▍     | 16/36 [00:02<00:02,  8.11it/s] 47%|████▋     | 17/36 [00:02<00:02,  8.23it/s] 50%|█████     | 18/36 [00:02<00:02,  8.22it/s] 53%|█████▎    | 19/36 [00:02<00:02,  8.19it/s] 56%|█████▌    | 20/36 [00:02<00:01,  8.10it/s] 58%|█████▊    | 21/36 [00:06<00:17,  1.20s/it] 61%|██████    | 22/36 [00:06<00:12,  1.15it/s] 67%|██████▋   | 24/36 [00:06<00:06,  1.97it/s] 72%|███████▏  | 26/36 [00:06<00:03,  2.96it/s] 78%|███████▊  | 28/36 [00:06<00:01,  4.07it/s] 83%|████████▎ | 30/36 [00:06<00:01,  5.29it/s] 89%|████████▉ | 32/36 [00:07<00:00,  6.54it/s] 94%|█████████▍| 34/36 [00:07<00:00,  7.69it/s]100%|██████████| 36/36 [00:10<00:00,  1.73it/s]100%|██████████| 36/36 [00:10<00:00,  3.45it/s]
2025-03-09 09:27:47,462 [INFO]: 	Computing best hyperparameters for index knn.index 03/09/2025, 09:27:47
2025-03-09 09:28:41,665 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 54.2025 secs
2025-03-09 09:28:41,665 [INFO]: The best hyperparameters are: efSearch=249
2025-03-09 09:28:41,665 [INFO]: 	Compute fast metrics 03/09/2025, 09:28:41
  0%|          | 0/4 [00:00<?, ?it/s] 25%|██▌       | 1/4 [00:00<00:00,  5.17it/s] 50%|█████     | 2/4 [00:00<00:00,  6.72it/s] 75%|███████▌  | 3/4 [00:00<00:00,  7.64it/s] 75%|███████▌  | 3/4 [00:00<00:00,  5.70it/s]
2025-03-09 09:29:13,473 [INFO]: 	>>> Finished "Compute fast metrics" in 31.8074 secs
2025-03-09 09:29:13,476 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 96.4418 secs
2025-03-09 09:29:13,476 [INFO]: {
2025-03-09 09:29:13,476 [INFO]: 	index_key: HNSW15
2025-03-09 09:29:13,476 [INFO]: 	index_param: efSearch=249
2025-03-09 09:29:13,476 [INFO]: 	index_path: knn.index
2025-03-09 09:29:13,476 [INFO]: 	size in bytes: 1701836290
2025-03-09 09:29:13,476 [INFO]: 	avg_search_speed_ms: 10.160739717217602
2025-03-09 09:29:13,476 [INFO]: 	99p_search_speed_ms: 19.042770941741754
2025-03-09 09:29:13,476 [INFO]: 	reconstruction error %: 0.0
2025-03-09 09:29:13,476 [INFO]: 	nb vectors: 8650
2025-03-09 09:29:13,476 [INFO]: 	vectors dimension: 49152
2025-03-09 09:29:13,476 [INFO]: 	compression ratio: 0.9993083412271107
2025-03-09 09:29:13,476 [INFO]: }
2025-03-09 09:29:13,476 [INFO]: 	>>> Finished "Creating the index" in 96.4435 secs
2025-03-09 09:29:13,476 [INFO]: >>> Finished "Launching the whole pipeline" in 96.4690 secs
2025-03-09 09:29:16: [retrieval_preprocessing] calculating distances ...
2025-03-09 09:29:18: [retrieval_preprocessing] finished and saved retrieval indices for episode 12847 [episode count 16/20]
[retrieval_preprocessing] for episode 13360 [episode count 17/20], we have num_retrieval=np.int64(8598) num_query=np.int64(499)
2025-03-09 09:29:22,380 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-09 09:29:23,583 [INFO]: Launching the whole pipeline 03/09/2025, 09:29:23
2025-03-09 09:29:23,583 [INFO]: Reading total number of vectors and dimension 03/09/2025, 09:29:23
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1132.98it/s]
2025-03-09 09:29:23,609 [INFO]: There are 8598 embeddings of dim 49152
2025-03-09 09:29:23,609 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0259 secs
2025-03-09 09:29:23,609 [INFO]: 	Compute estimated construction time of the index 03/09/2025, 09:29:23
2025-03-09 09:29:23,609 [INFO]: 		-> Train: 16.7 minutes
2025-03-09 09:29:23,609 [INFO]: 		-> Add: 4.7 seconds
2025-03-09 09:29:23,609 [INFO]: 		Total: 16.7 minutes
2025-03-09 09:29:23,609 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0001 secs
2025-03-09 09:29:23,609 [INFO]: 	Checking that your have enough memory available to create the index 03/09/2025, 09:29:23
2025-03-09 09:29:23,610 [INFO]: 1.7GB of memory will be needed to build the index (more might be used if you have more)
2025-03-09 09:29:23,610 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0001 secs
2025-03-09 09:29:23,610 [INFO]: 	Selecting most promising index types given data characteristics 03/09/2025, 09:29:23
2025-03-09 09:29:23,610 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-09 09:29:23,610 [INFO]: 	Creating the index 03/09/2025, 09:29:23
2025-03-09 09:29:23,610 [INFO]: 		-> Instanciate the index HNSW15 03/09/2025, 09:29:23
2025-03-09 09:29:23,611 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0009 secs
2025-03-09 09:29:23,611 [INFO]: 		-> Adding the vectors to the index 03/09/2025, 09:29:23
2025-03-09 09:29:23,611 [INFO]: The memory available for adding the vectors is 48.4GB(total available - used by the index)
2025-03-09 09:29:23,611 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/35 [00:00<?, ?it/s]  3%|▎         | 1/35 [00:00<00:06,  5.27it/s]  9%|▊         | 3/35 [00:00<00:03,  9.59it/s] 14%|█▍        | 5/35 [00:00<00:02, 11.18it/s] 20%|██        | 7/35 [00:00<00:02, 12.47it/s] 26%|██▌       | 9/35 [00:00<00:02, 12.47it/s] 31%|███▏      | 11/35 [00:01<00:02, 10.95it/s] 37%|███▋      | 13/35 [00:01<00:02, 10.25it/s] 43%|████▎     | 15/35 [00:01<00:02,  9.80it/s] 49%|████▊     | 17/35 [00:01<00:01, 10.02it/s] 54%|█████▍    | 19/35 [00:01<00:01, 10.62it/s] 60%|██████    | 21/35 [00:05<00:08,  1.69it/s] 63%|██████▎   | 22/35 [00:05<00:06,  1.98it/s] 69%|██████▊   | 24/35 [00:05<00:03,  2.78it/s] 74%|███████▍  | 26/35 [00:05<00:02,  3.73it/s] 80%|████████  | 28/35 [00:05<00:01,  4.79it/s] 86%|████████▌ | 30/35 [00:05<00:00,  5.92it/s] 91%|█████████▏| 32/35 [00:06<00:00,  7.05it/s] 97%|█████████▋| 34/35 [00:06<00:00,  8.15it/s]100%|██████████| 35/35 [00:09<00:00,  3.65it/s]
2025-03-09 09:29:33,197 [INFO]: 	Computing best hyperparameters for index knn.index 03/09/2025, 09:29:33
2025-03-09 09:30:32,881 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 59.6839 secs
2025-03-09 09:30:32,882 [INFO]: The best hyperparameters are: efSearch=268
2025-03-09 09:30:32,882 [INFO]: 	Compute fast metrics 03/09/2025, 09:30:32
  0%|          | 0/4 [00:00<?, ?it/s] 25%|██▌       | 1/4 [00:00<00:00,  5.57it/s] 50%|█████     | 2/4 [00:00<00:00,  7.44it/s] 75%|███████▌  | 3/4 [00:00<00:00,  8.25it/s] 75%|███████▌  | 3/4 [00:00<00:00,  6.18it/s]
2025-03-09 09:31:02,443 [INFO]: 	>>> Finished "Compute fast metrics" in 29.5615 secs
2025-03-09 09:31:02,446 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 98.8349 secs
2025-03-09 09:31:02,446 [INFO]: {
2025-03-09 09:31:02,446 [INFO]: 	index_key: HNSW15
2025-03-09 09:31:02,446 [INFO]: 	index_param: efSearch=268
2025-03-09 09:31:02,446 [INFO]: 	index_path: knn.index
2025-03-09 09:31:02,446 [INFO]: 	size in bytes: 1691605510
2025-03-09 09:31:02,446 [INFO]: 	avg_search_speed_ms: 10.733647284481691
2025-03-09 09:31:02,446 [INFO]: 	99p_search_speed_ms: 19.944474315270725
2025-03-09 09:31:02,446 [INFO]: 	reconstruction error %: 0.0
2025-03-09 09:31:02,446 [INFO]: 	nb vectors: 8598
2025-03-09 09:31:02,446 [INFO]: 	vectors dimension: 49152
2025-03-09 09:31:02,446 [INFO]: 	compression ratio: 0.9993083931252978
2025-03-09 09:31:02,446 [INFO]: }
2025-03-09 09:31:02,446 [INFO]: 	>>> Finished "Creating the index" in 98.8364 secs
2025-03-09 09:31:02,446 [INFO]: >>> Finished "Launching the whole pipeline" in 98.8628 secs
2025-03-09 09:31:05: [retrieval_preprocessing] calculating distances ...
2025-03-09 09:31:07: [retrieval_preprocessing] finished and saved retrieval indices for episode 13360 [episode count 17/20]
[retrieval_preprocessing] for episode 27184 [episode count 18/20], we have num_retrieval=np.int64(8623) num_query=np.int64(474)
2025-03-09 09:31:10,078 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-09 09:31:12,190 [INFO]: Launching the whole pipeline 03/09/2025, 09:31:12
2025-03-09 09:31:12,190 [INFO]: Reading total number of vectors and dimension 03/09/2025, 09:31:12
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1696.04it/s]
2025-03-09 09:31:12,215 [INFO]: There are 8623 embeddings of dim 49152
2025-03-09 09:31:12,216 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0258 secs
2025-03-09 09:31:12,216 [INFO]: 	Compute estimated construction time of the index 03/09/2025, 09:31:12
2025-03-09 09:31:12,216 [INFO]: 		-> Train: 16.7 minutes
2025-03-09 09:31:12,216 [INFO]: 		-> Add: 4.7 seconds
2025-03-09 09:31:12,216 [INFO]: 		Total: 16.7 minutes
2025-03-09 09:31:12,216 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0001 secs
2025-03-09 09:31:12,216 [INFO]: 	Checking that your have enough memory available to create the index 03/09/2025, 09:31:12
2025-03-09 09:31:12,216 [INFO]: 1.7GB of memory will be needed to build the index (more might be used if you have more)
2025-03-09 09:31:12,216 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0001 secs
2025-03-09 09:31:12,216 [INFO]: 	Selecting most promising index types given data characteristics 03/09/2025, 09:31:12
2025-03-09 09:31:12,216 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-09 09:31:12,216 [INFO]: 	Creating the index 03/09/2025, 09:31:12
2025-03-09 09:31:12,216 [INFO]: 		-> Instanciate the index HNSW15 03/09/2025, 09:31:12
2025-03-09 09:31:12,217 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0009 secs
2025-03-09 09:31:12,217 [INFO]: 		-> Adding the vectors to the index 03/09/2025, 09:31:12
2025-03-09 09:31:12,217 [INFO]: The memory available for adding the vectors is 48.4GB(total available - used by the index)
2025-03-09 09:31:12,217 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/35 [00:00<?, ?it/s]  3%|▎         | 1/35 [00:00<00:05,  6.61it/s]  9%|▊         | 3/35 [00:00<00:02, 13.04it/s] 14%|█▍        | 5/35 [00:00<00:01, 15.09it/s] 23%|██▎       | 8/35 [00:00<00:01, 17.44it/s] 29%|██▊       | 10/35 [00:00<00:01, 16.20it/s] 34%|███▍      | 12/35 [00:00<00:01, 14.20it/s] 40%|████      | 14/35 [00:01<00:01, 12.75it/s] 46%|████▌     | 16/35 [00:01<00:01, 11.78it/s] 51%|█████▏    | 18/35 [00:01<00:01, 11.34it/s] 57%|█████▋    | 20/35 [00:01<00:01, 11.07it/s] 63%|██████▎   | 22/35 [00:04<00:07,  1.75it/s] 69%|██████▊   | 24/35 [00:05<00:04,  2.36it/s] 74%|███████▍  | 26/35 [00:05<00:02,  3.13it/s] 80%|████████  | 28/35 [00:05<00:01,  4.05it/s] 86%|████████▌ | 30/35 [00:05<00:00,  5.09it/s] 91%|█████████▏| 32/35 [00:05<00:00,  6.20it/s] 97%|█████████▋| 34/35 [00:05<00:00,  7.34it/s]100%|██████████| 35/35 [00:08<00:00,  4.01it/s]
2025-03-09 09:31:20,964 [INFO]: 	Computing best hyperparameters for index knn.index 03/09/2025, 09:31:20
2025-03-09 09:32:13,472 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 52.5078 secs
2025-03-09 09:32:13,472 [INFO]: The best hyperparameters are: efSearch=317
2025-03-09 09:32:13,472 [INFO]: 	Compute fast metrics 03/09/2025, 09:32:13
  0%|          | 0/4 [00:00<?, ?it/s] 25%|██▌       | 1/4 [00:00<00:00,  5.70it/s] 50%|█████     | 2/4 [00:00<00:00,  7.12it/s] 75%|███████▌  | 3/4 [00:00<00:00,  7.80it/s] 75%|███████▌  | 3/4 [00:00<00:00,  5.81it/s]
2025-03-09 09:32:37,201 [INFO]: 	>>> Finished "Compute fast metrics" in 23.7284 secs
2025-03-09 09:32:37,203 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 84.9859 secs
2025-03-09 09:32:37,203 [INFO]: {
2025-03-09 09:32:37,203 [INFO]: 	index_key: HNSW15
2025-03-09 09:32:37,203 [INFO]: 	index_param: efSearch=317
2025-03-09 09:32:37,203 [INFO]: 	index_path: knn.index
2025-03-09 09:32:37,203 [INFO]: 	size in bytes: 1696524130
2025-03-09 09:32:37,203 [INFO]: 	avg_search_speed_ms: 12.005980781727835
2025-03-09 09:32:37,204 [INFO]: 	99p_search_speed_ms: 25.333765642717417
2025-03-09 09:32:37,204 [INFO]: 	reconstruction error %: 0.0
2025-03-09 09:32:37,204 [INFO]: 	nb vectors: 8623
2025-03-09 09:32:37,204 [INFO]: 	vectors dimension: 49152
2025-03-09 09:32:37,204 [INFO]: 	compression ratio: 0.9993083823688379
2025-03-09 09:32:37,204 [INFO]: }
2025-03-09 09:32:37,204 [INFO]: 	>>> Finished "Creating the index" in 84.9873 secs
2025-03-09 09:32:37,204 [INFO]: >>> Finished "Launching the whole pipeline" in 85.0138 secs
2025-03-09 09:32:41: [retrieval_preprocessing] calculating distances ...
2025-03-09 09:32:42: [retrieval_preprocessing] finished and saved retrieval indices for episode 27184 [episode count 18/20]
[retrieval_preprocessing] for episode 76339 [episode count 19/20], we have num_retrieval=np.int64(8626) num_query=np.int64(471)
2025-03-09 09:32:45,427 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-09 09:32:46,824 [INFO]: Launching the whole pipeline 03/09/2025, 09:32:46
2025-03-09 09:32:46,824 [INFO]: Reading total number of vectors and dimension 03/09/2025, 09:32:46
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1705.69it/s]
2025-03-09 09:32:46,849 [INFO]: There are 8626 embeddings of dim 49152
2025-03-09 09:32:46,850 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0255 secs
2025-03-09 09:32:46,850 [INFO]: 	Compute estimated construction time of the index 03/09/2025, 09:32:46
2025-03-09 09:32:46,850 [INFO]: 		-> Train: 16.7 minutes
2025-03-09 09:32:46,850 [INFO]: 		-> Add: 4.7 seconds
2025-03-09 09:32:46,850 [INFO]: 		Total: 16.7 minutes
2025-03-09 09:32:46,850 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0001 secs
2025-03-09 09:32:46,850 [INFO]: 	Checking that your have enough memory available to create the index 03/09/2025, 09:32:46
2025-03-09 09:32:46,850 [INFO]: 1.7GB of memory will be needed to build the index (more might be used if you have more)
2025-03-09 09:32:46,850 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0001 secs
2025-03-09 09:32:46,850 [INFO]: 	Selecting most promising index types given data characteristics 03/09/2025, 09:32:46
2025-03-09 09:32:46,850 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-09 09:32:46,850 [INFO]: 	Creating the index 03/09/2025, 09:32:46
2025-03-09 09:32:46,850 [INFO]: 		-> Instanciate the index HNSW15 03/09/2025, 09:32:46
2025-03-09 09:32:46,851 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0009 secs
2025-03-09 09:32:46,851 [INFO]: 		-> Adding the vectors to the index 03/09/2025, 09:32:46
2025-03-09 09:32:46,851 [INFO]: The memory available for adding the vectors is 48.4GB(total available - used by the index)
2025-03-09 09:32:46,851 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/35 [00:00<?, ?it/s]  3%|▎         | 1/35 [00:00<00:07,  4.48it/s]  6%|▌         | 2/35 [00:00<00:05,  6.30it/s]  9%|▊         | 3/35 [00:00<00:04,  7.26it/s] 11%|█▏        | 4/35 [00:00<00:04,  7.71it/s] 14%|█▍        | 5/35 [00:00<00:03,  7.92it/s] 17%|█▋        | 6/35 [00:00<00:03,  8.12it/s] 20%|██        | 7/35 [00:00<00:03,  8.31it/s] 23%|██▎       | 8/35 [00:01<00:03,  8.41it/s] 26%|██▌       | 9/35 [00:01<00:03,  8.32it/s] 29%|██▊       | 10/35 [00:01<00:03,  8.27it/s] 31%|███▏      | 11/35 [00:01<00:02,  8.31it/s] 34%|███▍      | 12/35 [00:01<00:02,  8.37it/s] 37%|███▋      | 13/35 [00:01<00:02,  8.53it/s] 40%|████      | 14/35 [00:01<00:02,  8.65it/s] 43%|████▎     | 15/35 [00:01<00:02,  8.68it/s] 49%|████▊     | 17/35 [00:02<00:01,  9.73it/s] 54%|█████▍    | 19/35 [00:02<00:01, 10.49it/s] 60%|██████    | 21/35 [00:05<00:10,  1.36it/s] 66%|██████▌   | 23/35 [00:06<00:06,  1.96it/s] 71%|███████▏  | 25/35 [00:06<00:03,  2.72it/s] 77%|███████▋  | 27/35 [00:06<00:02,  3.71it/s] 83%|████████▎ | 29/35 [00:06<00:01,  4.77it/s] 89%|████████▊ | 31/35 [00:06<00:00,  5.87it/s] 94%|█████████▍| 33/35 [00:06<00:00,  7.04it/s]100%|██████████| 35/35 [00:10<00:00,  1.67it/s]100%|██████████| 35/35 [00:10<00:00,  3.46it/s]
2025-03-09 09:32:56,965 [INFO]: 	Computing best hyperparameters for index knn.index 03/09/2025, 09:32:56
2025-03-09 09:33:56,103 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 59.1373 secs
2025-03-09 09:33:56,104 [INFO]: The best hyperparameters are: efSearch=253
2025-03-09 09:33:56,104 [INFO]: 	Compute fast metrics 03/09/2025, 09:33:56
  0%|          | 0/4 [00:00<?, ?it/s] 25%|██▌       | 1/4 [00:00<00:02,  1.42it/s] 50%|█████     | 2/4 [00:01<00:01,  1.72it/s] 75%|███████▌  | 3/4 [00:01<00:00,  2.10it/s] 75%|███████▌  | 3/4 [00:01<00:00,  1.72it/s]
2025-03-09 09:34:30,957 [INFO]: 	>>> Finished "Compute fast metrics" in 34.8535 secs
2025-03-09 09:34:30,960 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 104.1085 secs
2025-03-09 09:34:30,960 [INFO]: {
2025-03-09 09:34:30,960 [INFO]: 	index_key: HNSW15
2025-03-09 09:34:30,960 [INFO]: 	index_param: efSearch=253
2025-03-09 09:34:30,960 [INFO]: 	index_path: knn.index
2025-03-09 09:34:30,960 [INFO]: 	size in bytes: 1697114350
2025-03-09 09:34:30,960 [INFO]: 	avg_search_speed_ms: 10.284991623816547
2025-03-09 09:34:30,960 [INFO]: 	99p_search_speed_ms: 19.928676988929507
2025-03-09 09:34:30,960 [INFO]: 	reconstruction error %: 0.0
2025-03-09 09:34:30,960 [INFO]: 	nb vectors: 8626
2025-03-09 09:34:30,960 [INFO]: 	vectors dimension: 49152
2025-03-09 09:34:30,960 [INFO]: 	compression ratio: 0.9993083895613751
2025-03-09 09:34:30,960 [INFO]: }
2025-03-09 09:34:30,960 [INFO]: 	>>> Finished "Creating the index" in 104.1100 secs
2025-03-09 09:34:30,960 [INFO]: >>> Finished "Launching the whole pipeline" in 104.1360 secs
2025-03-09 09:34:33: [retrieval_preprocessing] calculating distances ...
2025-03-09 09:34:35: [retrieval_preprocessing] finished and saved retrieval indices for episode 76339 [episode count 19/20]
2025-03-09 09:34:35: [retrieval_preprocessing] finished for (5207831207, 'cup') [chosen_id count 6/10]
2025-03-09 09:34:39: [retrieval_preprocessing] concatenated all embeddings and indices for 20 episodes for (3774560981, 'cloth') [chosen_id count 7/10]
2025-03-09 09:34:39: [retrieval_preprocessing] we have num_total=8898 embedding_dim=49152
[retrieval_preprocessing] for episode 37378 [episode count 0/20], we have num_retrieval=np.int64(8250) num_query=np.int64(648)
2025-03-09 09:34:42,079 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-09 09:34:43,519 [INFO]: Launching the whole pipeline 03/09/2025, 09:34:43
2025-03-09 09:34:43,519 [INFO]: Reading total number of vectors and dimension 03/09/2025, 09:34:43
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 2268.42it/s]
2025-03-09 09:34:43,543 [INFO]: There are 8250 embeddings of dim 49152
2025-03-09 09:34:43,544 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0243 secs
2025-03-09 09:34:43,544 [INFO]: 	Compute estimated construction time of the index 03/09/2025, 09:34:43
2025-03-09 09:34:43,544 [INFO]: 		-> Train: 16.7 minutes
2025-03-09 09:34:43,544 [INFO]: 		-> Add: 4.5 seconds
2025-03-09 09:34:43,544 [INFO]: 		Total: 16.7 minutes
2025-03-09 09:34:43,544 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0001 secs
2025-03-09 09:34:43,544 [INFO]: 	Checking that your have enough memory available to create the index 03/09/2025, 09:34:43
2025-03-09 09:34:43,544 [INFO]: 1.7GB of memory will be needed to build the index (more might be used if you have more)
2025-03-09 09:34:43,544 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0002 secs
2025-03-09 09:34:43,544 [INFO]: 	Selecting most promising index types given data characteristics 03/09/2025, 09:34:43
2025-03-09 09:34:43,544 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-09 09:34:43,544 [INFO]: 	Creating the index 03/09/2025, 09:34:43
2025-03-09 09:34:43,544 [INFO]: 		-> Instanciate the index HNSW15 03/09/2025, 09:34:43
2025-03-09 09:34:43,546 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0011 secs
2025-03-09 09:34:43,546 [INFO]: 		-> Adding the vectors to the index 03/09/2025, 09:34:43
2025-03-09 09:34:43,546 [INFO]: The memory available for adding the vectors is 48.5GB(total available - used by the index)
2025-03-09 09:34:43,546 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/34 [00:00<?, ?it/s]  3%|▎         | 1/34 [00:00<00:06,  5.08it/s]  9%|▉         | 3/34 [00:00<00:03,  8.94it/s] 15%|█▍        | 5/34 [00:00<00:02, 10.40it/s] 21%|██        | 7/34 [00:00<00:02, 11.11it/s] 26%|██▋       | 9/34 [00:00<00:02, 11.52it/s] 32%|███▏      | 11/34 [00:01<00:01, 11.71it/s] 38%|███▊      | 13/34 [00:01<00:01, 11.91it/s] 44%|████▍     | 15/34 [00:01<00:01, 11.87it/s] 50%|█████     | 17/34 [00:01<00:01, 12.03it/s] 56%|█████▌    | 19/34 [00:01<00:01, 12.09it/s] 62%|██████▏   | 21/34 [00:05<00:08,  1.50it/s] 74%|███████▎  | 25/34 [00:05<00:03,  2.72it/s] 79%|███████▉  | 27/34 [00:05<00:02,  3.38it/s] 85%|████████▌ | 29/34 [00:06<00:01,  4.18it/s] 91%|█████████ | 31/34 [00:06<00:00,  5.08it/s] 97%|█████████▋| 33/34 [00:06<00:00,  6.09it/s]100%|██████████| 34/34 [00:09<00:00,  3.57it/s]
2025-03-09 09:34:53,077 [INFO]: 	Computing best hyperparameters for index knn.index 03/09/2025, 09:34:53
2025-03-09 09:35:54,275 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 61.1970 secs
2025-03-09 09:35:54,276 [INFO]: The best hyperparameters are: efSearch=280
2025-03-09 09:35:54,276 [INFO]: 	Compute fast metrics 03/09/2025, 09:35:54
  0%|          | 0/4 [00:00<?, ?it/s] 25%|██▌       | 1/4 [00:00<00:00,  5.77it/s] 50%|█████     | 2/4 [00:00<00:00,  7.55it/s] 75%|███████▌  | 3/4 [00:00<00:00,  8.11it/s] 75%|███████▌  | 3/4 [00:00<00:00,  6.09it/s]
2025-03-09 09:36:15,606 [INFO]: 	>>> Finished "Compute fast metrics" in 21.3298 secs
2025-03-09 09:36:15,608 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 92.0628 secs
2025-03-09 09:36:15,609 [INFO]: {
2025-03-09 09:36:15,609 [INFO]: 	index_key: HNSW15
2025-03-09 09:36:15,609 [INFO]: 	index_param: efSearch=280
2025-03-09 09:36:15,609 [INFO]: 	index_path: knn.index
2025-03-09 09:36:15,609 [INFO]: 	size in bytes: 1623138790
2025-03-09 09:36:15,609 [INFO]: 	avg_search_speed_ms: 13.743245180384102
2025-03-09 09:36:15,609 [INFO]: 	99p_search_speed_ms: 24.574088526424024
2025-03-09 09:36:15,609 [INFO]: 	reconstruction error %: 0.0
2025-03-09 09:36:15,609 [INFO]: 	nb vectors: 8250
2025-03-09 09:36:15,609 [INFO]: 	vectors dimension: 49152
2025-03-09 09:36:15,609 [INFO]: 	compression ratio: 0.9993082600163846
2025-03-09 09:36:15,609 [INFO]: }
2025-03-09 09:36:15,609 [INFO]: 	>>> Finished "Creating the index" in 92.0645 secs
2025-03-09 09:36:15,609 [INFO]: >>> Finished "Launching the whole pipeline" in 92.0895 secs
2025-03-09 09:36:21: [retrieval_preprocessing] calculating distances ...
2025-03-09 09:36:24: [retrieval_preprocessing] finished and saved retrieval indices for episode 37378 [episode count 0/20]
[retrieval_preprocessing] for episode 35339 [episode count 1/20], we have num_retrieval=np.int64(8394) num_query=np.int64(504)
2025-03-09 09:36:28,343 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-09 09:36:29,655 [INFO]: Launching the whole pipeline 03/09/2025, 09:36:29
2025-03-09 09:36:29,655 [INFO]: Reading total number of vectors and dimension 03/09/2025, 09:36:29
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1125.99it/s]
2025-03-09 09:36:29,689 [INFO]: There are 8394 embeddings of dim 49152
2025-03-09 09:36:29,689 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0340 secs
2025-03-09 09:36:29,689 [INFO]: 	Compute estimated construction time of the index 03/09/2025, 09:36:29
2025-03-09 09:36:29,690 [INFO]: 		-> Train: 16.7 minutes
2025-03-09 09:36:29,690 [INFO]: 		-> Add: 4.6 seconds
2025-03-09 09:36:29,690 [INFO]: 		Total: 16.7 minutes
2025-03-09 09:36:29,690 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0004 secs
2025-03-09 09:36:29,690 [INFO]: 	Checking that your have enough memory available to create the index 03/09/2025, 09:36:29
2025-03-09 09:36:29,690 [INFO]: 1.7GB of memory will be needed to build the index (more might be used if you have more)
2025-03-09 09:36:29,691 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0003 secs
2025-03-09 09:36:29,691 [INFO]: 	Selecting most promising index types given data characteristics 03/09/2025, 09:36:29
2025-03-09 09:36:29,691 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-09 09:36:29,691 [INFO]: 	Creating the index 03/09/2025, 09:36:29
2025-03-09 09:36:29,691 [INFO]: 		-> Instanciate the index HNSW15 03/09/2025, 09:36:29
2025-03-09 09:36:29,694 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0027 secs
2025-03-09 09:36:29,694 [INFO]: 		-> Adding the vectors to the index 03/09/2025, 09:36:29
2025-03-09 09:36:29,694 [INFO]: The memory available for adding the vectors is 48.5GB(total available - used by the index)
2025-03-09 09:36:29,694 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/35 [00:00<?, ?it/s]  3%|▎         | 1/35 [00:00<00:07,  4.71it/s]  6%|▌         | 2/35 [00:00<00:05,  6.48it/s]  9%|▊         | 3/35 [00:00<00:04,  7.22it/s] 11%|█▏        | 4/35 [00:00<00:03,  7.79it/s] 14%|█▍        | 5/35 [00:00<00:03,  7.99it/s] 17%|█▋        | 6/35 [00:00<00:03,  8.04it/s] 20%|██        | 7/35 [00:00<00:03,  8.15it/s] 23%|██▎       | 8/35 [00:01<00:03,  8.18it/s] 29%|██▊       | 10/35 [00:01<00:02,  9.08it/s] 31%|███▏      | 11/35 [00:01<00:03,  7.26it/s] 34%|███▍      | 12/35 [00:01<00:03,  7.48it/s] 37%|███▋      | 13/35 [00:01<00:02,  7.54it/s] 40%|████      | 14/35 [00:01<00:02,  7.27it/s] 43%|████▎     | 15/35 [00:02<00:02,  7.14it/s] 46%|████▌     | 16/35 [00:02<00:02,  7.38it/s] 49%|████▊     | 17/35 [00:02<00:02,  7.61it/s] 51%|█████▏    | 18/35 [00:02<00:02,  7.66it/s] 54%|█████▍    | 19/35 [00:02<00:02,  7.72it/s] 57%|█████▋    | 20/35 [00:02<00:01,  7.77it/s] 60%|██████    | 21/35 [00:06<00:17,  1.23s/it] 66%|██████▌   | 23/35 [00:06<00:08,  1.42it/s] 71%|███████▏  | 25/35 [00:06<00:04,  2.20it/s] 77%|███████▋  | 27/35 [00:06<00:02,  3.14it/s] 83%|████████▎ | 29/35 [00:07<00:01,  4.24it/s] 89%|████████▊ | 31/35 [00:07<00:00,  5.47it/s] 94%|█████████▍| 33/35 [00:07<00:00,  6.68it/s]100%|██████████| 35/35 [00:10<00:00,  1.72it/s]100%|██████████| 35/35 [00:10<00:00,  3.35it/s]
2025-03-09 09:36:40,147 [INFO]: 	Computing best hyperparameters for index knn.index 03/09/2025, 09:36:40
2025-03-09 09:37:50,730 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 70.5826 secs
2025-03-09 09:37:50,730 [INFO]: The best hyperparameters are: efSearch=208
2025-03-09 09:37:50,730 [INFO]: 	Compute fast metrics 03/09/2025, 09:37:50
  0%|          | 0/4 [00:00<?, ?it/s] 25%|██▌       | 1/4 [00:00<00:00,  6.66it/s] 75%|███████▌  | 3/4 [00:00<00:00, 11.77it/s] 75%|███████▌  | 3/4 [00:00<00:00,  9.09it/s]
2025-03-09 09:38:17,335 [INFO]: 	>>> Finished "Compute fast metrics" in 26.6048 secs
2025-03-09 09:38:17,338 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 107.6434 secs
2025-03-09 09:38:17,338 [INFO]: {
2025-03-09 09:38:17,338 [INFO]: 	index_key: HNSW15
2025-03-09 09:38:17,338 [INFO]: 	index_param: efSearch=208
2025-03-09 09:38:17,338 [INFO]: 	index_path: knn.index
2025-03-09 09:38:17,338 [INFO]: 	size in bytes: 1651469770
2025-03-09 09:38:17,338 [INFO]: 	avg_search_speed_ms: 11.811514143142608
2025-03-09 09:38:17,338 [INFO]: 	99p_search_speed_ms: 22.120563355274466
2025-03-09 09:38:17,338 [INFO]: 	reconstruction error %: 0.0
2025-03-09 09:38:17,338 [INFO]: 	nb vectors: 8394
2025-03-09 09:38:17,338 [INFO]: 	vectors dimension: 49152
2025-03-09 09:38:17,338 [INFO]: 	compression ratio: 0.9993083627561647
2025-03-09 09:38:17,338 [INFO]: }
2025-03-09 09:38:17,338 [INFO]: 	>>> Finished "Creating the index" in 107.6469 secs
2025-03-09 09:38:17,338 [INFO]: >>> Finished "Launching the whole pipeline" in 107.6826 secs
2025-03-09 09:38:20: [retrieval_preprocessing] calculating distances ...
2025-03-09 09:38:22: [retrieval_preprocessing] finished and saved retrieval indices for episode 35339 [episode count 1/20]
[retrieval_preprocessing] for episode 79381 [episode count 2/20], we have num_retrieval=np.int64(8493) num_query=np.int64(405)
2025-03-09 09:38:25,230 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-09 09:38:26,424 [INFO]: Launching the whole pipeline 03/09/2025, 09:38:26
2025-03-09 09:38:26,424 [INFO]: Reading total number of vectors and dimension 03/09/2025, 09:38:26
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1132.37it/s]
2025-03-09 09:38:26,454 [INFO]: There are 8493 embeddings of dim 49152
2025-03-09 09:38:26,454 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0307 secs
2025-03-09 09:38:26,455 [INFO]: 	Compute estimated construction time of the index 03/09/2025, 09:38:26
2025-03-09 09:38:26,455 [INFO]: 		-> Train: 16.7 minutes
2025-03-09 09:38:26,455 [INFO]: 		-> Add: 4.7 seconds
2025-03-09 09:38:26,455 [INFO]: 		Total: 16.7 minutes
2025-03-09 09:38:26,455 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0004 secs
2025-03-09 09:38:26,455 [INFO]: 	Checking that your have enough memory available to create the index 03/09/2025, 09:38:26
2025-03-09 09:38:26,456 [INFO]: 1.7GB of memory will be needed to build the index (more might be used if you have more)
2025-03-09 09:38:26,456 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0005 secs
2025-03-09 09:38:26,456 [INFO]: 	Selecting most promising index types given data characteristics 03/09/2025, 09:38:26
2025-03-09 09:38:26,456 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-09 09:38:26,456 [INFO]: 	Creating the index 03/09/2025, 09:38:26
2025-03-09 09:38:26,456 [INFO]: 		-> Instanciate the index HNSW15 03/09/2025, 09:38:26
2025-03-09 09:38:26,459 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0027 secs
2025-03-09 09:38:26,459 [INFO]: 		-> Adding the vectors to the index 03/09/2025, 09:38:26
2025-03-09 09:38:26,460 [INFO]: The memory available for adding the vectors is 48.4GB(total available - used by the index)
2025-03-09 09:38:26,460 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/35 [00:00<?, ?it/s]  3%|▎         | 1/35 [00:00<00:06,  5.45it/s]  9%|▊         | 3/35 [00:00<00:02, 11.10it/s] 14%|█▍        | 5/35 [00:00<00:02, 13.54it/s] 20%|██        | 7/35 [00:00<00:01, 14.20it/s] 26%|██▌       | 9/35 [00:00<00:01, 13.74it/s] 31%|███▏      | 11/35 [00:00<00:01, 12.90it/s] 37%|███▋      | 13/35 [00:01<00:01, 12.55it/s] 43%|████▎     | 15/35 [00:01<00:01, 12.19it/s] 49%|████▊     | 17/35 [00:01<00:01, 11.83it/s] 54%|█████▍    | 19/35 [00:01<00:01, 11.58it/s] 60%|██████    | 21/35 [00:05<00:09,  1.52it/s] 63%|██████▎   | 22/35 [00:05<00:07,  1.79it/s] 69%|██████▊   | 24/35 [00:05<00:04,  2.52it/s] 74%|███████▍  | 26/35 [00:05<00:02,  3.39it/s] 80%|████████  | 28/35 [00:06<00:01,  4.39it/s] 86%|████████▌ | 30/35 [00:06<00:00,  5.48it/s] 91%|█████████▏| 32/35 [00:06<00:00,  6.60it/s] 97%|█████████▋| 34/35 [00:06<00:00,  7.68it/s]100%|██████████| 35/35 [00:10<00:00,  3.49it/s]
2025-03-09 09:38:36,504 [INFO]: 	Computing best hyperparameters for index knn.index 03/09/2025, 09:38:36
2025-03-09 09:39:42,714 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 66.2105 secs
2025-03-09 09:39:42,715 [INFO]: The best hyperparameters are: efSearch=212
2025-03-09 09:39:42,715 [INFO]: 	Compute fast metrics 03/09/2025, 09:39:42
  0%|          | 0/4 [00:00<?, ?it/s] 25%|██▌       | 1/4 [00:00<00:00,  7.40it/s] 50%|█████     | 2/4 [00:00<00:00,  8.33it/s] 75%|███████▌  | 3/4 [00:00<00:00,  8.53it/s] 75%|███████▌  | 3/4 [00:00<00:00,  6.49it/s]
2025-03-09 09:40:07,258 [INFO]: 	>>> Finished "Compute fast metrics" in 24.5428 secs
2025-03-09 09:40:07,260 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 100.8005 secs
2025-03-09 09:40:07,260 [INFO]: {
2025-03-09 09:40:07,260 [INFO]: 	index_key: HNSW15
2025-03-09 09:40:07,260 [INFO]: 	index_param: efSearch=212
2025-03-09 09:40:07,260 [INFO]: 	index_path: knn.index
2025-03-09 09:40:07,260 [INFO]: 	size in bytes: 1670947510
2025-03-09 09:40:07,260 [INFO]: 	avg_search_speed_ms: 11.121558523255176
2025-03-09 09:40:07,260 [INFO]: 	99p_search_speed_ms: 17.147871889173985
2025-03-09 09:40:07,260 [INFO]: 	reconstruction error %: 0.0
2025-03-09 09:40:07,260 [INFO]: 	nb vectors: 8493
2025-03-09 09:40:07,260 [INFO]: 	vectors dimension: 49152
2025-03-09 09:40:07,260 [INFO]: 	compression ratio: 0.9993083169919562
2025-03-09 09:40:07,260 [INFO]: }
2025-03-09 09:40:07,260 [INFO]: 	>>> Finished "Creating the index" in 100.8040 secs
2025-03-09 09:40:07,260 [INFO]: >>> Finished "Launching the whole pipeline" in 100.8367 secs
2025-03-09 09:40:09: [retrieval_preprocessing] calculating distances ...
2025-03-09 09:40:10: [retrieval_preprocessing] finished and saved retrieval indices for episode 79381 [episode count 2/20]
[retrieval_preprocessing] for episode 35354 [episode count 3/20], we have num_retrieval=np.int64(8394) num_query=np.int64(504)
2025-03-09 09:40:13,861 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-09 09:40:14,957 [INFO]: Launching the whole pipeline 03/09/2025, 09:40:14
2025-03-09 09:40:14,957 [INFO]: Reading total number of vectors and dimension 03/09/2025, 09:40:14
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1147.87it/s]
2025-03-09 09:40:14,986 [INFO]: There are 8394 embeddings of dim 49152
2025-03-09 09:40:14,986 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0292 secs
2025-03-09 09:40:14,986 [INFO]: 	Compute estimated construction time of the index 03/09/2025, 09:40:14
2025-03-09 09:40:14,987 [INFO]: 		-> Train: 16.7 minutes
2025-03-09 09:40:14,987 [INFO]: 		-> Add: 4.6 seconds
2025-03-09 09:40:14,987 [INFO]: 		Total: 16.7 minutes
2025-03-09 09:40:14,987 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0002 secs
2025-03-09 09:40:14,987 [INFO]: 	Checking that your have enough memory available to create the index 03/09/2025, 09:40:14
2025-03-09 09:40:14,987 [INFO]: 1.7GB of memory will be needed to build the index (more might be used if you have more)
2025-03-09 09:40:14,987 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0002 secs
2025-03-09 09:40:14,987 [INFO]: 	Selecting most promising index types given data characteristics 03/09/2025, 09:40:14
2025-03-09 09:40:14,987 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-09 09:40:14,987 [INFO]: 	Creating the index 03/09/2025, 09:40:14
2025-03-09 09:40:14,987 [INFO]: 		-> Instanciate the index HNSW15 03/09/2025, 09:40:14
2025-03-09 09:40:14,989 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0016 secs
2025-03-09 09:40:14,989 [INFO]: 		-> Adding the vectors to the index 03/09/2025, 09:40:14
2025-03-09 09:40:14,989 [INFO]: The memory available for adding the vectors is 48.5GB(total available - used by the index)
2025-03-09 09:40:14,989 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/35 [00:00<?, ?it/s]  3%|▎         | 1/35 [00:00<00:08,  4.24it/s]  6%|▌         | 2/35 [00:00<00:05,  6.04it/s]  9%|▊         | 3/35 [00:00<00:04,  7.01it/s] 11%|█▏        | 4/35 [00:00<00:04,  7.59it/s] 14%|█▍        | 5/35 [00:00<00:03,  8.02it/s] 17%|█▋        | 6/35 [00:00<00:03,  8.35it/s] 23%|██▎       | 8/35 [00:00<00:02,  9.31it/s] 26%|██▌       | 9/35 [00:01<00:02,  9.16it/s] 29%|██▊       | 10/35 [00:01<00:02,  8.96it/s] 31%|███▏      | 11/35 [00:01<00:02,  8.84it/s] 34%|███▍      | 12/35 [00:01<00:02,  8.89it/s] 37%|███▋      | 13/35 [00:01<00:02,  8.86it/s] 40%|████      | 14/35 [00:01<00:02,  8.83it/s] 43%|████▎     | 15/35 [00:01<00:02,  8.96it/s] 46%|████▌     | 16/35 [00:01<00:02,  8.84it/s] 49%|████▊     | 17/35 [00:02<00:02,  8.95it/s] 51%|█████▏    | 18/35 [00:02<00:01,  8.87it/s] 54%|█████▍    | 19/35 [00:02<00:01,  8.79it/s] 57%|█████▋    | 20/35 [00:02<00:01,  8.77it/s] 60%|██████    | 21/35 [00:06<00:18,  1.29s/it] 66%|██████▌   | 23/35 [00:06<00:08,  1.36it/s] 71%|███████▏  | 25/35 [00:06<00:04,  2.11it/s] 77%|███████▋  | 27/35 [00:06<00:02,  3.02it/s] 83%|████████▎ | 29/35 [00:07<00:01,  4.07it/s] 89%|████████▊ | 31/35 [00:07<00:00,  5.23it/s] 94%|█████████▍| 33/35 [00:07<00:00,  6.40it/s]100%|██████████| 35/35 [00:10<00:00,  1.62it/s]100%|██████████| 35/35 [00:10<00:00,  3.30it/s]
2025-03-09 09:40:25,614 [INFO]: 	Computing best hyperparameters for index knn.index 03/09/2025, 09:40:25
2025-03-09 09:41:32,513 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 66.8990 secs
2025-03-09 09:41:32,513 [INFO]: The best hyperparameters are: efSearch=217
2025-03-09 09:41:32,514 [INFO]: 	Compute fast metrics 03/09/2025, 09:41:32
  0%|          | 0/4 [00:00<?, ?it/s] 25%|██▌       | 1/4 [00:00<00:00,  4.80it/s] 50%|█████     | 2/4 [00:00<00:00,  6.24it/s] 75%|███████▌  | 3/4 [00:00<00:00,  6.97it/s] 75%|███████▌  | 3/4 [00:00<00:00,  5.08it/s]
2025-03-09 09:42:00,387 [INFO]: 	>>> Finished "Compute fast metrics" in 27.8737 secs
2025-03-09 09:42:00,390 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 105.4005 secs
2025-03-09 09:42:00,390 [INFO]: {
2025-03-09 09:42:00,390 [INFO]: 	index_key: HNSW15
2025-03-09 09:42:00,390 [INFO]: 	index_param: efSearch=217
2025-03-09 09:42:00,390 [INFO]: 	index_path: knn.index
2025-03-09 09:42:00,390 [INFO]: 	size in bytes: 1651469770
2025-03-09 09:42:00,390 [INFO]: 	avg_search_speed_ms: 11.457730887696693
2025-03-09 09:42:00,390 [INFO]: 	99p_search_speed_ms: 20.308853313326836
2025-03-09 09:42:00,390 [INFO]: 	reconstruction error %: 0.0
2025-03-09 09:42:00,390 [INFO]: 	nb vectors: 8394
2025-03-09 09:42:00,390 [INFO]: 	vectors dimension: 49152
2025-03-09 09:42:00,390 [INFO]: 	compression ratio: 0.9993083627561647
2025-03-09 09:42:00,390 [INFO]: }
2025-03-09 09:42:00,390 [INFO]: 	>>> Finished "Creating the index" in 105.4027 secs
2025-03-09 09:42:00,390 [INFO]: >>> Finished "Launching the whole pipeline" in 105.4329 secs
2025-03-09 09:42:03: [retrieval_preprocessing] calculating distances ...
2025-03-09 09:42:05: [retrieval_preprocessing] finished and saved retrieval indices for episode 35354 [episode count 3/20]
[retrieval_preprocessing] for episode 63515 [episode count 4/20], we have num_retrieval=np.int64(8585) num_query=np.int64(313)
2025-03-09 09:42:08,585 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-09 09:42:09,887 [INFO]: Launching the whole pipeline 03/09/2025, 09:42:09
2025-03-09 09:42:09,887 [INFO]: Reading total number of vectors and dimension 03/09/2025, 09:42:09
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1083.24it/s]
2025-03-09 09:42:09,912 [INFO]: There are 8585 embeddings of dim 49152
2025-03-09 09:42:09,913 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0253 secs
2025-03-09 09:42:09,913 [INFO]: 	Compute estimated construction time of the index 03/09/2025, 09:42:09
2025-03-09 09:42:09,913 [INFO]: 		-> Train: 16.7 minutes
2025-03-09 09:42:09,913 [INFO]: 		-> Add: 4.7 seconds
2025-03-09 09:42:09,913 [INFO]: 		Total: 16.7 minutes
2025-03-09 09:42:09,913 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0001 secs
2025-03-09 09:42:09,913 [INFO]: 	Checking that your have enough memory available to create the index 03/09/2025, 09:42:09
2025-03-09 09:42:09,913 [INFO]: 1.7GB of memory will be needed to build the index (more might be used if you have more)
2025-03-09 09:42:09,913 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0001 secs
2025-03-09 09:42:09,913 [INFO]: 	Selecting most promising index types given data characteristics 03/09/2025, 09:42:09
2025-03-09 09:42:09,913 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-09 09:42:09,913 [INFO]: 	Creating the index 03/09/2025, 09:42:09
2025-03-09 09:42:09,913 [INFO]: 		-> Instanciate the index HNSW15 03/09/2025, 09:42:09
2025-03-09 09:42:09,914 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0009 secs
2025-03-09 09:42:09,914 [INFO]: 		-> Adding the vectors to the index 03/09/2025, 09:42:09
2025-03-09 09:42:09,914 [INFO]: The memory available for adding the vectors is 48.4GB(total available - used by the index)
2025-03-09 09:42:09,914 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/35 [00:00<?, ?it/s]  3%|▎         | 1/35 [00:00<00:07,  4.31it/s]  6%|▌         | 2/35 [00:00<00:05,  6.12it/s]  9%|▊         | 3/35 [00:00<00:04,  6.99it/s] 11%|█▏        | 4/35 [00:00<00:04,  7.47it/s] 14%|█▍        | 5/35 [00:00<00:03,  7.86it/s] 17%|█▋        | 6/35 [00:00<00:03,  8.10it/s] 20%|██        | 7/35 [00:00<00:03,  8.36it/s] 23%|██▎       | 8/35 [00:01<00:03,  8.48it/s] 26%|██▌       | 9/35 [00:01<00:03,  8.53it/s] 29%|██▊       | 10/35 [00:01<00:02,  8.40it/s] 31%|███▏      | 11/35 [00:01<00:02,  8.34it/s] 34%|███▍      | 12/35 [00:01<00:02,  8.43it/s] 37%|███▋      | 13/35 [00:01<00:02,  8.39it/s] 40%|████      | 14/35 [00:01<00:02,  8.41it/s] 43%|████▎     | 15/35 [00:01<00:02,  8.43it/s] 46%|████▌     | 16/35 [00:01<00:02,  8.56it/s] 49%|████▊     | 17/35 [00:02<00:02,  8.64it/s] 54%|█████▍    | 19/35 [00:02<00:01, 10.01it/s] 60%|██████    | 21/35 [00:06<00:11,  1.17it/s] 66%|██████▌   | 23/35 [00:06<00:06,  1.74it/s] 71%|███████▏  | 25/35 [00:06<00:04,  2.47it/s] 77%|███████▋  | 27/35 [00:06<00:02,  3.35it/s] 83%|████████▎ | 29/35 [00:06<00:01,  4.37it/s] 89%|████████▊ | 31/35 [00:07<00:00,  5.54it/s] 94%|█████████▍| 33/35 [00:07<00:00,  6.79it/s]100%|██████████| 35/35 [00:11<00:00,  1.34it/s]100%|██████████| 35/35 [00:11<00:00,  3.07it/s]
2025-03-09 09:42:21,333 [INFO]: 	Computing best hyperparameters for index knn.index 03/09/2025, 09:42:21
2025-03-09 09:43:31,981 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 70.6471 secs
2025-03-09 09:43:31,981 [INFO]: The best hyperparameters are: efSearch=219
2025-03-09 09:43:31,981 [INFO]: 	Compute fast metrics 03/09/2025, 09:43:31
  0%|          | 0/4 [00:00<?, ?it/s] 25%|██▌       | 1/4 [00:00<00:00,  4.99it/s] 50%|█████     | 2/4 [00:00<00:00,  6.69it/s] 75%|███████▌  | 3/4 [00:00<00:00,  7.59it/s] 75%|███████▌  | 3/4 [00:00<00:00,  5.64it/s]
2025-03-09 09:44:10,880 [INFO]: 	>>> Finished "Compute fast metrics" in 38.8984 secs
2025-03-09 09:44:10,882 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 120.9680 secs
2025-03-09 09:44:10,882 [INFO]: {
2025-03-09 09:44:10,882 [INFO]: 	index_key: HNSW15
2025-03-09 09:44:10,882 [INFO]: 	index_param: efSearch=219
2025-03-09 09:44:10,882 [INFO]: 	index_path: knn.index
2025-03-09 09:44:10,882 [INFO]: 	size in bytes: 1689047830
2025-03-09 09:44:10,882 [INFO]: 	avg_search_speed_ms: 11.361464202160608
2025-03-09 09:44:10,882 [INFO]: 	99p_search_speed_ms: 20.624470857437714
2025-03-09 09:44:10,882 [INFO]: 	reconstruction error %: 0.0
2025-03-09 09:44:10,882 [INFO]: 	nb vectors: 8585
2025-03-09 09:44:10,882 [INFO]: 	vectors dimension: 49152
2025-03-09 09:44:10,882 [INFO]: 	compression ratio: 0.999308397323479
2025-03-09 09:44:10,882 [INFO]: }
2025-03-09 09:44:10,882 [INFO]: 	>>> Finished "Creating the index" in 120.9693 secs
2025-03-09 09:44:10,882 [INFO]: >>> Finished "Launching the whole pipeline" in 120.9952 secs
2025-03-09 09:44:12: [retrieval_preprocessing] calculating distances ...
2025-03-09 09:44:13: [retrieval_preprocessing] finished and saved retrieval indices for episode 63515 [episode count 4/20]
[retrieval_preprocessing] for episode 66590 [episode count 5/20], we have num_retrieval=np.int64(8290) num_query=np.int64(608)
2025-03-09 09:44:16,510 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-09 09:44:17,778 [INFO]: Launching the whole pipeline 03/09/2025, 09:44:17
2025-03-09 09:44:17,778 [INFO]: Reading total number of vectors and dimension 03/09/2025, 09:44:17
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1456.86it/s]
2025-03-09 09:44:17,804 [INFO]: There are 8290 embeddings of dim 49152
2025-03-09 09:44:17,804 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0254 secs
2025-03-09 09:44:17,804 [INFO]: 	Compute estimated construction time of the index 03/09/2025, 09:44:17
2025-03-09 09:44:17,804 [INFO]: 		-> Train: 16.7 minutes
2025-03-09 09:44:17,804 [INFO]: 		-> Add: 4.6 seconds
2025-03-09 09:44:17,804 [INFO]: 		Total: 16.7 minutes
2025-03-09 09:44:17,804 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0002 secs
2025-03-09 09:44:17,804 [INFO]: 	Checking that your have enough memory available to create the index 03/09/2025, 09:44:17
2025-03-09 09:44:17,804 [INFO]: 1.7GB of memory will be needed to build the index (more might be used if you have more)
2025-03-09 09:44:17,804 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0002 secs
2025-03-09 09:44:17,804 [INFO]: 	Selecting most promising index types given data characteristics 03/09/2025, 09:44:17
2025-03-09 09:44:17,804 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-09 09:44:17,804 [INFO]: 	Creating the index 03/09/2025, 09:44:17
2025-03-09 09:44:17,805 [INFO]: 		-> Instanciate the index HNSW15 03/09/2025, 09:44:17
2025-03-09 09:44:17,806 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0019 secs
2025-03-09 09:44:17,807 [INFO]: 		-> Adding the vectors to the index 03/09/2025, 09:44:17
2025-03-09 09:44:17,807 [INFO]: The memory available for adding the vectors is 48.5GB(total available - used by the index)
2025-03-09 09:44:17,807 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/34 [00:00<?, ?it/s]  3%|▎         | 1/34 [00:00<00:05,  5.96it/s]  9%|▉         | 3/34 [00:00<00:03, 10.12it/s] 15%|█▍        | 5/34 [00:00<00:02, 10.87it/s] 21%|██        | 7/34 [00:00<00:02, 11.07it/s] 26%|██▋       | 9/34 [00:00<00:02, 12.35it/s] 32%|███▏      | 11/34 [00:00<00:01, 13.33it/s] 38%|███▊      | 13/34 [00:01<00:01, 12.61it/s] 44%|████▍     | 15/34 [00:01<00:01, 11.78it/s] 50%|█████     | 17/34 [00:01<00:01, 11.33it/s] 56%|█████▌    | 19/34 [00:01<00:01, 10.90it/s] 62%|██████▏   | 21/34 [00:06<00:10,  1.28it/s] 65%|██████▍   | 22/34 [00:06<00:07,  1.52it/s] 71%|███████   | 24/34 [00:06<00:04,  2.15it/s] 76%|███████▋  | 26/34 [00:06<00:02,  2.94it/s] 82%|████████▏ | 28/34 [00:06<00:01,  3.83it/s] 88%|████████▊ | 30/34 [00:07<00:00,  4.78it/s] 94%|█████████▍| 32/34 [00:07<00:00,  5.72it/s]100%|██████████| 34/34 [00:10<00:00,  1.53it/s]100%|██████████| 34/34 [00:10<00:00,  3.14it/s]
2025-03-09 09:44:28,642 [INFO]: 	Computing best hyperparameters for index knn.index 03/09/2025, 09:44:28
2025-03-09 09:45:37,102 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 68.4602 secs
2025-03-09 09:45:37,103 [INFO]: The best hyperparameters are: efSearch=203
2025-03-09 09:45:37,103 [INFO]: 	Compute fast metrics 03/09/2025, 09:45:37
  0%|          | 0/4 [00:00<?, ?it/s] 25%|██▌       | 1/4 [00:00<00:00,  5.58it/s] 50%|█████     | 2/4 [00:00<00:00,  7.15it/s] 75%|███████▌  | 3/4 [00:00<00:00,  7.36it/s] 75%|███████▌  | 3/4 [00:00<00:00,  5.66it/s]
2025-03-09 09:45:57,508 [INFO]: 	>>> Finished "Compute fast metrics" in 20.4048 secs
2025-03-09 09:45:57,511 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 99.7043 secs
2025-03-09 09:45:57,511 [INFO]: {
2025-03-09 09:45:57,511 [INFO]: 	index_key: HNSW15
2025-03-09 09:45:57,511 [INFO]: 	index_param: efSearch=203
2025-03-09 09:45:57,511 [INFO]: 	index_path: knn.index
2025-03-09 09:45:57,511 [INFO]: 	size in bytes: 1631008510
2025-03-09 09:45:57,511 [INFO]: 	avg_search_speed_ms: 11.865294766297492
2025-03-09 09:45:57,511 [INFO]: 	99p_search_speed_ms: 22.75711201131344
2025-03-09 09:45:57,511 [INFO]: 	reconstruction error %: 0.0
2025-03-09 09:45:57,511 [INFO]: 	nb vectors: 8290
2025-03-09 09:45:57,511 [INFO]: 	vectors dimension: 49152
2025-03-09 09:45:57,511 [INFO]: 	compression ratio: 0.999308286870925
2025-03-09 09:45:57,512 [INFO]: }
2025-03-09 09:45:57,512 [INFO]: 	>>> Finished "Creating the index" in 99.7070 secs
2025-03-09 09:45:57,512 [INFO]: >>> Finished "Launching the whole pipeline" in 99.7332 secs
2025-03-09 09:46:00: [retrieval_preprocessing] calculating distances ...
2025-03-09 09:46:03: [retrieval_preprocessing] finished and saved retrieval indices for episode 66590 [episode count 5/20]
[retrieval_preprocessing] for episode 70687 [episode count 6/20], we have num_retrieval=np.int64(8447) num_query=np.int64(451)
2025-03-09 09:46:06,372 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-09 09:46:07,451 [INFO]: Launching the whole pipeline 03/09/2025, 09:46:07
2025-03-09 09:46:07,452 [INFO]: Reading total number of vectors and dimension 03/09/2025, 09:46:07
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1246.08it/s]
2025-03-09 09:46:07,478 [INFO]: There are 8447 embeddings of dim 49152
2025-03-09 09:46:07,478 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0266 secs
2025-03-09 09:46:07,478 [INFO]: 	Compute estimated construction time of the index 03/09/2025, 09:46:07
2025-03-09 09:46:07,478 [INFO]: 		-> Train: 16.7 minutes
2025-03-09 09:46:07,478 [INFO]: 		-> Add: 4.6 seconds
2025-03-09 09:46:07,478 [INFO]: 		Total: 16.7 minutes
2025-03-09 09:46:07,478 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0001 secs
2025-03-09 09:46:07,478 [INFO]: 	Checking that your have enough memory available to create the index 03/09/2025, 09:46:07
2025-03-09 09:46:07,479 [INFO]: 1.7GB of memory will be needed to build the index (more might be used if you have more)
2025-03-09 09:46:07,479 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0002 secs
2025-03-09 09:46:07,479 [INFO]: 	Selecting most promising index types given data characteristics 03/09/2025, 09:46:07
2025-03-09 09:46:07,479 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-09 09:46:07,479 [INFO]: 	Creating the index 03/09/2025, 09:46:07
2025-03-09 09:46:07,479 [INFO]: 		-> Instanciate the index HNSW15 03/09/2025, 09:46:07
2025-03-09 09:46:07,480 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0012 secs
2025-03-09 09:46:07,480 [INFO]: 		-> Adding the vectors to the index 03/09/2025, 09:46:07
2025-03-09 09:46:07,480 [INFO]: The memory available for adding the vectors is 48.5GB(total available - used by the index)
2025-03-09 09:46:07,481 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/35 [00:00<?, ?it/s]  3%|▎         | 1/35 [00:00<00:06,  5.32it/s]  9%|▊         | 3/35 [00:00<00:03,  9.33it/s] 14%|█▍        | 5/35 [00:00<00:02, 10.87it/s] 20%|██        | 7/35 [00:00<00:02, 11.64it/s] 26%|██▌       | 9/35 [00:00<00:02, 12.07it/s] 31%|███▏      | 11/35 [00:00<00:01, 12.36it/s] 37%|███▋      | 13/35 [00:01<00:01, 12.56it/s] 43%|████▎     | 15/35 [00:01<00:01, 12.67it/s] 49%|████▊     | 17/35 [00:01<00:01, 12.96it/s] 54%|█████▍    | 19/35 [00:01<00:01, 12.93it/s] 60%|██████    | 21/35 [00:05<00:09,  1.45it/s] 66%|██████▌   | 23/35 [00:05<00:06,  1.99it/s] 71%|███████▏  | 25/35 [00:06<00:03,  2.69it/s] 77%|███████▋  | 27/35 [00:06<00:02,  3.60it/s] 83%|████████▎ | 29/35 [00:06<00:01,  4.72it/s] 89%|████████▊ | 31/35 [00:06<00:00,  6.09it/s] 94%|█████████▍| 33/35 [00:06<00:00,  7.59it/s]100%|██████████| 35/35 [00:10<00:00,  1.53it/s]100%|██████████| 35/35 [00:10<00:00,  3.43it/s]
2025-03-09 09:46:17,701 [INFO]: 	Computing best hyperparameters for index knn.index 03/09/2025, 09:46:17
2025-03-09 09:47:19,533 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 61.8317 secs
2025-03-09 09:47:19,533 [INFO]: The best hyperparameters are: efSearch=213
2025-03-09 09:47:19,533 [INFO]: 	Compute fast metrics 03/09/2025, 09:47:19
  0%|          | 0/4 [00:00<?, ?it/s] 25%|██▌       | 1/4 [00:00<00:00,  7.35it/s] 50%|█████     | 2/4 [00:00<00:00,  8.47it/s] 75%|███████▌  | 3/4 [00:00<00:00,  8.63it/s] 75%|███████▌  | 3/4 [00:00<00:00,  6.45it/s]
2025-03-09 09:47:44,946 [INFO]: 	>>> Finished "Compute fast metrics" in 25.4124 secs
2025-03-09 09:47:44,949 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 97.4683 secs
2025-03-09 09:47:44,949 [INFO]: {
2025-03-09 09:47:44,949 [INFO]: 	index_key: HNSW15
2025-03-09 09:47:44,949 [INFO]: 	index_param: efSearch=213
2025-03-09 09:47:44,949 [INFO]: 	index_path: knn.index
2025-03-09 09:47:44,949 [INFO]: 	size in bytes: 1661897230
2025-03-09 09:47:44,949 [INFO]: 	avg_search_speed_ms: 12.341436677336416
2025-03-09 09:47:44,949 [INFO]: 	99p_search_speed_ms: 22.281227370258414
2025-03-09 09:47:44,949 [INFO]: 	reconstruction error %: 0.0
2025-03-09 09:47:44,949 [INFO]: 	nb vectors: 8447
2025-03-09 09:47:44,949 [INFO]: 	vectors dimension: 49152
2025-03-09 09:47:44,949 [INFO]: 	compression ratio: 0.9993083483266892
2025-03-09 09:47:44,949 [INFO]: }
2025-03-09 09:47:44,949 [INFO]: 	>>> Finished "Creating the index" in 97.4700 secs
2025-03-09 09:47:44,949 [INFO]: >>> Finished "Launching the whole pipeline" in 97.4975 secs
2025-03-09 09:47:47: [retrieval_preprocessing] calculating distances ...
2025-03-09 09:47:49: [retrieval_preprocessing] finished and saved retrieval indices for episode 70687 [episode count 6/20]
[retrieval_preprocessing] for episode 46627 [episode count 7/20], we have num_retrieval=np.int64(8445) num_query=np.int64(453)
2025-03-09 09:47:51,284 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-09 09:47:52,606 [INFO]: Launching the whole pipeline 03/09/2025, 09:47:52
2025-03-09 09:47:52,606 [INFO]: Reading total number of vectors and dimension 03/09/2025, 09:47:52
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1447.81it/s]
2025-03-09 09:47:52,643 [INFO]: There are 8445 embeddings of dim 49152
2025-03-09 09:47:52,643 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0370 secs
2025-03-09 09:47:52,643 [INFO]: 	Compute estimated construction time of the index 03/09/2025, 09:47:52
2025-03-09 09:47:52,644 [INFO]: 		-> Train: 16.7 minutes
2025-03-09 09:47:52,644 [INFO]: 		-> Add: 4.6 seconds
2025-03-09 09:47:52,644 [INFO]: 		Total: 16.7 minutes
2025-03-09 09:47:52,644 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0001 secs
2025-03-09 09:47:52,644 [INFO]: 	Checking that your have enough memory available to create the index 03/09/2025, 09:47:52
2025-03-09 09:47:52,644 [INFO]: 1.7GB of memory will be needed to build the index (more might be used if you have more)
2025-03-09 09:47:52,644 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0002 secs
2025-03-09 09:47:52,644 [INFO]: 	Selecting most promising index types given data characteristics 03/09/2025, 09:47:52
2025-03-09 09:47:52,644 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-09 09:47:52,644 [INFO]: 	Creating the index 03/09/2025, 09:47:52
2025-03-09 09:47:52,644 [INFO]: 		-> Instanciate the index HNSW15 03/09/2025, 09:47:52
2025-03-09 09:47:52,646 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0014 secs
2025-03-09 09:47:52,646 [INFO]: 		-> Adding the vectors to the index 03/09/2025, 09:47:52
2025-03-09 09:47:52,646 [INFO]: The memory available for adding the vectors is 48.5GB(total available - used by the index)
2025-03-09 09:47:52,646 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/35 [00:00<?, ?it/s]  3%|▎         | 1/35 [00:00<00:06,  5.04it/s]  9%|▊         | 3/35 [00:00<00:03, 10.48it/s] 14%|█▍        | 5/35 [00:00<00:02, 12.56it/s] 20%|██        | 7/35 [00:00<00:02, 12.25it/s] 26%|██▌       | 9/35 [00:00<00:02, 11.94it/s] 31%|███▏      | 11/35 [00:00<00:02, 11.39it/s] 37%|███▋      | 13/35 [00:01<00:01, 11.25it/s] 43%|████▎     | 15/35 [00:01<00:01, 11.01it/s] 49%|████▊     | 17/35 [00:01<00:01, 10.97it/s] 54%|█████▍    | 19/35 [00:01<00:01, 10.89it/s] 60%|██████    | 21/35 [00:05<00:09,  1.49it/s] 66%|██████▌   | 23/35 [00:05<00:05,  2.02it/s] 71%|███████▏  | 25/35 [00:06<00:03,  2.70it/s] 77%|███████▋  | 27/35 [00:06<00:02,  3.53it/s] 83%|████████▎ | 29/35 [00:06<00:01,  4.48it/s] 89%|████████▊ | 31/35 [00:06<00:00,  5.51it/s] 94%|█████████▍| 33/35 [00:06<00:00,  6.60it/s]100%|██████████| 35/35 [00:09<00:00,  1.66it/s]100%|██████████| 35/35 [00:09<00:00,  3.50it/s]
2025-03-09 09:48:02,645 [INFO]: 	Computing best hyperparameters for index knn.index 03/09/2025, 09:48:02
2025-03-09 09:49:08,014 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 65.3682 secs
2025-03-09 09:49:08,014 [INFO]: The best hyperparameters are: efSearch=224
2025-03-09 09:49:08,014 [INFO]: 	Compute fast metrics 03/09/2025, 09:49:08
  0%|          | 0/4 [00:00<?, ?it/s] 25%|██▌       | 1/4 [00:00<00:00,  3.60it/s] 50%|█████     | 2/4 [00:00<00:00,  5.50it/s] 75%|███████▌  | 3/4 [00:00<00:00,  6.65it/s] 75%|███████▌  | 3/4 [00:00<00:00,  4.87it/s]
2025-03-09 09:49:36,428 [INFO]: 	>>> Finished "Compute fast metrics" in 28.4142 secs
2025-03-09 09:49:38,131 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 105.4849 secs
2025-03-09 09:49:38,131 [INFO]: {
2025-03-09 09:49:38,131 [INFO]: 	index_key: HNSW15
2025-03-09 09:49:38,131 [INFO]: 	index_param: efSearch=224
2025-03-09 09:49:38,131 [INFO]: 	index_path: knn.index
2025-03-09 09:49:38,131 [INFO]: 	size in bytes: 1661503750
2025-03-09 09:49:38,131 [INFO]: 	avg_search_speed_ms: 12.19889235586246
2025-03-09 09:49:38,132 [INFO]: 	99p_search_speed_ms: 22.804418809246254
2025-03-09 09:49:38,132 [INFO]: 	reconstruction error %: 0.0
2025-03-09 09:49:38,132 [INFO]: 	nb vectors: 8445
2025-03-09 09:49:38,132 [INFO]: 	vectors dimension: 49152
2025-03-09 09:49:38,132 [INFO]: 	compression ratio: 0.9993083434208319
2025-03-09 09:49:38,132 [INFO]: }
2025-03-09 09:49:38,132 [INFO]: 	>>> Finished "Creating the index" in 105.4877 secs
2025-03-09 09:49:38,132 [INFO]: >>> Finished "Launching the whole pipeline" in 105.5256 secs
2025-03-09 09:49:40: [retrieval_preprocessing] calculating distances ...
2025-03-09 09:49:42: [retrieval_preprocessing] finished and saved retrieval indices for episode 46627 [episode count 7/20]
[retrieval_preprocessing] for episode 75312 [episode count 8/20], we have num_retrieval=np.int64(8552) num_query=np.int64(346)
2025-03-09 09:49:45,642 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-09 09:49:47,483 [INFO]: Launching the whole pipeline 03/09/2025, 09:49:47
2025-03-09 09:49:47,483 [INFO]: Reading total number of vectors and dimension 03/09/2025, 09:49:47
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1248.68it/s]
2025-03-09 09:49:47,512 [INFO]: There are 8552 embeddings of dim 49152
2025-03-09 09:49:47,512 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0289 secs
2025-03-09 09:49:47,512 [INFO]: 	Compute estimated construction time of the index 03/09/2025, 09:49:47
2025-03-09 09:49:47,512 [INFO]: 		-> Train: 16.7 minutes
2025-03-09 09:49:47,512 [INFO]: 		-> Add: 4.7 seconds
2025-03-09 09:49:47,512 [INFO]: 		Total: 16.7 minutes
2025-03-09 09:49:47,512 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0001 secs
2025-03-09 09:49:47,512 [INFO]: 	Checking that your have enough memory available to create the index 03/09/2025, 09:49:47
2025-03-09 09:49:47,512 [INFO]: 1.7GB of memory will be needed to build the index (more might be used if you have more)
2025-03-09 09:49:47,513 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0002 secs
2025-03-09 09:49:47,513 [INFO]: 	Selecting most promising index types given data characteristics 03/09/2025, 09:49:47
2025-03-09 09:49:47,513 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-09 09:49:47,513 [INFO]: 	Creating the index 03/09/2025, 09:49:47
2025-03-09 09:49:47,513 [INFO]: 		-> Instanciate the index HNSW15 03/09/2025, 09:49:47
2025-03-09 09:49:47,514 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0013 secs
2025-03-09 09:49:47,514 [INFO]: 		-> Adding the vectors to the index 03/09/2025, 09:49:47
2025-03-09 09:49:47,514 [INFO]: The memory available for adding the vectors is 48.4GB(total available - used by the index)
2025-03-09 09:49:47,514 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/35 [00:00<?, ?it/s]  3%|▎         | 1/35 [00:00<00:07,  4.53it/s]  6%|▌         | 2/35 [00:00<00:05,  6.34it/s]  9%|▊         | 3/35 [00:00<00:04,  7.31it/s] 11%|█▏        | 4/35 [00:00<00:03,  7.76it/s] 14%|█▍        | 5/35 [00:00<00:03,  7.97it/s] 17%|█▋        | 6/35 [00:00<00:03,  8.18it/s] 20%|██        | 7/35 [00:00<00:03,  8.51it/s] 23%|██▎       | 8/35 [00:01<00:03,  8.75it/s] 26%|██▌       | 9/35 [00:01<00:02,  8.80it/s] 29%|██▊       | 10/35 [00:01<00:02,  8.83it/s] 31%|███▏      | 11/35 [00:01<00:02,  8.88it/s] 34%|███▍      | 12/35 [00:01<00:02,  8.97it/s] 37%|███▋      | 13/35 [00:01<00:02,  8.97it/s] 40%|████      | 14/35 [00:01<00:02,  8.93it/s] 43%|████▎     | 15/35 [00:01<00:02,  8.91it/s] 46%|████▌     | 16/35 [00:01<00:02,  8.90it/s] 49%|████▊     | 17/35 [00:02<00:02,  9.00it/s] 51%|█████▏    | 18/35 [00:02<00:01,  8.95it/s] 54%|█████▍    | 19/35 [00:02<00:01,  8.90it/s] 57%|█████▋    | 20/35 [00:02<00:01,  8.88it/s] 60%|██████    | 21/35 [00:06<00:17,  1.23s/it] 63%|██████▎   | 22/35 [00:06<00:11,  1.12it/s] 69%|██████▊   | 24/35 [00:06<00:05,  1.94it/s] 74%|███████▍  | 26/35 [00:06<00:03,  2.93it/s] 80%|████████  | 28/35 [00:06<00:01,  4.05it/s] 86%|████████▌ | 30/35 [00:06<00:00,  5.26it/s] 91%|█████████▏| 32/35 [00:07<00:00,  6.52it/s] 97%|█████████▋| 34/35 [00:07<00:00,  7.69it/s]100%|██████████| 35/35 [00:10<00:00,  3.34it/s]
2025-03-09 09:49:58,004 [INFO]: 	Computing best hyperparameters for index knn.index 03/09/2025, 09:49:58
2025-03-09 09:51:08,387 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 70.3828 secs
2025-03-09 09:51:08,387 [INFO]: The best hyperparameters are: efSearch=269
2025-03-09 09:51:08,387 [INFO]: 	Compute fast metrics 03/09/2025, 09:51:08
  0%|          | 0/4 [00:00<?, ?it/s] 25%|██▌       | 1/4 [00:00<00:00,  3.45it/s] 50%|█████     | 2/4 [00:00<00:00,  5.43it/s] 75%|███████▌  | 3/4 [00:00<00:00,  5.07it/s]
2025-03-09 09:51:36,419 [INFO]: 	>>> Finished "Compute fast metrics" in 28.0317 secs
2025-03-09 09:51:36,422 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 108.9080 secs
2025-03-09 09:51:36,422 [INFO]: {
2025-03-09 09:51:36,422 [INFO]: 	index_key: HNSW15
2025-03-09 09:51:36,422 [INFO]: 	index_param: efSearch=269
2025-03-09 09:51:36,422 [INFO]: 	index_path: knn.index
2025-03-09 09:51:36,422 [INFO]: 	size in bytes: 1682555290
2025-03-09 09:51:36,422 [INFO]: 	avg_search_speed_ms: 15.367637594772672
2025-03-09 09:51:36,422 [INFO]: 	99p_search_speed_ms: 29.092064476571977
2025-03-09 09:51:36,423 [INFO]: 	reconstruction error %: 0.0
2025-03-09 09:51:36,423 [INFO]: 	nb vectors: 8552
2025-03-09 09:51:36,423 [INFO]: 	vectors dimension: 49152
2025-03-09 09:51:36,423 [INFO]: 	compression ratio: 0.9993083888494386
2025-03-09 09:51:36,423 [INFO]: }
2025-03-09 09:51:36,423 [INFO]: 	>>> Finished "Creating the index" in 108.9100 secs
2025-03-09 09:51:36,423 [INFO]: >>> Finished "Launching the whole pipeline" in 108.9395 secs
2025-03-09 09:51:39: [retrieval_preprocessing] calculating distances ...
2025-03-09 09:51:41: [retrieval_preprocessing] finished and saved retrieval indices for episode 75312 [episode count 8/20]
[retrieval_preprocessing] for episode 3121 [episode count 9/20], we have num_retrieval=np.int64(8440) num_query=np.int64(458)
2025-03-09 09:51:43,916 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-09 09:51:45,108 [INFO]: Launching the whole pipeline 03/09/2025, 09:51:45
2025-03-09 09:51:45,108 [INFO]: Reading total number of vectors and dimension 03/09/2025, 09:51:45
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1013.85it/s]
2025-03-09 09:51:45,136 [INFO]: There are 8440 embeddings of dim 49152
2025-03-09 09:51:45,136 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0281 secs
2025-03-09 09:51:45,137 [INFO]: 	Compute estimated construction time of the index 03/09/2025, 09:51:45
2025-03-09 09:51:45,137 [INFO]: 		-> Train: 16.7 minutes
2025-03-09 09:51:45,137 [INFO]: 		-> Add: 4.6 seconds
2025-03-09 09:51:45,137 [INFO]: 		Total: 16.7 minutes
2025-03-09 09:51:45,137 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0001 secs
2025-03-09 09:51:45,137 [INFO]: 	Checking that your have enough memory available to create the index 03/09/2025, 09:51:45
2025-03-09 09:51:45,137 [INFO]: 1.7GB of memory will be needed to build the index (more might be used if you have more)
2025-03-09 09:51:45,137 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0002 secs
2025-03-09 09:51:45,137 [INFO]: 	Selecting most promising index types given data characteristics 03/09/2025, 09:51:45
2025-03-09 09:51:45,137 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-09 09:51:45,137 [INFO]: 	Creating the index 03/09/2025, 09:51:45
2025-03-09 09:51:45,137 [INFO]: 		-> Instanciate the index HNSW15 03/09/2025, 09:51:45
2025-03-09 09:51:45,138 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0011 secs
2025-03-09 09:51:45,138 [INFO]: 		-> Adding the vectors to the index 03/09/2025, 09:51:45
2025-03-09 09:51:45,138 [INFO]: The memory available for adding the vectors is 48.5GB(total available - used by the index)
2025-03-09 09:51:45,139 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/35 [00:00<?, ?it/s]  3%|▎         | 1/35 [00:00<00:06,  5.42it/s]  9%|▊         | 3/35 [00:00<00:02, 10.68it/s] 14%|█▍        | 5/35 [00:00<00:02, 12.77it/s] 20%|██        | 7/35 [00:00<00:01, 14.50it/s] 26%|██▌       | 9/35 [00:00<00:01, 15.56it/s] 31%|███▏      | 11/35 [00:00<00:01, 14.80it/s] 37%|███▋      | 13/35 [00:00<00:01, 13.62it/s] 43%|████▎     | 15/35 [00:01<00:01, 13.16it/s] 49%|████▊     | 17/35 [00:01<00:01, 12.79it/s] 54%|█████▍    | 19/35 [00:01<00:01, 12.63it/s] 60%|██████    | 21/35 [00:05<00:09,  1.50it/s] 63%|██████▎   | 22/35 [00:05<00:07,  1.76it/s] 69%|██████▊   | 24/35 [00:05<00:04,  2.47it/s] 74%|███████▍  | 26/35 [00:05<00:02,  3.34it/s] 80%|████████  | 28/35 [00:06<00:01,  4.32it/s] 86%|████████▌ | 30/35 [00:06<00:00,  5.37it/s] 91%|█████████▏| 32/35 [00:06<00:00,  6.54it/s] 97%|█████████▋| 34/35 [00:06<00:00,  7.66it/s]100%|██████████| 35/35 [00:10<00:00,  3.27it/s]
2025-03-09 09:51:55,850 [INFO]: 	Computing best hyperparameters for index knn.index 03/09/2025, 09:51:55
2025-03-09 09:53:07,528 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 71.6778 secs
2025-03-09 09:53:07,528 [INFO]: The best hyperparameters are: efSearch=208
2025-03-09 09:53:07,529 [INFO]: 	Compute fast metrics 03/09/2025, 09:53:07
  0%|          | 0/4 [00:00<?, ?it/s] 25%|██▌       | 1/4 [00:00<00:00,  5.54it/s] 75%|███████▌  | 3/4 [00:00<00:00,  9.38it/s] 75%|███████▌  | 3/4 [00:00<00:00,  7.12it/s]
2025-03-09 09:53:38,489 [INFO]: 	>>> Finished "Compute fast metrics" in 30.9603 secs
2025-03-09 09:53:38,491 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 113.3525 secs
2025-03-09 09:53:38,491 [INFO]: {
2025-03-09 09:53:38,491 [INFO]: 	index_key: HNSW15
2025-03-09 09:53:38,491 [INFO]: 	index_param: efSearch=208
2025-03-09 09:53:38,491 [INFO]: 	index_path: knn.index
2025-03-09 09:53:38,491 [INFO]: 	size in bytes: 1660519930
2025-03-09 09:53:38,491 [INFO]: 	avg_search_speed_ms: 10.88173993507459
2025-03-09 09:53:38,491 [INFO]: 	99p_search_speed_ms: 18.092268528416746
2025-03-09 09:53:38,491 [INFO]: 	reconstruction error %: 0.0
2025-03-09 09:53:38,491 [INFO]: 	nb vectors: 8440
2025-03-09 09:53:38,491 [INFO]: 	vectors dimension: 49152
2025-03-09 09:53:38,491 [INFO]: 	compression ratio: 0.999308403362554
2025-03-09 09:53:38,491 [INFO]: }
2025-03-09 09:53:38,491 [INFO]: 	>>> Finished "Creating the index" in 113.3541 secs
2025-03-09 09:53:38,491 [INFO]: >>> Finished "Launching the whole pipeline" in 113.3830 secs
2025-03-09 09:53:40: [retrieval_preprocessing] calculating distances ...
2025-03-09 09:53:41: [retrieval_preprocessing] finished and saved retrieval indices for episode 3121 [episode count 9/20]
[retrieval_preprocessing] for episode 24117 [episode count 10/20], we have num_retrieval=np.int64(8602) num_query=np.int64(296)
2025-03-09 09:53:44,373 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-09 09:53:45,519 [INFO]: Launching the whole pipeline 03/09/2025, 09:53:45
2025-03-09 09:53:45,519 [INFO]: Reading total number of vectors and dimension 03/09/2025, 09:53:45
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 2215.69it/s]
2025-03-09 09:53:45,543 [INFO]: There are 8602 embeddings of dim 49152
2025-03-09 09:53:45,544 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0244 secs
2025-03-09 09:53:45,544 [INFO]: 	Compute estimated construction time of the index 03/09/2025, 09:53:45
2025-03-09 09:53:45,544 [INFO]: 		-> Train: 16.7 minutes
2025-03-09 09:53:45,544 [INFO]: 		-> Add: 4.7 seconds
2025-03-09 09:53:45,544 [INFO]: 		Total: 16.7 minutes
2025-03-09 09:53:45,544 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0001 secs
2025-03-09 09:53:45,544 [INFO]: 	Checking that your have enough memory available to create the index 03/09/2025, 09:53:45
2025-03-09 09:53:45,544 [INFO]: 1.7GB of memory will be needed to build the index (more might be used if you have more)
2025-03-09 09:53:45,544 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0001 secs
2025-03-09 09:53:45,544 [INFO]: 	Selecting most promising index types given data characteristics 03/09/2025, 09:53:45
2025-03-09 09:53:45,544 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-09 09:53:45,544 [INFO]: 	Creating the index 03/09/2025, 09:53:45
2025-03-09 09:53:45,544 [INFO]: 		-> Instanciate the index HNSW15 03/09/2025, 09:53:45
2025-03-09 09:53:45,545 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0008 secs
2025-03-09 09:53:45,545 [INFO]: 		-> Adding the vectors to the index 03/09/2025, 09:53:45
2025-03-09 09:53:45,545 [INFO]: The memory available for adding the vectors is 48.4GB(total available - used by the index)
2025-03-09 09:53:45,545 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/35 [00:00<?, ?it/s]  3%|▎         | 1/35 [00:00<00:06,  5.13it/s]  9%|▊         | 3/35 [00:00<00:03,  9.49it/s] 14%|█▍        | 5/35 [00:00<00:02, 11.15it/s] 20%|██        | 7/35 [00:00<00:02, 12.13it/s] 26%|██▌       | 9/35 [00:00<00:02, 12.55it/s] 31%|███▏      | 11/35 [00:00<00:01, 12.75it/s] 37%|███▋      | 13/35 [00:01<00:01, 12.99it/s] 43%|████▎     | 15/35 [00:01<00:01, 12.98it/s] 49%|████▊     | 17/35 [00:01<00:01, 13.05it/s] 54%|█████▍    | 19/35 [00:01<00:01, 12.95it/s] 60%|██████    | 21/35 [00:05<00:09,  1.41it/s] 63%|██████▎   | 22/35 [00:05<00:07,  1.67it/s] 69%|██████▊   | 24/35 [00:06<00:04,  2.36it/s] 74%|███████▍  | 26/35 [00:06<00:02,  3.20it/s] 80%|████████  | 28/35 [00:06<00:01,  4.21it/s] 86%|████████▌ | 30/35 [00:06<00:00,  5.31it/s] 91%|█████████▏| 32/35 [00:06<00:00,  6.46it/s] 97%|█████████▋| 34/35 [00:06<00:00,  7.63it/s]100%|██████████| 35/35 [00:10<00:00,  3.26it/s]
2025-03-09 09:53:56,275 [INFO]: 	Computing best hyperparameters for index knn.index 03/09/2025, 09:53:56
2025-03-09 09:55:08,474 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 72.1985 secs
2025-03-09 09:55:08,475 [INFO]: The best hyperparameters are: efSearch=213
2025-03-09 09:55:08,475 [INFO]: 	Compute fast metrics 03/09/2025, 09:55:08
  0%|          | 0/4 [00:00<?, ?it/s] 25%|██▌       | 1/4 [00:00<00:00,  5.29it/s] 50%|█████     | 2/4 [00:00<00:00,  6.82it/s] 75%|███████▌  | 3/4 [00:00<00:00,  7.51it/s] 75%|███████▌  | 3/4 [00:00<00:00,  5.85it/s]
2025-03-09 09:55:36,607 [INFO]: 	>>> Finished "Compute fast metrics" in 28.1325 secs
2025-03-09 09:55:36,610 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 111.0649 secs
2025-03-09 09:55:36,610 [INFO]: {
2025-03-09 09:55:36,610 [INFO]: 	index_key: HNSW15
2025-03-09 09:55:36,610 [INFO]: 	index_param: efSearch=213
2025-03-09 09:55:36,610 [INFO]: 	index_path: knn.index
2025-03-09 09:55:36,610 [INFO]: 	size in bytes: 1692392470
2025-03-09 09:55:36,610 [INFO]: 	avg_search_speed_ms: 12.531887621730846
2025-03-09 09:55:36,610 [INFO]: 	99p_search_speed_ms: 22.917331177741282
2025-03-09 09:55:36,610 [INFO]: 	reconstruction error %: 0.0
2025-03-09 09:55:36,610 [INFO]: 	nb vectors: 8602
2025-03-09 09:55:36,610 [INFO]: 	vectors dimension: 49152
2025-03-09 09:55:36,610 [INFO]: 	compression ratio: 0.9993084027371028
2025-03-09 09:55:36,610 [INFO]: }
2025-03-09 09:55:36,610 [INFO]: 	>>> Finished "Creating the index" in 111.0662 secs
2025-03-09 09:55:36,610 [INFO]: >>> Finished "Launching the whole pipeline" in 111.0912 secs
2025-03-09 09:55:38: [retrieval_preprocessing] calculating distances ...
2025-03-09 09:55:39: [retrieval_preprocessing] finished and saved retrieval indices for episode 24117 [episode count 10/20]
[retrieval_preprocessing] for episode 76854 [episode count 11/20], we have num_retrieval=np.int64(8542) num_query=np.int64(356)
2025-03-09 09:55:42,836 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-09 09:55:44,229 [INFO]: Launching the whole pipeline 03/09/2025, 09:55:44
2025-03-09 09:55:44,229 [INFO]: Reading total number of vectors and dimension 03/09/2025, 09:55:44
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1148.81it/s]
2025-03-09 09:55:44,255 [INFO]: There are 8542 embeddings of dim 49152
2025-03-09 09:55:44,255 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0264 secs
2025-03-09 09:55:44,255 [INFO]: 	Compute estimated construction time of the index 03/09/2025, 09:55:44
2025-03-09 09:55:44,255 [INFO]: 		-> Train: 16.7 minutes
2025-03-09 09:55:44,255 [INFO]: 		-> Add: 4.7 seconds
2025-03-09 09:55:44,255 [INFO]: 		Total: 16.7 minutes
2025-03-09 09:55:44,255 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0001 secs
2025-03-09 09:55:44,255 [INFO]: 	Checking that your have enough memory available to create the index 03/09/2025, 09:55:44
2025-03-09 09:55:44,255 [INFO]: 1.7GB of memory will be needed to build the index (more might be used if you have more)
2025-03-09 09:55:44,255 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0001 secs
2025-03-09 09:55:44,256 [INFO]: 	Selecting most promising index types given data characteristics 03/09/2025, 09:55:44
2025-03-09 09:55:44,256 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-09 09:55:44,256 [INFO]: 	Creating the index 03/09/2025, 09:55:44
2025-03-09 09:55:44,256 [INFO]: 		-> Instanciate the index HNSW15 03/09/2025, 09:55:44
2025-03-09 09:55:44,256 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0008 secs
2025-03-09 09:55:44,257 [INFO]: 		-> Adding the vectors to the index 03/09/2025, 09:55:44
2025-03-09 09:55:44,257 [INFO]: The memory available for adding the vectors is 48.4GB(total available - used by the index)
2025-03-09 09:55:44,257 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/35 [00:00<?, ?it/s]  3%|▎         | 1/35 [00:00<00:07,  4.78it/s]  9%|▊         | 3/35 [00:00<00:03,  8.93it/s] 14%|█▍        | 5/35 [00:00<00:02, 10.83it/s] 20%|██        | 7/35 [00:00<00:02, 11.89it/s] 26%|██▌       | 9/35 [00:00<00:02, 12.69it/s] 31%|███▏      | 11/35 [00:00<00:01, 13.06it/s] 37%|███▋      | 13/35 [00:01<00:01, 13.50it/s] 43%|████▎     | 15/35 [00:01<00:01, 13.63it/s] 49%|████▊     | 17/35 [00:01<00:01, 13.10it/s] 54%|█████▍    | 19/35 [00:01<00:01, 12.67it/s] 60%|██████    | 21/35 [00:06<00:11,  1.25it/s] 66%|██████▌   | 23/35 [00:06<00:06,  1.72it/s] 71%|███████▏  | 25/35 [00:06<00:04,  2.34it/s] 77%|███████▋  | 27/35 [00:06<00:02,  3.12it/s] 83%|████████▎ | 29/35 [00:07<00:01,  4.05it/s] 89%|████████▊ | 31/35 [00:07<00:00,  5.15it/s] 94%|█████████▍| 33/35 [00:07<00:00,  6.29it/s]100%|██████████| 35/35 [00:10<00:00,  1.56it/s]100%|██████████| 35/35 [00:10<00:00,  3.23it/s]
2025-03-09 09:55:55,112 [INFO]: 	Computing best hyperparameters for index knn.index 03/09/2025, 09:55:55
2025-03-09 09:57:06,694 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 71.5824 secs
2025-03-09 09:57:06,695 [INFO]: The best hyperparameters are: efSearch=216
2025-03-09 09:57:06,695 [INFO]: 	Compute fast metrics 03/09/2025, 09:57:06
  0%|          | 0/4 [00:00<?, ?it/s] 25%|██▌       | 1/4 [00:00<00:00,  4.83it/s] 50%|█████     | 2/4 [00:00<00:00,  6.57it/s] 75%|███████▌  | 3/4 [00:00<00:00,  7.34it/s] 75%|███████▌  | 3/4 [00:00<00:00,  5.57it/s]
2025-03-09 09:57:34,837 [INFO]: 	>>> Finished "Compute fast metrics" in 28.1422 secs
2025-03-09 09:57:34,839 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 110.5826 secs
2025-03-09 09:57:34,839 [INFO]: {
2025-03-09 09:57:34,839 [INFO]: 	index_key: HNSW15
2025-03-09 09:57:34,839 [INFO]: 	index_param: efSearch=216
2025-03-09 09:57:34,839 [INFO]: 	index_path: knn.index
2025-03-09 09:57:34,839 [INFO]: 	size in bytes: 1680587890
2025-03-09 09:57:34,839 [INFO]: 	avg_search_speed_ms: 11.837513732156282
2025-03-09 09:57:34,839 [INFO]: 	99p_search_speed_ms: 17.691252641379823
2025-03-09 09:57:34,839 [INFO]: 	reconstruction error %: 0.0
2025-03-09 09:57:34,839 [INFO]: 	nb vectors: 8542
2025-03-09 09:57:34,839 [INFO]: 	vectors dimension: 49152
2025-03-09 09:57:34,839 [INFO]: 	compression ratio: 0.9993083646461358
2025-03-09 09:57:34,839 [INFO]: }
2025-03-09 09:57:34,839 [INFO]: 	>>> Finished "Creating the index" in 110.5839 secs
2025-03-09 09:57:34,839 [INFO]: >>> Finished "Launching the whole pipeline" in 110.6108 secs
2025-03-09 09:57:36: [retrieval_preprocessing] calculating distances ...
2025-03-09 09:57:38: [retrieval_preprocessing] finished and saved retrieval indices for episode 76854 [episode count 11/20]
[retrieval_preprocessing] for episode 75831 [episode count 12/20], we have num_retrieval=np.int64(8399) num_query=np.int64(499)
2025-03-09 09:57:40,041 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-09 09:57:41,128 [INFO]: Launching the whole pipeline 03/09/2025, 09:57:41
2025-03-09 09:57:41,128 [INFO]: Reading total number of vectors and dimension 03/09/2025, 09:57:41
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1508.20it/s]
2025-03-09 09:57:41,154 [INFO]: There are 8399 embeddings of dim 49152
2025-03-09 09:57:41,154 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0257 secs
2025-03-09 09:57:41,154 [INFO]: 	Compute estimated construction time of the index 03/09/2025, 09:57:41
2025-03-09 09:57:41,154 [INFO]: 		-> Train: 16.7 minutes
2025-03-09 09:57:41,154 [INFO]: 		-> Add: 4.6 seconds
2025-03-09 09:57:41,154 [INFO]: 		Total: 16.7 minutes
2025-03-09 09:57:41,154 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0001 secs
2025-03-09 09:57:41,154 [INFO]: 	Checking that your have enough memory available to create the index 03/09/2025, 09:57:41
2025-03-09 09:57:41,154 [INFO]: 1.7GB of memory will be needed to build the index (more might be used if you have more)
2025-03-09 09:57:41,154 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0001 secs
2025-03-09 09:57:41,154 [INFO]: 	Selecting most promising index types given data characteristics 03/09/2025, 09:57:41
2025-03-09 09:57:41,154 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-09 09:57:41,154 [INFO]: 	Creating the index 03/09/2025, 09:57:41
2025-03-09 09:57:41,154 [INFO]: 		-> Instanciate the index HNSW15 03/09/2025, 09:57:41
2025-03-09 09:57:41,155 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0010 secs
2025-03-09 09:57:41,155 [INFO]: 		-> Adding the vectors to the index 03/09/2025, 09:57:41
2025-03-09 09:57:41,155 [INFO]: The memory available for adding the vectors is 48.5GB(total available - used by the index)
2025-03-09 09:57:41,156 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/35 [00:00<?, ?it/s]  3%|▎         | 1/35 [00:00<00:06,  5.28it/s]  9%|▊         | 3/35 [00:00<00:03,  9.35it/s] 14%|█▍        | 5/35 [00:00<00:02, 10.89it/s] 20%|██        | 7/35 [00:00<00:02, 11.73it/s] 26%|██▌       | 9/35 [00:00<00:02, 12.01it/s] 31%|███▏      | 11/35 [00:00<00:01, 12.26it/s] 37%|███▋      | 13/35 [00:01<00:01, 12.50it/s] 43%|████▎     | 15/35 [00:01<00:01, 12.62it/s] 49%|████▊     | 17/35 [00:01<00:01, 13.74it/s] 54%|█████▍    | 19/35 [00:01<00:01, 13.20it/s] 60%|██████    | 21/35 [00:05<00:08,  1.60it/s] 66%|██████▌   | 23/35 [00:05<00:05,  2.17it/s] 71%|███████▏  | 25/35 [00:05<00:03,  2.90it/s] 77%|███████▋  | 27/35 [00:05<00:02,  3.77it/s] 83%|████████▎ | 29/35 [00:05<00:01,  4.76it/s] 89%|████████▊ | 31/35 [00:06<00:00,  5.80it/s] 94%|█████████▍| 33/35 [00:06<00:00,  6.96it/s]100%|██████████| 35/35 [00:09<00:00,  1.63it/s]100%|██████████| 35/35 [00:09<00:00,  3.62it/s]
2025-03-09 09:57:50,840 [INFO]: 	Computing best hyperparameters for index knn.index 03/09/2025, 09:57:50
2025-03-09 09:59:01,089 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 70.2476 secs
2025-03-09 09:59:01,089 [INFO]: The best hyperparameters are: efSearch=206
2025-03-09 09:59:01,089 [INFO]: 	Compute fast metrics 03/09/2025, 09:59:01
  0%|          | 0/4 [00:00<?, ?it/s] 25%|██▌       | 1/4 [00:00<00:00,  5.44it/s] 50%|█████     | 2/4 [00:00<00:00,  6.93it/s] 75%|███████▌  | 3/4 [00:00<00:00,  7.57it/s] 75%|███████▌  | 3/4 [00:00<00:00,  5.73it/s]
2025-03-09 09:59:22,261 [INFO]: 	>>> Finished "Compute fast metrics" in 21.1723 secs
2025-03-09 09:59:22,264 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 101.1083 secs
2025-03-09 09:59:22,264 [INFO]: {
2025-03-09 09:59:22,264 [INFO]: 	index_key: HNSW15
2025-03-09 09:59:22,264 [INFO]: 	index_param: efSearch=206
2025-03-09 09:59:22,264 [INFO]: 	index_path: knn.index
2025-03-09 09:59:22,264 [INFO]: 	size in bytes: 1652453470
2025-03-09 09:59:22,264 [INFO]: 	avg_search_speed_ms: 11.986099141683402
2025-03-09 09:59:22,264 [INFO]: 	99p_search_speed_ms: 20.986187658272684
2025-03-09 09:59:22,264 [INFO]: 	reconstruction error %: 0.0
2025-03-09 09:59:22,264 [INFO]: 	nb vectors: 8399
2025-03-09 09:59:22,264 [INFO]: 	vectors dimension: 49152
2025-03-09 09:59:22,264 [INFO]: 	compression ratio: 0.9993083750793903
2025-03-09 09:59:22,264 [INFO]: }
2025-03-09 09:59:22,264 [INFO]: 	>>> Finished "Creating the index" in 101.1098 secs
2025-03-09 09:59:22,264 [INFO]: >>> Finished "Launching the whole pipeline" in 101.1360 secs
2025-03-09 09:59:24: [retrieval_preprocessing] calculating distances ...
2025-03-09 09:59:25: [retrieval_preprocessing] finished and saved retrieval indices for episode 75831 [episode count 12/20]
[retrieval_preprocessing] for episode 28737 [episode count 13/20], we have num_retrieval=np.int64(8487) num_query=np.int64(411)
2025-03-09 09:59:28,322 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-09 09:59:29,520 [INFO]: Launching the whole pipeline 03/09/2025, 09:59:29
2025-03-09 09:59:29,520 [INFO]: Reading total number of vectors and dimension 03/09/2025, 09:59:29
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 996.98it/s]
2025-03-09 09:59:29,982 [INFO]: There are 8487 embeddings of dim 49152
2025-03-09 09:59:29,983 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.4623 secs
2025-03-09 09:59:29,983 [INFO]: 	Compute estimated construction time of the index 03/09/2025, 09:59:29
2025-03-09 09:59:29,983 [INFO]: 		-> Train: 16.7 minutes
2025-03-09 09:59:29,983 [INFO]: 		-> Add: 4.7 seconds
2025-03-09 09:59:29,984 [INFO]: 		Total: 16.7 minutes
2025-03-09 09:59:29,984 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0004 secs
2025-03-09 09:59:29,984 [INFO]: 	Checking that your have enough memory available to create the index 03/09/2025, 09:59:29
2025-03-09 09:59:29,984 [INFO]: 1.7GB of memory will be needed to build the index (more might be used if you have more)
2025-03-09 09:59:29,984 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0005 secs
2025-03-09 09:59:29,984 [INFO]: 	Selecting most promising index types given data characteristics 03/09/2025, 09:59:29
2025-03-09 09:59:29,984 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-09 09:59:29,984 [INFO]: 	Creating the index 03/09/2025, 09:59:29
2025-03-09 09:59:29,985 [INFO]: 		-> Instanciate the index HNSW15 03/09/2025, 09:59:29
2025-03-09 09:59:29,987 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0025 secs
2025-03-09 09:59:29,987 [INFO]: 		-> Adding the vectors to the index 03/09/2025, 09:59:29
2025-03-09 09:59:29,988 [INFO]: The memory available for adding the vectors is 48.4GB(total available - used by the index)
2025-03-09 09:59:29,988 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/35 [00:00<?, ?it/s]  3%|▎         | 1/35 [00:00<00:06,  4.95it/s]  9%|▊         | 3/35 [00:00<00:03,  8.27it/s] 14%|█▍        | 5/35 [00:00<00:03,  9.08it/s] 17%|█▋        | 6/35 [00:00<00:03,  9.11it/s] 23%|██▎       | 8/35 [00:00<00:02,  9.37it/s] 26%|██▌       | 9/35 [00:01<00:02,  9.28it/s] 29%|██▊       | 10/35 [00:01<00:02,  9.34it/s] 31%|███▏      | 11/35 [00:01<00:02,  9.37it/s] 34%|███▍      | 12/35 [00:01<00:02,  9.51it/s] 40%|████      | 14/35 [00:01<00:02,  9.66it/s] 43%|████▎     | 15/35 [00:01<00:02,  9.59it/s] 49%|████▊     | 17/35 [00:01<00:01, 10.79it/s] 54%|█████▍    | 19/35 [00:01<00:01, 11.72it/s] 60%|██████    | 21/35 [00:05<00:10,  1.35it/s] 66%|██████▌   | 23/35 [00:06<00:06,  1.92it/s] 71%|███████▏  | 25/35 [00:06<00:03,  2.64it/s] 77%|███████▋  | 27/35 [00:06<00:02,  3.53it/s] 83%|████████▎ | 29/35 [00:06<00:01,  4.56it/s] 89%|████████▊ | 31/35 [00:06<00:00,  5.66it/s] 94%|█████████▍| 33/35 [00:06<00:00,  6.84it/s]100%|██████████| 35/35 [00:10<00:00,  1.61it/s]100%|██████████| 35/35 [00:10<00:00,  3.42it/s]
2025-03-09 09:59:40,238 [INFO]: 	Computing best hyperparameters for index knn.index 03/09/2025, 09:59:40
2025-03-09 10:00:50,402 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 70.1637 secs
2025-03-09 10:00:50,402 [INFO]: The best hyperparameters are: efSearch=212
2025-03-09 10:00:50,402 [INFO]: 	Compute fast metrics 03/09/2025, 10:00:50
  0%|          | 0/4 [00:00<?, ?it/s] 25%|██▌       | 1/4 [00:00<00:00,  5.46it/s] 50%|█████     | 2/4 [00:00<00:00,  7.14it/s] 75%|███████▌  | 3/4 [00:00<00:00,  7.92it/s] 75%|███████▌  | 3/4 [00:00<00:00,  5.90it/s]
2025-03-09 10:01:10,161 [INFO]: 	>>> Finished "Compute fast metrics" in 19.7581 secs
2025-03-09 10:01:10,163 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 100.1757 secs
2025-03-09 10:01:10,163 [INFO]: {
2025-03-09 10:01:10,163 [INFO]: 	index_key: HNSW15
2025-03-09 10:01:10,163 [INFO]: 	index_param: efSearch=212
2025-03-09 10:01:10,163 [INFO]: 	index_path: knn.index
2025-03-09 10:01:10,163 [INFO]: 	size in bytes: 1669767070
2025-03-09 10:01:10,163 [INFO]: 	avg_search_speed_ms: 13.311100941394441
2025-03-09 10:01:10,163 [INFO]: 	99p_search_speed_ms: 25.792065425775945
2025-03-09 10:01:10,163 [INFO]: 	reconstruction error %: 0.0
2025-03-09 10:01:10,163 [INFO]: 	nb vectors: 8487
2025-03-09 10:01:10,163 [INFO]: 	vectors dimension: 49152
2025-03-09 10:01:10,163 [INFO]: 	compression ratio: 0.9993083023250662
2025-03-09 10:01:10,163 [INFO]: }
2025-03-09 10:01:10,163 [INFO]: 	>>> Finished "Creating the index" in 100.1790 secs
2025-03-09 10:01:10,164 [INFO]: >>> Finished "Launching the whole pipeline" in 100.6432 secs
2025-03-09 10:01:12: [retrieval_preprocessing] calculating distances ...
2025-03-09 10:01:14: [retrieval_preprocessing] finished and saved retrieval indices for episode 28737 [episode count 13/20]
[retrieval_preprocessing] for episode 54851 [episode count 14/20], we have num_retrieval=np.int64(8278) num_query=np.int64(620)
2025-03-09 10:01:17,994 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-09 10:01:19,119 [INFO]: Launching the whole pipeline 03/09/2025, 10:01:19
2025-03-09 10:01:19,119 [INFO]: Reading total number of vectors and dimension 03/09/2025, 10:01:19
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1194.28it/s]
2025-03-09 10:01:19,145 [INFO]: There are 8278 embeddings of dim 49152
2025-03-09 10:01:19,145 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0258 secs
2025-03-09 10:01:19,145 [INFO]: 	Compute estimated construction time of the index 03/09/2025, 10:01:19
2025-03-09 10:01:19,145 [INFO]: 		-> Train: 16.7 minutes
2025-03-09 10:01:19,145 [INFO]: 		-> Add: 4.5 seconds
2025-03-09 10:01:19,145 [INFO]: 		Total: 16.7 minutes
2025-03-09 10:01:19,145 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0001 secs
2025-03-09 10:01:19,145 [INFO]: 	Checking that your have enough memory available to create the index 03/09/2025, 10:01:19
2025-03-09 10:01:19,145 [INFO]: 1.7GB of memory will be needed to build the index (more might be used if you have more)
2025-03-09 10:01:19,145 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0002 secs
2025-03-09 10:01:19,145 [INFO]: 	Selecting most promising index types given data characteristics 03/09/2025, 10:01:19
2025-03-09 10:01:19,145 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-09 10:01:19,145 [INFO]: 	Creating the index 03/09/2025, 10:01:19
2025-03-09 10:01:19,146 [INFO]: 		-> Instanciate the index HNSW15 03/09/2025, 10:01:19
2025-03-09 10:01:19,147 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0010 secs
2025-03-09 10:01:19,147 [INFO]: 		-> Adding the vectors to the index 03/09/2025, 10:01:19
2025-03-09 10:01:19,147 [INFO]: The memory available for adding the vectors is 48.5GB(total available - used by the index)
2025-03-09 10:01:19,147 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/34 [00:00<?, ?it/s]  3%|▎         | 1/34 [00:00<00:07,  4.71it/s]  6%|▌         | 2/34 [00:00<00:04,  6.62it/s]  9%|▉         | 3/34 [00:00<00:04,  7.60it/s] 12%|█▏        | 4/34 [00:00<00:03,  8.17it/s] 15%|█▍        | 5/34 [00:00<00:03,  8.48it/s] 18%|█▊        | 6/34 [00:00<00:03,  8.70it/s] 21%|██        | 7/34 [00:00<00:03,  8.95it/s] 24%|██▎       | 8/34 [00:00<00:02,  9.04it/s] 26%|██▋       | 9/34 [00:01<00:02,  9.12it/s] 29%|██▉       | 10/34 [00:01<00:02,  9.14it/s] 32%|███▏      | 11/34 [00:01<00:02,  9.18it/s] 35%|███▌      | 12/34 [00:01<00:02,  9.30it/s] 38%|███▊      | 13/34 [00:01<00:02,  9.28it/s] 41%|████      | 14/34 [00:01<00:02,  9.24it/s] 44%|████▍     | 15/34 [00:01<00:02,  9.25it/s] 47%|████▋     | 16/34 [00:01<00:01,  9.21it/s] 50%|█████     | 17/34 [00:01<00:01,  9.26it/s] 59%|█████▉    | 20/34 [00:02<00:01, 13.27it/s] 65%|██████▍   | 22/34 [00:06<00:09,  1.32it/s] 71%|███████   | 24/34 [00:06<00:05,  1.88it/s] 76%|███████▋  | 26/34 [00:06<00:03,  2.60it/s] 82%|████████▏ | 28/34 [00:06<00:01,  3.47it/s] 88%|████████▊ | 30/34 [00:06<00:00,  4.49it/s] 94%|█████████▍| 32/34 [00:06<00:00,  5.60it/s]100%|██████████| 34/34 [00:10<00:00,  1.51it/s]100%|██████████| 34/34 [00:10<00:00,  3.25it/s]
2025-03-09 10:01:29,605 [INFO]: 	Computing best hyperparameters for index knn.index 03/09/2025, 10:01:29
2025-03-09 10:02:42,455 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 72.8496 secs
2025-03-09 10:02:42,455 [INFO]: The best hyperparameters are: efSearch=188
2025-03-09 10:02:42,455 [INFO]: 	Compute fast metrics 03/09/2025, 10:02:42
  0%|          | 0/4 [00:00<?, ?it/s] 25%|██▌       | 1/4 [00:00<00:00,  5.83it/s] 50%|█████     | 2/4 [00:00<00:00,  7.35it/s] 75%|███████▌  | 3/4 [00:00<00:00,  8.06it/s] 75%|███████▌  | 3/4 [00:00<00:00,  6.10it/s]
2025-03-09 10:03:09,968 [INFO]: 	>>> Finished "Compute fast metrics" in 27.5131 secs
2025-03-09 10:03:09,970 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 110.8238 secs
2025-03-09 10:03:09,971 [INFO]: {
2025-03-09 10:03:09,971 [INFO]: 	index_key: HNSW15
2025-03-09 10:03:09,971 [INFO]: 	index_param: efSearch=188
2025-03-09 10:03:09,971 [INFO]: 	index_path: knn.index
2025-03-09 10:03:09,971 [INFO]: 	size in bytes: 1628647570
2025-03-09 10:03:09,971 [INFO]: 	avg_search_speed_ms: 10.931435518241564
2025-03-09 10:03:09,971 [INFO]: 	99p_search_speed_ms: 19.57076036371291
2025-03-09 10:03:09,971 [INFO]: 	reconstruction error %: 0.0
2025-03-09 10:03:09,971 [INFO]: 	nb vectors: 8278
2025-03-09 10:03:09,971 [INFO]: 	vectors dimension: 49152
2025-03-09 10:03:09,971 [INFO]: 	compression ratio: 0.999308293567773
2025-03-09 10:03:09,971 [INFO]: }
2025-03-09 10:03:09,971 [INFO]: 	>>> Finished "Creating the index" in 110.8252 secs
2025-03-09 10:03:09,971 [INFO]: >>> Finished "Launching the whole pipeline" in 110.8516 secs
2025-03-09 10:03:12: [retrieval_preprocessing] calculating distances ...
2025-03-09 10:03:14: [retrieval_preprocessing] finished and saved retrieval indices for episode 54851 [episode count 14/20]
[retrieval_preprocessing] for episode 61511 [episode count 15/20], we have num_retrieval=np.int64(8485) num_query=np.int64(413)
2025-03-09 10:03:17,410 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-09 10:03:18,696 [INFO]: Launching the whole pipeline 03/09/2025, 10:03:18
2025-03-09 10:03:18,696 [INFO]: Reading total number of vectors and dimension 03/09/2025, 10:03:18
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1036.65it/s]
2025-03-09 10:03:18,722 [INFO]: There are 8485 embeddings of dim 49152
2025-03-09 10:03:18,722 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0262 secs
2025-03-09 10:03:18,722 [INFO]: 	Compute estimated construction time of the index 03/09/2025, 10:03:18
2025-03-09 10:03:18,722 [INFO]: 		-> Train: 16.7 minutes
2025-03-09 10:03:18,722 [INFO]: 		-> Add: 4.7 seconds
2025-03-09 10:03:18,722 [INFO]: 		Total: 16.7 minutes
2025-03-09 10:03:18,722 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0001 secs
2025-03-09 10:03:18,722 [INFO]: 	Checking that your have enough memory available to create the index 03/09/2025, 10:03:18
2025-03-09 10:03:18,722 [INFO]: 1.7GB of memory will be needed to build the index (more might be used if you have more)
2025-03-09 10:03:18,722 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0002 secs
2025-03-09 10:03:18,723 [INFO]: 	Selecting most promising index types given data characteristics 03/09/2025, 10:03:18
2025-03-09 10:03:18,723 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-09 10:03:18,723 [INFO]: 	Creating the index 03/09/2025, 10:03:18
2025-03-09 10:03:18,723 [INFO]: 		-> Instanciate the index HNSW15 03/09/2025, 10:03:18
2025-03-09 10:03:18,724 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0010 secs
2025-03-09 10:03:18,724 [INFO]: 		-> Adding the vectors to the index 03/09/2025, 10:03:18
2025-03-09 10:03:18,724 [INFO]: The memory available for adding the vectors is 48.4GB(total available - used by the index)
2025-03-09 10:03:18,724 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/35 [00:00<?, ?it/s]  3%|▎         | 1/35 [00:00<00:07,  4.58it/s]  9%|▊         | 3/35 [00:00<00:04,  7.94it/s] 14%|█▍        | 5/35 [00:00<00:03,  9.02it/s] 20%|██        | 7/35 [00:00<00:02,  9.59it/s] 23%|██▎       | 8/35 [00:00<00:02,  9.68it/s] 29%|██▊       | 10/35 [00:01<00:02,  9.97it/s] 34%|███▍      | 12/35 [00:01<00:02, 10.37it/s] 40%|████      | 14/35 [00:01<00:01, 10.64it/s] 46%|████▌     | 16/35 [00:01<00:01, 10.92it/s] 51%|█████▏    | 18/35 [00:01<00:01, 11.31it/s] 57%|█████▋    | 20/35 [00:01<00:01, 11.78it/s] 63%|██████▎   | 22/35 [00:06<00:09,  1.41it/s] 69%|██████▊   | 24/35 [00:06<00:05,  1.95it/s] 74%|███████▍  | 26/35 [00:06<00:03,  2.65it/s] 80%|████████  | 28/35 [00:06<00:02,  3.50it/s] 86%|████████▌ | 30/35 [00:06<00:01,  4.64it/s] 91%|█████████▏| 32/35 [00:06<00:00,  5.74it/s] 97%|█████████▋| 34/35 [00:06<00:00,  7.06it/s]100%|██████████| 35/35 [00:10<00:00,  3.36it/s]
2025-03-09 10:03:29,136 [INFO]: 	Computing best hyperparameters for index knn.index 03/09/2025, 10:03:29
2025-03-09 10:04:38,339 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 69.2033 secs
2025-03-09 10:04:38,339 [INFO]: The best hyperparameters are: efSearch=217
2025-03-09 10:04:38,339 [INFO]: 	Compute fast metrics 03/09/2025, 10:04:38
  0%|          | 0/4 [00:00<?, ?it/s] 25%|██▌       | 1/4 [00:00<00:00,  5.48it/s] 50%|█████     | 2/4 [00:00<00:00,  7.09it/s] 75%|███████▌  | 3/4 [00:00<00:00,  8.12it/s] 75%|███████▌  | 3/4 [00:00<00:00,  5.98it/s]
2025-03-09 10:04:58,225 [INFO]: 	>>> Finished "Compute fast metrics" in 19.8851 secs
2025-03-09 10:04:58,228 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 99.5037 secs
2025-03-09 10:04:58,228 [INFO]: {
2025-03-09 10:04:58,228 [INFO]: 	index_key: HNSW15
2025-03-09 10:04:58,228 [INFO]: 	index_param: efSearch=217
2025-03-09 10:04:58,228 [INFO]: 	index_path: knn.index
2025-03-09 10:04:58,228 [INFO]: 	size in bytes: 1669373590
2025-03-09 10:04:58,228 [INFO]: 	avg_search_speed_ms: 11.788024340270283
2025-03-09 10:04:58,228 [INFO]: 	99p_search_speed_ms: 20.466225380077955
2025-03-09 10:04:58,228 [INFO]: 	reconstruction error %: 0.0
2025-03-09 10:04:58,228 [INFO]: 	nb vectors: 8485
2025-03-09 10:04:58,228 [INFO]: 	vectors dimension: 49152
2025-03-09 10:04:58,228 [INFO]: 	compression ratio: 0.9993082974314934
2025-03-09 10:04:58,228 [INFO]: }
2025-03-09 10:04:58,228 [INFO]: 	>>> Finished "Creating the index" in 99.5053 secs
2025-03-09 10:04:58,228 [INFO]: >>> Finished "Launching the whole pipeline" in 99.5322 secs
2025-03-09 10:05:00: [retrieval_preprocessing] calculating distances ...
2025-03-09 10:05:02: [retrieval_preprocessing] finished and saved retrieval indices for episode 61511 [episode count 15/20]
[retrieval_preprocessing] for episode 13897 [episode count 16/20], we have num_retrieval=np.int64(8604) num_query=np.int64(294)
2025-03-09 10:05:05,566 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-09 10:05:06,646 [INFO]: Launching the whole pipeline 03/09/2025, 10:05:06
2025-03-09 10:05:06,646 [INFO]: Reading total number of vectors and dimension 03/09/2025, 10:05:06
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1205.26it/s]
2025-03-09 10:05:06,671 [INFO]: There are 8604 embeddings of dim 49152
2025-03-09 10:05:06,672 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0256 secs
2025-03-09 10:05:06,672 [INFO]: 	Compute estimated construction time of the index 03/09/2025, 10:05:06
2025-03-09 10:05:06,672 [INFO]: 		-> Train: 16.7 minutes
2025-03-09 10:05:06,672 [INFO]: 		-> Add: 4.7 seconds
2025-03-09 10:05:06,672 [INFO]: 		Total: 16.7 minutes
2025-03-09 10:05:06,672 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0002 secs
2025-03-09 10:05:06,672 [INFO]: 	Checking that your have enough memory available to create the index 03/09/2025, 10:05:06
2025-03-09 10:05:06,672 [INFO]: 1.7GB of memory will be needed to build the index (more might be used if you have more)
2025-03-09 10:05:06,672 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0002 secs
2025-03-09 10:05:06,672 [INFO]: 	Selecting most promising index types given data characteristics 03/09/2025, 10:05:06
2025-03-09 10:05:06,672 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-09 10:05:06,672 [INFO]: 	Creating the index 03/09/2025, 10:05:06
2025-03-09 10:05:06,672 [INFO]: 		-> Instanciate the index HNSW15 03/09/2025, 10:05:06
2025-03-09 10:05:06,674 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0012 secs
2025-03-09 10:05:06,674 [INFO]: 		-> Adding the vectors to the index 03/09/2025, 10:05:06
2025-03-09 10:05:06,674 [INFO]: The memory available for adding the vectors is 48.4GB(total available - used by the index)
2025-03-09 10:05:06,674 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/35 [00:00<?, ?it/s]  3%|▎         | 1/35 [00:00<00:06,  5.19it/s]  9%|▊         | 3/35 [00:00<00:03,  9.42it/s] 14%|█▍        | 5/35 [00:00<00:02, 11.08it/s] 20%|██        | 7/35 [00:00<00:02, 11.93it/s] 26%|██▌       | 9/35 [00:00<00:02, 12.38it/s] 31%|███▏      | 11/35 [00:00<00:01, 12.69it/s] 37%|███▋      | 13/35 [00:01<00:01, 12.90it/s] 43%|████▎     | 15/35 [00:01<00:01, 13.01it/s] 49%|████▊     | 17/35 [00:01<00:01, 13.16it/s] 54%|█████▍    | 19/35 [00:01<00:01, 13.15it/s] 60%|██████    | 21/35 [00:05<00:08,  1.63it/s] 74%|███████▍  | 26/35 [00:05<00:02,  3.29it/s] 89%|████████▊ | 31/35 [00:05<00:00,  5.45it/s]100%|██████████| 35/35 [00:09<00:00,  2.20it/s]100%|██████████| 35/35 [00:09<00:00,  3.70it/s]
2025-03-09 10:05:16,153 [INFO]: 	Computing best hyperparameters for index knn.index 03/09/2025, 10:05:16
2025-03-09 10:06:33,500 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 77.3463 secs
2025-03-09 10:06:33,501 [INFO]: The best hyperparameters are: efSearch=159
2025-03-09 10:06:33,501 [INFO]: 	Compute fast metrics 03/09/2025, 10:06:33
  0%|          | 0/4 [00:00<?, ?it/s] 25%|██▌       | 1/4 [00:00<00:00,  5.66it/s] 50%|█████     | 2/4 [00:00<00:00,  7.35it/s] 75%|███████▌  | 3/4 [00:00<00:00,  8.02it/s] 75%|███████▌  | 3/4 [00:00<00:00,  6.05it/s]
2025-03-09 10:06:50,968 [INFO]: 	>>> Finished "Compute fast metrics" in 17.4668 secs
2025-03-09 10:06:50,971 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 104.2966 secs
2025-03-09 10:06:50,971 [INFO]: {
2025-03-09 10:06:50,971 [INFO]: 	index_key: HNSW15
2025-03-09 10:06:50,971 [INFO]: 	index_param: efSearch=159
2025-03-09 10:06:50,971 [INFO]: 	index_path: knn.index
2025-03-09 10:06:50,971 [INFO]: 	size in bytes: 1692785950
2025-03-09 10:06:50,971 [INFO]: 	avg_search_speed_ms: 9.284661793536545
2025-03-09 10:06:50,971 [INFO]: 	99p_search_speed_ms: 15.986660774797203
2025-03-09 10:06:50,971 [INFO]: 	reconstruction error %: 0.0
2025-03-09 10:06:50,971 [INFO]: 	nb vectors: 8604
2025-03-09 10:06:50,971 [INFO]: 	vectors dimension: 49152
2025-03-09 10:06:50,971 [INFO]: 	compression ratio: 0.9993084075396538
2025-03-09 10:06:50,971 [INFO]: }
2025-03-09 10:06:50,971 [INFO]: 	>>> Finished "Creating the index" in 104.2984 secs
2025-03-09 10:06:50,971 [INFO]: >>> Finished "Launching the whole pipeline" in 104.3250 secs
2025-03-09 10:06:52: [retrieval_preprocessing] calculating distances ...
2025-03-09 10:06:53: [retrieval_preprocessing] finished and saved retrieval indices for episode 13897 [episode count 16/20]
[retrieval_preprocessing] for episode 56393 [episode count 17/20], we have num_retrieval=np.int64(8434) num_query=np.int64(464)
2025-03-09 10:06:55,553 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-09 10:06:56,568 [INFO]: Launching the whole pipeline 03/09/2025, 10:06:56
2025-03-09 10:06:56,568 [INFO]: Reading total number of vectors and dimension 03/09/2025, 10:06:56
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1004.62it/s]
2025-03-09 10:06:56,598 [INFO]: There are 8434 embeddings of dim 49152
2025-03-09 10:06:56,598 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0303 secs
2025-03-09 10:06:56,598 [INFO]: 	Compute estimated construction time of the index 03/09/2025, 10:06:56
2025-03-09 10:06:56,598 [INFO]: 		-> Train: 16.7 minutes
2025-03-09 10:06:56,598 [INFO]: 		-> Add: 4.6 seconds
2025-03-09 10:06:56,598 [INFO]: 		Total: 16.7 minutes
2025-03-09 10:06:56,598 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0001 secs
2025-03-09 10:06:56,598 [INFO]: 	Checking that your have enough memory available to create the index 03/09/2025, 10:06:56
2025-03-09 10:06:56,599 [INFO]: 1.7GB of memory will be needed to build the index (more might be used if you have more)
2025-03-09 10:06:56,599 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0002 secs
2025-03-09 10:06:56,599 [INFO]: 	Selecting most promising index types given data characteristics 03/09/2025, 10:06:56
2025-03-09 10:06:56,599 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-09 10:06:56,599 [INFO]: 	Creating the index 03/09/2025, 10:06:56
2025-03-09 10:06:56,599 [INFO]: 		-> Instanciate the index HNSW15 03/09/2025, 10:06:56
2025-03-09 10:06:56,600 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0013 secs
2025-03-09 10:06:56,600 [INFO]: 		-> Adding the vectors to the index 03/09/2025, 10:06:56
2025-03-09 10:06:56,600 [INFO]: The memory available for adding the vectors is 48.5GB(total available - used by the index)
2025-03-09 10:06:56,600 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/35 [00:00<?, ?it/s]  3%|▎         | 1/35 [00:00<00:05,  6.32it/s] 17%|█▋        | 6/35 [00:00<00:01, 25.12it/s] 34%|███▍      | 12/35 [00:00<00:00, 37.21it/s] 51%|█████▏    | 18/35 [00:00<00:00, 43.69it/s] 66%|██████▌   | 23/35 [00:04<00:03,  3.20it/s] 86%|████████▌ | 30/35 [00:04<00:00,  5.28it/s]100%|██████████| 35/35 [00:08<00:00,  2.99it/s]100%|██████████| 35/35 [00:08<00:00,  4.27it/s]
2025-03-09 10:07:04,800 [INFO]: 	Computing best hyperparameters for index knn.index 03/09/2025, 10:07:04
2025-03-09 10:08:11,526 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 66.7253 secs
2025-03-09 10:08:11,526 [INFO]: The best hyperparameters are: efSearch=213
2025-03-09 10:08:11,526 [INFO]: 	Compute fast metrics 03/09/2025, 10:08:11
  0%|          | 0/4 [00:00<?, ?it/s] 50%|█████     | 2/4 [00:00<00:00, 19.85it/s] 75%|███████▌  | 3/4 [00:00<00:00, 21.92it/s]
2025-03-09 10:08:32,719 [INFO]: 	>>> Finished "Compute fast metrics" in 21.1932 secs
2025-03-09 10:08:32,721 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 96.1207 secs
2025-03-09 10:08:32,721 [INFO]: {
2025-03-09 10:08:32,721 [INFO]: 	index_key: HNSW15
2025-03-09 10:08:32,721 [INFO]: 	index_param: efSearch=213
2025-03-09 10:08:32,721 [INFO]: 	index_path: knn.index
2025-03-09 10:08:32,721 [INFO]: 	size in bytes: 1659339490
2025-03-09 10:08:32,721 [INFO]: 	avg_search_speed_ms: 10.616716273047915
2025-03-09 10:08:32,721 [INFO]: 	99p_search_speed_ms: 16.28004305297509
2025-03-09 10:08:32,721 [INFO]: 	reconstruction error %: 0.0
2025-03-09 10:08:32,721 [INFO]: 	nb vectors: 8434
2025-03-09 10:08:32,721 [INFO]: 	vectors dimension: 49152
2025-03-09 10:08:32,721 [INFO]: 	compression ratio: 0.999308388664938
2025-03-09 10:08:32,721 [INFO]: }
2025-03-09 10:08:32,721 [INFO]: 	>>> Finished "Creating the index" in 96.1227 secs
2025-03-09 10:08:32,721 [INFO]: >>> Finished "Launching the whole pipeline" in 96.1538 secs
2025-03-09 10:08:35: [retrieval_preprocessing] calculating distances ...
2025-03-09 10:08:36: [retrieval_preprocessing] finished and saved retrieval indices for episode 56393 [episode count 17/20]
[retrieval_preprocessing] for episode 38475 [episode count 18/20], we have num_retrieval=np.int64(8446) num_query=np.int64(452)
2025-03-09 10:08:37,349 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-09 10:08:38,388 [INFO]: Launching the whole pipeline 03/09/2025, 10:08:38
2025-03-09 10:08:38,389 [INFO]: Reading total number of vectors and dimension 03/09/2025, 10:08:38
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1171.27it/s]
2025-03-09 10:08:38,416 [INFO]: There are 8446 embeddings of dim 49152
2025-03-09 10:08:38,416 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0278 secs
2025-03-09 10:08:38,416 [INFO]: 	Compute estimated construction time of the index 03/09/2025, 10:08:38
2025-03-09 10:08:38,417 [INFO]: 		-> Train: 16.7 minutes
2025-03-09 10:08:38,417 [INFO]: 		-> Add: 4.6 seconds
2025-03-09 10:08:38,417 [INFO]: 		Total: 16.7 minutes
2025-03-09 10:08:38,417 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0001 secs
2025-03-09 10:08:38,417 [INFO]: 	Checking that your have enough memory available to create the index 03/09/2025, 10:08:38
2025-03-09 10:08:38,417 [INFO]: 1.7GB of memory will be needed to build the index (more might be used if you have more)
2025-03-09 10:08:38,417 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0002 secs
2025-03-09 10:08:38,417 [INFO]: 	Selecting most promising index types given data characteristics 03/09/2025, 10:08:38
2025-03-09 10:08:38,417 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-09 10:08:38,417 [INFO]: 	Creating the index 03/09/2025, 10:08:38
2025-03-09 10:08:38,417 [INFO]: 		-> Instanciate the index HNSW15 03/09/2025, 10:08:38
2025-03-09 10:08:38,418 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0012 secs
2025-03-09 10:08:38,418 [INFO]: 		-> Adding the vectors to the index 03/09/2025, 10:08:38
2025-03-09 10:08:38,418 [INFO]: The memory available for adding the vectors is 48.5GB(total available - used by the index)
2025-03-09 10:08:38,418 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/35 [00:00<?, ?it/s]  3%|▎         | 1/35 [00:00<00:04,  7.61it/s] 20%|██        | 7/35 [00:00<00:00, 33.83it/s] 40%|████      | 14/35 [00:00<00:00, 46.25it/s] 60%|██████    | 21/35 [00:04<00:03,  3.54it/s] 74%|███████▍  | 26/35 [00:04<00:01,  5.01it/s] 91%|█████████▏| 32/35 [00:04<00:00,  7.40it/s]100%|██████████| 35/35 [00:07<00:00,  4.41it/s]
2025-03-09 10:08:46,351 [INFO]: 	Computing best hyperparameters for index knn.index 03/09/2025, 10:08:46
2025-03-09 10:10:01,938 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 75.5863 secs
2025-03-09 10:10:01,938 [INFO]: The best hyperparameters are: efSearch=205
2025-03-09 10:10:01,938 [INFO]: 	Compute fast metrics 03/09/2025, 10:10:01
  0%|          | 0/4 [00:00<?, ?it/s] 75%|███████▌  | 3/4 [00:00<00:00, 26.76it/s] 75%|███████▌  | 3/4 [00:00<00:00, 23.15it/s]
2025-03-09 10:10:21,656 [INFO]: 	>>> Finished "Compute fast metrics" in 19.7174 secs
2025-03-09 10:10:21,658 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 103.2394 secs
2025-03-09 10:10:21,658 [INFO]: {
2025-03-09 10:10:21,658 [INFO]: 	index_key: HNSW15
2025-03-09 10:10:21,658 [INFO]: 	index_param: efSearch=205
2025-03-09 10:10:21,658 [INFO]: 	index_path: knn.index
2025-03-09 10:10:21,658 [INFO]: 	size in bytes: 1661700490
2025-03-09 10:10:21,658 [INFO]: 	avg_search_speed_ms: 10.463190639818235
2025-03-09 10:10:21,658 [INFO]: 	99p_search_speed_ms: 16.163073806092147
2025-03-09 10:10:21,658 [INFO]: 	reconstruction error %: 0.0
2025-03-09 10:10:21,658 [INFO]: 	nb vectors: 8446
2025-03-09 10:10:21,658 [INFO]: 	vectors dimension: 49152
2025-03-09 10:10:21,658 [INFO]: 	compression ratio: 0.9993083458740509
2025-03-09 10:10:21,658 [INFO]: }
2025-03-09 10:10:21,658 [INFO]: 	>>> Finished "Creating the index" in 103.2411 secs
2025-03-09 10:10:21,658 [INFO]: >>> Finished "Launching the whole pipeline" in 103.2695 secs
2025-03-09 10:10:23: [retrieval_preprocessing] calculating distances ...
2025-03-09 10:10:25: [retrieval_preprocessing] finished and saved retrieval indices for episode 38475 [episode count 18/20]
[retrieval_preprocessing] for episode 6733 [episode count 19/20], we have num_retrieval=np.int64(8495) num_query=np.int64(403)
2025-03-09 10:10:25,863 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-09 10:10:26,817 [INFO]: Launching the whole pipeline 03/09/2025, 10:10:26
2025-03-09 10:10:26,817 [INFO]: Reading total number of vectors and dimension 03/09/2025, 10:10:26
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1468.08it/s]
2025-03-09 10:10:26,844 [INFO]: There are 8495 embeddings of dim 49152
2025-03-09 10:10:26,844 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0273 secs
2025-03-09 10:10:26,844 [INFO]: 	Compute estimated construction time of the index 03/09/2025, 10:10:26
2025-03-09 10:10:26,844 [INFO]: 		-> Train: 16.7 minutes
2025-03-09 10:10:26,844 [INFO]: 		-> Add: 4.7 seconds
2025-03-09 10:10:26,844 [INFO]: 		Total: 16.7 minutes
2025-03-09 10:10:26,844 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0001 secs
2025-03-09 10:10:26,844 [INFO]: 	Checking that your have enough memory available to create the index 03/09/2025, 10:10:26
2025-03-09 10:10:26,845 [INFO]: 1.7GB of memory will be needed to build the index (more might be used if you have more)
2025-03-09 10:10:26,845 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0002 secs
2025-03-09 10:10:26,845 [INFO]: 	Selecting most promising index types given data characteristics 03/09/2025, 10:10:26
2025-03-09 10:10:26,845 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-09 10:10:26,845 [INFO]: 	Creating the index 03/09/2025, 10:10:26
2025-03-09 10:10:26,845 [INFO]: 		-> Instanciate the index HNSW15 03/09/2025, 10:10:26
2025-03-09 10:10:26,846 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0011 secs
2025-03-09 10:10:26,846 [INFO]: 		-> Adding the vectors to the index 03/09/2025, 10:10:26
2025-03-09 10:10:26,846 [INFO]: The memory available for adding the vectors is 48.4GB(total available - used by the index)
2025-03-09 10:10:26,846 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/35 [00:00<?, ?it/s]  3%|▎         | 1/35 [00:00<00:03,  8.78it/s] 20%|██        | 7/35 [00:00<00:00, 35.22it/s] 37%|███▋      | 13/35 [00:00<00:00, 42.48it/s] 54%|█████▍    | 19/35 [00:00<00:00, 46.31it/s] 69%|██████▊   | 24/35 [00:04<00:03,  3.10it/s] 77%|███████▋  | 27/35 [00:05<00:02,  3.66it/s] 86%|████████▌ | 30/35 [00:05<00:01,  4.30it/s] 91%|█████████▏| 32/35 [00:05<00:00,  4.78it/s] 97%|█████████▋| 34/35 [00:05<00:00,  5.32it/s]100%|██████████| 35/35 [00:10<00:00,  3.45it/s]
2025-03-09 10:10:37,009 [INFO]: 	Computing best hyperparameters for index knn.index 03/09/2025, 10:10:37
2025-03-09 10:11:47,930 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 70.9202 secs
2025-03-09 10:11:47,930 [INFO]: The best hyperparameters are: efSearch=199
2025-03-09 10:11:47,930 [INFO]: 	Compute fast metrics 03/09/2025, 10:11:47
  0%|          | 0/4 [00:00<?, ?it/s] 50%|█████     | 2/4 [00:00<00:00, 18.66it/s] 75%|███████▌  | 3/4 [00:00<00:00, 20.51it/s]
2025-03-09 10:12:04,922 [INFO]: 	>>> Finished "Compute fast metrics" in 16.9911 secs
2025-03-09 10:12:04,924 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 98.0783 secs
2025-03-09 10:12:04,924 [INFO]: {
2025-03-09 10:12:04,924 [INFO]: 	index_key: HNSW15
2025-03-09 10:12:04,924 [INFO]: 	index_param: efSearch=199
2025-03-09 10:12:04,924 [INFO]: 	index_path: knn.index
2025-03-09 10:12:04,924 [INFO]: 	size in bytes: 1671340990
2025-03-09 10:12:04,924 [INFO]: 	avg_search_speed_ms: 10.39686515465526
2025-03-09 10:12:04,924 [INFO]: 	99p_search_speed_ms: 15.08365275105461
2025-03-09 10:12:04,925 [INFO]: 	reconstruction error %: 0.0
2025-03-09 10:12:04,925 [INFO]: 	nb vectors: 8495
2025-03-09 10:12:04,925 [INFO]: 	vectors dimension: 49152
2025-03-09 10:12:04,925 [INFO]: 	compression ratio: 0.9993083218763156
2025-03-09 10:12:04,925 [INFO]: }
2025-03-09 10:12:04,925 [INFO]: 	>>> Finished "Creating the index" in 98.0799 secs
2025-03-09 10:12:04,925 [INFO]: >>> Finished "Launching the whole pipeline" in 98.1078 secs
2025-03-09 10:12:07: [retrieval_preprocessing] calculating distances ...
2025-03-09 10:12:08: [retrieval_preprocessing] finished and saved retrieval indices for episode 6733 [episode count 19/20]
2025-03-09 10:12:08: [retrieval_preprocessing] finished for (3774560981, 'cloth') [chosen_id count 7/10]
2025-03-09 10:12:10: [retrieval_preprocessing] concatenated all embeddings and indices for 20 episodes for (4823049285, 'bottle') [chosen_id count 8/10]
2025-03-09 10:12:10: [retrieval_preprocessing] we have num_total=4530 embedding_dim=49152
[retrieval_preprocessing] for episode 79363 [episode count 0/20], we have num_retrieval=np.int64(4426) num_query=np.int64(104)
2025-03-09 10:12:10,544 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-09 10:12:11,187 [INFO]: Launching the whole pipeline 03/09/2025, 10:12:11
2025-03-09 10:12:11,187 [INFO]: Reading total number of vectors and dimension 03/09/2025, 10:12:11
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1150.07it/s]
2025-03-09 10:12:11,217 [INFO]: There are 4426 embeddings of dim 49152
2025-03-09 10:12:11,218 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0310 secs
2025-03-09 10:12:11,218 [INFO]: 	Compute estimated construction time of the index 03/09/2025, 10:12:11
2025-03-09 10:12:11,218 [INFO]: 		-> Train: 16.7 minutes
2025-03-09 10:12:11,218 [INFO]: 		-> Add: 2.4 seconds
2025-03-09 10:12:11,218 [INFO]: 		Total: 16.7 minutes
2025-03-09 10:12:11,219 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0004 secs
2025-03-09 10:12:11,219 [INFO]: 	Checking that your have enough memory available to create the index 03/09/2025, 10:12:11
2025-03-09 10:12:11,219 [INFO]: 913.4MB of memory will be needed to build the index (more might be used if you have more)
2025-03-09 10:12:11,219 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0005 secs
2025-03-09 10:12:11,219 [INFO]: 	Selecting most promising index types given data characteristics 03/09/2025, 10:12:11
2025-03-09 10:12:11,219 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-09 10:12:11,219 [INFO]: 	Creating the index 03/09/2025, 10:12:11
2025-03-09 10:12:11,220 [INFO]: 		-> Instanciate the index HNSW15 03/09/2025, 10:12:11
2025-03-09 10:12:11,222 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0026 secs
2025-03-09 10:12:11,222 [INFO]: 		-> Adding the vectors to the index 03/09/2025, 10:12:11
2025-03-09 10:12:11,223 [INFO]: The memory available for adding the vectors is 49.2GB(total available - used by the index)
2025-03-09 10:12:11,223 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/18 [00:00<?, ?it/s] 17%|█▋        | 3/18 [00:00<00:00, 29.11it/s] 56%|█████▌    | 10/18 [00:00<00:00, 49.73it/s] 94%|█████████▍| 17/18 [00:00<00:00, 56.02it/s]100%|██████████| 18/18 [00:03<00:00,  5.83it/s]
2025-03-09 10:12:14,318 [INFO]: 	Computing best hyperparameters for index knn.index 03/09/2025, 10:12:14
2025-03-09 10:12:48,709 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 34.3906 secs
2025-03-09 10:12:48,709 [INFO]: The best hyperparameters are: efSearch=224
2025-03-09 10:12:48,709 [INFO]: 	Compute fast metrics 03/09/2025, 10:12:48
  0%|          | 0/4 [00:00<?, ?it/s] 75%|███████▌  | 3/4 [00:00<00:00, 27.19it/s] 75%|███████▌  | 3/4 [00:00<00:00, 24.03it/s]
2025-03-09 10:13:02,790 [INFO]: 	>>> Finished "Compute fast metrics" in 14.0807 secs
2025-03-09 10:13:02,792 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 51.5693 secs
2025-03-09 10:13:02,792 [INFO]: {
2025-03-09 10:13:02,792 [INFO]: 	index_key: HNSW15
2025-03-09 10:13:02,792 [INFO]: 	index_param: efSearch=224
2025-03-09 10:13:02,792 [INFO]: 	index_path: knn.index
2025-03-09 10:13:02,792 [INFO]: 	size in bytes: 870789070
2025-03-09 10:13:02,792 [INFO]: 	avg_search_speed_ms: 7.161702118803317
2025-03-09 10:13:02,792 [INFO]: 	99p_search_speed_ms: 11.038463003933428
2025-03-09 10:13:02,792 [INFO]: 	reconstruction error %: 0.0
2025-03-09 10:13:02,792 [INFO]: 	nb vectors: 4426
2025-03-09 10:13:02,792 [INFO]: 	vectors dimension: 49152
2025-03-09 10:13:02,792 [INFO]: 	compression ratio: 0.9993086017949214
2025-03-09 10:13:02,792 [INFO]: }
2025-03-09 10:13:02,792 [INFO]: 	>>> Finished "Creating the index" in 51.5727 secs
2025-03-09 10:13:02,792 [INFO]: >>> Finished "Launching the whole pipeline" in 51.6055 secs
2025-03-09 10:13:03: [retrieval_preprocessing] calculating distances ...
2025-03-09 10:13:03: [retrieval_preprocessing] finished and saved retrieval indices for episode 79363 [episode count 0/20]
[retrieval_preprocessing] for episode 13830 [episode count 1/20], we have num_retrieval=np.int64(4176) num_query=np.int64(354)
2025-03-09 10:13:03,841 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-09 10:13:04,272 [INFO]: Launching the whole pipeline 03/09/2025, 10:13:04
2025-03-09 10:13:04,272 [INFO]: Reading total number of vectors and dimension 03/09/2025, 10:13:04
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1975.65it/s]
2025-03-09 10:13:04,295 [INFO]: There are 4176 embeddings of dim 49152
2025-03-09 10:13:04,295 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0228 secs
2025-03-09 10:13:04,295 [INFO]: 	Compute estimated construction time of the index 03/09/2025, 10:13:04
2025-03-09 10:13:04,295 [INFO]: 		-> Train: 16.7 minutes
2025-03-09 10:13:04,295 [INFO]: 		-> Add: 2.3 seconds
2025-03-09 10:13:04,295 [INFO]: 		Total: 16.7 minutes
2025-03-09 10:13:04,295 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0001 secs
2025-03-09 10:13:04,295 [INFO]: 	Checking that your have enough memory available to create the index 03/09/2025, 10:13:04
2025-03-09 10:13:04,295 [INFO]: 861.8MB of memory will be needed to build the index (more might be used if you have more)
2025-03-09 10:13:04,295 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0002 secs
2025-03-09 10:13:04,295 [INFO]: 	Selecting most promising index types given data characteristics 03/09/2025, 10:13:04
2025-03-09 10:13:04,295 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-09 10:13:04,295 [INFO]: 	Creating the index 03/09/2025, 10:13:04
2025-03-09 10:13:04,296 [INFO]: 		-> Instanciate the index HNSW15 03/09/2025, 10:13:04
2025-03-09 10:13:04,297 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0012 secs
2025-03-09 10:13:04,297 [INFO]: 		-> Adding the vectors to the index 03/09/2025, 10:13:04
2025-03-09 10:13:04,297 [INFO]: The memory available for adding the vectors is 49.2GB(total available - used by the index)
2025-03-09 10:13:04,297 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/17 [00:00<?, ?it/s] 12%|█▏        | 2/17 [00:00<00:00, 17.25it/s] 53%|█████▎    | 9/17 [00:00<00:00, 45.52it/s] 94%|█████████▍| 16/17 [00:00<00:00, 54.75it/s]100%|██████████| 17/17 [00:02<00:00,  5.89it/s]
2025-03-09 10:13:07,188 [INFO]: 	Computing best hyperparameters for index knn.index 03/09/2025, 10:13:07
2025-03-09 10:13:43,199 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 36.0107 secs
2025-03-09 10:13:43,200 [INFO]: The best hyperparameters are: efSearch=263
2025-03-09 10:13:43,200 [INFO]: 	Compute fast metrics 03/09/2025, 10:13:43
  0%|          | 0/4 [00:00<?, ?it/s] 75%|███████▌  | 3/4 [00:00<00:00, 25.99it/s] 75%|███████▌  | 3/4 [00:00<00:00, 22.58it/s]
2025-03-09 10:13:56,818 [INFO]: 	>>> Finished "Compute fast metrics" in 13.6185 secs
2025-03-09 10:13:56,820 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 52.5234 secs
2025-03-09 10:13:56,820 [INFO]: {
2025-03-09 10:13:56,821 [INFO]: 	index_key: HNSW15
2025-03-09 10:13:56,821 [INFO]: 	index_param: efSearch=263
2025-03-09 10:13:56,821 [INFO]: 	index_path: knn.index
2025-03-09 10:13:56,821 [INFO]: 	size in bytes: 821602990
2025-03-09 10:13:56,821 [INFO]: 	avg_search_speed_ms: 8.33820938707498
2025-03-09 10:13:56,821 [INFO]: 	99p_search_speed_ms: 13.686334970407186
2025-03-09 10:13:56,821 [INFO]: 	reconstruction error %: 0.0
2025-03-09 10:13:56,821 [INFO]: 	nb vectors: 4176
2025-03-09 10:13:56,821 [INFO]: 	vectors dimension: 49152
2025-03-09 10:13:56,821 [INFO]: 	compression ratio: 0.9993086904418398
2025-03-09 10:13:56,821 [INFO]: }
2025-03-09 10:13:56,821 [INFO]: 	>>> Finished "Creating the index" in 52.5252 secs
2025-03-09 10:13:56,821 [INFO]: >>> Finished "Launching the whole pipeline" in 52.5486 secs
2025-03-09 10:13:58: [retrieval_preprocessing] calculating distances ...
2025-03-09 10:13:59: [retrieval_preprocessing] finished and saved retrieval indices for episode 13830 [episode count 1/20]
[retrieval_preprocessing] for episode 46089 [episode count 2/20], we have num_retrieval=np.int64(4085) num_query=np.int64(445)
2025-03-09 10:14:00,058 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-09 10:14:00,532 [INFO]: Launching the whole pipeline 03/09/2025, 10:14:00
2025-03-09 10:14:00,532 [INFO]: Reading total number of vectors and dimension 03/09/2025, 10:14:00
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1065.08it/s]
2025-03-09 10:14:00,557 [INFO]: There are 4085 embeddings of dim 49152
2025-03-09 10:14:00,558 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0257 secs
2025-03-09 10:14:00,558 [INFO]: 	Compute estimated construction time of the index 03/09/2025, 10:14:00
2025-03-09 10:14:00,558 [INFO]: 		-> Train: 16.7 minutes
2025-03-09 10:14:00,558 [INFO]: 		-> Add: 2.2 seconds
2025-03-09 10:14:00,558 [INFO]: 		Total: 16.7 minutes
2025-03-09 10:14:00,558 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0001 secs
2025-03-09 10:14:00,558 [INFO]: 	Checking that your have enough memory available to create the index 03/09/2025, 10:14:00
2025-03-09 10:14:00,558 [INFO]: 843.0MB of memory will be needed to build the index (more might be used if you have more)
2025-03-09 10:14:00,558 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0001 secs
2025-03-09 10:14:00,558 [INFO]: 	Selecting most promising index types given data characteristics 03/09/2025, 10:14:00
2025-03-09 10:14:00,558 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-09 10:14:00,558 [INFO]: 	Creating the index 03/09/2025, 10:14:00
2025-03-09 10:14:00,558 [INFO]: 		-> Instanciate the index HNSW15 03/09/2025, 10:14:00
2025-03-09 10:14:00,559 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0011 secs
2025-03-09 10:14:00,559 [INFO]: 		-> Adding the vectors to the index 03/09/2025, 10:14:00
2025-03-09 10:14:00,560 [INFO]: The memory available for adding the vectors is 49.3GB(total available - used by the index)
2025-03-09 10:14:00,560 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/17 [00:00<?, ?it/s]  6%|▌         | 1/17 [00:00<00:01,  9.36it/s] 41%|████      | 7/17 [00:00<00:00, 38.05it/s] 76%|███████▋  | 13/17 [00:00<00:00, 47.87it/s]100%|██████████| 17/17 [00:02<00:00,  5.94it/s]
2025-03-09 10:14:03,425 [INFO]: 	Computing best hyperparameters for index knn.index 03/09/2025, 10:14:03
2025-03-09 10:14:37,717 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 34.2922 secs
2025-03-09 10:14:37,718 [INFO]: The best hyperparameters are: efSearch=275
2025-03-09 10:14:37,718 [INFO]: 	Compute fast metrics 03/09/2025, 10:14:37
  0%|          | 0/4 [00:00<?, ?it/s] 75%|███████▌  | 3/4 [00:00<00:00, 26.96it/s] 75%|███████▌  | 3/4 [00:00<00:00, 23.28it/s]
2025-03-09 10:14:53,696 [INFO]: 	>>> Finished "Compute fast metrics" in 15.9786 secs
2025-03-09 10:14:53,698 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 53.1389 secs
2025-03-09 10:14:53,698 [INFO]: {
2025-03-09 10:14:53,699 [INFO]: 	index_key: HNSW15
2025-03-09 10:14:53,699 [INFO]: 	index_param: efSearch=275
2025-03-09 10:14:53,699 [INFO]: 	index_path: knn.index
2025-03-09 10:14:53,699 [INFO]: 	size in bytes: 803699350
2025-03-09 10:14:53,699 [INFO]: 	avg_search_speed_ms: 10.007944643484416
2025-03-09 10:14:53,699 [INFO]: 	99p_search_speed_ms: 13.44239195343107
2025-03-09 10:14:53,699 [INFO]: 	reconstruction error %: 0.0
2025-03-09 10:14:53,699 [INFO]: 	nb vectors: 4085
2025-03-09 10:14:53,699 [INFO]: 	vectors dimension: 49152
2025-03-09 10:14:53,699 [INFO]: 	compression ratio: 0.9993086096187586
2025-03-09 10:14:53,699 [INFO]: }
2025-03-09 10:14:53,699 [INFO]: 	>>> Finished "Creating the index" in 53.1404 secs
2025-03-09 10:14:53,699 [INFO]: >>> Finished "Launching the whole pipeline" in 53.1668 secs
2025-03-09 10:14:56: [retrieval_preprocessing] calculating distances ...
2025-03-09 10:14:58: [retrieval_preprocessing] finished and saved retrieval indices for episode 46089 [episode count 2/20]
[retrieval_preprocessing] for episode 56845 [episode count 3/20], we have num_retrieval=np.int64(4244) num_query=np.int64(286)
2025-03-09 10:14:58,345 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-09 10:14:58,820 [INFO]: Launching the whole pipeline 03/09/2025, 10:14:58
2025-03-09 10:14:58,820 [INFO]: Reading total number of vectors and dimension 03/09/2025, 10:14:58
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1206.30it/s]
2025-03-09 10:14:58,846 [INFO]: There are 4244 embeddings of dim 49152
2025-03-09 10:14:58,847 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0270 secs
2025-03-09 10:14:58,847 [INFO]: 	Compute estimated construction time of the index 03/09/2025, 10:14:58
2025-03-09 10:14:58,847 [INFO]: 		-> Train: 16.7 minutes
2025-03-09 10:14:58,847 [INFO]: 		-> Add: 2.3 seconds
2025-03-09 10:14:58,847 [INFO]: 		Total: 16.7 minutes
2025-03-09 10:14:58,847 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0001 secs
2025-03-09 10:14:58,847 [INFO]: 	Checking that your have enough memory available to create the index 03/09/2025, 10:14:58
2025-03-09 10:14:58,847 [INFO]: 875.9MB of memory will be needed to build the index (more might be used if you have more)
2025-03-09 10:14:58,847 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0002 secs
2025-03-09 10:14:58,847 [INFO]: 	Selecting most promising index types given data characteristics 03/09/2025, 10:14:58
2025-03-09 10:14:58,847 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-09 10:14:58,847 [INFO]: 	Creating the index 03/09/2025, 10:14:58
2025-03-09 10:14:58,848 [INFO]: 		-> Instanciate the index HNSW15 03/09/2025, 10:14:58
2025-03-09 10:14:58,849 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0013 secs
2025-03-09 10:14:58,849 [INFO]: 		-> Adding the vectors to the index 03/09/2025, 10:14:58
2025-03-09 10:14:58,849 [INFO]: The memory available for adding the vectors is 49.2GB(total available - used by the index)
2025-03-09 10:14:58,849 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/17 [00:00<?, ?it/s]  6%|▌         | 1/17 [00:00<00:01,  9.38it/s] 41%|████      | 7/17 [00:00<00:00, 38.15it/s] 76%|███████▋  | 13/17 [00:00<00:00, 47.50it/s]100%|██████████| 17/17 [00:02<00:00,  5.85it/s]
2025-03-09 10:15:01,761 [INFO]: 	Computing best hyperparameters for index knn.index 03/09/2025, 10:15:01
2025-03-09 10:15:39,068 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 37.3070 secs
2025-03-09 10:15:39,068 [INFO]: The best hyperparameters are: efSearch=272
2025-03-09 10:15:39,068 [INFO]: 	Compute fast metrics 03/09/2025, 10:15:39
  0%|          | 0/4 [00:00<?, ?it/s] 75%|███████▌  | 3/4 [00:00<00:00, 26.91it/s] 75%|███████▌  | 3/4 [00:00<00:00, 23.28it/s]
2025-03-09 10:15:54,423 [INFO]: 	>>> Finished "Compute fast metrics" in 15.3548 secs
2025-03-09 10:15:54,425 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 55.5764 secs
2025-03-09 10:15:54,425 [INFO]: {
2025-03-09 10:15:54,426 [INFO]: 	index_key: HNSW15
2025-03-09 10:15:54,426 [INFO]: 	index_param: efSearch=272
2025-03-09 10:15:54,426 [INFO]: 	index_path: knn.index
2025-03-09 10:15:54,426 [INFO]: 	size in bytes: 834981610
2025-03-09 10:15:54,426 [INFO]: 	avg_search_speed_ms: 9.269424701416805
2025-03-09 10:15:54,426 [INFO]: 	99p_search_speed_ms: 13.212511609308423
2025-03-09 10:15:54,426 [INFO]: 	reconstruction error %: 0.0
2025-03-09 10:15:54,426 [INFO]: 	nb vectors: 4244
2025-03-09 10:15:54,426 [INFO]: 	vectors dimension: 49152
2025-03-09 10:15:54,426 [INFO]: 	compression ratio: 0.9993086578278053
2025-03-09 10:15:54,426 [INFO]: }
2025-03-09 10:15:54,426 [INFO]: 	>>> Finished "Creating the index" in 55.5782 secs
2025-03-09 10:15:54,426 [INFO]: >>> Finished "Launching the whole pipeline" in 55.6060 secs
2025-03-09 10:15:56: [retrieval_preprocessing] calculating distances ...
2025-03-09 10:15:56: [retrieval_preprocessing] finished and saved retrieval indices for episode 56845 [episode count 3/20]
[retrieval_preprocessing] for episode 33295 [episode count 4/20], we have num_retrieval=np.int64(4444) num_query=np.int64(86)
2025-03-09 10:15:57,105 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-09 10:15:57,608 [INFO]: Launching the whole pipeline 03/09/2025, 10:15:57
2025-03-09 10:15:57,608 [INFO]: Reading total number of vectors and dimension 03/09/2025, 10:15:57
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1659.14it/s]
2025-03-09 10:15:57,635 [INFO]: There are 4444 embeddings of dim 49152
2025-03-09 10:15:57,635 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0270 secs
2025-03-09 10:15:57,635 [INFO]: 	Compute estimated construction time of the index 03/09/2025, 10:15:57
2025-03-09 10:15:57,635 [INFO]: 		-> Train: 16.7 minutes
2025-03-09 10:15:57,635 [INFO]: 		-> Add: 2.4 seconds
2025-03-09 10:15:57,635 [INFO]: 		Total: 16.7 minutes
2025-03-09 10:15:57,635 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0001 secs
2025-03-09 10:15:57,635 [INFO]: 	Checking that your have enough memory available to create the index 03/09/2025, 10:15:57
2025-03-09 10:15:57,635 [INFO]: 917.1MB of memory will be needed to build the index (more might be used if you have more)
2025-03-09 10:15:57,635 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0001 secs
2025-03-09 10:15:57,635 [INFO]: 	Selecting most promising index types given data characteristics 03/09/2025, 10:15:57
2025-03-09 10:15:57,635 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-09 10:15:57,635 [INFO]: 	Creating the index 03/09/2025, 10:15:57
2025-03-09 10:15:57,636 [INFO]: 		-> Instanciate the index HNSW15 03/09/2025, 10:15:57
2025-03-09 10:15:57,637 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0010 secs
2025-03-09 10:15:57,637 [INFO]: 		-> Adding the vectors to the index 03/09/2025, 10:15:57
2025-03-09 10:15:57,637 [INFO]: The memory available for adding the vectors is 49.2GB(total available - used by the index)
2025-03-09 10:15:57,637 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/18 [00:00<?, ?it/s]  6%|▌         | 1/18 [00:00<00:01,  9.28it/s] 44%|████▍     | 8/18 [00:00<00:00, 40.24it/s] 83%|████████▎ | 15/18 [00:00<00:00, 49.52it/s]100%|██████████| 18/18 [00:03<00:00,  5.95it/s]
2025-03-09 10:16:00,667 [INFO]: 	Computing best hyperparameters for index knn.index 03/09/2025, 10:16:00
2025-03-09 10:16:34,340 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 33.6725 secs
2025-03-09 10:16:34,340 [INFO]: The best hyperparameters are: efSearch=230
2025-03-09 10:16:34,341 [INFO]: 	Compute fast metrics 03/09/2025, 10:16:34
  0%|          | 0/4 [00:00<?, ?it/s] 75%|███████▌  | 3/4 [00:00<00:00, 27.43it/s] 75%|███████▌  | 3/4 [00:00<00:00, 23.61it/s]
2025-03-09 10:16:47,782 [INFO]: 	>>> Finished "Compute fast metrics" in 13.4410 secs
2025-03-09 10:16:47,784 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 50.1473 secs
2025-03-09 10:16:47,784 [INFO]: {
2025-03-09 10:16:47,784 [INFO]: 	index_key: HNSW15
2025-03-09 10:16:47,784 [INFO]: 	index_param: efSearch=230
2025-03-09 10:16:47,784 [INFO]: 	index_path: knn.index
2025-03-09 10:16:47,784 [INFO]: 	size in bytes: 874330450
2025-03-09 10:16:47,784 [INFO]: 	avg_search_speed_ms: 7.902620937086259
2025-03-09 10:16:47,784 [INFO]: 	99p_search_speed_ms: 11.805416652932756
2025-03-09 10:16:47,784 [INFO]: 	reconstruction error %: 0.0
2025-03-09 10:16:47,784 [INFO]: 	nb vectors: 4444
2025-03-09 10:16:47,784 [INFO]: 	vectors dimension: 49152
2025-03-09 10:16:47,784 [INFO]: 	compression ratio: 0.9993086160958937
2025-03-09 10:16:47,784 [INFO]: }
2025-03-09 10:16:47,784 [INFO]: 	>>> Finished "Creating the index" in 50.1488 secs
2025-03-09 10:16:47,784 [INFO]: >>> Finished "Launching the whole pipeline" in 50.1766 secs
2025-03-09 10:16:48: [retrieval_preprocessing] calculating distances ...
2025-03-09 10:16:48: [retrieval_preprocessing] finished and saved retrieval indices for episode 33295 [episode count 4/20]
[retrieval_preprocessing] for episode 81936 [episode count 5/20], we have num_retrieval=np.int64(4361) num_query=np.int64(169)
2025-03-09 10:16:48,902 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-09 10:16:49,407 [INFO]: Launching the whole pipeline 03/09/2025, 10:16:49
2025-03-09 10:16:49,407 [INFO]: Reading total number of vectors and dimension 03/09/2025, 10:16:49
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 2449.94it/s]
2025-03-09 10:16:49,430 [INFO]: There are 4361 embeddings of dim 49152
2025-03-09 10:16:49,431 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0233 secs
2025-03-09 10:16:49,431 [INFO]: 	Compute estimated construction time of the index 03/09/2025, 10:16:49
2025-03-09 10:16:49,431 [INFO]: 		-> Train: 16.7 minutes
2025-03-09 10:16:49,431 [INFO]: 		-> Add: 2.4 seconds
2025-03-09 10:16:49,431 [INFO]: 		Total: 16.7 minutes
2025-03-09 10:16:49,431 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0001 secs
2025-03-09 10:16:49,431 [INFO]: 	Checking that your have enough memory available to create the index 03/09/2025, 10:16:49
2025-03-09 10:16:49,431 [INFO]: 900.0MB of memory will be needed to build the index (more might be used if you have more)
2025-03-09 10:16:49,431 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0001 secs
2025-03-09 10:16:49,431 [INFO]: 	Selecting most promising index types given data characteristics 03/09/2025, 10:16:49
2025-03-09 10:16:49,431 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-09 10:16:49,431 [INFO]: 	Creating the index 03/09/2025, 10:16:49
2025-03-09 10:16:49,431 [INFO]: 		-> Instanciate the index HNSW15 03/09/2025, 10:16:49
2025-03-09 10:16:49,432 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0009 secs
2025-03-09 10:16:49,432 [INFO]: 		-> Adding the vectors to the index 03/09/2025, 10:16:49
2025-03-09 10:16:49,432 [INFO]: The memory available for adding the vectors is 49.2GB(total available - used by the index)
2025-03-09 10:16:49,432 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/18 [00:00<?, ?it/s] 17%|█▋        | 3/18 [00:00<00:00, 26.07it/s] 56%|█████▌    | 10/18 [00:00<00:00, 47.10it/s] 94%|█████████▍| 17/18 [00:00<00:00, 53.45it/s]100%|██████████| 18/18 [00:03<00:00,  5.48it/s]
2025-03-09 10:16:52,719 [INFO]: 	Computing best hyperparameters for index knn.index 03/09/2025, 10:16:52
2025-03-09 10:17:32,583 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 39.8630 secs
2025-03-09 10:17:32,584 [INFO]: The best hyperparameters are: efSearch=250
2025-03-09 10:17:32,584 [INFO]: 	Compute fast metrics 03/09/2025, 10:17:32
  0%|          | 0/4 [00:00<?, ?it/s] 75%|███████▌  | 3/4 [00:00<00:00, 27.96it/s] 75%|███████▌  | 3/4 [00:00<00:00, 24.24it/s]
2025-03-09 10:17:47,000 [INFO]: 	>>> Finished "Compute fast metrics" in 14.4159 secs
2025-03-09 10:17:47,002 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 57.5700 secs
2025-03-09 10:17:47,002 [INFO]: {
2025-03-09 10:17:47,002 [INFO]: 	index_key: HNSW15
2025-03-09 10:17:47,002 [INFO]: 	index_param: efSearch=250
2025-03-09 10:17:47,002 [INFO]: 	index_path: knn.index
2025-03-09 10:17:47,002 [INFO]: 	size in bytes: 858000730
2025-03-09 10:17:47,002 [INFO]: 	avg_search_speed_ms: 8.339320693756948
2025-03-09 10:17:47,002 [INFO]: 	99p_search_speed_ms: 12.757548978552222
2025-03-09 10:17:47,002 [INFO]: 	reconstruction error %: 0.0
2025-03-09 10:17:47,002 [INFO]: 	nb vectors: 4361
2025-03-09 10:17:47,002 [INFO]: 	vectors dimension: 49152
2025-03-09 10:17:47,002 [INFO]: 	compression ratio: 0.9993085763458499
2025-03-09 10:17:47,002 [INFO]: }
2025-03-09 10:17:47,002 [INFO]: 	>>> Finished "Creating the index" in 57.5713 secs
2025-03-09 10:17:47,002 [INFO]: >>> Finished "Launching the whole pipeline" in 57.5952 secs
2025-03-09 10:17:48: [retrieval_preprocessing] calculating distances ...
2025-03-09 10:17:48: [retrieval_preprocessing] finished and saved retrieval indices for episode 81936 [episode count 5/20]
[retrieval_preprocessing] for episode 8211 [episode count 6/20], we have num_retrieval=np.int64(4267) num_query=np.int64(263)
2025-03-09 10:17:49,071 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-09 10:17:49,559 [INFO]: Launching the whole pipeline 03/09/2025, 10:17:49
2025-03-09 10:17:49,559 [INFO]: Reading total number of vectors and dimension 03/09/2025, 10:17:49
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1597.22it/s]
2025-03-09 10:17:49,587 [INFO]: There are 4267 embeddings of dim 49152
2025-03-09 10:17:49,587 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0276 secs
2025-03-09 10:17:49,587 [INFO]: 	Compute estimated construction time of the index 03/09/2025, 10:17:49
2025-03-09 10:17:49,587 [INFO]: 		-> Train: 16.7 minutes
2025-03-09 10:17:49,587 [INFO]: 		-> Add: 2.3 seconds
2025-03-09 10:17:49,587 [INFO]: 		Total: 16.7 minutes
2025-03-09 10:17:49,587 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0001 secs
2025-03-09 10:17:49,587 [INFO]: 	Checking that your have enough memory available to create the index 03/09/2025, 10:17:49
2025-03-09 10:17:49,587 [INFO]: 880.6MB of memory will be needed to build the index (more might be used if you have more)
2025-03-09 10:17:49,587 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0001 secs
2025-03-09 10:17:49,587 [INFO]: 	Selecting most promising index types given data characteristics 03/09/2025, 10:17:49
2025-03-09 10:17:49,587 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-09 10:17:49,587 [INFO]: 	Creating the index 03/09/2025, 10:17:49
2025-03-09 10:17:49,588 [INFO]: 		-> Instanciate the index HNSW15 03/09/2025, 10:17:49
2025-03-09 10:17:49,588 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0009 secs
2025-03-09 10:17:49,588 [INFO]: 		-> Adding the vectors to the index 03/09/2025, 10:17:49
2025-03-09 10:17:49,589 [INFO]: The memory available for adding the vectors is 49.2GB(total available - used by the index)
2025-03-09 10:17:49,589 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/17 [00:00<?, ?it/s]  6%|▌         | 1/17 [00:00<00:01,  8.50it/s] 47%|████▋     | 8/17 [00:00<00:00, 39.10it/s] 88%|████████▊ | 15/17 [00:00<00:00, 50.18it/s]100%|██████████| 17/17 [00:03<00:00,  5.49it/s]
2025-03-09 10:17:52,692 [INFO]: 	Computing best hyperparameters for index knn.index 03/09/2025, 10:17:52
2025-03-09 10:18:32,089 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 39.3963 secs
2025-03-09 10:18:32,089 [INFO]: The best hyperparameters are: efSearch=248
2025-03-09 10:18:32,089 [INFO]: 	Compute fast metrics 03/09/2025, 10:18:32
  0%|          | 0/4 [00:00<?, ?it/s] 50%|█████     | 2/4 [00:00<00:00, 19.40it/s] 75%|███████▌  | 3/4 [00:00<00:00, 20.23it/s]
2025-03-09 10:18:47,205 [INFO]: 	>>> Finished "Compute fast metrics" in 15.1157 secs
2025-03-09 10:18:47,207 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 57.6185 secs
2025-03-09 10:18:47,207 [INFO]: {
2025-03-09 10:18:47,207 [INFO]: 	index_key: HNSW15
2025-03-09 10:18:47,207 [INFO]: 	index_param: efSearch=248
2025-03-09 10:18:47,207 [INFO]: 	index_path: knn.index
2025-03-09 10:18:47,207 [INFO]: 	size in bytes: 839506630
2025-03-09 10:18:47,207 [INFO]: 	avg_search_speed_ms: 8.437722678323775
2025-03-09 10:18:47,207 [INFO]: 	99p_search_speed_ms: 12.942975899204619
2025-03-09 10:18:47,207 [INFO]: 	reconstruction error %: 0.0
2025-03-09 10:18:47,207 [INFO]: 	nb vectors: 4267
2025-03-09 10:18:47,207 [INFO]: 	vectors dimension: 49152
2025-03-09 10:18:47,207 [INFO]: 	compression ratio: 0.999308767817593
2025-03-09 10:18:47,207 [INFO]: }
2025-03-09 10:18:47,207 [INFO]: 	>>> Finished "Creating the index" in 57.6198 secs
2025-03-09 10:18:47,207 [INFO]: >>> Finished "Launching the whole pipeline" in 57.6480 secs
2025-03-09 10:18:48: [retrieval_preprocessing] calculating distances ...
2025-03-09 10:18:49: [retrieval_preprocessing] finished and saved retrieval indices for episode 8211 [episode count 6/20]
[retrieval_preprocessing] for episode 52764 [episode count 7/20], we have num_retrieval=np.int64(4259) num_query=np.int64(271)
2025-03-09 10:18:49,786 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-09 10:18:50,262 [INFO]: Launching the whole pipeline 03/09/2025, 10:18:50
2025-03-09 10:18:50,262 [INFO]: Reading total number of vectors and dimension 03/09/2025, 10:18:50
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1811.01it/s]
2025-03-09 10:18:50,288 [INFO]: There are 4259 embeddings of dim 49152
2025-03-09 10:18:50,288 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0255 secs
2025-03-09 10:18:50,288 [INFO]: 	Compute estimated construction time of the index 03/09/2025, 10:18:50
2025-03-09 10:18:50,288 [INFO]: 		-> Train: 16.7 minutes
2025-03-09 10:18:50,288 [INFO]: 		-> Add: 2.3 seconds
2025-03-09 10:18:50,288 [INFO]: 		Total: 16.7 minutes
2025-03-09 10:18:50,288 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0001 secs
2025-03-09 10:18:50,288 [INFO]: 	Checking that your have enough memory available to create the index 03/09/2025, 10:18:50
2025-03-09 10:18:50,288 [INFO]: 879.0MB of memory will be needed to build the index (more might be used if you have more)
2025-03-09 10:18:50,288 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0002 secs
2025-03-09 10:18:50,289 [INFO]: 	Selecting most promising index types given data characteristics 03/09/2025, 10:18:50
2025-03-09 10:18:50,289 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-09 10:18:50,289 [INFO]: 	Creating the index 03/09/2025, 10:18:50
2025-03-09 10:18:50,289 [INFO]: 		-> Instanciate the index HNSW15 03/09/2025, 10:18:50
2025-03-09 10:18:50,290 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0012 secs
2025-03-09 10:18:50,290 [INFO]: 		-> Adding the vectors to the index 03/09/2025, 10:18:50
2025-03-09 10:18:50,290 [INFO]: The memory available for adding the vectors is 49.2GB(total available - used by the index)
2025-03-09 10:18:50,290 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/17 [00:00<?, ?it/s] 12%|█▏        | 2/17 [00:00<00:00, 18.22it/s] 47%|████▋     | 8/17 [00:00<00:00, 41.50it/s] 82%|████████▏ | 14/17 [00:00<00:00, 49.46it/s]100%|██████████| 17/17 [00:03<00:00,  5.65it/s]
2025-03-09 10:18:53,300 [INFO]: 	Computing best hyperparameters for index knn.index 03/09/2025, 10:18:53
2025-03-09 10:19:31,686 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 38.3853 secs
2025-03-09 10:19:31,686 [INFO]: The best hyperparameters are: efSearch=286
2025-03-09 10:19:31,686 [INFO]: 	Compute fast metrics 03/09/2025, 10:19:31
  0%|          | 0/4 [00:00<?, ?it/s] 50%|█████     | 2/4 [00:00<00:00, 19.39it/s] 75%|███████▌  | 3/4 [00:00<00:00, 21.50it/s]
2025-03-09 10:19:47,262 [INFO]: 	>>> Finished "Compute fast metrics" in 15.5756 secs
2025-03-09 10:19:47,264 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 56.9740 secs
2025-03-09 10:19:47,264 [INFO]: {
2025-03-09 10:19:47,264 [INFO]: 	index_key: HNSW15
2025-03-09 10:19:47,264 [INFO]: 	index_param: efSearch=286
2025-03-09 10:19:47,264 [INFO]: 	index_path: knn.index
2025-03-09 10:19:47,264 [INFO]: 	size in bytes: 837932710
2025-03-09 10:19:47,264 [INFO]: 	avg_search_speed_ms: 9.460958995166443
2025-03-09 10:19:47,264 [INFO]: 	99p_search_speed_ms: 14.198147542774679
2025-03-09 10:19:47,264 [INFO]: 	reconstruction error %: 0.0
2025-03-09 10:19:47,264 [INFO]: 	nb vectors: 4259
2025-03-09 10:19:47,264 [INFO]: 	vectors dimension: 49152
2025-03-09 10:19:47,265 [INFO]: 	compression ratio: 0.9993087296950134
2025-03-09 10:19:47,265 [INFO]: }
2025-03-09 10:19:47,265 [INFO]: 	>>> Finished "Creating the index" in 56.9759 secs
2025-03-09 10:19:47,265 [INFO]: >>> Finished "Launching the whole pipeline" in 57.0021 secs
2025-03-09 10:19:49: [retrieval_preprocessing] calculating distances ...
2025-03-09 10:19:50: [retrieval_preprocessing] finished and saved retrieval indices for episode 52764 [episode count 7/20]
[retrieval_preprocessing] for episode 15901 [episode count 8/20], we have num_retrieval=np.int64(4264) num_query=np.int64(266)
2025-03-09 10:19:50,542 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-09 10:19:51,010 [INFO]: Launching the whole pipeline 03/09/2025, 10:19:51
2025-03-09 10:19:51,011 [INFO]: Reading total number of vectors and dimension 03/09/2025, 10:19:51
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1786.33it/s]
2025-03-09 10:19:51,036 [INFO]: There are 4264 embeddings of dim 49152
2025-03-09 10:19:51,036 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0252 secs
2025-03-09 10:19:51,036 [INFO]: 	Compute estimated construction time of the index 03/09/2025, 10:19:51
2025-03-09 10:19:51,036 [INFO]: 		-> Train: 16.7 minutes
2025-03-09 10:19:51,036 [INFO]: 		-> Add: 2.3 seconds
2025-03-09 10:19:51,036 [INFO]: 		Total: 16.7 minutes
2025-03-09 10:19:51,036 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0001 secs
2025-03-09 10:19:51,036 [INFO]: 	Checking that your have enough memory available to create the index 03/09/2025, 10:19:51
2025-03-09 10:19:51,036 [INFO]: 880.0MB of memory will be needed to build the index (more might be used if you have more)
2025-03-09 10:19:51,036 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0001 secs
2025-03-09 10:19:51,036 [INFO]: 	Selecting most promising index types given data characteristics 03/09/2025, 10:19:51
2025-03-09 10:19:51,036 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-09 10:19:51,036 [INFO]: 	Creating the index 03/09/2025, 10:19:51
2025-03-09 10:19:51,036 [INFO]: 		-> Instanciate the index HNSW15 03/09/2025, 10:19:51
2025-03-09 10:19:51,037 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0010 secs
2025-03-09 10:19:51,037 [INFO]: 		-> Adding the vectors to the index 03/09/2025, 10:19:51
2025-03-09 10:19:51,037 [INFO]: The memory available for adding the vectors is 49.2GB(total available - used by the index)
2025-03-09 10:19:51,037 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/17 [00:00<?, ?it/s] 12%|█▏        | 2/17 [00:00<00:00, 17.86it/s] 47%|████▋     | 8/17 [00:00<00:00, 41.07it/s] 82%|████████▏ | 14/17 [00:00<00:00, 48.77it/s]100%|██████████| 17/17 [00:03<00:00,  5.34it/s]
2025-03-09 10:19:54,223 [INFO]: 	Computing best hyperparameters for index knn.index 03/09/2025, 10:19:54
2025-03-09 10:20:28,728 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 34.5047 secs
2025-03-09 10:20:28,728 [INFO]: The best hyperparameters are: efSearch=286
2025-03-09 10:20:28,729 [INFO]: 	Compute fast metrics 03/09/2025, 10:20:28
  0%|          | 0/4 [00:00<?, ?it/s] 75%|███████▌  | 3/4 [00:00<00:00, 26.97it/s] 75%|███████▌  | 3/4 [00:00<00:00, 23.26it/s]
2025-03-09 10:20:44,816 [INFO]: 	>>> Finished "Compute fast metrics" in 16.0874 secs
2025-03-09 10:20:44,818 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 53.7807 secs
2025-03-09 10:20:44,818 [INFO]: {
2025-03-09 10:20:44,818 [INFO]: 	index_key: HNSW15
2025-03-09 10:20:44,818 [INFO]: 	index_param: efSearch=286
2025-03-09 10:20:44,818 [INFO]: 	index_path: knn.index
2025-03-09 10:20:44,818 [INFO]: 	size in bytes: 838916410
2025-03-09 10:20:44,818 [INFO]: 	avg_search_speed_ms: 9.224081470165402
2025-03-09 10:20:44,818 [INFO]: 	99p_search_speed_ms: 12.76706148404628
2025-03-09 10:20:44,818 [INFO]: 	reconstruction error %: 0.0
2025-03-09 10:20:44,818 [INFO]: 	nb vectors: 4264
2025-03-09 10:20:44,818 [INFO]: 	vectors dimension: 49152
2025-03-09 10:20:44,818 [INFO]: 	compression ratio: 0.9993087535383889
2025-03-09 10:20:44,818 [INFO]: }
2025-03-09 10:20:44,818 [INFO]: 	>>> Finished "Creating the index" in 53.7821 secs
2025-03-09 10:20:44,818 [INFO]: >>> Finished "Launching the whole pipeline" in 53.8078 secs
2025-03-09 10:20:46: [retrieval_preprocessing] calculating distances ...
2025-03-09 10:20:47: [retrieval_preprocessing] finished and saved retrieval indices for episode 15901 [episode count 8/20]
[retrieval_preprocessing] for episode 10785 [episode count 9/20], we have num_retrieval=np.int64(4345) num_query=np.int64(185)
2025-03-09 10:20:47,506 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-09 10:20:47,991 [INFO]: Launching the whole pipeline 03/09/2025, 10:20:47
2025-03-09 10:20:47,991 [INFO]: Reading total number of vectors and dimension 03/09/2025, 10:20:47
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 2081.54it/s]
2025-03-09 10:20:48,015 [INFO]: There are 4345 embeddings of dim 49152
2025-03-09 10:20:48,015 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0246 secs
2025-03-09 10:20:48,015 [INFO]: 	Compute estimated construction time of the index 03/09/2025, 10:20:48
2025-03-09 10:20:48,015 [INFO]: 		-> Train: 16.7 minutes
2025-03-09 10:20:48,016 [INFO]: 		-> Add: 2.4 seconds
2025-03-09 10:20:48,016 [INFO]: 		Total: 16.7 minutes
2025-03-09 10:20:48,016 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0001 secs
2025-03-09 10:20:48,016 [INFO]: 	Checking that your have enough memory available to create the index 03/09/2025, 10:20:48
2025-03-09 10:20:48,016 [INFO]: 896.7MB of memory will be needed to build the index (more might be used if you have more)
2025-03-09 10:20:48,016 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0002 secs
2025-03-09 10:20:48,016 [INFO]: 	Selecting most promising index types given data characteristics 03/09/2025, 10:20:48
2025-03-09 10:20:48,016 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-09 10:20:48,016 [INFO]: 	Creating the index 03/09/2025, 10:20:48
2025-03-09 10:20:48,016 [INFO]: 		-> Instanciate the index HNSW15 03/09/2025, 10:20:48
2025-03-09 10:20:48,017 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0010 secs
2025-03-09 10:20:48,017 [INFO]: 		-> Adding the vectors to the index 03/09/2025, 10:20:48
2025-03-09 10:20:48,017 [INFO]: The memory available for adding the vectors is 49.2GB(total available - used by the index)
2025-03-09 10:20:48,017 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/18 [00:00<?, ?it/s]  6%|▌         | 1/18 [00:00<00:01,  9.42it/s] 39%|███▉      | 7/18 [00:00<00:00, 38.34it/s] 78%|███████▊  | 14/18 [00:00<00:00, 49.10it/s]100%|██████████| 18/18 [00:03<00:00,  5.70it/s]
2025-03-09 10:20:51,180 [INFO]: 	Computing best hyperparameters for index knn.index 03/09/2025, 10:20:51
2025-03-09 10:21:29,384 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 38.2041 secs
2025-03-09 10:21:29,385 [INFO]: The best hyperparameters are: efSearch=274
2025-03-09 10:21:29,385 [INFO]: 	Compute fast metrics 03/09/2025, 10:21:29
  0%|          | 0/4 [00:00<?, ?it/s] 75%|███████▌  | 3/4 [00:00<00:00, 27.48it/s] 75%|███████▌  | 3/4 [00:00<00:00, 23.87it/s]
2025-03-09 10:21:45,848 [INFO]: 	>>> Finished "Compute fast metrics" in 16.4634 secs
2025-03-09 10:21:46,456 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 58.4385 secs
2025-03-09 10:21:46,456 [INFO]: {
2025-03-09 10:21:46,456 [INFO]: 	index_key: HNSW15
2025-03-09 10:21:46,456 [INFO]: 	index_param: efSearch=274
2025-03-09 10:21:46,456 [INFO]: 	index_path: knn.index
2025-03-09 10:21:46,456 [INFO]: 	size in bytes: 854852830
2025-03-09 10:21:46,456 [INFO]: 	avg_search_speed_ms: 9.218138190896212
2025-03-09 10:21:46,456 [INFO]: 	99p_search_speed_ms: 13.40748401358726
2025-03-09 10:21:46,456 [INFO]: 	reconstruction error %: 0.0
2025-03-09 10:21:46,456 [INFO]: 	nb vectors: 4345
2025-03-09 10:21:46,456 [INFO]: 	vectors dimension: 49152
2025-03-09 10:21:46,456 [INFO]: 	compression ratio: 0.9993085710437433
2025-03-09 10:21:46,456 [INFO]: }
2025-03-09 10:21:46,457 [INFO]: 	>>> Finished "Creating the index" in 58.4406 secs
2025-03-09 10:21:46,457 [INFO]: >>> Finished "Launching the whole pipeline" in 58.4659 secs
2025-03-09 10:21:47: [retrieval_preprocessing] calculating distances ...
2025-03-09 10:21:48: [retrieval_preprocessing] finished and saved retrieval indices for episode 10785 [episode count 9/20]
[retrieval_preprocessing] for episode 32802 [episode count 10/20], we have num_retrieval=np.int64(4405) num_query=np.int64(125)
2025-03-09 10:21:48,534 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-09 10:21:49,055 [INFO]: Launching the whole pipeline 03/09/2025, 10:21:49
2025-03-09 10:21:49,055 [INFO]: Reading total number of vectors and dimension 03/09/2025, 10:21:49
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 775.43it/s]
2025-03-09 10:21:49,073 [INFO]: There are 4405 embeddings of dim 49152
2025-03-09 10:21:49,073 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0187 secs
2025-03-09 10:21:49,073 [INFO]: 	Compute estimated construction time of the index 03/09/2025, 10:21:49
2025-03-09 10:21:49,073 [INFO]: 		-> Train: 16.7 minutes
2025-03-09 10:21:49,073 [INFO]: 		-> Add: 2.4 seconds
2025-03-09 10:21:49,074 [INFO]: 		Total: 16.7 minutes
2025-03-09 10:21:49,074 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0001 secs
2025-03-09 10:21:49,074 [INFO]: 	Checking that your have enough memory available to create the index 03/09/2025, 10:21:49
2025-03-09 10:21:49,074 [INFO]: 909.1MB of memory will be needed to build the index (more might be used if you have more)
2025-03-09 10:21:49,074 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0001 secs
2025-03-09 10:21:49,074 [INFO]: 	Selecting most promising index types given data characteristics 03/09/2025, 10:21:49
2025-03-09 10:21:49,074 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-09 10:21:49,074 [INFO]: 	Creating the index 03/09/2025, 10:21:49
2025-03-09 10:21:49,074 [INFO]: 		-> Instanciate the index HNSW15 03/09/2025, 10:21:49
2025-03-09 10:21:49,075 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0010 secs
2025-03-09 10:21:49,075 [INFO]: 		-> Adding the vectors to the index 03/09/2025, 10:21:49
2025-03-09 10:21:49,075 [INFO]: The memory available for adding the vectors is 49.2GB(total available - used by the index)
2025-03-09 10:21:49,075 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/18 [00:00<?, ?it/s]  6%|▌         | 1/18 [00:00<00:01,  9.27it/s] 44%|████▍     | 8/18 [00:00<00:00, 41.10it/s] 83%|████████▎ | 15/18 [00:00<00:00, 50.94it/s]100%|██████████| 18/18 [00:03<00:00,  4.99it/s]
2025-03-09 10:21:52,683 [INFO]: 	Computing best hyperparameters for index knn.index 03/09/2025, 10:21:52
2025-03-09 10:22:32,086 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 39.4030 secs
2025-03-09 10:22:32,086 [INFO]: The best hyperparameters are: efSearch=276
2025-03-09 10:22:32,086 [INFO]: 	Compute fast metrics 03/09/2025, 10:22:32
  0%|          | 0/4 [00:00<?, ?it/s] 75%|███████▌  | 3/4 [00:00<00:00, 27.47it/s] 75%|███████▌  | 3/4 [00:00<00:00, 23.71it/s]
2025-03-09 10:22:47,330 [INFO]: 	>>> Finished "Compute fast metrics" in 15.2438 secs
2025-03-09 10:22:47,333 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 58.2576 secs
2025-03-09 10:22:47,333 [INFO]: {
2025-03-09 10:22:47,333 [INFO]: 	index_key: HNSW15
2025-03-09 10:22:47,333 [INFO]: 	index_param: efSearch=276
2025-03-09 10:22:47,333 [INFO]: 	index_path: knn.index
2025-03-09 10:22:47,333 [INFO]: 	size in bytes: 866657410
2025-03-09 10:22:47,333 [INFO]: 	avg_search_speed_ms: 9.080412980387099
2025-03-09 10:22:47,333 [INFO]: 	99p_search_speed_ms: 13.639239436015488
2025-03-09 10:22:47,333 [INFO]: 	reconstruction error %: 0.0
2025-03-09 10:22:47,333 [INFO]: 	nb vectors: 4405
2025-03-09 10:22:47,333 [INFO]: 	vectors dimension: 49152
2025-03-09 10:22:47,333 [INFO]: 	compression ratio: 0.9993086426157713
2025-03-09 10:22:47,333 [INFO]: }
2025-03-09 10:22:47,333 [INFO]: 	>>> Finished "Creating the index" in 58.2591 secs
2025-03-09 10:22:47,333 [INFO]: >>> Finished "Launching the whole pipeline" in 58.2783 secs
2025-03-09 10:22:48: [retrieval_preprocessing] calculating distances ...
2025-03-09 10:22:48: [retrieval_preprocessing] finished and saved retrieval indices for episode 32802 [episode count 10/20]
[retrieval_preprocessing] for episode 53793 [episode count 11/20], we have num_retrieval=np.int64(4130) num_query=np.int64(400)
2025-03-09 10:22:48,970 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-09 10:22:49,435 [INFO]: Launching the whole pipeline 03/09/2025, 10:22:49
2025-03-09 10:22:49,435 [INFO]: Reading total number of vectors and dimension 03/09/2025, 10:22:49
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1530.77it/s]
2025-03-09 10:22:49,461 [INFO]: There are 4130 embeddings of dim 49152
2025-03-09 10:22:49,462 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0268 secs
2025-03-09 10:22:49,462 [INFO]: 	Compute estimated construction time of the index 03/09/2025, 10:22:49
2025-03-09 10:22:49,462 [INFO]: 		-> Train: 16.7 minutes
2025-03-09 10:22:49,462 [INFO]: 		-> Add: 2.3 seconds
2025-03-09 10:22:49,462 [INFO]: 		Total: 16.7 minutes
2025-03-09 10:22:49,462 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0001 secs
2025-03-09 10:22:49,462 [INFO]: 	Checking that your have enough memory available to create the index 03/09/2025, 10:22:49
2025-03-09 10:22:49,462 [INFO]: 852.3MB of memory will be needed to build the index (more might be used if you have more)
2025-03-09 10:22:49,462 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0002 secs
2025-03-09 10:22:49,462 [INFO]: 	Selecting most promising index types given data characteristics 03/09/2025, 10:22:49
2025-03-09 10:22:49,462 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-09 10:22:49,462 [INFO]: 	Creating the index 03/09/2025, 10:22:49
2025-03-09 10:22:49,462 [INFO]: 		-> Instanciate the index HNSW15 03/09/2025, 10:22:49
2025-03-09 10:22:49,464 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0013 secs
2025-03-09 10:22:49,464 [INFO]: 		-> Adding the vectors to the index 03/09/2025, 10:22:49
2025-03-09 10:22:49,464 [INFO]: The memory available for adding the vectors is 49.2GB(total available - used by the index)
2025-03-09 10:22:49,464 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/17 [00:00<?, ?it/s] 12%|█▏        | 2/17 [00:00<00:00, 19.22it/s] 47%|████▋     | 8/17 [00:00<00:00, 42.31it/s] 82%|████████▏ | 14/17 [00:00<00:00, 49.77it/s]100%|██████████| 17/17 [00:03<00:00,  5.58it/s]
2025-03-09 10:22:52,512 [INFO]: 	Computing best hyperparameters for index knn.index 03/09/2025, 10:22:52
2025-03-09 10:23:28,564 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 36.0521 secs
2025-03-09 10:23:28,564 [INFO]: The best hyperparameters are: efSearch=278
2025-03-09 10:23:28,565 [INFO]: 	Compute fast metrics 03/09/2025, 10:23:28
  0%|          | 0/4 [00:00<?, ?it/s] 75%|███████▌  | 3/4 [00:00<00:00, 26.10it/s] 75%|███████▌  | 3/4 [00:00<00:00, 22.79it/s]
2025-03-09 10:23:41,137 [INFO]: 	>>> Finished "Compute fast metrics" in 12.5719 secs
2025-03-09 10:23:41,139 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 51.6748 secs
2025-03-09 10:23:41,139 [INFO]: {
2025-03-09 10:23:41,139 [INFO]: 	index_key: HNSW15
2025-03-09 10:23:41,139 [INFO]: 	index_param: efSearch=278
2025-03-09 10:23:41,139 [INFO]: 	index_path: knn.index
2025-03-09 10:23:41,139 [INFO]: 	size in bytes: 812552830
2025-03-09 10:23:41,139 [INFO]: 	avg_search_speed_ms: 9.137516355218544
2025-03-09 10:23:41,139 [INFO]: 	99p_search_speed_ms: 12.52085562329738
2025-03-09 10:23:41,139 [INFO]: 	reconstruction error %: 0.0
2025-03-09 10:23:41,139 [INFO]: 	nb vectors: 4130
2025-03-09 10:23:41,139 [INFO]: 	vectors dimension: 49152
2025-03-09 10:23:41,139 [INFO]: 	compression ratio: 0.9993086111090155
2025-03-09 10:23:41,139 [INFO]: }
2025-03-09 10:23:41,139 [INFO]: 	>>> Finished "Creating the index" in 51.6766 secs
2025-03-09 10:23:41,139 [INFO]: >>> Finished "Launching the whole pipeline" in 51.7041 secs
2025-03-09 10:23:43: [retrieval_preprocessing] calculating distances ...
2025-03-09 10:23:44: [retrieval_preprocessing] finished and saved retrieval indices for episode 53793 [episode count 11/20]
[retrieval_preprocessing] for episode 49700 [episode count 12/20], we have num_retrieval=np.int64(4387) num_query=np.int64(143)
2025-03-09 10:23:44,959 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-09 10:23:45,446 [INFO]: Launching the whole pipeline 03/09/2025, 10:23:45
2025-03-09 10:23:45,446 [INFO]: Reading total number of vectors and dimension 03/09/2025, 10:23:45
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1944.51it/s]
2025-03-09 10:23:45,470 [INFO]: There are 4387 embeddings of dim 49152
2025-03-09 10:23:45,470 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0239 secs
2025-03-09 10:23:45,470 [INFO]: 	Compute estimated construction time of the index 03/09/2025, 10:23:45
2025-03-09 10:23:45,470 [INFO]: 		-> Train: 16.7 minutes
2025-03-09 10:23:45,470 [INFO]: 		-> Add: 2.4 seconds
2025-03-09 10:23:45,470 [INFO]: 		Total: 16.7 minutes
2025-03-09 10:23:45,471 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0001 secs
2025-03-09 10:23:45,471 [INFO]: 	Checking that your have enough memory available to create the index 03/09/2025, 10:23:45
2025-03-09 10:23:45,471 [INFO]: 905.4MB of memory will be needed to build the index (more might be used if you have more)
2025-03-09 10:23:45,471 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0001 secs
2025-03-09 10:23:45,471 [INFO]: 	Selecting most promising index types given data characteristics 03/09/2025, 10:23:45
2025-03-09 10:23:45,471 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-09 10:23:45,471 [INFO]: 	Creating the index 03/09/2025, 10:23:45
2025-03-09 10:23:45,471 [INFO]: 		-> Instanciate the index HNSW15 03/09/2025, 10:23:45
2025-03-09 10:23:45,472 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0008 secs
2025-03-09 10:23:45,472 [INFO]: 		-> Adding the vectors to the index 03/09/2025, 10:23:45
2025-03-09 10:23:45,472 [INFO]: The memory available for adding the vectors is 49.2GB(total available - used by the index)
2025-03-09 10:23:45,472 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/18 [00:00<?, ?it/s] 17%|█▋        | 3/18 [00:00<00:00, 26.73it/s] 56%|█████▌    | 10/18 [00:00<00:00, 49.43it/s] 94%|█████████▍| 17/18 [00:00<00:00, 57.17it/s]100%|██████████| 18/18 [00:02<00:00,  6.03it/s]
2025-03-09 10:23:48,818 [INFO]: 	Computing best hyperparameters for index knn.index 03/09/2025, 10:23:48
2025-03-09 10:24:22,340 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 33.5209 secs
2025-03-09 10:24:22,340 [INFO]: The best hyperparameters are: efSearch=276
2025-03-09 10:24:22,340 [INFO]: 	Compute fast metrics 03/09/2025, 10:24:22
  0%|          | 0/4 [00:00<?, ?it/s] 75%|███████▌  | 3/4 [00:00<00:00, 25.64it/s] 75%|███████▌  | 3/4 [00:00<00:00, 21.88it/s]
2025-03-09 10:24:38,204 [INFO]: 	>>> Finished "Compute fast metrics" in 15.8639 secs
2025-03-09 10:24:38,207 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 52.7350 secs
2025-03-09 10:24:38,207 [INFO]: {
2025-03-09 10:24:38,207 [INFO]: 	index_key: HNSW15
2025-03-09 10:24:38,207 [INFO]: 	index_param: efSearch=276
2025-03-09 10:24:38,207 [INFO]: 	index_path: knn.index
2025-03-09 10:24:38,207 [INFO]: 	size in bytes: 863116030
2025-03-09 10:24:38,207 [INFO]: 	avg_search_speed_ms: 9.883343306988507
2025-03-09 10:24:38,207 [INFO]: 	99p_search_speed_ms: 21.7607674957253
2025-03-09 10:24:38,207 [INFO]: 	reconstruction error %: 0.0
2025-03-09 10:24:38,207 [INFO]: 	nb vectors: 4387
2025-03-09 10:24:38,207 [INFO]: 	vectors dimension: 49152
2025-03-09 10:24:38,207 [INFO]: 	compression ratio: 0.9993086282964759
2025-03-09 10:24:38,207 [INFO]: }
2025-03-09 10:24:38,207 [INFO]: 	>>> Finished "Creating the index" in 52.7363 secs
2025-03-09 10:24:38,207 [INFO]: >>> Finished "Launching the whole pipeline" in 52.7607 secs
2025-03-09 10:24:39: [retrieval_preprocessing] calculating distances ...
2025-03-09 10:24:39: [retrieval_preprocessing] finished and saved retrieval indices for episode 49700 [episode count 12/20]
[retrieval_preprocessing] for episode 52773 [episode count 13/20], we have num_retrieval=np.int64(4353) num_query=np.int64(177)
2025-03-09 10:24:40,167 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-09 10:24:40,815 [INFO]: Launching the whole pipeline 03/09/2025, 10:24:40
2025-03-09 10:24:40,815 [INFO]: Reading total number of vectors and dimension 03/09/2025, 10:24:40
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1714.76it/s]
2025-03-09 10:24:40,842 [INFO]: There are 4353 embeddings of dim 49152
2025-03-09 10:24:40,842 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0277 secs
2025-03-09 10:24:40,843 [INFO]: 	Compute estimated construction time of the index 03/09/2025, 10:24:40
2025-03-09 10:24:40,843 [INFO]: 		-> Train: 16.7 minutes
2025-03-09 10:24:40,843 [INFO]: 		-> Add: 2.4 seconds
2025-03-09 10:24:40,843 [INFO]: 		Total: 16.7 minutes
2025-03-09 10:24:40,843 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0001 secs
2025-03-09 10:24:40,843 [INFO]: 	Checking that your have enough memory available to create the index 03/09/2025, 10:24:40
2025-03-09 10:24:40,843 [INFO]: 898.4MB of memory will be needed to build the index (more might be used if you have more)
2025-03-09 10:24:40,843 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0002 secs
2025-03-09 10:24:40,843 [INFO]: 	Selecting most promising index types given data characteristics 03/09/2025, 10:24:40
2025-03-09 10:24:40,843 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-09 10:24:40,843 [INFO]: 	Creating the index 03/09/2025, 10:24:40
2025-03-09 10:24:40,843 [INFO]: 		-> Instanciate the index HNSW15 03/09/2025, 10:24:40
2025-03-09 10:24:40,844 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0010 secs
2025-03-09 10:24:40,844 [INFO]: 		-> Adding the vectors to the index 03/09/2025, 10:24:40
2025-03-09 10:24:40,844 [INFO]: The memory available for adding the vectors is 49.2GB(total available - used by the index)
2025-03-09 10:24:40,844 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/18 [00:00<?, ?it/s]  6%|▌         | 1/18 [00:00<00:02,  7.95it/s] 39%|███▉      | 7/18 [00:00<00:00, 34.42it/s] 72%|███████▏  | 13/18 [00:00<00:00, 44.29it/s]100%|██████████| 18/18 [00:03<00:00,  4.10it/s]100%|██████████| 18/18 [00:03<00:00,  5.60it/s]
2025-03-09 10:24:44,065 [INFO]: 	Computing best hyperparameters for index knn.index 03/09/2025, 10:24:44
2025-03-09 10:25:24,624 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 40.5589 secs
2025-03-09 10:25:24,624 [INFO]: The best hyperparameters are: efSearch=262
2025-03-09 10:25:24,624 [INFO]: 	Compute fast metrics 03/09/2025, 10:25:24
  0%|          | 0/4 [00:00<?, ?it/s] 75%|███████▌  | 3/4 [00:00<00:00, 25.87it/s] 75%|███████▌  | 3/4 [00:00<00:00, 22.40it/s]
2025-03-09 10:25:39,465 [INFO]: 	>>> Finished "Compute fast metrics" in 14.8404 secs
2025-03-09 10:25:39,467 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 58.6225 secs
2025-03-09 10:25:39,467 [INFO]: {
2025-03-09 10:25:39,467 [INFO]: 	index_key: HNSW15
2025-03-09 10:25:39,467 [INFO]: 	index_param: efSearch=262
2025-03-09 10:25:39,467 [INFO]: 	index_path: knn.index
2025-03-09 10:25:39,467 [INFO]: 	size in bytes: 856426810
2025-03-09 10:25:39,467 [INFO]: 	avg_search_speed_ms: 9.813679801939939
2025-03-09 10:25:39,467 [INFO]: 	99p_search_speed_ms: 17.542283893562846
2025-03-09 10:25:39,467 [INFO]: 	reconstruction error %: 0.0
2025-03-09 10:25:39,467 [INFO]: 	nb vectors: 4353
2025-03-09 10:25:39,467 [INFO]: 	vectors dimension: 49152
2025-03-09 10:25:39,467 [INFO]: 	compression ratio: 0.9993085386946259
2025-03-09 10:25:39,467 [INFO]: }
2025-03-09 10:25:39,467 [INFO]: 	>>> Finished "Creating the index" in 58.6240 secs
2025-03-09 10:25:39,467 [INFO]: >>> Finished "Launching the whole pipeline" in 58.6524 secs
2025-03-09 10:25:40: [retrieval_preprocessing] calculating distances ...
2025-03-09 10:25:41: [retrieval_preprocessing] finished and saved retrieval indices for episode 52773 [episode count 13/20]
[retrieval_preprocessing] for episode 51750 [episode count 14/20], we have num_retrieval=np.int64(4365) num_query=np.int64(165)
2025-03-09 10:25:41,418 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-09 10:25:41,928 [INFO]: Launching the whole pipeline 03/09/2025, 10:25:41
2025-03-09 10:25:41,928 [INFO]: Reading total number of vectors and dimension 03/09/2025, 10:25:41
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1491.57it/s]
2025-03-09 10:25:41,954 [INFO]: There are 4365 embeddings of dim 49152
2025-03-09 10:25:41,954 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0254 secs
2025-03-09 10:25:41,954 [INFO]: 	Compute estimated construction time of the index 03/09/2025, 10:25:41
2025-03-09 10:25:41,954 [INFO]: 		-> Train: 16.7 minutes
2025-03-09 10:25:41,954 [INFO]: 		-> Add: 2.4 seconds
2025-03-09 10:25:41,954 [INFO]: 		Total: 16.7 minutes
2025-03-09 10:25:41,954 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0001 secs
2025-03-09 10:25:41,954 [INFO]: 	Checking that your have enough memory available to create the index 03/09/2025, 10:25:41
2025-03-09 10:25:41,954 [INFO]: 900.8MB of memory will be needed to build the index (more might be used if you have more)
2025-03-09 10:25:41,954 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0002 secs
2025-03-09 10:25:41,954 [INFO]: 	Selecting most promising index types given data characteristics 03/09/2025, 10:25:41
2025-03-09 10:25:41,954 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-09 10:25:41,954 [INFO]: 	Creating the index 03/09/2025, 10:25:41
2025-03-09 10:25:41,954 [INFO]: 		-> Instanciate the index HNSW15 03/09/2025, 10:25:41
2025-03-09 10:25:41,956 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0011 secs
2025-03-09 10:25:41,956 [INFO]: 		-> Adding the vectors to the index 03/09/2025, 10:25:41
2025-03-09 10:25:41,956 [INFO]: The memory available for adding the vectors is 49.2GB(total available - used by the index)
2025-03-09 10:25:41,956 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/18 [00:00<?, ?it/s]  6%|▌         | 1/18 [00:00<00:01,  9.24it/s] 44%|████▍     | 8/18 [00:00<00:00, 41.16it/s] 83%|████████▎ | 15/18 [00:00<00:00, 51.58it/s]100%|██████████| 18/18 [00:03<00:00,  5.60it/s]
2025-03-09 10:25:45,172 [INFO]: 	Computing best hyperparameters for index knn.index 03/09/2025, 10:25:45
2025-03-09 10:26:28,953 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 43.7806 secs
2025-03-09 10:26:28,953 [INFO]: The best hyperparameters are: efSearch=233
2025-03-09 10:26:28,953 [INFO]: 	Compute fast metrics 03/09/2025, 10:26:28
  0%|          | 0/4 [00:00<?, ?it/s] 75%|███████▌  | 3/4 [00:00<00:00, 25.89it/s] 75%|███████▌  | 3/4 [00:00<00:00, 22.59it/s]
2025-03-09 10:26:42,899 [INFO]: 	>>> Finished "Compute fast metrics" in 13.9457 secs
2025-03-09 10:26:42,901 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 60.9456 secs
2025-03-09 10:26:42,902 [INFO]: {
2025-03-09 10:26:42,902 [INFO]: 	index_key: HNSW15
2025-03-09 10:26:42,902 [INFO]: 	index_param: efSearch=233
2025-03-09 10:26:42,902 [INFO]: 	index_path: knn.index
2025-03-09 10:26:42,902 [INFO]: 	size in bytes: 858787690
2025-03-09 10:26:42,902 [INFO]: 	avg_search_speed_ms: 8.55096187800742
2025-03-09 10:26:42,902 [INFO]: 	99p_search_speed_ms: 17.959865536540747
2025-03-09 10:26:42,902 [INFO]: 	reconstruction error %: 0.0
2025-03-09 10:26:42,902 [INFO]: 	nb vectors: 4365
2025-03-09 10:26:42,902 [INFO]: 	vectors dimension: 49152
2025-03-09 10:26:42,902 [INFO]: 	compression ratio: 0.9993085951197088
2025-03-09 10:26:42,902 [INFO]: }
2025-03-09 10:26:42,902 [INFO]: 	>>> Finished "Creating the index" in 60.9473 secs
2025-03-09 10:26:42,902 [INFO]: >>> Finished "Launching the whole pipeline" in 60.9733 secs
2025-03-09 10:26:43: [retrieval_preprocessing] calculating distances ...
2025-03-09 10:26:44: [retrieval_preprocessing] finished and saved retrieval indices for episode 51750 [episode count 14/20]
[retrieval_preprocessing] for episode 6183 [episode count 15/20], we have num_retrieval=np.int64(4054) num_query=np.int64(476)
2025-03-09 10:26:44,507 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-09 10:26:44,960 [INFO]: Launching the whole pipeline 03/09/2025, 10:26:44
2025-03-09 10:26:44,960 [INFO]: Reading total number of vectors and dimension 03/09/2025, 10:26:44
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1407.01it/s]
2025-03-09 10:26:44,983 [INFO]: There are 4054 embeddings of dim 49152
2025-03-09 10:26:44,984 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0237 secs
2025-03-09 10:26:44,984 [INFO]: 	Compute estimated construction time of the index 03/09/2025, 10:26:44
2025-03-09 10:26:44,984 [INFO]: 		-> Train: 16.7 minutes
2025-03-09 10:26:44,984 [INFO]: 		-> Add: 2.2 seconds
2025-03-09 10:26:44,984 [INFO]: 		Total: 16.7 minutes
2025-03-09 10:26:44,984 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0001 secs
2025-03-09 10:26:44,984 [INFO]: 	Checking that your have enough memory available to create the index 03/09/2025, 10:26:44
2025-03-09 10:26:44,984 [INFO]: 836.6MB of memory will be needed to build the index (more might be used if you have more)
2025-03-09 10:26:44,984 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0001 secs
2025-03-09 10:26:44,984 [INFO]: 	Selecting most promising index types given data characteristics 03/09/2025, 10:26:44
2025-03-09 10:26:44,984 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-09 10:26:44,984 [INFO]: 	Creating the index 03/09/2025, 10:26:44
2025-03-09 10:26:44,984 [INFO]: 		-> Instanciate the index HNSW15 03/09/2025, 10:26:44
2025-03-09 10:26:44,985 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0010 secs
2025-03-09 10:26:44,985 [INFO]: 		-> Adding the vectors to the index 03/09/2025, 10:26:44
2025-03-09 10:26:44,985 [INFO]: The memory available for adding the vectors is 49.3GB(total available - used by the index)
2025-03-09 10:26:44,985 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/16 [00:00<?, ?it/s]  6%|▋         | 1/16 [00:00<00:01,  7.69it/s] 44%|████▍     | 7/16 [00:00<00:00, 34.14it/s] 81%|████████▏ | 13/16 [00:00<00:00, 44.45it/s]100%|██████████| 16/16 [00:03<00:00,  5.33it/s]
2025-03-09 10:26:47,989 [INFO]: 	Computing best hyperparameters for index knn.index 03/09/2025, 10:26:47
2025-03-09 10:27:26,116 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 38.1264 secs
2025-03-09 10:27:26,116 [INFO]: The best hyperparameters are: efSearch=264
2025-03-09 10:27:26,116 [INFO]: 	Compute fast metrics 03/09/2025, 10:27:26
  0%|          | 0/4 [00:00<?, ?it/s] 75%|███████▌  | 3/4 [00:00<00:00, 27.23it/s] 75%|███████▌  | 3/4 [00:00<00:00, 23.83it/s]
2025-03-09 10:27:38,430 [INFO]: 	>>> Finished "Compute fast metrics" in 12.3138 secs
2025-03-09 10:27:38,432 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 53.4469 secs
2025-03-09 10:27:38,432 [INFO]: {
2025-03-09 10:27:38,432 [INFO]: 	index_key: HNSW15
2025-03-09 10:27:38,432 [INFO]: 	index_param: efSearch=264
2025-03-09 10:27:38,432 [INFO]: 	index_path: knn.index
2025-03-09 10:27:38,432 [INFO]: 	size in bytes: 797600290
2025-03-09 10:27:38,432 [INFO]: 	avg_search_speed_ms: 9.1364677806202
2025-03-09 10:27:38,432 [INFO]: 	99p_search_speed_ms: 13.46655323635786
2025-03-09 10:27:38,432 [INFO]: 	reconstruction error %: 0.0
2025-03-09 10:27:38,432 [INFO]: 	nb vectors: 4054
2025-03-09 10:27:38,432 [INFO]: 	vectors dimension: 49152
2025-03-09 10:27:38,432 [INFO]: 	compression ratio: 0.9993086035613151
2025-03-09 10:27:38,432 [INFO]: }
2025-03-09 10:27:38,432 [INFO]: 	>>> Finished "Creating the index" in 53.4483 secs
2025-03-09 10:27:38,432 [INFO]: >>> Finished "Launching the whole pipeline" in 53.4726 secs
2025-03-09 10:27:41: [retrieval_preprocessing] calculating distances ...
2025-03-09 10:27:43: [retrieval_preprocessing] finished and saved retrieval indices for episode 6183 [episode count 15/20]
[retrieval_preprocessing] for episode 23080 [episode count 16/20], we have num_retrieval=np.int64(4374) num_query=np.int64(156)
2025-03-09 10:27:43,778 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-09 10:27:44,435 [INFO]: Launching the whole pipeline 03/09/2025, 10:27:44
2025-03-09 10:27:44,435 [INFO]: Reading total number of vectors and dimension 03/09/2025, 10:27:44
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1411.75it/s]
2025-03-09 10:27:44,464 [INFO]: There are 4374 embeddings of dim 49152
2025-03-09 10:27:44,464 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0290 secs
2025-03-09 10:27:44,465 [INFO]: 	Compute estimated construction time of the index 03/09/2025, 10:27:44
2025-03-09 10:27:44,465 [INFO]: 		-> Train: 16.7 minutes
2025-03-09 10:27:44,465 [INFO]: 		-> Add: 2.4 seconds
2025-03-09 10:27:44,465 [INFO]: 		Total: 16.7 minutes
2025-03-09 10:27:44,465 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0003 secs
2025-03-09 10:27:44,465 [INFO]: 	Checking that your have enough memory available to create the index 03/09/2025, 10:27:44
2025-03-09 10:27:44,465 [INFO]: 902.7MB of memory will be needed to build the index (more might be used if you have more)
2025-03-09 10:27:44,465 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0004 secs
2025-03-09 10:27:44,466 [INFO]: 	Selecting most promising index types given data characteristics 03/09/2025, 10:27:44
2025-03-09 10:27:44,466 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-09 10:27:44,466 [INFO]: 	Creating the index 03/09/2025, 10:27:44
2025-03-09 10:27:44,466 [INFO]: 		-> Instanciate the index HNSW15 03/09/2025, 10:27:44
2025-03-09 10:27:44,469 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0025 secs
2025-03-09 10:27:44,469 [INFO]: 		-> Adding the vectors to the index 03/09/2025, 10:27:44
2025-03-09 10:27:44,469 [INFO]: The memory available for adding the vectors is 49.2GB(total available - used by the index)
2025-03-09 10:27:44,469 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/18 [00:00<?, ?it/s] 17%|█▋        | 3/18 [00:00<00:00, 26.12it/s] 50%|█████     | 9/18 [00:00<00:00, 43.70it/s] 83%|████████▎ | 15/18 [00:00<00:00, 50.55it/s]100%|██████████| 18/18 [00:03<00:00,  5.97it/s]
2025-03-09 10:27:47,488 [INFO]: 	Computing best hyperparameters for index knn.index 03/09/2025, 10:27:47
2025-03-09 10:28:26,324 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 38.8361 secs
2025-03-09 10:28:26,325 [INFO]: The best hyperparameters are: efSearch=264
2025-03-09 10:28:26,325 [INFO]: 	Compute fast metrics 03/09/2025, 10:28:26
  0%|          | 0/4 [00:00<?, ?it/s] 75%|███████▌  | 3/4 [00:00<00:00, 27.78it/s] 75%|███████▌  | 3/4 [00:00<00:00, 24.27it/s]
2025-03-09 10:28:41,222 [INFO]: 	>>> Finished "Compute fast metrics" in 14.8969 secs
2025-03-09 10:28:41,224 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 56.7547 secs
2025-03-09 10:28:41,224 [INFO]: {
2025-03-09 10:28:41,224 [INFO]: 	index_key: HNSW15
2025-03-09 10:28:41,224 [INFO]: 	index_param: efSearch=264
2025-03-09 10:28:41,224 [INFO]: 	index_path: knn.index
2025-03-09 10:28:41,224 [INFO]: 	size in bytes: 860558350
2025-03-09 10:28:41,224 [INFO]: 	avg_search_speed_ms: 8.788895321664562
2025-03-09 10:28:41,224 [INFO]: 	99p_search_speed_ms: 14.505526300054024
2025-03-09 10:28:41,224 [INFO]: 	reconstruction error %: 0.0
2025-03-09 10:28:41,224 [INFO]: 	nb vectors: 4374
2025-03-09 10:28:41,224 [INFO]: 	vectors dimension: 49152
2025-03-09 10:28:41,224 [INFO]: 	compression ratio: 0.9993086372353485
2025-03-09 10:28:41,224 [INFO]: }
2025-03-09 10:28:41,224 [INFO]: 	>>> Finished "Creating the index" in 56.7580 secs
2025-03-09 10:28:41,224 [INFO]: >>> Finished "Launching the whole pipeline" in 56.7888 secs
2025-03-09 10:28:42: [retrieval_preprocessing] calculating distances ...
2025-03-09 10:28:42: [retrieval_preprocessing] finished and saved retrieval indices for episode 23080 [episode count 16/20]
[retrieval_preprocessing] for episode 1577 [episode count 17/20], we have num_retrieval=np.int64(4414) num_query=np.int64(116)
2025-03-09 10:28:42,881 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-09 10:28:43,364 [INFO]: Launching the whole pipeline 03/09/2025, 10:28:43
2025-03-09 10:28:43,364 [INFO]: Reading total number of vectors and dimension 03/09/2025, 10:28:43
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1898.73it/s]
2025-03-09 10:28:43,388 [INFO]: There are 4414 embeddings of dim 49152
2025-03-09 10:28:43,389 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0242 secs
2025-03-09 10:28:43,389 [INFO]: 	Compute estimated construction time of the index 03/09/2025, 10:28:43
2025-03-09 10:28:43,389 [INFO]: 		-> Train: 16.7 minutes
2025-03-09 10:28:43,389 [INFO]: 		-> Add: 2.4 seconds
2025-03-09 10:28:43,389 [INFO]: 		Total: 16.7 minutes
2025-03-09 10:28:43,389 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0001 secs
2025-03-09 10:28:43,389 [INFO]: 	Checking that your have enough memory available to create the index 03/09/2025, 10:28:43
2025-03-09 10:28:43,389 [INFO]: 910.9MB of memory will be needed to build the index (more might be used if you have more)
2025-03-09 10:28:43,389 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0001 secs
2025-03-09 10:28:43,389 [INFO]: 	Selecting most promising index types given data characteristics 03/09/2025, 10:28:43
2025-03-09 10:28:43,389 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-09 10:28:43,389 [INFO]: 	Creating the index 03/09/2025, 10:28:43
2025-03-09 10:28:43,389 [INFO]: 		-> Instanciate the index HNSW15 03/09/2025, 10:28:43
2025-03-09 10:28:43,390 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0009 secs
2025-03-09 10:28:43,390 [INFO]: 		-> Adding the vectors to the index 03/09/2025, 10:28:43
2025-03-09 10:28:43,390 [INFO]: The memory available for adding the vectors is 49.2GB(total available - used by the index)
2025-03-09 10:28:43,390 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/18 [00:00<?, ?it/s] 11%|█         | 2/18 [00:00<00:00, 19.28it/s] 44%|████▍     | 8/18 [00:00<00:00, 41.29it/s] 78%|███████▊  | 14/18 [00:00<00:00, 49.00it/s]100%|██████████| 18/18 [00:03<00:00,  5.78it/s]
2025-03-09 10:28:46,505 [INFO]: 	Computing best hyperparameters for index knn.index 03/09/2025, 10:28:46
2025-03-09 10:29:25,422 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 38.9176 secs
2025-03-09 10:29:25,423 [INFO]: The best hyperparameters are: efSearch=256
2025-03-09 10:29:25,423 [INFO]: 	Compute fast metrics 03/09/2025, 10:29:25
  0%|          | 0/4 [00:00<?, ?it/s] 50%|█████     | 2/4 [00:00<00:00, 16.75it/s] 75%|███████▌  | 3/4 [00:00<00:00, 18.75it/s]
2025-03-09 10:29:39,171 [INFO]: 	>>> Finished "Compute fast metrics" in 13.7484 secs
2025-03-09 10:29:39,173 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 55.7832 secs
2025-03-09 10:29:39,173 [INFO]: {
2025-03-09 10:29:39,173 [INFO]: 	index_key: HNSW15
2025-03-09 10:29:39,173 [INFO]: 	index_param: efSearch=256
2025-03-09 10:29:39,173 [INFO]: 	index_path: knn.index
2025-03-09 10:29:39,173 [INFO]: 	size in bytes: 868428190
2025-03-09 10:29:39,173 [INFO]: 	avg_search_speed_ms: 8.81295592876947
2025-03-09 10:29:39,173 [INFO]: 	99p_search_speed_ms: 13.188149449415508
2025-03-09 10:29:39,174 [INFO]: 	reconstruction error %: 0.0
2025-03-09 10:29:39,174 [INFO]: 	nb vectors: 4414
2025-03-09 10:29:39,174 [INFO]: 	vectors dimension: 49152
2025-03-09 10:29:39,174 [INFO]: 	compression ratio: 0.9993085461677609
2025-03-09 10:29:39,174 [INFO]: }
2025-03-09 10:29:39,174 [INFO]: 	>>> Finished "Creating the index" in 55.7845 secs
2025-03-09 10:29:39,174 [INFO]: >>> Finished "Launching the whole pipeline" in 55.8092 secs
2025-03-09 10:29:39: [retrieval_preprocessing] calculating distances ...
2025-03-09 10:29:40: [retrieval_preprocessing] finished and saved retrieval indices for episode 1577 [episode count 17/20]
[retrieval_preprocessing] for episode 68651 [episode count 18/20], we have num_retrieval=np.int64(4378) num_query=np.int64(152)
2025-03-09 10:29:40,561 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-09 10:29:41,059 [INFO]: Launching the whole pipeline 03/09/2025, 10:29:41
2025-03-09 10:29:41,059 [INFO]: Reading total number of vectors and dimension 03/09/2025, 10:29:41
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 2261.08it/s]
2025-03-09 10:29:41,085 [INFO]: There are 4378 embeddings of dim 49152
2025-03-09 10:29:41,085 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0261 secs
2025-03-09 10:29:41,086 [INFO]: 	Compute estimated construction time of the index 03/09/2025, 10:29:41
2025-03-09 10:29:41,086 [INFO]: 		-> Train: 16.7 minutes
2025-03-09 10:29:41,086 [INFO]: 		-> Add: 2.4 seconds
2025-03-09 10:29:41,086 [INFO]: 		Total: 16.7 minutes
2025-03-09 10:29:41,086 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0004 secs
2025-03-09 10:29:41,086 [INFO]: 	Checking that your have enough memory available to create the index 03/09/2025, 10:29:41
2025-03-09 10:29:41,087 [INFO]: 903.5MB of memory will be needed to build the index (more might be used if you have more)
2025-03-09 10:29:41,087 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0004 secs
2025-03-09 10:29:41,087 [INFO]: 	Selecting most promising index types given data characteristics 03/09/2025, 10:29:41
2025-03-09 10:29:41,087 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-09 10:29:41,087 [INFO]: 	Creating the index 03/09/2025, 10:29:41
2025-03-09 10:29:41,087 [INFO]: 		-> Instanciate the index HNSW15 03/09/2025, 10:29:41
2025-03-09 10:29:41,090 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0024 secs
2025-03-09 10:29:41,090 [INFO]: 		-> Adding the vectors to the index 03/09/2025, 10:29:41
2025-03-09 10:29:41,090 [INFO]: The memory available for adding the vectors is 49.2GB(total available - used by the index)
2025-03-09 10:29:41,090 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/18 [00:00<?, ?it/s] 17%|█▋        | 3/18 [00:00<00:00, 29.34it/s] 56%|█████▌    | 10/18 [00:00<00:00, 51.28it/s] 94%|█████████▍| 17/18 [00:00<00:00, 56.51it/s]100%|██████████| 18/18 [00:03<00:00,  5.98it/s]
2025-03-09 10:29:44,105 [INFO]: 	Computing best hyperparameters for index knn.index 03/09/2025, 10:29:44
2025-03-09 10:30:24,297 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 40.1915 secs
2025-03-09 10:30:24,297 [INFO]: The best hyperparameters are: efSearch=271
2025-03-09 10:30:24,298 [INFO]: 	Compute fast metrics 03/09/2025, 10:30:24
  0%|          | 0/4 [00:00<?, ?it/s] 25%|██▌       | 1/4 [00:00<00:00,  8.63it/s] 50%|█████     | 2/4 [00:00<00:00,  9.30it/s] 75%|███████▌  | 3/4 [00:00<00:00,  7.56it/s]
2025-03-09 10:30:39,548 [INFO]: 	>>> Finished "Compute fast metrics" in 15.2499 secs
2025-03-09 10:30:39,550 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 58.4599 secs
2025-03-09 10:30:39,550 [INFO]: {
2025-03-09 10:30:39,550 [INFO]: 	index_key: HNSW15
2025-03-09 10:30:39,550 [INFO]: 	index_param: efSearch=271
2025-03-09 10:30:39,550 [INFO]: 	index_path: knn.index
2025-03-09 10:30:39,550 [INFO]: 	size in bytes: 861345370
2025-03-09 10:30:39,550 [INFO]: 	avg_search_speed_ms: 9.028930221860792
2025-03-09 10:30:39,550 [INFO]: 	99p_search_speed_ms: 13.058799747377645
2025-03-09 10:30:39,550 [INFO]: 	reconstruction error %: 0.0
2025-03-09 10:30:39,550 [INFO]: 	nb vectors: 4378
2025-03-09 10:30:39,550 [INFO]: 	vectors dimension: 49152
2025-03-09 10:30:39,550 [INFO]: 	compression ratio: 0.9993085862875191
2025-03-09 10:30:39,550 [INFO]: }
2025-03-09 10:30:39,550 [INFO]: 	>>> Finished "Creating the index" in 58.4631 secs
2025-03-09 10:30:39,550 [INFO]: >>> Finished "Launching the whole pipeline" in 58.4911 secs
2025-03-09 10:30:40: [retrieval_preprocessing] calculating distances ...
2025-03-09 10:30:41: [retrieval_preprocessing] finished and saved retrieval indices for episode 68651 [episode count 18/20]
[retrieval_preprocessing] for episode 7724 [episode count 19/20], we have num_retrieval=np.int64(4339) num_query=np.int64(191)
2025-03-09 10:30:42,360 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-09 10:30:42,873 [INFO]: Launching the whole pipeline 03/09/2025, 10:30:42
2025-03-09 10:30:42,873 [INFO]: Reading total number of vectors and dimension 03/09/2025, 10:30:42
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1776.49it/s]
2025-03-09 10:30:42,898 [INFO]: There are 4339 embeddings of dim 49152
2025-03-09 10:30:42,898 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0251 secs
2025-03-09 10:30:42,898 [INFO]: 	Compute estimated construction time of the index 03/09/2025, 10:30:42
2025-03-09 10:30:42,899 [INFO]: 		-> Train: 16.7 minutes
2025-03-09 10:30:42,899 [INFO]: 		-> Add: 2.4 seconds
2025-03-09 10:30:42,899 [INFO]: 		Total: 16.7 minutes
2025-03-09 10:30:42,899 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0001 secs
2025-03-09 10:30:42,899 [INFO]: 	Checking that your have enough memory available to create the index 03/09/2025, 10:30:42
2025-03-09 10:30:42,899 [INFO]: 895.5MB of memory will be needed to build the index (more might be used if you have more)
2025-03-09 10:30:42,899 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0003 secs
2025-03-09 10:30:42,899 [INFO]: 	Selecting most promising index types given data characteristics 03/09/2025, 10:30:42
2025-03-09 10:30:42,899 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-09 10:30:42,899 [INFO]: 	Creating the index 03/09/2025, 10:30:42
2025-03-09 10:30:42,899 [INFO]: 		-> Instanciate the index HNSW15 03/09/2025, 10:30:42
2025-03-09 10:30:42,900 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0010 secs
2025-03-09 10:30:42,900 [INFO]: 		-> Adding the vectors to the index 03/09/2025, 10:30:42
2025-03-09 10:30:42,900 [INFO]: The memory available for adding the vectors is 49.2GB(total available - used by the index)
2025-03-09 10:30:42,900 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/18 [00:00<?, ?it/s]  6%|▌         | 1/18 [00:00<00:03,  5.48it/s] 17%|█▋        | 3/18 [00:00<00:01,  8.37it/s] 44%|████▍     | 8/18 [00:00<00:00, 18.77it/s] 61%|██████    | 11/18 [00:00<00:00, 13.47it/s] 72%|███████▏  | 13/18 [00:01<00:00, 12.16it/s] 83%|████████▎ | 15/18 [00:01<00:00, 11.21it/s] 94%|█████████▍| 17/18 [00:01<00:00, 10.61it/s]100%|██████████| 18/18 [00:04<00:00,  4.15it/s]
2025-03-09 10:30:47,240 [INFO]: 	Computing best hyperparameters for index knn.index 03/09/2025, 10:30:47
2025-03-09 10:31:27,492 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 40.2510 secs
2025-03-09 10:31:27,493 [INFO]: The best hyperparameters are: efSearch=264
2025-03-09 10:31:27,493 [INFO]: 	Compute fast metrics 03/09/2025, 10:31:27
  0%|          | 0/4 [00:00<?, ?it/s] 25%|██▌       | 1/4 [00:00<00:00,  6.57it/s] 50%|█████     | 2/4 [00:00<00:00,  8.12it/s] 75%|███████▌  | 3/4 [00:00<00:00,  8.75it/s] 75%|███████▌  | 3/4 [00:00<00:00,  6.64it/s]
2025-03-09 10:31:42,478 [INFO]: 	>>> Finished "Compute fast metrics" in 14.9855 secs
2025-03-09 10:31:42,481 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 59.5805 secs
2025-03-09 10:31:42,481 [INFO]: {
2025-03-09 10:31:42,481 [INFO]: 	index_key: HNSW15
2025-03-09 10:31:42,481 [INFO]: 	index_param: efSearch=264
2025-03-09 10:31:42,481 [INFO]: 	index_path: knn.index
2025-03-09 10:31:42,481 [INFO]: 	size in bytes: 853672330
2025-03-09 10:31:42,481 [INFO]: 	avg_search_speed_ms: 9.296677018417094
2025-03-09 10:31:42,481 [INFO]: 	99p_search_speed_ms: 14.650989847723395
2025-03-09 10:31:42,481 [INFO]: 	reconstruction error %: 0.0
2025-03-09 10:31:42,481 [INFO]: 	nb vectors: 4339
2025-03-09 10:31:42,481 [INFO]: 	vectors dimension: 49152
2025-03-09 10:31:42,481 [INFO]: 	compression ratio: 0.9993086129428607
2025-03-09 10:31:42,481 [INFO]: }
2025-03-09 10:31:42,481 [INFO]: 	>>> Finished "Creating the index" in 59.5820 secs
2025-03-09 10:31:42,481 [INFO]: >>> Finished "Launching the whole pipeline" in 59.6078 secs
2025-03-09 10:31:43: [retrieval_preprocessing] calculating distances ...
2025-03-09 10:31:44: [retrieval_preprocessing] finished and saved retrieval indices for episode 7724 [episode count 19/20]
2025-03-09 10:31:44: [retrieval_preprocessing] finished for (4823049285, 'bottle') [chosen_id count 8/10]
2025-03-09 10:31:46: [retrieval_preprocessing] concatenated all embeddings and indices for 20 episodes for (9130122211, 'marker') [chosen_id count 9/10]
2025-03-09 10:31:46: [retrieval_preprocessing] we have num_total=3598 embedding_dim=49152
[retrieval_preprocessing] for episode 59906 [episode count 0/20], we have num_retrieval=np.int64(3411) num_query=np.int64(187)
2025-03-09 10:31:47,651 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-09 10:31:48,222 [INFO]: Launching the whole pipeline 03/09/2025, 10:31:48
2025-03-09 10:31:48,222 [INFO]: Reading total number of vectors and dimension 03/09/2025, 10:31:48
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1728.90it/s]
2025-03-09 10:31:48,254 [INFO]: There are 3411 embeddings of dim 49152
2025-03-09 10:31:48,254 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0319 secs
2025-03-09 10:31:48,254 [INFO]: 	Compute estimated construction time of the index 03/09/2025, 10:31:48
2025-03-09 10:31:48,254 [INFO]: 		-> Train: 16.7 minutes
2025-03-09 10:31:48,254 [INFO]: 		-> Add: 1.9 seconds
2025-03-09 10:31:48,254 [INFO]: 		Total: 16.7 minutes
2025-03-09 10:31:48,255 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0002 secs
2025-03-09 10:31:48,255 [INFO]: 	Checking that your have enough memory available to create the index 03/09/2025, 10:31:48
2025-03-09 10:31:48,255 [INFO]: 703.9MB of memory will be needed to build the index (more might be used if you have more)
2025-03-09 10:31:48,255 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0003 secs
2025-03-09 10:31:48,255 [INFO]: 	Selecting most promising index types given data characteristics 03/09/2025, 10:31:48
2025-03-09 10:31:48,255 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-09 10:31:48,255 [INFO]: 	Creating the index 03/09/2025, 10:31:48
2025-03-09 10:31:48,255 [INFO]: 		-> Instanciate the index HNSW15 03/09/2025, 10:31:48
2025-03-09 10:31:48,256 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0013 secs
2025-03-09 10:31:48,257 [INFO]: 		-> Adding the vectors to the index 03/09/2025, 10:31:48
2025-03-09 10:31:48,257 [INFO]: The memory available for adding the vectors is 49.4GB(total available - used by the index)
2025-03-09 10:31:48,257 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/14 [00:00<?, ?it/s]  7%|▋         | 1/14 [00:00<00:01,  7.41it/s] 21%|██▏       | 3/14 [00:00<00:00, 11.33it/s] 36%|███▌      | 5/14 [00:00<00:00, 12.31it/s] 50%|█████     | 7/14 [00:00<00:00, 12.75it/s] 64%|██████▍   | 9/14 [00:00<00:00, 13.11it/s] 79%|███████▊  | 11/14 [00:00<00:00, 13.15it/s] 93%|█████████▎| 13/14 [00:01<00:00, 13.25it/s]100%|██████████| 14/14 [00:03<00:00,  4.47it/s]
2025-03-09 10:31:51,389 [INFO]: 	Computing best hyperparameters for index knn.index 03/09/2025, 10:31:51
2025-03-09 10:32:29,920 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 38.5312 secs
2025-03-09 10:32:29,921 [INFO]: The best hyperparameters are: efSearch=287
2025-03-09 10:32:29,921 [INFO]: 	Compute fast metrics 03/09/2025, 10:32:29
  0%|          | 0/4 [00:00<?, ?it/s] 50%|█████     | 2/4 [00:00<00:00, 19.03it/s] 75%|███████▌  | 3/4 [00:00<00:00, 21.21it/s]
2025-03-09 10:32:43,583 [INFO]: 	>>> Finished "Compute fast metrics" in 13.6616 secs
2025-03-09 10:32:43,585 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 55.3284 secs
2025-03-09 10:32:43,585 [INFO]: {
2025-03-09 10:32:43,585 [INFO]: 	index_key: HNSW15
2025-03-09 10:32:43,585 [INFO]: 	index_param: efSearch=287
2025-03-09 10:32:43,585 [INFO]: 	index_path: knn.index
2025-03-09 10:32:43,585 [INFO]: 	size in bytes: 671093410
2025-03-09 10:32:43,585 [INFO]: 	avg_search_speed_ms: 11.68479034149471
2025-03-09 10:32:43,585 [INFO]: 	99p_search_speed_ms: 25.549197010695966
2025-03-09 10:32:43,585 [INFO]: 	reconstruction error %: 0.0
2025-03-09 10:32:43,585 [INFO]: 	nb vectors: 3411
2025-03-09 10:32:43,585 [INFO]: 	vectors dimension: 49152
2025-03-09 10:32:43,585 [INFO]: 	compression ratio: 0.9993093033054817
2025-03-09 10:32:43,585 [INFO]: }
2025-03-09 10:32:43,585 [INFO]: 	>>> Finished "Creating the index" in 55.3301 secs
2025-03-09 10:32:43,585 [INFO]: >>> Finished "Launching the whole pipeline" in 55.3630 secs
2025-03-09 10:32:44: [retrieval_preprocessing] calculating distances ...
2025-03-09 10:32:45: [retrieval_preprocessing] finished and saved retrieval indices for episode 59906 [episode count 0/20]
[retrieval_preprocessing] for episode 26629 [episode count 1/20], we have num_retrieval=np.int64(3416) num_query=np.int64(182)
2025-03-09 10:32:45,595 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-09 10:32:45,977 [INFO]: Launching the whole pipeline 03/09/2025, 10:32:45
2025-03-09 10:32:45,978 [INFO]: Reading total number of vectors and dimension 03/09/2025, 10:32:45
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1805.55it/s]
2025-03-09 10:32:46,004 [INFO]: There are 3416 embeddings of dim 49152
2025-03-09 10:32:46,005 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0269 secs
2025-03-09 10:32:46,005 [INFO]: 	Compute estimated construction time of the index 03/09/2025, 10:32:46
2025-03-09 10:32:46,005 [INFO]: 		-> Train: 16.7 minutes
2025-03-09 10:32:46,005 [INFO]: 		-> Add: 1.9 seconds
2025-03-09 10:32:46,005 [INFO]: 		Total: 16.7 minutes
2025-03-09 10:32:46,005 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0002 secs
2025-03-09 10:32:46,005 [INFO]: 	Checking that your have enough memory available to create the index 03/09/2025, 10:32:46
2025-03-09 10:32:46,005 [INFO]: 705.0MB of memory will be needed to build the index (more might be used if you have more)
2025-03-09 10:32:46,005 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0002 secs
2025-03-09 10:32:46,005 [INFO]: 	Selecting most promising index types given data characteristics 03/09/2025, 10:32:46
2025-03-09 10:32:46,005 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-09 10:32:46,005 [INFO]: 	Creating the index 03/09/2025, 10:32:46
2025-03-09 10:32:46,005 [INFO]: 		-> Instanciate the index HNSW15 03/09/2025, 10:32:46
2025-03-09 10:32:46,006 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0012 secs
2025-03-09 10:32:46,007 [INFO]: 		-> Adding the vectors to the index 03/09/2025, 10:32:46
2025-03-09 10:32:46,007 [INFO]: The memory available for adding the vectors is 49.4GB(total available - used by the index)
2025-03-09 10:32:46,007 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/14 [00:00<?, ?it/s]  7%|▋         | 1/14 [00:00<00:02,  6.23it/s] 36%|███▌      | 5/14 [00:00<00:00, 21.61it/s] 64%|██████▍   | 9/14 [00:00<00:00, 26.50it/s] 86%|████████▌ | 12/14 [00:00<00:00, 27.45it/s]100%|██████████| 14/14 [00:02<00:00,  5.39it/s]
2025-03-09 10:32:48,606 [INFO]: 	Computing best hyperparameters for index knn.index 03/09/2025, 10:32:48
2025-03-09 10:33:20,964 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 32.3578 secs
2025-03-09 10:33:20,964 [INFO]: The best hyperparameters are: efSearch=318
2025-03-09 10:33:20,964 [INFO]: 	Compute fast metrics 03/09/2025, 10:33:20
  0%|          | 0/4 [00:00<?, ?it/s] 25%|██▌       | 1/4 [00:00<00:00,  5.68it/s] 50%|█████     | 2/4 [00:00<00:00,  7.45it/s] 75%|███████▌  | 3/4 [00:00<00:00,  8.41it/s] 75%|███████▌  | 3/4 [00:00<00:00,  6.22it/s]
2025-03-09 10:33:35,633 [INFO]: 	>>> Finished "Compute fast metrics" in 14.6692 secs
2025-03-09 10:33:35,635 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 49.6284 secs
2025-03-09 10:33:35,635 [INFO]: {
2025-03-09 10:33:35,635 [INFO]: 	index_key: HNSW15
2025-03-09 10:33:35,635 [INFO]: 	index_param: efSearch=318
2025-03-09 10:33:35,635 [INFO]: 	index_path: knn.index
2025-03-09 10:33:35,635 [INFO]: 	size in bytes: 672077110
2025-03-09 10:33:35,635 [INFO]: 	avg_search_speed_ms: 10.411129585776427
2025-03-09 10:33:35,635 [INFO]: 	99p_search_speed_ms: 13.830837840214372
2025-03-09 10:33:35,635 [INFO]: 	reconstruction error %: 0.0
2025-03-09 10:33:35,635 [INFO]: 	nb vectors: 3416
2025-03-09 10:33:35,635 [INFO]: 	vectors dimension: 49152
2025-03-09 10:33:35,635 [INFO]: 	compression ratio: 0.9993093322282617
2025-03-09 10:33:35,635 [INFO]: }
2025-03-09 10:33:35,635 [INFO]: 	>>> Finished "Creating the index" in 49.6300 secs
2025-03-09 10:33:35,635 [INFO]: >>> Finished "Launching the whole pipeline" in 49.6577 secs
2025-03-09 10:33:36: [retrieval_preprocessing] calculating distances ...
2025-03-09 10:33:37: [retrieval_preprocessing] finished and saved retrieval indices for episode 26629 [episode count 1/20]
[retrieval_preprocessing] for episode 51728 [episode count 2/20], we have num_retrieval=np.int64(3481) num_query=np.int64(117)
2025-03-09 10:33:37,876 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-09 10:33:38,289 [INFO]: Launching the whole pipeline 03/09/2025, 10:33:38
2025-03-09 10:33:38,289 [INFO]: Reading total number of vectors and dimension 03/09/2025, 10:33:38
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 2285.72it/s]
2025-03-09 10:33:38,312 [INFO]: There are 3481 embeddings of dim 49152
2025-03-09 10:33:38,312 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0231 secs
2025-03-09 10:33:38,312 [INFO]: 	Compute estimated construction time of the index 03/09/2025, 10:33:38
2025-03-09 10:33:38,312 [INFO]: 		-> Train: 16.7 minutes
2025-03-09 10:33:38,312 [INFO]: 		-> Add: 1.9 seconds
2025-03-09 10:33:38,312 [INFO]: 		Total: 16.7 minutes
2025-03-09 10:33:38,313 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0001 secs
2025-03-09 10:33:38,313 [INFO]: 	Checking that your have enough memory available to create the index 03/09/2025, 10:33:38
2025-03-09 10:33:38,313 [INFO]: 718.4MB of memory will be needed to build the index (more might be used if you have more)
2025-03-09 10:33:38,313 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0001 secs
2025-03-09 10:33:38,313 [INFO]: 	Selecting most promising index types given data characteristics 03/09/2025, 10:33:38
2025-03-09 10:33:38,313 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-09 10:33:38,313 [INFO]: 	Creating the index 03/09/2025, 10:33:38
2025-03-09 10:33:38,313 [INFO]: 		-> Instanciate the index HNSW15 03/09/2025, 10:33:38
2025-03-09 10:33:38,314 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0009 secs
2025-03-09 10:33:38,314 [INFO]: 		-> Adding the vectors to the index 03/09/2025, 10:33:38
2025-03-09 10:33:38,314 [INFO]: The memory available for adding the vectors is 49.4GB(total available - used by the index)
2025-03-09 10:33:38,314 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/14 [00:00<?, ?it/s]  7%|▋         | 1/14 [00:00<00:01,  9.76it/s] 43%|████▎     | 6/14 [00:00<00:00, 29.16it/s] 71%|███████▏  | 10/14 [00:00<00:00, 31.36it/s]100%|██████████| 14/14 [00:02<00:00,  3.69it/s]100%|██████████| 14/14 [00:02<00:00,  5.05it/s]
2025-03-09 10:33:41,087 [INFO]: 	Computing best hyperparameters for index knn.index 03/09/2025, 10:33:41
2025-03-09 10:34:20,207 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 39.1191 secs
2025-03-09 10:34:20,207 [INFO]: The best hyperparameters are: efSearch=236
2025-03-09 10:34:20,207 [INFO]: 	Compute fast metrics 03/09/2025, 10:34:20
  0%|          | 0/4 [00:00<?, ?it/s] 25%|██▌       | 1/4 [00:00<00:00,  7.03it/s] 75%|███████▌  | 3/4 [00:00<00:00, 12.09it/s] 75%|███████▌  | 3/4 [00:00<00:00,  9.26it/s]
2025-03-09 10:34:34,007 [INFO]: 	>>> Finished "Compute fast metrics" in 13.8004 secs
2025-03-09 10:34:34,009 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 55.6955 secs
2025-03-09 10:34:34,009 [INFO]: {
2025-03-09 10:34:34,009 [INFO]: 	index_key: HNSW15
2025-03-09 10:34:34,009 [INFO]: 	index_param: efSearch=236
2025-03-09 10:34:34,009 [INFO]: 	index_path: knn.index
2025-03-09 10:34:34,009 [INFO]: 	size in bytes: 684865390
2025-03-09 10:34:34,009 [INFO]: 	avg_search_speed_ms: 8.77056821952002
2025-03-09 10:34:34,009 [INFO]: 	99p_search_speed_ms: 13.700844396371368
2025-03-09 10:34:34,009 [INFO]: 	reconstruction error %: 0.0
2025-03-09 10:34:34,009 [INFO]: 	nb vectors: 3481
2025-03-09 10:34:34,010 [INFO]: 	vectors dimension: 49152
2025-03-09 10:34:34,010 [INFO]: 	compression ratio: 0.9993094380196377
2025-03-09 10:34:34,010 [INFO]: }
2025-03-09 10:34:34,010 [INFO]: 	>>> Finished "Creating the index" in 55.6967 secs
2025-03-09 10:34:34,010 [INFO]: >>> Finished "Launching the whole pipeline" in 55.7204 secs
2025-03-09 10:34:34: [retrieval_preprocessing] calculating distances ...
2025-03-09 10:34:35: [retrieval_preprocessing] finished and saved retrieval indices for episode 51728 [episode count 2/20]
[retrieval_preprocessing] for episode 21015 [episode count 3/20], we have num_retrieval=np.int64(3443) num_query=np.int64(155)
2025-03-09 10:34:35,292 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-09 10:34:35,683 [INFO]: Launching the whole pipeline 03/09/2025, 10:34:35
2025-03-09 10:34:35,683 [INFO]: Reading total number of vectors and dimension 03/09/2025, 10:34:35
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1155.46it/s]
2025-03-09 10:34:35,710 [INFO]: There are 3443 embeddings of dim 49152
2025-03-09 10:34:35,710 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0268 secs
2025-03-09 10:34:35,710 [INFO]: 	Compute estimated construction time of the index 03/09/2025, 10:34:35
2025-03-09 10:34:35,710 [INFO]: 		-> Train: 16.7 minutes
2025-03-09 10:34:35,710 [INFO]: 		-> Add: 1.9 seconds
2025-03-09 10:34:35,710 [INFO]: 		Total: 16.7 minutes
2025-03-09 10:34:35,710 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0001 secs
2025-03-09 10:34:35,710 [INFO]: 	Checking that your have enough memory available to create the index 03/09/2025, 10:34:35
2025-03-09 10:34:35,710 [INFO]: 710.6MB of memory will be needed to build the index (more might be used if you have more)
2025-03-09 10:34:35,710 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0001 secs
2025-03-09 10:34:35,710 [INFO]: 	Selecting most promising index types given data characteristics 03/09/2025, 10:34:35
2025-03-09 10:34:35,710 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-09 10:34:35,710 [INFO]: 	Creating the index 03/09/2025, 10:34:35
2025-03-09 10:34:35,710 [INFO]: 		-> Instanciate the index HNSW15 03/09/2025, 10:34:35
2025-03-09 10:34:35,711 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0009 secs
2025-03-09 10:34:35,711 [INFO]: 		-> Adding the vectors to the index 03/09/2025, 10:34:35
2025-03-09 10:34:35,711 [INFO]: The memory available for adding the vectors is 49.4GB(total available - used by the index)
2025-03-09 10:34:35,711 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/14 [00:00<?, ?it/s]  7%|▋         | 1/14 [00:00<00:02,  5.94it/s] 36%|███▌      | 5/14 [00:00<00:00, 20.81it/s] 64%|██████▍   | 9/14 [00:00<00:00, 25.42it/s] 86%|████████▌ | 12/14 [00:00<00:00, 24.18it/s]100%|██████████| 14/14 [00:03<00:00,  4.55it/s]
2025-03-09 10:34:38,790 [INFO]: 	Computing best hyperparameters for index knn.index 03/09/2025, 10:34:38
2025-03-09 10:35:14,907 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 36.1157 secs
2025-03-09 10:35:14,907 [INFO]: The best hyperparameters are: efSearch=280
2025-03-09 10:35:14,907 [INFO]: 	Compute fast metrics 03/09/2025, 10:35:14
  0%|          | 0/4 [00:00<?, ?it/s] 25%|██▌       | 1/4 [00:00<00:00,  5.41it/s] 50%|█████     | 2/4 [00:00<00:00,  7.28it/s] 75%|███████▌  | 3/4 [00:00<00:00,  8.49it/s]
2025-03-09 10:35:30,500 [INFO]: 	>>> Finished "Compute fast metrics" in 15.5929 secs
2025-03-09 10:35:30,502 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 54.7904 secs
2025-03-09 10:35:30,502 [INFO]: {
2025-03-09 10:35:30,502 [INFO]: 	index_key: HNSW15
2025-03-09 10:35:30,502 [INFO]: 	index_param: efSearch=280
2025-03-09 10:35:30,502 [INFO]: 	index_path: knn.index
2025-03-09 10:35:30,502 [INFO]: 	size in bytes: 677389210
2025-03-09 10:35:30,502 [INFO]: 	avg_search_speed_ms: 9.994699888361188
2025-03-09 10:35:30,502 [INFO]: 	99p_search_speed_ms: 13.642919017001987
2025-03-09 10:35:30,502 [INFO]: 	reconstruction error %: 0.0
2025-03-09 10:35:30,502 [INFO]: 	nb vectors: 3443
2025-03-09 10:35:30,502 [INFO]: 	vectors dimension: 49152
2025-03-09 10:35:30,502 [INFO]: 	compression ratio: 0.9993093099312875
2025-03-09 10:35:30,502 [INFO]: }
2025-03-09 10:35:30,502 [INFO]: 	>>> Finished "Creating the index" in 54.7918 secs
2025-03-09 10:35:30,502 [INFO]: >>> Finished "Launching the whole pipeline" in 54.8192 secs
2025-03-09 10:35:31: [retrieval_preprocessing] calculating distances ...
2025-03-09 10:35:32: [retrieval_preprocessing] finished and saved retrieval indices for episode 21015 [episode count 3/20]
[retrieval_preprocessing] for episode 83992 [episode count 4/20], we have num_retrieval=np.int64(3469) num_query=np.int64(129)
2025-03-09 10:35:32,342 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-09 10:35:32,733 [INFO]: Launching the whole pipeline 03/09/2025, 10:35:32
2025-03-09 10:35:32,733 [INFO]: Reading total number of vectors and dimension 03/09/2025, 10:35:32
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1866.62it/s]
2025-03-09 10:35:32,759 [INFO]: There are 3469 embeddings of dim 49152
2025-03-09 10:35:32,759 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0264 secs
2025-03-09 10:35:32,759 [INFO]: 	Compute estimated construction time of the index 03/09/2025, 10:35:32
2025-03-09 10:35:32,760 [INFO]: 		-> Train: 16.7 minutes
2025-03-09 10:35:32,760 [INFO]: 		-> Add: 1.9 seconds
2025-03-09 10:35:32,760 [INFO]: 		Total: 16.7 minutes
2025-03-09 10:35:32,760 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0001 secs
2025-03-09 10:35:32,760 [INFO]: 	Checking that your have enough memory available to create the index 03/09/2025, 10:35:32
2025-03-09 10:35:32,760 [INFO]: 715.9MB of memory will be needed to build the index (more might be used if you have more)
2025-03-09 10:35:32,760 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0001 secs
2025-03-09 10:35:32,760 [INFO]: 	Selecting most promising index types given data characteristics 03/09/2025, 10:35:32
2025-03-09 10:35:32,760 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-09 10:35:32,760 [INFO]: 	Creating the index 03/09/2025, 10:35:32
2025-03-09 10:35:32,760 [INFO]: 		-> Instanciate the index HNSW15 03/09/2025, 10:35:32
2025-03-09 10:35:32,761 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0011 secs
2025-03-09 10:35:32,761 [INFO]: 		-> Adding the vectors to the index 03/09/2025, 10:35:32
2025-03-09 10:35:32,761 [INFO]: The memory available for adding the vectors is 49.4GB(total available - used by the index)
2025-03-09 10:35:32,761 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/14 [00:00<?, ?it/s]  7%|▋         | 1/14 [00:00<00:01,  8.59it/s] 43%|████▎     | 6/14 [00:00<00:00, 29.79it/s] 71%|███████▏  | 10/14 [00:00<00:00, 28.47it/s] 93%|█████████▎| 13/14 [00:00<00:00, 26.35it/s]100%|██████████| 14/14 [00:02<00:00,  4.93it/s]
2025-03-09 10:35:35,601 [INFO]: 	Computing best hyperparameters for index knn.index 03/09/2025, 10:35:35
2025-03-09 10:36:11,096 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 35.4948 secs
2025-03-09 10:36:11,097 [INFO]: The best hyperparameters are: efSearch=290
2025-03-09 10:36:11,097 [INFO]: 	Compute fast metrics 03/09/2025, 10:36:11
  0%|          | 0/4 [00:00<?, ?it/s] 25%|██▌       | 1/4 [00:00<00:00,  6.76it/s] 75%|███████▌  | 3/4 [00:00<00:00, 10.73it/s] 75%|███████▌  | 3/4 [00:00<00:00,  8.24it/s]
2025-03-09 10:36:24,846 [INFO]: 	>>> Finished "Compute fast metrics" in 13.7497 secs
2025-03-09 10:36:24,848 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 52.0870 secs
2025-03-09 10:36:24,848 [INFO]: {
2025-03-09 10:36:24,848 [INFO]: 	index_key: HNSW15
2025-03-09 10:36:24,848 [INFO]: 	index_param: efSearch=290
2025-03-09 10:36:24,848 [INFO]: 	index_path: knn.index
2025-03-09 10:36:24,848 [INFO]: 	size in bytes: 682504450
2025-03-09 10:36:24,848 [INFO]: 	avg_search_speed_ms: 9.907362763414564
2025-03-09 10:36:24,848 [INFO]: 	99p_search_speed_ms: 13.610913427546599
2025-03-09 10:36:24,848 [INFO]: 	reconstruction error %: 0.0
2025-03-09 10:36:24,848 [INFO]: 	nb vectors: 3469
2025-03-09 10:36:24,848 [INFO]: 	vectors dimension: 49152
2025-03-09 10:36:24,848 [INFO]: 	compression ratio: 0.9993094579822887
2025-03-09 10:36:24,848 [INFO]: }
2025-03-09 10:36:24,848 [INFO]: 	>>> Finished "Creating the index" in 52.0885 secs
2025-03-09 10:36:24,848 [INFO]: >>> Finished "Launching the whole pipeline" in 52.1155 secs
2025-03-09 10:36:25: [retrieval_preprocessing] calculating distances ...
2025-03-09 10:36:26: [retrieval_preprocessing] finished and saved retrieval indices for episode 83992 [episode count 4/20]
[retrieval_preprocessing] for episode 26137 [episode count 5/20], we have num_retrieval=np.int64(3418) num_query=np.int64(180)
2025-03-09 10:36:26,332 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-09 10:36:26,720 [INFO]: Launching the whole pipeline 03/09/2025, 10:36:26
2025-03-09 10:36:26,720 [INFO]: Reading total number of vectors and dimension 03/09/2025, 10:36:26
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1424.70it/s]
2025-03-09 10:36:26,749 [INFO]: There are 3418 embeddings of dim 49152
2025-03-09 10:36:26,749 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0287 secs
2025-03-09 10:36:26,749 [INFO]: 	Compute estimated construction time of the index 03/09/2025, 10:36:26
2025-03-09 10:36:26,750 [INFO]: 		-> Train: 16.7 minutes
2025-03-09 10:36:26,750 [INFO]: 		-> Add: 1.9 seconds
2025-03-09 10:36:26,750 [INFO]: 		Total: 16.7 minutes
2025-03-09 10:36:26,750 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0004 secs
2025-03-09 10:36:26,750 [INFO]: 	Checking that your have enough memory available to create the index 03/09/2025, 10:36:26
2025-03-09 10:36:26,750 [INFO]: 705.4MB of memory will be needed to build the index (more might be used if you have more)
2025-03-09 10:36:26,750 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0004 secs
2025-03-09 10:36:26,750 [INFO]: 	Selecting most promising index types given data characteristics 03/09/2025, 10:36:26
2025-03-09 10:36:26,751 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-09 10:36:26,751 [INFO]: 	Creating the index 03/09/2025, 10:36:26
2025-03-09 10:36:26,751 [INFO]: 		-> Instanciate the index HNSW15 03/09/2025, 10:36:26
2025-03-09 10:36:26,754 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0027 secs
2025-03-09 10:36:26,754 [INFO]: 		-> Adding the vectors to the index 03/09/2025, 10:36:26
2025-03-09 10:36:26,754 [INFO]: The memory available for adding the vectors is 49.4GB(total available - used by the index)
2025-03-09 10:36:26,754 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/14 [00:00<?, ?it/s]  7%|▋         | 1/14 [00:00<00:01,  6.63it/s] 36%|███▌      | 5/14 [00:00<00:00, 21.93it/s] 57%|█████▋    | 8/14 [00:00<00:00, 24.87it/s] 86%|████████▌ | 12/14 [00:00<00:00, 24.84it/s]100%|██████████| 14/14 [00:02<00:00,  4.97it/s]
2025-03-09 10:36:29,578 [INFO]: 	Computing best hyperparameters for index knn.index 03/09/2025, 10:36:29
2025-03-09 10:37:09,396 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 39.8173 secs
2025-03-09 10:37:09,396 [INFO]: The best hyperparameters are: efSearch=235
2025-03-09 10:37:09,396 [INFO]: 	Compute fast metrics 03/09/2025, 10:37:09
  0%|          | 0/4 [00:00<?, ?it/s] 75%|███████▌  | 3/4 [00:00<00:00, 26.72it/s] 75%|███████▌  | 3/4 [00:00<00:00, 23.40it/s]
2025-03-09 10:37:23,212 [INFO]: 	>>> Finished "Compute fast metrics" in 13.8157 secs
2025-03-09 10:37:23,214 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 56.4597 secs
2025-03-09 10:37:23,214 [INFO]: {
2025-03-09 10:37:23,214 [INFO]: 	index_key: HNSW15
2025-03-09 10:37:23,214 [INFO]: 	index_param: efSearch=235
2025-03-09 10:37:23,214 [INFO]: 	index_path: knn.index
2025-03-09 10:37:23,214 [INFO]: 	size in bytes: 672470590
2025-03-09 10:37:23,214 [INFO]: 	avg_search_speed_ms: 9.33498263999952
2025-03-09 10:37:23,214 [INFO]: 	99p_search_speed_ms: 15.212736697867488
2025-03-09 10:37:23,214 [INFO]: 	reconstruction error %: 0.0
2025-03-09 10:37:23,214 [INFO]: 	nb vectors: 3418
2025-03-09 10:37:23,214 [INFO]: 	vectors dimension: 49152
2025-03-09 10:37:23,214 [INFO]: 	compression ratio: 0.9993093437736809
2025-03-09 10:37:23,214 [INFO]: }
2025-03-09 10:37:23,214 [INFO]: 	>>> Finished "Creating the index" in 56.4636 secs
2025-03-09 10:37:23,214 [INFO]: >>> Finished "Launching the whole pipeline" in 56.4939 secs
2025-03-09 10:37:24: [retrieval_preprocessing] calculating distances ...
2025-03-09 10:37:24: [retrieval_preprocessing] finished and saved retrieval indices for episode 26137 [episode count 5/20]
[retrieval_preprocessing] for episode 73247 [episode count 6/20], we have num_retrieval=np.int64(3471) num_query=np.int64(127)
2025-03-09 10:37:24,926 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-09 10:37:25,326 [INFO]: Launching the whole pipeline 03/09/2025, 10:37:25
2025-03-09 10:37:25,326 [INFO]: Reading total number of vectors and dimension 03/09/2025, 10:37:25
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1859.18it/s]
2025-03-09 10:37:25,351 [INFO]: There are 3471 embeddings of dim 49152
2025-03-09 10:37:25,351 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0246 secs
2025-03-09 10:37:25,351 [INFO]: 	Compute estimated construction time of the index 03/09/2025, 10:37:25
2025-03-09 10:37:25,351 [INFO]: 		-> Train: 16.7 minutes
2025-03-09 10:37:25,351 [INFO]: 		-> Add: 1.9 seconds
2025-03-09 10:37:25,351 [INFO]: 		Total: 16.7 minutes
2025-03-09 10:37:25,352 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0003 secs
2025-03-09 10:37:25,352 [INFO]: 	Checking that your have enough memory available to create the index 03/09/2025, 10:37:25
2025-03-09 10:37:25,352 [INFO]: 716.3MB of memory will be needed to build the index (more might be used if you have more)
2025-03-09 10:37:25,352 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0004 secs
2025-03-09 10:37:25,352 [INFO]: 	Selecting most promising index types given data characteristics 03/09/2025, 10:37:25
2025-03-09 10:37:25,352 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-09 10:37:25,352 [INFO]: 	Creating the index 03/09/2025, 10:37:25
2025-03-09 10:37:25,353 [INFO]: 		-> Instanciate the index HNSW15 03/09/2025, 10:37:25
2025-03-09 10:37:25,355 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0025 secs
2025-03-09 10:37:25,355 [INFO]: 		-> Adding the vectors to the index 03/09/2025, 10:37:25
2025-03-09 10:37:25,355 [INFO]: The memory available for adding the vectors is 49.4GB(total available - used by the index)
2025-03-09 10:37:25,356 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/14 [00:00<?, ?it/s] 21%|██▏       | 3/14 [00:00<00:00, 28.07it/s] 71%|███████▏  | 10/14 [00:00<00:00, 49.78it/s]100%|██████████| 14/14 [00:02<00:00,  5.76it/s]
2025-03-09 10:37:27,791 [INFO]: 	Computing best hyperparameters for index knn.index 03/09/2025, 10:37:27
2025-03-09 10:38:04,248 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 36.4562 secs
2025-03-09 10:38:04,248 [INFO]: The best hyperparameters are: efSearch=274
2025-03-09 10:38:04,248 [INFO]: 	Compute fast metrics 03/09/2025, 10:38:04
  0%|          | 0/4 [00:00<?, ?it/s] 25%|██▌       | 1/4 [00:00<00:00,  4.64it/s] 75%|███████▌  | 3/4 [00:00<00:00,  8.70it/s] 75%|███████▌  | 3/4 [00:00<00:00,  6.76it/s]
2025-03-09 10:38:17,366 [INFO]: 	>>> Finished "Compute fast metrics" in 13.1172 secs
2025-03-09 10:38:17,367 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 52.0118 secs
2025-03-09 10:38:17,367 [INFO]: {
2025-03-09 10:38:17,367 [INFO]: 	index_key: HNSW15
2025-03-09 10:38:17,367 [INFO]: 	index_param: efSearch=274
2025-03-09 10:38:17,367 [INFO]: 	index_path: knn.index
2025-03-09 10:38:17,367 [INFO]: 	size in bytes: 682897930
2025-03-09 10:38:17,367 [INFO]: 	avg_search_speed_ms: 9.704844251087172
2025-03-09 10:38:17,367 [INFO]: 	99p_search_speed_ms: 12.50270733144135
2025-03-09 10:38:17,367 [INFO]: 	reconstruction error %: 0.0
2025-03-09 10:38:17,367 [INFO]: 	nb vectors: 3471
2025-03-09 10:38:17,367 [INFO]: 	vectors dimension: 49152
2025-03-09 10:38:17,367 [INFO]: 	compression ratio: 0.9993094692789595
2025-03-09 10:38:17,368 [INFO]: }
2025-03-09 10:38:17,368 [INFO]: 	>>> Finished "Creating the index" in 52.0151 secs
2025-03-09 10:38:17,368 [INFO]: >>> Finished "Launching the whole pipeline" in 52.0412 secs
2025-03-09 10:38:18: [retrieval_preprocessing] calculating distances ...
2025-03-09 10:38:18: [retrieval_preprocessing] finished and saved retrieval indices for episode 73247 [episode count 6/20]
[retrieval_preprocessing] for episode 17961 [episode count 7/20], we have num_retrieval=np.int64(3421) num_query=np.int64(177)
2025-03-09 10:38:19,070 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-09 10:38:19,504 [INFO]: Launching the whole pipeline 03/09/2025, 10:38:19
2025-03-09 10:38:19,504 [INFO]: Reading total number of vectors and dimension 03/09/2025, 10:38:19
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1552.87it/s]
2025-03-09 10:38:19,529 [INFO]: There are 3421 embeddings of dim 49152
2025-03-09 10:38:19,530 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0250 secs
2025-03-09 10:38:19,530 [INFO]: 	Compute estimated construction time of the index 03/09/2025, 10:38:19
2025-03-09 10:38:19,530 [INFO]: 		-> Train: 16.7 minutes
2025-03-09 10:38:19,530 [INFO]: 		-> Add: 1.9 seconds
2025-03-09 10:38:19,530 [INFO]: 		Total: 16.7 minutes
2025-03-09 10:38:19,530 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0001 secs
2025-03-09 10:38:19,530 [INFO]: 	Checking that your have enough memory available to create the index 03/09/2025, 10:38:19
2025-03-09 10:38:19,530 [INFO]: 706.0MB of memory will be needed to build the index (more might be used if you have more)
2025-03-09 10:38:19,530 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0001 secs
2025-03-09 10:38:19,530 [INFO]: 	Selecting most promising index types given data characteristics 03/09/2025, 10:38:19
2025-03-09 10:38:19,530 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-09 10:38:19,530 [INFO]: 	Creating the index 03/09/2025, 10:38:19
2025-03-09 10:38:19,530 [INFO]: 		-> Instanciate the index HNSW15 03/09/2025, 10:38:19
2025-03-09 10:38:19,531 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0011 secs
2025-03-09 10:38:19,531 [INFO]: 		-> Adding the vectors to the index 03/09/2025, 10:38:19
2025-03-09 10:38:19,531 [INFO]: The memory available for adding the vectors is 49.4GB(total available - used by the index)
2025-03-09 10:38:19,531 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/14 [00:00<?, ?it/s]  7%|▋         | 1/14 [00:00<00:01,  8.03it/s] 50%|█████     | 7/14 [00:00<00:00, 34.19it/s] 93%|█████████▎| 13/14 [00:00<00:00, 43.06it/s]100%|██████████| 14/14 [00:02<00:00,  5.84it/s]
2025-03-09 10:38:21,932 [INFO]: 	Computing best hyperparameters for index knn.index 03/09/2025, 10:38:21
2025-03-09 10:38:57,519 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 35.5862 secs
2025-03-09 10:38:57,519 [INFO]: The best hyperparameters are: efSearch=269
2025-03-09 10:38:57,519 [INFO]: 	Compute fast metrics 03/09/2025, 10:38:57
  0%|          | 0/4 [00:00<?, ?it/s] 75%|███████▌  | 3/4 [00:00<00:00, 27.66it/s]
2025-03-09 10:39:11,076 [INFO]: 	>>> Finished "Compute fast metrics" in 13.5575 secs
2025-03-09 10:39:11,078 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 51.5468 secs
2025-03-09 10:39:11,078 [INFO]: {
2025-03-09 10:39:11,078 [INFO]: 	index_key: HNSW15
2025-03-09 10:39:11,078 [INFO]: 	index_param: efSearch=269
2025-03-09 10:39:11,078 [INFO]: 	index_path: knn.index
2025-03-09 10:39:11,078 [INFO]: 	size in bytes: 673060810
2025-03-09 10:39:11,078 [INFO]: 	avg_search_speed_ms: 10.268135963235379
2025-03-09 10:39:11,078 [INFO]: 	99p_search_speed_ms: 15.304370843805373
2025-03-09 10:39:11,078 [INFO]: 	reconstruction error %: 0.0
2025-03-09 10:39:11,078 [INFO]: 	nb vectors: 3421
2025-03-09 10:39:11,078 [INFO]: 	vectors dimension: 49152
2025-03-09 10:39:11,078 [INFO]: 	compression ratio: 0.9993093610664986
2025-03-09 10:39:11,078 [INFO]: }
2025-03-09 10:39:11,078 [INFO]: 	>>> Finished "Creating the index" in 51.5484 secs
2025-03-09 10:39:11,078 [INFO]: >>> Finished "Launching the whole pipeline" in 51.5740 secs
2025-03-09 10:39:12: [retrieval_preprocessing] calculating distances ...
2025-03-09 10:39:12: [retrieval_preprocessing] finished and saved retrieval indices for episode 17961 [episode count 7/20]
[retrieval_preprocessing] for episode 8749 [episode count 8/20], we have num_retrieval=np.int64(3407) num_query=np.int64(191)
2025-03-09 10:39:12,910 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-09 10:39:13,357 [INFO]: Launching the whole pipeline 03/09/2025, 10:39:13
2025-03-09 10:39:13,357 [INFO]: Reading total number of vectors and dimension 03/09/2025, 10:39:13
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1179.83it/s]
2025-03-09 10:39:13,388 [INFO]: There are 3407 embeddings of dim 49152
2025-03-09 10:39:13,388 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0311 secs
2025-03-09 10:39:13,388 [INFO]: 	Compute estimated construction time of the index 03/09/2025, 10:39:13
2025-03-09 10:39:13,389 [INFO]: 		-> Train: 16.7 minutes
2025-03-09 10:39:13,389 [INFO]: 		-> Add: 1.9 seconds
2025-03-09 10:39:13,389 [INFO]: 		Total: 16.7 minutes
2025-03-09 10:39:13,389 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0002 secs
2025-03-09 10:39:13,389 [INFO]: 	Checking that your have enough memory available to create the index 03/09/2025, 10:39:13
2025-03-09 10:39:13,389 [INFO]: 703.1MB of memory will be needed to build the index (more might be used if you have more)
2025-03-09 10:39:13,389 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0002 secs
2025-03-09 10:39:13,389 [INFO]: 	Selecting most promising index types given data characteristics 03/09/2025, 10:39:13
2025-03-09 10:39:13,389 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-09 10:39:13,389 [INFO]: 	Creating the index 03/09/2025, 10:39:13
2025-03-09 10:39:13,389 [INFO]: 		-> Instanciate the index HNSW15 03/09/2025, 10:39:13
2025-03-09 10:39:13,391 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0021 secs
2025-03-09 10:39:13,392 [INFO]: 		-> Adding the vectors to the index 03/09/2025, 10:39:13
2025-03-09 10:39:13,392 [INFO]: The memory available for adding the vectors is 49.4GB(total available - used by the index)
2025-03-09 10:39:13,392 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/14 [00:00<?, ?it/s]  7%|▋         | 1/14 [00:00<00:01,  6.95it/s] 29%|██▊       | 4/14 [00:00<00:00, 18.17it/s] 57%|█████▋    | 8/14 [00:00<00:00, 25.06it/s]100%|██████████| 14/14 [00:02<00:00,  4.80it/s]100%|██████████| 14/14 [00:02<00:00,  5.84it/s]
2025-03-09 10:39:15,793 [INFO]: 	Computing best hyperparameters for index knn.index 03/09/2025, 10:39:15
2025-03-09 10:39:49,687 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 33.8940 secs
2025-03-09 10:39:49,687 [INFO]: The best hyperparameters are: efSearch=279
2025-03-09 10:39:49,687 [INFO]: 	Compute fast metrics 03/09/2025, 10:39:49
  0%|          | 0/4 [00:00<?, ?it/s] 75%|███████▌  | 3/4 [00:00<00:00, 28.26it/s] 75%|███████▌  | 3/4 [00:00<00:00, 24.58it/s]
2025-03-09 10:40:04,160 [INFO]: 	>>> Finished "Compute fast metrics" in 14.4730 secs
2025-03-09 10:40:04,162 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 50.7702 secs
2025-03-09 10:40:04,162 [INFO]: {
2025-03-09 10:40:04,162 [INFO]: 	index_key: HNSW15
2025-03-09 10:40:04,162 [INFO]: 	index_param: efSearch=279
2025-03-09 10:40:04,162 [INFO]: 	index_path: knn.index
2025-03-09 10:40:04,162 [INFO]: 	size in bytes: 670306450
2025-03-09 10:40:04,162 [INFO]: 	avg_search_speed_ms: 9.73304660093032
2025-03-09 10:40:04,162 [INFO]: 	99p_search_speed_ms: 12.036256764549762
2025-03-09 10:40:04,162 [INFO]: 	reconstruction error %: 0.0
2025-03-09 10:40:04,162 [INFO]: 	nb vectors: 3407
2025-03-09 10:40:04,162 [INFO]: 	vectors dimension: 49152
2025-03-09 10:40:04,162 [INFO]: 	compression ratio: 0.9993092801061365
2025-03-09 10:40:04,162 [INFO]: }
2025-03-09 10:40:04,162 [INFO]: 	>>> Finished "Creating the index" in 50.7729 secs
2025-03-09 10:40:04,162 [INFO]: >>> Finished "Launching the whole pipeline" in 50.8050 secs
2025-03-09 10:40:05: [retrieval_preprocessing] calculating distances ...
2025-03-09 10:40:06: [retrieval_preprocessing] finished and saved retrieval indices for episode 8749 [episode count 8/20]
[retrieval_preprocessing] for episode 38957 [episode count 9/20], we have num_retrieval=np.int64(3167) num_query=np.int64(431)
2025-03-09 10:40:06,248 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-09 10:40:06,624 [INFO]: Launching the whole pipeline 03/09/2025, 10:40:06
2025-03-09 10:40:06,624 [INFO]: Reading total number of vectors and dimension 03/09/2025, 10:40:06
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1824.40it/s]
2025-03-09 10:40:06,648 [INFO]: There are 3167 embeddings of dim 49152
2025-03-09 10:40:06,649 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0245 secs
2025-03-09 10:40:06,649 [INFO]: 	Compute estimated construction time of the index 03/09/2025, 10:40:06
2025-03-09 10:40:06,649 [INFO]: 		-> Train: 16.7 minutes
2025-03-09 10:40:06,649 [INFO]: 		-> Add: 1.7 seconds
2025-03-09 10:40:06,649 [INFO]: 		Total: 16.7 minutes
2025-03-09 10:40:06,649 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0001 secs
2025-03-09 10:40:06,649 [INFO]: 	Checking that your have enough memory available to create the index 03/09/2025, 10:40:06
2025-03-09 10:40:06,649 [INFO]: 653.6MB of memory will be needed to build the index (more might be used if you have more)
2025-03-09 10:40:06,649 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0001 secs
2025-03-09 10:40:06,649 [INFO]: 	Selecting most promising index types given data characteristics 03/09/2025, 10:40:06
2025-03-09 10:40:06,649 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-09 10:40:06,649 [INFO]: 	Creating the index 03/09/2025, 10:40:06
2025-03-09 10:40:06,649 [INFO]: 		-> Instanciate the index HNSW15 03/09/2025, 10:40:06
2025-03-09 10:40:06,650 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0011 secs
2025-03-09 10:40:06,650 [INFO]: 		-> Adding the vectors to the index 03/09/2025, 10:40:06
2025-03-09 10:40:06,650 [INFO]: The memory available for adding the vectors is 49.4GB(total available - used by the index)
2025-03-09 10:40:06,650 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/13 [00:00<?, ?it/s] 15%|█▌        | 2/13 [00:00<00:00, 17.81it/s] 62%|██████▏   | 8/13 [00:00<00:00, 40.61it/s]100%|██████████| 13/13 [00:01<00:00,  5.34it/s]100%|██████████| 13/13 [00:01<00:00,  6.51it/s]
2025-03-09 10:40:08,648 [INFO]: 	Computing best hyperparameters for index knn.index 03/09/2025, 10:40:08
2025-03-09 10:40:43,517 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 34.8686 secs
2025-03-09 10:40:43,517 [INFO]: The best hyperparameters are: efSearch=299
2025-03-09 10:40:43,517 [INFO]: 	Compute fast metrics 03/09/2025, 10:40:43
  0%|          | 0/4 [00:00<?, ?it/s] 25%|██▌       | 1/4 [00:00<00:00,  6.19it/s] 75%|███████▌  | 3/4 [00:00<00:00, 10.31it/s] 75%|███████▌  | 3/4 [00:00<00:00,  7.83it/s]
2025-03-09 10:40:57,402 [INFO]: 	>>> Finished "Compute fast metrics" in 13.8848 secs
2025-03-09 10:40:57,404 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 50.7537 secs
2025-03-09 10:40:57,404 [INFO]: {
2025-03-09 10:40:57,404 [INFO]: 	index_key: HNSW15
2025-03-09 10:40:57,404 [INFO]: 	index_param: efSearch=299
2025-03-09 10:40:57,404 [INFO]: 	index_path: knn.index
2025-03-09 10:40:57,404 [INFO]: 	size in bytes: 623087650
2025-03-09 10:40:57,404 [INFO]: 	avg_search_speed_ms: 9.386842160469959
2025-03-09 10:40:57,404 [INFO]: 	99p_search_speed_ms: 11.940573377069082
2025-03-09 10:40:57,404 [INFO]: 	reconstruction error %: 0.0
2025-03-09 10:40:57,404 [INFO]: 	nb vectors: 3167
2025-03-09 10:40:57,404 [INFO]: 	vectors dimension: 49152
2025-03-09 10:40:57,404 [INFO]: 	compression ratio: 0.9993097054643917
2025-03-09 10:40:57,404 [INFO]: }
2025-03-09 10:40:57,404 [INFO]: 	>>> Finished "Creating the index" in 50.7552 secs
2025-03-09 10:40:57,404 [INFO]: >>> Finished "Launching the whole pipeline" in 50.7803 secs
2025-03-09 10:40:59: [retrieval_preprocessing] calculating distances ...
2025-03-09 10:41:01: [retrieval_preprocessing] finished and saved retrieval indices for episode 38957 [episode count 9/20]
[retrieval_preprocessing] for episode 85551 [episode count 10/20], we have num_retrieval=np.int64(3457) num_query=np.int64(141)
2025-03-09 10:41:01,200 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-09 10:41:01,606 [INFO]: Launching the whole pipeline 03/09/2025, 10:41:01
2025-03-09 10:41:01,606 [INFO]: Reading total number of vectors and dimension 03/09/2025, 10:41:01
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1510.92it/s]
2025-03-09 10:41:01,631 [INFO]: There are 3457 embeddings of dim 49152
2025-03-09 10:41:01,631 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0253 secs
2025-03-09 10:41:01,631 [INFO]: 	Compute estimated construction time of the index 03/09/2025, 10:41:01
2025-03-09 10:41:01,631 [INFO]: 		-> Train: 16.7 minutes
2025-03-09 10:41:01,631 [INFO]: 		-> Add: 1.9 seconds
2025-03-09 10:41:01,631 [INFO]: 		Total: 16.7 minutes
2025-03-09 10:41:01,631 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0001 secs
2025-03-09 10:41:01,631 [INFO]: 	Checking that your have enough memory available to create the index 03/09/2025, 10:41:01
2025-03-09 10:41:01,631 [INFO]: 713.4MB of memory will be needed to build the index (more might be used if you have more)
2025-03-09 10:41:01,631 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0001 secs
2025-03-09 10:41:01,631 [INFO]: 	Selecting most promising index types given data characteristics 03/09/2025, 10:41:01
2025-03-09 10:41:01,631 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-09 10:41:01,632 [INFO]: 	Creating the index 03/09/2025, 10:41:01
2025-03-09 10:41:01,632 [INFO]: 		-> Instanciate the index HNSW15 03/09/2025, 10:41:01
2025-03-09 10:41:01,632 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0009 secs
2025-03-09 10:41:01,633 [INFO]: 		-> Adding the vectors to the index 03/09/2025, 10:41:01
2025-03-09 10:41:01,633 [INFO]: The memory available for adding the vectors is 49.4GB(total available - used by the index)
2025-03-09 10:41:01,633 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/14 [00:00<?, ?it/s] 14%|█▍        | 2/14 [00:00<00:00, 17.83it/s] 57%|█████▋    | 8/14 [00:00<00:00, 41.43it/s]100%|██████████| 14/14 [00:02<00:00,  4.99it/s]100%|██████████| 14/14 [00:02<00:00,  6.01it/s]
2025-03-09 10:41:03,966 [INFO]: 	Computing best hyperparameters for index knn.index 03/09/2025, 10:41:03
2025-03-09 10:41:39,212 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 35.2461 secs
2025-03-09 10:41:39,212 [INFO]: The best hyperparameters are: efSearch=293
2025-03-09 10:41:39,212 [INFO]: 	Compute fast metrics 03/09/2025, 10:41:39
  0%|          | 0/4 [00:00<?, ?it/s] 25%|██▌       | 1/4 [00:00<00:00,  7.17it/s] 75%|███████▌  | 3/4 [00:00<00:00, 15.72it/s]
2025-03-09 10:41:53,022 [INFO]: 	>>> Finished "Compute fast metrics" in 13.8099 secs
2025-03-09 10:41:53,024 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 51.3913 secs
2025-03-09 10:41:53,024 [INFO]: {
2025-03-09 10:41:53,024 [INFO]: 	index_key: HNSW15
2025-03-09 10:41:53,024 [INFO]: 	index_param: efSearch=293
2025-03-09 10:41:53,024 [INFO]: 	index_path: knn.index
2025-03-09 10:41:53,024 [INFO]: 	size in bytes: 680143570
2025-03-09 10:41:53,024 [INFO]: 	avg_search_speed_ms: 9.812275302149466
2025-03-09 10:41:53,024 [INFO]: 	99p_search_speed_ms: 13.121540648862716
2025-03-09 10:41:53,024 [INFO]: 	reconstruction error %: 0.0
2025-03-09 10:41:53,024 [INFO]: 	nb vectors: 3457
2025-03-09 10:41:53,024 [INFO]: 	vectors dimension: 49152
2025-03-09 10:41:53,024 [INFO]: 	compression ratio: 0.9993093899277766
2025-03-09 10:41:53,024 [INFO]: }
2025-03-09 10:41:53,024 [INFO]: 	>>> Finished "Creating the index" in 51.3926 secs
2025-03-09 10:41:53,024 [INFO]: >>> Finished "Launching the whole pipeline" in 51.4184 secs
2025-03-09 10:41:54: [retrieval_preprocessing] calculating distances ...
2025-03-09 10:41:54: [retrieval_preprocessing] finished and saved retrieval indices for episode 85551 [episode count 10/20]
[retrieval_preprocessing] for episode 27698 [episode count 11/20], we have num_retrieval=np.int64(3445) num_query=np.int64(153)
2025-03-09 10:41:54,583 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-09 10:41:54,966 [INFO]: Launching the whole pipeline 03/09/2025, 10:41:54
2025-03-09 10:41:54,966 [INFO]: Reading total number of vectors and dimension 03/09/2025, 10:41:54
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1909.11it/s]
2025-03-09 10:41:55,149 [INFO]: There are 3445 embeddings of dim 49152
2025-03-09 10:41:55,149 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.1833 secs
2025-03-09 10:41:55,150 [INFO]: 	Compute estimated construction time of the index 03/09/2025, 10:41:55
2025-03-09 10:41:55,150 [INFO]: 		-> Train: 16.7 minutes
2025-03-09 10:41:55,150 [INFO]: 		-> Add: 1.9 seconds
2025-03-09 10:41:55,150 [INFO]: 		Total: 16.7 minutes
2025-03-09 10:41:55,150 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0001 secs
2025-03-09 10:41:55,150 [INFO]: 	Checking that your have enough memory available to create the index 03/09/2025, 10:41:55
2025-03-09 10:41:55,150 [INFO]: 711.0MB of memory will be needed to build the index (more might be used if you have more)
2025-03-09 10:41:55,150 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0001 secs
2025-03-09 10:41:55,150 [INFO]: 	Selecting most promising index types given data characteristics 03/09/2025, 10:41:55
2025-03-09 10:41:55,150 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-09 10:41:55,150 [INFO]: 	Creating the index 03/09/2025, 10:41:55
2025-03-09 10:41:55,150 [INFO]: 		-> Instanciate the index HNSW15 03/09/2025, 10:41:55
2025-03-09 10:41:55,151 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0007 secs
2025-03-09 10:41:55,151 [INFO]: 		-> Adding the vectors to the index 03/09/2025, 10:41:55
2025-03-09 10:41:55,151 [INFO]: The memory available for adding the vectors is 49.4GB(total available - used by the index)
2025-03-09 10:41:55,151 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/14 [00:00<?, ?it/s] 14%|█▍        | 2/14 [00:00<00:00, 17.88it/s] 64%|██████▍   | 9/14 [00:00<00:00, 45.82it/s]100%|██████████| 14/14 [00:02<00:00,  4.89it/s]100%|██████████| 14/14 [00:02<00:00,  6.04it/s]
2025-03-09 10:41:57,471 [INFO]: 	Computing best hyperparameters for index knn.index 03/09/2025, 10:41:57
2025-03-09 10:42:29,778 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 32.3062 secs
2025-03-09 10:42:29,778 [INFO]: The best hyperparameters are: efSearch=290
2025-03-09 10:42:29,778 [INFO]: 	Compute fast metrics 03/09/2025, 10:42:29
  0%|          | 0/4 [00:00<?, ?it/s] 25%|██▌       | 1/4 [00:00<00:00,  6.26it/s] 75%|███████▌  | 3/4 [00:00<00:00, 10.45it/s] 75%|███████▌  | 3/4 [00:00<00:00,  7.95it/s]
2025-03-09 10:42:44,087 [INFO]: 	>>> Finished "Compute fast metrics" in 14.3095 secs
2025-03-09 10:42:44,089 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 48.9384 secs
2025-03-09 10:42:44,089 [INFO]: {
2025-03-09 10:42:44,089 [INFO]: 	index_key: HNSW15
2025-03-09 10:42:44,089 [INFO]: 	index_param: efSearch=290
2025-03-09 10:42:44,089 [INFO]: 	index_path: knn.index
2025-03-09 10:42:44,089 [INFO]: 	size in bytes: 677782690
2025-03-09 10:42:44,089 [INFO]: 	avg_search_speed_ms: 9.601413239921566
2025-03-09 10:42:44,089 [INFO]: 	99p_search_speed_ms: 11.499180453829464
2025-03-09 10:42:44,089 [INFO]: 	reconstruction error %: 0.0
2025-03-09 10:42:44,089 [INFO]: 	nb vectors: 3445
2025-03-09 10:42:44,089 [INFO]: 	vectors dimension: 49152
2025-03-09 10:42:44,089 [INFO]: 	compression ratio: 0.9993093213991641
2025-03-09 10:42:44,089 [INFO]: }
2025-03-09 10:42:44,089 [INFO]: 	>>> Finished "Creating the index" in 48.9395 secs
2025-03-09 10:42:44,089 [INFO]: >>> Finished "Launching the whole pipeline" in 49.1232 secs
2025-03-09 10:42:45: [retrieval_preprocessing] calculating distances ...
2025-03-09 10:42:45: [retrieval_preprocessing] finished and saved retrieval indices for episode 27698 [episode count 11/20]
[retrieval_preprocessing] for episode 72243 [episode count 12/20], we have num_retrieval=np.int64(3433) num_query=np.int64(165)
2025-03-09 10:42:45,709 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-09 10:42:46,088 [INFO]: Launching the whole pipeline 03/09/2025, 10:42:46
2025-03-09 10:42:46,088 [INFO]: Reading total number of vectors and dimension 03/09/2025, 10:42:46
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 2003.97it/s]
2025-03-09 10:42:46,112 [INFO]: There are 3433 embeddings of dim 49152
2025-03-09 10:42:46,113 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0242 secs
2025-03-09 10:42:46,113 [INFO]: 	Compute estimated construction time of the index 03/09/2025, 10:42:46
2025-03-09 10:42:46,113 [INFO]: 		-> Train: 16.7 minutes
2025-03-09 10:42:46,113 [INFO]: 		-> Add: 1.9 seconds
2025-03-09 10:42:46,113 [INFO]: 		Total: 16.7 minutes
2025-03-09 10:42:46,113 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0001 secs
2025-03-09 10:42:46,113 [INFO]: 	Checking that your have enough memory available to create the index 03/09/2025, 10:42:46
2025-03-09 10:42:46,113 [INFO]: 708.5MB of memory will be needed to build the index (more might be used if you have more)
2025-03-09 10:42:46,113 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0001 secs
2025-03-09 10:42:46,113 [INFO]: 	Selecting most promising index types given data characteristics 03/09/2025, 10:42:46
2025-03-09 10:42:46,113 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-09 10:42:46,113 [INFO]: 	Creating the index 03/09/2025, 10:42:46
2025-03-09 10:42:46,113 [INFO]: 		-> Instanciate the index HNSW15 03/09/2025, 10:42:46
2025-03-09 10:42:46,114 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0009 secs
2025-03-09 10:42:46,114 [INFO]: 		-> Adding the vectors to the index 03/09/2025, 10:42:46
2025-03-09 10:42:46,114 [INFO]: The memory available for adding the vectors is 49.4GB(total available - used by the index)
2025-03-09 10:42:46,114 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/14 [00:00<?, ?it/s]  7%|▋         | 1/14 [00:00<00:01,  9.82it/s] 57%|█████▋    | 8/14 [00:00<00:00, 41.15it/s]100%|██████████| 14/14 [00:02<00:00,  5.02it/s]100%|██████████| 14/14 [00:02<00:00,  5.94it/s]
2025-03-09 10:42:48,473 [INFO]: 	Computing best hyperparameters for index knn.index 03/09/2025, 10:42:48
2025-03-09 10:43:21,743 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 33.2697 secs
2025-03-09 10:43:21,743 [INFO]: The best hyperparameters are: efSearch=297
2025-03-09 10:43:21,744 [INFO]: 	Compute fast metrics 03/09/2025, 10:43:21
  0%|          | 0/4 [00:00<?, ?it/s] 25%|██▌       | 1/4 [00:00<00:00,  6.30it/s] 75%|███████▌  | 3/4 [00:00<00:00, 10.37it/s] 75%|███████▌  | 3/4 [00:00<00:00,  7.97it/s]
2025-03-09 10:43:36,039 [INFO]: 	>>> Finished "Compute fast metrics" in 14.2959 secs
2025-03-09 10:43:36,041 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 49.9270 secs
2025-03-09 10:43:36,041 [INFO]: {
2025-03-09 10:43:36,041 [INFO]: 	index_key: HNSW15
2025-03-09 10:43:36,041 [INFO]: 	index_param: efSearch=297
2025-03-09 10:43:36,041 [INFO]: 	index_path: knn.index
2025-03-09 10:43:36,041 [INFO]: 	size in bytes: 675421690
2025-03-09 10:43:36,041 [INFO]: 	avg_search_speed_ms: 9.70692019683571
2025-03-09 10:43:36,041 [INFO]: 	99p_search_speed_ms: 12.043220472987743
2025-03-09 10:43:36,041 [INFO]: 	reconstruction error %: 0.0
2025-03-09 10:43:36,041 [INFO]: 	nb vectors: 3433
2025-03-09 10:43:36,041 [INFO]: 	vectors dimension: 49152
2025-03-09 10:43:36,041 [INFO]: 	compression ratio: 0.9993094299355415
2025-03-09 10:43:36,041 [INFO]: }
2025-03-09 10:43:36,041 [INFO]: 	>>> Finished "Creating the index" in 49.9284 secs
2025-03-09 10:43:36,041 [INFO]: >>> Finished "Launching the whole pipeline" in 49.9530 secs
2025-03-09 10:43:37: [retrieval_preprocessing] calculating distances ...
2025-03-09 10:43:37: [retrieval_preprocessing] finished and saved retrieval indices for episode 72243 [episode count 12/20]
[retrieval_preprocessing] for episode 92214 [episode count 13/20], we have num_retrieval=np.int64(3440) num_query=np.int64(158)
2025-03-09 10:43:37,996 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-09 10:43:38,503 [INFO]: Launching the whole pipeline 03/09/2025, 10:43:38
2025-03-09 10:43:38,503 [INFO]: Reading total number of vectors and dimension 03/09/2025, 10:43:38
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 2312.19it/s]
2025-03-09 10:43:38,528 [INFO]: There are 3440 embeddings of dim 49152
2025-03-09 10:43:38,528 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0253 secs
2025-03-09 10:43:38,528 [INFO]: 	Compute estimated construction time of the index 03/09/2025, 10:43:38
2025-03-09 10:43:38,528 [INFO]: 		-> Train: 16.7 minutes
2025-03-09 10:43:38,529 [INFO]: 		-> Add: 1.9 seconds
2025-03-09 10:43:38,529 [INFO]: 		Total: 16.7 minutes
2025-03-09 10:43:38,529 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0001 secs
2025-03-09 10:43:38,529 [INFO]: 	Checking that your have enough memory available to create the index 03/09/2025, 10:43:38
2025-03-09 10:43:38,529 [INFO]: 709.9MB of memory will be needed to build the index (more might be used if you have more)
2025-03-09 10:43:38,529 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0001 secs
2025-03-09 10:43:38,529 [INFO]: 	Selecting most promising index types given data characteristics 03/09/2025, 10:43:38
2025-03-09 10:43:38,529 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-09 10:43:38,529 [INFO]: 	Creating the index 03/09/2025, 10:43:38
2025-03-09 10:43:38,529 [INFO]: 		-> Instanciate the index HNSW15 03/09/2025, 10:43:38
2025-03-09 10:43:38,530 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0011 secs
2025-03-09 10:43:38,530 [INFO]: 		-> Adding the vectors to the index 03/09/2025, 10:43:38
2025-03-09 10:43:38,530 [INFO]: The memory available for adding the vectors is 49.4GB(total available - used by the index)
2025-03-09 10:43:38,530 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/14 [00:00<?, ?it/s] 14%|█▍        | 2/14 [00:00<00:00, 17.38it/s] 64%|██████▍   | 9/14 [00:00<00:00, 43.09it/s]100%|██████████| 14/14 [00:02<00:00,  4.56it/s]100%|██████████| 14/14 [00:02<00:00,  5.64it/s]
2025-03-09 10:43:41,015 [INFO]: 	Computing best hyperparameters for index knn.index 03/09/2025, 10:43:41
2025-03-09 10:44:14,838 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 33.8229 secs
2025-03-09 10:44:14,839 [INFO]: The best hyperparameters are: efSearch=304
2025-03-09 10:44:14,839 [INFO]: 	Compute fast metrics 03/09/2025, 10:44:14
  0%|          | 0/4 [00:00<?, ?it/s] 25%|██▌       | 1/4 [00:00<00:00,  6.07it/s] 50%|█████     | 2/4 [00:00<00:00,  7.78it/s] 75%|███████▌  | 3/4 [00:00<00:00,  8.64it/s] 75%|███████▌  | 3/4 [00:00<00:00,  6.44it/s]
2025-03-09 10:44:27,985 [INFO]: 	>>> Finished "Compute fast metrics" in 13.1463 secs
2025-03-09 10:44:27,987 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 49.4566 secs
2025-03-09 10:44:27,987 [INFO]: {
2025-03-09 10:44:27,987 [INFO]: 	index_key: HNSW15
2025-03-09 10:44:27,987 [INFO]: 	index_param: efSearch=304
2025-03-09 10:44:27,987 [INFO]: 	index_path: knn.index
2025-03-09 10:44:27,987 [INFO]: 	size in bytes: 676798930
2025-03-09 10:44:27,987 [INFO]: 	avg_search_speed_ms: 10.583925659388855
2025-03-09 10:44:27,987 [INFO]: 	99p_search_speed_ms: 13.989277947694063
2025-03-09 10:44:27,987 [INFO]: 	reconstruction error %: 0.0
2025-03-09 10:44:27,987 [INFO]: 	nb vectors: 3440
2025-03-09 10:44:27,987 [INFO]: 	vectors dimension: 49152
2025-03-09 10:44:27,987 [INFO]: 	compression ratio: 0.9993093812958599
2025-03-09 10:44:27,987 [INFO]: }
2025-03-09 10:44:27,987 [INFO]: 	>>> Finished "Creating the index" in 49.4581 secs
2025-03-09 10:44:27,987 [INFO]: >>> Finished "Launching the whole pipeline" in 49.4841 secs
2025-03-09 10:44:29: [retrieval_preprocessing] calculating distances ...
2025-03-09 10:44:29: [retrieval_preprocessing] finished and saved retrieval indices for episode 92214 [episode count 13/20]
[retrieval_preprocessing] for episode 90679 [episode count 14/20], we have num_retrieval=np.int64(3417) num_query=np.int64(181)
2025-03-09 10:44:29,679 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-09 10:44:30,108 [INFO]: Launching the whole pipeline 03/09/2025, 10:44:30
2025-03-09 10:44:30,108 [INFO]: Reading total number of vectors and dimension 03/09/2025, 10:44:30
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1355.19it/s]
2025-03-09 10:44:30,138 [INFO]: There are 3417 embeddings of dim 49152
2025-03-09 10:44:30,138 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0299 secs
2025-03-09 10:44:30,138 [INFO]: 	Compute estimated construction time of the index 03/09/2025, 10:44:30
2025-03-09 10:44:30,138 [INFO]: 		-> Train: 16.7 minutes
2025-03-09 10:44:30,138 [INFO]: 		-> Add: 1.9 seconds
2025-03-09 10:44:30,138 [INFO]: 		Total: 16.7 minutes
2025-03-09 10:44:30,138 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0003 secs
2025-03-09 10:44:30,138 [INFO]: 	Checking that your have enough memory available to create the index 03/09/2025, 10:44:30
2025-03-09 10:44:30,139 [INFO]: 705.2MB of memory will be needed to build the index (more might be used if you have more)
2025-03-09 10:44:30,139 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0005 secs
2025-03-09 10:44:30,139 [INFO]: 	Selecting most promising index types given data characteristics 03/09/2025, 10:44:30
2025-03-09 10:44:30,139 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-09 10:44:30,139 [INFO]: 	Creating the index 03/09/2025, 10:44:30
2025-03-09 10:44:30,139 [INFO]: 		-> Instanciate the index HNSW15 03/09/2025, 10:44:30
2025-03-09 10:44:30,142 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0024 secs
2025-03-09 10:44:30,142 [INFO]: 		-> Adding the vectors to the index 03/09/2025, 10:44:30
2025-03-09 10:44:30,142 [INFO]: The memory available for adding the vectors is 49.4GB(total available - used by the index)
2025-03-09 10:44:30,142 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/14 [00:00<?, ?it/s] 14%|█▍        | 2/14 [00:00<00:00, 18.36it/s] 71%|███████▏  | 10/14 [00:00<00:00, 50.11it/s]100%|██████████| 14/14 [00:02<00:00,  5.48it/s]
2025-03-09 10:44:32,701 [INFO]: 	Computing best hyperparameters for index knn.index 03/09/2025, 10:44:32
2025-03-09 10:45:06,366 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 33.6656 secs
2025-03-09 10:45:06,367 [INFO]: The best hyperparameters are: efSearch=252
2025-03-09 10:45:06,367 [INFO]: 	Compute fast metrics 03/09/2025, 10:45:06
  0%|          | 0/4 [00:00<?, ?it/s] 25%|██▌       | 1/4 [00:00<00:00,  7.61it/s] 75%|███████▌  | 3/4 [00:00<00:00, 12.90it/s]
2025-03-09 10:45:20,124 [INFO]: 	>>> Finished "Compute fast metrics" in 13.7568 secs
2025-03-09 10:45:20,126 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 49.9836 secs
2025-03-09 10:45:20,126 [INFO]: {
2025-03-09 10:45:20,126 [INFO]: 	index_key: HNSW15
2025-03-09 10:45:20,126 [INFO]: 	index_param: efSearch=252
2025-03-09 10:45:20,126 [INFO]: 	index_path: knn.index
2025-03-09 10:45:20,126 [INFO]: 	size in bytes: 672273850
2025-03-09 10:45:20,126 [INFO]: 	avg_search_speed_ms: 9.346415647131469
2025-03-09 10:45:20,126 [INFO]: 	99p_search_speed_ms: 13.432969904970367
2025-03-09 10:45:20,126 [INFO]: 	reconstruction error %: 0.0
2025-03-09 10:45:20,126 [INFO]: 	nb vectors: 3417
2025-03-09 10:45:20,126 [INFO]: 	vectors dimension: 49152
2025-03-09 10:45:20,126 [INFO]: 	compression ratio: 0.9993093380026606
2025-03-09 10:45:20,126 [INFO]: }
2025-03-09 10:45:20,126 [INFO]: 	>>> Finished "Creating the index" in 49.9865 secs
2025-03-09 10:45:20,126 [INFO]: >>> Finished "Launching the whole pipeline" in 50.0180 secs
2025-03-09 10:45:21: [retrieval_preprocessing] calculating distances ...
2025-03-09 10:45:21: [retrieval_preprocessing] finished and saved retrieval indices for episode 90679 [episode count 14/20]
[retrieval_preprocessing] for episode 75323 [episode count 15/20], we have num_retrieval=np.int64(3419) num_query=np.int64(179)
2025-03-09 10:45:21,866 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-09 10:45:22,255 [INFO]: Launching the whole pipeline 03/09/2025, 10:45:22
2025-03-09 10:45:22,255 [INFO]: Reading total number of vectors and dimension 03/09/2025, 10:45:22
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1829.98it/s]
2025-03-09 10:45:22,279 [INFO]: There are 3419 embeddings of dim 49152
2025-03-09 10:45:22,280 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0247 secs
2025-03-09 10:45:22,280 [INFO]: 	Compute estimated construction time of the index 03/09/2025, 10:45:22
2025-03-09 10:45:22,280 [INFO]: 		-> Train: 16.7 minutes
2025-03-09 10:45:22,280 [INFO]: 		-> Add: 1.9 seconds
2025-03-09 10:45:22,280 [INFO]: 		Total: 16.7 minutes
2025-03-09 10:45:22,280 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0001 secs
2025-03-09 10:45:22,280 [INFO]: 	Checking that your have enough memory available to create the index 03/09/2025, 10:45:22
2025-03-09 10:45:22,280 [INFO]: 705.6MB of memory will be needed to build the index (more might be used if you have more)
2025-03-09 10:45:22,280 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0002 secs
2025-03-09 10:45:22,280 [INFO]: 	Selecting most promising index types given data characteristics 03/09/2025, 10:45:22
2025-03-09 10:45:22,280 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-09 10:45:22,280 [INFO]: 	Creating the index 03/09/2025, 10:45:22
2025-03-09 10:45:22,280 [INFO]: 		-> Instanciate the index HNSW15 03/09/2025, 10:45:22
2025-03-09 10:45:22,282 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0011 secs
2025-03-09 10:45:22,282 [INFO]: 		-> Adding the vectors to the index 03/09/2025, 10:45:22
2025-03-09 10:45:22,282 [INFO]: The memory available for adding the vectors is 49.4GB(total available - used by the index)
2025-03-09 10:45:22,282 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/14 [00:00<?, ?it/s]  7%|▋         | 1/14 [00:00<00:01,  9.78it/s] 57%|█████▋    | 8/14 [00:00<00:00, 41.24it/s]100%|██████████| 14/14 [00:02<00:00,  4.87it/s]100%|██████████| 14/14 [00:02<00:00,  5.77it/s]
2025-03-09 10:45:24,710 [INFO]: 	Computing best hyperparameters for index knn.index 03/09/2025, 10:45:24
2025-03-09 10:45:58,058 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 33.3479 secs
2025-03-09 10:45:58,058 [INFO]: The best hyperparameters are: efSearch=293
2025-03-09 10:45:58,058 [INFO]: 	Compute fast metrics 03/09/2025, 10:45:58
  0%|          | 0/4 [00:00<?, ?it/s] 75%|███████▌  | 3/4 [00:00<00:00, 27.97it/s] 75%|███████▌  | 3/4 [00:00<00:00, 24.52it/s]
2025-03-09 10:46:11,488 [INFO]: 	>>> Finished "Compute fast metrics" in 13.4297 secs
2025-03-09 10:46:11,490 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 49.2083 secs
2025-03-09 10:46:11,490 [INFO]: {
2025-03-09 10:46:11,490 [INFO]: 	index_key: HNSW15
2025-03-09 10:46:11,490 [INFO]: 	index_param: efSearch=293
2025-03-09 10:46:11,490 [INFO]: 	index_path: knn.index
2025-03-09 10:46:11,490 [INFO]: 	size in bytes: 672667330
2025-03-09 10:46:11,490 [INFO]: 	avg_search_speed_ms: 9.708414531936779
2025-03-09 10:46:11,490 [INFO]: 	99p_search_speed_ms: 11.817337889224294
2025-03-09 10:46:11,490 [INFO]: 	reconstruction error %: 0.0
2025-03-09 10:46:11,490 [INFO]: 	nb vectors: 3419
2025-03-09 10:46:11,490 [INFO]: 	vectors dimension: 49152
2025-03-09 10:46:11,490 [INFO]: 	compression ratio: 0.9993093495413253
2025-03-09 10:46:11,490 [INFO]: }
2025-03-09 10:46:11,490 [INFO]: 	>>> Finished "Creating the index" in 49.2098 secs
2025-03-09 10:46:11,490 [INFO]: >>> Finished "Launching the whole pipeline" in 49.2352 secs
2025-03-09 10:46:12: [retrieval_preprocessing] calculating distances ...
2025-03-09 10:46:13: [retrieval_preprocessing] finished and saved retrieval indices for episode 75323 [episode count 15/20]
[retrieval_preprocessing] for episode 30268 [episode count 16/20], we have num_retrieval=np.int64(3425) num_query=np.int64(173)
2025-03-09 10:46:13,452 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-09 10:46:13,833 [INFO]: Launching the whole pipeline 03/09/2025, 10:46:13
2025-03-09 10:46:13,833 [INFO]: Reading total number of vectors and dimension 03/09/2025, 10:46:13
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1804.78it/s]
2025-03-09 10:46:13,857 [INFO]: There are 3425 embeddings of dim 49152
2025-03-09 10:46:13,857 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0244 secs
2025-03-09 10:46:13,857 [INFO]: 	Compute estimated construction time of the index 03/09/2025, 10:46:13
2025-03-09 10:46:13,857 [INFO]: 		-> Train: 16.7 minutes
2025-03-09 10:46:13,857 [INFO]: 		-> Add: 1.9 seconds
2025-03-09 10:46:13,857 [INFO]: 		Total: 16.7 minutes
2025-03-09 10:46:13,857 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0001 secs
2025-03-09 10:46:13,858 [INFO]: 	Checking that your have enough memory available to create the index 03/09/2025, 10:46:13
2025-03-09 10:46:13,858 [INFO]: 706.8MB of memory will be needed to build the index (more might be used if you have more)
2025-03-09 10:46:13,858 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0001 secs
2025-03-09 10:46:13,858 [INFO]: 	Selecting most promising index types given data characteristics 03/09/2025, 10:46:13
2025-03-09 10:46:13,858 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-09 10:46:13,858 [INFO]: 	Creating the index 03/09/2025, 10:46:13
2025-03-09 10:46:13,858 [INFO]: 		-> Instanciate the index HNSW15 03/09/2025, 10:46:13
2025-03-09 10:46:13,859 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0008 secs
2025-03-09 10:46:13,859 [INFO]: 		-> Adding the vectors to the index 03/09/2025, 10:46:13
2025-03-09 10:46:13,859 [INFO]: The memory available for adding the vectors is 49.4GB(total available - used by the index)
2025-03-09 10:46:13,859 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/14 [00:00<?, ?it/s] 14%|█▍        | 2/14 [00:00<00:00, 18.30it/s] 57%|█████▋    | 8/14 [00:00<00:00, 41.67it/s]100%|██████████| 14/14 [00:02<00:00,  4.84it/s]100%|██████████| 14/14 [00:02<00:00,  5.84it/s]
2025-03-09 10:46:16,259 [INFO]: 	Computing best hyperparameters for index knn.index 03/09/2025, 10:46:16
2025-03-09 10:46:48,411 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 32.1515 secs
2025-03-09 10:46:48,411 [INFO]: The best hyperparameters are: efSearch=309
2025-03-09 10:46:48,411 [INFO]: 	Compute fast metrics 03/09/2025, 10:46:48
  0%|          | 0/4 [00:00<?, ?it/s] 25%|██▌       | 1/4 [00:00<00:00,  6.18it/s] 75%|███████▌  | 3/4 [00:00<00:00, 10.35it/s] 75%|███████▌  | 3/4 [00:00<00:00,  7.94it/s]
2025-03-09 10:47:02,497 [INFO]: 	>>> Finished "Compute fast metrics" in 14.0858 secs
2025-03-09 10:47:02,499 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 48.6399 secs
2025-03-09 10:47:02,499 [INFO]: {
2025-03-09 10:47:02,499 [INFO]: 	index_key: HNSW15
2025-03-09 10:47:02,499 [INFO]: 	index_param: efSearch=309
2025-03-09 10:47:02,499 [INFO]: 	index_path: knn.index
2025-03-09 10:47:02,499 [INFO]: 	size in bytes: 673847770
2025-03-09 10:47:02,499 [INFO]: 	avg_search_speed_ms: 10.129884958480464
2025-03-09 10:47:02,499 [INFO]: 	99p_search_speed_ms: 12.42293325252831
2025-03-09 10:47:02,499 [INFO]: 	reconstruction error %: 0.0
2025-03-09 10:47:02,499 [INFO]: 	nb vectors: 3425
2025-03-09 10:47:02,499 [INFO]: 	vectors dimension: 49152
2025-03-09 10:47:02,499 [INFO]: 	compression ratio: 0.9993093840764659
2025-03-09 10:47:02,499 [INFO]: }
2025-03-09 10:47:02,499 [INFO]: 	>>> Finished "Creating the index" in 48.6412 secs
2025-03-09 10:47:02,499 [INFO]: >>> Finished "Launching the whole pipeline" in 48.6662 secs
2025-03-09 10:47:03: [retrieval_preprocessing] calculating distances ...
2025-03-09 10:47:04: [retrieval_preprocessing] finished and saved retrieval indices for episode 30268 [episode count 16/20]
[retrieval_preprocessing] for episode 56383 [episode count 17/20], we have num_retrieval=np.int64(3422) num_query=np.int64(176)
2025-03-09 10:47:04,254 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-09 10:47:04,642 [INFO]: Launching the whole pipeline 03/09/2025, 10:47:04
2025-03-09 10:47:04,642 [INFO]: Reading total number of vectors and dimension 03/09/2025, 10:47:04
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 2330.17it/s]
2025-03-09 10:47:04,668 [INFO]: There are 3422 embeddings of dim 49152
2025-03-09 10:47:04,669 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0262 secs
2025-03-09 10:47:04,669 [INFO]: 	Compute estimated construction time of the index 03/09/2025, 10:47:04
2025-03-09 10:47:04,669 [INFO]: 		-> Train: 16.7 minutes
2025-03-09 10:47:04,669 [INFO]: 		-> Add: 1.9 seconds
2025-03-09 10:47:04,669 [INFO]: 		Total: 16.7 minutes
2025-03-09 10:47:04,669 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0003 secs
2025-03-09 10:47:04,669 [INFO]: 	Checking that your have enough memory available to create the index 03/09/2025, 10:47:04
2025-03-09 10:47:04,670 [INFO]: 706.2MB of memory will be needed to build the index (more might be used if you have more)
2025-03-09 10:47:04,670 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0004 secs
2025-03-09 10:47:04,670 [INFO]: 	Selecting most promising index types given data characteristics 03/09/2025, 10:47:04
2025-03-09 10:47:04,670 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-09 10:47:04,670 [INFO]: 	Creating the index 03/09/2025, 10:47:04
2025-03-09 10:47:04,670 [INFO]: 		-> Instanciate the index HNSW15 03/09/2025, 10:47:04
2025-03-09 10:47:04,673 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0023 secs
2025-03-09 10:47:04,673 [INFO]: 		-> Adding the vectors to the index 03/09/2025, 10:47:04
2025-03-09 10:47:04,673 [INFO]: The memory available for adding the vectors is 49.4GB(total available - used by the index)
2025-03-09 10:47:04,673 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/14 [00:00<?, ?it/s] 14%|█▍        | 2/14 [00:00<00:00, 16.62it/s] 50%|█████     | 7/14 [00:00<00:00, 33.19it/s] 86%|████████▌ | 12/14 [00:00<00:00, 38.98it/s]100%|██████████| 14/14 [00:02<00:00,  5.17it/s]
2025-03-09 10:47:07,388 [INFO]: 	Computing best hyperparameters for index knn.index 03/09/2025, 10:47:07
2025-03-09 10:47:43,479 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 36.0905 secs
2025-03-09 10:47:43,479 [INFO]: The best hyperparameters are: efSearch=268
2025-03-09 10:47:43,479 [INFO]: 	Compute fast metrics 03/09/2025, 10:47:43
  0%|          | 0/4 [00:00<?, ?it/s] 25%|██▌       | 1/4 [00:00<00:00,  6.31it/s] 75%|███████▌  | 3/4 [00:00<00:00, 10.46it/s] 75%|███████▌  | 3/4 [00:00<00:00,  7.98it/s]
2025-03-09 10:47:58,030 [INFO]: 	>>> Finished "Compute fast metrics" in 14.5507 secs
2025-03-09 10:47:58,457 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 53.7844 secs
2025-03-09 10:47:58,458 [INFO]: {
2025-03-09 10:47:58,458 [INFO]: 	index_key: HNSW15
2025-03-09 10:47:58,458 [INFO]: 	index_param: efSearch=268
2025-03-09 10:47:58,458 [INFO]: 	index_path: knn.index
2025-03-09 10:47:58,458 [INFO]: 	size in bytes: 673257550
2025-03-09 10:47:58,458 [INFO]: 	avg_search_speed_ms: 9.46863868563069
2025-03-09 10:47:58,458 [INFO]: 	99p_search_speed_ms: 11.887547711376106
2025-03-09 10:47:58,458 [INFO]: 	reconstruction error %: 0.0
2025-03-09 10:47:58,458 [INFO]: 	nb vectors: 3422
2025-03-09 10:47:58,458 [INFO]: 	vectors dimension: 49152
2025-03-09 10:47:58,459 [INFO]: 	compression ratio: 0.9993093668240334
2025-03-09 10:47:58,459 [INFO]: }
2025-03-09 10:47:58,459 [INFO]: 	>>> Finished "Creating the index" in 53.7885 secs
2025-03-09 10:47:58,459 [INFO]: >>> Finished "Launching the whole pipeline" in 53.8164 secs
2025-03-09 10:47:59: [retrieval_preprocessing] calculating distances ...
2025-03-09 10:48:00: [retrieval_preprocessing] finished and saved retrieval indices for episode 56383 [episode count 17/20]
[retrieval_preprocessing] for episode 26695 [episode count 18/20], we have num_retrieval=np.int64(3396) num_query=np.int64(202)
2025-03-09 10:48:00,308 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-09 10:48:00,686 [INFO]: Launching the whole pipeline 03/09/2025, 10:48:00
2025-03-09 10:48:00,687 [INFO]: Reading total number of vectors and dimension 03/09/2025, 10:48:00
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1507.66it/s]
2025-03-09 10:48:00,711 [INFO]: There are 3396 embeddings of dim 49152
2025-03-09 10:48:00,712 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0250 secs
2025-03-09 10:48:00,712 [INFO]: 	Compute estimated construction time of the index 03/09/2025, 10:48:00
2025-03-09 10:48:00,712 [INFO]: 		-> Train: 16.7 minutes
2025-03-09 10:48:00,712 [INFO]: 		-> Add: 1.9 seconds
2025-03-09 10:48:00,712 [INFO]: 		Total: 16.7 minutes
2025-03-09 10:48:00,712 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0001 secs
2025-03-09 10:48:00,712 [INFO]: 	Checking that your have enough memory available to create the index 03/09/2025, 10:48:00
2025-03-09 10:48:00,712 [INFO]: 700.9MB of memory will be needed to build the index (more might be used if you have more)
2025-03-09 10:48:00,712 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0001 secs
2025-03-09 10:48:00,712 [INFO]: 	Selecting most promising index types given data characteristics 03/09/2025, 10:48:00
2025-03-09 10:48:00,712 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-09 10:48:00,712 [INFO]: 	Creating the index 03/09/2025, 10:48:00
2025-03-09 10:48:00,712 [INFO]: 		-> Instanciate the index HNSW15 03/09/2025, 10:48:00
2025-03-09 10:48:00,713 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0008 secs
2025-03-09 10:48:00,713 [INFO]: 		-> Adding the vectors to the index 03/09/2025, 10:48:00
2025-03-09 10:48:00,713 [INFO]: The memory available for adding the vectors is 49.4GB(total available - used by the index)
2025-03-09 10:48:00,713 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/14 [00:00<?, ?it/s] 14%|█▍        | 2/14 [00:00<00:00, 19.98it/s] 64%|██████▍   | 9/14 [00:00<00:00, 45.71it/s]100%|██████████| 14/14 [00:02<00:00,  4.63it/s]100%|██████████| 14/14 [00:02<00:00,  5.74it/s]
2025-03-09 10:48:03,153 [INFO]: 	Computing best hyperparameters for index knn.index 03/09/2025, 10:48:03
2025-03-09 10:48:35,687 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 32.5338 secs
2025-03-09 10:48:35,688 [INFO]: The best hyperparameters are: efSearch=311
2025-03-09 10:48:35,688 [INFO]: 	Compute fast metrics 03/09/2025, 10:48:35
  0%|          | 0/4 [00:00<?, ?it/s] 25%|██▌       | 1/4 [00:00<00:00,  6.00it/s] 75%|███████▌  | 3/4 [00:00<00:00, 10.17it/s] 75%|███████▌  | 3/4 [00:00<00:00,  7.83it/s]
2025-03-09 10:48:50,117 [INFO]: 	>>> Finished "Compute fast metrics" in 14.4290 secs
2025-03-09 10:48:50,118 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 49.4053 secs
2025-03-09 10:48:50,118 [INFO]: {
2025-03-09 10:48:50,118 [INFO]: 	index_key: HNSW15
2025-03-09 10:48:50,118 [INFO]: 	index_param: efSearch=311
2025-03-09 10:48:50,118 [INFO]: 	index_path: knn.index
2025-03-09 10:48:50,118 [INFO]: 	size in bytes: 668142250
2025-03-09 10:48:50,118 [INFO]: 	avg_search_speed_ms: 9.930377791412804
2025-03-09 10:48:50,119 [INFO]: 	99p_search_speed_ms: 12.29722486343234
2025-03-09 10:48:50,119 [INFO]: 	reconstruction error %: 0.0
2025-03-09 10:48:50,119 [INFO]: 	nb vectors: 3396
2025-03-09 10:48:50,119 [INFO]: 	vectors dimension: 49152
2025-03-09 10:48:50,119 [INFO]: 	compression ratio: 0.9993093057653516
2025-03-09 10:48:50,119 [INFO]: }
2025-03-09 10:48:50,119 [INFO]: 	>>> Finished "Creating the index" in 49.4065 secs
2025-03-09 10:48:50,119 [INFO]: >>> Finished "Launching the whole pipeline" in 49.4321 secs
2025-03-09 10:48:51: [retrieval_preprocessing] calculating distances ...
2025-03-09 10:48:52: [retrieval_preprocessing] finished and saved retrieval indices for episode 26695 [episode count 18/20]
[retrieval_preprocessing] for episode 56392 [episode count 19/20], we have num_retrieval=np.int64(3404) num_query=np.int64(194)
2025-03-09 10:48:52,230 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-09 10:48:52,618 [INFO]: Launching the whole pipeline 03/09/2025, 10:48:52
2025-03-09 10:48:52,618 [INFO]: Reading total number of vectors and dimension 03/09/2025, 10:48:52
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 2474.52it/s]
2025-03-09 10:48:52,640 [INFO]: There are 3404 embeddings of dim 49152
2025-03-09 10:48:52,640 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0224 secs
2025-03-09 10:48:52,640 [INFO]: 	Compute estimated construction time of the index 03/09/2025, 10:48:52
2025-03-09 10:48:52,640 [INFO]: 		-> Train: 16.7 minutes
2025-03-09 10:48:52,640 [INFO]: 		-> Add: 1.9 seconds
2025-03-09 10:48:52,640 [INFO]: 		Total: 16.7 minutes
2025-03-09 10:48:52,640 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0001 secs
2025-03-09 10:48:52,640 [INFO]: 	Checking that your have enough memory available to create the index 03/09/2025, 10:48:52
2025-03-09 10:48:52,640 [INFO]: 702.5MB of memory will be needed to build the index (more might be used if you have more)
2025-03-09 10:48:52,640 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0001 secs
2025-03-09 10:48:52,641 [INFO]: 	Selecting most promising index types given data characteristics 03/09/2025, 10:48:52
2025-03-09 10:48:52,641 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-09 10:48:52,641 [INFO]: 	Creating the index 03/09/2025, 10:48:52
2025-03-09 10:48:52,641 [INFO]: 		-> Instanciate the index HNSW15 03/09/2025, 10:48:52
2025-03-09 10:48:52,642 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0009 secs
2025-03-09 10:48:52,642 [INFO]: 		-> Adding the vectors to the index 03/09/2025, 10:48:52
2025-03-09 10:48:52,642 [INFO]: The memory available for adding the vectors is 49.4GB(total available - used by the index)
2025-03-09 10:48:52,642 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/14 [00:00<?, ?it/s] 21%|██▏       | 3/14 [00:00<00:00, 29.97it/s] 79%|███████▊  | 11/14 [00:00<00:00, 58.06it/s]100%|██████████| 14/14 [00:02<00:00,  5.01it/s]
2025-03-09 10:48:55,437 [INFO]: 	Computing best hyperparameters for index knn.index 03/09/2025, 10:48:55
2025-03-09 10:49:29,456 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 34.0180 secs
2025-03-09 10:49:29,456 [INFO]: The best hyperparameters are: efSearch=294
2025-03-09 10:49:29,456 [INFO]: 	Compute fast metrics 03/09/2025, 10:49:29
  0%|          | 0/4 [00:00<?, ?it/s] 25%|██▌       | 1/4 [00:00<00:00,  6.58it/s] 75%|███████▌  | 3/4 [00:00<00:00, 10.73it/s] 75%|███████▌  | 3/4 [00:00<00:00,  8.20it/s]
2025-03-09 10:49:43,634 [INFO]: 	>>> Finished "Compute fast metrics" in 14.1782 secs
2025-03-09 10:49:43,636 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 50.9942 secs
2025-03-09 10:49:43,636 [INFO]: {
2025-03-09 10:49:43,636 [INFO]: 	index_key: HNSW15
2025-03-09 10:49:43,636 [INFO]: 	index_param: efSearch=294
2025-03-09 10:49:43,636 [INFO]: 	index_path: knn.index
2025-03-09 10:49:43,636 [INFO]: 	size in bytes: 669716230
2025-03-09 10:49:43,636 [INFO]: 	avg_search_speed_ms: 9.752648549790425
2025-03-09 10:49:43,636 [INFO]: 	99p_search_speed_ms: 12.86138136871159
2025-03-09 10:49:43,636 [INFO]: 	reconstruction error %: 0.0
2025-03-09 10:49:43,636 [INFO]: 	nb vectors: 3404
2025-03-09 10:49:43,636 [INFO]: 	vectors dimension: 49152
2025-03-09 10:49:43,636 [INFO]: 	compression ratio: 0.999309262670848
2025-03-09 10:49:43,636 [INFO]: }
2025-03-09 10:49:43,636 [INFO]: 	>>> Finished "Creating the index" in 50.9956 secs
2025-03-09 10:49:43,636 [INFO]: >>> Finished "Launching the whole pipeline" in 51.0185 secs
2025-03-09 10:49:44: [retrieval_preprocessing] calculating distances ...
2025-03-09 10:49:45: [retrieval_preprocessing] finished and saved retrieval indices for episode 56392 [episode count 19/20]
2025-03-09 10:49:45: [retrieval_preprocessing] finished for (9130122211, 'marker') [chosen_id count 9/10]
2025-03-09 10:49:45: [retrieval_preprocessing] done for embedding_type='embeddings__wrist_image_left'!
