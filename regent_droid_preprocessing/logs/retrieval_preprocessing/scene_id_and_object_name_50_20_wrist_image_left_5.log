nohup: ignoring input
2025-03-09 06:47:32: got the info dicts: there are 36687 groupings

2025-03-09 06:47:32: number of groupings with atleast 50 episodes [in the first 95658 episodes]: 105

these groupings have chosen_id-->num_episodes as

 {(1297764552, 'bottle'): 53, (2515873443, 'cloth'): 50, (5235850418, 'drawer'): 612, (5879622450, 'block'): 108, (1431810548, 'lid'): 51, (3485794757, 'marker'): 97, (8756300955, 'block'): 117, (1180576306, 'cloth'): 60, (9154343709, 'drawer'): 96, (6498288010, 'bottle'): 138, (8911427557, 'bottle'): 50, (1058976383, 'drawer'): 148, (4045730075, 'lid'): 61, (1712293193, 'marker'): 163, (65137982, 'block'): 100, (4329524892, 'cup'): 166, (484659531, 'marker'): 96, (-1, 'marker'): 1032, (6078642573, 'marker'): 54, (452818143, 'lid'): 221, (1461982682, 'cloth'): 76, (5235850418, 'block'): 97, (7495112204, 'marker'): 102, (666854965, 'marker'): 68, (395700094, 'block'): 72, (3827924651, 'lid'): 67, (6612454114, 'block'): 65, (2782099537, 'marker'): 75, (8376714657, 'marker'): 464, (3452853472, 'drawer'): 91, (9306310171, 'marker'): 97, (3816161570, 'drawer'): 78, (5511329841, 'marker'): 59, (3951366978, 'cup'): 112, (1959308322, 'marker'): 65, (3163748394, 'cup'): 127, (7644292911, 'marker'): 50, (1775582436, 'marker'): 98, (4706041793, 'cloth'): 142, (2370783071, 'block'): 50, (9551783935, 'drawer'): 65, (2782099537, 'cup'): 153, (7489911085, 'cloth'): 179, (5576515039, 'marker'): 50, (4465064685, 'marker'): 198, (9186164821, 'bottle'): 57, (5207831207, 'cup'): 139, (3774560981, 'cloth'): 99, (4823049285, 'bottle'): 234, (9130122211, 'marker'): 159, (6313680013, 'cup'): 50, (9088223759, 'bottle'): 99, (8098563998, 'lid'): 73, (9505766118, 'drawer'): 108, (441689524, 'mug'): 77, (8150285641, 'marker'): 63, (8456936732, 'bottle'): 54, (446878712, 'marker'): 83, (6093644330, 'cloth'): 52, (4345518188, 'lid'): 89, (5024387521, 'marker'): 60, (6498288010, 'lid'): 96, (4823049285, 'block'): 174, (6667529842, 'lid'): 90, (5507987860, 'marker'): 100, (8898968162, 'block'): 58, (-1, 'mug'): 228, (9965421062, 'bottle'): 63, (6357288647, 'lid'): 71, (5701580274, 'marker'): 67, (1469427884, 'marker'): 63, (9933578360, 'drawer'): 53, (1498834123, 'cup'): 77, (440287856, 'drawer'): 75, (376702246, 'cup'): 53, (9883209091, 'mug'): 201, (9934859632, 'marker'): 62, (4312815282, 'marker'): 66, (-1, 'cup'): 113, (8922050678, 'lid'): 64, (2883696971, 'cup'): 69, (9209350647, 'drawer'): 76, (6655265581, 'cup'): 51, (4345518188, 'cloth'): 91, (4545879864, 'marker'): 51, (818725642, 'block'): 63, (3854327802, 'bottle'): 97, (3951366978, 'lid'): 72, (5059283044, 'drawer'): 113, (4846810092, 'cloth'): 93, (8690198922, 'marker'): 65, (1477699675, 'marker'): 89, (4400212150, 'marker'): 52, (1526685371, 'marker'): 62, (6074146895, 'lid'): 59, (8911427557, 'cup'): 112, (8702636502, 'lid'): 90, (8172596608, 'cup'): 51, (1575177183, 'marker'): 59, (5414640868, 'lid'): 56, (1477699675, 'mug'): 57, (9228483020, 'marker'): 80, (2927338332, 'cloth'): 51, (52817038, 'block'): 54, (8815207926, 'block'): 54}
2025-03-09 06:47:32: [retrieval_preprocessing] starting retrieval preprocessing for embeddings__wrist_image_left
2025-03-09 06:47:34: [retrieval_preprocessing] concatenated all embeddings and indices for 20 episodes for (6313680013, 'cup') [chosen_id count 0/10]
2025-03-09 06:47:34: [retrieval_preprocessing] we have num_total=2669 embedding_dim=49152
[retrieval_preprocessing] for episode 48768 [episode count 0/20], we have num_retrieval=np.int64(2525) num_query=np.int64(144)
2025-03-09 06:47:34,895 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-09 06:47:35,218 [INFO]: Launching the whole pipeline 03/09/2025, 06:47:35
2025-03-09 06:47:35,218 [INFO]: Reading total number of vectors and dimension 03/09/2025, 06:47:35
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 808.31it/s]
2025-03-09 06:47:35,258 [INFO]: There are 2525 embeddings of dim 49152
2025-03-09 06:47:35,259 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0408 secs
2025-03-09 06:47:35,259 [INFO]: 	Compute estimated construction time of the index 03/09/2025, 06:47:35
2025-03-09 06:47:35,259 [INFO]: 		-> Train: 16.7 minutes
2025-03-09 06:47:35,259 [INFO]: 		-> Add: 1.4 seconds
2025-03-09 06:47:35,259 [INFO]: 		Total: 16.7 minutes
2025-03-09 06:47:35,260 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0004 secs
2025-03-09 06:47:35,260 [INFO]: 	Checking that your have enough memory available to create the index 03/09/2025, 06:47:35
2025-03-09 06:47:35,261 [INFO]: 521.1MB of memory will be needed to build the index (more might be used if you have more)
2025-03-09 06:47:35,261 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0015 secs
2025-03-09 06:47:35,261 [INFO]: 	Selecting most promising index types given data characteristics 03/09/2025, 06:47:35
2025-03-09 06:47:35,261 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-09 06:47:35,262 [INFO]: 	Creating the index 03/09/2025, 06:47:35
2025-03-09 06:47:35,262 [INFO]: 		-> Instanciate the index HNSW15 03/09/2025, 06:47:35
2025-03-09 06:47:35,264 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0026 secs
2025-03-09 06:47:35,265 [INFO]: 		-> Adding the vectors to the index 03/09/2025, 06:47:35
2025-03-09 06:47:35,265 [INFO]: The memory available for adding the vectors is 49.5GB(total available - used by the index)
2025-03-09 06:47:35,265 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/10 [00:00<?, ?it/s] 10%|█         | 1/10 [00:00<00:01,  5.67it/s] 20%|██        | 2/10 [00:00<00:01,  7.20it/s] 30%|███       | 3/10 [00:00<00:00,  7.98it/s] 40%|████      | 4/10 [00:00<00:00,  8.32it/s] 50%|█████     | 5/10 [00:00<00:00,  8.50it/s] 60%|██████    | 6/10 [00:00<00:00,  8.61it/s] 70%|███████   | 7/10 [00:00<00:00,  8.67it/s] 80%|████████  | 8/10 [00:00<00:00,  8.81it/s] 90%|█████████ | 9/10 [00:01<00:00,  8.81it/s]100%|██████████| 10/10 [00:02<00:00,  1.74it/s]100%|██████████| 10/10 [00:02<00:00,  3.73it/s]
2025-03-09 06:47:37,957 [INFO]: 	Computing best hyperparameters for index knn.index 03/09/2025, 06:47:37
2025-03-09 06:48:09,384 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 31.4255 secs
2025-03-09 06:48:09,384 [INFO]: The best hyperparameters are: efSearch=311
2025-03-09 06:48:09,384 [INFO]: 	Compute fast metrics 03/09/2025, 06:48:09
  0%|          | 0/4 [00:00<?, ?it/s] 25%|██▌       | 1/4 [00:00<00:00,  6.54it/s] 75%|███████▌  | 3/4 [00:00<00:00,  9.83it/s] 75%|███████▌  | 3/4 [00:00<00:00,  7.47it/s]
2025-03-09 06:48:21,672 [INFO]: 	>>> Finished "Compute fast metrics" in 12.2879 secs
2025-03-09 06:48:21,674 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 46.4095 secs
2025-03-09 06:48:21,674 [INFO]: {
2025-03-09 06:48:21,674 [INFO]: 	index_key: HNSW15
2025-03-09 06:48:21,674 [INFO]: 	index_param: efSearch=311
2025-03-09 06:48:21,674 [INFO]: 	index_path: knn.index
2025-03-09 06:48:21,674 [INFO]: 	size in bytes: 496778050
2025-03-09 06:48:21,674 [INFO]: 	avg_search_speed_ms: 9.304471418131577
2025-03-09 06:48:21,674 [INFO]: 	99p_search_speed_ms: 16.306414701975882
2025-03-09 06:48:21,675 [INFO]: 	reconstruction error %: 0.0
2025-03-09 06:48:21,675 [INFO]: 	nb vectors: 2525
2025-03-09 06:48:21,675 [INFO]: 	vectors dimension: 49152
2025-03-09 06:48:21,675 [INFO]: 	compression ratio: 0.9993098527602015
2025-03-09 06:48:21,675 [INFO]: }
2025-03-09 06:48:21,675 [INFO]: 	>>> Finished "Creating the index" in 46.4129 secs
2025-03-09 06:48:21,675 [INFO]: >>> Finished "Launching the whole pipeline" in 46.4569 secs
2025-03-09 06:48:22: [retrieval_preprocessing] calculating distances ...
2025-03-09 06:48:23: [retrieval_preprocessing] finished and saved retrieval indices for episode 48768 [episode count 0/20]
[retrieval_preprocessing] for episode 50433 [episode count 1/20], we have num_retrieval=np.int64(2537) num_query=np.int64(132)
2025-03-09 06:48:23,939 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-09 06:48:24,312 [INFO]: Launching the whole pipeline 03/09/2025, 06:48:24
2025-03-09 06:48:24,313 [INFO]: Reading total number of vectors and dimension 03/09/2025, 06:48:24
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1137.59it/s]
2025-03-09 06:48:24,339 [INFO]: There are 2537 embeddings of dim 49152
2025-03-09 06:48:24,339 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0264 secs
2025-03-09 06:48:24,339 [INFO]: 	Compute estimated construction time of the index 03/09/2025, 06:48:24
2025-03-09 06:48:24,339 [INFO]: 		-> Train: 16.7 minutes
2025-03-09 06:48:24,339 [INFO]: 		-> Add: 1.4 seconds
2025-03-09 06:48:24,339 [INFO]: 		Total: 16.7 minutes
2025-03-09 06:48:24,339 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0001 secs
2025-03-09 06:48:24,339 [INFO]: 	Checking that your have enough memory available to create the index 03/09/2025, 06:48:24
2025-03-09 06:48:24,339 [INFO]: 523.6MB of memory will be needed to build the index (more might be used if you have more)
2025-03-09 06:48:24,339 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0002 secs
2025-03-09 06:48:24,339 [INFO]: 	Selecting most promising index types given data characteristics 03/09/2025, 06:48:24
2025-03-09 06:48:24,340 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-09 06:48:24,340 [INFO]: 	Creating the index 03/09/2025, 06:48:24
2025-03-09 06:48:24,340 [INFO]: 		-> Instanciate the index HNSW15 03/09/2025, 06:48:24
2025-03-09 06:48:24,341 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0010 secs
2025-03-09 06:48:24,341 [INFO]: 		-> Adding the vectors to the index 03/09/2025, 06:48:24
2025-03-09 06:48:24,341 [INFO]: The memory available for adding the vectors is 49.5GB(total available - used by the index)
2025-03-09 06:48:24,341 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/10 [00:00<?, ?it/s] 10%|█         | 1/10 [00:00<00:02,  3.19it/s] 30%|███       | 3/10 [00:00<00:01,  6.49it/s] 50%|█████     | 5/10 [00:00<00:00,  7.99it/s] 70%|███████   | 7/10 [00:00<00:00,  9.65it/s] 90%|█████████ | 9/10 [00:01<00:00, 10.84it/s]100%|██████████| 10/10 [00:02<00:00,  3.91it/s]
2025-03-09 06:48:26,907 [INFO]: 	Computing best hyperparameters for index knn.index 03/09/2025, 06:48:26
2025-03-09 06:48:53,045 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 26.1381 secs
2025-03-09 06:48:53,045 [INFO]: The best hyperparameters are: efSearch=318
2025-03-09 06:48:53,046 [INFO]: 	Compute fast metrics 03/09/2025, 06:48:53
  0%|          | 0/4 [00:00<?, ?it/s] 25%|██▌       | 1/4 [00:00<00:00,  6.16it/s] 75%|███████▌  | 3/4 [00:00<00:00, 11.07it/s] 75%|███████▌  | 3/4 [00:00<00:00,  8.51it/s]
2025-03-09 06:49:05,458 [INFO]: 	>>> Finished "Compute fast metrics" in 12.4124 secs
2025-03-09 06:49:05,460 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 41.1191 secs
2025-03-09 06:49:05,460 [INFO]: {
2025-03-09 06:49:05,460 [INFO]: 	index_key: HNSW15
2025-03-09 06:49:05,460 [INFO]: 	index_param: efSearch=318
2025-03-09 06:49:05,460 [INFO]: 	index_path: knn.index
2025-03-09 06:49:05,460 [INFO]: 	size in bytes: 499139050
2025-03-09 06:49:05,460 [INFO]: 	avg_search_speed_ms: 9.616611649667343
2025-03-09 06:49:05,460 [INFO]: 	99p_search_speed_ms: 16.467071545775973
2025-03-09 06:49:05,460 [INFO]: 	reconstruction error %: 0.0
2025-03-09 06:49:05,460 [INFO]: 	nb vectors: 2537
2025-03-09 06:49:05,460 [INFO]: 	vectors dimension: 49152
2025-03-09 06:49:05,460 [INFO]: 	compression ratio: 0.999309703378247
2025-03-09 06:49:05,460 [INFO]: }
2025-03-09 06:49:05,460 [INFO]: 	>>> Finished "Creating the index" in 41.1206 secs
2025-03-09 06:49:05,460 [INFO]: >>> Finished "Launching the whole pipeline" in 41.1477 secs
2025-03-09 06:49:06: [retrieval_preprocessing] calculating distances ...
2025-03-09 06:49:06: [retrieval_preprocessing] finished and saved retrieval indices for episode 50433 [episode count 1/20]
[retrieval_preprocessing] for episode 50817 [episode count 2/20], we have num_retrieval=np.int64(2551) num_query=np.int64(118)
2025-03-09 06:49:07,612 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-09 06:49:07,984 [INFO]: Launching the whole pipeline 03/09/2025, 06:49:07
2025-03-09 06:49:07,985 [INFO]: Reading total number of vectors and dimension 03/09/2025, 06:49:07
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1061.04it/s]
2025-03-09 06:49:08,009 [INFO]: There are 2551 embeddings of dim 49152
2025-03-09 06:49:08,009 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0249 secs
2025-03-09 06:49:08,010 [INFO]: 	Compute estimated construction time of the index 03/09/2025, 06:49:08
2025-03-09 06:49:08,010 [INFO]: 		-> Train: 16.7 minutes
2025-03-09 06:49:08,010 [INFO]: 		-> Add: 1.4 seconds
2025-03-09 06:49:08,010 [INFO]: 		Total: 16.7 minutes
2025-03-09 06:49:08,010 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0001 secs
2025-03-09 06:49:08,010 [INFO]: 	Checking that your have enough memory available to create the index 03/09/2025, 06:49:08
2025-03-09 06:49:08,010 [INFO]: 526.5MB of memory will be needed to build the index (more might be used if you have more)
2025-03-09 06:49:08,010 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0002 secs
2025-03-09 06:49:08,010 [INFO]: 	Selecting most promising index types given data characteristics 03/09/2025, 06:49:08
2025-03-09 06:49:08,010 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-09 06:49:08,010 [INFO]: 	Creating the index 03/09/2025, 06:49:08
2025-03-09 06:49:08,010 [INFO]: 		-> Instanciate the index HNSW15 03/09/2025, 06:49:08
2025-03-09 06:49:08,011 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0011 secs
2025-03-09 06:49:08,011 [INFO]: 		-> Adding the vectors to the index 03/09/2025, 06:49:08
2025-03-09 06:49:08,011 [INFO]: The memory available for adding the vectors is 49.5GB(total available - used by the index)
2025-03-09 06:49:08,011 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/11 [00:00<?, ?it/s]  9%|▉         | 1/11 [00:00<00:01,  5.89it/s] 27%|██▋       | 3/11 [00:00<00:00,  9.32it/s] 45%|████▌     | 5/11 [00:00<00:00, 10.45it/s] 64%|██████▎   | 7/11 [00:00<00:00, 10.92it/s] 82%|████████▏ | 9/11 [00:00<00:00, 11.04it/s]100%|██████████| 11/11 [00:02<00:00,  2.86it/s]100%|██████████| 11/11 [00:02<00:00,  4.36it/s]
2025-03-09 06:49:10,536 [INFO]: 	Computing best hyperparameters for index knn.index 03/09/2025, 06:49:10
2025-03-09 06:49:37,750 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 27.2136 secs
2025-03-09 06:49:37,750 [INFO]: The best hyperparameters are: efSearch=220
2025-03-09 06:49:37,750 [INFO]: 	Compute fast metrics 03/09/2025, 06:49:37
  0%|          | 0/4 [00:00<?, ?it/s] 25%|██▌       | 1/4 [00:00<00:00,  5.99it/s] 75%|███████▌  | 3/4 [00:00<00:00,  9.72it/s] 75%|███████▌  | 3/4 [00:00<00:00,  7.74it/s]
2025-03-09 06:49:50,253 [INFO]: 	>>> Finished "Compute fast metrics" in 12.5029 secs
2025-03-09 06:49:50,255 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 42.2440 secs
2025-03-09 06:49:50,256 [INFO]: {
2025-03-09 06:49:50,256 [INFO]: 	index_key: HNSW15
2025-03-09 06:49:50,256 [INFO]: 	index_param: efSearch=220
2025-03-09 06:49:50,256 [INFO]: 	index_path: knn.index
2025-03-09 06:49:50,256 [INFO]: 	size in bytes: 501893530
2025-03-09 06:49:50,256 [INFO]: 	avg_search_speed_ms: 8.795567564158427
2025-03-09 06:49:50,256 [INFO]: 	99p_search_speed_ms: 17.411261098459438
2025-03-09 06:49:50,256 [INFO]: 	reconstruction error %: 0.0
2025-03-09 06:49:50,256 [INFO]: 	nb vectors: 2551
2025-03-09 06:49:50,256 [INFO]: 	vectors dimension: 49152
2025-03-09 06:49:50,256 [INFO]: 	compression ratio: 0.9993095706971955
2025-03-09 06:49:50,256 [INFO]: }
2025-03-09 06:49:50,256 [INFO]: 	>>> Finished "Creating the index" in 42.2457 secs
2025-03-09 06:49:50,256 [INFO]: >>> Finished "Launching the whole pipeline" in 42.2712 secs
2025-03-09 06:49:50: [retrieval_preprocessing] calculating distances ...
2025-03-09 06:49:51: [retrieval_preprocessing] finished and saved retrieval indices for episode 50817 [episode count 2/20]
[retrieval_preprocessing] for episode 54912 [episode count 3/20], we have num_retrieval=np.int64(2553) num_query=np.int64(116)
2025-03-09 06:49:51,860 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-09 06:49:52,226 [INFO]: Launching the whole pipeline 03/09/2025, 06:49:52
2025-03-09 06:49:52,226 [INFO]: Reading total number of vectors and dimension 03/09/2025, 06:49:52
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1001.27it/s]
2025-03-09 06:49:52,251 [INFO]: There are 2553 embeddings of dim 49152
2025-03-09 06:49:52,251 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0251 secs
2025-03-09 06:49:52,251 [INFO]: 	Compute estimated construction time of the index 03/09/2025, 06:49:52
2025-03-09 06:49:52,251 [INFO]: 		-> Train: 16.7 minutes
2025-03-09 06:49:52,251 [INFO]: 		-> Add: 1.4 seconds
2025-03-09 06:49:52,251 [INFO]: 		Total: 16.7 minutes
2025-03-09 06:49:52,251 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0001 secs
2025-03-09 06:49:52,251 [INFO]: 	Checking that your have enough memory available to create the index 03/09/2025, 06:49:52
2025-03-09 06:49:52,251 [INFO]: 526.9MB of memory will be needed to build the index (more might be used if you have more)
2025-03-09 06:49:52,251 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0001 secs
2025-03-09 06:49:52,251 [INFO]: 	Selecting most promising index types given data characteristics 03/09/2025, 06:49:52
2025-03-09 06:49:52,251 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-09 06:49:52,251 [INFO]: 	Creating the index 03/09/2025, 06:49:52
2025-03-09 06:49:52,251 [INFO]: 		-> Instanciate the index HNSW15 03/09/2025, 06:49:52
2025-03-09 06:49:52,252 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0009 secs
2025-03-09 06:49:52,253 [INFO]: 		-> Adding the vectors to the index 03/09/2025, 06:49:52
2025-03-09 06:49:52,253 [INFO]: The memory available for adding the vectors is 49.5GB(total available - used by the index)
2025-03-09 06:49:52,253 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/11 [00:00<?, ?it/s]  9%|▉         | 1/11 [00:00<00:01,  6.23it/s] 27%|██▋       | 3/11 [00:00<00:00,  9.23it/s] 45%|████▌     | 5/11 [00:00<00:00, 10.05it/s] 64%|██████▎   | 7/11 [00:00<00:00, 10.27it/s] 82%|████████▏ | 9/11 [00:00<00:00, 10.53it/s]100%|██████████| 11/11 [00:02<00:00,  2.87it/s]100%|██████████| 11/11 [00:02<00:00,  4.34it/s]
2025-03-09 06:49:54,790 [INFO]: 	Computing best hyperparameters for index knn.index 03/09/2025, 06:49:54
2025-03-09 06:50:23,937 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 29.1469 secs
2025-03-09 06:50:23,937 [INFO]: The best hyperparameters are: efSearch=267
2025-03-09 06:50:23,937 [INFO]: 	Compute fast metrics 03/09/2025, 06:50:23
  0%|          | 0/4 [00:00<?, ?it/s] 25%|██▌       | 1/4 [00:00<00:02,  1.02it/s] 50%|█████     | 2/4 [00:01<00:01,  1.24it/s] 75%|███████▌  | 3/4 [00:02<00:00,  1.44it/s] 75%|███████▌  | 3/4 [00:02<00:00,  1.24it/s]
2025-03-09 06:50:39,463 [INFO]: 	>>> Finished "Compute fast metrics" in 15.5251 secs
2025-03-09 06:50:39,465 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 47.2122 secs
2025-03-09 06:50:39,465 [INFO]: {
2025-03-09 06:50:39,465 [INFO]: 	index_key: HNSW15
2025-03-09 06:50:39,465 [INFO]: 	index_param: efSearch=267
2025-03-09 06:50:39,465 [INFO]: 	index_path: knn.index
2025-03-09 06:50:39,465 [INFO]: 	size in bytes: 502287010
2025-03-09 06:50:39,465 [INFO]: 	avg_search_speed_ms: 9.13857815764211
2025-03-09 06:50:39,465 [INFO]: 	99p_search_speed_ms: 16.598873911425468
2025-03-09 06:50:39,465 [INFO]: 	reconstruction error %: 0.0
2025-03-09 06:50:39,465 [INFO]: 	nb vectors: 2553
2025-03-09 06:50:39,465 [INFO]: 	vectors dimension: 49152
2025-03-09 06:50:39,465 [INFO]: 	compression ratio: 0.9993095859675926
2025-03-09 06:50:39,465 [INFO]: }
2025-03-09 06:50:39,465 [INFO]: 	>>> Finished "Creating the index" in 47.2136 secs
2025-03-09 06:50:39,465 [INFO]: >>> Finished "Launching the whole pipeline" in 47.2393 secs
2025-03-09 06:50:40: [retrieval_preprocessing] calculating distances ...
2025-03-09 06:50:40: [retrieval_preprocessing] finished and saved retrieval indices for episode 54912 [episode count 3/20]
[retrieval_preprocessing] for episode 89603 [episode count 4/20], we have num_retrieval=np.int64(2550) num_query=np.int64(119)
2025-03-09 06:50:41,651 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-09 06:50:41,999 [INFO]: Launching the whole pipeline 03/09/2025, 06:50:41
2025-03-09 06:50:41,999 [INFO]: Reading total number of vectors and dimension 03/09/2025, 06:50:41
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1276.03it/s]
2025-03-09 06:50:42,022 [INFO]: There are 2550 embeddings of dim 49152
2025-03-09 06:50:42,023 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0234 secs
2025-03-09 06:50:42,023 [INFO]: 	Compute estimated construction time of the index 03/09/2025, 06:50:42
2025-03-09 06:50:42,023 [INFO]: 		-> Train: 16.7 minutes
2025-03-09 06:50:42,023 [INFO]: 		-> Add: 1.4 seconds
2025-03-09 06:50:42,023 [INFO]: 		Total: 16.7 minutes
2025-03-09 06:50:42,023 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0001 secs
2025-03-09 06:50:42,023 [INFO]: 	Checking that your have enough memory available to create the index 03/09/2025, 06:50:42
2025-03-09 06:50:42,023 [INFO]: 526.3MB of memory will be needed to build the index (more might be used if you have more)
2025-03-09 06:50:42,023 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0001 secs
2025-03-09 06:50:42,023 [INFO]: 	Selecting most promising index types given data characteristics 03/09/2025, 06:50:42
2025-03-09 06:50:42,023 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-09 06:50:42,023 [INFO]: 	Creating the index 03/09/2025, 06:50:42
2025-03-09 06:50:42,023 [INFO]: 		-> Instanciate the index HNSW15 03/09/2025, 06:50:42
2025-03-09 06:50:42,024 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0009 secs
2025-03-09 06:50:42,024 [INFO]: 		-> Adding the vectors to the index 03/09/2025, 06:50:42
2025-03-09 06:50:42,024 [INFO]: The memory available for adding the vectors is 49.5GB(total available - used by the index)
2025-03-09 06:50:42,024 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/11 [00:00<?, ?it/s]  9%|▉         | 1/11 [00:00<00:01,  6.13it/s] 27%|██▋       | 3/11 [00:00<00:00,  9.41it/s] 45%|████▌     | 5/11 [00:00<00:00, 10.59it/s] 64%|██████▎   | 7/11 [00:00<00:00, 11.05it/s] 82%|████████▏ | 9/11 [00:00<00:00, 11.26it/s]100%|██████████| 11/11 [00:02<00:00,  2.52it/s]100%|██████████| 11/11 [00:02<00:00,  3.95it/s]
2025-03-09 06:50:44,809 [INFO]: 	Computing best hyperparameters for index knn.index 03/09/2025, 06:50:44
2025-03-09 06:51:10,981 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 26.1718 secs
2025-03-09 06:51:10,981 [INFO]: The best hyperparameters are: efSearch=310
2025-03-09 06:51:10,981 [INFO]: 	Compute fast metrics 03/09/2025, 06:51:10
  0%|          | 0/4 [00:00<?, ?it/s] 25%|██▌       | 1/4 [00:00<00:00,  5.68it/s] 50%|█████     | 2/4 [00:00<00:00,  7.21it/s] 75%|███████▌  | 3/4 [00:00<00:00,  7.30it/s] 75%|███████▌  | 3/4 [00:00<00:00,  5.50it/s]
2025-03-09 06:51:23,831 [INFO]: 	>>> Finished "Compute fast metrics" in 12.8496 secs
2025-03-09 06:51:23,833 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 41.8084 secs
2025-03-09 06:51:23,833 [INFO]: {
2025-03-09 06:51:23,833 [INFO]: 	index_key: HNSW15
2025-03-09 06:51:23,833 [INFO]: 	index_param: efSearch=310
2025-03-09 06:51:23,833 [INFO]: 	index_path: knn.index
2025-03-09 06:51:23,833 [INFO]: 	size in bytes: 501696790
2025-03-09 06:51:23,833 [INFO]: 	avg_search_speed_ms: 10.731656410603469
2025-03-09 06:51:23,833 [INFO]: 	99p_search_speed_ms: 18.390318581368742
2025-03-09 06:51:23,833 [INFO]: 	reconstruction error %: 0.0
2025-03-09 06:51:23,833 [INFO]: 	nb vectors: 2550
2025-03-09 06:51:23,833 [INFO]: 	vectors dimension: 49152
2025-03-09 06:51:23,833 [INFO]: 	compression ratio: 0.9993095630530145
2025-03-09 06:51:23,833 [INFO]: }
2025-03-09 06:51:23,833 [INFO]: 	>>> Finished "Creating the index" in 41.8097 secs
2025-03-09 06:51:23,833 [INFO]: >>> Finished "Launching the whole pipeline" in 41.8338 secs
2025-03-09 06:51:24: [retrieval_preprocessing] calculating distances ...
2025-03-09 06:51:25: [retrieval_preprocessing] finished and saved retrieval indices for episode 89603 [episode count 4/20]
[retrieval_preprocessing] for episode 94208 [episode count 5/20], we have num_retrieval=np.int64(2562) num_query=np.int64(107)
2025-03-09 06:51:25,740 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-09 06:51:26,096 [INFO]: Launching the whole pipeline 03/09/2025, 06:51:26
2025-03-09 06:51:26,096 [INFO]: Reading total number of vectors and dimension 03/09/2025, 06:51:26
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1903.91it/s]
2025-03-09 06:51:26,118 [INFO]: There are 2562 embeddings of dim 49152
2025-03-09 06:51:26,118 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0226 secs
2025-03-09 06:51:26,118 [INFO]: 	Compute estimated construction time of the index 03/09/2025, 06:51:26
2025-03-09 06:51:26,119 [INFO]: 		-> Train: 16.7 minutes
2025-03-09 06:51:26,119 [INFO]: 		-> Add: 1.4 seconds
2025-03-09 06:51:26,119 [INFO]: 		Total: 16.7 minutes
2025-03-09 06:51:26,119 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0001 secs
2025-03-09 06:51:26,119 [INFO]: 	Checking that your have enough memory available to create the index 03/09/2025, 06:51:26
2025-03-09 06:51:26,119 [INFO]: 528.7MB of memory will be needed to build the index (more might be used if you have more)
2025-03-09 06:51:26,119 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0002 secs
2025-03-09 06:51:26,119 [INFO]: 	Selecting most promising index types given data characteristics 03/09/2025, 06:51:26
2025-03-09 06:51:26,119 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-09 06:51:26,119 [INFO]: 	Creating the index 03/09/2025, 06:51:26
2025-03-09 06:51:26,119 [INFO]: 		-> Instanciate the index HNSW15 03/09/2025, 06:51:26
2025-03-09 06:51:26,120 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0010 secs
2025-03-09 06:51:26,120 [INFO]: 		-> Adding the vectors to the index 03/09/2025, 06:51:26
2025-03-09 06:51:26,120 [INFO]: The memory available for adding the vectors is 49.5GB(total available - used by the index)
2025-03-09 06:51:26,120 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/11 [00:00<?, ?it/s]  9%|▉         | 1/11 [00:00<00:01,  5.72it/s] 18%|█▊        | 2/11 [00:00<00:01,  7.24it/s] 27%|██▋       | 3/11 [00:00<00:01,  7.75it/s] 36%|███▋      | 4/11 [00:00<00:00,  8.01it/s] 45%|████▌     | 5/11 [00:00<00:00,  8.26it/s] 55%|█████▍    | 6/11 [00:00<00:00,  8.30it/s] 64%|██████▎   | 7/11 [00:00<00:00,  8.34it/s] 73%|███████▎  | 8/11 [00:00<00:00,  8.43it/s] 82%|████████▏ | 9/11 [00:01<00:00,  8.41it/s] 91%|█████████ | 10/11 [00:01<00:00,  8.51it/s]100%|██████████| 11/11 [00:02<00:00,  1.69it/s]100%|██████████| 11/11 [00:02<00:00,  3.80it/s]
2025-03-09 06:51:29,015 [INFO]: 	Computing best hyperparameters for index knn.index 03/09/2025, 06:51:29
2025-03-09 06:51:58,221 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 29.2052 secs
2025-03-09 06:51:58,221 [INFO]: The best hyperparameters are: efSearch=318
2025-03-09 06:51:58,221 [INFO]: 	Compute fast metrics 03/09/2025, 06:51:58
  0%|          | 0/4 [00:00<?, ?it/s] 25%|██▌       | 1/4 [00:00<00:00,  5.44it/s] 75%|███████▌  | 3/4 [00:00<00:00,  8.45it/s] 75%|███████▌  | 3/4 [00:00<00:00,  6.45it/s]
2025-03-09 06:52:10,541 [INFO]: 	>>> Finished "Compute fast metrics" in 12.3199 secs
2025-03-09 06:52:10,543 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 44.4229 secs
2025-03-09 06:52:10,543 [INFO]: {
2025-03-09 06:52:10,543 [INFO]: 	index_key: HNSW15
2025-03-09 06:52:10,543 [INFO]: 	index_param: efSearch=318
2025-03-09 06:52:10,543 [INFO]: 	index_path: knn.index
2025-03-09 06:52:10,543 [INFO]: 	size in bytes: 504057670
2025-03-09 06:52:10,543 [INFO]: 	avg_search_speed_ms: 10.373669113003537
2025-03-09 06:52:10,543 [INFO]: 	99p_search_speed_ms: 17.948520120698966
2025-03-09 06:52:10,543 [INFO]: 	reconstruction error %: 0.0
2025-03-09 06:52:10,543 [INFO]: 	nb vectors: 2562
2025-03-09 06:52:10,543 [INFO]: 	vectors dimension: 49152
2025-03-09 06:52:10,543 [INFO]: 	compression ratio: 0.9993096543893479
2025-03-09 06:52:10,543 [INFO]: }
2025-03-09 06:52:10,543 [INFO]: 	>>> Finished "Creating the index" in 44.4244 secs
2025-03-09 06:52:10,543 [INFO]: >>> Finished "Launching the whole pipeline" in 44.4476 secs
2025-03-09 06:52:11: [retrieval_preprocessing] calculating distances ...
2025-03-09 06:52:11: [retrieval_preprocessing] finished and saved retrieval indices for episode 94208 [episode count 5/20]
[retrieval_preprocessing] for episode 4487 [episode count 6/20], we have num_retrieval=np.int64(2543) num_query=np.int64(126)
2025-03-09 06:52:12,324 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-09 06:52:12,720 [INFO]: Launching the whole pipeline 03/09/2025, 06:52:12
2025-03-09 06:52:12,720 [INFO]: Reading total number of vectors and dimension 03/09/2025, 06:52:12
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1178.84it/s]
2025-03-09 06:52:12,747 [INFO]: There are 2543 embeddings of dim 49152
2025-03-09 06:52:12,747 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0266 secs
2025-03-09 06:52:12,747 [INFO]: 	Compute estimated construction time of the index 03/09/2025, 06:52:12
2025-03-09 06:52:12,747 [INFO]: 		-> Train: 16.7 minutes
2025-03-09 06:52:12,747 [INFO]: 		-> Add: 1.4 seconds
2025-03-09 06:52:12,747 [INFO]: 		Total: 16.7 minutes
2025-03-09 06:52:12,747 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0001 secs
2025-03-09 06:52:12,747 [INFO]: 	Checking that your have enough memory available to create the index 03/09/2025, 06:52:12
2025-03-09 06:52:12,747 [INFO]: 524.8MB of memory will be needed to build the index (more might be used if you have more)
2025-03-09 06:52:12,747 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0001 secs
2025-03-09 06:52:12,747 [INFO]: 	Selecting most promising index types given data characteristics 03/09/2025, 06:52:12
2025-03-09 06:52:12,748 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-09 06:52:12,748 [INFO]: 	Creating the index 03/09/2025, 06:52:12
2025-03-09 06:52:12,748 [INFO]: 		-> Instanciate the index HNSW15 03/09/2025, 06:52:12
2025-03-09 06:52:12,749 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0010 secs
2025-03-09 06:52:12,749 [INFO]: 		-> Adding the vectors to the index 03/09/2025, 06:52:12
2025-03-09 06:52:12,749 [INFO]: The memory available for adding the vectors is 49.5GB(total available - used by the index)
2025-03-09 06:52:12,749 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/11 [00:00<?, ?it/s]  9%|▉         | 1/11 [00:00<00:01,  6.00it/s] 18%|█▊        | 2/11 [00:00<00:01,  7.61it/s] 27%|██▋       | 3/11 [00:00<00:01,  7.12it/s] 45%|████▌     | 5/11 [00:00<00:00,  8.57it/s] 55%|█████▍    | 6/11 [00:00<00:00,  8.87it/s] 64%|██████▎   | 7/11 [00:00<00:00,  9.06it/s] 73%|███████▎  | 8/11 [00:00<00:00,  9.10it/s] 82%|████████▏ | 9/11 [00:01<00:00,  8.90it/s] 91%|█████████ | 10/11 [00:01<00:00,  8.38it/s]100%|██████████| 11/11 [00:03<00:00,  1.52it/s]100%|██████████| 11/11 [00:03<00:00,  3.53it/s]
2025-03-09 06:52:15,867 [INFO]: 	Computing best hyperparameters for index knn.index 03/09/2025, 06:52:15
2025-03-09 06:52:41,155 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 25.2878 secs
2025-03-09 06:52:41,155 [INFO]: The best hyperparameters are: efSearch=320
2025-03-09 06:52:41,155 [INFO]: 	Compute fast metrics 03/09/2025, 06:52:41
  0%|          | 0/4 [00:00<?, ?it/s] 25%|██▌       | 1/4 [00:00<00:00,  5.75it/s] 75%|███████▌  | 3/4 [00:00<00:00,  8.40it/s] 75%|███████▌  | 3/4 [00:00<00:00,  6.48it/s]
2025-03-09 06:52:53,697 [INFO]: 	>>> Finished "Compute fast metrics" in 12.5420 secs
2025-03-09 06:52:53,700 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 40.9512 secs
2025-03-09 06:52:53,700 [INFO]: {
2025-03-09 06:52:53,700 [INFO]: 	index_key: HNSW15
2025-03-09 06:52:53,700 [INFO]: 	index_param: efSearch=320
2025-03-09 06:52:53,700 [INFO]: 	index_path: knn.index
2025-03-09 06:52:53,700 [INFO]: 	size in bytes: 500319490
2025-03-09 06:52:53,700 [INFO]: 	avg_search_speed_ms: 9.996697263326496
2025-03-09 06:52:53,700 [INFO]: 	99p_search_speed_ms: 14.853059488814322
2025-03-09 06:52:53,700 [INFO]: 	reconstruction error %: 0.0
2025-03-09 06:52:53,700 [INFO]: 	nb vectors: 2543
2025-03-09 06:52:53,700 [INFO]: 	vectors dimension: 49152
2025-03-09 06:52:53,700 [INFO]: 	compression ratio: 0.9993097490565479
2025-03-09 06:52:53,700 [INFO]: }
2025-03-09 06:52:53,700 [INFO]: 	>>> Finished "Creating the index" in 40.9527 secs
2025-03-09 06:52:53,700 [INFO]: >>> Finished "Launching the whole pipeline" in 40.9801 secs
2025-03-09 06:52:54: [retrieval_preprocessing] calculating distances ...
2025-03-09 06:52:55: [retrieval_preprocessing] finished and saved retrieval indices for episode 4487 [episode count 6/20]
[retrieval_preprocessing] for episode 70408 [episode count 7/20], we have num_retrieval=np.int64(2537) num_query=np.int64(132)
2025-03-09 06:52:55,804 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-09 06:52:56,175 [INFO]: Launching the whole pipeline 03/09/2025, 06:52:56
2025-03-09 06:52:56,175 [INFO]: Reading total number of vectors and dimension 03/09/2025, 06:52:56
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1782.53it/s]
2025-03-09 06:52:56,199 [INFO]: There are 2537 embeddings of dim 49152
2025-03-09 06:52:56,199 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0238 secs
2025-03-09 06:52:56,199 [INFO]: 	Compute estimated construction time of the index 03/09/2025, 06:52:56
2025-03-09 06:52:56,199 [INFO]: 		-> Train: 16.7 minutes
2025-03-09 06:52:56,199 [INFO]: 		-> Add: 1.4 seconds
2025-03-09 06:52:56,199 [INFO]: 		Total: 16.7 minutes
2025-03-09 06:52:56,200 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0006 secs
2025-03-09 06:52:56,200 [INFO]: 	Checking that your have enough memory available to create the index 03/09/2025, 06:52:56
2025-03-09 06:52:56,200 [INFO]: 523.6MB of memory will be needed to build the index (more might be used if you have more)
2025-03-09 06:52:56,200 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0001 secs
2025-03-09 06:52:56,200 [INFO]: 	Selecting most promising index types given data characteristics 03/09/2025, 06:52:56
2025-03-09 06:52:56,200 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-09 06:52:56,200 [INFO]: 	Creating the index 03/09/2025, 06:52:56
2025-03-09 06:52:56,200 [INFO]: 		-> Instanciate the index HNSW15 03/09/2025, 06:52:56
2025-03-09 06:52:56,201 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0009 secs
2025-03-09 06:52:56,201 [INFO]: 		-> Adding the vectors to the index 03/09/2025, 06:52:56
2025-03-09 06:52:56,201 [INFO]: The memory available for adding the vectors is 49.5GB(total available - used by the index)
2025-03-09 06:52:56,201 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/10 [00:00<?, ?it/s] 10%|█         | 1/10 [00:00<00:01,  6.73it/s] 30%|███       | 3/10 [00:00<00:00,  9.97it/s] 50%|█████     | 5/10 [00:00<00:00, 11.08it/s] 70%|███████   | 7/10 [00:00<00:00, 13.02it/s] 90%|█████████ | 9/10 [00:00<00:00, 14.23it/s]100%|██████████| 10/10 [00:02<00:00,  4.25it/s]
2025-03-09 06:52:58,562 [INFO]: 	Computing best hyperparameters for index knn.index 03/09/2025, 06:52:58
2025-03-09 06:53:26,321 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 27.7585 secs
2025-03-09 06:53:26,321 [INFO]: The best hyperparameters are: efSearch=343
2025-03-09 06:53:26,321 [INFO]: 	Compute fast metrics 03/09/2025, 06:53:26
  0%|          | 0/4 [00:00<?, ?it/s] 25%|██▌       | 1/4 [00:00<00:02,  1.34it/s] 75%|███████▌  | 3/4 [00:00<00:00,  3.92it/s] 75%|███████▌  | 3/4 [00:00<00:00,  3.02it/s]
2025-03-09 06:53:40,106 [INFO]: 	>>> Finished "Compute fast metrics" in 13.7847 secs
2025-03-09 06:53:40,108 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 43.9069 secs
2025-03-09 06:53:40,108 [INFO]: {
2025-03-09 06:53:40,108 [INFO]: 	index_key: HNSW15
2025-03-09 06:53:40,108 [INFO]: 	index_param: efSearch=343
2025-03-09 06:53:40,108 [INFO]: 	index_path: knn.index
2025-03-09 06:53:40,108 [INFO]: 	size in bytes: 499139050
2025-03-09 06:53:40,108 [INFO]: 	avg_search_speed_ms: 10.616755319636654
2025-03-09 06:53:40,108 [INFO]: 	99p_search_speed_ms: 17.769680668134264
2025-03-09 06:53:40,108 [INFO]: 	reconstruction error %: 0.0
2025-03-09 06:53:40,108 [INFO]: 	nb vectors: 2537
2025-03-09 06:53:40,108 [INFO]: 	vectors dimension: 49152
2025-03-09 06:53:40,108 [INFO]: 	compression ratio: 0.999309703378247
2025-03-09 06:53:40,108 [INFO]: }
2025-03-09 06:53:40,108 [INFO]: 	>>> Finished "Creating the index" in 43.9083 secs
2025-03-09 06:53:40,108 [INFO]: >>> Finished "Launching the whole pipeline" in 43.9332 secs
2025-03-09 06:53:41: [retrieval_preprocessing] calculating distances ...
2025-03-09 06:53:42: [retrieval_preprocessing] finished and saved retrieval indices for episode 70408 [episode count 7/20]
[retrieval_preprocessing] for episode 76300 [episode count 8/20], we have num_retrieval=np.int64(2524) num_query=np.int64(145)
2025-03-09 06:53:43,089 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-09 06:53:43,411 [INFO]: Launching the whole pipeline 03/09/2025, 06:53:43
2025-03-09 06:53:43,411 [INFO]: Reading total number of vectors and dimension 03/09/2025, 06:53:43
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 990.39it/s]
2025-03-09 06:53:43,435 [INFO]: There are 2524 embeddings of dim 49152
2025-03-09 06:53:43,436 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0249 secs
2025-03-09 06:53:43,436 [INFO]: 	Compute estimated construction time of the index 03/09/2025, 06:53:43
2025-03-09 06:53:43,436 [INFO]: 		-> Train: 16.7 minutes
2025-03-09 06:53:43,436 [INFO]: 		-> Add: 1.4 seconds
2025-03-09 06:53:43,436 [INFO]: 		Total: 16.7 minutes
2025-03-09 06:53:43,436 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0001 secs
2025-03-09 06:53:43,436 [INFO]: 	Checking that your have enough memory available to create the index 03/09/2025, 06:53:43
2025-03-09 06:53:43,436 [INFO]: 520.9MB of memory will be needed to build the index (more might be used if you have more)
2025-03-09 06:53:43,436 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0001 secs
2025-03-09 06:53:43,436 [INFO]: 	Selecting most promising index types given data characteristics 03/09/2025, 06:53:43
2025-03-09 06:53:43,436 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-09 06:53:43,436 [INFO]: 	Creating the index 03/09/2025, 06:53:43
2025-03-09 06:53:43,436 [INFO]: 		-> Instanciate the index HNSW15 03/09/2025, 06:53:43
2025-03-09 06:53:43,437 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0009 secs
2025-03-09 06:53:43,437 [INFO]: 		-> Adding the vectors to the index 03/09/2025, 06:53:43
2025-03-09 06:53:43,437 [INFO]: The memory available for adding the vectors is 49.5GB(total available - used by the index)
2025-03-09 06:53:43,437 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/10 [00:00<?, ?it/s] 10%|█         | 1/10 [00:00<00:01,  4.74it/s] 30%|███       | 3/10 [00:00<00:00,  8.54it/s] 50%|█████     | 5/10 [00:00<00:00, 10.72it/s] 70%|███████   | 7/10 [00:00<00:00, 10.98it/s] 90%|█████████ | 9/10 [00:00<00:00, 13.16it/s]100%|██████████| 10/10 [00:02<00:00,  4.31it/s]
2025-03-09 06:53:45,767 [INFO]: 	Computing best hyperparameters for index knn.index 03/09/2025, 06:53:45
2025-03-09 06:54:08,919 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 23.1511 secs
2025-03-09 06:54:08,919 [INFO]: The best hyperparameters are: efSearch=339
2025-03-09 06:54:08,919 [INFO]: 	Compute fast metrics 03/09/2025, 06:54:08
  0%|          | 0/4 [00:00<?, ?it/s] 25%|██▌       | 1/4 [00:00<00:00,  5.63it/s] 75%|███████▌  | 3/4 [00:00<00:00, 10.53it/s] 75%|███████▌  | 3/4 [00:00<00:00,  7.87it/s]
2025-03-09 06:54:22,501 [INFO]: 	>>> Finished "Compute fast metrics" in 13.5819 secs
2025-03-09 06:54:22,503 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 39.0660 secs
2025-03-09 06:54:22,503 [INFO]: {
2025-03-09 06:54:22,503 [INFO]: 	index_key: HNSW15
2025-03-09 06:54:22,503 [INFO]: 	index_param: efSearch=339
2025-03-09 06:54:22,503 [INFO]: 	index_path: knn.index
2025-03-09 06:54:22,503 [INFO]: 	size in bytes: 496581310
2025-03-09 06:54:22,503 [INFO]: 	avg_search_speed_ms: 9.36420000710242
2025-03-09 06:54:22,503 [INFO]: 	99p_search_speed_ms: 15.572907193563852
2025-03-09 06:54:22,503 [INFO]: 	reconstruction error %: 0.0
2025-03-09 06:54:22,503 [INFO]: 	nb vectors: 2524
2025-03-09 06:54:22,503 [INFO]: 	vectors dimension: 49152
2025-03-09 06:54:22,503 [INFO]: 	compression ratio: 0.999309845149025
2025-03-09 06:54:22,503 [INFO]: }
2025-03-09 06:54:22,503 [INFO]: 	>>> Finished "Creating the index" in 39.0673 secs
2025-03-09 06:54:22,503 [INFO]: >>> Finished "Launching the whole pipeline" in 39.0928 secs
2025-03-09 06:54:23: [retrieval_preprocessing] calculating distances ...
2025-03-09 06:54:24: [retrieval_preprocessing] finished and saved retrieval indices for episode 76300 [episode count 8/20]
[retrieval_preprocessing] for episode 82062 [episode count 9/20], we have num_retrieval=np.int64(2528) num_query=np.int64(141)
2025-03-09 06:54:24,694 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-09 06:54:25,048 [INFO]: Launching the whole pipeline 03/09/2025, 06:54:25
2025-03-09 06:54:25,048 [INFO]: Reading total number of vectors and dimension 03/09/2025, 06:54:25
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1420.35it/s]
2025-03-09 06:54:25,072 [INFO]: There are 2528 embeddings of dim 49152
2025-03-09 06:54:25,072 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0237 secs
2025-03-09 06:54:25,072 [INFO]: 	Compute estimated construction time of the index 03/09/2025, 06:54:25
2025-03-09 06:54:25,072 [INFO]: 		-> Train: 16.7 minutes
2025-03-09 06:54:25,072 [INFO]: 		-> Add: 1.4 seconds
2025-03-09 06:54:25,072 [INFO]: 		Total: 16.7 minutes
2025-03-09 06:54:25,072 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0001 secs
2025-03-09 06:54:25,072 [INFO]: 	Checking that your have enough memory available to create the index 03/09/2025, 06:54:25
2025-03-09 06:54:25,072 [INFO]: 521.7MB of memory will be needed to build the index (more might be used if you have more)
2025-03-09 06:54:25,072 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0001 secs
2025-03-09 06:54:25,072 [INFO]: 	Selecting most promising index types given data characteristics 03/09/2025, 06:54:25
2025-03-09 06:54:25,072 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-09 06:54:25,072 [INFO]: 	Creating the index 03/09/2025, 06:54:25
2025-03-09 06:54:25,072 [INFO]: 		-> Instanciate the index HNSW15 03/09/2025, 06:54:25
2025-03-09 06:54:25,073 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0011 secs
2025-03-09 06:54:25,073 [INFO]: 		-> Adding the vectors to the index 03/09/2025, 06:54:25
2025-03-09 06:54:25,073 [INFO]: The memory available for adding the vectors is 49.5GB(total available - used by the index)
2025-03-09 06:54:25,074 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/10 [00:00<?, ?it/s] 10%|█         | 1/10 [00:00<00:01,  6.74it/s] 30%|███       | 3/10 [00:00<00:00, 11.94it/s] 50%|█████     | 5/10 [00:00<00:00, 13.36it/s] 70%|███████   | 7/10 [00:00<00:00, 14.50it/s] 90%|█████████ | 9/10 [00:00<00:00, 14.82it/s]100%|██████████| 10/10 [00:02<00:00,  4.23it/s]
2025-03-09 06:54:27,447 [INFO]: 	Computing best hyperparameters for index knn.index 03/09/2025, 06:54:27
2025-03-09 06:54:51,422 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 23.9749 secs
2025-03-09 06:54:51,422 [INFO]: The best hyperparameters are: efSearch=363
2025-03-09 06:54:51,422 [INFO]: 	Compute fast metrics 03/09/2025, 06:54:51
  0%|          | 0/4 [00:00<?, ?it/s] 25%|██▌       | 1/4 [00:00<00:00,  5.19it/s] 50%|█████     | 2/4 [00:00<00:00,  6.84it/s] 75%|███████▌  | 3/4 [00:00<00:00,  7.52it/s] 75%|███████▌  | 3/4 [00:00<00:00,  5.68it/s]
2025-03-09 06:55:03,963 [INFO]: 	>>> Finished "Compute fast metrics" in 12.5403 secs
2025-03-09 06:55:03,964 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 38.8910 secs
2025-03-09 06:55:03,965 [INFO]: {
2025-03-09 06:55:03,965 [INFO]: 	index_key: HNSW15
2025-03-09 06:55:03,965 [INFO]: 	index_param: efSearch=363
2025-03-09 06:55:03,965 [INFO]: 	index_path: knn.index
2025-03-09 06:55:03,965 [INFO]: 	size in bytes: 497368330
2025-03-09 06:55:03,965 [INFO]: 	avg_search_speed_ms: 9.449690774466934
2025-03-09 06:55:03,965 [INFO]: 	99p_search_speed_ms: 11.993884446565062
2025-03-09 06:55:03,965 [INFO]: 	reconstruction error %: 0.0
2025-03-09 06:55:03,965 [INFO]: 	nb vectors: 2528
2025-03-09 06:55:03,965 [INFO]: 	vectors dimension: 49152
2025-03-09 06:55:03,965 [INFO]: 	compression ratio: 0.9993097550059128
2025-03-09 06:55:03,965 [INFO]: }
2025-03-09 06:55:03,965 [INFO]: 	>>> Finished "Creating the index" in 38.8925 secs
2025-03-09 06:55:03,965 [INFO]: >>> Finished "Launching the whole pipeline" in 38.9167 secs
2025-03-09 06:55:05: [retrieval_preprocessing] calculating distances ...
2025-03-09 06:55:06: [retrieval_preprocessing] finished and saved retrieval indices for episode 82062 [episode count 9/20]
[retrieval_preprocessing] for episode 4496 [episode count 10/20], we have num_retrieval=np.int64(2570) num_query=np.int64(99)
2025-03-09 06:55:06,763 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-09 06:55:07,126 [INFO]: Launching the whole pipeline 03/09/2025, 06:55:07
2025-03-09 06:55:07,126 [INFO]: Reading total number of vectors and dimension 03/09/2025, 06:55:07
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 2884.67it/s]
2025-03-09 06:55:07,149 [INFO]: There are 2570 embeddings of dim 49152
2025-03-09 06:55:07,149 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0232 secs
2025-03-09 06:55:07,149 [INFO]: 	Compute estimated construction time of the index 03/09/2025, 06:55:07
2025-03-09 06:55:07,149 [INFO]: 		-> Train: 16.7 minutes
2025-03-09 06:55:07,149 [INFO]: 		-> Add: 1.4 seconds
2025-03-09 06:55:07,149 [INFO]: 		Total: 16.7 minutes
2025-03-09 06:55:07,149 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0001 secs
2025-03-09 06:55:07,149 [INFO]: 	Checking that your have enough memory available to create the index 03/09/2025, 06:55:07
2025-03-09 06:55:07,150 [INFO]: 530.4MB of memory will be needed to build the index (more might be used if you have more)
2025-03-09 06:55:07,150 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0001 secs
2025-03-09 06:55:07,150 [INFO]: 	Selecting most promising index types given data characteristics 03/09/2025, 06:55:07
2025-03-09 06:55:07,150 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-09 06:55:07,150 [INFO]: 	Creating the index 03/09/2025, 06:55:07
2025-03-09 06:55:07,150 [INFO]: 		-> Instanciate the index HNSW15 03/09/2025, 06:55:07
2025-03-09 06:55:07,151 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0011 secs
2025-03-09 06:55:07,151 [INFO]: 		-> Adding the vectors to the index 03/09/2025, 06:55:07
2025-03-09 06:55:07,151 [INFO]: The memory available for adding the vectors is 49.5GB(total available - used by the index)
2025-03-09 06:55:07,151 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/11 [00:00<?, ?it/s]  9%|▉         | 1/11 [00:00<00:01,  6.46it/s] 27%|██▋       | 3/11 [00:00<00:00, 12.12it/s] 45%|████▌     | 5/11 [00:00<00:00,  9.46it/s] 64%|██████▎   | 7/11 [00:00<00:00, 11.50it/s] 82%|████████▏ | 9/11 [00:00<00:00, 12.80it/s]100%|██████████| 11/11 [00:02<00:00,  2.88it/s]100%|██████████| 11/11 [00:02<00:00,  4.45it/s]
2025-03-09 06:55:09,627 [INFO]: 	Computing best hyperparameters for index knn.index 03/09/2025, 06:55:09
2025-03-09 06:55:36,475 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 26.8479 secs
2025-03-09 06:55:36,475 [INFO]: The best hyperparameters are: efSearch=308
2025-03-09 06:55:36,475 [INFO]: 	Compute fast metrics 03/09/2025, 06:55:36
  0%|          | 0/4 [00:00<?, ?it/s] 25%|██▌       | 1/4 [00:00<00:00,  5.71it/s] 75%|███████▌  | 3/4 [00:00<00:00,  9.14it/s] 75%|███████▌  | 3/4 [00:00<00:00,  6.97it/s]
2025-03-09 06:55:49,191 [INFO]: 	>>> Finished "Compute fast metrics" in 12.7153 secs
2025-03-09 06:55:49,193 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 42.0421 secs
2025-03-09 06:55:49,193 [INFO]: {
2025-03-09 06:55:49,193 [INFO]: 	index_key: HNSW15
2025-03-09 06:55:49,193 [INFO]: 	index_param: efSearch=308
2025-03-09 06:55:49,193 [INFO]: 	index_path: knn.index
2025-03-09 06:55:49,193 [INFO]: 	size in bytes: 505631590
2025-03-09 06:55:49,193 [INFO]: 	avg_search_speed_ms: 9.866008509769742
2025-03-09 06:55:49,193 [INFO]: 	99p_search_speed_ms: 16.7462085490115
2025-03-09 06:55:49,193 [INFO]: 	reconstruction error %: 0.0
2025-03-09 06:55:49,193 [INFO]: 	nb vectors: 2570
2025-03-09 06:55:49,193 [INFO]: 	vectors dimension: 49152
2025-03-09 06:55:49,193 [INFO]: 	compression ratio: 0.999309714806387
2025-03-09 06:55:49,193 [INFO]: }
2025-03-09 06:55:49,193 [INFO]: 	>>> Finished "Creating the index" in 42.0437 secs
2025-03-09 06:55:49,193 [INFO]: >>> Finished "Launching the whole pipeline" in 42.0674 secs
2025-03-09 06:55:49: [retrieval_preprocessing] calculating distances ...
2025-03-09 06:55:50: [retrieval_preprocessing] finished and saved retrieval indices for episode 4496 [episode count 10/20]
[retrieval_preprocessing] for episode 10771 [episode count 11/20], we have num_retrieval=np.int64(2544) num_query=np.int64(125)
2025-03-09 06:55:51,222 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-09 06:55:51,583 [INFO]: Launching the whole pipeline 03/09/2025, 06:55:51
2025-03-09 06:55:51,584 [INFO]: Reading total number of vectors and dimension 03/09/2025, 06:55:51
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1267.16it/s]
2025-03-09 06:55:51,609 [INFO]: There are 2544 embeddings of dim 49152
2025-03-09 06:55:51,609 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0252 secs
2025-03-09 06:55:51,609 [INFO]: 	Compute estimated construction time of the index 03/09/2025, 06:55:51
2025-03-09 06:55:51,609 [INFO]: 		-> Train: 16.7 minutes
2025-03-09 06:55:51,609 [INFO]: 		-> Add: 1.4 seconds
2025-03-09 06:55:51,609 [INFO]: 		Total: 16.7 minutes
2025-03-09 06:55:51,609 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0001 secs
2025-03-09 06:55:51,609 [INFO]: 	Checking that your have enough memory available to create the index 03/09/2025, 06:55:51
2025-03-09 06:55:51,609 [INFO]: 525.0MB of memory will be needed to build the index (more might be used if you have more)
2025-03-09 06:55:51,609 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0001 secs
2025-03-09 06:55:51,609 [INFO]: 	Selecting most promising index types given data characteristics 03/09/2025, 06:55:51
2025-03-09 06:55:51,609 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-09 06:55:51,609 [INFO]: 	Creating the index 03/09/2025, 06:55:51
2025-03-09 06:55:51,609 [INFO]: 		-> Instanciate the index HNSW15 03/09/2025, 06:55:51
2025-03-09 06:55:51,610 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0008 secs
2025-03-09 06:55:51,610 [INFO]: 		-> Adding the vectors to the index 03/09/2025, 06:55:51
2025-03-09 06:55:51,610 [INFO]: The memory available for adding the vectors is 49.5GB(total available - used by the index)
2025-03-09 06:55:51,610 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/11 [00:00<?, ?it/s]  9%|▉         | 1/11 [00:00<00:01,  6.66it/s] 27%|██▋       | 3/11 [00:00<00:00,  9.71it/s] 45%|████▌     | 5/11 [00:00<00:00, 10.42it/s] 64%|██████▎   | 7/11 [00:00<00:00, 10.65it/s] 82%|████████▏ | 9/11 [00:00<00:00, 10.85it/s]100%|██████████| 11/11 [00:02<00:00,  2.61it/s]100%|██████████| 11/11 [00:02<00:00,  4.06it/s]
2025-03-09 06:55:54,324 [INFO]: 	Computing best hyperparameters for index knn.index 03/09/2025, 06:55:54
2025-03-09 06:56:20,949 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 26.6252 secs
2025-03-09 06:56:20,950 [INFO]: The best hyperparameters are: efSearch=289
2025-03-09 06:56:20,950 [INFO]: 	Compute fast metrics 03/09/2025, 06:56:20
  0%|          | 0/4 [00:00<?, ?it/s] 25%|██▌       | 1/4 [00:00<00:00,  5.75it/s] 75%|███████▌  | 3/4 [00:00<00:00,  8.85it/s] 75%|███████▌  | 3/4 [00:00<00:00,  6.81it/s]
2025-03-09 06:56:34,432 [INFO]: 	>>> Finished "Compute fast metrics" in 13.4825 secs
2025-03-09 06:56:34,434 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 42.8239 secs
2025-03-09 06:56:34,435 [INFO]: {
2025-03-09 06:56:34,435 [INFO]: 	index_key: HNSW15
2025-03-09 06:56:34,435 [INFO]: 	index_param: efSearch=289
2025-03-09 06:56:34,435 [INFO]: 	index_path: knn.index
2025-03-09 06:56:34,435 [INFO]: 	size in bytes: 500516290
2025-03-09 06:56:34,435 [INFO]: 	avg_search_speed_ms: 11.248887210739044
2025-03-09 06:56:34,435 [INFO]: 	99p_search_speed_ms: 27.72265403065831
2025-03-09 06:56:34,435 [INFO]: 	reconstruction error %: 0.0
2025-03-09 06:56:34,435 [INFO]: 	nb vectors: 2544
2025-03-09 06:56:34,435 [INFO]: 	vectors dimension: 49152
2025-03-09 06:56:34,435 [INFO]: 	compression ratio: 0.999309636855176
2025-03-09 06:56:34,435 [INFO]: }
2025-03-09 06:56:34,435 [INFO]: 	>>> Finished "Creating the index" in 42.8257 secs
2025-03-09 06:56:34,435 [INFO]: >>> Finished "Launching the whole pipeline" in 42.8515 secs
2025-03-09 06:56:35: [retrieval_preprocessing] calculating distances ...
2025-03-09 06:56:35: [retrieval_preprocessing] finished and saved retrieval indices for episode 10771 [episode count 11/20]
[retrieval_preprocessing] for episode 57492 [episode count 12/20], we have num_retrieval=np.int64(2516) num_query=np.int64(153)
2025-03-09 06:56:36,188 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-09 06:56:36,510 [INFO]: Launching the whole pipeline 03/09/2025, 06:56:36
2025-03-09 06:56:36,510 [INFO]: Reading total number of vectors and dimension 03/09/2025, 06:56:36
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 815.70it/s]
2025-03-09 06:56:36,546 [INFO]: There are 2516 embeddings of dim 49152
2025-03-09 06:56:36,546 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0365 secs
2025-03-09 06:56:36,546 [INFO]: 	Compute estimated construction time of the index 03/09/2025, 06:56:36
2025-03-09 06:56:36,546 [INFO]: 		-> Train: 16.7 minutes
2025-03-09 06:56:36,546 [INFO]: 		-> Add: 1.4 seconds
2025-03-09 06:56:36,546 [INFO]: 		Total: 16.7 minutes
2025-03-09 06:56:36,546 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0001 secs
2025-03-09 06:56:36,546 [INFO]: 	Checking that your have enough memory available to create the index 03/09/2025, 06:56:36
2025-03-09 06:56:36,547 [INFO]: 519.2MB of memory will be needed to build the index (more might be used if you have more)
2025-03-09 06:56:36,547 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0002 secs
2025-03-09 06:56:36,547 [INFO]: 	Selecting most promising index types given data characteristics 03/09/2025, 06:56:36
2025-03-09 06:56:36,547 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-09 06:56:36,547 [INFO]: 	Creating the index 03/09/2025, 06:56:36
2025-03-09 06:56:36,547 [INFO]: 		-> Instanciate the index HNSW15 03/09/2025, 06:56:36
2025-03-09 06:56:36,548 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0011 secs
2025-03-09 06:56:36,548 [INFO]: 		-> Adding the vectors to the index 03/09/2025, 06:56:36
2025-03-09 06:56:36,548 [INFO]: The memory available for adding the vectors is 49.5GB(total available - used by the index)
2025-03-09 06:56:36,548 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/10 [00:00<?, ?it/s] 10%|█         | 1/10 [00:00<00:00,  9.30it/s] 60%|██████    | 6/10 [00:00<00:00, 31.06it/s]100%|██████████| 10/10 [00:02<00:00,  3.92it/s]100%|██████████| 10/10 [00:02<00:00,  4.70it/s]
2025-03-09 06:56:38,679 [INFO]: 	Computing best hyperparameters for index knn.index 03/09/2025, 06:56:38
2025-03-09 06:57:07,268 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 28.5887 secs
2025-03-09 06:57:07,268 [INFO]: The best hyperparameters are: efSearch=325
2025-03-09 06:57:07,268 [INFO]: 	Compute fast metrics 03/09/2025, 06:57:07
  0%|          | 0/4 [00:00<?, ?it/s] 25%|██▌       | 1/4 [00:00<00:00,  5.16it/s] 75%|███████▌  | 3/4 [00:00<00:00, 10.29it/s]
2025-03-09 06:57:19,970 [INFO]: 	>>> Finished "Compute fast metrics" in 12.7016 secs
2025-03-09 06:57:19,973 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 43.4244 secs
2025-03-09 06:57:19,973 [INFO]: {
2025-03-09 06:57:19,973 [INFO]: 	index_key: HNSW15
2025-03-09 06:57:19,973 [INFO]: 	index_param: efSearch=325
2025-03-09 06:57:19,973 [INFO]: 	index_path: knn.index
2025-03-09 06:57:19,973 [INFO]: 	size in bytes: 495007330
2025-03-09 06:57:19,973 [INFO]: 	avg_search_speed_ms: 11.708520019134676
2025-03-09 06:57:19,973 [INFO]: 	99p_search_speed_ms: 19.603278283029805
2025-03-09 06:57:19,973 [INFO]: 	reconstruction error %: 0.0
2025-03-09 06:57:19,973 [INFO]: 	nb vectors: 2516
2025-03-09 06:57:19,973 [INFO]: 	vectors dimension: 49152
2025-03-09 06:57:19,973 [INFO]: 	compression ratio: 0.999309905168475
2025-03-09 06:57:19,973 [INFO]: }
2025-03-09 06:57:19,973 [INFO]: 	>>> Finished "Creating the index" in 43.4260 secs
2025-03-09 06:57:19,973 [INFO]: >>> Finished "Launching the whole pipeline" in 43.4632 secs
2025-03-09 06:57:20: [retrieval_preprocessing] calculating distances ...
2025-03-09 06:57:21: [retrieval_preprocessing] finished and saved retrieval indices for episode 57492 [episode count 12/20]
[retrieval_preprocessing] for episode 67478 [episode count 13/20], we have num_retrieval=np.int64(2484) num_query=np.int64(185)
2025-03-09 06:57:22,284 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-09 06:57:22,721 [INFO]: Launching the whole pipeline 03/09/2025, 06:57:22
2025-03-09 06:57:22,721 [INFO]: Reading total number of vectors and dimension 03/09/2025, 06:57:22
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 2120.48it/s]
2025-03-09 06:57:22,755 [INFO]: There are 2484 embeddings of dim 49152
2025-03-09 06:57:22,756 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0346 secs
2025-03-09 06:57:22,756 [INFO]: 	Compute estimated construction time of the index 03/09/2025, 06:57:22
2025-03-09 06:57:22,756 [INFO]: 		-> Train: 16.7 minutes
2025-03-09 06:57:22,756 [INFO]: 		-> Add: 1.4 seconds
2025-03-09 06:57:22,756 [INFO]: 		Total: 16.7 minutes
2025-03-09 06:57:22,756 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0003 secs
2025-03-09 06:57:22,756 [INFO]: 	Checking that your have enough memory available to create the index 03/09/2025, 06:57:22
2025-03-09 06:57:22,757 [INFO]: 512.6MB of memory will be needed to build the index (more might be used if you have more)
2025-03-09 06:57:22,757 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0004 secs
2025-03-09 06:57:22,757 [INFO]: 	Selecting most promising index types given data characteristics 03/09/2025, 06:57:22
2025-03-09 06:57:22,757 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-09 06:57:22,757 [INFO]: 	Creating the index 03/09/2025, 06:57:22
2025-03-09 06:57:22,757 [INFO]: 		-> Instanciate the index HNSW15 03/09/2025, 06:57:22
2025-03-09 06:57:22,760 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0029 secs
2025-03-09 06:57:22,761 [INFO]: 		-> Adding the vectors to the index 03/09/2025, 06:57:22
2025-03-09 06:57:22,761 [INFO]: The memory available for adding the vectors is 49.5GB(total available - used by the index)
2025-03-09 06:57:22,761 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/10 [00:00<?, ?it/s] 10%|█         | 1/10 [00:00<00:01,  7.85it/s] 30%|███       | 3/10 [00:00<00:00, 10.24it/s] 50%|█████     | 5/10 [00:00<00:00, 10.87it/s] 70%|███████   | 7/10 [00:00<00:00, 11.27it/s] 90%|█████████ | 9/10 [00:00<00:00, 11.41it/s]100%|██████████| 10/10 [00:02<00:00,  4.12it/s]
2025-03-09 06:57:25,197 [INFO]: 	Computing best hyperparameters for index knn.index 03/09/2025, 06:57:25
2025-03-09 06:57:51,764 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 26.5665 secs
2025-03-09 06:57:51,764 [INFO]: The best hyperparameters are: efSearch=270
2025-03-09 06:57:51,764 [INFO]: 	Compute fast metrics 03/09/2025, 06:57:51
  0%|          | 0/4 [00:00<?, ?it/s] 25%|██▌       | 1/4 [00:00<00:00,  5.28it/s] 50%|█████     | 2/4 [00:00<00:00,  6.70it/s] 75%|███████▌  | 3/4 [00:00<00:00,  7.31it/s] 75%|███████▌  | 3/4 [00:00<00:00,  5.51it/s]
2025-03-09 06:58:04,488 [INFO]: 	>>> Finished "Compute fast metrics" in 12.7237 secs
2025-03-09 06:58:04,490 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 41.7298 secs
2025-03-09 06:58:04,491 [INFO]: {
2025-03-09 06:58:04,491 [INFO]: 	index_key: HNSW15
2025-03-09 06:58:04,491 [INFO]: 	index_param: efSearch=270
2025-03-09 06:58:04,491 [INFO]: 	index_path: knn.index
2025-03-09 06:58:04,491 [INFO]: 	size in bytes: 488711410
2025-03-09 06:58:04,491 [INFO]: 	avg_search_speed_ms: 8.880014608648885
2025-03-09 06:58:04,491 [INFO]: 	99p_search_speed_ms: 16.225399973336607
2025-03-09 06:58:04,491 [INFO]: 	reconstruction error %: 0.0
2025-03-09 06:58:04,491 [INFO]: 	nb vectors: 2484
2025-03-09 06:58:04,491 [INFO]: 	vectors dimension: 49152
2025-03-09 06:58:04,491 [INFO]: 	compression ratio: 0.9993101491123361
2025-03-09 06:58:04,491 [INFO]: }
2025-03-09 06:58:04,491 [INFO]: 	>>> Finished "Creating the index" in 41.7336 secs
2025-03-09 06:58:04,491 [INFO]: >>> Finished "Launching the whole pipeline" in 41.7698 secs
2025-03-09 06:58:05: [retrieval_preprocessing] calculating distances ...
2025-03-09 06:58:06: [retrieval_preprocessing] finished and saved retrieval indices for episode 67478 [episode count 13/20]
[retrieval_preprocessing] for episode 61466 [episode count 14/20], we have num_retrieval=np.int64(2531) num_query=np.int64(138)
2025-03-09 06:58:06,783 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-09 06:58:07,262 [INFO]: Launching the whole pipeline 03/09/2025, 06:58:07
2025-03-09 06:58:07,262 [INFO]: Reading total number of vectors and dimension 03/09/2025, 06:58:07
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1265.25it/s]
2025-03-09 06:58:07,303 [INFO]: There are 2531 embeddings of dim 49152
2025-03-09 06:58:07,303 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0413 secs
2025-03-09 06:58:07,303 [INFO]: 	Compute estimated construction time of the index 03/09/2025, 06:58:07
2025-03-09 06:58:07,303 [INFO]: 		-> Train: 16.7 minutes
2025-03-09 06:58:07,303 [INFO]: 		-> Add: 1.4 seconds
2025-03-09 06:58:07,303 [INFO]: 		Total: 16.7 minutes
2025-03-09 06:58:07,303 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0002 secs
2025-03-09 06:58:07,303 [INFO]: 	Checking that your have enough memory available to create the index 03/09/2025, 06:58:07
2025-03-09 06:58:07,304 [INFO]: 522.3MB of memory will be needed to build the index (more might be used if you have more)
2025-03-09 06:58:07,304 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0002 secs
2025-03-09 06:58:07,304 [INFO]: 	Selecting most promising index types given data characteristics 03/09/2025, 06:58:07
2025-03-09 06:58:07,304 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-09 06:58:07,304 [INFO]: 	Creating the index 03/09/2025, 06:58:07
2025-03-09 06:58:07,304 [INFO]: 		-> Instanciate the index HNSW15 03/09/2025, 06:58:07
2025-03-09 06:58:07,305 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0014 secs
2025-03-09 06:58:07,306 [INFO]: 		-> Adding the vectors to the index 03/09/2025, 06:58:07
2025-03-09 06:58:07,306 [INFO]: The memory available for adding the vectors is 49.5GB(total available - used by the index)
2025-03-09 06:58:07,306 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/10 [00:00<?, ?it/s] 10%|█         | 1/10 [00:00<00:00,  9.39it/s] 50%|█████     | 5/10 [00:00<00:00, 26.78it/s] 90%|█████████ | 9/10 [00:00<00:00, 32.50it/s]100%|██████████| 10/10 [00:02<00:00,  4.15it/s]
2025-03-09 06:58:09,719 [INFO]: 	Computing best hyperparameters for index knn.index 03/09/2025, 06:58:09
2025-03-09 06:58:35,957 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 26.2376 secs
2025-03-09 06:58:35,957 [INFO]: The best hyperparameters are: efSearch=363
2025-03-09 06:58:35,957 [INFO]: 	Compute fast metrics 03/09/2025, 06:58:35
  0%|          | 0/4 [00:00<?, ?it/s] 25%|██▌       | 1/4 [00:00<00:00,  8.61it/s] 75%|███████▌  | 3/4 [00:00<00:00, 11.28it/s]
2025-03-09 06:58:48,777 [INFO]: 	>>> Finished "Compute fast metrics" in 12.8200 secs
2025-03-09 06:58:48,779 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 41.4736 secs
2025-03-09 06:58:48,779 [INFO]: {
2025-03-09 06:58:48,779 [INFO]: 	index_key: HNSW15
2025-03-09 06:58:48,779 [INFO]: 	index_param: efSearch=363
2025-03-09 06:58:48,779 [INFO]: 	index_path: knn.index
2025-03-09 06:58:48,779 [INFO]: 	size in bytes: 497958610
2025-03-09 06:58:48,779 [INFO]: 	avg_search_speed_ms: 9.471818836049572
2025-03-09 06:58:48,779 [INFO]: 	99p_search_speed_ms: 11.950202728621662
2025-03-09 06:58:48,779 [INFO]: 	reconstruction error %: 0.0
2025-03-09 06:58:48,779 [INFO]: 	nb vectors: 2531
2025-03-09 06:58:48,779 [INFO]: 	vectors dimension: 49152
2025-03-09 06:58:48,780 [INFO]: 	compression ratio: 0.99930965748338
2025-03-09 06:58:48,780 [INFO]: }
2025-03-09 06:58:48,780 [INFO]: 	>>> Finished "Creating the index" in 41.4756 secs
2025-03-09 06:58:48,780 [INFO]: >>> Finished "Launching the whole pipeline" in 41.5179 secs
2025-03-09 06:58:50: [retrieval_preprocessing] calculating distances ...
2025-03-09 06:58:50: [retrieval_preprocessing] finished and saved retrieval indices for episode 61466 [episode count 14/20]
[retrieval_preprocessing] for episode 20642 [episode count 15/20], we have num_retrieval=np.int64(2492) num_query=np.int64(177)
2025-03-09 06:58:51,648 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-09 06:58:52,006 [INFO]: Launching the whole pipeline 03/09/2025, 06:58:52
2025-03-09 06:58:52,006 [INFO]: Reading total number of vectors and dimension 03/09/2025, 06:58:52
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1240.55it/s]
2025-03-09 06:58:52,033 [INFO]: There are 2492 embeddings of dim 49152
2025-03-09 06:58:52,034 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0274 secs
2025-03-09 06:58:52,034 [INFO]: 	Compute estimated construction time of the index 03/09/2025, 06:58:52
2025-03-09 06:58:52,034 [INFO]: 		-> Train: 16.7 minutes
2025-03-09 06:58:52,034 [INFO]: 		-> Add: 1.4 seconds
2025-03-09 06:58:52,034 [INFO]: 		Total: 16.7 minutes
2025-03-09 06:58:52,034 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0001 secs
2025-03-09 06:58:52,034 [INFO]: 	Checking that your have enough memory available to create the index 03/09/2025, 06:58:52
2025-03-09 06:58:52,034 [INFO]: 514.3MB of memory will be needed to build the index (more might be used if you have more)
2025-03-09 06:58:52,034 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0002 secs
2025-03-09 06:58:52,034 [INFO]: 	Selecting most promising index types given data characteristics 03/09/2025, 06:58:52
2025-03-09 06:58:52,034 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-09 06:58:52,034 [INFO]: 	Creating the index 03/09/2025, 06:58:52
2025-03-09 06:58:52,034 [INFO]: 		-> Instanciate the index HNSW15 03/09/2025, 06:58:52
2025-03-09 06:58:52,035 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0008 secs
2025-03-09 06:58:52,035 [INFO]: 		-> Adding the vectors to the index 03/09/2025, 06:58:52
2025-03-09 06:58:52,035 [INFO]: The memory available for adding the vectors is 49.5GB(total available - used by the index)
2025-03-09 06:58:52,035 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/10 [00:00<?, ?it/s] 10%|█         | 1/10 [00:00<00:01,  6.18it/s] 30%|███       | 3/10 [00:00<00:00,  9.83it/s] 50%|█████     | 5/10 [00:00<00:00, 11.38it/s] 70%|███████   | 7/10 [00:00<00:00, 13.25it/s] 90%|█████████ | 9/10 [00:00<00:00, 13.13it/s]100%|██████████| 10/10 [00:02<00:00,  4.15it/s]
2025-03-09 06:58:54,451 [INFO]: 	Computing best hyperparameters for index knn.index 03/09/2025, 06:58:54
2025-03-09 06:59:20,656 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 26.2046 secs
2025-03-09 06:59:20,657 [INFO]: The best hyperparameters are: efSearch=281
2025-03-09 06:59:20,657 [INFO]: 	Compute fast metrics 03/09/2025, 06:59:20
  0%|          | 0/4 [00:00<?, ?it/s] 25%|██▌       | 1/4 [00:00<00:00,  6.12it/s] 75%|███████▌  | 3/4 [00:00<00:00, 11.02it/s] 75%|███████▌  | 3/4 [00:00<00:00,  8.45it/s]
2025-03-09 06:59:33,090 [INFO]: 	>>> Finished "Compute fast metrics" in 12.4334 secs
2025-03-09 06:59:33,092 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 41.0570 secs
2025-03-09 06:59:33,092 [INFO]: {
2025-03-09 06:59:33,092 [INFO]: 	index_key: HNSW15
2025-03-09 06:59:33,092 [INFO]: 	index_param: efSearch=281
2025-03-09 06:59:33,092 [INFO]: 	index_path: knn.index
2025-03-09 06:59:33,092 [INFO]: 	size in bytes: 490285390
2025-03-09 06:59:33,092 [INFO]: 	avg_search_speed_ms: 10.318428826767287
2025-03-09 06:59:33,092 [INFO]: 	99p_search_speed_ms: 16.871885564178214
2025-03-09 06:59:33,093 [INFO]: 	reconstruction error %: 0.0
2025-03-09 06:59:33,093 [INFO]: 	nb vectors: 2492
2025-03-09 06:59:33,093 [INFO]: 	vectors dimension: 49152
2025-03-09 06:59:33,093 [INFO]: 	compression ratio: 0.9993100875390147
2025-03-09 06:59:33,093 [INFO]: }
2025-03-09 06:59:33,093 [INFO]: 	>>> Finished "Creating the index" in 41.0584 secs
2025-03-09 06:59:33,093 [INFO]: >>> Finished "Launching the whole pipeline" in 41.0864 secs
2025-03-09 06:59:34: [retrieval_preprocessing] calculating distances ...
2025-03-09 06:59:34: [retrieval_preprocessing] finished and saved retrieval indices for episode 20642 [episode count 15/20]
[retrieval_preprocessing] for episode 26790 [episode count 16/20], we have num_retrieval=np.int64(2562) num_query=np.int64(107)
2025-03-09 06:59:35,476 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-09 06:59:35,808 [INFO]: Launching the whole pipeline 03/09/2025, 06:59:35
2025-03-09 06:59:35,808 [INFO]: Reading total number of vectors and dimension 03/09/2025, 06:59:35
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1311.95it/s]
2025-03-09 06:59:35,841 [INFO]: There are 2562 embeddings of dim 49152
2025-03-09 06:59:35,841 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0330 secs
2025-03-09 06:59:35,841 [INFO]: 	Compute estimated construction time of the index 03/09/2025, 06:59:35
2025-03-09 06:59:35,841 [INFO]: 		-> Train: 16.7 minutes
2025-03-09 06:59:35,841 [INFO]: 		-> Add: 1.4 seconds
2025-03-09 06:59:35,841 [INFO]: 		Total: 16.7 minutes
2025-03-09 06:59:35,841 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0001 secs
2025-03-09 06:59:35,841 [INFO]: 	Checking that your have enough memory available to create the index 03/09/2025, 06:59:35
2025-03-09 06:59:35,841 [INFO]: 528.7MB of memory will be needed to build the index (more might be used if you have more)
2025-03-09 06:59:35,841 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0002 secs
2025-03-09 06:59:35,841 [INFO]: 	Selecting most promising index types given data characteristics 03/09/2025, 06:59:35
2025-03-09 06:59:35,841 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-09 06:59:35,841 [INFO]: 	Creating the index 03/09/2025, 06:59:35
2025-03-09 06:59:35,841 [INFO]: 		-> Instanciate the index HNSW15 03/09/2025, 06:59:35
2025-03-09 06:59:35,842 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0010 secs
2025-03-09 06:59:35,842 [INFO]: 		-> Adding the vectors to the index 03/09/2025, 06:59:35
2025-03-09 06:59:35,843 [INFO]: The memory available for adding the vectors is 49.5GB(total available - used by the index)
2025-03-09 06:59:35,843 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/11 [00:00<?, ?it/s]  9%|▉         | 1/11 [00:00<00:01,  8.18it/s] 27%|██▋       | 3/11 [00:00<00:00, 11.09it/s] 45%|████▌     | 5/11 [00:00<00:00, 12.03it/s] 64%|██████▎   | 7/11 [00:00<00:00, 12.16it/s] 82%|████████▏ | 9/11 [00:00<00:00, 12.26it/s]100%|██████████| 11/11 [00:02<00:00,  2.89it/s]100%|██████████| 11/11 [00:02<00:00,  4.52it/s]
2025-03-09 06:59:38,278 [INFO]: 	Computing best hyperparameters for index knn.index 03/09/2025, 06:59:38
2025-03-09 07:00:04,967 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 26.6887 secs
2025-03-09 07:00:04,968 [INFO]: The best hyperparameters are: efSearch=205
2025-03-09 07:00:04,968 [INFO]: 	Compute fast metrics 03/09/2025, 07:00:04
  0%|          | 0/4 [00:00<?, ?it/s] 25%|██▌       | 1/4 [00:00<00:00,  6.09it/s] 75%|███████▌  | 3/4 [00:00<00:00,  8.37it/s] 75%|███████▌  | 3/4 [00:00<00:00,  6.28it/s]
2025-03-09 07:00:17,929 [INFO]: 	>>> Finished "Compute fast metrics" in 12.9614 secs
2025-03-09 07:00:17,931 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 42.0888 secs
2025-03-09 07:00:17,931 [INFO]: {
2025-03-09 07:00:17,931 [INFO]: 	index_key: HNSW15
2025-03-09 07:00:17,931 [INFO]: 	index_param: efSearch=205
2025-03-09 07:00:17,932 [INFO]: 	index_path: knn.index
2025-03-09 07:00:17,932 [INFO]: 	size in bytes: 504057670
2025-03-09 07:00:17,932 [INFO]: 	avg_search_speed_ms: 7.8232020791182775
2025-03-09 07:00:17,932 [INFO]: 	99p_search_speed_ms: 12.028404346201572
2025-03-09 07:00:17,932 [INFO]: 	reconstruction error %: 0.0
2025-03-09 07:00:17,932 [INFO]: 	nb vectors: 2562
2025-03-09 07:00:17,932 [INFO]: 	vectors dimension: 49152
2025-03-09 07:00:17,932 [INFO]: 	compression ratio: 0.9993096543893479
2025-03-09 07:00:17,932 [INFO]: }
2025-03-09 07:00:17,932 [INFO]: 	>>> Finished "Creating the index" in 42.0902 secs
2025-03-09 07:00:17,932 [INFO]: >>> Finished "Launching the whole pipeline" in 42.1239 secs
2025-03-09 07:00:18: [retrieval_preprocessing] calculating distances ...
2025-03-09 07:00:18: [retrieval_preprocessing] finished and saved retrieval indices for episode 26790 [episode count 16/20]
[retrieval_preprocessing] for episode 79398 [episode count 17/20], we have num_retrieval=np.int64(2546) num_query=np.int64(123)
2025-03-09 07:00:19,261 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-09 07:00:19,688 [INFO]: Launching the whole pipeline 03/09/2025, 07:00:19
2025-03-09 07:00:19,688 [INFO]: Reading total number of vectors and dimension 03/09/2025, 07:00:19
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 968.89it/s]
2025-03-09 07:00:19,713 [INFO]: There are 2546 embeddings of dim 49152
2025-03-09 07:00:19,713 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0254 secs
2025-03-09 07:00:19,713 [INFO]: 	Compute estimated construction time of the index 03/09/2025, 07:00:19
2025-03-09 07:00:19,714 [INFO]: 		-> Train: 16.7 minutes
2025-03-09 07:00:19,714 [INFO]: 		-> Add: 1.4 seconds
2025-03-09 07:00:19,714 [INFO]: 		Total: 16.7 minutes
2025-03-09 07:00:19,714 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0001 secs
2025-03-09 07:00:19,714 [INFO]: 	Checking that your have enough memory available to create the index 03/09/2025, 07:00:19
2025-03-09 07:00:19,714 [INFO]: 525.4MB of memory will be needed to build the index (more might be used if you have more)
2025-03-09 07:00:19,714 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0003 secs
2025-03-09 07:00:19,714 [INFO]: 	Selecting most promising index types given data characteristics 03/09/2025, 07:00:19
2025-03-09 07:00:19,714 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-09 07:00:19,714 [INFO]: 	Creating the index 03/09/2025, 07:00:19
2025-03-09 07:00:19,714 [INFO]: 		-> Instanciate the index HNSW15 03/09/2025, 07:00:19
2025-03-09 07:00:19,715 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0010 secs
2025-03-09 07:00:19,715 [INFO]: 		-> Adding the vectors to the index 03/09/2025, 07:00:19
2025-03-09 07:00:19,715 [INFO]: The memory available for adding the vectors is 49.5GB(total available - used by the index)
2025-03-09 07:00:19,715 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/11 [00:00<?, ?it/s]  9%|▉         | 1/11 [00:00<00:01,  5.72it/s] 27%|██▋       | 3/11 [00:00<00:00,  8.96it/s] 45%|████▌     | 5/11 [00:00<00:00, 10.03it/s] 64%|██████▎   | 7/11 [00:00<00:00, 10.68it/s] 82%|████████▏ | 9/11 [00:00<00:00, 10.95it/s]100%|██████████| 11/11 [00:02<00:00,  2.47it/s]100%|██████████| 11/11 [00:02<00:00,  3.86it/s]
2025-03-09 07:00:22,569 [INFO]: 	Computing best hyperparameters for index knn.index 03/09/2025, 07:00:22
2025-03-09 07:00:47,708 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 25.1383 secs
2025-03-09 07:00:47,708 [INFO]: The best hyperparameters are: efSearch=205
2025-03-09 07:00:47,708 [INFO]: 	Compute fast metrics 03/09/2025, 07:00:47
  0%|          | 0/4 [00:00<?, ?it/s] 25%|██▌       | 1/4 [00:00<00:00,  6.89it/s] 75%|███████▌  | 3/4 [00:00<00:00, 10.39it/s]
2025-03-09 07:01:00,012 [INFO]: 	>>> Finished "Compute fast metrics" in 12.3039 secs
2025-03-09 07:01:00,014 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 40.2991 secs
2025-03-09 07:01:00,014 [INFO]: {
2025-03-09 07:01:00,015 [INFO]: 	index_key: HNSW15
2025-03-09 07:01:00,015 [INFO]: 	index_param: efSearch=205
2025-03-09 07:01:00,015 [INFO]: 	index_path: knn.index
2025-03-09 07:01:00,015 [INFO]: 	size in bytes: 500909830
2025-03-09 07:01:00,015 [INFO]: 	avg_search_speed_ms: 7.020330786432945
2025-03-09 07:01:00,015 [INFO]: 	99p_search_speed_ms: 9.153309953399
2025-03-09 07:01:00,015 [INFO]: 	reconstruction error %: 0.0
2025-03-09 07:01:00,015 [INFO]: 	nb vectors: 2546
2025-03-09 07:01:00,015 [INFO]: 	vectors dimension: 49152
2025-03-09 07:01:00,015 [INFO]: 	compression ratio: 0.9993095324162434
2025-03-09 07:01:00,015 [INFO]: }
2025-03-09 07:01:00,015 [INFO]: 	>>> Finished "Creating the index" in 40.3006 secs
2025-03-09 07:01:00,015 [INFO]: >>> Finished "Launching the whole pipeline" in 40.3267 secs
2025-03-09 07:01:00: [retrieval_preprocessing] calculating distances ...
2025-03-09 07:01:00: [retrieval_preprocessing] finished and saved retrieval indices for episode 79398 [episode count 17/20]
[retrieval_preprocessing] for episode 84271 [episode count 18/20], we have num_retrieval=np.int64(2507) num_query=np.int64(162)
2025-03-09 07:01:01,700 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-09 07:01:02,057 [INFO]: Launching the whole pipeline 03/09/2025, 07:01:02
2025-03-09 07:01:02,057 [INFO]: Reading total number of vectors and dimension 03/09/2025, 07:01:02
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1349.95it/s]
2025-03-09 07:01:02,083 [INFO]: There are 2507 embeddings of dim 49152
2025-03-09 07:01:02,083 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0259 secs
2025-03-09 07:01:02,083 [INFO]: 	Compute estimated construction time of the index 03/09/2025, 07:01:02
2025-03-09 07:01:02,083 [INFO]: 		-> Train: 16.7 minutes
2025-03-09 07:01:02,084 [INFO]: 		-> Add: 1.4 seconds
2025-03-09 07:01:02,084 [INFO]: 		Total: 16.7 minutes
2025-03-09 07:01:02,084 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0005 secs
2025-03-09 07:01:02,084 [INFO]: 	Checking that your have enough memory available to create the index 03/09/2025, 07:01:02
2025-03-09 07:01:02,084 [INFO]: 517.4MB of memory will be needed to build the index (more might be used if you have more)
2025-03-09 07:01:02,084 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0004 secs
2025-03-09 07:01:02,085 [INFO]: 	Selecting most promising index types given data characteristics 03/09/2025, 07:01:02
2025-03-09 07:01:02,085 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-09 07:01:02,085 [INFO]: 	Creating the index 03/09/2025, 07:01:02
2025-03-09 07:01:02,085 [INFO]: 		-> Instanciate the index HNSW15 03/09/2025, 07:01:02
2025-03-09 07:01:02,088 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0026 secs
2025-03-09 07:01:02,088 [INFO]: 		-> Adding the vectors to the index 03/09/2025, 07:01:02
2025-03-09 07:01:02,088 [INFO]: The memory available for adding the vectors is 49.5GB(total available - used by the index)
2025-03-09 07:01:02,088 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/10 [00:00<?, ?it/s] 10%|█         | 1/10 [00:00<00:01,  6.98it/s] 30%|███       | 3/10 [00:00<00:00, 11.51it/s] 50%|█████     | 5/10 [00:00<00:00, 11.46it/s] 70%|███████   | 7/10 [00:00<00:00, 11.42it/s] 90%|█████████ | 9/10 [00:00<00:00, 11.13it/s]100%|██████████| 10/10 [00:02<00:00,  4.19it/s]
2025-03-09 07:01:04,487 [INFO]: 	Computing best hyperparameters for index knn.index 03/09/2025, 07:01:04
2025-03-09 07:01:28,768 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 24.2798 secs
2025-03-09 07:01:28,768 [INFO]: The best hyperparameters are: efSearch=266
2025-03-09 07:01:28,768 [INFO]: 	Compute fast metrics 03/09/2025, 07:01:28
  0%|          | 0/4 [00:00<?, ?it/s] 25%|██▌       | 1/4 [00:00<00:00,  5.95it/s] 75%|███████▌  | 3/4 [00:00<00:00, 10.85it/s] 75%|███████▌  | 3/4 [00:00<00:00,  7.83it/s]
2025-03-09 07:01:40,582 [INFO]: 	>>> Finished "Compute fast metrics" in 11.8135 secs
2025-03-09 07:01:40,584 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 38.4959 secs
2025-03-09 07:01:40,584 [INFO]: {
2025-03-09 07:01:40,584 [INFO]: 	index_key: HNSW15
2025-03-09 07:01:40,584 [INFO]: 	index_param: efSearch=266
2025-03-09 07:01:40,584 [INFO]: 	index_path: knn.index
2025-03-09 07:01:40,584 [INFO]: 	size in bytes: 493236610
2025-03-09 07:01:40,584 [INFO]: 	avg_search_speed_ms: 8.53875112170266
2025-03-09 07:01:40,584 [INFO]: 	99p_search_speed_ms: 11.59069882705807
2025-03-09 07:01:40,584 [INFO]: 	reconstruction error %: 0.0
2025-03-09 07:01:40,584 [INFO]: 	nb vectors: 2507
2025-03-09 07:01:40,584 [INFO]: 	vectors dimension: 49152
2025-03-09 07:01:40,584 [INFO]: 	compression ratio: 0.99930995795304
2025-03-09 07:01:40,584 [INFO]: }
2025-03-09 07:01:40,584 [INFO]: 	>>> Finished "Creating the index" in 38.4997 secs
2025-03-09 07:01:40,585 [INFO]: >>> Finished "Launching the whole pipeline" in 38.5274 secs
2025-03-09 07:01:41: [retrieval_preprocessing] calculating distances ...
2025-03-09 07:01:42: [retrieval_preprocessing] finished and saved retrieval indices for episode 84271 [episode count 18/20]
[retrieval_preprocessing] for episode 2225 [episode count 19/20], we have num_retrieval=np.int64(2549) num_query=np.int64(120)
2025-03-09 07:01:42,643 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-09 07:01:43,085 [INFO]: Launching the whole pipeline 03/09/2025, 07:01:43
2025-03-09 07:01:43,085 [INFO]: Reading total number of vectors and dimension 03/09/2025, 07:01:43
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1239.45it/s]
2025-03-09 07:01:43,120 [INFO]: There are 2549 embeddings of dim 49152
2025-03-09 07:01:43,120 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0355 secs
2025-03-09 07:01:43,120 [INFO]: 	Compute estimated construction time of the index 03/09/2025, 07:01:43
2025-03-09 07:01:43,121 [INFO]: 		-> Train: 16.7 minutes
2025-03-09 07:01:43,121 [INFO]: 		-> Add: 1.4 seconds
2025-03-09 07:01:43,121 [INFO]: 		Total: 16.7 minutes
2025-03-09 07:01:43,121 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0001 secs
2025-03-09 07:01:43,121 [INFO]: 	Checking that your have enough memory available to create the index 03/09/2025, 07:01:43
2025-03-09 07:01:43,121 [INFO]: 526.1MB of memory will be needed to build the index (more might be used if you have more)
2025-03-09 07:01:43,121 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0002 secs
2025-03-09 07:01:43,121 [INFO]: 	Selecting most promising index types given data characteristics 03/09/2025, 07:01:43
2025-03-09 07:01:43,121 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-09 07:01:43,121 [INFO]: 	Creating the index 03/09/2025, 07:01:43
2025-03-09 07:01:43,121 [INFO]: 		-> Instanciate the index HNSW15 03/09/2025, 07:01:43
2025-03-09 07:01:43,122 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0011 secs
2025-03-09 07:01:43,122 [INFO]: 		-> Adding the vectors to the index 03/09/2025, 07:01:43
2025-03-09 07:01:43,122 [INFO]: The memory available for adding the vectors is 49.5GB(total available - used by the index)
2025-03-09 07:01:43,122 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/11 [00:00<?, ?it/s]  9%|▉         | 1/11 [00:00<00:01,  5.65it/s] 27%|██▋       | 3/11 [00:00<00:00, 11.70it/s] 45%|████▌     | 5/11 [00:00<00:00, 14.84it/s] 64%|██████▎   | 7/11 [00:00<00:00, 14.20it/s] 82%|████████▏ | 9/11 [00:00<00:00, 13.20it/s]100%|██████████| 11/11 [00:02<00:00,  2.90it/s]100%|██████████| 11/11 [00:02<00:00,  4.59it/s]
2025-03-09 07:01:45,521 [INFO]: 	Computing best hyperparameters for index knn.index 03/09/2025, 07:01:45
2025-03-09 07:02:13,718 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 28.1969 secs
2025-03-09 07:02:13,719 [INFO]: The best hyperparameters are: efSearch=316
2025-03-09 07:02:13,719 [INFO]: 	Compute fast metrics 03/09/2025, 07:02:13
  0%|          | 0/4 [00:00<?, ?it/s] 25%|██▌       | 1/4 [00:00<00:00,  5.06it/s] 50%|█████     | 2/4 [00:00<00:00,  6.81it/s] 75%|███████▌  | 3/4 [00:00<00:00,  7.50it/s] 75%|███████▌  | 3/4 [00:00<00:00,  5.94it/s]
2025-03-09 07:02:26,764 [INFO]: 	>>> Finished "Compute fast metrics" in 13.0452 secs
2025-03-09 07:02:26,767 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 43.6443 secs
2025-03-09 07:02:26,767 [INFO]: {
2025-03-09 07:02:26,767 [INFO]: 	index_key: HNSW15
2025-03-09 07:02:26,767 [INFO]: 	index_param: efSearch=316
2025-03-09 07:02:26,767 [INFO]: 	index_path: knn.index
2025-03-09 07:02:26,767 [INFO]: 	size in bytes: 501500050
2025-03-09 07:02:26,767 [INFO]: 	avg_search_speed_ms: 9.575908671636759
2025-03-09 07:02:26,767 [INFO]: 	99p_search_speed_ms: 19.087895778939117
2025-03-09 07:02:26,767 [INFO]: 	reconstruction error %: 0.0
2025-03-09 07:02:26,767 [INFO]: 	nb vectors: 2549
2025-03-09 07:02:26,767 [INFO]: 	vectors dimension: 49152
2025-03-09 07:02:26,767 [INFO]: 	compression ratio: 0.999309555402836
2025-03-09 07:02:26,767 [INFO]: }
2025-03-09 07:02:26,767 [INFO]: 	>>> Finished "Creating the index" in 43.6459 secs
2025-03-09 07:02:26,767 [INFO]: >>> Finished "Launching the whole pipeline" in 43.6821 secs
2025-03-09 07:02:27: [retrieval_preprocessing] calculating distances ...
2025-03-09 07:02:27: [retrieval_preprocessing] finished and saved retrieval indices for episode 2225 [episode count 19/20]
2025-03-09 07:02:27: [retrieval_preprocessing] finished for (6313680013, 'cup') [chosen_id count 0/10]
2025-03-09 07:02:31: [retrieval_preprocessing] concatenated all embeddings and indices for 20 episodes for (9088223759, 'bottle') [chosen_id count 1/10]
2025-03-09 07:02:31: [retrieval_preprocessing] we have num_total=3658 embedding_dim=49152
[retrieval_preprocessing] for episode 43018 [episode count 0/20], we have num_retrieval=np.int64(3439) num_query=np.int64(219)
2025-03-09 07:02:32,704 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-09 07:02:33,304 [INFO]: Launching the whole pipeline 03/09/2025, 07:02:33
2025-03-09 07:02:33,304 [INFO]: Reading total number of vectors and dimension 03/09/2025, 07:02:33
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1412.22it/s]
2025-03-09 07:02:33,333 [INFO]: There are 3439 embeddings of dim 49152
2025-03-09 07:02:33,333 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0285 secs
2025-03-09 07:02:33,333 [INFO]: 	Compute estimated construction time of the index 03/09/2025, 07:02:33
2025-03-09 07:02:33,333 [INFO]: 		-> Train: 16.7 minutes
2025-03-09 07:02:33,333 [INFO]: 		-> Add: 1.9 seconds
2025-03-09 07:02:33,333 [INFO]: 		Total: 16.7 minutes
2025-03-09 07:02:33,333 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0001 secs
2025-03-09 07:02:33,333 [INFO]: 	Checking that your have enough memory available to create the index 03/09/2025, 07:02:33
2025-03-09 07:02:33,333 [INFO]: 709.7MB of memory will be needed to build the index (more might be used if you have more)
2025-03-09 07:02:33,333 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0002 secs
2025-03-09 07:02:33,333 [INFO]: 	Selecting most promising index types given data characteristics 03/09/2025, 07:02:33
2025-03-09 07:02:33,333 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-09 07:02:33,333 [INFO]: 	Creating the index 03/09/2025, 07:02:33
2025-03-09 07:02:33,333 [INFO]: 		-> Instanciate the index HNSW15 03/09/2025, 07:02:33
2025-03-09 07:02:33,335 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0012 secs
2025-03-09 07:02:33,335 [INFO]: 		-> Adding the vectors to the index 03/09/2025, 07:02:33
2025-03-09 07:02:33,335 [INFO]: The memory available for adding the vectors is 49.4GB(total available - used by the index)
2025-03-09 07:02:33,335 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/14 [00:00<?, ?it/s]  7%|▋         | 1/14 [00:00<00:02,  5.48it/s] 14%|█▍        | 2/14 [00:00<00:01,  7.38it/s] 21%|██▏       | 3/14 [00:00<00:01,  8.19it/s] 29%|██▊       | 4/14 [00:00<00:01,  8.75it/s] 36%|███▌      | 5/14 [00:00<00:01,  8.98it/s] 43%|████▎     | 6/14 [00:00<00:00,  9.16it/s] 50%|█████     | 7/14 [00:00<00:00,  9.12it/s] 57%|█████▋    | 8/14 [00:00<00:00,  9.09it/s] 64%|██████▍   | 9/14 [00:01<00:00,  9.16it/s] 71%|███████▏  | 10/14 [00:01<00:00,  9.04it/s] 79%|███████▊  | 11/14 [00:01<00:00,  8.90it/s] 86%|████████▌ | 12/14 [00:01<00:00,  8.70it/s] 93%|█████████▎| 13/14 [00:01<00:00,  8.57it/s]100%|██████████| 14/14 [00:04<00:00,  1.11it/s]100%|██████████| 14/14 [00:04<00:00,  3.31it/s]
2025-03-09 07:02:37,568 [INFO]: 	Computing best hyperparameters for index knn.index 03/09/2025, 07:02:37
2025-03-09 07:03:08,932 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 31.3635 secs
2025-03-09 07:03:08,932 [INFO]: The best hyperparameters are: efSearch=208
2025-03-09 07:03:08,932 [INFO]: 	Compute fast metrics 03/09/2025, 07:03:08
  0%|          | 0/4 [00:00<?, ?it/s] 25%|██▌       | 1/4 [00:00<00:00,  6.12it/s] 75%|███████▌  | 3/4 [00:00<00:00,  9.72it/s] 75%|███████▌  | 3/4 [00:00<00:00,  7.47it/s]
2025-03-09 07:03:30,284 [INFO]: 	>>> Finished "Compute fast metrics" in 21.3522 secs
2025-03-09 07:03:30,287 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 56.9516 secs
2025-03-09 07:03:30,287 [INFO]: {
2025-03-09 07:03:30,287 [INFO]: 	index_key: HNSW15
2025-03-09 07:03:30,287 [INFO]: 	index_param: efSearch=208
2025-03-09 07:03:30,287 [INFO]: 	index_path: knn.index
2025-03-09 07:03:30,287 [INFO]: 	size in bytes: 676602190
2025-03-09 07:03:30,287 [INFO]: 	avg_search_speed_ms: 8.225079917457677
2025-03-09 07:03:30,287 [INFO]: 	99p_search_speed_ms: 12.366130726877591
2025-03-09 07:03:30,287 [INFO]: 	reconstruction error %: 0.0
2025-03-09 07:03:30,287 [INFO]: 	nb vectors: 3439
2025-03-09 07:03:30,287 [INFO]: 	vectors dimension: 49152
2025-03-09 07:03:30,287 [INFO]: 	compression ratio: 0.9993093755726685
2025-03-09 07:03:30,287 [INFO]: }
2025-03-09 07:03:30,287 [INFO]: 	>>> Finished "Creating the index" in 56.9535 secs
2025-03-09 07:03:30,287 [INFO]: >>> Finished "Launching the whole pipeline" in 56.9826 secs
2025-03-09 07:03:31: [retrieval_preprocessing] calculating distances ...
2025-03-09 07:03:31: [retrieval_preprocessing] finished and saved retrieval indices for episode 43018 [episode count 0/20]
[retrieval_preprocessing] for episode 23570 [episode count 1/20], we have num_retrieval=np.int64(3501) num_query=np.int64(157)
2025-03-09 07:03:32,936 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-09 07:03:33,433 [INFO]: Launching the whole pipeline 03/09/2025, 07:03:33
2025-03-09 07:03:33,434 [INFO]: Reading total number of vectors and dimension 03/09/2025, 07:03:33
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1879.17it/s]
2025-03-09 07:03:33,459 [INFO]: There are 3501 embeddings of dim 49152
2025-03-09 07:03:33,459 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0259 secs
2025-03-09 07:03:33,460 [INFO]: 	Compute estimated construction time of the index 03/09/2025, 07:03:33
2025-03-09 07:03:33,460 [INFO]: 		-> Train: 16.7 minutes
2025-03-09 07:03:33,460 [INFO]: 		-> Add: 1.9 seconds
2025-03-09 07:03:33,460 [INFO]: 		Total: 16.7 minutes
2025-03-09 07:03:33,460 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0004 secs
2025-03-09 07:03:33,460 [INFO]: 	Checking that your have enough memory available to create the index 03/09/2025, 07:03:33
2025-03-09 07:03:33,460 [INFO]: 722.5MB of memory will be needed to build the index (more might be used if you have more)
2025-03-09 07:03:33,461 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0003 secs
2025-03-09 07:03:33,461 [INFO]: 	Selecting most promising index types given data characteristics 03/09/2025, 07:03:33
2025-03-09 07:03:33,461 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-09 07:03:33,461 [INFO]: 	Creating the index 03/09/2025, 07:03:33
2025-03-09 07:03:33,461 [INFO]: 		-> Instanciate the index HNSW15 03/09/2025, 07:03:33
2025-03-09 07:03:33,464 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0027 secs
2025-03-09 07:03:33,464 [INFO]: 		-> Adding the vectors to the index 03/09/2025, 07:03:33
2025-03-09 07:03:33,464 [INFO]: The memory available for adding the vectors is 49.4GB(total available - used by the index)
2025-03-09 07:03:33,464 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/14 [00:00<?, ?it/s]  7%|▋         | 1/14 [00:00<00:01,  6.85it/s] 21%|██▏       | 3/14 [00:00<00:00, 12.78it/s] 36%|███▌      | 5/14 [00:00<00:00, 15.04it/s] 50%|█████     | 7/14 [00:00<00:00, 16.39it/s] 64%|██████▍   | 9/14 [00:00<00:00, 16.92it/s] 79%|███████▊  | 11/14 [00:00<00:00, 17.70it/s] 93%|█████████▎| 13/14 [00:00<00:00, 17.68it/s]100%|██████████| 14/14 [00:03<00:00,  4.50it/s]
2025-03-09 07:03:36,584 [INFO]: 	Computing best hyperparameters for index knn.index 03/09/2025, 07:03:36
2025-03-09 07:04:16,649 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 40.0643 secs
2025-03-09 07:04:16,649 [INFO]: The best hyperparameters are: efSearch=238
2025-03-09 07:04:16,649 [INFO]: 	Compute fast metrics 03/09/2025, 07:04:16
  0%|          | 0/4 [00:00<?, ?it/s] 25%|██▌       | 1/4 [00:00<00:00,  4.66it/s] 50%|█████     | 2/4 [00:00<00:00,  6.14it/s] 75%|███████▌  | 3/4 [00:00<00:00,  6.71it/s] 75%|███████▌  | 3/4 [00:00<00:00,  5.03it/s]
2025-03-09 07:04:29,919 [INFO]: 	>>> Finished "Compute fast metrics" in 13.2692 secs
2025-03-09 07:04:29,921 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 56.4569 secs
2025-03-09 07:04:29,921 [INFO]: {
2025-03-09 07:04:29,921 [INFO]: 	index_key: HNSW15
2025-03-09 07:04:29,921 [INFO]: 	index_param: efSearch=238
2025-03-09 07:04:29,921 [INFO]: 	index_path: knn.index
2025-03-09 07:04:29,921 [INFO]: 	size in bytes: 688800190
2025-03-09 07:04:29,921 [INFO]: 	avg_search_speed_ms: 9.349935178026975
2025-03-09 07:04:29,921 [INFO]: 	99p_search_speed_ms: 13.781068194657564
2025-03-09 07:04:29,921 [INFO]: 	reconstruction error %: 0.0
2025-03-09 07:04:29,921 [INFO]: 	nb vectors: 3501
2025-03-09 07:04:29,921 [INFO]: 	vectors dimension: 49152
2025-03-09 07:04:29,921 [INFO]: 	compression ratio: 0.9993095501323831
2025-03-09 07:04:29,921 [INFO]: }
2025-03-09 07:04:29,921 [INFO]: 	>>> Finished "Creating the index" in 56.4604 secs
2025-03-09 07:04:29,921 [INFO]: >>> Finished "Launching the whole pipeline" in 56.4878 secs
2025-03-09 07:04:31: [retrieval_preprocessing] calculating distances ...
2025-03-09 07:04:31: [retrieval_preprocessing] finished and saved retrieval indices for episode 23570 [episode count 1/20]
[retrieval_preprocessing] for episode 68639 [episode count 2/20], we have num_retrieval=np.int64(3498) num_query=np.int64(160)
2025-03-09 07:04:32,777 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-09 07:04:33,245 [INFO]: Launching the whole pipeline 03/09/2025, 07:04:33
2025-03-09 07:04:33,245 [INFO]: Reading total number of vectors and dimension 03/09/2025, 07:04:33
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1741.82it/s]
2025-03-09 07:04:33,270 [INFO]: There are 3498 embeddings of dim 49152
2025-03-09 07:04:33,270 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0248 secs
2025-03-09 07:04:33,270 [INFO]: 	Compute estimated construction time of the index 03/09/2025, 07:04:33
2025-03-09 07:04:33,270 [INFO]: 		-> Train: 16.7 minutes
2025-03-09 07:04:33,270 [INFO]: 		-> Add: 1.9 seconds
2025-03-09 07:04:33,270 [INFO]: 		Total: 16.7 minutes
2025-03-09 07:04:33,270 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0001 secs
2025-03-09 07:04:33,270 [INFO]: 	Checking that your have enough memory available to create the index 03/09/2025, 07:04:33
2025-03-09 07:04:33,270 [INFO]: 721.9MB of memory will be needed to build the index (more might be used if you have more)
2025-03-09 07:04:33,270 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0001 secs
2025-03-09 07:04:33,270 [INFO]: 	Selecting most promising index types given data characteristics 03/09/2025, 07:04:33
2025-03-09 07:04:33,270 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-09 07:04:33,270 [INFO]: 	Creating the index 03/09/2025, 07:04:33
2025-03-09 07:04:33,270 [INFO]: 		-> Instanciate the index HNSW15 03/09/2025, 07:04:33
2025-03-09 07:04:33,271 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0010 secs
2025-03-09 07:04:33,272 [INFO]: 		-> Adding the vectors to the index 03/09/2025, 07:04:33
2025-03-09 07:04:33,272 [INFO]: The memory available for adding the vectors is 49.4GB(total available - used by the index)
2025-03-09 07:04:33,272 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/14 [00:00<?, ?it/s]  7%|▋         | 1/14 [00:00<00:02,  5.56it/s] 21%|██▏       | 3/14 [00:00<00:01,  9.11it/s] 29%|██▊       | 4/14 [00:00<00:01,  8.86it/s] 36%|███▌      | 5/14 [00:00<00:01,  8.75it/s] 43%|████▎     | 6/14 [00:00<00:00,  8.80it/s] 50%|█████     | 7/14 [00:00<00:00,  8.71it/s] 57%|█████▋    | 8/14 [00:00<00:00,  8.76it/s] 64%|██████▍   | 9/14 [00:01<00:00,  9.05it/s] 71%|███████▏  | 10/14 [00:01<00:00,  9.13it/s] 79%|███████▊  | 11/14 [00:01<00:00,  9.36it/s] 86%|████████▌ | 12/14 [00:01<00:00,  9.52it/s]100%|██████████| 14/14 [00:03<00:00,  1.57it/s]100%|██████████| 14/14 [00:03<00:00,  3.63it/s]
2025-03-09 07:04:37,134 [INFO]: 	Computing best hyperparameters for index knn.index 03/09/2025, 07:04:37
2025-03-09 07:05:16,651 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 39.5168 secs
2025-03-09 07:05:16,651 [INFO]: The best hyperparameters are: efSearch=256
2025-03-09 07:05:16,651 [INFO]: 	Compute fast metrics 03/09/2025, 07:05:16
  0%|          | 0/4 [00:00<?, ?it/s] 25%|██▌       | 1/4 [00:00<00:00,  5.70it/s] 75%|███████▌  | 3/4 [00:00<00:00, 11.15it/s] 75%|███████▌  | 3/4 [00:00<00:00,  9.10it/s]
2025-03-09 07:05:32,316 [INFO]: 	>>> Finished "Compute fast metrics" in 15.6648 secs
2025-03-09 07:05:32,319 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 59.0477 secs
2025-03-09 07:05:32,319 [INFO]: {
2025-03-09 07:05:32,319 [INFO]: 	index_key: HNSW15
2025-03-09 07:05:32,320 [INFO]: 	index_param: efSearch=256
2025-03-09 07:05:32,320 [INFO]: 	index_path: knn.index
2025-03-09 07:05:32,320 [INFO]: 	size in bytes: 688209970
2025-03-09 07:05:32,320 [INFO]: 	avg_search_speed_ms: 11.425132553492274
2025-03-09 07:05:32,320 [INFO]: 	99p_search_speed_ms: 29.693106175400317
2025-03-09 07:05:32,320 [INFO]: 	reconstruction error %: 0.0
2025-03-09 07:05:32,320 [INFO]: 	nb vectors: 3498
2025-03-09 07:05:32,320 [INFO]: 	vectors dimension: 49152
2025-03-09 07:05:32,320 [INFO]: 	compression ratio: 0.9993095333971985
2025-03-09 07:05:32,320 [INFO]: }
2025-03-09 07:05:32,320 [INFO]: 	>>> Finished "Creating the index" in 59.0492 secs
2025-03-09 07:05:32,320 [INFO]: >>> Finished "Launching the whole pipeline" in 59.0746 secs
2025-03-09 07:05:33: [retrieval_preprocessing] calculating distances ...
2025-03-09 07:05:34: [retrieval_preprocessing] finished and saved retrieval indices for episode 68639 [episode count 2/20]
[retrieval_preprocessing] for episode 79392 [episode count 3/20], we have num_retrieval=np.int64(3429) num_query=np.int64(229)
2025-03-09 07:05:35,954 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-09 07:05:36,595 [INFO]: Launching the whole pipeline 03/09/2025, 07:05:36
2025-03-09 07:05:36,595 [INFO]: Reading total number of vectors and dimension 03/09/2025, 07:05:36
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1388.84it/s]
2025-03-09 07:05:36,623 [INFO]: There are 3429 embeddings of dim 49152
2025-03-09 07:05:36,623 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0280 secs
2025-03-09 07:05:36,623 [INFO]: 	Compute estimated construction time of the index 03/09/2025, 07:05:36
2025-03-09 07:05:36,623 [INFO]: 		-> Train: 16.7 minutes
2025-03-09 07:05:36,623 [INFO]: 		-> Add: 1.9 seconds
2025-03-09 07:05:36,623 [INFO]: 		Total: 16.7 minutes
2025-03-09 07:05:36,623 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0001 secs
2025-03-09 07:05:36,623 [INFO]: 	Checking that your have enough memory available to create the index 03/09/2025, 07:05:36
2025-03-09 07:05:36,623 [INFO]: 707.7MB of memory will be needed to build the index (more might be used if you have more)
2025-03-09 07:05:36,623 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0001 secs
2025-03-09 07:05:36,623 [INFO]: 	Selecting most promising index types given data characteristics 03/09/2025, 07:05:36
2025-03-09 07:05:36,624 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-09 07:05:36,624 [INFO]: 	Creating the index 03/09/2025, 07:05:36
2025-03-09 07:05:36,624 [INFO]: 		-> Instanciate the index HNSW15 03/09/2025, 07:05:36
2025-03-09 07:05:36,625 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0011 secs
2025-03-09 07:05:36,625 [INFO]: 		-> Adding the vectors to the index 03/09/2025, 07:05:36
2025-03-09 07:05:36,625 [INFO]: The memory available for adding the vectors is 49.4GB(total available - used by the index)
2025-03-09 07:05:36,625 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/14 [00:00<?, ?it/s]  7%|▋         | 1/14 [00:00<00:02,  5.48it/s] 14%|█▍        | 2/14 [00:00<00:01,  7.08it/s] 21%|██▏       | 3/14 [00:00<00:01,  7.93it/s] 29%|██▊       | 4/14 [00:00<00:01,  8.19it/s] 36%|███▌      | 5/14 [00:00<00:01,  8.33it/s] 43%|████▎     | 6/14 [00:00<00:00,  8.45it/s] 50%|█████     | 7/14 [00:00<00:00,  8.53it/s] 57%|█████▋    | 8/14 [00:00<00:00,  8.67it/s] 64%|██████▍   | 9/14 [00:01<00:00,  8.74it/s] 71%|███████▏  | 10/14 [00:01<00:00,  8.68it/s] 86%|████████▌ | 12/14 [00:01<00:00,  9.91it/s]100%|██████████| 14/14 [00:03<00:00,  1.85it/s]100%|██████████| 14/14 [00:03<00:00,  3.71it/s]
2025-03-09 07:05:40,397 [INFO]: 	Computing best hyperparameters for index knn.index 03/09/2025, 07:05:40
2025-03-09 07:06:20,543 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 40.1456 secs
2025-03-09 07:06:20,543 [INFO]: The best hyperparameters are: efSearch=242
2025-03-09 07:06:20,543 [INFO]: 	Compute fast metrics 03/09/2025, 07:06:20
  0%|          | 0/4 [00:00<?, ?it/s] 25%|██▌       | 1/4 [00:00<00:02,  1.10it/s] 50%|█████     | 2/4 [00:01<00:01,  1.02it/s] 75%|███████▌  | 3/4 [00:02<00:00,  1.14it/s] 75%|███████▌  | 3/4 [00:03<00:01,  1.08s/it]
2025-03-09 07:06:35,931 [INFO]: 	>>> Finished "Compute fast metrics" in 15.3879 secs
2025-03-09 07:06:35,934 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 59.3087 secs
2025-03-09 07:06:35,934 [INFO]: {
2025-03-09 07:06:35,934 [INFO]: 	index_key: HNSW15
2025-03-09 07:06:35,934 [INFO]: 	index_param: efSearch=242
2025-03-09 07:06:35,934 [INFO]: 	index_path: knn.index
2025-03-09 07:06:35,934 [INFO]: 	size in bytes: 674634730
2025-03-09 07:06:35,934 [INFO]: 	avg_search_speed_ms: 9.106623672987105
2025-03-09 07:06:35,934 [INFO]: 	99p_search_speed_ms: 12.874808120541273
2025-03-09 07:06:35,934 [INFO]: 	reconstruction error %: 0.0
2025-03-09 07:06:35,934 [INFO]: 	nb vectors: 3429
2025-03-09 07:06:35,934 [INFO]: 	vectors dimension: 49152
2025-03-09 07:06:35,934 [INFO]: 	compression ratio: 0.9993094070327508
2025-03-09 07:06:35,934 [INFO]: }
2025-03-09 07:06:35,934 [INFO]: 	>>> Finished "Creating the index" in 59.3103 secs
2025-03-09 07:06:35,934 [INFO]: >>> Finished "Launching the whole pipeline" in 59.3390 secs
2025-03-09 07:06:37: [retrieval_preprocessing] calculating distances ...
2025-03-09 07:06:38: [retrieval_preprocessing] finished and saved retrieval indices for episode 79392 [episode count 3/20]
[retrieval_preprocessing] for episode 50722 [episode count 4/20], we have num_retrieval=np.int64(3438) num_query=np.int64(220)
2025-03-09 07:06:40,221 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-09 07:06:40,924 [INFO]: Launching the whole pipeline 03/09/2025, 07:06:40
2025-03-09 07:06:40,924 [INFO]: Reading total number of vectors and dimension 03/09/2025, 07:06:40
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 2101.35it/s]
2025-03-09 07:06:40,950 [INFO]: There are 3438 embeddings of dim 49152
2025-03-09 07:06:40,950 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0260 secs
2025-03-09 07:06:40,950 [INFO]: 	Compute estimated construction time of the index 03/09/2025, 07:06:40
2025-03-09 07:06:40,950 [INFO]: 		-> Train: 16.7 minutes
2025-03-09 07:06:40,950 [INFO]: 		-> Add: 1.9 seconds
2025-03-09 07:06:40,950 [INFO]: 		Total: 16.7 minutes
2025-03-09 07:06:40,950 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0001 secs
2025-03-09 07:06:40,951 [INFO]: 	Checking that your have enough memory available to create the index 03/09/2025, 07:06:40
2025-03-09 07:06:40,951 [INFO]: 709.5MB of memory will be needed to build the index (more might be used if you have more)
2025-03-09 07:06:40,951 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0002 secs
2025-03-09 07:06:40,951 [INFO]: 	Selecting most promising index types given data characteristics 03/09/2025, 07:06:40
2025-03-09 07:06:40,951 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-09 07:06:40,951 [INFO]: 	Creating the index 03/09/2025, 07:06:40
2025-03-09 07:06:40,951 [INFO]: 		-> Instanciate the index HNSW15 03/09/2025, 07:06:40
2025-03-09 07:06:40,952 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0011 secs
2025-03-09 07:06:40,952 [INFO]: 		-> Adding the vectors to the index 03/09/2025, 07:06:40
2025-03-09 07:06:40,952 [INFO]: The memory available for adding the vectors is 49.4GB(total available - used by the index)
2025-03-09 07:06:40,952 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/14 [00:00<?, ?it/s]  7%|▋         | 1/14 [00:00<00:02,  4.54it/s] 14%|█▍        | 2/14 [00:00<00:01,  6.64it/s] 21%|██▏       | 3/14 [00:00<00:01,  7.10it/s] 29%|██▊       | 4/14 [00:00<00:01,  7.37it/s] 36%|███▌      | 5/14 [00:00<00:01,  7.54it/s] 43%|████▎     | 6/14 [00:00<00:01,  7.69it/s] 50%|█████     | 7/14 [00:00<00:00,  7.95it/s] 57%|█████▋    | 8/14 [00:01<00:00,  8.17it/s] 64%|██████▍   | 9/14 [00:01<00:00,  8.27it/s] 71%|███████▏  | 10/14 [00:01<00:00,  8.40it/s] 79%|███████▊  | 11/14 [00:01<00:00,  8.47it/s] 86%|████████▌ | 12/14 [00:01<00:00,  8.53it/s] 93%|█████████▎| 13/14 [00:01<00:00,  8.67it/s]100%|██████████| 14/14 [00:04<00:00,  1.17it/s]100%|██████████| 14/14 [00:04<00:00,  3.33it/s]
2025-03-09 07:06:45,161 [INFO]: 	Computing best hyperparameters for index knn.index 03/09/2025, 07:06:45
2025-03-09 07:07:33,794 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 48.6323 secs
2025-03-09 07:07:33,794 [INFO]: The best hyperparameters are: efSearch=237
2025-03-09 07:07:33,794 [INFO]: 	Compute fast metrics 03/09/2025, 07:07:33
  0%|          | 0/4 [00:00<?, ?it/s] 25%|██▌       | 1/4 [00:00<00:01,  2.75it/s] 75%|███████▌  | 3/4 [00:00<00:00,  3.88it/s] 75%|███████▌  | 3/4 [00:01<00:00,  1.91it/s]
2025-03-09 07:07:48,456 [INFO]: 	>>> Finished "Compute fast metrics" in 14.6612 secs
2025-03-09 07:07:48,458 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 67.5061 secs
2025-03-09 07:07:48,458 [INFO]: {
2025-03-09 07:07:48,458 [INFO]: 	index_key: HNSW15
2025-03-09 07:07:48,458 [INFO]: 	index_param: efSearch=237
2025-03-09 07:07:48,458 [INFO]: 	index_path: knn.index
2025-03-09 07:07:48,458 [INFO]: 	size in bytes: 676405450
2025-03-09 07:07:48,458 [INFO]: 	avg_search_speed_ms: 10.360783724104648
2025-03-09 07:07:48,459 [INFO]: 	99p_search_speed_ms: 24.042994044721127
2025-03-09 07:07:48,459 [INFO]: 	reconstruction error %: 0.0
2025-03-09 07:07:48,459 [INFO]: 	nb vectors: 3438
2025-03-09 07:07:48,459 [INFO]: 	vectors dimension: 49152
2025-03-09 07:07:48,459 [INFO]: 	compression ratio: 0.9993093698461477
2025-03-09 07:07:48,459 [INFO]: }
2025-03-09 07:07:48,459 [INFO]: 	>>> Finished "Creating the index" in 67.5076 secs
2025-03-09 07:07:48,459 [INFO]: >>> Finished "Launching the whole pipeline" in 67.5345 secs
2025-03-09 07:07:50: [retrieval_preprocessing] calculating distances ...
2025-03-09 07:07:50: [retrieval_preprocessing] finished and saved retrieval indices for episode 50722 [episode count 4/20]
[retrieval_preprocessing] for episode 11814 [episode count 5/20], we have num_retrieval=np.int64(3516) num_query=np.int64(142)
2025-03-09 07:07:52,135 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-09 07:07:52,647 [INFO]: Launching the whole pipeline 03/09/2025, 07:07:52
2025-03-09 07:07:52,647 [INFO]: Reading total number of vectors and dimension 03/09/2025, 07:07:52
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1461.43it/s]
2025-03-09 07:07:52,670 [INFO]: There are 3516 embeddings of dim 49152
2025-03-09 07:07:52,670 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0235 secs
2025-03-09 07:07:52,671 [INFO]: 	Compute estimated construction time of the index 03/09/2025, 07:07:52
2025-03-09 07:07:52,671 [INFO]: 		-> Train: 16.7 minutes
2025-03-09 07:07:52,671 [INFO]: 		-> Add: 1.9 seconds
2025-03-09 07:07:52,671 [INFO]: 		Total: 16.7 minutes
2025-03-09 07:07:52,671 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0001 secs
2025-03-09 07:07:52,671 [INFO]: 	Checking that your have enough memory available to create the index 03/09/2025, 07:07:52
2025-03-09 07:07:52,671 [INFO]: 725.6MB of memory will be needed to build the index (more might be used if you have more)
2025-03-09 07:07:52,671 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0003 secs
2025-03-09 07:07:52,671 [INFO]: 	Selecting most promising index types given data characteristics 03/09/2025, 07:07:52
2025-03-09 07:07:52,671 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-09 07:07:52,671 [INFO]: 	Creating the index 03/09/2025, 07:07:52
2025-03-09 07:07:52,671 [INFO]: 		-> Instanciate the index HNSW15 03/09/2025, 07:07:52
2025-03-09 07:07:52,672 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0009 secs
2025-03-09 07:07:52,672 [INFO]: 		-> Adding the vectors to the index 03/09/2025, 07:07:52
2025-03-09 07:07:52,672 [INFO]: The memory available for adding the vectors is 49.4GB(total available - used by the index)
2025-03-09 07:07:52,672 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/14 [00:00<?, ?it/s]  7%|▋         | 1/14 [00:00<00:02,  5.95it/s] 21%|██▏       | 3/14 [00:00<00:01,  9.28it/s] 36%|███▌      | 5/14 [00:00<00:00, 10.21it/s] 50%|█████     | 7/14 [00:00<00:00, 10.66it/s] 64%|██████▍   | 9/14 [00:00<00:00, 10.97it/s] 79%|███████▊  | 11/14 [00:01<00:00, 11.08it/s] 93%|█████████▎| 13/14 [00:01<00:00, 11.14it/s]100%|██████████| 14/14 [00:03<00:00,  3.89it/s]
2025-03-09 07:07:56,278 [INFO]: 	Computing best hyperparameters for index knn.index 03/09/2025, 07:07:56
2025-03-09 07:08:33,418 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 37.1398 secs
2025-03-09 07:08:33,418 [INFO]: The best hyperparameters are: efSearch=235
2025-03-09 07:08:33,418 [INFO]: 	Compute fast metrics 03/09/2025, 07:08:33
  0%|          | 0/4 [00:00<?, ?it/s] 25%|██▌       | 1/4 [00:00<00:00,  7.79it/s] 75%|███████▌  | 3/4 [00:00<00:00,  9.24it/s] 75%|███████▌  | 3/4 [00:00<00:00,  6.93it/s]
2025-03-09 07:08:48,820 [INFO]: 	>>> Finished "Compute fast metrics" in 15.4020 secs
2025-03-09 07:08:48,823 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 56.1508 secs
2025-03-09 07:08:48,823 [INFO]: {
2025-03-09 07:08:48,823 [INFO]: 	index_key: HNSW15
2025-03-09 07:08:48,823 [INFO]: 	index_param: efSearch=235
2025-03-09 07:08:48,823 [INFO]: 	index_path: knn.index
2025-03-09 07:08:48,823 [INFO]: 	size in bytes: 691751350
2025-03-09 07:08:48,823 [INFO]: 	avg_search_speed_ms: 9.888939674378076
2025-03-09 07:08:48,823 [INFO]: 	99p_search_speed_ms: 16.643072105944146
2025-03-09 07:08:48,823 [INFO]: 	reconstruction error %: 0.0
2025-03-09 07:08:48,823 [INFO]: 	nb vectors: 3516
2025-03-09 07:08:48,823 [INFO]: 	vectors dimension: 49152
2025-03-09 07:08:48,823 [INFO]: 	compression ratio: 0.9993095467034506
2025-03-09 07:08:48,823 [INFO]: }
2025-03-09 07:08:48,823 [INFO]: 	>>> Finished "Creating the index" in 56.1522 secs
2025-03-09 07:08:48,823 [INFO]: >>> Finished "Launching the whole pipeline" in 56.1764 secs
2025-03-09 07:08:49: [retrieval_preprocessing] calculating distances ...
2025-03-09 07:08:50: [retrieval_preprocessing] finished and saved retrieval indices for episode 11814 [episode count 5/20]
[retrieval_preprocessing] for episode 57900 [episode count 6/20], we have num_retrieval=np.int64(3504) num_query=np.int64(154)
2025-03-09 07:08:53,940 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-09 07:08:54,423 [INFO]: Launching the whole pipeline 03/09/2025, 07:08:54
2025-03-09 07:08:54,423 [INFO]: Reading total number of vectors and dimension 03/09/2025, 07:08:54
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1777.25it/s]
2025-03-09 07:08:54,446 [INFO]: There are 3504 embeddings of dim 49152
2025-03-09 07:08:54,446 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0228 secs
2025-03-09 07:08:54,446 [INFO]: 	Compute estimated construction time of the index 03/09/2025, 07:08:54
2025-03-09 07:08:54,446 [INFO]: 		-> Train: 16.7 minutes
2025-03-09 07:08:54,446 [INFO]: 		-> Add: 1.9 seconds
2025-03-09 07:08:54,446 [INFO]: 		Total: 16.7 minutes
2025-03-09 07:08:54,446 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0001 secs
2025-03-09 07:08:54,446 [INFO]: 	Checking that your have enough memory available to create the index 03/09/2025, 07:08:54
2025-03-09 07:08:54,446 [INFO]: 723.1MB of memory will be needed to build the index (more might be used if you have more)
2025-03-09 07:08:54,446 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0001 secs
2025-03-09 07:08:54,446 [INFO]: 	Selecting most promising index types given data characteristics 03/09/2025, 07:08:54
2025-03-09 07:08:54,446 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-09 07:08:54,446 [INFO]: 	Creating the index 03/09/2025, 07:08:54
2025-03-09 07:08:54,446 [INFO]: 		-> Instanciate the index HNSW15 03/09/2025, 07:08:54
2025-03-09 07:08:54,447 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0009 secs
2025-03-09 07:08:54,447 [INFO]: 		-> Adding the vectors to the index 03/09/2025, 07:08:54
2025-03-09 07:08:54,448 [INFO]: The memory available for adding the vectors is 49.4GB(total available - used by the index)
2025-03-09 07:08:54,448 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/14 [00:00<?, ?it/s]  7%|▋         | 1/14 [00:00<00:02,  4.91it/s] 14%|█▍        | 2/14 [00:00<00:01,  6.20it/s] 21%|██▏       | 3/14 [00:00<00:01,  6.73it/s] 29%|██▊       | 4/14 [00:00<00:01,  7.02it/s] 36%|███▌      | 5/14 [00:00<00:01,  7.30it/s] 43%|████▎     | 6/14 [00:00<00:01,  7.39it/s] 50%|█████     | 7/14 [00:00<00:00,  7.43it/s] 57%|█████▋    | 8/14 [00:01<00:00,  7.48it/s] 64%|██████▍   | 9/14 [00:01<00:00,  7.50it/s] 71%|███████▏  | 10/14 [00:01<00:00,  7.53it/s] 79%|███████▊  | 11/14 [00:01<00:00,  8.09it/s] 93%|█████████▎| 13/14 [00:01<00:00,  8.95it/s]100%|██████████| 14/14 [00:04<00:00,  1.40it/s]100%|██████████| 14/14 [00:04<00:00,  3.32it/s]
2025-03-09 07:08:58,784 [INFO]: 	Computing best hyperparameters for index knn.index 03/09/2025, 07:08:58
2025-03-09 07:09:44,341 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 45.5570 secs
2025-03-09 07:09:44,342 [INFO]: The best hyperparameters are: efSearch=213
2025-03-09 07:09:44,342 [INFO]: 	Compute fast metrics 03/09/2025, 07:09:44
  0%|          | 0/4 [00:00<?, ?it/s] 25%|██▌       | 1/4 [00:00<00:00,  6.88it/s] 75%|███████▌  | 3/4 [00:00<00:00,  8.40it/s] 75%|███████▌  | 3/4 [00:00<00:00,  6.22it/s]
2025-03-09 07:09:57,419 [INFO]: 	>>> Finished "Compute fast metrics" in 13.0776 secs
2025-03-09 07:09:57,422 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 62.9743 secs
2025-03-09 07:09:57,422 [INFO]: {
2025-03-09 07:09:57,422 [INFO]: 	index_key: HNSW15
2025-03-09 07:09:57,422 [INFO]: 	index_param: efSearch=213
2025-03-09 07:09:57,422 [INFO]: 	index_path: knn.index
2025-03-09 07:09:57,422 [INFO]: 	size in bytes: 689390470
2025-03-09 07:09:57,422 [INFO]: 	avg_search_speed_ms: 8.62160153458184
2025-03-09 07:09:57,422 [INFO]: 	99p_search_speed_ms: 18.29362893477088
2025-03-09 07:09:57,422 [INFO]: 	reconstruction error %: 0.0
2025-03-09 07:09:57,422 [INFO]: 	nb vectors: 3504
2025-03-09 07:09:57,422 [INFO]: 	vectors dimension: 49152
2025-03-09 07:09:57,422 [INFO]: 	compression ratio: 0.9993094798655978
2025-03-09 07:09:57,422 [INFO]: }
2025-03-09 07:09:57,422 [INFO]: 	>>> Finished "Creating the index" in 62.9758 secs
2025-03-09 07:09:57,422 [INFO]: >>> Finished "Launching the whole pipeline" in 62.9991 secs
2025-03-09 07:09:58: [retrieval_preprocessing] calculating distances ...
2025-03-09 07:09:58: [retrieval_preprocessing] finished and saved retrieval indices for episode 57900 [episode count 6/20]
[retrieval_preprocessing] for episode 30254 [episode count 7/20], we have num_retrieval=np.int64(3412) num_query=np.int64(246)
2025-03-09 07:10:00,312 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-09 07:10:00,901 [INFO]: Launching the whole pipeline 03/09/2025, 07:10:00
2025-03-09 07:10:00,901 [INFO]: Reading total number of vectors and dimension 03/09/2025, 07:10:00
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 2068.20it/s]
2025-03-09 07:10:00,935 [INFO]: There are 3412 embeddings of dim 49152
2025-03-09 07:10:00,936 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0346 secs
2025-03-09 07:10:00,936 [INFO]: 	Compute estimated construction time of the index 03/09/2025, 07:10:00
2025-03-09 07:10:00,936 [INFO]: 		-> Train: 16.7 minutes
2025-03-09 07:10:00,936 [INFO]: 		-> Add: 1.9 seconds
2025-03-09 07:10:00,936 [INFO]: 		Total: 16.7 minutes
2025-03-09 07:10:00,936 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0004 secs
2025-03-09 07:10:00,936 [INFO]: 	Checking that your have enough memory available to create the index 03/09/2025, 07:10:00
2025-03-09 07:10:00,937 [INFO]: 704.2MB of memory will be needed to build the index (more might be used if you have more)
2025-03-09 07:10:00,937 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0004 secs
2025-03-09 07:10:00,937 [INFO]: 	Selecting most promising index types given data characteristics 03/09/2025, 07:10:00
2025-03-09 07:10:00,937 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-09 07:10:00,937 [INFO]: 	Creating the index 03/09/2025, 07:10:00
2025-03-09 07:10:00,937 [INFO]: 		-> Instanciate the index HNSW15 03/09/2025, 07:10:00
2025-03-09 07:10:00,940 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0029 secs
2025-03-09 07:10:00,941 [INFO]: 		-> Adding the vectors to the index 03/09/2025, 07:10:00
2025-03-09 07:10:00,941 [INFO]: The memory available for adding the vectors is 49.4GB(total available - used by the index)
2025-03-09 07:10:00,941 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/14 [00:00<?, ?it/s]  7%|▋         | 1/14 [00:00<00:01,  6.69it/s] 21%|██▏       | 3/14 [00:00<00:01,  9.08it/s] 29%|██▊       | 4/14 [00:00<00:01,  9.36it/s] 43%|████▎     | 6/14 [00:00<00:00, 10.94it/s] 57%|█████▋    | 8/14 [00:00<00:00, 12.86it/s] 71%|███████▏  | 10/14 [00:00<00:00, 12.52it/s] 86%|████████▌ | 12/14 [00:01<00:00, 12.08it/s]100%|██████████| 14/14 [00:03<00:00,  1.96it/s]100%|██████████| 14/14 [00:03<00:00,  3.69it/s]
2025-03-09 07:10:04,742 [INFO]: 	Computing best hyperparameters for index knn.index 03/09/2025, 07:10:04
2025-03-09 07:10:49,093 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 44.3507 secs
2025-03-09 07:10:49,093 [INFO]: The best hyperparameters are: efSearch=198
2025-03-09 07:10:49,093 [INFO]: 	Compute fast metrics 03/09/2025, 07:10:49
  0%|          | 0/4 [00:00<?, ?it/s] 25%|██▌       | 1/4 [00:00<00:00,  5.53it/s] 75%|███████▌  | 3/4 [00:00<00:00,  8.44it/s] 75%|███████▌  | 3/4 [00:00<00:00,  6.39it/s]
2025-03-09 07:11:02,123 [INFO]: 	>>> Finished "Compute fast metrics" in 13.0299 secs
2025-03-09 07:11:02,126 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 61.1853 secs
2025-03-09 07:11:02,126 [INFO]: {
2025-03-09 07:11:02,126 [INFO]: 	index_key: HNSW15
2025-03-09 07:11:02,126 [INFO]: 	index_param: efSearch=198
2025-03-09 07:11:02,126 [INFO]: 	index_path: knn.index
2025-03-09 07:11:02,126 [INFO]: 	size in bytes: 671290150
2025-03-09 07:11:02,126 [INFO]: 	avg_search_speed_ms: 8.70096366901155
2025-03-09 07:11:02,126 [INFO]: 	99p_search_speed_ms: 15.706561198458065
2025-03-09 07:11:02,126 [INFO]: 	reconstruction error %: 0.0
2025-03-09 07:11:02,126 [INFO]: 	nb vectors: 3412
2025-03-09 07:11:02,126 [INFO]: 	vectors dimension: 49152
2025-03-09 07:11:02,126 [INFO]: 	compression ratio: 0.999309309096819
2025-03-09 07:11:02,126 [INFO]: }
2025-03-09 07:11:02,126 [INFO]: 	>>> Finished "Creating the index" in 61.1891 secs
2025-03-09 07:11:02,126 [INFO]: >>> Finished "Launching the whole pipeline" in 61.2254 secs
2025-03-09 07:11:02: [retrieval_preprocessing] calculating distances ...
2025-03-09 07:11:03: [retrieval_preprocessing] finished and saved retrieval indices for episode 30254 [episode count 7/20]
[retrieval_preprocessing] for episode 52783 [episode count 8/20], we have num_retrieval=np.int64(3548) num_query=np.int64(110)
2025-03-09 07:11:04,629 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-09 07:11:05,168 [INFO]: Launching the whole pipeline 03/09/2025, 07:11:05
2025-03-09 07:11:05,168 [INFO]: Reading total number of vectors and dimension 03/09/2025, 07:11:05
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1903.04it/s]
2025-03-09 07:11:05,191 [INFO]: There are 3548 embeddings of dim 49152
2025-03-09 07:11:05,192 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0235 secs
2025-03-09 07:11:05,192 [INFO]: 	Compute estimated construction time of the index 03/09/2025, 07:11:05
2025-03-09 07:11:05,192 [INFO]: 		-> Train: 16.7 minutes
2025-03-09 07:11:05,193 [INFO]: 		-> Add: 1.9 seconds
2025-03-09 07:11:05,193 [INFO]: 		Total: 16.7 minutes
2025-03-09 07:11:05,193 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0004 secs
2025-03-09 07:11:05,193 [INFO]: 	Checking that your have enough memory available to create the index 03/09/2025, 07:11:05
2025-03-09 07:11:05,193 [INFO]: 732.2MB of memory will be needed to build the index (more might be used if you have more)
2025-03-09 07:11:05,193 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0005 secs
2025-03-09 07:11:05,194 [INFO]: 	Selecting most promising index types given data characteristics 03/09/2025, 07:11:05
2025-03-09 07:11:05,194 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-09 07:11:05,194 [INFO]: 	Creating the index 03/09/2025, 07:11:05
2025-03-09 07:11:05,194 [INFO]: 		-> Instanciate the index HNSW15 03/09/2025, 07:11:05
2025-03-09 07:11:05,197 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0028 secs
2025-03-09 07:11:05,197 [INFO]: 		-> Adding the vectors to the index 03/09/2025, 07:11:05
2025-03-09 07:11:05,197 [INFO]: The memory available for adding the vectors is 49.3GB(total available - used by the index)
2025-03-09 07:11:05,198 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/14 [00:00<?, ?it/s]  7%|▋         | 1/14 [00:00<00:01,  6.54it/s] 21%|██▏       | 3/14 [00:00<00:01,  9.92it/s] 36%|███▌      | 5/14 [00:00<00:00, 11.12it/s] 50%|█████     | 7/14 [00:00<00:00, 11.47it/s] 64%|██████▍   | 9/14 [00:00<00:00, 11.82it/s] 79%|███████▊  | 11/14 [00:00<00:00, 11.71it/s] 93%|█████████▎| 13/14 [00:01<00:00, 11.67it/s]100%|██████████| 14/14 [00:03<00:00,  3.60it/s]
2025-03-09 07:11:09,096 [INFO]: 	Computing best hyperparameters for index knn.index 03/09/2025, 07:11:09
2025-03-09 07:11:53,036 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 43.9406 secs
2025-03-09 07:11:53,037 [INFO]: The best hyperparameters are: efSearch=211
2025-03-09 07:11:53,037 [INFO]: 	Compute fast metrics 03/09/2025, 07:11:53
  0%|          | 0/4 [00:00<?, ?it/s] 25%|██▌       | 1/4 [00:00<00:00,  4.89it/s] 50%|█████     | 2/4 [00:00<00:00,  5.61it/s] 75%|███████▌  | 3/4 [00:00<00:00,  6.48it/s] 75%|███████▌  | 3/4 [00:00<00:00,  4.93it/s]
2025-03-09 07:12:19,942 [INFO]: 	>>> Finished "Compute fast metrics" in 26.9051 secs
2025-03-09 07:12:19,946 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 74.7486 secs
2025-03-09 07:12:19,946 [INFO]: {
2025-03-09 07:12:19,946 [INFO]: 	index_key: HNSW15
2025-03-09 07:12:19,946 [INFO]: 	index_param: efSearch=211
2025-03-09 07:12:19,946 [INFO]: 	index_path: knn.index
2025-03-09 07:12:19,946 [INFO]: 	size in bytes: 698047150
2025-03-09 07:12:19,946 [INFO]: 	avg_search_speed_ms: 9.019784286922235
2025-03-09 07:12:19,946 [INFO]: 	99p_search_speed_ms: 14.938479475677013
2025-03-09 07:12:19,946 [INFO]: 	reconstruction error %: 0.0
2025-03-09 07:12:19,946 [INFO]: 	nb vectors: 3548
2025-03-09 07:12:19,946 [INFO]: 	vectors dimension: 49152
2025-03-09 07:12:19,946 [INFO]: 	compression ratio: 0.9993095509379273
2025-03-09 07:12:19,946 [INFO]: }
2025-03-09 07:12:19,946 [INFO]: 	>>> Finished "Creating the index" in 74.7524 secs
2025-03-09 07:12:19,946 [INFO]: >>> Finished "Launching the whole pipeline" in 74.7781 secs
2025-03-09 07:12:20: [retrieval_preprocessing] calculating distances ...
2025-03-09 07:12:20: [retrieval_preprocessing] finished and saved retrieval indices for episode 52783 [episode count 8/20]
[retrieval_preprocessing] for episode 88112 [episode count 9/20], we have num_retrieval=np.int64(3459) num_query=np.int64(199)
2025-03-09 07:12:21,819 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-09 07:12:22,295 [INFO]: Launching the whole pipeline 03/09/2025, 07:12:22
2025-03-09 07:12:22,295 [INFO]: Reading total number of vectors and dimension 03/09/2025, 07:12:22
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 2441.39it/s]
2025-03-09 07:12:22,319 [INFO]: There are 3459 embeddings of dim 49152
2025-03-09 07:12:22,320 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0248 secs
2025-03-09 07:12:22,320 [INFO]: 	Compute estimated construction time of the index 03/09/2025, 07:12:22
2025-03-09 07:12:22,320 [INFO]: 		-> Train: 16.7 minutes
2025-03-09 07:12:22,320 [INFO]: 		-> Add: 1.9 seconds
2025-03-09 07:12:22,320 [INFO]: 		Total: 16.7 minutes
2025-03-09 07:12:22,320 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0001 secs
2025-03-09 07:12:22,320 [INFO]: 	Checking that your have enough memory available to create the index 03/09/2025, 07:12:22
2025-03-09 07:12:22,320 [INFO]: 713.9MB of memory will be needed to build the index (more might be used if you have more)
2025-03-09 07:12:22,320 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0001 secs
2025-03-09 07:12:22,320 [INFO]: 	Selecting most promising index types given data characteristics 03/09/2025, 07:12:22
2025-03-09 07:12:22,320 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-09 07:12:22,320 [INFO]: 	Creating the index 03/09/2025, 07:12:22
2025-03-09 07:12:22,320 [INFO]: 		-> Instanciate the index HNSW15 03/09/2025, 07:12:22
2025-03-09 07:12:22,321 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0010 secs
2025-03-09 07:12:22,321 [INFO]: 		-> Adding the vectors to the index 03/09/2025, 07:12:22
2025-03-09 07:12:22,321 [INFO]: The memory available for adding the vectors is 49.4GB(total available - used by the index)
2025-03-09 07:12:22,321 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/14 [00:00<?, ?it/s]  7%|▋         | 1/14 [00:00<00:01,  6.64it/s] 21%|██▏       | 3/14 [00:00<00:00, 12.40it/s] 50%|█████     | 7/14 [00:00<00:00, 21.43it/s] 86%|████████▌ | 12/14 [00:00<00:00, 25.07it/s]100%|██████████| 14/14 [00:03<00:00,  4.63it/s]
2025-03-09 07:12:25,351 [INFO]: 	Computing best hyperparameters for index knn.index 03/09/2025, 07:12:25
2025-03-09 07:13:07,677 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 42.3260 secs
2025-03-09 07:13:07,678 [INFO]: The best hyperparameters are: efSearch=228
2025-03-09 07:13:07,678 [INFO]: 	Compute fast metrics 03/09/2025, 07:13:07
  0%|          | 0/4 [00:00<?, ?it/s] 25%|██▌       | 1/4 [00:00<00:00,  6.25it/s] 75%|███████▌  | 3/4 [00:00<00:00,  9.47it/s] 75%|███████▌  | 3/4 [00:00<00:00,  7.47it/s]
2025-03-09 07:13:20,530 [INFO]: 	>>> Finished "Compute fast metrics" in 12.8519 secs
2025-03-09 07:13:20,532 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 58.2102 secs
2025-03-09 07:13:20,532 [INFO]: {
2025-03-09 07:13:20,532 [INFO]: 	index_key: HNSW15
2025-03-09 07:13:20,532 [INFO]: 	index_param: efSearch=228
2025-03-09 07:13:20,532 [INFO]: 	index_path: knn.index
2025-03-09 07:13:20,532 [INFO]: 	size in bytes: 680537050
2025-03-09 07:13:20,532 [INFO]: 	avg_search_speed_ms: 9.08448541055617
2025-03-09 07:13:20,532 [INFO]: 	99p_search_speed_ms: 13.46287108026445
2025-03-09 07:13:20,532 [INFO]: 	reconstruction error %: 0.0
2025-03-09 07:13:20,532 [INFO]: 	nb vectors: 3459
2025-03-09 07:13:20,532 [INFO]: 	vectors dimension: 49152
2025-03-09 07:13:20,532 [INFO]: 	compression ratio: 0.9993094013029856
2025-03-09 07:13:20,532 [INFO]: }
2025-03-09 07:13:20,532 [INFO]: 	>>> Finished "Creating the index" in 58.2116 secs
2025-03-09 07:13:20,532 [INFO]: >>> Finished "Launching the whole pipeline" in 58.2371 secs
2025-03-09 07:13:21: [retrieval_preprocessing] calculating distances ...
2025-03-09 07:13:22: [retrieval_preprocessing] finished and saved retrieval indices for episode 88112 [episode count 9/20]
[retrieval_preprocessing] for episode 89143 [episode count 10/20], we have num_retrieval=np.int64(3476) num_query=np.int64(182)
2025-03-09 07:13:23,934 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-09 07:13:24,387 [INFO]: Launching the whole pipeline 03/09/2025, 07:13:24
2025-03-09 07:13:24,387 [INFO]: Reading total number of vectors and dimension 03/09/2025, 07:13:24
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1612.57it/s]
2025-03-09 07:13:24,418 [INFO]: There are 3476 embeddings of dim 49152
2025-03-09 07:13:24,418 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0311 secs
2025-03-09 07:13:24,418 [INFO]: 	Compute estimated construction time of the index 03/09/2025, 07:13:24
2025-03-09 07:13:24,418 [INFO]: 		-> Train: 16.7 minutes
2025-03-09 07:13:24,418 [INFO]: 		-> Add: 1.9 seconds
2025-03-09 07:13:24,419 [INFO]: 		Total: 16.7 minutes
2025-03-09 07:13:24,419 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0001 secs
2025-03-09 07:13:24,419 [INFO]: 	Checking that your have enough memory available to create the index 03/09/2025, 07:13:24
2025-03-09 07:13:24,419 [INFO]: 717.4MB of memory will be needed to build the index (more might be used if you have more)
2025-03-09 07:13:24,419 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0003 secs
2025-03-09 07:13:24,419 [INFO]: 	Selecting most promising index types given data characteristics 03/09/2025, 07:13:24
2025-03-09 07:13:24,419 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-09 07:13:24,419 [INFO]: 	Creating the index 03/09/2025, 07:13:24
2025-03-09 07:13:24,419 [INFO]: 		-> Instanciate the index HNSW15 03/09/2025, 07:13:24
2025-03-09 07:13:24,420 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0009 secs
2025-03-09 07:13:24,420 [INFO]: 		-> Adding the vectors to the index 03/09/2025, 07:13:24
2025-03-09 07:13:24,420 [INFO]: The memory available for adding the vectors is 49.4GB(total available - used by the index)
2025-03-09 07:13:24,420 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/14 [00:00<?, ?it/s]  7%|▋         | 1/14 [00:00<00:02,  5.38it/s] 21%|██▏       | 3/14 [00:00<00:01,  9.01it/s] 36%|███▌      | 5/14 [00:00<00:00,  9.65it/s] 50%|█████     | 7/14 [00:00<00:00,  9.91it/s] 57%|█████▋    | 8/14 [00:00<00:00,  9.76it/s] 64%|██████▍   | 9/14 [00:00<00:00,  9.62it/s] 71%|███████▏  | 10/14 [00:01<00:00,  9.41it/s] 79%|███████▊  | 11/14 [00:01<00:00,  9.22it/s] 86%|████████▌ | 12/14 [00:01<00:00,  9.22it/s] 93%|█████████▎| 13/14 [00:01<00:00,  9.29it/s]100%|██████████| 14/14 [00:03<00:00,  1.35it/s]100%|██████████| 14/14 [00:03<00:00,  3.79it/s]
2025-03-09 07:13:28,120 [INFO]: 	Computing best hyperparameters for index knn.index 03/09/2025, 07:13:28
2025-03-09 07:14:06,808 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 38.6878 secs
2025-03-09 07:14:06,808 [INFO]: The best hyperparameters are: efSearch=229
2025-03-09 07:14:06,808 [INFO]: 	Compute fast metrics 03/09/2025, 07:14:06
  0%|          | 0/4 [00:00<?, ?it/s] 25%|██▌       | 1/4 [00:00<00:00,  5.01it/s] 50%|█████     | 2/4 [00:00<00:00,  6.63it/s] 75%|███████▌  | 3/4 [00:00<00:00,  7.31it/s] 75%|███████▌  | 3/4 [00:00<00:00,  5.49it/s]
2025-03-09 07:14:20,153 [INFO]: 	>>> Finished "Compute fast metrics" in 13.3447 secs
2025-03-09 07:14:20,156 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 55.7359 secs
2025-03-09 07:14:20,156 [INFO]: {
2025-03-09 07:14:20,156 [INFO]: 	index_key: HNSW15
2025-03-09 07:14:20,156 [INFO]: 	index_param: efSearch=229
2025-03-09 07:14:20,156 [INFO]: 	index_path: knn.index
2025-03-09 07:14:20,156 [INFO]: 	size in bytes: 683881690
2025-03-09 07:14:20,156 [INFO]: 	avg_search_speed_ms: 9.33022388220598
2025-03-09 07:14:20,156 [INFO]: 	99p_search_speed_ms: 14.270761178340763
2025-03-09 07:14:20,156 [INFO]: 	reconstruction error %: 0.0
2025-03-09 07:14:20,156 [INFO]: 	nb vectors: 3476
2025-03-09 07:14:20,156 [INFO]: 	vectors dimension: 49152
2025-03-09 07:14:20,156 [INFO]: 	compression ratio: 0.9993094097898717
2025-03-09 07:14:20,156 [INFO]: }
2025-03-09 07:14:20,156 [INFO]: 	>>> Finished "Creating the index" in 55.7373 secs
2025-03-09 07:14:20,156 [INFO]: >>> Finished "Launching the whole pipeline" in 55.7691 secs
2025-03-09 07:14:21: [retrieval_preprocessing] calculating distances ...
2025-03-09 07:14:21: [retrieval_preprocessing] finished and saved retrieval indices for episode 89143 [episode count 10/20]
[retrieval_preprocessing] for episode 20029 [episode count 11/20], we have num_retrieval=np.int64(3463) num_query=np.int64(195)
2025-03-09 07:14:23,042 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-09 07:14:23,536 [INFO]: Launching the whole pipeline 03/09/2025, 07:14:23
2025-03-09 07:14:23,536 [INFO]: Reading total number of vectors and dimension 03/09/2025, 07:14:23
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1649.35it/s]
2025-03-09 07:14:23,560 [INFO]: There are 3463 embeddings of dim 49152
2025-03-09 07:14:23,561 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0243 secs
2025-03-09 07:14:23,561 [INFO]: 	Compute estimated construction time of the index 03/09/2025, 07:14:23
2025-03-09 07:14:23,561 [INFO]: 		-> Train: 16.7 minutes
2025-03-09 07:14:23,561 [INFO]: 		-> Add: 1.9 seconds
2025-03-09 07:14:23,561 [INFO]: 		Total: 16.7 minutes
2025-03-09 07:14:23,561 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0001 secs
2025-03-09 07:14:23,561 [INFO]: 	Checking that your have enough memory available to create the index 03/09/2025, 07:14:23
2025-03-09 07:14:23,561 [INFO]: 714.7MB of memory will be needed to build the index (more might be used if you have more)
2025-03-09 07:14:23,561 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0001 secs
2025-03-09 07:14:23,561 [INFO]: 	Selecting most promising index types given data characteristics 03/09/2025, 07:14:23
2025-03-09 07:14:23,561 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-09 07:14:23,561 [INFO]: 	Creating the index 03/09/2025, 07:14:23
2025-03-09 07:14:23,561 [INFO]: 		-> Instanciate the index HNSW15 03/09/2025, 07:14:23
2025-03-09 07:14:23,562 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0011 secs
2025-03-09 07:14:23,562 [INFO]: 		-> Adding the vectors to the index 03/09/2025, 07:14:23
2025-03-09 07:14:23,562 [INFO]: The memory available for adding the vectors is 49.4GB(total available - used by the index)
2025-03-09 07:14:23,562 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/14 [00:00<?, ?it/s]  7%|▋         | 1/14 [00:00<00:02,  6.09it/s] 21%|██▏       | 3/14 [00:00<00:01, 10.20it/s] 36%|███▌      | 5/14 [00:00<00:00, 11.43it/s] 50%|█████     | 7/14 [00:00<00:00, 10.26it/s] 64%|██████▍   | 9/14 [00:00<00:00,  9.39it/s] 71%|███████▏  | 10/14 [00:01<00:00,  9.08it/s] 79%|███████▊  | 11/14 [00:01<00:00,  8.82it/s] 86%|████████▌ | 12/14 [00:01<00:00,  8.68it/s]100%|██████████| 14/14 [00:03<00:00,  1.68it/s]100%|██████████| 14/14 [00:03<00:00,  3.64it/s]
2025-03-09 07:14:27,415 [INFO]: 	Computing best hyperparameters for index knn.index 03/09/2025, 07:14:27
2025-03-09 07:15:03,330 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 35.9148 secs
2025-03-09 07:15:03,330 [INFO]: The best hyperparameters are: efSearch=216
2025-03-09 07:15:03,330 [INFO]: 	Compute fast metrics 03/09/2025, 07:15:03
  0%|          | 0/4 [00:00<?, ?it/s] 25%|██▌       | 1/4 [00:00<00:00,  8.14it/s] 75%|███████▌  | 3/4 [00:00<00:00, 11.51it/s] 75%|███████▌  | 3/4 [00:00<00:00,  8.95it/s]
2025-03-09 07:15:16,206 [INFO]: 	>>> Finished "Compute fast metrics" in 12.8762 secs
2025-03-09 07:15:16,209 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 52.6464 secs
2025-03-09 07:15:16,209 [INFO]: {
2025-03-09 07:15:16,209 [INFO]: 	index_key: HNSW15
2025-03-09 07:15:16,209 [INFO]: 	index_param: efSearch=216
2025-03-09 07:15:16,209 [INFO]: 	index_path: knn.index
2025-03-09 07:15:16,209 [INFO]: 	size in bytes: 681324010
2025-03-09 07:15:16,209 [INFO]: 	avg_search_speed_ms: 8.914553653282809
2025-03-09 07:15:16,209 [INFO]: 	99p_search_speed_ms: 16.39843139098957
2025-03-09 07:15:16,209 [INFO]: 	reconstruction error %: 0.0
2025-03-09 07:15:16,209 [INFO]: 	nb vectors: 3463
2025-03-09 07:15:16,209 [INFO]: 	vectors dimension: 49152
2025-03-09 07:15:16,209 [INFO]: 	compression ratio: 0.9993094240139871
2025-03-09 07:15:16,209 [INFO]: }
2025-03-09 07:15:16,209 [INFO]: 	>>> Finished "Creating the index" in 52.6480 secs
2025-03-09 07:15:16,209 [INFO]: >>> Finished "Launching the whole pipeline" in 52.6728 secs
2025-03-09 07:15:17: [retrieval_preprocessing] calculating distances ...
2025-03-09 07:15:17: [retrieval_preprocessing] finished and saved retrieval indices for episode 20029 [episode count 11/20]
[retrieval_preprocessing] for episode 16446 [episode count 12/20], we have num_retrieval=np.int64(3460) num_query=np.int64(198)
2025-03-09 07:15:18,924 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-09 07:15:19,505 [INFO]: Launching the whole pipeline 03/09/2025, 07:15:19
2025-03-09 07:15:19,505 [INFO]: Reading total number of vectors and dimension 03/09/2025, 07:15:19
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 2061.08it/s]
2025-03-09 07:15:19,531 [INFO]: There are 3460 embeddings of dim 49152
2025-03-09 07:15:19,532 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0263 secs
2025-03-09 07:15:19,532 [INFO]: 	Compute estimated construction time of the index 03/09/2025, 07:15:19
2025-03-09 07:15:19,532 [INFO]: 		-> Train: 16.7 minutes
2025-03-09 07:15:19,532 [INFO]: 		-> Add: 1.9 seconds
2025-03-09 07:15:19,532 [INFO]: 		Total: 16.7 minutes
2025-03-09 07:15:19,532 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0004 secs
2025-03-09 07:15:19,533 [INFO]: 	Checking that your have enough memory available to create the index 03/09/2025, 07:15:19
2025-03-09 07:15:19,533 [INFO]: 714.1MB of memory will be needed to build the index (more might be used if you have more)
2025-03-09 07:15:19,533 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0005 secs
2025-03-09 07:15:19,533 [INFO]: 	Selecting most promising index types given data characteristics 03/09/2025, 07:15:19
2025-03-09 07:15:19,533 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-09 07:15:19,533 [INFO]: 	Creating the index 03/09/2025, 07:15:19
2025-03-09 07:15:19,534 [INFO]: 		-> Instanciate the index HNSW15 03/09/2025, 07:15:19
2025-03-09 07:15:19,536 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0026 secs
2025-03-09 07:15:19,537 [INFO]: 		-> Adding the vectors to the index 03/09/2025, 07:15:19
2025-03-09 07:15:19,537 [INFO]: The memory available for adding the vectors is 49.4GB(total available - used by the index)
2025-03-09 07:15:19,537 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/14 [00:00<?, ?it/s]  7%|▋         | 1/14 [00:00<00:01,  7.12it/s] 21%|██▏       | 3/14 [00:00<00:01,  9.20it/s] 36%|███▌      | 5/14 [00:00<00:00, 10.12it/s] 50%|█████     | 7/14 [00:00<00:00, 10.71it/s] 64%|██████▍   | 9/14 [00:00<00:00, 11.05it/s] 79%|███████▊  | 11/14 [00:01<00:00, 11.72it/s] 93%|█████████▎| 13/14 [00:01<00:00, 13.38it/s]100%|██████████| 14/14 [00:03<00:00,  3.77it/s]
2025-03-09 07:15:23,258 [INFO]: 	Computing best hyperparameters for index knn.index 03/09/2025, 07:15:23
2025-03-09 07:16:06,687 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 43.4291 secs
2025-03-09 07:16:06,688 [INFO]: The best hyperparameters are: efSearch=204
2025-03-09 07:16:06,688 [INFO]: 	Compute fast metrics 03/09/2025, 07:16:06
  0%|          | 0/4 [00:00<?, ?it/s] 25%|██▌       | 1/4 [00:00<00:00,  6.95it/s] 75%|███████▌  | 3/4 [00:00<00:00, 12.80it/s] 75%|███████▌  | 3/4 [00:00<00:00,  9.72it/s]
2025-03-09 07:16:21,241 [INFO]: 	>>> Finished "Compute fast metrics" in 14.5533 secs
2025-03-09 07:16:21,244 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 61.7075 secs
2025-03-09 07:16:21,244 [INFO]: {
2025-03-09 07:16:21,244 [INFO]: 	index_key: HNSW15
2025-03-09 07:16:21,244 [INFO]: 	index_param: efSearch=204
2025-03-09 07:16:21,244 [INFO]: 	index_path: knn.index
2025-03-09 07:16:21,244 [INFO]: 	size in bytes: 680733790
2025-03-09 07:16:21,244 [INFO]: 	avg_search_speed_ms: 8.33489901444409
2025-03-09 07:16:21,244 [INFO]: 	99p_search_speed_ms: 14.692324660718434
2025-03-09 07:16:21,244 [INFO]: 	reconstruction error %: 0.0
2025-03-09 07:16:21,245 [INFO]: 	nb vectors: 3460
2025-03-09 07:16:21,245 [INFO]: 	vectors dimension: 49152
2025-03-09 07:16:21,245 [INFO]: 	compression ratio: 0.9993094069856588
2025-03-09 07:16:21,245 [INFO]: }
2025-03-09 07:16:21,245 [INFO]: 	>>> Finished "Creating the index" in 61.7110 secs
2025-03-09 07:16:21,245 [INFO]: >>> Finished "Launching the whole pipeline" in 61.7391 secs
2025-03-09 07:16:22: [retrieval_preprocessing] calculating distances ...
2025-03-09 07:16:22: [retrieval_preprocessing] finished and saved retrieval indices for episode 16446 [episode count 12/20]
[retrieval_preprocessing] for episode 56385 [episode count 13/20], we have num_retrieval=np.int64(3542) num_query=np.int64(116)
2025-03-09 07:16:23,790 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-09 07:16:24,278 [INFO]: Launching the whole pipeline 03/09/2025, 07:16:24
2025-03-09 07:16:24,278 [INFO]: Reading total number of vectors and dimension 03/09/2025, 07:16:24
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1263.34it/s]
2025-03-09 07:16:24,306 [INFO]: There are 3542 embeddings of dim 49152
2025-03-09 07:16:24,306 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0281 secs
2025-03-09 07:16:24,306 [INFO]: 	Compute estimated construction time of the index 03/09/2025, 07:16:24
2025-03-09 07:16:24,307 [INFO]: 		-> Train: 16.7 minutes
2025-03-09 07:16:24,307 [INFO]: 		-> Add: 1.9 seconds
2025-03-09 07:16:24,307 [INFO]: 		Total: 16.7 minutes
2025-03-09 07:16:24,307 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0005 secs
2025-03-09 07:16:24,307 [INFO]: 	Checking that your have enough memory available to create the index 03/09/2025, 07:16:24
2025-03-09 07:16:24,307 [INFO]: 731.0MB of memory will be needed to build the index (more might be used if you have more)
2025-03-09 07:16:24,308 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0004 secs
2025-03-09 07:16:24,308 [INFO]: 	Selecting most promising index types given data characteristics 03/09/2025, 07:16:24
2025-03-09 07:16:24,308 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-09 07:16:24,308 [INFO]: 	Creating the index 03/09/2025, 07:16:24
2025-03-09 07:16:24,308 [INFO]: 		-> Instanciate the index HNSW15 03/09/2025, 07:16:24
2025-03-09 07:16:24,311 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0027 secs
2025-03-09 07:16:24,311 [INFO]: 		-> Adding the vectors to the index 03/09/2025, 07:16:24
2025-03-09 07:16:24,311 [INFO]: The memory available for adding the vectors is 49.4GB(total available - used by the index)
2025-03-09 07:16:24,311 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/14 [00:00<?, ?it/s]  7%|▋         | 1/14 [00:00<00:02,  6.17it/s] 21%|██▏       | 3/14 [00:00<00:00, 11.50it/s] 36%|███▌      | 5/14 [00:00<00:00, 13.20it/s] 50%|█████     | 7/14 [00:00<00:00, 12.50it/s] 64%|██████▍   | 9/14 [00:00<00:00, 12.29it/s] 79%|███████▊  | 11/14 [00:00<00:00, 12.06it/s] 93%|█████████▎| 13/14 [00:01<00:00, 11.80it/s]100%|██████████| 14/14 [00:03<00:00,  3.83it/s]
2025-03-09 07:16:27,976 [INFO]: 	Computing best hyperparameters for index knn.index 03/09/2025, 07:16:27
2025-03-09 07:17:08,440 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 40.4634 secs
2025-03-09 07:17:08,440 [INFO]: The best hyperparameters are: efSearch=215
2025-03-09 07:17:08,440 [INFO]: 	Compute fast metrics 03/09/2025, 07:17:08
  0%|          | 0/4 [00:00<?, ?it/s] 25%|██▌       | 1/4 [00:00<00:00,  7.65it/s] 75%|███████▌  | 3/4 [00:00<00:00, 12.05it/s] 75%|███████▌  | 3/4 [00:00<00:00,  9.10it/s]
2025-03-09 07:17:22,075 [INFO]: 	>>> Finished "Compute fast metrics" in 13.6346 secs
2025-03-09 07:17:22,078 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 57.7667 secs
2025-03-09 07:17:22,078 [INFO]: {
2025-03-09 07:17:22,078 [INFO]: 	index_key: HNSW15
2025-03-09 07:17:22,078 [INFO]: 	index_param: efSearch=215
2025-03-09 07:17:22,078 [INFO]: 	index_path: knn.index
2025-03-09 07:17:22,078 [INFO]: 	size in bytes: 696866650
2025-03-09 07:17:22,078 [INFO]: 	avg_search_speed_ms: 9.007267338676831
2025-03-09 07:17:22,078 [INFO]: 	99p_search_speed_ms: 15.232912329956926
2025-03-09 07:17:22,078 [INFO]: 	reconstruction error %: 0.0
2025-03-09 07:17:22,078 [INFO]: 	nb vectors: 3542
2025-03-09 07:17:22,078 [INFO]: 	vectors dimension: 49152
2025-03-09 07:17:22,078 [INFO]: 	compression ratio: 0.9993096039249403
2025-03-09 07:17:22,078 [INFO]: }
2025-03-09 07:17:22,078 [INFO]: 	>>> Finished "Creating the index" in 57.7702 secs
2025-03-09 07:17:22,078 [INFO]: >>> Finished "Launching the whole pipeline" in 57.8001 secs
2025-03-09 07:17:22: [retrieval_preprocessing] calculating distances ...
2025-03-09 07:17:22: [retrieval_preprocessing] finished and saved retrieval indices for episode 56385 [episode count 13/20]
[retrieval_preprocessing] for episode 49222 [episode count 14/20], we have num_retrieval=np.int64(3491) num_query=np.int64(167)
2025-03-09 07:17:24,126 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-09 07:17:24,609 [INFO]: Launching the whole pipeline 03/09/2025, 07:17:24
2025-03-09 07:17:24,609 [INFO]: Reading total number of vectors and dimension 03/09/2025, 07:17:24
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1154.50it/s]
2025-03-09 07:17:24,635 [INFO]: There are 3491 embeddings of dim 49152
2025-03-09 07:17:24,635 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0260 secs
2025-03-09 07:17:24,635 [INFO]: 	Compute estimated construction time of the index 03/09/2025, 07:17:24
2025-03-09 07:17:24,635 [INFO]: 		-> Train: 16.7 minutes
2025-03-09 07:17:24,635 [INFO]: 		-> Add: 1.9 seconds
2025-03-09 07:17:24,635 [INFO]: 		Total: 16.7 minutes
2025-03-09 07:17:24,635 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0001 secs
2025-03-09 07:17:24,635 [INFO]: 	Checking that your have enough memory available to create the index 03/09/2025, 07:17:24
2025-03-09 07:17:24,635 [INFO]: 720.5MB of memory will be needed to build the index (more might be used if you have more)
2025-03-09 07:17:24,635 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0001 secs
2025-03-09 07:17:24,635 [INFO]: 	Selecting most promising index types given data characteristics 03/09/2025, 07:17:24
2025-03-09 07:17:24,636 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-09 07:17:24,636 [INFO]: 	Creating the index 03/09/2025, 07:17:24
2025-03-09 07:17:24,636 [INFO]: 		-> Instanciate the index HNSW15 03/09/2025, 07:17:24
2025-03-09 07:17:24,637 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0011 secs
2025-03-09 07:17:24,637 [INFO]: 		-> Adding the vectors to the index 03/09/2025, 07:17:24
2025-03-09 07:17:24,637 [INFO]: The memory available for adding the vectors is 49.4GB(total available - used by the index)
2025-03-09 07:17:24,637 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/14 [00:00<?, ?it/s]  7%|▋         | 1/14 [00:00<00:02,  6.04it/s] 21%|██▏       | 3/14 [00:00<00:01,  9.19it/s] 36%|███▌      | 5/14 [00:00<00:00, 10.29it/s] 50%|█████     | 7/14 [00:00<00:00, 10.66it/s] 64%|██████▍   | 9/14 [00:00<00:00, 10.65it/s] 79%|███████▊  | 11/14 [00:01<00:00, 11.54it/s] 93%|█████████▎| 13/14 [00:01<00:00, 11.50it/s]100%|██████████| 14/14 [00:03<00:00,  3.75it/s]
2025-03-09 07:17:28,379 [INFO]: 	Computing best hyperparameters for index knn.index 03/09/2025, 07:17:28
2025-03-09 07:18:06,563 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 38.1832 secs
2025-03-09 07:18:06,563 [INFO]: The best hyperparameters are: efSearch=225
2025-03-09 07:18:06,563 [INFO]: 	Compute fast metrics 03/09/2025, 07:18:06
  0%|          | 0/4 [00:00<?, ?it/s] 25%|██▌       | 1/4 [00:00<00:00,  4.85it/s] 50%|█████     | 2/4 [00:00<00:00,  6.30it/s] 75%|███████▌  | 3/4 [00:00<00:00,  6.97it/s] 75%|███████▌  | 3/4 [00:00<00:00,  5.27it/s]
2025-03-09 07:18:22,142 [INFO]: 	>>> Finished "Compute fast metrics" in 15.5786 secs
2025-03-09 07:18:22,146 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 57.5086 secs
2025-03-09 07:18:22,146 [INFO]: {
2025-03-09 07:18:22,146 [INFO]: 	index_key: HNSW15
2025-03-09 07:18:22,146 [INFO]: 	index_param: efSearch=225
2025-03-09 07:18:22,146 [INFO]: 	index_path: knn.index
2025-03-09 07:18:22,146 [INFO]: 	size in bytes: 686832790
2025-03-09 07:18:22,146 [INFO]: 	avg_search_speed_ms: 8.962602745349383
2025-03-09 07:18:22,146 [INFO]: 	99p_search_speed_ms: 15.771362988743926
2025-03-09 07:18:22,146 [INFO]: 	reconstruction error %: 0.0
2025-03-09 07:18:22,146 [INFO]: 	nb vectors: 3491
2025-03-09 07:18:22,146 [INFO]: 	vectors dimension: 49152
2025-03-09 07:18:22,146 [INFO]: 	compression ratio: 0.9993094942365812
2025-03-09 07:18:22,146 [INFO]: }
2025-03-09 07:18:22,146 [INFO]: 	>>> Finished "Creating the index" in 57.5102 secs
2025-03-09 07:18:22,146 [INFO]: >>> Finished "Launching the whole pipeline" in 57.5369 secs
2025-03-09 07:18:23: [retrieval_preprocessing] calculating distances ...
2025-03-09 07:18:23: [retrieval_preprocessing] finished and saved retrieval indices for episode 49222 [episode count 14/20]
[retrieval_preprocessing] for episode 9799 [episode count 15/20], we have num_retrieval=np.int64(3541) num_query=np.int64(117)
2025-03-09 07:18:24,344 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-09 07:18:24,850 [INFO]: Launching the whole pipeline 03/09/2025, 07:18:24
2025-03-09 07:18:24,850 [INFO]: Reading total number of vectors and dimension 03/09/2025, 07:18:24
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1298.95it/s]
2025-03-09 07:18:24,877 [INFO]: There are 3541 embeddings of dim 49152
2025-03-09 07:18:24,877 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0266 secs
2025-03-09 07:18:24,877 [INFO]: 	Compute estimated construction time of the index 03/09/2025, 07:18:24
2025-03-09 07:18:24,877 [INFO]: 		-> Train: 16.7 minutes
2025-03-09 07:18:24,877 [INFO]: 		-> Add: 1.9 seconds
2025-03-09 07:18:24,877 [INFO]: 		Total: 16.7 minutes
2025-03-09 07:18:24,877 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0001 secs
2025-03-09 07:18:24,877 [INFO]: 	Checking that your have enough memory available to create the index 03/09/2025, 07:18:24
2025-03-09 07:18:24,877 [INFO]: 730.8MB of memory will be needed to build the index (more might be used if you have more)
2025-03-09 07:18:24,877 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0001 secs
2025-03-09 07:18:24,877 [INFO]: 	Selecting most promising index types given data characteristics 03/09/2025, 07:18:24
2025-03-09 07:18:24,877 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-09 07:18:24,877 [INFO]: 	Creating the index 03/09/2025, 07:18:24
2025-03-09 07:18:24,877 [INFO]: 		-> Instanciate the index HNSW15 03/09/2025, 07:18:24
2025-03-09 07:18:24,878 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0009 secs
2025-03-09 07:18:24,878 [INFO]: 		-> Adding the vectors to the index 03/09/2025, 07:18:24
2025-03-09 07:18:24,878 [INFO]: The memory available for adding the vectors is 49.4GB(total available - used by the index)
2025-03-09 07:18:24,879 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/14 [00:00<?, ?it/s]  7%|▋         | 1/14 [00:00<00:02,  6.24it/s] 21%|██▏       | 3/14 [00:00<00:00, 11.42it/s] 36%|███▌      | 5/14 [00:00<00:00, 13.14it/s] 50%|█████     | 7/14 [00:00<00:00, 14.32it/s] 64%|██████▍   | 9/14 [00:00<00:00, 14.86it/s] 79%|███████▊  | 11/14 [00:00<00:00, 15.40it/s] 93%|█████████▎| 13/14 [00:00<00:00, 15.38it/s]100%|██████████| 14/14 [00:03<00:00,  3.69it/s]
2025-03-09 07:18:28,685 [INFO]: 	Computing best hyperparameters for index knn.index 03/09/2025, 07:18:28
2025-03-09 07:19:07,439 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 38.7537 secs
2025-03-09 07:19:07,440 [INFO]: The best hyperparameters are: efSearch=243
2025-03-09 07:19:07,440 [INFO]: 	Compute fast metrics 03/09/2025, 07:19:07
  0%|          | 0/4 [00:00<?, ?it/s] 25%|██▌       | 1/4 [00:00<00:00,  5.45it/s] 75%|███████▌  | 3/4 [00:00<00:00,  8.24it/s] 75%|███████▌  | 3/4 [00:00<00:00,  5.89it/s]
2025-03-09 07:19:24,728 [INFO]: 	>>> Finished "Compute fast metrics" in 17.2881 secs
2025-03-09 07:19:24,731 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 59.8527 secs
2025-03-09 07:19:24,731 [INFO]: {
2025-03-09 07:19:24,731 [INFO]: 	index_key: HNSW15
2025-03-09 07:19:24,731 [INFO]: 	index_param: efSearch=243
2025-03-09 07:19:24,731 [INFO]: 	index_path: knn.index
2025-03-09 07:19:24,731 [INFO]: 	size in bytes: 696669910
2025-03-09 07:19:24,731 [INFO]: 	avg_search_speed_ms: 10.181683368170956
2025-03-09 07:19:24,731 [INFO]: 	99p_search_speed_ms: 17.408728816080824
2025-03-09 07:19:24,731 [INFO]: 	reconstruction error %: 0.0
2025-03-09 07:19:24,731 [INFO]: 	nb vectors: 3541
2025-03-09 07:19:24,731 [INFO]: 	vectors dimension: 49152
2025-03-09 07:19:24,731 [INFO]: 	compression ratio: 0.9993095984294772
2025-03-09 07:19:24,731 [INFO]: }
2025-03-09 07:19:24,731 [INFO]: 	>>> Finished "Creating the index" in 59.8541 secs
2025-03-09 07:19:24,731 [INFO]: >>> Finished "Launching the whole pipeline" in 59.8812 secs
2025-03-09 07:19:25: [retrieval_preprocessing] calculating distances ...
2025-03-09 07:19:26: [retrieval_preprocessing] finished and saved retrieval indices for episode 9799 [episode count 15/20]
[retrieval_preprocessing] for episode 70226 [episode count 16/20], we have num_retrieval=np.int64(3499) num_query=np.int64(159)
2025-03-09 07:19:27,716 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-09 07:19:28,283 [INFO]: Launching the whole pipeline 03/09/2025, 07:19:28
2025-03-09 07:19:28,283 [INFO]: Reading total number of vectors and dimension 03/09/2025, 07:19:28
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1386.55it/s]
2025-03-09 07:19:28,313 [INFO]: There are 3499 embeddings of dim 49152
2025-03-09 07:19:28,313 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0302 secs
2025-03-09 07:19:28,313 [INFO]: 	Compute estimated construction time of the index 03/09/2025, 07:19:28
2025-03-09 07:19:28,313 [INFO]: 		-> Train: 16.7 minutes
2025-03-09 07:19:28,313 [INFO]: 		-> Add: 1.9 seconds
2025-03-09 07:19:28,313 [INFO]: 		Total: 16.7 minutes
2025-03-09 07:19:28,313 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0001 secs
2025-03-09 07:19:28,313 [INFO]: 	Checking that your have enough memory available to create the index 03/09/2025, 07:19:28
2025-03-09 07:19:28,314 [INFO]: 722.1MB of memory will be needed to build the index (more might be used if you have more)
2025-03-09 07:19:28,314 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0002 secs
2025-03-09 07:19:28,314 [INFO]: 	Selecting most promising index types given data characteristics 03/09/2025, 07:19:28
2025-03-09 07:19:28,314 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-09 07:19:28,314 [INFO]: 	Creating the index 03/09/2025, 07:19:28
2025-03-09 07:19:28,314 [INFO]: 		-> Instanciate the index HNSW15 03/09/2025, 07:19:28
2025-03-09 07:19:28,316 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0015 secs
2025-03-09 07:19:28,316 [INFO]: 		-> Adding the vectors to the index 03/09/2025, 07:19:28
2025-03-09 07:19:28,316 [INFO]: The memory available for adding the vectors is 49.4GB(total available - used by the index)
2025-03-09 07:19:28,316 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/14 [00:00<?, ?it/s]  7%|▋         | 1/14 [00:00<00:02,  5.97it/s] 21%|██▏       | 3/14 [00:00<00:01,  8.95it/s] 36%|███▌      | 5/14 [00:00<00:00,  9.89it/s] 50%|█████     | 7/14 [00:00<00:00, 10.35it/s] 64%|██████▍   | 9/14 [00:00<00:00, 10.49it/s] 79%|███████▊  | 11/14 [00:01<00:00,  8.49it/s] 93%|█████████▎| 13/14 [00:01<00:00,  8.98it/s]100%|██████████| 14/14 [00:03<00:00,  1.71it/s]100%|██████████| 14/14 [00:03<00:00,  3.50it/s]
2025-03-09 07:19:32,320 [INFO]: 	Computing best hyperparameters for index knn.index 03/09/2025, 07:19:32
2025-03-09 07:20:13,217 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 40.8964 secs
2025-03-09 07:20:13,217 [INFO]: The best hyperparameters are: efSearch=206
2025-03-09 07:20:13,217 [INFO]: 	Compute fast metrics 03/09/2025, 07:20:13
  0%|          | 0/4 [00:00<?, ?it/s] 25%|██▌       | 1/4 [00:00<00:00,  4.25it/s] 50%|█████     | 2/4 [00:00<00:00,  5.83it/s] 75%|███████▌  | 3/4 [00:00<00:00,  6.45it/s] 75%|███████▌  | 3/4 [00:00<00:00,  4.86it/s]
2025-03-09 07:20:27,010 [INFO]: 	>>> Finished "Compute fast metrics" in 13.7923 secs
2025-03-09 07:20:27,012 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 58.6964 secs
2025-03-09 07:20:27,012 [INFO]: {
2025-03-09 07:20:27,012 [INFO]: 	index_key: HNSW15
2025-03-09 07:20:27,012 [INFO]: 	index_param: efSearch=206
2025-03-09 07:20:27,012 [INFO]: 	index_path: knn.index
2025-03-09 07:20:27,012 [INFO]: 	size in bytes: 688406710
2025-03-09 07:20:27,012 [INFO]: 	avg_search_speed_ms: 8.327927632911827
2025-03-09 07:20:27,012 [INFO]: 	99p_search_speed_ms: 15.12245088815689
2025-03-09 07:20:27,012 [INFO]: 	reconstruction error %: 0.0
2025-03-09 07:20:27,012 [INFO]: 	nb vectors: 3499
2025-03-09 07:20:27,013 [INFO]: 	vectors dimension: 49152
2025-03-09 07:20:27,013 [INFO]: 	compression ratio: 0.9993095389787819
2025-03-09 07:20:27,013 [INFO]: }
2025-03-09 07:20:27,013 [INFO]: 	>>> Finished "Creating the index" in 58.6986 secs
2025-03-09 07:20:27,013 [INFO]: >>> Finished "Launching the whole pipeline" in 58.7296 secs
2025-03-09 07:20:27: [retrieval_preprocessing] calculating distances ...
2025-03-09 07:20:28: [retrieval_preprocessing] finished and saved retrieval indices for episode 70226 [episode count 16/20]
[retrieval_preprocessing] for episode 89170 [episode count 17/20], we have num_retrieval=np.int64(3492) num_query=np.int64(166)
2025-03-09 07:20:28,969 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-09 07:20:29,408 [INFO]: Launching the whole pipeline 03/09/2025, 07:20:29
2025-03-09 07:20:29,408 [INFO]: Reading total number of vectors and dimension 03/09/2025, 07:20:29
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1709.17it/s]
2025-03-09 07:20:29,433 [INFO]: There are 3492 embeddings of dim 49152
2025-03-09 07:20:29,434 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0258 secs
2025-03-09 07:20:29,434 [INFO]: 	Compute estimated construction time of the index 03/09/2025, 07:20:29
2025-03-09 07:20:29,434 [INFO]: 		-> Train: 16.7 minutes
2025-03-09 07:20:29,434 [INFO]: 		-> Add: 1.9 seconds
2025-03-09 07:20:29,434 [INFO]: 		Total: 16.7 minutes
2025-03-09 07:20:29,434 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0003 secs
2025-03-09 07:20:29,434 [INFO]: 	Checking that your have enough memory available to create the index 03/09/2025, 07:20:29
2025-03-09 07:20:29,435 [INFO]: 720.7MB of memory will be needed to build the index (more might be used if you have more)
2025-03-09 07:20:29,435 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0004 secs
2025-03-09 07:20:29,435 [INFO]: 	Selecting most promising index types given data characteristics 03/09/2025, 07:20:29
2025-03-09 07:20:29,435 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-09 07:20:29,435 [INFO]: 	Creating the index 03/09/2025, 07:20:29
2025-03-09 07:20:29,435 [INFO]: 		-> Instanciate the index HNSW15 03/09/2025, 07:20:29
2025-03-09 07:20:29,438 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0028 secs
2025-03-09 07:20:29,438 [INFO]: 		-> Adding the vectors to the index 03/09/2025, 07:20:29
2025-03-09 07:20:29,439 [INFO]: The memory available for adding the vectors is 49.4GB(total available - used by the index)
2025-03-09 07:20:29,439 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/14 [00:00<?, ?it/s]  7%|▋         | 1/14 [00:00<00:02,  4.72it/s] 14%|█▍        | 2/14 [00:00<00:01,  6.17it/s] 21%|██▏       | 3/14 [00:00<00:01,  6.78it/s] 29%|██▊       | 4/14 [00:00<00:01,  7.22it/s] 36%|███▌      | 5/14 [00:00<00:01,  7.36it/s] 43%|████▎     | 6/14 [00:00<00:01,  7.48it/s] 50%|█████     | 7/14 [00:00<00:00,  7.53it/s] 57%|█████▋    | 8/14 [00:01<00:00,  7.55it/s] 64%|██████▍   | 9/14 [00:01<00:00,  7.67it/s] 71%|███████▏  | 10/14 [00:01<00:00,  7.64it/s] 79%|███████▊  | 11/14 [00:01<00:00,  7.57it/s] 86%|████████▌ | 12/14 [00:01<00:00,  7.54it/s] 93%|█████████▎| 13/14 [00:01<00:00,  7.51it/s]100%|██████████| 14/14 [00:04<00:00,  1.11it/s]100%|██████████| 14/14 [00:04<00:00,  3.13it/s]
2025-03-09 07:20:33,916 [INFO]: 	Computing best hyperparameters for index knn.index 03/09/2025, 07:20:33
2025-03-09 07:21:16,707 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 42.7907 secs
2025-03-09 07:21:16,707 [INFO]: The best hyperparameters are: efSearch=220
2025-03-09 07:21:16,707 [INFO]: 	Compute fast metrics 03/09/2025, 07:21:16
  0%|          | 0/4 [00:00<?, ?it/s] 25%|██▌       | 1/4 [00:00<00:00,  6.01it/s] 50%|█████     | 2/4 [00:00<00:00,  7.42it/s] 75%|███████▌  | 3/4 [00:00<00:00,  7.83it/s] 75%|███████▌  | 3/4 [00:00<00:00,  5.89it/s]
2025-03-09 07:21:30,116 [INFO]: 	>>> Finished "Compute fast metrics" in 13.4088 secs
2025-03-09 07:21:30,119 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 60.6803 secs
2025-03-09 07:21:30,119 [INFO]: {
2025-03-09 07:21:30,119 [INFO]: 	index_key: HNSW15
2025-03-09 07:21:30,119 [INFO]: 	index_param: efSearch=220
2025-03-09 07:21:30,119 [INFO]: 	index_path: knn.index
2025-03-09 07:21:30,119 [INFO]: 	size in bytes: 687029530
2025-03-09 07:21:30,119 [INFO]: 	avg_search_speed_ms: 9.350023745933425
2025-03-09 07:21:30,119 [INFO]: 	99p_search_speed_ms: 17.801978059578676
2025-03-09 07:21:30,119 [INFO]: 	reconstruction error %: 0.0
2025-03-09 07:21:30,119 [INFO]: 	nb vectors: 3492
2025-03-09 07:21:30,119 [INFO]: 	vectors dimension: 49152
2025-03-09 07:21:30,119 [INFO]: 	compression ratio: 0.9993094998405673
2025-03-09 07:21:30,119 [INFO]: }
2025-03-09 07:21:30,119 [INFO]: 	>>> Finished "Creating the index" in 60.6838 secs
2025-03-09 07:21:30,119 [INFO]: >>> Finished "Launching the whole pipeline" in 60.7114 secs
2025-03-09 07:21:30: [retrieval_preprocessing] calculating distances ...
2025-03-09 07:21:31: [retrieval_preprocessing] finished and saved retrieval indices for episode 89170 [episode count 17/20]
[retrieval_preprocessing] for episode 11872 [episode count 18/20], we have num_retrieval=np.int64(3244) num_query=np.int64(414)
2025-03-09 07:21:32,310 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-09 07:21:32,824 [INFO]: Launching the whole pipeline 03/09/2025, 07:21:32
2025-03-09 07:21:32,824 [INFO]: Reading total number of vectors and dimension 03/09/2025, 07:21:32
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 2104.52it/s]
2025-03-09 07:21:32,848 [INFO]: There are 3244 embeddings of dim 49152
2025-03-09 07:21:32,848 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0246 secs
2025-03-09 07:21:32,849 [INFO]: 	Compute estimated construction time of the index 03/09/2025, 07:21:32
2025-03-09 07:21:32,849 [INFO]: 		-> Train: 16.7 minutes
2025-03-09 07:21:32,849 [INFO]: 		-> Add: 1.8 seconds
2025-03-09 07:21:32,849 [INFO]: 		Total: 16.7 minutes
2025-03-09 07:21:32,849 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0001 secs
2025-03-09 07:21:32,849 [INFO]: 	Checking that your have enough memory available to create the index 03/09/2025, 07:21:32
2025-03-09 07:21:32,849 [INFO]: 669.5MB of memory will be needed to build the index (more might be used if you have more)
2025-03-09 07:21:32,849 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0001 secs
2025-03-09 07:21:32,849 [INFO]: 	Selecting most promising index types given data characteristics 03/09/2025, 07:21:32
2025-03-09 07:21:32,849 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-09 07:21:32,849 [INFO]: 	Creating the index 03/09/2025, 07:21:32
2025-03-09 07:21:32,849 [INFO]: 		-> Instanciate the index HNSW15 03/09/2025, 07:21:32
2025-03-09 07:21:32,850 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0008 secs
2025-03-09 07:21:32,850 [INFO]: 		-> Adding the vectors to the index 03/09/2025, 07:21:32
2025-03-09 07:21:32,850 [INFO]: The memory available for adding the vectors is 49.4GB(total available - used by the index)
2025-03-09 07:21:32,850 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/13 [00:00<?, ?it/s]  8%|▊         | 1/13 [00:00<00:01,  8.52it/s] 23%|██▎       | 3/13 [00:00<00:00, 12.16it/s] 38%|███▊      | 5/13 [00:00<00:00, 12.07it/s] 54%|█████▍    | 7/13 [00:00<00:00, 12.03it/s] 69%|██████▉   | 9/13 [00:00<00:00, 11.64it/s] 85%|████████▍ | 11/13 [00:00<00:00, 11.82it/s]100%|██████████| 13/13 [00:03<00:00,  2.41it/s]100%|██████████| 13/13 [00:03<00:00,  4.20it/s]
2025-03-09 07:21:35,953 [INFO]: 	Computing best hyperparameters for index knn.index 03/09/2025, 07:21:35
2025-03-09 07:22:14,520 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 38.5656 secs
2025-03-09 07:22:14,520 [INFO]: The best hyperparameters are: efSearch=243
2025-03-09 07:22:14,520 [INFO]: 	Compute fast metrics 03/09/2025, 07:22:14
  0%|          | 0/4 [00:00<?, ?it/s] 25%|██▌       | 1/4 [00:00<00:00,  5.59it/s] 75%|███████▌  | 3/4 [00:00<00:00,  8.84it/s] 75%|███████▌  | 3/4 [00:00<00:00,  6.73it/s]
2025-03-09 07:22:28,889 [INFO]: 	>>> Finished "Compute fast metrics" in 14.3696 secs
2025-03-09 07:22:28,892 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 56.0425 secs
2025-03-09 07:22:28,893 [INFO]: {
2025-03-09 07:22:28,893 [INFO]: 	index_key: HNSW15
2025-03-09 07:22:28,893 [INFO]: 	index_param: efSearch=243
2025-03-09 07:22:28,893 [INFO]: 	index_path: knn.index
2025-03-09 07:22:28,893 [INFO]: 	size in bytes: 638237230
2025-03-09 07:22:28,893 [INFO]: 	avg_search_speed_ms: 9.52830447261
2025-03-09 07:22:28,893 [INFO]: 	99p_search_speed_ms: 15.158415837213395
2025-03-09 07:22:28,893 [INFO]: 	reconstruction error %: 0.0
2025-03-09 07:22:28,893 [INFO]: 	nb vectors: 3244
2025-03-09 07:22:28,893 [INFO]: 	vectors dimension: 49152
2025-03-09 07:22:28,893 [INFO]: 	compression ratio: 0.9993092255053815
2025-03-09 07:22:28,893 [INFO]: }
2025-03-09 07:22:28,893 [INFO]: 	>>> Finished "Creating the index" in 56.0442 secs
2025-03-09 07:22:28,893 [INFO]: >>> Finished "Launching the whole pipeline" in 56.0693 secs
2025-03-09 07:22:31: [retrieval_preprocessing] calculating distances ...
2025-03-09 07:22:33: [retrieval_preprocessing] finished and saved retrieval indices for episode 11872 [episode count 18/20]
[retrieval_preprocessing] for episode 85604 [episode count 19/20], we have num_retrieval=np.int64(3550) num_query=np.int64(108)
2025-03-09 07:22:34,376 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-09 07:22:34,980 [INFO]: Launching the whole pipeline 03/09/2025, 07:22:34
2025-03-09 07:22:34,980 [INFO]: Reading total number of vectors and dimension 03/09/2025, 07:22:34
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1533.01it/s]
2025-03-09 07:22:35,009 [INFO]: There are 3550 embeddings of dim 49152
2025-03-09 07:22:35,009 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0287 secs
2025-03-09 07:22:35,009 [INFO]: 	Compute estimated construction time of the index 03/09/2025, 07:22:35
2025-03-09 07:22:35,009 [INFO]: 		-> Train: 16.7 minutes
2025-03-09 07:22:35,009 [INFO]: 		-> Add: 2.0 seconds
2025-03-09 07:22:35,009 [INFO]: 		Total: 16.7 minutes
2025-03-09 07:22:35,009 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0001 secs
2025-03-09 07:22:35,009 [INFO]: 	Checking that your have enough memory available to create the index 03/09/2025, 07:22:35
2025-03-09 07:22:35,010 [INFO]: 732.6MB of memory will be needed to build the index (more might be used if you have more)
2025-03-09 07:22:35,010 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0001 secs
2025-03-09 07:22:35,010 [INFO]: 	Selecting most promising index types given data characteristics 03/09/2025, 07:22:35
2025-03-09 07:22:35,010 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-09 07:22:35,010 [INFO]: 	Creating the index 03/09/2025, 07:22:35
2025-03-09 07:22:35,010 [INFO]: 		-> Instanciate the index HNSW15 03/09/2025, 07:22:35
2025-03-09 07:22:35,011 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0010 secs
2025-03-09 07:22:35,011 [INFO]: 		-> Adding the vectors to the index 03/09/2025, 07:22:35
2025-03-09 07:22:35,011 [INFO]: The memory available for adding the vectors is 49.3GB(total available - used by the index)
2025-03-09 07:22:35,011 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/14 [00:00<?, ?it/s]  7%|▋         | 1/14 [00:00<00:02,  4.91it/s] 21%|██▏       | 3/14 [00:00<00:01,  8.47it/s] 29%|██▊       | 4/14 [00:00<00:01,  8.61it/s] 43%|████▎     | 6/14 [00:00<00:00, 10.65it/s] 57%|█████▋    | 8/14 [00:00<00:00, 11.24it/s] 71%|███████▏  | 10/14 [00:00<00:00, 10.74it/s] 86%|████████▌ | 12/14 [00:01<00:00, 10.53it/s]100%|██████████| 14/14 [00:03<00:00,  2.16it/s]100%|██████████| 14/14 [00:03<00:00,  3.88it/s]
2025-03-09 07:22:38,626 [INFO]: 	Computing best hyperparameters for index knn.index 03/09/2025, 07:22:38
2025-03-09 07:23:17,434 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 38.8073 secs
2025-03-09 07:23:17,434 [INFO]: The best hyperparameters are: efSearch=261
2025-03-09 07:23:17,434 [INFO]: 	Compute fast metrics 03/09/2025, 07:23:17
  0%|          | 0/4 [00:00<?, ?it/s] 25%|██▌       | 1/4 [00:00<00:00,  4.03it/s] 50%|█████     | 2/4 [00:00<00:00,  6.07it/s] 75%|███████▌  | 3/4 [00:00<00:00,  5.72it/s]
2025-03-09 07:23:30,347 [INFO]: 	>>> Finished "Compute fast metrics" in 12.9129 secs
2025-03-09 07:23:30,349 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 55.3386 secs
2025-03-09 07:23:30,350 [INFO]: {
2025-03-09 07:23:30,350 [INFO]: 	index_key: HNSW15
2025-03-09 07:23:30,350 [INFO]: 	index_param: efSearch=261
2025-03-09 07:23:30,350 [INFO]: 	index_path: knn.index
2025-03-09 07:23:30,350 [INFO]: 	size in bytes: 698440690
2025-03-09 07:23:30,350 [INFO]: 	avg_search_speed_ms: 9.74463771198021
2025-03-09 07:23:30,350 [INFO]: 	99p_search_speed_ms: 14.315934865735471
2025-03-09 07:23:30,350 [INFO]: 	reconstruction error %: 0.0
2025-03-09 07:23:30,350 [INFO]: 	nb vectors: 3550
2025-03-09 07:23:30,350 [INFO]: 	vectors dimension: 49152
2025-03-09 07:23:30,350 [INFO]: 	compression ratio: 0.9993094760845047
2025-03-09 07:23:30,350 [INFO]: }
2025-03-09 07:23:30,350 [INFO]: 	>>> Finished "Creating the index" in 55.3401 secs
2025-03-09 07:23:30,350 [INFO]: >>> Finished "Launching the whole pipeline" in 55.3694 secs
2025-03-09 07:23:31: [retrieval_preprocessing] calculating distances ...
2025-03-09 07:23:31: [retrieval_preprocessing] finished and saved retrieval indices for episode 85604 [episode count 19/20]
2025-03-09 07:23:31: [retrieval_preprocessing] finished for (9088223759, 'bottle') [chosen_id count 1/10]
2025-03-09 07:23:35: [retrieval_preprocessing] concatenated all embeddings and indices for 20 episodes for (8098563998, 'lid') [chosen_id count 2/10]
2025-03-09 07:23:35: [retrieval_preprocessing] we have num_total=5766 embedding_dim=49152
[retrieval_preprocessing] for episode 44673 [episode count 0/20], we have num_retrieval=np.int64(5455) num_query=np.int64(311)
2025-03-09 07:23:42,367 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-09 07:23:43,134 [INFO]: Launching the whole pipeline 03/09/2025, 07:23:43
2025-03-09 07:23:43,134 [INFO]: Reading total number of vectors and dimension 03/09/2025, 07:23:43
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1869.12it/s]
2025-03-09 07:23:43,160 [INFO]: There are 5455 embeddings of dim 49152
2025-03-09 07:23:43,160 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0257 secs
2025-03-09 07:23:43,160 [INFO]: 	Compute estimated construction time of the index 03/09/2025, 07:23:43
2025-03-09 07:23:43,160 [INFO]: 		-> Train: 16.7 minutes
2025-03-09 07:23:43,160 [INFO]: 		-> Add: 3.0 seconds
2025-03-09 07:23:43,160 [INFO]: 		Total: 16.7 minutes
2025-03-09 07:23:43,160 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0001 secs
2025-03-09 07:23:43,160 [INFO]: 	Checking that your have enough memory available to create the index 03/09/2025, 07:23:43
2025-03-09 07:23:43,160 [INFO]: 1.1GB of memory will be needed to build the index (more might be used if you have more)
2025-03-09 07:23:43,161 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0001 secs
2025-03-09 07:23:43,161 [INFO]: 	Selecting most promising index types given data characteristics 03/09/2025, 07:23:43
2025-03-09 07:23:43,161 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-09 07:23:43,161 [INFO]: 	Creating the index 03/09/2025, 07:23:43
2025-03-09 07:23:43,161 [INFO]: 		-> Instanciate the index HNSW15 03/09/2025, 07:23:43
2025-03-09 07:23:43,162 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0010 secs
2025-03-09 07:23:43,162 [INFO]: 		-> Adding the vectors to the index 03/09/2025, 07:23:43
2025-03-09 07:23:43,162 [INFO]: The memory available for adding the vectors is 49.0GB(total available - used by the index)
2025-03-09 07:23:43,162 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/23 [00:00<?, ?it/s]  4%|▍         | 1/23 [00:00<00:04,  4.61it/s] 13%|█▎        | 3/23 [00:00<00:02,  8.97it/s] 22%|██▏       | 5/23 [00:00<00:01, 10.86it/s] 30%|███       | 7/23 [00:00<00:01, 12.63it/s] 39%|███▉      | 9/23 [00:00<00:01, 13.67it/s] 48%|████▊     | 11/23 [00:00<00:00, 14.38it/s] 57%|█████▋    | 13/23 [00:01<00:00, 13.16it/s] 70%|██████▉   | 16/23 [00:01<00:00, 14.50it/s] 78%|███████▊  | 18/23 [00:01<00:00, 13.16it/s] 87%|████████▋ | 20/23 [00:01<00:00, 12.20it/s] 96%|█████████▌| 22/23 [00:05<00:00,  1.74it/s]100%|██████████| 23/23 [00:06<00:00,  1.45it/s]100%|██████████| 23/23 [00:06<00:00,  3.58it/s]
2025-03-09 07:23:49,584 [INFO]: 	Computing best hyperparameters for index knn.index 03/09/2025, 07:23:49
2025-03-09 07:24:38,049 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 48.4650 secs
2025-03-09 07:24:38,049 [INFO]: The best hyperparameters are: efSearch=310
2025-03-09 07:24:38,049 [INFO]: 	Compute fast metrics 03/09/2025, 07:24:38
  0%|          | 0/4 [00:00<?, ?it/s] 25%|██▌       | 1/4 [00:00<00:01,  2.34it/s] 50%|█████     | 2/4 [00:00<00:00,  2.20it/s] 75%|███████▌  | 3/4 [00:01<00:00,  2.04it/s] 75%|███████▌  | 3/4 [00:01<00:00,  1.84it/s]
2025-03-09 07:24:53,396 [INFO]: 	>>> Finished "Compute fast metrics" in 15.3465 secs
2025-03-09 07:24:53,396 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 70.2347 secs
2025-03-09 07:24:53,397 [INFO]: {
2025-03-09 07:24:53,397 [INFO]: 	index_key: HNSW15
2025-03-09 07:24:53,397 [INFO]: 	index_param: efSearch=310
2025-03-09 07:24:53,397 [INFO]: 	index_path: knn.index
2025-03-09 07:24:53,397 [INFO]: 	size in bytes: 1073239330
2025-03-09 07:24:53,397 [INFO]: 	avg_search_speed_ms: 9.725349606806729
2025-03-09 07:24:53,397 [INFO]: 	99p_search_speed_ms: 14.005945585668089
2025-03-09 07:24:53,397 [INFO]: 	reconstruction error %: 0.0
2025-03-09 07:24:53,397 [INFO]: 	nb vectors: 5455
2025-03-09 07:24:53,397 [INFO]: 	vectors dimension: 49152
2025-03-09 07:24:53,397 [INFO]: 	compression ratio: 0.9993079921884711
2025-03-09 07:24:53,397 [INFO]: }
2025-03-09 07:24:53,397 [INFO]: 	>>> Finished "Creating the index" in 70.2361 secs
2025-03-09 07:24:53,397 [INFO]: >>> Finished "Launching the whole pipeline" in 70.2623 secs
2025-03-09 07:24:55: [retrieval_preprocessing] calculating distances ...
2025-03-09 07:24:56: [retrieval_preprocessing] finished and saved retrieval indices for episode 44673 [episode count 0/20]
[retrieval_preprocessing] for episode 88068 [episode count 1/20], we have num_retrieval=np.int64(5508) num_query=np.int64(258)
2025-03-09 07:24:58,035 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-09 07:24:58,784 [INFO]: Launching the whole pipeline 03/09/2025, 07:24:58
2025-03-09 07:24:58,784 [INFO]: Reading total number of vectors and dimension 03/09/2025, 07:24:58
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 2107.69it/s]
2025-03-09 07:24:58,810 [INFO]: There are 5508 embeddings of dim 49152
2025-03-09 07:24:58,810 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0261 secs
2025-03-09 07:24:58,810 [INFO]: 	Compute estimated construction time of the index 03/09/2025, 07:24:58
2025-03-09 07:24:58,810 [INFO]: 		-> Train: 16.7 minutes
2025-03-09 07:24:58,810 [INFO]: 		-> Add: 3.0 seconds
2025-03-09 07:24:58,810 [INFO]: 		Total: 16.7 minutes
2025-03-09 07:24:58,810 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0001 secs
2025-03-09 07:24:58,810 [INFO]: 	Checking that your have enough memory available to create the index 03/09/2025, 07:24:58
2025-03-09 07:24:58,810 [INFO]: 1.1GB of memory will be needed to build the index (more might be used if you have more)
2025-03-09 07:24:58,810 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0001 secs
2025-03-09 07:24:58,810 [INFO]: 	Selecting most promising index types given data characteristics 03/09/2025, 07:24:58
2025-03-09 07:24:58,810 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-09 07:24:58,810 [INFO]: 	Creating the index 03/09/2025, 07:24:58
2025-03-09 07:24:58,811 [INFO]: 		-> Instanciate the index HNSW15 03/09/2025, 07:24:58
2025-03-09 07:24:58,812 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0010 secs
2025-03-09 07:24:58,812 [INFO]: 		-> Adding the vectors to the index 03/09/2025, 07:24:58
2025-03-09 07:24:58,812 [INFO]: The memory available for adding the vectors is 49.0GB(total available - used by the index)
2025-03-09 07:24:58,812 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/23 [00:00<?, ?it/s]  4%|▍         | 1/23 [00:00<00:02,  7.92it/s] 13%|█▎        | 3/23 [00:00<00:01, 13.60it/s] 22%|██▏       | 5/23 [00:00<00:01, 15.01it/s] 30%|███       | 7/23 [00:00<00:00, 16.24it/s] 39%|███▉      | 9/23 [00:00<00:00, 16.92it/s] 48%|████▊     | 11/23 [00:00<00:00, 16.93it/s] 57%|█████▋    | 13/23 [00:00<00:00, 17.23it/s] 65%|██████▌   | 15/23 [00:00<00:00, 15.07it/s] 74%|███████▍  | 17/23 [00:01<00:00, 13.99it/s] 83%|████████▎ | 19/23 [00:01<00:00, 13.50it/s] 91%|█████████▏| 21/23 [00:04<00:01,  1.83it/s]100%|██████████| 23/23 [00:05<00:00,  1.80it/s]100%|██████████| 23/23 [00:05<00:00,  4.05it/s]
2025-03-09 07:25:04,494 [INFO]: 	Computing best hyperparameters for index knn.index 03/09/2025, 07:25:04
2025-03-09 07:25:47,415 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 42.9205 secs
2025-03-09 07:25:47,415 [INFO]: The best hyperparameters are: efSearch=252
2025-03-09 07:25:47,416 [INFO]: 	Compute fast metrics 03/09/2025, 07:25:47
  0%|          | 0/4 [00:00<?, ?it/s] 50%|█████     | 2/4 [00:00<00:00, 19.33it/s] 75%|███████▌  | 3/4 [00:00<00:00, 21.70it/s]
2025-03-09 07:26:02,828 [INFO]: 	>>> Finished "Compute fast metrics" in 15.4123 secs
2025-03-09 07:26:02,829 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 64.0170 secs
2025-03-09 07:26:02,829 [INFO]: {
2025-03-09 07:26:02,829 [INFO]: 	index_key: HNSW15
2025-03-09 07:26:02,829 [INFO]: 	index_param: efSearch=252
2025-03-09 07:26:02,829 [INFO]: 	index_path: knn.index
2025-03-09 07:26:02,829 [INFO]: 	size in bytes: 1083666730
2025-03-09 07:26:02,829 [INFO]: 	avg_search_speed_ms: 9.305104505877162
2025-03-09 07:26:02,829 [INFO]: 	99p_search_speed_ms: 15.606900937855244
2025-03-09 07:26:02,829 [INFO]: 	reconstruction error %: 0.0
2025-03-09 07:26:02,829 [INFO]: 	nb vectors: 5508
2025-03-09 07:26:02,829 [INFO]: 	vectors dimension: 49152
2025-03-09 07:26:02,829 [INFO]: 	compression ratio: 0.9993080289546215
2025-03-09 07:26:02,829 [INFO]: }
2025-03-09 07:26:02,829 [INFO]: 	>>> Finished "Creating the index" in 64.0185 secs
2025-03-09 07:26:02,829 [INFO]: >>> Finished "Launching the whole pipeline" in 64.0451 secs
2025-03-09 07:26:04: [retrieval_preprocessing] calculating distances ...
2025-03-09 07:26:05: [retrieval_preprocessing] finished and saved retrieval indices for episode 88068 [episode count 1/20]
[retrieval_preprocessing] for episode 89477 [episode count 2/20], we have num_retrieval=np.int64(5447) num_query=np.int64(319)
2025-03-09 07:26:06,732 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-09 07:26:07,523 [INFO]: Launching the whole pipeline 03/09/2025, 07:26:07
2025-03-09 07:26:07,523 [INFO]: Reading total number of vectors and dimension 03/09/2025, 07:26:07
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1454.34it/s]
2025-03-09 07:26:07,550 [INFO]: There are 5447 embeddings of dim 49152
2025-03-09 07:26:07,550 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0271 secs
2025-03-09 07:26:07,551 [INFO]: 	Compute estimated construction time of the index 03/09/2025, 07:26:07
2025-03-09 07:26:07,551 [INFO]: 		-> Train: 16.7 minutes
2025-03-09 07:26:07,551 [INFO]: 		-> Add: 3.0 seconds
2025-03-09 07:26:07,551 [INFO]: 		Total: 16.7 minutes
2025-03-09 07:26:07,551 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0001 secs
2025-03-09 07:26:07,551 [INFO]: 	Checking that your have enough memory available to create the index 03/09/2025, 07:26:07
2025-03-09 07:26:07,551 [INFO]: 1.1GB of memory will be needed to build the index (more might be used if you have more)
2025-03-09 07:26:07,551 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0002 secs
2025-03-09 07:26:07,551 [INFO]: 	Selecting most promising index types given data characteristics 03/09/2025, 07:26:07
2025-03-09 07:26:07,551 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-09 07:26:07,551 [INFO]: 	Creating the index 03/09/2025, 07:26:07
2025-03-09 07:26:07,551 [INFO]: 		-> Instanciate the index HNSW15 03/09/2025, 07:26:07
2025-03-09 07:26:07,552 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0011 secs
2025-03-09 07:26:07,552 [INFO]: 		-> Adding the vectors to the index 03/09/2025, 07:26:07
2025-03-09 07:26:07,552 [INFO]: The memory available for adding the vectors is 49.0GB(total available - used by the index)
2025-03-09 07:26:07,552 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/23 [00:00<?, ?it/s]  4%|▍         | 1/23 [00:00<00:03,  5.82it/s] 13%|█▎        | 3/23 [00:00<00:01, 10.69it/s] 22%|██▏       | 5/23 [00:00<00:01, 11.93it/s] 30%|███       | 7/23 [00:00<00:01, 11.91it/s] 39%|███▉      | 9/23 [00:00<00:01, 13.08it/s] 48%|████▊     | 11/23 [00:00<00:00, 13.07it/s] 57%|█████▋    | 13/23 [00:01<00:00, 13.08it/s] 65%|██████▌   | 15/23 [00:01<00:00, 13.16it/s] 74%|███████▍  | 17/23 [00:01<00:00, 12.66it/s] 83%|████████▎ | 19/23 [00:01<00:00, 12.29it/s] 91%|█████████▏| 21/23 [00:05<00:01,  1.62it/s] 96%|█████████▌| 22/23 [00:05<00:00,  1.89it/s]100%|██████████| 23/23 [00:06<00:00,  1.40it/s]100%|██████████| 23/23 [00:06<00:00,  3.41it/s]
2025-03-09 07:26:14,307 [INFO]: 	Computing best hyperparameters for index knn.index 03/09/2025, 07:26:14
2025-03-09 07:26:58,859 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 44.5518 secs
2025-03-09 07:26:58,859 [INFO]: The best hyperparameters are: efSearch=275
2025-03-09 07:26:58,859 [INFO]: 	Compute fast metrics 03/09/2025, 07:26:58
  0%|          | 0/4 [00:00<?, ?it/s] 25%|██▌       | 1/4 [00:00<00:00,  5.70it/s] 75%|███████▌  | 3/4 [00:00<00:00,  8.96it/s] 75%|███████▌  | 3/4 [00:00<00:00,  6.89it/s]
2025-03-09 07:27:13,232 [INFO]: 	>>> Finished "Compute fast metrics" in 14.3724 secs
2025-03-09 07:27:13,232 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 65.6798 secs
2025-03-09 07:27:13,232 [INFO]: {
2025-03-09 07:27:13,232 [INFO]: 	index_key: HNSW15
2025-03-09 07:27:13,232 [INFO]: 	index_param: efSearch=275
2025-03-09 07:27:13,232 [INFO]: 	index_path: knn.index
2025-03-09 07:27:13,232 [INFO]: 	size in bytes: 1071665290
2025-03-09 07:27:13,232 [INFO]: 	avg_search_speed_ms: 9.071680198688933
2025-03-09 07:27:13,232 [INFO]: 	99p_search_speed_ms: 13.558145102579147
2025-03-09 07:27:13,232 [INFO]: 	reconstruction error %: 0.0
2025-03-09 07:27:13,232 [INFO]: 	nb vectors: 5447
2025-03-09 07:27:13,232 [INFO]: 	vectors dimension: 49152
2025-03-09 07:27:13,232 [INFO]: 	compression ratio: 0.9993080731391422
2025-03-09 07:27:13,232 [INFO]: }
2025-03-09 07:27:13,232 [INFO]: 	>>> Finished "Creating the index" in 65.6813 secs
2025-03-09 07:27:13,232 [INFO]: >>> Finished "Launching the whole pipeline" in 65.7091 secs
2025-03-09 07:27:15: [retrieval_preprocessing] calculating distances ...
2025-03-09 07:27:16: [retrieval_preprocessing] finished and saved retrieval indices for episode 89477 [episode count 2/20]
[retrieval_preprocessing] for episode 4614 [episode count 3/20], we have num_retrieval=np.int64(5542) num_query=np.int64(224)
2025-03-09 07:27:17,730 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-09 07:27:18,530 [INFO]: Launching the whole pipeline 03/09/2025, 07:27:18
2025-03-09 07:27:18,530 [INFO]: Reading total number of vectors and dimension 03/09/2025, 07:27:18
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1781.02it/s]
2025-03-09 07:27:18,556 [INFO]: There are 5542 embeddings of dim 49152
2025-03-09 07:27:18,556 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0254 secs
2025-03-09 07:27:18,556 [INFO]: 	Compute estimated construction time of the index 03/09/2025, 07:27:18
2025-03-09 07:27:18,556 [INFO]: 		-> Train: 16.7 minutes
2025-03-09 07:27:18,556 [INFO]: 		-> Add: 3.0 seconds
2025-03-09 07:27:18,556 [INFO]: 		Total: 16.7 minutes
2025-03-09 07:27:18,556 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0001 secs
2025-03-09 07:27:18,556 [INFO]: 	Checking that your have enough memory available to create the index 03/09/2025, 07:27:18
2025-03-09 07:27:18,556 [INFO]: 1.1GB of memory will be needed to build the index (more might be used if you have more)
2025-03-09 07:27:18,556 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0001 secs
2025-03-09 07:27:18,556 [INFO]: 	Selecting most promising index types given data characteristics 03/09/2025, 07:27:18
2025-03-09 07:27:18,556 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-09 07:27:18,556 [INFO]: 	Creating the index 03/09/2025, 07:27:18
2025-03-09 07:27:18,556 [INFO]: 		-> Instanciate the index HNSW15 03/09/2025, 07:27:18
2025-03-09 07:27:18,557 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0009 secs
2025-03-09 07:27:18,557 [INFO]: 		-> Adding the vectors to the index 03/09/2025, 07:27:18
2025-03-09 07:27:18,557 [INFO]: The memory available for adding the vectors is 49.0GB(total available - used by the index)
2025-03-09 07:27:18,558 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/23 [00:00<?, ?it/s]  4%|▍         | 1/23 [00:00<00:03,  6.36it/s] 17%|█▋        | 4/23 [00:00<00:01, 15.38it/s] 26%|██▌       | 6/23 [00:00<00:01, 14.99it/s] 35%|███▍      | 8/23 [00:00<00:01, 13.78it/s] 43%|████▎     | 10/23 [00:00<00:01, 12.39it/s] 52%|█████▏    | 12/23 [00:01<00:01, 10.76it/s] 61%|██████    | 14/23 [00:01<00:00, 10.10it/s] 70%|██████▉   | 16/23 [00:01<00:00,  9.90it/s] 78%|███████▊  | 18/23 [00:01<00:00,  9.84it/s] 87%|████████▋ | 20/23 [00:01<00:00,  9.89it/s] 96%|█████████▌| 22/23 [00:05<00:00,  1.69it/s]100%|██████████| 23/23 [00:06<00:00,  1.46it/s]100%|██████████| 23/23 [00:06<00:00,  3.60it/s]
2025-03-09 07:27:24,954 [INFO]: 	Computing best hyperparameters for index knn.index 03/09/2025, 07:27:24
2025-03-09 07:28:05,128 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 40.1732 secs
2025-03-09 07:28:05,128 [INFO]: The best hyperparameters are: efSearch=297
2025-03-09 07:28:05,128 [INFO]: 	Compute fast metrics 03/09/2025, 07:28:05
  0%|          | 0/4 [00:00<?, ?it/s] 25%|██▌       | 1/4 [00:00<00:00,  6.96it/s] 75%|███████▌  | 3/4 [00:00<00:00,  9.38it/s] 75%|███████▌  | 3/4 [00:00<00:00,  6.99it/s]
2025-03-09 07:28:22,276 [INFO]: 	>>> Finished "Compute fast metrics" in 17.1476 secs
2025-03-09 07:28:22,276 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 63.7189 secs
2025-03-09 07:28:22,276 [INFO]: {
2025-03-09 07:28:22,276 [INFO]: 	index_key: HNSW15
2025-03-09 07:28:22,276 [INFO]: 	index_param: efSearch=297
2025-03-09 07:28:22,276 [INFO]: 	index_path: knn.index
2025-03-09 07:28:22,276 [INFO]: 	size in bytes: 1090356070
2025-03-09 07:28:22,277 [INFO]: 	avg_search_speed_ms: 10.0557144300722
2025-03-09 07:28:22,277 [INFO]: 	99p_search_speed_ms: 15.585878179408605
2025-03-09 07:28:22,277 [INFO]: 	reconstruction error %: 0.0
2025-03-09 07:28:22,277 [INFO]: 	nb vectors: 5542
2025-03-09 07:28:22,277 [INFO]: 	vectors dimension: 49152
2025-03-09 07:28:22,277 [INFO]: 	compression ratio: 0.9993079930302035
2025-03-09 07:28:22,277 [INFO]: }
2025-03-09 07:28:22,277 [INFO]: 	>>> Finished "Creating the index" in 63.7202 secs
2025-03-09 07:28:22,277 [INFO]: >>> Finished "Launching the whole pipeline" in 63.7462 secs
2025-03-09 07:28:23: [retrieval_preprocessing] calculating distances ...
2025-03-09 07:28:24: [retrieval_preprocessing] finished and saved retrieval indices for episode 4614 [episode count 3/20]
[retrieval_preprocessing] for episode 30987 [episode count 4/20], we have num_retrieval=np.int64(5453) num_query=np.int64(313)
2025-03-09 07:28:26,532 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-09 07:28:27,521 [INFO]: Launching the whole pipeline 03/09/2025, 07:28:27
2025-03-09 07:28:27,521 [INFO]: Reading total number of vectors and dimension 03/09/2025, 07:28:27
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 2348.43it/s]
2025-03-09 07:28:27,543 [INFO]: There are 5453 embeddings of dim 49152
2025-03-09 07:28:27,544 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0220 secs
2025-03-09 07:28:27,544 [INFO]: 	Compute estimated construction time of the index 03/09/2025, 07:28:27
2025-03-09 07:28:27,544 [INFO]: 		-> Train: 16.7 minutes
2025-03-09 07:28:27,544 [INFO]: 		-> Add: 3.0 seconds
2025-03-09 07:28:27,544 [INFO]: 		Total: 16.7 minutes
2025-03-09 07:28:27,544 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0001 secs
2025-03-09 07:28:27,544 [INFO]: 	Checking that your have enough memory available to create the index 03/09/2025, 07:28:27
2025-03-09 07:28:27,544 [INFO]: 1.1GB of memory will be needed to build the index (more might be used if you have more)
2025-03-09 07:28:27,544 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0001 secs
2025-03-09 07:28:27,544 [INFO]: 	Selecting most promising index types given data characteristics 03/09/2025, 07:28:27
2025-03-09 07:28:27,544 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-09 07:28:27,544 [INFO]: 	Creating the index 03/09/2025, 07:28:27
2025-03-09 07:28:27,544 [INFO]: 		-> Instanciate the index HNSW15 03/09/2025, 07:28:27
2025-03-09 07:28:27,545 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0008 secs
2025-03-09 07:28:27,545 [INFO]: 		-> Adding the vectors to the index 03/09/2025, 07:28:27
2025-03-09 07:28:27,545 [INFO]: The memory available for adding the vectors is 49.0GB(total available - used by the index)
2025-03-09 07:28:27,545 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/23 [00:00<?, ?it/s]  4%|▍         | 1/23 [00:00<00:04,  4.68it/s]  9%|▊         | 2/23 [00:00<00:03,  6.74it/s] 13%|█▎        | 3/23 [00:00<00:02,  7.81it/s] 17%|█▋        | 4/23 [00:00<00:02,  8.41it/s] 22%|██▏       | 5/23 [00:00<00:02,  8.81it/s] 26%|██▌       | 6/23 [00:00<00:01,  9.03it/s] 35%|███▍      | 8/23 [00:00<00:01,  9.65it/s] 43%|████▎     | 10/23 [00:01<00:01, 10.18it/s] 52%|█████▏    | 12/23 [00:01<00:01, 10.12it/s] 61%|██████    | 14/23 [00:01<00:00, 10.16it/s] 70%|██████▉   | 16/23 [00:01<00:00, 10.57it/s] 78%|███████▊  | 18/23 [00:01<00:00, 11.36it/s] 87%|████████▋ | 20/23 [00:01<00:00, 12.36it/s] 96%|█████████▌| 22/23 [00:05<00:00,  1.56it/s]100%|██████████| 23/23 [00:06<00:00,  1.41it/s]100%|██████████| 23/23 [00:06<00:00,  3.40it/s]
2025-03-09 07:28:34,309 [INFO]: 	Computing best hyperparameters for index knn.index 03/09/2025, 07:28:34
2025-03-09 07:29:20,008 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 45.6989 secs
2025-03-09 07:29:20,009 [INFO]: The best hyperparameters are: efSearch=281
2025-03-09 07:29:20,009 [INFO]: 	Compute fast metrics 03/09/2025, 07:29:20
  0%|          | 0/4 [00:00<?, ?it/s] 25%|██▌       | 1/4 [00:00<00:00,  5.31it/s] 50%|█████     | 2/4 [00:00<00:00,  6.78it/s] 75%|███████▌  | 3/4 [00:00<00:00,  7.49it/s] 75%|███████▌  | 3/4 [00:00<00:00,  5.71it/s]
2025-03-09 07:29:34,589 [INFO]: 	>>> Finished "Compute fast metrics" in 14.5797 secs
2025-03-09 07:29:34,589 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 67.0444 secs
2025-03-09 07:29:34,589 [INFO]: {
2025-03-09 07:29:34,589 [INFO]: 	index_key: HNSW15
2025-03-09 07:29:34,589 [INFO]: 	index_param: efSearch=281
2025-03-09 07:29:34,589 [INFO]: 	index_path: knn.index
2025-03-09 07:29:34,590 [INFO]: 	size in bytes: 1072845790
2025-03-09 07:29:34,590 [INFO]: 	avg_search_speed_ms: 9.90710126254523
2025-03-09 07:29:34,590 [INFO]: 	99p_search_speed_ms: 19.815733935683966
2025-03-09 07:29:34,590 [INFO]: 	reconstruction error %: 0.0
2025-03-09 07:29:34,590 [INFO]: 	nb vectors: 5453
2025-03-09 07:29:34,590 [INFO]: 	vectors dimension: 49152
2025-03-09 07:29:34,590 [INFO]: 	compression ratio: 0.9993080403475322
2025-03-09 07:29:34,590 [INFO]: }
2025-03-09 07:29:34,590 [INFO]: 	>>> Finished "Creating the index" in 67.0456 secs
2025-03-09 07:29:34,590 [INFO]: >>> Finished "Launching the whole pipeline" in 67.0682 secs
2025-03-09 07:29:36: [retrieval_preprocessing] calculating distances ...
2025-03-09 07:29:38: [retrieval_preprocessing] finished and saved retrieval indices for episode 30987 [episode count 4/20]
[retrieval_preprocessing] for episode 36107 [episode count 5/20], we have num_retrieval=np.int64(5503) num_query=np.int64(263)
2025-03-09 07:29:40,480 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-09 07:29:41,429 [INFO]: Launching the whole pipeline 03/09/2025, 07:29:41
2025-03-09 07:29:41,429 [INFO]: Reading total number of vectors and dimension 03/09/2025, 07:29:41
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1438.38it/s]
2025-03-09 07:29:41,459 [INFO]: There are 5503 embeddings of dim 49152
2025-03-09 07:29:41,459 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0298 secs
2025-03-09 07:29:41,459 [INFO]: 	Compute estimated construction time of the index 03/09/2025, 07:29:41
2025-03-09 07:29:41,459 [INFO]: 		-> Train: 16.7 minutes
2025-03-09 07:29:41,459 [INFO]: 		-> Add: 3.0 seconds
2025-03-09 07:29:41,459 [INFO]: 		Total: 16.7 minutes
2025-03-09 07:29:41,459 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0001 secs
2025-03-09 07:29:41,460 [INFO]: 	Checking that your have enough memory available to create the index 03/09/2025, 07:29:41
2025-03-09 07:29:41,460 [INFO]: 1.1GB of memory will be needed to build the index (more might be used if you have more)
2025-03-09 07:29:41,460 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0002 secs
2025-03-09 07:29:41,460 [INFO]: 	Selecting most promising index types given data characteristics 03/09/2025, 07:29:41
2025-03-09 07:29:41,460 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-09 07:29:41,460 [INFO]: 	Creating the index 03/09/2025, 07:29:41
2025-03-09 07:29:41,460 [INFO]: 		-> Instanciate the index HNSW15 03/09/2025, 07:29:41
2025-03-09 07:29:41,461 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0012 secs
2025-03-09 07:29:41,461 [INFO]: 		-> Adding the vectors to the index 03/09/2025, 07:29:41
2025-03-09 07:29:41,461 [INFO]: The memory available for adding the vectors is 49.0GB(total available - used by the index)
2025-03-09 07:29:41,461 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/23 [00:00<?, ?it/s]  4%|▍         | 1/23 [00:00<00:04,  4.46it/s]  9%|▊         | 2/23 [00:00<00:03,  6.19it/s] 13%|█▎        | 3/23 [00:00<00:02,  7.06it/s] 17%|█▋        | 4/23 [00:00<00:02,  7.65it/s] 22%|██▏       | 5/23 [00:00<00:02,  8.12it/s] 30%|███       | 7/23 [00:00<00:01,  9.40it/s] 39%|███▉      | 9/23 [00:01<00:01, 10.05it/s] 48%|████▊     | 11/23 [00:01<00:01, 10.11it/s] 57%|█████▋    | 13/23 [00:01<00:01,  9.79it/s] 65%|██████▌   | 15/23 [00:01<00:00,  9.75it/s] 74%|███████▍  | 17/23 [00:01<00:00, 11.42it/s] 83%|████████▎ | 19/23 [00:01<00:00, 12.61it/s] 91%|█████████▏| 21/23 [00:05<00:01,  1.83it/s]100%|██████████| 23/23 [00:06<00:00,  1.76it/s]100%|██████████| 23/23 [00:06<00:00,  3.65it/s]
2025-03-09 07:29:47,769 [INFO]: 	Computing best hyperparameters for index knn.index 03/09/2025, 07:29:47
2025-03-09 07:30:36,218 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 48.4481 secs
2025-03-09 07:30:36,218 [INFO]: The best hyperparameters are: efSearch=273
2025-03-09 07:30:36,218 [INFO]: 	Compute fast metrics 03/09/2025, 07:30:36
  0%|          | 0/4 [00:00<?, ?it/s] 25%|██▌       | 1/4 [00:00<00:00,  5.92it/s] 75%|███████▌  | 3/4 [00:00<00:00, 11.47it/s]
2025-03-09 07:30:52,168 [INFO]: 	>>> Finished "Compute fast metrics" in 15.9501 secs
2025-03-09 07:30:52,169 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 70.7080 secs
2025-03-09 07:30:52,169 [INFO]: {
2025-03-09 07:30:52,169 [INFO]: 	index_key: HNSW15
2025-03-09 07:30:52,169 [INFO]: 	index_param: efSearch=273
2025-03-09 07:30:52,169 [INFO]: 	index_path: knn.index
2025-03-09 07:30:52,169 [INFO]: 	size in bytes: 1082683030
2025-03-09 07:30:52,169 [INFO]: 	avg_search_speed_ms: 10.64389794693388
2025-03-09 07:30:52,169 [INFO]: 	99p_search_speed_ms: 18.464485476724807
2025-03-09 07:30:52,169 [INFO]: 	reconstruction error %: 0.0
2025-03-09 07:30:52,169 [INFO]: 	nb vectors: 5503
2025-03-09 07:30:52,169 [INFO]: 	vectors dimension: 49152
2025-03-09 07:30:52,169 [INFO]: 	compression ratio: 0.9993080098429178
2025-03-09 07:30:52,169 [INFO]: }
2025-03-09 07:30:52,169 [INFO]: 	>>> Finished "Creating the index" in 70.7096 secs
2025-03-09 07:30:52,170 [INFO]: >>> Finished "Launching the whole pipeline" in 70.7401 secs
2025-03-09 07:30:53: [retrieval_preprocessing] calculating distances ...
2025-03-09 07:30:54: [retrieval_preprocessing] finished and saved retrieval indices for episode 36107 [episode count 5/20]
[retrieval_preprocessing] for episode 29325 [episode count 6/20], we have num_retrieval=np.int64(5397) num_query=np.int64(369)
2025-03-09 07:30:56,213 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-09 07:30:57,021 [INFO]: Launching the whole pipeline 03/09/2025, 07:30:57
2025-03-09 07:30:57,021 [INFO]: Reading total number of vectors and dimension 03/09/2025, 07:30:57
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1791.67it/s]
2025-03-09 07:30:57,048 [INFO]: There are 5397 embeddings of dim 49152
2025-03-09 07:30:57,049 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0278 secs
2025-03-09 07:30:57,049 [INFO]: 	Compute estimated construction time of the index 03/09/2025, 07:30:57
2025-03-09 07:30:57,049 [INFO]: 		-> Train: 16.7 minutes
2025-03-09 07:30:57,049 [INFO]: 		-> Add: 3.0 seconds
2025-03-09 07:30:57,049 [INFO]: 		Total: 16.7 minutes
2025-03-09 07:30:57,049 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0001 secs
2025-03-09 07:30:57,049 [INFO]: 	Checking that your have enough memory available to create the index 03/09/2025, 07:30:57
2025-03-09 07:30:57,049 [INFO]: 1.1GB of memory will be needed to build the index (more might be used if you have more)
2025-03-09 07:30:57,049 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0001 secs
2025-03-09 07:30:57,049 [INFO]: 	Selecting most promising index types given data characteristics 03/09/2025, 07:30:57
2025-03-09 07:30:57,049 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-09 07:30:57,049 [INFO]: 	Creating the index 03/09/2025, 07:30:57
2025-03-09 07:30:57,049 [INFO]: 		-> Instanciate the index HNSW15 03/09/2025, 07:30:57
2025-03-09 07:30:57,050 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0008 secs
2025-03-09 07:30:57,050 [INFO]: 		-> Adding the vectors to the index 03/09/2025, 07:30:57
2025-03-09 07:30:57,050 [INFO]: The memory available for adding the vectors is 49.0GB(total available - used by the index)
2025-03-09 07:30:57,050 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/23 [00:00<?, ?it/s]  4%|▍         | 1/23 [00:00<00:04,  4.71it/s] 13%|█▎        | 3/23 [00:00<00:02,  7.99it/s] 17%|█▋        | 4/23 [00:00<00:02,  8.47it/s] 22%|██▏       | 5/23 [00:00<00:02,  8.72it/s] 26%|██▌       | 6/23 [00:00<00:01,  8.96it/s] 30%|███       | 7/23 [00:00<00:01,  8.75it/s] 35%|███▍      | 8/23 [00:00<00:01,  8.73it/s] 39%|███▉      | 9/23 [00:01<00:01,  8.83it/s] 43%|████▎     | 10/23 [00:01<00:01,  8.66it/s] 48%|████▊     | 11/23 [00:01<00:01,  8.51it/s] 52%|█████▏    | 12/23 [00:01<00:01,  8.38it/s] 57%|█████▋    | 13/23 [00:01<00:01,  8.49it/s] 61%|██████    | 14/23 [00:01<00:01,  8.51it/s] 65%|██████▌   | 15/23 [00:01<00:00,  8.51it/s] 70%|██████▉   | 16/23 [00:01<00:00,  8.38it/s] 74%|███████▍  | 17/23 [00:02<00:00,  8.35it/s] 78%|███████▊  | 18/23 [00:02<00:00,  8.36it/s] 83%|████████▎ | 19/23 [00:02<00:00,  8.33it/s] 87%|████████▋ | 20/23 [00:02<00:00,  8.38it/s] 91%|█████████▏| 21/23 [00:05<00:02,  1.11s/it] 96%|█████████▌| 22/23 [00:05<00:00,  1.23it/s]100%|██████████| 23/23 [00:06<00:00,  1.14it/s]100%|██████████| 23/23 [00:06<00:00,  3.31it/s]
2025-03-09 07:31:04,004 [INFO]: 	Computing best hyperparameters for index knn.index 03/09/2025, 07:31:04
2025-03-09 07:31:48,687 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 44.6828 secs
2025-03-09 07:31:48,687 [INFO]: The best hyperparameters are: efSearch=291
2025-03-09 07:31:48,687 [INFO]: 	Compute fast metrics 03/09/2025, 07:31:48
  0%|          | 0/4 [00:00<?, ?it/s] 25%|██▌       | 1/4 [00:00<00:02,  1.05it/s] 50%|█████     | 2/4 [00:02<00:02,  1.04s/it] 75%|███████▌  | 3/4 [00:02<00:00,  1.20it/s] 75%|███████▌  | 3/4 [00:02<00:00,  1.09it/s]
2025-03-09 07:32:07,840 [INFO]: 	>>> Finished "Compute fast metrics" in 19.1529 secs
2025-03-09 07:32:07,841 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 70.7906 secs
2025-03-09 07:32:07,841 [INFO]: {
2025-03-09 07:32:07,841 [INFO]: 	index_key: HNSW15
2025-03-09 07:32:07,841 [INFO]: 	index_param: efSearch=291
2025-03-09 07:32:07,841 [INFO]: 	index_path: knn.index
2025-03-09 07:32:07,841 [INFO]: 	size in bytes: 1061828170
2025-03-09 07:32:07,841 [INFO]: 	avg_search_speed_ms: 9.529577019580064
2025-03-09 07:32:07,841 [INFO]: 	99p_search_speed_ms: 16.156332339160144
2025-03-09 07:32:07,841 [INFO]: 	reconstruction error %: 0.0
2025-03-09 07:32:07,841 [INFO]: 	nb vectors: 5397
2025-03-09 07:32:07,841 [INFO]: 	vectors dimension: 49152
2025-03-09 07:32:07,841 [INFO]: 	compression ratio: 0.9993079916122398
2025-03-09 07:32:07,841 [INFO]: }
2025-03-09 07:32:07,841 [INFO]: 	>>> Finished "Creating the index" in 70.7919 secs
2025-03-09 07:32:07,841 [INFO]: >>> Finished "Launching the whole pipeline" in 70.8203 secs
2025-03-09 07:32:10: [retrieval_preprocessing] calculating distances ...
2025-03-09 07:32:12: [retrieval_preprocessing] finished and saved retrieval indices for episode 29325 [episode count 6/20]
[retrieval_preprocessing] for episode 19983 [episode count 7/20], we have num_retrieval=np.int64(5377) num_query=np.int64(389)
2025-03-09 07:32:18,987 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-09 07:32:19,720 [INFO]: Launching the whole pipeline 03/09/2025, 07:32:19
2025-03-09 07:32:19,720 [INFO]: Reading total number of vectors and dimension 03/09/2025, 07:32:19
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1535.25it/s]
2025-03-09 07:32:19,751 [INFO]: There are 5377 embeddings of dim 49152
2025-03-09 07:32:19,752 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0316 secs
2025-03-09 07:32:19,752 [INFO]: 	Compute estimated construction time of the index 03/09/2025, 07:32:19
2025-03-09 07:32:19,752 [INFO]: 		-> Train: 16.7 minutes
2025-03-09 07:32:19,752 [INFO]: 		-> Add: 3.0 seconds
2025-03-09 07:32:19,752 [INFO]: 		Total: 16.7 minutes
2025-03-09 07:32:19,752 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0004 secs
2025-03-09 07:32:19,753 [INFO]: 	Checking that your have enough memory available to create the index 03/09/2025, 07:32:19
2025-03-09 07:32:19,753 [INFO]: 1.1GB of memory will be needed to build the index (more might be used if you have more)
2025-03-09 07:32:19,753 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0004 secs
2025-03-09 07:32:19,753 [INFO]: 	Selecting most promising index types given data characteristics 03/09/2025, 07:32:19
2025-03-09 07:32:19,753 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-09 07:32:19,753 [INFO]: 	Creating the index 03/09/2025, 07:32:19
2025-03-09 07:32:19,753 [INFO]: 		-> Instanciate the index HNSW15 03/09/2025, 07:32:19
2025-03-09 07:32:19,756 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0028 secs
2025-03-09 07:32:19,756 [INFO]: 		-> Adding the vectors to the index 03/09/2025, 07:32:19
2025-03-09 07:32:19,757 [INFO]: The memory available for adding the vectors is 49.0GB(total available - used by the index)
2025-03-09 07:32:19,757 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/23 [00:00<?, ?it/s]  4%|▍         | 1/23 [00:00<00:02,  8.38it/s] 22%|██▏       | 5/23 [00:00<00:00, 22.20it/s] 39%|███▉      | 9/23 [00:00<00:00, 26.33it/s] 57%|█████▋    | 13/23 [00:00<00:00, 28.08it/s] 74%|███████▍  | 17/23 [00:00<00:00, 28.36it/s] 87%|████████▋ | 20/23 [00:01<00:00, 12.27it/s]100%|██████████| 23/23 [00:06<00:00,  1.76it/s]100%|██████████| 23/23 [00:06<00:00,  3.57it/s]
2025-03-09 07:32:26,204 [INFO]: 	Computing best hyperparameters for index knn.index 03/09/2025, 07:32:26
2025-03-09 07:33:15,996 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 49.7913 secs
2025-03-09 07:33:15,996 [INFO]: The best hyperparameters are: efSearch=258
2025-03-09 07:33:15,996 [INFO]: 	Compute fast metrics 03/09/2025, 07:33:15
  0%|          | 0/4 [00:00<?, ?it/s] 25%|██▌       | 1/4 [00:00<00:00,  6.40it/s] 75%|███████▌  | 3/4 [00:00<00:00, 12.40it/s] 75%|███████▌  | 3/4 [00:00<00:00,  9.06it/s]
2025-03-09 07:33:34,059 [INFO]: 	>>> Finished "Compute fast metrics" in 18.0626 secs
2025-03-09 07:33:34,060 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 74.3034 secs
2025-03-09 07:33:34,060 [INFO]: {
2025-03-09 07:33:34,060 [INFO]: 	index_key: HNSW15
2025-03-09 07:33:34,060 [INFO]: 	index_param: efSearch=258
2025-03-09 07:33:34,060 [INFO]: 	index_path: knn.index
2025-03-09 07:33:34,060 [INFO]: 	size in bytes: 1057893190
2025-03-09 07:33:34,060 [INFO]: 	avg_search_speed_ms: 9.47488314379448
2025-03-09 07:33:34,060 [INFO]: 	99p_search_speed_ms: 18.251810525543995
2025-03-09 07:33:34,060 [INFO]: 	reconstruction error %: 0.0
2025-03-09 07:33:34,060 [INFO]: 	nb vectors: 5377
2025-03-09 07:33:34,060 [INFO]: 	vectors dimension: 49152
2025-03-09 07:33:34,060 [INFO]: 	compression ratio: 0.9993080832668939
2025-03-09 07:33:34,060 [INFO]: }
2025-03-09 07:33:34,060 [INFO]: 	>>> Finished "Creating the index" in 74.3069 secs
2025-03-09 07:33:34,060 [INFO]: >>> Finished "Launching the whole pipeline" in 74.3400 secs
2025-03-09 07:33:36: [retrieval_preprocessing] calculating distances ...
2025-03-09 07:33:37: [retrieval_preprocessing] finished and saved retrieval indices for episode 19983 [episode count 7/20]
[retrieval_preprocessing] for episode 26128 [episode count 8/20], we have num_retrieval=np.int64(5486) num_query=np.int64(280)
2025-03-09 07:33:57,430 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-09 07:33:58,361 [INFO]: Launching the whole pipeline 03/09/2025, 07:33:58
2025-03-09 07:33:58,361 [INFO]: Reading total number of vectors and dimension 03/09/2025, 07:33:58
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1253.53it/s]
2025-03-09 07:33:58,388 [INFO]: There are 5486 embeddings of dim 49152
2025-03-09 07:33:58,389 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0275 secs
2025-03-09 07:33:58,389 [INFO]: 	Compute estimated construction time of the index 03/09/2025, 07:33:58
2025-03-09 07:33:58,389 [INFO]: 		-> Train: 16.7 minutes
2025-03-09 07:33:58,389 [INFO]: 		-> Add: 3.0 seconds
2025-03-09 07:33:58,389 [INFO]: 		Total: 16.7 minutes
2025-03-09 07:33:58,389 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0001 secs
2025-03-09 07:33:58,389 [INFO]: 	Checking that your have enough memory available to create the index 03/09/2025, 07:33:58
2025-03-09 07:33:58,389 [INFO]: 1.1GB of memory will be needed to build the index (more might be used if you have more)
2025-03-09 07:33:58,389 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0002 secs
2025-03-09 07:33:58,389 [INFO]: 	Selecting most promising index types given data characteristics 03/09/2025, 07:33:58
2025-03-09 07:33:58,389 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-09 07:33:58,389 [INFO]: 	Creating the index 03/09/2025, 07:33:58
2025-03-09 07:33:58,389 [INFO]: 		-> Instanciate the index HNSW15 03/09/2025, 07:33:58
2025-03-09 07:33:58,390 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0012 secs
2025-03-09 07:33:58,390 [INFO]: 		-> Adding the vectors to the index 03/09/2025, 07:33:58
2025-03-09 07:33:58,390 [INFO]: The memory available for adding the vectors is 49.0GB(total available - used by the index)
2025-03-09 07:33:58,391 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/23 [00:00<?, ?it/s]  4%|▍         | 1/23 [00:00<00:04,  4.88it/s] 13%|█▎        | 3/23 [00:00<00:02,  8.30it/s] 22%|██▏       | 5/23 [00:00<00:01,  9.49it/s] 30%|███       | 7/23 [00:00<00:01,  9.97it/s] 39%|███▉      | 9/23 [00:00<00:01, 10.69it/s] 48%|████▊     | 11/23 [00:01<00:01, 11.33it/s] 57%|█████▋    | 13/23 [00:01<00:00, 11.70it/s] 65%|██████▌   | 15/23 [00:01<00:00, 12.18it/s] 74%|███████▍  | 17/23 [00:01<00:00, 11.54it/s] 83%|████████▎ | 19/23 [00:01<00:00, 11.10it/s] 91%|█████████▏| 21/23 [00:05<00:01,  1.70it/s] 96%|█████████▌| 22/23 [00:05<00:00,  1.62it/s]100%|██████████| 23/23 [00:07<00:00,  1.30it/s]100%|██████████| 23/23 [00:07<00:00,  3.14it/s]
2025-03-09 07:34:05,712 [INFO]: 	Computing best hyperparameters for index knn.index 03/09/2025, 07:34:05
2025-03-09 07:35:01,548 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 55.8357 secs
2025-03-09 07:35:01,548 [INFO]: The best hyperparameters are: efSearch=277
2025-03-09 07:35:01,548 [INFO]: 	Compute fast metrics 03/09/2025, 07:35:01
  0%|          | 0/4 [00:00<?, ?it/s] 25%|██▌       | 1/4 [00:01<00:03,  1.31s/it] 75%|███████▌  | 3/4 [00:01<00:00,  2.54it/s] 75%|███████▌  | 3/4 [00:01<00:00,  1.95it/s]
2025-03-09 07:35:17,810 [INFO]: 	>>> Finished "Compute fast metrics" in 16.2617 secs
2025-03-09 07:35:17,811 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 79.4209 secs
2025-03-09 07:35:17,812 [INFO]: {
2025-03-09 07:35:17,812 [INFO]: 	index_key: HNSW15
2025-03-09 07:35:17,812 [INFO]: 	index_param: efSearch=277
2025-03-09 07:35:17,812 [INFO]: 	index_path: knn.index
2025-03-09 07:35:17,812 [INFO]: 	size in bytes: 1079338450
2025-03-09 07:35:17,812 [INFO]: 	avg_search_speed_ms: 9.65338567623322
2025-03-09 07:35:17,812 [INFO]: 	99p_search_speed_ms: 17.041611624881675
2025-03-09 07:35:17,812 [INFO]: 	reconstruction error %: 0.0
2025-03-09 07:35:17,812 [INFO]: 	nb vectors: 5486
2025-03-09 07:35:17,812 [INFO]: 	vectors dimension: 49152
2025-03-09 07:35:17,812 [INFO]: 	compression ratio: 0.999307944602548
2025-03-09 07:35:17,812 [INFO]: }
2025-03-09 07:35:17,812 [INFO]: 	>>> Finished "Creating the index" in 79.4226 secs
2025-03-09 07:35:17,812 [INFO]: >>> Finished "Launching the whole pipeline" in 79.4507 secs
2025-03-09 07:35:19: [retrieval_preprocessing] calculating distances ...
2025-03-09 07:35:20: [retrieval_preprocessing] finished and saved retrieval indices for episode 26128 [episode count 8/20]
[retrieval_preprocessing] for episode 70288 [episode count 9/20], we have num_retrieval=np.int64(5586) num_query=np.int64(180)
2025-03-09 07:35:21,959 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-09 07:35:22,953 [INFO]: Launching the whole pipeline 03/09/2025, 07:35:22
2025-03-09 07:35:22,953 [INFO]: Reading total number of vectors and dimension 03/09/2025, 07:35:22
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1399.97it/s]
2025-03-09 07:35:22,983 [INFO]: There are 5586 embeddings of dim 49152
2025-03-09 07:35:22,983 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0303 secs
2025-03-09 07:35:22,983 [INFO]: 	Compute estimated construction time of the index 03/09/2025, 07:35:22
2025-03-09 07:35:22,983 [INFO]: 		-> Train: 16.7 minutes
2025-03-09 07:35:22,983 [INFO]: 		-> Add: 3.1 seconds
2025-03-09 07:35:22,983 [INFO]: 		Total: 16.7 minutes
2025-03-09 07:35:22,983 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0001 secs
2025-03-09 07:35:22,983 [INFO]: 	Checking that your have enough memory available to create the index 03/09/2025, 07:35:22
2025-03-09 07:35:22,983 [INFO]: 1.1GB of memory will be needed to build the index (more might be used if you have more)
2025-03-09 07:35:22,983 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0001 secs
2025-03-09 07:35:22,983 [INFO]: 	Selecting most promising index types given data characteristics 03/09/2025, 07:35:22
2025-03-09 07:35:22,983 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-09 07:35:22,983 [INFO]: 	Creating the index 03/09/2025, 07:35:22
2025-03-09 07:35:22,983 [INFO]: 		-> Instanciate the index HNSW15 03/09/2025, 07:35:22
2025-03-09 07:35:22,984 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0009 secs
2025-03-09 07:35:22,984 [INFO]: 		-> Adding the vectors to the index 03/09/2025, 07:35:22
2025-03-09 07:35:22,984 [INFO]: The memory available for adding the vectors is 49.0GB(total available - used by the index)
2025-03-09 07:35:22,985 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/23 [00:00<?, ?it/s]  4%|▍         | 1/23 [00:00<00:03,  5.72it/s]  9%|▊         | 2/23 [00:00<00:03,  6.23it/s] 13%|█▎        | 3/23 [00:00<00:07,  2.82it/s] 17%|█▋        | 4/23 [00:01<00:05,  3.46it/s] 26%|██▌       | 6/23 [00:02<00:07,  2.41it/s] 35%|███▍      | 8/23 [00:02<00:03,  3.83it/s] 39%|███▉      | 9/23 [00:02<00:03,  4.36it/s] 43%|████▎     | 10/23 [00:02<00:02,  4.93it/s] 48%|████▊     | 11/23 [00:02<00:02,  5.56it/s] 52%|█████▏    | 12/23 [00:02<00:01,  6.10it/s] 57%|█████▋    | 13/23 [00:02<00:01,  6.57it/s] 61%|██████    | 14/23 [00:03<00:01,  6.95it/s] 65%|██████▌   | 15/23 [00:03<00:01,  7.28it/s] 70%|██████▉   | 16/23 [00:03<00:00,  7.59it/s] 74%|███████▍  | 17/23 [00:03<00:00,  7.76it/s] 78%|███████▊  | 18/23 [00:03<00:00,  7.85it/s] 83%|████████▎ | 19/23 [00:05<00:02,  1.78it/s] 87%|████████▋ | 20/23 [00:06<00:02,  1.19it/s] 91%|█████████▏| 21/23 [00:10<00:03,  1.68s/it]100%|██████████| 23/23 [00:11<00:00,  1.27s/it]100%|██████████| 23/23 [00:11<00:00,  1.95it/s]
2025-03-09 07:35:34,788 [INFO]: 	Computing best hyperparameters for index knn.index 03/09/2025, 07:35:34
2025-03-09 07:36:28,354 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 53.5656 secs
2025-03-09 07:36:28,354 [INFO]: The best hyperparameters are: efSearch=291
2025-03-09 07:36:28,354 [INFO]: 	Compute fast metrics 03/09/2025, 07:36:28
  0%|          | 0/4 [00:00<?, ?it/s] 25%|██▌       | 1/4 [00:00<00:00,  5.23it/s] 50%|█████     | 2/4 [00:00<00:00,  6.87it/s] 75%|███████▌  | 3/4 [00:00<00:00,  7.56it/s] 75%|███████▌  | 3/4 [00:00<00:00,  5.67it/s]
2025-03-09 07:36:47,812 [INFO]: 	>>> Finished "Compute fast metrics" in 19.4575 secs
2025-03-09 07:36:47,813 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 84.8281 secs
2025-03-09 07:36:47,813 [INFO]: {
2025-03-09 07:36:47,813 [INFO]: 	index_key: HNSW15
2025-03-09 07:36:47,813 [INFO]: 	index_param: efSearch=291
2025-03-09 07:36:47,813 [INFO]: 	index_path: knn.index
2025-03-09 07:36:47,813 [INFO]: 	size in bytes: 1099012870
2025-03-09 07:36:47,813 [INFO]: 	avg_search_speed_ms: 9.303241114586939
2025-03-09 07:36:47,813 [INFO]: 	99p_search_speed_ms: 14.101223619654775
2025-03-09 07:36:47,813 [INFO]: 	reconstruction error %: 0.0
2025-03-09 07:36:47,813 [INFO]: 	nb vectors: 5586
2025-03-09 07:36:47,813 [INFO]: 	vectors dimension: 49152
2025-03-09 07:36:47,813 [INFO]: 	compression ratio: 0.9993079407705208
2025-03-09 07:36:47,813 [INFO]: }
2025-03-09 07:36:47,813 [INFO]: 	>>> Finished "Creating the index" in 84.8294 secs
2025-03-09 07:36:47,813 [INFO]: >>> Finished "Launching the whole pipeline" in 84.8602 secs
2025-03-09 07:36:49: [retrieval_preprocessing] calculating distances ...
2025-03-09 07:36:49: [retrieval_preprocessing] finished and saved retrieval indices for episode 70288 [episode count 9/20]
[retrieval_preprocessing] for episode 76687 [episode count 10/20], we have num_retrieval=np.int64(5547) num_query=np.int64(219)
2025-03-09 07:36:51,356 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-09 07:36:52,152 [INFO]: Launching the whole pipeline 03/09/2025, 07:36:52
2025-03-09 07:36:52,152 [INFO]: Reading total number of vectors and dimension 03/09/2025, 07:36:52
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1268.31it/s]
2025-03-09 07:36:52,180 [INFO]: There are 5547 embeddings of dim 49152
2025-03-09 07:36:52,180 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0285 secs
2025-03-09 07:36:52,180 [INFO]: 	Compute estimated construction time of the index 03/09/2025, 07:36:52
2025-03-09 07:36:52,181 [INFO]: 		-> Train: 16.7 minutes
2025-03-09 07:36:52,181 [INFO]: 		-> Add: 3.0 seconds
2025-03-09 07:36:52,181 [INFO]: 		Total: 16.7 minutes
2025-03-09 07:36:52,181 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0003 secs
2025-03-09 07:36:52,181 [INFO]: 	Checking that your have enough memory available to create the index 03/09/2025, 07:36:52
2025-03-09 07:36:52,181 [INFO]: 1.1GB of memory will be needed to build the index (more might be used if you have more)
2025-03-09 07:36:52,181 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0004 secs
2025-03-09 07:36:52,182 [INFO]: 	Selecting most promising index types given data characteristics 03/09/2025, 07:36:52
2025-03-09 07:36:52,182 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-09 07:36:52,182 [INFO]: 	Creating the index 03/09/2025, 07:36:52
2025-03-09 07:36:52,182 [INFO]: 		-> Instanciate the index HNSW15 03/09/2025, 07:36:52
2025-03-09 07:36:52,185 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0027 secs
2025-03-09 07:36:52,185 [INFO]: 		-> Adding the vectors to the index 03/09/2025, 07:36:52
2025-03-09 07:36:52,185 [INFO]: The memory available for adding the vectors is 49.0GB(total available - used by the index)
2025-03-09 07:36:52,185 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/23 [00:00<?, ?it/s]  4%|▍         | 1/23 [00:00<00:03,  6.76it/s] 13%|█▎        | 3/23 [00:00<00:01, 12.29it/s] 22%|██▏       | 5/23 [00:00<00:01, 14.36it/s] 30%|███       | 7/23 [00:00<00:01, 12.93it/s] 39%|███▉      | 9/23 [00:00<00:01, 12.34it/s] 48%|████▊     | 11/23 [00:00<00:00, 12.53it/s] 57%|█████▋    | 13/23 [00:00<00:00, 13.93it/s] 65%|██████▌   | 15/23 [00:01<00:00, 12.55it/s] 74%|███████▍  | 17/23 [00:01<00:00, 13.13it/s] 83%|████████▎ | 19/23 [00:01<00:00, 13.68it/s] 91%|█████████▏| 21/23 [00:04<00:01,  1.74it/s] 96%|█████████▌| 22/23 [00:07<00:00,  1.16it/s]100%|██████████| 23/23 [00:08<00:00,  1.07it/s]100%|██████████| 23/23 [00:08<00:00,  2.78it/s]
2025-03-09 07:37:00,462 [INFO]: 	Computing best hyperparameters for index knn.index 03/09/2025, 07:37:00
2025-03-09 07:37:50,730 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 50.2670 secs
2025-03-09 07:37:50,730 [INFO]: The best hyperparameters are: efSearch=225
2025-03-09 07:37:50,730 [INFO]: 	Compute fast metrics 03/09/2025, 07:37:50
  0%|          | 0/4 [00:00<?, ?it/s] 25%|██▌       | 1/4 [00:00<00:00,  8.94it/s] 75%|███████▌  | 3/4 [00:00<00:00, 12.90it/s]
2025-03-09 07:38:06,349 [INFO]: 	>>> Finished "Compute fast metrics" in 15.6191 secs
2025-03-09 07:38:06,350 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 74.1652 secs
2025-03-09 07:38:06,350 [INFO]: {
2025-03-09 07:38:06,350 [INFO]: 	index_key: HNSW15
2025-03-09 07:38:06,350 [INFO]: 	index_param: efSearch=225
2025-03-09 07:38:06,350 [INFO]: 	index_path: knn.index
2025-03-09 07:38:06,350 [INFO]: 	size in bytes: 1091339770
2025-03-09 07:38:06,350 [INFO]: 	avg_search_speed_ms: 8.867925848293362
2025-03-09 07:38:06,350 [INFO]: 	99p_search_speed_ms: 13.215862256474793
2025-03-09 07:38:06,351 [INFO]: 	reconstruction error %: 0.0
2025-03-09 07:38:06,351 [INFO]: 	nb vectors: 5547
2025-03-09 07:38:06,351 [INFO]: 	vectors dimension: 49152
2025-03-09 07:38:06,351 [INFO]: 	compression ratio: 0.9993080120226903
2025-03-09 07:38:06,351 [INFO]: }
2025-03-09 07:38:06,351 [INFO]: 	>>> Finished "Creating the index" in 74.1687 secs
2025-03-09 07:38:06,351 [INFO]: >>> Finished "Launching the whole pipeline" in 74.1990 secs
2025-03-09 07:38:07: [retrieval_preprocessing] calculating distances ...
2025-03-09 07:38:07: [retrieval_preprocessing] finished and saved retrieval indices for episode 76687 [episode count 10/20]
[retrieval_preprocessing] for episode 88853 [episode count 11/20], we have num_retrieval=np.int64(5500) num_query=np.int64(266)
2025-03-09 07:38:09,938 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-09 07:38:10,703 [INFO]: Launching the whole pipeline 03/09/2025, 07:38:10
2025-03-09 07:38:10,703 [INFO]: Reading total number of vectors and dimension 03/09/2025, 07:38:10
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 996.04it/s]
2025-03-09 07:38:10,730 [INFO]: There are 5500 embeddings of dim 49152
2025-03-09 07:38:10,730 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0274 secs
2025-03-09 07:38:10,730 [INFO]: 	Compute estimated construction time of the index 03/09/2025, 07:38:10
2025-03-09 07:38:10,730 [INFO]: 		-> Train: 16.7 minutes
2025-03-09 07:38:10,730 [INFO]: 		-> Add: 3.0 seconds
2025-03-09 07:38:10,730 [INFO]: 		Total: 16.7 minutes
2025-03-09 07:38:10,730 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0002 secs
2025-03-09 07:38:10,730 [INFO]: 	Checking that your have enough memory available to create the index 03/09/2025, 07:38:10
2025-03-09 07:38:10,730 [INFO]: 1.1GB of memory will be needed to build the index (more might be used if you have more)
2025-03-09 07:38:10,731 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0001 secs
2025-03-09 07:38:10,731 [INFO]: 	Selecting most promising index types given data characteristics 03/09/2025, 07:38:10
2025-03-09 07:38:10,731 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-09 07:38:10,731 [INFO]: 	Creating the index 03/09/2025, 07:38:10
2025-03-09 07:38:10,731 [INFO]: 		-> Instanciate the index HNSW15 03/09/2025, 07:38:10
2025-03-09 07:38:10,732 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0010 secs
2025-03-09 07:38:10,732 [INFO]: 		-> Adding the vectors to the index 03/09/2025, 07:38:10
2025-03-09 07:38:10,732 [INFO]: The memory available for adding the vectors is 49.0GB(total available - used by the index)
2025-03-09 07:38:10,732 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/23 [00:00<?, ?it/s]  4%|▍         | 1/23 [00:00<00:04,  5.34it/s]  9%|▊         | 2/23 [00:00<00:03,  6.88it/s] 13%|█▎        | 3/23 [00:00<00:02,  7.58it/s] 17%|█▋        | 4/23 [00:00<00:02,  7.96it/s] 22%|██▏       | 5/23 [00:00<00:02,  8.20it/s] 26%|██▌       | 6/23 [00:00<00:02,  8.37it/s] 30%|███       | 7/23 [00:00<00:01,  8.38it/s] 35%|███▍      | 8/23 [00:01<00:01,  8.32it/s] 39%|███▉      | 9/23 [00:01<00:01,  8.34it/s] 43%|████▎     | 10/23 [00:01<00:01,  8.36it/s] 48%|████▊     | 11/23 [00:01<00:01,  8.48it/s] 52%|█████▏    | 12/23 [00:01<00:01,  8.43it/s] 57%|█████▋    | 13/23 [00:01<00:01,  8.43it/s] 61%|██████    | 14/23 [00:01<00:01,  8.43it/s] 65%|██████▌   | 15/23 [00:01<00:00,  8.85it/s] 74%|███████▍  | 17/23 [00:01<00:00,  9.94it/s] 83%|████████▎ | 19/23 [00:02<00:00, 10.44it/s] 91%|█████████▏| 21/23 [00:05<00:01,  1.48it/s]100%|██████████| 23/23 [00:06<00:00,  1.56it/s]100%|██████████| 23/23 [00:06<00:00,  3.43it/s]
2025-03-09 07:38:17,448 [INFO]: 	Computing best hyperparameters for index knn.index 03/09/2025, 07:38:17
2025-03-09 07:39:07,268 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 49.8197 secs
2025-03-09 07:39:07,268 [INFO]: The best hyperparameters are: efSearch=291
2025-03-09 07:39:07,268 [INFO]: 	Compute fast metrics 03/09/2025, 07:39:07
  0%|          | 0/4 [00:00<?, ?it/s] 25%|██▌       | 1/4 [00:00<00:00,  6.95it/s] 50%|█████     | 2/4 [00:00<00:00,  7.43it/s] 75%|███████▌  | 3/4 [00:00<00:00,  7.54it/s] 75%|███████▌  | 3/4 [00:00<00:00,  5.79it/s]
2025-03-09 07:39:20,934 [INFO]: 	>>> Finished "Compute fast metrics" in 13.6659 secs
2025-03-09 07:39:20,935 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 70.2030 secs
2025-03-09 07:39:20,935 [INFO]: {
2025-03-09 07:39:20,935 [INFO]: 	index_key: HNSW15
2025-03-09 07:39:20,935 [INFO]: 	index_param: efSearch=291
2025-03-09 07:39:20,935 [INFO]: 	index_path: knn.index
2025-03-09 07:39:20,935 [INFO]: 	size in bytes: 1082092810
2025-03-09 07:39:20,935 [INFO]: 	avg_search_speed_ms: 10.251056595197802
2025-03-09 07:39:20,935 [INFO]: 	99p_search_speed_ms: 18.208218447398394
2025-03-09 07:39:20,935 [INFO]: 	reconstruction error %: 0.0
2025-03-09 07:39:20,935 [INFO]: 	nb vectors: 5500
2025-03-09 07:39:20,935 [INFO]: 	vectors dimension: 49152
2025-03-09 07:39:20,935 [INFO]: 	compression ratio: 0.9993079983592166
2025-03-09 07:39:20,935 [INFO]: }
2025-03-09 07:39:20,935 [INFO]: 	>>> Finished "Creating the index" in 70.2045 secs
2025-03-09 07:39:20,935 [INFO]: >>> Finished "Launching the whole pipeline" in 70.2325 secs
2025-03-09 07:39:22: [retrieval_preprocessing] calculating distances ...
2025-03-09 07:39:23: [retrieval_preprocessing] finished and saved retrieval indices for episode 88853 [episode count 11/20]
[retrieval_preprocessing] for episode 1815 [episode count 12/20], we have num_retrieval=np.int64(5521) num_query=np.int64(245)
2025-03-09 07:39:26,375 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-09 07:39:27,334 [INFO]: Launching the whole pipeline 03/09/2025, 07:39:27
2025-03-09 07:39:27,334 [INFO]: Reading total number of vectors and dimension 03/09/2025, 07:39:27
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1194.96it/s]
2025-03-09 07:39:27,362 [INFO]: There are 5521 embeddings of dim 49152
2025-03-09 07:39:27,362 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0283 secs
2025-03-09 07:39:27,363 [INFO]: 	Compute estimated construction time of the index 03/09/2025, 07:39:27
2025-03-09 07:39:27,363 [INFO]: 		-> Train: 16.7 minutes
2025-03-09 07:39:27,363 [INFO]: 		-> Add: 3.0 seconds
2025-03-09 07:39:27,363 [INFO]: 		Total: 16.7 minutes
2025-03-09 07:39:27,363 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0001 secs
2025-03-09 07:39:27,363 [INFO]: 	Checking that your have enough memory available to create the index 03/09/2025, 07:39:27
2025-03-09 07:39:27,363 [INFO]: 1.1GB of memory will be needed to build the index (more might be used if you have more)
2025-03-09 07:39:27,363 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0002 secs
2025-03-09 07:39:27,363 [INFO]: 	Selecting most promising index types given data characteristics 03/09/2025, 07:39:27
2025-03-09 07:39:27,363 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-09 07:39:27,363 [INFO]: 	Creating the index 03/09/2025, 07:39:27
2025-03-09 07:39:27,363 [INFO]: 		-> Instanciate the index HNSW15 03/09/2025, 07:39:27
2025-03-09 07:39:27,364 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0012 secs
2025-03-09 07:39:27,365 [INFO]: 		-> Adding the vectors to the index 03/09/2025, 07:39:27
2025-03-09 07:39:27,365 [INFO]: The memory available for adding the vectors is 49.0GB(total available - used by the index)
2025-03-09 07:39:27,365 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/23 [00:00<?, ?it/s]  4%|▍         | 1/23 [00:00<00:04,  4.83it/s]  9%|▊         | 2/23 [00:00<00:03,  6.43it/s] 13%|█▎        | 3/23 [00:00<00:02,  6.90it/s] 17%|█▋        | 4/23 [00:00<00:02,  7.29it/s] 22%|██▏       | 5/23 [00:00<00:02,  7.41it/s] 26%|██▌       | 6/23 [00:00<00:02,  7.47it/s] 30%|███       | 7/23 [00:00<00:02,  7.61it/s] 35%|███▍      | 8/23 [00:01<00:01,  7.84it/s] 39%|███▉      | 9/23 [00:01<00:01,  8.15it/s] 43%|████▎     | 10/23 [00:01<00:01,  8.46it/s] 52%|█████▏    | 12/23 [00:01<00:01, 10.60it/s] 61%|██████    | 14/23 [00:01<00:00,  9.74it/s] 65%|██████▌   | 15/23 [00:01<00:00,  9.40it/s] 70%|██████▉   | 16/23 [00:01<00:00,  9.17it/s] 78%|███████▊  | 18/23 [00:02<00:00, 10.03it/s] 87%|████████▋ | 20/23 [00:02<00:00, 10.70it/s] 96%|█████████▌| 22/23 [00:05<00:00,  1.62it/s]100%|██████████| 23/23 [00:06<00:00,  1.37it/s]100%|██████████| 23/23 [00:06<00:00,  3.45it/s]
2025-03-09 07:39:34,043 [INFO]: 	Computing best hyperparameters for index knn.index 03/09/2025, 07:39:34
2025-03-09 07:40:18,598 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 44.5547 secs
2025-03-09 07:40:18,599 [INFO]: The best hyperparameters are: efSearch=288
2025-03-09 07:40:18,599 [INFO]: 	Compute fast metrics 03/09/2025, 07:40:18
  0%|          | 0/4 [00:00<?, ?it/s] 25%|██▌       | 1/4 [00:00<00:00,  4.14it/s] 50%|█████     | 2/4 [00:00<00:00,  4.79it/s] 75%|███████▌  | 3/4 [00:00<00:00,  4.99it/s]
2025-03-09 07:40:33,853 [INFO]: 	>>> Finished "Compute fast metrics" in 15.2544 secs
2025-03-09 07:40:33,854 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 66.4894 secs
2025-03-09 07:40:33,854 [INFO]: {
2025-03-09 07:40:33,854 [INFO]: 	index_key: HNSW15
2025-03-09 07:40:33,854 [INFO]: 	index_param: efSearch=288
2025-03-09 07:40:33,854 [INFO]: 	index_path: knn.index
2025-03-09 07:40:33,854 [INFO]: 	size in bytes: 1086224410
2025-03-09 07:40:33,854 [INFO]: 	avg_search_speed_ms: 10.006118982098997
2025-03-09 07:40:33,854 [INFO]: 	99p_search_speed_ms: 17.049021811690178
2025-03-09 07:40:33,854 [INFO]: 	reconstruction error %: 0.0
2025-03-09 07:40:33,854 [INFO]: 	nb vectors: 5521
2025-03-09 07:40:33,854 [INFO]: 	vectors dimension: 49152
2025-03-09 07:40:33,854 [INFO]: 	compression ratio: 0.9993080232840652
2025-03-09 07:40:33,854 [INFO]: }
2025-03-09 07:40:33,854 [INFO]: 	>>> Finished "Creating the index" in 66.4910 secs
2025-03-09 07:40:33,854 [INFO]: >>> Finished "Launching the whole pipeline" in 66.5201 secs
2025-03-09 07:40:35: [retrieval_preprocessing] calculating distances ...
2025-03-09 07:40:36: [retrieval_preprocessing] finished and saved retrieval indices for episode 1815 [episode count 12/20]
[retrieval_preprocessing] for episode 62488 [episode count 13/20], we have num_retrieval=np.int64(5565) num_query=np.int64(201)
2025-03-09 07:40:37,478 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-09 07:40:38,445 [INFO]: Launching the whole pipeline 03/09/2025, 07:40:38
2025-03-09 07:40:38,446 [INFO]: Reading total number of vectors and dimension 03/09/2025, 07:40:38
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1106.09it/s]
2025-03-09 07:40:38,474 [INFO]: There are 5565 embeddings of dim 49152
2025-03-09 07:40:38,474 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0288 secs
2025-03-09 07:40:38,474 [INFO]: 	Compute estimated construction time of the index 03/09/2025, 07:40:38
2025-03-09 07:40:38,474 [INFO]: 		-> Train: 16.7 minutes
2025-03-09 07:40:38,475 [INFO]: 		-> Add: 3.1 seconds
2025-03-09 07:40:38,475 [INFO]: 		Total: 16.7 minutes
2025-03-09 07:40:38,475 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0001 secs
2025-03-09 07:40:38,475 [INFO]: 	Checking that your have enough memory available to create the index 03/09/2025, 07:40:38
2025-03-09 07:40:38,475 [INFO]: 1.1GB of memory will be needed to build the index (more might be used if you have more)
2025-03-09 07:40:38,475 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0003 secs
2025-03-09 07:40:38,475 [INFO]: 	Selecting most promising index types given data characteristics 03/09/2025, 07:40:38
2025-03-09 07:40:38,475 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-09 07:40:38,475 [INFO]: 	Creating the index 03/09/2025, 07:40:38
2025-03-09 07:40:38,475 [INFO]: 		-> Instanciate the index HNSW15 03/09/2025, 07:40:38
2025-03-09 07:40:38,476 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0011 secs
2025-03-09 07:40:38,476 [INFO]: 		-> Adding the vectors to the index 03/09/2025, 07:40:38
2025-03-09 07:40:38,476 [INFO]: The memory available for adding the vectors is 49.0GB(total available - used by the index)
2025-03-09 07:40:38,476 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/23 [00:00<?, ?it/s]  4%|▍         | 1/23 [00:00<00:03,  6.53it/s] 13%|█▎        | 3/23 [00:00<00:02,  8.57it/s] 17%|█▋        | 4/23 [00:00<00:02,  8.63it/s] 26%|██▌       | 6/23 [00:00<00:01, 10.43it/s] 35%|███▍      | 8/23 [00:00<00:01,  9.62it/s] 39%|███▉      | 9/23 [00:00<00:01,  9.50it/s] 43%|████▎     | 10/23 [00:01<00:01,  9.22it/s] 48%|████▊     | 11/23 [00:01<00:01,  9.08it/s] 52%|█████▏    | 12/23 [00:01<00:01,  8.92it/s] 57%|█████▋    | 13/23 [00:01<00:01,  8.92it/s] 61%|██████    | 14/23 [00:01<00:00,  9.05it/s] 65%|██████▌   | 15/23 [00:01<00:00,  8.86it/s] 70%|██████▉   | 16/23 [00:01<00:00,  8.82it/s] 74%|███████▍  | 17/23 [00:01<00:00,  8.76it/s] 78%|███████▊  | 18/23 [00:02<00:00,  8.71it/s] 83%|████████▎ | 19/23 [00:02<00:00,  8.70it/s] 87%|████████▋ | 20/23 [00:02<00:00,  8.82it/s] 91%|█████████▏| 21/23 [00:05<00:02,  1.02s/it]100%|██████████| 23/23 [00:06<00:00,  1.19it/s]100%|██████████| 23/23 [00:06<00:00,  3.47it/s]
2025-03-09 07:40:45,108 [INFO]: 	Computing best hyperparameters for index knn.index 03/09/2025, 07:40:45
2025-03-09 07:41:30,681 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 45.5728 secs
2025-03-09 07:41:30,681 [INFO]: The best hyperparameters are: efSearch=242
2025-03-09 07:41:30,681 [INFO]: 	Compute fast metrics 03/09/2025, 07:41:30
  0%|          | 0/4 [00:00<?, ?it/s] 25%|██▌       | 1/4 [00:00<00:00,  4.61it/s] 50%|█████     | 2/4 [00:00<00:00,  5.92it/s] 75%|███████▌  | 3/4 [00:00<00:00,  6.42it/s] 75%|███████▌  | 3/4 [00:00<00:00,  4.88it/s]
2025-03-09 07:41:48,089 [INFO]: 	>>> Finished "Compute fast metrics" in 17.4076 secs
2025-03-09 07:41:48,090 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 69.6139 secs
2025-03-09 07:41:48,090 [INFO]: {
2025-03-09 07:41:48,090 [INFO]: 	index_key: HNSW15
2025-03-09 07:41:48,090 [INFO]: 	index_param: efSearch=242
2025-03-09 07:41:48,090 [INFO]: 	index_path: knn.index
2025-03-09 07:41:48,090 [INFO]: 	size in bytes: 1094881210
2025-03-09 07:41:48,091 [INFO]: 	avg_search_speed_ms: 8.505995866848904
2025-03-09 07:41:48,091 [INFO]: 	99p_search_speed_ms: 13.874265016056597
2025-03-09 07:41:48,091 [INFO]: 	reconstruction error %: 0.0
2025-03-09 07:41:48,091 [INFO]: 	nb vectors: 5565
2025-03-09 07:41:48,091 [INFO]: 	vectors dimension: 49152
2025-03-09 07:41:48,091 [INFO]: 	compression ratio: 0.999307970587969
2025-03-09 07:41:48,091 [INFO]: }
2025-03-09 07:41:48,091 [INFO]: 	>>> Finished "Creating the index" in 69.6155 secs
2025-03-09 07:41:48,091 [INFO]: >>> Finished "Launching the whole pipeline" in 69.6451 secs
2025-03-09 07:41:49: [retrieval_preprocessing] calculating distances ...
2025-03-09 07:41:50: [retrieval_preprocessing] finished and saved retrieval indices for episode 62488 [episode count 13/20]
[retrieval_preprocessing] for episode 19225 [episode count 14/20], we have num_retrieval=np.int64(5201) num_query=np.int64(565)
2025-03-09 07:41:51,701 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-09 07:41:52,437 [INFO]: Launching the whole pipeline 03/09/2025, 07:41:52
2025-03-09 07:41:52,437 [INFO]: Reading total number of vectors and dimension 03/09/2025, 07:41:52
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1975.65it/s]
2025-03-09 07:41:52,464 [INFO]: There are 5201 embeddings of dim 49152
2025-03-09 07:41:52,464 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0271 secs
2025-03-09 07:41:52,464 [INFO]: 	Compute estimated construction time of the index 03/09/2025, 07:41:52
2025-03-09 07:41:52,464 [INFO]: 		-> Train: 16.7 minutes
2025-03-09 07:41:52,464 [INFO]: 		-> Add: 2.9 seconds
2025-03-09 07:41:52,464 [INFO]: 		Total: 16.7 minutes
2025-03-09 07:41:52,464 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0001 secs
2025-03-09 07:41:52,464 [INFO]: 	Checking that your have enough memory available to create the index 03/09/2025, 07:41:52
2025-03-09 07:41:52,464 [INFO]: 1.0GB of memory will be needed to build the index (more might be used if you have more)
2025-03-09 07:41:52,464 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0001 secs
2025-03-09 07:41:52,465 [INFO]: 	Selecting most promising index types given data characteristics 03/09/2025, 07:41:52
2025-03-09 07:41:52,465 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-09 07:41:52,465 [INFO]: 	Creating the index 03/09/2025, 07:41:52
2025-03-09 07:41:52,465 [INFO]: 		-> Instanciate the index HNSW15 03/09/2025, 07:41:52
2025-03-09 07:41:52,466 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0009 secs
2025-03-09 07:41:52,466 [INFO]: 		-> Adding the vectors to the index 03/09/2025, 07:41:52
2025-03-09 07:41:52,466 [INFO]: The memory available for adding the vectors is 49.0GB(total available - used by the index)
2025-03-09 07:41:52,466 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/22 [00:00<?, ?it/s]  5%|▍         | 1/22 [00:00<00:03,  6.95it/s] 14%|█▎        | 3/22 [00:00<00:01, 12.80it/s] 23%|██▎       | 5/22 [00:00<00:01, 14.65it/s] 32%|███▏      | 7/22 [00:00<00:01, 14.64it/s] 41%|████      | 9/22 [00:00<00:00, 14.88it/s] 50%|█████     | 11/22 [00:00<00:00, 16.24it/s] 59%|█████▉    | 13/22 [00:00<00:00, 15.55it/s] 68%|██████▊   | 15/22 [00:01<00:00, 14.88it/s] 77%|███████▋  | 17/22 [00:01<00:00, 15.03it/s] 86%|████████▋ | 19/22 [00:01<00:00, 15.17it/s] 95%|█████████▌| 21/22 [00:04<00:00,  1.80it/s]100%|██████████| 22/22 [00:05<00:00,  4.02it/s]
2025-03-09 07:41:57,944 [INFO]: 	Computing best hyperparameters for index knn.index 03/09/2025, 07:41:57
2025-03-09 07:42:38,786 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 40.8413 secs
2025-03-09 07:42:38,786 [INFO]: The best hyperparameters are: efSearch=307
2025-03-09 07:42:38,786 [INFO]: 	Compute fast metrics 03/09/2025, 07:42:38
  0%|          | 0/4 [00:00<?, ?it/s] 25%|██▌       | 1/4 [00:00<00:00,  4.88it/s] 50%|█████     | 2/4 [00:00<00:00,  6.19it/s] 75%|███████▌  | 3/4 [00:00<00:00,  6.77it/s] 75%|███████▌  | 3/4 [00:00<00:00,  5.13it/s]
2025-03-09 07:42:53,567 [INFO]: 	>>> Finished "Compute fast metrics" in 14.7805 secs
2025-03-09 07:42:53,567 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 61.1014 secs
2025-03-09 07:42:53,567 [INFO]: {
2025-03-09 07:42:53,567 [INFO]: 	index_key: HNSW15
2025-03-09 07:42:53,567 [INFO]: 	index_param: efSearch=307
2025-03-09 07:42:53,567 [INFO]: 	index_path: knn.index
2025-03-09 07:42:53,567 [INFO]: 	size in bytes: 1023265990
2025-03-09 07:42:53,567 [INFO]: 	avg_search_speed_ms: 9.885660131791377
2025-03-09 07:42:53,567 [INFO]: 	99p_search_speed_ms: 14.645337937399743
2025-03-09 07:42:53,567 [INFO]: 	reconstruction error %: 0.0
2025-03-09 07:42:53,567 [INFO]: 	nb vectors: 5201
2025-03-09 07:42:53,567 [INFO]: 	vectors dimension: 49152
2025-03-09 07:42:53,567 [INFO]: 	compression ratio: 0.999308310833237
2025-03-09 07:42:53,567 [INFO]: }
2025-03-09 07:42:53,567 [INFO]: 	>>> Finished "Creating the index" in 61.1027 secs
2025-03-09 07:42:53,567 [INFO]: >>> Finished "Launching the whole pipeline" in 61.1304 secs
2025-03-09 07:42:57: [retrieval_preprocessing] calculating distances ...
2025-03-09 07:43:00: [retrieval_preprocessing] finished and saved retrieval indices for episode 19225 [episode count 14/20]
[retrieval_preprocessing] for episode 93725 [episode count 15/20], we have num_retrieval=np.int64(5595) num_query=np.int64(171)
2025-03-09 07:43:01,880 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-09 07:43:02,898 [INFO]: Launching the whole pipeline 03/09/2025, 07:43:02
2025-03-09 07:43:02,898 [INFO]: Reading total number of vectors and dimension 03/09/2025, 07:43:02
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1343.04it/s]
2025-03-09 07:43:02,935 [INFO]: There are 5595 embeddings of dim 49152
2025-03-09 07:43:02,935 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0375 secs
2025-03-09 07:43:02,935 [INFO]: 	Compute estimated construction time of the index 03/09/2025, 07:43:02
2025-03-09 07:43:02,935 [INFO]: 		-> Train: 16.7 minutes
2025-03-09 07:43:02,936 [INFO]: 		-> Add: 3.1 seconds
2025-03-09 07:43:02,936 [INFO]: 		Total: 16.7 minutes
2025-03-09 07:43:02,936 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0002 secs
2025-03-09 07:43:02,936 [INFO]: 	Checking that your have enough memory available to create the index 03/09/2025, 07:43:02
2025-03-09 07:43:02,936 [INFO]: 1.1GB of memory will be needed to build the index (more might be used if you have more)
2025-03-09 07:43:02,936 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0002 secs
2025-03-09 07:43:02,936 [INFO]: 	Selecting most promising index types given data characteristics 03/09/2025, 07:43:02
2025-03-09 07:43:02,936 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-09 07:43:02,936 [INFO]: 	Creating the index 03/09/2025, 07:43:02
2025-03-09 07:43:02,936 [INFO]: 		-> Instanciate the index HNSW15 03/09/2025, 07:43:02
2025-03-09 07:43:02,938 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0017 secs
2025-03-09 07:43:02,938 [INFO]: 		-> Adding the vectors to the index 03/09/2025, 07:43:02
2025-03-09 07:43:02,938 [INFO]: The memory available for adding the vectors is 49.0GB(total available - used by the index)
2025-03-09 07:43:02,938 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/24 [00:00<?, ?it/s]  4%|▍         | 1/24 [00:00<00:04,  5.35it/s] 12%|█▎        | 3/24 [00:00<00:02,  8.83it/s] 21%|██        | 5/24 [00:00<00:01, 10.15it/s] 29%|██▉       | 7/24 [00:00<00:01, 11.02it/s] 38%|███▊      | 9/24 [00:00<00:01, 12.71it/s] 46%|████▌     | 11/24 [00:00<00:00, 13.98it/s] 54%|█████▍    | 13/24 [00:01<00:00, 15.05it/s] 62%|██████▎   | 15/24 [00:01<00:00, 15.97it/s] 71%|███████   | 17/24 [00:01<00:00, 14.50it/s] 79%|███████▉  | 19/24 [00:01<00:00, 13.52it/s] 88%|████████▊ | 21/24 [00:04<00:01,  1.71it/s] 92%|█████████▏| 22/24 [00:05<00:00,  2.01it/s]100%|██████████| 24/24 [00:06<00:00,  1.79it/s]100%|██████████| 24/24 [00:06<00:00,  3.74it/s]
2025-03-09 07:43:09,364 [INFO]: 	Computing best hyperparameters for index knn.index 03/09/2025, 07:43:09
2025-03-09 07:43:56,816 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 47.4514 secs
2025-03-09 07:43:56,816 [INFO]: The best hyperparameters are: efSearch=252
2025-03-09 07:43:56,816 [INFO]: 	Compute fast metrics 03/09/2025, 07:43:56
  0%|          | 0/4 [00:00<?, ?it/s] 25%|██▌       | 1/4 [00:00<00:00,  6.17it/s] 75%|███████▌  | 3/4 [00:00<00:00,  9.09it/s] 75%|███████▌  | 3/4 [00:00<00:00,  6.97it/s]
2025-03-09 07:44:13,029 [INFO]: 	>>> Finished "Compute fast metrics" in 16.2125 secs
2025-03-09 07:44:13,030 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 70.0917 secs
2025-03-09 07:44:13,030 [INFO]: {
2025-03-09 07:44:13,030 [INFO]: 	index_key: HNSW15
2025-03-09 07:44:13,030 [INFO]: 	index_param: efSearch=252
2025-03-09 07:44:13,030 [INFO]: 	index_path: knn.index
2025-03-09 07:44:13,030 [INFO]: 	size in bytes: 1100783530
2025-03-09 07:44:13,030 [INFO]: 	avg_search_speed_ms: 9.274499157377983
2025-03-09 07:44:13,030 [INFO]: 	99p_search_speed_ms: 15.018941746093335
2025-03-09 07:44:13,030 [INFO]: 	reconstruction error %: 0.0
2025-03-09 07:44:13,030 [INFO]: 	nb vectors: 5595
2025-03-09 07:44:13,030 [INFO]: 	vectors dimension: 49152
2025-03-09 07:44:13,030 [INFO]: 	compression ratio: 0.999307974747769
2025-03-09 07:44:13,030 [INFO]: }
2025-03-09 07:44:13,030 [INFO]: 	>>> Finished "Creating the index" in 70.0939 secs
2025-03-09 07:44:13,030 [INFO]: >>> Finished "Launching the whole pipeline" in 70.1323 secs
2025-03-09 07:44:14: [retrieval_preprocessing] calculating distances ...
2025-03-09 07:44:15: [retrieval_preprocessing] finished and saved retrieval indices for episode 93725 [episode count 15/20]
[retrieval_preprocessing] for episode 19873 [episode count 16/20], we have num_retrieval=np.int64(5535) num_query=np.int64(231)
2025-03-09 07:44:16,694 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-09 07:44:17,504 [INFO]: Launching the whole pipeline 03/09/2025, 07:44:17
2025-03-09 07:44:17,504 [INFO]: Reading total number of vectors and dimension 03/09/2025, 07:44:17
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 2209.85it/s]
2025-03-09 07:44:17,528 [INFO]: There are 5535 embeddings of dim 49152
2025-03-09 07:44:17,528 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0241 secs
2025-03-09 07:44:17,528 [INFO]: 	Compute estimated construction time of the index 03/09/2025, 07:44:17
2025-03-09 07:44:17,528 [INFO]: 		-> Train: 16.7 minutes
2025-03-09 07:44:17,528 [INFO]: 		-> Add: 3.0 seconds
2025-03-09 07:44:17,528 [INFO]: 		Total: 16.7 minutes
2025-03-09 07:44:17,528 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0001 secs
2025-03-09 07:44:17,528 [INFO]: 	Checking that your have enough memory available to create the index 03/09/2025, 07:44:17
2025-03-09 07:44:17,528 [INFO]: 1.1GB of memory will be needed to build the index (more might be used if you have more)
2025-03-09 07:44:17,528 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0001 secs
2025-03-09 07:44:17,528 [INFO]: 	Selecting most promising index types given data characteristics 03/09/2025, 07:44:17
2025-03-09 07:44:17,528 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-09 07:44:17,528 [INFO]: 	Creating the index 03/09/2025, 07:44:17
2025-03-09 07:44:17,528 [INFO]: 		-> Instanciate the index HNSW15 03/09/2025, 07:44:17
2025-03-09 07:44:17,529 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0009 secs
2025-03-09 07:44:17,529 [INFO]: 		-> Adding the vectors to the index 03/09/2025, 07:44:17
2025-03-09 07:44:17,529 [INFO]: The memory available for adding the vectors is 49.0GB(total available - used by the index)
2025-03-09 07:44:17,529 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/23 [00:00<?, ?it/s]  4%|▍         | 1/23 [00:00<00:04,  4.85it/s]  9%|▊         | 2/23 [00:00<00:03,  6.51it/s] 13%|█▎        | 3/23 [00:00<00:02,  7.20it/s] 17%|█▋        | 4/23 [00:00<00:02,  7.76it/s] 22%|██▏       | 5/23 [00:00<00:02,  7.89it/s] 26%|██▌       | 6/23 [00:00<00:02,  7.92it/s] 30%|███       | 7/23 [00:00<00:02,  7.94it/s] 35%|███▍      | 8/23 [00:01<00:01,  7.85it/s] 39%|███▉      | 9/23 [00:01<00:02,  5.85it/s] 43%|████▎     | 10/23 [00:01<00:02,  6.34it/s] 52%|█████▏    | 12/23 [00:01<00:01,  7.75it/s] 61%|██████    | 14/23 [00:01<00:01,  8.63it/s] 70%|██████▉   | 16/23 [00:02<00:00,  9.14it/s] 78%|███████▊  | 18/23 [00:02<00:00,  9.51it/s] 87%|████████▋ | 20/23 [00:02<00:00,  9.86it/s] 91%|█████████▏| 21/23 [00:05<00:01,  1.33it/s] 96%|█████████▌| 22/23 [00:06<00:00,  1.63it/s]100%|██████████| 23/23 [00:07<00:00,  1.35it/s]100%|██████████| 23/23 [00:07<00:00,  3.19it/s]
2025-03-09 07:44:24,752 [INFO]: 	Computing best hyperparameters for index knn.index 03/09/2025, 07:44:24
2025-03-09 07:45:08,711 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 43.9582 secs
2025-03-09 07:45:08,711 [INFO]: The best hyperparameters are: efSearch=298
2025-03-09 07:45:08,711 [INFO]: 	Compute fast metrics 03/09/2025, 07:45:08
  0%|          | 0/4 [00:00<?, ?it/s] 25%|██▌       | 1/4 [00:00<00:00,  5.42it/s] 50%|█████     | 2/4 [00:00<00:00,  7.08it/s] 75%|███████▌  | 3/4 [00:00<00:00,  7.95it/s] 75%|███████▌  | 3/4 [00:00<00:00,  6.01it/s]
2025-03-09 07:45:25,256 [INFO]: 	>>> Finished "Compute fast metrics" in 16.5446 secs
2025-03-09 07:45:25,256 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 67.7271 secs
2025-03-09 07:45:25,257 [INFO]: {
2025-03-09 07:45:25,257 [INFO]: 	index_key: HNSW15
2025-03-09 07:45:25,257 [INFO]: 	index_param: efSearch=298
2025-03-09 07:45:25,257 [INFO]: 	index_path: knn.index
2025-03-09 07:45:25,257 [INFO]: 	size in bytes: 1088978890
2025-03-09 07:45:25,257 [INFO]: 	avg_search_speed_ms: 10.280069103990925
2025-03-09 07:45:25,257 [INFO]: 	99p_search_speed_ms: 16.032914435490962
2025-03-09 07:45:25,257 [INFO]: 	reconstruction error %: 0.0
2025-03-09 07:45:25,257 [INFO]: 	nb vectors: 5535
2025-03-09 07:45:25,257 [INFO]: 	vectors dimension: 49152
2025-03-09 07:45:25,257 [INFO]: 	compression ratio: 0.9993079663830765
2025-03-09 07:45:25,257 [INFO]: }
2025-03-09 07:45:25,257 [INFO]: 	>>> Finished "Creating the index" in 67.7287 secs
2025-03-09 07:45:25,257 [INFO]: >>> Finished "Launching the whole pipeline" in 67.7533 secs
2025-03-09 07:45:27: [retrieval_preprocessing] calculating distances ...
2025-03-09 07:45:27: [retrieval_preprocessing] finished and saved retrieval indices for episode 19873 [episode count 16/20]
[retrieval_preprocessing] for episode 83489 [episode count 17/20], we have num_retrieval=np.int64(5530) num_query=np.int64(236)
2025-03-09 07:45:29,790 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-09 07:45:30,637 [INFO]: Launching the whole pipeline 03/09/2025, 07:45:30
2025-03-09 07:45:30,637 [INFO]: Reading total number of vectors and dimension 03/09/2025, 07:45:30
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 2175.47it/s]
2025-03-09 07:45:30,661 [INFO]: There are 5530 embeddings of dim 49152
2025-03-09 07:45:30,661 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0243 secs
2025-03-09 07:45:30,661 [INFO]: 	Compute estimated construction time of the index 03/09/2025, 07:45:30
2025-03-09 07:45:30,661 [INFO]: 		-> Train: 16.7 minutes
2025-03-09 07:45:30,661 [INFO]: 		-> Add: 3.0 seconds
2025-03-09 07:45:30,661 [INFO]: 		Total: 16.7 minutes
2025-03-09 07:45:30,662 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0001 secs
2025-03-09 07:45:30,662 [INFO]: 	Checking that your have enough memory available to create the index 03/09/2025, 07:45:30
2025-03-09 07:45:30,662 [INFO]: 1.1GB of memory will be needed to build the index (more might be used if you have more)
2025-03-09 07:45:30,662 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0001 secs
2025-03-09 07:45:30,662 [INFO]: 	Selecting most promising index types given data characteristics 03/09/2025, 07:45:30
2025-03-09 07:45:30,662 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-09 07:45:30,662 [INFO]: 	Creating the index 03/09/2025, 07:45:30
2025-03-09 07:45:30,662 [INFO]: 		-> Instanciate the index HNSW15 03/09/2025, 07:45:30
2025-03-09 07:45:30,663 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0008 secs
2025-03-09 07:45:30,663 [INFO]: 		-> Adding the vectors to the index 03/09/2025, 07:45:30
2025-03-09 07:45:30,663 [INFO]: The memory available for adding the vectors is 49.0GB(total available - used by the index)
2025-03-09 07:45:30,663 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/23 [00:00<?, ?it/s]  4%|▍         | 1/23 [00:00<00:03,  5.75it/s] 13%|█▎        | 3/23 [00:00<00:02,  9.47it/s] 22%|██▏       | 5/23 [00:00<00:01, 10.71it/s] 30%|███       | 7/23 [00:00<00:01, 11.30it/s] 39%|███▉      | 9/23 [00:00<00:01, 11.55it/s] 48%|████▊     | 11/23 [00:01<00:01, 11.24it/s] 57%|█████▋    | 13/23 [00:01<00:00, 11.16it/s] 65%|██████▌   | 15/23 [00:01<00:00, 11.33it/s] 74%|███████▍  | 17/23 [00:01<00:00, 11.54it/s] 83%|████████▎ | 19/23 [00:01<00:00, 11.59it/s] 91%|█████████▏| 21/23 [00:04<00:01,  1.80it/s]100%|██████████| 23/23 [00:06<00:00,  1.74it/s]100%|██████████| 23/23 [00:06<00:00,  3.73it/s]
2025-03-09 07:45:36,837 [INFO]: 	Computing best hyperparameters for index knn.index 03/09/2025, 07:45:36
2025-03-09 07:46:19,963 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 43.1255 secs
2025-03-09 07:46:19,963 [INFO]: The best hyperparameters are: efSearch=266
2025-03-09 07:46:19,963 [INFO]: 	Compute fast metrics 03/09/2025, 07:46:19
  0%|          | 0/4 [00:00<?, ?it/s] 25%|██▌       | 1/4 [00:00<00:00,  5.65it/s] 50%|█████     | 2/4 [00:00<00:00,  6.96it/s] 75%|███████▌  | 3/4 [00:00<00:00,  7.24it/s] 75%|███████▌  | 3/4 [00:00<00:00,  5.43it/s]
2025-03-09 07:46:44,125 [INFO]: 	>>> Finished "Compute fast metrics" in 24.1617 secs
2025-03-09 07:46:44,126 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 73.4636 secs
2025-03-09 07:46:44,127 [INFO]: {
2025-03-09 07:46:44,127 [INFO]: 	index_key: HNSW15
2025-03-09 07:46:44,127 [INFO]: 	index_param: efSearch=266
2025-03-09 07:46:44,127 [INFO]: 	index_path: knn.index
2025-03-09 07:46:44,127 [INFO]: 	size in bytes: 1087995130
2025-03-09 07:46:44,127 [INFO]: 	avg_search_speed_ms: 10.727063579836564
2025-03-09 07:46:44,127 [INFO]: 	99p_search_speed_ms: 21.218786318786442
2025-03-09 07:46:44,127 [INFO]: 	reconstruction error %: 0.0
2025-03-09 07:46:44,127 [INFO]: 	nb vectors: 5530
2025-03-09 07:46:44,127 [INFO]: 	vectors dimension: 49152
2025-03-09 07:46:44,127 [INFO]: 	compression ratio: 0.9993080024172535
2025-03-09 07:46:44,127 [INFO]: }
2025-03-09 07:46:44,127 [INFO]: 	>>> Finished "Creating the index" in 73.4650 secs
2025-03-09 07:46:44,127 [INFO]: >>> Finished "Launching the whole pipeline" in 73.4898 secs
2025-03-09 07:46:46: [retrieval_preprocessing] calculating distances ...
2025-03-09 07:46:47: [retrieval_preprocessing] finished and saved retrieval indices for episode 83489 [episode count 17/20]
[retrieval_preprocessing] for episode 26532 [episode count 18/20], we have num_retrieval=np.int64(5431) num_query=np.int64(335)
2025-03-09 07:46:50,582 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-09 07:46:51,638 [INFO]: Launching the whole pipeline 03/09/2025, 07:46:51
2025-03-09 07:46:51,638 [INFO]: Reading total number of vectors and dimension 03/09/2025, 07:46:51
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1102.02it/s]
2025-03-09 07:46:51,674 [INFO]: There are 5431 embeddings of dim 49152
2025-03-09 07:46:51,674 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0366 secs
2025-03-09 07:46:51,674 [INFO]: 	Compute estimated construction time of the index 03/09/2025, 07:46:51
2025-03-09 07:46:51,675 [INFO]: 		-> Train: 16.7 minutes
2025-03-09 07:46:51,675 [INFO]: 		-> Add: 3.0 seconds
2025-03-09 07:46:51,675 [INFO]: 		Total: 16.7 minutes
2025-03-09 07:46:51,675 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0002 secs
2025-03-09 07:46:51,675 [INFO]: 	Checking that your have enough memory available to create the index 03/09/2025, 07:46:51
2025-03-09 07:46:51,675 [INFO]: 1.1GB of memory will be needed to build the index (more might be used if you have more)
2025-03-09 07:46:51,675 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0004 secs
2025-03-09 07:46:51,675 [INFO]: 	Selecting most promising index types given data characteristics 03/09/2025, 07:46:51
2025-03-09 07:46:51,675 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-09 07:46:51,675 [INFO]: 	Creating the index 03/09/2025, 07:46:51
2025-03-09 07:46:51,676 [INFO]: 		-> Instanciate the index HNSW15 03/09/2025, 07:46:51
2025-03-09 07:46:51,678 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0020 secs
2025-03-09 07:46:51,678 [INFO]: 		-> Adding the vectors to the index 03/09/2025, 07:46:51
2025-03-09 07:46:51,678 [INFO]: The memory available for adding the vectors is 49.0GB(total available - used by the index)
2025-03-09 07:46:51,678 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/23 [00:00<?, ?it/s]  4%|▍         | 1/23 [00:00<00:04,  5.03it/s]  9%|▊         | 2/23 [00:00<00:03,  6.84it/s] 13%|█▎        | 3/23 [00:00<00:02,  7.62it/s] 17%|█▋        | 4/23 [00:00<00:02,  8.07it/s] 26%|██▌       | 6/23 [00:00<00:01,  9.06it/s] 30%|███       | 7/23 [00:00<00:01,  9.30it/s] 35%|███▍      | 8/23 [00:00<00:01,  8.60it/s] 39%|███▉      | 9/23 [00:01<00:01,  8.87it/s] 48%|████▊     | 11/23 [00:01<00:01,  9.40it/s] 52%|█████▏    | 12/23 [00:01<00:01,  8.71it/s] 57%|█████▋    | 13/23 [00:01<00:01,  8.96it/s] 61%|██████    | 14/23 [00:01<00:01,  8.82it/s] 65%|██████▌   | 15/23 [00:01<00:00,  8.55it/s] 70%|██████▉   | 16/23 [00:01<00:00,  7.91it/s] 78%|███████▊  | 18/23 [00:02<00:00,  8.99it/s] 87%|████████▋ | 20/23 [00:02<00:00,  9.46it/s] 91%|█████████▏| 21/23 [00:06<00:02,  1.09s/it]100%|██████████| 23/23 [00:08<00:00,  1.11it/s]100%|██████████| 23/23 [00:08<00:00,  2.83it/s]
2025-03-09 07:46:59,795 [INFO]: 	Computing best hyperparameters for index knn.index 03/09/2025, 07:46:59
2025-03-09 07:47:41,928 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 42.1331 secs
2025-03-09 07:47:41,928 [INFO]: The best hyperparameters are: efSearch=294
2025-03-09 07:47:41,928 [INFO]: 	Compute fast metrics 03/09/2025, 07:47:41
  0%|          | 0/4 [00:00<?, ?it/s] 25%|██▌       | 1/4 [00:00<00:00,  4.93it/s] 50%|█████     | 2/4 [00:00<00:00,  6.23it/s] 75%|███████▌  | 3/4 [00:00<00:00,  6.82it/s] 75%|███████▌  | 3/4 [00:00<00:00,  5.16it/s]
2025-03-09 07:48:01,196 [INFO]: 	>>> Finished "Compute fast metrics" in 19.2675 secs
2025-03-09 07:48:01,197 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 69.5187 secs
2025-03-09 07:48:01,197 [INFO]: {
2025-03-09 07:48:01,197 [INFO]: 	index_key: HNSW15
2025-03-09 07:48:01,197 [INFO]: 	index_param: efSearch=294
2025-03-09 07:48:01,197 [INFO]: 	index_path: knn.index
2025-03-09 07:48:01,197 [INFO]: 	size in bytes: 1068517390
2025-03-09 07:48:01,197 [INFO]: 	avg_search_speed_ms: 10.34202688949562
2025-03-09 07:48:01,197 [INFO]: 	99p_search_speed_ms: 18.876079497858882
2025-03-09 07:48:01,197 [INFO]: 	reconstruction error %: 0.0
2025-03-09 07:48:01,197 [INFO]: 	nb vectors: 5431
2025-03-09 07:48:01,197 [INFO]: 	vectors dimension: 49152
2025-03-09 07:48:01,197 [INFO]: 	compression ratio: 0.9993080674147943
2025-03-09 07:48:01,197 [INFO]: }
2025-03-09 07:48:01,197 [INFO]: 	>>> Finished "Creating the index" in 69.5216 secs
2025-03-09 07:48:01,197 [INFO]: >>> Finished "Launching the whole pipeline" in 69.5594 secs
2025-03-09 07:48:03: [retrieval_preprocessing] calculating distances ...
2025-03-09 07:48:04: [retrieval_preprocessing] finished and saved retrieval indices for episode 26532 [episode count 18/20]
[retrieval_preprocessing] for episode 12197 [episode count 19/20], we have num_retrieval=np.int64(5375) num_query=np.int64(391)
2025-03-09 07:48:06,118 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-09 07:48:06,835 [INFO]: Launching the whole pipeline 03/09/2025, 07:48:06
2025-03-09 07:48:06,835 [INFO]: Reading total number of vectors and dimension 03/09/2025, 07:48:06
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1479.47it/s]
2025-03-09 07:48:06,861 [INFO]: There are 5375 embeddings of dim 49152
2025-03-09 07:48:06,861 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0257 secs
2025-03-09 07:48:06,861 [INFO]: 	Compute estimated construction time of the index 03/09/2025, 07:48:06
2025-03-09 07:48:06,861 [INFO]: 		-> Train: 16.7 minutes
2025-03-09 07:48:06,861 [INFO]: 		-> Add: 3.0 seconds
2025-03-09 07:48:06,861 [INFO]: 		Total: 16.7 minutes
2025-03-09 07:48:06,861 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0001 secs
2025-03-09 07:48:06,861 [INFO]: 	Checking that your have enough memory available to create the index 03/09/2025, 07:48:06
2025-03-09 07:48:06,861 [INFO]: 1.1GB of memory will be needed to build the index (more might be used if you have more)
2025-03-09 07:48:06,862 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0001 secs
2025-03-09 07:48:06,862 [INFO]: 	Selecting most promising index types given data characteristics 03/09/2025, 07:48:06
2025-03-09 07:48:06,862 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-09 07:48:06,862 [INFO]: 	Creating the index 03/09/2025, 07:48:06
2025-03-09 07:48:06,862 [INFO]: 		-> Instanciate the index HNSW15 03/09/2025, 07:48:06
2025-03-09 07:48:06,863 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0009 secs
2025-03-09 07:48:06,863 [INFO]: 		-> Adding the vectors to the index 03/09/2025, 07:48:06
2025-03-09 07:48:06,863 [INFO]: The memory available for adding the vectors is 49.0GB(total available - used by the index)
2025-03-09 07:48:06,863 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/23 [00:00<?, ?it/s]  4%|▍         | 1/23 [00:00<00:04,  4.94it/s] 13%|█▎        | 3/23 [00:00<00:02,  8.35it/s] 22%|██▏       | 5/23 [00:00<00:01,  9.58it/s] 30%|███       | 7/23 [00:00<00:01, 10.12it/s] 39%|███▉      | 9/23 [00:00<00:01, 10.65it/s] 48%|████▊     | 11/23 [00:01<00:00, 12.21it/s] 57%|█████▋    | 13/23 [00:01<00:00, 13.35it/s] 65%|██████▌   | 15/23 [00:01<00:00, 14.08it/s] 74%|███████▍  | 17/23 [00:01<00:00, 14.26it/s] 83%|████████▎ | 19/23 [00:01<00:00, 12.70it/s] 91%|█████████▏| 21/23 [00:05<00:01,  1.73it/s] 96%|█████████▌| 22/23 [00:05<00:00,  2.03it/s]100%|██████████| 23/23 [00:06<00:00,  1.69it/s]100%|██████████| 23/23 [00:06<00:00,  3.76it/s]
2025-03-09 07:48:12,980 [INFO]: 	Computing best hyperparameters for index knn.index 03/09/2025, 07:48:12
2025-03-09 07:48:55,139 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 42.1584 secs
2025-03-09 07:48:55,139 [INFO]: The best hyperparameters are: efSearch=308
2025-03-09 07:48:55,139 [INFO]: 	Compute fast metrics 03/09/2025, 07:48:55
  0%|          | 0/4 [00:00<?, ?it/s] 25%|██▌       | 1/4 [00:00<00:00,  6.75it/s] 75%|███████▌  | 3/4 [00:00<00:00,  9.84it/s] 75%|███████▌  | 3/4 [00:00<00:00,  7.58it/s]
2025-03-09 07:49:14,119 [INFO]: 	>>> Finished "Compute fast metrics" in 18.9793 secs
2025-03-09 07:49:14,120 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 67.2573 secs
2025-03-09 07:49:14,120 [INFO]: {
2025-03-09 07:49:14,120 [INFO]: 	index_key: HNSW15
2025-03-09 07:49:14,120 [INFO]: 	index_param: efSearch=308
2025-03-09 07:49:14,120 [INFO]: 	index_path: knn.index
2025-03-09 07:49:14,120 [INFO]: 	size in bytes: 1057499710
2025-03-09 07:49:14,120 [INFO]: 	avg_search_speed_ms: 11.104983609680346
2025-03-09 07:49:14,120 [INFO]: 	99p_search_speed_ms: 17.788136145099998
2025-03-09 07:49:14,120 [INFO]: 	reconstruction error %: 0.0
2025-03-09 07:49:14,120 [INFO]: 	nb vectors: 5375
2025-03-09 07:49:14,120 [INFO]: 	vectors dimension: 49152
2025-03-09 07:49:14,120 [INFO]: 	compression ratio: 0.9993080754603706
2025-03-09 07:49:14,120 [INFO]: }
2025-03-09 07:49:14,120 [INFO]: 	>>> Finished "Creating the index" in 67.2588 secs
2025-03-09 07:49:14,121 [INFO]: >>> Finished "Launching the whole pipeline" in 67.2851 secs
2025-03-09 07:49:17: [retrieval_preprocessing] calculating distances ...
2025-03-09 07:49:18: [retrieval_preprocessing] finished and saved retrieval indices for episode 12197 [episode count 19/20]
2025-03-09 07:49:18: [retrieval_preprocessing] finished for (8098563998, 'lid') [chosen_id count 2/10]
2025-03-09 07:49:23: [retrieval_preprocessing] concatenated all embeddings and indices for 20 episodes for (9505766118, 'drawer') [chosen_id count 3/10]
2025-03-09 07:49:23: [retrieval_preprocessing] we have num_total=3715 embedding_dim=49152
[retrieval_preprocessing] for episode 87044 [episode count 0/20], we have num_retrieval=np.int64(3486) num_query=np.int64(229)
2025-03-09 07:49:24,520 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-09 07:49:25,090 [INFO]: Launching the whole pipeline 03/09/2025, 07:49:25
2025-03-09 07:49:25,091 [INFO]: Reading total number of vectors and dimension 03/09/2025, 07:49:25
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1455.85it/s]
2025-03-09 07:49:25,117 [INFO]: There are 3486 embeddings of dim 49152
2025-03-09 07:49:25,117 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0264 secs
2025-03-09 07:49:25,117 [INFO]: 	Compute estimated construction time of the index 03/09/2025, 07:49:25
2025-03-09 07:49:25,117 [INFO]: 		-> Train: 16.7 minutes
2025-03-09 07:49:25,117 [INFO]: 		-> Add: 1.9 seconds
2025-03-09 07:49:25,117 [INFO]: 		Total: 16.7 minutes
2025-03-09 07:49:25,117 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0001 secs
2025-03-09 07:49:25,117 [INFO]: 	Checking that your have enough memory available to create the index 03/09/2025, 07:49:25
2025-03-09 07:49:25,117 [INFO]: 719.4MB of memory will be needed to build the index (more might be used if you have more)
2025-03-09 07:49:25,117 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0002 secs
2025-03-09 07:49:25,117 [INFO]: 	Selecting most promising index types given data characteristics 03/09/2025, 07:49:25
2025-03-09 07:49:25,117 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-09 07:49:25,118 [INFO]: 	Creating the index 03/09/2025, 07:49:25
2025-03-09 07:49:25,118 [INFO]: 		-> Instanciate the index HNSW15 03/09/2025, 07:49:25
2025-03-09 07:49:25,119 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0011 secs
2025-03-09 07:49:25,119 [INFO]: 		-> Adding the vectors to the index 03/09/2025, 07:49:25
2025-03-09 07:49:25,119 [INFO]: The memory available for adding the vectors is 49.4GB(total available - used by the index)
2025-03-09 07:49:25,119 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/14 [00:00<?, ?it/s]  7%|▋         | 1/14 [00:00<00:02,  4.34it/s] 21%|██▏       | 3/14 [00:00<00:01,  8.85it/s] 36%|███▌      | 5/14 [00:00<00:00, 11.63it/s] 50%|█████     | 7/14 [00:00<00:00, 13.09it/s] 64%|██████▍   | 9/14 [00:00<00:00, 13.90it/s] 79%|███████▊  | 11/14 [00:00<00:00, 13.75it/s] 93%|█████████▎| 13/14 [00:01<00:00, 14.30it/s]100%|██████████| 14/14 [00:03<00:00,  3.61it/s]
2025-03-09 07:49:29,002 [INFO]: 	Computing best hyperparameters for index knn.index 03/09/2025, 07:49:29
2025-03-09 07:50:08,315 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 39.3123 secs
2025-03-09 07:50:08,316 [INFO]: The best hyperparameters are: efSearch=300
2025-03-09 07:50:08,316 [INFO]: 	Compute fast metrics 03/09/2025, 07:50:08
  0%|          | 0/4 [00:00<?, ?it/s] 25%|██▌       | 1/4 [00:00<00:00,  5.52it/s] 50%|█████     | 2/4 [00:00<00:00,  7.06it/s] 75%|███████▌  | 3/4 [00:00<00:00,  7.64it/s] 75%|███████▌  | 3/4 [00:00<00:00,  5.73it/s]
2025-03-09 07:50:22,508 [INFO]: 	>>> Finished "Compute fast metrics" in 14.1919 secs
2025-03-09 07:50:22,510 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 57.3912 secs
2025-03-09 07:50:22,510 [INFO]: {
2025-03-09 07:50:22,510 [INFO]: 	index_key: HNSW15
2025-03-09 07:50:22,510 [INFO]: 	index_param: efSearch=300
2025-03-09 07:50:22,510 [INFO]: 	index_path: knn.index
2025-03-09 07:50:22,510 [INFO]: 	size in bytes: 685849090
2025-03-09 07:50:22,510 [INFO]: 	avg_search_speed_ms: 10.977082790727149
2025-03-09 07:50:22,510 [INFO]: 	99p_search_speed_ms: 17.33227327931671
2025-03-09 07:50:22,510 [INFO]: 	reconstruction error %: 0.0
2025-03-09 07:50:22,510 [INFO]: 	nb vectors: 3486
2025-03-09 07:50:22,510 [INFO]: 	vectors dimension: 49152
2025-03-09 07:50:22,510 [INFO]: 	compression ratio: 0.9993094661684249
2025-03-09 07:50:22,510 [INFO]: }
2025-03-09 07:50:22,510 [INFO]: 	>>> Finished "Creating the index" in 57.3927 secs
2025-03-09 07:50:22,510 [INFO]: >>> Finished "Launching the whole pipeline" in 57.4198 secs
2025-03-09 07:50:23: [retrieval_preprocessing] calculating distances ...
2025-03-09 07:50:24: [retrieval_preprocessing] finished and saved retrieval indices for episode 87044 [episode count 0/20]
[retrieval_preprocessing] for episode 82949 [episode count 1/20], we have num_retrieval=np.int64(3549) num_query=np.int64(166)
2025-03-09 07:50:26,125 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-09 07:50:26,732 [INFO]: Launching the whole pipeline 03/09/2025, 07:50:26
2025-03-09 07:50:26,732 [INFO]: Reading total number of vectors and dimension 03/09/2025, 07:50:26
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1509.83it/s]
2025-03-09 07:50:26,759 [INFO]: There are 3549 embeddings of dim 49152
2025-03-09 07:50:26,759 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0270 secs
2025-03-09 07:50:26,759 [INFO]: 	Compute estimated construction time of the index 03/09/2025, 07:50:26
2025-03-09 07:50:26,759 [INFO]: 		-> Train: 16.7 minutes
2025-03-09 07:50:26,759 [INFO]: 		-> Add: 1.9 seconds
2025-03-09 07:50:26,759 [INFO]: 		Total: 16.7 minutes
2025-03-09 07:50:26,759 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0001 secs
2025-03-09 07:50:26,759 [INFO]: 	Checking that your have enough memory available to create the index 03/09/2025, 07:50:26
2025-03-09 07:50:26,759 [INFO]: 732.4MB of memory will be needed to build the index (more might be used if you have more)
2025-03-09 07:50:26,760 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0001 secs
2025-03-09 07:50:26,760 [INFO]: 	Selecting most promising index types given data characteristics 03/09/2025, 07:50:26
2025-03-09 07:50:26,760 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-09 07:50:26,760 [INFO]: 	Creating the index 03/09/2025, 07:50:26
2025-03-09 07:50:26,760 [INFO]: 		-> Instanciate the index HNSW15 03/09/2025, 07:50:26
2025-03-09 07:50:26,761 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0010 secs
2025-03-09 07:50:26,761 [INFO]: 		-> Adding the vectors to the index 03/09/2025, 07:50:26
2025-03-09 07:50:26,761 [INFO]: The memory available for adding the vectors is 49.3GB(total available - used by the index)
2025-03-09 07:50:26,761 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/14 [00:00<?, ?it/s]  7%|▋         | 1/14 [00:00<00:02,  5.79it/s] 21%|██▏       | 3/14 [00:00<00:01,  9.34it/s] 36%|███▌      | 5/14 [00:00<00:00,  9.98it/s] 50%|█████     | 7/14 [00:00<00:00, 10.40it/s] 64%|██████▍   | 9/14 [00:00<00:00, 10.75it/s] 79%|███████▊  | 11/14 [00:01<00:00, 10.94it/s] 93%|█████████▎| 13/14 [00:01<00:00, 11.15it/s]100%|██████████| 14/14 [00:03<00:00,  3.79it/s]
2025-03-09 07:50:30,457 [INFO]: 	Computing best hyperparameters for index knn.index 03/09/2025, 07:50:30
2025-03-09 07:51:03,176 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 32.7194 secs
2025-03-09 07:51:03,177 [INFO]: The best hyperparameters are: efSearch=185
2025-03-09 07:51:03,177 [INFO]: 	Compute fast metrics 03/09/2025, 07:51:03
  0%|          | 0/4 [00:00<?, ?it/s] 25%|██▌       | 1/4 [00:00<00:00,  5.35it/s] 50%|█████     | 2/4 [00:00<00:00,  6.90it/s] 75%|███████▌  | 3/4 [00:00<00:00,  7.63it/s] 75%|███████▌  | 3/4 [00:00<00:00,  6.28it/s]
2025-03-09 07:51:19,925 [INFO]: 	>>> Finished "Compute fast metrics" in 16.7483 secs
2025-03-09 07:51:19,928 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 53.1668 secs
2025-03-09 07:51:19,928 [INFO]: {
2025-03-09 07:51:19,928 [INFO]: 	index_key: HNSW15
2025-03-09 07:51:19,928 [INFO]: 	index_param: efSearch=185
2025-03-09 07:51:19,928 [INFO]: 	index_path: knn.index
2025-03-09 07:51:19,928 [INFO]: 	size in bytes: 698243950
2025-03-09 07:51:19,928 [INFO]: 	avg_search_speed_ms: 7.011637331161591
2025-03-09 07:51:19,928 [INFO]: 	99p_search_speed_ms: 10.69334102794528
2025-03-09 07:51:19,928 [INFO]: 	reconstruction error %: 0.0
2025-03-09 07:51:19,928 [INFO]: 	nb vectors: 3549
2025-03-09 07:51:19,928 [INFO]: 	vectors dimension: 49152
2025-03-09 07:51:19,928 [INFO]: 	compression ratio: 0.9993094705654091
2025-03-09 07:51:19,928 [INFO]: }
2025-03-09 07:51:19,928 [INFO]: 	>>> Finished "Creating the index" in 53.1683 secs
2025-03-09 07:51:19,928 [INFO]: >>> Finished "Launching the whole pipeline" in 53.1958 secs
2025-03-09 07:51:20: [retrieval_preprocessing] calculating distances ...
2025-03-09 07:51:20: [retrieval_preprocessing] finished and saved retrieval indices for episode 82949 [episode count 1/20]
[retrieval_preprocessing] for episode 32779 [episode count 2/20], we have num_retrieval=np.int64(3538) num_query=np.int64(177)
2025-03-09 07:51:22,264 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-09 07:51:23,139 [INFO]: Launching the whole pipeline 03/09/2025, 07:51:23
2025-03-09 07:51:23,139 [INFO]: Reading total number of vectors and dimension 03/09/2025, 07:51:23
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1231.08it/s]
2025-03-09 07:51:23,171 [INFO]: There are 3538 embeddings of dim 49152
2025-03-09 07:51:23,172 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0330 secs
2025-03-09 07:51:23,172 [INFO]: 	Compute estimated construction time of the index 03/09/2025, 07:51:23
2025-03-09 07:51:23,172 [INFO]: 		-> Train: 16.7 minutes
2025-03-09 07:51:23,172 [INFO]: 		-> Add: 1.9 seconds
2025-03-09 07:51:23,172 [INFO]: 		Total: 16.7 minutes
2025-03-09 07:51:23,172 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0003 secs
2025-03-09 07:51:23,172 [INFO]: 	Checking that your have enough memory available to create the index 03/09/2025, 07:51:23
2025-03-09 07:51:23,172 [INFO]: 730.2MB of memory will be needed to build the index (more might be used if you have more)
2025-03-09 07:51:23,173 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0004 secs
2025-03-09 07:51:23,173 [INFO]: 	Selecting most promising index types given data characteristics 03/09/2025, 07:51:23
2025-03-09 07:51:23,173 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-09 07:51:23,173 [INFO]: 	Creating the index 03/09/2025, 07:51:23
2025-03-09 07:51:23,173 [INFO]: 		-> Instanciate the index HNSW15 03/09/2025, 07:51:23
2025-03-09 07:51:23,176 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0030 secs
2025-03-09 07:51:23,177 [INFO]: 		-> Adding the vectors to the index 03/09/2025, 07:51:23
2025-03-09 07:51:23,177 [INFO]: The memory available for adding the vectors is 49.4GB(total available - used by the index)
2025-03-09 07:51:23,177 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/14 [00:00<?, ?it/s]  7%|▋         | 1/14 [00:00<00:01,  7.78it/s] 14%|█▍        | 2/14 [00:00<00:01,  8.49it/s] 21%|██▏       | 3/14 [00:00<00:01,  8.65it/s] 29%|██▊       | 4/14 [00:00<00:01,  8.75it/s] 36%|███▌      | 5/14 [00:00<00:01,  8.79it/s] 43%|████▎     | 6/14 [00:00<00:00,  8.96it/s] 50%|█████     | 7/14 [00:00<00:00,  8.89it/s] 57%|█████▋    | 8/14 [00:00<00:00,  8.81it/s] 71%|███████▏  | 10/14 [00:01<00:00,  9.97it/s] 79%|███████▊  | 11/14 [00:01<00:00,  9.82it/s] 86%|████████▌ | 12/14 [00:01<00:00,  9.58it/s] 93%|█████████▎| 13/14 [00:01<00:00,  9.41it/s]100%|██████████| 14/14 [00:03<00:00,  1.40it/s]100%|██████████| 14/14 [00:03<00:00,  3.82it/s]
2025-03-09 07:51:26,854 [INFO]: 	Computing best hyperparameters for index knn.index 03/09/2025, 07:51:26
2025-03-09 07:51:57,519 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 30.6643 secs
2025-03-09 07:51:57,519 [INFO]: The best hyperparameters are: efSearch=238
2025-03-09 07:51:57,519 [INFO]: 	Compute fast metrics 03/09/2025, 07:51:57
  0%|          | 0/4 [00:00<?, ?it/s] 25%|██▌       | 1/4 [00:00<00:00,  6.98it/s] 75%|███████▌  | 3/4 [00:00<00:00, 10.07it/s] 75%|███████▌  | 3/4 [00:00<00:00,  7.56it/s]
2025-03-09 07:52:10,871 [INFO]: 	>>> Finished "Compute fast metrics" in 13.3517 secs
2025-03-09 07:52:10,873 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 47.6968 secs
2025-03-09 07:52:10,874 [INFO]: {
2025-03-09 07:52:10,874 [INFO]: 	index_key: HNSW15
2025-03-09 07:52:10,874 [INFO]: 	index_param: efSearch=238
2025-03-09 07:52:10,874 [INFO]: 	index_path: knn.index
2025-03-09 07:52:10,874 [INFO]: 	size in bytes: 696079690
2025-03-09 07:52:10,874 [INFO]: 	avg_search_speed_ms: 10.059570122919752
2025-03-09 07:52:10,874 [INFO]: 	99p_search_speed_ms: 19.147929479368024
2025-03-09 07:52:10,874 [INFO]: 	reconstruction error %: 0.0
2025-03-09 07:52:10,874 [INFO]: 	nb vectors: 3538
2025-03-09 07:52:10,874 [INFO]: 	vectors dimension: 49152
2025-03-09 07:52:10,874 [INFO]: 	compression ratio: 0.999309581924449
2025-03-09 07:52:10,874 [INFO]: }
2025-03-09 07:52:10,874 [INFO]: 	>>> Finished "Creating the index" in 47.7007 secs
2025-03-09 07:52:10,874 [INFO]: >>> Finished "Launching the whole pipeline" in 47.7352 secs
2025-03-09 07:52:12: [retrieval_preprocessing] calculating distances ...
2025-03-09 07:52:12: [retrieval_preprocessing] finished and saved retrieval indices for episode 32779 [episode count 2/20]
[retrieval_preprocessing] for episode 92689 [episode count 3/20], we have num_retrieval=np.int64(3589) num_query=np.int64(126)
2025-03-09 07:52:13,995 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-09 07:52:14,466 [INFO]: Launching the whole pipeline 03/09/2025, 07:52:14
2025-03-09 07:52:14,466 [INFO]: Reading total number of vectors and dimension 03/09/2025, 07:52:14
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1790.91it/s]
2025-03-09 07:52:14,491 [INFO]: There are 3589 embeddings of dim 49152
2025-03-09 07:52:14,491 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0250 secs
2025-03-09 07:52:14,492 [INFO]: 	Compute estimated construction time of the index 03/09/2025, 07:52:14
2025-03-09 07:52:14,492 [INFO]: 		-> Train: 16.7 minutes
2025-03-09 07:52:14,492 [INFO]: 		-> Add: 2.0 seconds
2025-03-09 07:52:14,492 [INFO]: 		Total: 16.7 minutes
2025-03-09 07:52:14,492 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0001 secs
2025-03-09 07:52:14,492 [INFO]: 	Checking that your have enough memory available to create the index 03/09/2025, 07:52:14
2025-03-09 07:52:14,492 [INFO]: 740.7MB of memory will be needed to build the index (more might be used if you have more)
2025-03-09 07:52:14,492 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0002 secs
2025-03-09 07:52:14,492 [INFO]: 	Selecting most promising index types given data characteristics 03/09/2025, 07:52:14
2025-03-09 07:52:14,492 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-09 07:52:14,492 [INFO]: 	Creating the index 03/09/2025, 07:52:14
2025-03-09 07:52:14,492 [INFO]: 		-> Instanciate the index HNSW15 03/09/2025, 07:52:14
2025-03-09 07:52:14,493 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0011 secs
2025-03-09 07:52:14,493 [INFO]: 		-> Adding the vectors to the index 03/09/2025, 07:52:14
2025-03-09 07:52:14,493 [INFO]: The memory available for adding the vectors is 49.3GB(total available - used by the index)
2025-03-09 07:52:14,493 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/15 [00:00<?, ?it/s]  7%|▋         | 1/15 [00:00<00:02,  6.79it/s] 20%|██        | 3/15 [00:00<00:00, 12.61it/s] 33%|███▎      | 5/15 [00:00<00:00, 14.35it/s] 47%|████▋     | 7/15 [00:00<00:00, 14.53it/s] 60%|██████    | 9/15 [00:00<00:00, 13.79it/s] 73%|███████▎  | 11/15 [00:00<00:00, 12.85it/s] 87%|████████▋ | 13/15 [00:00<00:00, 14.52it/s]100%|██████████| 15/15 [00:03<00:00,  1.90it/s]100%|██████████| 15/15 [00:03<00:00,  3.81it/s]
2025-03-09 07:52:18,429 [INFO]: 	Computing best hyperparameters for index knn.index 03/09/2025, 07:52:18
2025-03-09 07:52:53,437 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 35.0075 secs
2025-03-09 07:52:53,438 [INFO]: The best hyperparameters are: efSearch=223
2025-03-09 07:52:53,438 [INFO]: 	Compute fast metrics 03/09/2025, 07:52:53
  0%|          | 0/4 [00:00<?, ?it/s] 25%|██▌       | 1/4 [00:00<00:00,  5.37it/s] 75%|███████▌  | 3/4 [00:00<00:00,  8.73it/s] 75%|███████▌  | 3/4 [00:00<00:00,  6.78it/s]
2025-03-09 07:53:08,041 [INFO]: 	>>> Finished "Compute fast metrics" in 14.6035 secs
2025-03-09 07:53:08,044 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 53.5507 secs
2025-03-09 07:53:08,044 [INFO]: {
2025-03-09 07:53:08,044 [INFO]: 	index_key: HNSW15
2025-03-09 07:53:08,044 [INFO]: 	index_param: efSearch=223
2025-03-09 07:53:08,044 [INFO]: 	index_path: knn.index
2025-03-09 07:53:08,044 [INFO]: 	size in bytes: 706113610
2025-03-09 07:53:08,044 [INFO]: 	avg_search_speed_ms: 8.957481977494774
2025-03-09 07:53:08,044 [INFO]: 	99p_search_speed_ms: 14.922228397335846
2025-03-09 07:53:08,044 [INFO]: 	reconstruction error %: 0.0
2025-03-09 07:53:08,044 [INFO]: 	nb vectors: 3589
2025-03-09 07:53:08,044 [INFO]: 	vectors dimension: 49152
2025-03-09 07:53:08,044 [INFO]: 	compression ratio: 0.999309604016838
2025-03-09 07:53:08,044 [INFO]: }
2025-03-09 07:53:08,044 [INFO]: 	>>> Finished "Creating the index" in 53.5523 secs
2025-03-09 07:53:08,044 [INFO]: >>> Finished "Launching the whole pipeline" in 53.5780 secs
2025-03-09 07:53:08: [retrieval_preprocessing] calculating distances ...
2025-03-09 07:53:09: [retrieval_preprocessing] finished and saved retrieval indices for episode 92689 [episode count 3/20]
[retrieval_preprocessing] for episode 36373 [episode count 4/20], we have num_retrieval=np.int64(3568) num_query=np.int64(147)
2025-03-09 07:53:10,019 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-09 07:53:10,843 [INFO]: Launching the whole pipeline 03/09/2025, 07:53:10
2025-03-09 07:53:10,843 [INFO]: Reading total number of vectors and dimension 03/09/2025, 07:53:10
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1464.49it/s]
2025-03-09 07:53:10,867 [INFO]: There are 3568 embeddings of dim 49152
2025-03-09 07:53:10,868 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0243 secs
2025-03-09 07:53:10,868 [INFO]: 	Compute estimated construction time of the index 03/09/2025, 07:53:10
2025-03-09 07:53:10,868 [INFO]: 		-> Train: 16.7 minutes
2025-03-09 07:53:10,868 [INFO]: 		-> Add: 2.0 seconds
2025-03-09 07:53:10,868 [INFO]: 		Total: 16.7 minutes
2025-03-09 07:53:10,868 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0002 secs
2025-03-09 07:53:10,868 [INFO]: 	Checking that your have enough memory available to create the index 03/09/2025, 07:53:10
2025-03-09 07:53:10,868 [INFO]: 736.3MB of memory will be needed to build the index (more might be used if you have more)
2025-03-09 07:53:10,868 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0001 secs
2025-03-09 07:53:10,868 [INFO]: 	Selecting most promising index types given data characteristics 03/09/2025, 07:53:10
2025-03-09 07:53:10,868 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-09 07:53:10,868 [INFO]: 	Creating the index 03/09/2025, 07:53:10
2025-03-09 07:53:10,868 [INFO]: 		-> Instanciate the index HNSW15 03/09/2025, 07:53:10
2025-03-09 07:53:10,869 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0010 secs
2025-03-09 07:53:10,869 [INFO]: 		-> Adding the vectors to the index 03/09/2025, 07:53:10
2025-03-09 07:53:10,869 [INFO]: The memory available for adding the vectors is 49.3GB(total available - used by the index)
2025-03-09 07:53:10,869 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/15 [00:00<?, ?it/s]  7%|▋         | 1/15 [00:00<00:02,  6.53it/s] 13%|█▎        | 2/15 [00:00<00:01,  7.74it/s] 20%|██        | 3/15 [00:00<00:01,  8.09it/s] 27%|██▋       | 4/15 [00:00<00:01,  8.25it/s] 33%|███▎      | 5/15 [00:00<00:01,  8.35it/s] 47%|████▋     | 7/15 [00:00<00:00,  9.38it/s] 53%|█████▎    | 8/15 [00:00<00:00,  9.11it/s] 60%|██████    | 9/15 [00:01<00:00,  8.94it/s] 67%|██████▋   | 10/15 [00:01<00:00,  8.89it/s] 73%|███████▎  | 11/15 [00:01<00:00,  8.76it/s] 80%|████████  | 12/15 [00:01<00:00,  8.75it/s] 87%|████████▋ | 13/15 [00:01<00:00,  8.69it/s] 93%|█████████▎| 14/15 [00:01<00:00,  8.81it/s]100%|██████████| 15/15 [00:03<00:00,  1.34it/s]100%|██████████| 15/15 [00:03<00:00,  3.88it/s]
2025-03-09 07:53:14,740 [INFO]: 	Computing best hyperparameters for index knn.index 03/09/2025, 07:53:14
2025-03-09 07:53:45,441 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 30.7015 secs
2025-03-09 07:53:45,442 [INFO]: The best hyperparameters are: efSearch=201
2025-03-09 07:53:45,442 [INFO]: 	Compute fast metrics 03/09/2025, 07:53:45
  0%|          | 0/4 [00:00<?, ?it/s] 25%|██▌       | 1/4 [00:00<00:00,  5.03it/s] 50%|█████     | 2/4 [00:00<00:00,  6.86it/s] 75%|███████▌  | 3/4 [00:00<00:00,  6.14it/s]
2025-03-09 07:54:01,194 [INFO]: 	>>> Finished "Compute fast metrics" in 15.7524 secs
2025-03-09 07:54:01,197 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 50.3279 secs
2025-03-09 07:54:01,197 [INFO]: {
2025-03-09 07:54:01,197 [INFO]: 	index_key: HNSW15
2025-03-09 07:54:01,197 [INFO]: 	index_param: efSearch=201
2025-03-09 07:54:01,197 [INFO]: 	index_path: knn.index
2025-03-09 07:54:01,197 [INFO]: 	size in bytes: 701982010
2025-03-09 07:54:01,198 [INFO]: 	avg_search_speed_ms: 9.618520551773075
2025-03-09 07:54:01,198 [INFO]: 	99p_search_speed_ms: 15.932239310350257
2025-03-09 07:54:01,198 [INFO]: 	reconstruction error %: 0.0
2025-03-09 07:54:01,198 [INFO]: 	nb vectors: 3568
2025-03-09 07:54:01,198 [INFO]: 	vectors dimension: 49152
2025-03-09 07:54:01,198 [INFO]: 	compression ratio: 0.99930957489922
2025-03-09 07:54:01,198 [INFO]: }
2025-03-09 07:54:01,198 [INFO]: 	>>> Finished "Creating the index" in 50.3295 secs
2025-03-09 07:54:01,198 [INFO]: >>> Finished "Launching the whole pipeline" in 50.3545 secs
2025-03-09 07:54:01: [retrieval_preprocessing] calculating distances ...
2025-03-09 07:54:02: [retrieval_preprocessing] finished and saved retrieval indices for episode 36373 [episode count 4/20]
[retrieval_preprocessing] for episode 55834 [episode count 5/20], we have num_retrieval=np.int64(3528) num_query=np.int64(187)
2025-03-09 07:54:03,751 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-09 07:54:04,237 [INFO]: Launching the whole pipeline 03/09/2025, 07:54:04
2025-03-09 07:54:04,237 [INFO]: Reading total number of vectors and dimension 03/09/2025, 07:54:04
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 949.80it/s]
2025-03-09 07:54:04,378 [INFO]: There are 3528 embeddings of dim 49152
2025-03-09 07:54:04,378 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.1405 secs
2025-03-09 07:54:04,378 [INFO]: 	Compute estimated construction time of the index 03/09/2025, 07:54:04
2025-03-09 07:54:04,378 [INFO]: 		-> Train: 16.7 minutes
2025-03-09 07:54:04,378 [INFO]: 		-> Add: 1.9 seconds
2025-03-09 07:54:04,378 [INFO]: 		Total: 16.7 minutes
2025-03-09 07:54:04,378 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0002 secs
2025-03-09 07:54:04,378 [INFO]: 	Checking that your have enough memory available to create the index 03/09/2025, 07:54:04
2025-03-09 07:54:04,378 [INFO]: 728.1MB of memory will be needed to build the index (more might be used if you have more)
2025-03-09 07:54:04,379 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0002 secs
2025-03-09 07:54:04,379 [INFO]: 	Selecting most promising index types given data characteristics 03/09/2025, 07:54:04
2025-03-09 07:54:04,379 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-09 07:54:04,379 [INFO]: 	Creating the index 03/09/2025, 07:54:04
2025-03-09 07:54:04,379 [INFO]: 		-> Instanciate the index HNSW15 03/09/2025, 07:54:04
2025-03-09 07:54:04,381 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0021 secs
2025-03-09 07:54:04,381 [INFO]: 		-> Adding the vectors to the index 03/09/2025, 07:54:04
2025-03-09 07:54:04,381 [INFO]: The memory available for adding the vectors is 49.4GB(total available - used by the index)
2025-03-09 07:54:04,382 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/14 [00:00<?, ?it/s]  7%|▋         | 1/14 [00:00<00:02,  6.35it/s] 21%|██▏       | 3/14 [00:00<00:01, 10.22it/s] 36%|███▌      | 5/14 [00:00<00:00, 12.45it/s] 50%|█████     | 7/14 [00:00<00:00, 14.22it/s] 64%|██████▍   | 9/14 [00:00<00:00, 15.48it/s] 79%|███████▊  | 11/14 [00:00<00:00, 15.95it/s] 93%|█████████▎| 13/14 [00:00<00:00, 14.12it/s]100%|██████████| 14/14 [00:03<00:00,  4.15it/s]
2025-03-09 07:54:07,762 [INFO]: 	Computing best hyperparameters for index knn.index 03/09/2025, 07:54:07
2025-03-09 07:54:40,949 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 33.1862 secs
2025-03-09 07:54:40,949 [INFO]: The best hyperparameters are: efSearch=199
2025-03-09 07:54:40,949 [INFO]: 	Compute fast metrics 03/09/2025, 07:54:40
  0%|          | 0/4 [00:00<?, ?it/s] 25%|██▌       | 1/4 [00:00<00:00,  4.95it/s] 75%|███████▌  | 3/4 [00:00<00:00, 10.58it/s] 75%|███████▌  | 3/4 [00:00<00:00,  7.53it/s]
2025-03-09 07:54:54,097 [INFO]: 	>>> Finished "Compute fast metrics" in 13.1472 secs
2025-03-09 07:54:54,099 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 49.7179 secs
2025-03-09 07:54:54,099 [INFO]: {
2025-03-09 07:54:54,100 [INFO]: 	index_key: HNSW15
2025-03-09 07:54:54,100 [INFO]: 	index_param: efSearch=199
2025-03-09 07:54:54,100 [INFO]: 	index_path: knn.index
2025-03-09 07:54:54,100 [INFO]: 	size in bytes: 694112290
2025-03-09 07:54:54,100 [INFO]: 	avg_search_speed_ms: 9.887100678220715
2025-03-09 07:54:54,100 [INFO]: 	99p_search_speed_ms: 21.67060573818162
2025-03-09 07:54:54,100 [INFO]: 	reconstruction error %: 0.0
2025-03-09 07:54:54,100 [INFO]: 	nb vectors: 3528
2025-03-09 07:54:54,100 [INFO]: 	vectors dimension: 49152
2025-03-09 07:54:54,100 [INFO]: 	compression ratio: 0.9993095267049659
2025-03-09 07:54:54,100 [INFO]: }
2025-03-09 07:54:54,100 [INFO]: 	>>> Finished "Creating the index" in 49.7207 secs
2025-03-09 07:54:54,100 [INFO]: >>> Finished "Launching the whole pipeline" in 49.8624 secs
2025-03-09 07:54:55: [retrieval_preprocessing] calculating distances ...
2025-03-09 07:54:55: [retrieval_preprocessing] finished and saved retrieval indices for episode 55834 [episode count 5/20]
[retrieval_preprocessing] for episode 46108 [episode count 6/20], we have num_retrieval=np.int64(3480) num_query=np.int64(235)
2025-03-09 07:54:57,283 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-09 07:54:57,752 [INFO]: Launching the whole pipeline 03/09/2025, 07:54:57
2025-03-09 07:54:57,752 [INFO]: Reading total number of vectors and dimension 03/09/2025, 07:54:57
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1464.49it/s]
2025-03-09 07:54:57,779 [INFO]: There are 3480 embeddings of dim 49152
2025-03-09 07:54:57,780 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0270 secs
2025-03-09 07:54:57,780 [INFO]: 	Compute estimated construction time of the index 03/09/2025, 07:54:57
2025-03-09 07:54:57,780 [INFO]: 		-> Train: 16.7 minutes
2025-03-09 07:54:57,780 [INFO]: 		-> Add: 1.9 seconds
2025-03-09 07:54:57,780 [INFO]: 		Total: 16.7 minutes
2025-03-09 07:54:57,780 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0001 secs
2025-03-09 07:54:57,780 [INFO]: 	Checking that your have enough memory available to create the index 03/09/2025, 07:54:57
2025-03-09 07:54:57,780 [INFO]: 718.2MB of memory will be needed to build the index (more might be used if you have more)
2025-03-09 07:54:57,780 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0001 secs
2025-03-09 07:54:57,780 [INFO]: 	Selecting most promising index types given data characteristics 03/09/2025, 07:54:57
2025-03-09 07:54:57,780 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-09 07:54:57,780 [INFO]: 	Creating the index 03/09/2025, 07:54:57
2025-03-09 07:54:57,780 [INFO]: 		-> Instanciate the index HNSW15 03/09/2025, 07:54:57
2025-03-09 07:54:57,781 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0011 secs
2025-03-09 07:54:57,781 [INFO]: 		-> Adding the vectors to the index 03/09/2025, 07:54:57
2025-03-09 07:54:57,781 [INFO]: The memory available for adding the vectors is 49.4GB(total available - used by the index)
2025-03-09 07:54:57,781 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/14 [00:00<?, ?it/s]  7%|▋         | 1/14 [00:00<00:01,  7.13it/s] 21%|██▏       | 3/14 [00:00<00:00, 11.95it/s] 36%|███▌      | 5/14 [00:00<00:00, 13.82it/s] 50%|█████     | 7/14 [00:00<00:00, 13.87it/s] 64%|██████▍   | 9/14 [00:00<00:00, 13.86it/s] 79%|███████▊  | 11/14 [00:00<00:00, 14.86it/s] 93%|█████████▎| 13/14 [00:00<00:00, 14.00it/s]100%|██████████| 14/14 [00:03<00:00,  4.14it/s]
2025-03-09 07:55:01,171 [INFO]: 	Computing best hyperparameters for index knn.index 03/09/2025, 07:55:01
2025-03-09 07:55:35,106 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 33.9352 secs
2025-03-09 07:55:35,107 [INFO]: The best hyperparameters are: efSearch=170
2025-03-09 07:55:35,107 [INFO]: 	Compute fast metrics 03/09/2025, 07:55:35
  0%|          | 0/4 [00:00<?, ?it/s] 25%|██▌       | 1/4 [00:00<00:00,  5.02it/s] 50%|█████     | 2/4 [00:00<00:00,  6.41it/s] 75%|███████▌  | 3/4 [00:00<00:00,  7.01it/s] 75%|███████▌  | 3/4 [00:00<00:00,  5.31it/s]
2025-03-09 07:55:51,188 [INFO]: 	>>> Finished "Compute fast metrics" in 16.0807 secs
2025-03-09 07:55:51,191 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 53.4093 secs
2025-03-09 07:55:51,191 [INFO]: {
2025-03-09 07:55:51,191 [INFO]: 	index_key: HNSW15
2025-03-09 07:55:51,191 [INFO]: 	index_param: efSearch=170
2025-03-09 07:55:51,191 [INFO]: 	index_path: knn.index
2025-03-09 07:55:51,191 [INFO]: 	size in bytes: 684668650
2025-03-09 07:55:51,191 [INFO]: 	avg_search_speed_ms: 7.1186969326842195
2025-03-09 07:55:51,191 [INFO]: 	99p_search_speed_ms: 11.449480345472708
2025-03-09 07:55:51,191 [INFO]: 	reconstruction error %: 0.0
2025-03-09 07:55:51,191 [INFO]: 	nb vectors: 3480
2025-03-09 07:55:51,191 [INFO]: 	vectors dimension: 49152
2025-03-09 07:55:51,191 [INFO]: 	compression ratio: 0.999309432380174
2025-03-09 07:55:51,191 [INFO]: }
2025-03-09 07:55:51,191 [INFO]: 	>>> Finished "Creating the index" in 53.4109 secs
2025-03-09 07:55:51,191 [INFO]: >>> Finished "Launching the whole pipeline" in 53.4385 secs
2025-03-09 07:55:51: [retrieval_preprocessing] calculating distances ...
2025-03-09 07:55:52: [retrieval_preprocessing] finished and saved retrieval indices for episode 46108 [episode count 6/20]
[retrieval_preprocessing] for episode 31775 [episode count 7/20], we have num_retrieval=np.int64(3527) num_query=np.int64(188)
2025-03-09 07:55:53,570 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-09 07:55:54,061 [INFO]: Launching the whole pipeline 03/09/2025, 07:55:54
2025-03-09 07:55:54,061 [INFO]: Reading total number of vectors and dimension 03/09/2025, 07:55:54
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1147.55it/s]
2025-03-09 07:55:54,088 [INFO]: There are 3527 embeddings of dim 49152
2025-03-09 07:55:54,088 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0267 secs
2025-03-09 07:55:54,088 [INFO]: 	Compute estimated construction time of the index 03/09/2025, 07:55:54
2025-03-09 07:55:54,088 [INFO]: 		-> Train: 16.7 minutes
2025-03-09 07:55:54,088 [INFO]: 		-> Add: 1.9 seconds
2025-03-09 07:55:54,088 [INFO]: 		Total: 16.7 minutes
2025-03-09 07:55:54,088 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0001 secs
2025-03-09 07:55:54,088 [INFO]: 	Checking that your have enough memory available to create the index 03/09/2025, 07:55:54
2025-03-09 07:55:54,088 [INFO]: 727.9MB of memory will be needed to build the index (more might be used if you have more)
2025-03-09 07:55:54,088 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0001 secs
2025-03-09 07:55:54,088 [INFO]: 	Selecting most promising index types given data characteristics 03/09/2025, 07:55:54
2025-03-09 07:55:54,088 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-09 07:55:54,088 [INFO]: 	Creating the index 03/09/2025, 07:55:54
2025-03-09 07:55:54,088 [INFO]: 		-> Instanciate the index HNSW15 03/09/2025, 07:55:54
2025-03-09 07:55:54,089 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0009 secs
2025-03-09 07:55:54,089 [INFO]: 		-> Adding the vectors to the index 03/09/2025, 07:55:54
2025-03-09 07:55:54,090 [INFO]: The memory available for adding the vectors is 49.4GB(total available - used by the index)
2025-03-09 07:55:54,090 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/14 [00:00<?, ?it/s]  7%|▋         | 1/14 [00:00<00:02,  5.42it/s] 21%|██▏       | 3/14 [00:00<00:01,  8.44it/s] 36%|███▌      | 5/14 [00:00<00:00,  9.46it/s] 50%|█████     | 7/14 [00:00<00:00,  9.89it/s] 64%|██████▍   | 9/14 [00:00<00:00, 10.20it/s] 79%|███████▊  | 11/14 [00:01<00:00, 10.47it/s] 93%|█████████▎| 13/14 [00:01<00:00, 10.63it/s]100%|██████████| 14/14 [00:03<00:00,  3.98it/s]
2025-03-09 07:55:57,620 [INFO]: 	Computing best hyperparameters for index knn.index 03/09/2025, 07:55:57
2025-03-09 07:56:28,284 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 30.6635 secs
2025-03-09 07:56:28,285 [INFO]: The best hyperparameters are: efSearch=124
2025-03-09 07:56:28,285 [INFO]: 	Compute fast metrics 03/09/2025, 07:56:28
  0%|          | 0/4 [00:00<?, ?it/s] 25%|██▌       | 1/4 [00:00<00:00,  9.72it/s] 75%|███████▌  | 3/4 [00:00<00:00, 18.18it/s]
2025-03-09 07:56:45,683 [INFO]: 	>>> Finished "Compute fast metrics" in 17.3986 secs
2025-03-09 07:56:45,687 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 51.5970 secs
2025-03-09 07:56:45,687 [INFO]: {
2025-03-09 07:56:45,687 [INFO]: 	index_key: HNSW15
2025-03-09 07:56:45,687 [INFO]: 	index_param: efSearch=124
2025-03-09 07:56:45,687 [INFO]: 	index_path: knn.index
2025-03-09 07:56:45,687 [INFO]: 	size in bytes: 693915550
2025-03-09 07:56:45,687 [INFO]: 	avg_search_speed_ms: 6.183997561046986
2025-03-09 07:56:45,687 [INFO]: 	99p_search_speed_ms: 12.06962401047348
2025-03-09 07:56:45,687 [INFO]: 	reconstruction error %: 0.0
2025-03-09 07:56:45,687 [INFO]: 	nb vectors: 3527
2025-03-09 07:56:45,687 [INFO]: 	vectors dimension: 49152
2025-03-09 07:56:45,687 [INFO]: 	compression ratio: 0.9993095211657961
2025-03-09 07:56:45,687 [INFO]: }
2025-03-09 07:56:45,687 [INFO]: 	>>> Finished "Creating the index" in 51.5984 secs
2025-03-09 07:56:45,687 [INFO]: >>> Finished "Launching the whole pipeline" in 51.6257 secs
2025-03-09 07:56:46: [retrieval_preprocessing] calculating distances ...
2025-03-09 07:56:46: [retrieval_preprocessing] finished and saved retrieval indices for episode 31775 [episode count 7/20]
[retrieval_preprocessing] for episode 15400 [episode count 8/20], we have num_retrieval=np.int64(3540) num_query=np.int64(175)
2025-03-09 07:56:47,585 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-09 07:56:48,121 [INFO]: Launching the whole pipeline 03/09/2025, 07:56:48
2025-03-09 07:56:48,122 [INFO]: Reading total number of vectors and dimension 03/09/2025, 07:56:48
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1131.15it/s]
2025-03-09 07:56:48,150 [INFO]: There are 3540 embeddings of dim 49152
2025-03-09 07:56:48,150 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0285 secs
2025-03-09 07:56:48,150 [INFO]: 	Compute estimated construction time of the index 03/09/2025, 07:56:48
2025-03-09 07:56:48,150 [INFO]: 		-> Train: 16.7 minutes
2025-03-09 07:56:48,150 [INFO]: 		-> Add: 1.9 seconds
2025-03-09 07:56:48,150 [INFO]: 		Total: 16.7 minutes
2025-03-09 07:56:48,150 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0001 secs
2025-03-09 07:56:48,150 [INFO]: 	Checking that your have enough memory available to create the index 03/09/2025, 07:56:48
2025-03-09 07:56:48,150 [INFO]: 730.6MB of memory will be needed to build the index (more might be used if you have more)
2025-03-09 07:56:48,151 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0002 secs
2025-03-09 07:56:48,151 [INFO]: 	Selecting most promising index types given data characteristics 03/09/2025, 07:56:48
2025-03-09 07:56:48,151 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-09 07:56:48,151 [INFO]: 	Creating the index 03/09/2025, 07:56:48
2025-03-09 07:56:48,151 [INFO]: 		-> Instanciate the index HNSW15 03/09/2025, 07:56:48
2025-03-09 07:56:48,152 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0011 secs
2025-03-09 07:56:48,152 [INFO]: 		-> Adding the vectors to the index 03/09/2025, 07:56:48
2025-03-09 07:56:48,152 [INFO]: The memory available for adding the vectors is 49.4GB(total available - used by the index)
2025-03-09 07:56:48,152 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/14 [00:00<?, ?it/s]  7%|▋         | 1/14 [00:00<00:02,  5.57it/s] 14%|█▍        | 2/14 [00:00<00:01,  7.53it/s] 21%|██▏       | 3/14 [00:00<00:01,  8.47it/s] 36%|███▌      | 5/14 [00:00<00:00,  9.30it/s] 50%|█████     | 7/14 [00:00<00:00,  9.71it/s] 64%|██████▍   | 9/14 [00:00<00:00,  9.81it/s] 71%|███████▏  | 10/14 [00:01<00:00,  9.52it/s] 79%|███████▊  | 11/14 [00:01<00:00,  9.36it/s] 86%|████████▌ | 12/14 [00:01<00:00,  8.95it/s] 93%|█████████▎| 13/14 [00:01<00:00,  6.72it/s]100%|██████████| 14/14 [00:04<00:00,  1.19it/s]100%|██████████| 14/14 [00:04<00:00,  3.29it/s]
2025-03-09 07:56:52,420 [INFO]: 	Computing best hyperparameters for index knn.index 03/09/2025, 07:56:52
2025-03-09 07:57:23,188 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 30.7673 secs
2025-03-09 07:57:23,188 [INFO]: The best hyperparameters are: efSearch=250
2025-03-09 07:57:23,188 [INFO]: 	Compute fast metrics 03/09/2025, 07:57:23
  0%|          | 0/4 [00:00<?, ?it/s] 25%|██▌       | 1/4 [00:00<00:00,  5.78it/s] 75%|███████▌  | 3/4 [00:00<00:00,  9.09it/s] 75%|███████▌  | 3/4 [00:00<00:00,  6.93it/s]
2025-03-09 07:57:37,755 [INFO]: 	>>> Finished "Compute fast metrics" in 14.5662 secs
2025-03-09 07:57:37,758 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 49.6061 secs
2025-03-09 07:57:37,758 [INFO]: {
2025-03-09 07:57:37,758 [INFO]: 	index_key: HNSW15
2025-03-09 07:57:37,758 [INFO]: 	index_param: efSearch=250
2025-03-09 07:57:37,758 [INFO]: 	index_path: knn.index
2025-03-09 07:57:37,758 [INFO]: 	size in bytes: 696473170
2025-03-09 07:57:37,758 [INFO]: 	avg_search_speed_ms: 11.531228117962748
2025-03-09 07:57:37,759 [INFO]: 	99p_search_speed_ms: 18.549850801937282
2025-03-09 07:57:37,759 [INFO]: 	reconstruction error %: 0.0
2025-03-09 07:57:37,759 [INFO]: 	nb vectors: 3540
2025-03-09 07:57:37,759 [INFO]: 	vectors dimension: 49152
2025-03-09 07:57:37,759 [INFO]: 	compression ratio: 0.9993095929309093
2025-03-09 07:57:37,759 [INFO]: }
2025-03-09 07:57:37,759 [INFO]: 	>>> Finished "Creating the index" in 49.6079 secs
2025-03-09 07:57:37,759 [INFO]: >>> Finished "Launching the whole pipeline" in 49.6371 secs
2025-03-09 07:57:39: [retrieval_preprocessing] calculating distances ...
2025-03-09 07:57:39: [retrieval_preprocessing] finished and saved retrieval indices for episode 15400 [episode count 8/20]
[retrieval_preprocessing] for episode 78391 [episode count 9/20], we have num_retrieval=np.int64(3514) num_query=np.int64(201)
2025-03-09 07:57:41,011 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-09 07:57:41,470 [INFO]: Launching the whole pipeline 03/09/2025, 07:57:41
2025-03-09 07:57:41,470 [INFO]: Reading total number of vectors and dimension 03/09/2025, 07:57:41
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1184.50it/s]
2025-03-09 07:57:41,498 [INFO]: There are 3514 embeddings of dim 49152
2025-03-09 07:57:41,498 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0274 secs
2025-03-09 07:57:41,498 [INFO]: 	Compute estimated construction time of the index 03/09/2025, 07:57:41
2025-03-09 07:57:41,498 [INFO]: 		-> Train: 16.7 minutes
2025-03-09 07:57:41,498 [INFO]: 		-> Add: 1.9 seconds
2025-03-09 07:57:41,498 [INFO]: 		Total: 16.7 minutes
2025-03-09 07:57:41,498 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0001 secs
2025-03-09 07:57:41,498 [INFO]: 	Checking that your have enough memory available to create the index 03/09/2025, 07:57:41
2025-03-09 07:57:41,498 [INFO]: 725.2MB of memory will be needed to build the index (more might be used if you have more)
2025-03-09 07:57:41,498 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0001 secs
2025-03-09 07:57:41,498 [INFO]: 	Selecting most promising index types given data characteristics 03/09/2025, 07:57:41
2025-03-09 07:57:41,498 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-09 07:57:41,498 [INFO]: 	Creating the index 03/09/2025, 07:57:41
2025-03-09 07:57:41,498 [INFO]: 		-> Instanciate the index HNSW15 03/09/2025, 07:57:41
2025-03-09 07:57:41,500 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0011 secs
2025-03-09 07:57:41,500 [INFO]: 		-> Adding the vectors to the index 03/09/2025, 07:57:41
2025-03-09 07:57:41,500 [INFO]: The memory available for adding the vectors is 49.4GB(total available - used by the index)
2025-03-09 07:57:41,500 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/14 [00:00<?, ?it/s]  7%|▋         | 1/14 [00:00<00:02,  5.44it/s] 14%|█▍        | 2/14 [00:00<00:01,  7.38it/s] 21%|██▏       | 3/14 [00:00<00:01,  8.28it/s] 29%|██▊       | 4/14 [00:00<00:01,  8.80it/s] 43%|████▎     | 6/14 [00:00<00:00,  9.14it/s] 50%|█████     | 7/14 [00:00<00:00,  9.21it/s] 57%|█████▋    | 8/14 [00:00<00:00,  9.16it/s] 71%|███████▏  | 10/14 [00:01<00:00, 10.58it/s] 86%|████████▌ | 12/14 [00:01<00:00, 10.28it/s]100%|██████████| 14/14 [00:04<00:00,  1.75it/s]100%|██████████| 14/14 [00:04<00:00,  3.40it/s]
2025-03-09 07:57:45,630 [INFO]: 	Computing best hyperparameters for index knn.index 03/09/2025, 07:57:45
2025-03-09 07:58:17,910 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 32.2794 secs
2025-03-09 07:58:17,910 [INFO]: The best hyperparameters are: efSearch=216
2025-03-09 07:58:17,910 [INFO]: 	Compute fast metrics 03/09/2025, 07:58:17
  0%|          | 0/4 [00:00<?, ?it/s] 25%|██▌       | 1/4 [00:00<00:00,  4.16it/s] 50%|█████     | 2/4 [00:00<00:00,  5.38it/s] 75%|███████▌  | 3/4 [00:00<00:00,  6.72it/s] 75%|███████▌  | 3/4 [00:00<00:00,  5.06it/s]
2025-03-09 07:58:33,975 [INFO]: 	>>> Finished "Compute fast metrics" in 16.0645 secs
2025-03-09 07:58:33,978 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 52.4784 secs
2025-03-09 07:58:33,978 [INFO]: {
2025-03-09 07:58:33,978 [INFO]: 	index_key: HNSW15
2025-03-09 07:58:33,978 [INFO]: 	index_param: efSearch=216
2025-03-09 07:58:33,978 [INFO]: 	index_path: knn.index
2025-03-09 07:58:33,978 [INFO]: 	size in bytes: 691357870
2025-03-09 07:58:33,978 [INFO]: 	avg_search_speed_ms: 8.555400900708445
2025-03-09 07:58:33,979 [INFO]: 	99p_search_speed_ms: 11.058195130899549
2025-03-09 07:58:33,979 [INFO]: 	reconstruction error %: 0.0
2025-03-09 07:58:33,979 [INFO]: 	nb vectors: 3514
2025-03-09 07:58:33,979 [INFO]: 	vectors dimension: 49152
2025-03-09 07:58:33,979 [INFO]: 	compression ratio: 0.9993095355955086
2025-03-09 07:58:33,979 [INFO]: }
2025-03-09 07:58:33,979 [INFO]: 	>>> Finished "Creating the index" in 52.4801 secs
2025-03-09 07:58:33,979 [INFO]: >>> Finished "Launching the whole pipeline" in 52.5082 secs
2025-03-09 07:58:34: [retrieval_preprocessing] calculating distances ...
2025-03-09 07:58:35: [retrieval_preprocessing] finished and saved retrieval indices for episode 78391 [episode count 9/20]
[retrieval_preprocessing] for episode 82490 [episode count 10/20], we have num_retrieval=np.int64(3601) num_query=np.int64(114)
2025-03-09 07:58:36,446 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-09 07:58:36,917 [INFO]: Launching the whole pipeline 03/09/2025, 07:58:36
2025-03-09 07:58:36,917 [INFO]: Reading total number of vectors and dimension 03/09/2025, 07:58:36
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 2099.25it/s]
2025-03-09 07:58:36,941 [INFO]: There are 3601 embeddings of dim 49152
2025-03-09 07:58:36,941 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0234 secs
2025-03-09 07:58:36,941 [INFO]: 	Compute estimated construction time of the index 03/09/2025, 07:58:36
2025-03-09 07:58:36,941 [INFO]: 		-> Train: 16.7 minutes
2025-03-09 07:58:36,941 [INFO]: 		-> Add: 2.0 seconds
2025-03-09 07:58:36,941 [INFO]: 		Total: 16.7 minutes
2025-03-09 07:58:36,941 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0001 secs
2025-03-09 07:58:36,941 [INFO]: 	Checking that your have enough memory available to create the index 03/09/2025, 07:58:36
2025-03-09 07:58:36,941 [INFO]: 743.2MB of memory will be needed to build the index (more might be used if you have more)
2025-03-09 07:58:36,941 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0002 secs
2025-03-09 07:58:36,941 [INFO]: 	Selecting most promising index types given data characteristics 03/09/2025, 07:58:36
2025-03-09 07:58:36,941 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-09 07:58:36,941 [INFO]: 	Creating the index 03/09/2025, 07:58:36
2025-03-09 07:58:36,942 [INFO]: 		-> Instanciate the index HNSW15 03/09/2025, 07:58:36
2025-03-09 07:58:36,942 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0009 secs
2025-03-09 07:58:36,942 [INFO]: 		-> Adding the vectors to the index 03/09/2025, 07:58:36
2025-03-09 07:58:36,943 [INFO]: The memory available for adding the vectors is 49.3GB(total available - used by the index)
2025-03-09 07:58:36,943 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/15 [00:00<?, ?it/s]  7%|▋         | 1/15 [00:00<00:02,  5.54it/s] 13%|█▎        | 2/15 [00:00<00:01,  6.94it/s] 20%|██        | 3/15 [00:00<00:01,  7.67it/s] 27%|██▋       | 4/15 [00:00<00:01,  8.29it/s] 33%|███▎      | 5/15 [00:00<00:01,  8.59it/s] 40%|████      | 6/15 [00:00<00:01,  8.77it/s] 47%|████▋     | 7/15 [00:00<00:00,  8.70it/s] 53%|█████▎    | 8/15 [00:00<00:00,  8.71it/s] 60%|██████    | 9/15 [00:01<00:00,  8.84it/s] 67%|██████▋   | 10/15 [00:01<00:00,  8.80it/s] 73%|███████▎  | 11/15 [00:01<00:00,  8.81it/s] 80%|████████  | 12/15 [00:01<00:00,  8.82it/s] 87%|████████▋ | 13/15 [00:01<00:00,  8.82it/s]100%|██████████| 15/15 [00:04<00:00,  1.57it/s]100%|██████████| 15/15 [00:04<00:00,  3.74it/s]
2025-03-09 07:58:40,957 [INFO]: 	Computing best hyperparameters for index knn.index 03/09/2025, 07:58:40
2025-03-09 07:59:13,531 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 32.5733 secs
2025-03-09 07:59:13,531 [INFO]: The best hyperparameters are: efSearch=188
2025-03-09 07:59:13,531 [INFO]: 	Compute fast metrics 03/09/2025, 07:59:13
  0%|          | 0/4 [00:00<?, ?it/s] 25%|██▌       | 1/4 [00:00<00:00,  5.63it/s] 50%|█████     | 2/4 [00:00<00:00,  7.31it/s] 75%|███████▌  | 3/4 [00:00<00:00,  8.16it/s] 75%|███████▌  | 3/4 [00:00<00:00,  6.13it/s]
2025-03-09 07:59:27,776 [INFO]: 	>>> Finished "Compute fast metrics" in 14.2452 secs
2025-03-09 07:59:27,779 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 50.8361 secs
2025-03-09 07:59:27,779 [INFO]: {
2025-03-09 07:59:27,779 [INFO]: 	index_key: HNSW15
2025-03-09 07:59:27,779 [INFO]: 	index_param: efSearch=188
2025-03-09 07:59:27,779 [INFO]: 	index_path: knn.index
2025-03-09 07:59:27,779 [INFO]: 	size in bytes: 708474490
2025-03-09 07:59:27,779 [INFO]: 	avg_search_speed_ms: 9.007870031495553
2025-03-09 07:59:27,779 [INFO]: 	99p_search_speed_ms: 15.911198740359398
2025-03-09 07:59:27,779 [INFO]: 	reconstruction error %: 0.0
2025-03-09 07:59:27,779 [INFO]: 	nb vectors: 3601
2025-03-09 07:59:27,779 [INFO]: 	vectors dimension: 49152
2025-03-09 07:59:27,779 [INFO]: 	compression ratio: 0.9993096688633065
2025-03-09 07:59:27,779 [INFO]: }
2025-03-09 07:59:27,779 [INFO]: 	>>> Finished "Creating the index" in 50.8380 secs
2025-03-09 07:59:27,780 [INFO]: >>> Finished "Launching the whole pipeline" in 50.8620 secs
2025-03-09 07:59:28: [retrieval_preprocessing] calculating distances ...
2025-03-09 07:59:28: [retrieval_preprocessing] finished and saved retrieval indices for episode 82490 [episode count 10/20]
[retrieval_preprocessing] for episode 17994 [episode count 11/20], we have num_retrieval=np.int64(3578) num_query=np.int64(137)
2025-03-09 07:59:29,670 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-09 07:59:30,166 [INFO]: Launching the whole pipeline 03/09/2025, 07:59:30
2025-03-09 07:59:30,166 [INFO]: Reading total number of vectors and dimension 03/09/2025, 07:59:30
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 2169.84it/s]
2025-03-09 07:59:30,188 [INFO]: There are 3578 embeddings of dim 49152
2025-03-09 07:59:30,188 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0224 secs
2025-03-09 07:59:30,188 [INFO]: 	Compute estimated construction time of the index 03/09/2025, 07:59:30
2025-03-09 07:59:30,188 [INFO]: 		-> Train: 16.7 minutes
2025-03-09 07:59:30,188 [INFO]: 		-> Add: 2.0 seconds
2025-03-09 07:59:30,188 [INFO]: 		Total: 16.7 minutes
2025-03-09 07:59:30,188 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0001 secs
2025-03-09 07:59:30,188 [INFO]: 	Checking that your have enough memory available to create the index 03/09/2025, 07:59:30
2025-03-09 07:59:30,188 [INFO]: 738.4MB of memory will be needed to build the index (more might be used if you have more)
2025-03-09 07:59:30,188 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0001 secs
2025-03-09 07:59:30,188 [INFO]: 	Selecting most promising index types given data characteristics 03/09/2025, 07:59:30
2025-03-09 07:59:30,188 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-09 07:59:30,188 [INFO]: 	Creating the index 03/09/2025, 07:59:30
2025-03-09 07:59:30,189 [INFO]: 		-> Instanciate the index HNSW15 03/09/2025, 07:59:30
2025-03-09 07:59:30,189 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0008 secs
2025-03-09 07:59:30,189 [INFO]: 		-> Adding the vectors to the index 03/09/2025, 07:59:30
2025-03-09 07:59:30,189 [INFO]: The memory available for adding the vectors is 49.3GB(total available - used by the index)
2025-03-09 07:59:30,189 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/15 [00:00<?, ?it/s]  7%|▋         | 1/15 [00:00<00:02,  6.65it/s] 20%|██        | 3/15 [00:00<00:01, 10.58it/s] 33%|███▎      | 5/15 [00:00<00:00, 11.76it/s] 47%|████▋     | 7/15 [00:00<00:00, 12.31it/s] 60%|██████    | 9/15 [00:00<00:00, 12.49it/s] 73%|███████▎  | 11/15 [00:00<00:00, 12.51it/s] 87%|████████▋ | 13/15 [00:01<00:00, 12.64it/s]100%|██████████| 15/15 [00:03<00:00,  2.09it/s]100%|██████████| 15/15 [00:03<00:00,  4.04it/s]
2025-03-09 07:59:33,902 [INFO]: 	Computing best hyperparameters for index knn.index 03/09/2025, 07:59:33
2025-03-09 08:00:09,266 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 35.3625 secs
2025-03-09 08:00:09,266 [INFO]: The best hyperparameters are: efSearch=209
2025-03-09 08:00:09,266 [INFO]: 	Compute fast metrics 03/09/2025, 08:00:09
  0%|          | 0/4 [00:00<?, ?it/s] 25%|██▌       | 1/4 [00:00<00:00,  5.34it/s] 50%|█████     | 2/4 [00:00<00:00,  7.00it/s] 75%|███████▌  | 3/4 [00:00<00:00,  7.77it/s] 75%|███████▌  | 3/4 [00:00<00:00,  5.82it/s]
2025-03-09 08:00:26,115 [INFO]: 	>>> Finished "Compute fast metrics" in 16.8487 secs
2025-03-09 08:00:26,118 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 55.9286 secs
2025-03-09 08:00:26,118 [INFO]: {
2025-03-09 08:00:26,118 [INFO]: 	index_key: HNSW15
2025-03-09 08:00:26,118 [INFO]: 	index_param: efSearch=209
2025-03-09 08:00:26,118 [INFO]: 	index_path: knn.index
2025-03-09 08:00:26,118 [INFO]: 	size in bytes: 703949410
2025-03-09 08:00:26,118 [INFO]: 	avg_search_speed_ms: 9.50201501571414
2025-03-09 08:00:26,118 [INFO]: 	99p_search_speed_ms: 15.255441474728288
2025-03-09 08:00:26,118 [INFO]: 	reconstruction error %: 0.0
2025-03-09 08:00:26,118 [INFO]: 	nb vectors: 3578
2025-03-09 08:00:26,118 [INFO]: 	vectors dimension: 49152
2025-03-09 08:00:26,118 [INFO]: 	compression ratio: 0.9993096293666899
2025-03-09 08:00:26,118 [INFO]: }
2025-03-09 08:00:26,118 [INFO]: 	>>> Finished "Creating the index" in 55.9299 secs
2025-03-09 08:00:26,118 [INFO]: >>> Finished "Launching the whole pipeline" in 55.9528 secs
2025-03-09 08:00:26: [retrieval_preprocessing] calculating distances ...
2025-03-09 08:00:27: [retrieval_preprocessing] finished and saved retrieval indices for episode 17994 [episode count 11/20]
[retrieval_preprocessing] for episode 68178 [episode count 12/20], we have num_retrieval=np.int64(3484) num_query=np.int64(231)
2025-03-09 08:00:28,405 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-09 08:00:28,870 [INFO]: Launching the whole pipeline 03/09/2025, 08:00:28
2025-03-09 08:00:28,870 [INFO]: Reading total number of vectors and dimension 03/09/2025, 08:00:28
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1842.03it/s]
2025-03-09 08:00:28,894 [INFO]: There are 3484 embeddings of dim 49152
2025-03-09 08:00:28,894 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0241 secs
2025-03-09 08:00:28,894 [INFO]: 	Compute estimated construction time of the index 03/09/2025, 08:00:28
2025-03-09 08:00:28,894 [INFO]: 		-> Train: 16.7 minutes
2025-03-09 08:00:28,894 [INFO]: 		-> Add: 1.9 seconds
2025-03-09 08:00:28,894 [INFO]: 		Total: 16.7 minutes
2025-03-09 08:00:28,894 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0001 secs
2025-03-09 08:00:28,894 [INFO]: 	Checking that your have enough memory available to create the index 03/09/2025, 08:00:28
2025-03-09 08:00:28,894 [INFO]: 719.0MB of memory will be needed to build the index (more might be used if you have more)
2025-03-09 08:00:28,894 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0001 secs
2025-03-09 08:00:28,894 [INFO]: 	Selecting most promising index types given data characteristics 03/09/2025, 08:00:28
2025-03-09 08:00:28,894 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-09 08:00:28,895 [INFO]: 	Creating the index 03/09/2025, 08:00:28
2025-03-09 08:00:28,895 [INFO]: 		-> Instanciate the index HNSW15 03/09/2025, 08:00:28
2025-03-09 08:00:28,896 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0011 secs
2025-03-09 08:00:28,896 [INFO]: 		-> Adding the vectors to the index 03/09/2025, 08:00:28
2025-03-09 08:00:28,896 [INFO]: The memory available for adding the vectors is 49.4GB(total available - used by the index)
2025-03-09 08:00:28,896 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/14 [00:00<?, ?it/s]  7%|▋         | 1/14 [00:00<00:02,  5.72it/s] 21%|██▏       | 3/14 [00:00<00:01,  9.39it/s] 36%|███▌      | 5/14 [00:00<00:00, 10.71it/s] 50%|█████     | 7/14 [00:00<00:00, 11.48it/s] 64%|██████▍   | 9/14 [00:00<00:00, 11.81it/s] 79%|███████▊  | 11/14 [00:00<00:00, 11.92it/s] 93%|█████████▎| 13/14 [00:01<00:00, 11.78it/s]100%|██████████| 14/14 [00:04<00:00,  3.24it/s]
2025-03-09 08:00:33,223 [INFO]: 	Computing best hyperparameters for index knn.index 03/09/2025, 08:00:33
2025-03-09 08:01:06,788 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 33.5643 secs
2025-03-09 08:01:06,788 [INFO]: The best hyperparameters are: efSearch=159
2025-03-09 08:01:06,788 [INFO]: 	Compute fast metrics 03/09/2025, 08:01:06
  0%|          | 0/4 [00:00<?, ?it/s] 25%|██▌       | 1/4 [00:00<00:00,  6.42it/s] 50%|█████     | 2/4 [00:00<00:00,  7.94it/s] 75%|███████▌  | 3/4 [00:00<00:00,  8.36it/s] 75%|███████▌  | 3/4 [00:00<00:00,  6.32it/s]
2025-03-09 08:01:22,288 [INFO]: 	>>> Finished "Compute fast metrics" in 15.4997 secs
2025-03-09 08:01:22,291 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 53.3946 secs
2025-03-09 08:01:22,291 [INFO]: {
2025-03-09 08:01:22,291 [INFO]: 	index_key: HNSW15
2025-03-09 08:01:22,291 [INFO]: 	index_param: efSearch=159
2025-03-09 08:01:22,291 [INFO]: 	index_path: knn.index
2025-03-09 08:01:22,291 [INFO]: 	size in bytes: 685455610
2025-03-09 08:01:22,291 [INFO]: 	avg_search_speed_ms: 7.5411115533167985
2025-03-09 08:01:22,291 [INFO]: 	99p_search_speed_ms: 14.266399841289967
2025-03-09 08:01:22,291 [INFO]: 	reconstruction error %: 0.0
2025-03-09 08:01:22,291 [INFO]: 	nb vectors: 3484
2025-03-09 08:01:22,291 [INFO]: 	vectors dimension: 49152
2025-03-09 08:01:22,291 [INFO]: 	compression ratio: 0.9993094549186051
2025-03-09 08:01:22,291 [INFO]: }
2025-03-09 08:01:22,291 [INFO]: 	>>> Finished "Creating the index" in 53.3965 secs
2025-03-09 08:01:22,291 [INFO]: >>> Finished "Launching the whole pipeline" in 53.4213 secs
2025-03-09 08:01:22: [retrieval_preprocessing] calculating distances ...
2025-03-09 08:01:23: [retrieval_preprocessing] finished and saved retrieval indices for episode 68178 [episode count 12/20]
[retrieval_preprocessing] for episode 76883 [episode count 13/20], we have num_retrieval=np.int64(3541) num_query=np.int64(174)
2025-03-09 08:01:24,783 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-09 08:01:25,499 [INFO]: Launching the whole pipeline 03/09/2025, 08:01:25
2025-03-09 08:01:25,499 [INFO]: Reading total number of vectors and dimension 03/09/2025, 08:01:25
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1277.58it/s]
2025-03-09 08:01:26,232 [INFO]: There are 3541 embeddings of dim 49152
2025-03-09 08:01:26,232 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.7335 secs
2025-03-09 08:01:26,232 [INFO]: 	Compute estimated construction time of the index 03/09/2025, 08:01:26
2025-03-09 08:01:26,232 [INFO]: 		-> Train: 16.7 minutes
2025-03-09 08:01:26,232 [INFO]: 		-> Add: 1.9 seconds
2025-03-09 08:01:26,233 [INFO]: 		Total: 16.7 minutes
2025-03-09 08:01:26,233 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0002 secs
2025-03-09 08:01:26,233 [INFO]: 	Checking that your have enough memory available to create the index 03/09/2025, 08:01:26
2025-03-09 08:01:26,233 [INFO]: 730.8MB of memory will be needed to build the index (more might be used if you have more)
2025-03-09 08:01:26,233 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0003 secs
2025-03-09 08:01:26,233 [INFO]: 	Selecting most promising index types given data characteristics 03/09/2025, 08:01:26
2025-03-09 08:01:26,233 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-09 08:01:26,233 [INFO]: 	Creating the index 03/09/2025, 08:01:26
2025-03-09 08:01:26,233 [INFO]: 		-> Instanciate the index HNSW15 03/09/2025, 08:01:26
2025-03-09 08:01:26,235 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0019 secs
2025-03-09 08:01:26,235 [INFO]: 		-> Adding the vectors to the index 03/09/2025, 08:01:26
2025-03-09 08:01:26,236 [INFO]: The memory available for adding the vectors is 49.4GB(total available - used by the index)
2025-03-09 08:01:26,236 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/14 [00:00<?, ?it/s]  7%|▋         | 1/14 [00:00<00:01,  7.45it/s] 21%|██▏       | 3/14 [00:00<00:01,  9.72it/s] 29%|██▊       | 4/14 [00:00<00:01,  9.51it/s] 36%|███▌      | 5/14 [00:00<00:00,  9.21it/s] 43%|████▎     | 6/14 [00:00<00:00,  8.98it/s] 50%|█████     | 7/14 [00:00<00:00,  8.93it/s] 57%|█████▋    | 8/14 [00:00<00:00,  8.94it/s] 64%|██████▍   | 9/14 [00:00<00:00,  8.94it/s] 71%|███████▏  | 10/14 [00:01<00:00,  9.01it/s] 79%|███████▊  | 11/14 [00:01<00:00,  8.93it/s] 86%|████████▌ | 12/14 [00:01<00:00,  8.94it/s] 93%|█████████▎| 13/14 [00:01<00:00,  8.97it/s]100%|██████████| 14/14 [00:03<00:00,  1.21it/s]100%|██████████| 14/14 [00:03<00:00,  3.56it/s]
2025-03-09 08:01:30,181 [INFO]: 	Computing best hyperparameters for index knn.index 03/09/2025, 08:01:30
2025-03-09 08:02:04,587 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 34.4052 secs
2025-03-09 08:02:04,587 [INFO]: The best hyperparameters are: efSearch=164
2025-03-09 08:02:04,587 [INFO]: 	Compute fast metrics 03/09/2025, 08:02:04
  0%|          | 0/4 [00:00<?, ?it/s] 25%|██▌       | 1/4 [00:00<00:00,  4.92it/s] 50%|█████     | 2/4 [00:00<00:00,  6.37it/s] 75%|███████▌  | 3/4 [00:00<00:00,  6.92it/s] 75%|███████▌  | 3/4 [00:00<00:00,  5.14it/s]
2025-03-09 08:02:21,049 [INFO]: 	>>> Finished "Compute fast metrics" in 16.4621 secs
2025-03-09 08:02:21,052 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 54.8163 secs
2025-03-09 08:02:21,052 [INFO]: {
2025-03-09 08:02:21,052 [INFO]: 	index_key: HNSW15
2025-03-09 08:02:21,052 [INFO]: 	index_param: efSearch=164
2025-03-09 08:02:21,052 [INFO]: 	index_path: knn.index
2025-03-09 08:02:21,052 [INFO]: 	size in bytes: 696669910
2025-03-09 08:02:21,052 [INFO]: 	avg_search_speed_ms: 7.865237596391295
2025-03-09 08:02:21,052 [INFO]: 	99p_search_speed_ms: 14.638537261635065
2025-03-09 08:02:21,052 [INFO]: 	reconstruction error %: 0.0
2025-03-09 08:02:21,052 [INFO]: 	nb vectors: 3541
2025-03-09 08:02:21,052 [INFO]: 	vectors dimension: 49152
2025-03-09 08:02:21,052 [INFO]: 	compression ratio: 0.9993095984294772
2025-03-09 08:02:21,052 [INFO]: }
2025-03-09 08:02:21,052 [INFO]: 	>>> Finished "Creating the index" in 54.8189 secs
2025-03-09 08:02:21,052 [INFO]: >>> Finished "Launching the whole pipeline" in 55.5535 secs
2025-03-09 08:02:21: [retrieval_preprocessing] calculating distances ...
2025-03-09 08:02:22: [retrieval_preprocessing] finished and saved retrieval indices for episode 76883 [episode count 13/20]
[retrieval_preprocessing] for episode 15451 [episode count 14/20], we have num_retrieval=np.int64(3472) num_query=np.int64(243)
2025-03-09 08:02:23,440 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-09 08:02:24,504 [INFO]: Launching the whole pipeline 03/09/2025, 08:02:24
2025-03-09 08:02:24,505 [INFO]: Reading total number of vectors and dimension 03/09/2025, 08:02:24
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1444.32it/s]
2025-03-09 08:02:24,529 [INFO]: There are 3472 embeddings of dim 49152
2025-03-09 08:02:24,529 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0242 secs
2025-03-09 08:02:24,529 [INFO]: 	Compute estimated construction time of the index 03/09/2025, 08:02:24
2025-03-09 08:02:24,529 [INFO]: 		-> Train: 16.7 minutes
2025-03-09 08:02:24,529 [INFO]: 		-> Add: 1.9 seconds
2025-03-09 08:02:24,529 [INFO]: 		Total: 16.7 minutes
2025-03-09 08:02:24,529 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0001 secs
2025-03-09 08:02:24,529 [INFO]: 	Checking that your have enough memory available to create the index 03/09/2025, 08:02:24
2025-03-09 08:02:24,529 [INFO]: 716.5MB of memory will be needed to build the index (more might be used if you have more)
2025-03-09 08:02:24,529 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0001 secs
2025-03-09 08:02:24,529 [INFO]: 	Selecting most promising index types given data characteristics 03/09/2025, 08:02:24
2025-03-09 08:02:24,529 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-09 08:02:24,529 [INFO]: 	Creating the index 03/09/2025, 08:02:24
2025-03-09 08:02:24,529 [INFO]: 		-> Instanciate the index HNSW15 03/09/2025, 08:02:24
2025-03-09 08:02:24,530 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0010 secs
2025-03-09 08:02:24,530 [INFO]: 		-> Adding the vectors to the index 03/09/2025, 08:02:24
2025-03-09 08:02:24,531 [INFO]: The memory available for adding the vectors is 49.4GB(total available - used by the index)
2025-03-09 08:02:24,531 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/14 [00:00<?, ?it/s]  7%|▋         | 1/14 [00:00<00:02,  5.68it/s] 21%|██▏       | 3/14 [00:00<00:01,  9.58it/s] 36%|███▌      | 5/14 [00:00<00:00, 10.82it/s] 50%|█████     | 7/14 [00:00<00:00, 11.46it/s] 64%|██████▍   | 9/14 [00:00<00:00, 11.49it/s] 79%|███████▊  | 11/14 [00:00<00:00, 11.65it/s] 93%|█████████▎| 13/14 [00:01<00:00, 11.96it/s]100%|██████████| 14/14 [00:03<00:00,  3.72it/s]
2025-03-09 08:02:28,299 [INFO]: 	Computing best hyperparameters for index knn.index 03/09/2025, 08:02:28
2025-03-09 08:03:00,061 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 31.7614 secs
2025-03-09 08:03:00,061 [INFO]: The best hyperparameters are: efSearch=234
2025-03-09 08:03:00,061 [INFO]: 	Compute fast metrics 03/09/2025, 08:03:00
  0%|          | 0/4 [00:00<?, ?it/s] 25%|██▌       | 1/4 [00:00<00:00,  5.31it/s] 50%|█████     | 2/4 [00:00<00:00,  6.97it/s] 75%|███████▌  | 3/4 [00:00<00:00,  7.66it/s] 75%|███████▌  | 3/4 [00:00<00:00,  5.80it/s]
2025-03-09 08:03:18,911 [INFO]: 	>>> Finished "Compute fast metrics" in 18.8498 secs
2025-03-09 08:03:18,914 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 54.3833 secs
2025-03-09 08:03:18,914 [INFO]: {
2025-03-09 08:03:18,914 [INFO]: 	index_key: HNSW15
2025-03-09 08:03:18,914 [INFO]: 	index_param: efSearch=234
2025-03-09 08:03:18,914 [INFO]: 	index_path: knn.index
2025-03-09 08:03:18,914 [INFO]: 	size in bytes: 683094730
2025-03-09 08:03:18,914 [INFO]: 	avg_search_speed_ms: 11.485011650862411
2025-03-09 08:03:18,914 [INFO]: 	99p_search_speed_ms: 25.437773407902544
2025-03-09 08:03:18,914 [INFO]: 	reconstruction error %: 0.0
2025-03-09 08:03:18,914 [INFO]: 	nb vectors: 3472
2025-03-09 08:03:18,914 [INFO]: 	vectors dimension: 49152
2025-03-09 08:03:18,914 [INFO]: 	compression ratio: 0.999309387147519
2025-03-09 08:03:18,914 [INFO]: }
2025-03-09 08:03:18,914 [INFO]: 	>>> Finished "Creating the index" in 54.3849 secs
2025-03-09 08:03:18,914 [INFO]: >>> Finished "Launching the whole pipeline" in 54.4097 secs
2025-03-09 08:03:20: [retrieval_preprocessing] calculating distances ...
2025-03-09 08:03:22: [retrieval_preprocessing] finished and saved retrieval indices for episode 15451 [episode count 14/20]
[retrieval_preprocessing] for episode 24670 [episode count 15/20], we have num_retrieval=np.int64(3563) num_query=np.int64(152)
2025-03-09 08:03:23,485 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-09 08:03:23,982 [INFO]: Launching the whole pipeline 03/09/2025, 08:03:23
2025-03-09 08:03:23,982 [INFO]: Reading total number of vectors and dimension 03/09/2025, 08:03:23
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1522.43it/s]
2025-03-09 08:03:24,010 [INFO]: There are 3563 embeddings of dim 49152
2025-03-09 08:03:24,010 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0286 secs
2025-03-09 08:03:24,011 [INFO]: 	Compute estimated construction time of the index 03/09/2025, 08:03:24
2025-03-09 08:03:24,011 [INFO]: 		-> Train: 16.7 minutes
2025-03-09 08:03:24,011 [INFO]: 		-> Add: 2.0 seconds
2025-03-09 08:03:24,011 [INFO]: 		Total: 16.7 minutes
2025-03-09 08:03:24,011 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0004 secs
2025-03-09 08:03:24,011 [INFO]: 	Checking that your have enough memory available to create the index 03/09/2025, 08:03:24
2025-03-09 08:03:24,011 [INFO]: 735.3MB of memory will be needed to build the index (more might be used if you have more)
2025-03-09 08:03:24,012 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0004 secs
2025-03-09 08:03:24,012 [INFO]: 	Selecting most promising index types given data characteristics 03/09/2025, 08:03:24
2025-03-09 08:03:24,012 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-09 08:03:24,012 [INFO]: 	Creating the index 03/09/2025, 08:03:24
2025-03-09 08:03:24,012 [INFO]: 		-> Instanciate the index HNSW15 03/09/2025, 08:03:24
2025-03-09 08:03:24,015 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0028 secs
2025-03-09 08:03:24,015 [INFO]: 		-> Adding the vectors to the index 03/09/2025, 08:03:24
2025-03-09 08:03:24,016 [INFO]: The memory available for adding the vectors is 49.3GB(total available - used by the index)
2025-03-09 08:03:24,016 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/15 [00:00<?, ?it/s]  7%|▋         | 1/15 [00:00<00:02,  5.71it/s] 13%|█▎        | 2/15 [00:00<00:01,  7.26it/s] 20%|██        | 3/15 [00:00<00:01,  7.93it/s] 27%|██▋       | 4/15 [00:00<00:01,  8.24it/s] 33%|███▎      | 5/15 [00:00<00:01,  8.66it/s] 40%|████      | 6/15 [00:00<00:00,  9.04it/s] 47%|████▋     | 7/15 [00:00<00:00,  9.02it/s] 53%|█████▎    | 8/15 [00:00<00:00,  9.01it/s] 60%|██████    | 9/15 [00:01<00:00,  9.14it/s] 67%|██████▋   | 10/15 [00:01<00:00,  9.31it/s] 73%|███████▎  | 11/15 [00:01<00:00,  9.38it/s] 80%|████████  | 12/15 [00:01<00:00,  9.49it/s] 87%|████████▋ | 13/15 [00:01<00:00,  9.36it/s] 93%|█████████▎| 14/15 [00:01<00:00,  9.39it/s]100%|██████████| 15/15 [00:05<00:00,  1.32s/it]100%|██████████| 15/15 [00:05<00:00,  2.63it/s]
2025-03-09 08:03:29,718 [INFO]: 	Computing best hyperparameters for index knn.index 03/09/2025, 08:03:29
2025-03-09 08:04:02,565 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 32.8463 secs
2025-03-09 08:04:02,565 [INFO]: The best hyperparameters are: efSearch=206
2025-03-09 08:04:02,565 [INFO]: 	Compute fast metrics 03/09/2025, 08:04:02
  0%|          | 0/4 [00:00<?, ?it/s] 25%|██▌       | 1/4 [00:00<00:00,  5.01it/s] 50%|█████     | 2/4 [00:00<00:00,  6.62it/s] 75%|███████▌  | 3/4 [00:00<00:00,  7.30it/s] 75%|███████▌  | 3/4 [00:00<00:00,  5.47it/s]
2025-03-09 08:04:21,078 [INFO]: 	>>> Finished "Compute fast metrics" in 18.5128 secs
2025-03-09 08:04:21,081 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 57.0659 secs
2025-03-09 08:04:21,081 [INFO]: {
2025-03-09 08:04:21,081 [INFO]: 	index_key: HNSW15
2025-03-09 08:04:21,081 [INFO]: 	index_param: efSearch=206
2025-03-09 08:04:21,082 [INFO]: 	index_path: knn.index
2025-03-09 08:04:21,082 [INFO]: 	size in bytes: 700998310
2025-03-09 08:04:21,082 [INFO]: 	avg_search_speed_ms: 9.158348175100027
2025-03-09 08:04:21,082 [INFO]: 	99p_search_speed_ms: 13.513356542680377
2025-03-09 08:04:21,082 [INFO]: 	reconstruction error %: 0.0
2025-03-09 08:04:21,082 [INFO]: 	nb vectors: 3563
2025-03-09 08:04:21,082 [INFO]: 	vectors dimension: 49152
2025-03-09 08:04:21,082 [INFO]: 	compression ratio: 0.999309547550835
2025-03-09 08:04:21,082 [INFO]: }
2025-03-09 08:04:21,082 [INFO]: 	>>> Finished "Creating the index" in 57.0695 secs
2025-03-09 08:04:21,082 [INFO]: >>> Finished "Launching the whole pipeline" in 57.1000 secs
2025-03-09 08:04:21: [retrieval_preprocessing] calculating distances ...
2025-03-09 08:04:22: [retrieval_preprocessing] finished and saved retrieval indices for episode 24670 [episode count 15/20]
[retrieval_preprocessing] for episode 44147 [episode count 16/20], we have num_retrieval=np.int64(3457) num_query=np.int64(258)
2025-03-09 08:04:23,194 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-09 08:04:23,669 [INFO]: Launching the whole pipeline 03/09/2025, 08:04:23
2025-03-09 08:04:23,669 [INFO]: Reading total number of vectors and dimension 03/09/2025, 08:04:23
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1843.65it/s]
2025-03-09 08:04:23,693 [INFO]: There are 3457 embeddings of dim 49152
2025-03-09 08:04:23,693 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0245 secs
2025-03-09 08:04:23,693 [INFO]: 	Compute estimated construction time of the index 03/09/2025, 08:04:23
2025-03-09 08:04:23,693 [INFO]: 		-> Train: 16.7 minutes
2025-03-09 08:04:23,693 [INFO]: 		-> Add: 1.9 seconds
2025-03-09 08:04:23,693 [INFO]: 		Total: 16.7 minutes
2025-03-09 08:04:23,693 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0001 secs
2025-03-09 08:04:23,693 [INFO]: 	Checking that your have enough memory available to create the index 03/09/2025, 08:04:23
2025-03-09 08:04:23,694 [INFO]: 713.4MB of memory will be needed to build the index (more might be used if you have more)
2025-03-09 08:04:23,694 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0001 secs
2025-03-09 08:04:23,694 [INFO]: 	Selecting most promising index types given data characteristics 03/09/2025, 08:04:23
2025-03-09 08:04:23,694 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-09 08:04:23,694 [INFO]: 	Creating the index 03/09/2025, 08:04:23
2025-03-09 08:04:23,694 [INFO]: 		-> Instanciate the index HNSW15 03/09/2025, 08:04:23
2025-03-09 08:04:23,695 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0011 secs
2025-03-09 08:04:23,695 [INFO]: 		-> Adding the vectors to the index 03/09/2025, 08:04:23
2025-03-09 08:04:23,695 [INFO]: The memory available for adding the vectors is 49.4GB(total available - used by the index)
2025-03-09 08:04:23,695 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/14 [00:00<?, ?it/s]  7%|▋         | 1/14 [00:00<00:02,  5.85it/s] 21%|██▏       | 3/14 [00:00<00:01,  9.77it/s] 36%|███▌      | 5/14 [00:00<00:00, 11.38it/s] 57%|█████▋    | 8/14 [00:00<00:00, 13.75it/s] 71%|███████▏  | 10/14 [00:00<00:00, 13.36it/s] 86%|████████▌ | 12/14 [00:00<00:00, 13.14it/s]100%|██████████| 14/14 [00:03<00:00,  2.34it/s]100%|██████████| 14/14 [00:03<00:00,  4.17it/s]
2025-03-09 08:04:27,053 [INFO]: 	Computing best hyperparameters for index knn.index 03/09/2025, 08:04:27
2025-03-09 08:04:59,537 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 32.4835 secs
2025-03-09 08:04:59,537 [INFO]: The best hyperparameters are: efSearch=193
2025-03-09 08:04:59,537 [INFO]: 	Compute fast metrics 03/09/2025, 08:04:59
  0%|          | 0/4 [00:00<?, ?it/s] 25%|██▌       | 1/4 [00:00<00:00,  4.84it/s] 50%|█████     | 2/4 [00:00<00:00,  6.47it/s] 75%|███████▌  | 3/4 [00:00<00:00,  7.36it/s] 75%|███████▌  | 3/4 [00:00<00:00,  5.38it/s]
2025-03-09 08:05:19,050 [INFO]: 	>>> Finished "Compute fast metrics" in 19.5130 secs
2025-03-09 08:05:19,053 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 55.3580 secs
2025-03-09 08:05:19,053 [INFO]: {
2025-03-09 08:05:19,053 [INFO]: 	index_key: HNSW15
2025-03-09 08:05:19,053 [INFO]: 	index_param: efSearch=193
2025-03-09 08:05:19,053 [INFO]: 	index_path: knn.index
2025-03-09 08:05:19,053 [INFO]: 	size in bytes: 680143570
2025-03-09 08:05:19,053 [INFO]: 	avg_search_speed_ms: 7.843817963867503
2025-03-09 08:05:19,053 [INFO]: 	99p_search_speed_ms: 15.493960077874359
2025-03-09 08:05:19,053 [INFO]: 	reconstruction error %: 0.0
2025-03-09 08:05:19,053 [INFO]: 	nb vectors: 3457
2025-03-09 08:05:19,053 [INFO]: 	vectors dimension: 49152
2025-03-09 08:05:19,053 [INFO]: 	compression ratio: 0.9993093899277766
2025-03-09 08:05:19,053 [INFO]: }
2025-03-09 08:05:19,053 [INFO]: 	>>> Finished "Creating the index" in 55.3597 secs
2025-03-09 08:05:19,053 [INFO]: >>> Finished "Launching the whole pipeline" in 55.3849 secs
2025-03-09 08:05:20: [retrieval_preprocessing] calculating distances ...
2025-03-09 08:05:20: [retrieval_preprocessing] finished and saved retrieval indices for episode 44147 [episode count 16/20]
[retrieval_preprocessing] for episode 41588 [episode count 17/20], we have num_retrieval=np.int64(3576) num_query=np.int64(139)
2025-03-09 08:05:21,752 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-09 08:05:22,208 [INFO]: Launching the whole pipeline 03/09/2025, 08:05:22
2025-03-09 08:05:22,208 [INFO]: Reading total number of vectors and dimension 03/09/2025, 08:05:22
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1504.41it/s]
2025-03-09 08:05:22,232 [INFO]: There are 3576 embeddings of dim 49152
2025-03-09 08:05:22,232 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0241 secs
2025-03-09 08:05:22,232 [INFO]: 	Compute estimated construction time of the index 03/09/2025, 08:05:22
2025-03-09 08:05:22,232 [INFO]: 		-> Train: 16.7 minutes
2025-03-09 08:05:22,232 [INFO]: 		-> Add: 2.0 seconds
2025-03-09 08:05:22,232 [INFO]: 		Total: 16.7 minutes
2025-03-09 08:05:22,232 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0001 secs
2025-03-09 08:05:22,232 [INFO]: 	Checking that your have enough memory available to create the index 03/09/2025, 08:05:22
2025-03-09 08:05:22,232 [INFO]: 738.0MB of memory will be needed to build the index (more might be used if you have more)
2025-03-09 08:05:22,232 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0001 secs
2025-03-09 08:05:22,232 [INFO]: 	Selecting most promising index types given data characteristics 03/09/2025, 08:05:22
2025-03-09 08:05:22,232 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-09 08:05:22,232 [INFO]: 	Creating the index 03/09/2025, 08:05:22
2025-03-09 08:05:22,232 [INFO]: 		-> Instanciate the index HNSW15 03/09/2025, 08:05:22
2025-03-09 08:05:22,234 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0011 secs
2025-03-09 08:05:22,234 [INFO]: 		-> Adding the vectors to the index 03/09/2025, 08:05:22
2025-03-09 08:05:22,234 [INFO]: The memory available for adding the vectors is 49.3GB(total available - used by the index)
2025-03-09 08:05:22,234 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/15 [00:00<?, ?it/s]  7%|▋         | 1/15 [00:00<00:02,  6.01it/s] 20%|██        | 3/15 [00:00<00:01,  9.43it/s] 33%|███▎      | 5/15 [00:00<00:00, 10.35it/s] 47%|████▋     | 7/15 [00:00<00:00, 10.62it/s] 60%|██████    | 9/15 [00:00<00:00, 10.68it/s] 73%|███████▎  | 11/15 [00:01<00:00, 10.81it/s] 87%|████████▋ | 13/15 [00:01<00:00, 10.71it/s]100%|██████████| 15/15 [00:03<00:00,  2.22it/s]100%|██████████| 15/15 [00:03<00:00,  4.10it/s]
2025-03-09 08:05:26,838 [INFO]: 	Computing best hyperparameters for index knn.index 03/09/2025, 08:05:26
2025-03-09 08:06:05,915 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 39.0763 secs
2025-03-09 08:06:05,915 [INFO]: The best hyperparameters are: efSearch=116
2025-03-09 08:06:05,915 [INFO]: 	Compute fast metrics 03/09/2025, 08:06:05
  0%|          | 0/4 [00:00<?, ?it/s] 25%|██▌       | 1/4 [00:00<00:00,  6.38it/s] 75%|███████▌  | 3/4 [00:00<00:00, 10.23it/s] 75%|███████▌  | 3/4 [00:00<00:00,  7.81it/s]
2025-03-09 08:06:23,430 [INFO]: 	>>> Finished "Compute fast metrics" in 17.5150 secs
2025-03-09 08:06:23,433 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 61.1993 secs
2025-03-09 08:06:23,433 [INFO]: {
2025-03-09 08:06:23,433 [INFO]: 	index_key: HNSW15
2025-03-09 08:06:23,433 [INFO]: 	index_param: efSearch=116
2025-03-09 08:06:23,433 [INFO]: 	index_path: knn.index
2025-03-09 08:06:23,433 [INFO]: 	size in bytes: 703555930
2025-03-09 08:06:23,433 [INFO]: 	avg_search_speed_ms: 6.148347651430143
2025-03-09 08:06:23,433 [INFO]: 	99p_search_speed_ms: 11.679505987558514
2025-03-09 08:06:23,433 [INFO]: 	reconstruction error %: 0.0
2025-03-09 08:06:23,433 [INFO]: 	nb vectors: 3576
2025-03-09 08:06:23,433 [INFO]: 	vectors dimension: 49152
2025-03-09 08:06:23,433 [INFO]: 	compression ratio: 0.9993096184975656
2025-03-09 08:06:23,433 [INFO]: }
2025-03-09 08:06:23,433 [INFO]: 	>>> Finished "Creating the index" in 61.2008 secs
2025-03-09 08:06:23,433 [INFO]: >>> Finished "Launching the whole pipeline" in 61.2254 secs
2025-03-09 08:06:23: [retrieval_preprocessing] calculating distances ...
2025-03-09 08:06:24: [retrieval_preprocessing] finished and saved retrieval indices for episode 41588 [episode count 17/20]
[retrieval_preprocessing] for episode 36988 [episode count 18/20], we have num_retrieval=np.int64(3549) num_query=np.int64(166)
2025-03-09 08:06:25,241 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-09 08:06:26,591 [INFO]: Launching the whole pipeline 03/09/2025, 08:06:26
2025-03-09 08:06:26,591 [INFO]: Reading total number of vectors and dimension 03/09/2025, 08:06:26
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1439.86it/s]
2025-03-09 08:06:26,618 [INFO]: There are 3549 embeddings of dim 49152
2025-03-09 08:06:26,618 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0269 secs
2025-03-09 08:06:26,618 [INFO]: 	Compute estimated construction time of the index 03/09/2025, 08:06:26
2025-03-09 08:06:26,618 [INFO]: 		-> Train: 16.7 minutes
2025-03-09 08:06:26,618 [INFO]: 		-> Add: 1.9 seconds
2025-03-09 08:06:26,618 [INFO]: 		Total: 16.7 minutes
2025-03-09 08:06:26,618 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0001 secs
2025-03-09 08:06:26,618 [INFO]: 	Checking that your have enough memory available to create the index 03/09/2025, 08:06:26
2025-03-09 08:06:26,618 [INFO]: 732.4MB of memory will be needed to build the index (more might be used if you have more)
2025-03-09 08:06:26,619 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0001 secs
2025-03-09 08:06:26,619 [INFO]: 	Selecting most promising index types given data characteristics 03/09/2025, 08:06:26
2025-03-09 08:06:26,619 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-09 08:06:26,619 [INFO]: 	Creating the index 03/09/2025, 08:06:26
2025-03-09 08:06:26,619 [INFO]: 		-> Instanciate the index HNSW15 03/09/2025, 08:06:26
2025-03-09 08:06:26,620 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0011 secs
2025-03-09 08:06:26,620 [INFO]: 		-> Adding the vectors to the index 03/09/2025, 08:06:26
2025-03-09 08:06:26,620 [INFO]: The memory available for adding the vectors is 49.3GB(total available - used by the index)
2025-03-09 08:06:26,620 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/14 [00:00<?, ?it/s]  7%|▋         | 1/14 [00:00<00:02,  5.44it/s] 14%|█▍        | 2/14 [00:00<00:01,  7.16it/s] 21%|██▏       | 3/14 [00:00<00:01,  7.85it/s] 29%|██▊       | 4/14 [00:00<00:01,  8.33it/s] 36%|███▌      | 5/14 [00:00<00:01,  8.70it/s] 43%|████▎     | 6/14 [00:00<00:00,  9.06it/s] 50%|█████     | 7/14 [00:00<00:00,  9.16it/s] 64%|██████▍   | 9/14 [00:01<00:00,  9.49it/s] 71%|███████▏  | 10/14 [00:01<00:00,  9.53it/s] 79%|███████▊  | 11/14 [00:01<00:00,  9.46it/s] 86%|████████▌ | 12/14 [00:01<00:00,  9.40it/s] 93%|█████████▎| 13/14 [00:01<00:00,  9.43it/s]100%|██████████| 14/14 [00:04<00:00,  1.08it/s]100%|██████████| 14/14 [00:04<00:00,  3.18it/s]
2025-03-09 08:06:31,039 [INFO]: 	Computing best hyperparameters for index knn.index 03/09/2025, 08:06:31
2025-03-09 08:07:03,890 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 32.8507 secs
2025-03-09 08:07:03,890 [INFO]: The best hyperparameters are: efSearch=182
2025-03-09 08:07:03,891 [INFO]: 	Compute fast metrics 03/09/2025, 08:07:03
  0%|          | 0/4 [00:00<?, ?it/s] 25%|██▌       | 1/4 [00:00<00:00,  6.02it/s] 50%|█████     | 2/4 [00:00<00:00,  7.35it/s] 75%|███████▌  | 3/4 [00:00<00:00,  8.04it/s] 75%|███████▌  | 3/4 [00:00<00:00,  6.08it/s]
2025-03-09 08:07:19,928 [INFO]: 	>>> Finished "Compute fast metrics" in 16.0370 secs
2025-03-09 08:07:19,930 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 53.3100 secs
2025-03-09 08:07:19,930 [INFO]: {
2025-03-09 08:07:19,930 [INFO]: 	index_key: HNSW15
2025-03-09 08:07:19,930 [INFO]: 	index_param: efSearch=182
2025-03-09 08:07:19,930 [INFO]: 	index_path: knn.index
2025-03-09 08:07:19,930 [INFO]: 	size in bytes: 698243950
2025-03-09 08:07:19,930 [INFO]: 	avg_search_speed_ms: 8.042614396784398
2025-03-09 08:07:19,930 [INFO]: 	99p_search_speed_ms: 13.064516480080782
2025-03-09 08:07:19,930 [INFO]: 	reconstruction error %: 0.0
2025-03-09 08:07:19,930 [INFO]: 	nb vectors: 3549
2025-03-09 08:07:19,930 [INFO]: 	vectors dimension: 49152
2025-03-09 08:07:19,930 [INFO]: 	compression ratio: 0.9993094705654091
2025-03-09 08:07:19,930 [INFO]: }
2025-03-09 08:07:19,930 [INFO]: 	>>> Finished "Creating the index" in 53.3116 secs
2025-03-09 08:07:19,930 [INFO]: >>> Finished "Launching the whole pipeline" in 53.3391 secs
2025-03-09 08:07:20: [retrieval_preprocessing] calculating distances ...
2025-03-09 08:07:21: [retrieval_preprocessing] finished and saved retrieval indices for episode 36988 [episode count 18/20]
[retrieval_preprocessing] for episode 34943 [episode count 19/20], we have num_retrieval=np.int64(3445) num_query=np.int64(270)
2025-03-09 08:07:22,100 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-09 08:07:22,804 [INFO]: Launching the whole pipeline 03/09/2025, 08:07:22
2025-03-09 08:07:22,805 [INFO]: Reading total number of vectors and dimension 03/09/2025, 08:07:22
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 2538.92it/s]
2025-03-09 08:07:22,829 [INFO]: There are 3445 embeddings of dim 49152
2025-03-09 08:07:22,830 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0249 secs
2025-03-09 08:07:22,830 [INFO]: 	Compute estimated construction time of the index 03/09/2025, 08:07:22
2025-03-09 08:07:22,830 [INFO]: 		-> Train: 16.7 minutes
2025-03-09 08:07:22,830 [INFO]: 		-> Add: 1.9 seconds
2025-03-09 08:07:22,830 [INFO]: 		Total: 16.7 minutes
2025-03-09 08:07:22,830 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0003 secs
2025-03-09 08:07:22,830 [INFO]: 	Checking that your have enough memory available to create the index 03/09/2025, 08:07:22
2025-03-09 08:07:22,831 [INFO]: 711.0MB of memory will be needed to build the index (more might be used if you have more)
2025-03-09 08:07:22,831 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0004 secs
2025-03-09 08:07:22,831 [INFO]: 	Selecting most promising index types given data characteristics 03/09/2025, 08:07:22
2025-03-09 08:07:22,831 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-09 08:07:22,831 [INFO]: 	Creating the index 03/09/2025, 08:07:22
2025-03-09 08:07:22,831 [INFO]: 		-> Instanciate the index HNSW15 03/09/2025, 08:07:22
2025-03-09 08:07:22,834 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0028 secs
2025-03-09 08:07:22,834 [INFO]: 		-> Adding the vectors to the index 03/09/2025, 08:07:22
2025-03-09 08:07:22,835 [INFO]: The memory available for adding the vectors is 49.4GB(total available - used by the index)
2025-03-09 08:07:22,835 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/14 [00:00<?, ?it/s]  7%|▋         | 1/14 [00:00<00:01,  6.77it/s] 21%|██▏       | 3/14 [00:00<00:01, 10.45it/s] 36%|███▌      | 5/14 [00:00<00:00, 11.70it/s] 50%|█████     | 7/14 [00:00<00:00, 12.12it/s] 64%|██████▍   | 9/14 [00:00<00:00, 12.38it/s] 79%|███████▊  | 11/14 [00:00<00:00, 12.62it/s] 93%|█████████▎| 13/14 [00:01<00:00, 12.67it/s]100%|██████████| 14/14 [00:03<00:00,  4.34it/s]
2025-03-09 08:07:26,065 [INFO]: 	Computing best hyperparameters for index knn.index 03/09/2025, 08:07:26
2025-03-09 08:07:57,787 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 31.7223 secs
2025-03-09 08:07:57,788 [INFO]: The best hyperparameters are: efSearch=235
2025-03-09 08:07:57,788 [INFO]: 	Compute fast metrics 03/09/2025, 08:07:57
  0%|          | 0/4 [00:00<?, ?it/s] 25%|██▌       | 1/4 [00:00<00:00,  5.17it/s] 50%|█████     | 2/4 [00:00<00:00,  7.01it/s] 75%|███████▌  | 3/4 [00:00<00:00,  7.80it/s] 75%|███████▌  | 3/4 [00:00<00:00,  5.82it/s]
2025-03-09 08:08:16,721 [INFO]: 	>>> Finished "Compute fast metrics" in 18.9335 secs
2025-03-09 08:08:16,724 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 53.8891 secs
2025-03-09 08:08:16,724 [INFO]: {
2025-03-09 08:08:16,724 [INFO]: 	index_key: HNSW15
2025-03-09 08:08:16,724 [INFO]: 	index_param: efSearch=235
2025-03-09 08:08:16,724 [INFO]: 	index_path: knn.index
2025-03-09 08:08:16,724 [INFO]: 	size in bytes: 677782690
2025-03-09 08:08:16,724 [INFO]: 	avg_search_speed_ms: 9.729570545417397
2025-03-09 08:08:16,724 [INFO]: 	99p_search_speed_ms: 15.893531737383457
2025-03-09 08:08:16,724 [INFO]: 	reconstruction error %: 0.0
2025-03-09 08:08:16,724 [INFO]: 	nb vectors: 3445
2025-03-09 08:08:16,724 [INFO]: 	vectors dimension: 49152
2025-03-09 08:08:16,724 [INFO]: 	compression ratio: 0.9993093213991641
2025-03-09 08:08:16,724 [INFO]: }
2025-03-09 08:08:16,724 [INFO]: 	>>> Finished "Creating the index" in 53.8930 secs
2025-03-09 08:08:16,724 [INFO]: >>> Finished "Launching the whole pipeline" in 53.9197 secs
2025-03-09 08:08:18: [retrieval_preprocessing] calculating distances ...
2025-03-09 08:08:19: [retrieval_preprocessing] finished and saved retrieval indices for episode 34943 [episode count 19/20]
2025-03-09 08:08:19: [retrieval_preprocessing] finished for (9505766118, 'drawer') [chosen_id count 3/10]
2025-03-09 08:08:22: [retrieval_preprocessing] concatenated all embeddings and indices for 20 episodes for (441689524, 'mug') [chosen_id count 4/10]
2025-03-09 08:08:22: [retrieval_preprocessing] we have num_total=3717 embedding_dim=49152
[retrieval_preprocessing] for episode 37889 [episode count 0/20], we have num_retrieval=np.int64(3567) num_query=np.int64(150)
2025-03-09 08:08:23,704 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-09 08:08:24,398 [INFO]: Launching the whole pipeline 03/09/2025, 08:08:24
2025-03-09 08:08:24,398 [INFO]: Reading total number of vectors and dimension 03/09/2025, 08:08:24
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 2228.64it/s]
2025-03-09 08:08:24,423 [INFO]: There are 3567 embeddings of dim 49152
2025-03-09 08:08:24,423 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0253 secs
2025-03-09 08:08:24,423 [INFO]: 	Compute estimated construction time of the index 03/09/2025, 08:08:24
2025-03-09 08:08:24,423 [INFO]: 		-> Train: 16.7 minutes
2025-03-09 08:08:24,423 [INFO]: 		-> Add: 2.0 seconds
2025-03-09 08:08:24,423 [INFO]: 		Total: 16.7 minutes
2025-03-09 08:08:24,423 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0001 secs
2025-03-09 08:08:24,423 [INFO]: 	Checking that your have enough memory available to create the index 03/09/2025, 08:08:24
2025-03-09 08:08:24,423 [INFO]: 736.1MB of memory will be needed to build the index (more might be used if you have more)
2025-03-09 08:08:24,423 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0001 secs
2025-03-09 08:08:24,423 [INFO]: 	Selecting most promising index types given data characteristics 03/09/2025, 08:08:24
2025-03-09 08:08:24,423 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-09 08:08:24,424 [INFO]: 	Creating the index 03/09/2025, 08:08:24
2025-03-09 08:08:24,424 [INFO]: 		-> Instanciate the index HNSW15 03/09/2025, 08:08:24
2025-03-09 08:08:24,425 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0010 secs
2025-03-09 08:08:24,425 [INFO]: 		-> Adding the vectors to the index 03/09/2025, 08:08:24
2025-03-09 08:08:24,425 [INFO]: The memory available for adding the vectors is 49.3GB(total available - used by the index)
2025-03-09 08:08:24,425 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/15 [00:00<?, ?it/s]  7%|▋         | 1/15 [00:00<00:02,  5.21it/s] 13%|█▎        | 2/15 [00:00<00:01,  6.81it/s] 20%|██        | 3/15 [00:00<00:01,  7.51it/s] 27%|██▋       | 4/15 [00:00<00:01,  7.90it/s] 33%|███▎      | 5/15 [00:00<00:01,  8.16it/s] 40%|████      | 6/15 [00:00<00:01,  8.42it/s] 47%|████▋     | 7/15 [00:00<00:00,  8.51it/s] 53%|█████▎    | 8/15 [00:00<00:00,  8.65it/s] 60%|██████    | 9/15 [00:01<00:00,  8.77it/s] 67%|██████▋   | 10/15 [00:01<00:00,  8.95it/s] 73%|███████▎  | 11/15 [00:01<00:00,  9.07it/s] 80%|████████  | 12/15 [00:01<00:00,  9.17it/s] 87%|████████▋ | 13/15 [00:01<00:00,  9.25it/s] 93%|█████████▎| 14/15 [00:01<00:00,  9.27it/s]100%|██████████| 15/15 [00:03<00:00,  1.31it/s]100%|██████████| 15/15 [00:03<00:00,  3.83it/s]
2025-03-09 08:08:28,348 [INFO]: 	Computing best hyperparameters for index knn.index 03/09/2025, 08:08:28
2025-03-09 08:09:07,326 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 38.9778 secs
2025-03-09 08:09:07,326 [INFO]: The best hyperparameters are: efSearch=236
2025-03-09 08:09:07,327 [INFO]: 	Compute fast metrics 03/09/2025, 08:09:07
  0%|          | 0/4 [00:00<?, ?it/s] 25%|██▌       | 1/4 [00:00<00:00,  5.04it/s] 50%|█████     | 2/4 [00:00<00:00,  6.54it/s] 75%|███████▌  | 3/4 [00:00<00:00,  7.46it/s] 75%|███████▌  | 3/4 [00:00<00:00,  5.62it/s]
2025-03-09 08:09:26,136 [INFO]: 	>>> Finished "Compute fast metrics" in 18.8099 secs
2025-03-09 08:09:26,139 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 61.7146 secs
2025-03-09 08:09:26,139 [INFO]: {
2025-03-09 08:09:26,140 [INFO]: 	index_key: HNSW15
2025-03-09 08:09:26,140 [INFO]: 	index_param: efSearch=236
2025-03-09 08:09:26,140 [INFO]: 	index_path: knn.index
2025-03-09 08:09:26,140 [INFO]: 	size in bytes: 701785270
2025-03-09 08:09:26,140 [INFO]: 	avg_search_speed_ms: 9.3772657405002
2025-03-09 08:09:26,140 [INFO]: 	99p_search_speed_ms: 15.898321014828955
2025-03-09 08:09:26,140 [INFO]: 	reconstruction error %: 0.0
2025-03-09 08:09:26,140 [INFO]: 	nb vectors: 3567
2025-03-09 08:09:26,140 [INFO]: 	vectors dimension: 49152
2025-03-09 08:09:26,140 [INFO]: 	compression ratio: 0.9993095694356765
2025-03-09 08:09:26,140 [INFO]: }
2025-03-09 08:09:26,140 [INFO]: 	>>> Finished "Creating the index" in 61.7161 secs
2025-03-09 08:09:26,140 [INFO]: >>> Finished "Launching the whole pipeline" in 61.7421 secs
2025-03-09 08:09:27: [retrieval_preprocessing] calculating distances ...
2025-03-09 08:09:27: [retrieval_preprocessing] finished and saved retrieval indices for episode 37889 [episode count 0/20]
[retrieval_preprocessing] for episode 65036 [episode count 1/20], we have num_retrieval=np.int64(3528) num_query=np.int64(189)
2025-03-09 08:09:28,852 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-09 08:09:29,311 [INFO]: Launching the whole pipeline 03/09/2025, 08:09:29
2025-03-09 08:09:29,311 [INFO]: Reading total number of vectors and dimension 03/09/2025, 08:09:29
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1849.34it/s]
2025-03-09 08:09:29,335 [INFO]: There are 3528 embeddings of dim 49152
2025-03-09 08:09:29,335 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0242 secs
2025-03-09 08:09:29,335 [INFO]: 	Compute estimated construction time of the index 03/09/2025, 08:09:29
2025-03-09 08:09:29,336 [INFO]: 		-> Train: 16.7 minutes
2025-03-09 08:09:29,336 [INFO]: 		-> Add: 1.9 seconds
2025-03-09 08:09:29,336 [INFO]: 		Total: 16.7 minutes
2025-03-09 08:09:29,336 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0001 secs
2025-03-09 08:09:29,336 [INFO]: 	Checking that your have enough memory available to create the index 03/09/2025, 08:09:29
2025-03-09 08:09:29,336 [INFO]: 728.1MB of memory will be needed to build the index (more might be used if you have more)
2025-03-09 08:09:29,336 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0001 secs
2025-03-09 08:09:29,336 [INFO]: 	Selecting most promising index types given data characteristics 03/09/2025, 08:09:29
2025-03-09 08:09:29,336 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-09 08:09:29,336 [INFO]: 	Creating the index 03/09/2025, 08:09:29
2025-03-09 08:09:29,336 [INFO]: 		-> Instanciate the index HNSW15 03/09/2025, 08:09:29
2025-03-09 08:09:29,337 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0008 secs
2025-03-09 08:09:29,337 [INFO]: 		-> Adding the vectors to the index 03/09/2025, 08:09:29
2025-03-09 08:09:29,337 [INFO]: The memory available for adding the vectors is 49.4GB(total available - used by the index)
2025-03-09 08:09:29,337 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/14 [00:00<?, ?it/s]  7%|▋         | 1/14 [00:00<00:02,  5.91it/s] 21%|██▏       | 3/14 [00:00<00:01,  9.04it/s] 29%|██▊       | 4/14 [00:00<00:02,  4.81it/s] 36%|███▌      | 5/14 [00:00<00:01,  5.07it/s] 43%|████▎     | 6/14 [00:01<00:01,  5.98it/s] 50%|█████     | 7/14 [00:01<00:01,  6.65it/s] 57%|█████▋    | 8/14 [00:01<00:00,  7.17it/s] 64%|██████▍   | 9/14 [00:01<00:00,  7.55it/s] 79%|███████▊  | 11/14 [00:01<00:00,  8.90it/s] 86%|████████▌ | 12/14 [00:01<00:00,  9.01it/s]100%|██████████| 14/14 [00:04<00:00,  1.78it/s]100%|██████████| 14/14 [00:04<00:00,  3.46it/s]
2025-03-09 08:09:33,388 [INFO]: 	Computing best hyperparameters for index knn.index 03/09/2025, 08:09:33
2025-03-09 08:10:07,641 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 34.2522 secs
2025-03-09 08:10:07,641 [INFO]: The best hyperparameters are: efSearch=192
2025-03-09 08:10:07,641 [INFO]: 	Compute fast metrics 03/09/2025, 08:10:07
  0%|          | 0/4 [00:00<?, ?it/s] 25%|██▌       | 1/4 [00:00<00:00,  5.91it/s] 50%|█████     | 2/4 [00:00<00:00,  7.41it/s] 75%|███████▌  | 3/4 [00:00<00:00,  8.08it/s] 75%|███████▌  | 3/4 [00:00<00:00,  6.12it/s]
2025-03-09 08:10:26,358 [INFO]: 	>>> Finished "Compute fast metrics" in 18.7164 secs
2025-03-09 08:10:26,362 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 57.0248 secs
2025-03-09 08:10:26,362 [INFO]: {
2025-03-09 08:10:26,362 [INFO]: 	index_key: HNSW15
2025-03-09 08:10:26,362 [INFO]: 	index_param: efSearch=192
2025-03-09 08:10:26,362 [INFO]: 	index_path: knn.index
2025-03-09 08:10:26,362 [INFO]: 	size in bytes: 694112290
2025-03-09 08:10:26,362 [INFO]: 	avg_search_speed_ms: 7.5750254759579105
2025-03-09 08:10:26,362 [INFO]: 	99p_search_speed_ms: 11.597530974540856
2025-03-09 08:10:26,362 [INFO]: 	reconstruction error %: 0.0
2025-03-09 08:10:26,362 [INFO]: 	nb vectors: 3528
2025-03-09 08:10:26,362 [INFO]: 	vectors dimension: 49152
2025-03-09 08:10:26,362 [INFO]: 	compression ratio: 0.9993095267049659
2025-03-09 08:10:26,362 [INFO]: }
2025-03-09 08:10:26,362 [INFO]: 	>>> Finished "Creating the index" in 57.0260 secs
2025-03-09 08:10:26,362 [INFO]: >>> Finished "Launching the whole pipeline" in 57.0508 secs
2025-03-09 08:10:27: [retrieval_preprocessing] calculating distances ...
2025-03-09 08:10:27: [retrieval_preprocessing] finished and saved retrieval indices for episode 65036 [episode count 1/20]
[retrieval_preprocessing] for episode 89101 [episode count 2/20], we have num_retrieval=np.int64(3550) num_query=np.int64(167)
2025-03-09 08:10:28,661 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-09 08:10:29,142 [INFO]: Launching the whole pipeline 03/09/2025, 08:10:29
2025-03-09 08:10:29,142 [INFO]: Reading total number of vectors and dimension 03/09/2025, 08:10:29
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 2218.03it/s]
2025-03-09 08:10:29,166 [INFO]: There are 3550 embeddings of dim 49152
2025-03-09 08:10:29,166 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0237 secs
2025-03-09 08:10:29,166 [INFO]: 	Compute estimated construction time of the index 03/09/2025, 08:10:29
2025-03-09 08:10:29,166 [INFO]: 		-> Train: 16.7 minutes
2025-03-09 08:10:29,166 [INFO]: 		-> Add: 2.0 seconds
2025-03-09 08:10:29,166 [INFO]: 		Total: 16.7 minutes
2025-03-09 08:10:29,166 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0001 secs
2025-03-09 08:10:29,166 [INFO]: 	Checking that your have enough memory available to create the index 03/09/2025, 08:10:29
2025-03-09 08:10:29,166 [INFO]: 732.6MB of memory will be needed to build the index (more might be used if you have more)
2025-03-09 08:10:29,167 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0001 secs
2025-03-09 08:10:29,167 [INFO]: 	Selecting most promising index types given data characteristics 03/09/2025, 08:10:29
2025-03-09 08:10:29,167 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-09 08:10:29,167 [INFO]: 	Creating the index 03/09/2025, 08:10:29
2025-03-09 08:10:29,167 [INFO]: 		-> Instanciate the index HNSW15 03/09/2025, 08:10:29
2025-03-09 08:10:29,168 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0009 secs
2025-03-09 08:10:29,168 [INFO]: 		-> Adding the vectors to the index 03/09/2025, 08:10:29
2025-03-09 08:10:29,168 [INFO]: The memory available for adding the vectors is 49.3GB(total available - used by the index)
2025-03-09 08:10:29,168 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/14 [00:00<?, ?it/s]  7%|▋         | 1/14 [00:00<00:02,  6.32it/s] 43%|████▎     | 6/14 [00:00<00:00, 24.92it/s] 64%|██████▍   | 9/14 [00:00<00:00, 24.02it/s] 86%|████████▌ | 12/14 [00:00<00:00, 17.18it/s]100%|██████████| 14/14 [00:03<00:00,  3.91it/s]
2025-03-09 08:10:32,759 [INFO]: 	Computing best hyperparameters for index knn.index 03/09/2025, 08:10:32
2025-03-09 08:11:07,253 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 34.4934 secs
2025-03-09 08:11:07,253 [INFO]: The best hyperparameters are: efSearch=199
2025-03-09 08:11:07,253 [INFO]: 	Compute fast metrics 03/09/2025, 08:11:07
  0%|          | 0/4 [00:00<?, ?it/s] 25%|██▌       | 1/4 [00:00<00:00,  5.97it/s] 50%|█████     | 2/4 [00:00<00:00,  7.41it/s] 75%|███████▌  | 3/4 [00:00<00:00,  7.80it/s] 75%|███████▌  | 3/4 [00:00<00:00,  5.85it/s]
2025-03-09 08:11:24,936 [INFO]: 	>>> Finished "Compute fast metrics" in 17.6824 secs
2025-03-09 08:11:24,938 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 55.7704 secs
2025-03-09 08:11:24,938 [INFO]: {
2025-03-09 08:11:24,938 [INFO]: 	index_key: HNSW15
2025-03-09 08:11:24,938 [INFO]: 	index_param: efSearch=199
2025-03-09 08:11:24,938 [INFO]: 	index_path: knn.index
2025-03-09 08:11:24,938 [INFO]: 	size in bytes: 698440690
2025-03-09 08:11:24,938 [INFO]: 	avg_search_speed_ms: 8.397315746903619
2025-03-09 08:11:24,938 [INFO]: 	99p_search_speed_ms: 15.245036059059144
2025-03-09 08:11:24,938 [INFO]: 	reconstruction error %: 0.0
2025-03-09 08:11:24,938 [INFO]: 	nb vectors: 3550
2025-03-09 08:11:24,938 [INFO]: 	vectors dimension: 49152
2025-03-09 08:11:24,938 [INFO]: 	compression ratio: 0.9993094760845047
2025-03-09 08:11:24,938 [INFO]: }
2025-03-09 08:11:24,939 [INFO]: 	>>> Finished "Creating the index" in 55.7719 secs
2025-03-09 08:11:24,939 [INFO]: >>> Finished "Launching the whole pipeline" in 55.7961 secs
2025-03-09 08:11:25: [retrieval_preprocessing] calculating distances ...
2025-03-09 08:11:26: [retrieval_preprocessing] finished and saved retrieval indices for episode 89101 [episode count 2/20]
[retrieval_preprocessing] for episode 95250 [episode count 3/20], we have num_retrieval=np.int64(3444) num_query=np.int64(273)
2025-03-09 08:11:28,139 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-09 08:11:28,667 [INFO]: Launching the whole pipeline 03/09/2025, 08:11:28
2025-03-09 08:11:28,667 [INFO]: Reading total number of vectors and dimension 03/09/2025, 08:11:28
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1452.32it/s]
2025-03-09 08:11:28,701 [INFO]: There are 3444 embeddings of dim 49152
2025-03-09 08:11:28,701 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0346 secs
2025-03-09 08:11:28,701 [INFO]: 	Compute estimated construction time of the index 03/09/2025, 08:11:28
2025-03-09 08:11:28,701 [INFO]: 		-> Train: 16.7 minutes
2025-03-09 08:11:28,701 [INFO]: 		-> Add: 1.9 seconds
2025-03-09 08:11:28,701 [INFO]: 		Total: 16.7 minutes
2025-03-09 08:11:28,701 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0001 secs
2025-03-09 08:11:28,701 [INFO]: 	Checking that your have enough memory available to create the index 03/09/2025, 08:11:28
2025-03-09 08:11:28,702 [INFO]: 710.8MB of memory will be needed to build the index (more might be used if you have more)
2025-03-09 08:11:28,702 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0001 secs
2025-03-09 08:11:28,702 [INFO]: 	Selecting most promising index types given data characteristics 03/09/2025, 08:11:28
2025-03-09 08:11:28,702 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-09 08:11:28,702 [INFO]: 	Creating the index 03/09/2025, 08:11:28
2025-03-09 08:11:28,702 [INFO]: 		-> Instanciate the index HNSW15 03/09/2025, 08:11:28
2025-03-09 08:11:28,703 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0009 secs
2025-03-09 08:11:28,703 [INFO]: 		-> Adding the vectors to the index 03/09/2025, 08:11:28
2025-03-09 08:11:28,703 [INFO]: The memory available for adding the vectors is 49.4GB(total available - used by the index)
2025-03-09 08:11:28,703 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/14 [00:00<?, ?it/s]  7%|▋         | 1/14 [00:00<00:02,  6.03it/s] 21%|██▏       | 3/14 [00:00<00:01,  9.39it/s] 36%|███▌      | 5/14 [00:00<00:00, 10.66it/s] 50%|█████     | 7/14 [00:00<00:00, 11.00it/s] 64%|██████▍   | 9/14 [00:00<00:00, 11.76it/s] 79%|███████▊  | 11/14 [00:01<00:00, 11.57it/s] 93%|█████████▎| 13/14 [00:01<00:00, 11.41it/s]100%|██████████| 14/14 [00:03<00:00,  3.76it/s]
2025-03-09 08:11:32,424 [INFO]: 	Computing best hyperparameters for index knn.index 03/09/2025, 08:11:32
2025-03-09 08:12:05,050 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 32.6258 secs
2025-03-09 08:12:05,050 [INFO]: The best hyperparameters are: efSearch=154
2025-03-09 08:12:05,051 [INFO]: 	Compute fast metrics 03/09/2025, 08:12:05
  0%|          | 0/4 [00:00<?, ?it/s] 25%|██▌       | 1/4 [00:00<00:00,  5.97it/s] 75%|███████▌  | 3/4 [00:00<00:00,  9.62it/s] 75%|███████▌  | 3/4 [00:00<00:00,  7.36it/s]
2025-03-09 08:12:19,420 [INFO]: 	>>> Finished "Compute fast metrics" in 14.3694 secs
2025-03-09 08:12:19,422 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 50.7193 secs
2025-03-09 08:12:19,422 [INFO]: {
2025-03-09 08:12:19,422 [INFO]: 	index_key: HNSW15
2025-03-09 08:12:19,422 [INFO]: 	index_param: efSearch=154
2025-03-09 08:12:19,422 [INFO]: 	index_path: knn.index
2025-03-09 08:12:19,422 [INFO]: 	size in bytes: 677585950
2025-03-09 08:12:19,422 [INFO]: 	avg_search_speed_ms: 6.745115378287127
2025-03-09 08:12:19,422 [INFO]: 	99p_search_speed_ms: 10.781432543881243
2025-03-09 08:12:19,422 [INFO]: 	reconstruction error %: 0.0
2025-03-09 08:12:19,423 [INFO]: 	nb vectors: 3444
2025-03-09 08:12:19,423 [INFO]: 	vectors dimension: 49152
2025-03-09 08:12:19,423 [INFO]: 	compression ratio: 0.9993093156668906
2025-03-09 08:12:19,423 [INFO]: }
2025-03-09 08:12:19,423 [INFO]: 	>>> Finished "Creating the index" in 50.7208 secs
2025-03-09 08:12:19,423 [INFO]: >>> Finished "Launching the whole pipeline" in 50.7560 secs
2025-03-09 08:12:20: [retrieval_preprocessing] calculating distances ...
2025-03-09 08:12:20: [retrieval_preprocessing] finished and saved retrieval indices for episode 95250 [episode count 3/20]
[retrieval_preprocessing] for episode 36886 [episode count 4/20], we have num_retrieval=np.int64(3553) num_query=np.int64(164)
2025-03-09 08:12:21,930 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-09 08:12:22,420 [INFO]: Launching the whole pipeline 03/09/2025, 08:12:22
2025-03-09 08:12:22,420 [INFO]: Reading total number of vectors and dimension 03/09/2025, 08:12:22
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 2267.19it/s]
2025-03-09 08:12:22,443 [INFO]: There are 3553 embeddings of dim 49152
2025-03-09 08:12:22,443 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0234 secs
2025-03-09 08:12:22,443 [INFO]: 	Compute estimated construction time of the index 03/09/2025, 08:12:22
2025-03-09 08:12:22,443 [INFO]: 		-> Train: 16.7 minutes
2025-03-09 08:12:22,443 [INFO]: 		-> Add: 2.0 seconds
2025-03-09 08:12:22,443 [INFO]: 		Total: 16.7 minutes
2025-03-09 08:12:22,443 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0001 secs
2025-03-09 08:12:22,444 [INFO]: 	Checking that your have enough memory available to create the index 03/09/2025, 08:12:22
2025-03-09 08:12:22,444 [INFO]: 733.3MB of memory will be needed to build the index (more might be used if you have more)
2025-03-09 08:12:22,444 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0001 secs
2025-03-09 08:12:22,444 [INFO]: 	Selecting most promising index types given data characteristics 03/09/2025, 08:12:22
2025-03-09 08:12:22,444 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-09 08:12:22,444 [INFO]: 	Creating the index 03/09/2025, 08:12:22
2025-03-09 08:12:22,444 [INFO]: 		-> Instanciate the index HNSW15 03/09/2025, 08:12:22
2025-03-09 08:12:22,445 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0011 secs
2025-03-09 08:12:22,445 [INFO]: 		-> Adding the vectors to the index 03/09/2025, 08:12:22
2025-03-09 08:12:22,445 [INFO]: The memory available for adding the vectors is 49.3GB(total available - used by the index)
2025-03-09 08:12:22,445 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/14 [00:00<?, ?it/s]  7%|▋         | 1/14 [00:00<00:02,  6.27it/s] 21%|██▏       | 3/14 [00:00<00:01,  9.87it/s] 36%|███▌      | 5/14 [00:00<00:00, 11.05it/s] 50%|█████     | 7/14 [00:00<00:00, 11.52it/s] 64%|██████▍   | 9/14 [00:00<00:00, 11.91it/s] 79%|███████▊  | 11/14 [00:00<00:00, 12.03it/s] 93%|█████████▎| 13/14 [00:01<00:00, 12.17it/s]100%|██████████| 14/14 [00:03<00:00,  3.95it/s]
2025-03-09 08:12:26,003 [INFO]: 	Computing best hyperparameters for index knn.index 03/09/2025, 08:12:26
2025-03-09 08:12:57,895 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 31.8908 secs
2025-03-09 08:12:57,895 [INFO]: The best hyperparameters are: efSearch=157
2025-03-09 08:12:57,895 [INFO]: 	Compute fast metrics 03/09/2025, 08:12:57
  0%|          | 0/4 [00:00<?, ?it/s] 25%|██▌       | 1/4 [00:00<00:00,  7.80it/s] 75%|███████▌  | 3/4 [00:00<00:00, 10.84it/s] 75%|███████▌  | 3/4 [00:00<00:00,  8.34it/s]
2025-03-09 08:13:16,365 [INFO]: 	>>> Finished "Compute fast metrics" in 18.4700 secs
2025-03-09 08:13:16,800 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 54.3548 secs
2025-03-09 08:13:16,800 [INFO]: {
2025-03-09 08:13:16,800 [INFO]: 	index_key: HNSW15
2025-03-09 08:13:16,800 [INFO]: 	index_param: efSearch=157
2025-03-09 08:13:16,800 [INFO]: 	index_path: knn.index
2025-03-09 08:13:16,800 [INFO]: 	size in bytes: 699030910
2025-03-09 08:13:16,800 [INFO]: 	avg_search_speed_ms: 7.773180010085447
2025-03-09 08:13:16,801 [INFO]: 	99p_search_speed_ms: 14.631015504710392
2025-03-09 08:13:16,801 [INFO]: 	reconstruction error %: 0.0
2025-03-09 08:13:16,801 [INFO]: 	nb vectors: 3553
2025-03-09 08:13:16,801 [INFO]: 	vectors dimension: 49152
2025-03-09 08:13:16,801 [INFO]: 	compression ratio: 0.9993094926231517
2025-03-09 08:13:16,801 [INFO]: }
2025-03-09 08:13:16,801 [INFO]: 	>>> Finished "Creating the index" in 54.3570 secs
2025-03-09 08:13:16,801 [INFO]: >>> Finished "Launching the whole pipeline" in 54.3811 secs
2025-03-09 08:13:17: [retrieval_preprocessing] calculating distances ...
2025-03-09 08:13:17: [retrieval_preprocessing] finished and saved retrieval indices for episode 36886 [episode count 4/20]
[retrieval_preprocessing] for episode 5655 [episode count 5/20], we have num_retrieval=np.int64(3505) num_query=np.int64(212)
2025-03-09 08:13:18,972 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-09 08:13:19,532 [INFO]: Launching the whole pipeline 03/09/2025, 08:13:19
2025-03-09 08:13:19,533 [INFO]: Reading total number of vectors and dimension 03/09/2025, 08:13:19
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 2286.97it/s]
2025-03-09 08:13:19,558 [INFO]: There are 3505 embeddings of dim 49152
2025-03-09 08:13:19,559 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0260 secs
2025-03-09 08:13:19,559 [INFO]: 	Compute estimated construction time of the index 03/09/2025, 08:13:19
2025-03-09 08:13:19,559 [INFO]: 		-> Train: 16.7 minutes
2025-03-09 08:13:19,559 [INFO]: 		-> Add: 1.9 seconds
2025-03-09 08:13:19,559 [INFO]: 		Total: 16.7 minutes
2025-03-09 08:13:19,559 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0003 secs
2025-03-09 08:13:19,559 [INFO]: 	Checking that your have enough memory available to create the index 03/09/2025, 08:13:19
2025-03-09 08:13:19,560 [INFO]: 723.3MB of memory will be needed to build the index (more might be used if you have more)
2025-03-09 08:13:19,560 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0004 secs
2025-03-09 08:13:19,560 [INFO]: 	Selecting most promising index types given data characteristics 03/09/2025, 08:13:19
2025-03-09 08:13:19,560 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-09 08:13:19,560 [INFO]: 	Creating the index 03/09/2025, 08:13:19
2025-03-09 08:13:19,560 [INFO]: 		-> Instanciate the index HNSW15 03/09/2025, 08:13:19
2025-03-09 08:13:19,563 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0027 secs
2025-03-09 08:13:19,563 [INFO]: 		-> Adding the vectors to the index 03/09/2025, 08:13:19
2025-03-09 08:13:19,563 [INFO]: The memory available for adding the vectors is 49.4GB(total available - used by the index)
2025-03-09 08:13:19,564 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/14 [00:00<?, ?it/s]  7%|▋         | 1/14 [00:00<00:02,  5.71it/s] 14%|█▍        | 2/14 [00:00<00:01,  7.51it/s] 21%|██▏       | 3/14 [00:00<00:01,  7.99it/s] 29%|██▊       | 4/14 [00:00<00:01,  8.32it/s] 36%|███▌      | 5/14 [00:00<00:01,  8.63it/s] 43%|████▎     | 6/14 [00:00<00:00,  8.95it/s] 50%|█████     | 7/14 [00:00<00:00,  9.20it/s] 57%|█████▋    | 8/14 [00:00<00:00,  9.35it/s] 64%|██████▍   | 9/14 [00:01<00:00,  9.46it/s] 71%|███████▏  | 10/14 [00:01<00:00,  9.53it/s] 79%|███████▊  | 11/14 [00:01<00:00,  9.57it/s] 86%|████████▌ | 12/14 [00:01<00:00,  9.27it/s] 93%|█████████▎| 13/14 [00:01<00:00,  9.06it/s]100%|██████████| 14/14 [00:04<00:00,  1.09it/s]100%|██████████| 14/14 [00:04<00:00,  3.30it/s]
2025-03-09 08:13:23,819 [INFO]: 	Computing best hyperparameters for index knn.index 03/09/2025, 08:13:23
2025-03-09 08:14:02,304 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 38.4846 secs
2025-03-09 08:14:02,305 [INFO]: The best hyperparameters are: efSearch=244
2025-03-09 08:14:02,305 [INFO]: 	Compute fast metrics 03/09/2025, 08:14:02
  0%|          | 0/4 [00:00<?, ?it/s] 25%|██▌       | 1/4 [00:00<00:00,  5.10it/s] 50%|█████     | 2/4 [00:00<00:00,  6.86it/s] 75%|███████▌  | 3/4 [00:00<00:00,  7.59it/s] 75%|███████▌  | 3/4 [00:00<00:00,  5.65it/s]
2025-03-09 08:14:22,972 [INFO]: 	>>> Finished "Compute fast metrics" in 20.6667 secs
2025-03-09 08:14:22,974 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 63.4103 secs
2025-03-09 08:14:22,974 [INFO]: {
2025-03-09 08:14:22,974 [INFO]: 	index_key: HNSW15
2025-03-09 08:14:22,974 [INFO]: 	index_param: efSearch=244
2025-03-09 08:14:22,974 [INFO]: 	index_path: knn.index
2025-03-09 08:14:22,974 [INFO]: 	size in bytes: 689587210
2025-03-09 08:14:22,974 [INFO]: 	avg_search_speed_ms: 10.584263881254527
2025-03-09 08:14:22,974 [INFO]: 	99p_search_speed_ms: 21.633201353251877
2025-03-09 08:14:22,974 [INFO]: 	reconstruction error %: 0.0
2025-03-09 08:14:22,974 [INFO]: 	nb vectors: 3505
2025-03-09 08:14:22,974 [INFO]: 	vectors dimension: 49152
2025-03-09 08:14:22,974 [INFO]: 	compression ratio: 0.9993094854528987
2025-03-09 08:14:22,974 [INFO]: }
2025-03-09 08:14:22,974 [INFO]: 	>>> Finished "Creating the index" in 63.4138 secs
2025-03-09 08:14:22,974 [INFO]: >>> Finished "Launching the whole pipeline" in 63.4415 secs
2025-03-09 08:14:24: [retrieval_preprocessing] calculating distances ...
2025-03-09 08:14:24: [retrieval_preprocessing] finished and saved retrieval indices for episode 5655 [episode count 5/20]
[retrieval_preprocessing] for episode 27683 [episode count 6/20], we have num_retrieval=np.int64(3540) num_query=np.int64(177)
2025-03-09 08:14:26,096 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-09 08:14:26,575 [INFO]: Launching the whole pipeline 03/09/2025, 08:14:26
2025-03-09 08:14:26,575 [INFO]: Reading total number of vectors and dimension 03/09/2025, 08:14:26
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1897.88it/s]
2025-03-09 08:14:26,599 [INFO]: There are 3540 embeddings of dim 49152
2025-03-09 08:14:26,599 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0242 secs
2025-03-09 08:14:26,599 [INFO]: 	Compute estimated construction time of the index 03/09/2025, 08:14:26
2025-03-09 08:14:26,599 [INFO]: 		-> Train: 16.7 minutes
2025-03-09 08:14:26,599 [INFO]: 		-> Add: 1.9 seconds
2025-03-09 08:14:26,599 [INFO]: 		Total: 16.7 minutes
2025-03-09 08:14:26,599 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0001 secs
2025-03-09 08:14:26,599 [INFO]: 	Checking that your have enough memory available to create the index 03/09/2025, 08:14:26
2025-03-09 08:14:26,599 [INFO]: 730.6MB of memory will be needed to build the index (more might be used if you have more)
2025-03-09 08:14:26,600 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0001 secs
2025-03-09 08:14:26,600 [INFO]: 	Selecting most promising index types given data characteristics 03/09/2025, 08:14:26
2025-03-09 08:14:26,600 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-09 08:14:26,600 [INFO]: 	Creating the index 03/09/2025, 08:14:26
2025-03-09 08:14:26,600 [INFO]: 		-> Instanciate the index HNSW15 03/09/2025, 08:14:26
2025-03-09 08:14:26,601 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0009 secs
2025-03-09 08:14:26,601 [INFO]: 		-> Adding the vectors to the index 03/09/2025, 08:14:26
2025-03-09 08:14:26,601 [INFO]: The memory available for adding the vectors is 49.4GB(total available - used by the index)
2025-03-09 08:14:26,601 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/14 [00:00<?, ?it/s]  7%|▋         | 1/14 [00:00<00:02,  5.69it/s] 21%|██▏       | 3/14 [00:00<00:01,  9.37it/s] 36%|███▌      | 5/14 [00:00<00:00, 10.79it/s] 50%|█████     | 7/14 [00:00<00:00, 11.40it/s] 64%|██████▍   | 9/14 [00:00<00:00, 11.74it/s] 79%|███████▊  | 11/14 [00:00<00:00, 11.86it/s] 93%|█████████▎| 13/14 [00:01<00:00, 12.01it/s]100%|██████████| 14/14 [00:04<00:00,  3.37it/s]
2025-03-09 08:14:30,767 [INFO]: 	Computing best hyperparameters for index knn.index 03/09/2025, 08:14:30
2025-03-09 08:15:11,915 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 41.1470 secs
2025-03-09 08:15:11,915 [INFO]: The best hyperparameters are: efSearch=189
2025-03-09 08:15:11,915 [INFO]: 	Compute fast metrics 03/09/2025, 08:15:11
  0%|          | 0/4 [00:00<?, ?it/s] 25%|██▌       | 1/4 [00:00<00:00,  5.91it/s] 50%|█████     | 2/4 [00:00<00:00,  7.64it/s] 75%|███████▌  | 3/4 [00:00<00:00,  8.44it/s] 75%|███████▌  | 3/4 [00:00<00:00,  6.40it/s]
2025-03-09 08:15:31,057 [INFO]: 	>>> Finished "Compute fast metrics" in 19.1416 secs
2025-03-09 08:15:31,342 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 64.7410 secs
2025-03-09 08:15:31,342 [INFO]: {
2025-03-09 08:15:31,342 [INFO]: 	index_key: HNSW15
2025-03-09 08:15:31,342 [INFO]: 	index_param: efSearch=189
2025-03-09 08:15:31,342 [INFO]: 	index_path: knn.index
2025-03-09 08:15:31,342 [INFO]: 	size in bytes: 696473170
2025-03-09 08:15:31,342 [INFO]: 	avg_search_speed_ms: 8.752146424124325
2025-03-09 08:15:31,343 [INFO]: 	99p_search_speed_ms: 17.288112351670858
2025-03-09 08:15:31,343 [INFO]: 	reconstruction error %: 0.0
2025-03-09 08:15:31,343 [INFO]: 	nb vectors: 3540
2025-03-09 08:15:31,343 [INFO]: 	vectors dimension: 49152
2025-03-09 08:15:31,343 [INFO]: 	compression ratio: 0.9993095929309093
2025-03-09 08:15:31,343 [INFO]: }
2025-03-09 08:15:31,343 [INFO]: 	>>> Finished "Creating the index" in 64.7431 secs
2025-03-09 08:15:31,343 [INFO]: >>> Finished "Launching the whole pipeline" in 64.7680 secs
2025-03-09 08:15:32: [retrieval_preprocessing] calculating distances ...
2025-03-09 08:15:32: [retrieval_preprocessing] finished and saved retrieval indices for episode 27683 [episode count 6/20]
[retrieval_preprocessing] for episode 34348 [episode count 7/20], we have num_retrieval=np.int64(3507) num_query=np.int64(210)
2025-03-09 08:15:33,766 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-09 08:15:34,260 [INFO]: Launching the whole pipeline 03/09/2025, 08:15:34
2025-03-09 08:15:34,260 [INFO]: Reading total number of vectors and dimension 03/09/2025, 08:15:34
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1267.93it/s]
2025-03-09 08:15:34,286 [INFO]: There are 3507 embeddings of dim 49152
2025-03-09 08:15:34,286 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0256 secs
2025-03-09 08:15:34,286 [INFO]: 	Compute estimated construction time of the index 03/09/2025, 08:15:34
2025-03-09 08:15:34,286 [INFO]: 		-> Train: 16.7 minutes
2025-03-09 08:15:34,286 [INFO]: 		-> Add: 1.9 seconds
2025-03-09 08:15:34,286 [INFO]: 		Total: 16.7 minutes
2025-03-09 08:15:34,286 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0001 secs
2025-03-09 08:15:34,286 [INFO]: 	Checking that your have enough memory available to create the index 03/09/2025, 08:15:34
2025-03-09 08:15:34,286 [INFO]: 723.8MB of memory will be needed to build the index (more might be used if you have more)
2025-03-09 08:15:34,286 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0002 secs
2025-03-09 08:15:34,286 [INFO]: 	Selecting most promising index types given data characteristics 03/09/2025, 08:15:34
2025-03-09 08:15:34,286 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-09 08:15:34,286 [INFO]: 	Creating the index 03/09/2025, 08:15:34
2025-03-09 08:15:34,287 [INFO]: 		-> Instanciate the index HNSW15 03/09/2025, 08:15:34
2025-03-09 08:15:34,288 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0010 secs
2025-03-09 08:15:34,288 [INFO]: 		-> Adding the vectors to the index 03/09/2025, 08:15:34
2025-03-09 08:15:34,288 [INFO]: The memory available for adding the vectors is 49.4GB(total available - used by the index)
2025-03-09 08:15:34,288 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/14 [00:00<?, ?it/s]  7%|▋         | 1/14 [00:00<00:02,  6.17it/s] 21%|██▏       | 3/14 [00:00<00:01,  9.49it/s] 36%|███▌      | 5/14 [00:00<00:00, 10.60it/s] 50%|█████     | 7/14 [00:00<00:00, 11.06it/s] 64%|██████▍   | 9/14 [00:00<00:00, 11.24it/s] 79%|███████▊  | 11/14 [00:01<00:00, 11.50it/s] 93%|█████████▎| 13/14 [00:01<00:00, 11.74it/s]100%|██████████| 14/14 [00:03<00:00,  3.79it/s]
2025-03-09 08:15:37,987 [INFO]: 	Computing best hyperparameters for index knn.index 03/09/2025, 08:15:37
2025-03-09 08:16:11,181 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 33.1939 secs
2025-03-09 08:16:11,181 [INFO]: The best hyperparameters are: efSearch=193
2025-03-09 08:16:11,181 [INFO]: 	Compute fast metrics 03/09/2025, 08:16:11
  0%|          | 0/4 [00:00<?, ?it/s] 25%|██▌       | 1/4 [00:00<00:00,  6.10it/s] 75%|███████▌  | 3/4 [00:00<00:00,  9.92it/s] 75%|███████▌  | 3/4 [00:00<00:00,  7.58it/s]
2025-03-09 08:16:30,591 [INFO]: 	>>> Finished "Compute fast metrics" in 19.4097 secs
2025-03-09 08:16:30,593 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 56.3057 secs
2025-03-09 08:16:30,594 [INFO]: {
2025-03-09 08:16:30,594 [INFO]: 	index_key: HNSW15
2025-03-09 08:16:30,594 [INFO]: 	index_param: efSearch=193
2025-03-09 08:16:30,594 [INFO]: 	index_path: knn.index
2025-03-09 08:16:30,594 [INFO]: 	size in bytes: 689980690
2025-03-09 08:16:30,594 [INFO]: 	avg_search_speed_ms: 8.80928161905744
2025-03-09 08:16:30,594 [INFO]: 	99p_search_speed_ms: 15.706136671360586
2025-03-09 08:16:30,594 [INFO]: 	reconstruction error %: 0.0
2025-03-09 08:16:30,594 [INFO]: 	nb vectors: 3507
2025-03-09 08:16:30,594 [INFO]: 	vectors dimension: 49152
2025-03-09 08:16:30,594 [INFO]: 	compression ratio: 0.9993094966179416
2025-03-09 08:16:30,594 [INFO]: }
2025-03-09 08:16:30,594 [INFO]: 	>>> Finished "Creating the index" in 56.3072 secs
2025-03-09 08:16:30,594 [INFO]: >>> Finished "Launching the whole pipeline" in 56.3335 secs
2025-03-09 08:16:31: [retrieval_preprocessing] calculating distances ...
2025-03-09 08:16:32: [retrieval_preprocessing] finished and saved retrieval indices for episode 34348 [episode count 7/20]
[retrieval_preprocessing] for episode 50734 [episode count 8/20], we have num_retrieval=np.int64(3574) num_query=np.int64(143)
2025-03-09 08:16:33,533 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-09 08:16:33,998 [INFO]: Launching the whole pipeline 03/09/2025, 08:16:33
2025-03-09 08:16:33,998 [INFO]: Reading total number of vectors and dimension 03/09/2025, 08:16:33
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1929.30it/s]
2025-03-09 08:16:34,022 [INFO]: There are 3574 embeddings of dim 49152
2025-03-09 08:16:34,022 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0237 secs
2025-03-09 08:16:34,022 [INFO]: 	Compute estimated construction time of the index 03/09/2025, 08:16:34
2025-03-09 08:16:34,022 [INFO]: 		-> Train: 16.7 minutes
2025-03-09 08:16:34,022 [INFO]: 		-> Add: 2.0 seconds
2025-03-09 08:16:34,022 [INFO]: 		Total: 16.7 minutes
2025-03-09 08:16:34,022 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0001 secs
2025-03-09 08:16:34,022 [INFO]: 	Checking that your have enough memory available to create the index 03/09/2025, 08:16:34
2025-03-09 08:16:34,022 [INFO]: 737.6MB of memory will be needed to build the index (more might be used if you have more)
2025-03-09 08:16:34,022 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0001 secs
2025-03-09 08:16:34,022 [INFO]: 	Selecting most promising index types given data characteristics 03/09/2025, 08:16:34
2025-03-09 08:16:34,022 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-09 08:16:34,022 [INFO]: 	Creating the index 03/09/2025, 08:16:34
2025-03-09 08:16:34,022 [INFO]: 		-> Instanciate the index HNSW15 03/09/2025, 08:16:34
2025-03-09 08:16:34,023 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0009 secs
2025-03-09 08:16:34,023 [INFO]: 		-> Adding the vectors to the index 03/09/2025, 08:16:34
2025-03-09 08:16:34,023 [INFO]: The memory available for adding the vectors is 49.3GB(total available - used by the index)
2025-03-09 08:16:34,023 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/15 [00:00<?, ?it/s]  7%|▋         | 1/15 [00:00<00:02,  6.33it/s] 20%|██        | 3/15 [00:00<00:01, 10.20it/s] 33%|███▎      | 5/15 [00:00<00:00, 11.63it/s] 47%|████▋     | 7/15 [00:00<00:00, 12.18it/s] 60%|██████    | 9/15 [00:00<00:00, 12.65it/s] 73%|███████▎  | 11/15 [00:00<00:00, 12.61it/s] 87%|████████▋ | 13/15 [00:01<00:00, 12.50it/s]100%|██████████| 15/15 [00:03<00:00,  2.03it/s]100%|██████████| 15/15 [00:03<00:00,  3.94it/s]
2025-03-09 08:16:37,839 [INFO]: 	Computing best hyperparameters for index knn.index 03/09/2025, 08:16:37
2025-03-09 08:17:18,023 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 40.1834 secs
2025-03-09 08:17:18,023 [INFO]: The best hyperparameters are: efSearch=158
2025-03-09 08:17:18,023 [INFO]: 	Compute fast metrics 03/09/2025, 08:17:18
  0%|          | 0/4 [00:00<?, ?it/s] 25%|██▌       | 1/4 [00:00<00:00,  5.43it/s] 50%|█████     | 2/4 [00:00<00:00,  7.24it/s] 75%|███████▌  | 3/4 [00:00<00:00,  8.09it/s] 75%|███████▌  | 3/4 [00:00<00:00,  6.04it/s]
2025-03-09 08:17:35,070 [INFO]: 	>>> Finished "Compute fast metrics" in 17.0464 secs
2025-03-09 08:17:35,072 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 61.0489 secs
2025-03-09 08:17:35,072 [INFO]: {
2025-03-09 08:17:35,072 [INFO]: 	index_key: HNSW15
2025-03-09 08:17:35,072 [INFO]: 	index_param: efSearch=158
2025-03-09 08:17:35,072 [INFO]: 	index_path: knn.index
2025-03-09 08:17:35,072 [INFO]: 	size in bytes: 703162450
2025-03-09 08:17:35,072 [INFO]: 	avg_search_speed_ms: 7.636432980263365
2025-03-09 08:17:35,072 [INFO]: 	99p_search_speed_ms: 15.57673218660057
2025-03-09 08:17:35,072 [INFO]: 	reconstruction error %: 0.0
2025-03-09 08:17:35,072 [INFO]: 	nb vectors: 3574
2025-03-09 08:17:35,072 [INFO]: 	vectors dimension: 49152
2025-03-09 08:17:35,072 [INFO]: 	compression ratio: 0.999309607616277
2025-03-09 08:17:35,073 [INFO]: }
2025-03-09 08:17:35,073 [INFO]: 	>>> Finished "Creating the index" in 61.0503 secs
2025-03-09 08:17:35,073 [INFO]: >>> Finished "Launching the whole pipeline" in 61.0746 secs
2025-03-09 08:17:35: [retrieval_preprocessing] calculating distances ...
2025-03-09 08:17:35: [retrieval_preprocessing] finished and saved retrieval indices for episode 50734 [episode count 8/20]
[retrieval_preprocessing] for episode 64559 [episode count 9/20], we have num_retrieval=np.int64(3525) num_query=np.int64(192)
2025-03-09 08:17:37,265 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-09 08:17:37,848 [INFO]: Launching the whole pipeline 03/09/2025, 08:17:37
2025-03-09 08:17:37,848 [INFO]: Reading total number of vectors and dimension 03/09/2025, 08:17:37
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1467.05it/s]
2025-03-09 08:17:37,872 [INFO]: There are 3525 embeddings of dim 49152
2025-03-09 08:17:37,872 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0240 secs
2025-03-09 08:17:37,872 [INFO]: 	Compute estimated construction time of the index 03/09/2025, 08:17:37
2025-03-09 08:17:37,872 [INFO]: 		-> Train: 16.7 minutes
2025-03-09 08:17:37,872 [INFO]: 		-> Add: 1.9 seconds
2025-03-09 08:17:37,872 [INFO]: 		Total: 16.7 minutes
2025-03-09 08:17:37,872 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0001 secs
2025-03-09 08:17:37,872 [INFO]: 	Checking that your have enough memory available to create the index 03/09/2025, 08:17:37
2025-03-09 08:17:37,872 [INFO]: 727.5MB of memory will be needed to build the index (more might be used if you have more)
2025-03-09 08:17:37,872 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0001 secs
2025-03-09 08:17:37,872 [INFO]: 	Selecting most promising index types given data characteristics 03/09/2025, 08:17:37
2025-03-09 08:17:37,872 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-09 08:17:37,872 [INFO]: 	Creating the index 03/09/2025, 08:17:37
2025-03-09 08:17:37,872 [INFO]: 		-> Instanciate the index HNSW15 03/09/2025, 08:17:37
2025-03-09 08:17:37,873 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0009 secs
2025-03-09 08:17:37,873 [INFO]: 		-> Adding the vectors to the index 03/09/2025, 08:17:37
2025-03-09 08:17:37,873 [INFO]: The memory available for adding the vectors is 49.4GB(total available - used by the index)
2025-03-09 08:17:37,873 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/14 [00:00<?, ?it/s]  7%|▋         | 1/14 [00:00<00:02,  5.59it/s] 21%|██▏       | 3/14 [00:00<00:01,  8.97it/s] 36%|███▌      | 5/14 [00:00<00:00, 10.02it/s] 50%|█████     | 7/14 [00:00<00:00, 10.69it/s] 64%|██████▍   | 9/14 [00:00<00:00, 10.99it/s] 79%|███████▊  | 11/14 [00:01<00:00, 11.21it/s] 93%|█████████▎| 13/14 [00:01<00:00, 11.15it/s]100%|██████████| 14/14 [00:03<00:00,  4.03it/s]
2025-03-09 08:17:41,352 [INFO]: 	Computing best hyperparameters for index knn.index 03/09/2025, 08:17:41
2025-03-09 08:18:14,568 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 33.2148 secs
2025-03-09 08:18:14,568 [INFO]: The best hyperparameters are: efSearch=209
2025-03-09 08:18:14,568 [INFO]: 	Compute fast metrics 03/09/2025, 08:18:14
  0%|          | 0/4 [00:00<?, ?it/s] 25%|██▌       | 1/4 [00:00<00:00,  7.30it/s] 75%|███████▌  | 3/4 [00:00<00:00, 10.93it/s] 75%|███████▌  | 3/4 [00:00<00:00,  8.33it/s]
2025-03-09 08:18:29,652 [INFO]: 	>>> Finished "Compute fast metrics" in 15.0841 secs
2025-03-09 08:18:29,655 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 51.7814 secs
2025-03-09 08:18:29,655 [INFO]: {
2025-03-09 08:18:29,655 [INFO]: 	index_key: HNSW15
2025-03-09 08:18:29,655 [INFO]: 	index_param: efSearch=209
2025-03-09 08:18:29,655 [INFO]: 	index_path: knn.index
2025-03-09 08:18:29,655 [INFO]: 	size in bytes: 693522010
2025-03-09 08:18:29,655 [INFO]: 	avg_search_speed_ms: 8.21950744023285
2025-03-09 08:18:29,655 [INFO]: 	99p_search_speed_ms: 12.545966869220136
2025-03-09 08:18:29,655 [INFO]: 	reconstruction error %: 0.0
2025-03-09 08:18:29,655 [INFO]: 	nb vectors: 3525
2025-03-09 08:18:29,655 [INFO]: 	vectors dimension: 49152
2025-03-09 08:18:29,655 [INFO]: 	compression ratio: 0.9993095965332088
2025-03-09 08:18:29,655 [INFO]: }
2025-03-09 08:18:29,655 [INFO]: 	>>> Finished "Creating the index" in 51.7828 secs
2025-03-09 08:18:29,655 [INFO]: >>> Finished "Launching the whole pipeline" in 51.8074 secs
2025-03-09 08:18:30: [retrieval_preprocessing] calculating distances ...
2025-03-09 08:18:31: [retrieval_preprocessing] finished and saved retrieval indices for episode 64559 [episode count 9/20]
[retrieval_preprocessing] for episode 50739 [episode count 10/20], we have num_retrieval=np.int64(3545) num_query=np.int64(172)
2025-03-09 08:18:32,050 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-09 08:18:32,610 [INFO]: Launching the whole pipeline 03/09/2025, 08:18:32
2025-03-09 08:18:32,610 [INFO]: Reading total number of vectors and dimension 03/09/2025, 08:18:32
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1609.48it/s]
2025-03-09 08:18:32,636 [INFO]: There are 3545 embeddings of dim 49152
2025-03-09 08:18:32,636 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0258 secs
2025-03-09 08:18:32,636 [INFO]: 	Compute estimated construction time of the index 03/09/2025, 08:18:32
2025-03-09 08:18:32,636 [INFO]: 		-> Train: 16.7 minutes
2025-03-09 08:18:32,636 [INFO]: 		-> Add: 1.9 seconds
2025-03-09 08:18:32,636 [INFO]: 		Total: 16.7 minutes
2025-03-09 08:18:32,636 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0001 secs
2025-03-09 08:18:32,636 [INFO]: 	Checking that your have enough memory available to create the index 03/09/2025, 08:18:32
2025-03-09 08:18:32,636 [INFO]: 731.6MB of memory will be needed to build the index (more might be used if you have more)
2025-03-09 08:18:32,636 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0001 secs
2025-03-09 08:18:32,636 [INFO]: 	Selecting most promising index types given data characteristics 03/09/2025, 08:18:32
2025-03-09 08:18:32,636 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-09 08:18:32,636 [INFO]: 	Creating the index 03/09/2025, 08:18:32
2025-03-09 08:18:32,636 [INFO]: 		-> Instanciate the index HNSW15 03/09/2025, 08:18:32
2025-03-09 08:18:32,637 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0010 secs
2025-03-09 08:18:32,637 [INFO]: 		-> Adding the vectors to the index 03/09/2025, 08:18:32
2025-03-09 08:18:32,637 [INFO]: The memory available for adding the vectors is 49.4GB(total available - used by the index)
2025-03-09 08:18:32,638 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/14 [00:00<?, ?it/s]  7%|▋         | 1/14 [00:00<00:02,  5.06it/s] 21%|██▏       | 3/14 [00:00<00:01,  8.49it/s] 36%|███▌      | 5/14 [00:00<00:00,  9.81it/s] 50%|█████     | 7/14 [00:00<00:00, 10.41it/s] 64%|██████▍   | 9/14 [00:00<00:00, 10.61it/s] 79%|███████▊  | 11/14 [00:01<00:00, 10.89it/s] 93%|█████████▎| 13/14 [00:01<00:00, 11.01it/s]100%|██████████| 14/14 [00:03<00:00,  3.66it/s]
2025-03-09 08:18:36,475 [INFO]: 	Computing best hyperparameters for index knn.index 03/09/2025, 08:18:36
2025-03-09 08:19:10,403 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 33.9274 secs
2025-03-09 08:19:10,403 [INFO]: The best hyperparameters are: efSearch=215
2025-03-09 08:19:10,403 [INFO]: 	Compute fast metrics 03/09/2025, 08:19:10
  0%|          | 0/4 [00:00<?, ?it/s] 25%|██▌       | 1/4 [00:00<00:00,  5.92it/s] 50%|█████     | 2/4 [00:00<00:00,  7.28it/s] 75%|███████▌  | 3/4 [00:00<00:00,  8.16it/s] 75%|███████▌  | 3/4 [00:00<00:00,  6.25it/s]
2025-03-09 08:19:31,629 [INFO]: 	>>> Finished "Compute fast metrics" in 21.2255 secs
2025-03-09 08:19:31,631 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 58.9933 secs
2025-03-09 08:19:31,631 [INFO]: {
2025-03-09 08:19:31,631 [INFO]: 	index_key: HNSW15
2025-03-09 08:19:31,631 [INFO]: 	index_param: efSearch=215
2025-03-09 08:19:31,631 [INFO]: 	index_path: knn.index
2025-03-09 08:19:31,631 [INFO]: 	size in bytes: 697456930
2025-03-09 08:19:31,631 [INFO]: 	avg_search_speed_ms: 9.076644535921853
2025-03-09 08:19:31,631 [INFO]: 	99p_search_speed_ms: 18.284975658170882
2025-03-09 08:19:31,631 [INFO]: 	reconstruction error %: 0.0
2025-03-09 08:19:31,631 [INFO]: 	nb vectors: 3545
2025-03-09 08:19:31,631 [INFO]: 	vectors dimension: 49152
2025-03-09 08:19:31,631 [INFO]: 	compression ratio: 0.9993095344253013
2025-03-09 08:19:31,631 [INFO]: }
2025-03-09 08:19:31,631 [INFO]: 	>>> Finished "Creating the index" in 58.9947 secs
2025-03-09 08:19:31,631 [INFO]: >>> Finished "Launching the whole pipeline" in 59.0211 secs
2025-03-09 08:19:32: [retrieval_preprocessing] calculating distances ...
2025-03-09 08:19:33: [retrieval_preprocessing] finished and saved retrieval indices for episode 50739 [episode count 10/20]
[retrieval_preprocessing] for episode 82996 [episode count 11/20], we have num_retrieval=np.int64(3536) num_query=np.int64(181)
2025-03-09 08:19:34,369 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-09 08:19:34,847 [INFO]: Launching the whole pipeline 03/09/2025, 08:19:34
2025-03-09 08:19:34,847 [INFO]: Reading total number of vectors and dimension 03/09/2025, 08:19:34
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1819.65it/s]
2025-03-09 08:19:34,872 [INFO]: There are 3536 embeddings of dim 49152
2025-03-09 08:19:34,873 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0255 secs
2025-03-09 08:19:34,873 [INFO]: 	Compute estimated construction time of the index 03/09/2025, 08:19:34
2025-03-09 08:19:34,873 [INFO]: 		-> Train: 16.7 minutes
2025-03-09 08:19:34,873 [INFO]: 		-> Add: 1.9 seconds
2025-03-09 08:19:34,873 [INFO]: 		Total: 16.7 minutes
2025-03-09 08:19:34,874 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0005 secs
2025-03-09 08:19:34,874 [INFO]: 	Checking that your have enough memory available to create the index 03/09/2025, 08:19:34
2025-03-09 08:19:34,874 [INFO]: 729.7MB of memory will be needed to build the index (more might be used if you have more)
2025-03-09 08:19:34,874 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0004 secs
2025-03-09 08:19:34,874 [INFO]: 	Selecting most promising index types given data characteristics 03/09/2025, 08:19:34
2025-03-09 08:19:34,874 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-09 08:19:34,874 [INFO]: 	Creating the index 03/09/2025, 08:19:34
2025-03-09 08:19:34,875 [INFO]: 		-> Instanciate the index HNSW15 03/09/2025, 08:19:34
2025-03-09 08:19:34,877 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0027 secs
2025-03-09 08:19:34,878 [INFO]: 		-> Adding the vectors to the index 03/09/2025, 08:19:34
2025-03-09 08:19:34,878 [INFO]: The memory available for adding the vectors is 49.4GB(total available - used by the index)
2025-03-09 08:19:34,878 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/14 [00:00<?, ?it/s]  7%|▋         | 1/14 [00:00<00:02,  5.34it/s] 14%|█▍        | 2/14 [00:00<00:01,  7.24it/s] 29%|██▊       | 4/14 [00:00<00:01,  8.75it/s] 36%|███▌      | 5/14 [00:00<00:01,  8.98it/s] 43%|████▎     | 6/14 [00:00<00:00,  9.22it/s] 50%|█████     | 7/14 [00:00<00:00,  9.24it/s] 57%|█████▋    | 8/14 [00:00<00:00,  9.25it/s] 64%|██████▍   | 9/14 [00:01<00:00,  9.25it/s] 71%|███████▏  | 10/14 [00:01<00:00,  9.34it/s] 79%|███████▊  | 11/14 [00:01<00:00,  9.53it/s] 86%|████████▌ | 12/14 [00:01<00:00,  9.41it/s] 93%|█████████▎| 13/14 [00:01<00:00,  9.25it/s]100%|██████████| 14/14 [00:03<00:00,  1.26it/s]100%|██████████| 14/14 [00:03<00:00,  3.64it/s]
2025-03-09 08:19:38,734 [INFO]: 	Computing best hyperparameters for index knn.index 03/09/2025, 08:19:38
2025-03-09 08:20:17,007 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 38.2724 secs
2025-03-09 08:20:17,007 [INFO]: The best hyperparameters are: efSearch=193
2025-03-09 08:20:17,007 [INFO]: 	Compute fast metrics 03/09/2025, 08:20:17
  0%|          | 0/4 [00:00<?, ?it/s] 25%|██▌       | 1/4 [00:00<00:00,  5.41it/s] 50%|█████     | 2/4 [00:00<00:00,  7.25it/s] 75%|███████▌  | 3/4 [00:00<00:00,  7.71it/s] 75%|███████▌  | 3/4 [00:00<00:00,  5.76it/s]
2025-03-09 08:20:33,869 [INFO]: 	>>> Finished "Compute fast metrics" in 16.8617 secs
2025-03-09 08:20:33,872 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 58.9942 secs
2025-03-09 08:20:33,872 [INFO]: {
2025-03-09 08:20:33,872 [INFO]: 	index_key: HNSW15
2025-03-09 08:20:33,872 [INFO]: 	index_param: efSearch=193
2025-03-09 08:20:33,872 [INFO]: 	index_path: knn.index
2025-03-09 08:20:33,872 [INFO]: 	size in bytes: 695686210
2025-03-09 08:20:33,872 [INFO]: 	avg_search_speed_ms: 8.19914982993858
2025-03-09 08:20:33,872 [INFO]: 	99p_search_speed_ms: 14.344434526283285
2025-03-09 08:20:33,872 [INFO]: 	reconstruction error %: 0.0
2025-03-09 08:20:33,872 [INFO]: 	nb vectors: 3536
2025-03-09 08:20:33,872 [INFO]: 	vectors dimension: 49152
2025-03-09 08:20:33,872 [INFO]: 	compression ratio: 0.999309570905538
2025-03-09 08:20:33,872 [INFO]: }
2025-03-09 08:20:33,872 [INFO]: 	>>> Finished "Creating the index" in 58.9978 secs
2025-03-09 08:20:33,872 [INFO]: >>> Finished "Launching the whole pipeline" in 59.0249 secs
2025-03-09 08:20:34: [retrieval_preprocessing] calculating distances ...
2025-03-09 08:20:35: [retrieval_preprocessing] finished and saved retrieval indices for episode 82996 [episode count 11/20]
[retrieval_preprocessing] for episode 29244 [episode count 12/20], we have num_retrieval=np.int64(3546) num_query=np.int64(171)
2025-03-09 08:20:36,254 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-09 08:20:36,785 [INFO]: Launching the whole pipeline 03/09/2025, 08:20:36
2025-03-09 08:20:36,786 [INFO]: Reading total number of vectors and dimension 03/09/2025, 08:20:36
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1210.13it/s]
2025-03-09 08:20:36,812 [INFO]: There are 3546 embeddings of dim 49152
2025-03-09 08:20:36,812 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0269 secs
2025-03-09 08:20:36,813 [INFO]: 	Compute estimated construction time of the index 03/09/2025, 08:20:36
2025-03-09 08:20:36,813 [INFO]: 		-> Train: 16.7 minutes
2025-03-09 08:20:36,813 [INFO]: 		-> Add: 1.9 seconds
2025-03-09 08:20:36,813 [INFO]: 		Total: 16.7 minutes
2025-03-09 08:20:36,813 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0001 secs
2025-03-09 08:20:36,813 [INFO]: 	Checking that your have enough memory available to create the index 03/09/2025, 08:20:36
2025-03-09 08:20:36,813 [INFO]: 731.8MB of memory will be needed to build the index (more might be used if you have more)
2025-03-09 08:20:36,813 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0001 secs
2025-03-09 08:20:36,813 [INFO]: 	Selecting most promising index types given data characteristics 03/09/2025, 08:20:36
2025-03-09 08:20:36,813 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-09 08:20:36,813 [INFO]: 	Creating the index 03/09/2025, 08:20:36
2025-03-09 08:20:36,813 [INFO]: 		-> Instanciate the index HNSW15 03/09/2025, 08:20:36
2025-03-09 08:20:36,814 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0011 secs
2025-03-09 08:20:36,814 [INFO]: 		-> Adding the vectors to the index 03/09/2025, 08:20:36
2025-03-09 08:20:36,814 [INFO]: The memory available for adding the vectors is 49.4GB(total available - used by the index)
2025-03-09 08:20:36,814 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/14 [00:00<?, ?it/s]  7%|▋         | 1/14 [00:00<00:01,  6.66it/s] 21%|██▏       | 3/14 [00:00<00:01, 10.29it/s] 36%|███▌      | 5/14 [00:00<00:00, 11.51it/s] 50%|█████     | 7/14 [00:00<00:00, 12.08it/s] 64%|██████▍   | 9/14 [00:00<00:00, 12.35it/s] 79%|███████▊  | 11/14 [00:00<00:00, 12.35it/s] 93%|█████████▎| 13/14 [00:01<00:00, 12.31it/s]100%|██████████| 14/14 [00:03<00:00,  3.79it/s]
2025-03-09 08:20:40,519 [INFO]: 	Computing best hyperparameters for index knn.index 03/09/2025, 08:20:40
2025-03-09 08:21:13,458 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 32.9384 secs
2025-03-09 08:21:13,458 [INFO]: The best hyperparameters are: efSearch=213
2025-03-09 08:21:13,458 [INFO]: 	Compute fast metrics 03/09/2025, 08:21:13
  0%|          | 0/4 [00:00<?, ?it/s] 50%|█████     | 2/4 [00:00<00:00, 17.94it/s] 75%|███████▌  | 3/4 [00:00<00:00, 19.11it/s]
2025-03-09 08:21:29,882 [INFO]: 	>>> Finished "Compute fast metrics" in 16.4234 secs
2025-03-09 08:21:29,885 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 53.0706 secs
2025-03-09 08:21:29,885 [INFO]: {
2025-03-09 08:21:29,885 [INFO]: 	index_key: HNSW15
2025-03-09 08:21:29,885 [INFO]: 	index_param: efSearch=213
2025-03-09 08:21:29,885 [INFO]: 	index_path: knn.index
2025-03-09 08:21:29,885 [INFO]: 	size in bytes: 697653670
2025-03-09 08:21:29,885 [INFO]: 	avg_search_speed_ms: 9.096460597203185
2025-03-09 08:21:29,885 [INFO]: 	99p_search_speed_ms: 16.31738256197422
2025-03-09 08:21:29,885 [INFO]: 	reconstruction error %: 0.0
2025-03-09 08:21:29,885 [INFO]: 	nb vectors: 3546
2025-03-09 08:21:29,885 [INFO]: 	vectors dimension: 49152
2025-03-09 08:21:29,885 [INFO]: 	compression ratio: 0.9993095399326144
2025-03-09 08:21:29,885 [INFO]: }
2025-03-09 08:21:29,885 [INFO]: 	>>> Finished "Creating the index" in 53.0723 secs
2025-03-09 08:21:29,885 [INFO]: >>> Finished "Launching the whole pipeline" in 53.0998 secs
2025-03-09 08:21:30: [retrieval_preprocessing] calculating distances ...
2025-03-09 08:21:31: [retrieval_preprocessing] finished and saved retrieval indices for episode 29244 [episode count 12/20]
[retrieval_preprocessing] for episode 17981 [episode count 13/20], we have num_retrieval=np.int64(3531) num_query=np.int64(186)
2025-03-09 08:21:32,081 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-09 08:21:32,573 [INFO]: Launching the whole pipeline 03/09/2025, 08:21:32
2025-03-09 08:21:32,573 [INFO]: Reading total number of vectors and dimension 03/09/2025, 08:21:32
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1238.35it/s]
2025-03-09 08:21:32,600 [INFO]: There are 3531 embeddings of dim 49152
2025-03-09 08:21:32,600 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0271 secs
2025-03-09 08:21:32,600 [INFO]: 	Compute estimated construction time of the index 03/09/2025, 08:21:32
2025-03-09 08:21:32,600 [INFO]: 		-> Train: 16.7 minutes
2025-03-09 08:21:32,600 [INFO]: 		-> Add: 1.9 seconds
2025-03-09 08:21:32,600 [INFO]: 		Total: 16.7 minutes
2025-03-09 08:21:32,600 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0001 secs
2025-03-09 08:21:32,600 [INFO]: 	Checking that your have enough memory available to create the index 03/09/2025, 08:21:32
2025-03-09 08:21:32,601 [INFO]: 728.7MB of memory will be needed to build the index (more might be used if you have more)
2025-03-09 08:21:32,601 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0002 secs
2025-03-09 08:21:32,601 [INFO]: 	Selecting most promising index types given data characteristics 03/09/2025, 08:21:32
2025-03-09 08:21:32,601 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-09 08:21:32,601 [INFO]: 	Creating the index 03/09/2025, 08:21:32
2025-03-09 08:21:32,601 [INFO]: 		-> Instanciate the index HNSW15 03/09/2025, 08:21:32
2025-03-09 08:21:32,602 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0012 secs
2025-03-09 08:21:32,602 [INFO]: 		-> Adding the vectors to the index 03/09/2025, 08:21:32
2025-03-09 08:21:32,602 [INFO]: The memory available for adding the vectors is 49.4GB(total available - used by the index)
2025-03-09 08:21:32,602 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/14 [00:00<?, ?it/s]  7%|▋         | 1/14 [00:00<00:01,  6.78it/s] 21%|██▏       | 3/14 [00:00<00:00, 12.34it/s] 36%|███▌      | 5/14 [00:00<00:00, 14.56it/s] 50%|█████     | 7/14 [00:00<00:00, 13.98it/s] 64%|██████▍   | 9/14 [00:00<00:00, 13.68it/s] 79%|███████▊  | 11/14 [00:00<00:00, 13.47it/s] 93%|█████████▎| 13/14 [00:00<00:00, 13.37it/s]100%|██████████| 14/14 [00:03<00:00,  3.84it/s]
2025-03-09 08:21:36,253 [INFO]: 	Computing best hyperparameters for index knn.index 03/09/2025, 08:21:36
2025-03-09 08:22:10,058 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 33.8054 secs
2025-03-09 08:22:10,059 [INFO]: The best hyperparameters are: efSearch=218
2025-03-09 08:22:10,059 [INFO]: 	Compute fast metrics 03/09/2025, 08:22:10
  0%|          | 0/4 [00:00<?, ?it/s] 25%|██▌       | 1/4 [00:00<00:00,  5.34it/s] 50%|█████     | 2/4 [00:00<00:00,  7.13it/s] 75%|███████▌  | 3/4 [00:00<00:00,  7.85it/s] 75%|███████▌  | 3/4 [00:00<00:00,  5.80it/s]
2025-03-09 08:22:27,496 [INFO]: 	>>> Finished "Compute fast metrics" in 17.4372 secs
2025-03-09 08:22:27,499 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 54.8970 secs
2025-03-09 08:22:27,499 [INFO]: {
2025-03-09 08:22:27,500 [INFO]: 	index_key: HNSW15
2025-03-09 08:22:27,500 [INFO]: 	index_param: efSearch=218
2025-03-09 08:22:27,500 [INFO]: 	index_path: knn.index
2025-03-09 08:22:27,500 [INFO]: 	size in bytes: 694702510
2025-03-09 08:22:27,500 [INFO]: 	avg_search_speed_ms: 9.027124019440546
2025-03-09 08:22:27,500 [INFO]: 	99p_search_speed_ms: 14.841004482004791
2025-03-09 08:22:27,500 [INFO]: 	reconstruction error %: 0.0
2025-03-09 08:22:27,500 [INFO]: 	nb vectors: 3531
2025-03-09 08:22:27,500 [INFO]: 	vectors dimension: 49152
2025-03-09 08:22:27,500 [INFO]: 	compression ratio: 0.999309543303651
2025-03-09 08:22:27,500 [INFO]: }
2025-03-09 08:22:27,500 [INFO]: 	>>> Finished "Creating the index" in 54.8989 secs
2025-03-09 08:22:27,500 [INFO]: >>> Finished "Launching the whole pipeline" in 54.9267 secs
2025-03-09 08:22:28: [retrieval_preprocessing] calculating distances ...
2025-03-09 08:22:29: [retrieval_preprocessing] finished and saved retrieval indices for episode 17981 [episode count 13/20]
[retrieval_preprocessing] for episode 3646 [episode count 14/20], we have num_retrieval=np.int64(3529) num_query=np.int64(188)
2025-03-09 08:22:30,187 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-09 08:22:30,702 [INFO]: Launching the whole pipeline 03/09/2025, 08:22:30
2025-03-09 08:22:30,702 [INFO]: Reading total number of vectors and dimension 03/09/2025, 08:22:30
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1360.46it/s]
2025-03-09 08:22:30,733 [INFO]: There are 3529 embeddings of dim 49152
2025-03-09 08:22:30,733 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0314 secs
2025-03-09 08:22:30,734 [INFO]: 	Compute estimated construction time of the index 03/09/2025, 08:22:30
2025-03-09 08:22:30,734 [INFO]: 		-> Train: 16.7 minutes
2025-03-09 08:22:30,734 [INFO]: 		-> Add: 1.9 seconds
2025-03-09 08:22:30,734 [INFO]: 		Total: 16.7 minutes
2025-03-09 08:22:30,734 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0003 secs
2025-03-09 08:22:30,734 [INFO]: 	Checking that your have enough memory available to create the index 03/09/2025, 08:22:30
2025-03-09 08:22:30,734 [INFO]: 728.3MB of memory will be needed to build the index (more might be used if you have more)
2025-03-09 08:22:30,735 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0005 secs
2025-03-09 08:22:30,735 [INFO]: 	Selecting most promising index types given data characteristics 03/09/2025, 08:22:30
2025-03-09 08:22:30,735 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-09 08:22:30,735 [INFO]: 	Creating the index 03/09/2025, 08:22:30
2025-03-09 08:22:30,735 [INFO]: 		-> Instanciate the index HNSW15 03/09/2025, 08:22:30
2025-03-09 08:22:30,738 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0027 secs
2025-03-09 08:22:30,738 [INFO]: 		-> Adding the vectors to the index 03/09/2025, 08:22:30
2025-03-09 08:22:30,739 [INFO]: The memory available for adding the vectors is 49.4GB(total available - used by the index)
2025-03-09 08:22:30,739 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/14 [00:00<?, ?it/s]  7%|▋         | 1/14 [00:00<00:02,  5.08it/s] 14%|█▍        | 2/14 [00:00<00:01,  6.60it/s] 21%|██▏       | 3/14 [00:00<00:01,  7.47it/s] 29%|██▊       | 4/14 [00:00<00:01,  8.17it/s] 36%|███▌      | 5/14 [00:00<00:01,  8.53it/s] 43%|████▎     | 6/14 [00:00<00:00,  8.67it/s] 50%|█████     | 7/14 [00:00<00:00,  8.56it/s] 57%|█████▋    | 8/14 [00:00<00:00,  8.44it/s] 64%|██████▍   | 9/14 [00:01<00:00,  8.51it/s] 71%|███████▏  | 10/14 [00:01<00:00,  8.49it/s] 79%|███████▊  | 11/14 [00:01<00:00,  8.47it/s] 86%|████████▌ | 12/14 [00:01<00:00,  8.48it/s] 93%|█████████▎| 13/14 [00:01<00:00,  8.62it/s]100%|██████████| 14/14 [00:04<00:00,  1.14it/s]100%|██████████| 14/14 [00:04<00:00,  3.33it/s]
2025-03-09 08:22:34,953 [INFO]: 	Computing best hyperparameters for index knn.index 03/09/2025, 08:22:34
2025-03-09 08:23:12,008 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 37.0543 secs
2025-03-09 08:23:12,008 [INFO]: The best hyperparameters are: efSearch=178
2025-03-09 08:23:12,008 [INFO]: 	Compute fast metrics 03/09/2025, 08:23:12
  0%|          | 0/4 [00:00<?, ?it/s] 25%|██▌       | 1/4 [00:00<00:00,  5.60it/s] 50%|█████     | 2/4 [00:00<00:00,  7.20it/s] 75%|███████▌  | 3/4 [00:00<00:00,  8.20it/s] 75%|███████▌  | 3/4 [00:00<00:00,  6.21it/s]
2025-03-09 08:23:32,078 [INFO]: 	>>> Finished "Compute fast metrics" in 20.0699 secs
2025-03-09 08:23:32,080 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 61.3418 secs
2025-03-09 08:23:32,080 [INFO]: {
2025-03-09 08:23:32,080 [INFO]: 	index_key: HNSW15
2025-03-09 08:23:32,080 [INFO]: 	index_param: efSearch=178
2025-03-09 08:23:32,080 [INFO]: 	index_path: knn.index
2025-03-09 08:23:32,080 [INFO]: 	size in bytes: 694309030
2025-03-09 08:23:32,080 [INFO]: 	avg_search_speed_ms: 8.102245098078017
2025-03-09 08:23:32,080 [INFO]: 	99p_search_speed_ms: 15.46479749260471
2025-03-09 08:23:32,080 [INFO]: 	reconstruction error %: 0.0
2025-03-09 08:23:32,080 [INFO]: 	nb vectors: 3529
2025-03-09 08:23:32,080 [INFO]: 	vectors dimension: 49152
2025-03-09 08:23:32,080 [INFO]: 	compression ratio: 0.9993095322409965
2025-03-09 08:23:32,080 [INFO]: }
2025-03-09 08:23:32,080 [INFO]: 	>>> Finished "Creating the index" in 61.3453 secs
2025-03-09 08:23:32,081 [INFO]: >>> Finished "Launching the whole pipeline" in 61.3786 secs
2025-03-09 08:23:32: [retrieval_preprocessing] calculating distances ...
2025-03-09 08:23:33: [retrieval_preprocessing] finished and saved retrieval indices for episode 3646 [episode count 14/20]
[retrieval_preprocessing] for episode 54334 [episode count 15/20], we have num_retrieval=np.int64(3550) num_query=np.int64(167)
2025-03-09 08:23:34,367 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-09 08:23:34,813 [INFO]: Launching the whole pipeline 03/09/2025, 08:23:34
2025-03-09 08:23:34,813 [INFO]: Reading total number of vectors and dimension 03/09/2025, 08:23:34
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1293.34it/s]
2025-03-09 08:23:34,837 [INFO]: There are 3550 embeddings of dim 49152
2025-03-09 08:23:34,837 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0247 secs
2025-03-09 08:23:34,837 [INFO]: 	Compute estimated construction time of the index 03/09/2025, 08:23:34
2025-03-09 08:23:34,838 [INFO]: 		-> Train: 16.7 minutes
2025-03-09 08:23:34,838 [INFO]: 		-> Add: 2.0 seconds
2025-03-09 08:23:34,838 [INFO]: 		Total: 16.7 minutes
2025-03-09 08:23:34,838 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0002 secs
2025-03-09 08:23:34,838 [INFO]: 	Checking that your have enough memory available to create the index 03/09/2025, 08:23:34
2025-03-09 08:23:34,838 [INFO]: 732.6MB of memory will be needed to build the index (more might be used if you have more)
2025-03-09 08:23:34,838 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0002 secs
2025-03-09 08:23:34,838 [INFO]: 	Selecting most promising index types given data characteristics 03/09/2025, 08:23:34
2025-03-09 08:23:34,838 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-09 08:23:34,838 [INFO]: 	Creating the index 03/09/2025, 08:23:34
2025-03-09 08:23:34,838 [INFO]: 		-> Instanciate the index HNSW15 03/09/2025, 08:23:34
2025-03-09 08:23:34,839 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0011 secs
2025-03-09 08:23:34,840 [INFO]: 		-> Adding the vectors to the index 03/09/2025, 08:23:34
2025-03-09 08:23:34,840 [INFO]: The memory available for adding the vectors is 49.3GB(total available - used by the index)
2025-03-09 08:23:34,840 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/14 [00:00<?, ?it/s]  7%|▋         | 1/14 [00:00<00:02,  5.85it/s] 29%|██▊       | 4/14 [00:00<00:00, 16.65it/s] 50%|█████     | 7/14 [00:00<00:00, 20.88it/s] 71%|███████▏  | 10/14 [00:00<00:00, 22.95it/s] 93%|█████████▎| 13/14 [00:00<00:00, 16.79it/s]100%|██████████| 14/14 [00:03<00:00,  4.13it/s]
2025-03-09 08:23:38,237 [INFO]: 	Computing best hyperparameters for index knn.index 03/09/2025, 08:23:38
2025-03-09 08:24:11,322 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 33.0846 secs
2025-03-09 08:24:11,322 [INFO]: The best hyperparameters are: efSearch=184
2025-03-09 08:24:11,322 [INFO]: 	Compute fast metrics 03/09/2025, 08:24:11
  0%|          | 0/4 [00:00<?, ?it/s] 25%|██▌       | 1/4 [00:00<00:00,  5.44it/s] 50%|█████     | 2/4 [00:00<00:00,  6.83it/s] 75%|███████▌  | 3/4 [00:00<00:00,  7.56it/s] 75%|███████▌  | 3/4 [00:00<00:00,  5.70it/s]
2025-03-09 08:24:30,168 [INFO]: 	>>> Finished "Compute fast metrics" in 18.8456 secs
2025-03-09 08:24:30,170 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 55.3302 secs
2025-03-09 08:24:30,170 [INFO]: {
2025-03-09 08:24:30,170 [INFO]: 	index_key: HNSW15
2025-03-09 08:24:30,170 [INFO]: 	index_param: efSearch=184
2025-03-09 08:24:30,170 [INFO]: 	index_path: knn.index
2025-03-09 08:24:30,170 [INFO]: 	size in bytes: 698440690
2025-03-09 08:24:30,170 [INFO]: 	avg_search_speed_ms: 8.576056916797038
2025-03-09 08:24:30,170 [INFO]: 	99p_search_speed_ms: 16.433305235113934
2025-03-09 08:24:30,170 [INFO]: 	reconstruction error %: 0.0
2025-03-09 08:24:30,170 [INFO]: 	nb vectors: 3550
2025-03-09 08:24:30,170 [INFO]: 	vectors dimension: 49152
2025-03-09 08:24:30,170 [INFO]: 	compression ratio: 0.9993094760845047
2025-03-09 08:24:30,170 [INFO]: }
2025-03-09 08:24:30,170 [INFO]: 	>>> Finished "Creating the index" in 55.3319 secs
2025-03-09 08:24:30,170 [INFO]: >>> Finished "Launching the whole pipeline" in 55.3574 secs
2025-03-09 08:24:30: [retrieval_preprocessing] calculating distances ...
2025-03-09 08:24:31: [retrieval_preprocessing] finished and saved retrieval indices for episode 54334 [episode count 15/20]
[retrieval_preprocessing] for episode 42049 [episode count 16/20], we have num_retrieval=np.int64(3526) num_query=np.int64(191)
2025-03-09 08:24:33,354 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-09 08:24:33,971 [INFO]: Launching the whole pipeline 03/09/2025, 08:24:33
2025-03-09 08:24:33,972 [INFO]: Reading total number of vectors and dimension 03/09/2025, 08:24:33
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1747.63it/s]
2025-03-09 08:24:33,999 [INFO]: There are 3526 embeddings of dim 49152
2025-03-09 08:24:34,000 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0279 secs
2025-03-09 08:24:34,000 [INFO]: 	Compute estimated construction time of the index 03/09/2025, 08:24:34
2025-03-09 08:24:34,000 [INFO]: 		-> Train: 16.7 minutes
2025-03-09 08:24:34,000 [INFO]: 		-> Add: 1.9 seconds
2025-03-09 08:24:34,000 [INFO]: 		Total: 16.7 minutes
2025-03-09 08:24:34,000 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0003 secs
2025-03-09 08:24:34,000 [INFO]: 	Checking that your have enough memory available to create the index 03/09/2025, 08:24:34
2025-03-09 08:24:34,000 [INFO]: 727.7MB of memory will be needed to build the index (more might be used if you have more)
2025-03-09 08:24:34,001 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0004 secs
2025-03-09 08:24:34,001 [INFO]: 	Selecting most promising index types given data characteristics 03/09/2025, 08:24:34
2025-03-09 08:24:34,001 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-09 08:24:34,001 [INFO]: 	Creating the index 03/09/2025, 08:24:34
2025-03-09 08:24:34,001 [INFO]: 		-> Instanciate the index HNSW15 03/09/2025, 08:24:34
2025-03-09 08:24:34,004 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0026 secs
2025-03-09 08:24:34,004 [INFO]: 		-> Adding the vectors to the index 03/09/2025, 08:24:34
2025-03-09 08:24:34,004 [INFO]: The memory available for adding the vectors is 49.4GB(total available - used by the index)
2025-03-09 08:24:34,004 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/14 [00:00<?, ?it/s]  7%|▋         | 1/14 [00:00<00:02,  5.79it/s] 14%|█▍        | 2/14 [00:00<00:01,  7.31it/s] 21%|██▏       | 3/14 [00:00<00:01,  8.08it/s] 29%|██▊       | 4/14 [00:00<00:01,  8.36it/s] 36%|███▌      | 5/14 [00:00<00:01,  8.36it/s] 43%|████▎     | 6/14 [00:00<00:00,  8.47it/s] 50%|█████     | 7/14 [00:00<00:00,  8.59it/s] 57%|█████▋    | 8/14 [00:00<00:00,  8.87it/s] 64%|██████▍   | 9/14 [00:01<00:00,  8.94it/s] 71%|███████▏  | 10/14 [00:01<00:00,  5.87it/s] 79%|███████▊  | 11/14 [00:01<00:00,  5.32it/s] 86%|████████▌ | 12/14 [00:01<00:00,  5.17it/s]100%|██████████| 14/14 [00:03<00:00,  1.65it/s]100%|██████████| 14/14 [00:03<00:00,  3.52it/s]
2025-03-09 08:24:37,990 [INFO]: 	Computing best hyperparameters for index knn.index 03/09/2025, 08:24:37
2025-03-09 08:25:11,080 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 33.0904 secs
2025-03-09 08:25:11,081 [INFO]: The best hyperparameters are: efSearch=222
2025-03-09 08:25:11,081 [INFO]: 	Compute fast metrics 03/09/2025, 08:25:11
  0%|          | 0/4 [00:00<?, ?it/s] 25%|██▌       | 1/4 [00:00<00:00,  5.55it/s] 50%|█████     | 2/4 [00:00<00:00,  7.35it/s] 75%|███████▌  | 3/4 [00:00<00:00,  8.24it/s] 75%|███████▌  | 3/4 [00:00<00:00,  6.20it/s]
2025-03-09 08:25:32,591 [INFO]: 	>>> Finished "Compute fast metrics" in 21.5102 secs
2025-03-09 08:25:32,896 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 58.8925 secs
2025-03-09 08:25:32,897 [INFO]: {
2025-03-09 08:25:32,897 [INFO]: 	index_key: HNSW15
2025-03-09 08:25:32,897 [INFO]: 	index_param: efSearch=222
2025-03-09 08:25:32,897 [INFO]: 	index_path: knn.index
2025-03-09 08:25:32,897 [INFO]: 	size in bytes: 693718750
2025-03-09 08:25:32,897 [INFO]: 	avg_search_speed_ms: 9.553810739676257
2025-03-09 08:25:32,897 [INFO]: 	99p_search_speed_ms: 13.770061549730599
2025-03-09 08:25:32,897 [INFO]: 	reconstruction error %: 0.0
2025-03-09 08:25:32,897 [INFO]: 	nb vectors: 3526
2025-03-09 08:25:32,898 [INFO]: 	vectors dimension: 49152
2025-03-09 08:25:32,898 [INFO]: 	compression ratio: 0.9993096020541465
2025-03-09 08:25:32,898 [INFO]: }
2025-03-09 08:25:32,898 [INFO]: 	>>> Finished "Creating the index" in 58.8969 secs
2025-03-09 08:25:32,898 [INFO]: >>> Finished "Launching the whole pipeline" in 58.9263 secs
2025-03-09 08:25:33: [retrieval_preprocessing] calculating distances ...
2025-03-09 08:25:34: [retrieval_preprocessing] finished and saved retrieval indices for episode 42049 [episode count 16/20]
[retrieval_preprocessing] for episode 58949 [episode count 17/20], we have num_retrieval=np.int64(3494) num_query=np.int64(223)
2025-03-09 08:25:35,657 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-09 08:25:36,266 [INFO]: Launching the whole pipeline 03/09/2025, 08:25:36
2025-03-09 08:25:36,266 [INFO]: Reading total number of vectors and dimension 03/09/2025, 08:25:36
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1597.83it/s]
2025-03-09 08:25:36,291 [INFO]: There are 3494 embeddings of dim 49152
2025-03-09 08:25:36,291 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0250 secs
2025-03-09 08:25:36,291 [INFO]: 	Compute estimated construction time of the index 03/09/2025, 08:25:36
2025-03-09 08:25:36,291 [INFO]: 		-> Train: 16.7 minutes
2025-03-09 08:25:36,291 [INFO]: 		-> Add: 1.9 seconds
2025-03-09 08:25:36,291 [INFO]: 		Total: 16.7 minutes
2025-03-09 08:25:36,291 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0001 secs
2025-03-09 08:25:36,291 [INFO]: 	Checking that your have enough memory available to create the index 03/09/2025, 08:25:36
2025-03-09 08:25:36,291 [INFO]: 721.1MB of memory will be needed to build the index (more might be used if you have more)
2025-03-09 08:25:36,291 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0001 secs
2025-03-09 08:25:36,291 [INFO]: 	Selecting most promising index types given data characteristics 03/09/2025, 08:25:36
2025-03-09 08:25:36,291 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-09 08:25:36,291 [INFO]: 	Creating the index 03/09/2025, 08:25:36
2025-03-09 08:25:36,291 [INFO]: 		-> Instanciate the index HNSW15 03/09/2025, 08:25:36
2025-03-09 08:25:36,292 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0010 secs
2025-03-09 08:25:36,292 [INFO]: 		-> Adding the vectors to the index 03/09/2025, 08:25:36
2025-03-09 08:25:36,293 [INFO]: The memory available for adding the vectors is 49.4GB(total available - used by the index)
2025-03-09 08:25:36,293 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/14 [00:00<?, ?it/s]  7%|▋         | 1/14 [00:00<00:02,  5.38it/s] 21%|██▏       | 3/14 [00:00<00:01,  8.27it/s] 36%|███▌      | 5/14 [00:00<00:00,  9.09it/s] 50%|█████     | 7/14 [00:00<00:00,  9.65it/s] 64%|██████▍   | 9/14 [00:00<00:00,  9.85it/s] 79%|███████▊  | 11/14 [00:01<00:00, 10.04it/s] 93%|█████████▎| 13/14 [00:01<00:00, 10.46it/s]100%|██████████| 14/14 [00:04<00:00,  3.43it/s]
2025-03-09 08:25:40,387 [INFO]: 	Computing best hyperparameters for index knn.index 03/09/2025, 08:25:40
2025-03-09 08:26:10,400 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 30.0122 secs
2025-03-09 08:26:10,400 [INFO]: The best hyperparameters are: efSearch=214
2025-03-09 08:26:10,400 [INFO]: 	Compute fast metrics 03/09/2025, 08:26:10
  0%|          | 0/4 [00:00<?, ?it/s] 25%|██▌       | 1/4 [00:00<00:00,  4.98it/s] 50%|█████     | 2/4 [00:00<00:00,  6.50it/s] 75%|███████▌  | 3/4 [00:00<00:00,  7.21it/s] 75%|███████▌  | 3/4 [00:00<00:00,  5.41it/s]
2025-03-09 08:26:30,089 [INFO]: 	>>> Finished "Compute fast metrics" in 19.6894 secs
2025-03-09 08:26:30,092 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 53.7992 secs
2025-03-09 08:26:30,092 [INFO]: {
2025-03-09 08:26:30,092 [INFO]: 	index_key: HNSW15
2025-03-09 08:26:30,092 [INFO]: 	index_param: efSearch=214
2025-03-09 08:26:30,092 [INFO]: 	index_path: knn.index
2025-03-09 08:26:30,092 [INFO]: 	size in bytes: 687423010
2025-03-09 08:26:30,092 [INFO]: 	avg_search_speed_ms: 8.439976637711442
2025-03-09 08:26:30,092 [INFO]: 	99p_search_speed_ms: 13.599465694278482
2025-03-09 08:26:30,092 [INFO]: 	reconstruction error %: 0.0
2025-03-09 08:26:30,092 [INFO]: 	nb vectors: 3494
2025-03-09 08:26:30,092 [INFO]: 	vectors dimension: 49152
2025-03-09 08:26:30,092 [INFO]: 	compression ratio: 0.9993095110389162
2025-03-09 08:26:30,092 [INFO]: }
2025-03-09 08:26:30,092 [INFO]: 	>>> Finished "Creating the index" in 53.8006 secs
2025-03-09 08:26:30,092 [INFO]: >>> Finished "Launching the whole pipeline" in 53.8261 secs
2025-03-09 08:26:31: [retrieval_preprocessing] calculating distances ...
2025-03-09 08:26:31: [retrieval_preprocessing] finished and saved retrieval indices for episode 58949 [episode count 17/20]
[retrieval_preprocessing] for episode 56909 [episode count 18/20], we have num_retrieval=np.int64(3532) num_query=np.int64(185)
2025-03-09 08:26:32,723 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-09 08:26:33,332 [INFO]: Launching the whole pipeline 03/09/2025, 08:26:33
2025-03-09 08:26:33,332 [INFO]: Reading total number of vectors and dimension 03/09/2025, 08:26:33
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1838.80it/s]
2025-03-09 08:26:33,361 [INFO]: There are 3532 embeddings of dim 49152
2025-03-09 08:26:33,362 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0292 secs
2025-03-09 08:26:33,362 [INFO]: 	Compute estimated construction time of the index 03/09/2025, 08:26:33
2025-03-09 08:26:33,362 [INFO]: 		-> Train: 16.7 minutes
2025-03-09 08:26:33,362 [INFO]: 		-> Add: 1.9 seconds
2025-03-09 08:26:33,362 [INFO]: 		Total: 16.7 minutes
2025-03-09 08:26:33,362 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0001 secs
2025-03-09 08:26:33,362 [INFO]: 	Checking that your have enough memory available to create the index 03/09/2025, 08:26:33
2025-03-09 08:26:33,362 [INFO]: 728.9MB of memory will be needed to build the index (more might be used if you have more)
2025-03-09 08:26:33,362 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0001 secs
2025-03-09 08:26:33,362 [INFO]: 	Selecting most promising index types given data characteristics 03/09/2025, 08:26:33
2025-03-09 08:26:33,362 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-09 08:26:33,362 [INFO]: 	Creating the index 03/09/2025, 08:26:33
2025-03-09 08:26:33,362 [INFO]: 		-> Instanciate the index HNSW15 03/09/2025, 08:26:33
2025-03-09 08:26:33,363 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0008 secs
2025-03-09 08:26:33,363 [INFO]: 		-> Adding the vectors to the index 03/09/2025, 08:26:33
2025-03-09 08:26:33,363 [INFO]: The memory available for adding the vectors is 49.4GB(total available - used by the index)
2025-03-09 08:26:33,363 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/14 [00:00<?, ?it/s]  7%|▋         | 1/14 [00:00<00:01,  7.49it/s] 21%|██▏       | 3/14 [00:00<00:01, 10.23it/s] 36%|███▌      | 5/14 [00:00<00:00, 10.74it/s] 50%|█████     | 7/14 [00:00<00:00, 11.03it/s] 64%|██████▍   | 9/14 [00:00<00:00, 11.62it/s] 79%|███████▊  | 11/14 [00:00<00:00, 12.08it/s] 93%|█████████▎| 13/14 [00:01<00:00, 13.59it/s]100%|██████████| 14/14 [00:03<00:00,  4.33it/s]
2025-03-09 08:26:36,938 [INFO]: 	Computing best hyperparameters for index knn.index 03/09/2025, 08:26:36
2025-03-09 08:27:12,768 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 35.8298 secs
2025-03-09 08:27:12,769 [INFO]: The best hyperparameters are: efSearch=197
2025-03-09 08:27:12,769 [INFO]: 	Compute fast metrics 03/09/2025, 08:27:12
  0%|          | 0/4 [00:00<?, ?it/s] 25%|██▌       | 1/4 [00:00<00:00,  5.84it/s] 75%|███████▌  | 3/4 [00:00<00:00,  9.20it/s] 75%|███████▌  | 3/4 [00:00<00:00,  6.99it/s]
2025-03-09 08:27:33,063 [INFO]: 	>>> Finished "Compute fast metrics" in 20.2942 secs
2025-03-09 08:27:33,066 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 59.7026 secs
2025-03-09 08:27:33,066 [INFO]: {
2025-03-09 08:27:33,066 [INFO]: 	index_key: HNSW15
2025-03-09 08:27:33,066 [INFO]: 	index_param: efSearch=197
2025-03-09 08:27:33,066 [INFO]: 	index_path: knn.index
2025-03-09 08:27:33,066 [INFO]: 	size in bytes: 694899250
2025-03-09 08:27:33,066 [INFO]: 	avg_search_speed_ms: 8.801321693348475
2025-03-09 08:27:33,066 [INFO]: 	99p_search_speed_ms: 16.68883764650678
2025-03-09 08:27:33,066 [INFO]: 	reconstruction error %: 0.0
2025-03-09 08:27:33,067 [INFO]: 	nb vectors: 3532
2025-03-09 08:27:33,067 [INFO]: 	vectors dimension: 49152
2025-03-09 08:27:33,067 [INFO]: 	compression ratio: 0.9993095488302801
2025-03-09 08:27:33,067 [INFO]: }
2025-03-09 08:27:33,067 [INFO]: 	>>> Finished "Creating the index" in 59.7046 secs
2025-03-09 08:27:33,067 [INFO]: >>> Finished "Launching the whole pipeline" in 59.7343 secs
2025-03-09 08:27:34: [retrieval_preprocessing] calculating distances ...
2025-03-09 08:27:35: [retrieval_preprocessing] finished and saved retrieval indices for episode 56909 [episode count 18/20]
[retrieval_preprocessing] for episode 44119 [episode count 19/20], we have num_retrieval=np.int64(3541) num_query=np.int64(176)
2025-03-09 08:27:35,628 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-09 08:27:36,241 [INFO]: Launching the whole pipeline 03/09/2025, 08:27:36
2025-03-09 08:27:36,241 [INFO]: Reading total number of vectors and dimension 03/09/2025, 08:27:36
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1486.29it/s]
2025-03-09 08:27:36,270 [INFO]: There are 3541 embeddings of dim 49152
2025-03-09 08:27:36,271 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0299 secs
2025-03-09 08:27:36,271 [INFO]: 	Compute estimated construction time of the index 03/09/2025, 08:27:36
2025-03-09 08:27:36,271 [INFO]: 		-> Train: 16.7 minutes
2025-03-09 08:27:36,271 [INFO]: 		-> Add: 1.9 seconds
2025-03-09 08:27:36,271 [INFO]: 		Total: 16.7 minutes
2025-03-09 08:27:36,271 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0005 secs
2025-03-09 08:27:36,272 [INFO]: 	Checking that your have enough memory available to create the index 03/09/2025, 08:27:36
2025-03-09 08:27:36,272 [INFO]: 730.8MB of memory will be needed to build the index (more might be used if you have more)
2025-03-09 08:27:36,272 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0005 secs
2025-03-09 08:27:36,272 [INFO]: 	Selecting most promising index types given data characteristics 03/09/2025, 08:27:36
2025-03-09 08:27:36,272 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-09 08:27:36,272 [INFO]: 	Creating the index 03/09/2025, 08:27:36
2025-03-09 08:27:36,273 [INFO]: 		-> Instanciate the index HNSW15 03/09/2025, 08:27:36
2025-03-09 08:27:36,276 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0028 secs
2025-03-09 08:27:36,276 [INFO]: 		-> Adding the vectors to the index 03/09/2025, 08:27:36
2025-03-09 08:27:36,276 [INFO]: The memory available for adding the vectors is 49.4GB(total available - used by the index)
2025-03-09 08:27:36,276 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/14 [00:00<?, ?it/s]  7%|▋         | 1/14 [00:00<00:02,  5.56it/s] 14%|█▍        | 2/14 [00:00<00:01,  7.42it/s] 21%|██▏       | 3/14 [00:00<00:01,  7.95it/s] 29%|██▊       | 4/14 [00:00<00:01,  8.25it/s] 36%|███▌      | 5/14 [00:00<00:01,  8.43it/s] 43%|████▎     | 6/14 [00:00<00:00,  8.52it/s] 50%|█████     | 7/14 [00:00<00:00,  8.53it/s] 57%|█████▋    | 8/14 [00:00<00:00,  8.72it/s] 64%|██████▍   | 9/14 [00:01<00:00,  8.91it/s] 79%|███████▊  | 11/14 [00:01<00:00,  9.35it/s] 86%|████████▌ | 12/14 [00:01<00:00,  9.18it/s] 93%|█████████▎| 13/14 [00:01<00:00,  9.21it/s]100%|██████████| 14/14 [00:04<00:00,  1.02s/it]100%|██████████| 14/14 [00:04<00:00,  2.84it/s]
2025-03-09 08:27:41,227 [INFO]: 	Computing best hyperparameters for index knn.index 03/09/2025, 08:27:41
2025-03-09 08:28:18,457 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 37.2294 secs
2025-03-09 08:28:18,457 [INFO]: The best hyperparameters are: efSearch=197
2025-03-09 08:28:18,457 [INFO]: 	Compute fast metrics 03/09/2025, 08:28:18
  0%|          | 0/4 [00:00<?, ?it/s] 25%|██▌       | 1/4 [00:00<00:00,  6.09it/s] 75%|███████▌  | 3/4 [00:00<00:00,  9.84it/s] 75%|███████▌  | 3/4 [00:00<00:00,  7.45it/s]
2025-03-09 08:28:34,823 [INFO]: 	>>> Finished "Compute fast metrics" in 16.3654 secs
2025-03-09 08:28:34,825 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 58.5494 secs
2025-03-09 08:28:34,826 [INFO]: {
2025-03-09 08:28:34,826 [INFO]: 	index_key: HNSW15
2025-03-09 08:28:34,826 [INFO]: 	index_param: efSearch=197
2025-03-09 08:28:34,826 [INFO]: 	index_path: knn.index
2025-03-09 08:28:34,826 [INFO]: 	size in bytes: 696669910
2025-03-09 08:28:34,826 [INFO]: 	avg_search_speed_ms: 8.347146746738252
2025-03-09 08:28:34,826 [INFO]: 	99p_search_speed_ms: 13.282773478422312
2025-03-09 08:28:34,826 [INFO]: 	reconstruction error %: 0.0
2025-03-09 08:28:34,826 [INFO]: 	nb vectors: 3541
2025-03-09 08:28:34,826 [INFO]: 	vectors dimension: 49152
2025-03-09 08:28:34,826 [INFO]: 	compression ratio: 0.9993095984294772
2025-03-09 08:28:34,826 [INFO]: }
2025-03-09 08:28:34,826 [INFO]: 	>>> Finished "Creating the index" in 58.5533 secs
2025-03-09 08:28:34,826 [INFO]: >>> Finished "Launching the whole pipeline" in 58.5851 secs
2025-03-09 08:28:35: [retrieval_preprocessing] calculating distances ...
2025-03-09 08:28:36: [retrieval_preprocessing] finished and saved retrieval indices for episode 44119 [episode count 19/20]
2025-03-09 08:28:36: [retrieval_preprocessing] finished for (441689524, 'mug') [chosen_id count 4/10]
2025-03-09 08:28:39: [retrieval_preprocessing] concatenated all embeddings and indices for 20 episodes for (8150285641, 'marker') [chosen_id count 5/10]
2025-03-09 08:28:39: [retrieval_preprocessing] we have num_total=5349 embedding_dim=49152
[retrieval_preprocessing] for episode 18307 [episode count 0/20], we have num_retrieval=np.int64(4867) num_query=np.int64(482)
2025-03-09 08:28:41,187 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-09 08:28:41,854 [INFO]: Launching the whole pipeline 03/09/2025, 08:28:41
2025-03-09 08:28:41,854 [INFO]: Reading total number of vectors and dimension 03/09/2025, 08:28:41
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1528.54it/s]
2025-03-09 08:28:41,882 [INFO]: There are 4867 embeddings of dim 49152
2025-03-09 08:28:41,883 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0287 secs
2025-03-09 08:28:41,883 [INFO]: 	Compute estimated construction time of the index 03/09/2025, 08:28:41
2025-03-09 08:28:41,883 [INFO]: 		-> Train: 16.7 minutes
2025-03-09 08:28:41,883 [INFO]: 		-> Add: 2.7 seconds
2025-03-09 08:28:41,883 [INFO]: 		Total: 16.7 minutes
2025-03-09 08:28:41,883 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0001 secs
2025-03-09 08:28:41,883 [INFO]: 	Checking that your have enough memory available to create the index 03/09/2025, 08:28:41
2025-03-09 08:28:41,883 [INFO]: 1004.4MB of memory will be needed to build the index (more might be used if you have more)
2025-03-09 08:28:41,883 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0001 secs
2025-03-09 08:28:41,883 [INFO]: 	Selecting most promising index types given data characteristics 03/09/2025, 08:28:41
2025-03-09 08:28:41,883 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-09 08:28:41,883 [INFO]: 	Creating the index 03/09/2025, 08:28:41
2025-03-09 08:28:41,883 [INFO]: 		-> Instanciate the index HNSW15 03/09/2025, 08:28:41
2025-03-09 08:28:41,884 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0008 secs
2025-03-09 08:28:41,884 [INFO]: 		-> Adding the vectors to the index 03/09/2025, 08:28:41
2025-03-09 08:28:41,884 [INFO]: The memory available for adding the vectors is 49.1GB(total available - used by the index)
2025-03-09 08:28:41,884 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/20 [00:00<?, ?it/s]  5%|▌         | 1/20 [00:00<00:03,  6.02it/s] 15%|█▌        | 3/20 [00:00<00:01,  9.44it/s] 25%|██▌       | 5/20 [00:00<00:01, 10.39it/s] 35%|███▌      | 7/20 [00:00<00:01, 10.71it/s] 45%|████▌     | 9/20 [00:00<00:01, 10.74it/s] 55%|█████▌    | 11/20 [00:01<00:00, 10.72it/s] 65%|██████▌   | 13/20 [00:01<00:00, 10.82it/s] 75%|███████▌  | 15/20 [00:01<00:00, 12.00it/s] 85%|████████▌ | 17/20 [00:01<00:00, 13.06it/s] 95%|█████████▌| 19/20 [00:01<00:00, 14.08it/s]100%|██████████| 20/20 [00:04<00:00,  4.04it/s]
2025-03-09 08:28:46,837 [INFO]: 	Computing best hyperparameters for index knn.index 03/09/2025, 08:28:46
2025-03-09 08:29:29,977 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 43.1399 secs
2025-03-09 08:29:29,978 [INFO]: The best hyperparameters are: efSearch=257
2025-03-09 08:29:29,978 [INFO]: 	Compute fast metrics 03/09/2025, 08:29:29
  0%|          | 0/4 [00:00<?, ?it/s] 25%|██▌       | 1/4 [00:00<00:00,  3.19it/s] 50%|█████     | 2/4 [00:00<00:00,  5.05it/s] 75%|███████▌  | 3/4 [00:00<00:00,  4.79it/s]
2025-03-09 08:29:49,289 [INFO]: 	>>> Finished "Compute fast metrics" in 19.3113 secs
2025-03-09 08:29:49,292 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 67.4081 secs
2025-03-09 08:29:49,292 [INFO]: {
2025-03-09 08:29:49,292 [INFO]: 	index_key: HNSW15
2025-03-09 08:29:49,292 [INFO]: 	index_param: efSearch=257
2025-03-09 08:29:49,292 [INFO]: 	index_path: knn.index
2025-03-09 08:29:49,292 [INFO]: 	size in bytes: 957553090
2025-03-09 08:29:49,292 [INFO]: 	avg_search_speed_ms: 13.3368816509222
2025-03-09 08:29:49,292 [INFO]: 	99p_search_speed_ms: 23.18002512678504
2025-03-09 08:29:49,292 [INFO]: 	reconstruction error %: 0.0
2025-03-09 08:29:49,292 [INFO]: 	nb vectors: 4867
2025-03-09 08:29:49,292 [INFO]: 	vectors dimension: 49152
2025-03-09 08:29:49,292 [INFO]: 	compression ratio: 0.9993087025597713
2025-03-09 08:29:49,293 [INFO]: }
2025-03-09 08:29:49,293 [INFO]: 	>>> Finished "Creating the index" in 67.4094 secs
2025-03-09 08:29:49,293 [INFO]: >>> Finished "Launching the whole pipeline" in 67.4387 secs
2025-03-09 08:29:52: [retrieval_preprocessing] calculating distances ...
2025-03-09 08:29:55: [retrieval_preprocessing] finished and saved retrieval indices for episode 18307 [episode count 0/20]
[retrieval_preprocessing] for episode 9221 [episode count 1/20], we have num_retrieval=np.int64(5111) num_query=np.int64(238)
2025-03-09 08:29:57,230 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-09 08:29:58,205 [INFO]: Launching the whole pipeline 03/09/2025, 08:29:58
2025-03-09 08:29:58,206 [INFO]: Reading total number of vectors and dimension 03/09/2025, 08:29:58
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1413.65it/s]
2025-03-09 08:29:58,238 [INFO]: There are 5111 embeddings of dim 49152
2025-03-09 08:29:58,238 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0323 secs
2025-03-09 08:29:58,238 [INFO]: 	Compute estimated construction time of the index 03/09/2025, 08:29:58
2025-03-09 08:29:58,238 [INFO]: 		-> Train: 16.7 minutes
2025-03-09 08:29:58,238 [INFO]: 		-> Add: 2.8 seconds
2025-03-09 08:29:58,238 [INFO]: 		Total: 16.7 minutes
2025-03-09 08:29:58,238 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0001 secs
2025-03-09 08:29:58,238 [INFO]: 	Checking that your have enough memory available to create the index 03/09/2025, 08:29:58
2025-03-09 08:29:58,238 [INFO]: 1.0GB of memory will be needed to build the index (more might be used if you have more)
2025-03-09 08:29:58,238 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0002 secs
2025-03-09 08:29:58,238 [INFO]: 	Selecting most promising index types given data characteristics 03/09/2025, 08:29:58
2025-03-09 08:29:58,238 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-09 08:29:58,238 [INFO]: 	Creating the index 03/09/2025, 08:29:58
2025-03-09 08:29:58,238 [INFO]: 		-> Instanciate the index HNSW15 03/09/2025, 08:29:58
2025-03-09 08:29:58,240 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0011 secs
2025-03-09 08:29:58,240 [INFO]: 		-> Adding the vectors to the index 03/09/2025, 08:29:58
2025-03-09 08:29:58,240 [INFO]: The memory available for adding the vectors is 49.1GB(total available - used by the index)
2025-03-09 08:29:58,240 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/22 [00:00<?, ?it/s]  5%|▍         | 1/22 [00:00<00:03,  6.01it/s]  9%|▉         | 2/22 [00:00<00:02,  7.47it/s] 14%|█▎        | 3/22 [00:00<00:02,  7.94it/s] 18%|█▊        | 4/22 [00:00<00:02,  8.12it/s] 23%|██▎       | 5/22 [00:00<00:02,  8.34it/s] 27%|██▋       | 6/22 [00:00<00:01,  8.56it/s] 32%|███▏      | 7/22 [00:00<00:01,  8.77it/s] 36%|███▋      | 8/22 [00:00<00:01,  8.72it/s] 41%|████      | 9/22 [00:01<00:01,  8.71it/s] 45%|████▌     | 10/22 [00:01<00:01,  8.64it/s] 50%|█████     | 11/22 [00:01<00:01,  8.69it/s] 55%|█████▍    | 12/22 [00:01<00:01,  8.63it/s] 59%|█████▉    | 13/22 [00:01<00:01,  8.64it/s] 64%|██████▎   | 14/22 [00:01<00:00,  8.49it/s] 68%|██████▊   | 15/22 [00:01<00:00,  8.72it/s] 73%|███████▎  | 16/22 [00:01<00:00,  8.79it/s] 77%|███████▋  | 17/22 [00:01<00:00,  8.93it/s] 82%|████████▏ | 18/22 [00:02<00:00,  9.02it/s] 86%|████████▋ | 19/22 [00:02<00:00,  8.99it/s] 91%|█████████ | 20/22 [00:02<00:00,  8.99it/s] 95%|█████████▌| 21/22 [00:05<00:01,  1.14s/it]100%|██████████| 22/22 [00:06<00:00,  1.00s/it]100%|██████████| 22/22 [00:06<00:00,  3.36it/s]
2025-03-09 08:30:05,089 [INFO]: 	Computing best hyperparameters for index knn.index 03/09/2025, 08:30:05
2025-03-09 08:30:47,895 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 42.8064 secs
2025-03-09 08:30:47,896 [INFO]: The best hyperparameters are: efSearch=224
2025-03-09 08:30:47,896 [INFO]: 	Compute fast metrics 03/09/2025, 08:30:47
  0%|          | 0/4 [00:00<?, ?it/s] 25%|██▌       | 1/4 [00:00<00:00,  5.20it/s] 50%|█████     | 2/4 [00:00<00:00,  7.02it/s] 75%|███████▌  | 3/4 [00:00<00:00,  7.77it/s] 75%|███████▌  | 3/4 [00:00<00:00,  5.76it/s]
2025-03-09 08:31:09,451 [INFO]: 	>>> Finished "Compute fast metrics" in 21.5551 secs
2025-03-09 08:31:09,903 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 71.6627 secs
2025-03-09 08:31:09,903 [INFO]: {
2025-03-09 08:31:09,903 [INFO]: 	index_key: HNSW15
2025-03-09 08:31:09,903 [INFO]: 	index_param: efSearch=224
2025-03-09 08:31:09,903 [INFO]: 	index_path: knn.index
2025-03-09 08:31:09,903 [INFO]: 	size in bytes: 1005558910
2025-03-09 08:31:09,903 [INFO]: 	avg_search_speed_ms: 9.233656011062605
2025-03-09 08:31:09,903 [INFO]: 	99p_search_speed_ms: 15.628157737664885
2025-03-09 08:31:09,903 [INFO]: 	reconstruction error %: 0.0
2025-03-09 08:31:09,903 [INFO]: 	nb vectors: 5111
2025-03-09 08:31:09,904 [INFO]: 	vectors dimension: 49152
2025-03-09 08:31:09,904 [INFO]: 	compression ratio: 0.9993084224175389
2025-03-09 08:31:09,904 [INFO]: }
2025-03-09 08:31:09,904 [INFO]: 	>>> Finished "Creating the index" in 71.6652 secs
2025-03-09 08:31:09,904 [INFO]: >>> Finished "Launching the whole pipeline" in 71.6982 secs
2025-03-09 08:31:11: [retrieval_preprocessing] calculating distances ...
2025-03-09 08:31:12: [retrieval_preprocessing] finished and saved retrieval indices for episode 9221 [episode count 1/20]
[retrieval_preprocessing] for episode 8329 [episode count 2/20], we have num_retrieval=np.int64(4973) num_query=np.int64(376)
2025-03-09 08:31:13,750 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-09 08:31:14,392 [INFO]: Launching the whole pipeline 03/09/2025, 08:31:14
2025-03-09 08:31:14,393 [INFO]: Reading total number of vectors and dimension 03/09/2025, 08:31:14
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1461.43it/s]
2025-03-09 08:31:14,693 [INFO]: There are 4973 embeddings of dim 49152
2025-03-09 08:31:14,693 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.3003 secs
2025-03-09 08:31:14,693 [INFO]: 	Compute estimated construction time of the index 03/09/2025, 08:31:14
2025-03-09 08:31:14,693 [INFO]: 		-> Train: 16.7 minutes
2025-03-09 08:31:14,693 [INFO]: 		-> Add: 2.7 seconds
2025-03-09 08:31:14,693 [INFO]: 		Total: 16.7 minutes
2025-03-09 08:31:14,693 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0001 secs
2025-03-09 08:31:14,693 [INFO]: 	Checking that your have enough memory available to create the index 03/09/2025, 08:31:14
2025-03-09 08:31:14,693 [INFO]: 1.0GB of memory will be needed to build the index (more might be used if you have more)
2025-03-09 08:31:14,693 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0002 secs
2025-03-09 08:31:14,693 [INFO]: 	Selecting most promising index types given data characteristics 03/09/2025, 08:31:14
2025-03-09 08:31:14,693 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-09 08:31:14,693 [INFO]: 	Creating the index 03/09/2025, 08:31:14
2025-03-09 08:31:14,694 [INFO]: 		-> Instanciate the index HNSW15 03/09/2025, 08:31:14
2025-03-09 08:31:14,695 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0012 secs
2025-03-09 08:31:14,695 [INFO]: 		-> Adding the vectors to the index 03/09/2025, 08:31:14
2025-03-09 08:31:14,695 [INFO]: The memory available for adding the vectors is 49.1GB(total available - used by the index)
2025-03-09 08:31:14,695 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/20 [00:00<?, ?it/s]  5%|▌         | 1/20 [00:00<00:03,  4.81it/s] 10%|█         | 2/20 [00:00<00:02,  6.53it/s] 15%|█▌        | 3/20 [00:00<00:02,  7.37it/s] 20%|██        | 4/20 [00:00<00:02,  7.84it/s] 25%|██▌       | 5/20 [00:00<00:01,  8.16it/s] 30%|███       | 6/20 [00:00<00:01,  8.31it/s] 35%|███▌      | 7/20 [00:00<00:01,  8.56it/s] 40%|████      | 8/20 [00:01<00:01,  8.63it/s] 45%|████▌     | 9/20 [00:01<00:01,  8.62it/s] 50%|█████     | 10/20 [00:01<00:01,  8.56it/s] 55%|█████▌    | 11/20 [00:01<00:01,  8.62it/s] 60%|██████    | 12/20 [00:01<00:00,  8.67it/s] 65%|██████▌   | 13/20 [00:01<00:00,  8.81it/s] 70%|███████   | 14/20 [00:01<00:00,  8.70it/s] 75%|███████▌  | 15/20 [00:01<00:00,  8.40it/s] 80%|████████  | 16/20 [00:01<00:00,  8.31it/s] 85%|████████▌ | 17/20 [00:02<00:00,  8.37it/s] 95%|█████████▌| 19/20 [00:02<00:00,  9.85it/s]100%|██████████| 20/20 [00:05<00:00,  1.02it/s]100%|██████████| 20/20 [00:05<00:00,  3.42it/s]
2025-03-09 08:31:20,552 [INFO]: 	Computing best hyperparameters for index knn.index 03/09/2025, 08:31:20
2025-03-09 08:32:01,520 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 40.9672 secs
2025-03-09 08:32:01,520 [INFO]: The best hyperparameters are: efSearch=159
2025-03-09 08:32:01,520 [INFO]: 	Compute fast metrics 03/09/2025, 08:32:01
  0%|          | 0/4 [00:00<?, ?it/s] 25%|██▌       | 1/4 [00:00<00:00,  7.13it/s] 75%|███████▌  | 3/4 [00:00<00:00, 10.25it/s] 75%|███████▌  | 3/4 [00:00<00:00,  7.78it/s]
2025-03-09 08:32:15,662 [INFO]: 	>>> Finished "Compute fast metrics" in 14.1415 secs
2025-03-09 08:32:16,497 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 61.8022 secs
2025-03-09 08:32:16,498 [INFO]: {
2025-03-09 08:32:16,498 [INFO]: 	index_key: HNSW15
2025-03-09 08:32:16,498 [INFO]: 	index_param: efSearch=159
2025-03-09 08:32:16,498 [INFO]: 	index_path: knn.index
2025-03-09 08:32:16,498 [INFO]: 	size in bytes: 978407950
2025-03-09 08:32:16,498 [INFO]: 	avg_search_speed_ms: 6.9898368327362315
2025-03-09 08:32:16,498 [INFO]: 	99p_search_speed_ms: 12.44647689163685
2025-03-09 08:32:16,498 [INFO]: 	reconstruction error %: 0.0
2025-03-09 08:32:16,498 [INFO]: 	nb vectors: 4973
2025-03-09 08:32:16,498 [INFO]: 	vectors dimension: 49152
2025-03-09 08:32:16,498 [INFO]: 	compression ratio: 0.9993087075794918
2025-03-09 08:32:16,498 [INFO]: }
2025-03-09 08:32:16,498 [INFO]: 	>>> Finished "Creating the index" in 61.8047 secs
2025-03-09 08:32:16,498 [INFO]: >>> Finished "Launching the whole pipeline" in 62.1057 secs
2025-03-09 08:32:17: [retrieval_preprocessing] calculating distances ...
2025-03-09 08:32:19: [retrieval_preprocessing] finished and saved retrieval indices for episode 8329 [episode count 2/20]
[retrieval_preprocessing] for episode 37385 [episode count 3/20], we have num_retrieval=np.int64(5177) num_query=np.int64(172)
2025-03-09 08:32:20,688 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-09 08:32:21,718 [INFO]: Launching the whole pipeline 03/09/2025, 08:32:21
2025-03-09 08:32:21,718 [INFO]: Reading total number of vectors and dimension 03/09/2025, 08:32:21
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1473.75it/s]
2025-03-09 08:32:21,745 [INFO]: There are 5177 embeddings of dim 49152
2025-03-09 08:32:21,746 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0278 secs
2025-03-09 08:32:21,746 [INFO]: 	Compute estimated construction time of the index 03/09/2025, 08:32:21
2025-03-09 08:32:21,746 [INFO]: 		-> Train: 16.7 minutes
2025-03-09 08:32:21,746 [INFO]: 		-> Add: 2.8 seconds
2025-03-09 08:32:21,746 [INFO]: 		Total: 16.7 minutes
2025-03-09 08:32:21,746 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0004 secs
2025-03-09 08:32:21,746 [INFO]: 	Checking that your have enough memory available to create the index 03/09/2025, 08:32:21
2025-03-09 08:32:21,747 [INFO]: 1.0GB of memory will be needed to build the index (more might be used if you have more)
2025-03-09 08:32:21,747 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0005 secs
2025-03-09 08:32:21,747 [INFO]: 	Selecting most promising index types given data characteristics 03/09/2025, 08:32:21
2025-03-09 08:32:21,747 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-09 08:32:21,748 [INFO]: 	Creating the index 03/09/2025, 08:32:21
2025-03-09 08:32:21,748 [INFO]: 		-> Instanciate the index HNSW15 03/09/2025, 08:32:21
2025-03-09 08:32:21,751 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0026 secs
2025-03-09 08:32:21,751 [INFO]: 		-> Adding the vectors to the index 03/09/2025, 08:32:21
2025-03-09 08:32:21,751 [INFO]: The memory available for adding the vectors is 49.1GB(total available - used by the index)
2025-03-09 08:32:21,751 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/22 [00:00<?, ?it/s]  5%|▍         | 1/22 [00:00<00:03,  5.86it/s] 14%|█▎        | 3/22 [00:00<00:01,  9.56it/s] 23%|██▎       | 5/22 [00:00<00:01, 10.89it/s] 32%|███▏      | 7/22 [00:00<00:01, 11.21it/s] 41%|████      | 9/22 [00:00<00:01, 11.66it/s] 50%|█████     | 11/22 [00:00<00:00, 11.86it/s] 59%|█████▉    | 13/22 [00:01<00:00, 11.96it/s] 68%|██████▊   | 15/22 [00:01<00:00, 12.15it/s] 77%|███████▋  | 17/22 [00:01<00:00, 12.27it/s] 86%|████████▋ | 19/22 [00:01<00:00, 12.21it/s] 95%|█████████▌| 21/22 [00:05<00:00,  1.65it/s]100%|██████████| 22/22 [00:06<00:00,  1.50it/s]100%|██████████| 22/22 [00:06<00:00,  3.57it/s]
2025-03-09 08:32:27,922 [INFO]: 	Computing best hyperparameters for index knn.index 03/09/2025, 08:32:27
2025-03-09 08:33:10,279 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 42.3569 secs
2025-03-09 08:33:10,279 [INFO]: The best hyperparameters are: efSearch=211
2025-03-09 08:33:10,279 [INFO]: 	Compute fast metrics 03/09/2025, 08:33:10
  0%|          | 0/4 [00:00<?, ?it/s] 25%|██▌       | 1/4 [00:00<00:00,  5.25it/s] 50%|█████     | 2/4 [00:00<00:00,  6.98it/s] 75%|███████▌  | 3/4 [00:00<00:00,  7.58it/s] 75%|███████▌  | 3/4 [00:00<00:00,  5.68it/s]
2025-03-09 08:33:29,288 [INFO]: 	>>> Finished "Compute fast metrics" in 19.0087 secs
2025-03-09 08:33:29,288 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 67.5372 secs
2025-03-09 08:33:29,289 [INFO]: {
2025-03-09 08:33:29,289 [INFO]: 	index_key: HNSW15
2025-03-09 08:33:29,289 [INFO]: 	index_param: efSearch=211
2025-03-09 08:33:29,289 [INFO]: 	index_path: knn.index
2025-03-09 08:33:29,289 [INFO]: 	size in bytes: 1018543990
2025-03-09 08:33:29,289 [INFO]: 	avg_search_speed_ms: 9.517996081263608
2025-03-09 08:33:29,289 [INFO]: 	99p_search_speed_ms: 17.483672592788935
2025-03-09 08:33:29,289 [INFO]: 	reconstruction error %: 0.0
2025-03-09 08:33:29,289 [INFO]: 	nb vectors: 5177
2025-03-09 08:33:29,289 [INFO]: 	vectors dimension: 49152
2025-03-09 08:33:29,289 [INFO]: 	compression ratio: 0.9993084500945315
2025-03-09 08:33:29,289 [INFO]: }
2025-03-09 08:33:29,289 [INFO]: 	>>> Finished "Creating the index" in 67.5410 secs
2025-03-09 08:33:29,289 [INFO]: >>> Finished "Launching the whole pipeline" in 67.5711 secs
2025-03-09 08:33:30: [retrieval_preprocessing] calculating distances ...
2025-03-09 08:33:30: [retrieval_preprocessing] finished and saved retrieval indices for episode 37385 [episode count 3/20]
[retrieval_preprocessing] for episode 55946 [episode count 4/20], we have num_retrieval=np.int64(5231) num_query=np.int64(118)
2025-03-09 08:33:32,221 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-09 08:33:32,909 [INFO]: Launching the whole pipeline 03/09/2025, 08:33:32
2025-03-09 08:33:32,909 [INFO]: Reading total number of vectors and dimension 03/09/2025, 08:33:32
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 2495.12it/s]
2025-03-09 08:33:32,933 [INFO]: There are 5231 embeddings of dim 49152
2025-03-09 08:33:32,933 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0244 secs
2025-03-09 08:33:32,933 [INFO]: 	Compute estimated construction time of the index 03/09/2025, 08:33:32
2025-03-09 08:33:32,934 [INFO]: 		-> Train: 16.7 minutes
2025-03-09 08:33:32,934 [INFO]: 		-> Add: 2.9 seconds
2025-03-09 08:33:32,934 [INFO]: 		Total: 16.7 minutes
2025-03-09 08:33:32,934 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0003 secs
2025-03-09 08:33:32,934 [INFO]: 	Checking that your have enough memory available to create the index 03/09/2025, 08:33:32
2025-03-09 08:33:32,934 [INFO]: 1.1GB of memory will be needed to build the index (more might be used if you have more)
2025-03-09 08:33:32,934 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0004 secs
2025-03-09 08:33:32,935 [INFO]: 	Selecting most promising index types given data characteristics 03/09/2025, 08:33:32
2025-03-09 08:33:32,935 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-09 08:33:32,935 [INFO]: 	Creating the index 03/09/2025, 08:33:32
2025-03-09 08:33:32,935 [INFO]: 		-> Instanciate the index HNSW15 03/09/2025, 08:33:32
2025-03-09 08:33:32,938 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0027 secs
2025-03-09 08:33:32,938 [INFO]: 		-> Adding the vectors to the index 03/09/2025, 08:33:32
2025-03-09 08:33:32,938 [INFO]: The memory available for adding the vectors is 49.0GB(total available - used by the index)
2025-03-09 08:33:32,938 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/22 [00:00<?, ?it/s]  5%|▍         | 1/22 [00:00<00:03,  5.56it/s] 14%|█▎        | 3/22 [00:00<00:02,  9.30it/s] 23%|██▎       | 5/22 [00:00<00:01, 10.26it/s] 32%|███▏      | 7/22 [00:00<00:01, 10.75it/s] 41%|████      | 9/22 [00:00<00:01, 10.90it/s] 50%|█████     | 11/22 [00:01<00:00, 11.46it/s] 59%|█████▉    | 13/22 [00:01<00:00, 11.81it/s] 68%|██████▊   | 15/22 [00:01<00:00, 12.04it/s] 77%|███████▋  | 17/22 [00:01<00:00, 12.20it/s] 86%|████████▋ | 19/22 [00:01<00:00, 12.37it/s] 95%|█████████▌| 21/22 [00:05<00:00,  1.62it/s]100%|██████████| 22/22 [00:06<00:00,  1.50it/s]100%|██████████| 22/22 [00:06<00:00,  3.54it/s]
2025-03-09 08:33:39,162 [INFO]: 	Computing best hyperparameters for index knn.index 03/09/2025, 08:33:39
2025-03-09 08:34:26,341 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 47.1781 secs
2025-03-09 08:34:26,341 [INFO]: The best hyperparameters are: efSearch=204
2025-03-09 08:34:26,341 [INFO]: 	Compute fast metrics 03/09/2025, 08:34:26
  0%|          | 0/4 [00:00<?, ?it/s] 25%|██▌       | 1/4 [00:00<00:00,  4.94it/s] 50%|█████     | 2/4 [00:00<00:00,  6.75it/s] 75%|███████▌  | 3/4 [00:00<00:00,  7.52it/s] 75%|███████▌  | 3/4 [00:00<00:00,  5.58it/s]
2025-03-09 08:34:47,001 [INFO]: 	>>> Finished "Compute fast metrics" in 20.6601 secs
2025-03-09 08:34:47,002 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 74.0635 secs
2025-03-09 08:34:47,002 [INFO]: {
2025-03-09 08:34:47,002 [INFO]: 	index_key: HNSW15
2025-03-09 08:34:47,002 [INFO]: 	index_param: efSearch=204
2025-03-09 08:34:47,002 [INFO]: 	index_path: knn.index
2025-03-09 08:34:47,002 [INFO]: 	size in bytes: 1029168310
2025-03-09 08:34:47,002 [INFO]: 	avg_search_speed_ms: 8.883339420314977
2025-03-09 08:34:47,002 [INFO]: 	99p_search_speed_ms: 15.715847781393677
2025-03-09 08:34:47,002 [INFO]: 	reconstruction error %: 0.0
2025-03-09 08:34:47,002 [INFO]: 	nb vectors: 5231
2025-03-09 08:34:47,002 [INFO]: 	vectors dimension: 49152
2025-03-09 08:34:47,002 [INFO]: 	compression ratio: 0.9993083133311791
2025-03-09 08:34:47,002 [INFO]: }
2025-03-09 08:34:47,002 [INFO]: 	>>> Finished "Creating the index" in 74.0670 secs
2025-03-09 08:34:47,002 [INFO]: >>> Finished "Launching the whole pipeline" in 74.0931 secs
2025-03-09 08:34:47: [retrieval_preprocessing] calculating distances ...
2025-03-09 08:34:48: [retrieval_preprocessing] finished and saved retrieval indices for episode 55946 [episode count 4/20]
[retrieval_preprocessing] for episode 10252 [episode count 5/20], we have num_retrieval=np.int64(5242) num_query=np.int64(107)
2025-03-09 08:34:49,623 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-09 08:34:50,442 [INFO]: Launching the whole pipeline 03/09/2025, 08:34:50
2025-03-09 08:34:50,442 [INFO]: Reading total number of vectors and dimension 03/09/2025, 08:34:50
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1219.27it/s]
2025-03-09 08:34:50,843 [INFO]: There are 5242 embeddings of dim 49152
2025-03-09 08:34:50,843 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.4007 secs
2025-03-09 08:34:50,843 [INFO]: 	Compute estimated construction time of the index 03/09/2025, 08:34:50
2025-03-09 08:34:50,843 [INFO]: 		-> Train: 16.7 minutes
2025-03-09 08:34:50,843 [INFO]: 		-> Add: 2.9 seconds
2025-03-09 08:34:50,843 [INFO]: 		Total: 16.7 minutes
2025-03-09 08:34:50,843 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0002 secs
2025-03-09 08:34:50,844 [INFO]: 	Checking that your have enough memory available to create the index 03/09/2025, 08:34:50
2025-03-09 08:34:50,844 [INFO]: 1.1GB of memory will be needed to build the index (more might be used if you have more)
2025-03-09 08:34:50,844 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0003 secs
2025-03-09 08:34:50,844 [INFO]: 	Selecting most promising index types given data characteristics 03/09/2025, 08:34:50
2025-03-09 08:34:50,844 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-09 08:34:50,844 [INFO]: 	Creating the index 03/09/2025, 08:34:50
2025-03-09 08:34:50,844 [INFO]: 		-> Instanciate the index HNSW15 03/09/2025, 08:34:50
2025-03-09 08:34:50,846 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0021 secs
2025-03-09 08:34:50,847 [INFO]: 		-> Adding the vectors to the index 03/09/2025, 08:34:50
2025-03-09 08:34:50,847 [INFO]: The memory available for adding the vectors is 49.0GB(total available - used by the index)
2025-03-09 08:34:50,847 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/22 [00:00<?, ?it/s]  5%|▍         | 1/22 [00:00<00:04,  4.85it/s]  9%|▉         | 2/22 [00:00<00:03,  6.42it/s] 14%|█▎        | 3/22 [00:00<00:02,  7.30it/s] 18%|█▊        | 4/22 [00:00<00:02,  7.81it/s] 23%|██▎       | 5/22 [00:00<00:02,  8.17it/s] 27%|██▋       | 6/22 [00:00<00:01,  8.39it/s] 32%|███▏      | 7/22 [00:00<00:01,  8.45it/s] 36%|███▋      | 8/22 [00:01<00:01,  8.56it/s] 41%|████      | 9/22 [00:01<00:01,  8.61it/s] 45%|████▌     | 10/22 [00:01<00:01,  8.78it/s] 50%|█████     | 11/22 [00:01<00:01,  8.71it/s] 55%|█████▍    | 12/22 [00:01<00:01,  8.72it/s] 59%|█████▉    | 13/22 [00:01<00:01,  8.78it/s] 64%|██████▎   | 14/22 [00:01<00:00,  8.83it/s] 68%|██████▊   | 15/22 [00:01<00:00,  8.94it/s] 73%|███████▎  | 16/22 [00:01<00:00,  8.84it/s] 77%|███████▋  | 17/22 [00:02<00:00,  8.81it/s] 82%|████████▏ | 18/22 [00:02<00:00,  8.99it/s] 91%|█████████ | 20/22 [00:02<00:00, 10.45it/s]100%|██████████| 22/22 [00:06<00:00,  1.06it/s]100%|██████████| 22/22 [00:06<00:00,  3.27it/s]
2025-03-09 08:34:57,577 [INFO]: 	Computing best hyperparameters for index knn.index 03/09/2025, 08:34:57
2025-03-09 08:35:38,937 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 41.3605 secs
2025-03-09 08:35:38,937 [INFO]: The best hyperparameters are: efSearch=186
2025-03-09 08:35:38,938 [INFO]: 	Compute fast metrics 03/09/2025, 08:35:38
  0%|          | 0/4 [00:00<?, ?it/s] 25%|██▌       | 1/4 [00:00<00:00,  5.40it/s] 50%|█████     | 2/4 [00:00<00:00,  6.84it/s] 75%|███████▌  | 3/4 [00:00<00:00,  7.40it/s] 75%|███████▌  | 3/4 [00:00<00:00,  5.50it/s]
2025-03-09 08:36:01,759 [INFO]: 	>>> Finished "Compute fast metrics" in 22.8213 secs
2025-03-09 08:36:01,759 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 70.9128 secs
2025-03-09 08:36:01,760 [INFO]: {
2025-03-09 08:36:01,760 [INFO]: 	index_key: HNSW15
2025-03-09 08:36:01,760 [INFO]: 	index_param: efSearch=186
2025-03-09 08:36:01,760 [INFO]: 	index_path: knn.index
2025-03-09 08:36:01,760 [INFO]: 	size in bytes: 1031332510
2025-03-09 08:36:01,760 [INFO]: 	avg_search_speed_ms: 9.216499268957135
2025-03-09 08:36:01,760 [INFO]: 	99p_search_speed_ms: 18.481213627383134
2025-03-09 08:36:01,760 [INFO]: 	reconstruction error %: 0.0
2025-03-09 08:36:01,760 [INFO]: 	nb vectors: 5242
2025-03-09 08:36:01,760 [INFO]: 	vectors dimension: 49152
2025-03-09 08:36:01,760 [INFO]: 	compression ratio: 0.9993082987367479
2025-03-09 08:36:01,760 [INFO]: }
2025-03-09 08:36:01,760 [INFO]: 	>>> Finished "Creating the index" in 70.9156 secs
2025-03-09 08:36:01,760 [INFO]: >>> Finished "Launching the whole pipeline" in 71.3176 secs
2025-03-09 08:36:02: [retrieval_preprocessing] calculating distances ...
2025-03-09 08:36:02: [retrieval_preprocessing] finished and saved retrieval indices for episode 10252 [episode count 5/20]
[retrieval_preprocessing] for episode 16013 [episode count 6/20], we have num_retrieval=np.int64(5157) num_query=np.int64(192)
2025-03-09 08:36:05,223 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-09 08:36:06,239 [INFO]: Launching the whole pipeline 03/09/2025, 08:36:06
2025-03-09 08:36:06,239 [INFO]: Reading total number of vectors and dimension 03/09/2025, 08:36:06
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1269.85it/s]
2025-03-09 08:36:06,267 [INFO]: There are 5157 embeddings of dim 49152
2025-03-09 08:36:06,267 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0282 secs
2025-03-09 08:36:06,267 [INFO]: 	Compute estimated construction time of the index 03/09/2025, 08:36:06
2025-03-09 08:36:06,267 [INFO]: 		-> Train: 16.7 minutes
2025-03-09 08:36:06,267 [INFO]: 		-> Add: 2.8 seconds
2025-03-09 08:36:06,267 [INFO]: 		Total: 16.7 minutes
2025-03-09 08:36:06,267 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0001 secs
2025-03-09 08:36:06,267 [INFO]: 	Checking that your have enough memory available to create the index 03/09/2025, 08:36:06
2025-03-09 08:36:06,267 [INFO]: 1.0GB of memory will be needed to build the index (more might be used if you have more)
2025-03-09 08:36:06,267 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0002 secs
2025-03-09 08:36:06,268 [INFO]: 	Selecting most promising index types given data characteristics 03/09/2025, 08:36:06
2025-03-09 08:36:06,268 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-09 08:36:06,268 [INFO]: 	Creating the index 03/09/2025, 08:36:06
2025-03-09 08:36:06,268 [INFO]: 		-> Instanciate the index HNSW15 03/09/2025, 08:36:06
2025-03-09 08:36:06,269 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0012 secs
2025-03-09 08:36:06,269 [INFO]: 		-> Adding the vectors to the index 03/09/2025, 08:36:06
2025-03-09 08:36:06,269 [INFO]: The memory available for adding the vectors is 49.1GB(total available - used by the index)
2025-03-09 08:36:06,269 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/22 [00:00<?, ?it/s]  5%|▍         | 1/22 [00:00<00:04,  4.88it/s]  9%|▉         | 2/22 [00:00<00:02,  6.75it/s] 14%|█▎        | 3/22 [00:00<00:02,  7.50it/s] 18%|█▊        | 4/22 [00:00<00:02,  7.97it/s] 23%|██▎       | 5/22 [00:00<00:02,  8.24it/s] 27%|██▋       | 6/22 [00:00<00:01,  8.41it/s] 32%|███▏      | 7/22 [00:00<00:02,  7.37it/s] 36%|███▋      | 8/22 [00:01<00:02,  6.45it/s] 41%|████      | 9/22 [00:01<00:01,  7.17it/s] 45%|████▌     | 10/22 [00:01<00:01,  7.61it/s] 50%|█████     | 11/22 [00:01<00:01,  7.91it/s] 55%|█████▍    | 12/22 [00:01<00:01,  8.23it/s] 59%|█████▉    | 13/22 [00:01<00:01,  8.43it/s] 64%|██████▎   | 14/22 [00:01<00:00,  8.59it/s] 68%|██████▊   | 15/22 [00:01<00:00,  8.67it/s] 73%|███████▎  | 16/22 [00:02<00:00,  8.74it/s] 77%|███████▋  | 17/22 [00:02<00:00,  8.79it/s] 82%|████████▏ | 18/22 [00:02<00:00,  9.04it/s] 86%|████████▋ | 19/22 [00:02<00:00,  9.12it/s] 91%|█████████ | 20/22 [00:02<00:00,  9.16it/s] 95%|█████████▌| 21/22 [00:05<00:01,  1.12s/it]100%|██████████| 22/22 [00:06<00:00,  1.06s/it]100%|██████████| 22/22 [00:06<00:00,  3.20it/s]
2025-03-09 08:36:13,140 [INFO]: 	Computing best hyperparameters for index knn.index 03/09/2025, 08:36:13
2025-03-09 08:37:00,505 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 47.3647 secs
2025-03-09 08:37:00,505 [INFO]: The best hyperparameters are: efSearch=215
2025-03-09 08:37:00,505 [INFO]: 	Compute fast metrics 03/09/2025, 08:37:00
  0%|          | 0/4 [00:00<?, ?it/s] 25%|██▌       | 1/4 [00:00<00:00,  4.98it/s] 50%|█████     | 2/4 [00:00<00:00,  6.76it/s] 75%|███████▌  | 3/4 [00:00<00:00,  7.48it/s] 75%|███████▌  | 3/4 [00:00<00:00,  5.56it/s]
2025-03-09 08:37:21,919 [INFO]: 	>>> Finished "Compute fast metrics" in 21.4135 secs
2025-03-09 08:37:21,919 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 75.6504 secs
2025-03-09 08:37:21,919 [INFO]: {
2025-03-09 08:37:21,920 [INFO]: 	index_key: HNSW15
2025-03-09 08:37:21,920 [INFO]: 	index_param: efSearch=215
2025-03-09 08:37:21,920 [INFO]: 	index_path: knn.index
2025-03-09 08:37:21,920 [INFO]: 	size in bytes: 1014609070
2025-03-09 08:37:21,920 [INFO]: 	avg_search_speed_ms: 9.26497346200256
2025-03-09 08:37:21,920 [INFO]: 	99p_search_speed_ms: 14.36114278621972
2025-03-09 08:37:21,920 [INFO]: 	reconstruction error %: 0.0
2025-03-09 08:37:21,920 [INFO]: 	nb vectors: 5157
2025-03-09 08:37:21,920 [INFO]: 	vectors dimension: 49152
2025-03-09 08:37:21,920 [INFO]: 	compression ratio: 0.9993084883422144
2025-03-09 08:37:21,920 [INFO]: }
2025-03-09 08:37:21,920 [INFO]: 	>>> Finished "Creating the index" in 75.6520 secs
2025-03-09 08:37:21,920 [INFO]: >>> Finished "Launching the whole pipeline" in 75.6809 secs
2025-03-09 08:37:23: [retrieval_preprocessing] calculating distances ...
2025-03-09 08:37:23: [retrieval_preprocessing] finished and saved retrieval indices for episode 16013 [episode count 6/20]
[retrieval_preprocessing] for episode 77962 [episode count 7/20], we have num_retrieval=np.int64(4982) num_query=np.int64(367)
2025-03-09 08:37:25,384 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-09 08:37:26,114 [INFO]: Launching the whole pipeline 03/09/2025, 08:37:26
2025-03-09 08:37:26,114 [INFO]: Reading total number of vectors and dimension 03/09/2025, 08:37:26
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1461.43it/s]
2025-03-09 08:37:26,145 [INFO]: There are 4982 embeddings of dim 49152
2025-03-09 08:37:26,145 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0312 secs
2025-03-09 08:37:26,146 [INFO]: 	Compute estimated construction time of the index 03/09/2025, 08:37:26
2025-03-09 08:37:26,146 [INFO]: 		-> Train: 16.7 minutes
2025-03-09 08:37:26,146 [INFO]: 		-> Add: 2.7 seconds
2025-03-09 08:37:26,146 [INFO]: 		Total: 16.7 minutes
2025-03-09 08:37:26,146 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0004 secs
2025-03-09 08:37:26,146 [INFO]: 	Checking that your have enough memory available to create the index 03/09/2025, 08:37:26
2025-03-09 08:37:26,146 [INFO]: 1.0GB of memory will be needed to build the index (more might be used if you have more)
2025-03-09 08:37:26,147 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0005 secs
2025-03-09 08:37:26,147 [INFO]: 	Selecting most promising index types given data characteristics 03/09/2025, 08:37:26
2025-03-09 08:37:26,147 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-09 08:37:26,147 [INFO]: 	Creating the index 03/09/2025, 08:37:26
2025-03-09 08:37:26,147 [INFO]: 		-> Instanciate the index HNSW15 03/09/2025, 08:37:26
2025-03-09 08:37:26,150 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0027 secs
2025-03-09 08:37:26,150 [INFO]: 		-> Adding the vectors to the index 03/09/2025, 08:37:26
2025-03-09 08:37:26,151 [INFO]: The memory available for adding the vectors is 49.1GB(total available - used by the index)
2025-03-09 08:37:26,151 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/20 [00:00<?, ?it/s]  5%|▌         | 1/20 [00:00<00:03,  5.79it/s] 15%|█▌        | 3/20 [00:00<00:01,  9.41it/s] 25%|██▌       | 5/20 [00:00<00:01, 10.69it/s] 35%|███▌      | 7/20 [00:00<00:01, 11.37it/s] 45%|████▌     | 9/20 [00:00<00:00, 11.90it/s] 55%|█████▌    | 11/20 [00:00<00:00, 12.12it/s] 65%|██████▌   | 13/20 [00:01<00:00, 12.17it/s] 75%|███████▌  | 15/20 [00:01<00:00, 12.13it/s] 85%|████████▌ | 17/20 [00:01<00:00, 12.18it/s] 95%|█████████▌| 19/20 [00:01<00:00, 12.27it/s]100%|██████████| 20/20 [00:05<00:00,  3.80it/s]
2025-03-09 08:37:31,422 [INFO]: 	Computing best hyperparameters for index knn.index 03/09/2025, 08:37:31
2025-03-09 08:38:11,220 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 39.7977 secs
2025-03-09 08:38:11,221 [INFO]: The best hyperparameters are: efSearch=248
2025-03-09 08:38:11,221 [INFO]: 	Compute fast metrics 03/09/2025, 08:38:11
  0%|          | 0/4 [00:00<?, ?it/s] 25%|██▌       | 1/4 [00:00<00:00,  5.27it/s] 50%|█████     | 2/4 [00:00<00:00,  6.73it/s] 75%|███████▌  | 3/4 [00:00<00:00,  7.46it/s] 75%|███████▌  | 3/4 [00:00<00:00,  6.18it/s]
2025-03-09 08:38:32,148 [INFO]: 	>>> Finished "Compute fast metrics" in 20.9269 secs
2025-03-09 08:38:32,152 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 66.0017 secs
2025-03-09 08:38:32,152 [INFO]: {
2025-03-09 08:38:32,152 [INFO]: 	index_key: HNSW15
2025-03-09 08:38:32,152 [INFO]: 	index_param: efSearch=248
2025-03-09 08:38:32,152 [INFO]: 	index_path: knn.index
2025-03-09 08:38:32,152 [INFO]: 	size in bytes: 980178670
2025-03-09 08:38:32,152 [INFO]: 	avg_search_speed_ms: 10.216135495752324
2025-03-09 08:38:32,152 [INFO]: 	99p_search_speed_ms: 17.7277042483911
2025-03-09 08:38:32,152 [INFO]: 	reconstruction error %: 0.0
2025-03-09 08:38:32,152 [INFO]: 	nb vectors: 4982
2025-03-09 08:38:32,152 [INFO]: 	vectors dimension: 49152
2025-03-09 08:38:32,153 [INFO]: 	compression ratio: 0.9993086831812
2025-03-09 08:38:32,153 [INFO]: }
2025-03-09 08:38:32,153 [INFO]: 	>>> Finished "Creating the index" in 66.0053 secs
2025-03-09 08:38:32,153 [INFO]: >>> Finished "Launching the whole pipeline" in 66.0385 secs
2025-03-09 08:38:34: [retrieval_preprocessing] calculating distances ...
2025-03-09 08:38:36: [retrieval_preprocessing] finished and saved retrieval indices for episode 77962 [episode count 7/20]
[retrieval_preprocessing] for episode 93582 [episode count 8/20], we have num_retrieval=np.int64(5181) num_query=np.int64(168)
2025-03-09 08:38:38,293 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-09 08:38:39,141 [INFO]: Launching the whole pipeline 03/09/2025, 08:38:39
2025-03-09 08:38:39,141 [INFO]: Reading total number of vectors and dimension 03/09/2025, 08:38:39
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 982.73it/s]
2025-03-09 08:38:39,168 [INFO]: There are 5181 embeddings of dim 49152
2025-03-09 08:38:39,169 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0277 secs
2025-03-09 08:38:39,169 [INFO]: 	Compute estimated construction time of the index 03/09/2025, 08:38:39
2025-03-09 08:38:39,169 [INFO]: 		-> Train: 16.7 minutes
2025-03-09 08:38:39,169 [INFO]: 		-> Add: 2.8 seconds
2025-03-09 08:38:39,169 [INFO]: 		Total: 16.7 minutes
2025-03-09 08:38:39,169 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0001 secs
2025-03-09 08:38:39,169 [INFO]: 	Checking that your have enough memory available to create the index 03/09/2025, 08:38:39
2025-03-09 08:38:39,169 [INFO]: 1.0GB of memory will be needed to build the index (more might be used if you have more)
2025-03-09 08:38:39,169 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0002 secs
2025-03-09 08:38:39,169 [INFO]: 	Selecting most promising index types given data characteristics 03/09/2025, 08:38:39
2025-03-09 08:38:39,169 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-09 08:38:39,169 [INFO]: 	Creating the index 03/09/2025, 08:38:39
2025-03-09 08:38:39,169 [INFO]: 		-> Instanciate the index HNSW15 03/09/2025, 08:38:39
2025-03-09 08:38:39,170 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0011 secs
2025-03-09 08:38:39,170 [INFO]: 		-> Adding the vectors to the index 03/09/2025, 08:38:39
2025-03-09 08:38:39,171 [INFO]: The memory available for adding the vectors is 49.1GB(total available - used by the index)
2025-03-09 08:38:39,171 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/22 [00:00<?, ?it/s]  5%|▍         | 1/22 [00:00<00:03,  5.36it/s] 14%|█▎        | 3/22 [00:00<00:02,  8.57it/s] 23%|██▎       | 5/22 [00:00<00:01,  9.82it/s] 32%|███▏      | 7/22 [00:00<00:01, 11.55it/s] 41%|████      | 9/22 [00:00<00:01, 11.75it/s] 50%|█████     | 11/22 [00:01<00:00, 11.89it/s] 59%|█████▉    | 13/22 [00:01<00:00, 12.05it/s] 68%|██████▊   | 15/22 [00:01<00:00, 12.33it/s] 77%|███████▋  | 17/22 [00:01<00:00, 12.46it/s] 86%|████████▋ | 19/22 [00:01<00:00, 12.71it/s] 95%|█████████▌| 21/22 [00:05<00:00,  1.64it/s]100%|██████████| 22/22 [00:06<00:00,  1.38it/s]100%|██████████| 22/22 [00:06<00:00,  3.39it/s]
2025-03-09 08:38:45,665 [INFO]: 	Computing best hyperparameters for index knn.index 03/09/2025, 08:38:45
2025-03-09 08:39:29,965 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 44.2996 secs
2025-03-09 08:39:29,965 [INFO]: The best hyperparameters are: efSearch=178
2025-03-09 08:39:29,965 [INFO]: 	Compute fast metrics 03/09/2025, 08:39:29
  0%|          | 0/4 [00:00<?, ?it/s] 25%|██▌       | 1/4 [00:00<00:00,  5.31it/s] 50%|█████     | 2/4 [00:00<00:00,  7.31it/s] 75%|███████▌  | 3/4 [00:00<00:00,  8.18it/s] 75%|███████▌  | 3/4 [00:00<00:00,  6.08it/s]
2025-03-09 08:39:54,043 [INFO]: 	>>> Finished "Compute fast metrics" in 24.0772 secs
2025-03-09 08:39:54,043 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 74.8726 secs
2025-03-09 08:39:54,043 [INFO]: {
2025-03-09 08:39:54,043 [INFO]: 	index_key: HNSW15
2025-03-09 08:39:54,043 [INFO]: 	index_param: efSearch=178
2025-03-09 08:39:54,043 [INFO]: 	index_path: knn.index
2025-03-09 08:39:54,043 [INFO]: 	size in bytes: 1019330950
2025-03-09 08:39:54,043 [INFO]: 	avg_search_speed_ms: 7.457796209557767
2025-03-09 08:39:54,043 [INFO]: 	99p_search_speed_ms: 13.096015900373446
2025-03-09 08:39:54,043 [INFO]: 	reconstruction error %: 0.0
2025-03-09 08:39:54,043 [INFO]: 	nb vectors: 5181
2025-03-09 08:39:54,043 [INFO]: 	vectors dimension: 49152
2025-03-09 08:39:54,043 [INFO]: 	compression ratio: 0.9993084660090032
2025-03-09 08:39:54,043 [INFO]: }
2025-03-09 08:39:54,043 [INFO]: 	>>> Finished "Creating the index" in 74.8741 secs
2025-03-09 08:39:54,043 [INFO]: >>> Finished "Launching the whole pipeline" in 74.9025 secs
2025-03-09 08:39:54: [retrieval_preprocessing] calculating distances ...
2025-03-09 08:39:55: [retrieval_preprocessing] finished and saved retrieval indices for episode 93582 [episode count 8/20]
[retrieval_preprocessing] for episode 62866 [episode count 9/20], we have num_retrieval=np.int64(4964) num_query=np.int64(385)
2025-03-09 08:39:56,597 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-09 08:39:57,286 [INFO]: Launching the whole pipeline 03/09/2025, 08:39:57
2025-03-09 08:39:57,286 [INFO]: Reading total number of vectors and dimension 03/09/2025, 08:39:57
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1079.06it/s]
2025-03-09 08:39:57,318 [INFO]: There are 4964 embeddings of dim 49152
2025-03-09 08:39:57,318 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0321 secs
2025-03-09 08:39:57,318 [INFO]: 	Compute estimated construction time of the index 03/09/2025, 08:39:57
2025-03-09 08:39:57,319 [INFO]: 		-> Train: 16.7 minutes
2025-03-09 08:39:57,319 [INFO]: 		-> Add: 2.7 seconds
2025-03-09 08:39:57,319 [INFO]: 		Total: 16.7 minutes
2025-03-09 08:39:57,319 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0003 secs
2025-03-09 08:39:57,319 [INFO]: 	Checking that your have enough memory available to create the index 03/09/2025, 08:39:57
2025-03-09 08:39:57,319 [INFO]: 1.0GB of memory will be needed to build the index (more might be used if you have more)
2025-03-09 08:39:57,319 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0003 secs
2025-03-09 08:39:57,319 [INFO]: 	Selecting most promising index types given data characteristics 03/09/2025, 08:39:57
2025-03-09 08:39:57,320 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-09 08:39:57,320 [INFO]: 	Creating the index 03/09/2025, 08:39:57
2025-03-09 08:39:57,320 [INFO]: 		-> Instanciate the index HNSW15 03/09/2025, 08:39:57
2025-03-09 08:39:57,322 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0026 secs
2025-03-09 08:39:57,323 [INFO]: 		-> Adding the vectors to the index 03/09/2025, 08:39:57
2025-03-09 08:39:57,323 [INFO]: The memory available for adding the vectors is 49.1GB(total available - used by the index)
2025-03-09 08:39:57,323 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/20 [00:00<?, ?it/s]  5%|▌         | 1/20 [00:00<00:03,  5.52it/s] 15%|█▌        | 3/20 [00:00<00:01,  9.58it/s] 25%|██▌       | 5/20 [00:00<00:01, 11.20it/s] 35%|███▌      | 7/20 [00:00<00:01, 11.97it/s] 45%|████▌     | 9/20 [00:00<00:00, 12.37it/s] 55%|█████▌    | 11/20 [00:00<00:00, 12.60it/s] 65%|██████▌   | 13/20 [00:01<00:00, 12.56it/s] 75%|███████▌  | 15/20 [00:01<00:00, 12.62it/s] 85%|████████▌ | 17/20 [00:01<00:00, 12.35it/s] 95%|█████████▌| 19/20 [00:01<00:00,  9.93it/s]100%|██████████| 20/20 [00:05<00:00,  3.67it/s]
2025-03-09 08:40:02,782 [INFO]: 	Computing best hyperparameters for index knn.index 03/09/2025, 08:40:02
2025-03-09 08:40:40,702 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 37.9207 secs
2025-03-09 08:40:40,703 [INFO]: The best hyperparameters are: efSearch=223
2025-03-09 08:40:40,703 [INFO]: 	Compute fast metrics 03/09/2025, 08:40:40
  0%|          | 0/4 [00:00<?, ?it/s] 25%|██▌       | 1/4 [00:00<00:00,  5.10it/s] 50%|█████     | 2/4 [00:00<00:00,  6.49it/s] 75%|███████▌  | 3/4 [00:00<00:00,  7.16it/s] 75%|███████▌  | 3/4 [00:00<00:00,  5.33it/s]
2025-03-09 08:41:03,435 [INFO]: 	>>> Finished "Compute fast metrics" in 22.7325 secs
2025-03-09 08:41:03,440 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 66.1172 secs
2025-03-09 08:41:03,440 [INFO]: {
2025-03-09 08:41:03,440 [INFO]: 	index_key: HNSW15
2025-03-09 08:41:03,440 [INFO]: 	index_param: efSearch=223
2025-03-09 08:41:03,440 [INFO]: 	index_path: knn.index
2025-03-09 08:41:03,440 [INFO]: 	size in bytes: 976637290
2025-03-09 08:41:03,440 [INFO]: 	avg_search_speed_ms: 11.151967921118805
2025-03-09 08:41:03,440 [INFO]: 	99p_search_speed_ms: 24.235908640548534
2025-03-09 08:41:03,440 [INFO]: 	reconstruction error %: 0.0
2025-03-09 08:41:03,440 [INFO]: 	nb vectors: 4964
2025-03-09 08:41:03,440 [INFO]: 	vectors dimension: 49152
2025-03-09 08:41:03,440 [INFO]: 	compression ratio: 0.9993086706734288
2025-03-09 08:41:03,440 [INFO]: }
2025-03-09 08:41:03,440 [INFO]: 	>>> Finished "Creating the index" in 66.1207 secs
2025-03-09 08:41:03,440 [INFO]: >>> Finished "Launching the whole pipeline" in 66.1545 secs
2025-03-09 08:41:05: [retrieval_preprocessing] calculating distances ...
2025-03-09 08:41:07: [retrieval_preprocessing] finished and saved retrieval indices for episode 62866 [episode count 9/20]
[retrieval_preprocessing] for episode 33556 [episode count 10/20], we have num_retrieval=np.int64(5131) num_query=np.int64(218)
2025-03-09 08:41:08,277 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-09 08:41:08,967 [INFO]: Launching the whole pipeline 03/09/2025, 08:41:08
2025-03-09 08:41:08,967 [INFO]: Reading total number of vectors and dimension 03/09/2025, 08:41:08
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1191.23it/s]
2025-03-09 08:41:08,993 [INFO]: There are 5131 embeddings of dim 49152
2025-03-09 08:41:08,993 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0262 secs
2025-03-09 08:41:08,993 [INFO]: 	Compute estimated construction time of the index 03/09/2025, 08:41:08
2025-03-09 08:41:08,993 [INFO]: 		-> Train: 16.7 minutes
2025-03-09 08:41:08,993 [INFO]: 		-> Add: 2.8 seconds
2025-03-09 08:41:08,993 [INFO]: 		Total: 16.7 minutes
2025-03-09 08:41:08,993 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0001 secs
2025-03-09 08:41:08,994 [INFO]: 	Checking that your have enough memory available to create the index 03/09/2025, 08:41:08
2025-03-09 08:41:08,994 [INFO]: 1.0GB of memory will be needed to build the index (more might be used if you have more)
2025-03-09 08:41:08,994 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0002 secs
2025-03-09 08:41:08,994 [INFO]: 	Selecting most promising index types given data characteristics 03/09/2025, 08:41:08
2025-03-09 08:41:08,994 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-09 08:41:08,994 [INFO]: 	Creating the index 03/09/2025, 08:41:08
2025-03-09 08:41:08,994 [INFO]: 		-> Instanciate the index HNSW15 03/09/2025, 08:41:08
2025-03-09 08:41:08,995 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0011 secs
2025-03-09 08:41:08,995 [INFO]: 		-> Adding the vectors to the index 03/09/2025, 08:41:08
2025-03-09 08:41:08,995 [INFO]: The memory available for adding the vectors is 49.1GB(total available - used by the index)
2025-03-09 08:41:08,995 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/22 [00:00<?, ?it/s]  5%|▍         | 1/22 [00:00<00:03,  6.96it/s] 14%|█▎        | 3/22 [00:00<00:01, 12.67it/s] 23%|██▎       | 5/22 [00:00<00:01, 13.61it/s] 32%|███▏      | 7/22 [00:00<00:01, 12.63it/s] 41%|████      | 9/22 [00:00<00:01, 12.52it/s] 50%|█████     | 11/22 [00:00<00:00, 12.52it/s] 59%|█████▉    | 13/22 [00:01<00:00, 12.35it/s] 68%|██████▊   | 15/22 [00:01<00:00, 12.27it/s] 77%|███████▋  | 17/22 [00:01<00:00, 13.46it/s] 86%|████████▋ | 19/22 [00:01<00:00, 14.04it/s] 95%|█████████▌| 21/22 [00:05<00:00,  1.61it/s]100%|██████████| 22/22 [00:06<00:00,  3.60it/s]
2025-03-09 08:41:15,116 [INFO]: 	Computing best hyperparameters for index knn.index 03/09/2025, 08:41:15
2025-03-09 08:41:55,718 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 40.6022 secs
2025-03-09 08:41:55,718 [INFO]: The best hyperparameters are: efSearch=207
2025-03-09 08:41:55,718 [INFO]: 	Compute fast metrics 03/09/2025, 08:41:55
  0%|          | 0/4 [00:00<?, ?it/s] 25%|██▌       | 1/4 [00:00<00:00,  5.15it/s] 50%|█████     | 2/4 [00:00<00:00,  6.90it/s] 75%|███████▌  | 3/4 [00:00<00:00,  7.69it/s] 75%|███████▌  | 3/4 [00:00<00:00,  5.74it/s]
2025-03-09 08:42:19,094 [INFO]: 	>>> Finished "Compute fast metrics" in 23.3756 secs
2025-03-09 08:42:19,094 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 70.0990 secs
2025-03-09 08:42:19,094 [INFO]: {
2025-03-09 08:42:19,094 [INFO]: 	index_key: HNSW15
2025-03-09 08:42:19,094 [INFO]: 	index_param: efSearch=207
2025-03-09 08:42:19,094 [INFO]: 	index_path: knn.index
2025-03-09 08:42:19,094 [INFO]: 	size in bytes: 1009493770
2025-03-09 08:42:19,094 [INFO]: 	avg_search_speed_ms: 9.141974171778525
2025-03-09 08:42:19,094 [INFO]: 	99p_search_speed_ms: 16.67495138244703
2025-03-09 08:42:19,094 [INFO]: 	reconstruction error %: 0.0
2025-03-09 08:42:19,094 [INFO]: 	nb vectors: 5131
2025-03-09 08:42:19,094 [INFO]: 	vectors dimension: 49152
2025-03-09 08:42:19,094 [INFO]: 	compression ratio: 0.9993084434785566
2025-03-09 08:42:19,094 [INFO]: }
2025-03-09 08:42:19,095 [INFO]: 	>>> Finished "Creating the index" in 70.1007 secs
2025-03-09 08:42:19,095 [INFO]: >>> Finished "Launching the whole pipeline" in 70.1275 secs
2025-03-09 08:42:20: [retrieval_preprocessing] calculating distances ...
2025-03-09 08:42:20: [retrieval_preprocessing] finished and saved retrieval indices for episode 33556 [episode count 10/20]
[retrieval_preprocessing] for episode 10009 [episode count 11/20], we have num_retrieval=np.int64(5212) num_query=np.int64(137)
2025-03-09 08:42:22,261 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-09 08:42:22,965 [INFO]: Launching the whole pipeline 03/09/2025, 08:42:22
2025-03-09 08:42:22,965 [INFO]: Reading total number of vectors and dimension 03/09/2025, 08:42:22
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1399.50it/s]
2025-03-09 08:42:22,990 [INFO]: There are 5212 embeddings of dim 49152
2025-03-09 08:42:22,990 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0252 secs
2025-03-09 08:42:22,991 [INFO]: 	Compute estimated construction time of the index 03/09/2025, 08:42:22
2025-03-09 08:42:22,991 [INFO]: 		-> Train: 16.7 minutes
2025-03-09 08:42:22,991 [INFO]: 		-> Add: 2.9 seconds
2025-03-09 08:42:22,991 [INFO]: 		Total: 16.7 minutes
2025-03-09 08:42:22,991 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0001 secs
2025-03-09 08:42:22,991 [INFO]: 	Checking that your have enough memory available to create the index 03/09/2025, 08:42:22
2025-03-09 08:42:22,991 [INFO]: 1.1GB of memory will be needed to build the index (more might be used if you have more)
2025-03-09 08:42:22,991 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0002 secs
2025-03-09 08:42:22,991 [INFO]: 	Selecting most promising index types given data characteristics 03/09/2025, 08:42:22
2025-03-09 08:42:22,991 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-09 08:42:22,991 [INFO]: 	Creating the index 03/09/2025, 08:42:22
2025-03-09 08:42:22,991 [INFO]: 		-> Instanciate the index HNSW15 03/09/2025, 08:42:22
2025-03-09 08:42:22,992 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0010 secs
2025-03-09 08:42:22,992 [INFO]: 		-> Adding the vectors to the index 03/09/2025, 08:42:22
2025-03-09 08:42:22,992 [INFO]: The memory available for adding the vectors is 49.0GB(total available - used by the index)
2025-03-09 08:42:22,992 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/22 [00:00<?, ?it/s]  5%|▍         | 1/22 [00:00<00:04,  5.09it/s]  9%|▉         | 2/22 [00:00<00:02,  6.75it/s] 14%|█▎        | 3/22 [00:00<00:02,  7.58it/s] 18%|█▊        | 4/22 [00:00<00:02,  8.02it/s] 23%|██▎       | 5/22 [00:00<00:02,  8.27it/s] 27%|██▋       | 6/22 [00:00<00:01,  8.59it/s] 32%|███▏      | 7/22 [00:00<00:01,  8.49it/s] 36%|███▋      | 8/22 [00:01<00:01,  8.39it/s] 41%|████      | 9/22 [00:01<00:01,  8.34it/s] 45%|████▌     | 10/22 [00:01<00:01,  8.64it/s] 50%|█████     | 11/22 [00:01<00:01,  8.68it/s] 55%|█████▍    | 12/22 [00:01<00:01,  8.82it/s] 59%|█████▉    | 13/22 [00:01<00:01,  8.83it/s] 64%|██████▎   | 14/22 [00:01<00:00,  8.85it/s] 68%|██████▊   | 15/22 [00:01<00:00,  8.83it/s] 73%|███████▎  | 16/22 [00:01<00:00,  8.83it/s] 77%|███████▋  | 17/22 [00:02<00:00,  8.92it/s] 82%|████████▏ | 18/22 [00:02<00:00,  8.87it/s] 91%|█████████ | 20/22 [00:02<00:00,  9.39it/s] 95%|█████████▌| 21/22 [00:05<00:00,  1.06it/s]100%|██████████| 22/22 [00:06<00:00,  1.09it/s]100%|██████████| 22/22 [00:06<00:00,  3.30it/s]
2025-03-09 08:42:29,663 [INFO]: 	Computing best hyperparameters for index knn.index 03/09/2025, 08:42:29
2025-03-09 08:43:15,570 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 45.9066 secs
2025-03-09 08:43:15,570 [INFO]: The best hyperparameters are: efSearch=164
2025-03-09 08:43:15,570 [INFO]: 	Compute fast metrics 03/09/2025, 08:43:15
  0%|          | 0/4 [00:00<?, ?it/s] 25%|██▌       | 1/4 [00:00<00:00,  5.36it/s] 50%|█████     | 2/4 [00:00<00:00,  6.84it/s] 75%|███████▌  | 3/4 [00:00<00:00,  7.48it/s] 75%|███████▌  | 3/4 [00:00<00:00,  5.62it/s]
2025-03-09 08:43:38,165 [INFO]: 	>>> Finished "Compute fast metrics" in 22.5945 secs
2025-03-09 08:43:38,165 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 75.1730 secs
2025-03-09 08:43:38,165 [INFO]: {
2025-03-09 08:43:38,165 [INFO]: 	index_key: HNSW15
2025-03-09 08:43:38,165 [INFO]: 	index_param: efSearch=164
2025-03-09 08:43:38,165 [INFO]: 	index_path: knn.index
2025-03-09 08:43:38,165 [INFO]: 	size in bytes: 1025430130
2025-03-09 08:43:38,165 [INFO]: 	avg_search_speed_ms: 7.445407959917589
2025-03-09 08:43:38,165 [INFO]: 	99p_search_speed_ms: 13.56485006865111
2025-03-09 08:43:38,165 [INFO]: 	reconstruction error %: 0.0
2025-03-09 08:43:38,165 [INFO]: 	nb vectors: 5212
2025-03-09 08:43:38,165 [INFO]: 	vectors dimension: 49152
2025-03-09 08:43:38,166 [INFO]: 	compression ratio: 0.9993083546316315
2025-03-09 08:43:38,166 [INFO]: }
2025-03-09 08:43:38,166 [INFO]: 	>>> Finished "Creating the index" in 75.1744 secs
2025-03-09 08:43:38,166 [INFO]: >>> Finished "Launching the whole pipeline" in 75.2003 secs
2025-03-09 08:43:38: [retrieval_preprocessing] calculating distances ...
2025-03-09 08:43:39: [retrieval_preprocessing] finished and saved retrieval indices for episode 10009 [episode count 11/20]
[retrieval_preprocessing] for episode 49690 [episode count 12/20], we have num_retrieval=np.int64(5028) num_query=np.int64(321)
2025-03-09 08:43:40,641 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-09 08:43:41,355 [INFO]: Launching the whole pipeline 03/09/2025, 08:43:41
2025-03-09 08:43:41,355 [INFO]: Reading total number of vectors and dimension 03/09/2025, 08:43:41
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1222.12it/s]
2025-03-09 08:43:41,382 [INFO]: There are 5028 embeddings of dim 49152
2025-03-09 08:43:41,382 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0270 secs
2025-03-09 08:43:41,382 [INFO]: 	Compute estimated construction time of the index 03/09/2025, 08:43:41
2025-03-09 08:43:41,383 [INFO]: 		-> Train: 16.7 minutes
2025-03-09 08:43:41,383 [INFO]: 		-> Add: 2.8 seconds
2025-03-09 08:43:41,383 [INFO]: 		Total: 16.7 minutes
2025-03-09 08:43:41,383 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0002 secs
2025-03-09 08:43:41,383 [INFO]: 	Checking that your have enough memory available to create the index 03/09/2025, 08:43:41
2025-03-09 08:43:41,383 [INFO]: 1.0GB of memory will be needed to build the index (more might be used if you have more)
2025-03-09 08:43:41,383 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0002 secs
2025-03-09 08:43:41,383 [INFO]: 	Selecting most promising index types given data characteristics 03/09/2025, 08:43:41
2025-03-09 08:43:41,383 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-09 08:43:41,383 [INFO]: 	Creating the index 03/09/2025, 08:43:41
2025-03-09 08:43:41,383 [INFO]: 		-> Instanciate the index HNSW15 03/09/2025, 08:43:41
2025-03-09 08:43:41,384 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0011 secs
2025-03-09 08:43:41,384 [INFO]: 		-> Adding the vectors to the index 03/09/2025, 08:43:41
2025-03-09 08:43:41,385 [INFO]: The memory available for adding the vectors is 49.1GB(total available - used by the index)
2025-03-09 08:43:41,385 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/20 [00:00<?, ?it/s]  5%|▌         | 1/20 [00:00<00:03,  4.91it/s] 10%|█         | 2/20 [00:00<00:02,  6.49it/s] 15%|█▌        | 3/20 [00:00<00:02,  7.23it/s] 20%|██        | 4/20 [00:00<00:02,  7.65it/s] 25%|██▌       | 5/20 [00:00<00:01,  7.84it/s] 30%|███       | 6/20 [00:00<00:01,  7.88it/s] 35%|███▌      | 7/20 [00:00<00:01,  8.16it/s] 40%|████      | 8/20 [00:01<00:01,  8.19it/s] 45%|████▌     | 9/20 [00:01<00:01,  7.96it/s] 50%|█████     | 10/20 [00:01<00:01,  7.91it/s] 55%|█████▌    | 11/20 [00:01<00:01,  7.79it/s] 60%|██████    | 12/20 [00:01<00:01,  7.84it/s] 65%|██████▌   | 13/20 [00:01<00:00,  7.73it/s] 70%|███████   | 14/20 [00:01<00:00,  7.69it/s] 75%|███████▌  | 15/20 [00:01<00:00,  7.68it/s] 80%|████████  | 16/20 [00:02<00:00,  7.71it/s] 85%|████████▌ | 17/20 [00:02<00:00,  7.78it/s] 90%|█████████ | 18/20 [00:02<00:00,  7.67it/s] 95%|█████████▌| 19/20 [00:02<00:00,  7.67it/s]100%|██████████| 20/20 [00:06<00:00,  1.29s/it]100%|██████████| 20/20 [00:06<00:00,  3.09it/s]
2025-03-09 08:43:48,169 [INFO]: 	Computing best hyperparameters for index knn.index 03/09/2025, 08:43:48
2025-03-09 08:44:29,432 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 41.2625 secs
2025-03-09 08:44:29,432 [INFO]: The best hyperparameters are: efSearch=166
2025-03-09 08:44:29,432 [INFO]: 	Compute fast metrics 03/09/2025, 08:44:29
  0%|          | 0/4 [00:00<?, ?it/s] 25%|██▌       | 1/4 [00:00<00:00,  5.46it/s] 75%|███████▌  | 3/4 [00:00<00:00,  8.01it/s] 75%|███████▌  | 3/4 [00:00<00:00,  6.06it/s]
2025-03-09 08:44:53,733 [INFO]: 	>>> Finished "Compute fast metrics" in 24.3005 secs
2025-03-09 08:44:53,736 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 72.3516 secs
2025-03-09 08:44:53,736 [INFO]: {
2025-03-09 08:44:53,736 [INFO]: 	index_key: HNSW15
2025-03-09 08:44:53,736 [INFO]: 	index_param: efSearch=166
2025-03-09 08:44:53,736 [INFO]: 	index_path: knn.index
2025-03-09 08:44:53,736 [INFO]: 	size in bytes: 989229070
2025-03-09 08:44:53,736 [INFO]: 	avg_search_speed_ms: 7.275042569249858
2025-03-09 08:44:53,736 [INFO]: 	99p_search_speed_ms: 16.385266187135127
2025-03-09 08:44:53,736 [INFO]: 	reconstruction error %: 0.0
2025-03-09 08:44:53,736 [INFO]: 	nb vectors: 5028
2025-03-09 08:44:53,736 [INFO]: 	vectors dimension: 49152
2025-03-09 08:44:53,736 [INFO]: 	compression ratio: 0.9993085059661662
2025-03-09 08:44:53,736 [INFO]: }
2025-03-09 08:44:53,736 [INFO]: 	>>> Finished "Creating the index" in 72.3532 secs
2025-03-09 08:44:53,736 [INFO]: >>> Finished "Launching the whole pipeline" in 72.3811 secs
2025-03-09 08:44:54: [retrieval_preprocessing] calculating distances ...
2025-03-09 08:44:55: [retrieval_preprocessing] finished and saved retrieval indices for episode 49690 [episode count 12/20]
[retrieval_preprocessing] for episode 58009 [episode count 13/20], we have num_retrieval=np.int64(5021) num_query=np.int64(328)
2025-03-09 08:44:57,040 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-09 08:44:57,701 [INFO]: Launching the whole pipeline 03/09/2025, 08:44:57
2025-03-09 08:44:57,701 [INFO]: Reading total number of vectors and dimension 03/09/2025, 08:44:57
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1538.07it/s]
2025-03-09 08:44:57,727 [INFO]: There are 5021 embeddings of dim 49152
2025-03-09 08:44:57,727 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0258 secs
2025-03-09 08:44:57,727 [INFO]: 	Compute estimated construction time of the index 03/09/2025, 08:44:57
2025-03-09 08:44:57,727 [INFO]: 		-> Train: 16.7 minutes
2025-03-09 08:44:57,727 [INFO]: 		-> Add: 2.8 seconds
2025-03-09 08:44:57,727 [INFO]: 		Total: 16.7 minutes
2025-03-09 08:44:57,727 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0001 secs
2025-03-09 08:44:57,727 [INFO]: 	Checking that your have enough memory available to create the index 03/09/2025, 08:44:57
2025-03-09 08:44:57,727 [INFO]: 1.0GB of memory will be needed to build the index (more might be used if you have more)
2025-03-09 08:44:57,728 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0001 secs
2025-03-09 08:44:57,728 [INFO]: 	Selecting most promising index types given data characteristics 03/09/2025, 08:44:57
2025-03-09 08:44:57,728 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-09 08:44:57,728 [INFO]: 	Creating the index 03/09/2025, 08:44:57
2025-03-09 08:44:57,728 [INFO]: 		-> Instanciate the index HNSW15 03/09/2025, 08:44:57
2025-03-09 08:44:57,729 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0011 secs
2025-03-09 08:44:57,729 [INFO]: 		-> Adding the vectors to the index 03/09/2025, 08:44:57
2025-03-09 08:44:57,729 [INFO]: The memory available for adding the vectors is 49.1GB(total available - used by the index)
2025-03-09 08:44:57,729 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/20 [00:00<?, ?it/s]  5%|▌         | 1/20 [00:00<00:03,  5.62it/s] 15%|█▌        | 3/20 [00:00<00:01, 10.08it/s] 25%|██▌       | 5/20 [00:00<00:01, 11.76it/s] 35%|███▌      | 7/20 [00:00<00:01, 12.66it/s] 45%|████▌     | 9/20 [00:00<00:00, 13.07it/s] 55%|█████▌    | 11/20 [00:00<00:00, 13.30it/s] 65%|██████▌   | 13/20 [00:01<00:00, 13.47it/s] 75%|███████▌  | 15/20 [00:01<00:00, 13.54it/s] 85%|████████▌ | 17/20 [00:01<00:00, 13.57it/s] 95%|█████████▌| 19/20 [00:01<00:00, 13.55it/s]100%|██████████| 20/20 [00:05<00:00,  3.64it/s]
2025-03-09 08:45:03,237 [INFO]: 	Computing best hyperparameters for index knn.index 03/09/2025, 08:45:03
2025-03-09 08:45:48,315 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 45.0776 secs
2025-03-09 08:45:48,315 [INFO]: The best hyperparameters are: efSearch=190
2025-03-09 08:45:48,315 [INFO]: 	Compute fast metrics 03/09/2025, 08:45:48
  0%|          | 0/4 [00:00<?, ?it/s] 25%|██▌       | 1/4 [00:00<00:00,  5.11it/s] 50%|█████     | 2/4 [00:00<00:00,  6.84it/s] 75%|███████▌  | 3/4 [00:00<00:00,  7.59it/s] 75%|███████▌  | 3/4 [00:00<00:00,  5.67it/s]
2025-03-09 08:46:13,642 [INFO]: 	>>> Finished "Compute fast metrics" in 25.3267 secs
2025-03-09 08:46:13,646 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 75.9171 secs
2025-03-09 08:46:13,646 [INFO]: {
2025-03-09 08:46:13,646 [INFO]: 	index_key: HNSW15
2025-03-09 08:46:13,646 [INFO]: 	index_param: efSearch=190
2025-03-09 08:46:13,646 [INFO]: 	index_path: knn.index
2025-03-09 08:46:13,646 [INFO]: 	size in bytes: 987851830
2025-03-09 08:46:13,646 [INFO]: 	avg_search_speed_ms: 8.443875800907875
2025-03-09 08:46:13,646 [INFO]: 	99p_search_speed_ms: 14.699928911868493
2025-03-09 08:46:13,647 [INFO]: 	reconstruction error %: 0.0
2025-03-09 08:46:13,647 [INFO]: 	nb vectors: 5021
2025-03-09 08:46:13,647 [INFO]: 	vectors dimension: 49152
2025-03-09 08:46:13,647 [INFO]: 	compression ratio: 0.999308538002101
2025-03-09 08:46:13,647 [INFO]: }
2025-03-09 08:46:13,647 [INFO]: 	>>> Finished "Creating the index" in 75.9190 secs
2025-03-09 08:46:13,647 [INFO]: >>> Finished "Launching the whole pipeline" in 75.9454 secs
2025-03-09 08:46:15: [retrieval_preprocessing] calculating distances ...
2025-03-09 08:46:17: [retrieval_preprocessing] finished and saved retrieval indices for episode 58009 [episode count 13/20]
[retrieval_preprocessing] for episode 68889 [episode count 14/20], we have num_retrieval=np.int64(5137) num_query=np.int64(212)
2025-03-09 08:46:19,285 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-09 08:46:20,107 [INFO]: Launching the whole pipeline 03/09/2025, 08:46:20
2025-03-09 08:46:20,108 [INFO]: Reading total number of vectors and dimension 03/09/2025, 08:46:20
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1277.19it/s]
2025-03-09 08:46:20,136 [INFO]: There are 5137 embeddings of dim 49152
2025-03-09 08:46:20,137 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0290 secs
2025-03-09 08:46:20,137 [INFO]: 	Compute estimated construction time of the index 03/09/2025, 08:46:20
2025-03-09 08:46:20,137 [INFO]: 		-> Train: 16.7 minutes
2025-03-09 08:46:20,137 [INFO]: 		-> Add: 2.8 seconds
2025-03-09 08:46:20,137 [INFO]: 		Total: 16.7 minutes
2025-03-09 08:46:20,137 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0005 secs
2025-03-09 08:46:20,138 [INFO]: 	Checking that your have enough memory available to create the index 03/09/2025, 08:46:20
2025-03-09 08:46:20,138 [INFO]: 1.0GB of memory will be needed to build the index (more might be used if you have more)
2025-03-09 08:46:20,138 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0005 secs
2025-03-09 08:46:20,138 [INFO]: 	Selecting most promising index types given data characteristics 03/09/2025, 08:46:20
2025-03-09 08:46:20,138 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-09 08:46:20,138 [INFO]: 	Creating the index 03/09/2025, 08:46:20
2025-03-09 08:46:20,139 [INFO]: 		-> Instanciate the index HNSW15 03/09/2025, 08:46:20
2025-03-09 08:46:20,142 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0030 secs
2025-03-09 08:46:20,142 [INFO]: 		-> Adding the vectors to the index 03/09/2025, 08:46:20
2025-03-09 08:46:20,142 [INFO]: The memory available for adding the vectors is 49.1GB(total available - used by the index)
2025-03-09 08:46:20,142 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/22 [00:00<?, ?it/s]  5%|▍         | 1/22 [00:00<00:03,  5.53it/s] 14%|█▎        | 3/22 [00:00<00:02,  8.71it/s] 23%|██▎       | 5/22 [00:00<00:01,  9.34it/s] 32%|███▏      | 7/22 [00:00<00:01,  9.82it/s] 41%|████      | 9/22 [00:00<00:01, 10.41it/s] 50%|█████     | 11/22 [00:01<00:00, 11.05it/s] 59%|█████▉    | 13/22 [00:01<00:00, 11.42it/s] 68%|██████▊   | 15/22 [00:01<00:00, 11.73it/s] 77%|███████▋  | 17/22 [00:01<00:00, 11.94it/s] 86%|████████▋ | 19/22 [00:01<00:00, 11.93it/s] 95%|█████████▌| 21/22 [00:05<00:00,  1.67it/s]100%|██████████| 22/22 [00:06<00:00,  1.50it/s]100%|██████████| 22/22 [00:06<00:00,  3.52it/s]
2025-03-09 08:46:26,390 [INFO]: 	Computing best hyperparameters for index knn.index 03/09/2025, 08:46:26
2025-03-09 08:47:09,300 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 42.9098 secs
2025-03-09 08:47:09,300 [INFO]: The best hyperparameters are: efSearch=215
2025-03-09 08:47:09,300 [INFO]: 	Compute fast metrics 03/09/2025, 08:47:09
  0%|          | 0/4 [00:00<?, ?it/s] 25%|██▌       | 1/4 [00:00<00:00,  4.64it/s] 50%|█████     | 2/4 [00:00<00:00,  5.78it/s] 75%|███████▌  | 3/4 [00:00<00:00,  5.87it/s]
2025-03-09 08:47:32,651 [INFO]: 	>>> Finished "Compute fast metrics" in 23.3506 secs
2025-03-09 08:47:32,706 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 72.5640 secs
2025-03-09 08:47:32,706 [INFO]: {
2025-03-09 08:47:32,706 [INFO]: 	index_key: HNSW15
2025-03-09 08:47:32,707 [INFO]: 	index_param: efSearch=215
2025-03-09 08:47:32,707 [INFO]: 	index_path: knn.index
2025-03-09 08:47:32,707 [INFO]: 	size in bytes: 1010674210
2025-03-09 08:47:32,707 [INFO]: 	avg_search_speed_ms: 8.153478593905843
2025-03-09 08:47:32,707 [INFO]: 	99p_search_speed_ms: 16.238867945503443
2025-03-09 08:47:32,707 [INFO]: 	reconstruction error %: 0.0
2025-03-09 08:47:32,707 [INFO]: 	nb vectors: 5137
2025-03-09 08:47:32,707 [INFO]: 	vectors dimension: 49152
2025-03-09 08:47:32,707 [INFO]: 	compression ratio: 0.9993084675624602
2025-03-09 08:47:32,707 [INFO]: }
2025-03-09 08:47:32,707 [INFO]: 	>>> Finished "Creating the index" in 72.5686 secs
2025-03-09 08:47:32,707 [INFO]: >>> Finished "Launching the whole pipeline" in 72.5996 secs
2025-03-09 08:47:33: [retrieval_preprocessing] calculating distances ...
2025-03-09 08:47:34: [retrieval_preprocessing] finished and saved retrieval indices for episode 68889 [episode count 14/20]
[retrieval_preprocessing] for episode 35872 [episode count 15/20], we have num_retrieval=np.int64(5168) num_query=np.int64(181)
2025-03-09 08:47:35,859 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-09 08:47:36,524 [INFO]: Launching the whole pipeline 03/09/2025, 08:47:36
2025-03-09 08:47:36,524 [INFO]: Reading total number of vectors and dimension 03/09/2025, 08:47:36
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1771.99it/s]
2025-03-09 08:47:36,549 [INFO]: There are 5168 embeddings of dim 49152
2025-03-09 08:47:36,549 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0247 secs
2025-03-09 08:47:36,549 [INFO]: 	Compute estimated construction time of the index 03/09/2025, 08:47:36
2025-03-09 08:47:36,549 [INFO]: 		-> Train: 16.7 minutes
2025-03-09 08:47:36,549 [INFO]: 		-> Add: 2.8 seconds
2025-03-09 08:47:36,549 [INFO]: 		Total: 16.7 minutes
2025-03-09 08:47:36,549 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0001 secs
2025-03-09 08:47:36,549 [INFO]: 	Checking that your have enough memory available to create the index 03/09/2025, 08:47:36
2025-03-09 08:47:36,549 [INFO]: 1.0GB of memory will be needed to build the index (more might be used if you have more)
2025-03-09 08:47:36,549 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0001 secs
2025-03-09 08:47:36,549 [INFO]: 	Selecting most promising index types given data characteristics 03/09/2025, 08:47:36
2025-03-09 08:47:36,549 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-09 08:47:36,549 [INFO]: 	Creating the index 03/09/2025, 08:47:36
2025-03-09 08:47:36,549 [INFO]: 		-> Instanciate the index HNSW15 03/09/2025, 08:47:36
2025-03-09 08:47:36,550 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0010 secs
2025-03-09 08:47:36,550 [INFO]: 		-> Adding the vectors to the index 03/09/2025, 08:47:36
2025-03-09 08:47:36,550 [INFO]: The memory available for adding the vectors is 49.1GB(total available - used by the index)
2025-03-09 08:47:36,550 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/22 [00:00<?, ?it/s]  5%|▍         | 1/22 [00:00<00:03,  5.48it/s] 14%|█▎        | 3/22 [00:00<00:02,  9.23it/s] 23%|██▎       | 5/22 [00:00<00:01, 11.54it/s] 32%|███▏      | 7/22 [00:00<00:01, 12.55it/s] 41%|████      | 9/22 [00:00<00:01, 12.71it/s] 50%|█████     | 11/22 [00:00<00:00, 12.97it/s] 59%|█████▉    | 13/22 [00:01<00:00, 14.04it/s] 68%|██████▊   | 15/22 [00:01<00:00, 13.88it/s] 77%|███████▋  | 17/22 [00:01<00:00, 12.44it/s] 86%|████████▋ | 19/22 [00:01<00:00, 11.69it/s] 95%|█████████▌| 21/22 [00:05<00:00,  1.45it/s]100%|██████████| 22/22 [00:06<00:00,  1.32it/s]100%|██████████| 22/22 [00:06<00:00,  3.27it/s]
2025-03-09 08:47:43,289 [INFO]: 	Computing best hyperparameters for index knn.index 03/09/2025, 08:47:43
2025-03-09 08:48:28,213 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 44.9235 secs
2025-03-09 08:48:28,213 [INFO]: The best hyperparameters are: efSearch=218
2025-03-09 08:48:28,213 [INFO]: 	Compute fast metrics 03/09/2025, 08:48:28
  0%|          | 0/4 [00:00<?, ?it/s] 25%|██▌       | 1/4 [00:00<00:00,  5.63it/s] 50%|█████     | 2/4 [00:00<00:00,  7.45it/s] 75%|███████▌  | 3/4 [00:00<00:00,  8.18it/s] 75%|███████▌  | 3/4 [00:00<00:00,  6.09it/s]
2025-03-09 08:48:52,361 [INFO]: 	>>> Finished "Compute fast metrics" in 24.1479 secs
2025-03-09 08:48:52,362 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 75.8121 secs
2025-03-09 08:48:52,362 [INFO]: {
2025-03-09 08:48:52,362 [INFO]: 	index_key: HNSW15
2025-03-09 08:48:52,362 [INFO]: 	index_param: efSearch=218
2025-03-09 08:48:52,362 [INFO]: 	index_path: knn.index
2025-03-09 08:48:52,363 [INFO]: 	size in bytes: 1016773330
2025-03-09 08:48:52,363 [INFO]: 	avg_search_speed_ms: 9.19539439778686
2025-03-09 08:48:52,363 [INFO]: 	99p_search_speed_ms: 15.412488712463519
2025-03-09 08:48:52,363 [INFO]: 	reconstruction error %: 0.0
2025-03-09 08:48:52,363 [INFO]: 	nb vectors: 5168
2025-03-09 08:48:52,363 [INFO]: 	vectors dimension: 49152
2025-03-09 08:48:52,363 [INFO]: 	compression ratio: 0.9993084141968988
2025-03-09 08:48:52,363 [INFO]: }
2025-03-09 08:48:52,363 [INFO]: 	>>> Finished "Creating the index" in 75.8134 secs
2025-03-09 08:48:52,363 [INFO]: >>> Finished "Launching the whole pipeline" in 75.8387 secs
2025-03-09 08:48:53: [retrieval_preprocessing] calculating distances ...
2025-03-09 08:48:53: [retrieval_preprocessing] finished and saved retrieval indices for episode 35872 [episode count 15/20]
[retrieval_preprocessing] for episode 46498 [episode count 16/20], we have num_retrieval=np.int64(5026) num_query=np.int64(323)
2025-03-09 08:48:55,201 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-09 08:48:55,976 [INFO]: Launching the whole pipeline 03/09/2025, 08:48:55
2025-03-09 08:48:55,976 [INFO]: Reading total number of vectors and dimension 03/09/2025, 08:48:55
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1032.32it/s]
2025-03-09 08:48:56,003 [INFO]: There are 5026 embeddings of dim 49152
2025-03-09 08:48:56,003 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0271 secs
2025-03-09 08:48:56,003 [INFO]: 	Compute estimated construction time of the index 03/09/2025, 08:48:56
2025-03-09 08:48:56,003 [INFO]: 		-> Train: 16.7 minutes
2025-03-09 08:48:56,003 [INFO]: 		-> Add: 2.8 seconds
2025-03-09 08:48:56,003 [INFO]: 		Total: 16.7 minutes
2025-03-09 08:48:56,003 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0001 secs
2025-03-09 08:48:56,003 [INFO]: 	Checking that your have enough memory available to create the index 03/09/2025, 08:48:56
2025-03-09 08:48:56,003 [INFO]: 1.0GB of memory will be needed to build the index (more might be used if you have more)
2025-03-09 08:48:56,003 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0002 secs
2025-03-09 08:48:56,003 [INFO]: 	Selecting most promising index types given data characteristics 03/09/2025, 08:48:56
2025-03-09 08:48:56,003 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-09 08:48:56,003 [INFO]: 	Creating the index 03/09/2025, 08:48:56
2025-03-09 08:48:56,003 [INFO]: 		-> Instanciate the index HNSW15 03/09/2025, 08:48:56
2025-03-09 08:48:56,004 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0010 secs
2025-03-09 08:48:56,005 [INFO]: 		-> Adding the vectors to the index 03/09/2025, 08:48:56
2025-03-09 08:48:56,005 [INFO]: The memory available for adding the vectors is 49.1GB(total available - used by the index)
2025-03-09 08:48:56,005 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/20 [00:00<?, ?it/s]  5%|▌         | 1/20 [00:00<00:03,  5.87it/s] 15%|█▌        | 3/20 [00:00<00:01,  9.76it/s] 25%|██▌       | 5/20 [00:00<00:01, 10.89it/s] 35%|███▌      | 7/20 [00:00<00:01, 11.49it/s] 45%|████▌     | 9/20 [00:00<00:00, 11.74it/s] 55%|█████▌    | 11/20 [00:00<00:00, 11.75it/s] 65%|██████▌   | 13/20 [00:01<00:00, 11.70it/s] 75%|███████▌  | 15/20 [00:01<00:00, 11.35it/s] 85%|████████▌ | 17/20 [00:01<00:00, 11.00it/s] 95%|█████████▌| 19/20 [00:01<00:00, 11.03it/s]100%|██████████| 20/20 [00:05<00:00,  3.59it/s]
2025-03-09 08:49:01,579 [INFO]: 	Computing best hyperparameters for index knn.index 03/09/2025, 08:49:01
2025-03-09 08:49:42,449 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 40.8695 secs
2025-03-09 08:49:42,450 [INFO]: The best hyperparameters are: efSearch=231
2025-03-09 08:49:42,450 [INFO]: 	Compute fast metrics 03/09/2025, 08:49:42
  0%|          | 0/4 [00:00<?, ?it/s] 25%|██▌       | 1/4 [00:00<00:00,  5.13it/s] 50%|█████     | 2/4 [00:00<00:00,  6.99it/s] 75%|███████▌  | 3/4 [00:00<00:00,  7.80it/s] 75%|███████▌  | 3/4 [00:00<00:00,  5.83it/s]
2025-03-09 08:50:06,175 [INFO]: 	>>> Finished "Compute fast metrics" in 23.7248 secs
2025-03-09 08:50:06,178 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 70.1734 secs
2025-03-09 08:50:06,178 [INFO]: {
2025-03-09 08:50:06,178 [INFO]: 	index_key: HNSW15
2025-03-09 08:50:06,178 [INFO]: 	index_param: efSearch=231
2025-03-09 08:50:06,178 [INFO]: 	index_path: knn.index
2025-03-09 08:50:06,178 [INFO]: 	size in bytes: 988835590
2025-03-09 08:50:06,178 [INFO]: 	avg_search_speed_ms: 8.879258133409806
2025-03-09 08:50:06,178 [INFO]: 	99p_search_speed_ms: 15.74935158714652
2025-03-09 08:50:06,178 [INFO]: 	reconstruction error %: 0.0
2025-03-09 08:50:06,178 [INFO]: 	nb vectors: 5026
2025-03-09 08:50:06,178 [INFO]: 	vectors dimension: 49152
2025-03-09 08:50:06,178 [INFO]: 	compression ratio: 0.9993084977857644
2025-03-09 08:50:06,178 [INFO]: }
2025-03-09 08:50:06,178 [INFO]: 	>>> Finished "Creating the index" in 70.1748 secs
2025-03-09 08:50:06,178 [INFO]: >>> Finished "Launching the whole pipeline" in 70.2026 secs
2025-03-09 08:50:07: [retrieval_preprocessing] calculating distances ...
2025-03-09 08:50:08: [retrieval_preprocessing] finished and saved retrieval indices for episode 46498 [episode count 16/20]
[retrieval_preprocessing] for episode 48930 [episode count 17/20], we have num_retrieval=np.int64(4904) num_query=np.int64(445)
2025-03-09 08:50:10,623 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-09 08:50:11,314 [INFO]: Launching the whole pipeline 03/09/2025, 08:50:11
2025-03-09 08:50:11,314 [INFO]: Reading total number of vectors and dimension 03/09/2025, 08:50:11
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 987.82it/s]
2025-03-09 08:50:11,342 [INFO]: There are 4904 embeddings of dim 49152
2025-03-09 08:50:11,342 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0277 secs
2025-03-09 08:50:11,343 [INFO]: 	Compute estimated construction time of the index 03/09/2025, 08:50:11
2025-03-09 08:50:11,343 [INFO]: 		-> Train: 16.7 minutes
2025-03-09 08:50:11,343 [INFO]: 		-> Add: 2.7 seconds
2025-03-09 08:50:11,343 [INFO]: 		Total: 16.7 minutes
2025-03-09 08:50:11,343 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0001 secs
2025-03-09 08:50:11,343 [INFO]: 	Checking that your have enough memory available to create the index 03/09/2025, 08:50:11
2025-03-09 08:50:11,343 [INFO]: 1012.1MB of memory will be needed to build the index (more might be used if you have more)
2025-03-09 08:50:11,343 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0002 secs
2025-03-09 08:50:11,343 [INFO]: 	Selecting most promising index types given data characteristics 03/09/2025, 08:50:11
2025-03-09 08:50:11,343 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-09 08:50:11,343 [INFO]: 	Creating the index 03/09/2025, 08:50:11
2025-03-09 08:50:11,343 [INFO]: 		-> Instanciate the index HNSW15 03/09/2025, 08:50:11
2025-03-09 08:50:11,344 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0012 secs
2025-03-09 08:50:11,344 [INFO]: 		-> Adding the vectors to the index 03/09/2025, 08:50:11
2025-03-09 08:50:11,345 [INFO]: The memory available for adding the vectors is 49.1GB(total available - used by the index)
2025-03-09 08:50:11,345 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/20 [00:00<?, ?it/s]  5%|▌         | 1/20 [00:00<00:03,  5.00it/s] 10%|█         | 2/20 [00:00<00:02,  6.50it/s] 15%|█▌        | 3/20 [00:00<00:02,  7.29it/s] 20%|██        | 4/20 [00:00<00:02,  7.69it/s] 25%|██▌       | 5/20 [00:00<00:01,  8.32it/s] 30%|███       | 6/20 [00:00<00:01,  8.69it/s] 35%|███▌      | 7/20 [00:00<00:01,  8.14it/s] 40%|████      | 8/20 [00:01<00:01,  7.29it/s] 45%|████▌     | 9/20 [00:01<00:01,  7.78it/s] 50%|█████     | 10/20 [00:01<00:01,  8.25it/s] 55%|█████▌    | 11/20 [00:01<00:01,  8.48it/s] 60%|██████    | 12/20 [00:01<00:00,  8.60it/s] 70%|███████   | 14/20 [00:01<00:00,  9.89it/s] 80%|████████  | 16/20 [00:01<00:00, 10.53it/s] 90%|█████████ | 18/20 [00:02<00:00, 10.94it/s]100%|██████████| 20/20 [00:05<00:00,  1.53it/s]100%|██████████| 20/20 [00:05<00:00,  3.64it/s]
2025-03-09 08:50:16,840 [INFO]: 	Computing best hyperparameters for index knn.index 03/09/2025, 08:50:16
2025-03-09 08:50:58,726 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 41.8855 secs
2025-03-09 08:50:58,726 [INFO]: The best hyperparameters are: efSearch=225
2025-03-09 08:50:58,726 [INFO]: 	Compute fast metrics 03/09/2025, 08:50:58
  0%|          | 0/4 [00:00<?, ?it/s] 25%|██▌       | 1/4 [00:00<00:00,  5.87it/s] 75%|███████▌  | 3/4 [00:00<00:00,  9.54it/s] 75%|███████▌  | 3/4 [00:00<00:00,  7.30it/s]
2025-03-09 08:51:16,286 [INFO]: 	>>> Finished "Compute fast metrics" in 17.5597 secs
2025-03-09 08:51:16,289 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 64.9447 secs
2025-03-09 08:51:16,289 [INFO]: {
2025-03-09 08:51:16,289 [INFO]: 	index_key: HNSW15
2025-03-09 08:51:16,289 [INFO]: 	index_param: efSearch=225
2025-03-09 08:51:16,289 [INFO]: 	index_path: knn.index
2025-03-09 08:51:16,289 [INFO]: 	size in bytes: 964832530
2025-03-09 08:51:16,289 [INFO]: 	avg_search_speed_ms: 10.002407424384728
2025-03-09 08:51:16,290 [INFO]: 	99p_search_speed_ms: 19.890409458894275
2025-03-09 08:51:16,290 [INFO]: 	reconstruction error %: 0.0
2025-03-09 08:51:16,290 [INFO]: 	nb vectors: 4904
2025-03-09 08:51:16,290 [INFO]: 	vectors dimension: 49152
2025-03-09 08:51:16,290 [INFO]: 	compression ratio: 0.9993087940349606
2025-03-09 08:51:16,290 [INFO]: }
2025-03-09 08:51:16,290 [INFO]: 	>>> Finished "Creating the index" in 64.9464 secs
2025-03-09 08:51:16,290 [INFO]: >>> Finished "Launching the whole pipeline" in 64.9753 secs
2025-03-09 08:51:18: [retrieval_preprocessing] calculating distances ...
2025-03-09 08:51:19: [retrieval_preprocessing] finished and saved retrieval indices for episode 48930 [episode count 17/20]
[retrieval_preprocessing] for episode 14120 [episode count 18/20], we have num_retrieval=np.int64(5032) num_query=np.int64(317)
2025-03-09 08:51:21,339 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-09 08:51:22,158 [INFO]: Launching the whole pipeline 03/09/2025, 08:51:22
2025-03-09 08:51:22,158 [INFO]: Reading total number of vectors and dimension 03/09/2025, 08:51:22
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1305.01it/s]
2025-03-09 08:51:22,184 [INFO]: There are 5032 embeddings of dim 49152
2025-03-09 08:51:22,184 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0258 secs
2025-03-09 08:51:22,184 [INFO]: 	Compute estimated construction time of the index 03/09/2025, 08:51:22
2025-03-09 08:51:22,184 [INFO]: 		-> Train: 16.7 minutes
2025-03-09 08:51:22,184 [INFO]: 		-> Add: 2.8 seconds
2025-03-09 08:51:22,184 [INFO]: 		Total: 16.7 minutes
2025-03-09 08:51:22,184 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0001 secs
2025-03-09 08:51:22,184 [INFO]: 	Checking that your have enough memory available to create the index 03/09/2025, 08:51:22
2025-03-09 08:51:22,184 [INFO]: 1.0GB of memory will be needed to build the index (more might be used if you have more)
2025-03-09 08:51:22,184 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0002 secs
2025-03-09 08:51:22,184 [INFO]: 	Selecting most promising index types given data characteristics 03/09/2025, 08:51:22
2025-03-09 08:51:22,184 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-09 08:51:22,184 [INFO]: 	Creating the index 03/09/2025, 08:51:22
2025-03-09 08:51:22,184 [INFO]: 		-> Instanciate the index HNSW15 03/09/2025, 08:51:22
2025-03-09 08:51:22,186 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0011 secs
2025-03-09 08:51:22,186 [INFO]: 		-> Adding the vectors to the index 03/09/2025, 08:51:22
2025-03-09 08:51:22,186 [INFO]: The memory available for adding the vectors is 49.1GB(total available - used by the index)
2025-03-09 08:51:22,186 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/20 [00:00<?, ?it/s]  5%|▌         | 1/20 [00:00<00:03,  6.19it/s] 15%|█▌        | 3/20 [00:00<00:01,  9.84it/s] 25%|██▌       | 5/20 [00:00<00:01, 11.20it/s] 35%|███▌      | 7/20 [00:00<00:01, 11.71it/s] 45%|████▌     | 9/20 [00:00<00:00, 11.29it/s] 55%|█████▌    | 11/20 [00:01<00:00, 10.90it/s] 65%|██████▌   | 13/20 [00:01<00:00, 10.01it/s] 75%|███████▌  | 15/20 [00:01<00:00, 10.08it/s] 85%|████████▌ | 17/20 [00:01<00:00, 10.85it/s] 95%|█████████▌| 19/20 [00:01<00:00, 11.27it/s]100%|██████████| 20/20 [00:05<00:00,  3.75it/s]
2025-03-09 08:51:27,533 [INFO]: 	Computing best hyperparameters for index knn.index 03/09/2025, 08:51:27
2025-03-09 08:52:09,983 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 42.4499 secs
2025-03-09 08:52:09,984 [INFO]: The best hyperparameters are: efSearch=106
2025-03-09 08:52:09,984 [INFO]: 	Compute fast metrics 03/09/2025, 08:52:09
  0%|          | 0/4 [00:00<?, ?it/s] 25%|██▌       | 1/4 [00:00<00:00,  5.11it/s] 50%|█████     | 2/4 [00:00<00:00,  6.75it/s] 75%|███████▌  | 3/4 [00:00<00:00,  7.28it/s] 75%|███████▌  | 3/4 [00:00<00:00,  5.46it/s]
2025-03-09 08:52:26,320 [INFO]: 	>>> Finished "Compute fast metrics" in 16.3360 secs
2025-03-09 08:52:26,323 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 64.1375 secs
2025-03-09 08:52:26,323 [INFO]: {
2025-03-09 08:52:26,323 [INFO]: 	index_key: HNSW15
2025-03-09 08:52:26,323 [INFO]: 	index_param: efSearch=106
2025-03-09 08:52:26,323 [INFO]: 	index_path: knn.index
2025-03-09 08:52:26,323 [INFO]: 	size in bytes: 990016030
2025-03-09 08:52:26,323 [INFO]: 	avg_search_speed_ms: 5.955406919758525
2025-03-09 08:52:26,323 [INFO]: 	99p_search_speed_ms: 10.78877384774387
2025-03-09 08:52:26,323 [INFO]: 	reconstruction error %: 0.0
2025-03-09 08:52:26,323 [INFO]: 	nb vectors: 5032
2025-03-09 08:52:26,323 [INFO]: 	vectors dimension: 49152
2025-03-09 08:52:26,323 [INFO]: 	compression ratio: 0.999308522307462
2025-03-09 08:52:26,323 [INFO]: }
2025-03-09 08:52:26,323 [INFO]: 	>>> Finished "Creating the index" in 64.1391 secs
2025-03-09 08:52:26,323 [INFO]: >>> Finished "Launching the whole pipeline" in 64.1655 secs
2025-03-09 08:52:26: [retrieval_preprocessing] calculating distances ...
2025-03-09 08:52:28: [retrieval_preprocessing] finished and saved retrieval indices for episode 14120 [episode count 18/20]
[retrieval_preprocessing] for episode 26408 [episode count 19/20], we have num_retrieval=np.int64(5087) num_query=np.int64(262)
2025-03-09 08:52:29,830 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-09 08:52:30,480 [INFO]: Launching the whole pipeline 03/09/2025, 08:52:30
2025-03-09 08:52:30,480 [INFO]: Reading total number of vectors and dimension 03/09/2025, 08:52:30
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1516.93it/s]
2025-03-09 08:52:30,507 [INFO]: There are 5087 embeddings of dim 49152
2025-03-09 08:52:30,507 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0268 secs
2025-03-09 08:52:30,507 [INFO]: 	Compute estimated construction time of the index 03/09/2025, 08:52:30
2025-03-09 08:52:30,507 [INFO]: 		-> Train: 16.7 minutes
2025-03-09 08:52:30,507 [INFO]: 		-> Add: 2.8 seconds
2025-03-09 08:52:30,507 [INFO]: 		Total: 16.7 minutes
2025-03-09 08:52:30,507 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0001 secs
2025-03-09 08:52:30,507 [INFO]: 	Checking that your have enough memory available to create the index 03/09/2025, 08:52:30
2025-03-09 08:52:30,508 [INFO]: 1.0GB of memory will be needed to build the index (more might be used if you have more)
2025-03-09 08:52:30,508 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0001 secs
2025-03-09 08:52:30,508 [INFO]: 	Selecting most promising index types given data characteristics 03/09/2025, 08:52:30
2025-03-09 08:52:30,508 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-09 08:52:30,508 [INFO]: 	Creating the index 03/09/2025, 08:52:30
2025-03-09 08:52:30,508 [INFO]: 		-> Instanciate the index HNSW15 03/09/2025, 08:52:30
2025-03-09 08:52:30,509 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0008 secs
2025-03-09 08:52:30,509 [INFO]: 		-> Adding the vectors to the index 03/09/2025, 08:52:30
2025-03-09 08:52:30,509 [INFO]: The memory available for adding the vectors is 49.1GB(total available - used by the index)
2025-03-09 08:52:30,509 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/22 [00:00<?, ?it/s]  5%|▍         | 1/22 [00:00<00:03,  6.08it/s]  9%|▉         | 2/22 [00:00<00:02,  7.61it/s] 14%|█▎        | 3/22 [00:00<00:02,  8.25it/s] 18%|█▊        | 4/22 [00:00<00:02,  8.61it/s] 23%|██▎       | 5/22 [00:00<00:01,  8.96it/s] 27%|██▋       | 6/22 [00:00<00:01,  9.01it/s] 32%|███▏      | 7/22 [00:00<00:01,  9.06it/s] 36%|███▋      | 8/22 [00:00<00:01,  9.01it/s] 41%|████      | 9/22 [00:01<00:01,  9.00it/s] 45%|████▌     | 10/22 [00:01<00:01,  9.06it/s] 50%|█████     | 11/22 [00:01<00:01,  8.96it/s] 55%|█████▍    | 12/22 [00:01<00:01,  8.94it/s] 59%|█████▉    | 13/22 [00:01<00:01,  8.90it/s] 64%|██████▎   | 14/22 [00:01<00:00,  8.86it/s] 68%|██████▊   | 15/22 [00:01<00:00,  8.90it/s] 73%|███████▎  | 16/22 [00:01<00:00,  8.82it/s] 82%|████████▏ | 18/22 [00:02<00:00,  9.89it/s] 91%|█████████ | 20/22 [00:02<00:00, 10.63it/s]100%|██████████| 22/22 [00:05<00:00,  1.33it/s]100%|██████████| 22/22 [00:05<00:00,  3.67it/s]
2025-03-09 08:52:36,510 [INFO]: 	Computing best hyperparameters for index knn.index 03/09/2025, 08:52:36
2025-03-09 08:53:19,657 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 43.1468 secs
2025-03-09 08:53:19,657 [INFO]: The best hyperparameters are: efSearch=215
2025-03-09 08:53:19,657 [INFO]: 	Compute fast metrics 03/09/2025, 08:53:19
  0%|          | 0/4 [00:00<?, ?it/s] 50%|█████     | 2/4 [00:00<00:00, 17.60it/s] 75%|███████▌  | 3/4 [00:00<00:00, 19.35it/s]
2025-03-09 08:53:37,496 [INFO]: 	>>> Finished "Compute fast metrics" in 17.8380 secs
2025-03-09 08:53:37,496 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 66.9874 secs
2025-03-09 08:53:37,496 [INFO]: {
2025-03-09 08:53:37,496 [INFO]: 	index_key: HNSW15
2025-03-09 08:53:37,496 [INFO]: 	index_param: efSearch=215
2025-03-09 08:53:37,496 [INFO]: 	index_path: knn.index
2025-03-09 08:53:37,496 [INFO]: 	size in bytes: 1000836970
2025-03-09 08:53:37,496 [INFO]: 	avg_search_speed_ms: 9.659172823103729
2025-03-09 08:53:37,496 [INFO]: 	99p_search_speed_ms: 18.082199790514977
2025-03-09 08:53:37,496 [INFO]: 	reconstruction error %: 0.0
2025-03-09 08:53:37,496 [INFO]: 	nb vectors: 5087
2025-03-09 08:53:37,496 [INFO]: 	vectors dimension: 49152
2025-03-09 08:53:37,496 [INFO]: 	compression ratio: 0.9993085047607704
2025-03-09 08:53:37,496 [INFO]: }
2025-03-09 08:53:37,496 [INFO]: 	>>> Finished "Creating the index" in 66.9886 secs
2025-03-09 08:53:37,496 [INFO]: >>> Finished "Launching the whole pipeline" in 67.0159 secs
2025-03-09 08:53:38: [retrieval_preprocessing] calculating distances ...
2025-03-09 08:53:39: [retrieval_preprocessing] finished and saved retrieval indices for episode 26408 [episode count 19/20]
2025-03-09 08:53:39: [retrieval_preprocessing] finished for (8150285641, 'marker') [chosen_id count 5/10]
2025-03-09 08:53:42: [retrieval_preprocessing] concatenated all embeddings and indices for 20 episodes for (8456936732, 'bottle') [chosen_id count 6/10]
2025-03-09 08:53:42: [retrieval_preprocessing] we have num_total=4711 embedding_dim=49152
[retrieval_preprocessing] for episode 16515 [episode count 0/20], we have num_retrieval=np.int64(4610) num_query=np.int64(101)
2025-03-09 08:53:43,429 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-09 08:53:44,064 [INFO]: Launching the whole pipeline 03/09/2025, 08:53:44
2025-03-09 08:53:44,064 [INFO]: Reading total number of vectors and dimension 03/09/2025, 08:53:44
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 2142.14it/s]
2025-03-09 08:53:44,091 [INFO]: There are 4610 embeddings of dim 49152
2025-03-09 08:53:44,091 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0272 secs
2025-03-09 08:53:44,092 [INFO]: 	Compute estimated construction time of the index 03/09/2025, 08:53:44
2025-03-09 08:53:44,092 [INFO]: 		-> Train: 16.7 minutes
2025-03-09 08:53:44,092 [INFO]: 		-> Add: 2.5 seconds
2025-03-09 08:53:44,092 [INFO]: 		Total: 16.7 minutes
2025-03-09 08:53:44,092 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0001 secs
2025-03-09 08:53:44,092 [INFO]: 	Checking that your have enough memory available to create the index 03/09/2025, 08:53:44
2025-03-09 08:53:44,092 [INFO]: 951.4MB of memory will be needed to build the index (more might be used if you have more)
2025-03-09 08:53:44,092 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0002 secs
2025-03-09 08:53:44,092 [INFO]: 	Selecting most promising index types given data characteristics 03/09/2025, 08:53:44
2025-03-09 08:53:44,092 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-09 08:53:44,092 [INFO]: 	Creating the index 03/09/2025, 08:53:44
2025-03-09 08:53:44,092 [INFO]: 		-> Instanciate the index HNSW15 03/09/2025, 08:53:44
2025-03-09 08:53:44,093 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0011 secs
2025-03-09 08:53:44,093 [INFO]: 		-> Adding the vectors to the index 03/09/2025, 08:53:44
2025-03-09 08:53:44,093 [INFO]: The memory available for adding the vectors is 49.2GB(total available - used by the index)
2025-03-09 08:53:44,094 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/19 [00:00<?, ?it/s]  5%|▌         | 1/19 [00:00<00:03,  5.11it/s] 11%|█         | 2/19 [00:00<00:02,  6.81it/s] 16%|█▌        | 3/19 [00:00<00:02,  7.60it/s] 21%|██        | 4/19 [00:00<00:01,  8.06it/s] 26%|██▋       | 5/19 [00:00<00:01,  8.24it/s] 32%|███▏      | 6/19 [00:00<00:01,  8.55it/s] 37%|███▋      | 7/19 [00:00<00:01,  8.91it/s] 42%|████▏     | 8/19 [00:00<00:01,  9.06it/s] 47%|████▋     | 9/19 [00:01<00:01,  9.13it/s] 53%|█████▎    | 10/19 [00:01<00:00,  9.06it/s] 58%|█████▊    | 11/19 [00:01<00:00,  9.09it/s] 63%|██████▎   | 12/19 [00:01<00:00,  9.16it/s] 68%|██████▊   | 13/19 [00:01<00:00,  8.83it/s] 74%|███████▎  | 14/19 [00:01<00:00,  9.13it/s] 95%|█████████▍| 18/19 [00:01<00:00, 16.47it/s]100%|██████████| 19/19 [00:04<00:00,  3.89it/s]
2025-03-09 08:53:48,984 [INFO]: 	Computing best hyperparameters for index knn.index 03/09/2025, 08:53:48
2025-03-09 08:54:32,672 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 43.6881 secs
2025-03-09 08:54:32,672 [INFO]: The best hyperparameters are: efSearch=246
2025-03-09 08:54:32,672 [INFO]: 	Compute fast metrics 03/09/2025, 08:54:32
  0%|          | 0/4 [00:00<?, ?it/s] 25%|██▌       | 1/4 [00:00<00:00,  6.64it/s] 75%|███████▌  | 3/4 [00:00<00:00, 12.77it/s] 75%|███████▌  | 3/4 [00:00<00:00,  9.97it/s]
2025-03-09 08:54:52,432 [INFO]: 	>>> Finished "Compute fast metrics" in 19.7594 secs
2025-03-09 08:54:52,436 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 68.3424 secs
2025-03-09 08:54:52,436 [INFO]: {
2025-03-09 08:54:52,436 [INFO]: 	index_key: HNSW15
2025-03-09 08:54:52,436 [INFO]: 	index_param: efSearch=246
2025-03-09 08:54:52,436 [INFO]: 	index_path: knn.index
2025-03-09 08:54:52,436 [INFO]: 	size in bytes: 906989770
2025-03-09 08:54:52,436 [INFO]: 	avg_search_speed_ms: 9.674159460475874
2025-03-09 08:54:52,436 [INFO]: 	99p_search_speed_ms: 17.099885828793045
2025-03-09 08:54:52,436 [INFO]: 	reconstruction error %: 0.0
2025-03-09 08:54:52,436 [INFO]: 	nb vectors: 4610
2025-03-09 08:54:52,436 [INFO]: 	vectors dimension: 49152
2025-03-09 08:54:52,436 [INFO]: 	compression ratio: 0.9993088235162785
2025-03-09 08:54:52,436 [INFO]: }
2025-03-09 08:54:52,436 [INFO]: 	>>> Finished "Creating the index" in 68.3440 secs
2025-03-09 08:54:52,436 [INFO]: >>> Finished "Launching the whole pipeline" in 68.3720 secs
2025-03-09 08:54:53: [retrieval_preprocessing] calculating distances ...
2025-03-09 08:54:53: [retrieval_preprocessing] finished and saved retrieval indices for episode 16515 [episode count 0/20]
[retrieval_preprocessing] for episode 24196 [episode count 1/20], we have num_retrieval=np.int64(4609) num_query=np.int64(102)
2025-03-09 08:54:55,074 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-09 08:54:55,744 [INFO]: Launching the whole pipeline 03/09/2025, 08:54:55
2025-03-09 08:54:55,744 [INFO]: Reading total number of vectors and dimension 03/09/2025, 08:54:55
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1756.41it/s]
2025-03-09 08:54:55,768 [INFO]: There are 4609 embeddings of dim 49152
2025-03-09 08:54:55,768 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0240 secs
2025-03-09 08:54:55,768 [INFO]: 	Compute estimated construction time of the index 03/09/2025, 08:54:55
2025-03-09 08:54:55,768 [INFO]: 		-> Train: 16.7 minutes
2025-03-09 08:54:55,768 [INFO]: 		-> Add: 2.5 seconds
2025-03-09 08:54:55,768 [INFO]: 		Total: 16.7 minutes
2025-03-09 08:54:55,768 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0001 secs
2025-03-09 08:54:55,768 [INFO]: 	Checking that your have enough memory available to create the index 03/09/2025, 08:54:55
2025-03-09 08:54:55,768 [INFO]: 951.2MB of memory will be needed to build the index (more might be used if you have more)
2025-03-09 08:54:55,768 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0001 secs
2025-03-09 08:54:55,768 [INFO]: 	Selecting most promising index types given data characteristics 03/09/2025, 08:54:55
2025-03-09 08:54:55,768 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-09 08:54:55,768 [INFO]: 	Creating the index 03/09/2025, 08:54:55
2025-03-09 08:54:55,768 [INFO]: 		-> Instanciate the index HNSW15 03/09/2025, 08:54:55
2025-03-09 08:54:55,769 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0009 secs
2025-03-09 08:54:55,769 [INFO]: 		-> Adding the vectors to the index 03/09/2025, 08:54:55
2025-03-09 08:54:55,769 [INFO]: The memory available for adding the vectors is 49.2GB(total available - used by the index)
2025-03-09 08:54:55,769 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/19 [00:00<?, ?it/s]  5%|▌         | 1/19 [00:00<00:03,  5.13it/s] 16%|█▌        | 3/19 [00:00<00:01,  8.57it/s] 26%|██▋       | 5/19 [00:00<00:01,  9.62it/s] 37%|███▋      | 7/19 [00:00<00:01, 10.21it/s] 47%|████▋     | 9/19 [00:00<00:00, 10.16it/s] 58%|█████▊    | 11/19 [00:01<00:00, 10.37it/s] 68%|██████▊   | 13/19 [00:01<00:00, 10.47it/s] 79%|███████▉  | 15/19 [00:01<00:00, 10.49it/s] 89%|████████▉ | 17/19 [00:01<00:00, 11.11it/s]100%|██████████| 19/19 [00:05<00:00,  1.59it/s]100%|██████████| 19/19 [00:05<00:00,  3.59it/s]
2025-03-09 08:55:01,072 [INFO]: 	Computing best hyperparameters for index knn.index 03/09/2025, 08:55:01
2025-03-09 08:55:48,548 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 47.4761 secs
2025-03-09 08:55:48,549 [INFO]: The best hyperparameters are: efSearch=255
2025-03-09 08:55:48,549 [INFO]: 	Compute fast metrics 03/09/2025, 08:55:48
  0%|          | 0/4 [00:00<?, ?it/s] 25%|██▌       | 1/4 [00:00<00:00,  5.46it/s] 75%|███████▌  | 3/4 [00:00<00:00, 10.13it/s] 75%|███████▌  | 3/4 [00:00<00:00,  8.09it/s]
2025-03-09 08:56:05,524 [INFO]: 	>>> Finished "Compute fast metrics" in 16.9748 secs
2025-03-09 08:56:05,526 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 69.7571 secs
2025-03-09 08:56:05,527 [INFO]: {
2025-03-09 08:56:05,527 [INFO]: 	index_key: HNSW15
2025-03-09 08:56:05,527 [INFO]: 	index_param: efSearch=255
2025-03-09 08:56:05,527 [INFO]: 	index_path: knn.index
2025-03-09 08:56:05,527 [INFO]: 	size in bytes: 906793030
2025-03-09 08:56:05,527 [INFO]: 	avg_search_speed_ms: 9.534252462358177
2025-03-09 08:56:05,527 [INFO]: 	99p_search_speed_ms: 18.966946098953485
2025-03-09 08:56:05,527 [INFO]: 	reconstruction error %: 0.0
2025-03-09 08:56:05,527 [INFO]: 	nb vectors: 4609
2025-03-09 08:56:05,527 [INFO]: 	vectors dimension: 49152
2025-03-09 08:56:05,527 [INFO]: 	compression ratio: 0.999308819124911
2025-03-09 08:56:05,527 [INFO]: }
2025-03-09 08:56:05,527 [INFO]: 	>>> Finished "Creating the index" in 69.7584 secs
2025-03-09 08:56:05,527 [INFO]: >>> Finished "Launching the whole pipeline" in 69.7830 secs
2025-03-09 08:56:06: [retrieval_preprocessing] calculating distances ...
2025-03-09 08:56:06: [retrieval_preprocessing] finished and saved retrieval indices for episode 24196 [episode count 1/20]
[retrieval_preprocessing] for episode 41348 [episode count 2/20], we have num_retrieval=np.int64(4436) num_query=np.int64(275)
2025-03-09 08:56:07,565 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-09 08:56:08,308 [INFO]: Launching the whole pipeline 03/09/2025, 08:56:08
2025-03-09 08:56:08,308 [INFO]: Reading total number of vectors and dimension 03/09/2025, 08:56:08
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1543.16it/s]
2025-03-09 08:56:08,338 [INFO]: There are 4436 embeddings of dim 49152
2025-03-09 08:56:08,339 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0304 secs
2025-03-09 08:56:08,339 [INFO]: 	Compute estimated construction time of the index 03/09/2025, 08:56:08
2025-03-09 08:56:08,339 [INFO]: 		-> Train: 16.7 minutes
2025-03-09 08:56:08,339 [INFO]: 		-> Add: 2.4 seconds
2025-03-09 08:56:08,339 [INFO]: 		Total: 16.7 minutes
2025-03-09 08:56:08,339 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0002 secs
2025-03-09 08:56:08,339 [INFO]: 	Checking that your have enough memory available to create the index 03/09/2025, 08:56:08
2025-03-09 08:56:08,339 [INFO]: 915.5MB of memory will be needed to build the index (more might be used if you have more)
2025-03-09 08:56:08,339 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0002 secs
2025-03-09 08:56:08,339 [INFO]: 	Selecting most promising index types given data characteristics 03/09/2025, 08:56:08
2025-03-09 08:56:08,339 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-09 08:56:08,339 [INFO]: 	Creating the index 03/09/2025, 08:56:08
2025-03-09 08:56:08,339 [INFO]: 		-> Instanciate the index HNSW15 03/09/2025, 08:56:08
2025-03-09 08:56:08,341 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0012 secs
2025-03-09 08:56:08,341 [INFO]: 		-> Adding the vectors to the index 03/09/2025, 08:56:08
2025-03-09 08:56:08,341 [INFO]: The memory available for adding the vectors is 49.2GB(total available - used by the index)
2025-03-09 08:56:08,341 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/18 [00:00<?, ?it/s]  6%|▌         | 1/18 [00:00<00:01, 10.00it/s] 33%|███▎      | 6/18 [00:00<00:00, 32.57it/s] 61%|██████    | 11/18 [00:00<00:00, 39.52it/s] 89%|████████▉ | 16/18 [00:00<00:00, 42.80it/s]100%|██████████| 18/18 [00:03<00:00,  4.62it/s]
2025-03-09 08:56:12,243 [INFO]: 	Computing best hyperparameters for index knn.index 03/09/2025, 08:56:12
2025-03-09 08:57:01,212 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 48.9692 secs
2025-03-09 08:57:01,213 [INFO]: The best hyperparameters are: efSearch=228
2025-03-09 08:57:01,213 [INFO]: 	Compute fast metrics 03/09/2025, 08:57:01
  0%|          | 0/4 [00:00<?, ?it/s] 50%|█████     | 2/4 [00:00<00:00, 18.89it/s] 75%|███████▌  | 3/4 [00:00<00:00, 21.25it/s]
2025-03-09 08:57:25,717 [INFO]: 	>>> Finished "Compute fast metrics" in 24.5035 secs
2025-03-09 08:57:25,721 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 77.3798 secs
2025-03-09 08:57:25,721 [INFO]: {
2025-03-09 08:57:25,721 [INFO]: 	index_key: HNSW15
2025-03-09 08:57:25,721 [INFO]: 	index_param: efSearch=228
2025-03-09 08:57:25,721 [INFO]: 	index_path: knn.index
2025-03-09 08:57:25,721 [INFO]: 	size in bytes: 872756470
2025-03-09 08:57:25,721 [INFO]: 	avg_search_speed_ms: 9.361652710801165
2025-03-09 08:57:25,721 [INFO]: 	99p_search_speed_ms: 16.498078543227162
2025-03-09 08:57:25,721 [INFO]: 	reconstruction error %: 0.0
2025-03-09 08:57:25,721 [INFO]: 	nb vectors: 4436
2025-03-09 08:57:25,721 [INFO]: 	vectors dimension: 49152
2025-03-09 08:57:25,721 [INFO]: 	compression ratio: 0.9993086479209945
2025-03-09 08:57:25,721 [INFO]: }
2025-03-09 08:57:25,721 [INFO]: 	>>> Finished "Creating the index" in 77.3818 secs
2025-03-09 08:57:25,721 [INFO]: >>> Finished "Launching the whole pipeline" in 77.4130 secs
2025-03-09 08:57:27: [retrieval_preprocessing] calculating distances ...
2025-03-09 08:57:28: [retrieval_preprocessing] finished and saved retrieval indices for episode 41348 [episode count 2/20]
[retrieval_preprocessing] for episode 43526 [episode count 3/20], we have num_retrieval=np.int64(4555) num_query=np.int64(156)
2025-03-09 08:57:31,070 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-09 08:57:31,764 [INFO]: Launching the whole pipeline 03/09/2025, 08:57:31
2025-03-09 08:57:31,765 [INFO]: Reading total number of vectors and dimension 03/09/2025, 08:57:31
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 999.83it/s]
2025-03-09 08:57:31,792 [INFO]: There are 4555 embeddings of dim 49152
2025-03-09 08:57:31,792 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0271 secs
2025-03-09 08:57:31,792 [INFO]: 	Compute estimated construction time of the index 03/09/2025, 08:57:31
2025-03-09 08:57:31,792 [INFO]: 		-> Train: 16.7 minutes
2025-03-09 08:57:31,792 [INFO]: 		-> Add: 2.5 seconds
2025-03-09 08:57:31,792 [INFO]: 		Total: 16.7 minutes
2025-03-09 08:57:31,792 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0001 secs
2025-03-09 08:57:31,792 [INFO]: 	Checking that your have enough memory available to create the index 03/09/2025, 08:57:31
2025-03-09 08:57:31,792 [INFO]: 940.0MB of memory will be needed to build the index (more might be used if you have more)
2025-03-09 08:57:31,792 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0002 secs
2025-03-09 08:57:31,792 [INFO]: 	Selecting most promising index types given data characteristics 03/09/2025, 08:57:31
2025-03-09 08:57:31,792 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-09 08:57:31,792 [INFO]: 	Creating the index 03/09/2025, 08:57:31
2025-03-09 08:57:31,792 [INFO]: 		-> Instanciate the index HNSW15 03/09/2025, 08:57:31
2025-03-09 08:57:31,793 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0010 secs
2025-03-09 08:57:31,793 [INFO]: 		-> Adding the vectors to the index 03/09/2025, 08:57:31
2025-03-09 08:57:31,793 [INFO]: The memory available for adding the vectors is 49.2GB(total available - used by the index)
2025-03-09 08:57:31,794 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/18 [00:00<?, ?it/s]  6%|▌         | 1/18 [00:00<00:02,  5.89it/s] 17%|█▋        | 3/18 [00:00<00:01,  9.82it/s] 28%|██▊       | 5/18 [00:00<00:01, 10.96it/s] 39%|███▉      | 7/18 [00:00<00:00, 11.56it/s] 50%|█████     | 9/18 [00:00<00:00, 12.00it/s] 61%|██████    | 11/18 [00:00<00:00, 12.12it/s] 72%|███████▏  | 13/18 [00:01<00:00, 12.07it/s] 83%|████████▎ | 15/18 [00:01<00:00, 12.02it/s] 94%|█████████▍| 17/18 [00:01<00:00, 11.74it/s]100%|██████████| 18/18 [00:05<00:00,  3.20it/s]
2025-03-09 08:57:37,430 [INFO]: 	Computing best hyperparameters for index knn.index 03/09/2025, 08:57:37
2025-03-09 08:58:29,305 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 51.8742 secs
2025-03-09 08:58:29,306 [INFO]: The best hyperparameters are: efSearch=201
2025-03-09 08:58:29,306 [INFO]: 	Compute fast metrics 03/09/2025, 08:58:29
  0%|          | 0/4 [00:00<?, ?it/s] 50%|█████     | 2/4 [00:00<00:00, 18.82it/s] 75%|███████▌  | 3/4 [00:00<00:00, 21.13it/s]
2025-03-09 08:58:46,344 [INFO]: 	>>> Finished "Compute fast metrics" in 17.0384 secs
2025-03-09 08:58:46,490 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 74.6967 secs
2025-03-09 08:58:46,491 [INFO]: {
2025-03-09 08:58:46,491 [INFO]: 	index_key: HNSW15
2025-03-09 08:58:46,491 [INFO]: 	index_param: efSearch=201
2025-03-09 08:58:46,491 [INFO]: 	index_path: knn.index
2025-03-09 08:58:46,491 [INFO]: 	size in bytes: 896169010
2025-03-09 08:58:46,491 [INFO]: 	avg_search_speed_ms: 8.471417346953462
2025-03-09 08:58:46,491 [INFO]: 	99p_search_speed_ms: 18.982073075603715
2025-03-09 08:58:46,491 [INFO]: 	reconstruction error %: 0.0
2025-03-09 08:58:46,491 [INFO]: 	nb vectors: 4555
2025-03-09 08:58:46,491 [INFO]: 	vectors dimension: 49152
2025-03-09 08:58:46,491 [INFO]: 	compression ratio: 0.9993086460331851
2025-03-09 08:58:46,491 [INFO]: }
2025-03-09 08:58:46,491 [INFO]: 	>>> Finished "Creating the index" in 74.6990 secs
2025-03-09 08:58:46,491 [INFO]: >>> Finished "Launching the whole pipeline" in 74.7269 secs
2025-03-09 08:58:47: [retrieval_preprocessing] calculating distances ...
2025-03-09 08:58:47: [retrieval_preprocessing] finished and saved retrieval indices for episode 43526 [episode count 3/20]
[retrieval_preprocessing] for episode 48518 [episode count 4/20], we have num_retrieval=np.int64(4326) num_query=np.int64(385)
2025-03-09 08:58:48,053 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-09 08:58:48,507 [INFO]: Launching the whole pipeline 03/09/2025, 08:58:48
2025-03-09 08:58:48,507 [INFO]: Reading total number of vectors and dimension 03/09/2025, 08:58:48
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1040.25it/s]
2025-03-09 08:58:48,536 [INFO]: There are 4326 embeddings of dim 49152
2025-03-09 08:58:48,536 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0289 secs
2025-03-09 08:58:48,536 [INFO]: 	Compute estimated construction time of the index 03/09/2025, 08:58:48
2025-03-09 08:58:48,536 [INFO]: 		-> Train: 16.7 minutes
2025-03-09 08:58:48,536 [INFO]: 		-> Add: 2.4 seconds
2025-03-09 08:58:48,536 [INFO]: 		Total: 16.7 minutes
2025-03-09 08:58:48,537 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0001 secs
2025-03-09 08:58:48,537 [INFO]: 	Checking that your have enough memory available to create the index 03/09/2025, 08:58:48
2025-03-09 08:58:48,537 [INFO]: 892.8MB of memory will be needed to build the index (more might be used if you have more)
2025-03-09 08:58:48,537 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0002 secs
2025-03-09 08:58:48,537 [INFO]: 	Selecting most promising index types given data characteristics 03/09/2025, 08:58:48
2025-03-09 08:58:48,537 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-09 08:58:48,537 [INFO]: 	Creating the index 03/09/2025, 08:58:48
2025-03-09 08:58:48,537 [INFO]: 		-> Instanciate the index HNSW15 03/09/2025, 08:58:48
2025-03-09 08:58:48,538 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0011 secs
2025-03-09 08:58:48,538 [INFO]: 		-> Adding the vectors to the index 03/09/2025, 08:58:48
2025-03-09 08:58:48,538 [INFO]: The memory available for adding the vectors is 49.2GB(total available - used by the index)
2025-03-09 08:58:48,538 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/18 [00:00<?, ?it/s] 11%|█         | 2/18 [00:00<00:00, 18.04it/s] 50%|█████     | 9/18 [00:00<00:00, 43.32it/s] 89%|████████▉ | 16/18 [00:00<00:00, 50.96it/s]100%|██████████| 18/18 [00:03<00:00,  5.46it/s]
2025-03-09 08:58:51,839 [INFO]: 	Computing best hyperparameters for index knn.index 03/09/2025, 08:58:51
2025-03-09 08:59:35,862 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 44.0225 secs
2025-03-09 08:59:35,862 [INFO]: The best hyperparameters are: efSearch=300
2025-03-09 08:59:35,862 [INFO]: 	Compute fast metrics 03/09/2025, 08:59:35
  0%|          | 0/4 [00:00<?, ?it/s] 50%|█████     | 2/4 [00:00<00:00, 19.00it/s] 75%|███████▌  | 3/4 [00:00<00:00, 20.51it/s]
2025-03-09 08:59:56,967 [INFO]: 	>>> Finished "Compute fast metrics" in 21.1050 secs
2025-03-09 08:59:56,970 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 68.4320 secs
2025-03-09 08:59:56,970 [INFO]: {
2025-03-09 08:59:56,970 [INFO]: 	index_key: HNSW15
2025-03-09 08:59:56,970 [INFO]: 	index_param: efSearch=300
2025-03-09 08:59:56,970 [INFO]: 	index_path: knn.index
2025-03-09 08:59:56,970 [INFO]: 	size in bytes: 851114650
2025-03-09 08:59:56,970 [INFO]: 	avg_search_speed_ms: 12.855138783199488
2025-03-09 08:59:56,970 [INFO]: 	99p_search_speed_ms: 23.36953106801959
2025-03-09 08:59:56,970 [INFO]: 	reconstruction error %: 0.0
2025-03-09 08:59:56,971 [INFO]: 	nb vectors: 4326
2025-03-09 08:59:56,971 [INFO]: 	vectors dimension: 49152
2025-03-09 08:59:56,971 [INFO]: 	compression ratio: 0.999308621934777
2025-03-09 08:59:56,971 [INFO]: }
2025-03-09 08:59:56,971 [INFO]: 	>>> Finished "Creating the index" in 68.4338 secs
2025-03-09 08:59:56,971 [INFO]: >>> Finished "Launching the whole pipeline" in 68.4633 secs
2025-03-09 09:00:00: [retrieval_preprocessing] calculating distances ...
2025-03-09 09:00:01: [retrieval_preprocessing] finished and saved retrieval indices for episode 48518 [episode count 4/20]
[retrieval_preprocessing] for episode 78979 [episode count 5/20], we have num_retrieval=np.int64(4428) num_query=np.int64(283)
2025-03-09 09:00:02,349 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-09 09:00:03,088 [INFO]: Launching the whole pipeline 03/09/2025, 09:00:03
2025-03-09 09:00:03,088 [INFO]: Reading total number of vectors and dimension 03/09/2025, 09:00:03
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1424.70it/s]
2025-03-09 09:00:03,116 [INFO]: There are 4428 embeddings of dim 49152
2025-03-09 09:00:03,117 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0287 secs
2025-03-09 09:00:03,117 [INFO]: 	Compute estimated construction time of the index 03/09/2025, 09:00:03
2025-03-09 09:00:03,117 [INFO]: 		-> Train: 16.7 minutes
2025-03-09 09:00:03,117 [INFO]: 		-> Add: 2.4 seconds
2025-03-09 09:00:03,117 [INFO]: 		Total: 16.7 minutes
2025-03-09 09:00:03,117 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0001 secs
2025-03-09 09:00:03,117 [INFO]: 	Checking that your have enough memory available to create the index 03/09/2025, 09:00:03
2025-03-09 09:00:03,117 [INFO]: 913.8MB of memory will be needed to build the index (more might be used if you have more)
2025-03-09 09:00:03,117 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0002 secs
2025-03-09 09:00:03,117 [INFO]: 	Selecting most promising index types given data characteristics 03/09/2025, 09:00:03
2025-03-09 09:00:03,117 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-09 09:00:03,117 [INFO]: 	Creating the index 03/09/2025, 09:00:03
2025-03-09 09:00:03,117 [INFO]: 		-> Instanciate the index HNSW15 03/09/2025, 09:00:03
2025-03-09 09:00:03,118 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0011 secs
2025-03-09 09:00:03,118 [INFO]: 		-> Adding the vectors to the index 03/09/2025, 09:00:03
2025-03-09 09:00:03,118 [INFO]: The memory available for adding the vectors is 49.2GB(total available - used by the index)
2025-03-09 09:00:03,118 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/18 [00:00<?, ?it/s] 11%|█         | 2/18 [00:00<00:00, 19.64it/s] 44%|████▍     | 8/18 [00:00<00:00, 42.21it/s] 78%|███████▊  | 14/18 [00:00<00:00, 47.33it/s]100%|██████████| 18/18 [00:03<00:00,  5.11it/s]
2025-03-09 09:00:06,779 [INFO]: 	Computing best hyperparameters for index knn.index 03/09/2025, 09:00:06
2025-03-09 09:00:53,093 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 46.3135 secs
2025-03-09 09:00:53,094 [INFO]: The best hyperparameters are: efSearch=256
2025-03-09 09:00:53,094 [INFO]: 	Compute fast metrics 03/09/2025, 09:00:53
  0%|          | 0/4 [00:00<?, ?it/s] 50%|█████     | 2/4 [00:00<00:00, 16.31it/s] 75%|███████▌  | 3/4 [00:00<00:00, 18.55it/s]
2025-03-09 09:01:11,535 [INFO]: 	>>> Finished "Compute fast metrics" in 18.4409 secs
2025-03-09 09:01:11,538 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 68.4194 secs
2025-03-09 09:01:11,538 [INFO]: {
2025-03-09 09:01:11,538 [INFO]: 	index_key: HNSW15
2025-03-09 09:01:11,538 [INFO]: 	index_param: efSearch=256
2025-03-09 09:01:11,538 [INFO]: 	index_path: knn.index
2025-03-09 09:01:11,538 [INFO]: 	size in bytes: 871182550
2025-03-09 09:01:11,538 [INFO]: 	avg_search_speed_ms: 9.811177121802535
2025-03-09 09:01:11,538 [INFO]: 	99p_search_speed_ms: 17.515369048342105
2025-03-09 09:01:11,538 [INFO]: 	reconstruction error %: 0.0
2025-03-09 09:01:11,538 [INFO]: 	nb vectors: 4428
2025-03-09 09:01:11,538 [INFO]: 	vectors dimension: 49152
2025-03-09 09:01:11,538 [INFO]: 	compression ratio: 0.9993086110368028
2025-03-09 09:01:11,538 [INFO]: }
2025-03-09 09:01:11,538 [INFO]: 	>>> Finished "Creating the index" in 68.4213 secs
2025-03-09 09:01:11,538 [INFO]: >>> Finished "Launching the whole pipeline" in 68.4506 secs
2025-03-09 09:01:13: [retrieval_preprocessing] calculating distances ...
2025-03-09 09:01:14: [retrieval_preprocessing] finished and saved retrieval indices for episode 78979 [episode count 5/20]
[retrieval_preprocessing] for episode 65802 [episode count 6/20], we have num_retrieval=np.int64(4417) num_query=np.int64(294)
2025-03-09 09:01:14,825 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-09 09:01:15,440 [INFO]: Launching the whole pipeline 03/09/2025, 09:01:15
2025-03-09 09:01:15,440 [INFO]: Reading total number of vectors and dimension 03/09/2025, 09:01:15
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1096.26it/s]
2025-03-09 09:01:15,487 [INFO]: There are 4417 embeddings of dim 49152
2025-03-09 09:01:15,487 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0464 secs
2025-03-09 09:01:15,487 [INFO]: 	Compute estimated construction time of the index 03/09/2025, 09:01:15
2025-03-09 09:01:15,487 [INFO]: 		-> Train: 16.7 minutes
2025-03-09 09:01:15,487 [INFO]: 		-> Add: 2.4 seconds
2025-03-09 09:01:15,487 [INFO]: 		Total: 16.7 minutes
2025-03-09 09:01:15,487 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0002 secs
2025-03-09 09:01:15,487 [INFO]: 	Checking that your have enough memory available to create the index 03/09/2025, 09:01:15
2025-03-09 09:01:15,487 [INFO]: 911.6MB of memory will be needed to build the index (more might be used if you have more)
2025-03-09 09:01:15,488 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0002 secs
2025-03-09 09:01:15,488 [INFO]: 	Selecting most promising index types given data characteristics 03/09/2025, 09:01:15
2025-03-09 09:01:15,488 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-09 09:01:15,488 [INFO]: 	Creating the index 03/09/2025, 09:01:15
2025-03-09 09:01:15,488 [INFO]: 		-> Instanciate the index HNSW15 03/09/2025, 09:01:15
2025-03-09 09:01:15,490 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0018 secs
2025-03-09 09:01:15,490 [INFO]: 		-> Adding the vectors to the index 03/09/2025, 09:01:15
2025-03-09 09:01:15,490 [INFO]: The memory available for adding the vectors is 49.2GB(total available - used by the index)
2025-03-09 09:01:15,490 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/18 [00:00<?, ?it/s] 17%|█▋        | 3/18 [00:00<00:00, 26.06it/s] 56%|█████▌    | 10/18 [00:00<00:00, 48.00it/s] 94%|█████████▍| 17/18 [00:00<00:00, 56.13it/s]100%|██████████| 18/18 [00:02<00:00,  6.75it/s]
2025-03-09 09:01:18,161 [INFO]: 	Computing best hyperparameters for index knn.index 03/09/2025, 09:01:18
2025-03-09 09:02:02,740 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 44.5791 secs
2025-03-09 09:02:02,741 [INFO]: The best hyperparameters are: efSearch=252
2025-03-09 09:02:02,741 [INFO]: 	Compute fast metrics 03/09/2025, 09:02:02
  0%|          | 0/4 [00:00<?, ?it/s] 50%|█████     | 2/4 [00:00<00:00, 18.35it/s] 75%|███████▌  | 3/4 [00:00<00:00, 19.70it/s]
2025-03-09 09:02:21,528 [INFO]: 	>>> Finished "Compute fast metrics" in 18.7871 secs
2025-03-09 09:02:21,531 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 66.0410 secs
2025-03-09 09:02:21,531 [INFO]: {
2025-03-09 09:02:21,531 [INFO]: 	index_key: HNSW15
2025-03-09 09:02:21,531 [INFO]: 	index_param: efSearch=252
2025-03-09 09:02:21,531 [INFO]: 	index_path: knn.index
2025-03-09 09:02:21,531 [INFO]: 	size in bytes: 869018410
2025-03-09 09:02:21,531 [INFO]: 	avg_search_speed_ms: 10.079973987294286
2025-03-09 09:02:21,531 [INFO]: 	99p_search_speed_ms: 20.681282361038086
2025-03-09 09:02:21,531 [INFO]: 	reconstruction error %: 0.0
2025-03-09 09:02:21,531 [INFO]: 	nb vectors: 4417
2025-03-09 09:02:21,531 [INFO]: 	vectors dimension: 49152
2025-03-09 09:02:21,531 [INFO]: 	compression ratio: 0.9993085601028867
2025-03-09 09:02:21,531 [INFO]: }
2025-03-09 09:02:21,531 [INFO]: 	>>> Finished "Creating the index" in 66.0434 secs
2025-03-09 09:02:21,531 [INFO]: >>> Finished "Launching the whole pipeline" in 66.0908 secs
2025-03-09 09:02:23: [retrieval_preprocessing] calculating distances ...
2025-03-09 09:02:24: [retrieval_preprocessing] finished and saved retrieval indices for episode 65802 [episode count 6/20]
[retrieval_preprocessing] for episode 11275 [episode count 7/20], we have num_retrieval=np.int64(4561) num_query=np.int64(150)
2025-03-09 09:02:24,650 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-09 09:02:25,403 [INFO]: Launching the whole pipeline 03/09/2025, 09:02:25
2025-03-09 09:02:25,403 [INFO]: Reading total number of vectors and dimension 03/09/2025, 09:02:25
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1328.15it/s]
2025-03-09 09:02:25,436 [INFO]: There are 4561 embeddings of dim 49152
2025-03-09 09:02:25,437 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0339 secs
2025-03-09 09:02:25,437 [INFO]: 	Compute estimated construction time of the index 03/09/2025, 09:02:25
2025-03-09 09:02:25,437 [INFO]: 		-> Train: 16.7 minutes
2025-03-09 09:02:25,437 [INFO]: 		-> Add: 2.5 seconds
2025-03-09 09:02:25,437 [INFO]: 		Total: 16.7 minutes
2025-03-09 09:02:25,437 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0004 secs
2025-03-09 09:02:25,437 [INFO]: 	Checking that your have enough memory available to create the index 03/09/2025, 09:02:25
2025-03-09 09:02:25,438 [INFO]: 941.3MB of memory will be needed to build the index (more might be used if you have more)
2025-03-09 09:02:25,438 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0004 secs
2025-03-09 09:02:25,438 [INFO]: 	Selecting most promising index types given data characteristics 03/09/2025, 09:02:25
2025-03-09 09:02:25,438 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-09 09:02:25,438 [INFO]: 	Creating the index 03/09/2025, 09:02:25
2025-03-09 09:02:25,439 [INFO]: 		-> Instanciate the index HNSW15 03/09/2025, 09:02:25
2025-03-09 09:02:25,442 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0029 secs
2025-03-09 09:02:25,442 [INFO]: 		-> Adding the vectors to the index 03/09/2025, 09:02:25
2025-03-09 09:02:25,442 [INFO]: The memory available for adding the vectors is 49.2GB(total available - used by the index)
2025-03-09 09:02:25,442 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/18 [00:00<?, ?it/s] 11%|█         | 2/18 [00:00<00:00, 19.38it/s] 44%|████▍     | 8/18 [00:00<00:00, 42.72it/s] 83%|████████▎ | 15/18 [00:00<00:00, 51.39it/s]100%|██████████| 18/18 [00:03<00:00,  5.43it/s]
2025-03-09 09:02:28,762 [INFO]: 	Computing best hyperparameters for index knn.index 03/09/2025, 09:02:28
2025-03-09 09:03:15,433 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 46.6710 secs
2025-03-09 09:03:15,434 [INFO]: The best hyperparameters are: efSearch=238
2025-03-09 09:03:15,434 [INFO]: 	Compute fast metrics 03/09/2025, 09:03:15
  0%|          | 0/4 [00:00<?, ?it/s] 50%|█████     | 2/4 [00:00<00:00, 18.63it/s] 75%|███████▌  | 3/4 [00:00<00:00, 16.49it/s]
2025-03-09 09:03:29,278 [INFO]: 	>>> Finished "Compute fast metrics" in 13.8445 secs
2025-03-09 09:03:29,280 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 63.8385 secs
2025-03-09 09:03:29,281 [INFO]: {
2025-03-09 09:03:29,281 [INFO]: 	index_key: HNSW15
2025-03-09 09:03:29,281 [INFO]: 	index_param: efSearch=238
2025-03-09 09:03:29,281 [INFO]: 	index_path: knn.index
2025-03-09 09:03:29,281 [INFO]: 	size in bytes: 897349450
2025-03-09 09:03:29,281 [INFO]: 	avg_search_speed_ms: 8.338033835488288
2025-03-09 09:03:29,281 [INFO]: 	99p_search_speed_ms: 14.501991849392653
2025-03-09 09:03:29,281 [INFO]: 	reconstruction error %: 0.0
2025-03-09 09:03:29,281 [INFO]: 	nb vectors: 4561
2025-03-09 09:03:29,281 [INFO]: 	vectors dimension: 49152
2025-03-09 09:03:29,281 [INFO]: 	compression ratio: 0.9993086728921492
2025-03-09 09:03:29,281 [INFO]: }
2025-03-09 09:03:29,281 [INFO]: 	>>> Finished "Creating the index" in 63.8424 secs
2025-03-09 09:03:29,281 [INFO]: >>> Finished "Launching the whole pipeline" in 63.8780 secs
2025-03-09 09:03:30: [retrieval_preprocessing] calculating distances ...
2025-03-09 09:03:30: [retrieval_preprocessing] finished and saved retrieval indices for episode 11275 [episode count 7/20]
[retrieval_preprocessing] for episode 73739 [episode count 8/20], we have num_retrieval=np.int64(4350) num_query=np.int64(361)
2025-03-09 09:03:31,080 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-09 09:03:31,649 [INFO]: Launching the whole pipeline 03/09/2025, 09:03:31
2025-03-09 09:03:31,649 [INFO]: Reading total number of vectors and dimension 03/09/2025, 09:03:31
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 2028.19it/s]
2025-03-09 09:03:31,678 [INFO]: There are 4350 embeddings of dim 49152
2025-03-09 09:03:31,678 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0294 secs
2025-03-09 09:03:31,678 [INFO]: 	Compute estimated construction time of the index 03/09/2025, 09:03:31
2025-03-09 09:03:31,679 [INFO]: 		-> Train: 16.7 minutes
2025-03-09 09:03:31,679 [INFO]: 		-> Add: 2.4 seconds
2025-03-09 09:03:31,679 [INFO]: 		Total: 16.7 minutes
2025-03-09 09:03:31,679 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0001 secs
2025-03-09 09:03:31,679 [INFO]: 	Checking that your have enough memory available to create the index 03/09/2025, 09:03:31
2025-03-09 09:03:31,679 [INFO]: 897.7MB of memory will be needed to build the index (more might be used if you have more)
2025-03-09 09:03:31,679 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0003 secs
2025-03-09 09:03:31,679 [INFO]: 	Selecting most promising index types given data characteristics 03/09/2025, 09:03:31
2025-03-09 09:03:31,679 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-09 09:03:31,679 [INFO]: 	Creating the index 03/09/2025, 09:03:31
2025-03-09 09:03:31,679 [INFO]: 		-> Instanciate the index HNSW15 03/09/2025, 09:03:31
2025-03-09 09:03:31,680 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0012 secs
2025-03-09 09:03:31,680 [INFO]: 		-> Adding the vectors to the index 03/09/2025, 09:03:31
2025-03-09 09:03:31,681 [INFO]: The memory available for adding the vectors is 49.2GB(total available - used by the index)
2025-03-09 09:03:31,681 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/18 [00:00<?, ?it/s]  6%|▌         | 1/18 [00:00<00:01,  9.97it/s] 33%|███▎      | 6/18 [00:00<00:00, 27.22it/s] 61%|██████    | 11/18 [00:00<00:00, 36.18it/s] 94%|█████████▍| 17/18 [00:00<00:00, 42.34it/s]100%|██████████| 18/18 [00:03<00:00,  5.31it/s]
2025-03-09 09:03:35,074 [INFO]: 	Computing best hyperparameters for index knn.index 03/09/2025, 09:03:35
2025-03-09 09:04:18,294 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 43.2193 secs
2025-03-09 09:04:18,294 [INFO]: The best hyperparameters are: efSearch=253
2025-03-09 09:04:18,294 [INFO]: 	Compute fast metrics 03/09/2025, 09:04:18
  0%|          | 0/4 [00:00<?, ?it/s] 50%|█████     | 2/4 [00:00<00:00, 19.11it/s] 75%|███████▌  | 3/4 [00:00<00:00, 20.65it/s]
2025-03-09 09:04:32,489 [INFO]: 	>>> Finished "Compute fast metrics" in 14.1956 secs
2025-03-09 09:04:32,492 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 60.8110 secs
2025-03-09 09:04:32,492 [INFO]: {
2025-03-09 09:04:32,492 [INFO]: 	index_key: HNSW15
2025-03-09 09:04:32,492 [INFO]: 	index_param: efSearch=253
2025-03-09 09:04:32,492 [INFO]: 	index_path: knn.index
2025-03-09 09:04:32,492 [INFO]: 	size in bytes: 855836590
2025-03-09 09:04:32,492 [INFO]: 	avg_search_speed_ms: 8.92894837888889
2025-03-09 09:04:32,492 [INFO]: 	99p_search_speed_ms: 16.068017694633436
2025-03-09 09:04:32,492 [INFO]: 	reconstruction error %: 0.0
2025-03-09 09:04:32,492 [INFO]: 	nb vectors: 4350
2025-03-09 09:04:32,492 [INFO]: 	vectors dimension: 49152
2025-03-09 09:04:32,492 [INFO]: 	compression ratio: 0.9993085245397139
2025-03-09 09:04:32,492 [INFO]: }
2025-03-09 09:04:32,492 [INFO]: 	>>> Finished "Creating the index" in 60.8127 secs
2025-03-09 09:04:32,492 [INFO]: >>> Finished "Launching the whole pipeline" in 60.8428 secs
2025-03-09 09:04:34: [retrieval_preprocessing] calculating distances ...
2025-03-09 09:04:35: [retrieval_preprocessing] finished and saved retrieval indices for episode 73739 [episode count 8/20]
[retrieval_preprocessing] for episode 1549 [episode count 9/20], we have num_retrieval=np.int64(4575) num_query=np.int64(136)
2025-03-09 09:04:35,646 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-09 09:04:36,265 [INFO]: Launching the whole pipeline 03/09/2025, 09:04:36
2025-03-09 09:04:36,265 [INFO]: Reading total number of vectors and dimension 03/09/2025, 09:04:36
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 2027.21it/s]
2025-03-09 09:04:36,294 [INFO]: There are 4575 embeddings of dim 49152
2025-03-09 09:04:36,294 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0288 secs
2025-03-09 09:04:36,294 [INFO]: 	Compute estimated construction time of the index 03/09/2025, 09:04:36
2025-03-09 09:04:36,294 [INFO]: 		-> Train: 16.7 minutes
2025-03-09 09:04:36,294 [INFO]: 		-> Add: 2.5 seconds
2025-03-09 09:04:36,294 [INFO]: 		Total: 16.7 minutes
2025-03-09 09:04:36,294 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0001 secs
2025-03-09 09:04:36,295 [INFO]: 	Checking that your have enough memory available to create the index 03/09/2025, 09:04:36
2025-03-09 09:04:36,295 [INFO]: 944.2MB of memory will be needed to build the index (more might be used if you have more)
2025-03-09 09:04:36,295 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0002 secs
2025-03-09 09:04:36,295 [INFO]: 	Selecting most promising index types given data characteristics 03/09/2025, 09:04:36
2025-03-09 09:04:36,295 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-09 09:04:36,295 [INFO]: 	Creating the index 03/09/2025, 09:04:36
2025-03-09 09:04:36,295 [INFO]: 		-> Instanciate the index HNSW15 03/09/2025, 09:04:36
2025-03-09 09:04:36,296 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0011 secs
2025-03-09 09:04:36,296 [INFO]: 		-> Adding the vectors to the index 03/09/2025, 09:04:36
2025-03-09 09:04:36,296 [INFO]: The memory available for adding the vectors is 49.2GB(total available - used by the index)
2025-03-09 09:04:36,296 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/19 [00:00<?, ?it/s]  5%|▌         | 1/19 [00:00<00:02,  8.35it/s] 32%|███▏      | 6/19 [00:00<00:00, 30.60it/s] 58%|█████▊    | 11/19 [00:00<00:00, 36.28it/s] 84%|████████▍ | 16/19 [00:00<00:00, 39.56it/s]100%|██████████| 19/19 [00:03<00:00,  5.23it/s]
2025-03-09 09:04:39,936 [INFO]: 	Computing best hyperparameters for index knn.index 03/09/2025, 09:04:39
2025-03-09 09:05:23,130 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 43.1928 secs
2025-03-09 09:05:23,130 [INFO]: The best hyperparameters are: efSearch=296
2025-03-09 09:05:23,130 [INFO]: 	Compute fast metrics 03/09/2025, 09:05:23
  0%|          | 0/4 [00:00<?, ?it/s] 50%|█████     | 2/4 [00:00<00:00, 19.85it/s] 75%|███████▌  | 3/4 [00:00<00:00, 21.23it/s]
2025-03-09 09:05:43,181 [INFO]: 	>>> Finished "Compute fast metrics" in 20.0509 secs
2025-03-09 09:05:43,184 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 66.8872 secs
2025-03-09 09:05:43,184 [INFO]: {
2025-03-09 09:05:43,184 [INFO]: 	index_key: HNSW15
2025-03-09 09:05:43,184 [INFO]: 	index_param: efSearch=296
2025-03-09 09:05:43,184 [INFO]: 	index_path: knn.index
2025-03-09 09:05:43,184 [INFO]: 	size in bytes: 900103810
2025-03-09 09:05:43,184 [INFO]: 	avg_search_speed_ms: 10.548338680361095
2025-03-09 09:05:43,184 [INFO]: 	99p_search_speed_ms: 18.299484180752184
2025-03-09 09:05:43,184 [INFO]: 	reconstruction error %: 0.0
2025-03-09 09:05:43,184 [INFO]: 	nb vectors: 4575
2025-03-09 09:05:43,184 [INFO]: 	vectors dimension: 49152
2025-03-09 09:05:43,184 [INFO]: 	compression ratio: 0.9993087352890996
2025-03-09 09:05:43,184 [INFO]: }
2025-03-09 09:05:43,184 [INFO]: 	>>> Finished "Creating the index" in 66.8889 secs
2025-03-09 09:05:43,184 [INFO]: >>> Finished "Launching the whole pipeline" in 66.9184 secs
2025-03-09 09:05:44: [retrieval_preprocessing] calculating distances ...
2025-03-09 09:05:45: [retrieval_preprocessing] finished and saved retrieval indices for episode 1549 [episode count 9/20]
[retrieval_preprocessing] for episode 49550 [episode count 10/20], we have num_retrieval=np.int64(4619) num_query=np.int64(92)
2025-03-09 09:05:45,401 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-09 09:05:45,990 [INFO]: Launching the whole pipeline 03/09/2025, 09:05:45
2025-03-09 09:05:45,990 [INFO]: Reading total number of vectors and dimension 03/09/2025, 09:05:45
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1848.53it/s]
2025-03-09 09:05:46,017 [INFO]: There are 4619 embeddings of dim 49152
2025-03-09 09:05:46,017 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0264 secs
2025-03-09 09:05:46,017 [INFO]: 	Compute estimated construction time of the index 03/09/2025, 09:05:46
2025-03-09 09:05:46,017 [INFO]: 		-> Train: 16.7 minutes
2025-03-09 09:05:46,017 [INFO]: 		-> Add: 2.5 seconds
2025-03-09 09:05:46,017 [INFO]: 		Total: 16.7 minutes
2025-03-09 09:05:46,017 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0001 secs
2025-03-09 09:05:46,017 [INFO]: 	Checking that your have enough memory available to create the index 03/09/2025, 09:05:46
2025-03-09 09:05:46,017 [INFO]: 953.3MB of memory will be needed to build the index (more might be used if you have more)
2025-03-09 09:05:46,017 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0001 secs
2025-03-09 09:05:46,017 [INFO]: 	Selecting most promising index types given data characteristics 03/09/2025, 09:05:46
2025-03-09 09:05:46,017 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-09 09:05:46,017 [INFO]: 	Creating the index 03/09/2025, 09:05:46
2025-03-09 09:05:46,017 [INFO]: 		-> Instanciate the index HNSW15 03/09/2025, 09:05:46
2025-03-09 09:05:46,018 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0008 secs
2025-03-09 09:05:46,018 [INFO]: 		-> Adding the vectors to the index 03/09/2025, 09:05:46
2025-03-09 09:05:46,018 [INFO]: The memory available for adding the vectors is 49.2GB(total available - used by the index)
2025-03-09 09:05:46,018 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/19 [00:00<?, ?it/s] 11%|█         | 2/19 [00:00<00:00, 17.21it/s] 32%|███▏      | 6/19 [00:00<00:00, 28.16it/s] 63%|██████▎   | 12/19 [00:00<00:00, 38.74it/s] 95%|█████████▍| 18/19 [00:00<00:00, 43.52it/s]100%|██████████| 19/19 [00:03<00:00,  5.35it/s]
2025-03-09 09:05:49,572 [INFO]: 	Computing best hyperparameters for index knn.index 03/09/2025, 09:05:49
2025-03-09 09:06:33,058 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 43.4859 secs
2025-03-09 09:06:33,058 [INFO]: The best hyperparameters are: efSearch=262
2025-03-09 09:06:33,058 [INFO]: 	Compute fast metrics 03/09/2025, 09:06:33
  0%|          | 0/4 [00:00<?, ?it/s] 50%|█████     | 2/4 [00:00<00:00, 19.84it/s] 75%|███████▌  | 3/4 [00:00<00:00, 18.47it/s]
2025-03-09 09:06:49,751 [INFO]: 	>>> Finished "Compute fast metrics" in 16.6927 secs
2025-03-09 09:06:49,754 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 63.7355 secs
2025-03-09 09:06:49,754 [INFO]: {
2025-03-09 09:06:49,754 [INFO]: 	index_key: HNSW15
2025-03-09 09:06:49,754 [INFO]: 	index_param: efSearch=262
2025-03-09 09:06:49,754 [INFO]: 	index_path: knn.index
2025-03-09 09:06:49,754 [INFO]: 	size in bytes: 908760430
2025-03-09 09:06:49,754 [INFO]: 	avg_search_speed_ms: 10.270571515434545
2025-03-09 09:06:49,754 [INFO]: 	99p_search_speed_ms: 23.3508500107564
2025-03-09 09:06:49,754 [INFO]: 	reconstruction error %: 0.0
2025-03-09 09:06:49,754 [INFO]: 	nb vectors: 4619
2025-03-09 09:06:49,754 [INFO]: 	vectors dimension: 49152
2025-03-09 09:06:49,754 [INFO]: 	compression ratio: 0.9993088629530227
2025-03-09 09:06:49,754 [INFO]: }
2025-03-09 09:06:49,754 [INFO]: 	>>> Finished "Creating the index" in 63.7369 secs
2025-03-09 09:06:49,754 [INFO]: >>> Finished "Launching the whole pipeline" in 63.7639 secs
2025-03-09 09:06:50: [retrieval_preprocessing] calculating distances ...
2025-03-09 09:06:50: [retrieval_preprocessing] finished and saved retrieval indices for episode 49550 [episode count 10/20]
[retrieval_preprocessing] for episode 28051 [episode count 11/20], we have num_retrieval=np.int64(4396) num_query=np.int64(315)
2025-03-09 09:06:51,056 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-09 09:06:51,673 [INFO]: Launching the whole pipeline 03/09/2025, 09:06:51
2025-03-09 09:06:51,673 [INFO]: Reading total number of vectors and dimension 03/09/2025, 09:06:51
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1333.22it/s]
2025-03-09 09:06:51,702 [INFO]: There are 4396 embeddings of dim 49152
2025-03-09 09:06:51,702 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0294 secs
2025-03-09 09:06:51,702 [INFO]: 	Compute estimated construction time of the index 03/09/2025, 09:06:51
2025-03-09 09:06:51,702 [INFO]: 		-> Train: 16.7 minutes
2025-03-09 09:06:51,702 [INFO]: 		-> Add: 2.4 seconds
2025-03-09 09:06:51,702 [INFO]: 		Total: 16.7 minutes
2025-03-09 09:06:51,702 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0001 secs
2025-03-09 09:06:51,702 [INFO]: 	Checking that your have enough memory available to create the index 03/09/2025, 09:06:51
2025-03-09 09:06:51,702 [INFO]: 907.2MB of memory will be needed to build the index (more might be used if you have more)
2025-03-09 09:06:51,702 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0001 secs
2025-03-09 09:06:51,703 [INFO]: 	Selecting most promising index types given data characteristics 03/09/2025, 09:06:51
2025-03-09 09:06:51,703 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-09 09:06:51,703 [INFO]: 	Creating the index 03/09/2025, 09:06:51
2025-03-09 09:06:51,703 [INFO]: 		-> Instanciate the index HNSW15 03/09/2025, 09:06:51
2025-03-09 09:06:51,704 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0009 secs
2025-03-09 09:06:51,704 [INFO]: 		-> Adding the vectors to the index 03/09/2025, 09:06:51
2025-03-09 09:06:51,704 [INFO]: The memory available for adding the vectors is 49.2GB(total available - used by the index)
2025-03-09 09:06:51,704 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/18 [00:00<?, ?it/s]  6%|▌         | 1/18 [00:00<00:02,  8.11it/s] 39%|███▉      | 7/18 [00:00<00:00, 33.14it/s] 72%|███████▏  | 13/18 [00:00<00:00, 41.44it/s]100%|██████████| 18/18 [00:03<00:00,  4.02it/s]100%|██████████| 18/18 [00:03<00:00,  5.48it/s]
2025-03-09 09:06:54,990 [INFO]: 	Computing best hyperparameters for index knn.index 03/09/2025, 09:06:54
2025-03-09 09:07:39,572 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 44.5815 secs
2025-03-09 09:07:39,573 [INFO]: The best hyperparameters are: efSearch=259
2025-03-09 09:07:39,573 [INFO]: 	Compute fast metrics 03/09/2025, 09:07:39
  0%|          | 0/4 [00:00<?, ?it/s] 50%|█████     | 2/4 [00:00<00:00, 19.37it/s] 75%|███████▌  | 3/4 [00:00<00:00, 20.91it/s]
2025-03-09 09:07:54,309 [INFO]: 	>>> Finished "Compute fast metrics" in 14.7362 secs
2025-03-09 09:07:54,311 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 62.6076 secs
2025-03-09 09:07:54,312 [INFO]: {
2025-03-09 09:07:54,312 [INFO]: 	index_key: HNSW15
2025-03-09 09:07:54,312 [INFO]: 	index_param: efSearch=259
2025-03-09 09:07:54,312 [INFO]: 	index_path: knn.index
2025-03-09 09:07:54,312 [INFO]: 	size in bytes: 864886690
2025-03-09 09:07:54,312 [INFO]: 	avg_search_speed_ms: 9.810198247396151
2025-03-09 09:07:54,312 [INFO]: 	99p_search_speed_ms: 15.728923818096515
2025-03-09 09:07:54,312 [INFO]: 	reconstruction error %: 0.0
2025-03-09 09:07:54,312 [INFO]: 	nb vectors: 4396
2025-03-09 09:07:54,312 [INFO]: 	vectors dimension: 49152
2025-03-09 09:07:54,312 [INFO]: 	compression ratio: 0.9993086701334252
2025-03-09 09:07:54,312 [INFO]: }
2025-03-09 09:07:54,312 [INFO]: 	>>> Finished "Creating the index" in 62.6090 secs
2025-03-09 09:07:54,312 [INFO]: >>> Finished "Launching the whole pipeline" in 62.6391 secs
2025-03-09 09:07:56: [retrieval_preprocessing] calculating distances ...
2025-03-09 09:07:57: [retrieval_preprocessing] finished and saved retrieval indices for episode 28051 [episode count 11/20]
[retrieval_preprocessing] for episode 88596 [episode count 12/20], we have num_retrieval=np.int64(4440) num_query=np.int64(271)
2025-03-09 09:07:57,695 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-09 09:07:58,181 [INFO]: Launching the whole pipeline 03/09/2025, 09:07:58
2025-03-09 09:07:58,181 [INFO]: Reading total number of vectors and dimension 03/09/2025, 09:07:58
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1526.31it/s]
2025-03-09 09:07:58,211 [INFO]: There are 4440 embeddings of dim 49152
2025-03-09 09:07:58,212 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0308 secs
2025-03-09 09:07:58,212 [INFO]: 	Compute estimated construction time of the index 03/09/2025, 09:07:58
2025-03-09 09:07:58,212 [INFO]: 		-> Train: 16.7 minutes
2025-03-09 09:07:58,212 [INFO]: 		-> Add: 2.4 seconds
2025-03-09 09:07:58,212 [INFO]: 		Total: 16.7 minutes
2025-03-09 09:07:58,212 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0003 secs
2025-03-09 09:07:58,212 [INFO]: 	Checking that your have enough memory available to create the index 03/09/2025, 09:07:58
2025-03-09 09:07:58,213 [INFO]: 916.3MB of memory will be needed to build the index (more might be used if you have more)
2025-03-09 09:07:58,213 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0004 secs
2025-03-09 09:07:58,213 [INFO]: 	Selecting most promising index types given data characteristics 03/09/2025, 09:07:58
2025-03-09 09:07:58,213 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-09 09:07:58,213 [INFO]: 	Creating the index 03/09/2025, 09:07:58
2025-03-09 09:07:58,213 [INFO]: 		-> Instanciate the index HNSW15 03/09/2025, 09:07:58
2025-03-09 09:07:58,216 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0028 secs
2025-03-09 09:07:58,217 [INFO]: 		-> Adding the vectors to the index 03/09/2025, 09:07:58
2025-03-09 09:07:58,217 [INFO]: The memory available for adding the vectors is 49.2GB(total available - used by the index)
2025-03-09 09:07:58,217 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/18 [00:00<?, ?it/s] 17%|█▋        | 3/18 [00:00<00:00, 26.92it/s] 50%|█████     | 9/18 [00:00<00:00, 44.89it/s] 83%|████████▎ | 15/18 [00:00<00:00, 51.08it/s]100%|██████████| 18/18 [00:03<00:00,  5.76it/s]
2025-03-09 09:08:01,346 [INFO]: 	Computing best hyperparameters for index knn.index 03/09/2025, 09:08:01
2025-03-09 09:08:43,774 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 42.4284 secs
2025-03-09 09:08:43,775 [INFO]: The best hyperparameters are: efSearch=289
2025-03-09 09:08:43,775 [INFO]: 	Compute fast metrics 03/09/2025, 09:08:43
  0%|          | 0/4 [00:00<?, ?it/s] 75%|███████▌  | 3/4 [00:00<00:00, 26.84it/s] 75%|███████▌  | 3/4 [00:00<00:00, 22.86it/s]
2025-03-09 09:09:04,889 [INFO]: 	>>> Finished "Compute fast metrics" in 21.1146 secs
2025-03-09 09:09:04,892 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 66.6755 secs
2025-03-09 09:09:04,892 [INFO]: {
2025-03-09 09:09:04,892 [INFO]: 	index_key: HNSW15
2025-03-09 09:09:04,892 [INFO]: 	index_param: efSearch=289
2025-03-09 09:09:04,892 [INFO]: 	index_path: knn.index
2025-03-09 09:09:04,892 [INFO]: 	size in bytes: 873543490
2025-03-09 09:09:04,892 [INFO]: 	avg_search_speed_ms: 11.262571224407923
2025-03-09 09:09:04,892 [INFO]: 	99p_search_speed_ms: 25.92177958227694
2025-03-09 09:09:04,892 [INFO]: 	reconstruction error %: 0.0
2025-03-09 09:09:04,892 [INFO]: 	nb vectors: 4440
2025-03-09 09:09:04,892 [INFO]: 	vectors dimension: 49152
2025-03-09 09:09:04,892 [INFO]: 	compression ratio: 0.9993085976749709
2025-03-09 09:09:04,892 [INFO]: }
2025-03-09 09:09:04,892 [INFO]: 	>>> Finished "Creating the index" in 66.6792 secs
2025-03-09 09:09:04,893 [INFO]: >>> Finished "Launching the whole pipeline" in 66.7115 secs
2025-03-09 09:09:07: [retrieval_preprocessing] calculating distances ...
2025-03-09 09:09:08: [retrieval_preprocessing] finished and saved retrieval indices for episode 88596 [episode count 12/20]
[retrieval_preprocessing] for episode 21534 [episode count 13/20], we have num_retrieval=np.int64(4553) num_query=np.int64(158)
2025-03-09 09:09:08,690 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-09 09:09:09,410 [INFO]: Launching the whole pipeline 03/09/2025, 09:09:09
2025-03-09 09:09:09,410 [INFO]: Reading total number of vectors and dimension 03/09/2025, 09:09:09
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 2114.06it/s]
2025-03-09 09:09:09,438 [INFO]: There are 4553 embeddings of dim 49152
2025-03-09 09:09:09,438 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0278 secs
2025-03-09 09:09:09,438 [INFO]: 	Compute estimated construction time of the index 03/09/2025, 09:09:09
2025-03-09 09:09:09,438 [INFO]: 		-> Train: 16.7 minutes
2025-03-09 09:09:09,438 [INFO]: 		-> Add: 2.5 seconds
2025-03-09 09:09:09,438 [INFO]: 		Total: 16.7 minutes
2025-03-09 09:09:09,438 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0001 secs
2025-03-09 09:09:09,438 [INFO]: 	Checking that your have enough memory available to create the index 03/09/2025, 09:09:09
2025-03-09 09:09:09,439 [INFO]: 939.6MB of memory will be needed to build the index (more might be used if you have more)
2025-03-09 09:09:09,439 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0002 secs
2025-03-09 09:09:09,439 [INFO]: 	Selecting most promising index types given data characteristics 03/09/2025, 09:09:09
2025-03-09 09:09:09,439 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-09 09:09:09,439 [INFO]: 	Creating the index 03/09/2025, 09:09:09
2025-03-09 09:09:09,439 [INFO]: 		-> Instanciate the index HNSW15 03/09/2025, 09:09:09
2025-03-09 09:09:09,440 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0010 secs
2025-03-09 09:09:09,440 [INFO]: 		-> Adding the vectors to the index 03/09/2025, 09:09:09
2025-03-09 09:09:09,440 [INFO]: The memory available for adding the vectors is 49.2GB(total available - used by the index)
2025-03-09 09:09:09,440 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/18 [00:00<?, ?it/s]  6%|▌         | 1/18 [00:00<00:01,  9.10it/s] 39%|███▉      | 7/18 [00:00<00:00, 34.15it/s] 72%|███████▏  | 13/18 [00:00<00:00, 41.67it/s]100%|██████████| 18/18 [00:03<00:00,  3.70it/s]100%|██████████| 18/18 [00:03<00:00,  5.07it/s]
2025-03-09 09:09:12,992 [INFO]: 	Computing best hyperparameters for index knn.index 03/09/2025, 09:09:12
2025-03-09 09:09:57,571 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 44.5791 secs
2025-03-09 09:09:57,572 [INFO]: The best hyperparameters are: efSearch=268
2025-03-09 09:09:57,572 [INFO]: 	Compute fast metrics 03/09/2025, 09:09:57
  0%|          | 0/4 [00:00<?, ?it/s] 50%|█████     | 2/4 [00:00<00:00, 19.99it/s] 75%|███████▌  | 3/4 [00:00<00:00, 21.42it/s]
2025-03-09 09:10:15,046 [INFO]: 	>>> Finished "Compute fast metrics" in 17.4740 secs
2025-03-09 09:10:15,048 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 65.6081 secs
2025-03-09 09:10:15,048 [INFO]: {
2025-03-09 09:10:15,048 [INFO]: 	index_key: HNSW15
2025-03-09 09:10:15,048 [INFO]: 	index_param: efSearch=268
2025-03-09 09:10:15,049 [INFO]: 	index_path: knn.index
2025-03-09 09:10:15,049 [INFO]: 	size in bytes: 895775410
2025-03-09 09:10:15,049 [INFO]: 	avg_search_speed_ms: 9.742766240492086
2025-03-09 09:10:15,049 [INFO]: 	99p_search_speed_ms: 20.83668755134568
2025-03-09 09:10:15,049 [INFO]: 	reconstruction error %: 0.0
2025-03-09 09:10:15,049 [INFO]: 	nb vectors: 4553
2025-03-09 09:10:15,049 [INFO]: 	vectors dimension: 49152
2025-03-09 09:10:15,049 [INFO]: 	compression ratio: 0.9993087709340001
2025-03-09 09:10:15,049 [INFO]: }
2025-03-09 09:10:15,049 [INFO]: 	>>> Finished "Creating the index" in 65.6098 secs
2025-03-09 09:10:15,049 [INFO]: >>> Finished "Launching the whole pipeline" in 65.6385 secs
2025-03-09 09:10:16: [retrieval_preprocessing] calculating distances ...
2025-03-09 09:10:17: [retrieval_preprocessing] finished and saved retrieval indices for episode 21534 [episode count 13/20]
[retrieval_preprocessing] for episode 1950 [episode count 14/20], we have num_retrieval=np.int64(4468) num_query=np.int64(243)
2025-03-09 09:10:17,515 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-09 09:10:18,446 [INFO]: Launching the whole pipeline 03/09/2025, 09:10:18
2025-03-09 09:10:18,446 [INFO]: Reading total number of vectors and dimension 03/09/2025, 09:10:18
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1565.62it/s]
2025-03-09 09:10:18,495 [INFO]: There are 4468 embeddings of dim 49152
2025-03-09 09:10:18,495 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0490 secs
2025-03-09 09:10:18,496 [INFO]: 	Compute estimated construction time of the index 03/09/2025, 09:10:18
2025-03-09 09:10:18,496 [INFO]: 		-> Train: 16.7 minutes
2025-03-09 09:10:18,496 [INFO]: 		-> Add: 2.5 seconds
2025-03-09 09:10:18,496 [INFO]: 		Total: 16.7 minutes
2025-03-09 09:10:18,496 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0004 secs
2025-03-09 09:10:18,496 [INFO]: 	Checking that your have enough memory available to create the index 03/09/2025, 09:10:18
2025-03-09 09:10:18,497 [INFO]: 922.1MB of memory will be needed to build the index (more might be used if you have more)
2025-03-09 09:10:18,497 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0004 secs
2025-03-09 09:10:18,497 [INFO]: 	Selecting most promising index types given data characteristics 03/09/2025, 09:10:18
2025-03-09 09:10:18,497 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-09 09:10:18,497 [INFO]: 	Creating the index 03/09/2025, 09:10:18
2025-03-09 09:10:18,497 [INFO]: 		-> Instanciate the index HNSW15 03/09/2025, 09:10:18
2025-03-09 09:10:18,500 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0022 secs
2025-03-09 09:10:18,500 [INFO]: 		-> Adding the vectors to the index 03/09/2025, 09:10:18
2025-03-09 09:10:18,501 [INFO]: The memory available for adding the vectors is 49.2GB(total available - used by the index)
2025-03-09 09:10:18,501 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/18 [00:00<?, ?it/s]  6%|▌         | 1/18 [00:00<00:02,  8.09it/s] 22%|██▏       | 4/18 [00:00<00:00, 17.53it/s] 44%|████▍     | 8/18 [00:00<00:00, 25.88it/s] 67%|██████▋   | 12/18 [00:00<00:00, 30.21it/s] 89%|████████▉ | 16/18 [00:00<00:00, 33.24it/s]100%|██████████| 18/18 [00:04<00:00,  4.29it/s]
2025-03-09 09:10:22,699 [INFO]: 	Computing best hyperparameters for index knn.index 03/09/2025, 09:10:22
2025-03-09 09:11:03,731 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 41.0319 secs
2025-03-09 09:11:03,732 [INFO]: The best hyperparameters are: efSearch=298
2025-03-09 09:11:03,732 [INFO]: 	Compute fast metrics 03/09/2025, 09:11:03
  0%|          | 0/4 [00:00<?, ?it/s] 50%|█████     | 2/4 [00:00<00:00, 17.47it/s] 75%|███████▌  | 3/4 [00:00<00:00, 18.61it/s]
2025-03-09 09:11:20,356 [INFO]: 	>>> Finished "Compute fast metrics" in 16.6245 secs
2025-03-09 09:11:20,359 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 61.8587 secs
2025-03-09 09:11:20,359 [INFO]: {
2025-03-09 09:11:20,359 [INFO]: 	index_key: HNSW15
2025-03-09 09:11:20,359 [INFO]: 	index_param: efSearch=298
2025-03-09 09:11:20,359 [INFO]: 	index_path: knn.index
2025-03-09 09:11:20,359 [INFO]: 	size in bytes: 879052270
2025-03-09 09:11:20,359 [INFO]: 	avg_search_speed_ms: 10.432263330301042
2025-03-09 09:11:20,360 [INFO]: 	99p_search_speed_ms: 18.81104256492106
2025-03-09 09:11:20,360 [INFO]: 	reconstruction error %: 0.0
2025-03-09 09:11:20,360 [INFO]: 	nb vectors: 4468
2025-03-09 09:11:20,360 [INFO]: 	vectors dimension: 49152
2025-03-09 09:11:20,360 [INFO]: 	compression ratio: 0.9993086577206609
2025-03-09 09:11:20,360 [INFO]: }
2025-03-09 09:11:20,360 [INFO]: 	>>> Finished "Creating the index" in 61.8623 secs
2025-03-09 09:11:20,360 [INFO]: >>> Finished "Launching the whole pipeline" in 61.9134 secs
2025-03-09 09:11:22: [retrieval_preprocessing] calculating distances ...
2025-03-09 09:11:23: [retrieval_preprocessing] finished and saved retrieval indices for episode 1950 [episode count 14/20]
[retrieval_preprocessing] for episode 60575 [episode count 15/20], we have num_retrieval=np.int64(4418) num_query=np.int64(293)
2025-03-09 09:11:24,100 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-09 09:11:24,821 [INFO]: Launching the whole pipeline 03/09/2025, 09:11:24
2025-03-09 09:11:24,821 [INFO]: Reading total number of vectors and dimension 03/09/2025, 09:11:24
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 2042.02it/s]
2025-03-09 09:11:24,851 [INFO]: There are 4418 embeddings of dim 49152
2025-03-09 09:11:24,851 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0294 secs
2025-03-09 09:11:24,851 [INFO]: 	Compute estimated construction time of the index 03/09/2025, 09:11:24
2025-03-09 09:11:24,851 [INFO]: 		-> Train: 16.7 minutes
2025-03-09 09:11:24,851 [INFO]: 		-> Add: 2.4 seconds
2025-03-09 09:11:24,851 [INFO]: 		Total: 16.7 minutes
2025-03-09 09:11:24,851 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0001 secs
2025-03-09 09:11:24,851 [INFO]: 	Checking that your have enough memory available to create the index 03/09/2025, 09:11:24
2025-03-09 09:11:24,851 [INFO]: 911.8MB of memory will be needed to build the index (more might be used if you have more)
2025-03-09 09:11:24,851 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0002 secs
2025-03-09 09:11:24,851 [INFO]: 	Selecting most promising index types given data characteristics 03/09/2025, 09:11:24
2025-03-09 09:11:24,851 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-09 09:11:24,851 [INFO]: 	Creating the index 03/09/2025, 09:11:24
2025-03-09 09:11:24,851 [INFO]: 		-> Instanciate the index HNSW15 03/09/2025, 09:11:24
2025-03-09 09:11:24,853 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0011 secs
2025-03-09 09:11:24,853 [INFO]: 		-> Adding the vectors to the index 03/09/2025, 09:11:24
2025-03-09 09:11:24,853 [INFO]: The memory available for adding the vectors is 49.2GB(total available - used by the index)
2025-03-09 09:11:24,853 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/18 [00:00<?, ?it/s]  6%|▌         | 1/18 [00:00<00:01,  8.71it/s] 39%|███▉      | 7/18 [00:00<00:00, 34.17it/s] 72%|███████▏  | 13/18 [00:00<00:00, 41.66it/s]100%|██████████| 18/18 [00:03<00:00,  3.60it/s]100%|██████████| 18/18 [00:03<00:00,  4.94it/s]
2025-03-09 09:11:28,500 [INFO]: 	Computing best hyperparameters for index knn.index 03/09/2025, 09:11:28
2025-03-09 09:12:11,434 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 42.9336 secs
2025-03-09 09:12:11,434 [INFO]: The best hyperparameters are: efSearch=275
2025-03-09 09:12:11,434 [INFO]: 	Compute fast metrics 03/09/2025, 09:12:11
  0%|          | 0/4 [00:00<?, ?it/s] 50%|█████     | 2/4 [00:00<00:00, 19.24it/s] 75%|███████▌  | 3/4 [00:00<00:00, 20.70it/s]
2025-03-09 09:12:27,390 [INFO]: 	>>> Finished "Compute fast metrics" in 15.9559 secs
2025-03-09 09:12:27,393 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 62.5401 secs
2025-03-09 09:12:27,393 [INFO]: {
2025-03-09 09:12:27,393 [INFO]: 	index_key: HNSW15
2025-03-09 09:12:27,393 [INFO]: 	index_param: efSearch=275
2025-03-09 09:12:27,393 [INFO]: 	index_path: knn.index
2025-03-09 09:12:27,393 [INFO]: 	size in bytes: 869215150
2025-03-09 09:12:27,393 [INFO]: 	avg_search_speed_ms: 9.98832453386514
2025-03-09 09:12:27,393 [INFO]: 	99p_search_speed_ms: 16.642858972772956
2025-03-09 09:12:27,393 [INFO]: 	reconstruction error %: 0.0
2025-03-09 09:12:27,393 [INFO]: 	nb vectors: 4418
2025-03-09 09:12:27,393 [INFO]: 	vectors dimension: 49152
2025-03-09 09:12:27,393 [INFO]: 	compression ratio: 0.9993085647437231
2025-03-09 09:12:27,393 [INFO]: }
2025-03-09 09:12:27,393 [INFO]: 	>>> Finished "Creating the index" in 62.5418 secs
2025-03-09 09:12:27,393 [INFO]: >>> Finished "Launching the whole pipeline" in 62.5721 secs
2025-03-09 09:12:29: [retrieval_preprocessing] calculating distances ...
2025-03-09 09:12:31: [retrieval_preprocessing] finished and saved retrieval indices for episode 60575 [episode count 15/20]
[retrieval_preprocessing] for episode 62750 [episode count 16/20], we have num_retrieval=np.int64(4434) num_query=np.int64(277)
2025-03-09 09:12:31,708 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-09 09:12:32,398 [INFO]: Launching the whole pipeline 03/09/2025, 09:12:32
2025-03-09 09:12:32,399 [INFO]: Reading total number of vectors and dimension 03/09/2025, 09:12:32
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1681.08it/s]
2025-03-09 09:12:32,431 [INFO]: There are 4434 embeddings of dim 49152
2025-03-09 09:12:32,431 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0325 secs
2025-03-09 09:12:32,431 [INFO]: 	Compute estimated construction time of the index 03/09/2025, 09:12:32
2025-03-09 09:12:32,431 [INFO]: 		-> Train: 16.7 minutes
2025-03-09 09:12:32,431 [INFO]: 		-> Add: 2.4 seconds
2025-03-09 09:12:32,431 [INFO]: 		Total: 16.7 minutes
2025-03-09 09:12:32,431 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0001 secs
2025-03-09 09:12:32,431 [INFO]: 	Checking that your have enough memory available to create the index 03/09/2025, 09:12:32
2025-03-09 09:12:32,432 [INFO]: 915.1MB of memory will be needed to build the index (more might be used if you have more)
2025-03-09 09:12:32,432 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0002 secs
2025-03-09 09:12:32,432 [INFO]: 	Selecting most promising index types given data characteristics 03/09/2025, 09:12:32
2025-03-09 09:12:32,432 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-09 09:12:32,432 [INFO]: 	Creating the index 03/09/2025, 09:12:32
2025-03-09 09:12:32,432 [INFO]: 		-> Instanciate the index HNSW15 03/09/2025, 09:12:32
2025-03-09 09:12:32,433 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0012 secs
2025-03-09 09:12:32,433 [INFO]: 		-> Adding the vectors to the index 03/09/2025, 09:12:32
2025-03-09 09:12:32,433 [INFO]: The memory available for adding the vectors is 49.2GB(total available - used by the index)
2025-03-09 09:12:32,433 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/18 [00:00<?, ?it/s]  6%|▌         | 1/18 [00:00<00:02,  6.23it/s] 28%|██▊       | 5/18 [00:00<00:00, 21.60it/s] 56%|█████▌    | 10/18 [00:00<00:00, 31.93it/s] 89%|████████▉ | 16/18 [00:00<00:00, 39.22it/s]100%|██████████| 18/18 [00:03<00:00,  4.91it/s]
2025-03-09 09:12:36,103 [INFO]: 	Computing best hyperparameters for index knn.index 03/09/2025, 09:12:36
2025-03-09 09:13:22,654 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 46.5511 secs
2025-03-09 09:13:22,655 [INFO]: The best hyperparameters are: efSearch=265
2025-03-09 09:13:22,655 [INFO]: 	Compute fast metrics 03/09/2025, 09:13:22
  0%|          | 0/4 [00:00<?, ?it/s] 50%|█████     | 2/4 [00:00<00:00, 19.31it/s] 75%|███████▌  | 3/4 [00:00<00:00, 21.15it/s]
2025-03-09 09:13:40,940 [INFO]: 	>>> Finished "Compute fast metrics" in 18.2856 secs
2025-03-09 09:13:40,944 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 68.5113 secs
2025-03-09 09:13:40,945 [INFO]: {
2025-03-09 09:13:40,945 [INFO]: 	index_key: HNSW15
2025-03-09 09:13:40,945 [INFO]: 	index_param: efSearch=265
2025-03-09 09:13:40,945 [INFO]: 	index_path: knn.index
2025-03-09 09:13:40,945 [INFO]: 	size in bytes: 872362990
2025-03-09 09:13:40,945 [INFO]: 	avg_search_speed_ms: 9.34165213226639
2025-03-09 09:13:40,945 [INFO]: 	99p_search_speed_ms: 17.862988868728262
2025-03-09 09:13:40,945 [INFO]: 	reconstruction error %: 0.0
2025-03-09 09:13:40,945 [INFO]: 	nb vectors: 4434
2025-03-09 09:13:40,945 [INFO]: 	vectors dimension: 49152
2025-03-09 09:13:40,945 [INFO]: 	compression ratio: 0.999308638712424
2025-03-09 09:13:40,945 [INFO]: }
2025-03-09 09:13:40,945 [INFO]: 	>>> Finished "Creating the index" in 68.5129 secs
2025-03-09 09:13:40,945 [INFO]: >>> Finished "Launching the whole pipeline" in 68.5462 secs
2025-03-09 09:13:43: [retrieval_preprocessing] calculating distances ...
2025-03-09 09:13:43: [retrieval_preprocessing] finished and saved retrieval indices for episode 62750 [episode count 16/20]
[retrieval_preprocessing] for episode 33827 [episode count 17/20], we have num_retrieval=np.int64(4324) num_query=np.int64(387)
2025-03-09 09:13:44,393 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-09 09:13:44,933 [INFO]: Launching the whole pipeline 03/09/2025, 09:13:44
2025-03-09 09:13:44,933 [INFO]: Reading total number of vectors and dimension 03/09/2025, 09:13:44
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1501.18it/s]
2025-03-09 09:13:44,963 [INFO]: There are 4324 embeddings of dim 49152
2025-03-09 09:13:44,963 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0297 secs
2025-03-09 09:13:44,963 [INFO]: 	Compute estimated construction time of the index 03/09/2025, 09:13:44
2025-03-09 09:13:44,963 [INFO]: 		-> Train: 16.7 minutes
2025-03-09 09:13:44,963 [INFO]: 		-> Add: 2.4 seconds
2025-03-09 09:13:44,963 [INFO]: 		Total: 16.7 minutes
2025-03-09 09:13:44,963 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0001 secs
2025-03-09 09:13:44,963 [INFO]: 	Checking that your have enough memory available to create the index 03/09/2025, 09:13:44
2025-03-09 09:13:44,963 [INFO]: 892.4MB of memory will be needed to build the index (more might be used if you have more)
2025-03-09 09:13:44,963 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0001 secs
2025-03-09 09:13:44,963 [INFO]: 	Selecting most promising index types given data characteristics 03/09/2025, 09:13:44
2025-03-09 09:13:44,963 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-09 09:13:44,963 [INFO]: 	Creating the index 03/09/2025, 09:13:44
2025-03-09 09:13:44,963 [INFO]: 		-> Instanciate the index HNSW15 03/09/2025, 09:13:44
2025-03-09 09:13:44,964 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0009 secs
2025-03-09 09:13:44,964 [INFO]: 		-> Adding the vectors to the index 03/09/2025, 09:13:44
2025-03-09 09:13:44,964 [INFO]: The memory available for adding the vectors is 49.2GB(total available - used by the index)
2025-03-09 09:13:44,964 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/18 [00:00<?, ?it/s] 11%|█         | 2/18 [00:00<00:00, 17.11it/s] 44%|████▍     | 8/18 [00:00<00:00, 37.57it/s] 67%|██████▋   | 12/18 [00:00<00:00, 28.25it/s] 89%|████████▉ | 16/18 [00:00<00:00, 30.86it/s]100%|██████████| 18/18 [00:03<00:00,  5.03it/s]
2025-03-09 09:13:48,546 [INFO]: 	Computing best hyperparameters for index knn.index 03/09/2025, 09:13:48
2025-03-09 09:14:33,881 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 45.3346 secs
2025-03-09 09:14:33,881 [INFO]: The best hyperparameters are: efSearch=259
2025-03-09 09:14:33,881 [INFO]: 	Compute fast metrics 03/09/2025, 09:14:33
  0%|          | 0/4 [00:00<?, ?it/s] 25%|██▌       | 1/4 [00:00<00:00,  9.86it/s] 75%|███████▌  | 3/4 [00:00<00:00, 18.70it/s]
2025-03-09 09:14:54,700 [INFO]: 	>>> Finished "Compute fast metrics" in 20.8184 secs
2025-03-09 09:14:54,702 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 69.7375 secs
2025-03-09 09:14:54,702 [INFO]: {
2025-03-09 09:14:54,702 [INFO]: 	index_key: HNSW15
2025-03-09 09:14:54,702 [INFO]: 	index_param: efSearch=259
2025-03-09 09:14:54,702 [INFO]: 	index_path: knn.index
2025-03-09 09:14:54,702 [INFO]: 	size in bytes: 850721170
2025-03-09 09:14:54,702 [INFO]: 	avg_search_speed_ms: 10.074919562604867
2025-03-09 09:14:54,702 [INFO]: 	99p_search_speed_ms: 21.793997660279285
2025-03-09 09:14:54,702 [INFO]: 	reconstruction error %: 0.0
2025-03-09 09:14:54,702 [INFO]: 	nb vectors: 4324
2025-03-09 09:14:54,702 [INFO]: 	vectors dimension: 49152
2025-03-09 09:14:54,702 [INFO]: 	compression ratio: 0.9993086124799269
2025-03-09 09:14:54,702 [INFO]: }
2025-03-09 09:14:54,702 [INFO]: 	>>> Finished "Creating the index" in 69.7388 secs
2025-03-09 09:14:54,702 [INFO]: >>> Finished "Launching the whole pipeline" in 69.7692 secs
2025-03-09 09:14:57: [retrieval_preprocessing] calculating distances ...
2025-03-09 09:14:58: [retrieval_preprocessing] finished and saved retrieval indices for episode 33827 [episode count 17/20]
[retrieval_preprocessing] for episode 24228 [episode count 18/20], we have num_retrieval=np.int64(4414) num_query=np.int64(297)
2025-03-09 09:14:58,674 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-09 09:14:59,262 [INFO]: Launching the whole pipeline 03/09/2025, 09:14:59
2025-03-09 09:14:59,262 [INFO]: Reading total number of vectors and dimension 03/09/2025, 09:14:59
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1362.23it/s]
2025-03-09 09:14:59,293 [INFO]: There are 4414 embeddings of dim 49152
2025-03-09 09:14:59,293 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0310 secs
2025-03-09 09:14:59,293 [INFO]: 	Compute estimated construction time of the index 03/09/2025, 09:14:59
2025-03-09 09:14:59,293 [INFO]: 		-> Train: 16.7 minutes
2025-03-09 09:14:59,293 [INFO]: 		-> Add: 2.4 seconds
2025-03-09 09:14:59,293 [INFO]: 		Total: 16.7 minutes
2025-03-09 09:14:59,293 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0001 secs
2025-03-09 09:14:59,293 [INFO]: 	Checking that your have enough memory available to create the index 03/09/2025, 09:14:59
2025-03-09 09:14:59,293 [INFO]: 910.9MB of memory will be needed to build the index (more might be used if you have more)
2025-03-09 09:14:59,293 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0002 secs
2025-03-09 09:14:59,293 [INFO]: 	Selecting most promising index types given data characteristics 03/09/2025, 09:14:59
2025-03-09 09:14:59,293 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-09 09:14:59,294 [INFO]: 	Creating the index 03/09/2025, 09:14:59
2025-03-09 09:14:59,294 [INFO]: 		-> Instanciate the index HNSW15 03/09/2025, 09:14:59
2025-03-09 09:14:59,295 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0010 secs
2025-03-09 09:14:59,295 [INFO]: 		-> Adding the vectors to the index 03/09/2025, 09:14:59
2025-03-09 09:14:59,295 [INFO]: The memory available for adding the vectors is 49.2GB(total available - used by the index)
2025-03-09 09:14:59,295 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/18 [00:00<?, ?it/s]  6%|▌         | 1/18 [00:00<00:02,  7.87it/s] 39%|███▉      | 7/18 [00:00<00:00, 33.25it/s] 72%|███████▏  | 13/18 [00:00<00:00, 42.67it/s]100%|██████████| 18/18 [00:03<00:00,  4.16it/s]100%|██████████| 18/18 [00:03<00:00,  5.66it/s]
2025-03-09 09:15:02,476 [INFO]: 	Computing best hyperparameters for index knn.index 03/09/2025, 09:15:02
2025-03-09 09:15:45,273 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 42.7962 secs
2025-03-09 09:15:45,273 [INFO]: The best hyperparameters are: efSearch=270
2025-03-09 09:15:45,273 [INFO]: 	Compute fast metrics 03/09/2025, 09:15:45
  0%|          | 0/4 [00:00<?, ?it/s] 50%|█████     | 2/4 [00:00<00:00, 17.75it/s] 75%|███████▌  | 3/4 [00:00<00:00, 19.23it/s]
2025-03-09 09:16:01,321 [INFO]: 	>>> Finished "Compute fast metrics" in 16.0480 secs
2025-03-09 09:16:01,326 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 62.0309 secs
2025-03-09 09:16:01,326 [INFO]: {
2025-03-09 09:16:01,326 [INFO]: 	index_key: HNSW15
2025-03-09 09:16:01,326 [INFO]: 	index_param: efSearch=270
2025-03-09 09:16:01,326 [INFO]: 	index_path: knn.index
2025-03-09 09:16:01,326 [INFO]: 	size in bytes: 868428190
2025-03-09 09:16:01,326 [INFO]: 	avg_search_speed_ms: 9.629801466982162
2025-03-09 09:16:01,326 [INFO]: 	99p_search_speed_ms: 18.32905539777124
2025-03-09 09:16:01,326 [INFO]: 	reconstruction error %: 0.0
2025-03-09 09:16:01,326 [INFO]: 	nb vectors: 4414
2025-03-09 09:16:01,326 [INFO]: 	vectors dimension: 49152
2025-03-09 09:16:01,326 [INFO]: 	compression ratio: 0.9993085461677609
2025-03-09 09:16:01,326 [INFO]: }
2025-03-09 09:16:01,326 [INFO]: 	>>> Finished "Creating the index" in 62.0328 secs
2025-03-09 09:16:01,326 [INFO]: >>> Finished "Launching the whole pipeline" in 62.0644 secs
2025-03-09 09:16:03: [retrieval_preprocessing] calculating distances ...
2025-03-09 09:16:04: [retrieval_preprocessing] finished and saved retrieval indices for episode 24228 [episode count 18/20]
[retrieval_preprocessing] for episode 40741 [episode count 19/20], we have num_retrieval=np.int64(4576) num_query=np.int64(135)
2025-03-09 09:16:04,754 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-09 09:16:05,306 [INFO]: Launching the whole pipeline 03/09/2025, 09:16:05
2025-03-09 09:16:05,306 [INFO]: Reading total number of vectors and dimension 03/09/2025, 09:16:05
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 2149.82it/s]
2025-03-09 09:16:05,339 [INFO]: There are 4576 embeddings of dim 49152
2025-03-09 09:16:05,339 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0335 secs
2025-03-09 09:16:05,339 [INFO]: 	Compute estimated construction time of the index 03/09/2025, 09:16:05
2025-03-09 09:16:05,339 [INFO]: 		-> Train: 16.7 minutes
2025-03-09 09:16:05,340 [INFO]: 		-> Add: 2.5 seconds
2025-03-09 09:16:05,340 [INFO]: 		Total: 16.7 minutes
2025-03-09 09:16:05,340 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0004 secs
2025-03-09 09:16:05,340 [INFO]: 	Checking that your have enough memory available to create the index 03/09/2025, 09:16:05
2025-03-09 09:16:05,340 [INFO]: 944.4MB of memory will be needed to build the index (more might be used if you have more)
2025-03-09 09:16:05,340 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0005 secs
2025-03-09 09:16:05,341 [INFO]: 	Selecting most promising index types given data characteristics 03/09/2025, 09:16:05
2025-03-09 09:16:05,341 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-09 09:16:05,341 [INFO]: 	Creating the index 03/09/2025, 09:16:05
2025-03-09 09:16:05,341 [INFO]: 		-> Instanciate the index HNSW15 03/09/2025, 09:16:05
2025-03-09 09:16:05,344 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0026 secs
2025-03-09 09:16:05,344 [INFO]: 		-> Adding the vectors to the index 03/09/2025, 09:16:05
2025-03-09 09:16:05,344 [INFO]: The memory available for adding the vectors is 49.2GB(total available - used by the index)
2025-03-09 09:16:05,344 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/19 [00:00<?, ?it/s] 11%|█         | 2/19 [00:00<00:00, 17.69it/s] 42%|████▏     | 8/19 [00:00<00:00, 40.95it/s] 79%|███████▉  | 15/19 [00:00<00:00, 50.16it/s]100%|██████████| 19/19 [00:03<00:00,  5.77it/s]
2025-03-09 09:16:08,641 [INFO]: 	Computing best hyperparameters for index knn.index 03/09/2025, 09:16:08
2025-03-09 09:16:55,187 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 46.5458 secs
2025-03-09 09:16:55,188 [INFO]: The best hyperparameters are: efSearch=252
2025-03-09 09:16:55,188 [INFO]: 	Compute fast metrics 03/09/2025, 09:16:55
  0%|          | 0/4 [00:00<?, ?it/s] 75%|███████▌  | 3/4 [00:00<00:00, 25.67it/s] 75%|███████▌  | 3/4 [00:00<00:00, 22.12it/s]
2025-03-09 09:17:16,908 [INFO]: 	>>> Finished "Compute fast metrics" in 21.7204 secs
2025-03-09 09:17:16,910 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 71.5663 secs
2025-03-09 09:17:16,910 [INFO]: {
2025-03-09 09:17:16,910 [INFO]: 	index_key: HNSW15
2025-03-09 09:17:16,910 [INFO]: 	index_param: efSearch=252
2025-03-09 09:17:16,910 [INFO]: 	index_path: knn.index
2025-03-09 09:17:16,911 [INFO]: 	size in bytes: 900300550
2025-03-09 09:17:16,911 [INFO]: 	avg_search_speed_ms: 8.090025848372987
2025-03-09 09:17:16,911 [INFO]: 	99p_search_speed_ms: 13.265613804105689
2025-03-09 09:17:16,911 [INFO]: 	reconstruction error %: 0.0
2025-03-09 09:17:16,911 [INFO]: 	nb vectors: 4576
2025-03-09 09:17:16,911 [INFO]: 	vectors dimension: 49152
2025-03-09 09:17:16,911 [INFO]: 	compression ratio: 0.9993087397314152
2025-03-09 09:17:16,911 [INFO]: }
2025-03-09 09:17:16,911 [INFO]: 	>>> Finished "Creating the index" in 71.5698 secs
2025-03-09 09:17:16,911 [INFO]: >>> Finished "Launching the whole pipeline" in 71.6050 secs
2025-03-09 09:17:17: [retrieval_preprocessing] calculating distances ...
2025-03-09 09:17:18: [retrieval_preprocessing] finished and saved retrieval indices for episode 40741 [episode count 19/20]
2025-03-09 09:17:18: [retrieval_preprocessing] finished for (8456936732, 'bottle') [chosen_id count 6/10]
2025-03-09 09:17:22: [retrieval_preprocessing] concatenated all embeddings and indices for 20 episodes for (446878712, 'marker') [chosen_id count 7/10]
2025-03-09 09:17:22: [retrieval_preprocessing] we have num_total=5112 embedding_dim=49152
[retrieval_preprocessing] for episode 87555 [episode count 0/20], we have num_retrieval=np.int64(4922) num_query=np.int64(190)
2025-03-09 09:17:23,760 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-09 09:17:24,625 [INFO]: Launching the whole pipeline 03/09/2025, 09:17:24
2025-03-09 09:17:24,626 [INFO]: Reading total number of vectors and dimension 03/09/2025, 09:17:24
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1656.52it/s]
2025-03-09 09:17:24,662 [INFO]: There are 4922 embeddings of dim 49152
2025-03-09 09:17:24,662 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0364 secs
2025-03-09 09:17:24,662 [INFO]: 	Compute estimated construction time of the index 03/09/2025, 09:17:24
2025-03-09 09:17:24,663 [INFO]: 		-> Train: 16.7 minutes
2025-03-09 09:17:24,663 [INFO]: 		-> Add: 2.7 seconds
2025-03-09 09:17:24,663 [INFO]: 		Total: 16.7 minutes
2025-03-09 09:17:24,663 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0005 secs
2025-03-09 09:17:24,663 [INFO]: 	Checking that your have enough memory available to create the index 03/09/2025, 09:17:24
2025-03-09 09:17:24,664 [INFO]: 1015.8MB of memory will be needed to build the index (more might be used if you have more)
2025-03-09 09:17:24,664 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0005 secs
2025-03-09 09:17:24,664 [INFO]: 	Selecting most promising index types given data characteristics 03/09/2025, 09:17:24
2025-03-09 09:17:24,664 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-09 09:17:24,664 [INFO]: 	Creating the index 03/09/2025, 09:17:24
2025-03-09 09:17:24,664 [INFO]: 		-> Instanciate the index HNSW15 03/09/2025, 09:17:24
2025-03-09 09:17:24,668 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0033 secs
2025-03-09 09:17:24,668 [INFO]: 		-> Adding the vectors to the index 03/09/2025, 09:17:24
2025-03-09 09:17:24,668 [INFO]: The memory available for adding the vectors is 49.1GB(total available - used by the index)
2025-03-09 09:17:24,669 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/20 [00:00<?, ?it/s]  5%|▌         | 1/20 [00:00<00:03,  5.99it/s] 15%|█▌        | 3/20 [00:00<00:01,  9.70it/s] 25%|██▌       | 5/20 [00:00<00:01, 10.76it/s] 35%|███▌      | 7/20 [00:00<00:01, 10.75it/s] 45%|████▌     | 9/20 [00:00<00:01,  9.56it/s] 50%|█████     | 10/20 [00:01<00:01,  8.96it/s] 55%|█████▌    | 11/20 [00:01<00:01,  8.73it/s] 60%|██████    | 12/20 [00:01<00:00,  8.47it/s] 80%|████████  | 16/20 [00:01<00:00, 15.20it/s]100%|██████████| 20/20 [00:04<00:00,  2.31it/s]100%|██████████| 20/20 [00:04<00:00,  4.07it/s]
2025-03-09 09:17:29,591 [INFO]: 	Computing best hyperparameters for index knn.index 03/09/2025, 09:17:29
2025-03-09 09:18:19,807 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 50.2151 secs
2025-03-09 09:18:19,807 [INFO]: The best hyperparameters are: efSearch=201
2025-03-09 09:18:19,807 [INFO]: 	Compute fast metrics 03/09/2025, 09:18:19
  0%|          | 0/4 [00:00<?, ?it/s] 25%|██▌       | 1/4 [00:00<00:00,  9.69it/s] 75%|███████▌  | 3/4 [00:00<00:00, 16.52it/s]
2025-03-09 09:18:37,151 [INFO]: 	>>> Finished "Compute fast metrics" in 17.3437 secs
2025-03-09 09:18:37,154 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 72.4852 secs
2025-03-09 09:18:37,154 [INFO]: {
2025-03-09 09:18:37,154 [INFO]: 	index_key: HNSW15
2025-03-09 09:18:37,154 [INFO]: 	index_param: efSearch=201
2025-03-09 09:18:37,154 [INFO]: 	index_path: knn.index
2025-03-09 09:18:37,154 [INFO]: 	size in bytes: 968373970
2025-03-09 09:18:37,154 [INFO]: 	avg_search_speed_ms: 8.88641006189088
2025-03-09 09:18:37,154 [INFO]: 	99p_search_speed_ms: 17.905976856127378
2025-03-09 09:18:37,154 [INFO]: 	reconstruction error %: 0.0
2025-03-09 09:18:37,154 [INFO]: 	nb vectors: 4922
2025-03-09 09:18:37,154 [INFO]: 	vectors dimension: 49152
2025-03-09 09:18:37,154 [INFO]: 	compression ratio: 0.9993087443273594
2025-03-09 09:18:37,154 [INFO]: }
2025-03-09 09:18:37,154 [INFO]: 	>>> Finished "Creating the index" in 72.4897 secs
2025-03-09 09:18:37,154 [INFO]: >>> Finished "Launching the whole pipeline" in 72.5283 secs
2025-03-09 09:18:38: [retrieval_preprocessing] calculating distances ...
2025-03-09 09:18:38: [retrieval_preprocessing] finished and saved retrieval indices for episode 87555 [episode count 0/20]
[retrieval_preprocessing] for episode 1028 [episode count 1/20], we have num_retrieval=np.int64(4847) num_query=np.int64(265)
2025-03-09 09:18:39,045 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-09 09:18:40,669 [INFO]: Launching the whole pipeline 03/09/2025, 09:18:40
2025-03-09 09:18:40,669 [INFO]: Reading total number of vectors and dimension 03/09/2025, 09:18:40
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1500.11it/s]
2025-03-09 09:18:40,699 [INFO]: There are 4847 embeddings of dim 49152
2025-03-09 09:18:40,699 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0295 secs
2025-03-09 09:18:40,699 [INFO]: 	Compute estimated construction time of the index 03/09/2025, 09:18:40
2025-03-09 09:18:40,699 [INFO]: 		-> Train: 16.7 minutes
2025-03-09 09:18:40,699 [INFO]: 		-> Add: 2.7 seconds
2025-03-09 09:18:40,699 [INFO]: 		Total: 16.7 minutes
2025-03-09 09:18:40,699 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0001 secs
2025-03-09 09:18:40,699 [INFO]: 	Checking that your have enough memory available to create the index 03/09/2025, 09:18:40
2025-03-09 09:18:40,699 [INFO]: 1000.3MB of memory will be needed to build the index (more might be used if you have more)
2025-03-09 09:18:40,699 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0002 secs
2025-03-09 09:18:40,699 [INFO]: 	Selecting most promising index types given data characteristics 03/09/2025, 09:18:40
2025-03-09 09:18:40,699 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-09 09:18:40,699 [INFO]: 	Creating the index 03/09/2025, 09:18:40
2025-03-09 09:18:40,700 [INFO]: 		-> Instanciate the index HNSW15 03/09/2025, 09:18:40
2025-03-09 09:18:40,701 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0010 secs
2025-03-09 09:18:40,701 [INFO]: 		-> Adding the vectors to the index 03/09/2025, 09:18:40
2025-03-09 09:18:40,701 [INFO]: The memory available for adding the vectors is 49.1GB(total available - used by the index)
2025-03-09 09:18:40,701 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/20 [00:00<?, ?it/s]  5%|▌         | 1/20 [00:00<00:02,  8.68it/s] 35%|███▌      | 7/20 [00:00<00:00, 35.87it/s] 55%|█████▌    | 11/20 [00:00<00:00, 35.45it/s] 85%|████████▌ | 17/20 [00:00<00:00, 44.38it/s]100%|██████████| 20/20 [00:04<00:00,  4.99it/s]
2025-03-09 09:18:44,711 [INFO]: 	Computing best hyperparameters for index knn.index 03/09/2025, 09:18:44
2025-03-09 09:19:30,922 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 46.2099 secs
2025-03-09 09:19:30,922 [INFO]: The best hyperparameters are: efSearch=202
2025-03-09 09:19:30,922 [INFO]: 	Compute fast metrics 03/09/2025, 09:19:30
  0%|          | 0/4 [00:00<?, ?it/s] 75%|███████▌  | 3/4 [00:00<00:00, 25.66it/s] 75%|███████▌  | 3/4 [00:00<00:00, 22.11it/s]
2025-03-09 09:19:48,663 [INFO]: 	>>> Finished "Compute fast metrics" in 17.7408 secs
2025-03-09 09:19:48,666 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 67.9649 secs
2025-03-09 09:19:48,666 [INFO]: {
2025-03-09 09:19:48,666 [INFO]: 	index_key: HNSW15
2025-03-09 09:19:48,666 [INFO]: 	index_param: efSearch=202
2025-03-09 09:19:48,666 [INFO]: 	index_path: knn.index
2025-03-09 09:19:48,666 [INFO]: 	size in bytes: 953618290
2025-03-09 09:19:48,666 [INFO]: 	avg_search_speed_ms: 9.00122872239413
2025-03-09 09:19:48,666 [INFO]: 	99p_search_speed_ms: 15.460453159175827
2025-03-09 09:19:48,666 [INFO]: 	reconstruction error %: 0.0
2025-03-09 09:19:48,666 [INFO]: 	nb vectors: 4847
2025-03-09 09:19:48,666 [INFO]: 	vectors dimension: 49152
2025-03-09 09:19:48,666 [INFO]: 	compression ratio: 0.9993086185458964
2025-03-09 09:19:48,666 [INFO]: }
2025-03-09 09:19:48,666 [INFO]: 	>>> Finished "Creating the index" in 67.9664 secs
2025-03-09 09:19:48,666 [INFO]: >>> Finished "Launching the whole pipeline" in 67.9966 secs
2025-03-09 09:19:49: [retrieval_preprocessing] calculating distances ...
2025-03-09 09:19:50: [retrieval_preprocessing] finished and saved retrieval indices for episode 1028 [episode count 1/20]
[retrieval_preprocessing] for episode 89107 [episode count 2/20], we have num_retrieval=np.int64(4843) num_query=np.int64(269)
2025-03-09 09:19:51,055 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-09 09:19:52,543 [INFO]: Launching the whole pipeline 03/09/2025, 09:19:52
2025-03-09 09:19:52,543 [INFO]: Reading total number of vectors and dimension 03/09/2025, 09:19:52
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1145.98it/s]
2025-03-09 09:19:52,578 [INFO]: There are 4843 embeddings of dim 49152
2025-03-09 09:19:52,578 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0349 secs
2025-03-09 09:19:52,579 [INFO]: 	Compute estimated construction time of the index 03/09/2025, 09:19:52
2025-03-09 09:19:52,579 [INFO]: 		-> Train: 16.7 minutes
2025-03-09 09:19:52,579 [INFO]: 		-> Add: 2.7 seconds
2025-03-09 09:19:52,579 [INFO]: 		Total: 16.7 minutes
2025-03-09 09:19:52,579 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0005 secs
2025-03-09 09:19:52,579 [INFO]: 	Checking that your have enough memory available to create the index 03/09/2025, 09:19:52
2025-03-09 09:19:52,580 [INFO]: 999.5MB of memory will be needed to build the index (more might be used if you have more)
2025-03-09 09:19:52,580 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0005 secs
2025-03-09 09:19:52,580 [INFO]: 	Selecting most promising index types given data characteristics 03/09/2025, 09:19:52
2025-03-09 09:19:52,580 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-09 09:19:52,580 [INFO]: 	Creating the index 03/09/2025, 09:19:52
2025-03-09 09:19:52,581 [INFO]: 		-> Instanciate the index HNSW15 03/09/2025, 09:19:52
2025-03-09 09:19:52,584 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0034 secs
2025-03-09 09:19:52,584 [INFO]: 		-> Adding the vectors to the index 03/09/2025, 09:19:52
2025-03-09 09:19:52,585 [INFO]: The memory available for adding the vectors is 49.1GB(total available - used by the index)
2025-03-09 09:19:52,585 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/20 [00:00<?, ?it/s] 15%|█▌        | 3/20 [00:00<00:00, 26.97it/s] 45%|████▌     | 9/20 [00:00<00:00, 45.22it/s] 80%|████████  | 16/20 [00:00<00:00, 52.81it/s]100%|██████████| 20/20 [00:04<00:00,  4.72it/s]
2025-03-09 09:19:56,826 [INFO]: 	Computing best hyperparameters for index knn.index 03/09/2025, 09:19:56
2025-03-09 09:20:42,895 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 46.0686 secs
2025-03-09 09:20:42,895 [INFO]: The best hyperparameters are: efSearch=249
2025-03-09 09:20:42,895 [INFO]: 	Compute fast metrics 03/09/2025, 09:20:42
  0%|          | 0/4 [00:00<?, ?it/s] 75%|███████▌  | 3/4 [00:00<00:00, 25.87it/s] 75%|███████▌  | 3/4 [00:00<00:00, 22.19it/s]
2025-03-09 09:20:59,620 [INFO]: 	>>> Finished "Compute fast metrics" in 16.7244 secs
2025-03-09 09:20:59,623 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 67.0382 secs
2025-03-09 09:20:59,623 [INFO]: {
2025-03-09 09:20:59,623 [INFO]: 	index_key: HNSW15
2025-03-09 09:20:59,623 [INFO]: 	index_param: efSearch=249
2025-03-09 09:20:59,623 [INFO]: 	index_path: knn.index
2025-03-09 09:20:59,623 [INFO]: 	size in bytes: 952831330
2025-03-09 09:20:59,623 [INFO]: 	avg_search_speed_ms: 11.125968161346732
2025-03-09 09:20:59,623 [INFO]: 	99p_search_speed_ms: 24.972826098091875
2025-03-09 09:20:59,623 [INFO]: 	reconstruction error %: 0.0
2025-03-09 09:20:59,623 [INFO]: 	nb vectors: 4843
2025-03-09 09:20:59,623 [INFO]: 	vectors dimension: 49152
2025-03-09 09:20:59,623 [INFO]: 	compression ratio: 0.9993086016598551
2025-03-09 09:20:59,623 [INFO]: }
2025-03-09 09:20:59,623 [INFO]: 	>>> Finished "Creating the index" in 67.0428 secs
2025-03-09 09:20:59,623 [INFO]: >>> Finished "Launching the whole pipeline" in 67.0798 secs
2025-03-09 09:21:02: [retrieval_preprocessing] calculating distances ...
2025-03-09 09:21:03: [retrieval_preprocessing] finished and saved retrieval indices for episode 89107 [episode count 2/20]
[retrieval_preprocessing] for episode 38932 [episode count 3/20], we have num_retrieval=np.int64(4763) num_query=np.int64(349)
2025-03-09 09:21:03,698 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-09 09:21:05,148 [INFO]: Launching the whole pipeline 03/09/2025, 09:21:05
2025-03-09 09:21:05,148 [INFO]: Reading total number of vectors and dimension 03/09/2025, 09:21:05
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1242.02it/s]
2025-03-09 09:21:05,182 [INFO]: There are 4763 embeddings of dim 49152
2025-03-09 09:21:05,182 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0335 secs
2025-03-09 09:21:05,182 [INFO]: 	Compute estimated construction time of the index 03/09/2025, 09:21:05
2025-03-09 09:21:05,182 [INFO]: 		-> Train: 16.7 minutes
2025-03-09 09:21:05,182 [INFO]: 		-> Add: 2.6 seconds
2025-03-09 09:21:05,182 [INFO]: 		Total: 16.7 minutes
2025-03-09 09:21:05,182 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0001 secs
2025-03-09 09:21:05,182 [INFO]: 	Checking that your have enough memory available to create the index 03/09/2025, 09:21:05
2025-03-09 09:21:05,182 [INFO]: 983.0MB of memory will be needed to build the index (more might be used if you have more)
2025-03-09 09:21:05,183 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0002 secs
2025-03-09 09:21:05,183 [INFO]: 	Selecting most promising index types given data characteristics 03/09/2025, 09:21:05
2025-03-09 09:21:05,183 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-09 09:21:05,183 [INFO]: 	Creating the index 03/09/2025, 09:21:05
2025-03-09 09:21:05,183 [INFO]: 		-> Instanciate the index HNSW15 03/09/2025, 09:21:05
2025-03-09 09:21:05,184 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0012 secs
2025-03-09 09:21:05,184 [INFO]: 		-> Adding the vectors to the index 03/09/2025, 09:21:05
2025-03-09 09:21:05,184 [INFO]: The memory available for adding the vectors is 49.1GB(total available - used by the index)
2025-03-09 09:21:05,184 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/19 [00:00<?, ?it/s] 11%|█         | 2/19 [00:00<00:00, 18.05it/s] 37%|███▋      | 7/19 [00:00<00:00, 33.23it/s] 63%|██████▎   | 12/19 [00:00<00:00, 38.31it/s] 84%|████████▍ | 16/19 [00:00<00:00, 34.35it/s]100%|██████████| 19/19 [00:04<00:00,  4.41it/s]
2025-03-09 09:21:09,522 [INFO]: 	Computing best hyperparameters for index knn.index 03/09/2025, 09:21:09
2025-03-09 09:21:52,475 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 42.9526 secs
2025-03-09 09:21:52,475 [INFO]: The best hyperparameters are: efSearch=244
2025-03-09 09:21:52,475 [INFO]: 	Compute fast metrics 03/09/2025, 09:21:52
  0%|          | 0/4 [00:00<?, ?it/s] 75%|███████▌  | 3/4 [00:00<00:00, 25.23it/s] 75%|███████▌  | 3/4 [00:00<00:00, 21.13it/s]
2025-03-09 09:22:14,445 [INFO]: 	>>> Finished "Compute fast metrics" in 21.9693 secs
2025-03-09 09:22:14,447 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 69.2630 secs
2025-03-09 09:22:14,447 [INFO]: {
2025-03-09 09:22:14,447 [INFO]: 	index_key: HNSW15
2025-03-09 09:22:14,448 [INFO]: 	index_param: efSearch=244
2025-03-09 09:22:14,448 [INFO]: 	index_path: knn.index
2025-03-09 09:22:14,448 [INFO]: 	size in bytes: 937091830
2025-03-09 09:22:14,448 [INFO]: 	avg_search_speed_ms: 10.053993442596578
2025-03-09 09:22:14,448 [INFO]: 	99p_search_speed_ms: 19.545698044821616
2025-03-09 09:22:14,448 [INFO]: 	reconstruction error %: 0.0
2025-03-09 09:22:14,448 [INFO]: 	nb vectors: 4763
2025-03-09 09:22:14,448 [INFO]: 	vectors dimension: 49152
2025-03-09 09:22:14,448 [INFO]: 	compression ratio: 0.999308577901058
2025-03-09 09:22:14,448 [INFO]: }
2025-03-09 09:22:14,448 [INFO]: 	>>> Finished "Creating the index" in 69.2650 secs
2025-03-09 09:22:14,448 [INFO]: >>> Finished "Launching the whole pipeline" in 69.2992 secs
2025-03-09 09:22:16: [retrieval_preprocessing] calculating distances ...
2025-03-09 09:22:18: [retrieval_preprocessing] finished and saved retrieval indices for episode 38932 [episode count 3/20]
[retrieval_preprocessing] for episode 45604 [episode count 4/20], we have num_retrieval=np.int64(4771) num_query=np.int64(341)
2025-03-09 09:22:18,861 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-09 09:22:20,094 [INFO]: Launching the whole pipeline 03/09/2025, 09:22:20
2025-03-09 09:22:20,095 [INFO]: Reading total number of vectors and dimension 03/09/2025, 09:22:20
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1305.42it/s]
2025-03-09 09:22:20,128 [INFO]: There are 4771 embeddings of dim 49152
2025-03-09 09:22:20,129 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0339 secs
2025-03-09 09:22:20,129 [INFO]: 	Compute estimated construction time of the index 03/09/2025, 09:22:20
2025-03-09 09:22:20,129 [INFO]: 		-> Train: 16.7 minutes
2025-03-09 09:22:20,129 [INFO]: 		-> Add: 2.6 seconds
2025-03-09 09:22:20,129 [INFO]: 		Total: 16.7 minutes
2025-03-09 09:22:20,129 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0001 secs
2025-03-09 09:22:20,129 [INFO]: 	Checking that your have enough memory available to create the index 03/09/2025, 09:22:20
2025-03-09 09:22:20,129 [INFO]: 984.6MB of memory will be needed to build the index (more might be used if you have more)
2025-03-09 09:22:20,129 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0002 secs
2025-03-09 09:22:20,129 [INFO]: 	Selecting most promising index types given data characteristics 03/09/2025, 09:22:20
2025-03-09 09:22:20,129 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-09 09:22:20,130 [INFO]: 	Creating the index 03/09/2025, 09:22:20
2025-03-09 09:22:20,130 [INFO]: 		-> Instanciate the index HNSW15 03/09/2025, 09:22:20
2025-03-09 09:22:20,131 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0012 secs
2025-03-09 09:22:20,131 [INFO]: 		-> Adding the vectors to the index 03/09/2025, 09:22:20
2025-03-09 09:22:20,131 [INFO]: The memory available for adding the vectors is 49.1GB(total available - used by the index)
2025-03-09 09:22:20,131 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/19 [00:00<?, ?it/s]  5%|▌         | 1/19 [00:00<00:02,  6.18it/s] 32%|███▏      | 6/19 [00:00<00:00, 24.75it/s] 58%|█████▊    | 11/19 [00:00<00:00, 32.10it/s] 79%|███████▉  | 15/19 [00:00<00:00, 33.28it/s]100%|██████████| 19/19 [00:04<00:00,  2.76it/s]100%|██████████| 19/19 [00:04<00:00,  4.36it/s]
2025-03-09 09:22:24,494 [INFO]: 	Computing best hyperparameters for index knn.index 03/09/2025, 09:22:24
2025-03-09 09:23:07,666 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 43.1716 secs
2025-03-09 09:23:07,666 [INFO]: The best hyperparameters are: efSearch=241
2025-03-09 09:23:07,666 [INFO]: 	Compute fast metrics 03/09/2025, 09:23:07
  0%|          | 0/4 [00:00<?, ?it/s] 50%|█████     | 2/4 [00:00<00:00, 19.61it/s] 75%|███████▌  | 3/4 [00:00<00:00, 21.58it/s]
2025-03-09 09:23:31,563 [INFO]: 	>>> Finished "Compute fast metrics" in 23.8969 secs
2025-03-09 09:23:31,565 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 71.4343 secs
2025-03-09 09:23:31,566 [INFO]: {
2025-03-09 09:23:31,566 [INFO]: 	index_key: HNSW15
2025-03-09 09:23:31,566 [INFO]: 	index_param: efSearch=241
2025-03-09 09:23:31,566 [INFO]: 	index_path: knn.index
2025-03-09 09:23:31,566 [INFO]: 	size in bytes: 938665750
2025-03-09 09:23:31,566 [INFO]: 	avg_search_speed_ms: 10.980997887070973
2025-03-09 09:23:31,566 [INFO]: 	99p_search_speed_ms: 26.35354325175285
2025-03-09 09:23:31,566 [INFO]: 	reconstruction error %: 0.0
2025-03-09 09:23:31,566 [INFO]: 	nb vectors: 4771
2025-03-09 09:23:31,566 [INFO]: 	vectors dimension: 49152
2025-03-09 09:23:31,566 [INFO]: 	compression ratio: 0.999308612250953
2025-03-09 09:23:31,566 [INFO]: }
2025-03-09 09:23:31,566 [INFO]: 	>>> Finished "Creating the index" in 71.4361 secs
2025-03-09 09:23:31,566 [INFO]: >>> Finished "Launching the whole pipeline" in 71.4712 secs
2025-03-09 09:23:33: [retrieval_preprocessing] calculating distances ...
2025-03-09 09:23:34: [retrieval_preprocessing] finished and saved retrieval indices for episode 45604 [episode count 4/20]
[retrieval_preprocessing] for episode 20517 [episode count 5/20], we have num_retrieval=np.int64(4743) num_query=np.int64(369)
2025-03-09 09:23:35,219 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-09 09:23:35,949 [INFO]: Launching the whole pipeline 03/09/2025, 09:23:35
2025-03-09 09:23:35,949 [INFO]: Reading total number of vectors and dimension 03/09/2025, 09:23:35
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1046.22it/s]
2025-03-09 09:23:35,977 [INFO]: There are 4743 embeddings of dim 49152
2025-03-09 09:23:35,978 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0288 secs
2025-03-09 09:23:35,978 [INFO]: 	Compute estimated construction time of the index 03/09/2025, 09:23:35
2025-03-09 09:23:35,978 [INFO]: 		-> Train: 16.7 minutes
2025-03-09 09:23:35,978 [INFO]: 		-> Add: 2.6 seconds
2025-03-09 09:23:35,978 [INFO]: 		Total: 16.7 minutes
2025-03-09 09:23:35,978 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0001 secs
2025-03-09 09:23:35,978 [INFO]: 	Checking that your have enough memory available to create the index 03/09/2025, 09:23:35
2025-03-09 09:23:35,978 [INFO]: 978.8MB of memory will be needed to build the index (more might be used if you have more)
2025-03-09 09:23:35,978 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0003 secs
2025-03-09 09:23:35,978 [INFO]: 	Selecting most promising index types given data characteristics 03/09/2025, 09:23:35
2025-03-09 09:23:35,978 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-09 09:23:35,978 [INFO]: 	Creating the index 03/09/2025, 09:23:35
2025-03-09 09:23:35,978 [INFO]: 		-> Instanciate the index HNSW15 03/09/2025, 09:23:35
2025-03-09 09:23:35,979 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0011 secs
2025-03-09 09:23:35,979 [INFO]: 		-> Adding the vectors to the index 03/09/2025, 09:23:35
2025-03-09 09:23:35,980 [INFO]: The memory available for adding the vectors is 49.1GB(total available - used by the index)
2025-03-09 09:23:35,980 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/19 [00:00<?, ?it/s]  5%|▌         | 1/19 [00:00<00:02,  7.96it/s] 32%|███▏      | 6/19 [00:00<00:00, 27.93it/s] 63%|██████▎   | 12/19 [00:00<00:00, 40.09it/s] 95%|█████████▍| 18/19 [00:00<00:00, 45.57it/s]100%|██████████| 19/19 [00:03<00:00,  4.81it/s]
2025-03-09 09:23:39,930 [INFO]: 	Computing best hyperparameters for index knn.index 03/09/2025, 09:23:39
2025-03-09 09:24:21,445 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 41.5141 secs
2025-03-09 09:24:21,445 [INFO]: The best hyperparameters are: efSearch=242
2025-03-09 09:24:21,445 [INFO]: 	Compute fast metrics 03/09/2025, 09:24:21
  0%|          | 0/4 [00:00<?, ?it/s] 75%|███████▌  | 3/4 [00:00<00:00, 28.86it/s] 75%|███████▌  | 3/4 [00:00<00:00, 24.15it/s]
2025-03-09 09:24:37,654 [INFO]: 	>>> Finished "Compute fast metrics" in 16.2095 secs
2025-03-09 09:24:37,657 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 61.6772 secs
2025-03-09 09:24:37,657 [INFO]: {
2025-03-09 09:24:37,657 [INFO]: 	index_key: HNSW15
2025-03-09 09:24:37,657 [INFO]: 	index_param: efSearch=242
2025-03-09 09:24:37,657 [INFO]: 	index_path: knn.index
2025-03-09 09:24:37,657 [INFO]: 	size in bytes: 933156790
2025-03-09 09:24:37,657 [INFO]: 	avg_search_speed_ms: 9.301428816736092
2025-03-09 09:24:37,657 [INFO]: 	99p_search_speed_ms: 18.957952884957194
2025-03-09 09:24:37,657 [INFO]: 	reconstruction error %: 0.0
2025-03-09 09:24:37,657 [INFO]: 	nb vectors: 4743
2025-03-09 09:24:37,657 [INFO]: 	vectors dimension: 49152
2025-03-09 09:24:37,657 [INFO]: 	compression ratio: 0.9993087485330305
2025-03-09 09:24:37,657 [INFO]: }
2025-03-09 09:24:37,657 [INFO]: 	>>> Finished "Creating the index" in 61.6788 secs
2025-03-09 09:24:37,657 [INFO]: >>> Finished "Launching the whole pipeline" in 61.7083 secs
2025-03-09 09:24:39: [retrieval_preprocessing] calculating distances ...
2025-03-09 09:24:40: [retrieval_preprocessing] finished and saved retrieval indices for episode 20517 [episode count 5/20]
[retrieval_preprocessing] for episode 40998 [episode count 6/20], we have num_retrieval=np.int64(4859) num_query=np.int64(253)
2025-03-09 09:24:40,792 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-09 09:24:41,409 [INFO]: Launching the whole pipeline 03/09/2025, 09:24:41
2025-03-09 09:24:41,409 [INFO]: Reading total number of vectors and dimension 03/09/2025, 09:24:41
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1800.13it/s]
2025-03-09 09:24:41,437 [INFO]: There are 4859 embeddings of dim 49152
2025-03-09 09:24:41,437 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0284 secs
2025-03-09 09:24:41,437 [INFO]: 	Compute estimated construction time of the index 03/09/2025, 09:24:41
2025-03-09 09:24:41,438 [INFO]: 		-> Train: 16.7 minutes
2025-03-09 09:24:41,438 [INFO]: 		-> Add: 2.7 seconds
2025-03-09 09:24:41,438 [INFO]: 		Total: 16.7 minutes
2025-03-09 09:24:41,438 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0002 secs
2025-03-09 09:24:41,438 [INFO]: 	Checking that your have enough memory available to create the index 03/09/2025, 09:24:41
2025-03-09 09:24:41,438 [INFO]: 1002.8MB of memory will be needed to build the index (more might be used if you have more)
2025-03-09 09:24:41,438 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0001 secs
2025-03-09 09:24:41,438 [INFO]: 	Selecting most promising index types given data characteristics 03/09/2025, 09:24:41
2025-03-09 09:24:41,438 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-09 09:24:41,438 [INFO]: 	Creating the index 03/09/2025, 09:24:41
2025-03-09 09:24:41,438 [INFO]: 		-> Instanciate the index HNSW15 03/09/2025, 09:24:41
2025-03-09 09:24:41,439 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0010 secs
2025-03-09 09:24:41,439 [INFO]: 		-> Adding the vectors to the index 03/09/2025, 09:24:41
2025-03-09 09:24:41,439 [INFO]: The memory available for adding the vectors is 49.1GB(total available - used by the index)
2025-03-09 09:24:41,439 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/20 [00:00<?, ?it/s]  5%|▌         | 1/20 [00:00<00:02,  8.44it/s] 30%|███       | 6/20 [00:00<00:00, 31.02it/s] 55%|█████▌    | 11/20 [00:00<00:00, 37.10it/s] 80%|████████  | 16/20 [00:00<00:00, 40.41it/s]100%|██████████| 20/20 [00:04<00:00,  4.97it/s]
2025-03-09 09:24:45,470 [INFO]: 	Computing best hyperparameters for index knn.index 03/09/2025, 09:24:45
2025-03-09 09:25:29,832 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 44.3616 secs
2025-03-09 09:25:29,833 [INFO]: The best hyperparameters are: efSearch=223
2025-03-09 09:25:29,833 [INFO]: 	Compute fast metrics 03/09/2025, 09:25:29
  0%|          | 0/4 [00:00<?, ?it/s] 75%|███████▌  | 3/4 [00:00<00:00, 27.56it/s] 75%|███████▌  | 3/4 [00:00<00:00, 24.16it/s]
2025-03-09 09:25:49,247 [INFO]: 	>>> Finished "Compute fast metrics" in 19.4146 secs
2025-03-09 09:25:49,250 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 67.8107 secs
2025-03-09 09:25:49,250 [INFO]: {
2025-03-09 09:25:49,250 [INFO]: 	index_key: HNSW15
2025-03-09 09:25:49,250 [INFO]: 	index_param: efSearch=223
2025-03-09 09:25:49,250 [INFO]: 	index_path: knn.index
2025-03-09 09:25:49,250 [INFO]: 	size in bytes: 955979170
2025-03-09 09:25:49,250 [INFO]: 	avg_search_speed_ms: 9.281124138084273
2025-03-09 09:25:49,250 [INFO]: 	99p_search_speed_ms: 19.971853569149996
2025-03-09 09:25:49,250 [INFO]: 	reconstruction error %: 0.0
2025-03-09 09:25:49,250 [INFO]: 	nb vectors: 4859
2025-03-09 09:25:49,250 [INFO]: 	vectors dimension: 49152
2025-03-09 09:25:49,250 [INFO]: 	compression ratio: 0.9993086690372134
2025-03-09 09:25:49,250 [INFO]: }
2025-03-09 09:25:49,250 [INFO]: 	>>> Finished "Creating the index" in 67.8123 secs
2025-03-09 09:25:49,250 [INFO]: >>> Finished "Launching the whole pipeline" in 67.8414 secs
2025-03-09 09:25:50: [retrieval_preprocessing] calculating distances ...
2025-03-09 09:25:51: [retrieval_preprocessing] finished and saved retrieval indices for episode 40998 [episode count 6/20]
[retrieval_preprocessing] for episode 67622 [episode count 7/20], we have num_retrieval=np.int64(4848) num_query=np.int64(264)
2025-03-09 09:25:51,709 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-09 09:25:52,380 [INFO]: Launching the whole pipeline 03/09/2025, 09:25:52
2025-03-09 09:25:52,380 [INFO]: Reading total number of vectors and dimension 03/09/2025, 09:25:52
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1499.04it/s]
2025-03-09 09:25:52,408 [INFO]: There are 4848 embeddings of dim 49152
2025-03-09 09:25:52,409 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0286 secs
2025-03-09 09:25:52,409 [INFO]: 	Compute estimated construction time of the index 03/09/2025, 09:25:52
2025-03-09 09:25:52,409 [INFO]: 		-> Train: 16.7 minutes
2025-03-09 09:25:52,409 [INFO]: 		-> Add: 2.7 seconds
2025-03-09 09:25:52,409 [INFO]: 		Total: 16.7 minutes
2025-03-09 09:25:52,409 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0001 secs
2025-03-09 09:25:52,409 [INFO]: 	Checking that your have enough memory available to create the index 03/09/2025, 09:25:52
2025-03-09 09:25:52,409 [INFO]: 1000.5MB of memory will be needed to build the index (more might be used if you have more)
2025-03-09 09:25:52,409 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0001 secs
2025-03-09 09:25:52,409 [INFO]: 	Selecting most promising index types given data characteristics 03/09/2025, 09:25:52
2025-03-09 09:25:52,409 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-09 09:25:52,409 [INFO]: 	Creating the index 03/09/2025, 09:25:52
2025-03-09 09:25:52,409 [INFO]: 		-> Instanciate the index HNSW15 03/09/2025, 09:25:52
2025-03-09 09:25:52,410 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0009 secs
2025-03-09 09:25:52,410 [INFO]: 		-> Adding the vectors to the index 03/09/2025, 09:25:52
2025-03-09 09:25:52,410 [INFO]: The memory available for adding the vectors is 49.1GB(total available - used by the index)
2025-03-09 09:25:52,410 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/20 [00:00<?, ?it/s]  5%|▌         | 1/20 [00:00<00:02,  7.71it/s] 30%|███       | 6/20 [00:00<00:00, 29.43it/s] 60%|██████    | 12/20 [00:00<00:00, 39.36it/s] 90%|█████████ | 18/20 [00:00<00:00, 43.90it/s]100%|██████████| 20/20 [00:04<00:00,  4.55it/s]
2025-03-09 09:25:56,809 [INFO]: 	Computing best hyperparameters for index knn.index 03/09/2025, 09:25:56
2025-03-09 09:26:37,402 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 40.5930 secs
2025-03-09 09:26:37,403 [INFO]: The best hyperparameters are: efSearch=179
2025-03-09 09:26:37,403 [INFO]: 	Compute fast metrics 03/09/2025, 09:26:37
  0%|          | 0/4 [00:00<?, ?it/s] 75%|███████▌  | 3/4 [00:00<00:00, 27.06it/s] 75%|███████▌  | 3/4 [00:00<00:00, 23.30it/s]
2025-03-09 09:26:57,663 [INFO]: 	>>> Finished "Compute fast metrics" in 20.2606 secs
2025-03-09 09:26:57,666 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 65.2555 secs
2025-03-09 09:26:57,666 [INFO]: {
2025-03-09 09:26:57,666 [INFO]: 	index_key: HNSW15
2025-03-09 09:26:57,666 [INFO]: 	index_param: efSearch=179
2025-03-09 09:26:57,666 [INFO]: 	index_path: knn.index
2025-03-09 09:26:57,666 [INFO]: 	size in bytes: 953815030
2025-03-09 09:26:57,666 [INFO]: 	avg_search_speed_ms: 7.96566455777126
2025-03-09 09:26:57,666 [INFO]: 	99p_search_speed_ms: 13.628175752237441
2025-03-09 09:26:57,666 [INFO]: 	reconstruction error %: 0.0
2025-03-09 09:26:57,666 [INFO]: 	nb vectors: 4848
2025-03-09 09:26:57,666 [INFO]: 	vectors dimension: 49152
2025-03-09 09:26:57,666 [INFO]: 	compression ratio: 0.9993086227630529
2025-03-09 09:26:57,666 [INFO]: }
2025-03-09 09:26:57,666 [INFO]: 	>>> Finished "Creating the index" in 65.2568 secs
2025-03-09 09:26:57,666 [INFO]: >>> Finished "Launching the whole pipeline" in 65.2861 secs
2025-03-09 09:26:58: [retrieval_preprocessing] calculating distances ...
2025-03-09 09:26:59: [retrieval_preprocessing] finished and saved retrieval indices for episode 67622 [episode count 7/20]
[retrieval_preprocessing] for episode 9256 [episode count 8/20], we have num_retrieval=np.int64(4967) num_query=np.int64(145)
2025-03-09 09:26:59,710 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-09 09:27:00,346 [INFO]: Launching the whole pipeline 03/09/2025, 09:27:00
2025-03-09 09:27:00,347 [INFO]: Reading total number of vectors and dimension 03/09/2025, 09:27:00
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 2192.53it/s]
2025-03-09 09:27:00,373 [INFO]: There are 4967 embeddings of dim 49152
2025-03-09 09:27:00,373 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0262 secs
2025-03-09 09:27:00,373 [INFO]: 	Compute estimated construction time of the index 03/09/2025, 09:27:00
2025-03-09 09:27:00,373 [INFO]: 		-> Train: 16.7 minutes
2025-03-09 09:27:00,373 [INFO]: 		-> Add: 2.7 seconds
2025-03-09 09:27:00,373 [INFO]: 		Total: 16.7 minutes
2025-03-09 09:27:00,373 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0001 secs
2025-03-09 09:27:00,373 [INFO]: 	Checking that your have enough memory available to create the index 03/09/2025, 09:27:00
2025-03-09 09:27:00,373 [INFO]: 1.0GB of memory will be needed to build the index (more might be used if you have more)
2025-03-09 09:27:00,373 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0001 secs
2025-03-09 09:27:00,373 [INFO]: 	Selecting most promising index types given data characteristics 03/09/2025, 09:27:00
2025-03-09 09:27:00,373 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-09 09:27:00,373 [INFO]: 	Creating the index 03/09/2025, 09:27:00
2025-03-09 09:27:00,373 [INFO]: 		-> Instanciate the index HNSW15 03/09/2025, 09:27:00
2025-03-09 09:27:00,374 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0009 secs
2025-03-09 09:27:00,374 [INFO]: 		-> Adding the vectors to the index 03/09/2025, 09:27:00
2025-03-09 09:27:00,374 [INFO]: The memory available for adding the vectors is 49.1GB(total available - used by the index)
2025-03-09 09:27:00,374 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/20 [00:00<?, ?it/s]  5%|▌         | 1/20 [00:00<00:02,  7.27it/s] 35%|███▌      | 7/20 [00:00<00:00, 31.30it/s] 65%|██████▌   | 13/20 [00:00<00:00, 40.01it/s] 90%|█████████ | 18/20 [00:00<00:00, 42.62it/s]100%|██████████| 20/20 [00:03<00:00,  5.05it/s]
2025-03-09 09:27:04,334 [INFO]: 	Computing best hyperparameters for index knn.index 03/09/2025, 09:27:04
2025-03-09 09:27:49,190 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 44.8553 secs
2025-03-09 09:27:49,190 [INFO]: The best hyperparameters are: efSearch=226
2025-03-09 09:27:49,190 [INFO]: 	Compute fast metrics 03/09/2025, 09:27:49
  0%|          | 0/4 [00:00<?, ?it/s] 75%|███████▌  | 3/4 [00:00<00:00, 25.88it/s] 75%|███████▌  | 3/4 [00:00<00:00, 22.47it/s]
2025-03-09 09:28:09,137 [INFO]: 	>>> Finished "Compute fast metrics" in 19.9469 secs
2025-03-09 09:28:09,140 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 68.7655 secs
2025-03-09 09:28:09,140 [INFO]: {
2025-03-09 09:28:09,140 [INFO]: 	index_key: HNSW15
2025-03-09 09:28:09,140 [INFO]: 	index_param: efSearch=226
2025-03-09 09:28:09,140 [INFO]: 	index_path: knn.index
2025-03-09 09:28:09,140 [INFO]: 	size in bytes: 977227510
2025-03-09 09:28:09,140 [INFO]: 	avg_search_speed_ms: 9.776174674131056
2025-03-09 09:28:09,140 [INFO]: 	99p_search_speed_ms: 18.05709910113364
2025-03-09 09:28:09,140 [INFO]: 	reconstruction error %: 0.0
2025-03-09 09:28:09,140 [INFO]: 	nb vectors: 4967
2025-03-09 09:28:09,140 [INFO]: 	vectors dimension: 49152
2025-03-09 09:28:09,140 [INFO]: 	compression ratio: 0.9993086829903101
2025-03-09 09:28:09,140 [INFO]: }
2025-03-09 09:28:09,140 [INFO]: 	>>> Finished "Creating the index" in 68.7669 secs
2025-03-09 09:28:09,140 [INFO]: >>> Finished "Launching the whole pipeline" in 68.7937 secs
2025-03-09 09:28:09: [retrieval_preprocessing] calculating distances ...
2025-03-09 09:28:10: [retrieval_preprocessing] finished and saved retrieval indices for episode 9256 [episode count 8/20]
[retrieval_preprocessing] for episode 9769 [episode count 9/20], we have num_retrieval=np.int64(4882) num_query=np.int64(230)
2025-03-09 09:28:10,745 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-09 09:28:11,893 [INFO]: Launching the whole pipeline 03/09/2025, 09:28:11
2025-03-09 09:28:11,893 [INFO]: Reading total number of vectors and dimension 03/09/2025, 09:28:11
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 2195.97it/s]
2025-03-09 09:28:11,923 [INFO]: There are 4882 embeddings of dim 49152
2025-03-09 09:28:11,924 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0306 secs
2025-03-09 09:28:11,924 [INFO]: 	Compute estimated construction time of the index 03/09/2025, 09:28:11
2025-03-09 09:28:11,924 [INFO]: 		-> Train: 16.7 minutes
2025-03-09 09:28:11,924 [INFO]: 		-> Add: 2.7 seconds
2025-03-09 09:28:11,924 [INFO]: 		Total: 16.7 minutes
2025-03-09 09:28:11,924 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0004 secs
2025-03-09 09:28:11,925 [INFO]: 	Checking that your have enough memory available to create the index 03/09/2025, 09:28:11
2025-03-09 09:28:11,925 [INFO]: 1007.5MB of memory will be needed to build the index (more might be used if you have more)
2025-03-09 09:28:11,925 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0004 secs
2025-03-09 09:28:11,925 [INFO]: 	Selecting most promising index types given data characteristics 03/09/2025, 09:28:11
2025-03-09 09:28:11,925 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-09 09:28:11,925 [INFO]: 	Creating the index 03/09/2025, 09:28:11
2025-03-09 09:28:11,925 [INFO]: 		-> Instanciate the index HNSW15 03/09/2025, 09:28:11
2025-03-09 09:28:11,928 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0026 secs
2025-03-09 09:28:11,928 [INFO]: 		-> Adding the vectors to the index 03/09/2025, 09:28:11
2025-03-09 09:28:11,929 [INFO]: The memory available for adding the vectors is 49.1GB(total available - used by the index)
2025-03-09 09:28:11,929 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/20 [00:00<?, ?it/s] 15%|█▌        | 3/20 [00:00<00:00, 25.58it/s] 45%|████▌     | 9/20 [00:00<00:00, 43.28it/s] 75%|███████▌  | 15/20 [00:00<00:00, 49.41it/s]100%|██████████| 20/20 [00:04<00:00,  4.55it/s]
2025-03-09 09:28:16,327 [INFO]: 	Computing best hyperparameters for index knn.index 03/09/2025, 09:28:16
2025-03-09 09:29:05,948 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 49.6205 secs
2025-03-09 09:29:05,949 [INFO]: The best hyperparameters are: efSearch=239
2025-03-09 09:29:05,949 [INFO]: 	Compute fast metrics 03/09/2025, 09:29:05
  0%|          | 0/4 [00:00<?, ?it/s] 50%|█████     | 2/4 [00:00<00:00, 19.94it/s] 75%|███████▌  | 3/4 [00:00<00:00, 21.41it/s]
2025-03-09 09:29:31,483 [INFO]: 	>>> Finished "Compute fast metrics" in 25.5343 secs
2025-03-09 09:29:31,486 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 79.5574 secs
2025-03-09 09:29:31,486 [INFO]: {
2025-03-09 09:29:31,486 [INFO]: 	index_key: HNSW15
2025-03-09 09:29:31,486 [INFO]: 	index_param: efSearch=239
2025-03-09 09:29:31,486 [INFO]: 	index_path: knn.index
2025-03-09 09:29:31,486 [INFO]: 	size in bytes: 960504250
2025-03-09 09:29:31,486 [INFO]: 	avg_search_speed_ms: 11.016124330780688
2025-03-09 09:29:31,486 [INFO]: 	99p_search_speed_ms: 20.4587314557284
2025-03-09 09:29:31,486 [INFO]: 	reconstruction error %: 0.0
2025-03-09 09:29:31,486 [INFO]: 	nb vectors: 4882
2025-03-09 09:29:31,486 [INFO]: 	vectors dimension: 49152
2025-03-09 09:29:31,486 [INFO]: 	compression ratio: 0.999308702694444
2025-03-09 09:29:31,486 [INFO]: }
2025-03-09 09:29:31,486 [INFO]: 	>>> Finished "Creating the index" in 79.5610 secs
2025-03-09 09:29:31,486 [INFO]: >>> Finished "Launching the whole pipeline" in 79.5933 secs
2025-03-09 09:29:33: [retrieval_preprocessing] calculating distances ...
2025-03-09 09:29:34: [retrieval_preprocessing] finished and saved retrieval indices for episode 9769 [episode count 9/20]
[retrieval_preprocessing] for episode 84006 [episode count 10/20], we have num_retrieval=np.int64(4972) num_query=np.int64(140)
2025-03-09 09:29:34,583 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-09 09:29:35,614 [INFO]: Launching the whole pipeline 03/09/2025, 09:29:35
2025-03-09 09:29:35,614 [INFO]: Reading total number of vectors and dimension 03/09/2025, 09:29:35
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 959.14it/s]
2025-03-09 09:29:35,648 [INFO]: There are 4972 embeddings of dim 49152
2025-03-09 09:29:35,648 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0338 secs
2025-03-09 09:29:35,648 [INFO]: 	Compute estimated construction time of the index 03/09/2025, 09:29:35
2025-03-09 09:29:35,648 [INFO]: 		-> Train: 16.7 minutes
2025-03-09 09:29:35,648 [INFO]: 		-> Add: 2.7 seconds
2025-03-09 09:29:35,648 [INFO]: 		Total: 16.7 minutes
2025-03-09 09:29:35,648 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0001 secs
2025-03-09 09:29:35,648 [INFO]: 	Checking that your have enough memory available to create the index 03/09/2025, 09:29:35
2025-03-09 09:29:35,649 [INFO]: 1.0GB of memory will be needed to build the index (more might be used if you have more)
2025-03-09 09:29:35,649 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0002 secs
2025-03-09 09:29:35,649 [INFO]: 	Selecting most promising index types given data characteristics 03/09/2025, 09:29:35
2025-03-09 09:29:35,649 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-09 09:29:35,649 [INFO]: 	Creating the index 03/09/2025, 09:29:35
2025-03-09 09:29:35,649 [INFO]: 		-> Instanciate the index HNSW15 03/09/2025, 09:29:35
2025-03-09 09:29:35,650 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0010 secs
2025-03-09 09:29:35,650 [INFO]: 		-> Adding the vectors to the index 03/09/2025, 09:29:35
2025-03-09 09:29:35,650 [INFO]: The memory available for adding the vectors is 49.1GB(total available - used by the index)
2025-03-09 09:29:35,650 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/20 [00:00<?, ?it/s]  5%|▌         | 1/20 [00:00<00:02,  7.00it/s] 20%|██        | 4/20 [00:00<00:00, 17.76it/s] 40%|████      | 8/20 [00:00<00:00, 26.74it/s] 65%|██████▌   | 13/20 [00:00<00:00, 32.33it/s] 85%|████████▌ | 17/20 [00:00<00:00, 34.41it/s]100%|██████████| 20/20 [00:04<00:00,  4.31it/s]
2025-03-09 09:29:40,296 [INFO]: 	Computing best hyperparameters for index knn.index 03/09/2025, 09:29:40
2025-03-09 09:30:28,320 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 48.0232 secs
2025-03-09 09:30:28,320 [INFO]: The best hyperparameters are: efSearch=250
2025-03-09 09:30:28,320 [INFO]: 	Compute fast metrics 03/09/2025, 09:30:28
  0%|          | 0/4 [00:00<?, ?it/s] 50%|█████     | 2/4 [00:00<00:00, 18.44it/s] 75%|███████▌  | 3/4 [00:00<00:00, 17.90it/s]
2025-03-09 09:30:41,689 [INFO]: 	>>> Finished "Compute fast metrics" in 13.3688 secs
2025-03-09 09:30:41,692 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 66.0422 secs
2025-03-09 09:30:41,692 [INFO]: {
2025-03-09 09:30:41,692 [INFO]: 	index_key: HNSW15
2025-03-09 09:30:41,692 [INFO]: 	index_param: efSearch=250
2025-03-09 09:30:41,692 [INFO]: 	index_path: knn.index
2025-03-09 09:30:41,692 [INFO]: 	size in bytes: 978211210
2025-03-09 09:30:41,692 [INFO]: 	avg_search_speed_ms: 10.851080987729746
2025-03-09 09:30:41,692 [INFO]: 	99p_search_speed_ms: 23.795641523320224
2025-03-09 09:30:41,692 [INFO]: 	reconstruction error %: 0.0
2025-03-09 09:30:41,693 [INFO]: 	nb vectors: 4972
2025-03-09 09:30:41,693 [INFO]: 	vectors dimension: 49152
2025-03-09 09:30:41,693 [INFO]: 	compression ratio: 0.999308703485416
2025-03-09 09:30:41,693 [INFO]: }
2025-03-09 09:30:41,693 [INFO]: 	>>> Finished "Creating the index" in 66.0439 secs
2025-03-09 09:30:41,693 [INFO]: >>> Finished "Launching the whole pipeline" in 66.0783 secs
2025-03-09 09:30:43: [retrieval_preprocessing] calculating distances ...
2025-03-09 09:30:43: [retrieval_preprocessing] finished and saved retrieval indices for episode 84006 [episode count 10/20]
[retrieval_preprocessing] for episode 91688 [episode count 11/20], we have num_retrieval=np.int64(4930) num_query=np.int64(182)
2025-03-09 09:30:44,177 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-09 09:30:44,876 [INFO]: Launching the whole pipeline 03/09/2025, 09:30:44
2025-03-09 09:30:44,877 [INFO]: Reading total number of vectors and dimension 03/09/2025, 09:30:44
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 932.90it/s]
2025-03-09 09:30:44,907 [INFO]: There are 4930 embeddings of dim 49152
2025-03-09 09:30:44,908 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0309 secs
2025-03-09 09:30:44,908 [INFO]: 	Compute estimated construction time of the index 03/09/2025, 09:30:44
2025-03-09 09:30:44,908 [INFO]: 		-> Train: 16.7 minutes
2025-03-09 09:30:44,908 [INFO]: 		-> Add: 2.7 seconds
2025-03-09 09:30:44,908 [INFO]: 		Total: 16.7 minutes
2025-03-09 09:30:44,908 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0004 secs
2025-03-09 09:30:44,908 [INFO]: 	Checking that your have enough memory available to create the index 03/09/2025, 09:30:44
2025-03-09 09:30:44,909 [INFO]: 1017.4MB of memory will be needed to build the index (more might be used if you have more)
2025-03-09 09:30:44,909 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0004 secs
2025-03-09 09:30:44,909 [INFO]: 	Selecting most promising index types given data characteristics 03/09/2025, 09:30:44
2025-03-09 09:30:44,909 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-09 09:30:44,909 [INFO]: 	Creating the index 03/09/2025, 09:30:44
2025-03-09 09:30:44,909 [INFO]: 		-> Instanciate the index HNSW15 03/09/2025, 09:30:44
2025-03-09 09:30:44,912 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0030 secs
2025-03-09 09:30:44,913 [INFO]: 		-> Adding the vectors to the index 03/09/2025, 09:30:44
2025-03-09 09:30:44,913 [INFO]: The memory available for adding the vectors is 49.1GB(total available - used by the index)
2025-03-09 09:30:44,913 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/20 [00:00<?, ?it/s]  5%|▌         | 1/20 [00:00<00:02,  7.97it/s] 20%|██        | 4/20 [00:00<00:00, 18.33it/s] 35%|███▌      | 7/20 [00:00<00:00, 18.13it/s] 45%|████▌     | 9/20 [00:00<00:00, 13.33it/s] 55%|█████▌    | 11/20 [00:00<00:00, 11.35it/s] 65%|██████▌   | 13/20 [00:01<00:00, 11.94it/s] 75%|███████▌  | 15/20 [00:01<00:00, 13.18it/s] 85%|████████▌ | 17/20 [00:01<00:00, 14.07it/s] 95%|█████████▌| 19/20 [00:01<00:00, 12.13it/s]100%|██████████| 20/20 [00:05<00:00,  3.65it/s]
2025-03-09 09:30:50,403 [INFO]: 	Computing best hyperparameters for index knn.index 03/09/2025, 09:30:50
2025-03-09 09:31:40,780 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 50.3758 secs
2025-03-09 09:31:40,780 [INFO]: The best hyperparameters are: efSearch=226
2025-03-09 09:31:40,780 [INFO]: 	Compute fast metrics 03/09/2025, 09:31:40
  0%|          | 0/4 [00:00<?, ?it/s] 50%|█████     | 2/4 [00:00<00:00, 19.25it/s] 75%|███████▌  | 3/4 [00:00<00:00, 20.99it/s]
2025-03-09 09:32:00,169 [INFO]: 	>>> Finished "Compute fast metrics" in 19.3887 secs
2025-03-09 09:32:00,172 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 75.2592 secs
2025-03-09 09:32:00,172 [INFO]: {
2025-03-09 09:32:00,172 [INFO]: 	index_key: HNSW15
2025-03-09 09:32:00,172 [INFO]: 	index_param: efSearch=226
2025-03-09 09:32:00,172 [INFO]: 	index_path: knn.index
2025-03-09 09:32:00,172 [INFO]: 	size in bytes: 969947950
2025-03-09 09:32:00,172 [INFO]: 	avg_search_speed_ms: 10.40842374675286
2025-03-09 09:32:00,172 [INFO]: 	99p_search_speed_ms: 19.643700588494536
2025-03-09 09:32:00,172 [INFO]: 	reconstruction error %: 0.0
2025-03-09 09:32:00,172 [INFO]: 	nb vectors: 4930
2025-03-09 09:32:00,172 [INFO]: 	vectors dimension: 49152
2025-03-09 09:32:00,172 [INFO]: 	compression ratio: 0.9993087154831349
2025-03-09 09:32:00,172 [INFO]: }
2025-03-09 09:32:00,172 [INFO]: 	>>> Finished "Creating the index" in 75.2632 secs
2025-03-09 09:32:00,172 [INFO]: >>> Finished "Launching the whole pipeline" in 75.2957 secs
2025-03-09 09:32:01: [retrieval_preprocessing] calculating distances ...
2025-03-09 09:32:01: [retrieval_preprocessing] finished and saved retrieval indices for episode 91688 [episode count 11/20]
[retrieval_preprocessing] for episode 44078 [episode count 12/20], we have num_retrieval=np.int64(4835) num_query=np.int64(277)
2025-03-09 09:32:02,130 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-09 09:32:02,780 [INFO]: Launching the whole pipeline 03/09/2025, 09:32:02
2025-03-09 09:32:02,780 [INFO]: Reading total number of vectors and dimension 03/09/2025, 09:32:02
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1080.73it/s]
2025-03-09 09:32:02,811 [INFO]: There are 4835 embeddings of dim 49152
2025-03-09 09:32:02,811 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0309 secs
2025-03-09 09:32:02,811 [INFO]: 	Compute estimated construction time of the index 03/09/2025, 09:32:02
2025-03-09 09:32:02,811 [INFO]: 		-> Train: 16.7 minutes
2025-03-09 09:32:02,811 [INFO]: 		-> Add: 2.7 seconds
2025-03-09 09:32:02,811 [INFO]: 		Total: 16.7 minutes
2025-03-09 09:32:02,811 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0001 secs
2025-03-09 09:32:02,811 [INFO]: 	Checking that your have enough memory available to create the index 03/09/2025, 09:32:02
2025-03-09 09:32:02,812 [INFO]: 997.8MB of memory will be needed to build the index (more might be used if you have more)
2025-03-09 09:32:02,812 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0002 secs
2025-03-09 09:32:02,812 [INFO]: 	Selecting most promising index types given data characteristics 03/09/2025, 09:32:02
2025-03-09 09:32:02,812 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-09 09:32:02,812 [INFO]: 	Creating the index 03/09/2025, 09:32:02
2025-03-09 09:32:02,812 [INFO]: 		-> Instanciate the index HNSW15 03/09/2025, 09:32:02
2025-03-09 09:32:02,813 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0011 secs
2025-03-09 09:32:02,813 [INFO]: 		-> Adding the vectors to the index 03/09/2025, 09:32:02
2025-03-09 09:32:02,813 [INFO]: The memory available for adding the vectors is 49.1GB(total available - used by the index)
2025-03-09 09:32:02,813 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/20 [00:00<?, ?it/s] 10%|█         | 2/20 [00:00<00:01, 17.70it/s] 30%|███       | 6/20 [00:00<00:00, 28.05it/s] 60%|██████    | 12/20 [00:00<00:00, 38.76it/s] 90%|█████████ | 18/20 [00:00<00:00, 44.04it/s]100%|██████████| 20/20 [00:04<00:00,  4.60it/s]
2025-03-09 09:32:07,168 [INFO]: 	Computing best hyperparameters for index knn.index 03/09/2025, 09:32:07
2025-03-09 09:32:53,506 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 46.3376 secs
2025-03-09 09:32:53,507 [INFO]: The best hyperparameters are: efSearch=220
2025-03-09 09:32:53,507 [INFO]: 	Compute fast metrics 03/09/2025, 09:32:53
  0%|          | 0/4 [00:00<?, ?it/s] 50%|█████     | 2/4 [00:00<00:00, 18.59it/s] 75%|███████▌  | 3/4 [00:00<00:00, 20.16it/s]
2025-03-09 09:33:16,247 [INFO]: 	>>> Finished "Compute fast metrics" in 22.7399 secs
2025-03-09 09:33:16,251 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 73.4380 secs
2025-03-09 09:33:16,251 [INFO]: {
2025-03-09 09:33:16,251 [INFO]: 	index_key: HNSW15
2025-03-09 09:33:16,251 [INFO]: 	index_param: efSearch=220
2025-03-09 09:33:16,251 [INFO]: 	index_path: knn.index
2025-03-09 09:33:16,251 [INFO]: 	size in bytes: 951257350
2025-03-09 09:33:16,251 [INFO]: 	avg_search_speed_ms: 12.08020732873052
2025-03-09 09:33:16,251 [INFO]: 	99p_search_speed_ms: 22.672037738375398
2025-03-09 09:33:16,251 [INFO]: 	reconstruction error %: 0.0
2025-03-09 09:33:16,251 [INFO]: 	nb vectors: 4835
2025-03-09 09:33:16,251 [INFO]: 	vectors dimension: 49152
2025-03-09 09:33:16,251 [INFO]: 	compression ratio: 0.9993086308347578
2025-03-09 09:33:16,251 [INFO]: }
2025-03-09 09:33:16,251 [INFO]: 	>>> Finished "Creating the index" in 73.4397 secs
2025-03-09 09:33:16,251 [INFO]: >>> Finished "Launching the whole pipeline" in 73.4712 secs
2025-03-09 09:33:17: [retrieval_preprocessing] calculating distances ...
2025-03-09 09:33:18: [retrieval_preprocessing] finished and saved retrieval indices for episode 44078 [episode count 12/20]
[retrieval_preprocessing] for episode 67631 [episode count 13/20], we have num_retrieval=np.int64(4940) num_query=np.int64(172)
2025-03-09 09:33:20,477 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-09 09:33:21,101 [INFO]: Launching the whole pipeline 03/09/2025, 09:33:21
2025-03-09 09:33:21,101 [INFO]: Reading total number of vectors and dimension 03/09/2025, 09:33:21
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1400.44it/s]
2025-03-09 09:33:21,132 [INFO]: There are 4940 embeddings of dim 49152
2025-03-09 09:33:21,132 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0313 secs
2025-03-09 09:33:21,132 [INFO]: 	Compute estimated construction time of the index 03/09/2025, 09:33:21
2025-03-09 09:33:21,132 [INFO]: 		-> Train: 16.7 minutes
2025-03-09 09:33:21,132 [INFO]: 		-> Add: 2.7 seconds
2025-03-09 09:33:21,132 [INFO]: 		Total: 16.7 minutes
2025-03-09 09:33:21,132 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0001 secs
2025-03-09 09:33:21,132 [INFO]: 	Checking that your have enough memory available to create the index 03/09/2025, 09:33:21
2025-03-09 09:33:21,133 [INFO]: 1019.5MB of memory will be needed to build the index (more might be used if you have more)
2025-03-09 09:33:21,133 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0002 secs
2025-03-09 09:33:21,133 [INFO]: 	Selecting most promising index types given data characteristics 03/09/2025, 09:33:21
2025-03-09 09:33:21,133 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-09 09:33:21,133 [INFO]: 	Creating the index 03/09/2025, 09:33:21
2025-03-09 09:33:21,133 [INFO]: 		-> Instanciate the index HNSW15 03/09/2025, 09:33:21
2025-03-09 09:33:21,134 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0013 secs
2025-03-09 09:33:21,134 [INFO]: 		-> Adding the vectors to the index 03/09/2025, 09:33:21
2025-03-09 09:33:21,134 [INFO]: The memory available for adding the vectors is 49.1GB(total available - used by the index)
2025-03-09 09:33:21,134 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/20 [00:00<?, ?it/s]  5%|▌         | 1/20 [00:00<00:03,  5.94it/s] 15%|█▌        | 3/20 [00:00<00:01, 10.08it/s] 25%|██▌       | 5/20 [00:00<00:01, 12.63it/s] 40%|████      | 8/20 [00:00<00:00, 17.04it/s] 60%|██████    | 12/20 [00:00<00:00, 23.59it/s] 85%|████████▌ | 17/20 [00:00<00:00, 30.14it/s]100%|██████████| 20/20 [00:04<00:00,  4.41it/s]
2025-03-09 09:33:25,672 [INFO]: 	Computing best hyperparameters for index knn.index 03/09/2025, 09:33:25
2025-03-09 09:34:11,359 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 45.6865 secs
2025-03-09 09:34:11,360 [INFO]: The best hyperparameters are: efSearch=275
2025-03-09 09:34:11,360 [INFO]: 	Compute fast metrics 03/09/2025, 09:34:11
  0%|          | 0/4 [00:00<?, ?it/s] 50%|█████     | 2/4 [00:00<00:00, 18.00it/s] 75%|███████▌  | 3/4 [00:00<00:00, 19.78it/s]
2025-03-09 09:34:34,492 [INFO]: 	>>> Finished "Compute fast metrics" in 23.1325 secs
2025-03-09 09:34:34,495 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 73.3610 secs
2025-03-09 09:34:34,495 [INFO]: {
2025-03-09 09:34:34,495 [INFO]: 	index_key: HNSW15
2025-03-09 09:34:34,495 [INFO]: 	index_param: efSearch=275
2025-03-09 09:34:34,495 [INFO]: 	index_path: knn.index
2025-03-09 09:34:34,495 [INFO]: 	size in bytes: 971915470
2025-03-09 09:34:34,495 [INFO]: 	avg_search_speed_ms: 12.439082163230827
2025-03-09 09:34:34,495 [INFO]: 	99p_search_speed_ms: 26.40911815920846
2025-03-09 09:34:34,496 [INFO]: 	reconstruction error %: 0.0
2025-03-09 09:34:34,496 [INFO]: 	nb vectors: 4940
2025-03-09 09:34:34,496 [INFO]: 	vectors dimension: 49152
2025-03-09 09:34:34,496 [INFO]: 	compression ratio: 0.9993086332909178
2025-03-09 09:34:34,496 [INFO]: }
2025-03-09 09:34:34,496 [INFO]: 	>>> Finished "Creating the index" in 73.3629 secs
2025-03-09 09:34:34,496 [INFO]: >>> Finished "Launching the whole pipeline" in 73.3948 secs
2025-03-09 09:34:35: [retrieval_preprocessing] calculating distances ...
2025-03-09 09:34:36: [retrieval_preprocessing] finished and saved retrieval indices for episode 67631 [episode count 13/20]
[retrieval_preprocessing] for episode 86063 [episode count 14/20], we have num_retrieval=np.int64(4927) num_query=np.int64(185)
2025-03-09 09:34:37,012 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-09 09:34:37,924 [INFO]: Launching the whole pipeline 03/09/2025, 09:34:37
2025-03-09 09:34:37,925 [INFO]: Reading total number of vectors and dimension 03/09/2025, 09:34:37
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 958.04it/s]
2025-03-09 09:34:37,963 [INFO]: There are 4927 embeddings of dim 49152
2025-03-09 09:34:37,963 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0384 secs
2025-03-09 09:34:37,963 [INFO]: 	Compute estimated construction time of the index 03/09/2025, 09:34:37
2025-03-09 09:34:37,963 [INFO]: 		-> Train: 16.7 minutes
2025-03-09 09:34:37,963 [INFO]: 		-> Add: 2.7 seconds
2025-03-09 09:34:37,963 [INFO]: 		Total: 16.7 minutes
2025-03-09 09:34:37,963 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0001 secs
2025-03-09 09:34:37,963 [INFO]: 	Checking that your have enough memory available to create the index 03/09/2025, 09:34:37
2025-03-09 09:34:37,963 [INFO]: 1016.8MB of memory will be needed to build the index (more might be used if you have more)
2025-03-09 09:34:37,964 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0002 secs
2025-03-09 09:34:37,964 [INFO]: 	Selecting most promising index types given data characteristics 03/09/2025, 09:34:37
2025-03-09 09:34:37,964 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-09 09:34:37,964 [INFO]: 	Creating the index 03/09/2025, 09:34:37
2025-03-09 09:34:37,964 [INFO]: 		-> Instanciate the index HNSW15 03/09/2025, 09:34:37
2025-03-09 09:34:37,965 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0014 secs
2025-03-09 09:34:37,965 [INFO]: 		-> Adding the vectors to the index 03/09/2025, 09:34:37
2025-03-09 09:34:37,965 [INFO]: The memory available for adding the vectors is 49.1GB(total available - used by the index)
2025-03-09 09:34:37,965 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/20 [00:00<?, ?it/s]  5%|▌         | 1/20 [00:00<00:02,  8.94it/s] 30%|███       | 6/20 [00:00<00:00, 30.34it/s] 55%|█████▌    | 11/20 [00:00<00:00, 38.78it/s] 80%|████████  | 16/20 [00:00<00:00, 42.79it/s]100%|██████████| 20/20 [00:04<00:00,  4.50it/s]
2025-03-09 09:34:42,412 [INFO]: 	Computing best hyperparameters for index knn.index 03/09/2025, 09:34:42
2025-03-09 09:35:31,739 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 49.3263 secs
2025-03-09 09:35:31,739 [INFO]: The best hyperparameters are: efSearch=222
2025-03-09 09:35:31,739 [INFO]: 	Compute fast metrics 03/09/2025, 09:35:31
  0%|          | 0/4 [00:00<?, ?it/s] 50%|█████     | 2/4 [00:00<00:00, 18.70it/s] 75%|███████▌  | 3/4 [00:00<00:00, 20.35it/s]
2025-03-09 09:35:48,416 [INFO]: 	>>> Finished "Compute fast metrics" in 16.6767 secs
2025-03-09 09:35:48,418 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 70.4531 secs
2025-03-09 09:35:48,419 [INFO]: {
2025-03-09 09:35:48,419 [INFO]: 	index_key: HNSW15
2025-03-09 09:35:48,419 [INFO]: 	index_param: efSearch=222
2025-03-09 09:35:48,419 [INFO]: 	index_path: knn.index
2025-03-09 09:35:48,419 [INFO]: 	size in bytes: 969357730
2025-03-09 09:35:48,419 [INFO]: 	avg_search_speed_ms: 10.57470184982209
2025-03-09 09:35:48,419 [INFO]: 	99p_search_speed_ms: 17.353824700694524
2025-03-09 09:35:48,419 [INFO]: 	reconstruction error %: 0.0
2025-03-09 09:35:48,419 [INFO]: 	nb vectors: 4927
2025-03-09 09:35:48,419 [INFO]: 	vectors dimension: 49152
2025-03-09 09:35:48,419 [INFO]: 	compression ratio: 0.9993087030935421
2025-03-09 09:35:48,419 [INFO]: }
2025-03-09 09:35:48,419 [INFO]: 	>>> Finished "Creating the index" in 70.4550 secs
2025-03-09 09:35:48,419 [INFO]: >>> Finished "Launching the whole pipeline" in 70.4941 secs
2025-03-09 09:35:49: [retrieval_preprocessing] calculating distances ...
2025-03-09 09:35:50: [retrieval_preprocessing] finished and saved retrieval indices for episode 86063 [episode count 14/20]
[retrieval_preprocessing] for episode 35892 [episode count 15/20], we have num_retrieval=np.int64(4946) num_query=np.int64(166)
2025-03-09 09:35:51,118 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-09 09:35:52,657 [INFO]: Launching the whole pipeline 03/09/2025, 09:35:52
2025-03-09 09:35:52,657 [INFO]: Reading total number of vectors and dimension 03/09/2025, 09:35:52
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 2343.19it/s]
2025-03-09 09:35:52,688 [INFO]: There are 4946 embeddings of dim 49152
2025-03-09 09:35:52,688 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0310 secs
2025-03-09 09:35:52,688 [INFO]: 	Compute estimated construction time of the index 03/09/2025, 09:35:52
2025-03-09 09:35:52,688 [INFO]: 		-> Train: 16.7 minutes
2025-03-09 09:35:52,688 [INFO]: 		-> Add: 2.7 seconds
2025-03-09 09:35:52,688 [INFO]: 		Total: 16.7 minutes
2025-03-09 09:35:52,688 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0002 secs
2025-03-09 09:35:52,688 [INFO]: 	Checking that your have enough memory available to create the index 03/09/2025, 09:35:52
2025-03-09 09:35:52,689 [INFO]: 1020.7MB of memory will be needed to build the index (more might be used if you have more)
2025-03-09 09:35:52,689 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0002 secs
2025-03-09 09:35:52,689 [INFO]: 	Selecting most promising index types given data characteristics 03/09/2025, 09:35:52
2025-03-09 09:35:52,689 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-09 09:35:52,689 [INFO]: 	Creating the index 03/09/2025, 09:35:52
2025-03-09 09:35:52,689 [INFO]: 		-> Instanciate the index HNSW15 03/09/2025, 09:35:52
2025-03-09 09:35:52,690 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0012 secs
2025-03-09 09:35:52,690 [INFO]: 		-> Adding the vectors to the index 03/09/2025, 09:35:52
2025-03-09 09:35:52,690 [INFO]: The memory available for adding the vectors is 49.1GB(total available - used by the index)
2025-03-09 09:35:52,690 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/20 [00:00<?, ?it/s]  5%|▌         | 1/20 [00:00<00:02,  8.23it/s] 30%|███       | 6/20 [00:00<00:00, 28.73it/s] 55%|█████▌    | 11/20 [00:00<00:00, 36.67it/s] 80%|████████  | 16/20 [00:00<00:00, 38.54it/s]100%|██████████| 20/20 [00:04<00:00,  2.67it/s]100%|██████████| 20/20 [00:04<00:00,  4.24it/s]
2025-03-09 09:35:57,415 [INFO]: 	Computing best hyperparameters for index knn.index 03/09/2025, 09:35:57
2025-03-09 09:36:49,168 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 51.7526 secs
2025-03-09 09:36:49,169 [INFO]: The best hyperparameters are: efSearch=211
2025-03-09 09:36:49,169 [INFO]: 	Compute fast metrics 03/09/2025, 09:36:49
  0%|          | 0/4 [00:00<?, ?it/s] 50%|█████     | 2/4 [00:00<00:00, 16.58it/s] 75%|███████▌  | 3/4 [00:00<00:00, 18.25it/s]
2025-03-09 09:37:04,710 [INFO]: 	>>> Finished "Compute fast metrics" in 15.5412 secs
2025-03-09 09:37:04,713 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 72.0224 secs
2025-03-09 09:37:04,713 [INFO]: {
2025-03-09 09:37:04,713 [INFO]: 	index_key: HNSW15
2025-03-09 09:37:04,713 [INFO]: 	index_param: efSearch=211
2025-03-09 09:37:04,713 [INFO]: 	index_path: knn.index
2025-03-09 09:37:04,713 [INFO]: 	size in bytes: 973095910
2025-03-09 09:37:04,713 [INFO]: 	avg_search_speed_ms: 9.705390037462404
2025-03-09 09:37:04,713 [INFO]: 	99p_search_speed_ms: 19.24021710874517
2025-03-09 09:37:04,713 [INFO]: 	reconstruction error %: 0.0
2025-03-09 09:37:04,713 [INFO]: 	nb vectors: 4946
2025-03-09 09:37:04,713 [INFO]: 	vectors dimension: 49152
2025-03-09 09:37:04,713 [INFO]: 	compression ratio: 0.9993086580746188
2025-03-09 09:37:04,713 [INFO]: }
2025-03-09 09:37:04,713 [INFO]: 	>>> Finished "Creating the index" in 72.0242 secs
2025-03-09 09:37:04,713 [INFO]: >>> Finished "Launching the whole pipeline" in 72.0562 secs
2025-03-09 09:37:05: [retrieval_preprocessing] calculating distances ...
2025-03-09 09:37:06: [retrieval_preprocessing] finished and saved retrieval indices for episode 35892 [episode count 15/20]
[retrieval_preprocessing] for episode 87606 [episode count 16/20], we have num_retrieval=np.int64(4727) num_query=np.int64(385)
2025-03-09 09:37:06,456 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-09 09:37:07,062 [INFO]: Launching the whole pipeline 03/09/2025, 09:37:07
2025-03-09 09:37:07,063 [INFO]: Reading total number of vectors and dimension 03/09/2025, 09:37:07
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1935.53it/s]
2025-03-09 09:37:07,091 [INFO]: There are 4727 embeddings of dim 49152
2025-03-09 09:37:07,091 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0286 secs
2025-03-09 09:37:07,091 [INFO]: 	Compute estimated construction time of the index 03/09/2025, 09:37:07
2025-03-09 09:37:07,091 [INFO]: 		-> Train: 16.7 minutes
2025-03-09 09:37:07,091 [INFO]: 		-> Add: 2.6 seconds
2025-03-09 09:37:07,091 [INFO]: 		Total: 16.7 minutes
2025-03-09 09:37:07,091 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0001 secs
2025-03-09 09:37:07,091 [INFO]: 	Checking that your have enough memory available to create the index 03/09/2025, 09:37:07
2025-03-09 09:37:07,092 [INFO]: 975.5MB of memory will be needed to build the index (more might be used if you have more)
2025-03-09 09:37:07,092 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0001 secs
2025-03-09 09:37:07,092 [INFO]: 	Selecting most promising index types given data characteristics 03/09/2025, 09:37:07
2025-03-09 09:37:07,092 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-09 09:37:07,092 [INFO]: 	Creating the index 03/09/2025, 09:37:07
2025-03-09 09:37:07,092 [INFO]: 		-> Instanciate the index HNSW15 03/09/2025, 09:37:07
2025-03-09 09:37:07,093 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0010 secs
2025-03-09 09:37:07,093 [INFO]: 		-> Adding the vectors to the index 03/09/2025, 09:37:07
2025-03-09 09:37:07,093 [INFO]: The memory available for adding the vectors is 49.1GB(total available - used by the index)
2025-03-09 09:37:07,093 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/19 [00:00<?, ?it/s]  5%|▌         | 1/19 [00:00<00:02,  7.88it/s] 32%|███▏      | 6/19 [00:00<00:00, 29.83it/s] 63%|██████▎   | 12/19 [00:00<00:00, 40.02it/s] 95%|█████████▍| 18/19 [00:00<00:00, 44.98it/s]100%|██████████| 19/19 [00:04<00:00,  4.52it/s]
2025-03-09 09:37:11,299 [INFO]: 	Computing best hyperparameters for index knn.index 03/09/2025, 09:37:11
2025-03-09 09:37:59,190 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 47.8899 secs
2025-03-09 09:37:59,190 [INFO]: The best hyperparameters are: efSearch=255
2025-03-09 09:37:59,190 [INFO]: 	Compute fast metrics 03/09/2025, 09:37:59
  0%|          | 0/4 [00:00<?, ?it/s] 50%|█████     | 2/4 [00:00<00:00, 17.59it/s] 75%|███████▌  | 3/4 [00:00<00:00, 19.37it/s]
2025-03-09 09:38:18,629 [INFO]: 	>>> Finished "Compute fast metrics" in 19.4385 secs
2025-03-09 09:38:18,632 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 71.5388 secs
2025-03-09 09:38:18,632 [INFO]: {
2025-03-09 09:38:18,632 [INFO]: 	index_key: HNSW15
2025-03-09 09:38:18,632 [INFO]: 	index_param: efSearch=255
2025-03-09 09:38:18,632 [INFO]: 	index_path: knn.index
2025-03-09 09:38:18,632 [INFO]: 	size in bytes: 930008950
2025-03-09 09:38:18,632 [INFO]: 	avg_search_speed_ms: 11.786106234854635
2025-03-09 09:38:18,632 [INFO]: 	99p_search_speed_ms: 23.58972968067974
2025-03-09 09:38:18,632 [INFO]: 	reconstruction error %: 0.0
2025-03-09 09:38:18,632 [INFO]: 	nb vectors: 4727
2025-03-09 09:38:18,632 [INFO]: 	vectors dimension: 49152
2025-03-09 09:38:18,632 [INFO]: 	compression ratio: 0.9993086797713076
2025-03-09 09:38:18,632 [INFO]: }
2025-03-09 09:38:18,632 [INFO]: 	>>> Finished "Creating the index" in 71.5405 secs
2025-03-09 09:38:18,632 [INFO]: >>> Finished "Launching the whole pipeline" in 71.5696 secs
2025-03-09 09:38:21: [retrieval_preprocessing] calculating distances ...
2025-03-09 09:38:23: [retrieval_preprocessing] finished and saved retrieval indices for episode 87606 [episode count 16/20]
[retrieval_preprocessing] for episode 23612 [episode count 17/20], we have num_retrieval=np.int64(4735) num_query=np.int64(377)
2025-03-09 09:38:23,862 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-09 09:38:25,342 [INFO]: Launching the whole pipeline 03/09/2025, 09:38:25
2025-03-09 09:38:25,342 [INFO]: Reading total number of vectors and dimension 03/09/2025, 09:38:25
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1156.09it/s]
2025-03-09 09:38:25,376 [INFO]: There are 4735 embeddings of dim 49152
2025-03-09 09:38:25,376 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0346 secs
2025-03-09 09:38:25,377 [INFO]: 	Compute estimated construction time of the index 03/09/2025, 09:38:25
2025-03-09 09:38:25,377 [INFO]: 		-> Train: 16.7 minutes
2025-03-09 09:38:25,377 [INFO]: 		-> Add: 2.6 seconds
2025-03-09 09:38:25,377 [INFO]: 		Total: 16.7 minutes
2025-03-09 09:38:25,377 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0001 secs
2025-03-09 09:38:25,377 [INFO]: 	Checking that your have enough memory available to create the index 03/09/2025, 09:38:25
2025-03-09 09:38:25,377 [INFO]: 977.2MB of memory will be needed to build the index (more might be used if you have more)
2025-03-09 09:38:25,377 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0002 secs
2025-03-09 09:38:25,377 [INFO]: 	Selecting most promising index types given data characteristics 03/09/2025, 09:38:25
2025-03-09 09:38:25,377 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-09 09:38:25,377 [INFO]: 	Creating the index 03/09/2025, 09:38:25
2025-03-09 09:38:25,377 [INFO]: 		-> Instanciate the index HNSW15 03/09/2025, 09:38:25
2025-03-09 09:38:25,378 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0011 secs
2025-03-09 09:38:25,378 [INFO]: 		-> Adding the vectors to the index 03/09/2025, 09:38:25
2025-03-09 09:38:25,379 [INFO]: The memory available for adding the vectors is 49.1GB(total available - used by the index)
2025-03-09 09:38:25,379 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/19 [00:00<?, ?it/s]  5%|▌         | 1/19 [00:00<00:02,  6.48it/s] 37%|███▋      | 7/19 [00:00<00:00, 29.88it/s] 63%|██████▎   | 12/19 [00:00<00:00, 37.55it/s] 89%|████████▉ | 17/19 [00:00<00:00, 41.18it/s]100%|██████████| 19/19 [00:04<00:00,  4.46it/s]
2025-03-09 09:38:29,647 [INFO]: 	Computing best hyperparameters for index knn.index 03/09/2025, 09:38:29
2025-03-09 09:39:11,105 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 41.4572 secs
2025-03-09 09:39:11,105 [INFO]: The best hyperparameters are: efSearch=246
2025-03-09 09:39:11,105 [INFO]: 	Compute fast metrics 03/09/2025, 09:39:11
  0%|          | 0/4 [00:00<?, ?it/s] 50%|█████     | 2/4 [00:00<00:00, 17.07it/s] 75%|███████▌  | 3/4 [00:00<00:00, 18.49it/s]
2025-03-09 09:39:30,486 [INFO]: 	>>> Finished "Compute fast metrics" in 19.3803 secs
2025-03-09 09:39:30,488 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 65.1097 secs
2025-03-09 09:39:30,488 [INFO]: {
2025-03-09 09:39:30,488 [INFO]: 	index_key: HNSW15
2025-03-09 09:39:30,488 [INFO]: 	index_param: efSearch=246
2025-03-09 09:39:30,488 [INFO]: 	index_path: knn.index
2025-03-09 09:39:30,488 [INFO]: 	size in bytes: 931582870
2025-03-09 09:39:30,489 [INFO]: 	avg_search_speed_ms: 10.78999453744657
2025-03-09 09:39:30,489 [INFO]: 	99p_search_speed_ms: 19.76556329522282
2025-03-09 09:39:30,489 [INFO]: 	reconstruction error %: 0.0
2025-03-09 09:39:30,489 [INFO]: 	nb vectors: 4735
2025-03-09 09:39:30,489 [INFO]: 	vectors dimension: 49152
2025-03-09 09:39:30,489 [INFO]: 	compression ratio: 0.9993087142102559
2025-03-09 09:39:30,489 [INFO]: }
2025-03-09 09:39:30,489 [INFO]: 	>>> Finished "Creating the index" in 65.1114 secs
2025-03-09 09:39:30,489 [INFO]: >>> Finished "Launching the whole pipeline" in 65.1468 secs
2025-03-09 09:39:33: [retrieval_preprocessing] calculating distances ...
2025-03-09 09:39:34: [retrieval_preprocessing] finished and saved retrieval indices for episode 23612 [episode count 17/20]
[retrieval_preprocessing] for episode 57921 [episode count 18/20], we have num_retrieval=np.int64(4800) num_query=np.int64(312)
2025-03-09 09:39:35,108 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-09 09:39:35,898 [INFO]: Launching the whole pipeline 03/09/2025, 09:39:35
2025-03-09 09:39:35,898 [INFO]: Reading total number of vectors and dimension 03/09/2025, 09:39:35
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 913.19it/s]
2025-03-09 09:39:35,930 [INFO]: There are 4800 embeddings of dim 49152
2025-03-09 09:39:35,930 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0326 secs
2025-03-09 09:39:35,931 [INFO]: 	Compute estimated construction time of the index 03/09/2025, 09:39:35
2025-03-09 09:39:35,931 [INFO]: 		-> Train: 16.7 minutes
2025-03-09 09:39:35,931 [INFO]: 		-> Add: 2.6 seconds
2025-03-09 09:39:35,931 [INFO]: 		Total: 16.7 minutes
2025-03-09 09:39:35,931 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0001 secs
2025-03-09 09:39:35,931 [INFO]: 	Checking that your have enough memory available to create the index 03/09/2025, 09:39:35
2025-03-09 09:39:35,931 [INFO]: 990.6MB of memory will be needed to build the index (more might be used if you have more)
2025-03-09 09:39:35,931 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0002 secs
2025-03-09 09:39:35,931 [INFO]: 	Selecting most promising index types given data characteristics 03/09/2025, 09:39:35
2025-03-09 09:39:35,931 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-09 09:39:35,931 [INFO]: 	Creating the index 03/09/2025, 09:39:35
2025-03-09 09:39:35,931 [INFO]: 		-> Instanciate the index HNSW15 03/09/2025, 09:39:35
2025-03-09 09:39:35,933 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0013 secs
2025-03-09 09:39:35,933 [INFO]: 		-> Adding the vectors to the index 03/09/2025, 09:39:35
2025-03-09 09:39:35,933 [INFO]: The memory available for adding the vectors is 49.1GB(total available - used by the index)
2025-03-09 09:39:35,933 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/19 [00:00<?, ?it/s]  5%|▌         | 1/19 [00:00<00:01,  9.14it/s] 32%|███▏      | 6/19 [00:00<00:00, 30.33it/s] 58%|█████▊    | 11/19 [00:00<00:00, 36.89it/s] 84%|████████▍ | 16/19 [00:00<00:00, 39.56it/s]100%|██████████| 19/19 [00:03<00:00,  4.90it/s]
2025-03-09 09:39:39,810 [INFO]: 	Computing best hyperparameters for index knn.index 03/09/2025, 09:39:39
2025-03-09 09:40:28,662 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 48.8509 secs
2025-03-09 09:40:28,662 [INFO]: The best hyperparameters are: efSearch=227
2025-03-09 09:40:28,662 [INFO]: 	Compute fast metrics 03/09/2025, 09:40:28
  0%|          | 0/4 [00:00<?, ?it/s] 25%|██▌       | 1/4 [00:00<00:00,  8.87it/s] 75%|███████▌  | 3/4 [00:00<00:00, 17.21it/s]
2025-03-09 09:40:44,712 [INFO]: 	>>> Finished "Compute fast metrics" in 16.0497 secs
2025-03-09 09:40:44,715 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 68.7817 secs
2025-03-09 09:40:44,715 [INFO]: {
2025-03-09 09:40:44,715 [INFO]: 	index_key: HNSW15
2025-03-09 09:40:44,715 [INFO]: 	index_param: efSearch=227
2025-03-09 09:40:44,715 [INFO]: 	index_path: knn.index
2025-03-09 09:40:44,715 [INFO]: 	size in bytes: 944371270
2025-03-09 09:40:44,715 [INFO]: 	avg_search_speed_ms: 11.946181874619874
2025-03-09 09:40:44,715 [INFO]: 	99p_search_speed_ms: 21.186527376994484
2025-03-09 09:40:44,715 [INFO]: 	reconstruction error %: 0.0
2025-03-09 09:40:44,715 [INFO]: 	nb vectors: 4800
2025-03-09 09:40:44,715 [INFO]: 	vectors dimension: 49152
2025-03-09 09:40:44,715 [INFO]: 	compression ratio: 0.9993086723190976
2025-03-09 09:40:44,715 [INFO]: }
2025-03-09 09:40:44,715 [INFO]: 	>>> Finished "Creating the index" in 68.7836 secs
2025-03-09 09:40:44,715 [INFO]: >>> Finished "Launching the whole pipeline" in 68.8172 secs
2025-03-09 09:40:46: [retrieval_preprocessing] calculating distances ...
2025-03-09 09:40:47: [retrieval_preprocessing] finished and saved retrieval indices for episode 57921 [episode count 18/20]
[retrieval_preprocessing] for episode 68166 [episode count 19/20], we have num_retrieval=np.int64(4871) num_query=np.int64(241)
2025-03-09 09:40:48,060 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-09 09:40:48,746 [INFO]: Launching the whole pipeline 03/09/2025, 09:40:48
2025-03-09 09:40:48,746 [INFO]: Reading total number of vectors and dimension 03/09/2025, 09:40:48
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1450.81it/s]
2025-03-09 09:40:48,775 [INFO]: There are 4871 embeddings of dim 49152
2025-03-09 09:40:48,775 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0295 secs
2025-03-09 09:40:48,775 [INFO]: 	Compute estimated construction time of the index 03/09/2025, 09:40:48
2025-03-09 09:40:48,775 [INFO]: 		-> Train: 16.7 minutes
2025-03-09 09:40:48,775 [INFO]: 		-> Add: 2.7 seconds
2025-03-09 09:40:48,775 [INFO]: 		Total: 16.7 minutes
2025-03-09 09:40:48,775 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0001 secs
2025-03-09 09:40:48,775 [INFO]: 	Checking that your have enough memory available to create the index 03/09/2025, 09:40:48
2025-03-09 09:40:48,776 [INFO]: 1005.3MB of memory will be needed to build the index (more might be used if you have more)
2025-03-09 09:40:48,776 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0002 secs
2025-03-09 09:40:48,776 [INFO]: 	Selecting most promising index types given data characteristics 03/09/2025, 09:40:48
2025-03-09 09:40:48,776 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-09 09:40:48,776 [INFO]: 	Creating the index 03/09/2025, 09:40:48
2025-03-09 09:40:48,776 [INFO]: 		-> Instanciate the index HNSW15 03/09/2025, 09:40:48
2025-03-09 09:40:48,777 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0009 secs
2025-03-09 09:40:48,777 [INFO]: 		-> Adding the vectors to the index 03/09/2025, 09:40:48
2025-03-09 09:40:48,777 [INFO]: The memory available for adding the vectors is 49.1GB(total available - used by the index)
2025-03-09 09:40:48,777 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/20 [00:00<?, ?it/s]  5%|▌         | 1/20 [00:00<00:02,  7.55it/s] 30%|███       | 6/20 [00:00<00:00, 28.50it/s] 60%|██████    | 12/20 [00:00<00:00, 38.89it/s] 90%|█████████ | 18/20 [00:00<00:00, 43.34it/s]100%|██████████| 20/20 [00:04<00:00,  4.87it/s]
2025-03-09 09:40:52,887 [INFO]: 	Computing best hyperparameters for index knn.index 03/09/2025, 09:40:52
2025-03-09 09:41:38,696 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 45.8084 secs
2025-03-09 09:41:38,696 [INFO]: The best hyperparameters are: efSearch=236
2025-03-09 09:41:38,696 [INFO]: 	Compute fast metrics 03/09/2025, 09:41:38
  0%|          | 0/4 [00:00<?, ?it/s] 50%|█████     | 2/4 [00:00<00:00, 18.97it/s] 75%|███████▌  | 3/4 [00:00<00:00, 20.57it/s]
2025-03-09 09:41:59,909 [INFO]: 	>>> Finished "Compute fast metrics" in 21.2129 secs
2025-03-09 09:41:59,912 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 71.1350 secs
2025-03-09 09:41:59,912 [INFO]: {
2025-03-09 09:41:59,912 [INFO]: 	index_key: HNSW15
2025-03-09 09:41:59,912 [INFO]: 	index_param: efSearch=236
2025-03-09 09:41:59,912 [INFO]: 	index_path: knn.index
2025-03-09 09:41:59,912 [INFO]: 	size in bytes: 958340050
2025-03-09 09:41:59,912 [INFO]: 	avg_search_speed_ms: 10.429724807655818
2025-03-09 09:41:59,912 [INFO]: 	99p_search_speed_ms: 24.062637961469573
2025-03-09 09:41:59,912 [INFO]: 	reconstruction error %: 0.0
2025-03-09 09:41:59,912 [INFO]: 	nb vectors: 4871
2025-03-09 09:41:59,912 [INFO]: 	vectors dimension: 49152
2025-03-09 09:41:59,912 [INFO]: 	compression ratio: 0.9993087192797588
2025-03-09 09:41:59,912 [INFO]: }
2025-03-09 09:41:59,912 [INFO]: 	>>> Finished "Creating the index" in 71.1363 secs
2025-03-09 09:41:59,912 [INFO]: >>> Finished "Launching the whole pipeline" in 71.1665 secs
2025-03-09 09:42:01: [retrieval_preprocessing] calculating distances ...
2025-03-09 09:42:02: [retrieval_preprocessing] finished and saved retrieval indices for episode 68166 [episode count 19/20]
2025-03-09 09:42:02: [retrieval_preprocessing] finished for (446878712, 'marker') [chosen_id count 7/10]
2025-03-09 09:42:03: [retrieval_preprocessing] concatenated all embeddings and indices for 20 episodes for (6093644330, 'cloth') [chosen_id count 8/10]
2025-03-09 09:42:03: [retrieval_preprocessing] we have num_total=6682 embedding_dim=49152
[retrieval_preprocessing] for episode 1029 [episode count 0/20], we have num_retrieval=np.int64(6354) num_query=np.int64(328)
2025-03-09 09:42:04,218 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-09 09:42:04,984 [INFO]: Launching the whole pipeline 03/09/2025, 09:42:04
2025-03-09 09:42:04,984 [INFO]: Reading total number of vectors and dimension 03/09/2025, 09:42:04
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 860.02it/s]
2025-03-09 09:42:05,015 [INFO]: There are 6354 embeddings of dim 49152
2025-03-09 09:42:05,016 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0312 secs
2025-03-09 09:42:05,016 [INFO]: 	Compute estimated construction time of the index 03/09/2025, 09:42:05
2025-03-09 09:42:05,016 [INFO]: 		-> Train: 16.7 minutes
2025-03-09 09:42:05,016 [INFO]: 		-> Add: 3.5 seconds
2025-03-09 09:42:05,016 [INFO]: 		Total: 16.7 minutes
2025-03-09 09:42:05,016 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0004 secs
2025-03-09 09:42:05,016 [INFO]: 	Checking that your have enough memory available to create the index 03/09/2025, 09:42:05
2025-03-09 09:42:05,017 [INFO]: 1.3GB of memory will be needed to build the index (more might be used if you have more)
2025-03-09 09:42:05,017 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0005 secs
2025-03-09 09:42:05,017 [INFO]: 	Selecting most promising index types given data characteristics 03/09/2025, 09:42:05
2025-03-09 09:42:05,017 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-09 09:42:05,017 [INFO]: 	Creating the index 03/09/2025, 09:42:05
2025-03-09 09:42:05,017 [INFO]: 		-> Instanciate the index HNSW15 03/09/2025, 09:42:05
2025-03-09 09:42:05,020 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0031 secs
2025-03-09 09:42:05,021 [INFO]: 		-> Adding the vectors to the index 03/09/2025, 09:42:05
2025-03-09 09:42:05,021 [INFO]: The memory available for adding the vectors is 48.8GB(total available - used by the index)
2025-03-09 09:42:05,021 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/26 [00:00<?, ?it/s]  4%|▍         | 1/26 [00:00<00:02,  9.45it/s] 27%|██▋       | 7/26 [00:00<00:00, 36.53it/s] 50%|█████     | 13/26 [00:00<00:00, 45.43it/s] 73%|███████▎  | 19/26 [00:00<00:00, 48.64it/s] 92%|█████████▏| 24/26 [00:04<00:00,  3.09it/s]100%|██████████| 26/26 [00:06<00:00,  3.82it/s]
2025-03-09 09:42:11,828 [INFO]: 	Computing best hyperparameters for index knn.index 03/09/2025, 09:42:11
2025-03-09 09:42:59,040 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 47.2122 secs
2025-03-09 09:42:59,041 [INFO]: The best hyperparameters are: efSearch=192
2025-03-09 09:42:59,041 [INFO]: 	Compute fast metrics 03/09/2025, 09:42:59
  0%|          | 0/4 [00:00<?, ?it/s] 50%|█████     | 2/4 [00:00<00:00, 17.38it/s] 75%|███████▌  | 3/4 [00:00<00:00, 19.62it/s]
2025-03-09 09:43:19,439 [INFO]: 	>>> Finished "Compute fast metrics" in 20.3988 secs
2025-03-09 09:43:19,440 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 74.4196 secs
2025-03-09 09:43:19,441 [INFO]: {
2025-03-09 09:43:19,441 [INFO]: 	index_key: HNSW15
2025-03-09 09:43:19,441 [INFO]: 	index_param: efSearch=192
2025-03-09 09:43:19,441 [INFO]: 	index_path: knn.index
2025-03-09 09:43:19,441 [INFO]: 	size in bytes: 1250111770
2025-03-09 09:43:19,441 [INFO]: 	avg_search_speed_ms: 9.271117177359463
2025-03-09 09:43:19,441 [INFO]: 	99p_search_speed_ms: 18.13889460638167
2025-03-09 09:43:19,441 [INFO]: 	reconstruction error %: 0.0
2025-03-09 09:43:19,441 [INFO]: 	nb vectors: 6354
2025-03-09 09:43:19,441 [INFO]: 	vectors dimension: 49152
2025-03-09 09:43:19,441 [INFO]: 	compression ratio: 0.9993084314372946
2025-03-09 09:43:19,441 [INFO]: }
2025-03-09 09:43:19,441 [INFO]: 	>>> Finished "Creating the index" in 74.4235 secs
2025-03-09 09:43:19,441 [INFO]: >>> Finished "Launching the whole pipeline" in 74.4565 secs
2025-03-09 09:43:20: [retrieval_preprocessing] calculating distances ...
2025-03-09 09:43:21: [retrieval_preprocessing] finished and saved retrieval indices for episode 1029 [episode count 0/20]
[retrieval_preprocessing] for episode 95495 [episode count 1/20], we have num_retrieval=np.int64(6368) num_query=np.int64(314)
2025-03-09 09:43:22,401 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-09 09:43:23,221 [INFO]: Launching the whole pipeline 03/09/2025, 09:43:23
2025-03-09 09:43:23,221 [INFO]: Reading total number of vectors and dimension 03/09/2025, 09:43:23
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 2181.13it/s]
2025-03-09 09:43:23,250 [INFO]: There are 6368 embeddings of dim 49152
2025-03-09 09:43:23,250 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0293 secs
2025-03-09 09:43:23,250 [INFO]: 	Compute estimated construction time of the index 03/09/2025, 09:43:23
2025-03-09 09:43:23,250 [INFO]: 		-> Train: 16.7 minutes
2025-03-09 09:43:23,250 [INFO]: 		-> Add: 3.5 seconds
2025-03-09 09:43:23,250 [INFO]: 		Total: 16.7 minutes
2025-03-09 09:43:23,250 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0001 secs
2025-03-09 09:43:23,250 [INFO]: 	Checking that your have enough memory available to create the index 03/09/2025, 09:43:23
2025-03-09 09:43:23,250 [INFO]: 1.3GB of memory will be needed to build the index (more might be used if you have more)
2025-03-09 09:43:23,250 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0001 secs
2025-03-09 09:43:23,250 [INFO]: 	Selecting most promising index types given data characteristics 03/09/2025, 09:43:23
2025-03-09 09:43:23,250 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-09 09:43:23,250 [INFO]: 	Creating the index 03/09/2025, 09:43:23
2025-03-09 09:43:23,251 [INFO]: 		-> Instanciate the index HNSW15 03/09/2025, 09:43:23
2025-03-09 09:43:23,251 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0008 secs
2025-03-09 09:43:23,251 [INFO]: 		-> Adding the vectors to the index 03/09/2025, 09:43:23
2025-03-09 09:43:23,252 [INFO]: The memory available for adding the vectors is 48.8GB(total available - used by the index)
2025-03-09 09:43:23,252 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/27 [00:00<?, ?it/s]  7%|▋         | 2/27 [00:00<00:01, 17.51it/s] 30%|██▉       | 8/27 [00:00<00:00, 39.49it/s] 48%|████▊     | 13/27 [00:00<00:00, 40.96it/s] 70%|███████   | 19/27 [00:00<00:00, 46.73it/s] 89%|████████▉ | 24/27 [00:04<00:00,  3.29it/s]100%|██████████| 27/27 [00:06<00:00,  4.05it/s]
2025-03-09 09:43:29,918 [INFO]: 	Computing best hyperparameters for index knn.index 03/09/2025, 09:43:29
2025-03-09 09:44:16,545 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 46.6265 secs
2025-03-09 09:44:16,545 [INFO]: The best hyperparameters are: efSearch=154
2025-03-09 09:44:16,545 [INFO]: 	Compute fast metrics 03/09/2025, 09:44:16
  0%|          | 0/4 [00:00<?, ?it/s] 25%|██▌       | 1/4 [00:00<00:00,  7.16it/s] 75%|███████▌  | 3/4 [00:00<00:00, 12.83it/s]
2025-03-09 09:44:33,334 [INFO]: 	>>> Finished "Compute fast metrics" in 16.7887 secs
2025-03-09 09:44:33,335 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 70.0835 secs
2025-03-09 09:44:33,335 [INFO]: {
2025-03-09 09:44:33,335 [INFO]: 	index_key: HNSW15
2025-03-09 09:44:33,335 [INFO]: 	index_param: efSearch=154
2025-03-09 09:44:33,335 [INFO]: 	index_path: knn.index
2025-03-09 09:44:33,335 [INFO]: 	size in bytes: 1252866190
2025-03-09 09:44:33,335 [INFO]: 	avg_search_speed_ms: 7.672322879517515
2025-03-09 09:44:33,335 [INFO]: 	99p_search_speed_ms: 17.39957009907813
2025-03-09 09:44:33,335 [INFO]: 	reconstruction error %: 0.0
2025-03-09 09:44:33,335 [INFO]: 	nb vectors: 6368
2025-03-09 09:44:33,335 [INFO]: 	vectors dimension: 49152
2025-03-09 09:44:33,335 [INFO]: 	compression ratio: 0.9993084289392469
2025-03-09 09:44:33,335 [INFO]: }
2025-03-09 09:44:33,335 [INFO]: 	>>> Finished "Creating the index" in 70.0849 secs
2025-03-09 09:44:33,335 [INFO]: >>> Finished "Launching the whole pipeline" in 70.1147 secs
2025-03-09 09:44:34: [retrieval_preprocessing] calculating distances ...
2025-03-09 09:44:35: [retrieval_preprocessing] finished and saved retrieval indices for episode 95495 [episode count 1/20]
[retrieval_preprocessing] for episode 31628 [episode count 2/20], we have num_retrieval=np.int64(6415) num_query=np.int64(267)
2025-03-09 09:44:35,795 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-09 09:44:36,582 [INFO]: Launching the whole pipeline 03/09/2025, 09:44:36
2025-03-09 09:44:36,582 [INFO]: Reading total number of vectors and dimension 03/09/2025, 09:44:36
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1193.94it/s]
2025-03-09 09:44:36,615 [INFO]: There are 6415 embeddings of dim 49152
2025-03-09 09:44:36,615 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0329 secs
2025-03-09 09:44:36,615 [INFO]: 	Compute estimated construction time of the index 03/09/2025, 09:44:36
2025-03-09 09:44:36,615 [INFO]: 		-> Train: 16.7 minutes
2025-03-09 09:44:36,615 [INFO]: 		-> Add: 3.5 seconds
2025-03-09 09:44:36,615 [INFO]: 		Total: 16.7 minutes
2025-03-09 09:44:36,615 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0001 secs
2025-03-09 09:44:36,615 [INFO]: 	Checking that your have enough memory available to create the index 03/09/2025, 09:44:36
2025-03-09 09:44:36,616 [INFO]: 1.3GB of memory will be needed to build the index (more might be used if you have more)
2025-03-09 09:44:36,616 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0002 secs
2025-03-09 09:44:36,616 [INFO]: 	Selecting most promising index types given data characteristics 03/09/2025, 09:44:36
2025-03-09 09:44:36,616 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-09 09:44:36,616 [INFO]: 	Creating the index 03/09/2025, 09:44:36
2025-03-09 09:44:36,616 [INFO]: 		-> Instanciate the index HNSW15 03/09/2025, 09:44:36
2025-03-09 09:44:36,617 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0012 secs
2025-03-09 09:44:36,617 [INFO]: 		-> Adding the vectors to the index 03/09/2025, 09:44:36
2025-03-09 09:44:36,617 [INFO]: The memory available for adding the vectors is 48.8GB(total available - used by the index)
2025-03-09 09:44:36,617 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/27 [00:00<?, ?it/s]  7%|▋         | 2/27 [00:00<00:01, 17.56it/s] 30%|██▉       | 8/27 [00:00<00:00, 39.27it/s] 52%|█████▏    | 14/27 [00:00<00:00, 44.67it/s] 70%|███████   | 19/27 [00:00<00:00, 45.61it/s] 89%|████████▉ | 24/27 [00:03<00:00,  3.87it/s]100%|██████████| 27/27 [00:05<00:00,  2.93it/s]100%|██████████| 27/27 [00:05<00:00,  4.74it/s]
2025-03-09 09:44:42,462 [INFO]: 	Computing best hyperparameters for index knn.index 03/09/2025, 09:44:42
2025-03-09 09:45:33,924 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 51.4617 secs
2025-03-09 09:45:33,924 [INFO]: The best hyperparameters are: efSearch=171
2025-03-09 09:45:33,924 [INFO]: 	Compute fast metrics 03/09/2025, 09:45:33
  0%|          | 0/4 [00:00<?, ?it/s] 50%|█████     | 2/4 [00:00<00:00, 19.20it/s] 75%|███████▌  | 3/4 [00:00<00:00, 20.72it/s]
2025-03-09 09:45:50,921 [INFO]: 	>>> Finished "Compute fast metrics" in 16.9969 secs
2025-03-09 09:45:50,922 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 74.3052 secs
2025-03-09 09:45:50,922 [INFO]: {
2025-03-09 09:45:50,922 [INFO]: 	index_key: HNSW15
2025-03-09 09:45:50,923 [INFO]: 	index_param: efSearch=171
2025-03-09 09:45:50,923 [INFO]: 	index_path: knn.index
2025-03-09 09:45:50,923 [INFO]: 	size in bytes: 1262113210
2025-03-09 09:45:50,923 [INFO]: 	avg_search_speed_ms: 8.75803807504873
2025-03-09 09:45:50,923 [INFO]: 	99p_search_speed_ms: 18.10137724969535
2025-03-09 09:45:50,923 [INFO]: 	reconstruction error %: 0.0
2025-03-09 09:45:50,923 [INFO]: 	nb vectors: 6415
2025-03-09 09:45:50,923 [INFO]: 	vectors dimension: 49152
2025-03-09 09:45:50,923 [INFO]: 	compression ratio: 0.9993083900928349
2025-03-09 09:45:50,923 [INFO]: }
2025-03-09 09:45:50,923 [INFO]: 	>>> Finished "Creating the index" in 74.3072 secs
2025-03-09 09:45:50,923 [INFO]: >>> Finished "Launching the whole pipeline" in 74.3408 secs
2025-03-09 09:45:52: [retrieval_preprocessing] calculating distances ...
2025-03-09 09:45:52: [retrieval_preprocessing] finished and saved retrieval indices for episode 31628 [episode count 2/20]
[retrieval_preprocessing] for episode 61580 [episode count 3/20], we have num_retrieval=np.int64(6390) num_query=np.int64(292)
2025-03-09 09:45:53,379 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-09 09:45:54,235 [INFO]: Launching the whole pipeline 03/09/2025, 09:45:54
2025-03-09 09:45:54,235 [INFO]: Reading total number of vectors and dimension 03/09/2025, 09:45:54
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1343.47it/s]
2025-03-09 09:45:54,271 [INFO]: There are 6390 embeddings of dim 49152
2025-03-09 09:45:54,271 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0357 secs
2025-03-09 09:45:54,271 [INFO]: 	Compute estimated construction time of the index 03/09/2025, 09:45:54
2025-03-09 09:45:54,271 [INFO]: 		-> Train: 16.7 minutes
2025-03-09 09:45:54,271 [INFO]: 		-> Add: 3.5 seconds
2025-03-09 09:45:54,271 [INFO]: 		Total: 16.7 minutes
2025-03-09 09:45:54,271 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0001 secs
2025-03-09 09:45:54,271 [INFO]: 	Checking that your have enough memory available to create the index 03/09/2025, 09:45:54
2025-03-09 09:45:54,271 [INFO]: 1.3GB of memory will be needed to build the index (more might be used if you have more)
2025-03-09 09:45:54,271 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0002 secs
2025-03-09 09:45:54,272 [INFO]: 	Selecting most promising index types given data characteristics 03/09/2025, 09:45:54
2025-03-09 09:45:54,272 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-09 09:45:54,272 [INFO]: 	Creating the index 03/09/2025, 09:45:54
2025-03-09 09:45:54,272 [INFO]: 		-> Instanciate the index HNSW15 03/09/2025, 09:45:54
2025-03-09 09:45:54,273 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0008 secs
2025-03-09 09:45:54,273 [INFO]: 		-> Adding the vectors to the index 03/09/2025, 09:45:54
2025-03-09 09:45:54,273 [INFO]: The memory available for adding the vectors is 48.8GB(total available - used by the index)
2025-03-09 09:45:54,273 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/27 [00:00<?, ?it/s]  4%|▎         | 1/27 [00:00<00:03,  7.38it/s] 19%|█▊        | 5/27 [00:00<00:00, 22.45it/s] 37%|███▋      | 10/27 [00:00<00:00, 32.23it/s] 56%|█████▌    | 15/27 [00:00<00:00, 36.59it/s] 74%|███████▍  | 20/27 [00:00<00:00, 39.03it/s] 89%|████████▉ | 24/27 [00:04<00:00,  3.29it/s]100%|██████████| 27/27 [00:05<00:00,  2.74it/s]100%|██████████| 27/27 [00:05<00:00,  4.58it/s]
2025-03-09 09:46:00,166 [INFO]: 	Computing best hyperparameters for index knn.index 03/09/2025, 09:46:00
2025-03-09 09:46:50,459 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 50.2928 secs
2025-03-09 09:46:50,459 [INFO]: The best hyperparameters are: efSearch=186
2025-03-09 09:46:50,459 [INFO]: 	Compute fast metrics 03/09/2025, 09:46:50
  0%|          | 0/4 [00:00<?, ?it/s] 25%|██▌       | 1/4 [00:00<00:00,  9.29it/s] 75%|███████▌  | 3/4 [00:00<00:00, 18.67it/s]
2025-03-09 09:47:05,070 [INFO]: 	>>> Finished "Compute fast metrics" in 14.6107 secs
2025-03-09 09:47:05,758 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 71.4855 secs
2025-03-09 09:47:05,758 [INFO]: {
2025-03-09 09:47:05,759 [INFO]: 	index_key: HNSW15
2025-03-09 09:47:05,759 [INFO]: 	index_param: efSearch=186
2025-03-09 09:47:05,759 [INFO]: 	index_path: knn.index
2025-03-09 09:47:05,759 [INFO]: 	size in bytes: 1257194710
2025-03-09 09:47:05,759 [INFO]: 	avg_search_speed_ms: 7.746284101504651
2025-03-09 09:47:05,759 [INFO]: 	99p_search_speed_ms: 17.604891303926674
2025-03-09 09:47:05,759 [INFO]: 	reconstruction error %: 0.0
2025-03-09 09:47:05,759 [INFO]: 	nb vectors: 6390
2025-03-09 09:47:05,759 [INFO]: 	vectors dimension: 49152
2025-03-09 09:47:05,759 [INFO]: 	compression ratio: 0.9993083092117052
2025-03-09 09:47:05,759 [INFO]: }
2025-03-09 09:47:05,759 [INFO]: 	>>> Finished "Creating the index" in 71.4875 secs
2025-03-09 09:47:05,759 [INFO]: >>> Finished "Launching the whole pipeline" in 71.5239 secs
2025-03-09 09:47:06: [retrieval_preprocessing] calculating distances ...
2025-03-09 09:47:07: [retrieval_preprocessing] finished and saved retrieval indices for episode 61580 [episode count 3/20]
[retrieval_preprocessing] for episode 82061 [episode count 4/20], we have num_retrieval=np.int64(6524) num_query=np.int64(158)
2025-03-09 09:47:07,939 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-09 09:47:08,771 [INFO]: Launching the whole pipeline 03/09/2025, 09:47:08
2025-03-09 09:47:08,771 [INFO]: Reading total number of vectors and dimension 03/09/2025, 09:47:08
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1851.79it/s]
2025-03-09 09:47:08,802 [INFO]: There are 6524 embeddings of dim 49152
2025-03-09 09:47:08,802 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0308 secs
2025-03-09 09:47:08,802 [INFO]: 	Compute estimated construction time of the index 03/09/2025, 09:47:08
2025-03-09 09:47:08,802 [INFO]: 		-> Train: 16.7 minutes
2025-03-09 09:47:08,802 [INFO]: 		-> Add: 3.6 seconds
2025-03-09 09:47:08,802 [INFO]: 		Total: 16.7 minutes
2025-03-09 09:47:08,802 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0001 secs
2025-03-09 09:47:08,802 [INFO]: 	Checking that your have enough memory available to create the index 03/09/2025, 09:47:08
2025-03-09 09:47:08,803 [INFO]: 1.3GB of memory will be needed to build the index (more might be used if you have more)
2025-03-09 09:47:08,803 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0001 secs
2025-03-09 09:47:08,803 [INFO]: 	Selecting most promising index types given data characteristics 03/09/2025, 09:47:08
2025-03-09 09:47:08,803 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-09 09:47:08,803 [INFO]: 	Creating the index 03/09/2025, 09:47:08
2025-03-09 09:47:08,803 [INFO]: 		-> Instanciate the index HNSW15 03/09/2025, 09:47:08
2025-03-09 09:47:08,804 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0010 secs
2025-03-09 09:47:08,804 [INFO]: 		-> Adding the vectors to the index 03/09/2025, 09:47:08
2025-03-09 09:47:08,804 [INFO]: The memory available for adding the vectors is 48.8GB(total available - used by the index)
2025-03-09 09:47:08,804 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/27 [00:00<?, ?it/s]  7%|▋         | 2/27 [00:00<00:01, 18.04it/s] 33%|███▎      | 9/27 [00:00<00:00, 45.81it/s] 59%|█████▉    | 16/27 [00:00<00:00, 55.76it/s] 81%|████████▏ | 22/27 [00:03<00:01,  4.04it/s]100%|██████████| 27/27 [00:06<00:00,  3.24it/s]100%|██████████| 27/27 [00:06<00:00,  4.46it/s]
2025-03-09 09:47:14,867 [INFO]: 	Computing best hyperparameters for index knn.index 03/09/2025, 09:47:14
2025-03-09 09:48:05,829 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 50.9618 secs
2025-03-09 09:48:05,829 [INFO]: The best hyperparameters are: efSearch=173
2025-03-09 09:48:05,829 [INFO]: 	Compute fast metrics 03/09/2025, 09:48:05
  0%|          | 0/4 [00:00<?, ?it/s] 50%|█████     | 2/4 [00:00<00:00, 18.83it/s] 75%|███████▌  | 3/4 [00:00<00:00, 18.87it/s]
2025-03-09 09:48:27,034 [INFO]: 	>>> Finished "Compute fast metrics" in 21.2045 secs
2025-03-09 09:48:27,035 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 78.2313 secs
2025-03-09 09:48:27,035 [INFO]: {
2025-03-09 09:48:27,035 [INFO]: 	index_key: HNSW15
2025-03-09 09:48:27,035 [INFO]: 	index_param: efSearch=173
2025-03-09 09:48:27,035 [INFO]: 	index_path: knn.index
2025-03-09 09:48:27,035 [INFO]: 	size in bytes: 1283558230
2025-03-09 09:48:27,035 [INFO]: 	avg_search_speed_ms: 7.5747095942708915
2025-03-09 09:48:27,035 [INFO]: 	99p_search_speed_ms: 13.304025367833672
2025-03-09 09:48:27,035 [INFO]: 	reconstruction error %: 0.0
2025-03-09 09:48:27,035 [INFO]: 	nb vectors: 6524
2025-03-09 09:48:27,035 [INFO]: 	vectors dimension: 49152
2025-03-09 09:48:27,035 [INFO]: 	compression ratio: 0.9993084552151561
2025-03-09 09:48:27,035 [INFO]: }
2025-03-09 09:48:27,035 [INFO]: 	>>> Finished "Creating the index" in 78.2328 secs
2025-03-09 09:48:27,035 [INFO]: >>> Finished "Launching the whole pipeline" in 78.2641 secs
2025-03-09 09:48:27: [retrieval_preprocessing] calculating distances ...
2025-03-09 09:48:28: [retrieval_preprocessing] finished and saved retrieval indices for episode 82061 [episode count 4/20]
[retrieval_preprocessing] for episode 11921 [episode count 5/20], we have num_retrieval=np.int64(6204) num_query=np.int64(478)
2025-03-09 09:48:28,944 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-09 09:48:29,730 [INFO]: Launching the whole pipeline 03/09/2025, 09:48:29
2025-03-09 09:48:29,730 [INFO]: Reading total number of vectors and dimension 03/09/2025, 09:48:29
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1155.46it/s]
2025-03-09 09:48:29,763 [INFO]: There are 6204 embeddings of dim 49152
2025-03-09 09:48:29,763 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0327 secs
2025-03-09 09:48:29,763 [INFO]: 	Compute estimated construction time of the index 03/09/2025, 09:48:29
2025-03-09 09:48:29,763 [INFO]: 		-> Train: 16.7 minutes
2025-03-09 09:48:29,763 [INFO]: 		-> Add: 3.4 seconds
2025-03-09 09:48:29,763 [INFO]: 		Total: 16.7 minutes
2025-03-09 09:48:29,763 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0001 secs
2025-03-09 09:48:29,763 [INFO]: 	Checking that your have enough memory available to create the index 03/09/2025, 09:48:29
2025-03-09 09:48:29,763 [INFO]: 1.3GB of memory will be needed to build the index (more might be used if you have more)
2025-03-09 09:48:29,763 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0001 secs
2025-03-09 09:48:29,763 [INFO]: 	Selecting most promising index types given data characteristics 03/09/2025, 09:48:29
2025-03-09 09:48:29,764 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-09 09:48:29,764 [INFO]: 	Creating the index 03/09/2025, 09:48:29
2025-03-09 09:48:29,764 [INFO]: 		-> Instanciate the index HNSW15 03/09/2025, 09:48:29
2025-03-09 09:48:29,764 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0008 secs
2025-03-09 09:48:29,764 [INFO]: 		-> Adding the vectors to the index 03/09/2025, 09:48:29
2025-03-09 09:48:29,765 [INFO]: The memory available for adding the vectors is 48.9GB(total available - used by the index)
2025-03-09 09:48:29,765 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/26 [00:00<?, ?it/s]  4%|▍         | 1/26 [00:00<00:03,  7.60it/s] 27%|██▋       | 7/26 [00:00<00:00, 31.72it/s] 50%|█████     | 13/26 [00:00<00:00, 40.66it/s] 73%|███████▎  | 19/26 [00:00<00:00, 45.05it/s] 92%|█████████▏| 24/26 [00:05<00:00,  2.98it/s]100%|██████████| 26/26 [00:07<00:00,  3.52it/s]
2025-03-09 09:48:37,157 [INFO]: 	Computing best hyperparameters for index knn.index 03/09/2025, 09:48:37
2025-03-09 09:49:33,413 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 56.2554 secs
2025-03-09 09:49:33,413 [INFO]: The best hyperparameters are: efSearch=177
2025-03-09 09:49:33,413 [INFO]: 	Compute fast metrics 03/09/2025, 09:49:33
  0%|          | 0/4 [00:00<?, ?it/s] 50%|█████     | 2/4 [00:00<00:00, 16.99it/s] 75%|███████▌  | 3/4 [00:00<00:00, 19.21it/s]
2025-03-09 09:49:50,284 [INFO]: 	>>> Finished "Compute fast metrics" in 16.8709 secs
2025-03-09 09:49:50,286 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 80.5211 secs
2025-03-09 09:49:50,286 [INFO]: {
2025-03-09 09:49:50,286 [INFO]: 	index_key: HNSW15
2025-03-09 09:49:50,286 [INFO]: 	index_param: efSearch=177
2025-03-09 09:49:50,286 [INFO]: 	index_path: knn.index
2025-03-09 09:49:50,286 [INFO]: 	size in bytes: 1220600290
2025-03-09 09:49:50,286 [INFO]: 	avg_search_speed_ms: 9.306229493299195
2025-03-09 09:49:50,286 [INFO]: 	99p_search_speed_ms: 16.20721701066941
2025-03-09 09:49:50,286 [INFO]: 	reconstruction error %: 0.0
2025-03-09 09:49:50,286 [INFO]: 	nb vectors: 6204
2025-03-09 09:49:50,286 [INFO]: 	vectors dimension: 49152
2025-03-09 09:49:50,286 [INFO]: 	compression ratio: 0.9993083255780646
2025-03-09 09:49:50,286 [INFO]: }
2025-03-09 09:49:50,286 [INFO]: 	>>> Finished "Creating the index" in 80.5224 secs
2025-03-09 09:49:50,286 [INFO]: >>> Finished "Launching the whole pipeline" in 80.5557 secs
2025-03-09 09:49:52: [retrieval_preprocessing] calculating distances ...
2025-03-09 09:49:53: [retrieval_preprocessing] finished and saved retrieval indices for episode 11921 [episode count 5/20]
[retrieval_preprocessing] for episode 20753 [episode count 6/20], we have num_retrieval=np.int64(6209) num_query=np.int64(473)
2025-03-09 09:49:54,018 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-09 09:49:54,788 [INFO]: Launching the whole pipeline 03/09/2025, 09:49:54
2025-03-09 09:49:54,788 [INFO]: Reading total number of vectors and dimension 03/09/2025, 09:49:54
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1129.02it/s]
2025-03-09 09:49:54,820 [INFO]: There are 6209 embeddings of dim 49152
2025-03-09 09:49:54,820 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0321 secs
2025-03-09 09:49:54,820 [INFO]: 	Compute estimated construction time of the index 03/09/2025, 09:49:54
2025-03-09 09:49:54,820 [INFO]: 		-> Train: 16.7 minutes
2025-03-09 09:49:54,820 [INFO]: 		-> Add: 3.4 seconds
2025-03-09 09:49:54,820 [INFO]: 		Total: 16.7 minutes
2025-03-09 09:49:54,820 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0001 secs
2025-03-09 09:49:54,820 [INFO]: 	Checking that your have enough memory available to create the index 03/09/2025, 09:49:54
2025-03-09 09:49:54,820 [INFO]: 1.3GB of memory will be needed to build the index (more might be used if you have more)
2025-03-09 09:49:54,820 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0001 secs
2025-03-09 09:49:54,820 [INFO]: 	Selecting most promising index types given data characteristics 03/09/2025, 09:49:54
2025-03-09 09:49:54,820 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-09 09:49:54,820 [INFO]: 	Creating the index 03/09/2025, 09:49:54
2025-03-09 09:49:54,820 [INFO]: 		-> Instanciate the index HNSW15 03/09/2025, 09:49:54
2025-03-09 09:49:54,821 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0010 secs
2025-03-09 09:49:54,821 [INFO]: 		-> Adding the vectors to the index 03/09/2025, 09:49:54
2025-03-09 09:49:54,822 [INFO]: The memory available for adding the vectors is 48.9GB(total available - used by the index)
2025-03-09 09:49:54,822 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/26 [00:00<?, ?it/s]  4%|▍         | 1/26 [00:00<00:03,  8.14it/s] 27%|██▋       | 7/26 [00:00<00:00, 32.85it/s] 50%|█████     | 13/26 [00:00<00:00, 41.13it/s] 73%|███████▎  | 19/26 [00:00<00:00, 45.06it/s] 92%|█████████▏| 24/26 [00:04<00:00,  3.15it/s]100%|██████████| 26/26 [00:06<00:00,  3.76it/s]
2025-03-09 09:50:01,744 [INFO]: 	Computing best hyperparameters for index knn.index 03/09/2025, 09:50:01
2025-03-09 09:50:51,310 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 49.5651 secs
2025-03-09 09:50:51,310 [INFO]: The best hyperparameters are: efSearch=172
2025-03-09 09:50:51,310 [INFO]: 	Compute fast metrics 03/09/2025, 09:50:51
  0%|          | 0/4 [00:00<?, ?it/s] 75%|███████▌  | 3/4 [00:00<00:00, 25.24it/s] 75%|███████▌  | 3/4 [00:00<00:00, 21.39it/s]
2025-03-09 09:51:11,941 [INFO]: 	>>> Finished "Compute fast metrics" in 20.6308 secs
2025-03-09 09:51:11,942 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 77.1206 secs
2025-03-09 09:51:11,942 [INFO]: {
2025-03-09 09:51:11,942 [INFO]: 	index_key: HNSW15
2025-03-09 09:51:11,942 [INFO]: 	index_param: efSearch=172
2025-03-09 09:51:11,942 [INFO]: 	index_path: knn.index
2025-03-09 09:51:11,942 [INFO]: 	size in bytes: 1221583990
2025-03-09 09:51:11,942 [INFO]: 	avg_search_speed_ms: 7.62702055022541
2025-03-09 09:51:11,942 [INFO]: 	99p_search_speed_ms: 14.556618686765454
2025-03-09 09:51:11,942 [INFO]: 	reconstruction error %: 0.0
2025-03-09 09:51:11,942 [INFO]: 	nb vectors: 6209
2025-03-09 09:51:11,942 [INFO]: 	vectors dimension: 49152
2025-03-09 09:51:11,942 [INFO]: 	compression ratio: 0.9993083422777995
2025-03-09 09:51:11,942 [INFO]: }
2025-03-09 09:51:11,942 [INFO]: 	>>> Finished "Creating the index" in 77.1220 secs
2025-03-09 09:51:11,942 [INFO]: >>> Finished "Launching the whole pipeline" in 77.1546 secs
2025-03-09 09:51:14: [retrieval_preprocessing] calculating distances ...
2025-03-09 09:51:15: [retrieval_preprocessing] finished and saved retrieval indices for episode 20753 [episode count 6/20]
[retrieval_preprocessing] for episode 22417 [episode count 7/20], we have num_retrieval=np.int64(6207) num_query=np.int64(475)
2025-03-09 09:51:16,371 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-09 09:51:17,300 [INFO]: Launching the whole pipeline 03/09/2025, 09:51:17
2025-03-09 09:51:17,300 [INFO]: Reading total number of vectors and dimension 03/09/2025, 09:51:17
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1432.48it/s]
2025-03-09 09:51:17,336 [INFO]: There are 6207 embeddings of dim 49152
2025-03-09 09:51:17,336 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0357 secs
2025-03-09 09:51:17,336 [INFO]: 	Compute estimated construction time of the index 03/09/2025, 09:51:17
2025-03-09 09:51:17,336 [INFO]: 		-> Train: 16.7 minutes
2025-03-09 09:51:17,336 [INFO]: 		-> Add: 3.4 seconds
2025-03-09 09:51:17,336 [INFO]: 		Total: 16.7 minutes
2025-03-09 09:51:17,336 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0001 secs
2025-03-09 09:51:17,336 [INFO]: 	Checking that your have enough memory available to create the index 03/09/2025, 09:51:17
2025-03-09 09:51:17,336 [INFO]: 1.3GB of memory will be needed to build the index (more might be used if you have more)
2025-03-09 09:51:17,336 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0002 secs
2025-03-09 09:51:17,336 [INFO]: 	Selecting most promising index types given data characteristics 03/09/2025, 09:51:17
2025-03-09 09:51:17,336 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-09 09:51:17,336 [INFO]: 	Creating the index 03/09/2025, 09:51:17
2025-03-09 09:51:17,336 [INFO]: 		-> Instanciate the index HNSW15 03/09/2025, 09:51:17
2025-03-09 09:51:17,338 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0012 secs
2025-03-09 09:51:17,338 [INFO]: 		-> Adding the vectors to the index 03/09/2025, 09:51:17
2025-03-09 09:51:17,338 [INFO]: The memory available for adding the vectors is 48.9GB(total available - used by the index)
2025-03-09 09:51:17,338 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/26 [00:00<?, ?it/s]  4%|▍         | 1/26 [00:00<00:02,  9.26it/s] 27%|██▋       | 7/26 [00:00<00:00, 35.42it/s] 46%|████▌     | 12/26 [00:00<00:00, 39.50it/s] 69%|██████▉   | 18/26 [00:00<00:00, 45.11it/s] 88%|████████▊ | 23/26 [00:04<00:00,  3.42it/s]100%|██████████| 26/26 [00:06<00:00,  2.80it/s]100%|██████████| 26/26 [00:06<00:00,  4.31it/s]
2025-03-09 09:51:23,374 [INFO]: 	Computing best hyperparameters for index knn.index 03/09/2025, 09:51:23
2025-03-09 09:52:14,426 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 51.0513 secs
2025-03-09 09:52:14,426 [INFO]: The best hyperparameters are: efSearch=191
2025-03-09 09:52:14,427 [INFO]: 	Compute fast metrics 03/09/2025, 09:52:14
  0%|          | 0/4 [00:00<?, ?it/s] 25%|██▌       | 1/4 [00:00<00:00,  5.14it/s] 75%|███████▌  | 3/4 [00:00<00:00,  7.84it/s] 75%|███████▌  | 3/4 [00:00<00:00,  5.74it/s]
2025-03-09 09:52:44,037 [INFO]: 	>>> Finished "Compute fast metrics" in 29.6102 secs
2025-03-09 09:52:44,039 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 86.7010 secs
2025-03-09 09:52:44,039 [INFO]: {
2025-03-09 09:52:44,039 [INFO]: 	index_key: HNSW15
2025-03-09 09:52:44,039 [INFO]: 	index_param: efSearch=191
2025-03-09 09:52:44,039 [INFO]: 	index_path: knn.index
2025-03-09 09:52:44,039 [INFO]: 	size in bytes: 1221190510
2025-03-09 09:52:44,039 [INFO]: 	avg_search_speed_ms: 10.953963309861026
2025-03-09 09:52:44,039 [INFO]: 	99p_search_speed_ms: 22.380543779581785
2025-03-09 09:52:44,039 [INFO]: 	reconstruction error %: 0.0
2025-03-09 09:52:44,039 [INFO]: 	nb vectors: 6207
2025-03-09 09:52:44,039 [INFO]: 	vectors dimension: 49152
2025-03-09 09:52:44,039 [INFO]: 	compression ratio: 0.999308335601134
2025-03-09 09:52:44,039 [INFO]: }
2025-03-09 09:52:44,039 [INFO]: 	>>> Finished "Creating the index" in 86.7028 secs
2025-03-09 09:52:44,039 [INFO]: >>> Finished "Launching the whole pipeline" in 86.7392 secs
2025-03-09 09:52:46: [retrieval_preprocessing] calculating distances ...
2025-03-09 09:52:48: [retrieval_preprocessing] finished and saved retrieval indices for episode 22417 [episode count 7/20]
[retrieval_preprocessing] for episode 83832 [episode count 8/20], we have num_retrieval=np.int64(6262) num_query=np.int64(420)
2025-03-09 09:52:50,566 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-09 09:52:51,669 [INFO]: Launching the whole pipeline 03/09/2025, 09:52:51
2025-03-09 09:52:51,669 [INFO]: Reading total number of vectors and dimension 03/09/2025, 09:52:51
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 894.69it/s]
2025-03-09 09:52:51,720 [INFO]: There are 6262 embeddings of dim 49152
2025-03-09 09:52:51,721 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0516 secs
2025-03-09 09:52:51,721 [INFO]: 	Compute estimated construction time of the index 03/09/2025, 09:52:51
2025-03-09 09:52:51,721 [INFO]: 		-> Train: 16.7 minutes
2025-03-09 09:52:51,721 [INFO]: 		-> Add: 3.4 seconds
2025-03-09 09:52:51,721 [INFO]: 		Total: 16.7 minutes
2025-03-09 09:52:51,721 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0002 secs
2025-03-09 09:52:51,721 [INFO]: 	Checking that your have enough memory available to create the index 03/09/2025, 09:52:51
2025-03-09 09:52:51,721 [INFO]: 1.3GB of memory will be needed to build the index (more might be used if you have more)
2025-03-09 09:52:51,721 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0004 secs
2025-03-09 09:52:51,721 [INFO]: 	Selecting most promising index types given data characteristics 03/09/2025, 09:52:51
2025-03-09 09:52:51,721 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-09 09:52:51,722 [INFO]: 	Creating the index 03/09/2025, 09:52:51
2025-03-09 09:52:51,722 [INFO]: 		-> Instanciate the index HNSW15 03/09/2025, 09:52:51
2025-03-09 09:52:51,723 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0015 secs
2025-03-09 09:52:51,724 [INFO]: 		-> Adding the vectors to the index 03/09/2025, 09:52:51
2025-03-09 09:52:51,724 [INFO]: The memory available for adding the vectors is 48.9GB(total available - used by the index)
2025-03-09 09:52:51,724 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/26 [00:00<?, ?it/s]  4%|▍         | 1/26 [00:00<00:03,  6.39it/s] 23%|██▎       | 6/26 [00:00<00:00, 26.70it/s] 46%|████▌     | 12/26 [00:00<00:00, 37.39it/s] 69%|██████▉   | 18/26 [00:00<00:00, 42.84it/s] 88%|████████▊ | 23/26 [00:04<00:00,  3.20it/s]100%|██████████| 26/26 [00:06<00:00,  2.44it/s]100%|██████████| 26/26 [00:06<00:00,  3.78it/s]
2025-03-09 09:52:58,603 [INFO]: 	Computing best hyperparameters for index knn.index 03/09/2025, 09:52:58
2025-03-09 09:53:52,463 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 53.8582 secs
2025-03-09 09:53:52,463 [INFO]: The best hyperparameters are: efSearch=168
2025-03-09 09:53:52,463 [INFO]: 	Compute fast metrics 03/09/2025, 09:53:52
  0%|          | 0/4 [00:00<?, ?it/s] 25%|██▌       | 1/4 [00:00<00:00,  8.35it/s] 75%|███████▌  | 3/4 [00:00<00:00, 16.95it/s]
2025-03-09 09:54:07,911 [INFO]: 	>>> Finished "Compute fast metrics" in 15.4477 secs
2025-03-09 09:54:07,912 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 76.1886 secs
2025-03-09 09:54:07,912 [INFO]: {
2025-03-09 09:54:07,912 [INFO]: 	index_key: HNSW15
2025-03-09 09:54:07,912 [INFO]: 	index_param: efSearch=168
2025-03-09 09:54:07,912 [INFO]: 	index_path: knn.index
2025-03-09 09:54:07,912 [INFO]: 	size in bytes: 1232011390
2025-03-09 09:54:07,912 [INFO]: 	avg_search_speed_ms: 7.842115204160412
2025-03-09 09:54:07,912 [INFO]: 	99p_search_speed_ms: 17.290623174048957
2025-03-09 09:54:07,912 [INFO]: 	reconstruction error %: 0.0
2025-03-09 09:54:07,912 [INFO]: 	nb vectors: 6262
2025-03-09 09:54:07,912 [INFO]: 	vectors dimension: 49152
2025-03-09 09:54:07,912 [INFO]: 	compression ratio: 0.9993083716539342
2025-03-09 09:54:07,912 [INFO]: }
2025-03-09 09:54:07,912 [INFO]: 	>>> Finished "Creating the index" in 76.1908 secs
2025-03-09 09:54:07,912 [INFO]: >>> Finished "Launching the whole pipeline" in 76.2436 secs
2025-03-09 09:54:09: [retrieval_preprocessing] calculating distances ...
2025-03-09 09:54:10: [retrieval_preprocessing] finished and saved retrieval indices for episode 83832 [episode count 8/20]
[retrieval_preprocessing] for episode 1305 [episode count 9/20], we have num_retrieval=np.int64(6380) num_query=np.int64(302)
2025-03-09 09:54:12,937 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-09 09:54:13,802 [INFO]: Launching the whole pipeline 03/09/2025, 09:54:13
2025-03-09 09:54:13,802 [INFO]: Reading total number of vectors and dimension 03/09/2025, 09:54:13
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 998.88it/s]
2025-03-09 09:54:13,831 [INFO]: There are 6380 embeddings of dim 49152
2025-03-09 09:54:13,831 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0284 secs
2025-03-09 09:54:13,831 [INFO]: 	Compute estimated construction time of the index 03/09/2025, 09:54:13
2025-03-09 09:54:13,831 [INFO]: 		-> Train: 16.7 minutes
2025-03-09 09:54:13,831 [INFO]: 		-> Add: 3.5 seconds
2025-03-09 09:54:13,831 [INFO]: 		Total: 16.7 minutes
2025-03-09 09:54:13,831 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0001 secs
2025-03-09 09:54:13,831 [INFO]: 	Checking that your have enough memory available to create the index 03/09/2025, 09:54:13
2025-03-09 09:54:13,831 [INFO]: 1.3GB of memory will be needed to build the index (more might be used if you have more)
2025-03-09 09:54:13,831 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0002 secs
2025-03-09 09:54:13,832 [INFO]: 	Selecting most promising index types given data characteristics 03/09/2025, 09:54:13
2025-03-09 09:54:13,832 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-09 09:54:13,832 [INFO]: 	Creating the index 03/09/2025, 09:54:13
2025-03-09 09:54:13,832 [INFO]: 		-> Instanciate the index HNSW15 03/09/2025, 09:54:13
2025-03-09 09:54:13,833 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0012 secs
2025-03-09 09:54:13,833 [INFO]: 		-> Adding the vectors to the index 03/09/2025, 09:54:13
2025-03-09 09:54:13,833 [INFO]: The memory available for adding the vectors is 48.8GB(total available - used by the index)
2025-03-09 09:54:13,833 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/27 [00:00<?, ?it/s]  4%|▎         | 1/27 [00:00<00:04,  5.37it/s] 11%|█         | 3/27 [00:00<00:02,  9.04it/s] 19%|█▊        | 5/27 [00:00<00:02, 10.37it/s] 26%|██▌       | 7/27 [00:00<00:01, 11.05it/s] 33%|███▎      | 9/27 [00:00<00:01, 11.32it/s] 41%|████      | 11/27 [00:01<00:01, 11.56it/s] 48%|████▊     | 13/27 [00:01<00:01, 11.71it/s] 56%|█████▌    | 15/27 [00:01<00:01, 11.87it/s] 63%|██████▎   | 17/27 [00:01<00:00, 11.98it/s] 70%|███████   | 19/27 [00:01<00:00, 12.13it/s] 78%|███████▊  | 21/27 [00:05<00:04,  1.49it/s] 81%|████████▏ | 22/27 [00:05<00:02,  1.75it/s] 89%|████████▉ | 24/27 [00:05<00:01,  2.45it/s] 96%|█████████▋| 26/27 [00:06<00:00,  3.27it/s]100%|██████████| 27/27 [00:08<00:00,  1.50it/s]100%|██████████| 27/27 [00:08<00:00,  3.22it/s]
2025-03-09 09:54:22,212 [INFO]: 	Computing best hyperparameters for index knn.index 03/09/2025, 09:54:22
2025-03-09 09:55:11,712 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 49.4995 secs
2025-03-09 09:55:11,712 [INFO]: The best hyperparameters are: efSearch=205
2025-03-09 09:55:11,713 [INFO]: 	Compute fast metrics 03/09/2025, 09:55:11
  0%|          | 0/4 [00:00<?, ?it/s] 25%|██▌       | 1/4 [00:00<00:00,  5.41it/s] 50%|█████     | 2/4 [00:00<00:00,  6.80it/s] 75%|███████▌  | 3/4 [00:00<00:00,  7.50it/s] 75%|███████▌  | 3/4 [00:00<00:00,  5.68it/s]
2025-03-09 09:55:37,266 [INFO]: 	>>> Finished "Compute fast metrics" in 25.5533 secs
2025-03-09 09:55:37,267 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 83.4341 secs
2025-03-09 09:55:37,267 [INFO]: {
2025-03-09 09:55:37,267 [INFO]: 	index_key: HNSW15
2025-03-09 09:55:37,267 [INFO]: 	index_param: efSearch=205
2025-03-09 09:55:37,267 [INFO]: 	index_path: knn.index
2025-03-09 09:55:37,267 [INFO]: 	size in bytes: 1255227130
2025-03-09 09:55:37,267 [INFO]: 	avg_search_speed_ms: 8.8048016779128
2025-03-09 09:55:37,267 [INFO]: 	99p_search_speed_ms: 16.066562384367014
2025-03-09 09:55:37,267 [INFO]: 	reconstruction error %: 0.0
2025-03-09 09:55:37,267 [INFO]: 	nb vectors: 6380
2025-03-09 09:55:37,267 [INFO]: 	vectors dimension: 49152
2025-03-09 09:55:37,268 [INFO]: 	compression ratio: 0.9993084199829237
2025-03-09 09:55:37,268 [INFO]: }
2025-03-09 09:55:37,268 [INFO]: 	>>> Finished "Creating the index" in 83.4358 secs
2025-03-09 09:55:37,268 [INFO]: >>> Finished "Launching the whole pipeline" in 83.4652 secs
2025-03-09 09:55:38: [retrieval_preprocessing] calculating distances ...
2025-03-09 09:55:40: [retrieval_preprocessing] finished and saved retrieval indices for episode 1305 [episode count 9/20]
[retrieval_preprocessing] for episode 18075 [episode count 10/20], we have num_retrieval=np.int64(6355) num_query=np.int64(327)
2025-03-09 09:55:42,472 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-09 09:55:43,670 [INFO]: Launching the whole pipeline 03/09/2025, 09:55:43
2025-03-09 09:55:43,670 [INFO]: Reading total number of vectors and dimension 03/09/2025, 09:55:43
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1522.43it/s]
2025-03-09 09:55:43,696 [INFO]: There are 6355 embeddings of dim 49152
2025-03-09 09:55:43,696 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0261 secs
2025-03-09 09:55:43,696 [INFO]: 	Compute estimated construction time of the index 03/09/2025, 09:55:43
2025-03-09 09:55:43,696 [INFO]: 		-> Train: 16.7 minutes
2025-03-09 09:55:43,696 [INFO]: 		-> Add: 3.5 seconds
2025-03-09 09:55:43,696 [INFO]: 		Total: 16.7 minutes
2025-03-09 09:55:43,696 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0001 secs
2025-03-09 09:55:43,696 [INFO]: 	Checking that your have enough memory available to create the index 03/09/2025, 09:55:43
2025-03-09 09:55:43,696 [INFO]: 1.3GB of memory will be needed to build the index (more might be used if you have more)
2025-03-09 09:55:43,696 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0002 secs
2025-03-09 09:55:43,697 [INFO]: 	Selecting most promising index types given data characteristics 03/09/2025, 09:55:43
2025-03-09 09:55:43,697 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-09 09:55:43,697 [INFO]: 	Creating the index 03/09/2025, 09:55:43
2025-03-09 09:55:43,697 [INFO]: 		-> Instanciate the index HNSW15 03/09/2025, 09:55:43
2025-03-09 09:55:43,698 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0012 secs
2025-03-09 09:55:43,698 [INFO]: 		-> Adding the vectors to the index 03/09/2025, 09:55:43
2025-03-09 09:55:43,698 [INFO]: The memory available for adding the vectors is 48.8GB(total available - used by the index)
2025-03-09 09:55:43,698 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/26 [00:00<?, ?it/s]  4%|▍         | 1/26 [00:00<00:04,  5.04it/s]  8%|▊         | 2/26 [00:00<00:03,  6.52it/s] 12%|█▏        | 3/26 [00:00<00:03,  7.12it/s] 15%|█▌        | 4/26 [00:00<00:02,  7.59it/s] 19%|█▉        | 5/26 [00:00<00:02,  7.44it/s] 27%|██▋       | 7/26 [00:00<00:02,  8.44it/s] 35%|███▍      | 9/26 [00:01<00:01,  8.99it/s] 42%|████▏     | 11/26 [00:01<00:01,  9.33it/s] 46%|████▌     | 12/26 [00:01<00:01,  9.43it/s] 50%|█████     | 13/26 [00:01<00:01,  9.44it/s] 54%|█████▍    | 14/26 [00:01<00:01,  9.53it/s] 62%|██████▏   | 16/26 [00:01<00:01,  9.60it/s] 69%|██████▉   | 18/26 [00:02<00:00, 10.05it/s] 77%|███████▋  | 20/26 [00:02<00:00, 10.84it/s] 85%|████████▍ | 22/26 [00:07<00:03,  1.11it/s] 88%|████████▊ | 23/26 [00:07<00:02,  1.34it/s] 92%|█████████▏| 24/26 [00:07<00:01,  1.65it/s] 96%|█████████▌| 25/26 [00:07<00:00,  2.04it/s]100%|██████████| 26/26 [00:10<00:00,  1.01s/it]100%|██████████| 26/26 [00:10<00:00,  2.58it/s]
2025-03-09 09:55:53,807 [INFO]: 	Computing best hyperparameters for index knn.index 03/09/2025, 09:55:53
2025-03-09 09:56:44,143 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 50.3347 secs
2025-03-09 09:56:44,143 [INFO]: The best hyperparameters are: efSearch=195
2025-03-09 09:56:44,143 [INFO]: 	Compute fast metrics 03/09/2025, 09:56:44
  0%|          | 0/4 [00:00<?, ?it/s] 25%|██▌       | 1/4 [00:00<00:00,  7.23it/s] 75%|███████▌  | 3/4 [00:00<00:00, 11.00it/s] 75%|███████▌  | 3/4 [00:00<00:00,  7.62it/s]
2025-03-09 09:57:12,443 [INFO]: 	>>> Finished "Compute fast metrics" in 28.2999 secs
2025-03-09 09:57:12,445 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 88.7466 secs
2025-03-09 09:57:12,445 [INFO]: {
2025-03-09 09:57:12,445 [INFO]: 	index_key: HNSW15
2025-03-09 09:57:12,445 [INFO]: 	index_param: efSearch=195
2025-03-09 09:57:12,445 [INFO]: 	index_path: knn.index
2025-03-09 09:57:12,445 [INFO]: 	size in bytes: 1250308510
2025-03-09 09:57:12,445 [INFO]: 	avg_search_speed_ms: 8.902030871544143
2025-03-09 09:57:12,445 [INFO]: 	99p_search_speed_ms: 18.891106131486588
2025-03-09 09:57:12,445 [INFO]: 	reconstruction error %: 0.0
2025-03-09 09:57:12,445 [INFO]: 	nb vectors: 6355
2025-03-09 09:57:12,445 [INFO]: 	vectors dimension: 49152
2025-03-09 09:57:12,445 [INFO]: 	compression ratio: 0.9993084346838526
2025-03-09 09:57:12,445 [INFO]: }
2025-03-09 09:57:12,445 [INFO]: 	>>> Finished "Creating the index" in 88.7482 secs
2025-03-09 09:57:12,445 [INFO]: >>> Finished "Launching the whole pipeline" in 88.7750 secs
2025-03-09 09:57:13: [retrieval_preprocessing] calculating distances ...
2025-03-09 09:57:15: [retrieval_preprocessing] finished and saved retrieval indices for episode 18075 [episode count 10/20]
[retrieval_preprocessing] for episode 8860 [episode count 11/20], we have num_retrieval=np.int64(6522) num_query=np.int64(160)
2025-03-09 09:57:17,622 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-09 09:57:18,480 [INFO]: Launching the whole pipeline 03/09/2025, 09:57:18
2025-03-09 09:57:18,480 [INFO]: Reading total number of vectors and dimension 03/09/2025, 09:57:18
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1499.04it/s]
2025-03-09 09:57:18,509 [INFO]: There are 6522 embeddings of dim 49152
2025-03-09 09:57:18,510 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0299 secs
2025-03-09 09:57:18,510 [INFO]: 	Compute estimated construction time of the index 03/09/2025, 09:57:18
2025-03-09 09:57:18,510 [INFO]: 		-> Train: 16.7 minutes
2025-03-09 09:57:18,510 [INFO]: 		-> Add: 3.6 seconds
2025-03-09 09:57:18,510 [INFO]: 		Total: 16.7 minutes
2025-03-09 09:57:18,510 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0003 secs
2025-03-09 09:57:18,510 [INFO]: 	Checking that your have enough memory available to create the index 03/09/2025, 09:57:18
2025-03-09 09:57:18,511 [INFO]: 1.3GB of memory will be needed to build the index (more might be used if you have more)
2025-03-09 09:57:18,511 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0004 secs
2025-03-09 09:57:18,511 [INFO]: 	Selecting most promising index types given data characteristics 03/09/2025, 09:57:18
2025-03-09 09:57:18,511 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-09 09:57:18,511 [INFO]: 	Creating the index 03/09/2025, 09:57:18
2025-03-09 09:57:18,511 [INFO]: 		-> Instanciate the index HNSW15 03/09/2025, 09:57:18
2025-03-09 09:57:18,514 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0029 secs
2025-03-09 09:57:18,515 [INFO]: 		-> Adding the vectors to the index 03/09/2025, 09:57:18
2025-03-09 09:57:18,515 [INFO]: The memory available for adding the vectors is 48.8GB(total available - used by the index)
2025-03-09 09:57:18,515 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/27 [00:00<?, ?it/s]  4%|▎         | 1/27 [00:00<00:04,  5.63it/s] 11%|█         | 3/27 [00:00<00:02,  9.71it/s] 19%|█▊        | 5/27 [00:00<00:01, 11.05it/s] 26%|██▌       | 7/27 [00:00<00:01, 11.49it/s] 33%|███▎      | 9/27 [00:00<00:01, 11.53it/s] 41%|████      | 11/27 [00:00<00:01, 11.60it/s] 48%|████▊     | 13/27 [00:01<00:01, 11.70it/s] 56%|█████▌    | 15/27 [00:01<00:01, 11.64it/s] 63%|██████▎   | 17/27 [00:01<00:00, 11.43it/s] 70%|███████   | 19/27 [00:01<00:00, 11.54it/s] 78%|███████▊  | 21/27 [00:05<00:03,  1.51it/s] 85%|████████▌ | 23/27 [00:05<00:01,  2.06it/s] 93%|█████████▎| 25/27 [00:05<00:00,  2.76it/s]100%|██████████| 27/27 [00:08<00:00,  1.60it/s]100%|██████████| 27/27 [00:08<00:00,  3.21it/s]
2025-03-09 09:57:26,923 [INFO]: 	Computing best hyperparameters for index knn.index 03/09/2025, 09:57:26
2025-03-09 09:58:22,089 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 55.1655 secs
2025-03-09 09:58:22,089 [INFO]: The best hyperparameters are: efSearch=200
2025-03-09 09:58:22,089 [INFO]: 	Compute fast metrics 03/09/2025, 09:58:22
  0%|          | 0/4 [00:00<?, ?it/s] 25%|██▌       | 1/4 [00:00<00:00,  5.49it/s] 50%|█████     | 2/4 [00:00<00:00,  7.24it/s] 75%|███████▌  | 3/4 [00:00<00:00,  7.98it/s] 75%|███████▌  | 3/4 [00:00<00:00,  6.09it/s]
2025-03-09 09:58:45,466 [INFO]: 	>>> Finished "Compute fast metrics" in 23.3769 secs
2025-03-09 09:58:45,467 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 86.9528 secs
2025-03-09 09:58:45,468 [INFO]: {
2025-03-09 09:58:45,468 [INFO]: 	index_key: HNSW15
2025-03-09 09:58:45,468 [INFO]: 	index_param: efSearch=200
2025-03-09 09:58:45,468 [INFO]: 	index_path: knn.index
2025-03-09 09:58:45,468 [INFO]: 	size in bytes: 1283164750
2025-03-09 09:58:45,468 [INFO]: 	avg_search_speed_ms: 9.648717545659702
2025-03-09 09:58:45,468 [INFO]: 	99p_search_speed_ms: 18.410364922601794
2025-03-09 09:58:45,468 [INFO]: 	reconstruction error %: 0.0
2025-03-09 09:58:45,468 [INFO]: 	nb vectors: 6522
2025-03-09 09:58:45,468 [INFO]: 	vectors dimension: 49152
2025-03-09 09:58:45,468 [INFO]: 	compression ratio: 0.9993084488955919
2025-03-09 09:58:45,468 [INFO]: }
2025-03-09 09:58:45,468 [INFO]: 	>>> Finished "Creating the index" in 86.9565 secs
2025-03-09 09:58:45,468 [INFO]: >>> Finished "Launching the whole pipeline" in 86.9879 secs
2025-03-09 09:58:46: [retrieval_preprocessing] calculating distances ...
2025-03-09 09:58:46: [retrieval_preprocessing] finished and saved retrieval indices for episode 8860 [episode count 11/20]
[retrieval_preprocessing] for episode 43932 [episode count 12/20], we have num_retrieval=np.int64(6318) num_query=np.int64(364)
2025-03-09 09:58:48,254 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-09 09:58:49,057 [INFO]: Launching the whole pipeline 03/09/2025, 09:58:49
2025-03-09 09:58:49,057 [INFO]: Reading total number of vectors and dimension 03/09/2025, 09:58:49
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1469.11it/s]
2025-03-09 09:58:49,083 [INFO]: There are 6318 embeddings of dim 49152
2025-03-09 09:58:49,084 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0262 secs
2025-03-09 09:58:49,084 [INFO]: 	Compute estimated construction time of the index 03/09/2025, 09:58:49
2025-03-09 09:58:49,084 [INFO]: 		-> Train: 16.7 minutes
2025-03-09 09:58:49,084 [INFO]: 		-> Add: 3.5 seconds
2025-03-09 09:58:49,084 [INFO]: 		Total: 16.7 minutes
2025-03-09 09:58:49,084 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0001 secs
2025-03-09 09:58:49,084 [INFO]: 	Checking that your have enough memory available to create the index 03/09/2025, 09:58:49
2025-03-09 09:58:49,084 [INFO]: 1.3GB of memory will be needed to build the index (more might be used if you have more)
2025-03-09 09:58:49,084 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0001 secs
2025-03-09 09:58:49,084 [INFO]: 	Selecting most promising index types given data characteristics 03/09/2025, 09:58:49
2025-03-09 09:58:49,084 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-09 09:58:49,084 [INFO]: 	Creating the index 03/09/2025, 09:58:49
2025-03-09 09:58:49,084 [INFO]: 		-> Instanciate the index HNSW15 03/09/2025, 09:58:49
2025-03-09 09:58:49,085 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0011 secs
2025-03-09 09:58:49,085 [INFO]: 		-> Adding the vectors to the index 03/09/2025, 09:58:49
2025-03-09 09:58:49,085 [INFO]: The memory available for adding the vectors is 48.8GB(total available - used by the index)
2025-03-09 09:58:49,085 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/26 [00:00<?, ?it/s]  4%|▍         | 1/26 [00:00<00:04,  5.52it/s] 12%|█▏        | 3/26 [00:00<00:02,  9.59it/s] 19%|█▉        | 5/26 [00:00<00:01, 11.12it/s] 27%|██▋       | 7/26 [00:00<00:01, 11.86it/s] 35%|███▍      | 9/26 [00:00<00:01, 12.22it/s] 42%|████▏     | 11/26 [00:00<00:01, 12.48it/s] 50%|█████     | 13/26 [00:01<00:01, 12.56it/s] 58%|█████▊    | 15/26 [00:01<00:00, 12.63it/s] 65%|██████▌   | 17/26 [00:01<00:00, 12.65it/s] 73%|███████▎  | 19/26 [00:01<00:00, 12.66it/s] 81%|████████  | 21/26 [00:05<00:03,  1.43it/s] 85%|████████▍ | 22/26 [00:05<00:02,  1.68it/s] 92%|█████████▏| 24/26 [00:06<00:00,  2.39it/s]100%|██████████| 26/26 [00:08<00:00,  1.50it/s]100%|██████████| 26/26 [00:08<00:00,  3.09it/s]
2025-03-09 09:58:57,497 [INFO]: 	Computing best hyperparameters for index knn.index 03/09/2025, 09:58:57
2025-03-09 09:59:46,652 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 49.1543 secs
2025-03-09 09:59:46,652 [INFO]: The best hyperparameters are: efSearch=214
2025-03-09 09:59:46,652 [INFO]: 	Compute fast metrics 03/09/2025, 09:59:46
  0%|          | 0/4 [00:00<?, ?it/s] 25%|██▌       | 1/4 [00:00<00:00,  5.38it/s] 50%|█████     | 2/4 [00:00<00:00,  7.18it/s] 75%|███████▌  | 3/4 [00:00<00:00,  8.04it/s] 75%|███████▌  | 3/4 [00:00<00:00,  6.06it/s]
2025-03-09 10:00:07,156 [INFO]: 	>>> Finished "Compute fast metrics" in 20.5039 secs
2025-03-09 10:00:07,158 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 78.0722 secs
2025-03-09 10:00:07,158 [INFO]: {
2025-03-09 10:00:07,158 [INFO]: 	index_key: HNSW15
2025-03-09 10:00:07,158 [INFO]: 	index_param: efSearch=214
2025-03-09 10:00:07,158 [INFO]: 	index_path: knn.index
2025-03-09 10:00:07,158 [INFO]: 	size in bytes: 1243029010
2025-03-09 10:00:07,158 [INFO]: 	avg_search_speed_ms: 9.725526759927718
2025-03-09 10:00:07,158 [INFO]: 	99p_search_speed_ms: 18.900302620604634
2025-03-09 10:00:07,158 [INFO]: 	reconstruction error %: 0.0
2025-03-09 10:00:07,158 [INFO]: 	nb vectors: 6318
2025-03-09 10:00:07,158 [INFO]: 	vectors dimension: 49152
2025-03-09 10:00:07,158 [INFO]: 	compression ratio: 0.9993084103483635
2025-03-09 10:00:07,158 [INFO]: }
2025-03-09 10:00:07,158 [INFO]: 	>>> Finished "Creating the index" in 78.0737 secs
2025-03-09 10:00:07,158 [INFO]: >>> Finished "Launching the whole pipeline" in 78.1006 secs
2025-03-09 10:00:08: [retrieval_preprocessing] calculating distances ...
2025-03-09 10:00:10: [retrieval_preprocessing] finished and saved retrieval indices for episode 43932 [episode count 12/20]
[retrieval_preprocessing] for episode 35486 [episode count 13/20], we have num_retrieval=np.int64(6412) num_query=np.int64(270)
2025-03-09 10:00:11,955 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-09 10:00:12,802 [INFO]: Launching the whole pipeline 03/09/2025, 10:00:12
2025-03-09 10:00:12,802 [INFO]: Reading total number of vectors and dimension 03/09/2025, 10:00:12
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1448.81it/s]
2025-03-09 10:00:12,837 [INFO]: There are 6412 embeddings of dim 49152
2025-03-09 10:00:12,837 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0347 secs
2025-03-09 10:00:12,838 [INFO]: 	Compute estimated construction time of the index 03/09/2025, 10:00:12
2025-03-09 10:00:12,838 [INFO]: 		-> Train: 16.7 minutes
2025-03-09 10:00:12,838 [INFO]: 		-> Add: 3.5 seconds
2025-03-09 10:00:12,838 [INFO]: 		Total: 16.7 minutes
2025-03-09 10:00:12,838 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0005 secs
2025-03-09 10:00:12,838 [INFO]: 	Checking that your have enough memory available to create the index 03/09/2025, 10:00:12
2025-03-09 10:00:12,838 [INFO]: 1.3GB of memory will be needed to build the index (more might be used if you have more)
2025-03-09 10:00:12,839 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0006 secs
2025-03-09 10:00:12,839 [INFO]: 	Selecting most promising index types given data characteristics 03/09/2025, 10:00:12
2025-03-09 10:00:12,839 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-09 10:00:12,839 [INFO]: 	Creating the index 03/09/2025, 10:00:12
2025-03-09 10:00:12,839 [INFO]: 		-> Instanciate the index HNSW15 03/09/2025, 10:00:12
2025-03-09 10:00:12,842 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0028 secs
2025-03-09 10:00:12,843 [INFO]: 		-> Adding the vectors to the index 03/09/2025, 10:00:12
2025-03-09 10:00:12,843 [INFO]: The memory available for adding the vectors is 48.8GB(total available - used by the index)
2025-03-09 10:00:12,843 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/27 [00:00<?, ?it/s]  4%|▎         | 1/27 [00:00<00:04,  5.24it/s] 11%|█         | 3/27 [00:00<00:02,  9.39it/s] 19%|█▊        | 5/27 [00:00<00:01, 11.31it/s] 26%|██▌       | 7/27 [00:00<00:01, 12.08it/s] 33%|███▎      | 9/27 [00:00<00:01, 12.59it/s] 41%|████      | 11/27 [00:00<00:01, 12.76it/s] 48%|████▊     | 13/27 [00:01<00:01, 12.92it/s] 56%|█████▌    | 15/27 [00:01<00:00, 12.89it/s] 63%|██████▎   | 17/27 [00:01<00:00, 12.75it/s] 70%|███████   | 19/27 [00:01<00:00, 12.76it/s] 78%|███████▊  | 21/27 [00:05<00:04,  1.50it/s] 85%|████████▌ | 23/27 [00:05<00:01,  2.04it/s] 93%|█████████▎| 25/27 [00:05<00:00,  2.73it/s]100%|██████████| 27/27 [00:08<00:00,  1.64it/s]100%|██████████| 27/27 [00:08<00:00,  3.28it/s]
2025-03-09 10:00:21,071 [INFO]: 	Computing best hyperparameters for index knn.index 03/09/2025, 10:00:21
2025-03-09 10:01:12,146 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 51.0745 secs
2025-03-09 10:01:12,147 [INFO]: The best hyperparameters are: efSearch=160
2025-03-09 10:01:12,147 [INFO]: 	Compute fast metrics 03/09/2025, 10:01:12
  0%|          | 0/4 [00:00<?, ?it/s] 25%|██▌       | 1/4 [00:00<00:00,  5.72it/s] 50%|█████     | 2/4 [00:00<00:00,  7.23it/s] 75%|███████▌  | 3/4 [00:00<00:00,  8.12it/s] 75%|███████▌  | 3/4 [00:00<00:00,  6.05it/s]
2025-03-09 10:01:36,384 [INFO]: 	>>> Finished "Compute fast metrics" in 24.2369 secs
2025-03-09 10:01:36,385 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 83.5423 secs
2025-03-09 10:01:36,385 [INFO]: {
2025-03-09 10:01:36,385 [INFO]: 	index_key: HNSW15
2025-03-09 10:01:36,385 [INFO]: 	index_param: efSearch=160
2025-03-09 10:01:36,385 [INFO]: 	index_path: knn.index
2025-03-09 10:01:36,385 [INFO]: 	size in bytes: 1261522990
2025-03-09 10:01:36,385 [INFO]: 	avg_search_speed_ms: 7.78617028754808
2025-03-09 10:01:36,385 [INFO]: 	99p_search_speed_ms: 18.375906152650753
2025-03-09 10:01:36,385 [INFO]: 	reconstruction error %: 0.0
2025-03-09 10:01:36,385 [INFO]: 	nb vectors: 6412
2025-03-09 10:01:36,385 [INFO]: 	vectors dimension: 49152
2025-03-09 10:01:36,385 [INFO]: 	compression ratio: 0.9993083804203996
2025-03-09 10:01:36,385 [INFO]: }
2025-03-09 10:01:36,385 [INFO]: 	>>> Finished "Creating the index" in 83.5460 secs
2025-03-09 10:01:36,385 [INFO]: >>> Finished "Launching the whole pipeline" in 83.5829 secs
2025-03-09 10:01:37: [retrieval_preprocessing] calculating distances ...
2025-03-09 10:01:38: [retrieval_preprocessing] finished and saved retrieval indices for episode 35486 [episode count 13/20]
[retrieval_preprocessing] for episode 53662 [episode count 14/20], we have num_retrieval=np.int64(6226) num_query=np.int64(456)
2025-03-09 10:01:40,190 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-09 10:01:41,119 [INFO]: Launching the whole pipeline 03/09/2025, 10:01:41
2025-03-09 10:01:41,119 [INFO]: Reading total number of vectors and dimension 03/09/2025, 10:01:41
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1553.45it/s]
2025-03-09 10:01:41,144 [INFO]: There are 6226 embeddings of dim 49152
2025-03-09 10:01:41,144 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0254 secs
2025-03-09 10:01:41,144 [INFO]: 	Compute estimated construction time of the index 03/09/2025, 10:01:41
2025-03-09 10:01:41,144 [INFO]: 		-> Train: 16.7 minutes
2025-03-09 10:01:41,144 [INFO]: 		-> Add: 3.4 seconds
2025-03-09 10:01:41,144 [INFO]: 		Total: 16.7 minutes
2025-03-09 10:01:41,144 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0001 secs
2025-03-09 10:01:41,144 [INFO]: 	Checking that your have enough memory available to create the index 03/09/2025, 10:01:41
2025-03-09 10:01:41,145 [INFO]: 1.3GB of memory will be needed to build the index (more might be used if you have more)
2025-03-09 10:01:41,145 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0001 secs
2025-03-09 10:01:41,145 [INFO]: 	Selecting most promising index types given data characteristics 03/09/2025, 10:01:41
2025-03-09 10:01:41,145 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-09 10:01:41,145 [INFO]: 	Creating the index 03/09/2025, 10:01:41
2025-03-09 10:01:41,145 [INFO]: 		-> Instanciate the index HNSW15 03/09/2025, 10:01:41
2025-03-09 10:01:41,146 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0009 secs
2025-03-09 10:01:41,146 [INFO]: 		-> Adding the vectors to the index 03/09/2025, 10:01:41
2025-03-09 10:01:41,146 [INFO]: The memory available for adding the vectors is 48.9GB(total available - used by the index)
2025-03-09 10:01:41,146 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/26 [00:00<?, ?it/s]  4%|▍         | 1/26 [00:00<00:06,  4.11it/s]  8%|▊         | 2/26 [00:00<00:04,  5.92it/s] 15%|█▌        | 4/26 [00:00<00:02,  7.98it/s] 23%|██▎       | 6/26 [00:00<00:02,  9.02it/s] 27%|██▋       | 7/26 [00:00<00:02,  9.23it/s] 31%|███       | 8/26 [00:00<00:01,  9.25it/s] 35%|███▍      | 9/26 [00:01<00:01,  9.33it/s] 38%|███▊      | 10/26 [00:01<00:01,  9.46it/s] 42%|████▏     | 11/26 [00:01<00:01,  9.59it/s] 46%|████▌     | 12/26 [00:01<00:01,  9.65it/s] 50%|█████     | 13/26 [00:01<00:01,  9.60it/s] 54%|█████▍    | 14/26 [00:01<00:01,  9.55it/s] 58%|█████▊    | 15/26 [00:01<00:01,  9.64it/s] 62%|██████▏   | 16/26 [00:01<00:01,  9.58it/s] 65%|██████▌   | 17/26 [00:01<00:00,  9.48it/s] 73%|███████▎  | 19/26 [00:02<00:00, 10.46it/s] 81%|████████  | 21/26 [00:05<00:04,  1.23it/s] 85%|████████▍ | 22/26 [00:05<00:02,  1.53it/s] 92%|█████████▏| 24/26 [00:06<00:00,  2.30it/s]100%|██████████| 26/26 [00:08<00:00,  1.57it/s]100%|██████████| 26/26 [00:08<00:00,  3.19it/s]
2025-03-09 10:01:50,135 [INFO]: 	Computing best hyperparameters for index knn.index 03/09/2025, 10:01:50
2025-03-09 10:02:44,600 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 54.4650 secs
2025-03-09 10:02:44,601 [INFO]: The best hyperparameters are: efSearch=145
2025-03-09 10:02:44,601 [INFO]: 	Compute fast metrics 03/09/2025, 10:02:44
  0%|          | 0/4 [00:00<?, ?it/s] 25%|██▌       | 1/4 [00:00<00:00,  5.34it/s] 50%|█████     | 2/4 [00:00<00:00,  7.26it/s] 75%|███████▌  | 3/4 [00:00<00:00,  8.01it/s] 75%|███████▌  | 3/4 [00:00<00:00,  5.97it/s]
2025-03-09 10:03:08,956 [INFO]: 	>>> Finished "Compute fast metrics" in 24.3551 secs
2025-03-09 10:03:08,957 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 87.8113 secs
2025-03-09 10:03:08,957 [INFO]: {
2025-03-09 10:03:08,957 [INFO]: 	index_key: HNSW15
2025-03-09 10:03:08,957 [INFO]: 	index_param: efSearch=145
2025-03-09 10:03:08,957 [INFO]: 	index_path: knn.index
2025-03-09 10:03:08,957 [INFO]: 	size in bytes: 1224928570
2025-03-09 10:03:08,957 [INFO]: 	avg_search_speed_ms: 6.7723364330106355
2025-03-09 10:03:08,957 [INFO]: 	99p_search_speed_ms: 14.103260822594166
2025-03-09 10:03:08,957 [INFO]: 	reconstruction error %: 0.0
2025-03-09 10:03:08,957 [INFO]: 	nb vectors: 6226
2025-03-09 10:03:08,957 [INFO]: 	vectors dimension: 49152
2025-03-09 10:03:08,957 [INFO]: 	compression ratio: 0.9993083988562697
2025-03-09 10:03:08,957 [INFO]: }
2025-03-09 10:03:08,957 [INFO]: 	>>> Finished "Creating the index" in 87.8126 secs
2025-03-09 10:03:08,957 [INFO]: >>> Finished "Launching the whole pipeline" in 87.8386 secs
2025-03-09 10:03:10: [retrieval_preprocessing] calculating distances ...
2025-03-09 10:03:11: [retrieval_preprocessing] finished and saved retrieval indices for episode 53662 [episode count 14/20]
[retrieval_preprocessing] for episode 58524 [episode count 15/20], we have num_retrieval=np.int64(6326) num_query=np.int64(356)
2025-03-09 10:03:13,754 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-09 10:03:14,747 [INFO]: Launching the whole pipeline 03/09/2025, 10:03:14
2025-03-09 10:03:14,747 [INFO]: Reading total number of vectors and dimension 03/09/2025, 10:03:14
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1356.06it/s]
2025-03-09 10:03:14,774 [INFO]: There are 6326 embeddings of dim 49152
2025-03-09 10:03:14,774 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0271 secs
2025-03-09 10:03:14,774 [INFO]: 	Compute estimated construction time of the index 03/09/2025, 10:03:14
2025-03-09 10:03:14,774 [INFO]: 		-> Train: 16.7 minutes
2025-03-09 10:03:14,774 [INFO]: 		-> Add: 3.5 seconds
2025-03-09 10:03:14,774 [INFO]: 		Total: 16.7 minutes
2025-03-09 10:03:14,774 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0001 secs
2025-03-09 10:03:14,774 [INFO]: 	Checking that your have enough memory available to create the index 03/09/2025, 10:03:14
2025-03-09 10:03:14,774 [INFO]: 1.3GB of memory will be needed to build the index (more might be used if you have more)
2025-03-09 10:03:14,774 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0001 secs
2025-03-09 10:03:14,774 [INFO]: 	Selecting most promising index types given data characteristics 03/09/2025, 10:03:14
2025-03-09 10:03:14,774 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-09 10:03:14,774 [INFO]: 	Creating the index 03/09/2025, 10:03:14
2025-03-09 10:03:14,774 [INFO]: 		-> Instanciate the index HNSW15 03/09/2025, 10:03:14
2025-03-09 10:03:14,775 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0011 secs
2025-03-09 10:03:14,776 [INFO]: 		-> Adding the vectors to the index 03/09/2025, 10:03:14
2025-03-09 10:03:14,776 [INFO]: The memory available for adding the vectors is 48.8GB(total available - used by the index)
2025-03-09 10:03:14,776 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/26 [00:00<?, ?it/s]  4%|▍         | 1/26 [00:00<00:05,  4.39it/s]  8%|▊         | 2/26 [00:00<00:03,  6.12it/s] 12%|█▏        | 3/26 [00:00<00:03,  7.05it/s] 15%|█▌        | 4/26 [00:00<00:02,  7.59it/s] 19%|█▉        | 5/26 [00:00<00:02,  7.81it/s] 23%|██▎       | 6/26 [00:00<00:02,  8.09it/s] 27%|██▋       | 7/26 [00:00<00:02,  8.40it/s] 31%|███       | 8/26 [00:01<00:02,  8.59it/s] 35%|███▍      | 9/26 [00:01<00:01,  8.85it/s] 38%|███▊      | 10/26 [00:01<00:01,  8.88it/s] 42%|████▏     | 11/26 [00:01<00:01,  8.96it/s] 46%|████▌     | 12/26 [00:01<00:01,  8.96it/s] 50%|█████     | 13/26 [00:01<00:01,  9.01it/s] 54%|█████▍    | 14/26 [00:01<00:01,  9.10it/s] 58%|█████▊    | 15/26 [00:01<00:01,  9.34it/s] 62%|██████▏   | 16/26 [00:01<00:01,  9.40it/s] 65%|██████▌   | 17/26 [00:02<00:00,  9.41it/s] 69%|██████▉   | 18/26 [00:02<00:00,  9.40it/s] 77%|███████▋  | 20/26 [00:02<00:00, 10.97it/s] 85%|████████▍ | 22/26 [00:05<00:03,  1.26it/s] 92%|█████████▏| 24/26 [00:06<00:01,  1.88it/s]100%|██████████| 26/26 [00:08<00:00,  1.29it/s]100%|██████████| 26/26 [00:08<00:00,  3.02it/s]
2025-03-09 10:03:23,386 [INFO]: 	Computing best hyperparameters for index knn.index 03/09/2025, 10:03:23
2025-03-09 10:04:14,450 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 51.0632 secs
2025-03-09 10:04:14,450 [INFO]: The best hyperparameters are: efSearch=189
2025-03-09 10:04:14,450 [INFO]: 	Compute fast metrics 03/09/2025, 10:04:14
  0%|          | 0/4 [00:00<?, ?it/s] 50%|█████     | 2/4 [00:00<00:00, 16.92it/s] 75%|███████▌  | 3/4 [00:00<00:00, 19.09it/s]
2025-03-09 10:04:32,931 [INFO]: 	>>> Finished "Compute fast metrics" in 18.4809 secs
2025-03-09 10:04:32,932 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 78.1566 secs
2025-03-09 10:04:32,932 [INFO]: {
2025-03-09 10:04:32,932 [INFO]: 	index_key: HNSW15
2025-03-09 10:04:32,932 [INFO]: 	index_param: efSearch=189
2025-03-09 10:04:32,932 [INFO]: 	index_path: knn.index
2025-03-09 10:04:32,932 [INFO]: 	size in bytes: 1244602930
2025-03-09 10:04:32,932 [INFO]: 	avg_search_speed_ms: 10.099024404630516
2025-03-09 10:04:32,932 [INFO]: 	99p_search_speed_ms: 22.59664930868894
2025-03-09 10:04:32,932 [INFO]: 	reconstruction error %: 0.0
2025-03-09 10:04:32,932 [INFO]: 	nb vectors: 6326
2025-03-09 10:04:32,932 [INFO]: 	vectors dimension: 49152
2025-03-09 10:04:32,932 [INFO]: 	compression ratio: 0.9993084364665604
2025-03-09 10:04:32,932 [INFO]: }
2025-03-09 10:04:32,932 [INFO]: 	>>> Finished "Creating the index" in 78.1582 secs
2025-03-09 10:04:32,933 [INFO]: >>> Finished "Launching the whole pipeline" in 78.1859 secs
2025-03-09 10:04:34: [retrieval_preprocessing] calculating distances ...
2025-03-09 10:04:36: [retrieval_preprocessing] finished and saved retrieval indices for episode 58524 [episode count 15/20]
[retrieval_preprocessing] for episode 93218 [episode count 16/20], we have num_retrieval=np.int64(6421) num_query=np.int64(261)
2025-03-09 10:04:38,052 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-09 10:04:38,904 [INFO]: Launching the whole pipeline 03/09/2025, 10:04:38
2025-03-09 10:04:38,904 [INFO]: Reading total number of vectors and dimension 03/09/2025, 10:04:38
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1256.91it/s]
2025-03-09 10:04:38,934 [INFO]: There are 6421 embeddings of dim 49152
2025-03-09 10:04:38,934 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0304 secs
2025-03-09 10:04:38,934 [INFO]: 	Compute estimated construction time of the index 03/09/2025, 10:04:38
2025-03-09 10:04:38,934 [INFO]: 		-> Train: 16.7 minutes
2025-03-09 10:04:38,934 [INFO]: 		-> Add: 3.5 seconds
2025-03-09 10:04:38,935 [INFO]: 		Total: 16.7 minutes
2025-03-09 10:04:38,935 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0001 secs
2025-03-09 10:04:38,935 [INFO]: 	Checking that your have enough memory available to create the index 03/09/2025, 10:04:38
2025-03-09 10:04:38,935 [INFO]: 1.3GB of memory will be needed to build the index (more might be used if you have more)
2025-03-09 10:04:38,935 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0001 secs
2025-03-09 10:04:38,935 [INFO]: 	Selecting most promising index types given data characteristics 03/09/2025, 10:04:38
2025-03-09 10:04:38,935 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-09 10:04:38,935 [INFO]: 	Creating the index 03/09/2025, 10:04:38
2025-03-09 10:04:38,935 [INFO]: 		-> Instanciate the index HNSW15 03/09/2025, 10:04:38
2025-03-09 10:04:38,936 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0010 secs
2025-03-09 10:04:38,936 [INFO]: 		-> Adding the vectors to the index 03/09/2025, 10:04:38
2025-03-09 10:04:38,936 [INFO]: The memory available for adding the vectors is 48.8GB(total available - used by the index)
2025-03-09 10:04:38,936 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/27 [00:00<?, ?it/s]  4%|▎         | 1/27 [00:00<00:04,  5.26it/s] 11%|█         | 3/27 [00:00<00:02,  9.75it/s] 19%|█▊        | 5/27 [00:00<00:01, 11.33it/s] 26%|██▌       | 7/27 [00:00<00:01, 12.08it/s] 33%|███▎      | 9/27 [00:00<00:01, 12.38it/s] 41%|████      | 11/27 [00:00<00:01, 12.82it/s] 48%|████▊     | 13/27 [00:01<00:01, 12.98it/s] 56%|█████▌    | 15/27 [00:01<00:00, 13.20it/s] 63%|██████▎   | 17/27 [00:01<00:00, 13.31it/s] 70%|███████   | 19/27 [00:01<00:00, 13.22it/s] 78%|███████▊  | 21/27 [00:05<00:03,  1.56it/s] 81%|████████▏ | 22/27 [00:05<00:02,  1.83it/s] 89%|████████▉ | 24/27 [00:05<00:01,  2.59it/s] 96%|█████████▋| 26/27 [00:05<00:00,  3.51it/s]100%|██████████| 27/27 [00:07<00:00,  3.40it/s]
2025-03-09 10:04:46,884 [INFO]: 	Computing best hyperparameters for index knn.index 03/09/2025, 10:04:46
2025-03-09 10:05:33,791 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 46.9062 secs
2025-03-09 10:05:33,791 [INFO]: The best hyperparameters are: efSearch=180
2025-03-09 10:05:33,791 [INFO]: 	Compute fast metrics 03/09/2025, 10:05:33
  0%|          | 0/4 [00:00<?, ?it/s] 25%|██▌       | 1/4 [00:00<00:00,  5.65it/s] 75%|███████▌  | 3/4 [00:00<00:00,  8.59it/s] 75%|███████▌  | 3/4 [00:00<00:00,  6.75it/s]
2025-03-09 10:05:52,050 [INFO]: 	>>> Finished "Compute fast metrics" in 18.2592 secs
2025-03-09 10:05:52,052 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 73.1155 secs
2025-03-09 10:05:52,052 [INFO]: {
2025-03-09 10:05:52,052 [INFO]: 	index_key: HNSW15
2025-03-09 10:05:52,052 [INFO]: 	index_param: efSearch=180
2025-03-09 10:05:52,052 [INFO]: 	index_path: knn.index
2025-03-09 10:05:52,052 [INFO]: 	size in bytes: 1263293650
2025-03-09 10:05:52,052 [INFO]: 	avg_search_speed_ms: 7.480265741412742
2025-03-09 10:05:52,052 [INFO]: 	99p_search_speed_ms: 14.885591650381697
2025-03-09 10:05:52,052 [INFO]: 	reconstruction error %: 0.0
2025-03-09 10:05:52,052 [INFO]: 	nb vectors: 6421
2025-03-09 10:05:52,052 [INFO]: 	vectors dimension: 49152
2025-03-09 10:05:52,052 [INFO]: 	compression ratio: 0.9993084094105911
2025-03-09 10:05:52,052 [INFO]: }
2025-03-09 10:05:52,052 [INFO]: 	>>> Finished "Creating the index" in 73.1169 secs
2025-03-09 10:05:52,052 [INFO]: >>> Finished "Launching the whole pipeline" in 73.1480 secs
2025-03-09 10:05:53: [retrieval_preprocessing] calculating distances ...
2025-03-09 10:05:53: [retrieval_preprocessing] finished and saved retrieval indices for episode 93218 [episode count 16/20]
[retrieval_preprocessing] for episode 31396 [episode count 17/20], we have num_retrieval=np.int64(6245) num_query=np.int64(437)
2025-03-09 10:05:55,792 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-09 10:05:56,663 [INFO]: Launching the whole pipeline 03/09/2025, 10:05:56
2025-03-09 10:05:56,663 [INFO]: Reading total number of vectors and dimension 03/09/2025, 10:05:56
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1147.55it/s]
2025-03-09 10:05:56,694 [INFO]: There are 6245 embeddings of dim 49152
2025-03-09 10:05:56,694 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0311 secs
2025-03-09 10:05:56,694 [INFO]: 	Compute estimated construction time of the index 03/09/2025, 10:05:56
2025-03-09 10:05:56,694 [INFO]: 		-> Train: 16.7 minutes
2025-03-09 10:05:56,694 [INFO]: 		-> Add: 3.4 seconds
2025-03-09 10:05:56,694 [INFO]: 		Total: 16.7 minutes
2025-03-09 10:05:56,694 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0002 secs
2025-03-09 10:05:56,694 [INFO]: 	Checking that your have enough memory available to create the index 03/09/2025, 10:05:56
2025-03-09 10:05:56,694 [INFO]: 1.3GB of memory will be needed to build the index (more might be used if you have more)
2025-03-09 10:05:56,694 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0001 secs
2025-03-09 10:05:56,694 [INFO]: 	Selecting most promising index types given data characteristics 03/09/2025, 10:05:56
2025-03-09 10:05:56,694 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-09 10:05:56,695 [INFO]: 	Creating the index 03/09/2025, 10:05:56
2025-03-09 10:05:56,695 [INFO]: 		-> Instanciate the index HNSW15 03/09/2025, 10:05:56
2025-03-09 10:05:56,695 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0008 secs
2025-03-09 10:05:56,696 [INFO]: 		-> Adding the vectors to the index 03/09/2025, 10:05:56
2025-03-09 10:05:56,696 [INFO]: The memory available for adding the vectors is 48.9GB(total available - used by the index)
2025-03-09 10:05:56,696 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/26 [00:00<?, ?it/s]  4%|▍         | 1/26 [00:00<00:04,  5.76it/s] 12%|█▏        | 3/26 [00:00<00:02, 10.19it/s] 19%|█▉        | 5/26 [00:00<00:01, 11.65it/s] 27%|██▋       | 7/26 [00:00<00:01, 12.00it/s] 35%|███▍      | 9/26 [00:00<00:01, 12.39it/s] 42%|████▏     | 11/26 [00:00<00:01, 12.32it/s] 50%|█████     | 13/26 [00:01<00:01, 12.70it/s] 58%|█████▊    | 15/26 [00:01<00:00, 12.87it/s] 65%|██████▌   | 17/26 [00:01<00:00, 13.02it/s] 73%|███████▎  | 19/26 [00:01<00:00, 13.22it/s] 81%|████████  | 21/26 [00:04<00:02,  1.75it/s] 88%|████████▊ | 23/26 [00:05<00:01,  2.36it/s] 96%|█████████▌| 25/26 [00:05<00:00,  3.10it/s]100%|██████████| 26/26 [00:07<00:00,  3.43it/s]
2025-03-09 10:06:04,277 [INFO]: 	Computing best hyperparameters for index knn.index 03/09/2025, 10:06:04
2025-03-09 10:06:49,973 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 45.6964 secs
2025-03-09 10:06:49,974 [INFO]: The best hyperparameters are: efSearch=164
2025-03-09 10:06:49,974 [INFO]: 	Compute fast metrics 03/09/2025, 10:06:49
  0%|          | 0/4 [00:00<?, ?it/s] 25%|██▌       | 1/4 [00:00<00:00,  5.39it/s] 50%|█████     | 2/4 [00:00<00:00,  7.38it/s] 75%|███████▌  | 3/4 [00:00<00:00,  6.29it/s]
2025-03-09 10:07:06,099 [INFO]: 	>>> Finished "Compute fast metrics" in 16.1255 secs
2025-03-09 10:07:06,100 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 69.4049 secs
2025-03-09 10:07:06,101 [INFO]: {
2025-03-09 10:07:06,101 [INFO]: 	index_key: HNSW15
2025-03-09 10:07:06,101 [INFO]: 	index_param: efSearch=164
2025-03-09 10:07:06,101 [INFO]: 	index_path: knn.index
2025-03-09 10:07:06,101 [INFO]: 	size in bytes: 1228666750
2025-03-09 10:07:06,101 [INFO]: 	avg_search_speed_ms: 7.66815422274218
2025-03-09 10:07:06,101 [INFO]: 	99p_search_speed_ms: 14.846231273841118
2025-03-09 10:07:06,101 [INFO]: 	reconstruction error %: 0.0
2025-03-09 10:07:06,101 [INFO]: 	nb vectors: 6245
2025-03-09 10:07:06,101 [INFO]: 	vectors dimension: 49152
2025-03-09 10:07:06,101 [INFO]: 	compression ratio: 0.9993083641272135
2025-03-09 10:07:06,101 [INFO]: }
2025-03-09 10:07:06,101 [INFO]: 	>>> Finished "Creating the index" in 69.4062 secs
2025-03-09 10:07:06,101 [INFO]: >>> Finished "Launching the whole pipeline" in 69.4379 secs
2025-03-09 10:07:07: [retrieval_preprocessing] calculating distances ...
2025-03-09 10:07:09: [retrieval_preprocessing] finished and saved retrieval indices for episode 31396 [episode count 17/20]
[retrieval_preprocessing] for episode 41126 [episode count 18/20], we have num_retrieval=np.int64(6513) num_query=np.int64(169)
2025-03-09 10:07:10,909 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-09 10:07:11,745 [INFO]: Launching the whole pipeline 03/09/2025, 10:07:11
2025-03-09 10:07:11,745 [INFO]: Reading total number of vectors and dimension 03/09/2025, 10:07:11
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 992.26it/s]
2025-03-09 10:07:11,779 [INFO]: There are 6513 embeddings of dim 49152
2025-03-09 10:07:11,780 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0343 secs
2025-03-09 10:07:11,780 [INFO]: 	Compute estimated construction time of the index 03/09/2025, 10:07:11
2025-03-09 10:07:11,780 [INFO]: 		-> Train: 16.7 minutes
2025-03-09 10:07:11,780 [INFO]: 		-> Add: 3.6 seconds
2025-03-09 10:07:11,780 [INFO]: 		Total: 16.7 minutes
2025-03-09 10:07:11,780 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0003 secs
2025-03-09 10:07:11,780 [INFO]: 	Checking that your have enough memory available to create the index 03/09/2025, 10:07:11
2025-03-09 10:07:11,781 [INFO]: 1.3GB of memory will be needed to build the index (more might be used if you have more)
2025-03-09 10:07:11,781 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0004 secs
2025-03-09 10:07:11,781 [INFO]: 	Selecting most promising index types given data characteristics 03/09/2025, 10:07:11
2025-03-09 10:07:11,781 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-09 10:07:11,781 [INFO]: 	Creating the index 03/09/2025, 10:07:11
2025-03-09 10:07:11,781 [INFO]: 		-> Instanciate the index HNSW15 03/09/2025, 10:07:11
2025-03-09 10:07:11,784 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0026 secs
2025-03-09 10:07:11,784 [INFO]: 		-> Adding the vectors to the index 03/09/2025, 10:07:11
2025-03-09 10:07:11,784 [INFO]: The memory available for adding the vectors is 48.8GB(total available - used by the index)
2025-03-09 10:07:11,784 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/27 [00:00<?, ?it/s]  4%|▎         | 1/27 [00:00<00:04,  5.61it/s] 11%|█         | 3/27 [00:00<00:02,  9.60it/s] 19%|█▊        | 5/27 [00:00<00:01, 12.80it/s] 26%|██▌       | 7/27 [00:00<00:01, 13.22it/s] 33%|███▎      | 9/27 [00:00<00:01, 13.19it/s] 41%|████      | 11/27 [00:00<00:01, 13.22it/s] 48%|████▊     | 13/27 [00:01<00:01, 13.08it/s] 56%|█████▌    | 15/27 [00:01<00:00, 13.12it/s] 63%|██████▎   | 17/27 [00:01<00:00, 13.19it/s] 70%|███████   | 19/27 [00:01<00:00, 13.06it/s] 78%|███████▊  | 21/27 [00:04<00:03,  1.80it/s] 85%|████████▌ | 23/27 [00:04<00:01,  2.42it/s] 93%|█████████▎| 25/27 [00:05<00:00,  3.21it/s]100%|██████████| 27/27 [00:07<00:00,  1.77it/s]100%|██████████| 27/27 [00:07<00:00,  3.65it/s]
2025-03-09 10:07:19,188 [INFO]: 	Computing best hyperparameters for index knn.index 03/09/2025, 10:07:19
2025-03-09 10:08:13,567 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 54.3786 secs
2025-03-09 10:08:13,567 [INFO]: The best hyperparameters are: efSearch=185
2025-03-09 10:08:13,567 [INFO]: 	Compute fast metrics 03/09/2025, 10:08:13
  0%|          | 0/4 [00:00<?, ?it/s] 25%|██▌       | 1/4 [00:00<00:00,  6.71it/s] 75%|███████▌  | 3/4 [00:00<00:00, 13.97it/s]
2025-03-09 10:08:37,358 [INFO]: 	>>> Finished "Compute fast metrics" in 23.7907 secs
2025-03-09 10:08:37,360 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 85.5756 secs
2025-03-09 10:08:37,360 [INFO]: {
2025-03-09 10:08:37,360 [INFO]: 	index_key: HNSW15
2025-03-09 10:08:37,360 [INFO]: 	index_param: efSearch=185
2025-03-09 10:08:37,360 [INFO]: 	index_path: knn.index
2025-03-09 10:08:37,360 [INFO]: 	size in bytes: 1281394030
2025-03-09 10:08:37,360 [INFO]: 	avg_search_speed_ms: 8.149355040831278
2025-03-09 10:08:37,360 [INFO]: 	99p_search_speed_ms: 19.482366791926328
2025-03-09 10:08:37,360 [INFO]: 	reconstruction error %: 0.0
2025-03-09 10:08:37,360 [INFO]: 	nb vectors: 6513
2025-03-09 10:08:37,360 [INFO]: 	vectors dimension: 49152
2025-03-09 10:08:37,360 [INFO]: 	compression ratio: 0.9993084672011465
2025-03-09 10:08:37,360 [INFO]: }
2025-03-09 10:08:37,360 [INFO]: 	>>> Finished "Creating the index" in 85.5790 secs
2025-03-09 10:08:37,360 [INFO]: >>> Finished "Launching the whole pipeline" in 85.6149 secs
2025-03-09 10:08:38: [retrieval_preprocessing] calculating distances ...
2025-03-09 10:08:38: [retrieval_preprocessing] finished and saved retrieval indices for episode 41126 [episode count 18/20]
[retrieval_preprocessing] for episode 5290 [episode count 19/20], we have num_retrieval=np.int64(6307) num_query=np.int64(375)
2025-03-09 10:08:40,738 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-09 10:08:41,661 [INFO]: Launching the whole pipeline 03/09/2025, 10:08:41
2025-03-09 10:08:41,661 [INFO]: Reading total number of vectors and dimension 03/09/2025, 10:08:41
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1305.42it/s]
2025-03-09 10:08:41,687 [INFO]: There are 6307 embeddings of dim 49152
2025-03-09 10:08:41,687 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0262 secs
2025-03-09 10:08:41,687 [INFO]: 	Compute estimated construction time of the index 03/09/2025, 10:08:41
2025-03-09 10:08:41,687 [INFO]: 		-> Train: 16.7 minutes
2025-03-09 10:08:41,687 [INFO]: 		-> Add: 3.5 seconds
2025-03-09 10:08:41,687 [INFO]: 		Total: 16.7 minutes
2025-03-09 10:08:41,687 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0001 secs
2025-03-09 10:08:41,687 [INFO]: 	Checking that your have enough memory available to create the index 03/09/2025, 10:08:41
2025-03-09 10:08:41,687 [INFO]: 1.3GB of memory will be needed to build the index (more might be used if you have more)
2025-03-09 10:08:41,687 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0001 secs
2025-03-09 10:08:41,687 [INFO]: 	Selecting most promising index types given data characteristics 03/09/2025, 10:08:41
2025-03-09 10:08:41,687 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-09 10:08:41,687 [INFO]: 	Creating the index 03/09/2025, 10:08:41
2025-03-09 10:08:41,687 [INFO]: 		-> Instanciate the index HNSW15 03/09/2025, 10:08:41
2025-03-09 10:08:41,689 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0011 secs
2025-03-09 10:08:41,689 [INFO]: 		-> Adding the vectors to the index 03/09/2025, 10:08:41
2025-03-09 10:08:41,689 [INFO]: The memory available for adding the vectors is 48.8GB(total available - used by the index)
2025-03-09 10:08:41,689 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/26 [00:00<?, ?it/s]  4%|▍         | 1/26 [00:00<00:05,  4.37it/s]  8%|▊         | 2/26 [00:00<00:04,  5.96it/s] 12%|█▏        | 3/26 [00:00<00:03,  6.65it/s] 15%|█▌        | 4/26 [00:00<00:03,  7.20it/s] 19%|█▉        | 5/26 [00:00<00:02,  7.36it/s] 23%|██▎       | 6/26 [00:00<00:02,  7.51it/s] 27%|██▋       | 7/26 [00:00<00:02,  7.62it/s] 31%|███       | 8/26 [00:01<00:02,  7.68it/s] 35%|███▍      | 9/26 [00:01<00:02,  7.81it/s] 38%|███▊      | 10/26 [00:01<00:02,  6.93it/s] 42%|████▏     | 11/26 [00:01<00:02,  7.28it/s] 46%|████▌     | 12/26 [00:01<00:01,  7.61it/s] 50%|█████     | 13/26 [00:01<00:01,  7.85it/s] 58%|█████▊    | 15/26 [00:01<00:01,  9.26it/s] 65%|██████▌   | 17/26 [00:02<00:00, 10.02it/s] 73%|███████▎  | 19/26 [00:02<00:00, 10.26it/s] 81%|████████  | 21/26 [00:05<00:03,  1.47it/s] 88%|████████▊ | 23/26 [00:06<00:01,  2.06it/s] 96%|█████████▌| 25/26 [00:06<00:00,  2.82it/s]100%|██████████| 26/26 [00:08<00:00,  1.49it/s]100%|██████████| 26/26 [00:08<00:00,  3.13it/s]
2025-03-09 10:08:50,015 [INFO]: 	Computing best hyperparameters for index knn.index 03/09/2025, 10:08:50
2025-03-09 10:09:38,783 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 48.7677 secs
2025-03-09 10:09:38,783 [INFO]: The best hyperparameters are: efSearch=186
2025-03-09 10:09:38,783 [INFO]: 	Compute fast metrics 03/09/2025, 10:09:38
  0%|          | 0/4 [00:00<?, ?it/s] 25%|██▌       | 1/4 [00:00<00:00,  5.99it/s] 50%|█████     | 2/4 [00:00<00:00,  7.51it/s] 75%|███████▌  | 3/4 [00:00<00:00,  8.38it/s] 75%|███████▌  | 3/4 [00:00<00:00,  6.33it/s]
2025-03-09 10:09:56,106 [INFO]: 	>>> Finished "Compute fast metrics" in 17.3231 secs
2025-03-09 10:09:56,107 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 74.4188 secs
2025-03-09 10:09:56,107 [INFO]: {
2025-03-09 10:09:56,107 [INFO]: 	index_key: HNSW15
2025-03-09 10:09:56,108 [INFO]: 	index_param: efSearch=186
2025-03-09 10:09:56,108 [INFO]: 	index_path: knn.index
2025-03-09 10:09:56,108 [INFO]: 	size in bytes: 1240864870
2025-03-09 10:09:56,108 [INFO]: 	avg_search_speed_ms: 7.828875372810589
2025-03-09 10:09:56,108 [INFO]: 	99p_search_speed_ms: 14.28864561952651
2025-03-09 10:09:56,108 [INFO]: 	reconstruction error %: 0.0
2025-03-09 10:09:56,108 [INFO]: 	nb vectors: 6307
2025-03-09 10:09:56,108 [INFO]: 	vectors dimension: 49152
2025-03-09 10:09:56,108 [INFO]: 	compression ratio: 0.9993083743276574
2025-03-09 10:09:56,108 [INFO]: }
2025-03-09 10:09:56,108 [INFO]: 	>>> Finished "Creating the index" in 74.4203 secs
2025-03-09 10:09:56,108 [INFO]: >>> Finished "Launching the whole pipeline" in 74.4470 secs
2025-03-09 10:09:57: [retrieval_preprocessing] calculating distances ...
2025-03-09 10:09:58: [retrieval_preprocessing] finished and saved retrieval indices for episode 5290 [episode count 19/20]
2025-03-09 10:09:58: [retrieval_preprocessing] finished for (6093644330, 'cloth') [chosen_id count 8/10]
2025-03-09 10:10:00: [retrieval_preprocessing] concatenated all embeddings and indices for 20 episodes for (4345518188, 'lid') [chosen_id count 9/10]
2025-03-09 10:10:00: [retrieval_preprocessing] we have num_total=3878 embedding_dim=49152
[retrieval_preprocessing] for episode 20992 [episode count 0/20], we have num_retrieval=np.int64(3684) num_query=np.int64(194)
2025-03-09 10:10:01,663 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-09 10:10:02,171 [INFO]: Launching the whole pipeline 03/09/2025, 10:10:02
2025-03-09 10:10:02,172 [INFO]: Reading total number of vectors and dimension 03/09/2025, 10:10:02
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1415.08it/s]
2025-03-09 10:10:02,198 [INFO]: There are 3684 embeddings of dim 49152
2025-03-09 10:10:02,199 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0271 secs
2025-03-09 10:10:02,199 [INFO]: 	Compute estimated construction time of the index 03/09/2025, 10:10:02
2025-03-09 10:10:02,199 [INFO]: 		-> Train: 16.7 minutes
2025-03-09 10:10:02,199 [INFO]: 		-> Add: 2.0 seconds
2025-03-09 10:10:02,199 [INFO]: 		Total: 16.7 minutes
2025-03-09 10:10:02,199 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0002 secs
2025-03-09 10:10:02,199 [INFO]: 	Checking that your have enough memory available to create the index 03/09/2025, 10:10:02
2025-03-09 10:10:02,199 [INFO]: 760.3MB of memory will be needed to build the index (more might be used if you have more)
2025-03-09 10:10:02,199 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0002 secs
2025-03-09 10:10:02,199 [INFO]: 	Selecting most promising index types given data characteristics 03/09/2025, 10:10:02
2025-03-09 10:10:02,199 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-09 10:10:02,199 [INFO]: 	Creating the index 03/09/2025, 10:10:02
2025-03-09 10:10:02,200 [INFO]: 		-> Instanciate the index HNSW15 03/09/2025, 10:10:02
2025-03-09 10:10:02,201 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0013 secs
2025-03-09 10:10:02,201 [INFO]: 		-> Adding the vectors to the index 03/09/2025, 10:10:02
2025-03-09 10:10:02,201 [INFO]: The memory available for adding the vectors is 49.3GB(total available - used by the index)
2025-03-09 10:10:02,201 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/15 [00:00<?, ?it/s]  7%|▋         | 1/15 [00:00<00:02,  6.80it/s] 20%|██        | 3/15 [00:00<00:01, 11.12it/s] 33%|███▎      | 5/15 [00:00<00:00, 12.77it/s] 47%|████▋     | 7/15 [00:00<00:00, 13.38it/s] 60%|██████    | 9/15 [00:00<00:00, 13.52it/s] 73%|███████▎  | 11/15 [00:00<00:00, 13.45it/s] 87%|████████▋ | 13/15 [00:01<00:00, 13.27it/s]100%|██████████| 15/15 [00:03<00:00,  2.30it/s]100%|██████████| 15/15 [00:03<00:00,  4.43it/s]
2025-03-09 10:10:05,593 [INFO]: 	Computing best hyperparameters for index knn.index 03/09/2025, 10:10:05
2025-03-09 10:10:37,432 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 31.8392 secs
2025-03-09 10:10:37,432 [INFO]: The best hyperparameters are: efSearch=282
2025-03-09 10:10:37,433 [INFO]: 	Compute fast metrics 03/09/2025, 10:10:37
  0%|          | 0/4 [00:00<?, ?it/s] 25%|██▌       | 1/4 [00:00<00:00,  6.93it/s] 75%|███████▌  | 3/4 [00:00<00:00, 11.18it/s] 75%|███████▌  | 3/4 [00:00<00:00,  8.49it/s]
2025-03-09 10:10:51,053 [INFO]: 	>>> Finished "Compute fast metrics" in 13.6199 secs
2025-03-09 10:10:51,055 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 48.8542 secs
2025-03-09 10:10:51,055 [INFO]: {
2025-03-09 10:10:51,055 [INFO]: 	index_key: HNSW15
2025-03-09 10:10:51,055 [INFO]: 	index_param: efSearch=282
2025-03-09 10:10:51,055 [INFO]: 	index_path: knn.index
2025-03-09 10:10:51,055 [INFO]: 	size in bytes: 724804450
2025-03-09 10:10:51,055 [INFO]: 	avg_search_speed_ms: 9.640606484181008
2025-03-09 10:10:51,055 [INFO]: 	99p_search_speed_ms: 17.903468012809768
2025-03-09 10:10:51,055 [INFO]: 	reconstruction error %: 0.0
2025-03-09 10:10:51,055 [INFO]: 	nb vectors: 3684
2025-03-09 10:10:51,055 [INFO]: 	vectors dimension: 49152
2025-03-09 10:10:51,055 [INFO]: 	compression ratio: 0.99930936130428
2025-03-09 10:10:51,055 [INFO]: }
2025-03-09 10:10:51,055 [INFO]: 	>>> Finished "Creating the index" in 48.8559 secs
2025-03-09 10:10:51,055 [INFO]: >>> Finished "Launching the whole pipeline" in 48.8839 secs
2025-03-09 10:10:52: [retrieval_preprocessing] calculating distances ...
2025-03-09 10:10:52: [retrieval_preprocessing] finished and saved retrieval indices for episode 20992 [episode count 0/20]
[retrieval_preprocessing] for episode 38412 [episode count 1/20], we have num_retrieval=np.int64(3560) num_query=np.int64(318)
2025-03-09 10:10:53,603 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-09 10:10:54,036 [INFO]: Launching the whole pipeline 03/09/2025, 10:10:54
2025-03-09 10:10:54,036 [INFO]: Reading total number of vectors and dimension 03/09/2025, 10:10:54
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 2439.97it/s]
2025-03-09 10:10:54,066 [INFO]: There are 3560 embeddings of dim 49152
2025-03-09 10:10:54,066 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0295 secs
2025-03-09 10:10:54,066 [INFO]: 	Compute estimated construction time of the index 03/09/2025, 10:10:54
2025-03-09 10:10:54,066 [INFO]: 		-> Train: 16.7 minutes
2025-03-09 10:10:54,067 [INFO]: 		-> Add: 2.0 seconds
2025-03-09 10:10:54,067 [INFO]: 		Total: 16.7 minutes
2025-03-09 10:10:54,067 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0004 secs
2025-03-09 10:10:54,067 [INFO]: 	Checking that your have enough memory available to create the index 03/09/2025, 10:10:54
2025-03-09 10:10:54,067 [INFO]: 734.7MB of memory will be needed to build the index (more might be used if you have more)
2025-03-09 10:10:54,067 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0004 secs
2025-03-09 10:10:54,067 [INFO]: 	Selecting most promising index types given data characteristics 03/09/2025, 10:10:54
2025-03-09 10:10:54,067 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-09 10:10:54,068 [INFO]: 	Creating the index 03/09/2025, 10:10:54
2025-03-09 10:10:54,068 [INFO]: 		-> Instanciate the index HNSW15 03/09/2025, 10:10:54
2025-03-09 10:10:54,071 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0030 secs
2025-03-09 10:10:54,071 [INFO]: 		-> Adding the vectors to the index 03/09/2025, 10:10:54
2025-03-09 10:10:54,071 [INFO]: The memory available for adding the vectors is 49.3GB(total available - used by the index)
2025-03-09 10:10:54,071 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/15 [00:00<?, ?it/s]  7%|▋         | 1/15 [00:00<00:02,  6.84it/s] 20%|██        | 3/15 [00:00<00:01, 10.60it/s] 33%|███▎      | 5/15 [00:00<00:00, 11.07it/s] 47%|████▋     | 7/15 [00:00<00:00, 10.31it/s] 60%|██████    | 9/15 [00:00<00:00,  9.89it/s] 67%|██████▋   | 10/15 [00:01<00:00,  9.73it/s] 73%|███████▎  | 11/15 [00:01<00:00,  9.58it/s] 80%|████████  | 12/15 [00:01<00:00,  9.46it/s] 87%|████████▋ | 13/15 [00:01<00:00,  9.41it/s] 93%|█████████▎| 14/15 [00:01<00:00,  9.45it/s]100%|██████████| 15/15 [00:03<00:00,  1.33it/s]100%|██████████| 15/15 [00:03<00:00,  3.90it/s]
2025-03-09 10:10:57,918 [INFO]: 	Computing best hyperparameters for index knn.index 03/09/2025, 10:10:57
2025-03-09 10:11:30,525 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 32.6059 secs
2025-03-09 10:11:30,525 [INFO]: The best hyperparameters are: efSearch=336
2025-03-09 10:11:30,525 [INFO]: 	Compute fast metrics 03/09/2025, 10:11:30
  0%|          | 0/4 [00:00<?, ?it/s] 25%|██▌       | 1/4 [00:00<00:00,  5.33it/s] 50%|█████     | 2/4 [00:00<00:00,  7.09it/s] 75%|███████▌  | 3/4 [00:00<00:00,  7.82it/s] 75%|███████▌  | 3/4 [00:00<00:00,  5.89it/s]
2025-03-09 10:11:44,857 [INFO]: 	>>> Finished "Compute fast metrics" in 14.3323 secs
2025-03-09 10:11:44,860 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 50.7888 secs
2025-03-09 10:11:44,860 [INFO]: {
2025-03-09 10:11:44,860 [INFO]: 	index_key: HNSW15
2025-03-09 10:11:44,860 [INFO]: 	index_param: efSearch=336
2025-03-09 10:11:44,860 [INFO]: 	index_path: knn.index
2025-03-09 10:11:44,860 [INFO]: 	size in bytes: 700408090
2025-03-09 10:11:44,860 [INFO]: 	avg_search_speed_ms: 10.576941858067416
2025-03-09 10:11:44,860 [INFO]: 	99p_search_speed_ms: 15.720353927463274
2025-03-09 10:11:44,860 [INFO]: 	reconstruction error %: 0.0
2025-03-09 10:11:44,860 [INFO]: 	nb vectors: 3560
2025-03-09 10:11:44,860 [INFO]: 	vectors dimension: 49152
2025-03-09 10:11:44,860 [INFO]: 	compression ratio: 0.9993095311049306
2025-03-09 10:11:44,860 [INFO]: }
2025-03-09 10:11:44,860 [INFO]: 	>>> Finished "Creating the index" in 50.7925 secs
2025-03-09 10:11:44,860 [INFO]: >>> Finished "Launching the whole pipeline" in 50.8237 secs
2025-03-09 10:11:46: [retrieval_preprocessing] calculating distances ...
2025-03-09 10:11:48: [retrieval_preprocessing] finished and saved retrieval indices for episode 38412 [episode count 1/20]
[retrieval_preprocessing] for episode 67602 [episode count 2/20], we have num_retrieval=np.int64(3652) num_query=np.int64(226)
2025-03-09 10:11:48,855 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-09 10:11:49,457 [INFO]: Launching the whole pipeline 03/09/2025, 10:11:49
2025-03-09 10:11:49,457 [INFO]: Reading total number of vectors and dimension 03/09/2025, 10:11:49
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 2002.05it/s]
2025-03-09 10:11:49,477 [INFO]: There are 3652 embeddings of dim 49152
2025-03-09 10:11:49,477 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0193 secs
2025-03-09 10:11:49,477 [INFO]: 	Compute estimated construction time of the index 03/09/2025, 10:11:49
2025-03-09 10:11:49,477 [INFO]: 		-> Train: 16.7 minutes
2025-03-09 10:11:49,477 [INFO]: 		-> Add: 2.0 seconds
2025-03-09 10:11:49,477 [INFO]: 		Total: 16.7 minutes
2025-03-09 10:11:49,477 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0001 secs
2025-03-09 10:11:49,477 [INFO]: 	Checking that your have enough memory available to create the index 03/09/2025, 10:11:49
2025-03-09 10:11:49,477 [INFO]: 753.7MB of memory will be needed to build the index (more might be used if you have more)
2025-03-09 10:11:49,477 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0001 secs
2025-03-09 10:11:49,477 [INFO]: 	Selecting most promising index types given data characteristics 03/09/2025, 10:11:49
2025-03-09 10:11:49,477 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-09 10:11:49,477 [INFO]: 	Creating the index 03/09/2025, 10:11:49
2025-03-09 10:11:49,477 [INFO]: 		-> Instanciate the index HNSW15 03/09/2025, 10:11:49
2025-03-09 10:11:49,478 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0008 secs
2025-03-09 10:11:49,478 [INFO]: 		-> Adding the vectors to the index 03/09/2025, 10:11:49
2025-03-09 10:11:49,478 [INFO]: The memory available for adding the vectors is 49.3GB(total available - used by the index)
2025-03-09 10:11:49,478 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/15 [00:00<?, ?it/s]  7%|▋         | 1/15 [00:00<00:02,  4.92it/s] 13%|█▎        | 2/15 [00:00<00:01,  6.85it/s] 27%|██▋       | 4/15 [00:00<00:01,  8.72it/s] 33%|███▎      | 5/15 [00:00<00:01,  8.25it/s] 47%|████▋     | 7/15 [00:00<00:00,  9.27it/s] 60%|██████    | 9/15 [00:01<00:00,  9.33it/s] 67%|██████▋   | 10/15 [00:01<00:00,  8.73it/s] 73%|███████▎  | 11/15 [00:01<00:00,  8.88it/s] 80%|████████  | 12/15 [00:01<00:00,  9.10it/s] 87%|████████▋ | 13/15 [00:01<00:00,  9.08it/s] 93%|█████████▎| 14/15 [00:01<00:00,  9.22it/s]100%|██████████| 15/15 [00:04<00:00,  1.28it/s]100%|██████████| 15/15 [00:04<00:00,  3.66it/s]
2025-03-09 10:11:53,576 [INFO]: 	Computing best hyperparameters for index knn.index 03/09/2025, 10:11:53
2025-03-09 10:12:24,744 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 31.1676 secs
2025-03-09 10:12:24,744 [INFO]: The best hyperparameters are: efSearch=278
2025-03-09 10:12:24,744 [INFO]: 	Compute fast metrics 03/09/2025, 10:12:24
  0%|          | 0/4 [00:00<?, ?it/s] 75%|███████▌  | 3/4 [00:00<00:00, 25.62it/s] 75%|███████▌  | 3/4 [00:00<00:00, 22.54it/s]
2025-03-09 10:12:36,971 [INFO]: 	>>> Finished "Compute fast metrics" in 12.2270 secs
2025-03-09 10:12:36,974 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 47.4959 secs
2025-03-09 10:12:36,974 [INFO]: {
2025-03-09 10:12:36,974 [INFO]: 	index_key: HNSW15
2025-03-09 10:12:36,974 [INFO]: 	index_param: efSearch=278
2025-03-09 10:12:36,974 [INFO]: 	index_path: knn.index
2025-03-09 10:12:36,974 [INFO]: 	size in bytes: 718508710
2025-03-09 10:12:36,974 [INFO]: 	avg_search_speed_ms: 9.375837978478364
2025-03-09 10:12:36,974 [INFO]: 	99p_search_speed_ms: 18.280221750028428
2025-03-09 10:12:36,974 [INFO]: 	reconstruction error %: 0.0
2025-03-09 10:12:36,974 [INFO]: 	nb vectors: 3652
2025-03-09 10:12:36,974 [INFO]: 	vectors dimension: 49152
2025-03-09 10:12:36,974 [INFO]: 	compression ratio: 0.9993092721172441
2025-03-09 10:12:36,974 [INFO]: }
2025-03-09 10:12:36,974 [INFO]: 	>>> Finished "Creating the index" in 47.4972 secs
2025-03-09 10:12:36,974 [INFO]: >>> Finished "Launching the whole pipeline" in 47.5170 secs
2025-03-09 10:12:38: [retrieval_preprocessing] calculating distances ...
2025-03-09 10:12:39: [retrieval_preprocessing] finished and saved retrieval indices for episode 67602 [episode count 2/20]
[retrieval_preprocessing] for episode 1046 [episode count 3/20], we have num_retrieval=np.int64(3639) num_query=np.int64(239)
2025-03-09 10:12:40,225 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-09 10:12:40,644 [INFO]: Launching the whole pipeline 03/09/2025, 10:12:40
2025-03-09 10:12:40,645 [INFO]: Reading total number of vectors and dimension 03/09/2025, 10:12:40
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1494.23it/s]
2025-03-09 10:12:40,674 [INFO]: There are 3639 embeddings of dim 49152
2025-03-09 10:12:40,674 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0295 secs
2025-03-09 10:12:40,674 [INFO]: 	Compute estimated construction time of the index 03/09/2025, 10:12:40
2025-03-09 10:12:40,674 [INFO]: 		-> Train: 16.7 minutes
2025-03-09 10:12:40,674 [INFO]: 		-> Add: 2.0 seconds
2025-03-09 10:12:40,674 [INFO]: 		Total: 16.7 minutes
2025-03-09 10:12:40,674 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0001 secs
2025-03-09 10:12:40,674 [INFO]: 	Checking that your have enough memory available to create the index 03/09/2025, 10:12:40
2025-03-09 10:12:40,674 [INFO]: 751.0MB of memory will be needed to build the index (more might be used if you have more)
2025-03-09 10:12:40,674 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0001 secs
2025-03-09 10:12:40,674 [INFO]: 	Selecting most promising index types given data characteristics 03/09/2025, 10:12:40
2025-03-09 10:12:40,675 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-09 10:12:40,675 [INFO]: 	Creating the index 03/09/2025, 10:12:40
2025-03-09 10:12:40,675 [INFO]: 		-> Instanciate the index HNSW15 03/09/2025, 10:12:40
2025-03-09 10:12:40,676 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0010 secs
2025-03-09 10:12:40,676 [INFO]: 		-> Adding the vectors to the index 03/09/2025, 10:12:40
2025-03-09 10:12:40,676 [INFO]: The memory available for adding the vectors is 49.3GB(total available - used by the index)
2025-03-09 10:12:40,676 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/15 [00:00<?, ?it/s]  7%|▋         | 1/15 [00:00<00:02,  6.70it/s] 40%|████      | 6/15 [00:00<00:00, 24.50it/s] 67%|██████▋   | 10/15 [00:00<00:00, 27.70it/s] 87%|████████▋ | 13/15 [00:00<00:00, 21.97it/s]100%|██████████| 15/15 [00:03<00:00,  5.00it/s]
2025-03-09 10:12:43,682 [INFO]: 	Computing best hyperparameters for index knn.index 03/09/2025, 10:12:43
2025-03-09 10:13:16,819 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 33.1371 secs
2025-03-09 10:13:16,820 [INFO]: The best hyperparameters are: efSearch=329
2025-03-09 10:13:16,820 [INFO]: 	Compute fast metrics 03/09/2025, 10:13:16
  0%|          | 0/4 [00:00<?, ?it/s] 25%|██▌       | 1/4 [00:00<00:00,  5.57it/s] 50%|█████     | 2/4 [00:00<00:00,  7.39it/s] 75%|███████▌  | 3/4 [00:00<00:00,  8.11it/s] 75%|███████▌  | 3/4 [00:00<00:00,  6.08it/s]
2025-03-09 10:13:29,774 [INFO]: 	>>> Finished "Compute fast metrics" in 12.9544 secs
2025-03-09 10:13:29,777 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 49.1010 secs
2025-03-09 10:13:29,777 [INFO]: {
2025-03-09 10:13:29,777 [INFO]: 	index_key: HNSW15
2025-03-09 10:13:29,777 [INFO]: 	index_param: efSearch=329
2025-03-09 10:13:29,777 [INFO]: 	index_path: knn.index
2025-03-09 10:13:29,777 [INFO]: 	size in bytes: 715951090
2025-03-09 10:13:29,777 [INFO]: 	avg_search_speed_ms: 10.372432593654269
2025-03-09 10:13:29,777 [INFO]: 	99p_search_speed_ms: 15.260561027098447
2025-03-09 10:13:29,777 [INFO]: 	reconstruction error %: 0.0
2025-03-09 10:13:29,777 [INFO]: 	nb vectors: 3639
2025-03-09 10:13:29,777 [INFO]: 	vectors dimension: 49152
2025-03-09 10:13:29,777 [INFO]: 	compression ratio: 0.999309201414862
2025-03-09 10:13:29,777 [INFO]: }
2025-03-09 10:13:29,777 [INFO]: 	>>> Finished "Creating the index" in 49.1024 secs
2025-03-09 10:13:29,777 [INFO]: >>> Finished "Launching the whole pipeline" in 49.1325 secs
2025-03-09 10:13:31: [retrieval_preprocessing] calculating distances ...
2025-03-09 10:13:32: [retrieval_preprocessing] finished and saved retrieval indices for episode 1046 [episode count 3/20]
[retrieval_preprocessing] for episode 26652 [episode count 4/20], we have num_retrieval=np.int64(3699) num_query=np.int64(179)
2025-03-09 10:13:32,804 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-09 10:13:33,246 [INFO]: Launching the whole pipeline 03/09/2025, 10:13:33
2025-03-09 10:13:33,246 [INFO]: Reading total number of vectors and dimension 03/09/2025, 10:13:33
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1746.90it/s]
2025-03-09 10:13:33,272 [INFO]: There are 3699 embeddings of dim 49152
2025-03-09 10:13:33,272 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0263 secs
2025-03-09 10:13:33,272 [INFO]: 	Compute estimated construction time of the index 03/09/2025, 10:13:33
2025-03-09 10:13:33,272 [INFO]: 		-> Train: 16.7 minutes
2025-03-09 10:13:33,272 [INFO]: 		-> Add: 2.0 seconds
2025-03-09 10:13:33,272 [INFO]: 		Total: 16.7 minutes
2025-03-09 10:13:33,272 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0001 secs
2025-03-09 10:13:33,272 [INFO]: 	Checking that your have enough memory available to create the index 03/09/2025, 10:13:33
2025-03-09 10:13:33,272 [INFO]: 763.4MB of memory will be needed to build the index (more might be used if you have more)
2025-03-09 10:13:33,272 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0002 secs
2025-03-09 10:13:33,272 [INFO]: 	Selecting most promising index types given data characteristics 03/09/2025, 10:13:33
2025-03-09 10:13:33,272 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-09 10:13:33,273 [INFO]: 	Creating the index 03/09/2025, 10:13:33
2025-03-09 10:13:33,273 [INFO]: 		-> Instanciate the index HNSW15 03/09/2025, 10:13:33
2025-03-09 10:13:33,274 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0011 secs
2025-03-09 10:13:33,274 [INFO]: 		-> Adding the vectors to the index 03/09/2025, 10:13:33
2025-03-09 10:13:33,274 [INFO]: The memory available for adding the vectors is 49.3GB(total available - used by the index)
2025-03-09 10:13:33,274 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/15 [00:00<?, ?it/s]  7%|▋         | 1/15 [00:00<00:02,  6.71it/s] 27%|██▋       | 4/15 [00:00<00:00, 17.72it/s] 47%|████▋     | 7/15 [00:00<00:00, 20.95it/s] 67%|██████▋   | 10/15 [00:00<00:00, 20.48it/s] 87%|████████▋ | 13/15 [00:00<00:00, 18.94it/s]100%|██████████| 15/15 [00:03<00:00,  2.76it/s]100%|██████████| 15/15 [00:03<00:00,  4.79it/s]
2025-03-09 10:13:36,408 [INFO]: 	Computing best hyperparameters for index knn.index 03/09/2025, 10:13:36
2025-03-09 10:14:13,398 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 36.9893 secs
2025-03-09 10:14:13,398 [INFO]: The best hyperparameters are: efSearch=291
2025-03-09 10:14:13,398 [INFO]: 	Compute fast metrics 03/09/2025, 10:14:13
  0%|          | 0/4 [00:00<?, ?it/s] 25%|██▌       | 1/4 [00:00<00:00,  6.21it/s] 75%|███████▌  | 3/4 [00:00<00:00, 10.18it/s] 75%|███████▌  | 3/4 [00:00<00:00,  7.77it/s]
2025-03-09 10:14:27,352 [INFO]: 	>>> Finished "Compute fast metrics" in 13.9538 secs
2025-03-09 10:14:27,355 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 54.0807 secs
2025-03-09 10:14:27,355 [INFO]: {
2025-03-09 10:14:27,355 [INFO]: 	index_key: HNSW15
2025-03-09 10:14:27,355 [INFO]: 	index_param: efSearch=291
2025-03-09 10:14:27,355 [INFO]: 	index_path: knn.index
2025-03-09 10:14:27,355 [INFO]: 	size in bytes: 727755550
2025-03-09 10:14:27,355 [INFO]: 	avg_search_speed_ms: 9.222802301830994
2025-03-09 10:14:27,355 [INFO]: 	99p_search_speed_ms: 14.866577857173986
2025-03-09 10:14:27,355 [INFO]: 	reconstruction error %: 0.0
2025-03-09 10:14:27,355 [INFO]: 	nb vectors: 3699
2025-03-09 10:14:27,355 [INFO]: 	vectors dimension: 49152
2025-03-09 10:14:27,355 [INFO]: 	compression ratio: 0.99930944119904
2025-03-09 10:14:27,355 [INFO]: }
2025-03-09 10:14:27,355 [INFO]: 	>>> Finished "Creating the index" in 54.0823 secs
2025-03-09 10:14:27,355 [INFO]: >>> Finished "Launching the whole pipeline" in 54.1092 secs
2025-03-09 10:14:28: [retrieval_preprocessing] calculating distances ...
2025-03-09 10:14:29: [retrieval_preprocessing] finished and saved retrieval indices for episode 26652 [episode count 4/20]
[retrieval_preprocessing] for episode 9760 [episode count 5/20], we have num_retrieval=np.int64(3686) num_query=np.int64(192)
2025-03-09 10:14:30,217 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-09 10:14:30,674 [INFO]: Launching the whole pipeline 03/09/2025, 10:14:30
2025-03-09 10:14:30,674 [INFO]: Reading total number of vectors and dimension 03/09/2025, 10:14:30
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1505.49it/s]
2025-03-09 10:14:30,705 [INFO]: There are 3686 embeddings of dim 49152
2025-03-09 10:14:30,706 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0318 secs
2025-03-09 10:14:30,706 [INFO]: 	Compute estimated construction time of the index 03/09/2025, 10:14:30
2025-03-09 10:14:30,706 [INFO]: 		-> Train: 16.7 minutes
2025-03-09 10:14:30,706 [INFO]: 		-> Add: 2.0 seconds
2025-03-09 10:14:30,706 [INFO]: 		Total: 16.7 minutes
2025-03-09 10:14:30,706 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0001 secs
2025-03-09 10:14:30,706 [INFO]: 	Checking that your have enough memory available to create the index 03/09/2025, 10:14:30
2025-03-09 10:14:30,706 [INFO]: 760.7MB of memory will be needed to build the index (more might be used if you have more)
2025-03-09 10:14:30,706 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0001 secs
2025-03-09 10:14:30,706 [INFO]: 	Selecting most promising index types given data characteristics 03/09/2025, 10:14:30
2025-03-09 10:14:30,706 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-09 10:14:30,706 [INFO]: 	Creating the index 03/09/2025, 10:14:30
2025-03-09 10:14:30,706 [INFO]: 		-> Instanciate the index HNSW15 03/09/2025, 10:14:30
2025-03-09 10:14:30,707 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0008 secs
2025-03-09 10:14:30,707 [INFO]: 		-> Adding the vectors to the index 03/09/2025, 10:14:30
2025-03-09 10:14:30,707 [INFO]: The memory available for adding the vectors is 49.3GB(total available - used by the index)
2025-03-09 10:14:30,707 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/15 [00:00<?, ?it/s]  7%|▋         | 1/15 [00:00<00:01,  7.89it/s] 40%|████      | 6/15 [00:00<00:00, 29.08it/s] 67%|██████▋   | 10/15 [00:00<00:00, 26.26it/s] 87%|████████▋ | 13/15 [00:00<00:00, 20.17it/s]100%|██████████| 15/15 [00:02<00:00,  5.32it/s]
2025-03-09 10:14:33,529 [INFO]: 	Computing best hyperparameters for index knn.index 03/09/2025, 10:14:33
2025-03-09 10:15:07,177 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 33.6479 secs
2025-03-09 10:15:07,178 [INFO]: The best hyperparameters are: efSearch=371
2025-03-09 10:15:07,178 [INFO]: 	Compute fast metrics 03/09/2025, 10:15:07
  0%|          | 0/4 [00:00<?, ?it/s] 25%|██▌       | 1/4 [00:00<00:00,  6.00it/s] 75%|███████▌  | 3/4 [00:00<00:00, 10.14it/s] 75%|███████▌  | 3/4 [00:00<00:00,  7.77it/s]
2025-03-09 10:15:20,651 [INFO]: 	>>> Finished "Compute fast metrics" in 13.4729 secs
2025-03-09 10:15:20,653 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 49.9455 secs
2025-03-09 10:15:20,653 [INFO]: {
2025-03-09 10:15:20,653 [INFO]: 	index_key: HNSW15
2025-03-09 10:15:20,653 [INFO]: 	index_param: efSearch=371
2025-03-09 10:15:20,653 [INFO]: 	index_path: knn.index
2025-03-09 10:15:20,653 [INFO]: 	size in bytes: 725197930
2025-03-09 10:15:20,653 [INFO]: 	avg_search_speed_ms: 10.958219580515518
2025-03-09 10:15:20,653 [INFO]: 	99p_search_speed_ms: 18.40224606916308
2025-03-09 10:15:20,653 [INFO]: 	reconstruction error %: 0.0
2025-03-09 10:15:20,653 [INFO]: 	nb vectors: 3686
2025-03-09 10:15:20,653 [INFO]: 	vectors dimension: 49152
2025-03-09 10:15:20,653 [INFO]: 	compression ratio: 0.9993093719944843
2025-03-09 10:15:20,653 [INFO]: }
2025-03-09 10:15:20,653 [INFO]: 	>>> Finished "Creating the index" in 49.9468 secs
2025-03-09 10:15:20,653 [INFO]: >>> Finished "Launching the whole pipeline" in 49.9792 secs
2025-03-09 10:15:23: [retrieval_preprocessing] calculating distances ...
2025-03-09 10:15:24: [retrieval_preprocessing] finished and saved retrieval indices for episode 9760 [episode count 5/20]
[retrieval_preprocessing] for episode 71713 [episode count 6/20], we have num_retrieval=np.int64(3738) num_query=np.int64(140)
2025-03-09 10:15:25,461 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-09 10:15:25,964 [INFO]: Launching the whole pipeline 03/09/2025, 10:15:25
2025-03-09 10:15:25,964 [INFO]: Reading total number of vectors and dimension 03/09/2025, 10:15:25
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1754.94it/s]
2025-03-09 10:15:25,988 [INFO]: There are 3738 embeddings of dim 49152
2025-03-09 10:15:25,988 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0239 secs
2025-03-09 10:15:25,988 [INFO]: 	Compute estimated construction time of the index 03/09/2025, 10:15:25
2025-03-09 10:15:25,988 [INFO]: 		-> Train: 16.7 minutes
2025-03-09 10:15:25,988 [INFO]: 		-> Add: 2.1 seconds
2025-03-09 10:15:25,988 [INFO]: 		Total: 16.7 minutes
2025-03-09 10:15:25,988 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0001 secs
2025-03-09 10:15:25,988 [INFO]: 	Checking that your have enough memory available to create the index 03/09/2025, 10:15:25
2025-03-09 10:15:25,988 [INFO]: 771.4MB of memory will be needed to build the index (more might be used if you have more)
2025-03-09 10:15:25,988 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0001 secs
2025-03-09 10:15:25,988 [INFO]: 	Selecting most promising index types given data characteristics 03/09/2025, 10:15:25
2025-03-09 10:15:25,988 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-09 10:15:25,988 [INFO]: 	Creating the index 03/09/2025, 10:15:25
2025-03-09 10:15:25,988 [INFO]: 		-> Instanciate the index HNSW15 03/09/2025, 10:15:25
2025-03-09 10:15:25,989 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0009 secs
2025-03-09 10:15:25,989 [INFO]: 		-> Adding the vectors to the index 03/09/2025, 10:15:25
2025-03-09 10:15:25,989 [INFO]: The memory available for adding the vectors is 49.3GB(total available - used by the index)
2025-03-09 10:15:25,989 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/15 [00:00<?, ?it/s]  7%|▋         | 1/15 [00:00<00:02,  5.10it/s] 13%|█▎        | 2/15 [00:00<00:01,  7.13it/s] 20%|██        | 3/15 [00:00<00:01,  8.08it/s] 27%|██▋       | 4/15 [00:00<00:01,  8.67it/s] 33%|███▎      | 5/15 [00:00<00:01,  9.04it/s] 40%|████      | 6/15 [00:00<00:00,  9.10it/s] 47%|████▋     | 7/15 [00:00<00:00,  9.15it/s] 60%|██████    | 9/15 [00:01<00:00,  9.37it/s] 67%|██████▋   | 10/15 [00:01<00:00,  9.35it/s] 73%|███████▎  | 11/15 [00:01<00:00,  9.32it/s] 80%|████████  | 12/15 [00:01<00:00,  9.39it/s] 87%|████████▋ | 13/15 [00:01<00:00,  9.42it/s] 93%|█████████▎| 14/15 [00:01<00:00,  9.33it/s]100%|██████████| 15/15 [00:04<00:00,  1.25it/s]100%|██████████| 15/15 [00:04<00:00,  3.71it/s]
2025-03-09 10:15:30,045 [INFO]: 	Computing best hyperparameters for index knn.index 03/09/2025, 10:15:30
2025-03-09 10:16:01,631 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 31.5858 secs
2025-03-09 10:16:01,631 [INFO]: The best hyperparameters are: efSearch=349
2025-03-09 10:16:01,631 [INFO]: 	Compute fast metrics 03/09/2025, 10:16:01
  0%|          | 0/4 [00:00<?, ?it/s] 25%|██▌       | 1/4 [00:00<00:00,  4.55it/s] 50%|█████     | 2/4 [00:00<00:00,  6.32it/s] 75%|███████▌  | 3/4 [00:00<00:00,  6.25it/s]
2025-03-09 10:16:15,994 [INFO]: 	>>> Finished "Compute fast metrics" in 14.3632 secs
2025-03-09 10:16:15,997 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 50.0076 secs
2025-03-09 10:16:15,997 [INFO]: {
2025-03-09 10:16:15,997 [INFO]: 	index_key: HNSW15
2025-03-09 10:16:15,997 [INFO]: 	index_param: efSearch=349
2025-03-09 10:16:15,997 [INFO]: 	index_path: knn.index
2025-03-09 10:16:15,997 [INFO]: 	size in bytes: 735428770
2025-03-09 10:16:15,997 [INFO]: 	avg_search_speed_ms: 10.735738295522147
2025-03-09 10:16:15,997 [INFO]: 	99p_search_speed_ms: 17.394911665469376
2025-03-09 10:16:15,997 [INFO]: 	reconstruction error %: 0.0
2025-03-09 10:16:15,997 [INFO]: 	nb vectors: 3738
2025-03-09 10:16:15,997 [INFO]: 	vectors dimension: 49152
2025-03-09 10:16:15,997 [INFO]: 	compression ratio: 0.9993091567521896
2025-03-09 10:16:15,997 [INFO]: }
2025-03-09 10:16:15,997 [INFO]: 	>>> Finished "Creating the index" in 50.0089 secs
2025-03-09 10:16:15,997 [INFO]: >>> Finished "Launching the whole pipeline" in 50.0334 secs
2025-03-09 10:16:17: [retrieval_preprocessing] calculating distances ...
2025-03-09 10:16:17: [retrieval_preprocessing] finished and saved retrieval indices for episode 71713 [episode count 6/20]
[retrieval_preprocessing] for episode 20005 [episode count 7/20], we have num_retrieval=np.int64(3712) num_query=np.int64(166)
2025-03-09 10:16:18,932 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-09 10:16:19,453 [INFO]: Launching the whole pipeline 03/09/2025, 10:16:19
2025-03-09 10:16:19,453 [INFO]: Reading total number of vectors and dimension 03/09/2025, 10:16:19
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1344.76it/s]
2025-03-09 10:16:19,480 [INFO]: There are 3712 embeddings of dim 49152
2025-03-09 10:16:19,481 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0276 secs
2025-03-09 10:16:19,481 [INFO]: 	Compute estimated construction time of the index 03/09/2025, 10:16:19
2025-03-09 10:16:19,481 [INFO]: 		-> Train: 16.7 minutes
2025-03-09 10:16:19,481 [INFO]: 		-> Add: 2.0 seconds
2025-03-09 10:16:19,481 [INFO]: 		Total: 16.7 minutes
2025-03-09 10:16:19,481 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0002 secs
2025-03-09 10:16:19,481 [INFO]: 	Checking that your have enough memory available to create the index 03/09/2025, 10:16:19
2025-03-09 10:16:19,482 [INFO]: 766.1MB of memory will be needed to build the index (more might be used if you have more)
2025-03-09 10:16:19,482 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0004 secs
2025-03-09 10:16:19,482 [INFO]: 	Selecting most promising index types given data characteristics 03/09/2025, 10:16:19
2025-03-09 10:16:19,482 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-09 10:16:19,482 [INFO]: 	Creating the index 03/09/2025, 10:16:19
2025-03-09 10:16:19,482 [INFO]: 		-> Instanciate the index HNSW15 03/09/2025, 10:16:19
2025-03-09 10:16:19,485 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0024 secs
2025-03-09 10:16:19,485 [INFO]: 		-> Adding the vectors to the index 03/09/2025, 10:16:19
2025-03-09 10:16:19,485 [INFO]: The memory available for adding the vectors is 49.3GB(total available - used by the index)
2025-03-09 10:16:19,485 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/15 [00:00<?, ?it/s]  7%|▋         | 1/15 [00:00<00:02,  4.98it/s] 13%|█▎        | 2/15 [00:00<00:02,  6.48it/s] 20%|██        | 3/15 [00:00<00:02,  5.96it/s] 27%|██▋       | 4/15 [00:00<00:01,  6.55it/s] 33%|███▎      | 5/15 [00:00<00:01,  6.94it/s] 40%|████      | 6/15 [00:00<00:01,  7.21it/s] 47%|████▋     | 7/15 [00:01<00:01,  6.35it/s] 53%|█████▎    | 8/15 [00:01<00:01,  6.68it/s] 60%|██████    | 9/15 [00:01<00:00,  6.99it/s] 67%|██████▋   | 10/15 [00:01<00:00,  7.39it/s] 73%|███████▎  | 11/15 [00:01<00:00,  7.67it/s] 80%|████████  | 12/15 [00:01<00:00,  8.01it/s] 87%|████████▋ | 13/15 [00:01<00:00,  8.17it/s] 93%|█████████▎| 14/15 [00:01<00:00,  8.27it/s]100%|██████████| 15/15 [00:04<00:00,  1.17it/s]100%|██████████| 15/15 [00:04<00:00,  3.34it/s]
2025-03-09 10:16:23,985 [INFO]: 	Computing best hyperparameters for index knn.index 03/09/2025, 10:16:23
2025-03-09 10:16:58,686 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 34.7009 secs
2025-03-09 10:16:58,686 [INFO]: The best hyperparameters are: efSearch=294
2025-03-09 10:16:58,686 [INFO]: 	Compute fast metrics 03/09/2025, 10:16:58
  0%|          | 0/4 [00:00<?, ?it/s] 25%|██▌       | 1/4 [00:00<00:00,  6.04it/s] 75%|███████▌  | 3/4 [00:00<00:00, 10.17it/s] 75%|███████▌  | 3/4 [00:00<00:00,  7.75it/s]
2025-03-09 10:17:13,990 [INFO]: 	>>> Finished "Compute fast metrics" in 15.3043 secs
2025-03-09 10:17:13,993 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 54.5076 secs
2025-03-09 10:17:13,993 [INFO]: {
2025-03-09 10:17:13,993 [INFO]: 	index_key: HNSW15
2025-03-09 10:17:13,993 [INFO]: 	index_param: efSearch=294
2025-03-09 10:17:13,993 [INFO]: 	index_path: knn.index
2025-03-09 10:17:13,993 [INFO]: 	size in bytes: 730313230
2025-03-09 10:17:13,993 [INFO]: 	avg_search_speed_ms: 9.991231658444791
2025-03-09 10:17:13,993 [INFO]: 	99p_search_speed_ms: 14.481834135949612
2025-03-09 10:17:13,993 [INFO]: 	reconstruction error %: 0.0
2025-03-09 10:17:13,993 [INFO]: 	nb vectors: 3712
2025-03-09 10:17:13,993 [INFO]: 	vectors dimension: 49152
2025-03-09 10:17:13,993 [INFO]: 	compression ratio: 0.9993094278190743
2025-03-09 10:17:13,993 [INFO]: }
2025-03-09 10:17:13,993 [INFO]: 	>>> Finished "Creating the index" in 54.5106 secs
2025-03-09 10:17:13,993 [INFO]: >>> Finished "Launching the whole pipeline" in 54.5397 secs
2025-03-09 10:17:15: [retrieval_preprocessing] calculating distances ...
2025-03-09 10:17:15: [retrieval_preprocessing] finished and saved retrieval indices for episode 20005 [episode count 7/20]
[retrieval_preprocessing] for episode 37953 [episode count 8/20], we have num_retrieval=np.int64(3694) num_query=np.int64(184)
2025-03-09 10:17:16,542 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-09 10:17:17,106 [INFO]: Launching the whole pipeline 03/09/2025, 10:17:17
2025-03-09 10:17:17,106 [INFO]: Reading total number of vectors and dimension 03/09/2025, 10:17:17
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 2010.69it/s]
2025-03-09 10:17:17,143 [INFO]: There are 3694 embeddings of dim 49152
2025-03-09 10:17:17,144 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0374 secs
2025-03-09 10:17:17,144 [INFO]: 	Compute estimated construction time of the index 03/09/2025, 10:17:17
2025-03-09 10:17:17,144 [INFO]: 		-> Train: 16.7 minutes
2025-03-09 10:17:17,144 [INFO]: 		-> Add: 2.0 seconds
2025-03-09 10:17:17,144 [INFO]: 		Total: 16.7 minutes
2025-03-09 10:17:17,144 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0003 secs
2025-03-09 10:17:17,144 [INFO]: 	Checking that your have enough memory available to create the index 03/09/2025, 10:17:17
2025-03-09 10:17:17,145 [INFO]: 762.4MB of memory will be needed to build the index (more might be used if you have more)
2025-03-09 10:17:17,145 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0005 secs
2025-03-09 10:17:17,145 [INFO]: 	Selecting most promising index types given data characteristics 03/09/2025, 10:17:17
2025-03-09 10:17:17,145 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-09 10:17:17,145 [INFO]: 	Creating the index 03/09/2025, 10:17:17
2025-03-09 10:17:17,145 [INFO]: 		-> Instanciate the index HNSW15 03/09/2025, 10:17:17
2025-03-09 10:17:17,148 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0028 secs
2025-03-09 10:17:17,148 [INFO]: 		-> Adding the vectors to the index 03/09/2025, 10:17:17
2025-03-09 10:17:17,149 [INFO]: The memory available for adding the vectors is 49.3GB(total available - used by the index)
2025-03-09 10:17:17,149 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/15 [00:00<?, ?it/s]  7%|▋         | 1/15 [00:00<00:01,  9.14it/s] 47%|████▋     | 7/15 [00:00<00:00, 36.68it/s] 87%|████████▋ | 13/15 [00:00<00:00, 45.75it/s]100%|██████████| 15/15 [00:02<00:00,  5.27it/s]
2025-03-09 10:17:20,002 [INFO]: 	Computing best hyperparameters for index knn.index 03/09/2025, 10:17:20
2025-03-09 10:17:55,222 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 35.2200 secs
2025-03-09 10:17:55,222 [INFO]: The best hyperparameters are: efSearch=253
2025-03-09 10:17:55,222 [INFO]: 	Compute fast metrics 03/09/2025, 10:17:55
  0%|          | 0/4 [00:00<?, ?it/s] 25%|██▌       | 1/4 [00:00<00:00,  5.61it/s] 50%|█████     | 2/4 [00:00<00:00,  7.42it/s] 75%|███████▌  | 3/4 [00:00<00:00,  8.13it/s] 75%|███████▌  | 3/4 [00:00<00:00,  6.10it/s]
2025-03-09 10:18:09,746 [INFO]: 	>>> Finished "Compute fast metrics" in 14.5235 secs
2025-03-09 10:18:09,749 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 52.5999 secs
2025-03-09 10:18:09,749 [INFO]: {
2025-03-09 10:18:09,749 [INFO]: 	index_key: HNSW15
2025-03-09 10:18:09,749 [INFO]: 	index_param: efSearch=253
2025-03-09 10:18:09,749 [INFO]: 	index_path: knn.index
2025-03-09 10:18:09,749 [INFO]: 	size in bytes: 726771850
2025-03-09 10:18:09,749 [INFO]: 	avg_search_speed_ms: 10.225533072575775
2025-03-09 10:18:09,749 [INFO]: 	99p_search_speed_ms: 15.980615043081343
2025-03-09 10:18:09,749 [INFO]: 	reconstruction error %: 0.0
2025-03-09 10:18:09,749 [INFO]: 	nb vectors: 3694
2025-03-09 10:18:09,749 [INFO]: 	vectors dimension: 49152
2025-03-09 10:18:09,749 [INFO]: 	compression ratio: 0.9993094146395461
2025-03-09 10:18:09,749 [INFO]: }
2025-03-09 10:18:09,749 [INFO]: 	>>> Finished "Creating the index" in 52.6036 secs
2025-03-09 10:18:09,749 [INFO]: >>> Finished "Launching the whole pipeline" in 52.6427 secs
2025-03-09 10:18:10: [retrieval_preprocessing] calculating distances ...
2025-03-09 10:18:11: [retrieval_preprocessing] finished and saved retrieval indices for episode 37953 [episode count 8/20]
[retrieval_preprocessing] for episode 87110 [episode count 9/20], we have num_retrieval=np.int64(3728) num_query=np.int64(150)
2025-03-09 10:18:12,201 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-09 10:18:12,665 [INFO]: Launching the whole pipeline 03/09/2025, 10:18:12
2025-03-09 10:18:12,666 [INFO]: Reading total number of vectors and dimension 03/09/2025, 10:18:12
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1449.31it/s]
2025-03-09 10:18:12,690 [INFO]: There are 3728 embeddings of dim 49152
2025-03-09 10:18:12,690 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0248 secs
2025-03-09 10:18:12,690 [INFO]: 	Compute estimated construction time of the index 03/09/2025, 10:18:12
2025-03-09 10:18:12,691 [INFO]: 		-> Train: 16.7 minutes
2025-03-09 10:18:12,691 [INFO]: 		-> Add: 2.0 seconds
2025-03-09 10:18:12,691 [INFO]: 		Total: 16.7 minutes
2025-03-09 10:18:12,691 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0001 secs
2025-03-09 10:18:12,691 [INFO]: 	Checking that your have enough memory available to create the index 03/09/2025, 10:18:12
2025-03-09 10:18:12,691 [INFO]: 769.4MB of memory will be needed to build the index (more might be used if you have more)
2025-03-09 10:18:12,691 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0001 secs
2025-03-09 10:18:12,691 [INFO]: 	Selecting most promising index types given data characteristics 03/09/2025, 10:18:12
2025-03-09 10:18:12,691 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-09 10:18:12,691 [INFO]: 	Creating the index 03/09/2025, 10:18:12
2025-03-09 10:18:12,691 [INFO]: 		-> Instanciate the index HNSW15 03/09/2025, 10:18:12
2025-03-09 10:18:12,692 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0009 secs
2025-03-09 10:18:12,692 [INFO]: 		-> Adding the vectors to the index 03/09/2025, 10:18:12
2025-03-09 10:18:12,692 [INFO]: The memory available for adding the vectors is 49.3GB(total available - used by the index)
2025-03-09 10:18:12,692 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/15 [00:00<?, ?it/s]  7%|▋         | 1/15 [00:00<00:02,  5.19it/s] 13%|█▎        | 2/15 [00:00<00:01,  6.83it/s] 20%|██        | 3/15 [00:00<00:01,  7.55it/s] 27%|██▋       | 4/15 [00:00<00:01,  7.90it/s] 47%|████▋     | 7/15 [00:00<00:00, 13.99it/s] 80%|████████  | 12/15 [00:00<00:00, 23.49it/s]100%|██████████| 15/15 [00:03<00:00,  3.31it/s]100%|██████████| 15/15 [00:03<00:00,  4.70it/s]
2025-03-09 10:18:15,894 [INFO]: 	Computing best hyperparameters for index knn.index 03/09/2025, 10:18:15
2025-03-09 10:18:55,515 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 39.6205 secs
2025-03-09 10:18:55,516 [INFO]: The best hyperparameters are: efSearch=222
2025-03-09 10:18:55,516 [INFO]: 	Compute fast metrics 03/09/2025, 10:18:55
  0%|          | 0/4 [00:00<?, ?it/s] 75%|███████▌  | 3/4 [00:00<00:00, 26.48it/s] 75%|███████▌  | 3/4 [00:00<00:00, 22.85it/s]
2025-03-09 10:19:09,229 [INFO]: 	>>> Finished "Compute fast metrics" in 13.7126 secs
2025-03-09 10:19:09,231 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 56.5392 secs
2025-03-09 10:19:09,231 [INFO]: {
2025-03-09 10:19:09,231 [INFO]: 	index_key: HNSW15
2025-03-09 10:19:09,231 [INFO]: 	index_param: efSearch=222
2025-03-09 10:19:09,231 [INFO]: 	index_path: knn.index
2025-03-09 10:19:09,231 [INFO]: 	size in bytes: 733461250
2025-03-09 10:19:09,231 [INFO]: 	avg_search_speed_ms: 7.754122372716665
2025-03-09 10:19:09,232 [INFO]: 	99p_search_speed_ms: 12.71111720940096
2025-03-09 10:19:09,232 [INFO]: 	reconstruction error %: 0.0
2025-03-09 10:19:09,232 [INFO]: 	nb vectors: 3728
2025-03-09 10:19:09,232 [INFO]: 	vectors dimension: 49152
2025-03-09 10:19:09,232 [INFO]: 	compression ratio: 0.9993092668494757
2025-03-09 10:19:09,232 [INFO]: }
2025-03-09 10:19:09,232 [INFO]: 	>>> Finished "Creating the index" in 56.5406 secs
2025-03-09 10:19:09,232 [INFO]: >>> Finished "Launching the whole pipeline" in 56.5661 secs
2025-03-09 10:19:09: [retrieval_preprocessing] calculating distances ...
2025-03-09 10:19:10: [retrieval_preprocessing] finished and saved retrieval indices for episode 87110 [episode count 9/20]
[retrieval_preprocessing] for episode 60492 [episode count 10/20], we have num_retrieval=np.int64(3637) num_query=np.int64(241)
2025-03-09 10:19:10,479 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-09 10:19:10,895 [INFO]: Launching the whole pipeline 03/09/2025, 10:19:10
2025-03-09 10:19:10,895 [INFO]: Reading total number of vectors and dimension 03/09/2025, 10:19:10
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1384.72it/s]
2025-03-09 10:19:10,928 [INFO]: There are 3637 embeddings of dim 49152
2025-03-09 10:19:10,928 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0333 secs
2025-03-09 10:19:10,928 [INFO]: 	Compute estimated construction time of the index 03/09/2025, 10:19:10
2025-03-09 10:19:10,928 [INFO]: 		-> Train: 16.7 minutes
2025-03-09 10:19:10,928 [INFO]: 		-> Add: 2.0 seconds
2025-03-09 10:19:10,928 [INFO]: 		Total: 16.7 minutes
2025-03-09 10:19:10,928 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0001 secs
2025-03-09 10:19:10,928 [INFO]: 	Checking that your have enough memory available to create the index 03/09/2025, 10:19:10
2025-03-09 10:19:10,929 [INFO]: 750.6MB of memory will be needed to build the index (more might be used if you have more)
2025-03-09 10:19:10,929 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0002 secs
2025-03-09 10:19:10,929 [INFO]: 	Selecting most promising index types given data characteristics 03/09/2025, 10:19:10
2025-03-09 10:19:10,929 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-09 10:19:10,929 [INFO]: 	Creating the index 03/09/2025, 10:19:10
2025-03-09 10:19:10,929 [INFO]: 		-> Instanciate the index HNSW15 03/09/2025, 10:19:10
2025-03-09 10:19:10,930 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0012 secs
2025-03-09 10:19:10,930 [INFO]: 		-> Adding the vectors to the index 03/09/2025, 10:19:10
2025-03-09 10:19:10,930 [INFO]: The memory available for adding the vectors is 49.3GB(total available - used by the index)
2025-03-09 10:19:10,930 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/15 [00:00<?, ?it/s]  7%|▋         | 1/15 [00:00<00:01,  7.99it/s] 53%|█████▎    | 8/15 [00:00<00:00, 38.85it/s]100%|██████████| 15/15 [00:02<00:00,  5.14it/s]100%|██████████| 15/15 [00:02<00:00,  5.97it/s]
2025-03-09 10:19:13,444 [INFO]: 	Computing best hyperparameters for index knn.index 03/09/2025, 10:19:13
2025-03-09 10:19:48,870 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 35.4259 secs
2025-03-09 10:19:48,870 [INFO]: The best hyperparameters are: efSearch=298
2025-03-09 10:19:48,871 [INFO]: 	Compute fast metrics 03/09/2025, 10:19:48
  0%|          | 0/4 [00:00<?, ?it/s] 25%|██▌       | 1/4 [00:00<00:00,  8.35it/s] 75%|███████▌  | 3/4 [00:00<00:00, 15.07it/s]
2025-03-09 10:20:03,095 [INFO]: 	>>> Finished "Compute fast metrics" in 14.2245 secs
2025-03-09 10:20:03,098 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 52.1677 secs
2025-03-09 10:20:03,098 [INFO]: {
2025-03-09 10:20:03,098 [INFO]: 	index_key: HNSW15
2025-03-09 10:20:03,098 [INFO]: 	index_param: efSearch=298
2025-03-09 10:20:03,098 [INFO]: 	index_path: knn.index
2025-03-09 10:20:03,098 [INFO]: 	size in bytes: 715557550
2025-03-09 10:20:03,098 [INFO]: 	avg_search_speed_ms: 11.597479427306721
2025-03-09 10:20:03,098 [INFO]: 	99p_search_speed_ms: 17.902618423104286
2025-03-09 10:20:03,098 [INFO]: 	reconstruction error %: 0.0
2025-03-09 10:20:03,098 [INFO]: 	nb vectors: 3637
2025-03-09 10:20:03,098 [INFO]: 	vectors dimension: 49152
2025-03-09 10:20:03,098 [INFO]: 	compression ratio: 0.9993092742854854
2025-03-09 10:20:03,098 [INFO]: }
2025-03-09 10:20:03,098 [INFO]: 	>>> Finished "Creating the index" in 52.1696 secs
2025-03-09 10:20:03,098 [INFO]: >>> Finished "Launching the whole pipeline" in 52.2036 secs
2025-03-09 10:20:04: [retrieval_preprocessing] calculating distances ...
2025-03-09 10:20:05: [retrieval_preprocessing] finished and saved retrieval indices for episode 60492 [episode count 10/20]
[retrieval_preprocessing] for episode 54354 [episode count 11/20], we have num_retrieval=np.int64(3655) num_query=np.int64(223)
2025-03-09 10:20:06,458 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-09 10:20:06,904 [INFO]: Launching the whole pipeline 03/09/2025, 10:20:06
2025-03-09 10:20:06,904 [INFO]: Reading total number of vectors and dimension 03/09/2025, 10:20:06
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1199.74it/s]
2025-03-09 10:20:06,934 [INFO]: There are 3655 embeddings of dim 49152
2025-03-09 10:20:06,934 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0300 secs
2025-03-09 10:20:06,934 [INFO]: 	Compute estimated construction time of the index 03/09/2025, 10:20:06
2025-03-09 10:20:06,934 [INFO]: 		-> Train: 16.7 minutes
2025-03-09 10:20:06,934 [INFO]: 		-> Add: 2.0 seconds
2025-03-09 10:20:06,934 [INFO]: 		Total: 16.7 minutes
2025-03-09 10:20:06,934 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0001 secs
2025-03-09 10:20:06,934 [INFO]: 	Checking that your have enough memory available to create the index 03/09/2025, 10:20:06
2025-03-09 10:20:06,935 [INFO]: 754.3MB of memory will be needed to build the index (more might be used if you have more)
2025-03-09 10:20:06,935 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0002 secs
2025-03-09 10:20:06,935 [INFO]: 	Selecting most promising index types given data characteristics 03/09/2025, 10:20:06
2025-03-09 10:20:06,935 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-09 10:20:06,935 [INFO]: 	Creating the index 03/09/2025, 10:20:06
2025-03-09 10:20:06,935 [INFO]: 		-> Instanciate the index HNSW15 03/09/2025, 10:20:06
2025-03-09 10:20:06,936 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0012 secs
2025-03-09 10:20:06,936 [INFO]: 		-> Adding the vectors to the index 03/09/2025, 10:20:06
2025-03-09 10:20:06,936 [INFO]: The memory available for adding the vectors is 49.3GB(total available - used by the index)
2025-03-09 10:20:06,936 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/15 [00:00<?, ?it/s]  7%|▋         | 1/15 [00:00<00:02,  5.36it/s] 13%|█▎        | 2/15 [00:00<00:01,  7.10it/s] 20%|██        | 3/15 [00:00<00:01,  7.87it/s] 27%|██▋       | 4/15 [00:00<00:01,  8.32it/s] 33%|███▎      | 5/15 [00:00<00:01,  7.94it/s] 40%|████      | 6/15 [00:00<00:01,  8.34it/s] 47%|████▋     | 7/15 [00:00<00:00,  8.67it/s] 53%|█████▎    | 8/15 [00:00<00:00,  8.81it/s] 60%|██████    | 9/15 [00:01<00:00,  8.94it/s] 67%|██████▋   | 10/15 [00:01<00:00,  9.00it/s] 73%|███████▎  | 11/15 [00:01<00:00,  9.09it/s] 80%|████████  | 12/15 [00:01<00:00,  9.21it/s] 87%|████████▋ | 13/15 [00:01<00:00,  9.20it/s]100%|██████████| 15/15 [00:03<00:00,  1.60it/s]100%|██████████| 15/15 [00:03<00:00,  3.78it/s]
2025-03-09 10:20:10,905 [INFO]: 	Computing best hyperparameters for index knn.index 03/09/2025, 10:20:10
2025-03-09 10:20:46,752 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 35.8474 secs
2025-03-09 10:20:46,753 [INFO]: The best hyperparameters are: efSearch=307
2025-03-09 10:20:46,753 [INFO]: 	Compute fast metrics 03/09/2025, 10:20:46
  0%|          | 0/4 [00:00<?, ?it/s] 25%|██▌       | 1/4 [00:00<00:00,  5.92it/s] 75%|███████▌  | 3/4 [00:00<00:00,  9.20it/s] 75%|███████▌  | 3/4 [00:00<00:00,  7.04it/s]
2025-03-09 10:21:01,398 [INFO]: 	>>> Finished "Compute fast metrics" in 14.6448 secs
2025-03-09 10:21:01,400 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 54.4643 secs
2025-03-09 10:21:01,401 [INFO]: {
2025-03-09 10:21:01,401 [INFO]: 	index_key: HNSW15
2025-03-09 10:21:01,401 [INFO]: 	index_param: efSearch=307
2025-03-09 10:21:01,401 [INFO]: 	index_path: knn.index
2025-03-09 10:21:01,401 [INFO]: 	size in bytes: 719098990
2025-03-09 10:21:01,401 [INFO]: 	avg_search_speed_ms: 10.76050279852488
2025-03-09 10:21:01,401 [INFO]: 	99p_search_speed_ms: 18.241027435287837
2025-03-09 10:21:01,401 [INFO]: 	reconstruction error %: 0.0
2025-03-09 10:21:01,401 [INFO]: 	nb vectors: 3655
2025-03-09 10:21:01,401 [INFO]: 	vectors dimension: 49152
2025-03-09 10:21:01,401 [INFO]: 	compression ratio: 0.9993092049816396
2025-03-09 10:21:01,401 [INFO]: }
2025-03-09 10:21:01,401 [INFO]: 	>>> Finished "Creating the index" in 54.4661 secs
2025-03-09 10:21:01,401 [INFO]: >>> Finished "Launching the whole pipeline" in 54.4967 secs
2025-03-09 10:21:02: [retrieval_preprocessing] calculating distances ...
2025-03-09 10:21:03: [retrieval_preprocessing] finished and saved retrieval indices for episode 54354 [episode count 11/20]
[retrieval_preprocessing] for episode 93271 [episode count 12/20], we have num_retrieval=np.int64(3708) num_query=np.int64(170)
2025-03-09 10:21:04,302 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-09 10:21:04,750 [INFO]: Launching the whole pipeline 03/09/2025, 10:21:04
2025-03-09 10:21:04,750 [INFO]: Reading total number of vectors and dimension 03/09/2025, 10:21:04
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1454.34it/s]
2025-03-09 10:21:04,777 [INFO]: There are 3708 embeddings of dim 49152
2025-03-09 10:21:04,777 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0265 secs
2025-03-09 10:21:04,777 [INFO]: 	Compute estimated construction time of the index 03/09/2025, 10:21:04
2025-03-09 10:21:04,777 [INFO]: 		-> Train: 16.7 minutes
2025-03-09 10:21:04,777 [INFO]: 		-> Add: 2.0 seconds
2025-03-09 10:21:04,777 [INFO]: 		Total: 16.7 minutes
2025-03-09 10:21:04,777 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0001 secs
2025-03-09 10:21:04,777 [INFO]: 	Checking that your have enough memory available to create the index 03/09/2025, 10:21:04
2025-03-09 10:21:04,777 [INFO]: 765.2MB of memory will be needed to build the index (more might be used if you have more)
2025-03-09 10:21:04,777 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0002 secs
2025-03-09 10:21:04,777 [INFO]: 	Selecting most promising index types given data characteristics 03/09/2025, 10:21:04
2025-03-09 10:21:04,777 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-09 10:21:04,777 [INFO]: 	Creating the index 03/09/2025, 10:21:04
2025-03-09 10:21:04,777 [INFO]: 		-> Instanciate the index HNSW15 03/09/2025, 10:21:04
2025-03-09 10:21:04,778 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0011 secs
2025-03-09 10:21:04,778 [INFO]: 		-> Adding the vectors to the index 03/09/2025, 10:21:04
2025-03-09 10:21:04,778 [INFO]: The memory available for adding the vectors is 49.3GB(total available - used by the index)
2025-03-09 10:21:04,779 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/15 [00:00<?, ?it/s]  7%|▋         | 1/15 [00:00<00:02,  6.62it/s] 20%|██        | 3/15 [00:00<00:01, 10.50it/s] 33%|███▎      | 5/15 [00:00<00:00, 11.80it/s] 47%|████▋     | 7/15 [00:00<00:00, 12.30it/s] 60%|██████    | 9/15 [00:00<00:00, 12.60it/s] 73%|███████▎  | 11/15 [00:00<00:00, 12.82it/s] 87%|████████▋ | 13/15 [00:01<00:00, 12.99it/s]100%|██████████| 15/15 [00:03<00:00,  2.25it/s]100%|██████████| 15/15 [00:03<00:00,  4.29it/s]
2025-03-09 10:21:08,279 [INFO]: 	Computing best hyperparameters for index knn.index 03/09/2025, 10:21:08
2025-03-09 10:21:43,606 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 35.3265 secs
2025-03-09 10:21:43,606 [INFO]: The best hyperparameters are: efSearch=309
2025-03-09 10:21:43,606 [INFO]: 	Compute fast metrics 03/09/2025, 10:21:43
  0%|          | 0/4 [00:00<?, ?it/s] 25%|██▌       | 1/4 [00:00<00:00,  4.35it/s] 50%|█████     | 2/4 [00:00<00:00,  5.23it/s] 75%|███████▌  | 3/4 [00:00<00:00,  6.59it/s] 75%|███████▌  | 3/4 [00:00<00:00,  5.04it/s]
2025-03-09 10:21:58,609 [INFO]: 	>>> Finished "Compute fast metrics" in 15.0030 secs
2025-03-09 10:21:58,612 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 53.8332 secs
2025-03-09 10:21:58,612 [INFO]: {
2025-03-09 10:21:58,612 [INFO]: 	index_key: HNSW15
2025-03-09 10:21:58,612 [INFO]: 	index_param: efSearch=309
2025-03-09 10:21:58,612 [INFO]: 	index_path: knn.index
2025-03-09 10:21:58,612 [INFO]: 	size in bytes: 729526210
2025-03-09 10:21:58,612 [INFO]: 	avg_search_speed_ms: 10.475640754454345
2025-03-09 10:21:58,612 [INFO]: 	99p_search_speed_ms: 21.03992968332024
2025-03-09 10:21:58,612 [INFO]: 	reconstruction error %: 0.0
2025-03-09 10:21:58,612 [INFO]: 	nb vectors: 3708
2025-03-09 10:21:58,612 [INFO]: 	vectors dimension: 49152
2025-03-09 10:21:58,612 [INFO]: 	compression ratio: 0.9993094888256311
2025-03-09 10:21:58,612 [INFO]: }
2025-03-09 10:21:58,612 [INFO]: 	>>> Finished "Creating the index" in 53.8347 secs
2025-03-09 10:21:58,612 [INFO]: >>> Finished "Launching the whole pipeline" in 53.8618 secs
2025-03-09 10:21:59: [retrieval_preprocessing] calculating distances ...
2025-03-09 10:22:00: [retrieval_preprocessing] finished and saved retrieval indices for episode 93271 [episode count 12/20]
[retrieval_preprocessing] for episode 85081 [episode count 13/20], we have num_retrieval=np.int64(3681) num_query=np.int64(197)
2025-03-09 10:22:01,256 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-09 10:22:01,718 [INFO]: Launching the whole pipeline 03/09/2025, 10:22:01
2025-03-09 10:22:01,718 [INFO]: Reading total number of vectors and dimension 03/09/2025, 10:22:01
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1951.75it/s]
2025-03-09 10:22:01,744 [INFO]: There are 3681 embeddings of dim 49152
2025-03-09 10:22:01,745 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0263 secs
2025-03-09 10:22:01,745 [INFO]: 	Compute estimated construction time of the index 03/09/2025, 10:22:01
2025-03-09 10:22:01,745 [INFO]: 		-> Train: 16.7 minutes
2025-03-09 10:22:01,745 [INFO]: 		-> Add: 2.0 seconds
2025-03-09 10:22:01,745 [INFO]: 		Total: 16.7 minutes
2025-03-09 10:22:01,745 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0001 secs
2025-03-09 10:22:01,745 [INFO]: 	Checking that your have enough memory available to create the index 03/09/2025, 10:22:01
2025-03-09 10:22:01,745 [INFO]: 759.7MB of memory will be needed to build the index (more might be used if you have more)
2025-03-09 10:22:01,745 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0001 secs
2025-03-09 10:22:01,745 [INFO]: 	Selecting most promising index types given data characteristics 03/09/2025, 10:22:01
2025-03-09 10:22:01,745 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-09 10:22:01,745 [INFO]: 	Creating the index 03/09/2025, 10:22:01
2025-03-09 10:22:01,745 [INFO]: 		-> Instanciate the index HNSW15 03/09/2025, 10:22:01
2025-03-09 10:22:01,746 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0010 secs
2025-03-09 10:22:01,746 [INFO]: 		-> Adding the vectors to the index 03/09/2025, 10:22:01
2025-03-09 10:22:01,746 [INFO]: The memory available for adding the vectors is 49.3GB(total available - used by the index)
2025-03-09 10:22:01,746 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/15 [00:00<?, ?it/s]  7%|▋         | 1/15 [00:00<00:02,  6.40it/s] 20%|██        | 3/15 [00:00<00:01, 11.53it/s] 33%|███▎      | 5/15 [00:00<00:00, 13.37it/s] 47%|████▋     | 7/15 [00:00<00:00, 14.00it/s] 60%|██████    | 9/15 [00:00<00:00, 13.75it/s] 73%|███████▎  | 11/15 [00:00<00:00, 13.87it/s] 87%|████████▋ | 13/15 [00:00<00:00, 13.92it/s]100%|██████████| 15/15 [00:03<00:00,  2.49it/s]100%|██████████| 15/15 [00:03<00:00,  4.74it/s]
2025-03-09 10:22:04,913 [INFO]: 	Computing best hyperparameters for index knn.index 03/09/2025, 10:22:04
2025-03-09 10:22:41,027 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 36.1139 secs
2025-03-09 10:22:41,028 [INFO]: The best hyperparameters are: efSearch=324
2025-03-09 10:22:41,028 [INFO]: 	Compute fast metrics 03/09/2025, 10:22:41
  0%|          | 0/4 [00:00<?, ?it/s] 25%|██▌       | 1/4 [00:00<00:00,  6.12it/s] 75%|███████▌  | 3/4 [00:00<00:00, 10.19it/s] 75%|███████▌  | 3/4 [00:00<00:00,  7.76it/s]
2025-03-09 10:22:55,372 [INFO]: 	>>> Finished "Compute fast metrics" in 14.3438 secs
2025-03-09 10:22:55,375 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 53.6284 secs
2025-03-09 10:22:55,375 [INFO]: {
2025-03-09 10:22:55,375 [INFO]: 	index_key: HNSW15
2025-03-09 10:22:55,375 [INFO]: 	index_param: efSearch=324
2025-03-09 10:22:55,375 [INFO]: 	index_path: knn.index
2025-03-09 10:22:55,375 [INFO]: 	size in bytes: 724214230
2025-03-09 10:22:55,375 [INFO]: 	avg_search_speed_ms: 10.419258903372489
2025-03-09 10:22:55,375 [INFO]: 	99p_search_speed_ms: 25.925559564493593
2025-03-09 10:22:55,375 [INFO]: 	reconstruction error %: 0.0
2025-03-09 10:22:55,375 [INFO]: 	nb vectors: 3681
2025-03-09 10:22:55,375 [INFO]: 	vectors dimension: 49152
2025-03-09 10:22:55,375 [INFO]: 	compression ratio: 0.999309345247193
2025-03-09 10:22:55,375 [INFO]: }
2025-03-09 10:22:55,375 [INFO]: 	>>> Finished "Creating the index" in 53.6300 secs
2025-03-09 10:22:55,375 [INFO]: >>> Finished "Launching the whole pipeline" in 53.6568 secs
2025-03-09 10:22:56: [retrieval_preprocessing] calculating distances ...
2025-03-09 10:22:57: [retrieval_preprocessing] finished and saved retrieval indices for episode 85081 [episode count 13/20]
[retrieval_preprocessing] for episode 92762 [episode count 14/20], we have num_retrieval=np.int64(3663) num_query=np.int64(215)
2025-03-09 10:22:58,087 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-09 10:22:58,541 [INFO]: Launching the whole pipeline 03/09/2025, 10:22:58
2025-03-09 10:22:58,541 [INFO]: Reading total number of vectors and dimension 03/09/2025, 10:22:58
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1310.72it/s]
2025-03-09 10:22:58,571 [INFO]: There are 3663 embeddings of dim 49152
2025-03-09 10:22:58,571 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0297 secs
2025-03-09 10:22:58,571 [INFO]: 	Compute estimated construction time of the index 03/09/2025, 10:22:58
2025-03-09 10:22:58,571 [INFO]: 		-> Train: 16.7 minutes
2025-03-09 10:22:58,571 [INFO]: 		-> Add: 2.0 seconds
2025-03-09 10:22:58,571 [INFO]: 		Total: 16.7 minutes
2025-03-09 10:22:58,571 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0001 secs
2025-03-09 10:22:58,571 [INFO]: 	Checking that your have enough memory available to create the index 03/09/2025, 10:22:58
2025-03-09 10:22:58,572 [INFO]: 756.0MB of memory will be needed to build the index (more might be used if you have more)
2025-03-09 10:22:58,572 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0001 secs
2025-03-09 10:22:58,572 [INFO]: 	Selecting most promising index types given data characteristics 03/09/2025, 10:22:58
2025-03-09 10:22:58,572 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-09 10:22:58,572 [INFO]: 	Creating the index 03/09/2025, 10:22:58
2025-03-09 10:22:58,572 [INFO]: 		-> Instanciate the index HNSW15 03/09/2025, 10:22:58
2025-03-09 10:22:58,573 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0009 secs
2025-03-09 10:22:58,573 [INFO]: 		-> Adding the vectors to the index 03/09/2025, 10:22:58
2025-03-09 10:22:58,573 [INFO]: The memory available for adding the vectors is 49.3GB(total available - used by the index)
2025-03-09 10:22:58,573 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/15 [00:00<?, ?it/s]  7%|▋         | 1/15 [00:00<00:02,  6.35it/s] 27%|██▋       | 4/15 [00:00<00:00, 14.25it/s] 47%|████▋     | 7/15 [00:00<00:00, 16.11it/s] 60%|██████    | 9/15 [00:00<00:00, 15.81it/s] 73%|███████▎  | 11/15 [00:00<00:00, 15.26it/s] 87%|████████▋ | 13/15 [00:00<00:00, 14.39it/s]100%|██████████| 15/15 [00:03<00:00,  2.38it/s]100%|██████████| 15/15 [00:03<00:00,  4.57it/s]
2025-03-09 10:23:01,860 [INFO]: 	Computing best hyperparameters for index knn.index 03/09/2025, 10:23:01
2025-03-09 10:23:36,058 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 34.1976 secs
2025-03-09 10:23:36,058 [INFO]: The best hyperparameters are: efSearch=324
2025-03-09 10:23:36,058 [INFO]: 	Compute fast metrics 03/09/2025, 10:23:36
  0%|          | 0/4 [00:00<?, ?it/s] 25%|██▌       | 1/4 [00:00<00:00,  6.19it/s] 75%|███████▌  | 3/4 [00:00<00:00, 10.20it/s] 75%|███████▌  | 3/4 [00:00<00:00,  7.75it/s]
2025-03-09 10:23:50,197 [INFO]: 	>>> Finished "Compute fast metrics" in 14.1391 secs
2025-03-09 10:23:50,199 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 51.6266 secs
2025-03-09 10:23:50,200 [INFO]: {
2025-03-09 10:23:50,200 [INFO]: 	index_key: HNSW15
2025-03-09 10:23:50,200 [INFO]: 	index_param: efSearch=324
2025-03-09 10:23:50,200 [INFO]: 	index_path: knn.index
2025-03-09 10:23:50,200 [INFO]: 	size in bytes: 720672910
2025-03-09 10:23:50,200 [INFO]: 	avg_search_speed_ms: 10.579830341080509
2025-03-09 10:23:50,200 [INFO]: 	99p_search_speed_ms: 17.69169094040989
2025-03-09 10:23:50,200 [INFO]: 	reconstruction error %: 0.0
2025-03-09 10:23:50,200 [INFO]: 	nb vectors: 3663
2025-03-09 10:23:50,200 [INFO]: 	vectors dimension: 49152
2025-03-09 10:23:50,200 [INFO]: 	compression ratio: 0.9993092483523489
2025-03-09 10:23:50,200 [INFO]: }
2025-03-09 10:23:50,200 [INFO]: 	>>> Finished "Creating the index" in 51.6279 secs
2025-03-09 10:23:50,200 [INFO]: >>> Finished "Launching the whole pipeline" in 51.6583 secs
2025-03-09 10:23:51: [retrieval_preprocessing] calculating distances ...
2025-03-09 10:23:52: [retrieval_preprocessing] finished and saved retrieval indices for episode 92762 [episode count 14/20]
[retrieval_preprocessing] for episode 41051 [episode count 15/20], we have num_retrieval=np.int64(3716) num_query=np.int64(162)
2025-03-09 10:23:52,891 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-09 10:23:53,356 [INFO]: Launching the whole pipeline 03/09/2025, 10:23:53
2025-03-09 10:23:53,356 [INFO]: Reading total number of vectors and dimension 03/09/2025, 10:23:53
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1830.77it/s]
2025-03-09 10:23:53,382 [INFO]: There are 3716 embeddings of dim 49152
2025-03-09 10:23:53,382 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0261 secs
2025-03-09 10:23:53,382 [INFO]: 	Compute estimated construction time of the index 03/09/2025, 10:23:53
2025-03-09 10:23:53,382 [INFO]: 		-> Train: 16.7 minutes
2025-03-09 10:23:53,382 [INFO]: 		-> Add: 2.0 seconds
2025-03-09 10:23:53,383 [INFO]: 		Total: 16.7 minutes
2025-03-09 10:23:53,383 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0001 secs
2025-03-09 10:23:53,383 [INFO]: 	Checking that your have enough memory available to create the index 03/09/2025, 10:23:53
2025-03-09 10:23:53,383 [INFO]: 766.9MB of memory will be needed to build the index (more might be used if you have more)
2025-03-09 10:23:53,383 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0003 secs
2025-03-09 10:23:53,383 [INFO]: 	Selecting most promising index types given data characteristics 03/09/2025, 10:23:53
2025-03-09 10:23:53,383 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-09 10:23:53,383 [INFO]: 	Creating the index 03/09/2025, 10:23:53
2025-03-09 10:23:53,383 [INFO]: 		-> Instanciate the index HNSW15 03/09/2025, 10:23:53
2025-03-09 10:23:53,384 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0011 secs
2025-03-09 10:23:53,384 [INFO]: 		-> Adding the vectors to the index 03/09/2025, 10:23:53
2025-03-09 10:23:53,384 [INFO]: The memory available for adding the vectors is 49.3GB(total available - used by the index)
2025-03-09 10:23:53,385 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/15 [00:00<?, ?it/s]  7%|▋         | 1/15 [00:00<00:02,  5.69it/s] 20%|██        | 3/15 [00:00<00:01,  8.85it/s] 33%|███▎      | 5/15 [00:00<00:00, 10.49it/s] 47%|████▋     | 7/15 [00:00<00:00, 10.13it/s] 60%|██████    | 9/15 [00:00<00:00,  9.94it/s] 73%|███████▎  | 11/15 [00:01<00:00,  9.84it/s] 80%|████████  | 12/15 [00:01<00:00,  9.71it/s] 87%|████████▋ | 13/15 [00:01<00:00,  9.74it/s] 93%|█████████▎| 14/15 [00:01<00:00,  9.61it/s]100%|██████████| 15/15 [00:03<00:00,  1.42it/s]100%|██████████| 15/15 [00:03<00:00,  3.84it/s]
2025-03-09 10:23:57,297 [INFO]: 	Computing best hyperparameters for index knn.index 03/09/2025, 10:23:57
2025-03-09 10:24:31,808 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 34.5100 secs
2025-03-09 10:24:31,808 [INFO]: The best hyperparameters are: efSearch=265
2025-03-09 10:24:31,808 [INFO]: 	Compute fast metrics 03/09/2025, 10:24:31
  0%|          | 0/4 [00:00<?, ?it/s] 25%|██▌       | 1/4 [00:00<00:00,  7.73it/s] 75%|███████▌  | 3/4 [00:00<00:00, 15.29it/s]
2025-03-09 10:24:45,844 [INFO]: 	>>> Finished "Compute fast metrics" in 14.0360 secs
2025-03-09 10:24:45,847 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 52.4623 secs
2025-03-09 10:24:45,847 [INFO]: {
2025-03-09 10:24:45,847 [INFO]: 	index_key: HNSW15
2025-03-09 10:24:45,847 [INFO]: 	index_param: efSearch=265
2025-03-09 10:24:45,847 [INFO]: 	index_path: knn.index
2025-03-09 10:24:45,847 [INFO]: 	size in bytes: 731100190
2025-03-09 10:24:45,847 [INFO]: 	avg_search_speed_ms: 9.19253844425411
2025-03-09 10:24:45,847 [INFO]: 	99p_search_speed_ms: 18.655725256539878
2025-03-09 10:24:45,847 [INFO]: 	reconstruction error %: 0.0
2025-03-09 10:24:45,847 [INFO]: 	nb vectors: 3716
2025-03-09 10:24:45,847 [INFO]: 	vectors dimension: 49152
2025-03-09 10:24:45,847 [INFO]: 	compression ratio: 0.9993094489552793
2025-03-09 10:24:45,847 [INFO]: }
2025-03-09 10:24:45,847 [INFO]: 	>>> Finished "Creating the index" in 52.4639 secs
2025-03-09 10:24:45,847 [INFO]: >>> Finished "Launching the whole pipeline" in 52.4910 secs
2025-03-09 10:24:46: [retrieval_preprocessing] calculating distances ...
2025-03-09 10:24:47: [retrieval_preprocessing] finished and saved retrieval indices for episode 41051 [episode count 15/20]
[retrieval_preprocessing] for episode 91227 [episode count 16/20], we have num_retrieval=np.int64(3731) num_query=np.int64(147)
2025-03-09 10:24:47,909 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-09 10:24:48,347 [INFO]: Launching the whole pipeline 03/09/2025, 10:24:48
2025-03-09 10:24:48,347 [INFO]: Reading total number of vectors and dimension 03/09/2025, 10:24:48
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1563.29it/s]
2025-03-09 10:24:48,375 [INFO]: There are 3731 embeddings of dim 49152
2025-03-09 10:24:48,376 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0285 secs
2025-03-09 10:24:48,376 [INFO]: 	Compute estimated construction time of the index 03/09/2025, 10:24:48
2025-03-09 10:24:48,376 [INFO]: 		-> Train: 16.7 minutes
2025-03-09 10:24:48,376 [INFO]: 		-> Add: 2.0 seconds
2025-03-09 10:24:48,376 [INFO]: 		Total: 16.7 minutes
2025-03-09 10:24:48,376 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0001 secs
2025-03-09 10:24:48,376 [INFO]: 	Checking that your have enough memory available to create the index 03/09/2025, 10:24:48
2025-03-09 10:24:48,376 [INFO]: 770.0MB of memory will be needed to build the index (more might be used if you have more)
2025-03-09 10:24:48,376 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0001 secs
2025-03-09 10:24:48,376 [INFO]: 	Selecting most promising index types given data characteristics 03/09/2025, 10:24:48
2025-03-09 10:24:48,376 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-09 10:24:48,376 [INFO]: 	Creating the index 03/09/2025, 10:24:48
2025-03-09 10:24:48,376 [INFO]: 		-> Instanciate the index HNSW15 03/09/2025, 10:24:48
2025-03-09 10:24:48,377 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0009 secs
2025-03-09 10:24:48,377 [INFO]: 		-> Adding the vectors to the index 03/09/2025, 10:24:48
2025-03-09 10:24:48,377 [INFO]: The memory available for adding the vectors is 49.3GB(total available - used by the index)
2025-03-09 10:24:48,377 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/15 [00:00<?, ?it/s]  7%|▋         | 1/15 [00:00<00:02,  5.61it/s] 20%|██        | 3/15 [00:00<00:01, 10.35it/s] 33%|███▎      | 5/15 [00:00<00:00, 12.01it/s] 47%|████▋     | 7/15 [00:00<00:00, 11.54it/s] 60%|██████    | 9/15 [00:00<00:00, 12.07it/s] 73%|███████▎  | 11/15 [00:00<00:00, 11.43it/s] 87%|████████▋ | 13/15 [00:01<00:00, 10.74it/s]100%|██████████| 15/15 [00:03<00:00,  2.20it/s]100%|██████████| 15/15 [00:03<00:00,  4.14it/s]
2025-03-09 10:24:52,003 [INFO]: 	Computing best hyperparameters for index knn.index 03/09/2025, 10:24:52
2025-03-09 10:25:24,656 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 32.6520 secs
2025-03-09 10:25:24,656 [INFO]: The best hyperparameters are: efSearch=355
2025-03-09 10:25:24,656 [INFO]: 	Compute fast metrics 03/09/2025, 10:25:24
  0%|          | 0/4 [00:00<?, ?it/s] 25%|██▌       | 1/4 [00:00<00:00,  5.77it/s] 50%|█████     | 2/4 [00:00<00:00,  7.50it/s] 75%|███████▌  | 3/4 [00:00<00:00,  8.16it/s] 75%|███████▌  | 3/4 [00:00<00:00,  6.11it/s]
2025-03-09 10:25:40,059 [INFO]: 	>>> Finished "Compute fast metrics" in 15.4030 secs
2025-03-09 10:25:40,061 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 51.6843 secs
2025-03-09 10:25:40,061 [INFO]: {
2025-03-09 10:25:40,061 [INFO]: 	index_key: HNSW15
2025-03-09 10:25:40,061 [INFO]: 	index_param: efSearch=355
2025-03-09 10:25:40,061 [INFO]: 	index_path: knn.index
2025-03-09 10:25:40,062 [INFO]: 	size in bytes: 734051470
2025-03-09 10:25:40,062 [INFO]: 	avg_search_speed_ms: 10.75821502775114
2025-03-09 10:25:40,062 [INFO]: 	99p_search_speed_ms: 14.86888965824619
2025-03-09 10:25:40,062 [INFO]: 	reconstruction error %: 0.0
2025-03-09 10:25:40,062 [INFO]: 	nb vectors: 3731
2025-03-09 10:25:40,062 [INFO]: 	vectors dimension: 49152
2025-03-09 10:25:40,062 [INFO]: 	compression ratio: 0.9993092827673242
2025-03-09 10:25:40,062 [INFO]: }
2025-03-09 10:25:40,062 [INFO]: 	>>> Finished "Creating the index" in 51.6857 secs
2025-03-09 10:25:40,062 [INFO]: >>> Finished "Launching the whole pipeline" in 51.7147 secs
2025-03-09 10:25:41: [retrieval_preprocessing] calculating distances ...
2025-03-09 10:25:42: [retrieval_preprocessing] finished and saved retrieval indices for episode 91227 [episode count 16/20]
[retrieval_preprocessing] for episode 49252 [episode count 17/20], we have num_retrieval=np.int64(3713) num_query=np.int64(165)
2025-03-09 10:25:43,382 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-09 10:25:43,881 [INFO]: Launching the whole pipeline 03/09/2025, 10:25:43
2025-03-09 10:25:43,881 [INFO]: Reading total number of vectors and dimension 03/09/2025, 10:25:43
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1498.50it/s]
2025-03-09 10:25:43,905 [INFO]: There are 3713 embeddings of dim 49152
2025-03-09 10:25:43,905 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0243 secs
2025-03-09 10:25:43,905 [INFO]: 	Compute estimated construction time of the index 03/09/2025, 10:25:43
2025-03-09 10:25:43,905 [INFO]: 		-> Train: 16.7 minutes
2025-03-09 10:25:43,905 [INFO]: 		-> Add: 2.0 seconds
2025-03-09 10:25:43,905 [INFO]: 		Total: 16.7 minutes
2025-03-09 10:25:43,905 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0001 secs
2025-03-09 10:25:43,905 [INFO]: 	Checking that your have enough memory available to create the index 03/09/2025, 10:25:43
2025-03-09 10:25:43,905 [INFO]: 766.3MB of memory will be needed to build the index (more might be used if you have more)
2025-03-09 10:25:43,905 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0001 secs
2025-03-09 10:25:43,905 [INFO]: 	Selecting most promising index types given data characteristics 03/09/2025, 10:25:43
2025-03-09 10:25:43,905 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-09 10:25:43,905 [INFO]: 	Creating the index 03/09/2025, 10:25:43
2025-03-09 10:25:43,906 [INFO]: 		-> Instanciate the index HNSW15 03/09/2025, 10:25:43
2025-03-09 10:25:43,907 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0010 secs
2025-03-09 10:25:43,907 [INFO]: 		-> Adding the vectors to the index 03/09/2025, 10:25:43
2025-03-09 10:25:43,907 [INFO]: The memory available for adding the vectors is 49.3GB(total available - used by the index)
2025-03-09 10:25:43,907 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/15 [00:00<?, ?it/s]  7%|▋         | 1/15 [00:00<00:02,  5.44it/s] 13%|█▎        | 2/15 [00:00<00:01,  7.10it/s] 20%|██        | 3/15 [00:00<00:01,  7.87it/s] 27%|██▋       | 4/15 [00:00<00:01,  8.32it/s] 33%|███▎      | 5/15 [00:00<00:01,  8.59it/s] 40%|████      | 6/15 [00:00<00:01,  8.67it/s] 47%|████▋     | 7/15 [00:00<00:00,  8.70it/s] 53%|█████▎    | 8/15 [00:00<00:00,  8.77it/s] 60%|██████    | 9/15 [00:01<00:00,  8.79it/s] 67%|██████▋   | 10/15 [00:01<00:00,  8.89it/s] 73%|███████▎  | 11/15 [00:01<00:00,  8.89it/s] 80%|████████  | 12/15 [00:01<00:00,  8.87it/s] 87%|████████▋ | 13/15 [00:01<00:00,  8.91it/s] 93%|█████████▎| 14/15 [00:01<00:00,  8.93it/s]100%|██████████| 15/15 [00:04<00:00,  1.21it/s]100%|██████████| 15/15 [00:04<00:00,  3.63it/s]
2025-03-09 10:25:48,036 [INFO]: 	Computing best hyperparameters for index knn.index 03/09/2025, 10:25:48
2025-03-09 10:26:18,572 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 30.5353 secs
2025-03-09 10:26:18,572 [INFO]: The best hyperparameters are: efSearch=399
2025-03-09 10:26:18,572 [INFO]: 	Compute fast metrics 03/09/2025, 10:26:18
  0%|          | 0/4 [00:00<?, ?it/s] 25%|██▌       | 1/4 [00:00<00:00,  5.39it/s] 50%|█████     | 2/4 [00:00<00:00,  7.23it/s] 75%|███████▌  | 3/4 [00:00<00:00,  8.20it/s] 75%|███████▌  | 3/4 [00:00<00:00,  6.09it/s]
2025-03-09 10:26:33,957 [INFO]: 	>>> Finished "Compute fast metrics" in 15.3849 secs
2025-03-09 10:26:33,960 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 50.0530 secs
2025-03-09 10:26:33,960 [INFO]: {
2025-03-09 10:26:33,960 [INFO]: 	index_key: HNSW15
2025-03-09 10:26:33,960 [INFO]: 	index_param: efSearch=399
2025-03-09 10:26:33,960 [INFO]: 	index_path: knn.index
2025-03-09 10:26:33,960 [INFO]: 	size in bytes: 730509970
2025-03-09 10:26:33,960 [INFO]: 	avg_search_speed_ms: 11.710246088391113
2025-03-09 10:26:33,960 [INFO]: 	99p_search_speed_ms: 21.154988391790546
2025-03-09 10:26:33,960 [INFO]: 	reconstruction error %: 0.0
2025-03-09 10:26:33,960 [INFO]: 	nb vectors: 3713
2025-03-09 10:26:33,960 [INFO]: 	vectors dimension: 49152
2025-03-09 10:26:33,960 [INFO]: 	compression ratio: 0.9993094331073948
2025-03-09 10:26:33,960 [INFO]: }
2025-03-09 10:26:33,960 [INFO]: 	>>> Finished "Creating the index" in 50.0545 secs
2025-03-09 10:26:33,960 [INFO]: >>> Finished "Launching the whole pipeline" in 50.0793 secs
2025-03-09 10:26:36: [retrieval_preprocessing] calculating distances ...
2025-03-09 10:26:36: [retrieval_preprocessing] finished and saved retrieval indices for episode 49252 [episode count 17/20]
[retrieval_preprocessing] for episode 81006 [episode count 18/20], we have num_retrieval=np.int64(3723) num_query=np.int64(155)
2025-03-09 10:26:37,332 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-09 10:26:37,771 [INFO]: Launching the whole pipeline 03/09/2025, 10:26:37
2025-03-09 10:26:37,771 [INFO]: Reading total number of vectors and dimension 03/09/2025, 10:26:37
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1487.34it/s]
2025-03-09 10:26:37,798 [INFO]: There are 3723 embeddings of dim 49152
2025-03-09 10:26:37,798 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0273 secs
2025-03-09 10:26:37,798 [INFO]: 	Compute estimated construction time of the index 03/09/2025, 10:26:37
2025-03-09 10:26:37,798 [INFO]: 		-> Train: 16.7 minutes
2025-03-09 10:26:37,798 [INFO]: 		-> Add: 2.0 seconds
2025-03-09 10:26:37,798 [INFO]: 		Total: 16.7 minutes
2025-03-09 10:26:37,798 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0001 secs
2025-03-09 10:26:37,798 [INFO]: 	Checking that your have enough memory available to create the index 03/09/2025, 10:26:37
2025-03-09 10:26:37,798 [INFO]: 768.3MB of memory will be needed to build the index (more might be used if you have more)
2025-03-09 10:26:37,798 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0002 secs
2025-03-09 10:26:37,798 [INFO]: 	Selecting most promising index types given data characteristics 03/09/2025, 10:26:37
2025-03-09 10:26:37,798 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-09 10:26:37,799 [INFO]: 	Creating the index 03/09/2025, 10:26:37
2025-03-09 10:26:37,799 [INFO]: 		-> Instanciate the index HNSW15 03/09/2025, 10:26:37
2025-03-09 10:26:37,800 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0012 secs
2025-03-09 10:26:37,800 [INFO]: 		-> Adding the vectors to the index 03/09/2025, 10:26:37
2025-03-09 10:26:37,800 [INFO]: The memory available for adding the vectors is 49.3GB(total available - used by the index)
2025-03-09 10:26:37,800 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/15 [00:00<?, ?it/s]  7%|▋         | 1/15 [00:00<00:02,  5.80it/s] 20%|██        | 3/15 [00:00<00:01,  9.91it/s] 33%|███▎      | 5/15 [00:00<00:00, 11.57it/s] 47%|████▋     | 7/15 [00:00<00:00, 12.49it/s] 67%|██████▋   | 10/15 [00:00<00:00, 14.43it/s] 80%|████████  | 12/15 [00:00<00:00, 13.97it/s] 93%|█████████▎| 14/15 [00:01<00:00, 13.73it/s]100%|██████████| 15/15 [00:03<00:00,  4.72it/s]
2025-03-09 10:26:40,984 [INFO]: 	Computing best hyperparameters for index knn.index 03/09/2025, 10:26:40
2025-03-09 10:27:14,437 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 33.4527 secs
2025-03-09 10:27:14,437 [INFO]: The best hyperparameters are: efSearch=326
2025-03-09 10:27:14,437 [INFO]: 	Compute fast metrics 03/09/2025, 10:27:14
  0%|          | 0/4 [00:00<?, ?it/s] 25%|██▌       | 1/4 [00:00<00:00,  6.22it/s] 75%|███████▌  | 3/4 [00:00<00:00, 10.41it/s] 75%|███████▌  | 3/4 [00:00<00:00,  7.95it/s]
2025-03-09 10:27:28,109 [INFO]: 	>>> Finished "Compute fast metrics" in 13.6715 secs
2025-03-09 10:27:28,111 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 50.3115 secs
2025-03-09 10:27:28,112 [INFO]: {
2025-03-09 10:27:28,112 [INFO]: 	index_key: HNSW15
2025-03-09 10:27:28,112 [INFO]: 	index_param: efSearch=326
2025-03-09 10:27:28,112 [INFO]: 	index_path: knn.index
2025-03-09 10:27:28,112 [INFO]: 	size in bytes: 732477370
2025-03-09 10:27:28,112 [INFO]: 	avg_search_speed_ms: 10.154717159339317
2025-03-09 10:27:28,112 [INFO]: 	99p_search_speed_ms: 14.311120389029378
2025-03-09 10:27:28,112 [INFO]: 	reconstruction error %: 0.0
2025-03-09 10:27:28,112 [INFO]: 	nb vectors: 3723
2025-03-09 10:27:28,112 [INFO]: 	vectors dimension: 49152
2025-03-09 10:27:28,112 [INFO]: 	compression ratio: 0.9993094858343542
2025-03-09 10:27:28,112 [INFO]: }
2025-03-09 10:27:28,112 [INFO]: 	>>> Finished "Creating the index" in 50.3132 secs
2025-03-09 10:27:28,112 [INFO]: >>> Finished "Launching the whole pipeline" in 50.3412 secs
2025-03-09 10:27:29: [retrieval_preprocessing] calculating distances ...
2025-03-09 10:27:29: [retrieval_preprocessing] finished and saved retrieval indices for episode 81006 [episode count 18/20]
[retrieval_preprocessing] for episode 58998 [episode count 19/20], we have num_retrieval=np.int64(3663) num_query=np.int64(215)
2025-03-09 10:27:30,580 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-09 10:27:31,047 [INFO]: Launching the whole pipeline 03/09/2025, 10:27:31
2025-03-09 10:27:31,047 [INFO]: Reading total number of vectors and dimension 03/09/2025, 10:27:31
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1861.65it/s]
2025-03-09 10:27:31,073 [INFO]: There are 3663 embeddings of dim 49152
2025-03-09 10:27:31,073 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0254 secs
2025-03-09 10:27:31,073 [INFO]: 	Compute estimated construction time of the index 03/09/2025, 10:27:31
2025-03-09 10:27:31,073 [INFO]: 		-> Train: 16.7 minutes
2025-03-09 10:27:31,073 [INFO]: 		-> Add: 2.0 seconds
2025-03-09 10:27:31,073 [INFO]: 		Total: 16.7 minutes
2025-03-09 10:27:31,073 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0001 secs
2025-03-09 10:27:31,073 [INFO]: 	Checking that your have enough memory available to create the index 03/09/2025, 10:27:31
2025-03-09 10:27:31,073 [INFO]: 756.0MB of memory will be needed to build the index (more might be used if you have more)
2025-03-09 10:27:31,073 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0002 secs
2025-03-09 10:27:31,073 [INFO]: 	Selecting most promising index types given data characteristics 03/09/2025, 10:27:31
2025-03-09 10:27:31,073 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-09 10:27:31,073 [INFO]: 	Creating the index 03/09/2025, 10:27:31
2025-03-09 10:27:31,073 [INFO]: 		-> Instanciate the index HNSW15 03/09/2025, 10:27:31
2025-03-09 10:27:31,075 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0011 secs
2025-03-09 10:27:31,075 [INFO]: 		-> Adding the vectors to the index 03/09/2025, 10:27:31
2025-03-09 10:27:31,075 [INFO]: The memory available for adding the vectors is 49.3GB(total available - used by the index)
2025-03-09 10:27:31,075 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/15 [00:00<?, ?it/s]  7%|▋         | 1/15 [00:00<00:02,  6.20it/s] 33%|███▎      | 5/15 [00:00<00:00, 19.95it/s] 60%|██████    | 9/15 [00:00<00:00, 25.46it/s] 80%|████████  | 12/15 [00:00<00:00, 24.22it/s]100%|██████████| 15/15 [00:03<00:00,  2.85it/s]100%|██████████| 15/15 [00:03<00:00,  4.48it/s]
2025-03-09 10:27:34,430 [INFO]: 	Computing best hyperparameters for index knn.index 03/09/2025, 10:27:34
2025-03-09 10:28:08,043 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 33.6130 secs
2025-03-09 10:28:08,044 [INFO]: The best hyperparameters are: efSearch=323
2025-03-09 10:28:08,044 [INFO]: 	Compute fast metrics 03/09/2025, 10:28:08
  0%|          | 0/4 [00:00<?, ?it/s] 25%|██▌       | 1/4 [00:00<00:00,  6.16it/s] 75%|███████▌  | 3/4 [00:00<00:00, 10.28it/s] 75%|███████▌  | 3/4 [00:00<00:00,  7.82it/s]
2025-03-09 10:28:21,229 [INFO]: 	>>> Finished "Compute fast metrics" in 13.1847 secs
2025-03-09 10:28:21,231 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 50.1559 secs
2025-03-09 10:28:21,231 [INFO]: {
2025-03-09 10:28:21,231 [INFO]: 	index_key: HNSW15
2025-03-09 10:28:21,231 [INFO]: 	index_param: efSearch=323
2025-03-09 10:28:21,231 [INFO]: 	index_path: knn.index
2025-03-09 10:28:21,231 [INFO]: 	size in bytes: 720672910
2025-03-09 10:28:21,231 [INFO]: 	avg_search_speed_ms: 10.047974890500457
2025-03-09 10:28:21,231 [INFO]: 	99p_search_speed_ms: 15.036012432537955
2025-03-09 10:28:21,231 [INFO]: 	reconstruction error %: 0.0
2025-03-09 10:28:21,231 [INFO]: 	nb vectors: 3663
2025-03-09 10:28:21,231 [INFO]: 	vectors dimension: 49152
2025-03-09 10:28:21,231 [INFO]: 	compression ratio: 0.9993092483523489
2025-03-09 10:28:21,231 [INFO]: }
2025-03-09 10:28:21,231 [INFO]: 	>>> Finished "Creating the index" in 50.1574 secs
2025-03-09 10:28:21,231 [INFO]: >>> Finished "Launching the whole pipeline" in 50.1835 secs
2025-03-09 10:28:22: [retrieval_preprocessing] calculating distances ...
2025-03-09 10:28:23: [retrieval_preprocessing] finished and saved retrieval indices for episode 58998 [episode count 19/20]
2025-03-09 10:28:23: [retrieval_preprocessing] finished for (4345518188, 'lid') [chosen_id count 9/10]
2025-03-09 10:28:23: [retrieval_preprocessing] done for embedding_type='embeddings__wrist_image_left'!
