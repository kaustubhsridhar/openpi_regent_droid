nohup: ignoring input
2025-03-09 06:47:40: got the info dicts: there are 36687 groupings

2025-03-09 06:47:40: number of groupings with atleast 50 episodes [in the first 95658 episodes]: 105

these groupings have chosen_id-->num_episodes as

 {(1297764552, 'bottle'): 53, (2515873443, 'cloth'): 50, (5235850418, 'drawer'): 612, (5879622450, 'block'): 108, (1431810548, 'lid'): 51, (3485794757, 'marker'): 97, (8756300955, 'block'): 117, (1180576306, 'cloth'): 60, (9154343709, 'drawer'): 96, (6498288010, 'bottle'): 138, (8911427557, 'bottle'): 50, (1058976383, 'drawer'): 148, (4045730075, 'lid'): 61, (1712293193, 'marker'): 163, (65137982, 'block'): 100, (4329524892, 'cup'): 166, (484659531, 'marker'): 96, (-1, 'marker'): 1032, (6078642573, 'marker'): 54, (452818143, 'lid'): 221, (1461982682, 'cloth'): 76, (5235850418, 'block'): 97, (7495112204, 'marker'): 102, (666854965, 'marker'): 68, (395700094, 'block'): 72, (3827924651, 'lid'): 67, (6612454114, 'block'): 65, (2782099537, 'marker'): 75, (8376714657, 'marker'): 464, (3452853472, 'drawer'): 91, (9306310171, 'marker'): 97, (3816161570, 'drawer'): 78, (5511329841, 'marker'): 59, (3951366978, 'cup'): 112, (1959308322, 'marker'): 65, (3163748394, 'cup'): 127, (7644292911, 'marker'): 50, (1775582436, 'marker'): 98, (4706041793, 'cloth'): 142, (2370783071, 'block'): 50, (9551783935, 'drawer'): 65, (2782099537, 'cup'): 153, (7489911085, 'cloth'): 179, (5576515039, 'marker'): 50, (4465064685, 'marker'): 198, (9186164821, 'bottle'): 57, (5207831207, 'cup'): 139, (3774560981, 'cloth'): 99, (4823049285, 'bottle'): 234, (9130122211, 'marker'): 159, (6313680013, 'cup'): 50, (9088223759, 'bottle'): 99, (8098563998, 'lid'): 73, (9505766118, 'drawer'): 108, (441689524, 'mug'): 77, (8150285641, 'marker'): 63, (8456936732, 'bottle'): 54, (446878712, 'marker'): 83, (6093644330, 'cloth'): 52, (4345518188, 'lid'): 89, (5024387521, 'marker'): 60, (6498288010, 'lid'): 96, (4823049285, 'block'): 174, (6667529842, 'lid'): 90, (5507987860, 'marker'): 100, (8898968162, 'block'): 58, (-1, 'mug'): 228, (9965421062, 'bottle'): 63, (6357288647, 'lid'): 71, (5701580274, 'marker'): 67, (1469427884, 'marker'): 63, (9933578360, 'drawer'): 53, (1498834123, 'cup'): 77, (440287856, 'drawer'): 75, (376702246, 'cup'): 53, (9883209091, 'mug'): 201, (9934859632, 'marker'): 62, (4312815282, 'marker'): 66, (-1, 'cup'): 113, (8922050678, 'lid'): 64, (2883696971, 'cup'): 69, (9209350647, 'drawer'): 76, (6655265581, 'cup'): 51, (4345518188, 'cloth'): 91, (4545879864, 'marker'): 51, (818725642, 'block'): 63, (3854327802, 'bottle'): 97, (3951366978, 'lid'): 72, (5059283044, 'drawer'): 113, (4846810092, 'cloth'): 93, (8690198922, 'marker'): 65, (1477699675, 'marker'): 89, (4400212150, 'marker'): 52, (1526685371, 'marker'): 62, (6074146895, 'lid'): 59, (8911427557, 'cup'): 112, (8702636502, 'lid'): 90, (8172596608, 'cup'): 51, (1575177183, 'marker'): 59, (5414640868, 'lid'): 56, (1477699675, 'mug'): 57, (9228483020, 'marker'): 80, (2927338332, 'cloth'): 51, (52817038, 'block'): 54, (8815207926, 'block'): 54}
2025-03-09 06:47:40: [retrieval_preprocessing] starting retrieval preprocessing for embeddings__wrist_image_left
2025-03-09 06:47:43: [retrieval_preprocessing] concatenated all embeddings and indices for 20 episodes for (5024387521, 'marker') [chosen_id count 0/10]
2025-03-09 06:47:43: [retrieval_preprocessing] we have num_total=3635 embedding_dim=49152
[retrieval_preprocessing] for episode 8579 [episode count 0/20], we have num_retrieval=np.int64(3479) num_query=np.int64(156)
2025-03-09 06:47:44,408 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-09 06:47:44,952 [INFO]: Launching the whole pipeline 03/09/2025, 06:47:44
2025-03-09 06:47:44,953 [INFO]: Reading total number of vectors and dimension 03/09/2025, 06:47:44
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1774.24it/s]
2025-03-09 06:47:44,976 [INFO]: There are 3479 embeddings of dim 49152
2025-03-09 06:47:44,976 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0233 secs
2025-03-09 06:47:44,976 [INFO]: 	Compute estimated construction time of the index 03/09/2025, 06:47:44
2025-03-09 06:47:44,976 [INFO]: 		-> Train: 16.7 minutes
2025-03-09 06:47:44,976 [INFO]: 		-> Add: 1.9 seconds
2025-03-09 06:47:44,976 [INFO]: 		Total: 16.7 minutes
2025-03-09 06:47:44,976 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0002 secs
2025-03-09 06:47:44,976 [INFO]: 	Checking that your have enough memory available to create the index 03/09/2025, 06:47:44
2025-03-09 06:47:44,977 [INFO]: 718.0MB of memory will be needed to build the index (more might be used if you have more)
2025-03-09 06:47:44,977 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0006 secs
2025-03-09 06:47:44,977 [INFO]: 	Selecting most promising index types given data characteristics 03/09/2025, 06:47:44
2025-03-09 06:47:44,977 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-09 06:47:44,977 [INFO]: 	Creating the index 03/09/2025, 06:47:44
2025-03-09 06:47:44,977 [INFO]: 		-> Instanciate the index HNSW15 03/09/2025, 06:47:44
2025-03-09 06:47:44,979 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0015 secs
2025-03-09 06:47:44,979 [INFO]: 		-> Adding the vectors to the index 03/09/2025, 06:47:44
2025-03-09 06:47:44,979 [INFO]: The memory available for adding the vectors is 49.4GB(total available - used by the index)
2025-03-09 06:47:44,979 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/14 [00:00<?, ?it/s]  7%|▋         | 1/14 [00:00<00:02,  5.50it/s] 21%|██▏       | 3/14 [00:00<00:01,  9.63it/s] 50%|█████     | 7/14 [00:00<00:00, 19.20it/s] 93%|█████████▎| 13/14 [00:00<00:00, 30.91it/s]100%|██████████| 14/14 [00:02<00:00,  5.05it/s]
2025-03-09 06:47:47,760 [INFO]: 	Computing best hyperparameters for index knn.index 03/09/2025, 06:47:47
2025-03-09 06:48:26,088 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 38.3282 secs
2025-03-09 06:48:26,089 [INFO]: The best hyperparameters are: efSearch=216
2025-03-09 06:48:26,089 [INFO]: 	Compute fast metrics 03/09/2025, 06:48:26
  0%|          | 0/4 [00:00<?, ?it/s] 25%|██▌       | 1/4 [00:00<00:00,  5.89it/s] 75%|███████▌  | 3/4 [00:00<00:00,  9.21it/s] 75%|███████▌  | 3/4 [00:00<00:00,  7.05it/s]
2025-03-09 06:48:39,289 [INFO]: 	>>> Finished "Compute fast metrics" in 13.1998 secs
2025-03-09 06:48:39,291 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 54.3121 secs
2025-03-09 06:48:39,291 [INFO]: {
2025-03-09 06:48:39,291 [INFO]: 	index_key: HNSW15
2025-03-09 06:48:39,291 [INFO]: 	index_param: efSearch=216
2025-03-09 06:48:39,291 [INFO]: 	index_path: knn.index
2025-03-09 06:48:39,291 [INFO]: 	size in bytes: 684471910
2025-03-09 06:48:39,291 [INFO]: 	avg_search_speed_ms: 9.68472472218921
2025-03-09 06:48:39,291 [INFO]: 	99p_search_speed_ms: 14.501486616209146
2025-03-09 06:48:39,291 [INFO]: 	reconstruction error %: 0.0
2025-03-09 06:48:39,291 [INFO]: 	nb vectors: 3479
2025-03-09 06:48:39,291 [INFO]: 	vectors dimension: 49152
2025-03-09 06:48:39,291 [INFO]: 	compression ratio: 0.9993094267374683
2025-03-09 06:48:39,291 [INFO]: }
2025-03-09 06:48:39,291 [INFO]: 	>>> Finished "Creating the index" in 54.3142 secs
2025-03-09 06:48:39,291 [INFO]: >>> Finished "Launching the whole pipeline" in 54.3387 secs
2025-03-09 06:48:39: [retrieval_preprocessing] calculating distances ...
2025-03-09 06:48:40: [retrieval_preprocessing] finished and saved retrieval indices for episode 8579 [episode count 0/20]
[retrieval_preprocessing] for episode 84099 [episode count 1/20], we have num_retrieval=np.int64(3441) num_query=np.int64(194)
2025-03-09 06:48:41,500 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-09 06:48:41,953 [INFO]: Launching the whole pipeline 03/09/2025, 06:48:41
2025-03-09 06:48:41,953 [INFO]: Reading total number of vectors and dimension 03/09/2025, 06:48:41
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1760.83it/s]
2025-03-09 06:48:41,976 [INFO]: There are 3441 embeddings of dim 49152
2025-03-09 06:48:41,976 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0222 secs
2025-03-09 06:48:41,976 [INFO]: 	Compute estimated construction time of the index 03/09/2025, 06:48:41
2025-03-09 06:48:41,976 [INFO]: 		-> Train: 16.7 minutes
2025-03-09 06:48:41,976 [INFO]: 		-> Add: 1.9 seconds
2025-03-09 06:48:41,976 [INFO]: 		Total: 16.7 minutes
2025-03-09 06:48:41,976 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0001 secs
2025-03-09 06:48:41,976 [INFO]: 	Checking that your have enough memory available to create the index 03/09/2025, 06:48:41
2025-03-09 06:48:41,976 [INFO]: 710.1MB of memory will be needed to build the index (more might be used if you have more)
2025-03-09 06:48:41,976 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0001 secs
2025-03-09 06:48:41,976 [INFO]: 	Selecting most promising index types given data characteristics 03/09/2025, 06:48:41
2025-03-09 06:48:41,976 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-09 06:48:41,976 [INFO]: 	Creating the index 03/09/2025, 06:48:41
2025-03-09 06:48:41,976 [INFO]: 		-> Instanciate the index HNSW15 03/09/2025, 06:48:41
2025-03-09 06:48:41,977 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0008 secs
2025-03-09 06:48:41,977 [INFO]: 		-> Adding the vectors to the index 03/09/2025, 06:48:41
2025-03-09 06:48:41,977 [INFO]: The memory available for adding the vectors is 49.4GB(total available - used by the index)
2025-03-09 06:48:41,977 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/14 [00:00<?, ?it/s]  7%|▋         | 1/14 [00:00<00:02,  6.42it/s] 21%|██▏       | 3/14 [00:00<00:01, 10.73it/s] 43%|████▎     | 6/14 [00:00<00:00, 13.75it/s] 57%|█████▋    | 8/14 [00:00<00:00, 13.04it/s] 71%|███████▏  | 10/14 [00:00<00:00, 12.71it/s] 86%|████████▌ | 12/14 [00:00<00:00, 12.60it/s]100%|██████████| 14/14 [00:03<00:00,  2.23it/s]100%|██████████| 14/14 [00:03<00:00,  4.08it/s]
2025-03-09 06:48:45,413 [INFO]: 	Computing best hyperparameters for index knn.index 03/09/2025, 06:48:45
2025-03-09 06:49:19,570 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 34.1570 secs
2025-03-09 06:49:19,571 [INFO]: The best hyperparameters are: efSearch=283
2025-03-09 06:49:19,571 [INFO]: 	Compute fast metrics 03/09/2025, 06:49:19
  0%|          | 0/4 [00:00<?, ?it/s] 25%|██▌       | 1/4 [00:00<00:00,  7.20it/s] 75%|███████▌  | 3/4 [00:00<00:00, 10.54it/s]
2025-03-09 06:49:33,332 [INFO]: 	>>> Finished "Compute fast metrics" in 13.7614 secs
2025-03-09 06:49:33,339 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 51.3612 secs
2025-03-09 06:49:33,339 [INFO]: {
2025-03-09 06:49:33,339 [INFO]: 	index_key: HNSW15
2025-03-09 06:49:33,339 [INFO]: 	index_param: efSearch=283
2025-03-09 06:49:33,339 [INFO]: 	index_path: knn.index
2025-03-09 06:49:33,339 [INFO]: 	size in bytes: 676995670
2025-03-09 06:49:33,339 [INFO]: 	avg_search_speed_ms: 12.25748922340298
2025-03-09 06:49:33,339 [INFO]: 	99p_search_speed_ms: 19.32066462468357
2025-03-09 06:49:33,339 [INFO]: 	reconstruction error %: 0.0
2025-03-09 06:49:33,339 [INFO]: 	nb vectors: 3441
2025-03-09 06:49:33,339 [INFO]: 	vectors dimension: 49152
2025-03-09 06:49:33,339 [INFO]: 	compression ratio: 0.9993093870157249
2025-03-09 06:49:33,339 [INFO]: }
2025-03-09 06:49:33,339 [INFO]: 	>>> Finished "Creating the index" in 51.3628 secs
2025-03-09 06:49:33,339 [INFO]: >>> Finished "Launching the whole pipeline" in 51.3856 secs
2025-03-09 06:49:35: [retrieval_preprocessing] calculating distances ...
2025-03-09 06:49:36: [retrieval_preprocessing] finished and saved retrieval indices for episode 84099 [episode count 1/20]
[retrieval_preprocessing] for episode 76810 [episode count 2/20], we have num_retrieval=np.int64(3460) num_query=np.int64(175)
2025-03-09 06:49:37,339 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-09 06:49:37,922 [INFO]: Launching the whole pipeline 03/09/2025, 06:49:37
2025-03-09 06:49:37,922 [INFO]: Reading total number of vectors and dimension 03/09/2025, 06:49:37
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1681.08it/s]
2025-03-09 06:49:37,952 [INFO]: There are 3460 embeddings of dim 49152
2025-03-09 06:49:37,953 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0303 secs
2025-03-09 06:49:37,953 [INFO]: 	Compute estimated construction time of the index 03/09/2025, 06:49:37
2025-03-09 06:49:37,953 [INFO]: 		-> Train: 16.7 minutes
2025-03-09 06:49:37,953 [INFO]: 		-> Add: 1.9 seconds
2025-03-09 06:49:37,953 [INFO]: 		Total: 16.7 minutes
2025-03-09 06:49:37,953 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0001 secs
2025-03-09 06:49:37,953 [INFO]: 	Checking that your have enough memory available to create the index 03/09/2025, 06:49:37
2025-03-09 06:49:37,953 [INFO]: 714.1MB of memory will be needed to build the index (more might be used if you have more)
2025-03-09 06:49:37,953 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0002 secs
2025-03-09 06:49:37,953 [INFO]: 	Selecting most promising index types given data characteristics 03/09/2025, 06:49:37
2025-03-09 06:49:37,953 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-09 06:49:37,953 [INFO]: 	Creating the index 03/09/2025, 06:49:37
2025-03-09 06:49:37,953 [INFO]: 		-> Instanciate the index HNSW15 03/09/2025, 06:49:37
2025-03-09 06:49:37,954 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0011 secs
2025-03-09 06:49:37,955 [INFO]: 		-> Adding the vectors to the index 03/09/2025, 06:49:37
2025-03-09 06:49:37,955 [INFO]: The memory available for adding the vectors is 49.4GB(total available - used by the index)
2025-03-09 06:49:37,955 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/14 [00:00<?, ?it/s]  7%|▋         | 1/14 [00:00<00:02,  4.42it/s] 14%|█▍        | 2/14 [00:00<00:02,  4.47it/s] 21%|██▏       | 3/14 [00:00<00:01,  5.91it/s] 36%|███▌      | 5/14 [00:00<00:01,  8.43it/s] 50%|█████     | 7/14 [00:00<00:00,  8.91it/s] 64%|██████▍   | 9/14 [00:01<00:00,  9.73it/s] 79%|███████▊  | 11/14 [00:01<00:00, 10.52it/s] 93%|█████████▎| 13/14 [00:01<00:00, 11.48it/s]100%|██████████| 14/14 [00:04<00:00,  3.40it/s]
2025-03-09 06:49:42,076 [INFO]: 	Computing best hyperparameters for index knn.index 03/09/2025, 06:49:42
2025-03-09 06:50:19,126 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 37.0493 secs
2025-03-09 06:50:19,126 [INFO]: The best hyperparameters are: efSearch=249
2025-03-09 06:50:19,126 [INFO]: 	Compute fast metrics 03/09/2025, 06:50:19
  0%|          | 0/4 [00:00<?, ?it/s] 25%|██▌       | 1/4 [00:00<00:00,  5.09it/s] 50%|█████     | 2/4 [00:00<00:00,  6.69it/s] 75%|███████▌  | 3/4 [00:00<00:00,  7.26it/s] 75%|███████▌  | 3/4 [00:00<00:00,  5.62it/s]
2025-03-09 06:50:32,041 [INFO]: 	>>> Finished "Compute fast metrics" in 12.9147 secs
2025-03-09 06:50:32,043 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 54.0884 secs
2025-03-09 06:50:32,043 [INFO]: {
2025-03-09 06:50:32,043 [INFO]: 	index_key: HNSW15
2025-03-09 06:50:32,043 [INFO]: 	index_param: efSearch=249
2025-03-09 06:50:32,043 [INFO]: 	index_path: knn.index
2025-03-09 06:50:32,043 [INFO]: 	size in bytes: 680733790
2025-03-09 06:50:32,043 [INFO]: 	avg_search_speed_ms: 10.556194687866013
2025-03-09 06:50:32,043 [INFO]: 	99p_search_speed_ms: 17.00484133325517
2025-03-09 06:50:32,043 [INFO]: 	reconstruction error %: 0.0
2025-03-09 06:50:32,043 [INFO]: 	nb vectors: 3460
2025-03-09 06:50:32,043 [INFO]: 	vectors dimension: 49152
2025-03-09 06:50:32,043 [INFO]: 	compression ratio: 0.9993094069856588
2025-03-09 06:50:32,043 [INFO]: }
2025-03-09 06:50:32,043 [INFO]: 	>>> Finished "Creating the index" in 54.0900 secs
2025-03-09 06:50:32,043 [INFO]: >>> Finished "Launching the whole pipeline" in 54.1210 secs
2025-03-09 06:50:33: [retrieval_preprocessing] calculating distances ...
2025-03-09 06:50:33: [retrieval_preprocessing] finished and saved retrieval indices for episode 76810 [episode count 2/20]
[retrieval_preprocessing] for episode 70924 [episode count 3/20], we have num_retrieval=np.int64(3453) num_query=np.int64(182)
2025-03-09 06:50:35,260 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-09 06:50:35,883 [INFO]: Launching the whole pipeline 03/09/2025, 06:50:35
2025-03-09 06:50:35,883 [INFO]: Reading total number of vectors and dimension 03/09/2025, 06:50:35
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1931.97it/s]
2025-03-09 06:50:35,928 [INFO]: There are 3453 embeddings of dim 49152
2025-03-09 06:50:35,928 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0456 secs
2025-03-09 06:50:35,929 [INFO]: 	Compute estimated construction time of the index 03/09/2025, 06:50:35
2025-03-09 06:50:35,929 [INFO]: 		-> Train: 16.7 minutes
2025-03-09 06:50:35,929 [INFO]: 		-> Add: 1.9 seconds
2025-03-09 06:50:35,929 [INFO]: 		Total: 16.7 minutes
2025-03-09 06:50:35,929 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0003 secs
2025-03-09 06:50:35,929 [INFO]: 	Checking that your have enough memory available to create the index 03/09/2025, 06:50:35
2025-03-09 06:50:35,930 [INFO]: 712.6MB of memory will be needed to build the index (more might be used if you have more)
2025-03-09 06:50:35,930 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0005 secs
2025-03-09 06:50:35,930 [INFO]: 	Selecting most promising index types given data characteristics 03/09/2025, 06:50:35
2025-03-09 06:50:35,930 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-09 06:50:35,930 [INFO]: 	Creating the index 03/09/2025, 06:50:35
2025-03-09 06:50:35,931 [INFO]: 		-> Instanciate the index HNSW15 03/09/2025, 06:50:35
2025-03-09 06:50:35,934 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0027 secs
2025-03-09 06:50:35,934 [INFO]: 		-> Adding the vectors to the index 03/09/2025, 06:50:35
2025-03-09 06:50:35,934 [INFO]: The memory available for adding the vectors is 49.4GB(total available - used by the index)
2025-03-09 06:50:35,934 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/14 [00:00<?, ?it/s]  7%|▋         | 1/14 [00:00<00:02,  4.56it/s] 21%|██▏       | 3/14 [00:00<00:01,  7.38it/s] 29%|██▊       | 4/14 [00:00<00:01,  7.87it/s] 43%|████▎     | 6/14 [00:00<00:00,  8.91it/s] 57%|█████▋    | 8/14 [00:00<00:00,  9.60it/s] 71%|███████▏  | 10/14 [00:01<00:00,  9.87it/s] 86%|████████▌ | 12/14 [00:01<00:00,  9.99it/s] 93%|█████████▎| 13/14 [00:01<00:00,  9.74it/s]100%|██████████| 14/14 [00:04<00:00,  1.51it/s]100%|██████████| 14/14 [00:04<00:00,  3.45it/s]
2025-03-09 06:50:39,999 [INFO]: 	Computing best hyperparameters for index knn.index 03/09/2025, 06:50:39
2025-03-09 06:51:19,964 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 39.9645 secs
2025-03-09 06:51:19,964 [INFO]: The best hyperparameters are: efSearch=214
2025-03-09 06:51:19,964 [INFO]: 	Compute fast metrics 03/09/2025, 06:51:19
  0%|          | 0/4 [00:00<?, ?it/s] 25%|██▌       | 1/4 [00:00<00:00,  5.58it/s] 50%|█████     | 2/4 [00:00<00:00,  7.05it/s] 75%|███████▌  | 3/4 [00:00<00:00,  7.52it/s] 75%|███████▌  | 3/4 [00:00<00:00,  6.07it/s]
2025-03-09 06:51:33,185 [INFO]: 	>>> Finished "Compute fast metrics" in 13.2201 secs
2025-03-09 06:51:33,187 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 57.2535 secs
2025-03-09 06:51:33,188 [INFO]: {
2025-03-09 06:51:33,188 [INFO]: 	index_key: HNSW15
2025-03-09 06:51:33,188 [INFO]: 	index_param: efSearch=214
2025-03-09 06:51:33,188 [INFO]: 	index_path: knn.index
2025-03-09 06:51:33,188 [INFO]: 	size in bytes: 679356610
2025-03-09 06:51:33,188 [INFO]: 	avg_search_speed_ms: 9.426078192966935
2025-03-09 06:51:33,188 [INFO]: 	99p_search_speed_ms: 18.09022147208454
2025-03-09 06:51:33,188 [INFO]: 	reconstruction error %: 0.0
2025-03-09 06:51:33,188 [INFO]: 	nb vectors: 3453
2025-03-09 06:51:33,188 [INFO]: 	vectors dimension: 49152
2025-03-09 06:51:33,188 [INFO]: 	compression ratio: 0.9993093671378277
2025-03-09 06:51:33,188 [INFO]: }
2025-03-09 06:51:33,188 [INFO]: 	>>> Finished "Creating the index" in 57.2577 secs
2025-03-09 06:51:33,188 [INFO]: >>> Finished "Launching the whole pipeline" in 57.3055 secs
2025-03-09 06:51:34: [retrieval_preprocessing] calculating distances ...
2025-03-09 06:51:34: [retrieval_preprocessing] finished and saved retrieval indices for episode 70924 [episode count 3/20]
[retrieval_preprocessing] for episode 49809 [episode count 4/20], we have num_retrieval=np.int64(3506) num_query=np.int64(129)
2025-03-09 06:51:35,726 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-09 06:51:36,251 [INFO]: Launching the whole pipeline 03/09/2025, 06:51:36
2025-03-09 06:51:36,251 [INFO]: Reading total number of vectors and dimension 03/09/2025, 06:51:36
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 940.22it/s]
2025-03-09 06:51:36,282 [INFO]: There are 3506 embeddings of dim 49152
2025-03-09 06:51:36,282 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0311 secs
2025-03-09 06:51:36,283 [INFO]: 	Compute estimated construction time of the index 03/09/2025, 06:51:36
2025-03-09 06:51:36,283 [INFO]: 		-> Train: 16.7 minutes
2025-03-09 06:51:36,283 [INFO]: 		-> Add: 1.9 seconds
2025-03-09 06:51:36,283 [INFO]: 		Total: 16.7 minutes
2025-03-09 06:51:36,283 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0001 secs
2025-03-09 06:51:36,283 [INFO]: 	Checking that your have enough memory available to create the index 03/09/2025, 06:51:36
2025-03-09 06:51:36,283 [INFO]: 723.6MB of memory will be needed to build the index (more might be used if you have more)
2025-03-09 06:51:36,283 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0003 secs
2025-03-09 06:51:36,283 [INFO]: 	Selecting most promising index types given data characteristics 03/09/2025, 06:51:36
2025-03-09 06:51:36,283 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-09 06:51:36,283 [INFO]: 	Creating the index 03/09/2025, 06:51:36
2025-03-09 06:51:36,283 [INFO]: 		-> Instanciate the index HNSW15 03/09/2025, 06:51:36
2025-03-09 06:51:36,284 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0010 secs
2025-03-09 06:51:36,284 [INFO]: 		-> Adding the vectors to the index 03/09/2025, 06:51:36
2025-03-09 06:51:36,284 [INFO]: The memory available for adding the vectors is 49.4GB(total available - used by the index)
2025-03-09 06:51:36,284 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/14 [00:00<?, ?it/s]  7%|▋         | 1/14 [00:00<00:03,  3.80it/s] 21%|██▏       | 3/14 [00:00<00:01,  7.82it/s] 36%|███▌      | 5/14 [00:00<00:00,  9.56it/s] 50%|█████     | 7/14 [00:00<00:00, 10.62it/s] 64%|██████▍   | 9/14 [00:00<00:00, 11.15it/s] 79%|███████▊  | 11/14 [00:01<00:00, 11.50it/s] 93%|█████████▎| 13/14 [00:01<00:00, 11.80it/s]100%|██████████| 14/14 [00:03<00:00,  3.75it/s]
2025-03-09 06:51:40,030 [INFO]: 	Computing best hyperparameters for index knn.index 03/09/2025, 06:51:40
2025-03-09 06:52:23,396 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 43.3661 secs
2025-03-09 06:52:23,397 [INFO]: The best hyperparameters are: efSearch=178
2025-03-09 06:52:23,397 [INFO]: 	Compute fast metrics 03/09/2025, 06:52:23
  0%|          | 0/4 [00:00<?, ?it/s] 25%|██▌       | 1/4 [00:00<00:00,  4.42it/s] 50%|█████     | 2/4 [00:00<00:00,  5.80it/s] 75%|███████▌  | 3/4 [00:00<00:00,  6.31it/s]
2025-03-09 06:52:36,799 [INFO]: 	>>> Finished "Compute fast metrics" in 13.4020 secs
2025-03-09 06:52:36,802 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 60.5181 secs
2025-03-09 06:52:36,803 [INFO]: {
2025-03-09 06:52:36,803 [INFO]: 	index_key: HNSW15
2025-03-09 06:52:36,803 [INFO]: 	index_param: efSearch=178
2025-03-09 06:52:36,803 [INFO]: 	index_path: knn.index
2025-03-09 06:52:36,803 [INFO]: 	size in bytes: 689783950
2025-03-09 06:52:36,803 [INFO]: 	avg_search_speed_ms: 8.000751849263906
2025-03-09 06:52:36,803 [INFO]: 	99p_search_speed_ms: 15.973073695786296
2025-03-09 06:52:36,803 [INFO]: 	reconstruction error %: 0.0
2025-03-09 06:52:36,803 [INFO]: 	nb vectors: 3506
2025-03-09 06:52:36,803 [INFO]: 	vectors dimension: 49152
2025-03-09 06:52:36,803 [INFO]: 	compression ratio: 0.9993094910370124
2025-03-09 06:52:36,803 [INFO]: }
2025-03-09 06:52:36,803 [INFO]: 	>>> Finished "Creating the index" in 60.5196 secs
2025-03-09 06:52:36,803 [INFO]: >>> Finished "Launching the whole pipeline" in 60.5514 secs
2025-03-09 06:52:37: [retrieval_preprocessing] calculating distances ...
2025-03-09 06:52:38: [retrieval_preprocessing] finished and saved retrieval indices for episode 49809 [episode count 4/20]
[retrieval_preprocessing] for episode 65041 [episode count 5/20], we have num_retrieval=np.int64(3433) num_query=np.int64(202)
2025-03-09 06:52:39,834 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-09 06:52:40,421 [INFO]: Launching the whole pipeline 03/09/2025, 06:52:40
2025-03-09 06:52:40,421 [INFO]: Reading total number of vectors and dimension 03/09/2025, 06:52:40
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1437.39it/s]
2025-03-09 06:52:40,450 [INFO]: There are 3433 embeddings of dim 49152
2025-03-09 06:52:40,451 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0299 secs
2025-03-09 06:52:40,451 [INFO]: 	Compute estimated construction time of the index 03/09/2025, 06:52:40
2025-03-09 06:52:40,451 [INFO]: 		-> Train: 16.7 minutes
2025-03-09 06:52:40,451 [INFO]: 		-> Add: 1.9 seconds
2025-03-09 06:52:40,451 [INFO]: 		Total: 16.7 minutes
2025-03-09 06:52:40,451 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0003 secs
2025-03-09 06:52:40,451 [INFO]: 	Checking that your have enough memory available to create the index 03/09/2025, 06:52:40
2025-03-09 06:52:40,452 [INFO]: 708.5MB of memory will be needed to build the index (more might be used if you have more)
2025-03-09 06:52:40,452 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0005 secs
2025-03-09 06:52:40,452 [INFO]: 	Selecting most promising index types given data characteristics 03/09/2025, 06:52:40
2025-03-09 06:52:40,452 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-09 06:52:40,452 [INFO]: 	Creating the index 03/09/2025, 06:52:40
2025-03-09 06:52:40,453 [INFO]: 		-> Instanciate the index HNSW15 03/09/2025, 06:52:40
2025-03-09 06:52:40,455 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0027 secs
2025-03-09 06:52:40,456 [INFO]: 		-> Adding the vectors to the index 03/09/2025, 06:52:40
2025-03-09 06:52:40,456 [INFO]: The memory available for adding the vectors is 49.4GB(total available - used by the index)
2025-03-09 06:52:40,456 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/14 [00:00<?, ?it/s]  7%|▋         | 1/14 [00:00<00:02,  5.75it/s] 21%|██▏       | 3/14 [00:00<00:01,  9.02it/s] 36%|███▌      | 5/14 [00:00<00:00,  9.96it/s] 50%|█████     | 7/14 [00:00<00:00, 10.66it/s] 71%|███████▏  | 10/14 [00:00<00:00, 14.16it/s]100%|██████████| 14/14 [00:03<00:00,  3.29it/s]100%|██████████| 14/14 [00:03<00:00,  4.54it/s]
2025-03-09 06:52:43,546 [INFO]: 	Computing best hyperparameters for index knn.index 03/09/2025, 06:52:43
2025-03-09 06:53:20,593 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 37.0466 secs
2025-03-09 06:53:20,593 [INFO]: The best hyperparameters are: efSearch=218
2025-03-09 06:53:20,594 [INFO]: 	Compute fast metrics 03/09/2025, 06:53:20
  0%|          | 0/4 [00:00<?, ?it/s] 25%|██▌       | 1/4 [00:00<00:00,  4.53it/s] 50%|█████     | 2/4 [00:00<00:01,  1.93it/s] 75%|███████▌  | 3/4 [00:01<00:00,  1.91it/s] 75%|███████▌  | 3/4 [00:01<00:00,  1.92it/s]
2025-03-09 06:53:34,938 [INFO]: 	>>> Finished "Compute fast metrics" in 14.3441 secs
2025-03-09 06:53:34,941 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 54.4849 secs
2025-03-09 06:53:34,941 [INFO]: {
2025-03-09 06:53:34,941 [INFO]: 	index_key: HNSW15
2025-03-09 06:53:34,941 [INFO]: 	index_param: efSearch=218
2025-03-09 06:53:34,941 [INFO]: 	index_path: knn.index
2025-03-09 06:53:34,941 [INFO]: 	size in bytes: 675421690
2025-03-09 06:53:34,941 [INFO]: 	avg_search_speed_ms: 9.163936108605139
2025-03-09 06:53:34,941 [INFO]: 	99p_search_speed_ms: 14.558512927032996
2025-03-09 06:53:34,941 [INFO]: 	reconstruction error %: 0.0
2025-03-09 06:53:34,941 [INFO]: 	nb vectors: 3433
2025-03-09 06:53:34,941 [INFO]: 	vectors dimension: 49152
2025-03-09 06:53:34,941 [INFO]: 	compression ratio: 0.9993094299355415
2025-03-09 06:53:34,941 [INFO]: }
2025-03-09 06:53:34,941 [INFO]: 	>>> Finished "Creating the index" in 54.4884 secs
2025-03-09 06:53:34,941 [INFO]: >>> Finished "Launching the whole pipeline" in 54.5202 secs
2025-03-09 06:53:35: [retrieval_preprocessing] calculating distances ...
2025-03-09 06:53:36: [retrieval_preprocessing] finished and saved retrieval indices for episode 65041 [episode count 5/20]
[retrieval_preprocessing] for episode 67473 [episode count 6/20], we have num_retrieval=np.int64(3502) num_query=np.int64(133)
2025-03-09 06:53:37,701 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-09 06:53:38,178 [INFO]: Launching the whole pipeline 03/09/2025, 06:53:38
2025-03-09 06:53:38,178 [INFO]: Reading total number of vectors and dimension 03/09/2025, 06:53:38
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1408.43it/s]
2025-03-09 06:53:38,204 [INFO]: There are 3502 embeddings of dim 49152
2025-03-09 06:53:38,205 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0265 secs
2025-03-09 06:53:38,205 [INFO]: 	Compute estimated construction time of the index 03/09/2025, 06:53:38
2025-03-09 06:53:38,205 [INFO]: 		-> Train: 16.7 minutes
2025-03-09 06:53:38,205 [INFO]: 		-> Add: 1.9 seconds
2025-03-09 06:53:38,205 [INFO]: 		Total: 16.7 minutes
2025-03-09 06:53:38,205 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0002 secs
2025-03-09 06:53:38,205 [INFO]: 	Checking that your have enough memory available to create the index 03/09/2025, 06:53:38
2025-03-09 06:53:38,205 [INFO]: 722.7MB of memory will be needed to build the index (more might be used if you have more)
2025-03-09 06:53:38,206 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0004 secs
2025-03-09 06:53:38,206 [INFO]: 	Selecting most promising index types given data characteristics 03/09/2025, 06:53:38
2025-03-09 06:53:38,206 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-09 06:53:38,206 [INFO]: 	Creating the index 03/09/2025, 06:53:38
2025-03-09 06:53:38,206 [INFO]: 		-> Instanciate the index HNSW15 03/09/2025, 06:53:38
2025-03-09 06:53:38,209 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0020 secs
2025-03-09 06:53:38,209 [INFO]: 		-> Adding the vectors to the index 03/09/2025, 06:53:38
2025-03-09 06:53:38,209 [INFO]: The memory available for adding the vectors is 49.4GB(total available - used by the index)
2025-03-09 06:53:38,209 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/14 [00:00<?, ?it/s]  7%|▋         | 1/14 [00:00<00:02,  5.60it/s] 21%|██▏       | 3/14 [00:00<00:01,  9.12it/s] 36%|███▌      | 5/14 [00:00<00:00, 11.57it/s] 50%|█████     | 7/14 [00:00<00:00, 13.07it/s] 64%|██████▍   | 9/14 [00:00<00:00, 14.15it/s] 79%|███████▊  | 11/14 [00:00<00:00, 14.70it/s] 93%|█████████▎| 13/14 [00:01<00:00, 14.18it/s]100%|██████████| 14/14 [00:03<00:00,  4.20it/s]
2025-03-09 06:53:41,553 [INFO]: 	Computing best hyperparameters for index knn.index 03/09/2025, 06:53:41
2025-03-09 06:54:14,773 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 33.2197 secs
2025-03-09 06:54:14,774 [INFO]: The best hyperparameters are: efSearch=290
2025-03-09 06:54:14,774 [INFO]: 	Compute fast metrics 03/09/2025, 06:54:14
  0%|          | 0/4 [00:00<?, ?it/s] 25%|██▌       | 1/4 [00:00<00:00,  5.56it/s] 75%|███████▌  | 3/4 [00:00<00:00,  8.31it/s] 75%|███████▌  | 3/4 [00:00<00:00,  6.36it/s]
2025-03-09 06:54:28,304 [INFO]: 	>>> Finished "Compute fast metrics" in 13.5301 secs
2025-03-09 06:54:28,306 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 50.0976 secs
2025-03-09 06:54:28,307 [INFO]: {
2025-03-09 06:54:28,307 [INFO]: 	index_key: HNSW15
2025-03-09 06:54:28,307 [INFO]: 	index_param: efSearch=290
2025-03-09 06:54:28,307 [INFO]: 	index_path: knn.index
2025-03-09 06:54:28,307 [INFO]: 	size in bytes: 688996990
2025-03-09 06:54:28,307 [INFO]: 	avg_search_speed_ms: 11.418991451062364
2025-03-09 06:54:28,307 [INFO]: 	99p_search_speed_ms: 19.38948081806302
2025-03-09 06:54:28,307 [INFO]: 	reconstruction error %: 0.0
2025-03-09 06:54:28,307 [INFO]: 	nb vectors: 3502
2025-03-09 06:54:28,307 [INFO]: 	vectors dimension: 49152
2025-03-09 06:54:28,307 [INFO]: 	compression ratio: 0.9993094686814235
2025-03-09 06:54:28,307 [INFO]: }
2025-03-09 06:54:28,307 [INFO]: 	>>> Finished "Creating the index" in 50.1004 secs
2025-03-09 06:54:28,307 [INFO]: >>> Finished "Launching the whole pipeline" in 50.1286 secs
2025-03-09 06:54:29: [retrieval_preprocessing] calculating distances ...
2025-03-09 06:54:29: [retrieval_preprocessing] finished and saved retrieval indices for episode 67473 [episode count 6/20]
[retrieval_preprocessing] for episode 7445 [episode count 7/20], we have num_retrieval=np.int64(3489) num_query=np.int64(146)
2025-03-09 06:54:30,235 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-09 06:54:30,725 [INFO]: Launching the whole pipeline 03/09/2025, 06:54:30
2025-03-09 06:54:30,726 [INFO]: Reading total number of vectors and dimension 03/09/2025, 06:54:30
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1089.71it/s]
2025-03-09 06:54:30,754 [INFO]: There are 3489 embeddings of dim 49152
2025-03-09 06:54:30,754 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0287 secs
2025-03-09 06:54:30,755 [INFO]: 	Compute estimated construction time of the index 03/09/2025, 06:54:30
2025-03-09 06:54:30,755 [INFO]: 		-> Train: 16.7 minutes
2025-03-09 06:54:30,755 [INFO]: 		-> Add: 1.9 seconds
2025-03-09 06:54:30,755 [INFO]: 		Total: 16.7 minutes
2025-03-09 06:54:30,755 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0005 secs
2025-03-09 06:54:30,755 [INFO]: 	Checking that your have enough memory available to create the index 03/09/2025, 06:54:30
2025-03-09 06:54:30,755 [INFO]: 720.0MB of memory will be needed to build the index (more might be used if you have more)
2025-03-09 06:54:30,756 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0004 secs
2025-03-09 06:54:30,756 [INFO]: 	Selecting most promising index types given data characteristics 03/09/2025, 06:54:30
2025-03-09 06:54:30,756 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-09 06:54:30,756 [INFO]: 	Creating the index 03/09/2025, 06:54:30
2025-03-09 06:54:30,756 [INFO]: 		-> Instanciate the index HNSW15 03/09/2025, 06:54:30
2025-03-09 06:54:30,759 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0027 secs
2025-03-09 06:54:30,759 [INFO]: 		-> Adding the vectors to the index 03/09/2025, 06:54:30
2025-03-09 06:54:30,760 [INFO]: The memory available for adding the vectors is 49.4GB(total available - used by the index)
2025-03-09 06:54:30,760 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/14 [00:00<?, ?it/s]  7%|▋         | 1/14 [00:00<00:01,  6.56it/s] 21%|██▏       | 3/14 [00:00<00:00, 12.76it/s] 43%|████▎     | 6/14 [00:00<00:00, 16.51it/s] 57%|█████▋    | 8/14 [00:00<00:00, 17.23it/s] 79%|███████▊  | 11/14 [00:00<00:00, 17.14it/s] 93%|█████████▎| 13/14 [00:00<00:00, 17.56it/s]100%|██████████| 14/14 [00:03<00:00,  4.45it/s]
2025-03-09 06:54:33,916 [INFO]: 	Computing best hyperparameters for index knn.index 03/09/2025, 06:54:33
2025-03-09 06:55:05,395 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 31.4783 secs
2025-03-09 06:55:05,395 [INFO]: The best hyperparameters are: efSearch=308
2025-03-09 06:55:05,395 [INFO]: 	Compute fast metrics 03/09/2025, 06:55:05
  0%|          | 0/4 [00:00<?, ?it/s] 25%|██▌       | 1/4 [00:00<00:00,  5.20it/s] 50%|█████     | 2/4 [00:00<00:00,  6.75it/s] 75%|███████▌  | 3/4 [00:00<00:00,  7.80it/s] 75%|███████▌  | 3/4 [00:00<00:00,  5.84it/s]
2025-03-09 06:55:18,155 [INFO]: 	>>> Finished "Compute fast metrics" in 12.7603 secs
2025-03-09 06:55:18,158 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 47.3984 secs
2025-03-09 06:55:18,158 [INFO]: {
2025-03-09 06:55:18,158 [INFO]: 	index_key: HNSW15
2025-03-09 06:55:18,158 [INFO]: 	index_param: efSearch=308
2025-03-09 06:55:18,158 [INFO]: 	index_path: knn.index
2025-03-09 06:55:18,158 [INFO]: 	size in bytes: 686439310
2025-03-09 06:55:18,158 [INFO]: 	avg_search_speed_ms: 12.79993369506048
2025-03-09 06:55:18,158 [INFO]: 	99p_search_speed_ms: 21.841537391301244
2025-03-09 06:55:18,158 [INFO]: 	reconstruction error %: 0.0
2025-03-09 06:55:18,158 [INFO]: 	nb vectors: 3489
2025-03-09 06:55:18,158 [INFO]: 	vectors dimension: 49152
2025-03-09 06:55:18,158 [INFO]: 	compression ratio: 0.9993094830189722
2025-03-09 06:55:18,158 [INFO]: }
2025-03-09 06:55:18,158 [INFO]: 	>>> Finished "Creating the index" in 47.4020 secs
2025-03-09 06:55:18,158 [INFO]: >>> Finished "Launching the whole pipeline" in 47.4325 secs
2025-03-09 06:55:19: [retrieval_preprocessing] calculating distances ...
2025-03-09 06:55:20: [retrieval_preprocessing] finished and saved retrieval indices for episode 7445 [episode count 7/20]
[retrieval_preprocessing] for episode 24213 [episode count 8/20], we have num_retrieval=np.int64(3455) num_query=np.int64(180)
2025-03-09 06:55:21,015 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-09 06:55:21,474 [INFO]: Launching the whole pipeline 03/09/2025, 06:55:21
2025-03-09 06:55:21,474 [INFO]: Reading total number of vectors and dimension 03/09/2025, 06:55:21
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1305.42it/s]
2025-03-09 06:55:21,506 [INFO]: There are 3455 embeddings of dim 49152
2025-03-09 06:55:21,506 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0318 secs
2025-03-09 06:55:21,506 [INFO]: 	Compute estimated construction time of the index 03/09/2025, 06:55:21
2025-03-09 06:55:21,507 [INFO]: 		-> Train: 16.7 minutes
2025-03-09 06:55:21,507 [INFO]: 		-> Add: 1.9 seconds
2025-03-09 06:55:21,507 [INFO]: 		Total: 16.7 minutes
2025-03-09 06:55:21,507 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0005 secs
2025-03-09 06:55:21,507 [INFO]: 	Checking that your have enough memory available to create the index 03/09/2025, 06:55:21
2025-03-09 06:55:21,507 [INFO]: 713.0MB of memory will be needed to build the index (more might be used if you have more)
2025-03-09 06:55:21,508 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0004 secs
2025-03-09 06:55:21,508 [INFO]: 	Selecting most promising index types given data characteristics 03/09/2025, 06:55:21
2025-03-09 06:55:21,508 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-09 06:55:21,508 [INFO]: 	Creating the index 03/09/2025, 06:55:21
2025-03-09 06:55:21,508 [INFO]: 		-> Instanciate the index HNSW15 03/09/2025, 06:55:21
2025-03-09 06:55:21,511 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0030 secs
2025-03-09 06:55:21,512 [INFO]: 		-> Adding the vectors to the index 03/09/2025, 06:55:21
2025-03-09 06:55:21,512 [INFO]: The memory available for adding the vectors is 49.4GB(total available - used by the index)
2025-03-09 06:55:21,512 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/14 [00:00<?, ?it/s]  7%|▋         | 1/14 [00:00<00:02,  5.81it/s] 21%|██▏       | 3/14 [00:00<00:01, 10.06it/s] 36%|███▌      | 5/14 [00:00<00:00, 11.48it/s] 50%|█████     | 7/14 [00:00<00:00, 11.76it/s] 64%|██████▍   | 9/14 [00:00<00:00, 11.37it/s] 79%|███████▊  | 11/14 [00:01<00:00, 11.25it/s] 93%|█████████▎| 13/14 [00:01<00:00, 11.03it/s]100%|██████████| 14/14 [00:03<00:00,  3.83it/s]
2025-03-09 06:55:25,176 [INFO]: 	Computing best hyperparameters for index knn.index 03/09/2025, 06:55:25
2025-03-09 06:55:58,008 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 32.8318 secs
2025-03-09 06:55:58,008 [INFO]: The best hyperparameters are: efSearch=284
2025-03-09 06:55:58,008 [INFO]: 	Compute fast metrics 03/09/2025, 06:55:58
  0%|          | 0/4 [00:00<?, ?it/s] 25%|██▌       | 1/4 [00:00<00:00,  7.06it/s] 75%|███████▌  | 3/4 [00:00<00:00, 10.41it/s] 75%|███████▌  | 3/4 [00:00<00:00,  7.90it/s]
2025-03-09 06:56:11,383 [INFO]: 	>>> Finished "Compute fast metrics" in 13.3748 secs
2025-03-09 06:56:11,385 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 49.8736 secs
2025-03-09 06:56:11,386 [INFO]: {
2025-03-09 06:56:11,386 [INFO]: 	index_key: HNSW15
2025-03-09 06:56:11,386 [INFO]: 	index_param: efSearch=284
2025-03-09 06:56:11,386 [INFO]: 	index_path: knn.index
2025-03-09 06:56:11,386 [INFO]: 	size in bytes: 679750090
2025-03-09 06:56:11,386 [INFO]: 	avg_search_speed_ms: 11.651930536006715
2025-03-09 06:56:11,386 [INFO]: 	99p_search_speed_ms: 19.146786038763818
2025-03-09 06:56:11,386 [INFO]: 	reconstruction error %: 0.0
2025-03-09 06:56:11,386 [INFO]: 	nb vectors: 3455
2025-03-09 06:56:11,386 [INFO]: 	vectors dimension: 49152
2025-03-09 06:56:11,386 [INFO]: 	compression ratio: 0.9993093785393982
2025-03-09 06:56:11,386 [INFO]: }
2025-03-09 06:56:11,386 [INFO]: 	>>> Finished "Creating the index" in 49.8778 secs
2025-03-09 06:56:11,386 [INFO]: >>> Finished "Launching the whole pipeline" in 49.9115 secs
2025-03-09 06:56:12: [retrieval_preprocessing] calculating distances ...
2025-03-09 06:56:13: [retrieval_preprocessing] finished and saved retrieval indices for episode 24213 [episode count 8/20]
[retrieval_preprocessing] for episode 86933 [episode count 9/20], we have num_retrieval=np.int64(3435) num_query=np.int64(200)
2025-03-09 06:56:14,212 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-09 06:56:14,743 [INFO]: Launching the whole pipeline 03/09/2025, 06:56:14
2025-03-09 06:56:14,743 [INFO]: Reading total number of vectors and dimension 03/09/2025, 06:56:14
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1988.76it/s]
2025-03-09 06:56:14,767 [INFO]: There are 3435 embeddings of dim 49152
2025-03-09 06:56:14,768 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0245 secs
2025-03-09 06:56:14,768 [INFO]: 	Compute estimated construction time of the index 03/09/2025, 06:56:14
2025-03-09 06:56:14,768 [INFO]: 		-> Train: 16.7 minutes
2025-03-09 06:56:14,768 [INFO]: 		-> Add: 1.9 seconds
2025-03-09 06:56:14,768 [INFO]: 		Total: 16.7 minutes
2025-03-09 06:56:14,768 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0001 secs
2025-03-09 06:56:14,768 [INFO]: 	Checking that your have enough memory available to create the index 03/09/2025, 06:56:14
2025-03-09 06:56:14,768 [INFO]: 708.9MB of memory will be needed to build the index (more might be used if you have more)
2025-03-09 06:56:14,768 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0001 secs
2025-03-09 06:56:14,768 [INFO]: 	Selecting most promising index types given data characteristics 03/09/2025, 06:56:14
2025-03-09 06:56:14,768 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-09 06:56:14,768 [INFO]: 	Creating the index 03/09/2025, 06:56:14
2025-03-09 06:56:14,768 [INFO]: 		-> Instanciate the index HNSW15 03/09/2025, 06:56:14
2025-03-09 06:56:14,769 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0009 secs
2025-03-09 06:56:14,769 [INFO]: 		-> Adding the vectors to the index 03/09/2025, 06:56:14
2025-03-09 06:56:14,769 [INFO]: The memory available for adding the vectors is 49.4GB(total available - used by the index)
2025-03-09 06:56:14,769 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/14 [00:00<?, ?it/s]  7%|▋         | 1/14 [00:00<00:02,  6.47it/s] 21%|██▏       | 3/14 [00:00<00:00, 11.57it/s] 36%|███▌      | 5/14 [00:00<00:00, 13.64it/s] 50%|█████     | 7/14 [00:00<00:00, 14.18it/s] 64%|██████▍   | 9/14 [00:00<00:00, 13.87it/s] 79%|███████▊  | 11/14 [00:00<00:00, 13.74it/s] 93%|█████████▎| 13/14 [00:00<00:00, 13.75it/s]100%|██████████| 14/14 [00:03<00:00,  4.06it/s]
2025-03-09 06:56:18,217 [INFO]: 	Computing best hyperparameters for index knn.index 03/09/2025, 06:56:18
2025-03-09 06:56:51,339 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 33.1214 secs
2025-03-09 06:56:51,339 [INFO]: The best hyperparameters are: efSearch=249
2025-03-09 06:56:51,339 [INFO]: 	Compute fast metrics 03/09/2025, 06:56:51
  0%|          | 0/4 [00:00<?, ?it/s] 25%|██▌       | 1/4 [00:00<00:00,  5.70it/s] 75%|███████▌  | 3/4 [00:00<00:00,  9.36it/s] 75%|███████▌  | 3/4 [00:00<00:00,  7.14it/s]
2025-03-09 06:57:04,234 [INFO]: 	>>> Finished "Compute fast metrics" in 12.8950 secs
2025-03-09 06:57:04,237 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 49.4678 secs
2025-03-09 06:57:04,237 [INFO]: {
2025-03-09 06:57:04,237 [INFO]: 	index_key: HNSW15
2025-03-09 06:57:04,237 [INFO]: 	index_param: efSearch=249
2025-03-09 06:57:04,237 [INFO]: 	index_path: knn.index
2025-03-09 06:57:04,237 [INFO]: 	size in bytes: 675815170
2025-03-09 06:57:04,237 [INFO]: 	avg_search_speed_ms: 10.730059218618923
2025-03-09 06:57:04,237 [INFO]: 	99p_search_speed_ms: 18.11368914786726
2025-03-09 06:57:04,237 [INFO]: 	reconstruction error %: 0.0
2025-03-09 06:57:04,237 [INFO]: 	nb vectors: 3435
2025-03-09 06:57:04,237 [INFO]: 	vectors dimension: 49152
2025-03-09 06:57:04,237 [INFO]: 	compression ratio: 0.9993094413669347
2025-03-09 06:57:04,237 [INFO]: }
2025-03-09 06:57:04,237 [INFO]: 	>>> Finished "Creating the index" in 49.4691 secs
2025-03-09 06:57:04,237 [INFO]: >>> Finished "Launching the whole pipeline" in 49.4942 secs
2025-03-09 06:57:05: [retrieval_preprocessing] calculating distances ...
2025-03-09 06:57:06: [retrieval_preprocessing] finished and saved retrieval indices for episode 86933 [episode count 9/20]
[retrieval_preprocessing] for episode 12312 [episode count 10/20], we have num_retrieval=np.int64(3430) num_query=np.int64(205)
2025-03-09 06:57:07,533 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-09 06:57:07,974 [INFO]: Launching the whole pipeline 03/09/2025, 06:57:07
2025-03-09 06:57:07,974 [INFO]: Reading total number of vectors and dimension 03/09/2025, 06:57:07
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 2245.34it/s]
2025-03-09 06:57:08,001 [INFO]: There are 3430 embeddings of dim 49152
2025-03-09 06:57:08,001 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0274 secs
2025-03-09 06:57:08,001 [INFO]: 	Compute estimated construction time of the index 03/09/2025, 06:57:08
2025-03-09 06:57:08,001 [INFO]: 		-> Train: 16.7 minutes
2025-03-09 06:57:08,001 [INFO]: 		-> Add: 1.9 seconds
2025-03-09 06:57:08,001 [INFO]: 		Total: 16.7 minutes
2025-03-09 06:57:08,001 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0001 secs
2025-03-09 06:57:08,001 [INFO]: 	Checking that your have enough memory available to create the index 03/09/2025, 06:57:08
2025-03-09 06:57:08,002 [INFO]: 707.9MB of memory will be needed to build the index (more might be used if you have more)
2025-03-09 06:57:08,002 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0001 secs
2025-03-09 06:57:08,002 [INFO]: 	Selecting most promising index types given data characteristics 03/09/2025, 06:57:08
2025-03-09 06:57:08,002 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-09 06:57:08,002 [INFO]: 	Creating the index 03/09/2025, 06:57:08
2025-03-09 06:57:08,002 [INFO]: 		-> Instanciate the index HNSW15 03/09/2025, 06:57:08
2025-03-09 06:57:08,003 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0009 secs
2025-03-09 06:57:08,003 [INFO]: 		-> Adding the vectors to the index 03/09/2025, 06:57:08
2025-03-09 06:57:08,003 [INFO]: The memory available for adding the vectors is 49.4GB(total available - used by the index)
2025-03-09 06:57:08,003 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/14 [00:00<?, ?it/s]  7%|▋         | 1/14 [00:00<00:02,  5.56it/s] 21%|██▏       | 3/14 [00:00<00:01,  9.90it/s] 36%|███▌      | 5/14 [00:00<00:00,  9.60it/s] 43%|████▎     | 6/14 [00:00<00:00,  9.48it/s] 50%|█████     | 7/14 [00:00<00:00,  8.97it/s] 64%|██████▍   | 9/14 [00:00<00:00, 10.82it/s] 79%|███████▊  | 11/14 [00:01<00:00, 10.66it/s] 93%|█████████▎| 13/14 [00:01<00:00,  9.91it/s]100%|██████████| 14/14 [00:03<00:00,  3.59it/s]
2025-03-09 06:57:11,902 [INFO]: 	Computing best hyperparameters for index knn.index 03/09/2025, 06:57:11
2025-03-09 06:57:43,233 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 31.3301 secs
2025-03-09 06:57:43,233 [INFO]: The best hyperparameters are: efSearch=249
2025-03-09 06:57:43,233 [INFO]: 	Compute fast metrics 03/09/2025, 06:57:43
  0%|          | 0/4 [00:00<?, ?it/s] 25%|██▌       | 1/4 [00:00<00:00,  5.56it/s] 50%|█████     | 2/4 [00:00<00:00,  7.12it/s] 75%|███████▌  | 3/4 [00:00<00:00,  7.68it/s] 75%|███████▌  | 3/4 [00:00<00:00,  5.76it/s]
2025-03-09 06:57:57,033 [INFO]: 	>>> Finished "Compute fast metrics" in 13.8002 secs
2025-03-09 06:57:57,035 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 49.0328 secs
2025-03-09 06:57:57,036 [INFO]: {
2025-03-09 06:57:57,036 [INFO]: 	index_key: HNSW15
2025-03-09 06:57:57,036 [INFO]: 	index_param: efSearch=249
2025-03-09 06:57:57,036 [INFO]: 	index_path: knn.index
2025-03-09 06:57:57,036 [INFO]: 	size in bytes: 674831470
2025-03-09 06:57:57,036 [INFO]: 	avg_search_speed_ms: 10.267963294930436
2025-03-09 06:57:57,036 [INFO]: 	99p_search_speed_ms: 12.926632552407678
2025-03-09 06:57:57,036 [INFO]: 	reconstruction error %: 0.0
2025-03-09 06:57:57,036 [INFO]: 	nb vectors: 3430
2025-03-09 06:57:57,036 [INFO]: 	vectors dimension: 49152
2025-03-09 06:57:57,036 [INFO]: 	compression ratio: 0.9993094127634563
2025-03-09 06:57:57,036 [INFO]: }
2025-03-09 06:57:57,036 [INFO]: 	>>> Finished "Creating the index" in 49.0341 secs
2025-03-09 06:57:57,036 [INFO]: >>> Finished "Launching the whole pipeline" in 49.0620 secs
2025-03-09 06:57:58: [retrieval_preprocessing] calculating distances ...
2025-03-09 06:57:59: [retrieval_preprocessing] finished and saved retrieval indices for episode 12312 [episode count 10/20]
[retrieval_preprocessing] for episode 44312 [episode count 11/20], we have num_retrieval=np.int64(3493) num_query=np.int64(142)
2025-03-09 06:58:00,907 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-09 06:58:01,596 [INFO]: Launching the whole pipeline 03/09/2025, 06:58:01
2025-03-09 06:58:01,597 [INFO]: Reading total number of vectors and dimension 03/09/2025, 06:58:01
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1698.10it/s]
2025-03-09 06:58:01,625 [INFO]: There are 3493 embeddings of dim 49152
2025-03-09 06:58:01,626 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0292 secs
2025-03-09 06:58:01,626 [INFO]: 	Compute estimated construction time of the index 03/09/2025, 06:58:01
2025-03-09 06:58:01,626 [INFO]: 		-> Train: 16.7 minutes
2025-03-09 06:58:01,626 [INFO]: 		-> Add: 1.9 seconds
2025-03-09 06:58:01,626 [INFO]: 		Total: 16.7 minutes
2025-03-09 06:58:01,626 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0004 secs
2025-03-09 06:58:01,626 [INFO]: 	Checking that your have enough memory available to create the index 03/09/2025, 06:58:01
2025-03-09 06:58:01,627 [INFO]: 720.9MB of memory will be needed to build the index (more might be used if you have more)
2025-03-09 06:58:01,627 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0004 secs
2025-03-09 06:58:01,627 [INFO]: 	Selecting most promising index types given data characteristics 03/09/2025, 06:58:01
2025-03-09 06:58:01,627 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-09 06:58:01,627 [INFO]: 	Creating the index 03/09/2025, 06:58:01
2025-03-09 06:58:01,628 [INFO]: 		-> Instanciate the index HNSW15 03/09/2025, 06:58:01
2025-03-09 06:58:01,630 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0028 secs
2025-03-09 06:58:01,631 [INFO]: 		-> Adding the vectors to the index 03/09/2025, 06:58:01
2025-03-09 06:58:01,631 [INFO]: The memory available for adding the vectors is 49.4GB(total available - used by the index)
2025-03-09 06:58:01,631 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/14 [00:00<?, ?it/s]  7%|▋         | 1/14 [00:00<00:02,  5.72it/s] 14%|█▍        | 2/14 [00:00<00:01,  7.60it/s] 29%|██▊       | 4/14 [00:00<00:00, 11.51it/s] 43%|████▎     | 6/14 [00:00<00:00, 11.42it/s] 57%|█████▋    | 8/14 [00:00<00:00, 11.48it/s] 71%|███████▏  | 10/14 [00:00<00:00, 11.66it/s] 86%|████████▌ | 12/14 [00:01<00:00, 11.71it/s]100%|██████████| 14/14 [00:03<00:00,  2.21it/s]100%|██████████| 14/14 [00:03<00:00,  4.01it/s]
2025-03-09 06:58:05,136 [INFO]: 	Computing best hyperparameters for index knn.index 03/09/2025, 06:58:05
2025-03-09 06:58:39,678 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 34.5414 secs
2025-03-09 06:58:39,678 [INFO]: The best hyperparameters are: efSearch=268
2025-03-09 06:58:39,678 [INFO]: 	Compute fast metrics 03/09/2025, 06:58:39
  0%|          | 0/4 [00:00<?, ?it/s] 25%|██▌       | 1/4 [00:00<00:00,  5.99it/s] 50%|█████     | 2/4 [00:00<00:00,  7.82it/s] 75%|███████▌  | 3/4 [00:00<00:00,  8.63it/s] 75%|███████▌  | 3/4 [00:00<00:00,  6.48it/s]
2025-03-09 06:58:52,508 [INFO]: 	>>> Finished "Compute fast metrics" in 12.8305 secs
2025-03-09 06:58:52,512 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 50.8811 secs
2025-03-09 06:58:52,512 [INFO]: {
2025-03-09 06:58:52,512 [INFO]: 	index_key: HNSW15
2025-03-09 06:58:52,512 [INFO]: 	index_param: efSearch=268
2025-03-09 06:58:52,512 [INFO]: 	index_path: knn.index
2025-03-09 06:58:52,512 [INFO]: 	size in bytes: 687226270
2025-03-09 06:58:52,512 [INFO]: 	avg_search_speed_ms: 10.330316288808499
2025-03-09 06:58:52,512 [INFO]: 	99p_search_speed_ms: 13.000538758933544
2025-03-09 06:58:52,512 [INFO]: 	reconstruction error %: 0.0
2025-03-09 06:58:52,512 [INFO]: 	nb vectors: 3493
2025-03-09 06:58:52,512 [INFO]: 	vectors dimension: 49152
2025-03-09 06:58:52,512 [INFO]: 	compression ratio: 0.9993095054413447
2025-03-09 06:58:52,512 [INFO]: }
2025-03-09 06:58:52,512 [INFO]: 	>>> Finished "Creating the index" in 50.8846 secs
2025-03-09 06:58:52,512 [INFO]: >>> Finished "Launching the whole pipeline" in 50.9156 secs
2025-03-09 06:58:53: [retrieval_preprocessing] calculating distances ...
2025-03-09 06:58:54: [retrieval_preprocessing] finished and saved retrieval indices for episode 44312 [episode count 11/20]
[retrieval_preprocessing] for episode 1052 [episode count 12/20], we have num_retrieval=np.int64(3444) num_query=np.int64(191)
2025-03-09 06:58:55,052 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-09 06:58:55,521 [INFO]: Launching the whole pipeline 03/09/2025, 06:58:55
2025-03-09 06:58:55,521 [INFO]: Reading total number of vectors and dimension 03/09/2025, 06:58:55
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1851.79it/s]
2025-03-09 06:58:55,548 [INFO]: There are 3444 embeddings of dim 49152
2025-03-09 06:58:55,549 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0279 secs
2025-03-09 06:58:55,549 [INFO]: 	Compute estimated construction time of the index 03/09/2025, 06:58:55
2025-03-09 06:58:55,549 [INFO]: 		-> Train: 16.7 minutes
2025-03-09 06:58:55,549 [INFO]: 		-> Add: 1.9 seconds
2025-03-09 06:58:55,549 [INFO]: 		Total: 16.7 minutes
2025-03-09 06:58:55,549 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0001 secs
2025-03-09 06:58:55,549 [INFO]: 	Checking that your have enough memory available to create the index 03/09/2025, 06:58:55
2025-03-09 06:58:55,549 [INFO]: 710.8MB of memory will be needed to build the index (more might be used if you have more)
2025-03-09 06:58:55,549 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0001 secs
2025-03-09 06:58:55,549 [INFO]: 	Selecting most promising index types given data characteristics 03/09/2025, 06:58:55
2025-03-09 06:58:55,549 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-09 06:58:55,549 [INFO]: 	Creating the index 03/09/2025, 06:58:55
2025-03-09 06:58:55,549 [INFO]: 		-> Instanciate the index HNSW15 03/09/2025, 06:58:55
2025-03-09 06:58:55,550 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0009 secs
2025-03-09 06:58:55,550 [INFO]: 		-> Adding the vectors to the index 03/09/2025, 06:58:55
2025-03-09 06:58:55,550 [INFO]: The memory available for adding the vectors is 49.4GB(total available - used by the index)
2025-03-09 06:58:55,550 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/14 [00:00<?, ?it/s]  7%|▋         | 1/14 [00:00<00:03,  3.76it/s] 21%|██▏       | 3/14 [00:00<00:01,  8.54it/s] 36%|███▌      | 5/14 [00:00<00:00, 10.80it/s] 50%|█████     | 7/14 [00:00<00:00, 11.93it/s] 64%|██████▍   | 9/14 [00:00<00:00, 12.17it/s] 79%|███████▊  | 11/14 [00:01<00:00, 11.39it/s] 93%|█████████▎| 13/14 [00:01<00:00, 11.93it/s]100%|██████████| 14/14 [00:03<00:00,  4.02it/s]
2025-03-09 06:58:59,035 [INFO]: 	Computing best hyperparameters for index knn.index 03/09/2025, 06:58:59
2025-03-09 06:59:35,300 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 36.2648 secs
2025-03-09 06:59:35,301 [INFO]: The best hyperparameters are: efSearch=262
2025-03-09 06:59:35,301 [INFO]: 	Compute fast metrics 03/09/2025, 06:59:35
  0%|          | 0/4 [00:00<?, ?it/s] 25%|██▌       | 1/4 [00:00<00:00,  5.13it/s] 50%|█████     | 2/4 [00:00<00:00,  6.82it/s] 75%|███████▌  | 3/4 [00:00<00:00,  7.40it/s] 75%|███████▌  | 3/4 [00:00<00:00,  5.46it/s]
2025-03-09 06:59:48,206 [INFO]: 	>>> Finished "Compute fast metrics" in 12.9050 secs
2025-03-09 06:59:48,208 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 52.6580 secs
2025-03-09 06:59:48,208 [INFO]: {
2025-03-09 06:59:48,208 [INFO]: 	index_key: HNSW15
2025-03-09 06:59:48,208 [INFO]: 	index_param: efSearch=262
2025-03-09 06:59:48,208 [INFO]: 	index_path: knn.index
2025-03-09 06:59:48,208 [INFO]: 	size in bytes: 677585950
2025-03-09 06:59:48,208 [INFO]: 	avg_search_speed_ms: 11.652508994514482
2025-03-09 06:59:48,208 [INFO]: 	99p_search_speed_ms: 19.37907847110174
2025-03-09 06:59:48,208 [INFO]: 	reconstruction error %: 0.0
2025-03-09 06:59:48,208 [INFO]: 	nb vectors: 3444
2025-03-09 06:59:48,208 [INFO]: 	vectors dimension: 49152
2025-03-09 06:59:48,208 [INFO]: 	compression ratio: 0.9993093156668906
2025-03-09 06:59:48,208 [INFO]: }
2025-03-09 06:59:48,208 [INFO]: 	>>> Finished "Creating the index" in 52.6594 secs
2025-03-09 06:59:48,209 [INFO]: >>> Finished "Launching the whole pipeline" in 52.6878 secs
2025-03-09 06:59:49: [retrieval_preprocessing] calculating distances ...
2025-03-09 06:59:50: [retrieval_preprocessing] finished and saved retrieval indices for episode 1052 [episode count 12/20]
[retrieval_preprocessing] for episode 64156 [episode count 13/20], we have num_retrieval=np.int64(3429) num_query=np.int64(206)
2025-03-09 06:59:51,014 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-09 06:59:51,463 [INFO]: Launching the whole pipeline 03/09/2025, 06:59:51
2025-03-09 06:59:51,463 [INFO]: Reading total number of vectors and dimension 03/09/2025, 06:59:51
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1172.90it/s]
2025-03-09 06:59:51,489 [INFO]: There are 3429 embeddings of dim 49152
2025-03-09 06:59:51,490 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0266 secs
2025-03-09 06:59:51,490 [INFO]: 	Compute estimated construction time of the index 03/09/2025, 06:59:51
2025-03-09 06:59:51,490 [INFO]: 		-> Train: 16.7 minutes
2025-03-09 06:59:51,490 [INFO]: 		-> Add: 1.9 seconds
2025-03-09 06:59:51,490 [INFO]: 		Total: 16.7 minutes
2025-03-09 06:59:51,490 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0001 secs
2025-03-09 06:59:51,490 [INFO]: 	Checking that your have enough memory available to create the index 03/09/2025, 06:59:51
2025-03-09 06:59:51,490 [INFO]: 707.7MB of memory will be needed to build the index (more might be used if you have more)
2025-03-09 06:59:51,490 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0001 secs
2025-03-09 06:59:51,490 [INFO]: 	Selecting most promising index types given data characteristics 03/09/2025, 06:59:51
2025-03-09 06:59:51,490 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-09 06:59:51,490 [INFO]: 	Creating the index 03/09/2025, 06:59:51
2025-03-09 06:59:51,490 [INFO]: 		-> Instanciate the index HNSW15 03/09/2025, 06:59:51
2025-03-09 06:59:51,491 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0009 secs
2025-03-09 06:59:51,491 [INFO]: 		-> Adding the vectors to the index 03/09/2025, 06:59:51
2025-03-09 06:59:51,491 [INFO]: The memory available for adding the vectors is 49.4GB(total available - used by the index)
2025-03-09 06:59:51,491 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/14 [00:00<?, ?it/s]  7%|▋         | 1/14 [00:00<00:01,  6.66it/s] 21%|██▏       | 3/14 [00:00<00:01, 10.59it/s] 36%|███▌      | 5/14 [00:00<00:00, 11.56it/s] 50%|█████     | 7/14 [00:00<00:00, 11.85it/s] 64%|██████▍   | 9/14 [00:00<00:00, 12.06it/s] 79%|███████▊  | 11/14 [00:00<00:00, 12.08it/s] 93%|█████████▎| 13/14 [00:01<00:00, 12.26it/s]100%|██████████| 14/14 [00:03<00:00,  3.93it/s]
2025-03-09 06:59:55,058 [INFO]: 	Computing best hyperparameters for index knn.index 03/09/2025, 06:59:55
2025-03-09 07:00:25,885 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 30.8261 secs
2025-03-09 07:00:25,885 [INFO]: The best hyperparameters are: efSearch=262
2025-03-09 07:00:25,885 [INFO]: 	Compute fast metrics 03/09/2025, 07:00:25
  0%|          | 0/4 [00:00<?, ?it/s] 25%|██▌       | 1/4 [00:00<00:00,  5.91it/s] 75%|███████▌  | 3/4 [00:00<00:00,  9.50it/s] 75%|███████▌  | 3/4 [00:00<00:00,  7.29it/s]
2025-03-09 07:00:39,792 [INFO]: 	>>> Finished "Compute fast metrics" in 13.9066 secs
2025-03-09 07:00:39,794 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 48.3028 secs
2025-03-09 07:00:39,794 [INFO]: {
2025-03-09 07:00:39,794 [INFO]: 	index_key: HNSW15
2025-03-09 07:00:39,794 [INFO]: 	index_param: efSearch=262
2025-03-09 07:00:39,794 [INFO]: 	index_path: knn.index
2025-03-09 07:00:39,794 [INFO]: 	size in bytes: 674634730
2025-03-09 07:00:39,794 [INFO]: 	avg_search_speed_ms: 10.241473854622482
2025-03-09 07:00:39,794 [INFO]: 	99p_search_speed_ms: 13.745051168370992
2025-03-09 07:00:39,794 [INFO]: 	reconstruction error %: 0.0
2025-03-09 07:00:39,794 [INFO]: 	nb vectors: 3429
2025-03-09 07:00:39,794 [INFO]: 	vectors dimension: 49152
2025-03-09 07:00:39,794 [INFO]: 	compression ratio: 0.9993094070327508
2025-03-09 07:00:39,794 [INFO]: }
2025-03-09 07:00:39,794 [INFO]: 	>>> Finished "Creating the index" in 48.3043 secs
2025-03-09 07:00:39,794 [INFO]: >>> Finished "Launching the whole pipeline" in 48.3314 secs
2025-03-09 07:00:41: [retrieval_preprocessing] calculating distances ...
2025-03-09 07:00:41: [retrieval_preprocessing] finished and saved retrieval indices for episode 64156 [episode count 13/20]
[retrieval_preprocessing] for episode 33060 [episode count 14/20], we have num_retrieval=np.int64(3431) num_query=np.int64(204)
2025-03-09 07:00:42,801 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-09 07:00:43,248 [INFO]: Launching the whole pipeline 03/09/2025, 07:00:43
2025-03-09 07:00:43,248 [INFO]: Reading total number of vectors and dimension 03/09/2025, 07:00:43
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1936.43it/s]
2025-03-09 07:00:43,271 [INFO]: There are 3431 embeddings of dim 49152
2025-03-09 07:00:43,271 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0232 secs
2025-03-09 07:00:43,271 [INFO]: 	Compute estimated construction time of the index 03/09/2025, 07:00:43
2025-03-09 07:00:43,271 [INFO]: 		-> Train: 16.7 minutes
2025-03-09 07:00:43,271 [INFO]: 		-> Add: 1.9 seconds
2025-03-09 07:00:43,271 [INFO]: 		Total: 16.7 minutes
2025-03-09 07:00:43,271 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0001 secs
2025-03-09 07:00:43,271 [INFO]: 	Checking that your have enough memory available to create the index 03/09/2025, 07:00:43
2025-03-09 07:00:43,271 [INFO]: 708.1MB of memory will be needed to build the index (more might be used if you have more)
2025-03-09 07:00:43,271 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0001 secs
2025-03-09 07:00:43,271 [INFO]: 	Selecting most promising index types given data characteristics 03/09/2025, 07:00:43
2025-03-09 07:00:43,272 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-09 07:00:43,272 [INFO]: 	Creating the index 03/09/2025, 07:00:43
2025-03-09 07:00:43,272 [INFO]: 		-> Instanciate the index HNSW15 03/09/2025, 07:00:43
2025-03-09 07:00:43,273 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0010 secs
2025-03-09 07:00:43,273 [INFO]: 		-> Adding the vectors to the index 03/09/2025, 07:00:43
2025-03-09 07:00:43,273 [INFO]: The memory available for adding the vectors is 49.4GB(total available - used by the index)
2025-03-09 07:00:43,273 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/14 [00:00<?, ?it/s]  7%|▋         | 1/14 [00:00<00:01,  6.52it/s] 21%|██▏       | 3/14 [00:00<00:00, 12.21it/s] 36%|███▌      | 5/14 [00:00<00:00, 14.27it/s] 50%|█████     | 7/14 [00:00<00:00, 14.91it/s] 64%|██████▍   | 9/14 [00:00<00:00, 13.34it/s] 79%|███████▊  | 11/14 [00:00<00:00, 12.15it/s] 93%|█████████▎| 13/14 [00:01<00:00, 12.22it/s]100%|██████████| 14/14 [00:03<00:00,  3.97it/s]
2025-03-09 07:00:46,804 [INFO]: 	Computing best hyperparameters for index knn.index 03/09/2025, 07:00:46
2025-03-09 07:01:21,342 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 34.5379 secs
2025-03-09 07:01:21,342 [INFO]: The best hyperparameters are: efSearch=273
2025-03-09 07:01:21,342 [INFO]: 	Compute fast metrics 03/09/2025, 07:01:21
  0%|          | 0/4 [00:00<?, ?it/s] 25%|██▌       | 1/4 [00:00<00:00,  6.04it/s] 75%|███████▌  | 3/4 [00:00<00:00,  9.45it/s] 75%|███████▌  | 3/4 [00:00<00:00,  7.17it/s]
2025-03-09 07:01:34,146 [INFO]: 	>>> Finished "Compute fast metrics" in 12.8036 secs
2025-03-09 07:01:34,148 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 50.8756 secs
2025-03-09 07:01:34,148 [INFO]: {
2025-03-09 07:01:34,148 [INFO]: 	index_key: HNSW15
2025-03-09 07:01:34,148 [INFO]: 	index_param: efSearch=273
2025-03-09 07:01:34,148 [INFO]: 	index_path: knn.index
2025-03-09 07:01:34,149 [INFO]: 	size in bytes: 675028210
2025-03-09 07:01:34,149 [INFO]: 	avg_search_speed_ms: 11.8738446327152
2025-03-09 07:01:34,149 [INFO]: 	99p_search_speed_ms: 16.783020461443833
2025-03-09 07:01:34,149 [INFO]: 	reconstruction error %: 0.0
2025-03-09 07:01:34,149 [INFO]: 	nb vectors: 3431
2025-03-09 07:01:34,149 [INFO]: 	vectors dimension: 49152
2025-03-09 07:01:34,149 [INFO]: 	compression ratio: 0.9993094184908213
2025-03-09 07:01:34,149 [INFO]: }
2025-03-09 07:01:34,149 [INFO]: 	>>> Finished "Creating the index" in 50.8770 secs
2025-03-09 07:01:34,149 [INFO]: >>> Finished "Launching the whole pipeline" in 50.9010 secs
2025-03-09 07:01:35: [retrieval_preprocessing] calculating distances ...
2025-03-09 07:01:36: [retrieval_preprocessing] finished and saved retrieval indices for episode 33060 [episode count 14/20]
[retrieval_preprocessing] for episode 70568 [episode count 15/20], we have num_retrieval=np.int64(3383) num_query=np.int64(252)
2025-03-09 07:01:37,208 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-09 07:01:37,668 [INFO]: Launching the whole pipeline 03/09/2025, 07:01:37
2025-03-09 07:01:37,668 [INFO]: Reading total number of vectors and dimension 03/09/2025, 07:01:37
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1817.29it/s]
2025-03-09 07:01:37,696 [INFO]: There are 3383 embeddings of dim 49152
2025-03-09 07:01:37,696 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0283 secs
2025-03-09 07:01:37,696 [INFO]: 	Compute estimated construction time of the index 03/09/2025, 07:01:37
2025-03-09 07:01:37,696 [INFO]: 		-> Train: 16.7 minutes
2025-03-09 07:01:37,697 [INFO]: 		-> Add: 1.9 seconds
2025-03-09 07:01:37,697 [INFO]: 		Total: 16.7 minutes
2025-03-09 07:01:37,697 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0004 secs
2025-03-09 07:01:37,697 [INFO]: 	Checking that your have enough memory available to create the index 03/09/2025, 07:01:37
2025-03-09 07:01:37,697 [INFO]: 698.2MB of memory will be needed to build the index (more might be used if you have more)
2025-03-09 07:01:37,697 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0004 secs
2025-03-09 07:01:37,698 [INFO]: 	Selecting most promising index types given data characteristics 03/09/2025, 07:01:37
2025-03-09 07:01:37,698 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-09 07:01:37,698 [INFO]: 	Creating the index 03/09/2025, 07:01:37
2025-03-09 07:01:37,698 [INFO]: 		-> Instanciate the index HNSW15 03/09/2025, 07:01:37
2025-03-09 07:01:37,701 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0026 secs
2025-03-09 07:01:37,701 [INFO]: 		-> Adding the vectors to the index 03/09/2025, 07:01:37
2025-03-09 07:01:37,701 [INFO]: The memory available for adding the vectors is 49.4GB(total available - used by the index)
2025-03-09 07:01:37,701 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/14 [00:00<?, ?it/s]  7%|▋         | 1/14 [00:00<00:01,  6.68it/s] 21%|██▏       | 3/14 [00:00<00:01,  9.96it/s] 36%|███▌      | 5/14 [00:00<00:00, 11.08it/s] 50%|█████     | 7/14 [00:00<00:00, 11.51it/s] 64%|██████▍   | 9/14 [00:00<00:00, 11.79it/s] 79%|███████▊  | 11/14 [00:00<00:00, 12.09it/s] 93%|█████████▎| 13/14 [00:01<00:00, 12.16it/s]100%|██████████| 14/14 [00:03<00:00,  4.16it/s]
2025-03-09 07:01:41,070 [INFO]: 	Computing best hyperparameters for index knn.index 03/09/2025, 07:01:41
2025-03-09 07:02:16,875 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 35.8050 secs
2025-03-09 07:02:16,875 [INFO]: The best hyperparameters are: efSearch=247
2025-03-09 07:02:16,875 [INFO]: 	Compute fast metrics 03/09/2025, 07:02:16
  0%|          | 0/4 [00:00<?, ?it/s] 25%|██▌       | 1/4 [00:00<00:00,  6.20it/s] 75%|███████▌  | 3/4 [00:00<00:00, 10.09it/s] 75%|███████▌  | 3/4 [00:00<00:00,  7.70it/s]
2025-03-09 07:02:29,042 [INFO]: 	>>> Finished "Compute fast metrics" in 12.1670 secs
2025-03-09 07:02:29,044 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 51.3433 secs
2025-03-09 07:02:29,044 [INFO]: {
2025-03-09 07:02:29,044 [INFO]: 	index_key: HNSW15
2025-03-09 07:02:29,044 [INFO]: 	index_param: efSearch=247
2025-03-09 07:02:29,044 [INFO]: 	index_path: knn.index
2025-03-09 07:02:29,044 [INFO]: 	size in bytes: 665584570
2025-03-09 07:02:29,044 [INFO]: 	avg_search_speed_ms: 10.524965377867614
2025-03-09 07:02:29,044 [INFO]: 	99p_search_speed_ms: 18.536822486203164
2025-03-09 07:02:29,044 [INFO]: 	reconstruction error %: 0.0
2025-03-09 07:02:29,044 [INFO]: 	nb vectors: 3383
2025-03-09 07:02:29,044 [INFO]: 	vectors dimension: 49152
2025-03-09 07:02:29,045 [INFO]: 	compression ratio: 0.9993093199260914
2025-03-09 07:02:29,045 [INFO]: }
2025-03-09 07:02:29,045 [INFO]: 	>>> Finished "Creating the index" in 51.3467 secs
2025-03-09 07:02:29,045 [INFO]: >>> Finished "Launching the whole pipeline" in 51.3768 secs
2025-03-09 07:02:30: [retrieval_preprocessing] calculating distances ...
2025-03-09 07:02:31: [retrieval_preprocessing] finished and saved retrieval indices for episode 70568 [episode count 15/20]
[retrieval_preprocessing] for episode 8107 [episode count 16/20], we have num_retrieval=np.int64(3455) num_query=np.int64(180)
2025-03-09 07:02:32,417 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-09 07:02:32,898 [INFO]: Launching the whole pipeline 03/09/2025, 07:02:32
2025-03-09 07:02:32,898 [INFO]: Reading total number of vectors and dimension 03/09/2025, 07:02:32
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 2048.00it/s]
2025-03-09 07:02:32,924 [INFO]: There are 3455 embeddings of dim 49152
2025-03-09 07:02:32,925 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0271 secs
2025-03-09 07:02:32,925 [INFO]: 	Compute estimated construction time of the index 03/09/2025, 07:02:32
2025-03-09 07:02:32,925 [INFO]: 		-> Train: 16.7 minutes
2025-03-09 07:02:32,925 [INFO]: 		-> Add: 1.9 seconds
2025-03-09 07:02:32,925 [INFO]: 		Total: 16.7 minutes
2025-03-09 07:02:32,925 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0003 secs
2025-03-09 07:02:32,925 [INFO]: 	Checking that your have enough memory available to create the index 03/09/2025, 07:02:32
2025-03-09 07:02:32,926 [INFO]: 713.0MB of memory will be needed to build the index (more might be used if you have more)
2025-03-09 07:02:32,926 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0005 secs
2025-03-09 07:02:32,926 [INFO]: 	Selecting most promising index types given data characteristics 03/09/2025, 07:02:32
2025-03-09 07:02:32,926 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-09 07:02:32,926 [INFO]: 	Creating the index 03/09/2025, 07:02:32
2025-03-09 07:02:32,927 [INFO]: 		-> Instanciate the index HNSW15 03/09/2025, 07:02:32
2025-03-09 07:02:32,929 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0028 secs
2025-03-09 07:02:32,930 [INFO]: 		-> Adding the vectors to the index 03/09/2025, 07:02:32
2025-03-09 07:02:32,930 [INFO]: The memory available for adding the vectors is 49.4GB(total available - used by the index)
2025-03-09 07:02:32,930 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/14 [00:00<?, ?it/s]  7%|▋         | 1/14 [00:00<00:01,  6.65it/s] 21%|██▏       | 3/14 [00:00<00:01,  9.94it/s] 36%|███▌      | 5/14 [00:00<00:00, 10.45it/s] 50%|█████     | 7/14 [00:00<00:00, 11.44it/s] 64%|██████▍   | 9/14 [00:00<00:00, 11.98it/s] 79%|███████▊  | 11/14 [00:00<00:00, 12.30it/s] 93%|█████████▎| 13/14 [00:01<00:00, 12.52it/s]100%|██████████| 14/14 [00:03<00:00,  3.91it/s]
2025-03-09 07:02:36,511 [INFO]: 	Computing best hyperparameters for index knn.index 03/09/2025, 07:02:36
2025-03-09 07:03:14,577 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 38.0650 secs
2025-03-09 07:03:14,577 [INFO]: The best hyperparameters are: efSearch=225
2025-03-09 07:03:14,577 [INFO]: 	Compute fast metrics 03/09/2025, 07:03:14
  0%|          | 0/4 [00:00<?, ?it/s] 25%|██▌       | 1/4 [00:01<00:04,  1.62s/it] 50%|█████     | 2/4 [00:03<00:03,  1.52s/it] 75%|███████▌  | 3/4 [00:04<00:01,  1.52s/it] 75%|███████▌  | 3/4 [00:05<00:01,  1.70s/it]
2025-03-09 07:03:32,104 [INFO]: 	>>> Finished "Compute fast metrics" in 17.5267 secs
2025-03-09 07:03:32,106 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 59.1765 secs
2025-03-09 07:03:32,106 [INFO]: {
2025-03-09 07:03:32,106 [INFO]: 	index_key: HNSW15
2025-03-09 07:03:32,106 [INFO]: 	index_param: efSearch=225
2025-03-09 07:03:32,106 [INFO]: 	index_path: knn.index
2025-03-09 07:03:32,107 [INFO]: 	size in bytes: 679750090
2025-03-09 07:03:32,107 [INFO]: 	avg_search_speed_ms: 8.741149522316922
2025-03-09 07:03:32,107 [INFO]: 	99p_search_speed_ms: 11.475552602205426
2025-03-09 07:03:32,107 [INFO]: 	reconstruction error %: 0.0
2025-03-09 07:03:32,107 [INFO]: 	nb vectors: 3455
2025-03-09 07:03:32,107 [INFO]: 	vectors dimension: 49152
2025-03-09 07:03:32,107 [INFO]: 	compression ratio: 0.9993093785393982
2025-03-09 07:03:32,107 [INFO]: }
2025-03-09 07:03:32,107 [INFO]: 	>>> Finished "Creating the index" in 59.1801 secs
2025-03-09 07:03:32,107 [INFO]: >>> Finished "Launching the whole pipeline" in 59.2089 secs
2025-03-09 07:03:32: [retrieval_preprocessing] calculating distances ...
2025-03-09 07:03:33: [retrieval_preprocessing] finished and saved retrieval indices for episode 8107 [episode count 16/20]
[retrieval_preprocessing] for episode 60076 [episode count 17/20], we have num_retrieval=np.int64(3391) num_query=np.int64(244)
2025-03-09 07:03:34,272 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-09 07:03:34,695 [INFO]: Launching the whole pipeline 03/09/2025, 07:03:34
2025-03-09 07:03:34,695 [INFO]: Reading total number of vectors and dimension 03/09/2025, 07:03:34
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 2194.82it/s]
2025-03-09 07:03:34,719 [INFO]: There are 3391 embeddings of dim 49152
2025-03-09 07:03:34,719 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0235 secs
2025-03-09 07:03:34,719 [INFO]: 	Compute estimated construction time of the index 03/09/2025, 07:03:34
2025-03-09 07:03:34,719 [INFO]: 		-> Train: 16.7 minutes
2025-03-09 07:03:34,719 [INFO]: 		-> Add: 1.9 seconds
2025-03-09 07:03:34,719 [INFO]: 		Total: 16.7 minutes
2025-03-09 07:03:34,719 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0001 secs
2025-03-09 07:03:34,719 [INFO]: 	Checking that your have enough memory available to create the index 03/09/2025, 07:03:34
2025-03-09 07:03:34,719 [INFO]: 699.8MB of memory will be needed to build the index (more might be used if you have more)
2025-03-09 07:03:34,719 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0001 secs
2025-03-09 07:03:34,719 [INFO]: 	Selecting most promising index types given data characteristics 03/09/2025, 07:03:34
2025-03-09 07:03:34,719 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-09 07:03:34,719 [INFO]: 	Creating the index 03/09/2025, 07:03:34
2025-03-09 07:03:34,719 [INFO]: 		-> Instanciate the index HNSW15 03/09/2025, 07:03:34
2025-03-09 07:03:34,720 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0009 secs
2025-03-09 07:03:34,720 [INFO]: 		-> Adding the vectors to the index 03/09/2025, 07:03:34
2025-03-09 07:03:34,721 [INFO]: The memory available for adding the vectors is 49.4GB(total available - used by the index)
2025-03-09 07:03:34,721 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/14 [00:00<?, ?it/s]  7%|▋         | 1/14 [00:00<00:02,  5.76it/s] 14%|█▍        | 2/14 [00:00<00:01,  7.41it/s] 21%|██▏       | 3/14 [00:00<00:01,  7.82it/s] 29%|██▊       | 4/14 [00:00<00:01,  8.04it/s] 36%|███▌      | 5/14 [00:00<00:01,  8.14it/s] 43%|████▎     | 6/14 [00:00<00:00,  8.35it/s] 50%|█████     | 7/14 [00:00<00:00,  8.32it/s] 57%|█████▋    | 8/14 [00:00<00:00,  8.28it/s] 64%|██████▍   | 9/14 [00:01<00:00,  8.22it/s] 71%|███████▏  | 10/14 [00:01<00:00,  7.47it/s] 79%|███████▊  | 11/14 [00:01<00:00,  6.68it/s] 86%|████████▌ | 12/14 [00:01<00:00,  5.91it/s] 93%|█████████▎| 13/14 [00:01<00:00,  6.44it/s]100%|██████████| 14/14 [00:04<00:00,  1.06it/s]100%|██████████| 14/14 [00:04<00:00,  3.06it/s]
2025-03-09 07:03:39,300 [INFO]: 	Computing best hyperparameters for index knn.index 03/09/2025, 07:03:39
2025-03-09 07:04:11,877 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 32.5772 secs
2025-03-09 07:04:11,878 [INFO]: The best hyperparameters are: efSearch=244
2025-03-09 07:04:11,878 [INFO]: 	Compute fast metrics 03/09/2025, 07:04:11
  0%|          | 0/4 [00:00<?, ?it/s] 25%|██▌       | 1/4 [00:00<00:00,  7.59it/s] 75%|███████▌  | 3/4 [00:00<00:00, 10.94it/s] 75%|███████▌  | 3/4 [00:00<00:00,  8.62it/s]
2025-03-09 07:04:24,678 [INFO]: 	>>> Finished "Compute fast metrics" in 12.8004 secs
2025-03-09 07:04:24,681 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 49.9601 secs
2025-03-09 07:04:24,681 [INFO]: {
2025-03-09 07:04:24,681 [INFO]: 	index_key: HNSW15
2025-03-09 07:04:24,681 [INFO]: 	index_param: efSearch=244
2025-03-09 07:04:24,681 [INFO]: 	index_path: knn.index
2025-03-09 07:04:24,681 [INFO]: 	size in bytes: 667158550
2025-03-09 07:04:24,681 [INFO]: 	avg_search_speed_ms: 10.305577519337286
2025-03-09 07:04:24,681 [INFO]: 	99p_search_speed_ms: 15.885135228745622
2025-03-09 07:04:24,681 [INFO]: 	reconstruction error %: 0.0
2025-03-09 07:04:24,681 [INFO]: 	nb vectors: 3391
2025-03-09 07:04:24,681 [INFO]: 	vectors dimension: 49152
2025-03-09 07:04:24,681 [INFO]: 	compression ratio: 0.9993092766329683
2025-03-09 07:04:24,681 [INFO]: }
2025-03-09 07:04:24,681 [INFO]: 	>>> Finished "Creating the index" in 49.9615 secs
2025-03-09 07:04:24,681 [INFO]: >>> Finished "Launching the whole pipeline" in 49.9855 secs
2025-03-09 07:04:26: [retrieval_preprocessing] calculating distances ...
2025-03-09 07:04:26: [retrieval_preprocessing] finished and saved retrieval indices for episode 60076 [episode count 17/20]
[retrieval_preprocessing] for episode 25262 [episode count 18/20], we have num_retrieval=np.int64(3487) num_query=np.int64(148)
2025-03-09 07:04:27,996 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-09 07:04:28,487 [INFO]: Launching the whole pipeline 03/09/2025, 07:04:28
2025-03-09 07:04:28,487 [INFO]: Reading total number of vectors and dimension 03/09/2025, 07:04:28
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1201.81it/s]
2025-03-09 07:04:28,513 [INFO]: There are 3487 embeddings of dim 49152
2025-03-09 07:04:28,513 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0258 secs
2025-03-09 07:04:28,513 [INFO]: 	Compute estimated construction time of the index 03/09/2025, 07:04:28
2025-03-09 07:04:28,513 [INFO]: 		-> Train: 16.7 minutes
2025-03-09 07:04:28,513 [INFO]: 		-> Add: 1.9 seconds
2025-03-09 07:04:28,513 [INFO]: 		Total: 16.7 minutes
2025-03-09 07:04:28,513 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0001 secs
2025-03-09 07:04:28,513 [INFO]: 	Checking that your have enough memory available to create the index 03/09/2025, 07:04:28
2025-03-09 07:04:28,513 [INFO]: 719.6MB of memory will be needed to build the index (more might be used if you have more)
2025-03-09 07:04:28,513 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0001 secs
2025-03-09 07:04:28,513 [INFO]: 	Selecting most promising index types given data characteristics 03/09/2025, 07:04:28
2025-03-09 07:04:28,513 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-09 07:04:28,513 [INFO]: 	Creating the index 03/09/2025, 07:04:28
2025-03-09 07:04:28,513 [INFO]: 		-> Instanciate the index HNSW15 03/09/2025, 07:04:28
2025-03-09 07:04:28,514 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0010 secs
2025-03-09 07:04:28,514 [INFO]: 		-> Adding the vectors to the index 03/09/2025, 07:04:28
2025-03-09 07:04:28,514 [INFO]: The memory available for adding the vectors is 49.4GB(total available - used by the index)
2025-03-09 07:04:28,514 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/14 [00:00<?, ?it/s]  7%|▋         | 1/14 [00:00<00:02,  4.95it/s] 14%|█▍        | 2/14 [00:00<00:01,  6.57it/s] 21%|██▏       | 3/14 [00:00<00:01,  7.29it/s] 29%|██▊       | 4/14 [00:00<00:01,  7.73it/s] 36%|███▌      | 5/14 [00:00<00:01,  7.90it/s] 43%|████▎     | 6/14 [00:00<00:00,  8.29it/s] 50%|█████     | 7/14 [00:00<00:00,  8.53it/s] 57%|█████▋    | 8/14 [00:01<00:00,  8.72it/s] 64%|██████▍   | 9/14 [00:01<00:00,  8.83it/s] 71%|███████▏  | 10/14 [00:01<00:00,  8.89it/s] 79%|███████▊  | 11/14 [00:01<00:00,  8.94it/s] 86%|████████▌ | 12/14 [00:01<00:00,  9.08it/s] 93%|█████████▎| 13/14 [00:01<00:00,  9.08it/s]100%|██████████| 14/14 [00:03<00:00,  1.24it/s]100%|██████████| 14/14 [00:03<00:00,  3.52it/s]
2025-03-09 07:04:32,494 [INFO]: 	Computing best hyperparameters for index knn.index 03/09/2025, 07:04:32
2025-03-09 07:05:06,188 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 33.6932 secs
2025-03-09 07:05:06,188 [INFO]: The best hyperparameters are: efSearch=276
2025-03-09 07:05:06,189 [INFO]: 	Compute fast metrics 03/09/2025, 07:05:06
  0%|          | 0/4 [00:00<?, ?it/s] 25%|██▌       | 1/4 [00:00<00:00,  5.83it/s] 75%|███████▌  | 3/4 [00:00<00:00,  9.57it/s] 75%|███████▌  | 3/4 [00:00<00:00,  7.31it/s]
2025-03-09 07:05:19,761 [INFO]: 	>>> Finished "Compute fast metrics" in 13.5725 secs
2025-03-09 07:05:19,763 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 51.2491 secs
2025-03-09 07:05:19,763 [INFO]: {
2025-03-09 07:05:19,763 [INFO]: 	index_key: HNSW15
2025-03-09 07:05:19,764 [INFO]: 	index_param: efSearch=276
2025-03-09 07:05:19,764 [INFO]: 	index_path: knn.index
2025-03-09 07:05:19,764 [INFO]: 	size in bytes: 686045830
2025-03-09 07:05:19,764 [INFO]: 	avg_search_speed_ms: 10.675580257931555
2025-03-09 07:05:19,764 [INFO]: 	99p_search_speed_ms: 14.142981925979255
2025-03-09 07:05:19,764 [INFO]: 	reconstruction error %: 0.0
2025-03-09 07:05:19,764 [INFO]: 	nb vectors: 3487
2025-03-09 07:05:19,764 [INFO]: 	vectors dimension: 49152
2025-03-09 07:05:19,764 [INFO]: 	compression ratio: 0.9993094717884955
2025-03-09 07:05:19,764 [INFO]: }
2025-03-09 07:05:19,764 [INFO]: 	>>> Finished "Creating the index" in 51.2505 secs
2025-03-09 07:05:19,764 [INFO]: >>> Finished "Launching the whole pipeline" in 51.2768 secs
2025-03-09 07:05:20: [retrieval_preprocessing] calculating distances ...
2025-03-09 07:05:21: [retrieval_preprocessing] finished and saved retrieval indices for episode 25262 [episode count 18/20]
[retrieval_preprocessing] for episode 23215 [episode count 19/20], we have num_retrieval=np.int64(3469) num_query=np.int64(166)
2025-03-09 07:05:22,438 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-09 07:05:22,974 [INFO]: Launching the whole pipeline 03/09/2025, 07:05:22
2025-03-09 07:05:22,974 [INFO]: Reading total number of vectors and dimension 03/09/2025, 07:05:22
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1755.67it/s]
2025-03-09 07:05:22,998 [INFO]: There are 3469 embeddings of dim 49152
2025-03-09 07:05:22,998 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0245 secs
2025-03-09 07:05:22,998 [INFO]: 	Compute estimated construction time of the index 03/09/2025, 07:05:22
2025-03-09 07:05:22,999 [INFO]: 		-> Train: 16.7 minutes
2025-03-09 07:05:22,999 [INFO]: 		-> Add: 1.9 seconds
2025-03-09 07:05:22,999 [INFO]: 		Total: 16.7 minutes
2025-03-09 07:05:22,999 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0001 secs
2025-03-09 07:05:22,999 [INFO]: 	Checking that your have enough memory available to create the index 03/09/2025, 07:05:22
2025-03-09 07:05:22,999 [INFO]: 715.9MB of memory will be needed to build the index (more might be used if you have more)
2025-03-09 07:05:22,999 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0003 secs
2025-03-09 07:05:22,999 [INFO]: 	Selecting most promising index types given data characteristics 03/09/2025, 07:05:22
2025-03-09 07:05:22,999 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-09 07:05:22,999 [INFO]: 	Creating the index 03/09/2025, 07:05:22
2025-03-09 07:05:22,999 [INFO]: 		-> Instanciate the index HNSW15 03/09/2025, 07:05:22
2025-03-09 07:05:23,000 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0010 secs
2025-03-09 07:05:23,000 [INFO]: 		-> Adding the vectors to the index 03/09/2025, 07:05:23
2025-03-09 07:05:23,000 [INFO]: The memory available for adding the vectors is 49.4GB(total available - used by the index)
2025-03-09 07:05:23,000 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/14 [00:00<?, ?it/s]  7%|▋         | 1/14 [00:00<00:02,  5.40it/s] 14%|█▍        | 2/14 [00:00<00:01,  7.11it/s] 21%|██▏       | 3/14 [00:00<00:01,  7.91it/s] 29%|██▊       | 4/14 [00:00<00:01,  8.35it/s] 36%|███▌      | 5/14 [00:00<00:01,  8.71it/s] 43%|████▎     | 6/14 [00:00<00:00,  8.87it/s] 50%|█████     | 7/14 [00:00<00:00,  8.92it/s] 57%|█████▋    | 8/14 [00:00<00:00,  8.98it/s] 64%|██████▍   | 9/14 [00:01<00:00,  8.98it/s] 71%|███████▏  | 10/14 [00:01<00:00,  9.10it/s] 79%|███████▊  | 11/14 [00:01<00:00,  9.05it/s] 86%|████████▌ | 12/14 [00:01<00:00,  9.02it/s] 93%|█████████▎| 13/14 [00:01<00:00,  9.03it/s]100%|██████████| 14/14 [00:04<00:00,  1.18it/s]100%|██████████| 14/14 [00:04<00:00,  3.46it/s]
2025-03-09 07:05:27,053 [INFO]: 	Computing best hyperparameters for index knn.index 03/09/2025, 07:05:27
2025-03-09 07:06:04,808 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 37.7546 secs
2025-03-09 07:06:04,809 [INFO]: The best hyperparameters are: efSearch=210
2025-03-09 07:06:04,809 [INFO]: 	Compute fast metrics 03/09/2025, 07:06:04
  0%|          | 0/4 [00:00<?, ?it/s] 25%|██▌       | 1/4 [00:01<00:04,  1.60s/it] 50%|█████     | 2/4 [00:02<00:02,  1.21s/it] 75%|███████▌  | 3/4 [00:02<00:00,  1.32it/s] 75%|███████▌  | 3/4 [00:02<00:00,  1.07it/s]
2025-03-09 07:06:30,325 [INFO]: 	>>> Finished "Compute fast metrics" in 25.5161 secs
2025-03-09 07:06:30,327 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 67.3268 secs
2025-03-09 07:06:30,327 [INFO]: {
2025-03-09 07:06:30,327 [INFO]: 	index_key: HNSW15
2025-03-09 07:06:30,327 [INFO]: 	index_param: efSearch=210
2025-03-09 07:06:30,327 [INFO]: 	index_path: knn.index
2025-03-09 07:06:30,327 [INFO]: 	size in bytes: 682504450
2025-03-09 07:06:30,327 [INFO]: 	avg_search_speed_ms: 8.447691755340989
2025-03-09 07:06:30,327 [INFO]: 	99p_search_speed_ms: 11.249430233146995
2025-03-09 07:06:30,327 [INFO]: 	reconstruction error %: 0.0
2025-03-09 07:06:30,327 [INFO]: 	nb vectors: 3469
2025-03-09 07:06:30,327 [INFO]: 	vectors dimension: 49152
2025-03-09 07:06:30,327 [INFO]: 	compression ratio: 0.9993094579822887
2025-03-09 07:06:30,327 [INFO]: }
2025-03-09 07:06:30,327 [INFO]: 	>>> Finished "Creating the index" in 67.3283 secs
2025-03-09 07:06:30,327 [INFO]: >>> Finished "Launching the whole pipeline" in 67.3535 secs
2025-03-09 07:06:31: [retrieval_preprocessing] calculating distances ...
2025-03-09 07:06:31: [retrieval_preprocessing] finished and saved retrieval indices for episode 23215 [episode count 19/20]
2025-03-09 07:06:31: [retrieval_preprocessing] finished for (5024387521, 'marker') [chosen_id count 0/10]
2025-03-09 07:06:32: [retrieval_preprocessing] concatenated all embeddings and indices for 20 episodes for (6498288010, 'lid') [chosen_id count 1/10]
2025-03-09 07:06:32: [retrieval_preprocessing] we have num_total=3395 embedding_dim=49152
[retrieval_preprocessing] for episode 15362 [episode count 0/20], we have num_retrieval=np.int64(3229) num_query=np.int64(166)
2025-03-09 07:06:33,249 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-09 07:06:33,760 [INFO]: Launching the whole pipeline 03/09/2025, 07:06:33
2025-03-09 07:06:33,760 [INFO]: Reading total number of vectors and dimension 03/09/2025, 07:06:33
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1982.19it/s]
2025-03-09 07:06:33,785 [INFO]: There are 3229 embeddings of dim 49152
2025-03-09 07:06:33,785 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0254 secs
2025-03-09 07:06:33,786 [INFO]: 	Compute estimated construction time of the index 03/09/2025, 07:06:33
2025-03-09 07:06:33,786 [INFO]: 		-> Train: 16.7 minutes
2025-03-09 07:06:33,786 [INFO]: 		-> Add: 1.8 seconds
2025-03-09 07:06:33,786 [INFO]: 		Total: 16.7 minutes
2025-03-09 07:06:33,786 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0003 secs
2025-03-09 07:06:33,786 [INFO]: 	Checking that your have enough memory available to create the index 03/09/2025, 07:06:33
2025-03-09 07:06:33,786 [INFO]: 666.4MB of memory will be needed to build the index (more might be used if you have more)
2025-03-09 07:06:33,786 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0002 secs
2025-03-09 07:06:33,786 [INFO]: 	Selecting most promising index types given data characteristics 03/09/2025, 07:06:33
2025-03-09 07:06:33,786 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-09 07:06:33,786 [INFO]: 	Creating the index 03/09/2025, 07:06:33
2025-03-09 07:06:33,786 [INFO]: 		-> Instanciate the index HNSW15 03/09/2025, 07:06:33
2025-03-09 07:06:33,788 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0012 secs
2025-03-09 07:06:33,788 [INFO]: 		-> Adding the vectors to the index 03/09/2025, 07:06:33
2025-03-09 07:06:33,788 [INFO]: The memory available for adding the vectors is 49.4GB(total available - used by the index)
2025-03-09 07:06:33,788 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/13 [00:00<?, ?it/s]  8%|▊         | 1/13 [00:00<00:01,  6.72it/s] 23%|██▎       | 3/13 [00:00<00:00, 12.73it/s] 38%|███▊      | 5/13 [00:00<00:00, 15.49it/s] 54%|█████▍    | 7/13 [00:00<00:00, 16.32it/s] 69%|██████▉   | 9/13 [00:00<00:00, 16.71it/s] 85%|████████▍ | 11/13 [00:00<00:00, 17.08it/s]100%|██████████| 13/13 [00:02<00:00,  2.54it/s]100%|██████████| 13/13 [00:02<00:00,  4.59it/s]
2025-03-09 07:06:36,629 [INFO]: 	Computing best hyperparameters for index knn.index 03/09/2025, 07:06:36
2025-03-09 07:07:14,889 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 38.2605 secs
2025-03-09 07:07:14,890 [INFO]: The best hyperparameters are: efSearch=181
2025-03-09 07:07:14,890 [INFO]: 	Compute fast metrics 03/09/2025, 07:07:14
  0%|          | 0/4 [00:00<?, ?it/s] 25%|██▌       | 1/4 [00:03<00:09,  3.16s/it] 50%|█████     | 2/4 [00:06<00:06,  3.37s/it] 75%|███████▌  | 3/4 [00:07<00:02,  2.08s/it] 75%|███████▌  | 3/4 [00:07<00:02,  2.42s/it]
2025-03-09 07:07:41,292 [INFO]: 	>>> Finished "Compute fast metrics" in 26.4025 secs
2025-03-09 07:07:41,295 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 67.5070 secs
2025-03-09 07:07:41,295 [INFO]: {
2025-03-09 07:07:41,295 [INFO]: 	index_key: HNSW15
2025-03-09 07:07:41,295 [INFO]: 	index_param: efSearch=181
2025-03-09 07:07:41,295 [INFO]: 	index_path: knn.index
2025-03-09 07:07:41,295 [INFO]: 	size in bytes: 635285950
2025-03-09 07:07:41,295 [INFO]: 	avg_search_speed_ms: 8.358979002567924
2025-03-09 07:07:41,295 [INFO]: 	99p_search_speed_ms: 11.674981913529336
2025-03-09 07:07:41,295 [INFO]: 	reconstruction error %: 0.0
2025-03-09 07:07:41,295 [INFO]: 	nb vectors: 3229
2025-03-09 07:07:41,295 [INFO]: 	vectors dimension: 49152
2025-03-09 07:07:41,295 [INFO]: 	compression ratio: 0.9993094164918963
2025-03-09 07:07:41,295 [INFO]: }
2025-03-09 07:07:41,295 [INFO]: 	>>> Finished "Creating the index" in 67.5088 secs
2025-03-09 07:07:41,295 [INFO]: >>> Finished "Launching the whole pipeline" in 67.5352 secs
2025-03-09 07:07:42: [retrieval_preprocessing] calculating distances ...
2025-03-09 07:07:42: [retrieval_preprocessing] finished and saved retrieval indices for episode 15362 [episode count 0/20]
[retrieval_preprocessing] for episode 3592 [episode count 1/20], we have num_retrieval=np.int64(3233) num_query=np.int64(162)
2025-03-09 07:07:43,680 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-09 07:07:44,113 [INFO]: Launching the whole pipeline 03/09/2025, 07:07:44
2025-03-09 07:07:44,113 [INFO]: Reading total number of vectors and dimension 03/09/2025, 07:07:44
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 2144.33it/s]
2025-03-09 07:07:44,142 [INFO]: There are 3233 embeddings of dim 49152
2025-03-09 07:07:44,142 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0289 secs
2025-03-09 07:07:44,142 [INFO]: 	Compute estimated construction time of the index 03/09/2025, 07:07:44
2025-03-09 07:07:44,142 [INFO]: 		-> Train: 16.7 minutes
2025-03-09 07:07:44,142 [INFO]: 		-> Add: 1.8 seconds
2025-03-09 07:07:44,142 [INFO]: 		Total: 16.7 minutes
2025-03-09 07:07:44,142 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0001 secs
2025-03-09 07:07:44,142 [INFO]: 	Checking that your have enough memory available to create the index 03/09/2025, 07:07:44
2025-03-09 07:07:44,142 [INFO]: 667.2MB of memory will be needed to build the index (more might be used if you have more)
2025-03-09 07:07:44,142 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0001 secs
2025-03-09 07:07:44,142 [INFO]: 	Selecting most promising index types given data characteristics 03/09/2025, 07:07:44
2025-03-09 07:07:44,142 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-09 07:07:44,142 [INFO]: 	Creating the index 03/09/2025, 07:07:44
2025-03-09 07:07:44,142 [INFO]: 		-> Instanciate the index HNSW15 03/09/2025, 07:07:44
2025-03-09 07:07:44,143 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0009 secs
2025-03-09 07:07:44,143 [INFO]: 		-> Adding the vectors to the index 03/09/2025, 07:07:44
2025-03-09 07:07:44,143 [INFO]: The memory available for adding the vectors is 49.4GB(total available - used by the index)
2025-03-09 07:07:44,143 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/13 [00:00<?, ?it/s]  8%|▊         | 1/13 [00:00<00:01,  9.65it/s] 54%|█████▍    | 7/13 [00:00<00:00, 35.44it/s] 92%|█████████▏| 12/13 [00:00<00:00, 37.04it/s]100%|██████████| 13/13 [00:02<00:00,  4.87it/s]
2025-03-09 07:07:46,815 [INFO]: 	Computing best hyperparameters for index knn.index 03/09/2025, 07:07:46
2025-03-09 07:08:25,557 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 38.7417 secs
2025-03-09 07:08:25,558 [INFO]: The best hyperparameters are: efSearch=240
2025-03-09 07:08:25,558 [INFO]: 	Compute fast metrics 03/09/2025, 07:08:25
  0%|          | 0/4 [00:00<?, ?it/s] 25%|██▌       | 1/4 [00:00<00:00,  5.02it/s] 50%|█████     | 2/4 [00:00<00:00,  6.38it/s] 75%|███████▌  | 3/4 [00:00<00:00,  7.12it/s] 75%|███████▌  | 3/4 [00:00<00:00,  5.32it/s]
2025-03-09 07:08:39,367 [INFO]: 	>>> Finished "Compute fast metrics" in 13.8095 secs
2025-03-09 07:08:39,369 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 55.2257 secs
2025-03-09 07:08:39,369 [INFO]: {
2025-03-09 07:08:39,369 [INFO]: 	index_key: HNSW15
2025-03-09 07:08:39,369 [INFO]: 	index_param: efSearch=240
2025-03-09 07:08:39,369 [INFO]: 	index_path: knn.index
2025-03-09 07:08:39,369 [INFO]: 	size in bytes: 636072970
2025-03-09 07:08:39,369 [INFO]: 	avg_search_speed_ms: 10.129097491510311
2025-03-09 07:08:39,369 [INFO]: 	99p_search_speed_ms: 13.444410017691553
2025-03-09 07:08:39,369 [INFO]: 	reconstruction error %: 0.0
2025-03-09 07:08:39,369 [INFO]: 	nb vectors: 3233
2025-03-09 07:08:39,369 [INFO]: 	vectors dimension: 49152
2025-03-09 07:08:39,369 [INFO]: 	compression ratio: 0.9993093465361372
2025-03-09 07:08:39,369 [INFO]: }
2025-03-09 07:08:39,369 [INFO]: 	>>> Finished "Creating the index" in 55.2271 secs
2025-03-09 07:08:39,369 [INFO]: >>> Finished "Launching the whole pipeline" in 55.2566 secs
2025-03-09 07:08:40: [retrieval_preprocessing] calculating distances ...
2025-03-09 07:08:41: [retrieval_preprocessing] finished and saved retrieval indices for episode 3592 [episode count 1/20]
[retrieval_preprocessing] for episode 55818 [episode count 2/20], we have num_retrieval=np.int64(3246) num_query=np.int64(149)
2025-03-09 07:08:41,649 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-09 07:08:42,173 [INFO]: Launching the whole pipeline 03/09/2025, 07:08:42
2025-03-09 07:08:42,173 [INFO]: Reading total number of vectors and dimension 03/09/2025, 07:08:42
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1399.97it/s]
2025-03-09 07:08:42,198 [INFO]: There are 3246 embeddings of dim 49152
2025-03-09 07:08:42,199 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0255 secs
2025-03-09 07:08:42,199 [INFO]: 	Compute estimated construction time of the index 03/09/2025, 07:08:42
2025-03-09 07:08:42,199 [INFO]: 		-> Train: 16.7 minutes
2025-03-09 07:08:42,199 [INFO]: 		-> Add: 1.8 seconds
2025-03-09 07:08:42,199 [INFO]: 		Total: 16.7 minutes
2025-03-09 07:08:42,199 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0001 secs
2025-03-09 07:08:42,199 [INFO]: 	Checking that your have enough memory available to create the index 03/09/2025, 07:08:42
2025-03-09 07:08:42,199 [INFO]: 669.9MB of memory will be needed to build the index (more might be used if you have more)
2025-03-09 07:08:42,199 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0002 secs
2025-03-09 07:08:42,199 [INFO]: 	Selecting most promising index types given data characteristics 03/09/2025, 07:08:42
2025-03-09 07:08:42,199 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-09 07:08:42,199 [INFO]: 	Creating the index 03/09/2025, 07:08:42
2025-03-09 07:08:42,199 [INFO]: 		-> Instanciate the index HNSW15 03/09/2025, 07:08:42
2025-03-09 07:08:42,200 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0011 secs
2025-03-09 07:08:42,200 [INFO]: 		-> Adding the vectors to the index 03/09/2025, 07:08:42
2025-03-09 07:08:42,201 [INFO]: The memory available for adding the vectors is 49.4GB(total available - used by the index)
2025-03-09 07:08:42,201 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/13 [00:00<?, ?it/s]  8%|▊         | 1/13 [00:00<00:02,  5.74it/s] 23%|██▎       | 3/13 [00:00<00:01,  9.39it/s] 38%|███▊      | 5/13 [00:00<00:00, 10.94it/s] 54%|█████▍    | 7/13 [00:00<00:00, 11.65it/s] 69%|██████▉   | 9/13 [00:00<00:00, 11.67it/s] 85%|████████▍ | 11/13 [00:00<00:00, 11.54it/s]100%|██████████| 13/13 [00:03<00:00,  2.18it/s]100%|██████████| 13/13 [00:03<00:00,  3.82it/s]
2025-03-09 07:08:45,613 [INFO]: 	Computing best hyperparameters for index knn.index 03/09/2025, 07:08:45
2025-03-09 07:09:19,768 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 34.1552 secs
2025-03-09 07:09:19,769 [INFO]: The best hyperparameters are: efSearch=241
2025-03-09 07:09:19,769 [INFO]: 	Compute fast metrics 03/09/2025, 07:09:19
  0%|          | 0/4 [00:00<?, ?it/s] 25%|██▌       | 1/4 [00:00<00:01,  2.55it/s] 50%|█████     | 2/4 [00:00<00:00,  2.49it/s] 75%|███████▌  | 3/4 [00:00<00:00,  3.29it/s]
2025-03-09 07:09:35,373 [INFO]: 	>>> Finished "Compute fast metrics" in 15.6045 secs
2025-03-09 07:09:35,376 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 53.1755 secs
2025-03-09 07:09:35,376 [INFO]: {
2025-03-09 07:09:35,376 [INFO]: 	index_key: HNSW15
2025-03-09 07:09:35,376 [INFO]: 	index_param: efSearch=241
2025-03-09 07:09:35,376 [INFO]: 	index_path: knn.index
2025-03-09 07:09:35,376 [INFO]: 	size in bytes: 638630770
2025-03-09 07:09:35,376 [INFO]: 	avg_search_speed_ms: 11.10824472270906
2025-03-09 07:09:35,376 [INFO]: 	99p_search_speed_ms: 18.402457577176392
2025-03-09 07:09:35,376 [INFO]: 	reconstruction error %: 0.0
2025-03-09 07:09:35,376 [INFO]: 	nb vectors: 3246
2025-03-09 07:09:35,376 [INFO]: 	vectors dimension: 49152
2025-03-09 07:09:35,376 [INFO]: 	compression ratio: 0.9993091438422236
2025-03-09 07:09:35,376 [INFO]: }
2025-03-09 07:09:35,376 [INFO]: 	>>> Finished "Creating the index" in 53.1772 secs
2025-03-09 07:09:35,376 [INFO]: >>> Finished "Launching the whole pipeline" in 53.2035 secs
2025-03-09 07:09:36: [retrieval_preprocessing] calculating distances ...
2025-03-09 07:09:37: [retrieval_preprocessing] finished and saved retrieval indices for episode 55818 [episode count 2/20]
[retrieval_preprocessing] for episode 43022 [episode count 3/20], we have num_retrieval=np.int64(3248) num_query=np.int64(147)
2025-03-09 07:09:44,366 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-09 07:09:44,816 [INFO]: Launching the whole pipeline 03/09/2025, 07:09:44
2025-03-09 07:09:44,816 [INFO]: Reading total number of vectors and dimension 03/09/2025, 07:09:44
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1830.77it/s]
2025-03-09 07:09:44,848 [INFO]: There are 3248 embeddings of dim 49152
2025-03-09 07:09:44,848 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0318 secs
2025-03-09 07:09:44,848 [INFO]: 	Compute estimated construction time of the index 03/09/2025, 07:09:44
2025-03-09 07:09:44,849 [INFO]: 		-> Train: 16.7 minutes
2025-03-09 07:09:44,849 [INFO]: 		-> Add: 1.8 seconds
2025-03-09 07:09:44,849 [INFO]: 		Total: 16.7 minutes
2025-03-09 07:09:44,849 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0003 secs
2025-03-09 07:09:44,849 [INFO]: 	Checking that your have enough memory available to create the index 03/09/2025, 07:09:44
2025-03-09 07:09:44,849 [INFO]: 670.3MB of memory will be needed to build the index (more might be used if you have more)
2025-03-09 07:09:44,849 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0004 secs
2025-03-09 07:09:44,849 [INFO]: 	Selecting most promising index types given data characteristics 03/09/2025, 07:09:44
2025-03-09 07:09:44,850 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-09 07:09:44,850 [INFO]: 	Creating the index 03/09/2025, 07:09:44
2025-03-09 07:09:44,850 [INFO]: 		-> Instanciate the index HNSW15 03/09/2025, 07:09:44
2025-03-09 07:09:44,853 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0030 secs
2025-03-09 07:09:44,853 [INFO]: 		-> Adding the vectors to the index 03/09/2025, 07:09:44
2025-03-09 07:09:44,853 [INFO]: The memory available for adding the vectors is 49.4GB(total available - used by the index)
2025-03-09 07:09:44,853 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/13 [00:00<?, ?it/s]  8%|▊         | 1/13 [00:00<00:03,  3.71it/s] 46%|████▌     | 6/13 [00:00<00:00, 18.48it/s] 85%|████████▍ | 11/13 [00:00<00:00, 26.77it/s]100%|██████████| 13/13 [00:02<00:00,  4.44it/s]
2025-03-09 07:09:47,785 [INFO]: 	Computing best hyperparameters for index knn.index 03/09/2025, 07:09:47
2025-03-09 07:10:20,537 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 32.7508 secs
2025-03-09 07:10:20,537 [INFO]: The best hyperparameters are: efSearch=217
2025-03-09 07:10:20,537 [INFO]: 	Compute fast metrics 03/09/2025, 07:10:20
  0%|          | 0/4 [00:00<?, ?it/s] 25%|██▌       | 1/4 [00:00<00:00,  5.27it/s] 75%|███████▌  | 3/4 [00:00<00:00,  7.95it/s] 75%|███████▌  | 3/4 [00:00<00:00,  6.15it/s]
2025-03-09 07:10:32,918 [INFO]: 	>>> Finished "Compute fast metrics" in 12.3808 secs
2025-03-09 07:10:32,919 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 48.0661 secs
2025-03-09 07:10:32,919 [INFO]: {
2025-03-09 07:10:32,920 [INFO]: 	index_key: HNSW15
2025-03-09 07:10:32,920 [INFO]: 	index_param: efSearch=217
2025-03-09 07:10:32,920 [INFO]: 	index_path: knn.index
2025-03-09 07:10:32,920 [INFO]: 	size in bytes: 639024250
2025-03-09 07:10:32,920 [INFO]: 	avg_search_speed_ms: 11.083999943729498
2025-03-09 07:10:32,920 [INFO]: 	99p_search_speed_ms: 19.69684856012464
2025-03-09 07:10:32,920 [INFO]: 	reconstruction error %: 0.0
2025-03-09 07:10:32,920 [INFO]: 	nb vectors: 3248
2025-03-09 07:10:32,920 [INFO]: 	vectors dimension: 49152
2025-03-09 07:10:32,920 [INFO]: 	compression ratio: 0.9993091561079255
2025-03-09 07:10:32,920 [INFO]: }
2025-03-09 07:10:32,920 [INFO]: 	>>> Finished "Creating the index" in 48.0700 secs
2025-03-09 07:10:32,920 [INFO]: >>> Finished "Launching the whole pipeline" in 48.1033 secs
2025-03-09 07:10:33: [retrieval_preprocessing] calculating distances ...
2025-03-09 07:10:34: [retrieval_preprocessing] finished and saved retrieval indices for episode 43022 [episode count 3/20]
[retrieval_preprocessing] for episode 59920 [episode count 4/20], we have num_retrieval=np.int64(3238) num_query=np.int64(157)
2025-03-09 07:10:35,366 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-09 07:10:35,809 [INFO]: Launching the whole pipeline 03/09/2025, 07:10:35
2025-03-09 07:10:35,809 [INFO]: Reading total number of vectors and dimension 03/09/2025, 07:10:35
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1356.06it/s]
2025-03-09 07:10:35,834 [INFO]: There are 3238 embeddings of dim 49152
2025-03-09 07:10:35,835 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0255 secs
2025-03-09 07:10:35,835 [INFO]: 	Compute estimated construction time of the index 03/09/2025, 07:10:35
2025-03-09 07:10:35,835 [INFO]: 		-> Train: 16.7 minutes
2025-03-09 07:10:35,835 [INFO]: 		-> Add: 1.8 seconds
2025-03-09 07:10:35,835 [INFO]: 		Total: 16.7 minutes
2025-03-09 07:10:35,835 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0002 secs
2025-03-09 07:10:35,835 [INFO]: 	Checking that your have enough memory available to create the index 03/09/2025, 07:10:35
2025-03-09 07:10:35,835 [INFO]: 668.2MB of memory will be needed to build the index (more might be used if you have more)
2025-03-09 07:10:35,835 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0001 secs
2025-03-09 07:10:35,835 [INFO]: 	Selecting most promising index types given data characteristics 03/09/2025, 07:10:35
2025-03-09 07:10:35,835 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-09 07:10:35,835 [INFO]: 	Creating the index 03/09/2025, 07:10:35
2025-03-09 07:10:35,835 [INFO]: 		-> Instanciate the index HNSW15 03/09/2025, 07:10:35
2025-03-09 07:10:35,836 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0008 secs
2025-03-09 07:10:35,836 [INFO]: 		-> Adding the vectors to the index 03/09/2025, 07:10:35
2025-03-09 07:10:35,836 [INFO]: The memory available for adding the vectors is 49.4GB(total available - used by the index)
2025-03-09 07:10:35,836 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/13 [00:00<?, ?it/s]  8%|▊         | 1/13 [00:00<00:02,  5.33it/s] 23%|██▎       | 3/13 [00:00<00:01,  9.03it/s] 38%|███▊      | 5/13 [00:00<00:00, 10.22it/s] 54%|█████▍    | 7/13 [00:00<00:00, 10.74it/s] 69%|██████▉   | 9/13 [00:00<00:00, 11.07it/s] 85%|████████▍ | 11/13 [00:01<00:00, 11.21it/s]100%|██████████| 13/13 [00:03<00:00,  2.15it/s]100%|██████████| 13/13 [00:03<00:00,  3.74it/s]
2025-03-09 07:10:39,321 [INFO]: 	Computing best hyperparameters for index knn.index 03/09/2025, 07:10:39
2025-03-09 07:11:10,333 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 31.0117 secs
2025-03-09 07:11:10,333 [INFO]: The best hyperparameters are: efSearch=199
2025-03-09 07:11:10,334 [INFO]: 	Compute fast metrics 03/09/2025, 07:11:10
  0%|          | 0/4 [00:00<?, ?it/s] 25%|██▌       | 1/4 [00:00<00:00,  5.21it/s] 50%|█████     | 2/4 [00:00<00:00,  6.76it/s] 75%|███████▌  | 3/4 [00:00<00:00,  7.60it/s] 75%|███████▌  | 3/4 [00:00<00:00,  5.77it/s]
2025-03-09 07:11:24,341 [INFO]: 	>>> Finished "Compute fast metrics" in 14.0071 secs
2025-03-09 07:11:24,343 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 48.5074 secs
2025-03-09 07:11:24,344 [INFO]: {
2025-03-09 07:11:24,344 [INFO]: 	index_key: HNSW15
2025-03-09 07:11:24,344 [INFO]: 	index_param: efSearch=199
2025-03-09 07:11:24,344 [INFO]: 	index_path: knn.index
2025-03-09 07:11:24,344 [INFO]: 	size in bytes: 637056790
2025-03-09 07:11:24,344 [INFO]: 	avg_search_speed_ms: 10.405893266272734
2025-03-09 07:11:24,344 [INFO]: 	99p_search_speed_ms: 19.335350114852186
2025-03-09 07:11:24,344 [INFO]: 	reconstruction error %: 0.0
2025-03-09 07:11:24,344 [INFO]: 	nb vectors: 3238
2025-03-09 07:11:24,344 [INFO]: 	vectors dimension: 49152
2025-03-09 07:11:24,344 [INFO]: 	compression ratio: 0.9993091887459515
2025-03-09 07:11:24,344 [INFO]: }
2025-03-09 07:11:24,344 [INFO]: 	>>> Finished "Creating the index" in 48.5086 secs
2025-03-09 07:11:24,344 [INFO]: >>> Finished "Launching the whole pipeline" in 48.5348 secs
2025-03-09 07:11:25: [retrieval_preprocessing] calculating distances ...
2025-03-09 07:11:25: [retrieval_preprocessing] finished and saved retrieval indices for episode 59920 [episode count 4/20]
[retrieval_preprocessing] for episode 75282 [episode count 5/20], we have num_retrieval=np.int64(3220) num_query=np.int64(175)
2025-03-09 07:11:26,692 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-09 07:11:27,288 [INFO]: Launching the whole pipeline 03/09/2025, 07:11:27
2025-03-09 07:11:27,288 [INFO]: Reading total number of vectors and dimension 03/09/2025, 07:11:27
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1319.79it/s]
2025-03-09 07:11:27,312 [INFO]: There are 3220 embeddings of dim 49152
2025-03-09 07:11:27,312 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0247 secs
2025-03-09 07:11:27,313 [INFO]: 	Compute estimated construction time of the index 03/09/2025, 07:11:27
2025-03-09 07:11:27,313 [INFO]: 		-> Train: 16.7 minutes
2025-03-09 07:11:27,313 [INFO]: 		-> Add: 1.8 seconds
2025-03-09 07:11:27,313 [INFO]: 		Total: 16.7 minutes
2025-03-09 07:11:27,313 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0001 secs
2025-03-09 07:11:27,313 [INFO]: 	Checking that your have enough memory available to create the index 03/09/2025, 07:11:27
2025-03-09 07:11:27,313 [INFO]: 664.5MB of memory will be needed to build the index (more might be used if you have more)
2025-03-09 07:11:27,313 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0001 secs
2025-03-09 07:11:27,313 [INFO]: 	Selecting most promising index types given data characteristics 03/09/2025, 07:11:27
2025-03-09 07:11:27,313 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-09 07:11:27,313 [INFO]: 	Creating the index 03/09/2025, 07:11:27
2025-03-09 07:11:27,313 [INFO]: 		-> Instanciate the index HNSW15 03/09/2025, 07:11:27
2025-03-09 07:11:27,314 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0008 secs
2025-03-09 07:11:27,314 [INFO]: 		-> Adding the vectors to the index 03/09/2025, 07:11:27
2025-03-09 07:11:27,314 [INFO]: The memory available for adding the vectors is 49.4GB(total available - used by the index)
2025-03-09 07:11:27,314 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/13 [00:00<?, ?it/s]  8%|▊         | 1/13 [00:00<00:01,  6.09it/s] 23%|██▎       | 3/13 [00:00<00:01,  9.32it/s] 38%|███▊      | 5/13 [00:00<00:00, 10.18it/s] 54%|█████▍    | 7/13 [00:00<00:00, 10.85it/s] 69%|██████▉   | 9/13 [00:00<00:00, 11.15it/s] 85%|████████▍ | 11/13 [00:01<00:00, 11.24it/s]100%|██████████| 13/13 [00:03<00:00,  2.16it/s]100%|██████████| 13/13 [00:03<00:00,  3.76it/s]
2025-03-09 07:11:30,783 [INFO]: 	Computing best hyperparameters for index knn.index 03/09/2025, 07:11:30
2025-03-09 07:12:04,000 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 33.2172 secs
2025-03-09 07:12:04,001 [INFO]: The best hyperparameters are: efSearch=211
2025-03-09 07:12:04,001 [INFO]: 	Compute fast metrics 03/09/2025, 07:12:04
  0%|          | 0/4 [00:00<?, ?it/s] 25%|██▌       | 1/4 [00:02<00:07,  2.54s/it] 50%|█████     | 2/4 [00:03<00:03,  1.75s/it] 75%|███████▌  | 3/4 [00:05<00:01,  1.53s/it] 75%|███████▌  | 3/4 [00:05<00:01,  1.94s/it]
2025-03-09 07:12:22,018 [INFO]: 	>>> Finished "Compute fast metrics" in 18.0175 secs
2025-03-09 07:12:22,020 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 54.7066 secs
2025-03-09 07:12:22,021 [INFO]: {
2025-03-09 07:12:22,021 [INFO]: 	index_key: HNSW15
2025-03-09 07:12:22,021 [INFO]: 	index_param: efSearch=211
2025-03-09 07:12:22,021 [INFO]: 	index_path: knn.index
2025-03-09 07:12:22,021 [INFO]: 	size in bytes: 633515050
2025-03-09 07:12:22,021 [INFO]: 	avg_search_speed_ms: 9.362051506310506
2025-03-09 07:12:22,021 [INFO]: 	99p_search_speed_ms: 13.258589438628402
2025-03-09 07:12:22,021 [INFO]: 	reconstruction error %: 0.0
2025-03-09 07:12:22,021 [INFO]: 	nb vectors: 3220
2025-03-09 07:12:22,021 [INFO]: 	vectors dimension: 49152
2025-03-09 07:12:22,021 [INFO]: 	compression ratio: 0.9993097401553444
2025-03-09 07:12:22,021 [INFO]: }
2025-03-09 07:12:22,021 [INFO]: 	>>> Finished "Creating the index" in 54.7078 secs
2025-03-09 07:12:22,021 [INFO]: >>> Finished "Launching the whole pipeline" in 54.7331 secs
2025-03-09 07:12:22: [retrieval_preprocessing] calculating distances ...
2025-03-09 07:12:23: [retrieval_preprocessing] finished and saved retrieval indices for episode 75282 [episode count 5/20]
[retrieval_preprocessing] for episode 35355 [episode count 6/20], we have num_retrieval=np.int64(3059) num_query=np.int64(336)
2025-03-09 07:12:24,543 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-09 07:12:25,038 [INFO]: Launching the whole pipeline 03/09/2025, 07:12:25
2025-03-09 07:12:25,038 [INFO]: Reading total number of vectors and dimension 03/09/2025, 07:12:25
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 795.13it/s]
2025-03-09 07:12:25,066 [INFO]: There are 3059 embeddings of dim 49152
2025-03-09 07:12:25,066 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0278 secs
2025-03-09 07:12:25,066 [INFO]: 	Compute estimated construction time of the index 03/09/2025, 07:12:25
2025-03-09 07:12:25,066 [INFO]: 		-> Train: 16.7 minutes
2025-03-09 07:12:25,067 [INFO]: 		-> Add: 1.7 seconds
2025-03-09 07:12:25,067 [INFO]: 		Total: 16.7 minutes
2025-03-09 07:12:25,067 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0006 secs
2025-03-09 07:12:25,067 [INFO]: 	Checking that your have enough memory available to create the index 03/09/2025, 07:12:25
2025-03-09 07:12:25,067 [INFO]: 631.3MB of memory will be needed to build the index (more might be used if you have more)
2025-03-09 07:12:25,068 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0005 secs
2025-03-09 07:12:25,068 [INFO]: 	Selecting most promising index types given data characteristics 03/09/2025, 07:12:25
2025-03-09 07:12:25,068 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-09 07:12:25,068 [INFO]: 	Creating the index 03/09/2025, 07:12:25
2025-03-09 07:12:25,068 [INFO]: 		-> Instanciate the index HNSW15 03/09/2025, 07:12:25
2025-03-09 07:12:25,071 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0028 secs
2025-03-09 07:12:25,071 [INFO]: 		-> Adding the vectors to the index 03/09/2025, 07:12:25
2025-03-09 07:12:25,072 [INFO]: The memory available for adding the vectors is 49.4GB(total available - used by the index)
2025-03-09 07:12:25,072 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/13 [00:00<?, ?it/s]  8%|▊         | 1/13 [00:00<00:02,  4.96it/s] 15%|█▌        | 2/13 [00:00<00:01,  6.45it/s] 23%|██▎       | 3/13 [00:00<00:01,  6.85it/s] 31%|███       | 4/13 [00:00<00:01,  7.08it/s] 38%|███▊      | 5/13 [00:00<00:01,  7.25it/s] 46%|████▌     | 6/13 [00:00<00:00,  7.39it/s] 54%|█████▍    | 7/13 [00:00<00:00,  7.58it/s] 62%|██████▏   | 8/13 [00:01<00:00,  7.76it/s] 69%|██████▉   | 9/13 [00:01<00:00,  7.94it/s] 77%|███████▋  | 10/13 [00:01<00:00,  8.06it/s] 85%|████████▍ | 11/13 [00:01<00:00,  8.14it/s] 92%|█████████▏| 12/13 [00:01<00:00,  8.31it/s]100%|██████████| 13/13 [00:03<00:00,  1.40it/s]100%|██████████| 13/13 [00:03<00:00,  3.55it/s]
2025-03-09 07:12:28,735 [INFO]: 	Computing best hyperparameters for index knn.index 03/09/2025, 07:12:28
2025-03-09 07:13:02,004 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 33.2686 secs
2025-03-09 07:13:02,004 [INFO]: The best hyperparameters are: efSearch=222
2025-03-09 07:13:02,004 [INFO]: 	Compute fast metrics 03/09/2025, 07:13:02
  0%|          | 0/4 [00:00<?, ?it/s] 25%|██▌       | 1/4 [00:00<00:00,  5.12it/s] 50%|█████     | 2/4 [00:00<00:00,  6.65it/s] 75%|███████▌  | 3/4 [00:00<00:00,  7.37it/s] 75%|███████▌  | 3/4 [00:00<00:00,  5.55it/s]
2025-03-09 07:13:17,001 [INFO]: 	>>> Finished "Compute fast metrics" in 14.9966 secs
2025-03-09 07:13:17,004 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 51.9323 secs
2025-03-09 07:13:17,004 [INFO]: {
2025-03-09 07:13:17,004 [INFO]: 	index_key: HNSW15
2025-03-09 07:13:17,004 [INFO]: 	index_param: efSearch=222
2025-03-09 07:13:17,004 [INFO]: 	index_path: knn.index
2025-03-09 07:13:17,004 [INFO]: 	size in bytes: 601839250
2025-03-09 07:13:17,004 [INFO]: 	avg_search_speed_ms: 9.325906693407182
2025-03-09 07:13:17,004 [INFO]: 	99p_search_speed_ms: 16.111014564521522
2025-03-09 07:13:17,004 [INFO]: 	reconstruction error %: 0.0
2025-03-09 07:13:17,004 [INFO]: 	nb vectors: 3059
2025-03-09 07:13:17,004 [INFO]: 	vectors dimension: 49152
2025-03-09 07:13:17,004 [INFO]: 	compression ratio: 0.9993098190255952
2025-03-09 07:13:17,004 [INFO]: }
2025-03-09 07:13:17,004 [INFO]: 	>>> Finished "Creating the index" in 51.9361 secs
2025-03-09 07:13:17,004 [INFO]: >>> Finished "Launching the whole pipeline" in 51.9658 secs
2025-03-09 07:13:18: [retrieval_preprocessing] calculating distances ...
2025-03-09 07:13:19: [retrieval_preprocessing] finished and saved retrieval indices for episode 35355 [episode count 6/20]
[retrieval_preprocessing] for episode 61467 [episode count 7/20], we have num_retrieval=np.int64(3261) num_query=np.int64(134)
2025-03-09 07:13:20,136 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-09 07:13:20,591 [INFO]: Launching the whole pipeline 03/09/2025, 07:13:20
2025-03-09 07:13:20,591 [INFO]: Reading total number of vectors and dimension 03/09/2025, 07:13:20
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1520.23it/s]
2025-03-09 07:13:20,615 [INFO]: There are 3261 embeddings of dim 49152
2025-03-09 07:13:20,615 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0237 secs
2025-03-09 07:13:20,615 [INFO]: 	Compute estimated construction time of the index 03/09/2025, 07:13:20
2025-03-09 07:13:20,615 [INFO]: 		-> Train: 16.7 minutes
2025-03-09 07:13:20,615 [INFO]: 		-> Add: 1.8 seconds
2025-03-09 07:13:20,615 [INFO]: 		Total: 16.7 minutes
2025-03-09 07:13:20,615 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0001 secs
2025-03-09 07:13:20,615 [INFO]: 	Checking that your have enough memory available to create the index 03/09/2025, 07:13:20
2025-03-09 07:13:20,615 [INFO]: 673.0MB of memory will be needed to build the index (more might be used if you have more)
2025-03-09 07:13:20,615 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0001 secs
2025-03-09 07:13:20,616 [INFO]: 	Selecting most promising index types given data characteristics 03/09/2025, 07:13:20
2025-03-09 07:13:20,616 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-09 07:13:20,616 [INFO]: 	Creating the index 03/09/2025, 07:13:20
2025-03-09 07:13:20,616 [INFO]: 		-> Instanciate the index HNSW15 03/09/2025, 07:13:20
2025-03-09 07:13:20,616 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0007 secs
2025-03-09 07:13:20,617 [INFO]: 		-> Adding the vectors to the index 03/09/2025, 07:13:20
2025-03-09 07:13:20,617 [INFO]: The memory available for adding the vectors is 49.4GB(total available - used by the index)
2025-03-09 07:13:20,617 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/13 [00:00<?, ?it/s]  8%|▊         | 1/13 [00:00<00:02,  5.82it/s] 38%|███▊      | 5/13 [00:00<00:00, 19.04it/s] 62%|██████▏   | 8/13 [00:00<00:00, 20.53it/s] 85%|████████▍ | 11/13 [00:00<00:00, 20.06it/s]100%|██████████| 13/13 [00:02<00:00,  4.36it/s]
2025-03-09 07:13:23,602 [INFO]: 	Computing best hyperparameters for index knn.index 03/09/2025, 07:13:23
2025-03-09 07:13:57,143 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 33.5406 secs
2025-03-09 07:13:57,144 [INFO]: The best hyperparameters are: efSearch=234
2025-03-09 07:13:57,144 [INFO]: 	Compute fast metrics 03/09/2025, 07:13:57
  0%|          | 0/4 [00:00<?, ?it/s] 25%|██▌       | 1/4 [00:00<00:00,  5.88it/s] 75%|███████▌  | 3/4 [00:00<00:00,  8.21it/s] 75%|███████▌  | 3/4 [00:00<00:00,  6.35it/s]
2025-03-09 07:14:11,276 [INFO]: 	>>> Finished "Compute fast metrics" in 14.1326 secs
2025-03-09 07:14:11,278 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 50.6618 secs
2025-03-09 07:14:11,278 [INFO]: {
2025-03-09 07:14:11,279 [INFO]: 	index_key: HNSW15
2025-03-09 07:14:11,279 [INFO]: 	index_param: efSearch=234
2025-03-09 07:14:11,279 [INFO]: 	index_path: knn.index
2025-03-09 07:14:11,279 [INFO]: 	size in bytes: 641581990
2025-03-09 07:14:11,279 [INFO]: 	avg_search_speed_ms: 10.278829804861886
2025-03-09 07:14:11,279 [INFO]: 	99p_search_speed_ms: 13.762214640155433
2025-03-09 07:14:11,279 [INFO]: 	reconstruction error %: 0.0
2025-03-09 07:14:11,279 [INFO]: 	nb vectors: 3261
2025-03-09 07:14:11,279 [INFO]: 	vectors dimension: 49152
2025-03-09 07:14:11,279 [INFO]: 	compression ratio: 0.9993090485597952
2025-03-09 07:14:11,279 [INFO]: }
2025-03-09 07:14:11,279 [INFO]: 	>>> Finished "Creating the index" in 50.6630 secs
2025-03-09 07:14:11,279 [INFO]: >>> Finished "Launching the whole pipeline" in 50.6873 secs
2025-03-09 07:14:12: [retrieval_preprocessing] calculating distances ...
2025-03-09 07:14:12: [retrieval_preprocessing] finished and saved retrieval indices for episode 61467 [episode count 7/20]
[retrieval_preprocessing] for episode 24095 [episode count 8/20], we have num_retrieval=np.int64(3210) num_query=np.int64(185)
2025-03-09 07:14:13,657 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-09 07:14:14,235 [INFO]: Launching the whole pipeline 03/09/2025, 07:14:14
2025-03-09 07:14:14,235 [INFO]: Reading total number of vectors and dimension 03/09/2025, 07:14:14
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1559.80it/s]
2025-03-09 07:14:14,260 [INFO]: There are 3210 embeddings of dim 49152
2025-03-09 07:14:14,260 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0251 secs
2025-03-09 07:14:14,260 [INFO]: 	Compute estimated construction time of the index 03/09/2025, 07:14:14
2025-03-09 07:14:14,260 [INFO]: 		-> Train: 16.7 minutes
2025-03-09 07:14:14,260 [INFO]: 		-> Add: 1.8 seconds
2025-03-09 07:14:14,260 [INFO]: 		Total: 16.7 minutes
2025-03-09 07:14:14,260 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0001 secs
2025-03-09 07:14:14,260 [INFO]: 	Checking that your have enough memory available to create the index 03/09/2025, 07:14:14
2025-03-09 07:14:14,261 [INFO]: 662.5MB of memory will be needed to build the index (more might be used if you have more)
2025-03-09 07:14:14,261 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0001 secs
2025-03-09 07:14:14,261 [INFO]: 	Selecting most promising index types given data characteristics 03/09/2025, 07:14:14
2025-03-09 07:14:14,261 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-09 07:14:14,261 [INFO]: 	Creating the index 03/09/2025, 07:14:14
2025-03-09 07:14:14,261 [INFO]: 		-> Instanciate the index HNSW15 03/09/2025, 07:14:14
2025-03-09 07:14:14,262 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0011 secs
2025-03-09 07:14:14,262 [INFO]: 		-> Adding the vectors to the index 03/09/2025, 07:14:14
2025-03-09 07:14:14,262 [INFO]: The memory available for adding the vectors is 49.4GB(total available - used by the index)
2025-03-09 07:14:14,262 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/13 [00:00<?, ?it/s]  8%|▊         | 1/13 [00:00<00:01,  6.06it/s] 23%|██▎       | 3/13 [00:00<00:01,  9.45it/s] 38%|███▊      | 5/13 [00:00<00:00, 10.44it/s] 54%|█████▍    | 7/13 [00:00<00:00, 11.03it/s] 69%|██████▉   | 9/13 [00:00<00:00, 11.28it/s] 85%|████████▍ | 11/13 [00:01<00:00, 11.43it/s]100%|██████████| 13/13 [00:03<00:00,  2.16it/s]100%|██████████| 13/13 [00:03<00:00,  3.78it/s]
2025-03-09 07:14:17,706 [INFO]: 	Computing best hyperparameters for index knn.index 03/09/2025, 07:14:17
2025-03-09 07:14:49,275 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 31.5687 secs
2025-03-09 07:14:49,275 [INFO]: The best hyperparameters are: efSearch=221
2025-03-09 07:14:49,275 [INFO]: 	Compute fast metrics 03/09/2025, 07:14:49
  0%|          | 0/4 [00:00<?, ?it/s] 25%|██▌       | 1/4 [00:00<00:00,  5.11it/s] 50%|█████     | 2/4 [00:00<00:00,  6.48it/s] 75%|███████▌  | 3/4 [00:00<00:00,  7.02it/s] 75%|███████▌  | 3/4 [00:00<00:00,  5.28it/s]
2025-03-09 07:15:03,090 [INFO]: 	>>> Finished "Compute fast metrics" in 13.8143 secs
2025-03-09 07:15:03,092 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 48.8300 secs
2025-03-09 07:15:03,092 [INFO]: {
2025-03-09 07:15:03,092 [INFO]: 	index_key: HNSW15
2025-03-09 07:15:03,092 [INFO]: 	index_param: efSearch=221
2025-03-09 07:15:03,092 [INFO]: 	index_path: knn.index
2025-03-09 07:15:03,092 [INFO]: 	size in bytes: 631547590
2025-03-09 07:15:03,092 [INFO]: 	avg_search_speed_ms: 11.208757030675313
2025-03-09 07:15:03,092 [INFO]: 	99p_search_speed_ms: 18.76191696617754
2025-03-09 07:15:03,092 [INFO]: 	reconstruction error %: 0.0
2025-03-09 07:15:03,092 [INFO]: 	nb vectors: 3210
2025-03-09 07:15:03,092 [INFO]: 	vectors dimension: 49152
2025-03-09 07:15:03,092 [INFO]: 	compression ratio: 0.9993097748975656
2025-03-09 07:15:03,092 [INFO]: }
2025-03-09 07:15:03,092 [INFO]: 	>>> Finished "Creating the index" in 48.8315 secs
2025-03-09 07:15:03,092 [INFO]: >>> Finished "Launching the whole pipeline" in 48.8572 secs
2025-03-09 07:15:03: [retrieval_preprocessing] calculating distances ...
2025-03-09 07:15:04: [retrieval_preprocessing] finished and saved retrieval indices for episode 24095 [episode count 8/20]
[retrieval_preprocessing] for episode 92709 [episode count 9/20], we have num_retrieval=np.int64(3272) num_query=np.int64(123)
2025-03-09 07:15:05,414 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-09 07:15:05,865 [INFO]: Launching the whole pipeline 03/09/2025, 07:15:05
2025-03-09 07:15:05,865 [INFO]: Reading total number of vectors and dimension 03/09/2025, 07:15:05
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1400.90it/s]
2025-03-09 07:15:05,889 [INFO]: There are 3272 embeddings of dim 49152
2025-03-09 07:15:05,889 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0244 secs
2025-03-09 07:15:05,889 [INFO]: 	Compute estimated construction time of the index 03/09/2025, 07:15:05
2025-03-09 07:15:05,889 [INFO]: 		-> Train: 16.7 minutes
2025-03-09 07:15:05,889 [INFO]: 		-> Add: 1.8 seconds
2025-03-09 07:15:05,889 [INFO]: 		Total: 16.7 minutes
2025-03-09 07:15:05,889 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0001 secs
2025-03-09 07:15:05,889 [INFO]: 	Checking that your have enough memory available to create the index 03/09/2025, 07:15:05
2025-03-09 07:15:05,890 [INFO]: 675.3MB of memory will be needed to build the index (more might be used if you have more)
2025-03-09 07:15:05,890 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0002 secs
2025-03-09 07:15:05,890 [INFO]: 	Selecting most promising index types given data characteristics 03/09/2025, 07:15:05
2025-03-09 07:15:05,890 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-09 07:15:05,890 [INFO]: 	Creating the index 03/09/2025, 07:15:05
2025-03-09 07:15:05,890 [INFO]: 		-> Instanciate the index HNSW15 03/09/2025, 07:15:05
2025-03-09 07:15:05,891 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0010 secs
2025-03-09 07:15:05,891 [INFO]: 		-> Adding the vectors to the index 03/09/2025, 07:15:05
2025-03-09 07:15:05,891 [INFO]: The memory available for adding the vectors is 49.4GB(total available - used by the index)
2025-03-09 07:15:05,891 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/13 [00:00<?, ?it/s]  8%|▊         | 1/13 [00:00<00:02,  5.50it/s] 31%|███       | 4/13 [00:00<00:00, 14.80it/s] 54%|█████▍    | 7/13 [00:00<00:00, 17.40it/s] 69%|██████▉   | 9/13 [00:00<00:00, 16.20it/s] 85%|████████▍ | 11/13 [00:00<00:00, 16.24it/s]100%|██████████| 13/13 [00:03<00:00,  2.17it/s]100%|██████████| 13/13 [00:03<00:00,  3.88it/s]
2025-03-09 07:15:09,249 [INFO]: 	Computing best hyperparameters for index knn.index 03/09/2025, 07:15:09
2025-03-09 07:15:41,356 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 32.1064 secs
2025-03-09 07:15:41,356 [INFO]: The best hyperparameters are: efSearch=188
2025-03-09 07:15:41,356 [INFO]: 	Compute fast metrics 03/09/2025, 07:15:41
  0%|          | 0/4 [00:00<?, ?it/s] 25%|██▌       | 1/4 [00:00<00:00,  5.84it/s] 75%|███████▌  | 3/4 [00:00<00:00,  9.29it/s] 75%|███████▌  | 3/4 [00:00<00:00,  7.10it/s]
2025-03-09 07:15:54,135 [INFO]: 	>>> Finished "Compute fast metrics" in 12.7783 secs
2025-03-09 07:15:54,137 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 48.2458 secs
2025-03-09 07:15:54,137 [INFO]: {
2025-03-09 07:15:54,137 [INFO]: 	index_key: HNSW15
2025-03-09 07:15:54,137 [INFO]: 	index_param: efSearch=188
2025-03-09 07:15:54,137 [INFO]: 	index_path: knn.index
2025-03-09 07:15:54,137 [INFO]: 	size in bytes: 643746190
2025-03-09 07:15:54,137 [INFO]: 	avg_search_speed_ms: 8.871389821728735
2025-03-09 07:15:54,137 [INFO]: 	99p_search_speed_ms: 14.178455178625882
2025-03-09 07:15:54,137 [INFO]: 	reconstruction error %: 0.0
2025-03-09 07:15:54,137 [INFO]: 	nb vectors: 3272
2025-03-09 07:15:54,137 [INFO]: 	vectors dimension: 49152
2025-03-09 07:15:54,137 [INFO]: 	compression ratio: 0.9993090227066043
2025-03-09 07:15:54,137 [INFO]: }
2025-03-09 07:15:54,137 [INFO]: 	>>> Finished "Creating the index" in 48.2474 secs
2025-03-09 07:15:54,137 [INFO]: >>> Finished "Launching the whole pipeline" in 48.2724 secs
2025-03-09 07:15:54: [retrieval_preprocessing] calculating distances ...
2025-03-09 07:15:55: [retrieval_preprocessing] finished and saved retrieval indices for episode 92709 [episode count 9/20]
[retrieval_preprocessing] for episode 27174 [episode count 10/20], we have num_retrieval=np.int64(3231) num_query=np.int64(164)
2025-03-09 07:15:56,118 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-09 07:15:56,601 [INFO]: Launching the whole pipeline 03/09/2025, 07:15:56
2025-03-09 07:15:56,601 [INFO]: Reading total number of vectors and dimension 03/09/2025, 07:15:56
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1520.23it/s]
2025-03-09 07:15:56,627 [INFO]: There are 3231 embeddings of dim 49152
2025-03-09 07:15:56,627 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0257 secs
2025-03-09 07:15:56,627 [INFO]: 	Compute estimated construction time of the index 03/09/2025, 07:15:56
2025-03-09 07:15:56,627 [INFO]: 		-> Train: 16.7 minutes
2025-03-09 07:15:56,627 [INFO]: 		-> Add: 1.8 seconds
2025-03-09 07:15:56,627 [INFO]: 		Total: 16.7 minutes
2025-03-09 07:15:56,627 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0001 secs
2025-03-09 07:15:56,627 [INFO]: 	Checking that your have enough memory available to create the index 03/09/2025, 07:15:56
2025-03-09 07:15:56,628 [INFO]: 666.8MB of memory will be needed to build the index (more might be used if you have more)
2025-03-09 07:15:56,628 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0001 secs
2025-03-09 07:15:56,628 [INFO]: 	Selecting most promising index types given data characteristics 03/09/2025, 07:15:56
2025-03-09 07:15:56,628 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-09 07:15:56,628 [INFO]: 	Creating the index 03/09/2025, 07:15:56
2025-03-09 07:15:56,628 [INFO]: 		-> Instanciate the index HNSW15 03/09/2025, 07:15:56
2025-03-09 07:15:56,629 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0011 secs
2025-03-09 07:15:56,629 [INFO]: 		-> Adding the vectors to the index 03/09/2025, 07:15:56
2025-03-09 07:15:56,629 [INFO]: The memory available for adding the vectors is 49.4GB(total available - used by the index)
2025-03-09 07:15:56,629 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/13 [00:00<?, ?it/s]  8%|▊         | 1/13 [00:00<00:01,  7.62it/s] 23%|██▎       | 3/13 [00:00<00:00, 11.49it/s] 38%|███▊      | 5/13 [00:00<00:00, 11.55it/s] 54%|█████▍    | 7/13 [00:00<00:00, 12.68it/s] 69%|██████▉   | 9/13 [00:00<00:00, 12.79it/s] 85%|████████▍ | 11/13 [00:00<00:00, 12.68it/s]100%|██████████| 13/13 [00:03<00:00,  2.15it/s]100%|██████████| 13/13 [00:03<00:00,  3.85it/s]
2025-03-09 07:16:00,011 [INFO]: 	Computing best hyperparameters for index knn.index 03/09/2025, 07:16:00
2025-03-09 07:16:32,284 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 32.2727 secs
2025-03-09 07:16:32,284 [INFO]: The best hyperparameters are: efSearch=235
2025-03-09 07:16:32,284 [INFO]: 	Compute fast metrics 03/09/2025, 07:16:32
  0%|          | 0/4 [00:00<?, ?it/s] 25%|██▌       | 1/4 [00:00<00:00,  6.13it/s] 75%|███████▌  | 3/4 [00:00<00:00,  8.69it/s] 75%|███████▌  | 3/4 [00:00<00:00,  7.11it/s]
2025-03-09 07:16:45,067 [INFO]: 	>>> Finished "Compute fast metrics" in 12.7831 secs
2025-03-09 07:16:45,070 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 48.4407 secs
2025-03-09 07:16:45,070 [INFO]: {
2025-03-09 07:16:45,070 [INFO]: 	index_key: HNSW15
2025-03-09 07:16:45,070 [INFO]: 	index_param: efSearch=235
2025-03-09 07:16:45,070 [INFO]: 	index_path: knn.index
2025-03-09 07:16:45,070 [INFO]: 	size in bytes: 635679490
2025-03-09 07:16:45,070 [INFO]: 	avg_search_speed_ms: 10.416064630165542
2025-03-09 07:16:45,070 [INFO]: 	99p_search_speed_ms: 18.164187718648463
2025-03-09 07:16:45,070 [INFO]: 	reconstruction error %: 0.0
2025-03-09 07:16:45,070 [INFO]: 	nb vectors: 3231
2025-03-09 07:16:45,070 [INFO]: 	vectors dimension: 49152
2025-03-09 07:16:45,070 [INFO]: 	compression ratio: 0.9993093343313625
2025-03-09 07:16:45,070 [INFO]: }
2025-03-09 07:16:45,070 [INFO]: 	>>> Finished "Creating the index" in 48.4422 secs
2025-03-09 07:16:45,070 [INFO]: >>> Finished "Launching the whole pipeline" in 48.4686 secs
2025-03-09 07:16:46: [retrieval_preprocessing] calculating distances ...
2025-03-09 07:16:46: [retrieval_preprocessing] finished and saved retrieval indices for episode 27174 [episode count 10/20]
[retrieval_preprocessing] for episode 47656 [episode count 11/20], we have num_retrieval=np.int64(3258) num_query=np.int64(137)
2025-03-09 07:16:47,720 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-09 07:16:48,170 [INFO]: Launching the whole pipeline 03/09/2025, 07:16:48
2025-03-09 07:16:48,170 [INFO]: Reading total number of vectors and dimension 03/09/2025, 07:16:48
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1334.49it/s]
2025-03-09 07:16:48,195 [INFO]: There are 3258 embeddings of dim 49152
2025-03-09 07:16:48,195 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0251 secs
2025-03-09 07:16:48,195 [INFO]: 	Compute estimated construction time of the index 03/09/2025, 07:16:48
2025-03-09 07:16:48,195 [INFO]: 		-> Train: 16.7 minutes
2025-03-09 07:16:48,195 [INFO]: 		-> Add: 1.8 seconds
2025-03-09 07:16:48,195 [INFO]: 		Total: 16.7 minutes
2025-03-09 07:16:48,195 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0001 secs
2025-03-09 07:16:48,195 [INFO]: 	Checking that your have enough memory available to create the index 03/09/2025, 07:16:48
2025-03-09 07:16:48,196 [INFO]: 672.4MB of memory will be needed to build the index (more might be used if you have more)
2025-03-09 07:16:48,196 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0001 secs
2025-03-09 07:16:48,196 [INFO]: 	Selecting most promising index types given data characteristics 03/09/2025, 07:16:48
2025-03-09 07:16:48,196 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-09 07:16:48,196 [INFO]: 	Creating the index 03/09/2025, 07:16:48
2025-03-09 07:16:48,196 [INFO]: 		-> Instanciate the index HNSW15 03/09/2025, 07:16:48
2025-03-09 07:16:48,197 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0010 secs
2025-03-09 07:16:48,197 [INFO]: 		-> Adding the vectors to the index 03/09/2025, 07:16:48
2025-03-09 07:16:48,197 [INFO]: The memory available for adding the vectors is 49.4GB(total available - used by the index)
2025-03-09 07:16:48,197 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/13 [00:00<?, ?it/s]  8%|▊         | 1/13 [00:00<00:02,  4.97it/s] 15%|█▌        | 2/13 [00:00<00:01,  6.52it/s] 23%|██▎       | 3/13 [00:00<00:01,  7.36it/s] 31%|███       | 4/13 [00:00<00:01,  7.75it/s] 38%|███▊      | 5/13 [00:00<00:01,  7.96it/s] 46%|████▌     | 6/13 [00:00<00:00,  8.01it/s] 54%|█████▍    | 7/13 [00:00<00:00,  8.16it/s] 69%|██████▉   | 9/13 [00:01<00:00, 10.49it/s] 85%|████████▍ | 11/13 [00:01<00:00, 10.07it/s]100%|██████████| 13/13 [00:03<00:00,  1.93it/s]100%|██████████| 13/13 [00:03<00:00,  3.49it/s]
2025-03-09 07:16:51,932 [INFO]: 	Computing best hyperparameters for index knn.index 03/09/2025, 07:16:51
2025-03-09 07:17:23,534 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 31.6014 secs
2025-03-09 07:17:23,534 [INFO]: The best hyperparameters are: efSearch=234
2025-03-09 07:17:23,534 [INFO]: 	Compute fast metrics 03/09/2025, 07:17:23
  0%|          | 0/4 [00:00<?, ?it/s] 25%|██▌       | 1/4 [00:00<00:00,  5.79it/s] 75%|███████▌  | 3/4 [00:00<00:00,  9.01it/s] 75%|███████▌  | 3/4 [00:00<00:00,  6.91it/s]
2025-03-09 07:17:37,035 [INFO]: 	>>> Finished "Compute fast metrics" in 13.5009 secs
2025-03-09 07:17:37,038 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 48.8412 secs
2025-03-09 07:17:37,038 [INFO]: {
2025-03-09 07:17:37,038 [INFO]: 	index_key: HNSW15
2025-03-09 07:17:37,038 [INFO]: 	index_param: efSearch=234
2025-03-09 07:17:37,038 [INFO]: 	index_path: knn.index
2025-03-09 07:17:37,038 [INFO]: 	size in bytes: 640991710
2025-03-09 07:17:37,038 [INFO]: 	avg_search_speed_ms: 10.834030398366446
2025-03-09 07:17:37,038 [INFO]: 	99p_search_speed_ms: 19.529385613277555
2025-03-09 07:17:37,038 [INFO]: 	reconstruction error %: 0.0
2025-03-09 07:17:37,038 [INFO]: 	nb vectors: 3258
2025-03-09 07:17:37,038 [INFO]: 	vectors dimension: 49152
2025-03-09 07:17:37,038 [INFO]: 	compression ratio: 0.9993091236702578
2025-03-09 07:17:37,038 [INFO]: }
2025-03-09 07:17:37,038 [INFO]: 	>>> Finished "Creating the index" in 48.8427 secs
2025-03-09 07:17:37,038 [INFO]: >>> Finished "Launching the whole pipeline" in 48.8684 secs
2025-03-09 07:17:38: [retrieval_preprocessing] calculating distances ...
2025-03-09 07:17:38: [retrieval_preprocessing] finished and saved retrieval indices for episode 47656 [episode count 11/20]
[retrieval_preprocessing] for episode 6186 [episode count 12/20], we have num_retrieval=np.int64(3260) num_query=np.int64(135)
2025-03-09 07:17:39,585 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-09 07:17:40,035 [INFO]: Launching the whole pipeline 03/09/2025, 07:17:40
2025-03-09 07:17:40,035 [INFO]: Reading total number of vectors and dimension 03/09/2025, 07:17:40
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1059.70it/s]
2025-03-09 07:17:40,060 [INFO]: There are 3260 embeddings of dim 49152
2025-03-09 07:17:40,060 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0250 secs
2025-03-09 07:17:40,060 [INFO]: 	Compute estimated construction time of the index 03/09/2025, 07:17:40
2025-03-09 07:17:40,060 [INFO]: 		-> Train: 16.7 minutes
2025-03-09 07:17:40,060 [INFO]: 		-> Add: 1.8 seconds
2025-03-09 07:17:40,060 [INFO]: 		Total: 16.7 minutes
2025-03-09 07:17:40,060 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0001 secs
2025-03-09 07:17:40,060 [INFO]: 	Checking that your have enough memory available to create the index 03/09/2025, 07:17:40
2025-03-09 07:17:40,060 [INFO]: 672.8MB of memory will be needed to build the index (more might be used if you have more)
2025-03-09 07:17:40,060 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0001 secs
2025-03-09 07:17:40,060 [INFO]: 	Selecting most promising index types given data characteristics 03/09/2025, 07:17:40
2025-03-09 07:17:40,060 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-09 07:17:40,060 [INFO]: 	Creating the index 03/09/2025, 07:17:40
2025-03-09 07:17:40,060 [INFO]: 		-> Instanciate the index HNSW15 03/09/2025, 07:17:40
2025-03-09 07:17:40,061 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0009 secs
2025-03-09 07:17:40,061 [INFO]: 		-> Adding the vectors to the index 03/09/2025, 07:17:40
2025-03-09 07:17:40,062 [INFO]: The memory available for adding the vectors is 49.4GB(total available - used by the index)
2025-03-09 07:17:40,062 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/13 [00:00<?, ?it/s]  8%|▊         | 1/13 [00:00<00:02,  5.62it/s] 23%|██▎       | 3/13 [00:00<00:00, 11.01it/s] 38%|███▊      | 5/13 [00:00<00:00, 12.96it/s] 54%|█████▍    | 7/13 [00:00<00:00, 12.42it/s] 69%|██████▉   | 9/13 [00:00<00:00, 12.16it/s] 85%|████████▍ | 11/13 [00:00<00:00, 12.01it/s]100%|██████████| 13/13 [00:03<00:00,  2.09it/s]100%|██████████| 13/13 [00:03<00:00,  3.74it/s]
2025-03-09 07:17:43,549 [INFO]: 	Computing best hyperparameters for index knn.index 03/09/2025, 07:17:43
2025-03-09 07:18:16,896 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 33.3470 secs
2025-03-09 07:18:16,896 [INFO]: The best hyperparameters are: efSearch=218
2025-03-09 07:18:16,896 [INFO]: 	Compute fast metrics 03/09/2025, 07:18:16
  0%|          | 0/4 [00:00<?, ?it/s] 25%|██▌       | 1/4 [00:00<00:00,  5.53it/s] 50%|█████     | 2/4 [00:00<00:00,  7.01it/s] 75%|███████▌  | 3/4 [00:00<00:00,  6.63it/s] 75%|███████▌  | 3/4 [00:00<00:00,  4.77it/s]
2025-03-09 07:18:30,518 [INFO]: 	>>> Finished "Compute fast metrics" in 13.6222 secs
2025-03-09 07:18:30,521 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 50.4594 secs
2025-03-09 07:18:30,521 [INFO]: {
2025-03-09 07:18:30,521 [INFO]: 	index_key: HNSW15
2025-03-09 07:18:30,521 [INFO]: 	index_param: efSearch=218
2025-03-09 07:18:30,521 [INFO]: 	index_path: knn.index
2025-03-09 07:18:30,521 [INFO]: 	size in bytes: 641385190
2025-03-09 07:18:30,521 [INFO]: 	avg_search_speed_ms: 10.796759307754606
2025-03-09 07:18:30,521 [INFO]: 	99p_search_speed_ms: 18.433473363984376
2025-03-09 07:18:30,521 [INFO]: 	reconstruction error %: 0.0
2025-03-09 07:18:30,521 [INFO]: 	nb vectors: 3260
2025-03-09 07:18:30,521 [INFO]: 	vectors dimension: 49152
2025-03-09 07:18:30,521 [INFO]: 	compression ratio: 0.9993091359031848
2025-03-09 07:18:30,521 [INFO]: }
2025-03-09 07:18:30,521 [INFO]: 	>>> Finished "Creating the index" in 50.4608 secs
2025-03-09 07:18:30,521 [INFO]: >>> Finished "Launching the whole pipeline" in 50.4863 secs
2025-03-09 07:18:31: [retrieval_preprocessing] calculating distances ...
2025-03-09 07:18:31: [retrieval_preprocessing] finished and saved retrieval indices for episode 6186 [episode count 12/20]
[retrieval_preprocessing] for episode 37933 [episode count 13/20], we have num_retrieval=np.int64(3142) num_query=np.int64(253)
2025-03-09 07:18:32,568 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-09 07:18:33,020 [INFO]: Launching the whole pipeline 03/09/2025, 07:18:33
2025-03-09 07:18:33,020 [INFO]: Reading total number of vectors and dimension 03/09/2025, 07:18:33
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1746.17it/s]
2025-03-09 07:18:33,043 [INFO]: There are 3142 embeddings of dim 49152
2025-03-09 07:18:33,043 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0231 secs
2025-03-09 07:18:33,044 [INFO]: 	Compute estimated construction time of the index 03/09/2025, 07:18:33
2025-03-09 07:18:33,044 [INFO]: 		-> Train: 16.7 minutes
2025-03-09 07:18:33,044 [INFO]: 		-> Add: 1.7 seconds
2025-03-09 07:18:33,044 [INFO]: 		Total: 16.7 minutes
2025-03-09 07:18:33,044 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0001 secs
2025-03-09 07:18:33,044 [INFO]: 	Checking that your have enough memory available to create the index 03/09/2025, 07:18:33
2025-03-09 07:18:33,044 [INFO]: 648.4MB of memory will be needed to build the index (more might be used if you have more)
2025-03-09 07:18:33,044 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0001 secs
2025-03-09 07:18:33,044 [INFO]: 	Selecting most promising index types given data characteristics 03/09/2025, 07:18:33
2025-03-09 07:18:33,044 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-09 07:18:33,044 [INFO]: 	Creating the index 03/09/2025, 07:18:33
2025-03-09 07:18:33,044 [INFO]: 		-> Instanciate the index HNSW15 03/09/2025, 07:18:33
2025-03-09 07:18:33,045 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0009 secs
2025-03-09 07:18:33,045 [INFO]: 		-> Adding the vectors to the index 03/09/2025, 07:18:33
2025-03-09 07:18:33,045 [INFO]: The memory available for adding the vectors is 49.4GB(total available - used by the index)
2025-03-09 07:18:33,045 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/13 [00:00<?, ?it/s]  8%|▊         | 1/13 [00:00<00:02,  5.16it/s] 23%|██▎       | 3/13 [00:00<00:00, 10.57it/s] 38%|███▊      | 5/13 [00:00<00:00, 10.61it/s] 54%|█████▍    | 7/13 [00:00<00:00, 10.27it/s] 69%|██████▉   | 9/13 [00:00<00:00, 10.22it/s] 85%|████████▍ | 11/13 [00:01<00:00, 10.20it/s]100%|██████████| 13/13 [00:03<00:00,  1.99it/s]100%|██████████| 13/13 [00:03<00:00,  3.49it/s]
2025-03-09 07:18:36,771 [INFO]: 	Computing best hyperparameters for index knn.index 03/09/2025, 07:18:36
2025-03-09 07:19:05,040 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 28.2691 secs
2025-03-09 07:19:05,041 [INFO]: The best hyperparameters are: efSearch=249
2025-03-09 07:19:05,041 [INFO]: 	Compute fast metrics 03/09/2025, 07:19:05
  0%|          | 0/4 [00:00<?, ?it/s] 25%|██▌       | 1/4 [00:00<00:00,  6.10it/s] 50%|█████     | 2/4 [00:00<00:00,  7.42it/s] 75%|███████▌  | 3/4 [00:00<00:00,  8.04it/s] 75%|███████▌  | 3/4 [00:00<00:00,  6.11it/s]
2025-03-09 07:19:18,831 [INFO]: 	>>> Finished "Compute fast metrics" in 13.7903 secs
2025-03-09 07:19:18,834 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 45.7887 secs
2025-03-09 07:19:18,834 [INFO]: {
2025-03-09 07:19:18,834 [INFO]: 	index_key: HNSW15
2025-03-09 07:19:18,834 [INFO]: 	index_param: efSearch=249
2025-03-09 07:19:18,834 [INFO]: 	index_path: knn.index
2025-03-09 07:19:18,834 [INFO]: 	size in bytes: 618169090
2025-03-09 07:19:18,834 [INFO]: 	avg_search_speed_ms: 10.182731594015937
2025-03-09 07:19:18,834 [INFO]: 	99p_search_speed_ms: 15.439157676883038
2025-03-09 07:19:18,834 [INFO]: 	reconstruction error %: 0.0
2025-03-09 07:19:18,834 [INFO]: 	nb vectors: 3142
2025-03-09 07:19:18,834 [INFO]: 	vectors dimension: 49152
2025-03-09 07:19:18,834 [INFO]: 	compression ratio: 0.9993096484329231
2025-03-09 07:19:18,834 [INFO]: }
2025-03-09 07:19:18,834 [INFO]: 	>>> Finished "Creating the index" in 45.7900 secs
2025-03-09 07:19:18,834 [INFO]: >>> Finished "Launching the whole pipeline" in 45.8136 secs
2025-03-09 07:19:20: [retrieval_preprocessing] calculating distances ...
2025-03-09 07:19:21: [retrieval_preprocessing] finished and saved retrieval indices for episode 37933 [episode count 13/20]
[retrieval_preprocessing] for episode 69678 [episode count 14/20], we have num_retrieval=np.int64(3200) num_query=np.int64(195)
2025-03-09 07:19:22,106 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-09 07:19:22,524 [INFO]: Launching the whole pipeline 03/09/2025, 07:19:22
2025-03-09 07:19:22,524 [INFO]: Reading total number of vectors and dimension 03/09/2025, 07:19:22
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1751.28it/s]
2025-03-09 07:19:22,550 [INFO]: There are 3200 embeddings of dim 49152
2025-03-09 07:19:22,550 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0256 secs
2025-03-09 07:19:22,550 [INFO]: 	Compute estimated construction time of the index 03/09/2025, 07:19:22
2025-03-09 07:19:22,550 [INFO]: 		-> Train: 16.7 minutes
2025-03-09 07:19:22,551 [INFO]: 		-> Add: 1.8 seconds
2025-03-09 07:19:22,551 [INFO]: 		Total: 16.7 minutes
2025-03-09 07:19:22,551 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0004 secs
2025-03-09 07:19:22,551 [INFO]: 	Checking that your have enough memory available to create the index 03/09/2025, 07:19:22
2025-03-09 07:19:22,551 [INFO]: 660.4MB of memory will be needed to build the index (more might be used if you have more)
2025-03-09 07:19:22,551 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0004 secs
2025-03-09 07:19:22,552 [INFO]: 	Selecting most promising index types given data characteristics 03/09/2025, 07:19:22
2025-03-09 07:19:22,552 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-09 07:19:22,552 [INFO]: 	Creating the index 03/09/2025, 07:19:22
2025-03-09 07:19:22,552 [INFO]: 		-> Instanciate the index HNSW15 03/09/2025, 07:19:22
2025-03-09 07:19:22,555 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0028 secs
2025-03-09 07:19:22,555 [INFO]: 		-> Adding the vectors to the index 03/09/2025, 07:19:22
2025-03-09 07:19:22,555 [INFO]: The memory available for adding the vectors is 49.4GB(total available - used by the index)
2025-03-09 07:19:22,555 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/13 [00:00<?, ?it/s]  8%|▊         | 1/13 [00:00<00:01,  6.65it/s] 23%|██▎       | 3/13 [00:00<00:01,  9.91it/s] 38%|███▊      | 5/13 [00:00<00:00, 11.39it/s] 62%|██████▏   | 8/13 [00:00<00:00, 13.74it/s] 77%|███████▋  | 10/13 [00:00<00:00, 12.98it/s] 92%|█████████▏| 12/13 [00:00<00:00, 12.69it/s]100%|██████████| 13/13 [00:03<00:00,  3.92it/s]
2025-03-09 07:19:25,875 [INFO]: 	Computing best hyperparameters for index knn.index 03/09/2025, 07:19:25
2025-03-09 07:19:56,998 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 31.1226 secs
2025-03-09 07:19:56,998 [INFO]: The best hyperparameters are: efSearch=217
2025-03-09 07:19:56,998 [INFO]: 	Compute fast metrics 03/09/2025, 07:19:56
  0%|          | 0/4 [00:00<?, ?it/s] 25%|██▌       | 1/4 [00:00<00:00,  5.52it/s] 75%|███████▌  | 3/4 [00:00<00:00,  7.98it/s] 75%|███████▌  | 3/4 [00:00<00:00,  6.25it/s]
2025-03-09 07:20:10,840 [INFO]: 	>>> Finished "Compute fast metrics" in 13.8414 secs
2025-03-09 07:20:10,842 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 48.2867 secs
2025-03-09 07:20:10,842 [INFO]: {
2025-03-09 07:20:10,842 [INFO]: 	index_key: HNSW15
2025-03-09 07:20:10,842 [INFO]: 	index_param: efSearch=217
2025-03-09 07:20:10,842 [INFO]: 	index_path: knn.index
2025-03-09 07:20:10,842 [INFO]: 	size in bytes: 629580130
2025-03-09 07:20:10,842 [INFO]: 	avg_search_speed_ms: 10.38618643211079
2025-03-09 07:20:10,842 [INFO]: 	99p_search_speed_ms: 20.251521999016404
2025-03-09 07:20:10,842 [INFO]: 	reconstruction error %: 0.0
2025-03-09 07:20:10,842 [INFO]: 	nb vectors: 3200
2025-03-09 07:20:10,842 [INFO]: 	vectors dimension: 49152
2025-03-09 07:20:10,842 [INFO]: 	compression ratio: 0.999309809856928
2025-03-09 07:20:10,842 [INFO]: }
2025-03-09 07:20:10,842 [INFO]: 	>>> Finished "Creating the index" in 48.2904 secs
2025-03-09 07:20:10,842 [INFO]: >>> Finished "Launching the whole pipeline" in 48.3177 secs
2025-03-09 07:20:11: [retrieval_preprocessing] calculating distances ...
2025-03-09 07:20:12: [retrieval_preprocessing] finished and saved retrieval indices for episode 69678 [episode count 14/20]
[retrieval_preprocessing] for episode 67121 [episode count 15/20], we have num_retrieval=np.int64(3212) num_query=np.int64(183)
2025-03-09 07:20:13,253 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-09 07:20:13,751 [INFO]: Launching the whole pipeline 03/09/2025, 07:20:13
2025-03-09 07:20:13,751 [INFO]: Reading total number of vectors and dimension 03/09/2025, 07:20:13
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1345.19it/s]
2025-03-09 07:20:13,775 [INFO]: There are 3212 embeddings of dim 49152
2025-03-09 07:20:13,775 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0244 secs
2025-03-09 07:20:13,775 [INFO]: 	Compute estimated construction time of the index 03/09/2025, 07:20:13
2025-03-09 07:20:13,775 [INFO]: 		-> Train: 16.7 minutes
2025-03-09 07:20:13,775 [INFO]: 		-> Add: 1.8 seconds
2025-03-09 07:20:13,775 [INFO]: 		Total: 16.7 minutes
2025-03-09 07:20:13,775 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0001 secs
2025-03-09 07:20:13,775 [INFO]: 	Checking that your have enough memory available to create the index 03/09/2025, 07:20:13
2025-03-09 07:20:13,776 [INFO]: 662.9MB of memory will be needed to build the index (more might be used if you have more)
2025-03-09 07:20:13,776 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0001 secs
2025-03-09 07:20:13,776 [INFO]: 	Selecting most promising index types given data characteristics 03/09/2025, 07:20:13
2025-03-09 07:20:13,776 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-09 07:20:13,776 [INFO]: 	Creating the index 03/09/2025, 07:20:13
2025-03-09 07:20:13,776 [INFO]: 		-> Instanciate the index HNSW15 03/09/2025, 07:20:13
2025-03-09 07:20:13,777 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0009 secs
2025-03-09 07:20:13,777 [INFO]: 		-> Adding the vectors to the index 03/09/2025, 07:20:13
2025-03-09 07:20:13,777 [INFO]: The memory available for adding the vectors is 49.4GB(total available - used by the index)
2025-03-09 07:20:13,777 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/13 [00:00<?, ?it/s]  8%|▊         | 1/13 [00:00<00:02,  5.83it/s] 15%|█▌        | 2/13 [00:00<00:01,  7.43it/s] 23%|██▎       | 3/13 [00:00<00:01,  8.32it/s] 31%|███       | 4/13 [00:00<00:01,  8.71it/s] 38%|███▊      | 5/13 [00:00<00:00,  8.80it/s] 46%|████▌     | 6/13 [00:00<00:00,  8.80it/s] 54%|█████▍    | 7/13 [00:00<00:00,  8.73it/s] 62%|██████▏   | 8/13 [00:00<00:00,  8.59it/s] 69%|██████▉   | 9/13 [00:01<00:00,  8.51it/s] 77%|███████▋  | 10/13 [00:01<00:00,  8.62it/s] 85%|████████▍ | 11/13 [00:01<00:00,  8.58it/s] 92%|█████████▏| 12/13 [00:01<00:00,  8.43it/s]100%|██████████| 13/13 [00:03<00:00,  1.27it/s]100%|██████████| 13/13 [00:03<00:00,  3.47it/s]
2025-03-09 07:20:17,523 [INFO]: 	Computing best hyperparameters for index knn.index 03/09/2025, 07:20:17
2025-03-09 07:20:49,323 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 31.7997 secs
2025-03-09 07:20:49,324 [INFO]: The best hyperparameters are: efSearch=208
2025-03-09 07:20:49,324 [INFO]: 	Compute fast metrics 03/09/2025, 07:20:49
  0%|          | 0/4 [00:00<?, ?it/s] 25%|██▌       | 1/4 [00:00<00:00,  4.61it/s] 50%|█████     | 2/4 [00:00<00:00,  5.99it/s] 75%|███████▌  | 3/4 [00:00<00:00,  6.70it/s] 75%|███████▌  | 3/4 [00:00<00:00,  5.05it/s]
2025-03-09 07:21:02,488 [INFO]: 	>>> Finished "Compute fast metrics" in 13.1645 secs
2025-03-09 07:21:02,491 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 48.7138 secs
2025-03-09 07:21:02,491 [INFO]: {
2025-03-09 07:21:02,491 [INFO]: 	index_key: HNSW15
2025-03-09 07:21:02,491 [INFO]: 	index_param: efSearch=208
2025-03-09 07:21:02,491 [INFO]: 	index_path: knn.index
2025-03-09 07:21:02,491 [INFO]: 	size in bytes: 631941070
2025-03-09 07:21:02,491 [INFO]: 	avg_search_speed_ms: 10.16865927930467
2025-03-09 07:21:02,491 [INFO]: 	99p_search_speed_ms: 17.207843442447473
2025-03-09 07:21:02,491 [INFO]: 	reconstruction error %: 0.0
2025-03-09 07:21:02,491 [INFO]: 	nb vectors: 3212
2025-03-09 07:21:02,491 [INFO]: 	vectors dimension: 49152
2025-03-09 07:21:02,491 [INFO]: 	compression ratio: 0.9993097869078204
2025-03-09 07:21:02,491 [INFO]: }
2025-03-09 07:21:02,491 [INFO]: 	>>> Finished "Creating the index" in 48.7152 secs
2025-03-09 07:21:02,491 [INFO]: >>> Finished "Launching the whole pipeline" in 48.7402 secs
2025-03-09 07:21:03: [retrieval_preprocessing] calculating distances ...
2025-03-09 07:21:04: [retrieval_preprocessing] finished and saved retrieval indices for episode 67121 [episode count 15/20]
[retrieval_preprocessing] for episode 1586 [episode count 16/20], we have num_retrieval=np.int64(3240) num_query=np.int64(155)
2025-03-09 07:21:04,862 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-09 07:21:05,374 [INFO]: Launching the whole pipeline 03/09/2025, 07:21:05
2025-03-09 07:21:05,374 [INFO]: Reading total number of vectors and dimension 03/09/2025, 07:21:05
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1522.99it/s]
2025-03-09 07:21:05,399 [INFO]: There are 3240 embeddings of dim 49152
2025-03-09 07:21:05,399 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0249 secs
2025-03-09 07:21:05,399 [INFO]: 	Compute estimated construction time of the index 03/09/2025, 07:21:05
2025-03-09 07:21:05,399 [INFO]: 		-> Train: 16.7 minutes
2025-03-09 07:21:05,399 [INFO]: 		-> Add: 1.8 seconds
2025-03-09 07:21:05,399 [INFO]: 		Total: 16.7 minutes
2025-03-09 07:21:05,399 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0001 secs
2025-03-09 07:21:05,399 [INFO]: 	Checking that your have enough memory available to create the index 03/09/2025, 07:21:05
2025-03-09 07:21:05,399 [INFO]: 668.7MB of memory will be needed to build the index (more might be used if you have more)
2025-03-09 07:21:05,399 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0001 secs
2025-03-09 07:21:05,399 [INFO]: 	Selecting most promising index types given data characteristics 03/09/2025, 07:21:05
2025-03-09 07:21:05,399 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-09 07:21:05,399 [INFO]: 	Creating the index 03/09/2025, 07:21:05
2025-03-09 07:21:05,399 [INFO]: 		-> Instanciate the index HNSW15 03/09/2025, 07:21:05
2025-03-09 07:21:05,400 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0009 secs
2025-03-09 07:21:05,400 [INFO]: 		-> Adding the vectors to the index 03/09/2025, 07:21:05
2025-03-09 07:21:05,400 [INFO]: The memory available for adding the vectors is 49.4GB(total available - used by the index)
2025-03-09 07:21:05,401 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/13 [00:00<?, ?it/s]  8%|▊         | 1/13 [00:00<00:01,  6.09it/s] 23%|██▎       | 3/13 [00:00<00:01,  9.55it/s] 38%|███▊      | 5/13 [00:00<00:00, 10.57it/s] 54%|█████▍    | 7/13 [00:00<00:00, 11.04it/s] 69%|██████▉   | 9/13 [00:00<00:00, 11.98it/s] 85%|████████▍ | 11/13 [00:00<00:00, 12.49it/s]100%|██████████| 13/13 [00:03<00:00,  1.99it/s]100%|██████████| 13/13 [00:03<00:00,  3.56it/s]
2025-03-09 07:21:09,064 [INFO]: 	Computing best hyperparameters for index knn.index 03/09/2025, 07:21:09
2025-03-09 07:21:40,065 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 31.0011 secs
2025-03-09 07:21:40,065 [INFO]: The best hyperparameters are: efSearch=193
2025-03-09 07:21:40,065 [INFO]: 	Compute fast metrics 03/09/2025, 07:21:40
  0%|          | 0/4 [00:00<?, ?it/s] 25%|██▌       | 1/4 [00:00<00:00,  5.97it/s] 75%|███████▌  | 3/4 [00:00<00:00,  9.72it/s] 75%|███████▌  | 3/4 [00:00<00:00,  7.45it/s]
2025-03-09 07:21:52,637 [INFO]: 	>>> Finished "Compute fast metrics" in 12.5718 secs
2025-03-09 07:21:52,639 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 47.2390 secs
2025-03-09 07:21:52,640 [INFO]: {
2025-03-09 07:21:52,640 [INFO]: 	index_key: HNSW15
2025-03-09 07:21:52,640 [INFO]: 	index_param: efSearch=193
2025-03-09 07:21:52,640 [INFO]: 	index_path: knn.index
2025-03-09 07:21:52,640 [INFO]: 	size in bytes: 637450270
2025-03-09 07:21:52,640 [INFO]: 	avg_search_speed_ms: 8.860098457490189
2025-03-09 07:21:52,640 [INFO]: 	99p_search_speed_ms: 14.884830666705968
2025-03-09 07:21:52,640 [INFO]: 	reconstruction error %: 0.0
2025-03-09 07:21:52,640 [INFO]: 	nb vectors: 3240
2025-03-09 07:21:52,640 [INFO]: 	vectors dimension: 49152
2025-03-09 07:21:52,640 [INFO]: 	compression ratio: 0.9993092010142218
2025-03-09 07:21:52,640 [INFO]: }
2025-03-09 07:21:52,640 [INFO]: 	>>> Finished "Creating the index" in 47.2403 secs
2025-03-09 07:21:52,640 [INFO]: >>> Finished "Launching the whole pipeline" in 47.2659 secs
2025-03-09 07:21:53: [retrieval_preprocessing] calculating distances ...
2025-03-09 07:21:53: [retrieval_preprocessing] finished and saved retrieval indices for episode 1586 [episode count 16/20]
[retrieval_preprocessing] for episode 27701 [episode count 17/20], we have num_retrieval=np.int64(3237) num_query=np.int64(158)
2025-03-09 07:21:54,644 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-09 07:21:55,124 [INFO]: Launching the whole pipeline 03/09/2025, 07:21:55
2025-03-09 07:21:55,124 [INFO]: Reading total number of vectors and dimension 03/09/2025, 07:21:55
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1493.17it/s]
2025-03-09 07:21:55,148 [INFO]: There are 3237 embeddings of dim 49152
2025-03-09 07:21:55,148 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0244 secs
2025-03-09 07:21:55,148 [INFO]: 	Compute estimated construction time of the index 03/09/2025, 07:21:55
2025-03-09 07:21:55,148 [INFO]: 		-> Train: 16.7 minutes
2025-03-09 07:21:55,148 [INFO]: 		-> Add: 1.8 seconds
2025-03-09 07:21:55,148 [INFO]: 		Total: 16.7 minutes
2025-03-09 07:21:55,148 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0001 secs
2025-03-09 07:21:55,148 [INFO]: 	Checking that your have enough memory available to create the index 03/09/2025, 07:21:55
2025-03-09 07:21:55,148 [INFO]: 668.0MB of memory will be needed to build the index (more might be used if you have more)
2025-03-09 07:21:55,149 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0001 secs
2025-03-09 07:21:55,149 [INFO]: 	Selecting most promising index types given data characteristics 03/09/2025, 07:21:55
2025-03-09 07:21:55,149 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-09 07:21:55,149 [INFO]: 	Creating the index 03/09/2025, 07:21:55
2025-03-09 07:21:55,149 [INFO]: 		-> Instanciate the index HNSW15 03/09/2025, 07:21:55
2025-03-09 07:21:55,150 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0010 secs
2025-03-09 07:21:55,150 [INFO]: 		-> Adding the vectors to the index 03/09/2025, 07:21:55
2025-03-09 07:21:55,150 [INFO]: The memory available for adding the vectors is 49.4GB(total available - used by the index)
2025-03-09 07:21:55,150 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/13 [00:00<?, ?it/s]  8%|▊         | 1/13 [00:00<00:02,  5.60it/s] 23%|██▎       | 3/13 [00:00<00:00, 10.22it/s] 38%|███▊      | 5/13 [00:00<00:00, 11.71it/s] 54%|█████▍    | 7/13 [00:00<00:00, 11.57it/s] 69%|██████▉   | 9/13 [00:00<00:00, 11.59it/s] 85%|████████▍ | 11/13 [00:00<00:00, 11.53it/s]100%|██████████| 13/13 [00:03<00:00,  2.05it/s]100%|██████████| 13/13 [00:03<00:00,  3.65it/s]
2025-03-09 07:21:58,722 [INFO]: 	Computing best hyperparameters for index knn.index 03/09/2025, 07:21:58
2025-03-09 07:22:32,608 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 33.8865 secs
2025-03-09 07:22:32,609 [INFO]: The best hyperparameters are: efSearch=235
2025-03-09 07:22:32,609 [INFO]: 	Compute fast metrics 03/09/2025, 07:22:32
  0%|          | 0/4 [00:00<?, ?it/s] 25%|██▌       | 1/4 [00:00<00:00,  4.01it/s] 50%|█████     | 2/4 [00:00<00:00,  5.99it/s] 75%|███████▌  | 3/4 [00:00<00:00,  7.02it/s] 75%|███████▌  | 3/4 [00:00<00:00,  5.61it/s]
2025-03-09 07:22:46,647 [INFO]: 	>>> Finished "Compute fast metrics" in 14.0386 secs
2025-03-09 07:22:46,649 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 51.4998 secs
2025-03-09 07:22:46,650 [INFO]: {
2025-03-09 07:22:46,650 [INFO]: 	index_key: HNSW15
2025-03-09 07:22:46,650 [INFO]: 	index_param: efSearch=235
2025-03-09 07:22:46,650 [INFO]: 	index_path: knn.index
2025-03-09 07:22:46,650 [INFO]: 	size in bytes: 636860050
2025-03-09 07:22:46,650 [INFO]: 	avg_search_speed_ms: 11.195720039143291
2025-03-09 07:22:46,650 [INFO]: 	99p_search_speed_ms: 16.211313828825965
2025-03-09 07:22:46,650 [INFO]: 	reconstruction error %: 0.0
2025-03-09 07:22:46,650 [INFO]: 	nb vectors: 3237
2025-03-09 07:22:46,650 [INFO]: 	vectors dimension: 49152
2025-03-09 07:22:46,650 [INFO]: 	compression ratio: 0.9993091826061314
2025-03-09 07:22:46,650 [INFO]: }
2025-03-09 07:22:46,650 [INFO]: 	>>> Finished "Creating the index" in 51.5011 secs
2025-03-09 07:22:46,650 [INFO]: >>> Finished "Launching the whole pipeline" in 51.5261 secs
2025-03-09 07:22:47: [retrieval_preprocessing] calculating distances ...
2025-03-09 07:22:48: [retrieval_preprocessing] finished and saved retrieval indices for episode 27701 [episode count 17/20]
[retrieval_preprocessing] for episode 1079 [episode count 18/20], we have num_retrieval=np.int64(3283) num_query=np.int64(112)
2025-03-09 07:22:49,194 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-09 07:22:49,755 [INFO]: Launching the whole pipeline 03/09/2025, 07:22:49
2025-03-09 07:22:49,755 [INFO]: Reading total number of vectors and dimension 03/09/2025, 07:22:49
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1786.33it/s]
2025-03-09 07:22:49,781 [INFO]: There are 3283 embeddings of dim 49152
2025-03-09 07:22:49,782 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0266 secs
2025-03-09 07:22:49,782 [INFO]: 	Compute estimated construction time of the index 03/09/2025, 07:22:49
2025-03-09 07:22:49,782 [INFO]: 		-> Train: 16.7 minutes
2025-03-09 07:22:49,782 [INFO]: 		-> Add: 1.8 seconds
2025-03-09 07:22:49,782 [INFO]: 		Total: 16.7 minutes
2025-03-09 07:22:49,782 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0003 secs
2025-03-09 07:22:49,782 [INFO]: 	Checking that your have enough memory available to create the index 03/09/2025, 07:22:49
2025-03-09 07:22:49,782 [INFO]: 677.5MB of memory will be needed to build the index (more might be used if you have more)
2025-03-09 07:22:49,783 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0003 secs
2025-03-09 07:22:49,783 [INFO]: 	Selecting most promising index types given data characteristics 03/09/2025, 07:22:49
2025-03-09 07:22:49,783 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-09 07:22:49,783 [INFO]: 	Creating the index 03/09/2025, 07:22:49
2025-03-09 07:22:49,783 [INFO]: 		-> Instanciate the index HNSW15 03/09/2025, 07:22:49
2025-03-09 07:22:49,786 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0025 secs
2025-03-09 07:22:49,786 [INFO]: 		-> Adding the vectors to the index 03/09/2025, 07:22:49
2025-03-09 07:22:49,786 [INFO]: The memory available for adding the vectors is 49.4GB(total available - used by the index)
2025-03-09 07:22:49,787 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/13 [00:00<?, ?it/s]  8%|▊         | 1/13 [00:00<00:02,  5.15it/s] 15%|█▌        | 2/13 [00:00<00:01,  6.56it/s] 23%|██▎       | 3/13 [00:00<00:01,  7.04it/s] 31%|███       | 4/13 [00:00<00:01,  7.23it/s] 38%|███▊      | 5/13 [00:00<00:01,  7.35it/s] 46%|████▌     | 6/13 [00:00<00:00,  7.40it/s] 54%|█████▍    | 7/13 [00:00<00:00,  7.52it/s] 62%|██████▏   | 8/13 [00:01<00:00,  7.50it/s] 69%|██████▉   | 9/13 [00:01<00:00,  7.41it/s] 77%|███████▋  | 10/13 [00:01<00:00,  7.41it/s] 85%|████████▍ | 11/13 [00:01<00:00,  7.38it/s] 92%|█████████▏| 12/13 [00:01<00:00,  7.43it/s]100%|██████████| 13/13 [00:04<00:00,  1.21it/s]100%|██████████| 13/13 [00:04<00:00,  3.19it/s]
2025-03-09 07:22:53,873 [INFO]: 	Computing best hyperparameters for index knn.index 03/09/2025, 07:22:53
2025-03-09 07:23:28,370 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 34.4968 secs
2025-03-09 07:23:28,371 [INFO]: The best hyperparameters are: efSearch=243
2025-03-09 07:23:28,371 [INFO]: 	Compute fast metrics 03/09/2025, 07:23:28
  0%|          | 0/4 [00:00<?, ?it/s] 25%|██▌       | 1/4 [00:00<00:00,  6.58it/s] 75%|███████▌  | 3/4 [00:00<00:00, 11.30it/s] 75%|███████▌  | 3/4 [00:00<00:00,  8.25it/s]
2025-03-09 07:23:43,150 [INFO]: 	>>> Finished "Compute fast metrics" in 14.7792 secs
2025-03-09 07:23:43,153 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 53.3665 secs
2025-03-09 07:23:43,153 [INFO]: {
2025-03-09 07:23:43,153 [INFO]: 	index_key: HNSW15
2025-03-09 07:23:43,153 [INFO]: 	index_param: efSearch=243
2025-03-09 07:23:43,153 [INFO]: 	index_path: knn.index
2025-03-09 07:23:43,153 [INFO]: 	size in bytes: 645910390
2025-03-09 07:23:43,153 [INFO]: 	avg_search_speed_ms: 10.81351000589092
2025-03-09 07:23:43,153 [INFO]: 	99p_search_speed_ms: 19.95615780353546
2025-03-09 07:23:43,153 [INFO]: 	reconstruction error %: 0.0
2025-03-09 07:23:43,153 [INFO]: 	nb vectors: 3283
2025-03-09 07:23:43,153 [INFO]: 	vectors dimension: 49152
2025-03-09 07:23:43,153 [INFO]: 	compression ratio: 0.9993089970266619
2025-03-09 07:23:43,153 [INFO]: }
2025-03-09 07:23:43,153 [INFO]: 	>>> Finished "Creating the index" in 53.3699 secs
2025-03-09 07:23:43,153 [INFO]: >>> Finished "Launching the whole pipeline" in 53.3983 secs
2025-03-09 07:23:44: [retrieval_preprocessing] calculating distances ...
2025-03-09 07:23:44: [retrieval_preprocessing] finished and saved retrieval indices for episode 1079 [episode count 18/20]
[retrieval_preprocessing] for episode 7225 [episode count 19/20], we have num_retrieval=np.int64(3226) num_query=np.int64(169)
2025-03-09 07:23:45,501 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-09 07:23:45,975 [INFO]: Launching the whole pipeline 03/09/2025, 07:23:45
2025-03-09 07:23:45,975 [INFO]: Reading total number of vectors and dimension 03/09/2025, 07:23:45
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1276.80it/s]
2025-03-09 07:23:46,005 [INFO]: There are 3226 embeddings of dim 49152
2025-03-09 07:23:46,006 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0307 secs
2025-03-09 07:23:46,006 [INFO]: 	Compute estimated construction time of the index 03/09/2025, 07:23:46
2025-03-09 07:23:46,006 [INFO]: 		-> Train: 16.7 minutes
2025-03-09 07:23:46,006 [INFO]: 		-> Add: 1.8 seconds
2025-03-09 07:23:46,007 [INFO]: 		Total: 16.7 minutes
2025-03-09 07:23:46,007 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0003 secs
2025-03-09 07:23:46,007 [INFO]: 	Checking that your have enough memory available to create the index 03/09/2025, 07:23:46
2025-03-09 07:23:46,007 [INFO]: 665.8MB of memory will be needed to build the index (more might be used if you have more)
2025-03-09 07:23:46,007 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0005 secs
2025-03-09 07:23:46,008 [INFO]: 	Selecting most promising index types given data characteristics 03/09/2025, 07:23:46
2025-03-09 07:23:46,008 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-09 07:23:46,008 [INFO]: 	Creating the index 03/09/2025, 07:23:46
2025-03-09 07:23:46,008 [INFO]: 		-> Instanciate the index HNSW15 03/09/2025, 07:23:46
2025-03-09 07:23:46,011 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0031 secs
2025-03-09 07:23:46,012 [INFO]: 		-> Adding the vectors to the index 03/09/2025, 07:23:46
2025-03-09 07:23:46,012 [INFO]: The memory available for adding the vectors is 49.4GB(total available - used by the index)
2025-03-09 07:23:46,012 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/13 [00:00<?, ?it/s]  8%|▊         | 1/13 [00:00<00:01,  7.25it/s] 23%|██▎       | 3/13 [00:00<00:00, 12.02it/s] 38%|███▊      | 5/13 [00:00<00:00, 11.59it/s] 54%|█████▍    | 7/13 [00:00<00:00, 10.60it/s] 69%|██████▉   | 9/13 [00:00<00:00, 10.23it/s] 85%|████████▍ | 11/13 [00:01<00:00,  9.93it/s]100%|██████████| 13/13 [00:03<00:00,  1.99it/s]100%|██████████| 13/13 [00:03<00:00,  3.52it/s]
2025-03-09 07:23:49,711 [INFO]: 	Computing best hyperparameters for index knn.index 03/09/2025, 07:23:49
2025-03-09 07:24:24,262 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 34.5506 secs
2025-03-09 07:24:24,262 [INFO]: The best hyperparameters are: efSearch=224
2025-03-09 07:24:24,262 [INFO]: 	Compute fast metrics 03/09/2025, 07:24:24
  0%|          | 0/4 [00:00<?, ?it/s] 25%|██▌       | 1/4 [00:01<00:05,  1.95s/it] 50%|█████     | 2/4 [00:03<00:03,  1.68s/it] 75%|███████▌  | 3/4 [00:04<00:01,  1.17s/it] 75%|███████▌  | 3/4 [00:04<00:01,  1.42s/it]
2025-03-09 07:24:43,682 [INFO]: 	>>> Finished "Compute fast metrics" in 19.4191 secs
2025-03-09 07:24:43,684 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 57.6724 secs
2025-03-09 07:24:43,684 [INFO]: {
2025-03-09 07:24:43,684 [INFO]: 	index_key: HNSW15
2025-03-09 07:24:43,684 [INFO]: 	index_param: efSearch=224
2025-03-09 07:24:43,684 [INFO]: 	index_path: knn.index
2025-03-09 07:24:43,684 [INFO]: 	size in bytes: 634695670
2025-03-09 07:24:43,684 [INFO]: 	avg_search_speed_ms: 9.999363908777013
2025-03-09 07:24:43,684 [INFO]: 	99p_search_speed_ms: 14.558384821284562
2025-03-09 07:24:43,684 [INFO]: 	reconstruction error %: 0.0
2025-03-09 07:24:43,684 [INFO]: 	nb vectors: 3226
2025-03-09 07:24:43,684 [INFO]: 	vectors dimension: 49152
2025-03-09 07:24:43,684 [INFO]: 	compression ratio: 0.9993094926896224
2025-03-09 07:24:43,684 [INFO]: }
2025-03-09 07:24:43,684 [INFO]: 	>>> Finished "Creating the index" in 57.6764 secs
2025-03-09 07:24:43,684 [INFO]: >>> Finished "Launching the whole pipeline" in 57.7095 secs
2025-03-09 07:24:44: [retrieval_preprocessing] calculating distances ...
2025-03-09 07:24:45: [retrieval_preprocessing] finished and saved retrieval indices for episode 7225 [episode count 19/20]
2025-03-09 07:24:45: [retrieval_preprocessing] finished for (6498288010, 'lid') [chosen_id count 1/10]
2025-03-09 07:24:47: [retrieval_preprocessing] concatenated all embeddings and indices for 20 episodes for (4823049285, 'block') [chosen_id count 2/10]
2025-03-09 07:24:47: [retrieval_preprocessing] we have num_total=3376 embedding_dim=49152
[retrieval_preprocessing] for episode 90112 [episode count 0/20], we have num_retrieval=np.int64(3223) num_query=np.int64(153)
2025-03-09 07:24:48,747 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-09 07:24:49,200 [INFO]: Launching the whole pipeline 03/09/2025, 07:24:49
2025-03-09 07:24:49,200 [INFO]: Reading total number of vectors and dimension 03/09/2025, 07:24:49
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1503.33it/s]
2025-03-09 07:24:49,225 [INFO]: There are 3223 embeddings of dim 49152
2025-03-09 07:24:49,225 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0247 secs
2025-03-09 07:24:49,225 [INFO]: 	Compute estimated construction time of the index 03/09/2025, 07:24:49
2025-03-09 07:24:49,225 [INFO]: 		-> Train: 16.7 minutes
2025-03-09 07:24:49,225 [INFO]: 		-> Add: 1.8 seconds
2025-03-09 07:24:49,225 [INFO]: 		Total: 16.7 minutes
2025-03-09 07:24:49,225 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0001 secs
2025-03-09 07:24:49,225 [INFO]: 	Checking that your have enough memory available to create the index 03/09/2025, 07:24:49
2025-03-09 07:24:49,225 [INFO]: 665.1MB of memory will be needed to build the index (more might be used if you have more)
2025-03-09 07:24:49,225 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0001 secs
2025-03-09 07:24:49,225 [INFO]: 	Selecting most promising index types given data characteristics 03/09/2025, 07:24:49
2025-03-09 07:24:49,225 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-09 07:24:49,225 [INFO]: 	Creating the index 03/09/2025, 07:24:49
2025-03-09 07:24:49,225 [INFO]: 		-> Instanciate the index HNSW15 03/09/2025, 07:24:49
2025-03-09 07:24:49,226 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0009 secs
2025-03-09 07:24:49,226 [INFO]: 		-> Adding the vectors to the index 03/09/2025, 07:24:49
2025-03-09 07:24:49,226 [INFO]: The memory available for adding the vectors is 49.4GB(total available - used by the index)
2025-03-09 07:24:49,226 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/13 [00:00<?, ?it/s]  8%|▊         | 1/13 [00:00<00:02,  5.25it/s] 15%|█▌        | 2/13 [00:00<00:01,  6.54it/s] 23%|██▎       | 3/13 [00:00<00:01,  7.09it/s] 31%|███       | 4/13 [00:00<00:01,  7.37it/s] 38%|███▊      | 5/13 [00:00<00:01,  7.66it/s] 46%|████▌     | 6/13 [00:00<00:00,  7.79it/s] 54%|█████▍    | 7/13 [00:00<00:00,  7.88it/s] 62%|██████▏   | 8/13 [00:01<00:00,  7.94it/s] 69%|██████▉   | 9/13 [00:01<00:00,  7.97it/s] 77%|███████▋  | 10/13 [00:01<00:00,  8.11it/s] 85%|████████▍ | 11/13 [00:01<00:00,  8.12it/s] 92%|█████████▏| 12/13 [00:01<00:00,  7.98it/s]100%|██████████| 13/13 [00:03<00:00,  1.26it/s]100%|██████████| 13/13 [00:03<00:00,  3.34it/s]
2025-03-09 07:24:53,125 [INFO]: 	Computing best hyperparameters for index knn.index 03/09/2025, 07:24:53
2025-03-09 07:25:24,785 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 31.6601 secs
2025-03-09 07:25:24,786 [INFO]: The best hyperparameters are: efSearch=286
2025-03-09 07:25:24,786 [INFO]: 	Compute fast metrics 03/09/2025, 07:25:24
  0%|          | 0/4 [00:00<?, ?it/s] 25%|██▌       | 1/4 [00:01<00:03,  1.12s/it] 50%|█████     | 2/4 [00:01<00:01,  1.28it/s] 75%|███████▌  | 3/4 [00:02<00:00,  1.58it/s] 75%|███████▌  | 3/4 [00:02<00:00,  1.11it/s]
2025-03-09 07:25:39,169 [INFO]: 	>>> Finished "Compute fast metrics" in 14.3833 secs
2025-03-09 07:25:39,171 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 49.9449 secs
2025-03-09 07:25:39,171 [INFO]: {
2025-03-09 07:25:39,171 [INFO]: 	index_key: HNSW15
2025-03-09 07:25:39,171 [INFO]: 	index_param: efSearch=286
2025-03-09 07:25:39,171 [INFO]: 	index_path: knn.index
2025-03-09 07:25:39,171 [INFO]: 	size in bytes: 634105330
2025-03-09 07:25:39,172 [INFO]: 	avg_search_speed_ms: 9.967406688662894
2025-03-09 07:25:39,172 [INFO]: 	99p_search_speed_ms: 15.830382029525937
2025-03-09 07:25:39,172 [INFO]: 	reconstruction error %: 0.0
2025-03-09 07:25:39,172 [INFO]: 	nb vectors: 3223
2025-03-09 07:25:39,172 [INFO]: 	vectors dimension: 49152
2025-03-09 07:25:39,172 [INFO]: 	compression ratio: 0.9993096635853858
2025-03-09 07:25:39,172 [INFO]: }
2025-03-09 07:25:39,172 [INFO]: 	>>> Finished "Creating the index" in 49.9463 secs
2025-03-09 07:25:39,172 [INFO]: >>> Finished "Launching the whole pipeline" in 49.9716 secs
2025-03-09 07:25:40: [retrieval_preprocessing] calculating distances ...
2025-03-09 07:25:40: [retrieval_preprocessing] finished and saved retrieval indices for episode 90112 [episode count 0/20]
[retrieval_preprocessing] for episode 71683 [episode count 1/20], we have num_retrieval=np.int64(3182) num_query=np.int64(194)
2025-03-09 07:25:41,710 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-09 07:25:42,182 [INFO]: Launching the whole pipeline 03/09/2025, 07:25:42
2025-03-09 07:25:42,183 [INFO]: Reading total number of vectors and dimension 03/09/2025, 07:25:42
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1222.12it/s]
2025-03-09 07:25:42,207 [INFO]: There are 3182 embeddings of dim 49152
2025-03-09 07:25:42,207 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0247 secs
2025-03-09 07:25:42,207 [INFO]: 	Compute estimated construction time of the index 03/09/2025, 07:25:42
2025-03-09 07:25:42,207 [INFO]: 		-> Train: 16.7 minutes
2025-03-09 07:25:42,207 [INFO]: 		-> Add: 1.7 seconds
2025-03-09 07:25:42,208 [INFO]: 		Total: 16.7 minutes
2025-03-09 07:25:42,208 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0002 secs
2025-03-09 07:25:42,208 [INFO]: 	Checking that your have enough memory available to create the index 03/09/2025, 07:25:42
2025-03-09 07:25:42,208 [INFO]: 656.7MB of memory will be needed to build the index (more might be used if you have more)
2025-03-09 07:25:42,208 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0001 secs
2025-03-09 07:25:42,208 [INFO]: 	Selecting most promising index types given data characteristics 03/09/2025, 07:25:42
2025-03-09 07:25:42,208 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-09 07:25:42,208 [INFO]: 	Creating the index 03/09/2025, 07:25:42
2025-03-09 07:25:42,208 [INFO]: 		-> Instanciate the index HNSW15 03/09/2025, 07:25:42
2025-03-09 07:25:42,209 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0008 secs
2025-03-09 07:25:42,209 [INFO]: 		-> Adding the vectors to the index 03/09/2025, 07:25:42
2025-03-09 07:25:42,209 [INFO]: The memory available for adding the vectors is 49.4GB(total available - used by the index)
2025-03-09 07:25:42,209 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/13 [00:00<?, ?it/s]  8%|▊         | 1/13 [00:00<00:02,  5.42it/s] 15%|█▌        | 2/13 [00:00<00:01,  6.88it/s] 23%|██▎       | 3/13 [00:00<00:01,  7.47it/s] 31%|███       | 4/13 [00:00<00:01,  7.84it/s] 38%|███▊      | 5/13 [00:00<00:01,  7.99it/s] 46%|████▌     | 6/13 [00:00<00:00,  8.07it/s] 54%|█████▍    | 7/13 [00:00<00:00,  8.13it/s] 62%|██████▏   | 8/13 [00:01<00:00,  8.09it/s] 69%|██████▉   | 9/13 [00:01<00:00,  8.22it/s] 77%|███████▋  | 10/13 [00:01<00:00,  8.13it/s] 85%|████████▍ | 11/13 [00:01<00:00,  8.01it/s] 92%|█████████▏| 12/13 [00:01<00:00,  8.07it/s]100%|██████████| 13/13 [00:03<00:00,  1.24it/s]100%|██████████| 13/13 [00:03<00:00,  3.32it/s]
2025-03-09 07:25:46,122 [INFO]: 	Computing best hyperparameters for index knn.index 03/09/2025, 07:25:46
2025-03-09 07:26:16,280 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 30.1568 secs
2025-03-09 07:26:16,280 [INFO]: The best hyperparameters are: efSearch=254
2025-03-09 07:26:16,280 [INFO]: 	Compute fast metrics 03/09/2025, 07:26:16
  0%|          | 0/4 [00:00<?, ?it/s] 25%|██▌       | 1/4 [00:00<00:00,  6.86it/s] 75%|███████▌  | 3/4 [00:00<00:00, 11.74it/s] 75%|███████▌  | 3/4 [00:00<00:00,  9.05it/s]
2025-03-09 07:26:29,624 [INFO]: 	>>> Finished "Compute fast metrics" in 13.3439 secs
2025-03-09 07:26:29,626 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 47.4175 secs
2025-03-09 07:26:29,626 [INFO]: {
2025-03-09 07:26:29,627 [INFO]: 	index_key: HNSW15
2025-03-09 07:26:29,627 [INFO]: 	index_param: efSearch=254
2025-03-09 07:26:29,627 [INFO]: 	index_path: knn.index
2025-03-09 07:26:29,627 [INFO]: 	size in bytes: 626038810
2025-03-09 07:26:29,627 [INFO]: 	avg_search_speed_ms: 9.911015157184469
2025-03-09 07:26:29,627 [INFO]: 	99p_search_speed_ms: 16.240232018753876
2025-03-09 07:26:29,627 [INFO]: 	reconstruction error %: 0.0
2025-03-09 07:26:29,627 [INFO]: 	nb vectors: 3182
2025-03-09 07:26:29,627 [INFO]: 	vectors dimension: 49152
2025-03-09 07:26:29,627 [INFO]: 	compression ratio: 0.999309700943301
2025-03-09 07:26:29,627 [INFO]: }
2025-03-09 07:26:29,627 [INFO]: 	>>> Finished "Creating the index" in 47.4188 secs
2025-03-09 07:26:29,627 [INFO]: >>> Finished "Launching the whole pipeline" in 47.4441 secs
2025-03-09 07:26:31: [retrieval_preprocessing] calculating distances ...
2025-03-09 07:26:31: [retrieval_preprocessing] finished and saved retrieval indices for episode 71683 [episode count 1/20]
[retrieval_preprocessing] for episode 49156 [episode count 2/20], we have num_retrieval=np.int64(3227) num_query=np.int64(149)
2025-03-09 07:26:32,349 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-09 07:26:32,744 [INFO]: Launching the whole pipeline 03/09/2025, 07:26:32
2025-03-09 07:26:32,744 [INFO]: Reading total number of vectors and dimension 03/09/2025, 07:26:32
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1545.43it/s]
2025-03-09 07:26:32,771 [INFO]: There are 3227 embeddings of dim 49152
2025-03-09 07:26:32,772 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0279 secs
2025-03-09 07:26:32,772 [INFO]: 	Compute estimated construction time of the index 03/09/2025, 07:26:32
2025-03-09 07:26:32,772 [INFO]: 		-> Train: 16.7 minutes
2025-03-09 07:26:32,772 [INFO]: 		-> Add: 1.8 seconds
2025-03-09 07:26:32,772 [INFO]: 		Total: 16.7 minutes
2025-03-09 07:26:32,772 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0004 secs
2025-03-09 07:26:32,772 [INFO]: 	Checking that your have enough memory available to create the index 03/09/2025, 07:26:32
2025-03-09 07:26:32,772 [INFO]: 666.0MB of memory will be needed to build the index (more might be used if you have more)
2025-03-09 07:26:32,773 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0004 secs
2025-03-09 07:26:32,773 [INFO]: 	Selecting most promising index types given data characteristics 03/09/2025, 07:26:32
2025-03-09 07:26:32,773 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-09 07:26:32,773 [INFO]: 	Creating the index 03/09/2025, 07:26:32
2025-03-09 07:26:32,773 [INFO]: 		-> Instanciate the index HNSW15 03/09/2025, 07:26:32
2025-03-09 07:26:32,776 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0027 secs
2025-03-09 07:26:32,776 [INFO]: 		-> Adding the vectors to the index 03/09/2025, 07:26:32
2025-03-09 07:26:32,776 [INFO]: The memory available for adding the vectors is 49.4GB(total available - used by the index)
2025-03-09 07:26:32,776 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/13 [00:00<?, ?it/s]  8%|▊         | 1/13 [00:00<00:01,  6.69it/s] 23%|██▎       | 3/13 [00:00<00:00, 10.04it/s] 38%|███▊      | 5/13 [00:00<00:00, 10.44it/s] 54%|█████▍    | 7/13 [00:00<00:00, 10.55it/s] 69%|██████▉   | 9/13 [00:00<00:00, 10.66it/s] 85%|████████▍ | 11/13 [00:01<00:00, 10.64it/s]100%|██████████| 13/13 [00:03<00:00,  2.33it/s]100%|██████████| 13/13 [00:03<00:00,  3.99it/s]
2025-03-09 07:26:36,048 [INFO]: 	Computing best hyperparameters for index knn.index 03/09/2025, 07:26:36
2025-03-09 07:27:09,409 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 33.3606 secs
2025-03-09 07:27:09,409 [INFO]: The best hyperparameters are: efSearch=332
2025-03-09 07:27:09,409 [INFO]: 	Compute fast metrics 03/09/2025, 07:27:09
  0%|          | 0/4 [00:00<?, ?it/s] 25%|██▌       | 1/4 [00:00<00:00,  4.78it/s] 50%|█████     | 2/4 [00:00<00:00,  6.14it/s] 75%|███████▌  | 3/4 [00:00<00:00,  7.05it/s] 75%|███████▌  | 3/4 [00:00<00:00,  5.44it/s]
2025-03-09 07:27:24,771 [INFO]: 	>>> Finished "Compute fast metrics" in 15.3619 secs
2025-03-09 07:27:24,774 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 51.9979 secs
2025-03-09 07:27:24,774 [INFO]: {
2025-03-09 07:27:24,774 [INFO]: 	index_key: HNSW15
2025-03-09 07:27:24,774 [INFO]: 	index_param: efSearch=332
2025-03-09 07:27:24,774 [INFO]: 	index_path: knn.index
2025-03-09 07:27:24,774 [INFO]: 	size in bytes: 634892410
2025-03-09 07:27:24,774 [INFO]: 	avg_search_speed_ms: 12.635799366486907
2025-03-09 07:27:24,774 [INFO]: 	99p_search_speed_ms: 22.696320477407426
2025-03-09 07:27:24,774 [INFO]: 	reconstruction error %: 0.0
2025-03-09 07:27:24,774 [INFO]: 	nb vectors: 3227
2025-03-09 07:27:24,774 [INFO]: 	vectors dimension: 49152
2025-03-09 07:27:24,774 [INFO]: 	compression ratio: 0.999309498754285
2025-03-09 07:27:24,774 [INFO]: }
2025-03-09 07:27:24,775 [INFO]: 	>>> Finished "Creating the index" in 52.0015 secs
2025-03-09 07:27:24,775 [INFO]: >>> Finished "Launching the whole pipeline" in 52.0309 secs
2025-03-09 07:27:25: [retrieval_preprocessing] calculating distances ...
2025-03-09 07:27:26: [retrieval_preprocessing] finished and saved retrieval indices for episode 49156 [episode count 2/20]
[retrieval_preprocessing] for episode 8200 [episode count 3/20], we have num_retrieval=np.int64(3176) num_query=np.int64(200)
2025-03-09 07:27:27,327 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-09 07:27:27,813 [INFO]: Launching the whole pipeline 03/09/2025, 07:27:27
2025-03-09 07:27:27,814 [INFO]: Reading total number of vectors and dimension 03/09/2025, 07:27:27
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 2447.09it/s]
2025-03-09 07:27:27,838 [INFO]: There are 3176 embeddings of dim 49152
2025-03-09 07:27:27,839 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0250 secs
2025-03-09 07:27:27,839 [INFO]: 	Compute estimated construction time of the index 03/09/2025, 07:27:27
2025-03-09 07:27:27,839 [INFO]: 		-> Train: 16.7 minutes
2025-03-09 07:27:27,839 [INFO]: 		-> Add: 1.7 seconds
2025-03-09 07:27:27,839 [INFO]: 		Total: 16.7 minutes
2025-03-09 07:27:27,839 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0003 secs
2025-03-09 07:27:27,839 [INFO]: 	Checking that your have enough memory available to create the index 03/09/2025, 07:27:27
2025-03-09 07:27:27,840 [INFO]: 655.4MB of memory will be needed to build the index (more might be used if you have more)
2025-03-09 07:27:27,840 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0004 secs
2025-03-09 07:27:27,840 [INFO]: 	Selecting most promising index types given data characteristics 03/09/2025, 07:27:27
2025-03-09 07:27:27,840 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-09 07:27:27,840 [INFO]: 	Creating the index 03/09/2025, 07:27:27
2025-03-09 07:27:27,840 [INFO]: 		-> Instanciate the index HNSW15 03/09/2025, 07:27:27
2025-03-09 07:27:27,843 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0025 secs
2025-03-09 07:27:27,843 [INFO]: 		-> Adding the vectors to the index 03/09/2025, 07:27:27
2025-03-09 07:27:27,843 [INFO]: The memory available for adding the vectors is 49.4GB(total available - used by the index)
2025-03-09 07:27:27,843 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/13 [00:00<?, ?it/s]  8%|▊         | 1/13 [00:00<00:02,  5.54it/s] 15%|█▌        | 2/13 [00:00<00:01,  7.21it/s] 23%|██▎       | 3/13 [00:00<00:01,  7.87it/s] 31%|███       | 4/13 [00:00<00:01,  8.16it/s] 38%|███▊      | 5/13 [00:00<00:00,  8.12it/s] 46%|████▌     | 6/13 [00:00<00:00,  8.15it/s] 54%|█████▍    | 7/13 [00:00<00:00,  7.41it/s] 62%|██████▏   | 8/13 [00:01<00:00,  7.02it/s] 69%|██████▉   | 9/13 [00:01<00:00,  7.01it/s] 77%|███████▋  | 10/13 [00:01<00:00,  7.23it/s] 85%|████████▍ | 11/13 [00:01<00:00,  7.31it/s] 92%|█████████▏| 12/13 [00:01<00:00,  7.46it/s]100%|██████████| 13/13 [00:04<00:00,  1.17it/s]100%|██████████| 13/13 [00:04<00:00,  3.15it/s]
2025-03-09 07:27:31,977 [INFO]: 	Computing best hyperparameters for index knn.index 03/09/2025, 07:27:31
2025-03-09 07:28:07,537 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 35.5601 secs
2025-03-09 07:28:07,538 [INFO]: The best hyperparameters are: efSearch=280
2025-03-09 07:28:07,538 [INFO]: 	Compute fast metrics 03/09/2025, 07:28:07
  0%|          | 0/4 [00:00<?, ?it/s] 25%|██▌       | 1/4 [00:00<00:00,  5.78it/s] 50%|█████     | 2/4 [00:00<00:00,  7.64it/s] 75%|███████▌  | 3/4 [00:00<00:00,  6.33it/s]
2025-03-09 07:28:22,339 [INFO]: 	>>> Finished "Compute fast metrics" in 14.8013 secs
2025-03-09 07:28:22,341 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 54.4981 secs
2025-03-09 07:28:22,341 [INFO]: {
2025-03-09 07:28:22,341 [INFO]: 	index_key: HNSW15
2025-03-09 07:28:22,341 [INFO]: 	index_param: efSearch=280
2025-03-09 07:28:22,341 [INFO]: 	index_path: knn.index
2025-03-09 07:28:22,342 [INFO]: 	size in bytes: 624858310
2025-03-09 07:28:22,342 [INFO]: 	avg_search_speed_ms: 10.718193650345487
2025-03-09 07:28:22,342 [INFO]: 	99p_search_speed_ms: 16.821088222786774
2025-03-09 07:28:22,342 [INFO]: 	reconstruction error %: 0.0
2025-03-09 07:28:22,342 [INFO]: 	nb vectors: 3176
2025-03-09 07:28:22,342 [INFO]: 	vectors dimension: 49152
2025-03-09 07:28:22,342 [INFO]: 	compression ratio: 0.9993097603199036
2025-03-09 07:28:22,342 [INFO]: }
2025-03-09 07:28:22,342 [INFO]: 	>>> Finished "Creating the index" in 54.5014 secs
2025-03-09 07:28:22,342 [INFO]: >>> Finished "Launching the whole pipeline" in 54.5280 secs
2025-03-09 07:28:23: [retrieval_preprocessing] calculating distances ...
2025-03-09 07:28:24: [retrieval_preprocessing] finished and saved retrieval indices for episode 8200 [episode count 3/20]
[retrieval_preprocessing] for episode 40460 [episode count 4/20], we have num_retrieval=np.int64(3221) num_query=np.int64(155)
2025-03-09 07:28:25,500 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-09 07:28:26,089 [INFO]: Launching the whole pipeline 03/09/2025, 07:28:26
2025-03-09 07:28:26,089 [INFO]: Reading total number of vectors and dimension 03/09/2025, 07:28:26
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1706.39it/s]
2025-03-09 07:28:26,114 [INFO]: There are 3221 embeddings of dim 49152
2025-03-09 07:28:26,114 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0253 secs
2025-03-09 07:28:26,114 [INFO]: 	Compute estimated construction time of the index 03/09/2025, 07:28:26
2025-03-09 07:28:26,114 [INFO]: 		-> Train: 16.7 minutes
2025-03-09 07:28:26,114 [INFO]: 		-> Add: 1.8 seconds
2025-03-09 07:28:26,114 [INFO]: 		Total: 16.7 minutes
2025-03-09 07:28:26,114 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0001 secs
2025-03-09 07:28:26,114 [INFO]: 	Checking that your have enough memory available to create the index 03/09/2025, 07:28:26
2025-03-09 07:28:26,114 [INFO]: 664.7MB of memory will be needed to build the index (more might be used if you have more)
2025-03-09 07:28:26,114 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0002 secs
2025-03-09 07:28:26,115 [INFO]: 	Selecting most promising index types given data characteristics 03/09/2025, 07:28:26
2025-03-09 07:28:26,115 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-09 07:28:26,115 [INFO]: 	Creating the index 03/09/2025, 07:28:26
2025-03-09 07:28:26,115 [INFO]: 		-> Instanciate the index HNSW15 03/09/2025, 07:28:26
2025-03-09 07:28:26,116 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0011 secs
2025-03-09 07:28:26,116 [INFO]: 		-> Adding the vectors to the index 03/09/2025, 07:28:26
2025-03-09 07:28:26,116 [INFO]: The memory available for adding the vectors is 49.4GB(total available - used by the index)
2025-03-09 07:28:26,116 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/13 [00:00<?, ?it/s]  8%|▊         | 1/13 [00:00<00:02,  5.89it/s] 23%|██▎       | 3/13 [00:00<00:01,  9.30it/s] 38%|███▊      | 5/13 [00:00<00:00, 11.46it/s] 54%|█████▍    | 7/13 [00:00<00:00, 11.04it/s] 85%|████████▍ | 11/13 [00:00<00:00, 18.21it/s]100%|██████████| 13/13 [00:03<00:00,  4.10it/s]
2025-03-09 07:28:29,294 [INFO]: 	Computing best hyperparameters for index knn.index 03/09/2025, 07:28:29
2025-03-09 07:29:05,441 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 36.1470 secs
2025-03-09 07:29:05,441 [INFO]: The best hyperparameters are: efSearch=286
2025-03-09 07:29:05,441 [INFO]: 	Compute fast metrics 03/09/2025, 07:29:05
  0%|          | 0/4 [00:00<?, ?it/s] 25%|██▌       | 1/4 [00:00<00:00,  6.00it/s] 75%|███████▌  | 3/4 [00:00<00:00,  8.49it/s] 75%|███████▌  | 3/4 [00:00<00:00,  6.33it/s]
2025-03-09 07:29:20,187 [INFO]: 	>>> Finished "Compute fast metrics" in 14.7459 secs
2025-03-09 07:29:20,189 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 54.0734 secs
2025-03-09 07:29:20,190 [INFO]: {
2025-03-09 07:29:20,190 [INFO]: 	index_key: HNSW15
2025-03-09 07:29:20,190 [INFO]: 	index_param: efSearch=286
2025-03-09 07:29:20,190 [INFO]: 	index_path: knn.index
2025-03-09 07:29:20,190 [INFO]: 	size in bytes: 633711850
2025-03-09 07:29:20,190 [INFO]: 	avg_search_speed_ms: 9.89117933728324
2025-03-09 07:29:20,190 [INFO]: 	99p_search_speed_ms: 13.938583922572434
2025-03-09 07:29:20,190 [INFO]: 	reconstruction error %: 0.0
2025-03-09 07:29:20,190 [INFO]: 	nb vectors: 3221
2025-03-09 07:29:20,190 [INFO]: 	vectors dimension: 49152
2025-03-09 07:29:20,190 [INFO]: 	compression ratio: 0.999309651539576
2025-03-09 07:29:20,190 [INFO]: }
2025-03-09 07:29:20,190 [INFO]: 	>>> Finished "Creating the index" in 54.0751 secs
2025-03-09 07:29:20,190 [INFO]: >>> Finished "Launching the whole pipeline" in 54.1010 secs
2025-03-09 07:29:21: [retrieval_preprocessing] calculating distances ...
2025-03-09 07:29:21: [retrieval_preprocessing] finished and saved retrieval indices for episode 40460 [episode count 4/20]
[retrieval_preprocessing] for episode 73234 [episode count 5/20], we have num_retrieval=np.int64(3232) num_query=np.int64(144)
2025-03-09 07:29:22,628 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-09 07:29:23,075 [INFO]: Launching the whole pipeline 03/09/2025, 07:29:23
2025-03-09 07:29:23,075 [INFO]: Reading total number of vectors and dimension 03/09/2025, 07:29:23
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 2225.09it/s]
2025-03-09 07:29:23,101 [INFO]: There are 3232 embeddings of dim 49152
2025-03-09 07:29:23,101 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0259 secs
2025-03-09 07:29:23,102 [INFO]: 	Compute estimated construction time of the index 03/09/2025, 07:29:23
2025-03-09 07:29:23,102 [INFO]: 		-> Train: 16.7 minutes
2025-03-09 07:29:23,102 [INFO]: 		-> Add: 1.8 seconds
2025-03-09 07:29:23,102 [INFO]: 		Total: 16.7 minutes
2025-03-09 07:29:23,102 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0003 secs
2025-03-09 07:29:23,102 [INFO]: 	Checking that your have enough memory available to create the index 03/09/2025, 07:29:23
2025-03-09 07:29:23,102 [INFO]: 667.0MB of memory will be needed to build the index (more might be used if you have more)
2025-03-09 07:29:23,103 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0004 secs
2025-03-09 07:29:23,103 [INFO]: 	Selecting most promising index types given data characteristics 03/09/2025, 07:29:23
2025-03-09 07:29:23,103 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-09 07:29:23,103 [INFO]: 	Creating the index 03/09/2025, 07:29:23
2025-03-09 07:29:23,103 [INFO]: 		-> Instanciate the index HNSW15 03/09/2025, 07:29:23
2025-03-09 07:29:23,106 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0028 secs
2025-03-09 07:29:23,106 [INFO]: 		-> Adding the vectors to the index 03/09/2025, 07:29:23
2025-03-09 07:29:23,107 [INFO]: The memory available for adding the vectors is 49.4GB(total available - used by the index)
2025-03-09 07:29:23,107 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/13 [00:00<?, ?it/s]  8%|▊         | 1/13 [00:00<00:01,  7.95it/s] 23%|██▎       | 3/13 [00:00<00:00, 11.74it/s] 38%|███▊      | 5/13 [00:00<00:00, 11.73it/s] 54%|█████▍    | 7/13 [00:00<00:00, 12.06it/s] 69%|██████▉   | 9/13 [00:00<00:00, 12.61it/s] 85%|████████▍ | 11/13 [00:00<00:00, 12.63it/s]100%|██████████| 13/13 [00:03<00:00,  2.38it/s]100%|██████████| 13/13 [00:03<00:00,  4.18it/s]
2025-03-09 07:29:26,223 [INFO]: 	Computing best hyperparameters for index knn.index 03/09/2025, 07:29:26
2025-03-09 07:30:08,271 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 42.0480 secs
2025-03-09 07:30:08,271 [INFO]: The best hyperparameters are: efSearch=248
2025-03-09 07:30:08,271 [INFO]: 	Compute fast metrics 03/09/2025, 07:30:08
  0%|          | 0/4 [00:00<?, ?it/s] 25%|██▌       | 1/4 [00:01<00:05,  1.77s/it] 50%|█████     | 2/4 [00:02<00:02,  1.28s/it] 75%|███████▌  | 3/4 [00:04<00:01,  1.46s/it] 75%|███████▌  | 3/4 [00:05<00:01,  1.67s/it]
2025-03-09 07:30:28,323 [INFO]: 	>>> Finished "Compute fast metrics" in 20.0514 secs
2025-03-09 07:30:28,325 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 65.2188 secs
2025-03-09 07:30:28,325 [INFO]: {
2025-03-09 07:30:28,325 [INFO]: 	index_key: HNSW15
2025-03-09 07:30:28,325 [INFO]: 	index_param: efSearch=248
2025-03-09 07:30:28,325 [INFO]: 	index_path: knn.index
2025-03-09 07:30:28,325 [INFO]: 	size in bytes: 635876230
2025-03-09 07:30:28,325 [INFO]: 	avg_search_speed_ms: 9.110233325550235
2025-03-09 07:30:28,325 [INFO]: 	99p_search_speed_ms: 15.48489918233826
2025-03-09 07:30:28,326 [INFO]: 	reconstruction error %: 0.0
2025-03-09 07:30:28,326 [INFO]: 	nb vectors: 3232
2025-03-09 07:30:28,326 [INFO]: 	vectors dimension: 49152
2025-03-09 07:30:28,326 [INFO]: 	compression ratio: 0.9993093404356379
2025-03-09 07:30:28,326 [INFO]: }
2025-03-09 07:30:28,326 [INFO]: 	>>> Finished "Creating the index" in 65.2224 secs
2025-03-09 07:30:28,326 [INFO]: >>> Finished "Launching the whole pipeline" in 65.2502 secs
2025-03-09 07:30:29: [retrieval_preprocessing] calculating distances ...
2025-03-09 07:30:29: [retrieval_preprocessing] finished and saved retrieval indices for episode 73234 [episode count 5/20]
[retrieval_preprocessing] for episode 83988 [episode count 6/20], we have num_retrieval=np.int64(3200) num_query=np.int64(176)
2025-03-09 07:30:37,475 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-09 07:30:38,013 [INFO]: Launching the whole pipeline 03/09/2025, 07:30:38
2025-03-09 07:30:38,013 [INFO]: Reading total number of vectors and dimension 03/09/2025, 07:30:38
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1549.43it/s]
2025-03-09 07:30:38,035 [INFO]: There are 3200 embeddings of dim 49152
2025-03-09 07:30:38,035 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0219 secs
2025-03-09 07:30:38,035 [INFO]: 	Compute estimated construction time of the index 03/09/2025, 07:30:38
2025-03-09 07:30:38,035 [INFO]: 		-> Train: 16.7 minutes
2025-03-09 07:30:38,035 [INFO]: 		-> Add: 1.8 seconds
2025-03-09 07:30:38,035 [INFO]: 		Total: 16.7 minutes
2025-03-09 07:30:38,035 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0001 secs
2025-03-09 07:30:38,035 [INFO]: 	Checking that your have enough memory available to create the index 03/09/2025, 07:30:38
2025-03-09 07:30:38,035 [INFO]: 660.4MB of memory will be needed to build the index (more might be used if you have more)
2025-03-09 07:30:38,035 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0001 secs
2025-03-09 07:30:38,035 [INFO]: 	Selecting most promising index types given data characteristics 03/09/2025, 07:30:38
2025-03-09 07:30:38,035 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-09 07:30:38,035 [INFO]: 	Creating the index 03/09/2025, 07:30:38
2025-03-09 07:30:38,036 [INFO]: 		-> Instanciate the index HNSW15 03/09/2025, 07:30:38
2025-03-09 07:30:38,037 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0009 secs
2025-03-09 07:30:38,037 [INFO]: 		-> Adding the vectors to the index 03/09/2025, 07:30:38
2025-03-09 07:30:38,037 [INFO]: The memory available for adding the vectors is 49.4GB(total available - used by the index)
2025-03-09 07:30:38,037 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/13 [00:00<?, ?it/s]  8%|▊         | 1/13 [00:00<00:02,  5.83it/s] 15%|█▌        | 2/13 [00:00<00:01,  7.33it/s] 31%|███       | 4/13 [00:00<00:00,  9.05it/s] 46%|████▌     | 6/13 [00:00<00:00,  9.66it/s] 54%|█████▍    | 7/13 [00:00<00:00,  9.34it/s] 62%|██████▏   | 8/13 [00:00<00:00,  9.21it/s] 69%|██████▉   | 9/13 [00:00<00:00,  9.37it/s] 77%|███████▋  | 10/13 [00:01<00:00,  9.12it/s] 92%|█████████▏| 12/13 [00:01<00:00,  9.52it/s]100%|██████████| 13/13 [00:04<00:00,  1.34it/s]100%|██████████| 13/13 [00:04<00:00,  3.18it/s]
2025-03-09 07:30:42,123 [INFO]: 	Computing best hyperparameters for index knn.index 03/09/2025, 07:30:42
2025-03-09 07:31:24,504 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 42.3814 secs
2025-03-09 07:31:24,505 [INFO]: The best hyperparameters are: efSearch=258
2025-03-09 07:31:24,505 [INFO]: 	Compute fast metrics 03/09/2025, 07:31:24
  0%|          | 0/4 [00:00<?, ?it/s] 25%|██▌       | 1/4 [00:00<00:00,  3.45it/s] 50%|█████     | 2/4 [00:00<00:00,  3.19it/s] 75%|███████▌  | 3/4 [00:01<00:00,  1.28it/s] 75%|███████▌  | 3/4 [00:03<00:01,  1.18s/it]
2025-03-09 07:31:44,431 [INFO]: 	>>> Finished "Compute fast metrics" in 19.9260 secs
2025-03-09 07:31:44,433 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 66.3965 secs
2025-03-09 07:31:44,433 [INFO]: {
2025-03-09 07:31:44,433 [INFO]: 	index_key: HNSW15
2025-03-09 07:31:44,433 [INFO]: 	index_param: efSearch=258
2025-03-09 07:31:44,433 [INFO]: 	index_path: knn.index
2025-03-09 07:31:44,433 [INFO]: 	size in bytes: 629580130
2025-03-09 07:31:44,433 [INFO]: 	avg_search_speed_ms: 9.654163846361332
2025-03-09 07:31:44,433 [INFO]: 	99p_search_speed_ms: 15.387727960478534
2025-03-09 07:31:44,433 [INFO]: 	reconstruction error %: 0.0
2025-03-09 07:31:44,433 [INFO]: 	nb vectors: 3200
2025-03-09 07:31:44,433 [INFO]: 	vectors dimension: 49152
2025-03-09 07:31:44,433 [INFO]: 	compression ratio: 0.999309809856928
2025-03-09 07:31:44,433 [INFO]: }
2025-03-09 07:31:44,433 [INFO]: 	>>> Finished "Creating the index" in 66.3980 secs
2025-03-09 07:31:44,433 [INFO]: >>> Finished "Launching the whole pipeline" in 66.4204 secs
2025-03-09 07:31:45: [retrieval_preprocessing] calculating distances ...
2025-03-09 07:31:46: [retrieval_preprocessing] finished and saved retrieval indices for episode 83988 [episode count 6/20]
[retrieval_preprocessing] for episode 65557 [episode count 7/20], we have num_retrieval=np.int64(3259) num_query=np.int64(117)
2025-03-09 07:31:50,281 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-09 07:31:51,058 [INFO]: Launching the whole pipeline 03/09/2025, 07:31:51
2025-03-09 07:31:51,058 [INFO]: Reading total number of vectors and dimension 03/09/2025, 07:31:51
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1767.51it/s]
2025-03-09 07:31:51,083 [INFO]: There are 3259 embeddings of dim 49152
2025-03-09 07:31:51,084 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0255 secs
2025-03-09 07:31:51,084 [INFO]: 	Compute estimated construction time of the index 03/09/2025, 07:31:51
2025-03-09 07:31:51,084 [INFO]: 		-> Train: 16.7 minutes
2025-03-09 07:31:51,084 [INFO]: 		-> Add: 1.8 seconds
2025-03-09 07:31:51,084 [INFO]: 		Total: 16.7 minutes
2025-03-09 07:31:51,084 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0004 secs
2025-03-09 07:31:51,085 [INFO]: 	Checking that your have enough memory available to create the index 03/09/2025, 07:31:51
2025-03-09 07:31:51,085 [INFO]: 672.6MB of memory will be needed to build the index (more might be used if you have more)
2025-03-09 07:31:51,085 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0004 secs
2025-03-09 07:31:51,085 [INFO]: 	Selecting most promising index types given data characteristics 03/09/2025, 07:31:51
2025-03-09 07:31:51,085 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-09 07:31:51,085 [INFO]: 	Creating the index 03/09/2025, 07:31:51
2025-03-09 07:31:51,085 [INFO]: 		-> Instanciate the index HNSW15 03/09/2025, 07:31:51
2025-03-09 07:31:51,088 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0028 secs
2025-03-09 07:31:51,089 [INFO]: 		-> Adding the vectors to the index 03/09/2025, 07:31:51
2025-03-09 07:31:51,089 [INFO]: The memory available for adding the vectors is 49.4GB(total available - used by the index)
2025-03-09 07:31:51,089 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/13 [00:00<?, ?it/s]  8%|▊         | 1/13 [00:00<00:02,  5.11it/s] 23%|██▎       | 3/13 [00:00<00:01,  9.27it/s] 38%|███▊      | 5/13 [00:00<00:00, 10.83it/s] 54%|█████▍    | 7/13 [00:00<00:00, 11.60it/s] 69%|██████▉   | 9/13 [00:01<00:00,  7.93it/s] 77%|███████▋  | 10/13 [00:01<00:00,  7.24it/s] 85%|████████▍ | 11/13 [00:01<00:00,  6.88it/s] 92%|█████████▏| 12/13 [00:02<00:00,  2.31it/s]100%|██████████| 13/13 [00:05<00:00,  1.15s/it]100%|██████████| 13/13 [00:05<00:00,  2.22it/s]
2025-03-09 07:31:56,948 [INFO]: 	Computing best hyperparameters for index knn.index 03/09/2025, 07:31:56
2025-03-09 07:32:32,613 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 35.6653 secs
2025-03-09 07:32:32,614 [INFO]: The best hyperparameters are: efSearch=263
2025-03-09 07:32:32,614 [INFO]: 	Compute fast metrics 03/09/2025, 07:32:32
  0%|          | 0/4 [00:00<?, ?it/s] 25%|██▌       | 1/4 [00:00<00:00,  5.31it/s] 50%|█████     | 2/4 [00:00<00:00,  6.96it/s] 75%|███████▌  | 3/4 [00:00<00:00,  7.86it/s] 75%|███████▌  | 3/4 [00:00<00:00,  5.95it/s]
2025-03-09 07:32:45,711 [INFO]: 	>>> Finished "Compute fast metrics" in 13.0977 secs
2025-03-09 07:32:45,720 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 54.6311 secs
2025-03-09 07:32:45,720 [INFO]: {
2025-03-09 07:32:45,720 [INFO]: 	index_key: HNSW15
2025-03-09 07:32:45,720 [INFO]: 	index_param: efSearch=263
2025-03-09 07:32:45,720 [INFO]: 	index_path: knn.index
2025-03-09 07:32:45,720 [INFO]: 	size in bytes: 641188450
2025-03-09 07:32:45,720 [INFO]: 	avg_search_speed_ms: 11.77480675223052
2025-03-09 07:32:45,720 [INFO]: 	99p_search_speed_ms: 17.372363274917003
2025-03-09 07:32:45,720 [INFO]: 	reconstruction error %: 0.0
2025-03-09 07:32:45,720 [INFO]: 	nb vectors: 3259
2025-03-09 07:32:45,720 [INFO]: 	vectors dimension: 49152
2025-03-09 07:32:45,720 [INFO]: 	compression ratio: 0.999309129788598
2025-03-09 07:32:45,720 [INFO]: }
2025-03-09 07:32:45,720 [INFO]: 	>>> Finished "Creating the index" in 54.6349 secs
2025-03-09 07:32:45,720 [INFO]: >>> Finished "Launching the whole pipeline" in 54.6621 secs
2025-03-09 07:32:46: [retrieval_preprocessing] calculating distances ...
2025-03-09 07:32:46: [retrieval_preprocessing] finished and saved retrieval indices for episode 65557 [episode count 7/20]
[retrieval_preprocessing] for episode 32791 [episode count 8/20], we have num_retrieval=np.int64(3196) num_query=np.int64(180)
2025-03-09 07:32:47,821 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-09 07:32:48,239 [INFO]: Launching the whole pipeline 03/09/2025, 07:32:48
2025-03-09 07:32:48,239 [INFO]: Reading total number of vectors and dimension 03/09/2025, 07:32:48
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1531.89it/s]
2025-03-09 07:32:48,263 [INFO]: There are 3196 embeddings of dim 49152
2025-03-09 07:32:48,263 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0241 secs
2025-03-09 07:32:48,263 [INFO]: 	Compute estimated construction time of the index 03/09/2025, 07:32:48
2025-03-09 07:32:48,263 [INFO]: 		-> Train: 16.7 minutes
2025-03-09 07:32:48,263 [INFO]: 		-> Add: 1.8 seconds
2025-03-09 07:32:48,263 [INFO]: 		Total: 16.7 minutes
2025-03-09 07:32:48,263 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0001 secs
2025-03-09 07:32:48,263 [INFO]: 	Checking that your have enough memory available to create the index 03/09/2025, 07:32:48
2025-03-09 07:32:48,263 [INFO]: 659.6MB of memory will be needed to build the index (more might be used if you have more)
2025-03-09 07:32:48,263 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0001 secs
2025-03-09 07:32:48,263 [INFO]: 	Selecting most promising index types given data characteristics 03/09/2025, 07:32:48
2025-03-09 07:32:48,263 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-09 07:32:48,264 [INFO]: 	Creating the index 03/09/2025, 07:32:48
2025-03-09 07:32:48,264 [INFO]: 		-> Instanciate the index HNSW15 03/09/2025, 07:32:48
2025-03-09 07:32:48,264 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0009 secs
2025-03-09 07:32:48,265 [INFO]: 		-> Adding the vectors to the index 03/09/2025, 07:32:48
2025-03-09 07:32:48,265 [INFO]: The memory available for adding the vectors is 49.4GB(total available - used by the index)
2025-03-09 07:32:48,265 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/13 [00:00<?, ?it/s]  8%|▊         | 1/13 [00:00<00:01,  6.07it/s] 23%|██▎       | 3/13 [00:00<00:00, 12.09it/s] 38%|███▊      | 5/13 [00:00<00:00, 14.34it/s] 54%|█████▍    | 7/13 [00:00<00:00, 14.95it/s] 69%|██████▉   | 9/13 [00:00<00:00, 14.63it/s] 85%|████████▍ | 11/13 [00:00<00:00, 15.40it/s]100%|██████████| 13/13 [00:03<00:00,  2.32it/s]100%|██████████| 13/13 [00:03<00:00,  4.20it/s]
2025-03-09 07:32:51,365 [INFO]: 	Computing best hyperparameters for index knn.index 03/09/2025, 07:32:51
2025-03-09 07:33:27,609 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 36.2427 secs
2025-03-09 07:33:27,609 [INFO]: The best hyperparameters are: efSearch=283
2025-03-09 07:33:27,609 [INFO]: 	Compute fast metrics 03/09/2025, 07:33:27
  0%|          | 0/4 [00:00<?, ?it/s] 25%|██▌       | 1/4 [00:01<00:03,  1.31s/it] 75%|███████▌  | 3/4 [00:01<00:00,  2.02it/s]
2025-03-09 07:33:57,095 [INFO]: 	>>> Finished "Compute fast metrics" in 29.4859 secs
2025-03-09 07:33:57,097 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 68.8329 secs
2025-03-09 07:33:57,098 [INFO]: {
2025-03-09 07:33:57,098 [INFO]: 	index_key: HNSW15
2025-03-09 07:33:57,098 [INFO]: 	index_param: efSearch=283
2025-03-09 07:33:57,098 [INFO]: 	index_path: knn.index
2025-03-09 07:33:57,098 [INFO]: 	size in bytes: 628793170
2025-03-09 07:33:57,098 [INFO]: 	avg_search_speed_ms: 11.278563572551631
2025-03-09 07:33:57,098 [INFO]: 	99p_search_speed_ms: 22.389047802425917
2025-03-09 07:33:57,098 [INFO]: 	reconstruction error %: 0.0
2025-03-09 07:33:57,098 [INFO]: 	nb vectors: 3196
2025-03-09 07:33:57,098 [INFO]: 	vectors dimension: 49152
2025-03-09 07:33:57,098 [INFO]: 	compression ratio: 0.9993097857599185
2025-03-09 07:33:57,098 [INFO]: }
2025-03-09 07:33:57,098 [INFO]: 	>>> Finished "Creating the index" in 68.8342 secs
2025-03-09 07:33:57,098 [INFO]: >>> Finished "Launching the whole pipeline" in 68.8588 secs
2025-03-09 07:33:58: [retrieval_preprocessing] calculating distances ...
2025-03-09 07:33:58: [retrieval_preprocessing] finished and saved retrieval indices for episode 32791 [episode count 8/20]
[retrieval_preprocessing] for episode 9756 [episode count 9/20], we have num_retrieval=np.int64(3174) num_query=np.int64(202)
2025-03-09 07:33:59,798 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-09 07:34:00,321 [INFO]: Launching the whole pipeline 03/09/2025, 07:34:00
2025-03-09 07:34:00,321 [INFO]: Reading total number of vectors and dimension 03/09/2025, 07:34:00
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1168.33it/s]
2025-03-09 07:34:00,350 [INFO]: There are 3174 embeddings of dim 49152
2025-03-09 07:34:00,350 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0292 secs
2025-03-09 07:34:00,351 [INFO]: 	Compute estimated construction time of the index 03/09/2025, 07:34:00
2025-03-09 07:34:00,351 [INFO]: 		-> Train: 16.7 minutes
2025-03-09 07:34:00,351 [INFO]: 		-> Add: 1.7 seconds
2025-03-09 07:34:00,351 [INFO]: 		Total: 16.7 minutes
2025-03-09 07:34:00,351 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0004 secs
2025-03-09 07:34:00,351 [INFO]: 	Checking that your have enough memory available to create the index 03/09/2025, 07:34:00
2025-03-09 07:34:00,352 [INFO]: 655.0MB of memory will be needed to build the index (more might be used if you have more)
2025-03-09 07:34:00,352 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0004 secs
2025-03-09 07:34:00,352 [INFO]: 	Selecting most promising index types given data characteristics 03/09/2025, 07:34:00
2025-03-09 07:34:00,352 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-09 07:34:00,352 [INFO]: 	Creating the index 03/09/2025, 07:34:00
2025-03-09 07:34:00,352 [INFO]: 		-> Instanciate the index HNSW15 03/09/2025, 07:34:00
2025-03-09 07:34:00,355 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0029 secs
2025-03-09 07:34:00,356 [INFO]: 		-> Adding the vectors to the index 03/09/2025, 07:34:00
2025-03-09 07:34:00,356 [INFO]: The memory available for adding the vectors is 49.4GB(total available - used by the index)
2025-03-09 07:34:00,356 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/13 [00:00<?, ?it/s]  8%|▊         | 1/13 [00:00<00:01,  6.06it/s] 31%|███       | 4/13 [00:00<00:00, 14.49it/s] 46%|████▌     | 6/13 [00:00<00:00, 16.39it/s] 62%|██████▏   | 8/13 [00:00<00:00, 13.23it/s] 77%|███████▋  | 10/13 [00:00<00:00, 10.41it/s] 92%|█████████▏| 12/13 [00:03<00:00,  2.12it/s]100%|██████████| 13/13 [00:05<00:00,  1.13it/s]100%|██████████| 13/13 [00:05<00:00,  2.20it/s]
2025-03-09 07:34:06,276 [INFO]: 	Computing best hyperparameters for index knn.index 03/09/2025, 07:34:06
2025-03-09 07:34:37,384 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 31.1074 secs
2025-03-09 07:34:37,384 [INFO]: The best hyperparameters are: efSearch=265
2025-03-09 07:34:37,384 [INFO]: 	Compute fast metrics 03/09/2025, 07:34:37
  0%|          | 0/4 [00:00<?, ?it/s] 25%|██▌       | 1/4 [00:00<00:00,  5.49it/s] 50%|█████     | 2/4 [00:00<00:00,  6.96it/s] 75%|███████▌  | 3/4 [00:00<00:00,  7.49it/s] 75%|███████▌  | 3/4 [00:00<00:00,  5.67it/s]
2025-03-09 07:35:02,847 [INFO]: 	>>> Finished "Compute fast metrics" in 25.4631 secs
2025-03-09 07:35:02,859 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 62.5035 secs
2025-03-09 07:35:02,859 [INFO]: {
2025-03-09 07:35:02,859 [INFO]: 	index_key: HNSW15
2025-03-09 07:35:02,859 [INFO]: 	index_param: efSearch=265
2025-03-09 07:35:02,859 [INFO]: 	index_path: knn.index
2025-03-09 07:35:02,859 [INFO]: 	size in bytes: 624464830
2025-03-09 07:35:02,859 [INFO]: 	avg_search_speed_ms: 11.007163690544493
2025-03-09 07:35:02,859 [INFO]: 	99p_search_speed_ms: 21.51448345743119
2025-03-09 07:35:02,859 [INFO]: 	reconstruction error %: 0.0
2025-03-09 07:35:02,859 [INFO]: 	nb vectors: 3174
2025-03-09 07:35:02,859 [INFO]: 	vectors dimension: 49152
2025-03-09 07:35:02,859 [INFO]: 	compression ratio: 0.9993097481566736
2025-03-09 07:35:02,859 [INFO]: }
2025-03-09 07:35:02,859 [INFO]: 	>>> Finished "Creating the index" in 62.5073 secs
2025-03-09 07:35:02,859 [INFO]: >>> Finished "Launching the whole pipeline" in 62.5383 secs
2025-03-09 07:35:04: [retrieval_preprocessing] calculating distances ...
2025-03-09 07:35:04: [retrieval_preprocessing] finished and saved retrieval indices for episode 9756 [episode count 9/20]
[retrieval_preprocessing] for episode 15393 [episode count 10/20], we have num_retrieval=np.int64(3184) num_query=np.int64(192)
2025-03-09 07:35:10,142 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-09 07:35:10,562 [INFO]: Launching the whole pipeline 03/09/2025, 07:35:10
2025-03-09 07:35:10,562 [INFO]: Reading total number of vectors and dimension 03/09/2025, 07:35:10
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1781.02it/s]
2025-03-09 07:35:10,586 [INFO]: There are 3184 embeddings of dim 49152
2025-03-09 07:35:10,586 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0240 secs
2025-03-09 07:35:10,586 [INFO]: 	Compute estimated construction time of the index 03/09/2025, 07:35:10
2025-03-09 07:35:10,586 [INFO]: 		-> Train: 16.7 minutes
2025-03-09 07:35:10,586 [INFO]: 		-> Add: 1.7 seconds
2025-03-09 07:35:10,586 [INFO]: 		Total: 16.7 minutes
2025-03-09 07:35:10,586 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0001 secs
2025-03-09 07:35:10,587 [INFO]: 	Checking that your have enough memory available to create the index 03/09/2025, 07:35:10
2025-03-09 07:35:10,587 [INFO]: 657.1MB of memory will be needed to build the index (more might be used if you have more)
2025-03-09 07:35:10,587 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0001 secs
2025-03-09 07:35:10,587 [INFO]: 	Selecting most promising index types given data characteristics 03/09/2025, 07:35:10
2025-03-09 07:35:10,587 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-09 07:35:10,587 [INFO]: 	Creating the index 03/09/2025, 07:35:10
2025-03-09 07:35:10,587 [INFO]: 		-> Instanciate the index HNSW15 03/09/2025, 07:35:10
2025-03-09 07:35:10,588 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0010 secs
2025-03-09 07:35:10,588 [INFO]: 		-> Adding the vectors to the index 03/09/2025, 07:35:10
2025-03-09 07:35:10,588 [INFO]: The memory available for adding the vectors is 49.4GB(total available - used by the index)
2025-03-09 07:35:10,588 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/13 [00:00<?, ?it/s] 15%|█▌        | 2/13 [00:00<00:00, 15.95it/s] 31%|███       | 4/13 [00:01<00:04,  2.18it/s] 54%|█████▍    | 7/13 [00:01<00:01,  4.30it/s] 69%|██████▉   | 9/13 [00:01<00:00,  5.68it/s] 85%|████████▍ | 11/13 [00:02<00:00,  7.06it/s]100%|██████████| 13/13 [00:04<00:00,  2.24it/s]100%|██████████| 13/13 [00:04<00:00,  3.08it/s]
2025-03-09 07:35:14,813 [INFO]: 	Computing best hyperparameters for index knn.index 03/09/2025, 07:35:14
2025-03-09 07:35:54,051 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 39.2372 secs
2025-03-09 07:35:54,051 [INFO]: The best hyperparameters are: efSearch=252
2025-03-09 07:35:54,051 [INFO]: 	Compute fast metrics 03/09/2025, 07:35:54
  0%|          | 0/4 [00:00<?, ?it/s] 25%|██▌       | 1/4 [00:00<00:00,  7.52it/s] 75%|███████▌  | 3/4 [00:00<00:00, 11.95it/s] 75%|███████▌  | 3/4 [00:00<00:00,  9.13it/s]
2025-03-09 07:36:11,365 [INFO]: 	>>> Finished "Compute fast metrics" in 17.3132 secs
2025-03-09 07:36:11,367 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 60.7793 secs
2025-03-09 07:36:11,367 [INFO]: {
2025-03-09 07:36:11,367 [INFO]: 	index_key: HNSW15
2025-03-09 07:36:11,368 [INFO]: 	index_param: efSearch=252
2025-03-09 07:36:11,368 [INFO]: 	index_path: knn.index
2025-03-09 07:36:11,368 [INFO]: 	size in bytes: 626432290
2025-03-09 07:36:11,368 [INFO]: 	avg_search_speed_ms: 11.036348323056075
2025-03-09 07:36:11,368 [INFO]: 	99p_search_speed_ms: 19.35228182701394
2025-03-09 07:36:11,368 [INFO]: 	reconstruction error %: 0.0
2025-03-09 07:36:11,368 [INFO]: 	nb vectors: 3184
2025-03-09 07:36:11,368 [INFO]: 	vectors dimension: 49152
2025-03-09 07:36:11,368 [INFO]: 	compression ratio: 0.9993097131056256
2025-03-09 07:36:11,368 [INFO]: }
2025-03-09 07:36:11,368 [INFO]: 	>>> Finished "Creating the index" in 60.7807 secs
2025-03-09 07:36:11,368 [INFO]: >>> Finished "Launching the whole pipeline" in 60.8054 secs
2025-03-09 07:36:12: [retrieval_preprocessing] calculating distances ...
2025-03-09 07:36:13: [retrieval_preprocessing] finished and saved retrieval indices for episode 15393 [episode count 10/20]
[retrieval_preprocessing] for episode 26145 [episode count 11/20], we have num_retrieval=np.int64(3188) num_query=np.int64(188)
2025-03-09 07:36:15,526 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-09 07:36:16,099 [INFO]: Launching the whole pipeline 03/09/2025, 07:36:16
2025-03-09 07:36:16,099 [INFO]: Reading total number of vectors and dimension 03/09/2025, 07:36:16
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1636.48it/s]
2025-03-09 07:36:16,123 [INFO]: There are 3188 embeddings of dim 49152
2025-03-09 07:36:16,123 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0239 secs
2025-03-09 07:36:16,123 [INFO]: 	Compute estimated construction time of the index 03/09/2025, 07:36:16
2025-03-09 07:36:16,123 [INFO]: 		-> Train: 16.7 minutes
2025-03-09 07:36:16,123 [INFO]: 		-> Add: 1.8 seconds
2025-03-09 07:36:16,123 [INFO]: 		Total: 16.7 minutes
2025-03-09 07:36:16,123 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0001 secs
2025-03-09 07:36:16,123 [INFO]: 	Checking that your have enough memory available to create the index 03/09/2025, 07:36:16
2025-03-09 07:36:16,123 [INFO]: 657.9MB of memory will be needed to build the index (more might be used if you have more)
2025-03-09 07:36:16,123 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0001 secs
2025-03-09 07:36:16,123 [INFO]: 	Selecting most promising index types given data characteristics 03/09/2025, 07:36:16
2025-03-09 07:36:16,123 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-09 07:36:16,123 [INFO]: 	Creating the index 03/09/2025, 07:36:16
2025-03-09 07:36:16,123 [INFO]: 		-> Instanciate the index HNSW15 03/09/2025, 07:36:16
2025-03-09 07:36:16,124 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0009 secs
2025-03-09 07:36:16,124 [INFO]: 		-> Adding the vectors to the index 03/09/2025, 07:36:16
2025-03-09 07:36:16,124 [INFO]: The memory available for adding the vectors is 49.4GB(total available - used by the index)
2025-03-09 07:36:16,124 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/13 [00:00<?, ?it/s]  8%|▊         | 1/13 [00:00<00:02,  4.86it/s] 15%|█▌        | 2/13 [00:00<00:02,  5.48it/s] 23%|██▎       | 3/13 [00:00<00:01,  6.81it/s] 31%|███       | 4/13 [00:01<00:04,  1.94it/s] 38%|███▊      | 5/13 [00:02<00:06,  1.32it/s] 46%|████▌     | 6/13 [00:03<00:05,  1.18it/s] 54%|█████▍    | 7/13 [00:04<00:04,  1.21it/s] 62%|██████▏   | 8/13 [00:05<00:04,  1.19it/s] 69%|██████▉   | 9/13 [00:06<00:03,  1.31it/s] 77%|███████▋  | 10/13 [00:06<00:02,  1.46it/s] 85%|████████▍ | 11/13 [00:06<00:01,  1.86it/s]100%|██████████| 13/13 [00:09<00:00,  1.21it/s]100%|██████████| 13/13 [00:09<00:00,  1.44it/s]
2025-03-09 07:36:25,164 [INFO]: 	Computing best hyperparameters for index knn.index 03/09/2025, 07:36:25
2025-03-09 07:37:01,358 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 36.1933 secs
2025-03-09 07:37:01,358 [INFO]: The best hyperparameters are: efSearch=290
2025-03-09 07:37:01,358 [INFO]: 	Compute fast metrics 03/09/2025, 07:37:01
  0%|          | 0/4 [00:00<?, ?it/s] 25%|██▌       | 1/4 [00:02<00:06,  2.16s/it] 50%|█████     | 2/4 [00:03<00:03,  1.95s/it] 75%|███████▌  | 3/4 [00:04<00:01,  1.15s/it] 75%|███████▌  | 3/4 [00:04<00:01,  1.42s/it]
2025-03-09 07:37:18,335 [INFO]: 	>>> Finished "Compute fast metrics" in 16.9766 secs
2025-03-09 07:37:18,351 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 62.2268 secs
2025-03-09 07:37:18,351 [INFO]: {
2025-03-09 07:37:18,351 [INFO]: 	index_key: HNSW15
2025-03-09 07:37:18,351 [INFO]: 	index_param: efSearch=290
2025-03-09 07:37:18,351 [INFO]: 	index_path: knn.index
2025-03-09 07:37:18,351 [INFO]: 	size in bytes: 627219250
2025-03-09 07:37:18,351 [INFO]: 	avg_search_speed_ms: 10.598282020201639
2025-03-09 07:37:18,351 [INFO]: 	99p_search_speed_ms: 17.19806535402312
2025-03-09 07:37:18,351 [INFO]: 	reconstruction error %: 0.0
2025-03-09 07:37:18,352 [INFO]: 	nb vectors: 3188
2025-03-09 07:37:18,352 [INFO]: 	vectors dimension: 49152
2025-03-09 07:37:18,352 [INFO]: 	compression ratio: 0.9993097373844951
2025-03-09 07:37:18,352 [INFO]: }
2025-03-09 07:37:18,352 [INFO]: 	>>> Finished "Creating the index" in 62.2282 secs
2025-03-09 07:37:18,352 [INFO]: >>> Finished "Launching the whole pipeline" in 62.2528 secs
2025-03-09 07:37:19: [retrieval_preprocessing] calculating distances ...
2025-03-09 07:37:20: [retrieval_preprocessing] finished and saved retrieval indices for episode 26145 [episode count 11/20]
[retrieval_preprocessing] for episode 94764 [episode count 12/20], we have num_retrieval=np.int64(3166) num_query=np.int64(210)
2025-03-09 07:37:21,313 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-09 07:37:21,766 [INFO]: Launching the whole pipeline 03/09/2025, 07:37:21
2025-03-09 07:37:21,766 [INFO]: Reading total number of vectors and dimension 03/09/2025, 07:37:21
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1749.08it/s]
2025-03-09 07:37:21,793 [INFO]: There are 3166 embeddings of dim 49152
2025-03-09 07:37:21,794 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0274 secs
2025-03-09 07:37:21,794 [INFO]: 	Compute estimated construction time of the index 03/09/2025, 07:37:21
2025-03-09 07:37:21,794 [INFO]: 		-> Train: 16.7 minutes
2025-03-09 07:37:21,794 [INFO]: 		-> Add: 1.7 seconds
2025-03-09 07:37:21,794 [INFO]: 		Total: 16.7 minutes
2025-03-09 07:37:21,794 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0001 secs
2025-03-09 07:37:21,794 [INFO]: 	Checking that your have enough memory available to create the index 03/09/2025, 07:37:21
2025-03-09 07:37:21,794 [INFO]: 653.4MB of memory will be needed to build the index (more might be used if you have more)
2025-03-09 07:37:21,794 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0001 secs
2025-03-09 07:37:21,794 [INFO]: 	Selecting most promising index types given data characteristics 03/09/2025, 07:37:21
2025-03-09 07:37:21,794 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-09 07:37:21,794 [INFO]: 	Creating the index 03/09/2025, 07:37:21
2025-03-09 07:37:21,794 [INFO]: 		-> Instanciate the index HNSW15 03/09/2025, 07:37:21
2025-03-09 07:37:21,795 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0009 secs
2025-03-09 07:37:21,795 [INFO]: 		-> Adding the vectors to the index 03/09/2025, 07:37:21
2025-03-09 07:37:21,795 [INFO]: The memory available for adding the vectors is 49.4GB(total available - used by the index)
2025-03-09 07:37:21,795 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/13 [00:00<?, ?it/s]  8%|▊         | 1/13 [00:00<00:01,  6.21it/s] 15%|█▌        | 2/13 [00:00<00:01,  7.35it/s] 23%|██▎       | 3/13 [00:00<00:01,  7.80it/s] 31%|███       | 4/13 [00:00<00:01,  7.89it/s] 38%|███▊      | 5/13 [00:00<00:00,  8.02it/s] 46%|████▌     | 6/13 [00:00<00:00,  8.06it/s] 54%|█████▍    | 7/13 [00:00<00:00,  8.13it/s] 62%|██████▏   | 8/13 [00:01<00:00,  8.04it/s] 69%|██████▉   | 9/13 [00:01<00:00,  8.01it/s] 77%|███████▋  | 10/13 [00:01<00:00,  8.00it/s] 85%|████████▍ | 11/13 [00:01<00:00,  7.97it/s] 92%|█████████▏| 12/13 [00:01<00:00,  7.74it/s]100%|██████████| 13/13 [00:03<00:00,  1.26it/s]100%|██████████| 13/13 [00:03<00:00,  3.37it/s]
2025-03-09 07:37:25,656 [INFO]: 	Computing best hyperparameters for index knn.index 03/09/2025, 07:37:25
2025-03-09 07:38:01,472 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 35.8150 secs
2025-03-09 07:38:01,472 [INFO]: The best hyperparameters are: efSearch=274
2025-03-09 07:38:01,472 [INFO]: 	Compute fast metrics 03/09/2025, 07:38:01
  0%|          | 0/4 [00:00<?, ?it/s] 25%|██▌       | 1/4 [00:00<00:00,  7.74it/s] 75%|███████▌  | 3/4 [00:00<00:00, 11.79it/s] 75%|███████▌  | 3/4 [00:00<00:00,  9.35it/s]
2025-03-09 07:38:13,900 [INFO]: 	>>> Finished "Compute fast metrics" in 12.4277 secs
2025-03-09 07:38:13,903 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 52.1074 secs
2025-03-09 07:38:13,903 [INFO]: {
2025-03-09 07:38:13,903 [INFO]: 	index_key: HNSW15
2025-03-09 07:38:13,903 [INFO]: 	index_param: efSearch=274
2025-03-09 07:38:13,903 [INFO]: 	index_path: knn.index
2025-03-09 07:38:13,903 [INFO]: 	size in bytes: 622890910
2025-03-09 07:38:13,903 [INFO]: 	avg_search_speed_ms: 9.971480653180201
2025-03-09 07:38:13,903 [INFO]: 	99p_search_speed_ms: 14.315314800478518
2025-03-09 07:38:13,903 [INFO]: 	reconstruction error %: 0.0
2025-03-09 07:38:13,903 [INFO]: 	nb vectors: 3166
2025-03-09 07:38:13,903 [INFO]: 	vectors dimension: 49152
2025-03-09 07:38:13,903 [INFO]: 	compression ratio: 0.9993096993500836
2025-03-09 07:38:13,903 [INFO]: }
2025-03-09 07:38:13,903 [INFO]: 	>>> Finished "Creating the index" in 52.1089 secs
2025-03-09 07:38:13,903 [INFO]: >>> Finished "Launching the whole pipeline" in 52.1368 secs
2025-03-09 07:38:15: [retrieval_preprocessing] calculating distances ...
2025-03-09 07:38:16: [retrieval_preprocessing] finished and saved retrieval indices for episode 94764 [episode count 12/20]
[retrieval_preprocessing] for episode 59439 [episode count 13/20], we have num_retrieval=np.int64(3222) num_query=np.int64(154)
2025-03-09 07:38:17,136 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-09 07:38:17,598 [INFO]: Launching the whole pipeline 03/09/2025, 07:38:17
2025-03-09 07:38:17,598 [INFO]: Reading total number of vectors and dimension 03/09/2025, 07:38:17
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 2355.03it/s]
2025-03-09 07:38:17,622 [INFO]: There are 3222 embeddings of dim 49152
2025-03-09 07:38:17,622 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0243 secs
2025-03-09 07:38:17,623 [INFO]: 	Compute estimated construction time of the index 03/09/2025, 07:38:17
2025-03-09 07:38:17,623 [INFO]: 		-> Train: 16.7 minutes
2025-03-09 07:38:17,623 [INFO]: 		-> Add: 1.8 seconds
2025-03-09 07:38:17,623 [INFO]: 		Total: 16.7 minutes
2025-03-09 07:38:17,623 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0001 secs
2025-03-09 07:38:17,623 [INFO]: 	Checking that your have enough memory available to create the index 03/09/2025, 07:38:17
2025-03-09 07:38:17,623 [INFO]: 664.9MB of memory will be needed to build the index (more might be used if you have more)
2025-03-09 07:38:17,623 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0002 secs
2025-03-09 07:38:17,623 [INFO]: 	Selecting most promising index types given data characteristics 03/09/2025, 07:38:17
2025-03-09 07:38:17,624 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-09 07:38:17,624 [INFO]: 	Creating the index 03/09/2025, 07:38:17
2025-03-09 07:38:17,624 [INFO]: 		-> Instanciate the index HNSW15 03/09/2025, 07:38:17
2025-03-09 07:38:17,625 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0009 secs
2025-03-09 07:38:17,625 [INFO]: 		-> Adding the vectors to the index 03/09/2025, 07:38:17
2025-03-09 07:38:17,625 [INFO]: The memory available for adding the vectors is 49.4GB(total available - used by the index)
2025-03-09 07:38:17,625 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/13 [00:00<?, ?it/s]  8%|▊         | 1/13 [00:00<00:01,  6.47it/s] 23%|██▎       | 3/13 [00:00<00:00, 11.82it/s] 54%|█████▍    | 7/13 [00:00<00:00, 20.34it/s] 77%|███████▋  | 10/13 [00:00<00:00, 16.83it/s] 92%|█████████▏| 12/13 [00:00<00:00, 17.12it/s]100%|██████████| 13/13 [00:03<00:00,  3.95it/s]
2025-03-09 07:38:20,922 [INFO]: 	Computing best hyperparameters for index knn.index 03/09/2025, 07:38:20
2025-03-09 07:38:54,274 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 33.3518 secs
2025-03-09 07:38:54,274 [INFO]: The best hyperparameters are: efSearch=255
2025-03-09 07:38:54,274 [INFO]: 	Compute fast metrics 03/09/2025, 07:38:54
  0%|          | 0/4 [00:00<?, ?it/s] 25%|██▌       | 1/4 [00:00<00:00,  6.75it/s] 75%|███████▌  | 3/4 [00:00<00:00,  8.84it/s] 75%|███████▌  | 3/4 [00:00<00:00,  6.70it/s]
2025-03-09 07:39:07,167 [INFO]: 	>>> Finished "Compute fast metrics" in 12.8923 secs
2025-03-09 07:39:07,169 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 49.5444 secs
2025-03-09 07:39:07,169 [INFO]: {
2025-03-09 07:39:07,169 [INFO]: 	index_key: HNSW15
2025-03-09 07:39:07,169 [INFO]: 	index_param: efSearch=255
2025-03-09 07:39:07,169 [INFO]: 	index_path: knn.index
2025-03-09 07:39:07,169 [INFO]: 	size in bytes: 633908590
2025-03-09 07:39:07,169 [INFO]: 	avg_search_speed_ms: 10.345935290862325
2025-03-09 07:39:07,169 [INFO]: 	99p_search_speed_ms: 18.426860603503897
2025-03-09 07:39:07,169 [INFO]: 	reconstruction error %: 0.0
2025-03-09 07:39:07,169 [INFO]: 	nb vectors: 3222
2025-03-09 07:39:07,169 [INFO]: 	vectors dimension: 49152
2025-03-09 07:39:07,169 [INFO]: 	compression ratio: 0.9993096575643501
2025-03-09 07:39:07,169 [INFO]: }
2025-03-09 07:39:07,169 [INFO]: 	>>> Finished "Creating the index" in 49.5457 secs
2025-03-09 07:39:07,169 [INFO]: >>> Finished "Launching the whole pipeline" in 49.5712 secs
2025-03-09 07:39:08: [retrieval_preprocessing] calculating distances ...
2025-03-09 07:39:08: [retrieval_preprocessing] finished and saved retrieval indices for episode 59439 [episode count 13/20]
[retrieval_preprocessing] for episode 92207 [episode count 14/20], we have num_retrieval=np.int64(3223) num_query=np.int64(153)
2025-03-09 07:39:09,767 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-09 07:39:10,262 [INFO]: Launching the whole pipeline 03/09/2025, 07:39:10
2025-03-09 07:39:10,262 [INFO]: Reading total number of vectors and dimension 03/09/2025, 07:39:10
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1945.41it/s]
2025-03-09 07:39:10,287 [INFO]: There are 3223 embeddings of dim 49152
2025-03-09 07:39:10,287 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0250 secs
2025-03-09 07:39:10,287 [INFO]: 	Compute estimated construction time of the index 03/09/2025, 07:39:10
2025-03-09 07:39:10,288 [INFO]: 		-> Train: 16.7 minutes
2025-03-09 07:39:10,288 [INFO]: 		-> Add: 1.8 seconds
2025-03-09 07:39:10,288 [INFO]: 		Total: 16.7 minutes
2025-03-09 07:39:10,288 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0004 secs
2025-03-09 07:39:10,288 [INFO]: 	Checking that your have enough memory available to create the index 03/09/2025, 07:39:10
2025-03-09 07:39:10,288 [INFO]: 665.1MB of memory will be needed to build the index (more might be used if you have more)
2025-03-09 07:39:10,289 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0004 secs
2025-03-09 07:39:10,289 [INFO]: 	Selecting most promising index types given data characteristics 03/09/2025, 07:39:10
2025-03-09 07:39:10,289 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-09 07:39:10,289 [INFO]: 	Creating the index 03/09/2025, 07:39:10
2025-03-09 07:39:10,289 [INFO]: 		-> Instanciate the index HNSW15 03/09/2025, 07:39:10
2025-03-09 07:39:10,292 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0026 secs
2025-03-09 07:39:10,292 [INFO]: 		-> Adding the vectors to the index 03/09/2025, 07:39:10
2025-03-09 07:39:10,292 [INFO]: The memory available for adding the vectors is 49.4GB(total available - used by the index)
2025-03-09 07:39:10,292 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/13 [00:00<?, ?it/s]  8%|▊         | 1/13 [00:00<00:02,  5.76it/s] 23%|██▎       | 3/13 [00:00<00:01,  8.86it/s] 38%|███▊      | 5/13 [00:00<00:00, 10.10it/s] 54%|█████▍    | 7/13 [00:00<00:00, 10.59it/s] 69%|██████▉   | 9/13 [00:00<00:00, 10.90it/s] 85%|████████▍ | 11/13 [00:01<00:00, 11.26it/s]100%|██████████| 13/13 [00:03<00:00,  2.38it/s]100%|██████████| 13/13 [00:03<00:00,  4.04it/s]
2025-03-09 07:39:13,517 [INFO]: 	Computing best hyperparameters for index knn.index 03/09/2025, 07:39:13
2025-03-09 07:39:49,324 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 35.8065 secs
2025-03-09 07:39:49,324 [INFO]: The best hyperparameters are: efSearch=282
2025-03-09 07:39:49,324 [INFO]: 	Compute fast metrics 03/09/2025, 07:39:49
  0%|          | 0/4 [00:00<?, ?it/s] 25%|██▌       | 1/4 [00:00<00:00,  7.52it/s] 75%|███████▌  | 3/4 [00:00<00:00, 12.68it/s] 75%|███████▌  | 3/4 [00:00<00:00,  9.70it/s]
2025-03-09 07:40:02,277 [INFO]: 	>>> Finished "Compute fast metrics" in 12.9522 secs
2025-03-09 07:40:02,279 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 51.9870 secs
2025-03-09 07:40:02,279 [INFO]: {
2025-03-09 07:40:02,279 [INFO]: 	index_key: HNSW15
2025-03-09 07:40:02,279 [INFO]: 	index_param: efSearch=282
2025-03-09 07:40:02,279 [INFO]: 	index_path: knn.index
2025-03-09 07:40:02,279 [INFO]: 	size in bytes: 634105330
2025-03-09 07:40:02,279 [INFO]: 	avg_search_speed_ms: 10.191881724741393
2025-03-09 07:40:02,279 [INFO]: 	99p_search_speed_ms: 15.774275013245639
2025-03-09 07:40:02,279 [INFO]: 	reconstruction error %: 0.0
2025-03-09 07:40:02,279 [INFO]: 	nb vectors: 3223
2025-03-09 07:40:02,279 [INFO]: 	vectors dimension: 49152
2025-03-09 07:40:02,279 [INFO]: 	compression ratio: 0.9993096635853858
2025-03-09 07:40:02,279 [INFO]: }
2025-03-09 07:40:02,279 [INFO]: 	>>> Finished "Creating the index" in 51.9905 secs
2025-03-09 07:40:02,279 [INFO]: >>> Finished "Launching the whole pipeline" in 52.0173 secs
2025-03-09 07:40:03: [retrieval_preprocessing] calculating distances ...
2025-03-09 07:40:04: [retrieval_preprocessing] finished and saved retrieval indices for episode 92207 [episode count 14/20]
[retrieval_preprocessing] for episode 8242 [episode count 15/20], we have num_retrieval=np.int64(3224) num_query=np.int64(152)
2025-03-09 07:40:05,521 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-09 07:40:06,099 [INFO]: Launching the whole pipeline 03/09/2025, 07:40:06
2025-03-09 07:40:06,099 [INFO]: Reading total number of vectors and dimension 03/09/2025, 07:40:06
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 2122.62it/s]
2025-03-09 07:40:06,123 [INFO]: There are 3224 embeddings of dim 49152
2025-03-09 07:40:06,123 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0242 secs
2025-03-09 07:40:06,123 [INFO]: 	Compute estimated construction time of the index 03/09/2025, 07:40:06
2025-03-09 07:40:06,123 [INFO]: 		-> Train: 16.7 minutes
2025-03-09 07:40:06,123 [INFO]: 		-> Add: 1.8 seconds
2025-03-09 07:40:06,123 [INFO]: 		Total: 16.7 minutes
2025-03-09 07:40:06,123 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0001 secs
2025-03-09 07:40:06,123 [INFO]: 	Checking that your have enough memory available to create the index 03/09/2025, 07:40:06
2025-03-09 07:40:06,124 [INFO]: 665.4MB of memory will be needed to build the index (more might be used if you have more)
2025-03-09 07:40:06,124 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0001 secs
2025-03-09 07:40:06,124 [INFO]: 	Selecting most promising index types given data characteristics 03/09/2025, 07:40:06
2025-03-09 07:40:06,124 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-09 07:40:06,124 [INFO]: 	Creating the index 03/09/2025, 07:40:06
2025-03-09 07:40:06,124 [INFO]: 		-> Instanciate the index HNSW15 03/09/2025, 07:40:06
2025-03-09 07:40:06,125 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0010 secs
2025-03-09 07:40:06,125 [INFO]: 		-> Adding the vectors to the index 03/09/2025, 07:40:06
2025-03-09 07:40:06,125 [INFO]: The memory available for adding the vectors is 49.4GB(total available - used by the index)
2025-03-09 07:40:06,125 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/13 [00:00<?, ?it/s]  8%|▊         | 1/13 [00:00<00:02,  5.22it/s] 15%|█▌        | 2/13 [00:00<00:01,  6.70it/s] 23%|██▎       | 3/13 [00:00<00:01,  7.33it/s] 31%|███       | 4/13 [00:00<00:01,  7.76it/s] 38%|███▊      | 5/13 [00:00<00:01,  7.98it/s] 46%|████▌     | 6/13 [00:00<00:00,  8.03it/s] 54%|█████▍    | 7/13 [00:00<00:00,  8.04it/s] 62%|██████▏   | 8/13 [00:01<00:00,  7.97it/s] 69%|██████▉   | 9/13 [00:01<00:00,  8.00it/s] 77%|███████▋  | 10/13 [00:01<00:00,  8.42it/s] 85%|████████▍ | 11/13 [00:01<00:00,  8.07it/s] 92%|█████████▏| 12/13 [00:01<00:00,  7.84it/s]100%|██████████| 13/13 [00:03<00:00,  1.26it/s]100%|██████████| 13/13 [00:03<00:00,  3.36it/s]
2025-03-09 07:40:09,997 [INFO]: 	Computing best hyperparameters for index knn.index 03/09/2025, 07:40:09
2025-03-09 07:40:44,534 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 34.5363 secs
2025-03-09 07:40:44,534 [INFO]: The best hyperparameters are: efSearch=299
2025-03-09 07:40:44,534 [INFO]: 	Compute fast metrics 03/09/2025, 07:40:44
  0%|          | 0/4 [00:00<?, ?it/s] 25%|██▌       | 1/4 [00:00<00:00,  6.29it/s] 50%|█████     | 2/4 [00:00<00:00,  8.00it/s] 75%|███████▌  | 3/4 [00:00<00:00,  8.63it/s] 75%|███████▌  | 3/4 [00:00<00:00,  6.37it/s]
2025-03-09 07:40:59,931 [INFO]: 	>>> Finished "Compute fast metrics" in 15.3973 secs
2025-03-09 07:40:59,934 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 53.8090 secs
2025-03-09 07:40:59,934 [INFO]: {
2025-03-09 07:40:59,934 [INFO]: 	index_key: HNSW15
2025-03-09 07:40:59,934 [INFO]: 	index_param: efSearch=299
2025-03-09 07:40:59,934 [INFO]: 	index_path: knn.index
2025-03-09 07:40:59,934 [INFO]: 	size in bytes: 634302130
2025-03-09 07:40:59,934 [INFO]: 	avg_search_speed_ms: 11.20884785186687
2025-03-09 07:40:59,934 [INFO]: 	99p_search_speed_ms: 18.93593332730234
2025-03-09 07:40:59,934 [INFO]: 	reconstruction error %: 0.0
2025-03-09 07:40:59,934 [INFO]: 	nb vectors: 3224
2025-03-09 07:40:59,934 [INFO]: 	vectors dimension: 49152
2025-03-09 07:40:59,934 [INFO]: 	compression ratio: 0.9993095750758396
2025-03-09 07:40:59,934 [INFO]: }
2025-03-09 07:40:59,934 [INFO]: 	>>> Finished "Creating the index" in 53.8105 secs
2025-03-09 07:40:59,934 [INFO]: >>> Finished "Launching the whole pipeline" in 53.8353 secs
2025-03-09 07:41:00: [retrieval_preprocessing] calculating distances ...
2025-03-09 07:41:01: [retrieval_preprocessing] finished and saved retrieval indices for episode 8242 [episode count 15/20]
[retrieval_preprocessing] for episode 44595 [episode count 16/20], we have num_retrieval=np.int64(3205) num_query=np.int64(171)
2025-03-09 07:41:02,755 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-09 07:41:03,316 [INFO]: Launching the whole pipeline 03/09/2025, 07:41:03
2025-03-09 07:41:03,316 [INFO]: Reading total number of vectors and dimension 03/09/2025, 07:41:03
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1752.74it/s]
2025-03-09 07:41:03,338 [INFO]: There are 3205 embeddings of dim 49152
2025-03-09 07:41:03,338 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0222 secs
2025-03-09 07:41:03,338 [INFO]: 	Compute estimated construction time of the index 03/09/2025, 07:41:03
2025-03-09 07:41:03,338 [INFO]: 		-> Train: 16.7 minutes
2025-03-09 07:41:03,338 [INFO]: 		-> Add: 1.8 seconds
2025-03-09 07:41:03,338 [INFO]: 		Total: 16.7 minutes
2025-03-09 07:41:03,338 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0001 secs
2025-03-09 07:41:03,338 [INFO]: 	Checking that your have enough memory available to create the index 03/09/2025, 07:41:03
2025-03-09 07:41:03,338 [INFO]: 661.4MB of memory will be needed to build the index (more might be used if you have more)
2025-03-09 07:41:03,338 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0001 secs
2025-03-09 07:41:03,338 [INFO]: 	Selecting most promising index types given data characteristics 03/09/2025, 07:41:03
2025-03-09 07:41:03,338 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-09 07:41:03,338 [INFO]: 	Creating the index 03/09/2025, 07:41:03
2025-03-09 07:41:03,338 [INFO]: 		-> Instanciate the index HNSW15 03/09/2025, 07:41:03
2025-03-09 07:41:03,339 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0009 secs
2025-03-09 07:41:03,339 [INFO]: 		-> Adding the vectors to the index 03/09/2025, 07:41:03
2025-03-09 07:41:03,339 [INFO]: The memory available for adding the vectors is 49.4GB(total available - used by the index)
2025-03-09 07:41:03,339 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/13 [00:00<?, ?it/s]  8%|▊         | 1/13 [00:00<00:02,  5.54it/s] 15%|█▌        | 2/13 [00:00<00:01,  6.94it/s] 23%|██▎       | 3/13 [00:00<00:01,  7.70it/s] 31%|███       | 4/13 [00:00<00:01,  7.97it/s] 38%|███▊      | 5/13 [00:00<00:00,  8.12it/s] 46%|████▌     | 6/13 [00:00<00:00,  8.26it/s] 54%|█████▍    | 7/13 [00:00<00:00,  8.31it/s] 62%|██████▏   | 8/13 [00:01<00:00,  8.36it/s] 69%|██████▉   | 9/13 [00:01<00:00,  8.48it/s] 77%|███████▋  | 10/13 [00:01<00:00,  8.49it/s] 85%|████████▍ | 11/13 [00:01<00:00,  8.49it/s] 92%|█████████▏| 12/13 [00:01<00:00,  8.48it/s]100%|██████████| 13/13 [00:03<00:00,  1.36it/s]100%|██████████| 13/13 [00:03<00:00,  3.59it/s]
2025-03-09 07:41:06,963 [INFO]: 	Computing best hyperparameters for index knn.index 03/09/2025, 07:41:06
2025-03-09 07:41:38,870 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 31.9070 secs
2025-03-09 07:41:38,870 [INFO]: The best hyperparameters are: efSearch=215
2025-03-09 07:41:38,870 [INFO]: 	Compute fast metrics 03/09/2025, 07:41:38
  0%|          | 0/4 [00:00<?, ?it/s] 25%|██▌       | 1/4 [00:00<00:00,  5.40it/s] 50%|█████     | 2/4 [00:00<00:00,  6.75it/s] 75%|███████▌  | 3/4 [00:00<00:00,  7.25it/s] 75%|███████▌  | 3/4 [00:00<00:00,  5.42it/s]
2025-03-09 07:41:52,212 [INFO]: 	>>> Finished "Compute fast metrics" in 13.3415 secs
2025-03-09 07:41:52,214 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 48.8749 secs
2025-03-09 07:41:52,215 [INFO]: {
2025-03-09 07:41:52,215 [INFO]: 	index_key: HNSW15
2025-03-09 07:41:52,215 [INFO]: 	index_param: efSearch=215
2025-03-09 07:41:52,215 [INFO]: 	index_path: knn.index
2025-03-09 07:41:52,215 [INFO]: 	size in bytes: 630563890
2025-03-09 07:41:52,215 [INFO]: 	avg_search_speed_ms: 8.99873192474065
2025-03-09 07:41:52,215 [INFO]: 	99p_search_speed_ms: 14.885939331725242
2025-03-09 07:41:52,215 [INFO]: 	reconstruction error %: 0.0
2025-03-09 07:41:52,215 [INFO]: 	nb vectors: 3205
2025-03-09 07:41:52,215 [INFO]: 	vectors dimension: 49152
2025-03-09 07:41:52,215 [INFO]: 	compression ratio: 0.999309744806351
2025-03-09 07:41:52,215 [INFO]: }
2025-03-09 07:41:52,215 [INFO]: 	>>> Finished "Creating the index" in 48.8764 secs
2025-03-09 07:41:52,215 [INFO]: >>> Finished "Launching the whole pipeline" in 48.8991 secs
2025-03-09 07:41:52: [retrieval_preprocessing] calculating distances ...
2025-03-09 07:41:53: [retrieval_preprocessing] finished and saved retrieval indices for episode 44595 [episode count 16/20]
[retrieval_preprocessing] for episode 88627 [episode count 17/20], we have num_retrieval=np.int64(3216) num_query=np.int64(160)
2025-03-09 07:41:54,319 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-09 07:41:54,943 [INFO]: Launching the whole pipeline 03/09/2025, 07:41:54
2025-03-09 07:41:54,943 [INFO]: Reading total number of vectors and dimension 03/09/2025, 07:41:54
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 2178.86it/s]
2025-03-09 07:41:54,967 [INFO]: There are 3216 embeddings of dim 49152
2025-03-09 07:41:54,967 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0237 secs
2025-03-09 07:41:54,967 [INFO]: 	Compute estimated construction time of the index 03/09/2025, 07:41:54
2025-03-09 07:41:54,967 [INFO]: 		-> Train: 16.7 minutes
2025-03-09 07:41:54,967 [INFO]: 		-> Add: 1.8 seconds
2025-03-09 07:41:54,967 [INFO]: 		Total: 16.7 minutes
2025-03-09 07:41:54,967 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0001 secs
2025-03-09 07:41:54,967 [INFO]: 	Checking that your have enough memory available to create the index 03/09/2025, 07:41:54
2025-03-09 07:41:54,967 [INFO]: 663.7MB of memory will be needed to build the index (more might be used if you have more)
2025-03-09 07:41:54,967 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0001 secs
2025-03-09 07:41:54,967 [INFO]: 	Selecting most promising index types given data characteristics 03/09/2025, 07:41:54
2025-03-09 07:41:54,968 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-09 07:41:54,968 [INFO]: 	Creating the index 03/09/2025, 07:41:54
2025-03-09 07:41:54,968 [INFO]: 		-> Instanciate the index HNSW15 03/09/2025, 07:41:54
2025-03-09 07:41:54,969 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0009 secs
2025-03-09 07:41:54,969 [INFO]: 		-> Adding the vectors to the index 03/09/2025, 07:41:54
2025-03-09 07:41:54,969 [INFO]: The memory available for adding the vectors is 49.4GB(total available - used by the index)
2025-03-09 07:41:54,969 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/13 [00:00<?, ?it/s]  8%|▊         | 1/13 [00:00<00:02,  5.33it/s] 15%|█▌        | 2/13 [00:00<00:01,  7.29it/s] 31%|███       | 4/13 [00:00<00:01,  8.90it/s] 46%|████▌     | 6/13 [00:00<00:00, 10.97it/s] 62%|██████▏   | 8/13 [00:00<00:00, 12.76it/s] 77%|███████▋  | 10/13 [00:00<00:00, 13.34it/s] 92%|█████████▏| 12/13 [00:01<00:00, 14.04it/s]100%|██████████| 13/13 [00:03<00:00,  3.97it/s]
2025-03-09 07:41:58,243 [INFO]: 	Computing best hyperparameters for index knn.index 03/09/2025, 07:41:58
2025-03-09 07:42:37,477 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 39.2337 secs
2025-03-09 07:42:37,477 [INFO]: The best hyperparameters are: efSearch=243
2025-03-09 07:42:37,477 [INFO]: 	Compute fast metrics 03/09/2025, 07:42:37
  0%|          | 0/4 [00:00<?, ?it/s] 25%|██▌       | 1/4 [00:00<00:00,  4.97it/s] 50%|█████     | 2/4 [00:00<00:00,  6.13it/s] 75%|███████▌  | 3/4 [00:00<00:00,  6.76it/s] 75%|███████▌  | 3/4 [00:00<00:00,  5.14it/s]
2025-03-09 07:42:51,000 [INFO]: 	>>> Finished "Compute fast metrics" in 13.5228 secs
2025-03-09 07:42:51,002 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 56.0337 secs
2025-03-09 07:42:51,003 [INFO]: {
2025-03-09 07:42:51,003 [INFO]: 	index_key: HNSW15
2025-03-09 07:42:51,003 [INFO]: 	index_param: efSearch=243
2025-03-09 07:42:51,003 [INFO]: 	index_path: knn.index
2025-03-09 07:42:51,003 [INFO]: 	size in bytes: 632728030
2025-03-09 07:42:51,003 [INFO]: 	avg_search_speed_ms: 9.772349009927606
2025-03-09 07:42:51,003 [INFO]: 	99p_search_speed_ms: 14.649406755343078
2025-03-09 07:42:51,003 [INFO]: 	reconstruction error %: 0.0
2025-03-09 07:42:51,003 [INFO]: 	nb vectors: 3216
2025-03-09 07:42:51,003 [INFO]: 	vectors dimension: 49152
2025-03-09 07:42:51,003 [INFO]: 	compression ratio: 0.9993098108835166
2025-03-09 07:42:51,003 [INFO]: }
2025-03-09 07:42:51,003 [INFO]: 	>>> Finished "Creating the index" in 56.0351 secs
2025-03-09 07:42:51,003 [INFO]: >>> Finished "Launching the whole pipeline" in 56.0594 secs
2025-03-09 07:42:52: [retrieval_preprocessing] calculating distances ...
2025-03-09 07:42:52: [retrieval_preprocessing] finished and saved retrieval indices for episode 88627 [episode count 17/20]
[retrieval_preprocessing] for episode 50749 [episode count 18/20], we have num_retrieval=np.int64(3217) num_query=np.int64(159)
2025-03-09 07:42:53,611 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-09 07:42:54,103 [INFO]: Launching the whole pipeline 03/09/2025, 07:42:54
2025-03-09 07:42:54,103 [INFO]: Reading total number of vectors and dimension 03/09/2025, 07:42:54
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1027.51it/s]
2025-03-09 07:42:54,130 [INFO]: There are 3217 embeddings of dim 49152
2025-03-09 07:42:54,130 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0276 secs
2025-03-09 07:42:54,130 [INFO]: 	Compute estimated construction time of the index 03/09/2025, 07:42:54
2025-03-09 07:42:54,130 [INFO]: 		-> Train: 16.7 minutes
2025-03-09 07:42:54,131 [INFO]: 		-> Add: 1.8 seconds
2025-03-09 07:42:54,131 [INFO]: 		Total: 16.7 minutes
2025-03-09 07:42:54,131 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0001 secs
2025-03-09 07:42:54,131 [INFO]: 	Checking that your have enough memory available to create the index 03/09/2025, 07:42:54
2025-03-09 07:42:54,131 [INFO]: 663.9MB of memory will be needed to build the index (more might be used if you have more)
2025-03-09 07:42:54,131 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0001 secs
2025-03-09 07:42:54,131 [INFO]: 	Selecting most promising index types given data characteristics 03/09/2025, 07:42:54
2025-03-09 07:42:54,131 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-09 07:42:54,131 [INFO]: 	Creating the index 03/09/2025, 07:42:54
2025-03-09 07:42:54,131 [INFO]: 		-> Instanciate the index HNSW15 03/09/2025, 07:42:54
2025-03-09 07:42:54,132 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0008 secs
2025-03-09 07:42:54,132 [INFO]: 		-> Adding the vectors to the index 03/09/2025, 07:42:54
2025-03-09 07:42:54,132 [INFO]: The memory available for adding the vectors is 49.4GB(total available - used by the index)
2025-03-09 07:42:54,132 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/13 [00:00<?, ?it/s]  8%|▊         | 1/13 [00:00<00:01,  6.54it/s] 23%|██▎       | 3/13 [00:00<00:01,  9.75it/s] 38%|███▊      | 5/13 [00:00<00:00, 10.61it/s] 54%|█████▍    | 7/13 [00:00<00:00, 10.99it/s] 69%|██████▉   | 9/13 [00:00<00:00, 11.43it/s] 85%|████████▍ | 11/13 [00:01<00:00, 11.30it/s]100%|██████████| 13/13 [00:03<00:00,  2.04it/s]100%|██████████| 13/13 [00:03<00:00,  3.60it/s]
2025-03-09 07:42:57,743 [INFO]: 	Computing best hyperparameters for index knn.index 03/09/2025, 07:42:57
2025-03-09 07:43:36,217 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 38.4734 secs
2025-03-09 07:43:36,217 [INFO]: The best hyperparameters are: efSearch=272
2025-03-09 07:43:36,217 [INFO]: 	Compute fast metrics 03/09/2025, 07:43:36
  0%|          | 0/4 [00:00<?, ?it/s] 25%|██▌       | 1/4 [00:00<00:00,  5.17it/s] 50%|█████     | 2/4 [00:00<00:00,  6.82it/s] 75%|███████▌  | 3/4 [00:00<00:00,  7.54it/s] 75%|███████▌  | 3/4 [00:00<00:00,  5.64it/s]
2025-03-09 07:43:51,233 [INFO]: 	>>> Finished "Compute fast metrics" in 15.0152 secs
2025-03-09 07:43:51,316 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 57.1842 secs
2025-03-09 07:43:51,317 [INFO]: {
2025-03-09 07:43:51,317 [INFO]: 	index_key: HNSW15
2025-03-09 07:43:51,317 [INFO]: 	index_param: efSearch=272
2025-03-09 07:43:51,317 [INFO]: 	index_path: knn.index
2025-03-09 07:43:51,317 [INFO]: 	size in bytes: 632924770
2025-03-09 07:43:51,317 [INFO]: 	avg_search_speed_ms: 10.539744367766085
2025-03-09 07:43:51,317 [INFO]: 	99p_search_speed_ms: 17.187642315402627
2025-03-09 07:43:51,317 [INFO]: 	reconstruction error %: 0.0
2025-03-09 07:43:51,317 [INFO]: 	nb vectors: 3217
2025-03-09 07:43:51,317 [INFO]: 	vectors dimension: 49152
2025-03-09 07:43:51,317 [INFO]: 	compression ratio: 0.9993098168681248
2025-03-09 07:43:51,317 [INFO]: }
2025-03-09 07:43:51,317 [INFO]: 	>>> Finished "Creating the index" in 57.1862 secs
2025-03-09 07:43:51,317 [INFO]: >>> Finished "Launching the whole pipeline" in 57.2145 secs
2025-03-09 07:43:52: [retrieval_preprocessing] calculating distances ...
2025-03-09 07:43:53: [retrieval_preprocessing] finished and saved retrieval indices for episode 50749 [episode count 18/20]
[retrieval_preprocessing] for episode 5182 [episode count 19/20], we have num_retrieval=np.int64(3209) num_query=np.int64(167)
2025-03-09 07:43:54,681 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-09 07:43:55,229 [INFO]: Launching the whole pipeline 03/09/2025, 07:43:55
2025-03-09 07:43:55,229 [INFO]: Reading total number of vectors and dimension 03/09/2025, 07:43:55
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 958.70it/s]
2025-03-09 07:43:55,257 [INFO]: There are 3209 embeddings of dim 49152
2025-03-09 07:43:55,258 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0286 secs
2025-03-09 07:43:55,258 [INFO]: 	Compute estimated construction time of the index 03/09/2025, 07:43:55
2025-03-09 07:43:55,258 [INFO]: 		-> Train: 16.7 minutes
2025-03-09 07:43:55,258 [INFO]: 		-> Add: 1.8 seconds
2025-03-09 07:43:55,258 [INFO]: 		Total: 16.7 minutes
2025-03-09 07:43:55,258 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0001 secs
2025-03-09 07:43:55,258 [INFO]: 	Checking that your have enough memory available to create the index 03/09/2025, 07:43:55
2025-03-09 07:43:55,258 [INFO]: 662.3MB of memory will be needed to build the index (more might be used if you have more)
2025-03-09 07:43:55,258 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0002 secs
2025-03-09 07:43:55,258 [INFO]: 	Selecting most promising index types given data characteristics 03/09/2025, 07:43:55
2025-03-09 07:43:55,258 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-09 07:43:55,258 [INFO]: 	Creating the index 03/09/2025, 07:43:55
2025-03-09 07:43:55,258 [INFO]: 		-> Instanciate the index HNSW15 03/09/2025, 07:43:55
2025-03-09 07:43:55,259 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0011 secs
2025-03-09 07:43:55,260 [INFO]: 		-> Adding the vectors to the index 03/09/2025, 07:43:55
2025-03-09 07:43:55,260 [INFO]: The memory available for adding the vectors is 49.4GB(total available - used by the index)
2025-03-09 07:43:55,260 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/13 [00:00<?, ?it/s]  8%|▊         | 1/13 [00:00<00:02,  5.08it/s] 15%|█▌        | 2/13 [00:00<00:01,  7.12it/s] 23%|██▎       | 3/13 [00:00<00:01,  8.15it/s] 31%|███       | 4/13 [00:00<00:01,  8.77it/s] 38%|███▊      | 5/13 [00:00<00:00,  9.14it/s] 54%|█████▍    | 7/13 [00:00<00:00,  9.91it/s] 69%|██████▉   | 9/13 [00:00<00:00, 10.88it/s] 85%|████████▍ | 11/13 [00:01<00:00, 11.36it/s]100%|██████████| 13/13 [00:03<00:00,  2.02it/s]100%|██████████| 13/13 [00:03<00:00,  3.60it/s]
2025-03-09 07:43:58,879 [INFO]: 	Computing best hyperparameters for index knn.index 03/09/2025, 07:43:58
2025-03-09 07:44:37,431 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 38.5514 secs
2025-03-09 07:44:37,431 [INFO]: The best hyperparameters are: efSearch=256
2025-03-09 07:44:37,431 [INFO]: 	Compute fast metrics 03/09/2025, 07:44:37
  0%|          | 0/4 [00:00<?, ?it/s] 25%|██▌       | 1/4 [00:00<00:00,  7.32it/s] 75%|███████▌  | 3/4 [00:00<00:00, 10.00it/s] 75%|███████▌  | 3/4 [00:00<00:00,  7.64it/s]
2025-03-09 07:44:51,246 [INFO]: 	>>> Finished "Compute fast metrics" in 13.8154 secs
2025-03-09 07:44:51,249 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 55.9890 secs
2025-03-09 07:44:51,249 [INFO]: {
2025-03-09 07:44:51,249 [INFO]: 	index_key: HNSW15
2025-03-09 07:44:51,249 [INFO]: 	index_param: efSearch=256
2025-03-09 07:44:51,249 [INFO]: 	index_path: knn.index
2025-03-09 07:44:51,249 [INFO]: 	size in bytes: 631350850
2025-03-09 07:44:51,249 [INFO]: 	avg_search_speed_ms: 10.10832810634135
2025-03-09 07:44:51,249 [INFO]: 	99p_search_speed_ms: 17.586017036810517
2025-03-09 07:44:51,249 [INFO]: 	reconstruction error %: 0.0
2025-03-09 07:44:51,249 [INFO]: 	nb vectors: 3209
2025-03-09 07:44:51,249 [INFO]: 	vectors dimension: 49152
2025-03-09 07:44:51,249 [INFO]: 	compression ratio: 0.9993097688868242
2025-03-09 07:44:51,249 [INFO]: }
2025-03-09 07:44:51,249 [INFO]: 	>>> Finished "Creating the index" in 55.9905 secs
2025-03-09 07:44:51,249 [INFO]: >>> Finished "Launching the whole pipeline" in 56.0199 secs
2025-03-09 07:44:52: [retrieval_preprocessing] calculating distances ...
2025-03-09 07:44:52: [retrieval_preprocessing] finished and saved retrieval indices for episode 5182 [episode count 19/20]
2025-03-09 07:44:52: [retrieval_preprocessing] finished for (4823049285, 'block') [chosen_id count 2/10]
2025-03-09 07:44:55: [retrieval_preprocessing] concatenated all embeddings and indices for 20 episodes for (6667529842, 'lid') [chosen_id count 3/10]
2025-03-09 07:44:55: [retrieval_preprocessing] we have num_total=2882 embedding_dim=49152
[retrieval_preprocessing] for episode 46083 [episode count 0/20], we have num_retrieval=np.int64(2653) num_query=np.int64(229)
2025-03-09 07:44:56,025 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-09 07:44:56,365 [INFO]: Launching the whole pipeline 03/09/2025, 07:44:56
2025-03-09 07:44:56,365 [INFO]: Reading total number of vectors and dimension 03/09/2025, 07:44:56
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1787.09it/s]
2025-03-09 07:44:56,389 [INFO]: There are 2653 embeddings of dim 49152
2025-03-09 07:44:56,389 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0244 secs
2025-03-09 07:44:56,390 [INFO]: 	Compute estimated construction time of the index 03/09/2025, 07:44:56
2025-03-09 07:44:56,390 [INFO]: 		-> Train: 16.7 minutes
2025-03-09 07:44:56,390 [INFO]: 		-> Add: 1.5 seconds
2025-03-09 07:44:56,390 [INFO]: 		Total: 16.7 minutes
2025-03-09 07:44:56,390 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0001 secs
2025-03-09 07:44:56,390 [INFO]: 	Checking that your have enough memory available to create the index 03/09/2025, 07:44:56
2025-03-09 07:44:56,390 [INFO]: 547.5MB of memory will be needed to build the index (more might be used if you have more)
2025-03-09 07:44:56,390 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0001 secs
2025-03-09 07:44:56,390 [INFO]: 	Selecting most promising index types given data characteristics 03/09/2025, 07:44:56
2025-03-09 07:44:56,390 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-09 07:44:56,390 [INFO]: 	Creating the index 03/09/2025, 07:44:56
2025-03-09 07:44:56,390 [INFO]: 		-> Instanciate the index HNSW15 03/09/2025, 07:44:56
2025-03-09 07:44:56,391 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0009 secs
2025-03-09 07:44:56,391 [INFO]: 		-> Adding the vectors to the index 03/09/2025, 07:44:56
2025-03-09 07:44:56,391 [INFO]: The memory available for adding the vectors is 49.5GB(total available - used by the index)
2025-03-09 07:44:56,391 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/11 [00:00<?, ?it/s]  9%|▉         | 1/11 [00:00<00:01,  5.82it/s] 45%|████▌     | 5/11 [00:00<00:00, 21.21it/s] 73%|███████▎  | 8/11 [00:00<00:00, 23.36it/s]100%|██████████| 11/11 [00:02<00:00,  3.88it/s]100%|██████████| 11/11 [00:02<00:00,  5.22it/s]
2025-03-09 07:44:58,503 [INFO]: 	Computing best hyperparameters for index knn.index 03/09/2025, 07:44:58
2025-03-09 07:45:29,697 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 31.1934 secs
2025-03-09 07:45:29,697 [INFO]: The best hyperparameters are: efSearch=247
2025-03-09 07:45:29,697 [INFO]: 	Compute fast metrics 03/09/2025, 07:45:29
  0%|          | 0/4 [00:00<?, ?it/s] 25%|██▌       | 1/4 [00:00<00:00,  4.96it/s] 50%|█████     | 2/4 [00:00<00:00,  6.33it/s] 75%|███████▌  | 3/4 [00:00<00:00,  6.94it/s] 75%|███████▌  | 3/4 [00:00<00:00,  5.23it/s]
2025-03-09 07:45:44,765 [INFO]: 	>>> Finished "Compute fast metrics" in 15.0676 secs
2025-03-09 07:45:44,767 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 48.3759 secs
2025-03-09 07:45:44,767 [INFO]: {
2025-03-09 07:45:44,767 [INFO]: 	index_key: HNSW15
2025-03-09 07:45:44,767 [INFO]: 	index_param: efSearch=247
2025-03-09 07:45:44,767 [INFO]: 	index_path: knn.index
2025-03-09 07:45:44,767 [INFO]: 	size in bytes: 521961430
2025-03-09 07:45:44,767 [INFO]: 	avg_search_speed_ms: 9.34522183259479
2025-03-09 07:45:44,767 [INFO]: 	99p_search_speed_ms: 16.851582434028376
2025-03-09 07:45:44,767 [INFO]: 	reconstruction error %: 0.0
2025-03-09 07:45:44,767 [INFO]: 	nb vectors: 2653
2025-03-09 07:45:44,767 [INFO]: 	vectors dimension: 49152
2025-03-09 07:45:44,767 [INFO]: 	compression ratio: 0.9993095160307152
2025-03-09 07:45:44,767 [INFO]: }
2025-03-09 07:45:44,767 [INFO]: 	>>> Finished "Creating the index" in 48.3773 secs
2025-03-09 07:45:44,767 [INFO]: >>> Finished "Launching the whole pipeline" in 48.4024 secs
2025-03-09 07:45:46: [retrieval_preprocessing] calculating distances ...
2025-03-09 07:45:47: [retrieval_preprocessing] finished and saved retrieval indices for episode 46083 [episode count 0/20]
[retrieval_preprocessing] for episode 63491 [episode count 1/20], we have num_retrieval=np.int64(2759) num_query=np.int64(123)
2025-03-09 07:45:48,321 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-09 07:45:48,806 [INFO]: Launching the whole pipeline 03/09/2025, 07:45:48
2025-03-09 07:45:48,806 [INFO]: Reading total number of vectors and dimension 03/09/2025, 07:45:48
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1522.43it/s]
2025-03-09 07:45:48,831 [INFO]: There are 2759 embeddings of dim 49152
2025-03-09 07:45:48,832 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0251 secs
2025-03-09 07:45:48,832 [INFO]: 	Compute estimated construction time of the index 03/09/2025, 07:45:48
2025-03-09 07:45:48,832 [INFO]: 		-> Train: 16.7 minutes
2025-03-09 07:45:48,832 [INFO]: 		-> Add: 1.5 seconds
2025-03-09 07:45:48,832 [INFO]: 		Total: 16.7 minutes
2025-03-09 07:45:48,832 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0001 secs
2025-03-09 07:45:48,832 [INFO]: 	Checking that your have enough memory available to create the index 03/09/2025, 07:45:48
2025-03-09 07:45:48,832 [INFO]: 569.4MB of memory will be needed to build the index (more might be used if you have more)
2025-03-09 07:45:48,832 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0002 secs
2025-03-09 07:45:48,832 [INFO]: 	Selecting most promising index types given data characteristics 03/09/2025, 07:45:48
2025-03-09 07:45:48,832 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-09 07:45:48,832 [INFO]: 	Creating the index 03/09/2025, 07:45:48
2025-03-09 07:45:48,832 [INFO]: 		-> Instanciate the index HNSW15 03/09/2025, 07:45:48
2025-03-09 07:45:48,833 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0013 secs
2025-03-09 07:45:48,834 [INFO]: 		-> Adding the vectors to the index 03/09/2025, 07:45:48
2025-03-09 07:45:48,834 [INFO]: The memory available for adding the vectors is 49.5GB(total available - used by the index)
2025-03-09 07:45:48,834 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/11 [00:00<?, ?it/s]  9%|▉         | 1/11 [00:00<00:01,  6.55it/s] 55%|█████▍    | 6/11 [00:00<00:00, 21.64it/s] 82%|████████▏ | 9/11 [00:00<00:00, 22.56it/s]100%|██████████| 11/11 [00:02<00:00,  4.98it/s]
2025-03-09 07:45:51,048 [INFO]: 	Computing best hyperparameters for index knn.index 03/09/2025, 07:45:51
2025-03-09 07:46:19,545 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 28.4970 secs
2025-03-09 07:46:19,546 [INFO]: The best hyperparameters are: efSearch=309
2025-03-09 07:46:19,546 [INFO]: 	Compute fast metrics 03/09/2025, 07:46:19
  0%|          | 0/4 [00:00<?, ?it/s] 25%|██▌       | 1/4 [00:00<00:00,  5.75it/s] 75%|███████▌  | 3/4 [00:00<00:00,  8.43it/s] 75%|███████▌  | 3/4 [00:00<00:00,  6.50it/s]
2025-03-09 07:46:37,964 [INFO]: 	>>> Finished "Compute fast metrics" in 18.4184 secs
2025-03-09 07:46:37,966 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 49.1328 secs
2025-03-09 07:46:37,967 [INFO]: {
2025-03-09 07:46:37,967 [INFO]: 	index_key: HNSW15
2025-03-09 07:46:37,967 [INFO]: 	index_param: efSearch=309
2025-03-09 07:46:37,967 [INFO]: 	index_path: knn.index
2025-03-09 07:46:37,967 [INFO]: 	size in bytes: 542815990
2025-03-09 07:46:37,967 [INFO]: 	avg_search_speed_ms: 10.369345781977236
2025-03-09 07:46:37,967 [INFO]: 	99p_search_speed_ms: 17.272742791101344
2025-03-09 07:46:37,967 [INFO]: 	reconstruction error %: 0.0
2025-03-09 07:46:37,967 [INFO]: 	nb vectors: 2759
2025-03-09 07:46:37,967 [INFO]: 	vectors dimension: 49152
2025-03-09 07:46:37,967 [INFO]: 	compression ratio: 0.9993100461171013
2025-03-09 07:46:37,967 [INFO]: }
2025-03-09 07:46:37,967 [INFO]: 	>>> Finished "Creating the index" in 49.1346 secs
2025-03-09 07:46:37,967 [INFO]: >>> Finished "Launching the whole pipeline" in 49.1604 secs
2025-03-09 07:46:39: [retrieval_preprocessing] calculating distances ...
2025-03-09 07:46:39: [retrieval_preprocessing] finished and saved retrieval indices for episode 63491 [episode count 1/20]
[retrieval_preprocessing] for episode 22024 [episode count 2/20], we have num_retrieval=np.int64(2761) num_query=np.int64(121)
2025-03-09 07:46:40,823 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-09 07:46:41,281 [INFO]: Launching the whole pipeline 03/09/2025, 07:46:41
2025-03-09 07:46:41,281 [INFO]: Reading total number of vectors and dimension 03/09/2025, 07:46:41
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1043.36it/s]
2025-03-09 07:46:41,308 [INFO]: There are 2761 embeddings of dim 49152
2025-03-09 07:46:41,308 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0269 secs
2025-03-09 07:46:41,308 [INFO]: 	Compute estimated construction time of the index 03/09/2025, 07:46:41
2025-03-09 07:46:41,308 [INFO]: 		-> Train: 16.7 minutes
2025-03-09 07:46:41,308 [INFO]: 		-> Add: 1.5 seconds
2025-03-09 07:46:41,308 [INFO]: 		Total: 16.7 minutes
2025-03-09 07:46:41,308 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0001 secs
2025-03-09 07:46:41,308 [INFO]: 	Checking that your have enough memory available to create the index 03/09/2025, 07:46:41
2025-03-09 07:46:41,308 [INFO]: 569.8MB of memory will be needed to build the index (more might be used if you have more)
2025-03-09 07:46:41,309 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0001 secs
2025-03-09 07:46:41,309 [INFO]: 	Selecting most promising index types given data characteristics 03/09/2025, 07:46:41
2025-03-09 07:46:41,309 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-09 07:46:41,309 [INFO]: 	Creating the index 03/09/2025, 07:46:41
2025-03-09 07:46:41,309 [INFO]: 		-> Instanciate the index HNSW15 03/09/2025, 07:46:41
2025-03-09 07:46:41,310 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0013 secs
2025-03-09 07:46:41,310 [INFO]: 		-> Adding the vectors to the index 03/09/2025, 07:46:41
2025-03-09 07:46:41,310 [INFO]: The memory available for adding the vectors is 49.5GB(total available - used by the index)
2025-03-09 07:46:41,310 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/11 [00:00<?, ?it/s]  9%|▉         | 1/11 [00:00<00:01,  6.07it/s] 27%|██▋       | 3/11 [00:00<00:00, 10.13it/s] 45%|████▌     | 5/11 [00:00<00:00, 11.26it/s] 64%|██████▎   | 7/11 [00:00<00:00, 11.53it/s] 82%|████████▏ | 9/11 [00:00<00:00, 11.94it/s]100%|██████████| 11/11 [00:02<00:00,  2.75it/s]100%|██████████| 11/11 [00:02<00:00,  4.28it/s]
2025-03-09 07:46:43,891 [INFO]: 	Computing best hyperparameters for index knn.index 03/09/2025, 07:46:43
2025-03-09 07:47:16,766 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 32.8747 secs
2025-03-09 07:47:16,766 [INFO]: The best hyperparameters are: efSearch=334
2025-03-09 07:47:16,766 [INFO]: 	Compute fast metrics 03/09/2025, 07:47:16
  0%|          | 0/4 [00:00<?, ?it/s] 25%|██▌       | 1/4 [00:00<00:00,  5.55it/s] 50%|█████     | 2/4 [00:00<00:00,  7.07it/s] 75%|███████▌  | 3/4 [00:00<00:00,  7.94it/s] 75%|███████▌  | 3/4 [00:00<00:00,  5.94it/s]
2025-03-09 07:47:33,349 [INFO]: 	>>> Finished "Compute fast metrics" in 16.5828 secs
2025-03-09 07:47:33,351 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 52.0410 secs
2025-03-09 07:47:33,351 [INFO]: {
2025-03-09 07:47:33,351 [INFO]: 	index_key: HNSW15
2025-03-09 07:47:33,351 [INFO]: 	index_param: efSearch=334
2025-03-09 07:47:33,351 [INFO]: 	index_path: knn.index
2025-03-09 07:47:33,351 [INFO]: 	size in bytes: 543209530
2025-03-09 07:47:33,351 [INFO]: 	avg_search_speed_ms: 11.29849068267997
2025-03-09 07:47:33,351 [INFO]: 	99p_search_speed_ms: 20.265284404158585
2025-03-09 07:47:33,351 [INFO]: 	reconstruction error %: 0.0
2025-03-09 07:47:33,351 [INFO]: 	nb vectors: 2761
2025-03-09 07:47:33,351 [INFO]: 	vectors dimension: 49152
2025-03-09 07:47:33,351 [INFO]: 	compression ratio: 0.9993099495143246
2025-03-09 07:47:33,351 [INFO]: }
2025-03-09 07:47:33,351 [INFO]: 	>>> Finished "Creating the index" in 52.0428 secs
2025-03-09 07:47:33,352 [INFO]: >>> Finished "Launching the whole pipeline" in 52.0703 secs
2025-03-09 07:47:34: [retrieval_preprocessing] calculating distances ...
2025-03-09 07:47:34: [retrieval_preprocessing] finished and saved retrieval indices for episode 22024 [episode count 2/20]
[retrieval_preprocessing] for episode 7689 [episode count 3/20], we have num_retrieval=np.int64(2758) num_query=np.int64(124)
2025-03-09 07:47:35,416 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-09 07:47:35,849 [INFO]: Launching the whole pipeline 03/09/2025, 07:47:35
2025-03-09 07:47:35,849 [INFO]: Reading total number of vectors and dimension 03/09/2025, 07:47:35
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1460.41it/s]
2025-03-09 07:47:35,876 [INFO]: There are 2758 embeddings of dim 49152
2025-03-09 07:47:35,876 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0271 secs
2025-03-09 07:47:35,876 [INFO]: 	Compute estimated construction time of the index 03/09/2025, 07:47:35
2025-03-09 07:47:35,876 [INFO]: 		-> Train: 16.7 minutes
2025-03-09 07:47:35,876 [INFO]: 		-> Add: 1.5 seconds
2025-03-09 07:47:35,876 [INFO]: 		Total: 16.7 minutes
2025-03-09 07:47:35,876 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0001 secs
2025-03-09 07:47:35,876 [INFO]: 	Checking that your have enough memory available to create the index 03/09/2025, 07:47:35
2025-03-09 07:47:35,876 [INFO]: 569.2MB of memory will be needed to build the index (more might be used if you have more)
2025-03-09 07:47:35,876 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0002 secs
2025-03-09 07:47:35,876 [INFO]: 	Selecting most promising index types given data characteristics 03/09/2025, 07:47:35
2025-03-09 07:47:35,877 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-09 07:47:35,877 [INFO]: 	Creating the index 03/09/2025, 07:47:35
2025-03-09 07:47:35,877 [INFO]: 		-> Instanciate the index HNSW15 03/09/2025, 07:47:35
2025-03-09 07:47:35,878 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0011 secs
2025-03-09 07:47:35,878 [INFO]: 		-> Adding the vectors to the index 03/09/2025, 07:47:35
2025-03-09 07:47:35,878 [INFO]: The memory available for adding the vectors is 49.5GB(total available - used by the index)
2025-03-09 07:47:35,878 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/11 [00:00<?, ?it/s]  9%|▉         | 1/11 [00:00<00:01,  5.88it/s] 27%|██▋       | 3/11 [00:00<00:00, 12.32it/s] 45%|████▌     | 5/11 [00:00<00:00, 13.59it/s] 64%|██████▎   | 7/11 [00:00<00:00, 13.75it/s] 82%|████████▏ | 9/11 [00:00<00:00, 13.93it/s]100%|██████████| 11/11 [00:02<00:00,  2.71it/s]100%|██████████| 11/11 [00:02<00:00,  4.35it/s]
2025-03-09 07:47:38,416 [INFO]: 	Computing best hyperparameters for index knn.index 03/09/2025, 07:47:38
2025-03-09 07:48:05,647 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 27.2303 secs
2025-03-09 07:48:05,647 [INFO]: The best hyperparameters are: efSearch=332
2025-03-09 07:48:05,647 [INFO]: 	Compute fast metrics 03/09/2025, 07:48:05
  0%|          | 0/4 [00:00<?, ?it/s] 25%|██▌       | 1/4 [00:00<00:00,  5.30it/s] 50%|█████     | 2/4 [00:00<00:00,  6.84it/s] 75%|███████▌  | 3/4 [00:00<00:00,  7.72it/s] 75%|███████▌  | 3/4 [00:00<00:00,  5.76it/s]
2025-03-09 07:48:19,475 [INFO]: 	>>> Finished "Compute fast metrics" in 13.8281 secs
2025-03-09 07:48:19,477 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 43.5993 secs
2025-03-09 07:48:19,477 [INFO]: {
2025-03-09 07:48:19,477 [INFO]: 	index_key: HNSW15
2025-03-09 07:48:19,477 [INFO]: 	index_param: efSearch=332
2025-03-09 07:48:19,477 [INFO]: 	index_path: knn.index
2025-03-09 07:48:19,477 [INFO]: 	size in bytes: 542619250
2025-03-09 07:48:19,477 [INFO]: 	avg_search_speed_ms: 12.424066504000784
2025-03-09 07:48:19,477 [INFO]: 	99p_search_speed_ms: 19.98013012111188
2025-03-09 07:48:19,477 [INFO]: 	reconstruction error %: 0.0
2025-03-09 07:48:19,477 [INFO]: 	nb vectors: 2758
2025-03-09 07:48:19,477 [INFO]: 	vectors dimension: 49152
2025-03-09 07:48:19,477 [INFO]: 	compression ratio: 0.9993100392217932
2025-03-09 07:48:19,477 [INFO]: }
2025-03-09 07:48:19,477 [INFO]: 	>>> Finished "Creating the index" in 43.6008 secs
2025-03-09 07:48:19,477 [INFO]: >>> Finished "Launching the whole pipeline" in 43.6286 secs
2025-03-09 07:48:20: [retrieval_preprocessing] calculating distances ...
2025-03-09 07:48:20: [retrieval_preprocessing] finished and saved retrieval indices for episode 7689 [episode count 3/20]
[retrieval_preprocessing] for episode 55315 [episode count 4/20], we have num_retrieval=np.int64(2742) num_query=np.int64(140)
2025-03-09 07:48:21,791 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-09 07:48:22,187 [INFO]: Launching the whole pipeline 03/09/2025, 07:48:22
2025-03-09 07:48:22,188 [INFO]: Reading total number of vectors and dimension 03/09/2025, 07:48:22
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 2304.56it/s]
2025-03-09 07:48:22,210 [INFO]: There are 2742 embeddings of dim 49152
2025-03-09 07:48:22,210 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0227 secs
2025-03-09 07:48:22,210 [INFO]: 	Compute estimated construction time of the index 03/09/2025, 07:48:22
2025-03-09 07:48:22,210 [INFO]: 		-> Train: 16.7 minutes
2025-03-09 07:48:22,210 [INFO]: 		-> Add: 1.5 seconds
2025-03-09 07:48:22,210 [INFO]: 		Total: 16.7 minutes
2025-03-09 07:48:22,210 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0001 secs
2025-03-09 07:48:22,210 [INFO]: 	Checking that your have enough memory available to create the index 03/09/2025, 07:48:22
2025-03-09 07:48:22,211 [INFO]: 565.9MB of memory will be needed to build the index (more might be used if you have more)
2025-03-09 07:48:22,211 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0001 secs
2025-03-09 07:48:22,211 [INFO]: 	Selecting most promising index types given data characteristics 03/09/2025, 07:48:22
2025-03-09 07:48:22,211 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-09 07:48:22,211 [INFO]: 	Creating the index 03/09/2025, 07:48:22
2025-03-09 07:48:22,211 [INFO]: 		-> Instanciate the index HNSW15 03/09/2025, 07:48:22
2025-03-09 07:48:22,212 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0010 secs
2025-03-09 07:48:22,212 [INFO]: 		-> Adding the vectors to the index 03/09/2025, 07:48:22
2025-03-09 07:48:22,212 [INFO]: The memory available for adding the vectors is 49.5GB(total available - used by the index)
2025-03-09 07:48:22,212 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/11 [00:00<?, ?it/s]  9%|▉         | 1/11 [00:00<00:01,  5.39it/s] 18%|█▊        | 2/11 [00:00<00:01,  6.92it/s] 27%|██▋       | 3/11 [00:00<00:01,  7.52it/s] 36%|███▋      | 4/11 [00:00<00:00,  7.85it/s] 45%|████▌     | 5/11 [00:00<00:00,  8.16it/s] 55%|█████▍    | 6/11 [00:00<00:00,  8.17it/s] 64%|██████▎   | 7/11 [00:00<00:00,  8.13it/s] 73%|███████▎  | 8/11 [00:01<00:00,  8.04it/s] 82%|████████▏ | 9/11 [00:01<00:00,  8.00it/s] 91%|█████████ | 10/11 [00:01<00:00,  7.93it/s]100%|██████████| 11/11 [00:03<00:00,  1.49it/s]100%|██████████| 11/11 [00:03<00:00,  3.44it/s]
2025-03-09 07:48:25,415 [INFO]: 	Computing best hyperparameters for index knn.index 03/09/2025, 07:48:25
2025-03-09 07:48:52,281 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 26.8656 secs
2025-03-09 07:48:52,281 [INFO]: The best hyperparameters are: efSearch=352
2025-03-09 07:48:52,281 [INFO]: 	Compute fast metrics 03/09/2025, 07:48:52
  0%|          | 0/4 [00:00<?, ?it/s] 25%|██▌       | 1/4 [00:00<00:00,  6.43it/s] 75%|███████▌  | 3/4 [00:00<00:00,  9.80it/s] 75%|███████▌  | 3/4 [00:00<00:00,  7.56it/s]
2025-03-09 07:49:06,698 [INFO]: 	>>> Finished "Compute fast metrics" in 14.4173 secs
2025-03-09 07:49:06,700 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 44.4884 secs
2025-03-09 07:49:06,701 [INFO]: {
2025-03-09 07:49:06,701 [INFO]: 	index_key: HNSW15
2025-03-09 07:49:06,701 [INFO]: 	index_param: efSearch=352
2025-03-09 07:49:06,701 [INFO]: 	index_path: knn.index
2025-03-09 07:49:06,701 [INFO]: 	size in bytes: 539471410
2025-03-09 07:49:06,701 [INFO]: 	avg_search_speed_ms: 11.944370076122606
2025-03-09 07:49:06,701 [INFO]: 	99p_search_speed_ms: 20.376403583213683
2025-03-09 07:49:06,701 [INFO]: 	reconstruction error %: 0.0
2025-03-09 07:49:06,701 [INFO]: 	nb vectors: 2742
2025-03-09 07:49:06,701 [INFO]: 	vectors dimension: 49152
2025-03-09 07:49:06,701 [INFO]: 	compression ratio: 0.9993099282128779
2025-03-09 07:49:06,701 [INFO]: }
2025-03-09 07:49:06,701 [INFO]: 	>>> Finished "Creating the index" in 44.4900 secs
2025-03-09 07:49:06,701 [INFO]: >>> Finished "Launching the whole pipeline" in 44.5132 secs
2025-03-09 07:49:09: [retrieval_preprocessing] calculating distances ...
2025-03-09 07:49:10: [retrieval_preprocessing] finished and saved retrieval indices for episode 55315 [episode count 4/20]
[retrieval_preprocessing] for episode 36379 [episode count 5/20], we have num_retrieval=np.int64(2715) num_query=np.int64(167)
2025-03-09 07:49:11,783 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-09 07:49:12,234 [INFO]: Launching the whole pipeline 03/09/2025, 07:49:12
2025-03-09 07:49:12,234 [INFO]: Reading total number of vectors and dimension 03/09/2025, 07:49:12
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1174.55it/s]
2025-03-09 07:49:12,260 [INFO]: There are 2715 embeddings of dim 49152
2025-03-09 07:49:12,261 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0261 secs
2025-03-09 07:49:12,261 [INFO]: 	Compute estimated construction time of the index 03/09/2025, 07:49:12
2025-03-09 07:49:12,261 [INFO]: 		-> Train: 16.7 minutes
2025-03-09 07:49:12,261 [INFO]: 		-> Add: 1.5 seconds
2025-03-09 07:49:12,261 [INFO]: 		Total: 16.7 minutes
2025-03-09 07:49:12,261 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0001 secs
2025-03-09 07:49:12,261 [INFO]: 	Checking that your have enough memory available to create the index 03/09/2025, 07:49:12
2025-03-09 07:49:12,261 [INFO]: 560.3MB of memory will be needed to build the index (more might be used if you have more)
2025-03-09 07:49:12,261 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0002 secs
2025-03-09 07:49:12,261 [INFO]: 	Selecting most promising index types given data characteristics 03/09/2025, 07:49:12
2025-03-09 07:49:12,261 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-09 07:49:12,261 [INFO]: 	Creating the index 03/09/2025, 07:49:12
2025-03-09 07:49:12,261 [INFO]: 		-> Instanciate the index HNSW15 03/09/2025, 07:49:12
2025-03-09 07:49:12,262 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0010 secs
2025-03-09 07:49:12,262 [INFO]: 		-> Adding the vectors to the index 03/09/2025, 07:49:12
2025-03-09 07:49:12,262 [INFO]: The memory available for adding the vectors is 49.5GB(total available - used by the index)
2025-03-09 07:49:12,262 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/11 [00:00<?, ?it/s]  9%|▉         | 1/11 [00:00<00:01,  7.09it/s] 27%|██▋       | 3/11 [00:00<00:00, 11.68it/s] 45%|████▌     | 5/11 [00:00<00:00, 11.74it/s] 64%|██████▎   | 7/11 [00:00<00:00, 11.76it/s] 82%|████████▏ | 9/11 [00:00<00:00, 12.58it/s]100%|██████████| 11/11 [00:02<00:00,  2.45it/s]100%|██████████| 11/11 [00:02<00:00,  3.94it/s]
2025-03-09 07:49:15,063 [INFO]: 	Computing best hyperparameters for index knn.index 03/09/2025, 07:49:15
2025-03-09 07:49:48,753 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 33.6895 secs
2025-03-09 07:49:48,753 [INFO]: The best hyperparameters are: efSearch=344
2025-03-09 07:49:48,753 [INFO]: 	Compute fast metrics 03/09/2025, 07:49:48
  0%|          | 0/4 [00:00<?, ?it/s] 25%|██▌       | 1/4 [00:00<00:00,  7.22it/s] 75%|███████▌  | 3/4 [00:00<00:00, 12.09it/s] 75%|███████▌  | 3/4 [00:00<00:00,  9.27it/s]
2025-03-09 07:50:03,517 [INFO]: 	>>> Finished "Compute fast metrics" in 14.7636 secs
2025-03-09 07:50:03,519 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 51.2567 secs
2025-03-09 07:50:03,519 [INFO]: {
2025-03-09 07:50:03,519 [INFO]: 	index_key: HNSW15
2025-03-09 07:50:03,519 [INFO]: 	index_param: efSearch=344
2025-03-09 07:50:03,519 [INFO]: 	index_path: knn.index
2025-03-09 07:50:03,519 [INFO]: 	size in bytes: 534159430
2025-03-09 07:50:03,519 [INFO]: 	avg_search_speed_ms: 11.696864899291455
2025-03-09 07:50:03,519 [INFO]: 	99p_search_speed_ms: 19.461545161902922
2025-03-09 07:50:03,519 [INFO]: 	reconstruction error %: 0.0
2025-03-09 07:50:03,519 [INFO]: 	nb vectors: 2715
2025-03-09 07:50:03,519 [INFO]: 	vectors dimension: 49152
2025-03-09 07:50:03,519 [INFO]: 	compression ratio: 0.9993097379185087
2025-03-09 07:50:03,519 [INFO]: }
2025-03-09 07:50:03,519 [INFO]: 	>>> Finished "Creating the index" in 51.2581 secs
2025-03-09 07:50:03,519 [INFO]: >>> Finished "Launching the whole pipeline" in 51.2847 secs
2025-03-09 07:50:05: [retrieval_preprocessing] calculating distances ...
2025-03-09 07:50:06: [retrieval_preprocessing] finished and saved retrieval indices for episode 36379 [episode count 5/20]
[retrieval_preprocessing] for episode 61982 [episode count 6/20], we have num_retrieval=np.int64(2728) num_query=np.int64(154)
2025-03-09 07:50:06,967 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-09 07:50:07,380 [INFO]: Launching the whole pipeline 03/09/2025, 07:50:07
2025-03-09 07:50:07,380 [INFO]: Reading total number of vectors and dimension 03/09/2025, 07:50:07
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1237.26it/s]
2025-03-09 07:50:07,405 [INFO]: There are 2728 embeddings of dim 49152
2025-03-09 07:50:07,405 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0247 secs
2025-03-09 07:50:07,405 [INFO]: 	Compute estimated construction time of the index 03/09/2025, 07:50:07
2025-03-09 07:50:07,405 [INFO]: 		-> Train: 16.7 minutes
2025-03-09 07:50:07,405 [INFO]: 		-> Add: 1.5 seconds
2025-03-09 07:50:07,405 [INFO]: 		Total: 16.7 minutes
2025-03-09 07:50:07,405 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0001 secs
2025-03-09 07:50:07,405 [INFO]: 	Checking that your have enough memory available to create the index 03/09/2025, 07:50:07
2025-03-09 07:50:07,405 [INFO]: 563.0MB of memory will be needed to build the index (more might be used if you have more)
2025-03-09 07:50:07,405 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0001 secs
2025-03-09 07:50:07,405 [INFO]: 	Selecting most promising index types given data characteristics 03/09/2025, 07:50:07
2025-03-09 07:50:07,405 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-09 07:50:07,405 [INFO]: 	Creating the index 03/09/2025, 07:50:07
2025-03-09 07:50:07,405 [INFO]: 		-> Instanciate the index HNSW15 03/09/2025, 07:50:07
2025-03-09 07:50:07,406 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0010 secs
2025-03-09 07:50:07,407 [INFO]: 		-> Adding the vectors to the index 03/09/2025, 07:50:07
2025-03-09 07:50:07,407 [INFO]: The memory available for adding the vectors is 49.5GB(total available - used by the index)
2025-03-09 07:50:07,407 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/11 [00:00<?, ?it/s]  9%|▉         | 1/11 [00:00<00:01,  6.34it/s] 27%|██▋       | 3/11 [00:00<00:00,  9.82it/s] 45%|████▌     | 5/11 [00:00<00:00, 10.80it/s] 64%|██████▎   | 7/11 [00:00<00:00, 11.25it/s] 82%|████████▏ | 9/11 [00:00<00:00, 11.35it/s]100%|██████████| 11/11 [00:02<00:00,  2.76it/s]100%|██████████| 11/11 [00:02<00:00,  4.27it/s]
2025-03-09 07:50:09,988 [INFO]: 	Computing best hyperparameters for index knn.index 03/09/2025, 07:50:09
2025-03-09 07:50:39,528 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 29.5394 secs
2025-03-09 07:50:39,528 [INFO]: The best hyperparameters are: efSearch=317
2025-03-09 07:50:39,528 [INFO]: 	Compute fast metrics 03/09/2025, 07:50:39
  0%|          | 0/4 [00:00<?, ?it/s] 25%|██▌       | 1/4 [00:00<00:00,  5.49it/s] 75%|███████▌  | 3/4 [00:00<00:00,  8.46it/s] 75%|███████▌  | 3/4 [00:00<00:00,  6.55it/s]
2025-03-09 07:50:55,367 [INFO]: 	>>> Finished "Compute fast metrics" in 15.8387 secs
2025-03-09 07:50:55,369 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 47.9621 secs
2025-03-09 07:50:55,369 [INFO]: {
2025-03-09 07:50:55,369 [INFO]: 	index_key: HNSW15
2025-03-09 07:50:55,369 [INFO]: 	index_param: efSearch=317
2025-03-09 07:50:55,369 [INFO]: 	index_path: knn.index
2025-03-09 07:50:55,369 [INFO]: 	size in bytes: 536717050
2025-03-09 07:50:55,369 [INFO]: 	avg_search_speed_ms: 10.944742067203464
2025-03-09 07:50:55,369 [INFO]: 	99p_search_speed_ms: 17.094646592158824
2025-03-09 07:50:55,369 [INFO]: 	reconstruction error %: 0.0
2025-03-09 07:50:55,369 [INFO]: 	nb vectors: 2728
2025-03-09 07:50:55,369 [INFO]: 	vectors dimension: 49152
2025-03-09 07:50:55,369 [INFO]: 	compression ratio: 0.9993098300119215
2025-03-09 07:50:55,369 [INFO]: }
2025-03-09 07:50:55,369 [INFO]: 	>>> Finished "Creating the index" in 47.9636 secs
2025-03-09 07:50:55,369 [INFO]: >>> Finished "Launching the whole pipeline" in 47.9888 secs
2025-03-09 07:50:56: [retrieval_preprocessing] calculating distances ...
2025-03-09 07:50:57: [retrieval_preprocessing] finished and saved retrieval indices for episode 61982 [episode count 6/20]
[retrieval_preprocessing] for episode 28202 [episode count 7/20], we have num_retrieval=np.int64(2665) num_query=np.int64(217)
2025-03-09 07:50:58,076 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-09 07:50:58,578 [INFO]: Launching the whole pipeline 03/09/2025, 07:50:58
2025-03-09 07:50:58,578 [INFO]: Reading total number of vectors and dimension 03/09/2025, 07:50:58
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1604.55it/s]
2025-03-09 07:50:58,610 [INFO]: There are 2665 embeddings of dim 49152
2025-03-09 07:50:58,610 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0318 secs
2025-03-09 07:50:58,610 [INFO]: 	Compute estimated construction time of the index 03/09/2025, 07:50:58
2025-03-09 07:50:58,610 [INFO]: 		-> Train: 16.7 minutes
2025-03-09 07:50:58,610 [INFO]: 		-> Add: 1.5 seconds
2025-03-09 07:50:58,610 [INFO]: 		Total: 16.7 minutes
2025-03-09 07:50:58,610 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0001 secs
2025-03-09 07:50:58,610 [INFO]: 	Checking that your have enough memory available to create the index 03/09/2025, 07:50:58
2025-03-09 07:50:58,610 [INFO]: 550.0MB of memory will be needed to build the index (more might be used if you have more)
2025-03-09 07:50:58,610 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0002 secs
2025-03-09 07:50:58,610 [INFO]: 	Selecting most promising index types given data characteristics 03/09/2025, 07:50:58
2025-03-09 07:50:58,610 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-09 07:50:58,611 [INFO]: 	Creating the index 03/09/2025, 07:50:58
2025-03-09 07:50:58,611 [INFO]: 		-> Instanciate the index HNSW15 03/09/2025, 07:50:58
2025-03-09 07:50:58,612 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0012 secs
2025-03-09 07:50:58,612 [INFO]: 		-> Adding the vectors to the index 03/09/2025, 07:50:58
2025-03-09 07:50:58,612 [INFO]: The memory available for adding the vectors is 49.5GB(total available - used by the index)
2025-03-09 07:50:58,612 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/11 [00:00<?, ?it/s]  9%|▉         | 1/11 [00:00<00:01,  5.34it/s] 18%|█▊        | 2/11 [00:00<00:01,  6.76it/s] 27%|██▋       | 3/11 [00:00<00:01,  7.38it/s] 36%|███▋      | 4/11 [00:00<00:00,  7.73it/s] 45%|████▌     | 5/11 [00:00<00:00,  7.86it/s] 55%|█████▍    | 6/11 [00:00<00:00,  8.12it/s] 64%|██████▎   | 7/11 [00:00<00:00,  8.39it/s] 73%|███████▎  | 8/11 [00:01<00:00,  8.60it/s] 91%|█████████ | 10/11 [00:01<00:00, 10.28it/s]100%|██████████| 11/11 [00:03<00:00,  3.63it/s]
2025-03-09 07:51:01,644 [INFO]: 	Computing best hyperparameters for index knn.index 03/09/2025, 07:51:01
2025-03-09 07:51:27,449 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 25.8045 secs
2025-03-09 07:51:27,449 [INFO]: The best hyperparameters are: efSearch=336
2025-03-09 07:51:27,449 [INFO]: 	Compute fast metrics 03/09/2025, 07:51:27
  0%|          | 0/4 [00:00<?, ?it/s] 25%|██▌       | 1/4 [00:00<00:00,  5.44it/s] 50%|█████     | 2/4 [00:00<00:00,  6.79it/s] 75%|███████▌  | 3/4 [00:00<00:00,  7.46it/s] 75%|███████▌  | 3/4 [00:00<00:00,  5.63it/s]
2025-03-09 07:51:45,019 [INFO]: 	>>> Finished "Compute fast metrics" in 17.5697 secs
2025-03-09 07:51:45,022 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 46.4097 secs
2025-03-09 07:51:45,022 [INFO]: {
2025-03-09 07:51:45,022 [INFO]: 	index_key: HNSW15
2025-03-09 07:51:45,022 [INFO]: 	index_param: efSearch=336
2025-03-09 07:51:45,022 [INFO]: 	index_path: knn.index
2025-03-09 07:51:45,022 [INFO]: 	size in bytes: 524322310
2025-03-09 07:51:45,022 [INFO]: 	avg_search_speed_ms: 11.366510414253836
2025-03-09 07:51:45,022 [INFO]: 	99p_search_speed_ms: 14.993141223676515
2025-03-09 07:51:45,022 [INFO]: 	reconstruction error %: 0.0
2025-03-09 07:51:45,022 [INFO]: 	nb vectors: 2665
2025-03-09 07:51:45,022 [INFO]: 	vectors dimension: 49152
2025-03-09 07:51:45,022 [INFO]: 	compression ratio: 0.9993096040487005
2025-03-09 07:51:45,022 [INFO]: }
2025-03-09 07:51:45,022 [INFO]: 	>>> Finished "Creating the index" in 46.4114 secs
2025-03-09 07:51:45,022 [INFO]: >>> Finished "Launching the whole pipeline" in 46.4440 secs
2025-03-09 07:51:46: [retrieval_preprocessing] calculating distances ...
2025-03-09 07:51:47: [retrieval_preprocessing] finished and saved retrieval indices for episode 28202 [episode count 7/20]
[retrieval_preprocessing] for episode 74795 [episode count 8/20], we have num_retrieval=np.int64(2792) num_query=np.int64(90)
2025-03-09 07:51:47,847 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-09 07:51:48,238 [INFO]: Launching the whole pipeline 03/09/2025, 07:51:48
2025-03-09 07:51:48,239 [INFO]: Reading total number of vectors and dimension 03/09/2025, 07:51:48
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1741.10it/s]
2025-03-09 07:51:48,262 [INFO]: There are 2792 embeddings of dim 49152
2025-03-09 07:51:48,262 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0239 secs
2025-03-09 07:51:48,262 [INFO]: 	Compute estimated construction time of the index 03/09/2025, 07:51:48
2025-03-09 07:51:48,263 [INFO]: 		-> Train: 16.7 minutes
2025-03-09 07:51:48,263 [INFO]: 		-> Add: 1.5 seconds
2025-03-09 07:51:48,263 [INFO]: 		Total: 16.7 minutes
2025-03-09 07:51:48,263 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0002 secs
2025-03-09 07:51:48,263 [INFO]: 	Checking that your have enough memory available to create the index 03/09/2025, 07:51:48
2025-03-09 07:51:48,263 [INFO]: 576.2MB of memory will be needed to build the index (more might be used if you have more)
2025-03-09 07:51:48,263 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0001 secs
2025-03-09 07:51:48,263 [INFO]: 	Selecting most promising index types given data characteristics 03/09/2025, 07:51:48
2025-03-09 07:51:48,263 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-09 07:51:48,263 [INFO]: 	Creating the index 03/09/2025, 07:51:48
2025-03-09 07:51:48,263 [INFO]: 		-> Instanciate the index HNSW15 03/09/2025, 07:51:48
2025-03-09 07:51:48,264 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0010 secs
2025-03-09 07:51:48,264 [INFO]: 		-> Adding the vectors to the index 03/09/2025, 07:51:48
2025-03-09 07:51:48,264 [INFO]: The memory available for adding the vectors is 49.5GB(total available - used by the index)
2025-03-09 07:51:48,264 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/11 [00:00<?, ?it/s]  9%|▉         | 1/11 [00:00<00:01,  7.95it/s] 27%|██▋       | 3/11 [00:00<00:00, 13.20it/s] 45%|████▌     | 5/11 [00:00<00:00, 14.97it/s] 64%|██████▎   | 7/11 [00:00<00:00, 15.96it/s] 82%|████████▏ | 9/11 [00:00<00:00, 16.38it/s]100%|██████████| 11/11 [00:02<00:00,  2.41it/s]100%|██████████| 11/11 [00:02<00:00,  4.02it/s]
2025-03-09 07:51:51,009 [INFO]: 	Computing best hyperparameters for index knn.index 03/09/2025, 07:51:51
2025-03-09 07:52:22,533 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 31.5238 secs
2025-03-09 07:52:22,533 [INFO]: The best hyperparameters are: efSearch=253
2025-03-09 07:52:22,533 [INFO]: 	Compute fast metrics 03/09/2025, 07:52:22
  0%|          | 0/4 [00:00<?, ?it/s] 25%|██▌       | 1/4 [00:00<00:00,  6.23it/s] 75%|███████▌  | 3/4 [00:00<00:00,  8.91it/s] 75%|███████▌  | 3/4 [00:00<00:00,  6.80it/s]
2025-03-09 07:52:37,911 [INFO]: 	>>> Finished "Compute fast metrics" in 15.3775 secs
2025-03-09 07:52:37,913 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 49.6485 secs
2025-03-09 07:52:37,913 [INFO]: {
2025-03-09 07:52:37,913 [INFO]: 	index_key: HNSW15
2025-03-09 07:52:37,913 [INFO]: 	index_param: efSearch=253
2025-03-09 07:52:37,913 [INFO]: 	index_path: knn.index
2025-03-09 07:52:37,913 [INFO]: 	size in bytes: 549308650
2025-03-09 07:52:37,913 [INFO]: 	avg_search_speed_ms: 10.264613463168532
2025-03-09 07:52:37,913 [INFO]: 	99p_search_speed_ms: 19.121467773802568
2025-03-09 07:52:37,913 [INFO]: 	reconstruction error %: 0.0
2025-03-09 07:52:37,913 [INFO]: 	nb vectors: 2792
2025-03-09 07:52:37,913 [INFO]: 	vectors dimension: 49152
2025-03-09 07:52:37,913 [INFO]: 	compression ratio: 0.9993098342798716
2025-03-09 07:52:37,913 [INFO]: }
2025-03-09 07:52:37,913 [INFO]: 	>>> Finished "Creating the index" in 49.6499 secs
2025-03-09 07:52:37,913 [INFO]: >>> Finished "Launching the whole pipeline" in 49.6746 secs
2025-03-09 07:52:38: [retrieval_preprocessing] calculating distances ...
2025-03-09 07:52:38: [retrieval_preprocessing] finished and saved retrieval indices for episode 74795 [episode count 8/20]
[retrieval_preprocessing] for episode 35900 [episode count 9/20], we have num_retrieval=np.int64(2765) num_query=np.int64(117)
2025-03-09 07:52:39,628 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-09 07:52:40,104 [INFO]: Launching the whole pipeline 03/09/2025, 07:52:40
2025-03-09 07:52:40,104 [INFO]: Reading total number of vectors and dimension 03/09/2025, 07:52:40
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1298.95it/s]
2025-03-09 07:52:40,137 [INFO]: There are 2765 embeddings of dim 49152
2025-03-09 07:52:40,137 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0330 secs
2025-03-09 07:52:40,138 [INFO]: 	Compute estimated construction time of the index 03/09/2025, 07:52:40
2025-03-09 07:52:40,138 [INFO]: 		-> Train: 16.7 minutes
2025-03-09 07:52:40,138 [INFO]: 		-> Add: 1.5 seconds
2025-03-09 07:52:40,138 [INFO]: 		Total: 16.7 minutes
2025-03-09 07:52:40,138 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0003 secs
2025-03-09 07:52:40,138 [INFO]: 	Checking that your have enough memory available to create the index 03/09/2025, 07:52:40
2025-03-09 07:52:40,138 [INFO]: 570.6MB of memory will be needed to build the index (more might be used if you have more)
2025-03-09 07:52:40,138 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0004 secs
2025-03-09 07:52:40,139 [INFO]: 	Selecting most promising index types given data characteristics 03/09/2025, 07:52:40
2025-03-09 07:52:40,139 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-09 07:52:40,139 [INFO]: 	Creating the index 03/09/2025, 07:52:40
2025-03-09 07:52:40,139 [INFO]: 		-> Instanciate the index HNSW15 03/09/2025, 07:52:40
2025-03-09 07:52:40,141 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0023 secs
2025-03-09 07:52:40,142 [INFO]: 		-> Adding the vectors to the index 03/09/2025, 07:52:40
2025-03-09 07:52:40,142 [INFO]: The memory available for adding the vectors is 49.5GB(total available - used by the index)
2025-03-09 07:52:40,142 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/11 [00:00<?, ?it/s]  9%|▉         | 1/11 [00:00<00:01,  5.59it/s] 18%|█▊        | 2/11 [00:00<00:01,  6.94it/s] 27%|██▋       | 3/11 [00:00<00:01,  7.51it/s] 36%|███▋      | 4/11 [00:00<00:00,  7.81it/s] 45%|████▌     | 5/11 [00:00<00:00,  8.14it/s] 55%|█████▍    | 6/11 [00:00<00:00,  8.28it/s] 64%|██████▎   | 7/11 [00:00<00:00,  8.32it/s] 73%|███████▎  | 8/11 [00:01<00:00,  8.31it/s] 82%|████████▏ | 9/11 [00:01<00:00,  8.34it/s] 91%|█████████ | 10/11 [00:01<00:00,  8.41it/s]100%|██████████| 11/11 [00:03<00:00,  1.46it/s]100%|██████████| 11/11 [00:03<00:00,  3.42it/s]
2025-03-09 07:52:43,373 [INFO]: 	Computing best hyperparameters for index knn.index 03/09/2025, 07:52:43
2025-03-09 07:53:12,219 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 28.8452 secs
2025-03-09 07:53:12,219 [INFO]: The best hyperparameters are: efSearch=301
2025-03-09 07:53:12,219 [INFO]: 	Compute fast metrics 03/09/2025, 07:53:12
  0%|          | 0/4 [00:00<?, ?it/s] 25%|██▌       | 1/4 [00:00<00:00,  5.32it/s] 75%|███████▌  | 3/4 [00:00<00:00,  8.24it/s] 75%|███████▌  | 3/4 [00:00<00:00,  6.36it/s]
2025-03-09 07:53:25,750 [INFO]: 	>>> Finished "Compute fast metrics" in 13.5305 secs
2025-03-09 07:53:26,090 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 45.9485 secs
2025-03-09 07:53:26,090 [INFO]: {
2025-03-09 07:53:26,090 [INFO]: 	index_key: HNSW15
2025-03-09 07:53:26,091 [INFO]: 	index_param: efSearch=301
2025-03-09 07:53:26,091 [INFO]: 	index_path: knn.index
2025-03-09 07:53:26,091 [INFO]: 	size in bytes: 543996610
2025-03-09 07:53:26,091 [INFO]: 	avg_search_speed_ms: 10.418273847608361
2025-03-09 07:53:26,091 [INFO]: 	99p_search_speed_ms: 14.684665524400767
2025-03-09 07:53:26,091 [INFO]: 	reconstruction error %: 0.0
2025-03-09 07:53:26,091 [INFO]: 	nb vectors: 2765
2025-03-09 07:53:26,091 [INFO]: 	vectors dimension: 49152
2025-03-09 07:53:26,091 [INFO]: 	compression ratio: 0.9993097567280796
2025-03-09 07:53:26,091 [INFO]: }
2025-03-09 07:53:26,091 [INFO]: 	>>> Finished "Creating the index" in 45.9524 secs
2025-03-09 07:53:26,091 [INFO]: >>> Finished "Launching the whole pipeline" in 45.9870 secs
2025-03-09 07:53:27: [retrieval_preprocessing] calculating distances ...
2025-03-09 07:53:27: [retrieval_preprocessing] finished and saved retrieval indices for episode 35900 [episode count 9/20]
[retrieval_preprocessing] for episode 4165 [episode count 10/20], we have num_retrieval=np.int64(2780) num_query=np.int64(102)
2025-03-09 07:53:28,808 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-09 07:53:29,272 [INFO]: Launching the whole pipeline 03/09/2025, 07:53:29
2025-03-09 07:53:29,272 [INFO]: Reading total number of vectors and dimension 03/09/2025, 07:53:29
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1842.84it/s]
2025-03-09 07:53:29,297 [INFO]: There are 2780 embeddings of dim 49152
2025-03-09 07:53:29,297 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0251 secs
2025-03-09 07:53:29,297 [INFO]: 	Compute estimated construction time of the index 03/09/2025, 07:53:29
2025-03-09 07:53:29,298 [INFO]: 		-> Train: 16.7 minutes
2025-03-09 07:53:29,298 [INFO]: 		-> Add: 1.5 seconds
2025-03-09 07:53:29,298 [INFO]: 		Total: 16.7 minutes
2025-03-09 07:53:29,298 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0001 secs
2025-03-09 07:53:29,298 [INFO]: 	Checking that your have enough memory available to create the index 03/09/2025, 07:53:29
2025-03-09 07:53:29,298 [INFO]: 573.7MB of memory will be needed to build the index (more might be used if you have more)
2025-03-09 07:53:29,298 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0001 secs
2025-03-09 07:53:29,298 [INFO]: 	Selecting most promising index types given data characteristics 03/09/2025, 07:53:29
2025-03-09 07:53:29,298 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-09 07:53:29,298 [INFO]: 	Creating the index 03/09/2025, 07:53:29
2025-03-09 07:53:29,298 [INFO]: 		-> Instanciate the index HNSW15 03/09/2025, 07:53:29
2025-03-09 07:53:29,299 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0011 secs
2025-03-09 07:53:29,299 [INFO]: 		-> Adding the vectors to the index 03/09/2025, 07:53:29
2025-03-09 07:53:29,299 [INFO]: The memory available for adding the vectors is 49.5GB(total available - used by the index)
2025-03-09 07:53:29,299 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/11 [00:00<?, ?it/s]  9%|▉         | 1/11 [00:00<00:01,  5.14it/s] 18%|█▊        | 2/11 [00:00<00:01,  6.77it/s] 27%|██▋       | 3/11 [00:00<00:01,  7.45it/s] 36%|███▋      | 4/11 [00:00<00:00,  7.80it/s] 45%|████▌     | 5/11 [00:00<00:00,  8.04it/s] 55%|█████▍    | 6/11 [00:00<00:00,  8.14it/s] 64%|██████▎   | 7/11 [00:00<00:00,  8.23it/s] 73%|███████▎  | 8/11 [00:01<00:00,  8.34it/s] 82%|████████▏ | 9/11 [00:01<00:00,  8.19it/s] 91%|█████████ | 10/11 [00:01<00:00,  8.21it/s]100%|██████████| 11/11 [00:03<00:00,  1.53it/s]100%|██████████| 11/11 [00:03<00:00,  3.51it/s]
2025-03-09 07:53:32,437 [INFO]: 	Computing best hyperparameters for index knn.index 03/09/2025, 07:53:32
2025-03-09 07:54:00,730 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 28.2926 secs
2025-03-09 07:54:00,730 [INFO]: The best hyperparameters are: efSearch=333
2025-03-09 07:54:00,730 [INFO]: 	Compute fast metrics 03/09/2025, 07:54:00
  0%|          | 0/4 [00:00<?, ?it/s] 25%|██▌       | 1/4 [00:00<00:00,  5.63it/s] 50%|█████     | 2/4 [00:00<00:00,  7.32it/s] 75%|███████▌  | 3/4 [00:00<00:00,  8.25it/s] 75%|███████▌  | 3/4 [00:00<00:00,  6.12it/s]
2025-03-09 07:54:16,146 [INFO]: 	>>> Finished "Compute fast metrics" in 15.4158 secs
2025-03-09 07:54:16,148 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 46.8489 secs
2025-03-09 07:54:16,148 [INFO]: {
2025-03-09 07:54:16,148 [INFO]: 	index_key: HNSW15
2025-03-09 07:54:16,148 [INFO]: 	index_param: efSearch=333
2025-03-09 07:54:16,148 [INFO]: 	index_path: knn.index
2025-03-09 07:54:16,148 [INFO]: 	size in bytes: 546947710
2025-03-09 07:54:16,148 [INFO]: 	avg_search_speed_ms: 11.434269755546536
2025-03-09 07:54:16,148 [INFO]: 	99p_search_speed_ms: 18.99573863483965
2025-03-09 07:54:16,148 [INFO]: 	reconstruction error %: 0.0
2025-03-09 07:54:16,148 [INFO]: 	nb vectors: 2780
2025-03-09 07:54:16,148 [INFO]: 	vectors dimension: 49152
2025-03-09 07:54:16,148 [INFO]: 	compression ratio: 0.9993098609005969
2025-03-09 07:54:16,148 [INFO]: }
2025-03-09 07:54:16,148 [INFO]: 	>>> Finished "Creating the index" in 46.8505 secs
2025-03-09 07:54:16,148 [INFO]: >>> Finished "Launching the whole pipeline" in 46.8763 secs
2025-03-09 07:54:16: [retrieval_preprocessing] calculating distances ...
2025-03-09 07:54:17: [retrieval_preprocessing] finished and saved retrieval indices for episode 4165 [episode count 10/20]
[retrieval_preprocessing] for episode 60491 [episode count 11/20], we have num_retrieval=np.int64(2750) num_query=np.int64(132)
2025-03-09 07:54:17,990 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-09 07:54:18,398 [INFO]: Launching the whole pipeline 03/09/2025, 07:54:18
2025-03-09 07:54:18,398 [INFO]: Reading total number of vectors and dimension 03/09/2025, 07:54:18
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1303.39it/s]
2025-03-09 07:54:18,426 [INFO]: There are 2750 embeddings of dim 49152
2025-03-09 07:54:18,426 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0283 secs
2025-03-09 07:54:18,426 [INFO]: 	Compute estimated construction time of the index 03/09/2025, 07:54:18
2025-03-09 07:54:18,427 [INFO]: 		-> Train: 16.7 minutes
2025-03-09 07:54:18,427 [INFO]: 		-> Add: 1.5 seconds
2025-03-09 07:54:18,427 [INFO]: 		Total: 16.7 minutes
2025-03-09 07:54:18,427 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0006 secs
2025-03-09 07:54:18,427 [INFO]: 	Checking that your have enough memory available to create the index 03/09/2025, 07:54:18
2025-03-09 07:54:18,427 [INFO]: 567.5MB of memory will be needed to build the index (more might be used if you have more)
2025-03-09 07:54:18,428 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0004 secs
2025-03-09 07:54:18,428 [INFO]: 	Selecting most promising index types given data characteristics 03/09/2025, 07:54:18
2025-03-09 07:54:18,428 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-09 07:54:18,428 [INFO]: 	Creating the index 03/09/2025, 07:54:18
2025-03-09 07:54:18,428 [INFO]: 		-> Instanciate the index HNSW15 03/09/2025, 07:54:18
2025-03-09 07:54:18,431 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0027 secs
2025-03-09 07:54:18,431 [INFO]: 		-> Adding the vectors to the index 03/09/2025, 07:54:18
2025-03-09 07:54:18,431 [INFO]: The memory available for adding the vectors is 49.5GB(total available - used by the index)
2025-03-09 07:54:18,431 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/11 [00:00<?, ?it/s]  9%|▉         | 1/11 [00:00<00:01,  6.39it/s] 27%|██▋       | 3/11 [00:00<00:00,  9.39it/s] 45%|████▌     | 5/11 [00:00<00:00, 10.06it/s] 64%|██████▎   | 7/11 [00:00<00:00, 10.36it/s] 82%|████████▏ | 9/11 [00:00<00:00, 10.54it/s]100%|██████████| 11/11 [00:02<00:00,  2.36it/s]100%|██████████| 11/11 [00:02<00:00,  3.72it/s]
2025-03-09 07:54:21,402 [INFO]: 	Computing best hyperparameters for index knn.index 03/09/2025, 07:54:21
2025-03-09 07:54:49,690 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 28.2876 secs
2025-03-09 07:54:49,690 [INFO]: The best hyperparameters are: efSearch=224
2025-03-09 07:54:49,690 [INFO]: 	Compute fast metrics 03/09/2025, 07:54:49
  0%|          | 0/4 [00:00<?, ?it/s] 25%|██▌       | 1/4 [00:00<00:00,  4.75it/s] 75%|███████▌  | 3/4 [00:00<00:00, 10.05it/s]
2025-03-09 07:55:06,615 [INFO]: 	>>> Finished "Compute fast metrics" in 16.9239 secs
2025-03-09 07:55:06,617 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 48.1857 secs
2025-03-09 07:55:06,617 [INFO]: {
2025-03-09 07:55:06,617 [INFO]: 	index_key: HNSW15
2025-03-09 07:55:06,617 [INFO]: 	index_param: efSearch=224
2025-03-09 07:55:06,617 [INFO]: 	index_path: knn.index
2025-03-09 07:55:06,617 [INFO]: 	size in bytes: 541045330
2025-03-09 07:55:06,617 [INFO]: 	avg_search_speed_ms: 11.917232441981195
2025-03-09 07:55:06,617 [INFO]: 	99p_search_speed_ms: 24.846664890646935
2025-03-09 07:55:06,617 [INFO]: 	reconstruction error %: 0.0
2025-03-09 07:55:06,617 [INFO]: 	nb vectors: 2750
2025-03-09 07:55:06,617 [INFO]: 	vectors dimension: 49152
2025-03-09 07:55:06,617 [INFO]: 	compression ratio: 0.9993099838788
2025-03-09 07:55:06,617 [INFO]: }
2025-03-09 07:55:06,617 [INFO]: 	>>> Finished "Creating the index" in 48.1892 secs
2025-03-09 07:55:06,617 [INFO]: >>> Finished "Launching the whole pipeline" in 48.2194 secs
2025-03-09 07:55:07: [retrieval_preprocessing] calculating distances ...
2025-03-09 07:55:07: [retrieval_preprocessing] finished and saved retrieval indices for episode 60491 [episode count 11/20]
[retrieval_preprocessing] for episode 2637 [episode count 12/20], we have num_retrieval=np.int64(2769) num_query=np.int64(113)
2025-03-09 07:55:08,377 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-09 07:55:08,821 [INFO]: Launching the whole pipeline 03/09/2025, 07:55:08
2025-03-09 07:55:08,821 [INFO]: Reading total number of vectors and dimension 03/09/2025, 07:55:08
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1507.12it/s]
2025-03-09 07:55:08,847 [INFO]: There are 2769 embeddings of dim 49152
2025-03-09 07:55:08,848 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0264 secs
2025-03-09 07:55:08,848 [INFO]: 	Compute estimated construction time of the index 03/09/2025, 07:55:08
2025-03-09 07:55:08,848 [INFO]: 		-> Train: 16.7 minutes
2025-03-09 07:55:08,848 [INFO]: 		-> Add: 1.5 seconds
2025-03-09 07:55:08,848 [INFO]: 		Total: 16.7 minutes
2025-03-09 07:55:08,848 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0001 secs
2025-03-09 07:55:08,848 [INFO]: 	Checking that your have enough memory available to create the index 03/09/2025, 07:55:08
2025-03-09 07:55:08,848 [INFO]: 571.5MB of memory will be needed to build the index (more might be used if you have more)
2025-03-09 07:55:08,848 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0001 secs
2025-03-09 07:55:08,848 [INFO]: 	Selecting most promising index types given data characteristics 03/09/2025, 07:55:08
2025-03-09 07:55:08,848 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-09 07:55:08,848 [INFO]: 	Creating the index 03/09/2025, 07:55:08
2025-03-09 07:55:08,848 [INFO]: 		-> Instanciate the index HNSW15 03/09/2025, 07:55:08
2025-03-09 07:55:08,849 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0009 secs
2025-03-09 07:55:08,849 [INFO]: 		-> Adding the vectors to the index 03/09/2025, 07:55:08
2025-03-09 07:55:08,849 [INFO]: The memory available for adding the vectors is 49.5GB(total available - used by the index)
2025-03-09 07:55:08,849 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/11 [00:00<?, ?it/s]  9%|▉         | 1/11 [00:00<00:02,  3.86it/s] 18%|█▊        | 2/11 [00:00<00:01,  5.94it/s] 27%|██▋       | 3/11 [00:00<00:01,  6.95it/s] 36%|███▋      | 4/11 [00:00<00:00,  7.46it/s] 45%|████▌     | 5/11 [00:00<00:00,  7.79it/s] 55%|█████▍    | 6/11 [00:00<00:00,  7.99it/s] 64%|██████▎   | 7/11 [00:00<00:00,  8.19it/s] 73%|███████▎  | 8/11 [00:01<00:00,  8.40it/s] 82%|████████▏ | 9/11 [00:01<00:00,  8.43it/s] 91%|█████████ | 10/11 [00:01<00:00,  8.43it/s]100%|██████████| 11/11 [00:03<00:00,  1.52it/s]100%|██████████| 11/11 [00:03<00:00,  3.45it/s]
2025-03-09 07:55:12,044 [INFO]: 	Computing best hyperparameters for index knn.index 03/09/2025, 07:55:12
2025-03-09 07:55:41,789 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 29.7447 secs
2025-03-09 07:55:41,789 [INFO]: The best hyperparameters are: efSearch=359
2025-03-09 07:55:41,789 [INFO]: 	Compute fast metrics 03/09/2025, 07:55:41
  0%|          | 0/4 [00:00<?, ?it/s] 25%|██▌       | 1/4 [00:00<00:00,  6.03it/s] 75%|███████▌  | 3/4 [00:00<00:00,  9.42it/s] 75%|███████▌  | 3/4 [00:00<00:00,  7.26it/s]
2025-03-09 07:55:56,611 [INFO]: 	>>> Finished "Compute fast metrics" in 14.8216 secs
2025-03-09 07:55:56,613 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 47.7643 secs
2025-03-09 07:55:56,614 [INFO]: {
2025-03-09 07:55:56,614 [INFO]: 	index_key: HNSW15
2025-03-09 07:55:56,614 [INFO]: 	index_param: efSearch=359
2025-03-09 07:55:56,614 [INFO]: 	index_path: knn.index
2025-03-09 07:55:56,614 [INFO]: 	size in bytes: 544783570
2025-03-09 07:55:56,614 [INFO]: 	avg_search_speed_ms: 11.602101319203728
2025-03-09 07:55:56,614 [INFO]: 	99p_search_speed_ms: 15.879066148772834
2025-03-09 07:55:56,614 [INFO]: 	reconstruction error %: 0.0
2025-03-09 07:55:56,614 [INFO]: 	nb vectors: 2769
2025-03-09 07:55:56,614 [INFO]: 	vectors dimension: 49152
2025-03-09 07:55:56,614 [INFO]: 	compression ratio: 0.9993097846177703
2025-03-09 07:55:56,614 [INFO]: }
2025-03-09 07:55:56,614 [INFO]: 	>>> Finished "Creating the index" in 47.7657 secs
2025-03-09 07:55:56,614 [INFO]: >>> Finished "Launching the whole pipeline" in 47.7926 secs
2025-03-09 07:55:58: [retrieval_preprocessing] calculating distances ...
2025-03-09 07:55:58: [retrieval_preprocessing] finished and saved retrieval indices for episode 2637 [episode count 12/20]
[retrieval_preprocessing] for episode 13908 [episode count 13/20], we have num_retrieval=np.int64(2750) num_query=np.int64(132)
2025-03-09 07:55:59,469 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-09 07:55:59,954 [INFO]: Launching the whole pipeline 03/09/2025, 07:55:59
2025-03-09 07:55:59,954 [INFO]: Reading total number of vectors and dimension 03/09/2025, 07:55:59
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1301.77it/s]
2025-03-09 07:55:59,980 [INFO]: There are 2750 embeddings of dim 49152
2025-03-09 07:55:59,980 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0261 secs
2025-03-09 07:55:59,980 [INFO]: 	Compute estimated construction time of the index 03/09/2025, 07:55:59
2025-03-09 07:55:59,980 [INFO]: 		-> Train: 16.7 minutes
2025-03-09 07:55:59,980 [INFO]: 		-> Add: 1.5 seconds
2025-03-09 07:55:59,980 [INFO]: 		Total: 16.7 minutes
2025-03-09 07:55:59,980 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0001 secs
2025-03-09 07:55:59,980 [INFO]: 	Checking that your have enough memory available to create the index 03/09/2025, 07:55:59
2025-03-09 07:55:59,980 [INFO]: 567.5MB of memory will be needed to build the index (more might be used if you have more)
2025-03-09 07:55:59,980 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0001 secs
2025-03-09 07:55:59,980 [INFO]: 	Selecting most promising index types given data characteristics 03/09/2025, 07:55:59
2025-03-09 07:55:59,980 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-09 07:55:59,980 [INFO]: 	Creating the index 03/09/2025, 07:55:59
2025-03-09 07:55:59,980 [INFO]: 		-> Instanciate the index HNSW15 03/09/2025, 07:55:59
2025-03-09 07:55:59,981 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0010 secs
2025-03-09 07:55:59,981 [INFO]: 		-> Adding the vectors to the index 03/09/2025, 07:55:59
2025-03-09 07:55:59,982 [INFO]: The memory available for adding the vectors is 49.5GB(total available - used by the index)
2025-03-09 07:55:59,982 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/11 [00:00<?, ?it/s]  9%|▉         | 1/11 [00:00<00:01,  5.92it/s] 27%|██▋       | 3/11 [00:00<00:00, 11.58it/s] 45%|████▌     | 5/11 [00:00<00:00, 13.82it/s] 64%|██████▎   | 7/11 [00:00<00:00, 14.72it/s] 82%|████████▏ | 9/11 [00:00<00:00, 13.52it/s]100%|██████████| 11/11 [00:02<00:00,  2.73it/s]100%|██████████| 11/11 [00:02<00:00,  4.37it/s]
2025-03-09 07:56:02,509 [INFO]: 	Computing best hyperparameters for index knn.index 03/09/2025, 07:56:02
2025-03-09 07:56:28,680 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 26.1711 secs
2025-03-09 07:56:28,680 [INFO]: The best hyperparameters are: efSearch=332
2025-03-09 07:56:28,680 [INFO]: 	Compute fast metrics 03/09/2025, 07:56:28
  0%|          | 0/4 [00:00<?, ?it/s] 25%|██▌       | 1/4 [00:00<00:00,  5.35it/s] 50%|█████     | 2/4 [00:00<00:00,  7.04it/s] 75%|███████▌  | 3/4 [00:00<00:00,  7.87it/s] 75%|███████▌  | 3/4 [00:00<00:00,  5.90it/s]
2025-03-09 07:56:45,403 [INFO]: 	>>> Finished "Compute fast metrics" in 16.7229 secs
2025-03-09 07:56:45,406 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 45.4242 secs
2025-03-09 07:56:45,406 [INFO]: {
2025-03-09 07:56:45,406 [INFO]: 	index_key: HNSW15
2025-03-09 07:56:45,406 [INFO]: 	index_param: efSearch=332
2025-03-09 07:56:45,406 [INFO]: 	index_path: knn.index
2025-03-09 07:56:45,406 [INFO]: 	size in bytes: 541045330
2025-03-09 07:56:45,406 [INFO]: 	avg_search_speed_ms: 11.227746354311487
2025-03-09 07:56:45,406 [INFO]: 	99p_search_speed_ms: 16.73167448025197
2025-03-09 07:56:45,406 [INFO]: 	reconstruction error %: 0.0
2025-03-09 07:56:45,406 [INFO]: 	nb vectors: 2750
2025-03-09 07:56:45,406 [INFO]: 	vectors dimension: 49152
2025-03-09 07:56:45,406 [INFO]: 	compression ratio: 0.9993099838788
2025-03-09 07:56:45,406 [INFO]: }
2025-03-09 07:56:45,406 [INFO]: 	>>> Finished "Creating the index" in 45.4258 secs
2025-03-09 07:56:45,406 [INFO]: >>> Finished "Launching the whole pipeline" in 45.4524 secs
2025-03-09 07:56:46: [retrieval_preprocessing] calculating distances ...
2025-03-09 07:56:46: [retrieval_preprocessing] finished and saved retrieval indices for episode 13908 [episode count 13/20]
[retrieval_preprocessing] for episode 39512 [episode count 14/20], we have num_retrieval=np.int64(2756) num_query=np.int64(126)
2025-03-09 07:56:47,494 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-09 07:56:47,873 [INFO]: Launching the whole pipeline 03/09/2025, 07:56:47
2025-03-09 07:56:47,873 [INFO]: Reading total number of vectors and dimension 03/09/2025, 07:56:47
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1254.65it/s]
2025-03-09 07:56:47,899 [INFO]: There are 2756 embeddings of dim 49152
2025-03-09 07:56:47,899 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0257 secs
2025-03-09 07:56:47,899 [INFO]: 	Compute estimated construction time of the index 03/09/2025, 07:56:47
2025-03-09 07:56:47,899 [INFO]: 		-> Train: 16.7 minutes
2025-03-09 07:56:47,899 [INFO]: 		-> Add: 1.5 seconds
2025-03-09 07:56:47,899 [INFO]: 		Total: 16.7 minutes
2025-03-09 07:56:47,899 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0001 secs
2025-03-09 07:56:47,899 [INFO]: 	Checking that your have enough memory available to create the index 03/09/2025, 07:56:47
2025-03-09 07:56:47,899 [INFO]: 568.8MB of memory will be needed to build the index (more might be used if you have more)
2025-03-09 07:56:47,900 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0003 secs
2025-03-09 07:56:47,900 [INFO]: 	Selecting most promising index types given data characteristics 03/09/2025, 07:56:47
2025-03-09 07:56:47,900 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-09 07:56:47,900 [INFO]: 	Creating the index 03/09/2025, 07:56:47
2025-03-09 07:56:47,900 [INFO]: 		-> Instanciate the index HNSW15 03/09/2025, 07:56:47
2025-03-09 07:56:47,901 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0010 secs
2025-03-09 07:56:47,901 [INFO]: 		-> Adding the vectors to the index 03/09/2025, 07:56:47
2025-03-09 07:56:47,901 [INFO]: The memory available for adding the vectors is 49.5GB(total available - used by the index)
2025-03-09 07:56:47,901 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/11 [00:00<?, ?it/s]  9%|▉         | 1/11 [00:00<00:01,  5.32it/s] 18%|█▊        | 2/11 [00:00<00:01,  6.64it/s] 27%|██▋       | 3/11 [00:00<00:01,  7.79it/s] 45%|████▌     | 5/11 [00:00<00:00,  8.98it/s] 64%|██████▎   | 7/11 [00:00<00:00,  9.44it/s] 82%|████████▏ | 9/11 [00:01<00:00,  9.75it/s]100%|██████████| 11/11 [00:03<00:00,  2.35it/s]100%|██████████| 11/11 [00:03<00:00,  3.64it/s]
2025-03-09 07:56:50,928 [INFO]: 	Computing best hyperparameters for index knn.index 03/09/2025, 07:56:50
2025-03-09 07:57:20,332 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 29.4039 secs
2025-03-09 07:57:20,332 [INFO]: The best hyperparameters are: efSearch=346
2025-03-09 07:57:20,332 [INFO]: 	Compute fast metrics 03/09/2025, 07:57:20
  0%|          | 0/4 [00:00<?, ?it/s] 25%|██▌       | 1/4 [00:00<00:00,  6.12it/s] 75%|███████▌  | 3/4 [00:00<00:00,  9.93it/s] 75%|███████▌  | 3/4 [00:00<00:00,  7.56it/s]
2025-03-09 07:57:33,879 [INFO]: 	>>> Finished "Compute fast metrics" in 13.5468 secs
2025-03-09 07:57:33,881 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 45.9806 secs
2025-03-09 07:57:33,882 [INFO]: {
2025-03-09 07:57:33,882 [INFO]: 	index_key: HNSW15
2025-03-09 07:57:33,882 [INFO]: 	index_param: efSearch=346
2025-03-09 07:57:33,882 [INFO]: 	index_path: knn.index
2025-03-09 07:57:33,882 [INFO]: 	size in bytes: 542225770
2025-03-09 07:57:33,882 [INFO]: 	avg_search_speed_ms: 15.56088288190078
2025-03-09 07:57:33,882 [INFO]: 	99p_search_speed_ms: 25.947125856764615
2025-03-09 07:57:33,882 [INFO]: 	reconstruction error %: 0.0
2025-03-09 07:57:33,882 [INFO]: 	nb vectors: 2756
2025-03-09 07:57:33,882 [INFO]: 	vectors dimension: 49152
2025-03-09 07:57:33,882 [INFO]: 	compression ratio: 0.9993100254161656
2025-03-09 07:57:33,882 [INFO]: }
2025-03-09 07:57:33,882 [INFO]: 	>>> Finished "Creating the index" in 45.9820 secs
2025-03-09 07:57:33,882 [INFO]: >>> Finished "Launching the whole pipeline" in 46.0084 secs
2025-03-09 07:57:35: [retrieval_preprocessing] calculating distances ...
2025-03-09 07:57:36: [retrieval_preprocessing] finished and saved retrieval indices for episode 39512 [episode count 14/20]
[retrieval_preprocessing] for episode 83549 [episode count 15/20], we have num_retrieval=np.int64(2769) num_query=np.int64(113)
2025-03-09 07:57:37,078 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-09 07:57:37,551 [INFO]: Launching the whole pipeline 03/09/2025, 07:57:37
2025-03-09 07:57:37,551 [INFO]: Reading total number of vectors and dimension 03/09/2025, 07:57:37
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1089.15it/s]
2025-03-09 07:57:37,582 [INFO]: There are 2769 embeddings of dim 49152
2025-03-09 07:57:37,583 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0320 secs
2025-03-09 07:57:37,583 [INFO]: 	Compute estimated construction time of the index 03/09/2025, 07:57:37
2025-03-09 07:57:37,583 [INFO]: 		-> Train: 16.7 minutes
2025-03-09 07:57:37,584 [INFO]: 		-> Add: 1.5 seconds
2025-03-09 07:57:37,584 [INFO]: 		Total: 16.7 minutes
2025-03-09 07:57:37,584 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0007 secs
2025-03-09 07:57:37,584 [INFO]: 	Checking that your have enough memory available to create the index 03/09/2025, 07:57:37
2025-03-09 07:57:37,584 [INFO]: 571.5MB of memory will be needed to build the index (more might be used if you have more)
2025-03-09 07:57:37,584 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0005 secs
2025-03-09 07:57:37,585 [INFO]: 	Selecting most promising index types given data characteristics 03/09/2025, 07:57:37
2025-03-09 07:57:37,585 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-09 07:57:37,585 [INFO]: 	Creating the index 03/09/2025, 07:57:37
2025-03-09 07:57:37,585 [INFO]: 		-> Instanciate the index HNSW15 03/09/2025, 07:57:37
2025-03-09 07:57:37,588 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0031 secs
2025-03-09 07:57:37,588 [INFO]: 		-> Adding the vectors to the index 03/09/2025, 07:57:37
2025-03-09 07:57:37,588 [INFO]: The memory available for adding the vectors is 49.5GB(total available - used by the index)
2025-03-09 07:57:37,589 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/11 [00:00<?, ?it/s]  9%|▉         | 1/11 [00:00<00:02,  4.71it/s] 18%|█▊        | 2/11 [00:00<00:01,  6.27it/s] 27%|██▋       | 3/11 [00:00<00:01,  7.13it/s] 36%|███▋      | 4/11 [00:00<00:00,  7.51it/s] 45%|████▌     | 5/11 [00:00<00:00,  7.74it/s] 55%|█████▍    | 6/11 [00:00<00:00,  7.89it/s] 64%|██████▎   | 7/11 [00:00<00:00,  7.94it/s] 73%|███████▎  | 8/11 [00:01<00:00,  8.02it/s] 82%|████████▏ | 9/11 [00:01<00:00,  7.94it/s] 91%|█████████ | 10/11 [00:01<00:00,  7.81it/s]100%|██████████| 11/11 [00:03<00:00,  1.25it/s]100%|██████████| 11/11 [00:03<00:00,  3.01it/s]
2025-03-09 07:57:41,254 [INFO]: 	Computing best hyperparameters for index knn.index 03/09/2025, 07:57:41
2025-03-09 07:58:11,496 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 30.2414 secs
2025-03-09 07:58:11,496 [INFO]: The best hyperparameters are: efSearch=339
2025-03-09 07:58:11,496 [INFO]: 	Compute fast metrics 03/09/2025, 07:58:11
  0%|          | 0/4 [00:00<?, ?it/s] 25%|██▌       | 1/4 [00:00<00:00,  3.91it/s] 75%|███████▌  | 3/4 [00:00<00:00,  7.30it/s] 75%|███████▌  | 3/4 [00:00<00:00,  5.60it/s]
2025-03-09 07:58:25,343 [INFO]: 	>>> Finished "Compute fast metrics" in 13.8470 secs
2025-03-09 07:58:25,345 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 47.7569 secs
2025-03-09 07:58:25,345 [INFO]: {
2025-03-09 07:58:25,345 [INFO]: 	index_key: HNSW15
2025-03-09 07:58:25,345 [INFO]: 	index_param: efSearch=339
2025-03-09 07:58:25,345 [INFO]: 	index_path: knn.index
2025-03-09 07:58:25,345 [INFO]: 	size in bytes: 544783570
2025-03-09 07:58:25,345 [INFO]: 	avg_search_speed_ms: 11.494621342240736
2025-03-09 07:58:25,345 [INFO]: 	99p_search_speed_ms: 17.102877846918986
2025-03-09 07:58:25,345 [INFO]: 	reconstruction error %: 0.0
2025-03-09 07:58:25,346 [INFO]: 	nb vectors: 2769
2025-03-09 07:58:25,346 [INFO]: 	vectors dimension: 49152
2025-03-09 07:58:25,346 [INFO]: 	compression ratio: 0.9993097846177703
2025-03-09 07:58:25,346 [INFO]: }
2025-03-09 07:58:25,346 [INFO]: 	>>> Finished "Creating the index" in 47.7608 secs
2025-03-09 07:58:25,346 [INFO]: >>> Finished "Launching the whole pipeline" in 47.7947 secs
2025-03-09 07:58:26: [retrieval_preprocessing] calculating distances ...
2025-03-09 07:58:26: [retrieval_preprocessing] finished and saved retrieval indices for episode 83549 [episode count 15/20]
[retrieval_preprocessing] for episode 50782 [episode count 16/20], we have num_retrieval=np.int64(2741) num_query=np.int64(141)
2025-03-09 07:58:27,251 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-09 07:58:27,674 [INFO]: Launching the whole pipeline 03/09/2025, 07:58:27
2025-03-09 07:58:27,674 [INFO]: Reading total number of vectors and dimension 03/09/2025, 07:58:27
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1715.46it/s]
2025-03-09 07:58:27,699 [INFO]: There are 2741 embeddings of dim 49152
2025-03-09 07:58:27,699 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0251 secs
2025-03-09 07:58:27,699 [INFO]: 	Compute estimated construction time of the index 03/09/2025, 07:58:27
2025-03-09 07:58:27,699 [INFO]: 		-> Train: 16.7 minutes
2025-03-09 07:58:27,699 [INFO]: 		-> Add: 1.5 seconds
2025-03-09 07:58:27,699 [INFO]: 		Total: 16.7 minutes
2025-03-09 07:58:27,699 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0001 secs
2025-03-09 07:58:27,699 [INFO]: 	Checking that your have enough memory available to create the index 03/09/2025, 07:58:27
2025-03-09 07:58:27,699 [INFO]: 565.7MB of memory will be needed to build the index (more might be used if you have more)
2025-03-09 07:58:27,699 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0001 secs
2025-03-09 07:58:27,699 [INFO]: 	Selecting most promising index types given data characteristics 03/09/2025, 07:58:27
2025-03-09 07:58:27,699 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-09 07:58:27,699 [INFO]: 	Creating the index 03/09/2025, 07:58:27
2025-03-09 07:58:27,699 [INFO]: 		-> Instanciate the index HNSW15 03/09/2025, 07:58:27
2025-03-09 07:58:27,700 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0010 secs
2025-03-09 07:58:27,701 [INFO]: 		-> Adding the vectors to the index 03/09/2025, 07:58:27
2025-03-09 07:58:27,701 [INFO]: The memory available for adding the vectors is 49.5GB(total available - used by the index)
2025-03-09 07:58:27,701 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/11 [00:00<?, ?it/s]  9%|▉         | 1/11 [00:00<00:01,  6.78it/s] 27%|██▋       | 3/11 [00:00<00:00,  9.93it/s] 45%|████▌     | 5/11 [00:00<00:00, 10.56it/s] 64%|██████▎   | 7/11 [00:00<00:00, 10.97it/s] 82%|████████▏ | 9/11 [00:00<00:00, 11.12it/s]100%|██████████| 11/11 [00:02<00:00,  2.44it/s]100%|██████████| 11/11 [00:02<00:00,  3.86it/s]
2025-03-09 07:58:30,561 [INFO]: 	Computing best hyperparameters for index knn.index 03/09/2025, 07:58:30
2025-03-09 07:58:58,515 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 27.9538 secs
2025-03-09 07:58:58,516 [INFO]: The best hyperparameters are: efSearch=299
2025-03-09 07:58:58,516 [INFO]: 	Compute fast metrics 03/09/2025, 07:58:58
  0%|          | 0/4 [00:00<?, ?it/s] 25%|██▌       | 1/4 [00:00<00:00,  5.30it/s] 50%|█████     | 2/4 [00:00<00:00,  6.74it/s] 75%|███████▌  | 3/4 [00:00<00:00,  7.37it/s] 75%|███████▌  | 3/4 [00:00<00:00,  5.60it/s]
2025-03-09 07:59:14,718 [INFO]: 	>>> Finished "Compute fast metrics" in 16.2021 secs
2025-03-09 07:59:14,720 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 47.0194 secs
2025-03-09 07:59:14,720 [INFO]: {
2025-03-09 07:59:14,720 [INFO]: 	index_key: HNSW15
2025-03-09 07:59:14,720 [INFO]: 	index_param: efSearch=299
2025-03-09 07:59:14,720 [INFO]: 	index_path: knn.index
2025-03-09 07:59:14,720 [INFO]: 	size in bytes: 539274670
2025-03-09 07:59:14,720 [INFO]: 	avg_search_speed_ms: 10.79275695649262
2025-03-09 07:59:14,720 [INFO]: 	99p_search_speed_ms: 15.288361837156117
2025-03-09 07:59:14,720 [INFO]: 	reconstruction error %: 0.0
2025-03-09 07:59:14,720 [INFO]: 	nb vectors: 2741
2025-03-09 07:59:14,720 [INFO]: 	vectors dimension: 49152
2025-03-09 07:59:14,720 [INFO]: 	compression ratio: 0.9993099212317909
2025-03-09 07:59:14,720 [INFO]: }
2025-03-09 07:59:14,720 [INFO]: 	>>> Finished "Creating the index" in 47.0211 secs
2025-03-09 07:59:14,720 [INFO]: >>> Finished "Launching the whole pipeline" in 47.0469 secs
2025-03-09 07:59:15: [retrieval_preprocessing] calculating distances ...
2025-03-09 07:59:16: [retrieval_preprocessing] finished and saved retrieval indices for episode 50782 [episode count 16/20]
[retrieval_preprocessing] for episode 1122 [episode count 17/20], we have num_retrieval=np.int64(2669) num_query=np.int64(213)
2025-03-09 07:59:16,976 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-09 07:59:17,418 [INFO]: Launching the whole pipeline 03/09/2025, 07:59:17
2025-03-09 07:59:17,418 [INFO]: Reading total number of vectors and dimension 03/09/2025, 07:59:17
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1494.23it/s]
2025-03-09 07:59:17,444 [INFO]: There are 2669 embeddings of dim 49152
2025-03-09 07:59:17,445 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0261 secs
2025-03-09 07:59:17,445 [INFO]: 	Compute estimated construction time of the index 03/09/2025, 07:59:17
2025-03-09 07:59:17,445 [INFO]: 		-> Train: 16.7 minutes
2025-03-09 07:59:17,445 [INFO]: 		-> Add: 1.5 seconds
2025-03-09 07:59:17,445 [INFO]: 		Total: 16.7 minutes
2025-03-09 07:59:17,445 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0001 secs
2025-03-09 07:59:17,445 [INFO]: 	Checking that your have enough memory available to create the index 03/09/2025, 07:59:17
2025-03-09 07:59:17,445 [INFO]: 550.8MB of memory will be needed to build the index (more might be used if you have more)
2025-03-09 07:59:17,445 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0002 secs
2025-03-09 07:59:17,445 [INFO]: 	Selecting most promising index types given data characteristics 03/09/2025, 07:59:17
2025-03-09 07:59:17,445 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-09 07:59:17,445 [INFO]: 	Creating the index 03/09/2025, 07:59:17
2025-03-09 07:59:17,445 [INFO]: 		-> Instanciate the index HNSW15 03/09/2025, 07:59:17
2025-03-09 07:59:17,446 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0009 secs
2025-03-09 07:59:17,446 [INFO]: 		-> Adding the vectors to the index 03/09/2025, 07:59:17
2025-03-09 07:59:17,446 [INFO]: The memory available for adding the vectors is 49.5GB(total available - used by the index)
2025-03-09 07:59:17,446 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/11 [00:00<?, ?it/s]  9%|▉         | 1/11 [00:00<00:02,  4.46it/s] 18%|█▊        | 2/11 [00:00<00:01,  6.06it/s] 27%|██▋       | 3/11 [00:00<00:01,  7.02it/s] 36%|███▋      | 4/11 [00:00<00:00,  7.60it/s] 45%|████▌     | 5/11 [00:00<00:00,  8.05it/s] 55%|█████▍    | 6/11 [00:00<00:00,  8.25it/s] 64%|██████▎   | 7/11 [00:00<00:00,  8.39it/s] 73%|███████▎  | 8/11 [00:01<00:00,  8.48it/s] 82%|████████▏ | 9/11 [00:01<00:00,  8.57it/s] 91%|█████████ | 10/11 [00:01<00:00,  8.62it/s]100%|██████████| 11/11 [00:03<00:00,  1.44it/s]100%|██████████| 11/11 [00:03<00:00,  3.36it/s]
2025-03-09 07:59:20,723 [INFO]: 	Computing best hyperparameters for index knn.index 03/09/2025, 07:59:20
2025-03-09 07:59:50,421 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 29.6977 secs
2025-03-09 07:59:50,421 [INFO]: The best hyperparameters are: efSearch=349
2025-03-09 07:59:50,421 [INFO]: 	Compute fast metrics 03/09/2025, 07:59:50
  0%|          | 0/4 [00:00<?, ?it/s] 25%|██▌       | 1/4 [00:00<00:00,  6.25it/s] 75%|███████▌  | 3/4 [00:00<00:00,  9.77it/s] 75%|███████▌  | 3/4 [00:00<00:00,  7.45it/s]
2025-03-09 08:00:05,369 [INFO]: 	>>> Finished "Compute fast metrics" in 14.9484 secs
2025-03-09 08:00:05,371 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 47.9251 secs
2025-03-09 08:00:05,371 [INFO]: {
2025-03-09 08:00:05,371 [INFO]: 	index_key: HNSW15
2025-03-09 08:00:05,371 [INFO]: 	index_param: efSearch=349
2025-03-09 08:00:05,371 [INFO]: 	index_path: knn.index
2025-03-09 08:00:05,371 [INFO]: 	size in bytes: 525109270
2025-03-09 08:00:05,371 [INFO]: 	avg_search_speed_ms: 12.16521214324428
2025-03-09 08:00:05,371 [INFO]: 	99p_search_speed_ms: 20.245848682243377
2025-03-09 08:00:05,372 [INFO]: 	reconstruction error %: 0.0
2025-03-09 08:00:05,372 [INFO]: 	nb vectors: 2669
2025-03-09 08:00:05,372 [INFO]: 	vectors dimension: 49152
2025-03-09 08:00:05,372 [INFO]: 	compression ratio: 0.9993096332121503
2025-03-09 08:00:05,372 [INFO]: }
2025-03-09 08:00:05,372 [INFO]: 	>>> Finished "Creating the index" in 47.9264 secs
2025-03-09 08:00:05,372 [INFO]: >>> Finished "Launching the whole pipeline" in 47.9531 secs
2025-03-09 08:00:08: [retrieval_preprocessing] calculating distances ...
2025-03-09 08:00:09: [retrieval_preprocessing] finished and saved retrieval indices for episode 1122 [episode count 17/20]
[retrieval_preprocessing] for episode 22626 [episode count 18/20], we have num_retrieval=np.int64(2660) num_query=np.int64(222)
2025-03-09 08:00:10,027 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-09 08:00:10,358 [INFO]: Launching the whole pipeline 03/09/2025, 08:00:10
2025-03-09 08:00:10,358 [INFO]: Reading total number of vectors and dimension 03/09/2025, 08:00:10
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 2361.66it/s]
2025-03-09 08:00:10,381 [INFO]: There are 2660 embeddings of dim 49152
2025-03-09 08:00:10,381 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0232 secs
2025-03-09 08:00:10,381 [INFO]: 	Compute estimated construction time of the index 03/09/2025, 08:00:10
2025-03-09 08:00:10,381 [INFO]: 		-> Train: 16.7 minutes
2025-03-09 08:00:10,381 [INFO]: 		-> Add: 1.5 seconds
2025-03-09 08:00:10,381 [INFO]: 		Total: 16.7 minutes
2025-03-09 08:00:10,381 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0001 secs
2025-03-09 08:00:10,381 [INFO]: 	Checking that your have enough memory available to create the index 03/09/2025, 08:00:10
2025-03-09 08:00:10,381 [INFO]: 549.0MB of memory will be needed to build the index (more might be used if you have more)
2025-03-09 08:00:10,381 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0001 secs
2025-03-09 08:00:10,381 [INFO]: 	Selecting most promising index types given data characteristics 03/09/2025, 08:00:10
2025-03-09 08:00:10,381 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-09 08:00:10,381 [INFO]: 	Creating the index 03/09/2025, 08:00:10
2025-03-09 08:00:10,381 [INFO]: 		-> Instanciate the index HNSW15 03/09/2025, 08:00:10
2025-03-09 08:00:10,382 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0009 secs
2025-03-09 08:00:10,382 [INFO]: 		-> Adding the vectors to the index 03/09/2025, 08:00:10
2025-03-09 08:00:10,382 [INFO]: The memory available for adding the vectors is 49.5GB(total available - used by the index)
2025-03-09 08:00:10,382 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/11 [00:00<?, ?it/s]  9%|▉         | 1/11 [00:00<00:01,  5.60it/s] 18%|█▊        | 2/11 [00:00<00:01,  7.05it/s] 27%|██▋       | 3/11 [00:00<00:01,  7.78it/s] 36%|███▋      | 4/11 [00:00<00:00,  8.30it/s] 45%|████▌     | 5/11 [00:00<00:00,  8.54it/s] 55%|█████▍    | 6/11 [00:00<00:00,  8.60it/s] 64%|██████▎   | 7/11 [00:00<00:00,  8.65it/s] 73%|███████▎  | 8/11 [00:00<00:00,  8.70it/s] 82%|████████▏ | 9/11 [00:01<00:00,  8.82it/s] 91%|█████████ | 10/11 [00:01<00:00,  8.77it/s]100%|██████████| 11/11 [00:02<00:00,  1.65it/s]100%|██████████| 11/11 [00:02<00:00,  3.77it/s]
2025-03-09 08:00:13,299 [INFO]: 	Computing best hyperparameters for index knn.index 03/09/2025, 08:00:13
2025-03-09 08:00:44,292 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 30.9922 secs
2025-03-09 08:00:44,292 [INFO]: The best hyperparameters are: efSearch=263
2025-03-09 08:00:44,292 [INFO]: 	Compute fast metrics 03/09/2025, 08:00:44
  0%|          | 0/4 [00:00<?, ?it/s] 25%|██▌       | 1/4 [00:00<00:00,  6.34it/s] 75%|███████▌  | 3/4 [00:00<00:00,  8.82it/s] 75%|███████▌  | 3/4 [00:00<00:00,  6.53it/s]
2025-03-09 08:00:59,877 [INFO]: 	>>> Finished "Compute fast metrics" in 15.5848 secs
2025-03-09 08:00:59,879 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 49.4966 secs
2025-03-09 08:00:59,879 [INFO]: {
2025-03-09 08:00:59,879 [INFO]: 	index_key: HNSW15
2025-03-09 08:00:59,879 [INFO]: 	index_param: efSearch=263
2025-03-09 08:00:59,879 [INFO]: 	index_path: knn.index
2025-03-09 08:00:59,879 [INFO]: 	size in bytes: 523338610
2025-03-09 08:00:59,879 [INFO]: 	avg_search_speed_ms: 10.089769879803363
2025-03-09 08:00:59,879 [INFO]: 	99p_search_speed_ms: 17.180759599432353
2025-03-09 08:00:59,879 [INFO]: 	reconstruction error %: 0.0
2025-03-09 08:00:59,879 [INFO]: 	nb vectors: 2660
2025-03-09 08:00:59,879 [INFO]: 	vectors dimension: 49152
2025-03-09 08:00:59,879 [INFO]: 	compression ratio: 0.999309567471049
2025-03-09 08:00:59,879 [INFO]: }
2025-03-09 08:00:59,879 [INFO]: 	>>> Finished "Creating the index" in 49.4979 secs
2025-03-09 08:00:59,879 [INFO]: >>> Finished "Launching the whole pipeline" in 49.5215 secs
2025-03-09 08:01:01: [retrieval_preprocessing] calculating distances ...
2025-03-09 08:01:02: [retrieval_preprocessing] finished and saved retrieval indices for episode 22626 [episode count 18/20]
[retrieval_preprocessing] for episode 71280 [episode count 19/20], we have num_retrieval=np.int64(2776) num_query=np.int64(106)
2025-03-09 08:01:02,469 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-09 08:01:02,869 [INFO]: Launching the whole pipeline 03/09/2025, 08:01:02
2025-03-09 08:01:02,869 [INFO]: Reading total number of vectors and dimension 03/09/2025, 08:01:02
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 2011.66it/s]
2025-03-09 08:01:02,895 [INFO]: There are 2776 embeddings of dim 49152
2025-03-09 08:01:02,895 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0258 secs
2025-03-09 08:01:02,895 [INFO]: 	Compute estimated construction time of the index 03/09/2025, 08:01:02
2025-03-09 08:01:02,895 [INFO]: 		-> Train: 16.7 minutes
2025-03-09 08:01:02,895 [INFO]: 		-> Add: 1.5 seconds
2025-03-09 08:01:02,895 [INFO]: 		Total: 16.7 minutes
2025-03-09 08:01:02,895 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0001 secs
2025-03-09 08:01:02,895 [INFO]: 	Checking that your have enough memory available to create the index 03/09/2025, 08:01:02
2025-03-09 08:01:02,895 [INFO]: 572.9MB of memory will be needed to build the index (more might be used if you have more)
2025-03-09 08:01:02,895 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0001 secs
2025-03-09 08:01:02,895 [INFO]: 	Selecting most promising index types given data characteristics 03/09/2025, 08:01:02
2025-03-09 08:01:02,895 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-09 08:01:02,895 [INFO]: 	Creating the index 03/09/2025, 08:01:02
2025-03-09 08:01:02,896 [INFO]: 		-> Instanciate the index HNSW15 03/09/2025, 08:01:02
2025-03-09 08:01:02,896 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0009 secs
2025-03-09 08:01:02,897 [INFO]: 		-> Adding the vectors to the index 03/09/2025, 08:01:02
2025-03-09 08:01:02,897 [INFO]: The memory available for adding the vectors is 49.5GB(total available - used by the index)
2025-03-09 08:01:02,897 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/11 [00:00<?, ?it/s]  9%|▉         | 1/11 [00:00<00:01,  5.51it/s] 27%|██▋       | 3/11 [00:00<00:00,  8.87it/s] 45%|████▌     | 5/11 [00:00<00:00, 10.36it/s] 64%|██████▎   | 7/11 [00:00<00:00, 11.17it/s] 82%|████████▏ | 9/11 [00:00<00:00, 11.51it/s]100%|██████████| 11/11 [00:02<00:00,  2.50it/s]100%|██████████| 11/11 [00:02<00:00,  3.91it/s]
2025-03-09 08:01:05,718 [INFO]: 	Computing best hyperparameters for index knn.index 03/09/2025, 08:01:05
2025-03-09 08:01:37,672 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 31.9544 secs
2025-03-09 08:01:37,673 [INFO]: The best hyperparameters are: efSearch=296
2025-03-09 08:01:37,673 [INFO]: 	Compute fast metrics 03/09/2025, 08:01:37
  0%|          | 0/4 [00:00<?, ?it/s] 25%|██▌       | 1/4 [00:00<00:00,  4.92it/s] 50%|█████     | 2/4 [00:00<00:00,  6.60it/s] 75%|███████▌  | 3/4 [00:00<00:00,  7.42it/s] 75%|███████▌  | 3/4 [00:00<00:00,  5.59it/s]
2025-03-09 08:01:51,643 [INFO]: 	>>> Finished "Compute fast metrics" in 13.9697 secs
2025-03-09 08:01:51,644 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 48.7478 secs
2025-03-09 08:01:51,645 [INFO]: {
2025-03-09 08:01:51,645 [INFO]: 	index_key: HNSW15
2025-03-09 08:01:51,645 [INFO]: 	index_param: efSearch=296
2025-03-09 08:01:51,645 [INFO]: 	index_path: knn.index
2025-03-09 08:01:51,645 [INFO]: 	size in bytes: 546160750
2025-03-09 08:01:51,645 [INFO]: 	avg_search_speed_ms: 11.343036700924964
2025-03-09 08:01:51,645 [INFO]: 	99p_search_speed_ms: 20.61336086830124
2025-03-09 08:01:51,645 [INFO]: 	reconstruction error %: 0.0
2025-03-09 08:01:51,645 [INFO]: 	nb vectors: 2776
2025-03-09 08:01:51,645 [INFO]: 	vectors dimension: 49152
2025-03-09 08:01:51,645 [INFO]: 	compression ratio: 0.9993098332313335
2025-03-09 08:01:51,645 [INFO]: }
2025-03-09 08:01:51,645 [INFO]: 	>>> Finished "Creating the index" in 48.7492 secs
2025-03-09 08:01:51,645 [INFO]: >>> Finished "Launching the whole pipeline" in 48.7757 secs
2025-03-09 08:01:52: [retrieval_preprocessing] calculating distances ...
2025-03-09 08:01:53: [retrieval_preprocessing] finished and saved retrieval indices for episode 71280 [episode count 19/20]
2025-03-09 08:01:53: [retrieval_preprocessing] finished for (6667529842, 'lid') [chosen_id count 3/10]
2025-03-09 08:01:57: [retrieval_preprocessing] concatenated all embeddings and indices for 20 episodes for (5507987860, 'marker') [chosen_id count 4/10]
2025-03-09 08:01:57: [retrieval_preprocessing] we have num_total=4184 embedding_dim=49152
[retrieval_preprocessing] for episode 86535 [episode count 0/20], we have num_retrieval=np.int64(3979) num_query=np.int64(205)
2025-03-09 08:01:58,909 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-09 08:01:59,754 [INFO]: Launching the whole pipeline 03/09/2025, 08:01:59
2025-03-09 08:01:59,755 [INFO]: Reading total number of vectors and dimension 03/09/2025, 08:01:59
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1815.72it/s]
2025-03-09 08:01:59,781 [INFO]: There are 3979 embeddings of dim 49152
2025-03-09 08:01:59,782 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0271 secs
2025-03-09 08:01:59,782 [INFO]: 	Compute estimated construction time of the index 03/09/2025, 08:01:59
2025-03-09 08:01:59,782 [INFO]: 		-> Train: 16.7 minutes
2025-03-09 08:01:59,782 [INFO]: 		-> Add: 2.2 seconds
2025-03-09 08:01:59,782 [INFO]: 		Total: 16.7 minutes
2025-03-09 08:01:59,782 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0001 secs
2025-03-09 08:01:59,782 [INFO]: 	Checking that your have enough memory available to create the index 03/09/2025, 08:01:59
2025-03-09 08:01:59,782 [INFO]: 821.2MB of memory will be needed to build the index (more might be used if you have more)
2025-03-09 08:01:59,782 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0002 secs
2025-03-09 08:01:59,782 [INFO]: 	Selecting most promising index types given data characteristics 03/09/2025, 08:01:59
2025-03-09 08:01:59,782 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-09 08:01:59,782 [INFO]: 	Creating the index 03/09/2025, 08:01:59
2025-03-09 08:01:59,783 [INFO]: 		-> Instanciate the index HNSW15 03/09/2025, 08:01:59
2025-03-09 08:01:59,784 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0011 secs
2025-03-09 08:01:59,784 [INFO]: 		-> Adding the vectors to the index 03/09/2025, 08:01:59
2025-03-09 08:01:59,784 [INFO]: The memory available for adding the vectors is 49.3GB(total available - used by the index)
2025-03-09 08:01:59,784 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/16 [00:00<?, ?it/s]  6%|▋         | 1/16 [00:00<00:03,  4.72it/s] 19%|█▉        | 3/16 [00:00<00:01,  9.57it/s] 31%|███▏      | 5/16 [00:00<00:01, 10.90it/s] 44%|████▍     | 7/16 [00:00<00:00, 11.02it/s] 56%|█████▋    | 9/16 [00:00<00:00, 11.73it/s] 69%|██████▉   | 11/16 [00:01<00:00, 10.71it/s] 81%|████████▏ | 13/16 [00:01<00:00, 10.55it/s] 94%|█████████▍| 15/16 [00:01<00:00, 10.16it/s]100%|██████████| 16/16 [00:04<00:00,  3.50it/s]
2025-03-09 08:02:04,360 [INFO]: 	Computing best hyperparameters for index knn.index 03/09/2025, 08:02:04
2025-03-09 08:02:44,311 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 39.9499 secs
2025-03-09 08:02:44,311 [INFO]: The best hyperparameters are: efSearch=205
2025-03-09 08:02:44,311 [INFO]: 	Compute fast metrics 03/09/2025, 08:02:44
  0%|          | 0/4 [00:00<?, ?it/s] 25%|██▌       | 1/4 [00:00<00:00,  5.18it/s] 50%|█████     | 2/4 [00:00<00:00,  6.85it/s] 75%|███████▌  | 3/4 [00:00<00:00,  7.75it/s] 75%|███████▌  | 3/4 [00:00<00:00,  5.75it/s]
2025-03-09 08:02:58,267 [INFO]: 	>>> Finished "Compute fast metrics" in 13.9558 secs
2025-03-09 08:02:58,269 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 58.4855 secs
2025-03-09 08:02:58,270 [INFO]: {
2025-03-09 08:02:58,270 [INFO]: 	index_key: HNSW15
2025-03-09 08:02:58,270 [INFO]: 	index_param: efSearch=205
2025-03-09 08:02:58,270 [INFO]: 	index_path: knn.index
2025-03-09 08:02:58,270 [INFO]: 	size in bytes: 782844550
2025-03-09 08:02:58,270 [INFO]: 	avg_search_speed_ms: 9.966848746259359
2025-03-09 08:02:58,270 [INFO]: 	99p_search_speed_ms: 17.663792092353116
2025-03-09 08:02:58,270 [INFO]: 	reconstruction error %: 0.0
2025-03-09 08:02:58,270 [INFO]: 	nb vectors: 3979
2025-03-09 08:02:58,270 [INFO]: 	vectors dimension: 49152
2025-03-09 08:02:58,270 [INFO]: 	compression ratio: 0.9993085242785429
2025-03-09 08:02:58,270 [INFO]: }
2025-03-09 08:02:58,270 [INFO]: 	>>> Finished "Creating the index" in 58.4872 secs
2025-03-09 08:02:58,270 [INFO]: >>> Finished "Launching the whole pipeline" in 58.5152 secs
2025-03-09 08:02:59: [retrieval_preprocessing] calculating distances ...
2025-03-09 08:02:59: [retrieval_preprocessing] finished and saved retrieval indices for episode 86535 [episode count 0/20]
[retrieval_preprocessing] for episode 55831 [episode count 1/20], we have num_retrieval=np.int64(3988) num_query=np.int64(196)
2025-03-09 08:03:01,061 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-09 08:03:01,612 [INFO]: Launching the whole pipeline 03/09/2025, 08:03:01
2025-03-09 08:03:01,613 [INFO]: Reading total number of vectors and dimension 03/09/2025, 08:03:01
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1779.51it/s]
2025-03-09 08:03:01,635 [INFO]: There are 3988 embeddings of dim 49152
2025-03-09 08:03:01,635 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0228 secs
2025-03-09 08:03:01,635 [INFO]: 	Compute estimated construction time of the index 03/09/2025, 08:03:01
2025-03-09 08:03:01,636 [INFO]: 		-> Train: 16.7 minutes
2025-03-09 08:03:01,636 [INFO]: 		-> Add: 2.2 seconds
2025-03-09 08:03:01,636 [INFO]: 		Total: 16.7 minutes
2025-03-09 08:03:01,636 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0001 secs
2025-03-09 08:03:01,636 [INFO]: 	Checking that your have enough memory available to create the index 03/09/2025, 08:03:01
2025-03-09 08:03:01,636 [INFO]: 823.0MB of memory will be needed to build the index (more might be used if you have more)
2025-03-09 08:03:01,636 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0001 secs
2025-03-09 08:03:01,636 [INFO]: 	Selecting most promising index types given data characteristics 03/09/2025, 08:03:01
2025-03-09 08:03:01,636 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-09 08:03:01,636 [INFO]: 	Creating the index 03/09/2025, 08:03:01
2025-03-09 08:03:01,636 [INFO]: 		-> Instanciate the index HNSW15 03/09/2025, 08:03:01
2025-03-09 08:03:01,637 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0009 secs
2025-03-09 08:03:01,637 [INFO]: 		-> Adding the vectors to the index 03/09/2025, 08:03:01
2025-03-09 08:03:01,637 [INFO]: The memory available for adding the vectors is 49.3GB(total available - used by the index)
2025-03-09 08:03:01,637 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/16 [00:00<?, ?it/s]  6%|▋         | 1/16 [00:00<00:02,  5.41it/s] 12%|█▎        | 2/16 [00:00<00:01,  7.20it/s] 19%|█▉        | 3/16 [00:00<00:01,  7.92it/s] 25%|██▌       | 4/16 [00:00<00:01,  8.47it/s] 31%|███▏      | 5/16 [00:00<00:01,  8.73it/s] 38%|███▊      | 6/16 [00:00<00:01,  8.83it/s] 44%|████▍     | 7/16 [00:00<00:01,  8.92it/s] 50%|█████     | 8/16 [00:00<00:00,  8.96it/s] 56%|█████▋    | 9/16 [00:01<00:00,  9.09it/s] 62%|██████▎   | 10/16 [00:01<00:00,  9.11it/s] 69%|██████▉   | 11/16 [00:01<00:00,  8.99it/s] 75%|███████▌  | 12/16 [00:01<00:00,  9.06it/s] 88%|████████▊ | 14/16 [00:01<00:00, 11.59it/s]100%|██████████| 16/16 [00:04<00:00,  1.69it/s]100%|██████████| 16/16 [00:04<00:00,  3.80it/s]
2025-03-09 08:03:05,857 [INFO]: 	Computing best hyperparameters for index knn.index 03/09/2025, 08:03:05
2025-03-09 08:03:48,005 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 42.1479 secs
2025-03-09 08:03:48,005 [INFO]: The best hyperparameters are: efSearch=219
2025-03-09 08:03:48,005 [INFO]: 	Compute fast metrics 03/09/2025, 08:03:48
  0%|          | 0/4 [00:00<?, ?it/s] 25%|██▌       | 1/4 [00:00<00:00,  5.05it/s] 50%|█████     | 2/4 [00:00<00:00,  6.03it/s] 75%|███████▌  | 3/4 [00:00<00:00,  7.05it/s] 75%|███████▌  | 3/4 [00:00<00:00,  5.31it/s]
2025-03-09 08:04:06,052 [INFO]: 	>>> Finished "Compute fast metrics" in 18.0468 secs
2025-03-09 08:04:06,055 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 64.4180 secs
2025-03-09 08:04:06,055 [INFO]: {
2025-03-09 08:04:06,055 [INFO]: 	index_key: HNSW15
2025-03-09 08:04:06,055 [INFO]: 	index_param: efSearch=219
2025-03-09 08:04:06,055 [INFO]: 	index_path: knn.index
2025-03-09 08:04:06,055 [INFO]: 	size in bytes: 784615210
2025-03-09 08:04:06,055 [INFO]: 	avg_search_speed_ms: 10.694921152158217
2025-03-09 08:04:06,055 [INFO]: 	99p_search_speed_ms: 18.11852587852627
2025-03-09 08:04:06,055 [INFO]: 	reconstruction error %: 0.0
2025-03-09 08:04:06,055 [INFO]: 	nb vectors: 3988
2025-03-09 08:04:06,055 [INFO]: 	vectors dimension: 49152
2025-03-09 08:04:06,055 [INFO]: 	compression ratio: 0.9993085706304368
2025-03-09 08:04:06,055 [INFO]: }
2025-03-09 08:04:06,055 [INFO]: 	>>> Finished "Creating the index" in 64.4193 secs
2025-03-09 08:04:06,055 [INFO]: >>> Finished "Launching the whole pipeline" in 64.4426 secs
2025-03-09 08:04:06: [retrieval_preprocessing] calculating distances ...
2025-03-09 08:04:07: [retrieval_preprocessing] finished and saved retrieval indices for episode 55831 [episode count 1/20]
[retrieval_preprocessing] for episode 12313 [episode count 2/20], we have num_retrieval=np.int64(4026) num_query=np.int64(158)
2025-03-09 08:04:08,868 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-09 08:04:09,907 [INFO]: Launching the whole pipeline 03/09/2025, 08:04:09
2025-03-09 08:04:09,907 [INFO]: Reading total number of vectors and dimension 03/09/2025, 08:04:09
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1428.09it/s]
2025-03-09 08:04:09,931 [INFO]: There are 4026 embeddings of dim 49152
2025-03-09 08:04:09,931 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0244 secs
2025-03-09 08:04:09,931 [INFO]: 	Compute estimated construction time of the index 03/09/2025, 08:04:09
2025-03-09 08:04:09,931 [INFO]: 		-> Train: 16.7 minutes
2025-03-09 08:04:09,931 [INFO]: 		-> Add: 2.2 seconds
2025-03-09 08:04:09,931 [INFO]: 		Total: 16.7 minutes
2025-03-09 08:04:09,931 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0001 secs
2025-03-09 08:04:09,932 [INFO]: 	Checking that your have enough memory available to create the index 03/09/2025, 08:04:09
2025-03-09 08:04:09,932 [INFO]: 830.9MB of memory will be needed to build the index (more might be used if you have more)
2025-03-09 08:04:09,932 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0001 secs
2025-03-09 08:04:09,932 [INFO]: 	Selecting most promising index types given data characteristics 03/09/2025, 08:04:09
2025-03-09 08:04:09,932 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-09 08:04:09,932 [INFO]: 	Creating the index 03/09/2025, 08:04:09
2025-03-09 08:04:09,932 [INFO]: 		-> Instanciate the index HNSW15 03/09/2025, 08:04:09
2025-03-09 08:04:09,933 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0008 secs
2025-03-09 08:04:09,933 [INFO]: 		-> Adding the vectors to the index 03/09/2025, 08:04:09
2025-03-09 08:04:09,933 [INFO]: The memory available for adding the vectors is 49.3GB(total available - used by the index)
2025-03-09 08:04:09,933 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/16 [00:00<?, ?it/s]  6%|▋         | 1/16 [00:00<00:02,  5.08it/s] 19%|█▉        | 3/16 [00:00<00:01,  8.56it/s] 31%|███▏      | 5/16 [00:00<00:01,  9.27it/s] 38%|███▊      | 6/16 [00:00<00:01,  9.32it/s] 50%|█████     | 8/16 [00:00<00:00,  9.78it/s] 62%|██████▎   | 10/16 [00:01<00:00, 10.34it/s] 75%|███████▌  | 12/16 [00:01<00:00, 10.71it/s] 88%|████████▊ | 14/16 [00:01<00:00, 10.97it/s]100%|██████████| 16/16 [00:04<00:00,  1.67it/s]100%|██████████| 16/16 [00:04<00:00,  3.39it/s]
2025-03-09 08:04:14,658 [INFO]: 	Computing best hyperparameters for index knn.index 03/09/2025, 08:04:14
2025-03-09 08:04:57,130 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 42.4717 secs
2025-03-09 08:04:57,130 [INFO]: The best hyperparameters are: efSearch=208
2025-03-09 08:04:57,130 [INFO]: 	Compute fast metrics 03/09/2025, 08:04:57
  0%|          | 0/4 [00:00<?, ?it/s] 25%|██▌       | 1/4 [00:00<00:00,  4.97it/s] 50%|█████     | 2/4 [00:00<00:00,  6.87it/s] 75%|███████▌  | 3/4 [00:00<00:00,  7.98it/s] 75%|███████▌  | 3/4 [00:00<00:00,  5.93it/s]
2025-03-09 08:05:16,316 [INFO]: 	>>> Finished "Compute fast metrics" in 19.1861 secs
2025-03-09 08:05:16,319 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 66.3863 secs
2025-03-09 08:05:16,319 [INFO]: {
2025-03-09 08:05:16,319 [INFO]: 	index_key: HNSW15
2025-03-09 08:05:16,319 [INFO]: 	index_param: efSearch=208
2025-03-09 08:05:16,319 [INFO]: 	index_path: knn.index
2025-03-09 08:05:16,319 [INFO]: 	size in bytes: 792091510
2025-03-09 08:05:16,319 [INFO]: 	avg_search_speed_ms: 10.007062587314644
2025-03-09 08:05:16,319 [INFO]: 	99p_search_speed_ms: 16.552430097945035
2025-03-09 08:05:16,319 [INFO]: 	reconstruction error %: 0.0
2025-03-09 08:05:16,319 [INFO]: 	nb vectors: 4026
2025-03-09 08:05:16,319 [INFO]: 	vectors dimension: 49152
2025-03-09 08:05:16,319 [INFO]: 	compression ratio: 0.9993085369643717
2025-03-09 08:05:16,319 [INFO]: }
2025-03-09 08:05:16,319 [INFO]: 	>>> Finished "Creating the index" in 66.3877 secs
2025-03-09 08:05:16,320 [INFO]: >>> Finished "Launching the whole pipeline" in 66.4126 secs
2025-03-09 08:05:17: [retrieval_preprocessing] calculating distances ...
2025-03-09 08:05:17: [retrieval_preprocessing] finished and saved retrieval indices for episode 12313 [episode count 2/20]
[retrieval_preprocessing] for episode 63513 [episode count 3/20], we have num_retrieval=np.int64(3979) num_query=np.int64(205)
2025-03-09 08:05:19,653 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-09 08:05:20,408 [INFO]: Launching the whole pipeline 03/09/2025, 08:05:20
2025-03-09 08:05:20,408 [INFO]: Reading total number of vectors and dimension 03/09/2025, 08:05:20
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1745.44it/s]
2025-03-09 08:05:20,434 [INFO]: There are 3979 embeddings of dim 49152
2025-03-09 08:05:20,434 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0261 secs
2025-03-09 08:05:20,434 [INFO]: 	Compute estimated construction time of the index 03/09/2025, 08:05:20
2025-03-09 08:05:20,434 [INFO]: 		-> Train: 16.7 minutes
2025-03-09 08:05:20,434 [INFO]: 		-> Add: 2.2 seconds
2025-03-09 08:05:20,434 [INFO]: 		Total: 16.7 minutes
2025-03-09 08:05:20,434 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0001 secs
2025-03-09 08:05:20,434 [INFO]: 	Checking that your have enough memory available to create the index 03/09/2025, 08:05:20
2025-03-09 08:05:20,434 [INFO]: 821.2MB of memory will be needed to build the index (more might be used if you have more)
2025-03-09 08:05:20,434 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0001 secs
2025-03-09 08:05:20,435 [INFO]: 	Selecting most promising index types given data characteristics 03/09/2025, 08:05:20
2025-03-09 08:05:20,435 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-09 08:05:20,435 [INFO]: 	Creating the index 03/09/2025, 08:05:20
2025-03-09 08:05:20,435 [INFO]: 		-> Instanciate the index HNSW15 03/09/2025, 08:05:20
2025-03-09 08:05:20,436 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0012 secs
2025-03-09 08:05:20,436 [INFO]: 		-> Adding the vectors to the index 03/09/2025, 08:05:20
2025-03-09 08:05:20,436 [INFO]: The memory available for adding the vectors is 49.3GB(total available - used by the index)
2025-03-09 08:05:20,436 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/16 [00:00<?, ?it/s]  6%|▋         | 1/16 [00:00<00:02,  6.81it/s] 12%|█▎        | 2/16 [00:00<00:01,  8.10it/s] 19%|█▉        | 3/16 [00:00<00:01,  8.56it/s] 25%|██▌       | 4/16 [00:00<00:01,  8.83it/s] 31%|███▏      | 5/16 [00:00<00:01,  9.04it/s] 38%|███▊      | 6/16 [00:00<00:01,  9.13it/s] 44%|████▍     | 7/16 [00:00<00:00,  9.22it/s] 50%|█████     | 8/16 [00:00<00:00,  9.44it/s] 56%|█████▋    | 9/16 [00:00<00:00,  9.49it/s] 62%|██████▎   | 10/16 [00:01<00:00,  9.49it/s] 69%|██████▉   | 11/16 [00:01<00:00,  9.53it/s] 75%|███████▌  | 12/16 [00:01<00:00,  9.59it/s]100%|██████████| 16/16 [00:04<00:00,  2.03it/s]100%|██████████| 16/16 [00:04<00:00,  3.83it/s]
2025-03-09 08:05:24,615 [INFO]: 	Computing best hyperparameters for index knn.index 03/09/2025, 08:05:24
2025-03-09 08:06:03,236 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 38.6213 secs
2025-03-09 08:06:03,237 [INFO]: The best hyperparameters are: efSearch=178
2025-03-09 08:06:03,237 [INFO]: 	Compute fast metrics 03/09/2025, 08:06:03
  0%|          | 0/4 [00:00<?, ?it/s] 25%|██▌       | 1/4 [00:00<00:00,  5.30it/s] 50%|█████     | 2/4 [00:00<00:00,  6.93it/s] 75%|███████▌  | 3/4 [00:00<00:00,  7.54it/s] 75%|███████▌  | 3/4 [00:00<00:00,  5.62it/s]
2025-03-09 08:06:23,047 [INFO]: 	>>> Finished "Compute fast metrics" in 19.8102 secs
2025-03-09 08:06:23,050 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 62.6136 secs
2025-03-09 08:06:23,050 [INFO]: {
2025-03-09 08:06:23,050 [INFO]: 	index_key: HNSW15
2025-03-09 08:06:23,050 [INFO]: 	index_param: efSearch=178
2025-03-09 08:06:23,050 [INFO]: 	index_path: knn.index
2025-03-09 08:06:23,050 [INFO]: 	size in bytes: 782844550
2025-03-09 08:06:23,050 [INFO]: 	avg_search_speed_ms: 8.368508610679577
2025-03-09 08:06:23,050 [INFO]: 	99p_search_speed_ms: 15.05570246838032
2025-03-09 08:06:23,050 [INFO]: 	reconstruction error %: 0.0
2025-03-09 08:06:23,050 [INFO]: 	nb vectors: 3979
2025-03-09 08:06:23,050 [INFO]: 	vectors dimension: 49152
2025-03-09 08:06:23,050 [INFO]: 	compression ratio: 0.9993085242785429
2025-03-09 08:06:23,050 [INFO]: }
2025-03-09 08:06:23,050 [INFO]: 	>>> Finished "Creating the index" in 62.6154 secs
2025-03-09 08:06:23,050 [INFO]: >>> Finished "Launching the whole pipeline" in 62.6421 secs
2025-03-09 08:06:23: [retrieval_preprocessing] calculating distances ...
2025-03-09 08:06:24: [retrieval_preprocessing] finished and saved retrieval indices for episode 63513 [episode count 3/20]
[retrieval_preprocessing] for episode 80422 [episode count 4/20], we have num_retrieval=np.int64(4011) num_query=np.int64(173)
2025-03-09 08:06:25,788 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-09 08:06:26,867 [INFO]: Launching the whole pipeline 03/09/2025, 08:06:26
2025-03-09 08:06:26,867 [INFO]: Reading total number of vectors and dimension 03/09/2025, 08:06:26
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1500.11it/s]
2025-03-09 08:06:26,894 [INFO]: There are 4011 embeddings of dim 49152
2025-03-09 08:06:26,894 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0270 secs
2025-03-09 08:06:26,894 [INFO]: 	Compute estimated construction time of the index 03/09/2025, 08:06:26
2025-03-09 08:06:26,894 [INFO]: 		-> Train: 16.7 minutes
2025-03-09 08:06:26,894 [INFO]: 		-> Add: 2.2 seconds
2025-03-09 08:06:26,894 [INFO]: 		Total: 16.7 minutes
2025-03-09 08:06:26,894 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0001 secs
2025-03-09 08:06:26,894 [INFO]: 	Checking that your have enough memory available to create the index 03/09/2025, 08:06:26
2025-03-09 08:06:26,894 [INFO]: 827.8MB of memory will be needed to build the index (more might be used if you have more)
2025-03-09 08:06:26,894 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0001 secs
2025-03-09 08:06:26,894 [INFO]: 	Selecting most promising index types given data characteristics 03/09/2025, 08:06:26
2025-03-09 08:06:26,894 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-09 08:06:26,894 [INFO]: 	Creating the index 03/09/2025, 08:06:26
2025-03-09 08:06:26,894 [INFO]: 		-> Instanciate the index HNSW15 03/09/2025, 08:06:26
2025-03-09 08:06:26,896 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0011 secs
2025-03-09 08:06:26,896 [INFO]: 		-> Adding the vectors to the index 03/09/2025, 08:06:26
2025-03-09 08:06:26,896 [INFO]: The memory available for adding the vectors is 49.3GB(total available - used by the index)
2025-03-09 08:06:26,896 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/16 [00:00<?, ?it/s]  6%|▋         | 1/16 [00:00<00:02,  6.50it/s] 19%|█▉        | 3/16 [00:00<00:01, 10.49it/s] 31%|███▏      | 5/16 [00:00<00:00, 11.75it/s] 44%|████▍     | 7/16 [00:00<00:00, 12.32it/s] 56%|█████▋    | 9/16 [00:00<00:00, 12.70it/s] 69%|██████▉   | 11/16 [00:00<00:00, 12.84it/s] 81%|████████▏ | 13/16 [00:01<00:00, 12.88it/s] 94%|█████████▍| 15/16 [00:01<00:00, 12.95it/s]100%|██████████| 16/16 [00:04<00:00,  3.65it/s]
2025-03-09 08:06:31,290 [INFO]: 	Computing best hyperparameters for index knn.index 03/09/2025, 08:06:31
2025-03-09 08:07:08,442 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 37.1515 secs
2025-03-09 08:07:08,442 [INFO]: The best hyperparameters are: efSearch=196
2025-03-09 08:07:08,442 [INFO]: 	Compute fast metrics 03/09/2025, 08:07:08
  0%|          | 0/4 [00:00<?, ?it/s] 25%|██▌       | 1/4 [00:00<00:00,  5.47it/s] 50%|█████     | 2/4 [00:00<00:00,  6.99it/s] 75%|███████▌  | 3/4 [00:00<00:00,  7.77it/s] 75%|███████▌  | 3/4 [00:00<00:00,  5.85it/s]
2025-03-09 08:07:25,006 [INFO]: 	>>> Finished "Compute fast metrics" in 16.5635 secs
2025-03-09 08:07:25,008 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 58.1126 secs
2025-03-09 08:07:25,009 [INFO]: {
2025-03-09 08:07:25,009 [INFO]: 	index_key: HNSW15
2025-03-09 08:07:25,009 [INFO]: 	index_param: efSearch=196
2025-03-09 08:07:25,009 [INFO]: 	index_path: knn.index
2025-03-09 08:07:25,009 [INFO]: 	size in bytes: 789140410
2025-03-09 08:07:25,009 [INFO]: 	avg_search_speed_ms: 8.882028266182086
2025-03-09 08:07:25,009 [INFO]: 	99p_search_speed_ms: 14.066009025555104
2025-03-09 08:07:25,009 [INFO]: 	reconstruction error %: 0.0
2025-03-09 08:07:25,009 [INFO]: 	nb vectors: 4011
2025-03-09 08:07:25,009 [INFO]: 	vectors dimension: 49152
2025-03-09 08:07:25,009 [INFO]: 	compression ratio: 0.9993084602016515
2025-03-09 08:07:25,009 [INFO]: }
2025-03-09 08:07:25,009 [INFO]: 	>>> Finished "Creating the index" in 58.1144 secs
2025-03-09 08:07:25,009 [INFO]: >>> Finished "Launching the whole pipeline" in 58.1420 secs
2025-03-09 08:07:25: [retrieval_preprocessing] calculating distances ...
2025-03-09 08:07:26: [retrieval_preprocessing] finished and saved retrieval indices for episode 80422 [episode count 4/20]
[retrieval_preprocessing] for episode 92714 [episode count 5/20], we have num_retrieval=np.int64(4050) num_query=np.int64(134)
2025-03-09 08:07:27,569 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-09 08:07:28,159 [INFO]: Launching the whole pipeline 03/09/2025, 08:07:28
2025-03-09 08:07:28,159 [INFO]: Reading total number of vectors and dimension 03/09/2025, 08:07:28
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 2163.13it/s]
2025-03-09 08:07:28,186 [INFO]: There are 4050 embeddings of dim 49152
2025-03-09 08:07:28,186 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0268 secs
2025-03-09 08:07:28,186 [INFO]: 	Compute estimated construction time of the index 03/09/2025, 08:07:28
2025-03-09 08:07:28,186 [INFO]: 		-> Train: 16.7 minutes
2025-03-09 08:07:28,186 [INFO]: 		-> Add: 2.2 seconds
2025-03-09 08:07:28,186 [INFO]: 		Total: 16.7 minutes
2025-03-09 08:07:28,186 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0001 secs
2025-03-09 08:07:28,186 [INFO]: 	Checking that your have enough memory available to create the index 03/09/2025, 08:07:28
2025-03-09 08:07:28,186 [INFO]: 835.8MB of memory will be needed to build the index (more might be used if you have more)
2025-03-09 08:07:28,186 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0001 secs
2025-03-09 08:07:28,186 [INFO]: 	Selecting most promising index types given data characteristics 03/09/2025, 08:07:28
2025-03-09 08:07:28,186 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-09 08:07:28,186 [INFO]: 	Creating the index 03/09/2025, 08:07:28
2025-03-09 08:07:28,187 [INFO]: 		-> Instanciate the index HNSW15 03/09/2025, 08:07:28
2025-03-09 08:07:28,187 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0009 secs
2025-03-09 08:07:28,188 [INFO]: 		-> Adding the vectors to the index 03/09/2025, 08:07:28
2025-03-09 08:07:28,188 [INFO]: The memory available for adding the vectors is 49.3GB(total available - used by the index)
2025-03-09 08:07:28,188 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/16 [00:00<?, ?it/s]  6%|▋         | 1/16 [00:00<00:02,  6.26it/s] 19%|█▉        | 3/16 [00:00<00:01, 10.06it/s] 31%|███▏      | 5/16 [00:00<00:00, 11.47it/s] 44%|████▍     | 7/16 [00:00<00:00, 11.93it/s] 56%|█████▋    | 9/16 [00:00<00:00, 12.09it/s] 69%|██████▉   | 11/16 [00:00<00:00, 12.33it/s] 81%|████████▏ | 13/16 [00:01<00:00, 12.29it/s] 94%|█████████▍| 15/16 [00:01<00:00, 12.44it/s]100%|██████████| 16/16 [00:04<00:00,  3.64it/s]
2025-03-09 08:07:32,593 [INFO]: 	Computing best hyperparameters for index knn.index 03/09/2025, 08:07:32
2025-03-09 08:08:09,881 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 37.2877 secs
2025-03-09 08:08:09,881 [INFO]: The best hyperparameters are: efSearch=215
2025-03-09 08:08:09,881 [INFO]: 	Compute fast metrics 03/09/2025, 08:08:09
  0%|          | 0/4 [00:00<?, ?it/s] 25%|██▌       | 1/4 [00:00<00:00,  5.27it/s] 75%|███████▌  | 3/4 [00:00<00:00,  9.85it/s] 75%|███████▌  | 3/4 [00:00<00:00,  6.91it/s]
2025-03-09 08:08:26,771 [INFO]: 	>>> Finished "Compute fast metrics" in 16.8898 secs
2025-03-09 08:08:26,775 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 58.5869 secs
2025-03-09 08:08:26,775 [INFO]: {
2025-03-09 08:08:26,775 [INFO]: 	index_key: HNSW15
2025-03-09 08:08:26,775 [INFO]: 	index_param: efSearch=215
2025-03-09 08:08:26,775 [INFO]: 	index_path: knn.index
2025-03-09 08:08:26,775 [INFO]: 	size in bytes: 796813330
2025-03-09 08:08:26,775 [INFO]: 	avg_search_speed_ms: 10.64624945872143
2025-03-09 08:08:26,775 [INFO]: 	99p_search_speed_ms: 17.939247912727296
2025-03-09 08:08:26,775 [INFO]: 	reconstruction error %: 0.0
2025-03-09 08:08:26,775 [INFO]: 	nb vectors: 4050
2025-03-09 08:08:26,775 [INFO]: 	vectors dimension: 49152
2025-03-09 08:08:26,775 [INFO]: 	compression ratio: 0.9993085833541464
2025-03-09 08:08:26,775 [INFO]: }
2025-03-09 08:08:26,775 [INFO]: 	>>> Finished "Creating the index" in 58.5884 secs
2025-03-09 08:08:26,775 [INFO]: >>> Finished "Launching the whole pipeline" in 58.6159 secs
2025-03-09 08:08:27: [retrieval_preprocessing] calculating distances ...
2025-03-09 08:08:28: [retrieval_preprocessing] finished and saved retrieval indices for episode 92714 [episode count 5/20]
[retrieval_preprocessing] for episode 81453 [episode count 6/20], we have num_retrieval=np.int64(3952) num_query=np.int64(232)
2025-03-09 08:08:29,293 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-09 08:08:29,847 [INFO]: Launching the whole pipeline 03/09/2025, 08:08:29
2025-03-09 08:08:29,847 [INFO]: Reading total number of vectors and dimension 03/09/2025, 08:08:29
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1535.81it/s]
2025-03-09 08:08:29,872 [INFO]: There are 3952 embeddings of dim 49152
2025-03-09 08:08:29,872 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0250 secs
2025-03-09 08:08:29,872 [INFO]: 	Compute estimated construction time of the index 03/09/2025, 08:08:29
2025-03-09 08:08:29,872 [INFO]: 		-> Train: 16.7 minutes
2025-03-09 08:08:29,872 [INFO]: 		-> Add: 2.2 seconds
2025-03-09 08:08:29,872 [INFO]: 		Total: 16.7 minutes
2025-03-09 08:08:29,872 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0001 secs
2025-03-09 08:08:29,872 [INFO]: 	Checking that your have enough memory available to create the index 03/09/2025, 08:08:29
2025-03-09 08:08:29,872 [INFO]: 815.6MB of memory will be needed to build the index (more might be used if you have more)
2025-03-09 08:08:29,872 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0001 secs
2025-03-09 08:08:29,872 [INFO]: 	Selecting most promising index types given data characteristics 03/09/2025, 08:08:29
2025-03-09 08:08:29,872 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-09 08:08:29,872 [INFO]: 	Creating the index 03/09/2025, 08:08:29
2025-03-09 08:08:29,872 [INFO]: 		-> Instanciate the index HNSW15 03/09/2025, 08:08:29
2025-03-09 08:08:29,873 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0009 secs
2025-03-09 08:08:29,873 [INFO]: 		-> Adding the vectors to the index 03/09/2025, 08:08:29
2025-03-09 08:08:29,873 [INFO]: The memory available for adding the vectors is 49.3GB(total available - used by the index)
2025-03-09 08:08:29,874 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/16 [00:00<?, ?it/s]  6%|▋         | 1/16 [00:00<00:02,  6.31it/s] 19%|█▉        | 3/16 [00:00<00:01,  9.62it/s] 31%|███▏      | 5/16 [00:00<00:01, 10.74it/s] 44%|████▍     | 7/16 [00:00<00:00, 11.28it/s] 56%|█████▋    | 9/16 [00:00<00:00, 11.63it/s] 69%|██████▉   | 11/16 [00:00<00:00, 11.67it/s] 81%|████████▏ | 13/16 [00:01<00:00, 11.73it/s] 94%|█████████▍| 15/16 [00:01<00:00, 11.76it/s]100%|██████████| 16/16 [00:04<00:00,  3.66it/s]
2025-03-09 08:08:34,254 [INFO]: 	Computing best hyperparameters for index knn.index 03/09/2025, 08:08:34
2025-03-09 08:09:15,016 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 40.7616 secs
2025-03-09 08:09:15,016 [INFO]: The best hyperparameters are: efSearch=233
2025-03-09 08:09:15,016 [INFO]: 	Compute fast metrics 03/09/2025, 08:09:15
  0%|          | 0/4 [00:00<?, ?it/s] 25%|██▌       | 1/4 [00:00<00:00,  5.21it/s] 50%|█████     | 2/4 [00:00<00:00,  6.75it/s] 75%|███████▌  | 3/4 [00:00<00:00,  7.40it/s] 75%|███████▌  | 3/4 [00:00<00:00,  5.64it/s]
2025-03-09 08:09:31,784 [INFO]: 	>>> Finished "Compute fast metrics" in 16.7678 secs
2025-03-09 08:09:31,787 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 61.9140 secs
2025-03-09 08:09:31,788 [INFO]: {
2025-03-09 08:09:31,788 [INFO]: 	index_key: HNSW15
2025-03-09 08:09:31,788 [INFO]: 	index_param: efSearch=233
2025-03-09 08:09:31,788 [INFO]: 	index_path: knn.index
2025-03-09 08:09:31,788 [INFO]: 	size in bytes: 777532510
2025-03-09 08:09:31,788 [INFO]: 	avg_search_speed_ms: 11.724218820327629
2025-03-09 08:09:31,788 [INFO]: 	99p_search_speed_ms: 25.808469839394107
2025-03-09 08:09:31,788 [INFO]: 	reconstruction error %: 0.0
2025-03-09 08:09:31,788 [INFO]: 	nb vectors: 3952
2025-03-09 08:09:31,788 [INFO]: 	vectors dimension: 49152
2025-03-09 08:09:31,788 [INFO]: 	compression ratio: 0.9993084610700073
2025-03-09 08:09:31,788 [INFO]: }
2025-03-09 08:09:31,788 [INFO]: 	>>> Finished "Creating the index" in 61.9154 secs
2025-03-09 08:09:31,788 [INFO]: >>> Finished "Launching the whole pipeline" in 61.9410 secs
2025-03-09 08:09:33: [retrieval_preprocessing] calculating distances ...
2025-03-09 08:09:34: [retrieval_preprocessing] finished and saved retrieval indices for episode 81453 [episode count 6/20]
[retrieval_preprocessing] for episode 81967 [episode count 7/20], we have num_retrieval=np.int64(3999) num_query=np.int64(185)
2025-03-09 08:09:36,280 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-09 08:09:37,001 [INFO]: Launching the whole pipeline 03/09/2025, 08:09:37
2025-03-09 08:09:37,002 [INFO]: Reading total number of vectors and dimension 03/09/2025, 08:09:37
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1288.18it/s]
2025-03-09 08:09:37,036 [INFO]: There are 3999 embeddings of dim 49152
2025-03-09 08:09:37,036 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0348 secs
2025-03-09 08:09:37,036 [INFO]: 	Compute estimated construction time of the index 03/09/2025, 08:09:37
2025-03-09 08:09:37,037 [INFO]: 		-> Train: 16.7 minutes
2025-03-09 08:09:37,037 [INFO]: 		-> Add: 2.2 seconds
2025-03-09 08:09:37,037 [INFO]: 		Total: 16.7 minutes
2025-03-09 08:09:37,037 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0001 secs
2025-03-09 08:09:37,037 [INFO]: 	Checking that your have enough memory available to create the index 03/09/2025, 08:09:37
2025-03-09 08:09:37,037 [INFO]: 825.3MB of memory will be needed to build the index (more might be used if you have more)
2025-03-09 08:09:37,037 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0001 secs
2025-03-09 08:09:37,037 [INFO]: 	Selecting most promising index types given data characteristics 03/09/2025, 08:09:37
2025-03-09 08:09:37,037 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-09 08:09:37,037 [INFO]: 	Creating the index 03/09/2025, 08:09:37
2025-03-09 08:09:37,037 [INFO]: 		-> Instanciate the index HNSW15 03/09/2025, 08:09:37
2025-03-09 08:09:37,038 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0011 secs
2025-03-09 08:09:37,038 [INFO]: 		-> Adding the vectors to the index 03/09/2025, 08:09:37
2025-03-09 08:09:37,038 [INFO]: The memory available for adding the vectors is 49.3GB(total available - used by the index)
2025-03-09 08:09:37,038 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/16 [00:00<?, ?it/s]  6%|▋         | 1/16 [00:00<00:02,  5.12it/s] 12%|█▎        | 2/16 [00:00<00:01,  7.07it/s] 19%|█▉        | 3/16 [00:00<00:01,  7.76it/s] 25%|██▌       | 4/16 [00:00<00:01,  7.52it/s] 31%|███▏      | 5/16 [00:00<00:01,  7.99it/s] 38%|███▊      | 6/16 [00:00<00:01,  8.33it/s] 44%|████▍     | 7/16 [00:00<00:01,  8.53it/s] 50%|█████     | 8/16 [00:01<00:00,  8.14it/s] 56%|█████▋    | 9/16 [00:01<00:00,  8.44it/s] 62%|██████▎   | 10/16 [00:01<00:00,  8.50it/s] 69%|██████▉   | 11/16 [00:01<00:00,  8.48it/s] 75%|███████▌  | 12/16 [00:01<00:00,  7.95it/s] 81%|████████▏ | 13/16 [00:01<00:00,  8.20it/s] 88%|████████▊ | 14/16 [00:01<00:00,  8.43it/s] 94%|█████████▍| 15/16 [00:01<00:00,  8.54it/s]100%|██████████| 16/16 [00:04<00:00,  1.01it/s]100%|██████████| 16/16 [00:04<00:00,  3.28it/s]
2025-03-09 08:09:41,924 [INFO]: 	Computing best hyperparameters for index knn.index 03/09/2025, 08:09:41
2025-03-09 08:10:19,554 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 37.6296 secs
2025-03-09 08:10:19,555 [INFO]: The best hyperparameters are: efSearch=243
2025-03-09 08:10:19,555 [INFO]: 	Compute fast metrics 03/09/2025, 08:10:19
  0%|          | 0/4 [00:00<?, ?it/s] 25%|██▌       | 1/4 [00:00<00:00,  5.94it/s] 75%|███████▌  | 3/4 [00:00<00:00,  9.69it/s] 75%|███████▌  | 3/4 [00:00<00:00,  7.52it/s]
2025-03-09 08:10:37,697 [INFO]: 	>>> Finished "Compute fast metrics" in 18.1426 secs
2025-03-09 08:10:37,700 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 60.6616 secs
2025-03-09 08:10:37,700 [INFO]: {
2025-03-09 08:10:37,700 [INFO]: 	index_key: HNSW15
2025-03-09 08:10:37,700 [INFO]: 	index_param: efSearch=243
2025-03-09 08:10:37,700 [INFO]: 	index_path: knn.index
2025-03-09 08:10:37,700 [INFO]: 	size in bytes: 786779410
2025-03-09 08:10:37,700 [INFO]: 	avg_search_speed_ms: 11.435026191441077
2025-03-09 08:10:37,700 [INFO]: 	99p_search_speed_ms: 19.084003260359168
2025-03-09 08:10:37,700 [INFO]: 	reconstruction error %: 0.0
2025-03-09 08:10:37,700 [INFO]: 	nb vectors: 3999
2025-03-09 08:10:37,700 [INFO]: 	vectors dimension: 49152
2025-03-09 08:10:37,700 [INFO]: 	compression ratio: 0.9993085507918922
2025-03-09 08:10:37,700 [INFO]: }
2025-03-09 08:10:37,700 [INFO]: 	>>> Finished "Creating the index" in 60.6632 secs
2025-03-09 08:10:37,700 [INFO]: >>> Finished "Launching the whole pipeline" in 60.6987 secs
2025-03-09 08:10:38: [retrieval_preprocessing] calculating distances ...
2025-03-09 08:10:39: [retrieval_preprocessing] finished and saved retrieval indices for episode 81967 [episode count 7/20]
[retrieval_preprocessing] for episode 42544 [episode count 8/20], we have num_retrieval=np.int64(3979) num_query=np.int64(205)
2025-03-09 08:10:40,861 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-09 08:10:41,438 [INFO]: Launching the whole pipeline 03/09/2025, 08:10:41
2025-03-09 08:10:41,438 [INFO]: Reading total number of vectors and dimension 03/09/2025, 08:10:41
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 2251.37it/s]
2025-03-09 08:10:41,463 [INFO]: There are 3979 embeddings of dim 49152
2025-03-09 08:10:41,463 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0249 secs
2025-03-09 08:10:41,463 [INFO]: 	Compute estimated construction time of the index 03/09/2025, 08:10:41
2025-03-09 08:10:41,463 [INFO]: 		-> Train: 16.7 minutes
2025-03-09 08:10:41,463 [INFO]: 		-> Add: 2.2 seconds
2025-03-09 08:10:41,463 [INFO]: 		Total: 16.7 minutes
2025-03-09 08:10:41,463 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0001 secs
2025-03-09 08:10:41,463 [INFO]: 	Checking that your have enough memory available to create the index 03/09/2025, 08:10:41
2025-03-09 08:10:41,463 [INFO]: 821.2MB of memory will be needed to build the index (more might be used if you have more)
2025-03-09 08:10:41,463 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0002 secs
2025-03-09 08:10:41,463 [INFO]: 	Selecting most promising index types given data characteristics 03/09/2025, 08:10:41
2025-03-09 08:10:41,463 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-09 08:10:41,463 [INFO]: 	Creating the index 03/09/2025, 08:10:41
2025-03-09 08:10:41,464 [INFO]: 		-> Instanciate the index HNSW15 03/09/2025, 08:10:41
2025-03-09 08:10:41,465 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0012 secs
2025-03-09 08:10:41,465 [INFO]: 		-> Adding the vectors to the index 03/09/2025, 08:10:41
2025-03-09 08:10:41,465 [INFO]: The memory available for adding the vectors is 49.3GB(total available - used by the index)
2025-03-09 08:10:41,465 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/16 [00:00<?, ?it/s]  6%|▋         | 1/16 [00:00<00:02,  5.52it/s] 12%|█▎        | 2/16 [00:00<00:02,  6.91it/s] 19%|█▉        | 3/16 [00:00<00:01,  7.57it/s] 25%|██▌       | 4/16 [00:00<00:01,  8.06it/s] 31%|███▏      | 5/16 [00:00<00:01,  8.27it/s] 38%|███▊      | 6/16 [00:00<00:01,  8.37it/s] 44%|████▍     | 7/16 [00:00<00:01,  8.47it/s] 50%|█████     | 8/16 [00:00<00:00,  8.53it/s] 56%|█████▋    | 9/16 [00:01<00:00,  8.67it/s] 62%|██████▎   | 10/16 [00:01<00:00,  8.69it/s] 69%|██████▉   | 11/16 [00:01<00:00,  8.67it/s] 75%|███████▌  | 12/16 [00:01<00:00,  8.63it/s] 81%|████████▏ | 13/16 [00:01<00:00,  8.66it/s] 88%|████████▊ | 14/16 [00:01<00:00,  8.71it/s] 94%|█████████▍| 15/16 [00:01<00:00,  8.85it/s]100%|██████████| 16/16 [00:04<00:00,  1.01it/s]100%|██████████| 16/16 [00:04<00:00,  3.31it/s]
2025-03-09 08:10:46,299 [INFO]: 	Computing best hyperparameters for index knn.index 03/09/2025, 08:10:46
2025-03-09 08:11:32,296 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 45.9972 secs
2025-03-09 08:11:32,297 [INFO]: The best hyperparameters are: efSearch=173
2025-03-09 08:11:32,297 [INFO]: 	Compute fast metrics 03/09/2025, 08:11:32
  0%|          | 0/4 [00:00<?, ?it/s] 25%|██▌       | 1/4 [00:00<00:00,  6.19it/s] 75%|███████▌  | 3/4 [00:00<00:00,  7.09it/s] 75%|███████▌  | 3/4 [00:00<00:00,  5.29it/s]
2025-03-09 08:11:46,450 [INFO]: 	>>> Finished "Compute fast metrics" in 14.1534 secs
2025-03-09 08:11:46,454 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 64.9890 secs
2025-03-09 08:11:46,454 [INFO]: {
2025-03-09 08:11:46,454 [INFO]: 	index_key: HNSW15
2025-03-09 08:11:46,454 [INFO]: 	index_param: efSearch=173
2025-03-09 08:11:46,454 [INFO]: 	index_path: knn.index
2025-03-09 08:11:46,454 [INFO]: 	size in bytes: 782844550
2025-03-09 08:11:46,454 [INFO]: 	avg_search_speed_ms: 10.377687060552422
2025-03-09 08:11:46,454 [INFO]: 	99p_search_speed_ms: 18.4275671094656
2025-03-09 08:11:46,454 [INFO]: 	reconstruction error %: 0.0
2025-03-09 08:11:46,454 [INFO]: 	nb vectors: 3979
2025-03-09 08:11:46,454 [INFO]: 	vectors dimension: 49152
2025-03-09 08:11:46,454 [INFO]: 	compression ratio: 0.9993085242785429
2025-03-09 08:11:46,454 [INFO]: }
2025-03-09 08:11:46,454 [INFO]: 	>>> Finished "Creating the index" in 64.9908 secs
2025-03-09 08:11:46,454 [INFO]: >>> Finished "Launching the whole pipeline" in 65.0164 secs
2025-03-09 08:11:48: [retrieval_preprocessing] calculating distances ...
2025-03-09 08:11:48: [retrieval_preprocessing] finished and saved retrieval indices for episode 42544 [episode count 8/20]
[retrieval_preprocessing] for episode 64561 [episode count 9/20], we have num_retrieval=np.int64(3938) num_query=np.int64(246)
2025-03-09 08:11:50,053 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-09 08:11:50,586 [INFO]: Launching the whole pipeline 03/09/2025, 08:11:50
2025-03-09 08:11:50,586 [INFO]: Reading total number of vectors and dimension 03/09/2025, 08:11:50
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1019.02it/s]
2025-03-09 08:11:50,612 [INFO]: There are 3938 embeddings of dim 49152
2025-03-09 08:11:50,612 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0261 secs
2025-03-09 08:11:50,612 [INFO]: 	Compute estimated construction time of the index 03/09/2025, 08:11:50
2025-03-09 08:11:50,612 [INFO]: 		-> Train: 16.7 minutes
2025-03-09 08:11:50,612 [INFO]: 		-> Add: 2.2 seconds
2025-03-09 08:11:50,612 [INFO]: 		Total: 16.7 minutes
2025-03-09 08:11:50,612 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0001 secs
2025-03-09 08:11:50,612 [INFO]: 	Checking that your have enough memory available to create the index 03/09/2025, 08:11:50
2025-03-09 08:11:50,613 [INFO]: 812.7MB of memory will be needed to build the index (more might be used if you have more)
2025-03-09 08:11:50,613 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0002 secs
2025-03-09 08:11:50,613 [INFO]: 	Selecting most promising index types given data characteristics 03/09/2025, 08:11:50
2025-03-09 08:11:50,613 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-09 08:11:50,613 [INFO]: 	Creating the index 03/09/2025, 08:11:50
2025-03-09 08:11:50,613 [INFO]: 		-> Instanciate the index HNSW15 03/09/2025, 08:11:50
2025-03-09 08:11:50,614 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0010 secs
2025-03-09 08:11:50,614 [INFO]: 		-> Adding the vectors to the index 03/09/2025, 08:11:50
2025-03-09 08:11:50,614 [INFO]: The memory available for adding the vectors is 49.3GB(total available - used by the index)
2025-03-09 08:11:50,614 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/16 [00:00<?, ?it/s]  6%|▋         | 1/16 [00:00<00:03,  4.80it/s] 12%|█▎        | 2/16 [00:00<00:02,  6.56it/s] 19%|█▉        | 3/16 [00:00<00:01,  7.39it/s] 25%|██▌       | 4/16 [00:00<00:01,  7.82it/s] 31%|███▏      | 5/16 [00:00<00:01,  7.90it/s] 38%|███▊      | 6/16 [00:00<00:01,  8.12it/s] 44%|████▍     | 7/16 [00:00<00:01,  8.36it/s] 50%|█████     | 8/16 [00:01<00:00,  8.42it/s] 56%|█████▋    | 9/16 [00:01<00:00,  8.37it/s] 62%|██████▎   | 10/16 [00:01<00:00,  8.50it/s] 69%|██████▉   | 11/16 [00:01<00:00,  8.57it/s] 75%|███████▌  | 12/16 [00:01<00:00,  8.44it/s] 81%|████████▏ | 13/16 [00:01<00:00,  8.38it/s] 88%|████████▊ | 14/16 [00:01<00:00,  8.45it/s] 94%|█████████▍| 15/16 [00:01<00:00,  8.50it/s]100%|██████████| 16/16 [00:05<00:00,  1.04s/it]100%|██████████| 16/16 [00:05<00:00,  3.17it/s]
2025-03-09 08:11:55,664 [INFO]: 	Computing best hyperparameters for index knn.index 03/09/2025, 08:11:55
2025-03-09 08:12:32,376 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 36.7122 secs
2025-03-09 08:12:32,377 [INFO]: The best hyperparameters are: efSearch=226
2025-03-09 08:12:32,377 [INFO]: 	Compute fast metrics 03/09/2025, 08:12:32
  0%|          | 0/4 [00:00<?, ?it/s] 25%|██▌       | 1/4 [00:00<00:00,  5.13it/s] 50%|█████     | 2/4 [00:00<00:00,  6.70it/s] 75%|███████▌  | 3/4 [00:00<00:00,  7.38it/s] 75%|███████▌  | 3/4 [00:00<00:00,  5.59it/s]
2025-03-09 08:12:47,847 [INFO]: 	>>> Finished "Compute fast metrics" in 15.4699 secs
2025-03-09 08:12:47,849 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 57.2352 secs
2025-03-09 08:12:47,849 [INFO]: {
2025-03-09 08:12:47,849 [INFO]: 	index_key: HNSW15
2025-03-09 08:12:47,849 [INFO]: 	index_param: efSearch=226
2025-03-09 08:12:47,849 [INFO]: 	index_path: knn.index
2025-03-09 08:12:47,849 [INFO]: 	size in bytes: 774778090
2025-03-09 08:12:47,849 [INFO]: 	avg_search_speed_ms: 10.646898984062041
2025-03-09 08:12:47,849 [INFO]: 	99p_search_speed_ms: 17.0277142804116
2025-03-09 08:12:47,849 [INFO]: 	reconstruction error %: 0.0
2025-03-09 08:12:47,849 [INFO]: 	nb vectors: 3938
2025-03-09 08:12:47,849 [INFO]: 	vectors dimension: 49152
2025-03-09 08:12:47,849 [INFO]: 	compression ratio: 0.9993084652148592
2025-03-09 08:12:47,849 [INFO]: }
2025-03-09 08:12:47,849 [INFO]: 	>>> Finished "Creating the index" in 57.2366 secs
2025-03-09 08:12:47,849 [INFO]: >>> Finished "Launching the whole pipeline" in 57.2634 secs
2025-03-09 08:12:48: [retrieval_preprocessing] calculating distances ...
2025-03-09 08:12:49: [retrieval_preprocessing] finished and saved retrieval indices for episode 64561 [episode count 9/20]
[retrieval_preprocessing] for episode 78905 [episode count 10/20], we have num_retrieval=np.int64(4002) num_query=np.int64(182)
2025-03-09 08:12:50,815 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-09 08:12:51,324 [INFO]: Launching the whole pipeline 03/09/2025, 08:12:51
2025-03-09 08:12:51,324 [INFO]: Reading total number of vectors and dimension 03/09/2025, 08:12:51
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 2319.86it/s]
2025-03-09 08:12:51,346 [INFO]: There are 4002 embeddings of dim 49152
2025-03-09 08:12:51,346 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0220 secs
2025-03-09 08:12:51,347 [INFO]: 	Compute estimated construction time of the index 03/09/2025, 08:12:51
2025-03-09 08:12:51,347 [INFO]: 		-> Train: 16.7 minutes
2025-03-09 08:12:51,347 [INFO]: 		-> Add: 2.2 seconds
2025-03-09 08:12:51,347 [INFO]: 		Total: 16.7 minutes
2025-03-09 08:12:51,347 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0001 secs
2025-03-09 08:12:51,347 [INFO]: 	Checking that your have enough memory available to create the index 03/09/2025, 08:12:51
2025-03-09 08:12:51,347 [INFO]: 825.9MB of memory will be needed to build the index (more might be used if you have more)
2025-03-09 08:12:51,347 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0002 secs
2025-03-09 08:12:51,347 [INFO]: 	Selecting most promising index types given data characteristics 03/09/2025, 08:12:51
2025-03-09 08:12:51,347 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-09 08:12:51,347 [INFO]: 	Creating the index 03/09/2025, 08:12:51
2025-03-09 08:12:51,347 [INFO]: 		-> Instanciate the index HNSW15 03/09/2025, 08:12:51
2025-03-09 08:12:51,348 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0009 secs
2025-03-09 08:12:51,348 [INFO]: 		-> Adding the vectors to the index 03/09/2025, 08:12:51
2025-03-09 08:12:51,348 [INFO]: The memory available for adding the vectors is 49.3GB(total available - used by the index)
2025-03-09 08:12:51,348 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/16 [00:00<?, ?it/s]  6%|▋         | 1/16 [00:00<00:02,  6.12it/s] 12%|█▎        | 2/16 [00:00<00:01,  7.91it/s] 25%|██▌       | 4/16 [00:00<00:01,  9.14it/s] 31%|███▏      | 5/16 [00:00<00:01,  9.25it/s] 38%|███▊      | 6/16 [00:00<00:01,  9.16it/s] 44%|████▍     | 7/16 [00:00<00:00,  9.15it/s] 50%|█████     | 8/16 [00:00<00:00,  9.25it/s] 56%|█████▋    | 9/16 [00:01<00:00,  9.21it/s] 62%|██████▎   | 10/16 [00:01<00:00,  9.24it/s] 69%|██████▉   | 11/16 [00:01<00:00,  9.28it/s] 75%|███████▌  | 12/16 [00:01<00:00,  9.21it/s] 81%|████████▏ | 13/16 [00:01<00:00,  9.20it/s] 88%|████████▊ | 14/16 [00:01<00:00,  9.21it/s] 94%|█████████▍| 15/16 [00:01<00:00,  9.25it/s]100%|██████████| 16/16 [00:04<00:00,  1.06s/it]100%|██████████| 16/16 [00:04<00:00,  3.24it/s]
2025-03-09 08:12:56,299 [INFO]: 	Computing best hyperparameters for index knn.index 03/09/2025, 08:12:56
2025-03-09 08:13:34,957 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 38.6571 secs
2025-03-09 08:13:34,957 [INFO]: The best hyperparameters are: efSearch=168
2025-03-09 08:13:34,957 [INFO]: 	Compute fast metrics 03/09/2025, 08:13:34
  0%|          | 0/4 [00:00<?, ?it/s] 25%|██▌       | 1/4 [00:00<00:00,  5.36it/s] 50%|█████     | 2/4 [00:00<00:00,  7.01it/s] 75%|███████▌  | 3/4 [00:00<00:00,  7.81it/s] 75%|███████▌  | 3/4 [00:00<00:00,  5.87it/s]
2025-03-09 08:13:53,078 [INFO]: 	>>> Finished "Compute fast metrics" in 18.1206 secs
2025-03-09 08:13:53,081 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 61.7327 secs
2025-03-09 08:13:53,081 [INFO]: {
2025-03-09 08:13:53,081 [INFO]: 	index_key: HNSW15
2025-03-09 08:13:53,081 [INFO]: 	index_param: efSearch=168
2025-03-09 08:13:53,081 [INFO]: 	index_path: knn.index
2025-03-09 08:13:53,081 [INFO]: 	size in bytes: 787369630
2025-03-09 08:13:53,081 [INFO]: 	avg_search_speed_ms: 8.616273974659665
2025-03-09 08:13:53,081 [INFO]: 	99p_search_speed_ms: 14.422789355739951
2025-03-09 08:13:53,081 [INFO]: 	reconstruction error %: 0.0
2025-03-09 08:13:53,081 [INFO]: 	nb vectors: 4002
2025-03-09 08:13:53,081 [INFO]: 	vectors dimension: 49152
2025-03-09 08:13:53,081 [INFO]: 	compression ratio: 0.9993085661685986
2025-03-09 08:13:53,081 [INFO]: }
2025-03-09 08:13:53,081 [INFO]: 	>>> Finished "Creating the index" in 61.7340 secs
2025-03-09 08:13:53,081 [INFO]: >>> Finished "Launching the whole pipeline" in 61.7567 secs
2025-03-09 08:13:53: [retrieval_preprocessing] calculating distances ...
2025-03-09 08:13:54: [retrieval_preprocessing] finished and saved retrieval indices for episode 78905 [episode count 10/20]
[retrieval_preprocessing] for episode 64060 [episode count 11/20], we have num_retrieval=np.int64(4018) num_query=np.int64(166)
2025-03-09 08:13:55,605 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-09 08:13:56,454 [INFO]: Launching the whole pipeline 03/09/2025, 08:13:56
2025-03-09 08:13:56,454 [INFO]: Reading total number of vectors and dimension 03/09/2025, 08:13:56
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1748.36it/s]
2025-03-09 08:13:56,483 [INFO]: There are 4018 embeddings of dim 49152
2025-03-09 08:13:56,483 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0296 secs
2025-03-09 08:13:56,483 [INFO]: 	Compute estimated construction time of the index 03/09/2025, 08:13:56
2025-03-09 08:13:56,483 [INFO]: 		-> Train: 16.7 minutes
2025-03-09 08:13:56,484 [INFO]: 		-> Add: 2.2 seconds
2025-03-09 08:13:56,484 [INFO]: 		Total: 16.7 minutes
2025-03-09 08:13:56,484 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0001 secs
2025-03-09 08:13:56,484 [INFO]: 	Checking that your have enough memory available to create the index 03/09/2025, 08:13:56
2025-03-09 08:13:56,484 [INFO]: 829.2MB of memory will be needed to build the index (more might be used if you have more)
2025-03-09 08:13:56,484 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0002 secs
2025-03-09 08:13:56,484 [INFO]: 	Selecting most promising index types given data characteristics 03/09/2025, 08:13:56
2025-03-09 08:13:56,484 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-09 08:13:56,484 [INFO]: 	Creating the index 03/09/2025, 08:13:56
2025-03-09 08:13:56,484 [INFO]: 		-> Instanciate the index HNSW15 03/09/2025, 08:13:56
2025-03-09 08:13:56,485 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0013 secs
2025-03-09 08:13:56,485 [INFO]: 		-> Adding the vectors to the index 03/09/2025, 08:13:56
2025-03-09 08:13:56,485 [INFO]: The memory available for adding the vectors is 49.3GB(total available - used by the index)
2025-03-09 08:13:56,485 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/16 [00:00<?, ?it/s]  6%|▋         | 1/16 [00:00<00:02,  5.80it/s] 12%|█▎        | 2/16 [00:00<00:01,  7.53it/s] 19%|█▉        | 3/16 [00:00<00:01,  8.37it/s] 25%|██▌       | 4/16 [00:00<00:01,  8.81it/s] 38%|███▊      | 6/16 [00:00<00:01,  9.31it/s] 44%|████▍     | 7/16 [00:00<00:00,  9.35it/s] 50%|█████     | 8/16 [00:00<00:00,  9.39it/s] 56%|█████▋    | 9/16 [00:01<00:00,  9.47it/s] 62%|██████▎   | 10/16 [00:01<00:00,  9.39it/s] 69%|██████▉   | 11/16 [00:01<00:00,  9.29it/s] 75%|███████▌  | 12/16 [00:01<00:00,  9.03it/s] 81%|████████▏ | 13/16 [00:01<00:00,  9.07it/s] 94%|█████████▍| 15/16 [00:01<00:00, 10.33it/s]100%|██████████| 16/16 [00:04<00:00,  3.34it/s]
2025-03-09 08:14:01,281 [INFO]: 	Computing best hyperparameters for index knn.index 03/09/2025, 08:14:01
2025-03-09 08:14:41,032 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 39.7507 secs
2025-03-09 08:14:41,033 [INFO]: The best hyperparameters are: efSearch=155
2025-03-09 08:14:41,033 [INFO]: 	Compute fast metrics 03/09/2025, 08:14:41
  0%|          | 0/4 [00:00<?, ?it/s] 25%|██▌       | 1/4 [00:00<00:00,  4.98it/s] 50%|█████     | 2/4 [00:00<00:00,  6.27it/s] 75%|███████▌  | 3/4 [00:00<00:00,  7.07it/s] 75%|███████▌  | 3/4 [00:00<00:00,  5.32it/s]
2025-03-09 08:14:59,403 [INFO]: 	>>> Finished "Compute fast metrics" in 18.3699 secs
2025-03-09 08:14:59,616 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 63.1310 secs
2025-03-09 08:14:59,617 [INFO]: {
2025-03-09 08:14:59,617 [INFO]: 	index_key: HNSW15
2025-03-09 08:14:59,617 [INFO]: 	index_param: efSearch=155
2025-03-09 08:14:59,617 [INFO]: 	index_path: knn.index
2025-03-09 08:14:59,617 [INFO]: 	size in bytes: 790517590
2025-03-09 08:14:59,618 [INFO]: 	avg_search_speed_ms: 8.834226539871876
2025-03-09 08:14:59,618 [INFO]: 	99p_search_speed_ms: 15.882032362278565
2025-03-09 08:14:59,618 [INFO]: 	reconstruction error %: 0.0
2025-03-09 08:14:59,618 [INFO]: 	nb vectors: 4018
2025-03-09 08:14:59,618 [INFO]: 	vectors dimension: 49152
2025-03-09 08:14:59,618 [INFO]: 	compression ratio: 0.999308496095577
2025-03-09 08:14:59,618 [INFO]: }
2025-03-09 08:14:59,618 [INFO]: 	>>> Finished "Creating the index" in 63.1339 secs
2025-03-09 08:14:59,618 [INFO]: >>> Finished "Launching the whole pipeline" in 63.1643 secs
2025-03-09 08:15:00: [retrieval_preprocessing] calculating distances ...
2025-03-09 08:15:00: [retrieval_preprocessing] finished and saved retrieval indices for episode 64060 [episode count 11/20]
[retrieval_preprocessing] for episode 68158 [episode count 12/20], we have num_retrieval=np.int64(3961) num_query=np.int64(223)
2025-03-09 08:15:01,935 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-09 08:15:03,134 [INFO]: Launching the whole pipeline 03/09/2025, 08:15:03
2025-03-09 08:15:03,134 [INFO]: Reading total number of vectors and dimension 03/09/2025, 08:15:03
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1518.03it/s]
2025-03-09 08:15:03,159 [INFO]: There are 3961 embeddings of dim 49152
2025-03-09 08:15:03,160 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0253 secs
2025-03-09 08:15:03,160 [INFO]: 	Compute estimated construction time of the index 03/09/2025, 08:15:03
2025-03-09 08:15:03,160 [INFO]: 		-> Train: 16.7 minutes
2025-03-09 08:15:03,160 [INFO]: 		-> Add: 2.2 seconds
2025-03-09 08:15:03,160 [INFO]: 		Total: 16.7 minutes
2025-03-09 08:15:03,160 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0001 secs
2025-03-09 08:15:03,160 [INFO]: 	Checking that your have enough memory available to create the index 03/09/2025, 08:15:03
2025-03-09 08:15:03,160 [INFO]: 817.5MB of memory will be needed to build the index (more might be used if you have more)
2025-03-09 08:15:03,160 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0001 secs
2025-03-09 08:15:03,160 [INFO]: 	Selecting most promising index types given data characteristics 03/09/2025, 08:15:03
2025-03-09 08:15:03,160 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-09 08:15:03,160 [INFO]: 	Creating the index 03/09/2025, 08:15:03
2025-03-09 08:15:03,160 [INFO]: 		-> Instanciate the index HNSW15 03/09/2025, 08:15:03
2025-03-09 08:15:03,161 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0010 secs
2025-03-09 08:15:03,161 [INFO]: 		-> Adding the vectors to the index 03/09/2025, 08:15:03
2025-03-09 08:15:03,161 [INFO]: The memory available for adding the vectors is 49.3GB(total available - used by the index)
2025-03-09 08:15:03,161 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/16 [00:00<?, ?it/s]  6%|▋         | 1/16 [00:00<00:02,  5.51it/s] 12%|█▎        | 2/16 [00:00<00:02,  6.92it/s] 19%|█▉        | 3/16 [00:00<00:01,  7.35it/s] 25%|██▌       | 4/16 [00:00<00:01,  7.70it/s] 31%|███▏      | 5/16 [00:00<00:01,  8.08it/s] 38%|███▊      | 6/16 [00:00<00:01,  8.54it/s] 44%|████▍     | 7/16 [00:00<00:01,  8.80it/s] 50%|█████     | 8/16 [00:00<00:00,  8.87it/s] 56%|█████▋    | 9/16 [00:01<00:00,  8.87it/s] 62%|██████▎   | 10/16 [00:01<00:00,  9.05it/s] 69%|██████▉   | 11/16 [00:01<00:00,  9.01it/s] 75%|███████▌  | 12/16 [00:01<00:00,  8.91it/s] 81%|████████▏ | 13/16 [00:01<00:00,  8.93it/s] 88%|████████▊ | 14/16 [00:01<00:00,  9.00it/s] 94%|█████████▍| 15/16 [00:01<00:00,  9.15it/s]100%|██████████| 16/16 [00:04<00:00,  1.04it/s]100%|██████████| 16/16 [00:04<00:00,  3.42it/s]
2025-03-09 08:15:07,846 [INFO]: 	Computing best hyperparameters for index knn.index 03/09/2025, 08:15:07
2025-03-09 08:15:45,815 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 37.9689 secs
2025-03-09 08:15:45,816 [INFO]: The best hyperparameters are: efSearch=218
2025-03-09 08:15:45,816 [INFO]: 	Compute fast metrics 03/09/2025, 08:15:45
  0%|          | 0/4 [00:00<?, ?it/s] 25%|██▌       | 1/4 [00:00<00:00,  5.61it/s] 50%|█████     | 2/4 [00:00<00:00,  7.05it/s] 75%|███████▌  | 3/4 [00:00<00:00,  7.67it/s] 75%|███████▌  | 3/4 [00:00<00:00,  5.73it/s]
2025-03-09 08:16:01,902 [INFO]: 	>>> Finished "Compute fast metrics" in 16.0861 secs
2025-03-09 08:16:02,125 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 58.9640 secs
2025-03-09 08:16:02,126 [INFO]: {
2025-03-09 08:16:02,126 [INFO]: 	index_key: HNSW15
2025-03-09 08:16:02,126 [INFO]: 	index_param: efSearch=218
2025-03-09 08:16:02,126 [INFO]: 	index_path: knn.index
2025-03-09 08:16:02,126 [INFO]: 	size in bytes: 779303170
2025-03-09 08:16:02,126 [INFO]: 	avg_search_speed_ms: 11.121224283341222
2025-03-09 08:16:02,126 [INFO]: 	99p_search_speed_ms: 20.217999452725035
2025-03-09 08:16:02,126 [INFO]: 	reconstruction error %: 0.0
2025-03-09 08:16:02,126 [INFO]: 	nb vectors: 3961
2025-03-09 08:16:02,126 [INFO]: 	vectors dimension: 49152
2025-03-09 08:16:02,126 [INFO]: 	compression ratio: 0.9993085078814705
2025-03-09 08:16:02,126 [INFO]: }
2025-03-09 08:16:02,126 [INFO]: 	>>> Finished "Creating the index" in 58.9662 secs
2025-03-09 08:16:02,126 [INFO]: >>> Finished "Launching the whole pipeline" in 58.9922 secs
2025-03-09 08:16:03: [retrieval_preprocessing] calculating distances ...
2025-03-09 08:16:03: [retrieval_preprocessing] finished and saved retrieval indices for episode 68158 [episode count 12/20]
[retrieval_preprocessing] for episode 2628 [episode count 13/20], we have num_retrieval=np.int64(3906) num_query=np.int64(278)
2025-03-09 08:16:05,144 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-09 08:16:05,635 [INFO]: Launching the whole pipeline 03/09/2025, 08:16:05
2025-03-09 08:16:05,635 [INFO]: Reading total number of vectors and dimension 03/09/2025, 08:16:05
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1589.35it/s]
2025-03-09 08:16:05,660 [INFO]: There are 3906 embeddings of dim 49152
2025-03-09 08:16:05,660 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0251 secs
2025-03-09 08:16:05,660 [INFO]: 	Compute estimated construction time of the index 03/09/2025, 08:16:05
2025-03-09 08:16:05,660 [INFO]: 		-> Train: 16.7 minutes
2025-03-09 08:16:05,661 [INFO]: 		-> Add: 2.1 seconds
2025-03-09 08:16:05,661 [INFO]: 		Total: 16.7 minutes
2025-03-09 08:16:05,661 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0001 secs
2025-03-09 08:16:05,661 [INFO]: 	Checking that your have enough memory available to create the index 03/09/2025, 08:16:05
2025-03-09 08:16:05,661 [INFO]: 806.1MB of memory will be needed to build the index (more might be used if you have more)
2025-03-09 08:16:05,661 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0001 secs
2025-03-09 08:16:05,661 [INFO]: 	Selecting most promising index types given data characteristics 03/09/2025, 08:16:05
2025-03-09 08:16:05,661 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-09 08:16:05,661 [INFO]: 	Creating the index 03/09/2025, 08:16:05
2025-03-09 08:16:05,661 [INFO]: 		-> Instanciate the index HNSW15 03/09/2025, 08:16:05
2025-03-09 08:16:05,662 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0009 secs
2025-03-09 08:16:05,662 [INFO]: 		-> Adding the vectors to the index 03/09/2025, 08:16:05
2025-03-09 08:16:05,662 [INFO]: The memory available for adding the vectors is 49.3GB(total available - used by the index)
2025-03-09 08:16:05,662 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/16 [00:00<?, ?it/s]  6%|▋         | 1/16 [00:00<00:02,  5.45it/s] 12%|█▎        | 2/16 [00:00<00:01,  7.05it/s] 19%|█▉        | 3/16 [00:00<00:01,  7.74it/s] 25%|██▌       | 4/16 [00:00<00:01,  8.11it/s] 31%|███▏      | 5/16 [00:00<00:01,  8.21it/s] 38%|███▊      | 6/16 [00:00<00:01,  8.43it/s] 44%|████▍     | 7/16 [00:00<00:01,  8.69it/s] 50%|█████     | 8/16 [00:00<00:00,  8.97it/s] 56%|█████▋    | 9/16 [00:01<00:00,  9.17it/s] 62%|██████▎   | 10/16 [00:01<00:00,  9.14it/s] 69%|██████▉   | 11/16 [00:01<00:00,  9.12it/s] 75%|███████▌  | 12/16 [00:01<00:00,  9.11it/s] 81%|████████▏ | 13/16 [00:01<00:00,  9.21it/s] 88%|████████▊ | 14/16 [00:01<00:00,  9.16it/s] 94%|█████████▍| 15/16 [00:01<00:00,  9.14it/s]100%|██████████| 16/16 [00:04<00:00,  1.09it/s]100%|██████████| 16/16 [00:04<00:00,  3.54it/s]
2025-03-09 08:16:10,182 [INFO]: 	Computing best hyperparameters for index knn.index 03/09/2025, 08:16:10
2025-03-09 08:16:46,720 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 36.5371 secs
2025-03-09 08:16:46,720 [INFO]: The best hyperparameters are: efSearch=217
2025-03-09 08:16:46,720 [INFO]: 	Compute fast metrics 03/09/2025, 08:16:46
  0%|          | 0/4 [00:00<?, ?it/s] 25%|██▌       | 1/4 [00:00<00:00,  5.32it/s] 50%|█████     | 2/4 [00:00<00:00,  6.88it/s] 75%|███████▌  | 3/4 [00:00<00:00,  7.56it/s] 75%|███████▌  | 3/4 [00:00<00:00,  5.68it/s]
2025-03-09 08:17:05,392 [INFO]: 	>>> Finished "Compute fast metrics" in 18.6721 secs
2025-03-09 08:17:05,395 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 59.7334 secs
2025-03-09 08:17:05,395 [INFO]: {
2025-03-09 08:17:05,395 [INFO]: 	index_key: HNSW15
2025-03-09 08:17:05,395 [INFO]: 	index_param: efSearch=217
2025-03-09 08:17:05,396 [INFO]: 	index_path: knn.index
2025-03-09 08:17:05,396 [INFO]: 	size in bytes: 768481990
2025-03-09 08:17:05,396 [INFO]: 	avg_search_speed_ms: 11.531432562138594
2025-03-09 08:17:05,396 [INFO]: 	99p_search_speed_ms: 21.29773267544806
2025-03-09 08:17:05,396 [INFO]: 	reconstruction error %: 0.0
2025-03-09 08:17:05,396 [INFO]: 	nb vectors: 3906
2025-03-09 08:17:05,396 [INFO]: 	vectors dimension: 49152
2025-03-09 08:17:05,396 [INFO]: 	compression ratio: 0.9993088426184197
2025-03-09 08:17:05,396 [INFO]: }
2025-03-09 08:17:05,396 [INFO]: 	>>> Finished "Creating the index" in 59.7349 secs
2025-03-09 08:17:05,396 [INFO]: >>> Finished "Launching the whole pipeline" in 59.7605 secs
2025-03-09 08:17:06: [retrieval_preprocessing] calculating distances ...
2025-03-09 08:17:08: [retrieval_preprocessing] finished and saved retrieval indices for episode 2628 [episode count 13/20]
[retrieval_preprocessing] for episode 7243 [episode count 14/20], we have num_retrieval=np.int64(3953) num_query=np.int64(231)
2025-03-09 08:17:09,923 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-09 08:17:11,540 [INFO]: Launching the whole pipeline 03/09/2025, 08:17:11
2025-03-09 08:17:11,540 [INFO]: Reading total number of vectors and dimension 03/09/2025, 08:17:11
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1389.76it/s]
2025-03-09 08:17:11,569 [INFO]: There are 3953 embeddings of dim 49152
2025-03-09 08:17:11,569 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0292 secs
2025-03-09 08:17:11,569 [INFO]: 	Compute estimated construction time of the index 03/09/2025, 08:17:11
2025-03-09 08:17:11,569 [INFO]: 		-> Train: 16.7 minutes
2025-03-09 08:17:11,569 [INFO]: 		-> Add: 2.2 seconds
2025-03-09 08:17:11,569 [INFO]: 		Total: 16.7 minutes
2025-03-09 08:17:11,569 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0001 secs
2025-03-09 08:17:11,569 [INFO]: 	Checking that your have enough memory available to create the index 03/09/2025, 08:17:11
2025-03-09 08:17:11,569 [INFO]: 815.8MB of memory will be needed to build the index (more might be used if you have more)
2025-03-09 08:17:11,569 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0002 secs
2025-03-09 08:17:11,570 [INFO]: 	Selecting most promising index types given data characteristics 03/09/2025, 08:17:11
2025-03-09 08:17:11,570 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-09 08:17:11,570 [INFO]: 	Creating the index 03/09/2025, 08:17:11
2025-03-09 08:17:11,570 [INFO]: 		-> Instanciate the index HNSW15 03/09/2025, 08:17:11
2025-03-09 08:17:11,571 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0011 secs
2025-03-09 08:17:11,571 [INFO]: 		-> Adding the vectors to the index 03/09/2025, 08:17:11
2025-03-09 08:17:11,571 [INFO]: The memory available for adding the vectors is 49.3GB(total available - used by the index)
2025-03-09 08:17:11,571 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/16 [00:00<?, ?it/s]  6%|▋         | 1/16 [00:00<00:02,  5.43it/s] 12%|█▎        | 2/16 [00:00<00:02,  6.83it/s] 19%|█▉        | 3/16 [00:00<00:01,  7.43it/s] 25%|██▌       | 4/16 [00:00<00:01,  7.77it/s] 31%|███▏      | 5/16 [00:00<00:01,  8.23it/s] 38%|███▊      | 6/16 [00:00<00:01,  8.49it/s] 44%|████▍     | 7/16 [00:00<00:01,  8.65it/s] 50%|█████     | 8/16 [00:00<00:00,  8.82it/s] 56%|█████▋    | 9/16 [00:01<00:00,  9.15it/s] 62%|██████▎   | 10/16 [00:01<00:00,  8.90it/s] 69%|██████▉   | 11/16 [00:01<00:00,  8.86it/s] 75%|███████▌  | 12/16 [00:01<00:00,  8.70it/s] 81%|████████▏ | 13/16 [00:01<00:00,  8.48it/s] 88%|████████▊ | 14/16 [00:01<00:00,  8.48it/s] 94%|█████████▍| 15/16 [00:01<00:00,  8.45it/s]100%|██████████| 16/16 [00:05<00:00,  1.11s/it]100%|██████████| 16/16 [00:05<00:00,  3.07it/s]
2025-03-09 08:17:16,787 [INFO]: 	Computing best hyperparameters for index knn.index 03/09/2025, 08:17:16
2025-03-09 08:17:58,294 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 41.5063 secs
2025-03-09 08:17:58,294 [INFO]: The best hyperparameters are: efSearch=184
2025-03-09 08:17:58,294 [INFO]: 	Compute fast metrics 03/09/2025, 08:17:58
  0%|          | 0/4 [00:00<?, ?it/s] 25%|██▌       | 1/4 [00:00<00:00,  5.05it/s] 50%|█████     | 2/4 [00:00<00:00,  6.72it/s] 75%|███████▌  | 3/4 [00:00<00:00,  7.35it/s] 75%|███████▌  | 3/4 [00:00<00:00,  5.49it/s]
2025-03-09 08:18:15,988 [INFO]: 	>>> Finished "Compute fast metrics" in 17.6939 secs
2025-03-09 08:18:15,991 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 64.4197 secs
2025-03-09 08:18:15,991 [INFO]: {
2025-03-09 08:18:15,991 [INFO]: 	index_key: HNSW15
2025-03-09 08:18:15,991 [INFO]: 	index_param: efSearch=184
2025-03-09 08:18:15,991 [INFO]: 	index_path: knn.index
2025-03-09 08:18:15,991 [INFO]: 	size in bytes: 777729250
2025-03-09 08:18:15,991 [INFO]: 	avg_search_speed_ms: 9.373756995138336
2025-03-09 08:18:15,991 [INFO]: 	99p_search_speed_ms: 15.979714193381367
2025-03-09 08:18:15,991 [INFO]: 	reconstruction error %: 0.0
2025-03-09 08:18:15,991 [INFO]: 	nb vectors: 3953
2025-03-09 08:18:15,991 [INFO]: 	vectors dimension: 49152
2025-03-09 08:18:15,991 [INFO]: 	compression ratio: 0.9993084662818069
2025-03-09 08:18:15,991 [INFO]: }
2025-03-09 08:18:15,991 [INFO]: 	>>> Finished "Creating the index" in 64.4215 secs
2025-03-09 08:18:15,991 [INFO]: >>> Finished "Launching the whole pipeline" in 64.4515 secs
2025-03-09 08:18:16: [retrieval_preprocessing] calculating distances ...
2025-03-09 08:18:17: [retrieval_preprocessing] finished and saved retrieval indices for episode 7243 [episode count 14/20]
[retrieval_preprocessing] for episode 85069 [episode count 15/20], we have num_retrieval=np.int64(3984) num_query=np.int64(200)
2025-03-09 08:18:18,920 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-09 08:18:19,482 [INFO]: Launching the whole pipeline 03/09/2025, 08:18:19
2025-03-09 08:18:19,482 [INFO]: Reading total number of vectors and dimension 03/09/2025, 08:18:19
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1363.11it/s]
2025-03-09 08:18:19,509 [INFO]: There are 3984 embeddings of dim 49152
2025-03-09 08:18:19,509 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0270 secs
2025-03-09 08:18:19,509 [INFO]: 	Compute estimated construction time of the index 03/09/2025, 08:18:19
2025-03-09 08:18:19,509 [INFO]: 		-> Train: 16.7 minutes
2025-03-09 08:18:19,509 [INFO]: 		-> Add: 2.2 seconds
2025-03-09 08:18:19,509 [INFO]: 		Total: 16.7 minutes
2025-03-09 08:18:19,509 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0001 secs
2025-03-09 08:18:19,509 [INFO]: 	Checking that your have enough memory available to create the index 03/09/2025, 08:18:19
2025-03-09 08:18:19,509 [INFO]: 822.2MB of memory will be needed to build the index (more might be used if you have more)
2025-03-09 08:18:19,509 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0002 secs
2025-03-09 08:18:19,510 [INFO]: 	Selecting most promising index types given data characteristics 03/09/2025, 08:18:19
2025-03-09 08:18:19,510 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-09 08:18:19,510 [INFO]: 	Creating the index 03/09/2025, 08:18:19
2025-03-09 08:18:19,510 [INFO]: 		-> Instanciate the index HNSW15 03/09/2025, 08:18:19
2025-03-09 08:18:19,511 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0010 secs
2025-03-09 08:18:19,511 [INFO]: 		-> Adding the vectors to the index 03/09/2025, 08:18:19
2025-03-09 08:18:19,511 [INFO]: The memory available for adding the vectors is 49.3GB(total available - used by the index)
2025-03-09 08:18:19,511 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/16 [00:00<?, ?it/s]  6%|▋         | 1/16 [00:00<00:02,  5.13it/s] 12%|█▎        | 2/16 [00:00<00:02,  6.68it/s] 19%|█▉        | 3/16 [00:00<00:01,  7.36it/s] 25%|██▌       | 4/16 [00:00<00:01,  7.92it/s] 31%|███▏      | 5/16 [00:00<00:01,  8.21it/s] 44%|████▍     | 7/16 [00:00<00:01,  8.83it/s] 50%|█████     | 8/16 [00:00<00:00,  8.85it/s] 56%|█████▋    | 9/16 [00:01<00:00,  8.86it/s] 62%|██████▎   | 10/16 [00:01<00:00,  8.95it/s] 69%|██████▉   | 11/16 [00:01<00:00,  9.03it/s] 75%|███████▌  | 12/16 [00:01<00:00,  8.97it/s] 81%|████████▏ | 13/16 [00:01<00:00,  8.94it/s] 88%|████████▊ | 14/16 [00:01<00:00,  9.02it/s] 94%|█████████▍| 15/16 [00:01<00:00,  9.07it/s]100%|██████████| 16/16 [00:04<00:00,  1.11it/s]100%|██████████| 16/16 [00:04<00:00,  3.55it/s]
2025-03-09 08:18:24,027 [INFO]: 	Computing best hyperparameters for index knn.index 03/09/2025, 08:18:24
2025-03-09 08:19:01,379 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 37.3517 secs
2025-03-09 08:19:01,379 [INFO]: The best hyperparameters are: efSearch=207
2025-03-09 08:19:01,379 [INFO]: 	Compute fast metrics 03/09/2025, 08:19:01
  0%|          | 0/4 [00:00<?, ?it/s] 25%|██▌       | 1/4 [00:00<00:00,  6.30it/s] 75%|███████▌  | 3/4 [00:00<00:00,  9.12it/s] 75%|███████▌  | 3/4 [00:00<00:00,  7.12it/s]
2025-03-09 08:19:16,881 [INFO]: 	>>> Finished "Compute fast metrics" in 15.5017 secs
2025-03-09 08:19:17,427 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 57.9165 secs
2025-03-09 08:19:17,428 [INFO]: {
2025-03-09 08:19:17,428 [INFO]: 	index_key: HNSW15
2025-03-09 08:19:17,428 [INFO]: 	index_param: efSearch=207
2025-03-09 08:19:17,428 [INFO]: 	index_path: knn.index
2025-03-09 08:19:17,428 [INFO]: 	size in bytes: 783828250
2025-03-09 08:19:17,428 [INFO]: 	avg_search_speed_ms: 8.917533023238022
2025-03-09 08:19:17,428 [INFO]: 	99p_search_speed_ms: 13.424917729571458
2025-03-09 08:19:17,428 [INFO]: 	reconstruction error %: 0.0
2025-03-09 08:19:17,428 [INFO]: 	nb vectors: 3984
2025-03-09 08:19:17,428 [INFO]: 	vectors dimension: 49152
2025-03-09 08:19:17,428 [INFO]: 	compression ratio: 0.999308550055449
2025-03-09 08:19:17,428 [INFO]: }
2025-03-09 08:19:17,428 [INFO]: 	>>> Finished "Creating the index" in 57.9187 secs
2025-03-09 08:19:17,428 [INFO]: >>> Finished "Launching the whole pipeline" in 57.9464 secs
2025-03-09 08:19:18: [retrieval_preprocessing] calculating distances ...
2025-03-09 08:19:18: [retrieval_preprocessing] finished and saved retrieval indices for episode 85069 [episode count 15/20]
[retrieval_preprocessing] for episode 9295 [episode count 16/20], we have num_retrieval=np.int64(3946) num_query=np.int64(238)
2025-03-09 08:19:19,831 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-09 08:19:20,327 [INFO]: Launching the whole pipeline 03/09/2025, 08:19:20
2025-03-09 08:19:20,327 [INFO]: Reading total number of vectors and dimension 03/09/2025, 08:19:20
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1320.62it/s]
2025-03-09 08:19:20,351 [INFO]: There are 3946 embeddings of dim 49152
2025-03-09 08:19:20,352 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0248 secs
2025-03-09 08:19:20,352 [INFO]: 	Compute estimated construction time of the index 03/09/2025, 08:19:20
2025-03-09 08:19:20,352 [INFO]: 		-> Train: 16.7 minutes
2025-03-09 08:19:20,352 [INFO]: 		-> Add: 2.2 seconds
2025-03-09 08:19:20,352 [INFO]: 		Total: 16.7 minutes
2025-03-09 08:19:20,352 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0003 secs
2025-03-09 08:19:20,352 [INFO]: 	Checking that your have enough memory available to create the index 03/09/2025, 08:19:20
2025-03-09 08:19:20,352 [INFO]: 814.4MB of memory will be needed to build the index (more might be used if you have more)
2025-03-09 08:19:20,353 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0004 secs
2025-03-09 08:19:20,353 [INFO]: 	Selecting most promising index types given data characteristics 03/09/2025, 08:19:20
2025-03-09 08:19:20,353 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-09 08:19:20,353 [INFO]: 	Creating the index 03/09/2025, 08:19:20
2025-03-09 08:19:20,353 [INFO]: 		-> Instanciate the index HNSW15 03/09/2025, 08:19:20
2025-03-09 08:19:20,356 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0026 secs
2025-03-09 08:19:20,356 [INFO]: 		-> Adding the vectors to the index 03/09/2025, 08:19:20
2025-03-09 08:19:20,356 [INFO]: The memory available for adding the vectors is 49.3GB(total available - used by the index)
2025-03-09 08:19:20,356 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/16 [00:00<?, ?it/s]  6%|▋         | 1/16 [00:00<00:02,  5.56it/s] 12%|█▎        | 2/16 [00:00<00:01,  7.51it/s] 25%|██▌       | 4/16 [00:00<00:01,  8.71it/s] 31%|███▏      | 5/16 [00:00<00:01,  8.78it/s] 44%|████▍     | 7/16 [00:00<00:00, 10.29it/s] 56%|█████▋    | 9/16 [00:00<00:00, 11.81it/s] 69%|██████▉   | 11/16 [00:01<00:00, 12.22it/s] 81%|████████▏ | 13/16 [00:01<00:00, 10.98it/s] 94%|█████████▍| 15/16 [00:01<00:00, 10.43it/s]100%|██████████| 16/16 [00:04<00:00,  3.69it/s]
2025-03-09 08:19:24,693 [INFO]: 	Computing best hyperparameters for index knn.index 03/09/2025, 08:19:24
2025-03-09 08:20:01,672 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 36.9783 secs
2025-03-09 08:20:01,672 [INFO]: The best hyperparameters are: efSearch=176
2025-03-09 08:20:01,672 [INFO]: 	Compute fast metrics 03/09/2025, 08:20:01
  0%|          | 0/4 [00:00<?, ?it/s] 25%|██▌       | 1/4 [00:00<00:00,  4.80it/s] 50%|█████     | 2/4 [00:00<00:00,  6.21it/s] 75%|███████▌  | 3/4 [00:00<00:00,  6.96it/s] 75%|███████▌  | 3/4 [00:00<00:00,  5.18it/s]
2025-03-09 08:20:17,613 [INFO]: 	>>> Finished "Compute fast metrics" in 15.9413 secs
2025-03-09 08:20:17,617 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 57.2610 secs
2025-03-09 08:20:17,617 [INFO]: {
2025-03-09 08:20:17,617 [INFO]: 	index_key: HNSW15
2025-03-09 08:20:17,617 [INFO]: 	index_param: efSearch=176
2025-03-09 08:20:17,617 [INFO]: 	index_path: knn.index
2025-03-09 08:20:17,617 [INFO]: 	size in bytes: 776352010
2025-03-09 08:20:17,617 [INFO]: 	avg_search_speed_ms: 10.426923816895444
2025-03-09 08:20:17,617 [INFO]: 	99p_search_speed_ms: 17.895276071503755
2025-03-09 08:20:17,617 [INFO]: 	reconstruction error %: 0.0
2025-03-09 08:20:17,617 [INFO]: 	nb vectors: 3946
2025-03-09 08:20:17,617 [INFO]: 	vectors dimension: 49152
2025-03-09 08:20:17,617 [INFO]: 	compression ratio: 0.9993085069748193
2025-03-09 08:20:17,618 [INFO]: }
2025-03-09 08:20:17,618 [INFO]: 	>>> Finished "Creating the index" in 57.2645 secs
2025-03-09 08:20:17,618 [INFO]: >>> Finished "Launching the whole pipeline" in 57.2908 secs
2025-03-09 08:20:18: [retrieval_preprocessing] calculating distances ...
2025-03-09 08:20:19: [retrieval_preprocessing] finished and saved retrieval indices for episode 9295 [episode count 16/20]
[retrieval_preprocessing] for episode 42064 [episode count 17/20], we have num_retrieval=np.int64(3914) num_query=np.int64(270)
2025-03-09 08:20:20,468 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-09 08:20:20,948 [INFO]: Launching the whole pipeline 03/09/2025, 08:20:20
2025-03-09 08:20:20,948 [INFO]: Reading total number of vectors and dimension 03/09/2025, 08:20:20
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 2435.72it/s]
2025-03-09 08:20:20,971 [INFO]: There are 3914 embeddings of dim 49152
2025-03-09 08:20:20,971 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0237 secs
2025-03-09 08:20:20,972 [INFO]: 	Compute estimated construction time of the index 03/09/2025, 08:20:20
2025-03-09 08:20:20,972 [INFO]: 		-> Train: 16.7 minutes
2025-03-09 08:20:20,972 [INFO]: 		-> Add: 2.2 seconds
2025-03-09 08:20:20,972 [INFO]: 		Total: 16.7 minutes
2025-03-09 08:20:20,972 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0001 secs
2025-03-09 08:20:20,972 [INFO]: 	Checking that your have enough memory available to create the index 03/09/2025, 08:20:20
2025-03-09 08:20:20,972 [INFO]: 807.8MB of memory will be needed to build the index (more might be used if you have more)
2025-03-09 08:20:20,972 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0001 secs
2025-03-09 08:20:20,972 [INFO]: 	Selecting most promising index types given data characteristics 03/09/2025, 08:20:20
2025-03-09 08:20:20,972 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-09 08:20:20,972 [INFO]: 	Creating the index 03/09/2025, 08:20:20
2025-03-09 08:20:20,972 [INFO]: 		-> Instanciate the index HNSW15 03/09/2025, 08:20:20
2025-03-09 08:20:20,973 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0008 secs
2025-03-09 08:20:20,973 [INFO]: 		-> Adding the vectors to the index 03/09/2025, 08:20:20
2025-03-09 08:20:20,973 [INFO]: The memory available for adding the vectors is 49.3GB(total available - used by the index)
2025-03-09 08:20:20,973 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/16 [00:00<?, ?it/s]  6%|▋         | 1/16 [00:00<00:02,  6.58it/s] 19%|█▉        | 3/16 [00:00<00:01, 10.69it/s] 31%|███▏      | 5/16 [00:00<00:00, 11.82it/s] 44%|████▍     | 7/16 [00:00<00:00, 12.43it/s] 56%|█████▋    | 9/16 [00:00<00:00, 12.88it/s] 69%|██████▉   | 11/16 [00:00<00:00, 13.07it/s] 81%|████████▏ | 13/16 [00:01<00:00, 13.08it/s] 94%|█████████▍| 15/16 [00:01<00:00, 13.22it/s]100%|██████████| 16/16 [00:04<00:00,  3.92it/s]
2025-03-09 08:20:25,059 [INFO]: 	Computing best hyperparameters for index knn.index 03/09/2025, 08:20:25
2025-03-09 08:20:59,725 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 34.6652 secs
2025-03-09 08:20:59,725 [INFO]: The best hyperparameters are: efSearch=203
2025-03-09 08:20:59,725 [INFO]: 	Compute fast metrics 03/09/2025, 08:20:59
  0%|          | 0/4 [00:00<?, ?it/s] 25%|██▌       | 1/4 [00:00<00:00,  5.81it/s] 50%|█████     | 2/4 [00:00<00:00,  7.49it/s] 75%|███████▌  | 3/4 [00:00<00:00,  8.26it/s] 75%|███████▌  | 3/4 [00:00<00:00,  6.19it/s]
2025-03-09 08:21:16,490 [INFO]: 	>>> Finished "Compute fast metrics" in 16.7651 secs
2025-03-09 08:21:16,493 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 55.5201 secs
2025-03-09 08:21:16,493 [INFO]: {
2025-03-09 08:21:16,493 [INFO]: 	index_key: HNSW15
2025-03-09 08:21:16,493 [INFO]: 	index_param: efSearch=203
2025-03-09 08:21:16,493 [INFO]: 	index_path: knn.index
2025-03-09 08:21:16,493 [INFO]: 	size in bytes: 770056030
2025-03-09 08:21:16,493 [INFO]: 	avg_search_speed_ms: 9.97139171976689
2025-03-09 08:21:16,493 [INFO]: 	99p_search_speed_ms: 17.669557007029656
2025-03-09 08:21:16,493 [INFO]: 	reconstruction error %: 0.0
2025-03-09 08:21:16,493 [INFO]: 	nb vectors: 3914
2025-03-09 08:21:16,493 [INFO]: 	vectors dimension: 49152
2025-03-09 08:21:16,493 [INFO]: 	compression ratio: 0.9993087282233216
2025-03-09 08:21:16,493 [INFO]: }
2025-03-09 08:21:16,493 [INFO]: 	>>> Finished "Creating the index" in 55.5213 secs
2025-03-09 08:21:16,493 [INFO]: >>> Finished "Launching the whole pipeline" in 55.5455 secs
2025-03-09 08:21:17: [retrieval_preprocessing] calculating distances ...
2025-03-09 08:21:18: [retrieval_preprocessing] finished and saved retrieval indices for episode 42064 [episode count 17/20]
[retrieval_preprocessing] for episode 48210 [episode count 18/20], we have num_retrieval=np.int64(4016) num_query=np.int64(168)
2025-03-09 08:21:19,631 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-09 08:21:20,575 [INFO]: Launching the whole pipeline 03/09/2025, 08:21:20
2025-03-09 08:21:20,575 [INFO]: Reading total number of vectors and dimension 03/09/2025, 08:21:20
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1237.99it/s]
2025-03-09 08:21:20,600 [INFO]: There are 4016 embeddings of dim 49152
2025-03-09 08:21:20,601 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0252 secs
2025-03-09 08:21:20,601 [INFO]: 	Compute estimated construction time of the index 03/09/2025, 08:21:20
2025-03-09 08:21:20,601 [INFO]: 		-> Train: 16.7 minutes
2025-03-09 08:21:20,601 [INFO]: 		-> Add: 2.2 seconds
2025-03-09 08:21:20,601 [INFO]: 		Total: 16.7 minutes
2025-03-09 08:21:20,601 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0001 secs
2025-03-09 08:21:20,601 [INFO]: 	Checking that your have enough memory available to create the index 03/09/2025, 08:21:20
2025-03-09 08:21:20,601 [INFO]: 828.8MB of memory will be needed to build the index (more might be used if you have more)
2025-03-09 08:21:20,601 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0001 secs
2025-03-09 08:21:20,601 [INFO]: 	Selecting most promising index types given data characteristics 03/09/2025, 08:21:20
2025-03-09 08:21:20,601 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-09 08:21:20,601 [INFO]: 	Creating the index 03/09/2025, 08:21:20
2025-03-09 08:21:20,601 [INFO]: 		-> Instanciate the index HNSW15 03/09/2025, 08:21:20
2025-03-09 08:21:20,602 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0010 secs
2025-03-09 08:21:20,602 [INFO]: 		-> Adding the vectors to the index 03/09/2025, 08:21:20
2025-03-09 08:21:20,602 [INFO]: The memory available for adding the vectors is 49.3GB(total available - used by the index)
2025-03-09 08:21:20,602 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/16 [00:00<?, ?it/s]  6%|▋         | 1/16 [00:00<00:02,  5.65it/s] 19%|█▉        | 3/16 [00:00<00:01,  9.53it/s] 31%|███▏      | 5/16 [00:00<00:01, 10.96it/s] 44%|████▍     | 7/16 [00:00<00:00, 11.69it/s] 56%|█████▋    | 9/16 [00:00<00:00, 12.21it/s] 69%|██████▉   | 11/16 [00:00<00:00, 12.31it/s] 81%|████████▏ | 13/16 [00:01<00:00, 12.35it/s] 94%|█████████▍| 15/16 [00:01<00:00, 12.17it/s]100%|██████████| 16/16 [00:03<00:00,  4.01it/s]
2025-03-09 08:21:24,604 [INFO]: 	Computing best hyperparameters for index knn.index 03/09/2025, 08:21:24
2025-03-09 08:22:01,826 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 37.2208 secs
2025-03-09 08:22:01,826 [INFO]: The best hyperparameters are: efSearch=220
2025-03-09 08:22:01,826 [INFO]: 	Compute fast metrics 03/09/2025, 08:22:01
  0%|          | 0/4 [00:00<?, ?it/s] 25%|██▌       | 1/4 [00:00<00:00,  5.65it/s] 50%|█████     | 2/4 [00:00<00:00,  7.34it/s] 75%|███████▌  | 3/4 [00:00<00:00,  7.83it/s] 75%|███████▌  | 3/4 [00:00<00:00,  5.91it/s]
2025-03-09 08:22:20,419 [INFO]: 	>>> Finished "Compute fast metrics" in 18.5925 secs
2025-03-09 08:22:20,421 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 59.8192 secs
2025-03-09 08:22:20,422 [INFO]: {
2025-03-09 08:22:20,422 [INFO]: 	index_key: HNSW15
2025-03-09 08:22:20,422 [INFO]: 	index_param: efSearch=220
2025-03-09 08:22:20,422 [INFO]: 	index_path: knn.index
2025-03-09 08:22:20,422 [INFO]: 	size in bytes: 790124110
2025-03-09 08:22:20,422 [INFO]: 	avg_search_speed_ms: 9.703599273341878
2025-03-09 08:22:20,422 [INFO]: 	99p_search_speed_ms: 13.033633143641056
2025-03-09 08:22:20,422 [INFO]: 	reconstruction error %: 0.0
2025-03-09 08:22:20,422 [INFO]: 	nb vectors: 4016
2025-03-09 08:22:20,422 [INFO]: 	vectors dimension: 49152
2025-03-09 08:22:20,422 [INFO]: 	compression ratio: 0.9993084858529377
2025-03-09 08:22:20,422 [INFO]: }
2025-03-09 08:22:20,422 [INFO]: 	>>> Finished "Creating the index" in 59.8207 secs
2025-03-09 08:22:20,422 [INFO]: >>> Finished "Launching the whole pipeline" in 59.8464 secs
2025-03-09 08:22:21: [retrieval_preprocessing] calculating distances ...
2025-03-09 08:22:21: [retrieval_preprocessing] finished and saved retrieval indices for episode 48210 [episode count 18/20]
[retrieval_preprocessing] for episode 49751 [episode count 19/20], we have num_retrieval=np.int64(3895) num_query=np.int64(289)
2025-03-09 08:22:23,398 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-09 08:22:23,954 [INFO]: Launching the whole pipeline 03/09/2025, 08:22:23
2025-03-09 08:22:23,954 [INFO]: Reading total number of vectors and dimension 03/09/2025, 08:22:23
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1522.99it/s]
2025-03-09 08:22:23,980 [INFO]: There are 3895 embeddings of dim 49152
2025-03-09 08:22:23,980 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0258 secs
2025-03-09 08:22:23,980 [INFO]: 	Compute estimated construction time of the index 03/09/2025, 08:22:23
2025-03-09 08:22:23,980 [INFO]: 		-> Train: 16.7 minutes
2025-03-09 08:22:23,980 [INFO]: 		-> Add: 2.1 seconds
2025-03-09 08:22:23,980 [INFO]: 		Total: 16.7 minutes
2025-03-09 08:22:23,980 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0001 secs
2025-03-09 08:22:23,980 [INFO]: 	Checking that your have enough memory available to create the index 03/09/2025, 08:22:23
2025-03-09 08:22:23,981 [INFO]: 803.8MB of memory will be needed to build the index (more might be used if you have more)
2025-03-09 08:22:23,981 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0001 secs
2025-03-09 08:22:23,981 [INFO]: 	Selecting most promising index types given data characteristics 03/09/2025, 08:22:23
2025-03-09 08:22:23,981 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-09 08:22:23,981 [INFO]: 	Creating the index 03/09/2025, 08:22:23
2025-03-09 08:22:23,981 [INFO]: 		-> Instanciate the index HNSW15 03/09/2025, 08:22:23
2025-03-09 08:22:23,982 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0010 secs
2025-03-09 08:22:23,982 [INFO]: 		-> Adding the vectors to the index 03/09/2025, 08:22:23
2025-03-09 08:22:23,982 [INFO]: The memory available for adding the vectors is 49.3GB(total available - used by the index)
2025-03-09 08:22:23,982 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/16 [00:00<?, ?it/s]  6%|▋         | 1/16 [00:00<00:02,  6.36it/s] 19%|█▉        | 3/16 [00:00<00:01, 10.21it/s] 31%|███▏      | 5/16 [00:00<00:00, 11.41it/s] 44%|████▍     | 7/16 [00:00<00:00, 11.83it/s] 56%|█████▋    | 9/16 [00:00<00:00, 12.22it/s] 69%|██████▉   | 11/16 [00:00<00:00, 12.28it/s] 81%|████████▏ | 13/16 [00:01<00:00, 12.04it/s] 94%|█████████▍| 15/16 [00:01<00:00, 11.78it/s]100%|██████████| 16/16 [00:04<00:00,  3.53it/s]
2025-03-09 08:22:28,523 [INFO]: 	Computing best hyperparameters for index knn.index 03/09/2025, 08:22:28
2025-03-09 08:23:12,113 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 43.5901 secs
2025-03-09 08:23:12,114 [INFO]: The best hyperparameters are: efSearch=199
2025-03-09 08:23:12,114 [INFO]: 	Compute fast metrics 03/09/2025, 08:23:12
  0%|          | 0/4 [00:00<?, ?it/s] 25%|██▌       | 1/4 [00:00<00:00,  5.77it/s] 50%|█████     | 2/4 [00:00<00:00,  7.63it/s] 75%|███████▌  | 3/4 [00:00<00:00,  8.28it/s] 75%|███████▌  | 3/4 [00:00<00:00,  6.16it/s]
2025-03-09 08:23:32,282 [INFO]: 	>>> Finished "Compute fast metrics" in 20.1684 secs
2025-03-09 08:23:32,285 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 68.3031 secs
2025-03-09 08:23:32,285 [INFO]: {
2025-03-09 08:23:32,285 [INFO]: 	index_key: HNSW15
2025-03-09 08:23:32,285 [INFO]: 	index_param: efSearch=199
2025-03-09 08:23:32,285 [INFO]: 	index_path: knn.index
2025-03-09 08:23:32,285 [INFO]: 	size in bytes: 766317850
2025-03-09 08:23:32,285 [INFO]: 	avg_search_speed_ms: 10.0711888327917
2025-03-09 08:23:32,285 [INFO]: 	99p_search_speed_ms: 17.583147091791044
2025-03-09 08:23:32,285 [INFO]: 	reconstruction error %: 0.0
2025-03-09 08:23:32,286 [INFO]: 	nb vectors: 3895
2025-03-09 08:23:32,286 [INFO]: 	vectors dimension: 49152
2025-03-09 08:23:32,286 [INFO]: 	compression ratio: 0.9993087855124345
2025-03-09 08:23:32,286 [INFO]: }
2025-03-09 08:23:32,286 [INFO]: 	>>> Finished "Creating the index" in 68.3046 secs
2025-03-09 08:23:32,286 [INFO]: >>> Finished "Launching the whole pipeline" in 68.3312 secs
2025-03-09 08:23:33: [retrieval_preprocessing] calculating distances ...
2025-03-09 08:23:34: [retrieval_preprocessing] finished and saved retrieval indices for episode 49751 [episode count 19/20]
2025-03-09 08:23:34: [retrieval_preprocessing] finished for (5507987860, 'marker') [chosen_id count 4/10]
2025-03-09 08:23:37: [retrieval_preprocessing] concatenated all embeddings and indices for 20 episodes for (8898968162, 'block') [chosen_id count 5/10]
2025-03-09 08:23:37: [retrieval_preprocessing] we have num_total=2720 embedding_dim=49152
[retrieval_preprocessing] for episode 3840 [episode count 0/20], we have num_retrieval=np.int64(2563) num_query=np.int64(157)
2025-03-09 08:23:37,994 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-09 08:23:38,345 [INFO]: Launching the whole pipeline 03/09/2025, 08:23:38
2025-03-09 08:23:38,345 [INFO]: Reading total number of vectors and dimension 03/09/2025, 08:23:38
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1310.31it/s]
2025-03-09 08:23:38,372 [INFO]: There are 2563 embeddings of dim 49152
2025-03-09 08:23:38,372 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0268 secs
2025-03-09 08:23:38,372 [INFO]: 	Compute estimated construction time of the index 03/09/2025, 08:23:38
2025-03-09 08:23:38,372 [INFO]: 		-> Train: 16.7 minutes
2025-03-09 08:23:38,372 [INFO]: 		-> Add: 1.4 seconds
2025-03-09 08:23:38,372 [INFO]: 		Total: 16.7 minutes
2025-03-09 08:23:38,372 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0001 secs
2025-03-09 08:23:38,372 [INFO]: 	Checking that your have enough memory available to create the index 03/09/2025, 08:23:38
2025-03-09 08:23:38,372 [INFO]: 528.9MB of memory will be needed to build the index (more might be used if you have more)
2025-03-09 08:23:38,372 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0002 secs
2025-03-09 08:23:38,372 [INFO]: 	Selecting most promising index types given data characteristics 03/09/2025, 08:23:38
2025-03-09 08:23:38,372 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-09 08:23:38,372 [INFO]: 	Creating the index 03/09/2025, 08:23:38
2025-03-09 08:23:38,373 [INFO]: 		-> Instanciate the index HNSW15 03/09/2025, 08:23:38
2025-03-09 08:23:38,374 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0012 secs
2025-03-09 08:23:38,374 [INFO]: 		-> Adding the vectors to the index 03/09/2025, 08:23:38
2025-03-09 08:23:38,374 [INFO]: The memory available for adding the vectors is 49.5GB(total available - used by the index)
2025-03-09 08:23:38,374 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/11 [00:00<?, ?it/s]  9%|▉         | 1/11 [00:00<00:01,  6.91it/s] 27%|██▋       | 3/11 [00:00<00:00,  9.75it/s] 45%|████▌     | 5/11 [00:00<00:00, 11.00it/s] 64%|██████▎   | 7/11 [00:00<00:00, 11.50it/s] 82%|████████▏ | 9/11 [00:00<00:00, 11.75it/s]100%|██████████| 11/11 [00:02<00:00,  2.47it/s]100%|██████████| 11/11 [00:02<00:00,  3.91it/s]
2025-03-09 08:23:41,187 [INFO]: 	Computing best hyperparameters for index knn.index 03/09/2025, 08:23:41
2025-03-09 08:24:09,710 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 28.5224 secs
2025-03-09 08:24:09,710 [INFO]: The best hyperparameters are: efSearch=263
2025-03-09 08:24:09,710 [INFO]: 	Compute fast metrics 03/09/2025, 08:24:09
  0%|          | 0/4 [00:00<?, ?it/s] 25%|██▌       | 1/4 [00:00<00:00,  6.55it/s] 50%|█████     | 2/4 [00:00<00:00,  7.77it/s] 75%|███████▌  | 3/4 [00:00<00:00,  8.28it/s] 75%|███████▌  | 3/4 [00:00<00:00,  6.33it/s]
2025-03-09 08:24:28,440 [INFO]: 	>>> Finished "Compute fast metrics" in 18.7295 secs
2025-03-09 08:24:28,442 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 50.0680 secs
2025-03-09 08:24:28,442 [INFO]: {
2025-03-09 08:24:28,442 [INFO]: 	index_key: HNSW15
2025-03-09 08:24:28,442 [INFO]: 	index_param: efSearch=263
2025-03-09 08:24:28,442 [INFO]: 	index_path: knn.index
2025-03-09 08:24:28,442 [INFO]: 	size in bytes: 504254410
2025-03-09 08:24:28,442 [INFO]: 	avg_search_speed_ms: 10.466997356302102
2025-03-09 08:24:28,442 [INFO]: 	99p_search_speed_ms: 16.695385996717967
2025-03-09 08:24:28,442 [INFO]: 	reconstruction error %: 0.0
2025-03-09 08:24:28,442 [INFO]: 	nb vectors: 2563
2025-03-09 08:24:28,442 [INFO]: 	vectors dimension: 49152
2025-03-09 08:24:28,442 [INFO]: 	compression ratio: 0.9993096619621036
2025-03-09 08:24:28,442 [INFO]: }
2025-03-09 08:24:28,442 [INFO]: 	>>> Finished "Creating the index" in 50.0696 secs
2025-03-09 08:24:28,442 [INFO]: >>> Finished "Launching the whole pipeline" in 50.0973 secs
2025-03-09 08:24:29: [retrieval_preprocessing] calculating distances ...
2025-03-09 08:24:30: [retrieval_preprocessing] finished and saved retrieval indices for episode 3840 [episode count 0/20]
[retrieval_preprocessing] for episode 82816 [episode count 1/20], we have num_retrieval=np.int64(2616) num_query=np.int64(104)
2025-03-09 08:24:30,298 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-09 08:24:30,650 [INFO]: Launching the whole pipeline 03/09/2025, 08:24:30
2025-03-09 08:24:30,650 [INFO]: Reading total number of vectors and dimension 03/09/2025, 08:24:30
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 2101.35it/s]
2025-03-09 08:24:30,675 [INFO]: There are 2616 embeddings of dim 49152
2025-03-09 08:24:30,675 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0251 secs
2025-03-09 08:24:30,675 [INFO]: 	Compute estimated construction time of the index 03/09/2025, 08:24:30
2025-03-09 08:24:30,676 [INFO]: 		-> Train: 16.7 minutes
2025-03-09 08:24:30,676 [INFO]: 		-> Add: 1.4 seconds
2025-03-09 08:24:30,676 [INFO]: 		Total: 16.7 minutes
2025-03-09 08:24:30,676 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0005 secs
2025-03-09 08:24:30,676 [INFO]: 	Checking that your have enough memory available to create the index 03/09/2025, 08:24:30
2025-03-09 08:24:30,676 [INFO]: 539.9MB of memory will be needed to build the index (more might be used if you have more)
2025-03-09 08:24:30,677 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0004 secs
2025-03-09 08:24:30,677 [INFO]: 	Selecting most promising index types given data characteristics 03/09/2025, 08:24:30
2025-03-09 08:24:30,677 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-09 08:24:30,677 [INFO]: 	Creating the index 03/09/2025, 08:24:30
2025-03-09 08:24:30,677 [INFO]: 		-> Instanciate the index HNSW15 03/09/2025, 08:24:30
2025-03-09 08:24:30,680 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0030 secs
2025-03-09 08:24:30,681 [INFO]: 		-> Adding the vectors to the index 03/09/2025, 08:24:30
2025-03-09 08:24:30,681 [INFO]: The memory available for adding the vectors is 49.5GB(total available - used by the index)
2025-03-09 08:24:30,681 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/11 [00:00<?, ?it/s]  9%|▉         | 1/11 [00:00<00:01,  5.96it/s] 27%|██▋       | 3/11 [00:00<00:00,  9.82it/s] 45%|████▌     | 5/11 [00:00<00:00, 10.52it/s] 64%|██████▎   | 7/11 [00:00<00:00, 10.60it/s] 82%|████████▏ | 9/11 [00:00<00:00, 10.69it/s]100%|██████████| 11/11 [00:02<00:00,  2.49it/s]100%|██████████| 11/11 [00:02<00:00,  3.90it/s]
2025-03-09 08:24:33,505 [INFO]: 	Computing best hyperparameters for index knn.index 03/09/2025, 08:24:33
2025-03-09 08:25:05,316 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 31.8108 secs
2025-03-09 08:25:05,316 [INFO]: The best hyperparameters are: efSearch=277
2025-03-09 08:25:05,316 [INFO]: 	Compute fast metrics 03/09/2025, 08:25:05
  0%|          | 0/4 [00:00<?, ?it/s] 25%|██▌       | 1/4 [00:00<00:00,  5.50it/s] 50%|█████     | 2/4 [00:00<00:00,  7.22it/s] 75%|███████▌  | 3/4 [00:00<00:00,  7.38it/s]
2025-03-09 08:25:22,679 [INFO]: 	>>> Finished "Compute fast metrics" in 17.3626 secs
2025-03-09 08:25:22,793 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 52.1123 secs
2025-03-09 08:25:22,793 [INFO]: {
2025-03-09 08:25:22,793 [INFO]: 	index_key: HNSW15
2025-03-09 08:25:22,793 [INFO]: 	index_param: efSearch=277
2025-03-09 08:25:22,794 [INFO]: 	index_path: knn.index
2025-03-09 08:25:22,794 [INFO]: 	size in bytes: 514681990
2025-03-09 08:25:22,794 [INFO]: 	avg_search_speed_ms: 8.985754707870003
2025-03-09 08:25:22,794 [INFO]: 	99p_search_speed_ms: 12.992176953703163
2025-03-09 08:25:22,794 [INFO]: 	reconstruction error %: 0.0
2025-03-09 08:25:22,794 [INFO]: 	nb vectors: 2616
2025-03-09 08:25:22,794 [INFO]: 	vectors dimension: 49152
2025-03-09 08:25:22,794 [INFO]: 	compression ratio: 0.9993093560549885
2025-03-09 08:25:22,794 [INFO]: }
2025-03-09 08:25:22,794 [INFO]: 	>>> Finished "Creating the index" in 52.1169 secs
2025-03-09 08:25:22,794 [INFO]: >>> Finished "Launching the whole pipeline" in 52.1439 secs
2025-03-09 08:25:23: [retrieval_preprocessing] calculating distances ...
2025-03-09 08:25:23: [retrieval_preprocessing] finished and saved retrieval indices for episode 82816 [episode count 1/20]
[retrieval_preprocessing] for episode 3714 [episode count 2/20], we have num_retrieval=np.int64(2570) num_query=np.int64(150)
2025-03-09 08:25:24,523 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-09 08:25:24,903 [INFO]: Launching the whole pipeline 03/09/2025, 08:25:24
2025-03-09 08:25:24,903 [INFO]: Reading total number of vectors and dimension 03/09/2025, 08:25:24
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1489.45it/s]
2025-03-09 08:25:24,931 [INFO]: There are 2570 embeddings of dim 49152
2025-03-09 08:25:24,932 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0289 secs
2025-03-09 08:25:24,932 [INFO]: 	Compute estimated construction time of the index 03/09/2025, 08:25:24
2025-03-09 08:25:24,932 [INFO]: 		-> Train: 16.7 minutes
2025-03-09 08:25:24,932 [INFO]: 		-> Add: 1.4 seconds
2025-03-09 08:25:24,932 [INFO]: 		Total: 16.7 minutes
2025-03-09 08:25:24,932 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0004 secs
2025-03-09 08:25:24,932 [INFO]: 	Checking that your have enough memory available to create the index 03/09/2025, 08:25:24
2025-03-09 08:25:24,933 [INFO]: 530.4MB of memory will be needed to build the index (more might be used if you have more)
2025-03-09 08:25:24,933 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0004 secs
2025-03-09 08:25:24,933 [INFO]: 	Selecting most promising index types given data characteristics 03/09/2025, 08:25:24
2025-03-09 08:25:24,933 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-09 08:25:24,933 [INFO]: 	Creating the index 03/09/2025, 08:25:24
2025-03-09 08:25:24,933 [INFO]: 		-> Instanciate the index HNSW15 03/09/2025, 08:25:24
2025-03-09 08:25:24,936 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0027 secs
2025-03-09 08:25:24,936 [INFO]: 		-> Adding the vectors to the index 03/09/2025, 08:25:24
2025-03-09 08:25:24,937 [INFO]: The memory available for adding the vectors is 49.5GB(total available - used by the index)
2025-03-09 08:25:24,937 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/11 [00:00<?, ?it/s]  9%|▉         | 1/11 [00:00<00:01,  8.17it/s] 27%|██▋       | 3/11 [00:00<00:00, 12.28it/s] 45%|████▌     | 5/11 [00:00<00:00, 12.65it/s] 64%|██████▎   | 7/11 [00:00<00:00, 12.83it/s] 82%|████████▏ | 9/11 [00:00<00:00, 13.01it/s]100%|██████████| 11/11 [00:02<00:00,  2.85it/s]100%|██████████| 11/11 [00:02<00:00,  4.52it/s]
2025-03-09 08:25:27,378 [INFO]: 	Computing best hyperparameters for index knn.index 03/09/2025, 08:25:27
2025-03-09 08:25:58,185 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 30.8066 secs
2025-03-09 08:25:58,185 [INFO]: The best hyperparameters are: efSearch=300
2025-03-09 08:25:58,185 [INFO]: 	Compute fast metrics 03/09/2025, 08:25:58
  0%|          | 0/4 [00:00<?, ?it/s] 25%|██▌       | 1/4 [00:00<00:00,  5.43it/s] 50%|█████     | 2/4 [00:00<00:00,  6.94it/s] 75%|███████▌  | 3/4 [00:00<00:00,  7.72it/s] 75%|███████▌  | 3/4 [00:00<00:00,  5.82it/s]
2025-03-09 08:26:14,790 [INFO]: 	>>> Finished "Compute fast metrics" in 16.6051 secs
2025-03-09 08:26:14,792 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 49.8555 secs
2025-03-09 08:26:14,792 [INFO]: {
2025-03-09 08:26:14,792 [INFO]: 	index_key: HNSW15
2025-03-09 08:26:14,792 [INFO]: 	index_param: efSearch=300
2025-03-09 08:26:14,792 [INFO]: 	index_path: knn.index
2025-03-09 08:26:14,792 [INFO]: 	size in bytes: 505631590
2025-03-09 08:26:14,792 [INFO]: 	avg_search_speed_ms: 10.659793054740598
2025-03-09 08:26:14,792 [INFO]: 	99p_search_speed_ms: 13.813057148363441
2025-03-09 08:26:14,792 [INFO]: 	reconstruction error %: 0.0
2025-03-09 08:26:14,792 [INFO]: 	nb vectors: 2570
2025-03-09 08:26:14,792 [INFO]: 	vectors dimension: 49152
2025-03-09 08:26:14,792 [INFO]: 	compression ratio: 0.999309714806387
2025-03-09 08:26:14,792 [INFO]: }
2025-03-09 08:26:14,793 [INFO]: 	>>> Finished "Creating the index" in 49.8593 secs
2025-03-09 08:26:14,793 [INFO]: >>> Finished "Launching the whole pipeline" in 49.8898 secs
2025-03-09 08:26:15: [retrieval_preprocessing] calculating distances ...
2025-03-09 08:26:15: [retrieval_preprocessing] finished and saved retrieval indices for episode 3714 [episode count 2/20]
[retrieval_preprocessing] for episode 27138 [episode count 3/20], we have num_retrieval=np.int64(2552) num_query=np.int64(168)
2025-03-09 08:26:16,753 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-09 08:26:17,079 [INFO]: Launching the whole pipeline 03/09/2025, 08:26:17
2025-03-09 08:26:17,079 [INFO]: Reading total number of vectors and dimension 03/09/2025, 08:26:17
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1025.50it/s]
2025-03-09 08:26:17,107 [INFO]: There are 2552 embeddings of dim 49152
2025-03-09 08:26:17,108 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0286 secs
2025-03-09 08:26:17,108 [INFO]: 	Compute estimated construction time of the index 03/09/2025, 08:26:17
2025-03-09 08:26:17,108 [INFO]: 		-> Train: 16.7 minutes
2025-03-09 08:26:17,108 [INFO]: 		-> Add: 1.4 seconds
2025-03-09 08:26:17,108 [INFO]: 		Total: 16.7 minutes
2025-03-09 08:26:17,108 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0003 secs
2025-03-09 08:26:17,109 [INFO]: 	Checking that your have enough memory available to create the index 03/09/2025, 08:26:17
2025-03-09 08:26:17,109 [INFO]: 526.7MB of memory will be needed to build the index (more might be used if you have more)
2025-03-09 08:26:17,109 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0004 secs
2025-03-09 08:26:17,109 [INFO]: 	Selecting most promising index types given data characteristics 03/09/2025, 08:26:17
2025-03-09 08:26:17,109 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-09 08:26:17,109 [INFO]: 	Creating the index 03/09/2025, 08:26:17
2025-03-09 08:26:17,109 [INFO]: 		-> Instanciate the index HNSW15 03/09/2025, 08:26:17
2025-03-09 08:26:17,112 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0028 secs
2025-03-09 08:26:17,113 [INFO]: 		-> Adding the vectors to the index 03/09/2025, 08:26:17
2025-03-09 08:26:17,113 [INFO]: The memory available for adding the vectors is 49.5GB(total available - used by the index)
2025-03-09 08:26:17,113 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/11 [00:00<?, ?it/s]  9%|▉         | 1/11 [00:00<00:01,  7.04it/s] 27%|██▋       | 3/11 [00:00<00:00, 10.35it/s] 45%|████▌     | 5/11 [00:00<00:00, 11.55it/s] 64%|██████▎   | 7/11 [00:00<00:00, 12.00it/s] 82%|████████▏ | 9/11 [00:00<00:00, 12.18it/s]100%|██████████| 11/11 [00:02<00:00,  2.99it/s]100%|██████████| 11/11 [00:02<00:00,  4.62it/s]
2025-03-09 08:26:19,502 [INFO]: 	Computing best hyperparameters for index knn.index 03/09/2025, 08:26:19
2025-03-09 08:26:46,188 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 26.6851 secs
2025-03-09 08:26:46,188 [INFO]: The best hyperparameters are: efSearch=260
2025-03-09 08:26:46,188 [INFO]: 	Compute fast metrics 03/09/2025, 08:26:46
  0%|          | 0/4 [00:00<?, ?it/s] 25%|██▌       | 1/4 [00:00<00:00,  6.23it/s] 75%|███████▌  | 3/4 [00:00<00:00,  9.34it/s] 75%|███████▌  | 3/4 [00:00<00:00,  7.20it/s]
2025-03-09 08:27:00,630 [INFO]: 	>>> Finished "Compute fast metrics" in 14.4426 secs
2025-03-09 08:27:00,632 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 43.5196 secs
2025-03-09 08:27:00,633 [INFO]: {
2025-03-09 08:27:00,633 [INFO]: 	index_key: HNSW15
2025-03-09 08:27:00,633 [INFO]: 	index_param: efSearch=260
2025-03-09 08:27:00,633 [INFO]: 	index_path: knn.index
2025-03-09 08:27:00,633 [INFO]: 	size in bytes: 502090270
2025-03-09 08:27:00,633 [INFO]: 	avg_search_speed_ms: 10.12866056841263
2025-03-09 08:27:00,633 [INFO]: 	99p_search_speed_ms: 15.824803868308663
2025-03-09 08:27:00,633 [INFO]: 	reconstruction error %: 0.0
2025-03-09 08:27:00,633 [INFO]: 	nb vectors: 2552
2025-03-09 08:27:00,633 [INFO]: 	vectors dimension: 49152
2025-03-09 08:27:00,633 [INFO]: 	compression ratio: 0.9993095783353858
2025-03-09 08:27:00,633 [INFO]: }
2025-03-09 08:27:00,633 [INFO]: 	>>> Finished "Creating the index" in 43.5234 secs
2025-03-09 08:27:00,633 [INFO]: >>> Finished "Launching the whole pipeline" in 43.5536 secs
2025-03-09 08:27:01: [retrieval_preprocessing] calculating distances ...
2025-03-09 08:27:02: [retrieval_preprocessing] finished and saved retrieval indices for episode 27138 [episode count 3/20]
[retrieval_preprocessing] for episode 91777 [episode count 4/20], we have num_retrieval=np.int64(2569) num_query=np.int64(151)
2025-03-09 08:27:02,937 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-09 08:27:03,289 [INFO]: Launching the whole pipeline 03/09/2025, 08:27:03
2025-03-09 08:27:03,289 [INFO]: Reading total number of vectors and dimension 03/09/2025, 08:27:03
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1628.86it/s]
2025-03-09 08:27:03,311 [INFO]: There are 2569 embeddings of dim 49152
2025-03-09 08:27:03,312 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0227 secs
2025-03-09 08:27:03,312 [INFO]: 	Compute estimated construction time of the index 03/09/2025, 08:27:03
2025-03-09 08:27:03,312 [INFO]: 		-> Train: 16.7 minutes
2025-03-09 08:27:03,312 [INFO]: 		-> Add: 1.4 seconds
2025-03-09 08:27:03,312 [INFO]: 		Total: 16.7 minutes
2025-03-09 08:27:03,312 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0001 secs
2025-03-09 08:27:03,312 [INFO]: 	Checking that your have enough memory available to create the index 03/09/2025, 08:27:03
2025-03-09 08:27:03,312 [INFO]: 530.2MB of memory will be needed to build the index (more might be used if you have more)
2025-03-09 08:27:03,312 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0001 secs
2025-03-09 08:27:03,312 [INFO]: 	Selecting most promising index types given data characteristics 03/09/2025, 08:27:03
2025-03-09 08:27:03,312 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-09 08:27:03,312 [INFO]: 	Creating the index 03/09/2025, 08:27:03
2025-03-09 08:27:03,312 [INFO]: 		-> Instanciate the index HNSW15 03/09/2025, 08:27:03
2025-03-09 08:27:03,313 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0009 secs
2025-03-09 08:27:03,313 [INFO]: 		-> Adding the vectors to the index 03/09/2025, 08:27:03
2025-03-09 08:27:03,313 [INFO]: The memory available for adding the vectors is 49.5GB(total available - used by the index)
2025-03-09 08:27:03,313 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/11 [00:00<?, ?it/s]  9%|▉         | 1/11 [00:00<00:01,  6.99it/s] 27%|██▋       | 3/11 [00:00<00:00, 10.36it/s] 45%|████▌     | 5/11 [00:00<00:00, 11.43it/s] 64%|██████▎   | 7/11 [00:00<00:00, 12.03it/s] 82%|████████▏ | 9/11 [00:00<00:00, 12.19it/s]100%|██████████| 11/11 [00:02<00:00,  2.88it/s]100%|██████████| 11/11 [00:02<00:00,  4.48it/s]
2025-03-09 08:27:05,774 [INFO]: 	Computing best hyperparameters for index knn.index 03/09/2025, 08:27:05
2025-03-09 08:27:45,750 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 39.9757 secs
2025-03-09 08:27:45,750 [INFO]: The best hyperparameters are: efSearch=168
2025-03-09 08:27:45,750 [INFO]: 	Compute fast metrics 03/09/2025, 08:27:45
  0%|          | 0/4 [00:00<?, ?it/s] 25%|██▌       | 1/4 [00:00<00:00,  5.40it/s] 50%|█████     | 2/4 [00:00<00:00,  6.89it/s] 75%|███████▌  | 3/4 [00:00<00:00,  7.69it/s] 75%|███████▌  | 3/4 [00:00<00:00,  5.84it/s]
2025-03-09 08:28:05,302 [INFO]: 	>>> Finished "Compute fast metrics" in 19.5522 secs
2025-03-09 08:28:05,305 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 61.9918 secs
2025-03-09 08:28:05,305 [INFO]: {
2025-03-09 08:28:05,305 [INFO]: 	index_key: HNSW15
2025-03-09 08:28:05,305 [INFO]: 	index_param: efSearch=168
2025-03-09 08:28:05,305 [INFO]: 	index_path: knn.index
2025-03-09 08:28:05,305 [INFO]: 	size in bytes: 505434850
2025-03-09 08:28:05,305 [INFO]: 	avg_search_speed_ms: 7.677372668120018
2025-03-09 08:28:05,305 [INFO]: 	99p_search_speed_ms: 13.713123667985203
2025-03-09 08:28:05,305 [INFO]: 	reconstruction error %: 0.0
2025-03-09 08:28:05,305 [INFO]: 	nb vectors: 2569
2025-03-09 08:28:05,305 [INFO]: 	vectors dimension: 49152
2025-03-09 08:28:05,305 [INFO]: 	compression ratio: 0.9993097072748347
2025-03-09 08:28:05,305 [INFO]: }
2025-03-09 08:28:05,305 [INFO]: 	>>> Finished "Creating the index" in 61.9932 secs
2025-03-09 08:28:05,305 [INFO]: >>> Finished "Launching the whole pipeline" in 62.0164 secs
2025-03-09 08:28:05: [retrieval_preprocessing] calculating distances ...
2025-03-09 08:28:06: [retrieval_preprocessing] finished and saved retrieval indices for episode 91777 [episode count 4/20]
[retrieval_preprocessing] for episode 17669 [episode count 5/20], we have num_retrieval=np.int64(2571) num_query=np.int64(149)
2025-03-09 08:28:07,212 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-09 08:28:07,621 [INFO]: Launching the whole pipeline 03/09/2025, 08:28:07
2025-03-09 08:28:07,621 [INFO]: Reading total number of vectors and dimension 03/09/2025, 08:28:07
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1266.40it/s]
2025-03-09 08:28:07,654 [INFO]: There are 2571 embeddings of dim 49152
2025-03-09 08:28:07,654 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0329 secs
2025-03-09 08:28:07,654 [INFO]: 	Compute estimated construction time of the index 03/09/2025, 08:28:07
2025-03-09 08:28:07,654 [INFO]: 		-> Train: 16.7 minutes
2025-03-09 08:28:07,654 [INFO]: 		-> Add: 1.4 seconds
2025-03-09 08:28:07,654 [INFO]: 		Total: 16.7 minutes
2025-03-09 08:28:07,654 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0001 secs
2025-03-09 08:28:07,655 [INFO]: 	Checking that your have enough memory available to create the index 03/09/2025, 08:28:07
2025-03-09 08:28:07,655 [INFO]: 530.6MB of memory will be needed to build the index (more might be used if you have more)
2025-03-09 08:28:07,655 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0002 secs
2025-03-09 08:28:07,655 [INFO]: 	Selecting most promising index types given data characteristics 03/09/2025, 08:28:07
2025-03-09 08:28:07,655 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-09 08:28:07,655 [INFO]: 	Creating the index 03/09/2025, 08:28:07
2025-03-09 08:28:07,655 [INFO]: 		-> Instanciate the index HNSW15 03/09/2025, 08:28:07
2025-03-09 08:28:07,656 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0011 secs
2025-03-09 08:28:07,656 [INFO]: 		-> Adding the vectors to the index 03/09/2025, 08:28:07
2025-03-09 08:28:07,656 [INFO]: The memory available for adding the vectors is 49.5GB(total available - used by the index)
2025-03-09 08:28:07,656 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/11 [00:00<?, ?it/s]  9%|▉         | 1/11 [00:00<00:01,  8.54it/s] 55%|█████▍    | 6/11 [00:00<00:00, 25.92it/s] 91%|█████████ | 10/11 [00:00<00:00, 30.86it/s]100%|██████████| 11/11 [00:02<00:00,  4.68it/s]
2025-03-09 08:28:10,014 [INFO]: 	Computing best hyperparameters for index knn.index 03/09/2025, 08:28:10
2025-03-09 08:28:48,264 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 38.2498 secs
2025-03-09 08:28:48,265 [INFO]: The best hyperparameters are: efSearch=171
2025-03-09 08:28:48,265 [INFO]: 	Compute fast metrics 03/09/2025, 08:28:48
  0%|          | 0/4 [00:00<?, ?it/s] 25%|██▌       | 1/4 [00:00<00:00,  5.44it/s] 50%|█████     | 2/4 [00:00<00:00,  6.74it/s] 75%|███████▌  | 3/4 [00:00<00:00,  7.03it/s] 75%|███████▌  | 3/4 [00:00<00:00,  5.30it/s]
2025-03-09 08:29:04,908 [INFO]: 	>>> Finished "Compute fast metrics" in 16.6433 secs
2025-03-09 08:29:05,034 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 57.3779 secs
2025-03-09 08:29:05,035 [INFO]: {
2025-03-09 08:29:05,035 [INFO]: 	index_key: HNSW15
2025-03-09 08:29:05,035 [INFO]: 	index_param: efSearch=171
2025-03-09 08:29:05,035 [INFO]: 	index_path: knn.index
2025-03-09 08:29:05,035 [INFO]: 	size in bytes: 505828330
2025-03-09 08:29:05,035 [INFO]: 	avg_search_speed_ms: 10.179688178887734
2025-03-09 08:29:05,035 [INFO]: 	99p_search_speed_ms: 14.728116230107833
2025-03-09 08:29:05,035 [INFO]: 	reconstruction error %: 0.0
2025-03-09 08:29:05,035 [INFO]: 	nb vectors: 2571
2025-03-09 08:29:05,035 [INFO]: 	vectors dimension: 49152
2025-03-09 08:29:05,035 [INFO]: 	compression ratio: 0.9993097223320805
2025-03-09 08:29:05,035 [INFO]: }
2025-03-09 08:29:05,035 [INFO]: 	>>> Finished "Creating the index" in 57.3804 secs
2025-03-09 08:29:05,035 [INFO]: >>> Finished "Launching the whole pipeline" in 57.4141 secs
2025-03-09 08:29:05: [retrieval_preprocessing] calculating distances ...
2025-03-09 08:29:06: [retrieval_preprocessing] finished and saved retrieval indices for episode 17669 [episode count 5/20]
[retrieval_preprocessing] for episode 36363 [episode count 6/20], we have num_retrieval=np.int64(2571) num_query=np.int64(149)
2025-03-09 08:29:06,952 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-09 08:29:07,303 [INFO]: Launching the whole pipeline 03/09/2025, 08:29:07
2025-03-09 08:29:07,304 [INFO]: Reading total number of vectors and dimension 03/09/2025, 08:29:07
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1266.78it/s]
2025-03-09 08:29:07,330 [INFO]: There are 2571 embeddings of dim 49152
2025-03-09 08:29:07,331 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0270 secs
2025-03-09 08:29:07,331 [INFO]: 	Compute estimated construction time of the index 03/09/2025, 08:29:07
2025-03-09 08:29:07,331 [INFO]: 		-> Train: 16.7 minutes
2025-03-09 08:29:07,331 [INFO]: 		-> Add: 1.4 seconds
2025-03-09 08:29:07,331 [INFO]: 		Total: 16.7 minutes
2025-03-09 08:29:07,331 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0001 secs
2025-03-09 08:29:07,331 [INFO]: 	Checking that your have enough memory available to create the index 03/09/2025, 08:29:07
2025-03-09 08:29:07,331 [INFO]: 530.6MB of memory will be needed to build the index (more might be used if you have more)
2025-03-09 08:29:07,331 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0002 secs
2025-03-09 08:29:07,331 [INFO]: 	Selecting most promising index types given data characteristics 03/09/2025, 08:29:07
2025-03-09 08:29:07,331 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-09 08:29:07,331 [INFO]: 	Creating the index 03/09/2025, 08:29:07
2025-03-09 08:29:07,331 [INFO]: 		-> Instanciate the index HNSW15 03/09/2025, 08:29:07
2025-03-09 08:29:07,332 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0009 secs
2025-03-09 08:29:07,332 [INFO]: 		-> Adding the vectors to the index 03/09/2025, 08:29:07
2025-03-09 08:29:07,332 [INFO]: The memory available for adding the vectors is 49.5GB(total available - used by the index)
2025-03-09 08:29:07,332 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/11 [00:00<?, ?it/s]  9%|▉         | 1/11 [00:00<00:01,  5.76it/s] 27%|██▋       | 3/11 [00:00<00:00,  9.23it/s] 45%|████▌     | 5/11 [00:00<00:00, 10.31it/s] 64%|██████▎   | 7/11 [00:00<00:00, 10.76it/s] 82%|████████▏ | 9/11 [00:00<00:00, 11.07it/s]100%|██████████| 11/11 [00:02<00:00,  2.44it/s]100%|██████████| 11/11 [00:02<00:00,  3.83it/s]
2025-03-09 08:29:10,210 [INFO]: 	Computing best hyperparameters for index knn.index 03/09/2025, 08:29:10
2025-03-09 08:29:47,164 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 36.9535 secs
2025-03-09 08:29:47,164 [INFO]: The best hyperparameters are: efSearch=202
2025-03-09 08:29:47,165 [INFO]: 	Compute fast metrics 03/09/2025, 08:29:47
  0%|          | 0/4 [00:00<?, ?it/s] 25%|██▌       | 1/4 [00:00<00:00,  7.32it/s] 50%|█████     | 2/4 [00:00<00:00,  8.26it/s] 75%|███████▌  | 3/4 [00:00<00:00,  8.55it/s] 75%|███████▌  | 3/4 [00:00<00:00,  6.56it/s]
2025-03-09 08:30:05,695 [INFO]: 	>>> Finished "Compute fast metrics" in 18.5302 secs
2025-03-09 08:30:05,697 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 58.3645 secs
2025-03-09 08:30:05,697 [INFO]: {
2025-03-09 08:30:05,697 [INFO]: 	index_key: HNSW15
2025-03-09 08:30:05,697 [INFO]: 	index_param: efSearch=202
2025-03-09 08:30:05,697 [INFO]: 	index_path: knn.index
2025-03-09 08:30:05,697 [INFO]: 	size in bytes: 505828330
2025-03-09 08:30:05,697 [INFO]: 	avg_search_speed_ms: 8.882150378203942
2025-03-09 08:30:05,697 [INFO]: 	99p_search_speed_ms: 16.541779856197536
2025-03-09 08:30:05,697 [INFO]: 	reconstruction error %: 0.0
2025-03-09 08:30:05,697 [INFO]: 	nb vectors: 2571
2025-03-09 08:30:05,697 [INFO]: 	vectors dimension: 49152
2025-03-09 08:30:05,697 [INFO]: 	compression ratio: 0.9993097223320805
2025-03-09 08:30:05,697 [INFO]: }
2025-03-09 08:30:05,697 [INFO]: 	>>> Finished "Creating the index" in 58.3659 secs
2025-03-09 08:30:05,697 [INFO]: >>> Finished "Launching the whole pipeline" in 58.3935 secs
2025-03-09 08:30:06: [retrieval_preprocessing] calculating distances ...
2025-03-09 08:30:06: [retrieval_preprocessing] finished and saved retrieval indices for episode 36363 [episode count 6/20]
[retrieval_preprocessing] for episode 95245 [episode count 7/20], we have num_retrieval=np.int64(2582) num_query=np.int64(138)
2025-03-09 08:30:07,503 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-09 08:30:08,061 [INFO]: Launching the whole pipeline 03/09/2025, 08:30:08
2025-03-09 08:30:08,061 [INFO]: Reading total number of vectors and dimension 03/09/2025, 08:30:08
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1352.13it/s]
2025-03-09 08:30:08,092 [INFO]: There are 2582 embeddings of dim 49152
2025-03-09 08:30:08,092 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0312 secs
2025-03-09 08:30:08,092 [INFO]: 	Compute estimated construction time of the index 03/09/2025, 08:30:08
2025-03-09 08:30:08,093 [INFO]: 		-> Train: 16.7 minutes
2025-03-09 08:30:08,093 [INFO]: 		-> Add: 1.4 seconds
2025-03-09 08:30:08,093 [INFO]: 		Total: 16.7 minutes
2025-03-09 08:30:08,093 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0003 secs
2025-03-09 08:30:08,093 [INFO]: 	Checking that your have enough memory available to create the index 03/09/2025, 08:30:08
2025-03-09 08:30:08,093 [INFO]: 532.9MB of memory will be needed to build the index (more might be used if you have more)
2025-03-09 08:30:08,093 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0005 secs
2025-03-09 08:30:08,093 [INFO]: 	Selecting most promising index types given data characteristics 03/09/2025, 08:30:08
2025-03-09 08:30:08,094 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-09 08:30:08,094 [INFO]: 	Creating the index 03/09/2025, 08:30:08
2025-03-09 08:30:08,094 [INFO]: 		-> Instanciate the index HNSW15 03/09/2025, 08:30:08
2025-03-09 08:30:08,096 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0025 secs
2025-03-09 08:30:08,097 [INFO]: 		-> Adding the vectors to the index 03/09/2025, 08:30:08
2025-03-09 08:30:08,097 [INFO]: The memory available for adding the vectors is 49.5GB(total available - used by the index)
2025-03-09 08:30:08,097 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/11 [00:00<?, ?it/s]  9%|▉         | 1/11 [00:00<00:01,  6.62it/s] 27%|██▋       | 3/11 [00:00<00:00, 10.31it/s] 45%|████▌     | 5/11 [00:00<00:00, 11.77it/s] 64%|██████▎   | 7/11 [00:00<00:00, 12.00it/s] 82%|████████▏ | 9/11 [00:00<00:00, 12.12it/s]100%|██████████| 11/11 [00:02<00:00,  2.76it/s]100%|██████████| 11/11 [00:02<00:00,  4.33it/s]
2025-03-09 08:30:10,645 [INFO]: 	Computing best hyperparameters for index knn.index 03/09/2025, 08:30:10
2025-03-09 08:30:48,301 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 37.6565 secs
2025-03-09 08:30:48,302 [INFO]: The best hyperparameters are: efSearch=237
2025-03-09 08:30:48,302 [INFO]: 	Compute fast metrics 03/09/2025, 08:30:48
  0%|          | 0/4 [00:00<?, ?it/s] 25%|██▌       | 1/4 [00:00<00:00,  6.30it/s] 75%|███████▌  | 3/4 [00:00<00:00,  9.79it/s] 75%|███████▌  | 3/4 [00:00<00:00,  7.68it/s]
2025-03-09 08:31:06,038 [INFO]: 	>>> Finished "Compute fast metrics" in 17.7357 secs
2025-03-09 08:31:06,039 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 57.9426 secs
2025-03-09 08:31:06,039 [INFO]: {
2025-03-09 08:31:06,040 [INFO]: 	index_key: HNSW15
2025-03-09 08:31:06,040 [INFO]: 	index_param: efSearch=237
2025-03-09 08:31:06,040 [INFO]: 	index_path: knn.index
2025-03-09 08:31:06,040 [INFO]: 	size in bytes: 507992650
2025-03-09 08:31:06,040 [INFO]: 	avg_search_speed_ms: 9.012949392241469
2025-03-09 08:31:06,040 [INFO]: 	99p_search_speed_ms: 14.34534972300753
2025-03-09 08:31:06,040 [INFO]: 	reconstruction error %: 0.0
2025-03-09 08:31:06,040 [INFO]: 	nb vectors: 2582
2025-03-09 08:31:06,040 [INFO]: 	vectors dimension: 49152
2025-03-09 08:31:06,040 [INFO]: 	compression ratio: 0.9993094506387051
2025-03-09 08:31:06,040 [INFO]: }
2025-03-09 08:31:06,040 [INFO]: 	>>> Finished "Creating the index" in 57.9459 secs
2025-03-09 08:31:06,040 [INFO]: >>> Finished "Launching the whole pipeline" in 57.9787 secs
2025-03-09 08:31:06: [retrieval_preprocessing] calculating distances ...
2025-03-09 08:31:07: [retrieval_preprocessing] finished and saved retrieval indices for episode 95245 [episode count 7/20]
[retrieval_preprocessing] for episode 69646 [episode count 8/20], we have num_retrieval=np.int64(2595) num_query=np.int64(125)
2025-03-09 08:31:08,617 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-09 08:31:09,045 [INFO]: Launching the whole pipeline 03/09/2025, 08:31:09
2025-03-09 08:31:09,045 [INFO]: Reading total number of vectors and dimension 03/09/2025, 08:31:09
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1210.83it/s]
2025-03-09 08:31:09,076 [INFO]: There are 2595 embeddings of dim 49152
2025-03-09 08:31:09,077 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0318 secs
2025-03-09 08:31:09,077 [INFO]: 	Compute estimated construction time of the index 03/09/2025, 08:31:09
2025-03-09 08:31:09,077 [INFO]: 		-> Train: 16.7 minutes
2025-03-09 08:31:09,077 [INFO]: 		-> Add: 1.4 seconds
2025-03-09 08:31:09,077 [INFO]: 		Total: 16.7 minutes
2025-03-09 08:31:09,077 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0004 secs
2025-03-09 08:31:09,077 [INFO]: 	Checking that your have enough memory available to create the index 03/09/2025, 08:31:09
2025-03-09 08:31:09,078 [INFO]: 535.5MB of memory will be needed to build the index (more might be used if you have more)
2025-03-09 08:31:09,078 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0004 secs
2025-03-09 08:31:09,078 [INFO]: 	Selecting most promising index types given data characteristics 03/09/2025, 08:31:09
2025-03-09 08:31:09,078 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-09 08:31:09,078 [INFO]: 	Creating the index 03/09/2025, 08:31:09
2025-03-09 08:31:09,078 [INFO]: 		-> Instanciate the index HNSW15 03/09/2025, 08:31:09
2025-03-09 08:31:09,081 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0028 secs
2025-03-09 08:31:09,081 [INFO]: 		-> Adding the vectors to the index 03/09/2025, 08:31:09
2025-03-09 08:31:09,082 [INFO]: The memory available for adding the vectors is 49.5GB(total available - used by the index)
2025-03-09 08:31:09,082 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/11 [00:00<?, ?it/s]  9%|▉         | 1/11 [00:00<00:01,  5.94it/s] 18%|█▊        | 2/11 [00:00<00:01,  7.63it/s] 36%|███▋      | 4/11 [00:00<00:00, 10.62it/s] 55%|█████▍    | 6/11 [00:00<00:00,  9.82it/s] 73%|███████▎  | 8/11 [00:00<00:00,  9.16it/s] 82%|████████▏ | 9/11 [00:01<00:00,  8.93it/s] 91%|█████████ | 10/11 [00:01<00:00,  7.66it/s]100%|██████████| 11/11 [00:03<00:00,  1.70it/s]100%|██████████| 11/11 [00:03<00:00,  3.55it/s]
2025-03-09 08:31:12,186 [INFO]: 	Computing best hyperparameters for index knn.index 03/09/2025, 08:31:12
2025-03-09 08:31:43,903 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 31.7168 secs
2025-03-09 08:31:43,904 [INFO]: The best hyperparameters are: efSearch=287
2025-03-09 08:31:43,904 [INFO]: 	Compute fast metrics 03/09/2025, 08:31:43
  0%|          | 0/4 [00:00<?, ?it/s] 25%|██▌       | 1/4 [00:00<00:00,  7.36it/s] 75%|███████▌  | 3/4 [00:00<00:00, 14.79it/s]
2025-03-09 08:31:57,663 [INFO]: 	>>> Finished "Compute fast metrics" in 13.7587 secs
2025-03-09 08:31:57,666 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 48.5841 secs
2025-03-09 08:31:57,666 [INFO]: {
2025-03-09 08:31:57,666 [INFO]: 	index_key: HNSW15
2025-03-09 08:31:57,666 [INFO]: 	index_param: efSearch=287
2025-03-09 08:31:57,666 [INFO]: 	index_path: knn.index
2025-03-09 08:31:57,666 [INFO]: 	size in bytes: 510550330
2025-03-09 08:31:57,666 [INFO]: 	avg_search_speed_ms: 16.20648623915829
2025-03-09 08:31:57,666 [INFO]: 	99p_search_speed_ms: 53.651317092590425
2025-03-09 08:31:57,666 [INFO]: 	reconstruction error %: 0.0
2025-03-09 08:31:57,666 [INFO]: 	nb vectors: 2595
2025-03-09 08:31:57,666 [INFO]: 	vectors dimension: 49152
2025-03-09 08:31:57,666 [INFO]: 	compression ratio: 0.9993094314521352
2025-03-09 08:31:57,666 [INFO]: }
2025-03-09 08:31:57,666 [INFO]: 	>>> Finished "Creating the index" in 48.5883 secs
2025-03-09 08:31:57,666 [INFO]: >>> Finished "Launching the whole pipeline" in 48.6218 secs
2025-03-09 08:31:59: [retrieval_preprocessing] calculating distances ...
2025-03-09 08:31:59: [retrieval_preprocessing] finished and saved retrieval indices for episode 69646 [episode count 8/20]
[retrieval_preprocessing] for episode 80912 [episode count 9/20], we have num_retrieval=np.int64(2606) num_query=np.int64(114)
2025-03-09 08:31:59,815 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-09 08:32:00,529 [INFO]: Launching the whole pipeline 03/09/2025, 08:32:00
2025-03-09 08:32:00,529 [INFO]: Reading total number of vectors and dimension 03/09/2025, 08:32:00
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1339.18it/s]
2025-03-09 08:32:00,560 [INFO]: There are 2606 embeddings of dim 49152
2025-03-09 08:32:00,560 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0313 secs
2025-03-09 08:32:00,561 [INFO]: 	Compute estimated construction time of the index 03/09/2025, 08:32:00
2025-03-09 08:32:00,561 [INFO]: 		-> Train: 16.7 minutes
2025-03-09 08:32:00,561 [INFO]: 		-> Add: 1.4 seconds
2025-03-09 08:32:00,561 [INFO]: 		Total: 16.7 minutes
2025-03-09 08:32:00,561 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0002 secs
2025-03-09 08:32:00,561 [INFO]: 	Checking that your have enough memory available to create the index 03/09/2025, 08:32:00
2025-03-09 08:32:00,561 [INFO]: 537.8MB of memory will be needed to build the index (more might be used if you have more)
2025-03-09 08:32:00,561 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0002 secs
2025-03-09 08:32:00,561 [INFO]: 	Selecting most promising index types given data characteristics 03/09/2025, 08:32:00
2025-03-09 08:32:00,561 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-09 08:32:00,561 [INFO]: 	Creating the index 03/09/2025, 08:32:00
2025-03-09 08:32:00,561 [INFO]: 		-> Instanciate the index HNSW15 03/09/2025, 08:32:00
2025-03-09 08:32:00,563 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0013 secs
2025-03-09 08:32:00,563 [INFO]: 		-> Adding the vectors to the index 03/09/2025, 08:32:00
2025-03-09 08:32:00,563 [INFO]: The memory available for adding the vectors is 49.5GB(total available - used by the index)
2025-03-09 08:32:00,563 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/11 [00:00<?, ?it/s]  9%|▉         | 1/11 [00:00<00:01,  7.76it/s] 64%|██████▎   | 7/11 [00:00<00:00, 32.11it/s]100%|██████████| 11/11 [00:02<00:00,  4.34it/s]100%|██████████| 11/11 [00:02<00:00,  5.22it/s]
2025-03-09 08:32:02,676 [INFO]: 	Computing best hyperparameters for index knn.index 03/09/2025, 08:32:02
2025-03-09 08:32:39,969 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 37.2921 secs
2025-03-09 08:32:39,969 [INFO]: The best hyperparameters are: efSearch=158
2025-03-09 08:32:39,969 [INFO]: 	Compute fast metrics 03/09/2025, 08:32:39
  0%|          | 0/4 [00:00<?, ?it/s] 25%|██▌       | 1/4 [00:00<00:00,  5.14it/s] 50%|█████     | 2/4 [00:00<00:00,  6.84it/s] 75%|███████▌  | 3/4 [00:00<00:00,  7.56it/s] 75%|███████▌  | 3/4 [00:00<00:00,  5.73it/s]
2025-03-09 08:32:56,333 [INFO]: 	>>> Finished "Compute fast metrics" in 16.3639 secs
2025-03-09 08:32:56,335 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 55.7726 secs
2025-03-09 08:32:56,335 [INFO]: {
2025-03-09 08:32:56,335 [INFO]: 	index_key: HNSW15
2025-03-09 08:32:56,335 [INFO]: 	index_param: efSearch=158
2025-03-09 08:32:56,336 [INFO]: 	index_path: knn.index
2025-03-09 08:32:56,336 [INFO]: 	size in bytes: 512714470
2025-03-09 08:32:56,336 [INFO]: 	avg_search_speed_ms: 8.85044973924657
2025-03-09 08:32:56,336 [INFO]: 	99p_search_speed_ms: 13.169650875497613
2025-03-09 08:32:56,336 [INFO]: 	reconstruction error %: 0.0
2025-03-09 08:32:56,336 [INFO]: 	nb vectors: 2606
2025-03-09 08:32:56,336 [INFO]: 	vectors dimension: 49152
2025-03-09 08:32:56,336 [INFO]: 	compression ratio: 0.9993095143189542
2025-03-09 08:32:56,336 [INFO]: }
2025-03-09 08:32:56,336 [INFO]: 	>>> Finished "Creating the index" in 55.7744 secs
2025-03-09 08:32:56,336 [INFO]: >>> Finished "Launching the whole pipeline" in 55.8066 secs
2025-03-09 08:32:56: [retrieval_preprocessing] calculating distances ...
2025-03-09 08:32:57: [retrieval_preprocessing] finished and saved retrieval indices for episode 80912 [episode count 9/20]
[retrieval_preprocessing] for episode 14993 [episode count 10/20], we have num_retrieval=np.int64(2569) num_query=np.int64(151)
2025-03-09 08:32:57,860 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-09 08:32:58,231 [INFO]: Launching the whole pipeline 03/09/2025, 08:32:58
2025-03-09 08:32:58,232 [INFO]: Reading total number of vectors and dimension 03/09/2025, 08:32:58
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1380.61it/s]
2025-03-09 08:32:58,261 [INFO]: There are 2569 embeddings of dim 49152
2025-03-09 08:32:58,262 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0301 secs
2025-03-09 08:32:58,262 [INFO]: 	Compute estimated construction time of the index 03/09/2025, 08:32:58
2025-03-09 08:32:58,262 [INFO]: 		-> Train: 16.7 minutes
2025-03-09 08:32:58,262 [INFO]: 		-> Add: 1.4 seconds
2025-03-09 08:32:58,262 [INFO]: 		Total: 16.7 minutes
2025-03-09 08:32:58,262 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0001 secs
2025-03-09 08:32:58,262 [INFO]: 	Checking that your have enough memory available to create the index 03/09/2025, 08:32:58
2025-03-09 08:32:58,262 [INFO]: 530.2MB of memory will be needed to build the index (more might be used if you have more)
2025-03-09 08:32:58,262 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0002 secs
2025-03-09 08:32:58,262 [INFO]: 	Selecting most promising index types given data characteristics 03/09/2025, 08:32:58
2025-03-09 08:32:58,262 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-09 08:32:58,262 [INFO]: 	Creating the index 03/09/2025, 08:32:58
2025-03-09 08:32:58,262 [INFO]: 		-> Instanciate the index HNSW15 03/09/2025, 08:32:58
2025-03-09 08:32:58,263 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0010 secs
2025-03-09 08:32:58,263 [INFO]: 		-> Adding the vectors to the index 03/09/2025, 08:32:58
2025-03-09 08:32:58,264 [INFO]: The memory available for adding the vectors is 49.5GB(total available - used by the index)
2025-03-09 08:32:58,264 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/11 [00:00<?, ?it/s]  9%|▉         | 1/11 [00:00<00:01,  6.00it/s] 27%|██▋       | 3/11 [00:00<00:00, 11.34it/s] 45%|████▌     | 5/11 [00:00<00:00, 14.44it/s] 64%|██████▎   | 7/11 [00:00<00:00, 13.33it/s] 82%|████████▏ | 9/11 [00:00<00:00, 12.42it/s]100%|██████████| 11/11 [00:02<00:00,  2.38it/s]100%|██████████| 11/11 [00:02<00:00,  3.87it/s]
2025-03-09 08:33:01,107 [INFO]: 	Computing best hyperparameters for index knn.index 03/09/2025, 08:33:01
2025-03-09 08:33:31,404 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 30.2971 secs
2025-03-09 08:33:31,405 [INFO]: The best hyperparameters are: efSearch=223
2025-03-09 08:33:31,405 [INFO]: 	Compute fast metrics 03/09/2025, 08:33:31
  0%|          | 0/4 [00:00<?, ?it/s] 25%|██▌       | 1/4 [00:00<00:00,  4.74it/s] 50%|█████     | 2/4 [00:00<00:00,  6.18it/s] 75%|███████▌  | 3/4 [00:00<00:00,  6.84it/s] 75%|███████▌  | 3/4 [00:00<00:00,  5.13it/s]
2025-03-09 08:33:47,279 [INFO]: 	>>> Finished "Compute fast metrics" in 15.8742 secs
2025-03-09 08:33:47,281 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 49.0172 secs
2025-03-09 08:33:47,281 [INFO]: {
2025-03-09 08:33:47,281 [INFO]: 	index_key: HNSW15
2025-03-09 08:33:47,281 [INFO]: 	index_param: efSearch=223
2025-03-09 08:33:47,281 [INFO]: 	index_path: knn.index
2025-03-09 08:33:47,281 [INFO]: 	size in bytes: 505434850
2025-03-09 08:33:47,281 [INFO]: 	avg_search_speed_ms: 9.700049009584216
2025-03-09 08:33:47,281 [INFO]: 	99p_search_speed_ms: 16.99346767272801
2025-03-09 08:33:47,281 [INFO]: 	reconstruction error %: 0.0
2025-03-09 08:33:47,281 [INFO]: 	nb vectors: 2569
2025-03-09 08:33:47,281 [INFO]: 	vectors dimension: 49152
2025-03-09 08:33:47,281 [INFO]: 	compression ratio: 0.9993097072748347
2025-03-09 08:33:47,281 [INFO]: }
2025-03-09 08:33:47,281 [INFO]: 	>>> Finished "Creating the index" in 49.0188 secs
2025-03-09 08:33:47,281 [INFO]: >>> Finished "Launching the whole pipeline" in 49.0495 secs
2025-03-09 08:33:48: [retrieval_preprocessing] calculating distances ...
2025-03-09 08:33:48: [retrieval_preprocessing] finished and saved retrieval indices for episode 14993 [episode count 10/20]
[retrieval_preprocessing] for episode 42385 [episode count 11/20], we have num_retrieval=np.int64(2572) num_query=np.int64(148)
2025-03-09 08:33:49,237 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-09 08:33:49,603 [INFO]: Launching the whole pipeline 03/09/2025, 08:33:49
2025-03-09 08:33:49,603 [INFO]: Reading total number of vectors and dimension 03/09/2025, 08:33:49
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1504.95it/s]
2025-03-09 08:33:49,631 [INFO]: There are 2572 embeddings of dim 49152
2025-03-09 08:33:49,631 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0274 secs
2025-03-09 08:33:49,631 [INFO]: 	Compute estimated construction time of the index 03/09/2025, 08:33:49
2025-03-09 08:33:49,631 [INFO]: 		-> Train: 16.7 minutes
2025-03-09 08:33:49,631 [INFO]: 		-> Add: 1.4 seconds
2025-03-09 08:33:49,631 [INFO]: 		Total: 16.7 minutes
2025-03-09 08:33:49,631 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0001 secs
2025-03-09 08:33:49,631 [INFO]: 	Checking that your have enough memory available to create the index 03/09/2025, 08:33:49
2025-03-09 08:33:49,631 [INFO]: 530.8MB of memory will be needed to build the index (more might be used if you have more)
2025-03-09 08:33:49,631 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0002 secs
2025-03-09 08:33:49,631 [INFO]: 	Selecting most promising index types given data characteristics 03/09/2025, 08:33:49
2025-03-09 08:33:49,631 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-09 08:33:49,631 [INFO]: 	Creating the index 03/09/2025, 08:33:49
2025-03-09 08:33:49,631 [INFO]: 		-> Instanciate the index HNSW15 03/09/2025, 08:33:49
2025-03-09 08:33:49,633 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0013 secs
2025-03-09 08:33:49,633 [INFO]: 		-> Adding the vectors to the index 03/09/2025, 08:33:49
2025-03-09 08:33:49,633 [INFO]: The memory available for adding the vectors is 49.5GB(total available - used by the index)
2025-03-09 08:33:49,633 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/11 [00:00<?, ?it/s]  9%|▉         | 1/11 [00:00<00:01,  6.06it/s] 27%|██▋       | 3/11 [00:00<00:00,  9.80it/s] 45%|████▌     | 5/11 [00:00<00:00, 11.13it/s] 64%|██████▎   | 7/11 [00:00<00:00, 11.67it/s] 82%|████████▏ | 9/11 [00:00<00:00, 11.90it/s]100%|██████████| 11/11 [00:02<00:00,  2.64it/s]100%|██████████| 11/11 [00:02<00:00,  4.14it/s]
2025-03-09 08:33:52,296 [INFO]: 	Computing best hyperparameters for index knn.index 03/09/2025, 08:33:52
2025-03-09 08:34:23,652 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 31.3564 secs
2025-03-09 08:34:23,653 [INFO]: The best hyperparameters are: efSearch=257
2025-03-09 08:34:23,653 [INFO]: 	Compute fast metrics 03/09/2025, 08:34:23
  0%|          | 0/4 [00:00<?, ?it/s] 25%|██▌       | 1/4 [00:00<00:00,  5.11it/s] 50%|█████     | 2/4 [00:00<00:00,  6.79it/s] 75%|███████▌  | 3/4 [00:00<00:00,  7.63it/s] 75%|███████▌  | 3/4 [00:00<00:00,  5.74it/s]
2025-03-09 08:34:39,904 [INFO]: 	>>> Finished "Compute fast metrics" in 16.2514 secs
2025-03-09 08:34:39,906 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 50.2728 secs
2025-03-09 08:34:39,906 [INFO]: {
2025-03-09 08:34:39,906 [INFO]: 	index_key: HNSW15
2025-03-09 08:34:39,906 [INFO]: 	index_param: efSearch=257
2025-03-09 08:34:39,906 [INFO]: 	index_path: knn.index
2025-03-09 08:34:39,906 [INFO]: 	size in bytes: 506025070
2025-03-09 08:34:39,906 [INFO]: 	avg_search_speed_ms: 9.787161839549993
2025-03-09 08:34:39,906 [INFO]: 	99p_search_speed_ms: 16.576578558888283
2025-03-09 08:34:39,906 [INFO]: 	reconstruction error %: 0.0
2025-03-09 08:34:39,906 [INFO]: 	nb vectors: 2572
2025-03-09 08:34:39,906 [INFO]: 	vectors dimension: 49152
2025-03-09 08:34:39,906 [INFO]: 	compression ratio: 0.9993097298519221
2025-03-09 08:34:39,906 [INFO]: }
2025-03-09 08:34:39,906 [INFO]: 	>>> Finished "Creating the index" in 50.2745 secs
2025-03-09 08:34:39,906 [INFO]: >>> Finished "Launching the whole pipeline" in 50.3027 secs
2025-03-09 08:34:41: [retrieval_preprocessing] calculating distances ...
2025-03-09 08:34:42: [retrieval_preprocessing] finished and saved retrieval indices for episode 42385 [episode count 11/20]
[retrieval_preprocessing] for episode 8347 [episode count 12/20], we have num_retrieval=np.int64(2590) num_query=np.int64(130)
2025-03-09 08:34:43,347 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-09 08:34:43,790 [INFO]: Launching the whole pipeline 03/09/2025, 08:34:43
2025-03-09 08:34:43,790 [INFO]: Reading total number of vectors and dimension 03/09/2025, 08:34:43
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1663.75it/s]
2025-03-09 08:34:43,816 [INFO]: There are 2590 embeddings of dim 49152
2025-03-09 08:34:43,816 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0258 secs
2025-03-09 08:34:43,816 [INFO]: 	Compute estimated construction time of the index 03/09/2025, 08:34:43
2025-03-09 08:34:43,816 [INFO]: 		-> Train: 16.7 minutes
2025-03-09 08:34:43,816 [INFO]: 		-> Add: 1.4 seconds
2025-03-09 08:34:43,816 [INFO]: 		Total: 16.7 minutes
2025-03-09 08:34:43,816 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0001 secs
2025-03-09 08:34:43,816 [INFO]: 	Checking that your have enough memory available to create the index 03/09/2025, 08:34:43
2025-03-09 08:34:43,816 [INFO]: 534.5MB of memory will be needed to build the index (more might be used if you have more)
2025-03-09 08:34:43,816 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0001 secs
2025-03-09 08:34:43,816 [INFO]: 	Selecting most promising index types given data characteristics 03/09/2025, 08:34:43
2025-03-09 08:34:43,816 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-09 08:34:43,816 [INFO]: 	Creating the index 03/09/2025, 08:34:43
2025-03-09 08:34:43,817 [INFO]: 		-> Instanciate the index HNSW15 03/09/2025, 08:34:43
2025-03-09 08:34:43,818 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0011 secs
2025-03-09 08:34:43,818 [INFO]: 		-> Adding the vectors to the index 03/09/2025, 08:34:43
2025-03-09 08:34:43,818 [INFO]: The memory available for adding the vectors is 49.5GB(total available - used by the index)
2025-03-09 08:34:43,818 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/11 [00:00<?, ?it/s]  9%|▉         | 1/11 [00:00<00:01,  6.20it/s] 27%|██▋       | 3/11 [00:00<00:00, 10.50it/s] 45%|████▌     | 5/11 [00:00<00:00, 11.43it/s] 64%|██████▎   | 7/11 [00:00<00:00, 11.89it/s] 82%|████████▏ | 9/11 [00:00<00:00, 12.05it/s]100%|██████████| 11/11 [00:02<00:00,  2.79it/s]100%|██████████| 11/11 [00:02<00:00,  4.36it/s]
2025-03-09 08:34:46,346 [INFO]: 	Computing best hyperparameters for index knn.index 03/09/2025, 08:34:46
2025-03-09 08:35:18,546 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 32.1998 secs
2025-03-09 08:35:18,546 [INFO]: The best hyperparameters are: efSearch=268
2025-03-09 08:35:18,546 [INFO]: 	Compute fast metrics 03/09/2025, 08:35:18
  0%|          | 0/4 [00:00<?, ?it/s] 25%|██▌       | 1/4 [00:00<00:00,  6.04it/s] 75%|███████▌  | 3/4 [00:00<00:00, 10.13it/s] 75%|███████▌  | 3/4 [00:00<00:00,  7.44it/s]
2025-03-09 08:35:32,116 [INFO]: 	>>> Finished "Compute fast metrics" in 13.5697 secs
2025-03-09 08:35:32,118 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 48.2998 secs
2025-03-09 08:35:32,118 [INFO]: {
2025-03-09 08:35:32,118 [INFO]: 	index_key: HNSW15
2025-03-09 08:35:32,118 [INFO]: 	index_param: efSearch=268
2025-03-09 08:35:32,118 [INFO]: 	index_path: knn.index
2025-03-09 08:35:32,118 [INFO]: 	size in bytes: 509566630
2025-03-09 08:35:32,118 [INFO]: 	avg_search_speed_ms: 10.49850810102235
2025-03-09 08:35:32,118 [INFO]: 	99p_search_speed_ms: 15.690653230994942
2025-03-09 08:35:32,118 [INFO]: 	reconstruction error %: 0.0
2025-03-09 08:35:32,118 [INFO]: 	nb vectors: 2590
2025-03-09 08:35:32,118 [INFO]: 	vectors dimension: 49152
2025-03-09 08:35:32,118 [INFO]: 	compression ratio: 0.9993093935527136
2025-03-09 08:35:32,118 [INFO]: }
2025-03-09 08:35:32,118 [INFO]: 	>>> Finished "Creating the index" in 48.3013 secs
2025-03-09 08:35:32,118 [INFO]: >>> Finished "Launching the whole pipeline" in 48.3278 secs
2025-03-09 08:35:32: [retrieval_preprocessing] calculating distances ...
2025-03-09 08:35:33: [retrieval_preprocessing] finished and saved retrieval indices for episode 8347 [episode count 12/20]
[retrieval_preprocessing] for episode 2719 [episode count 13/20], we have num_retrieval=np.int64(2575) num_query=np.int64(145)
2025-03-09 08:35:33,995 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-09 08:35:34,865 [INFO]: Launching the whole pipeline 03/09/2025, 08:35:34
2025-03-09 08:35:34,866 [INFO]: Reading total number of vectors and dimension 03/09/2025, 08:35:34
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1129.63it/s]
2025-03-09 08:35:34,891 [INFO]: There are 2575 embeddings of dim 49152
2025-03-09 08:35:34,892 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0262 secs
2025-03-09 08:35:34,892 [INFO]: 	Compute estimated construction time of the index 03/09/2025, 08:35:34
2025-03-09 08:35:34,892 [INFO]: 		-> Train: 16.7 minutes
2025-03-09 08:35:34,892 [INFO]: 		-> Add: 1.4 seconds
2025-03-09 08:35:34,892 [INFO]: 		Total: 16.7 minutes
2025-03-09 08:35:34,892 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0003 secs
2025-03-09 08:35:34,892 [INFO]: 	Checking that your have enough memory available to create the index 03/09/2025, 08:35:34
2025-03-09 08:35:34,893 [INFO]: 531.4MB of memory will be needed to build the index (more might be used if you have more)
2025-03-09 08:35:34,893 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0005 secs
2025-03-09 08:35:34,893 [INFO]: 	Selecting most promising index types given data characteristics 03/09/2025, 08:35:34
2025-03-09 08:35:34,893 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-09 08:35:34,893 [INFO]: 	Creating the index 03/09/2025, 08:35:34
2025-03-09 08:35:34,893 [INFO]: 		-> Instanciate the index HNSW15 03/09/2025, 08:35:34
2025-03-09 08:35:34,896 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0029 secs
2025-03-09 08:35:34,897 [INFO]: 		-> Adding the vectors to the index 03/09/2025, 08:35:34
2025-03-09 08:35:34,897 [INFO]: The memory available for adding the vectors is 49.5GB(total available - used by the index)
2025-03-09 08:35:34,897 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/11 [00:00<?, ?it/s]  9%|▉         | 1/11 [00:00<00:01,  5.56it/s] 18%|█▊        | 2/11 [00:00<00:01,  7.00it/s] 27%|██▋       | 3/11 [00:00<00:01,  7.81it/s] 36%|███▋      | 4/11 [00:00<00:00,  8.51it/s] 45%|████▌     | 5/11 [00:00<00:00,  8.84it/s] 55%|█████▍    | 6/11 [00:00<00:00,  8.94it/s] 64%|██████▎   | 7/11 [00:00<00:00,  9.01it/s] 73%|███████▎  | 8/11 [00:00<00:00,  9.05it/s] 82%|████████▏ | 9/11 [00:01<00:00,  9.16it/s] 91%|█████████ | 10/11 [00:01<00:00,  9.16it/s]100%|██████████| 11/11 [00:02<00:00,  1.69it/s]100%|██████████| 11/11 [00:02<00:00,  3.86it/s]
2025-03-09 08:35:37,749 [INFO]: 	Computing best hyperparameters for index knn.index 03/09/2025, 08:35:37
2025-03-09 08:36:05,638 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 27.8894 secs
2025-03-09 08:36:05,639 [INFO]: The best hyperparameters are: efSearch=251
2025-03-09 08:36:05,639 [INFO]: 	Compute fast metrics 03/09/2025, 08:36:05
  0%|          | 0/4 [00:00<?, ?it/s] 25%|██▌       | 1/4 [00:00<00:00,  4.96it/s] 50%|█████     | 2/4 [00:00<00:00,  6.42it/s] 75%|███████▌  | 3/4 [00:00<00:00,  7.13it/s] 75%|███████▌  | 3/4 [00:00<00:00,  5.37it/s]
2025-03-09 08:36:21,371 [INFO]: 	>>> Finished "Compute fast metrics" in 15.7318 secs
2025-03-09 08:36:21,373 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 46.4760 secs
2025-03-09 08:36:21,373 [INFO]: {
2025-03-09 08:36:21,373 [INFO]: 	index_key: HNSW15
2025-03-09 08:36:21,373 [INFO]: 	index_param: efSearch=251
2025-03-09 08:36:21,373 [INFO]: 	index_path: knn.index
2025-03-09 08:36:21,373 [INFO]: 	size in bytes: 506615410
2025-03-09 08:36:21,373 [INFO]: 	avg_search_speed_ms: 10.573321142200436
2025-03-09 08:36:21,373 [INFO]: 	99p_search_speed_ms: 17.49251035507768
2025-03-09 08:36:21,373 [INFO]: 	reconstruction error %: 0.0
2025-03-09 08:36:21,373 [INFO]: 	nb vectors: 2575
2025-03-09 08:36:21,373 [INFO]: 	vectors dimension: 49152
2025-03-09 08:36:21,373 [INFO]: 	compression ratio: 0.9993095156738323
2025-03-09 08:36:21,373 [INFO]: }
2025-03-09 08:36:21,373 [INFO]: 	>>> Finished "Creating the index" in 46.4800 secs
2025-03-09 08:36:21,373 [INFO]: >>> Finished "Launching the whole pipeline" in 46.5078 secs
2025-03-09 08:36:22: [retrieval_preprocessing] calculating distances ...
2025-03-09 08:36:23: [retrieval_preprocessing] finished and saved retrieval indices for episode 2719 [episode count 13/20]
[retrieval_preprocessing] for episode 14457 [episode count 14/20], we have num_retrieval=np.int64(2591) num_query=np.int64(129)
2025-03-09 08:36:23,779 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-09 08:36:24,207 [INFO]: Launching the whole pipeline 03/09/2025, 08:36:24
2025-03-09 08:36:24,207 [INFO]: Reading total number of vectors and dimension 03/09/2025, 08:36:24
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1168.98it/s]
2025-03-09 08:36:24,236 [INFO]: There are 2591 embeddings of dim 49152
2025-03-09 08:36:24,237 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0295 secs
2025-03-09 08:36:24,237 [INFO]: 	Compute estimated construction time of the index 03/09/2025, 08:36:24
2025-03-09 08:36:24,237 [INFO]: 		-> Train: 16.7 minutes
2025-03-09 08:36:24,237 [INFO]: 		-> Add: 1.4 seconds
2025-03-09 08:36:24,237 [INFO]: 		Total: 16.7 minutes
2025-03-09 08:36:24,237 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0001 secs
2025-03-09 08:36:24,237 [INFO]: 	Checking that your have enough memory available to create the index 03/09/2025, 08:36:24
2025-03-09 08:36:24,237 [INFO]: 534.7MB of memory will be needed to build the index (more might be used if you have more)
2025-03-09 08:36:24,237 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0002 secs
2025-03-09 08:36:24,237 [INFO]: 	Selecting most promising index types given data characteristics 03/09/2025, 08:36:24
2025-03-09 08:36:24,237 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-09 08:36:24,237 [INFO]: 	Creating the index 03/09/2025, 08:36:24
2025-03-09 08:36:24,237 [INFO]: 		-> Instanciate the index HNSW15 03/09/2025, 08:36:24
2025-03-09 08:36:24,239 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0012 secs
2025-03-09 08:36:24,239 [INFO]: 		-> Adding the vectors to the index 03/09/2025, 08:36:24
2025-03-09 08:36:24,239 [INFO]: The memory available for adding the vectors is 49.5GB(total available - used by the index)
2025-03-09 08:36:24,239 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/11 [00:00<?, ?it/s] 18%|█▊        | 2/11 [00:00<00:00, 17.95it/s] 73%|███████▎  | 8/11 [00:00<00:00, 40.34it/s]100%|██████████| 11/11 [00:02<00:00,  5.26it/s]
2025-03-09 08:36:26,335 [INFO]: 	Computing best hyperparameters for index knn.index 03/09/2025, 08:36:26
2025-03-09 08:37:00,187 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 33.8507 secs
2025-03-09 08:37:00,187 [INFO]: The best hyperparameters are: efSearch=240
2025-03-09 08:37:00,187 [INFO]: 	Compute fast metrics 03/09/2025, 08:37:00
  0%|          | 0/4 [00:00<?, ?it/s] 50%|█████     | 2/4 [00:00<00:00, 18.25it/s] 75%|███████▌  | 3/4 [00:00<00:00, 19.28it/s]
2025-03-09 08:37:17,919 [INFO]: 	>>> Finished "Compute fast metrics" in 17.7310 secs
2025-03-09 08:37:17,921 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 53.6826 secs
2025-03-09 08:37:17,921 [INFO]: {
2025-03-09 08:37:17,921 [INFO]: 	index_key: HNSW15
2025-03-09 08:37:17,922 [INFO]: 	index_param: efSearch=240
2025-03-09 08:37:17,922 [INFO]: 	index_path: knn.index
2025-03-09 08:37:17,922 [INFO]: 	size in bytes: 509763370
2025-03-09 08:37:17,922 [INFO]: 	avg_search_speed_ms: 10.60554467379644
2025-03-09 08:37:17,922 [INFO]: 	99p_search_speed_ms: 21.425117286853514
2025-03-09 08:37:17,922 [INFO]: 	reconstruction error %: 0.0
2025-03-09 08:37:17,922 [INFO]: 	nb vectors: 2591
2025-03-09 08:37:17,922 [INFO]: 	vectors dimension: 49152
2025-03-09 08:37:17,922 [INFO]: 	compression ratio: 0.9993094011442996
2025-03-09 08:37:17,922 [INFO]: }
2025-03-09 08:37:17,922 [INFO]: 	>>> Finished "Creating the index" in 53.6844 secs
2025-03-09 08:37:17,922 [INFO]: >>> Finished "Launching the whole pipeline" in 53.7146 secs
2025-03-09 08:37:18: [retrieval_preprocessing] calculating distances ...
2025-03-09 08:37:19: [retrieval_preprocessing] finished and saved retrieval indices for episode 14457 [episode count 14/20]
[retrieval_preprocessing] for episode 28705 [episode count 15/20], we have num_retrieval=np.int64(2595) num_query=np.int64(125)
2025-03-09 08:37:19,782 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-09 08:37:20,250 [INFO]: Launching the whole pipeline 03/09/2025, 08:37:20
2025-03-09 08:37:20,251 [INFO]: Reading total number of vectors and dimension 03/09/2025, 08:37:20
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1846.08it/s]
2025-03-09 08:37:20,283 [INFO]: There are 2595 embeddings of dim 49152
2025-03-09 08:37:20,284 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0330 secs
2025-03-09 08:37:20,284 [INFO]: 	Compute estimated construction time of the index 03/09/2025, 08:37:20
2025-03-09 08:37:20,284 [INFO]: 		-> Train: 16.7 minutes
2025-03-09 08:37:20,284 [INFO]: 		-> Add: 1.4 seconds
2025-03-09 08:37:20,284 [INFO]: 		Total: 16.7 minutes
2025-03-09 08:37:20,284 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0001 secs
2025-03-09 08:37:20,284 [INFO]: 	Checking that your have enough memory available to create the index 03/09/2025, 08:37:20
2025-03-09 08:37:20,284 [INFO]: 535.5MB of memory will be needed to build the index (more might be used if you have more)
2025-03-09 08:37:20,284 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0002 secs
2025-03-09 08:37:20,284 [INFO]: 	Selecting most promising index types given data characteristics 03/09/2025, 08:37:20
2025-03-09 08:37:20,284 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-09 08:37:20,284 [INFO]: 	Creating the index 03/09/2025, 08:37:20
2025-03-09 08:37:20,284 [INFO]: 		-> Instanciate the index HNSW15 03/09/2025, 08:37:20
2025-03-09 08:37:20,286 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0014 secs
2025-03-09 08:37:20,286 [INFO]: 		-> Adding the vectors to the index 03/09/2025, 08:37:20
2025-03-09 08:37:20,286 [INFO]: The memory available for adding the vectors is 49.5GB(total available - used by the index)
2025-03-09 08:37:20,286 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/11 [00:00<?, ?it/s]  9%|▉         | 1/11 [00:00<00:01,  9.52it/s] 64%|██████▎   | 7/11 [00:00<00:00, 35.64it/s]100%|██████████| 11/11 [00:02<00:00,  4.25it/s]100%|██████████| 11/11 [00:02<00:00,  5.15it/s]
2025-03-09 08:37:22,426 [INFO]: 	Computing best hyperparameters for index knn.index 03/09/2025, 08:37:22
2025-03-09 08:37:52,496 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 30.0694 secs
2025-03-09 08:37:52,496 [INFO]: The best hyperparameters are: efSearch=238
2025-03-09 08:37:52,496 [INFO]: 	Compute fast metrics 03/09/2025, 08:37:52
  0%|          | 0/4 [00:00<?, ?it/s] 50%|█████     | 2/4 [00:00<00:00, 19.25it/s] 75%|███████▌  | 3/4 [00:00<00:00, 21.26it/s]
2025-03-09 08:38:07,355 [INFO]: 	>>> Finished "Compute fast metrics" in 14.8589 secs
2025-03-09 08:38:07,357 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 47.0705 secs
2025-03-09 08:38:07,357 [INFO]: {
2025-03-09 08:38:07,357 [INFO]: 	index_key: HNSW15
2025-03-09 08:38:07,357 [INFO]: 	index_param: efSearch=238
2025-03-09 08:38:07,357 [INFO]: 	index_path: knn.index
2025-03-09 08:38:07,357 [INFO]: 	size in bytes: 510550330
2025-03-09 08:38:07,357 [INFO]: 	avg_search_speed_ms: 8.790790465102255
2025-03-09 08:38:07,357 [INFO]: 	99p_search_speed_ms: 15.167843194212757
2025-03-09 08:38:07,357 [INFO]: 	reconstruction error %: 0.0
2025-03-09 08:38:07,357 [INFO]: 	nb vectors: 2595
2025-03-09 08:38:07,357 [INFO]: 	vectors dimension: 49152
2025-03-09 08:38:07,357 [INFO]: 	compression ratio: 0.9993094314521352
2025-03-09 08:38:07,357 [INFO]: }
2025-03-09 08:38:07,357 [INFO]: 	>>> Finished "Creating the index" in 47.0725 secs
2025-03-09 08:38:07,357 [INFO]: >>> Finished "Launching the whole pipeline" in 47.1063 secs
2025-03-09 08:38:08: [retrieval_preprocessing] calculating distances ...
2025-03-09 08:38:08: [retrieval_preprocessing] finished and saved retrieval indices for episode 28705 [episode count 15/20]
[retrieval_preprocessing] for episode 93221 [episode count 16/20], we have num_retrieval=np.int64(2618) num_query=np.int64(102)
2025-03-09 08:38:09,041 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-09 08:38:09,444 [INFO]: Launching the whole pipeline 03/09/2025, 08:38:09
2025-03-09 08:38:09,444 [INFO]: Reading total number of vectors and dimension 03/09/2025, 08:38:09
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1687.17it/s]
2025-03-09 08:38:09,698 [INFO]: There are 2618 embeddings of dim 49152
2025-03-09 08:38:09,699 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.2545 secs
2025-03-09 08:38:09,699 [INFO]: 	Compute estimated construction time of the index 03/09/2025, 08:38:09
2025-03-09 08:38:09,699 [INFO]: 		-> Train: 16.7 minutes
2025-03-09 08:38:09,699 [INFO]: 		-> Add: 1.4 seconds
2025-03-09 08:38:09,699 [INFO]: 		Total: 16.7 minutes
2025-03-09 08:38:09,699 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0003 secs
2025-03-09 08:38:09,699 [INFO]: 	Checking that your have enough memory available to create the index 03/09/2025, 08:38:09
2025-03-09 08:38:09,700 [INFO]: 540.3MB of memory will be needed to build the index (more might be used if you have more)
2025-03-09 08:38:09,700 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0004 secs
2025-03-09 08:38:09,700 [INFO]: 	Selecting most promising index types given data characteristics 03/09/2025, 08:38:09
2025-03-09 08:38:09,700 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-09 08:38:09,700 [INFO]: 	Creating the index 03/09/2025, 08:38:09
2025-03-09 08:38:09,700 [INFO]: 		-> Instanciate the index HNSW15 03/09/2025, 08:38:09
2025-03-09 08:38:09,703 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0026 secs
2025-03-09 08:38:09,704 [INFO]: 		-> Adding the vectors to the index 03/09/2025, 08:38:09
2025-03-09 08:38:09,704 [INFO]: The memory available for adding the vectors is 49.5GB(total available - used by the index)
2025-03-09 08:38:09,704 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/11 [00:00<?, ?it/s] 18%|█▊        | 2/11 [00:00<00:00, 19.61it/s] 73%|███████▎  | 8/11 [00:00<00:00, 41.55it/s]100%|██████████| 11/11 [00:01<00:00,  5.98it/s]
2025-03-09 08:38:11,549 [INFO]: 	Computing best hyperparameters for index knn.index 03/09/2025, 08:38:11
2025-03-09 08:38:41,980 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 30.4306 secs
2025-03-09 08:38:41,980 [INFO]: The best hyperparameters are: efSearch=295
2025-03-09 08:38:41,980 [INFO]: 	Compute fast metrics 03/09/2025, 08:38:41
  0%|          | 0/4 [00:00<?, ?it/s] 50%|█████     | 2/4 [00:00<00:00, 18.53it/s] 75%|███████▌  | 3/4 [00:00<00:00, 20.10it/s]
2025-03-09 08:38:59,284 [INFO]: 	>>> Finished "Compute fast metrics" in 17.3040 secs
2025-03-09 08:38:59,286 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 49.5822 secs
2025-03-09 08:38:59,286 [INFO]: {
2025-03-09 08:38:59,286 [INFO]: 	index_key: HNSW15
2025-03-09 08:38:59,286 [INFO]: 	index_param: efSearch=295
2025-03-09 08:38:59,286 [INFO]: 	index_path: knn.index
2025-03-09 08:38:59,286 [INFO]: 	size in bytes: 515075470
2025-03-09 08:38:59,286 [INFO]: 	avg_search_speed_ms: 10.165401575168806
2025-03-09 08:38:59,286 [INFO]: 	99p_search_speed_ms: 13.434867560863493
2025-03-09 08:38:59,286 [INFO]: 	reconstruction error %: 0.0
2025-03-09 08:38:59,286 [INFO]: 	nb vectors: 2618
2025-03-09 08:38:59,286 [INFO]: 	vectors dimension: 49152
2025-03-09 08:38:59,286 [INFO]: 	compression ratio: 0.9993093711102181
2025-03-09 08:38:59,286 [INFO]: }
2025-03-09 08:38:59,286 [INFO]: 	>>> Finished "Creating the index" in 49.5857 secs
2025-03-09 08:38:59,286 [INFO]: >>> Finished "Launching the whole pipeline" in 49.8420 secs
2025-03-09 08:38:59: [retrieval_preprocessing] calculating distances ...
2025-03-09 08:39:00: [retrieval_preprocessing] finished and saved retrieval indices for episode 93221 [episode count 16/20]
[retrieval_preprocessing] for episode 9643 [episode count 17/20], we have num_retrieval=np.int64(2592) num_query=np.int64(128)
2025-03-09 08:39:00,390 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-09 08:39:00,688 [INFO]: Launching the whole pipeline 03/09/2025, 08:39:00
2025-03-09 08:39:00,688 [INFO]: Reading total number of vectors and dimension 03/09/2025, 08:39:00
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1880.01it/s]
2025-03-09 08:39:00,710 [INFO]: There are 2592 embeddings of dim 49152
2025-03-09 08:39:00,711 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0229 secs
2025-03-09 08:39:00,711 [INFO]: 	Compute estimated construction time of the index 03/09/2025, 08:39:00
2025-03-09 08:39:00,711 [INFO]: 		-> Train: 16.7 minutes
2025-03-09 08:39:00,711 [INFO]: 		-> Add: 1.4 seconds
2025-03-09 08:39:00,711 [INFO]: 		Total: 16.7 minutes
2025-03-09 08:39:00,711 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0002 secs
2025-03-09 08:39:00,711 [INFO]: 	Checking that your have enough memory available to create the index 03/09/2025, 08:39:00
2025-03-09 08:39:00,711 [INFO]: 534.9MB of memory will be needed to build the index (more might be used if you have more)
2025-03-09 08:39:00,711 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0001 secs
2025-03-09 08:39:00,711 [INFO]: 	Selecting most promising index types given data characteristics 03/09/2025, 08:39:00
2025-03-09 08:39:00,711 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-09 08:39:00,711 [INFO]: 	Creating the index 03/09/2025, 08:39:00
2025-03-09 08:39:00,711 [INFO]: 		-> Instanciate the index HNSW15 03/09/2025, 08:39:00
2025-03-09 08:39:00,712 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0008 secs
2025-03-09 08:39:00,712 [INFO]: 		-> Adding the vectors to the index 03/09/2025, 08:39:00
2025-03-09 08:39:00,712 [INFO]: The memory available for adding the vectors is 49.5GB(total available - used by the index)
2025-03-09 08:39:00,712 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/11 [00:00<?, ?it/s]  9%|▉         | 1/11 [00:00<00:01,  9.37it/s] 64%|██████▎   | 7/11 [00:00<00:00, 33.18it/s]100%|██████████| 11/11 [00:01<00:00,  4.63it/s]100%|██████████| 11/11 [00:01<00:00,  5.58it/s]
2025-03-09 08:39:02,686 [INFO]: 	Computing best hyperparameters for index knn.index 03/09/2025, 08:39:02
2025-03-09 08:39:37,805 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 35.1191 secs
2025-03-09 08:39:37,805 [INFO]: The best hyperparameters are: efSearch=240
2025-03-09 08:39:37,806 [INFO]: 	Compute fast metrics 03/09/2025, 08:39:37
  0%|          | 0/4 [00:00<?, ?it/s] 25%|██▌       | 1/4 [00:00<00:00,  5.16it/s] 50%|█████     | 2/4 [00:00<00:00,  6.79it/s] 75%|███████▌  | 3/4 [00:00<00:00,  7.52it/s] 75%|███████▌  | 3/4 [00:00<00:00,  5.63it/s]
2025-03-09 08:39:55,533 [INFO]: 	>>> Finished "Compute fast metrics" in 17.7277 secs
2025-03-09 08:39:55,535 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 54.8228 secs
2025-03-09 08:39:55,535 [INFO]: {
2025-03-09 08:39:55,535 [INFO]: 	index_key: HNSW15
2025-03-09 08:39:55,535 [INFO]: 	index_param: efSearch=240
2025-03-09 08:39:55,535 [INFO]: 	index_path: knn.index
2025-03-09 08:39:55,535 [INFO]: 	size in bytes: 509960110
2025-03-09 08:39:55,535 [INFO]: 	avg_search_speed_ms: 10.424848128065499
2025-03-09 08:39:55,535 [INFO]: 	99p_search_speed_ms: 18.495847238227714
2025-03-09 08:39:55,535 [INFO]: 	reconstruction error %: 0.0
2025-03-09 08:39:55,535 [INFO]: 	nb vectors: 2592
2025-03-09 08:39:55,535 [INFO]: 	vectors dimension: 49152
2025-03-09 08:39:55,535 [INFO]: 	compression ratio: 0.9993094087300279
2025-03-09 08:39:55,535 [INFO]: }
2025-03-09 08:39:55,535 [INFO]: 	>>> Finished "Creating the index" in 54.8241 secs
2025-03-09 08:39:55,535 [INFO]: >>> Finished "Launching the whole pipeline" in 54.8476 secs
2025-03-09 08:39:56: [retrieval_preprocessing] calculating distances ...
2025-03-09 08:39:56: [retrieval_preprocessing] finished and saved retrieval indices for episode 9643 [episode count 17/20]
[retrieval_preprocessing] for episode 41004 [episode count 18/20], we have num_retrieval=np.int64(2601) num_query=np.int64(119)
2025-03-09 08:39:57,147 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-09 08:39:57,532 [INFO]: Launching the whole pipeline 03/09/2025, 08:39:57
2025-03-09 08:39:57,532 [INFO]: Reading total number of vectors and dimension 03/09/2025, 08:39:57
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1004.62it/s]
2025-03-09 08:39:57,565 [INFO]: There are 2601 embeddings of dim 49152
2025-03-09 08:39:57,565 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0323 secs
2025-03-09 08:39:57,565 [INFO]: 	Compute estimated construction time of the index 03/09/2025, 08:39:57
2025-03-09 08:39:57,565 [INFO]: 		-> Train: 16.7 minutes
2025-03-09 08:39:57,565 [INFO]: 		-> Add: 1.4 seconds
2025-03-09 08:39:57,565 [INFO]: 		Total: 16.7 minutes
2025-03-09 08:39:57,565 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0001 secs
2025-03-09 08:39:57,565 [INFO]: 	Checking that your have enough memory available to create the index 03/09/2025, 08:39:57
2025-03-09 08:39:57,565 [INFO]: 536.8MB of memory will be needed to build the index (more might be used if you have more)
2025-03-09 08:39:57,565 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0002 secs
2025-03-09 08:39:57,565 [INFO]: 	Selecting most promising index types given data characteristics 03/09/2025, 08:39:57
2025-03-09 08:39:57,565 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-09 08:39:57,565 [INFO]: 	Creating the index 03/09/2025, 08:39:57
2025-03-09 08:39:57,565 [INFO]: 		-> Instanciate the index HNSW15 03/09/2025, 08:39:57
2025-03-09 08:39:57,566 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0009 secs
2025-03-09 08:39:57,566 [INFO]: 		-> Adding the vectors to the index 03/09/2025, 08:39:57
2025-03-09 08:39:57,566 [INFO]: The memory available for adding the vectors is 49.5GB(total available - used by the index)
2025-03-09 08:39:57,567 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/11 [00:00<?, ?it/s]  9%|▉         | 1/11 [00:00<00:01,  8.66it/s] 55%|█████▍    | 6/11 [00:00<00:00, 30.80it/s]100%|██████████| 11/11 [00:01<00:00,  4.73it/s]100%|██████████| 11/11 [00:01<00:00,  5.52it/s]
2025-03-09 08:39:59,563 [INFO]: 	Computing best hyperparameters for index knn.index 03/09/2025, 08:39:59
2025-03-09 08:40:32,881 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 33.3177 secs
2025-03-09 08:40:32,882 [INFO]: The best hyperparameters are: efSearch=255
2025-03-09 08:40:32,882 [INFO]: 	Compute fast metrics 03/09/2025, 08:40:32
  0%|          | 0/4 [00:00<?, ?it/s] 25%|██▌       | 1/4 [00:00<00:00,  9.09it/s] 75%|███████▌  | 3/4 [00:00<00:00, 16.58it/s]
2025-03-09 08:40:50,366 [INFO]: 	>>> Finished "Compute fast metrics" in 17.4841 secs
2025-03-09 08:40:50,368 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 52.8013 secs
2025-03-09 08:40:50,368 [INFO]: {
2025-03-09 08:40:50,368 [INFO]: 	index_key: HNSW15
2025-03-09 08:40:50,368 [INFO]: 	index_param: efSearch=255
2025-03-09 08:40:50,368 [INFO]: 	index_path: knn.index
2025-03-09 08:40:50,368 [INFO]: 	size in bytes: 511730770
2025-03-09 08:40:50,368 [INFO]: 	avg_search_speed_ms: 10.890683044592215
2025-03-09 08:40:50,368 [INFO]: 	99p_search_speed_ms: 21.574968795757755
2025-03-09 08:40:50,368 [INFO]: 	reconstruction error %: 0.0
2025-03-09 08:40:50,368 [INFO]: 	nb vectors: 2601
2025-03-09 08:40:50,368 [INFO]: 	vectors dimension: 49152
2025-03-09 08:40:50,368 [INFO]: 	compression ratio: 0.9993094767391064
2025-03-09 08:40:50,368 [INFO]: }
2025-03-09 08:40:50,368 [INFO]: 	>>> Finished "Creating the index" in 52.8027 secs
2025-03-09 08:40:50,368 [INFO]: >>> Finished "Launching the whole pipeline" in 52.8357 secs
2025-03-09 08:40:51: [retrieval_preprocessing] calculating distances ...
2025-03-09 08:40:51: [retrieval_preprocessing] finished and saved retrieval indices for episode 41004 [episode count 18/20]
[retrieval_preprocessing] for episode 59308 [episode count 19/20], we have num_retrieval=np.int64(2582) num_query=np.int64(138)
2025-03-09 08:40:51,788 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-09 08:40:52,721 [INFO]: Launching the whole pipeline 03/09/2025, 08:40:52
2025-03-09 08:40:52,721 [INFO]: Reading total number of vectors and dimension 03/09/2025, 08:40:52
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1168.00it/s]
2025-03-09 08:40:52,750 [INFO]: There are 2582 embeddings of dim 49152
2025-03-09 08:40:52,751 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0301 secs
2025-03-09 08:40:52,751 [INFO]: 	Compute estimated construction time of the index 03/09/2025, 08:40:52
2025-03-09 08:40:52,751 [INFO]: 		-> Train: 16.7 minutes
2025-03-09 08:40:52,751 [INFO]: 		-> Add: 1.4 seconds
2025-03-09 08:40:52,752 [INFO]: 		Total: 16.7 minutes
2025-03-09 08:40:52,752 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0004 secs
2025-03-09 08:40:52,752 [INFO]: 	Checking that your have enough memory available to create the index 03/09/2025, 08:40:52
2025-03-09 08:40:52,752 [INFO]: 532.9MB of memory will be needed to build the index (more might be used if you have more)
2025-03-09 08:40:52,752 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0004 secs
2025-03-09 08:40:52,753 [INFO]: 	Selecting most promising index types given data characteristics 03/09/2025, 08:40:52
2025-03-09 08:40:52,753 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-09 08:40:52,753 [INFO]: 	Creating the index 03/09/2025, 08:40:52
2025-03-09 08:40:52,753 [INFO]: 		-> Instanciate the index HNSW15 03/09/2025, 08:40:52
2025-03-09 08:40:52,756 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0028 secs
2025-03-09 08:40:52,756 [INFO]: 		-> Adding the vectors to the index 03/09/2025, 08:40:52
2025-03-09 08:40:52,756 [INFO]: The memory available for adding the vectors is 49.5GB(total available - used by the index)
2025-03-09 08:40:52,756 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/11 [00:00<?, ?it/s] 27%|██▋       | 3/11 [00:00<00:00, 26.59it/s] 82%|████████▏ | 9/11 [00:00<00:00, 41.83it/s]100%|██████████| 11/11 [00:02<00:00,  4.96it/s]
2025-03-09 08:40:54,978 [INFO]: 	Computing best hyperparameters for index knn.index 03/09/2025, 08:40:54
2025-03-09 08:41:22,817 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 27.8390 secs
2025-03-09 08:41:22,818 [INFO]: The best hyperparameters are: efSearch=225
2025-03-09 08:41:22,818 [INFO]: 	Compute fast metrics 03/09/2025, 08:41:22
  0%|          | 0/4 [00:00<?, ?it/s] 50%|█████     | 2/4 [00:00<00:00, 17.74it/s] 75%|███████▌  | 3/4 [00:00<00:00, 19.41it/s]
2025-03-09 08:41:37,471 [INFO]: 	>>> Finished "Compute fast metrics" in 14.6536 secs
2025-03-09 08:41:37,473 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 44.7165 secs
2025-03-09 08:41:37,473 [INFO]: {
2025-03-09 08:41:37,473 [INFO]: 	index_key: HNSW15
2025-03-09 08:41:37,473 [INFO]: 	index_param: efSearch=225
2025-03-09 08:41:37,473 [INFO]: 	index_path: knn.index
2025-03-09 08:41:37,473 [INFO]: 	size in bytes: 507992650
2025-03-09 08:41:37,473 [INFO]: 	avg_search_speed_ms: 10.858920462486152
2025-03-09 08:41:37,473 [INFO]: 	99p_search_speed_ms: 21.609398303553462
2025-03-09 08:41:37,473 [INFO]: 	reconstruction error %: 0.0
2025-03-09 08:41:37,473 [INFO]: 	nb vectors: 2582
2025-03-09 08:41:37,473 [INFO]: 	vectors dimension: 49152
2025-03-09 08:41:37,473 [INFO]: 	compression ratio: 0.9993094506387051
2025-03-09 08:41:37,473 [INFO]: }
2025-03-09 08:41:37,473 [INFO]: 	>>> Finished "Creating the index" in 44.7201 secs
2025-03-09 08:41:37,473 [INFO]: >>> Finished "Launching the whole pipeline" in 44.7523 secs
2025-03-09 08:41:37: [retrieval_preprocessing] calculating distances ...
2025-03-09 08:41:38: [retrieval_preprocessing] finished and saved retrieval indices for episode 59308 [episode count 19/20]
2025-03-09 08:41:38: [retrieval_preprocessing] finished for (8898968162, 'block') [chosen_id count 5/10]
2025-03-09 08:41:39: [retrieval_preprocessing] concatenated all embeddings and indices for 20 episodes for (-1, 'mug') [chosen_id count 6/10]
2025-03-09 08:41:39: [retrieval_preprocessing] we have num_total=2633 embedding_dim=49152
[retrieval_preprocessing] for episode 29189 [episode count 0/20], we have num_retrieval=np.int64(2545) num_query=np.int64(88)
2025-03-09 08:41:40,210 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-09 08:41:40,536 [INFO]: Launching the whole pipeline 03/09/2025, 08:41:40
2025-03-09 08:41:40,536 [INFO]: Reading total number of vectors and dimension 03/09/2025, 08:41:40
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 2305.83it/s]
2025-03-09 08:41:40,563 [INFO]: There are 2545 embeddings of dim 49152
2025-03-09 08:41:40,564 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0272 secs
2025-03-09 08:41:40,564 [INFO]: 	Compute estimated construction time of the index 03/09/2025, 08:41:40
2025-03-09 08:41:40,564 [INFO]: 		-> Train: 16.7 minutes
2025-03-09 08:41:40,564 [INFO]: 		-> Add: 1.4 seconds
2025-03-09 08:41:40,564 [INFO]: 		Total: 16.7 minutes
2025-03-09 08:41:40,564 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0003 secs
2025-03-09 08:41:40,564 [INFO]: 	Checking that your have enough memory available to create the index 03/09/2025, 08:41:40
2025-03-09 08:41:40,565 [INFO]: 525.2MB of memory will be needed to build the index (more might be used if you have more)
2025-03-09 08:41:40,565 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0005 secs
2025-03-09 08:41:40,565 [INFO]: 	Selecting most promising index types given data characteristics 03/09/2025, 08:41:40
2025-03-09 08:41:40,565 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-09 08:41:40,565 [INFO]: 	Creating the index 03/09/2025, 08:41:40
2025-03-09 08:41:40,566 [INFO]: 		-> Instanciate the index HNSW15 03/09/2025, 08:41:40
2025-03-09 08:41:40,568 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0025 secs
2025-03-09 08:41:40,568 [INFO]: 		-> Adding the vectors to the index 03/09/2025, 08:41:40
2025-03-09 08:41:40,569 [INFO]: The memory available for adding the vectors is 49.5GB(total available - used by the index)
2025-03-09 08:41:40,569 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/11 [00:00<?, ?it/s] 27%|██▋       | 3/11 [00:00<00:00, 20.58it/s] 73%|███████▎  | 8/11 [00:00<00:00, 33.43it/s]100%|██████████| 11/11 [00:01<00:00,  6.04it/s]
2025-03-09 08:41:42,397 [INFO]: 	Computing best hyperparameters for index knn.index 03/09/2025, 08:41:42
2025-03-09 08:42:10,427 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 28.0303 secs
2025-03-09 08:42:10,428 [INFO]: The best hyperparameters are: efSearch=177
2025-03-09 08:42:10,428 [INFO]: 	Compute fast metrics 03/09/2025, 08:42:10
  0%|          | 0/4 [00:00<?, ?it/s] 50%|█████     | 2/4 [00:00<00:00, 19.74it/s] 75%|███████▌  | 3/4 [00:00<00:00, 21.41it/s]
2025-03-09 08:42:27,943 [INFO]: 	>>> Finished "Compute fast metrics" in 17.5155 secs
2025-03-09 08:42:27,945 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 47.3762 secs
2025-03-09 08:42:27,945 [INFO]: {
2025-03-09 08:42:27,945 [INFO]: 	index_key: HNSW15
2025-03-09 08:42:27,945 [INFO]: 	index_param: efSearch=177
2025-03-09 08:42:27,945 [INFO]: 	index_path: knn.index
2025-03-09 08:42:27,945 [INFO]: 	size in bytes: 500713090
2025-03-09 08:42:27,945 [INFO]: 	avg_search_speed_ms: 7.301401467585977
2025-03-09 08:42:27,945 [INFO]: 	99p_search_speed_ms: 15.479641326237443
2025-03-09 08:42:27,945 [INFO]: 	reconstruction error %: 0.0
2025-03-09 08:42:27,945 [INFO]: 	nb vectors: 2545
2025-03-09 08:42:27,945 [INFO]: 	vectors dimension: 49152
2025-03-09 08:42:27,945 [INFO]: 	compression ratio: 0.9993095247420034
2025-03-09 08:42:27,945 [INFO]: }
2025-03-09 08:42:27,945 [INFO]: 	>>> Finished "Creating the index" in 47.3795 secs
2025-03-09 08:42:27,945 [INFO]: >>> Finished "Launching the whole pipeline" in 47.4085 secs
2025-03-09 08:42:28: [retrieval_preprocessing] calculating distances ...
2025-03-09 08:42:28: [retrieval_preprocessing] finished and saved retrieval indices for episode 29189 [episode count 0/20]
[retrieval_preprocessing] for episode 83461 [episode count 1/20], we have num_retrieval=np.int64(2514) num_query=np.int64(119)
2025-03-09 08:42:28,830 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-09 08:42:29,875 [INFO]: Launching the whole pipeline 03/09/2025, 08:42:29
2025-03-09 08:42:29,875 [INFO]: Reading total number of vectors and dimension 03/09/2025, 08:42:29
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 2056.03it/s]
2025-03-09 08:42:29,899 [INFO]: There are 2514 embeddings of dim 49152
2025-03-09 08:42:29,900 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0242 secs
2025-03-09 08:42:29,900 [INFO]: 	Compute estimated construction time of the index 03/09/2025, 08:42:29
2025-03-09 08:42:29,900 [INFO]: 		-> Train: 16.7 minutes
2025-03-09 08:42:29,900 [INFO]: 		-> Add: 1.4 seconds
2025-03-09 08:42:29,900 [INFO]: 		Total: 16.7 minutes
2025-03-09 08:42:29,900 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0001 secs
2025-03-09 08:42:29,900 [INFO]: 	Checking that your have enough memory available to create the index 03/09/2025, 08:42:29
2025-03-09 08:42:29,900 [INFO]: 518.8MB of memory will be needed to build the index (more might be used if you have more)
2025-03-09 08:42:29,900 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0002 secs
2025-03-09 08:42:29,900 [INFO]: 	Selecting most promising index types given data characteristics 03/09/2025, 08:42:29
2025-03-09 08:42:29,900 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-09 08:42:29,900 [INFO]: 	Creating the index 03/09/2025, 08:42:29
2025-03-09 08:42:29,900 [INFO]: 		-> Instanciate the index HNSW15 03/09/2025, 08:42:29
2025-03-09 08:42:29,901 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0010 secs
2025-03-09 08:42:29,901 [INFO]: 		-> Adding the vectors to the index 03/09/2025, 08:42:29
2025-03-09 08:42:29,901 [INFO]: The memory available for adding the vectors is 49.5GB(total available - used by the index)
2025-03-09 08:42:29,901 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/10 [00:00<?, ?it/s] 20%|██        | 2/10 [00:00<00:00, 17.34it/s] 80%|████████  | 8/10 [00:00<00:00, 38.67it/s]100%|██████████| 10/10 [00:01<00:00,  5.71it/s]
2025-03-09 08:42:31,656 [INFO]: 	Computing best hyperparameters for index knn.index 03/09/2025, 08:42:31
2025-03-09 08:42:58,965 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 27.3085 secs
2025-03-09 08:42:58,965 [INFO]: The best hyperparameters are: efSearch=253
2025-03-09 08:42:58,966 [INFO]: 	Compute fast metrics 03/09/2025, 08:42:58
  0%|          | 0/4 [00:00<?, ?it/s] 50%|█████     | 2/4 [00:00<00:00, 19.80it/s] 75%|███████▌  | 3/4 [00:00<00:00, 18.68it/s]
2025-03-09 08:43:13,732 [INFO]: 	>>> Finished "Compute fast metrics" in 14.7662 secs
2025-03-09 08:43:13,734 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 43.8322 secs
2025-03-09 08:43:13,734 [INFO]: {
2025-03-09 08:43:13,734 [INFO]: 	index_key: HNSW15
2025-03-09 08:43:13,734 [INFO]: 	index_param: efSearch=253
2025-03-09 08:43:13,734 [INFO]: 	index_path: knn.index
2025-03-09 08:43:13,734 [INFO]: 	size in bytes: 494613850
2025-03-09 08:43:13,734 [INFO]: 	avg_search_speed_ms: 10.83045753975927
2025-03-09 08:43:13,734 [INFO]: 	99p_search_speed_ms: 25.184273615013804
2025-03-09 08:43:13,734 [INFO]: 	reconstruction error %: 0.0
2025-03-09 08:43:13,734 [INFO]: 	nb vectors: 2514
2025-03-09 08:43:13,734 [INFO]: 	vectors dimension: 49152
2025-03-09 08:43:13,734 [INFO]: 	compression ratio: 0.9993098899272634
2025-03-09 08:43:13,734 [INFO]: }
2025-03-09 08:43:13,734 [INFO]: 	>>> Finished "Creating the index" in 43.8337 secs
2025-03-09 08:43:13,734 [INFO]: >>> Finished "Launching the whole pipeline" in 43.8586 secs
2025-03-09 08:43:14: [retrieval_preprocessing] calculating distances ...
2025-03-09 08:43:15: [retrieval_preprocessing] finished and saved retrieval indices for episode 83461 [episode count 1/20]
[retrieval_preprocessing] for episode 52231 [episode count 2/20], we have num_retrieval=np.int64(2448) num_query=np.int64(185)
2025-03-09 08:43:15,268 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-09 08:43:15,671 [INFO]: Launching the whole pipeline 03/09/2025, 08:43:15
2025-03-09 08:43:15,671 [INFO]: Reading total number of vectors and dimension 03/09/2025, 08:43:15
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1346.49it/s]
2025-03-09 08:43:15,700 [INFO]: There are 2448 embeddings of dim 49152
2025-03-09 08:43:15,701 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0296 secs
2025-03-09 08:43:15,701 [INFO]: 	Compute estimated construction time of the index 03/09/2025, 08:43:15
2025-03-09 08:43:15,701 [INFO]: 		-> Train: 16.7 minutes
2025-03-09 08:43:15,701 [INFO]: 		-> Add: 1.3 seconds
2025-03-09 08:43:15,701 [INFO]: 		Total: 16.7 minutes
2025-03-09 08:43:15,701 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0003 secs
2025-03-09 08:43:15,702 [INFO]: 	Checking that your have enough memory available to create the index 03/09/2025, 08:43:15
2025-03-09 08:43:15,702 [INFO]: 505.2MB of memory will be needed to build the index (more might be used if you have more)
2025-03-09 08:43:15,702 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0004 secs
2025-03-09 08:43:15,702 [INFO]: 	Selecting most promising index types given data characteristics 03/09/2025, 08:43:15
2025-03-09 08:43:15,702 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-09 08:43:15,702 [INFO]: 	Creating the index 03/09/2025, 08:43:15
2025-03-09 08:43:15,702 [INFO]: 		-> Instanciate the index HNSW15 03/09/2025, 08:43:15
2025-03-09 08:43:15,705 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0028 secs
2025-03-09 08:43:15,706 [INFO]: 		-> Adding the vectors to the index 03/09/2025, 08:43:15
2025-03-09 08:43:15,706 [INFO]: The memory available for adding the vectors is 49.6GB(total available - used by the index)
2025-03-09 08:43:15,706 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/10 [00:00<?, ?it/s] 30%|███       | 3/10 [00:00<00:00, 27.81it/s] 90%|█████████ | 9/10 [00:00<00:00, 45.81it/s]100%|██████████| 10/10 [00:01<00:00,  5.97it/s]
2025-03-09 08:43:17,912 [INFO]: 	Computing best hyperparameters for index knn.index 03/09/2025, 08:43:17
2025-03-09 08:43:42,778 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 24.8660 secs
2025-03-09 08:43:42,779 [INFO]: The best hyperparameters are: efSearch=249
2025-03-09 08:43:42,779 [INFO]: 	Compute fast metrics 03/09/2025, 08:43:42
  0%|          | 0/4 [00:00<?, ?it/s] 50%|█████     | 2/4 [00:00<00:00, 18.53it/s] 75%|███████▌  | 3/4 [00:00<00:00, 18.82it/s]
2025-03-09 08:43:57,648 [INFO]: 	>>> Finished "Compute fast metrics" in 14.8696 secs
2025-03-09 08:43:57,650 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 41.9439 secs
2025-03-09 08:43:57,650 [INFO]: {
2025-03-09 08:43:57,650 [INFO]: 	index_key: HNSW15
2025-03-09 08:43:57,650 [INFO]: 	index_param: efSearch=249
2025-03-09 08:43:57,650 [INFO]: 	index_path: knn.index
2025-03-09 08:43:57,650 [INFO]: 	size in bytes: 481628710
2025-03-09 08:43:57,650 [INFO]: 	avg_search_speed_ms: 9.142668107337228
2025-03-09 08:43:57,650 [INFO]: 	99p_search_speed_ms: 17.977844360284504
2025-03-09 08:43:57,650 [INFO]: 	reconstruction error %: 0.0
2025-03-09 08:43:57,650 [INFO]: 	nb vectors: 2448
2025-03-09 08:43:57,650 [INFO]: 	vectors dimension: 49152
2025-03-09 08:43:57,650 [INFO]: 	compression ratio: 0.9993099954527213
2025-03-09 08:43:57,650 [INFO]: }
2025-03-09 08:43:57,650 [INFO]: 	>>> Finished "Creating the index" in 41.9476 secs
2025-03-09 08:43:57,650 [INFO]: >>> Finished "Launching the whole pipeline" in 41.9788 secs
2025-03-09 08:43:58: [retrieval_preprocessing] calculating distances ...
2025-03-09 08:43:59: [retrieval_preprocessing] finished and saved retrieval indices for episode 52231 [episode count 2/20]
[retrieval_preprocessing] for episode 66568 [episode count 3/20], we have num_retrieval=np.int64(2559) num_query=np.int64(74)
2025-03-09 08:43:59,639 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-09 08:43:59,986 [INFO]: Launching the whole pipeline 03/09/2025, 08:43:59
2025-03-09 08:43:59,986 [INFO]: Reading total number of vectors and dimension 03/09/2025, 08:43:59
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1113.43it/s]
2025-03-09 08:44:00,013 [INFO]: There are 2559 embeddings of dim 49152
2025-03-09 08:44:00,014 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0277 secs
2025-03-09 08:44:00,014 [INFO]: 	Compute estimated construction time of the index 03/09/2025, 08:44:00
2025-03-09 08:44:00,014 [INFO]: 		-> Train: 16.7 minutes
2025-03-09 08:44:00,014 [INFO]: 		-> Add: 1.4 seconds
2025-03-09 08:44:00,014 [INFO]: 		Total: 16.7 minutes
2025-03-09 08:44:00,014 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0003 secs
2025-03-09 08:44:00,015 [INFO]: 	Checking that your have enough memory available to create the index 03/09/2025, 08:44:00
2025-03-09 08:44:00,015 [INFO]: 528.1MB of memory will be needed to build the index (more might be used if you have more)
2025-03-09 08:44:00,015 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0005 secs
2025-03-09 08:44:00,015 [INFO]: 	Selecting most promising index types given data characteristics 03/09/2025, 08:44:00
2025-03-09 08:44:00,015 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-09 08:44:00,016 [INFO]: 	Creating the index 03/09/2025, 08:44:00
2025-03-09 08:44:00,016 [INFO]: 		-> Instanciate the index HNSW15 03/09/2025, 08:44:00
2025-03-09 08:44:00,018 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0025 secs
2025-03-09 08:44:00,018 [INFO]: 		-> Adding the vectors to the index 03/09/2025, 08:44:00
2025-03-09 08:44:00,019 [INFO]: The memory available for adding the vectors is 49.5GB(total available - used by the index)
2025-03-09 08:44:00,019 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/11 [00:00<?, ?it/s] 18%|█▊        | 2/11 [00:00<00:00, 18.97it/s] 64%|██████▎   | 7/11 [00:00<00:00, 36.61it/s]100%|██████████| 11/11 [00:01<00:00,  4.62it/s]100%|██████████| 11/11 [00:01<00:00,  5.73it/s]
2025-03-09 08:44:01,945 [INFO]: 	Computing best hyperparameters for index knn.index 03/09/2025, 08:44:01
2025-03-09 08:44:27,837 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 25.8911 secs
2025-03-09 08:44:27,837 [INFO]: The best hyperparameters are: efSearch=208
2025-03-09 08:44:27,837 [INFO]: 	Compute fast metrics 03/09/2025, 08:44:27
  0%|          | 0/4 [00:00<?, ?it/s] 50%|█████     | 2/4 [00:00<00:00, 19.56it/s] 75%|███████▌  | 3/4 [00:00<00:00, 21.13it/s]
2025-03-09 08:44:42,569 [INFO]: 	>>> Finished "Compute fast metrics" in 14.7319 secs
2025-03-09 08:44:42,571 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 42.5522 secs
2025-03-09 08:44:42,571 [INFO]: {
2025-03-09 08:44:42,571 [INFO]: 	index_key: HNSW15
2025-03-09 08:44:42,571 [INFO]: 	index_param: efSearch=208
2025-03-09 08:44:42,571 [INFO]: 	index_path: knn.index
2025-03-09 08:44:42,571 [INFO]: 	size in bytes: 503467450
2025-03-09 08:44:42,571 [INFO]: 	avg_search_speed_ms: 7.4513337620701945
2025-03-09 08:44:42,571 [INFO]: 	99p_search_speed_ms: 11.030826056376094
2025-03-09 08:44:42,571 [INFO]: 	reconstruction error %: 0.0
2025-03-09 08:44:42,571 [INFO]: 	nb vectors: 2559
2025-03-09 08:44:42,571 [INFO]: 	vectors dimension: 49152
2025-03-09 08:44:42,571 [INFO]: 	compression ratio: 0.9993096316355705
2025-03-09 08:44:42,571 [INFO]: }
2025-03-09 08:44:42,571 [INFO]: 	>>> Finished "Creating the index" in 42.5555 secs
2025-03-09 08:44:42,571 [INFO]: >>> Finished "Launching the whole pipeline" in 42.5851 secs
2025-03-09 08:44:43: [retrieval_preprocessing] calculating distances ...
2025-03-09 08:44:43: [retrieval_preprocessing] finished and saved retrieval indices for episode 66568 [episode count 3/20]
[retrieval_preprocessing] for episode 81928 [episode count 4/20], we have num_retrieval=np.int64(2468) num_query=np.int64(165)
2025-03-09 08:44:43,566 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-09 08:44:43,871 [INFO]: Launching the whole pipeline 03/09/2025, 08:44:43
2025-03-09 08:44:43,871 [INFO]: Reading total number of vectors and dimension 03/09/2025, 08:44:43
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1283.45it/s]
2025-03-09 08:44:43,903 [INFO]: There are 2468 embeddings of dim 49152
2025-03-09 08:44:43,903 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0324 secs
2025-03-09 08:44:43,904 [INFO]: 	Compute estimated construction time of the index 03/09/2025, 08:44:43
2025-03-09 08:44:43,904 [INFO]: 		-> Train: 16.7 minutes
2025-03-09 08:44:43,904 [INFO]: 		-> Add: 1.4 seconds
2025-03-09 08:44:43,904 [INFO]: 		Total: 16.7 minutes
2025-03-09 08:44:43,904 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0003 secs
2025-03-09 08:44:43,904 [INFO]: 	Checking that your have enough memory available to create the index 03/09/2025, 08:44:43
2025-03-09 08:44:43,904 [INFO]: 509.3MB of memory will be needed to build the index (more might be used if you have more)
2025-03-09 08:44:43,904 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0004 secs
2025-03-09 08:44:43,905 [INFO]: 	Selecting most promising index types given data characteristics 03/09/2025, 08:44:43
2025-03-09 08:44:43,905 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-09 08:44:43,905 [INFO]: 	Creating the index 03/09/2025, 08:44:43
2025-03-09 08:44:43,905 [INFO]: 		-> Instanciate the index HNSW15 03/09/2025, 08:44:43
2025-03-09 08:44:43,908 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0026 secs
2025-03-09 08:44:43,908 [INFO]: 		-> Adding the vectors to the index 03/09/2025, 08:44:43
2025-03-09 08:44:43,908 [INFO]: The memory available for adding the vectors is 49.5GB(total available - used by the index)
2025-03-09 08:44:43,908 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/10 [00:00<?, ?it/s] 30%|███       | 3/10 [00:00<00:00, 26.29it/s]100%|██████████| 10/10 [00:01<00:00,  5.68it/s]100%|██████████| 10/10 [00:01<00:00,  6.10it/s]
2025-03-09 08:44:45,886 [INFO]: 	Computing best hyperparameters for index knn.index 03/09/2025, 08:44:45
2025-03-09 08:45:09,084 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 23.1984 secs
2025-03-09 08:45:09,085 [INFO]: The best hyperparameters are: efSearch=291
2025-03-09 08:45:09,085 [INFO]: 	Compute fast metrics 03/09/2025, 08:45:09
  0%|          | 0/4 [00:00<?, ?it/s] 50%|█████     | 2/4 [00:00<00:00, 19.83it/s] 75%|███████▌  | 3/4 [00:00<00:00, 21.77it/s]
2025-03-09 08:45:24,714 [INFO]: 	>>> Finished "Compute fast metrics" in 15.6289 secs
2025-03-09 08:45:24,716 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 40.8078 secs
2025-03-09 08:45:24,716 [INFO]: {
2025-03-09 08:45:24,716 [INFO]: 	index_key: HNSW15
2025-03-09 08:45:24,716 [INFO]: 	index_param: efSearch=291
2025-03-09 08:45:24,716 [INFO]: 	index_path: knn.index
2025-03-09 08:45:24,716 [INFO]: 	size in bytes: 485563570
2025-03-09 08:45:24,716 [INFO]: 	avg_search_speed_ms: 11.174933443251769
2025-03-09 08:45:24,716 [INFO]: 	99p_search_speed_ms: 18.708615247160182
2025-03-09 08:45:24,716 [INFO]: 	reconstruction error %: 0.0
2025-03-09 08:45:24,716 [INFO]: 	nb vectors: 2468
2025-03-09 08:45:24,716 [INFO]: 	vectors dimension: 49152
2025-03-09 08:45:24,716 [INFO]: 	compression ratio: 0.9993100264914849
2025-03-09 08:45:24,716 [INFO]: }
2025-03-09 08:45:24,716 [INFO]: 	>>> Finished "Creating the index" in 40.8113 secs
2025-03-09 08:45:24,716 [INFO]: >>> Finished "Launching the whole pipeline" in 40.8454 secs
2025-03-09 08:45:26: [retrieval_preprocessing] calculating distances ...
2025-03-09 08:45:26: [retrieval_preprocessing] finished and saved retrieval indices for episode 81928 [episode count 4/20]
[retrieval_preprocessing] for episode 85520 [episode count 5/20], we have num_retrieval=np.int64(2508) num_query=np.int64(125)
2025-03-09 08:45:26,938 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-09 08:45:27,276 [INFO]: Launching the whole pipeline 03/09/2025, 08:45:27
2025-03-09 08:45:27,277 [INFO]: Reading total number of vectors and dimension 03/09/2025, 08:45:27
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 2052.01it/s]
2025-03-09 08:45:27,301 [INFO]: There are 2508 embeddings of dim 49152
2025-03-09 08:45:27,302 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0249 secs
2025-03-09 08:45:27,302 [INFO]: 	Compute estimated construction time of the index 03/09/2025, 08:45:27
2025-03-09 08:45:27,302 [INFO]: 		-> Train: 16.7 minutes
2025-03-09 08:45:27,302 [INFO]: 		-> Add: 1.4 seconds
2025-03-09 08:45:27,302 [INFO]: 		Total: 16.7 minutes
2025-03-09 08:45:27,302 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0001 secs
2025-03-09 08:45:27,302 [INFO]: 	Checking that your have enough memory available to create the index 03/09/2025, 08:45:27
2025-03-09 08:45:27,302 [INFO]: 517.6MB of memory will be needed to build the index (more might be used if you have more)
2025-03-09 08:45:27,302 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0001 secs
2025-03-09 08:45:27,302 [INFO]: 	Selecting most promising index types given data characteristics 03/09/2025, 08:45:27
2025-03-09 08:45:27,302 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-09 08:45:27,302 [INFO]: 	Creating the index 03/09/2025, 08:45:27
2025-03-09 08:45:27,302 [INFO]: 		-> Instanciate the index HNSW15 03/09/2025, 08:45:27
2025-03-09 08:45:27,303 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0009 secs
2025-03-09 08:45:27,303 [INFO]: 		-> Adding the vectors to the index 03/09/2025, 08:45:27
2025-03-09 08:45:27,303 [INFO]: The memory available for adding the vectors is 49.5GB(total available - used by the index)
2025-03-09 08:45:27,303 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/10 [00:00<?, ?it/s] 10%|█         | 1/10 [00:00<00:01,  8.92it/s] 70%|███████   | 7/10 [00:00<00:00, 35.74it/s]100%|██████████| 10/10 [00:01<00:00,  5.61it/s]
2025-03-09 08:45:29,089 [INFO]: 	Computing best hyperparameters for index knn.index 03/09/2025, 08:45:29
2025-03-09 08:45:53,779 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 24.6903 secs
2025-03-09 08:45:53,780 [INFO]: The best hyperparameters are: efSearch=293
2025-03-09 08:45:53,780 [INFO]: 	Compute fast metrics 03/09/2025, 08:45:53
  0%|          | 0/4 [00:00<?, ?it/s] 75%|███████▌  | 3/4 [00:00<00:00, 26.10it/s] 75%|███████▌  | 3/4 [00:00<00:00, 22.54it/s]
2025-03-09 08:46:12,170 [INFO]: 	>>> Finished "Compute fast metrics" in 18.3903 secs
2025-03-09 08:46:12,172 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 44.8685 secs
2025-03-09 08:46:12,172 [INFO]: {
2025-03-09 08:46:12,172 [INFO]: 	index_key: HNSW15
2025-03-09 08:46:12,172 [INFO]: 	index_param: efSearch=293
2025-03-09 08:46:12,172 [INFO]: 	index_path: knn.index
2025-03-09 08:46:12,172 [INFO]: 	size in bytes: 493433350
2025-03-09 08:46:12,172 [INFO]: 	avg_search_speed_ms: 10.751806763351285
2025-03-09 08:46:12,172 [INFO]: 	99p_search_speed_ms: 20.37465956760572
2025-03-09 08:46:12,172 [INFO]: 	reconstruction error %: 0.0
2025-03-09 08:46:12,172 [INFO]: 	nb vectors: 2508
2025-03-09 08:46:12,172 [INFO]: 	vectors dimension: 49152
2025-03-09 08:46:12,172 [INFO]: 	compression ratio: 0.9993099655708314
2025-03-09 08:46:12,172 [INFO]: }
2025-03-09 08:46:12,172 [INFO]: 	>>> Finished "Creating the index" in 44.8700 secs
2025-03-09 08:46:12,172 [INFO]: >>> Finished "Launching the whole pipeline" in 44.8955 secs
2025-03-09 08:46:13: [retrieval_preprocessing] calculating distances ...
2025-03-09 08:46:13: [retrieval_preprocessing] finished and saved retrieval indices for episode 85520 [episode count 5/20]
[retrieval_preprocessing] for episode 59922 [episode count 6/20], we have num_retrieval=np.int64(2432) num_query=np.int64(201)
2025-03-09 08:46:13,865 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-09 08:46:14,836 [INFO]: Launching the whole pipeline 03/09/2025, 08:46:14
2025-03-09 08:46:14,836 [INFO]: Reading total number of vectors and dimension 03/09/2025, 08:46:14
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 2072.28it/s]
2025-03-09 08:46:14,859 [INFO]: There are 2432 embeddings of dim 49152
2025-03-09 08:46:14,860 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0238 secs
2025-03-09 08:46:14,860 [INFO]: 	Compute estimated construction time of the index 03/09/2025, 08:46:14
2025-03-09 08:46:14,860 [INFO]: 		-> Train: 16.7 minutes
2025-03-09 08:46:14,860 [INFO]: 		-> Add: 1.3 seconds
2025-03-09 08:46:14,860 [INFO]: 		Total: 16.7 minutes
2025-03-09 08:46:14,860 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0001 secs
2025-03-09 08:46:14,860 [INFO]: 	Checking that your have enough memory available to create the index 03/09/2025, 08:46:14
2025-03-09 08:46:14,860 [INFO]: 501.9MB of memory will be needed to build the index (more might be used if you have more)
2025-03-09 08:46:14,860 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0001 secs
2025-03-09 08:46:14,860 [INFO]: 	Selecting most promising index types given data characteristics 03/09/2025, 08:46:14
2025-03-09 08:46:14,860 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-09 08:46:14,860 [INFO]: 	Creating the index 03/09/2025, 08:46:14
2025-03-09 08:46:14,860 [INFO]: 		-> Instanciate the index HNSW15 03/09/2025, 08:46:14
2025-03-09 08:46:14,861 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0009 secs
2025-03-09 08:46:14,861 [INFO]: 		-> Adding the vectors to the index 03/09/2025, 08:46:14
2025-03-09 08:46:14,861 [INFO]: The memory available for adding the vectors is 49.6GB(total available - used by the index)
2025-03-09 08:46:14,861 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/10 [00:00<?, ?it/s] 10%|█         | 1/10 [00:00<00:01,  7.21it/s] 40%|████      | 4/10 [00:00<00:00, 17.50it/s]100%|██████████| 10/10 [00:02<00:00,  4.52it/s]100%|██████████| 10/10 [00:02<00:00,  4.98it/s]
2025-03-09 08:46:16,872 [INFO]: 	Computing best hyperparameters for index knn.index 03/09/2025, 08:46:16
2025-03-09 08:46:43,546 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 26.6738 secs
2025-03-09 08:46:43,546 [INFO]: The best hyperparameters are: efSearch=261
2025-03-09 08:46:43,546 [INFO]: 	Compute fast metrics 03/09/2025, 08:46:43
  0%|          | 0/4 [00:00<?, ?it/s] 50%|█████     | 2/4 [00:00<00:00, 16.49it/s] 75%|███████▌  | 3/4 [00:00<00:00, 17.96it/s]
2025-03-09 08:46:56,564 [INFO]: 	>>> Finished "Compute fast metrics" in 13.0180 secs
2025-03-09 08:46:56,682 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 41.8204 secs
2025-03-09 08:46:56,682 [INFO]: {
2025-03-09 08:46:56,682 [INFO]: 	index_key: HNSW15
2025-03-09 08:46:56,682 [INFO]: 	index_param: efSearch=261
2025-03-09 08:46:56,682 [INFO]: 	index_path: knn.index
2025-03-09 08:46:56,682 [INFO]: 	size in bytes: 478480870
2025-03-09 08:46:56,682 [INFO]: 	avg_search_speed_ms: 10.61246448296326
2025-03-09 08:46:56,682 [INFO]: 	99p_search_speed_ms: 25.091882015112787
2025-03-09 08:46:56,682 [INFO]: 	reconstruction error %: 0.0
2025-03-09 08:46:56,682 [INFO]: 	nb vectors: 2432
2025-03-09 08:46:56,682 [INFO]: 	vectors dimension: 49152
2025-03-09 08:46:56,682 [INFO]: 	compression ratio: 0.9993098700058792
2025-03-09 08:46:56,682 [INFO]: }
2025-03-09 08:46:56,683 [INFO]: 	>>> Finished "Creating the index" in 41.8225 secs
2025-03-09 08:46:56,683 [INFO]: >>> Finished "Launching the whole pipeline" in 41.8469 secs
2025-03-09 08:46:58: [retrieval_preprocessing] calculating distances ...
2025-03-09 08:46:58: [retrieval_preprocessing] finished and saved retrieval indices for episode 59922 [episode count 6/20]
[retrieval_preprocessing] for episode 5653 [episode count 7/20], we have num_retrieval=np.int64(2529) num_query=np.int64(104)
2025-03-09 08:46:59,064 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-09 08:46:59,471 [INFO]: Launching the whole pipeline 03/09/2025, 08:46:59
2025-03-09 08:46:59,471 [INFO]: Reading total number of vectors and dimension 03/09/2025, 08:46:59
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1481.56it/s]
2025-03-09 08:46:59,497 [INFO]: There are 2529 embeddings of dim 49152
2025-03-09 08:46:59,497 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0255 secs
2025-03-09 08:46:59,497 [INFO]: 	Compute estimated construction time of the index 03/09/2025, 08:46:59
2025-03-09 08:46:59,497 [INFO]: 		-> Train: 16.7 minutes
2025-03-09 08:46:59,497 [INFO]: 		-> Add: 1.4 seconds
2025-03-09 08:46:59,497 [INFO]: 		Total: 16.7 minutes
2025-03-09 08:46:59,497 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0001 secs
2025-03-09 08:46:59,497 [INFO]: 	Checking that your have enough memory available to create the index 03/09/2025, 08:46:59
2025-03-09 08:46:59,497 [INFO]: 521.9MB of memory will be needed to build the index (more might be used if you have more)
2025-03-09 08:46:59,497 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0001 secs
2025-03-09 08:46:59,497 [INFO]: 	Selecting most promising index types given data characteristics 03/09/2025, 08:46:59
2025-03-09 08:46:59,497 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-09 08:46:59,497 [INFO]: 	Creating the index 03/09/2025, 08:46:59
2025-03-09 08:46:59,497 [INFO]: 		-> Instanciate the index HNSW15 03/09/2025, 08:46:59
2025-03-09 08:46:59,498 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0009 secs
2025-03-09 08:46:59,498 [INFO]: 		-> Adding the vectors to the index 03/09/2025, 08:46:59
2025-03-09 08:46:59,498 [INFO]: The memory available for adding the vectors is 49.5GB(total available - used by the index)
2025-03-09 08:46:59,498 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/10 [00:00<?, ?it/s] 30%|███       | 3/10 [00:00<00:00, 25.96it/s] 90%|█████████ | 9/10 [00:00<00:00, 43.29it/s]100%|██████████| 10/10 [00:01<00:00,  5.52it/s]
2025-03-09 08:47:01,313 [INFO]: 	Computing best hyperparameters for index knn.index 03/09/2025, 08:47:01
2025-03-09 08:47:29,108 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 27.7949 secs
2025-03-09 08:47:29,108 [INFO]: The best hyperparameters are: efSearch=287
2025-03-09 08:47:29,109 [INFO]: 	Compute fast metrics 03/09/2025, 08:47:29
  0%|          | 0/4 [00:00<?, ?it/s] 75%|███████▌  | 3/4 [00:00<00:00, 25.41it/s] 75%|███████▌  | 3/4 [00:00<00:00, 21.35it/s]
2025-03-09 08:47:43,991 [INFO]: 	>>> Finished "Compute fast metrics" in 14.8828 secs
2025-03-09 08:47:43,993 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 44.4947 secs
2025-03-09 08:47:43,993 [INFO]: {
2025-03-09 08:47:43,993 [INFO]: 	index_key: HNSW15
2025-03-09 08:47:43,993 [INFO]: 	index_param: efSearch=287
2025-03-09 08:47:43,993 [INFO]: 	index_path: knn.index
2025-03-09 08:47:43,993 [INFO]: 	size in bytes: 497565130
2025-03-09 08:47:43,993 [INFO]: 	avg_search_speed_ms: 12.6091872443519
2025-03-09 08:47:43,993 [INFO]: 	99p_search_speed_ms: 28.228392582386796
2025-03-09 08:47:43,993 [INFO]: 	reconstruction error %: 0.0
2025-03-09 08:47:43,993 [INFO]: 	nb vectors: 2529
2025-03-09 08:47:43,993 [INFO]: 	vectors dimension: 49152
2025-03-09 08:47:43,993 [INFO]: 	compression ratio: 0.9993096421366988
2025-03-09 08:47:43,994 [INFO]: }
2025-03-09 08:47:43,994 [INFO]: 	>>> Finished "Creating the index" in 44.4961 secs
2025-03-09 08:47:43,994 [INFO]: >>> Finished "Launching the whole pipeline" in 44.5222 secs
2025-03-09 08:47:44: [retrieval_preprocessing] calculating distances ...
2025-03-09 08:47:45: [retrieval_preprocessing] finished and saved retrieval indices for episode 5653 [episode count 7/20]
[retrieval_preprocessing] for episode 35865 [episode count 8/20], we have num_retrieval=np.int64(2537) num_query=np.int64(96)
2025-03-09 08:47:45,509 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-09 08:47:46,036 [INFO]: Launching the whole pipeline 03/09/2025, 08:47:46
2025-03-09 08:47:46,036 [INFO]: Reading total number of vectors and dimension 03/09/2025, 08:47:46
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1291.35it/s]
2025-03-09 08:47:46,069 [INFO]: There are 2537 embeddings of dim 49152
2025-03-09 08:47:46,070 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0335 secs
2025-03-09 08:47:46,070 [INFO]: 	Compute estimated construction time of the index 03/09/2025, 08:47:46
2025-03-09 08:47:46,070 [INFO]: 		-> Train: 16.7 minutes
2025-03-09 08:47:46,070 [INFO]: 		-> Add: 1.4 seconds
2025-03-09 08:47:46,070 [INFO]: 		Total: 16.7 minutes
2025-03-09 08:47:46,070 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0001 secs
2025-03-09 08:47:46,070 [INFO]: 	Checking that your have enough memory available to create the index 03/09/2025, 08:47:46
2025-03-09 08:47:46,070 [INFO]: 523.6MB of memory will be needed to build the index (more might be used if you have more)
2025-03-09 08:47:46,070 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0002 secs
2025-03-09 08:47:46,070 [INFO]: 	Selecting most promising index types given data characteristics 03/09/2025, 08:47:46
2025-03-09 08:47:46,070 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-09 08:47:46,070 [INFO]: 	Creating the index 03/09/2025, 08:47:46
2025-03-09 08:47:46,070 [INFO]: 		-> Instanciate the index HNSW15 03/09/2025, 08:47:46
2025-03-09 08:47:46,072 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0013 secs
2025-03-09 08:47:46,072 [INFO]: 		-> Adding the vectors to the index 03/09/2025, 08:47:46
2025-03-09 08:47:46,072 [INFO]: The memory available for adding the vectors is 49.5GB(total available - used by the index)
2025-03-09 08:47:46,072 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/10 [00:00<?, ?it/s] 10%|█         | 1/10 [00:00<00:01,  5.41it/s] 50%|█████     | 5/10 [00:00<00:00, 20.08it/s] 90%|█████████ | 9/10 [00:00<00:00, 26.89it/s]100%|██████████| 10/10 [00:02<00:00,  3.50it/s]
2025-03-09 08:47:48,936 [INFO]: 	Computing best hyperparameters for index knn.index 03/09/2025, 08:47:48
2025-03-09 08:48:20,332 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 31.3948 secs
2025-03-09 08:48:20,332 [INFO]: The best hyperparameters are: efSearch=273
2025-03-09 08:48:20,332 [INFO]: 	Compute fast metrics 03/09/2025, 08:48:20
  0%|          | 0/4 [00:00<?, ?it/s] 50%|█████     | 2/4 [00:00<00:00, 19.42it/s] 75%|███████▌  | 3/4 [00:00<00:00, 20.93it/s]
2025-03-09 08:48:35,652 [INFO]: 	>>> Finished "Compute fast metrics" in 15.3198 secs
2025-03-09 08:48:35,653 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 49.5816 secs
2025-03-09 08:48:35,654 [INFO]: {
2025-03-09 08:48:35,654 [INFO]: 	index_key: HNSW15
2025-03-09 08:48:35,654 [INFO]: 	index_param: efSearch=273
2025-03-09 08:48:35,654 [INFO]: 	index_path: knn.index
2025-03-09 08:48:35,654 [INFO]: 	size in bytes: 499139050
2025-03-09 08:48:35,654 [INFO]: 	avg_search_speed_ms: 11.991455741740353
2025-03-09 08:48:35,654 [INFO]: 	99p_search_speed_ms: 24.217284880578475
2025-03-09 08:48:35,654 [INFO]: 	reconstruction error %: 0.0
2025-03-09 08:48:35,654 [INFO]: 	nb vectors: 2537
2025-03-09 08:48:35,654 [INFO]: 	vectors dimension: 49152
2025-03-09 08:48:35,654 [INFO]: 	compression ratio: 0.999309703378247
2025-03-09 08:48:35,654 [INFO]: }
2025-03-09 08:48:35,654 [INFO]: 	>>> Finished "Creating the index" in 49.5835 secs
2025-03-09 08:48:35,654 [INFO]: >>> Finished "Launching the whole pipeline" in 49.6177 secs
2025-03-09 08:48:36: [retrieval_preprocessing] calculating distances ...
2025-03-09 08:48:36: [retrieval_preprocessing] finished and saved retrieval indices for episode 35865 [episode count 8/20]
[retrieval_preprocessing] for episode 17442 [episode count 9/20], we have num_retrieval=np.int64(2518) num_query=np.int64(115)
2025-03-09 08:48:36,640 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-09 08:48:36,910 [INFO]: Launching the whole pipeline 03/09/2025, 08:48:36
2025-03-09 08:48:36,910 [INFO]: Reading total number of vectors and dimension 03/09/2025, 08:48:36
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1805.55it/s]
2025-03-09 08:48:36,935 [INFO]: There are 2518 embeddings of dim 49152
2025-03-09 08:48:36,936 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0253 secs
2025-03-09 08:48:36,936 [INFO]: 	Compute estimated construction time of the index 03/09/2025, 08:48:36
2025-03-09 08:48:36,936 [INFO]: 		-> Train: 16.7 minutes
2025-03-09 08:48:36,936 [INFO]: 		-> Add: 1.4 seconds
2025-03-09 08:48:36,936 [INFO]: 		Total: 16.7 minutes
2025-03-09 08:48:36,936 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0004 secs
2025-03-09 08:48:36,936 [INFO]: 	Checking that your have enough memory available to create the index 03/09/2025, 08:48:36
2025-03-09 08:48:36,937 [INFO]: 519.7MB of memory will be needed to build the index (more might be used if you have more)
2025-03-09 08:48:36,937 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0004 secs
2025-03-09 08:48:36,937 [INFO]: 	Selecting most promising index types given data characteristics 03/09/2025, 08:48:36
2025-03-09 08:48:36,937 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-09 08:48:36,937 [INFO]: 	Creating the index 03/09/2025, 08:48:36
2025-03-09 08:48:36,937 [INFO]: 		-> Instanciate the index HNSW15 03/09/2025, 08:48:36
2025-03-09 08:48:36,940 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0026 secs
2025-03-09 08:48:36,940 [INFO]: 		-> Adding the vectors to the index 03/09/2025, 08:48:36
2025-03-09 08:48:36,941 [INFO]: The memory available for adding the vectors is 49.5GB(total available - used by the index)
2025-03-09 08:48:36,941 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/10 [00:00<?, ?it/s] 30%|███       | 3/10 [00:00<00:00, 29.53it/s] 90%|█████████ | 9/10 [00:00<00:00, 43.79it/s]100%|██████████| 10/10 [00:01<00:00,  6.27it/s]
2025-03-09 08:48:38,539 [INFO]: 	Computing best hyperparameters for index knn.index 03/09/2025, 08:48:38
2025-03-09 08:49:05,684 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 27.1449 secs
2025-03-09 08:49:05,684 [INFO]: The best hyperparameters are: efSearch=211
2025-03-09 08:49:05,684 [INFO]: 	Compute fast metrics 03/09/2025, 08:49:05
  0%|          | 0/4 [00:00<?, ?it/s] 75%|███████▌  | 3/4 [00:00<00:00, 24.25it/s] 75%|███████▌  | 3/4 [00:00<00:00, 19.24it/s]
2025-03-09 08:49:18,736 [INFO]: 	>>> Finished "Compute fast metrics" in 13.0515 secs
2025-03-09 08:49:18,737 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 41.7970 secs
2025-03-09 08:49:18,737 [INFO]: {
2025-03-09 08:49:18,737 [INFO]: 	index_key: HNSW15
2025-03-09 08:49:18,738 [INFO]: 	index_param: efSearch=211
2025-03-09 08:49:18,738 [INFO]: 	index_path: knn.index
2025-03-09 08:49:18,738 [INFO]: 	size in bytes: 495400810
2025-03-09 08:49:18,738 [INFO]: 	avg_search_speed_ms: 9.659935762331898
2025-03-09 08:49:18,738 [INFO]: 	99p_search_speed_ms: 23.50825650617479
2025-03-09 08:49:18,738 [INFO]: 	reconstruction error %: 0.0
2025-03-09 08:49:18,738 [INFO]: 	nb vectors: 2518
2025-03-09 08:49:18,738 [INFO]: 	vectors dimension: 49152
2025-03-09 08:49:18,738 [INFO]: 	compression ratio: 0.9993099203854754
2025-03-09 08:49:18,738 [INFO]: }
2025-03-09 08:49:18,738 [INFO]: 	>>> Finished "Creating the index" in 41.8004 secs
2025-03-09 08:49:18,738 [INFO]: >>> Finished "Launching the whole pipeline" in 41.8273 secs
2025-03-09 08:49:19: [retrieval_preprocessing] calculating distances ...
2025-03-09 08:49:19: [retrieval_preprocessing] finished and saved retrieval indices for episode 17442 [episode count 9/20]
[retrieval_preprocessing] for episode 89637 [episode count 10/20], we have num_retrieval=np.int64(2503) num_query=np.int64(130)
2025-03-09 08:49:19,825 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-09 08:49:20,127 [INFO]: Launching the whole pipeline 03/09/2025, 08:49:20
2025-03-09 08:49:20,127 [INFO]: Reading total number of vectors and dimension 03/09/2025, 08:49:20
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1649.35it/s]
2025-03-09 08:49:20,150 [INFO]: There are 2503 embeddings of dim 49152
2025-03-09 08:49:20,151 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0242 secs
2025-03-09 08:49:20,151 [INFO]: 	Compute estimated construction time of the index 03/09/2025, 08:49:20
2025-03-09 08:49:20,151 [INFO]: 		-> Train: 16.7 minutes
2025-03-09 08:49:20,152 [INFO]: 		-> Add: 1.4 seconds
2025-03-09 08:49:20,152 [INFO]: 		Total: 16.7 minutes
2025-03-09 08:49:20,152 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0005 secs
2025-03-09 08:49:20,152 [INFO]: 	Checking that your have enough memory available to create the index 03/09/2025, 08:49:20
2025-03-09 08:49:20,152 [INFO]: 516.6MB of memory will be needed to build the index (more might be used if you have more)
2025-03-09 08:49:20,152 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0004 secs
2025-03-09 08:49:20,152 [INFO]: 	Selecting most promising index types given data characteristics 03/09/2025, 08:49:20
2025-03-09 08:49:20,153 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-09 08:49:20,153 [INFO]: 	Creating the index 03/09/2025, 08:49:20
2025-03-09 08:49:20,153 [INFO]: 		-> Instanciate the index HNSW15 03/09/2025, 08:49:20
2025-03-09 08:49:20,156 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0028 secs
2025-03-09 08:49:20,156 [INFO]: 		-> Adding the vectors to the index 03/09/2025, 08:49:20
2025-03-09 08:49:20,156 [INFO]: The memory available for adding the vectors is 49.5GB(total available - used by the index)
2025-03-09 08:49:20,156 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/10 [00:00<?, ?it/s] 30%|███       | 3/10 [00:00<00:00, 27.09it/s] 90%|█████████ | 9/10 [00:00<00:00, 43.38it/s]100%|██████████| 10/10 [00:01<00:00,  5.31it/s]
2025-03-09 08:49:22,046 [INFO]: 	Computing best hyperparameters for index knn.index 03/09/2025, 08:49:22
2025-03-09 08:49:48,123 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 26.0762 secs
2025-03-09 08:49:48,123 [INFO]: The best hyperparameters are: efSearch=203
2025-03-09 08:49:48,123 [INFO]: 	Compute fast metrics 03/09/2025, 08:49:48
  0%|          | 0/4 [00:00<?, ?it/s] 25%|██▌       | 1/4 [00:00<00:00,  8.54it/s] 75%|███████▌  | 3/4 [00:00<00:00, 14.96it/s]
2025-03-09 08:50:06,343 [INFO]: 	>>> Finished "Compute fast metrics" in 18.2197 secs
2025-03-09 08:50:06,345 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 46.1884 secs
2025-03-09 08:50:06,345 [INFO]: {
2025-03-09 08:50:06,345 [INFO]: 	index_key: HNSW15
2025-03-09 08:50:06,345 [INFO]: 	index_param: efSearch=203
2025-03-09 08:50:06,345 [INFO]: 	index_path: knn.index
2025-03-09 08:50:06,345 [INFO]: 	size in bytes: 492449590
2025-03-09 08:50:06,345 [INFO]: 	avg_search_speed_ms: 8.304902202909211
2025-03-09 08:50:06,345 [INFO]: 	99p_search_speed_ms: 16.179142955224975
2025-03-09 08:50:06,345 [INFO]: 	reconstruction error %: 0.0
2025-03-09 08:50:06,345 [INFO]: 	nb vectors: 2503
2025-03-09 08:50:06,345 [INFO]: 	vectors dimension: 49152
2025-03-09 08:50:06,345 [INFO]: 	compression ratio: 0.9993100491768102
2025-03-09 08:50:06,345 [INFO]: }
2025-03-09 08:50:06,345 [INFO]: 	>>> Finished "Creating the index" in 46.1921 secs
2025-03-09 08:50:06,345 [INFO]: >>> Finished "Launching the whole pipeline" in 46.2182 secs
2025-03-09 08:50:06: [retrieval_preprocessing] calculating distances ...
2025-03-09 08:50:07: [retrieval_preprocessing] finished and saved retrieval indices for episode 89637 [episode count 10/20]
[retrieval_preprocessing] for episode 92197 [episode count 11/20], we have num_retrieval=np.int64(2483) num_query=np.int64(150)
2025-03-09 08:50:07,462 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-09 08:50:08,525 [INFO]: Launching the whole pipeline 03/09/2025, 08:50:08
2025-03-09 08:50:08,525 [INFO]: Reading total number of vectors and dimension 03/09/2025, 08:50:08
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1190.55it/s]
2025-03-09 08:50:08,551 [INFO]: There are 2483 embeddings of dim 49152
2025-03-09 08:50:08,552 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0268 secs
2025-03-09 08:50:08,552 [INFO]: 	Compute estimated construction time of the index 03/09/2025, 08:50:08
2025-03-09 08:50:08,552 [INFO]: 		-> Train: 16.7 minutes
2025-03-09 08:50:08,552 [INFO]: 		-> Add: 1.4 seconds
2025-03-09 08:50:08,552 [INFO]: 		Total: 16.7 minutes
2025-03-09 08:50:08,552 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0001 secs
2025-03-09 08:50:08,552 [INFO]: 	Checking that your have enough memory available to create the index 03/09/2025, 08:50:08
2025-03-09 08:50:08,552 [INFO]: 512.4MB of memory will be needed to build the index (more might be used if you have more)
2025-03-09 08:50:08,552 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0002 secs
2025-03-09 08:50:08,552 [INFO]: 	Selecting most promising index types given data characteristics 03/09/2025, 08:50:08
2025-03-09 08:50:08,552 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-09 08:50:08,552 [INFO]: 	Creating the index 03/09/2025, 08:50:08
2025-03-09 08:50:08,552 [INFO]: 		-> Instanciate the index HNSW15 03/09/2025, 08:50:08
2025-03-09 08:50:08,553 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0010 secs
2025-03-09 08:50:08,553 [INFO]: 		-> Adding the vectors to the index 03/09/2025, 08:50:08
2025-03-09 08:50:08,553 [INFO]: The memory available for adding the vectors is 49.5GB(total available - used by the index)
2025-03-09 08:50:08,553 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/10 [00:00<?, ?it/s] 10%|█         | 1/10 [00:00<00:00,  9.92it/s] 70%|███████   | 7/10 [00:00<00:00, 36.75it/s]100%|██████████| 10/10 [00:01<00:00,  5.30it/s]
2025-03-09 08:50:10,445 [INFO]: 	Computing best hyperparameters for index knn.index 03/09/2025, 08:50:10
2025-03-09 08:50:40,320 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 29.8739 secs
2025-03-09 08:50:40,320 [INFO]: The best hyperparameters are: efSearch=291
2025-03-09 08:50:40,320 [INFO]: 	Compute fast metrics 03/09/2025, 08:50:40
  0%|          | 0/4 [00:00<?, ?it/s] 50%|█████     | 2/4 [00:00<00:00, 19.02it/s] 75%|███████▌  | 3/4 [00:00<00:00, 21.03it/s]
2025-03-09 08:50:55,853 [INFO]: 	>>> Finished "Compute fast metrics" in 15.5322 secs
2025-03-09 08:50:55,854 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 47.3007 secs
2025-03-09 08:50:55,854 [INFO]: {
2025-03-09 08:50:55,854 [INFO]: 	index_key: HNSW15
2025-03-09 08:50:55,854 [INFO]: 	index_param: efSearch=291
2025-03-09 08:50:55,854 [INFO]: 	index_path: knn.index
2025-03-09 08:50:55,854 [INFO]: 	size in bytes: 488514670
2025-03-09 08:50:55,854 [INFO]: 	avg_search_speed_ms: 11.14094079698214
2025-03-09 08:50:55,854 [INFO]: 	99p_search_speed_ms: 17.490738066844642
2025-03-09 08:50:55,854 [INFO]: 	reconstruction error %: 0.0
2025-03-09 08:50:55,854 [INFO]: 	nb vectors: 2483
2025-03-09 08:50:55,854 [INFO]: 	vectors dimension: 49152
2025-03-09 08:50:55,854 [INFO]: 	compression ratio: 0.9993101414948297
2025-03-09 08:50:55,854 [INFO]: }
2025-03-09 08:50:55,854 [INFO]: 	>>> Finished "Creating the index" in 47.3021 secs
2025-03-09 08:50:55,854 [INFO]: >>> Finished "Launching the whole pipeline" in 47.3295 secs
2025-03-09 08:50:56: [retrieval_preprocessing] calculating distances ...
2025-03-09 08:50:57: [retrieval_preprocessing] finished and saved retrieval indices for episode 92197 [episode count 11/20]
[retrieval_preprocessing] for episode 54311 [episode count 12/20], we have num_retrieval=np.int64(2491) num_query=np.int64(142)
2025-03-09 08:50:57,432 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-09 08:50:57,792 [INFO]: Launching the whole pipeline 03/09/2025, 08:50:57
2025-03-09 08:50:57,792 [INFO]: Reading total number of vectors and dimension 03/09/2025, 08:50:57
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1211.18it/s]
2025-03-09 08:50:57,818 [INFO]: There are 2491 embeddings of dim 49152
2025-03-09 08:50:57,818 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0259 secs
2025-03-09 08:50:57,818 [INFO]: 	Compute estimated construction time of the index 03/09/2025, 08:50:57
2025-03-09 08:50:57,818 [INFO]: 		-> Train: 16.7 minutes
2025-03-09 08:50:57,818 [INFO]: 		-> Add: 1.4 seconds
2025-03-09 08:50:57,818 [INFO]: 		Total: 16.7 minutes
2025-03-09 08:50:57,818 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0001 secs
2025-03-09 08:50:57,818 [INFO]: 	Checking that your have enough memory available to create the index 03/09/2025, 08:50:57
2025-03-09 08:50:57,818 [INFO]: 514.1MB of memory will be needed to build the index (more might be used if you have more)
2025-03-09 08:50:57,818 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0002 secs
2025-03-09 08:50:57,818 [INFO]: 	Selecting most promising index types given data characteristics 03/09/2025, 08:50:57
2025-03-09 08:50:57,818 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-09 08:50:57,818 [INFO]: 	Creating the index 03/09/2025, 08:50:57
2025-03-09 08:50:57,818 [INFO]: 		-> Instanciate the index HNSW15 03/09/2025, 08:50:57
2025-03-09 08:50:57,820 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0010 secs
2025-03-09 08:50:57,820 [INFO]: 		-> Adding the vectors to the index 03/09/2025, 08:50:57
2025-03-09 08:50:57,820 [INFO]: The memory available for adding the vectors is 49.5GB(total available - used by the index)
2025-03-09 08:50:57,820 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/10 [00:00<?, ?it/s] 20%|██        | 2/10 [00:00<00:00, 19.08it/s] 70%|███████   | 7/10 [00:00<00:00, 35.93it/s]100%|██████████| 10/10 [00:01<00:00,  5.46it/s]
2025-03-09 08:50:59,656 [INFO]: 	Computing best hyperparameters for index knn.index 03/09/2025, 08:50:59
2025-03-09 08:51:24,869 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 25.2133 secs
2025-03-09 08:51:24,869 [INFO]: The best hyperparameters are: efSearch=261
2025-03-09 08:51:24,869 [INFO]: 	Compute fast metrics 03/09/2025, 08:51:24
  0%|          | 0/4 [00:00<?, ?it/s] 75%|███████▌  | 3/4 [00:00<00:00, 25.84it/s] 75%|███████▌  | 3/4 [00:00<00:00, 22.25it/s]
2025-03-09 08:51:42,486 [INFO]: 	>>> Finished "Compute fast metrics" in 17.6165 secs
2025-03-09 08:51:42,487 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 44.6677 secs
2025-03-09 08:51:42,488 [INFO]: {
2025-03-09 08:51:42,488 [INFO]: 	index_key: HNSW15
2025-03-09 08:51:42,488 [INFO]: 	index_param: efSearch=261
2025-03-09 08:51:42,488 [INFO]: 	index_path: knn.index
2025-03-09 08:51:42,488 [INFO]: 	size in bytes: 490088650
2025-03-09 08:51:42,488 [INFO]: 	avg_search_speed_ms: 10.307867503148916
2025-03-09 08:51:42,488 [INFO]: 	99p_search_speed_ms: 22.871379773132492
2025-03-09 08:51:42,488 [INFO]: 	reconstruction error %: 0.0
2025-03-09 08:51:42,488 [INFO]: 	nb vectors: 2491
2025-03-09 08:51:42,488 [INFO]: 	vectors dimension: 49152
2025-03-09 08:51:42,488 [INFO]: 	compression ratio: 0.9993100799212551
2025-03-09 08:51:42,488 [INFO]: }
2025-03-09 08:51:42,488 [INFO]: 	>>> Finished "Creating the index" in 44.6693 secs
2025-03-09 08:51:42,488 [INFO]: >>> Finished "Launching the whole pipeline" in 44.6958 secs
2025-03-09 08:51:43: [retrieval_preprocessing] calculating distances ...
2025-03-09 08:51:43: [retrieval_preprocessing] finished and saved retrieval indices for episode 54311 [episode count 12/20]
[retrieval_preprocessing] for episode 40489 [episode count 13/20], we have num_retrieval=np.int64(2538) num_query=np.int64(95)
2025-03-09 08:51:44,011 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-09 08:51:44,343 [INFO]: Launching the whole pipeline 03/09/2025, 08:51:44
2025-03-09 08:51:44,343 [INFO]: Reading total number of vectors and dimension 03/09/2025, 08:51:44
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1374.28it/s]
2025-03-09 08:51:44,371 [INFO]: There are 2538 embeddings of dim 49152
2025-03-09 08:51:44,371 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0279 secs
2025-03-09 08:51:44,371 [INFO]: 	Compute estimated construction time of the index 03/09/2025, 08:51:44
2025-03-09 08:51:44,372 [INFO]: 		-> Train: 16.7 minutes
2025-03-09 08:51:44,372 [INFO]: 		-> Add: 1.4 seconds
2025-03-09 08:51:44,372 [INFO]: 		Total: 16.7 minutes
2025-03-09 08:51:44,372 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0003 secs
2025-03-09 08:51:44,372 [INFO]: 	Checking that your have enough memory available to create the index 03/09/2025, 08:51:44
2025-03-09 08:51:44,372 [INFO]: 523.8MB of memory will be needed to build the index (more might be used if you have more)
2025-03-09 08:51:44,372 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0004 secs
2025-03-09 08:51:44,373 [INFO]: 	Selecting most promising index types given data characteristics 03/09/2025, 08:51:44
2025-03-09 08:51:44,373 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-09 08:51:44,373 [INFO]: 	Creating the index 03/09/2025, 08:51:44
2025-03-09 08:51:44,373 [INFO]: 		-> Instanciate the index HNSW15 03/09/2025, 08:51:44
2025-03-09 08:51:44,376 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0029 secs
2025-03-09 08:51:44,376 [INFO]: 		-> Adding the vectors to the index 03/09/2025, 08:51:44
2025-03-09 08:51:44,377 [INFO]: The memory available for adding the vectors is 49.5GB(total available - used by the index)
2025-03-09 08:51:44,377 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/10 [00:00<?, ?it/s] 20%|██        | 2/10 [00:00<00:00, 19.47it/s] 70%|███████   | 7/10 [00:00<00:00, 35.02it/s]100%|██████████| 10/10 [00:02<00:00,  4.66it/s]
2025-03-09 08:51:46,528 [INFO]: 	Computing best hyperparameters for index knn.index 03/09/2025, 08:51:46
2025-03-09 08:52:13,538 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 27.0106 secs
2025-03-09 08:52:13,539 [INFO]: The best hyperparameters are: efSearch=263
2025-03-09 08:52:13,539 [INFO]: 	Compute fast metrics 03/09/2025, 08:52:13
  0%|          | 0/4 [00:00<?, ?it/s] 75%|███████▌  | 3/4 [00:00<00:00, 27.87it/s] 75%|███████▌  | 3/4 [00:00<00:00, 24.43it/s]
2025-03-09 08:52:29,373 [INFO]: 	>>> Finished "Compute fast metrics" in 15.8345 secs
2025-03-09 08:52:29,375 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 44.9987 secs
2025-03-09 08:52:29,375 [INFO]: {
2025-03-09 08:52:29,375 [INFO]: 	index_key: HNSW15
2025-03-09 08:52:29,375 [INFO]: 	index_param: efSearch=263
2025-03-09 08:52:29,375 [INFO]: 	index_path: knn.index
2025-03-09 08:52:29,375 [INFO]: 	size in bytes: 499335790
2025-03-09 08:52:29,375 [INFO]: 	avg_search_speed_ms: 9.674387712191928
2025-03-09 08:52:29,375 [INFO]: 	99p_search_speed_ms: 18.43651471659541
2025-03-09 08:52:29,375 [INFO]: 	reconstruction error %: 0.0
2025-03-09 08:52:29,375 [INFO]: 	nb vectors: 2538
2025-03-09 08:52:29,375 [INFO]: 	vectors dimension: 49152
2025-03-09 08:52:29,375 [INFO]: 	compression ratio: 0.999309711006295
2025-03-09 08:52:29,375 [INFO]: }
2025-03-09 08:52:29,375 [INFO]: 	>>> Finished "Creating the index" in 45.0025 secs
2025-03-09 08:52:29,375 [INFO]: >>> Finished "Launching the whole pipeline" in 45.0323 secs
2025-03-09 08:52:30: [retrieval_preprocessing] calculating distances ...
2025-03-09 08:52:30: [retrieval_preprocessing] finished and saved retrieval indices for episode 40489 [episode count 13/20]
[retrieval_preprocessing] for episode 88623 [episode count 14/20], we have num_retrieval=np.int64(2399) num_query=np.int64(234)
2025-03-09 08:52:31,025 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-09 08:52:31,339 [INFO]: Launching the whole pipeline 03/09/2025, 08:52:31
2025-03-09 08:52:31,339 [INFO]: Reading total number of vectors and dimension 03/09/2025, 08:52:31
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 904.33it/s]
2025-03-09 08:52:31,368 [INFO]: There are 2399 embeddings of dim 49152
2025-03-09 08:52:31,368 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0290 secs
2025-03-09 08:52:31,368 [INFO]: 	Compute estimated construction time of the index 03/09/2025, 08:52:31
2025-03-09 08:52:31,369 [INFO]: 		-> Train: 16.7 minutes
2025-03-09 08:52:31,369 [INFO]: 		-> Add: 1.3 seconds
2025-03-09 08:52:31,369 [INFO]: 		Total: 16.7 minutes
2025-03-09 08:52:31,369 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0001 secs
2025-03-09 08:52:31,369 [INFO]: 	Checking that your have enough memory available to create the index 03/09/2025, 08:52:31
2025-03-09 08:52:31,369 [INFO]: 495.1MB of memory will be needed to build the index (more might be used if you have more)
2025-03-09 08:52:31,369 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0002 secs
2025-03-09 08:52:31,369 [INFO]: 	Selecting most promising index types given data characteristics 03/09/2025, 08:52:31
2025-03-09 08:52:31,369 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-09 08:52:31,369 [INFO]: 	Creating the index 03/09/2025, 08:52:31
2025-03-09 08:52:31,369 [INFO]: 		-> Instanciate the index HNSW15 03/09/2025, 08:52:31
2025-03-09 08:52:31,370 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0011 secs
2025-03-09 08:52:31,370 [INFO]: 		-> Adding the vectors to the index 03/09/2025, 08:52:31
2025-03-09 08:52:31,370 [INFO]: The memory available for adding the vectors is 49.6GB(total available - used by the index)
2025-03-09 08:52:31,370 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/10 [00:00<?, ?it/s] 10%|█         | 1/10 [00:00<00:00,  9.38it/s] 60%|██████    | 6/10 [00:00<00:00, 32.31it/s]100%|██████████| 10/10 [00:01<00:00,  4.86it/s]100%|██████████| 10/10 [00:01<00:00,  5.78it/s]
2025-03-09 08:52:33,104 [INFO]: 	Computing best hyperparameters for index knn.index 03/09/2025, 08:52:33
2025-03-09 08:52:57,893 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 24.7887 secs
2025-03-09 08:52:57,893 [INFO]: The best hyperparameters are: efSearch=204
2025-03-09 08:52:57,893 [INFO]: 	Compute fast metrics 03/09/2025, 08:52:57
  0%|          | 0/4 [00:00<?, ?it/s] 25%|██▌       | 1/4 [00:00<00:00,  9.39it/s] 75%|███████▌  | 3/4 [00:00<00:00, 15.61it/s]
2025-03-09 08:53:14,899 [INFO]: 	>>> Finished "Compute fast metrics" in 17.0062 secs
2025-03-09 08:53:14,901 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 43.5308 secs
2025-03-09 08:53:14,901 [INFO]: {
2025-03-09 08:53:14,901 [INFO]: 	index_key: HNSW15
2025-03-09 08:53:14,901 [INFO]: 	index_param: efSearch=204
2025-03-09 08:53:14,901 [INFO]: 	index_path: knn.index
2025-03-09 08:53:14,901 [INFO]: 	size in bytes: 471988390
2025-03-09 08:53:14,901 [INFO]: 	avg_search_speed_ms: 9.075624060338725
2025-03-09 08:53:14,901 [INFO]: 	99p_search_speed_ms: 22.27794835111127
2025-03-09 08:53:14,901 [INFO]: 	reconstruction error %: 0.0
2025-03-09 08:53:14,901 [INFO]: 	nb vectors: 2399
2025-03-09 08:53:14,901 [INFO]: 	vectors dimension: 49152
2025-03-09 08:53:14,901 [INFO]: 	compression ratio: 0.9993097330211872
2025-03-09 08:53:14,901 [INFO]: }
2025-03-09 08:53:14,901 [INFO]: 	>>> Finished "Creating the index" in 43.5324 secs
2025-03-09 08:53:14,901 [INFO]: >>> Finished "Launching the whole pipeline" in 43.5621 secs
2025-03-09 08:53:15: [retrieval_preprocessing] calculating distances ...
2025-03-09 08:53:16: [retrieval_preprocessing] finished and saved retrieval indices for episode 88623 [episode count 14/20]
[retrieval_preprocessing] for episode 75314 [episode count 15/20], we have num_retrieval=np.int64(2492) num_query=np.int64(141)
2025-03-09 08:53:16,788 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-09 08:53:17,122 [INFO]: Launching the whole pipeline 03/09/2025, 08:53:17
2025-03-09 08:53:17,122 [INFO]: Reading total number of vectors and dimension 03/09/2025, 08:53:17
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1203.88it/s]
2025-03-09 08:53:17,147 [INFO]: There are 2492 embeddings of dim 49152
2025-03-09 08:53:17,147 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0250 secs
2025-03-09 08:53:17,147 [INFO]: 	Compute estimated construction time of the index 03/09/2025, 08:53:17
2025-03-09 08:53:17,147 [INFO]: 		-> Train: 16.7 minutes
2025-03-09 08:53:17,148 [INFO]: 		-> Add: 1.4 seconds
2025-03-09 08:53:17,148 [INFO]: 		Total: 16.7 minutes
2025-03-09 08:53:17,148 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0001 secs
2025-03-09 08:53:17,148 [INFO]: 	Checking that your have enough memory available to create the index 03/09/2025, 08:53:17
2025-03-09 08:53:17,148 [INFO]: 514.3MB of memory will be needed to build the index (more might be used if you have more)
2025-03-09 08:53:17,148 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0001 secs
2025-03-09 08:53:17,148 [INFO]: 	Selecting most promising index types given data characteristics 03/09/2025, 08:53:17
2025-03-09 08:53:17,148 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-09 08:53:17,148 [INFO]: 	Creating the index 03/09/2025, 08:53:17
2025-03-09 08:53:17,148 [INFO]: 		-> Instanciate the index HNSW15 03/09/2025, 08:53:17
2025-03-09 08:53:17,149 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0012 secs
2025-03-09 08:53:17,149 [INFO]: 		-> Adding the vectors to the index 03/09/2025, 08:53:17
2025-03-09 08:53:17,149 [INFO]: The memory available for adding the vectors is 49.5GB(total available - used by the index)
2025-03-09 08:53:17,149 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/10 [00:00<?, ?it/s] 10%|█         | 1/10 [00:00<00:00,  9.31it/s] 70%|███████   | 7/10 [00:00<00:00, 35.98it/s]100%|██████████| 10/10 [00:01<00:00,  5.63it/s]
2025-03-09 08:53:18,928 [INFO]: 	Computing best hyperparameters for index knn.index 03/09/2025, 08:53:18
2025-03-09 08:53:44,002 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 25.0731 secs
2025-03-09 08:53:44,002 [INFO]: The best hyperparameters are: efSearch=263
2025-03-09 08:53:44,002 [INFO]: 	Compute fast metrics 03/09/2025, 08:53:44
  0%|          | 0/4 [00:00<?, ?it/s] 25%|██▌       | 1/4 [00:00<00:01,  2.47it/s] 75%|███████▌  | 3/4 [00:00<00:00,  6.49it/s]
2025-03-09 08:53:56,625 [INFO]: 	>>> Finished "Compute fast metrics" in 12.6229 secs
2025-03-09 08:53:56,627 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 39.4773 secs
2025-03-09 08:53:56,627 [INFO]: {
2025-03-09 08:53:56,627 [INFO]: 	index_key: HNSW15
2025-03-09 08:53:56,627 [INFO]: 	index_param: efSearch=263
2025-03-09 08:53:56,627 [INFO]: 	index_path: knn.index
2025-03-09 08:53:56,627 [INFO]: 	size in bytes: 490285390
2025-03-09 08:53:56,627 [INFO]: 	avg_search_speed_ms: 10.418986835672209
2025-03-09 08:53:56,627 [INFO]: 	99p_search_speed_ms: 19.860580000095066
2025-03-09 08:53:56,627 [INFO]: 	reconstruction error %: 0.0
2025-03-09 08:53:56,627 [INFO]: 	nb vectors: 2492
2025-03-09 08:53:56,627 [INFO]: 	vectors dimension: 49152
2025-03-09 08:53:56,627 [INFO]: 	compression ratio: 0.9993100875390147
2025-03-09 08:53:56,627 [INFO]: }
2025-03-09 08:53:56,627 [INFO]: 	>>> Finished "Creating the index" in 39.4789 secs
2025-03-09 08:53:56,627 [INFO]: >>> Finished "Launching the whole pipeline" in 39.5046 secs
2025-03-09 08:53:57: [retrieval_preprocessing] calculating distances ...
2025-03-09 08:53:57: [retrieval_preprocessing] finished and saved retrieval indices for episode 75314 [episode count 15/20]
[retrieval_preprocessing] for episode 55353 [episode count 16/20], we have num_retrieval=np.int64(2530) num_query=np.int64(103)
2025-03-09 08:53:58,106 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-09 08:53:58,380 [INFO]: Launching the whole pipeline 03/09/2025, 08:53:58
2025-03-09 08:53:58,380 [INFO]: Reading total number of vectors and dimension 03/09/2025, 08:53:58
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 2262.30it/s]
2025-03-09 08:53:58,403 [INFO]: There are 2530 embeddings of dim 49152
2025-03-09 08:53:58,403 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0234 secs
2025-03-09 08:53:58,404 [INFO]: 	Compute estimated construction time of the index 03/09/2025, 08:53:58
2025-03-09 08:53:58,404 [INFO]: 		-> Train: 16.7 minutes
2025-03-09 08:53:58,404 [INFO]: 		-> Add: 1.4 seconds
2025-03-09 08:53:58,404 [INFO]: 		Total: 16.7 minutes
2025-03-09 08:53:58,404 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0001 secs
2025-03-09 08:53:58,404 [INFO]: 	Checking that your have enough memory available to create the index 03/09/2025, 08:53:58
2025-03-09 08:53:58,404 [INFO]: 522.1MB of memory will be needed to build the index (more might be used if you have more)
2025-03-09 08:53:58,404 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0001 secs
2025-03-09 08:53:58,404 [INFO]: 	Selecting most promising index types given data characteristics 03/09/2025, 08:53:58
2025-03-09 08:53:58,404 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-09 08:53:58,404 [INFO]: 	Creating the index 03/09/2025, 08:53:58
2025-03-09 08:53:58,404 [INFO]: 		-> Instanciate the index HNSW15 03/09/2025, 08:53:58
2025-03-09 08:53:58,405 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0009 secs
2025-03-09 08:53:58,405 [INFO]: 		-> Adding the vectors to the index 03/09/2025, 08:53:58
2025-03-09 08:53:58,405 [INFO]: The memory available for adding the vectors is 49.5GB(total available - used by the index)
2025-03-09 08:53:58,405 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/10 [00:00<?, ?it/s] 20%|██        | 2/10 [00:00<00:00, 19.24it/s] 90%|█████████ | 9/10 [00:00<00:00, 45.66it/s]100%|██████████| 10/10 [00:01<00:00,  6.30it/s]
2025-03-09 08:53:59,996 [INFO]: 	Computing best hyperparameters for index knn.index 03/09/2025, 08:53:59
2025-03-09 08:54:26,202 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 26.2057 secs
2025-03-09 08:54:26,202 [INFO]: The best hyperparameters are: efSearch=247
2025-03-09 08:54:26,202 [INFO]: 	Compute fast metrics 03/09/2025, 08:54:26
  0%|          | 0/4 [00:00<?, ?it/s] 75%|███████▌  | 3/4 [00:00<00:00, 26.21it/s] 75%|███████▌  | 3/4 [00:00<00:00, 22.79it/s]
2025-03-09 08:54:43,104 [INFO]: 	>>> Finished "Compute fast metrics" in 16.9021 secs
2025-03-09 08:54:43,106 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 44.7009 secs
2025-03-09 08:54:43,106 [INFO]: {
2025-03-09 08:54:43,106 [INFO]: 	index_key: HNSW15
2025-03-09 08:54:43,106 [INFO]: 	index_param: efSearch=247
2025-03-09 08:54:43,106 [INFO]: 	index_path: knn.index
2025-03-09 08:54:43,106 [INFO]: 	size in bytes: 497761870
2025-03-09 08:54:43,106 [INFO]: 	avg_search_speed_ms: 9.314424930846238
2025-03-09 08:54:43,106 [INFO]: 	99p_search_speed_ms: 19.566121608950187
2025-03-09 08:54:43,106 [INFO]: 	reconstruction error %: 0.0
2025-03-09 08:54:43,106 [INFO]: 	nb vectors: 2530
2025-03-09 08:54:43,106 [INFO]: 	vectors dimension: 49152
2025-03-09 08:54:43,106 [INFO]: 	compression ratio: 0.9993096498130722
2025-03-09 08:54:43,106 [INFO]: }
2025-03-09 08:54:43,106 [INFO]: 	>>> Finished "Creating the index" in 44.7022 secs
2025-03-09 08:54:43,106 [INFO]: >>> Finished "Launching the whole pipeline" in 44.7262 secs
2025-03-09 08:54:43: [retrieval_preprocessing] calculating distances ...
2025-03-09 08:54:44: [retrieval_preprocessing] finished and saved retrieval indices for episode 55353 [episode count 16/20]
[retrieval_preprocessing] for episode 44604 [episode count 17/20], we have num_retrieval=np.int64(2505) num_query=np.int64(128)
2025-03-09 08:54:44,213 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-09 08:54:44,502 [INFO]: Launching the whole pipeline 03/09/2025, 08:54:44
2025-03-09 08:54:44,502 [INFO]: Reading total number of vectors and dimension 03/09/2025, 08:54:44
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1296.14it/s]
2025-03-09 08:54:44,529 [INFO]: There are 2505 embeddings of dim 49152
2025-03-09 08:54:44,529 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0270 secs
2025-03-09 08:54:44,529 [INFO]: 	Compute estimated construction time of the index 03/09/2025, 08:54:44
2025-03-09 08:54:44,529 [INFO]: 		-> Train: 16.7 minutes
2025-03-09 08:54:44,530 [INFO]: 		-> Add: 1.4 seconds
2025-03-09 08:54:44,530 [INFO]: 		Total: 16.7 minutes
2025-03-09 08:54:44,530 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0001 secs
2025-03-09 08:54:44,530 [INFO]: 	Checking that your have enough memory available to create the index 03/09/2025, 08:54:44
2025-03-09 08:54:44,530 [INFO]: 517.0MB of memory will be needed to build the index (more might be used if you have more)
2025-03-09 08:54:44,530 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0002 secs
2025-03-09 08:54:44,530 [INFO]: 	Selecting most promising index types given data characteristics 03/09/2025, 08:54:44
2025-03-09 08:54:44,530 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-09 08:54:44,530 [INFO]: 	Creating the index 03/09/2025, 08:54:44
2025-03-09 08:54:44,530 [INFO]: 		-> Instanciate the index HNSW15 03/09/2025, 08:54:44
2025-03-09 08:54:44,531 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0010 secs
2025-03-09 08:54:44,531 [INFO]: 		-> Adding the vectors to the index 03/09/2025, 08:54:44
2025-03-09 08:54:44,531 [INFO]: The memory available for adding the vectors is 49.5GB(total available - used by the index)
2025-03-09 08:54:44,531 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/10 [00:00<?, ?it/s] 10%|█         | 1/10 [00:00<00:01,  8.04it/s] 40%|████      | 4/10 [00:00<00:00, 19.00it/s] 90%|█████████ | 9/10 [00:00<00:00, 29.97it/s]100%|██████████| 10/10 [00:02<00:00,  4.50it/s]
2025-03-09 08:54:46,757 [INFO]: 	Computing best hyperparameters for index knn.index 03/09/2025, 08:54:46
2025-03-09 08:55:13,822 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 27.0642 secs
2025-03-09 08:55:13,822 [INFO]: The best hyperparameters are: efSearch=217
2025-03-09 08:55:13,822 [INFO]: 	Compute fast metrics 03/09/2025, 08:55:13
  0%|          | 0/4 [00:00<?, ?it/s] 50%|█████     | 2/4 [00:00<00:00, 18.61it/s] 75%|███████▌  | 3/4 [00:00<00:00, 19.89it/s]
2025-03-09 08:55:31,453 [INFO]: 	>>> Finished "Compute fast metrics" in 17.6304 secs
2025-03-09 08:55:31,454 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 46.9231 secs
2025-03-09 08:55:31,454 [INFO]: {
2025-03-09 08:55:31,455 [INFO]: 	index_key: HNSW15
2025-03-09 08:55:31,455 [INFO]: 	index_param: efSearch=217
2025-03-09 08:55:31,455 [INFO]: 	index_path: knn.index
2025-03-09 08:55:31,455 [INFO]: 	size in bytes: 492843070
2025-03-09 08:55:31,455 [INFO]: 	avg_search_speed_ms: 8.472676091369683
2025-03-09 08:55:31,455 [INFO]: 	99p_search_speed_ms: 17.18763415934518
2025-03-09 08:55:31,455 [INFO]: 	reconstruction error %: 0.0
2025-03-09 08:55:31,455 [INFO]: 	nb vectors: 2505
2025-03-09 08:55:31,455 [INFO]: 	vectors dimension: 49152
2025-03-09 08:55:31,455 [INFO]: 	compression ratio: 0.9993100643578087
2025-03-09 08:55:31,455 [INFO]: }
2025-03-09 08:55:31,455 [INFO]: 	>>> Finished "Creating the index" in 46.9247 secs
2025-03-09 08:55:31,455 [INFO]: >>> Finished "Launching the whole pipeline" in 46.9524 secs
2025-03-09 08:55:31: [retrieval_preprocessing] calculating distances ...
2025-03-09 08:55:32: [retrieval_preprocessing] finished and saved retrieval indices for episode 44604 [episode count 17/20]
[retrieval_preprocessing] for episode 63036 [episode count 18/20], we have num_retrieval=np.int64(2542) num_query=np.int64(91)
2025-03-09 08:55:32,577 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-09 08:55:33,519 [INFO]: Launching the whole pipeline 03/09/2025, 08:55:33
2025-03-09 08:55:33,519 [INFO]: Reading total number of vectors and dimension 03/09/2025, 08:55:33
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1826.79it/s]
2025-03-09 08:55:33,543 [INFO]: There are 2542 embeddings of dim 49152
2025-03-09 08:55:33,543 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0247 secs
2025-03-09 08:55:33,543 [INFO]: 	Compute estimated construction time of the index 03/09/2025, 08:55:33
2025-03-09 08:55:33,544 [INFO]: 		-> Train: 16.7 minutes
2025-03-09 08:55:33,544 [INFO]: 		-> Add: 1.4 seconds
2025-03-09 08:55:33,544 [INFO]: 		Total: 16.7 minutes
2025-03-09 08:55:33,544 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0001 secs
2025-03-09 08:55:33,544 [INFO]: 	Checking that your have enough memory available to create the index 03/09/2025, 08:55:33
2025-03-09 08:55:33,544 [INFO]: 524.6MB of memory will be needed to build the index (more might be used if you have more)
2025-03-09 08:55:33,544 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0001 secs
2025-03-09 08:55:33,544 [INFO]: 	Selecting most promising index types given data characteristics 03/09/2025, 08:55:33
2025-03-09 08:55:33,544 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-09 08:55:33,544 [INFO]: 	Creating the index 03/09/2025, 08:55:33
2025-03-09 08:55:33,544 [INFO]: 		-> Instanciate the index HNSW15 03/09/2025, 08:55:33
2025-03-09 08:55:33,545 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0011 secs
2025-03-09 08:55:33,545 [INFO]: 		-> Adding the vectors to the index 03/09/2025, 08:55:33
2025-03-09 08:55:33,545 [INFO]: The memory available for adding the vectors is 49.5GB(total available - used by the index)
2025-03-09 08:55:33,545 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/11 [00:00<?, ?it/s] 18%|█▊        | 2/11 [00:00<00:00, 17.70it/s] 73%|███████▎  | 8/11 [00:00<00:00, 38.94it/s]100%|██████████| 11/11 [00:02<00:00,  5.28it/s]
2025-03-09 08:55:35,631 [INFO]: 	Computing best hyperparameters for index knn.index 03/09/2025, 08:55:35
2025-03-09 08:56:02,058 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 26.4267 secs
2025-03-09 08:56:02,058 [INFO]: The best hyperparameters are: efSearch=263
2025-03-09 08:56:02,058 [INFO]: 	Compute fast metrics 03/09/2025, 08:56:02
  0%|          | 0/4 [00:00<?, ?it/s] 50%|█████     | 2/4 [00:00<00:00, 19.09it/s] 75%|███████▌  | 3/4 [00:00<00:00, 21.16it/s]
2025-03-09 08:56:15,380 [INFO]: 	>>> Finished "Compute fast metrics" in 13.3220 secs
2025-03-09 08:56:15,382 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 41.8364 secs
2025-03-09 08:56:15,382 [INFO]: {
2025-03-09 08:56:15,382 [INFO]: 	index_key: HNSW15
2025-03-09 08:56:15,382 [INFO]: 	index_param: efSearch=263
2025-03-09 08:56:15,382 [INFO]: 	index_path: knn.index
2025-03-09 08:56:15,382 [INFO]: 	size in bytes: 500122750
2025-03-09 08:56:15,382 [INFO]: 	avg_search_speed_ms: 11.278876860750989
2025-03-09 08:56:15,382 [INFO]: 	99p_search_speed_ms: 22.571430350653802
2025-03-09 08:56:15,382 [INFO]: 	reconstruction error %: 0.0
2025-03-09 08:56:15,382 [INFO]: 	nb vectors: 2542
2025-03-09 08:56:15,382 [INFO]: 	vectors dimension: 49152
2025-03-09 08:56:15,382 [INFO]: 	compression ratio: 0.999309741458472
2025-03-09 08:56:15,382 [INFO]: }
2025-03-09 08:56:15,382 [INFO]: 	>>> Finished "Creating the index" in 41.8379 secs
2025-03-09 08:56:15,382 [INFO]: >>> Finished "Launching the whole pipeline" in 41.8633 secs
2025-03-09 08:56:15: [retrieval_preprocessing] calculating distances ...
2025-03-09 08:56:16: [retrieval_preprocessing] finished and saved retrieval indices for episode 63036 [episode count 18/20]
[retrieval_preprocessing] for episode 73278 [episode count 19/20], we have num_retrieval=np.int64(2486) num_query=np.int64(147)
2025-03-09 08:56:16,501 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-09 08:56:16,849 [INFO]: Launching the whole pipeline 03/09/2025, 08:56:16
2025-03-09 08:56:16,850 [INFO]: Reading total number of vectors and dimension 03/09/2025, 08:56:16
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 2120.48it/s]
2025-03-09 08:56:16,874 [INFO]: There are 2486 embeddings of dim 49152
2025-03-09 08:56:16,875 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0252 secs
2025-03-09 08:56:16,875 [INFO]: 	Compute estimated construction time of the index 03/09/2025, 08:56:16
2025-03-09 08:56:16,876 [INFO]: 		-> Train: 16.7 minutes
2025-03-09 08:56:16,876 [INFO]: 		-> Add: 1.4 seconds
2025-03-09 08:56:16,876 [INFO]: 		Total: 16.7 minutes
2025-03-09 08:56:16,876 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0004 secs
2025-03-09 08:56:16,876 [INFO]: 	Checking that your have enough memory available to create the index 03/09/2025, 08:56:16
2025-03-09 08:56:16,876 [INFO]: 513.1MB of memory will be needed to build the index (more might be used if you have more)
2025-03-09 08:56:16,877 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0005 secs
2025-03-09 08:56:16,877 [INFO]: 	Selecting most promising index types given data characteristics 03/09/2025, 08:56:16
2025-03-09 08:56:16,877 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-09 08:56:16,877 [INFO]: 	Creating the index 03/09/2025, 08:56:16
2025-03-09 08:56:16,877 [INFO]: 		-> Instanciate the index HNSW15 03/09/2025, 08:56:16
2025-03-09 08:56:16,880 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0027 secs
2025-03-09 08:56:16,880 [INFO]: 		-> Adding the vectors to the index 03/09/2025, 08:56:16
2025-03-09 08:56:16,880 [INFO]: The memory available for adding the vectors is 49.5GB(total available - used by the index)
2025-03-09 08:56:16,881 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/10 [00:00<?, ?it/s] 20%|██        | 2/10 [00:00<00:00, 19.14it/s] 70%|███████   | 7/10 [00:00<00:00, 35.78it/s]100%|██████████| 10/10 [00:02<00:00,  4.98it/s]
2025-03-09 08:56:18,895 [INFO]: 	Computing best hyperparameters for index knn.index 03/09/2025, 08:56:18
2025-03-09 08:56:45,093 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 26.1973 secs
2025-03-09 08:56:45,093 [INFO]: The best hyperparameters are: efSearch=245
2025-03-09 08:56:45,093 [INFO]: 	Compute fast metrics 03/09/2025, 08:56:45
  0%|          | 0/4 [00:00<?, ?it/s] 50%|█████     | 2/4 [00:00<00:00, 17.54it/s] 75%|███████▌  | 3/4 [00:00<00:00, 18.52it/s]
2025-03-09 08:57:01,099 [INFO]: 	>>> Finished "Compute fast metrics" in 16.0057 secs
2025-03-09 08:57:01,101 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 44.2203 secs
2025-03-09 08:57:01,101 [INFO]: {
2025-03-09 08:57:01,101 [INFO]: 	index_key: HNSW15
2025-03-09 08:57:01,101 [INFO]: 	index_param: efSearch=245
2025-03-09 08:57:01,101 [INFO]: 	index_path: knn.index
2025-03-09 08:57:01,101 [INFO]: 	size in bytes: 489104890
2025-03-09 08:57:01,101 [INFO]: 	avg_search_speed_ms: 10.650389810183004
2025-03-09 08:57:01,101 [INFO]: 	99p_search_speed_ms: 22.49370356090367
2025-03-09 08:57:01,101 [INFO]: 	reconstruction error %: 0.0
2025-03-09 08:57:01,101 [INFO]: 	nb vectors: 2486
2025-03-09 08:57:01,101 [INFO]: 	vectors dimension: 49152
2025-03-09 08:57:01,101 [INFO]: 	compression ratio: 0.9993101643289642
2025-03-09 08:57:01,101 [INFO]: }
2025-03-09 08:57:01,101 [INFO]: 	>>> Finished "Creating the index" in 44.2239 secs
2025-03-09 08:57:01,101 [INFO]: >>> Finished "Launching the whole pipeline" in 44.2514 secs
2025-03-09 08:57:01: [retrieval_preprocessing] calculating distances ...
2025-03-09 08:57:02: [retrieval_preprocessing] finished and saved retrieval indices for episode 73278 [episode count 19/20]
2025-03-09 08:57:02: [retrieval_preprocessing] finished for (-1, 'mug') [chosen_id count 6/10]
2025-03-09 08:57:03: [retrieval_preprocessing] concatenated all embeddings and indices for 20 episodes for (9965421062, 'bottle') [chosen_id count 7/10]
2025-03-09 08:57:03: [retrieval_preprocessing] we have num_total=4588 embedding_dim=49152
[retrieval_preprocessing] for episode 65665 [episode count 0/20], we have num_retrieval=np.int64(4355) num_query=np.int64(233)
2025-03-09 08:57:04,213 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-09 08:57:04,794 [INFO]: Launching the whole pipeline 03/09/2025, 08:57:04
2025-03-09 08:57:04,794 [INFO]: Reading total number of vectors and dimension 03/09/2025, 08:57:04
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1625.70it/s]
2025-03-09 08:57:04,832 [INFO]: There are 4355 embeddings of dim 49152
2025-03-09 08:57:04,833 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0383 secs
2025-03-09 08:57:04,833 [INFO]: 	Compute estimated construction time of the index 03/09/2025, 08:57:04
2025-03-09 08:57:04,833 [INFO]: 		-> Train: 16.7 minutes
2025-03-09 08:57:04,833 [INFO]: 		-> Add: 2.4 seconds
2025-03-09 08:57:04,833 [INFO]: 		Total: 16.7 minutes
2025-03-09 08:57:04,833 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0002 secs
2025-03-09 08:57:04,833 [INFO]: 	Checking that your have enough memory available to create the index 03/09/2025, 08:57:04
2025-03-09 08:57:04,833 [INFO]: 898.8MB of memory will be needed to build the index (more might be used if you have more)
2025-03-09 08:57:04,833 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0003 secs
2025-03-09 08:57:04,833 [INFO]: 	Selecting most promising index types given data characteristics 03/09/2025, 08:57:04
2025-03-09 08:57:04,833 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-09 08:57:04,834 [INFO]: 	Creating the index 03/09/2025, 08:57:04
2025-03-09 08:57:04,834 [INFO]: 		-> Instanciate the index HNSW15 03/09/2025, 08:57:04
2025-03-09 08:57:04,836 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0019 secs
2025-03-09 08:57:04,836 [INFO]: 		-> Adding the vectors to the index 03/09/2025, 08:57:04
2025-03-09 08:57:04,836 [INFO]: The memory available for adding the vectors is 49.2GB(total available - used by the index)
2025-03-09 08:57:04,836 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/18 [00:00<?, ?it/s] 11%|█         | 2/18 [00:00<00:00, 17.74it/s] 50%|█████     | 9/18 [00:00<00:00, 43.68it/s] 89%|████████▉ | 16/18 [00:00<00:00, 51.91it/s]100%|██████████| 18/18 [00:03<00:00,  5.98it/s]
2025-03-09 08:57:07,851 [INFO]: 	Computing best hyperparameters for index knn.index 03/09/2025, 08:57:07
2025-03-09 08:57:52,779 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 44.9279 secs
2025-03-09 08:57:52,779 [INFO]: The best hyperparameters are: efSearch=195
2025-03-09 08:57:52,779 [INFO]: 	Compute fast metrics 03/09/2025, 08:57:52
  0%|          | 0/4 [00:00<?, ?it/s] 75%|███████▌  | 3/4 [00:00<00:00, 26.47it/s] 75%|███████▌  | 3/4 [00:00<00:00, 22.76it/s]
2025-03-09 08:58:15,056 [INFO]: 	>>> Finished "Compute fast metrics" in 22.2770 secs
2025-03-09 08:58:15,059 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 70.2233 secs
2025-03-09 08:58:15,059 [INFO]: {
2025-03-09 08:58:15,059 [INFO]: 	index_key: HNSW15
2025-03-09 08:58:15,059 [INFO]: 	index_param: efSearch=195
2025-03-09 08:58:15,059 [INFO]: 	index_path: knn.index
2025-03-09 08:58:15,059 [INFO]: 	size in bytes: 856820290
2025-03-09 08:58:15,059 [INFO]: 	avg_search_speed_ms: 9.045635271315575
2025-03-09 08:58:15,059 [INFO]: 	99p_search_speed_ms: 18.66701151011514
2025-03-09 08:58:15,059 [INFO]: 	reconstruction error %: 0.0
2025-03-09 08:58:15,059 [INFO]: 	nb vectors: 4355
2025-03-09 08:58:15,059 [INFO]: 	vectors dimension: 49152
2025-03-09 08:58:15,059 [INFO]: 	compression ratio: 0.9993085481203999
2025-03-09 08:58:15,059 [INFO]: }
2025-03-09 08:58:15,059 [INFO]: 	>>> Finished "Creating the index" in 70.2259 secs
2025-03-09 08:58:15,059 [INFO]: >>> Finished "Launching the whole pipeline" in 70.2653 secs
2025-03-09 08:58:16: [retrieval_preprocessing] calculating distances ...
2025-03-09 08:58:16: [retrieval_preprocessing] finished and saved retrieval indices for episode 65665 [episode count 0/20]
[retrieval_preprocessing] for episode 91138 [episode count 1/20], we have num_retrieval=np.int64(4432) num_query=np.int64(156)
2025-03-09 08:58:17,198 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-09 08:58:17,824 [INFO]: Launching the whole pipeline 03/09/2025, 08:58:17
2025-03-09 08:58:17,825 [INFO]: Reading total number of vectors and dimension 03/09/2025, 08:58:17
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1720.39it/s]
2025-03-09 08:58:17,855 [INFO]: There are 4432 embeddings of dim 49152
2025-03-09 08:58:17,855 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0308 secs
2025-03-09 08:58:17,855 [INFO]: 	Compute estimated construction time of the index 03/09/2025, 08:58:17
2025-03-09 08:58:17,856 [INFO]: 		-> Train: 16.7 minutes
2025-03-09 08:58:17,856 [INFO]: 		-> Add: 2.4 seconds
2025-03-09 08:58:17,856 [INFO]: 		Total: 16.7 minutes
2025-03-09 08:58:17,856 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0002 secs
2025-03-09 08:58:17,856 [INFO]: 	Checking that your have enough memory available to create the index 03/09/2025, 08:58:17
2025-03-09 08:58:17,856 [INFO]: 914.7MB of memory will be needed to build the index (more might be used if you have more)
2025-03-09 08:58:17,856 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0001 secs
2025-03-09 08:58:17,856 [INFO]: 	Selecting most promising index types given data characteristics 03/09/2025, 08:58:17
2025-03-09 08:58:17,856 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-09 08:58:17,856 [INFO]: 	Creating the index 03/09/2025, 08:58:17
2025-03-09 08:58:17,856 [INFO]: 		-> Instanciate the index HNSW15 03/09/2025, 08:58:17
2025-03-09 08:58:17,857 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0009 secs
2025-03-09 08:58:17,857 [INFO]: 		-> Adding the vectors to the index 03/09/2025, 08:58:17
2025-03-09 08:58:17,857 [INFO]: The memory available for adding the vectors is 49.2GB(total available - used by the index)
2025-03-09 08:58:17,857 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/18 [00:00<?, ?it/s] 11%|█         | 2/18 [00:00<00:00, 16.97it/s] 44%|████▍     | 8/18 [00:00<00:00, 39.74it/s] 78%|███████▊  | 14/18 [00:00<00:00, 47.95it/s]100%|██████████| 18/18 [00:03<00:00,  5.50it/s]
2025-03-09 08:58:22,013 [INFO]: 	Computing best hyperparameters for index knn.index 03/09/2025, 08:58:22
2025-03-09 08:59:02,312 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 40.2988 secs
2025-03-09 08:59:02,313 [INFO]: The best hyperparameters are: efSearch=225
2025-03-09 08:59:02,313 [INFO]: 	Compute fast metrics 03/09/2025, 08:59:02
  0%|          | 0/4 [00:00<?, ?it/s] 50%|█████     | 2/4 [00:00<00:00, 17.59it/s] 75%|███████▌  | 3/4 [00:00<00:00, 18.57it/s]
2025-03-09 08:59:19,340 [INFO]: 	>>> Finished "Compute fast metrics" in 17.0275 secs
2025-03-09 08:59:19,343 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 61.4854 secs
2025-03-09 08:59:19,343 [INFO]: {
2025-03-09 08:59:19,343 [INFO]: 	index_key: HNSW15
2025-03-09 08:59:19,343 [INFO]: 	index_param: efSearch=225
2025-03-09 08:59:19,343 [INFO]: 	index_path: knn.index
2025-03-09 08:59:19,343 [INFO]: 	size in bytes: 871969510
2025-03-09 08:59:19,343 [INFO]: 	avg_search_speed_ms: 10.322542039348798
2025-03-09 08:59:19,343 [INFO]: 	99p_search_speed_ms: 21.975368680432403
2025-03-09 08:59:19,343 [INFO]: 	reconstruction error %: 0.0
2025-03-09 08:59:19,343 [INFO]: 	nb vectors: 4432
2025-03-09 08:59:19,343 [INFO]: 	vectors dimension: 49152
2025-03-09 08:59:19,343 [INFO]: 	compression ratio: 0.9993086294955428
2025-03-09 08:59:19,343 [INFO]: }
2025-03-09 08:59:19,343 [INFO]: 	>>> Finished "Creating the index" in 61.4869 secs
2025-03-09 08:59:19,343 [INFO]: >>> Finished "Launching the whole pipeline" in 61.5183 secs
2025-03-09 08:59:20: [retrieval_preprocessing] calculating distances ...
2025-03-09 08:59:20: [retrieval_preprocessing] finished and saved retrieval indices for episode 91138 [episode count 1/20]
[retrieval_preprocessing] for episode 1283 [episode count 2/20], we have num_retrieval=np.int64(4392) num_query=np.int64(196)
2025-03-09 08:59:21,089 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-09 08:59:21,725 [INFO]: Launching the whole pipeline 03/09/2025, 08:59:21
2025-03-09 08:59:21,725 [INFO]: Reading total number of vectors and dimension 03/09/2025, 08:59:21
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1149.12it/s]
2025-03-09 08:59:21,761 [INFO]: There are 4392 embeddings of dim 49152
2025-03-09 08:59:21,761 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0366 secs
2025-03-09 08:59:21,762 [INFO]: 	Compute estimated construction time of the index 03/09/2025, 08:59:21
2025-03-09 08:59:21,762 [INFO]: 		-> Train: 16.7 minutes
2025-03-09 08:59:21,762 [INFO]: 		-> Add: 2.4 seconds
2025-03-09 08:59:21,762 [INFO]: 		Total: 16.7 minutes
2025-03-09 08:59:21,762 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0003 secs
2025-03-09 08:59:21,762 [INFO]: 	Checking that your have enough memory available to create the index 03/09/2025, 08:59:21
2025-03-09 08:59:21,762 [INFO]: 906.4MB of memory will be needed to build the index (more might be used if you have more)
2025-03-09 08:59:21,763 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0004 secs
2025-03-09 08:59:21,763 [INFO]: 	Selecting most promising index types given data characteristics 03/09/2025, 08:59:21
2025-03-09 08:59:21,763 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-09 08:59:21,763 [INFO]: 	Creating the index 03/09/2025, 08:59:21
2025-03-09 08:59:21,763 [INFO]: 		-> Instanciate the index HNSW15 03/09/2025, 08:59:21
2025-03-09 08:59:21,766 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0029 secs
2025-03-09 08:59:21,766 [INFO]: 		-> Adding the vectors to the index 03/09/2025, 08:59:21
2025-03-09 08:59:21,767 [INFO]: The memory available for adding the vectors is 49.2GB(total available - used by the index)
2025-03-09 08:59:21,767 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/18 [00:00<?, ?it/s] 11%|█         | 2/18 [00:00<00:00, 17.04it/s] 44%|████▍     | 8/18 [00:00<00:00, 38.51it/s] 72%|███████▏  | 13/18 [00:00<00:00, 41.43it/s]100%|██████████| 18/18 [00:03<00:00,  3.71it/s]100%|██████████| 18/18 [00:03<00:00,  5.23it/s]
2025-03-09 08:59:25,214 [INFO]: 	Computing best hyperparameters for index knn.index 03/09/2025, 08:59:25
2025-03-09 09:00:07,908 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 42.6929 secs
2025-03-09 09:00:07,908 [INFO]: The best hyperparameters are: efSearch=221
2025-03-09 09:00:07,908 [INFO]: 	Compute fast metrics 03/09/2025, 09:00:07
  0%|          | 0/4 [00:00<?, ?it/s] 50%|█████     | 2/4 [00:00<00:00, 19.15it/s] 75%|███████▌  | 3/4 [00:00<00:00, 20.66it/s]
2025-03-09 09:00:26,444 [INFO]: 	>>> Finished "Compute fast metrics" in 18.5353 secs
2025-03-09 09:00:26,654 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 64.8876 secs
2025-03-09 09:00:26,655 [INFO]: {
2025-03-09 09:00:26,655 [INFO]: 	index_key: HNSW15
2025-03-09 09:00:26,655 [INFO]: 	index_param: efSearch=221
2025-03-09 09:00:26,655 [INFO]: 	index_path: knn.index
2025-03-09 09:00:26,655 [INFO]: 	size in bytes: 864099730
2025-03-09 09:00:26,655 [INFO]: 	avg_search_speed_ms: 10.950144894955617
2025-03-09 09:00:26,655 [INFO]: 	99p_search_speed_ms: 24.280728148296475
2025-03-09 09:00:26,655 [INFO]: 	reconstruction error %: 0.0
2025-03-09 09:00:26,655 [INFO]: 	nb vectors: 4392
2025-03-09 09:00:26,655 [INFO]: 	vectors dimension: 49152
2025-03-09 09:00:26,655 [INFO]: 	compression ratio: 0.9993086515603934
2025-03-09 09:00:26,655 [INFO]: }
2025-03-09 09:00:26,655 [INFO]: 	>>> Finished "Creating the index" in 64.8920 secs
2025-03-09 09:00:26,655 [INFO]: >>> Finished "Launching the whole pipeline" in 64.9304 secs
2025-03-09 09:00:27: [retrieval_preprocessing] calculating distances ...
2025-03-09 09:00:28: [retrieval_preprocessing] finished and saved retrieval indices for episode 1283 [episode count 2/20]
[retrieval_preprocessing] for episode 49539 [episode count 3/20], we have num_retrieval=np.int64(4425) num_query=np.int64(163)
2025-03-09 09:00:28,532 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-09 09:00:29,076 [INFO]: Launching the whole pipeline 03/09/2025, 09:00:29
2025-03-09 09:00:29,077 [INFO]: Reading total number of vectors and dimension 03/09/2025, 09:00:29
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1511.46it/s]
2025-03-09 09:00:29,110 [INFO]: There are 4425 embeddings of dim 49152
2025-03-09 09:00:29,110 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0334 secs
2025-03-09 09:00:29,110 [INFO]: 	Compute estimated construction time of the index 03/09/2025, 09:00:29
2025-03-09 09:00:29,110 [INFO]: 		-> Train: 16.7 minutes
2025-03-09 09:00:29,111 [INFO]: 		-> Add: 2.4 seconds
2025-03-09 09:00:29,111 [INFO]: 		Total: 16.7 minutes
2025-03-09 09:00:29,111 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0005 secs
2025-03-09 09:00:29,111 [INFO]: 	Checking that your have enough memory available to create the index 03/09/2025, 09:00:29
2025-03-09 09:00:29,111 [INFO]: 913.2MB of memory will be needed to build the index (more might be used if you have more)
2025-03-09 09:00:29,112 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0005 secs
2025-03-09 09:00:29,112 [INFO]: 	Selecting most promising index types given data characteristics 03/09/2025, 09:00:29
2025-03-09 09:00:29,112 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-09 09:00:29,112 [INFO]: 	Creating the index 03/09/2025, 09:00:29
2025-03-09 09:00:29,112 [INFO]: 		-> Instanciate the index HNSW15 03/09/2025, 09:00:29
2025-03-09 09:00:29,115 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0029 secs
2025-03-09 09:00:29,115 [INFO]: 		-> Adding the vectors to the index 03/09/2025, 09:00:29
2025-03-09 09:00:29,116 [INFO]: The memory available for adding the vectors is 49.2GB(total available - used by the index)
2025-03-09 09:00:29,116 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/18 [00:00<?, ?it/s] 11%|█         | 2/18 [00:00<00:00, 19.91it/s] 44%|████▍     | 8/18 [00:00<00:00, 42.71it/s] 78%|███████▊  | 14/18 [00:00<00:00, 50.43it/s]100%|██████████| 18/18 [00:03<00:00,  5.21it/s]
2025-03-09 09:00:32,575 [INFO]: 	Computing best hyperparameters for index knn.index 03/09/2025, 09:00:32
2025-03-09 09:01:13,556 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 40.9801 secs
2025-03-09 09:01:13,556 [INFO]: The best hyperparameters are: efSearch=241
2025-03-09 09:01:13,556 [INFO]: 	Compute fast metrics 03/09/2025, 09:01:13
  0%|          | 0/4 [00:00<?, ?it/s] 75%|███████▌  | 3/4 [00:00<00:00, 26.05it/s] 75%|███████▌  | 3/4 [00:00<00:00, 22.48it/s]
2025-03-09 09:01:33,770 [INFO]: 	>>> Finished "Compute fast metrics" in 20.2136 secs
2025-03-09 09:01:33,773 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 64.6571 secs
2025-03-09 09:01:33,773 [INFO]: {
2025-03-09 09:01:33,773 [INFO]: 	index_key: HNSW15
2025-03-09 09:01:33,773 [INFO]: 	index_param: efSearch=241
2025-03-09 09:01:33,773 [INFO]: 	index_path: knn.index
2025-03-09 09:01:33,773 [INFO]: 	size in bytes: 870592330
2025-03-09 09:01:33,773 [INFO]: 	avg_search_speed_ms: 11.566712219548018
2025-03-09 09:01:33,773 [INFO]: 	99p_search_speed_ms: 25.08564251475037
2025-03-09 09:01:33,773 [INFO]: 	reconstruction error %: 0.0
2025-03-09 09:01:33,773 [INFO]: 	nb vectors: 4425
2025-03-09 09:01:33,773 [INFO]: 	vectors dimension: 49152
2025-03-09 09:01:33,773 [INFO]: 	compression ratio: 0.9993085971708481
2025-03-09 09:01:33,773 [INFO]: }
2025-03-09 09:01:33,773 [INFO]: 	>>> Finished "Creating the index" in 64.6609 secs
2025-03-09 09:01:33,773 [INFO]: >>> Finished "Launching the whole pipeline" in 64.6966 secs
2025-03-09 09:01:35: [retrieval_preprocessing] calculating distances ...
2025-03-09 09:01:35: [retrieval_preprocessing] finished and saved retrieval indices for episode 49539 [episode count 3/20]
[retrieval_preprocessing] for episode 73478 [episode count 4/20], we have num_retrieval=np.int64(4340) num_query=np.int64(248)
2025-03-09 09:01:36,095 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-09 09:01:36,646 [INFO]: Launching the whole pipeline 03/09/2025, 09:01:36
2025-03-09 09:01:36,646 [INFO]: Reading total number of vectors and dimension 03/09/2025, 09:01:36
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1293.74it/s]
2025-03-09 09:01:36,674 [INFO]: There are 4340 embeddings of dim 49152
2025-03-09 09:01:36,674 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0286 secs
2025-03-09 09:01:36,675 [INFO]: 	Compute estimated construction time of the index 03/09/2025, 09:01:36
2025-03-09 09:01:36,675 [INFO]: 		-> Train: 16.7 minutes
2025-03-09 09:01:36,675 [INFO]: 		-> Add: 2.4 seconds
2025-03-09 09:01:36,675 [INFO]: 		Total: 16.7 minutes
2025-03-09 09:01:36,675 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0001 secs
2025-03-09 09:01:36,675 [INFO]: 	Checking that your have enough memory available to create the index 03/09/2025, 09:01:36
2025-03-09 09:01:36,675 [INFO]: 895.7MB of memory will be needed to build the index (more might be used if you have more)
2025-03-09 09:01:36,675 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0002 secs
2025-03-09 09:01:36,675 [INFO]: 	Selecting most promising index types given data characteristics 03/09/2025, 09:01:36
2025-03-09 09:01:36,675 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-09 09:01:36,675 [INFO]: 	Creating the index 03/09/2025, 09:01:36
2025-03-09 09:01:36,675 [INFO]: 		-> Instanciate the index HNSW15 03/09/2025, 09:01:36
2025-03-09 09:01:36,676 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0010 secs
2025-03-09 09:01:36,676 [INFO]: 		-> Adding the vectors to the index 03/09/2025, 09:01:36
2025-03-09 09:01:36,676 [INFO]: The memory available for adding the vectors is 49.2GB(total available - used by the index)
2025-03-09 09:01:36,676 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/18 [00:00<?, ?it/s] 11%|█         | 2/18 [00:00<00:00, 19.76it/s] 44%|████▍     | 8/18 [00:00<00:00, 41.33it/s] 78%|███████▊  | 14/18 [00:00<00:00, 47.84it/s]100%|██████████| 18/18 [00:03<00:00,  5.44it/s]
2025-03-09 09:01:40,534 [INFO]: 	Computing best hyperparameters for index knn.index 03/09/2025, 09:01:40
2025-03-09 09:02:22,636 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 42.1021 secs
2025-03-09 09:02:22,637 [INFO]: The best hyperparameters are: efSearch=221
2025-03-09 09:02:22,637 [INFO]: 	Compute fast metrics 03/09/2025, 09:02:22
  0%|          | 0/4 [00:00<?, ?it/s] 50%|█████     | 2/4 [00:00<00:00, 17.11it/s] 75%|███████▌  | 3/4 [00:00<00:00, 15.24it/s]
2025-03-09 09:02:37,856 [INFO]: 	>>> Finished "Compute fast metrics" in 15.2192 secs
2025-03-09 09:02:37,859 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 61.1823 secs
2025-03-09 09:02:37,859 [INFO]: {
2025-03-09 09:02:37,859 [INFO]: 	index_key: HNSW15
2025-03-09 09:02:37,859 [INFO]: 	index_param: efSearch=221
2025-03-09 09:02:37,859 [INFO]: 	index_path: knn.index
2025-03-09 09:02:37,859 [INFO]: 	size in bytes: 853869070
2025-03-09 09:02:37,859 [INFO]: 	avg_search_speed_ms: 10.758279865076865
2025-03-09 09:02:37,859 [INFO]: 	99p_search_speed_ms: 22.225607715081424
2025-03-09 09:02:37,859 [INFO]: 	reconstruction error %: 0.0
2025-03-09 09:02:37,859 [INFO]: 	nb vectors: 4340
2025-03-09 09:02:37,859 [INFO]: 	vectors dimension: 49152
2025-03-09 09:02:37,859 [INFO]: 	compression ratio: 0.9993086176549292
2025-03-09 09:02:37,859 [INFO]: }
2025-03-09 09:02:37,859 [INFO]: 	>>> Finished "Creating the index" in 61.1838 secs
2025-03-09 09:02:37,859 [INFO]: >>> Finished "Launching the whole pipeline" in 61.2130 secs
2025-03-09 09:02:38: [retrieval_preprocessing] calculating distances ...
2025-03-09 09:02:39: [retrieval_preprocessing] finished and saved retrieval indices for episode 73478 [episode count 4/20]
[retrieval_preprocessing] for episode 90630 [episode count 5/20], we have num_retrieval=np.int64(4426) num_query=np.int64(162)
2025-03-09 09:02:40,116 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-09 09:02:40,684 [INFO]: Launching the whole pipeline 03/09/2025, 09:02:40
2025-03-09 09:02:40,684 [INFO]: Reading total number of vectors and dimension 03/09/2025, 09:02:40
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1225.69it/s]
2025-03-09 09:02:40,711 [INFO]: There are 4426 embeddings of dim 49152
2025-03-09 09:02:40,712 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0279 secs
2025-03-09 09:02:40,712 [INFO]: 	Compute estimated construction time of the index 03/09/2025, 09:02:40
2025-03-09 09:02:40,712 [INFO]: 		-> Train: 16.7 minutes
2025-03-09 09:02:40,712 [INFO]: 		-> Add: 2.4 seconds
2025-03-09 09:02:40,712 [INFO]: 		Total: 16.7 minutes
2025-03-09 09:02:40,712 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0001 secs
2025-03-09 09:02:40,712 [INFO]: 	Checking that your have enough memory available to create the index 03/09/2025, 09:02:40
2025-03-09 09:02:40,712 [INFO]: 913.4MB of memory will be needed to build the index (more might be used if you have more)
2025-03-09 09:02:40,712 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0001 secs
2025-03-09 09:02:40,712 [INFO]: 	Selecting most promising index types given data characteristics 03/09/2025, 09:02:40
2025-03-09 09:02:40,712 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-09 09:02:40,712 [INFO]: 	Creating the index 03/09/2025, 09:02:40
2025-03-09 09:02:40,712 [INFO]: 		-> Instanciate the index HNSW15 03/09/2025, 09:02:40
2025-03-09 09:02:40,713 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0009 secs
2025-03-09 09:02:40,713 [INFO]: 		-> Adding the vectors to the index 03/09/2025, 09:02:40
2025-03-09 09:02:40,713 [INFO]: The memory available for adding the vectors is 49.2GB(total available - used by the index)
2025-03-09 09:02:40,713 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/18 [00:00<?, ?it/s] 11%|█         | 2/18 [00:00<00:00, 16.28it/s] 39%|███▉      | 7/18 [00:00<00:00, 33.68it/s] 67%|██████▋   | 12/18 [00:00<00:00, 37.72it/s]100%|██████████| 18/18 [00:03<00:00,  3.31it/s]100%|██████████| 18/18 [00:03<00:00,  4.52it/s]
2025-03-09 09:02:44,703 [INFO]: 	Computing best hyperparameters for index knn.index 03/09/2025, 09:02:44
2025-03-09 09:03:22,734 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 38.0307 secs
2025-03-09 09:03:22,734 [INFO]: The best hyperparameters are: efSearch=255
2025-03-09 09:03:22,734 [INFO]: 	Compute fast metrics 03/09/2025, 09:03:22
  0%|          | 0/4 [00:00<?, ?it/s] 50%|█████     | 2/4 [00:00<00:00, 18.86it/s] 75%|███████▌  | 3/4 [00:00<00:00, 20.78it/s]
2025-03-09 09:03:39,159 [INFO]: 	>>> Finished "Compute fast metrics" in 16.4250 secs
2025-03-09 09:03:39,161 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 58.4483 secs
2025-03-09 09:03:39,162 [INFO]: {
2025-03-09 09:03:39,162 [INFO]: 	index_key: HNSW15
2025-03-09 09:03:39,162 [INFO]: 	index_param: efSearch=255
2025-03-09 09:03:39,162 [INFO]: 	index_path: knn.index
2025-03-09 09:03:39,162 [INFO]: 	size in bytes: 870789070
2025-03-09 09:03:39,162 [INFO]: 	avg_search_speed_ms: 11.828203476969831
2025-03-09 09:03:39,162 [INFO]: 	99p_search_speed_ms: 25.429719628300465
2025-03-09 09:03:39,162 [INFO]: 	reconstruction error %: 0.0
2025-03-09 09:03:39,162 [INFO]: 	nb vectors: 4426
2025-03-09 09:03:39,162 [INFO]: 	vectors dimension: 49152
2025-03-09 09:03:39,162 [INFO]: 	compression ratio: 0.9993086017949214
2025-03-09 09:03:39,162 [INFO]: }
2025-03-09 09:03:39,162 [INFO]: 	>>> Finished "Creating the index" in 58.4496 secs
2025-03-09 09:03:39,162 [INFO]: >>> Finished "Launching the whole pipeline" in 58.4780 secs
2025-03-09 09:03:40: [retrieval_preprocessing] calculating distances ...
2025-03-09 09:03:40: [retrieval_preprocessing] finished and saved retrieval indices for episode 90630 [episode count 5/20]
[retrieval_preprocessing] for episode 95112 [episode count 6/20], we have num_retrieval=np.int64(4371) num_query=np.int64(217)
2025-03-09 09:03:41,106 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-09 09:03:41,618 [INFO]: Launching the whole pipeline 03/09/2025, 09:03:41
2025-03-09 09:03:41,618 [INFO]: Reading total number of vectors and dimension 03/09/2025, 09:03:41
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1741.10it/s]
2025-03-09 09:03:41,643 [INFO]: There are 4371 embeddings of dim 49152
2025-03-09 09:03:41,643 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0249 secs
2025-03-09 09:03:41,643 [INFO]: 	Compute estimated construction time of the index 03/09/2025, 09:03:41
2025-03-09 09:03:41,643 [INFO]: 		-> Train: 16.7 minutes
2025-03-09 09:03:41,643 [INFO]: 		-> Add: 2.4 seconds
2025-03-09 09:03:41,643 [INFO]: 		Total: 16.7 minutes
2025-03-09 09:03:41,643 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0001 secs
2025-03-09 09:03:41,643 [INFO]: 	Checking that your have enough memory available to create the index 03/09/2025, 09:03:41
2025-03-09 09:03:41,643 [INFO]: 902.1MB of memory will be needed to build the index (more might be used if you have more)
2025-03-09 09:03:41,643 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0001 secs
2025-03-09 09:03:41,643 [INFO]: 	Selecting most promising index types given data characteristics 03/09/2025, 09:03:41
2025-03-09 09:03:41,643 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-09 09:03:41,643 [INFO]: 	Creating the index 03/09/2025, 09:03:41
2025-03-09 09:03:41,643 [INFO]: 		-> Instanciate the index HNSW15 03/09/2025, 09:03:41
2025-03-09 09:03:41,644 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0009 secs
2025-03-09 09:03:41,644 [INFO]: 		-> Adding the vectors to the index 03/09/2025, 09:03:41
2025-03-09 09:03:41,644 [INFO]: The memory available for adding the vectors is 49.2GB(total available - used by the index)
2025-03-09 09:03:41,644 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/18 [00:00<?, ?it/s] 11%|█         | 2/18 [00:00<00:00, 16.85it/s] 39%|███▉      | 7/18 [00:00<00:00, 31.09it/s] 72%|███████▏  | 13/18 [00:00<00:00, 39.99it/s]100%|██████████| 18/18 [00:03<00:00,  3.53it/s]100%|██████████| 18/18 [00:03<00:00,  4.90it/s]
2025-03-09 09:03:45,324 [INFO]: 	Computing best hyperparameters for index knn.index 03/09/2025, 09:03:45
2025-03-09 09:04:26,540 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 41.2156 secs
2025-03-09 09:04:26,540 [INFO]: The best hyperparameters are: efSearch=244
2025-03-09 09:04:26,540 [INFO]: 	Compute fast metrics 03/09/2025, 09:04:26
  0%|          | 0/4 [00:00<?, ?it/s] 75%|███████▌  | 3/4 [00:00<00:00, 25.97it/s] 75%|███████▌  | 3/4 [00:00<00:00, 22.47it/s]
2025-03-09 09:04:44,147 [INFO]: 	>>> Finished "Compute fast metrics" in 17.6069 secs
2025-03-09 09:04:44,149 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 62.5048 secs
2025-03-09 09:04:44,149 [INFO]: {
2025-03-09 09:04:44,149 [INFO]: 	index_key: HNSW15
2025-03-09 09:04:44,149 [INFO]: 	index_param: efSearch=244
2025-03-09 09:04:44,149 [INFO]: 	index_path: knn.index
2025-03-09 09:04:44,149 [INFO]: 	size in bytes: 859968130
2025-03-09 09:04:44,149 [INFO]: 	avg_search_speed_ms: 12.041107091882347
2025-03-09 09:04:44,149 [INFO]: 	99p_search_speed_ms: 24.948548967950046
2025-03-09 09:04:44,149 [INFO]: 	reconstruction error %: 0.0
2025-03-09 09:04:44,149 [INFO]: 	nb vectors: 4371
2025-03-09 09:04:44,149 [INFO]: 	vectors dimension: 49152
2025-03-09 09:04:44,149 [INFO]: 	compression ratio: 0.999308623216072
2025-03-09 09:04:44,149 [INFO]: }
2025-03-09 09:04:44,149 [INFO]: 	>>> Finished "Creating the index" in 62.5062 secs
2025-03-09 09:04:44,149 [INFO]: >>> Finished "Launching the whole pipeline" in 62.5316 secs
2025-03-09 09:04:45: [retrieval_preprocessing] calculating distances ...
2025-03-09 09:04:46: [retrieval_preprocessing] finished and saved retrieval indices for episode 95112 [episode count 6/20]
[retrieval_preprocessing] for episode 50957 [episode count 7/20], we have num_retrieval=np.int64(4326) num_query=np.int64(262)
2025-03-09 09:04:46,677 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-09 09:04:47,322 [INFO]: Launching the whole pipeline 03/09/2025, 09:04:47
2025-03-09 09:04:47,322 [INFO]: Reading total number of vectors and dimension 03/09/2025, 09:04:47
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 2146.52it/s]
2025-03-09 09:04:47,352 [INFO]: There are 4326 embeddings of dim 49152
2025-03-09 09:04:47,353 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0300 secs
2025-03-09 09:04:47,353 [INFO]: 	Compute estimated construction time of the index 03/09/2025, 09:04:47
2025-03-09 09:04:47,353 [INFO]: 		-> Train: 16.7 minutes
2025-03-09 09:04:47,353 [INFO]: 		-> Add: 2.4 seconds
2025-03-09 09:04:47,353 [INFO]: 		Total: 16.7 minutes
2025-03-09 09:04:47,353 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0001 secs
2025-03-09 09:04:47,353 [INFO]: 	Checking that your have enough memory available to create the index 03/09/2025, 09:04:47
2025-03-09 09:04:47,353 [INFO]: 892.8MB of memory will be needed to build the index (more might be used if you have more)
2025-03-09 09:04:47,353 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0002 secs
2025-03-09 09:04:47,353 [INFO]: 	Selecting most promising index types given data characteristics 03/09/2025, 09:04:47
2025-03-09 09:04:47,353 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-09 09:04:47,353 [INFO]: 	Creating the index 03/09/2025, 09:04:47
2025-03-09 09:04:47,353 [INFO]: 		-> Instanciate the index HNSW15 03/09/2025, 09:04:47
2025-03-09 09:04:47,355 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0013 secs
2025-03-09 09:04:47,355 [INFO]: 		-> Adding the vectors to the index 03/09/2025, 09:04:47
2025-03-09 09:04:47,355 [INFO]: The memory available for adding the vectors is 49.2GB(total available - used by the index)
2025-03-09 09:04:47,355 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/18 [00:00<?, ?it/s]  6%|▌         | 1/18 [00:00<00:02,  8.36it/s] 28%|██▊       | 5/18 [00:00<00:00, 25.09it/s] 56%|█████▌    | 10/18 [00:00<00:00, 35.87it/s] 83%|████████▎ | 15/18 [00:00<00:00, 40.35it/s]100%|██████████| 18/18 [00:03<00:00,  4.64it/s]
2025-03-09 09:04:51,235 [INFO]: 	Computing best hyperparameters for index knn.index 03/09/2025, 09:04:51
2025-03-09 09:05:32,873 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 41.6380 secs
2025-03-09 09:05:32,874 [INFO]: The best hyperparameters are: efSearch=244
2025-03-09 09:05:32,874 [INFO]: 	Compute fast metrics 03/09/2025, 09:05:32
  0%|          | 0/4 [00:00<?, ?it/s] 50%|█████     | 2/4 [00:00<00:00, 15.34it/s] 75%|███████▌  | 3/4 [00:00<00:00, 15.27it/s]
2025-03-09 09:05:51,426 [INFO]: 	>>> Finished "Compute fast metrics" in 18.5525 secs
2025-03-09 09:05:51,429 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 64.0741 secs
2025-03-09 09:05:51,429 [INFO]: {
2025-03-09 09:05:51,429 [INFO]: 	index_key: HNSW15
2025-03-09 09:05:51,429 [INFO]: 	index_param: efSearch=244
2025-03-09 09:05:51,429 [INFO]: 	index_path: knn.index
2025-03-09 09:05:51,429 [INFO]: 	size in bytes: 851114650
2025-03-09 09:05:51,429 [INFO]: 	avg_search_speed_ms: 13.056586869182576
2025-03-09 09:05:51,429 [INFO]: 	99p_search_speed_ms: 29.215520783327534
2025-03-09 09:05:51,429 [INFO]: 	reconstruction error %: 0.0
2025-03-09 09:05:51,429 [INFO]: 	nb vectors: 4326
2025-03-09 09:05:51,429 [INFO]: 	vectors dimension: 49152
2025-03-09 09:05:51,429 [INFO]: 	compression ratio: 0.999308621934777
2025-03-09 09:05:51,429 [INFO]: }
2025-03-09 09:05:51,429 [INFO]: 	>>> Finished "Creating the index" in 64.0759 secs
2025-03-09 09:05:51,429 [INFO]: >>> Finished "Launching the whole pipeline" in 64.1067 secs
2025-03-09 09:05:53: [retrieval_preprocessing] calculating distances ...
2025-03-09 09:05:53: [retrieval_preprocessing] finished and saved retrieval indices for episode 50957 [episode count 7/20]
[retrieval_preprocessing] for episode 42000 [episode count 8/20], we have num_retrieval=np.int64(4362) num_query=np.int64(226)
2025-03-09 09:05:54,212 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-09 09:05:54,807 [INFO]: Launching the whole pipeline 03/09/2025, 09:05:54
2025-03-09 09:05:54,807 [INFO]: Reading total number of vectors and dimension 03/09/2025, 09:05:54
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1154.18it/s]
2025-03-09 09:05:54,837 [INFO]: There are 4362 embeddings of dim 49152
2025-03-09 09:05:54,837 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0302 secs
2025-03-09 09:05:54,837 [INFO]: 	Compute estimated construction time of the index 03/09/2025, 09:05:54
2025-03-09 09:05:54,837 [INFO]: 		-> Train: 16.7 minutes
2025-03-09 09:05:54,837 [INFO]: 		-> Add: 2.4 seconds
2025-03-09 09:05:54,837 [INFO]: 		Total: 16.7 minutes
2025-03-09 09:05:54,837 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0002 secs
2025-03-09 09:05:54,837 [INFO]: 	Checking that your have enough memory available to create the index 03/09/2025, 09:05:54
2025-03-09 09:05:54,838 [INFO]: 900.2MB of memory will be needed to build the index (more might be used if you have more)
2025-03-09 09:05:54,838 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0001 secs
2025-03-09 09:05:54,838 [INFO]: 	Selecting most promising index types given data characteristics 03/09/2025, 09:05:54
2025-03-09 09:05:54,838 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-09 09:05:54,838 [INFO]: 	Creating the index 03/09/2025, 09:05:54
2025-03-09 09:05:54,838 [INFO]: 		-> Instanciate the index HNSW15 03/09/2025, 09:05:54
2025-03-09 09:05:54,839 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0010 secs
2025-03-09 09:05:54,839 [INFO]: 		-> Adding the vectors to the index 03/09/2025, 09:05:54
2025-03-09 09:05:54,839 [INFO]: The memory available for adding the vectors is 49.2GB(total available - used by the index)
2025-03-09 09:05:54,839 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/18 [00:00<?, ?it/s]  6%|▌         | 1/18 [00:00<00:02,  7.83it/s] 39%|███▉      | 7/18 [00:00<00:00, 32.22it/s] 67%|██████▋   | 12/18 [00:00<00:00, 39.30it/s]100%|██████████| 18/18 [00:03<00:00,  4.07it/s]100%|██████████| 18/18 [00:03<00:00,  5.42it/s]
2025-03-09 09:05:58,163 [INFO]: 	Computing best hyperparameters for index knn.index 03/09/2025, 09:05:58
2025-03-09 09:06:43,289 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 45.1258 secs
2025-03-09 09:06:43,289 [INFO]: The best hyperparameters are: efSearch=219
2025-03-09 09:06:43,289 [INFO]: 	Compute fast metrics 03/09/2025, 09:06:43
  0%|          | 0/4 [00:00<?, ?it/s] 50%|█████     | 2/4 [00:00<00:00, 18.46it/s] 75%|███████▌  | 3/4 [00:00<00:00, 20.35it/s]
2025-03-09 09:06:58,427 [INFO]: 	>>> Finished "Compute fast metrics" in 15.1378 secs
2025-03-09 09:06:58,429 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 63.5902 secs
2025-03-09 09:06:58,429 [INFO]: {
2025-03-09 09:06:58,429 [INFO]: 	index_key: HNSW15
2025-03-09 09:06:58,429 [INFO]: 	index_param: efSearch=219
2025-03-09 09:06:58,429 [INFO]: 	index_path: knn.index
2025-03-09 09:06:58,429 [INFO]: 	size in bytes: 858197470
2025-03-09 09:06:58,429 [INFO]: 	avg_search_speed_ms: 10.902292032664157
2025-03-09 09:06:58,429 [INFO]: 	99p_search_speed_ms: 20.137362480163585
2025-03-09 09:06:58,429 [INFO]: 	reconstruction error %: 0.0
2025-03-09 09:06:58,429 [INFO]: 	nb vectors: 4362
2025-03-09 09:06:58,429 [INFO]: 	vectors dimension: 49152
2025-03-09 09:06:58,429 [INFO]: 	compression ratio: 0.9993085810425426
2025-03-09 09:06:58,429 [INFO]: }
2025-03-09 09:06:58,429 [INFO]: 	>>> Finished "Creating the index" in 63.5917 secs
2025-03-09 09:06:58,429 [INFO]: >>> Finished "Launching the whole pipeline" in 63.6225 secs
2025-03-09 09:06:59: [retrieval_preprocessing] calculating distances ...
2025-03-09 09:07:00: [retrieval_preprocessing] finished and saved retrieval indices for episode 42000 [episode count 8/20]
[retrieval_preprocessing] for episode 14865 [episode count 9/20], we have num_retrieval=np.int64(4365) num_query=np.int64(223)
2025-03-09 09:07:00,505 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-09 09:07:01,133 [INFO]: Launching the whole pipeline 03/09/2025, 09:07:01
2025-03-09 09:07:01,133 [INFO]: Reading total number of vectors and dimension 03/09/2025, 09:07:01
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1980.31it/s]
2025-03-09 09:07:01,161 [INFO]: There are 4365 embeddings of dim 49152
2025-03-09 09:07:01,162 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0285 secs
2025-03-09 09:07:01,162 [INFO]: 	Compute estimated construction time of the index 03/09/2025, 09:07:01
2025-03-09 09:07:01,162 [INFO]: 		-> Train: 16.7 minutes
2025-03-09 09:07:01,162 [INFO]: 		-> Add: 2.4 seconds
2025-03-09 09:07:01,162 [INFO]: 		Total: 16.7 minutes
2025-03-09 09:07:01,162 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0001 secs
2025-03-09 09:07:01,162 [INFO]: 	Checking that your have enough memory available to create the index 03/09/2025, 09:07:01
2025-03-09 09:07:01,162 [INFO]: 900.8MB of memory will be needed to build the index (more might be used if you have more)
2025-03-09 09:07:01,162 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0001 secs
2025-03-09 09:07:01,162 [INFO]: 	Selecting most promising index types given data characteristics 03/09/2025, 09:07:01
2025-03-09 09:07:01,162 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-09 09:07:01,162 [INFO]: 	Creating the index 03/09/2025, 09:07:01
2025-03-09 09:07:01,162 [INFO]: 		-> Instanciate the index HNSW15 03/09/2025, 09:07:01
2025-03-09 09:07:01,163 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0010 secs
2025-03-09 09:07:01,163 [INFO]: 		-> Adding the vectors to the index 03/09/2025, 09:07:01
2025-03-09 09:07:01,163 [INFO]: The memory available for adding the vectors is 49.2GB(total available - used by the index)
2025-03-09 09:07:01,163 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/18 [00:00<?, ?it/s]  6%|▌         | 1/18 [00:00<00:02,  8.36it/s] 28%|██▊       | 5/18 [00:00<00:00, 23.96it/s] 50%|█████     | 9/18 [00:00<00:00, 26.52it/s] 72%|███████▏  | 13/18 [00:00<00:00, 29.99it/s] 94%|█████████▍| 17/18 [00:00<00:00, 32.40it/s]100%|██████████| 18/18 [00:03<00:00,  4.65it/s]
2025-03-09 09:07:05,039 [INFO]: 	Computing best hyperparameters for index knn.index 03/09/2025, 09:07:05
2025-03-09 09:07:47,096 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 42.0564 secs
2025-03-09 09:07:47,096 [INFO]: The best hyperparameters are: efSearch=243
2025-03-09 09:07:47,096 [INFO]: 	Compute fast metrics 03/09/2025, 09:07:47
  0%|          | 0/4 [00:00<?, ?it/s] 50%|█████     | 2/4 [00:00<00:00, 16.62it/s] 75%|███████▌  | 3/4 [00:00<00:00, 16.76it/s]
2025-03-09 09:08:03,257 [INFO]: 	>>> Finished "Compute fast metrics" in 16.1606 secs
2025-03-09 09:08:03,259 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 62.0959 secs
2025-03-09 09:08:03,259 [INFO]: {
2025-03-09 09:08:03,259 [INFO]: 	index_key: HNSW15
2025-03-09 09:08:03,259 [INFO]: 	index_param: efSearch=243
2025-03-09 09:08:03,259 [INFO]: 	index_path: knn.index
2025-03-09 09:08:03,259 [INFO]: 	size in bytes: 858787690
2025-03-09 09:08:03,259 [INFO]: 	avg_search_speed_ms: 10.891419150339022
2025-03-09 09:08:03,259 [INFO]: 	99p_search_speed_ms: 19.00135756935926
2025-03-09 09:08:03,259 [INFO]: 	reconstruction error %: 0.0
2025-03-09 09:08:03,259 [INFO]: 	nb vectors: 4365
2025-03-09 09:08:03,259 [INFO]: 	vectors dimension: 49152
2025-03-09 09:08:03,259 [INFO]: 	compression ratio: 0.9993085951197088
2025-03-09 09:08:03,259 [INFO]: }
2025-03-09 09:08:03,259 [INFO]: 	>>> Finished "Creating the index" in 62.0974 secs
2025-03-09 09:08:03,259 [INFO]: >>> Finished "Launching the whole pipeline" in 62.1264 secs
2025-03-09 09:08:04: [retrieval_preprocessing] calculating distances ...
2025-03-09 09:08:05: [retrieval_preprocessing] finished and saved retrieval indices for episode 14865 [episode count 9/20]
[retrieval_preprocessing] for episode 61840 [episode count 10/20], we have num_retrieval=np.int64(4318) num_query=np.int64(270)
2025-03-09 09:08:05,755 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-09 09:08:06,276 [INFO]: Launching the whole pipeline 03/09/2025, 09:08:06
2025-03-09 09:08:06,276 [INFO]: Reading total number of vectors and dimension 03/09/2025, 09:08:06
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1805.55it/s]
2025-03-09 09:08:06,307 [INFO]: There are 4318 embeddings of dim 49152
2025-03-09 09:08:06,307 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0305 secs
2025-03-09 09:08:06,307 [INFO]: 	Compute estimated construction time of the index 03/09/2025, 09:08:06
2025-03-09 09:08:06,307 [INFO]: 		-> Train: 16.7 minutes
2025-03-09 09:08:06,307 [INFO]: 		-> Add: 2.4 seconds
2025-03-09 09:08:06,307 [INFO]: 		Total: 16.7 minutes
2025-03-09 09:08:06,307 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0001 secs
2025-03-09 09:08:06,307 [INFO]: 	Checking that your have enough memory available to create the index 03/09/2025, 09:08:06
2025-03-09 09:08:06,307 [INFO]: 891.1MB of memory will be needed to build the index (more might be used if you have more)
2025-03-09 09:08:06,307 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0002 secs
2025-03-09 09:08:06,307 [INFO]: 	Selecting most promising index types given data characteristics 03/09/2025, 09:08:06
2025-03-09 09:08:06,307 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-09 09:08:06,308 [INFO]: 	Creating the index 03/09/2025, 09:08:06
2025-03-09 09:08:06,308 [INFO]: 		-> Instanciate the index HNSW15 03/09/2025, 09:08:06
2025-03-09 09:08:06,309 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0013 secs
2025-03-09 09:08:06,309 [INFO]: 		-> Adding the vectors to the index 03/09/2025, 09:08:06
2025-03-09 09:08:06,309 [INFO]: The memory available for adding the vectors is 49.2GB(total available - used by the index)
2025-03-09 09:08:06,309 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/17 [00:00<?, ?it/s] 12%|█▏        | 2/17 [00:00<00:00, 17.78it/s] 41%|████      | 7/17 [00:00<00:00, 33.72it/s] 65%|██████▍   | 11/17 [00:00<00:00, 36.37it/s]100%|██████████| 17/17 [00:03<00:00,  3.44it/s]100%|██████████| 17/17 [00:03<00:00,  4.68it/s]
2025-03-09 09:08:09,946 [INFO]: 	Computing best hyperparameters for index knn.index 03/09/2025, 09:08:09
2025-03-09 09:08:50,921 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 40.9740 secs
2025-03-09 09:08:50,921 [INFO]: The best hyperparameters are: efSearch=271
2025-03-09 09:08:50,921 [INFO]: 	Compute fast metrics 03/09/2025, 09:08:50
  0%|          | 0/4 [00:00<?, ?it/s] 50%|█████     | 2/4 [00:00<00:00, 19.21it/s] 75%|███████▌  | 3/4 [00:00<00:00, 20.44it/s]
2025-03-09 09:09:08,951 [INFO]: 	>>> Finished "Compute fast metrics" in 18.0296 secs
2025-03-09 09:09:08,953 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 62.6442 secs
2025-03-09 09:09:08,953 [INFO]: {
2025-03-09 09:09:08,953 [INFO]: 	index_key: HNSW15
2025-03-09 09:09:08,953 [INFO]: 	index_param: efSearch=271
2025-03-09 09:09:08,953 [INFO]: 	index_path: knn.index
2025-03-09 09:09:08,953 [INFO]: 	size in bytes: 849540670
2025-03-09 09:09:08,953 [INFO]: 	avg_search_speed_ms: 13.216937403102335
2025-03-09 09:09:08,953 [INFO]: 	99p_search_speed_ms: 28.421782227233045
2025-03-09 09:09:08,954 [INFO]: 	reconstruction error %: 0.0
2025-03-09 09:09:08,954 [INFO]: 	nb vectors: 4318
2025-03-09 09:09:08,954 [INFO]: 	vectors dimension: 49152
2025-03-09 09:09:08,954 [INFO]: 	compression ratio: 0.9993086546403953
2025-03-09 09:09:08,954 [INFO]: }
2025-03-09 09:09:08,954 [INFO]: 	>>> Finished "Creating the index" in 62.6460 secs
2025-03-09 09:09:08,954 [INFO]: >>> Finished "Launching the whole pipeline" in 62.6773 secs
2025-03-09 09:09:11: [retrieval_preprocessing] calculating distances ...
2025-03-09 09:09:12: [retrieval_preprocessing] finished and saved retrieval indices for episode 61840 [episode count 10/20]
[retrieval_preprocessing] for episode 80277 [episode count 11/20], we have num_retrieval=np.int64(4190) num_query=np.int64(398)
2025-03-09 09:09:12,474 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-09 09:09:13,038 [INFO]: Launching the whole pipeline 03/09/2025, 09:09:13
2025-03-09 09:09:13,038 [INFO]: Reading total number of vectors and dimension 03/09/2025, 09:09:13
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1562.12it/s]
2025-03-09 09:09:13,067 [INFO]: There are 4190 embeddings of dim 49152
2025-03-09 09:09:13,067 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0292 secs
2025-03-09 09:09:13,068 [INFO]: 	Compute estimated construction time of the index 03/09/2025, 09:09:13
2025-03-09 09:09:13,068 [INFO]: 		-> Train: 16.7 minutes
2025-03-09 09:09:13,068 [INFO]: 		-> Add: 2.3 seconds
2025-03-09 09:09:13,068 [INFO]: 		Total: 16.7 minutes
2025-03-09 09:09:13,068 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0002 secs
2025-03-09 09:09:13,068 [INFO]: 	Checking that your have enough memory available to create the index 03/09/2025, 09:09:13
2025-03-09 09:09:13,068 [INFO]: 864.7MB of memory will be needed to build the index (more might be used if you have more)
2025-03-09 09:09:13,068 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0002 secs
2025-03-09 09:09:13,068 [INFO]: 	Selecting most promising index types given data characteristics 03/09/2025, 09:09:13
2025-03-09 09:09:13,068 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-09 09:09:13,068 [INFO]: 	Creating the index 03/09/2025, 09:09:13
2025-03-09 09:09:13,069 [INFO]: 		-> Instanciate the index HNSW15 03/09/2025, 09:09:13
2025-03-09 09:09:13,070 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0018 secs
2025-03-09 09:09:13,071 [INFO]: 		-> Adding the vectors to the index 03/09/2025, 09:09:13
2025-03-09 09:09:13,071 [INFO]: The memory available for adding the vectors is 49.2GB(total available - used by the index)
2025-03-09 09:09:13,071 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/17 [00:00<?, ?it/s] 12%|█▏        | 2/17 [00:00<00:00, 19.92it/s] 47%|████▋     | 8/17 [00:00<00:00, 42.67it/s] 82%|████████▏ | 14/17 [00:00<00:00, 48.84it/s]100%|██████████| 17/17 [00:03<00:00,  5.08it/s]
2025-03-09 09:09:16,422 [INFO]: 	Computing best hyperparameters for index knn.index 03/09/2025, 09:09:16
2025-03-09 09:09:56,215 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 39.7929 secs
2025-03-09 09:09:56,215 [INFO]: The best hyperparameters are: efSearch=233
2025-03-09 09:09:56,215 [INFO]: 	Compute fast metrics 03/09/2025, 09:09:56
  0%|          | 0/4 [00:00<?, ?it/s] 50%|█████     | 2/4 [00:00<00:00, 18.76it/s] 75%|███████▌  | 3/4 [00:00<00:00, 21.76it/s]
2025-03-09 09:10:12,156 [INFO]: 	>>> Finished "Compute fast metrics" in 15.9406 secs
2025-03-09 09:10:12,158 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 59.0874 secs
2025-03-09 09:10:12,158 [INFO]: {
2025-03-09 09:10:12,158 [INFO]: 	index_key: HNSW15
2025-03-09 09:10:12,158 [INFO]: 	index_param: efSearch=233
2025-03-09 09:10:12,158 [INFO]: 	index_path: knn.index
2025-03-09 09:10:12,158 [INFO]: 	size in bytes: 824357350
2025-03-09 09:10:12,158 [INFO]: 	avg_search_speed_ms: 10.064158732937255
2025-03-09 09:10:12,158 [INFO]: 	99p_search_speed_ms: 22.162460379768163
2025-03-09 09:10:12,158 [INFO]: 	reconstruction error %: 0.0
2025-03-09 09:10:12,158 [INFO]: 	nb vectors: 4190
2025-03-09 09:10:12,158 [INFO]: 	vectors dimension: 49152
2025-03-09 09:10:12,158 [INFO]: 	compression ratio: 0.9993087585135257
2025-03-09 09:10:12,158 [INFO]: }
2025-03-09 09:10:12,158 [INFO]: 	>>> Finished "Creating the index" in 59.0899 secs
2025-03-09 09:10:12,158 [INFO]: >>> Finished "Launching the whole pipeline" in 59.1203 secs
2025-03-09 09:10:14: [retrieval_preprocessing] calculating distances ...
2025-03-09 09:10:15: [retrieval_preprocessing] finished and saved retrieval indices for episode 80277 [episode count 11/20]
[retrieval_preprocessing] for episode 27798 [episode count 12/20], we have num_retrieval=np.int64(4415) num_query=np.int64(173)
2025-03-09 09:10:16,267 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-09 09:10:16,841 [INFO]: Launching the whole pipeline 03/09/2025, 09:10:16
2025-03-09 09:10:16,841 [INFO]: Reading total number of vectors and dimension 03/09/2025, 09:10:16
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1837.19it/s]
2025-03-09 09:10:16,872 [INFO]: There are 4415 embeddings of dim 49152
2025-03-09 09:10:16,872 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0314 secs
2025-03-09 09:10:16,872 [INFO]: 	Compute estimated construction time of the index 03/09/2025, 09:10:16
2025-03-09 09:10:16,872 [INFO]: 		-> Train: 16.7 minutes
2025-03-09 09:10:16,872 [INFO]: 		-> Add: 2.4 seconds
2025-03-09 09:10:16,872 [INFO]: 		Total: 16.7 minutes
2025-03-09 09:10:16,872 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0001 secs
2025-03-09 09:10:16,872 [INFO]: 	Checking that your have enough memory available to create the index 03/09/2025, 09:10:16
2025-03-09 09:10:16,872 [INFO]: 911.1MB of memory will be needed to build the index (more might be used if you have more)
2025-03-09 09:10:16,873 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0002 secs
2025-03-09 09:10:16,873 [INFO]: 	Selecting most promising index types given data characteristics 03/09/2025, 09:10:16
2025-03-09 09:10:16,873 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-09 09:10:16,873 [INFO]: 	Creating the index 03/09/2025, 09:10:16
2025-03-09 09:10:16,873 [INFO]: 		-> Instanciate the index HNSW15 03/09/2025, 09:10:16
2025-03-09 09:10:16,874 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0011 secs
2025-03-09 09:10:16,874 [INFO]: 		-> Adding the vectors to the index 03/09/2025, 09:10:16
2025-03-09 09:10:16,874 [INFO]: The memory available for adding the vectors is 49.2GB(total available - used by the index)
2025-03-09 09:10:16,874 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/18 [00:00<?, ?it/s]  6%|▌         | 1/18 [00:00<00:02,  7.83it/s] 22%|██▏       | 4/18 [00:00<00:00, 17.85it/s] 50%|█████     | 9/18 [00:00<00:00, 29.73it/s] 78%|███████▊  | 14/18 [00:00<00:00, 36.17it/s]100%|██████████| 18/18 [00:04<00:00,  2.76it/s]100%|██████████| 18/18 [00:04<00:00,  4.16it/s]
2025-03-09 09:10:21,204 [INFO]: 	Computing best hyperparameters for index knn.index 03/09/2025, 09:10:21
2025-03-09 09:11:02,354 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 41.1501 secs
2025-03-09 09:11:02,355 [INFO]: The best hyperparameters are: efSearch=242
2025-03-09 09:11:02,355 [INFO]: 	Compute fast metrics 03/09/2025, 09:11:02
  0%|          | 0/4 [00:00<?, ?it/s] 50%|█████     | 2/4 [00:00<00:00, 19.33it/s] 75%|███████▌  | 3/4 [00:00<00:00, 21.85it/s]
2025-03-09 09:11:17,682 [INFO]: 	>>> Finished "Compute fast metrics" in 15.3273 secs
2025-03-09 09:11:17,685 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 60.8105 secs
2025-03-09 09:11:17,685 [INFO]: {
2025-03-09 09:11:17,685 [INFO]: 	index_key: HNSW15
2025-03-09 09:11:17,685 [INFO]: 	index_param: efSearch=242
2025-03-09 09:11:17,685 [INFO]: 	index_path: knn.index
2025-03-09 09:11:17,685 [INFO]: 	size in bytes: 868624930
2025-03-09 09:11:17,685 [INFO]: 	avg_search_speed_ms: 10.852525097574562
2025-03-09 09:11:17,685 [INFO]: 	99p_search_speed_ms: 15.698565433267493
2025-03-09 09:11:17,685 [INFO]: 	reconstruction error %: 0.0
2025-03-09 09:11:17,685 [INFO]: 	nb vectors: 4415
2025-03-09 09:11:17,685 [INFO]: 	vectors dimension: 49152
2025-03-09 09:11:17,685 [INFO]: 	compression ratio: 0.999308550814907
2025-03-09 09:11:17,685 [INFO]: }
2025-03-09 09:11:17,685 [INFO]: 	>>> Finished "Creating the index" in 60.8121 secs
2025-03-09 09:11:17,685 [INFO]: >>> Finished "Launching the whole pipeline" in 60.8441 secs
2025-03-09 09:11:18: [retrieval_preprocessing] calculating distances ...
2025-03-09 09:11:19: [retrieval_preprocessing] finished and saved retrieval indices for episode 27798 [episode count 12/20]
[retrieval_preprocessing] for episode 69786 [episode count 13/20], we have num_retrieval=np.int64(4357) num_query=np.int64(231)
2025-03-09 09:11:19,741 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-09 09:11:20,302 [INFO]: Launching the whole pipeline 03/09/2025, 09:11:20
2025-03-09 09:11:20,302 [INFO]: Reading total number of vectors and dimension 03/09/2025, 09:11:20
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 2215.69it/s]
2025-03-09 09:11:20,330 [INFO]: There are 4357 embeddings of dim 49152
2025-03-09 09:11:20,330 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0278 secs
2025-03-09 09:11:20,330 [INFO]: 	Compute estimated construction time of the index 03/09/2025, 09:11:20
2025-03-09 09:11:20,330 [INFO]: 		-> Train: 16.7 minutes
2025-03-09 09:11:20,330 [INFO]: 		-> Add: 2.4 seconds
2025-03-09 09:11:20,330 [INFO]: 		Total: 16.7 minutes
2025-03-09 09:11:20,330 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0001 secs
2025-03-09 09:11:20,330 [INFO]: 	Checking that your have enough memory available to create the index 03/09/2025, 09:11:20
2025-03-09 09:11:20,331 [INFO]: 899.2MB of memory will be needed to build the index (more might be used if you have more)
2025-03-09 09:11:20,331 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0001 secs
2025-03-09 09:11:20,331 [INFO]: 	Selecting most promising index types given data characteristics 03/09/2025, 09:11:20
2025-03-09 09:11:20,331 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-09 09:11:20,331 [INFO]: 	Creating the index 03/09/2025, 09:11:20
2025-03-09 09:11:20,331 [INFO]: 		-> Instanciate the index HNSW15 03/09/2025, 09:11:20
2025-03-09 09:11:20,332 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0009 secs
2025-03-09 09:11:20,332 [INFO]: 		-> Adding the vectors to the index 03/09/2025, 09:11:20
2025-03-09 09:11:20,332 [INFO]: The memory available for adding the vectors is 49.2GB(total available - used by the index)
2025-03-09 09:11:20,332 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/18 [00:00<?, ?it/s]  6%|▌         | 1/18 [00:00<00:02,  7.68it/s] 39%|███▉      | 7/18 [00:00<00:00, 32.47it/s] 72%|███████▏  | 13/18 [00:00<00:00, 41.46it/s]100%|██████████| 18/18 [00:03<00:00,  3.61it/s]100%|██████████| 18/18 [00:03<00:00,  4.95it/s]
2025-03-09 09:11:23,973 [INFO]: 	Computing best hyperparameters for index knn.index 03/09/2025, 09:11:23
2025-03-09 09:12:04,142 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 40.1690 secs
2025-03-09 09:12:04,143 [INFO]: The best hyperparameters are: efSearch=248
2025-03-09 09:12:04,143 [INFO]: 	Compute fast metrics 03/09/2025, 09:12:04
  0%|          | 0/4 [00:00<?, ?it/s] 50%|█████     | 2/4 [00:00<00:00, 19.91it/s] 75%|███████▌  | 3/4 [00:00<00:00, 22.06it/s]
2025-03-09 09:12:22,970 [INFO]: 	>>> Finished "Compute fast metrics" in 18.8276 secs
2025-03-09 09:12:22,973 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 62.6410 secs
2025-03-09 09:12:22,973 [INFO]: {
2025-03-09 09:12:22,973 [INFO]: 	index_key: HNSW15
2025-03-09 09:12:22,973 [INFO]: 	index_param: efSearch=248
2025-03-09 09:12:22,973 [INFO]: 	index_path: knn.index
2025-03-09 09:12:22,973 [INFO]: 	size in bytes: 857213770
2025-03-09 09:12:22,973 [INFO]: 	avg_search_speed_ms: 10.656954281238384
2025-03-09 09:12:22,973 [INFO]: 	99p_search_speed_ms: 13.884089309722185
2025-03-09 09:12:22,973 [INFO]: 	reconstruction error %: 0.0
2025-03-09 09:12:22,973 [INFO]: 	nb vectors: 4357
2025-03-09 09:12:22,973 [INFO]: 	vectors dimension: 49152
2025-03-09 09:12:22,973 [INFO]: 	compression ratio: 0.9993085575375207
2025-03-09 09:12:22,973 [INFO]: }
2025-03-09 09:12:22,973 [INFO]: 	>>> Finished "Creating the index" in 62.6425 secs
2025-03-09 09:12:22,973 [INFO]: >>> Finished "Launching the whole pipeline" in 62.6708 secs
2025-03-09 09:12:24: [retrieval_preprocessing] calculating distances ...
2025-03-09 09:12:25: [retrieval_preprocessing] finished and saved retrieval indices for episode 69786 [episode count 13/20]
[retrieval_preprocessing] for episode 23709 [episode count 14/20], we have num_retrieval=np.int64(4339) num_query=np.int64(249)
2025-03-09 09:12:25,651 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-09 09:12:27,468 [INFO]: Launching the whole pipeline 03/09/2025, 09:12:27
2025-03-09 09:12:27,468 [INFO]: Reading total number of vectors and dimension 03/09/2025, 09:12:27
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1988.76it/s]
2025-03-09 09:12:27,501 [INFO]: There are 4339 embeddings of dim 49152
2025-03-09 09:12:27,501 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0331 secs
2025-03-09 09:12:27,502 [INFO]: 	Compute estimated construction time of the index 03/09/2025, 09:12:27
2025-03-09 09:12:27,502 [INFO]: 		-> Train: 16.7 minutes
2025-03-09 09:12:27,502 [INFO]: 		-> Add: 2.4 seconds
2025-03-09 09:12:27,502 [INFO]: 		Total: 16.7 minutes
2025-03-09 09:12:27,502 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0001 secs
2025-03-09 09:12:27,502 [INFO]: 	Checking that your have enough memory available to create the index 03/09/2025, 09:12:27
2025-03-09 09:12:27,502 [INFO]: 895.5MB of memory will be needed to build the index (more might be used if you have more)
2025-03-09 09:12:27,502 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0002 secs
2025-03-09 09:12:27,502 [INFO]: 	Selecting most promising index types given data characteristics 03/09/2025, 09:12:27
2025-03-09 09:12:27,502 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-09 09:12:27,502 [INFO]: 	Creating the index 03/09/2025, 09:12:27
2025-03-09 09:12:27,502 [INFO]: 		-> Instanciate the index HNSW15 03/09/2025, 09:12:27
2025-03-09 09:12:27,503 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0010 secs
2025-03-09 09:12:27,503 [INFO]: 		-> Adding the vectors to the index 03/09/2025, 09:12:27
2025-03-09 09:12:27,503 [INFO]: The memory available for adding the vectors is 49.2GB(total available - used by the index)
2025-03-09 09:12:27,503 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/18 [00:00<?, ?it/s]  6%|▌         | 1/18 [00:00<00:01,  9.04it/s] 33%|███▎      | 6/18 [00:00<00:00, 31.59it/s] 61%|██████    | 11/18 [00:00<00:00, 39.54it/s] 89%|████████▉ | 16/18 [00:00<00:00, 41.91it/s]100%|██████████| 18/18 [00:03<00:00,  4.68it/s]
2025-03-09 09:12:31,350 [INFO]: 	Computing best hyperparameters for index knn.index 03/09/2025, 09:12:31
2025-03-09 09:13:13,824 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 42.4737 secs
2025-03-09 09:13:13,824 [INFO]: The best hyperparameters are: efSearch=220
2025-03-09 09:13:13,825 [INFO]: 	Compute fast metrics 03/09/2025, 09:13:13
  0%|          | 0/4 [00:00<?, ?it/s] 75%|███████▌  | 3/4 [00:00<00:00, 26.75it/s] 75%|███████▌  | 3/4 [00:00<00:00, 22.79it/s]
2025-03-09 09:13:28,865 [INFO]: 	>>> Finished "Compute fast metrics" in 15.0402 secs
2025-03-09 09:13:28,867 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 61.3638 secs
2025-03-09 09:13:28,867 [INFO]: {
2025-03-09 09:13:28,867 [INFO]: 	index_key: HNSW15
2025-03-09 09:13:28,867 [INFO]: 	index_param: efSearch=220
2025-03-09 09:13:28,867 [INFO]: 	index_path: knn.index
2025-03-09 09:13:28,867 [INFO]: 	size in bytes: 853672330
2025-03-09 09:13:28,867 [INFO]: 	avg_search_speed_ms: 10.143852881231473
2025-03-09 09:13:28,868 [INFO]: 	99p_search_speed_ms: 22.885935532394786
2025-03-09 09:13:28,868 [INFO]: 	reconstruction error %: 0.0
2025-03-09 09:13:28,868 [INFO]: 	nb vectors: 4339
2025-03-09 09:13:28,868 [INFO]: 	vectors dimension: 49152
2025-03-09 09:13:28,868 [INFO]: 	compression ratio: 0.9993086129428607
2025-03-09 09:13:28,868 [INFO]: }
2025-03-09 09:13:28,868 [INFO]: 	>>> Finished "Creating the index" in 61.3655 secs
2025-03-09 09:13:28,868 [INFO]: >>> Finished "Launching the whole pipeline" in 61.3993 secs
2025-03-09 09:13:29: [retrieval_preprocessing] calculating distances ...
2025-03-09 09:13:30: [retrieval_preprocessing] finished and saved retrieval indices for episode 23709 [episode count 14/20]
[retrieval_preprocessing] for episode 13981 [episode count 15/20], we have num_retrieval=np.int64(4396) num_query=np.int64(192)
2025-03-09 09:13:30,967 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-09 09:13:31,524 [INFO]: Launching the whole pipeline 03/09/2025, 09:13:31
2025-03-09 09:13:31,525 [INFO]: Reading total number of vectors and dimension 03/09/2025, 09:13:31
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1685.14it/s]
2025-03-09 09:13:31,555 [INFO]: There are 4396 embeddings of dim 49152
2025-03-09 09:13:31,555 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0306 secs
2025-03-09 09:13:31,555 [INFO]: 	Compute estimated construction time of the index 03/09/2025, 09:13:31
2025-03-09 09:13:31,556 [INFO]: 		-> Train: 16.7 minutes
2025-03-09 09:13:31,556 [INFO]: 		-> Add: 2.4 seconds
2025-03-09 09:13:31,556 [INFO]: 		Total: 16.7 minutes
2025-03-09 09:13:31,556 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0003 secs
2025-03-09 09:13:31,556 [INFO]: 	Checking that your have enough memory available to create the index 03/09/2025, 09:13:31
2025-03-09 09:13:31,556 [INFO]: 907.2MB of memory will be needed to build the index (more might be used if you have more)
2025-03-09 09:13:31,556 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0004 secs
2025-03-09 09:13:31,557 [INFO]: 	Selecting most promising index types given data characteristics 03/09/2025, 09:13:31
2025-03-09 09:13:31,557 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-09 09:13:31,557 [INFO]: 	Creating the index 03/09/2025, 09:13:31
2025-03-09 09:13:31,557 [INFO]: 		-> Instanciate the index HNSW15 03/09/2025, 09:13:31
2025-03-09 09:13:31,560 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0026 secs
2025-03-09 09:13:31,560 [INFO]: 		-> Adding the vectors to the index 03/09/2025, 09:13:31
2025-03-09 09:13:31,560 [INFO]: The memory available for adding the vectors is 49.2GB(total available - used by the index)
2025-03-09 09:13:31,560 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/18 [00:00<?, ?it/s] 11%|█         | 2/18 [00:00<00:01, 15.72it/s] 39%|███▉      | 7/18 [00:00<00:00, 33.20it/s] 72%|███████▏  | 13/18 [00:00<00:00, 41.39it/s]100%|██████████| 18/18 [00:03<00:00,  3.58it/s]100%|██████████| 18/18 [00:03<00:00,  4.98it/s]
2025-03-09 09:13:35,183 [INFO]: 	Computing best hyperparameters for index knn.index 03/09/2025, 09:13:35
2025-03-09 09:14:14,902 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 39.7182 secs
2025-03-09 09:14:14,902 [INFO]: The best hyperparameters are: efSearch=193
2025-03-09 09:14:14,902 [INFO]: 	Compute fast metrics 03/09/2025, 09:14:14
  0%|          | 0/4 [00:00<?, ?it/s] 25%|██▌       | 1/4 [00:00<00:00,  8.51it/s] 75%|███████▌  | 3/4 [00:00<00:00, 17.01it/s]
2025-03-09 09:14:31,512 [INFO]: 	>>> Finished "Compute fast metrics" in 16.6095 secs
2025-03-09 09:14:32,255 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 60.6947 secs
2025-03-09 09:14:32,255 [INFO]: {
2025-03-09 09:14:32,255 [INFO]: 	index_key: HNSW15
2025-03-09 09:14:32,255 [INFO]: 	index_param: efSearch=193
2025-03-09 09:14:32,255 [INFO]: 	index_path: knn.index
2025-03-09 09:14:32,255 [INFO]: 	size in bytes: 864886690
2025-03-09 09:14:32,255 [INFO]: 	avg_search_speed_ms: 10.051780592334124
2025-03-09 09:14:32,255 [INFO]: 	99p_search_speed_ms: 25.070485193282366
2025-03-09 09:14:32,255 [INFO]: 	reconstruction error %: 0.0
2025-03-09 09:14:32,255 [INFO]: 	nb vectors: 4396
2025-03-09 09:14:32,255 [INFO]: 	vectors dimension: 49152
2025-03-09 09:14:32,256 [INFO]: 	compression ratio: 0.9993086701334252
2025-03-09 09:14:32,256 [INFO]: }
2025-03-09 09:14:32,256 [INFO]: 	>>> Finished "Creating the index" in 60.6988 secs
2025-03-09 09:14:32,256 [INFO]: >>> Finished "Launching the whole pipeline" in 60.7311 secs
2025-03-09 09:14:33: [retrieval_preprocessing] calculating distances ...
2025-03-09 09:14:33: [retrieval_preprocessing] finished and saved retrieval indices for episode 13981 [episode count 15/20]
[retrieval_preprocessing] for episode 66974 [episode count 16/20], we have num_retrieval=np.int64(4301) num_query=np.int64(287)
2025-03-09 09:14:33,800 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-09 09:14:34,318 [INFO]: Launching the whole pipeline 03/09/2025, 09:14:34
2025-03-09 09:14:34,318 [INFO]: Reading total number of vectors and dimension 03/09/2025, 09:14:34
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1550.00it/s]
2025-03-09 09:14:34,346 [INFO]: There are 4301 embeddings of dim 49152
2025-03-09 09:14:34,347 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0285 secs
2025-03-09 09:14:34,347 [INFO]: 	Compute estimated construction time of the index 03/09/2025, 09:14:34
2025-03-09 09:14:34,347 [INFO]: 		-> Train: 16.7 minutes
2025-03-09 09:14:34,347 [INFO]: 		-> Add: 2.4 seconds
2025-03-09 09:14:34,347 [INFO]: 		Total: 16.7 minutes
2025-03-09 09:14:34,347 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0003 secs
2025-03-09 09:14:34,348 [INFO]: 	Checking that your have enough memory available to create the index 03/09/2025, 09:14:34
2025-03-09 09:14:34,348 [INFO]: 887.6MB of memory will be needed to build the index (more might be used if you have more)
2025-03-09 09:14:34,348 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0003 secs
2025-03-09 09:14:34,348 [INFO]: 	Selecting most promising index types given data characteristics 03/09/2025, 09:14:34
2025-03-09 09:14:34,348 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-09 09:14:34,348 [INFO]: 	Creating the index 03/09/2025, 09:14:34
2025-03-09 09:14:34,348 [INFO]: 		-> Instanciate the index HNSW15 03/09/2025, 09:14:34
2025-03-09 09:14:34,351 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0026 secs
2025-03-09 09:14:34,351 [INFO]: 		-> Adding the vectors to the index 03/09/2025, 09:14:34
2025-03-09 09:14:34,351 [INFO]: The memory available for adding the vectors is 49.2GB(total available - used by the index)
2025-03-09 09:14:34,352 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/17 [00:00<?, ?it/s] 18%|█▊        | 3/17 [00:00<00:00, 28.58it/s] 59%|█████▉    | 10/17 [00:00<00:00, 51.10it/s]100%|██████████| 17/17 [00:02<00:00,  4.90it/s]100%|██████████| 17/17 [00:02<00:00,  6.04it/s]
2025-03-09 09:14:37,170 [INFO]: 	Computing best hyperparameters for index knn.index 03/09/2025, 09:14:37
2025-03-09 09:15:20,161 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 42.9902 secs
2025-03-09 09:15:20,161 [INFO]: The best hyperparameters are: efSearch=225
2025-03-09 09:15:20,161 [INFO]: 	Compute fast metrics 03/09/2025, 09:15:20
  0%|          | 0/4 [00:00<?, ?it/s] 75%|███████▌  | 3/4 [00:00<00:00, 25.64it/s] 75%|███████▌  | 3/4 [00:00<00:00, 22.04it/s]
2025-03-09 09:15:42,719 [INFO]: 	>>> Finished "Compute fast metrics" in 22.5576 secs
2025-03-09 09:15:42,721 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 68.3700 secs
2025-03-09 09:15:42,722 [INFO]: {
2025-03-09 09:15:42,722 [INFO]: 	index_key: HNSW15
2025-03-09 09:15:42,722 [INFO]: 	index_param: efSearch=225
2025-03-09 09:15:42,722 [INFO]: 	index_path: knn.index
2025-03-09 09:15:42,722 [INFO]: 	size in bytes: 846196090
2025-03-09 09:15:42,722 [INFO]: 	avg_search_speed_ms: 10.791652901208645
2025-03-09 09:15:42,722 [INFO]: 	99p_search_speed_ms: 20.461923759430647
2025-03-09 09:15:42,722 [INFO]: 	reconstruction error %: 0.0
2025-03-09 09:15:42,722 [INFO]: 	nb vectors: 4301
2025-03-09 09:15:42,722 [INFO]: 	vectors dimension: 49152
2025-03-09 09:15:42,722 [INFO]: 	compression ratio: 0.9993085739736756
2025-03-09 09:15:42,722 [INFO]: }
2025-03-09 09:15:42,722 [INFO]: 	>>> Finished "Creating the index" in 68.3734 secs
2025-03-09 09:15:42,722 [INFO]: >>> Finished "Launching the whole pipeline" in 68.4035 secs
2025-03-09 09:15:43: [retrieval_preprocessing] calculating distances ...
2025-03-09 09:15:44: [retrieval_preprocessing] finished and saved retrieval indices for episode 66974 [episode count 16/20]
[retrieval_preprocessing] for episode 80287 [episode count 17/20], we have num_retrieval=np.int64(4393) num_query=np.int64(195)
2025-03-09 09:15:45,164 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-09 09:15:45,736 [INFO]: Launching the whole pipeline 03/09/2025, 09:15:45
2025-03-09 09:15:45,736 [INFO]: Reading total number of vectors and dimension 03/09/2025, 09:15:45
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1475.83it/s]
2025-03-09 09:15:45,766 [INFO]: There are 4393 embeddings of dim 49152
2025-03-09 09:15:45,766 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0301 secs
2025-03-09 09:15:45,767 [INFO]: 	Compute estimated construction time of the index 03/09/2025, 09:15:45
2025-03-09 09:15:45,767 [INFO]: 		-> Train: 16.7 minutes
2025-03-09 09:15:45,767 [INFO]: 		-> Add: 2.4 seconds
2025-03-09 09:15:45,767 [INFO]: 		Total: 16.7 minutes
2025-03-09 09:15:45,767 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0004 secs
2025-03-09 09:15:45,767 [INFO]: 	Checking that your have enough memory available to create the index 03/09/2025, 09:15:45
2025-03-09 09:15:45,767 [INFO]: 906.6MB of memory will be needed to build the index (more might be used if you have more)
2025-03-09 09:15:45,768 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0004 secs
2025-03-09 09:15:45,768 [INFO]: 	Selecting most promising index types given data characteristics 03/09/2025, 09:15:45
2025-03-09 09:15:45,768 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-09 09:15:45,768 [INFO]: 	Creating the index 03/09/2025, 09:15:45
2025-03-09 09:15:45,768 [INFO]: 		-> Instanciate the index HNSW15 03/09/2025, 09:15:45
2025-03-09 09:15:45,771 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0027 secs
2025-03-09 09:15:45,771 [INFO]: 		-> Adding the vectors to the index 03/09/2025, 09:15:45
2025-03-09 09:15:45,771 [INFO]: The memory available for adding the vectors is 49.2GB(total available - used by the index)
2025-03-09 09:15:45,772 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/18 [00:00<?, ?it/s]  6%|▌         | 1/18 [00:00<00:01,  9.59it/s] 39%|███▉      | 7/18 [00:00<00:00, 38.55it/s] 78%|███████▊  | 14/18 [00:00<00:00, 49.59it/s]100%|██████████| 18/18 [00:03<00:00,  5.03it/s]
2025-03-09 09:15:49,358 [INFO]: 	Computing best hyperparameters for index knn.index 03/09/2025, 09:15:49
2025-03-09 09:16:27,240 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 37.8820 secs
2025-03-09 09:16:27,241 [INFO]: The best hyperparameters are: efSearch=218
2025-03-09 09:16:27,241 [INFO]: 	Compute fast metrics 03/09/2025, 09:16:27
  0%|          | 0/4 [00:00<?, ?it/s] 50%|█████     | 2/4 [00:00<00:00, 15.29it/s] 75%|███████▌  | 3/4 [00:00<00:00, 14.57it/s]
2025-03-09 09:16:44,345 [INFO]: 	>>> Finished "Compute fast metrics" in 17.1048 secs
2025-03-09 09:16:44,348 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 58.5765 secs
2025-03-09 09:16:44,348 [INFO]: {
2025-03-09 09:16:44,348 [INFO]: 	index_key: HNSW15
2025-03-09 09:16:44,348 [INFO]: 	index_param: efSearch=218
2025-03-09 09:16:44,348 [INFO]: 	index_path: knn.index
2025-03-09 09:16:44,348 [INFO]: 	size in bytes: 864296470
2025-03-09 09:16:44,348 [INFO]: 	avg_search_speed_ms: 10.87411082597733
2025-03-09 09:16:44,348 [INFO]: 	99p_search_speed_ms: 23.879183039534787
2025-03-09 09:16:44,348 [INFO]: 	reconstruction error %: 0.0
2025-03-09 09:16:44,348 [INFO]: 	nb vectors: 4393
2025-03-09 09:16:44,348 [INFO]: 	vectors dimension: 49152
2025-03-09 09:16:44,348 [INFO]: 	compression ratio: 0.9993086562068222
2025-03-09 09:16:44,348 [INFO]: }
2025-03-09 09:16:44,348 [INFO]: 	>>> Finished "Creating the index" in 58.5802 secs
2025-03-09 09:16:44,348 [INFO]: >>> Finished "Launching the whole pipeline" in 58.6121 secs
2025-03-09 09:16:45: [retrieval_preprocessing] calculating distances ...
2025-03-09 09:16:45: [retrieval_preprocessing] finished and saved retrieval indices for episode 80287 [episode count 17/20]
[retrieval_preprocessing] for episode 67745 [episode count 18/20], we have num_retrieval=np.int64(4282) num_query=np.int64(306)
2025-03-09 09:16:46,233 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-09 09:16:46,782 [INFO]: Launching the whole pipeline 03/09/2025, 09:16:46
2025-03-09 09:16:46,782 [INFO]: Reading total number of vectors and dimension 03/09/2025, 09:16:46
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1759.36it/s]
2025-03-09 09:16:46,809 [INFO]: There are 4282 embeddings of dim 49152
2025-03-09 09:16:46,810 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0278 secs
2025-03-09 09:16:46,810 [INFO]: 	Compute estimated construction time of the index 03/09/2025, 09:16:46
2025-03-09 09:16:46,810 [INFO]: 		-> Train: 16.7 minutes
2025-03-09 09:16:46,810 [INFO]: 		-> Add: 2.4 seconds
2025-03-09 09:16:46,810 [INFO]: 		Total: 16.7 minutes
2025-03-09 09:16:46,810 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0001 secs
2025-03-09 09:16:46,810 [INFO]: 	Checking that your have enough memory available to create the index 03/09/2025, 09:16:46
2025-03-09 09:16:46,810 [INFO]: 883.7MB of memory will be needed to build the index (more might be used if you have more)
2025-03-09 09:16:46,811 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0001 secs
2025-03-09 09:16:46,811 [INFO]: 	Selecting most promising index types given data characteristics 03/09/2025, 09:16:46
2025-03-09 09:16:46,811 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-09 09:16:46,811 [INFO]: 	Creating the index 03/09/2025, 09:16:46
2025-03-09 09:16:46,811 [INFO]: 		-> Instanciate the index HNSW15 03/09/2025, 09:16:46
2025-03-09 09:16:46,812 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0009 secs
2025-03-09 09:16:46,812 [INFO]: 		-> Adding the vectors to the index 03/09/2025, 09:16:46
2025-03-09 09:16:46,812 [INFO]: The memory available for adding the vectors is 49.2GB(total available - used by the index)
2025-03-09 09:16:46,812 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/17 [00:00<?, ?it/s]  6%|▌         | 1/17 [00:00<00:01,  8.81it/s] 35%|███▌      | 6/17 [00:00<00:00, 26.77it/s] 71%|███████   | 12/17 [00:00<00:00, 37.69it/s]100%|██████████| 17/17 [00:03<00:00,  3.64it/s]100%|██████████| 17/17 [00:03<00:00,  4.89it/s]
2025-03-09 09:16:50,288 [INFO]: 	Computing best hyperparameters for index knn.index 03/09/2025, 09:16:50
2025-03-09 09:17:30,650 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 40.3617 secs
2025-03-09 09:17:30,651 [INFO]: The best hyperparameters are: efSearch=221
2025-03-09 09:17:30,651 [INFO]: 	Compute fast metrics 03/09/2025, 09:17:30
  0%|          | 0/4 [00:00<?, ?it/s] 75%|███████▌  | 3/4 [00:00<00:00, 26.59it/s] 75%|███████▌  | 3/4 [00:00<00:00, 22.71it/s]
2025-03-09 09:17:46,292 [INFO]: 	>>> Finished "Compute fast metrics" in 15.6411 secs
2025-03-09 09:17:46,294 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 59.4822 secs
2025-03-09 09:17:46,294 [INFO]: {
2025-03-09 09:17:46,294 [INFO]: 	index_key: HNSW15
2025-03-09 09:17:46,294 [INFO]: 	index_param: efSearch=221
2025-03-09 09:17:46,294 [INFO]: 	index_path: knn.index
2025-03-09 09:17:46,295 [INFO]: 	size in bytes: 842457850
2025-03-09 09:17:46,295 [INFO]: 	avg_search_speed_ms: 10.751256740011115
2025-03-09 09:17:46,295 [INFO]: 	99p_search_speed_ms: 19.993798544164775
2025-03-09 09:17:46,295 [INFO]: 	reconstruction error %: 0.0
2025-03-09 09:17:46,295 [INFO]: 	nb vectors: 4282
2025-03-09 09:17:46,295 [INFO]: 	vectors dimension: 49152
2025-03-09 09:17:46,295 [INFO]: 	compression ratio: 0.9993086965715852
2025-03-09 09:17:46,295 [INFO]: }
2025-03-09 09:17:46,295 [INFO]: 	>>> Finished "Creating the index" in 59.4840 secs
2025-03-09 09:17:46,295 [INFO]: >>> Finished "Launching the whole pipeline" in 59.5128 secs
2025-03-09 09:17:47: [retrieval_preprocessing] calculating distances ...
2025-03-09 09:17:48: [retrieval_preprocessing] finished and saved retrieval indices for episode 67745 [episode count 18/20]
[retrieval_preprocessing] for episode 27043 [episode count 19/20], we have num_retrieval=np.int64(4387) num_query=np.int64(201)
2025-03-09 09:17:48,762 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-09 09:17:49,351 [INFO]: Launching the whole pipeline 03/09/2025, 09:17:49
2025-03-09 09:17:49,351 [INFO]: Reading total number of vectors and dimension 03/09/2025, 09:17:49
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1744.72it/s]
2025-03-09 09:17:49,382 [INFO]: There are 4387 embeddings of dim 49152
2025-03-09 09:17:49,382 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0307 secs
2025-03-09 09:17:49,382 [INFO]: 	Compute estimated construction time of the index 03/09/2025, 09:17:49
2025-03-09 09:17:49,382 [INFO]: 		-> Train: 16.7 minutes
2025-03-09 09:17:49,383 [INFO]: 		-> Add: 2.4 seconds
2025-03-09 09:17:49,383 [INFO]: 		Total: 16.7 minutes
2025-03-09 09:17:49,383 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0004 secs
2025-03-09 09:17:49,383 [INFO]: 	Checking that your have enough memory available to create the index 03/09/2025, 09:17:49
2025-03-09 09:17:49,383 [INFO]: 905.4MB of memory will be needed to build the index (more might be used if you have more)
2025-03-09 09:17:49,383 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0005 secs
2025-03-09 09:17:49,384 [INFO]: 	Selecting most promising index types given data characteristics 03/09/2025, 09:17:49
2025-03-09 09:17:49,384 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-09 09:17:49,384 [INFO]: 	Creating the index 03/09/2025, 09:17:49
2025-03-09 09:17:49,384 [INFO]: 		-> Instanciate the index HNSW15 03/09/2025, 09:17:49
2025-03-09 09:17:49,387 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0026 secs
2025-03-09 09:17:49,387 [INFO]: 		-> Adding the vectors to the index 03/09/2025, 09:17:49
2025-03-09 09:17:49,387 [INFO]: The memory available for adding the vectors is 49.2GB(total available - used by the index)
2025-03-09 09:17:49,387 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/18 [00:00<?, ?it/s]  6%|▌         | 1/18 [00:00<00:02,  8.04it/s] 33%|███▎      | 6/18 [00:00<00:00, 29.21it/s] 61%|██████    | 11/18 [00:00<00:00, 36.29it/s] 89%|████████▉ | 16/18 [00:00<00:00, 40.90it/s]100%|██████████| 18/18 [00:03<00:00,  4.85it/s]
2025-03-09 09:17:53,104 [INFO]: 	Computing best hyperparameters for index knn.index 03/09/2025, 09:17:53
2025-03-09 09:18:34,961 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 41.8564 secs
2025-03-09 09:18:34,961 [INFO]: The best hyperparameters are: efSearch=234
2025-03-09 09:18:34,961 [INFO]: 	Compute fast metrics 03/09/2025, 09:18:34
  0%|          | 0/4 [00:00<?, ?it/s] 50%|█████     | 2/4 [00:00<00:00, 17.21it/s] 75%|███████▌  | 3/4 [00:00<00:00, 18.40it/s]
2025-03-09 09:18:52,474 [INFO]: 	>>> Finished "Compute fast metrics" in 17.5128 secs
2025-03-09 09:18:52,477 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 63.0898 secs
2025-03-09 09:18:52,477 [INFO]: {
2025-03-09 09:18:52,477 [INFO]: 	index_key: HNSW15
2025-03-09 09:18:52,477 [INFO]: 	index_param: efSearch=234
2025-03-09 09:18:52,477 [INFO]: 	index_path: knn.index
2025-03-09 09:18:52,477 [INFO]: 	size in bytes: 863116030
2025-03-09 09:18:52,477 [INFO]: 	avg_search_speed_ms: 12.045446240219725
2025-03-09 09:18:52,477 [INFO]: 	99p_search_speed_ms: 24.336826743092395
2025-03-09 09:18:52,477 [INFO]: 	reconstruction error %: 0.0
2025-03-09 09:18:52,477 [INFO]: 	nb vectors: 4387
2025-03-09 09:18:52,477 [INFO]: 	vectors dimension: 49152
2025-03-09 09:18:52,477 [INFO]: 	compression ratio: 0.9993086282964759
2025-03-09 09:18:52,477 [INFO]: }
2025-03-09 09:18:52,477 [INFO]: 	>>> Finished "Creating the index" in 63.0935 secs
2025-03-09 09:18:52,477 [INFO]: >>> Finished "Launching the whole pipeline" in 63.1260 secs
2025-03-09 09:18:53: [retrieval_preprocessing] calculating distances ...
2025-03-09 09:18:54: [retrieval_preprocessing] finished and saved retrieval indices for episode 27043 [episode count 19/20]
2025-03-09 09:18:54: [retrieval_preprocessing] finished for (9965421062, 'bottle') [chosen_id count 7/10]
2025-03-09 09:18:56: [retrieval_preprocessing] concatenated all embeddings and indices for 20 episodes for (6357288647, 'lid') [chosen_id count 8/10]
2025-03-09 09:18:56: [retrieval_preprocessing] we have num_total=4254 embedding_dim=49152
[retrieval_preprocessing] for episode 21890 [episode count 0/20], we have num_retrieval=np.int64(4035) num_query=np.int64(219)
2025-03-09 09:18:56,795 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-09 09:18:57,347 [INFO]: Launching the whole pipeline 03/09/2025, 09:18:57
2025-03-09 09:18:57,347 [INFO]: Reading total number of vectors and dimension 03/09/2025, 09:18:57
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 2198.27it/s]
2025-03-09 09:18:57,378 [INFO]: There are 4035 embeddings of dim 49152
2025-03-09 09:18:57,379 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0314 secs
2025-03-09 09:18:57,379 [INFO]: 	Compute estimated construction time of the index 03/09/2025, 09:18:57
2025-03-09 09:18:57,379 [INFO]: 		-> Train: 16.7 minutes
2025-03-09 09:18:57,379 [INFO]: 		-> Add: 2.2 seconds
2025-03-09 09:18:57,379 [INFO]: 		Total: 16.7 minutes
2025-03-09 09:18:57,379 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0004 secs
2025-03-09 09:18:57,380 [INFO]: 	Checking that your have enough memory available to create the index 03/09/2025, 09:18:57
2025-03-09 09:18:57,380 [INFO]: 832.7MB of memory will be needed to build the index (more might be used if you have more)
2025-03-09 09:18:57,380 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0004 secs
2025-03-09 09:18:57,380 [INFO]: 	Selecting most promising index types given data characteristics 03/09/2025, 09:18:57
2025-03-09 09:18:57,380 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-09 09:18:57,380 [INFO]: 	Creating the index 03/09/2025, 09:18:57
2025-03-09 09:18:57,380 [INFO]: 		-> Instanciate the index HNSW15 03/09/2025, 09:18:57
2025-03-09 09:18:57,383 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0026 secs
2025-03-09 09:18:57,383 [INFO]: 		-> Adding the vectors to the index 03/09/2025, 09:18:57
2025-03-09 09:18:57,384 [INFO]: The memory available for adding the vectors is 49.3GB(total available - used by the index)
2025-03-09 09:18:57,384 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/16 [00:00<?, ?it/s] 12%|█▎        | 2/16 [00:00<00:00, 18.06it/s] 50%|█████     | 8/16 [00:00<00:00, 40.61it/s] 88%|████████▊ | 14/16 [00:00<00:00, 48.04it/s]100%|██████████| 16/16 [00:02<00:00,  5.35it/s]
2025-03-09 09:19:00,380 [INFO]: 	Computing best hyperparameters for index knn.index 03/09/2025, 09:19:00
2025-03-09 09:19:37,459 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 37.0789 secs
2025-03-09 09:19:37,460 [INFO]: The best hyperparameters are: efSearch=339
2025-03-09 09:19:37,460 [INFO]: 	Compute fast metrics 03/09/2025, 09:19:37
  0%|          | 0/4 [00:00<?, ?it/s] 50%|█████     | 2/4 [00:00<00:00, 19.85it/s] 75%|███████▌  | 3/4 [00:00<00:00, 21.50it/s]
2025-03-09 09:19:52,845 [INFO]: 	>>> Finished "Compute fast metrics" in 15.3856 secs
2025-03-09 09:19:52,848 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 55.4642 secs
2025-03-09 09:19:52,848 [INFO]: {
2025-03-09 09:19:52,848 [INFO]: 	index_key: HNSW15
2025-03-09 09:19:52,848 [INFO]: 	index_param: efSearch=339
2025-03-09 09:19:52,848 [INFO]: 	index_path: knn.index
2025-03-09 09:19:52,848 [INFO]: 	size in bytes: 793862170
2025-03-09 09:19:52,848 [INFO]: 	avg_search_speed_ms: 11.337657547513627
2025-03-09 09:19:52,848 [INFO]: 	99p_search_speed_ms: 21.487060934305187
2025-03-09 09:19:52,848 [INFO]: 	reconstruction error %: 0.0
2025-03-09 09:19:52,848 [INFO]: 	nb vectors: 4035
2025-03-09 09:19:52,848 [INFO]: 	vectors dimension: 49152
2025-03-09 09:19:52,848 [INFO]: 	compression ratio: 0.9993085827480607
2025-03-09 09:19:52,848 [INFO]: }
2025-03-09 09:19:52,848 [INFO]: 	>>> Finished "Creating the index" in 55.4675 secs
2025-03-09 09:19:52,848 [INFO]: >>> Finished "Launching the whole pipeline" in 55.5008 secs
2025-03-09 09:19:54: [retrieval_preprocessing] calculating distances ...
2025-03-09 09:19:55: [retrieval_preprocessing] finished and saved retrieval indices for episode 21890 [episode count 0/20]
[retrieval_preprocessing] for episode 5763 [episode count 1/20], we have num_retrieval=np.int64(4065) num_query=np.int64(189)
2025-03-09 09:19:55,885 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-09 09:19:56,511 [INFO]: Launching the whole pipeline 03/09/2025, 09:19:56
2025-03-09 09:19:56,511 [INFO]: Reading total number of vectors and dimension 03/09/2025, 09:19:56
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1891.03it/s]
2025-03-09 09:19:56,549 [INFO]: There are 4065 embeddings of dim 49152
2025-03-09 09:19:56,549 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0380 secs
2025-03-09 09:19:56,549 [INFO]: 	Compute estimated construction time of the index 03/09/2025, 09:19:56
2025-03-09 09:19:56,549 [INFO]: 		-> Train: 16.7 minutes
2025-03-09 09:19:56,550 [INFO]: 		-> Add: 2.2 seconds
2025-03-09 09:19:56,550 [INFO]: 		Total: 16.7 minutes
2025-03-09 09:19:56,550 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0003 secs
2025-03-09 09:19:56,550 [INFO]: 	Checking that your have enough memory available to create the index 03/09/2025, 09:19:56
2025-03-09 09:19:56,550 [INFO]: 838.9MB of memory will be needed to build the index (more might be used if you have more)
2025-03-09 09:19:56,550 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0003 secs
2025-03-09 09:19:56,550 [INFO]: 	Selecting most promising index types given data characteristics 03/09/2025, 09:19:56
2025-03-09 09:19:56,550 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-09 09:19:56,550 [INFO]: 	Creating the index 03/09/2025, 09:19:56
2025-03-09 09:19:56,550 [INFO]: 		-> Instanciate the index HNSW15 03/09/2025, 09:19:56
2025-03-09 09:19:56,552 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0019 secs
2025-03-09 09:19:56,553 [INFO]: 		-> Adding the vectors to the index 03/09/2025, 09:19:56
2025-03-09 09:19:56,553 [INFO]: The memory available for adding the vectors is 49.3GB(total available - used by the index)
2025-03-09 09:19:56,553 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/17 [00:00<?, ?it/s]  6%|▌         | 1/17 [00:00<00:01,  8.44it/s] 41%|████      | 7/17 [00:00<00:00, 35.88it/s] 76%|███████▋  | 13/17 [00:00<00:00, 44.64it/s]100%|██████████| 17/17 [00:03<00:00,  5.23it/s]
2025-03-09 09:19:59,805 [INFO]: 	Computing best hyperparameters for index knn.index 03/09/2025, 09:19:59
2025-03-09 09:20:35,712 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 35.9074 secs
2025-03-09 09:20:35,712 [INFO]: The best hyperparameters are: efSearch=283
2025-03-09 09:20:35,713 [INFO]: 	Compute fast metrics 03/09/2025, 09:20:35
  0%|          | 0/4 [00:00<?, ?it/s] 25%|██▌       | 1/4 [00:00<00:00,  9.68it/s] 75%|███████▌  | 3/4 [00:00<00:00, 18.56it/s]
2025-03-09 09:20:51,043 [INFO]: 	>>> Finished "Compute fast metrics" in 15.3297 secs
2025-03-09 09:20:51,045 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 54.4919 secs
2025-03-09 09:20:51,045 [INFO]: {
2025-03-09 09:20:51,045 [INFO]: 	index_key: HNSW15
2025-03-09 09:20:51,045 [INFO]: 	index_param: efSearch=283
2025-03-09 09:20:51,045 [INFO]: 	index_path: knn.index
2025-03-09 09:20:51,045 [INFO]: 	size in bytes: 799764430
2025-03-09 09:20:51,045 [INFO]: 	avg_search_speed_ms: 9.104825707967711
2025-03-09 09:20:51,045 [INFO]: 	99p_search_speed_ms: 16.15987204015255
2025-03-09 09:20:51,045 [INFO]: 	reconstruction error %: 0.0
2025-03-09 09:20:51,045 [INFO]: 	nb vectors: 4065
2025-03-09 09:20:51,045 [INFO]: 	vectors dimension: 49152
2025-03-09 09:20:51,045 [INFO]: 	compression ratio: 0.999308658925979
2025-03-09 09:20:51,045 [INFO]: }
2025-03-09 09:20:51,045 [INFO]: 	>>> Finished "Creating the index" in 54.4946 secs
2025-03-09 09:20:51,045 [INFO]: >>> Finished "Launching the whole pipeline" in 54.5339 secs
2025-03-09 09:20:52: [retrieval_preprocessing] calculating distances ...
2025-03-09 09:20:52: [retrieval_preprocessing] finished and saved retrieval indices for episode 5763 [episode count 1/20]
[retrieval_preprocessing] for episode 57731 [episode count 2/20], we have num_retrieval=np.int64(4073) num_query=np.int64(181)
2025-03-09 09:20:53,205 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-09 09:20:53,767 [INFO]: Launching the whole pipeline 03/09/2025, 09:20:53
2025-03-09 09:20:53,767 [INFO]: Reading total number of vectors and dimension 03/09/2025, 09:20:53
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 877.10it/s]
2025-03-09 09:20:53,803 [INFO]: There are 4073 embeddings of dim 49152
2025-03-09 09:20:53,804 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0364 secs
2025-03-09 09:20:53,804 [INFO]: 	Compute estimated construction time of the index 03/09/2025, 09:20:53
2025-03-09 09:20:53,804 [INFO]: 		-> Train: 16.7 minutes
2025-03-09 09:20:53,804 [INFO]: 		-> Add: 2.2 seconds
2025-03-09 09:20:53,804 [INFO]: 		Total: 16.7 minutes
2025-03-09 09:20:53,804 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0003 secs
2025-03-09 09:20:53,804 [INFO]: 	Checking that your have enough memory available to create the index 03/09/2025, 09:20:53
2025-03-09 09:20:53,805 [INFO]: 840.6MB of memory will be needed to build the index (more might be used if you have more)
2025-03-09 09:20:53,805 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0005 secs
2025-03-09 09:20:53,805 [INFO]: 	Selecting most promising index types given data characteristics 03/09/2025, 09:20:53
2025-03-09 09:20:53,805 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-09 09:20:53,805 [INFO]: 	Creating the index 03/09/2025, 09:20:53
2025-03-09 09:20:53,806 [INFO]: 		-> Instanciate the index HNSW15 03/09/2025, 09:20:53
2025-03-09 09:20:53,809 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0030 secs
2025-03-09 09:20:53,809 [INFO]: 		-> Adding the vectors to the index 03/09/2025, 09:20:53
2025-03-09 09:20:53,809 [INFO]: The memory available for adding the vectors is 49.3GB(total available - used by the index)
2025-03-09 09:20:53,809 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/17 [00:00<?, ?it/s] 12%|█▏        | 2/17 [00:00<00:00, 18.46it/s] 41%|████      | 7/17 [00:00<00:00, 36.02it/s] 65%|██████▍   | 11/17 [00:00<00:00, 35.55it/s] 94%|█████████▍| 16/17 [00:00<00:00, 39.93it/s]100%|██████████| 17/17 [00:03<00:00,  5.19it/s]
2025-03-09 09:20:57,090 [INFO]: 	Computing best hyperparameters for index knn.index 03/09/2025, 09:20:57
2025-03-09 09:21:34,294 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 37.2036 secs
2025-03-09 09:21:34,294 [INFO]: The best hyperparameters are: efSearch=322
2025-03-09 09:21:34,295 [INFO]: 	Compute fast metrics 03/09/2025, 09:21:34
  0%|          | 0/4 [00:00<?, ?it/s] 25%|██▌       | 1/4 [00:00<00:00,  9.26it/s] 75%|███████▌  | 3/4 [00:00<00:00, 16.45it/s]
2025-03-09 09:21:50,207 [INFO]: 	>>> Finished "Compute fast metrics" in 15.9127 secs
2025-03-09 09:21:50,211 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 56.4017 secs
2025-03-09 09:21:50,211 [INFO]: {
2025-03-09 09:21:50,211 [INFO]: 	index_key: HNSW15
2025-03-09 09:21:50,211 [INFO]: 	index_param: efSearch=322
2025-03-09 09:21:50,211 [INFO]: 	index_path: knn.index
2025-03-09 09:21:50,211 [INFO]: 	size in bytes: 801338410
2025-03-09 09:21:50,211 [INFO]: 	avg_search_speed_ms: 11.952870856445358
2025-03-09 09:21:50,211 [INFO]: 	99p_search_speed_ms: 25.16457263380289
2025-03-09 09:21:50,211 [INFO]: 	reconstruction error %: 0.0
2025-03-09 09:21:50,211 [INFO]: 	nb vectors: 4073
2025-03-09 09:21:50,211 [INFO]: 	vectors dimension: 49152
2025-03-09 09:21:50,211 [INFO]: 	compression ratio: 0.9993086241803885
2025-03-09 09:21:50,211 [INFO]: }
2025-03-09 09:21:50,211 [INFO]: 	>>> Finished "Creating the index" in 56.4058 secs
2025-03-09 09:21:50,211 [INFO]: >>> Finished "Launching the whole pipeline" in 56.4439 secs
2025-03-09 09:21:51: [retrieval_preprocessing] calculating distances ...
2025-03-09 09:21:52: [retrieval_preprocessing] finished and saved retrieval indices for episode 57731 [episode count 2/20]
[retrieval_preprocessing] for episode 55303 [episode count 3/20], we have num_retrieval=np.int64(4087) num_query=np.int64(167)
2025-03-09 09:21:53,927 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-09 09:21:54,533 [INFO]: Launching the whole pipeline 03/09/2025, 09:21:54
2025-03-09 09:21:54,533 [INFO]: Reading total number of vectors and dimension 03/09/2025, 09:21:54
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1383.80it/s]
2025-03-09 09:21:54,569 [INFO]: There are 4087 embeddings of dim 49152
2025-03-09 09:21:54,570 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0368 secs
2025-03-09 09:21:54,570 [INFO]: 	Compute estimated construction time of the index 03/09/2025, 09:21:54
2025-03-09 09:21:54,570 [INFO]: 		-> Train: 16.7 minutes
2025-03-09 09:21:54,570 [INFO]: 		-> Add: 2.2 seconds
2025-03-09 09:21:54,571 [INFO]: 		Total: 16.7 minutes
2025-03-09 09:21:54,571 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0007 secs
2025-03-09 09:21:54,571 [INFO]: 	Checking that your have enough memory available to create the index 03/09/2025, 09:21:54
2025-03-09 09:21:54,571 [INFO]: 843.5MB of memory will be needed to build the index (more might be used if you have more)
2025-03-09 09:21:54,572 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0006 secs
2025-03-09 09:21:54,572 [INFO]: 	Selecting most promising index types given data characteristics 03/09/2025, 09:21:54
2025-03-09 09:21:54,572 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-09 09:21:54,572 [INFO]: 	Creating the index 03/09/2025, 09:21:54
2025-03-09 09:21:54,572 [INFO]: 		-> Instanciate the index HNSW15 03/09/2025, 09:21:54
2025-03-09 09:21:54,575 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0026 secs
2025-03-09 09:21:54,575 [INFO]: 		-> Adding the vectors to the index 03/09/2025, 09:21:54
2025-03-09 09:21:54,575 [INFO]: The memory available for adding the vectors is 49.3GB(total available - used by the index)
2025-03-09 09:21:54,576 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/17 [00:00<?, ?it/s] 12%|█▏        | 2/17 [00:00<00:00, 18.32it/s] 47%|████▋     | 8/17 [00:00<00:00, 41.22it/s] 82%|████████▏ | 14/17 [00:00<00:00, 49.23it/s]100%|██████████| 17/17 [00:03<00:00,  5.48it/s]
2025-03-09 09:21:57,682 [INFO]: 	Computing best hyperparameters for index knn.index 03/09/2025, 09:21:57
2025-03-09 09:22:35,203 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 37.5205 secs
2025-03-09 09:22:35,204 [INFO]: The best hyperparameters are: efSearch=317
2025-03-09 09:22:35,204 [INFO]: 	Compute fast metrics 03/09/2025, 09:22:35
  0%|          | 0/4 [00:00<?, ?it/s] 25%|██▌       | 1/4 [00:00<00:00,  5.25it/s] 75%|███████▌  | 3/4 [00:00<00:00,  8.70it/s] 75%|███████▌  | 3/4 [00:00<00:00,  6.73it/s]
2025-03-09 09:22:50,608 [INFO]: 	>>> Finished "Compute fast metrics" in 15.4039 secs
2025-03-09 09:22:50,610 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 56.0347 secs
2025-03-09 09:22:50,610 [INFO]: {
2025-03-09 09:22:50,610 [INFO]: 	index_key: HNSW15
2025-03-09 09:22:50,610 [INFO]: 	index_param: efSearch=317
2025-03-09 09:22:50,610 [INFO]: 	index_path: knn.index
2025-03-09 09:22:50,610 [INFO]: 	size in bytes: 804092830
2025-03-09 09:22:50,610 [INFO]: 	avg_search_speed_ms: 12.462509357840824
2025-03-09 09:22:50,610 [INFO]: 	99p_search_speed_ms: 25.07482571527362
2025-03-09 09:22:50,610 [INFO]: 	reconstruction error %: 0.0
2025-03-09 09:22:50,610 [INFO]: 	nb vectors: 4087
2025-03-09 09:22:50,610 [INFO]: 	vectors dimension: 49152
2025-03-09 09:22:50,610 [INFO]: 	compression ratio: 0.9993086196279104
2025-03-09 09:22:50,610 [INFO]: }
2025-03-09 09:22:50,610 [INFO]: 	>>> Finished "Creating the index" in 56.0383 secs
2025-03-09 09:22:50,610 [INFO]: >>> Finished "Launching the whole pipeline" in 56.0776 secs
2025-03-09 09:22:51: [retrieval_preprocessing] calculating distances ...
2025-03-09 09:22:52: [retrieval_preprocessing] finished and saved retrieval indices for episode 55303 [episode count 3/20]
[retrieval_preprocessing] for episode 74378 [episode count 4/20], we have num_retrieval=np.int64(3984) num_query=np.int64(270)
2025-03-09 09:22:52,607 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-09 09:22:53,729 [INFO]: Launching the whole pipeline 03/09/2025, 09:22:53
2025-03-09 09:22:53,730 [INFO]: Reading total number of vectors and dimension 03/09/2025, 09:22:53
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1177.84it/s]
2025-03-09 09:22:53,760 [INFO]: There are 3984 embeddings of dim 49152
2025-03-09 09:22:53,761 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0311 secs
2025-03-09 09:22:53,761 [INFO]: 	Compute estimated construction time of the index 03/09/2025, 09:22:53
2025-03-09 09:22:53,761 [INFO]: 		-> Train: 16.7 minutes
2025-03-09 09:22:53,761 [INFO]: 		-> Add: 2.2 seconds
2025-03-09 09:22:53,761 [INFO]: 		Total: 16.7 minutes
2025-03-09 09:22:53,761 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0001 secs
2025-03-09 09:22:53,761 [INFO]: 	Checking that your have enough memory available to create the index 03/09/2025, 09:22:53
2025-03-09 09:22:53,761 [INFO]: 822.2MB of memory will be needed to build the index (more might be used if you have more)
2025-03-09 09:22:53,761 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0001 secs
2025-03-09 09:22:53,761 [INFO]: 	Selecting most promising index types given data characteristics 03/09/2025, 09:22:53
2025-03-09 09:22:53,761 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-09 09:22:53,761 [INFO]: 	Creating the index 03/09/2025, 09:22:53
2025-03-09 09:22:53,761 [INFO]: 		-> Instanciate the index HNSW15 03/09/2025, 09:22:53
2025-03-09 09:22:53,762 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0010 secs
2025-03-09 09:22:53,762 [INFO]: 		-> Adding the vectors to the index 03/09/2025, 09:22:53
2025-03-09 09:22:53,762 [INFO]: The memory available for adding the vectors is 49.3GB(total available - used by the index)
2025-03-09 09:22:53,762 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/16 [00:00<?, ?it/s] 12%|█▎        | 2/16 [00:00<00:00, 16.96it/s] 44%|████▍     | 7/16 [00:00<00:00, 34.89it/s] 81%|████████▏ | 13/16 [00:00<00:00, 43.68it/s]100%|██████████| 16/16 [00:02<00:00,  5.74it/s]
2025-03-09 09:22:56,551 [INFO]: 	Computing best hyperparameters for index knn.index 03/09/2025, 09:22:56
2025-03-09 09:23:31,837 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 35.2857 secs
2025-03-09 09:23:31,838 [INFO]: The best hyperparameters are: efSearch=301
2025-03-09 09:23:31,838 [INFO]: 	Compute fast metrics 03/09/2025, 09:23:31
  0%|          | 0/4 [00:00<?, ?it/s] 25%|██▌       | 1/4 [00:00<00:00,  9.80it/s] 75%|███████▌  | 3/4 [00:00<00:00, 15.43it/s]
2025-03-09 09:23:47,668 [INFO]: 	>>> Finished "Compute fast metrics" in 15.8297 secs
2025-03-09 09:23:47,670 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 53.9074 secs
2025-03-09 09:23:47,670 [INFO]: {
2025-03-09 09:23:47,670 [INFO]: 	index_key: HNSW15
2025-03-09 09:23:47,670 [INFO]: 	index_param: efSearch=301
2025-03-09 09:23:47,670 [INFO]: 	index_path: knn.index
2025-03-09 09:23:47,670 [INFO]: 	size in bytes: 783828250
2025-03-09 09:23:47,670 [INFO]: 	avg_search_speed_ms: 10.779065188624623
2025-03-09 09:23:47,670 [INFO]: 	99p_search_speed_ms: 20.742500231135637
2025-03-09 09:23:47,670 [INFO]: 	reconstruction error %: 0.0
2025-03-09 09:23:47,670 [INFO]: 	nb vectors: 3984
2025-03-09 09:23:47,670 [INFO]: 	vectors dimension: 49152
2025-03-09 09:23:47,670 [INFO]: 	compression ratio: 0.999308550055449
2025-03-09 09:23:47,670 [INFO]: }
2025-03-09 09:23:47,670 [INFO]: 	>>> Finished "Creating the index" in 53.9089 secs
2025-03-09 09:23:47,670 [INFO]: >>> Finished "Launching the whole pipeline" in 53.9405 secs
2025-03-09 09:23:49: [retrieval_preprocessing] calculating distances ...
2025-03-09 09:23:50: [retrieval_preprocessing] finished and saved retrieval indices for episode 74378 [episode count 4/20]
[retrieval_preprocessing] for episode 35212 [episode count 5/20], we have num_retrieval=np.int64(3976) num_query=np.int64(278)
2025-03-09 09:23:50,376 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-09 09:23:50,897 [INFO]: Launching the whole pipeline 03/09/2025, 09:23:50
2025-03-09 09:23:50,897 [INFO]: Reading total number of vectors and dimension 03/09/2025, 09:23:50
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1848.53it/s]
2025-03-09 09:23:50,926 [INFO]: There are 3976 embeddings of dim 49152
2025-03-09 09:23:50,926 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0293 secs
2025-03-09 09:23:50,926 [INFO]: 	Compute estimated construction time of the index 03/09/2025, 09:23:50
2025-03-09 09:23:50,926 [INFO]: 		-> Train: 16.7 minutes
2025-03-09 09:23:50,926 [INFO]: 		-> Add: 2.2 seconds
2025-03-09 09:23:50,926 [INFO]: 		Total: 16.7 minutes
2025-03-09 09:23:50,926 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0001 secs
2025-03-09 09:23:50,926 [INFO]: 	Checking that your have enough memory available to create the index 03/09/2025, 09:23:50
2025-03-09 09:23:50,926 [INFO]: 820.6MB of memory will be needed to build the index (more might be used if you have more)
2025-03-09 09:23:50,927 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0001 secs
2025-03-09 09:23:50,927 [INFO]: 	Selecting most promising index types given data characteristics 03/09/2025, 09:23:50
2025-03-09 09:23:50,927 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-09 09:23:50,927 [INFO]: 	Creating the index 03/09/2025, 09:23:50
2025-03-09 09:23:50,927 [INFO]: 		-> Instanciate the index HNSW15 03/09/2025, 09:23:50
2025-03-09 09:23:50,928 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0009 secs
2025-03-09 09:23:50,928 [INFO]: 		-> Adding the vectors to the index 03/09/2025, 09:23:50
2025-03-09 09:23:50,928 [INFO]: The memory available for adding the vectors is 49.3GB(total available - used by the index)
2025-03-09 09:23:50,928 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/16 [00:00<?, ?it/s]  6%|▋         | 1/16 [00:00<00:01,  7.77it/s] 44%|████▍     | 7/16 [00:00<00:00, 32.64it/s] 75%|███████▌  | 12/16 [00:00<00:00, 37.41it/s]100%|██████████| 16/16 [00:03<00:00,  3.80it/s]100%|██████████| 16/16 [00:03<00:00,  5.30it/s]
2025-03-09 09:23:53,948 [INFO]: 	Computing best hyperparameters for index knn.index 03/09/2025, 09:23:53
2025-03-09 09:24:32,641 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 38.6931 secs
2025-03-09 09:24:32,641 [INFO]: The best hyperparameters are: efSearch=326
2025-03-09 09:24:32,642 [INFO]: 	Compute fast metrics 03/09/2025, 09:24:32
  0%|          | 0/4 [00:00<?, ?it/s] 75%|███████▌  | 3/4 [00:00<00:00, 25.80it/s] 75%|███████▌  | 3/4 [00:00<00:00, 22.24it/s]
2025-03-09 09:24:51,327 [INFO]: 	>>> Finished "Compute fast metrics" in 18.6856 secs
2025-03-09 09:24:51,330 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 60.4022 secs
2025-03-09 09:24:51,330 [INFO]: {
2025-03-09 09:24:51,330 [INFO]: 	index_key: HNSW15
2025-03-09 09:24:51,330 [INFO]: 	index_param: efSearch=326
2025-03-09 09:24:51,330 [INFO]: 	index_path: knn.index
2025-03-09 09:24:51,330 [INFO]: 	size in bytes: 782254270
2025-03-09 09:24:51,330 [INFO]: 	avg_search_speed_ms: 12.063833248472365
2025-03-09 09:24:51,330 [INFO]: 	99p_search_speed_ms: 25.852297805249695
2025-03-09 09:24:51,330 [INFO]: 	reconstruction error %: 0.0
2025-03-09 09:24:51,330 [INFO]: 	nb vectors: 3976
2025-03-09 09:24:51,330 [INFO]: 	vectors dimension: 49152
2025-03-09 09:24:51,330 [INFO]: 	compression ratio: 0.9993085854296455
2025-03-09 09:24:51,330 [INFO]: }
2025-03-09 09:24:51,330 [INFO]: 	>>> Finished "Creating the index" in 60.4037 secs
2025-03-09 09:24:51,330 [INFO]: >>> Finished "Launching the whole pipeline" in 60.4335 secs
2025-03-09 09:24:53: [retrieval_preprocessing] calculating distances ...
2025-03-09 09:24:54: [retrieval_preprocessing] finished and saved retrieval indices for episode 35212 [episode count 5/20]
[retrieval_preprocessing] for episode 24461 [episode count 6/20], we have num_retrieval=np.int64(3988) num_query=np.int64(266)
2025-03-09 09:24:54,541 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-09 09:24:55,108 [INFO]: Launching the whole pipeline 03/09/2025, 09:24:55
2025-03-09 09:24:55,108 [INFO]: Reading total number of vectors and dimension 03/09/2025, 09:24:55
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1170.29it/s]
2025-03-09 09:24:55,141 [INFO]: There are 3988 embeddings of dim 49152
2025-03-09 09:24:55,141 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0332 secs
2025-03-09 09:24:55,141 [INFO]: 	Compute estimated construction time of the index 03/09/2025, 09:24:55
2025-03-09 09:24:55,141 [INFO]: 		-> Train: 16.7 minutes
2025-03-09 09:24:55,141 [INFO]: 		-> Add: 2.2 seconds
2025-03-09 09:24:55,141 [INFO]: 		Total: 16.7 minutes
2025-03-09 09:24:55,141 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0001 secs
2025-03-09 09:24:55,141 [INFO]: 	Checking that your have enough memory available to create the index 03/09/2025, 09:24:55
2025-03-09 09:24:55,141 [INFO]: 823.0MB of memory will be needed to build the index (more might be used if you have more)
2025-03-09 09:24:55,141 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0002 secs
2025-03-09 09:24:55,142 [INFO]: 	Selecting most promising index types given data characteristics 03/09/2025, 09:24:55
2025-03-09 09:24:55,142 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-09 09:24:55,142 [INFO]: 	Creating the index 03/09/2025, 09:24:55
2025-03-09 09:24:55,142 [INFO]: 		-> Instanciate the index HNSW15 03/09/2025, 09:24:55
2025-03-09 09:24:55,143 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0010 secs
2025-03-09 09:24:55,143 [INFO]: 		-> Adding the vectors to the index 03/09/2025, 09:24:55
2025-03-09 09:24:55,143 [INFO]: The memory available for adding the vectors is 49.3GB(total available - used by the index)
2025-03-09 09:24:55,143 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/16 [00:00<?, ?it/s]  6%|▋         | 1/16 [00:00<00:02,  7.00it/s] 25%|██▌       | 4/16 [00:00<00:00, 18.05it/s] 56%|█████▋    | 9/16 [00:00<00:00, 29.64it/s] 94%|█████████▍| 15/16 [00:00<00:00, 38.25it/s]100%|██████████| 16/16 [00:03<00:00,  4.97it/s]
2025-03-09 09:24:58,364 [INFO]: 	Computing best hyperparameters for index knn.index 03/09/2025, 09:24:58
2025-03-09 09:25:34,446 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 36.0813 secs
2025-03-09 09:25:34,446 [INFO]: The best hyperparameters are: efSearch=337
2025-03-09 09:25:34,446 [INFO]: 	Compute fast metrics 03/09/2025, 09:25:34
  0%|          | 0/4 [00:00<?, ?it/s] 50%|█████     | 2/4 [00:00<00:00, 19.22it/s] 75%|███████▌  | 3/4 [00:00<00:00, 21.23it/s]
2025-03-09 09:25:55,476 [INFO]: 	>>> Finished "Compute fast metrics" in 21.0300 secs
2025-03-09 09:25:55,479 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 60.3360 secs
2025-03-09 09:25:55,479 [INFO]: {
2025-03-09 09:25:55,479 [INFO]: 	index_key: HNSW15
2025-03-09 09:25:55,479 [INFO]: 	index_param: efSearch=337
2025-03-09 09:25:55,479 [INFO]: 	index_path: knn.index
2025-03-09 09:25:55,479 [INFO]: 	size in bytes: 784615210
2025-03-09 09:25:55,479 [INFO]: 	avg_search_speed_ms: 11.379567134926209
2025-03-09 09:25:55,479 [INFO]: 	99p_search_speed_ms: 25.47550962772221
2025-03-09 09:25:55,479 [INFO]: 	reconstruction error %: 0.0
2025-03-09 09:25:55,479 [INFO]: 	nb vectors: 3988
2025-03-09 09:25:55,479 [INFO]: 	vectors dimension: 49152
2025-03-09 09:25:55,479 [INFO]: 	compression ratio: 0.9993085706304368
2025-03-09 09:25:55,479 [INFO]: }
2025-03-09 09:25:55,479 [INFO]: 	>>> Finished "Creating the index" in 60.3375 secs
2025-03-09 09:25:55,479 [INFO]: >>> Finished "Launching the whole pipeline" in 60.3714 secs
2025-03-09 09:25:57: [retrieval_preprocessing] calculating distances ...
2025-03-09 09:25:58: [retrieval_preprocessing] finished and saved retrieval indices for episode 24461 [episode count 6/20]
[retrieval_preprocessing] for episode 76685 [episode count 7/20], we have num_retrieval=np.int64(4064) num_query=np.int64(190)
2025-03-09 09:25:59,325 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-09 09:26:00,015 [INFO]: Launching the whole pipeline 03/09/2025, 09:26:00
2025-03-09 09:26:00,016 [INFO]: Reading total number of vectors and dimension 03/09/2025, 09:26:00
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1526.87it/s]
2025-03-09 09:26:00,050 [INFO]: There are 4064 embeddings of dim 49152
2025-03-09 09:26:00,050 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0347 secs
2025-03-09 09:26:00,051 [INFO]: 	Compute estimated construction time of the index 03/09/2025, 09:26:00
2025-03-09 09:26:00,051 [INFO]: 		-> Train: 16.7 minutes
2025-03-09 09:26:00,051 [INFO]: 		-> Add: 2.2 seconds
2025-03-09 09:26:00,051 [INFO]: 		Total: 16.7 minutes
2025-03-09 09:26:00,051 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0002 secs
2025-03-09 09:26:00,051 [INFO]: 	Checking that your have enough memory available to create the index 03/09/2025, 09:26:00
2025-03-09 09:26:00,051 [INFO]: 838.7MB of memory will be needed to build the index (more might be used if you have more)
2025-03-09 09:26:00,051 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0002 secs
2025-03-09 09:26:00,051 [INFO]: 	Selecting most promising index types given data characteristics 03/09/2025, 09:26:00
2025-03-09 09:26:00,051 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-09 09:26:00,051 [INFO]: 	Creating the index 03/09/2025, 09:26:00
2025-03-09 09:26:00,051 [INFO]: 		-> Instanciate the index HNSW15 03/09/2025, 09:26:00
2025-03-09 09:26:00,053 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0019 secs
2025-03-09 09:26:00,054 [INFO]: 		-> Adding the vectors to the index 03/09/2025, 09:26:00
2025-03-09 09:26:00,054 [INFO]: The memory available for adding the vectors is 49.3GB(total available - used by the index)
2025-03-09 09:26:00,054 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/16 [00:00<?, ?it/s]  6%|▋         | 1/16 [00:00<00:02,  6.73it/s] 44%|████▍     | 7/16 [00:00<00:00, 30.25it/s] 75%|███████▌  | 12/16 [00:00<00:00, 37.35it/s]100%|██████████| 16/16 [00:04<00:00,  2.81it/s]100%|██████████| 16/16 [00:04<00:00,  3.98it/s]
2025-03-09 09:26:04,083 [INFO]: 	Computing best hyperparameters for index knn.index 03/09/2025, 09:26:04
2025-03-09 09:26:39,668 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 35.5845 secs
2025-03-09 09:26:39,668 [INFO]: The best hyperparameters are: efSearch=340
2025-03-09 09:26:39,668 [INFO]: 	Compute fast metrics 03/09/2025, 09:26:39
  0%|          | 0/4 [00:00<?, ?it/s] 75%|███████▌  | 3/4 [00:00<00:00, 24.66it/s] 75%|███████▌  | 3/4 [00:00<00:00, 21.53it/s]
2025-03-09 09:26:58,487 [INFO]: 	>>> Finished "Compute fast metrics" in 18.8195 secs
2025-03-09 09:26:58,490 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 58.4358 secs
2025-03-09 09:26:58,490 [INFO]: {
2025-03-09 09:26:58,490 [INFO]: 	index_key: HNSW15
2025-03-09 09:26:58,490 [INFO]: 	index_param: efSearch=340
2025-03-09 09:26:58,490 [INFO]: 	index_path: knn.index
2025-03-09 09:26:58,490 [INFO]: 	size in bytes: 799567690
2025-03-09 09:26:58,490 [INFO]: 	avg_search_speed_ms: 10.738285403306968
2025-03-09 09:26:58,490 [INFO]: 	99p_search_speed_ms: 18.323698935564604
2025-03-09 09:26:58,490 [INFO]: 	reconstruction error %: 0.0
2025-03-09 09:26:58,490 [INFO]: 	nb vectors: 4064
2025-03-09 09:26:58,490 [INFO]: 	vectors dimension: 49152
2025-03-09 09:26:58,490 [INFO]: 	compression ratio: 0.9993086539052122
2025-03-09 09:26:58,490 [INFO]: }
2025-03-09 09:26:58,490 [INFO]: 	>>> Finished "Creating the index" in 58.4385 secs
2025-03-09 09:26:58,490 [INFO]: >>> Finished "Launching the whole pipeline" in 58.4744 secs
2025-03-09 09:27:00: [retrieval_preprocessing] calculating distances ...
2025-03-09 09:27:01: [retrieval_preprocessing] finished and saved retrieval indices for episode 76685 [episode count 7/20]
[retrieval_preprocessing] for episode 92044 [episode count 8/20], we have num_retrieval=np.int64(4049) num_query=np.int64(205)
2025-03-09 09:27:01,918 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-09 09:27:03,066 [INFO]: Launching the whole pipeline 03/09/2025, 09:27:03
2025-03-09 09:27:03,067 [INFO]: Reading total number of vectors and dimension 03/09/2025, 09:27:03
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1547.71it/s]
2025-03-09 09:27:03,106 [INFO]: There are 4049 embeddings of dim 49152
2025-03-09 09:27:03,106 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0395 secs
2025-03-09 09:27:03,106 [INFO]: 	Compute estimated construction time of the index 03/09/2025, 09:27:03
2025-03-09 09:27:03,106 [INFO]: 		-> Train: 16.7 minutes
2025-03-09 09:27:03,106 [INFO]: 		-> Add: 2.2 seconds
2025-03-09 09:27:03,106 [INFO]: 		Total: 16.7 minutes
2025-03-09 09:27:03,106 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0001 secs
2025-03-09 09:27:03,106 [INFO]: 	Checking that your have enough memory available to create the index 03/09/2025, 09:27:03
2025-03-09 09:27:03,106 [INFO]: 835.6MB of memory will be needed to build the index (more might be used if you have more)
2025-03-09 09:27:03,106 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0002 secs
2025-03-09 09:27:03,107 [INFO]: 	Selecting most promising index types given data characteristics 03/09/2025, 09:27:03
2025-03-09 09:27:03,107 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-09 09:27:03,107 [INFO]: 	Creating the index 03/09/2025, 09:27:03
2025-03-09 09:27:03,107 [INFO]: 		-> Instanciate the index HNSW15 03/09/2025, 09:27:03
2025-03-09 09:27:03,108 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0010 secs
2025-03-09 09:27:03,108 [INFO]: 		-> Adding the vectors to the index 03/09/2025, 09:27:03
2025-03-09 09:27:03,108 [INFO]: The memory available for adding the vectors is 49.3GB(total available - used by the index)
2025-03-09 09:27:03,108 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/16 [00:00<?, ?it/s]  6%|▋         | 1/16 [00:00<00:01,  9.06it/s] 38%|███▊      | 6/16 [00:00<00:00, 30.18it/s] 69%|██████▉   | 11/16 [00:00<00:00, 37.13it/s] 94%|█████████▍| 15/16 [00:00<00:00, 37.31it/s]100%|██████████| 16/16 [00:03<00:00,  4.82it/s]
2025-03-09 09:27:06,432 [INFO]: 	Computing best hyperparameters for index knn.index 03/09/2025, 09:27:06
2025-03-09 09:27:41,331 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 34.8985 secs
2025-03-09 09:27:41,331 [INFO]: The best hyperparameters are: efSearch=266
2025-03-09 09:27:41,331 [INFO]: 	Compute fast metrics 03/09/2025, 09:27:41
  0%|          | 0/4 [00:00<?, ?it/s] 25%|██▌       | 1/4 [00:00<00:00,  9.33it/s] 75%|███████▌  | 3/4 [00:00<00:00, 17.30it/s]
2025-03-09 09:27:56,725 [INFO]: 	>>> Finished "Compute fast metrics" in 15.3943 secs
2025-03-09 09:27:56,866 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 53.7582 secs
2025-03-09 09:27:56,866 [INFO]: {
2025-03-09 09:27:56,866 [INFO]: 	index_key: HNSW15
2025-03-09 09:27:56,867 [INFO]: 	index_param: efSearch=266
2025-03-09 09:27:56,867 [INFO]: 	index_path: knn.index
2025-03-09 09:27:56,867 [INFO]: 	size in bytes: 796616590
2025-03-09 09:27:56,867 [INFO]: 	avg_search_speed_ms: 8.703468740108002
2025-03-09 09:27:56,867 [INFO]: 	99p_search_speed_ms: 18.368767164647576
2025-03-09 09:27:56,867 [INFO]: 	reconstruction error %: 0.0
2025-03-09 09:27:56,867 [INFO]: 	nb vectors: 4049
2025-03-09 09:27:56,867 [INFO]: 	vectors dimension: 49152
2025-03-09 09:27:56,867 [INFO]: 	compression ratio: 0.9993085782961161
2025-03-09 09:27:56,867 [INFO]: }
2025-03-09 09:27:56,867 [INFO]: 	>>> Finished "Creating the index" in 53.7605 secs
2025-03-09 09:27:56,867 [INFO]: >>> Finished "Launching the whole pipeline" in 53.8006 secs
2025-03-09 09:27:58: [retrieval_preprocessing] calculating distances ...
2025-03-09 09:27:58: [retrieval_preprocessing] finished and saved retrieval indices for episode 92044 [episode count 8/20]
[retrieval_preprocessing] for episode 17552 [episode count 9/20], we have num_retrieval=np.int64(4077) num_query=np.int64(177)
2025-03-09 09:27:58,718 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-09 09:27:59,190 [INFO]: Launching the whole pipeline 03/09/2025, 09:27:59
2025-03-09 09:27:59,190 [INFO]: Reading total number of vectors and dimension 03/09/2025, 09:27:59
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 2209.85it/s]
2025-03-09 09:27:59,218 [INFO]: There are 4077 embeddings of dim 49152
2025-03-09 09:27:59,218 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0275 secs
2025-03-09 09:27:59,218 [INFO]: 	Compute estimated construction time of the index 03/09/2025, 09:27:59
2025-03-09 09:27:59,218 [INFO]: 		-> Train: 16.7 minutes
2025-03-09 09:27:59,218 [INFO]: 		-> Add: 2.2 seconds
2025-03-09 09:27:59,218 [INFO]: 		Total: 16.7 minutes
2025-03-09 09:27:59,218 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0001 secs
2025-03-09 09:27:59,218 [INFO]: 	Checking that your have enough memory available to create the index 03/09/2025, 09:27:59
2025-03-09 09:27:59,218 [INFO]: 841.4MB of memory will be needed to build the index (more might be used if you have more)
2025-03-09 09:27:59,218 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0001 secs
2025-03-09 09:27:59,218 [INFO]: 	Selecting most promising index types given data characteristics 03/09/2025, 09:27:59
2025-03-09 09:27:59,218 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-09 09:27:59,218 [INFO]: 	Creating the index 03/09/2025, 09:27:59
2025-03-09 09:27:59,218 [INFO]: 		-> Instanciate the index HNSW15 03/09/2025, 09:27:59
2025-03-09 09:27:59,220 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0010 secs
2025-03-09 09:27:59,220 [INFO]: 		-> Adding the vectors to the index 03/09/2025, 09:27:59
2025-03-09 09:27:59,220 [INFO]: The memory available for adding the vectors is 49.3GB(total available - used by the index)
2025-03-09 09:27:59,220 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/17 [00:00<?, ?it/s] 12%|█▏        | 2/17 [00:00<00:00, 17.27it/s] 47%|████▋     | 8/17 [00:00<00:00, 39.81it/s] 82%|████████▏ | 14/17 [00:00<00:00, 46.98it/s]100%|██████████| 17/17 [00:02<00:00,  6.11it/s]
2025-03-09 09:28:02,005 [INFO]: 	Computing best hyperparameters for index knn.index 03/09/2025, 09:28:02
2025-03-09 09:28:42,215 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 40.2089 secs
2025-03-09 09:28:42,215 [INFO]: The best hyperparameters are: efSearch=323
2025-03-09 09:28:42,215 [INFO]: 	Compute fast metrics 03/09/2025, 09:28:42
  0%|          | 0/4 [00:00<?, ?it/s] 50%|█████     | 2/4 [00:00<00:00, 19.65it/s] 75%|███████▌  | 3/4 [00:00<00:00, 21.43it/s]
2025-03-09 09:29:03,142 [INFO]: 	>>> Finished "Compute fast metrics" in 20.9272 secs
2025-03-09 09:29:03,144 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 63.9244 secs
2025-03-09 09:29:03,144 [INFO]: {
2025-03-09 09:29:03,144 [INFO]: 	index_key: HNSW15
2025-03-09 09:29:03,144 [INFO]: 	index_param: efSearch=323
2025-03-09 09:29:03,144 [INFO]: 	index_path: knn.index
2025-03-09 09:29:03,144 [INFO]: 	size in bytes: 802125370
2025-03-09 09:29:03,144 [INFO]: 	avg_search_speed_ms: 10.343798149941486
2025-03-09 09:29:03,144 [INFO]: 	99p_search_speed_ms: 21.776473387144513
2025-03-09 09:29:03,144 [INFO]: 	reconstruction error %: 0.0
2025-03-09 09:29:03,145 [INFO]: 	nb vectors: 4077
2025-03-09 09:29:03,145 [INFO]: 	vectors dimension: 49152
2025-03-09 09:29:03,145 [INFO]: 	compression ratio: 0.9993086442335067
2025-03-09 09:29:03,145 [INFO]: }
2025-03-09 09:29:03,145 [INFO]: 	>>> Finished "Creating the index" in 63.9261 secs
2025-03-09 09:29:03,145 [INFO]: >>> Finished "Launching the whole pipeline" in 63.9543 secs
2025-03-09 09:29:04: [retrieval_preprocessing] calculating distances ...
2025-03-09 09:29:05: [retrieval_preprocessing] finished and saved retrieval indices for episode 17552 [episode count 9/20]
[retrieval_preprocessing] for episode 35216 [episode count 10/20], we have num_retrieval=np.int64(3988) num_query=np.int64(266)
2025-03-09 09:29:05,415 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-09 09:29:05,917 [INFO]: Launching the whole pipeline 03/09/2025, 09:29:05
2025-03-09 09:29:05,917 [INFO]: Reading total number of vectors and dimension 03/09/2025, 09:29:05
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 2278.27it/s]
2025-03-09 09:29:05,947 [INFO]: There are 3988 embeddings of dim 49152
2025-03-09 09:29:05,947 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0298 secs
2025-03-09 09:29:05,947 [INFO]: 	Compute estimated construction time of the index 03/09/2025, 09:29:05
2025-03-09 09:29:05,947 [INFO]: 		-> Train: 16.7 minutes
2025-03-09 09:29:05,947 [INFO]: 		-> Add: 2.2 seconds
2025-03-09 09:29:05,947 [INFO]: 		Total: 16.7 minutes
2025-03-09 09:29:05,947 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0001 secs
2025-03-09 09:29:05,947 [INFO]: 	Checking that your have enough memory available to create the index 03/09/2025, 09:29:05
2025-03-09 09:29:05,947 [INFO]: 823.0MB of memory will be needed to build the index (more might be used if you have more)
2025-03-09 09:29:05,947 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0001 secs
2025-03-09 09:29:05,947 [INFO]: 	Selecting most promising index types given data characteristics 03/09/2025, 09:29:05
2025-03-09 09:29:05,947 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-09 09:29:05,947 [INFO]: 	Creating the index 03/09/2025, 09:29:05
2025-03-09 09:29:05,947 [INFO]: 		-> Instanciate the index HNSW15 03/09/2025, 09:29:05
2025-03-09 09:29:05,948 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0009 secs
2025-03-09 09:29:05,948 [INFO]: 		-> Adding the vectors to the index 03/09/2025, 09:29:05
2025-03-09 09:29:05,948 [INFO]: The memory available for adding the vectors is 49.3GB(total available - used by the index)
2025-03-09 09:29:05,949 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/16 [00:00<?, ?it/s]  6%|▋         | 1/16 [00:00<00:02,  7.38it/s] 44%|████▍     | 7/16 [00:00<00:00, 32.09it/s] 81%|████████▏ | 13/16 [00:00<00:00, 41.00it/s]100%|██████████| 16/16 [00:02<00:00,  5.62it/s]
2025-03-09 09:29:08,796 [INFO]: 	Computing best hyperparameters for index knn.index 03/09/2025, 09:29:08
2025-03-09 09:29:43,842 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 35.0456 secs
2025-03-09 09:29:43,842 [INFO]: The best hyperparameters are: efSearch=267
2025-03-09 09:29:43,842 [INFO]: 	Compute fast metrics 03/09/2025, 09:29:43
  0%|          | 0/4 [00:00<?, ?it/s] 25%|██▌       | 1/4 [00:00<00:00,  9.30it/s] 75%|███████▌  | 3/4 [00:00<00:00, 17.87it/s]
2025-03-09 09:29:59,553 [INFO]: 	>>> Finished "Compute fast metrics" in 15.7108 secs
2025-03-09 09:29:59,556 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 53.6071 secs
2025-03-09 09:29:59,556 [INFO]: {
2025-03-09 09:29:59,556 [INFO]: 	index_key: HNSW15
2025-03-09 09:29:59,556 [INFO]: 	index_param: efSearch=267
2025-03-09 09:29:59,556 [INFO]: 	index_path: knn.index
2025-03-09 09:29:59,556 [INFO]: 	size in bytes: 784615210
2025-03-09 09:29:59,556 [INFO]: 	avg_search_speed_ms: 8.908561273508656
2025-03-09 09:29:59,556 [INFO]: 	99p_search_speed_ms: 18.50297577213496
2025-03-09 09:29:59,556 [INFO]: 	reconstruction error %: 0.0
2025-03-09 09:29:59,556 [INFO]: 	nb vectors: 3988
2025-03-09 09:29:59,556 [INFO]: 	vectors dimension: 49152
2025-03-09 09:29:59,556 [INFO]: 	compression ratio: 0.9993085706304368
2025-03-09 09:29:59,556 [INFO]: }
2025-03-09 09:29:59,556 [INFO]: 	>>> Finished "Creating the index" in 53.6084 secs
2025-03-09 09:29:59,556 [INFO]: >>> Finished "Launching the whole pipeline" in 53.6390 secs
2025-03-09 09:30:01: [retrieval_preprocessing] calculating distances ...
2025-03-09 09:30:01: [retrieval_preprocessing] finished and saved retrieval indices for episode 35216 [episode count 10/20]
[retrieval_preprocessing] for episode 52882 [episode count 11/20], we have num_retrieval=np.int64(4048) num_query=np.int64(206)
2025-03-09 09:30:02,105 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-09 09:30:02,614 [INFO]: Launching the whole pipeline 03/09/2025, 09:30:02
2025-03-09 09:30:02,614 [INFO]: Reading total number of vectors and dimension 03/09/2025, 09:30:02
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 2013.59it/s]
2025-03-09 09:30:02,648 [INFO]: There are 4048 embeddings of dim 49152
2025-03-09 09:30:02,648 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0335 secs
2025-03-09 09:30:02,648 [INFO]: 	Compute estimated construction time of the index 03/09/2025, 09:30:02
2025-03-09 09:30:02,648 [INFO]: 		-> Train: 16.7 minutes
2025-03-09 09:30:02,648 [INFO]: 		-> Add: 2.2 seconds
2025-03-09 09:30:02,648 [INFO]: 		Total: 16.7 minutes
2025-03-09 09:30:02,648 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0001 secs
2025-03-09 09:30:02,648 [INFO]: 	Checking that your have enough memory available to create the index 03/09/2025, 09:30:02
2025-03-09 09:30:02,648 [INFO]: 835.4MB of memory will be needed to build the index (more might be used if you have more)
2025-03-09 09:30:02,649 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0003 secs
2025-03-09 09:30:02,649 [INFO]: 	Selecting most promising index types given data characteristics 03/09/2025, 09:30:02
2025-03-09 09:30:02,649 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-09 09:30:02,649 [INFO]: 	Creating the index 03/09/2025, 09:30:02
2025-03-09 09:30:02,649 [INFO]: 		-> Instanciate the index HNSW15 03/09/2025, 09:30:02
2025-03-09 09:30:02,650 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0011 secs
2025-03-09 09:30:02,650 [INFO]: 		-> Adding the vectors to the index 03/09/2025, 09:30:02
2025-03-09 09:30:02,650 [INFO]: The memory available for adding the vectors is 49.3GB(total available - used by the index)
2025-03-09 09:30:02,650 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/16 [00:00<?, ?it/s]  6%|▋         | 1/16 [00:00<00:01,  8.36it/s] 44%|████▍     | 7/16 [00:00<00:00, 33.34it/s] 81%|████████▏ | 13/16 [00:00<00:00, 41.46it/s]100%|██████████| 16/16 [00:03<00:00,  4.79it/s]
2025-03-09 09:30:05,997 [INFO]: 	Computing best hyperparameters for index knn.index 03/09/2025, 09:30:05
2025-03-09 09:30:45,754 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 39.7567 secs
2025-03-09 09:30:45,754 [INFO]: The best hyperparameters are: efSearch=262
2025-03-09 09:30:45,754 [INFO]: 	Compute fast metrics 03/09/2025, 09:30:45
  0%|          | 0/4 [00:00<?, ?it/s] 50%|█████     | 2/4 [00:00<00:00, 18.54it/s] 75%|███████▌  | 3/4 [00:00<00:00, 20.58it/s]
2025-03-09 09:31:06,277 [INFO]: 	>>> Finished "Compute fast metrics" in 20.5228 secs
2025-03-09 09:31:06,280 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 63.6297 secs
2025-03-09 09:31:06,280 [INFO]: {
2025-03-09 09:31:06,280 [INFO]: 	index_key: HNSW15
2025-03-09 09:31:06,280 [INFO]: 	index_param: efSearch=262
2025-03-09 09:31:06,280 [INFO]: 	index_path: knn.index
2025-03-09 09:31:06,280 [INFO]: 	size in bytes: 796419850
2025-03-09 09:31:06,280 [INFO]: 	avg_search_speed_ms: 9.014972937616669
2025-03-09 09:31:06,280 [INFO]: 	99p_search_speed_ms: 18.376007415354273
2025-03-09 09:31:06,280 [INFO]: 	reconstruction error %: 0.0
2025-03-09 09:31:06,280 [INFO]: 	nb vectors: 4048
2025-03-09 09:31:06,280 [INFO]: 	vectors dimension: 49152
2025-03-09 09:31:06,280 [INFO]: 	compression ratio: 0.9993085732355868
2025-03-09 09:31:06,280 [INFO]: }
2025-03-09 09:31:06,280 [INFO]: 	>>> Finished "Creating the index" in 63.6313 secs
2025-03-09 09:31:06,280 [INFO]: >>> Finished "Launching the whole pipeline" in 63.6656 secs
2025-03-09 09:31:07: [retrieval_preprocessing] calculating distances ...
2025-03-09 09:31:08: [retrieval_preprocessing] finished and saved retrieval indices for episode 52882 [episode count 11/20]
[retrieval_preprocessing] for episode 42131 [episode count 12/20], we have num_retrieval=np.int64(3982) num_query=np.int64(272)
2025-03-09 09:31:08,396 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-09 09:31:08,925 [INFO]: Launching the whole pipeline 03/09/2025, 09:31:08
2025-03-09 09:31:08,925 [INFO]: Reading total number of vectors and dimension 03/09/2025, 09:31:08
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1974.72it/s]
2025-03-09 09:31:08,961 [INFO]: There are 3982 embeddings of dim 49152
2025-03-09 09:31:08,962 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0367 secs
2025-03-09 09:31:08,962 [INFO]: 	Compute estimated construction time of the index 03/09/2025, 09:31:08
2025-03-09 09:31:08,962 [INFO]: 		-> Train: 16.7 minutes
2025-03-09 09:31:08,963 [INFO]: 		-> Add: 2.2 seconds
2025-03-09 09:31:08,963 [INFO]: 		Total: 16.7 minutes
2025-03-09 09:31:08,963 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0006 secs
2025-03-09 09:31:08,963 [INFO]: 	Checking that your have enough memory available to create the index 03/09/2025, 09:31:08
2025-03-09 09:31:08,963 [INFO]: 821.8MB of memory will be needed to build the index (more might be used if you have more)
2025-03-09 09:31:08,964 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0005 secs
2025-03-09 09:31:08,964 [INFO]: 	Selecting most promising index types given data characteristics 03/09/2025, 09:31:08
2025-03-09 09:31:08,964 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-09 09:31:08,964 [INFO]: 	Creating the index 03/09/2025, 09:31:08
2025-03-09 09:31:08,964 [INFO]: 		-> Instanciate the index HNSW15 03/09/2025, 09:31:08
2025-03-09 09:31:08,968 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0033 secs
2025-03-09 09:31:08,968 [INFO]: 		-> Adding the vectors to the index 03/09/2025, 09:31:08
2025-03-09 09:31:08,968 [INFO]: The memory available for adding the vectors is 49.3GB(total available - used by the index)
2025-03-09 09:31:08,968 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/16 [00:00<?, ?it/s] 19%|█▉        | 3/16 [00:00<00:00, 25.65it/s] 50%|█████     | 8/16 [00:00<00:00, 36.87it/s] 88%|████████▊ | 14/16 [00:00<00:00, 45.87it/s]100%|██████████| 16/16 [00:02<00:00,  5.70it/s]
2025-03-09 09:31:11,783 [INFO]: 	Computing best hyperparameters for index knn.index 03/09/2025, 09:31:11
2025-03-09 09:31:50,241 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 38.4580 secs
2025-03-09 09:31:50,241 [INFO]: The best hyperparameters are: efSearch=321
2025-03-09 09:31:50,241 [INFO]: 	Compute fast metrics 03/09/2025, 09:31:50
  0%|          | 0/4 [00:00<?, ?it/s] 75%|███████▌  | 3/4 [00:00<00:00, 25.54it/s] 75%|███████▌  | 3/4 [00:00<00:00, 22.12it/s]
2025-03-09 09:32:07,935 [INFO]: 	>>> Finished "Compute fast metrics" in 17.6937 secs
2025-03-09 09:32:07,937 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 58.9692 secs
2025-03-09 09:32:07,937 [INFO]: {
2025-03-09 09:32:07,937 [INFO]: 	index_key: HNSW15
2025-03-09 09:32:07,937 [INFO]: 	index_param: efSearch=321
2025-03-09 09:32:07,937 [INFO]: 	index_path: knn.index
2025-03-09 09:32:07,937 [INFO]: 	size in bytes: 783434770
2025-03-09 09:32:07,937 [INFO]: 	avg_search_speed_ms: 11.779504169976542
2025-03-09 09:32:07,937 [INFO]: 	99p_search_speed_ms: 24.809012934565516
2025-03-09 09:32:07,937 [INFO]: 	reconstruction error %: 0.0
2025-03-09 09:32:07,937 [INFO]: 	nb vectors: 3982
2025-03-09 09:32:07,937 [INFO]: 	vectors dimension: 49152
2025-03-09 09:32:07,937 [INFO]: 	compression ratio: 0.9993085397524545
2025-03-09 09:32:07,938 [INFO]: }
2025-03-09 09:32:07,938 [INFO]: 	>>> Finished "Creating the index" in 58.9734 secs
2025-03-09 09:32:07,938 [INFO]: >>> Finished "Launching the whole pipeline" in 59.0124 secs
2025-03-09 09:32:09: [retrieval_preprocessing] calculating distances ...
2025-03-09 09:32:10: [retrieval_preprocessing] finished and saved retrieval indices for episode 42131 [episode count 12/20]
[retrieval_preprocessing] for episode 83218 [episode count 13/20], we have num_retrieval=np.int64(4071) num_query=np.int64(183)
2025-03-09 09:32:10,980 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-09 09:32:11,528 [INFO]: Launching the whole pipeline 03/09/2025, 09:32:11
2025-03-09 09:32:11,528 [INFO]: Reading total number of vectors and dimension 03/09/2025, 09:32:11
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1714.76it/s]
2025-03-09 09:32:11,559 [INFO]: There are 4071 embeddings of dim 49152
2025-03-09 09:32:11,559 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0308 secs
2025-03-09 09:32:11,559 [INFO]: 	Compute estimated construction time of the index 03/09/2025, 09:32:11
2025-03-09 09:32:11,559 [INFO]: 		-> Train: 16.7 minutes
2025-03-09 09:32:11,559 [INFO]: 		-> Add: 2.2 seconds
2025-03-09 09:32:11,559 [INFO]: 		Total: 16.7 minutes
2025-03-09 09:32:11,559 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0002 secs
2025-03-09 09:32:11,559 [INFO]: 	Checking that your have enough memory available to create the index 03/09/2025, 09:32:11
2025-03-09 09:32:11,559 [INFO]: 840.2MB of memory will be needed to build the index (more might be used if you have more)
2025-03-09 09:32:11,559 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0001 secs
2025-03-09 09:32:11,559 [INFO]: 	Selecting most promising index types given data characteristics 03/09/2025, 09:32:11
2025-03-09 09:32:11,559 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-09 09:32:11,559 [INFO]: 	Creating the index 03/09/2025, 09:32:11
2025-03-09 09:32:11,559 [INFO]: 		-> Instanciate the index HNSW15 03/09/2025, 09:32:11
2025-03-09 09:32:11,560 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0010 secs
2025-03-09 09:32:11,560 [INFO]: 		-> Adding the vectors to the index 03/09/2025, 09:32:11
2025-03-09 09:32:11,561 [INFO]: The memory available for adding the vectors is 49.3GB(total available - used by the index)
2025-03-09 09:32:11,561 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/17 [00:00<?, ?it/s] 12%|█▏        | 2/17 [00:00<00:00, 17.12it/s] 47%|████▋     | 8/17 [00:00<00:00, 36.93it/s] 76%|███████▋  | 13/17 [00:00<00:00, 41.01it/s]100%|██████████| 17/17 [00:03<00:00,  5.24it/s]
2025-03-09 09:32:14,809 [INFO]: 	Computing best hyperparameters for index knn.index 03/09/2025, 09:32:14
2025-03-09 09:32:49,353 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 34.5438 secs
2025-03-09 09:32:49,354 [INFO]: The best hyperparameters are: efSearch=304
2025-03-09 09:32:49,354 [INFO]: 	Compute fast metrics 03/09/2025, 09:32:49
  0%|          | 0/4 [00:00<?, ?it/s] 50%|█████     | 2/4 [00:00<00:00, 18.62it/s] 75%|███████▌  | 3/4 [00:00<00:00, 20.65it/s]
2025-03-09 09:33:08,719 [INFO]: 	>>> Finished "Compute fast metrics" in 19.3652 secs
2025-03-09 09:33:08,721 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 57.1608 secs
2025-03-09 09:33:08,722 [INFO]: {
2025-03-09 09:33:08,722 [INFO]: 	index_key: HNSW15
2025-03-09 09:33:08,722 [INFO]: 	index_param: efSearch=304
2025-03-09 09:33:08,722 [INFO]: 	index_path: knn.index
2025-03-09 09:33:08,722 [INFO]: 	size in bytes: 800944870
2025-03-09 09:33:08,722 [INFO]: 	avg_search_speed_ms: 11.06621483876576
2025-03-09 09:33:08,722 [INFO]: 	99p_search_speed_ms: 18.48937815986574
2025-03-09 09:33:08,722 [INFO]: 	reconstruction error %: 0.0
2025-03-09 09:33:08,722 [INFO]: 	nb vectors: 4071
2025-03-09 09:33:08,722 [INFO]: 	vectors dimension: 49152
2025-03-09 09:33:08,722 [INFO]: 	compression ratio: 0.9993086889987821
2025-03-09 09:33:08,722 [INFO]: }
2025-03-09 09:33:08,722 [INFO]: 	>>> Finished "Creating the index" in 57.1623 secs
2025-03-09 09:33:08,722 [INFO]: >>> Finished "Launching the whole pipeline" in 57.1938 secs
2025-03-09 09:33:09: [retrieval_preprocessing] calculating distances ...
2025-03-09 09:33:10: [retrieval_preprocessing] finished and saved retrieval indices for episode 83218 [episode count 13/20]
[retrieval_preprocessing] for episode 93583 [episode count 14/20], we have num_retrieval=np.int64(4093) num_query=np.int64(161)
2025-03-09 09:33:10,941 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-09 09:33:11,599 [INFO]: Launching the whole pipeline 03/09/2025, 09:33:11
2025-03-09 09:33:11,600 [INFO]: Reading total number of vectors and dimension 03/09/2025, 09:33:11
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 951.74it/s]
2025-03-09 09:33:11,637 [INFO]: There are 4093 embeddings of dim 49152
2025-03-09 09:33:11,638 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0383 secs
2025-03-09 09:33:11,638 [INFO]: 	Compute estimated construction time of the index 03/09/2025, 09:33:11
2025-03-09 09:33:11,639 [INFO]: 		-> Train: 16.7 minutes
2025-03-09 09:33:11,639 [INFO]: 		-> Add: 2.2 seconds
2025-03-09 09:33:11,639 [INFO]: 		Total: 16.7 minutes
2025-03-09 09:33:11,639 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0008 secs
2025-03-09 09:33:11,640 [INFO]: 	Checking that your have enough memory available to create the index 03/09/2025, 09:33:11
2025-03-09 09:33:11,640 [INFO]: 844.7MB of memory will be needed to build the index (more might be used if you have more)
2025-03-09 09:33:11,641 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0007 secs
2025-03-09 09:33:11,641 [INFO]: 	Selecting most promising index types given data characteristics 03/09/2025, 09:33:11
2025-03-09 09:33:11,641 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-09 09:33:11,642 [INFO]: 	Creating the index 03/09/2025, 09:33:11
2025-03-09 09:33:11,642 [INFO]: 		-> Instanciate the index HNSW15 03/09/2025, 09:33:11
2025-03-09 09:33:11,645 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0033 secs
2025-03-09 09:33:11,646 [INFO]: 		-> Adding the vectors to the index 03/09/2025, 09:33:11
2025-03-09 09:33:11,646 [INFO]: The memory available for adding the vectors is 49.3GB(total available - used by the index)
2025-03-09 09:33:11,646 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/17 [00:00<?, ?it/s]  6%|▌         | 1/17 [00:00<00:02,  6.84it/s] 24%|██▎       | 4/17 [00:00<00:00, 17.31it/s] 53%|█████▎    | 9/17 [00:00<00:00, 28.75it/s] 82%|████████▏ | 14/17 [00:00<00:00, 35.47it/s]100%|██████████| 17/17 [00:03<00:00,  5.56it/s]
2025-03-09 09:33:14,710 [INFO]: 	Computing best hyperparameters for index knn.index 03/09/2025, 09:33:14
2025-03-09 09:33:52,766 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 38.0564 secs
2025-03-09 09:33:52,767 [INFO]: The best hyperparameters are: efSearch=292
2025-03-09 09:33:52,767 [INFO]: 	Compute fast metrics 03/09/2025, 09:33:52
  0%|          | 0/4 [00:00<?, ?it/s] 50%|█████     | 2/4 [00:00<00:00, 18.83it/s] 75%|███████▌  | 3/4 [00:00<00:00, 20.81it/s]
2025-03-09 09:34:13,863 [INFO]: 	>>> Finished "Compute fast metrics" in 21.0964 secs
2025-03-09 09:34:13,866 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 62.2199 secs
2025-03-09 09:34:13,866 [INFO]: {
2025-03-09 09:34:13,866 [INFO]: 	index_key: HNSW15
2025-03-09 09:34:13,866 [INFO]: 	index_param: efSearch=292
2025-03-09 09:34:13,866 [INFO]: 	index_path: knn.index
2025-03-09 09:34:13,866 [INFO]: 	size in bytes: 805273270
2025-03-09 09:34:13,866 [INFO]: 	avg_search_speed_ms: 9.731983576388487
2025-03-09 09:34:13,866 [INFO]: 	99p_search_speed_ms: 19.646337837912142
2025-03-09 09:34:13,866 [INFO]: 	reconstruction error %: 0.0
2025-03-09 09:34:13,866 [INFO]: 	nb vectors: 4093
2025-03-09 09:34:13,866 [INFO]: 	vectors dimension: 49152
2025-03-09 09:34:13,866 [INFO]: 	compression ratio: 0.9993086495966766
2025-03-09 09:34:13,866 [INFO]: }
2025-03-09 09:34:13,866 [INFO]: 	>>> Finished "Creating the index" in 62.2244 secs
2025-03-09 09:34:13,866 [INFO]: >>> Finished "Launching the whole pipeline" in 62.2666 secs
2025-03-09 09:34:14: [retrieval_preprocessing] calculating distances ...
2025-03-09 09:34:15: [retrieval_preprocessing] finished and saved retrieval indices for episode 93583 [episode count 14/20]
[retrieval_preprocessing] for episode 85528 [episode count 15/20], we have num_retrieval=np.int64(4017) num_query=np.int64(237)
2025-03-09 09:34:15,525 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-09 09:34:15,997 [INFO]: Launching the whole pipeline 03/09/2025, 09:34:15
2025-03-09 09:34:15,997 [INFO]: Reading total number of vectors and dimension 03/09/2025, 09:34:15
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1226.76it/s]
2025-03-09 09:34:16,022 [INFO]: There are 4017 embeddings of dim 49152
2025-03-09 09:34:16,022 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0249 secs
2025-03-09 09:34:16,022 [INFO]: 	Compute estimated construction time of the index 03/09/2025, 09:34:16
2025-03-09 09:34:16,022 [INFO]: 		-> Train: 16.7 minutes
2025-03-09 09:34:16,022 [INFO]: 		-> Add: 2.2 seconds
2025-03-09 09:34:16,022 [INFO]: 		Total: 16.7 minutes
2025-03-09 09:34:16,022 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0001 secs
2025-03-09 09:34:16,022 [INFO]: 	Checking that your have enough memory available to create the index 03/09/2025, 09:34:16
2025-03-09 09:34:16,022 [INFO]: 829.0MB of memory will be needed to build the index (more might be used if you have more)
2025-03-09 09:34:16,023 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0001 secs
2025-03-09 09:34:16,023 [INFO]: 	Selecting most promising index types given data characteristics 03/09/2025, 09:34:16
2025-03-09 09:34:16,023 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-09 09:34:16,023 [INFO]: 	Creating the index 03/09/2025, 09:34:16
2025-03-09 09:34:16,023 [INFO]: 		-> Instanciate the index HNSW15 03/09/2025, 09:34:16
2025-03-09 09:34:16,024 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0009 secs
2025-03-09 09:34:16,024 [INFO]: 		-> Adding the vectors to the index 03/09/2025, 09:34:16
2025-03-09 09:34:16,024 [INFO]: The memory available for adding the vectors is 49.3GB(total available - used by the index)
2025-03-09 09:34:16,024 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/16 [00:00<?, ?it/s] 12%|█▎        | 2/16 [00:00<00:00, 18.16it/s] 56%|█████▋    | 9/16 [00:00<00:00, 45.05it/s]100%|██████████| 16/16 [00:03<00:00,  3.99it/s]100%|██████████| 16/16 [00:03<00:00,  4.82it/s]
2025-03-09 09:34:19,348 [INFO]: 	Computing best hyperparameters for index knn.index 03/09/2025, 09:34:19
2025-03-09 09:34:55,941 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 36.5930 secs
2025-03-09 09:34:55,941 [INFO]: The best hyperparameters are: efSearch=280
2025-03-09 09:34:55,941 [INFO]: 	Compute fast metrics 03/09/2025, 09:34:55
  0%|          | 0/4 [00:00<?, ?it/s] 75%|███████▌  | 3/4 [00:00<00:00, 24.90it/s] 75%|███████▌  | 3/4 [00:00<00:00, 21.06it/s]
2025-03-09 09:35:12,979 [INFO]: 	>>> Finished "Compute fast metrics" in 17.0371 secs
2025-03-09 09:35:14,062 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 58.0386 secs
2025-03-09 09:35:14,063 [INFO]: {
2025-03-09 09:35:14,063 [INFO]: 	index_key: HNSW15
2025-03-09 09:35:14,063 [INFO]: 	index_param: efSearch=280
2025-03-09 09:35:14,063 [INFO]: 	index_path: knn.index
2025-03-09 09:35:14,063 [INFO]: 	size in bytes: 790320850
2025-03-09 09:35:14,063 [INFO]: 	avg_search_speed_ms: 10.970044586237668
2025-03-09 09:35:14,063 [INFO]: 	99p_search_speed_ms: 27.290519825182855
2025-03-09 09:35:14,063 [INFO]: 	reconstruction error %: 0.0
2025-03-09 09:35:14,063 [INFO]: 	nb vectors: 4017
2025-03-09 09:35:14,063 [INFO]: 	vectors dimension: 49152
2025-03-09 09:35:14,063 [INFO]: 	compression ratio: 0.9993084909755323
2025-03-09 09:35:14,063 [INFO]: }
2025-03-09 09:35:14,063 [INFO]: 	>>> Finished "Creating the index" in 58.0408 secs
2025-03-09 09:35:14,063 [INFO]: >>> Finished "Launching the whole pipeline" in 58.0662 secs
2025-03-09 09:35:15: [retrieval_preprocessing] calculating distances ...
2025-03-09 09:35:16: [retrieval_preprocessing] finished and saved retrieval indices for episode 85528 [episode count 15/20]
[retrieval_preprocessing] for episode 37659 [episode count 16/20], we have num_retrieval=np.int64(4070) num_query=np.int64(184)
2025-03-09 09:35:16,998 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-09 09:35:17,712 [INFO]: Launching the whole pipeline 03/09/2025, 09:35:17
2025-03-09 09:35:17,712 [INFO]: Reading total number of vectors and dimension 03/09/2025, 09:35:17
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1953.56it/s]
2025-03-09 09:35:17,747 [INFO]: There are 4070 embeddings of dim 49152
2025-03-09 09:35:17,747 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0350 secs
2025-03-09 09:35:17,747 [INFO]: 	Compute estimated construction time of the index 03/09/2025, 09:35:17
2025-03-09 09:35:17,747 [INFO]: 		-> Train: 16.7 minutes
2025-03-09 09:35:17,747 [INFO]: 		-> Add: 2.2 seconds
2025-03-09 09:35:17,747 [INFO]: 		Total: 16.7 minutes
2025-03-09 09:35:17,747 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0001 secs
2025-03-09 09:35:17,747 [INFO]: 	Checking that your have enough memory available to create the index 03/09/2025, 09:35:17
2025-03-09 09:35:17,748 [INFO]: 839.9MB of memory will be needed to build the index (more might be used if you have more)
2025-03-09 09:35:17,748 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0002 secs
2025-03-09 09:35:17,748 [INFO]: 	Selecting most promising index types given data characteristics 03/09/2025, 09:35:17
2025-03-09 09:35:17,748 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-09 09:35:17,748 [INFO]: 	Creating the index 03/09/2025, 09:35:17
2025-03-09 09:35:17,748 [INFO]: 		-> Instanciate the index HNSW15 03/09/2025, 09:35:17
2025-03-09 09:35:17,749 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0013 secs
2025-03-09 09:35:17,749 [INFO]: 		-> Adding the vectors to the index 03/09/2025, 09:35:17
2025-03-09 09:35:17,749 [INFO]: The memory available for adding the vectors is 49.3GB(total available - used by the index)
2025-03-09 09:35:17,749 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/17 [00:00<?, ?it/s]  6%|▌         | 1/17 [00:00<00:01,  8.48it/s] 35%|███▌      | 6/17 [00:00<00:00, 27.88it/s] 65%|██████▍   | 11/17 [00:00<00:00, 34.10it/s] 88%|████████▊ | 15/17 [00:00<00:00, 29.41it/s]100%|██████████| 17/17 [00:03<00:00,  4.64it/s]
2025-03-09 09:35:21,416 [INFO]: 	Computing best hyperparameters for index knn.index 03/09/2025, 09:35:21
2025-03-09 09:35:58,337 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 36.9207 secs
2025-03-09 09:35:58,337 [INFO]: The best hyperparameters are: efSearch=177
2025-03-09 09:35:58,337 [INFO]: 	Compute fast metrics 03/09/2025, 09:35:58
  0%|          | 0/4 [00:00<?, ?it/s] 50%|█████     | 2/4 [00:00<00:00, 18.47it/s] 75%|███████▌  | 3/4 [00:00<00:00, 20.27it/s]
2025-03-09 09:36:15,282 [INFO]: 	>>> Finished "Compute fast metrics" in 16.9448 secs
2025-03-09 09:36:15,286 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 57.5372 secs
2025-03-09 09:36:15,287 [INFO]: {
2025-03-09 09:36:15,287 [INFO]: 	index_key: HNSW15
2025-03-09 09:36:15,287 [INFO]: 	index_param: efSearch=177
2025-03-09 09:36:15,287 [INFO]: 	index_path: knn.index
2025-03-09 09:36:15,287 [INFO]: 	size in bytes: 800748130
2025-03-09 09:36:15,287 [INFO]: 	avg_search_speed_ms: 7.810296854665859
2025-03-09 09:36:15,287 [INFO]: 	99p_search_speed_ms: 16.691216966137294
2025-03-09 09:36:15,287 [INFO]: 	reconstruction error %: 0.0
2025-03-09 09:36:15,287 [INFO]: 	nb vectors: 4070
2025-03-09 09:36:15,287 [INFO]: 	vectors dimension: 49152
2025-03-09 09:36:15,287 [INFO]: 	compression ratio: 0.9993086839928056
2025-03-09 09:36:15,287 [INFO]: }
2025-03-09 09:36:15,287 [INFO]: 	>>> Finished "Creating the index" in 57.5392 secs
2025-03-09 09:36:15,287 [INFO]: >>> Finished "Launching the whole pipeline" in 57.5751 secs
2025-03-09 09:36:16: [retrieval_preprocessing] calculating distances ...
2025-03-09 09:36:16: [retrieval_preprocessing] finished and saved retrieval indices for episode 37659 [episode count 16/20]
[retrieval_preprocessing] for episode 2716 [episode count 17/20], we have num_retrieval=np.int64(4067) num_query=np.int64(187)
2025-03-09 09:36:17,506 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-09 09:36:18,037 [INFO]: Launching the whole pipeline 03/09/2025, 09:36:18
2025-03-09 09:36:18,037 [INFO]: Reading total number of vectors and dimension 03/09/2025, 09:36:18
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1343.47it/s]
2025-03-09 09:36:18,070 [INFO]: There are 4067 embeddings of dim 49152
2025-03-09 09:36:18,071 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0330 secs
2025-03-09 09:36:18,071 [INFO]: 	Compute estimated construction time of the index 03/09/2025, 09:36:18
2025-03-09 09:36:18,071 [INFO]: 		-> Train: 16.7 minutes
2025-03-09 09:36:18,071 [INFO]: 		-> Add: 2.2 seconds
2025-03-09 09:36:18,071 [INFO]: 		Total: 16.7 minutes
2025-03-09 09:36:18,071 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0002 secs
2025-03-09 09:36:18,071 [INFO]: 	Checking that your have enough memory available to create the index 03/09/2025, 09:36:18
2025-03-09 09:36:18,071 [INFO]: 839.3MB of memory will be needed to build the index (more might be used if you have more)
2025-03-09 09:36:18,071 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0002 secs
2025-03-09 09:36:18,071 [INFO]: 	Selecting most promising index types given data characteristics 03/09/2025, 09:36:18
2025-03-09 09:36:18,071 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-09 09:36:18,071 [INFO]: 	Creating the index 03/09/2025, 09:36:18
2025-03-09 09:36:18,071 [INFO]: 		-> Instanciate the index HNSW15 03/09/2025, 09:36:18
2025-03-09 09:36:18,072 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0011 secs
2025-03-09 09:36:18,073 [INFO]: 		-> Adding the vectors to the index 03/09/2025, 09:36:18
2025-03-09 09:36:18,073 [INFO]: The memory available for adding the vectors is 49.3GB(total available - used by the index)
2025-03-09 09:36:18,073 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/17 [00:00<?, ?it/s]  6%|▌         | 1/17 [00:00<00:01,  9.54it/s] 41%|████      | 7/17 [00:00<00:00, 36.60it/s] 76%|███████▋  | 13/17 [00:00<00:00, 44.91it/s]100%|██████████| 17/17 [00:03<00:00,  5.35it/s]
2025-03-09 09:36:21,254 [INFO]: 	Computing best hyperparameters for index knn.index 03/09/2025, 09:36:21
2025-03-09 09:37:04,373 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 43.1180 secs
2025-03-09 09:37:04,373 [INFO]: The best hyperparameters are: efSearch=259
2025-03-09 09:37:04,374 [INFO]: 	Compute fast metrics 03/09/2025, 09:37:04
  0%|          | 0/4 [00:00<?, ?it/s] 25%|██▌       | 1/4 [00:00<00:00,  4.60it/s] 50%|█████     | 2/4 [00:00<00:00,  6.25it/s] 75%|███████▌  | 3/4 [00:00<00:00,  6.86it/s] 75%|███████▌  | 3/4 [00:00<00:00,  5.15it/s]
2025-03-09 09:37:21,313 [INFO]: 	>>> Finished "Compute fast metrics" in 16.9396 secs
2025-03-09 09:37:21,316 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 63.2437 secs
2025-03-09 09:37:21,317 [INFO]: {
2025-03-09 09:37:21,317 [INFO]: 	index_key: HNSW15
2025-03-09 09:37:21,317 [INFO]: 	index_param: efSearch=259
2025-03-09 09:37:21,317 [INFO]: 	index_path: knn.index
2025-03-09 09:37:21,317 [INFO]: 	size in bytes: 800157910
2025-03-09 09:37:21,317 [INFO]: 	avg_search_speed_ms: 11.605576374368399
2025-03-09 09:37:21,317 [INFO]: 	99p_search_speed_ms: 23.531957902014256
2025-03-09 09:37:21,317 [INFO]: 	reconstruction error %: 0.0
2025-03-09 09:37:21,317 [INFO]: 	nb vectors: 4067
2025-03-09 09:37:21,317 [INFO]: 	vectors dimension: 49152
2025-03-09 09:37:21,317 [INFO]: 	compression ratio: 0.9993086689601056
2025-03-09 09:37:21,317 [INFO]: }
2025-03-09 09:37:21,317 [INFO]: 	>>> Finished "Creating the index" in 63.2454 secs
2025-03-09 09:37:21,317 [INFO]: >>> Finished "Launching the whole pipeline" in 63.2793 secs
2025-03-09 09:37:22: [retrieval_preprocessing] calculating distances ...
2025-03-09 09:37:23: [retrieval_preprocessing] finished and saved retrieval indices for episode 2716 [episode count 17/20]
[retrieval_preprocessing] for episode 39710 [episode count 18/20], we have num_retrieval=np.int64(4005) num_query=np.int64(249)
2025-03-09 09:37:23,552 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-09 09:37:24,034 [INFO]: Launching the whole pipeline 03/09/2025, 09:37:24
2025-03-09 09:37:24,034 [INFO]: Reading total number of vectors and dimension 03/09/2025, 09:37:24
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1140.38it/s]
2025-03-09 09:37:24,065 [INFO]: There are 4005 embeddings of dim 49152
2025-03-09 09:37:24,065 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0311 secs
2025-03-09 09:37:24,065 [INFO]: 	Compute estimated construction time of the index 03/09/2025, 09:37:24
2025-03-09 09:37:24,066 [INFO]: 		-> Train: 16.7 minutes
2025-03-09 09:37:24,066 [INFO]: 		-> Add: 2.2 seconds
2025-03-09 09:37:24,066 [INFO]: 		Total: 16.7 minutes
2025-03-09 09:37:24,066 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0001 secs
2025-03-09 09:37:24,066 [INFO]: 	Checking that your have enough memory available to create the index 03/09/2025, 09:37:24
2025-03-09 09:37:24,066 [INFO]: 826.5MB of memory will be needed to build the index (more might be used if you have more)
2025-03-09 09:37:24,066 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0001 secs
2025-03-09 09:37:24,066 [INFO]: 	Selecting most promising index types given data characteristics 03/09/2025, 09:37:24
2025-03-09 09:37:24,066 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-09 09:37:24,066 [INFO]: 	Creating the index 03/09/2025, 09:37:24
2025-03-09 09:37:24,066 [INFO]: 		-> Instanciate the index HNSW15 03/09/2025, 09:37:24
2025-03-09 09:37:24,067 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0010 secs
2025-03-09 09:37:24,067 [INFO]: 		-> Adding the vectors to the index 03/09/2025, 09:37:24
2025-03-09 09:37:24,067 [INFO]: The memory available for adding the vectors is 49.3GB(total available - used by the index)
2025-03-09 09:37:24,067 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/16 [00:00<?, ?it/s]  6%|▋         | 1/16 [00:00<00:01,  9.97it/s] 31%|███▏      | 5/16 [00:00<00:00, 25.81it/s] 50%|█████     | 8/16 [00:00<00:00, 24.24it/s] 88%|████████▊ | 14/16 [00:00<00:00, 36.04it/s]100%|██████████| 16/16 [00:03<00:00,  4.97it/s]
2025-03-09 09:37:27,293 [INFO]: 	Computing best hyperparameters for index knn.index 03/09/2025, 09:37:27
2025-03-09 09:38:04,115 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 36.8214 secs
2025-03-09 09:38:04,115 [INFO]: The best hyperparameters are: efSearch=268
2025-03-09 09:38:04,115 [INFO]: 	Compute fast metrics 03/09/2025, 09:38:04
  0%|          | 0/4 [00:00<?, ?it/s] 50%|█████     | 2/4 [00:00<00:00, 18.81it/s] 75%|███████▌  | 3/4 [00:00<00:00, 20.32it/s]
2025-03-09 09:38:19,800 [INFO]: 	>>> Finished "Compute fast metrics" in 15.6843 secs
2025-03-09 09:38:19,803 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 55.7357 secs
2025-03-09 09:38:19,803 [INFO]: {
2025-03-09 09:38:19,803 [INFO]: 	index_key: HNSW15
2025-03-09 09:38:19,803 [INFO]: 	index_param: efSearch=268
2025-03-09 09:38:19,803 [INFO]: 	index_path: knn.index
2025-03-09 09:38:19,803 [INFO]: 	size in bytes: 787959850
2025-03-09 09:38:19,803 [INFO]: 	avg_search_speed_ms: 11.02931518004971
2025-03-09 09:38:19,803 [INFO]: 	99p_search_speed_ms: 21.612309482879937
2025-03-09 09:38:19,803 [INFO]: 	reconstruction error %: 0.0
2025-03-09 09:38:19,803 [INFO]: 	nb vectors: 4005
2025-03-09 09:38:19,803 [INFO]: 	vectors dimension: 49152
2025-03-09 09:38:19,803 [INFO]: 	compression ratio: 0.9993085815222692
2025-03-09 09:38:19,803 [INFO]: }
2025-03-09 09:38:19,803 [INFO]: 	>>> Finished "Creating the index" in 55.7374 secs
2025-03-09 09:38:19,803 [INFO]: >>> Finished "Launching the whole pipeline" in 55.7691 secs
2025-03-09 09:38:21: [retrieval_preprocessing] calculating distances ...
2025-03-09 09:38:22: [retrieval_preprocessing] finished and saved retrieval indices for episode 39710 [episode count 18/20]
[retrieval_preprocessing] for episode 76831 [episode count 19/20], we have num_retrieval=np.int64(4087) num_query=np.int64(167)
2025-03-09 09:38:23,975 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-09 09:38:24,737 [INFO]: Launching the whole pipeline 03/09/2025, 09:38:24
2025-03-09 09:38:24,737 [INFO]: Reading total number of vectors and dimension 03/09/2025, 09:38:24
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1389.76it/s]
2025-03-09 09:38:24,878 [INFO]: There are 4087 embeddings of dim 49152
2025-03-09 09:38:24,879 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.1412 secs
2025-03-09 09:38:24,879 [INFO]: 	Compute estimated construction time of the index 03/09/2025, 09:38:24
2025-03-09 09:38:24,879 [INFO]: 		-> Train: 16.7 minutes
2025-03-09 09:38:24,879 [INFO]: 		-> Add: 2.2 seconds
2025-03-09 09:38:24,879 [INFO]: 		Total: 16.7 minutes
2025-03-09 09:38:24,880 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0004 secs
2025-03-09 09:38:24,880 [INFO]: 	Checking that your have enough memory available to create the index 03/09/2025, 09:38:24
2025-03-09 09:38:24,880 [INFO]: 843.5MB of memory will be needed to build the index (more might be used if you have more)
2025-03-09 09:38:24,880 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0005 secs
2025-03-09 09:38:24,880 [INFO]: 	Selecting most promising index types given data characteristics 03/09/2025, 09:38:24
2025-03-09 09:38:24,881 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-09 09:38:24,881 [INFO]: 	Creating the index 03/09/2025, 09:38:24
2025-03-09 09:38:24,881 [INFO]: 		-> Instanciate the index HNSW15 03/09/2025, 09:38:24
2025-03-09 09:38:24,884 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0029 secs
2025-03-09 09:38:24,884 [INFO]: 		-> Adding the vectors to the index 03/09/2025, 09:38:24
2025-03-09 09:38:24,884 [INFO]: The memory available for adding the vectors is 49.3GB(total available - used by the index)
2025-03-09 09:38:24,884 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/17 [00:00<?, ?it/s] 12%|█▏        | 2/17 [00:00<00:00, 18.07it/s] 53%|█████▎    | 9/17 [00:00<00:00, 43.67it/s] 94%|█████████▍| 16/17 [00:00<00:00, 51.87it/s]100%|██████████| 17/17 [00:03<00:00,  5.33it/s]
2025-03-09 09:38:28,077 [INFO]: 	Computing best hyperparameters for index knn.index 03/09/2025, 09:38:28
2025-03-09 09:39:10,762 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 42.6850 secs
2025-03-09 09:39:10,762 [INFO]: The best hyperparameters are: efSearch=302
2025-03-09 09:39:10,762 [INFO]: 	Compute fast metrics 03/09/2025, 09:39:10
  0%|          | 0/4 [00:00<?, ?it/s] 25%|██▌       | 1/4 [00:00<00:00,  9.79it/s] 75%|███████▌  | 3/4 [00:00<00:00, 17.55it/s]
2025-03-09 09:39:30,801 [INFO]: 	>>> Finished "Compute fast metrics" in 20.0391 secs
2025-03-09 09:39:30,804 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 65.9195 secs
2025-03-09 09:39:30,804 [INFO]: {
2025-03-09 09:39:30,804 [INFO]: 	index_key: HNSW15
2025-03-09 09:39:30,804 [INFO]: 	index_param: efSearch=302
2025-03-09 09:39:30,804 [INFO]: 	index_path: knn.index
2025-03-09 09:39:30,804 [INFO]: 	size in bytes: 804092830
2025-03-09 09:39:30,804 [INFO]: 	avg_search_speed_ms: 10.103756769541462
2025-03-09 09:39:30,804 [INFO]: 	99p_search_speed_ms: 18.241997114382688
2025-03-09 09:39:30,804 [INFO]: 	reconstruction error %: 0.0
2025-03-09 09:39:30,804 [INFO]: 	nb vectors: 4087
2025-03-09 09:39:30,804 [INFO]: 	vectors dimension: 49152
2025-03-09 09:39:30,804 [INFO]: 	compression ratio: 0.9993086196279104
2025-03-09 09:39:30,804 [INFO]: }
2025-03-09 09:39:30,804 [INFO]: 	>>> Finished "Creating the index" in 65.9233 secs
2025-03-09 09:39:30,804 [INFO]: >>> Finished "Launching the whole pipeline" in 66.0666 secs
2025-03-09 09:39:31: [retrieval_preprocessing] calculating distances ...
2025-03-09 09:39:32: [retrieval_preprocessing] finished and saved retrieval indices for episode 76831 [episode count 19/20]
2025-03-09 09:39:32: [retrieval_preprocessing] finished for (6357288647, 'lid') [chosen_id count 8/10]
2025-03-09 09:39:34: [retrieval_preprocessing] concatenated all embeddings and indices for 20 episodes for (5701580274, 'marker') [chosen_id count 9/10]
2025-03-09 09:39:34: [retrieval_preprocessing] we have num_total=4194 embedding_dim=49152
[retrieval_preprocessing] for episode 28419 [episode count 0/20], we have num_retrieval=np.int64(3966) num_query=np.int64(228)
2025-03-09 09:39:34,442 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-09 09:39:34,905 [INFO]: Launching the whole pipeline 03/09/2025, 09:39:34
2025-03-09 09:39:34,906 [INFO]: Reading total number of vectors and dimension 03/09/2025, 09:39:34
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1496.36it/s]
2025-03-09 09:39:34,935 [INFO]: There are 3966 embeddings of dim 49152
2025-03-09 09:39:34,935 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0295 secs
2025-03-09 09:39:34,935 [INFO]: 	Compute estimated construction time of the index 03/09/2025, 09:39:34
2025-03-09 09:39:34,935 [INFO]: 		-> Train: 16.7 minutes
2025-03-09 09:39:34,935 [INFO]: 		-> Add: 2.2 seconds
2025-03-09 09:39:34,935 [INFO]: 		Total: 16.7 minutes
2025-03-09 09:39:34,935 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0001 secs
2025-03-09 09:39:34,935 [INFO]: 	Checking that your have enough memory available to create the index 03/09/2025, 09:39:34
2025-03-09 09:39:34,935 [INFO]: 818.5MB of memory will be needed to build the index (more might be used if you have more)
2025-03-09 09:39:34,936 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0002 secs
2025-03-09 09:39:34,936 [INFO]: 	Selecting most promising index types given data characteristics 03/09/2025, 09:39:34
2025-03-09 09:39:34,936 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-09 09:39:34,936 [INFO]: 	Creating the index 03/09/2025, 09:39:34
2025-03-09 09:39:34,936 [INFO]: 		-> Instanciate the index HNSW15 03/09/2025, 09:39:34
2025-03-09 09:39:34,937 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0012 secs
2025-03-09 09:39:34,937 [INFO]: 		-> Adding the vectors to the index 03/09/2025, 09:39:34
2025-03-09 09:39:34,937 [INFO]: The memory available for adding the vectors is 49.3GB(total available - used by the index)
2025-03-09 09:39:34,937 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/16 [00:00<?, ?it/s]  6%|▋         | 1/16 [00:00<00:01,  9.82it/s] 44%|████▍     | 7/16 [00:00<00:00, 36.90it/s] 81%|████████▏ | 13/16 [00:00<00:00, 45.34it/s]100%|██████████| 16/16 [00:03<00:00,  4.69it/s]
2025-03-09 09:39:38,354 [INFO]: 	Computing best hyperparameters for index knn.index 03/09/2025, 09:39:38
2025-03-09 09:40:17,105 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 38.7504 secs
2025-03-09 09:40:17,105 [INFO]: The best hyperparameters are: efSearch=198
2025-03-09 09:40:17,105 [INFO]: 	Compute fast metrics 03/09/2025, 09:40:17
  0%|          | 0/4 [00:00<?, ?it/s] 50%|█████     | 2/4 [00:00<00:00, 18.29it/s] 75%|███████▌  | 3/4 [00:00<00:00, 19.82it/s]
2025-03-09 09:40:33,536 [INFO]: 	>>> Finished "Compute fast metrics" in 16.4301 secs
2025-03-09 09:40:33,538 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 58.6013 secs
2025-03-09 09:40:33,539 [INFO]: {
2025-03-09 09:40:33,539 [INFO]: 	index_key: HNSW15
2025-03-09 09:40:33,539 [INFO]: 	index_param: efSearch=198
2025-03-09 09:40:33,539 [INFO]: 	index_path: knn.index
2025-03-09 09:40:33,539 [INFO]: 	size in bytes: 780286870
2025-03-09 09:40:33,539 [INFO]: 	avg_search_speed_ms: 9.016827473373256
2025-03-09 09:40:33,539 [INFO]: 	99p_search_speed_ms: 19.079908756539236
2025-03-09 09:40:33,539 [INFO]: 	reconstruction error %: 0.0
2025-03-09 09:40:33,539 [INFO]: 	nb vectors: 3966
2025-03-09 09:40:33,539 [INFO]: 	vectors dimension: 49152
2025-03-09 09:40:33,539 [INFO]: 	compression ratio: 0.9993085337960383
2025-03-09 09:40:33,539 [INFO]: }
2025-03-09 09:40:33,539 [INFO]: 	>>> Finished "Creating the index" in 58.6031 secs
2025-03-09 09:40:33,539 [INFO]: >>> Finished "Launching the whole pipeline" in 58.6332 secs
2025-03-09 09:40:34: [retrieval_preprocessing] calculating distances ...
2025-03-09 09:40:35: [retrieval_preprocessing] finished and saved retrieval indices for episode 28419 [episode count 0/20]
[retrieval_preprocessing] for episode 36486 [episode count 1/20], we have num_retrieval=np.int64(3745) num_query=np.int64(449)
2025-03-09 09:40:35,489 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-09 09:40:36,021 [INFO]: Launching the whole pipeline 03/09/2025, 09:40:36
2025-03-09 09:40:36,021 [INFO]: Reading total number of vectors and dimension 03/09/2025, 09:40:36
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1088.02it/s]
2025-03-09 09:40:36,048 [INFO]: There are 3745 embeddings of dim 49152
2025-03-09 09:40:36,048 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0271 secs
2025-03-09 09:40:36,048 [INFO]: 	Compute estimated construction time of the index 03/09/2025, 09:40:36
2025-03-09 09:40:36,048 [INFO]: 		-> Train: 16.7 minutes
2025-03-09 09:40:36,048 [INFO]: 		-> Add: 2.1 seconds
2025-03-09 09:40:36,048 [INFO]: 		Total: 16.7 minutes
2025-03-09 09:40:36,048 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0001 secs
2025-03-09 09:40:36,048 [INFO]: 	Checking that your have enough memory available to create the index 03/09/2025, 09:40:36
2025-03-09 09:40:36,048 [INFO]: 772.9MB of memory will be needed to build the index (more might be used if you have more)
2025-03-09 09:40:36,048 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0002 secs
2025-03-09 09:40:36,048 [INFO]: 	Selecting most promising index types given data characteristics 03/09/2025, 09:40:36
2025-03-09 09:40:36,049 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-09 09:40:36,049 [INFO]: 	Creating the index 03/09/2025, 09:40:36
2025-03-09 09:40:36,049 [INFO]: 		-> Instanciate the index HNSW15 03/09/2025, 09:40:36
2025-03-09 09:40:36,050 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0011 secs
2025-03-09 09:40:36,050 [INFO]: 		-> Adding the vectors to the index 03/09/2025, 09:40:36
2025-03-09 09:40:36,050 [INFO]: The memory available for adding the vectors is 49.3GB(total available - used by the index)
2025-03-09 09:40:36,050 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/15 [00:00<?, ?it/s]  7%|▋         | 1/15 [00:00<00:01,  9.52it/s] 40%|████      | 6/15 [00:00<00:00, 32.00it/s] 73%|███████▎  | 11/15 [00:00<00:00, 39.47it/s]100%|██████████| 15/15 [00:03<00:00,  2.98it/s]100%|██████████| 15/15 [00:03<00:00,  4.15it/s]
2025-03-09 09:40:39,664 [INFO]: 	Computing best hyperparameters for index knn.index 03/09/2025, 09:40:39
2025-03-09 09:41:13,112 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 33.4479 secs
2025-03-09 09:41:13,112 [INFO]: The best hyperparameters are: efSearch=186
2025-03-09 09:41:13,113 [INFO]: 	Compute fast metrics 03/09/2025, 09:41:13
  0%|          | 0/4 [00:00<?, ?it/s] 75%|███████▌  | 3/4 [00:00<00:00, 25.42it/s] 75%|███████▌  | 3/4 [00:00<00:00, 21.91it/s]
2025-03-09 09:41:30,230 [INFO]: 	>>> Finished "Compute fast metrics" in 17.1170 secs
2025-03-09 09:41:30,232 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 54.1819 secs
2025-03-09 09:41:30,232 [INFO]: {
2025-03-09 09:41:30,232 [INFO]: 	index_key: HNSW15
2025-03-09 09:41:30,232 [INFO]: 	index_param: efSearch=186
2025-03-09 09:41:30,232 [INFO]: 	index_path: knn.index
2025-03-09 09:41:30,232 [INFO]: 	size in bytes: 736805950
2025-03-09 09:41:30,232 [INFO]: 	avg_search_speed_ms: 7.867759310352425
2025-03-09 09:41:30,232 [INFO]: 	99p_search_speed_ms: 16.991691640578175
2025-03-09 09:41:30,232 [INFO]: 	reconstruction error %: 0.0
2025-03-09 09:41:30,232 [INFO]: 	nb vectors: 3745
2025-03-09 09:41:30,232 [INFO]: 	vectors dimension: 49152
2025-03-09 09:41:30,232 [INFO]: 	compression ratio: 0.9993091939607708
2025-03-09 09:41:30,232 [INFO]: }
2025-03-09 09:41:30,232 [INFO]: 	>>> Finished "Creating the index" in 54.1834 secs
2025-03-09 09:41:30,232 [INFO]: >>> Finished "Launching the whole pipeline" in 54.2111 secs
2025-03-09 09:41:31: [retrieval_preprocessing] calculating distances ...
2025-03-09 09:41:33: [retrieval_preprocessing] finished and saved retrieval indices for episode 36486 [episode count 1/20]
[retrieval_preprocessing] for episode 95368 [episode count 2/20], we have num_retrieval=np.int64(3951) num_query=np.int64(243)
2025-03-09 09:41:33,564 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-09 09:41:34,089 [INFO]: Launching the whole pipeline 03/09/2025, 09:41:34
2025-03-09 09:41:34,090 [INFO]: Reading total number of vectors and dimension 03/09/2025, 09:41:34
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1155.14it/s]
2025-03-09 09:41:34,126 [INFO]: There are 3951 embeddings of dim 49152
2025-03-09 09:41:34,126 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0366 secs
2025-03-09 09:41:34,126 [INFO]: 	Compute estimated construction time of the index 03/09/2025, 09:41:34
2025-03-09 09:41:34,126 [INFO]: 		-> Train: 16.7 minutes
2025-03-09 09:41:34,127 [INFO]: 		-> Add: 2.2 seconds
2025-03-09 09:41:34,127 [INFO]: 		Total: 16.7 minutes
2025-03-09 09:41:34,127 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0002 secs
2025-03-09 09:41:34,127 [INFO]: 	Checking that your have enough memory available to create the index 03/09/2025, 09:41:34
2025-03-09 09:41:34,127 [INFO]: 815.4MB of memory will be needed to build the index (more might be used if you have more)
2025-03-09 09:41:34,127 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0005 secs
2025-03-09 09:41:34,127 [INFO]: 	Selecting most promising index types given data characteristics 03/09/2025, 09:41:34
2025-03-09 09:41:34,127 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-09 09:41:34,127 [INFO]: 	Creating the index 03/09/2025, 09:41:34
2025-03-09 09:41:34,128 [INFO]: 		-> Instanciate the index HNSW15 03/09/2025, 09:41:34
2025-03-09 09:41:34,130 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0020 secs
2025-03-09 09:41:34,130 [INFO]: 		-> Adding the vectors to the index 03/09/2025, 09:41:34
2025-03-09 09:41:34,130 [INFO]: The memory available for adding the vectors is 49.3GB(total available - used by the index)
2025-03-09 09:41:34,130 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/16 [00:00<?, ?it/s] 12%|█▎        | 2/16 [00:00<00:00, 18.02it/s] 44%|████▍     | 7/16 [00:00<00:00, 35.45it/s] 69%|██████▉   | 11/16 [00:00<00:00, 34.63it/s]100%|██████████| 16/16 [00:03<00:00,  3.60it/s]100%|██████████| 16/16 [00:03<00:00,  5.00it/s]
2025-03-09 09:41:37,333 [INFO]: 	Computing best hyperparameters for index knn.index 03/09/2025, 09:41:37
2025-03-09 09:42:11,068 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 33.7345 secs
2025-03-09 09:42:11,068 [INFO]: The best hyperparameters are: efSearch=194
2025-03-09 09:42:11,068 [INFO]: 	Compute fast metrics 03/09/2025, 09:42:11
  0%|          | 0/4 [00:00<?, ?it/s] 50%|█████     | 2/4 [00:00<00:00, 18.73it/s] 75%|███████▌  | 3/4 [00:00<00:00, 20.08it/s]
2025-03-09 09:42:25,078 [INFO]: 	>>> Finished "Compute fast metrics" in 14.0094 secs
2025-03-09 09:42:25,080 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 50.9502 secs
2025-03-09 09:42:25,080 [INFO]: {
2025-03-09 09:42:25,080 [INFO]: 	index_key: HNSW15
2025-03-09 09:42:25,080 [INFO]: 	index_param: efSearch=194
2025-03-09 09:42:25,080 [INFO]: 	index_path: knn.index
2025-03-09 09:42:25,080 [INFO]: 	size in bytes: 777335770
2025-03-09 09:42:25,080 [INFO]: 	avg_search_speed_ms: 8.501816650046365
2025-03-09 09:42:25,080 [INFO]: 	99p_search_speed_ms: 16.952960926573724
2025-03-09 09:42:25,080 [INFO]: 	reconstruction error %: 0.0
2025-03-09 09:42:25,080 [INFO]: 	nb vectors: 3951
2025-03-09 09:42:25,080 [INFO]: 	vectors dimension: 49152
2025-03-09 09:42:25,080 [INFO]: 	compression ratio: 0.9993084558555694
2025-03-09 09:42:25,080 [INFO]: }
2025-03-09 09:42:25,080 [INFO]: 	>>> Finished "Creating the index" in 50.9529 secs
2025-03-09 09:42:25,080 [INFO]: >>> Finished "Launching the whole pipeline" in 50.9909 secs
2025-03-09 09:42:26: [retrieval_preprocessing] calculating distances ...
2025-03-09 09:42:26: [retrieval_preprocessing] finished and saved retrieval indices for episode 95368 [episode count 2/20]
[retrieval_preprocessing] for episode 45322 [episode count 3/20], we have num_retrieval=np.int64(3990) num_query=np.int64(204)
2025-03-09 09:42:27,357 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-09 09:42:28,029 [INFO]: Launching the whole pipeline 03/09/2025, 09:42:28
2025-03-09 09:42:28,029 [INFO]: Reading total number of vectors and dimension 03/09/2025, 09:42:28
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1642.89it/s]
2025-03-09 09:42:28,055 [INFO]: There are 3990 embeddings of dim 49152
2025-03-09 09:42:28,055 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0262 secs
2025-03-09 09:42:28,055 [INFO]: 	Compute estimated construction time of the index 03/09/2025, 09:42:28
2025-03-09 09:42:28,055 [INFO]: 		-> Train: 16.7 minutes
2025-03-09 09:42:28,055 [INFO]: 		-> Add: 2.2 seconds
2025-03-09 09:42:28,055 [INFO]: 		Total: 16.7 minutes
2025-03-09 09:42:28,055 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0001 secs
2025-03-09 09:42:28,055 [INFO]: 	Checking that your have enough memory available to create the index 03/09/2025, 09:42:28
2025-03-09 09:42:28,056 [INFO]: 823.4MB of memory will be needed to build the index (more might be used if you have more)
2025-03-09 09:42:28,056 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0001 secs
2025-03-09 09:42:28,056 [INFO]: 	Selecting most promising index types given data characteristics 03/09/2025, 09:42:28
2025-03-09 09:42:28,056 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-09 09:42:28,056 [INFO]: 	Creating the index 03/09/2025, 09:42:28
2025-03-09 09:42:28,056 [INFO]: 		-> Instanciate the index HNSW15 03/09/2025, 09:42:28
2025-03-09 09:42:28,057 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0013 secs
2025-03-09 09:42:28,057 [INFO]: 		-> Adding the vectors to the index 03/09/2025, 09:42:28
2025-03-09 09:42:28,057 [INFO]: The memory available for adding the vectors is 49.3GB(total available - used by the index)
2025-03-09 09:42:28,057 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/16 [00:00<?, ?it/s] 12%|█▎        | 2/16 [00:00<00:00, 17.74it/s] 44%|████▍     | 7/16 [00:00<00:00, 33.77it/s] 81%|████████▏ | 13/16 [00:00<00:00, 42.00it/s]100%|██████████| 16/16 [00:03<00:00,  4.85it/s]
2025-03-09 09:42:32,083 [INFO]: 	Computing best hyperparameters for index knn.index 03/09/2025, 09:42:32
2025-03-09 09:43:06,453 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 34.3696 secs
2025-03-09 09:43:06,453 [INFO]: The best hyperparameters are: efSearch=162
2025-03-09 09:43:06,454 [INFO]: 	Compute fast metrics 03/09/2025, 09:43:06
  0%|          | 0/4 [00:00<?, ?it/s] 50%|█████     | 2/4 [00:00<00:00, 18.24it/s] 75%|███████▌  | 3/4 [00:00<00:00, 19.94it/s]
2025-03-09 09:43:23,937 [INFO]: 	>>> Finished "Compute fast metrics" in 17.4832 secs
2025-03-09 09:43:23,939 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 55.8819 secs
2025-03-09 09:43:23,939 [INFO]: {
2025-03-09 09:43:23,939 [INFO]: 	index_key: HNSW15
2025-03-09 09:43:23,939 [INFO]: 	index_param: efSearch=162
2025-03-09 09:43:23,939 [INFO]: 	index_path: knn.index
2025-03-09 09:43:23,939 [INFO]: 	size in bytes: 785008690
2025-03-09 09:43:23,939 [INFO]: 	avg_search_speed_ms: 7.029499104986058
2025-03-09 09:43:23,939 [INFO]: 	99p_search_speed_ms: 15.28759591747075
2025-03-09 09:43:23,939 [INFO]: 	reconstruction error %: 0.0
2025-03-09 09:43:23,939 [INFO]: 	nb vectors: 3990
2025-03-09 09:43:23,940 [INFO]: 	vectors dimension: 49152
2025-03-09 09:43:23,940 [INFO]: 	compression ratio: 0.9993085809024611
2025-03-09 09:43:23,940 [INFO]: }
2025-03-09 09:43:23,940 [INFO]: 	>>> Finished "Creating the index" in 55.8838 secs
2025-03-09 09:43:23,940 [INFO]: >>> Finished "Launching the whole pipeline" in 55.9107 secs
2025-03-09 09:43:24: [retrieval_preprocessing] calculating distances ...
2025-03-09 09:43:25: [retrieval_preprocessing] finished and saved retrieval indices for episode 45322 [episode count 3/20]
[retrieval_preprocessing] for episode 2827 [episode count 4/20], we have num_retrieval=np.int64(4033) num_query=np.int64(161)
2025-03-09 09:43:25,560 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-09 09:43:26,131 [INFO]: Launching the whole pipeline 03/09/2025, 09:43:26
2025-03-09 09:43:26,131 [INFO]: Reading total number of vectors and dimension 03/09/2025, 09:43:26
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1296.54it/s]
2025-03-09 09:43:26,196 [INFO]: There are 4033 embeddings of dim 49152
2025-03-09 09:43:26,196 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0652 secs
2025-03-09 09:43:26,196 [INFO]: 	Compute estimated construction time of the index 03/09/2025, 09:43:26
2025-03-09 09:43:26,196 [INFO]: 		-> Train: 16.7 minutes
2025-03-09 09:43:26,197 [INFO]: 		-> Add: 2.2 seconds
2025-03-09 09:43:26,197 [INFO]: 		Total: 16.7 minutes
2025-03-09 09:43:26,197 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0002 secs
2025-03-09 09:43:26,197 [INFO]: 	Checking that your have enough memory available to create the index 03/09/2025, 09:43:26
2025-03-09 09:43:26,197 [INFO]: 832.3MB of memory will be needed to build the index (more might be used if you have more)
2025-03-09 09:43:26,197 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0002 secs
2025-03-09 09:43:26,197 [INFO]: 	Selecting most promising index types given data characteristics 03/09/2025, 09:43:26
2025-03-09 09:43:26,197 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-09 09:43:26,197 [INFO]: 	Creating the index 03/09/2025, 09:43:26
2025-03-09 09:43:26,197 [INFO]: 		-> Instanciate the index HNSW15 03/09/2025, 09:43:26
2025-03-09 09:43:26,198 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0011 secs
2025-03-09 09:43:26,198 [INFO]: 		-> Adding the vectors to the index 03/09/2025, 09:43:26
2025-03-09 09:43:26,199 [INFO]: The memory available for adding the vectors is 49.3GB(total available - used by the index)
2025-03-09 09:43:26,199 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/16 [00:00<?, ?it/s]  6%|▋         | 1/16 [00:00<00:01,  8.84it/s] 38%|███▊      | 6/16 [00:00<00:00, 28.86it/s] 69%|██████▉   | 11/16 [00:00<00:00, 35.07it/s]100%|██████████| 16/16 [00:03<00:00,  3.45it/s]100%|██████████| 16/16 [00:03<00:00,  4.65it/s]
2025-03-09 09:43:29,645 [INFO]: 	Computing best hyperparameters for index knn.index 03/09/2025, 09:43:29
2025-03-09 09:44:04,374 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 34.7282 secs
2025-03-09 09:44:04,374 [INFO]: The best hyperparameters are: efSearch=220
2025-03-09 09:44:04,374 [INFO]: 	Compute fast metrics 03/09/2025, 09:44:04
  0%|          | 0/4 [00:00<?, ?it/s] 25%|██▌       | 1/4 [00:00<00:00,  9.64it/s] 75%|███████▌  | 3/4 [00:00<00:00, 18.11it/s]
2025-03-09 09:44:20,933 [INFO]: 	>>> Finished "Compute fast metrics" in 16.5587 secs
2025-03-09 09:44:20,935 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 54.7370 secs
2025-03-09 09:44:20,936 [INFO]: {
2025-03-09 09:44:20,936 [INFO]: 	index_key: HNSW15
2025-03-09 09:44:20,936 [INFO]: 	index_param: efSearch=220
2025-03-09 09:44:20,936 [INFO]: 	index_path: knn.index
2025-03-09 09:44:20,936 [INFO]: 	size in bytes: 793468690
2025-03-09 09:44:20,936 [INFO]: 	avg_search_speed_ms: 10.05816606584768
2025-03-09 09:44:20,936 [INFO]: 	99p_search_speed_ms: 21.076202276162764
2025-03-09 09:44:20,936 [INFO]: 	reconstruction error %: 0.0
2025-03-09 09:44:20,936 [INFO]: 	nb vectors: 4033
2025-03-09 09:44:20,936 [INFO]: 	vectors dimension: 49152
2025-03-09 09:44:20,936 [INFO]: 	compression ratio: 0.9993085725915662
2025-03-09 09:44:20,936 [INFO]: }
2025-03-09 09:44:20,936 [INFO]: 	>>> Finished "Creating the index" in 54.7388 secs
2025-03-09 09:44:20,936 [INFO]: >>> Finished "Launching the whole pipeline" in 54.8048 secs
2025-03-09 09:44:21: [retrieval_preprocessing] calculating distances ...
2025-03-09 09:44:22: [retrieval_preprocessing] finished and saved retrieval indices for episode 2827 [episode count 4/20]
[retrieval_preprocessing] for episode 74890 [episode count 5/20], we have num_retrieval=np.int64(3994) num_query=np.int64(200)
2025-03-09 09:44:22,566 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-09 09:44:23,236 [INFO]: Launching the whole pipeline 03/09/2025, 09:44:23
2025-03-09 09:44:23,236 [INFO]: Reading total number of vectors and dimension 03/09/2025, 09:44:23
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1596.61it/s]
2025-03-09 09:44:23,267 [INFO]: There are 3994 embeddings of dim 49152
2025-03-09 09:44:23,267 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0306 secs
2025-03-09 09:44:23,267 [INFO]: 	Compute estimated construction time of the index 03/09/2025, 09:44:23
2025-03-09 09:44:23,268 [INFO]: 		-> Train: 16.7 minutes
2025-03-09 09:44:23,268 [INFO]: 		-> Add: 2.2 seconds
2025-03-09 09:44:23,268 [INFO]: 		Total: 16.7 minutes
2025-03-09 09:44:23,268 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0005 secs
2025-03-09 09:44:23,268 [INFO]: 	Checking that your have enough memory available to create the index 03/09/2025, 09:44:23
2025-03-09 09:44:23,268 [INFO]: 824.3MB of memory will be needed to build the index (more might be used if you have more)
2025-03-09 09:44:23,269 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0005 secs
2025-03-09 09:44:23,269 [INFO]: 	Selecting most promising index types given data characteristics 03/09/2025, 09:44:23
2025-03-09 09:44:23,269 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-09 09:44:23,269 [INFO]: 	Creating the index 03/09/2025, 09:44:23
2025-03-09 09:44:23,269 [INFO]: 		-> Instanciate the index HNSW15 03/09/2025, 09:44:23
2025-03-09 09:44:23,272 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0030 secs
2025-03-09 09:44:23,273 [INFO]: 		-> Adding the vectors to the index 03/09/2025, 09:44:23
2025-03-09 09:44:23,273 [INFO]: The memory available for adding the vectors is 49.3GB(total available - used by the index)
2025-03-09 09:44:23,273 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/16 [00:00<?, ?it/s]  6%|▋         | 1/16 [00:00<00:01,  7.83it/s] 38%|███▊      | 6/16 [00:00<00:00, 27.64it/s] 69%|██████▉   | 11/16 [00:00<00:00, 36.49it/s]100%|██████████| 16/16 [00:03<00:00,  3.90it/s]100%|██████████| 16/16 [00:03<00:00,  5.21it/s]
2025-03-09 09:44:26,348 [INFO]: 	Computing best hyperparameters for index knn.index 03/09/2025, 09:44:26
2025-03-09 09:45:01,998 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 35.6493 secs
2025-03-09 09:45:01,999 [INFO]: The best hyperparameters are: efSearch=219
2025-03-09 09:45:01,999 [INFO]: 	Compute fast metrics 03/09/2025, 09:45:01
  0%|          | 0/4 [00:00<?, ?it/s] 50%|█████     | 2/4 [00:00<00:00, 19.68it/s] 75%|███████▌  | 3/4 [00:00<00:00, 21.76it/s]
2025-03-09 09:45:19,780 [INFO]: 	>>> Finished "Compute fast metrics" in 17.7807 secs
2025-03-09 09:45:19,782 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 56.5091 secs
2025-03-09 09:45:19,782 [INFO]: {
2025-03-09 09:45:19,782 [INFO]: 	index_key: HNSW15
2025-03-09 09:45:19,782 [INFO]: 	index_param: efSearch=219
2025-03-09 09:45:19,782 [INFO]: 	index_path: knn.index
2025-03-09 09:45:19,782 [INFO]: 	size in bytes: 785795650
2025-03-09 09:45:19,782 [INFO]: 	avg_search_speed_ms: 8.887620725979408
2025-03-09 09:45:19,782 [INFO]: 	99p_search_speed_ms: 19.456672901287675
2025-03-09 09:45:19,782 [INFO]: 	reconstruction error %: 0.0
2025-03-09 09:45:19,782 [INFO]: 	nb vectors: 3994
2025-03-09 09:45:19,782 [INFO]: 	vectors dimension: 49152
2025-03-09 09:45:19,782 [INFO]: 	compression ratio: 0.9993086014156479
2025-03-09 09:45:19,782 [INFO]: }
2025-03-09 09:45:19,782 [INFO]: 	>>> Finished "Creating the index" in 56.5131 secs
2025-03-09 09:45:19,782 [INFO]: >>> Finished "Launching the whole pipeline" in 56.5458 secs
2025-03-09 09:45:20: [retrieval_preprocessing] calculating distances ...
2025-03-09 09:45:21: [retrieval_preprocessing] finished and saved retrieval indices for episode 74890 [episode count 5/20]
[retrieval_preprocessing] for episode 9869 [episode count 6/20], we have num_retrieval=np.int64(3976) num_query=np.int64(218)
2025-03-09 09:45:21,947 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-09 09:45:22,513 [INFO]: Launching the whole pipeline 03/09/2025, 09:45:22
2025-03-09 09:45:22,514 [INFO]: Reading total number of vectors and dimension 03/09/2025, 09:45:22
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1395.78it/s]
2025-03-09 09:45:22,543 [INFO]: There are 3976 embeddings of dim 49152
2025-03-09 09:45:22,543 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0296 secs
2025-03-09 09:45:22,543 [INFO]: 	Compute estimated construction time of the index 03/09/2025, 09:45:22
2025-03-09 09:45:22,543 [INFO]: 		-> Train: 16.7 minutes
2025-03-09 09:45:22,543 [INFO]: 		-> Add: 2.2 seconds
2025-03-09 09:45:22,543 [INFO]: 		Total: 16.7 minutes
2025-03-09 09:45:22,543 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0001 secs
2025-03-09 09:45:22,543 [INFO]: 	Checking that your have enough memory available to create the index 03/09/2025, 09:45:22
2025-03-09 09:45:22,544 [INFO]: 820.6MB of memory will be needed to build the index (more might be used if you have more)
2025-03-09 09:45:22,544 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0002 secs
2025-03-09 09:45:22,544 [INFO]: 	Selecting most promising index types given data characteristics 03/09/2025, 09:45:22
2025-03-09 09:45:22,544 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-09 09:45:22,544 [INFO]: 	Creating the index 03/09/2025, 09:45:22
2025-03-09 09:45:22,544 [INFO]: 		-> Instanciate the index HNSW15 03/09/2025, 09:45:22
2025-03-09 09:45:22,545 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0012 secs
2025-03-09 09:45:22,545 [INFO]: 		-> Adding the vectors to the index 03/09/2025, 09:45:22
2025-03-09 09:45:22,545 [INFO]: The memory available for adding the vectors is 49.3GB(total available - used by the index)
2025-03-09 09:45:22,545 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/16 [00:00<?, ?it/s] 12%|█▎        | 2/16 [00:00<00:00, 17.28it/s] 50%|█████     | 8/16 [00:00<00:00, 38.28it/s] 88%|████████▊ | 14/16 [00:00<00:00, 45.24it/s]100%|██████████| 16/16 [00:03<00:00,  5.26it/s]
2025-03-09 09:45:25,592 [INFO]: 	Computing best hyperparameters for index knn.index 03/09/2025, 09:45:25
2025-03-09 09:45:59,193 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 33.6003 secs
2025-03-09 09:45:59,193 [INFO]: The best hyperparameters are: efSearch=244
2025-03-09 09:45:59,193 [INFO]: 	Compute fast metrics 03/09/2025, 09:45:59
  0%|          | 0/4 [00:00<?, ?it/s] 50%|█████     | 2/4 [00:00<00:00, 19.44it/s] 75%|███████▌  | 3/4 [00:00<00:00, 21.56it/s]
2025-03-09 09:46:19,825 [INFO]: 	>>> Finished "Compute fast metrics" in 20.6316 secs
2025-03-09 09:46:19,956 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 57.4102 secs
2025-03-09 09:46:19,956 [INFO]: {
2025-03-09 09:46:19,956 [INFO]: 	index_key: HNSW15
2025-03-09 09:46:19,956 [INFO]: 	index_param: efSearch=244
2025-03-09 09:46:19,956 [INFO]: 	index_path: knn.index
2025-03-09 09:46:19,956 [INFO]: 	size in bytes: 782254270
2025-03-09 09:46:19,956 [INFO]: 	avg_search_speed_ms: 9.68811138828155
2025-03-09 09:46:19,956 [INFO]: 	99p_search_speed_ms: 20.04431374371048
2025-03-09 09:46:19,956 [INFO]: 	reconstruction error %: 0.0
2025-03-09 09:46:19,956 [INFO]: 	nb vectors: 3976
2025-03-09 09:46:19,956 [INFO]: 	vectors dimension: 49152
2025-03-09 09:46:19,956 [INFO]: 	compression ratio: 0.9993085854296455
2025-03-09 09:46:19,956 [INFO]: }
2025-03-09 09:46:19,957 [INFO]: 	>>> Finished "Creating the index" in 57.4126 secs
2025-03-09 09:46:19,957 [INFO]: >>> Finished "Launching the whole pipeline" in 57.4430 secs
2025-03-09 09:46:21: [retrieval_preprocessing] calculating distances ...
2025-03-09 09:46:22: [retrieval_preprocessing] finished and saved retrieval indices for episode 9869 [episode count 6/20]
[retrieval_preprocessing] for episode 71826 [episode count 7/20], we have num_retrieval=np.int64(4040) num_query=np.int64(154)
2025-03-09 09:46:22,514 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-09 09:46:23,002 [INFO]: Launching the whole pipeline 03/09/2025, 09:46:23
2025-03-09 09:46:23,002 [INFO]: Reading total number of vectors and dimension 03/09/2025, 09:46:23
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1650.00it/s]
2025-03-09 09:46:23,030 [INFO]: There are 4040 embeddings of dim 49152
2025-03-09 09:46:23,031 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0288 secs
2025-03-09 09:46:23,031 [INFO]: 	Compute estimated construction time of the index 03/09/2025, 09:46:23
2025-03-09 09:46:23,031 [INFO]: 		-> Train: 16.7 minutes
2025-03-09 09:46:23,031 [INFO]: 		-> Add: 2.2 seconds
2025-03-09 09:46:23,032 [INFO]: 		Total: 16.7 minutes
2025-03-09 09:46:23,032 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0003 secs
2025-03-09 09:46:23,032 [INFO]: 	Checking that your have enough memory available to create the index 03/09/2025, 09:46:23
2025-03-09 09:46:23,032 [INFO]: 833.8MB of memory will be needed to build the index (more might be used if you have more)
2025-03-09 09:46:23,032 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0004 secs
2025-03-09 09:46:23,032 [INFO]: 	Selecting most promising index types given data characteristics 03/09/2025, 09:46:23
2025-03-09 09:46:23,032 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-09 09:46:23,032 [INFO]: 	Creating the index 03/09/2025, 09:46:23
2025-03-09 09:46:23,033 [INFO]: 		-> Instanciate the index HNSW15 03/09/2025, 09:46:23
2025-03-09 09:46:23,035 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0027 secs
2025-03-09 09:46:23,036 [INFO]: 		-> Adding the vectors to the index 03/09/2025, 09:46:23
2025-03-09 09:46:23,036 [INFO]: The memory available for adding the vectors is 49.3GB(total available - used by the index)
2025-03-09 09:46:23,036 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/16 [00:00<?, ?it/s] 19%|█▉        | 3/16 [00:00<00:00, 25.70it/s] 56%|█████▋    | 9/16 [00:00<00:00, 42.49it/s] 94%|█████████▍| 15/16 [00:00<00:00, 48.21it/s]100%|██████████| 16/16 [00:03<00:00,  5.17it/s]
2025-03-09 09:46:26,136 [INFO]: 	Computing best hyperparameters for index knn.index 03/09/2025, 09:46:26
2025-03-09 09:47:04,010 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 37.8732 secs
2025-03-09 09:47:04,010 [INFO]: The best hyperparameters are: efSearch=257
2025-03-09 09:47:04,010 [INFO]: 	Compute fast metrics 03/09/2025, 09:47:04
  0%|          | 0/4 [00:00<?, ?it/s] 50%|█████     | 2/4 [00:00<00:00, 19.01it/s] 75%|███████▌  | 3/4 [00:00<00:00, 19.60it/s]
2025-03-09 09:47:24,224 [INFO]: 	>>> Finished "Compute fast metrics" in 20.2140 secs
2025-03-09 09:47:24,226 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 61.1907 secs
2025-03-09 09:47:24,227 [INFO]: {
2025-03-09 09:47:24,227 [INFO]: 	index_key: HNSW15
2025-03-09 09:47:24,227 [INFO]: 	index_param: efSearch=257
2025-03-09 09:47:24,227 [INFO]: 	index_path: knn.index
2025-03-09 09:47:24,227 [INFO]: 	size in bytes: 794845930
2025-03-09 09:47:24,227 [INFO]: 	avg_search_speed_ms: 10.276913253077424
2025-03-09 09:47:24,227 [INFO]: 	99p_search_speed_ms: 23.134789867326603
2025-03-09 09:47:24,227 [INFO]: 	reconstruction error %: 0.0
2025-03-09 09:47:24,227 [INFO]: 	nb vectors: 4040
2025-03-09 09:47:24,227 [INFO]: 	vectors dimension: 49152
2025-03-09 09:47:24,227 [INFO]: 	compression ratio: 0.9993085326611661
2025-03-09 09:47:24,227 [INFO]: }
2025-03-09 09:47:24,227 [INFO]: 	>>> Finished "Creating the index" in 61.1943 secs
2025-03-09 09:47:24,227 [INFO]: >>> Finished "Launching the whole pipeline" in 61.2248 secs
2025-03-09 09:47:25: [retrieval_preprocessing] calculating distances ...
2025-03-09 09:47:25: [retrieval_preprocessing] finished and saved retrieval indices for episode 71826 [episode count 7/20]
[retrieval_preprocessing] for episode 14615 [episode count 8/20], we have num_retrieval=np.int64(3944) num_query=np.int64(250)
2025-03-09 09:47:25,964 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-09 09:47:27,181 [INFO]: Launching the whole pipeline 03/09/2025, 09:47:27
2025-03-09 09:47:27,181 [INFO]: Reading total number of vectors and dimension 03/09/2025, 09:47:27
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 2362.99it/s]
2025-03-09 09:47:27,205 [INFO]: There are 3944 embeddings of dim 49152
2025-03-09 09:47:27,205 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0240 secs
2025-03-09 09:47:27,205 [INFO]: 	Compute estimated construction time of the index 03/09/2025, 09:47:27
2025-03-09 09:47:27,205 [INFO]: 		-> Train: 16.7 minutes
2025-03-09 09:47:27,205 [INFO]: 		-> Add: 2.2 seconds
2025-03-09 09:47:27,205 [INFO]: 		Total: 16.7 minutes
2025-03-09 09:47:27,205 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0001 secs
2025-03-09 09:47:27,205 [INFO]: 	Checking that your have enough memory available to create the index 03/09/2025, 09:47:27
2025-03-09 09:47:27,205 [INFO]: 813.9MB of memory will be needed to build the index (more might be used if you have more)
2025-03-09 09:47:27,205 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0001 secs
2025-03-09 09:47:27,205 [INFO]: 	Selecting most promising index types given data characteristics 03/09/2025, 09:47:27
2025-03-09 09:47:27,205 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-09 09:47:27,205 [INFO]: 	Creating the index 03/09/2025, 09:47:27
2025-03-09 09:47:27,205 [INFO]: 		-> Instanciate the index HNSW15 03/09/2025, 09:47:27
2025-03-09 09:47:27,206 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0009 secs
2025-03-09 09:47:27,206 [INFO]: 		-> Adding the vectors to the index 03/09/2025, 09:47:27
2025-03-09 09:47:27,206 [INFO]: The memory available for adding the vectors is 49.3GB(total available - used by the index)
2025-03-09 09:47:27,206 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/16 [00:00<?, ?it/s]  6%|▋         | 1/16 [00:00<00:01,  9.56it/s] 44%|████▍     | 7/16 [00:00<00:00, 36.87it/s] 88%|████████▊ | 14/16 [00:00<00:00, 50.44it/s]100%|██████████| 16/16 [00:03<00:00,  5.15it/s]
2025-03-09 09:47:30,317 [INFO]: 	Computing best hyperparameters for index knn.index 03/09/2025, 09:47:30
2025-03-09 09:48:08,586 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 38.2689 secs
2025-03-09 09:48:08,587 [INFO]: The best hyperparameters are: efSearch=235
2025-03-09 09:48:08,587 [INFO]: 	Compute fast metrics 03/09/2025, 09:48:08
  0%|          | 0/4 [00:00<?, ?it/s] 50%|█████     | 2/4 [00:00<00:00, 19.34it/s] 75%|███████▌  | 3/4 [00:00<00:00, 21.06it/s]
2025-03-09 09:48:27,148 [INFO]: 	>>> Finished "Compute fast metrics" in 18.5614 secs
2025-03-09 09:48:27,151 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 59.9442 secs
2025-03-09 09:48:27,151 [INFO]: {
2025-03-09 09:48:27,151 [INFO]: 	index_key: HNSW15
2025-03-09 09:48:27,151 [INFO]: 	index_param: efSearch=235
2025-03-09 09:48:27,151 [INFO]: 	index_path: knn.index
2025-03-09 09:48:27,151 [INFO]: 	size in bytes: 775958530
2025-03-09 09:48:27,151 [INFO]: 	avg_search_speed_ms: 9.488380428596242
2025-03-09 09:48:27,151 [INFO]: 	99p_search_speed_ms: 13.625522202346476
2025-03-09 09:48:27,151 [INFO]: 	reconstruction error %: 0.0
2025-03-09 09:48:27,151 [INFO]: 	nb vectors: 3944
2025-03-09 09:48:27,151 [INFO]: 	vectors dimension: 49152
2025-03-09 09:48:27,151 [INFO]: 	compression ratio: 0.9993084965507113
2025-03-09 09:48:27,151 [INFO]: }
2025-03-09 09:48:27,151 [INFO]: 	>>> Finished "Creating the index" in 59.9456 secs
2025-03-09 09:48:27,151 [INFO]: >>> Finished "Launching the whole pipeline" in 59.9701 secs
2025-03-09 09:48:28: [retrieval_preprocessing] calculating distances ...
2025-03-09 09:48:29: [retrieval_preprocessing] finished and saved retrieval indices for episode 14615 [episode count 8/20]
[retrieval_preprocessing] for episode 37399 [episode count 9/20], we have num_retrieval=np.int64(4036) num_query=np.int64(158)
2025-03-09 09:48:29,777 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-09 09:48:31,057 [INFO]: Launching the whole pipeline 03/09/2025, 09:48:31
2025-03-09 09:48:31,057 [INFO]: Reading total number of vectors and dimension 03/09/2025, 09:48:31
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1493.70it/s]
2025-03-09 09:48:31,085 [INFO]: There are 4036 embeddings of dim 49152
2025-03-09 09:48:31,085 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0281 secs
2025-03-09 09:48:31,085 [INFO]: 	Compute estimated construction time of the index 03/09/2025, 09:48:31
2025-03-09 09:48:31,085 [INFO]: 		-> Train: 16.7 minutes
2025-03-09 09:48:31,085 [INFO]: 		-> Add: 2.2 seconds
2025-03-09 09:48:31,085 [INFO]: 		Total: 16.7 minutes
2025-03-09 09:48:31,085 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0001 secs
2025-03-09 09:48:31,085 [INFO]: 	Checking that your have enough memory available to create the index 03/09/2025, 09:48:31
2025-03-09 09:48:31,085 [INFO]: 832.9MB of memory will be needed to build the index (more might be used if you have more)
2025-03-09 09:48:31,086 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0002 secs
2025-03-09 09:48:31,086 [INFO]: 	Selecting most promising index types given data characteristics 03/09/2025, 09:48:31
2025-03-09 09:48:31,086 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-09 09:48:31,086 [INFO]: 	Creating the index 03/09/2025, 09:48:31
2025-03-09 09:48:31,086 [INFO]: 		-> Instanciate the index HNSW15 03/09/2025, 09:48:31
2025-03-09 09:48:31,087 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0011 secs
2025-03-09 09:48:31,087 [INFO]: 		-> Adding the vectors to the index 03/09/2025, 09:48:31
2025-03-09 09:48:31,087 [INFO]: The memory available for adding the vectors is 49.3GB(total available - used by the index)
2025-03-09 09:48:31,087 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/16 [00:00<?, ?it/s]  6%|▋         | 1/16 [00:00<00:01,  8.53it/s] 31%|███▏      | 5/16 [00:00<00:00, 24.91it/s] 56%|█████▋    | 9/16 [00:00<00:00, 27.57it/s] 81%|████████▏ | 13/16 [00:00<00:00, 29.80it/s]100%|██████████| 16/16 [00:03<00:00,  2.58it/s]100%|██████████| 16/16 [00:03<00:00,  4.11it/s]
2025-03-09 09:48:34,987 [INFO]: 	Computing best hyperparameters for index knn.index 03/09/2025, 09:48:34
2025-03-09 09:49:09,347 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 34.3596 secs
2025-03-09 09:49:09,347 [INFO]: The best hyperparameters are: efSearch=237
2025-03-09 09:49:09,347 [INFO]: 	Compute fast metrics 03/09/2025, 09:49:09
  0%|          | 0/4 [00:00<?, ?it/s] 75%|███████▌  | 3/4 [00:00<00:00, 27.19it/s] 75%|███████▌  | 3/4 [00:00<00:00, 23.06it/s]
2025-03-09 09:49:31,103 [INFO]: 	>>> Finished "Compute fast metrics" in 21.7563 secs
2025-03-09 09:49:31,106 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 60.0187 secs
2025-03-09 09:49:31,106 [INFO]: {
2025-03-09 09:49:31,106 [INFO]: 	index_key: HNSW15
2025-03-09 09:49:31,106 [INFO]: 	index_param: efSearch=237
2025-03-09 09:49:31,106 [INFO]: 	index_path: knn.index
2025-03-09 09:49:31,106 [INFO]: 	size in bytes: 794058910
2025-03-09 09:49:31,106 [INFO]: 	avg_search_speed_ms: 9.474035572290603
2025-03-09 09:49:31,106 [INFO]: 	99p_search_speed_ms: 13.658155780285602
2025-03-09 09:49:31,106 [INFO]: 	reconstruction error %: 0.0
2025-03-09 09:49:31,106 [INFO]: 	nb vectors: 4036
2025-03-09 09:49:31,106 [INFO]: 	vectors dimension: 49152
2025-03-09 09:49:31,106 [INFO]: 	compression ratio: 0.9993085878225332
2025-03-09 09:49:31,106 [INFO]: }
2025-03-09 09:49:31,106 [INFO]: 	>>> Finished "Creating the index" in 60.0203 secs
2025-03-09 09:49:31,106 [INFO]: >>> Finished "Launching the whole pipeline" in 60.0491 secs
2025-03-09 09:49:32: [retrieval_preprocessing] calculating distances ...
2025-03-09 09:49:32: [retrieval_preprocessing] finished and saved retrieval indices for episode 37399 [episode count 9/20]
[retrieval_preprocessing] for episode 83960 [episode count 10/20], we have num_retrieval=np.int64(4015) num_query=np.int64(179)
2025-03-09 09:49:32,822 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-09 09:49:33,301 [INFO]: Launching the whole pipeline 03/09/2025, 09:49:33
2025-03-09 09:49:33,301 [INFO]: Reading total number of vectors and dimension 03/09/2025, 09:49:33
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1104.93it/s]
2025-03-09 09:49:33,332 [INFO]: There are 4015 embeddings of dim 49152
2025-03-09 09:49:33,333 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0314 secs
2025-03-09 09:49:33,333 [INFO]: 	Compute estimated construction time of the index 03/09/2025, 09:49:33
2025-03-09 09:49:33,333 [INFO]: 		-> Train: 16.7 minutes
2025-03-09 09:49:33,333 [INFO]: 		-> Add: 2.2 seconds
2025-03-09 09:49:33,333 [INFO]: 		Total: 16.7 minutes
2025-03-09 09:49:33,334 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0003 secs
2025-03-09 09:49:33,334 [INFO]: 	Checking that your have enough memory available to create the index 03/09/2025, 09:49:33
2025-03-09 09:49:33,334 [INFO]: 828.6MB of memory will be needed to build the index (more might be used if you have more)
2025-03-09 09:49:33,334 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0005 secs
2025-03-09 09:49:33,334 [INFO]: 	Selecting most promising index types given data characteristics 03/09/2025, 09:49:33
2025-03-09 09:49:33,335 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-09 09:49:33,335 [INFO]: 	Creating the index 03/09/2025, 09:49:33
2025-03-09 09:49:33,335 [INFO]: 		-> Instanciate the index HNSW15 03/09/2025, 09:49:33
2025-03-09 09:49:33,337 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0025 secs
2025-03-09 09:49:33,338 [INFO]: 		-> Adding the vectors to the index 03/09/2025, 09:49:33
2025-03-09 09:49:33,338 [INFO]: The memory available for adding the vectors is 49.3GB(total available - used by the index)
2025-03-09 09:49:33,338 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/16 [00:00<?, ?it/s]  6%|▋         | 1/16 [00:00<00:01,  8.85it/s] 38%|███▊      | 6/16 [00:00<00:00, 31.36it/s] 69%|██████▉   | 11/16 [00:00<00:00, 39.36it/s]100%|██████████| 16/16 [00:03<00:00,  3.48it/s]100%|██████████| 16/16 [00:03<00:00,  4.70it/s]
2025-03-09 09:49:36,748 [INFO]: 	Computing best hyperparameters for index knn.index 03/09/2025, 09:49:36
2025-03-09 09:50:11,987 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 35.2389 secs
2025-03-09 09:50:11,987 [INFO]: The best hyperparameters are: efSearch=227
2025-03-09 09:50:11,987 [INFO]: 	Compute fast metrics 03/09/2025, 09:50:11
  0%|          | 0/4 [00:00<?, ?it/s] 50%|█████     | 2/4 [00:00<00:00, 18.91it/s] 75%|███████▌  | 3/4 [00:00<00:00, 20.90it/s]
2025-03-09 09:50:31,677 [INFO]: 	>>> Finished "Compute fast metrics" in 19.6895 secs
2025-03-09 09:50:31,679 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 58.3410 secs
2025-03-09 09:50:31,679 [INFO]: {
2025-03-09 09:50:31,679 [INFO]: 	index_key: HNSW15
2025-03-09 09:50:31,679 [INFO]: 	index_param: efSearch=227
2025-03-09 09:50:31,679 [INFO]: 	index_path: knn.index
2025-03-09 09:50:31,679 [INFO]: 	size in bytes: 789927370
2025-03-09 09:50:31,679 [INFO]: 	avg_search_speed_ms: 9.12829651709741
2025-03-09 09:50:31,679 [INFO]: 	99p_search_speed_ms: 16.13245332846417
2025-03-09 09:50:31,679 [INFO]: 	reconstruction error %: 0.0
2025-03-09 09:50:31,679 [INFO]: 	nb vectors: 4015
2025-03-09 09:50:31,679 [INFO]: 	vectors dimension: 49152
2025-03-09 09:50:31,679 [INFO]: 	compression ratio: 0.9993084807277914
2025-03-09 09:50:31,679 [INFO]: }
2025-03-09 09:50:31,679 [INFO]: 	>>> Finished "Creating the index" in 58.3446 secs
2025-03-09 09:50:31,679 [INFO]: >>> Finished "Launching the whole pipeline" in 58.3780 secs
2025-03-09 09:50:32: [retrieval_preprocessing] calculating distances ...
2025-03-09 09:50:33: [retrieval_preprocessing] finished and saved retrieval indices for episode 83960 [episode count 10/20]
[retrieval_preprocessing] for episode 63518 [episode count 11/20], we have num_retrieval=np.int64(4023) num_query=np.int64(171)
2025-03-09 09:50:33,811 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-09 09:50:34,323 [INFO]: Launching the whole pipeline 03/09/2025, 09:50:34
2025-03-09 09:50:34,323 [INFO]: Reading total number of vectors and dimension 03/09/2025, 09:50:34
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1424.70it/s]
2025-03-09 09:50:34,355 [INFO]: There are 4023 embeddings of dim 49152
2025-03-09 09:50:34,356 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0329 secs
2025-03-09 09:50:34,356 [INFO]: 	Compute estimated construction time of the index 03/09/2025, 09:50:34
2025-03-09 09:50:34,356 [INFO]: 		-> Train: 16.7 minutes
2025-03-09 09:50:34,356 [INFO]: 		-> Add: 2.2 seconds
2025-03-09 09:50:34,356 [INFO]: 		Total: 16.7 minutes
2025-03-09 09:50:34,356 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0003 secs
2025-03-09 09:50:34,357 [INFO]: 	Checking that your have enough memory available to create the index 03/09/2025, 09:50:34
2025-03-09 09:50:34,357 [INFO]: 830.3MB of memory will be needed to build the index (more might be used if you have more)
2025-03-09 09:50:34,357 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0005 secs
2025-03-09 09:50:34,357 [INFO]: 	Selecting most promising index types given data characteristics 03/09/2025, 09:50:34
2025-03-09 09:50:34,357 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-09 09:50:34,357 [INFO]: 	Creating the index 03/09/2025, 09:50:34
2025-03-09 09:50:34,357 [INFO]: 		-> Instanciate the index HNSW15 03/09/2025, 09:50:34
2025-03-09 09:50:34,360 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0027 secs
2025-03-09 09:50:34,361 [INFO]: 		-> Adding the vectors to the index 03/09/2025, 09:50:34
2025-03-09 09:50:34,361 [INFO]: The memory available for adding the vectors is 49.3GB(total available - used by the index)
2025-03-09 09:50:34,361 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/16 [00:00<?, ?it/s] 12%|█▎        | 2/16 [00:00<00:00, 18.00it/s] 38%|███▊      | 6/16 [00:00<00:00, 28.48it/s] 75%|███████▌  | 12/16 [00:00<00:00, 40.64it/s]100%|██████████| 16/16 [00:03<00:00,  4.85it/s]
2025-03-09 09:50:37,746 [INFO]: 	Computing best hyperparameters for index knn.index 03/09/2025, 09:50:37
2025-03-09 09:51:15,219 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 37.4729 secs
2025-03-09 09:51:15,219 [INFO]: The best hyperparameters are: efSearch=245
2025-03-09 09:51:15,219 [INFO]: 	Compute fast metrics 03/09/2025, 09:51:15
  0%|          | 0/4 [00:00<?, ?it/s] 50%|█████     | 2/4 [00:00<00:00, 16.25it/s] 75%|███████▌  | 3/4 [00:00<00:00, 17.23it/s]
2025-03-09 09:51:33,421 [INFO]: 	>>> Finished "Compute fast metrics" in 18.2015 secs
2025-03-09 09:51:33,423 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 59.0622 secs
2025-03-09 09:51:33,423 [INFO]: {
2025-03-09 09:51:33,423 [INFO]: 	index_key: HNSW15
2025-03-09 09:51:33,423 [INFO]: 	index_param: efSearch=245
2025-03-09 09:51:33,423 [INFO]: 	index_path: knn.index
2025-03-09 09:51:33,423 [INFO]: 	size in bytes: 791501290
2025-03-09 09:51:33,423 [INFO]: 	avg_search_speed_ms: 10.569781179433535
2025-03-09 09:51:33,423 [INFO]: 	99p_search_speed_ms: 24.449222965631606
2025-03-09 09:51:33,423 [INFO]: 	reconstruction error %: 0.0
2025-03-09 09:51:33,423 [INFO]: 	nb vectors: 4023
2025-03-09 09:51:33,423 [INFO]: 	vectors dimension: 49152
2025-03-09 09:51:33,423 [INFO]: 	compression ratio: 0.9993085216576211
2025-03-09 09:51:33,423 [INFO]: }
2025-03-09 09:51:33,423 [INFO]: 	>>> Finished "Creating the index" in 59.0658 secs
2025-03-09 09:51:33,423 [INFO]: >>> Finished "Launching the whole pipeline" in 59.1002 secs
2025-03-09 09:51:34: [retrieval_preprocessing] calculating distances ...
2025-03-09 09:51:35: [retrieval_preprocessing] finished and saved retrieval indices for episode 63518 [episode count 11/20]
[retrieval_preprocessing] for episode 56996 [episode count 12/20], we have num_retrieval=np.int64(3994) num_query=np.int64(200)
2025-03-09 09:51:35,700 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-09 09:51:36,448 [INFO]: Launching the whole pipeline 03/09/2025, 09:51:36
2025-03-09 09:51:36,448 [INFO]: Reading total number of vectors and dimension 03/09/2025, 09:51:36
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1359.14it/s]
2025-03-09 09:51:36,487 [INFO]: There are 3994 embeddings of dim 49152
2025-03-09 09:51:36,487 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0396 secs
2025-03-09 09:51:36,487 [INFO]: 	Compute estimated construction time of the index 03/09/2025, 09:51:36
2025-03-09 09:51:36,488 [INFO]: 		-> Train: 16.7 minutes
2025-03-09 09:51:36,488 [INFO]: 		-> Add: 2.2 seconds
2025-03-09 09:51:36,488 [INFO]: 		Total: 16.7 minutes
2025-03-09 09:51:36,488 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0001 secs
2025-03-09 09:51:36,488 [INFO]: 	Checking that your have enough memory available to create the index 03/09/2025, 09:51:36
2025-03-09 09:51:36,488 [INFO]: 824.3MB of memory will be needed to build the index (more might be used if you have more)
2025-03-09 09:51:36,488 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0002 secs
2025-03-09 09:51:36,488 [INFO]: 	Selecting most promising index types given data characteristics 03/09/2025, 09:51:36
2025-03-09 09:51:36,488 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-09 09:51:36,488 [INFO]: 	Creating the index 03/09/2025, 09:51:36
2025-03-09 09:51:36,488 [INFO]: 		-> Instanciate the index HNSW15 03/09/2025, 09:51:36
2025-03-09 09:51:36,489 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0012 secs
2025-03-09 09:51:36,489 [INFO]: 		-> Adding the vectors to the index 03/09/2025, 09:51:36
2025-03-09 09:51:36,489 [INFO]: The memory available for adding the vectors is 49.3GB(total available - used by the index)
2025-03-09 09:51:36,489 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/16 [00:00<?, ?it/s] 12%|█▎        | 2/16 [00:00<00:00, 17.60it/s] 44%|████▍     | 7/16 [00:00<00:00, 34.39it/s] 75%|███████▌  | 12/16 [00:00<00:00, 38.50it/s]100%|██████████| 16/16 [00:03<00:00,  3.39it/s]100%|██████████| 16/16 [00:03<00:00,  4.84it/s]
2025-03-09 09:51:39,801 [INFO]: 	Computing best hyperparameters for index knn.index 03/09/2025, 09:51:39
2025-03-09 09:52:14,818 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 35.0168 secs
2025-03-09 09:52:14,818 [INFO]: The best hyperparameters are: efSearch=267
2025-03-09 09:52:14,818 [INFO]: 	Compute fast metrics 03/09/2025, 09:52:14
  0%|          | 0/4 [00:00<?, ?it/s] 25%|██▌       | 1/4 [00:00<00:00,  8.75it/s] 75%|███████▌  | 3/4 [00:00<00:00, 15.93it/s]
2025-03-09 09:52:36,488 [INFO]: 	>>> Finished "Compute fast metrics" in 21.6691 secs
2025-03-09 09:52:36,491 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 60.0012 secs
2025-03-09 09:52:36,491 [INFO]: {
2025-03-09 09:52:36,491 [INFO]: 	index_key: HNSW15
2025-03-09 09:52:36,491 [INFO]: 	index_param: efSearch=267
2025-03-09 09:52:36,491 [INFO]: 	index_path: knn.index
2025-03-09 09:52:36,491 [INFO]: 	size in bytes: 785795650
2025-03-09 09:52:36,491 [INFO]: 	avg_search_speed_ms: 11.763274105649222
2025-03-09 09:52:36,491 [INFO]: 	99p_search_speed_ms: 21.791042343247682
2025-03-09 09:52:36,491 [INFO]: 	reconstruction error %: 0.0
2025-03-09 09:52:36,491 [INFO]: 	nb vectors: 3994
2025-03-09 09:52:36,491 [INFO]: 	vectors dimension: 49152
2025-03-09 09:52:36,491 [INFO]: 	compression ratio: 0.9993086014156479
2025-03-09 09:52:36,491 [INFO]: }
2025-03-09 09:52:36,491 [INFO]: 	>>> Finished "Creating the index" in 60.0031 secs
2025-03-09 09:52:36,491 [INFO]: >>> Finished "Launching the whole pipeline" in 60.0435 secs
2025-03-09 09:52:38: [retrieval_preprocessing] calculating distances ...
2025-03-09 09:52:39: [retrieval_preprocessing] finished and saved retrieval indices for episode 56996 [episode count 12/20]
[retrieval_preprocessing] for episode 93607 [episode count 13/20], we have num_retrieval=np.int64(4034) num_query=np.int64(160)
2025-03-09 09:52:39,856 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-09 09:52:40,513 [INFO]: Launching the whole pipeline 03/09/2025, 09:52:40
2025-03-09 09:52:40,513 [INFO]: Reading total number of vectors and dimension 03/09/2025, 09:52:40
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1174.88it/s]
2025-03-09 09:52:40,547 [INFO]: There are 4034 embeddings of dim 49152
2025-03-09 09:52:40,547 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0335 secs
2025-03-09 09:52:40,547 [INFO]: 	Compute estimated construction time of the index 03/09/2025, 09:52:40
2025-03-09 09:52:40,547 [INFO]: 		-> Train: 16.7 minutes
2025-03-09 09:52:40,547 [INFO]: 		-> Add: 2.2 seconds
2025-03-09 09:52:40,547 [INFO]: 		Total: 16.7 minutes
2025-03-09 09:52:40,547 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0001 secs
2025-03-09 09:52:40,547 [INFO]: 	Checking that your have enough memory available to create the index 03/09/2025, 09:52:40
2025-03-09 09:52:40,547 [INFO]: 832.5MB of memory will be needed to build the index (more might be used if you have more)
2025-03-09 09:52:40,547 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0002 secs
2025-03-09 09:52:40,547 [INFO]: 	Selecting most promising index types given data characteristics 03/09/2025, 09:52:40
2025-03-09 09:52:40,548 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-09 09:52:40,548 [INFO]: 	Creating the index 03/09/2025, 09:52:40
2025-03-09 09:52:40,548 [INFO]: 		-> Instanciate the index HNSW15 03/09/2025, 09:52:40
2025-03-09 09:52:40,549 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0013 secs
2025-03-09 09:52:40,549 [INFO]: 		-> Adding the vectors to the index 03/09/2025, 09:52:40
2025-03-09 09:52:40,549 [INFO]: The memory available for adding the vectors is 49.3GB(total available - used by the index)
2025-03-09 09:52:40,549 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/16 [00:00<?, ?it/s] 12%|█▎        | 2/16 [00:00<00:00, 17.79it/s] 50%|█████     | 8/16 [00:00<00:00, 38.38it/s] 88%|████████▊ | 14/16 [00:00<00:00, 44.84it/s]100%|██████████| 16/16 [00:03<00:00,  5.22it/s]
2025-03-09 09:52:43,615 [INFO]: 	Computing best hyperparameters for index knn.index 03/09/2025, 09:52:43
2025-03-09 09:53:26,065 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 42.4492 secs
2025-03-09 09:53:26,065 [INFO]: The best hyperparameters are: efSearch=211
2025-03-09 09:53:26,065 [INFO]: 	Compute fast metrics 03/09/2025, 09:53:26
  0%|          | 0/4 [00:00<?, ?it/s] 50%|█████     | 2/4 [00:00<00:00, 18.51it/s] 75%|███████▌  | 3/4 [00:00<00:00, 20.38it/s]
2025-03-09 09:53:44,420 [INFO]: 	>>> Finished "Compute fast metrics" in 18.3548 secs
2025-03-09 09:53:44,422 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 63.8734 secs
2025-03-09 09:53:44,423 [INFO]: {
2025-03-09 09:53:44,423 [INFO]: 	index_key: HNSW15
2025-03-09 09:53:44,423 [INFO]: 	index_param: efSearch=211
2025-03-09 09:53:44,423 [INFO]: 	index_path: knn.index
2025-03-09 09:53:44,423 [INFO]: 	size in bytes: 793665430
2025-03-09 09:53:44,423 [INFO]: 	avg_search_speed_ms: 8.038219604439064
2025-03-09 09:53:44,423 [INFO]: 	99p_search_speed_ms: 14.40365620655938
2025-03-09 09:53:44,423 [INFO]: 	reconstruction error %: 0.0
2025-03-09 09:53:44,423 [INFO]: 	nb vectors: 4034
2025-03-09 09:53:44,423 [INFO]: 	vectors dimension: 49152
2025-03-09 09:53:44,423 [INFO]: 	compression ratio: 0.9993085776710723
2025-03-09 09:53:44,423 [INFO]: }
2025-03-09 09:53:44,423 [INFO]: 	>>> Finished "Creating the index" in 63.8752 secs
2025-03-09 09:53:44,423 [INFO]: >>> Finished "Launching the whole pipeline" in 63.9094 secs
2025-03-09 09:53:45: [retrieval_preprocessing] calculating distances ...
2025-03-09 09:53:45: [retrieval_preprocessing] finished and saved retrieval indices for episode 93607 [episode count 13/20]
[retrieval_preprocessing] for episode 61224 [episode count 14/20], we have num_retrieval=np.int64(3923) num_query=np.int64(271)
2025-03-09 09:53:45,844 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-09 09:53:46,294 [INFO]: Launching the whole pipeline 03/09/2025, 09:53:46
2025-03-09 09:53:46,294 [INFO]: Reading total number of vectors and dimension 03/09/2025, 09:53:46
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1497.97it/s]
2025-03-09 09:53:46,325 [INFO]: There are 3923 embeddings of dim 49152
2025-03-09 09:53:46,325 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0309 secs
2025-03-09 09:53:46,326 [INFO]: 	Compute estimated construction time of the index 03/09/2025, 09:53:46
2025-03-09 09:53:46,326 [INFO]: 		-> Train: 16.7 minutes
2025-03-09 09:53:46,326 [INFO]: 		-> Add: 2.2 seconds
2025-03-09 09:53:46,326 [INFO]: 		Total: 16.7 minutes
2025-03-09 09:53:46,326 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0004 secs
2025-03-09 09:53:46,326 [INFO]: 	Checking that your have enough memory available to create the index 03/09/2025, 09:53:46
2025-03-09 09:53:46,327 [INFO]: 809.6MB of memory will be needed to build the index (more might be used if you have more)
2025-03-09 09:53:46,327 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0005 secs
2025-03-09 09:53:46,327 [INFO]: 	Selecting most promising index types given data characteristics 03/09/2025, 09:53:46
2025-03-09 09:53:46,327 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-09 09:53:46,327 [INFO]: 	Creating the index 03/09/2025, 09:53:46
2025-03-09 09:53:46,327 [INFO]: 		-> Instanciate the index HNSW15 03/09/2025, 09:53:46
2025-03-09 09:53:46,330 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0027 secs
2025-03-09 09:53:46,331 [INFO]: 		-> Adding the vectors to the index 03/09/2025, 09:53:46
2025-03-09 09:53:46,331 [INFO]: The memory available for adding the vectors is 49.3GB(total available - used by the index)
2025-03-09 09:53:46,331 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/16 [00:00<?, ?it/s] 19%|█▉        | 3/16 [00:00<00:00, 26.77it/s] 62%|██████▎   | 10/16 [00:00<00:00, 48.57it/s]100%|██████████| 16/16 [00:02<00:00,  4.58it/s]100%|██████████| 16/16 [00:02<00:00,  5.73it/s]
2025-03-09 09:53:49,131 [INFO]: 	Computing best hyperparameters for index knn.index 03/09/2025, 09:53:49
2025-03-09 09:54:32,028 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 42.8969 secs
2025-03-09 09:54:32,028 [INFO]: The best hyperparameters are: efSearch=205
2025-03-09 09:54:32,028 [INFO]: 	Compute fast metrics 03/09/2025, 09:54:32
  0%|          | 0/4 [00:00<?, ?it/s] 75%|███████▌  | 3/4 [00:00<00:00, 25.61it/s] 75%|███████▌  | 3/4 [00:00<00:00, 21.98it/s]
2025-03-09 09:54:48,383 [INFO]: 	>>> Finished "Compute fast metrics" in 16.3542 secs
2025-03-09 09:54:48,904 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 62.5735 secs
2025-03-09 09:54:48,905 [INFO]: {
2025-03-09 09:54:48,905 [INFO]: 	index_key: HNSW15
2025-03-09 09:54:48,905 [INFO]: 	index_param: efSearch=205
2025-03-09 09:54:48,905 [INFO]: 	index_path: knn.index
2025-03-09 09:54:48,905 [INFO]: 	size in bytes: 771826930
2025-03-09 09:54:48,905 [INFO]: 	avg_search_speed_ms: 8.065087405867093
2025-03-09 09:54:48,905 [INFO]: 	99p_search_speed_ms: 17.514708463568233
2025-03-09 09:54:48,905 [INFO]: 	reconstruction error %: 0.0
2025-03-09 09:54:48,905 [INFO]: 	nb vectors: 3923
2025-03-09 09:54:48,905 [INFO]: 	vectors dimension: 49152
2025-03-09 09:54:48,905 [INFO]: 	compression ratio: 0.9993084641397522
2025-03-09 09:54:48,905 [INFO]: }
2025-03-09 09:54:48,905 [INFO]: 	>>> Finished "Creating the index" in 62.5780 secs
2025-03-09 09:54:48,905 [INFO]: >>> Finished "Launching the whole pipeline" in 62.6110 secs
2025-03-09 09:54:49: [retrieval_preprocessing] calculating distances ...
2025-03-09 09:54:50: [retrieval_preprocessing] finished and saved retrieval indices for episode 61224 [episode count 14/20]
[retrieval_preprocessing] for episode 5161 [episode count 15/20], we have num_retrieval=np.int64(3991) num_query=np.int64(203)
2025-03-09 09:54:50,923 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-09 09:54:51,376 [INFO]: Launching the whole pipeline 03/09/2025, 09:54:51
2025-03-09 09:54:51,376 [INFO]: Reading total number of vectors and dimension 03/09/2025, 09:54:51
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1288.57it/s]
2025-03-09 09:54:51,408 [INFO]: There are 3991 embeddings of dim 49152
2025-03-09 09:54:51,409 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0326 secs
2025-03-09 09:54:51,409 [INFO]: 	Compute estimated construction time of the index 03/09/2025, 09:54:51
2025-03-09 09:54:51,409 [INFO]: 		-> Train: 16.7 minutes
2025-03-09 09:54:51,409 [INFO]: 		-> Add: 2.2 seconds
2025-03-09 09:54:51,409 [INFO]: 		Total: 16.7 minutes
2025-03-09 09:54:51,409 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0001 secs
2025-03-09 09:54:51,409 [INFO]: 	Checking that your have enough memory available to create the index 03/09/2025, 09:54:51
2025-03-09 09:54:51,409 [INFO]: 823.6MB of memory will be needed to build the index (more might be used if you have more)
2025-03-09 09:54:51,409 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0002 secs
2025-03-09 09:54:51,409 [INFO]: 	Selecting most promising index types given data characteristics 03/09/2025, 09:54:51
2025-03-09 09:54:51,409 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-09 09:54:51,409 [INFO]: 	Creating the index 03/09/2025, 09:54:51
2025-03-09 09:54:51,409 [INFO]: 		-> Instanciate the index HNSW15 03/09/2025, 09:54:51
2025-03-09 09:54:51,411 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0013 secs
2025-03-09 09:54:51,411 [INFO]: 		-> Adding the vectors to the index 03/09/2025, 09:54:51
2025-03-09 09:54:51,411 [INFO]: The memory available for adding the vectors is 49.3GB(total available - used by the index)
2025-03-09 09:54:51,411 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/16 [00:00<?, ?it/s]  6%|▋         | 1/16 [00:00<00:01,  9.06it/s] 44%|████▍     | 7/16 [00:00<00:00, 34.53it/s] 81%|████████▏ | 13/16 [00:00<00:00, 44.07it/s]100%|██████████| 16/16 [00:02<00:00,  5.46it/s]
2025-03-09 09:54:54,344 [INFO]: 	Computing best hyperparameters for index knn.index 03/09/2025, 09:54:54
2025-03-09 09:55:27,754 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 33.4097 secs
2025-03-09 09:55:27,754 [INFO]: The best hyperparameters are: efSearch=243
2025-03-09 09:55:27,754 [INFO]: 	Compute fast metrics 03/09/2025, 09:55:27
  0%|          | 0/4 [00:00<?, ?it/s] 50%|█████     | 2/4 [00:00<00:00, 19.97it/s] 75%|███████▌  | 3/4 [00:00<00:00, 21.63it/s]
2025-03-09 09:55:43,038 [INFO]: 	>>> Finished "Compute fast metrics" in 15.2831 secs
2025-03-09 09:55:43,041 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 51.6297 secs
2025-03-09 09:55:43,041 [INFO]: {
2025-03-09 09:55:43,041 [INFO]: 	index_key: HNSW15
2025-03-09 09:55:43,041 [INFO]: 	index_param: efSearch=243
2025-03-09 09:55:43,041 [INFO]: 	index_path: knn.index
2025-03-09 09:55:43,041 [INFO]: 	size in bytes: 785205430
2025-03-09 09:55:43,041 [INFO]: 	avg_search_speed_ms: 9.573222316231169
2025-03-09 09:55:43,041 [INFO]: 	99p_search_speed_ms: 19.338166536763293
2025-03-09 09:55:43,041 [INFO]: 	reconstruction error %: 0.0
2025-03-09 09:55:43,041 [INFO]: 	nb vectors: 3991
2025-03-09 09:55:43,041 [INFO]: 	vectors dimension: 49152
2025-03-09 09:55:43,041 [INFO]: 	compression ratio: 0.9993085860346126
2025-03-09 09:55:43,041 [INFO]: }
2025-03-09 09:55:43,041 [INFO]: 	>>> Finished "Creating the index" in 51.6318 secs
2025-03-09 09:55:43,041 [INFO]: >>> Finished "Launching the whole pipeline" in 51.6652 secs
2025-03-09 09:55:44: [retrieval_preprocessing] calculating distances ...
2025-03-09 09:55:45: [retrieval_preprocessing] finished and saved retrieval indices for episode 5161 [episode count 15/20]
[retrieval_preprocessing] for episode 29227 [episode count 16/20], we have num_retrieval=np.int64(3974) num_query=np.int64(220)
2025-03-09 09:55:45,594 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-09 09:55:46,223 [INFO]: Launching the whole pipeline 03/09/2025, 09:55:46
2025-03-09 09:55:46,223 [INFO]: Reading total number of vectors and dimension 03/09/2025, 09:55:46
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1361.79it/s]
2025-03-09 09:55:46,252 [INFO]: There are 3974 embeddings of dim 49152
2025-03-09 09:55:46,252 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0291 secs
2025-03-09 09:55:46,252 [INFO]: 	Compute estimated construction time of the index 03/09/2025, 09:55:46
2025-03-09 09:55:46,252 [INFO]: 		-> Train: 16.7 minutes
2025-03-09 09:55:46,252 [INFO]: 		-> Add: 2.2 seconds
2025-03-09 09:55:46,252 [INFO]: 		Total: 16.7 minutes
2025-03-09 09:55:46,252 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0001 secs
2025-03-09 09:55:46,252 [INFO]: 	Checking that your have enough memory available to create the index 03/09/2025, 09:55:46
2025-03-09 09:55:46,253 [INFO]: 820.1MB of memory will be needed to build the index (more might be used if you have more)
2025-03-09 09:55:46,253 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0002 secs
2025-03-09 09:55:46,253 [INFO]: 	Selecting most promising index types given data characteristics 03/09/2025, 09:55:46
2025-03-09 09:55:46,253 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-09 09:55:46,253 [INFO]: 	Creating the index 03/09/2025, 09:55:46
2025-03-09 09:55:46,253 [INFO]: 		-> Instanciate the index HNSW15 03/09/2025, 09:55:46
2025-03-09 09:55:46,254 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0010 secs
2025-03-09 09:55:46,254 [INFO]: 		-> Adding the vectors to the index 03/09/2025, 09:55:46
2025-03-09 09:55:46,254 [INFO]: The memory available for adding the vectors is 49.3GB(total available - used by the index)
2025-03-09 09:55:46,254 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/16 [00:00<?, ?it/s]  6%|▋         | 1/16 [00:00<00:01,  7.63it/s] 31%|███▏      | 5/16 [00:00<00:00, 24.13it/s] 56%|█████▋    | 9/16 [00:00<00:00, 30.12it/s] 81%|████████▏ | 13/16 [00:00<00:00, 28.79it/s]100%|██████████| 16/16 [00:03<00:00,  2.78it/s]100%|██████████| 16/16 [00:03<00:00,  4.39it/s]
2025-03-09 09:55:49,903 [INFO]: 	Computing best hyperparameters for index knn.index 03/09/2025, 09:55:49
2025-03-09 09:56:24,462 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 34.5583 secs
2025-03-09 09:56:24,462 [INFO]: The best hyperparameters are: efSearch=217
2025-03-09 09:56:24,462 [INFO]: 	Compute fast metrics 03/09/2025, 09:56:24
  0%|          | 0/4 [00:00<?, ?it/s] 75%|███████▌  | 3/4 [00:00<00:00, 25.35it/s] 75%|███████▌  | 3/4 [00:00<00:00, 21.60it/s]
2025-03-09 09:56:41,828 [INFO]: 	>>> Finished "Compute fast metrics" in 17.3658 secs
2025-03-09 09:56:41,830 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 55.5764 secs
2025-03-09 09:56:41,831 [INFO]: {
2025-03-09 09:56:41,831 [INFO]: 	index_key: HNSW15
2025-03-09 09:56:41,831 [INFO]: 	index_param: efSearch=217
2025-03-09 09:56:41,831 [INFO]: 	index_path: knn.index
2025-03-09 09:56:41,831 [INFO]: 	size in bytes: 781860790
2025-03-09 09:56:41,831 [INFO]: 	avg_search_speed_ms: 9.089659129438752
2025-03-09 09:56:41,831 [INFO]: 	99p_search_speed_ms: 22.545861925464123
2025-03-09 09:56:41,831 [INFO]: 	reconstruction error %: 0.0
2025-03-09 09:56:41,831 [INFO]: 	nb vectors: 3974
2025-03-09 09:56:41,831 [INFO]: 	vectors dimension: 49152
2025-03-09 09:56:41,831 [INFO]: 	compression ratio: 0.9993085751237123
2025-03-09 09:56:41,831 [INFO]: }
2025-03-09 09:56:41,831 [INFO]: 	>>> Finished "Creating the index" in 55.5784 secs
2025-03-09 09:56:41,831 [INFO]: >>> Finished "Launching the whole pipeline" in 55.6081 secs
2025-03-09 09:56:42: [retrieval_preprocessing] calculating distances ...
2025-03-09 09:56:43: [retrieval_preprocessing] finished and saved retrieval indices for episode 29227 [episode count 16/20]
[retrieval_preprocessing] for episode 93657 [episode count 17/20], we have num_retrieval=np.int64(4027) num_query=np.int64(167)
2025-03-09 09:56:43,598 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-09 09:56:44,117 [INFO]: Launching the whole pipeline 03/09/2025, 09:56:44
2025-03-09 09:56:44,117 [INFO]: Reading total number of vectors and dimension 03/09/2025, 09:56:44
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1056.23it/s]
2025-03-09 09:56:44,144 [INFO]: There are 4027 embeddings of dim 49152
2025-03-09 09:56:44,144 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0271 secs
2025-03-09 09:56:44,144 [INFO]: 	Compute estimated construction time of the index 03/09/2025, 09:56:44
2025-03-09 09:56:44,144 [INFO]: 		-> Train: 16.7 minutes
2025-03-09 09:56:44,144 [INFO]: 		-> Add: 2.2 seconds
2025-03-09 09:56:44,144 [INFO]: 		Total: 16.7 minutes
2025-03-09 09:56:44,144 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0001 secs
2025-03-09 09:56:44,144 [INFO]: 	Checking that your have enough memory available to create the index 03/09/2025, 09:56:44
2025-03-09 09:56:44,144 [INFO]: 831.1MB of memory will be needed to build the index (more might be used if you have more)
2025-03-09 09:56:44,144 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0001 secs
2025-03-09 09:56:44,144 [INFO]: 	Selecting most promising index types given data characteristics 03/09/2025, 09:56:44
2025-03-09 09:56:44,144 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-09 09:56:44,144 [INFO]: 	Creating the index 03/09/2025, 09:56:44
2025-03-09 09:56:44,144 [INFO]: 		-> Instanciate the index HNSW15 03/09/2025, 09:56:44
2025-03-09 09:56:44,146 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0012 secs
2025-03-09 09:56:44,146 [INFO]: 		-> Adding the vectors to the index 03/09/2025, 09:56:44
2025-03-09 09:56:44,146 [INFO]: The memory available for adding the vectors is 49.3GB(total available - used by the index)
2025-03-09 09:56:44,146 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/16 [00:00<?, ?it/s] 12%|█▎        | 2/16 [00:00<00:00, 18.37it/s] 44%|████▍     | 7/16 [00:00<00:00, 31.25it/s] 81%|████████▏ | 13/16 [00:00<00:00, 40.50it/s]100%|██████████| 16/16 [00:03<00:00,  4.41it/s]
2025-03-09 09:56:47,774 [INFO]: 	Computing best hyperparameters for index knn.index 03/09/2025, 09:56:47
2025-03-09 09:57:23,859 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 36.0842 secs
2025-03-09 09:57:23,859 [INFO]: The best hyperparameters are: efSearch=243
2025-03-09 09:57:23,859 [INFO]: 	Compute fast metrics 03/09/2025, 09:57:23
  0%|          | 0/4 [00:00<?, ?it/s] 50%|█████     | 2/4 [00:00<00:00, 16.61it/s] 75%|███████▌  | 3/4 [00:00<00:00, 17.37it/s]
2025-03-09 09:57:38,459 [INFO]: 	>>> Finished "Compute fast metrics" in 14.6002 secs
2025-03-09 09:57:39,366 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 55.2202 secs
2025-03-09 09:57:39,366 [INFO]: {
2025-03-09 09:57:39,366 [INFO]: 	index_key: HNSW15
2025-03-09 09:57:39,366 [INFO]: 	index_param: efSearch=243
2025-03-09 09:57:39,367 [INFO]: 	index_path: knn.index
2025-03-09 09:57:39,367 [INFO]: 	size in bytes: 792288250
2025-03-09 09:57:39,367 [INFO]: 	avg_search_speed_ms: 10.205665000533799
2025-03-09 09:57:39,367 [INFO]: 	99p_search_speed_ms: 22.02044408535593
2025-03-09 09:57:39,367 [INFO]: 	reconstruction error %: 0.0
2025-03-09 09:57:39,367 [INFO]: 	nb vectors: 4027
2025-03-09 09:57:39,367 [INFO]: 	vectors dimension: 49152
2025-03-09 09:57:39,367 [INFO]: 	compression ratio: 0.999308542061554
2025-03-09 09:57:39,367 [INFO]: }
2025-03-09 09:57:39,367 [INFO]: 	>>> Finished "Creating the index" in 55.2226 secs
2025-03-09 09:57:39,367 [INFO]: >>> Finished "Launching the whole pipeline" in 55.2503 secs
2025-03-09 09:57:40: [retrieval_preprocessing] calculating distances ...
2025-03-09 09:57:41: [retrieval_preprocessing] finished and saved retrieval indices for episode 93657 [episode count 17/20]
[retrieval_preprocessing] for episode 13362 [episode count 18/20], we have num_retrieval=np.int64(4002) num_query=np.int64(192)
2025-03-09 09:57:41,317 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-09 09:57:41,797 [INFO]: Launching the whole pipeline 03/09/2025, 09:57:41
2025-03-09 09:57:41,797 [INFO]: Reading total number of vectors and dimension 03/09/2025, 09:57:41
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1260.31it/s]
2025-03-09 09:57:41,827 [INFO]: There are 4002 embeddings of dim 49152
2025-03-09 09:57:41,827 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0297 secs
2025-03-09 09:57:41,827 [INFO]: 	Compute estimated construction time of the index 03/09/2025, 09:57:41
2025-03-09 09:57:41,827 [INFO]: 		-> Train: 16.7 minutes
2025-03-09 09:57:41,827 [INFO]: 		-> Add: 2.2 seconds
2025-03-09 09:57:41,827 [INFO]: 		Total: 16.7 minutes
2025-03-09 09:57:41,827 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0001 secs
2025-03-09 09:57:41,827 [INFO]: 	Checking that your have enough memory available to create the index 03/09/2025, 09:57:41
2025-03-09 09:57:41,827 [INFO]: 825.9MB of memory will be needed to build the index (more might be used if you have more)
2025-03-09 09:57:41,828 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0002 secs
2025-03-09 09:57:41,828 [INFO]: 	Selecting most promising index types given data characteristics 03/09/2025, 09:57:41
2025-03-09 09:57:41,828 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-09 09:57:41,828 [INFO]: 	Creating the index 03/09/2025, 09:57:41
2025-03-09 09:57:41,828 [INFO]: 		-> Instanciate the index HNSW15 03/09/2025, 09:57:41
2025-03-09 09:57:41,829 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0013 secs
2025-03-09 09:57:41,829 [INFO]: 		-> Adding the vectors to the index 03/09/2025, 09:57:41
2025-03-09 09:57:41,829 [INFO]: The memory available for adding the vectors is 49.3GB(total available - used by the index)
2025-03-09 09:57:41,829 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/16 [00:00<?, ?it/s]  6%|▋         | 1/16 [00:00<00:01,  8.65it/s] 44%|████▍     | 7/16 [00:00<00:00, 34.11it/s] 81%|████████▏ | 13/16 [00:00<00:00, 42.26it/s]100%|██████████| 16/16 [00:03<00:00,  4.74it/s]
2025-03-09 09:57:45,207 [INFO]: 	Computing best hyperparameters for index knn.index 03/09/2025, 09:57:45
2025-03-09 09:58:19,399 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 34.1910 secs
2025-03-09 09:58:19,400 [INFO]: The best hyperparameters are: efSearch=224
2025-03-09 09:58:19,400 [INFO]: 	Compute fast metrics 03/09/2025, 09:58:19
  0%|          | 0/4 [00:00<?, ?it/s] 50%|█████     | 2/4 [00:00<00:00, 19.32it/s] 75%|███████▌  | 3/4 [00:00<00:00, 21.23it/s]
2025-03-09 09:58:38,488 [INFO]: 	>>> Finished "Compute fast metrics" in 19.0878 secs
2025-03-09 09:58:38,490 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 56.6608 secs
2025-03-09 09:58:38,490 [INFO]: {
2025-03-09 09:58:38,490 [INFO]: 	index_key: HNSW15
2025-03-09 09:58:38,490 [INFO]: 	index_param: efSearch=224
2025-03-09 09:58:38,490 [INFO]: 	index_path: knn.index
2025-03-09 09:58:38,490 [INFO]: 	size in bytes: 787369630
2025-03-09 09:58:38,490 [INFO]: 	avg_search_speed_ms: 8.854903990981905
2025-03-09 09:58:38,490 [INFO]: 	99p_search_speed_ms: 16.983210854232315
2025-03-09 09:58:38,490 [INFO]: 	reconstruction error %: 0.0
2025-03-09 09:58:38,490 [INFO]: 	nb vectors: 4002
2025-03-09 09:58:38,490 [INFO]: 	vectors dimension: 49152
2025-03-09 09:58:38,490 [INFO]: 	compression ratio: 0.9993085661685986
2025-03-09 09:58:38,490 [INFO]: }
2025-03-09 09:58:38,490 [INFO]: 	>>> Finished "Creating the index" in 56.6625 secs
2025-03-09 09:58:38,490 [INFO]: >>> Finished "Launching the whole pipeline" in 56.6929 secs
2025-03-09 09:58:39: [retrieval_preprocessing] calculating distances ...
2025-03-09 09:58:39: [retrieval_preprocessing] finished and saved retrieval indices for episode 13362 [episode count 18/20]
[retrieval_preprocessing] for episode 39091 [episode count 19/20], we have num_retrieval=np.int64(4028) num_query=np.int64(166)
2025-03-09 09:58:39,959 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-09 09:58:40,418 [INFO]: Launching the whole pipeline 03/09/2025, 09:58:40
2025-03-09 09:58:40,418 [INFO]: Reading total number of vectors and dimension 03/09/2025, 09:58:40
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1209.78it/s]
2025-03-09 09:58:40,446 [INFO]: There are 4028 embeddings of dim 49152
2025-03-09 09:58:40,446 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0281 secs
2025-03-09 09:58:40,446 [INFO]: 	Compute estimated construction time of the index 03/09/2025, 09:58:40
2025-03-09 09:58:40,447 [INFO]: 		-> Train: 16.7 minutes
2025-03-09 09:58:40,447 [INFO]: 		-> Add: 2.2 seconds
2025-03-09 09:58:40,447 [INFO]: 		Total: 16.7 minutes
2025-03-09 09:58:40,447 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0001 secs
2025-03-09 09:58:40,447 [INFO]: 	Checking that your have enough memory available to create the index 03/09/2025, 09:58:40
2025-03-09 09:58:40,447 [INFO]: 831.3MB of memory will be needed to build the index (more might be used if you have more)
2025-03-09 09:58:40,447 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0002 secs
2025-03-09 09:58:40,447 [INFO]: 	Selecting most promising index types given data characteristics 03/09/2025, 09:58:40
2025-03-09 09:58:40,447 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-09 09:58:40,447 [INFO]: 	Creating the index 03/09/2025, 09:58:40
2025-03-09 09:58:40,447 [INFO]: 		-> Instanciate the index HNSW15 03/09/2025, 09:58:40
2025-03-09 09:58:40,448 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0014 secs
2025-03-09 09:58:40,449 [INFO]: 		-> Adding the vectors to the index 03/09/2025, 09:58:40
2025-03-09 09:58:40,449 [INFO]: The memory available for adding the vectors is 49.3GB(total available - used by the index)
2025-03-09 09:58:40,449 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/16 [00:00<?, ?it/s]  6%|▋         | 1/16 [00:00<00:01,  9.05it/s] 44%|████▍     | 7/16 [00:00<00:00, 36.85it/s] 81%|████████▏ | 13/16 [00:00<00:00, 46.28it/s]100%|██████████| 16/16 [00:02<00:00,  5.56it/s]
2025-03-09 09:58:43,328 [INFO]: 	Computing best hyperparameters for index knn.index 03/09/2025, 09:58:43
2025-03-09 09:59:22,751 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 39.4226 secs
2025-03-09 09:59:22,752 [INFO]: The best hyperparameters are: efSearch=218
2025-03-09 09:59:22,752 [INFO]: 	Compute fast metrics 03/09/2025, 09:59:22
  0%|          | 0/4 [00:00<?, ?it/s] 75%|███████▌  | 3/4 [00:00<00:00, 25.94it/s] 75%|███████▌  | 3/4 [00:00<00:00, 22.45it/s]
2025-03-09 09:59:41,313 [INFO]: 	>>> Finished "Compute fast metrics" in 18.5615 secs
2025-03-09 09:59:41,315 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 60.8667 secs
2025-03-09 09:59:41,316 [INFO]: {
2025-03-09 09:59:41,316 [INFO]: 	index_key: HNSW15
2025-03-09 09:59:41,316 [INFO]: 	index_param: efSearch=218
2025-03-09 09:59:41,316 [INFO]: 	index_path: knn.index
2025-03-09 09:59:41,316 [INFO]: 	size in bytes: 792484990
2025-03-09 09:59:41,316 [INFO]: 	avg_search_speed_ms: 8.46769529332507
2025-03-09 09:59:41,316 [INFO]: 	99p_search_speed_ms: 13.757034111768009
2025-03-09 09:59:41,316 [INFO]: 	reconstruction error %: 0.0
2025-03-09 09:59:41,316 [INFO]: 	nb vectors: 4028
2025-03-09 09:59:41,316 [INFO]: 	vectors dimension: 49152
2025-03-09 09:59:41,316 [INFO]: 	compression ratio: 0.9993085471562054
2025-03-09 09:59:41,316 [INFO]: }
2025-03-09 09:59:41,316 [INFO]: 	>>> Finished "Creating the index" in 60.8686 secs
2025-03-09 09:59:41,316 [INFO]: >>> Finished "Launching the whole pipeline" in 60.8974 secs
2025-03-09 09:59:42: [retrieval_preprocessing] calculating distances ...
2025-03-09 09:59:42: [retrieval_preprocessing] finished and saved retrieval indices for episode 39091 [episode count 19/20]
2025-03-09 09:59:42: [retrieval_preprocessing] finished for (5701580274, 'marker') [chosen_id count 9/10]
2025-03-09 09:59:42: [retrieval_preprocessing] done for embedding_type='embeddings__wrist_image_left'!
