nohup: ignoring input
2025-03-09 06:47:47: got the info dicts: there are 36687 groupings

2025-03-09 06:47:47: number of groupings with atleast 50 episodes [in the first 95658 episodes]: 105

these groupings have chosen_id-->num_episodes as

 {(1297764552, 'bottle'): 53, (2515873443, 'cloth'): 50, (5235850418, 'drawer'): 612, (5879622450, 'block'): 108, (1431810548, 'lid'): 51, (3485794757, 'marker'): 97, (8756300955, 'block'): 117, (1180576306, 'cloth'): 60, (9154343709, 'drawer'): 96, (6498288010, 'bottle'): 138, (8911427557, 'bottle'): 50, (1058976383, 'drawer'): 148, (4045730075, 'lid'): 61, (1712293193, 'marker'): 163, (65137982, 'block'): 100, (4329524892, 'cup'): 166, (484659531, 'marker'): 96, (-1, 'marker'): 1032, (6078642573, 'marker'): 54, (452818143, 'lid'): 221, (1461982682, 'cloth'): 76, (5235850418, 'block'): 97, (7495112204, 'marker'): 102, (666854965, 'marker'): 68, (395700094, 'block'): 72, (3827924651, 'lid'): 67, (6612454114, 'block'): 65, (2782099537, 'marker'): 75, (8376714657, 'marker'): 464, (3452853472, 'drawer'): 91, (9306310171, 'marker'): 97, (3816161570, 'drawer'): 78, (5511329841, 'marker'): 59, (3951366978, 'cup'): 112, (1959308322, 'marker'): 65, (3163748394, 'cup'): 127, (7644292911, 'marker'): 50, (1775582436, 'marker'): 98, (4706041793, 'cloth'): 142, (2370783071, 'block'): 50, (9551783935, 'drawer'): 65, (2782099537, 'cup'): 153, (7489911085, 'cloth'): 179, (5576515039, 'marker'): 50, (4465064685, 'marker'): 198, (9186164821, 'bottle'): 57, (5207831207, 'cup'): 139, (3774560981, 'cloth'): 99, (4823049285, 'bottle'): 234, (9130122211, 'marker'): 159, (6313680013, 'cup'): 50, (9088223759, 'bottle'): 99, (8098563998, 'lid'): 73, (9505766118, 'drawer'): 108, (441689524, 'mug'): 77, (8150285641, 'marker'): 63, (8456936732, 'bottle'): 54, (446878712, 'marker'): 83, (6093644330, 'cloth'): 52, (4345518188, 'lid'): 89, (5024387521, 'marker'): 60, (6498288010, 'lid'): 96, (4823049285, 'block'): 174, (6667529842, 'lid'): 90, (5507987860, 'marker'): 100, (8898968162, 'block'): 58, (-1, 'mug'): 228, (9965421062, 'bottle'): 63, (6357288647, 'lid'): 71, (5701580274, 'marker'): 67, (1469427884, 'marker'): 63, (9933578360, 'drawer'): 53, (1498834123, 'cup'): 77, (440287856, 'drawer'): 75, (376702246, 'cup'): 53, (9883209091, 'mug'): 201, (9934859632, 'marker'): 62, (4312815282, 'marker'): 66, (-1, 'cup'): 113, (8922050678, 'lid'): 64, (2883696971, 'cup'): 69, (9209350647, 'drawer'): 76, (6655265581, 'cup'): 51, (4345518188, 'cloth'): 91, (4545879864, 'marker'): 51, (818725642, 'block'): 63, (3854327802, 'bottle'): 97, (3951366978, 'lid'): 72, (5059283044, 'drawer'): 113, (4846810092, 'cloth'): 93, (8690198922, 'marker'): 65, (1477699675, 'marker'): 89, (4400212150, 'marker'): 52, (1526685371, 'marker'): 62, (6074146895, 'lid'): 59, (8911427557, 'cup'): 112, (8702636502, 'lid'): 90, (8172596608, 'cup'): 51, (1575177183, 'marker'): 59, (5414640868, 'lid'): 56, (1477699675, 'mug'): 57, (9228483020, 'marker'): 80, (2927338332, 'cloth'): 51, (52817038, 'block'): 54, (8815207926, 'block'): 54}
2025-03-09 06:47:47: [retrieval_preprocessing] starting retrieval preprocessing for embeddings__wrist_image_left
2025-03-09 06:47:51: [retrieval_preprocessing] concatenated all embeddings and indices for 20 episodes for (1469427884, 'marker') [chosen_id count 0/10]
2025-03-09 06:47:51: [retrieval_preprocessing] we have num_total=4226 embedding_dim=49152
[retrieval_preprocessing] for episode 62209 [episode count 0/20], we have num_retrieval=np.int64(4051) num_query=np.int64(175)
2025-03-09 06:47:53,266 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-09 06:47:53,927 [INFO]: Launching the whole pipeline 03/09/2025, 06:47:53
2025-03-09 06:47:53,927 [INFO]: Reading total number of vectors and dimension 03/09/2025, 06:47:53
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 4401.16it/s]
2025-03-09 06:47:53,965 [INFO]: There are 4051 embeddings of dim 49152
2025-03-09 06:47:53,966 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0385 secs
2025-03-09 06:47:53,966 [INFO]: 	Compute estimated construction time of the index 03/09/2025, 06:47:53
2025-03-09 06:47:53,966 [INFO]: 		-> Train: 16.7 minutes
2025-03-09 06:47:53,966 [INFO]: 		-> Add: 2.2 seconds
2025-03-09 06:47:53,966 [INFO]: 		Total: 16.7 minutes
2025-03-09 06:47:53,966 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0002 secs
2025-03-09 06:47:53,966 [INFO]: 	Checking that your have enough memory available to create the index 03/09/2025, 06:47:53
2025-03-09 06:47:53,967 [INFO]: 836.0MB of memory will be needed to build the index (more might be used if you have more)
2025-03-09 06:47:53,967 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0010 secs
2025-03-09 06:47:53,967 [INFO]: 	Selecting most promising index types given data characteristics 03/09/2025, 06:47:53
2025-03-09 06:47:53,967 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-09 06:47:53,967 [INFO]: 	Creating the index 03/09/2025, 06:47:53
2025-03-09 06:47:53,968 [INFO]: 		-> Instanciate the index HNSW15 03/09/2025, 06:47:53
2025-03-09 06:47:53,969 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0017 secs
2025-03-09 06:47:53,969 [INFO]: 		-> Adding the vectors to the index 03/09/2025, 06:47:53
2025-03-09 06:47:53,970 [INFO]: The memory available for adding the vectors is 49.3GB(total available - used by the index)
2025-03-09 06:47:53,970 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/16 [00:00<?, ?it/s]  6%|▋         | 1/16 [00:00<00:02,  6.36it/s] 19%|█▉        | 3/16 [00:00<00:01,  8.55it/s] 25%|██▌       | 4/16 [00:00<00:01,  8.50it/s] 31%|███▏      | 5/16 [00:00<00:01,  8.39it/s] 38%|███▊      | 6/16 [00:00<00:01,  8.37it/s] 50%|█████     | 8/16 [00:00<00:00, 10.62it/s] 62%|██████▎   | 10/16 [00:01<00:00, 11.42it/s] 75%|███████▌  | 12/16 [00:01<00:00, 10.29it/s] 88%|████████▊ | 14/16 [00:01<00:00,  9.77it/s]100%|██████████| 16/16 [00:04<00:00,  1.77it/s]100%|██████████| 16/16 [00:04<00:00,  3.57it/s]
2025-03-09 06:47:58,452 [INFO]: 	Computing best hyperparameters for index knn.index 03/09/2025, 06:47:58
2025-03-09 06:48:39,725 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 41.2728 secs
2025-03-09 06:48:39,725 [INFO]: The best hyperparameters are: efSearch=189
2025-03-09 06:48:39,726 [INFO]: 	Compute fast metrics 03/09/2025, 06:48:39
  0%|          | 0/4 [00:00<?, ?it/s] 25%|██▌       | 1/4 [00:00<00:00,  7.14it/s] 50%|█████     | 2/4 [00:00<00:00,  7.97it/s] 75%|███████▌  | 3/4 [00:00<00:00,  8.15it/s] 75%|███████▌  | 3/4 [00:00<00:00,  6.10it/s]
2025-03-09 06:48:52,895 [INFO]: 	>>> Finished "Compute fast metrics" in 13.1687 secs
2025-03-09 06:48:52,897 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 58.9277 secs
2025-03-09 06:48:52,897 [INFO]: {
2025-03-09 06:48:52,897 [INFO]: 	index_key: HNSW15
2025-03-09 06:48:52,897 [INFO]: 	index_param: efSearch=189
2025-03-09 06:48:52,897 [INFO]: 	index_path: knn.index
2025-03-09 06:48:52,897 [INFO]: 	size in bytes: 797010070
2025-03-09 06:48:52,897 [INFO]: 	avg_search_speed_ms: 9.46816887440174
2025-03-09 06:48:52,897 [INFO]: 	99p_search_speed_ms: 17.684784182347357
2025-03-09 06:48:52,898 [INFO]: 	reconstruction error %: 0.0
2025-03-09 06:48:52,898 [INFO]: 	nb vectors: 4051
2025-03-09 06:48:52,898 [INFO]: 	vectors dimension: 49152
2025-03-09 06:48:52,898 [INFO]: 	compression ratio: 0.9993085884096797
2025-03-09 06:48:52,898 [INFO]: }
2025-03-09 06:48:52,898 [INFO]: 	>>> Finished "Creating the index" in 58.9300 secs
2025-03-09 06:48:52,898 [INFO]: >>> Finished "Launching the whole pipeline" in 58.9704 secs
2025-03-09 06:48:53: [retrieval_preprocessing] calculating distances ...
2025-03-09 06:48:54: [retrieval_preprocessing] finished and saved retrieval indices for episode 62209 [episode count 0/20]
[retrieval_preprocessing] for episode 67073 [episode count 1/20], we have num_retrieval=np.int64(4062) num_query=np.int64(164)
2025-03-09 06:48:55,528 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-09 06:48:56,080 [INFO]: Launching the whole pipeline 03/09/2025, 06:48:56
2025-03-09 06:48:56,080 [INFO]: Reading total number of vectors and dimension 03/09/2025, 06:48:56
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1790.91it/s]
2025-03-09 06:48:56,102 [INFO]: There are 4062 embeddings of dim 49152
2025-03-09 06:48:56,102 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0225 secs
2025-03-09 06:48:56,102 [INFO]: 	Compute estimated construction time of the index 03/09/2025, 06:48:56
2025-03-09 06:48:56,103 [INFO]: 		-> Train: 16.7 minutes
2025-03-09 06:48:56,103 [INFO]: 		-> Add: 2.2 seconds
2025-03-09 06:48:56,103 [INFO]: 		Total: 16.7 minutes
2025-03-09 06:48:56,103 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0001 secs
2025-03-09 06:48:56,103 [INFO]: 	Checking that your have enough memory available to create the index 03/09/2025, 06:48:56
2025-03-09 06:48:56,103 [INFO]: 838.3MB of memory will be needed to build the index (more might be used if you have more)
2025-03-09 06:48:56,103 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0002 secs
2025-03-09 06:48:56,103 [INFO]: 	Selecting most promising index types given data characteristics 03/09/2025, 06:48:56
2025-03-09 06:48:56,103 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-09 06:48:56,103 [INFO]: 	Creating the index 03/09/2025, 06:48:56
2025-03-09 06:48:56,103 [INFO]: 		-> Instanciate the index HNSW15 03/09/2025, 06:48:56
2025-03-09 06:48:56,104 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0009 secs
2025-03-09 06:48:56,104 [INFO]: 		-> Adding the vectors to the index 03/09/2025, 06:48:56
2025-03-09 06:48:56,104 [INFO]: The memory available for adding the vectors is 49.3GB(total available - used by the index)
2025-03-09 06:48:56,104 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/16 [00:00<?, ?it/s]  6%|▋         | 1/16 [00:00<00:02,  6.23it/s] 19%|█▉        | 3/16 [00:00<00:01,  9.81it/s] 31%|███▏      | 5/16 [00:00<00:01, 10.92it/s] 44%|████▍     | 7/16 [00:00<00:00, 11.25it/s] 56%|█████▋    | 9/16 [00:00<00:00, 11.55it/s] 69%|██████▉   | 11/16 [00:00<00:00, 12.97it/s] 81%|████████▏ | 13/16 [00:01<00:00, 13.78it/s] 94%|█████████▍| 15/16 [00:01<00:00, 13.12it/s]100%|██████████| 16/16 [00:04<00:00,  3.47it/s]
2025-03-09 06:49:00,731 [INFO]: 	Computing best hyperparameters for index knn.index 03/09/2025, 06:49:00
2025-03-09 06:49:42,945 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 42.2137 secs
2025-03-09 06:49:42,945 [INFO]: The best hyperparameters are: efSearch=180
2025-03-09 06:49:42,945 [INFO]: 	Compute fast metrics 03/09/2025, 06:49:42
  0%|          | 0/4 [00:00<?, ?it/s] 25%|██▌       | 1/4 [00:00<00:00,  4.20it/s] 75%|███████▌  | 3/4 [00:00<00:00,  7.74it/s] 75%|███████▌  | 3/4 [00:00<00:00,  5.91it/s]
2025-03-09 06:49:56,386 [INFO]: 	>>> Finished "Compute fast metrics" in 13.4407 secs
2025-03-09 06:49:56,390 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 60.2855 secs
2025-03-09 06:49:56,390 [INFO]: {
2025-03-09 06:49:56,390 [INFO]: 	index_key: HNSW15
2025-03-09 06:49:56,390 [INFO]: 	index_param: efSearch=180
2025-03-09 06:49:56,390 [INFO]: 	index_path: knn.index
2025-03-09 06:49:56,390 [INFO]: 	size in bytes: 799174210
2025-03-09 06:49:56,390 [INFO]: 	avg_search_speed_ms: 9.29094217337163
2025-03-09 06:49:56,390 [INFO]: 	99p_search_speed_ms: 19.57951401360333
2025-03-09 06:49:56,390 [INFO]: 	reconstruction error %: 0.0
2025-03-09 06:49:56,390 [INFO]: 	nb vectors: 4062
2025-03-09 06:49:56,390 [INFO]: 	vectors dimension: 49152
2025-03-09 06:49:56,390 [INFO]: 	compression ratio: 0.9993086438562626
2025-03-09 06:49:56,390 [INFO]: }
2025-03-09 06:49:56,390 [INFO]: 	>>> Finished "Creating the index" in 60.2869 secs
2025-03-09 06:49:56,390 [INFO]: >>> Finished "Launching the whole pipeline" in 60.3101 secs
2025-03-09 06:49:57: [retrieval_preprocessing] calculating distances ...
2025-03-09 06:49:57: [retrieval_preprocessing] finished and saved retrieval indices for episode 67073 [episode count 1/20]
[retrieval_preprocessing] for episode 32900 [episode count 2/20], we have num_retrieval=np.int64(4057) num_query=np.int64(169)
2025-03-09 06:49:59,126 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-09 06:49:59,752 [INFO]: Launching the whole pipeline 03/09/2025, 06:49:59
2025-03-09 06:49:59,752 [INFO]: Reading total number of vectors and dimension 03/09/2025, 06:49:59
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1431.50it/s]
2025-03-09 06:49:59,777 [INFO]: There are 4057 embeddings of dim 49152
2025-03-09 06:49:59,778 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0255 secs
2025-03-09 06:49:59,778 [INFO]: 	Compute estimated construction time of the index 03/09/2025, 06:49:59
2025-03-09 06:49:59,778 [INFO]: 		-> Train: 16.7 minutes
2025-03-09 06:49:59,778 [INFO]: 		-> Add: 2.2 seconds
2025-03-09 06:49:59,778 [INFO]: 		Total: 16.7 minutes
2025-03-09 06:49:59,778 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0001 secs
2025-03-09 06:49:59,778 [INFO]: 	Checking that your have enough memory available to create the index 03/09/2025, 06:49:59
2025-03-09 06:49:59,778 [INFO]: 837.3MB of memory will be needed to build the index (more might be used if you have more)
2025-03-09 06:49:59,778 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0001 secs
2025-03-09 06:49:59,778 [INFO]: 	Selecting most promising index types given data characteristics 03/09/2025, 06:49:59
2025-03-09 06:49:59,778 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-09 06:49:59,778 [INFO]: 	Creating the index 03/09/2025, 06:49:59
2025-03-09 06:49:59,778 [INFO]: 		-> Instanciate the index HNSW15 03/09/2025, 06:49:59
2025-03-09 06:49:59,779 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0008 secs
2025-03-09 06:49:59,779 [INFO]: 		-> Adding the vectors to the index 03/09/2025, 06:49:59
2025-03-09 06:49:59,779 [INFO]: The memory available for adding the vectors is 49.3GB(total available - used by the index)
2025-03-09 06:49:59,779 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/16 [00:00<?, ?it/s]  6%|▋         | 1/16 [00:00<00:02,  6.02it/s] 19%|█▉        | 3/16 [00:00<00:01,  9.29it/s] 31%|███▏      | 5/16 [00:00<00:01, 10.33it/s] 44%|████▍     | 7/16 [00:00<00:00, 10.88it/s] 56%|█████▋    | 9/16 [00:00<00:00, 11.41it/s] 69%|██████▉   | 11/16 [00:00<00:00, 12.76it/s] 81%|████████▏ | 13/16 [00:01<00:00, 12.28it/s] 94%|█████████▍| 15/16 [00:01<00:00, 12.41it/s]100%|██████████| 16/16 [00:04<00:00,  3.58it/s]
2025-03-09 06:50:04,254 [INFO]: 	Computing best hyperparameters for index knn.index 03/09/2025, 06:50:04
2025-03-09 06:50:41,467 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 37.2129 secs
2025-03-09 06:50:41,468 [INFO]: The best hyperparameters are: efSearch=172
2025-03-09 06:50:41,468 [INFO]: 	Compute fast metrics 03/09/2025, 06:50:41
  0%|          | 0/4 [00:00<?, ?it/s] 25%|██▌       | 1/4 [00:00<00:00,  5.16it/s] 75%|███████▌  | 3/4 [00:00<00:00,  8.03it/s] 75%|███████▌  | 3/4 [00:00<00:00,  6.13it/s]
2025-03-09 06:51:06,704 [INFO]: 	>>> Finished "Compute fast metrics" in 25.2363 secs
2025-03-09 06:51:06,708 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 66.9289 secs
2025-03-09 06:51:06,708 [INFO]: {
2025-03-09 06:51:06,708 [INFO]: 	index_key: HNSW15
2025-03-09 06:51:06,708 [INFO]: 	index_param: efSearch=172
2025-03-09 06:51:06,708 [INFO]: 	index_path: knn.index
2025-03-09 06:51:06,708 [INFO]: 	size in bytes: 798190510
2025-03-09 06:51:06,708 [INFO]: 	avg_search_speed_ms: 8.823433064420799
2025-03-09 06:51:06,708 [INFO]: 	99p_search_speed_ms: 16.570778610184806
2025-03-09 06:51:06,708 [INFO]: 	reconstruction error %: 0.0
2025-03-09 06:51:06,708 [INFO]: 	nb vectors: 4057
2025-03-09 06:51:06,708 [INFO]: 	vectors dimension: 49152
2025-03-09 06:51:06,708 [INFO]: 	compression ratio: 0.999308618690543
2025-03-09 06:51:06,708 [INFO]: }
2025-03-09 06:51:06,708 [INFO]: 	>>> Finished "Creating the index" in 66.9303 secs
2025-03-09 06:51:06,708 [INFO]: >>> Finished "Launching the whole pipeline" in 66.9563 secs
2025-03-09 06:51:07: [retrieval_preprocessing] calculating distances ...
2025-03-09 06:51:08: [retrieval_preprocessing] finished and saved retrieval indices for episode 32900 [episode count 2/20]
[retrieval_preprocessing] for episode 5624 [episode count 3/20], we have num_retrieval=np.int64(4014) num_query=np.int64(212)
2025-03-09 06:51:09,746 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-09 06:51:10,381 [INFO]: Launching the whole pipeline 03/09/2025, 06:51:10
2025-03-09 06:51:10,381 [INFO]: Reading total number of vectors and dimension 03/09/2025, 06:51:10
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1299.75it/s]
2025-03-09 06:51:10,411 [INFO]: There are 4014 embeddings of dim 49152
2025-03-09 06:51:10,412 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0305 secs
2025-03-09 06:51:10,412 [INFO]: 	Compute estimated construction time of the index 03/09/2025, 06:51:10
2025-03-09 06:51:10,412 [INFO]: 		-> Train: 16.7 minutes
2025-03-09 06:51:10,412 [INFO]: 		-> Add: 2.2 seconds
2025-03-09 06:51:10,412 [INFO]: 		Total: 16.7 minutes
2025-03-09 06:51:10,412 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0004 secs
2025-03-09 06:51:10,413 [INFO]: 	Checking that your have enough memory available to create the index 03/09/2025, 06:51:10
2025-03-09 06:51:10,413 [INFO]: 828.4MB of memory will be needed to build the index (more might be used if you have more)
2025-03-09 06:51:10,413 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0004 secs
2025-03-09 06:51:10,413 [INFO]: 	Selecting most promising index types given data characteristics 03/09/2025, 06:51:10
2025-03-09 06:51:10,413 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-09 06:51:10,413 [INFO]: 	Creating the index 03/09/2025, 06:51:10
2025-03-09 06:51:10,413 [INFO]: 		-> Instanciate the index HNSW15 03/09/2025, 06:51:10
2025-03-09 06:51:10,416 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0024 secs
2025-03-09 06:51:10,416 [INFO]: 		-> Adding the vectors to the index 03/09/2025, 06:51:10
2025-03-09 06:51:10,416 [INFO]: The memory available for adding the vectors is 49.3GB(total available - used by the index)
2025-03-09 06:51:10,416 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/16 [00:00<?, ?it/s]  6%|▋         | 1/16 [00:00<00:01,  7.98it/s] 19%|█▉        | 3/16 [00:00<00:01,  9.95it/s] 31%|███▏      | 5/16 [00:00<00:00, 12.44it/s] 56%|█████▋    | 9/16 [00:00<00:00, 19.63it/s] 75%|███████▌  | 12/16 [00:00<00:00, 20.09it/s] 94%|█████████▍| 15/16 [00:00<00:00, 19.65it/s]100%|██████████| 16/16 [00:04<00:00,  3.52it/s]
2025-03-09 06:51:14,967 [INFO]: 	Computing best hyperparameters for index knn.index 03/09/2025, 06:51:14
2025-03-09 06:51:53,485 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 38.5168 secs
2025-03-09 06:51:53,485 [INFO]: The best hyperparameters are: efSearch=198
2025-03-09 06:51:53,485 [INFO]: 	Compute fast metrics 03/09/2025, 06:51:53
  0%|          | 0/4 [00:00<?, ?it/s] 25%|██▌       | 1/4 [00:00<00:00,  4.54it/s] 50%|█████     | 2/4 [00:00<00:00,  6.23it/s] 75%|███████▌  | 3/4 [00:00<00:00,  7.05it/s] 75%|███████▌  | 3/4 [00:00<00:00,  5.34it/s]
2025-03-09 06:52:06,802 [INFO]: 	>>> Finished "Compute fast metrics" in 13.3166 secs
2025-03-09 06:52:06,805 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 56.3890 secs
2025-03-09 06:52:06,806 [INFO]: {
2025-03-09 06:52:06,806 [INFO]: 	index_key: HNSW15
2025-03-09 06:52:06,806 [INFO]: 	index_param: efSearch=198
2025-03-09 06:52:06,806 [INFO]: 	index_path: knn.index
2025-03-09 06:52:06,806 [INFO]: 	size in bytes: 789730630
2025-03-09 06:52:06,806 [INFO]: 	avg_search_speed_ms: 9.200901657783296
2025-03-09 06:52:06,806 [INFO]: 	99p_search_speed_ms: 13.818227075971665
2025-03-09 06:52:06,806 [INFO]: 	reconstruction error %: 0.0
2025-03-09 06:52:06,806 [INFO]: 	nb vectors: 4014
2025-03-09 06:52:06,806 [INFO]: 	vectors dimension: 49152
2025-03-09 06:52:06,806 [INFO]: 	compression ratio: 0.9993084756000916
2025-03-09 06:52:06,806 [INFO]: }
2025-03-09 06:52:06,806 [INFO]: 	>>> Finished "Creating the index" in 56.3930 secs
2025-03-09 06:52:06,806 [INFO]: >>> Finished "Launching the whole pipeline" in 56.4252 secs
2025-03-09 06:52:07: [retrieval_preprocessing] calculating distances ...
2025-03-09 06:52:08: [retrieval_preprocessing] finished and saved retrieval indices for episode 5624 [episode count 3/20]
[retrieval_preprocessing] for episode 10890 [episode count 4/20], we have num_retrieval=np.int64(4051) num_query=np.int64(175)
2025-03-09 06:52:10,039 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-09 06:52:10,587 [INFO]: Launching the whole pipeline 03/09/2025, 06:52:10
2025-03-09 06:52:10,587 [INFO]: Reading total number of vectors and dimension 03/09/2025, 06:52:10
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1677.72it/s]
2025-03-09 06:52:10,612 [INFO]: There are 4051 embeddings of dim 49152
2025-03-09 06:52:10,612 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0251 secs
2025-03-09 06:52:10,612 [INFO]: 	Compute estimated construction time of the index 03/09/2025, 06:52:10
2025-03-09 06:52:10,612 [INFO]: 		-> Train: 16.7 minutes
2025-03-09 06:52:10,612 [INFO]: 		-> Add: 2.2 seconds
2025-03-09 06:52:10,612 [INFO]: 		Total: 16.7 minutes
2025-03-09 06:52:10,612 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0001 secs
2025-03-09 06:52:10,612 [INFO]: 	Checking that your have enough memory available to create the index 03/09/2025, 06:52:10
2025-03-09 06:52:10,612 [INFO]: 836.0MB of memory will be needed to build the index (more might be used if you have more)
2025-03-09 06:52:10,612 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0001 secs
2025-03-09 06:52:10,612 [INFO]: 	Selecting most promising index types given data characteristics 03/09/2025, 06:52:10
2025-03-09 06:52:10,612 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-09 06:52:10,612 [INFO]: 	Creating the index 03/09/2025, 06:52:10
2025-03-09 06:52:10,612 [INFO]: 		-> Instanciate the index HNSW15 03/09/2025, 06:52:10
2025-03-09 06:52:10,613 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0009 secs
2025-03-09 06:52:10,613 [INFO]: 		-> Adding the vectors to the index 03/09/2025, 06:52:10
2025-03-09 06:52:10,613 [INFO]: The memory available for adding the vectors is 49.3GB(total available - used by the index)
2025-03-09 06:52:10,613 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/16 [00:00<?, ?it/s]  6%|▋         | 1/16 [00:00<00:03,  4.45it/s] 12%|█▎        | 2/16 [00:00<00:02,  6.30it/s] 19%|█▉        | 3/16 [00:00<00:01,  7.26it/s] 25%|██▌       | 4/16 [00:00<00:01,  8.04it/s] 56%|█████▋    | 9/16 [00:00<00:00, 20.06it/s] 88%|████████▊ | 14/16 [00:00<00:00, 27.65it/s]100%|██████████| 16/16 [00:04<00:00,  3.62it/s]
2025-03-09 06:52:15,044 [INFO]: 	Computing best hyperparameters for index knn.index 03/09/2025, 06:52:15
2025-03-09 06:52:57,965 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 42.9202 secs
2025-03-09 06:52:57,966 [INFO]: The best hyperparameters are: efSearch=160
2025-03-09 06:52:57,966 [INFO]: 	Compute fast metrics 03/09/2025, 06:52:57
  0%|          | 0/4 [00:00<?, ?it/s] 50%|█████     | 2/4 [00:00<00:00, 18.00it/s] 75%|███████▌  | 3/4 [00:00<00:00, 19.97it/s]
2025-03-09 06:53:11,001 [INFO]: 	>>> Finished "Compute fast metrics" in 13.0352 secs
2025-03-09 06:53:11,005 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 60.3914 secs
2025-03-09 06:53:11,005 [INFO]: {
2025-03-09 06:53:11,005 [INFO]: 	index_key: HNSW15
2025-03-09 06:53:11,005 [INFO]: 	index_param: efSearch=160
2025-03-09 06:53:11,005 [INFO]: 	index_path: knn.index
2025-03-09 06:53:11,005 [INFO]: 	size in bytes: 797010070
2025-03-09 06:53:11,005 [INFO]: 	avg_search_speed_ms: 9.446731040375598
2025-03-09 06:53:11,005 [INFO]: 	99p_search_speed_ms: 20.757750556804243
2025-03-09 06:53:11,005 [INFO]: 	reconstruction error %: 0.0
2025-03-09 06:53:11,005 [INFO]: 	nb vectors: 4051
2025-03-09 06:53:11,005 [INFO]: 	vectors dimension: 49152
2025-03-09 06:53:11,005 [INFO]: 	compression ratio: 0.9993085884096797
2025-03-09 06:53:11,005 [INFO]: }
2025-03-09 06:53:11,005 [INFO]: 	>>> Finished "Creating the index" in 60.3929 secs
2025-03-09 06:53:11,005 [INFO]: >>> Finished "Launching the whole pipeline" in 60.4185 secs
2025-03-09 06:53:12: [retrieval_preprocessing] calculating distances ...
2025-03-09 06:53:12: [retrieval_preprocessing] finished and saved retrieval indices for episode 10890 [episode count 4/20]
[retrieval_preprocessing] for episode 18700 [episode count 5/20], we have num_retrieval=np.int64(3826) num_query=np.int64(400)
2025-03-09 06:53:14,467 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-09 06:53:15,183 [INFO]: Launching the whole pipeline 03/09/2025, 06:53:15
2025-03-09 06:53:15,183 [INFO]: Reading total number of vectors and dimension 03/09/2025, 06:53:15
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1476.87it/s]
2025-03-09 06:53:15,212 [INFO]: There are 3826 embeddings of dim 49152
2025-03-09 06:53:15,213 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0292 secs
2025-03-09 06:53:15,213 [INFO]: 	Compute estimated construction time of the index 03/09/2025, 06:53:15
2025-03-09 06:53:15,213 [INFO]: 		-> Train: 16.7 minutes
2025-03-09 06:53:15,213 [INFO]: 		-> Add: 2.1 seconds
2025-03-09 06:53:15,213 [INFO]: 		Total: 16.7 minutes
2025-03-09 06:53:15,213 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0004 secs
2025-03-09 06:53:15,213 [INFO]: 	Checking that your have enough memory available to create the index 03/09/2025, 06:53:15
2025-03-09 06:53:15,214 [INFO]: 789.6MB of memory will be needed to build the index (more might be used if you have more)
2025-03-09 06:53:15,214 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0005 secs
2025-03-09 06:53:15,214 [INFO]: 	Selecting most promising index types given data characteristics 03/09/2025, 06:53:15
2025-03-09 06:53:15,214 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-09 06:53:15,214 [INFO]: 	Creating the index 03/09/2025, 06:53:15
2025-03-09 06:53:15,214 [INFO]: 		-> Instanciate the index HNSW15 03/09/2025, 06:53:15
2025-03-09 06:53:15,217 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0028 secs
2025-03-09 06:53:15,218 [INFO]: 		-> Adding the vectors to the index 03/09/2025, 06:53:15
2025-03-09 06:53:15,218 [INFO]: The memory available for adding the vectors is 49.3GB(total available - used by the index)
2025-03-09 06:53:15,218 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/16 [00:00<?, ?it/s]  6%|▋         | 1/16 [00:00<00:03,  4.48it/s] 12%|█▎        | 2/16 [00:00<00:02,  5.76it/s] 19%|█▉        | 3/16 [00:00<00:01,  6.86it/s] 25%|██▌       | 4/16 [00:00<00:01,  7.46it/s] 38%|███▊      | 6/16 [00:00<00:00, 10.15it/s] 50%|█████     | 8/16 [00:00<00:00, 11.21it/s] 69%|██████▉   | 11/16 [00:01<00:00, 14.70it/s] 94%|█████████▍| 15/16 [00:01<00:00, 19.33it/s]100%|██████████| 16/16 [00:04<00:00,  3.39it/s]
2025-03-09 06:53:19,940 [INFO]: 	Computing best hyperparameters for index knn.index 03/09/2025, 06:53:19
2025-03-09 06:53:58,716 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 38.7746 secs
2025-03-09 06:53:58,716 [INFO]: The best hyperparameters are: efSearch=106
2025-03-09 06:53:58,716 [INFO]: 	Compute fast metrics 03/09/2025, 06:53:58
  0%|          | 0/4 [00:00<?, ?it/s] 25%|██▌       | 1/4 [00:00<00:00,  7.68it/s] 75%|███████▌  | 3/4 [00:00<00:00, 10.32it/s] 75%|███████▌  | 3/4 [00:00<00:00,  7.93it/s]
2025-03-09 06:54:11,024 [INFO]: 	>>> Finished "Compute fast metrics" in 12.3079 secs
2025-03-09 06:54:11,028 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 55.8103 secs
2025-03-09 06:54:11,028 [INFO]: {
2025-03-09 06:54:11,028 [INFO]: 	index_key: HNSW15
2025-03-09 06:54:11,028 [INFO]: 	index_param: efSearch=106
2025-03-09 06:54:11,028 [INFO]: 	index_path: knn.index
2025-03-09 06:54:11,028 [INFO]: 	size in bytes: 752742310
2025-03-09 06:54:11,028 [INFO]: 	avg_search_speed_ms: 7.061742333133605
2025-03-09 06:54:11,028 [INFO]: 	99p_search_speed_ms: 12.089195195585464
2025-03-09 06:54:11,028 [INFO]: 	reconstruction error %: 0.0
2025-03-09 06:54:11,028 [INFO]: 	nb vectors: 3826
2025-03-09 06:54:11,028 [INFO]: 	vectors dimension: 49152
2025-03-09 06:54:11,028 [INFO]: 	compression ratio: 0.9993090570397192
2025-03-09 06:54:11,028 [INFO]: }
2025-03-09 06:54:11,028 [INFO]: 	>>> Finished "Creating the index" in 55.8142 secs
2025-03-09 06:54:11,029 [INFO]: >>> Finished "Launching the whole pipeline" in 55.8452 secs
2025-03-09 06:54:11: [retrieval_preprocessing] calculating distances ...
2025-03-09 06:54:13: [retrieval_preprocessing] finished and saved retrieval indices for episode 18700 [episode count 5/20]
[retrieval_preprocessing] for episode 17421 [episode count 6/20], we have num_retrieval=np.int64(3899) num_query=np.int64(327)
2025-03-09 06:54:14,059 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-09 06:54:14,657 [INFO]: Launching the whole pipeline 03/09/2025, 06:54:14
2025-03-09 06:54:14,657 [INFO]: Reading total number of vectors and dimension 03/09/2025, 06:54:14
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1057.83it/s]
2025-03-09 06:54:14,696 [INFO]: There are 3899 embeddings of dim 49152
2025-03-09 06:54:14,696 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0395 secs
2025-03-09 06:54:14,696 [INFO]: 	Compute estimated construction time of the index 03/09/2025, 06:54:14
2025-03-09 06:54:14,696 [INFO]: 		-> Train: 16.7 minutes
2025-03-09 06:54:14,696 [INFO]: 		-> Add: 2.1 seconds
2025-03-09 06:54:14,696 [INFO]: 		Total: 16.7 minutes
2025-03-09 06:54:14,696 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0001 secs
2025-03-09 06:54:14,696 [INFO]: 	Checking that your have enough memory available to create the index 03/09/2025, 06:54:14
2025-03-09 06:54:14,697 [INFO]: 804.7MB of memory will be needed to build the index (more might be used if you have more)
2025-03-09 06:54:14,697 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0002 secs
2025-03-09 06:54:14,697 [INFO]: 	Selecting most promising index types given data characteristics 03/09/2025, 06:54:14
2025-03-09 06:54:14,697 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-09 06:54:14,697 [INFO]: 	Creating the index 03/09/2025, 06:54:14
2025-03-09 06:54:14,697 [INFO]: 		-> Instanciate the index HNSW15 03/09/2025, 06:54:14
2025-03-09 06:54:14,699 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0016 secs
2025-03-09 06:54:14,699 [INFO]: 		-> Adding the vectors to the index 03/09/2025, 06:54:14
2025-03-09 06:54:14,699 [INFO]: The memory available for adding the vectors is 49.3GB(total available - used by the index)
2025-03-09 06:54:14,699 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/16 [00:00<?, ?it/s] 12%|█▎        | 2/16 [00:00<00:00, 16.69it/s] 44%|████▍     | 7/16 [00:00<00:00, 34.73it/s] 81%|████████▏ | 13/16 [00:00<00:00, 43.46it/s]100%|██████████| 16/16 [00:03<00:00,  4.87it/s]
2025-03-09 06:54:17,991 [INFO]: 	Computing best hyperparameters for index knn.index 03/09/2025, 06:54:17
2025-03-09 06:54:59,949 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 41.9569 secs
2025-03-09 06:54:59,949 [INFO]: The best hyperparameters are: efSearch=188
2025-03-09 06:54:59,949 [INFO]: 	Compute fast metrics 03/09/2025, 06:54:59
  0%|          | 0/4 [00:00<?, ?it/s] 50%|█████     | 2/4 [00:00<00:00, 18.45it/s] 75%|███████▌  | 3/4 [00:00<00:00, 19.87it/s]
2025-03-09 06:55:12,302 [INFO]: 	>>> Finished "Compute fast metrics" in 12.3533 secs
2025-03-09 06:55:12,305 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 57.6062 secs
2025-03-09 06:55:12,305 [INFO]: {
2025-03-09 06:55:12,305 [INFO]: 	index_key: HNSW15
2025-03-09 06:55:12,305 [INFO]: 	index_param: efSearch=188
2025-03-09 06:55:12,305 [INFO]: 	index_path: knn.index
2025-03-09 06:55:12,305 [INFO]: 	size in bytes: 767104810
2025-03-09 06:55:12,305 [INFO]: 	avg_search_speed_ms: 10.638814983151132
2025-03-09 06:55:12,305 [INFO]: 	99p_search_speed_ms: 15.267507871612926
2025-03-09 06:55:12,305 [INFO]: 	reconstruction error %: 0.0
2025-03-09 06:55:12,306 [INFO]: 	nb vectors: 3899
2025-03-09 06:55:12,306 [INFO]: 	vectors dimension: 49152
2025-03-09 06:55:12,306 [INFO]: 	compression ratio: 0.9993088063155281
2025-03-09 06:55:12,306 [INFO]: }
2025-03-09 06:55:12,306 [INFO]: 	>>> Finished "Creating the index" in 57.6086 secs
2025-03-09 06:55:12,306 [INFO]: >>> Finished "Launching the whole pipeline" in 57.6489 secs
2025-03-09 06:55:14: [retrieval_preprocessing] calculating distances ...
2025-03-09 06:55:15: [retrieval_preprocessing] finished and saved retrieval indices for episode 17421 [episode count 6/20]
[retrieval_preprocessing] for episode 18958 [episode count 7/20], we have num_retrieval=np.int64(4053) num_query=np.int64(173)
2025-03-09 06:55:15,740 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-09 06:55:16,287 [INFO]: Launching the whole pipeline 03/09/2025, 06:55:16
2025-03-09 06:55:16,287 [INFO]: Reading total number of vectors and dimension 03/09/2025, 06:55:16
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1749.81it/s]
2025-03-09 06:55:16,318 [INFO]: There are 4053 embeddings of dim 49152
2025-03-09 06:55:16,319 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0312 secs
2025-03-09 06:55:16,319 [INFO]: 	Compute estimated construction time of the index 03/09/2025, 06:55:16
2025-03-09 06:55:16,319 [INFO]: 		-> Train: 16.7 minutes
2025-03-09 06:55:16,319 [INFO]: 		-> Add: 2.2 seconds
2025-03-09 06:55:16,319 [INFO]: 		Total: 16.7 minutes
2025-03-09 06:55:16,319 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0001 secs
2025-03-09 06:55:16,319 [INFO]: 	Checking that your have enough memory available to create the index 03/09/2025, 06:55:16
2025-03-09 06:55:16,319 [INFO]: 836.4MB of memory will be needed to build the index (more might be used if you have more)
2025-03-09 06:55:16,319 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0002 secs
2025-03-09 06:55:16,319 [INFO]: 	Selecting most promising index types given data characteristics 03/09/2025, 06:55:16
2025-03-09 06:55:16,319 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-09 06:55:16,320 [INFO]: 	Creating the index 03/09/2025, 06:55:16
2025-03-09 06:55:16,320 [INFO]: 		-> Instanciate the index HNSW15 03/09/2025, 06:55:16
2025-03-09 06:55:16,321 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0011 secs
2025-03-09 06:55:16,321 [INFO]: 		-> Adding the vectors to the index 03/09/2025, 06:55:16
2025-03-09 06:55:16,321 [INFO]: The memory available for adding the vectors is 49.3GB(total available - used by the index)
2025-03-09 06:55:16,321 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/16 [00:00<?, ?it/s]  6%|▋         | 1/16 [00:00<00:01,  9.82it/s] 44%|████▍     | 7/16 [00:00<00:00, 35.70it/s] 81%|████████▏ | 13/16 [00:00<00:00, 43.72it/s]100%|██████████| 16/16 [00:03<00:00,  4.26it/s]
2025-03-09 06:55:20,083 [INFO]: 	Computing best hyperparameters for index knn.index 03/09/2025, 06:55:20
2025-03-09 06:56:05,001 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 44.9178 secs
2025-03-09 06:56:05,002 [INFO]: The best hyperparameters are: efSearch=190
2025-03-09 06:56:05,002 [INFO]: 	Compute fast metrics 03/09/2025, 06:56:05
  0%|          | 0/4 [00:00<?, ?it/s] 50%|█████     | 2/4 [00:00<00:00, 18.96it/s] 75%|███████▌  | 3/4 [00:00<00:00, 20.43it/s]
2025-03-09 06:56:17,298 [INFO]: 	>>> Finished "Compute fast metrics" in 12.2961 secs
2025-03-09 06:56:17,300 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 60.9791 secs
2025-03-09 06:56:17,300 [INFO]: {
2025-03-09 06:56:17,300 [INFO]: 	index_key: HNSW15
2025-03-09 06:56:17,300 [INFO]: 	index_param: efSearch=190
2025-03-09 06:56:17,300 [INFO]: 	index_path: knn.index
2025-03-09 06:56:17,300 [INFO]: 	size in bytes: 797403550
2025-03-09 06:56:17,300 [INFO]: 	avg_search_speed_ms: 11.98984523733219
2025-03-09 06:56:17,300 [INFO]: 	99p_search_speed_ms: 27.825548229739066
2025-03-09 06:56:17,300 [INFO]: 	reconstruction error %: 0.0
2025-03-09 06:56:17,300 [INFO]: 	nb vectors: 4053
2025-03-09 06:56:17,300 [INFO]: 	vectors dimension: 49152
2025-03-09 06:56:17,300 [INFO]: 	compression ratio: 0.9993085985132621
2025-03-09 06:56:17,300 [INFO]: }
2025-03-09 06:56:17,300 [INFO]: 	>>> Finished "Creating the index" in 60.9808 secs
2025-03-09 06:56:17,300 [INFO]: >>> Finished "Launching the whole pipeline" in 61.0129 secs
2025-03-09 06:56:18: [retrieval_preprocessing] calculating distances ...
2025-03-09 06:56:18: [retrieval_preprocessing] finished and saved retrieval indices for episode 18958 [episode count 7/20]
[retrieval_preprocessing] for episode 33167 [episode count 8/20], we have num_retrieval=np.int64(4075) num_query=np.int64(151)
2025-03-09 06:56:19,283 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-09 06:56:19,900 [INFO]: Launching the whole pipeline 03/09/2025, 06:56:19
2025-03-09 06:56:19,900 [INFO]: Reading total number of vectors and dimension 03/09/2025, 06:56:19
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 2671.53it/s]
2025-03-09 06:56:19,926 [INFO]: There are 4075 embeddings of dim 49152
2025-03-09 06:56:19,926 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0261 secs
2025-03-09 06:56:19,927 [INFO]: 	Compute estimated construction time of the index 03/09/2025, 06:56:19
2025-03-09 06:56:19,927 [INFO]: 		-> Train: 16.7 minutes
2025-03-09 06:56:19,927 [INFO]: 		-> Add: 2.2 seconds
2025-03-09 06:56:19,927 [INFO]: 		Total: 16.7 minutes
2025-03-09 06:56:19,927 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0001 secs
2025-03-09 06:56:19,927 [INFO]: 	Checking that your have enough memory available to create the index 03/09/2025, 06:56:19
2025-03-09 06:56:19,927 [INFO]: 841.0MB of memory will be needed to build the index (more might be used if you have more)
2025-03-09 06:56:19,927 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0002 secs
2025-03-09 06:56:19,927 [INFO]: 	Selecting most promising index types given data characteristics 03/09/2025, 06:56:19
2025-03-09 06:56:19,927 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-09 06:56:19,927 [INFO]: 	Creating the index 03/09/2025, 06:56:19
2025-03-09 06:56:19,927 [INFO]: 		-> Instanciate the index HNSW15 03/09/2025, 06:56:19
2025-03-09 06:56:19,928 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0011 secs
2025-03-09 06:56:19,928 [INFO]: 		-> Adding the vectors to the index 03/09/2025, 06:56:19
2025-03-09 06:56:19,929 [INFO]: The memory available for adding the vectors is 49.3GB(total available - used by the index)
2025-03-09 06:56:19,929 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/17 [00:00<?, ?it/s] 12%|█▏        | 2/17 [00:00<00:00, 18.57it/s] 47%|████▋     | 8/17 [00:00<00:00, 37.87it/s] 76%|███████▋  | 13/17 [00:00<00:00, 42.97it/s]100%|██████████| 17/17 [00:03<00:00,  4.89it/s]
2025-03-09 06:56:23,412 [INFO]: 	Computing best hyperparameters for index knn.index 03/09/2025, 06:56:23
2025-03-09 06:57:04,387 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 40.9746 secs
2025-03-09 06:57:04,387 [INFO]: The best hyperparameters are: efSearch=108
2025-03-09 06:57:04,387 [INFO]: 	Compute fast metrics 03/09/2025, 06:57:04
  0%|          | 0/4 [00:00<?, ?it/s] 25%|██▌       | 1/4 [00:00<00:00,  5.05it/s] 75%|███████▌  | 3/4 [00:00<00:00,  9.30it/s]
2025-03-09 06:57:16,749 [INFO]: 	>>> Finished "Compute fast metrics" in 12.3620 secs
2025-03-09 06:57:16,752 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 56.8237 secs
2025-03-09 06:57:16,752 [INFO]: {
2025-03-09 06:57:16,752 [INFO]: 	index_key: HNSW15
2025-03-09 06:57:16,752 [INFO]: 	index_param: efSearch=108
2025-03-09 06:57:16,752 [INFO]: 	index_path: knn.index
2025-03-09 06:57:16,752 [INFO]: 	size in bytes: 801731890
2025-03-09 06:57:16,753 [INFO]: 	avg_search_speed_ms: 7.167328526846328
2025-03-09 06:57:16,753 [INFO]: 	99p_search_speed_ms: 14.01378515874967
2025-03-09 06:57:16,753 [INFO]: 	reconstruction error %: 0.0
2025-03-09 06:57:16,753 [INFO]: 	nb vectors: 4075
2025-03-09 06:57:16,753 [INFO]: 	vectors dimension: 49152
2025-03-09 06:57:16,753 [INFO]: 	compression ratio: 0.9993086342118686
2025-03-09 06:57:16,753 [INFO]: }
2025-03-09 06:57:16,753 [INFO]: 	>>> Finished "Creating the index" in 56.8254 secs
2025-03-09 06:57:16,753 [INFO]: >>> Finished "Launching the whole pipeline" in 56.8522 secs
2025-03-09 06:57:17: [retrieval_preprocessing] calculating distances ...
2025-03-09 06:57:17: [retrieval_preprocessing] finished and saved retrieval indices for episode 33167 [episode count 8/20]
[retrieval_preprocessing] for episode 39440 [episode count 9/20], we have num_retrieval=np.int64(4092) num_query=np.int64(134)
2025-03-09 06:57:18,227 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-09 06:57:18,854 [INFO]: Launching the whole pipeline 03/09/2025, 06:57:18
2025-03-09 06:57:18,854 [INFO]: Reading total number of vectors and dimension 03/09/2025, 06:57:18
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1035.89it/s]
2025-03-09 06:57:18,890 [INFO]: There are 4092 embeddings of dim 49152
2025-03-09 06:57:18,890 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0355 secs
2025-03-09 06:57:18,890 [INFO]: 	Compute estimated construction time of the index 03/09/2025, 06:57:18
2025-03-09 06:57:18,891 [INFO]: 		-> Train: 16.7 minutes
2025-03-09 06:57:18,891 [INFO]: 		-> Add: 2.2 seconds
2025-03-09 06:57:18,891 [INFO]: 		Total: 16.7 minutes
2025-03-09 06:57:18,892 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0009 secs
2025-03-09 06:57:18,892 [INFO]: 	Checking that your have enough memory available to create the index 03/09/2025, 06:57:18
2025-03-09 06:57:18,892 [INFO]: 844.5MB of memory will be needed to build the index (more might be used if you have more)
2025-03-09 06:57:18,892 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0006 secs
2025-03-09 06:57:18,893 [INFO]: 	Selecting most promising index types given data characteristics 03/09/2025, 06:57:18
2025-03-09 06:57:18,893 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-09 06:57:18,893 [INFO]: 	Creating the index 03/09/2025, 06:57:18
2025-03-09 06:57:18,893 [INFO]: 		-> Instanciate the index HNSW15 03/09/2025, 06:57:18
2025-03-09 06:57:18,897 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0029 secs
2025-03-09 06:57:18,897 [INFO]: 		-> Adding the vectors to the index 03/09/2025, 06:57:18
2025-03-09 06:57:18,897 [INFO]: The memory available for adding the vectors is 49.3GB(total available - used by the index)
2025-03-09 06:57:18,897 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/17 [00:00<?, ?it/s] 12%|█▏        | 2/17 [00:00<00:00, 18.26it/s] 41%|████      | 7/17 [00:00<00:00, 35.93it/s] 76%|███████▋  | 13/17 [00:00<00:00, 44.89it/s]100%|██████████| 17/17 [00:03<00:00,  5.04it/s]
2025-03-09 06:57:22,276 [INFO]: 	Computing best hyperparameters for index knn.index 03/09/2025, 06:57:22
2025-03-09 06:58:03,280 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 41.0036 secs
2025-03-09 06:58:03,280 [INFO]: The best hyperparameters are: efSearch=167
2025-03-09 06:58:03,280 [INFO]: 	Compute fast metrics 03/09/2025, 06:58:03
  0%|          | 0/4 [00:00<?, ?it/s] 50%|█████     | 2/4 [00:00<00:00, 18.92it/s] 75%|███████▌  | 3/4 [00:00<00:00, 20.70it/s]
2025-03-09 06:58:16,366 [INFO]: 	>>> Finished "Compute fast metrics" in 13.0859 secs
2025-03-09 06:58:16,369 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 57.4715 secs
2025-03-09 06:58:16,369 [INFO]: {
2025-03-09 06:58:16,369 [INFO]: 	index_key: HNSW15
2025-03-09 06:58:16,369 [INFO]: 	index_param: efSearch=167
2025-03-09 06:58:16,369 [INFO]: 	index_path: knn.index
2025-03-09 06:58:16,369 [INFO]: 	size in bytes: 805076530
2025-03-09 06:58:16,369 [INFO]: 	avg_search_speed_ms: 11.762690444969955
2025-03-09 06:58:16,369 [INFO]: 	99p_search_speed_ms: 19.93112232768908
2025-03-09 06:58:16,369 [INFO]: 	reconstruction error %: 0.0
2025-03-09 06:58:16,369 [INFO]: 	nb vectors: 4092
2025-03-09 06:58:16,369 [INFO]: 	vectors dimension: 49152
2025-03-09 06:58:16,369 [INFO]: 	compression ratio: 0.9993086446079853
2025-03-09 06:58:16,369 [INFO]: }
2025-03-09 06:58:16,369 [INFO]: 	>>> Finished "Creating the index" in 57.4756 secs
2025-03-09 06:58:16,369 [INFO]: >>> Finished "Launching the whole pipeline" in 57.5144 secs
2025-03-09 06:58:16: [retrieval_preprocessing] calculating distances ...
2025-03-09 06:58:17: [retrieval_preprocessing] finished and saved retrieval indices for episode 39440 [episode count 9/20]
[retrieval_preprocessing] for episode 6673 [episode count 10/20], we have num_retrieval=np.int64(4028) num_query=np.int64(198)
2025-03-09 06:58:17,647 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-09 06:58:18,177 [INFO]: Launching the whole pipeline 03/09/2025, 06:58:18
2025-03-09 06:58:18,177 [INFO]: Reading total number of vectors and dimension 03/09/2025, 06:58:18
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1408.43it/s]
2025-03-09 06:58:18,207 [INFO]: There are 4028 embeddings of dim 49152
2025-03-09 06:58:18,207 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0299 secs
2025-03-09 06:58:18,207 [INFO]: 	Compute estimated construction time of the index 03/09/2025, 06:58:18
2025-03-09 06:58:18,207 [INFO]: 		-> Train: 16.7 minutes
2025-03-09 06:58:18,207 [INFO]: 		-> Add: 2.2 seconds
2025-03-09 06:58:18,207 [INFO]: 		Total: 16.7 minutes
2025-03-09 06:58:18,207 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0001 secs
2025-03-09 06:58:18,207 [INFO]: 	Checking that your have enough memory available to create the index 03/09/2025, 06:58:18
2025-03-09 06:58:18,207 [INFO]: 831.3MB of memory will be needed to build the index (more might be used if you have more)
2025-03-09 06:58:18,207 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0001 secs
2025-03-09 06:58:18,207 [INFO]: 	Selecting most promising index types given data characteristics 03/09/2025, 06:58:18
2025-03-09 06:58:18,207 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-09 06:58:18,207 [INFO]: 	Creating the index 03/09/2025, 06:58:18
2025-03-09 06:58:18,207 [INFO]: 		-> Instanciate the index HNSW15 03/09/2025, 06:58:18
2025-03-09 06:58:18,208 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0011 secs
2025-03-09 06:58:18,208 [INFO]: 		-> Adding the vectors to the index 03/09/2025, 06:58:18
2025-03-09 06:58:18,209 [INFO]: The memory available for adding the vectors is 49.3GB(total available - used by the index)
2025-03-09 06:58:18,209 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/16 [00:00<?, ?it/s]  6%|▋         | 1/16 [00:00<00:01,  8.11it/s] 44%|████▍     | 7/16 [00:00<00:00, 33.40it/s] 81%|████████▏ | 13/16 [00:00<00:00, 41.53it/s]100%|██████████| 16/16 [00:03<00:00,  4.74it/s]
2025-03-09 06:58:21,589 [INFO]: 	Computing best hyperparameters for index knn.index 03/09/2025, 06:58:21
2025-03-09 06:58:57,852 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 36.2630 secs
2025-03-09 06:58:57,852 [INFO]: The best hyperparameters are: efSearch=204
2025-03-09 06:58:57,852 [INFO]: 	Compute fast metrics 03/09/2025, 06:58:57
  0%|          | 0/4 [00:00<?, ?it/s] 50%|█████     | 2/4 [00:00<00:00, 18.83it/s] 75%|███████▌  | 3/4 [00:00<00:00, 20.22it/s]
2025-03-09 06:59:12,425 [INFO]: 	>>> Finished "Compute fast metrics" in 14.5724 secs
2025-03-09 06:59:12,429 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 54.2201 secs
2025-03-09 06:59:12,429 [INFO]: {
2025-03-09 06:59:12,429 [INFO]: 	index_key: HNSW15
2025-03-09 06:59:12,429 [INFO]: 	index_param: efSearch=204
2025-03-09 06:59:12,429 [INFO]: 	index_path: knn.index
2025-03-09 06:59:12,429 [INFO]: 	size in bytes: 792484990
2025-03-09 06:59:12,429 [INFO]: 	avg_search_speed_ms: 12.1049800842095
2025-03-09 06:59:12,429 [INFO]: 	99p_search_speed_ms: 22.583237872459
2025-03-09 06:59:12,429 [INFO]: 	reconstruction error %: 0.0
2025-03-09 06:59:12,429 [INFO]: 	nb vectors: 4028
2025-03-09 06:59:12,429 [INFO]: 	vectors dimension: 49152
2025-03-09 06:59:12,429 [INFO]: 	compression ratio: 0.9993085471562054
2025-03-09 06:59:12,429 [INFO]: }
2025-03-09 06:59:12,429 [INFO]: 	>>> Finished "Creating the index" in 54.2218 secs
2025-03-09 06:59:12,429 [INFO]: >>> Finished "Launching the whole pipeline" in 54.2523 secs
2025-03-09 06:59:13: [retrieval_preprocessing] calculating distances ...
2025-03-09 06:59:14: [retrieval_preprocessing] finished and saved retrieval indices for episode 6673 [episode count 10/20]
[retrieval_preprocessing] for episode 33681 [episode count 11/20], we have num_retrieval=np.int64(4080) num_query=np.int64(146)
2025-03-09 06:59:14,900 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-09 06:59:15,441 [INFO]: Launching the whole pipeline 03/09/2025, 06:59:15
2025-03-09 06:59:15,442 [INFO]: Reading total number of vectors and dimension 03/09/2025, 06:59:15
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1438.38it/s]
2025-03-09 06:59:15,467 [INFO]: There are 4080 embeddings of dim 49152
2025-03-09 06:59:15,467 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0254 secs
2025-03-09 06:59:15,467 [INFO]: 	Compute estimated construction time of the index 03/09/2025, 06:59:15
2025-03-09 06:59:15,467 [INFO]: 		-> Train: 16.7 minutes
2025-03-09 06:59:15,467 [INFO]: 		-> Add: 2.2 seconds
2025-03-09 06:59:15,467 [INFO]: 		Total: 16.7 minutes
2025-03-09 06:59:15,467 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0001 secs
2025-03-09 06:59:15,467 [INFO]: 	Checking that your have enough memory available to create the index 03/09/2025, 06:59:15
2025-03-09 06:59:15,467 [INFO]: 842.0MB of memory will be needed to build the index (more might be used if you have more)
2025-03-09 06:59:15,467 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0001 secs
2025-03-09 06:59:15,467 [INFO]: 	Selecting most promising index types given data characteristics 03/09/2025, 06:59:15
2025-03-09 06:59:15,467 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-09 06:59:15,467 [INFO]: 	Creating the index 03/09/2025, 06:59:15
2025-03-09 06:59:15,467 [INFO]: 		-> Instanciate the index HNSW15 03/09/2025, 06:59:15
2025-03-09 06:59:15,468 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0009 secs
2025-03-09 06:59:15,468 [INFO]: 		-> Adding the vectors to the index 03/09/2025, 06:59:15
2025-03-09 06:59:15,469 [INFO]: The memory available for adding the vectors is 49.3GB(total available - used by the index)
2025-03-09 06:59:15,469 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/17 [00:00<?, ?it/s]  6%|▌         | 1/17 [00:00<00:01,  9.79it/s] 41%|████      | 7/17 [00:00<00:00, 35.96it/s] 76%|███████▋  | 13/17 [00:00<00:00, 43.59it/s]100%|██████████| 17/17 [00:04<00:00,  4.07it/s]
2025-03-09 06:59:19,651 [INFO]: 	Computing best hyperparameters for index knn.index 03/09/2025, 06:59:19
2025-03-09 06:59:57,336 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 37.6845 secs
2025-03-09 06:59:57,336 [INFO]: The best hyperparameters are: efSearch=196
2025-03-09 06:59:57,336 [INFO]: 	Compute fast metrics 03/09/2025, 06:59:57
  0%|          | 0/4 [00:00<?, ?it/s] 50%|█████     | 2/4 [00:00<00:00, 19.09it/s] 75%|███████▌  | 3/4 [00:00<00:00, 21.31it/s]
2025-03-09 07:00:09,628 [INFO]: 	>>> Finished "Compute fast metrics" in 12.2920 secs
2025-03-09 07:00:09,631 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 54.1620 secs
2025-03-09 07:00:09,631 [INFO]: {
2025-03-09 07:00:09,631 [INFO]: 	index_key: HNSW15
2025-03-09 07:00:09,631 [INFO]: 	index_param: efSearch=196
2025-03-09 07:00:09,631 [INFO]: 	index_path: knn.index
2025-03-09 07:00:09,631 [INFO]: 	size in bytes: 802715650
2025-03-09 07:00:09,631 [INFO]: 	avg_search_speed_ms: 10.314345737131907
2025-03-09 07:00:09,631 [INFO]: 	99p_search_speed_ms: 13.910224130377168
2025-03-09 07:00:09,631 [INFO]: 	reconstruction error %: 0.0
2025-03-09 07:00:09,631 [INFO]: 	nb vectors: 4080
2025-03-09 07:00:09,631 [INFO]: 	vectors dimension: 49152
2025-03-09 07:00:09,631 [INFO]: 	compression ratio: 0.9993085845529485
2025-03-09 07:00:09,631 [INFO]: }
2025-03-09 07:00:09,631 [INFO]: 	>>> Finished "Creating the index" in 54.1634 secs
2025-03-09 07:00:09,631 [INFO]: >>> Finished "Launching the whole pipeline" in 54.1894 secs
2025-03-09 07:00:10: [retrieval_preprocessing] calculating distances ...
2025-03-09 07:00:11: [retrieval_preprocessing] finished and saved retrieval indices for episode 33681 [episode count 11/20]
[retrieval_preprocessing] for episode 44044 [episode count 12/20], we have num_retrieval=np.int64(3910) num_query=np.int64(316)
2025-03-09 07:00:11,465 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-09 07:00:11,977 [INFO]: Launching the whole pipeline 03/09/2025, 07:00:11
2025-03-09 07:00:11,977 [INFO]: Reading total number of vectors and dimension 03/09/2025, 07:00:11
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1618.17it/s]
2025-03-09 07:00:12,004 [INFO]: There are 3910 embeddings of dim 49152
2025-03-09 07:00:12,004 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0274 secs
2025-03-09 07:00:12,004 [INFO]: 	Compute estimated construction time of the index 03/09/2025, 07:00:12
2025-03-09 07:00:12,004 [INFO]: 		-> Train: 16.7 minutes
2025-03-09 07:00:12,004 [INFO]: 		-> Add: 2.1 seconds
2025-03-09 07:00:12,004 [INFO]: 		Total: 16.7 minutes
2025-03-09 07:00:12,005 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0001 secs
2025-03-09 07:00:12,005 [INFO]: 	Checking that your have enough memory available to create the index 03/09/2025, 07:00:12
2025-03-09 07:00:12,005 [INFO]: 806.9MB of memory will be needed to build the index (more might be used if you have more)
2025-03-09 07:00:12,005 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0002 secs
2025-03-09 07:00:12,005 [INFO]: 	Selecting most promising index types given data characteristics 03/09/2025, 07:00:12
2025-03-09 07:00:12,005 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-09 07:00:12,005 [INFO]: 	Creating the index 03/09/2025, 07:00:12
2025-03-09 07:00:12,005 [INFO]: 		-> Instanciate the index HNSW15 03/09/2025, 07:00:12
2025-03-09 07:00:12,006 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0009 secs
2025-03-09 07:00:12,006 [INFO]: 		-> Adding the vectors to the index 03/09/2025, 07:00:12
2025-03-09 07:00:12,006 [INFO]: The memory available for adding the vectors is 49.3GB(total available - used by the index)
2025-03-09 07:00:12,006 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/16 [00:00<?, ?it/s]  6%|▋         | 1/16 [00:00<00:01,  8.62it/s] 44%|████▍     | 7/16 [00:00<00:00, 34.03it/s] 81%|████████▏ | 13/16 [00:00<00:00, 43.25it/s]100%|██████████| 16/16 [00:03<00:00,  4.34it/s]
2025-03-09 07:00:15,696 [INFO]: 	Computing best hyperparameters for index knn.index 03/09/2025, 07:00:15
2025-03-09 07:00:52,763 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 37.0666 secs
2025-03-09 07:00:52,763 [INFO]: The best hyperparameters are: efSearch=198
2025-03-09 07:00:52,763 [INFO]: 	Compute fast metrics 03/09/2025, 07:00:52
  0%|          | 0/4 [00:00<?, ?it/s] 50%|█████     | 2/4 [00:00<00:00, 19.17it/s] 75%|███████▌  | 3/4 [00:00<00:00, 20.50it/s]
2025-03-09 07:01:07,363 [INFO]: 	>>> Finished "Compute fast metrics" in 14.6002 secs
2025-03-09 07:01:07,366 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 55.3597 secs
2025-03-09 07:01:07,366 [INFO]: {
2025-03-09 07:01:07,366 [INFO]: 	index_key: HNSW15
2025-03-09 07:01:07,366 [INFO]: 	index_param: efSearch=198
2025-03-09 07:01:07,366 [INFO]: 	index_path: knn.index
2025-03-09 07:01:07,366 [INFO]: 	size in bytes: 769268950
2025-03-09 07:01:07,366 [INFO]: 	avg_search_speed_ms: 10.424627175912013
2025-03-09 07:01:07,366 [INFO]: 	99p_search_speed_ms: 13.337076040916141
2025-03-09 07:01:07,366 [INFO]: 	reconstruction error %: 0.0
2025-03-09 07:01:07,366 [INFO]: 	nb vectors: 3910
2025-03-09 07:01:07,366 [INFO]: 	vectors dimension: 49152
2025-03-09 07:01:07,366 [INFO]: 	compression ratio: 0.9993088633045699
2025-03-09 07:01:07,366 [INFO]: }
2025-03-09 07:01:07,366 [INFO]: 	>>> Finished "Creating the index" in 55.3611 secs
2025-03-09 07:01:07,366 [INFO]: >>> Finished "Launching the whole pipeline" in 55.3891 secs
2025-03-09 07:01:09: [retrieval_preprocessing] calculating distances ...
2025-03-09 07:01:10: [retrieval_preprocessing] finished and saved retrieval indices for episode 44044 [episode count 12/20]
[retrieval_preprocessing] for episode 53009 [episode count 13/20], we have num_retrieval=np.int64(4076) num_query=np.int64(150)
2025-03-09 07:01:10,888 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-09 07:01:11,472 [INFO]: Launching the whole pipeline 03/09/2025, 07:01:11
2025-03-09 07:01:11,472 [INFO]: Reading total number of vectors and dimension 03/09/2025, 07:01:11
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1621.93it/s]
2025-03-09 07:01:11,501 [INFO]: There are 4076 embeddings of dim 49152
2025-03-09 07:01:11,501 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0291 secs
2025-03-09 07:01:11,501 [INFO]: 	Compute estimated construction time of the index 03/09/2025, 07:01:11
2025-03-09 07:01:11,501 [INFO]: 		-> Train: 16.7 minutes
2025-03-09 07:01:11,501 [INFO]: 		-> Add: 2.2 seconds
2025-03-09 07:01:11,501 [INFO]: 		Total: 16.7 minutes
2025-03-09 07:01:11,501 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0001 secs
2025-03-09 07:01:11,501 [INFO]: 	Checking that your have enough memory available to create the index 03/09/2025, 07:01:11
2025-03-09 07:01:11,502 [INFO]: 841.2MB of memory will be needed to build the index (more might be used if you have more)
2025-03-09 07:01:11,502 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0002 secs
2025-03-09 07:01:11,502 [INFO]: 	Selecting most promising index types given data characteristics 03/09/2025, 07:01:11
2025-03-09 07:01:11,502 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-09 07:01:11,502 [INFO]: 	Creating the index 03/09/2025, 07:01:11
2025-03-09 07:01:11,502 [INFO]: 		-> Instanciate the index HNSW15 03/09/2025, 07:01:11
2025-03-09 07:01:11,503 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0010 secs
2025-03-09 07:01:11,503 [INFO]: 		-> Adding the vectors to the index 03/09/2025, 07:01:11
2025-03-09 07:01:11,503 [INFO]: The memory available for adding the vectors is 49.3GB(total available - used by the index)
2025-03-09 07:01:11,503 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/17 [00:00<?, ?it/s]  6%|▌         | 1/17 [00:00<00:01,  9.13it/s] 41%|████      | 7/17 [00:00<00:00, 34.59it/s] 76%|███████▋  | 13/17 [00:00<00:00, 42.95it/s]100%|██████████| 17/17 [00:03<00:00,  4.79it/s]
2025-03-09 07:01:15,053 [INFO]: 	Computing best hyperparameters for index knn.index 03/09/2025, 07:01:15
2025-03-09 07:01:57,822 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 42.7680 secs
2025-03-09 07:01:57,822 [INFO]: The best hyperparameters are: efSearch=177
2025-03-09 07:01:57,822 [INFO]: 	Compute fast metrics 03/09/2025, 07:01:57
  0%|          | 0/4 [00:00<?, ?it/s] 50%|█████     | 2/4 [00:00<00:00, 18.54it/s] 75%|███████▌  | 3/4 [00:00<00:00, 20.57it/s]
2025-03-09 07:02:09,864 [INFO]: 	>>> Finished "Compute fast metrics" in 12.0415 secs
2025-03-09 07:02:09,866 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 58.3627 secs
2025-03-09 07:02:09,866 [INFO]: {
2025-03-09 07:02:09,866 [INFO]: 	index_key: HNSW15
2025-03-09 07:02:09,866 [INFO]: 	index_param: efSearch=177
2025-03-09 07:02:09,866 [INFO]: 	index_path: knn.index
2025-03-09 07:02:09,866 [INFO]: 	size in bytes: 801928630
2025-03-09 07:02:09,866 [INFO]: 	avg_search_speed_ms: 10.258182981648506
2025-03-09 07:02:09,866 [INFO]: 	99p_search_speed_ms: 15.293812360614533
2025-03-09 07:02:09,866 [INFO]: 	reconstruction error %: 0.0
2025-03-09 07:02:09,866 [INFO]: 	nb vectors: 4076
2025-03-09 07:02:09,866 [INFO]: 	vectors dimension: 49152
2025-03-09 07:02:09,866 [INFO]: 	compression ratio: 0.999308639223917
2025-03-09 07:02:09,866 [INFO]: }
2025-03-09 07:02:09,866 [INFO]: 	>>> Finished "Creating the index" in 58.3643 secs
2025-03-09 07:02:09,866 [INFO]: >>> Finished "Launching the whole pipeline" in 58.3940 secs
2025-03-09 07:02:10: [retrieval_preprocessing] calculating distances ...
2025-03-09 07:02:11: [retrieval_preprocessing] finished and saved retrieval indices for episode 53009 [episode count 13/20]
[retrieval_preprocessing] for episode 67604 [episode count 14/20], we have num_retrieval=np.int64(4093) num_query=np.int64(133)
2025-03-09 07:02:11,453 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-09 07:02:11,990 [INFO]: Launching the whole pipeline 03/09/2025, 07:02:11
2025-03-09 07:02:11,990 [INFO]: Reading total number of vectors and dimension 03/09/2025, 07:02:11
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1829.98it/s]
2025-03-09 07:02:12,021 [INFO]: There are 4093 embeddings of dim 49152
2025-03-09 07:02:12,022 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0319 secs
2025-03-09 07:02:12,022 [INFO]: 	Compute estimated construction time of the index 03/09/2025, 07:02:12
2025-03-09 07:02:12,022 [INFO]: 		-> Train: 16.7 minutes
2025-03-09 07:02:12,022 [INFO]: 		-> Add: 2.2 seconds
2025-03-09 07:02:12,023 [INFO]: 		Total: 16.7 minutes
2025-03-09 07:02:12,023 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0005 secs
2025-03-09 07:02:12,023 [INFO]: 	Checking that your have enough memory available to create the index 03/09/2025, 07:02:12
2025-03-09 07:02:12,023 [INFO]: 844.7MB of memory will be needed to build the index (more might be used if you have more)
2025-03-09 07:02:12,024 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0004 secs
2025-03-09 07:02:12,024 [INFO]: 	Selecting most promising index types given data characteristics 03/09/2025, 07:02:12
2025-03-09 07:02:12,024 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-09 07:02:12,024 [INFO]: 	Creating the index 03/09/2025, 07:02:12
2025-03-09 07:02:12,024 [INFO]: 		-> Instanciate the index HNSW15 03/09/2025, 07:02:12
2025-03-09 07:02:12,027 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0023 secs
2025-03-09 07:02:12,027 [INFO]: 		-> Adding the vectors to the index 03/09/2025, 07:02:12
2025-03-09 07:02:12,027 [INFO]: The memory available for adding the vectors is 49.3GB(total available - used by the index)
2025-03-09 07:02:12,027 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/17 [00:00<?, ?it/s]  6%|▌         | 1/17 [00:00<00:01,  9.91it/s] 35%|███▌      | 6/17 [00:00<00:00, 33.40it/s] 71%|███████   | 12/17 [00:00<00:00, 42.34it/s]100%|██████████| 17/17 [00:03<00:00,  3.35it/s]100%|██████████| 17/17 [00:03<00:00,  4.56it/s]
2025-03-09 07:02:15,763 [INFO]: 	Computing best hyperparameters for index knn.index 03/09/2025, 07:02:15
2025-03-09 07:02:54,955 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 39.1913 secs
2025-03-09 07:02:54,955 [INFO]: The best hyperparameters are: efSearch=195
2025-03-09 07:02:54,955 [INFO]: 	Compute fast metrics 03/09/2025, 07:02:54
  0%|          | 0/4 [00:00<?, ?it/s] 50%|█████     | 2/4 [00:00<00:00, 17.10it/s] 75%|███████▌  | 3/4 [00:00<00:00, 18.54it/s]
2025-03-09 07:03:07,217 [INFO]: 	>>> Finished "Compute fast metrics" in 12.2618 secs
2025-03-09 07:03:07,220 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 55.1933 secs
2025-03-09 07:03:07,221 [INFO]: {
2025-03-09 07:03:07,221 [INFO]: 	index_key: HNSW15
2025-03-09 07:03:07,221 [INFO]: 	index_param: efSearch=195
2025-03-09 07:03:07,221 [INFO]: 	index_path: knn.index
2025-03-09 07:03:07,221 [INFO]: 	size in bytes: 805273270
2025-03-09 07:03:07,221 [INFO]: 	avg_search_speed_ms: 10.75536098020772
2025-03-09 07:03:07,221 [INFO]: 	99p_search_speed_ms: 14.463816084899028
2025-03-09 07:03:07,221 [INFO]: 	reconstruction error %: 0.0
2025-03-09 07:03:07,221 [INFO]: 	nb vectors: 4093
2025-03-09 07:03:07,221 [INFO]: 	vectors dimension: 49152
2025-03-09 07:03:07,221 [INFO]: 	compression ratio: 0.9993086495966766
2025-03-09 07:03:07,221 [INFO]: }
2025-03-09 07:03:07,221 [INFO]: 	>>> Finished "Creating the index" in 55.1975 secs
2025-03-09 07:03:07,222 [INFO]: >>> Finished "Launching the whole pipeline" in 55.2317 secs
2025-03-09 07:03:08: [retrieval_preprocessing] calculating distances ...
2025-03-09 07:03:08: [retrieval_preprocessing] finished and saved retrieval indices for episode 67604 [episode count 14/20]
[retrieval_preprocessing] for episode 2838 [episode count 15/20], we have num_retrieval=np.int64(3999) num_query=np.int64(227)
2025-03-09 07:03:09,291 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-09 07:03:09,894 [INFO]: Launching the whole pipeline 03/09/2025, 07:03:09
2025-03-09 07:03:09,894 [INFO]: Reading total number of vectors and dimension 03/09/2025, 07:03:09
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1670.37it/s]
2025-03-09 07:03:09,922 [INFO]: There are 3999 embeddings of dim 49152
2025-03-09 07:03:09,922 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0278 secs
2025-03-09 07:03:09,922 [INFO]: 	Compute estimated construction time of the index 03/09/2025, 07:03:09
2025-03-09 07:03:09,922 [INFO]: 		-> Train: 16.7 minutes
2025-03-09 07:03:09,922 [INFO]: 		-> Add: 2.2 seconds
2025-03-09 07:03:09,922 [INFO]: 		Total: 16.7 minutes
2025-03-09 07:03:09,922 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0001 secs
2025-03-09 07:03:09,922 [INFO]: 	Checking that your have enough memory available to create the index 03/09/2025, 07:03:09
2025-03-09 07:03:09,922 [INFO]: 825.3MB of memory will be needed to build the index (more might be used if you have more)
2025-03-09 07:03:09,922 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0001 secs
2025-03-09 07:03:09,922 [INFO]: 	Selecting most promising index types given data characteristics 03/09/2025, 07:03:09
2025-03-09 07:03:09,922 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-09 07:03:09,922 [INFO]: 	Creating the index 03/09/2025, 07:03:09
2025-03-09 07:03:09,922 [INFO]: 		-> Instanciate the index HNSW15 03/09/2025, 07:03:09
2025-03-09 07:03:09,923 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0009 secs
2025-03-09 07:03:09,923 [INFO]: 		-> Adding the vectors to the index 03/09/2025, 07:03:09
2025-03-09 07:03:09,924 [INFO]: The memory available for adding the vectors is 49.3GB(total available - used by the index)
2025-03-09 07:03:09,924 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/16 [00:00<?, ?it/s]  6%|▋         | 1/16 [00:00<00:01,  7.59it/s] 38%|███▊      | 6/16 [00:00<00:00, 27.23it/s] 69%|██████▉   | 11/16 [00:00<00:00, 34.32it/s]100%|██████████| 16/16 [00:03<00:00,  3.06it/s]100%|██████████| 16/16 [00:03<00:00,  4.13it/s]
2025-03-09 07:03:13,799 [INFO]: 	Computing best hyperparameters for index knn.index 03/09/2025, 07:03:13
2025-03-09 07:03:54,355 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 40.5552 secs
2025-03-09 07:03:54,355 [INFO]: The best hyperparameters are: efSearch=177
2025-03-09 07:03:54,355 [INFO]: 	Compute fast metrics 03/09/2025, 07:03:54
  0%|          | 0/4 [00:00<?, ?it/s] 50%|█████     | 2/4 [00:00<00:00, 18.89it/s] 75%|███████▌  | 3/4 [00:00<00:00, 20.35it/s]
2025-03-09 07:04:06,406 [INFO]: 	>>> Finished "Compute fast metrics" in 12.0510 secs
2025-03-09 07:04:06,409 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 56.4857 secs
2025-03-09 07:04:06,409 [INFO]: {
2025-03-09 07:04:06,409 [INFO]: 	index_key: HNSW15
2025-03-09 07:04:06,409 [INFO]: 	index_param: efSearch=177
2025-03-09 07:04:06,410 [INFO]: 	index_path: knn.index
2025-03-09 07:04:06,410 [INFO]: 	size in bytes: 786779410
2025-03-09 07:04:06,410 [INFO]: 	avg_search_speed_ms: 9.69957409717439
2025-03-09 07:04:06,410 [INFO]: 	99p_search_speed_ms: 17.171088606119184
2025-03-09 07:04:06,410 [INFO]: 	reconstruction error %: 0.0
2025-03-09 07:04:06,410 [INFO]: 	nb vectors: 3999
2025-03-09 07:04:06,410 [INFO]: 	vectors dimension: 49152
2025-03-09 07:04:06,410 [INFO]: 	compression ratio: 0.9993085507918922
2025-03-09 07:04:06,410 [INFO]: }
2025-03-09 07:04:06,410 [INFO]: 	>>> Finished "Creating the index" in 56.4873 secs
2025-03-09 07:04:06,410 [INFO]: >>> Finished "Launching the whole pipeline" in 56.5156 secs
2025-03-09 07:04:07: [retrieval_preprocessing] calculating distances ...
2025-03-09 07:04:08: [retrieval_preprocessing] finished and saved retrieval indices for episode 2838 [episode count 15/20]
[retrieval_preprocessing] for episode 93078 [episode count 16/20], we have num_retrieval=np.int64(4044) num_query=np.int64(182)
2025-03-09 07:04:08,751 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-09 07:04:09,278 [INFO]: Launching the whole pipeline 03/09/2025, 07:04:09
2025-03-09 07:04:09,278 [INFO]: Reading total number of vectors and dimension 03/09/2025, 07:04:09
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 2340.57it/s]
2025-03-09 07:04:09,305 [INFO]: There are 4044 embeddings of dim 49152
2025-03-09 07:04:09,305 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0272 secs
2025-03-09 07:04:09,305 [INFO]: 	Compute estimated construction time of the index 03/09/2025, 07:04:09
2025-03-09 07:04:09,305 [INFO]: 		-> Train: 16.7 minutes
2025-03-09 07:04:09,305 [INFO]: 		-> Add: 2.2 seconds
2025-03-09 07:04:09,305 [INFO]: 		Total: 16.7 minutes
2025-03-09 07:04:09,305 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0001 secs
2025-03-09 07:04:09,305 [INFO]: 	Checking that your have enough memory available to create the index 03/09/2025, 07:04:09
2025-03-09 07:04:09,305 [INFO]: 834.6MB of memory will be needed to build the index (more might be used if you have more)
2025-03-09 07:04:09,305 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0001 secs
2025-03-09 07:04:09,305 [INFO]: 	Selecting most promising index types given data characteristics 03/09/2025, 07:04:09
2025-03-09 07:04:09,305 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-09 07:04:09,305 [INFO]: 	Creating the index 03/09/2025, 07:04:09
2025-03-09 07:04:09,305 [INFO]: 		-> Instanciate the index HNSW15 03/09/2025, 07:04:09
2025-03-09 07:04:09,306 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0009 secs
2025-03-09 07:04:09,306 [INFO]: 		-> Adding the vectors to the index 03/09/2025, 07:04:09
2025-03-09 07:04:09,307 [INFO]: The memory available for adding the vectors is 49.3GB(total available - used by the index)
2025-03-09 07:04:09,307 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/16 [00:00<?, ?it/s]  6%|▋         | 1/16 [00:00<00:01,  8.08it/s] 38%|███▊      | 6/16 [00:00<00:00, 30.52it/s] 69%|██████▉   | 11/16 [00:00<00:00, 38.77it/s]100%|██████████| 16/16 [00:03<00:00,  3.49it/s]100%|██████████| 16/16 [00:03<00:00,  4.70it/s]
2025-03-09 07:04:12,714 [INFO]: 	Computing best hyperparameters for index knn.index 03/09/2025, 07:04:12
2025-03-09 07:04:50,500 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 37.7858 secs
2025-03-09 07:04:50,500 [INFO]: The best hyperparameters are: efSearch=161
2025-03-09 07:04:50,500 [INFO]: 	Compute fast metrics 03/09/2025, 07:04:50
  0%|          | 0/4 [00:00<?, ?it/s] 50%|█████     | 2/4 [00:00<00:00, 19.41it/s] 75%|███████▌  | 3/4 [00:00<00:00, 21.37it/s]
2025-03-09 07:05:02,941 [INFO]: 	>>> Finished "Compute fast metrics" in 12.4402 secs
2025-03-09 07:05:02,943 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 53.6367 secs
2025-03-09 07:05:02,944 [INFO]: {
2025-03-09 07:05:02,944 [INFO]: 	index_key: HNSW15
2025-03-09 07:05:02,944 [INFO]: 	index_param: efSearch=161
2025-03-09 07:05:02,944 [INFO]: 	index_path: knn.index
2025-03-09 07:05:02,944 [INFO]: 	size in bytes: 795632890
2025-03-09 07:05:02,944 [INFO]: 	avg_search_speed_ms: 9.229636627397195
2025-03-09 07:05:02,944 [INFO]: 	99p_search_speed_ms: 12.991451895795763
2025-03-09 07:05:02,944 [INFO]: 	reconstruction error %: 0.0
2025-03-09 07:05:02,944 [INFO]: 	nb vectors: 4044
2025-03-09 07:05:02,944 [INFO]: 	vectors dimension: 49152
2025-03-09 07:05:02,944 [INFO]: 	compression ratio: 0.9993085529684426
2025-03-09 07:05:02,944 [INFO]: }
2025-03-09 07:05:02,944 [INFO]: 	>>> Finished "Creating the index" in 53.6387 secs
2025-03-09 07:05:02,944 [INFO]: >>> Finished "Launching the whole pipeline" in 53.6665 secs
2025-03-09 07:05:03: [retrieval_preprocessing] calculating distances ...
2025-03-09 07:05:04: [retrieval_preprocessing] finished and saved retrieval indices for episode 93078 [episode count 16/20]
[retrieval_preprocessing] for episode 6136 [episode count 17/20], we have num_retrieval=np.int64(4002) num_query=np.int64(224)
2025-03-09 07:05:04,819 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-09 07:05:05,351 [INFO]: Launching the whole pipeline 03/09/2025, 07:05:05
2025-03-09 07:05:05,351 [INFO]: Reading total number of vectors and dimension 03/09/2025, 07:05:05
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 2165.36it/s]
2025-03-09 07:05:05,377 [INFO]: There are 4002 embeddings of dim 49152
2025-03-09 07:05:05,378 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0263 secs
2025-03-09 07:05:05,378 [INFO]: 	Compute estimated construction time of the index 03/09/2025, 07:05:05
2025-03-09 07:05:05,378 [INFO]: 		-> Train: 16.7 minutes
2025-03-09 07:05:05,378 [INFO]: 		-> Add: 2.2 seconds
2025-03-09 07:05:05,378 [INFO]: 		Total: 16.7 minutes
2025-03-09 07:05:05,378 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0001 secs
2025-03-09 07:05:05,378 [INFO]: 	Checking that your have enough memory available to create the index 03/09/2025, 07:05:05
2025-03-09 07:05:05,378 [INFO]: 825.9MB of memory will be needed to build the index (more might be used if you have more)
2025-03-09 07:05:05,378 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0001 secs
2025-03-09 07:05:05,378 [INFO]: 	Selecting most promising index types given data characteristics 03/09/2025, 07:05:05
2025-03-09 07:05:05,378 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-09 07:05:05,378 [INFO]: 	Creating the index 03/09/2025, 07:05:05
2025-03-09 07:05:05,378 [INFO]: 		-> Instanciate the index HNSW15 03/09/2025, 07:05:05
2025-03-09 07:05:05,379 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0009 secs
2025-03-09 07:05:05,379 [INFO]: 		-> Adding the vectors to the index 03/09/2025, 07:05:05
2025-03-09 07:05:05,379 [INFO]: The memory available for adding the vectors is 49.3GB(total available - used by the index)
2025-03-09 07:05:05,379 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/16 [00:00<?, ?it/s]  6%|▋         | 1/16 [00:00<00:01,  9.05it/s] 44%|████▍     | 7/16 [00:00<00:00, 35.15it/s] 81%|████████▏ | 13/16 [00:00<00:00, 43.79it/s]100%|██████████| 16/16 [00:03<00:00,  4.72it/s]
2025-03-09 07:05:08,770 [INFO]: 	Computing best hyperparameters for index knn.index 03/09/2025, 07:05:08
2025-03-09 07:05:45,765 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 36.9947 secs
2025-03-09 07:05:45,765 [INFO]: The best hyperparameters are: efSearch=208
2025-03-09 07:05:45,765 [INFO]: 	Compute fast metrics 03/09/2025, 07:05:45
  0%|          | 0/4 [00:00<?, ?it/s] 50%|█████     | 2/4 [00:00<00:00, 16.97it/s] 75%|███████▌  | 3/4 [00:00<00:00, 18.35it/s]
2025-03-09 07:05:58,349 [INFO]: 	>>> Finished "Compute fast metrics" in 12.5840 secs
2025-03-09 07:05:58,352 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 52.9725 secs
2025-03-09 07:05:58,352 [INFO]: {
2025-03-09 07:05:58,352 [INFO]: 	index_key: HNSW15
2025-03-09 07:05:58,352 [INFO]: 	index_param: efSearch=208
2025-03-09 07:05:58,352 [INFO]: 	index_path: knn.index
2025-03-09 07:05:58,352 [INFO]: 	size in bytes: 787369630
2025-03-09 07:05:58,352 [INFO]: 	avg_search_speed_ms: 10.94798087290156
2025-03-09 07:05:58,352 [INFO]: 	99p_search_speed_ms: 14.267291729338467
2025-03-09 07:05:58,352 [INFO]: 	reconstruction error %: 0.0
2025-03-09 07:05:58,352 [INFO]: 	nb vectors: 4002
2025-03-09 07:05:58,352 [INFO]: 	vectors dimension: 49152
2025-03-09 07:05:58,352 [INFO]: 	compression ratio: 0.9993085661685986
2025-03-09 07:05:58,352 [INFO]: }
2025-03-09 07:05:58,352 [INFO]: 	>>> Finished "Creating the index" in 52.9740 secs
2025-03-09 07:05:58,352 [INFO]: >>> Finished "Launching the whole pipeline" in 53.0008 secs
2025-03-09 07:05:59: [retrieval_preprocessing] calculating distances ...
2025-03-09 07:06:00: [retrieval_preprocessing] finished and saved retrieval indices for episode 6136 [episode count 17/20]
[retrieval_preprocessing] for episode 81180 [episode count 18/20], we have num_retrieval=np.int64(3916) num_query=np.int64(310)
2025-03-09 07:06:00,680 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-09 07:06:01,380 [INFO]: Launching the whole pipeline 03/09/2025, 07:06:01
2025-03-09 07:06:01,381 [INFO]: Reading total number of vectors and dimension 03/09/2025, 07:06:01
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1140.69it/s]
2025-03-09 07:06:01,414 [INFO]: There are 3916 embeddings of dim 49152
2025-03-09 07:06:01,414 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0332 secs
2025-03-09 07:06:01,414 [INFO]: 	Compute estimated construction time of the index 03/09/2025, 07:06:01
2025-03-09 07:06:01,414 [INFO]: 		-> Train: 16.7 minutes
2025-03-09 07:06:01,414 [INFO]: 		-> Add: 2.2 seconds
2025-03-09 07:06:01,414 [INFO]: 		Total: 16.7 minutes
2025-03-09 07:06:01,414 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0001 secs
2025-03-09 07:06:01,414 [INFO]: 	Checking that your have enough memory available to create the index 03/09/2025, 07:06:01
2025-03-09 07:06:01,414 [INFO]: 808.2MB of memory will be needed to build the index (more might be used if you have more)
2025-03-09 07:06:01,414 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0002 secs
2025-03-09 07:06:01,414 [INFO]: 	Selecting most promising index types given data characteristics 03/09/2025, 07:06:01
2025-03-09 07:06:01,414 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-09 07:06:01,414 [INFO]: 	Creating the index 03/09/2025, 07:06:01
2025-03-09 07:06:01,414 [INFO]: 		-> Instanciate the index HNSW15 03/09/2025, 07:06:01
2025-03-09 07:06:01,415 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0009 secs
2025-03-09 07:06:01,416 [INFO]: 		-> Adding the vectors to the index 03/09/2025, 07:06:01
2025-03-09 07:06:01,416 [INFO]: The memory available for adding the vectors is 49.3GB(total available - used by the index)
2025-03-09 07:06:01,416 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/16 [00:00<?, ?it/s]  6%|▋         | 1/16 [00:00<00:01,  7.55it/s] 31%|███▏      | 5/16 [00:00<00:00, 23.75it/s] 56%|█████▋    | 9/16 [00:00<00:00, 29.79it/s] 81%|████████▏ | 13/16 [00:00<00:00, 32.82it/s]100%|██████████| 16/16 [00:04<00:00,  3.62it/s]
2025-03-09 07:06:05,836 [INFO]: 	Computing best hyperparameters for index knn.index 03/09/2025, 07:06:05
2025-03-09 07:06:41,199 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 35.3632 secs
2025-03-09 07:06:41,200 [INFO]: The best hyperparameters are: efSearch=180
2025-03-09 07:06:41,200 [INFO]: 	Compute fast metrics 03/09/2025, 07:06:41
  0%|          | 0/4 [00:00<?, ?it/s] 50%|█████     | 2/4 [00:00<00:00, 19.03it/s] 75%|███████▌  | 3/4 [00:00<00:00, 20.54it/s]
2025-03-09 07:06:53,923 [INFO]: 	>>> Finished "Compute fast metrics" in 12.7234 secs
2025-03-09 07:06:53,925 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 52.5094 secs
2025-03-09 07:06:53,925 [INFO]: {
2025-03-09 07:06:53,925 [INFO]: 	index_key: HNSW15
2025-03-09 07:06:53,925 [INFO]: 	index_param: efSearch=180
2025-03-09 07:06:53,925 [INFO]: 	index_path: knn.index
2025-03-09 07:06:53,925 [INFO]: 	size in bytes: 770449570
2025-03-09 07:06:53,925 [INFO]: 	avg_search_speed_ms: 9.479550447014836
2025-03-09 07:06:53,925 [INFO]: 	99p_search_speed_ms: 12.301094187423589
2025-03-09 07:06:53,925 [INFO]: 	reconstruction error %: 0.0
2025-03-09 07:06:53,925 [INFO]: 	nb vectors: 3916
2025-03-09 07:06:53,925 [INFO]: 	vectors dimension: 49152
2025-03-09 07:06:53,925 [INFO]: 	compression ratio: 0.9993086607861953
2025-03-09 07:06:53,925 [INFO]: }
2025-03-09 07:06:53,925 [INFO]: 	>>> Finished "Creating the index" in 52.5109 secs
2025-03-09 07:06:53,925 [INFO]: >>> Finished "Launching the whole pipeline" in 52.5448 secs
2025-03-09 07:06:55: [retrieval_preprocessing] calculating distances ...
2025-03-09 07:06:56: [retrieval_preprocessing] finished and saved retrieval indices for episode 81180 [episode count 18/20]
[retrieval_preprocessing] for episode 91421 [episode count 19/20], we have num_retrieval=np.int64(3966) num_query=np.int64(260)
2025-03-09 07:06:56,670 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-09 07:06:57,292 [INFO]: Launching the whole pipeline 03/09/2025, 07:06:57
2025-03-09 07:06:57,292 [INFO]: Reading total number of vectors and dimension 03/09/2025, 07:06:57
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1211.88it/s]
2025-03-09 07:06:57,325 [INFO]: There are 3966 embeddings of dim 49152
2025-03-09 07:06:57,325 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0333 secs
2025-03-09 07:06:57,325 [INFO]: 	Compute estimated construction time of the index 03/09/2025, 07:06:57
2025-03-09 07:06:57,326 [INFO]: 		-> Train: 16.7 minutes
2025-03-09 07:06:57,326 [INFO]: 		-> Add: 2.2 seconds
2025-03-09 07:06:57,326 [INFO]: 		Total: 16.7 minutes
2025-03-09 07:06:57,326 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0001 secs
2025-03-09 07:06:57,326 [INFO]: 	Checking that your have enough memory available to create the index 03/09/2025, 07:06:57
2025-03-09 07:06:57,326 [INFO]: 818.5MB of memory will be needed to build the index (more might be used if you have more)
2025-03-09 07:06:57,326 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0002 secs
2025-03-09 07:06:57,326 [INFO]: 	Selecting most promising index types given data characteristics 03/09/2025, 07:06:57
2025-03-09 07:06:57,326 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-09 07:06:57,326 [INFO]: 	Creating the index 03/09/2025, 07:06:57
2025-03-09 07:06:57,326 [INFO]: 		-> Instanciate the index HNSW15 03/09/2025, 07:06:57
2025-03-09 07:06:57,327 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0009 secs
2025-03-09 07:06:57,327 [INFO]: 		-> Adding the vectors to the index 03/09/2025, 07:06:57
2025-03-09 07:06:57,327 [INFO]: The memory available for adding the vectors is 49.3GB(total available - used by the index)
2025-03-09 07:06:57,327 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/16 [00:00<?, ?it/s]  6%|▋         | 1/16 [00:00<00:02,  6.57it/s] 31%|███▏      | 5/16 [00:00<00:00, 21.21it/s] 56%|█████▋    | 9/16 [00:00<00:00, 27.02it/s] 81%|████████▏ | 13/16 [00:00<00:00, 29.94it/s]100%|██████████| 16/16 [00:04<00:00,  3.56it/s]
2025-03-09 07:07:01,831 [INFO]: 	Computing best hyperparameters for index knn.index 03/09/2025, 07:07:01
2025-03-09 07:07:43,120 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 41.2885 secs
2025-03-09 07:07:43,125 [INFO]: The best hyperparameters are: efSearch=191
2025-03-09 07:07:43,125 [INFO]: 	Compute fast metrics 03/09/2025, 07:07:43
  0%|          | 0/4 [00:00<?, ?it/s] 25%|██▌       | 1/4 [00:00<00:00,  9.40it/s] 75%|███████▌  | 3/4 [00:00<00:00, 17.46it/s]
2025-03-09 07:07:55,232 [INFO]: 	>>> Finished "Compute fast metrics" in 12.1075 secs
2025-03-09 07:07:55,235 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 57.9077 secs
2025-03-09 07:07:55,235 [INFO]: {
2025-03-09 07:07:55,235 [INFO]: 	index_key: HNSW15
2025-03-09 07:07:55,235 [INFO]: 	index_param: efSearch=191
2025-03-09 07:07:55,235 [INFO]: 	index_path: knn.index
2025-03-09 07:07:55,235 [INFO]: 	size in bytes: 780286870
2025-03-09 07:07:55,235 [INFO]: 	avg_search_speed_ms: 11.262921389110538
2025-03-09 07:07:55,235 [INFO]: 	99p_search_speed_ms: 26.33232962107286
2025-03-09 07:07:55,235 [INFO]: 	reconstruction error %: 0.0
2025-03-09 07:07:55,235 [INFO]: 	nb vectors: 3966
2025-03-09 07:07:55,235 [INFO]: 	vectors dimension: 49152
2025-03-09 07:07:55,235 [INFO]: 	compression ratio: 0.9993085337960383
2025-03-09 07:07:55,235 [INFO]: }
2025-03-09 07:07:55,235 [INFO]: 	>>> Finished "Creating the index" in 57.9093 secs
2025-03-09 07:07:55,235 [INFO]: >>> Finished "Launching the whole pipeline" in 57.9433 secs
2025-03-09 07:07:56: [retrieval_preprocessing] calculating distances ...
2025-03-09 07:07:57: [retrieval_preprocessing] finished and saved retrieval indices for episode 91421 [episode count 19/20]
2025-03-09 07:07:57: [retrieval_preprocessing] finished for (1469427884, 'marker') [chosen_id count 0/10]
2025-03-09 07:07:59: [retrieval_preprocessing] concatenated all embeddings and indices for 20 episodes for (9933578360, 'drawer') [chosen_id count 1/10]
2025-03-09 07:07:59: [retrieval_preprocessing] we have num_total=4816 embedding_dim=49152
[retrieval_preprocessing] for episode 51970 [episode count 0/20], we have num_retrieval=np.int64(4643) num_query=np.int64(173)
2025-03-09 07:07:59,894 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-09 07:08:00,671 [INFO]: Launching the whole pipeline 03/09/2025, 07:08:00
2025-03-09 07:08:00,671 [INFO]: Reading total number of vectors and dimension 03/09/2025, 07:08:00
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1198.37it/s]
2025-03-09 07:08:00,704 [INFO]: There are 4643 embeddings of dim 49152
2025-03-09 07:08:00,704 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0327 secs
2025-03-09 07:08:00,704 [INFO]: 	Compute estimated construction time of the index 03/09/2025, 07:08:00
2025-03-09 07:08:00,704 [INFO]: 		-> Train: 16.7 minutes
2025-03-09 07:08:00,704 [INFO]: 		-> Add: 2.6 seconds
2025-03-09 07:08:00,704 [INFO]: 		Total: 16.7 minutes
2025-03-09 07:08:00,704 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0001 secs
2025-03-09 07:08:00,704 [INFO]: 	Checking that your have enough memory available to create the index 03/09/2025, 07:08:00
2025-03-09 07:08:00,704 [INFO]: 958.2MB of memory will be needed to build the index (more might be used if you have more)
2025-03-09 07:08:00,704 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0002 secs
2025-03-09 07:08:00,704 [INFO]: 	Selecting most promising index types given data characteristics 03/09/2025, 07:08:00
2025-03-09 07:08:00,704 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-09 07:08:00,704 [INFO]: 	Creating the index 03/09/2025, 07:08:00
2025-03-09 07:08:00,704 [INFO]: 		-> Instanciate the index HNSW15 03/09/2025, 07:08:00
2025-03-09 07:08:00,705 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0011 secs
2025-03-09 07:08:00,706 [INFO]: 		-> Adding the vectors to the index 03/09/2025, 07:08:00
2025-03-09 07:08:00,706 [INFO]: The memory available for adding the vectors is 49.1GB(total available - used by the index)
2025-03-09 07:08:00,706 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/19 [00:00<?, ?it/s]  5%|▌         | 1/19 [00:00<00:01,  9.66it/s] 32%|███▏      | 6/19 [00:00<00:00, 32.21it/s] 58%|█████▊    | 11/19 [00:00<00:00, 38.93it/s] 84%|████████▍ | 16/19 [00:00<00:00, 42.48it/s]100%|██████████| 19/19 [00:04<00:00,  4.11it/s]
2025-03-09 07:08:05,333 [INFO]: 	Computing best hyperparameters for index knn.index 03/09/2025, 07:08:05
2025-03-09 07:08:49,754 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 44.4208 secs
2025-03-09 07:08:49,755 [INFO]: The best hyperparameters are: efSearch=161
2025-03-09 07:08:49,755 [INFO]: 	Compute fast metrics 03/09/2025, 07:08:49
  0%|          | 0/4 [00:00<?, ?it/s] 25%|██▌       | 1/4 [00:00<00:00,  8.49it/s] 75%|███████▌  | 3/4 [00:00<00:00, 17.20it/s]
2025-03-09 07:09:02,464 [INFO]: 	>>> Finished "Compute fast metrics" in 12.7095 secs
2025-03-09 07:09:02,467 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 61.7615 secs
2025-03-09 07:09:02,467 [INFO]: {
2025-03-09 07:09:02,467 [INFO]: 	index_key: HNSW15
2025-03-09 07:09:02,467 [INFO]: 	index_param: efSearch=161
2025-03-09 07:09:02,467 [INFO]: 	index_path: knn.index
2025-03-09 07:09:02,467 [INFO]: 	size in bytes: 913482310
2025-03-09 07:09:02,467 [INFO]: 	avg_search_speed_ms: 8.413619610901586
2025-03-09 07:09:02,467 [INFO]: 	99p_search_speed_ms: 22.591124922037075
2025-03-09 07:09:02,467 [INFO]: 	reconstruction error %: 0.0
2025-03-09 07:09:02,467 [INFO]: 	nb vectors: 4643
2025-03-09 07:09:02,467 [INFO]: 	vectors dimension: 49152
2025-03-09 07:09:02,467 [INFO]: 	compression ratio: 0.9993088360955781
2025-03-09 07:09:02,467 [INFO]: }
2025-03-09 07:09:02,467 [INFO]: 	>>> Finished "Creating the index" in 61.7631 secs
2025-03-09 07:09:02,467 [INFO]: >>> Finished "Launching the whole pipeline" in 61.7965 secs
2025-03-09 07:09:03: [retrieval_preprocessing] calculating distances ...
2025-03-09 07:09:03: [retrieval_preprocessing] finished and saved retrieval indices for episode 51970 [episode count 0/20]
[retrieval_preprocessing] for episode 1411 [episode count 1/20], we have num_retrieval=np.int64(4627) num_query=np.int64(189)
2025-03-09 07:09:04,051 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-09 07:09:04,620 [INFO]: Launching the whole pipeline 03/09/2025, 07:09:04
2025-03-09 07:09:04,620 [INFO]: Reading total number of vectors and dimension 03/09/2025, 07:09:04
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1479.99it/s]
2025-03-09 07:09:04,649 [INFO]: There are 4627 embeddings of dim 49152
2025-03-09 07:09:04,650 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0297 secs
2025-03-09 07:09:04,650 [INFO]: 	Compute estimated construction time of the index 03/09/2025, 07:09:04
2025-03-09 07:09:04,650 [INFO]: 		-> Train: 16.7 minutes
2025-03-09 07:09:04,650 [INFO]: 		-> Add: 2.5 seconds
2025-03-09 07:09:04,650 [INFO]: 		Total: 16.7 minutes
2025-03-09 07:09:04,650 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0001 secs
2025-03-09 07:09:04,650 [INFO]: 	Checking that your have enough memory available to create the index 03/09/2025, 07:09:04
2025-03-09 07:09:04,650 [INFO]: 954.9MB of memory will be needed to build the index (more might be used if you have more)
2025-03-09 07:09:04,650 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0001 secs
2025-03-09 07:09:04,650 [INFO]: 	Selecting most promising index types given data characteristics 03/09/2025, 07:09:04
2025-03-09 07:09:04,650 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-09 07:09:04,650 [INFO]: 	Creating the index 03/09/2025, 07:09:04
2025-03-09 07:09:04,650 [INFO]: 		-> Instanciate the index HNSW15 03/09/2025, 07:09:04
2025-03-09 07:09:04,651 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0011 secs
2025-03-09 07:09:04,652 [INFO]: 		-> Adding the vectors to the index 03/09/2025, 07:09:04
2025-03-09 07:09:04,652 [INFO]: The memory available for adding the vectors is 49.2GB(total available - used by the index)
2025-03-09 07:09:04,652 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/19 [00:00<?, ?it/s]  5%|▌         | 1/19 [00:00<00:02,  8.29it/s] 32%|███▏      | 6/19 [00:00<00:00, 30.14it/s] 58%|█████▊    | 11/19 [00:00<00:00, 36.93it/s] 84%|████████▍ | 16/19 [00:00<00:00, 40.07it/s]100%|██████████| 19/19 [00:04<00:00,  4.52it/s]
2025-03-09 07:09:08,857 [INFO]: 	Computing best hyperparameters for index knn.index 03/09/2025, 07:09:08
2025-03-09 07:09:51,598 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 42.7399 secs
2025-03-09 07:09:51,598 [INFO]: The best hyperparameters are: efSearch=174
2025-03-09 07:09:51,598 [INFO]: 	Compute fast metrics 03/09/2025, 07:09:51
  0%|          | 0/4 [00:00<?, ?it/s] 50%|█████     | 2/4 [00:00<00:00, 19.13it/s] 75%|███████▌  | 3/4 [00:00<00:00, 21.18it/s]
2025-03-09 07:10:04,670 [INFO]: 	>>> Finished "Compute fast metrics" in 13.0722 secs
2025-03-09 07:10:04,674 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 60.0221 secs
2025-03-09 07:10:04,674 [INFO]: {
2025-03-09 07:10:04,674 [INFO]: 	index_key: HNSW15
2025-03-09 07:10:04,674 [INFO]: 	index_param: efSearch=174
2025-03-09 07:10:04,674 [INFO]: 	index_path: knn.index
2025-03-09 07:10:04,674 [INFO]: 	size in bytes: 910334350
2025-03-09 07:10:04,674 [INFO]: 	avg_search_speed_ms: 8.654921454866075
2025-03-09 07:10:04,674 [INFO]: 	99p_search_speed_ms: 21.64792423136533
2025-03-09 07:10:04,674 [INFO]: 	reconstruction error %: 0.0
2025-03-09 07:10:04,674 [INFO]: 	nb vectors: 4627
2025-03-09 07:10:04,674 [INFO]: 	vectors dimension: 49152
2025-03-09 07:10:04,674 [INFO]: 	compression ratio: 0.9993088978791144
2025-03-09 07:10:04,674 [INFO]: }
2025-03-09 07:10:04,674 [INFO]: 	>>> Finished "Creating the index" in 60.0238 secs
2025-03-09 07:10:04,674 [INFO]: >>> Finished "Launching the whole pipeline" in 60.0542 secs
2025-03-09 07:10:05: [retrieval_preprocessing] calculating distances ...
2025-03-09 07:10:06: [retrieval_preprocessing] finished and saved retrieval indices for episode 1411 [episode count 1/20]
[retrieval_preprocessing] for episode 88328 [episode count 2/20], we have num_retrieval=np.int64(4252) num_query=np.int64(564)
2025-03-09 07:10:08,915 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-09 07:10:09,657 [INFO]: Launching the whole pipeline 03/09/2025, 07:10:09
2025-03-09 07:10:09,657 [INFO]: Reading total number of vectors and dimension 03/09/2025, 07:10:09
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1402.78it/s]
2025-03-09 07:10:09,690 [INFO]: There are 4252 embeddings of dim 49152
2025-03-09 07:10:09,690 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0327 secs
2025-03-09 07:10:09,690 [INFO]: 	Compute estimated construction time of the index 03/09/2025, 07:10:09
2025-03-09 07:10:09,690 [INFO]: 		-> Train: 16.7 minutes
2025-03-09 07:10:09,690 [INFO]: 		-> Add: 2.3 seconds
2025-03-09 07:10:09,690 [INFO]: 		Total: 16.7 minutes
2025-03-09 07:10:09,690 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0001 secs
2025-03-09 07:10:09,690 [INFO]: 	Checking that your have enough memory available to create the index 03/09/2025, 07:10:09
2025-03-09 07:10:09,690 [INFO]: 877.5MB of memory will be needed to build the index (more might be used if you have more)
2025-03-09 07:10:09,690 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0002 secs
2025-03-09 07:10:09,690 [INFO]: 	Selecting most promising index types given data characteristics 03/09/2025, 07:10:09
2025-03-09 07:10:09,690 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-09 07:10:09,691 [INFO]: 	Creating the index 03/09/2025, 07:10:09
2025-03-09 07:10:09,691 [INFO]: 		-> Instanciate the index HNSW15 03/09/2025, 07:10:09
2025-03-09 07:10:09,692 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0012 secs
2025-03-09 07:10:09,692 [INFO]: 		-> Adding the vectors to the index 03/09/2025, 07:10:09
2025-03-09 07:10:09,692 [INFO]: The memory available for adding the vectors is 49.2GB(total available - used by the index)
2025-03-09 07:10:09,692 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/17 [00:00<?, ?it/s]  6%|▌         | 1/17 [00:00<00:01,  9.12it/s] 35%|███▌      | 6/17 [00:00<00:00, 31.73it/s] 59%|█████▉    | 10/17 [00:00<00:00, 35.08it/s] 82%|████████▏ | 14/17 [00:00<00:00, 30.45it/s]100%|██████████| 17/17 [00:03<00:00,  4.41it/s]
2025-03-09 07:10:13,552 [INFO]: 	Computing best hyperparameters for index knn.index 03/09/2025, 07:10:13
2025-03-09 07:10:58,046 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 44.4931 secs
2025-03-09 07:10:58,046 [INFO]: The best hyperparameters are: efSearch=151
2025-03-09 07:10:58,047 [INFO]: 	Compute fast metrics 03/09/2025, 07:10:58
  0%|          | 0/4 [00:00<?, ?it/s] 50%|█████     | 2/4 [00:00<00:00, 16.57it/s] 75%|███████▌  | 3/4 [00:00<00:00, 17.87it/s]
2025-03-09 07:11:11,007 [INFO]: 	>>> Finished "Compute fast metrics" in 12.9608 secs
2025-03-09 07:11:11,010 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 61.3183 secs
2025-03-09 07:11:11,011 [INFO]: {
2025-03-09 07:11:11,011 [INFO]: 	index_key: HNSW15
2025-03-09 07:11:11,011 [INFO]: 	index_param: efSearch=151
2025-03-09 07:11:11,011 [INFO]: 	index_path: knn.index
2025-03-09 07:11:11,011 [INFO]: 	size in bytes: 836555530
2025-03-09 07:11:11,011 [INFO]: 	avg_search_speed_ms: 8.776596886750974
2025-03-09 07:11:11,011 [INFO]: 	99p_search_speed_ms: 22.531459135934693
2025-03-09 07:11:11,011 [INFO]: 	reconstruction error %: 0.0
2025-03-09 07:11:11,011 [INFO]: 	nb vectors: 4252
2025-03-09 07:11:11,011 [INFO]: 	vectors dimension: 49152
2025-03-09 07:11:11,011 [INFO]: 	compression ratio: 0.9993086962200823
2025-03-09 07:11:11,011 [INFO]: }
2025-03-09 07:11:11,011 [INFO]: 	>>> Finished "Creating the index" in 61.3202 secs
2025-03-09 07:11:11,011 [INFO]: >>> Finished "Launching the whole pipeline" in 61.3537 secs
2025-03-09 07:11:13: [retrieval_preprocessing] calculating distances ...
2025-03-09 07:11:14: [retrieval_preprocessing] finished and saved retrieval indices for episode 88328 [episode count 2/20]
[retrieval_preprocessing] for episode 8457 [episode count 3/20], we have num_retrieval=np.int64(4648) num_query=np.int64(168)
2025-03-09 07:11:15,366 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-09 07:11:15,951 [INFO]: Launching the whole pipeline 03/09/2025, 07:11:15
2025-03-09 07:11:15,951 [INFO]: Reading total number of vectors and dimension 03/09/2025, 07:11:15
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1384.26it/s]
2025-03-09 07:11:15,990 [INFO]: There are 4648 embeddings of dim 49152
2025-03-09 07:11:15,991 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0395 secs
2025-03-09 07:11:15,991 [INFO]: 	Compute estimated construction time of the index 03/09/2025, 07:11:15
2025-03-09 07:11:15,991 [INFO]: 		-> Train: 16.7 minutes
2025-03-09 07:11:15,991 [INFO]: 		-> Add: 2.6 seconds
2025-03-09 07:11:15,991 [INFO]: 		Total: 16.7 minutes
2025-03-09 07:11:15,991 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0002 secs
2025-03-09 07:11:15,991 [INFO]: 	Checking that your have enough memory available to create the index 03/09/2025, 07:11:15
2025-03-09 07:11:15,991 [INFO]: 959.2MB of memory will be needed to build the index (more might be used if you have more)
2025-03-09 07:11:15,991 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0001 secs
2025-03-09 07:11:15,991 [INFO]: 	Selecting most promising index types given data characteristics 03/09/2025, 07:11:15
2025-03-09 07:11:15,991 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-09 07:11:15,991 [INFO]: 	Creating the index 03/09/2025, 07:11:15
2025-03-09 07:11:15,991 [INFO]: 		-> Instanciate the index HNSW15 03/09/2025, 07:11:15
2025-03-09 07:11:15,992 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0009 secs
2025-03-09 07:11:15,992 [INFO]: 		-> Adding the vectors to the index 03/09/2025, 07:11:15
2025-03-09 07:11:15,992 [INFO]: The memory available for adding the vectors is 49.1GB(total available - used by the index)
2025-03-09 07:11:15,992 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/19 [00:00<?, ?it/s]  5%|▌         | 1/19 [00:00<00:03,  5.98it/s] 32%|███▏      | 6/19 [00:00<00:00, 26.10it/s] 58%|█████▊    | 11/19 [00:00<00:00, 35.19it/s] 84%|████████▍ | 16/19 [00:00<00:00, 40.21it/s]100%|██████████| 19/19 [00:04<00:00,  4.22it/s]
2025-03-09 07:11:20,495 [INFO]: 	Computing best hyperparameters for index knn.index 03/09/2025, 07:11:20
2025-03-09 07:12:04,997 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 44.5014 secs
2025-03-09 07:12:04,997 [INFO]: The best hyperparameters are: efSearch=189
2025-03-09 07:12:04,997 [INFO]: 	Compute fast metrics 03/09/2025, 07:12:04
  0%|          | 0/4 [00:00<?, ?it/s] 25%|██▌       | 1/4 [00:00<00:00,  6.10it/s] 75%|███████▌  | 3/4 [00:00<00:00, 13.58it/s]
2025-03-09 07:12:18,148 [INFO]: 	>>> Finished "Compute fast metrics" in 13.1503 secs
2025-03-09 07:12:18,151 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 62.1590 secs
2025-03-09 07:12:18,152 [INFO]: {
2025-03-09 07:12:18,152 [INFO]: 	index_key: HNSW15
2025-03-09 07:12:18,152 [INFO]: 	index_param: efSearch=189
2025-03-09 07:12:18,152 [INFO]: 	index_path: knn.index
2025-03-09 07:12:18,152 [INFO]: 	size in bytes: 914466070
2025-03-09 07:12:18,152 [INFO]: 	avg_search_speed_ms: 9.751508201220114
2025-03-09 07:12:18,152 [INFO]: 	99p_search_speed_ms: 26.989823672920465
2025-03-09 07:12:18,152 [INFO]: 	reconstruction error %: 0.0
2025-03-09 07:12:18,152 [INFO]: 	nb vectors: 4648
2025-03-09 07:12:18,152 [INFO]: 	vectors dimension: 49152
2025-03-09 07:12:18,152 [INFO]: 	compression ratio: 0.9993087922879413
2025-03-09 07:12:18,152 [INFO]: }
2025-03-09 07:12:18,152 [INFO]: 	>>> Finished "Creating the index" in 62.1605 secs
2025-03-09 07:12:18,152 [INFO]: >>> Finished "Launching the whole pipeline" in 62.2008 secs
2025-03-09 07:12:19: [retrieval_preprocessing] calculating distances ...
2025-03-09 07:12:19: [retrieval_preprocessing] finished and saved retrieval indices for episode 8457 [episode count 3/20]
[retrieval_preprocessing] for episode 68873 [episode count 4/20], we have num_retrieval=np.int64(4657) num_query=np.int64(159)
2025-03-09 07:12:20,570 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-09 07:12:21,276 [INFO]: Launching the whole pipeline 03/09/2025, 07:12:21
2025-03-09 07:12:21,276 [INFO]: Reading total number of vectors and dimension 03/09/2025, 07:12:21
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1462.96it/s]
2025-03-09 07:12:21,306 [INFO]: There are 4657 embeddings of dim 49152
2025-03-09 07:12:21,306 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0301 secs
2025-03-09 07:12:21,307 [INFO]: 	Compute estimated construction time of the index 03/09/2025, 07:12:21
2025-03-09 07:12:21,307 [INFO]: 		-> Train: 16.7 minutes
2025-03-09 07:12:21,307 [INFO]: 		-> Add: 2.6 seconds
2025-03-09 07:12:21,307 [INFO]: 		Total: 16.7 minutes
2025-03-09 07:12:21,307 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0001 secs
2025-03-09 07:12:21,307 [INFO]: 	Checking that your have enough memory available to create the index 03/09/2025, 07:12:21
2025-03-09 07:12:21,307 [INFO]: 961.1MB of memory will be needed to build the index (more might be used if you have more)
2025-03-09 07:12:21,307 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0003 secs
2025-03-09 07:12:21,307 [INFO]: 	Selecting most promising index types given data characteristics 03/09/2025, 07:12:21
2025-03-09 07:12:21,307 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-09 07:12:21,307 [INFO]: 	Creating the index 03/09/2025, 07:12:21
2025-03-09 07:12:21,307 [INFO]: 		-> Instanciate the index HNSW15 03/09/2025, 07:12:21
2025-03-09 07:12:21,308 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0009 secs
2025-03-09 07:12:21,308 [INFO]: 		-> Adding the vectors to the index 03/09/2025, 07:12:21
2025-03-09 07:12:21,308 [INFO]: The memory available for adding the vectors is 49.1GB(total available - used by the index)
2025-03-09 07:12:21,308 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/19 [00:00<?, ?it/s]  5%|▌         | 1/19 [00:00<00:02,  8.17it/s] 26%|██▋       | 5/19 [00:00<00:00, 22.57it/s] 47%|████▋     | 9/19 [00:00<00:00, 28.37it/s] 74%|███████▎  | 14/19 [00:00<00:00, 35.48it/s]100%|██████████| 19/19 [00:04<00:00,  2.88it/s]100%|██████████| 19/19 [00:04<00:00,  4.27it/s]
2025-03-09 07:12:25,761 [INFO]: 	Computing best hyperparameters for index knn.index 03/09/2025, 07:12:25
2025-03-09 07:13:09,919 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 44.1574 secs
2025-03-09 07:13:09,919 [INFO]: The best hyperparameters are: efSearch=191
2025-03-09 07:13:09,919 [INFO]: 	Compute fast metrics 03/09/2025, 07:13:09
  0%|          | 0/4 [00:00<?, ?it/s] 50%|█████     | 2/4 [00:00<00:00, 18.54it/s] 75%|███████▌  | 3/4 [00:00<00:00, 20.69it/s]
2025-03-09 07:13:22,812 [INFO]: 	>>> Finished "Compute fast metrics" in 12.8932 secs
2025-03-09 07:13:22,817 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 61.5082 secs
2025-03-09 07:13:22,817 [INFO]: {
2025-03-09 07:13:22,817 [INFO]: 	index_key: HNSW15
2025-03-09 07:13:22,817 [INFO]: 	index_param: efSearch=191
2025-03-09 07:13:22,817 [INFO]: 	index_path: knn.index
2025-03-09 07:13:22,817 [INFO]: 	size in bytes: 916236730
2025-03-09 07:13:22,817 [INFO]: 	avg_search_speed_ms: 9.996384700124493
2025-03-09 07:13:22,817 [INFO]: 	99p_search_speed_ms: 19.360663366969682
2025-03-09 07:13:22,817 [INFO]: 	reconstruction error %: 0.0
2025-03-09 07:13:22,817 [INFO]: 	nb vectors: 4657
2025-03-09 07:13:22,817 [INFO]: 	vectors dimension: 49152
2025-03-09 07:13:22,817 [INFO]: 	compression ratio: 0.9993088314632399
2025-03-09 07:13:22,817 [INFO]: }
2025-03-09 07:13:22,817 [INFO]: 	>>> Finished "Creating the index" in 61.5097 secs
2025-03-09 07:13:22,817 [INFO]: >>> Finished "Launching the whole pipeline" in 61.5406 secs
2025-03-09 07:13:23: [retrieval_preprocessing] calculating distances ...
2025-03-09 07:13:24: [retrieval_preprocessing] finished and saved retrieval indices for episode 68873 [episode count 4/20]
[retrieval_preprocessing] for episode 19088 [episode count 5/20], we have num_retrieval=np.int64(4594) num_query=np.int64(222)
2025-03-09 07:13:24,776 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-09 07:13:25,356 [INFO]: Launching the whole pipeline 03/09/2025, 07:13:25
2025-03-09 07:13:25,356 [INFO]: Reading total number of vectors and dimension 03/09/2025, 07:13:25
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1203.19it/s]
2025-03-09 07:13:25,385 [INFO]: There are 4594 embeddings of dim 49152
2025-03-09 07:13:25,385 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0287 secs
2025-03-09 07:13:25,385 [INFO]: 	Compute estimated construction time of the index 03/09/2025, 07:13:25
2025-03-09 07:13:25,385 [INFO]: 		-> Train: 16.7 minutes
2025-03-09 07:13:25,385 [INFO]: 		-> Add: 2.5 seconds
2025-03-09 07:13:25,385 [INFO]: 		Total: 16.7 minutes
2025-03-09 07:13:25,385 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0001 secs
2025-03-09 07:13:25,385 [INFO]: 	Checking that your have enough memory available to create the index 03/09/2025, 07:13:25
2025-03-09 07:13:25,385 [INFO]: 948.1MB of memory will be needed to build the index (more might be used if you have more)
2025-03-09 07:13:25,385 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0001 secs
2025-03-09 07:13:25,386 [INFO]: 	Selecting most promising index types given data characteristics 03/09/2025, 07:13:25
2025-03-09 07:13:25,386 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-09 07:13:25,386 [INFO]: 	Creating the index 03/09/2025, 07:13:25
2025-03-09 07:13:25,386 [INFO]: 		-> Instanciate the index HNSW15 03/09/2025, 07:13:25
2025-03-09 07:13:25,387 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0010 secs
2025-03-09 07:13:25,387 [INFO]: 		-> Adding the vectors to the index 03/09/2025, 07:13:25
2025-03-09 07:13:25,387 [INFO]: The memory available for adding the vectors is 49.2GB(total available - used by the index)
2025-03-09 07:13:25,387 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/19 [00:00<?, ?it/s]  5%|▌         | 1/19 [00:00<00:02,  8.29it/s] 32%|███▏      | 6/19 [00:00<00:00, 30.68it/s] 58%|█████▊    | 11/19 [00:00<00:00, 39.07it/s] 84%|████████▍ | 16/19 [00:00<00:00, 43.20it/s]100%|██████████| 19/19 [00:04<00:00,  4.33it/s]
2025-03-09 07:13:29,780 [INFO]: 	Computing best hyperparameters for index knn.index 03/09/2025, 07:13:29
2025-03-09 07:14:09,401 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 39.6207 secs
2025-03-09 07:14:09,401 [INFO]: The best hyperparameters are: efSearch=189
2025-03-09 07:14:09,401 [INFO]: 	Compute fast metrics 03/09/2025, 07:14:09
  0%|          | 0/4 [00:00<?, ?it/s] 50%|█████     | 2/4 [00:00<00:00, 19.82it/s] 75%|███████▌  | 3/4 [00:00<00:00, 21.44it/s]
2025-03-09 07:14:22,500 [INFO]: 	>>> Finished "Compute fast metrics" in 13.0992 secs
2025-03-09 07:14:22,504 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 57.1169 secs
2025-03-09 07:14:22,504 [INFO]: {
2025-03-09 07:14:22,504 [INFO]: 	index_key: HNSW15
2025-03-09 07:14:22,504 [INFO]: 	index_param: efSearch=189
2025-03-09 07:14:22,504 [INFO]: 	index_path: knn.index
2025-03-09 07:14:22,504 [INFO]: 	size in bytes: 903841870
2025-03-09 07:14:22,504 [INFO]: 	avg_search_speed_ms: 10.582871667341028
2025-03-09 07:14:22,504 [INFO]: 	99p_search_speed_ms: 20.371650736778964
2025-03-09 07:14:22,504 [INFO]: 	reconstruction error %: 0.0
2025-03-09 07:14:22,504 [INFO]: 	nb vectors: 4594
2025-03-09 07:14:22,504 [INFO]: 	vectors dimension: 49152
2025-03-09 07:14:22,504 [INFO]: 	compression ratio: 0.9993088193623958
2025-03-09 07:14:22,504 [INFO]: }
2025-03-09 07:14:22,504 [INFO]: 	>>> Finished "Creating the index" in 57.1186 secs
2025-03-09 07:14:22,504 [INFO]: >>> Finished "Launching the whole pipeline" in 57.1480 secs
2025-03-09 07:14:23: [retrieval_preprocessing] calculating distances ...
2025-03-09 07:14:24: [retrieval_preprocessing] finished and saved retrieval indices for episode 19088 [episode count 5/20]
[retrieval_preprocessing] for episode 83219 [episode count 6/20], we have num_retrieval=np.int64(4627) num_query=np.int64(189)
2025-03-09 07:14:25,890 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-09 07:14:26,689 [INFO]: Launching the whole pipeline 03/09/2025, 07:14:26
2025-03-09 07:14:26,689 [INFO]: Reading total number of vectors and dimension 03/09/2025, 07:14:26
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1328.99it/s]
2025-03-09 07:14:26,731 [INFO]: There are 4627 embeddings of dim 49152
2025-03-09 07:14:26,731 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0421 secs
2025-03-09 07:14:26,732 [INFO]: 	Compute estimated construction time of the index 03/09/2025, 07:14:26
2025-03-09 07:14:26,732 [INFO]: 		-> Train: 16.7 minutes
2025-03-09 07:14:26,732 [INFO]: 		-> Add: 2.5 seconds
2025-03-09 07:14:26,732 [INFO]: 		Total: 16.7 minutes
2025-03-09 07:14:26,732 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0002 secs
2025-03-09 07:14:26,732 [INFO]: 	Checking that your have enough memory available to create the index 03/09/2025, 07:14:26
2025-03-09 07:14:26,732 [INFO]: 954.9MB of memory will be needed to build the index (more might be used if you have more)
2025-03-09 07:14:26,732 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0004 secs
2025-03-09 07:14:26,732 [INFO]: 	Selecting most promising index types given data characteristics 03/09/2025, 07:14:26
2025-03-09 07:14:26,732 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-09 07:14:26,733 [INFO]: 	Creating the index 03/09/2025, 07:14:26
2025-03-09 07:14:26,733 [INFO]: 		-> Instanciate the index HNSW15 03/09/2025, 07:14:26
2025-03-09 07:14:26,735 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0019 secs
2025-03-09 07:14:26,735 [INFO]: 		-> Adding the vectors to the index 03/09/2025, 07:14:26
2025-03-09 07:14:26,735 [INFO]: The memory available for adding the vectors is 49.2GB(total available - used by the index)
2025-03-09 07:14:26,735 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/19 [00:00<?, ?it/s]  5%|▌         | 1/19 [00:00<00:02,  8.28it/s] 32%|███▏      | 6/19 [00:00<00:00, 30.79it/s] 58%|█████▊    | 11/19 [00:00<00:00, 39.01it/s] 84%|████████▍ | 16/19 [00:00<00:00, 37.50it/s]100%|██████████| 19/19 [00:04<00:00,  4.37it/s]
2025-03-09 07:14:31,087 [INFO]: 	Computing best hyperparameters for index knn.index 03/09/2025, 07:14:31
2025-03-09 07:15:12,895 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 41.8077 secs
2025-03-09 07:15:12,895 [INFO]: The best hyperparameters are: efSearch=199
2025-03-09 07:15:12,895 [INFO]: 	Compute fast metrics 03/09/2025, 07:15:12
  0%|          | 0/4 [00:00<?, ?it/s] 75%|███████▌  | 3/4 [00:00<00:00, 27.80it/s] 75%|███████▌  | 3/4 [00:00<00:00, 23.57it/s]
2025-03-09 07:15:25,191 [INFO]: 	>>> Finished "Compute fast metrics" in 12.2959 secs
2025-03-09 07:15:25,194 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 58.4586 secs
2025-03-09 07:15:25,194 [INFO]: {
2025-03-09 07:15:25,194 [INFO]: 	index_key: HNSW15
2025-03-09 07:15:25,194 [INFO]: 	index_param: efSearch=199
2025-03-09 07:15:25,194 [INFO]: 	index_path: knn.index
2025-03-09 07:15:25,194 [INFO]: 	size in bytes: 910334350
2025-03-09 07:15:25,194 [INFO]: 	avg_search_speed_ms: 10.485641367938271
2025-03-09 07:15:25,194 [INFO]: 	99p_search_speed_ms: 22.497265944257393
2025-03-09 07:15:25,194 [INFO]: 	reconstruction error %: 0.0
2025-03-09 07:15:25,194 [INFO]: 	nb vectors: 4627
2025-03-09 07:15:25,194 [INFO]: 	vectors dimension: 49152
2025-03-09 07:15:25,194 [INFO]: 	compression ratio: 0.9993088978791144
2025-03-09 07:15:25,194 [INFO]: }
2025-03-09 07:15:25,194 [INFO]: 	>>> Finished "Creating the index" in 58.4613 secs
2025-03-09 07:15:25,194 [INFO]: >>> Finished "Launching the whole pipeline" in 58.5047 secs
2025-03-09 07:15:26: [retrieval_preprocessing] calculating distances ...
2025-03-09 07:15:27: [retrieval_preprocessing] finished and saved retrieval indices for episode 83219 [episode count 6/20]
[retrieval_preprocessing] for episode 33300 [episode count 7/20], we have num_retrieval=np.int64(4376) num_query=np.int64(440)
2025-03-09 07:15:27,396 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-09 07:15:27,967 [INFO]: Launching the whole pipeline 03/09/2025, 07:15:27
2025-03-09 07:15:27,968 [INFO]: Reading total number of vectors and dimension 03/09/2025, 07:15:27
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1452.32it/s]
2025-03-09 07:15:27,996 [INFO]: There are 4376 embeddings of dim 49152
2025-03-09 07:15:27,997 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0291 secs
2025-03-09 07:15:27,997 [INFO]: 	Compute estimated construction time of the index 03/09/2025, 07:15:27
2025-03-09 07:15:27,997 [INFO]: 		-> Train: 16.7 minutes
2025-03-09 07:15:27,997 [INFO]: 		-> Add: 2.4 seconds
2025-03-09 07:15:27,997 [INFO]: 		Total: 16.7 minutes
2025-03-09 07:15:27,997 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0001 secs
2025-03-09 07:15:27,997 [INFO]: 	Checking that your have enough memory available to create the index 03/09/2025, 07:15:27
2025-03-09 07:15:27,997 [INFO]: 903.1MB of memory will be needed to build the index (more might be used if you have more)
2025-03-09 07:15:27,997 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0001 secs
2025-03-09 07:15:27,997 [INFO]: 	Selecting most promising index types given data characteristics 03/09/2025, 07:15:27
2025-03-09 07:15:27,997 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-09 07:15:27,997 [INFO]: 	Creating the index 03/09/2025, 07:15:27
2025-03-09 07:15:27,997 [INFO]: 		-> Instanciate the index HNSW15 03/09/2025, 07:15:27
2025-03-09 07:15:27,998 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0010 secs
2025-03-09 07:15:27,998 [INFO]: 		-> Adding the vectors to the index 03/09/2025, 07:15:27
2025-03-09 07:15:27,998 [INFO]: The memory available for adding the vectors is 49.2GB(total available - used by the index)
2025-03-09 07:15:27,998 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/18 [00:00<?, ?it/s]  6%|▌         | 1/18 [00:00<00:01,  9.76it/s] 28%|██▊       | 5/18 [00:00<00:00, 25.85it/s] 56%|█████▌    | 10/18 [00:00<00:00, 35.97it/s] 83%|████████▎ | 15/18 [00:00<00:00, 41.14it/s]100%|██████████| 18/18 [00:03<00:00,  4.82it/s]
2025-03-09 07:15:31,738 [INFO]: 	Computing best hyperparameters for index knn.index 03/09/2025, 07:15:31
2025-03-09 07:16:12,777 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 41.0394 secs
2025-03-09 07:16:12,777 [INFO]: The best hyperparameters are: efSearch=179
2025-03-09 07:16:12,778 [INFO]: 	Compute fast metrics 03/09/2025, 07:16:12
  0%|          | 0/4 [00:00<?, ?it/s] 75%|███████▌  | 3/4 [00:00<00:00, 26.31it/s] 75%|███████▌  | 3/4 [00:00<00:00, 22.46it/s]
2025-03-09 07:16:25,679 [INFO]: 	>>> Finished "Compute fast metrics" in 12.9017 secs
2025-03-09 07:16:25,682 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 57.6834 secs
2025-03-09 07:16:25,682 [INFO]: {
2025-03-09 07:16:25,682 [INFO]: 	index_key: HNSW15
2025-03-09 07:16:25,682 [INFO]: 	index_param: efSearch=179
2025-03-09 07:16:25,682 [INFO]: 	index_path: knn.index
2025-03-09 07:16:25,682 [INFO]: 	size in bytes: 860951890
2025-03-09 07:16:25,682 [INFO]: 	avg_search_speed_ms: 8.953683880793935
2025-03-09 07:16:25,682 [INFO]: 	99p_search_speed_ms: 18.39180123992263
2025-03-09 07:16:25,682 [INFO]: 	reconstruction error %: 0.0
2025-03-09 07:16:25,682 [INFO]: 	nb vectors: 4376
2025-03-09 07:16:25,682 [INFO]: 	vectors dimension: 49152
2025-03-09 07:16:25,682 [INFO]: 	compression ratio: 0.9993085769287294
2025-03-09 07:16:25,682 [INFO]: }
2025-03-09 07:16:25,682 [INFO]: 	>>> Finished "Creating the index" in 57.6849 secs
2025-03-09 07:16:25,682 [INFO]: >>> Finished "Launching the whole pipeline" in 57.7145 secs
2025-03-09 07:16:27: [retrieval_preprocessing] calculating distances ...
2025-03-09 07:16:29: [retrieval_preprocessing] finished and saved retrieval indices for episode 33300 [episode count 7/20]
[retrieval_preprocessing] for episode 88083 [episode count 8/20], we have num_retrieval=np.int64(4632) num_query=np.int64(184)
2025-03-09 07:16:29,893 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-09 07:16:30,514 [INFO]: Launching the whole pipeline 03/09/2025, 07:16:30
2025-03-09 07:16:30,514 [INFO]: Reading total number of vectors and dimension 03/09/2025, 07:16:30
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 2138.86it/s]
2025-03-09 07:16:30,543 [INFO]: There are 4632 embeddings of dim 49152
2025-03-09 07:16:30,543 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0286 secs
2025-03-09 07:16:30,543 [INFO]: 	Compute estimated construction time of the index 03/09/2025, 07:16:30
2025-03-09 07:16:30,543 [INFO]: 		-> Train: 16.7 minutes
2025-03-09 07:16:30,543 [INFO]: 		-> Add: 2.5 seconds
2025-03-09 07:16:30,543 [INFO]: 		Total: 16.7 minutes
2025-03-09 07:16:30,543 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0001 secs
2025-03-09 07:16:30,543 [INFO]: 	Checking that your have enough memory available to create the index 03/09/2025, 07:16:30
2025-03-09 07:16:30,543 [INFO]: 955.9MB of memory will be needed to build the index (more might be used if you have more)
2025-03-09 07:16:30,543 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0001 secs
2025-03-09 07:16:30,543 [INFO]: 	Selecting most promising index types given data characteristics 03/09/2025, 07:16:30
2025-03-09 07:16:30,543 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-09 07:16:30,543 [INFO]: 	Creating the index 03/09/2025, 07:16:30
2025-03-09 07:16:30,543 [INFO]: 		-> Instanciate the index HNSW15 03/09/2025, 07:16:30
2025-03-09 07:16:30,544 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0009 secs
2025-03-09 07:16:30,544 [INFO]: 		-> Adding the vectors to the index 03/09/2025, 07:16:30
2025-03-09 07:16:30,545 [INFO]: The memory available for adding the vectors is 49.2GB(total available - used by the index)
2025-03-09 07:16:30,545 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/19 [00:00<?, ?it/s]  5%|▌         | 1/19 [00:00<00:02,  8.77it/s] 32%|███▏      | 6/19 [00:00<00:00, 27.58it/s] 58%|█████▊    | 11/19 [00:00<00:00, 36.60it/s] 89%|████████▉ | 17/19 [00:00<00:00, 43.33it/s]100%|██████████| 19/19 [00:03<00:00,  4.77it/s]
2025-03-09 07:16:34,530 [INFO]: 	Computing best hyperparameters for index knn.index 03/09/2025, 07:16:34
2025-03-09 07:17:17,844 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 43.3132 secs
2025-03-09 07:17:17,844 [INFO]: The best hyperparameters are: efSearch=139
2025-03-09 07:17:17,844 [INFO]: 	Compute fast metrics 03/09/2025, 07:17:17
  0%|          | 0/4 [00:00<?, ?it/s] 50%|█████     | 2/4 [00:00<00:00, 19.58it/s] 75%|███████▌  | 3/4 [00:00<00:00, 21.49it/s]
2025-03-09 07:17:32,480 [INFO]: 	>>> Finished "Compute fast metrics" in 14.6360 secs
2025-03-09 07:17:32,483 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 61.9380 secs
2025-03-09 07:17:32,483 [INFO]: {
2025-03-09 07:17:32,483 [INFO]: 	index_key: HNSW15
2025-03-09 07:17:32,483 [INFO]: 	index_param: efSearch=139
2025-03-09 07:17:32,483 [INFO]: 	index_path: knn.index
2025-03-09 07:17:32,483 [INFO]: 	size in bytes: 911318110
2025-03-09 07:17:32,483 [INFO]: 	avg_search_speed_ms: 7.4291945782192075
2025-03-09 07:17:32,483 [INFO]: 	99p_search_speed_ms: 17.950072763487672
2025-03-09 07:17:32,483 [INFO]: 	reconstruction error %: 0.0
2025-03-09 07:17:32,483 [INFO]: 	nb vectors: 4632
2025-03-09 07:17:32,483 [INFO]: 	vectors dimension: 49152
2025-03-09 07:17:32,483 [INFO]: 	compression ratio: 0.9993088538534585
2025-03-09 07:17:32,483 [INFO]: }
2025-03-09 07:17:32,483 [INFO]: 	>>> Finished "Creating the index" in 61.9394 secs
2025-03-09 07:17:32,483 [INFO]: >>> Finished "Launching the whole pipeline" in 61.9685 secs
2025-03-09 07:17:33: [retrieval_preprocessing] calculating distances ...
2025-03-09 07:17:33: [retrieval_preprocessing] finished and saved retrieval indices for episode 88083 [episode count 8/20]
[retrieval_preprocessing] for episode 1430 [episode count 9/20], we have num_retrieval=np.int64(4700) num_query=np.int64(116)
2025-03-09 07:17:33,966 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-09 07:17:34,633 [INFO]: Launching the whole pipeline 03/09/2025, 07:17:34
2025-03-09 07:17:34,633 [INFO]: Reading total number of vectors and dimension 03/09/2025, 07:17:34
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1452.82it/s]
2025-03-09 07:17:34,660 [INFO]: There are 4700 embeddings of dim 49152
2025-03-09 07:17:34,660 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0268 secs
2025-03-09 07:17:34,660 [INFO]: 	Compute estimated construction time of the index 03/09/2025, 07:17:34
2025-03-09 07:17:34,660 [INFO]: 		-> Train: 16.7 minutes
2025-03-09 07:17:34,660 [INFO]: 		-> Add: 2.6 seconds
2025-03-09 07:17:34,660 [INFO]: 		Total: 16.7 minutes
2025-03-09 07:17:34,660 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0001 secs
2025-03-09 07:17:34,660 [INFO]: 	Checking that your have enough memory available to create the index 03/09/2025, 07:17:34
2025-03-09 07:17:34,660 [INFO]: 970.0MB of memory will be needed to build the index (more might be used if you have more)
2025-03-09 07:17:34,660 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0001 secs
2025-03-09 07:17:34,660 [INFO]: 	Selecting most promising index types given data characteristics 03/09/2025, 07:17:34
2025-03-09 07:17:34,660 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-09 07:17:34,660 [INFO]: 	Creating the index 03/09/2025, 07:17:34
2025-03-09 07:17:34,660 [INFO]: 		-> Instanciate the index HNSW15 03/09/2025, 07:17:34
2025-03-09 07:17:34,661 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0009 secs
2025-03-09 07:17:34,661 [INFO]: 		-> Adding the vectors to the index 03/09/2025, 07:17:34
2025-03-09 07:17:34,661 [INFO]: The memory available for adding the vectors is 49.1GB(total available - used by the index)
2025-03-09 07:17:34,662 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/19 [00:00<?, ?it/s]  5%|▌         | 1/19 [00:00<00:01,  9.21it/s] 32%|███▏      | 6/19 [00:00<00:00, 31.72it/s] 63%|██████▎   | 12/19 [00:00<00:00, 40.86it/s] 89%|████████▉ | 17/19 [00:00<00:00, 40.69it/s]100%|██████████| 19/19 [00:04<00:00,  4.41it/s]
2025-03-09 07:17:38,975 [INFO]: 	Computing best hyperparameters for index knn.index 03/09/2025, 07:17:38
2025-03-09 07:18:20,010 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 41.0342 secs
2025-03-09 07:18:20,010 [INFO]: The best hyperparameters are: efSearch=197
2025-03-09 07:18:20,010 [INFO]: 	Compute fast metrics 03/09/2025, 07:18:20
  0%|          | 0/4 [00:00<?, ?it/s] 25%|██▌       | 1/4 [00:00<00:00,  8.99it/s] 75%|███████▌  | 3/4 [00:00<00:00, 13.93it/s]
2025-03-09 07:18:32,625 [INFO]: 	>>> Finished "Compute fast metrics" in 12.6146 secs
2025-03-09 07:18:32,627 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 57.9657 secs
2025-03-09 07:18:32,627 [INFO]: {
2025-03-09 07:18:32,627 [INFO]: 	index_key: HNSW15
2025-03-09 07:18:32,627 [INFO]: 	index_param: efSearch=197
2025-03-09 07:18:32,627 [INFO]: 	index_path: knn.index
2025-03-09 07:18:32,627 [INFO]: 	size in bytes: 924696850
2025-03-09 07:18:32,627 [INFO]: 	avg_search_speed_ms: 10.63143750321116
2025-03-09 07:18:32,627 [INFO]: 	99p_search_speed_ms: 26.441405573859814
2025-03-09 07:18:32,627 [INFO]: 	reconstruction error %: 0.0
2025-03-09 07:18:32,627 [INFO]: 	nb vectors: 4700
2025-03-09 07:18:32,627 [INFO]: 	vectors dimension: 49152
2025-03-09 07:18:32,627 [INFO]: 	compression ratio: 0.9993086923568518
2025-03-09 07:18:32,628 [INFO]: }
2025-03-09 07:18:32,628 [INFO]: 	>>> Finished "Creating the index" in 57.9671 secs
2025-03-09 07:18:32,628 [INFO]: >>> Finished "Launching the whole pipeline" in 57.9945 secs
2025-03-09 07:18:33: [retrieval_preprocessing] calculating distances ...
2025-03-09 07:18:33: [retrieval_preprocessing] finished and saved retrieval indices for episode 1430 [episode count 9/20]
[retrieval_preprocessing] for episode 57753 [episode count 10/20], we have num_retrieval=np.int64(4651) num_query=np.int64(165)
2025-03-09 07:18:34,255 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-09 07:18:34,981 [INFO]: Launching the whole pipeline 03/09/2025, 07:18:34
2025-03-09 07:18:34,981 [INFO]: Reading total number of vectors and dimension 03/09/2025, 07:18:34
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1514.74it/s]
2025-03-09 07:18:35,012 [INFO]: There are 4651 embeddings of dim 49152
2025-03-09 07:18:35,012 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0306 secs
2025-03-09 07:18:35,012 [INFO]: 	Compute estimated construction time of the index 03/09/2025, 07:18:35
2025-03-09 07:18:35,012 [INFO]: 		-> Train: 16.7 minutes
2025-03-09 07:18:35,012 [INFO]: 		-> Add: 2.6 seconds
2025-03-09 07:18:35,012 [INFO]: 		Total: 16.7 minutes
2025-03-09 07:18:35,012 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0001 secs
2025-03-09 07:18:35,012 [INFO]: 	Checking that your have enough memory available to create the index 03/09/2025, 07:18:35
2025-03-09 07:18:35,012 [INFO]: 959.9MB of memory will be needed to build the index (more might be used if you have more)
2025-03-09 07:18:35,012 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0001 secs
2025-03-09 07:18:35,012 [INFO]: 	Selecting most promising index types given data characteristics 03/09/2025, 07:18:35
2025-03-09 07:18:35,012 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-09 07:18:35,012 [INFO]: 	Creating the index 03/09/2025, 07:18:35
2025-03-09 07:18:35,012 [INFO]: 		-> Instanciate the index HNSW15 03/09/2025, 07:18:35
2025-03-09 07:18:35,013 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0009 secs
2025-03-09 07:18:35,013 [INFO]: 		-> Adding the vectors to the index 03/09/2025, 07:18:35
2025-03-09 07:18:35,013 [INFO]: The memory available for adding the vectors is 49.1GB(total available - used by the index)
2025-03-09 07:18:35,014 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/19 [00:00<?, ?it/s]  5%|▌         | 1/19 [00:00<00:01,  9.33it/s] 26%|██▋       | 5/19 [00:00<00:00, 25.36it/s] 53%|█████▎    | 10/19 [00:00<00:00, 33.16it/s] 74%|███████▎  | 14/19 [00:00<00:00, 32.73it/s]100%|██████████| 19/19 [00:04<00:00,  2.93it/s]100%|██████████| 19/19 [00:04<00:00,  4.42it/s]
2025-03-09 07:18:39,318 [INFO]: 	Computing best hyperparameters for index knn.index 03/09/2025, 07:18:39
2025-03-09 07:19:20,143 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 40.8242 secs
2025-03-09 07:19:20,143 [INFO]: The best hyperparameters are: efSearch=154
2025-03-09 07:19:20,143 [INFO]: 	Compute fast metrics 03/09/2025, 07:19:20
  0%|          | 0/4 [00:00<?, ?it/s] 50%|█████     | 2/4 [00:00<00:00, 18.66it/s] 75%|███████▌  | 3/4 [00:00<00:00, 20.63it/s]
2025-03-09 07:19:34,531 [INFO]: 	>>> Finished "Compute fast metrics" in 14.3880 secs
2025-03-09 07:19:34,534 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 59.5202 secs
2025-03-09 07:19:34,534 [INFO]: {
2025-03-09 07:19:34,534 [INFO]: 	index_key: HNSW15
2025-03-09 07:19:34,534 [INFO]: 	index_param: efSearch=154
2025-03-09 07:19:34,534 [INFO]: 	index_path: knn.index
2025-03-09 07:19:34,534 [INFO]: 	size in bytes: 915056290
2025-03-09 07:19:34,534 [INFO]: 	avg_search_speed_ms: 9.297308626499886
2025-03-09 07:19:34,534 [INFO]: 	99p_search_speed_ms: 18.77879025414586
2025-03-09 07:19:34,534 [INFO]: 	reconstruction error %: 0.0
2025-03-09 07:19:34,534 [INFO]: 	nb vectors: 4651
2025-03-09 07:19:34,534 [INFO]: 	vectors dimension: 49152
2025-03-09 07:19:34,534 [INFO]: 	compression ratio: 0.9993088053632198
2025-03-09 07:19:34,534 [INFO]: }
2025-03-09 07:19:34,534 [INFO]: 	>>> Finished "Creating the index" in 59.5216 secs
2025-03-09 07:19:34,534 [INFO]: >>> Finished "Launching the whole pipeline" in 59.5528 secs
2025-03-09 07:19:35: [retrieval_preprocessing] calculating distances ...
2025-03-09 07:19:35: [retrieval_preprocessing] finished and saved retrieval indices for episode 57753 [episode count 10/20]
[retrieval_preprocessing] for episode 79897 [episode count 11/20], we have num_retrieval=np.int64(4711) num_query=np.int64(105)
2025-03-09 07:19:36,144 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-09 07:19:36,767 [INFO]: Launching the whole pipeline 03/09/2025, 07:19:36
2025-03-09 07:19:36,767 [INFO]: Reading total number of vectors and dimension 03/09/2025, 07:19:36
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1175.20it/s]
2025-03-09 07:19:36,796 [INFO]: There are 4711 embeddings of dim 49152
2025-03-09 07:19:36,797 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0295 secs
2025-03-09 07:19:36,797 [INFO]: 	Compute estimated construction time of the index 03/09/2025, 07:19:36
2025-03-09 07:19:36,797 [INFO]: 		-> Train: 16.7 minutes
2025-03-09 07:19:36,797 [INFO]: 		-> Add: 2.6 seconds
2025-03-09 07:19:36,797 [INFO]: 		Total: 16.7 minutes
2025-03-09 07:19:36,797 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0001 secs
2025-03-09 07:19:36,797 [INFO]: 	Checking that your have enough memory available to create the index 03/09/2025, 07:19:36
2025-03-09 07:19:36,797 [INFO]: 972.2MB of memory will be needed to build the index (more might be used if you have more)
2025-03-09 07:19:36,797 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0001 secs
2025-03-09 07:19:36,797 [INFO]: 	Selecting most promising index types given data characteristics 03/09/2025, 07:19:36
2025-03-09 07:19:36,797 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-09 07:19:36,797 [INFO]: 	Creating the index 03/09/2025, 07:19:36
2025-03-09 07:19:36,797 [INFO]: 		-> Instanciate the index HNSW15 03/09/2025, 07:19:36
2025-03-09 07:19:36,798 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0010 secs
2025-03-09 07:19:36,798 [INFO]: 		-> Adding the vectors to the index 03/09/2025, 07:19:36
2025-03-09 07:19:36,798 [INFO]: The memory available for adding the vectors is 49.1GB(total available - used by the index)
2025-03-09 07:19:36,798 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/19 [00:00<?, ?it/s]  5%|▌         | 1/19 [00:00<00:02,  6.16it/s] 37%|███▋      | 7/19 [00:00<00:00, 29.28it/s] 68%|██████▊   | 13/19 [00:00<00:00, 39.11it/s]100%|██████████| 19/19 [00:04<00:00,  3.24it/s]100%|██████████| 19/19 [00:04<00:00,  4.35it/s]
2025-03-09 07:19:41,166 [INFO]: 	Computing best hyperparameters for index knn.index 03/09/2025, 07:19:41
2025-03-09 07:20:23,498 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 42.3312 secs
2025-03-09 07:20:23,498 [INFO]: The best hyperparameters are: efSearch=216
2025-03-09 07:20:23,498 [INFO]: 	Compute fast metrics 03/09/2025, 07:20:23
  0%|          | 0/4 [00:00<?, ?it/s] 50%|█████     | 2/4 [00:00<00:00, 18.90it/s] 75%|███████▌  | 3/4 [00:00<00:00, 20.21it/s]
2025-03-09 07:20:37,191 [INFO]: 	>>> Finished "Compute fast metrics" in 13.6932 secs
2025-03-09 07:20:37,194 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 60.3955 secs
2025-03-09 07:20:37,194 [INFO]: {
2025-03-09 07:20:37,194 [INFO]: 	index_key: HNSW15
2025-03-09 07:20:37,194 [INFO]: 	index_param: efSearch=216
2025-03-09 07:20:37,194 [INFO]: 	index_path: knn.index
2025-03-09 07:20:37,194 [INFO]: 	size in bytes: 926861110
2025-03-09 07:20:37,194 [INFO]: 	avg_search_speed_ms: 10.599909491108935
2025-03-09 07:20:37,194 [INFO]: 	99p_search_speed_ms: 23.956321205478126
2025-03-09 07:20:37,194 [INFO]: 	reconstruction error %: 0.0
2025-03-09 07:20:37,194 [INFO]: 	nb vectors: 4711
2025-03-09 07:20:37,194 [INFO]: 	vectors dimension: 49152
2025-03-09 07:20:37,194 [INFO]: 	compression ratio: 0.9993086105425224
2025-03-09 07:20:37,194 [INFO]: }
2025-03-09 07:20:37,194 [INFO]: 	>>> Finished "Creating the index" in 60.3969 secs
2025-03-09 07:20:37,194 [INFO]: >>> Finished "Launching the whole pipeline" in 60.4270 secs
2025-03-09 07:20:38: [retrieval_preprocessing] calculating distances ...
2025-03-09 07:20:38: [retrieval_preprocessing] finished and saved retrieval indices for episode 79897 [episode count 11/20]
[retrieval_preprocessing] for episode 2592 [episode count 12/20], we have num_retrieval=np.int64(4669) num_query=np.int64(147)
2025-03-09 07:20:38,947 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-09 07:20:39,662 [INFO]: Launching the whole pipeline 03/09/2025, 07:20:39
2025-03-09 07:20:39,663 [INFO]: Reading total number of vectors and dimension 03/09/2025, 07:20:39
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1783.29it/s]
2025-03-09 07:20:39,690 [INFO]: There are 4669 embeddings of dim 49152
2025-03-09 07:20:39,690 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0279 secs
2025-03-09 07:20:39,691 [INFO]: 	Compute estimated construction time of the index 03/09/2025, 07:20:39
2025-03-09 07:20:39,691 [INFO]: 		-> Train: 16.7 minutes
2025-03-09 07:20:39,691 [INFO]: 		-> Add: 2.6 seconds
2025-03-09 07:20:39,691 [INFO]: 		Total: 16.7 minutes
2025-03-09 07:20:39,691 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0001 secs
2025-03-09 07:20:39,691 [INFO]: 	Checking that your have enough memory available to create the index 03/09/2025, 07:20:39
2025-03-09 07:20:39,691 [INFO]: 963.6MB of memory will be needed to build the index (more might be used if you have more)
2025-03-09 07:20:39,691 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0003 secs
2025-03-09 07:20:39,691 [INFO]: 	Selecting most promising index types given data characteristics 03/09/2025, 07:20:39
2025-03-09 07:20:39,691 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-09 07:20:39,691 [INFO]: 	Creating the index 03/09/2025, 07:20:39
2025-03-09 07:20:39,691 [INFO]: 		-> Instanciate the index HNSW15 03/09/2025, 07:20:39
2025-03-09 07:20:39,692 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0009 secs
2025-03-09 07:20:39,692 [INFO]: 		-> Adding the vectors to the index 03/09/2025, 07:20:39
2025-03-09 07:20:39,692 [INFO]: The memory available for adding the vectors is 49.1GB(total available - used by the index)
2025-03-09 07:20:39,692 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/19 [00:00<?, ?it/s]  5%|▌         | 1/19 [00:00<00:01,  9.70it/s] 26%|██▋       | 5/19 [00:00<00:00, 26.38it/s] 53%|█████▎    | 10/19 [00:00<00:00, 36.37it/s] 84%|████████▍ | 16/19 [00:00<00:00, 42.46it/s]100%|██████████| 19/19 [00:04<00:00,  4.36it/s]
2025-03-09 07:20:44,052 [INFO]: 	Computing best hyperparameters for index knn.index 03/09/2025, 07:20:44
2025-03-09 07:21:29,272 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 45.2202 secs
2025-03-09 07:21:29,273 [INFO]: The best hyperparameters are: efSearch=161
2025-03-09 07:21:29,273 [INFO]: 	Compute fast metrics 03/09/2025, 07:21:29
  0%|          | 0/4 [00:00<?, ?it/s] 75%|███████▌  | 3/4 [00:00<00:00, 24.88it/s] 75%|███████▌  | 3/4 [00:00<00:00, 20.99it/s]
2025-03-09 07:21:41,849 [INFO]: 	>>> Finished "Compute fast metrics" in 12.5760 secs
2025-03-09 07:21:41,852 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 62.1595 secs
2025-03-09 07:21:41,852 [INFO]: {
2025-03-09 07:21:41,852 [INFO]: 	index_key: HNSW15
2025-03-09 07:21:41,852 [INFO]: 	index_param: efSearch=161
2025-03-09 07:21:41,852 [INFO]: 	index_path: knn.index
2025-03-09 07:21:41,852 [INFO]: 	size in bytes: 918597730
2025-03-09 07:21:41,852 [INFO]: 	avg_search_speed_ms: 8.915346369202084
2025-03-09 07:21:41,852 [INFO]: 	99p_search_speed_ms: 20.255677385721356
2025-03-09 07:21:41,852 [INFO]: 	reconstruction error %: 0.0
2025-03-09 07:21:41,852 [INFO]: 	nb vectors: 4669
2025-03-09 07:21:41,852 [INFO]: 	vectors dimension: 49152
2025-03-09 07:21:41,852 [INFO]: 	compression ratio: 0.9993087529184292
2025-03-09 07:21:41,852 [INFO]: }
2025-03-09 07:21:41,852 [INFO]: 	>>> Finished "Creating the index" in 62.1610 secs
2025-03-09 07:21:41,852 [INFO]: >>> Finished "Launching the whole pipeline" in 62.1896 secs
2025-03-09 07:21:42: [retrieval_preprocessing] calculating distances ...
2025-03-09 07:21:42: [retrieval_preprocessing] finished and saved retrieval indices for episode 2592 [episode count 12/20]
[retrieval_preprocessing] for episode 59681 [episode count 13/20], we have num_retrieval=np.int64(4396) num_query=np.int64(420)
2025-03-09 07:21:43,321 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-09 07:21:43,826 [INFO]: Launching the whole pipeline 03/09/2025, 07:21:43
2025-03-09 07:21:43,826 [INFO]: Reading total number of vectors and dimension 03/09/2025, 07:21:43
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1210.48it/s]
2025-03-09 07:21:43,858 [INFO]: There are 4396 embeddings of dim 49152
2025-03-09 07:21:43,858 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0315 secs
2025-03-09 07:21:43,858 [INFO]: 	Compute estimated construction time of the index 03/09/2025, 07:21:43
2025-03-09 07:21:43,858 [INFO]: 		-> Train: 16.7 minutes
2025-03-09 07:21:43,858 [INFO]: 		-> Add: 2.4 seconds
2025-03-09 07:21:43,859 [INFO]: 		Total: 16.7 minutes
2025-03-09 07:21:43,859 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0004 secs
2025-03-09 07:21:43,859 [INFO]: 	Checking that your have enough memory available to create the index 03/09/2025, 07:21:43
2025-03-09 07:21:43,859 [INFO]: 907.2MB of memory will be needed to build the index (more might be used if you have more)
2025-03-09 07:21:43,859 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0005 secs
2025-03-09 07:21:43,859 [INFO]: 	Selecting most promising index types given data characteristics 03/09/2025, 07:21:43
2025-03-09 07:21:43,860 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-09 07:21:43,860 [INFO]: 	Creating the index 03/09/2025, 07:21:43
2025-03-09 07:21:43,860 [INFO]: 		-> Instanciate the index HNSW15 03/09/2025, 07:21:43
2025-03-09 07:21:43,863 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0028 secs
2025-03-09 07:21:43,863 [INFO]: 		-> Adding the vectors to the index 03/09/2025, 07:21:43
2025-03-09 07:21:43,863 [INFO]: The memory available for adding the vectors is 49.2GB(total available - used by the index)
2025-03-09 07:21:43,864 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/18 [00:00<?, ?it/s] 17%|█▋        | 3/18 [00:00<00:00, 28.47it/s] 56%|█████▌    | 10/18 [00:00<00:00, 47.49it/s] 83%|████████▎ | 15/18 [00:00<00:00, 45.44it/s]100%|██████████| 18/18 [00:03<00:00,  5.20it/s]
2025-03-09 07:21:47,332 [INFO]: 	Computing best hyperparameters for index knn.index 03/09/2025, 07:21:47
2025-03-09 07:22:28,169 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 40.8365 secs
2025-03-09 07:22:28,169 [INFO]: The best hyperparameters are: efSearch=205
2025-03-09 07:22:28,169 [INFO]: 	Compute fast metrics 03/09/2025, 07:22:28
  0%|          | 0/4 [00:00<?, ?it/s] 50%|█████     | 2/4 [00:00<00:00, 18.41it/s] 75%|███████▌  | 3/4 [00:00<00:00, 19.24it/s]
2025-03-09 07:22:42,919 [INFO]: 	>>> Finished "Compute fast metrics" in 14.7498 secs
2025-03-09 07:22:42,924 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 59.0603 secs
2025-03-09 07:22:42,924 [INFO]: {
2025-03-09 07:22:42,924 [INFO]: 	index_key: HNSW15
2025-03-09 07:22:42,924 [INFO]: 	index_param: efSearch=205
2025-03-09 07:22:42,924 [INFO]: 	index_path: knn.index
2025-03-09 07:22:42,924 [INFO]: 	size in bytes: 864886690
2025-03-09 07:22:42,924 [INFO]: 	avg_search_speed_ms: 10.85845990446871
2025-03-09 07:22:42,924 [INFO]: 	99p_search_speed_ms: 22.469364267308254
2025-03-09 07:22:42,924 [INFO]: 	reconstruction error %: 0.0
2025-03-09 07:22:42,924 [INFO]: 	nb vectors: 4396
2025-03-09 07:22:42,924 [INFO]: 	vectors dimension: 49152
2025-03-09 07:22:42,924 [INFO]: 	compression ratio: 0.9993086701334252
2025-03-09 07:22:42,924 [INFO]: }
2025-03-09 07:22:42,924 [INFO]: 	>>> Finished "Creating the index" in 59.0642 secs
2025-03-09 07:22:42,924 [INFO]: >>> Finished "Launching the whole pipeline" in 59.0975 secs
2025-03-09 07:22:45: [retrieval_preprocessing] calculating distances ...
2025-03-09 07:22:46: [retrieval_preprocessing] finished and saved retrieval indices for episode 59681 [episode count 13/20]
[retrieval_preprocessing] for episode 84005 [episode count 14/20], we have num_retrieval=np.int64(4606) num_query=np.int64(210)
2025-03-09 07:22:47,358 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-09 07:22:48,003 [INFO]: Launching the whole pipeline 03/09/2025, 07:22:48
2025-03-09 07:22:48,003 [INFO]: Reading total number of vectors and dimension 03/09/2025, 07:22:48
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 2632.96it/s]
2025-03-09 07:22:48,030 [INFO]: There are 4606 embeddings of dim 49152
2025-03-09 07:22:48,030 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0269 secs
2025-03-09 07:22:48,030 [INFO]: 	Compute estimated construction time of the index 03/09/2025, 07:22:48
2025-03-09 07:22:48,031 [INFO]: 		-> Train: 16.7 minutes
2025-03-09 07:22:48,031 [INFO]: 		-> Add: 2.5 seconds
2025-03-09 07:22:48,031 [INFO]: 		Total: 16.7 minutes
2025-03-09 07:22:48,031 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0001 secs
2025-03-09 07:22:48,031 [INFO]: 	Checking that your have enough memory available to create the index 03/09/2025, 07:22:48
2025-03-09 07:22:48,031 [INFO]: 950.6MB of memory will be needed to build the index (more might be used if you have more)
2025-03-09 07:22:48,031 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0002 secs
2025-03-09 07:22:48,031 [INFO]: 	Selecting most promising index types given data characteristics 03/09/2025, 07:22:48
2025-03-09 07:22:48,031 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-09 07:22:48,031 [INFO]: 	Creating the index 03/09/2025, 07:22:48
2025-03-09 07:22:48,031 [INFO]: 		-> Instanciate the index HNSW15 03/09/2025, 07:22:48
2025-03-09 07:22:48,032 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0011 secs
2025-03-09 07:22:48,032 [INFO]: 		-> Adding the vectors to the index 03/09/2025, 07:22:48
2025-03-09 07:22:48,032 [INFO]: The memory available for adding the vectors is 49.2GB(total available - used by the index)
2025-03-09 07:22:48,032 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/19 [00:00<?, ?it/s]  5%|▌         | 1/19 [00:00<00:02,  7.73it/s] 37%|███▋      | 7/19 [00:00<00:00, 33.07it/s] 68%|██████▊   | 13/19 [00:00<00:00, 42.72it/s] 95%|█████████▍| 18/19 [00:00<00:00, 44.53it/s]100%|██████████| 19/19 [00:04<00:00,  4.03it/s]
2025-03-09 07:22:52,746 [INFO]: 	Computing best hyperparameters for index knn.index 03/09/2025, 07:22:52
2025-03-09 07:23:34,949 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 42.2031 secs
2025-03-09 07:23:34,949 [INFO]: The best hyperparameters are: efSearch=162
2025-03-09 07:23:34,949 [INFO]: 	Compute fast metrics 03/09/2025, 07:23:34
  0%|          | 0/4 [00:00<?, ?it/s] 25%|██▌       | 1/4 [00:00<00:02,  1.29it/s] 50%|█████     | 2/4 [00:01<00:01,  1.16it/s] 75%|███████▌  | 3/4 [00:02<00:00,  1.10it/s] 75%|███████▌  | 3/4 [00:03<00:01,  1.03s/it]
2025-03-09 07:23:50,305 [INFO]: 	>>> Finished "Compute fast metrics" in 15.3553 secs
2025-03-09 07:23:50,308 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 62.2754 secs
2025-03-09 07:23:50,308 [INFO]: {
2025-03-09 07:23:50,308 [INFO]: 	index_key: HNSW15
2025-03-09 07:23:50,308 [INFO]: 	index_param: efSearch=162
2025-03-09 07:23:50,308 [INFO]: 	index_path: knn.index
2025-03-09 07:23:50,308 [INFO]: 	size in bytes: 906202810
2025-03-09 07:23:50,308 [INFO]: 	avg_search_speed_ms: 9.35542867283735
2025-03-09 07:23:50,308 [INFO]: 	99p_search_speed_ms: 19.488186780363304
2025-03-09 07:23:50,308 [INFO]: 	reconstruction error %: 0.0
2025-03-09 07:23:50,308 [INFO]: 	nb vectors: 4606
2025-03-09 07:23:50,308 [INFO]: 	vectors dimension: 49152
2025-03-09 07:23:50,308 [INFO]: 	compression ratio: 0.999308805939368
2025-03-09 07:23:50,308 [INFO]: }
2025-03-09 07:23:50,308 [INFO]: 	>>> Finished "Creating the index" in 62.2771 secs
2025-03-09 07:23:50,308 [INFO]: >>> Finished "Launching the whole pipeline" in 62.3047 secs
2025-03-09 07:23:51: [retrieval_preprocessing] calculating distances ...
2025-03-09 07:23:51: [retrieval_preprocessing] finished and saved retrieval indices for episode 84005 [episode count 14/20]
[retrieval_preprocessing] for episode 35622 [episode count 15/20], we have num_retrieval=np.int64(4438) num_query=np.int64(378)
2025-03-09 07:23:52,248 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-09 07:23:52,873 [INFO]: Launching the whole pipeline 03/09/2025, 07:23:52
2025-03-09 07:23:52,873 [INFO]: Reading total number of vectors and dimension 03/09/2025, 07:23:52
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1335.34it/s]
2025-03-09 07:23:52,905 [INFO]: There are 4438 embeddings of dim 49152
2025-03-09 07:23:52,906 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0329 secs
2025-03-09 07:23:52,906 [INFO]: 	Compute estimated construction time of the index 03/09/2025, 07:23:52
2025-03-09 07:23:52,906 [INFO]: 		-> Train: 16.7 minutes
2025-03-09 07:23:52,906 [INFO]: 		-> Add: 2.4 seconds
2025-03-09 07:23:52,906 [INFO]: 		Total: 16.7 minutes
2025-03-09 07:23:52,906 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0001 secs
2025-03-09 07:23:52,906 [INFO]: 	Checking that your have enough memory available to create the index 03/09/2025, 07:23:52
2025-03-09 07:23:52,906 [INFO]: 915.9MB of memory will be needed to build the index (more might be used if you have more)
2025-03-09 07:23:52,906 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0002 secs
2025-03-09 07:23:52,906 [INFO]: 	Selecting most promising index types given data characteristics 03/09/2025, 07:23:52
2025-03-09 07:23:52,906 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-09 07:23:52,906 [INFO]: 	Creating the index 03/09/2025, 07:23:52
2025-03-09 07:23:52,906 [INFO]: 		-> Instanciate the index HNSW15 03/09/2025, 07:23:52
2025-03-09 07:23:52,907 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0010 secs
2025-03-09 07:23:52,908 [INFO]: 		-> Adding the vectors to the index 03/09/2025, 07:23:52
2025-03-09 07:23:52,908 [INFO]: The memory available for adding the vectors is 49.2GB(total available - used by the index)
2025-03-09 07:23:52,908 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/18 [00:00<?, ?it/s]  6%|▌         | 1/18 [00:00<00:02,  6.27it/s] 33%|███▎      | 6/18 [00:00<00:00, 24.52it/s] 50%|█████     | 9/18 [00:00<00:00, 25.09it/s] 72%|███████▏  | 13/18 [00:00<00:00, 27.91it/s] 89%|████████▉ | 16/18 [00:00<00:00, 24.02it/s]100%|██████████| 18/18 [00:05<00:00,  3.58it/s]
2025-03-09 07:23:57,935 [INFO]: 	Computing best hyperparameters for index knn.index 03/09/2025, 07:23:57
2025-03-09 07:24:43,311 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 45.3754 secs
2025-03-09 07:24:43,312 [INFO]: The best hyperparameters are: efSearch=138
2025-03-09 07:24:43,312 [INFO]: 	Compute fast metrics 03/09/2025, 07:24:43
  0%|          | 0/4 [00:00<?, ?it/s] 25%|██▌       | 1/4 [00:00<00:00,  7.84it/s] 50%|█████     | 2/4 [00:00<00:00,  7.81it/s] 75%|███████▌  | 3/4 [00:00<00:00,  7.13it/s]
2025-03-09 07:24:57,503 [INFO]: 	>>> Finished "Compute fast metrics" in 14.1909 secs
2025-03-09 07:24:57,509 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 64.6012 secs
2025-03-09 07:24:57,509 [INFO]: {
2025-03-09 07:24:57,509 [INFO]: 	index_key: HNSW15
2025-03-09 07:24:57,509 [INFO]: 	index_param: efSearch=138
2025-03-09 07:24:57,509 [INFO]: 	index_path: knn.index
2025-03-09 07:24:57,509 [INFO]: 	size in bytes: 873149950
2025-03-09 07:24:57,509 [INFO]: 	avg_search_speed_ms: 7.1376219594905645
2025-03-09 07:24:57,509 [INFO]: 	99p_search_speed_ms: 12.574462918564677
2025-03-09 07:24:57,509 [INFO]: 	reconstruction error %: 0.0
2025-03-09 07:24:57,509 [INFO]: 	nb vectors: 4438
2025-03-09 07:24:57,509 [INFO]: 	vectors dimension: 49152
2025-03-09 07:24:57,509 [INFO]: 	compression ratio: 0.9993086571212654
2025-03-09 07:24:57,509 [INFO]: }
2025-03-09 07:24:57,509 [INFO]: 	>>> Finished "Creating the index" in 64.6029 secs
2025-03-09 07:24:57,509 [INFO]: >>> Finished "Launching the whole pipeline" in 64.6365 secs
2025-03-09 07:24:58: [retrieval_preprocessing] calculating distances ...
2025-03-09 07:25:00: [retrieval_preprocessing] finished and saved retrieval indices for episode 35622 [episode count 15/20]
[retrieval_preprocessing] for episode 42407 [episode count 16/20], we have num_retrieval=np.int64(4514) num_query=np.int64(302)
2025-03-09 07:25:00,619 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-09 07:25:01,354 [INFO]: Launching the whole pipeline 03/09/2025, 07:25:01
2025-03-09 07:25:01,354 [INFO]: Reading total number of vectors and dimension 03/09/2025, 07:25:01
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1117.88it/s]
2025-03-09 07:25:01,390 [INFO]: There are 4514 embeddings of dim 49152
2025-03-09 07:25:01,390 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0362 secs
2025-03-09 07:25:01,391 [INFO]: 	Compute estimated construction time of the index 03/09/2025, 07:25:01
2025-03-09 07:25:01,391 [INFO]: 		-> Train: 16.7 minutes
2025-03-09 07:25:01,391 [INFO]: 		-> Add: 2.5 seconds
2025-03-09 07:25:01,391 [INFO]: 		Total: 16.7 minutes
2025-03-09 07:25:01,391 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0005 secs
2025-03-09 07:25:01,391 [INFO]: 	Checking that your have enough memory available to create the index 03/09/2025, 07:25:01
2025-03-09 07:25:01,392 [INFO]: 931.6MB of memory will be needed to build the index (more might be used if you have more)
2025-03-09 07:25:01,392 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0005 secs
2025-03-09 07:25:01,392 [INFO]: 	Selecting most promising index types given data characteristics 03/09/2025, 07:25:01
2025-03-09 07:25:01,392 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-09 07:25:01,392 [INFO]: 	Creating the index 03/09/2025, 07:25:01
2025-03-09 07:25:01,393 [INFO]: 		-> Instanciate the index HNSW15 03/09/2025, 07:25:01
2025-03-09 07:25:01,396 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0028 secs
2025-03-09 07:25:01,396 [INFO]: 		-> Adding the vectors to the index 03/09/2025, 07:25:01
2025-03-09 07:25:01,396 [INFO]: The memory available for adding the vectors is 49.2GB(total available - used by the index)
2025-03-09 07:25:01,396 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/18 [00:00<?, ?it/s] 11%|█         | 2/18 [00:00<00:00, 19.44it/s] 39%|███▉      | 7/18 [00:00<00:00, 35.88it/s] 67%|██████▋   | 12/18 [00:00<00:00, 41.64it/s] 94%|█████████▍| 17/18 [00:00<00:00, 44.46it/s]100%|██████████| 18/18 [00:04<00:00,  4.20it/s]
2025-03-09 07:25:05,691 [INFO]: 	Computing best hyperparameters for index knn.index 03/09/2025, 07:25:05
2025-03-09 07:25:50,906 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 45.2149 secs
2025-03-09 07:25:50,907 [INFO]: The best hyperparameters are: efSearch=129
2025-03-09 07:25:50,907 [INFO]: 	Compute fast metrics 03/09/2025, 07:25:50
  0%|          | 0/4 [00:00<?, ?it/s] 25%|██▌       | 1/4 [00:00<00:00,  9.90it/s] 75%|███████▌  | 3/4 [00:00<00:00, 15.37it/s]
2025-03-09 07:26:04,750 [INFO]: 	>>> Finished "Compute fast metrics" in 13.8425 secs
2025-03-09 07:26:04,754 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 63.3578 secs
2025-03-09 07:26:04,754 [INFO]: {
2025-03-09 07:26:04,754 [INFO]: 	index_key: HNSW15
2025-03-09 07:26:04,754 [INFO]: 	index_param: efSearch=129
2025-03-09 07:26:04,754 [INFO]: 	index_path: knn.index
2025-03-09 07:26:04,754 [INFO]: 	size in bytes: 888102430
2025-03-09 07:26:04,754 [INFO]: 	avg_search_speed_ms: 8.949613816742927
2025-03-09 07:26:04,754 [INFO]: 	99p_search_speed_ms: 16.942735351622087
2025-03-09 07:26:04,754 [INFO]: 	reconstruction error %: 0.0
2025-03-09 07:26:04,754 [INFO]: 	nb vectors: 4514
2025-03-09 07:26:04,754 [INFO]: 	vectors dimension: 49152
2025-03-09 07:26:04,754 [INFO]: 	compression ratio: 0.999308730638199
2025-03-09 07:26:04,754 [INFO]: }
2025-03-09 07:26:04,754 [INFO]: 	>>> Finished "Creating the index" in 63.3617 secs
2025-03-09 07:26:04,754 [INFO]: >>> Finished "Launching the whole pipeline" in 63.4001 secs
2025-03-09 07:26:05: [retrieval_preprocessing] calculating distances ...
2025-03-09 07:26:07: [retrieval_preprocessing] finished and saved retrieval indices for episode 42407 [episode count 16/20]
[retrieval_preprocessing] for episode 76455 [episode count 17/20], we have num_retrieval=np.int64(4486) num_query=np.int64(330)
2025-03-09 07:26:08,745 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-09 07:26:09,340 [INFO]: Launching the whole pipeline 03/09/2025, 07:26:09
2025-03-09 07:26:09,340 [INFO]: Reading total number of vectors and dimension 03/09/2025, 07:26:09
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1079.89it/s]
2025-03-09 07:26:09,369 [INFO]: There are 4486 embeddings of dim 49152
2025-03-09 07:26:09,369 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0291 secs
2025-03-09 07:26:09,369 [INFO]: 	Compute estimated construction time of the index 03/09/2025, 07:26:09
2025-03-09 07:26:09,369 [INFO]: 		-> Train: 16.7 minutes
2025-03-09 07:26:09,369 [INFO]: 		-> Add: 2.5 seconds
2025-03-09 07:26:09,369 [INFO]: 		Total: 16.7 minutes
2025-03-09 07:26:09,369 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0001 secs
2025-03-09 07:26:09,369 [INFO]: 	Checking that your have enough memory available to create the index 03/09/2025, 07:26:09
2025-03-09 07:26:09,369 [INFO]: 925.8MB of memory will be needed to build the index (more might be used if you have more)
2025-03-09 07:26:09,369 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0002 secs
2025-03-09 07:26:09,369 [INFO]: 	Selecting most promising index types given data characteristics 03/09/2025, 07:26:09
2025-03-09 07:26:09,370 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-09 07:26:09,370 [INFO]: 	Creating the index 03/09/2025, 07:26:09
2025-03-09 07:26:09,370 [INFO]: 		-> Instanciate the index HNSW15 03/09/2025, 07:26:09
2025-03-09 07:26:09,371 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0012 secs
2025-03-09 07:26:09,371 [INFO]: 		-> Adding the vectors to the index 03/09/2025, 07:26:09
2025-03-09 07:26:09,371 [INFO]: The memory available for adding the vectors is 49.2GB(total available - used by the index)
2025-03-09 07:26:09,371 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/18 [00:00<?, ?it/s]  6%|▌         | 1/18 [00:00<00:03,  5.05it/s] 11%|█         | 2/18 [00:00<00:02,  7.09it/s] 22%|██▏       | 4/18 [00:00<00:01,  9.39it/s] 33%|███▎      | 6/18 [00:00<00:01,  9.58it/s] 39%|███▉      | 7/18 [00:00<00:01,  9.53it/s] 50%|█████     | 9/18 [00:00<00:00,  9.69it/s] 56%|█████▌    | 10/18 [00:01<00:00,  9.71it/s] 61%|██████    | 11/18 [00:01<00:00,  9.13it/s] 67%|██████▋   | 12/18 [00:01<00:00,  9.22it/s] 78%|███████▊  | 14/18 [00:01<00:00,  9.50it/s] 83%|████████▎ | 15/18 [00:01<00:00,  9.03it/s] 89%|████████▉ | 16/18 [00:01<00:00,  9.17it/s] 94%|█████████▍| 17/18 [00:01<00:00,  9.25it/s]100%|██████████| 18/18 [00:06<00:00,  1.22s/it]100%|██████████| 18/18 [00:06<00:00,  2.98it/s]
2025-03-09 07:26:15,414 [INFO]: 	Computing best hyperparameters for index knn.index 03/09/2025, 07:26:15
2025-03-09 07:27:04,479 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 49.0643 secs
2025-03-09 07:27:04,479 [INFO]: The best hyperparameters are: efSearch=194
2025-03-09 07:27:04,479 [INFO]: 	Compute fast metrics 03/09/2025, 07:27:04
  0%|          | 0/4 [00:00<?, ?it/s] 25%|██▌       | 1/4 [00:00<00:00,  4.71it/s] 50%|█████     | 2/4 [00:00<00:00,  6.12it/s] 75%|███████▌  | 3/4 [00:00<00:00,  6.64it/s] 75%|███████▌  | 3/4 [00:00<00:00,  4.54it/s]
2025-03-09 07:27:23,464 [INFO]: 	>>> Finished "Compute fast metrics" in 18.9847 secs
2025-03-09 07:27:23,467 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 74.0961 secs
2025-03-09 07:27:23,468 [INFO]: {
2025-03-09 07:27:23,468 [INFO]: 	index_key: HNSW15
2025-03-09 07:27:23,468 [INFO]: 	index_param: efSearch=194
2025-03-09 07:27:23,468 [INFO]: 	index_path: knn.index
2025-03-09 07:27:23,468 [INFO]: 	size in bytes: 882593650
2025-03-09 07:27:23,468 [INFO]: 	avg_search_speed_ms: 12.266774477002903
2025-03-09 07:27:23,468 [INFO]: 	99p_search_speed_ms: 28.134537069126964
2025-03-09 07:27:23,468 [INFO]: 	reconstruction error %: 0.0
2025-03-09 07:27:23,468 [INFO]: 	nb vectors: 4486
2025-03-09 07:27:23,468 [INFO]: 	vectors dimension: 49152
2025-03-09 07:27:23,468 [INFO]: 	compression ratio: 0.9993086716633414
2025-03-09 07:27:23,468 [INFO]: }
2025-03-09 07:27:23,468 [INFO]: 	>>> Finished "Creating the index" in 74.0981 secs
2025-03-09 07:27:23,468 [INFO]: >>> Finished "Launching the whole pipeline" in 74.1279 secs
2025-03-09 07:27:25: [retrieval_preprocessing] calculating distances ...
2025-03-09 07:27:27: [retrieval_preprocessing] finished and saved retrieval indices for episode 76455 [episode count 17/20]
[retrieval_preprocessing] for episode 78246 [episode count 18/20], we have num_retrieval=np.int64(4706) num_query=np.int64(110)
2025-03-09 07:27:27,510 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-09 07:27:28,363 [INFO]: Launching the whole pipeline 03/09/2025, 07:27:28
2025-03-09 07:27:28,363 [INFO]: Reading total number of vectors and dimension 03/09/2025, 07:27:28
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1319.79it/s]
2025-03-09 07:27:28,398 [INFO]: There are 4706 embeddings of dim 49152
2025-03-09 07:27:28,398 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0353 secs
2025-03-09 07:27:28,398 [INFO]: 	Compute estimated construction time of the index 03/09/2025, 07:27:28
2025-03-09 07:27:28,398 [INFO]: 		-> Train: 16.7 minutes
2025-03-09 07:27:28,399 [INFO]: 		-> Add: 2.6 seconds
2025-03-09 07:27:28,399 [INFO]: 		Total: 16.7 minutes
2025-03-09 07:27:28,399 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0001 secs
2025-03-09 07:27:28,399 [INFO]: 	Checking that your have enough memory available to create the index 03/09/2025, 07:27:28
2025-03-09 07:27:28,399 [INFO]: 971.2MB of memory will be needed to build the index (more might be used if you have more)
2025-03-09 07:27:28,399 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0003 secs
2025-03-09 07:27:28,399 [INFO]: 	Selecting most promising index types given data characteristics 03/09/2025, 07:27:28
2025-03-09 07:27:28,399 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-09 07:27:28,399 [INFO]: 	Creating the index 03/09/2025, 07:27:28
2025-03-09 07:27:28,399 [INFO]: 		-> Instanciate the index HNSW15 03/09/2025, 07:27:28
2025-03-09 07:27:28,400 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0013 secs
2025-03-09 07:27:28,401 [INFO]: 		-> Adding the vectors to the index 03/09/2025, 07:27:28
2025-03-09 07:27:28,401 [INFO]: The memory available for adding the vectors is 49.1GB(total available - used by the index)
2025-03-09 07:27:28,401 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/19 [00:00<?, ?it/s]  5%|▌         | 1/19 [00:00<00:02,  7.57it/s] 32%|███▏      | 6/19 [00:00<00:00, 28.69it/s] 58%|█████▊    | 11/19 [00:00<00:00, 34.93it/s] 84%|████████▍ | 16/19 [00:00<00:00, 40.05it/s]100%|██████████| 19/19 [00:04<00:00,  3.86it/s]
2025-03-09 07:27:33,328 [INFO]: 	Computing best hyperparameters for index knn.index 03/09/2025, 07:27:33
2025-03-09 07:28:16,046 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 42.7173 secs
2025-03-09 07:28:16,046 [INFO]: The best hyperparameters are: efSearch=103
2025-03-09 07:28:16,046 [INFO]: 	Compute fast metrics 03/09/2025, 07:28:16
  0%|          | 0/4 [00:00<?, ?it/s] 25%|██▌       | 1/4 [00:00<00:00,  5.86it/s] 75%|███████▌  | 3/4 [00:00<00:00,  9.55it/s] 75%|███████▌  | 3/4 [00:00<00:00,  7.31it/s]
2025-03-09 07:28:29,052 [INFO]: 	>>> Finished "Compute fast metrics" in 13.0053 secs
2025-03-09 07:28:29,056 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 60.6550 secs
2025-03-09 07:28:29,056 [INFO]: {
2025-03-09 07:28:29,056 [INFO]: 	index_key: HNSW15
2025-03-09 07:28:29,056 [INFO]: 	index_param: efSearch=103
2025-03-09 07:28:29,056 [INFO]: 	index_path: knn.index
2025-03-09 07:28:29,056 [INFO]: 	size in bytes: 925877350
2025-03-09 07:28:29,056 [INFO]: 	avg_search_speed_ms: 7.546580764377174
2025-03-09 07:28:29,056 [INFO]: 	99p_search_speed_ms: 15.425997897982597
2025-03-09 07:28:29,056 [INFO]: 	reconstruction error %: 0.0
2025-03-09 07:28:29,056 [INFO]: 	nb vectors: 4706
2025-03-09 07:28:29,056 [INFO]: 	vectors dimension: 49152
2025-03-09 07:28:29,056 [INFO]: 	compression ratio: 0.9993086535705836
2025-03-09 07:28:29,056 [INFO]: }
2025-03-09 07:28:29,056 [INFO]: 	>>> Finished "Creating the index" in 60.6570 secs
2025-03-09 07:28:29,056 [INFO]: >>> Finished "Launching the whole pipeline" in 60.6933 secs
2025-03-09 07:28:29: [retrieval_preprocessing] calculating distances ...
2025-03-09 07:28:30: [retrieval_preprocessing] finished and saved retrieval indices for episode 78246 [episode count 18/20]
[retrieval_preprocessing] for episode 86312 [episode count 19/20], we have num_retrieval=np.int64(4571) num_query=np.int64(245)
2025-03-09 07:28:30,877 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-09 07:28:31,746 [INFO]: Launching the whole pipeline 03/09/2025, 07:28:31
2025-03-09 07:28:31,746 [INFO]: Reading total number of vectors and dimension 03/09/2025, 07:28:31
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1079.89it/s]
2025-03-09 07:28:31,784 [INFO]: There are 4571 embeddings of dim 49152
2025-03-09 07:28:31,785 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0386 secs
2025-03-09 07:28:31,785 [INFO]: 	Compute estimated construction time of the index 03/09/2025, 07:28:31
2025-03-09 07:28:31,785 [INFO]: 		-> Train: 16.7 minutes
2025-03-09 07:28:31,785 [INFO]: 		-> Add: 2.5 seconds
2025-03-09 07:28:31,785 [INFO]: 		Total: 16.7 minutes
2025-03-09 07:28:31,785 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0001 secs
2025-03-09 07:28:31,785 [INFO]: 	Checking that your have enough memory available to create the index 03/09/2025, 07:28:31
2025-03-09 07:28:31,785 [INFO]: 943.3MB of memory will be needed to build the index (more might be used if you have more)
2025-03-09 07:28:31,785 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0002 secs
2025-03-09 07:28:31,785 [INFO]: 	Selecting most promising index types given data characteristics 03/09/2025, 07:28:31
2025-03-09 07:28:31,785 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-09 07:28:31,785 [INFO]: 	Creating the index 03/09/2025, 07:28:31
2025-03-09 07:28:31,785 [INFO]: 		-> Instanciate the index HNSW15 03/09/2025, 07:28:31
2025-03-09 07:28:31,787 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0011 secs
2025-03-09 07:28:31,787 [INFO]: 		-> Adding the vectors to the index 03/09/2025, 07:28:31
2025-03-09 07:28:31,787 [INFO]: The memory available for adding the vectors is 49.2GB(total available - used by the index)
2025-03-09 07:28:31,787 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/18 [00:00<?, ?it/s]  6%|▌         | 1/18 [00:00<00:01,  8.52it/s] 33%|███▎      | 6/18 [00:00<00:00, 29.92it/s] 61%|██████    | 11/18 [00:00<00:00, 37.29it/s] 89%|████████▉ | 16/18 [00:00<00:00, 41.28it/s]100%|██████████| 18/18 [00:03<00:00,  4.72it/s]
2025-03-09 07:28:35,608 [INFO]: 	Computing best hyperparameters for index knn.index 03/09/2025, 07:28:35
2025-03-09 07:29:23,726 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 48.1167 secs
2025-03-09 07:29:23,727 [INFO]: The best hyperparameters are: efSearch=132
2025-03-09 07:29:23,727 [INFO]: 	Compute fast metrics 03/09/2025, 07:29:23
  0%|          | 0/4 [00:00<?, ?it/s] 25%|██▌       | 1/4 [00:00<00:00,  6.67it/s] 75%|███████▌  | 3/4 [00:00<00:00, 12.28it/s] 75%|███████▌  | 3/4 [00:00<00:00,  9.43it/s]
2025-03-09 07:29:38,468 [INFO]: 	>>> Finished "Compute fast metrics" in 14.7407 secs
2025-03-09 07:29:38,471 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 66.6841 secs
2025-03-09 07:29:38,471 [INFO]: {
2025-03-09 07:29:38,471 [INFO]: 	index_key: HNSW15
2025-03-09 07:29:38,471 [INFO]: 	index_param: efSearch=132
2025-03-09 07:29:38,471 [INFO]: 	index_path: knn.index
2025-03-09 07:29:38,471 [INFO]: 	size in bytes: 899316850
2025-03-09 07:29:38,471 [INFO]: 	avg_search_speed_ms: 7.939835496593009
2025-03-09 07:29:38,471 [INFO]: 	99p_search_speed_ms: 13.552977610379463
2025-03-09 07:29:38,471 [INFO]: 	reconstruction error %: 0.0
2025-03-09 07:29:38,471 [INFO]: 	nb vectors: 4571
2025-03-09 07:29:38,471 [INFO]: 	vectors dimension: 49152
2025-03-09 07:29:38,471 [INFO]: 	compression ratio: 0.9993087175004004
2025-03-09 07:29:38,471 [INFO]: }
2025-03-09 07:29:38,471 [INFO]: 	>>> Finished "Creating the index" in 66.6858 secs
2025-03-09 07:29:38,471 [INFO]: >>> Finished "Launching the whole pipeline" in 66.7251 secs
2025-03-09 07:29:39: [retrieval_preprocessing] calculating distances ...
2025-03-09 07:29:39: [retrieval_preprocessing] finished and saved retrieval indices for episode 86312 [episode count 19/20]
2025-03-09 07:29:39: [retrieval_preprocessing] finished for (9933578360, 'drawer') [chosen_id count 1/10]
2025-03-09 07:29:49: [retrieval_preprocessing] concatenated all embeddings and indices for 20 episodes for (1498834123, 'cup') [chosen_id count 2/10]
2025-03-09 07:29:49: [retrieval_preprocessing] we have num_total=14329 embedding_dim=49152
[retrieval_preprocessing] for episode 87554 [episode count 0/20], we have num_retrieval=np.int64(13139) num_query=np.int64(1190)
2025-03-09 07:30:04,838 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-09 07:30:06,618 [INFO]: Launching the whole pipeline 03/09/2025, 07:30:06
2025-03-09 07:30:06,618 [INFO]: Reading total number of vectors and dimension 03/09/2025, 07:30:06
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1435.91it/s]
2025-03-09 07:30:06,653 [INFO]: There are 13139 embeddings of dim 49152
2025-03-09 07:30:06,653 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0345 secs
2025-03-09 07:30:06,653 [INFO]: 	Compute estimated construction time of the index 03/09/2025, 07:30:06
2025-03-09 07:30:06,653 [INFO]: 		-> Train: 16.7 minutes
2025-03-09 07:30:06,653 [INFO]: 		-> Add: 7.2 seconds
2025-03-09 07:30:06,653 [INFO]: 		Total: 16.8 minutes
2025-03-09 07:30:06,653 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0001 secs
2025-03-09 07:30:06,653 [INFO]: 	Checking that your have enough memory available to create the index 03/09/2025, 07:30:06
2025-03-09 07:30:06,653 [INFO]: 2.6GB of memory will be needed to build the index (more might be used if you have more)
2025-03-09 07:30:06,653 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0002 secs
2025-03-09 07:30:06,653 [INFO]: 	Selecting most promising index types given data characteristics 03/09/2025, 07:30:06
2025-03-09 07:30:06,653 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-09 07:30:06,653 [INFO]: 	Creating the index 03/09/2025, 07:30:06
2025-03-09 07:30:06,653 [INFO]: 		-> Instanciate the index HNSW32 03/09/2025, 07:30:06
2025-03-09 07:30:06,654 [INFO]: 		>>> Finished "-> Instanciate the index HNSW32" in 0.0010 secs
2025-03-09 07:30:06,654 [INFO]: 		-> Adding the vectors to the index 03/09/2025, 07:30:06
2025-03-09 07:30:06,654 [INFO]: The memory available for adding the vectors is 47.6GB(total available - used by the index)
2025-03-09 07:30:06,655 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/54 [00:00<?, ?it/s]  2%|▏         | 1/54 [00:00<00:06,  8.42it/s]  4%|▎         | 2/54 [00:00<00:11,  4.56it/s] 13%|█▎        | 7/54 [00:00<00:02, 16.66it/s] 22%|██▏       | 12/54 [00:00<00:01, 25.32it/s] 31%|███▏      | 17/54 [00:00<00:01, 31.51it/s] 39%|███▉      | 21/54 [00:07<00:19,  1.72it/s] 44%|████▍     | 24/54 [00:08<00:15,  1.96it/s] 48%|████▊     | 26/54 [00:08<00:11,  2.37it/s] 52%|█████▏    | 28/54 [00:09<00:09,  2.63it/s] 56%|█████▌    | 30/54 [00:10<00:10,  2.32it/s] 57%|█████▋    | 31/54 [00:12<00:14,  1.55it/s] 59%|█████▉    | 32/54 [00:12<00:13,  1.58it/s] 61%|██████    | 33/54 [00:13<00:12,  1.69it/s] 63%|██████▎   | 34/54 [00:13<00:12,  1.62it/s] 65%|██████▍   | 35/54 [00:16<00:20,  1.10s/it] 67%|██████▋   | 36/54 [00:18<00:23,  1.33s/it] 69%|██████▊   | 37/54 [00:19<00:21,  1.29s/it] 70%|███████   | 38/54 [00:21<00:22,  1.43s/it] 74%|███████▍  | 40/54 [00:21<00:11,  1.21it/s] 76%|███████▌  | 41/54 [00:21<00:08,  1.53it/s] 78%|███████▊  | 42/54 [00:30<00:31,  2.65s/it] 80%|███████▉  | 43/54 [00:30<00:22,  2.09s/it] 81%|████████▏ | 44/54 [00:30<00:15,  1.54s/it] 83%|████████▎ | 45/54 [00:30<00:10,  1.14s/it] 85%|████████▌ | 46/54 [00:30<00:06,  1.19it/s] 87%|████████▋ | 47/54 [00:31<00:04,  1.59it/s] 89%|████████▉ | 48/54 [00:31<00:02,  2.08it/s] 91%|█████████ | 49/54 [00:31<00:01,  2.57it/s] 93%|█████████▎| 50/54 [00:31<00:01,  3.22it/s] 94%|█████████▍| 51/54 [00:31<00:00,  4.02it/s] 98%|█████████▊| 53/54 [00:31<00:00,  5.76it/s]100%|██████████| 54/54 [00:38<00:00,  1.78s/it]100%|██████████| 54/54 [00:38<00:00,  1.40it/s]
2025-03-09 07:30:45,140 [INFO]: 	Computing best hyperparameters for index knn.index 03/09/2025, 07:30:45
2025-03-09 07:32:17,163 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 92.0225 secs
2025-03-09 07:32:17,164 [INFO]: The best hyperparameters are: efSearch=113
2025-03-09 07:32:17,164 [INFO]: 	Compute fast metrics 03/09/2025, 07:32:17
  0%|          | 0/4 [00:00<?, ?it/s] 25%|██▌       | 1/4 [00:00<00:00,  3.58it/s] 50%|█████     | 2/4 [00:00<00:00,  5.33it/s] 75%|███████▌  | 3/4 [00:00<00:00,  6.11it/s] 75%|███████▌  | 3/4 [00:00<00:00,  4.50it/s]
2025-03-09 07:32:38,258 [INFO]: 	>>> Finished "Compute fast metrics" in 21.0939 secs
2025-03-09 07:32:38,260 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 151.6056 secs
2025-03-09 07:32:38,260 [INFO]: {
2025-03-09 07:32:38,260 [INFO]: 	index_key: HNSW32
2025-03-09 07:32:38,260 [INFO]: 	index_param: efSearch=113
2025-03-09 07:32:38,260 [INFO]: 	index_path: knn.index
2025-03-09 07:32:38,260 [INFO]: 	size in bytes: 2586806726
2025-03-09 07:32:38,260 [INFO]: 	avg_search_speed_ms: 11.400391480183503
2025-03-09 07:32:38,260 [INFO]: 	99p_search_speed_ms: 24.7400276362896
2025-03-09 07:32:38,260 [INFO]: 	reconstruction error %: 0.0
2025-03-09 07:32:38,260 [INFO]: 	nb vectors: 13139
2025-03-09 07:32:38,260 [INFO]: 	vectors dimension: 49152
2025-03-09 07:32:38,260 [INFO]: 	compression ratio: 0.9986182910520235
2025-03-09 07:32:38,260 [INFO]: }
2025-03-09 07:32:38,260 [INFO]: 	>>> Finished "Creating the index" in 151.6071 secs
2025-03-09 07:32:38,260 [INFO]: >>> Finished "Launching the whole pipeline" in 151.6422 secs
2025-03-09 07:32:42: [retrieval_preprocessing] calculating distances ...
2025-03-09 07:32:47: [retrieval_preprocessing] finished and saved retrieval indices for episode 87554 [episode count 0/20]
[retrieval_preprocessing] for episode 12291 [episode count 1/20], we have num_retrieval=np.int64(13718) num_query=np.int64(611)
2025-03-09 07:32:56,245 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-09 07:32:58,096 [INFO]: Launching the whole pipeline 03/09/2025, 07:32:58
2025-03-09 07:32:58,096 [INFO]: Reading total number of vectors and dimension 03/09/2025, 07:32:58
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1384.72it/s]
2025-03-09 07:32:58,122 [INFO]: There are 13718 embeddings of dim 49152
2025-03-09 07:32:58,122 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0258 secs
2025-03-09 07:32:58,122 [INFO]: 	Compute estimated construction time of the index 03/09/2025, 07:32:58
2025-03-09 07:32:58,122 [INFO]: 		-> Train: 16.7 minutes
2025-03-09 07:32:58,122 [INFO]: 		-> Add: 7.5 seconds
2025-03-09 07:32:58,122 [INFO]: 		Total: 16.8 minutes
2025-03-09 07:32:58,122 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0001 secs
2025-03-09 07:32:58,122 [INFO]: 	Checking that your have enough memory available to create the index 03/09/2025, 07:32:58
2025-03-09 07:32:58,122 [INFO]: 2.8GB of memory will be needed to build the index (more might be used if you have more)
2025-03-09 07:32:58,122 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0002 secs
2025-03-09 07:32:58,122 [INFO]: 	Selecting most promising index types given data characteristics 03/09/2025, 07:32:58
2025-03-09 07:32:58,123 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-09 07:32:58,123 [INFO]: 	Creating the index 03/09/2025, 07:32:58
2025-03-09 07:32:58,123 [INFO]: 		-> Instanciate the index HNSW32 03/09/2025, 07:32:58
2025-03-09 07:32:58,124 [INFO]: 		>>> Finished "-> Instanciate the index HNSW32" in 0.0011 secs
2025-03-09 07:32:58,124 [INFO]: 		-> Adding the vectors to the index 03/09/2025, 07:32:58
2025-03-09 07:32:58,124 [INFO]: The memory available for adding the vectors is 47.5GB(total available - used by the index)
2025-03-09 07:32:58,124 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/56 [00:00<?, ?it/s]  2%|▏         | 1/56 [00:00<00:13,  4.06it/s]  4%|▎         | 2/56 [00:00<00:11,  4.70it/s]  5%|▌         | 3/56 [00:00<00:14,  3.68it/s]  7%|▋         | 4/56 [00:00<00:10,  4.73it/s]  9%|▉         | 5/56 [00:01<00:09,  5.52it/s] 11%|█         | 6/56 [00:01<00:08,  6.20it/s] 12%|█▎        | 7/56 [00:01<00:07,  6.76it/s] 14%|█▍        | 8/56 [00:01<00:06,  7.21it/s] 16%|█▌        | 9/56 [00:01<00:06,  7.42it/s] 18%|█▊        | 10/56 [00:01<00:06,  7.59it/s] 20%|█▉        | 11/56 [00:01<00:05,  7.70it/s] 21%|██▏       | 12/56 [00:01<00:05,  7.79it/s] 23%|██▎       | 13/56 [00:02<00:05,  7.82it/s] 25%|██▌       | 14/56 [00:02<00:05,  7.96it/s] 27%|██▋       | 15/56 [00:02<00:04,  8.37it/s] 30%|███       | 17/56 [00:02<00:03, 10.68it/s] 34%|███▍      | 19/56 [00:02<00:03, 11.00it/s] 38%|███▊      | 21/56 [00:08<00:38,  1.11s/it] 41%|████      | 23/56 [00:08<00:24,  1.34it/s] 45%|████▍     | 25/56 [00:08<00:16,  1.87it/s] 48%|████▊     | 27/56 [00:08<00:11,  2.54it/s] 52%|█████▏    | 29/56 [00:08<00:07,  3.41it/s] 55%|█████▌    | 31/56 [00:09<00:05,  4.46it/s] 59%|█████▉    | 33/56 [00:09<00:04,  5.44it/s] 62%|██████▎   | 35/56 [00:09<00:03,  6.57it/s] 66%|██████▌   | 37/56 [00:09<00:02,  7.91it/s] 70%|██████▉   | 39/56 [00:09<00:01,  9.02it/s] 73%|███████▎  | 41/56 [00:09<00:01, 10.05it/s] 77%|███████▋  | 43/56 [00:17<00:16,  1.28s/it] 79%|███████▊  | 44/56 [00:18<00:12,  1.08s/it] 80%|████████  | 45/56 [00:19<00:12,  1.09s/it] 82%|████████▏ | 46/56 [00:19<00:10,  1.00s/it] 86%|████████▌ | 48/56 [00:20<00:05,  1.58it/s] 91%|█████████ | 51/56 [00:20<00:01,  2.73it/s] 95%|█████████▍| 53/56 [00:20<00:00,  3.58it/s] 98%|█████████▊| 55/56 [00:20<00:00,  4.39it/s]100%|██████████| 56/56 [00:27<00:00,  2.01it/s]
2025-03-09 07:33:25,976 [INFO]: 	Computing best hyperparameters for index knn.index 03/09/2025, 07:33:25
2025-03-09 07:35:12,296 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 106.3196 secs
2025-03-09 07:35:12,296 [INFO]: The best hyperparameters are: efSearch=139
2025-03-09 07:35:12,296 [INFO]: 	Compute fast metrics 03/09/2025, 07:35:12
  0%|          | 0/4 [00:00<?, ?it/s] 25%|██▌       | 1/4 [00:00<00:00,  5.41it/s] 50%|█████     | 2/4 [00:00<00:00,  7.14it/s] 75%|███████▌  | 3/4 [00:00<00:00,  7.95it/s] 75%|███████▌  | 3/4 [00:00<00:00,  5.96it/s]
2025-03-09 07:35:32,783 [INFO]: 	>>> Finished "Compute fast metrics" in 20.4862 secs
2025-03-09 07:35:32,793 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 154.6686 secs
2025-03-09 07:35:32,794 [INFO]: {
2025-03-09 07:35:32,794 [INFO]: 	index_key: HNSW32
2025-03-09 07:35:32,794 [INFO]: 	index_param: efSearch=139
2025-03-09 07:35:32,794 [INFO]: 	index_path: knn.index
2025-03-09 07:35:32,794 [INFO]: 	size in bytes: 2700800490
2025-03-09 07:35:32,794 [INFO]: 	avg_search_speed_ms: 13.547573526892736
2025-03-09 07:35:32,794 [INFO]: 	99p_search_speed_ms: 26.37417539022863
2025-03-09 07:35:32,794 [INFO]: 	reconstruction error %: 0.0
2025-03-09 07:35:32,794 [INFO]: 	nb vectors: 13718
2025-03-09 07:35:32,794 [INFO]: 	vectors dimension: 49152
2025-03-09 07:35:32,794 [INFO]: 	compression ratio: 0.9986182074485628
2025-03-09 07:35:32,794 [INFO]: }
2025-03-09 07:35:32,794 [INFO]: 	>>> Finished "Creating the index" in 154.6715 secs
2025-03-09 07:35:32,794 [INFO]: >>> Finished "Launching the whole pipeline" in 154.6980 secs
2025-03-09 07:35:35: [retrieval_preprocessing] calculating distances ...
2025-03-09 07:35:38: [retrieval_preprocessing] finished and saved retrieval indices for episode 12291 [episode count 1/20]
[retrieval_preprocessing] for episode 22025 [episode count 2/20], we have num_retrieval=np.int64(13682) num_query=np.int64(647)
2025-03-09 07:35:43,674 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-09 07:35:45,543 [INFO]: Launching the whole pipeline 03/09/2025, 07:35:45
2025-03-09 07:35:45,543 [INFO]: Reading total number of vectors and dimension 03/09/2025, 07:35:45
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1879.17it/s]
2025-03-09 07:35:45,574 [INFO]: There are 13682 embeddings of dim 49152
2025-03-09 07:35:45,574 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0312 secs
2025-03-09 07:35:45,574 [INFO]: 	Compute estimated construction time of the index 03/09/2025, 07:35:45
2025-03-09 07:35:45,574 [INFO]: 		-> Train: 16.7 minutes
2025-03-09 07:35:45,574 [INFO]: 		-> Add: 7.5 seconds
2025-03-09 07:35:45,574 [INFO]: 		Total: 16.8 minutes
2025-03-09 07:35:45,574 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0001 secs
2025-03-09 07:35:45,574 [INFO]: 	Checking that your have enough memory available to create the index 03/09/2025, 07:35:45
2025-03-09 07:35:45,575 [INFO]: 2.8GB of memory will be needed to build the index (more might be used if you have more)
2025-03-09 07:35:45,575 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0002 secs
2025-03-09 07:35:45,575 [INFO]: 	Selecting most promising index types given data characteristics 03/09/2025, 07:35:45
2025-03-09 07:35:45,575 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-09 07:35:45,575 [INFO]: 	Creating the index 03/09/2025, 07:35:45
2025-03-09 07:35:45,575 [INFO]: 		-> Instanciate the index HNSW32 03/09/2025, 07:35:45
2025-03-09 07:35:45,576 [INFO]: 		>>> Finished "-> Instanciate the index HNSW32" in 0.0010 secs
2025-03-09 07:35:45,576 [INFO]: 		-> Adding the vectors to the index 03/09/2025, 07:35:45
2025-03-09 07:35:45,576 [INFO]: The memory available for adding the vectors is 47.5GB(total available - used by the index)
2025-03-09 07:35:45,576 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/56 [00:00<?, ?it/s]  2%|▏         | 1/56 [00:00<00:12,  4.43it/s]  5%|▌         | 3/56 [00:00<00:06,  8.45it/s]  9%|▉         | 5/56 [00:00<00:05, 10.04it/s] 12%|█▎        | 7/56 [00:00<00:04, 10.36it/s] 16%|█▌        | 9/56 [00:00<00:04, 10.98it/s] 20%|█▉        | 11/56 [00:01<00:03, 11.34it/s] 23%|██▎       | 13/56 [00:01<00:03, 11.48it/s] 27%|██▋       | 15/56 [00:01<00:03, 11.60it/s] 30%|███       | 17/56 [00:01<00:03, 11.78it/s] 34%|███▍      | 19/56 [00:01<00:03, 11.75it/s] 38%|███▊      | 21/56 [00:07<00:35,  1.01s/it] 39%|███▉      | 22/56 [00:08<00:29,  1.14it/s] 41%|████      | 23/56 [00:08<00:24,  1.32it/s] 43%|████▎     | 24/56 [00:08<00:20,  1.53it/s] 45%|████▍     | 25/56 [00:10<00:27,  1.12it/s] 46%|████▋     | 26/56 [00:10<00:23,  1.28it/s] 48%|████▊     | 27/56 [00:11<00:19,  1.47it/s] 52%|█████▏    | 29/56 [00:11<00:11,  2.44it/s] 57%|█████▋    | 32/56 [00:11<00:05,  4.36it/s] 62%|██████▎   | 35/56 [00:11<00:03,  5.92it/s] 66%|██████▌   | 37/56 [00:11<00:02,  6.93it/s] 70%|██████▉   | 39/56 [00:12<00:02,  8.07it/s] 73%|███████▎  | 41/56 [00:12<00:01,  8.75it/s] 77%|███████▋  | 43/56 [00:20<00:16,  1.29s/it] 79%|███████▊  | 44/56 [00:20<00:13,  1.12s/it] 80%|████████  | 45/56 [00:21<00:10,  1.06it/s] 82%|████████▏ | 46/56 [00:21<00:07,  1.25it/s] 84%|████████▍ | 47/56 [00:21<00:06,  1.50it/s] 86%|████████▌ | 48/56 [00:21<00:04,  1.77it/s] 88%|████████▊ | 49/56 [00:22<00:03,  1.85it/s] 89%|████████▉ | 50/56 [00:22<00:03,  1.80it/s] 91%|█████████ | 51/56 [00:23<00:02,  2.00it/s] 93%|█████████▎| 52/56 [00:23<00:02,  1.95it/s] 95%|█████████▍| 53/56 [00:24<00:01,  1.97it/s] 96%|█████████▋| 54/56 [00:24<00:00,  2.02it/s] 98%|█████████▊| 55/56 [00:25<00:00,  1.95it/s]100%|██████████| 56/56 [00:33<00:00,  2.72s/it]100%|██████████| 56/56 [00:33<00:00,  1.68it/s]
2025-03-09 07:36:18,857 [INFO]: 	Computing best hyperparameters for index knn.index 03/09/2025, 07:36:18
2025-03-09 07:38:00,989 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 102.1316 secs
2025-03-09 07:38:00,989 [INFO]: The best hyperparameters are: efSearch=141
2025-03-09 07:38:00,989 [INFO]: 	Compute fast metrics 03/09/2025, 07:38:00
  0%|          | 0/4 [00:00<?, ?it/s] 25%|██▌       | 1/4 [00:00<00:00,  5.34it/s] 75%|███████▌  | 3/4 [00:00<00:00,  9.32it/s] 75%|███████▌  | 3/4 [00:00<00:00,  7.18it/s]
2025-03-09 07:38:17,929 [INFO]: 	>>> Finished "Compute fast metrics" in 16.9391 secs
2025-03-09 07:38:17,931 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 152.3549 secs
2025-03-09 07:38:17,931 [INFO]: {
2025-03-09 07:38:17,931 [INFO]: 	index_key: HNSW32
2025-03-09 07:38:17,931 [INFO]: 	index_param: efSearch=141
2025-03-09 07:38:17,931 [INFO]: 	index_path: knn.index
2025-03-09 07:38:17,931 [INFO]: 	size in bytes: 2693712826
2025-03-09 07:38:17,931 [INFO]: 	avg_search_speed_ms: 12.335162195256475
2025-03-09 07:38:17,931 [INFO]: 	99p_search_speed_ms: 24.883542908355587
2025-03-09 07:38:17,931 [INFO]: 	reconstruction error %: 0.0
2025-03-09 07:38:17,931 [INFO]: 	nb vectors: 13682
2025-03-09 07:38:17,931 [INFO]: 	vectors dimension: 49152
2025-03-09 07:38:17,931 [INFO]: 	compression ratio: 0.9986182008846403
2025-03-09 07:38:17,931 [INFO]: }
2025-03-09 07:38:17,931 [INFO]: 	>>> Finished "Creating the index" in 152.3563 secs
2025-03-09 07:38:17,931 [INFO]: >>> Finished "Launching the whole pipeline" in 152.3883 secs
2025-03-09 07:38:21: [retrieval_preprocessing] calculating distances ...
2025-03-09 07:38:23: [retrieval_preprocessing] finished and saved retrieval indices for episode 22025 [episode count 2/20]
[retrieval_preprocessing] for episode 34830 [episode count 3/20], we have num_retrieval=np.int64(13635) num_query=np.int64(694)
2025-03-09 07:38:28,059 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-09 07:38:29,843 [INFO]: Launching the whole pipeline 03/09/2025, 07:38:29
2025-03-09 07:38:29,843 [INFO]: Reading total number of vectors and dimension 03/09/2025, 07:38:29
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 2198.27it/s]
2025-03-09 07:38:29,866 [INFO]: There are 13635 embeddings of dim 49152
2025-03-09 07:38:29,867 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0235 secs
2025-03-09 07:38:29,867 [INFO]: 	Compute estimated construction time of the index 03/09/2025, 07:38:29
2025-03-09 07:38:29,867 [INFO]: 		-> Train: 16.7 minutes
2025-03-09 07:38:29,867 [INFO]: 		-> Add: 7.5 seconds
2025-03-09 07:38:29,867 [INFO]: 		Total: 16.8 minutes
2025-03-09 07:38:29,867 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0002 secs
2025-03-09 07:38:29,867 [INFO]: 	Checking that your have enough memory available to create the index 03/09/2025, 07:38:29
2025-03-09 07:38:29,867 [INFO]: 2.7GB of memory will be needed to build the index (more might be used if you have more)
2025-03-09 07:38:29,867 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0001 secs
2025-03-09 07:38:29,867 [INFO]: 	Selecting most promising index types given data characteristics 03/09/2025, 07:38:29
2025-03-09 07:38:29,867 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-09 07:38:29,867 [INFO]: 	Creating the index 03/09/2025, 07:38:29
2025-03-09 07:38:29,867 [INFO]: 		-> Instanciate the index HNSW32 03/09/2025, 07:38:29
2025-03-09 07:38:29,868 [INFO]: 		>>> Finished "-> Instanciate the index HNSW32" in 0.0009 secs
2025-03-09 07:38:29,868 [INFO]: 		-> Adding the vectors to the index 03/09/2025, 07:38:29
2025-03-09 07:38:29,868 [INFO]: The memory available for adding the vectors is 47.5GB(total available - used by the index)
2025-03-09 07:38:29,868 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/56 [00:00<?, ?it/s]  2%|▏         | 1/56 [00:00<00:13,  4.07it/s]  5%|▌         | 3/56 [00:00<00:06,  7.99it/s]  9%|▉         | 5/56 [00:00<00:05,  9.62it/s] 12%|█▎        | 7/56 [00:00<00:04, 10.67it/s] 16%|█▌        | 9/56 [00:00<00:04, 11.23it/s] 20%|█▉        | 11/56 [00:01<00:03, 11.41it/s] 23%|██▎       | 13/56 [00:01<00:03, 11.56it/s] 27%|██▋       | 15/56 [00:01<00:03, 11.56it/s] 30%|███       | 17/56 [00:01<00:03, 11.54it/s] 34%|███▍      | 19/56 [00:01<00:03, 11.31it/s] 38%|███▊      | 21/56 [00:07<00:35,  1.00s/it] 39%|███▉      | 22/56 [00:08<00:28,  1.19it/s] 43%|████▎     | 24/56 [00:08<00:18,  1.71it/s] 46%|████▋     | 26/56 [00:08<00:12,  2.37it/s] 50%|█████     | 28/56 [00:08<00:08,  3.19it/s] 54%|█████▎    | 30/56 [00:08<00:06,  4.17it/s] 57%|█████▋    | 32/56 [00:08<00:04,  5.19it/s] 61%|██████    | 34/56 [00:09<00:03,  6.31it/s] 64%|██████▍   | 36/56 [00:09<00:02,  7.41it/s] 68%|██████▊   | 38/56 [00:09<00:02,  8.39it/s] 71%|███████▏  | 40/56 [00:09<00:01,  9.31it/s] 75%|███████▌  | 42/56 [00:16<00:15,  1.08s/it] 79%|███████▊  | 44/56 [00:16<00:09,  1.29it/s] 82%|████████▏ | 46/56 [00:16<00:05,  1.78it/s] 86%|████████▌ | 48/56 [00:16<00:03,  2.44it/s] 89%|████████▉ | 50/56 [00:16<00:01,  3.26it/s] 93%|█████████▎| 52/56 [00:16<00:00,  4.12it/s] 96%|█████████▋| 54/56 [00:17<00:00,  5.05it/s]100%|██████████| 56/56 [00:23<00:00,  1.09s/it]100%|██████████| 56/56 [00:23<00:00,  2.39it/s]
2025-03-09 07:38:53,262 [INFO]: 	Computing best hyperparameters for index knn.index 03/09/2025, 07:38:53
2025-03-09 07:40:32,812 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 99.5485 secs
2025-03-09 07:40:32,812 [INFO]: The best hyperparameters are: efSearch=134
2025-03-09 07:40:32,812 [INFO]: 	Compute fast metrics 03/09/2025, 07:40:32
  0%|          | 0/4 [00:00<?, ?it/s] 25%|██▌       | 1/4 [00:00<00:00,  5.59it/s] 50%|█████     | 2/4 [00:00<00:00,  7.37it/s] 75%|███████▌  | 3/4 [00:00<00:00,  8.19it/s] 75%|███████▌  | 3/4 [00:00<00:00,  6.12it/s]
2025-03-09 07:41:00,376 [INFO]: 	>>> Finished "Compute fast metrics" in 27.5641 secs
2025-03-09 07:41:00,379 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 150.5106 secs
2025-03-09 07:41:00,379 [INFO]: {
2025-03-09 07:41:00,379 [INFO]: 	index_key: HNSW32
2025-03-09 07:41:00,379 [INFO]: 	index_param: efSearch=134
2025-03-09 07:41:00,379 [INFO]: 	index_path: knn.index
2025-03-09 07:41:00,379 [INFO]: 	size in bytes: 2684459526
2025-03-09 07:41:00,379 [INFO]: 	avg_search_speed_ms: 11.644118728671263
2025-03-09 07:41:00,379 [INFO]: 	99p_search_speed_ms: 21.780670392326993
2025-03-09 07:41:00,379 [INFO]: 	reconstruction error %: 0.0
2025-03-09 07:41:00,379 [INFO]: 	nb vectors: 13635
2025-03-09 07:41:00,379 [INFO]: 	vectors dimension: 49152
2025-03-09 07:41:00,379 [INFO]: 	compression ratio: 0.9986181777135872
2025-03-09 07:41:00,379 [INFO]: }
2025-03-09 07:41:00,379 [INFO]: 	>>> Finished "Creating the index" in 150.5120 secs
2025-03-09 07:41:00,379 [INFO]: >>> Finished "Launching the whole pipeline" in 150.5362 secs
2025-03-09 07:41:03: [retrieval_preprocessing] calculating distances ...
2025-03-09 07:41:06: [retrieval_preprocessing] finished and saved retrieval indices for episode 34830 [episode count 3/20]
[retrieval_preprocessing] for episode 69137 [episode count 4/20], we have num_retrieval=np.int64(13670) num_query=np.int64(659)
2025-03-09 07:41:11,427 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-09 07:41:13,544 [INFO]: Launching the whole pipeline 03/09/2025, 07:41:13
2025-03-09 07:41:13,544 [INFO]: Reading total number of vectors and dimension 03/09/2025, 07:41:13
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1475.31it/s]
2025-03-09 07:41:13,577 [INFO]: There are 13670 embeddings of dim 49152
2025-03-09 07:41:13,577 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0334 secs
2025-03-09 07:41:13,577 [INFO]: 	Compute estimated construction time of the index 03/09/2025, 07:41:13
2025-03-09 07:41:13,578 [INFO]: 		-> Train: 16.7 minutes
2025-03-09 07:41:13,578 [INFO]: 		-> Add: 7.5 seconds
2025-03-09 07:41:13,578 [INFO]: 		Total: 16.8 minutes
2025-03-09 07:41:13,578 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0001 secs
2025-03-09 07:41:13,578 [INFO]: 	Checking that your have enough memory available to create the index 03/09/2025, 07:41:13
2025-03-09 07:41:13,578 [INFO]: 2.8GB of memory will be needed to build the index (more might be used if you have more)
2025-03-09 07:41:13,578 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0001 secs
2025-03-09 07:41:13,578 [INFO]: 	Selecting most promising index types given data characteristics 03/09/2025, 07:41:13
2025-03-09 07:41:13,578 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-09 07:41:13,578 [INFO]: 	Creating the index 03/09/2025, 07:41:13
2025-03-09 07:41:13,578 [INFO]: 		-> Instanciate the index HNSW32 03/09/2025, 07:41:13
2025-03-09 07:41:13,579 [INFO]: 		>>> Finished "-> Instanciate the index HNSW32" in 0.0010 secs
2025-03-09 07:41:13,579 [INFO]: 		-> Adding the vectors to the index 03/09/2025, 07:41:13
2025-03-09 07:41:13,579 [INFO]: The memory available for adding the vectors is 47.5GB(total available - used by the index)
2025-03-09 07:41:13,579 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/56 [00:00<?, ?it/s]  2%|▏         | 1/56 [00:00<00:13,  4.07it/s]  4%|▎         | 2/56 [00:00<00:09,  6.00it/s]  5%|▌         | 3/56 [00:00<00:07,  6.90it/s]  7%|▋         | 4/56 [00:00<00:06,  7.53it/s]  9%|▉         | 5/56 [00:00<00:06,  7.94it/s] 11%|█         | 6/56 [00:00<00:06,  8.18it/s] 12%|█▎        | 7/56 [00:00<00:05,  8.17it/s] 14%|█▍        | 8/56 [00:01<00:05,  8.09it/s] 16%|█▌        | 9/56 [00:01<00:05,  8.21it/s] 18%|█▊        | 10/56 [00:01<00:05,  8.45it/s] 20%|█▉        | 11/56 [00:01<00:05,  8.82it/s] 21%|██▏       | 12/56 [00:01<00:05,  8.74it/s] 23%|██▎       | 13/56 [00:01<00:05,  8.58it/s] 25%|██▌       | 14/56 [00:01<00:04,  8.42it/s] 27%|██▋       | 15/56 [00:01<00:04,  8.32it/s] 29%|██▊       | 16/56 [00:02<00:04,  8.35it/s] 30%|███       | 17/56 [00:02<00:04,  8.35it/s] 32%|███▏      | 18/56 [00:02<00:04,  8.29it/s] 34%|███▍      | 19/56 [00:02<00:04,  8.28it/s] 36%|███▌      | 20/56 [00:02<00:04,  8.36it/s] 38%|███▊      | 21/56 [00:08<01:03,  1.82s/it] 41%|████      | 23/56 [00:08<00:33,  1.02s/it] 45%|████▍     | 25/56 [00:08<00:20,  1.54it/s] 48%|████▊     | 27/56 [00:08<00:12,  2.25it/s] 52%|█████▏    | 29/56 [00:08<00:08,  3.12it/s] 55%|█████▌    | 31/56 [00:09<00:06,  4.14it/s] 59%|█████▉    | 33/56 [00:09<00:04,  5.29it/s] 62%|██████▎   | 35/56 [00:09<00:03,  6.42it/s] 66%|██████▌   | 37/56 [00:09<00:02,  7.54it/s] 70%|██████▉   | 39/56 [00:09<00:01,  8.55it/s] 73%|███████▎  | 41/56 [00:09<00:01,  9.43it/s] 77%|███████▋  | 43/56 [00:17<00:14,  1.15s/it] 80%|████████  | 45/56 [00:17<00:09,  1.22it/s] 84%|████████▍ | 47/56 [00:17<00:05,  1.65it/s] 88%|████████▊ | 49/56 [00:17<00:03,  2.21it/s] 91%|█████████ | 51/56 [00:17<00:01,  2.91it/s] 95%|█████████▍| 53/56 [00:17<00:00,  3.74it/s] 98%|█████████▊| 55/56 [00:18<00:00,  4.66it/s]100%|██████████| 56/56 [00:24<00:00,  2.29it/s]
2025-03-09 07:41:38,010 [INFO]: 	Computing best hyperparameters for index knn.index 03/09/2025, 07:41:38
2025-03-09 07:43:14,985 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 96.9748 secs
2025-03-09 07:43:14,985 [INFO]: The best hyperparameters are: efSearch=132
2025-03-09 07:43:14,985 [INFO]: 	Compute fast metrics 03/09/2025, 07:43:14
  0%|          | 0/4 [00:00<?, ?it/s] 25%|██▌       | 1/4 [00:00<00:00,  5.38it/s] 50%|█████     | 2/4 [00:00<00:00,  6.88it/s] 75%|███████▌  | 3/4 [00:00<00:00,  7.56it/s] 75%|███████▌  | 3/4 [00:00<00:00,  5.64it/s]
2025-03-09 07:43:35,681 [INFO]: 	>>> Finished "Compute fast metrics" in 20.6952 secs
2025-03-09 07:43:35,683 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 142.1040 secs
2025-03-09 07:43:35,683 [INFO]: {
2025-03-09 07:43:35,683 [INFO]: 	index_key: HNSW32
2025-03-09 07:43:35,683 [INFO]: 	index_param: efSearch=132
2025-03-09 07:43:35,683 [INFO]: 	index_path: knn.index
2025-03-09 07:43:35,683 [INFO]: 	size in bytes: 2691350186
2025-03-09 07:43:35,683 [INFO]: 	avg_search_speed_ms: 11.7096352326603
2025-03-09 07:43:35,683 [INFO]: 	99p_search_speed_ms: 18.944800004828725
2025-03-09 07:43:35,683 [INFO]: 	reconstruction error %: 0.0
2025-03-09 07:43:35,683 [INFO]: 	nb vectors: 13670
2025-03-09 07:43:35,683 [INFO]: 	vectors dimension: 49152
2025-03-09 07:43:35,683 [INFO]: 	compression ratio: 0.9986182303516856
2025-03-09 07:43:35,683 [INFO]: }
2025-03-09 07:43:35,684 [INFO]: 	>>> Finished "Creating the index" in 142.1056 secs
2025-03-09 07:43:35,684 [INFO]: >>> Finished "Launching the whole pipeline" in 142.1395 secs
2025-03-09 07:43:38: [retrieval_preprocessing] calculating distances ...
2025-03-09 07:43:41: [retrieval_preprocessing] finished and saved retrieval indices for episode 69137 [episode count 4/20]
[retrieval_preprocessing] for episode 40475 [episode count 5/20], we have num_retrieval=np.int64(13663) num_query=np.int64(666)
2025-03-09 07:43:46,268 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-09 07:43:48,477 [INFO]: Launching the whole pipeline 03/09/2025, 07:43:48
2025-03-09 07:43:48,477 [INFO]: Reading total number of vectors and dimension 03/09/2025, 07:43:48
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1406.07it/s]
2025-03-09 07:43:48,505 [INFO]: There are 13663 embeddings of dim 49152
2025-03-09 07:43:48,505 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0281 secs
2025-03-09 07:43:48,505 [INFO]: 	Compute estimated construction time of the index 03/09/2025, 07:43:48
2025-03-09 07:43:48,506 [INFO]: 		-> Train: 16.7 minutes
2025-03-09 07:43:48,506 [INFO]: 		-> Add: 7.5 seconds
2025-03-09 07:43:48,506 [INFO]: 		Total: 16.8 minutes
2025-03-09 07:43:48,506 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0001 secs
2025-03-09 07:43:48,506 [INFO]: 	Checking that your have enough memory available to create the index 03/09/2025, 07:43:48
2025-03-09 07:43:48,506 [INFO]: 2.8GB of memory will be needed to build the index (more might be used if you have more)
2025-03-09 07:43:48,506 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0002 secs
2025-03-09 07:43:48,506 [INFO]: 	Selecting most promising index types given data characteristics 03/09/2025, 07:43:48
2025-03-09 07:43:48,506 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-09 07:43:48,506 [INFO]: 	Creating the index 03/09/2025, 07:43:48
2025-03-09 07:43:48,506 [INFO]: 		-> Instanciate the index HNSW32 03/09/2025, 07:43:48
2025-03-09 07:43:48,507 [INFO]: 		>>> Finished "-> Instanciate the index HNSW32" in 0.0011 secs
2025-03-09 07:43:48,507 [INFO]: 		-> Adding the vectors to the index 03/09/2025, 07:43:48
2025-03-09 07:43:48,508 [INFO]: The memory available for adding the vectors is 47.5GB(total available - used by the index)
2025-03-09 07:43:48,508 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/56 [00:00<?, ?it/s]  2%|▏         | 1/56 [00:00<00:15,  3.59it/s]  5%|▌         | 3/56 [00:00<00:07,  7.28it/s]  9%|▉         | 5/56 [00:00<00:05,  8.76it/s] 12%|█▎        | 7/56 [00:00<00:05,  9.72it/s] 16%|█▌        | 9/56 [00:00<00:04, 11.25it/s] 20%|█▉        | 11/56 [00:01<00:04,  9.67it/s] 23%|██▎       | 13/56 [00:01<00:04, 10.54it/s] 27%|██▋       | 15/56 [00:01<00:03, 12.03it/s] 30%|███       | 17/56 [00:01<00:02, 13.15it/s] 34%|███▍      | 19/56 [00:01<00:02, 14.24it/s] 38%|███▊      | 21/56 [00:08<00:39,  1.13s/it] 41%|████      | 23/56 [00:08<00:27,  1.22it/s] 45%|████▍     | 25/56 [00:09<00:18,  1.67it/s] 48%|████▊     | 27/56 [00:09<00:13,  2.23it/s] 52%|█████▏    | 29/56 [00:09<00:09,  2.91it/s] 55%|█████▌    | 31/56 [00:09<00:06,  3.72it/s] 61%|██████    | 34/56 [00:09<00:03,  5.60it/s] 66%|██████▌   | 37/56 [00:09<00:02,  7.79it/s] 71%|███████▏  | 40/56 [00:10<00:01, 10.00it/s] 75%|███████▌  | 42/56 [00:18<00:15,  1.09s/it] 79%|███████▊  | 44/56 [00:18<00:10,  1.20it/s] 82%|████████▏ | 46/56 [00:18<00:06,  1.57it/s] 86%|████████▌ | 48/56 [00:19<00:03,  2.05it/s] 89%|████████▉ | 50/56 [00:19<00:02,  2.68it/s] 93%|█████████▎| 52/56 [00:19<00:01,  3.49it/s] 96%|█████████▋| 54/56 [00:19<00:00,  4.46it/s]100%|██████████| 56/56 [00:26<00:00,  1.22s/it]100%|██████████| 56/56 [00:26<00:00,  2.10it/s]
2025-03-09 07:44:15,231 [INFO]: 	Computing best hyperparameters for index knn.index 03/09/2025, 07:44:15
2025-03-09 07:46:03,109 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 107.8775 secs
2025-03-09 07:46:03,109 [INFO]: The best hyperparameters are: efSearch=100
2025-03-09 07:46:03,110 [INFO]: 	Compute fast metrics 03/09/2025, 07:46:03
  0%|          | 0/4 [00:00<?, ?it/s] 25%|██▌       | 1/4 [00:00<00:00,  5.59it/s] 75%|███████▌  | 3/4 [00:00<00:00,  9.08it/s] 75%|███████▌  | 3/4 [00:00<00:00,  6.91it/s]
2025-03-09 07:46:23,549 [INFO]: 	>>> Finished "Compute fast metrics" in 20.4390 secs
2025-03-09 07:46:23,551 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 155.0436 secs
2025-03-09 07:46:23,551 [INFO]: {
2025-03-09 07:46:23,551 [INFO]: 	index_key: HNSW32
2025-03-09 07:46:23,551 [INFO]: 	index_param: efSearch=100
2025-03-09 07:46:23,551 [INFO]: 	index_path: knn.index
2025-03-09 07:46:23,551 [INFO]: 	size in bytes: 2689972054
2025-03-09 07:46:23,552 [INFO]: 	avg_search_speed_ms: 10.988686211243435
2025-03-09 07:46:23,552 [INFO]: 	99p_search_speed_ms: 21.13933935994281
2025-03-09 07:46:23,552 [INFO]: 	reconstruction error %: 0.0
2025-03-09 07:46:23,552 [INFO]: 	nb vectors: 13663
2025-03-09 07:46:23,552 [INFO]: 	vectors dimension: 49152
2025-03-09 07:46:23,552 [INFO]: 	compression ratio: 0.99861821984564
2025-03-09 07:46:23,552 [INFO]: }
2025-03-09 07:46:23,552 [INFO]: 	>>> Finished "Creating the index" in 155.0454 secs
2025-03-09 07:46:23,552 [INFO]: >>> Finished "Launching the whole pipeline" in 155.0744 secs
2025-03-09 07:46:25: [retrieval_preprocessing] calculating distances ...
2025-03-09 07:46:27: [retrieval_preprocessing] finished and saved retrieval indices for episode 40475 [episode count 5/20]
[retrieval_preprocessing] for episode 67099 [episode count 6/20], we have num_retrieval=np.int64(13549) num_query=np.int64(780)
2025-03-09 07:46:31,246 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-09 07:46:33,159 [INFO]: Launching the whole pipeline 03/09/2025, 07:46:33
2025-03-09 07:46:33,159 [INFO]: Reading total number of vectors and dimension 03/09/2025, 07:46:33
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1497.43it/s]
2025-03-09 07:46:33,185 [INFO]: There are 13549 embeddings of dim 49152
2025-03-09 07:46:33,186 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0263 secs
2025-03-09 07:46:33,186 [INFO]: 	Compute estimated construction time of the index 03/09/2025, 07:46:33
2025-03-09 07:46:33,186 [INFO]: 		-> Train: 16.7 minutes
2025-03-09 07:46:33,186 [INFO]: 		-> Add: 7.4 seconds
2025-03-09 07:46:33,186 [INFO]: 		Total: 16.8 minutes
2025-03-09 07:46:33,186 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0001 secs
2025-03-09 07:46:33,186 [INFO]: 	Checking that your have enough memory available to create the index 03/09/2025, 07:46:33
2025-03-09 07:46:33,186 [INFO]: 2.7GB of memory will be needed to build the index (more might be used if you have more)
2025-03-09 07:46:33,186 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0002 secs
2025-03-09 07:46:33,186 [INFO]: 	Selecting most promising index types given data characteristics 03/09/2025, 07:46:33
2025-03-09 07:46:33,186 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-09 07:46:33,186 [INFO]: 	Creating the index 03/09/2025, 07:46:33
2025-03-09 07:46:33,186 [INFO]: 		-> Instanciate the index HNSW32 03/09/2025, 07:46:33
2025-03-09 07:46:33,187 [INFO]: 		>>> Finished "-> Instanciate the index HNSW32" in 0.0011 secs
2025-03-09 07:46:33,187 [INFO]: 		-> Adding the vectors to the index 03/09/2025, 07:46:33
2025-03-09 07:46:33,187 [INFO]: The memory available for adding the vectors is 47.5GB(total available - used by the index)
2025-03-09 07:46:33,187 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/56 [00:00<?, ?it/s]  2%|▏         | 1/56 [00:00<00:13,  4.06it/s]  5%|▌         | 3/56 [00:00<00:07,  7.20it/s]  7%|▋         | 4/56 [00:00<00:06,  7.60it/s]  9%|▉         | 5/56 [00:00<00:06,  7.86it/s] 11%|█         | 6/56 [00:00<00:06,  8.06it/s] 12%|█▎        | 7/56 [00:00<00:06,  8.12it/s] 14%|█▍        | 8/56 [00:01<00:05,  8.33it/s] 16%|█▌        | 9/56 [00:01<00:05,  8.40it/s] 18%|█▊        | 10/56 [00:01<00:05,  8.42it/s] 20%|█▉        | 11/56 [00:01<00:05,  8.39it/s] 21%|██▏       | 12/56 [00:01<00:05,  8.32it/s] 23%|██▎       | 13/56 [00:01<00:05,  8.46it/s] 25%|██▌       | 14/56 [00:01<00:04,  8.46it/s] 27%|██▋       | 15/56 [00:01<00:04,  8.48it/s] 29%|██▊       | 16/56 [00:01<00:04,  8.43it/s] 30%|███       | 17/56 [00:02<00:04,  8.42it/s] 32%|███▏      | 18/56 [00:02<00:04,  8.53it/s] 34%|███▍      | 19/56 [00:02<00:04,  8.49it/s] 36%|███▌      | 20/56 [00:02<00:04,  8.47it/s] 38%|███▊      | 21/56 [00:08<01:05,  1.86s/it] 41%|████      | 23/56 [00:08<00:34,  1.04s/it] 45%|████▍     | 25/56 [00:08<00:20,  1.51it/s] 48%|████▊     | 27/56 [00:08<00:13,  2.22it/s] 52%|█████▏    | 29/56 [00:09<00:08,  3.11it/s] 55%|█████▌    | 31/56 [00:09<00:06,  4.13it/s] 59%|█████▉    | 33/56 [00:09<00:04,  5.23it/s] 62%|██████▎   | 35/56 [00:09<00:03,  6.45it/s] 66%|██████▌   | 37/56 [00:09<00:02,  7.85it/s] 70%|██████▉   | 39/56 [00:09<00:01,  9.33it/s] 73%|███████▎  | 41/56 [00:09<00:01, 10.67it/s] 77%|███████▋  | 43/56 [00:17<00:15,  1.20s/it] 80%|████████  | 45/56 [00:17<00:09,  1.16it/s] 84%|████████▍ | 47/56 [00:17<00:05,  1.58it/s] 88%|████████▊ | 49/56 [00:17<00:03,  2.12it/s] 91%|█████████ | 51/56 [00:18<00:01,  2.69it/s] 95%|█████████▍| 53/56 [00:18<00:00,  3.60it/s] 98%|█████████▊| 55/56 [00:18<00:00,  4.69it/s]100%|██████████| 56/56 [00:26<00:00,  2.13it/s]
2025-03-09 07:46:59,466 [INFO]: 	Computing best hyperparameters for index knn.index 03/09/2025, 07:46:59
2025-03-09 07:48:40,662 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 101.1948 secs
2025-03-09 07:48:40,662 [INFO]: The best hyperparameters are: efSearch=131
2025-03-09 07:48:40,662 [INFO]: 	Compute fast metrics 03/09/2025, 07:48:40
  0%|          | 0/4 [00:00<?, ?it/s] 25%|██▌       | 1/4 [00:00<00:00,  5.39it/s] 50%|█████     | 2/4 [00:00<00:00,  6.81it/s] 75%|███████▌  | 3/4 [00:00<00:00,  7.63it/s] 75%|███████▌  | 3/4 [00:00<00:00,  5.69it/s]
2025-03-09 07:49:05,989 [INFO]: 	>>> Finished "Compute fast metrics" in 25.3267 secs
2025-03-09 07:49:05,992 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 152.8042 secs
2025-03-09 07:49:05,992 [INFO]: {
2025-03-09 07:49:05,992 [INFO]: 	index_key: HNSW32
2025-03-09 07:49:05,992 [INFO]: 	index_param: efSearch=131
2025-03-09 07:49:05,992 [INFO]: 	index_path: knn.index
2025-03-09 07:49:05,992 [INFO]: 	size in bytes: 2667527806
2025-03-09 07:49:05,992 [INFO]: 	avg_search_speed_ms: 11.576190521602122
2025-03-09 07:49:05,992 [INFO]: 	99p_search_speed_ms: 20.70821421220899
2025-03-09 07:49:05,992 [INFO]: 	reconstruction error %: 0.0
2025-03-09 07:49:05,992 [INFO]: 	nb vectors: 13549
2025-03-09 07:49:05,992 [INFO]: 	vectors dimension: 49152
2025-03-09 07:49:05,992 [INFO]: 	compression ratio: 0.9986181909737889
2025-03-09 07:49:05,992 [INFO]: }
2025-03-09 07:49:05,992 [INFO]: 	>>> Finished "Creating the index" in 152.8059 secs
2025-03-09 07:49:05,992 [INFO]: >>> Finished "Launching the whole pipeline" in 152.8328 secs
2025-03-09 07:49:09: [retrieval_preprocessing] calculating distances ...
2025-03-09 07:49:12: [retrieval_preprocessing] finished and saved retrieval indices for episode 67099 [episode count 6/20]
[retrieval_preprocessing] for episode 10791 [episode count 7/20], we have num_retrieval=np.int64(13636) num_query=np.int64(693)
2025-03-09 07:49:16,487 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-09 07:49:18,547 [INFO]: Launching the whole pipeline 03/09/2025, 07:49:18
2025-03-09 07:49:18,547 [INFO]: Reading total number of vectors and dimension 03/09/2025, 07:49:18
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1795.51it/s]
2025-03-09 07:49:18,573 [INFO]: There are 13636 embeddings of dim 49152
2025-03-09 07:49:18,573 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0255 secs
2025-03-09 07:49:18,573 [INFO]: 	Compute estimated construction time of the index 03/09/2025, 07:49:18
2025-03-09 07:49:18,573 [INFO]: 		-> Train: 16.7 minutes
2025-03-09 07:49:18,573 [INFO]: 		-> Add: 7.5 seconds
2025-03-09 07:49:18,573 [INFO]: 		Total: 16.8 minutes
2025-03-09 07:49:18,573 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0001 secs
2025-03-09 07:49:18,573 [INFO]: 	Checking that your have enough memory available to create the index 03/09/2025, 07:49:18
2025-03-09 07:49:18,573 [INFO]: 2.8GB of memory will be needed to build the index (more might be used if you have more)
2025-03-09 07:49:18,573 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0002 secs
2025-03-09 07:49:18,573 [INFO]: 	Selecting most promising index types given data characteristics 03/09/2025, 07:49:18
2025-03-09 07:49:18,573 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-09 07:49:18,573 [INFO]: 	Creating the index 03/09/2025, 07:49:18
2025-03-09 07:49:18,573 [INFO]: 		-> Instanciate the index HNSW32 03/09/2025, 07:49:18
2025-03-09 07:49:18,574 [INFO]: 		>>> Finished "-> Instanciate the index HNSW32" in 0.0010 secs
2025-03-09 07:49:18,575 [INFO]: 		-> Adding the vectors to the index 03/09/2025, 07:49:18
2025-03-09 07:49:18,575 [INFO]: The memory available for adding the vectors is 47.5GB(total available - used by the index)
2025-03-09 07:49:18,575 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/56 [00:00<?, ?it/s]  2%|▏         | 1/56 [00:00<00:11,  4.99it/s] 12%|█▎        | 7/56 [00:00<00:01, 25.81it/s] 23%|██▎       | 13/56 [00:00<00:01, 36.20it/s] 34%|███▍      | 19/56 [00:00<00:00, 42.19it/s] 43%|████▎     | 24/56 [00:06<00:12,  2.51it/s] 52%|█████▏    | 29/56 [00:06<00:07,  3.65it/s] 61%|██████    | 34/56 [00:06<00:04,  5.16it/s] 68%|██████▊   | 38/56 [00:06<00:02,  6.72it/s] 75%|███████▌  | 42/56 [00:14<00:09,  1.55it/s] 80%|████████  | 45/56 [00:14<00:05,  1.97it/s] 86%|████████▌ | 48/56 [00:14<00:03,  2.48it/s] 91%|█████████ | 51/56 [00:14<00:01,  3.13it/s]100%|██████████| 56/56 [00:20<00:00,  1.55it/s]100%|██████████| 56/56 [00:20<00:00,  2.71it/s]
2025-03-09 07:49:39,256 [INFO]: 	Computing best hyperparameters for index knn.index 03/09/2025, 07:49:39
2025-03-09 07:51:08,934 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 89.6778 secs
2025-03-09 07:51:08,934 [INFO]: The best hyperparameters are: efSearch=152
2025-03-09 07:51:08,934 [INFO]: 	Compute fast metrics 03/09/2025, 07:51:08
  0%|          | 0/4 [00:00<?, ?it/s] 25%|██▌       | 1/4 [00:00<00:00,  4.43it/s] 50%|█████     | 2/4 [00:00<00:00,  5.94it/s] 75%|███████▌  | 3/4 [00:00<00:00,  5.90it/s]
2025-03-09 07:51:42,601 [INFO]: 	>>> Finished "Compute fast metrics" in 33.6671 secs
2025-03-09 07:51:42,604 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 144.0290 secs
2025-03-09 07:51:42,604 [INFO]: {
2025-03-09 07:51:42,604 [INFO]: 	index_key: HNSW32
2025-03-09 07:51:42,604 [INFO]: 	index_param: efSearch=152
2025-03-09 07:51:42,604 [INFO]: 	index_path: knn.index
2025-03-09 07:51:42,604 [INFO]: 	size in bytes: 2684656402
2025-03-09 07:51:42,604 [INFO]: 	avg_search_speed_ms: 12.083495180021323
2025-03-09 07:51:42,604 [INFO]: 	99p_search_speed_ms: 20.37076511187479
2025-03-09 07:51:42,604 [INFO]: 	reconstruction error %: 0.0
2025-03-09 07:51:42,604 [INFO]: 	nb vectors: 13636
2025-03-09 07:51:42,604 [INFO]: 	vectors dimension: 49152
2025-03-09 07:51:42,604 [INFO]: 	compression ratio: 0.9986181792212827
2025-03-09 07:51:42,604 [INFO]: }
2025-03-09 07:51:42,604 [INFO]: 	>>> Finished "Creating the index" in 144.0304 secs
2025-03-09 07:51:42,604 [INFO]: >>> Finished "Launching the whole pipeline" in 144.0566 secs
2025-03-09 07:51:45: [retrieval_preprocessing] calculating distances ...
2025-03-09 07:51:49: [retrieval_preprocessing] finished and saved retrieval indices for episode 10791 [episode count 7/20]
[retrieval_preprocessing] for episode 3629 [episode count 8/20], we have num_retrieval=np.int64(13701) num_query=np.int64(628)
2025-03-09 07:51:55,467 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-09 07:51:57,308 [INFO]: Launching the whole pipeline 03/09/2025, 07:51:57
2025-03-09 07:51:57,309 [INFO]: Reading total number of vectors and dimension 03/09/2025, 07:51:57
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1452.82it/s]
2025-03-09 07:51:57,335 [INFO]: There are 13701 embeddings of dim 49152
2025-03-09 07:51:57,335 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0266 secs
2025-03-09 07:51:57,335 [INFO]: 	Compute estimated construction time of the index 03/09/2025, 07:51:57
2025-03-09 07:51:57,335 [INFO]: 		-> Train: 16.7 minutes
2025-03-09 07:51:57,335 [INFO]: 		-> Add: 7.5 seconds
2025-03-09 07:51:57,335 [INFO]: 		Total: 16.8 minutes
2025-03-09 07:51:57,335 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0001 secs
2025-03-09 07:51:57,335 [INFO]: 	Checking that your have enough memory available to create the index 03/09/2025, 07:51:57
2025-03-09 07:51:57,336 [INFO]: 2.8GB of memory will be needed to build the index (more might be used if you have more)
2025-03-09 07:51:57,336 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0002 secs
2025-03-09 07:51:57,336 [INFO]: 	Selecting most promising index types given data characteristics 03/09/2025, 07:51:57
2025-03-09 07:51:57,336 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-09 07:51:57,336 [INFO]: 	Creating the index 03/09/2025, 07:51:57
2025-03-09 07:51:57,336 [INFO]: 		-> Instanciate the index HNSW32 03/09/2025, 07:51:57
2025-03-09 07:51:57,337 [INFO]: 		>>> Finished "-> Instanciate the index HNSW32" in 0.0012 secs
2025-03-09 07:51:57,337 [INFO]: 		-> Adding the vectors to the index 03/09/2025, 07:51:57
2025-03-09 07:51:57,337 [INFO]: The memory available for adding the vectors is 47.5GB(total available - used by the index)
2025-03-09 07:51:57,337 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/56 [00:00<?, ?it/s]  2%|▏         | 1/56 [00:00<00:12,  4.33it/s]  5%|▌         | 3/56 [00:00<00:06,  8.16it/s]  9%|▉         | 5/56 [00:00<00:05,  9.75it/s] 12%|█▎        | 7/56 [00:00<00:04, 10.69it/s] 16%|█▌        | 9/56 [00:00<00:04, 11.18it/s] 20%|█▉        | 11/56 [00:01<00:03, 11.50it/s] 23%|██▎       | 13/56 [00:01<00:03, 11.62it/s] 27%|██▋       | 15/56 [00:01<00:03, 11.75it/s] 30%|███       | 17/56 [00:01<00:03, 11.86it/s] 34%|███▍      | 19/56 [00:01<00:03, 11.88it/s] 38%|███▊      | 21/56 [00:07<00:33,  1.04it/s] 39%|███▉      | 22/56 [00:07<00:27,  1.24it/s] 43%|████▎     | 24/56 [00:07<00:17,  1.78it/s] 46%|████▋     | 26/56 [00:08<00:12,  2.47it/s] 50%|█████     | 28/56 [00:08<00:08,  3.31it/s] 54%|█████▎    | 30/56 [00:08<00:06,  4.27it/s] 57%|█████▋    | 32/56 [00:08<00:04,  5.31it/s] 61%|██████    | 34/56 [00:08<00:03,  6.36it/s] 64%|██████▍   | 36/56 [00:08<00:02,  7.33it/s] 68%|██████▊   | 38/56 [00:09<00:02,  8.25it/s] 71%|███████▏  | 40/56 [00:09<00:02,  7.78it/s] 75%|███████▌  | 42/56 [00:16<00:17,  1.24s/it] 79%|███████▊  | 44/56 [00:17<00:10,  1.12it/s] 82%|████████▏ | 46/56 [00:17<00:06,  1.55it/s] 86%|████████▌ | 48/56 [00:17<00:03,  2.12it/s] 89%|████████▉ | 50/56 [00:17<00:02,  2.86it/s] 93%|█████████▎| 52/56 [00:17<00:01,  3.77it/s] 96%|█████████▋| 54/56 [00:17<00:00,  4.72it/s]100%|██████████| 56/56 [00:24<00:00,  1.19s/it]100%|██████████| 56/56 [00:24<00:00,  2.26it/s]
2025-03-09 07:52:22,180 [INFO]: 	Computing best hyperparameters for index knn.index 03/09/2025, 07:52:22
2025-03-09 07:54:03,659 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 101.4787 secs
2025-03-09 07:54:03,660 [INFO]: The best hyperparameters are: efSearch=152
2025-03-09 07:54:03,660 [INFO]: 	Compute fast metrics 03/09/2025, 07:54:03
  0%|          | 0/4 [00:00<?, ?it/s] 25%|██▌       | 1/4 [00:00<00:00,  5.29it/s] 50%|█████     | 2/4 [00:00<00:00,  6.90it/s] 75%|███████▌  | 3/4 [00:00<00:00,  7.71it/s] 75%|███████▌  | 3/4 [00:00<00:00,  5.79it/s]
2025-03-09 07:54:29,005 [INFO]: 	>>> Finished "Compute fast metrics" in 25.3450 secs
2025-03-09 07:54:29,007 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 151.6702 secs
2025-03-09 07:54:29,008 [INFO]: {
2025-03-09 07:54:29,008 [INFO]: 	index_key: HNSW32
2025-03-09 07:54:29,008 [INFO]: 	index_param: efSearch=152
2025-03-09 07:54:29,008 [INFO]: 	index_path: knn.index
2025-03-09 07:54:29,008 [INFO]: 	size in bytes: 2697453470
2025-03-09 07:54:29,008 [INFO]: 	avg_search_speed_ms: 13.97669276023575
2025-03-09 07:54:29,008 [INFO]: 	99p_search_speed_ms: 25.630457454826722
2025-03-09 07:54:29,008 [INFO]: 	reconstruction error %: 0.0
2025-03-09 07:54:29,008 [INFO]: 	nb vectors: 13701
2025-03-09 07:54:29,008 [INFO]: 	vectors dimension: 49152
2025-03-09 07:54:29,008 [INFO]: 	compression ratio: 0.998618229362822
2025-03-09 07:54:29,008 [INFO]: }
2025-03-09 07:54:29,008 [INFO]: 	>>> Finished "Creating the index" in 151.6719 secs
2025-03-09 07:54:29,008 [INFO]: >>> Finished "Launching the whole pipeline" in 151.6993 secs
2025-03-09 07:54:32: [retrieval_preprocessing] calculating distances ...
2025-03-09 07:54:35: [retrieval_preprocessing] finished and saved retrieval indices for episode 3629 [episode count 8/20]
[retrieval_preprocessing] for episode 66095 [episode count 9/20], we have num_retrieval=np.int64(13513) num_query=np.int64(816)
2025-03-09 07:54:39,721 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-09 07:54:41,653 [INFO]: Launching the whole pipeline 03/09/2025, 07:54:41
2025-03-09 07:54:41,653 [INFO]: Reading total number of vectors and dimension 03/09/2025, 07:54:41
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1464.49it/s]
2025-03-09 07:54:41,679 [INFO]: There are 13513 embeddings of dim 49152
2025-03-09 07:54:41,679 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0257 secs
2025-03-09 07:54:41,679 [INFO]: 	Compute estimated construction time of the index 03/09/2025, 07:54:41
2025-03-09 07:54:41,679 [INFO]: 		-> Train: 16.7 minutes
2025-03-09 07:54:41,679 [INFO]: 		-> Add: 7.4 seconds
2025-03-09 07:54:41,679 [INFO]: 		Total: 16.8 minutes
2025-03-09 07:54:41,679 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0001 secs
2025-03-09 07:54:41,679 [INFO]: 	Checking that your have enough memory available to create the index 03/09/2025, 07:54:41
2025-03-09 07:54:41,679 [INFO]: 2.7GB of memory will be needed to build the index (more might be used if you have more)
2025-03-09 07:54:41,679 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0002 secs
2025-03-09 07:54:41,679 [INFO]: 	Selecting most promising index types given data characteristics 03/09/2025, 07:54:41
2025-03-09 07:54:41,680 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-09 07:54:41,680 [INFO]: 	Creating the index 03/09/2025, 07:54:41
2025-03-09 07:54:41,680 [INFO]: 		-> Instanciate the index HNSW32 03/09/2025, 07:54:41
2025-03-09 07:54:41,681 [INFO]: 		>>> Finished "-> Instanciate the index HNSW32" in 0.0009 secs
2025-03-09 07:54:41,681 [INFO]: 		-> Adding the vectors to the index 03/09/2025, 07:54:41
2025-03-09 07:54:41,681 [INFO]: The memory available for adding the vectors is 47.5GB(total available - used by the index)
2025-03-09 07:54:41,681 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/56 [00:00<?, ?it/s]  2%|▏         | 1/56 [00:00<00:13,  4.17it/s]  5%|▌         | 3/56 [00:00<00:06,  8.06it/s]  9%|▉         | 5/56 [00:00<00:05,  9.64it/s] 12%|█▎        | 7/56 [00:00<00:04, 10.43it/s] 16%|█▌        | 9/56 [00:00<00:04, 10.85it/s] 20%|█▉        | 11/56 [00:01<00:04, 11.02it/s] 23%|██▎       | 13/56 [00:01<00:04, 10.69it/s] 27%|██▋       | 15/56 [00:01<00:03, 11.84it/s] 30%|███       | 17/56 [00:01<00:02, 13.49it/s] 34%|███▍      | 19/56 [00:01<00:02, 14.81it/s] 38%|███▊      | 21/56 [00:07<00:32,  1.06it/s] 41%|████      | 23/56 [00:07<00:22,  1.47it/s] 45%|████▍     | 25/56 [00:07<00:15,  2.00it/s] 48%|████▊     | 27/56 [00:07<00:10,  2.71it/s] 52%|█████▏    | 29/56 [00:08<00:07,  3.58it/s] 55%|█████▌    | 31/56 [00:08<00:05,  4.53it/s] 59%|█████▉    | 33/56 [00:08<00:04,  5.53it/s] 62%|██████▎   | 35/56 [00:08<00:03,  6.61it/s] 66%|██████▌   | 37/56 [00:08<00:02,  7.72it/s] 70%|██████▉   | 39/56 [00:08<00:01,  8.72it/s] 73%|███████▎  | 41/56 [00:09<00:01, 10.12it/s] 77%|███████▋  | 43/56 [00:15<00:14,  1.11s/it] 80%|████████  | 45/56 [00:16<00:08,  1.25it/s] 84%|████████▍ | 47/56 [00:16<00:05,  1.72it/s] 88%|████████▊ | 49/56 [00:16<00:02,  2.34it/s] 91%|█████████ | 51/56 [00:16<00:01,  3.15it/s] 95%|█████████▍| 53/56 [00:16<00:00,  4.05it/s] 98%|█████████▊| 55/56 [00:16<00:00,  5.07it/s]100%|██████████| 56/56 [00:22<00:00,  2.46it/s]
2025-03-09 07:55:04,438 [INFO]: 	Computing best hyperparameters for index knn.index 03/09/2025, 07:55:04
2025-03-09 07:56:39,577 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 95.1379 secs
2025-03-09 07:56:39,577 [INFO]: The best hyperparameters are: efSearch=141
2025-03-09 07:56:39,577 [INFO]: 	Compute fast metrics 03/09/2025, 07:56:39
  0%|          | 0/4 [00:00<?, ?it/s] 25%|██▌       | 1/4 [00:00<00:00,  5.12it/s] 50%|█████     | 2/4 [00:00<00:00,  6.80it/s] 75%|███████▌  | 3/4 [00:00<00:00,  7.52it/s] 75%|███████▌  | 3/4 [00:00<00:00,  5.66it/s]
2025-03-09 07:57:10,259 [INFO]: 	>>> Finished "Compute fast metrics" in 30.6811 secs
2025-03-09 07:57:10,261 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 148.5806 secs
2025-03-09 07:57:10,261 [INFO]: {
2025-03-09 07:57:10,261 [INFO]: 	index_key: HNSW32
2025-03-09 07:57:10,261 [INFO]: 	index_param: efSearch=141
2025-03-09 07:57:10,261 [INFO]: 	index_path: knn.index
2025-03-09 07:57:10,261 [INFO]: 	size in bytes: 2660440014
2025-03-09 07:57:10,261 [INFO]: 	avg_search_speed_ms: 11.917689929775122
2025-03-09 07:57:10,261 [INFO]: 	99p_search_speed_ms: 21.742398287169635
2025-03-09 07:57:10,261 [INFO]: 	reconstruction error %: 0.0
2025-03-09 07:57:10,261 [INFO]: 	nb vectors: 13513
2025-03-09 07:57:10,261 [INFO]: 	vectors dimension: 49152
2025-03-09 07:57:10,262 [INFO]: 	compression ratio: 0.9986182323297442
2025-03-09 07:57:10,262 [INFO]: }
2025-03-09 07:57:10,262 [INFO]: 	>>> Finished "Creating the index" in 148.5820 secs
2025-03-09 07:57:10,262 [INFO]: >>> Finished "Launching the whole pipeline" in 148.6082 secs
2025-03-09 07:57:14: [retrieval_preprocessing] calculating distances ...
2025-03-09 07:57:17: [retrieval_preprocessing] finished and saved retrieval indices for episode 66095 [episode count 9/20]
[retrieval_preprocessing] for episode 4145 [episode count 10/20], we have num_retrieval=np.int64(13697) num_query=np.int64(632)
2025-03-09 07:57:22,049 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-09 07:57:23,888 [INFO]: Launching the whole pipeline 03/09/2025, 07:57:23
2025-03-09 07:57:23,888 [INFO]: Reading total number of vectors and dimension 03/09/2025, 07:57:23
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1095.40it/s]
2025-03-09 07:57:23,916 [INFO]: There are 13697 embeddings of dim 49152
2025-03-09 07:57:23,916 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0282 secs
2025-03-09 07:57:23,916 [INFO]: 	Compute estimated construction time of the index 03/09/2025, 07:57:23
2025-03-09 07:57:23,917 [INFO]: 		-> Train: 16.7 minutes
2025-03-09 07:57:23,917 [INFO]: 		-> Add: 7.5 seconds
2025-03-09 07:57:23,917 [INFO]: 		Total: 16.8 minutes
2025-03-09 07:57:23,917 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0004 secs
2025-03-09 07:57:23,917 [INFO]: 	Checking that your have enough memory available to create the index 03/09/2025, 07:57:23
2025-03-09 07:57:23,917 [INFO]: 2.8GB of memory will be needed to build the index (more might be used if you have more)
2025-03-09 07:57:23,917 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0004 secs
2025-03-09 07:57:23,917 [INFO]: 	Selecting most promising index types given data characteristics 03/09/2025, 07:57:23
2025-03-09 07:57:23,918 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0001 secs
2025-03-09 07:57:23,918 [INFO]: 	Creating the index 03/09/2025, 07:57:23
2025-03-09 07:57:23,918 [INFO]: 		-> Instanciate the index HNSW32 03/09/2025, 07:57:23
2025-03-09 07:57:23,920 [INFO]: 		>>> Finished "-> Instanciate the index HNSW32" in 0.0019 secs
2025-03-09 07:57:23,920 [INFO]: 		-> Adding the vectors to the index 03/09/2025, 07:57:23
2025-03-09 07:57:23,920 [INFO]: The memory available for adding the vectors is 47.5GB(total available - used by the index)
2025-03-09 07:57:23,920 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/56 [00:00<?, ?it/s]  2%|▏         | 1/56 [00:00<00:12,  4.47it/s]  5%|▌         | 3/56 [00:00<00:06,  8.42it/s]  9%|▉         | 5/56 [00:00<00:05,  9.96it/s] 12%|█▎        | 7/56 [00:00<00:04, 10.84it/s] 16%|█▌        | 9/56 [00:00<00:04, 11.29it/s] 20%|█▉        | 11/56 [00:01<00:03, 11.50it/s] 23%|██▎       | 13/56 [00:01<00:03, 11.57it/s] 27%|██▋       | 15/56 [00:01<00:03, 11.61it/s] 30%|███       | 17/56 [00:01<00:03, 11.56it/s] 34%|███▍      | 19/56 [00:01<00:03, 11.68it/s] 38%|███▊      | 21/56 [00:08<00:36,  1.05s/it] 41%|████      | 23/56 [00:08<00:24,  1.33it/s] 45%|████▍     | 25/56 [00:08<00:17,  1.82it/s] 48%|████▊     | 27/56 [00:08<00:11,  2.45it/s] 52%|█████▏    | 29/56 [00:08<00:08,  3.24it/s] 55%|█████▌    | 31/56 [00:08<00:05,  4.17it/s] 59%|█████▉    | 33/56 [00:09<00:04,  5.25it/s] 62%|██████▎   | 35/56 [00:09<00:03,  6.38it/s] 66%|██████▌   | 37/56 [00:09<00:02,  7.51it/s] 70%|██████▉   | 39/56 [00:09<00:01,  8.64it/s] 73%|███████▎  | 41/56 [00:09<00:01,  9.54it/s] 77%|███████▋  | 43/56 [00:17<00:15,  1.16s/it] 80%|████████  | 45/56 [00:17<00:09,  1.20it/s] 84%|████████▍ | 47/56 [00:17<00:05,  1.65it/s] 88%|████████▊ | 49/56 [00:17<00:03,  2.23it/s] 91%|█████████ | 51/56 [00:17<00:01,  2.92it/s] 95%|█████████▍| 53/56 [00:17<00:00,  3.75it/s] 98%|█████████▊| 55/56 [00:17<00:00,  4.73it/s]100%|██████████| 56/56 [00:24<00:00,  2.31it/s]
2025-03-09 07:57:48,147 [INFO]: 	Computing best hyperparameters for index knn.index 03/09/2025, 07:57:48
2025-03-09 07:59:29,272 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 101.1244 secs
2025-03-09 07:59:29,273 [INFO]: The best hyperparameters are: efSearch=141
2025-03-09 07:59:29,273 [INFO]: 	Compute fast metrics 03/09/2025, 07:59:29
  0%|          | 0/4 [00:00<?, ?it/s] 25%|██▌       | 1/4 [00:00<00:00,  5.28it/s] 50%|█████     | 2/4 [00:00<00:00,  6.89it/s] 75%|███████▌  | 3/4 [00:00<00:00,  7.64it/s] 75%|███████▌  | 3/4 [00:00<00:00,  5.72it/s]
2025-03-09 08:00:06,318 [INFO]: 	>>> Finished "Compute fast metrics" in 37.0447 secs
2025-03-09 08:00:06,321 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 162.4006 secs
2025-03-09 08:00:06,321 [INFO]: {
2025-03-09 08:00:06,321 [INFO]: 	index_key: HNSW32
2025-03-09 08:00:06,321 [INFO]: 	index_param: efSearch=141
2025-03-09 08:00:06,321 [INFO]: 	index_path: knn.index
2025-03-09 08:00:06,321 [INFO]: 	size in bytes: 2696665966
2025-03-09 08:00:06,321 [INFO]: 	avg_search_speed_ms: 12.688398008414445
2025-03-09 08:00:06,321 [INFO]: 	99p_search_speed_ms: 25.501588967163112
2025-03-09 08:00:06,321 [INFO]: 	reconstruction error %: 0.0
2025-03-09 08:00:06,321 [INFO]: 	nb vectors: 13697
2025-03-09 08:00:06,321 [INFO]: 	vectors dimension: 49152
2025-03-09 08:00:06,321 [INFO]: 	compression ratio: 0.9986182233739809
2025-03-09 08:00:06,321 [INFO]: }
2025-03-09 08:00:06,321 [INFO]: 	>>> Finished "Creating the index" in 162.4036 secs
2025-03-09 08:00:06,321 [INFO]: >>> Finished "Launching the whole pipeline" in 162.4334 secs
2025-03-09 08:00:09: [retrieval_preprocessing] calculating distances ...
2025-03-09 08:00:12: [retrieval_preprocessing] finished and saved retrieval indices for episode 4145 [episode count 10/20]
[retrieval_preprocessing] for episode 3123 [episode count 11/20], we have num_retrieval=np.int64(13576) num_query=np.int64(753)
2025-03-09 08:00:17,620 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-09 08:00:19,636 [INFO]: Launching the whole pipeline 03/09/2025, 08:00:19
2025-03-09 08:00:19,636 [INFO]: Reading total number of vectors and dimension 03/09/2025, 08:00:19
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1146.30it/s]
2025-03-09 08:00:19,662 [INFO]: There are 13576 embeddings of dim 49152
2025-03-09 08:00:19,662 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0266 secs
2025-03-09 08:00:19,662 [INFO]: 	Compute estimated construction time of the index 03/09/2025, 08:00:19
2025-03-09 08:00:19,662 [INFO]: 		-> Train: 16.7 minutes
2025-03-09 08:00:19,662 [INFO]: 		-> Add: 7.5 seconds
2025-03-09 08:00:19,662 [INFO]: 		Total: 16.8 minutes
2025-03-09 08:00:19,662 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0001 secs
2025-03-09 08:00:19,663 [INFO]: 	Checking that your have enough memory available to create the index 03/09/2025, 08:00:19
2025-03-09 08:00:19,663 [INFO]: 2.7GB of memory will be needed to build the index (more might be used if you have more)
2025-03-09 08:00:19,663 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0002 secs
2025-03-09 08:00:19,663 [INFO]: 	Selecting most promising index types given data characteristics 03/09/2025, 08:00:19
2025-03-09 08:00:19,663 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-09 08:00:19,663 [INFO]: 	Creating the index 03/09/2025, 08:00:19
2025-03-09 08:00:19,663 [INFO]: 		-> Instanciate the index HNSW32 03/09/2025, 08:00:19
2025-03-09 08:00:19,664 [INFO]: 		>>> Finished "-> Instanciate the index HNSW32" in 0.0012 secs
2025-03-09 08:00:19,664 [INFO]: 		-> Adding the vectors to the index 03/09/2025, 08:00:19
2025-03-09 08:00:19,664 [INFO]: The memory available for adding the vectors is 47.5GB(total available - used by the index)
2025-03-09 08:00:19,664 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/56 [00:00<?, ?it/s]  2%|▏         | 1/56 [00:00<00:13,  4.15it/s]  5%|▌         | 3/56 [00:00<00:06,  7.94it/s]  9%|▉         | 5/56 [00:00<00:05,  9.53it/s] 12%|█▎        | 7/56 [00:00<00:04, 10.47it/s] 16%|█▌        | 9/56 [00:00<00:04, 10.93it/s] 20%|█▉        | 11/56 [00:01<00:04, 11.05it/s] 23%|██▎       | 13/56 [00:01<00:03, 12.09it/s] 27%|██▋       | 15/56 [00:01<00:03, 12.06it/s] 30%|███       | 17/56 [00:01<00:03, 11.97it/s] 34%|███▍      | 19/56 [00:01<00:03, 12.08it/s] 38%|███▊      | 21/56 [00:07<00:33,  1.06it/s] 41%|████      | 23/56 [00:07<00:22,  1.47it/s] 45%|████▍     | 25/56 [00:07<00:15,  2.01it/s] 48%|████▊     | 27/56 [00:07<00:10,  2.70it/s] 52%|█████▏    | 29/56 [00:08<00:07,  3.55it/s] 55%|█████▌    | 31/56 [00:08<00:05,  4.55it/s] 59%|█████▉    | 33/56 [00:08<00:04,  5.61it/s] 62%|██████▎   | 35/56 [00:08<00:03,  6.74it/s] 66%|██████▌   | 37/56 [00:08<00:02,  7.91it/s] 70%|██████▉   | 39/56 [00:08<00:01,  8.87it/s] 73%|███████▎  | 41/56 [00:09<00:01,  9.78it/s] 77%|███████▋  | 43/56 [00:16<00:16,  1.24s/it] 80%|████████  | 45/56 [00:17<00:09,  1.12it/s] 82%|████████▏ | 46/56 [00:17<00:07,  1.33it/s] 86%|████████▌ | 48/56 [00:17<00:04,  1.88it/s] 89%|████████▉ | 50/56 [00:17<00:02,  2.57it/s] 93%|█████████▎| 52/56 [00:17<00:01,  3.44it/s] 96%|█████████▋| 54/56 [00:17<00:00,  4.45it/s]100%|██████████| 56/56 [00:23<00:00,  1.09s/it]100%|██████████| 56/56 [00:23<00:00,  2.35it/s]
2025-03-09 08:00:43,540 [INFO]: 	Computing best hyperparameters for index knn.index 03/09/2025, 08:00:43
2025-03-09 08:02:31,363 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 107.8222 secs
2025-03-09 08:02:31,363 [INFO]: The best hyperparameters are: efSearch=126
2025-03-09 08:02:31,364 [INFO]: 	Compute fast metrics 03/09/2025, 08:02:31
  0%|          | 0/4 [00:00<?, ?it/s] 25%|██▌       | 1/4 [00:00<00:00,  3.58it/s] 50%|█████     | 2/4 [00:00<00:00,  4.78it/s] 75%|███████▌  | 3/4 [00:00<00:00,  6.10it/s] 75%|███████▌  | 3/4 [00:00<00:00,  4.59it/s]
2025-03-09 08:02:52,758 [INFO]: 	>>> Finished "Compute fast metrics" in 21.3947 secs
2025-03-09 08:02:52,761 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 153.0966 secs
2025-03-09 08:02:52,761 [INFO]: {
2025-03-09 08:02:52,761 [INFO]: 	index_key: HNSW32
2025-03-09 08:02:52,761 [INFO]: 	index_param: efSearch=126
2025-03-09 08:02:52,761 [INFO]: 	index_path: knn.index
2025-03-09 08:02:52,761 [INFO]: 	size in bytes: 2672843458
2025-03-09 08:02:52,761 [INFO]: 	avg_search_speed_ms: 11.373471641919414
2025-03-09 08:02:52,761 [INFO]: 	99p_search_speed_ms: 22.928497758693997
2025-03-09 08:02:52,761 [INFO]: 	reconstruction error %: 0.0
2025-03-09 08:02:52,761 [INFO]: 	nb vectors: 13576
2025-03-09 08:02:52,761 [INFO]: 	vectors dimension: 49152
2025-03-09 08:02:52,761 [INFO]: 	compression ratio: 0.9986182318351096
2025-03-09 08:02:52,761 [INFO]: }
2025-03-09 08:02:52,761 [INFO]: 	>>> Finished "Creating the index" in 153.0982 secs
2025-03-09 08:02:52,761 [INFO]: >>> Finished "Launching the whole pipeline" in 153.1257 secs
2025-03-09 08:02:55: [retrieval_preprocessing] calculating distances ...
2025-03-09 08:02:58: [retrieval_preprocessing] finished and saved retrieval indices for episode 3123 [episode count 11/20]
[retrieval_preprocessing] for episode 4662 [episode count 12/20], we have num_retrieval=np.int64(13633) num_query=np.int64(696)
2025-03-09 08:03:03,113 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-09 08:03:04,977 [INFO]: Launching the whole pipeline 03/09/2025, 08:03:04
2025-03-09 08:03:04,977 [INFO]: Reading total number of vectors and dimension 03/09/2025, 08:03:04
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1409.38it/s]
2025-03-09 08:03:05,005 [INFO]: There are 13633 embeddings of dim 49152
2025-03-09 08:03:05,005 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0275 secs
2025-03-09 08:03:05,005 [INFO]: 	Compute estimated construction time of the index 03/09/2025, 08:03:05
2025-03-09 08:03:05,005 [INFO]: 		-> Train: 16.7 minutes
2025-03-09 08:03:05,005 [INFO]: 		-> Add: 7.5 seconds
2025-03-09 08:03:05,005 [INFO]: 		Total: 16.8 minutes
2025-03-09 08:03:05,005 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0001 secs
2025-03-09 08:03:05,005 [INFO]: 	Checking that your have enough memory available to create the index 03/09/2025, 08:03:05
2025-03-09 08:03:05,006 [INFO]: 2.7GB of memory will be needed to build the index (more might be used if you have more)
2025-03-09 08:03:05,006 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0002 secs
2025-03-09 08:03:05,006 [INFO]: 	Selecting most promising index types given data characteristics 03/09/2025, 08:03:05
2025-03-09 08:03:05,006 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-09 08:03:05,006 [INFO]: 	Creating the index 03/09/2025, 08:03:05
2025-03-09 08:03:05,006 [INFO]: 		-> Instanciate the index HNSW32 03/09/2025, 08:03:05
2025-03-09 08:03:05,007 [INFO]: 		>>> Finished "-> Instanciate the index HNSW32" in 0.0009 secs
2025-03-09 08:03:05,007 [INFO]: 		-> Adding the vectors to the index 03/09/2025, 08:03:05
2025-03-09 08:03:05,007 [INFO]: The memory available for adding the vectors is 47.5GB(total available - used by the index)
2025-03-09 08:03:05,007 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/56 [00:00<?, ?it/s]  2%|▏         | 1/56 [00:00<00:14,  3.76it/s]  4%|▎         | 2/56 [00:00<00:09,  5.53it/s]  5%|▌         | 3/56 [00:00<00:08,  6.56it/s]  7%|▋         | 4/56 [00:00<00:07,  7.15it/s]  9%|▉         | 5/56 [00:00<00:06,  7.58it/s] 11%|█         | 6/56 [00:00<00:06,  8.03it/s] 12%|█▎        | 7/56 [00:00<00:05,  8.37it/s] 14%|█▍        | 8/56 [00:01<00:05,  8.63it/s] 16%|█▌        | 9/56 [00:01<00:05,  8.94it/s] 20%|█▉        | 11/56 [00:01<00:04, 10.96it/s] 23%|██▎       | 13/56 [00:01<00:03, 11.54it/s] 27%|██▋       | 15/56 [00:01<00:03, 10.51it/s] 30%|███       | 17/56 [00:01<00:03, 10.19it/s] 34%|███▍      | 19/56 [00:02<00:03, 10.85it/s] 38%|███▊      | 21/56 [00:07<00:33,  1.05it/s] 39%|███▉      | 22/56 [00:07<00:27,  1.25it/s] 43%|████▎     | 24/56 [00:07<00:17,  1.80it/s] 45%|████▍     | 25/56 [00:08<00:14,  2.15it/s] 48%|████▊     | 27/56 [00:08<00:09,  3.01it/s] 52%|█████▏    | 29/56 [00:08<00:06,  3.99it/s] 55%|█████▌    | 31/56 [00:08<00:04,  5.03it/s] 59%|█████▉    | 33/56 [00:08<00:03,  6.11it/s] 62%|██████▎   | 35/56 [00:08<00:02,  7.02it/s] 66%|██████▌   | 37/56 [00:09<00:02,  7.84it/s] 70%|██████▉   | 39/56 [00:09<00:01,  8.55it/s] 73%|███████▎  | 41/56 [00:09<00:01,  9.18it/s] 77%|███████▋  | 43/56 [00:17<00:16,  1.26s/it] 80%|████████  | 45/56 [00:17<00:10,  1.10it/s] 84%|████████▍ | 47/56 [00:17<00:05,  1.51it/s] 88%|████████▊ | 49/56 [00:17<00:03,  2.04it/s] 91%|█████████ | 51/56 [00:18<00:01,  2.71it/s] 95%|█████████▍| 53/56 [00:18<00:00,  3.52it/s] 98%|█████████▊| 55/56 [00:18<00:00,  4.45it/s]100%|██████████| 56/56 [00:26<00:00,  2.12it/s]
2025-03-09 08:03:31,438 [INFO]: 	Computing best hyperparameters for index knn.index 03/09/2025, 08:03:31
2025-03-09 08:05:12,068 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 100.6296 secs
2025-03-09 08:05:12,068 [INFO]: The best hyperparameters are: efSearch=144
2025-03-09 08:05:12,068 [INFO]: 	Compute fast metrics 03/09/2025, 08:05:12
  0%|          | 0/4 [00:00<?, ?it/s] 25%|██▌       | 1/4 [00:00<00:00,  4.92it/s] 50%|█████     | 2/4 [00:00<00:00,  6.68it/s] 75%|███████▌  | 3/4 [00:00<00:00,  7.54it/s] 75%|███████▌  | 3/4 [00:00<00:00,  5.68it/s]
2025-03-09 08:05:35,774 [INFO]: 	>>> Finished "Compute fast metrics" in 23.7053 secs
2025-03-09 08:05:35,776 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 150.7697 secs
2025-03-09 08:05:35,777 [INFO]: {
2025-03-09 08:05:35,777 [INFO]: 	index_key: HNSW32
2025-03-09 08:05:35,777 [INFO]: 	index_param: efSearch=144
2025-03-09 08:05:35,777 [INFO]: 	index_path: knn.index
2025-03-09 08:05:35,777 [INFO]: 	size in bytes: 2684065774
2025-03-09 08:05:35,777 [INFO]: 	avg_search_speed_ms: 12.911982583783326
2025-03-09 08:05:35,777 [INFO]: 	99p_search_speed_ms: 27.438454157672822
2025-03-09 08:05:35,777 [INFO]: 	reconstruction error %: 0.0
2025-03-09 08:05:35,777 [INFO]: 	nb vectors: 13633
2025-03-09 08:05:35,777 [INFO]: 	vectors dimension: 49152
2025-03-09 08:05:35,777 [INFO]: 	compression ratio: 0.9986181746975326
2025-03-09 08:05:35,777 [INFO]: }
2025-03-09 08:05:35,777 [INFO]: 	>>> Finished "Creating the index" in 150.7710 secs
2025-03-09 08:05:35,777 [INFO]: >>> Finished "Launching the whole pipeline" in 150.7993 secs
2025-03-09 08:05:38: [retrieval_preprocessing] calculating distances ...
2025-03-09 08:05:42: [retrieval_preprocessing] finished and saved retrieval indices for episode 4662 [episode count 12/20]
[retrieval_preprocessing] for episode 3655 [episode count 13/20], we have num_retrieval=np.int64(13460) num_query=np.int64(869)
2025-03-09 08:05:47,025 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-09 08:05:48,817 [INFO]: Launching the whole pipeline 03/09/2025, 08:05:48
2025-03-09 08:05:48,817 [INFO]: Reading total number of vectors and dimension 03/09/2025, 08:05:48
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1133.90it/s]
2025-03-09 08:05:48,848 [INFO]: There are 13460 embeddings of dim 49152
2025-03-09 08:05:48,849 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0314 secs
2025-03-09 08:05:48,849 [INFO]: 	Compute estimated construction time of the index 03/09/2025, 08:05:48
2025-03-09 08:05:48,849 [INFO]: 		-> Train: 16.7 minutes
2025-03-09 08:05:48,849 [INFO]: 		-> Add: 7.4 seconds
2025-03-09 08:05:48,849 [INFO]: 		Total: 16.8 minutes
2025-03-09 08:05:48,849 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0002 secs
2025-03-09 08:05:48,849 [INFO]: 	Checking that your have enough memory available to create the index 03/09/2025, 08:05:48
2025-03-09 08:05:48,849 [INFO]: 2.7GB of memory will be needed to build the index (more might be used if you have more)
2025-03-09 08:05:48,849 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0003 secs
2025-03-09 08:05:48,849 [INFO]: 	Selecting most promising index types given data characteristics 03/09/2025, 08:05:48
2025-03-09 08:05:48,849 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-09 08:05:48,849 [INFO]: 	Creating the index 03/09/2025, 08:05:48
2025-03-09 08:05:48,849 [INFO]: 		-> Instanciate the index HNSW32 03/09/2025, 08:05:48
2025-03-09 08:05:48,851 [INFO]: 		>>> Finished "-> Instanciate the index HNSW32" in 0.0016 secs
2025-03-09 08:05:48,851 [INFO]: 		-> Adding the vectors to the index 03/09/2025, 08:05:48
2025-03-09 08:05:48,851 [INFO]: The memory available for adding the vectors is 47.5GB(total available - used by the index)
2025-03-09 08:05:48,852 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/55 [00:00<?, ?it/s]  2%|▏         | 1/55 [00:00<00:13,  4.06it/s]  5%|▌         | 3/55 [00:00<00:06,  8.05it/s]  9%|▉         | 5/55 [00:00<00:05,  9.62it/s] 13%|█▎        | 7/55 [00:00<00:04, 10.62it/s] 16%|█▋        | 9/55 [00:00<00:04, 11.24it/s] 20%|██        | 11/55 [00:01<00:03, 11.48it/s] 24%|██▎       | 13/55 [00:01<00:03, 11.66it/s] 27%|██▋       | 15/55 [00:01<00:03, 11.77it/s] 31%|███       | 17/55 [00:01<00:03, 11.82it/s] 35%|███▍      | 19/55 [00:01<00:02, 12.10it/s] 38%|███▊      | 21/55 [00:07<00:30,  1.10it/s] 42%|████▏     | 23/55 [00:07<00:21,  1.52it/s] 45%|████▌     | 25/55 [00:07<00:14,  2.07it/s] 49%|████▉     | 27/55 [00:07<00:10,  2.77it/s] 53%|█████▎    | 29/55 [00:07<00:07,  3.62it/s] 56%|█████▋    | 31/55 [00:08<00:05,  4.59it/s] 60%|██████    | 33/55 [00:08<00:03,  5.69it/s] 64%|██████▎   | 35/55 [00:08<00:02,  6.80it/s] 67%|██████▋   | 37/55 [00:08<00:02,  7.86it/s] 71%|███████   | 39/55 [00:08<00:01,  8.86it/s] 75%|███████▍  | 41/55 [00:08<00:01,  9.75it/s] 78%|███████▊  | 43/55 [00:15<00:13,  1.10s/it] 82%|████████▏ | 45/55 [00:15<00:07,  1.27it/s] 85%|████████▌ | 47/55 [00:16<00:04,  1.72it/s] 89%|████████▉ | 49/55 [00:16<00:02,  2.30it/s] 93%|█████████▎| 51/55 [00:16<00:01,  3.03it/s] 96%|█████████▋| 53/55 [00:16<00:00,  3.91it/s]100%|██████████| 55/55 [00:22<00:00,  1.01s/it]100%|██████████| 55/55 [00:22<00:00,  2.49it/s]
2025-03-09 08:06:11,582 [INFO]: 	Computing best hyperparameters for index knn.index 03/09/2025, 08:06:11
2025-03-09 08:07:39,142 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 87.5588 secs
2025-03-09 08:07:39,142 [INFO]: The best hyperparameters are: efSearch=152
2025-03-09 08:07:39,142 [INFO]: 	Compute fast metrics 03/09/2025, 08:07:39
  0%|          | 0/4 [00:00<?, ?it/s] 25%|██▌       | 1/4 [00:00<00:00,  5.18it/s] 50%|█████     | 2/4 [00:00<00:00,  5.46it/s] 75%|███████▌  | 3/4 [00:00<00:00,  6.54it/s] 75%|███████▌  | 3/4 [00:00<00:00,  5.03it/s]
2025-03-09 08:08:18,787 [INFO]: 	>>> Finished "Compute fast metrics" in 39.6445 secs
2025-03-09 08:08:18,790 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 149.9384 secs
2025-03-09 08:08:18,790 [INFO]: {
2025-03-09 08:08:18,790 [INFO]: 	index_key: HNSW32
2025-03-09 08:08:18,790 [INFO]: 	index_param: efSearch=152
2025-03-09 08:08:18,790 [INFO]: 	index_path: knn.index
2025-03-09 08:08:18,790 [INFO]: 	size in bytes: 2650005458
2025-03-09 08:08:18,790 [INFO]: 	avg_search_speed_ms: 12.864433002124294
2025-03-09 08:08:18,790 [INFO]: 	99p_search_speed_ms: 22.250911248847846
2025-03-09 08:08:18,790 [INFO]: 	reconstruction error %: 0.0
2025-03-09 08:08:18,790 [INFO]: 	nb vectors: 13460
2025-03-09 08:08:18,790 [INFO]: 	vectors dimension: 49152
2025-03-09 08:08:18,790 [INFO]: 	compression ratio: 0.998618199827119
2025-03-09 08:08:18,790 [INFO]: }
2025-03-09 08:08:18,790 [INFO]: 	>>> Finished "Creating the index" in 149.9407 secs
2025-03-09 08:08:18,790 [INFO]: >>> Finished "Launching the whole pipeline" in 149.9731 secs
2025-03-09 08:08:23: [retrieval_preprocessing] calculating distances ...
2025-03-09 08:08:26: [retrieval_preprocessing] finished and saved retrieval indices for episode 3655 [episode count 13/20]
[retrieval_preprocessing] for episode 40530 [episode count 14/20], we have num_retrieval=np.int64(13787) num_query=np.int64(542)
2025-03-09 08:08:31,878 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-09 08:08:34,016 [INFO]: Launching the whole pipeline 03/09/2025, 08:08:34
2025-03-09 08:08:34,016 [INFO]: Reading total number of vectors and dimension 03/09/2025, 08:08:34
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1209.78it/s]
2025-03-09 08:08:34,043 [INFO]: There are 13787 embeddings of dim 49152
2025-03-09 08:08:34,043 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0272 secs
2025-03-09 08:08:34,043 [INFO]: 	Compute estimated construction time of the index 03/09/2025, 08:08:34
2025-03-09 08:08:34,043 [INFO]: 		-> Train: 16.7 minutes
2025-03-09 08:08:34,043 [INFO]: 		-> Add: 7.6 seconds
2025-03-09 08:08:34,043 [INFO]: 		Total: 16.8 minutes
2025-03-09 08:08:34,043 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0001 secs
2025-03-09 08:08:34,043 [INFO]: 	Checking that your have enough memory available to create the index 03/09/2025, 08:08:34
2025-03-09 08:08:34,044 [INFO]: 2.8GB of memory will be needed to build the index (more might be used if you have more)
2025-03-09 08:08:34,044 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0002 secs
2025-03-09 08:08:34,044 [INFO]: 	Selecting most promising index types given data characteristics 03/09/2025, 08:08:34
2025-03-09 08:08:34,044 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-09 08:08:34,044 [INFO]: 	Creating the index 03/09/2025, 08:08:34
2025-03-09 08:08:34,044 [INFO]: 		-> Instanciate the index HNSW32 03/09/2025, 08:08:34
2025-03-09 08:08:34,045 [INFO]: 		>>> Finished "-> Instanciate the index HNSW32" in 0.0010 secs
2025-03-09 08:08:34,045 [INFO]: 		-> Adding the vectors to the index 03/09/2025, 08:08:34
2025-03-09 08:08:34,045 [INFO]: The memory available for adding the vectors is 47.5GB(total available - used by the index)
2025-03-09 08:08:34,045 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/57 [00:00<?, ?it/s]  2%|▏         | 1/57 [00:00<00:13,  4.13it/s]  5%|▌         | 3/57 [00:00<00:06,  7.95it/s]  9%|▉         | 5/57 [00:00<00:05,  9.79it/s] 12%|█▏        | 7/57 [00:00<00:04, 10.72it/s] 16%|█▌        | 9/57 [00:00<00:04, 11.26it/s] 19%|█▉        | 11/57 [00:01<00:03, 11.53it/s] 23%|██▎       | 13/57 [00:01<00:03, 11.78it/s] 26%|██▋       | 15/57 [00:01<00:03, 11.88it/s] 30%|██▉       | 17/57 [00:01<00:03, 12.02it/s] 33%|███▎      | 19/57 [00:01<00:03, 12.14it/s] 37%|███▋      | 21/57 [00:08<00:37,  1.03s/it] 40%|████      | 23/57 [00:08<00:25,  1.35it/s] 44%|████▍     | 25/57 [00:08<00:17,  1.85it/s] 47%|████▋     | 27/57 [00:08<00:11,  2.50it/s] 51%|█████     | 29/57 [00:08<00:08,  3.33it/s] 54%|█████▍    | 31/57 [00:08<00:06,  4.31it/s] 58%|█████▊    | 33/57 [00:08<00:04,  5.43it/s] 61%|██████▏   | 35/57 [00:09<00:03,  6.62it/s] 65%|██████▍   | 37/57 [00:09<00:02,  7.84it/s] 68%|██████▊   | 39/57 [00:09<00:01,  9.21it/s] 72%|███████▏  | 41/57 [00:09<00:01, 10.29it/s] 75%|███████▌  | 43/57 [00:18<00:19,  1.38s/it] 81%|████████  | 46/57 [00:18<00:09,  1.17it/s] 86%|████████▌ | 49/57 [00:18<00:04,  1.78it/s] 91%|█████████ | 52/57 [00:18<00:01,  2.58it/s] 96%|█████████▋| 55/57 [00:18<00:00,  3.65it/s]100%|██████████| 57/57 [00:26<00:00,  2.13it/s]
2025-03-09 08:09:00,754 [INFO]: 	Computing best hyperparameters for index knn.index 03/09/2025, 08:09:00
2025-03-09 08:10:49,044 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 108.2886 secs
2025-03-09 08:10:49,044 [INFO]: The best hyperparameters are: efSearch=122
2025-03-09 08:10:49,044 [INFO]: 	Compute fast metrics 03/09/2025, 08:10:49
  0%|          | 0/4 [00:00<?, ?it/s] 25%|██▌       | 1/4 [00:00<00:00,  5.09it/s] 50%|█████     | 2/4 [00:00<00:00,  6.60it/s] 75%|███████▌  | 3/4 [00:00<00:00,  7.10it/s] 75%|███████▌  | 3/4 [00:00<00:00,  5.33it/s]
2025-03-09 08:11:12,266 [INFO]: 	>>> Finished "Compute fast metrics" in 23.2217 secs
2025-03-09 08:11:12,268 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 158.2233 secs
2025-03-09 08:11:12,269 [INFO]: {
2025-03-09 08:11:12,269 [INFO]: 	index_key: HNSW32
2025-03-09 08:11:12,269 [INFO]: 	index_param: efSearch=122
2025-03-09 08:11:12,269 [INFO]: 	index_path: knn.index
2025-03-09 08:11:12,269 [INFO]: 	size in bytes: 2714385062
2025-03-09 08:11:12,269 [INFO]: 	avg_search_speed_ms: 12.391027259609237
2025-03-09 08:11:12,269 [INFO]: 	99p_search_speed_ms: 21.520143165253092
2025-03-09 08:11:12,269 [INFO]: 	reconstruction error %: 0.0
2025-03-09 08:11:12,269 [INFO]: 	nb vectors: 13787
2025-03-09 08:11:12,269 [INFO]: 	vectors dimension: 49152
2025-03-09 08:11:12,269 [INFO]: 	compression ratio: 0.998618263100359
2025-03-09 08:11:12,269 [INFO]: }
2025-03-09 08:11:12,269 [INFO]: 	>>> Finished "Creating the index" in 158.2248 secs
2025-03-09 08:11:12,269 [INFO]: >>> Finished "Launching the whole pipeline" in 158.2528 secs
2025-03-09 08:11:14: [retrieval_preprocessing] calculating distances ...
2025-03-09 08:11:17: [retrieval_preprocessing] finished and saved retrieval indices for episode 40530 [episode count 14/20]
[retrieval_preprocessing] for episode 70748 [episode count 15/20], we have num_retrieval=np.int64(13652) num_query=np.int64(677)
2025-03-09 08:11:21,916 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-09 08:11:24,022 [INFO]: Launching the whole pipeline 03/09/2025, 08:11:24
2025-03-09 08:11:24,022 [INFO]: Reading total number of vectors and dimension 03/09/2025, 08:11:24
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1338.32it/s]
2025-03-09 08:11:24,051 [INFO]: There are 13652 embeddings of dim 49152
2025-03-09 08:11:24,052 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0298 secs
2025-03-09 08:11:24,052 [INFO]: 	Compute estimated construction time of the index 03/09/2025, 08:11:24
2025-03-09 08:11:24,052 [INFO]: 		-> Train: 16.7 minutes
2025-03-09 08:11:24,052 [INFO]: 		-> Add: 7.5 seconds
2025-03-09 08:11:24,052 [INFO]: 		Total: 16.8 minutes
2025-03-09 08:11:24,052 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0001 secs
2025-03-09 08:11:24,052 [INFO]: 	Checking that your have enough memory available to create the index 03/09/2025, 08:11:24
2025-03-09 08:11:24,052 [INFO]: 2.8GB of memory will be needed to build the index (more might be used if you have more)
2025-03-09 08:11:24,052 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0002 secs
2025-03-09 08:11:24,052 [INFO]: 	Selecting most promising index types given data characteristics 03/09/2025, 08:11:24
2025-03-09 08:11:24,052 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-09 08:11:24,052 [INFO]: 	Creating the index 03/09/2025, 08:11:24
2025-03-09 08:11:24,052 [INFO]: 		-> Instanciate the index HNSW32 03/09/2025, 08:11:24
2025-03-09 08:11:24,054 [INFO]: 		>>> Finished "-> Instanciate the index HNSW32" in 0.0012 secs
2025-03-09 08:11:24,054 [INFO]: 		-> Adding the vectors to the index 03/09/2025, 08:11:24
2025-03-09 08:11:24,054 [INFO]: The memory available for adding the vectors is 47.5GB(total available - used by the index)
2025-03-09 08:11:24,054 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/56 [00:00<?, ?it/s]  2%|▏         | 1/56 [00:00<00:14,  3.92it/s]  5%|▌         | 3/56 [00:00<00:06,  8.15it/s]  9%|▉         | 5/56 [00:00<00:05, 10.12it/s] 12%|█▎        | 7/56 [00:00<00:04, 11.24it/s] 16%|█▌        | 9/56 [00:00<00:03, 12.00it/s] 25%|██▌       | 14/56 [00:00<00:01, 21.02it/s] 30%|███       | 17/56 [00:01<00:01, 22.70it/s] 36%|███▌      | 20/56 [00:01<00:02, 17.59it/s] 41%|████      | 23/56 [00:07<00:21,  1.55it/s] 45%|████▍     | 25/56 [00:07<00:16,  1.91it/s] 48%|████▊     | 27/56 [00:07<00:12,  2.35it/s] 52%|█████▏    | 29/56 [00:07<00:09,  2.89it/s] 55%|█████▌    | 31/56 [00:08<00:07,  3.49it/s] 57%|█████▋    | 32/56 [00:08<00:06,  3.80it/s] 59%|█████▉    | 33/56 [00:08<00:05,  3.96it/s] 61%|██████    | 34/56 [00:08<00:05,  4.22it/s] 62%|██████▎   | 35/56 [00:08<00:04,  4.76it/s] 64%|██████▍   | 36/56 [00:08<00:03,  5.20it/s] 66%|██████▌   | 37/56 [00:09<00:03,  5.64it/s] 68%|██████▊   | 38/56 [00:09<00:03,  5.94it/s] 70%|██████▉   | 39/56 [00:09<00:02,  6.36it/s] 71%|███████▏  | 40/56 [00:09<00:02,  6.76it/s] 73%|███████▎  | 41/56 [00:09<00:02,  7.09it/s] 75%|███████▌  | 42/56 [00:17<00:34,  2.43s/it] 80%|████████  | 45/56 [00:17<00:12,  1.10s/it] 86%|████████▌ | 48/56 [00:17<00:05,  1.58it/s] 91%|█████████ | 51/56 [00:17<00:02,  2.50it/s] 96%|█████████▋| 54/56 [00:17<00:00,  3.69it/s]100%|██████████| 56/56 [00:24<00:00,  2.27it/s]
2025-03-09 08:11:48,683 [INFO]: 	Computing best hyperparameters for index knn.index 03/09/2025, 08:11:48
2025-03-09 08:13:44,403 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 115.7195 secs
2025-03-09 08:13:44,403 [INFO]: The best hyperparameters are: efSearch=121
2025-03-09 08:13:44,403 [INFO]: 	Compute fast metrics 03/09/2025, 08:13:44
  0%|          | 0/4 [00:00<?, ?it/s] 25%|██▌       | 1/4 [00:00<00:00,  5.61it/s] 50%|█████     | 2/4 [00:00<00:00,  7.18it/s] 75%|███████▌  | 3/4 [00:00<00:00,  7.98it/s] 75%|███████▌  | 3/4 [00:00<00:00,  5.95it/s]
2025-03-09 08:14:13,335 [INFO]: 	>>> Finished "Compute fast metrics" in 28.9314 secs
2025-03-09 08:14:13,338 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 169.2840 secs
2025-03-09 08:14:13,338 [INFO]: {
2025-03-09 08:14:13,338 [INFO]: 	index_key: HNSW32
2025-03-09 08:14:13,338 [INFO]: 	index_param: efSearch=121
2025-03-09 08:14:13,338 [INFO]: 	index_path: knn.index
2025-03-09 08:14:13,338 [INFO]: 	size in bytes: 2687806418
2025-03-09 08:14:13,338 [INFO]: 	avg_search_speed_ms: 12.078335789619418
2025-03-09 08:14:13,338 [INFO]: 	99p_search_speed_ms: 21.49646452628076
2025-03-09 08:14:13,338 [INFO]: 	reconstruction error %: 0.0
2025-03-09 08:14:13,338 [INFO]: 	nb vectors: 13652
2025-03-09 08:14:13,338 [INFO]: 	vectors dimension: 49152
2025-03-09 08:14:13,338 [INFO]: 	compression ratio: 0.9986182033143728
2025-03-09 08:14:13,338 [INFO]: }
2025-03-09 08:14:13,338 [INFO]: 	>>> Finished "Creating the index" in 169.2857 secs
2025-03-09 08:14:13,338 [INFO]: >>> Finished "Launching the whole pipeline" in 169.3163 secs
2025-03-09 08:14:16: [retrieval_preprocessing] calculating distances ...
2025-03-09 08:14:19: [retrieval_preprocessing] finished and saved retrieval indices for episode 70748 [episode count 15/20]
[retrieval_preprocessing] for episode 6749 [episode count 16/20], we have num_retrieval=np.int64(13561) num_query=np.int64(768)
2025-03-09 08:14:23,633 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-09 08:14:25,863 [INFO]: Launching the whole pipeline 03/09/2025, 08:14:25
2025-03-09 08:14:25,863 [INFO]: Reading total number of vectors and dimension 03/09/2025, 08:14:25
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1365.78it/s]
2025-03-09 08:14:25,891 [INFO]: There are 13561 embeddings of dim 49152
2025-03-09 08:14:25,891 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0278 secs
2025-03-09 08:14:25,891 [INFO]: 	Compute estimated construction time of the index 03/09/2025, 08:14:25
2025-03-09 08:14:25,891 [INFO]: 		-> Train: 16.7 minutes
2025-03-09 08:14:25,891 [INFO]: 		-> Add: 7.4 seconds
2025-03-09 08:14:25,891 [INFO]: 		Total: 16.8 minutes
2025-03-09 08:14:25,892 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0001 secs
2025-03-09 08:14:25,892 [INFO]: 	Checking that your have enough memory available to create the index 03/09/2025, 08:14:25
2025-03-09 08:14:25,892 [INFO]: 2.7GB of memory will be needed to build the index (more might be used if you have more)
2025-03-09 08:14:25,892 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0002 secs
2025-03-09 08:14:25,892 [INFO]: 	Selecting most promising index types given data characteristics 03/09/2025, 08:14:25
2025-03-09 08:14:25,892 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-09 08:14:25,892 [INFO]: 	Creating the index 03/09/2025, 08:14:25
2025-03-09 08:14:25,892 [INFO]: 		-> Instanciate the index HNSW32 03/09/2025, 08:14:25
2025-03-09 08:14:25,893 [INFO]: 		>>> Finished "-> Instanciate the index HNSW32" in 0.0012 secs
2025-03-09 08:14:25,893 [INFO]: 		-> Adding the vectors to the index 03/09/2025, 08:14:25
2025-03-09 08:14:25,894 [INFO]: The memory available for adding the vectors is 47.5GB(total available - used by the index)
2025-03-09 08:14:25,894 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/56 [00:00<?, ?it/s]  2%|▏         | 1/56 [00:00<00:11,  4.85it/s]  5%|▌         | 3/56 [00:00<00:06,  8.81it/s]  9%|▉         | 5/56 [00:00<00:05, 10.13it/s] 12%|█▎        | 7/56 [00:00<00:04, 10.80it/s] 16%|█▌        | 9/56 [00:00<00:04, 10.93it/s] 20%|█▉        | 11/56 [00:01<00:03, 11.31it/s] 23%|██▎       | 13/56 [00:01<00:03, 11.65it/s] 27%|██▋       | 15/56 [00:01<00:03, 11.93it/s] 30%|███       | 17/56 [00:01<00:03, 12.00it/s] 34%|███▍      | 19/56 [00:01<00:03, 12.08it/s] 38%|███▊      | 21/56 [00:08<00:36,  1.05s/it] 41%|████      | 23/56 [00:08<00:24,  1.33it/s] 45%|████▍     | 25/56 [00:08<00:17,  1.82it/s] 48%|████▊     | 27/56 [00:08<00:11,  2.46it/s] 52%|█████▏    | 29/56 [00:08<00:08,  3.25it/s] 55%|█████▌    | 31/56 [00:08<00:05,  4.17it/s] 59%|█████▉    | 33/56 [00:09<00:04,  5.21it/s] 62%|██████▎   | 35/56 [00:09<00:03,  6.24it/s] 66%|██████▌   | 37/56 [00:09<00:02,  7.20it/s] 70%|██████▉   | 39/56 [00:09<00:02,  8.26it/s] 73%|███████▎  | 41/56 [00:09<00:01,  9.19it/s] 77%|███████▋  | 43/56 [00:17<00:15,  1.22s/it] 80%|████████  | 45/56 [00:17<00:09,  1.13it/s] 84%|████████▍ | 47/56 [00:17<00:05,  1.55it/s] 88%|████████▊ | 49/56 [00:17<00:03,  2.08it/s] 91%|█████████ | 51/56 [00:18<00:01,  2.74it/s] 95%|█████████▍| 53/56 [00:18<00:00,  3.54it/s] 98%|█████████▊| 55/56 [00:18<00:00,  4.45it/s]100%|██████████| 56/56 [00:25<00:00,  2.20it/s]
2025-03-09 08:14:51,410 [INFO]: 	Computing best hyperparameters for index knn.index 03/09/2025, 08:14:51
2025-03-09 08:16:30,425 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 99.0139 secs
2025-03-09 08:16:30,425 [INFO]: The best hyperparameters are: efSearch=125
2025-03-09 08:16:30,425 [INFO]: 	Compute fast metrics 03/09/2025, 08:16:30
  0%|          | 0/4 [00:00<?, ?it/s] 25%|██▌       | 1/4 [00:00<00:00,  5.24it/s] 50%|█████     | 2/4 [00:00<00:00,  6.70it/s] 75%|███████▌  | 3/4 [00:00<00:00,  7.60it/s] 75%|███████▌  | 3/4 [00:00<00:00,  5.64it/s]
2025-03-09 08:16:56,557 [INFO]: 	>>> Finished "Compute fast metrics" in 26.1318 secs
2025-03-09 08:16:56,560 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 150.6660 secs
2025-03-09 08:16:56,560 [INFO]: {
2025-03-09 08:16:56,560 [INFO]: 	index_key: HNSW32
2025-03-09 08:16:56,560 [INFO]: 	index_param: efSearch=125
2025-03-09 08:16:56,560 [INFO]: 	index_path: knn.index
2025-03-09 08:16:56,560 [INFO]: 	size in bytes: 2669890318
2025-03-09 08:16:56,560 [INFO]: 	avg_search_speed_ms: 11.972676951473836
2025-03-09 08:16:56,560 [INFO]: 	99p_search_speed_ms: 24.84368610894307
2025-03-09 08:16:56,560 [INFO]: 	reconstruction error %: 0.0
2025-03-09 08:16:56,560 [INFO]: 	nb vectors: 13561
2025-03-09 08:16:56,560 [INFO]: 	vectors dimension: 49152
2025-03-09 08:16:56,560 [INFO]: 	compression ratio: 0.9986182091544631
2025-03-09 08:16:56,560 [INFO]: }
2025-03-09 08:16:56,560 [INFO]: 	>>> Finished "Creating the index" in 150.6679 secs
2025-03-09 08:16:56,560 [INFO]: >>> Finished "Launching the whole pipeline" in 150.6965 secs
2025-03-09 08:16:59: [retrieval_preprocessing] calculating distances ...
2025-03-09 08:17:02: [retrieval_preprocessing] finished and saved retrieval indices for episode 6749 [episode count 16/20]
[retrieval_preprocessing] for episode 75878 [episode count 17/20], we have num_retrieval=np.int64(13595) num_query=np.int64(734)
2025-03-09 08:17:05,848 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-09 08:17:07,999 [INFO]: Launching the whole pipeline 03/09/2025, 08:17:07
2025-03-09 08:17:07,999 [INFO]: Reading total number of vectors and dimension 03/09/2025, 08:17:07
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1457.37it/s]
2025-03-09 08:17:08,025 [INFO]: There are 13595 embeddings of dim 49152
2025-03-09 08:17:08,025 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0257 secs
2025-03-09 08:17:08,025 [INFO]: 	Compute estimated construction time of the index 03/09/2025, 08:17:08
2025-03-09 08:17:08,025 [INFO]: 		-> Train: 16.7 minutes
2025-03-09 08:17:08,025 [INFO]: 		-> Add: 7.5 seconds
2025-03-09 08:17:08,025 [INFO]: 		Total: 16.8 minutes
2025-03-09 08:17:08,025 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0001 secs
2025-03-09 08:17:08,025 [INFO]: 	Checking that your have enough memory available to create the index 03/09/2025, 08:17:08
2025-03-09 08:17:08,025 [INFO]: 2.7GB of memory will be needed to build the index (more might be used if you have more)
2025-03-09 08:17:08,025 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0001 secs
2025-03-09 08:17:08,025 [INFO]: 	Selecting most promising index types given data characteristics 03/09/2025, 08:17:08
2025-03-09 08:17:08,025 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-09 08:17:08,025 [INFO]: 	Creating the index 03/09/2025, 08:17:08
2025-03-09 08:17:08,026 [INFO]: 		-> Instanciate the index HNSW32 03/09/2025, 08:17:08
2025-03-09 08:17:08,027 [INFO]: 		>>> Finished "-> Instanciate the index HNSW32" in 0.0010 secs
2025-03-09 08:17:08,027 [INFO]: 		-> Adding the vectors to the index 03/09/2025, 08:17:08
2025-03-09 08:17:08,027 [INFO]: The memory available for adding the vectors is 47.5GB(total available - used by the index)
2025-03-09 08:17:08,027 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/56 [00:00<?, ?it/s]  2%|▏         | 1/56 [00:00<00:12,  4.32it/s]  4%|▎         | 2/56 [00:00<00:08,  6.20it/s]  5%|▌         | 3/56 [00:00<00:07,  7.18it/s]  7%|▋         | 4/56 [00:00<00:06,  7.89it/s]  9%|▉         | 5/56 [00:00<00:06,  8.45it/s] 11%|█         | 6/56 [00:00<00:05,  8.57it/s] 12%|█▎        | 7/56 [00:00<00:05,  8.64it/s] 14%|█▍        | 8/56 [00:01<00:05,  8.64it/s] 16%|█▌        | 9/56 [00:01<00:05,  8.94it/s] 18%|█▊        | 10/56 [00:01<00:05,  8.77it/s] 20%|█▉        | 11/56 [00:01<00:05,  8.74it/s] 21%|██▏       | 12/56 [00:01<00:05,  8.41it/s] 23%|██▎       | 13/56 [00:01<00:05,  8.45it/s] 25%|██▌       | 14/56 [00:01<00:05,  8.31it/s] 27%|██▋       | 15/56 [00:01<00:04,  8.63it/s] 29%|██▊       | 16/56 [00:01<00:04,  8.97it/s] 30%|███       | 17/56 [00:02<00:04,  9.07it/s] 32%|███▏      | 18/56 [00:02<00:04,  9.11it/s] 36%|███▌      | 20/56 [00:02<00:03, 10.66it/s] 39%|███▉      | 22/56 [00:07<00:39,  1.16s/it] 43%|████▎     | 24/56 [00:08<00:24,  1.30it/s] 46%|████▋     | 26/56 [00:08<00:16,  1.86it/s] 50%|█████     | 28/56 [00:08<00:11,  2.54it/s] 54%|█████▎    | 30/56 [00:08<00:07,  3.39it/s] 57%|█████▋    | 32/56 [00:08<00:05,  4.36it/s] 61%|██████    | 34/56 [00:08<00:04,  5.45it/s] 64%|██████▍   | 36/56 [00:09<00:03,  6.63it/s] 68%|██████▊   | 38/56 [00:09<00:02,  7.69it/s] 71%|███████▏  | 40/56 [00:09<00:01,  8.64it/s] 75%|███████▌  | 42/56 [00:15<00:14,  1.05s/it] 77%|███████▋  | 43/56 [00:15<00:11,  1.13it/s] 79%|███████▊  | 44/56 [00:16<00:08,  1.37it/s] 80%|████████  | 45/56 [00:16<00:06,  1.70it/s] 82%|████████▏ | 46/56 [00:16<00:04,  2.13it/s] 84%|████████▍ | 47/56 [00:16<00:03,  2.65it/s] 86%|████████▌ | 48/56 [00:16<00:02,  3.27it/s] 88%|████████▊ | 49/56 [00:16<00:01,  4.01it/s] 89%|████████▉ | 50/56 [00:16<00:01,  4.79it/s] 91%|█████████ | 51/56 [00:16<00:00,  5.50it/s] 93%|█████████▎| 52/56 [00:16<00:00,  6.15it/s] 95%|█████████▍| 53/56 [00:16<00:00,  6.70it/s] 96%|█████████▋| 54/56 [00:17<00:00,  7.03it/s] 98%|█████████▊| 55/56 [00:17<00:00,  7.24it/s]100%|██████████| 56/56 [00:23<00:00,  1.96s/it]100%|██████████| 56/56 [00:23<00:00,  2.38it/s]
2025-03-09 08:17:31,541 [INFO]: 	Computing best hyperparameters for index knn.index 03/09/2025, 08:17:31
2025-03-09 08:19:03,078 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 91.5366 secs
2025-03-09 08:19:03,078 [INFO]: The best hyperparameters are: efSearch=133
2025-03-09 08:19:03,079 [INFO]: 	Compute fast metrics 03/09/2025, 08:19:03
  0%|          | 0/4 [00:00<?, ?it/s] 25%|██▌       | 1/4 [00:00<00:00,  5.72it/s] 50%|█████     | 2/4 [00:00<00:00,  7.19it/s] 75%|███████▌  | 3/4 [00:00<00:00,  7.76it/s] 75%|███████▌  | 3/4 [00:00<00:00,  5.86it/s]
2025-03-09 08:19:38,873 [INFO]: 	>>> Finished "Compute fast metrics" in 35.7948 secs
2025-03-09 08:19:38,876 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 150.8495 secs
2025-03-09 08:19:38,876 [INFO]: {
2025-03-09 08:19:38,876 [INFO]: 	index_key: HNSW32
2025-03-09 08:19:38,876 [INFO]: 	index_param: efSearch=133
2025-03-09 08:19:38,876 [INFO]: 	index_path: knn.index
2025-03-09 08:19:38,876 [INFO]: 	size in bytes: 2676584230
2025-03-09 08:19:38,876 [INFO]: 	avg_search_speed_ms: 11.971977484494928
2025-03-09 08:19:38,876 [INFO]: 	99p_search_speed_ms: 23.888731934130156
2025-03-09 08:19:38,876 [INFO]: 	reconstruction error %: 0.0
2025-03-09 08:19:38,876 [INFO]: 	nb vectors: 13595
2025-03-09 08:19:38,876 [INFO]: 	vectors dimension: 49152
2025-03-09 08:19:38,876 [INFO]: 	compression ratio: 0.9986182127360139
2025-03-09 08:19:38,876 [INFO]: }
2025-03-09 08:19:38,876 [INFO]: 	>>> Finished "Creating the index" in 150.8510 secs
2025-03-09 08:19:38,877 [INFO]: >>> Finished "Launching the whole pipeline" in 150.8773 secs
2025-03-09 08:19:42: [retrieval_preprocessing] calculating distances ...
2025-03-09 08:19:45: [retrieval_preprocessing] finished and saved retrieval indices for episode 75878 [episode count 17/20]
[retrieval_preprocessing] for episode 26217 [episode count 18/20], we have num_retrieval=np.int64(13687) num_query=np.int64(642)
2025-03-09 08:19:51,488 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-09 08:19:53,384 [INFO]: Launching the whole pipeline 03/09/2025, 08:19:53
2025-03-09 08:19:53,384 [INFO]: Reading total number of vectors and dimension 03/09/2025, 08:19:53
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1251.28it/s]
2025-03-09 08:19:53,414 [INFO]: There are 13687 embeddings of dim 49152
2025-03-09 08:19:53,415 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0302 secs
2025-03-09 08:19:53,415 [INFO]: 	Compute estimated construction time of the index 03/09/2025, 08:19:53
2025-03-09 08:19:53,415 [INFO]: 		-> Train: 16.7 minutes
2025-03-09 08:19:53,415 [INFO]: 		-> Add: 7.5 seconds
2025-03-09 08:19:53,415 [INFO]: 		Total: 16.8 minutes
2025-03-09 08:19:53,415 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0003 secs
2025-03-09 08:19:53,415 [INFO]: 	Checking that your have enough memory available to create the index 03/09/2025, 08:19:53
2025-03-09 08:19:53,416 [INFO]: 2.8GB of memory will be needed to build the index (more might be used if you have more)
2025-03-09 08:19:53,416 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0006 secs
2025-03-09 08:19:53,416 [INFO]: 	Selecting most promising index types given data characteristics 03/09/2025, 08:19:53
2025-03-09 08:19:53,416 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0001 secs
2025-03-09 08:19:53,417 [INFO]: 	Creating the index 03/09/2025, 08:19:53
2025-03-09 08:19:53,417 [INFO]: 		-> Instanciate the index HNSW32 03/09/2025, 08:19:53
2025-03-09 08:19:53,420 [INFO]: 		>>> Finished "-> Instanciate the index HNSW32" in 0.0028 secs
2025-03-09 08:19:53,420 [INFO]: 		-> Adding the vectors to the index 03/09/2025, 08:19:53
2025-03-09 08:19:53,420 [INFO]: The memory available for adding the vectors is 47.5GB(total available - used by the index)
2025-03-09 08:19:53,420 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/56 [00:00<?, ?it/s]  2%|▏         | 1/56 [00:00<00:12,  4.26it/s]  5%|▌         | 3/56 [00:00<00:06,  7.98it/s]  9%|▉         | 5/56 [00:00<00:04, 10.56it/s] 12%|█▎        | 7/56 [00:00<00:04, 11.99it/s] 16%|█▌        | 9/56 [00:00<00:03, 13.33it/s] 20%|█▉        | 11/56 [00:00<00:03, 14.26it/s] 23%|██▎       | 13/56 [00:01<00:03, 13.34it/s] 27%|██▋       | 15/56 [00:01<00:03, 12.95it/s] 30%|███       | 17/56 [00:01<00:03, 12.79it/s] 34%|███▍      | 19/56 [00:01<00:02, 12.74it/s] 38%|███▊      | 21/56 [00:06<00:31,  1.13it/s] 41%|████      | 23/56 [00:07<00:21,  1.55it/s] 45%|████▍     | 25/56 [00:07<00:14,  2.12it/s] 48%|████▊     | 27/56 [00:07<00:10,  2.83it/s] 52%|█████▏    | 29/56 [00:07<00:07,  3.69it/s] 55%|█████▌    | 31/56 [00:07<00:05,  4.68it/s] 59%|█████▉    | 33/56 [00:07<00:04,  5.74it/s] 62%|██████▎   | 35/56 [00:08<00:03,  6.85it/s] 66%|██████▌   | 37/56 [00:08<00:02,  7.83it/s] 70%|██████▉   | 39/56 [00:08<00:01,  8.84it/s] 73%|███████▎  | 41/56 [00:08<00:01,  9.74it/s] 77%|███████▋  | 43/56 [00:15<00:14,  1.08s/it] 80%|████████  | 45/56 [00:15<00:08,  1.27it/s] 84%|████████▍ | 47/56 [00:15<00:05,  1.73it/s] 88%|████████▊ | 49/56 [00:15<00:03,  2.30it/s] 91%|█████████ | 51/56 [00:16<00:01,  3.00it/s] 95%|█████████▍| 53/56 [00:16<00:00,  3.79it/s] 98%|█████████▊| 55/56 [00:16<00:00,  4.72it/s]100%|██████████| 56/56 [00:22<00:00,  2.47it/s]
2025-03-09 08:20:16,122 [INFO]: 	Computing best hyperparameters for index knn.index 03/09/2025, 08:20:16
2025-03-09 08:21:57,886 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 101.7642 secs
2025-03-09 08:21:57,887 [INFO]: The best hyperparameters are: efSearch=133
2025-03-09 08:21:57,887 [INFO]: 	Compute fast metrics 03/09/2025, 08:21:57
  0%|          | 0/4 [00:00<?, ?it/s] 25%|██▌       | 1/4 [00:00<00:00,  5.37it/s] 50%|█████     | 2/4 [00:00<00:00,  6.95it/s] 75%|███████▌  | 3/4 [00:00<00:00,  7.66it/s] 75%|███████▌  | 3/4 [00:00<00:00,  5.77it/s]
2025-03-09 08:22:29,660 [INFO]: 	>>> Finished "Compute fast metrics" in 31.7736 secs
2025-03-09 08:22:29,663 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 156.2430 secs
2025-03-09 08:22:29,663 [INFO]: {
2025-03-09 08:22:29,663 [INFO]: 	index_key: HNSW32
2025-03-09 08:22:29,663 [INFO]: 	index_param: efSearch=133
2025-03-09 08:22:29,663 [INFO]: 	index_path: knn.index
2025-03-09 08:22:29,663 [INFO]: 	size in bytes: 2694697206
2025-03-09 08:22:29,663 [INFO]: 	avg_search_speed_ms: 11.823171208366029
2025-03-09 08:22:29,663 [INFO]: 	99p_search_speed_ms: 23.56704333797093
2025-03-09 08:22:29,663 [INFO]: 	reconstruction error %: 0.0
2025-03-09 08:22:29,663 [INFO]: 	nb vectors: 13687
2025-03-09 08:22:29,663 [INFO]: 	vectors dimension: 49152
2025-03-09 08:22:29,663 [INFO]: 	compression ratio: 0.9986182083865641
2025-03-09 08:22:29,663 [INFO]: }
2025-03-09 08:22:29,663 [INFO]: 	>>> Finished "Creating the index" in 156.2467 secs
2025-03-09 08:22:29,663 [INFO]: >>> Finished "Launching the whole pipeline" in 156.2790 secs
2025-03-09 08:22:32: [retrieval_preprocessing] calculating distances ...
2025-03-09 08:22:34: [retrieval_preprocessing] finished and saved retrieval indices for episode 26217 [episode count 18/20]
[retrieval_preprocessing] for episode 45167 [episode count 19/20], we have num_retrieval=np.int64(13697) num_query=np.int64(632)
2025-03-09 08:22:38,594 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-09 08:22:40,659 [INFO]: Launching the whole pipeline 03/09/2025, 08:22:40
2025-03-09 08:22:40,660 [INFO]: Reading total number of vectors and dimension 03/09/2025, 08:22:40
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1221.76it/s]
2025-03-09 08:22:40,684 [INFO]: There are 13697 embeddings of dim 49152
2025-03-09 08:22:40,684 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0246 secs
2025-03-09 08:22:40,684 [INFO]: 	Compute estimated construction time of the index 03/09/2025, 08:22:40
2025-03-09 08:22:40,684 [INFO]: 		-> Train: 16.7 minutes
2025-03-09 08:22:40,684 [INFO]: 		-> Add: 7.5 seconds
2025-03-09 08:22:40,684 [INFO]: 		Total: 16.8 minutes
2025-03-09 08:22:40,684 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0001 secs
2025-03-09 08:22:40,684 [INFO]: 	Checking that your have enough memory available to create the index 03/09/2025, 08:22:40
2025-03-09 08:22:40,684 [INFO]: 2.8GB of memory will be needed to build the index (more might be used if you have more)
2025-03-09 08:22:40,685 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0001 secs
2025-03-09 08:22:40,685 [INFO]: 	Selecting most promising index types given data characteristics 03/09/2025, 08:22:40
2025-03-09 08:22:40,685 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-09 08:22:40,685 [INFO]: 	Creating the index 03/09/2025, 08:22:40
2025-03-09 08:22:40,685 [INFO]: 		-> Instanciate the index HNSW32 03/09/2025, 08:22:40
2025-03-09 08:22:40,686 [INFO]: 		>>> Finished "-> Instanciate the index HNSW32" in 0.0009 secs
2025-03-09 08:22:40,686 [INFO]: 		-> Adding the vectors to the index 03/09/2025, 08:22:40
2025-03-09 08:22:40,686 [INFO]: The memory available for adding the vectors is 47.5GB(total available - used by the index)
2025-03-09 08:22:40,686 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/56 [00:00<?, ?it/s]  2%|▏         | 1/56 [00:00<00:13,  4.17it/s]  5%|▌         | 3/56 [00:00<00:06,  7.96it/s]  9%|▉         | 5/56 [00:00<00:05,  9.34it/s] 12%|█▎        | 7/56 [00:00<00:04, 10.22it/s] 16%|█▌        | 9/56 [00:00<00:04, 11.02it/s] 20%|█▉        | 11/56 [00:01<00:03, 11.66it/s] 23%|██▎       | 13/56 [00:01<00:03, 11.93it/s] 27%|██▋       | 15/56 [00:01<00:03, 12.18it/s] 30%|███       | 17/56 [00:01<00:03, 12.20it/s] 34%|███▍      | 19/56 [00:01<00:03, 12.04it/s] 38%|███▊      | 21/56 [00:07<00:32,  1.07it/s] 41%|████      | 23/56 [00:07<00:22,  1.47it/s] 45%|████▍     | 25/56 [00:07<00:15,  2.01it/s] 48%|████▊     | 27/56 [00:07<00:10,  2.71it/s] 52%|█████▏    | 29/56 [00:08<00:07,  3.57it/s] 55%|█████▌    | 31/56 [00:08<00:05,  4.52it/s] 59%|█████▉    | 33/56 [00:08<00:04,  5.56it/s] 62%|██████▎   | 35/56 [00:08<00:03,  6.61it/s] 66%|██████▌   | 37/56 [00:08<00:02,  7.70it/s] 70%|██████▉   | 39/56 [00:08<00:01,  8.71it/s] 73%|███████▎  | 41/56 [00:09<00:01,  9.55it/s] 77%|███████▋  | 43/56 [00:16<00:14,  1.13s/it] 80%|████████  | 45/56 [00:16<00:08,  1.23it/s] 84%|████████▍ | 47/56 [00:16<00:05,  1.68it/s] 88%|████████▊ | 49/56 [00:16<00:03,  2.25it/s] 91%|█████████ | 51/56 [00:16<00:01,  2.96it/s] 95%|█████████▍| 53/56 [00:17<00:00,  3.66it/s] 98%|█████████▊| 55/56 [00:17<00:00,  4.58it/s]100%|██████████| 56/56 [00:23<00:00,  2.42it/s]
2025-03-09 08:23:03,883 [INFO]: 	Computing best hyperparameters for index knn.index 03/09/2025, 08:23:03
2025-03-09 08:24:33,993 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 90.1100 secs
2025-03-09 08:24:33,994 [INFO]: The best hyperparameters are: efSearch=143
2025-03-09 08:24:33,994 [INFO]: 	Compute fast metrics 03/09/2025, 08:24:33
  0%|          | 0/4 [00:00<?, ?it/s] 25%|██▌       | 1/4 [00:00<00:00,  5.86it/s] 75%|███████▌  | 3/4 [00:00<00:00,  9.63it/s] 75%|███████▌  | 3/4 [00:00<00:00,  7.37it/s]
2025-03-09 08:25:06,665 [INFO]: 	>>> Finished "Compute fast metrics" in 32.6710 secs
2025-03-09 08:25:06,667 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 145.9817 secs
2025-03-09 08:25:06,668 [INFO]: {
2025-03-09 08:25:06,668 [INFO]: 	index_key: HNSW32
2025-03-09 08:25:06,668 [INFO]: 	index_param: efSearch=143
2025-03-09 08:25:06,668 [INFO]: 	index_path: knn.index
2025-03-09 08:25:06,668 [INFO]: 	size in bytes: 2696665966
2025-03-09 08:25:06,668 [INFO]: 	avg_search_speed_ms: 11.679040667978024
2025-03-09 08:25:06,668 [INFO]: 	99p_search_speed_ms: 21.5031988173723
2025-03-09 08:25:06,668 [INFO]: 	reconstruction error %: 0.0
2025-03-09 08:25:06,668 [INFO]: 	nb vectors: 13697
2025-03-09 08:25:06,668 [INFO]: 	vectors dimension: 49152
2025-03-09 08:25:06,668 [INFO]: 	compression ratio: 0.9986182233739809
2025-03-09 08:25:06,668 [INFO]: }
2025-03-09 08:25:06,668 [INFO]: 	>>> Finished "Creating the index" in 145.9831 secs
2025-03-09 08:25:06,668 [INFO]: >>> Finished "Launching the whole pipeline" in 146.0082 secs
2025-03-09 08:25:09: [retrieval_preprocessing] calculating distances ...
2025-03-09 08:25:11: [retrieval_preprocessing] finished and saved retrieval indices for episode 45167 [episode count 19/20]
2025-03-09 08:25:11: [retrieval_preprocessing] finished for (1498834123, 'cup') [chosen_id count 2/10]
2025-03-09 08:25:19: [retrieval_preprocessing] concatenated all embeddings and indices for 20 episodes for (440287856, 'drawer') [chosen_id count 3/10]
2025-03-09 08:25:19: [retrieval_preprocessing] we have num_total=12232 embedding_dim=49152
[retrieval_preprocessing] for episode 38656 [episode count 0/20], we have num_retrieval=np.int64(11663) num_query=np.int64(569)
2025-03-09 08:25:22,972 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-09 08:25:24,569 [INFO]: Launching the whole pipeline 03/09/2025, 08:25:24
2025-03-09 08:25:24,569 [INFO]: Reading total number of vectors and dimension 03/09/2025, 08:25:24
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1754.94it/s]
2025-03-09 08:25:24,606 [INFO]: There are 11663 embeddings of dim 49152
2025-03-09 08:25:24,607 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0371 secs
2025-03-09 08:25:24,607 [INFO]: 	Compute estimated construction time of the index 03/09/2025, 08:25:24
2025-03-09 08:25:24,607 [INFO]: 		-> Train: 16.7 minutes
2025-03-09 08:25:24,607 [INFO]: 		-> Add: 6.4 seconds
2025-03-09 08:25:24,607 [INFO]: 		Total: 16.8 minutes
2025-03-09 08:25:24,607 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0003 secs
2025-03-09 08:25:24,608 [INFO]: 	Checking that your have enough memory available to create the index 03/09/2025, 08:25:24
2025-03-09 08:25:24,608 [INFO]: 2.4GB of memory will be needed to build the index (more might be used if you have more)
2025-03-09 08:25:24,608 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0005 secs
2025-03-09 08:25:24,608 [INFO]: 	Selecting most promising index types given data characteristics 03/09/2025, 08:25:24
2025-03-09 08:25:24,608 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0001 secs
2025-03-09 08:25:24,609 [INFO]: 	Creating the index 03/09/2025, 08:25:24
2025-03-09 08:25:24,609 [INFO]: 		-> Instanciate the index HNSW32 03/09/2025, 08:25:24
2025-03-09 08:25:24,611 [INFO]: 		>>> Finished "-> Instanciate the index HNSW32" in 0.0023 secs
2025-03-09 08:25:24,611 [INFO]: 		-> Adding the vectors to the index 03/09/2025, 08:25:24
2025-03-09 08:25:24,612 [INFO]: The memory available for adding the vectors is 47.9GB(total available - used by the index)
2025-03-09 08:25:24,612 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/48 [00:00<?, ?it/s]  2%|▏         | 1/48 [00:00<00:09,  4.91it/s]  8%|▊         | 4/48 [00:00<00:03, 12.47it/s] 12%|█▎        | 6/48 [00:00<00:03, 13.13it/s] 17%|█▋        | 8/48 [00:00<00:02, 13.63it/s] 21%|██        | 10/48 [00:00<00:02, 13.51it/s] 25%|██▌       | 12/48 [00:00<00:02, 13.46it/s] 29%|██▉       | 14/48 [00:01<00:02, 13.39it/s] 33%|███▎      | 16/48 [00:01<00:02, 13.04it/s] 38%|███▊      | 18/48 [00:01<00:02, 12.79it/s] 42%|████▏     | 20/48 [00:01<00:02, 12.46it/s] 46%|████▌     | 22/48 [00:07<00:23,  1.09it/s] 50%|█████     | 24/48 [00:07<00:15,  1.51it/s] 54%|█████▍    | 26/48 [00:07<00:10,  2.05it/s] 58%|█████▊    | 28/48 [00:07<00:07,  2.77it/s] 62%|██████▎   | 30/48 [00:07<00:04,  3.64it/s] 67%|██████▋   | 32/48 [00:07<00:03,  4.68it/s] 71%|███████   | 34/48 [00:08<00:02,  5.84it/s] 75%|███████▌  | 36/48 [00:08<00:01,  7.06it/s] 81%|████████▏ | 39/48 [00:08<00:00,  9.78it/s] 85%|████████▌ | 41/48 [00:08<00:00, 11.08it/s] 90%|████████▉ | 43/48 [00:15<00:05,  1.06s/it] 94%|█████████▍| 45/48 [00:15<00:02,  1.27it/s] 98%|█████████▊| 47/48 [00:16<00:00,  1.69it/s]100%|██████████| 48/48 [00:19<00:00,  2.41it/s]
2025-03-09 08:25:44,574 [INFO]: 	Computing best hyperparameters for index knn.index 03/09/2025, 08:25:44
2025-03-09 08:26:53,200 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 68.6252 secs
2025-03-09 08:26:53,200 [INFO]: The best hyperparameters are: efSearch=90
2025-03-09 08:26:53,200 [INFO]: 	Compute fast metrics 03/09/2025, 08:26:53
  0%|          | 0/4 [00:00<?, ?it/s] 25%|██▌       | 1/4 [00:00<00:00,  5.15it/s] 50%|█████     | 2/4 [00:00<00:00,  6.95it/s] 75%|███████▌  | 3/4 [00:00<00:00,  7.77it/s] 75%|███████▌  | 3/4 [00:00<00:00,  5.74it/s]
2025-03-09 08:27:17,714 [INFO]: 	>>> Finished "Compute fast metrics" in 24.5138 secs
2025-03-09 08:27:17,715 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 113.1037 secs
2025-03-09 08:27:17,715 [INFO]: {
2025-03-09 08:27:17,715 [INFO]: 	index_key: HNSW32
2025-03-09 08:27:17,715 [INFO]: 	index_param: efSearch=90
2025-03-09 08:27:17,715 [INFO]: 	index_path: knn.index
2025-03-09 08:27:17,715 [INFO]: 	size in bytes: 2296211990
2025-03-09 08:27:17,715 [INFO]: 	avg_search_speed_ms: 10.398377720053595
2025-03-09 08:27:17,715 [INFO]: 	99p_search_speed_ms: 20.328791516367342
2025-03-09 08:27:17,715 [INFO]: 	reconstruction error %: 0.0
2025-03-09 08:27:17,715 [INFO]: 	nb vectors: 11663
2025-03-09 08:27:17,715 [INFO]: 	vectors dimension: 49152
2025-03-09 08:27:17,715 [INFO]: 	compression ratio: 0.9986182085914463
2025-03-09 08:27:17,715 [INFO]: }
2025-03-09 08:27:17,716 [INFO]: 	>>> Finished "Creating the index" in 113.1069 secs
2025-03-09 08:27:17,716 [INFO]: >>> Finished "Launching the whole pipeline" in 113.1461 secs
2025-03-09 08:27:19: [retrieval_preprocessing] calculating distances ...
2025-03-09 08:27:21: [retrieval_preprocessing] finished and saved retrieval indices for episode 38656 [episode count 0/20]
[retrieval_preprocessing] for episode 16770 [episode count 1/20], we have num_retrieval=np.int64(11553) num_query=np.int64(679)
2025-03-09 08:27:25,649 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-09 08:27:27,422 [INFO]: Launching the whole pipeline 03/09/2025, 08:27:27
2025-03-09 08:27:27,422 [INFO]: Reading total number of vectors and dimension 03/09/2025, 08:27:27
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 982.04it/s]
2025-03-09 08:27:27,452 [INFO]: There are 11553 embeddings of dim 49152
2025-03-09 08:27:27,452 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0300 secs
2025-03-09 08:27:27,452 [INFO]: 	Compute estimated construction time of the index 03/09/2025, 08:27:27
2025-03-09 08:27:27,452 [INFO]: 		-> Train: 16.7 minutes
2025-03-09 08:27:27,453 [INFO]: 		-> Add: 6.3 seconds
2025-03-09 08:27:27,453 [INFO]: 		Total: 16.8 minutes
2025-03-09 08:27:27,453 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0003 secs
2025-03-09 08:27:27,453 [INFO]: 	Checking that your have enough memory available to create the index 03/09/2025, 08:27:27
2025-03-09 08:27:27,453 [INFO]: 2.3GB of memory will be needed to build the index (more might be used if you have more)
2025-03-09 08:27:27,453 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0005 secs
2025-03-09 08:27:27,453 [INFO]: 	Selecting most promising index types given data characteristics 03/09/2025, 08:27:27
2025-03-09 08:27:27,454 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0001 secs
2025-03-09 08:27:27,454 [INFO]: 	Creating the index 03/09/2025, 08:27:27
2025-03-09 08:27:27,454 [INFO]: 		-> Instanciate the index HNSW32 03/09/2025, 08:27:27
2025-03-09 08:27:27,457 [INFO]: 		>>> Finished "-> Instanciate the index HNSW32" in 0.0028 secs
2025-03-09 08:27:27,457 [INFO]: 		-> Adding the vectors to the index 03/09/2025, 08:27:27
2025-03-09 08:27:27,457 [INFO]: The memory available for adding the vectors is 47.9GB(total available - used by the index)
2025-03-09 08:27:27,458 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/48 [00:00<?, ?it/s]  2%|▏         | 1/48 [00:00<00:10,  4.53it/s]  6%|▋         | 3/48 [00:00<00:05,  8.75it/s] 10%|█         | 5/48 [00:00<00:04, 10.22it/s] 15%|█▍        | 7/48 [00:00<00:03, 11.07it/s] 19%|█▉        | 9/48 [00:00<00:03, 11.45it/s] 23%|██▎       | 11/48 [00:01<00:03, 11.42it/s] 27%|██▋       | 13/48 [00:01<00:02, 11.73it/s] 31%|███▏      | 15/48 [00:01<00:02, 12.32it/s] 35%|███▌      | 17/48 [00:01<00:02, 12.40it/s] 40%|███▉      | 19/48 [00:01<00:02, 12.36it/s] 44%|████▍     | 21/48 [00:07<00:26,  1.02it/s] 52%|█████▏    | 25/48 [00:07<00:12,  1.85it/s] 56%|█████▋    | 27/48 [00:08<00:08,  2.35it/s] 60%|██████    | 29/48 [00:08<00:06,  3.05it/s] 65%|██████▍   | 31/48 [00:08<00:04,  3.92it/s] 69%|██████▉   | 33/48 [00:08<00:03,  4.88it/s] 73%|███████▎  | 35/48 [00:08<00:02,  5.92it/s] 77%|███████▋  | 37/48 [00:08<00:01,  6.97it/s] 81%|████████▏ | 39/48 [00:08<00:01,  7.85it/s] 85%|████████▌ | 41/48 [00:09<00:00,  8.94it/s] 90%|████████▉ | 43/48 [00:17<00:06,  1.32s/it] 94%|█████████▍| 45/48 [00:17<00:02,  1.05it/s] 98%|█████████▊| 47/48 [00:17<00:00,  1.46it/s]100%|██████████| 48/48 [00:21<00:00,  2.25it/s]
2025-03-09 08:27:48,813 [INFO]: 	Computing best hyperparameters for index knn.index 03/09/2025, 08:27:48
2025-03-09 08:29:01,000 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 72.1870 secs
2025-03-09 08:29:01,000 [INFO]: The best hyperparameters are: efSearch=78
2025-03-09 08:29:01,000 [INFO]: 	Compute fast metrics 03/09/2025, 08:29:01
  0%|          | 0/4 [00:00<?, ?it/s] 25%|██▌       | 1/4 [00:00<00:00,  5.07it/s] 50%|█████     | 2/4 [00:00<00:00,  5.61it/s] 75%|███████▌  | 3/4 [00:00<00:00,  6.36it/s] 75%|███████▌  | 3/4 [00:00<00:00,  4.91it/s]
2025-03-09 08:29:20,098 [INFO]: 	>>> Finished "Compute fast metrics" in 19.0979 secs
2025-03-09 08:29:20,099 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 112.6420 secs
2025-03-09 08:29:20,099 [INFO]: {
2025-03-09 08:29:20,099 [INFO]: 	index_key: HNSW32
2025-03-09 08:29:20,099 [INFO]: 	index_param: efSearch=78
2025-03-09 08:29:20,099 [INFO]: 	index_path: knn.index
2025-03-09 08:29:20,099 [INFO]: 	size in bytes: 2274554862
2025-03-09 08:29:20,100 [INFO]: 	avg_search_speed_ms: 9.477997367530708
2025-03-09 08:29:20,100 [INFO]: 	99p_search_speed_ms: 17.524414174258723
2025-03-09 08:29:20,100 [INFO]: 	reconstruction error %: 0.0
2025-03-09 08:29:20,100 [INFO]: 	nb vectors: 11553
2025-03-09 08:29:20,100 [INFO]: 	vectors dimension: 49152
2025-03-09 08:29:20,100 [INFO]: 	compression ratio: 0.9986183503187799
2025-03-09 08:29:20,100 [INFO]: }
2025-03-09 08:29:20,100 [INFO]: 	>>> Finished "Creating the index" in 112.6457 secs
2025-03-09 08:29:20,100 [INFO]: >>> Finished "Launching the whole pipeline" in 112.6775 secs
2025-03-09 08:29:21: [retrieval_preprocessing] calculating distances ...
2025-03-09 08:29:24: [retrieval_preprocessing] finished and saved retrieval indices for episode 16770 [episode count 1/20]
[retrieval_preprocessing] for episode 25090 [episode count 2/20], we have num_retrieval=np.int64(11647) num_query=np.int64(585)
2025-03-09 08:29:28,636 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-09 08:29:30,125 [INFO]: Launching the whole pipeline 03/09/2025, 08:29:30
2025-03-09 08:29:30,125 [INFO]: Reading total number of vectors and dimension 03/09/2025, 08:29:30
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 2284.48it/s]
2025-03-09 08:29:30,155 [INFO]: There are 11647 embeddings of dim 49152
2025-03-09 08:29:30,156 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0307 secs
2025-03-09 08:29:30,156 [INFO]: 	Compute estimated construction time of the index 03/09/2025, 08:29:30
2025-03-09 08:29:30,156 [INFO]: 		-> Train: 16.7 minutes
2025-03-09 08:29:30,156 [INFO]: 		-> Add: 6.4 seconds
2025-03-09 08:29:30,156 [INFO]: 		Total: 16.8 minutes
2025-03-09 08:29:30,156 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0001 secs
2025-03-09 08:29:30,156 [INFO]: 	Checking that your have enough memory available to create the index 03/09/2025, 08:29:30
2025-03-09 08:29:30,156 [INFO]: 2.3GB of memory will be needed to build the index (more might be used if you have more)
2025-03-09 08:29:30,156 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0001 secs
2025-03-09 08:29:30,156 [INFO]: 	Selecting most promising index types given data characteristics 03/09/2025, 08:29:30
2025-03-09 08:29:30,156 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-09 08:29:30,156 [INFO]: 	Creating the index 03/09/2025, 08:29:30
2025-03-09 08:29:30,156 [INFO]: 		-> Instanciate the index HNSW32 03/09/2025, 08:29:30
2025-03-09 08:29:30,157 [INFO]: 		>>> Finished "-> Instanciate the index HNSW32" in 0.0007 secs
2025-03-09 08:29:30,157 [INFO]: 		-> Adding the vectors to the index 03/09/2025, 08:29:30
2025-03-09 08:29:30,157 [INFO]: The memory available for adding the vectors is 47.9GB(total available - used by the index)
2025-03-09 08:29:30,157 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/48 [00:00<?, ?it/s]  2%|▏         | 1/48 [00:00<00:10,  4.58it/s]  6%|▋         | 3/48 [00:00<00:05,  8.88it/s] 10%|█         | 5/48 [00:00<00:03, 10.96it/s] 15%|█▍        | 7/48 [00:00<00:03, 12.02it/s] 19%|█▉        | 9/48 [00:00<00:03, 12.28it/s] 23%|██▎       | 11/48 [00:00<00:02, 12.41it/s] 27%|██▋       | 13/48 [00:01<00:02, 12.56it/s] 31%|███▏      | 15/48 [00:01<00:02, 12.64it/s] 35%|███▌      | 17/48 [00:01<00:02, 12.76it/s] 40%|███▉      | 19/48 [00:01<00:02, 12.78it/s] 44%|████▍     | 21/48 [00:07<00:27,  1.02s/it] 46%|████▌     | 22/48 [00:07<00:22,  1.17it/s] 50%|█████     | 24/48 [00:08<00:14,  1.69it/s] 54%|█████▍    | 26/48 [00:08<00:09,  2.37it/s] 58%|█████▊    | 28/48 [00:08<00:06,  3.18it/s] 62%|██████▎   | 30/48 [00:08<00:04,  4.14it/s] 67%|██████▋   | 32/48 [00:08<00:03,  5.21it/s] 71%|███████   | 34/48 [00:08<00:02,  6.34it/s] 75%|███████▌  | 36/48 [00:09<00:01,  7.46it/s] 79%|███████▉  | 38/48 [00:09<00:01,  8.44it/s] 83%|████████▎ | 40/48 [00:09<00:00,  9.30it/s] 88%|████████▊ | 42/48 [00:16<00:07,  1.21s/it] 92%|█████████▏| 44/48 [00:17<00:03,  1.14it/s] 96%|█████████▌| 46/48 [00:17<00:01,  1.57it/s]100%|██████████| 48/48 [00:21<00:00,  1.06s/it]100%|██████████| 48/48 [00:21<00:00,  2.24it/s]
2025-03-09 08:29:51,553 [INFO]: 	Computing best hyperparameters for index knn.index 03/09/2025, 08:29:51
2025-03-09 08:31:09,386 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 77.8327 secs
2025-03-09 08:31:09,387 [INFO]: The best hyperparameters are: efSearch=95
2025-03-09 08:31:09,387 [INFO]: 	Compute fast metrics 03/09/2025, 08:31:09
  0%|          | 0/4 [00:00<?, ?it/s] 25%|██▌       | 1/4 [00:00<00:00,  6.08it/s] 75%|███████▌  | 3/4 [00:00<00:00, 10.03it/s] 75%|███████▌  | 3/4 [00:00<00:00,  7.73it/s]
2025-03-09 08:31:34,248 [INFO]: 	>>> Finished "Compute fast metrics" in 24.8613 secs
2025-03-09 08:31:34,250 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 124.0925 secs
2025-03-09 08:31:34,250 [INFO]: {
2025-03-09 08:31:34,250 [INFO]: 	index_key: HNSW32
2025-03-09 08:31:34,250 [INFO]: 	index_param: efSearch=95
2025-03-09 08:31:34,250 [INFO]: 	index_path: knn.index
2025-03-09 08:31:34,250 [INFO]: 	size in bytes: 2293061846
2025-03-09 08:31:34,250 [INFO]: 	avg_search_speed_ms: 10.458473309291971
2025-03-09 08:31:34,250 [INFO]: 	99p_search_speed_ms: 16.927515994757425
2025-03-09 08:31:34,250 [INFO]: 	reconstruction error %: 0.0
2025-03-09 08:31:34,250 [INFO]: 	nb vectors: 11647
2025-03-09 08:31:34,250 [INFO]: 	vectors dimension: 49152
2025-03-09 08:31:34,250 [INFO]: 	compression ratio: 0.9986182361345696
2025-03-09 08:31:34,250 [INFO]: }
2025-03-09 08:31:34,250 [INFO]: 	>>> Finished "Creating the index" in 124.0937 secs
2025-03-09 08:31:34,250 [INFO]: >>> Finished "Launching the whole pipeline" in 124.1249 secs
2025-03-09 08:31:36: [retrieval_preprocessing] calculating distances ...
2025-03-09 08:31:37: [retrieval_preprocessing] finished and saved retrieval indices for episode 25090 [episode count 2/20]
[retrieval_preprocessing] for episode 45446 [episode count 3/20], we have num_retrieval=np.int64(11724) num_query=np.int64(508)
2025-03-09 08:31:41,093 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-09 08:31:42,802 [INFO]: Launching the whole pipeline 03/09/2025, 08:31:42
2025-03-09 08:31:42,802 [INFO]: Reading total number of vectors and dimension 03/09/2025, 08:31:42
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1452.82it/s]
2025-03-09 08:31:42,829 [INFO]: There are 11724 embeddings of dim 49152
2025-03-09 08:31:42,829 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0274 secs
2025-03-09 08:31:42,830 [INFO]: 	Compute estimated construction time of the index 03/09/2025, 08:31:42
2025-03-09 08:31:42,830 [INFO]: 		-> Train: 16.7 minutes
2025-03-09 08:31:42,830 [INFO]: 		-> Add: 6.4 seconds
2025-03-09 08:31:42,830 [INFO]: 		Total: 16.8 minutes
2025-03-09 08:31:42,830 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0004 secs
2025-03-09 08:31:42,830 [INFO]: 	Checking that your have enough memory available to create the index 03/09/2025, 08:31:42
2025-03-09 08:31:42,830 [INFO]: 2.4GB of memory will be needed to build the index (more might be used if you have more)
2025-03-09 08:31:42,831 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0005 secs
2025-03-09 08:31:42,831 [INFO]: 	Selecting most promising index types given data characteristics 03/09/2025, 08:31:42
2025-03-09 08:31:42,831 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0001 secs
2025-03-09 08:31:42,831 [INFO]: 	Creating the index 03/09/2025, 08:31:42
2025-03-09 08:31:42,832 [INFO]: 		-> Instanciate the index HNSW32 03/09/2025, 08:31:42
2025-03-09 08:31:42,834 [INFO]: 		>>> Finished "-> Instanciate the index HNSW32" in 0.0027 secs
2025-03-09 08:31:42,834 [INFO]: 		-> Adding the vectors to the index 03/09/2025, 08:31:42
2025-03-09 08:31:42,835 [INFO]: The memory available for adding the vectors is 47.9GB(total available - used by the index)
2025-03-09 08:31:42,835 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/49 [00:00<?, ?it/s]  2%|▏         | 1/49 [00:00<00:09,  5.09it/s]  6%|▌         | 3/49 [00:00<00:05,  9.19it/s] 10%|█         | 5/49 [00:00<00:04, 10.70it/s] 14%|█▍        | 7/49 [00:00<00:03, 11.61it/s] 18%|█▊        | 9/49 [00:00<00:03, 11.68it/s] 22%|██▏       | 11/49 [00:00<00:03, 12.02it/s] 27%|██▋       | 13/49 [00:01<00:02, 12.16it/s] 31%|███       | 15/49 [00:01<00:02, 12.11it/s] 35%|███▍      | 17/49 [00:01<00:02, 12.22it/s] 39%|███▉      | 19/49 [00:01<00:02, 12.01it/s] 43%|████▎     | 21/49 [00:07<00:27,  1.01it/s] 45%|████▍     | 22/49 [00:07<00:22,  1.20it/s] 49%|████▉     | 24/49 [00:07<00:14,  1.74it/s] 53%|█████▎    | 26/49 [00:08<00:09,  2.43it/s] 57%|█████▋    | 28/49 [00:08<00:06,  3.27it/s] 61%|██████    | 30/49 [00:08<00:04,  4.26it/s] 65%|██████▌   | 32/49 [00:08<00:03,  5.37it/s] 69%|██████▉   | 34/49 [00:08<00:02,  6.55it/s] 73%|███████▎  | 36/49 [00:08<00:01,  7.65it/s] 78%|███████▊  | 38/49 [00:09<00:01,  8.68it/s] 82%|████████▏ | 40/49 [00:09<00:00,  9.61it/s] 86%|████████▌ | 42/49 [00:16<00:08,  1.23s/it] 90%|████████▉ | 44/49 [00:17<00:04,  1.14it/s] 94%|█████████▍| 46/49 [00:17<00:01,  1.56it/s] 98%|█████████▊| 48/49 [00:17<00:00,  2.09it/s]100%|██████████| 49/49 [00:21<00:00,  2.31it/s]
2025-03-09 08:32:04,090 [INFO]: 	Computing best hyperparameters for index knn.index 03/09/2025, 08:32:04
2025-03-09 08:33:21,355 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 77.2651 secs
2025-03-09 08:33:21,355 [INFO]: The best hyperparameters are: efSearch=78
2025-03-09 08:33:21,356 [INFO]: 	Compute fast metrics 03/09/2025, 08:33:21
  0%|          | 0/4 [00:00<?, ?it/s] 25%|██▌       | 1/4 [00:00<00:00,  5.14it/s] 50%|█████     | 2/4 [00:00<00:00,  6.74it/s] 75%|███████▌  | 3/4 [00:00<00:00,  7.52it/s] 75%|███████▌  | 3/4 [00:00<00:00,  5.67it/s]
2025-03-09 08:33:41,331 [INFO]: 	>>> Finished "Compute fast metrics" in 19.9758 secs
2025-03-09 08:33:41,333 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 118.4983 secs
2025-03-09 08:33:41,333 [INFO]: {
2025-03-09 08:33:41,333 [INFO]: 	index_key: HNSW32
2025-03-09 08:33:41,333 [INFO]: 	index_param: efSearch=78
2025-03-09 08:33:41,333 [INFO]: 	index_path: knn.index
2025-03-09 08:33:41,333 [INFO]: 	size in bytes: 2308221682
2025-03-09 08:33:41,333 [INFO]: 	avg_search_speed_ms: 9.9991509378269
2025-03-09 08:33:41,333 [INFO]: 	99p_search_speed_ms: 18.647955963388085
2025-03-09 08:33:41,333 [INFO]: 	reconstruction error %: 0.0
2025-03-09 08:33:41,333 [INFO]: 	nb vectors: 11724
2025-03-09 08:33:41,333 [INFO]: 	vectors dimension: 49152
2025-03-09 08:33:41,333 [INFO]: 	compression ratio: 0.9986182046443492
2025-03-09 08:33:41,333 [INFO]: }
2025-03-09 08:33:41,333 [INFO]: 	>>> Finished "Creating the index" in 118.5019 secs
2025-03-09 08:33:41,333 [INFO]: >>> Finished "Launching the whole pipeline" in 118.5316 secs
2025-03-09 08:33:42: [retrieval_preprocessing] calculating distances ...
2025-03-09 08:33:45: [retrieval_preprocessing] finished and saved retrieval indices for episode 45446 [episode count 3/20]
[retrieval_preprocessing] for episode 26631 [episode count 4/20], we have num_retrieval=np.int64(11704) num_query=np.int64(528)
2025-03-09 08:33:48,865 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-09 08:33:50,459 [INFO]: Launching the whole pipeline 03/09/2025, 08:33:50
2025-03-09 08:33:50,459 [INFO]: Reading total number of vectors and dimension 03/09/2025, 08:33:50
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1746.90it/s]
2025-03-09 08:33:50,485 [INFO]: There are 11704 embeddings of dim 49152
2025-03-09 08:33:50,485 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0254 secs
2025-03-09 08:33:50,485 [INFO]: 	Compute estimated construction time of the index 03/09/2025, 08:33:50
2025-03-09 08:33:50,485 [INFO]: 		-> Train: 16.7 minutes
2025-03-09 08:33:50,485 [INFO]: 		-> Add: 6.4 seconds
2025-03-09 08:33:50,485 [INFO]: 		Total: 16.8 minutes
2025-03-09 08:33:50,485 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0001 secs
2025-03-09 08:33:50,485 [INFO]: 	Checking that your have enough memory available to create the index 03/09/2025, 08:33:50
2025-03-09 08:33:50,485 [INFO]: 2.4GB of memory will be needed to build the index (more might be used if you have more)
2025-03-09 08:33:50,485 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0002 secs
2025-03-09 08:33:50,485 [INFO]: 	Selecting most promising index types given data characteristics 03/09/2025, 08:33:50
2025-03-09 08:33:50,485 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-09 08:33:50,485 [INFO]: 	Creating the index 03/09/2025, 08:33:50
2025-03-09 08:33:50,485 [INFO]: 		-> Instanciate the index HNSW32 03/09/2025, 08:33:50
2025-03-09 08:33:50,487 [INFO]: 		>>> Finished "-> Instanciate the index HNSW32" in 0.0011 secs
2025-03-09 08:33:50,487 [INFO]: 		-> Adding the vectors to the index 03/09/2025, 08:33:50
2025-03-09 08:33:50,487 [INFO]: The memory available for adding the vectors is 47.9GB(total available - used by the index)
2025-03-09 08:33:50,487 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/49 [00:00<?, ?it/s]  2%|▏         | 1/49 [00:00<00:11,  4.12it/s]  4%|▍         | 2/49 [00:00<00:07,  5.98it/s]  6%|▌         | 3/49 [00:00<00:06,  7.17it/s]  8%|▊         | 4/49 [00:00<00:05,  7.93it/s] 10%|█         | 5/49 [00:00<00:05,  8.07it/s] 12%|█▏        | 6/49 [00:00<00:05,  8.12it/s] 14%|█▍        | 7/49 [00:00<00:05,  8.15it/s] 16%|█▋        | 8/49 [00:01<00:05,  8.10it/s] 18%|█▊        | 9/49 [00:01<00:04,  8.24it/s] 20%|██        | 10/49 [00:01<00:04,  8.24it/s] 22%|██▏       | 11/49 [00:01<00:04,  8.20it/s] 24%|██▍       | 12/49 [00:01<00:04,  8.14it/s] 27%|██▋       | 13/49 [00:01<00:04,  8.19it/s] 31%|███       | 15/49 [00:01<00:03,  8.76it/s] 33%|███▎      | 16/49 [00:02<00:04,  7.81it/s] 35%|███▍      | 17/49 [00:02<00:03,  8.05it/s] 37%|███▋      | 18/49 [00:02<00:03,  8.26it/s] 39%|███▉      | 19/49 [00:02<00:03,  8.41it/s] 41%|████      | 20/49 [00:02<00:03,  8.55it/s] 43%|████▎     | 21/49 [00:08<00:49,  1.76s/it] 47%|████▋     | 23/49 [00:08<00:26,  1.00s/it] 51%|█████     | 25/49 [00:08<00:15,  1.56it/s] 55%|█████▌    | 27/49 [00:08<00:09,  2.27it/s] 59%|█████▉    | 29/49 [00:08<00:06,  3.15it/s] 63%|██████▎   | 31/49 [00:09<00:04,  4.17it/s] 67%|██████▋   | 33/49 [00:09<00:03,  5.28it/s] 71%|███████▏  | 35/49 [00:09<00:02,  6.44it/s] 76%|███████▌  | 37/49 [00:09<00:01,  7.40it/s] 80%|███████▉  | 39/49 [00:09<00:01,  8.27it/s] 84%|████████▎ | 41/49 [00:09<00:00,  8.94it/s] 88%|████████▊ | 43/49 [00:17<00:07,  1.21s/it] 92%|█████████▏| 45/49 [00:17<00:03,  1.16it/s] 96%|█████████▌| 47/49 [00:17<00:01,  1.61it/s]100%|██████████| 49/49 [00:21<00:00,  1.08s/it]100%|██████████| 49/49 [00:21<00:00,  2.23it/s]
2025-03-09 08:34:12,451 [INFO]: 	Computing best hyperparameters for index knn.index 03/09/2025, 08:34:12
2025-03-09 08:35:31,917 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 79.4645 secs
2025-03-09 08:35:31,917 [INFO]: The best hyperparameters are: efSearch=86
2025-03-09 08:35:31,917 [INFO]: 	Compute fast metrics 03/09/2025, 08:35:31
  0%|          | 0/4 [00:00<?, ?it/s] 25%|██▌       | 1/4 [00:00<00:00,  6.42it/s] 75%|███████▌  | 3/4 [00:00<00:00,  9.51it/s] 75%|███████▌  | 3/4 [00:00<00:00,  7.18it/s]
2025-03-09 08:36:04,806 [INFO]: 	>>> Finished "Compute fast metrics" in 32.8895 secs
2025-03-09 08:36:04,808 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 134.3212 secs
2025-03-09 08:36:04,808 [INFO]: {
2025-03-09 08:36:04,808 [INFO]: 	index_key: HNSW32
2025-03-09 08:36:04,808 [INFO]: 	index_param: efSearch=86
2025-03-09 08:36:04,808 [INFO]: 	index_path: knn.index
2025-03-09 08:36:04,808 [INFO]: 	size in bytes: 2304284034
2025-03-09 08:36:04,808 [INFO]: 	avg_search_speed_ms: 10.710874313390883
2025-03-09 08:36:04,808 [INFO]: 	99p_search_speed_ms: 20.94486494781448
2025-03-09 08:36:04,808 [INFO]: 	reconstruction error %: 0.0
2025-03-09 08:36:04,808 [INFO]: 	nb vectors: 11704
2025-03-09 08:36:04,808 [INFO]: 	vectors dimension: 49152
2025-03-09 08:36:04,808 [INFO]: 	compression ratio: 0.9986182250308471
2025-03-09 08:36:04,808 [INFO]: }
2025-03-09 08:36:04,808 [INFO]: 	>>> Finished "Creating the index" in 134.3228 secs
2025-03-09 08:36:04,808 [INFO]: >>> Finished "Launching the whole pipeline" in 134.3488 secs
2025-03-09 08:36:06: [retrieval_preprocessing] calculating distances ...
2025-03-09 08:36:08: [retrieval_preprocessing] finished and saved retrieval indices for episode 26631 [episode count 4/20]
[retrieval_preprocessing] for episode 15240 [episode count 5/20], we have num_retrieval=np.int64(11690) num_query=np.int64(542)
2025-03-09 08:36:13,041 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-09 08:36:14,967 [INFO]: Launching the whole pipeline 03/09/2025, 08:36:14
2025-03-09 08:36:14,967 [INFO]: Reading total number of vectors and dimension 03/09/2025, 08:36:14
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1166.70it/s]
2025-03-09 08:36:15,185 [INFO]: There are 11690 embeddings of dim 49152
2025-03-09 08:36:15,185 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.2181 secs
2025-03-09 08:36:15,185 [INFO]: 	Compute estimated construction time of the index 03/09/2025, 08:36:15
2025-03-09 08:36:15,186 [INFO]: 		-> Train: 16.7 minutes
2025-03-09 08:36:15,186 [INFO]: 		-> Add: 6.4 seconds
2025-03-09 08:36:15,186 [INFO]: 		Total: 16.8 minutes
2025-03-09 08:36:15,186 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0001 secs
2025-03-09 08:36:15,186 [INFO]: 	Checking that your have enough memory available to create the index 03/09/2025, 08:36:15
2025-03-09 08:36:15,186 [INFO]: 2.4GB of memory will be needed to build the index (more might be used if you have more)
2025-03-09 08:36:15,186 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0002 secs
2025-03-09 08:36:15,186 [INFO]: 	Selecting most promising index types given data characteristics 03/09/2025, 08:36:15
2025-03-09 08:36:15,186 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-09 08:36:15,186 [INFO]: 	Creating the index 03/09/2025, 08:36:15
2025-03-09 08:36:15,186 [INFO]: 		-> Instanciate the index HNSW32 03/09/2025, 08:36:15
2025-03-09 08:36:15,188 [INFO]: 		>>> Finished "-> Instanciate the index HNSW32" in 0.0016 secs
2025-03-09 08:36:15,188 [INFO]: 		-> Adding the vectors to the index 03/09/2025, 08:36:15
2025-03-09 08:36:15,188 [INFO]: The memory available for adding the vectors is 47.9GB(total available - used by the index)
2025-03-09 08:36:15,188 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/48 [00:00<?, ?it/s]  2%|▏         | 1/48 [00:00<00:12,  3.78it/s]  6%|▋         | 3/48 [00:00<00:06,  7.40it/s]  8%|▊         | 4/48 [00:00<00:05,  7.97it/s] 12%|█▎        | 6/48 [00:00<00:04,  9.60it/s] 17%|█▋        | 8/48 [00:00<00:03, 10.73it/s] 21%|██        | 10/48 [00:01<00:03, 11.24it/s] 25%|██▌       | 12/48 [00:01<00:03, 11.51it/s] 29%|██▉       | 14/48 [00:01<00:02, 12.49it/s] 33%|███▎      | 16/48 [00:01<00:02, 12.78it/s] 38%|███▊      | 18/48 [00:01<00:02, 12.65it/s] 42%|████▏     | 20/48 [00:01<00:02, 12.68it/s] 46%|████▌     | 22/48 [00:08<00:27,  1.04s/it] 52%|█████▏    | 25/48 [00:08<00:14,  1.56it/s] 58%|█████▊    | 28/48 [00:08<00:08,  2.37it/s] 62%|██████▎   | 30/48 [00:08<00:06,  2.90it/s] 67%|██████▋   | 32/48 [00:08<00:04,  3.62it/s] 71%|███████   | 34/48 [00:09<00:03,  4.52it/s] 75%|███████▌  | 36/48 [00:09<00:02,  5.50it/s] 79%|███████▉  | 38/48 [00:09<00:01,  6.53it/s] 83%|████████▎ | 40/48 [00:09<00:01,  7.63it/s] 88%|████████▊ | 42/48 [00:18<00:08,  1.43s/it] 90%|████████▉ | 43/48 [00:18<00:05,  1.20s/it] 92%|█████████▏| 44/48 [00:18<00:03,  1.02it/s] 94%|█████████▍| 45/48 [00:18<00:02,  1.27it/s] 96%|█████████▌| 46/48 [00:18<00:01,  1.60it/s]100%|██████████| 48/48 [00:23<00:00,  1.24s/it]100%|██████████| 48/48 [00:23<00:00,  2.06it/s]
2025-03-09 08:36:38,463 [INFO]: 	Computing best hyperparameters for index knn.index 03/09/2025, 08:36:38
2025-03-09 08:37:53,298 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 74.8338 secs
2025-03-09 08:37:53,298 [INFO]: The best hyperparameters are: efSearch=30
2025-03-09 08:37:53,298 [INFO]: 	Compute fast metrics 03/09/2025, 08:37:53
  0%|          | 0/4 [00:00<?, ?it/s] 25%|██▌       | 1/4 [00:00<00:00,  6.16it/s] 75%|███████▌  | 3/4 [00:00<00:00,  8.78it/s] 75%|███████▌  | 3/4 [00:00<00:00,  6.44it/s]
2025-03-09 08:38:23,525 [INFO]: 	>>> Finished "Compute fast metrics" in 30.2271 secs
2025-03-09 08:38:23,527 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 128.3388 secs
2025-03-09 08:38:23,527 [INFO]: {
2025-03-09 08:38:23,527 [INFO]: 	index_key: HNSW32
2025-03-09 08:38:23,527 [INFO]: 	index_param: efSearch=30
2025-03-09 08:38:23,527 [INFO]: 	index_path: knn.index
2025-03-09 08:38:23,527 [INFO]: 	size in bytes: 2301527770
2025-03-09 08:38:23,527 [INFO]: 	avg_search_speed_ms: 5.929612559578302
2025-03-09 08:38:23,527 [INFO]: 	99p_search_speed_ms: 12.92442327830939
2025-03-09 08:38:23,527 [INFO]: 	reconstruction error %: 0.0
2025-03-09 08:38:23,527 [INFO]: 	nb vectors: 11690
2025-03-09 08:38:23,527 [INFO]: 	vectors dimension: 49152
2025-03-09 08:38:23,527 [INFO]: 	compression ratio: 0.9986182004660322
2025-03-09 08:38:23,527 [INFO]: }
2025-03-09 08:38:23,527 [INFO]: 	>>> Finished "Creating the index" in 128.3411 secs
2025-03-09 08:38:23,527 [INFO]: >>> Finished "Launching the whole pipeline" in 128.5600 secs
2025-03-09 08:38:24: [retrieval_preprocessing] calculating distances ...
2025-03-09 08:38:26: [retrieval_preprocessing] finished and saved retrieval indices for episode 15240 [episode count 5/20]
[retrieval_preprocessing] for episode 86791 [episode count 6/20], we have num_retrieval=np.int64(11593) num_query=np.int64(639)
2025-03-09 08:38:30,437 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-09 08:38:32,071 [INFO]: Launching the whole pipeline 03/09/2025, 08:38:32
2025-03-09 08:38:32,071 [INFO]: Reading total number of vectors and dimension 03/09/2025, 08:38:32
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1110.19it/s]
2025-03-09 08:38:32,102 [INFO]: There are 11593 embeddings of dim 49152
2025-03-09 08:38:32,103 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0318 secs
2025-03-09 08:38:32,103 [INFO]: 	Compute estimated construction time of the index 03/09/2025, 08:38:32
2025-03-09 08:38:32,103 [INFO]: 		-> Train: 16.7 minutes
2025-03-09 08:38:32,103 [INFO]: 		-> Add: 6.4 seconds
2025-03-09 08:38:32,103 [INFO]: 		Total: 16.8 minutes
2025-03-09 08:38:32,103 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0003 secs
2025-03-09 08:38:32,103 [INFO]: 	Checking that your have enough memory available to create the index 03/09/2025, 08:38:32
2025-03-09 08:38:32,104 [INFO]: 2.3GB of memory will be needed to build the index (more might be used if you have more)
2025-03-09 08:38:32,104 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0006 secs
2025-03-09 08:38:32,104 [INFO]: 	Selecting most promising index types given data characteristics 03/09/2025, 08:38:32
2025-03-09 08:38:32,104 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0001 secs
2025-03-09 08:38:32,105 [INFO]: 	Creating the index 03/09/2025, 08:38:32
2025-03-09 08:38:32,105 [INFO]: 		-> Instanciate the index HNSW32 03/09/2025, 08:38:32
2025-03-09 08:38:32,108 [INFO]: 		>>> Finished "-> Instanciate the index HNSW32" in 0.0030 secs
2025-03-09 08:38:32,108 [INFO]: 		-> Adding the vectors to the index 03/09/2025, 08:38:32
2025-03-09 08:38:32,108 [INFO]: The memory available for adding the vectors is 47.9GB(total available - used by the index)
2025-03-09 08:38:32,109 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/48 [00:00<?, ?it/s]  2%|▏         | 1/48 [00:00<00:10,  4.37it/s]  6%|▋         | 3/48 [00:00<00:05,  8.51it/s] 10%|█         | 5/48 [00:00<00:04,  9.93it/s] 15%|█▍        | 7/48 [00:00<00:03, 10.44it/s] 19%|█▉        | 9/48 [00:00<00:03, 10.71it/s] 23%|██▎       | 11/48 [00:01<00:03, 10.86it/s] 27%|██▋       | 13/48 [00:01<00:03, 10.82it/s] 31%|███▏      | 15/48 [00:01<00:02, 11.02it/s] 35%|███▌      | 17/48 [00:01<00:02, 11.12it/s] 40%|███▉      | 19/48 [00:01<00:02, 11.01it/s] 44%|████▍     | 21/48 [00:08<00:28,  1.05s/it] 48%|████▊     | 23/48 [00:08<00:18,  1.33it/s] 52%|█████▏    | 25/48 [00:08<00:12,  1.82it/s] 56%|█████▋    | 27/48 [00:08<00:08,  2.47it/s] 60%|██████    | 29/48 [00:08<00:05,  3.26it/s] 65%|██████▍   | 31/48 [00:09<00:04,  4.20it/s] 69%|██████▉   | 33/48 [00:09<00:02,  5.27it/s] 73%|███████▎  | 35/48 [00:09<00:02,  6.40it/s] 77%|███████▋  | 37/48 [00:09<00:01,  7.52it/s] 81%|████████▏ | 39/48 [00:09<00:01,  8.47it/s] 85%|████████▌ | 41/48 [00:09<00:00,  9.33it/s] 90%|████████▉ | 43/48 [00:17<00:06,  1.23s/it] 94%|█████████▍| 45/48 [00:17<00:02,  1.13it/s] 98%|█████████▊| 47/48 [00:17<00:00,  1.55it/s]100%|██████████| 48/48 [00:22<00:00,  2.17it/s]
2025-03-09 08:38:54,211 [INFO]: 	Computing best hyperparameters for index knn.index 03/09/2025, 08:38:54
2025-03-09 08:40:05,593 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 71.3815 secs
2025-03-09 08:40:05,593 [INFO]: The best hyperparameters are: efSearch=68
2025-03-09 08:40:05,593 [INFO]: 	Compute fast metrics 03/09/2025, 08:40:05
  0%|          | 0/4 [00:00<?, ?it/s] 25%|██▌       | 1/4 [00:00<00:00,  5.32it/s] 75%|███████▌  | 3/4 [00:00<00:00,  7.97it/s] 75%|███████▌  | 3/4 [00:00<00:00,  5.94it/s]
2025-03-09 08:40:35,666 [INFO]: 	>>> Finished "Compute fast metrics" in 30.0725 secs
2025-03-09 08:40:35,783 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 123.6748 secs
2025-03-09 08:40:35,783 [INFO]: {
2025-03-09 08:40:35,784 [INFO]: 	index_key: HNSW32
2025-03-09 08:40:35,784 [INFO]: 	index_param: efSearch=68
2025-03-09 08:40:35,784 [INFO]: 	index_path: knn.index
2025-03-09 08:40:35,784 [INFO]: 	size in bytes: 2282430030
2025-03-09 08:40:35,784 [INFO]: 	avg_search_speed_ms: 8.256712825553572
2025-03-09 08:40:35,784 [INFO]: 	99p_search_speed_ms: 14.416992478072647
2025-03-09 08:40:35,784 [INFO]: 	reconstruction error %: 0.0
2025-03-09 08:40:35,784 [INFO]: 	nb vectors: 11593
2025-03-09 08:40:35,784 [INFO]: 	vectors dimension: 49152
2025-03-09 08:40:35,784 [INFO]: 	compression ratio: 0.9986183646558489
2025-03-09 08:40:35,784 [INFO]: }
2025-03-09 08:40:35,784 [INFO]: 	>>> Finished "Creating the index" in 123.6794 secs
2025-03-09 08:40:35,784 [INFO]: >>> Finished "Launching the whole pipeline" in 123.7135 secs
2025-03-09 08:40:37: [retrieval_preprocessing] calculating distances ...
2025-03-09 08:40:39: [retrieval_preprocessing] finished and saved retrieval indices for episode 86791 [episode count 6/20]
[retrieval_preprocessing] for episode 27146 [episode count 7/20], we have num_retrieval=np.int64(11812) num_query=np.int64(420)
2025-03-09 08:40:43,181 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-09 08:40:44,756 [INFO]: Launching the whole pipeline 03/09/2025, 08:40:44
2025-03-09 08:40:44,756 [INFO]: Reading total number of vectors and dimension 03/09/2025, 08:40:44
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1977.51it/s]
2025-03-09 08:40:44,780 [INFO]: There are 11812 embeddings of dim 49152
2025-03-09 08:40:44,780 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0234 secs
2025-03-09 08:40:44,780 [INFO]: 	Compute estimated construction time of the index 03/09/2025, 08:40:44
2025-03-09 08:40:44,780 [INFO]: 		-> Train: 16.7 minutes
2025-03-09 08:40:44,780 [INFO]: 		-> Add: 6.5 seconds
2025-03-09 08:40:44,780 [INFO]: 		Total: 16.8 minutes
2025-03-09 08:40:44,780 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0001 secs
2025-03-09 08:40:44,780 [INFO]: 	Checking that your have enough memory available to create the index 03/09/2025, 08:40:44
2025-03-09 08:40:44,780 [INFO]: 2.4GB of memory will be needed to build the index (more might be used if you have more)
2025-03-09 08:40:44,780 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0002 secs
2025-03-09 08:40:44,780 [INFO]: 	Selecting most promising index types given data characteristics 03/09/2025, 08:40:44
2025-03-09 08:40:44,780 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-09 08:40:44,780 [INFO]: 	Creating the index 03/09/2025, 08:40:44
2025-03-09 08:40:44,780 [INFO]: 		-> Instanciate the index HNSW32 03/09/2025, 08:40:44
2025-03-09 08:40:44,782 [INFO]: 		>>> Finished "-> Instanciate the index HNSW32" in 0.0012 secs
2025-03-09 08:40:44,782 [INFO]: 		-> Adding the vectors to the index 03/09/2025, 08:40:44
2025-03-09 08:40:44,782 [INFO]: The memory available for adding the vectors is 47.8GB(total available - used by the index)
2025-03-09 08:40:44,782 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/49 [00:00<?, ?it/s]  2%|▏         | 1/49 [00:00<00:12,  3.89it/s]  4%|▍         | 2/49 [00:00<00:08,  5.78it/s]  6%|▌         | 3/49 [00:00<00:06,  7.03it/s]  8%|▊         | 4/49 [00:00<00:05,  7.87it/s] 10%|█         | 5/49 [00:00<00:05,  8.43it/s] 12%|█▏        | 6/49 [00:00<00:04,  8.88it/s] 14%|█▍        | 7/49 [00:00<00:04,  9.10it/s] 16%|█▋        | 8/49 [00:00<00:04,  9.25it/s] 18%|█▊        | 9/49 [00:01<00:04,  9.40it/s] 22%|██▏       | 11/49 [00:01<00:03,  9.53it/s] 24%|██▍       | 12/49 [00:01<00:03,  9.34it/s] 27%|██▋       | 13/49 [00:01<00:03,  9.16it/s] 29%|██▊       | 14/49 [00:01<00:03,  9.04it/s] 31%|███       | 15/49 [00:01<00:03,  8.98it/s] 33%|███▎      | 16/49 [00:01<00:03,  9.18it/s] 37%|███▋      | 18/49 [00:02<00:02, 10.39it/s] 41%|████      | 20/49 [00:02<00:02, 11.03it/s] 45%|████▍     | 22/49 [00:07<00:26,  1.01it/s] 49%|████▉     | 24/49 [00:07<00:17,  1.46it/s] 53%|█████▎    | 26/49 [00:07<00:11,  2.06it/s] 57%|█████▋    | 28/49 [00:07<00:07,  2.86it/s] 61%|██████    | 30/49 [00:07<00:04,  3.87it/s] 65%|██████▌   | 32/49 [00:08<00:03,  5.07it/s] 69%|██████▉   | 34/49 [00:08<00:02,  6.33it/s] 73%|███████▎  | 36/49 [00:08<00:01,  7.38it/s] 78%|███████▊  | 38/49 [00:08<00:01,  8.19it/s] 82%|████████▏ | 40/49 [00:08<00:00,  9.00it/s] 86%|████████▌ | 42/49 [00:16<00:08,  1.20s/it] 90%|████████▉ | 44/49 [00:16<00:04,  1.15it/s] 92%|█████████▏| 45/49 [00:16<00:02,  1.34it/s] 96%|█████████▌| 47/49 [00:16<00:01,  1.91it/s]100%|██████████| 49/49 [00:21<00:00,  1.05s/it]100%|██████████| 49/49 [00:21<00:00,  2.33it/s]
2025-03-09 08:41:05,803 [INFO]: 	Computing best hyperparameters for index knn.index 03/09/2025, 08:41:05
2025-03-09 08:42:22,025 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 76.2217 secs
2025-03-09 08:42:22,025 [INFO]: The best hyperparameters are: efSearch=61
2025-03-09 08:42:22,025 [INFO]: 	Compute fast metrics 03/09/2025, 08:42:22
  0%|          | 0/4 [00:00<?, ?it/s] 25%|██▌       | 1/4 [00:00<00:00,  4.72it/s] 75%|███████▌  | 3/4 [00:00<00:00,  8.62it/s] 75%|███████▌  | 3/4 [00:00<00:00,  6.63it/s]
2025-03-09 08:42:50,171 [INFO]: 	>>> Finished "Compute fast metrics" in 28.1458 secs
2025-03-09 08:42:50,172 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 125.3907 secs
2025-03-09 08:42:50,173 [INFO]: {
2025-03-09 08:42:50,173 [INFO]: 	index_key: HNSW32
2025-03-09 08:42:50,173 [INFO]: 	index_param: efSearch=61
2025-03-09 08:42:50,173 [INFO]: 	index_path: knn.index
2025-03-09 08:42:50,173 [INFO]: 	size in bytes: 2325547154
2025-03-09 08:42:50,173 [INFO]: 	avg_search_speed_ms: 8.504535583937605
2025-03-09 08:42:50,173 [INFO]: 	99p_search_speed_ms: 18.916389148216695
2025-03-09 08:42:50,173 [INFO]: 	reconstruction error %: 0.0
2025-03-09 08:42:50,173 [INFO]: 	nb vectors: 11812
2025-03-09 08:42:50,173 [INFO]: 	vectors dimension: 49152
2025-03-09 08:42:50,173 [INFO]: 	compression ratio: 0.9986181927145735
2025-03-09 08:42:50,173 [INFO]: }
2025-03-09 08:42:50,173 [INFO]: 	>>> Finished "Creating the index" in 125.3924 secs
2025-03-09 08:42:50,173 [INFO]: >>> Finished "Launching the whole pipeline" in 125.4165 secs
2025-03-09 08:42:51: [retrieval_preprocessing] calculating distances ...
2025-03-09 08:42:52: [retrieval_preprocessing] finished and saved retrieval indices for episode 27146 [episode count 7/20]
[retrieval_preprocessing] for episode 35981 [episode count 8/20], we have num_retrieval=np.int64(11576) num_query=np.int64(656)
2025-03-09 08:42:56,076 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-09 08:42:58,029 [INFO]: Launching the whole pipeline 03/09/2025, 08:42:58
2025-03-09 08:42:58,029 [INFO]: Reading total number of vectors and dimension 03/09/2025, 08:42:58
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1441.34it/s]
2025-03-09 08:42:58,057 [INFO]: There are 11576 embeddings of dim 49152
2025-03-09 08:42:58,058 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0288 secs
2025-03-09 08:42:58,058 [INFO]: 	Compute estimated construction time of the index 03/09/2025, 08:42:58
2025-03-09 08:42:58,058 [INFO]: 		-> Train: 16.7 minutes
2025-03-09 08:42:58,058 [INFO]: 		-> Add: 6.4 seconds
2025-03-09 08:42:58,058 [INFO]: 		Total: 16.8 minutes
2025-03-09 08:42:58,058 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0002 secs
2025-03-09 08:42:58,058 [INFO]: 	Checking that your have enough memory available to create the index 03/09/2025, 08:42:58
2025-03-09 08:42:58,058 [INFO]: 2.3GB of memory will be needed to build the index (more might be used if you have more)
2025-03-09 08:42:58,058 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0002 secs
2025-03-09 08:42:58,058 [INFO]: 	Selecting most promising index types given data characteristics 03/09/2025, 08:42:58
2025-03-09 08:42:58,058 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-09 08:42:58,058 [INFO]: 	Creating the index 03/09/2025, 08:42:58
2025-03-09 08:42:58,058 [INFO]: 		-> Instanciate the index HNSW32 03/09/2025, 08:42:58
2025-03-09 08:42:58,059 [INFO]: 		>>> Finished "-> Instanciate the index HNSW32" in 0.0010 secs
2025-03-09 08:42:58,060 [INFO]: 		-> Adding the vectors to the index 03/09/2025, 08:42:58
2025-03-09 08:42:58,060 [INFO]: The memory available for adding the vectors is 47.9GB(total available - used by the index)
2025-03-09 08:42:58,060 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/48 [00:00<?, ?it/s]  2%|▏         | 1/48 [00:00<00:11,  4.16it/s]  4%|▍         | 2/48 [00:00<00:07,  5.97it/s]  6%|▋         | 3/48 [00:00<00:06,  6.91it/s]  8%|▊         | 4/48 [00:00<00:05,  7.48it/s] 10%|█         | 5/48 [00:00<00:05,  7.81it/s] 12%|█▎        | 6/48 [00:00<00:05,  8.11it/s] 15%|█▍        | 7/48 [00:00<00:05,  8.15it/s] 17%|█▋        | 8/48 [00:01<00:04,  8.28it/s] 19%|█▉        | 9/48 [00:01<00:04,  8.36it/s] 21%|██        | 10/48 [00:01<00:04,  8.41it/s] 23%|██▎       | 11/48 [00:01<00:04,  8.50it/s] 25%|██▌       | 12/48 [00:01<00:04,  8.56it/s] 27%|██▋       | 13/48 [00:01<00:04,  8.59it/s] 29%|██▉       | 14/48 [00:01<00:03,  8.54it/s] 31%|███▏      | 15/48 [00:01<00:03,  8.59it/s] 35%|███▌      | 17/48 [00:02<00:03, 10.05it/s] 40%|███▉      | 19/48 [00:02<00:02, 10.65it/s] 44%|████▍     | 21/48 [00:08<00:31,  1.18s/it] 48%|████▊     | 23/48 [00:08<00:20,  1.24it/s] 52%|█████▏    | 25/48 [00:08<00:13,  1.75it/s] 56%|█████▋    | 27/48 [00:08<00:08,  2.40it/s] 60%|██████    | 29/48 [00:09<00:05,  3.22it/s] 65%|██████▍   | 31/48 [00:09<00:04,  4.17it/s] 69%|██████▉   | 33/48 [00:09<00:02,  5.21it/s] 73%|███████▎  | 35/48 [00:09<00:02,  6.29it/s] 77%|███████▋  | 37/48 [00:09<00:01,  7.38it/s] 81%|████████▏ | 39/48 [00:09<00:01,  8.37it/s] 85%|████████▌ | 41/48 [00:10<00:00,  8.98it/s] 90%|████████▉ | 43/48 [00:17<00:06,  1.21s/it] 94%|█████████▍| 45/48 [00:17<00:02,  1.15it/s] 98%|█████████▊| 47/48 [00:17<00:00,  1.59it/s]100%|██████████| 48/48 [00:21<00:00,  2.23it/s]
2025-03-09 08:43:19,636 [INFO]: 	Computing best hyperparameters for index knn.index 03/09/2025, 08:43:19
2025-03-09 08:44:36,816 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 77.1790 secs
2025-03-09 08:44:36,816 [INFO]: The best hyperparameters are: efSearch=103
2025-03-09 08:44:36,816 [INFO]: 	Compute fast metrics 03/09/2025, 08:44:36
  0%|          | 0/4 [00:00<?, ?it/s] 25%|██▌       | 1/4 [00:00<00:00,  6.46it/s] 75%|███████▌  | 3/4 [00:00<00:00, 13.31it/s]
2025-03-09 08:45:04,064 [INFO]: 	>>> Finished "Compute fast metrics" in 27.2479 secs
2025-03-09 08:45:04,066 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 126.0066 secs
2025-03-09 08:45:04,067 [INFO]: {
2025-03-09 08:45:04,067 [INFO]: 	index_key: HNSW32
2025-03-09 08:45:04,067 [INFO]: 	index_param: efSearch=103
2025-03-09 08:45:04,067 [INFO]: 	index_path: knn.index
2025-03-09 08:45:04,067 [INFO]: 	size in bytes: 2279083138
2025-03-09 08:45:04,067 [INFO]: 	avg_search_speed_ms: 12.950847237425124
2025-03-09 08:45:04,067 [INFO]: 	99p_search_speed_ms: 41.58824481070041
2025-03-09 08:45:04,067 [INFO]: 	reconstruction error %: 0.0
2025-03-09 08:45:04,067 [INFO]: 	nb vectors: 11576
2025-03-09 08:45:04,067 [INFO]: 	vectors dimension: 49152
2025-03-09 08:45:04,067 [INFO]: 	compression ratio: 0.998618334738432
2025-03-09 08:45:04,067 [INFO]: }
2025-03-09 08:45:04,067 [INFO]: 	>>> Finished "Creating the index" in 126.0084 secs
2025-03-09 08:45:04,067 [INFO]: >>> Finished "Launching the whole pipeline" in 126.0381 secs
2025-03-09 08:45:06: [retrieval_preprocessing] calculating distances ...
2025-03-09 08:45:08: [retrieval_preprocessing] finished and saved retrieval indices for episode 35981 [episode count 8/20]
[retrieval_preprocessing] for episode 76173 [episode count 9/20], we have num_retrieval=np.int64(11640) num_query=np.int64(592)
2025-03-09 08:45:12,300 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-09 08:45:14,313 [INFO]: Launching the whole pipeline 03/09/2025, 08:45:14
2025-03-09 08:45:14,313 [INFO]: Reading total number of vectors and dimension 03/09/2025, 08:45:14
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1511.46it/s]
2025-03-09 08:45:14,349 [INFO]: There are 11640 embeddings of dim 49152
2025-03-09 08:45:14,350 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0363 secs
2025-03-09 08:45:14,350 [INFO]: 	Compute estimated construction time of the index 03/09/2025, 08:45:14
2025-03-09 08:45:14,350 [INFO]: 		-> Train: 16.7 minutes
2025-03-09 08:45:14,350 [INFO]: 		-> Add: 6.4 seconds
2025-03-09 08:45:14,350 [INFO]: 		Total: 16.8 minutes
2025-03-09 08:45:14,350 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0001 secs
2025-03-09 08:45:14,350 [INFO]: 	Checking that your have enough memory available to create the index 03/09/2025, 08:45:14
2025-03-09 08:45:14,350 [INFO]: 2.3GB of memory will be needed to build the index (more might be used if you have more)
2025-03-09 08:45:14,350 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0002 secs
2025-03-09 08:45:14,350 [INFO]: 	Selecting most promising index types given data characteristics 03/09/2025, 08:45:14
2025-03-09 08:45:14,350 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-09 08:45:14,350 [INFO]: 	Creating the index 03/09/2025, 08:45:14
2025-03-09 08:45:14,350 [INFO]: 		-> Instanciate the index HNSW32 03/09/2025, 08:45:14
2025-03-09 08:45:14,351 [INFO]: 		>>> Finished "-> Instanciate the index HNSW32" in 0.0009 secs
2025-03-09 08:45:14,351 [INFO]: 		-> Adding the vectors to the index 03/09/2025, 08:45:14
2025-03-09 08:45:14,351 [INFO]: The memory available for adding the vectors is 47.9GB(total available - used by the index)
2025-03-09 08:45:14,351 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/48 [00:00<?, ?it/s]  2%|▏         | 1/48 [00:00<00:11,  4.03it/s]  4%|▍         | 2/48 [00:00<00:08,  5.22it/s]  6%|▋         | 3/48 [00:00<00:07,  6.39it/s]  8%|▊         | 4/48 [00:00<00:05,  7.44it/s] 10%|█         | 5/48 [00:00<00:05,  7.81it/s] 12%|█▎        | 6/48 [00:00<00:05,  8.07it/s] 15%|█▍        | 7/48 [00:00<00:04,  8.56it/s] 17%|█▋        | 8/48 [00:01<00:04,  8.77it/s] 19%|█▉        | 9/48 [00:01<00:04,  9.00it/s] 21%|██        | 10/48 [00:01<00:04,  8.96it/s] 23%|██▎       | 11/48 [00:01<00:04,  9.04it/s] 25%|██▌       | 12/48 [00:01<00:03,  9.12it/s] 27%|██▋       | 13/48 [00:01<00:03,  9.09it/s] 29%|██▉       | 14/48 [00:01<00:03,  9.04it/s] 31%|███▏      | 15/48 [00:01<00:03,  8.86it/s] 35%|███▌      | 17/48 [00:01<00:03, 10.11it/s] 40%|███▉      | 19/48 [00:02<00:02, 10.36it/s] 44%|████▍     | 21/48 [00:08<00:30,  1.12s/it] 46%|████▌     | 22/48 [00:08<00:23,  1.10it/s] 50%|█████     | 24/48 [00:08<00:14,  1.66it/s] 54%|█████▍    | 26/48 [00:08<00:09,  2.35it/s] 58%|█████▊    | 28/48 [00:08<00:06,  3.24it/s] 62%|██████▎   | 30/48 [00:08<00:04,  4.29it/s] 67%|██████▋   | 32/48 [00:08<00:02,  5.46it/s] 71%|███████   | 34/48 [00:09<00:02,  6.67it/s] 75%|███████▌  | 36/48 [00:09<00:01,  7.74it/s] 79%|███████▉  | 38/48 [00:09<00:01,  7.64it/s] 83%|████████▎ | 40/48 [00:09<00:00,  8.69it/s] 88%|████████▊ | 42/48 [00:17<00:07,  1.33s/it] 94%|█████████▍| 45/48 [00:18<00:02,  1.21it/s]100%|██████████| 48/48 [00:22<00:00,  1.11s/it]100%|██████████| 48/48 [00:22<00:00,  2.10it/s]
2025-03-09 08:45:37,214 [INFO]: 	Computing best hyperparameters for index knn.index 03/09/2025, 08:45:37
2025-03-09 08:47:02,212 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 84.9974 secs
2025-03-09 08:47:02,212 [INFO]: The best hyperparameters are: efSearch=64
2025-03-09 08:47:02,212 [INFO]: 	Compute fast metrics 03/09/2025, 08:47:02
  0%|          | 0/4 [00:00<?, ?it/s] 25%|██▌       | 1/4 [00:00<00:00,  5.31it/s] 50%|█████     | 2/4 [00:00<00:00,  6.98it/s] 75%|███████▌  | 3/4 [00:00<00:00,  7.76it/s] 75%|███████▌  | 3/4 [00:00<00:00,  5.85it/s]
2025-03-09 08:47:37,679 [INFO]: 	>>> Finished "Compute fast metrics" in 35.4667 secs
2025-03-09 08:47:37,681 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 143.3294 secs
2025-03-09 08:47:37,681 [INFO]: {
2025-03-09 08:47:37,681 [INFO]: 	index_key: HNSW32
2025-03-09 08:47:37,681 [INFO]: 	index_param: efSearch=64
2025-03-09 08:47:37,681 [INFO]: 	index_path: knn.index
2025-03-09 08:47:37,681 [INFO]: 	size in bytes: 2291683714
2025-03-09 08:47:37,681 [INFO]: 	avg_search_speed_ms: 9.002396804184178
2025-03-09 08:47:37,681 [INFO]: 	99p_search_speed_ms: 17.314329626970014
2025-03-09 08:47:37,681 [INFO]: 	reconstruction error %: 0.0
2025-03-09 08:47:37,681 [INFO]: 	nb vectors: 11640
2025-03-09 08:47:37,681 [INFO]: 	vectors dimension: 49152
2025-03-09 08:47:37,681 [INFO]: 	compression ratio: 0.9986182238060797
2025-03-09 08:47:37,681 [INFO]: }
2025-03-09 08:47:37,681 [INFO]: 	>>> Finished "Creating the index" in 143.3309 secs
2025-03-09 08:47:37,681 [INFO]: >>> Finished "Launching the whole pipeline" in 143.3678 secs
2025-03-09 08:47:39: [retrieval_preprocessing] calculating distances ...
2025-03-09 08:47:41: [retrieval_preprocessing] finished and saved retrieval indices for episode 76173 [episode count 9/20]
[retrieval_preprocessing] for episode 85263 [episode count 10/20], we have num_retrieval=np.int64(11509) num_query=np.int64(723)
2025-03-09 08:47:42,694 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-09 08:47:44,695 [INFO]: Launching the whole pipeline 03/09/2025, 08:47:44
2025-03-09 08:47:44,696 [INFO]: Reading total number of vectors and dimension 03/09/2025, 08:47:44
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1918.71it/s]
2025-03-09 08:47:44,736 [INFO]: There are 11509 embeddings of dim 49152
2025-03-09 08:47:44,736 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0404 secs
2025-03-09 08:47:44,736 [INFO]: 	Compute estimated construction time of the index 03/09/2025, 08:47:44
2025-03-09 08:47:44,736 [INFO]: 		-> Train: 16.7 minutes
2025-03-09 08:47:44,737 [INFO]: 		-> Add: 6.3 seconds
2025-03-09 08:47:44,737 [INFO]: 		Total: 16.8 minutes
2025-03-09 08:47:44,737 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0004 secs
2025-03-09 08:47:44,737 [INFO]: 	Checking that your have enough memory available to create the index 03/09/2025, 08:47:44
2025-03-09 08:47:44,737 [INFO]: 2.3GB of memory will be needed to build the index (more might be used if you have more)
2025-03-09 08:47:44,737 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0006 secs
2025-03-09 08:47:44,738 [INFO]: 	Selecting most promising index types given data characteristics 03/09/2025, 08:47:44
2025-03-09 08:47:44,738 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0001 secs
2025-03-09 08:47:44,738 [INFO]: 	Creating the index 03/09/2025, 08:47:44
2025-03-09 08:47:44,738 [INFO]: 		-> Instanciate the index HNSW32 03/09/2025, 08:47:44
2025-03-09 08:47:44,741 [INFO]: 		>>> Finished "-> Instanciate the index HNSW32" in 0.0031 secs
2025-03-09 08:47:44,741 [INFO]: 		-> Adding the vectors to the index 03/09/2025, 08:47:44
2025-03-09 08:47:44,742 [INFO]: The memory available for adding the vectors is 47.9GB(total available - used by the index)
2025-03-09 08:47:44,742 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/48 [00:00<?, ?it/s]  2%|▏         | 1/48 [00:00<00:09,  5.19it/s] 12%|█▎        | 6/48 [00:00<00:01, 23.10it/s] 23%|██▎       | 11/48 [00:00<00:01, 32.59it/s] 33%|███▎      | 16/48 [00:00<00:00, 36.92it/s] 44%|████▍     | 21/48 [00:08<00:17,  1.58it/s] 54%|█████▍    | 26/48 [00:08<00:09,  2.40it/s] 67%|██████▋   | 32/48 [00:08<00:04,  3.76it/s] 79%|███████▉  | 38/48 [00:08<00:01,  5.57it/s] 90%|████████▉ | 43/48 [00:18<00:03,  1.48it/s] 98%|█████████▊| 47/48 [00:18<00:00,  1.96it/s]100%|██████████| 48/48 [00:22<00:00,  2.14it/s]
2025-03-09 08:48:07,199 [INFO]: 	Computing best hyperparameters for index knn.index 03/09/2025, 08:48:07
2025-03-09 08:49:36,469 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 89.2697 secs
2025-03-09 08:49:36,469 [INFO]: The best hyperparameters are: efSearch=66
2025-03-09 08:49:36,469 [INFO]: 	Compute fast metrics 03/09/2025, 08:49:36
  0%|          | 0/4 [00:00<?, ?it/s] 25%|██▌       | 1/4 [00:00<00:00,  7.73it/s] 75%|███████▌  | 3/4 [00:00<00:00, 16.13it/s]
2025-03-09 08:50:10,379 [INFO]: 	>>> Finished "Compute fast metrics" in 33.9095 secs
2025-03-09 08:50:10,381 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 145.6394 secs
2025-03-09 08:50:10,381 [INFO]: {
2025-03-09 08:50:10,381 [INFO]: 	index_key: HNSW32
2025-03-09 08:50:10,381 [INFO]: 	index_param: efSearch=66
2025-03-09 08:50:10,381 [INFO]: 	index_path: knn.index
2025-03-09 08:50:10,381 [INFO]: 	size in bytes: 2265891166
2025-03-09 08:50:10,381 [INFO]: 	avg_search_speed_ms: 9.453960829053518
2025-03-09 08:50:10,381 [INFO]: 	99p_search_speed_ms: 15.027802255935969
2025-03-09 08:50:10,381 [INFO]: 	reconstruction error %: 0.0
2025-03-09 08:50:10,381 [INFO]: 	nb vectors: 11509
2025-03-09 08:50:10,381 [INFO]: 	vectors dimension: 49152
2025-03-09 08:50:10,381 [INFO]: 	compression ratio: 0.9986187800866337
2025-03-09 08:50:10,381 [INFO]: }
2025-03-09 08:50:10,381 [INFO]: 	>>> Finished "Creating the index" in 145.6433 secs
2025-03-09 08:50:10,381 [INFO]: >>> Finished "Launching the whole pipeline" in 145.6858 secs
2025-03-09 08:50:11: [retrieval_preprocessing] calculating distances ...
2025-03-09 08:50:14: [retrieval_preprocessing] finished and saved retrieval indices for episode 85263 [episode count 10/20]
[retrieval_preprocessing] for episode 94861 [episode count 11/20], we have num_retrieval=np.int64(11632) num_query=np.int64(600)
2025-03-09 08:50:18,666 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-09 08:50:20,625 [INFO]: Launching the whole pipeline 03/09/2025, 08:50:20
2025-03-09 08:50:20,625 [INFO]: Reading total number of vectors and dimension 03/09/2025, 08:50:20
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 888.62it/s]
2025-03-09 08:50:20,655 [INFO]: There are 11632 embeddings of dim 49152
2025-03-09 08:50:20,655 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0296 secs
2025-03-09 08:50:20,655 [INFO]: 	Compute estimated construction time of the index 03/09/2025, 08:50:20
2025-03-09 08:50:20,656 [INFO]: 		-> Train: 16.7 minutes
2025-03-09 08:50:20,656 [INFO]: 		-> Add: 6.4 seconds
2025-03-09 08:50:20,656 [INFO]: 		Total: 16.8 minutes
2025-03-09 08:50:20,656 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0004 secs
2025-03-09 08:50:20,656 [INFO]: 	Checking that your have enough memory available to create the index 03/09/2025, 08:50:20
2025-03-09 08:50:20,657 [INFO]: 2.3GB of memory will be needed to build the index (more might be used if you have more)
2025-03-09 08:50:20,657 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0006 secs
2025-03-09 08:50:20,657 [INFO]: 	Selecting most promising index types given data characteristics 03/09/2025, 08:50:20
2025-03-09 08:50:20,657 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0001 secs
2025-03-09 08:50:20,658 [INFO]: 	Creating the index 03/09/2025, 08:50:20
2025-03-09 08:50:20,658 [INFO]: 		-> Instanciate the index HNSW32 03/09/2025, 08:50:20
2025-03-09 08:50:20,661 [INFO]: 		>>> Finished "-> Instanciate the index HNSW32" in 0.0029 secs
2025-03-09 08:50:20,661 [INFO]: 		-> Adding the vectors to the index 03/09/2025, 08:50:20
2025-03-09 08:50:20,661 [INFO]: The memory available for adding the vectors is 47.9GB(total available - used by the index)
2025-03-09 08:50:20,661 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/48 [00:00<?, ?it/s]  2%|▏         | 1/48 [00:00<00:07,  6.25it/s] 10%|█         | 5/48 [00:00<00:01, 21.95it/s] 19%|█▉        | 9/48 [00:00<00:01, 25.02it/s] 25%|██▌       | 12/48 [00:00<00:01, 21.31it/s] 33%|███▎      | 16/48 [00:00<00:01, 26.22it/s] 42%|████▏     | 20/48 [00:00<00:00, 29.79it/s] 50%|█████     | 24/48 [00:07<00:14,  1.61it/s] 56%|█████▋    | 27/48 [00:07<00:09,  2.16it/s] 65%|██████▍   | 31/48 [00:07<00:05,  3.17it/s] 73%|███████▎  | 35/48 [00:08<00:02,  4.53it/s] 81%|████████▏ | 39/48 [00:08<00:01,  6.30it/s] 90%|████████▉ | 43/48 [00:17<00:04,  1.18it/s] 96%|█████████▌| 46/48 [00:17<00:01,  1.55it/s]100%|██████████| 48/48 [00:21<00:00,  2.19it/s]
2025-03-09 08:50:42,584 [INFO]: 	Computing best hyperparameters for index knn.index 03/09/2025, 08:50:42
2025-03-09 08:52:13,554 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 90.9685 secs
2025-03-09 08:52:13,554 [INFO]: The best hyperparameters are: efSearch=65
2025-03-09 08:52:13,554 [INFO]: 	Compute fast metrics 03/09/2025, 08:52:13
  0%|          | 0/4 [00:00<?, ?it/s] 50%|█████     | 2/4 [00:00<00:00, 16.61it/s] 75%|███████▌  | 3/4 [00:00<00:00, 18.21it/s]
2025-03-09 08:52:46,894 [INFO]: 	>>> Finished "Compute fast metrics" in 33.3400 secs
2025-03-09 08:52:46,897 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 146.2362 secs
2025-03-09 08:52:46,897 [INFO]: {
2025-03-09 08:52:46,898 [INFO]: 	index_key: HNSW32
2025-03-09 08:52:46,898 [INFO]: 	index_param: efSearch=65
2025-03-09 08:52:46,898 [INFO]: 	index_path: knn.index
2025-03-09 08:52:46,898 [INFO]: 	size in bytes: 2290108578
2025-03-09 08:52:46,898 [INFO]: 	avg_search_speed_ms: 9.43802993652358
2025-03-09 08:52:46,898 [INFO]: 	99p_search_speed_ms: 15.78368216287345
2025-03-09 08:52:46,898 [INFO]: 	reconstruction error %: 0.0
2025-03-09 08:52:46,898 [INFO]: 	nb vectors: 11632
2025-03-09 08:52:46,898 [INFO]: 	vectors dimension: 49152
2025-03-09 08:52:46,898 [INFO]: 	compression ratio: 0.9986182655135227
2025-03-09 08:52:46,898 [INFO]: }
2025-03-09 08:52:46,898 [INFO]: 	>>> Finished "Creating the index" in 146.2401 secs
2025-03-09 08:52:46,898 [INFO]: >>> Finished "Launching the whole pipeline" in 146.2725 secs
2025-03-09 08:52:48: [retrieval_preprocessing] calculating distances ...
2025-03-09 08:52:50: [retrieval_preprocessing] finished and saved retrieval indices for episode 94861 [episode count 11/20]
[retrieval_preprocessing] for episode 39442 [episode count 12/20], we have num_retrieval=np.int64(11630) num_query=np.int64(602)
2025-03-09 08:52:51,968 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-09 08:52:53,558 [INFO]: Launching the whole pipeline 03/09/2025, 08:52:53
2025-03-09 08:52:53,559 [INFO]: Reading total number of vectors and dimension 03/09/2025, 08:52:53
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1387.01it/s]
2025-03-09 08:52:53,598 [INFO]: There are 11630 embeddings of dim 49152
2025-03-09 08:52:53,598 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0395 secs
2025-03-09 08:52:53,598 [INFO]: 	Compute estimated construction time of the index 03/09/2025, 08:52:53
2025-03-09 08:52:53,598 [INFO]: 		-> Train: 16.7 minutes
2025-03-09 08:52:53,598 [INFO]: 		-> Add: 6.4 seconds
2025-03-09 08:52:53,598 [INFO]: 		Total: 16.8 minutes
2025-03-09 08:52:53,598 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0001 secs
2025-03-09 08:52:53,598 [INFO]: 	Checking that your have enough memory available to create the index 03/09/2025, 08:52:53
2025-03-09 08:52:53,599 [INFO]: 2.3GB of memory will be needed to build the index (more might be used if you have more)
2025-03-09 08:52:53,599 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0002 secs
2025-03-09 08:52:53,599 [INFO]: 	Selecting most promising index types given data characteristics 03/09/2025, 08:52:53
2025-03-09 08:52:53,599 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-09 08:52:53,599 [INFO]: 	Creating the index 03/09/2025, 08:52:53
2025-03-09 08:52:53,599 [INFO]: 		-> Instanciate the index HNSW32 03/09/2025, 08:52:53
2025-03-09 08:52:53,600 [INFO]: 		>>> Finished "-> Instanciate the index HNSW32" in 0.0012 secs
2025-03-09 08:52:53,600 [INFO]: 		-> Adding the vectors to the index 03/09/2025, 08:52:53
2025-03-09 08:52:53,600 [INFO]: The memory available for adding the vectors is 47.9GB(total available - used by the index)
2025-03-09 08:52:53,600 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/48 [00:00<?, ?it/s]  2%|▏         | 1/48 [00:00<00:06,  7.45it/s] 10%|█         | 5/48 [00:00<00:02, 21.13it/s] 21%|██        | 10/48 [00:00<00:01, 31.89it/s] 33%|███▎      | 16/48 [00:00<00:00, 39.48it/s] 44%|████▍     | 21/48 [00:07<00:13,  1.95it/s] 56%|█████▋    | 27/48 [00:07<00:06,  3.14it/s] 71%|███████   | 34/48 [00:07<00:02,  5.04it/s] 83%|████████▎ | 40/48 [00:07<00:01,  7.15it/s] 94%|█████████▍| 45/48 [00:15<00:01,  1.74it/s]100%|██████████| 48/48 [00:19<00:00,  2.44it/s]
2025-03-09 08:53:13,252 [INFO]: 	Computing best hyperparameters for index knn.index 03/09/2025, 08:53:13
2025-03-09 08:54:31,070 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 77.8175 secs
2025-03-09 08:54:31,070 [INFO]: The best hyperparameters are: efSearch=88
2025-03-09 08:54:31,070 [INFO]: 	Compute fast metrics 03/09/2025, 08:54:31
  0%|          | 0/4 [00:00<?, ?it/s] 25%|██▌       | 1/4 [00:00<00:00,  5.35it/s] 50%|█████     | 2/4 [00:00<00:00,  6.91it/s] 75%|███████▌  | 3/4 [00:00<00:00,  7.40it/s] 75%|███████▌  | 3/4 [00:00<00:00,  5.50it/s]
2025-03-09 08:54:54,860 [INFO]: 	>>> Finished "Compute fast metrics" in 23.7895 secs
2025-03-09 08:54:55,060 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 121.4595 secs
2025-03-09 08:54:55,060 [INFO]: {
2025-03-09 08:54:55,060 [INFO]: 	index_key: HNSW32
2025-03-09 08:54:55,060 [INFO]: 	index_param: efSearch=88
2025-03-09 08:54:55,061 [INFO]: 	index_path: knn.index
2025-03-09 08:54:55,061 [INFO]: 	size in bytes: 2289714826
2025-03-09 08:54:55,061 [INFO]: 	avg_search_speed_ms: 12.160478305198334
2025-03-09 08:54:55,061 [INFO]: 	99p_search_speed_ms: 23.30890861339866
2025-03-09 08:54:55,061 [INFO]: 	reconstruction error %: 0.0
2025-03-09 08:54:55,061 [INFO]: 	nb vectors: 11630
2025-03-09 08:54:55,061 [INFO]: 	vectors dimension: 49152
2025-03-09 08:54:55,061 [INFO]: 	compression ratio: 0.9986182619931203
2025-03-09 08:54:55,061 [INFO]: }
2025-03-09 08:54:55,061 [INFO]: 	>>> Finished "Creating the index" in 121.4624 secs
2025-03-09 08:54:55,061 [INFO]: >>> Finished "Launching the whole pipeline" in 121.5029 secs
2025-03-09 08:54:57: [retrieval_preprocessing] calculating distances ...
2025-03-09 08:54:59: [retrieval_preprocessing] finished and saved retrieval indices for episode 39442 [episode count 12/20]
[retrieval_preprocessing] for episode 39059 [episode count 13/20], we have num_retrieval=np.int64(11715) num_query=np.int64(517)
2025-03-09 08:55:00,900 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-09 08:55:02,391 [INFO]: Launching the whole pipeline 03/09/2025, 08:55:02
2025-03-09 08:55:02,391 [INFO]: Reading total number of vectors and dimension 03/09/2025, 08:55:02
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1126.90it/s]
2025-03-09 08:55:02,427 [INFO]: There are 11715 embeddings of dim 49152
2025-03-09 08:55:02,427 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0361 secs
2025-03-09 08:55:02,427 [INFO]: 	Compute estimated construction time of the index 03/09/2025, 08:55:02
2025-03-09 08:55:02,427 [INFO]: 		-> Train: 16.7 minutes
2025-03-09 08:55:02,427 [INFO]: 		-> Add: 6.4 seconds
2025-03-09 08:55:02,427 [INFO]: 		Total: 16.8 minutes
2025-03-09 08:55:02,427 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0001 secs
2025-03-09 08:55:02,427 [INFO]: 	Checking that your have enough memory available to create the index 03/09/2025, 08:55:02
2025-03-09 08:55:02,427 [INFO]: 2.4GB of memory will be needed to build the index (more might be used if you have more)
2025-03-09 08:55:02,427 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0002 secs
2025-03-09 08:55:02,428 [INFO]: 	Selecting most promising index types given data characteristics 03/09/2025, 08:55:02
2025-03-09 08:55:02,428 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-09 08:55:02,428 [INFO]: 	Creating the index 03/09/2025, 08:55:02
2025-03-09 08:55:02,428 [INFO]: 		-> Instanciate the index HNSW32 03/09/2025, 08:55:02
2025-03-09 08:55:02,429 [INFO]: 		>>> Finished "-> Instanciate the index HNSW32" in 0.0009 secs
2025-03-09 08:55:02,429 [INFO]: 		-> Adding the vectors to the index 03/09/2025, 08:55:02
2025-03-09 08:55:02,429 [INFO]: The memory available for adding the vectors is 47.9GB(total available - used by the index)
2025-03-09 08:55:02,429 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/49 [00:00<?, ?it/s]  2%|▏         | 1/49 [00:00<00:07,  6.56it/s]  8%|▊         | 4/49 [00:00<00:02, 17.55it/s] 20%|██        | 10/49 [00:00<00:01, 32.53it/s] 33%|███▎      | 16/49 [00:00<00:00, 40.10it/s] 43%|████▎     | 21/49 [00:07<00:14,  1.95it/s] 53%|█████▎    | 26/49 [00:07<00:07,  2.92it/s] 65%|██████▌   | 32/49 [00:07<00:03,  4.52it/s] 78%|███████▊  | 38/49 [00:07<00:01,  6.64it/s] 88%|████████▊ | 43/49 [00:15<00:03,  1.76it/s] 96%|█████████▌| 47/49 [00:15<00:00,  2.25it/s]100%|██████████| 49/49 [00:20<00:00,  2.38it/s]
2025-03-09 08:55:23,049 [INFO]: 	Computing best hyperparameters for index knn.index 03/09/2025, 08:55:23
2025-03-09 08:56:58,385 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 95.3342 secs
2025-03-09 08:56:58,385 [INFO]: The best hyperparameters are: efSearch=73
2025-03-09 08:56:58,385 [INFO]: 	Compute fast metrics 03/09/2025, 08:56:58
  0%|          | 0/4 [00:00<?, ?it/s] 25%|██▌       | 1/4 [00:00<00:00,  5.38it/s] 50%|█████     | 2/4 [00:00<00:00,  7.01it/s] 75%|███████▌  | 3/4 [00:00<00:00,  7.80it/s] 75%|███████▌  | 3/4 [00:00<00:00,  5.89it/s]
2025-03-09 08:57:34,112 [INFO]: 	>>> Finished "Compute fast metrics" in 35.7266 secs
2025-03-09 08:57:34,113 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 151.6844 secs
2025-03-09 08:57:34,113 [INFO]: {
2025-03-09 08:57:34,113 [INFO]: 	index_key: HNSW32
2025-03-09 08:57:34,113 [INFO]: 	index_param: efSearch=73
2025-03-09 08:57:34,113 [INFO]: 	index_path: knn.index
2025-03-09 08:57:34,113 [INFO]: 	size in bytes: 2306449670
2025-03-09 08:57:34,113 [INFO]: 	avg_search_speed_ms: 8.887865946731633
2025-03-09 08:57:34,113 [INFO]: 	99p_search_speed_ms: 16.320491610094905
2025-03-09 08:57:34,113 [INFO]: 	reconstruction error %: 0.0
2025-03-09 08:57:34,113 [INFO]: 	nb vectors: 11715
2025-03-09 08:57:34,113 [INFO]: 	vectors dimension: 49152
2025-03-09 08:57:34,113 [INFO]: 	compression ratio: 0.9986182442905853
2025-03-09 08:57:34,113 [INFO]: }
2025-03-09 08:57:34,113 [INFO]: 	>>> Finished "Creating the index" in 151.6859 secs
2025-03-09 08:57:34,114 [INFO]: >>> Finished "Launching the whole pipeline" in 151.7226 secs
2025-03-09 08:57:35: [retrieval_preprocessing] calculating distances ...
2025-03-09 08:57:37: [retrieval_preprocessing] finished and saved retrieval indices for episode 39059 [episode count 13/20]
[retrieval_preprocessing] for episode 36244 [episode count 14/20], we have num_retrieval=np.int64(11626) num_query=np.int64(606)
2025-03-09 08:57:41,167 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-09 08:57:42,666 [INFO]: Launching the whole pipeline 03/09/2025, 08:57:42
2025-03-09 08:57:42,666 [INFO]: Reading total number of vectors and dimension 03/09/2025, 08:57:42
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1502.80it/s]
2025-03-09 08:57:42,693 [INFO]: There are 11626 embeddings of dim 49152
2025-03-09 08:57:42,693 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0272 secs
2025-03-09 08:57:42,693 [INFO]: 	Compute estimated construction time of the index 03/09/2025, 08:57:42
2025-03-09 08:57:42,694 [INFO]: 		-> Train: 16.7 minutes
2025-03-09 08:57:42,694 [INFO]: 		-> Add: 6.4 seconds
2025-03-09 08:57:42,694 [INFO]: 		Total: 16.8 minutes
2025-03-09 08:57:42,694 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0003 secs
2025-03-09 08:57:42,694 [INFO]: 	Checking that your have enough memory available to create the index 03/09/2025, 08:57:42
2025-03-09 08:57:42,694 [INFO]: 2.3GB of memory will be needed to build the index (more might be used if you have more)
2025-03-09 08:57:42,694 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0005 secs
2025-03-09 08:57:42,695 [INFO]: 	Selecting most promising index types given data characteristics 03/09/2025, 08:57:42
2025-03-09 08:57:42,695 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0001 secs
2025-03-09 08:57:42,695 [INFO]: 	Creating the index 03/09/2025, 08:57:42
2025-03-09 08:57:42,695 [INFO]: 		-> Instanciate the index HNSW32 03/09/2025, 08:57:42
2025-03-09 08:57:42,698 [INFO]: 		>>> Finished "-> Instanciate the index HNSW32" in 0.0026 secs
2025-03-09 08:57:42,698 [INFO]: 		-> Adding the vectors to the index 03/09/2025, 08:57:42
2025-03-09 08:57:42,698 [INFO]: The memory available for adding the vectors is 47.9GB(total available - used by the index)
2025-03-09 08:57:42,698 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/48 [00:00<?, ?it/s]  2%|▏         | 1/48 [00:00<00:11,  4.15it/s]  4%|▍         | 2/48 [00:00<00:07,  6.20it/s]  6%|▋         | 3/48 [00:00<00:06,  7.31it/s]  8%|▊         | 4/48 [00:00<00:05,  7.98it/s] 10%|█         | 5/48 [00:00<00:05,  8.37it/s] 12%|█▎        | 6/48 [00:00<00:04,  8.63it/s] 15%|█▍        | 7/48 [00:00<00:04,  8.95it/s] 17%|█▋        | 8/48 [00:00<00:04,  9.04it/s] 19%|█▉        | 9/48 [00:01<00:04,  9.10it/s] 21%|██        | 10/48 [00:01<00:04,  9.12it/s] 23%|██▎       | 11/48 [00:01<00:04,  9.16it/s] 25%|██▌       | 12/48 [00:01<00:03,  9.35it/s] 27%|██▋       | 13/48 [00:01<00:03,  9.41it/s] 29%|██▉       | 14/48 [00:01<00:03,  9.38it/s] 31%|███▏      | 15/48 [00:01<00:03,  9.31it/s] 33%|███▎      | 16/48 [00:01<00:03,  9.29it/s] 35%|███▌      | 17/48 [00:01<00:03,  9.27it/s] 38%|███▊      | 18/48 [00:02<00:03,  9.26it/s] 40%|███▉      | 19/48 [00:02<00:03,  9.33it/s] 44%|████▍     | 21/48 [00:08<00:43,  1.62s/it] 46%|████▌     | 22/48 [00:09<00:32,  1.24s/it] 50%|█████     | 24/48 [00:09<00:18,  1.32it/s] 54%|█████▍    | 26/48 [00:09<00:11,  1.97it/s] 58%|█████▊    | 28/48 [00:09<00:07,  2.79it/s] 62%|██████▎   | 30/48 [00:09<00:04,  3.77it/s] 67%|██████▋   | 32/48 [00:09<00:03,  4.86it/s] 71%|███████   | 34/48 [00:09<00:02,  6.05it/s] 75%|███████▌  | 36/48 [00:10<00:01,  7.23it/s] 79%|███████▉  | 38/48 [00:10<00:01,  8.31it/s] 83%|████████▎ | 40/48 [00:10<00:00,  9.34it/s] 88%|████████▊ | 42/48 [00:17<00:07,  1.21s/it] 94%|█████████▍| 45/48 [00:18<00:02,  1.32it/s] 98%|█████████▊| 47/48 [00:18<00:00,  1.76it/s]100%|██████████| 48/48 [00:22<00:00,  2.17it/s]
2025-03-09 08:58:04,844 [INFO]: 	Computing best hyperparameters for index knn.index 03/09/2025, 08:58:04
2025-03-09 08:59:28,310 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 83.4659 secs
2025-03-09 08:59:28,311 [INFO]: The best hyperparameters are: efSearch=79
2025-03-09 08:59:28,311 [INFO]: 	Compute fast metrics 03/09/2025, 08:59:28
  0%|          | 0/4 [00:00<?, ?it/s] 25%|██▌       | 1/4 [00:00<00:00,  5.30it/s] 50%|█████     | 2/4 [00:00<00:00,  7.10it/s] 75%|███████▌  | 3/4 [00:00<00:00,  7.39it/s] 75%|███████▌  | 3/4 [00:00<00:00,  5.43it/s]
2025-03-09 09:00:02,171 [INFO]: 	>>> Finished "Compute fast metrics" in 33.8605 secs
2025-03-09 09:00:02,173 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 139.4747 secs
2025-03-09 09:00:02,173 [INFO]: {
2025-03-09 09:00:02,173 [INFO]: 	index_key: HNSW32
2025-03-09 09:00:02,173 [INFO]: 	index_param: efSearch=79
2025-03-09 09:00:02,173 [INFO]: 	index_path: knn.index
2025-03-09 09:00:02,173 [INFO]: 	size in bytes: 2288927322
2025-03-09 09:00:02,173 [INFO]: 	avg_search_speed_ms: 9.872670514097203
2025-03-09 09:00:02,173 [INFO]: 	99p_search_speed_ms: 20.372202945873138
2025-03-09 09:00:02,173 [INFO]: 	reconstruction error %: 0.0
2025-03-09 09:00:02,173 [INFO]: 	nb vectors: 11626
2025-03-09 09:00:02,173 [INFO]: 	vectors dimension: 49152
2025-03-09 09:00:02,173 [INFO]: 	compression ratio: 0.9986182549486821
2025-03-09 09:00:02,173 [INFO]: }
2025-03-09 09:00:02,173 [INFO]: 	>>> Finished "Creating the index" in 139.4780 secs
2025-03-09 09:00:02,173 [INFO]: >>> Finished "Launching the whole pipeline" in 139.5071 secs
2025-03-09 09:00:04: [retrieval_preprocessing] calculating distances ...
2025-03-09 09:00:06: [retrieval_preprocessing] finished and saved retrieval indices for episode 36244 [episode count 14/20]
[retrieval_preprocessing] for episode 93589 [episode count 15/20], we have num_retrieval=np.int64(11595) num_query=np.int64(637)
2025-03-09 09:00:10,480 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-09 09:00:12,735 [INFO]: Launching the whole pipeline 03/09/2025, 09:00:12
2025-03-09 09:00:12,735 [INFO]: Reading total number of vectors and dimension 03/09/2025, 09:00:12
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1506.03it/s]
2025-03-09 09:00:12,764 [INFO]: There are 11595 embeddings of dim 49152
2025-03-09 09:00:12,764 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0294 secs
2025-03-09 09:00:12,764 [INFO]: 	Compute estimated construction time of the index 03/09/2025, 09:00:12
2025-03-09 09:00:12,764 [INFO]: 		-> Train: 16.7 minutes
2025-03-09 09:00:12,764 [INFO]: 		-> Add: 6.4 seconds
2025-03-09 09:00:12,764 [INFO]: 		Total: 16.8 minutes
2025-03-09 09:00:12,764 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0001 secs
2025-03-09 09:00:12,764 [INFO]: 	Checking that your have enough memory available to create the index 03/09/2025, 09:00:12
2025-03-09 09:00:12,764 [INFO]: 2.3GB of memory will be needed to build the index (more might be used if you have more)
2025-03-09 09:00:12,765 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0002 secs
2025-03-09 09:00:12,765 [INFO]: 	Selecting most promising index types given data characteristics 03/09/2025, 09:00:12
2025-03-09 09:00:12,765 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-09 09:00:12,765 [INFO]: 	Creating the index 03/09/2025, 09:00:12
2025-03-09 09:00:12,765 [INFO]: 		-> Instanciate the index HNSW32 03/09/2025, 09:00:12
2025-03-09 09:00:12,766 [INFO]: 		>>> Finished "-> Instanciate the index HNSW32" in 0.0011 secs
2025-03-09 09:00:12,766 [INFO]: 		-> Adding the vectors to the index 03/09/2025, 09:00:12
2025-03-09 09:00:12,766 [INFO]: The memory available for adding the vectors is 47.9GB(total available - used by the index)
2025-03-09 09:00:12,766 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/48 [00:00<?, ?it/s]  2%|▏         | 1/48 [00:00<00:12,  3.90it/s]  4%|▍         | 2/48 [00:00<00:07,  5.84it/s]  6%|▋         | 3/48 [00:00<00:06,  6.93it/s]  8%|▊         | 4/48 [00:00<00:05,  7.60it/s] 10%|█         | 5/48 [00:00<00:05,  8.15it/s] 12%|█▎        | 6/48 [00:00<00:05,  8.31it/s] 15%|█▍        | 7/48 [00:00<00:04,  8.48it/s] 17%|█▋        | 8/48 [00:01<00:04,  8.61it/s] 19%|█▉        | 9/48 [00:01<00:04,  8.71it/s] 21%|██        | 10/48 [00:01<00:04,  8.85it/s] 23%|██▎       | 11/48 [00:01<00:04,  8.86it/s] 25%|██▌       | 12/48 [00:01<00:04,  8.87it/s] 27%|██▋       | 13/48 [00:01<00:03,  8.87it/s] 29%|██▉       | 14/48 [00:01<00:03,  9.01it/s] 40%|███▉      | 19/48 [00:01<00:01, 20.10it/s] 46%|████▌     | 22/48 [00:07<00:17,  1.46it/s] 50%|█████     | 24/48 [00:07<00:12,  1.90it/s] 54%|█████▍    | 26/48 [00:07<00:08,  2.46it/s] 58%|█████▊    | 28/48 [00:07<00:06,  3.17it/s] 62%|██████▎   | 30/48 [00:07<00:04,  4.00it/s] 67%|██████▋   | 32/48 [00:07<00:03,  4.97it/s] 71%|███████   | 34/48 [00:08<00:02,  6.01it/s] 75%|███████▌  | 36/48 [00:08<00:01,  7.13it/s] 79%|███████▉  | 38/48 [00:08<00:01,  8.21it/s] 83%|████████▎ | 40/48 [00:08<00:00,  9.23it/s] 88%|████████▊ | 42/48 [00:16<00:07,  1.28s/it] 92%|█████████▏| 44/48 [00:16<00:03,  1.09it/s] 96%|█████████▌| 46/48 [00:16<00:01,  1.51it/s]100%|██████████| 48/48 [00:20<00:00,  1.01s/it]100%|██████████| 48/48 [00:20<00:00,  2.33it/s]
2025-03-09 09:00:33,347 [INFO]: 	Computing best hyperparameters for index knn.index 03/09/2025, 09:00:33
2025-03-09 09:01:51,539 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 78.1918 secs
2025-03-09 09:01:51,539 [INFO]: The best hyperparameters are: efSearch=90
2025-03-09 09:01:51,539 [INFO]: 	Compute fast metrics 03/09/2025, 09:01:51
  0%|          | 0/4 [00:00<?, ?it/s] 25%|██▌       | 1/4 [00:00<00:00,  5.13it/s] 50%|█████     | 2/4 [00:00<00:00,  6.71it/s] 75%|███████▌  | 3/4 [00:00<00:00,  7.34it/s] 75%|███████▌  | 3/4 [00:00<00:00,  5.57it/s]
2025-03-09 09:02:11,562 [INFO]: 	>>> Finished "Compute fast metrics" in 20.0225 secs
2025-03-09 09:02:11,564 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 118.7977 secs
2025-03-09 09:02:11,564 [INFO]: {
2025-03-09 09:02:11,564 [INFO]: 	index_key: HNSW32
2025-03-09 09:02:11,564 [INFO]: 	index_param: efSearch=90
2025-03-09 09:02:11,564 [INFO]: 	index_path: knn.index
2025-03-09 09:02:11,564 [INFO]: 	size in bytes: 2282823782
2025-03-09 09:02:11,564 [INFO]: 	avg_search_speed_ms: 11.017583954991109
2025-03-09 09:02:11,564 [INFO]: 	99p_search_speed_ms: 21.596101429313343
2025-03-09 09:02:11,564 [INFO]: 	reconstruction error %: 0.0
2025-03-09 09:02:11,564 [INFO]: 	nb vectors: 11595
2025-03-09 09:02:11,564 [INFO]: 	vectors dimension: 49152
2025-03-09 09:02:11,564 [INFO]: 	compression ratio: 0.9986183681697776
2025-03-09 09:02:11,564 [INFO]: }
2025-03-09 09:02:11,564 [INFO]: 	>>> Finished "Creating the index" in 118.7994 secs
2025-03-09 09:02:11,564 [INFO]: >>> Finished "Launching the whole pipeline" in 118.8295 secs
2025-03-09 09:02:13: [retrieval_preprocessing] calculating distances ...
2025-03-09 09:02:15: [retrieval_preprocessing] finished and saved retrieval indices for episode 93589 [episode count 15/20]
[retrieval_preprocessing] for episode 91159 [episode count 16/20], we have num_retrieval=np.int64(11659) num_query=np.int64(573)
2025-03-09 09:02:19,775 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-09 09:02:21,420 [INFO]: Launching the whole pipeline 03/09/2025, 09:02:21
2025-03-09 09:02:21,420 [INFO]: Reading total number of vectors and dimension 03/09/2025, 09:02:21
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1473.24it/s]
2025-03-09 09:02:21,446 [INFO]: There are 11659 embeddings of dim 49152
2025-03-09 09:02:21,447 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0268 secs
2025-03-09 09:02:21,447 [INFO]: 	Compute estimated construction time of the index 03/09/2025, 09:02:21
2025-03-09 09:02:21,447 [INFO]: 		-> Train: 16.7 minutes
2025-03-09 09:02:21,447 [INFO]: 		-> Add: 6.4 seconds
2025-03-09 09:02:21,447 [INFO]: 		Total: 16.8 minutes
2025-03-09 09:02:21,447 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0002 secs
2025-03-09 09:02:21,447 [INFO]: 	Checking that your have enough memory available to create the index 03/09/2025, 09:02:21
2025-03-09 09:02:21,447 [INFO]: 2.4GB of memory will be needed to build the index (more might be used if you have more)
2025-03-09 09:02:21,447 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0002 secs
2025-03-09 09:02:21,447 [INFO]: 	Selecting most promising index types given data characteristics 03/09/2025, 09:02:21
2025-03-09 09:02:21,447 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-09 09:02:21,447 [INFO]: 	Creating the index 03/09/2025, 09:02:21
2025-03-09 09:02:21,447 [INFO]: 		-> Instanciate the index HNSW32 03/09/2025, 09:02:21
2025-03-09 09:02:21,448 [INFO]: 		>>> Finished "-> Instanciate the index HNSW32" in 0.0010 secs
2025-03-09 09:02:21,449 [INFO]: 		-> Adding the vectors to the index 03/09/2025, 09:02:21
2025-03-09 09:02:21,449 [INFO]: The memory available for adding the vectors is 47.9GB(total available - used by the index)
2025-03-09 09:02:21,449 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/48 [00:00<?, ?it/s]  2%|▏         | 1/48 [00:00<00:12,  3.91it/s]  4%|▍         | 2/48 [00:00<00:07,  5.91it/s]  6%|▋         | 3/48 [00:00<00:06,  6.99it/s]  8%|▊         | 4/48 [00:00<00:05,  7.62it/s] 10%|█         | 5/48 [00:00<00:05,  8.14it/s] 12%|█▎        | 6/48 [00:00<00:05,  8.38it/s] 15%|█▍        | 7/48 [00:00<00:04,  8.55it/s] 17%|█▋        | 8/48 [00:01<00:04,  8.80it/s] 19%|█▉        | 9/48 [00:01<00:04,  8.95it/s] 21%|██        | 10/48 [00:01<00:04,  9.15it/s] 23%|██▎       | 11/48 [00:01<00:04,  9.00it/s] 25%|██▌       | 12/48 [00:01<00:04,  8.71it/s] 27%|██▋       | 13/48 [00:01<00:04,  8.51it/s] 29%|██▉       | 14/48 [00:01<00:04,  8.38it/s] 31%|███▏      | 15/48 [00:01<00:03,  8.44it/s] 35%|███▌      | 17/48 [00:01<00:03, 10.21it/s] 38%|███▊      | 18/48 [00:02<00:02, 10.12it/s] 40%|███▉      | 19/48 [00:02<00:02,  9.91it/s] 44%|████▍     | 21/48 [00:08<00:37,  1.37s/it] 48%|████▊     | 23/48 [00:08<00:22,  1.13it/s] 52%|█████▏    | 25/48 [00:08<00:13,  1.66it/s] 56%|█████▋    | 27/48 [00:08<00:08,  2.34it/s] 60%|██████    | 29/48 [00:08<00:05,  3.18it/s] 65%|██████▍   | 31/48 [00:09<00:04,  4.14it/s] 69%|██████▉   | 33/48 [00:09<00:02,  5.24it/s] 73%|███████▎  | 35/48 [00:09<00:02,  6.39it/s] 77%|███████▋  | 37/48 [00:09<00:01,  7.47it/s] 81%|████████▏ | 39/48 [00:09<00:01,  8.49it/s] 85%|████████▌ | 41/48 [00:09<00:00,  9.42it/s] 90%|████████▉ | 43/48 [00:17<00:06,  1.26s/it] 94%|█████████▍| 45/48 [00:17<00:02,  1.10it/s] 98%|█████████▊| 47/48 [00:18<00:00,  1.51it/s]100%|██████████| 48/48 [00:22<00:00,  1.25s/it]100%|██████████| 48/48 [00:22<00:00,  2.17it/s]
2025-03-09 09:02:43,612 [INFO]: 	Computing best hyperparameters for index knn.index 03/09/2025, 09:02:43
2025-03-09 09:03:59,481 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 75.8675 secs
2025-03-09 09:03:59,481 [INFO]: The best hyperparameters are: efSearch=75
2025-03-09 09:03:59,481 [INFO]: 	Compute fast metrics 03/09/2025, 09:03:59
  0%|          | 0/4 [00:00<?, ?it/s] 25%|██▌       | 1/4 [00:00<00:00,  5.69it/s] 50%|█████     | 2/4 [00:00<00:00,  7.55it/s] 75%|███████▌  | 3/4 [00:00<00:00,  8.31it/s] 75%|███████▌  | 3/4 [00:00<00:00,  6.19it/s]
2025-03-09 09:04:23,116 [INFO]: 	>>> Finished "Compute fast metrics" in 23.6351 secs
2025-03-09 09:04:23,908 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 122.4598 secs
2025-03-09 09:04:23,909 [INFO]: {
2025-03-09 09:04:23,909 [INFO]: 	index_key: HNSW32
2025-03-09 09:04:23,909 [INFO]: 	index_param: efSearch=75
2025-03-09 09:04:23,909 [INFO]: 	index_path: knn.index
2025-03-09 09:04:23,909 [INFO]: 	size in bytes: 2295424358
2025-03-09 09:04:23,909 [INFO]: 	avg_search_speed_ms: 8.439048162547534
2025-03-09 09:04:23,909 [INFO]: 	99p_search_speed_ms: 14.757015965879013
2025-03-09 09:04:23,909 [INFO]: 	reconstruction error %: 0.0
2025-03-09 09:04:23,909 [INFO]: 	nb vectors: 11659
2025-03-09 09:04:23,909 [INFO]: 	vectors dimension: 49152
2025-03-09 09:04:23,909 [INFO]: 	compression ratio: 0.9986182572346826
2025-03-09 09:04:23,909 [INFO]: }
2025-03-09 09:04:23,909 [INFO]: 	>>> Finished "Creating the index" in 122.4620 secs
2025-03-09 09:04:23,909 [INFO]: >>> Finished "Launching the whole pipeline" in 122.4896 secs
2025-03-09 09:04:25: [retrieval_preprocessing] calculating distances ...
2025-03-09 09:04:27: [retrieval_preprocessing] finished and saved retrieval indices for episode 91159 [episode count 16/20]
[retrieval_preprocessing] for episode 70173 [episode count 17/20], we have num_retrieval=np.int64(11248) num_query=np.int64(984)
2025-03-09 09:04:30,233 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-09 09:04:31,781 [INFO]: Launching the whole pipeline 03/09/2025, 09:04:31
2025-03-09 09:04:31,781 [INFO]: Reading total number of vectors and dimension 03/09/2025, 09:04:31
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1521.88it/s]
2025-03-09 09:04:31,808 [INFO]: There are 11248 embeddings of dim 49152
2025-03-09 09:04:31,808 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0269 secs
2025-03-09 09:04:31,808 [INFO]: 	Compute estimated construction time of the index 03/09/2025, 09:04:31
2025-03-09 09:04:31,809 [INFO]: 		-> Train: 16.7 minutes
2025-03-09 09:04:31,809 [INFO]: 		-> Add: 6.2 seconds
2025-03-09 09:04:31,809 [INFO]: 		Total: 16.8 minutes
2025-03-09 09:04:31,809 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0001 secs
2025-03-09 09:04:31,809 [INFO]: 	Checking that your have enough memory available to create the index 03/09/2025, 09:04:31
2025-03-09 09:04:31,809 [INFO]: 2.3GB of memory will be needed to build the index (more might be used if you have more)
2025-03-09 09:04:31,809 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0002 secs
2025-03-09 09:04:31,809 [INFO]: 	Selecting most promising index types given data characteristics 03/09/2025, 09:04:31
2025-03-09 09:04:31,809 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-09 09:04:31,809 [INFO]: 	Creating the index 03/09/2025, 09:04:31
2025-03-09 09:04:31,809 [INFO]: 		-> Instanciate the index HNSW32 03/09/2025, 09:04:31
2025-03-09 09:04:31,810 [INFO]: 		>>> Finished "-> Instanciate the index HNSW32" in 0.0012 secs
2025-03-09 09:04:31,810 [INFO]: 		-> Adding the vectors to the index 03/09/2025, 09:04:31
2025-03-09 09:04:31,810 [INFO]: The memory available for adding the vectors is 47.9GB(total available - used by the index)
2025-03-09 09:04:31,811 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/47 [00:00<?, ?it/s]  2%|▏         | 1/47 [00:00<00:10,  4.30it/s]  4%|▍         | 2/47 [00:00<00:07,  6.42it/s]  6%|▋         | 3/47 [00:00<00:05,  7.60it/s] 11%|█         | 5/47 [00:00<00:04,  8.82it/s] 13%|█▎        | 6/47 [00:00<00:04,  9.01it/s] 15%|█▍        | 7/47 [00:00<00:04,  9.15it/s] 17%|█▋        | 8/47 [00:00<00:04,  9.26it/s] 19%|█▉        | 9/47 [00:01<00:04,  9.45it/s] 21%|██▏       | 10/47 [00:01<00:03,  9.49it/s] 23%|██▎       | 11/47 [00:01<00:03,  9.47it/s] 26%|██▌       | 12/47 [00:01<00:03,  9.32it/s] 28%|██▊       | 13/47 [00:01<00:03,  9.21it/s] 32%|███▏      | 15/47 [00:01<00:03, 10.27it/s] 36%|███▌      | 17/47 [00:01<00:02, 10.89it/s] 40%|████      | 19/47 [00:01<00:02, 11.22it/s] 45%|████▍     | 21/47 [00:08<00:30,  1.16s/it] 49%|████▉     | 23/47 [00:08<00:19,  1.23it/s] 53%|█████▎    | 25/47 [00:08<00:12,  1.73it/s] 57%|█████▋    | 27/47 [00:08<00:08,  2.35it/s] 62%|██████▏   | 29/47 [00:09<00:05,  3.12it/s] 66%|██████▌   | 31/47 [00:09<00:03,  4.01it/s] 70%|███████   | 33/47 [00:09<00:02,  4.99it/s] 74%|███████▍  | 35/47 [00:09<00:01,  6.01it/s] 79%|███████▊  | 37/47 [00:09<00:01,  7.06it/s] 83%|████████▎ | 39/47 [00:10<00:00,  8.07it/s] 87%|████████▋ | 41/47 [00:10<00:00,  9.09it/s] 91%|█████████▏| 43/47 [00:17<00:04,  1.15s/it] 96%|█████████▌| 45/47 [00:17<00:01,  1.21it/s]100%|██████████| 47/47 [00:20<00:00,  1.08s/it]100%|██████████| 47/47 [00:20<00:00,  2.26it/s]
2025-03-09 09:04:52,614 [INFO]: 	Computing best hyperparameters for index knn.index 03/09/2025, 09:04:52
2025-03-09 09:06:03,225 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 70.6107 secs
2025-03-09 09:06:03,225 [INFO]: The best hyperparameters are: efSearch=79
2025-03-09 09:06:03,225 [INFO]: 	Compute fast metrics 03/09/2025, 09:06:03
  0%|          | 0/4 [00:00<?, ?it/s] 25%|██▌       | 1/4 [00:00<00:00,  5.11it/s] 50%|█████     | 2/4 [00:00<00:00,  6.82it/s] 75%|███████▌  | 3/4 [00:00<00:00,  7.57it/s] 75%|███████▌  | 3/4 [00:00<00:00,  5.69it/s]
2025-03-09 09:06:31,051 [INFO]: 	>>> Finished "Compute fast metrics" in 27.8265 secs
2025-03-09 09:06:31,053 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 119.2422 secs
2025-03-09 09:06:31,053 [INFO]: {
2025-03-09 09:06:31,053 [INFO]: 	index_key: HNSW32
2025-03-09 09:06:31,053 [INFO]: 	index_param: efSearch=79
2025-03-09 09:06:31,053 [INFO]: 	index_path: knn.index
2025-03-09 09:06:31,053 [INFO]: 	size in bytes: 2214505506
2025-03-09 09:06:31,053 [INFO]: 	avg_search_speed_ms: 9.360023940607585
2025-03-09 09:06:31,053 [INFO]: 	99p_search_speed_ms: 17.769606849178672
2025-03-09 09:06:31,053 [INFO]: 	reconstruction error %: 0.0
2025-03-09 09:06:31,053 [INFO]: 	nb vectors: 11248
2025-03-09 09:06:31,053 [INFO]: 	vectors dimension: 49152
2025-03-09 09:06:31,053 [INFO]: 	compression ratio: 0.9986187787785071
2025-03-09 09:06:31,053 [INFO]: }
2025-03-09 09:06:31,053 [INFO]: 	>>> Finished "Creating the index" in 119.2439 secs
2025-03-09 09:06:31,053 [INFO]: >>> Finished "Launching the whole pipeline" in 119.2716 secs
2025-03-09 09:06:33: [retrieval_preprocessing] calculating distances ...
2025-03-09 09:06:37: [retrieval_preprocessing] finished and saved retrieval indices for episode 70173 [episode count 17/20]
[retrieval_preprocessing] for episode 2846 [episode count 18/20], we have num_retrieval=np.int64(11512) num_query=np.int64(720)
2025-03-09 09:06:41,245 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-09 09:06:42,799 [INFO]: Launching the whole pipeline 03/09/2025, 09:06:42
2025-03-09 09:06:42,799 [INFO]: Reading total number of vectors and dimension 03/09/2025, 09:06:42
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 984.35it/s]
2025-03-09 09:06:42,833 [INFO]: There are 11512 embeddings of dim 49152
2025-03-09 09:06:42,833 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0345 secs
2025-03-09 09:06:42,833 [INFO]: 	Compute estimated construction time of the index 03/09/2025, 09:06:42
2025-03-09 09:06:42,833 [INFO]: 		-> Train: 16.7 minutes
2025-03-09 09:06:42,834 [INFO]: 		-> Add: 6.3 seconds
2025-03-09 09:06:42,834 [INFO]: 		Total: 16.8 minutes
2025-03-09 09:06:42,834 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0004 secs
2025-03-09 09:06:42,834 [INFO]: 	Checking that your have enough memory available to create the index 03/09/2025, 09:06:42
2025-03-09 09:06:42,834 [INFO]: 2.3GB of memory will be needed to build the index (more might be used if you have more)
2025-03-09 09:06:42,834 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0005 secs
2025-03-09 09:06:42,835 [INFO]: 	Selecting most promising index types given data characteristics 03/09/2025, 09:06:42
2025-03-09 09:06:42,835 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0001 secs
2025-03-09 09:06:42,835 [INFO]: 	Creating the index 03/09/2025, 09:06:42
2025-03-09 09:06:42,835 [INFO]: 		-> Instanciate the index HNSW32 03/09/2025, 09:06:42
2025-03-09 09:06:42,838 [INFO]: 		>>> Finished "-> Instanciate the index HNSW32" in 0.0027 secs
2025-03-09 09:06:42,838 [INFO]: 		-> Adding the vectors to the index 03/09/2025, 09:06:42
2025-03-09 09:06:42,838 [INFO]: The memory available for adding the vectors is 47.9GB(total available - used by the index)
2025-03-09 09:06:42,838 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/48 [00:00<?, ?it/s]  2%|▏         | 1/48 [00:00<00:10,  4.37it/s]  6%|▋         | 3/48 [00:00<00:05,  8.73it/s] 10%|█         | 5/48 [00:00<00:04, 10.56it/s] 15%|█▍        | 7/48 [00:00<00:03, 11.34it/s] 19%|█▉        | 9/48 [00:00<00:03, 11.77it/s] 23%|██▎       | 11/48 [00:00<00:03, 12.24it/s] 27%|██▋       | 13/48 [00:01<00:02, 12.40it/s] 31%|███▏      | 15/48 [00:01<00:02, 12.53it/s] 35%|███▌      | 17/48 [00:01<00:02, 12.78it/s] 40%|███▉      | 19/48 [00:01<00:02, 12.76it/s] 44%|████▍     | 21/48 [00:07<00:24,  1.09it/s] 48%|████▊     | 23/48 [00:07<00:16,  1.52it/s] 52%|█████▏    | 25/48 [00:07<00:11,  2.07it/s] 56%|█████▋    | 27/48 [00:07<00:07,  2.78it/s] 60%|██████    | 29/48 [00:07<00:05,  3.65it/s] 65%|██████▍   | 31/48 [00:07<00:03,  4.67it/s] 69%|██████▉   | 33/48 [00:08<00:02,  5.79it/s] 73%|███████▎  | 35/48 [00:08<00:01,  6.98it/s] 77%|███████▋  | 37/48 [00:08<00:01,  8.19it/s] 81%|████████▏ | 39/48 [00:08<00:00,  9.33it/s] 85%|████████▌ | 41/48 [00:08<00:00, 10.25it/s] 90%|████████▉ | 43/48 [00:15<00:05,  1.08s/it] 94%|█████████▍| 45/48 [00:15<00:02,  1.27it/s] 98%|█████████▊| 47/48 [00:15<00:00,  1.74it/s]100%|██████████| 48/48 [00:19<00:00,  2.48it/s]
2025-03-09 09:07:02,190 [INFO]: 	Computing best hyperparameters for index knn.index 03/09/2025, 09:07:02
2025-03-09 09:08:21,648 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 79.4576 secs
2025-03-09 09:08:21,648 [INFO]: The best hyperparameters are: efSearch=93
2025-03-09 09:08:21,648 [INFO]: 	Compute fast metrics 03/09/2025, 09:08:21
  0%|          | 0/4 [00:00<?, ?it/s] 25%|██▌       | 1/4 [00:00<00:00,  6.23it/s] 75%|███████▌  | 3/4 [00:00<00:00, 12.96it/s]
2025-03-09 09:08:43,299 [INFO]: 	>>> Finished "Compute fast metrics" in 21.6501 secs
2025-03-09 09:08:43,504 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 120.6661 secs
2025-03-09 09:08:43,505 [INFO]: {
2025-03-09 09:08:43,505 [INFO]: 	index_key: HNSW32
2025-03-09 09:08:43,505 [INFO]: 	index_param: efSearch=93
2025-03-09 09:08:43,505 [INFO]: 	index_path: knn.index
2025-03-09 09:08:43,505 [INFO]: 	size in bytes: 2266481922
2025-03-09 09:08:43,505 [INFO]: 	avg_search_speed_ms: 10.031129971731346
2025-03-09 09:08:43,505 [INFO]: 	99p_search_speed_ms: 16.862901756539937
2025-03-09 09:08:43,505 [INFO]: 	reconstruction error %: 0.0
2025-03-09 09:08:43,505 [INFO]: 	nb vectors: 11512
2025-03-09 09:08:43,505 [INFO]: 	vectors dimension: 49152
2025-03-09 09:08:43,506 [INFO]: 	compression ratio: 0.9986187288900864
2025-03-09 09:08:43,506 [INFO]: }
2025-03-09 09:08:43,506 [INFO]: 	>>> Finished "Creating the index" in 120.6706 secs
2025-03-09 09:08:43,506 [INFO]: >>> Finished "Launching the whole pipeline" in 120.7071 secs
2025-03-09 09:08:45: [retrieval_preprocessing] calculating distances ...
2025-03-09 09:08:48: [retrieval_preprocessing] finished and saved retrieval indices for episode 2846 [episode count 18/20]
[retrieval_preprocessing] for episode 66334 [episode count 19/20], we have num_retrieval=np.int64(11680) num_query=np.int64(552)
2025-03-09 09:08:51,589 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-09 09:08:53,050 [INFO]: Launching the whole pipeline 03/09/2025, 09:08:53
2025-03-09 09:08:53,050 [INFO]: Reading total number of vectors and dimension 03/09/2025, 09:08:53
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 2069.22it/s]
2025-03-09 09:08:53,073 [INFO]: There are 11680 embeddings of dim 49152
2025-03-09 09:08:53,073 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0233 secs
2025-03-09 09:08:53,074 [INFO]: 	Compute estimated construction time of the index 03/09/2025, 09:08:53
2025-03-09 09:08:53,074 [INFO]: 		-> Train: 16.7 minutes
2025-03-09 09:08:53,074 [INFO]: 		-> Add: 6.4 seconds
2025-03-09 09:08:53,074 [INFO]: 		Total: 16.8 minutes
2025-03-09 09:08:53,074 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0001 secs
2025-03-09 09:08:53,074 [INFO]: 	Checking that your have enough memory available to create the index 03/09/2025, 09:08:53
2025-03-09 09:08:53,074 [INFO]: 2.4GB of memory will be needed to build the index (more might be used if you have more)
2025-03-09 09:08:53,074 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0002 secs
2025-03-09 09:08:53,074 [INFO]: 	Selecting most promising index types given data characteristics 03/09/2025, 09:08:53
2025-03-09 09:08:53,074 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-09 09:08:53,074 [INFO]: 	Creating the index 03/09/2025, 09:08:53
2025-03-09 09:08:53,074 [INFO]: 		-> Instanciate the index HNSW32 03/09/2025, 09:08:53
2025-03-09 09:08:53,075 [INFO]: 		>>> Finished "-> Instanciate the index HNSW32" in 0.0009 secs
2025-03-09 09:08:53,075 [INFO]: 		-> Adding the vectors to the index 03/09/2025, 09:08:53
2025-03-09 09:08:53,075 [INFO]: The memory available for adding the vectors is 47.9GB(total available - used by the index)
2025-03-09 09:08:53,075 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/48 [00:00<?, ?it/s]  2%|▏         | 1/48 [00:00<00:10,  4.55it/s]  6%|▋         | 3/48 [00:00<00:04,  9.12it/s] 10%|█         | 5/48 [00:00<00:03, 10.91it/s] 15%|█▍        | 7/48 [00:00<00:03, 11.89it/s] 19%|█▉        | 9/48 [00:00<00:03, 12.24it/s] 23%|██▎       | 11/48 [00:00<00:03, 11.99it/s] 27%|██▋       | 13/48 [00:01<00:02, 12.38it/s] 31%|███▏      | 15/48 [00:01<00:02, 12.70it/s] 35%|███▌      | 17/48 [00:01<00:02, 12.86it/s] 40%|███▉      | 19/48 [00:01<00:02, 13.05it/s] 44%|████▍     | 21/48 [00:08<00:30,  1.12s/it] 50%|█████     | 24/48 [00:08<00:16,  1.44it/s] 54%|█████▍    | 26/48 [00:08<00:11,  1.93it/s] 58%|█████▊    | 28/48 [00:08<00:07,  2.51it/s] 62%|██████▎   | 30/48 [00:09<00:05,  3.24it/s] 67%|██████▋   | 32/48 [00:09<00:03,  4.09it/s] 71%|███████   | 34/48 [00:09<00:02,  5.02it/s] 75%|███████▌  | 36/48 [00:09<00:02,  6.00it/s] 79%|███████▉  | 38/48 [00:09<00:01,  7.13it/s] 83%|████████▎ | 40/48 [00:10<00:00,  8.12it/s] 88%|████████▊ | 42/48 [00:17<00:07,  1.22s/it] 92%|█████████▏| 44/48 [00:17<00:03,  1.15it/s] 96%|█████████▌| 46/48 [00:17<00:01,  1.58it/s]100%|██████████| 48/48 [00:21<00:00,  1.01s/it]100%|██████████| 48/48 [00:21<00:00,  2.22it/s]
2025-03-09 09:09:15,014 [INFO]: 	Computing best hyperparameters for index knn.index 03/09/2025, 09:09:15
2025-03-09 09:10:29,966 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 74.9513 secs
2025-03-09 09:10:29,966 [INFO]: The best hyperparameters are: efSearch=91
2025-03-09 09:10:29,966 [INFO]: 	Compute fast metrics 03/09/2025, 09:10:29
  0%|          | 0/4 [00:00<?, ?it/s] 25%|██▌       | 1/4 [00:00<00:00,  4.97it/s] 50%|█████     | 2/4 [00:00<00:00,  6.87it/s] 75%|███████▌  | 3/4 [00:00<00:00,  7.82it/s] 75%|███████▌  | 3/4 [00:00<00:00,  5.84it/s]
2025-03-09 09:10:53,142 [INFO]: 	>>> Finished "Compute fast metrics" in 23.1764 secs
2025-03-09 09:10:53,144 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 120.0687 secs
2025-03-09 09:10:53,144 [INFO]: {
2025-03-09 09:10:53,144 [INFO]: 	index_key: HNSW32
2025-03-09 09:10:53,144 [INFO]: 	index_param: efSearch=91
2025-03-09 09:10:53,144 [INFO]: 	index_path: knn.index
2025-03-09 09:10:53,144 [INFO]: 	size in bytes: 2299559010
2025-03-09 09:10:53,144 [INFO]: 	avg_search_speed_ms: 10.937001175579312
2025-03-09 09:10:53,144 [INFO]: 	99p_search_speed_ms: 18.8972470141016
2025-03-09 09:10:53,144 [INFO]: 	reconstruction error %: 0.0
2025-03-09 09:10:53,144 [INFO]: 	nb vectors: 11680
2025-03-09 09:10:53,144 [INFO]: 	vectors dimension: 49152
2025-03-09 09:10:53,144 [INFO]: 	compression ratio: 0.9986181828836825
2025-03-09 09:10:53,144 [INFO]: }
2025-03-09 09:10:53,144 [INFO]: 	>>> Finished "Creating the index" in 120.0702 secs
2025-03-09 09:10:53,144 [INFO]: >>> Finished "Launching the whole pipeline" in 120.0942 secs
2025-03-09 09:10:54: [retrieval_preprocessing] calculating distances ...
2025-03-09 09:10:56: [retrieval_preprocessing] finished and saved retrieval indices for episode 66334 [episode count 19/20]
2025-03-09 09:10:56: [retrieval_preprocessing] finished for (440287856, 'drawer') [chosen_id count 3/10]
2025-03-09 09:10:58: [retrieval_preprocessing] concatenated all embeddings and indices for 20 episodes for (376702246, 'cup') [chosen_id count 4/10]
2025-03-09 09:10:58: [retrieval_preprocessing] we have num_total=2435 embedding_dim=49152
[retrieval_preprocessing] for episode 6016 [episode count 0/20], we have num_retrieval=np.int64(2331) num_query=np.int64(104)
2025-03-09 09:10:59,212 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-09 09:10:59,604 [INFO]: Launching the whole pipeline 03/09/2025, 09:10:59
2025-03-09 09:10:59,604 [INFO]: Reading total number of vectors and dimension 03/09/2025, 09:10:59
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1425.18it/s]
2025-03-09 09:10:59,631 [INFO]: There are 2331 embeddings of dim 49152
2025-03-09 09:10:59,632 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0279 secs
2025-03-09 09:10:59,632 [INFO]: 	Compute estimated construction time of the index 03/09/2025, 09:10:59
2025-03-09 09:10:59,632 [INFO]: 		-> Train: 16.7 minutes
2025-03-09 09:10:59,632 [INFO]: 		-> Add: 1.3 seconds
2025-03-09 09:10:59,632 [INFO]: 		Total: 16.7 minutes
2025-03-09 09:10:59,632 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0001 secs
2025-03-09 09:10:59,632 [INFO]: 	Checking that your have enough memory available to create the index 03/09/2025, 09:10:59
2025-03-09 09:10:59,632 [INFO]: 481.1MB of memory will be needed to build the index (more might be used if you have more)
2025-03-09 09:10:59,632 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0002 secs
2025-03-09 09:10:59,632 [INFO]: 	Selecting most promising index types given data characteristics 03/09/2025, 09:10:59
2025-03-09 09:10:59,632 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-09 09:10:59,632 [INFO]: 	Creating the index 03/09/2025, 09:10:59
2025-03-09 09:10:59,632 [INFO]: 		-> Instanciate the index HNSW15 03/09/2025, 09:10:59
2025-03-09 09:10:59,633 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0011 secs
2025-03-09 09:10:59,633 [INFO]: 		-> Adding the vectors to the index 03/09/2025, 09:10:59
2025-03-09 09:10:59,634 [INFO]: The memory available for adding the vectors is 49.6GB(total available - used by the index)
2025-03-09 09:10:59,634 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/10 [00:00<?, ?it/s] 10%|█         | 1/10 [00:00<00:00,  9.16it/s] 60%|██████    | 6/10 [00:00<00:00, 30.42it/s]100%|██████████| 10/10 [00:01<00:00,  4.83it/s]100%|██████████| 10/10 [00:01<00:00,  5.73it/s]
2025-03-09 09:11:01,380 [INFO]: 	Computing best hyperparameters for index knn.index 03/09/2025, 09:11:01
2025-03-09 09:11:23,596 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 22.2152 secs
2025-03-09 09:11:23,596 [INFO]: The best hyperparameters are: efSearch=258
2025-03-09 09:11:23,596 [INFO]: 	Compute fast metrics 03/09/2025, 09:11:23
  0%|          | 0/4 [00:00<?, ?it/s] 25%|██▌       | 1/4 [00:00<00:00,  6.97it/s] 75%|███████▌  | 3/4 [00:00<00:00,  9.71it/s] 75%|███████▌  | 3/4 [00:00<00:00,  7.50it/s]
2025-03-09 09:11:37,292 [INFO]: 	>>> Finished "Compute fast metrics" in 13.6957 secs
2025-03-09 09:11:37,293 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 37.6599 secs
2025-03-09 09:11:37,293 [INFO]: {
2025-03-09 09:11:37,293 [INFO]: 	index_key: HNSW15
2025-03-09 09:11:37,294 [INFO]: 	index_param: efSearch=258
2025-03-09 09:11:37,294 [INFO]: 	index_path: knn.index
2025-03-09 09:11:37,294 [INFO]: 	size in bytes: 458609950
2025-03-09 09:11:37,294 [INFO]: 	avg_search_speed_ms: 8.617376904043466
2025-03-09 09:11:37,294 [INFO]: 	99p_search_speed_ms: 11.939063933677971
2025-03-09 09:11:37,294 [INFO]: 	reconstruction error %: 0.0
2025-03-09 09:11:37,294 [INFO]: 	nb vectors: 2331
2025-03-09 09:11:37,294 [INFO]: 	vectors dimension: 49152
2025-03-09 09:11:37,294 [INFO]: 	compression ratio: 0.999309430595651
2025-03-09 09:11:37,294 [INFO]: }
2025-03-09 09:11:37,294 [INFO]: 	>>> Finished "Creating the index" in 37.6615 secs
2025-03-09 09:11:37,294 [INFO]: >>> Finished "Launching the whole pipeline" in 37.6900 secs
2025-03-09 09:11:37: [retrieval_preprocessing] calculating distances ...
2025-03-09 09:11:38: [retrieval_preprocessing] finished and saved retrieval indices for episode 6016 [episode count 0/20]
[retrieval_preprocessing] for episode 86019 [episode count 1/20], we have num_retrieval=np.int64(2315) num_query=np.int64(120)
2025-03-09 09:11:38,995 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-09 09:11:39,293 [INFO]: Launching the whole pipeline 03/09/2025, 09:11:39
2025-03-09 09:11:39,293 [INFO]: Reading total number of vectors and dimension 03/09/2025, 09:11:39
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 2208.69it/s]
2025-03-09 09:11:39,316 [INFO]: There are 2315 embeddings of dim 49152
2025-03-09 09:11:39,316 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0229 secs
2025-03-09 09:11:39,316 [INFO]: 	Compute estimated construction time of the index 03/09/2025, 09:11:39
2025-03-09 09:11:39,316 [INFO]: 		-> Train: 16.7 minutes
2025-03-09 09:11:39,316 [INFO]: 		-> Add: 1.3 seconds
2025-03-09 09:11:39,316 [INFO]: 		Total: 16.7 minutes
2025-03-09 09:11:39,316 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0001 secs
2025-03-09 09:11:39,316 [INFO]: 	Checking that your have enough memory available to create the index 03/09/2025, 09:11:39
2025-03-09 09:11:39,316 [INFO]: 477.8MB of memory will be needed to build the index (more might be used if you have more)
2025-03-09 09:11:39,317 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0001 secs
2025-03-09 09:11:39,317 [INFO]: 	Selecting most promising index types given data characteristics 03/09/2025, 09:11:39
2025-03-09 09:11:39,317 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-09 09:11:39,317 [INFO]: 	Creating the index 03/09/2025, 09:11:39
2025-03-09 09:11:39,317 [INFO]: 		-> Instanciate the index HNSW15 03/09/2025, 09:11:39
2025-03-09 09:11:39,318 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0009 secs
2025-03-09 09:11:39,318 [INFO]: 		-> Adding the vectors to the index 03/09/2025, 09:11:39
2025-03-09 09:11:39,318 [INFO]: The memory available for adding the vectors is 49.6GB(total available - used by the index)
2025-03-09 09:11:39,318 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/10 [00:00<?, ?it/s] 10%|█         | 1/10 [00:00<00:01,  6.43it/s] 30%|███       | 3/10 [00:00<00:00, 11.25it/s] 50%|█████     | 5/10 [00:00<00:00, 12.72it/s] 70%|███████   | 7/10 [00:00<00:00, 13.49it/s]100%|██████████| 10/10 [00:02<00:00,  3.72it/s]100%|██████████| 10/10 [00:02<00:00,  4.96it/s]
2025-03-09 09:11:41,335 [INFO]: 	Computing best hyperparameters for index knn.index 03/09/2025, 09:11:41
2025-03-09 09:12:03,813 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 22.4780 secs
2025-03-09 09:12:03,813 [INFO]: The best hyperparameters are: efSearch=356
2025-03-09 09:12:03,813 [INFO]: 	Compute fast metrics 03/09/2025, 09:12:03
  0%|          | 0/4 [00:00<?, ?it/s] 25%|██▌       | 1/4 [00:00<00:00,  6.52it/s] 75%|███████▌  | 3/4 [00:00<00:00,  8.89it/s] 75%|███████▌  | 3/4 [00:00<00:00,  6.73it/s]
2025-03-09 09:12:21,446 [INFO]: 	>>> Finished "Compute fast metrics" in 17.6331 secs
2025-03-09 09:12:21,448 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 42.1305 secs
2025-03-09 09:12:21,448 [INFO]: {
2025-03-09 09:12:21,448 [INFO]: 	index_key: HNSW15
2025-03-09 09:12:21,448 [INFO]: 	index_param: efSearch=356
2025-03-09 09:12:21,448 [INFO]: 	index_path: knn.index
2025-03-09 09:12:21,448 [INFO]: 	size in bytes: 455462050
2025-03-09 09:12:21,448 [INFO]: 	avg_search_speed_ms: 11.64904183153024
2025-03-09 09:12:21,448 [INFO]: 	99p_search_speed_ms: 15.929629425518213
2025-03-09 09:12:21,448 [INFO]: 	reconstruction error %: 0.0
2025-03-09 09:12:21,448 [INFO]: 	nb vectors: 2315
2025-03-09 09:12:21,448 [INFO]: 	vectors dimension: 49152
2025-03-09 09:12:21,448 [INFO]: 	compression ratio: 0.9993094265482712
2025-03-09 09:12:21,448 [INFO]: }
2025-03-09 09:12:21,448 [INFO]: 	>>> Finished "Creating the index" in 42.1319 secs
2025-03-09 09:12:21,449 [INFO]: >>> Finished "Launching the whole pipeline" in 42.1553 secs
2025-03-09 09:12:22: [retrieval_preprocessing] calculating distances ...
2025-03-09 09:12:23: [retrieval_preprocessing] finished and saved retrieval indices for episode 86019 [episode count 1/20]
[retrieval_preprocessing] for episode 34308 [episode count 2/20], we have num_retrieval=np.int64(2310) num_query=np.int64(125)
2025-03-09 09:12:24,123 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-09 09:12:24,490 [INFO]: Launching the whole pipeline 03/09/2025, 09:12:24
2025-03-09 09:12:24,490 [INFO]: Reading total number of vectors and dimension 03/09/2025, 09:12:24
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1423.25it/s]
2025-03-09 09:12:24,515 [INFO]: There are 2310 embeddings of dim 49152
2025-03-09 09:12:24,516 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0255 secs
2025-03-09 09:12:24,516 [INFO]: 	Compute estimated construction time of the index 03/09/2025, 09:12:24
2025-03-09 09:12:24,516 [INFO]: 		-> Train: 16.7 minutes
2025-03-09 09:12:24,516 [INFO]: 		-> Add: 1.3 seconds
2025-03-09 09:12:24,516 [INFO]: 		Total: 16.7 minutes
2025-03-09 09:12:24,516 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0001 secs
2025-03-09 09:12:24,516 [INFO]: 	Checking that your have enough memory available to create the index 03/09/2025, 09:12:24
2025-03-09 09:12:24,516 [INFO]: 476.7MB of memory will be needed to build the index (more might be used if you have more)
2025-03-09 09:12:24,516 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0001 secs
2025-03-09 09:12:24,516 [INFO]: 	Selecting most promising index types given data characteristics 03/09/2025, 09:12:24
2025-03-09 09:12:24,516 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-09 09:12:24,516 [INFO]: 	Creating the index 03/09/2025, 09:12:24
2025-03-09 09:12:24,516 [INFO]: 		-> Instanciate the index HNSW15 03/09/2025, 09:12:24
2025-03-09 09:12:24,517 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0010 secs
2025-03-09 09:12:24,517 [INFO]: 		-> Adding the vectors to the index 03/09/2025, 09:12:24
2025-03-09 09:12:24,517 [INFO]: The memory available for adding the vectors is 49.6GB(total available - used by the index)
2025-03-09 09:12:24,517 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/10 [00:00<?, ?it/s] 10%|█         | 1/10 [00:00<00:01,  4.79it/s] 20%|██        | 2/10 [00:00<00:01,  6.56it/s] 30%|███       | 3/10 [00:00<00:00,  7.58it/s] 40%|████      | 4/10 [00:00<00:00,  8.01it/s] 50%|█████     | 5/10 [00:00<00:00,  8.29it/s] 60%|██████    | 6/10 [00:00<00:00,  8.43it/s] 70%|███████   | 7/10 [00:00<00:00,  8.59it/s] 80%|████████  | 8/10 [00:00<00:00,  8.83it/s] 90%|█████████ | 9/10 [00:01<00:00,  8.86it/s]100%|██████████| 10/10 [00:02<00:00,  1.68it/s]100%|██████████| 10/10 [00:02<00:00,  3.59it/s]
2025-03-09 09:12:27,304 [INFO]: 	Computing best hyperparameters for index knn.index 03/09/2025, 09:12:27
2025-03-09 09:12:53,379 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 26.0748 secs
2025-03-09 09:12:53,379 [INFO]: The best hyperparameters are: efSearch=317
2025-03-09 09:12:53,379 [INFO]: 	Compute fast metrics 03/09/2025, 09:12:53
  0%|          | 0/4 [00:00<?, ?it/s] 25%|██▌       | 1/4 [00:00<00:00,  5.59it/s] 75%|███████▌  | 3/4 [00:00<00:00, 10.37it/s] 75%|███████▌  | 3/4 [00:00<00:00,  7.60it/s]
2025-03-09 09:13:07,437 [INFO]: 	>>> Finished "Compute fast metrics" in 14.0578 secs
2025-03-09 09:13:07,438 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 42.9210 secs
2025-03-09 09:13:07,438 [INFO]: {
2025-03-09 09:13:07,438 [INFO]: 	index_key: HNSW15
2025-03-09 09:13:07,438 [INFO]: 	index_param: efSearch=317
2025-03-09 09:13:07,439 [INFO]: 	index_path: knn.index
2025-03-09 09:13:07,439 [INFO]: 	size in bytes: 454478350
2025-03-09 09:13:07,439 [INFO]: 	avg_search_speed_ms: 12.13803484745423
2025-03-09 09:13:07,439 [INFO]: 	99p_search_speed_ms: 22.488906322978433
2025-03-09 09:13:07,439 [INFO]: 	reconstruction error %: 0.0
2025-03-09 09:13:07,439 [INFO]: 	nb vectors: 2310
2025-03-09 09:13:07,439 [INFO]: 	vectors dimension: 49152
2025-03-09 09:13:07,439 [INFO]: 	compression ratio: 0.9993093840443664
2025-03-09 09:13:07,439 [INFO]: }
2025-03-09 09:13:07,439 [INFO]: 	>>> Finished "Creating the index" in 42.9225 secs
2025-03-09 09:13:07,439 [INFO]: >>> Finished "Launching the whole pipeline" in 42.9485 secs
2025-03-09 09:13:08: [retrieval_preprocessing] calculating distances ...
2025-03-09 09:13:08: [retrieval_preprocessing] finished and saved retrieval indices for episode 34308 [episode count 2/20]
[retrieval_preprocessing] for episode 45701 [episode count 3/20], we have num_retrieval=np.int64(2319) num_query=np.int64(116)
2025-03-09 09:13:09,353 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-09 09:13:09,651 [INFO]: Launching the whole pipeline 03/09/2025, 09:13:09
2025-03-09 09:13:09,651 [INFO]: Reading total number of vectors and dimension 03/09/2025, 09:13:09
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 2379.07it/s]
2025-03-09 09:13:09,673 [INFO]: There are 2319 embeddings of dim 49152
2025-03-09 09:13:09,673 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0228 secs
2025-03-09 09:13:09,674 [INFO]: 	Compute estimated construction time of the index 03/09/2025, 09:13:09
2025-03-09 09:13:09,674 [INFO]: 		-> Train: 16.7 minutes
2025-03-09 09:13:09,674 [INFO]: 		-> Add: 1.3 seconds
2025-03-09 09:13:09,674 [INFO]: 		Total: 16.7 minutes
2025-03-09 09:13:09,674 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0001 secs
2025-03-09 09:13:09,674 [INFO]: 	Checking that your have enough memory available to create the index 03/09/2025, 09:13:09
2025-03-09 09:13:09,674 [INFO]: 478.6MB of memory will be needed to build the index (more might be used if you have more)
2025-03-09 09:13:09,674 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0001 secs
2025-03-09 09:13:09,674 [INFO]: 	Selecting most promising index types given data characteristics 03/09/2025, 09:13:09
2025-03-09 09:13:09,674 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-09 09:13:09,674 [INFO]: 	Creating the index 03/09/2025, 09:13:09
2025-03-09 09:13:09,674 [INFO]: 		-> Instanciate the index HNSW15 03/09/2025, 09:13:09
2025-03-09 09:13:09,675 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0007 secs
2025-03-09 09:13:09,675 [INFO]: 		-> Adding the vectors to the index 03/09/2025, 09:13:09
2025-03-09 09:13:09,675 [INFO]: The memory available for adding the vectors is 49.6GB(total available - used by the index)
2025-03-09 09:13:09,675 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/10 [00:00<?, ?it/s] 10%|█         | 1/10 [00:00<00:01,  6.29it/s] 30%|███       | 3/10 [00:00<00:00, 10.01it/s] 50%|█████     | 5/10 [00:00<00:00, 11.31it/s] 70%|███████   | 7/10 [00:00<00:00, 11.56it/s] 90%|█████████ | 9/10 [00:00<00:00, 11.99it/s]100%|██████████| 10/10 [00:02<00:00,  4.42it/s]
2025-03-09 09:13:11,938 [INFO]: 	Computing best hyperparameters for index knn.index 03/09/2025, 09:13:11
2025-03-09 09:13:42,026 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 30.0877 secs
2025-03-09 09:13:42,026 [INFO]: The best hyperparameters are: efSearch=301
2025-03-09 09:13:42,026 [INFO]: 	Compute fast metrics 03/09/2025, 09:13:42
  0%|          | 0/4 [00:00<?, ?it/s] 25%|██▌       | 1/4 [00:00<00:00,  8.55it/s] 75%|███████▌  | 3/4 [00:00<00:00, 11.45it/s] 75%|███████▌  | 3/4 [00:00<00:00,  8.65it/s]
2025-03-09 09:13:55,705 [INFO]: 	>>> Finished "Compute fast metrics" in 13.6788 secs
2025-03-09 09:13:55,707 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 46.0326 secs
2025-03-09 09:13:55,707 [INFO]: {
2025-03-09 09:13:55,708 [INFO]: 	index_key: HNSW15
2025-03-09 09:13:55,708 [INFO]: 	index_param: efSearch=301
2025-03-09 09:13:55,708 [INFO]: 	index_path: knn.index
2025-03-09 09:13:55,708 [INFO]: 	size in bytes: 456249010
2025-03-09 09:13:55,708 [INFO]: 	avg_search_speed_ms: 12.04541955558381
2025-03-09 09:13:55,708 [INFO]: 	99p_search_speed_ms: 26.229869627859472
2025-03-09 09:13:55,708 [INFO]: 	reconstruction error %: 0.0
2025-03-09 09:13:55,708 [INFO]: 	nb vectors: 2319
2025-03-09 09:13:55,708 [INFO]: 	vectors dimension: 49152
2025-03-09 09:13:55,708 [INFO]: 	compression ratio: 0.9993094604194319
2025-03-09 09:13:55,708 [INFO]: }
2025-03-09 09:13:55,708 [INFO]: 	>>> Finished "Creating the index" in 46.0337 secs
2025-03-09 09:13:55,708 [INFO]: >>> Finished "Launching the whole pipeline" in 46.0571 secs
2025-03-09 09:13:56: [retrieval_preprocessing] calculating distances ...
2025-03-09 09:13:56: [retrieval_preprocessing] finished and saved retrieval indices for episode 45701 [episode count 3/20]
[retrieval_preprocessing] for episode 18438 [episode count 4/20], we have num_retrieval=np.int64(2293) num_query=np.int64(142)
2025-03-09 09:13:57,643 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-09 09:13:57,973 [INFO]: Launching the whole pipeline 03/09/2025, 09:13:57
2025-03-09 09:13:57,973 [INFO]: Reading total number of vectors and dimension 03/09/2025, 09:13:57
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1087.45it/s]
2025-03-09 09:13:57,998 [INFO]: There are 2293 embeddings of dim 49152
2025-03-09 09:13:57,999 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0258 secs
2025-03-09 09:13:57,999 [INFO]: 	Compute estimated construction time of the index 03/09/2025, 09:13:57
2025-03-09 09:13:57,999 [INFO]: 		-> Train: 16.7 minutes
2025-03-09 09:13:57,999 [INFO]: 		-> Add: 1.3 seconds
2025-03-09 09:13:57,999 [INFO]: 		Total: 16.7 minutes
2025-03-09 09:13:57,999 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0002 secs
2025-03-09 09:13:57,999 [INFO]: 	Checking that your have enough memory available to create the index 03/09/2025, 09:13:57
2025-03-09 09:13:57,999 [INFO]: 473.2MB of memory will be needed to build the index (more might be used if you have more)
2025-03-09 09:13:57,999 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0001 secs
2025-03-09 09:13:57,999 [INFO]: 	Selecting most promising index types given data characteristics 03/09/2025, 09:13:57
2025-03-09 09:13:57,999 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-09 09:13:57,999 [INFO]: 	Creating the index 03/09/2025, 09:13:57
2025-03-09 09:13:57,999 [INFO]: 		-> Instanciate the index HNSW15 03/09/2025, 09:13:57
2025-03-09 09:13:58,000 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0009 secs
2025-03-09 09:13:58,000 [INFO]: 		-> Adding the vectors to the index 03/09/2025, 09:13:58
2025-03-09 09:13:58,000 [INFO]: The memory available for adding the vectors is 49.6GB(total available - used by the index)
2025-03-09 09:13:58,000 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/10 [00:00<?, ?it/s] 10%|█         | 1/10 [00:00<00:01,  5.75it/s] 30%|███       | 3/10 [00:00<00:00,  9.18it/s] 50%|█████     | 5/10 [00:00<00:00, 10.20it/s] 70%|███████   | 7/10 [00:00<00:00, 10.69it/s] 90%|█████████ | 9/10 [00:00<00:00, 10.98it/s]100%|██████████| 10/10 [00:02<00:00,  4.04it/s]
2025-03-09 09:14:00,482 [INFO]: 	Computing best hyperparameters for index knn.index 03/09/2025, 09:14:00
2025-03-09 09:14:30,101 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 29.6196 secs
2025-03-09 09:14:30,102 [INFO]: The best hyperparameters are: efSearch=286
2025-03-09 09:14:30,102 [INFO]: 	Compute fast metrics 03/09/2025, 09:14:30
  0%|          | 0/4 [00:00<?, ?it/s] 25%|██▌       | 1/4 [00:00<00:00,  6.83it/s] 75%|███████▌  | 3/4 [00:00<00:00, 10.60it/s] 75%|███████▌  | 3/4 [00:00<00:00,  8.04it/s]
2025-03-09 09:14:49,618 [INFO]: 	>>> Finished "Compute fast metrics" in 19.5162 secs
2025-03-09 09:14:49,620 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 51.6199 secs
2025-03-09 09:14:49,620 [INFO]: {
2025-03-09 09:14:49,620 [INFO]: 	index_key: HNSW15
2025-03-09 09:14:49,620 [INFO]: 	index_param: efSearch=286
2025-03-09 09:14:49,620 [INFO]: 	index_path: knn.index
2025-03-09 09:14:49,620 [INFO]: 	size in bytes: 451133710
2025-03-09 09:14:49,620 [INFO]: 	avg_search_speed_ms: 10.30341040076406
2025-03-09 09:14:49,620 [INFO]: 	99p_search_speed_ms: 17.97353085130453
2025-03-09 09:14:49,620 [INFO]: 	reconstruction error %: 0.0
2025-03-09 09:14:49,620 [INFO]: 	nb vectors: 2293
2025-03-09 09:14:49,620 [INFO]: 	vectors dimension: 49152
2025-03-09 09:14:49,620 [INFO]: 	compression ratio: 0.9993093710509906
2025-03-09 09:14:49,620 [INFO]: }
2025-03-09 09:14:49,620 [INFO]: 	>>> Finished "Creating the index" in 51.6213 secs
2025-03-09 09:14:49,620 [INFO]: >>> Finished "Launching the whole pipeline" in 51.6477 secs
2025-03-09 09:14:50: [retrieval_preprocessing] calculating distances ...
2025-03-09 09:14:51: [retrieval_preprocessing] finished and saved retrieval indices for episode 18438 [episode count 4/20]
[retrieval_preprocessing] for episode 16776 [episode count 5/20], we have num_retrieval=np.int64(2342) num_query=np.int64(93)
2025-03-09 09:14:51,860 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-09 09:14:52,196 [INFO]: Launching the whole pipeline 03/09/2025, 09:14:52
2025-03-09 09:14:52,196 [INFO]: Reading total number of vectors and dimension 03/09/2025, 09:14:52
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1387.01it/s]
2025-03-09 09:14:52,222 [INFO]: There are 2342 embeddings of dim 49152
2025-03-09 09:14:52,222 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0265 secs
2025-03-09 09:14:52,223 [INFO]: 	Compute estimated construction time of the index 03/09/2025, 09:14:52
2025-03-09 09:14:52,223 [INFO]: 		-> Train: 16.7 minutes
2025-03-09 09:14:52,223 [INFO]: 		-> Add: 1.3 seconds
2025-03-09 09:14:52,223 [INFO]: 		Total: 16.7 minutes
2025-03-09 09:14:52,223 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0001 secs
2025-03-09 09:14:52,223 [INFO]: 	Checking that your have enough memory available to create the index 03/09/2025, 09:14:52
2025-03-09 09:14:52,223 [INFO]: 483.3MB of memory will be needed to build the index (more might be used if you have more)
2025-03-09 09:14:52,223 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0003 secs
2025-03-09 09:14:52,223 [INFO]: 	Selecting most promising index types given data characteristics 03/09/2025, 09:14:52
2025-03-09 09:14:52,223 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-09 09:14:52,223 [INFO]: 	Creating the index 03/09/2025, 09:14:52
2025-03-09 09:14:52,223 [INFO]: 		-> Instanciate the index HNSW15 03/09/2025, 09:14:52
2025-03-09 09:14:52,224 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0011 secs
2025-03-09 09:14:52,224 [INFO]: 		-> Adding the vectors to the index 03/09/2025, 09:14:52
2025-03-09 09:14:52,224 [INFO]: The memory available for adding the vectors is 49.6GB(total available - used by the index)
2025-03-09 09:14:52,225 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/10 [00:00<?, ?it/s] 10%|█         | 1/10 [00:00<00:01,  6.25it/s] 30%|███       | 3/10 [00:00<00:00,  9.87it/s] 50%|█████     | 5/10 [00:00<00:00, 10.97it/s] 70%|███████   | 7/10 [00:00<00:00, 11.31it/s] 90%|█████████ | 9/10 [00:00<00:00, 11.83it/s]100%|██████████| 10/10 [00:02<00:00,  4.34it/s]
2025-03-09 09:14:54,530 [INFO]: 	Computing best hyperparameters for index knn.index 03/09/2025, 09:14:54
2025-03-09 09:15:20,164 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 25.6332 secs
2025-03-09 09:15:20,164 [INFO]: The best hyperparameters are: efSearch=320
2025-03-09 09:15:20,164 [INFO]: 	Compute fast metrics 03/09/2025, 09:15:20
  0%|          | 0/4 [00:00<?, ?it/s] 25%|██▌       | 1/4 [00:00<00:00,  4.68it/s] 50%|█████     | 2/4 [00:00<00:00,  5.94it/s] 75%|███████▌  | 3/4 [00:00<00:00,  6.88it/s] 75%|███████▌  | 3/4 [00:00<00:00,  5.25it/s]
2025-03-09 09:15:38,989 [INFO]: 	>>> Finished "Compute fast metrics" in 18.8252 secs
2025-03-09 09:15:38,991 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 46.7668 secs
2025-03-09 09:15:38,991 [INFO]: {
2025-03-09 09:15:38,991 [INFO]: 	index_key: HNSW15
2025-03-09 09:15:38,991 [INFO]: 	index_param: efSearch=320
2025-03-09 09:15:38,991 [INFO]: 	index_path: knn.index
2025-03-09 09:15:38,991 [INFO]: 	size in bytes: 460774090
2025-03-09 09:15:38,991 [INFO]: 	avg_search_speed_ms: 10.537875811319143
2025-03-09 09:15:38,991 [INFO]: 	99p_search_speed_ms: 16.506365919485685
2025-03-09 09:15:38,991 [INFO]: 	reconstruction error %: 0.0
2025-03-09 09:15:38,991 [INFO]: 	nb vectors: 2342
2025-03-09 09:15:38,991 [INFO]: 	vectors dimension: 49152
2025-03-09 09:15:38,991 [INFO]: 	compression ratio: 0.9993095228075867
2025-03-09 09:15:38,992 [INFO]: }
2025-03-09 09:15:38,992 [INFO]: 	>>> Finished "Creating the index" in 46.7683 secs
2025-03-09 09:15:38,992 [INFO]: >>> Finished "Launching the whole pipeline" in 46.7957 secs
2025-03-09 09:15:39: [retrieval_preprocessing] calculating distances ...
2025-03-09 09:15:40: [retrieval_preprocessing] finished and saved retrieval indices for episode 16776 [episode count 5/20]
[retrieval_preprocessing] for episode 1545 [episode count 6/20], we have num_retrieval=np.int64(2323) num_query=np.int64(112)
2025-03-09 09:15:40,779 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-09 09:15:41,098 [INFO]: Launching the whole pipeline 03/09/2025, 09:15:41
2025-03-09 09:15:41,098 [INFO]: Reading total number of vectors and dimension 03/09/2025, 09:15:41
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 2242.94it/s]
2025-03-09 09:15:41,121 [INFO]: There are 2323 embeddings of dim 49152
2025-03-09 09:15:41,121 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0236 secs
2025-03-09 09:15:41,121 [INFO]: 	Compute estimated construction time of the index 03/09/2025, 09:15:41
2025-03-09 09:15:41,122 [INFO]: 		-> Train: 16.7 minutes
2025-03-09 09:15:41,122 [INFO]: 		-> Add: 1.3 seconds
2025-03-09 09:15:41,122 [INFO]: 		Total: 16.7 minutes
2025-03-09 09:15:41,122 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0001 secs
2025-03-09 09:15:41,122 [INFO]: 	Checking that your have enough memory available to create the index 03/09/2025, 09:15:41
2025-03-09 09:15:41,122 [INFO]: 479.4MB of memory will be needed to build the index (more might be used if you have more)
2025-03-09 09:15:41,122 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0002 secs
2025-03-09 09:15:41,122 [INFO]: 	Selecting most promising index types given data characteristics 03/09/2025, 09:15:41
2025-03-09 09:15:41,122 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-09 09:15:41,122 [INFO]: 	Creating the index 03/09/2025, 09:15:41
2025-03-09 09:15:41,122 [INFO]: 		-> Instanciate the index HNSW15 03/09/2025, 09:15:41
2025-03-09 09:15:41,123 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0009 secs
2025-03-09 09:15:41,123 [INFO]: 		-> Adding the vectors to the index 03/09/2025, 09:15:41
2025-03-09 09:15:41,123 [INFO]: The memory available for adding the vectors is 49.6GB(total available - used by the index)
2025-03-09 09:15:41,123 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/10 [00:00<?, ?it/s] 10%|█         | 1/10 [00:00<00:02,  4.37it/s] 20%|██        | 2/10 [00:00<00:01,  6.32it/s] 30%|███       | 3/10 [00:00<00:00,  7.23it/s] 40%|████      | 4/10 [00:00<00:00,  7.74it/s] 50%|█████     | 5/10 [00:00<00:00,  8.04it/s] 60%|██████    | 6/10 [00:00<00:00,  8.20it/s] 70%|███████   | 7/10 [00:00<00:00,  8.43it/s] 80%|████████  | 8/10 [00:01<00:00,  8.43it/s] 90%|█████████ | 9/10 [00:01<00:00,  8.39it/s]100%|██████████| 10/10 [00:02<00:00,  1.81it/s]100%|██████████| 10/10 [00:02<00:00,  3.74it/s]
2025-03-09 09:15:43,798 [INFO]: 	Computing best hyperparameters for index knn.index 03/09/2025, 09:15:43
2025-03-09 09:16:15,988 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 32.1897 secs
2025-03-09 09:16:15,988 [INFO]: The best hyperparameters are: efSearch=306
2025-03-09 09:16:15,988 [INFO]: 	Compute fast metrics 03/09/2025, 09:16:15
  0%|          | 0/4 [00:00<?, ?it/s] 25%|██▌       | 1/4 [00:00<00:00,  4.67it/s] 50%|█████     | 2/4 [00:00<00:00,  6.15it/s] 75%|███████▌  | 3/4 [00:00<00:00,  6.83it/s] 75%|███████▌  | 3/4 [00:00<00:00,  5.15it/s]
2025-03-09 09:16:33,850 [INFO]: 	>>> Finished "Compute fast metrics" in 17.8611 secs
2025-03-09 09:16:33,853 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 52.7301 secs
2025-03-09 09:16:33,853 [INFO]: {
2025-03-09 09:16:33,853 [INFO]: 	index_key: HNSW15
2025-03-09 09:16:33,853 [INFO]: 	index_param: efSearch=306
2025-03-09 09:16:33,853 [INFO]: 	index_path: knn.index
2025-03-09 09:16:33,853 [INFO]: 	size in bytes: 457036030
2025-03-09 09:16:33,853 [INFO]: 	avg_search_speed_ms: 10.807622512742137
2025-03-09 09:16:33,854 [INFO]: 	99p_search_speed_ms: 20.601088763214648
2025-03-09 09:16:33,854 [INFO]: 	reconstruction error %: 0.0
2025-03-09 09:16:33,854 [INFO]: 	nb vectors: 2323
2025-03-09 09:16:33,854 [INFO]: 	vectors dimension: 49152
2025-03-09 09:16:33,854 [INFO]: 	compression ratio: 0.9993093629839206
2025-03-09 09:16:33,854 [INFO]: }
2025-03-09 09:16:33,854 [INFO]: 	>>> Finished "Creating the index" in 52.7316 secs
2025-03-09 09:16:33,854 [INFO]: >>> Finished "Launching the whole pipeline" in 52.7558 secs
2025-03-09 09:16:34: [retrieval_preprocessing] calculating distances ...
2025-03-09 09:16:35: [retrieval_preprocessing] finished and saved retrieval indices for episode 1545 [episode count 6/20]
[retrieval_preprocessing] for episode 77578 [episode count 7/20], we have num_retrieval=np.int64(2311) num_query=np.int64(124)
2025-03-09 09:16:35,708 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-09 09:16:36,019 [INFO]: Launching the whole pipeline 03/09/2025, 09:16:36
2025-03-09 09:16:36,020 [INFO]: Reading total number of vectors and dimension 03/09/2025, 09:16:36
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1461.94it/s]
2025-03-09 09:16:36,047 [INFO]: There are 2311 embeddings of dim 49152
2025-03-09 09:16:36,047 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0276 secs
2025-03-09 09:16:36,047 [INFO]: 	Compute estimated construction time of the index 03/09/2025, 09:16:36
2025-03-09 09:16:36,047 [INFO]: 		-> Train: 16.7 minutes
2025-03-09 09:16:36,047 [INFO]: 		-> Add: 1.3 seconds
2025-03-09 09:16:36,047 [INFO]: 		Total: 16.7 minutes
2025-03-09 09:16:36,047 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0001 secs
2025-03-09 09:16:36,047 [INFO]: 	Checking that your have enough memory available to create the index 03/09/2025, 09:16:36
2025-03-09 09:16:36,048 [INFO]: 476.9MB of memory will be needed to build the index (more might be used if you have more)
2025-03-09 09:16:36,048 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0001 secs
2025-03-09 09:16:36,048 [INFO]: 	Selecting most promising index types given data characteristics 03/09/2025, 09:16:36
2025-03-09 09:16:36,048 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-09 09:16:36,048 [INFO]: 	Creating the index 03/09/2025, 09:16:36
2025-03-09 09:16:36,048 [INFO]: 		-> Instanciate the index HNSW15 03/09/2025, 09:16:36
2025-03-09 09:16:36,049 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0011 secs
2025-03-09 09:16:36,049 [INFO]: 		-> Adding the vectors to the index 03/09/2025, 09:16:36
2025-03-09 09:16:36,049 [INFO]: The memory available for adding the vectors is 49.6GB(total available - used by the index)
2025-03-09 09:16:36,049 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/10 [00:00<?, ?it/s] 10%|█         | 1/10 [00:00<00:01,  6.03it/s] 30%|███       | 3/10 [00:00<00:00, 10.08it/s] 50%|█████     | 5/10 [00:00<00:00, 11.18it/s] 70%|███████   | 7/10 [00:00<00:00, 11.74it/s] 90%|█████████ | 9/10 [00:00<00:00, 12.07it/s]100%|██████████| 10/10 [00:02<00:00,  4.56it/s]
2025-03-09 09:16:38,246 [INFO]: 	Computing best hyperparameters for index knn.index 03/09/2025, 09:16:38
2025-03-09 09:17:04,078 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 25.8321 secs
2025-03-09 09:17:04,078 [INFO]: The best hyperparameters are: efSearch=360
2025-03-09 09:17:04,078 [INFO]: 	Compute fast metrics 03/09/2025, 09:17:04
  0%|          | 0/4 [00:00<?, ?it/s] 25%|██▌       | 1/4 [00:00<00:00,  5.34it/s] 50%|█████     | 2/4 [00:00<00:00,  7.06it/s] 75%|███████▌  | 3/4 [00:00<00:00,  7.93it/s] 75%|███████▌  | 3/4 [00:00<00:00,  5.98it/s]
2025-03-09 09:17:24,015 [INFO]: 	>>> Finished "Compute fast metrics" in 19.9363 secs
2025-03-09 09:17:24,016 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 47.9673 secs
2025-03-09 09:17:24,016 [INFO]: {
2025-03-09 09:17:24,016 [INFO]: 	index_key: HNSW15
2025-03-09 09:17:24,016 [INFO]: 	index_param: efSearch=360
2025-03-09 09:17:24,016 [INFO]: 	index_path: knn.index
2025-03-09 09:17:24,016 [INFO]: 	size in bytes: 454675090
2025-03-09 09:17:24,016 [INFO]: 	avg_search_speed_ms: 11.352854788781194
2025-03-09 09:17:24,017 [INFO]: 	99p_search_speed_ms: 18.56551710516219
2025-03-09 09:17:24,017 [INFO]: 	reconstruction error %: 0.0
2025-03-09 09:17:24,017 [INFO]: 	nb vectors: 2311
2025-03-09 09:17:24,017 [INFO]: 	vectors dimension: 49152
2025-03-09 09:17:24,017 [INFO]: 	compression ratio: 0.9993093925598607
2025-03-09 09:17:24,017 [INFO]: }
2025-03-09 09:17:24,017 [INFO]: 	>>> Finished "Creating the index" in 47.9689 secs
2025-03-09 09:17:24,017 [INFO]: >>> Finished "Launching the whole pipeline" in 47.9970 secs
2025-03-09 09:17:25: [retrieval_preprocessing] calculating distances ...
2025-03-09 09:17:25: [retrieval_preprocessing] finished and saved retrieval indices for episode 77578 [episode count 7/20]
[retrieval_preprocessing] for episode 3851 [episode count 8/20], we have num_retrieval=np.int64(2256) num_query=np.int64(179)
2025-03-09 09:17:26,918 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-09 09:17:27,298 [INFO]: Launching the whole pipeline 03/09/2025, 09:17:27
2025-03-09 09:17:27,298 [INFO]: Reading total number of vectors and dimension 03/09/2025, 09:17:27
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1083.52it/s]
2025-03-09 09:17:27,322 [INFO]: There are 2256 embeddings of dim 49152
2025-03-09 09:17:27,322 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0240 secs
2025-03-09 09:17:27,322 [INFO]: 	Compute estimated construction time of the index 03/09/2025, 09:17:27
2025-03-09 09:17:27,322 [INFO]: 		-> Train: 16.7 minutes
2025-03-09 09:17:27,322 [INFO]: 		-> Add: 1.2 seconds
2025-03-09 09:17:27,322 [INFO]: 		Total: 16.7 minutes
2025-03-09 09:17:27,322 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0001 secs
2025-03-09 09:17:27,322 [INFO]: 	Checking that your have enough memory available to create the index 03/09/2025, 09:17:27
2025-03-09 09:17:27,322 [INFO]: 465.6MB of memory will be needed to build the index (more might be used if you have more)
2025-03-09 09:17:27,322 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0001 secs
2025-03-09 09:17:27,322 [INFO]: 	Selecting most promising index types given data characteristics 03/09/2025, 09:17:27
2025-03-09 09:17:27,322 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-09 09:17:27,322 [INFO]: 	Creating the index 03/09/2025, 09:17:27
2025-03-09 09:17:27,322 [INFO]: 		-> Instanciate the index HNSW15 03/09/2025, 09:17:27
2025-03-09 09:17:27,323 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0010 secs
2025-03-09 09:17:27,323 [INFO]: 		-> Adding the vectors to the index 03/09/2025, 09:17:27
2025-03-09 09:17:27,324 [INFO]: The memory available for adding the vectors is 49.6GB(total available - used by the index)
2025-03-09 09:17:27,324 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/9 [00:00<?, ?it/s] 11%|█         | 1/9 [00:00<00:01,  5.12it/s] 22%|██▏       | 2/9 [00:00<00:01,  6.50it/s] 33%|███▎      | 3/9 [00:00<00:00,  7.41it/s] 44%|████▍     | 4/9 [00:00<00:00,  7.82it/s] 56%|█████▌    | 5/9 [00:00<00:00,  8.08it/s] 67%|██████▋   | 6/9 [00:00<00:00,  8.23it/s] 78%|███████▊  | 7/9 [00:00<00:00,  8.35it/s] 89%|████████▉ | 8/9 [00:01<00:00,  8.45it/s]100%|██████████| 9/9 [00:02<00:00,  1.83it/s]100%|██████████| 9/9 [00:02<00:00,  3.59it/s]
2025-03-09 09:17:29,840 [INFO]: 	Computing best hyperparameters for index knn.index 03/09/2025, 09:17:29
2025-03-09 09:17:56,872 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 27.0319 secs
2025-03-09 09:17:56,872 [INFO]: The best hyperparameters are: efSearch=322
2025-03-09 09:17:56,872 [INFO]: 	Compute fast metrics 03/09/2025, 09:17:56
  0%|          | 0/4 [00:00<?, ?it/s] 25%|██▌       | 1/4 [00:00<00:00,  5.42it/s] 50%|█████     | 2/4 [00:00<00:00,  6.97it/s] 75%|███████▌  | 3/4 [00:00<00:00,  7.70it/s] 75%|███████▌  | 3/4 [00:00<00:00,  5.84it/s]
2025-03-09 09:18:11,962 [INFO]: 	>>> Finished "Compute fast metrics" in 15.0898 secs
2025-03-09 09:18:11,964 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 44.6400 secs
2025-03-09 09:18:11,964 [INFO]: {
2025-03-09 09:18:11,964 [INFO]: 	index_key: HNSW15
2025-03-09 09:18:11,964 [INFO]: 	index_param: efSearch=322
2025-03-09 09:18:11,964 [INFO]: 	index_path: knn.index
2025-03-09 09:18:11,964 [INFO]: 	size in bytes: 443854150
2025-03-09 09:18:11,964 [INFO]: 	avg_search_speed_ms: 10.657558040911836
2025-03-09 09:18:11,964 [INFO]: 	99p_search_speed_ms: 18.195841929409653
2025-03-09 09:18:11,964 [INFO]: 	reconstruction error %: 0.0
2025-03-09 09:18:11,964 [INFO]: 	nb vectors: 2256
2025-03-09 09:18:11,964 [INFO]: 	vectors dimension: 49152
2025-03-09 09:18:11,964 [INFO]: 	compression ratio: 0.9993094533418241
2025-03-09 09:18:11,964 [INFO]: }
2025-03-09 09:18:11,964 [INFO]: 	>>> Finished "Creating the index" in 44.6415 secs
2025-03-09 09:18:11,964 [INFO]: >>> Finished "Launching the whole pipeline" in 44.6660 secs
2025-03-09 09:18:13: [retrieval_preprocessing] calculating distances ...
2025-03-09 09:18:13: [retrieval_preprocessing] finished and saved retrieval indices for episode 3851 [episode count 8/20]
[retrieval_preprocessing] for episode 80784 [episode count 9/20], we have num_retrieval=np.int64(2326) num_query=np.int64(109)
2025-03-09 09:18:14,173 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-09 09:18:14,476 [INFO]: Launching the whole pipeline 03/09/2025, 09:18:14
2025-03-09 09:18:14,476 [INFO]: Reading total number of vectors and dimension 03/09/2025, 09:18:14
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1348.22it/s]
2025-03-09 09:18:14,515 [INFO]: There are 2326 embeddings of dim 49152
2025-03-09 09:18:14,515 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0386 secs
2025-03-09 09:18:14,515 [INFO]: 	Compute estimated construction time of the index 03/09/2025, 09:18:14
2025-03-09 09:18:14,515 [INFO]: 		-> Train: 16.7 minutes
2025-03-09 09:18:14,515 [INFO]: 		-> Add: 1.3 seconds
2025-03-09 09:18:14,515 [INFO]: 		Total: 16.7 minutes
2025-03-09 09:18:14,516 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0003 secs
2025-03-09 09:18:14,516 [INFO]: 	Checking that your have enough memory available to create the index 03/09/2025, 09:18:14
2025-03-09 09:18:14,516 [INFO]: 480.0MB of memory will be needed to build the index (more might be used if you have more)
2025-03-09 09:18:14,516 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0003 secs
2025-03-09 09:18:14,516 [INFO]: 	Selecting most promising index types given data characteristics 03/09/2025, 09:18:14
2025-03-09 09:18:14,516 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-09 09:18:14,516 [INFO]: 	Creating the index 03/09/2025, 09:18:14
2025-03-09 09:18:14,516 [INFO]: 		-> Instanciate the index HNSW15 03/09/2025, 09:18:14
2025-03-09 09:18:14,519 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0025 secs
2025-03-09 09:18:14,519 [INFO]: 		-> Adding the vectors to the index 03/09/2025, 09:18:14
2025-03-09 09:18:14,519 [INFO]: The memory available for adding the vectors is 49.6GB(total available - used by the index)
2025-03-09 09:18:14,519 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/10 [00:00<?, ?it/s] 10%|█         | 1/10 [00:00<00:01,  5.79it/s] 30%|███       | 3/10 [00:00<00:00,  9.37it/s] 50%|█████     | 5/10 [00:00<00:00, 10.53it/s] 70%|███████   | 7/10 [00:00<00:00, 11.05it/s] 90%|█████████ | 9/10 [00:00<00:00, 11.33it/s]100%|██████████| 10/10 [00:02<00:00,  3.96it/s]
2025-03-09 09:18:17,048 [INFO]: 	Computing best hyperparameters for index knn.index 03/09/2025, 09:18:17
2025-03-09 09:18:46,279 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 29.2309 secs
2025-03-09 09:18:46,279 [INFO]: The best hyperparameters are: efSearch=291
2025-03-09 09:18:46,279 [INFO]: 	Compute fast metrics 03/09/2025, 09:18:46
  0%|          | 0/4 [00:00<?, ?it/s] 25%|██▌       | 1/4 [00:00<00:00,  6.28it/s] 75%|███████▌  | 3/4 [00:00<00:00,  9.56it/s] 75%|███████▌  | 3/4 [00:00<00:00,  7.23it/s]
2025-03-09 09:19:01,207 [INFO]: 	>>> Finished "Compute fast metrics" in 14.9273 secs
2025-03-09 09:19:01,209 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 46.6894 secs
2025-03-09 09:19:01,209 [INFO]: {
2025-03-09 09:19:01,209 [INFO]: 	index_key: HNSW15
2025-03-09 09:19:01,209 [INFO]: 	index_param: efSearch=291
2025-03-09 09:19:01,209 [INFO]: 	index_path: knn.index
2025-03-09 09:19:01,209 [INFO]: 	size in bytes: 457626250
2025-03-09 09:19:01,209 [INFO]: 	avg_search_speed_ms: 10.760643244525507
2025-03-09 09:19:01,209 [INFO]: 	99p_search_speed_ms: 16.958591649308804
2025-03-09 09:19:01,209 [INFO]: 	reconstruction error %: 0.0
2025-03-09 09:19:01,209 [INFO]: 	nb vectors: 2326
2025-03-09 09:19:01,209 [INFO]: 	vectors dimension: 49152
2025-03-09 09:19:01,209 [INFO]: 	compression ratio: 0.9993093883928206
2025-03-09 09:19:01,209 [INFO]: }
2025-03-09 09:19:01,209 [INFO]: 	>>> Finished "Creating the index" in 46.6928 secs
2025-03-09 09:19:01,209 [INFO]: >>> Finished "Launching the whole pipeline" in 46.7328 secs
2025-03-09 09:19:02: [retrieval_preprocessing] calculating distances ...
2025-03-09 09:19:02: [retrieval_preprocessing] finished and saved retrieval indices for episode 80784 [episode count 9/20]
[retrieval_preprocessing] for episode 8593 [episode count 10/20], we have num_retrieval=np.int64(2321) num_query=np.int64(114)
2025-03-09 09:19:02,984 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-09 09:19:03,334 [INFO]: Launching the whole pipeline 03/09/2025, 09:19:03
2025-03-09 09:19:03,334 [INFO]: Reading total number of vectors and dimension 03/09/2025, 09:19:03
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1314.83it/s]
2025-03-09 09:19:03,364 [INFO]: There are 2321 embeddings of dim 49152
2025-03-09 09:19:03,365 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0302 secs
2025-03-09 09:19:03,365 [INFO]: 	Compute estimated construction time of the index 03/09/2025, 09:19:03
2025-03-09 09:19:03,365 [INFO]: 		-> Train: 16.7 minutes
2025-03-09 09:19:03,365 [INFO]: 		-> Add: 1.3 seconds
2025-03-09 09:19:03,365 [INFO]: 		Total: 16.7 minutes
2025-03-09 09:19:03,365 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0003 secs
2025-03-09 09:19:03,365 [INFO]: 	Checking that your have enough memory available to create the index 03/09/2025, 09:19:03
2025-03-09 09:19:03,365 [INFO]: 479.0MB of memory will be needed to build the index (more might be used if you have more)
2025-03-09 09:19:03,366 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0004 secs
2025-03-09 09:19:03,366 [INFO]: 	Selecting most promising index types given data characteristics 03/09/2025, 09:19:03
2025-03-09 09:19:03,366 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-09 09:19:03,366 [INFO]: 	Creating the index 03/09/2025, 09:19:03
2025-03-09 09:19:03,366 [INFO]: 		-> Instanciate the index HNSW15 03/09/2025, 09:19:03
2025-03-09 09:19:03,369 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0029 secs
2025-03-09 09:19:03,370 [INFO]: 		-> Adding the vectors to the index 03/09/2025, 09:19:03
2025-03-09 09:19:03,370 [INFO]: The memory available for adding the vectors is 49.6GB(total available - used by the index)
2025-03-09 09:19:03,370 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/10 [00:00<?, ?it/s] 20%|██        | 2/10 [00:00<00:00, 18.91it/s] 80%|████████  | 8/10 [00:00<00:00, 40.70it/s]100%|██████████| 10/10 [00:01<00:00,  5.52it/s]
2025-03-09 09:19:05,187 [INFO]: 	Computing best hyperparameters for index knn.index 03/09/2025, 09:19:05
2025-03-09 09:19:34,392 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 29.2047 secs
2025-03-09 09:19:34,393 [INFO]: The best hyperparameters are: efSearch=247
2025-03-09 09:19:34,393 [INFO]: 	Compute fast metrics 03/09/2025, 09:19:34
  0%|          | 0/4 [00:00<?, ?it/s] 25%|██▌       | 1/4 [00:00<00:00,  5.15it/s] 50%|█████     | 2/4 [00:00<00:00,  6.76it/s] 75%|███████▌  | 3/4 [00:00<00:00,  7.65it/s] 75%|███████▌  | 3/4 [00:00<00:00,  5.68it/s]
2025-03-09 09:19:50,165 [INFO]: 	>>> Finished "Compute fast metrics" in 15.7723 secs
2025-03-09 09:19:50,167 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 46.7976 secs
2025-03-09 09:19:50,168 [INFO]: {
2025-03-09 09:19:50,168 [INFO]: 	index_key: HNSW15
2025-03-09 09:19:50,168 [INFO]: 	index_param: efSearch=247
2025-03-09 09:19:50,168 [INFO]: 	index_path: knn.index
2025-03-09 09:19:50,168 [INFO]: 	size in bytes: 456642550
2025-03-09 09:19:50,168 [INFO]: 	avg_search_speed_ms: 10.316494644943422
2025-03-09 09:19:50,168 [INFO]: 	99p_search_speed_ms: 17.62451449409119
2025-03-09 09:19:50,168 [INFO]: 	reconstruction error %: 0.0
2025-03-09 09:19:50,168 [INFO]: 	nb vectors: 2321
2025-03-09 09:19:50,168 [INFO]: 	vectors dimension: 49152
2025-03-09 09:19:50,168 [INFO]: 	compression ratio: 0.9993093460081632
2025-03-09 09:19:50,168 [INFO]: }
2025-03-09 09:19:50,168 [INFO]: 	>>> Finished "Creating the index" in 46.8022 secs
2025-03-09 09:19:50,168 [INFO]: >>> Finished "Launching the whole pipeline" in 46.8340 secs
2025-03-09 09:19:51: [retrieval_preprocessing] calculating distances ...
2025-03-09 09:19:51: [retrieval_preprocessing] finished and saved retrieval indices for episode 8593 [episode count 10/20]
[retrieval_preprocessing] for episode 34965 [episode count 11/20], we have num_retrieval=np.int64(2307) num_query=np.int64(128)
2025-03-09 09:19:52,495 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-09 09:19:52,944 [INFO]: Launching the whole pipeline 03/09/2025, 09:19:52
2025-03-09 09:19:52,944 [INFO]: Reading total number of vectors and dimension 03/09/2025, 09:19:52
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1167.03it/s]
2025-03-09 09:19:52,974 [INFO]: There are 2307 embeddings of dim 49152
2025-03-09 09:19:52,975 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0312 secs
2025-03-09 09:19:52,975 [INFO]: 	Compute estimated construction time of the index 03/09/2025, 09:19:52
2025-03-09 09:19:52,975 [INFO]: 		-> Train: 16.7 minutes
2025-03-09 09:19:52,976 [INFO]: 		-> Add: 1.3 seconds
2025-03-09 09:19:52,976 [INFO]: 		Total: 16.7 minutes
2025-03-09 09:19:52,976 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0005 secs
2025-03-09 09:19:52,976 [INFO]: 	Checking that your have enough memory available to create the index 03/09/2025, 09:19:52
2025-03-09 09:19:52,976 [INFO]: 476.1MB of memory will be needed to build the index (more might be used if you have more)
2025-03-09 09:19:52,976 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0005 secs
2025-03-09 09:19:52,977 [INFO]: 	Selecting most promising index types given data characteristics 03/09/2025, 09:19:52
2025-03-09 09:19:52,977 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-09 09:19:52,977 [INFO]: 	Creating the index 03/09/2025, 09:19:52
2025-03-09 09:19:52,977 [INFO]: 		-> Instanciate the index HNSW15 03/09/2025, 09:19:52
2025-03-09 09:19:52,980 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0033 secs
2025-03-09 09:19:52,981 [INFO]: 		-> Adding the vectors to the index 03/09/2025, 09:19:52
2025-03-09 09:19:52,981 [INFO]: The memory available for adding the vectors is 49.6GB(total available - used by the index)
2025-03-09 09:19:52,981 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/10 [00:00<?, ?it/s] 10%|█         | 1/10 [00:00<00:01,  5.54it/s] 20%|██        | 2/10 [00:00<00:01,  7.15it/s] 30%|███       | 3/10 [00:00<00:00,  7.86it/s] 40%|████      | 4/10 [00:00<00:00,  8.23it/s] 50%|█████     | 5/10 [00:00<00:00,  8.33it/s] 60%|██████    | 6/10 [00:00<00:00,  8.26it/s] 70%|███████   | 7/10 [00:00<00:00,  8.19it/s] 80%|████████  | 8/10 [00:01<00:00,  8.13it/s] 90%|█████████ | 9/10 [00:01<00:00,  8.02it/s]100%|██████████| 10/10 [00:03<00:00,  1.47it/s]100%|██████████| 10/10 [00:03<00:00,  3.26it/s]
2025-03-09 09:19:56,053 [INFO]: 	Computing best hyperparameters for index knn.index 03/09/2025, 09:19:56
2025-03-09 09:20:24,181 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 28.1275 secs
2025-03-09 09:20:24,181 [INFO]: The best hyperparameters are: efSearch=286
2025-03-09 09:20:24,181 [INFO]: 	Compute fast metrics 03/09/2025, 09:20:24
  0%|          | 0/4 [00:00<?, ?it/s] 25%|██▌       | 1/4 [00:00<00:00,  6.37it/s] 75%|███████▌  | 3/4 [00:00<00:00, 10.25it/s] 75%|███████▌  | 3/4 [00:00<00:00,  7.82it/s]
2025-03-09 09:20:41,016 [INFO]: 	>>> Finished "Compute fast metrics" in 16.8350 secs
2025-03-09 09:20:41,018 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 48.0372 secs
2025-03-09 09:20:41,018 [INFO]: {
2025-03-09 09:20:41,018 [INFO]: 	index_key: HNSW15
2025-03-09 09:20:41,018 [INFO]: 	index_param: efSearch=286
2025-03-09 09:20:41,018 [INFO]: 	index_path: knn.index
2025-03-09 09:20:41,018 [INFO]: 	size in bytes: 453888070
2025-03-09 09:20:41,018 [INFO]: 	avg_search_speed_ms: 9.959246437770288
2025-03-09 09:20:41,018 [INFO]: 	99p_search_speed_ms: 17.815709174610674
2025-03-09 09:20:41,018 [INFO]: 	reconstruction error %: 0.0
2025-03-09 09:20:41,018 [INFO]: 	nb vectors: 2307
2025-03-09 09:20:41,018 [INFO]: 	vectors dimension: 49152
2025-03-09 09:20:41,018 [INFO]: 	compression ratio: 0.999309490553475
2025-03-09 09:20:41,018 [INFO]: }
2025-03-09 09:20:41,018 [INFO]: 	>>> Finished "Creating the index" in 48.0415 secs
2025-03-09 09:20:41,018 [INFO]: >>> Finished "Launching the whole pipeline" in 48.0747 secs
2025-03-09 09:20:41: [retrieval_preprocessing] calculating distances ...
2025-03-09 09:20:42: [retrieval_preprocessing] finished and saved retrieval indices for episode 34965 [episode count 11/20]
[retrieval_preprocessing] for episode 83222 [episode count 12/20], we have num_retrieval=np.int64(2312) num_query=np.int64(123)
2025-03-09 09:20:43,040 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-09 09:20:43,423 [INFO]: Launching the whole pipeline 03/09/2025, 09:20:43
2025-03-09 09:20:43,423 [INFO]: Reading total number of vectors and dimension 03/09/2025, 09:20:43
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00,  1.41it/s]100%|██████████| 1/1 [00:00<00:00,  1.41it/s]
2025-03-09 09:20:44,162 [INFO]: There are 2312 embeddings of dim 49152
2025-03-09 09:20:44,162 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.7390 secs
2025-03-09 09:20:44,162 [INFO]: 	Compute estimated construction time of the index 03/09/2025, 09:20:44
2025-03-09 09:20:44,163 [INFO]: 		-> Train: 16.7 minutes
2025-03-09 09:20:44,163 [INFO]: 		-> Add: 1.3 seconds
2025-03-09 09:20:44,163 [INFO]: 		Total: 16.7 minutes
2025-03-09 09:20:44,163 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0006 secs
2025-03-09 09:20:44,163 [INFO]: 	Checking that your have enough memory available to create the index 03/09/2025, 09:20:44
2025-03-09 09:20:44,163 [INFO]: 477.1MB of memory will be needed to build the index (more might be used if you have more)
2025-03-09 09:20:44,164 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0005 secs
2025-03-09 09:20:44,164 [INFO]: 	Selecting most promising index types given data characteristics 03/09/2025, 09:20:44
2025-03-09 09:20:44,164 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-09 09:20:44,164 [INFO]: 	Creating the index 03/09/2025, 09:20:44
2025-03-09 09:20:44,164 [INFO]: 		-> Instanciate the index HNSW15 03/09/2025, 09:20:44
2025-03-09 09:20:44,167 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0028 secs
2025-03-09 09:20:44,167 [INFO]: 		-> Adding the vectors to the index 03/09/2025, 09:20:44
2025-03-09 09:20:44,167 [INFO]: The memory available for adding the vectors is 49.6GB(total available - used by the index)
2025-03-09 09:20:44,168 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/10 [00:00<?, ?it/s] 10%|█         | 1/10 [00:00<00:01,  6.75it/s] 30%|███       | 3/10 [00:00<00:00, 10.38it/s] 50%|█████     | 5/10 [00:00<00:00, 11.37it/s] 70%|███████   | 7/10 [00:00<00:00, 11.87it/s] 90%|█████████ | 9/10 [00:00<00:00, 12.06it/s]100%|██████████| 10/10 [00:02<00:00,  4.13it/s]
2025-03-09 09:20:46,592 [INFO]: 	Computing best hyperparameters for index knn.index 03/09/2025, 09:20:46
2025-03-09 09:21:14,229 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 27.6364 secs
2025-03-09 09:21:14,229 [INFO]: The best hyperparameters are: efSearch=313
2025-03-09 09:21:14,229 [INFO]: 	Compute fast metrics 03/09/2025, 09:21:14
  0%|          | 0/4 [00:00<?, ?it/s] 25%|██▌       | 1/4 [00:00<00:00,  5.84it/s] 75%|███████▌  | 3/4 [00:00<00:00,  9.40it/s] 75%|███████▌  | 3/4 [00:00<00:00,  7.51it/s]
2025-03-09 09:21:28,525 [INFO]: 	>>> Finished "Compute fast metrics" in 14.2957 secs
2025-03-09 09:21:28,527 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 44.3594 secs
2025-03-09 09:21:28,527 [INFO]: {
2025-03-09 09:21:28,527 [INFO]: 	index_key: HNSW15
2025-03-09 09:21:28,527 [INFO]: 	index_param: efSearch=313
2025-03-09 09:21:28,527 [INFO]: 	index_path: knn.index
2025-03-09 09:21:28,527 [INFO]: 	size in bytes: 454871830
2025-03-09 09:21:28,527 [INFO]: 	avg_search_speed_ms: 10.935363837370211
2025-03-09 09:21:28,527 [INFO]: 	99p_search_speed_ms: 20.671544284559786
2025-03-09 09:21:28,527 [INFO]: 	reconstruction error %: 0.0
2025-03-09 09:21:28,527 [INFO]: 	nb vectors: 2312
2025-03-09 09:21:28,527 [INFO]: 	vectors dimension: 49152
2025-03-09 09:21:28,527 [INFO]: 	compression ratio: 0.9993094010679887
2025-03-09 09:21:28,527 [INFO]: }
2025-03-09 09:21:28,527 [INFO]: 	>>> Finished "Creating the index" in 44.3630 secs
2025-03-09 09:21:28,527 [INFO]: >>> Finished "Launching the whole pipeline" in 45.1039 secs
2025-03-09 09:21:29: [retrieval_preprocessing] calculating distances ...
2025-03-09 09:21:30: [retrieval_preprocessing] finished and saved retrieval indices for episode 83222 [episode count 12/20]
[retrieval_preprocessing] for episode 94231 [episode count 13/20], we have num_retrieval=np.int64(2329) num_query=np.int64(106)
2025-03-09 09:21:30,910 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-09 09:21:31,232 [INFO]: Launching the whole pipeline 03/09/2025, 09:21:31
2025-03-09 09:21:31,232 [INFO]: Reading total number of vectors and dimension 03/09/2025, 09:21:31
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 2385.84it/s]
2025-03-09 09:21:31,255 [INFO]: There are 2329 embeddings of dim 49152
2025-03-09 09:21:31,255 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0230 secs
2025-03-09 09:21:31,255 [INFO]: 	Compute estimated construction time of the index 03/09/2025, 09:21:31
2025-03-09 09:21:31,255 [INFO]: 		-> Train: 16.7 minutes
2025-03-09 09:21:31,255 [INFO]: 		-> Add: 1.3 seconds
2025-03-09 09:21:31,255 [INFO]: 		Total: 16.7 minutes
2025-03-09 09:21:31,255 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0001 secs
2025-03-09 09:21:31,255 [INFO]: 	Checking that your have enough memory available to create the index 03/09/2025, 09:21:31
2025-03-09 09:21:31,256 [INFO]: 480.6MB of memory will be needed to build the index (more might be used if you have more)
2025-03-09 09:21:31,256 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0001 secs
2025-03-09 09:21:31,256 [INFO]: 	Selecting most promising index types given data characteristics 03/09/2025, 09:21:31
2025-03-09 09:21:31,256 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-09 09:21:31,256 [INFO]: 	Creating the index 03/09/2025, 09:21:31
2025-03-09 09:21:31,256 [INFO]: 		-> Instanciate the index HNSW15 03/09/2025, 09:21:31
2025-03-09 09:21:31,257 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0008 secs
2025-03-09 09:21:31,257 [INFO]: 		-> Adding the vectors to the index 03/09/2025, 09:21:31
2025-03-09 09:21:31,257 [INFO]: The memory available for adding the vectors is 49.6GB(total available - used by the index)
2025-03-09 09:21:31,257 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/10 [00:00<?, ?it/s] 10%|█         | 1/10 [00:00<00:01,  5.42it/s] 20%|██        | 2/10 [00:00<00:01,  6.98it/s] 30%|███       | 3/10 [00:00<00:00,  7.66it/s] 40%|████      | 4/10 [00:00<00:00,  8.17it/s] 50%|█████     | 5/10 [00:00<00:00,  8.36it/s] 60%|██████    | 6/10 [00:00<00:00,  8.51it/s] 70%|███████   | 7/10 [00:00<00:00,  8.55it/s] 80%|████████  | 8/10 [00:00<00:00,  8.68it/s]100%|██████████| 10/10 [00:02<00:00,  2.07it/s]100%|██████████| 10/10 [00:02<00:00,  3.62it/s]
2025-03-09 09:21:34,021 [INFO]: 	Computing best hyperparameters for index knn.index 03/09/2025, 09:21:34
2025-03-09 09:21:59,883 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 25.8621 secs
2025-03-09 09:21:59,884 [INFO]: The best hyperparameters are: efSearch=290
2025-03-09 09:21:59,884 [INFO]: 	Compute fast metrics 03/09/2025, 09:21:59
  0%|          | 0/4 [00:00<?, ?it/s] 25%|██▌       | 1/4 [00:00<00:00,  5.28it/s] 75%|███████▌  | 3/4 [00:00<00:00,  9.96it/s] 75%|███████▌  | 3/4 [00:00<00:00,  7.77it/s]
2025-03-09 09:22:16,975 [INFO]: 	>>> Finished "Compute fast metrics" in 17.0908 secs
2025-03-09 09:22:16,977 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 45.7199 secs
2025-03-09 09:22:16,977 [INFO]: {
2025-03-09 09:22:16,977 [INFO]: 	index_key: HNSW15
2025-03-09 09:22:16,977 [INFO]: 	index_param: efSearch=290
2025-03-09 09:22:16,977 [INFO]: 	index_path: knn.index
2025-03-09 09:22:16,977 [INFO]: 	size in bytes: 458216470
2025-03-09 09:22:16,977 [INFO]: 	avg_search_speed_ms: 9.718566905549638
2025-03-09 09:22:16,977 [INFO]: 	99p_search_speed_ms: 16.907353308051825
2025-03-09 09:22:16,977 [INFO]: 	reconstruction error %: 0.0
2025-03-09 09:22:16,977 [INFO]: 	nb vectors: 2329
2025-03-09 09:22:16,977 [INFO]: 	vectors dimension: 49152
2025-03-09 09:22:16,977 [INFO]: 	compression ratio: 0.9993094137362631
2025-03-09 09:22:16,977 [INFO]: }
2025-03-09 09:22:16,977 [INFO]: 	>>> Finished "Creating the index" in 45.7211 secs
2025-03-09 09:22:16,977 [INFO]: >>> Finished "Launching the whole pipeline" in 45.7446 secs
2025-03-09 09:22:19: [retrieval_preprocessing] calculating distances ...
2025-03-09 09:22:20: [retrieval_preprocessing] finished and saved retrieval indices for episode 94231 [episode count 13/20]
[retrieval_preprocessing] for episode 5656 [episode count 14/20], we have num_retrieval=np.int64(2331) num_query=np.int64(104)
2025-03-09 09:22:20,817 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-09 09:22:21,145 [INFO]: Launching the whole pipeline 03/09/2025, 09:22:21
2025-03-09 09:22:21,145 [INFO]: Reading total number of vectors and dimension 03/09/2025, 09:22:21
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1525.76it/s]
2025-03-09 09:22:21,168 [INFO]: There are 2331 embeddings of dim 49152
2025-03-09 09:22:21,168 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0229 secs
2025-03-09 09:22:21,168 [INFO]: 	Compute estimated construction time of the index 03/09/2025, 09:22:21
2025-03-09 09:22:21,168 [INFO]: 		-> Train: 16.7 minutes
2025-03-09 09:22:21,168 [INFO]: 		-> Add: 1.3 seconds
2025-03-09 09:22:21,168 [INFO]: 		Total: 16.7 minutes
2025-03-09 09:22:21,168 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0001 secs
2025-03-09 09:22:21,169 [INFO]: 	Checking that your have enough memory available to create the index 03/09/2025, 09:22:21
2025-03-09 09:22:21,169 [INFO]: 481.1MB of memory will be needed to build the index (more might be used if you have more)
2025-03-09 09:22:21,169 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0001 secs
2025-03-09 09:22:21,169 [INFO]: 	Selecting most promising index types given data characteristics 03/09/2025, 09:22:21
2025-03-09 09:22:21,169 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-09 09:22:21,169 [INFO]: 	Creating the index 03/09/2025, 09:22:21
2025-03-09 09:22:21,169 [INFO]: 		-> Instanciate the index HNSW15 03/09/2025, 09:22:21
2025-03-09 09:22:21,170 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0010 secs
2025-03-09 09:22:21,170 [INFO]: 		-> Adding the vectors to the index 03/09/2025, 09:22:21
2025-03-09 09:22:21,170 [INFO]: The memory available for adding the vectors is 49.6GB(total available - used by the index)
2025-03-09 09:22:21,170 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/10 [00:00<?, ?it/s] 10%|█         | 1/10 [00:00<00:01,  4.76it/s] 20%|██        | 2/10 [00:00<00:01,  6.34it/s] 30%|███       | 3/10 [00:00<00:00,  7.09it/s] 40%|████      | 4/10 [00:00<00:00,  7.44it/s] 50%|█████     | 5/10 [00:00<00:00,  7.61it/s] 60%|██████    | 6/10 [00:00<00:00,  7.78it/s] 70%|███████   | 7/10 [00:00<00:00,  7.93it/s] 90%|█████████ | 9/10 [00:01<00:00,  9.53it/s]100%|██████████| 10/10 [00:02<00:00,  2.11it/s]100%|██████████| 10/10 [00:02<00:00,  3.77it/s]
2025-03-09 09:22:23,826 [INFO]: 	Computing best hyperparameters for index knn.index 03/09/2025, 09:22:23
2025-03-09 09:22:56,338 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 32.5121 secs
2025-03-09 09:22:56,338 [INFO]: The best hyperparameters are: efSearch=285
2025-03-09 09:22:56,338 [INFO]: 	Compute fast metrics 03/09/2025, 09:22:56
  0%|          | 0/4 [00:00<?, ?it/s] 25%|██▌       | 1/4 [00:00<00:00,  5.49it/s] 50%|█████     | 2/4 [00:00<00:00,  7.11it/s] 75%|███████▌  | 3/4 [00:00<00:00,  7.77it/s] 75%|███████▌  | 3/4 [00:00<00:00,  5.85it/s]
2025-03-09 09:23:11,839 [INFO]: 	>>> Finished "Compute fast metrics" in 15.5007 secs
2025-03-09 09:23:11,841 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 50.6710 secs
2025-03-09 09:23:11,841 [INFO]: {
2025-03-09 09:23:11,841 [INFO]: 	index_key: HNSW15
2025-03-09 09:23:11,841 [INFO]: 	index_param: efSearch=285
2025-03-09 09:23:11,841 [INFO]: 	index_path: knn.index
2025-03-09 09:23:11,841 [INFO]: 	size in bytes: 458609950
2025-03-09 09:23:11,841 [INFO]: 	avg_search_speed_ms: 9.843151280784788
2025-03-09 09:23:11,841 [INFO]: 	99p_search_speed_ms: 15.253962029237302
2025-03-09 09:23:11,841 [INFO]: 	reconstruction error %: 0.0
2025-03-09 09:23:11,841 [INFO]: 	nb vectors: 2331
2025-03-09 09:23:11,841 [INFO]: 	vectors dimension: 49152
2025-03-09 09:23:11,841 [INFO]: 	compression ratio: 0.999309430595651
2025-03-09 09:23:11,841 [INFO]: }
2025-03-09 09:23:11,841 [INFO]: 	>>> Finished "Creating the index" in 50.6724 secs
2025-03-09 09:23:11,841 [INFO]: >>> Finished "Launching the whole pipeline" in 50.6959 secs
2025-03-09 09:23:12: [retrieval_preprocessing] calculating distances ...
2025-03-09 09:23:12: [retrieval_preprocessing] finished and saved retrieval indices for episode 5656 [episode count 14/20]
[retrieval_preprocessing] for episode 69276 [episode count 15/20], we have num_retrieval=np.int64(2283) num_query=np.int64(152)
2025-03-09 09:23:13,383 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-09 09:23:14,007 [INFO]: Launching the whole pipeline 03/09/2025, 09:23:14
2025-03-09 09:23:14,007 [INFO]: Reading total number of vectors and dimension 03/09/2025, 09:23:14
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1541.46it/s]
2025-03-09 09:23:14,032 [INFO]: There are 2283 embeddings of dim 49152
2025-03-09 09:23:14,032 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0248 secs
2025-03-09 09:23:14,032 [INFO]: 	Compute estimated construction time of the index 03/09/2025, 09:23:14
2025-03-09 09:23:14,032 [INFO]: 		-> Train: 16.7 minutes
2025-03-09 09:23:14,032 [INFO]: 		-> Add: 1.3 seconds
2025-03-09 09:23:14,032 [INFO]: 		Total: 16.7 minutes
2025-03-09 09:23:14,032 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0001 secs
2025-03-09 09:23:14,032 [INFO]: 	Checking that your have enough memory available to create the index 03/09/2025, 09:23:14
2025-03-09 09:23:14,032 [INFO]: 471.2MB of memory will be needed to build the index (more might be used if you have more)
2025-03-09 09:23:14,033 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0001 secs
2025-03-09 09:23:14,033 [INFO]: 	Selecting most promising index types given data characteristics 03/09/2025, 09:23:14
2025-03-09 09:23:14,033 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-09 09:23:14,033 [INFO]: 	Creating the index 03/09/2025, 09:23:14
2025-03-09 09:23:14,033 [INFO]: 		-> Instanciate the index HNSW15 03/09/2025, 09:23:14
2025-03-09 09:23:14,034 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0011 secs
2025-03-09 09:23:14,034 [INFO]: 		-> Adding the vectors to the index 03/09/2025, 09:23:14
2025-03-09 09:23:14,034 [INFO]: The memory available for adding the vectors is 49.6GB(total available - used by the index)
2025-03-09 09:23:14,034 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/9 [00:00<?, ?it/s] 11%|█         | 1/9 [00:00<00:01,  6.24it/s] 33%|███▎      | 3/9 [00:00<00:00,  9.99it/s] 56%|█████▌    | 5/9 [00:00<00:00, 11.32it/s] 78%|███████▊  | 7/9 [00:00<00:00, 12.10it/s]100%|██████████| 9/9 [00:02<00:00,  2.93it/s]100%|██████████| 9/9 [00:02<00:00,  4.16it/s]
2025-03-09 09:23:16,207 [INFO]: 	Computing best hyperparameters for index knn.index 03/09/2025, 09:23:16
2025-03-09 09:23:39,848 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 23.6411 secs
2025-03-09 09:23:39,849 [INFO]: The best hyperparameters are: efSearch=296
2025-03-09 09:23:39,849 [INFO]: 	Compute fast metrics 03/09/2025, 09:23:39
  0%|          | 0/4 [00:00<?, ?it/s] 25%|██▌       | 1/4 [00:00<00:00,  5.79it/s] 75%|███████▌  | 3/4 [00:00<00:00,  9.72it/s] 75%|███████▌  | 3/4 [00:00<00:00,  7.41it/s]
2025-03-09 09:23:55,384 [INFO]: 	>>> Finished "Compute fast metrics" in 15.5348 secs
2025-03-09 09:23:55,717 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 41.6835 secs
2025-03-09 09:23:55,718 [INFO]: {
2025-03-09 09:23:55,718 [INFO]: 	index_key: HNSW15
2025-03-09 09:23:55,718 [INFO]: 	index_param: efSearch=296
2025-03-09 09:23:55,718 [INFO]: 	index_path: knn.index
2025-03-09 09:23:55,718 [INFO]: 	size in bytes: 449166190
2025-03-09 09:23:55,718 [INFO]: 	avg_search_speed_ms: 10.157002631083207
2025-03-09 09:23:55,718 [INFO]: 	99p_search_speed_ms: 17.208886649459586
2025-03-09 09:23:55,718 [INFO]: 	reconstruction error %: 0.0
2025-03-09 09:23:55,718 [INFO]: 	nb vectors: 2283
2025-03-09 09:23:55,718 [INFO]: 	vectors dimension: 49152
2025-03-09 09:23:55,718 [INFO]: 	compression ratio: 0.9993095517719176
2025-03-09 09:23:55,718 [INFO]: }
2025-03-09 09:23:55,718 [INFO]: 	>>> Finished "Creating the index" in 41.6857 secs
2025-03-09 09:23:55,718 [INFO]: >>> Finished "Launching the whole pipeline" in 41.7112 secs
2025-03-09 09:23:56: [retrieval_preprocessing] calculating distances ...
2025-03-09 09:23:57: [retrieval_preprocessing] finished and saved retrieval indices for episode 69276 [episode count 15/20]
[retrieval_preprocessing] for episode 27295 [episode count 16/20], we have num_retrieval=np.int64(2287) num_query=np.int64(148)
2025-03-09 09:23:58,292 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-09 09:23:58,662 [INFO]: Launching the whole pipeline 03/09/2025, 09:23:58
2025-03-09 09:23:58,662 [INFO]: Reading total number of vectors and dimension 03/09/2025, 09:23:58
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1798.59it/s]
2025-03-09 09:23:58,687 [INFO]: There are 2287 embeddings of dim 49152
2025-03-09 09:23:58,687 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0249 secs
2025-03-09 09:23:58,687 [INFO]: 	Compute estimated construction time of the index 03/09/2025, 09:23:58
2025-03-09 09:23:58,687 [INFO]: 		-> Train: 16.7 minutes
2025-03-09 09:23:58,687 [INFO]: 		-> Add: 1.3 seconds
2025-03-09 09:23:58,688 [INFO]: 		Total: 16.7 minutes
2025-03-09 09:23:58,688 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0002 secs
2025-03-09 09:23:58,688 [INFO]: 	Checking that your have enough memory available to create the index 03/09/2025, 09:23:58
2025-03-09 09:23:58,688 [INFO]: 472.0MB of memory will be needed to build the index (more might be used if you have more)
2025-03-09 09:23:58,688 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0003 secs
2025-03-09 09:23:58,688 [INFO]: 	Selecting most promising index types given data characteristics 03/09/2025, 09:23:58
2025-03-09 09:23:58,688 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-09 09:23:58,688 [INFO]: 	Creating the index 03/09/2025, 09:23:58
2025-03-09 09:23:58,688 [INFO]: 		-> Instanciate the index HNSW15 03/09/2025, 09:23:58
2025-03-09 09:23:58,690 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0016 secs
2025-03-09 09:23:58,690 [INFO]: 		-> Adding the vectors to the index 03/09/2025, 09:23:58
2025-03-09 09:23:58,690 [INFO]: The memory available for adding the vectors is 49.6GB(total available - used by the index)
2025-03-09 09:23:58,690 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/10 [00:00<?, ?it/s] 10%|█         | 1/10 [00:00<00:01,  6.88it/s] 30%|███       | 3/10 [00:00<00:00, 10.40it/s] 50%|█████     | 5/10 [00:00<00:00, 11.35it/s] 70%|███████   | 7/10 [00:00<00:00, 11.82it/s] 90%|█████████ | 9/10 [00:00<00:00, 12.15it/s]100%|██████████| 10/10 [00:02<00:00,  4.55it/s]
2025-03-09 09:24:00,893 [INFO]: 	Computing best hyperparameters for index knn.index 03/09/2025, 09:24:00
2025-03-09 09:24:25,367 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 24.4735 secs
2025-03-09 09:24:25,367 [INFO]: The best hyperparameters are: efSearch=279
2025-03-09 09:24:25,367 [INFO]: 	Compute fast metrics 03/09/2025, 09:24:25
  0%|          | 0/4 [00:00<?, ?it/s] 25%|██▌       | 1/4 [00:00<00:00,  6.15it/s] 50%|█████     | 2/4 [00:00<00:00,  7.88it/s] 75%|███████▌  | 3/4 [00:00<00:00,  8.57it/s] 75%|███████▌  | 3/4 [00:00<00:00,  6.46it/s]
2025-03-09 09:24:42,108 [INFO]: 	>>> Finished "Compute fast metrics" in 16.7409 secs
2025-03-09 09:24:42,316 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 43.6258 secs
2025-03-09 09:24:42,316 [INFO]: {
2025-03-09 09:24:42,316 [INFO]: 	index_key: HNSW15
2025-03-09 09:24:42,316 [INFO]: 	index_param: efSearch=279
2025-03-09 09:24:42,316 [INFO]: 	index_path: knn.index
2025-03-09 09:24:42,316 [INFO]: 	size in bytes: 449953210
2025-03-09 09:24:42,317 [INFO]: 	avg_search_speed_ms: 10.169269277838307
2025-03-09 09:24:42,317 [INFO]: 	99p_search_speed_ms: 16.079961233772327
2025-03-09 09:24:42,317 [INFO]: 	reconstruction error %: 0.0
2025-03-09 09:24:42,317 [INFO]: 	nb vectors: 2287
2025-03-09 09:24:42,317 [INFO]: 	vectors dimension: 49152
2025-03-09 09:24:42,317 [INFO]: 	compression ratio: 0.9993094526428647
2025-03-09 09:24:42,317 [INFO]: }
2025-03-09 09:24:42,317 [INFO]: 	>>> Finished "Creating the index" in 43.6287 secs
2025-03-09 09:24:42,317 [INFO]: >>> Finished "Launching the whole pipeline" in 43.6546 secs
2025-03-09 09:24:43: [retrieval_preprocessing] calculating distances ...
2025-03-09 09:24:43: [retrieval_preprocessing] finished and saved retrieval indices for episode 27295 [episode count 16/20]
[retrieval_preprocessing] for episode 21282 [episode count 17/20], we have num_retrieval=np.int64(2310) num_query=np.int64(125)
2025-03-09 09:24:44,415 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-09 09:24:44,743 [INFO]: Launching the whole pipeline 03/09/2025, 09:24:44
2025-03-09 09:24:44,744 [INFO]: Reading total number of vectors and dimension 03/09/2025, 09:24:44
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1475.31it/s]
2025-03-09 09:24:44,767 [INFO]: There are 2310 embeddings of dim 49152
2025-03-09 09:24:44,767 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0235 secs
2025-03-09 09:24:44,767 [INFO]: 	Compute estimated construction time of the index 03/09/2025, 09:24:44
2025-03-09 09:24:44,767 [INFO]: 		-> Train: 16.7 minutes
2025-03-09 09:24:44,767 [INFO]: 		-> Add: 1.3 seconds
2025-03-09 09:24:44,767 [INFO]: 		Total: 16.7 minutes
2025-03-09 09:24:44,767 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0001 secs
2025-03-09 09:24:44,767 [INFO]: 	Checking that your have enough memory available to create the index 03/09/2025, 09:24:44
2025-03-09 09:24:44,767 [INFO]: 476.7MB of memory will be needed to build the index (more might be used if you have more)
2025-03-09 09:24:44,767 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0001 secs
2025-03-09 09:24:44,767 [INFO]: 	Selecting most promising index types given data characteristics 03/09/2025, 09:24:44
2025-03-09 09:24:44,767 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-09 09:24:44,768 [INFO]: 	Creating the index 03/09/2025, 09:24:44
2025-03-09 09:24:44,768 [INFO]: 		-> Instanciate the index HNSW15 03/09/2025, 09:24:44
2025-03-09 09:24:44,769 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0009 secs
2025-03-09 09:24:44,769 [INFO]: 		-> Adding the vectors to the index 03/09/2025, 09:24:44
2025-03-09 09:24:44,769 [INFO]: The memory available for adding the vectors is 49.6GB(total available - used by the index)
2025-03-09 09:24:44,769 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/10 [00:00<?, ?it/s] 10%|█         | 1/10 [00:00<00:01,  5.03it/s] 20%|██        | 2/10 [00:00<00:01,  6.49it/s] 30%|███       | 3/10 [00:00<00:00,  7.14it/s] 40%|████      | 4/10 [00:00<00:00,  7.44it/s] 50%|█████     | 5/10 [00:00<00:00,  7.73it/s] 60%|██████    | 6/10 [00:00<00:00,  8.07it/s] 70%|███████   | 7/10 [00:00<00:00,  8.29it/s] 80%|████████  | 8/10 [00:01<00:00,  8.49it/s] 90%|█████████ | 9/10 [00:01<00:00,  8.57it/s]100%|██████████| 10/10 [00:02<00:00,  1.84it/s]100%|██████████| 10/10 [00:02<00:00,  3.79it/s]
2025-03-09 09:24:47,413 [INFO]: 	Computing best hyperparameters for index knn.index 03/09/2025, 09:24:47
2025-03-09 09:25:15,137 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 27.7237 secs
2025-03-09 09:25:15,137 [INFO]: The best hyperparameters are: efSearch=305
2025-03-09 09:25:15,137 [INFO]: 	Compute fast metrics 03/09/2025, 09:25:15
  0%|          | 0/4 [00:00<?, ?it/s] 25%|██▌       | 1/4 [00:00<00:00,  4.51it/s] 50%|█████     | 2/4 [00:00<00:00,  6.30it/s] 75%|███████▌  | 3/4 [00:00<00:00,  6.13it/s]
2025-03-09 09:25:31,487 [INFO]: 	>>> Finished "Compute fast metrics" in 16.3496 secs
2025-03-09 09:25:31,488 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 46.7198 secs
2025-03-09 09:25:31,489 [INFO]: {
2025-03-09 09:25:31,489 [INFO]: 	index_key: HNSW15
2025-03-09 09:25:31,489 [INFO]: 	index_param: efSearch=305
2025-03-09 09:25:31,489 [INFO]: 	index_path: knn.index
2025-03-09 09:25:31,489 [INFO]: 	size in bytes: 454478350
2025-03-09 09:25:31,489 [INFO]: 	avg_search_speed_ms: 9.882127432007225
2025-03-09 09:25:31,489 [INFO]: 	99p_search_speed_ms: 14.594171841163185
2025-03-09 09:25:31,489 [INFO]: 	reconstruction error %: 0.0
2025-03-09 09:25:31,489 [INFO]: 	nb vectors: 2310
2025-03-09 09:25:31,489 [INFO]: 	vectors dimension: 49152
2025-03-09 09:25:31,489 [INFO]: 	compression ratio: 0.9993093840443664
2025-03-09 09:25:31,489 [INFO]: }
2025-03-09 09:25:31,489 [INFO]: 	>>> Finished "Creating the index" in 46.7212 secs
2025-03-09 09:25:31,489 [INFO]: >>> Finished "Launching the whole pipeline" in 46.7452 secs
2025-03-09 09:25:32: [retrieval_preprocessing] calculating distances ...
2025-03-09 09:25:32: [retrieval_preprocessing] finished and saved retrieval indices for episode 21282 [episode count 17/20]
[retrieval_preprocessing] for episode 49570 [episode count 18/20], we have num_retrieval=np.int64(2337) num_query=np.int64(98)
2025-03-09 09:25:33,360 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-09 09:25:33,955 [INFO]: Launching the whole pipeline 03/09/2025, 09:25:33
2025-03-09 09:25:33,955 [INFO]: Reading total number of vectors and dimension 03/09/2025, 09:25:33
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1204.22it/s]
2025-03-09 09:25:33,983 [INFO]: There are 2337 embeddings of dim 49152
2025-03-09 09:25:33,984 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0289 secs
2025-03-09 09:25:33,984 [INFO]: 	Compute estimated construction time of the index 03/09/2025, 09:25:33
2025-03-09 09:25:33,984 [INFO]: 		-> Train: 16.7 minutes
2025-03-09 09:25:33,984 [INFO]: 		-> Add: 1.3 seconds
2025-03-09 09:25:33,984 [INFO]: 		Total: 16.7 minutes
2025-03-09 09:25:33,984 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0003 secs
2025-03-09 09:25:33,985 [INFO]: 	Checking that your have enough memory available to create the index 03/09/2025, 09:25:33
2025-03-09 09:25:33,985 [INFO]: 482.3MB of memory will be needed to build the index (more might be used if you have more)
2025-03-09 09:25:33,985 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0003 secs
2025-03-09 09:25:33,985 [INFO]: 	Selecting most promising index types given data characteristics 03/09/2025, 09:25:33
2025-03-09 09:25:33,985 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-09 09:25:33,985 [INFO]: 	Creating the index 03/09/2025, 09:25:33
2025-03-09 09:25:33,985 [INFO]: 		-> Instanciate the index HNSW15 03/09/2025, 09:25:33
2025-03-09 09:25:33,988 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0030 secs
2025-03-09 09:25:33,989 [INFO]: 		-> Adding the vectors to the index 03/09/2025, 09:25:33
2025-03-09 09:25:33,989 [INFO]: The memory available for adding the vectors is 49.6GB(total available - used by the index)
2025-03-09 09:25:33,989 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/10 [00:00<?, ?it/s] 10%|█         | 1/10 [00:00<00:01,  6.76it/s] 20%|██        | 2/10 [00:00<00:01,  7.95it/s] 30%|███       | 3/10 [00:00<00:00,  8.54it/s] 50%|█████     | 5/10 [00:00<00:00,  9.18it/s] 60%|██████    | 6/10 [00:00<00:00,  9.13it/s] 70%|███████   | 7/10 [00:00<00:00,  9.10it/s] 80%|████████  | 8/10 [00:00<00:00,  9.04it/s] 90%|█████████ | 9/10 [00:01<00:00,  9.15it/s]100%|██████████| 10/10 [00:02<00:00,  2.01it/s]100%|██████████| 10/10 [00:02<00:00,  4.12it/s]
2025-03-09 09:25:36,420 [INFO]: 	Computing best hyperparameters for index knn.index 03/09/2025, 09:25:36
2025-03-09 09:26:00,255 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 23.8352 secs
2025-03-09 09:26:00,255 [INFO]: The best hyperparameters are: efSearch=295
2025-03-09 09:26:00,256 [INFO]: 	Compute fast metrics 03/09/2025, 09:26:00
  0%|          | 0/4 [00:00<?, ?it/s] 25%|██▌       | 1/4 [00:00<00:00,  5.13it/s] 50%|█████     | 2/4 [00:00<00:00,  6.73it/s] 75%|███████▌  | 3/4 [00:00<00:00,  7.50it/s] 75%|███████▌  | 3/4 [00:00<00:00,  5.61it/s]
2025-03-09 09:26:17,634 [INFO]: 	>>> Finished "Compute fast metrics" in 17.3782 secs
2025-03-09 09:26:17,636 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 43.6469 secs
2025-03-09 09:26:17,636 [INFO]: {
2025-03-09 09:26:17,636 [INFO]: 	index_key: HNSW15
2025-03-09 09:26:17,636 [INFO]: 	index_param: efSearch=295
2025-03-09 09:26:17,636 [INFO]: 	index_path: knn.index
2025-03-09 09:26:17,636 [INFO]: 	size in bytes: 459790390
2025-03-09 09:26:17,636 [INFO]: 	avg_search_speed_ms: 10.097992518121671
2025-03-09 09:26:17,636 [INFO]: 	99p_search_speed_ms: 18.19534706883133
2025-03-09 09:26:17,636 [INFO]: 	reconstruction error %: 0.0
2025-03-09 09:26:17,636 [INFO]: 	nb vectors: 2337
2025-03-09 09:26:17,636 [INFO]: 	vectors dimension: 49152
2025-03-09 09:26:17,636 [INFO]: 	compression ratio: 0.9993094810006795
2025-03-09 09:26:17,636 [INFO]: }
2025-03-09 09:26:17,636 [INFO]: 	>>> Finished "Creating the index" in 43.6509 secs
2025-03-09 09:26:17,636 [INFO]: >>> Finished "Launching the whole pipeline" in 43.6814 secs
2025-03-09 09:26:18: [retrieval_preprocessing] calculating distances ...
2025-03-09 09:26:18: [retrieval_preprocessing] finished and saved retrieval indices for episode 49570 [episode count 18/20]
[retrieval_preprocessing] for episode 79523 [episode count 19/20], we have num_retrieval=np.int64(2322) num_query=np.int64(113)
2025-03-09 09:26:19,396 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-09 09:26:19,720 [INFO]: Launching the whole pipeline 03/09/2025, 09:26:19
2025-03-09 09:26:19,721 [INFO]: Reading total number of vectors and dimension 03/09/2025, 09:26:19
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 2184.53it/s]
2025-03-09 09:26:19,746 [INFO]: There are 2322 embeddings of dim 49152
2025-03-09 09:26:19,746 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0259 secs
2025-03-09 09:26:19,747 [INFO]: 	Compute estimated construction time of the index 03/09/2025, 09:26:19
2025-03-09 09:26:19,747 [INFO]: 		-> Train: 16.7 minutes
2025-03-09 09:26:19,747 [INFO]: 		-> Add: 1.3 seconds
2025-03-09 09:26:19,747 [INFO]: 		Total: 16.7 minutes
2025-03-09 09:26:19,747 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0004 secs
2025-03-09 09:26:19,747 [INFO]: 	Checking that your have enough memory available to create the index 03/09/2025, 09:26:19
2025-03-09 09:26:19,747 [INFO]: 479.2MB of memory will be needed to build the index (more might be used if you have more)
2025-03-09 09:26:19,748 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0004 secs
2025-03-09 09:26:19,748 [INFO]: 	Selecting most promising index types given data characteristics 03/09/2025, 09:26:19
2025-03-09 09:26:19,748 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-09 09:26:19,748 [INFO]: 	Creating the index 03/09/2025, 09:26:19
2025-03-09 09:26:19,748 [INFO]: 		-> Instanciate the index HNSW15 03/09/2025, 09:26:19
2025-03-09 09:26:19,751 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0025 secs
2025-03-09 09:26:19,751 [INFO]: 		-> Adding the vectors to the index 03/09/2025, 09:26:19
2025-03-09 09:26:19,751 [INFO]: The memory available for adding the vectors is 49.6GB(total available - used by the index)
2025-03-09 09:26:19,751 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/10 [00:00<?, ?it/s] 10%|█         | 1/10 [00:00<00:01,  7.07it/s] 30%|███       | 3/10 [00:00<00:00, 10.50it/s] 50%|█████     | 5/10 [00:00<00:00, 11.32it/s] 70%|███████   | 7/10 [00:00<00:00, 11.84it/s] 90%|█████████ | 9/10 [00:00<00:00, 12.06it/s]100%|██████████| 10/10 [00:02<00:00,  4.28it/s]
2025-03-09 09:26:22,090 [INFO]: 	Computing best hyperparameters for index knn.index 03/09/2025, 09:26:22
2025-03-09 09:26:51,846 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 29.7557 secs
2025-03-09 09:26:51,846 [INFO]: The best hyperparameters are: efSearch=275
2025-03-09 09:26:51,846 [INFO]: 	Compute fast metrics 03/09/2025, 09:26:51
  0%|          | 0/4 [00:00<?, ?it/s] 25%|██▌       | 1/4 [00:00<00:00,  5.06it/s] 50%|█████     | 2/4 [00:00<00:00,  6.94it/s] 75%|███████▌  | 3/4 [00:00<00:00,  7.94it/s] 75%|███████▌  | 3/4 [00:00<00:00,  5.87it/s]
2025-03-09 09:27:10,766 [INFO]: 	>>> Finished "Compute fast metrics" in 18.9192 secs
2025-03-09 09:27:10,767 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 51.0163 secs
2025-03-09 09:27:10,767 [INFO]: {
2025-03-09 09:27:10,767 [INFO]: 	index_key: HNSW15
2025-03-09 09:27:10,767 [INFO]: 	index_param: efSearch=275
2025-03-09 09:27:10,767 [INFO]: 	index_path: knn.index
2025-03-09 09:27:10,767 [INFO]: 	size in bytes: 456839290
2025-03-09 09:27:10,767 [INFO]: 	avg_search_speed_ms: 10.2372448381414
2025-03-09 09:27:10,768 [INFO]: 	99p_search_speed_ms: 17.087644310668114
2025-03-09 09:27:10,768 [INFO]: 	reconstruction error %: 0.0
2025-03-09 09:27:10,768 [INFO]: 	nb vectors: 2322
2025-03-09 09:27:10,768 [INFO]: 	vectors dimension: 49152
2025-03-09 09:27:10,768 [INFO]: 	compression ratio: 0.9993093544996973
2025-03-09 09:27:10,768 [INFO]: }
2025-03-09 09:27:10,768 [INFO]: 	>>> Finished "Creating the index" in 51.0196 secs
2025-03-09 09:27:10,768 [INFO]: >>> Finished "Launching the whole pipeline" in 51.0471 secs
2025-03-09 09:27:11: [retrieval_preprocessing] calculating distances ...
2025-03-09 09:27:11: [retrieval_preprocessing] finished and saved retrieval indices for episode 79523 [episode count 19/20]
2025-03-09 09:27:11: [retrieval_preprocessing] finished for (376702246, 'cup') [chosen_id count 4/10]
2025-03-09 09:27:14: [retrieval_preprocessing] concatenated all embeddings and indices for 20 episodes for (9883209091, 'mug') [chosen_id count 5/10]
2025-03-09 09:27:14: [retrieval_preprocessing] we have num_total=4597 embedding_dim=49152
[retrieval_preprocessing] for episode 62464 [episode count 0/20], we have num_retrieval=np.int64(4435) num_query=np.int64(162)
2025-03-09 09:27:15,856 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-09 09:27:16,501 [INFO]: Launching the whole pipeline 03/09/2025, 09:27:16
2025-03-09 09:27:16,501 [INFO]: Reading total number of vectors and dimension 03/09/2025, 09:27:16
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 2155.35it/s]
2025-03-09 09:27:16,527 [INFO]: There are 4435 embeddings of dim 49152
2025-03-09 09:27:16,527 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0261 secs
2025-03-09 09:27:16,527 [INFO]: 	Compute estimated construction time of the index 03/09/2025, 09:27:16
2025-03-09 09:27:16,527 [INFO]: 		-> Train: 16.7 minutes
2025-03-09 09:27:16,527 [INFO]: 		-> Add: 2.4 seconds
2025-03-09 09:27:16,527 [INFO]: 		Total: 16.7 minutes
2025-03-09 09:27:16,527 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0001 secs
2025-03-09 09:27:16,527 [INFO]: 	Checking that your have enough memory available to create the index 03/09/2025, 09:27:16
2025-03-09 09:27:16,527 [INFO]: 915.3MB of memory will be needed to build the index (more might be used if you have more)
2025-03-09 09:27:16,527 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0002 secs
2025-03-09 09:27:16,527 [INFO]: 	Selecting most promising index types given data characteristics 03/09/2025, 09:27:16
2025-03-09 09:27:16,527 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-09 09:27:16,528 [INFO]: 	Creating the index 03/09/2025, 09:27:16
2025-03-09 09:27:16,528 [INFO]: 		-> Instanciate the index HNSW15 03/09/2025, 09:27:16
2025-03-09 09:27:16,529 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0011 secs
2025-03-09 09:27:16,529 [INFO]: 		-> Adding the vectors to the index 03/09/2025, 09:27:16
2025-03-09 09:27:16,529 [INFO]: The memory available for adding the vectors is 49.2GB(total available - used by the index)
2025-03-09 09:27:16,529 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/18 [00:00<?, ?it/s]  6%|▌         | 1/18 [00:00<00:03,  5.02it/s] 17%|█▋        | 3/18 [00:00<00:01, 10.26it/s] 28%|██▊       | 5/18 [00:00<00:01, 10.36it/s] 39%|███▉      | 7/18 [00:00<00:01,  9.79it/s] 50%|█████     | 9/18 [00:00<00:00, 10.28it/s] 61%|██████    | 11/18 [00:01<00:00, 10.53it/s] 72%|███████▏  | 13/18 [00:01<00:00, 11.46it/s] 83%|████████▎ | 15/18 [00:01<00:00, 11.94it/s] 94%|█████████▍| 17/18 [00:01<00:00, 11.71it/s]100%|██████████| 18/18 [00:04<00:00,  3.80it/s]
2025-03-09 09:27:21,274 [INFO]: 	Computing best hyperparameters for index knn.index 03/09/2025, 09:27:21
2025-03-09 09:28:02,967 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 41.6922 secs
2025-03-09 09:28:02,967 [INFO]: The best hyperparameters are: efSearch=232
2025-03-09 09:28:02,967 [INFO]: 	Compute fast metrics 03/09/2025, 09:28:02
  0%|          | 0/4 [00:00<?, ?it/s] 25%|██▌       | 1/4 [00:00<00:00,  4.70it/s] 50%|█████     | 2/4 [00:00<00:00,  6.09it/s] 75%|███████▌  | 3/4 [00:00<00:00,  6.83it/s] 75%|███████▌  | 3/4 [00:00<00:00,  5.17it/s]
2025-03-09 09:28:23,663 [INFO]: 	>>> Finished "Compute fast metrics" in 20.6959 secs
2025-03-09 09:28:23,666 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 67.1368 secs
2025-03-09 09:28:23,666 [INFO]: {
2025-03-09 09:28:23,666 [INFO]: 	index_key: HNSW15
2025-03-09 09:28:23,666 [INFO]: 	index_param: efSearch=232
2025-03-09 09:28:23,666 [INFO]: 	index_path: knn.index
2025-03-09 09:28:23,666 [INFO]: 	size in bytes: 872559730
2025-03-09 09:28:23,666 [INFO]: 	avg_search_speed_ms: 9.813234251599404
2025-03-09 09:28:23,666 [INFO]: 	99p_search_speed_ms: 16.752390312030908
2025-03-09 09:28:23,666 [INFO]: 	reconstruction error %: 0.0
2025-03-09 09:28:23,666 [INFO]: 	nb vectors: 4435
2025-03-09 09:28:23,666 [INFO]: 	vectors dimension: 49152
2025-03-09 09:28:23,666 [INFO]: 	compression ratio: 0.9993086433177474
2025-03-09 09:28:23,666 [INFO]: }
2025-03-09 09:28:23,666 [INFO]: 	>>> Finished "Creating the index" in 67.1384 secs
2025-03-09 09:28:23,666 [INFO]: >>> Finished "Launching the whole pipeline" in 67.1653 secs
2025-03-09 09:28:24: [retrieval_preprocessing] calculating distances ...
2025-03-09 09:28:25: [retrieval_preprocessing] finished and saved retrieval indices for episode 62464 [episode count 0/20]
[retrieval_preprocessing] for episode 84993 [episode count 1/20], we have num_retrieval=np.int64(4363) num_query=np.int64(234)
2025-03-09 09:28:26,194 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-09 09:28:26,787 [INFO]: Launching the whole pipeline 03/09/2025, 09:28:26
2025-03-09 09:28:26,787 [INFO]: Reading total number of vectors and dimension 03/09/2025, 09:28:26
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1793.20it/s]
2025-03-09 09:28:26,814 [INFO]: There are 4363 embeddings of dim 49152
2025-03-09 09:28:26,815 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0278 secs
2025-03-09 09:28:26,815 [INFO]: 	Compute estimated construction time of the index 03/09/2025, 09:28:26
2025-03-09 09:28:26,815 [INFO]: 		-> Train: 16.7 minutes
2025-03-09 09:28:26,815 [INFO]: 		-> Add: 2.4 seconds
2025-03-09 09:28:26,815 [INFO]: 		Total: 16.7 minutes
2025-03-09 09:28:26,816 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0003 secs
2025-03-09 09:28:26,816 [INFO]: 	Checking that your have enough memory available to create the index 03/09/2025, 09:28:26
2025-03-09 09:28:26,816 [INFO]: 900.4MB of memory will be needed to build the index (more might be used if you have more)
2025-03-09 09:28:26,816 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0005 secs
2025-03-09 09:28:26,817 [INFO]: 	Selecting most promising index types given data characteristics 03/09/2025, 09:28:26
2025-03-09 09:28:26,817 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-09 09:28:26,817 [INFO]: 	Creating the index 03/09/2025, 09:28:26
2025-03-09 09:28:26,817 [INFO]: 		-> Instanciate the index HNSW15 03/09/2025, 09:28:26
2025-03-09 09:28:26,820 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0026 secs
2025-03-09 09:28:26,820 [INFO]: 		-> Adding the vectors to the index 03/09/2025, 09:28:26
2025-03-09 09:28:26,820 [INFO]: The memory available for adding the vectors is 49.2GB(total available - used by the index)
2025-03-09 09:28:26,820 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/18 [00:00<?, ?it/s]  6%|▌         | 1/18 [00:00<00:03,  5.46it/s] 11%|█         | 2/18 [00:00<00:02,  7.29it/s] 22%|██▏       | 4/18 [00:00<00:01,  8.85it/s] 28%|██▊       | 5/18 [00:00<00:01,  9.07it/s] 39%|███▉      | 7/18 [00:00<00:01,  9.79it/s] 50%|█████     | 9/18 [00:00<00:00, 10.01it/s] 56%|█████▌    | 10/18 [00:01<00:00, 10.00it/s] 67%|██████▋   | 12/18 [00:01<00:00, 10.24it/s] 78%|███████▊  | 14/18 [00:01<00:00,  9.83it/s] 83%|████████▎ | 15/18 [00:01<00:00,  9.63it/s] 89%|████████▉ | 16/18 [00:01<00:00,  9.39it/s] 94%|█████████▍| 17/18 [00:01<00:00,  9.42it/s]100%|██████████| 18/18 [00:04<00:00,  1.18it/s]100%|██████████| 18/18 [00:04<00:00,  3.77it/s]
2025-03-09 09:28:31,606 [INFO]: 	Computing best hyperparameters for index knn.index 03/09/2025, 09:28:31
2025-03-09 09:29:18,325 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 46.7185 secs
2025-03-09 09:29:18,325 [INFO]: The best hyperparameters are: efSearch=247
2025-03-09 09:29:18,325 [INFO]: 	Compute fast metrics 03/09/2025, 09:29:18
  0%|          | 0/4 [00:00<?, ?it/s] 25%|██▌       | 1/4 [00:00<00:00,  5.61it/s] 50%|█████     | 2/4 [00:00<00:00,  6.98it/s] 75%|███████▌  | 3/4 [00:00<00:00,  7.59it/s] 75%|███████▌  | 3/4 [00:00<00:00,  5.67it/s]
2025-03-09 09:29:37,731 [INFO]: 	>>> Finished "Compute fast metrics" in 19.4053 secs
2025-03-09 09:29:37,734 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 70.9145 secs
2025-03-09 09:29:37,735 [INFO]: {
2025-03-09 09:29:37,735 [INFO]: 	index_key: HNSW15
2025-03-09 09:29:37,735 [INFO]: 	index_param: efSearch=247
2025-03-09 09:29:37,735 [INFO]: 	index_path: knn.index
2025-03-09 09:29:37,735 [INFO]: 	size in bytes: 858394210
2025-03-09 09:29:37,735 [INFO]: 	avg_search_speed_ms: 10.16563363278633
2025-03-09 09:29:37,735 [INFO]: 	99p_search_speed_ms: 19.886916340328746
2025-03-09 09:29:37,735 [INFO]: 	reconstruction error %: 0.0
2025-03-09 09:29:37,735 [INFO]: 	nb vectors: 4363
2025-03-09 09:29:37,735 [INFO]: 	vectors dimension: 49152
2025-03-09 09:29:37,735 [INFO]: 	compression ratio: 0.9993085857370823
2025-03-09 09:29:37,735 [INFO]: }
2025-03-09 09:29:37,735 [INFO]: 	>>> Finished "Creating the index" in 70.9181 secs
2025-03-09 09:29:37,735 [INFO]: >>> Finished "Launching the whole pipeline" in 70.9479 secs
2025-03-09 09:29:39: [retrieval_preprocessing] calculating distances ...
2025-03-09 09:29:40: [retrieval_preprocessing] finished and saved retrieval indices for episode 84993 [episode count 1/20]
[retrieval_preprocessing] for episode 72196 [episode count 2/20], we have num_retrieval=np.int64(4420) num_query=np.int64(177)
2025-03-09 09:29:41,522 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-09 09:29:42,122 [INFO]: Launching the whole pipeline 03/09/2025, 09:29:42
2025-03-09 09:29:42,122 [INFO]: Reading total number of vectors and dimension 03/09/2025, 09:29:42
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1197.00it/s]
2025-03-09 09:29:42,148 [INFO]: There are 4420 embeddings of dim 49152
2025-03-09 09:29:42,148 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0257 secs
2025-03-09 09:29:42,148 [INFO]: 	Compute estimated construction time of the index 03/09/2025, 09:29:42
2025-03-09 09:29:42,148 [INFO]: 		-> Train: 16.7 minutes
2025-03-09 09:29:42,148 [INFO]: 		-> Add: 2.4 seconds
2025-03-09 09:29:42,148 [INFO]: 		Total: 16.7 minutes
2025-03-09 09:29:42,148 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0001 secs
2025-03-09 09:29:42,148 [INFO]: 	Checking that your have enough memory available to create the index 03/09/2025, 09:29:42
2025-03-09 09:29:42,148 [INFO]: 912.2MB of memory will be needed to build the index (more might be used if you have more)
2025-03-09 09:29:42,148 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0001 secs
2025-03-09 09:29:42,148 [INFO]: 	Selecting most promising index types given data characteristics 03/09/2025, 09:29:42
2025-03-09 09:29:42,148 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-09 09:29:42,148 [INFO]: 	Creating the index 03/09/2025, 09:29:42
2025-03-09 09:29:42,148 [INFO]: 		-> Instanciate the index HNSW15 03/09/2025, 09:29:42
2025-03-09 09:29:42,149 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0010 secs
2025-03-09 09:29:42,149 [INFO]: 		-> Adding the vectors to the index 03/09/2025, 09:29:42
2025-03-09 09:29:42,149 [INFO]: The memory available for adding the vectors is 49.2GB(total available - used by the index)
2025-03-09 09:29:42,149 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/18 [00:00<?, ?it/s]  6%|▌         | 1/18 [00:00<00:03,  5.34it/s] 17%|█▋        | 3/18 [00:00<00:01,  8.24it/s] 22%|██▏       | 4/18 [00:00<00:01,  8.61it/s] 33%|███▎      | 6/18 [00:00<00:01,  9.20it/s] 39%|███▉      | 7/18 [00:00<00:01,  9.18it/s] 44%|████▍     | 8/18 [00:00<00:01,  9.10it/s] 50%|█████     | 9/18 [00:01<00:00,  9.16it/s] 56%|█████▌    | 10/18 [00:01<00:00,  9.10it/s] 61%|██████    | 11/18 [00:01<00:00,  9.15it/s] 67%|██████▋   | 12/18 [00:01<00:00,  9.01it/s] 72%|███████▏  | 13/18 [00:01<00:00,  8.94it/s] 78%|███████▊  | 14/18 [00:01<00:00,  8.92it/s] 83%|████████▎ | 15/18 [00:01<00:00,  8.86it/s] 94%|█████████▍| 17/18 [00:01<00:00, 10.03it/s]100%|██████████| 18/18 [00:05<00:00,  1.16it/s]100%|██████████| 18/18 [00:05<00:00,  3.57it/s]
2025-03-09 09:29:47,197 [INFO]: 	Computing best hyperparameters for index knn.index 03/09/2025, 09:29:47
2025-03-09 09:30:32,856 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 45.6585 secs
2025-03-09 09:30:32,856 [INFO]: The best hyperparameters are: efSearch=257
2025-03-09 09:30:32,856 [INFO]: 	Compute fast metrics 03/09/2025, 09:30:32
  0%|          | 0/4 [00:00<?, ?it/s] 25%|██▌       | 1/4 [00:00<00:00,  5.19it/s] 50%|█████     | 2/4 [00:00<00:00,  6.76it/s] 75%|███████▌  | 3/4 [00:00<00:00,  7.51it/s] 75%|███████▌  | 3/4 [00:00<00:00,  5.72it/s]
2025-03-09 09:30:51,860 [INFO]: 	>>> Finished "Compute fast metrics" in 19.0035 secs
2025-03-09 09:30:51,862 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 69.7129 secs
2025-03-09 09:30:51,862 [INFO]: {
2025-03-09 09:30:51,862 [INFO]: 	index_key: HNSW15
2025-03-09 09:30:51,862 [INFO]: 	index_param: efSearch=257
2025-03-09 09:30:51,862 [INFO]: 	index_path: knn.index
2025-03-09 09:30:51,862 [INFO]: 	size in bytes: 869608630
2025-03-09 09:30:51,862 [INFO]: 	avg_search_speed_ms: 10.132617430606707
2025-03-09 09:30:51,863 [INFO]: 	99p_search_speed_ms: 18.132979818619777
2025-03-09 09:30:51,863 [INFO]: 	reconstruction error %: 0.0
2025-03-09 09:30:51,863 [INFO]: 	nb vectors: 4420
2025-03-09 09:30:51,863 [INFO]: 	vectors dimension: 49152
2025-03-09 09:30:51,863 [INFO]: 	compression ratio: 0.9993085740190963
2025-03-09 09:30:51,863 [INFO]: }
2025-03-09 09:30:51,863 [INFO]: 	>>> Finished "Creating the index" in 69.7143 secs
2025-03-09 09:30:51,863 [INFO]: >>> Finished "Launching the whole pipeline" in 69.7406 secs
2025-03-09 09:30:52: [retrieval_preprocessing] calculating distances ...
2025-03-09 09:30:53: [retrieval_preprocessing] finished and saved retrieval indices for episode 72196 [episode count 2/20]
[retrieval_preprocessing] for episode 78852 [episode count 3/20], we have num_retrieval=np.int64(4356) num_query=np.int64(241)
2025-03-09 09:30:54,771 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-09 09:30:55,372 [INFO]: Launching the whole pipeline 03/09/2025, 09:30:55
2025-03-09 09:30:55,372 [INFO]: Reading total number of vectors and dimension 03/09/2025, 09:30:55
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1791.67it/s]
2025-03-09 09:30:55,397 [INFO]: There are 4356 embeddings of dim 49152
2025-03-09 09:30:55,397 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0246 secs
2025-03-09 09:30:55,397 [INFO]: 	Compute estimated construction time of the index 03/09/2025, 09:30:55
2025-03-09 09:30:55,397 [INFO]: 		-> Train: 16.7 minutes
2025-03-09 09:30:55,397 [INFO]: 		-> Add: 2.4 seconds
2025-03-09 09:30:55,397 [INFO]: 		Total: 16.7 minutes
2025-03-09 09:30:55,397 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0001 secs
2025-03-09 09:30:55,397 [INFO]: 	Checking that your have enough memory available to create the index 03/09/2025, 09:30:55
2025-03-09 09:30:55,397 [INFO]: 899.0MB of memory will be needed to build the index (more might be used if you have more)
2025-03-09 09:30:55,397 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0001 secs
2025-03-09 09:30:55,397 [INFO]: 	Selecting most promising index types given data characteristics 03/09/2025, 09:30:55
2025-03-09 09:30:55,397 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-09 09:30:55,397 [INFO]: 	Creating the index 03/09/2025, 09:30:55
2025-03-09 09:30:55,397 [INFO]: 		-> Instanciate the index HNSW15 03/09/2025, 09:30:55
2025-03-09 09:30:55,398 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0010 secs
2025-03-09 09:30:55,399 [INFO]: 		-> Adding the vectors to the index 03/09/2025, 09:30:55
2025-03-09 09:30:55,399 [INFO]: The memory available for adding the vectors is 49.2GB(total available - used by the index)
2025-03-09 09:30:55,399 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/18 [00:00<?, ?it/s]  6%|▌         | 1/18 [00:00<00:02,  6.68it/s] 17%|█▋        | 3/18 [00:00<00:01, 10.97it/s] 28%|██▊       | 5/18 [00:00<00:01, 11.53it/s] 39%|███▉      | 7/18 [00:00<00:00, 11.71it/s] 50%|█████     | 9/18 [00:00<00:00, 11.86it/s] 61%|██████    | 11/18 [00:00<00:00, 11.94it/s] 72%|███████▏  | 13/18 [00:01<00:00, 12.01it/s] 83%|████████▎ | 15/18 [00:01<00:00, 12.07it/s] 94%|█████████▍| 17/18 [00:01<00:00, 11.95it/s]100%|██████████| 18/18 [00:04<00:00,  3.88it/s]
2025-03-09 09:31:00,047 [INFO]: 	Computing best hyperparameters for index knn.index 03/09/2025, 09:31:00
2025-03-09 09:31:45,412 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 45.3653 secs
2025-03-09 09:31:45,413 [INFO]: The best hyperparameters are: efSearch=263
2025-03-09 09:31:45,413 [INFO]: 	Compute fast metrics 03/09/2025, 09:31:45
  0%|          | 0/4 [00:00<?, ?it/s] 25%|██▌       | 1/4 [00:00<00:00,  5.61it/s] 50%|█████     | 2/4 [00:00<00:00,  7.41it/s] 75%|███████▌  | 3/4 [00:00<00:00,  8.18it/s] 75%|███████▌  | 3/4 [00:00<00:00,  6.20it/s]
2025-03-09 09:32:07,772 [INFO]: 	>>> Finished "Compute fast metrics" in 22.3589 secs
2025-03-09 09:32:07,775 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 72.3763 secs
2025-03-09 09:32:07,775 [INFO]: {
2025-03-09 09:32:07,775 [INFO]: 	index_key: HNSW15
2025-03-09 09:32:07,775 [INFO]: 	index_param: efSearch=263
2025-03-09 09:32:07,775 [INFO]: 	index_path: knn.index
2025-03-09 09:32:07,775 [INFO]: 	size in bytes: 857017030
2025-03-09 09:32:07,775 [INFO]: 	avg_search_speed_ms: 10.332104064714672
2025-03-09 09:32:07,775 [INFO]: 	99p_search_speed_ms: 19.80400479165837
2025-03-09 09:32:07,775 [INFO]: 	reconstruction error %: 0.0
2025-03-09 09:32:07,775 [INFO]: 	nb vectors: 4356
2025-03-09 09:32:07,775 [INFO]: 	vectors dimension: 49152
2025-03-09 09:32:07,775 [INFO]: 	compression ratio: 0.9993085528300412
2025-03-09 09:32:07,775 [INFO]: }
2025-03-09 09:32:07,775 [INFO]: 	>>> Finished "Creating the index" in 72.3778 secs
2025-03-09 09:32:07,775 [INFO]: >>> Finished "Launching the whole pipeline" in 72.4029 secs
2025-03-09 09:32:09: [retrieval_preprocessing] calculating distances ...
2025-03-09 09:32:10: [retrieval_preprocessing] finished and saved retrieval indices for episode 78852 [episode count 3/20]
[retrieval_preprocessing] for episode 85509 [episode count 4/20], we have num_retrieval=np.int64(4445) num_query=np.int64(152)
2025-03-09 09:32:11,604 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-09 09:32:12,342 [INFO]: Launching the whole pipeline 03/09/2025, 09:32:12
2025-03-09 09:32:12,342 [INFO]: Reading total number of vectors and dimension 03/09/2025, 09:32:12
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1360.46it/s]
2025-03-09 09:32:12,378 [INFO]: There are 4445 embeddings of dim 49152
2025-03-09 09:32:12,378 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0353 secs
2025-03-09 09:32:12,378 [INFO]: 	Compute estimated construction time of the index 03/09/2025, 09:32:12
2025-03-09 09:32:12,378 [INFO]: 		-> Train: 16.7 minutes
2025-03-09 09:32:12,378 [INFO]: 		-> Add: 2.4 seconds
2025-03-09 09:32:12,378 [INFO]: 		Total: 16.7 minutes
2025-03-09 09:32:12,378 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0003 secs
2025-03-09 09:32:12,378 [INFO]: 	Checking that your have enough memory available to create the index 03/09/2025, 09:32:12
2025-03-09 09:32:12,378 [INFO]: 917.3MB of memory will be needed to build the index (more might be used if you have more)
2025-03-09 09:32:12,379 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0003 secs
2025-03-09 09:32:12,379 [INFO]: 	Selecting most promising index types given data characteristics 03/09/2025, 09:32:12
2025-03-09 09:32:12,379 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-09 09:32:12,379 [INFO]: 	Creating the index 03/09/2025, 09:32:12
2025-03-09 09:32:12,379 [INFO]: 		-> Instanciate the index HNSW15 03/09/2025, 09:32:12
2025-03-09 09:32:12,381 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0017 secs
2025-03-09 09:32:12,381 [INFO]: 		-> Adding the vectors to the index 03/09/2025, 09:32:12
2025-03-09 09:32:12,381 [INFO]: The memory available for adding the vectors is 49.2GB(total available - used by the index)
2025-03-09 09:32:12,382 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/18 [00:00<?, ?it/s]  6%|▌         | 1/18 [00:00<00:03,  5.41it/s] 17%|█▋        | 3/18 [00:00<00:01,  8.79it/s] 28%|██▊       | 5/18 [00:00<00:01, 10.11it/s] 39%|███▉      | 7/18 [00:00<00:00, 11.12it/s] 50%|█████     | 9/18 [00:00<00:00, 11.55it/s] 61%|██████    | 11/18 [00:01<00:00, 11.57it/s] 72%|███████▏  | 13/18 [00:01<00:00, 13.11it/s]100%|██████████| 18/18 [00:03<00:00,  2.99it/s]100%|██████████| 18/18 [00:03<00:00,  4.62it/s]
2025-03-09 09:32:16,282 [INFO]: 	Computing best hyperparameters for index knn.index 03/09/2025, 09:32:16
2025-03-09 09:32:54,790 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 38.5075 secs
2025-03-09 09:32:54,790 [INFO]: The best hyperparameters are: efSearch=282
2025-03-09 09:32:54,790 [INFO]: 	Compute fast metrics 03/09/2025, 09:32:54
  0%|          | 0/4 [00:00<?, ?it/s] 25%|██▌       | 1/4 [00:00<00:00,  6.22it/s] 50%|█████     | 2/4 [00:00<00:00,  7.64it/s] 75%|███████▌  | 3/4 [00:00<00:00,  8.14it/s] 75%|███████▌  | 3/4 [00:00<00:00,  6.20it/s]
2025-03-09 09:33:16,146 [INFO]: 	>>> Finished "Compute fast metrics" in 21.3554 secs
2025-03-09 09:33:16,149 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 63.7676 secs
2025-03-09 09:33:16,149 [INFO]: {
2025-03-09 09:33:16,149 [INFO]: 	index_key: HNSW15
2025-03-09 09:33:16,149 [INFO]: 	index_param: efSearch=282
2025-03-09 09:33:16,149 [INFO]: 	index_path: knn.index
2025-03-09 09:33:16,149 [INFO]: 	size in bytes: 874527190
2025-03-09 09:33:16,149 [INFO]: 	avg_search_speed_ms: 10.604859196925625
2025-03-09 09:33:16,149 [INFO]: 	99p_search_speed_ms: 17.76374851353467
2025-03-09 09:33:16,149 [INFO]: 	reconstruction error %: 0.0
2025-03-09 09:33:16,149 [INFO]: 	nb vectors: 4445
2025-03-09 09:33:16,149 [INFO]: 	vectors dimension: 49152
2025-03-09 09:33:16,149 [INFO]: 	compression ratio: 0.9993086206959443
2025-03-09 09:33:16,149 [INFO]: }
2025-03-09 09:33:16,149 [INFO]: 	>>> Finished "Creating the index" in 63.7701 secs
2025-03-09 09:33:16,149 [INFO]: >>> Finished "Launching the whole pipeline" in 63.8068 secs
2025-03-09 09:33:17: [retrieval_preprocessing] calculating distances ...
2025-03-09 09:33:17: [retrieval_preprocessing] finished and saved retrieval indices for episode 85509 [episode count 4/20]
[retrieval_preprocessing] for episode 38920 [episode count 5/20], we have num_retrieval=np.int64(4443) num_query=np.int64(154)
2025-03-09 09:33:19,298 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-09 09:33:19,947 [INFO]: Launching the whole pipeline 03/09/2025, 09:33:19
2025-03-09 09:33:19,947 [INFO]: Reading total number of vectors and dimension 03/09/2025, 09:33:19
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1271.77it/s]
2025-03-09 09:33:19,977 [INFO]: There are 4443 embeddings of dim 49152
2025-03-09 09:33:19,977 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0295 secs
2025-03-09 09:33:19,977 [INFO]: 	Compute estimated construction time of the index 03/09/2025, 09:33:19
2025-03-09 09:33:19,977 [INFO]: 		-> Train: 16.7 minutes
2025-03-09 09:33:19,977 [INFO]: 		-> Add: 2.4 seconds
2025-03-09 09:33:19,977 [INFO]: 		Total: 16.7 minutes
2025-03-09 09:33:19,977 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0003 secs
2025-03-09 09:33:19,978 [INFO]: 	Checking that your have enough memory available to create the index 03/09/2025, 09:33:19
2025-03-09 09:33:19,978 [INFO]: 916.9MB of memory will be needed to build the index (more might be used if you have more)
2025-03-09 09:33:19,978 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0004 secs
2025-03-09 09:33:19,978 [INFO]: 	Selecting most promising index types given data characteristics 03/09/2025, 09:33:19
2025-03-09 09:33:19,978 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-09 09:33:19,978 [INFO]: 	Creating the index 03/09/2025, 09:33:19
2025-03-09 09:33:19,978 [INFO]: 		-> Instanciate the index HNSW15 03/09/2025, 09:33:19
2025-03-09 09:33:19,981 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0027 secs
2025-03-09 09:33:19,982 [INFO]: 		-> Adding the vectors to the index 03/09/2025, 09:33:19
2025-03-09 09:33:19,982 [INFO]: The memory available for adding the vectors is 49.2GB(total available - used by the index)
2025-03-09 09:33:19,982 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/18 [00:00<?, ?it/s]  6%|▌         | 1/18 [00:00<00:02,  6.09it/s] 17%|█▋        | 3/18 [00:00<00:01, 10.12it/s] 28%|██▊       | 5/18 [00:00<00:01, 11.60it/s] 39%|███▉      | 7/18 [00:00<00:00, 12.21it/s] 50%|█████     | 9/18 [00:00<00:00, 12.50it/s] 61%|██████    | 11/18 [00:00<00:00, 12.77it/s] 72%|███████▏  | 13/18 [00:01<00:00, 12.88it/s] 83%|████████▎ | 15/18 [00:01<00:00, 12.32it/s] 94%|█████████▍| 17/18 [00:01<00:00, 12.45it/s]100%|██████████| 18/18 [00:04<00:00,  4.26it/s]
2025-03-09 09:33:24,209 [INFO]: 	Computing best hyperparameters for index knn.index 03/09/2025, 09:33:24
2025-03-09 09:34:09,881 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 45.6717 secs
2025-03-09 09:34:09,882 [INFO]: The best hyperparameters are: efSearch=287
2025-03-09 09:34:09,882 [INFO]: 	Compute fast metrics 03/09/2025, 09:34:09
  0%|          | 0/4 [00:00<?, ?it/s] 25%|██▌       | 1/4 [00:00<00:00,  9.20it/s] 75%|███████▌  | 3/4 [00:00<00:00, 17.87it/s]
2025-03-09 09:34:33,362 [INFO]: 	>>> Finished "Compute fast metrics" in 23.4804 secs
2025-03-09 09:34:33,774 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 73.7921 secs
2025-03-09 09:34:33,774 [INFO]: {
2025-03-09 09:34:33,774 [INFO]: 	index_key: HNSW15
2025-03-09 09:34:33,774 [INFO]: 	index_param: efSearch=287
2025-03-09 09:34:33,774 [INFO]: 	index_path: knn.index
2025-03-09 09:34:33,774 [INFO]: 	size in bytes: 874133710
2025-03-09 09:34:33,775 [INFO]: 	avg_search_speed_ms: 10.43547649132885
2025-03-09 09:34:33,775 [INFO]: 	99p_search_speed_ms: 15.510541836265473
2025-03-09 09:34:33,775 [INFO]: 	reconstruction error %: 0.0
2025-03-09 09:34:33,775 [INFO]: 	nb vectors: 4443
2025-03-09 09:34:33,775 [INFO]: 	vectors dimension: 49152
2025-03-09 09:34:33,775 [INFO]: 	compression ratio: 0.9993086114937725
2025-03-09 09:34:33,775 [INFO]: }
2025-03-09 09:34:33,775 [INFO]: 	>>> Finished "Creating the index" in 73.7968 secs
2025-03-09 09:34:33,775 [INFO]: >>> Finished "Launching the whole pipeline" in 73.8279 secs
2025-03-09 09:34:34: [retrieval_preprocessing] calculating distances ...
2025-03-09 09:34:35: [retrieval_preprocessing] finished and saved retrieval indices for episode 38920 [episode count 5/20]
[retrieval_preprocessing] for episode 49164 [episode count 6/20], we have num_retrieval=np.int64(4241) num_query=np.int64(356)
2025-03-09 09:34:35,786 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-09 09:34:36,273 [INFO]: Launching the whole pipeline 03/09/2025, 09:34:36
2025-03-09 09:34:36,274 [INFO]: Reading total number of vectors and dimension 03/09/2025, 09:34:36
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 2252.58it/s]
2025-03-09 09:34:36,299 [INFO]: There are 4241 embeddings of dim 49152
2025-03-09 09:34:36,299 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0252 secs
2025-03-09 09:34:36,299 [INFO]: 	Compute estimated construction time of the index 03/09/2025, 09:34:36
2025-03-09 09:34:36,299 [INFO]: 		-> Train: 16.7 minutes
2025-03-09 09:34:36,299 [INFO]: 		-> Add: 2.3 seconds
2025-03-09 09:34:36,299 [INFO]: 		Total: 16.7 minutes
2025-03-09 09:34:36,299 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0001 secs
2025-03-09 09:34:36,299 [INFO]: 	Checking that your have enough memory available to create the index 03/09/2025, 09:34:36
2025-03-09 09:34:36,299 [INFO]: 875.2MB of memory will be needed to build the index (more might be used if you have more)
2025-03-09 09:34:36,299 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0001 secs
2025-03-09 09:34:36,299 [INFO]: 	Selecting most promising index types given data characteristics 03/09/2025, 09:34:36
2025-03-09 09:34:36,299 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-09 09:34:36,299 [INFO]: 	Creating the index 03/09/2025, 09:34:36
2025-03-09 09:34:36,299 [INFO]: 		-> Instanciate the index HNSW15 03/09/2025, 09:34:36
2025-03-09 09:34:36,301 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0012 secs
2025-03-09 09:34:36,301 [INFO]: 		-> Adding the vectors to the index 03/09/2025, 09:34:36
2025-03-09 09:34:36,301 [INFO]: The memory available for adding the vectors is 49.2GB(total available - used by the index)
2025-03-09 09:34:36,301 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/17 [00:00<?, ?it/s]  6%|▌         | 1/17 [00:00<00:03,  5.11it/s] 12%|█▏        | 2/17 [00:00<00:02,  6.84it/s] 18%|█▊        | 3/17 [00:00<00:01,  7.56it/s] 29%|██▉       | 5/17 [00:00<00:01,  8.63it/s] 47%|████▋     | 8/17 [00:00<00:00, 12.77it/s] 65%|██████▍   | 11/17 [00:00<00:00, 14.93it/s] 82%|████████▏ | 14/17 [00:01<00:00, 17.95it/s]100%|██████████| 17/17 [00:03<00:00,  2.61it/s]100%|██████████| 17/17 [00:03<00:00,  4.27it/s]
2025-03-09 09:34:40,286 [INFO]: 	Computing best hyperparameters for index knn.index 03/09/2025, 09:34:40
2025-03-09 09:35:27,577 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 47.2899 secs
2025-03-09 09:35:27,577 [INFO]: The best hyperparameters are: efSearch=258
2025-03-09 09:35:27,577 [INFO]: 	Compute fast metrics 03/09/2025, 09:35:27
  0%|          | 0/4 [00:00<?, ?it/s] 25%|██▌       | 1/4 [00:00<00:00,  6.33it/s] 75%|███████▌  | 3/4 [00:00<00:00,  9.11it/s] 75%|███████▌  | 3/4 [00:00<00:00,  6.89it/s]
2025-03-09 09:35:43,353 [INFO]: 	>>> Finished "Compute fast metrics" in 15.7760 secs
2025-03-09 09:35:43,356 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 67.0549 secs
2025-03-09 09:35:43,356 [INFO]: {
2025-03-09 09:35:43,356 [INFO]: 	index_key: HNSW15
2025-03-09 09:35:43,356 [INFO]: 	index_param: efSearch=258
2025-03-09 09:35:43,356 [INFO]: 	index_path: knn.index
2025-03-09 09:35:43,356 [INFO]: 	size in bytes: 834391390
2025-03-09 09:35:43,356 [INFO]: 	avg_search_speed_ms: 9.151449457044421
2025-03-09 09:35:43,356 [INFO]: 	99p_search_speed_ms: 12.671902198344469
2025-03-09 09:35:43,356 [INFO]: 	reconstruction error %: 0.0
2025-03-09 09:35:43,356 [INFO]: 	nb vectors: 4241
2025-03-09 09:35:43,356 [INFO]: 	vectors dimension: 49152
2025-03-09 09:35:43,356 [INFO]: 	compression ratio: 0.99930864339336
2025-03-09 09:35:43,356 [INFO]: }
2025-03-09 09:35:43,356 [INFO]: 	>>> Finished "Creating the index" in 67.0566 secs
2025-03-09 09:35:43,356 [INFO]: >>> Finished "Launching the whole pipeline" in 67.0825 secs
2025-03-09 09:35:45: [retrieval_preprocessing] calculating distances ...
2025-03-09 09:35:46: [retrieval_preprocessing] finished and saved retrieval indices for episode 49164 [episode count 6/20]
[retrieval_preprocessing] for episode 50191 [episode count 7/20], we have num_retrieval=np.int64(4349) num_query=np.int64(248)
2025-03-09 09:35:48,390 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-09 09:35:49,042 [INFO]: Launching the whole pipeline 03/09/2025, 09:35:49
2025-03-09 09:35:49,042 [INFO]: Reading total number of vectors and dimension 03/09/2025, 09:35:49
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1754.20it/s]
2025-03-09 09:35:49,066 [INFO]: There are 4349 embeddings of dim 49152
2025-03-09 09:35:49,066 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0241 secs
2025-03-09 09:35:49,067 [INFO]: 	Compute estimated construction time of the index 03/09/2025, 09:35:49
2025-03-09 09:35:49,067 [INFO]: 		-> Train: 16.7 minutes
2025-03-09 09:35:49,067 [INFO]: 		-> Add: 2.4 seconds
2025-03-09 09:35:49,067 [INFO]: 		Total: 16.7 minutes
2025-03-09 09:35:49,067 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0003 secs
2025-03-09 09:35:49,067 [INFO]: 	Checking that your have enough memory available to create the index 03/09/2025, 09:35:49
2025-03-09 09:35:49,067 [INFO]: 897.5MB of memory will be needed to build the index (more might be used if you have more)
2025-03-09 09:35:49,067 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0001 secs
2025-03-09 09:35:49,067 [INFO]: 	Selecting most promising index types given data characteristics 03/09/2025, 09:35:49
2025-03-09 09:35:49,067 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-09 09:35:49,067 [INFO]: 	Creating the index 03/09/2025, 09:35:49
2025-03-09 09:35:49,067 [INFO]: 		-> Instanciate the index HNSW15 03/09/2025, 09:35:49
2025-03-09 09:35:49,068 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0012 secs
2025-03-09 09:35:49,068 [INFO]: 		-> Adding the vectors to the index 03/09/2025, 09:35:49
2025-03-09 09:35:49,069 [INFO]: The memory available for adding the vectors is 49.2GB(total available - used by the index)
2025-03-09 09:35:49,069 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/18 [00:00<?, ?it/s]  6%|▌         | 1/18 [00:00<00:02,  6.03it/s] 33%|███▎      | 6/18 [00:00<00:00, 24.75it/s] 61%|██████    | 11/18 [00:00<00:00, 32.52it/s] 83%|████████▎ | 15/18 [00:00<00:00, 31.54it/s]100%|██████████| 18/18 [00:03<00:00,  5.57it/s]
2025-03-09 09:35:52,304 [INFO]: 	Computing best hyperparameters for index knn.index 03/09/2025, 09:35:52
2025-03-09 09:36:35,074 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 42.7692 secs
2025-03-09 09:36:35,074 [INFO]: The best hyperparameters are: efSearch=239
2025-03-09 09:36:35,074 [INFO]: 	Compute fast metrics 03/09/2025, 09:36:35
  0%|          | 0/4 [00:00<?, ?it/s] 25%|██▌       | 1/4 [00:00<00:00,  5.28it/s] 50%|█████     | 2/4 [00:00<00:00,  6.94it/s] 75%|███████▌  | 3/4 [00:00<00:00,  7.77it/s] 75%|███████▌  | 3/4 [00:00<00:00,  5.82it/s]
2025-03-09 09:36:52,303 [INFO]: 	>>> Finished "Compute fast metrics" in 17.2287 secs
2025-03-09 09:36:52,417 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 63.3483 secs
2025-03-09 09:36:52,417 [INFO]: {
2025-03-09 09:36:52,417 [INFO]: 	index_key: HNSW15
2025-03-09 09:36:52,417 [INFO]: 	index_param: efSearch=239
2025-03-09 09:36:52,417 [INFO]: 	index_path: knn.index
2025-03-09 09:36:52,417 [INFO]: 	size in bytes: 855639850
2025-03-09 09:36:52,417 [INFO]: 	avg_search_speed_ms: 9.69570356639776
2025-03-09 09:36:52,418 [INFO]: 	99p_search_speed_ms: 18.311796826310466
2025-03-09 09:36:52,418 [INFO]: 	reconstruction error %: 0.0
2025-03-09 09:36:52,418 [INFO]: 	nb vectors: 4349
2025-03-09 09:36:52,418 [INFO]: 	vectors dimension: 49152
2025-03-09 09:36:52,418 [INFO]: 	compression ratio: 0.9993085198170703
2025-03-09 09:36:52,418 [INFO]: }
2025-03-09 09:36:52,418 [INFO]: 	>>> Finished "Creating the index" in 63.3506 secs
2025-03-09 09:36:52,418 [INFO]: >>> Finished "Launching the whole pipeline" in 63.3756 secs
2025-03-09 09:36:53: [retrieval_preprocessing] calculating distances ...
2025-03-09 09:36:54: [retrieval_preprocessing] finished and saved retrieval indices for episode 50191 [episode count 7/20]
[retrieval_preprocessing] for episode 67091 [episode count 8/20], we have num_retrieval=np.int64(4359) num_query=np.int64(238)
2025-03-09 09:36:55,748 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-09 09:36:56,375 [INFO]: Launching the whole pipeline 03/09/2025, 09:36:56
2025-03-09 09:36:56,375 [INFO]: Reading total number of vectors and dimension 03/09/2025, 09:36:56
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 2041.02it/s]
2025-03-09 09:36:56,402 [INFO]: There are 4359 embeddings of dim 49152
2025-03-09 09:36:56,403 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0278 secs
2025-03-09 09:36:56,403 [INFO]: 	Compute estimated construction time of the index 03/09/2025, 09:36:56
2025-03-09 09:36:56,403 [INFO]: 		-> Train: 16.7 minutes
2025-03-09 09:36:56,403 [INFO]: 		-> Add: 2.4 seconds
2025-03-09 09:36:56,403 [INFO]: 		Total: 16.7 minutes
2025-03-09 09:36:56,403 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0003 secs
2025-03-09 09:36:56,404 [INFO]: 	Checking that your have enough memory available to create the index 03/09/2025, 09:36:56
2025-03-09 09:36:56,404 [INFO]: 899.6MB of memory will be needed to build the index (more might be used if you have more)
2025-03-09 09:36:56,404 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0004 secs
2025-03-09 09:36:56,404 [INFO]: 	Selecting most promising index types given data characteristics 03/09/2025, 09:36:56
2025-03-09 09:36:56,404 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-09 09:36:56,404 [INFO]: 	Creating the index 03/09/2025, 09:36:56
2025-03-09 09:36:56,405 [INFO]: 		-> Instanciate the index HNSW15 03/09/2025, 09:36:56
2025-03-09 09:36:56,407 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0028 secs
2025-03-09 09:36:56,408 [INFO]: 		-> Adding the vectors to the index 03/09/2025, 09:36:56
2025-03-09 09:36:56,408 [INFO]: The memory available for adding the vectors is 49.2GB(total available - used by the index)
2025-03-09 09:36:56,408 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/18 [00:00<?, ?it/s]  6%|▌         | 1/18 [00:00<00:03,  5.57it/s] 17%|█▋        | 3/18 [00:00<00:01,  8.62it/s] 28%|██▊       | 5/18 [00:00<00:01, 10.10it/s] 39%|███▉      | 7/18 [00:00<00:00, 11.07it/s] 50%|█████     | 9/18 [00:00<00:00, 12.80it/s] 61%|██████    | 11/18 [00:00<00:00, 13.61it/s] 72%|███████▏  | 13/18 [00:01<00:00, 13.27it/s] 83%|████████▎ | 15/18 [00:01<00:00, 13.16it/s] 94%|█████████▍| 17/18 [00:01<00:00, 12.94it/s]100%|██████████| 18/18 [00:04<00:00,  4.44it/s]
2025-03-09 09:37:00,467 [INFO]: 	Computing best hyperparameters for index knn.index 03/09/2025, 09:37:00
2025-03-09 09:37:49,307 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 48.8394 secs
2025-03-09 09:37:49,308 [INFO]: The best hyperparameters are: efSearch=224
2025-03-09 09:37:49,308 [INFO]: 	Compute fast metrics 03/09/2025, 09:37:49
  0%|          | 0/4 [00:00<?, ?it/s] 25%|██▌       | 1/4 [00:00<00:00,  4.28it/s] 50%|█████     | 2/4 [00:00<00:00,  5.96it/s] 75%|███████▌  | 3/4 [00:00<00:00,  6.73it/s] 75%|███████▌  | 3/4 [00:00<00:00,  5.01it/s]
2025-03-09 09:38:06,458 [INFO]: 	>>> Finished "Compute fast metrics" in 17.1507 secs
2025-03-09 09:38:06,461 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 70.0532 secs
2025-03-09 09:38:06,461 [INFO]: {
2025-03-09 09:38:06,461 [INFO]: 	index_key: HNSW15
2025-03-09 09:38:06,461 [INFO]: 	index_param: efSearch=224
2025-03-09 09:38:06,461 [INFO]: 	index_path: knn.index
2025-03-09 09:38:06,461 [INFO]: 	size in bytes: 857607250
2025-03-09 09:38:06,461 [INFO]: 	avg_search_speed_ms: 8.60960017304152
2025-03-09 09:38:06,461 [INFO]: 	99p_search_speed_ms: 17.925177654251584
2025-03-09 09:38:06,461 [INFO]: 	reconstruction error %: 0.0
2025-03-09 09:38:06,461 [INFO]: 	nb vectors: 4359
2025-03-09 09:38:06,461 [INFO]: 	vectors dimension: 49152
2025-03-09 09:38:06,461 [INFO]: 	compression ratio: 0.999308566946
2025-03-09 09:38:06,461 [INFO]: }
2025-03-09 09:38:06,461 [INFO]: 	>>> Finished "Creating the index" in 70.0569 secs
2025-03-09 09:38:06,461 [INFO]: >>> Finished "Launching the whole pipeline" in 70.0865 secs
2025-03-09 09:38:07: [retrieval_preprocessing] calculating distances ...
2025-03-09 09:38:08: [retrieval_preprocessing] finished and saved retrieval indices for episode 67091 [episode count 8/20]
[retrieval_preprocessing] for episode 45589 [episode count 9/20], we have num_retrieval=np.int64(4333) num_query=np.int64(264)
2025-03-09 09:38:09,552 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-09 09:38:10,092 [INFO]: Launching the whole pipeline 03/09/2025, 09:38:10
2025-03-09 09:38:10,092 [INFO]: Reading total number of vectors and dimension 03/09/2025, 09:38:10
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1779.51it/s]
2025-03-09 09:38:10,115 [INFO]: There are 4333 embeddings of dim 49152
2025-03-09 09:38:10,115 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0236 secs
2025-03-09 09:38:10,115 [INFO]: 	Compute estimated construction time of the index 03/09/2025, 09:38:10
2025-03-09 09:38:10,116 [INFO]: 		-> Train: 16.7 minutes
2025-03-09 09:38:10,116 [INFO]: 		-> Add: 2.4 seconds
2025-03-09 09:38:10,116 [INFO]: 		Total: 16.7 minutes
2025-03-09 09:38:10,116 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0001 secs
2025-03-09 09:38:10,116 [INFO]: 	Checking that your have enough memory available to create the index 03/09/2025, 09:38:10
2025-03-09 09:38:10,116 [INFO]: 894.2MB of memory will be needed to build the index (more might be used if you have more)
2025-03-09 09:38:10,116 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0001 secs
2025-03-09 09:38:10,116 [INFO]: 	Selecting most promising index types given data characteristics 03/09/2025, 09:38:10
2025-03-09 09:38:10,116 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-09 09:38:10,116 [INFO]: 	Creating the index 03/09/2025, 09:38:10
2025-03-09 09:38:10,116 [INFO]: 		-> Instanciate the index HNSW15 03/09/2025, 09:38:10
2025-03-09 09:38:10,117 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0010 secs
2025-03-09 09:38:10,117 [INFO]: 		-> Adding the vectors to the index 03/09/2025, 09:38:10
2025-03-09 09:38:10,117 [INFO]: The memory available for adding the vectors is 49.2GB(total available - used by the index)
2025-03-09 09:38:10,117 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/18 [00:00<?, ?it/s]  6%|▌         | 1/18 [00:00<00:02,  6.38it/s] 17%|█▋        | 3/18 [00:00<00:01, 10.12it/s] 28%|██▊       | 5/18 [00:00<00:01, 11.81it/s] 39%|███▉      | 7/18 [00:00<00:00, 13.23it/s] 50%|█████     | 9/18 [00:00<00:00, 13.01it/s] 61%|██████    | 11/18 [00:00<00:00, 12.84it/s] 72%|███████▏  | 13/18 [00:01<00:00, 12.64it/s] 83%|████████▎ | 15/18 [00:01<00:00, 12.60it/s] 94%|█████████▍| 17/18 [00:01<00:00, 12.59it/s]100%|██████████| 18/18 [00:03<00:00,  4.61it/s]
2025-03-09 09:38:14,029 [INFO]: 	Computing best hyperparameters for index knn.index 03/09/2025, 09:38:14
2025-03-09 09:38:55,894 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 41.8648 secs
2025-03-09 09:38:55,894 [INFO]: The best hyperparameters are: efSearch=239
2025-03-09 09:38:55,895 [INFO]: 	Compute fast metrics 03/09/2025, 09:38:55
  0%|          | 0/4 [00:00<?, ?it/s] 25%|██▌       | 1/4 [00:00<00:00,  6.37it/s] 75%|███████▌  | 3/4 [00:00<00:00,  9.18it/s] 75%|███████▌  | 3/4 [00:00<00:00,  7.04it/s]
2025-03-09 09:39:16,518 [INFO]: 	>>> Finished "Compute fast metrics" in 20.6236 secs
2025-03-09 09:39:16,521 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 66.4039 secs
2025-03-09 09:39:16,521 [INFO]: {
2025-03-09 09:39:16,521 [INFO]: 	index_key: HNSW15
2025-03-09 09:39:16,521 [INFO]: 	index_param: efSearch=239
2025-03-09 09:39:16,521 [INFO]: 	index_path: knn.index
2025-03-09 09:39:16,521 [INFO]: 	size in bytes: 852491890
2025-03-09 09:39:16,521 [INFO]: 	avg_search_speed_ms: 9.647573913351463
2025-03-09 09:39:16,521 [INFO]: 	99p_search_speed_ms: 17.950544804334648
2025-03-09 09:39:16,521 [INFO]: 	reconstruction error %: 0.0
2025-03-09 09:39:16,521 [INFO]: 	nb vectors: 4333
2025-03-09 09:39:16,521 [INFO]: 	vectors dimension: 49152
2025-03-09 09:39:16,521 [INFO]: 	compression ratio: 0.9993085846247757
2025-03-09 09:39:16,521 [INFO]: }
2025-03-09 09:39:16,521 [INFO]: 	>>> Finished "Creating the index" in 66.4053 secs
2025-03-09 09:39:16,521 [INFO]: >>> Finished "Launching the whole pipeline" in 66.4295 secs
2025-03-09 09:39:18: [retrieval_preprocessing] calculating distances ...
2025-03-09 09:39:18: [retrieval_preprocessing] finished and saved retrieval indices for episode 45589 [episode count 9/20]
[retrieval_preprocessing] for episode 1560 [episode count 10/20], we have num_retrieval=np.int64(4316) num_query=np.int64(281)
2025-03-09 09:39:20,373 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-09 09:39:20,964 [INFO]: Launching the whole pipeline 03/09/2025, 09:39:20
2025-03-09 09:39:20,964 [INFO]: Reading total number of vectors and dimension 03/09/2025, 09:39:20
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 2222.74it/s]
2025-03-09 09:39:20,988 [INFO]: There are 4316 embeddings of dim 49152
2025-03-09 09:39:20,988 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0237 secs
2025-03-09 09:39:20,988 [INFO]: 	Compute estimated construction time of the index 03/09/2025, 09:39:20
2025-03-09 09:39:20,988 [INFO]: 		-> Train: 16.7 minutes
2025-03-09 09:39:20,988 [INFO]: 		-> Add: 2.4 seconds
2025-03-09 09:39:20,988 [INFO]: 		Total: 16.7 minutes
2025-03-09 09:39:20,988 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0001 secs
2025-03-09 09:39:20,988 [INFO]: 	Checking that your have enough memory available to create the index 03/09/2025, 09:39:20
2025-03-09 09:39:20,988 [INFO]: 890.7MB of memory will be needed to build the index (more might be used if you have more)
2025-03-09 09:39:20,988 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0001 secs
2025-03-09 09:39:20,988 [INFO]: 	Selecting most promising index types given data characteristics 03/09/2025, 09:39:20
2025-03-09 09:39:20,988 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-09 09:39:20,988 [INFO]: 	Creating the index 03/09/2025, 09:39:20
2025-03-09 09:39:20,988 [INFO]: 		-> Instanciate the index HNSW15 03/09/2025, 09:39:20
2025-03-09 09:39:20,989 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0008 secs
2025-03-09 09:39:20,989 [INFO]: 		-> Adding the vectors to the index 03/09/2025, 09:39:20
2025-03-09 09:39:20,989 [INFO]: The memory available for adding the vectors is 49.2GB(total available - used by the index)
2025-03-09 09:39:20,989 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/17 [00:00<?, ?it/s]  6%|▌         | 1/17 [00:00<00:03,  4.99it/s] 12%|█▏        | 2/17 [00:00<00:02,  6.66it/s] 18%|█▊        | 3/17 [00:00<00:01,  7.42it/s] 24%|██▎       | 4/17 [00:00<00:01,  7.97it/s] 29%|██▉       | 5/17 [00:00<00:01,  8.26it/s] 35%|███▌      | 6/17 [00:00<00:01,  8.41it/s] 41%|████      | 7/17 [00:00<00:01,  8.47it/s] 47%|████▋     | 8/17 [00:01<00:01,  8.46it/s] 53%|█████▎    | 9/17 [00:01<00:00,  8.57it/s] 59%|█████▉    | 10/17 [00:01<00:00,  8.73it/s] 65%|██████▍   | 11/17 [00:01<00:00,  8.68it/s] 71%|███████   | 12/17 [00:01<00:00,  8.54it/s] 76%|███████▋  | 13/17 [00:01<00:00,  8.38it/s] 82%|████████▏ | 14/17 [00:01<00:00,  8.37it/s] 94%|█████████▍| 16/17 [00:01<00:00, 10.24it/s]100%|██████████| 17/17 [00:04<00:00,  3.61it/s]
2025-03-09 09:39:25,702 [INFO]: 	Computing best hyperparameters for index knn.index 03/09/2025, 09:39:25
2025-03-09 09:40:07,391 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 41.6884 secs
2025-03-09 09:40:07,391 [INFO]: The best hyperparameters are: efSearch=278
2025-03-09 09:40:07,391 [INFO]: 	Compute fast metrics 03/09/2025, 09:40:07
  0%|          | 0/4 [00:00<?, ?it/s] 25%|██▌       | 1/4 [00:00<00:00,  5.12it/s] 50%|█████     | 2/4 [00:00<00:00,  6.87it/s] 75%|███████▌  | 3/4 [00:00<00:00,  7.77it/s] 75%|███████▌  | 3/4 [00:00<00:00,  5.77it/s]
2025-03-09 09:40:28,830 [INFO]: 	>>> Finished "Compute fast metrics" in 21.4387 secs
2025-03-09 09:40:28,833 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 67.8441 secs
2025-03-09 09:40:28,833 [INFO]: {
2025-03-09 09:40:28,833 [INFO]: 	index_key: HNSW15
2025-03-09 09:40:28,833 [INFO]: 	index_param: efSearch=278
2025-03-09 09:40:28,833 [INFO]: 	index_path: knn.index
2025-03-09 09:40:28,833 [INFO]: 	size in bytes: 849147190
2025-03-09 09:40:28,833 [INFO]: 	avg_search_speed_ms: 11.668929436256024
2025-03-09 09:40:28,833 [INFO]: 	99p_search_speed_ms: 22.949267849326127
2025-03-09 09:40:28,833 [INFO]: 	reconstruction error %: 0.0
2025-03-09 09:40:28,833 [INFO]: 	nb vectors: 4316
2025-03-09 09:40:28,833 [INFO]: 	vectors dimension: 49152
2025-03-09 09:40:28,833 [INFO]: 	compression ratio: 0.9993086451831749
2025-03-09 09:40:28,834 [INFO]: }
2025-03-09 09:40:28,834 [INFO]: 	>>> Finished "Creating the index" in 67.8453 secs
2025-03-09 09:40:28,834 [INFO]: >>> Finished "Launching the whole pipeline" in 67.8695 secs
2025-03-09 09:40:30: [retrieval_preprocessing] calculating distances ...
2025-03-09 09:40:30: [retrieval_preprocessing] finished and saved retrieval indices for episode 1560 [episode count 10/20]
[retrieval_preprocessing] for episode 70168 [episode count 11/20], we have num_retrieval=np.int64(4299) num_query=np.int64(298)
2025-03-09 09:40:32,375 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-09 09:40:33,386 [INFO]: Launching the whole pipeline 03/09/2025, 09:40:33
2025-03-09 09:40:33,386 [INFO]: Reading total number of vectors and dimension 03/09/2025, 09:40:33
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1119.97it/s]
2025-03-09 09:40:33,413 [INFO]: There are 4299 embeddings of dim 49152
2025-03-09 09:40:33,413 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0269 secs
2025-03-09 09:40:33,413 [INFO]: 	Compute estimated construction time of the index 03/09/2025, 09:40:33
2025-03-09 09:40:33,413 [INFO]: 		-> Train: 16.7 minutes
2025-03-09 09:40:33,413 [INFO]: 		-> Add: 2.4 seconds
2025-03-09 09:40:33,413 [INFO]: 		Total: 16.7 minutes
2025-03-09 09:40:33,413 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0001 secs
2025-03-09 09:40:33,413 [INFO]: 	Checking that your have enough memory available to create the index 03/09/2025, 09:40:33
2025-03-09 09:40:33,413 [INFO]: 887.2MB of memory will be needed to build the index (more might be used if you have more)
2025-03-09 09:40:33,413 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0001 secs
2025-03-09 09:40:33,413 [INFO]: 	Selecting most promising index types given data characteristics 03/09/2025, 09:40:33
2025-03-09 09:40:33,413 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-09 09:40:33,413 [INFO]: 	Creating the index 03/09/2025, 09:40:33
2025-03-09 09:40:33,413 [INFO]: 		-> Instanciate the index HNSW15 03/09/2025, 09:40:33
2025-03-09 09:40:33,414 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0010 secs
2025-03-09 09:40:33,415 [INFO]: 		-> Adding the vectors to the index 03/09/2025, 09:40:33
2025-03-09 09:40:33,415 [INFO]: The memory available for adding the vectors is 49.2GB(total available - used by the index)
2025-03-09 09:40:33,415 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/17 [00:00<?, ?it/s]  6%|▌         | 1/17 [00:00<00:02,  5.60it/s] 18%|█▊        | 3/17 [00:00<00:01,  8.48it/s] 29%|██▉       | 5/17 [00:00<00:01,  9.36it/s] 41%|████      | 7/17 [00:00<00:01,  9.97it/s] 53%|█████▎    | 9/17 [00:00<00:00, 10.11it/s] 65%|██████▍   | 11/17 [00:01<00:00, 10.94it/s] 76%|███████▋  | 13/17 [00:01<00:00, 12.37it/s] 88%|████████▊ | 15/17 [00:01<00:00, 12.57it/s]100%|██████████| 17/17 [00:04<00:00,  1.96it/s]100%|██████████| 17/17 [00:04<00:00,  3.99it/s]
2025-03-09 09:40:37,686 [INFO]: 	Computing best hyperparameters for index knn.index 03/09/2025, 09:40:37
2025-03-09 09:41:20,597 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 42.9106 secs
2025-03-09 09:41:20,598 [INFO]: The best hyperparameters are: efSearch=271
2025-03-09 09:41:20,598 [INFO]: 	Compute fast metrics 03/09/2025, 09:41:20
  0%|          | 0/4 [00:00<?, ?it/s] 25%|██▌       | 1/4 [00:00<00:00,  6.42it/s] 75%|███████▌  | 3/4 [00:00<00:00, 12.14it/s] 75%|███████▌  | 3/4 [00:00<00:00,  9.09it/s]
2025-03-09 09:41:39,871 [INFO]: 	>>> Finished "Compute fast metrics" in 19.2737 secs
2025-03-09 09:41:40,393 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 66.9787 secs
2025-03-09 09:41:40,394 [INFO]: {
2025-03-09 09:41:40,394 [INFO]: 	index_key: HNSW15
2025-03-09 09:41:40,394 [INFO]: 	index_param: efSearch=271
2025-03-09 09:41:40,394 [INFO]: 	index_path: knn.index
2025-03-09 09:41:40,394 [INFO]: 	size in bytes: 845802550
2025-03-09 09:41:40,394 [INFO]: 	avg_search_speed_ms: 9.746668739135416
2025-03-09 09:41:40,394 [INFO]: 	99p_search_speed_ms: 15.271359239704907
2025-03-09 09:41:40,394 [INFO]: 	reconstruction error %: 0.0
2025-03-09 09:41:40,394 [INFO]: 	nb vectors: 4299
2025-03-09 09:41:40,394 [INFO]: 	vectors dimension: 49152
2025-03-09 09:41:40,394 [INFO]: 	compression ratio: 0.9993086353310238
2025-03-09 09:41:40,394 [INFO]: }
2025-03-09 09:41:40,394 [INFO]: 	>>> Finished "Creating the index" in 66.9808 secs
2025-03-09 09:41:40,394 [INFO]: >>> Finished "Launching the whole pipeline" in 67.0084 secs
2025-03-09 09:41:42: [retrieval_preprocessing] calculating distances ...
2025-03-09 09:41:43: [retrieval_preprocessing] finished and saved retrieval indices for episode 70168 [episode count 11/20]
[retrieval_preprocessing] for episode 81433 [episode count 12/20], we have num_retrieval=np.int64(4328) num_query=np.int64(269)
2025-03-09 09:41:44,308 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-09 09:41:44,988 [INFO]: Launching the whole pipeline 03/09/2025, 09:41:44
2025-03-09 09:41:44,988 [INFO]: Reading total number of vectors and dimension 03/09/2025, 09:41:44
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1361.35it/s]
2025-03-09 09:41:45,263 [INFO]: There are 4328 embeddings of dim 49152
2025-03-09 09:41:45,263 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.2751 secs
2025-03-09 09:41:45,263 [INFO]: 	Compute estimated construction time of the index 03/09/2025, 09:41:45
2025-03-09 09:41:45,263 [INFO]: 		-> Train: 16.7 minutes
2025-03-09 09:41:45,263 [INFO]: 		-> Add: 2.4 seconds
2025-03-09 09:41:45,263 [INFO]: 		Total: 16.7 minutes
2025-03-09 09:41:45,263 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0002 secs
2025-03-09 09:41:45,263 [INFO]: 	Checking that your have enough memory available to create the index 03/09/2025, 09:41:45
2025-03-09 09:41:45,264 [INFO]: 893.2MB of memory will be needed to build the index (more might be used if you have more)
2025-03-09 09:41:45,264 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0003 secs
2025-03-09 09:41:45,264 [INFO]: 	Selecting most promising index types given data characteristics 03/09/2025, 09:41:45
2025-03-09 09:41:45,264 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-09 09:41:45,264 [INFO]: 	Creating the index 03/09/2025, 09:41:45
2025-03-09 09:41:45,264 [INFO]: 		-> Instanciate the index HNSW15 03/09/2025, 09:41:45
2025-03-09 09:41:45,266 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0022 secs
2025-03-09 09:41:45,267 [INFO]: 		-> Adding the vectors to the index 03/09/2025, 09:41:45
2025-03-09 09:41:45,267 [INFO]: The memory available for adding the vectors is 49.2GB(total available - used by the index)
2025-03-09 09:41:45,267 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/18 [00:00<?, ?it/s]  6%|▌         | 1/18 [00:00<00:03,  5.00it/s] 11%|█         | 2/18 [00:00<00:02,  6.94it/s] 17%|█▋        | 3/18 [00:00<00:01,  7.78it/s] 22%|██▏       | 4/18 [00:00<00:01,  8.25it/s] 28%|██▊       | 5/18 [00:00<00:01,  8.36it/s] 39%|███▉      | 7/18 [00:00<00:01,  9.45it/s] 50%|█████     | 9/18 [00:01<00:00,  9.79it/s] 61%|██████    | 11/18 [00:01<00:00,  9.99it/s] 72%|███████▏  | 13/18 [00:01<00:00, 10.45it/s] 83%|████████▎ | 15/18 [00:01<00:00, 10.56it/s] 94%|█████████▍| 17/18 [00:01<00:00, 10.41it/s]100%|██████████| 18/18 [00:04<00:00,  3.66it/s]
2025-03-09 09:41:50,191 [INFO]: 	Computing best hyperparameters for index knn.index 03/09/2025, 09:41:50
2025-03-09 09:42:36,776 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 46.5846 secs
2025-03-09 09:42:36,776 [INFO]: The best hyperparameters are: efSearch=246
2025-03-09 09:42:36,776 [INFO]: 	Compute fast metrics 03/09/2025, 09:42:36
  0%|          | 0/4 [00:00<?, ?it/s] 25%|██▌       | 1/4 [00:00<00:00,  5.59it/s] 50%|█████     | 2/4 [00:00<00:00,  7.12it/s] 75%|███████▌  | 3/4 [00:00<00:00,  7.86it/s] 75%|███████▌  | 3/4 [00:00<00:00,  5.94it/s]
2025-03-09 09:42:56,612 [INFO]: 	>>> Finished "Compute fast metrics" in 19.8352 secs
2025-03-09 09:42:56,614 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 71.3477 secs
2025-03-09 09:42:56,615 [INFO]: {
2025-03-09 09:42:56,615 [INFO]: 	index_key: HNSW15
2025-03-09 09:42:56,615 [INFO]: 	index_param: efSearch=246
2025-03-09 09:42:56,615 [INFO]: 	index_path: knn.index
2025-03-09 09:42:56,615 [INFO]: 	size in bytes: 851508130
2025-03-09 09:42:56,615 [INFO]: 	avg_search_speed_ms: 10.653623725913457
2025-03-09 09:42:56,615 [INFO]: 	99p_search_speed_ms: 22.615361148491502
2025-03-09 09:42:56,615 [INFO]: 	reconstruction error %: 0.0
2025-03-09 09:42:56,615 [INFO]: 	nb vectors: 4328
2025-03-09 09:42:56,615 [INFO]: 	vectors dimension: 49152
2025-03-09 09:42:56,615 [INFO]: 	compression ratio: 0.9993086313808889
2025-03-09 09:42:56,615 [INFO]: }
2025-03-09 09:42:56,615 [INFO]: 	>>> Finished "Creating the index" in 71.3506 secs
2025-03-09 09:42:56,615 [INFO]: >>> Finished "Launching the whole pipeline" in 71.6271 secs
2025-03-09 09:42:58: [retrieval_preprocessing] calculating distances ...
2025-03-09 09:42:59: [retrieval_preprocessing] finished and saved retrieval indices for episode 81433 [episode count 12/20]
[retrieval_preprocessing] for episode 85019 [episode count 13/20], we have num_retrieval=np.int64(4419) num_query=np.int64(178)
2025-03-09 09:43:00,458 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-09 09:43:01,059 [INFO]: Launching the whole pipeline 03/09/2025, 09:43:01
2025-03-09 09:43:01,059 [INFO]: Reading total number of vectors and dimension 03/09/2025, 09:43:01
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1168.33it/s]
2025-03-09 09:43:01,087 [INFO]: There are 4419 embeddings of dim 49152
2025-03-09 09:43:01,088 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0287 secs
2025-03-09 09:43:01,088 [INFO]: 	Compute estimated construction time of the index 03/09/2025, 09:43:01
2025-03-09 09:43:01,088 [INFO]: 		-> Train: 16.7 minutes
2025-03-09 09:43:01,088 [INFO]: 		-> Add: 2.4 seconds
2025-03-09 09:43:01,088 [INFO]: 		Total: 16.7 minutes
2025-03-09 09:43:01,088 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0002 secs
2025-03-09 09:43:01,088 [INFO]: 	Checking that your have enough memory available to create the index 03/09/2025, 09:43:01
2025-03-09 09:43:01,088 [INFO]: 912.0MB of memory will be needed to build the index (more might be used if you have more)
2025-03-09 09:43:01,088 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0002 secs
2025-03-09 09:43:01,088 [INFO]: 	Selecting most promising index types given data characteristics 03/09/2025, 09:43:01
2025-03-09 09:43:01,088 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-09 09:43:01,088 [INFO]: 	Creating the index 03/09/2025, 09:43:01
2025-03-09 09:43:01,088 [INFO]: 		-> Instanciate the index HNSW15 03/09/2025, 09:43:01
2025-03-09 09:43:01,089 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0010 secs
2025-03-09 09:43:01,089 [INFO]: 		-> Adding the vectors to the index 03/09/2025, 09:43:01
2025-03-09 09:43:01,089 [INFO]: The memory available for adding the vectors is 49.2GB(total available - used by the index)
2025-03-09 09:43:01,089 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/18 [00:00<?, ?it/s]  6%|▌         | 1/18 [00:00<00:02,  6.09it/s] 17%|█▋        | 3/18 [00:00<00:01,  9.76it/s] 28%|██▊       | 5/18 [00:00<00:01, 10.91it/s] 39%|███▉      | 7/18 [00:00<00:00, 11.46it/s] 50%|█████     | 9/18 [00:00<00:00, 11.37it/s] 61%|██████    | 11/18 [00:01<00:00,  9.12it/s] 67%|██████▋   | 12/18 [00:01<00:00,  7.96it/s] 72%|███████▏  | 13/18 [00:01<00:00,  7.69it/s] 78%|███████▊  | 14/18 [00:01<00:00,  7.90it/s] 83%|████████▎ | 15/18 [00:01<00:00,  7.92it/s] 94%|█████████▍| 17/18 [00:01<00:00,  9.33it/s]100%|██████████| 18/18 [00:04<00:00,  1.37it/s]100%|██████████| 18/18 [00:04<00:00,  3.86it/s]
2025-03-09 09:43:05,751 [INFO]: 	Computing best hyperparameters for index knn.index 03/09/2025, 09:43:05
2025-03-09 09:43:44,807 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 39.0552 secs
2025-03-09 09:43:44,807 [INFO]: The best hyperparameters are: efSearch=280
2025-03-09 09:43:44,807 [INFO]: 	Compute fast metrics 03/09/2025, 09:43:44
  0%|          | 0/4 [00:00<?, ?it/s] 25%|██▌       | 1/4 [00:00<00:00,  5.59it/s] 50%|█████     | 2/4 [00:00<00:00,  7.03it/s] 75%|███████▌  | 3/4 [00:00<00:00,  7.56it/s] 75%|███████▌  | 3/4 [00:00<00:00,  5.75it/s]
2025-03-09 09:44:12,235 [INFO]: 	>>> Finished "Compute fast metrics" in 27.4281 secs
2025-03-09 09:44:12,238 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 71.1489 secs
2025-03-09 09:44:12,238 [INFO]: {
2025-03-09 09:44:12,238 [INFO]: 	index_key: HNSW15
2025-03-09 09:44:12,238 [INFO]: 	index_param: efSearch=280
2025-03-09 09:44:12,238 [INFO]: 	index_path: knn.index
2025-03-09 09:44:12,238 [INFO]: 	size in bytes: 869411890
2025-03-09 09:44:12,239 [INFO]: 	avg_search_speed_ms: 10.66437940836064
2025-03-09 09:44:12,239 [INFO]: 	99p_search_speed_ms: 19.455359436105937
2025-03-09 09:44:12,239 [INFO]: 	reconstruction error %: 0.0
2025-03-09 09:44:12,239 [INFO]: 	nb vectors: 4419
2025-03-09 09:44:12,239 [INFO]: 	vectors dimension: 49152
2025-03-09 09:44:12,239 [INFO]: 	compression ratio: 0.9993085693824593
2025-03-09 09:44:12,239 [INFO]: }
2025-03-09 09:44:12,239 [INFO]: 	>>> Finished "Creating the index" in 71.1504 secs
2025-03-09 09:44:12,239 [INFO]: >>> Finished "Launching the whole pipeline" in 71.1798 secs
2025-03-09 09:44:13: [retrieval_preprocessing] calculating distances ...
2025-03-09 09:44:14: [retrieval_preprocessing] finished and saved retrieval indices for episode 85019 [episode count 13/20]
[retrieval_preprocessing] for episode 47132 [episode count 14/20], we have num_retrieval=np.int64(4375) num_query=np.int64(222)
2025-03-09 09:44:15,550 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-09 09:44:16,261 [INFO]: Launching the whole pipeline 03/09/2025, 09:44:16
2025-03-09 09:44:16,261 [INFO]: Reading total number of vectors and dimension 03/09/2025, 09:44:16
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1207.34it/s]
2025-03-09 09:44:16,289 [INFO]: There are 4375 embeddings of dim 49152
2025-03-09 09:44:16,289 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0282 secs
2025-03-09 09:44:16,289 [INFO]: 	Compute estimated construction time of the index 03/09/2025, 09:44:16
2025-03-09 09:44:16,289 [INFO]: 		-> Train: 16.7 minutes
2025-03-09 09:44:16,289 [INFO]: 		-> Add: 2.4 seconds
2025-03-09 09:44:16,289 [INFO]: 		Total: 16.7 minutes
2025-03-09 09:44:16,289 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0001 secs
2025-03-09 09:44:16,289 [INFO]: 	Checking that your have enough memory available to create the index 03/09/2025, 09:44:16
2025-03-09 09:44:16,290 [INFO]: 902.9MB of memory will be needed to build the index (more might be used if you have more)
2025-03-09 09:44:16,290 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0002 secs
2025-03-09 09:44:16,290 [INFO]: 	Selecting most promising index types given data characteristics 03/09/2025, 09:44:16
2025-03-09 09:44:16,290 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-09 09:44:16,290 [INFO]: 	Creating the index 03/09/2025, 09:44:16
2025-03-09 09:44:16,290 [INFO]: 		-> Instanciate the index HNSW15 03/09/2025, 09:44:16
2025-03-09 09:44:16,291 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0012 secs
2025-03-09 09:44:16,291 [INFO]: 		-> Adding the vectors to the index 03/09/2025, 09:44:16
2025-03-09 09:44:16,291 [INFO]: The memory available for adding the vectors is 49.2GB(total available - used by the index)
2025-03-09 09:44:16,291 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/18 [00:00<?, ?it/s]  6%|▌         | 1/18 [00:00<00:03,  5.51it/s] 17%|█▋        | 3/18 [00:00<00:01,  8.64it/s] 22%|██▏       | 4/18 [00:00<00:01,  8.64it/s] 28%|██▊       | 5/18 [00:00<00:01,  8.55it/s] 33%|███▎      | 6/18 [00:00<00:01,  8.41it/s] 39%|███▉      | 7/18 [00:00<00:01,  8.56it/s] 44%|████▍     | 8/18 [00:00<00:01,  8.58it/s] 50%|█████     | 9/18 [00:01<00:01,  8.60it/s] 56%|█████▌    | 10/18 [00:01<00:00,  8.63it/s] 61%|██████    | 11/18 [00:01<00:00,  8.67it/s] 67%|██████▋   | 12/18 [00:01<00:00,  8.75it/s] 72%|███████▏  | 13/18 [00:01<00:00,  8.63it/s] 78%|███████▊  | 14/18 [00:01<00:00,  8.18it/s] 83%|████████▎ | 15/18 [00:01<00:00,  8.41it/s] 94%|█████████▍| 17/18 [00:01<00:00,  9.73it/s]100%|██████████| 18/18 [00:04<00:00,  1.25it/s]100%|██████████| 18/18 [00:04<00:00,  3.69it/s]
2025-03-09 09:44:21,166 [INFO]: 	Computing best hyperparameters for index knn.index 03/09/2025, 09:44:21
2025-03-09 09:45:03,448 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 42.2824 secs
2025-03-09 09:45:03,449 [INFO]: The best hyperparameters are: efSearch=241
2025-03-09 09:45:03,449 [INFO]: 	Compute fast metrics 03/09/2025, 09:45:03
  0%|          | 0/4 [00:00<?, ?it/s] 25%|██▌       | 1/4 [00:00<00:00,  5.61it/s] 50%|█████     | 2/4 [00:00<00:00,  7.06it/s] 75%|███████▌  | 3/4 [00:00<00:00,  7.71it/s] 75%|███████▌  | 3/4 [00:00<00:00,  5.85it/s]
2025-03-09 09:45:22,293 [INFO]: 	>>> Finished "Compute fast metrics" in 18.8444 secs
2025-03-09 09:45:22,297 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 66.0053 secs
2025-03-09 09:45:22,297 [INFO]: {
2025-03-09 09:45:22,297 [INFO]: 	index_key: HNSW15
2025-03-09 09:45:22,297 [INFO]: 	index_param: efSearch=241
2025-03-09 09:45:22,297 [INFO]: 	index_path: knn.index
2025-03-09 09:45:22,297 [INFO]: 	size in bytes: 860755150
2025-03-09 09:45:22,297 [INFO]: 	avg_search_speed_ms: 9.9795138116688
2025-03-09 09:45:22,297 [INFO]: 	99p_search_speed_ms: 20.51926666870714
2025-03-09 09:45:22,297 [INFO]: 	reconstruction error %: 0.0
2025-03-09 09:45:22,297 [INFO]: 	nb vectors: 4375
2025-03-09 09:45:22,297 [INFO]: 	vectors dimension: 49152
2025-03-09 09:45:22,297 [INFO]: 	compression ratio: 0.999308572246126
2025-03-09 09:45:22,297 [INFO]: }
2025-03-09 09:45:22,297 [INFO]: 	>>> Finished "Creating the index" in 66.0071 secs
2025-03-09 09:45:22,297 [INFO]: >>> Finished "Launching the whole pipeline" in 66.0359 secs
2025-03-09 09:45:23: [retrieval_preprocessing] calculating distances ...
2025-03-09 09:45:24: [retrieval_preprocessing] finished and saved retrieval indices for episode 47132 [episode count 14/20]
[retrieval_preprocessing] for episode 79395 [episode count 15/20], we have num_retrieval=np.int64(4406) num_query=np.int64(191)
2025-03-09 09:45:25,863 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-09 09:45:26,488 [INFO]: Launching the whole pipeline 03/09/2025, 09:45:26
2025-03-09 09:45:26,488 [INFO]: Reading total number of vectors and dimension 03/09/2025, 09:45:26
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1151.33it/s]
2025-03-09 09:45:26,515 [INFO]: There are 4406 embeddings of dim 49152
2025-03-09 09:45:26,516 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0279 secs
2025-03-09 09:45:26,516 [INFO]: 	Compute estimated construction time of the index 03/09/2025, 09:45:26
2025-03-09 09:45:26,516 [INFO]: 		-> Train: 16.7 minutes
2025-03-09 09:45:26,516 [INFO]: 		-> Add: 2.4 seconds
2025-03-09 09:45:26,516 [INFO]: 		Total: 16.7 minutes
2025-03-09 09:45:26,516 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0001 secs
2025-03-09 09:45:26,516 [INFO]: 	Checking that your have enough memory available to create the index 03/09/2025, 09:45:26
2025-03-09 09:45:26,516 [INFO]: 909.3MB of memory will be needed to build the index (more might be used if you have more)
2025-03-09 09:45:26,516 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0002 secs
2025-03-09 09:45:26,516 [INFO]: 	Selecting most promising index types given data characteristics 03/09/2025, 09:45:26
2025-03-09 09:45:26,516 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-09 09:45:26,516 [INFO]: 	Creating the index 03/09/2025, 09:45:26
2025-03-09 09:45:26,516 [INFO]: 		-> Instanciate the index HNSW15 03/09/2025, 09:45:26
2025-03-09 09:45:26,518 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0012 secs
2025-03-09 09:45:26,518 [INFO]: 		-> Adding the vectors to the index 03/09/2025, 09:45:26
2025-03-09 09:45:26,518 [INFO]: The memory available for adding the vectors is 49.2GB(total available - used by the index)
2025-03-09 09:45:26,518 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/18 [00:00<?, ?it/s]  6%|▌         | 1/18 [00:00<00:03,  5.10it/s] 11%|█         | 2/18 [00:00<00:02,  7.03it/s] 17%|█▋        | 3/18 [00:00<00:01,  7.94it/s] 22%|██▏       | 4/18 [00:00<00:01,  8.62it/s] 33%|███▎      | 6/18 [00:00<00:01,  9.34it/s] 44%|████▍     | 8/18 [00:00<00:00, 10.42it/s] 56%|█████▌    | 10/18 [00:01<00:00,  9.73it/s] 61%|██████    | 11/18 [00:01<00:00,  9.54it/s] 67%|██████▋   | 12/18 [00:01<00:00,  9.32it/s] 72%|███████▏  | 13/18 [00:01<00:00,  9.20it/s] 78%|███████▊  | 14/18 [00:01<00:00,  9.13it/s] 83%|████████▎ | 15/18 [00:01<00:00,  8.97it/s] 89%|████████▉ | 16/18 [00:01<00:00,  8.98it/s] 94%|█████████▍| 17/18 [00:01<00:00,  9.04it/s]100%|██████████| 18/18 [00:05<00:00,  1.01it/s]100%|██████████| 18/18 [00:05<00:00,  3.59it/s]
2025-03-09 09:45:31,538 [INFO]: 	Computing best hyperparameters for index knn.index 03/09/2025, 09:45:31
2025-03-09 09:46:14,934 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 43.3958 secs
2025-03-09 09:46:14,935 [INFO]: The best hyperparameters are: efSearch=270
2025-03-09 09:46:14,935 [INFO]: 	Compute fast metrics 03/09/2025, 09:46:14
  0%|          | 0/4 [00:00<?, ?it/s] 25%|██▌       | 1/4 [00:00<00:00,  5.51it/s] 50%|█████     | 2/4 [00:00<00:00,  7.31it/s] 75%|███████▌  | 3/4 [00:00<00:00,  7.98it/s] 75%|███████▌  | 3/4 [00:00<00:00,  6.09it/s]
2025-03-09 09:46:32,299 [INFO]: 	>>> Finished "Compute fast metrics" in 17.3645 secs
2025-03-09 09:46:32,302 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 65.7845 secs
2025-03-09 09:46:32,302 [INFO]: {
2025-03-09 09:46:32,302 [INFO]: 	index_key: HNSW15
2025-03-09 09:46:32,302 [INFO]: 	index_param: efSearch=270
2025-03-09 09:46:32,302 [INFO]: 	index_path: knn.index
2025-03-09 09:46:32,302 [INFO]: 	size in bytes: 866854150
2025-03-09 09:46:32,302 [INFO]: 	avg_search_speed_ms: 11.232017265584666
2025-03-09 09:46:32,302 [INFO]: 	99p_search_speed_ms: 24.365269416011884
2025-03-09 09:46:32,302 [INFO]: 	reconstruction error %: 0.0
2025-03-09 09:46:32,302 [INFO]: 	nb vectors: 4406
2025-03-09 09:46:32,302 [INFO]: 	vectors dimension: 49152
2025-03-09 09:46:32,302 [INFO]: 	compression ratio: 0.9993086472505207
2025-03-09 09:46:32,302 [INFO]: }
2025-03-09 09:46:32,303 [INFO]: 	>>> Finished "Creating the index" in 65.7863 secs
2025-03-09 09:46:32,303 [INFO]: >>> Finished "Launching the whole pipeline" in 65.8149 secs
2025-03-09 09:46:33: [retrieval_preprocessing] calculating distances ...
2025-03-09 09:46:34: [retrieval_preprocessing] finished and saved retrieval indices for episode 79395 [episode count 15/20]
[retrieval_preprocessing] for episode 24100 [episode count 16/20], we have num_retrieval=np.int64(4374) num_query=np.int64(223)
2025-03-09 09:46:36,394 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-09 09:46:37,148 [INFO]: Launching the whole pipeline 03/09/2025, 09:46:37
2025-03-09 09:46:37,148 [INFO]: Reading total number of vectors and dimension 03/09/2025, 09:46:37
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1172.25it/s]
2025-03-09 09:46:37,177 [INFO]: There are 4374 embeddings of dim 49152
2025-03-09 09:46:37,177 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0287 secs
2025-03-09 09:46:37,177 [INFO]: 	Compute estimated construction time of the index 03/09/2025, 09:46:37
2025-03-09 09:46:37,177 [INFO]: 		-> Train: 16.7 minutes
2025-03-09 09:46:37,177 [INFO]: 		-> Add: 2.4 seconds
2025-03-09 09:46:37,177 [INFO]: 		Total: 16.7 minutes
2025-03-09 09:46:37,177 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0001 secs
2025-03-09 09:46:37,177 [INFO]: 	Checking that your have enough memory available to create the index 03/09/2025, 09:46:37
2025-03-09 09:46:37,177 [INFO]: 902.7MB of memory will be needed to build the index (more might be used if you have more)
2025-03-09 09:46:37,177 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0001 secs
2025-03-09 09:46:37,177 [INFO]: 	Selecting most promising index types given data characteristics 03/09/2025, 09:46:37
2025-03-09 09:46:37,177 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-09 09:46:37,177 [INFO]: 	Creating the index 03/09/2025, 09:46:37
2025-03-09 09:46:37,178 [INFO]: 		-> Instanciate the index HNSW15 03/09/2025, 09:46:37
2025-03-09 09:46:37,179 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0012 secs
2025-03-09 09:46:37,179 [INFO]: 		-> Adding the vectors to the index 03/09/2025, 09:46:37
2025-03-09 09:46:37,179 [INFO]: The memory available for adding the vectors is 49.2GB(total available - used by the index)
2025-03-09 09:46:37,179 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/18 [00:00<?, ?it/s]  6%|▌         | 1/18 [00:00<00:02,  5.83it/s] 17%|█▋        | 3/18 [00:00<00:01, 10.04it/s] 28%|██▊       | 5/18 [00:00<00:01, 11.08it/s] 39%|███▉      | 7/18 [00:00<00:00, 11.81it/s] 50%|█████     | 9/18 [00:00<00:00, 11.99it/s] 61%|██████    | 11/18 [00:00<00:00, 12.04it/s] 72%|███████▏  | 13/18 [00:01<00:00, 12.22it/s] 83%|████████▎ | 15/18 [00:01<00:00, 12.16it/s] 94%|█████████▍| 17/18 [00:01<00:00, 12.13it/s]100%|██████████| 18/18 [00:04<00:00,  4.16it/s]
2025-03-09 09:46:41,506 [INFO]: 	Computing best hyperparameters for index knn.index 03/09/2025, 09:46:41
2025-03-09 09:47:25,797 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 44.2900 secs
2025-03-09 09:47:25,797 [INFO]: The best hyperparameters are: efSearch=285
2025-03-09 09:47:25,797 [INFO]: 	Compute fast metrics 03/09/2025, 09:47:25
  0%|          | 0/4 [00:00<?, ?it/s] 25%|██▌       | 1/4 [00:00<00:00,  5.12it/s] 50%|█████     | 2/4 [00:00<00:00,  6.52it/s] 75%|███████▌  | 3/4 [00:00<00:00,  7.07it/s] 75%|███████▌  | 3/4 [00:00<00:00,  5.39it/s]
2025-03-09 09:47:46,021 [INFO]: 	>>> Finished "Compute fast metrics" in 20.2234 secs
2025-03-09 09:47:47,061 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 69.8817 secs
2025-03-09 09:47:47,061 [INFO]: {
2025-03-09 09:47:47,061 [INFO]: 	index_key: HNSW15
2025-03-09 09:47:47,061 [INFO]: 	index_param: efSearch=285
2025-03-09 09:47:47,061 [INFO]: 	index_path: knn.index
2025-03-09 09:47:47,061 [INFO]: 	size in bytes: 860558350
2025-03-09 09:47:47,061 [INFO]: 	avg_search_speed_ms: 11.000502114343007
2025-03-09 09:47:47,061 [INFO]: 	99p_search_speed_ms: 20.69622390903528
2025-03-09 09:47:47,061 [INFO]: 	reconstruction error %: 0.0
2025-03-09 09:47:47,061 [INFO]: 	nb vectors: 4374
2025-03-09 09:47:47,062 [INFO]: 	vectors dimension: 49152
2025-03-09 09:47:47,062 [INFO]: 	compression ratio: 0.9993086372353485
2025-03-09 09:47:47,062 [INFO]: }
2025-03-09 09:47:47,062 [INFO]: 	>>> Finished "Creating the index" in 69.8842 secs
2025-03-09 09:47:47,062 [INFO]: >>> Finished "Launching the whole pipeline" in 69.9136 secs
2025-03-09 09:47:48: [retrieval_preprocessing] calculating distances ...
2025-03-09 09:47:49: [retrieval_preprocessing] finished and saved retrieval indices for episode 24100 [episode count 16/20]
[retrieval_preprocessing] for episode 81955 [episode count 17/20], we have num_retrieval=np.int64(4426) num_query=np.int64(171)
2025-03-09 09:47:50,100 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-09 09:47:50,666 [INFO]: Launching the whole pipeline 03/09/2025, 09:47:50
2025-03-09 09:47:50,666 [INFO]: Reading total number of vectors and dimension 03/09/2025, 09:47:50
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1288.18it/s]
2025-03-09 09:47:50,693 [INFO]: There are 4426 embeddings of dim 49152
2025-03-09 09:47:50,693 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0270 secs
2025-03-09 09:47:50,694 [INFO]: 	Compute estimated construction time of the index 03/09/2025, 09:47:50
2025-03-09 09:47:50,694 [INFO]: 		-> Train: 16.7 minutes
2025-03-09 09:47:50,694 [INFO]: 		-> Add: 2.4 seconds
2025-03-09 09:47:50,694 [INFO]: 		Total: 16.7 minutes
2025-03-09 09:47:50,694 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0001 secs
2025-03-09 09:47:50,694 [INFO]: 	Checking that your have enough memory available to create the index 03/09/2025, 09:47:50
2025-03-09 09:47:50,694 [INFO]: 913.4MB of memory will be needed to build the index (more might be used if you have more)
2025-03-09 09:47:50,694 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0003 secs
2025-03-09 09:47:50,694 [INFO]: 	Selecting most promising index types given data characteristics 03/09/2025, 09:47:50
2025-03-09 09:47:50,694 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-09 09:47:50,694 [INFO]: 	Creating the index 03/09/2025, 09:47:50
2025-03-09 09:47:50,694 [INFO]: 		-> Instanciate the index HNSW15 03/09/2025, 09:47:50
2025-03-09 09:47:50,696 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0012 secs
2025-03-09 09:47:50,696 [INFO]: 		-> Adding the vectors to the index 03/09/2025, 09:47:50
2025-03-09 09:47:50,696 [INFO]: The memory available for adding the vectors is 49.2GB(total available - used by the index)
2025-03-09 09:47:50,696 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/18 [00:00<?, ?it/s]  6%|▌         | 1/18 [00:00<00:03,  5.27it/s] 17%|█▋        | 3/18 [00:00<00:01,  8.20it/s] 28%|██▊       | 5/18 [00:00<00:01,  9.02it/s] 39%|███▉      | 7/18 [00:00<00:01,  9.37it/s] 44%|████▍     | 8/18 [00:00<00:01,  9.34it/s] 50%|█████     | 9/18 [00:01<00:00,  9.20it/s] 56%|█████▌    | 10/18 [00:01<00:00,  9.10it/s] 61%|██████    | 11/18 [00:01<00:00,  9.02it/s] 67%|██████▋   | 12/18 [00:01<00:00,  8.99it/s] 72%|███████▏  | 13/18 [00:01<00:00,  9.04it/s] 78%|███████▊  | 14/18 [00:01<00:00,  8.99it/s] 83%|████████▎ | 15/18 [00:01<00:00,  8.95it/s] 89%|████████▉ | 16/18 [00:01<00:00,  8.87it/s] 94%|█████████▍| 17/18 [00:01<00:00,  8.80it/s]100%|██████████| 18/18 [00:04<00:00,  1.04it/s]100%|██████████| 18/18 [00:04<00:00,  3.69it/s]
2025-03-09 09:47:55,578 [INFO]: 	Computing best hyperparameters for index knn.index 03/09/2025, 09:47:55
2025-03-09 09:48:39,781 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 44.2033 secs
2025-03-09 09:48:39,782 [INFO]: The best hyperparameters are: efSearch=270
2025-03-09 09:48:39,782 [INFO]: 	Compute fast metrics 03/09/2025, 09:48:39
  0%|          | 0/4 [00:00<?, ?it/s] 25%|██▌       | 1/4 [00:00<00:00,  5.48it/s] 50%|█████     | 2/4 [00:00<00:00,  7.11it/s] 75%|███████▌  | 3/4 [00:00<00:00,  7.86it/s] 75%|███████▌  | 3/4 [00:00<00:00,  5.93it/s]
2025-03-09 09:49:05,905 [INFO]: 	>>> Finished "Compute fast metrics" in 26.1233 secs
2025-03-09 09:49:05,908 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 75.2122 secs
2025-03-09 09:49:05,908 [INFO]: {
2025-03-09 09:49:05,908 [INFO]: 	index_key: HNSW15
2025-03-09 09:49:05,908 [INFO]: 	index_param: efSearch=270
2025-03-09 09:49:05,908 [INFO]: 	index_path: knn.index
2025-03-09 09:49:05,908 [INFO]: 	size in bytes: 870789070
2025-03-09 09:49:05,908 [INFO]: 	avg_search_speed_ms: 9.440809523440757
2025-03-09 09:49:05,908 [INFO]: 	99p_search_speed_ms: 13.026796416379511
2025-03-09 09:49:05,908 [INFO]: 	reconstruction error %: 0.0
2025-03-09 09:49:05,908 [INFO]: 	nb vectors: 4426
2025-03-09 09:49:05,908 [INFO]: 	vectors dimension: 49152
2025-03-09 09:49:05,908 [INFO]: 	compression ratio: 0.9993086017949214
2025-03-09 09:49:05,908 [INFO]: }
2025-03-09 09:49:05,908 [INFO]: 	>>> Finished "Creating the index" in 75.2139 secs
2025-03-09 09:49:05,908 [INFO]: >>> Finished "Launching the whole pipeline" in 75.2417 secs
2025-03-09 09:49:07: [retrieval_preprocessing] calculating distances ...
2025-03-09 09:49:07: [retrieval_preprocessing] finished and saved retrieval indices for episode 81955 [episode count 17/20]
[retrieval_preprocessing] for episode 16934 [episode count 18/20], we have num_retrieval=np.int64(4333) num_query=np.int64(264)
2025-03-09 09:49:08,953 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-09 09:49:09,659 [INFO]: Launching the whole pipeline 03/09/2025, 09:49:09
2025-03-09 09:49:09,659 [INFO]: Reading total number of vectors and dimension 03/09/2025, 09:49:09
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 2659.67it/s]
2025-03-09 09:49:09,683 [INFO]: There are 4333 embeddings of dim 49152
2025-03-09 09:49:09,683 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0239 secs
2025-03-09 09:49:09,683 [INFO]: 	Compute estimated construction time of the index 03/09/2025, 09:49:09
2025-03-09 09:49:09,683 [INFO]: 		-> Train: 16.7 minutes
2025-03-09 09:49:09,683 [INFO]: 		-> Add: 2.4 seconds
2025-03-09 09:49:09,683 [INFO]: 		Total: 16.7 minutes
2025-03-09 09:49:09,683 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0001 secs
2025-03-09 09:49:09,683 [INFO]: 	Checking that your have enough memory available to create the index 03/09/2025, 09:49:09
2025-03-09 09:49:09,683 [INFO]: 894.2MB of memory will be needed to build the index (more might be used if you have more)
2025-03-09 09:49:09,683 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0001 secs
2025-03-09 09:49:09,683 [INFO]: 	Selecting most promising index types given data characteristics 03/09/2025, 09:49:09
2025-03-09 09:49:09,683 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-09 09:49:09,683 [INFO]: 	Creating the index 03/09/2025, 09:49:09
2025-03-09 09:49:09,683 [INFO]: 		-> Instanciate the index HNSW15 03/09/2025, 09:49:09
2025-03-09 09:49:09,684 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0009 secs
2025-03-09 09:49:09,684 [INFO]: 		-> Adding the vectors to the index 03/09/2025, 09:49:09
2025-03-09 09:49:09,684 [INFO]: The memory available for adding the vectors is 49.2GB(total available - used by the index)
2025-03-09 09:49:09,684 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/18 [00:00<?, ?it/s]  6%|▌         | 1/18 [00:00<00:02,  5.84it/s] 17%|█▋        | 3/18 [00:00<00:01, 10.98it/s] 28%|██▊       | 5/18 [00:00<00:00, 13.01it/s] 39%|███▉      | 7/18 [00:00<00:00, 14.66it/s] 50%|█████     | 9/18 [00:00<00:00, 15.21it/s] 61%|██████    | 11/18 [00:00<00:00, 15.90it/s] 72%|███████▏  | 13/18 [00:00<00:00, 16.21it/s] 83%|████████▎ | 15/18 [00:01<00:00, 15.17it/s] 94%|█████████▍| 17/18 [00:01<00:00, 15.70it/s]100%|██████████| 18/18 [00:03<00:00,  4.79it/s]
2025-03-09 09:49:13,447 [INFO]: 	Computing best hyperparameters for index knn.index 03/09/2025, 09:49:13
2025-03-09 09:49:55,658 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 42.2114 secs
2025-03-09 09:49:55,659 [INFO]: The best hyperparameters are: efSearch=286
2025-03-09 09:49:55,659 [INFO]: 	Compute fast metrics 03/09/2025, 09:49:55
  0%|          | 0/4 [00:00<?, ?it/s] 25%|██▌       | 1/4 [00:00<00:00,  5.42it/s] 50%|█████     | 2/4 [00:00<00:00,  7.13it/s] 75%|███████▌  | 3/4 [00:00<00:00,  7.83it/s] 75%|███████▌  | 3/4 [00:00<00:00,  5.90it/s]
2025-03-09 09:50:12,003 [INFO]: 	>>> Finished "Compute fast metrics" in 16.3444 secs
2025-03-09 09:50:12,008 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 62.3235 secs
2025-03-09 09:50:12,008 [INFO]: {
2025-03-09 09:50:12,008 [INFO]: 	index_key: HNSW15
2025-03-09 09:50:12,008 [INFO]: 	index_param: efSearch=286
2025-03-09 09:50:12,008 [INFO]: 	index_path: knn.index
2025-03-09 09:50:12,008 [INFO]: 	size in bytes: 852491890
2025-03-09 09:50:12,008 [INFO]: 	avg_search_speed_ms: 10.479111152247608
2025-03-09 09:50:12,008 [INFO]: 	99p_search_speed_ms: 16.014942694455392
2025-03-09 09:50:12,008 [INFO]: 	reconstruction error %: 0.0
2025-03-09 09:50:12,008 [INFO]: 	nb vectors: 4333
2025-03-09 09:50:12,008 [INFO]: 	vectors dimension: 49152
2025-03-09 09:50:12,008 [INFO]: 	compression ratio: 0.9993085846247757
2025-03-09 09:50:12,008 [INFO]: }
2025-03-09 09:50:12,008 [INFO]: 	>>> Finished "Creating the index" in 62.3251 secs
2025-03-09 09:50:12,008 [INFO]: >>> Finished "Launching the whole pipeline" in 62.3495 secs
2025-03-09 09:50:13: [retrieval_preprocessing] calculating distances ...
2025-03-09 09:50:14: [retrieval_preprocessing] finished and saved retrieval indices for episode 16934 [episode count 18/20]
[retrieval_preprocessing] for episode 41001 [episode count 19/20], we have num_retrieval=np.int64(4323) num_query=np.int64(274)
2025-03-09 09:50:16,030 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-09 09:50:16,555 [INFO]: Launching the whole pipeline 03/09/2025, 09:50:16
2025-03-09 09:50:16,555 [INFO]: Reading total number of vectors and dimension 03/09/2025, 09:50:16
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1997.29it/s]
2025-03-09 09:50:16,579 [INFO]: There are 4323 embeddings of dim 49152
2025-03-09 09:50:16,579 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0240 secs
2025-03-09 09:50:16,579 [INFO]: 	Compute estimated construction time of the index 03/09/2025, 09:50:16
2025-03-09 09:50:16,579 [INFO]: 		-> Train: 16.7 minutes
2025-03-09 09:50:16,579 [INFO]: 		-> Add: 2.4 seconds
2025-03-09 09:50:16,579 [INFO]: 		Total: 16.7 minutes
2025-03-09 09:50:16,579 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0001 secs
2025-03-09 09:50:16,579 [INFO]: 	Checking that your have enough memory available to create the index 03/09/2025, 09:50:16
2025-03-09 09:50:16,579 [INFO]: 892.2MB of memory will be needed to build the index (more might be used if you have more)
2025-03-09 09:50:16,579 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0001 secs
2025-03-09 09:50:16,579 [INFO]: 	Selecting most promising index types given data characteristics 03/09/2025, 09:50:16
2025-03-09 09:50:16,579 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-09 09:50:16,579 [INFO]: 	Creating the index 03/09/2025, 09:50:16
2025-03-09 09:50:16,579 [INFO]: 		-> Instanciate the index HNSW15 03/09/2025, 09:50:16
2025-03-09 09:50:16,580 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0009 secs
2025-03-09 09:50:16,580 [INFO]: 		-> Adding the vectors to the index 03/09/2025, 09:50:16
2025-03-09 09:50:16,580 [INFO]: The memory available for adding the vectors is 49.2GB(total available - used by the index)
2025-03-09 09:50:16,580 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/18 [00:00<?, ?it/s]  6%|▌         | 1/18 [00:00<00:03,  4.99it/s] 11%|█         | 2/18 [00:00<00:02,  6.77it/s] 17%|█▋        | 3/18 [00:00<00:01,  7.67it/s] 22%|██▏       | 4/18 [00:00<00:01,  8.15it/s] 28%|██▊       | 5/18 [00:00<00:01,  8.33it/s] 33%|███▎      | 6/18 [00:00<00:01,  8.36it/s] 39%|███▉      | 7/18 [00:00<00:01,  8.38it/s] 44%|████▍     | 8/18 [00:01<00:01,  8.30it/s] 50%|█████     | 9/18 [00:01<00:01,  8.48it/s] 56%|█████▌    | 10/18 [00:01<00:00,  8.52it/s] 61%|██████    | 11/18 [00:01<00:00,  8.25it/s] 67%|██████▋   | 12/18 [00:01<00:00,  8.33it/s] 72%|███████▏  | 13/18 [00:01<00:00,  8.27it/s] 78%|███████▊  | 14/18 [00:01<00:00,  8.41it/s] 83%|████████▎ | 15/18 [00:01<00:00,  8.15it/s] 89%|████████▉ | 16/18 [00:01<00:00,  8.60it/s]100%|██████████| 18/18 [00:04<00:00,  1.37it/s]100%|██████████| 18/18 [00:04<00:00,  3.72it/s]
2025-03-09 09:50:21,416 [INFO]: 	Computing best hyperparameters for index knn.index 03/09/2025, 09:50:21
2025-03-09 09:51:05,170 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 43.7537 secs
2025-03-09 09:51:05,170 [INFO]: The best hyperparameters are: efSearch=280
2025-03-09 09:51:05,170 [INFO]: 	Compute fast metrics 03/09/2025, 09:51:05
  0%|          | 0/4 [00:00<?, ?it/s] 25%|██▌       | 1/4 [00:00<00:00,  5.42it/s] 50%|█████     | 2/4 [00:00<00:00,  7.04it/s] 75%|███████▌  | 3/4 [00:00<00:00,  7.78it/s] 75%|███████▌  | 3/4 [00:00<00:00,  5.88it/s]
2025-03-09 09:51:26,647 [INFO]: 	>>> Finished "Compute fast metrics" in 21.4770 secs
2025-03-09 09:51:26,650 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 70.0698 secs
2025-03-09 09:51:26,650 [INFO]: {
2025-03-09 09:51:26,650 [INFO]: 	index_key: HNSW15
2025-03-09 09:51:26,650 [INFO]: 	index_param: efSearch=280
2025-03-09 09:51:26,650 [INFO]: 	index_path: knn.index
2025-03-09 09:51:26,650 [INFO]: 	size in bytes: 850524430
2025-03-09 09:51:26,650 [INFO]: 	avg_search_speed_ms: 10.622843986054816
2025-03-09 09:51:26,650 [INFO]: 	99p_search_speed_ms: 21.12680442398414
2025-03-09 09:51:26,650 [INFO]: 	reconstruction error %: 0.0
2025-03-09 09:51:26,650 [INFO]: 	nb vectors: 4323
2025-03-09 09:51:26,650 [INFO]: 	vectors dimension: 49152
2025-03-09 09:51:26,650 [INFO]: 	compression ratio: 0.9993086077492213
2025-03-09 09:51:26,650 [INFO]: }
2025-03-09 09:51:26,651 [INFO]: 	>>> Finished "Creating the index" in 70.0711 secs
2025-03-09 09:51:26,651 [INFO]: >>> Finished "Launching the whole pipeline" in 70.0956 secs
2025-03-09 09:51:28: [retrieval_preprocessing] calculating distances ...
2025-03-09 09:51:29: [retrieval_preprocessing] finished and saved retrieval indices for episode 41001 [episode count 19/20]
2025-03-09 09:51:29: [retrieval_preprocessing] finished for (9883209091, 'mug') [chosen_id count 5/10]
2025-03-09 09:51:32: [retrieval_preprocessing] concatenated all embeddings and indices for 20 episodes for (9934859632, 'marker') [chosen_id count 6/10]
2025-03-09 09:51:32: [retrieval_preprocessing] we have num_total=3305 embedding_dim=49152
[retrieval_preprocessing] for episode 59905 [episode count 0/20], we have num_retrieval=np.int64(3138) num_query=np.int64(167)
2025-03-09 09:51:33,291 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-09 09:51:33,861 [INFO]: Launching the whole pipeline 03/09/2025, 09:51:33
2025-03-09 09:51:33,861 [INFO]: Reading total number of vectors and dimension 03/09/2025, 09:51:33
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 2185.67it/s]
2025-03-09 09:51:33,890 [INFO]: There are 3138 embeddings of dim 49152
2025-03-09 09:51:33,890 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0290 secs
2025-03-09 09:51:33,891 [INFO]: 	Compute estimated construction time of the index 03/09/2025, 09:51:33
2025-03-09 09:51:33,891 [INFO]: 		-> Train: 16.7 minutes
2025-03-09 09:51:33,891 [INFO]: 		-> Add: 1.7 seconds
2025-03-09 09:51:33,891 [INFO]: 		Total: 16.7 minutes
2025-03-09 09:51:33,891 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0004 secs
2025-03-09 09:51:33,891 [INFO]: 	Checking that your have enough memory available to create the index 03/09/2025, 09:51:33
2025-03-09 09:51:33,891 [INFO]: 647.6MB of memory will be needed to build the index (more might be used if you have more)
2025-03-09 09:51:33,892 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0004 secs
2025-03-09 09:51:33,892 [INFO]: 	Selecting most promising index types given data characteristics 03/09/2025, 09:51:33
2025-03-09 09:51:33,892 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-09 09:51:33,892 [INFO]: 	Creating the index 03/09/2025, 09:51:33
2025-03-09 09:51:33,892 [INFO]: 		-> Instanciate the index HNSW15 03/09/2025, 09:51:33
2025-03-09 09:51:33,895 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0026 secs
2025-03-09 09:51:33,895 [INFO]: 		-> Adding the vectors to the index 03/09/2025, 09:51:33
2025-03-09 09:51:33,895 [INFO]: The memory available for adding the vectors is 49.4GB(total available - used by the index)
2025-03-09 09:51:33,896 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/13 [00:00<?, ?it/s]  8%|▊         | 1/13 [00:00<00:01,  7.86it/s] 23%|██▎       | 3/13 [00:00<00:00, 11.78it/s] 38%|███▊      | 5/13 [00:00<00:00, 11.02it/s] 54%|█████▍    | 7/13 [00:00<00:00,  9.76it/s] 69%|██████▉   | 9/13 [00:01<00:00,  8.14it/s] 77%|███████▋  | 10/13 [00:01<00:00,  8.13it/s] 85%|████████▍ | 11/13 [00:01<00:00,  8.11it/s] 92%|█████████▏| 12/13 [00:01<00:00,  8.03it/s]100%|██████████| 13/13 [00:04<00:00,  1.22it/s]100%|██████████| 13/13 [00:04<00:00,  3.12it/s]
2025-03-09 09:51:38,071 [INFO]: 	Computing best hyperparameters for index knn.index 03/09/2025, 09:51:38
2025-03-09 09:52:11,260 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 33.1882 secs
2025-03-09 09:52:11,260 [INFO]: The best hyperparameters are: efSearch=266
2025-03-09 09:52:11,260 [INFO]: 	Compute fast metrics 03/09/2025, 09:52:11
  0%|          | 0/4 [00:00<?, ?it/s] 25%|██▌       | 1/4 [00:00<00:00,  5.10it/s] 50%|█████     | 2/4 [00:00<00:00,  6.83it/s] 75%|███████▌  | 3/4 [00:00<00:00,  7.61it/s] 75%|███████▌  | 3/4 [00:00<00:00,  5.73it/s]
2025-03-09 09:52:36,211 [INFO]: 	>>> Finished "Compute fast metrics" in 24.9505 secs
2025-03-09 09:52:36,213 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 62.3177 secs
2025-03-09 09:52:36,213 [INFO]: {
2025-03-09 09:52:36,213 [INFO]: 	index_key: HNSW15
2025-03-09 09:52:36,213 [INFO]: 	index_param: efSearch=266
2025-03-09 09:52:36,213 [INFO]: 	index_path: knn.index
2025-03-09 09:52:36,213 [INFO]: 	size in bytes: 617382130
2025-03-09 09:52:36,213 [INFO]: 	avg_search_speed_ms: 10.272494737906056
2025-03-09 09:52:36,213 [INFO]: 	99p_search_speed_ms: 16.94757455494255
2025-03-09 09:52:36,213 [INFO]: 	reconstruction error %: 0.0
2025-03-09 09:52:36,213 [INFO]: 	nb vectors: 3138
2025-03-09 09:52:36,213 [INFO]: 	vectors dimension: 49152
2025-03-09 09:52:36,213 [INFO]: 	compression ratio: 0.9993096236847672
2025-03-09 09:52:36,213 [INFO]: }
2025-03-09 09:52:36,213 [INFO]: 	>>> Finished "Creating the index" in 62.3213 secs
2025-03-09 09:52:36,213 [INFO]: >>> Finished "Launching the whole pipeline" in 62.3520 secs
2025-03-09 09:52:37: [retrieval_preprocessing] calculating distances ...
2025-03-09 09:52:38: [retrieval_preprocessing] finished and saved retrieval indices for episode 59905 [episode count 0/20]
[retrieval_preprocessing] for episode 31362 [episode count 1/20], we have num_retrieval=np.int64(3127) num_query=np.int64(178)
2025-03-09 09:52:38,714 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-09 09:52:39,147 [INFO]: Launching the whole pipeline 03/09/2025, 09:52:39
2025-03-09 09:52:39,147 [INFO]: Reading total number of vectors and dimension 03/09/2025, 09:52:39
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 2255.00it/s]
2025-03-09 09:52:39,172 [INFO]: There are 3127 embeddings of dim 49152
2025-03-09 09:52:39,173 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0253 secs
2025-03-09 09:52:39,173 [INFO]: 	Compute estimated construction time of the index 03/09/2025, 09:52:39
2025-03-09 09:52:39,173 [INFO]: 		-> Train: 16.7 minutes
2025-03-09 09:52:39,173 [INFO]: 		-> Add: 1.7 seconds
2025-03-09 09:52:39,173 [INFO]: 		Total: 16.7 minutes
2025-03-09 09:52:39,173 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0001 secs
2025-03-09 09:52:39,173 [INFO]: 	Checking that your have enough memory available to create the index 03/09/2025, 09:52:39
2025-03-09 09:52:39,173 [INFO]: 645.3MB of memory will be needed to build the index (more might be used if you have more)
2025-03-09 09:52:39,173 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0001 secs
2025-03-09 09:52:39,173 [INFO]: 	Selecting most promising index types given data characteristics 03/09/2025, 09:52:39
2025-03-09 09:52:39,173 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-09 09:52:39,173 [INFO]: 	Creating the index 03/09/2025, 09:52:39
2025-03-09 09:52:39,173 [INFO]: 		-> Instanciate the index HNSW15 03/09/2025, 09:52:39
2025-03-09 09:52:39,174 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0009 secs
2025-03-09 09:52:39,174 [INFO]: 		-> Adding the vectors to the index 03/09/2025, 09:52:39
2025-03-09 09:52:39,174 [INFO]: The memory available for adding the vectors is 49.4GB(total available - used by the index)
2025-03-09 09:52:39,174 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/13 [00:00<?, ?it/s]  8%|▊         | 1/13 [00:00<00:01,  6.35it/s] 23%|██▎       | 3/13 [00:00<00:01,  9.84it/s] 38%|███▊      | 5/13 [00:00<00:00, 11.38it/s] 54%|█████▍    | 7/13 [00:00<00:00, 11.81it/s] 69%|██████▉   | 9/13 [00:00<00:00, 12.04it/s] 85%|████████▍ | 11/13 [00:00<00:00, 12.37it/s]100%|██████████| 13/13 [00:03<00:00,  2.39it/s]100%|██████████| 13/13 [00:03<00:00,  4.15it/s]
2025-03-09 09:52:42,309 [INFO]: 	Computing best hyperparameters for index knn.index 03/09/2025, 09:52:42
2025-03-09 09:53:11,987 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 29.6779 secs
2025-03-09 09:53:11,987 [INFO]: The best hyperparameters are: efSearch=226
2025-03-09 09:53:11,987 [INFO]: 	Compute fast metrics 03/09/2025, 09:53:11
  0%|          | 0/4 [00:00<?, ?it/s] 25%|██▌       | 1/4 [00:00<00:00,  5.77it/s] 50%|█████     | 2/4 [00:00<00:00,  7.24it/s] 75%|███████▌  | 3/4 [00:00<00:00,  7.95it/s] 75%|███████▌  | 3/4 [00:00<00:00,  6.03it/s]
2025-03-09 09:53:33,156 [INFO]: 	>>> Finished "Compute fast metrics" in 21.1689 secs
2025-03-09 09:53:33,158 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 53.9842 secs
2025-03-09 09:53:33,159 [INFO]: {
2025-03-09 09:53:33,159 [INFO]: 	index_key: HNSW15
2025-03-09 09:53:33,159 [INFO]: 	index_param: efSearch=226
2025-03-09 09:53:33,159 [INFO]: 	index_path: knn.index
2025-03-09 09:53:33,159 [INFO]: 	size in bytes: 615217990
2025-03-09 09:53:33,159 [INFO]: 	avg_search_speed_ms: 9.436686773441803
2025-03-09 09:53:33,159 [INFO]: 	99p_search_speed_ms: 15.263142110779935
2025-03-09 09:53:33,159 [INFO]: 	reconstruction error %: 0.0
2025-03-09 09:53:33,159 [INFO]: 	nb vectors: 3127
2025-03-09 09:53:33,159 [INFO]: 	vectors dimension: 49152
2025-03-09 09:53:33,159 [INFO]: 	compression ratio: 0.999309555300878
2025-03-09 09:53:33,159 [INFO]: }
2025-03-09 09:53:33,159 [INFO]: 	>>> Finished "Creating the index" in 53.9856 secs
2025-03-09 09:53:33,159 [INFO]: >>> Finished "Launching the whole pipeline" in 54.0115 secs
2025-03-09 09:53:33: [retrieval_preprocessing] calculating distances ...
2025-03-09 09:53:34: [retrieval_preprocessing] finished and saved retrieval indices for episode 31362 [episode count 1/20]
[retrieval_preprocessing] for episode 69891 [episode count 2/20], we have num_retrieval=np.int64(3143) num_query=np.int64(162)
2025-03-09 09:53:35,239 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-09 09:53:35,657 [INFO]: Launching the whole pipeline 03/09/2025, 09:53:35
2025-03-09 09:53:35,657 [INFO]: Reading total number of vectors and dimension 03/09/2025, 09:53:35
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1322.29it/s]
2025-03-09 09:53:35,691 [INFO]: There are 3143 embeddings of dim 49152
2025-03-09 09:53:35,692 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0342 secs
2025-03-09 09:53:35,692 [INFO]: 	Compute estimated construction time of the index 03/09/2025, 09:53:35
2025-03-09 09:53:35,692 [INFO]: 		-> Train: 16.7 minutes
2025-03-09 09:53:35,692 [INFO]: 		-> Add: 1.7 seconds
2025-03-09 09:53:35,692 [INFO]: 		Total: 16.7 minutes
2025-03-09 09:53:35,692 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0005 secs
2025-03-09 09:53:35,692 [INFO]: 	Checking that your have enough memory available to create the index 03/09/2025, 09:53:35
2025-03-09 09:53:35,693 [INFO]: 648.6MB of memory will be needed to build the index (more might be used if you have more)
2025-03-09 09:53:35,693 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0004 secs
2025-03-09 09:53:35,693 [INFO]: 	Selecting most promising index types given data characteristics 03/09/2025, 09:53:35
2025-03-09 09:53:35,693 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-09 09:53:35,693 [INFO]: 	Creating the index 03/09/2025, 09:53:35
2025-03-09 09:53:35,693 [INFO]: 		-> Instanciate the index HNSW15 03/09/2025, 09:53:35
2025-03-09 09:53:35,696 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0027 secs
2025-03-09 09:53:35,697 [INFO]: 		-> Adding the vectors to the index 03/09/2025, 09:53:35
2025-03-09 09:53:35,697 [INFO]: The memory available for adding the vectors is 49.4GB(total available - used by the index)
2025-03-09 09:53:35,697 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/13 [00:00<?, ?it/s]  8%|▊         | 1/13 [00:00<00:01,  6.83it/s] 23%|██▎       | 3/13 [00:00<00:00, 13.24it/s] 38%|███▊      | 5/13 [00:00<00:00, 15.97it/s] 54%|█████▍    | 7/13 [00:00<00:00, 17.40it/s] 69%|██████▉   | 9/13 [00:00<00:00, 17.63it/s] 85%|████████▍ | 11/13 [00:00<00:00, 17.54it/s]100%|██████████| 13/13 [00:02<00:00,  2.58it/s]100%|██████████| 13/13 [00:02<00:00,  4.69it/s]
2025-03-09 09:53:38,476 [INFO]: 	Computing best hyperparameters for index knn.index 03/09/2025, 09:53:38
2025-03-09 09:54:09,127 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 30.6507 secs
2025-03-09 09:54:09,128 [INFO]: The best hyperparameters are: efSearch=196
2025-03-09 09:54:09,128 [INFO]: 	Compute fast metrics 03/09/2025, 09:54:09
  0%|          | 0/4 [00:00<?, ?it/s] 25%|██▌       | 1/4 [00:00<00:00,  6.09it/s] 75%|███████▌  | 3/4 [00:00<00:00,  9.81it/s] 75%|███████▌  | 3/4 [00:00<00:00,  7.51it/s]
2025-03-09 09:54:24,540 [INFO]: 	>>> Finished "Compute fast metrics" in 15.4123 secs
2025-03-09 09:54:24,542 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 48.8455 secs
2025-03-09 09:54:24,542 [INFO]: {
2025-03-09 09:54:24,542 [INFO]: 	index_key: HNSW15
2025-03-09 09:54:24,542 [INFO]: 	index_param: efSearch=196
2025-03-09 09:54:24,542 [INFO]: 	index_path: knn.index
2025-03-09 09:54:24,542 [INFO]: 	size in bytes: 618365830
2025-03-09 09:54:24,542 [INFO]: 	avg_search_speed_ms: 9.30437395868953
2025-03-09 09:54:24,542 [INFO]: 	99p_search_speed_ms: 15.628599459305404
2025-03-09 09:54:24,542 [INFO]: 	reconstruction error %: 0.0
2025-03-09 09:54:24,542 [INFO]: 	nb vectors: 3143
2025-03-09 09:54:24,542 [INFO]: 	vectors dimension: 49152
2025-03-09 09:54:24,542 [INFO]: 	compression ratio: 0.9993096546101197
2025-03-09 09:54:24,542 [INFO]: }
2025-03-09 09:54:24,542 [INFO]: 	>>> Finished "Creating the index" in 48.8491 secs
2025-03-09 09:54:24,542 [INFO]: >>> Finished "Launching the whole pipeline" in 48.8852 secs
2025-03-09 09:54:25: [retrieval_preprocessing] calculating distances ...
2025-03-09 09:54:25: [retrieval_preprocessing] finished and saved retrieval indices for episode 69891 [episode count 2/20]
[retrieval_preprocessing] for episode 71172 [episode count 3/20], we have num_retrieval=np.int64(3171) num_query=np.int64(134)
2025-03-09 09:54:26,368 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-09 09:54:26,804 [INFO]: Launching the whole pipeline 03/09/2025, 09:54:26
2025-03-09 09:54:26,804 [INFO]: Reading total number of vectors and dimension 03/09/2025, 09:54:26
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1880.85it/s]
2025-03-09 09:54:26,829 [INFO]: There are 3171 embeddings of dim 49152
2025-03-09 09:54:26,829 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0254 secs
2025-03-09 09:54:26,830 [INFO]: 	Compute estimated construction time of the index 03/09/2025, 09:54:26
2025-03-09 09:54:26,830 [INFO]: 		-> Train: 16.7 minutes
2025-03-09 09:54:26,830 [INFO]: 		-> Add: 1.7 seconds
2025-03-09 09:54:26,831 [INFO]: 		Total: 16.7 minutes
2025-03-09 09:54:26,831 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0005 secs
2025-03-09 09:54:26,831 [INFO]: 	Checking that your have enough memory available to create the index 03/09/2025, 09:54:26
2025-03-09 09:54:26,831 [INFO]: 654.4MB of memory will be needed to build the index (more might be used if you have more)
2025-03-09 09:54:26,831 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0004 secs
2025-03-09 09:54:26,832 [INFO]: 	Selecting most promising index types given data characteristics 03/09/2025, 09:54:26
2025-03-09 09:54:26,832 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-09 09:54:26,832 [INFO]: 	Creating the index 03/09/2025, 09:54:26
2025-03-09 09:54:26,832 [INFO]: 		-> Instanciate the index HNSW15 03/09/2025, 09:54:26
2025-03-09 09:54:26,835 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0026 secs
2025-03-09 09:54:26,835 [INFO]: 		-> Adding the vectors to the index 03/09/2025, 09:54:26
2025-03-09 09:54:26,835 [INFO]: The memory available for adding the vectors is 49.4GB(total available - used by the index)
2025-03-09 09:54:26,835 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/13 [00:00<?, ?it/s]  8%|▊         | 1/13 [00:00<00:02,  5.51it/s] 15%|█▌        | 2/13 [00:00<00:01,  6.98it/s] 23%|██▎       | 3/13 [00:00<00:01,  7.64it/s] 31%|███       | 4/13 [00:00<00:01,  8.13it/s] 38%|███▊      | 5/13 [00:00<00:00,  8.34it/s] 46%|████▌     | 6/13 [00:00<00:00,  8.42it/s] 54%|█████▍    | 7/13 [00:00<00:00,  8.55it/s] 62%|██████▏   | 8/13 [00:00<00:00,  8.27it/s] 69%|██████▉   | 9/13 [00:01<00:00,  8.42it/s] 77%|███████▋  | 10/13 [00:01<00:00,  8.73it/s] 85%|████████▍ | 11/13 [00:01<00:00,  8.73it/s] 92%|█████████▏| 12/13 [00:01<00:00,  8.80it/s]100%|██████████| 13/13 [00:03<00:00,  1.28it/s]100%|██████████| 13/13 [00:03<00:00,  3.46it/s]
2025-03-09 09:54:30,596 [INFO]: 	Computing best hyperparameters for index knn.index 03/09/2025, 09:54:30
2025-03-09 09:54:59,866 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 29.2697 secs
2025-03-09 09:54:59,866 [INFO]: The best hyperparameters are: efSearch=230
2025-03-09 09:54:59,866 [INFO]: 	Compute fast metrics 03/09/2025, 09:54:59
  0%|          | 0/4 [00:00<?, ?it/s] 25%|██▌       | 1/4 [00:00<00:00,  5.43it/s] 50%|█████     | 2/4 [00:00<00:00,  7.28it/s] 75%|███████▌  | 3/4 [00:00<00:00,  8.12it/s] 75%|███████▌  | 3/4 [00:00<00:00,  6.10it/s]
2025-03-09 09:55:16,154 [INFO]: 	>>> Finished "Compute fast metrics" in 16.2880 secs
2025-03-09 09:55:16,156 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 49.3211 secs
2025-03-09 09:55:16,156 [INFO]: {
2025-03-09 09:55:16,156 [INFO]: 	index_key: HNSW15
2025-03-09 09:55:16,156 [INFO]: 	index_param: efSearch=230
2025-03-09 09:55:16,156 [INFO]: 	index_path: knn.index
2025-03-09 09:55:16,156 [INFO]: 	size in bytes: 623874610
2025-03-09 09:55:16,156 [INFO]: 	avg_search_speed_ms: 9.830791237164242
2025-03-09 09:55:16,156 [INFO]: 	99p_search_speed_ms: 18.104546982795018
2025-03-09 09:55:16,156 [INFO]: 	reconstruction error %: 0.0
2025-03-09 09:55:16,156 [INFO]: 	nb vectors: 3171
2025-03-09 09:55:16,156 [INFO]: 	vectors dimension: 49152
2025-03-09 09:55:16,156 [INFO]: 	compression ratio: 0.999309729883061
2025-03-09 09:55:16,157 [INFO]: }
2025-03-09 09:55:16,157 [INFO]: 	>>> Finished "Creating the index" in 49.3247 secs
2025-03-09 09:55:16,157 [INFO]: >>> Finished "Launching the whole pipeline" in 49.3527 secs
2025-03-09 09:55:16: [retrieval_preprocessing] calculating distances ...
2025-03-09 09:55:17: [retrieval_preprocessing] finished and saved retrieval indices for episode 71172 [episode count 3/20]
[retrieval_preprocessing] for episode 32520 [episode count 4/20], we have num_retrieval=np.int64(3206) num_query=np.int64(99)
2025-03-09 09:55:18,099 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-09 09:55:18,490 [INFO]: Launching the whole pipeline 03/09/2025, 09:55:18
2025-03-09 09:55:18,490 [INFO]: Reading total number of vectors and dimension 03/09/2025, 09:55:18
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1916.96it/s]
2025-03-09 09:55:18,513 [INFO]: There are 3206 embeddings of dim 49152
2025-03-09 09:55:18,513 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0230 secs
2025-03-09 09:55:18,513 [INFO]: 	Compute estimated construction time of the index 03/09/2025, 09:55:18
2025-03-09 09:55:18,513 [INFO]: 		-> Train: 16.7 minutes
2025-03-09 09:55:18,513 [INFO]: 		-> Add: 1.8 seconds
2025-03-09 09:55:18,513 [INFO]: 		Total: 16.7 minutes
2025-03-09 09:55:18,513 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0001 secs
2025-03-09 09:55:18,513 [INFO]: 	Checking that your have enough memory available to create the index 03/09/2025, 09:55:18
2025-03-09 09:55:18,514 [INFO]: 661.6MB of memory will be needed to build the index (more might be used if you have more)
2025-03-09 09:55:18,514 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0001 secs
2025-03-09 09:55:18,514 [INFO]: 	Selecting most promising index types given data characteristics 03/09/2025, 09:55:18
2025-03-09 09:55:18,514 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-09 09:55:18,514 [INFO]: 	Creating the index 03/09/2025, 09:55:18
2025-03-09 09:55:18,514 [INFO]: 		-> Instanciate the index HNSW15 03/09/2025, 09:55:18
2025-03-09 09:55:18,515 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0009 secs
2025-03-09 09:55:18,515 [INFO]: 		-> Adding the vectors to the index 03/09/2025, 09:55:18
2025-03-09 09:55:18,515 [INFO]: The memory available for adding the vectors is 49.4GB(total available - used by the index)
2025-03-09 09:55:18,515 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/13 [00:00<?, ?it/s]  8%|▊         | 1/13 [00:00<00:01,  8.41it/s] 31%|███       | 4/13 [00:00<00:00, 17.47it/s] 46%|████▌     | 6/13 [00:00<00:00, 16.94it/s] 62%|██████▏   | 8/13 [00:00<00:00, 13.47it/s] 77%|███████▋  | 10/13 [00:00<00:00, 14.19it/s]100%|██████████| 13/13 [00:03<00:00,  2.26it/s]100%|██████████| 13/13 [00:03<00:00,  3.71it/s]
2025-03-09 09:55:22,021 [INFO]: 	Computing best hyperparameters for index knn.index 03/09/2025, 09:55:22
2025-03-09 09:55:56,180 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 34.1585 secs
2025-03-09 09:55:56,180 [INFO]: The best hyperparameters are: efSearch=181
2025-03-09 09:55:56,181 [INFO]: 	Compute fast metrics 03/09/2025, 09:55:56
  0%|          | 0/4 [00:00<?, ?it/s] 25%|██▌       | 1/4 [00:00<00:00,  5.48it/s] 50%|█████     | 2/4 [00:00<00:00,  6.92it/s] 75%|███████▌  | 3/4 [00:00<00:00,  7.36it/s] 75%|███████▌  | 3/4 [00:00<00:00,  5.49it/s]
2025-03-09 09:56:16,417 [INFO]: 	>>> Finished "Compute fast metrics" in 20.2360 secs
2025-03-09 09:56:16,419 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 57.9043 secs
2025-03-09 09:56:16,419 [INFO]: {
2025-03-09 09:56:16,419 [INFO]: 	index_key: HNSW15
2025-03-09 09:56:16,419 [INFO]: 	index_param: efSearch=181
2025-03-09 09:56:16,419 [INFO]: 	index_path: knn.index
2025-03-09 09:56:16,419 [INFO]: 	size in bytes: 630760630
2025-03-09 09:56:16,419 [INFO]: 	avg_search_speed_ms: 8.572403372682338
2025-03-09 09:56:16,419 [INFO]: 	99p_search_speed_ms: 14.976257400121513
2025-03-09 09:56:16,419 [INFO]: 	reconstruction error %: 0.0
2025-03-09 09:56:16,419 [INFO]: 	nb vectors: 3206
2025-03-09 09:56:16,419 [INFO]: 	vectors dimension: 49152
2025-03-09 09:56:16,419 [INFO]: 	compression ratio: 0.9993097508321025
2025-03-09 09:56:16,419 [INFO]: }
2025-03-09 09:56:16,419 [INFO]: 	>>> Finished "Creating the index" in 57.9056 secs
2025-03-09 09:56:16,419 [INFO]: >>> Finished "Launching the whole pipeline" in 57.9291 secs
2025-03-09 09:56:16: [retrieval_preprocessing] calculating distances ...
2025-03-09 09:56:17: [retrieval_preprocessing] finished and saved retrieval indices for episode 32520 [episode count 4/20]
[retrieval_preprocessing] for episode 33036 [episode count 5/20], we have num_retrieval=np.int64(3139) num_query=np.int64(166)
2025-03-09 09:56:17,903 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-09 09:56:18,329 [INFO]: Launching the whole pipeline 03/09/2025, 09:56:18
2025-03-09 09:56:18,329 [INFO]: Reading total number of vectors and dimension 03/09/2025, 09:56:18
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1445.31it/s]
2025-03-09 09:56:18,357 [INFO]: There are 3139 embeddings of dim 49152
2025-03-09 09:56:18,357 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0278 secs
2025-03-09 09:56:18,357 [INFO]: 	Compute estimated construction time of the index 03/09/2025, 09:56:18
2025-03-09 09:56:18,357 [INFO]: 		-> Train: 16.7 minutes
2025-03-09 09:56:18,357 [INFO]: 		-> Add: 1.7 seconds
2025-03-09 09:56:18,357 [INFO]: 		Total: 16.7 minutes
2025-03-09 09:56:18,357 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0001 secs
2025-03-09 09:56:18,357 [INFO]: 	Checking that your have enough memory available to create the index 03/09/2025, 09:56:18
2025-03-09 09:56:18,357 [INFO]: 647.8MB of memory will be needed to build the index (more might be used if you have more)
2025-03-09 09:56:18,357 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0002 secs
2025-03-09 09:56:18,358 [INFO]: 	Selecting most promising index types given data characteristics 03/09/2025, 09:56:18
2025-03-09 09:56:18,358 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-09 09:56:18,358 [INFO]: 	Creating the index 03/09/2025, 09:56:18
2025-03-09 09:56:18,358 [INFO]: 		-> Instanciate the index HNSW15 03/09/2025, 09:56:18
2025-03-09 09:56:18,359 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0012 secs
2025-03-09 09:56:18,359 [INFO]: 		-> Adding the vectors to the index 03/09/2025, 09:56:18
2025-03-09 09:56:18,359 [INFO]: The memory available for adding the vectors is 49.4GB(total available - used by the index)
2025-03-09 09:56:18,359 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/13 [00:00<?, ?it/s]  8%|▊         | 1/13 [00:00<00:02,  5.52it/s] 15%|█▌        | 2/13 [00:00<00:01,  7.13it/s] 23%|██▎       | 3/13 [00:00<00:01,  7.85it/s] 31%|███       | 4/13 [00:00<00:01,  8.26it/s] 38%|███▊      | 5/13 [00:00<00:00,  8.49it/s] 46%|████▌     | 6/13 [00:00<00:00,  8.56it/s] 54%|█████▍    | 7/13 [00:00<00:00,  8.63it/s] 62%|██████▏   | 8/13 [00:00<00:00,  8.66it/s] 69%|██████▉   | 9/13 [00:01<00:00,  8.61it/s] 77%|███████▋  | 10/13 [00:01<00:00,  8.79it/s] 85%|████████▍ | 11/13 [00:01<00:00,  8.75it/s] 92%|█████████▏| 12/13 [00:01<00:00,  8.62it/s]100%|██████████| 13/13 [00:03<00:00,  1.28it/s]100%|██████████| 13/13 [00:03<00:00,  3.47it/s]
2025-03-09 09:56:22,105 [INFO]: 	Computing best hyperparameters for index knn.index 03/09/2025, 09:56:22
2025-03-09 09:56:53,656 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 31.5502 secs
2025-03-09 09:56:53,656 [INFO]: The best hyperparameters are: efSearch=201
2025-03-09 09:56:53,656 [INFO]: 	Compute fast metrics 03/09/2025, 09:56:53
  0%|          | 0/4 [00:00<?, ?it/s] 25%|██▌       | 1/4 [00:00<00:00,  5.54it/s] 50%|█████     | 2/4 [00:00<00:00,  7.11it/s] 75%|███████▌  | 3/4 [00:00<00:00,  7.88it/s] 75%|███████▌  | 3/4 [00:00<00:00,  6.01it/s]
2025-03-09 09:57:15,183 [INFO]: 	>>> Finished "Compute fast metrics" in 21.5276 secs
2025-03-09 09:57:15,185 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 56.8264 secs
2025-03-09 09:57:15,186 [INFO]: {
2025-03-09 09:57:15,186 [INFO]: 	index_key: HNSW15
2025-03-09 09:57:15,186 [INFO]: 	index_param: efSearch=201
2025-03-09 09:57:15,186 [INFO]: 	index_path: knn.index
2025-03-09 09:57:15,186 [INFO]: 	size in bytes: 617578870
2025-03-09 09:57:15,186 [INFO]: 	avg_search_speed_ms: 8.508133482623924
2025-03-09 09:57:15,186 [INFO]: 	99p_search_speed_ms: 14.38701461534947
2025-03-09 09:57:15,186 [INFO]: 	reconstruction error %: 0.0
2025-03-09 09:57:15,186 [INFO]: 	nb vectors: 3139
2025-03-09 09:57:15,186 [INFO]: 	vectors dimension: 49152
2025-03-09 09:57:15,186 [INFO]: 	compression ratio: 0.9993096298777191
2025-03-09 09:57:15,186 [INFO]: }
2025-03-09 09:57:15,186 [INFO]: 	>>> Finished "Creating the index" in 56.8281 secs
2025-03-09 09:57:15,186 [INFO]: >>> Finished "Launching the whole pipeline" in 56.8566 secs
2025-03-09 09:57:15: [retrieval_preprocessing] calculating distances ...
2025-03-09 09:57:16: [retrieval_preprocessing] finished and saved retrieval indices for episode 33036 [episode count 5/20]
[retrieval_preprocessing] for episode 27278 [episode count 6/20], we have num_retrieval=np.int64(3130) num_query=np.int64(175)
2025-03-09 09:57:16,987 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-09 09:57:17,387 [INFO]: Launching the whole pipeline 03/09/2025, 09:57:17
2025-03-09 09:57:17,387 [INFO]: Reading total number of vectors and dimension 03/09/2025, 09:57:17
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 2313.46it/s]
2025-03-09 09:57:17,412 [INFO]: There are 3130 embeddings of dim 49152
2025-03-09 09:57:17,412 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0250 secs
2025-03-09 09:57:17,412 [INFO]: 	Compute estimated construction time of the index 03/09/2025, 09:57:17
2025-03-09 09:57:17,413 [INFO]: 		-> Train: 16.7 minutes
2025-03-09 09:57:17,413 [INFO]: 		-> Add: 1.7 seconds
2025-03-09 09:57:17,413 [INFO]: 		Total: 16.7 minutes
2025-03-09 09:57:17,413 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0001 secs
2025-03-09 09:57:17,413 [INFO]: 	Checking that your have enough memory available to create the index 03/09/2025, 09:57:17
2025-03-09 09:57:17,413 [INFO]: 646.0MB of memory will be needed to build the index (more might be used if you have more)
2025-03-09 09:57:17,413 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0001 secs
2025-03-09 09:57:17,413 [INFO]: 	Selecting most promising index types given data characteristics 03/09/2025, 09:57:17
2025-03-09 09:57:17,413 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-09 09:57:17,413 [INFO]: 	Creating the index 03/09/2025, 09:57:17
2025-03-09 09:57:17,413 [INFO]: 		-> Instanciate the index HNSW15 03/09/2025, 09:57:17
2025-03-09 09:57:17,414 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0012 secs
2025-03-09 09:57:17,414 [INFO]: 		-> Adding the vectors to the index 03/09/2025, 09:57:17
2025-03-09 09:57:17,414 [INFO]: The memory available for adding the vectors is 49.4GB(total available - used by the index)
2025-03-09 09:57:17,414 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/13 [00:00<?, ?it/s]  8%|▊         | 1/13 [00:00<00:01,  6.24it/s] 31%|███       | 4/13 [00:00<00:00, 12.29it/s] 46%|████▌     | 6/13 [00:00<00:00, 12.26it/s] 62%|██████▏   | 8/13 [00:00<00:00, 12.07it/s] 77%|███████▋  | 10/13 [00:00<00:00, 11.90it/s] 92%|█████████▏| 12/13 [00:01<00:00, 11.85it/s]100%|██████████| 13/13 [00:03<00:00,  3.85it/s]
2025-03-09 09:57:20,792 [INFO]: 	Computing best hyperparameters for index knn.index 03/09/2025, 09:57:20
2025-03-09 09:57:50,779 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 29.9864 secs
2025-03-09 09:57:50,779 [INFO]: The best hyperparameters are: efSearch=174
2025-03-09 09:57:50,780 [INFO]: 	Compute fast metrics 03/09/2025, 09:57:50
  0%|          | 0/4 [00:00<?, ?it/s] 25%|██▌       | 1/4 [00:00<00:00,  5.83it/s] 75%|███████▌  | 3/4 [00:00<00:00, 10.87it/s] 75%|███████▌  | 3/4 [00:00<00:00,  8.24it/s]
2025-03-09 09:58:07,876 [INFO]: 	>>> Finished "Compute fast metrics" in 17.0962 secs
2025-03-09 09:58:07,878 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 50.4639 secs
2025-03-09 09:58:07,878 [INFO]: {
2025-03-09 09:58:07,878 [INFO]: 	index_key: HNSW15
2025-03-09 09:58:07,878 [INFO]: 	index_param: efSearch=174
2025-03-09 09:58:07,878 [INFO]: 	index_path: knn.index
2025-03-09 09:58:07,878 [INFO]: 	size in bytes: 615808210
2025-03-09 09:58:07,878 [INFO]: 	avg_search_speed_ms: 8.023963506590652
2025-03-09 09:58:07,878 [INFO]: 	99p_search_speed_ms: 14.617351116612513
2025-03-09 09:58:07,878 [INFO]: 	reconstruction error %: 0.0
2025-03-09 09:58:07,878 [INFO]: 	nb vectors: 3130
2025-03-09 09:58:07,878 [INFO]: 	vectors dimension: 49152
2025-03-09 09:58:07,878 [INFO]: 	compression ratio: 0.9993095739986968
2025-03-09 09:58:07,878 [INFO]: }
2025-03-09 09:58:07,878 [INFO]: 	>>> Finished "Creating the index" in 50.4655 secs
2025-03-09 09:58:07,878 [INFO]: >>> Finished "Launching the whole pipeline" in 50.4911 secs
2025-03-09 09:58:08: [retrieval_preprocessing] calculating distances ...
2025-03-09 09:58:09: [retrieval_preprocessing] finished and saved retrieval indices for episode 27278 [episode count 6/20]
[retrieval_preprocessing] for episode 14612 [episode count 7/20], we have num_retrieval=np.int64(3151) num_query=np.int64(154)
2025-03-09 09:58:09,784 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-09 09:58:10,223 [INFO]: Launching the whole pipeline 03/09/2025, 09:58:10
2025-03-09 09:58:10,223 [INFO]: Reading total number of vectors and dimension 03/09/2025, 09:58:10
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1845.27it/s]
2025-03-09 09:58:10,246 [INFO]: There are 3151 embeddings of dim 49152
2025-03-09 09:58:10,246 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0235 secs
2025-03-09 09:58:10,246 [INFO]: 	Compute estimated construction time of the index 03/09/2025, 09:58:10
2025-03-09 09:58:10,246 [INFO]: 		-> Train: 16.7 minutes
2025-03-09 09:58:10,246 [INFO]: 		-> Add: 1.7 seconds
2025-03-09 09:58:10,246 [INFO]: 		Total: 16.7 minutes
2025-03-09 09:58:10,246 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0001 secs
2025-03-09 09:58:10,246 [INFO]: 	Checking that your have enough memory available to create the index 03/09/2025, 09:58:10
2025-03-09 09:58:10,247 [INFO]: 650.3MB of memory will be needed to build the index (more might be used if you have more)
2025-03-09 09:58:10,247 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0001 secs
2025-03-09 09:58:10,247 [INFO]: 	Selecting most promising index types given data characteristics 03/09/2025, 09:58:10
2025-03-09 09:58:10,247 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-09 09:58:10,247 [INFO]: 	Creating the index 03/09/2025, 09:58:10
2025-03-09 09:58:10,247 [INFO]: 		-> Instanciate the index HNSW15 03/09/2025, 09:58:10
2025-03-09 09:58:10,248 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0010 secs
2025-03-09 09:58:10,248 [INFO]: 		-> Adding the vectors to the index 03/09/2025, 09:58:10
2025-03-09 09:58:10,248 [INFO]: The memory available for adding the vectors is 49.4GB(total available - used by the index)
2025-03-09 09:58:10,248 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/13 [00:00<?, ?it/s]  8%|▊         | 1/13 [00:00<00:02,  5.29it/s] 15%|█▌        | 2/13 [00:00<00:01,  6.92it/s] 23%|██▎       | 3/13 [00:00<00:01,  7.94it/s] 31%|███       | 4/13 [00:00<00:01,  8.60it/s] 38%|███▊      | 5/13 [00:00<00:00,  8.78it/s] 46%|████▌     | 6/13 [00:00<00:00,  8.90it/s] 54%|█████▍    | 7/13 [00:00<00:00,  8.95it/s] 62%|██████▏   | 8/13 [00:00<00:00,  8.99it/s] 69%|██████▉   | 9/13 [00:01<00:00,  9.16it/s] 77%|███████▋  | 10/13 [00:01<00:00,  9.14it/s] 85%|████████▍ | 11/13 [00:01<00:00,  9.14it/s] 92%|█████████▏| 12/13 [00:01<00:00,  8.69it/s]100%|██████████| 13/13 [00:03<00:00,  1.26it/s]100%|██████████| 13/13 [00:03<00:00,  3.46it/s]
2025-03-09 09:58:14,005 [INFO]: 	Computing best hyperparameters for index knn.index 03/09/2025, 09:58:14
2025-03-09 09:58:45,381 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 31.3759 secs
2025-03-09 09:58:45,381 [INFO]: The best hyperparameters are: efSearch=193
2025-03-09 09:58:45,381 [INFO]: 	Compute fast metrics 03/09/2025, 09:58:45
  0%|          | 0/4 [00:00<?, ?it/s] 25%|██▌       | 1/4 [00:00<00:00,  4.74it/s] 50%|█████     | 2/4 [00:00<00:00,  6.42it/s] 75%|███████▌  | 3/4 [00:00<00:00,  7.17it/s] 75%|███████▌  | 3/4 [00:00<00:00,  5.46it/s]
2025-03-09 09:59:02,282 [INFO]: 	>>> Finished "Compute fast metrics" in 16.9002 secs
2025-03-09 09:59:02,284 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 52.0356 secs
2025-03-09 09:59:02,284 [INFO]: {
2025-03-09 09:59:02,284 [INFO]: 	index_key: HNSW15
2025-03-09 09:59:02,284 [INFO]: 	index_param: efSearch=193
2025-03-09 09:59:02,284 [INFO]: 	index_path: knn.index
2025-03-09 09:59:02,284 [INFO]: 	size in bytes: 619939810
2025-03-09 09:59:02,284 [INFO]: 	avg_search_speed_ms: 9.602414808976116
2025-03-09 09:59:02,284 [INFO]: 	99p_search_speed_ms: 19.53789378050714
2025-03-09 09:59:02,284 [INFO]: 	reconstruction error %: 0.0
2025-03-09 09:59:02,284 [INFO]: 	nb vectors: 3151
2025-03-09 09:59:02,284 [INFO]: 	vectors dimension: 49152
2025-03-09 09:59:02,284 [INFO]: 	compression ratio: 0.999309607169767
2025-03-09 09:59:02,284 [INFO]: }
2025-03-09 09:59:02,284 [INFO]: 	>>> Finished "Creating the index" in 52.0370 secs
2025-03-09 09:59:02,284 [INFO]: >>> Finished "Launching the whole pipeline" in 52.0612 secs
2025-03-09 09:59:02: [retrieval_preprocessing] calculating distances ...
2025-03-09 09:59:03: [retrieval_preprocessing] finished and saved retrieval indices for episode 14612 [episode count 7/20]
[retrieval_preprocessing] for episode 16535 [episode count 8/20], we have num_retrieval=np.int64(3166) num_query=np.int64(139)
2025-03-09 09:59:04,341 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-09 09:59:05,209 [INFO]: Launching the whole pipeline 03/09/2025, 09:59:05
2025-03-09 09:59:05,209 [INFO]: Reading total number of vectors and dimension 03/09/2025, 09:59:05
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1821.23it/s]
2025-03-09 09:59:05,237 [INFO]: There are 3166 embeddings of dim 49152
2025-03-09 09:59:05,238 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0287 secs
2025-03-09 09:59:05,238 [INFO]: 	Compute estimated construction time of the index 03/09/2025, 09:59:05
2025-03-09 09:59:05,238 [INFO]: 		-> Train: 16.7 minutes
2025-03-09 09:59:05,239 [INFO]: 		-> Add: 1.7 seconds
2025-03-09 09:59:05,239 [INFO]: 		Total: 16.7 minutes
2025-03-09 09:59:05,239 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0005 secs
2025-03-09 09:59:05,239 [INFO]: 	Checking that your have enough memory available to create the index 03/09/2025, 09:59:05
2025-03-09 09:59:05,239 [INFO]: 653.4MB of memory will be needed to build the index (more might be used if you have more)
2025-03-09 09:59:05,239 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0004 secs
2025-03-09 09:59:05,239 [INFO]: 	Selecting most promising index types given data characteristics 03/09/2025, 09:59:05
2025-03-09 09:59:05,239 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-09 09:59:05,240 [INFO]: 	Creating the index 03/09/2025, 09:59:05
2025-03-09 09:59:05,240 [INFO]: 		-> Instanciate the index HNSW15 03/09/2025, 09:59:05
2025-03-09 09:59:05,243 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0029 secs
2025-03-09 09:59:05,243 [INFO]: 		-> Adding the vectors to the index 03/09/2025, 09:59:05
2025-03-09 09:59:05,243 [INFO]: The memory available for adding the vectors is 49.4GB(total available - used by the index)
2025-03-09 09:59:05,243 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/13 [00:00<?, ?it/s]  8%|▊         | 1/13 [00:00<00:01,  7.54it/s] 31%|███       | 4/13 [00:00<00:00, 16.55it/s] 54%|█████▍    | 7/13 [00:00<00:00, 18.06it/s] 69%|██████▉   | 9/13 [00:00<00:00, 18.30it/s] 85%|████████▍ | 11/13 [00:00<00:00, 18.61it/s]100%|██████████| 13/13 [00:02<00:00,  2.77it/s]100%|██████████| 13/13 [00:02<00:00,  4.87it/s]
2025-03-09 09:59:07,918 [INFO]: 	Computing best hyperparameters for index knn.index 03/09/2025, 09:59:07
2025-03-09 09:59:37,310 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 29.3918 secs
2025-03-09 09:59:37,311 [INFO]: The best hyperparameters are: efSearch=188
2025-03-09 09:59:37,311 [INFO]: 	Compute fast metrics 03/09/2025, 09:59:37
  0%|          | 0/4 [00:00<?, ?it/s] 25%|██▌       | 1/4 [00:00<00:00,  5.17it/s] 50%|█████     | 2/4 [00:00<00:00,  6.57it/s] 75%|███████▌  | 3/4 [00:00<00:00,  7.41it/s] 75%|███████▌  | 3/4 [00:00<00:00,  5.58it/s]
2025-03-09 09:59:53,486 [INFO]: 	>>> Finished "Compute fast metrics" in 16.1752 secs
2025-03-09 09:59:53,488 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 48.2448 secs
2025-03-09 09:59:53,488 [INFO]: {
2025-03-09 09:59:53,488 [INFO]: 	index_key: HNSW15
2025-03-09 09:59:53,488 [INFO]: 	index_param: efSearch=188
2025-03-09 09:59:53,488 [INFO]: 	index_path: knn.index
2025-03-09 09:59:53,488 [INFO]: 	size in bytes: 622890910
2025-03-09 09:59:53,488 [INFO]: 	avg_search_speed_ms: 7.964057549218808
2025-03-09 09:59:53,488 [INFO]: 	99p_search_speed_ms: 13.27751543140043
2025-03-09 09:59:53,488 [INFO]: 	reconstruction error %: 0.0
2025-03-09 09:59:53,488 [INFO]: 	nb vectors: 3166
2025-03-09 09:59:53,488 [INFO]: 	vectors dimension: 49152
2025-03-09 09:59:53,488 [INFO]: 	compression ratio: 0.9993096993500836
2025-03-09 09:59:53,488 [INFO]: }
2025-03-09 09:59:53,488 [INFO]: 	>>> Finished "Creating the index" in 48.2485 secs
2025-03-09 09:59:53,488 [INFO]: >>> Finished "Launching the whole pipeline" in 48.2792 secs
2025-03-09 09:59:54: [retrieval_preprocessing] calculating distances ...
2025-03-09 09:59:54: [retrieval_preprocessing] finished and saved retrieval indices for episode 16535 [episode count 8/20]
[retrieval_preprocessing] for episode 35352 [episode count 9/20], we have num_retrieval=np.int64(3155) num_query=np.int64(150)
2025-03-09 09:59:54,945 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-09 09:59:55,740 [INFO]: Launching the whole pipeline 03/09/2025, 09:59:55
2025-03-09 09:59:55,740 [INFO]: Reading total number of vectors and dimension 03/09/2025, 09:59:55
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1417.95it/s]
2025-03-09 09:59:55,768 [INFO]: There are 3155 embeddings of dim 49152
2025-03-09 09:59:55,768 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0280 secs
2025-03-09 09:59:55,768 [INFO]: 	Compute estimated construction time of the index 03/09/2025, 09:59:55
2025-03-09 09:59:55,768 [INFO]: 		-> Train: 16.7 minutes
2025-03-09 09:59:55,768 [INFO]: 		-> Add: 1.7 seconds
2025-03-09 09:59:55,768 [INFO]: 		Total: 16.7 minutes
2025-03-09 09:59:55,768 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0002 secs
2025-03-09 09:59:55,768 [INFO]: 	Checking that your have enough memory available to create the index 03/09/2025, 09:59:55
2025-03-09 09:59:55,768 [INFO]: 651.1MB of memory will be needed to build the index (more might be used if you have more)
2025-03-09 09:59:55,769 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0002 secs
2025-03-09 09:59:55,769 [INFO]: 	Selecting most promising index types given data characteristics 03/09/2025, 09:59:55
2025-03-09 09:59:55,769 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-09 09:59:55,769 [INFO]: 	Creating the index 03/09/2025, 09:59:55
2025-03-09 09:59:55,769 [INFO]: 		-> Instanciate the index HNSW15 03/09/2025, 09:59:55
2025-03-09 09:59:55,771 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0020 secs
2025-03-09 09:59:55,771 [INFO]: 		-> Adding the vectors to the index 03/09/2025, 09:59:55
2025-03-09 09:59:55,771 [INFO]: The memory available for adding the vectors is 49.4GB(total available - used by the index)
2025-03-09 09:59:55,771 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/13 [00:00<?, ?it/s]  8%|▊         | 1/13 [00:00<00:01,  6.92it/s] 23%|██▎       | 3/13 [00:00<00:00, 10.77it/s] 38%|███▊      | 5/13 [00:00<00:00, 11.90it/s] 54%|█████▍    | 7/13 [00:00<00:00, 12.18it/s] 69%|██████▉   | 9/13 [00:00<00:00, 12.43it/s] 85%|████████▍ | 11/13 [00:00<00:00, 12.84it/s]100%|██████████| 13/13 [00:03<00:00,  2.44it/s]100%|██████████| 13/13 [00:03<00:00,  4.25it/s]
2025-03-09 09:59:58,832 [INFO]: 	Computing best hyperparameters for index knn.index 03/09/2025, 09:59:58
2025-03-09 10:00:30,059 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 31.2268 secs
2025-03-09 10:00:30,059 [INFO]: The best hyperparameters are: efSearch=203
2025-03-09 10:00:30,060 [INFO]: 	Compute fast metrics 03/09/2025, 10:00:30
  0%|          | 0/4 [00:00<?, ?it/s] 25%|██▌       | 1/4 [00:00<00:00,  5.18it/s] 50%|█████     | 2/4 [00:00<00:00,  6.75it/s] 75%|███████▌  | 3/4 [00:00<00:00,  7.51it/s] 75%|███████▌  | 3/4 [00:00<00:00,  5.72it/s]
2025-03-09 10:00:45,981 [INFO]: 	>>> Finished "Compute fast metrics" in 15.9209 secs
2025-03-09 10:00:46,016 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 50.2451 secs
2025-03-09 10:00:46,016 [INFO]: {
2025-03-09 10:00:46,017 [INFO]: 	index_key: HNSW15
2025-03-09 10:00:46,017 [INFO]: 	index_param: efSearch=203
2025-03-09 10:00:46,017 [INFO]: 	index_path: knn.index
2025-03-09 10:00:46,017 [INFO]: 	size in bytes: 620726770
2025-03-09 10:00:46,017 [INFO]: 	avg_search_speed_ms: 9.053140376985276
2025-03-09 10:00:46,017 [INFO]: 	99p_search_speed_ms: 15.28709889389577
2025-03-09 10:00:46,017 [INFO]: 	reconstruction error %: 0.0
2025-03-09 10:00:46,017 [INFO]: 	nb vectors: 3155
2025-03-09 10:00:46,017 [INFO]: 	vectors dimension: 49152
2025-03-09 10:00:46,017 [INFO]: 	compression ratio: 0.9993096318368869
2025-03-09 10:00:46,017 [INFO]: }
2025-03-09 10:00:46,017 [INFO]: 	>>> Finished "Creating the index" in 50.2481 secs
2025-03-09 10:00:46,017 [INFO]: >>> Finished "Launching the whole pipeline" in 50.2772 secs
2025-03-09 10:00:46: [retrieval_preprocessing] calculating distances ...
2025-03-09 10:00:47: [retrieval_preprocessing] finished and saved retrieval indices for episode 35352 [episode count 9/20]
[retrieval_preprocessing] for episode 18841 [episode count 10/20], we have num_retrieval=np.int64(3140) num_query=np.int64(165)
2025-03-09 10:00:48,370 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-09 10:00:48,807 [INFO]: Launching the whole pipeline 03/09/2025, 10:00:48
2025-03-09 10:00:48,807 [INFO]: Reading total number of vectors and dimension 03/09/2025, 10:00:48
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1760.83it/s]
2025-03-09 10:00:48,833 [INFO]: There are 3140 embeddings of dim 49152
2025-03-09 10:00:48,833 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0255 secs
2025-03-09 10:00:48,833 [INFO]: 	Compute estimated construction time of the index 03/09/2025, 10:00:48
2025-03-09 10:00:48,833 [INFO]: 		-> Train: 16.7 minutes
2025-03-09 10:00:48,833 [INFO]: 		-> Add: 1.7 seconds
2025-03-09 10:00:48,833 [INFO]: 		Total: 16.7 minutes
2025-03-09 10:00:48,833 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0001 secs
2025-03-09 10:00:48,833 [INFO]: 	Checking that your have enough memory available to create the index 03/09/2025, 10:00:48
2025-03-09 10:00:48,833 [INFO]: 648.0MB of memory will be needed to build the index (more might be used if you have more)
2025-03-09 10:00:48,833 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0001 secs
2025-03-09 10:00:48,833 [INFO]: 	Selecting most promising index types given data characteristics 03/09/2025, 10:00:48
2025-03-09 10:00:48,833 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-09 10:00:48,833 [INFO]: 	Creating the index 03/09/2025, 10:00:48
2025-03-09 10:00:48,833 [INFO]: 		-> Instanciate the index HNSW15 03/09/2025, 10:00:48
2025-03-09 10:00:48,834 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0009 secs
2025-03-09 10:00:48,834 [INFO]: 		-> Adding the vectors to the index 03/09/2025, 10:00:48
2025-03-09 10:00:48,834 [INFO]: The memory available for adding the vectors is 49.4GB(total available - used by the index)
2025-03-09 10:00:48,834 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/13 [00:00<?, ?it/s]  8%|▊         | 1/13 [00:00<00:02,  4.93it/s] 23%|██▎       | 3/13 [00:00<00:01,  9.39it/s] 38%|███▊      | 5/13 [00:00<00:00,  9.82it/s] 54%|█████▍    | 7/13 [00:00<00:00, 10.22it/s] 69%|██████▉   | 9/13 [00:00<00:00, 10.31it/s] 85%|████████▍ | 11/13 [00:01<00:00, 10.00it/s]100%|██████████| 13/13 [00:03<00:00,  2.06it/s]100%|██████████| 13/13 [00:03<00:00,  3.57it/s]
2025-03-09 10:00:52,477 [INFO]: 	Computing best hyperparameters for index knn.index 03/09/2025, 10:00:52
2025-03-09 10:01:25,695 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 33.2182 secs
2025-03-09 10:01:25,696 [INFO]: The best hyperparameters are: efSearch=172
2025-03-09 10:01:25,696 [INFO]: 	Compute fast metrics 03/09/2025, 10:01:25
  0%|          | 0/4 [00:00<?, ?it/s] 25%|██▌       | 1/4 [00:00<00:00,  5.22it/s] 50%|█████     | 2/4 [00:00<00:00,  6.88it/s] 75%|███████▌  | 3/4 [00:00<00:00,  7.70it/s] 75%|███████▌  | 3/4 [00:00<00:00,  5.81it/s]
2025-03-09 10:01:41,379 [INFO]: 	>>> Finished "Compute fast metrics" in 15.6835 secs
2025-03-09 10:01:41,988 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 53.1540 secs
2025-03-09 10:01:41,989 [INFO]: {
2025-03-09 10:01:41,989 [INFO]: 	index_key: HNSW15
2025-03-09 10:01:41,989 [INFO]: 	index_param: efSearch=172
2025-03-09 10:01:41,989 [INFO]: 	index_path: knn.index
2025-03-09 10:01:41,989 [INFO]: 	size in bytes: 617775610
2025-03-09 10:01:41,989 [INFO]: 	avg_search_speed_ms: 8.230231845283827
2025-03-09 10:01:41,989 [INFO]: 	99p_search_speed_ms: 14.385619014501565
2025-03-09 10:01:41,989 [INFO]: 	reconstruction error %: 0.0
2025-03-09 10:01:41,989 [INFO]: 	nb vectors: 3140
2025-03-09 10:01:41,989 [INFO]: 	vectors dimension: 49152
2025-03-09 10:01:41,989 [INFO]: 	compression ratio: 0.9993096360667265
2025-03-09 10:01:41,989 [INFO]: }
2025-03-09 10:01:41,989 [INFO]: 	>>> Finished "Creating the index" in 53.1560 secs
2025-03-09 10:01:41,989 [INFO]: >>> Finished "Launching the whole pipeline" in 53.1822 secs
2025-03-09 10:01:42: [retrieval_preprocessing] calculating distances ...
2025-03-09 10:01:43: [retrieval_preprocessing] finished and saved retrieval indices for episode 18841 [episode count 10/20]
[retrieval_preprocessing] for episode 18842 [episode count 11/20], we have num_retrieval=np.int64(3117) num_query=np.int64(188)
2025-03-09 10:01:43,842 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-09 10:01:44,239 [INFO]: Launching the whole pipeline 03/09/2025, 10:01:44
2025-03-09 10:01:44,239 [INFO]: Reading total number of vectors and dimension 03/09/2025, 10:01:44
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1601.49it/s]
2025-03-09 10:01:44,263 [INFO]: There are 3117 embeddings of dim 49152
2025-03-09 10:01:44,264 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0245 secs
2025-03-09 10:01:44,264 [INFO]: 	Compute estimated construction time of the index 03/09/2025, 10:01:44
2025-03-09 10:01:44,264 [INFO]: 		-> Train: 16.7 minutes
2025-03-09 10:01:44,264 [INFO]: 		-> Add: 1.7 seconds
2025-03-09 10:01:44,264 [INFO]: 		Total: 16.7 minutes
2025-03-09 10:01:44,264 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0001 secs
2025-03-09 10:01:44,264 [INFO]: 	Checking that your have enough memory available to create the index 03/09/2025, 10:01:44
2025-03-09 10:01:44,264 [INFO]: 643.3MB of memory will be needed to build the index (more might be used if you have more)
2025-03-09 10:01:44,264 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0001 secs
2025-03-09 10:01:44,264 [INFO]: 	Selecting most promising index types given data characteristics 03/09/2025, 10:01:44
2025-03-09 10:01:44,264 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-09 10:01:44,264 [INFO]: 	Creating the index 03/09/2025, 10:01:44
2025-03-09 10:01:44,264 [INFO]: 		-> Instanciate the index HNSW15 03/09/2025, 10:01:44
2025-03-09 10:01:44,265 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0010 secs
2025-03-09 10:01:44,265 [INFO]: 		-> Adding the vectors to the index 03/09/2025, 10:01:44
2025-03-09 10:01:44,265 [INFO]: The memory available for adding the vectors is 49.4GB(total available - used by the index)
2025-03-09 10:01:44,265 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/13 [00:00<?, ?it/s]  8%|▊         | 1/13 [00:00<00:02,  5.52it/s] 15%|█▌        | 2/13 [00:00<00:01,  6.97it/s] 23%|██▎       | 3/13 [00:00<00:01,  7.59it/s] 31%|███       | 4/13 [00:00<00:01,  8.06it/s] 38%|███▊      | 5/13 [00:00<00:00,  8.30it/s] 46%|████▌     | 6/13 [00:00<00:00,  8.33it/s] 54%|█████▍    | 7/13 [00:00<00:00,  8.36it/s] 62%|██████▏   | 8/13 [00:01<00:00,  8.34it/s] 69%|██████▉   | 9/13 [00:01<00:00,  8.03it/s] 77%|███████▋  | 10/13 [00:01<00:00,  8.27it/s] 85%|████████▍ | 11/13 [00:01<00:00,  8.52it/s] 92%|█████████▏| 12/13 [00:01<00:00,  8.57it/s]100%|██████████| 13/13 [00:04<00:00,  1.17it/s]100%|██████████| 13/13 [00:04<00:00,  3.23it/s]
2025-03-09 10:01:48,291 [INFO]: 	Computing best hyperparameters for index knn.index 03/09/2025, 10:01:48
2025-03-09 10:02:17,300 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 29.0086 secs
2025-03-09 10:02:17,300 [INFO]: The best hyperparameters are: efSearch=219
2025-03-09 10:02:17,301 [INFO]: 	Compute fast metrics 03/09/2025, 10:02:17
  0%|          | 0/4 [00:00<?, ?it/s] 25%|██▌       | 1/4 [00:00<00:00,  5.19it/s] 50%|█████     | 2/4 [00:00<00:00,  6.92it/s] 75%|███████▌  | 3/4 [00:00<00:00,  7.86it/s] 75%|███████▌  | 3/4 [00:00<00:00,  5.89it/s]
2025-03-09 10:02:33,056 [INFO]: 	>>> Finished "Compute fast metrics" in 15.7552 secs
2025-03-09 10:02:33,058 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 48.7928 secs
2025-03-09 10:02:33,058 [INFO]: {
2025-03-09 10:02:33,058 [INFO]: 	index_key: HNSW15
2025-03-09 10:02:33,058 [INFO]: 	index_param: efSearch=219
2025-03-09 10:02:33,058 [INFO]: 	index_path: knn.index
2025-03-09 10:02:33,058 [INFO]: 	size in bytes: 613250410
2025-03-09 10:02:33,058 [INFO]: 	avg_search_speed_ms: 9.589000348553547
2025-03-09 10:02:33,058 [INFO]: 	99p_search_speed_ms: 15.966754774563013
2025-03-09 10:02:33,058 [INFO]: 	reconstruction error %: 0.0
2025-03-09 10:02:33,058 [INFO]: 	nb vectors: 3117
2025-03-09 10:02:33,058 [INFO]: 	vectors dimension: 49152
2025-03-09 10:02:33,058 [INFO]: 	compression ratio: 0.9993097860301471
2025-03-09 10:02:33,058 [INFO]: }
2025-03-09 10:02:33,058 [INFO]: 	>>> Finished "Creating the index" in 48.7942 secs
2025-03-09 10:02:33,058 [INFO]: >>> Finished "Launching the whole pipeline" in 48.8192 secs
2025-03-09 10:02:33: [retrieval_preprocessing] calculating distances ...
2025-03-09 10:02:34: [retrieval_preprocessing] finished and saved retrieval indices for episode 18842 [episode count 11/20]
[retrieval_preprocessing] for episode 92954 [episode count 12/20], we have num_retrieval=np.int64(3166) num_query=np.int64(139)
2025-03-09 10:02:35,208 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-09 10:02:36,392 [INFO]: Launching the whole pipeline 03/09/2025, 10:02:36
2025-03-09 10:02:36,392 [INFO]: Reading total number of vectors and dimension 03/09/2025, 10:02:36
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1429.06it/s]
2025-03-09 10:02:36,419 [INFO]: There are 3166 embeddings of dim 49152
2025-03-09 10:02:36,419 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0270 secs
2025-03-09 10:02:36,419 [INFO]: 	Compute estimated construction time of the index 03/09/2025, 10:02:36
2025-03-09 10:02:36,419 [INFO]: 		-> Train: 16.7 minutes
2025-03-09 10:02:36,419 [INFO]: 		-> Add: 1.7 seconds
2025-03-09 10:02:36,420 [INFO]: 		Total: 16.7 minutes
2025-03-09 10:02:36,420 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0001 secs
2025-03-09 10:02:36,420 [INFO]: 	Checking that your have enough memory available to create the index 03/09/2025, 10:02:36
2025-03-09 10:02:36,420 [INFO]: 653.4MB of memory will be needed to build the index (more might be used if you have more)
2025-03-09 10:02:36,420 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0001 secs
2025-03-09 10:02:36,420 [INFO]: 	Selecting most promising index types given data characteristics 03/09/2025, 10:02:36
2025-03-09 10:02:36,420 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-09 10:02:36,420 [INFO]: 	Creating the index 03/09/2025, 10:02:36
2025-03-09 10:02:36,420 [INFO]: 		-> Instanciate the index HNSW15 03/09/2025, 10:02:36
2025-03-09 10:02:36,421 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0010 secs
2025-03-09 10:02:36,421 [INFO]: 		-> Adding the vectors to the index 03/09/2025, 10:02:36
2025-03-09 10:02:36,421 [INFO]: The memory available for adding the vectors is 49.4GB(total available - used by the index)
2025-03-09 10:02:36,421 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/13 [00:00<?, ?it/s]  8%|▊         | 1/13 [00:00<00:02,  5.26it/s] 23%|██▎       | 3/13 [00:00<00:01,  9.33it/s] 38%|███▊      | 5/13 [00:00<00:00, 10.88it/s] 54%|█████▍    | 7/13 [00:00<00:00, 11.73it/s] 69%|██████▉   | 9/13 [00:00<00:00, 12.14it/s] 85%|████████▍ | 11/13 [00:00<00:00, 12.44it/s]100%|██████████| 13/13 [00:03<00:00,  2.41it/s]100%|██████████| 13/13 [00:03<00:00,  4.15it/s]
2025-03-09 10:02:39,560 [INFO]: 	Computing best hyperparameters for index knn.index 03/09/2025, 10:02:39
2025-03-09 10:03:07,107 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 27.5465 secs
2025-03-09 10:03:07,107 [INFO]: The best hyperparameters are: efSearch=184
2025-03-09 10:03:07,107 [INFO]: 	Compute fast metrics 03/09/2025, 10:03:07
  0%|          | 0/4 [00:00<?, ?it/s] 25%|██▌       | 1/4 [00:00<00:00,  7.05it/s] 50%|█████     | 2/4 [00:00<00:00,  8.03it/s] 75%|███████▌  | 3/4 [00:00<00:00,  8.26it/s] 75%|███████▌  | 3/4 [00:00<00:00,  6.30it/s]
2025-03-09 10:03:25,375 [INFO]: 	>>> Finished "Compute fast metrics" in 18.2677 secs
2025-03-09 10:03:25,377 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 48.9561 secs
2025-03-09 10:03:25,377 [INFO]: {
2025-03-09 10:03:25,377 [INFO]: 	index_key: HNSW15
2025-03-09 10:03:25,377 [INFO]: 	index_param: efSearch=184
2025-03-09 10:03:25,377 [INFO]: 	index_path: knn.index
2025-03-09 10:03:25,377 [INFO]: 	size in bytes: 622890910
2025-03-09 10:03:25,377 [INFO]: 	avg_search_speed_ms: 8.567835403216847
2025-03-09 10:03:25,377 [INFO]: 	99p_search_speed_ms: 15.41526560671626
2025-03-09 10:03:25,377 [INFO]: 	reconstruction error %: 0.0
2025-03-09 10:03:25,377 [INFO]: 	nb vectors: 3166
2025-03-09 10:03:25,377 [INFO]: 	vectors dimension: 49152
2025-03-09 10:03:25,377 [INFO]: 	compression ratio: 0.9993096993500836
2025-03-09 10:03:25,377 [INFO]: }
2025-03-09 10:03:25,377 [INFO]: 	>>> Finished "Creating the index" in 48.9575 secs
2025-03-09 10:03:25,377 [INFO]: >>> Finished "Launching the whole pipeline" in 48.9851 secs
2025-03-09 10:03:25: [retrieval_preprocessing] calculating distances ...
2025-03-09 10:03:26: [retrieval_preprocessing] finished and saved retrieval indices for episode 92954 [episode count 12/20]
[retrieval_preprocessing] for episode 39071 [episode count 13/20], we have num_retrieval=np.int64(3155) num_query=np.int64(150)
2025-03-09 10:03:27,201 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-09 10:03:27,657 [INFO]: Launching the whole pipeline 03/09/2025, 10:03:27
2025-03-09 10:03:27,657 [INFO]: Reading total number of vectors and dimension 03/09/2025, 10:03:27
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1702.92it/s]
2025-03-09 10:03:27,680 [INFO]: There are 3155 embeddings of dim 49152
2025-03-09 10:03:27,680 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0233 secs
2025-03-09 10:03:27,680 [INFO]: 	Compute estimated construction time of the index 03/09/2025, 10:03:27
2025-03-09 10:03:27,680 [INFO]: 		-> Train: 16.7 minutes
2025-03-09 10:03:27,680 [INFO]: 		-> Add: 1.7 seconds
2025-03-09 10:03:27,680 [INFO]: 		Total: 16.7 minutes
2025-03-09 10:03:27,680 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0001 secs
2025-03-09 10:03:27,681 [INFO]: 	Checking that your have enough memory available to create the index 03/09/2025, 10:03:27
2025-03-09 10:03:27,681 [INFO]: 651.1MB of memory will be needed to build the index (more might be used if you have more)
2025-03-09 10:03:27,681 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0001 secs
2025-03-09 10:03:27,681 [INFO]: 	Selecting most promising index types given data characteristics 03/09/2025, 10:03:27
2025-03-09 10:03:27,681 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-09 10:03:27,681 [INFO]: 	Creating the index 03/09/2025, 10:03:27
2025-03-09 10:03:27,681 [INFO]: 		-> Instanciate the index HNSW15 03/09/2025, 10:03:27
2025-03-09 10:03:27,682 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0011 secs
2025-03-09 10:03:27,682 [INFO]: 		-> Adding the vectors to the index 03/09/2025, 10:03:27
2025-03-09 10:03:27,682 [INFO]: The memory available for adding the vectors is 49.4GB(total available - used by the index)
2025-03-09 10:03:27,682 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/13 [00:00<?, ?it/s]  8%|▊         | 1/13 [00:00<00:02,  5.61it/s] 23%|██▎       | 3/13 [00:00<00:01,  8.96it/s] 38%|███▊      | 5/13 [00:00<00:00, 10.05it/s] 54%|█████▍    | 7/13 [00:00<00:00, 10.61it/s] 69%|██████▉   | 9/13 [00:00<00:00, 10.86it/s] 85%|████████▍ | 11/13 [00:01<00:00, 10.97it/s]100%|██████████| 13/13 [00:03<00:00,  2.52it/s]100%|██████████| 13/13 [00:03<00:00,  4.22it/s]
2025-03-09 10:03:30,766 [INFO]: 	Computing best hyperparameters for index knn.index 03/09/2025, 10:03:30
2025-03-09 10:03:59,461 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 28.6943 secs
2025-03-09 10:03:59,461 [INFO]: The best hyperparameters are: efSearch=245
2025-03-09 10:03:59,461 [INFO]: 	Compute fast metrics 03/09/2025, 10:03:59
  0%|          | 0/4 [00:00<?, ?it/s] 25%|██▌       | 1/4 [00:00<00:00,  4.99it/s] 50%|█████     | 2/4 [00:00<00:00,  6.72it/s] 75%|███████▌  | 3/4 [00:00<00:00,  7.54it/s] 75%|███████▌  | 3/4 [00:00<00:00,  5.77it/s]
2025-03-09 10:04:17,956 [INFO]: 	>>> Finished "Compute fast metrics" in 18.4955 secs
2025-03-09 10:04:17,958 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 50.2763 secs
2025-03-09 10:04:17,959 [INFO]: {
2025-03-09 10:04:17,959 [INFO]: 	index_key: HNSW15
2025-03-09 10:04:17,959 [INFO]: 	index_param: efSearch=245
2025-03-09 10:04:17,959 [INFO]: 	index_path: knn.index
2025-03-09 10:04:17,959 [INFO]: 	size in bytes: 620726770
2025-03-09 10:04:17,959 [INFO]: 	avg_search_speed_ms: 9.759480038248912
2025-03-09 10:04:17,959 [INFO]: 	99p_search_speed_ms: 16.51281449943781
2025-03-09 10:04:17,959 [INFO]: 	reconstruction error %: 0.0
2025-03-09 10:04:17,959 [INFO]: 	nb vectors: 3155
2025-03-09 10:04:17,959 [INFO]: 	vectors dimension: 49152
2025-03-09 10:04:17,959 [INFO]: 	compression ratio: 0.9993096318368869
2025-03-09 10:04:17,959 [INFO]: }
2025-03-09 10:04:17,959 [INFO]: 	>>> Finished "Creating the index" in 50.2779 secs
2025-03-09 10:04:17,959 [INFO]: >>> Finished "Launching the whole pipeline" in 50.3017 secs
2025-03-09 10:04:18: [retrieval_preprocessing] calculating distances ...
2025-03-09 10:04:19: [retrieval_preprocessing] finished and saved retrieval indices for episode 39071 [episode count 13/20]
[retrieval_preprocessing] for episode 20128 [episode count 14/20], we have num_retrieval=np.int64(3147) num_query=np.int64(158)
2025-03-09 10:04:20,155 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-09 10:04:20,602 [INFO]: Launching the whole pipeline 03/09/2025, 10:04:20
2025-03-09 10:04:20,602 [INFO]: Reading total number of vectors and dimension 03/09/2025, 10:04:20
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1243.86it/s]
2025-03-09 10:04:20,630 [INFO]: There are 3147 embeddings of dim 49152
2025-03-09 10:04:20,631 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0285 secs
2025-03-09 10:04:20,631 [INFO]: 	Compute estimated construction time of the index 03/09/2025, 10:04:20
2025-03-09 10:04:20,631 [INFO]: 		-> Train: 16.7 minutes
2025-03-09 10:04:20,631 [INFO]: 		-> Add: 1.7 seconds
2025-03-09 10:04:20,632 [INFO]: 		Total: 16.7 minutes
2025-03-09 10:04:20,632 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0004 secs
2025-03-09 10:04:20,632 [INFO]: 	Checking that your have enough memory available to create the index 03/09/2025, 10:04:20
2025-03-09 10:04:20,632 [INFO]: 649.5MB of memory will be needed to build the index (more might be used if you have more)
2025-03-09 10:04:20,632 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0004 secs
2025-03-09 10:04:20,632 [INFO]: 	Selecting most promising index types given data characteristics 03/09/2025, 10:04:20
2025-03-09 10:04:20,632 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-09 10:04:20,632 [INFO]: 	Creating the index 03/09/2025, 10:04:20
2025-03-09 10:04:20,633 [INFO]: 		-> Instanciate the index HNSW15 03/09/2025, 10:04:20
2025-03-09 10:04:20,635 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0020 secs
2025-03-09 10:04:20,635 [INFO]: 		-> Adding the vectors to the index 03/09/2025, 10:04:20
2025-03-09 10:04:20,635 [INFO]: The memory available for adding the vectors is 49.4GB(total available - used by the index)
2025-03-09 10:04:20,635 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/13 [00:00<?, ?it/s]  8%|▊         | 1/13 [00:00<00:01,  6.54it/s] 23%|██▎       | 3/13 [00:00<00:01,  9.55it/s] 38%|███▊      | 5/13 [00:00<00:00, 10.57it/s] 54%|█████▍    | 7/13 [00:00<00:00, 11.14it/s] 69%|██████▉   | 9/13 [00:00<00:00, 11.39it/s] 85%|████████▍ | 11/13 [00:01<00:00, 11.26it/s]100%|██████████| 13/13 [00:03<00:00,  2.13it/s]100%|██████████| 13/13 [00:03<00:00,  3.74it/s]
2025-03-09 10:04:24,118 [INFO]: 	Computing best hyperparameters for index knn.index 03/09/2025, 10:04:24
2025-03-09 10:04:54,269 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 30.1507 secs
2025-03-09 10:04:54,269 [INFO]: The best hyperparameters are: efSearch=206
2025-03-09 10:04:54,269 [INFO]: 	Compute fast metrics 03/09/2025, 10:04:54
  0%|          | 0/4 [00:00<?, ?it/s] 25%|██▌       | 1/4 [00:00<00:00,  4.73it/s] 50%|█████     | 2/4 [00:00<00:00,  5.79it/s] 75%|███████▌  | 3/4 [00:00<00:00,  6.21it/s]
2025-03-09 10:05:09,121 [INFO]: 	>>> Finished "Compute fast metrics" in 14.8523 secs
2025-03-09 10:05:09,124 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 48.4885 secs
2025-03-09 10:05:09,124 [INFO]: {
2025-03-09 10:05:09,124 [INFO]: 	index_key: HNSW15
2025-03-09 10:05:09,124 [INFO]: 	index_param: efSearch=206
2025-03-09 10:05:09,124 [INFO]: 	index_path: knn.index
2025-03-09 10:05:09,124 [INFO]: 	size in bytes: 619152790
2025-03-09 10:05:09,124 [INFO]: 	avg_search_speed_ms: 8.60489241894264
2025-03-09 10:05:09,124 [INFO]: 	99p_search_speed_ms: 14.312876178883025
2025-03-09 10:05:09,124 [INFO]: 	reconstruction error %: 0.0
2025-03-09 10:05:09,124 [INFO]: 	nb vectors: 3147
2025-03-09 10:05:09,124 [INFO]: 	vectors dimension: 49152
2025-03-09 10:05:09,124 [INFO]: 	compression ratio: 0.9993096792796492
2025-03-09 10:05:09,124 [INFO]: }
2025-03-09 10:05:09,124 [INFO]: 	>>> Finished "Creating the index" in 48.4914 secs
2025-03-09 10:05:09,124 [INFO]: >>> Finished "Launching the whole pipeline" in 48.5217 secs
2025-03-09 10:05:09: [retrieval_preprocessing] calculating distances ...
2025-03-09 10:05:10: [retrieval_preprocessing] finished and saved retrieval indices for episode 20128 [episode count 14/20]
[retrieval_preprocessing] for episode 80162 [episode count 15/20], we have num_retrieval=np.int64(3162) num_query=np.int64(143)
2025-03-09 10:05:11,380 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-09 10:05:12,168 [INFO]: Launching the whole pipeline 03/09/2025, 10:05:12
2025-03-09 10:05:12,168 [INFO]: Reading total number of vectors and dimension 03/09/2025, 10:05:12
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1959.04it/s]
2025-03-09 10:05:12,192 [INFO]: There are 3162 embeddings of dim 49152
2025-03-09 10:05:12,192 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0239 secs
2025-03-09 10:05:12,192 [INFO]: 	Compute estimated construction time of the index 03/09/2025, 10:05:12
2025-03-09 10:05:12,192 [INFO]: 		-> Train: 16.7 minutes
2025-03-09 10:05:12,192 [INFO]: 		-> Add: 1.7 seconds
2025-03-09 10:05:12,192 [INFO]: 		Total: 16.7 minutes
2025-03-09 10:05:12,192 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0001 secs
2025-03-09 10:05:12,192 [INFO]: 	Checking that your have enough memory available to create the index 03/09/2025, 10:05:12
2025-03-09 10:05:12,192 [INFO]: 652.6MB of memory will be needed to build the index (more might be used if you have more)
2025-03-09 10:05:12,192 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0001 secs
2025-03-09 10:05:12,192 [INFO]: 	Selecting most promising index types given data characteristics 03/09/2025, 10:05:12
2025-03-09 10:05:12,192 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-09 10:05:12,192 [INFO]: 	Creating the index 03/09/2025, 10:05:12
2025-03-09 10:05:12,193 [INFO]: 		-> Instanciate the index HNSW15 03/09/2025, 10:05:12
2025-03-09 10:05:12,193 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0009 secs
2025-03-09 10:05:12,194 [INFO]: 		-> Adding the vectors to the index 03/09/2025, 10:05:12
2025-03-09 10:05:12,194 [INFO]: The memory available for adding the vectors is 49.4GB(total available - used by the index)
2025-03-09 10:05:12,194 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/13 [00:00<?, ?it/s]  8%|▊         | 1/13 [00:00<00:02,  5.64it/s] 15%|█▌        | 2/13 [00:00<00:01,  7.09it/s] 23%|██▎       | 3/13 [00:00<00:01,  7.98it/s] 31%|███       | 4/13 [00:00<00:01,  8.38it/s] 38%|███▊      | 5/13 [00:00<00:00,  8.47it/s] 46%|████▌     | 6/13 [00:00<00:00,  8.72it/s] 54%|█████▍    | 7/13 [00:00<00:00,  8.58it/s] 62%|██████▏   | 8/13 [00:00<00:00,  8.42it/s] 69%|██████▉   | 9/13 [00:01<00:00,  8.77it/s] 77%|███████▋  | 10/13 [00:01<00:00,  8.58it/s] 85%|████████▍ | 11/13 [00:01<00:00,  8.08it/s] 92%|█████████▏| 12/13 [00:01<00:00,  8.03it/s]100%|██████████| 13/13 [00:03<00:00,  1.31it/s]100%|██████████| 13/13 [00:03<00:00,  3.52it/s]
2025-03-09 10:05:15,894 [INFO]: 	Computing best hyperparameters for index knn.index 03/09/2025, 10:05:15
2025-03-09 10:05:44,119 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 28.2251 secs
2025-03-09 10:05:44,119 [INFO]: The best hyperparameters are: efSearch=213
2025-03-09 10:05:44,120 [INFO]: 	Compute fast metrics 03/09/2025, 10:05:44
  0%|          | 0/4 [00:00<?, ?it/s] 25%|██▌       | 1/4 [00:00<00:00,  5.97it/s] 75%|███████▌  | 3/4 [00:00<00:00,  9.59it/s] 75%|███████▌  | 3/4 [00:00<00:00,  7.46it/s]
2025-03-09 10:05:58,340 [INFO]: 	>>> Finished "Compute fast metrics" in 14.2200 secs
2025-03-09 10:05:58,342 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 46.1480 secs
2025-03-09 10:05:58,342 [INFO]: {
2025-03-09 10:05:58,342 [INFO]: 	index_key: HNSW15
2025-03-09 10:05:58,342 [INFO]: 	index_param: efSearch=213
2025-03-09 10:05:58,342 [INFO]: 	index_path: knn.index
2025-03-09 10:05:58,342 [INFO]: 	size in bytes: 622103950
2025-03-09 10:05:58,342 [INFO]: 	avg_search_speed_ms: 8.626707814066535
2025-03-09 10:05:58,342 [INFO]: 	99p_search_speed_ms: 12.59692378342152
2025-03-09 10:05:58,342 [INFO]: 	reconstruction error %: 0.0
2025-03-09 10:05:58,342 [INFO]: 	nb vectors: 3162
2025-03-09 10:05:58,342 [INFO]: 	vectors dimension: 49152
2025-03-09 10:05:58,342 [INFO]: 	compression ratio: 0.9993096748541783
2025-03-09 10:05:58,342 [INFO]: }
2025-03-09 10:05:58,342 [INFO]: 	>>> Finished "Creating the index" in 46.1493 secs
2025-03-09 10:05:58,342 [INFO]: >>> Finished "Launching the whole pipeline" in 46.1737 secs
2025-03-09 10:05:58: [retrieval_preprocessing] calculating distances ...
2025-03-09 10:05:59: [retrieval_preprocessing] finished and saved retrieval indices for episode 80162 [episode count 15/20]
[retrieval_preprocessing] for episode 1578 [episode count 16/20], we have num_retrieval=np.int64(3083) num_query=np.int64(222)
2025-03-09 10:06:00,413 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-09 10:06:00,878 [INFO]: Launching the whole pipeline 03/09/2025, 10:06:00
2025-03-09 10:06:00,878 [INFO]: Reading total number of vectors and dimension 03/09/2025, 10:06:00
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 2045.00it/s]
2025-03-09 10:06:00,903 [INFO]: There are 3083 embeddings of dim 49152
2025-03-09 10:06:00,904 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0258 secs
2025-03-09 10:06:00,904 [INFO]: 	Compute estimated construction time of the index 03/09/2025, 10:06:00
2025-03-09 10:06:00,904 [INFO]: 		-> Train: 16.7 minutes
2025-03-09 10:06:00,904 [INFO]: 		-> Add: 1.7 seconds
2025-03-09 10:06:00,904 [INFO]: 		Total: 16.7 minutes
2025-03-09 10:06:00,904 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0002 secs
2025-03-09 10:06:00,904 [INFO]: 	Checking that your have enough memory available to create the index 03/09/2025, 10:06:00
2025-03-09 10:06:00,905 [INFO]: 636.3MB of memory will be needed to build the index (more might be used if you have more)
2025-03-09 10:06:00,905 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0004 secs
2025-03-09 10:06:00,905 [INFO]: 	Selecting most promising index types given data characteristics 03/09/2025, 10:06:00
2025-03-09 10:06:00,905 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-09 10:06:00,905 [INFO]: 	Creating the index 03/09/2025, 10:06:00
2025-03-09 10:06:00,905 [INFO]: 		-> Instanciate the index HNSW15 03/09/2025, 10:06:00
2025-03-09 10:06:00,908 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0024 secs
2025-03-09 10:06:00,908 [INFO]: 		-> Adding the vectors to the index 03/09/2025, 10:06:00
2025-03-09 10:06:00,908 [INFO]: The memory available for adding the vectors is 49.4GB(total available - used by the index)
2025-03-09 10:06:00,909 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/13 [00:00<?, ?it/s]  8%|▊         | 1/13 [00:00<00:02,  5.61it/s] 23%|██▎       | 3/13 [00:00<00:01,  9.11it/s] 38%|███▊      | 5/13 [00:00<00:00, 10.12it/s] 54%|█████▍    | 7/13 [00:00<00:00, 10.83it/s] 69%|██████▉   | 9/13 [00:00<00:00, 11.69it/s] 85%|████████▍ | 11/13 [00:00<00:00, 12.14it/s]100%|██████████| 13/13 [00:03<00:00,  2.46it/s]100%|██████████| 13/13 [00:03<00:00,  4.19it/s]
2025-03-09 10:06:04,019 [INFO]: 	Computing best hyperparameters for index knn.index 03/09/2025, 10:06:04
2025-03-09 10:06:32,732 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 28.7121 secs
2025-03-09 10:06:32,732 [INFO]: The best hyperparameters are: efSearch=232
2025-03-09 10:06:32,732 [INFO]: 	Compute fast metrics 03/09/2025, 10:06:32
  0%|          | 0/4 [00:00<?, ?it/s] 25%|██▌       | 1/4 [00:00<00:00,  5.44it/s] 50%|█████     | 2/4 [00:00<00:00,  7.12it/s] 75%|███████▌  | 3/4 [00:00<00:00,  7.91it/s] 75%|███████▌  | 3/4 [00:00<00:00,  5.98it/s]
2025-03-09 10:06:48,642 [INFO]: 	>>> Finished "Compute fast metrics" in 15.9097 secs
2025-03-09 10:06:48,644 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 47.7355 secs
2025-03-09 10:06:48,644 [INFO]: {
2025-03-09 10:06:48,644 [INFO]: 	index_key: HNSW15
2025-03-09 10:06:48,644 [INFO]: 	index_param: efSearch=232
2025-03-09 10:06:48,644 [INFO]: 	index_path: knn.index
2025-03-09 10:06:48,644 [INFO]: 	size in bytes: 606561070
2025-03-09 10:06:48,644 [INFO]: 	avg_search_speed_ms: 9.146602889514389
2025-03-09 10:06:48,644 [INFO]: 	99p_search_speed_ms: 16.33081549778578
2025-03-09 10:06:48,644 [INFO]: 	reconstruction error %: 0.0
2025-03-09 10:06:48,644 [INFO]: 	nb vectors: 3083
2025-03-09 10:06:48,644 [INFO]: 	vectors dimension: 49152
2025-03-09 10:06:48,644 [INFO]: 	compression ratio: 0.9993098699855565
2025-03-09 10:06:48,644 [INFO]: }
2025-03-09 10:06:48,644 [INFO]: 	>>> Finished "Creating the index" in 47.7393 secs
2025-03-09 10:06:48,644 [INFO]: >>> Finished "Launching the whole pipeline" in 47.7665 secs
2025-03-09 10:06:49: [retrieval_preprocessing] calculating distances ...
2025-03-09 10:06:50: [retrieval_preprocessing] finished and saved retrieval indices for episode 1578 [episode count 16/20]
[retrieval_preprocessing] for episode 48299 [episode count 17/20], we have num_retrieval=np.int64(3090) num_query=np.int64(215)
2025-03-09 10:06:51,291 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-09 10:06:51,699 [INFO]: Launching the whole pipeline 03/09/2025, 10:06:51
2025-03-09 10:06:51,699 [INFO]: Reading total number of vectors and dimension 03/09/2025, 10:06:51
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1731.04it/s]
2025-03-09 10:06:51,721 [INFO]: There are 3090 embeddings of dim 49152
2025-03-09 10:06:51,722 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0228 secs
2025-03-09 10:06:51,722 [INFO]: 	Compute estimated construction time of the index 03/09/2025, 10:06:51
2025-03-09 10:06:51,722 [INFO]: 		-> Train: 16.7 minutes
2025-03-09 10:06:51,722 [INFO]: 		-> Add: 1.7 seconds
2025-03-09 10:06:51,722 [INFO]: 		Total: 16.7 minutes
2025-03-09 10:06:51,722 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0001 secs
2025-03-09 10:06:51,722 [INFO]: 	Checking that your have enough memory available to create the index 03/09/2025, 10:06:51
2025-03-09 10:06:51,722 [INFO]: 637.7MB of memory will be needed to build the index (more might be used if you have more)
2025-03-09 10:06:51,722 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0001 secs
2025-03-09 10:06:51,722 [INFO]: 	Selecting most promising index types given data characteristics 03/09/2025, 10:06:51
2025-03-09 10:06:51,722 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-09 10:06:51,722 [INFO]: 	Creating the index 03/09/2025, 10:06:51
2025-03-09 10:06:51,722 [INFO]: 		-> Instanciate the index HNSW15 03/09/2025, 10:06:51
2025-03-09 10:06:51,723 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0012 secs
2025-03-09 10:06:51,724 [INFO]: 		-> Adding the vectors to the index 03/09/2025, 10:06:51
2025-03-09 10:06:51,724 [INFO]: The memory available for adding the vectors is 49.4GB(total available - used by the index)
2025-03-09 10:06:51,724 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/13 [00:00<?, ?it/s]  8%|▊         | 1/13 [00:00<00:02,  5.89it/s] 23%|██▎       | 3/13 [00:00<00:01,  9.86it/s] 38%|███▊      | 5/13 [00:00<00:00, 11.15it/s] 54%|█████▍    | 7/13 [00:00<00:00, 12.13it/s] 69%|██████▉   | 9/13 [00:00<00:00, 12.86it/s] 85%|████████▍ | 11/13 [00:00<00:00, 12.93it/s]100%|██████████| 13/13 [00:02<00:00,  2.62it/s]100%|██████████| 13/13 [00:02<00:00,  4.48it/s]
2025-03-09 10:06:54,630 [INFO]: 	Computing best hyperparameters for index knn.index 03/09/2025, 10:06:54
2025-03-09 10:07:22,283 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 27.6526 secs
2025-03-09 10:07:22,283 [INFO]: The best hyperparameters are: efSearch=237
2025-03-09 10:07:22,283 [INFO]: 	Compute fast metrics 03/09/2025, 10:07:22
  0%|          | 0/4 [00:00<?, ?it/s] 25%|██▌       | 1/4 [00:00<00:00,  5.43it/s] 50%|█████     | 2/4 [00:00<00:00,  7.33it/s] 75%|███████▌  | 3/4 [00:00<00:00,  8.13it/s] 75%|███████▌  | 3/4 [00:00<00:00,  6.08it/s]
2025-03-09 10:07:39,399 [INFO]: 	>>> Finished "Compute fast metrics" in 17.1162 secs
2025-03-09 10:07:39,401 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 47.6776 secs
2025-03-09 10:07:39,401 [INFO]: {
2025-03-09 10:07:39,401 [INFO]: 	index_key: HNSW15
2025-03-09 10:07:39,401 [INFO]: 	index_param: efSearch=237
2025-03-09 10:07:39,401 [INFO]: 	index_path: knn.index
2025-03-09 10:07:39,401 [INFO]: 	size in bytes: 607938310
2025-03-09 10:07:39,401 [INFO]: 	avg_search_speed_ms: 9.173499122304722
2025-03-09 10:07:39,401 [INFO]: 	99p_search_speed_ms: 17.801807157229593
2025-03-09 10:07:39,401 [INFO]: 	reconstruction error %: 0.0
2025-03-09 10:07:39,401 [INFO]: 	nb vectors: 3090
2025-03-09 10:07:39,401 [INFO]: 	vectors dimension: 49152
2025-03-09 10:07:39,401 [INFO]: 	compression ratio: 0.9993098148396011
2025-03-09 10:07:39,401 [INFO]: }
2025-03-09 10:07:39,401 [INFO]: 	>>> Finished "Creating the index" in 47.6793 secs
2025-03-09 10:07:39,401 [INFO]: >>> Finished "Launching the whole pipeline" in 47.7028 secs
2025-03-09 10:07:40: [retrieval_preprocessing] calculating distances ...
2025-03-09 10:07:41: [retrieval_preprocessing] finished and saved retrieval indices for episode 48299 [episode count 17/20]
[retrieval_preprocessing] for episode 90029 [episode count 18/20], we have num_retrieval=np.int64(3133) num_query=np.int64(172)
2025-03-09 10:07:41,923 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-09 10:07:42,318 [INFO]: Launching the whole pipeline 03/09/2025, 10:07:42
2025-03-09 10:07:42,318 [INFO]: Reading total number of vectors and dimension 03/09/2025, 10:07:42
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1772.74it/s]
2025-03-09 10:07:42,342 [INFO]: There are 3133 embeddings of dim 49152
2025-03-09 10:07:42,342 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0238 secs
2025-03-09 10:07:42,342 [INFO]: 	Compute estimated construction time of the index 03/09/2025, 10:07:42
2025-03-09 10:07:42,342 [INFO]: 		-> Train: 16.7 minutes
2025-03-09 10:07:42,342 [INFO]: 		-> Add: 1.7 seconds
2025-03-09 10:07:42,342 [INFO]: 		Total: 16.7 minutes
2025-03-09 10:07:42,342 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0001 secs
2025-03-09 10:07:42,342 [INFO]: 	Checking that your have enough memory available to create the index 03/09/2025, 10:07:42
2025-03-09 10:07:42,342 [INFO]: 646.6MB of memory will be needed to build the index (more might be used if you have more)
2025-03-09 10:07:42,342 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0001 secs
2025-03-09 10:07:42,342 [INFO]: 	Selecting most promising index types given data characteristics 03/09/2025, 10:07:42
2025-03-09 10:07:42,342 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-09 10:07:42,342 [INFO]: 	Creating the index 03/09/2025, 10:07:42
2025-03-09 10:07:42,342 [INFO]: 		-> Instanciate the index HNSW15 03/09/2025, 10:07:42
2025-03-09 10:07:42,343 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0009 secs
2025-03-09 10:07:42,343 [INFO]: 		-> Adding the vectors to the index 03/09/2025, 10:07:42
2025-03-09 10:07:42,343 [INFO]: The memory available for adding the vectors is 49.4GB(total available - used by the index)
2025-03-09 10:07:42,344 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/13 [00:00<?, ?it/s]  8%|▊         | 1/13 [00:00<00:02,  5.59it/s] 15%|█▌        | 2/13 [00:00<00:01,  7.25it/s] 23%|██▎       | 3/13 [00:00<00:01,  8.03it/s] 31%|███       | 4/13 [00:00<00:01,  8.54it/s] 38%|███▊      | 5/13 [00:00<00:00,  8.46it/s] 46%|████▌     | 6/13 [00:00<00:00,  8.68it/s] 54%|█████▍    | 7/13 [00:00<00:00,  8.85it/s] 62%|██████▏   | 8/13 [00:00<00:00,  8.52it/s] 69%|██████▉   | 9/13 [00:01<00:00,  8.79it/s] 77%|███████▋  | 10/13 [00:01<00:00,  8.86it/s] 85%|████████▍ | 11/13 [00:01<00:00,  8.92it/s] 92%|█████████▏| 12/13 [00:01<00:00,  8.99it/s]100%|██████████| 13/13 [00:03<00:00,  1.47it/s]100%|██████████| 13/13 [00:03<00:00,  3.82it/s]
2025-03-09 10:07:45,749 [INFO]: 	Computing best hyperparameters for index knn.index 03/09/2025, 10:07:45
2025-03-09 10:08:14,641 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 28.8916 secs
2025-03-09 10:08:14,642 [INFO]: The best hyperparameters are: efSearch=216
2025-03-09 10:08:14,642 [INFO]: 	Compute fast metrics 03/09/2025, 10:08:14
  0%|          | 0/4 [00:00<?, ?it/s] 25%|██▌       | 1/4 [00:00<00:00,  3.90it/s] 50%|█████     | 2/4 [00:00<00:00,  4.99it/s] 75%|███████▌  | 3/4 [00:00<00:00,  6.40it/s] 75%|███████▌  | 3/4 [00:00<00:00,  4.88it/s]
2025-03-09 10:08:33,495 [INFO]: 	>>> Finished "Compute fast metrics" in 18.8534 secs
2025-03-09 10:08:33,497 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 51.1539 secs
2025-03-09 10:08:33,497 [INFO]: {
2025-03-09 10:08:33,497 [INFO]: 	index_key: HNSW15
2025-03-09 10:08:33,497 [INFO]: 	index_param: efSearch=216
2025-03-09 10:08:33,497 [INFO]: 	index_path: knn.index
2025-03-09 10:08:33,498 [INFO]: 	size in bytes: 616398430
2025-03-09 10:08:33,498 [INFO]: 	avg_search_speed_ms: 8.60818339152688
2025-03-09 10:08:33,498 [INFO]: 	99p_search_speed_ms: 12.31395137030632
2025-03-09 10:08:33,498 [INFO]: 	reconstruction error %: 0.0
2025-03-09 10:08:33,498 [INFO]: 	nb vectors: 3133
2025-03-09 10:08:33,498 [INFO]: 	vectors dimension: 49152
2025-03-09 10:08:33,498 [INFO]: 	compression ratio: 0.9993095926607081
2025-03-09 10:08:33,498 [INFO]: }
2025-03-09 10:08:33,498 [INFO]: 	>>> Finished "Creating the index" in 51.1553 secs
2025-03-09 10:08:33,498 [INFO]: >>> Finished "Launching the whole pipeline" in 51.1796 secs
2025-03-09 10:08:34: [retrieval_preprocessing] calculating distances ...
2025-03-09 10:08:34: [retrieval_preprocessing] finished and saved retrieval indices for episode 90029 [episode count 18/20]
[retrieval_preprocessing] for episode 95023 [episode count 19/20], we have num_retrieval=np.int64(3076) num_query=np.int64(229)
2025-03-09 10:08:35,241 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-09 10:08:35,655 [INFO]: Launching the whole pipeline 03/09/2025, 10:08:35
2025-03-09 10:08:35,655 [INFO]: Reading total number of vectors and dimension 03/09/2025, 10:08:35
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 2332.76it/s]
2025-03-09 10:08:35,681 [INFO]: There are 3076 embeddings of dim 49152
2025-03-09 10:08:35,681 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0257 secs
2025-03-09 10:08:35,681 [INFO]: 	Compute estimated construction time of the index 03/09/2025, 10:08:35
2025-03-09 10:08:35,681 [INFO]: 		-> Train: 16.7 minutes
2025-03-09 10:08:35,681 [INFO]: 		-> Add: 1.7 seconds
2025-03-09 10:08:35,681 [INFO]: 		Total: 16.7 minutes
2025-03-09 10:08:35,681 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0001 secs
2025-03-09 10:08:35,681 [INFO]: 	Checking that your have enough memory available to create the index 03/09/2025, 10:08:35
2025-03-09 10:08:35,682 [INFO]: 634.8MB of memory will be needed to build the index (more might be used if you have more)
2025-03-09 10:08:35,682 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0002 secs
2025-03-09 10:08:35,682 [INFO]: 	Selecting most promising index types given data characteristics 03/09/2025, 10:08:35
2025-03-09 10:08:35,682 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-09 10:08:35,682 [INFO]: 	Creating the index 03/09/2025, 10:08:35
2025-03-09 10:08:35,682 [INFO]: 		-> Instanciate the index HNSW15 03/09/2025, 10:08:35
2025-03-09 10:08:35,683 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0011 secs
2025-03-09 10:08:35,683 [INFO]: 		-> Adding the vectors to the index 03/09/2025, 10:08:35
2025-03-09 10:08:35,683 [INFO]: The memory available for adding the vectors is 49.4GB(total available - used by the index)
2025-03-09 10:08:35,683 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/13 [00:00<?, ?it/s]  8%|▊         | 1/13 [00:00<00:01,  6.61it/s] 38%|███▊      | 5/13 [00:00<00:00, 20.18it/s] 62%|██████▏   | 8/13 [00:00<00:00, 22.45it/s] 85%|████████▍ | 11/13 [00:00<00:00, 20.18it/s]100%|██████████| 13/13 [00:02<00:00,  5.11it/s]
2025-03-09 10:08:38,232 [INFO]: 	Computing best hyperparameters for index knn.index 03/09/2025, 10:08:38
2025-03-09 10:09:06,951 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 28.7180 secs
2025-03-09 10:09:06,951 [INFO]: The best hyperparameters are: efSearch=232
2025-03-09 10:09:06,951 [INFO]: 	Compute fast metrics 03/09/2025, 10:09:06
  0%|          | 0/4 [00:00<?, ?it/s] 25%|██▌       | 1/4 [00:00<00:00,  5.87it/s] 50%|█████     | 2/4 [00:00<00:00,  7.23it/s] 75%|███████▌  | 3/4 [00:00<00:00,  7.96it/s] 75%|███████▌  | 3/4 [00:00<00:00,  6.00it/s]
2025-03-09 10:09:23,118 [INFO]: 	>>> Finished "Compute fast metrics" in 16.1670 secs
2025-03-09 10:09:23,120 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 47.4369 secs
2025-03-09 10:09:23,120 [INFO]: {
2025-03-09 10:09:23,120 [INFO]: 	index_key: HNSW15
2025-03-09 10:09:23,120 [INFO]: 	index_param: efSearch=232
2025-03-09 10:09:23,120 [INFO]: 	index_path: knn.index
2025-03-09 10:09:23,120 [INFO]: 	size in bytes: 605183890
2025-03-09 10:09:23,120 [INFO]: 	avg_search_speed_ms: 9.964891789161944
2025-03-09 10:09:23,120 [INFO]: 	99p_search_speed_ms: 17.498316953424368
2025-03-09 10:09:23,120 [INFO]: 	reconstruction error %: 0.0
2025-03-09 10:09:23,120 [INFO]: 	nb vectors: 3076
2025-03-09 10:09:23,120 [INFO]: 	vectors dimension: 49152
2025-03-09 10:09:23,120 [INFO]: 	compression ratio: 0.9993098263075046
2025-03-09 10:09:23,120 [INFO]: }
2025-03-09 10:09:23,120 [INFO]: 	>>> Finished "Creating the index" in 47.4386 secs
2025-03-09 10:09:23,120 [INFO]: >>> Finished "Launching the whole pipeline" in 47.4649 secs
2025-03-09 10:09:24: [retrieval_preprocessing] calculating distances ...
2025-03-09 10:09:24: [retrieval_preprocessing] finished and saved retrieval indices for episode 95023 [episode count 19/20]
2025-03-09 10:09:24: [retrieval_preprocessing] finished for (9934859632, 'marker') [chosen_id count 6/10]
2025-03-09 10:09:29: [retrieval_preprocessing] concatenated all embeddings and indices for 20 episodes for (4312815282, 'marker') [chosen_id count 7/10]
2025-03-09 10:09:29: [retrieval_preprocessing] we have num_total=5286 embedding_dim=49152
[retrieval_preprocessing] for episode 43904 [episode count 0/20], we have num_retrieval=np.int64(5056) num_query=np.int64(230)
2025-03-09 10:09:31,829 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-09 10:09:32,523 [INFO]: Launching the whole pipeline 03/09/2025, 10:09:32
2025-03-09 10:09:32,523 [INFO]: Reading total number of vectors and dimension 03/09/2025, 10:09:32
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1546.00it/s]
2025-03-09 10:09:32,548 [INFO]: There are 5056 embeddings of dim 49152
2025-03-09 10:09:32,549 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0256 secs
2025-03-09 10:09:32,549 [INFO]: 	Compute estimated construction time of the index 03/09/2025, 10:09:32
2025-03-09 10:09:32,549 [INFO]: 		-> Train: 16.7 minutes
2025-03-09 10:09:32,549 [INFO]: 		-> Add: 2.8 seconds
2025-03-09 10:09:32,549 [INFO]: 		Total: 16.7 minutes
2025-03-09 10:09:32,549 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0001 secs
2025-03-09 10:09:32,549 [INFO]: 	Checking that your have enough memory available to create the index 03/09/2025, 10:09:32
2025-03-09 10:09:32,549 [INFO]: 1.0GB of memory will be needed to build the index (more might be used if you have more)
2025-03-09 10:09:32,549 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0001 secs
2025-03-09 10:09:32,549 [INFO]: 	Selecting most promising index types given data characteristics 03/09/2025, 10:09:32
2025-03-09 10:09:32,549 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-09 10:09:32,549 [INFO]: 	Creating the index 03/09/2025, 10:09:32
2025-03-09 10:09:32,549 [INFO]: 		-> Instanciate the index HNSW15 03/09/2025, 10:09:32
2025-03-09 10:09:32,550 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0010 secs
2025-03-09 10:09:32,550 [INFO]: 		-> Adding the vectors to the index 03/09/2025, 10:09:32
2025-03-09 10:09:32,550 [INFO]: The memory available for adding the vectors is 49.1GB(total available - used by the index)
2025-03-09 10:09:32,550 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/20 [00:00<?, ?it/s]  5%|▌         | 1/20 [00:00<00:03,  5.89it/s] 15%|█▌        | 3/20 [00:00<00:01,  9.92it/s] 25%|██▌       | 5/20 [00:00<00:01, 11.29it/s] 35%|███▌      | 7/20 [00:00<00:01, 11.92it/s] 45%|████▌     | 9/20 [00:00<00:00, 12.44it/s] 55%|█████▌    | 11/20 [00:00<00:00, 12.66it/s] 65%|██████▌   | 13/20 [00:01<00:00, 12.79it/s] 75%|███████▌  | 15/20 [00:01<00:00, 12.82it/s] 85%|████████▌ | 17/20 [00:01<00:00, 12.94it/s] 95%|█████████▌| 19/20 [00:01<00:00, 12.93it/s]100%|██████████| 20/20 [00:05<00:00,  3.88it/s]
2025-03-09 10:09:37,715 [INFO]: 	Computing best hyperparameters for index knn.index 03/09/2025, 10:09:37
2025-03-09 10:10:21,165 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 43.4496 secs
2025-03-09 10:10:21,165 [INFO]: The best hyperparameters are: efSearch=221
2025-03-09 10:10:21,165 [INFO]: 	Compute fast metrics 03/09/2025, 10:10:21
  0%|          | 0/4 [00:00<?, ?it/s] 50%|█████     | 2/4 [00:00<00:00, 19.79it/s] 75%|███████▌  | 3/4 [00:00<00:00, 21.85it/s]
2025-03-09 10:10:37,203 [INFO]: 	>>> Finished "Compute fast metrics" in 16.0375 secs
2025-03-09 10:10:37,207 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 64.6564 secs
2025-03-09 10:10:37,207 [INFO]: {
2025-03-09 10:10:37,207 [INFO]: 	index_key: HNSW15
2025-03-09 10:10:37,207 [INFO]: 	index_param: efSearch=221
2025-03-09 10:10:37,207 [INFO]: 	index_path: knn.index
2025-03-09 10:10:37,207 [INFO]: 	size in bytes: 994737970
2025-03-09 10:10:37,207 [INFO]: 	avg_search_speed_ms: 10.050241745091114
2025-03-09 10:10:37,207 [INFO]: 	99p_search_speed_ms: 15.867098332382737
2025-03-09 10:10:37,207 [INFO]: 	reconstruction error %: 0.0
2025-03-09 10:10:37,207 [INFO]: 	nb vectors: 5056
2025-03-09 10:10:37,207 [INFO]: 	vectors dimension: 49152
2025-03-09 10:10:37,207 [INFO]: 	compression ratio: 0.9993084389851933
2025-03-09 10:10:37,207 [INFO]: }
2025-03-09 10:10:37,207 [INFO]: 	>>> Finished "Creating the index" in 64.6579 secs
2025-03-09 10:10:37,207 [INFO]: >>> Finished "Launching the whole pipeline" in 64.6840 secs
2025-03-09 10:10:38: [retrieval_preprocessing] calculating distances ...
2025-03-09 10:10:39: [retrieval_preprocessing] finished and saved retrieval indices for episode 43904 [episode count 0/20]
[retrieval_preprocessing] for episode 63490 [episode count 1/20], we have num_retrieval=np.int64(4925) num_query=np.int64(361)
2025-03-09 10:10:40,101 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-09 10:10:40,765 [INFO]: Launching the whole pipeline 03/09/2025, 10:10:40
2025-03-09 10:10:40,765 [INFO]: Reading total number of vectors and dimension 03/09/2025, 10:10:40
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1521.88it/s]
2025-03-09 10:10:40,791 [INFO]: There are 4925 embeddings of dim 49152
2025-03-09 10:10:40,791 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0261 secs
2025-03-09 10:10:40,791 [INFO]: 	Compute estimated construction time of the index 03/09/2025, 10:10:40
2025-03-09 10:10:40,791 [INFO]: 		-> Train: 16.7 minutes
2025-03-09 10:10:40,791 [INFO]: 		-> Add: 2.7 seconds
2025-03-09 10:10:40,791 [INFO]: 		Total: 16.7 minutes
2025-03-09 10:10:40,791 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0001 secs
2025-03-09 10:10:40,791 [INFO]: 	Checking that your have enough memory available to create the index 03/09/2025, 10:10:40
2025-03-09 10:10:40,791 [INFO]: 1016.4MB of memory will be needed to build the index (more might be used if you have more)
2025-03-09 10:10:40,791 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0001 secs
2025-03-09 10:10:40,791 [INFO]: 	Selecting most promising index types given data characteristics 03/09/2025, 10:10:40
2025-03-09 10:10:40,791 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-09 10:10:40,791 [INFO]: 	Creating the index 03/09/2025, 10:10:40
2025-03-09 10:10:40,791 [INFO]: 		-> Instanciate the index HNSW15 03/09/2025, 10:10:40
2025-03-09 10:10:40,792 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0009 secs
2025-03-09 10:10:40,793 [INFO]: 		-> Adding the vectors to the index 03/09/2025, 10:10:40
2025-03-09 10:10:40,793 [INFO]: The memory available for adding the vectors is 49.1GB(total available - used by the index)
2025-03-09 10:10:40,793 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/20 [00:00<?, ?it/s]  5%|▌         | 1/20 [00:00<00:03,  5.98it/s] 15%|█▌        | 3/20 [00:00<00:01,  9.96it/s] 25%|██▌       | 5/20 [00:00<00:01, 11.11it/s] 35%|███▌      | 7/20 [00:00<00:01, 11.72it/s] 45%|████▌     | 9/20 [00:00<00:00, 11.94it/s] 55%|█████▌    | 11/20 [00:00<00:00, 11.93it/s] 65%|██████▌   | 13/20 [00:01<00:00, 11.86it/s] 75%|███████▌  | 15/20 [00:01<00:00, 11.67it/s] 85%|████████▌ | 17/20 [00:01<00:00, 11.62it/s] 95%|█████████▌| 19/20 [00:01<00:00, 11.67it/s]100%|██████████| 20/20 [00:05<00:00,  3.71it/s]
2025-03-09 10:10:46,188 [INFO]: 	Computing best hyperparameters for index knn.index 03/09/2025, 10:10:46
2025-03-09 10:11:28,229 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 42.0416 secs
2025-03-09 10:11:28,230 [INFO]: The best hyperparameters are: efSearch=234
2025-03-09 10:11:28,230 [INFO]: 	Compute fast metrics 03/09/2025, 10:11:28
  0%|          | 0/4 [00:00<?, ?it/s] 25%|██▌       | 1/4 [00:00<00:00,  5.84it/s] 50%|█████     | 2/4 [00:00<00:00,  7.57it/s] 75%|███████▌  | 3/4 [00:00<00:00,  8.09it/s] 75%|███████▌  | 3/4 [00:00<00:00,  5.93it/s]
2025-03-09 10:11:43,894 [INFO]: 	>>> Finished "Compute fast metrics" in 15.6645 secs
2025-03-09 10:11:43,898 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 63.1049 secs
2025-03-09 10:11:43,898 [INFO]: {
2025-03-09 10:11:43,898 [INFO]: 	index_key: HNSW15
2025-03-09 10:11:43,898 [INFO]: 	index_param: efSearch=234
2025-03-09 10:11:43,898 [INFO]: 	index_path: knn.index
2025-03-09 10:11:43,898 [INFO]: 	size in bytes: 968964250
2025-03-09 10:11:43,898 [INFO]: 	avg_search_speed_ms: 10.611557391593637
2025-03-09 10:11:43,898 [INFO]: 	99p_search_speed_ms: 18.813358130864806
2025-03-09 10:11:43,898 [INFO]: 	reconstruction error %: 0.0
2025-03-09 10:11:43,898 [INFO]: 	nb vectors: 4925
2025-03-09 10:11:43,898 [INFO]: 	vectors dimension: 49152
2025-03-09 10:11:43,898 [INFO]: 	compression ratio: 0.9993086948254283
2025-03-09 10:11:43,898 [INFO]: }
2025-03-09 10:11:43,898 [INFO]: 	>>> Finished "Creating the index" in 63.1064 secs
2025-03-09 10:11:43,898 [INFO]: >>> Finished "Launching the whole pipeline" in 63.1332 secs
2025-03-09 10:11:46: [retrieval_preprocessing] calculating distances ...
2025-03-09 10:11:47: [retrieval_preprocessing] finished and saved retrieval indices for episode 63490 [episode count 1/20]
[retrieval_preprocessing] for episode 74110 [episode count 2/20], we have num_retrieval=np.int64(5020) num_query=np.int64(266)
2025-03-09 10:11:48,531 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-09 10:11:49,312 [INFO]: Launching the whole pipeline 03/09/2025, 10:11:49
2025-03-09 10:11:49,312 [INFO]: Reading total number of vectors and dimension 03/09/2025, 10:11:49
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1551.15it/s]
2025-03-09 10:11:49,340 [INFO]: There are 5020 embeddings of dim 49152
2025-03-09 10:11:49,340 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0286 secs
2025-03-09 10:11:49,341 [INFO]: 	Compute estimated construction time of the index 03/09/2025, 10:11:49
2025-03-09 10:11:49,341 [INFO]: 		-> Train: 16.7 minutes
2025-03-09 10:11:49,341 [INFO]: 		-> Add: 2.8 seconds
2025-03-09 10:11:49,341 [INFO]: 		Total: 16.7 minutes
2025-03-09 10:11:49,341 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0003 secs
2025-03-09 10:11:49,341 [INFO]: 	Checking that your have enough memory available to create the index 03/09/2025, 10:11:49
2025-03-09 10:11:49,341 [INFO]: 1.0GB of memory will be needed to build the index (more might be used if you have more)
2025-03-09 10:11:49,341 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0004 secs
2025-03-09 10:11:49,342 [INFO]: 	Selecting most promising index types given data characteristics 03/09/2025, 10:11:49
2025-03-09 10:11:49,342 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-09 10:11:49,342 [INFO]: 	Creating the index 03/09/2025, 10:11:49
2025-03-09 10:11:49,342 [INFO]: 		-> Instanciate the index HNSW15 03/09/2025, 10:11:49
2025-03-09 10:11:49,345 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0027 secs
2025-03-09 10:11:49,345 [INFO]: 		-> Adding the vectors to the index 03/09/2025, 10:11:49
2025-03-09 10:11:49,345 [INFO]: The memory available for adding the vectors is 49.1GB(total available - used by the index)
2025-03-09 10:11:49,345 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/20 [00:00<?, ?it/s]  5%|▌         | 1/20 [00:00<00:03,  5.28it/s] 15%|█▌        | 3/20 [00:00<00:01,  8.55it/s] 25%|██▌       | 5/20 [00:00<00:01, 10.31it/s] 35%|███▌      | 7/20 [00:00<00:01, 10.54it/s] 45%|████▌     | 9/20 [00:00<00:01, 10.84it/s] 55%|█████▌    | 11/20 [00:01<00:00, 10.56it/s] 65%|██████▌   | 13/20 [00:01<00:00, 10.39it/s] 75%|███████▌  | 15/20 [00:01<00:00, 10.19it/s] 85%|████████▌ | 17/20 [00:01<00:00, 10.03it/s] 95%|█████████▌| 19/20 [00:01<00:00,  9.94it/s]100%|██████████| 20/20 [00:05<00:00,  1.33it/s]100%|██████████| 20/20 [00:05<00:00,  3.58it/s]
2025-03-09 10:11:54,938 [INFO]: 	Computing best hyperparameters for index knn.index 03/09/2025, 10:11:54
2025-03-09 10:12:37,522 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 42.5835 secs
2025-03-09 10:12:37,522 [INFO]: The best hyperparameters are: efSearch=247
2025-03-09 10:12:37,522 [INFO]: 	Compute fast metrics 03/09/2025, 10:12:37
  0%|          | 0/4 [00:00<?, ?it/s] 25%|██▌       | 1/4 [00:00<00:00,  6.30it/s] 75%|███████▌  | 3/4 [00:00<00:00, 10.25it/s] 75%|███████▌  | 3/4 [00:00<00:00,  7.89it/s]
2025-03-09 10:12:52,492 [INFO]: 	>>> Finished "Compute fast metrics" in 14.9693 secs
2025-03-09 10:12:52,496 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 63.1507 secs
2025-03-09 10:12:52,496 [INFO]: {
2025-03-09 10:12:52,496 [INFO]: 	index_key: HNSW15
2025-03-09 10:12:52,496 [INFO]: 	index_param: efSearch=247
2025-03-09 10:12:52,496 [INFO]: 	index_path: knn.index
2025-03-09 10:12:52,496 [INFO]: 	size in bytes: 987655090
2025-03-09 10:12:52,496 [INFO]: 	avg_search_speed_ms: 10.417880553480549
2025-03-09 10:12:52,496 [INFO]: 	99p_search_speed_ms: 20.433159468229846
2025-03-09 10:12:52,496 [INFO]: 	reconstruction error %: 0.0
2025-03-09 10:12:52,496 [INFO]: 	nb vectors: 5020
2025-03-09 10:12:52,496 [INFO]: 	vectors dimension: 49152
2025-03-09 10:12:52,496 [INFO]: 	compression ratio: 0.9993085339133928
2025-03-09 10:12:52,496 [INFO]: }
2025-03-09 10:12:52,496 [INFO]: 	>>> Finished "Creating the index" in 63.1542 secs
2025-03-09 10:12:52,496 [INFO]: >>> Finished "Launching the whole pipeline" in 63.1843 secs
2025-03-09 10:12:54: [retrieval_preprocessing] calculating distances ...
2025-03-09 10:12:55: [retrieval_preprocessing] finished and saved retrieval indices for episode 74110 [episode count 2/20]
[retrieval_preprocessing] for episode 42760 [episode count 3/20], we have num_retrieval=np.int64(5061) num_query=np.int64(225)
2025-03-09 10:12:56,543 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-09 10:12:57,191 [INFO]: Launching the whole pipeline 03/09/2025, 10:12:57
2025-03-09 10:12:57,191 [INFO]: Reading total number of vectors and dimension 03/09/2025, 10:12:57
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1189.20it/s]
2025-03-09 10:12:57,221 [INFO]: There are 5061 embeddings of dim 49152
2025-03-09 10:12:57,221 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0305 secs
2025-03-09 10:12:57,221 [INFO]: 	Compute estimated construction time of the index 03/09/2025, 10:12:57
2025-03-09 10:12:57,222 [INFO]: 		-> Train: 16.7 minutes
2025-03-09 10:12:57,222 [INFO]: 		-> Add: 2.8 seconds
2025-03-09 10:12:57,222 [INFO]: 		Total: 16.7 minutes
2025-03-09 10:12:57,222 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0001 secs
2025-03-09 10:12:57,222 [INFO]: 	Checking that your have enough memory available to create the index 03/09/2025, 10:12:57
2025-03-09 10:12:57,222 [INFO]: 1.0GB of memory will be needed to build the index (more might be used if you have more)
2025-03-09 10:12:57,222 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0001 secs
2025-03-09 10:12:57,222 [INFO]: 	Selecting most promising index types given data characteristics 03/09/2025, 10:12:57
2025-03-09 10:12:57,222 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-09 10:12:57,222 [INFO]: 	Creating the index 03/09/2025, 10:12:57
2025-03-09 10:12:57,222 [INFO]: 		-> Instanciate the index HNSW15 03/09/2025, 10:12:57
2025-03-09 10:12:57,223 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0011 secs
2025-03-09 10:12:57,223 [INFO]: 		-> Adding the vectors to the index 03/09/2025, 10:12:57
2025-03-09 10:12:57,223 [INFO]: The memory available for adding the vectors is 49.1GB(total available - used by the index)
2025-03-09 10:12:57,223 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/20 [00:00<?, ?it/s]  5%|▌         | 1/20 [00:00<00:03,  5.37it/s] 15%|█▌        | 3/20 [00:00<00:01,  8.84it/s] 25%|██▌       | 5/20 [00:00<00:01,  9.83it/s] 35%|███▌      | 7/20 [00:00<00:01, 10.15it/s] 45%|████▌     | 9/20 [00:00<00:01, 10.11it/s] 55%|█████▌    | 11/20 [00:01<00:00,  9.78it/s] 60%|██████    | 12/20 [00:01<00:00,  9.75it/s] 65%|██████▌   | 13/20 [00:01<00:00,  9.79it/s] 70%|███████   | 14/20 [00:01<00:00,  9.81it/s] 80%|████████  | 16/20 [00:01<00:00, 10.75it/s] 90%|█████████ | 18/20 [00:01<00:00, 11.52it/s]100%|██████████| 20/20 [00:05<00:00,  1.48it/s]100%|██████████| 20/20 [00:05<00:00,  3.73it/s]
2025-03-09 10:13:02,585 [INFO]: 	Computing best hyperparameters for index knn.index 03/09/2025, 10:13:02
2025-03-09 10:13:45,797 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 43.2115 secs
2025-03-09 10:13:45,798 [INFO]: The best hyperparameters are: efSearch=263
2025-03-09 10:13:45,798 [INFO]: 	Compute fast metrics 03/09/2025, 10:13:45
  0%|          | 0/4 [00:00<?, ?it/s] 25%|██▌       | 1/4 [00:00<00:00,  6.41it/s] 75%|███████▌  | 3/4 [00:00<00:00, 10.43it/s] 75%|███████▌  | 3/4 [00:00<00:00,  7.96it/s]
2025-03-09 10:14:00,067 [INFO]: 	>>> Finished "Compute fast metrics" in 14.2693 secs
2025-03-09 10:14:00,071 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 62.8474 secs
2025-03-09 10:14:00,071 [INFO]: {
2025-03-09 10:14:00,071 [INFO]: 	index_key: HNSW15
2025-03-09 10:14:00,071 [INFO]: 	index_param: efSearch=263
2025-03-09 10:14:00,071 [INFO]: 	index_path: knn.index
2025-03-09 10:14:00,071 [INFO]: 	size in bytes: 995721670
2025-03-09 10:14:00,071 [INFO]: 	avg_search_speed_ms: 10.14168086956665
2025-03-09 10:14:00,071 [INFO]: 	99p_search_speed_ms: 16.38907103333622
2025-03-09 10:14:00,071 [INFO]: 	reconstruction error %: 0.0
2025-03-09 10:14:00,071 [INFO]: 	nb vectors: 5061
2025-03-09 10:14:00,071 [INFO]: 	vectors dimension: 49152
2025-03-09 10:14:00,071 [INFO]: 	compression ratio: 0.9993084593609377
2025-03-09 10:14:00,071 [INFO]: }
2025-03-09 10:14:00,071 [INFO]: 	>>> Finished "Creating the index" in 62.8490 secs
2025-03-09 10:14:00,071 [INFO]: >>> Finished "Launching the whole pipeline" in 62.8801 secs
2025-03-09 10:14:01: [retrieval_preprocessing] calculating distances ...
2025-03-09 10:14:02: [retrieval_preprocessing] finished and saved retrieval indices for episode 42760 [episode count 3/20]
[retrieval_preprocessing] for episode 15627 [episode count 4/20], we have num_retrieval=np.int64(5089) num_query=np.int64(197)
2025-03-09 10:14:03,896 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-09 10:14:04,569 [INFO]: Launching the whole pipeline 03/09/2025, 10:14:04
2025-03-09 10:14:04,569 [INFO]: Reading total number of vectors and dimension 03/09/2025, 10:14:04
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1489.45it/s]
2025-03-09 10:14:04,597 [INFO]: There are 5089 embeddings of dim 49152
2025-03-09 10:14:04,598 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0286 secs
2025-03-09 10:14:04,598 [INFO]: 	Compute estimated construction time of the index 03/09/2025, 10:14:04
2025-03-09 10:14:04,598 [INFO]: 		-> Train: 16.7 minutes
2025-03-09 10:14:04,598 [INFO]: 		-> Add: 2.8 seconds
2025-03-09 10:14:04,598 [INFO]: 		Total: 16.7 minutes
2025-03-09 10:14:04,598 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0004 secs
2025-03-09 10:14:04,598 [INFO]: 	Checking that your have enough memory available to create the index 03/09/2025, 10:14:04
2025-03-09 10:14:04,599 [INFO]: 1.0GB of memory will be needed to build the index (more might be used if you have more)
2025-03-09 10:14:04,599 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0005 secs
2025-03-09 10:14:04,599 [INFO]: 	Selecting most promising index types given data characteristics 03/09/2025, 10:14:04
2025-03-09 10:14:04,599 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-09 10:14:04,599 [INFO]: 	Creating the index 03/09/2025, 10:14:04
2025-03-09 10:14:04,599 [INFO]: 		-> Instanciate the index HNSW15 03/09/2025, 10:14:04
2025-03-09 10:14:04,602 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0027 secs
2025-03-09 10:14:04,602 [INFO]: 		-> Adding the vectors to the index 03/09/2025, 10:14:04
2025-03-09 10:14:04,603 [INFO]: The memory available for adding the vectors is 49.1GB(total available - used by the index)
2025-03-09 10:14:04,603 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/22 [00:00<?, ?it/s]  5%|▍         | 1/22 [00:00<00:03,  6.15it/s] 14%|█▎        | 3/22 [00:00<00:01, 10.22it/s] 23%|██▎       | 5/22 [00:00<00:01, 11.54it/s] 32%|███▏      | 7/22 [00:00<00:01, 12.23it/s] 41%|████      | 9/22 [00:00<00:01, 12.58it/s] 50%|█████     | 11/22 [00:00<00:00, 12.80it/s] 59%|█████▉    | 13/22 [00:01<00:00, 12.96it/s] 68%|██████▊   | 15/22 [00:01<00:00, 13.05it/s] 77%|███████▋  | 17/22 [00:01<00:00, 13.08it/s] 86%|████████▋ | 19/22 [00:01<00:00, 13.15it/s] 95%|█████████▌| 21/22 [00:04<00:00,  1.77it/s]100%|██████████| 22/22 [00:05<00:00,  1.76it/s]100%|██████████| 22/22 [00:05<00:00,  4.05it/s]
2025-03-09 10:14:10,043 [INFO]: 	Computing best hyperparameters for index knn.index 03/09/2025, 10:14:10
2025-03-09 10:14:50,260 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 40.2167 secs
2025-03-09 10:14:50,260 [INFO]: The best hyperparameters are: efSearch=292
2025-03-09 10:14:50,260 [INFO]: 	Compute fast metrics 03/09/2025, 10:14:50
  0%|          | 0/4 [00:00<?, ?it/s] 25%|██▌       | 1/4 [00:00<00:00,  6.07it/s] 50%|█████     | 2/4 [00:00<00:00,  7.77it/s] 75%|███████▌  | 3/4 [00:00<00:00,  8.50it/s] 75%|███████▌  | 3/4 [00:00<00:00,  6.31it/s]
2025-03-09 10:15:04,956 [INFO]: 	>>> Finished "Compute fast metrics" in 14.6957 secs
2025-03-09 10:15:04,956 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 60.3537 secs
2025-03-09 10:15:04,956 [INFO]: {
2025-03-09 10:15:04,956 [INFO]: 	index_key: HNSW15
2025-03-09 10:15:04,956 [INFO]: 	index_param: efSearch=292
2025-03-09 10:15:04,956 [INFO]: 	index_path: knn.index
2025-03-09 10:15:04,956 [INFO]: 	size in bytes: 1001230450
2025-03-09 10:15:04,956 [INFO]: 	avg_search_speed_ms: 10.597046563831963
2025-03-09 10:15:04,956 [INFO]: 	99p_search_speed_ms: 20.846818336285637
2025-03-09 10:15:04,956 [INFO]: 	reconstruction error %: 0.0
2025-03-09 10:15:04,956 [INFO]: 	nb vectors: 5089
2025-03-09 10:15:04,956 [INFO]: 	vectors dimension: 49152
2025-03-09 10:15:04,956 [INFO]: 	compression ratio: 0.9993085128403756
2025-03-09 10:15:04,956 [INFO]: }
2025-03-09 10:15:04,956 [INFO]: 	>>> Finished "Creating the index" in 60.3571 secs
2025-03-09 10:15:04,957 [INFO]: >>> Finished "Launching the whole pipeline" in 60.3876 secs
2025-03-09 10:15:06: [retrieval_preprocessing] calculating distances ...
2025-03-09 10:15:07: [retrieval_preprocessing] finished and saved retrieval indices for episode 15627 [episode count 4/20]
[retrieval_preprocessing] for episode 90383 [episode count 5/20], we have num_retrieval=np.int64(5070) num_query=np.int64(216)
2025-03-09 10:15:08,463 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-09 10:15:09,072 [INFO]: Launching the whole pipeline 03/09/2025, 10:15:09
2025-03-09 10:15:09,072 [INFO]: Reading total number of vectors and dimension 03/09/2025, 10:15:09
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 2280.75it/s]
2025-03-09 10:15:09,097 [INFO]: There are 5070 embeddings of dim 49152
2025-03-09 10:15:09,097 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0248 secs
2025-03-09 10:15:09,097 [INFO]: 	Compute estimated construction time of the index 03/09/2025, 10:15:09
2025-03-09 10:15:09,097 [INFO]: 		-> Train: 16.7 minutes
2025-03-09 10:15:09,097 [INFO]: 		-> Add: 2.8 seconds
2025-03-09 10:15:09,097 [INFO]: 		Total: 16.7 minutes
2025-03-09 10:15:09,097 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0001 secs
2025-03-09 10:15:09,097 [INFO]: 	Checking that your have enough memory available to create the index 03/09/2025, 10:15:09
2025-03-09 10:15:09,097 [INFO]: 1.0GB of memory will be needed to build the index (more might be used if you have more)
2025-03-09 10:15:09,097 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0001 secs
2025-03-09 10:15:09,097 [INFO]: 	Selecting most promising index types given data characteristics 03/09/2025, 10:15:09
2025-03-09 10:15:09,097 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-09 10:15:09,098 [INFO]: 	Creating the index 03/09/2025, 10:15:09
2025-03-09 10:15:09,098 [INFO]: 		-> Instanciate the index HNSW15 03/09/2025, 10:15:09
2025-03-09 10:15:09,099 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0009 secs
2025-03-09 10:15:09,099 [INFO]: 		-> Adding the vectors to the index 03/09/2025, 10:15:09
2025-03-09 10:15:09,099 [INFO]: The memory available for adding the vectors is 49.1GB(total available - used by the index)
2025-03-09 10:15:09,099 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/20 [00:00<?, ?it/s]  5%|▌         | 1/20 [00:00<00:02,  6.43it/s] 15%|█▌        | 3/20 [00:00<00:01, 11.47it/s] 25%|██▌       | 5/20 [00:00<00:01, 13.13it/s] 35%|███▌      | 7/20 [00:00<00:00, 13.64it/s] 45%|████▌     | 9/20 [00:00<00:00, 13.73it/s] 55%|█████▌    | 11/20 [00:00<00:00, 13.78it/s] 65%|██████▌   | 13/20 [00:01<00:00, 13.25it/s] 75%|███████▌  | 15/20 [00:01<00:00, 13.36it/s] 85%|████████▌ | 17/20 [00:01<00:00, 13.22it/s] 95%|█████████▌| 19/20 [00:01<00:00, 13.30it/s]100%|██████████| 20/20 [00:05<00:00,  3.99it/s]
2025-03-09 10:15:14,116 [INFO]: 	Computing best hyperparameters for index knn.index 03/09/2025, 10:15:14
2025-03-09 10:15:55,335 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 41.2181 secs
2025-03-09 10:15:55,335 [INFO]: The best hyperparameters are: efSearch=209
2025-03-09 10:15:55,335 [INFO]: 	Compute fast metrics 03/09/2025, 10:15:55
  0%|          | 0/4 [00:00<?, ?it/s] 25%|██▌       | 1/4 [00:00<00:00,  6.60it/s] 75%|███████▌  | 3/4 [00:00<00:00, 10.11it/s] 75%|███████▌  | 3/4 [00:00<00:00,  7.73it/s]
2025-03-09 10:16:13,383 [INFO]: 	>>> Finished "Compute fast metrics" in 18.0474 secs
2025-03-09 10:16:13,386 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 64.2868 secs
2025-03-09 10:16:13,386 [INFO]: {
2025-03-09 10:16:13,386 [INFO]: 	index_key: HNSW15
2025-03-09 10:16:13,386 [INFO]: 	index_param: efSearch=209
2025-03-09 10:16:13,386 [INFO]: 	index_path: knn.index
2025-03-09 10:16:13,386 [INFO]: 	size in bytes: 997492330
2025-03-09 10:16:13,386 [INFO]: 	avg_search_speed_ms: 9.163253802565412
2025-03-09 10:16:13,386 [INFO]: 	99p_search_speed_ms: 17.669695103541002
2025-03-09 10:16:13,386 [INFO]: 	reconstruction error %: 0.0
2025-03-09 10:16:13,386 [INFO]: 	nb vectors: 5070
2025-03-09 10:16:13,386 [INFO]: 	vectors dimension: 49152
2025-03-09 10:16:13,386 [INFO]: 	compression ratio: 0.9993084959360038
2025-03-09 10:16:13,386 [INFO]: }
2025-03-09 10:16:13,386 [INFO]: 	>>> Finished "Creating the index" in 64.2881 secs
2025-03-09 10:16:13,386 [INFO]: >>> Finished "Launching the whole pipeline" in 64.3139 secs
2025-03-09 10:16:14: [retrieval_preprocessing] calculating distances ...
2025-03-09 10:16:14: [retrieval_preprocessing] finished and saved retrieval indices for episode 90383 [episode count 5/20]
[retrieval_preprocessing] for episode 50965 [episode count 6/20], we have num_retrieval=np.int64(4601) num_query=np.int64(685)
2025-03-09 10:16:15,527 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-09 10:16:16,045 [INFO]: Launching the whole pipeline 03/09/2025, 10:16:16
2025-03-09 10:16:16,045 [INFO]: Reading total number of vectors and dimension 03/09/2025, 10:16:16
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1516.93it/s]
2025-03-09 10:16:16,073 [INFO]: There are 4601 embeddings of dim 49152
2025-03-09 10:16:16,074 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0291 secs
2025-03-09 10:16:16,074 [INFO]: 	Compute estimated construction time of the index 03/09/2025, 10:16:16
2025-03-09 10:16:16,074 [INFO]: 		-> Train: 16.7 minutes
2025-03-09 10:16:16,074 [INFO]: 		-> Add: 2.5 seconds
2025-03-09 10:16:16,074 [INFO]: 		Total: 16.7 minutes
2025-03-09 10:16:16,074 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0004 secs
2025-03-09 10:16:16,075 [INFO]: 	Checking that your have enough memory available to create the index 03/09/2025, 10:16:16
2025-03-09 10:16:16,075 [INFO]: 949.5MB of memory will be needed to build the index (more might be used if you have more)
2025-03-09 10:16:16,075 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0004 secs
2025-03-09 10:16:16,075 [INFO]: 	Selecting most promising index types given data characteristics 03/09/2025, 10:16:16
2025-03-09 10:16:16,075 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-09 10:16:16,075 [INFO]: 	Creating the index 03/09/2025, 10:16:16
2025-03-09 10:16:16,075 [INFO]: 		-> Instanciate the index HNSW15 03/09/2025, 10:16:16
2025-03-09 10:16:16,078 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0028 secs
2025-03-09 10:16:16,079 [INFO]: 		-> Adding the vectors to the index 03/09/2025, 10:16:16
2025-03-09 10:16:16,079 [INFO]: The memory available for adding the vectors is 49.2GB(total available - used by the index)
2025-03-09 10:16:16,079 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/19 [00:00<?, ?it/s]  5%|▌         | 1/19 [00:00<00:02,  6.46it/s] 16%|█▌        | 3/19 [00:00<00:01,  9.51it/s] 26%|██▋       | 5/19 [00:00<00:01,  9.95it/s] 37%|███▋      | 7/19 [00:00<00:01,  9.96it/s] 47%|████▋     | 9/19 [00:00<00:00, 10.00it/s] 53%|█████▎    | 10/19 [00:01<00:00,  9.92it/s] 58%|█████▊    | 11/19 [00:01<00:00,  9.88it/s] 68%|██████▊   | 13/19 [00:01<00:00, 10.01it/s] 74%|███████▎  | 14/19 [00:01<00:00,  9.82it/s] 79%|███████▉  | 15/19 [00:01<00:00,  9.74it/s] 84%|████████▍ | 16/19 [00:01<00:00,  9.61it/s] 89%|████████▉ | 17/19 [00:01<00:00,  9.49it/s] 95%|█████████▍| 18/19 [00:01<00:00,  9.58it/s]100%|██████████| 19/19 [00:05<00:00,  1.02it/s]100%|██████████| 19/19 [00:05<00:00,  3.76it/s]
2025-03-09 10:16:21,134 [INFO]: 	Computing best hyperparameters for index knn.index 03/09/2025, 10:16:21
2025-03-09 10:17:03,407 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 42.2727 secs
2025-03-09 10:17:03,407 [INFO]: The best hyperparameters are: efSearch=249
2025-03-09 10:17:03,407 [INFO]: 	Compute fast metrics 03/09/2025, 10:17:03
  0%|          | 0/4 [00:00<?, ?it/s] 25%|██▌       | 1/4 [00:00<00:00,  6.09it/s] 75%|███████▌  | 3/4 [00:00<00:00, 10.17it/s] 75%|███████▌  | 3/4 [00:00<00:00,  7.74it/s]
2025-03-09 10:17:19,362 [INFO]: 	>>> Finished "Compute fast metrics" in 15.9548 secs
2025-03-09 10:17:19,366 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 63.2872 secs
2025-03-09 10:17:19,366 [INFO]: {
2025-03-09 10:17:19,366 [INFO]: 	index_key: HNSW15
2025-03-09 10:17:19,366 [INFO]: 	index_param: efSearch=249
2025-03-09 10:17:19,366 [INFO]: 	index_path: knn.index
2025-03-09 10:17:19,366 [INFO]: 	size in bytes: 905219050
2025-03-09 10:17:19,366 [INFO]: 	avg_search_speed_ms: 10.275427169498641
2025-03-09 10:17:19,366 [INFO]: 	99p_search_speed_ms: 16.51120770722627
2025-03-09 10:17:19,366 [INFO]: 	reconstruction error %: 0.0
2025-03-09 10:17:19,366 [INFO]: 	nb vectors: 4601
2025-03-09 10:17:19,366 [INFO]: 	vectors dimension: 49152
2025-03-09 10:17:19,366 [INFO]: 	compression ratio: 0.9993088501617371
2025-03-09 10:17:19,366 [INFO]: }
2025-03-09 10:17:19,366 [INFO]: 	>>> Finished "Creating the index" in 63.2908 secs
2025-03-09 10:17:19,366 [INFO]: >>> Finished "Launching the whole pipeline" in 63.3216 secs
2025-03-09 10:17:24: [retrieval_preprocessing] calculating distances ...
2025-03-09 10:17:26: [retrieval_preprocessing] finished and saved retrieval indices for episode 50965 [episode count 6/20]
[retrieval_preprocessing] for episode 76057 [episode count 7/20], we have num_retrieval=np.int64(5031) num_query=np.int64(255)
2025-03-09 10:17:27,613 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-09 10:17:28,254 [INFO]: Launching the whole pipeline 03/09/2025, 10:17:28
2025-03-09 10:17:28,254 [INFO]: Reading total number of vectors and dimension 03/09/2025, 10:17:28
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1538.63it/s]
2025-03-09 10:17:28,282 [INFO]: There are 5031 embeddings of dim 49152
2025-03-09 10:17:28,282 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0284 secs
2025-03-09 10:17:28,283 [INFO]: 	Compute estimated construction time of the index 03/09/2025, 10:17:28
2025-03-09 10:17:28,283 [INFO]: 		-> Train: 16.7 minutes
2025-03-09 10:17:28,283 [INFO]: 		-> Add: 2.8 seconds
2025-03-09 10:17:28,283 [INFO]: 		Total: 16.7 minutes
2025-03-09 10:17:28,283 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0001 secs
2025-03-09 10:17:28,283 [INFO]: 	Checking that your have enough memory available to create the index 03/09/2025, 10:17:28
2025-03-09 10:17:28,283 [INFO]: 1.0GB of memory will be needed to build the index (more might be used if you have more)
2025-03-09 10:17:28,283 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0002 secs
2025-03-09 10:17:28,283 [INFO]: 	Selecting most promising index types given data characteristics 03/09/2025, 10:17:28
2025-03-09 10:17:28,283 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-09 10:17:28,283 [INFO]: 	Creating the index 03/09/2025, 10:17:28
2025-03-09 10:17:28,283 [INFO]: 		-> Instanciate the index HNSW15 03/09/2025, 10:17:28
2025-03-09 10:17:28,284 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0010 secs
2025-03-09 10:17:28,284 [INFO]: 		-> Adding the vectors to the index 03/09/2025, 10:17:28
2025-03-09 10:17:28,284 [INFO]: The memory available for adding the vectors is 49.1GB(total available - used by the index)
2025-03-09 10:17:28,284 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/20 [00:00<?, ?it/s]  5%|▌         | 1/20 [00:00<00:03,  5.32it/s] 25%|██▌       | 5/20 [00:00<00:00, 19.52it/s] 50%|█████     | 10/20 [00:00<00:00, 29.94it/s] 75%|███████▌  | 15/20 [00:00<00:00, 35.73it/s] 95%|█████████▌| 19/20 [00:00<00:00, 26.22it/s]100%|██████████| 20/20 [00:04<00:00,  4.26it/s]
2025-03-09 10:17:32,980 [INFO]: 	Computing best hyperparameters for index knn.index 03/09/2025, 10:17:32
2025-03-09 10:18:15,622 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 42.6417 secs
2025-03-09 10:18:15,622 [INFO]: The best hyperparameters are: efSearch=247
2025-03-09 10:18:15,622 [INFO]: 	Compute fast metrics 03/09/2025, 10:18:15
  0%|          | 0/4 [00:00<?, ?it/s] 25%|██▌       | 1/4 [00:00<00:00,  5.32it/s] 50%|█████     | 2/4 [00:00<00:00,  7.16it/s] 75%|███████▌  | 3/4 [00:00<00:00,  7.94it/s] 75%|███████▌  | 3/4 [00:00<00:00,  5.93it/s]
2025-03-09 10:18:31,529 [INFO]: 	>>> Finished "Compute fast metrics" in 15.9065 secs
2025-03-09 10:18:31,531 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 63.2468 secs
2025-03-09 10:18:31,531 [INFO]: {
2025-03-09 10:18:31,531 [INFO]: 	index_key: HNSW15
2025-03-09 10:18:31,531 [INFO]: 	index_param: efSearch=247
2025-03-09 10:18:31,531 [INFO]: 	index_path: knn.index
2025-03-09 10:18:31,531 [INFO]: 	size in bytes: 989819290
2025-03-09 10:18:31,531 [INFO]: 	avg_search_speed_ms: 9.543688243560721
2025-03-09 10:18:31,531 [INFO]: 	99p_search_speed_ms: 14.055558813270181
2025-03-09 10:18:31,531 [INFO]: 	reconstruction error %: 0.0
2025-03-09 10:18:31,531 [INFO]: 	nb vectors: 5031
2025-03-09 10:18:31,531 [INFO]: 	vectors dimension: 49152
2025-03-09 10:18:31,531 [INFO]: 	compression ratio: 0.9993085182245741
2025-03-09 10:18:31,531 [INFO]: }
2025-03-09 10:18:31,531 [INFO]: 	>>> Finished "Creating the index" in 63.2482 secs
2025-03-09 10:18:31,531 [INFO]: >>> Finished "Launching the whole pipeline" in 63.2773 secs
2025-03-09 10:18:33: [retrieval_preprocessing] calculating distances ...
2025-03-09 10:18:34: [retrieval_preprocessing] finished and saved retrieval indices for episode 76057 [episode count 7/20]
[retrieval_preprocessing] for episode 80537 [episode count 8/20], we have num_retrieval=np.int64(5109) num_query=np.int64(177)
2025-03-09 10:18:35,457 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-09 10:18:36,093 [INFO]: Launching the whole pipeline 03/09/2025, 10:18:36
2025-03-09 10:18:36,093 [INFO]: Reading total number of vectors and dimension 03/09/2025, 10:18:36
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1449.81it/s]
2025-03-09 10:18:36,117 [INFO]: There are 5109 embeddings of dim 49152
2025-03-09 10:18:36,118 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0249 secs
2025-03-09 10:18:36,118 [INFO]: 	Compute estimated construction time of the index 03/09/2025, 10:18:36
2025-03-09 10:18:36,118 [INFO]: 		-> Train: 16.7 minutes
2025-03-09 10:18:36,118 [INFO]: 		-> Add: 2.8 seconds
2025-03-09 10:18:36,118 [INFO]: 		Total: 16.7 minutes
2025-03-09 10:18:36,118 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0001 secs
2025-03-09 10:18:36,118 [INFO]: 	Checking that your have enough memory available to create the index 03/09/2025, 10:18:36
2025-03-09 10:18:36,118 [INFO]: 1.0GB of memory will be needed to build the index (more might be used if you have more)
2025-03-09 10:18:36,118 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0001 secs
2025-03-09 10:18:36,118 [INFO]: 	Selecting most promising index types given data characteristics 03/09/2025, 10:18:36
2025-03-09 10:18:36,118 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-09 10:18:36,118 [INFO]: 	Creating the index 03/09/2025, 10:18:36
2025-03-09 10:18:36,118 [INFO]: 		-> Instanciate the index HNSW15 03/09/2025, 10:18:36
2025-03-09 10:18:36,119 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0010 secs
2025-03-09 10:18:36,119 [INFO]: 		-> Adding the vectors to the index 03/09/2025, 10:18:36
2025-03-09 10:18:36,119 [INFO]: The memory available for adding the vectors is 49.1GB(total available - used by the index)
2025-03-09 10:18:36,119 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/22 [00:00<?, ?it/s]  5%|▍         | 1/22 [00:00<00:03,  5.32it/s] 14%|█▎        | 3/22 [00:00<00:02,  9.49it/s] 23%|██▎       | 5/22 [00:00<00:01, 10.81it/s] 32%|███▏      | 7/22 [00:00<00:01, 11.68it/s] 41%|████      | 9/22 [00:00<00:01, 12.11it/s] 50%|█████     | 11/22 [00:00<00:00, 12.54it/s] 59%|█████▉    | 13/22 [00:01<00:00, 12.74it/s] 68%|██████▊   | 15/22 [00:01<00:00, 12.87it/s] 77%|███████▋  | 17/22 [00:01<00:00, 13.02it/s] 86%|████████▋ | 19/22 [00:01<00:00, 13.08it/s] 95%|█████████▌| 21/22 [00:05<00:00,  1.61it/s]100%|██████████| 22/22 [00:05<00:00,  1.63it/s]100%|██████████| 22/22 [00:05<00:00,  3.76it/s]
2025-03-09 10:18:41,967 [INFO]: 	Computing best hyperparameters for index knn.index 03/09/2025, 10:18:41
2025-03-09 10:19:24,363 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 42.3958 secs
2025-03-09 10:19:24,363 [INFO]: The best hyperparameters are: efSearch=239
2025-03-09 10:19:24,363 [INFO]: 	Compute fast metrics 03/09/2025, 10:19:24
  0%|          | 0/4 [00:00<?, ?it/s] 25%|██▌       | 1/4 [00:00<00:00,  5.99it/s] 50%|█████     | 2/4 [00:00<00:00,  7.70it/s] 75%|███████▌  | 3/4 [00:00<00:00,  8.34it/s] 75%|███████▌  | 3/4 [00:00<00:00,  6.30it/s]
2025-03-09 10:19:41,243 [INFO]: 	>>> Finished "Compute fast metrics" in 16.8802 secs
2025-03-09 10:19:41,244 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 65.1244 secs
2025-03-09 10:19:41,244 [INFO]: {
2025-03-09 10:19:41,244 [INFO]: 	index_key: HNSW15
2025-03-09 10:19:41,244 [INFO]: 	index_param: efSearch=239
2025-03-09 10:19:41,244 [INFO]: 	index_path: knn.index
2025-03-09 10:19:41,244 [INFO]: 	size in bytes: 1005165370
2025-03-09 10:19:41,244 [INFO]: 	avg_search_speed_ms: 8.998078022287986
2025-03-09 10:19:41,244 [INFO]: 	99p_search_speed_ms: 13.066196464933457
2025-03-09 10:19:41,244 [INFO]: 	reconstruction error %: 0.0
2025-03-09 10:19:41,244 [INFO]: 	nb vectors: 5109
2025-03-09 10:19:41,244 [INFO]: 	vectors dimension: 49152
2025-03-09 10:19:41,244 [INFO]: 	compression ratio: 0.999308473987718
2025-03-09 10:19:41,244 [INFO]: }
2025-03-09 10:19:41,244 [INFO]: 	>>> Finished "Creating the index" in 65.1258 secs
2025-03-09 10:19:41,244 [INFO]: >>> Finished "Launching the whole pipeline" in 65.1512 secs
2025-03-09 10:19:42: [retrieval_preprocessing] calculating distances ...
2025-03-09 10:19:42: [retrieval_preprocessing] finished and saved retrieval indices for episode 80537 [episode count 8/20]
[retrieval_preprocessing] for episode 14619 [episode count 9/20], we have num_retrieval=np.int64(5079) num_query=np.int64(207)
2025-03-09 10:19:44,271 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-09 10:19:45,045 [INFO]: Launching the whole pipeline 03/09/2025, 10:19:45
2025-03-09 10:19:45,046 [INFO]: Reading total number of vectors and dimension 03/09/2025, 10:19:45
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1996.34it/s]
2025-03-09 10:19:45,072 [INFO]: There are 5079 embeddings of dim 49152
2025-03-09 10:19:45,073 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0270 secs
2025-03-09 10:19:45,073 [INFO]: 	Compute estimated construction time of the index 03/09/2025, 10:19:45
2025-03-09 10:19:45,073 [INFO]: 		-> Train: 16.7 minutes
2025-03-09 10:19:45,073 [INFO]: 		-> Add: 2.8 seconds
2025-03-09 10:19:45,073 [INFO]: 		Total: 16.7 minutes
2025-03-09 10:19:45,073 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0001 secs
2025-03-09 10:19:45,073 [INFO]: 	Checking that your have enough memory available to create the index 03/09/2025, 10:19:45
2025-03-09 10:19:45,073 [INFO]: 1.0GB of memory will be needed to build the index (more might be used if you have more)
2025-03-09 10:19:45,073 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0001 secs
2025-03-09 10:19:45,073 [INFO]: 	Selecting most promising index types given data characteristics 03/09/2025, 10:19:45
2025-03-09 10:19:45,073 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-09 10:19:45,073 [INFO]: 	Creating the index 03/09/2025, 10:19:45
2025-03-09 10:19:45,073 [INFO]: 		-> Instanciate the index HNSW15 03/09/2025, 10:19:45
2025-03-09 10:19:45,074 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0010 secs
2025-03-09 10:19:45,074 [INFO]: 		-> Adding the vectors to the index 03/09/2025, 10:19:45
2025-03-09 10:19:45,074 [INFO]: The memory available for adding the vectors is 49.1GB(total available - used by the index)
2025-03-09 10:19:45,074 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/20 [00:00<?, ?it/s]  5%|▌         | 1/20 [00:00<00:02,  6.57it/s] 15%|█▌        | 3/20 [00:00<00:01, 10.38it/s] 25%|██▌       | 5/20 [00:00<00:01, 11.80it/s] 35%|███▌      | 7/20 [00:00<00:01, 12.36it/s] 45%|████▌     | 9/20 [00:00<00:00, 12.65it/s] 55%|█████▌    | 11/20 [00:00<00:00, 12.90it/s] 65%|██████▌   | 13/20 [00:01<00:00, 13.00it/s] 75%|███████▌  | 15/20 [00:01<00:00, 13.08it/s] 85%|████████▌ | 17/20 [00:01<00:00, 13.11it/s] 95%|█████████▌| 19/20 [00:01<00:00, 13.11it/s]100%|██████████| 20/20 [00:05<00:00,  3.83it/s]
2025-03-09 10:19:50,300 [INFO]: 	Computing best hyperparameters for index knn.index 03/09/2025, 10:19:50
2025-03-09 10:20:33,501 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 43.2002 secs
2025-03-09 10:20:33,501 [INFO]: The best hyperparameters are: efSearch=243
2025-03-09 10:20:33,501 [INFO]: 	Compute fast metrics 03/09/2025, 10:20:33
  0%|          | 0/4 [00:00<?, ?it/s] 25%|██▌       | 1/4 [00:00<00:00,  5.53it/s] 50%|█████     | 2/4 [00:00<00:00,  7.36it/s] 75%|███████▌  | 3/4 [00:00<00:00,  8.10it/s] 75%|███████▌  | 3/4 [00:00<00:00,  6.05it/s]
2025-03-09 10:20:51,185 [INFO]: 	>>> Finished "Compute fast metrics" in 17.6836 secs
2025-03-09 10:20:51,188 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 66.1135 secs
2025-03-09 10:20:51,188 [INFO]: {
2025-03-09 10:20:51,188 [INFO]: 	index_key: HNSW15
2025-03-09 10:20:51,188 [INFO]: 	index_param: efSearch=243
2025-03-09 10:20:51,188 [INFO]: 	index_path: knn.index
2025-03-09 10:20:51,188 [INFO]: 	size in bytes: 999262990
2025-03-09 10:20:51,188 [INFO]: 	avg_search_speed_ms: 10.25095227251753
2025-03-09 10:20:51,188 [INFO]: 	99p_search_speed_ms: 19.043938722461462
2025-03-09 10:20:51,188 [INFO]: 	reconstruction error %: 0.0
2025-03-09 10:20:51,188 [INFO]: 	nb vectors: 5079
2025-03-09 10:20:51,188 [INFO]: 	vectors dimension: 49152
2025-03-09 10:20:51,188 [INFO]: 	compression ratio: 0.9993085323814505
2025-03-09 10:20:51,188 [INFO]: }
2025-03-09 10:20:51,188 [INFO]: 	>>> Finished "Creating the index" in 66.1149 secs
2025-03-09 10:20:51,188 [INFO]: >>> Finished "Launching the whole pipeline" in 66.1424 secs
2025-03-09 10:20:52: [retrieval_preprocessing] calculating distances ...
2025-03-09 10:20:53: [retrieval_preprocessing] finished and saved retrieval indices for episode 14619 [episode count 9/20]
[retrieval_preprocessing] for episode 40604 [episode count 10/20], we have num_retrieval=np.int64(4999) num_query=np.int64(287)
2025-03-09 10:20:53,991 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-09 10:20:54,614 [INFO]: Launching the whole pipeline 03/09/2025, 10:20:54
2025-03-09 10:20:54,614 [INFO]: Reading total number of vectors and dimension 03/09/2025, 10:20:54
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1524.65it/s]
2025-03-09 10:20:54,640 [INFO]: There are 4999 embeddings of dim 49152
2025-03-09 10:20:54,641 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0270 secs
2025-03-09 10:20:54,641 [INFO]: 	Compute estimated construction time of the index 03/09/2025, 10:20:54
2025-03-09 10:20:54,641 [INFO]: 		-> Train: 16.7 minutes
2025-03-09 10:20:54,641 [INFO]: 		-> Add: 2.7 seconds
2025-03-09 10:20:54,641 [INFO]: 		Total: 16.7 minutes
2025-03-09 10:20:54,641 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0001 secs
2025-03-09 10:20:54,641 [INFO]: 	Checking that your have enough memory available to create the index 03/09/2025, 10:20:54
2025-03-09 10:20:54,641 [INFO]: 1.0GB of memory will be needed to build the index (more might be used if you have more)
2025-03-09 10:20:54,641 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0001 secs
2025-03-09 10:20:54,641 [INFO]: 	Selecting most promising index types given data characteristics 03/09/2025, 10:20:54
2025-03-09 10:20:54,641 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-09 10:20:54,641 [INFO]: 	Creating the index 03/09/2025, 10:20:54
2025-03-09 10:20:54,641 [INFO]: 		-> Instanciate the index HNSW15 03/09/2025, 10:20:54
2025-03-09 10:20:54,642 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0010 secs
2025-03-09 10:20:54,642 [INFO]: 		-> Adding the vectors to the index 03/09/2025, 10:20:54
2025-03-09 10:20:54,642 [INFO]: The memory available for adding the vectors is 49.1GB(total available - used by the index)
2025-03-09 10:20:54,642 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/20 [00:00<?, ?it/s]  5%|▌         | 1/20 [00:00<00:03,  5.45it/s] 10%|█         | 2/20 [00:00<00:02,  7.28it/s] 15%|█▌        | 3/20 [00:00<00:02,  8.17it/s] 20%|██        | 4/20 [00:00<00:01,  8.66it/s] 25%|██▌       | 5/20 [00:00<00:01,  8.98it/s] 35%|███▌      | 7/20 [00:00<00:01, 10.99it/s] 45%|████▌     | 9/20 [00:00<00:01, 10.11it/s] 55%|█████▌    | 11/20 [00:01<00:00,  9.73it/s] 60%|██████    | 12/20 [00:01<00:00,  9.61it/s] 65%|██████▌   | 13/20 [00:01<00:00,  9.48it/s] 75%|███████▌  | 15/20 [00:01<00:00, 10.31it/s] 85%|████████▌ | 17/20 [00:01<00:00, 11.34it/s] 95%|█████████▌| 19/20 [00:01<00:00, 11.96it/s]100%|██████████| 20/20 [00:05<00:00,  3.51it/s]
2025-03-09 10:21:00,342 [INFO]: 	Computing best hyperparameters for index knn.index 03/09/2025, 10:21:00
2025-03-09 10:21:45,083 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 44.7394 secs
2025-03-09 10:21:45,083 [INFO]: The best hyperparameters are: efSearch=238
2025-03-09 10:21:45,083 [INFO]: 	Compute fast metrics 03/09/2025, 10:21:45
  0%|          | 0/4 [00:00<?, ?it/s] 25%|██▌       | 1/4 [00:00<00:00,  5.91it/s] 75%|███████▌  | 3/4 [00:00<00:00, 10.31it/s]
2025-03-09 10:22:00,297 [INFO]: 	>>> Finished "Compute fast metrics" in 15.2138 secs
2025-03-09 10:22:00,301 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 65.6585 secs
2025-03-09 10:22:00,301 [INFO]: {
2025-03-09 10:22:00,301 [INFO]: 	index_key: HNSW15
2025-03-09 10:22:00,301 [INFO]: 	index_param: efSearch=238
2025-03-09 10:22:00,301 [INFO]: 	index_path: knn.index
2025-03-09 10:22:00,301 [INFO]: 	size in bytes: 983523490
2025-03-09 10:22:00,301 [INFO]: 	avg_search_speed_ms: 11.129362802279907
2025-03-09 10:22:00,302 [INFO]: 	99p_search_speed_ms: 23.25691069709137
2025-03-09 10:22:00,302 [INFO]: 	reconstruction error %: 0.0
2025-03-09 10:22:00,302 [INFO]: 	nb vectors: 4999
2025-03-09 10:22:00,302 [INFO]: 	vectors dimension: 49152
2025-03-09 10:22:00,302 [INFO]: 	compression ratio: 0.9993085086356199
2025-03-09 10:22:00,302 [INFO]: }
2025-03-09 10:22:00,302 [INFO]: 	>>> Finished "Creating the index" in 65.6605 secs
2025-03-09 10:22:00,302 [INFO]: >>> Finished "Launching the whole pipeline" in 65.6880 secs
2025-03-09 10:22:02: [retrieval_preprocessing] calculating distances ...
2025-03-09 10:22:03: [retrieval_preprocessing] finished and saved retrieval indices for episode 40604 [episode count 10/20]
[retrieval_preprocessing] for episode 21535 [episode count 11/20], we have num_retrieval=np.int64(5041) num_query=np.int64(245)
2025-03-09 10:22:04,269 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-09 10:22:05,038 [INFO]: Launching the whole pipeline 03/09/2025, 10:22:05
2025-03-09 10:22:05,038 [INFO]: Reading total number of vectors and dimension 03/09/2025, 10:22:05
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1147.87it/s]
2025-03-09 10:22:05,072 [INFO]: There are 5041 embeddings of dim 49152
2025-03-09 10:22:05,072 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0337 secs
2025-03-09 10:22:05,072 [INFO]: 	Compute estimated construction time of the index 03/09/2025, 10:22:05
2025-03-09 10:22:05,072 [INFO]: 		-> Train: 16.7 minutes
2025-03-09 10:22:05,072 [INFO]: 		-> Add: 2.8 seconds
2025-03-09 10:22:05,072 [INFO]: 		Total: 16.7 minutes
2025-03-09 10:22:05,072 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0001 secs
2025-03-09 10:22:05,072 [INFO]: 	Checking that your have enough memory available to create the index 03/09/2025, 10:22:05
2025-03-09 10:22:05,072 [INFO]: 1.0GB of memory will be needed to build the index (more might be used if you have more)
2025-03-09 10:22:05,073 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0002 secs
2025-03-09 10:22:05,073 [INFO]: 	Selecting most promising index types given data characteristics 03/09/2025, 10:22:05
2025-03-09 10:22:05,073 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-09 10:22:05,073 [INFO]: 	Creating the index 03/09/2025, 10:22:05
2025-03-09 10:22:05,073 [INFO]: 		-> Instanciate the index HNSW15 03/09/2025, 10:22:05
2025-03-09 10:22:05,074 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0011 secs
2025-03-09 10:22:05,074 [INFO]: 		-> Adding the vectors to the index 03/09/2025, 10:22:05
2025-03-09 10:22:05,074 [INFO]: The memory available for adding the vectors is 49.1GB(total available - used by the index)
2025-03-09 10:22:05,074 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/20 [00:00<?, ?it/s]  5%|▌         | 1/20 [00:00<00:02,  8.60it/s] 35%|███▌      | 7/20 [00:00<00:00, 34.35it/s] 65%|██████▌   | 13/20 [00:00<00:00, 42.56it/s] 95%|█████████▌| 19/20 [00:00<00:00, 47.20it/s]100%|██████████| 20/20 [00:04<00:00,  4.79it/s]
2025-03-09 10:22:09,253 [INFO]: 	Computing best hyperparameters for index knn.index 03/09/2025, 10:22:09
2025-03-09 10:22:53,325 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 44.0712 secs
2025-03-09 10:22:53,325 [INFO]: The best hyperparameters are: efSearch=239
2025-03-09 10:22:53,325 [INFO]: 	Compute fast metrics 03/09/2025, 10:22:53
  0%|          | 0/4 [00:00<?, ?it/s] 25%|██▌       | 1/4 [00:00<00:00,  5.53it/s] 50%|█████     | 2/4 [00:00<00:00,  7.49it/s] 75%|███████▌  | 3/4 [00:00<00:00,  8.28it/s] 75%|███████▌  | 3/4 [00:00<00:00,  6.56it/s]
2025-03-09 10:23:08,974 [INFO]: 	>>> Finished "Compute fast metrics" in 15.6481 secs
2025-03-09 10:23:08,977 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 63.9025 secs
2025-03-09 10:23:08,977 [INFO]: {
2025-03-09 10:23:08,977 [INFO]: 	index_key: HNSW15
2025-03-09 10:23:08,977 [INFO]: 	index_param: efSearch=239
2025-03-09 10:23:08,977 [INFO]: 	index_path: knn.index
2025-03-09 10:23:08,977 [INFO]: 	size in bytes: 991786810
2025-03-09 10:23:08,977 [INFO]: 	avg_search_speed_ms: 10.18844118632012
2025-03-09 10:23:08,977 [INFO]: 	99p_search_speed_ms: 19.31039407616481
2025-03-09 10:23:08,977 [INFO]: 	reconstruction error %: 0.0
2025-03-09 10:23:08,977 [INFO]: 	nb vectors: 5041
2025-03-09 10:23:08,977 [INFO]: 	vectors dimension: 49152
2025-03-09 10:23:08,977 [INFO]: 	compression ratio: 0.9993084380704761
2025-03-09 10:23:08,977 [INFO]: }
2025-03-09 10:23:08,977 [INFO]: 	>>> Finished "Creating the index" in 63.9041 secs
2025-03-09 10:23:08,977 [INFO]: >>> Finished "Launching the whole pipeline" in 63.9387 secs
2025-03-09 10:23:10: [retrieval_preprocessing] calculating distances ...
2025-03-09 10:23:11: [retrieval_preprocessing] finished and saved retrieval indices for episode 21535 [episode count 11/20]
[retrieval_preprocessing] for episode 8223 [episode count 12/20], we have num_retrieval=np.int64(5094) num_query=np.int64(192)
2025-03-09 10:23:12,751 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-09 10:23:13,385 [INFO]: Launching the whole pipeline 03/09/2025, 10:23:13
2025-03-09 10:23:13,385 [INFO]: Reading total number of vectors and dimension 03/09/2025, 10:23:13
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1734.62it/s]
2025-03-09 10:23:13,412 [INFO]: There are 5094 embeddings of dim 49152
2025-03-09 10:23:13,413 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0271 secs
2025-03-09 10:23:13,413 [INFO]: 	Compute estimated construction time of the index 03/09/2025, 10:23:13
2025-03-09 10:23:13,413 [INFO]: 		-> Train: 16.7 minutes
2025-03-09 10:23:13,413 [INFO]: 		-> Add: 2.8 seconds
2025-03-09 10:23:13,413 [INFO]: 		Total: 16.7 minutes
2025-03-09 10:23:13,413 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0001 secs
2025-03-09 10:23:13,413 [INFO]: 	Checking that your have enough memory available to create the index 03/09/2025, 10:23:13
2025-03-09 10:23:13,413 [INFO]: 1.0GB of memory will be needed to build the index (more might be used if you have more)
2025-03-09 10:23:13,413 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0002 secs
2025-03-09 10:23:13,413 [INFO]: 	Selecting most promising index types given data characteristics 03/09/2025, 10:23:13
2025-03-09 10:23:13,413 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-09 10:23:13,413 [INFO]: 	Creating the index 03/09/2025, 10:23:13
2025-03-09 10:23:13,413 [INFO]: 		-> Instanciate the index HNSW15 03/09/2025, 10:23:13
2025-03-09 10:23:13,414 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0009 secs
2025-03-09 10:23:13,414 [INFO]: 		-> Adding the vectors to the index 03/09/2025, 10:23:13
2025-03-09 10:23:13,414 [INFO]: The memory available for adding the vectors is 49.1GB(total available - used by the index)
2025-03-09 10:23:13,414 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/22 [00:00<?, ?it/s]  5%|▍         | 1/22 [00:00<00:04,  5.04it/s]  9%|▉         | 2/22 [00:00<00:02,  6.91it/s] 14%|█▎        | 3/22 [00:00<00:02,  7.92it/s] 18%|█▊        | 4/22 [00:00<00:02,  8.40it/s] 23%|██▎       | 5/22 [00:00<00:01,  8.71it/s] 27%|██▋       | 6/22 [00:00<00:01,  8.85it/s] 32%|███▏      | 7/22 [00:00<00:01,  8.97it/s] 36%|███▋      | 8/22 [00:00<00:01,  9.17it/s] 41%|████      | 9/22 [00:01<00:01,  9.17it/s] 45%|████▌     | 10/22 [00:01<00:01,  9.18it/s] 50%|█████     | 11/22 [00:01<00:01,  9.19it/s] 55%|█████▍    | 12/22 [00:01<00:01,  9.14it/s] 59%|█████▉    | 13/22 [00:01<00:00,  9.12it/s] 64%|██████▎   | 14/22 [00:01<00:00,  9.20it/s] 68%|██████▊   | 15/22 [00:01<00:00,  9.09it/s] 73%|███████▎  | 16/22 [00:01<00:00,  9.20it/s] 82%|████████▏ | 18/22 [00:01<00:00, 11.03it/s] 91%|█████████ | 20/22 [00:02<00:00, 12.54it/s]100%|██████████| 22/22 [00:06<00:00,  1.21it/s]100%|██████████| 22/22 [00:06<00:00,  3.46it/s]
2025-03-09 10:23:19,772 [INFO]: 	Computing best hyperparameters for index knn.index 03/09/2025, 10:23:19
2025-03-09 10:24:08,667 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 48.8942 secs
2025-03-09 10:24:08,667 [INFO]: The best hyperparameters are: efSearch=234
2025-03-09 10:24:08,667 [INFO]: 	Compute fast metrics 03/09/2025, 10:24:08
  0%|          | 0/4 [00:00<?, ?it/s] 25%|██▌       | 1/4 [00:00<00:00,  6.03it/s] 75%|███████▌  | 3/4 [00:00<00:00, 10.10it/s] 75%|███████▌  | 3/4 [00:00<00:00,  7.75it/s]
2025-03-09 10:24:23,439 [INFO]: 	>>> Finished "Compute fast metrics" in 14.7722 secs
2025-03-09 10:24:23,440 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 70.0256 secs
2025-03-09 10:24:23,440 [INFO]: {
2025-03-09 10:24:23,440 [INFO]: 	index_key: HNSW15
2025-03-09 10:24:23,440 [INFO]: 	index_param: efSearch=234
2025-03-09 10:24:23,440 [INFO]: 	index_path: knn.index
2025-03-09 10:24:23,440 [INFO]: 	size in bytes: 1002214150
2025-03-09 10:24:23,440 [INFO]: 	avg_search_speed_ms: 9.243773459585972
2025-03-09 10:24:23,440 [INFO]: 	99p_search_speed_ms: 17.83469015033917
2025-03-09 10:24:23,440 [INFO]: 	reconstruction error %: 0.0
2025-03-09 10:24:23,440 [INFO]: 	nb vectors: 5094
2025-03-09 10:24:23,440 [INFO]: 	vectors dimension: 49152
2025-03-09 10:24:23,440 [INFO]: 	compression ratio: 0.9993085330116322
2025-03-09 10:24:23,440 [INFO]: }
2025-03-09 10:24:23,440 [INFO]: 	>>> Finished "Creating the index" in 70.0270 secs
2025-03-09 10:24:23,440 [INFO]: >>> Finished "Launching the whole pipeline" in 70.0547 secs
2025-03-09 10:24:24: [retrieval_preprocessing] calculating distances ...
2025-03-09 10:24:25: [retrieval_preprocessing] finished and saved retrieval indices for episode 8223 [episode count 12/20]
[retrieval_preprocessing] for episode 39455 [episode count 13/20], we have num_retrieval=np.int64(5088) num_query=np.int64(198)
2025-03-09 10:24:25,730 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-09 10:24:26,503 [INFO]: Launching the whole pipeline 03/09/2025, 10:24:26
2025-03-09 10:24:26,503 [INFO]: Reading total number of vectors and dimension 03/09/2025, 10:24:26
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1159.93it/s]
2025-03-09 10:24:26,537 [INFO]: There are 5088 embeddings of dim 49152
2025-03-09 10:24:26,537 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0342 secs
2025-03-09 10:24:26,537 [INFO]: 	Compute estimated construction time of the index 03/09/2025, 10:24:26
2025-03-09 10:24:26,537 [INFO]: 		-> Train: 16.7 minutes
2025-03-09 10:24:26,537 [INFO]: 		-> Add: 2.8 seconds
2025-03-09 10:24:26,537 [INFO]: 		Total: 16.7 minutes
2025-03-09 10:24:26,537 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0001 secs
2025-03-09 10:24:26,537 [INFO]: 	Checking that your have enough memory available to create the index 03/09/2025, 10:24:26
2025-03-09 10:24:26,537 [INFO]: 1.0GB of memory will be needed to build the index (more might be used if you have more)
2025-03-09 10:24:26,537 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0002 secs
2025-03-09 10:24:26,538 [INFO]: 	Selecting most promising index types given data characteristics 03/09/2025, 10:24:26
2025-03-09 10:24:26,538 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-09 10:24:26,538 [INFO]: 	Creating the index 03/09/2025, 10:24:26
2025-03-09 10:24:26,538 [INFO]: 		-> Instanciate the index HNSW15 03/09/2025, 10:24:26
2025-03-09 10:24:26,539 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0012 secs
2025-03-09 10:24:26,539 [INFO]: 		-> Adding the vectors to the index 03/09/2025, 10:24:26
2025-03-09 10:24:26,539 [INFO]: The memory available for adding the vectors is 49.1GB(total available - used by the index)
2025-03-09 10:24:26,539 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/22 [00:00<?, ?it/s]  5%|▍         | 1/22 [00:00<00:02,  8.94it/s] 32%|███▏      | 7/22 [00:00<00:00, 35.53it/s] 59%|█████▉    | 13/22 [00:00<00:00, 45.79it/s] 86%|████████▋ | 19/22 [00:00<00:00, 50.31it/s]100%|██████████| 22/22 [00:04<00:00,  4.74it/s]
2025-03-09 10:24:31,181 [INFO]: 	Computing best hyperparameters for index knn.index 03/09/2025, 10:24:31
2025-03-09 10:25:16,490 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 45.3082 secs
2025-03-09 10:25:16,490 [INFO]: The best hyperparameters are: efSearch=247
2025-03-09 10:25:16,490 [INFO]: 	Compute fast metrics 03/09/2025, 10:25:16
  0%|          | 0/4 [00:00<?, ?it/s] 50%|█████     | 2/4 [00:00<00:00, 19.50it/s] 75%|███████▌  | 3/4 [00:00<00:00, 22.44it/s]
2025-03-09 10:25:36,413 [INFO]: 	>>> Finished "Compute fast metrics" in 19.9225 secs
2025-03-09 10:25:36,413 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 69.8744 secs
2025-03-09 10:25:36,414 [INFO]: {
2025-03-09 10:25:36,414 [INFO]: 	index_key: HNSW15
2025-03-09 10:25:36,414 [INFO]: 	index_param: efSearch=247
2025-03-09 10:25:36,414 [INFO]: 	index_path: knn.index
2025-03-09 10:25:36,414 [INFO]: 	size in bytes: 1001033710
2025-03-09 10:25:36,414 [INFO]: 	avg_search_speed_ms: 9.923710441124433
2025-03-09 10:25:36,414 [INFO]: 	99p_search_speed_ms: 14.170933950226752
2025-03-09 10:25:36,414 [INFO]: 	reconstruction error %: 0.0
2025-03-09 10:25:36,414 [INFO]: 	nb vectors: 5088
2025-03-09 10:25:36,414 [INFO]: 	vectors dimension: 49152
2025-03-09 10:25:36,414 [INFO]: 	compression ratio: 0.9993085088013669
2025-03-09 10:25:36,414 [INFO]: }
2025-03-09 10:25:36,414 [INFO]: 	>>> Finished "Creating the index" in 69.8763 secs
2025-03-09 10:25:36,414 [INFO]: >>> Finished "Launching the whole pipeline" in 69.9112 secs
2025-03-09 10:25:38: [retrieval_preprocessing] calculating distances ...
2025-03-09 10:25:39: [retrieval_preprocessing] finished and saved retrieval indices for episode 39455 [episode count 13/20]
[retrieval_preprocessing] for episode 64802 [episode count 14/20], we have num_retrieval=np.int64(5018) num_query=np.int64(268)
2025-03-09 10:25:40,677 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-09 10:25:41,306 [INFO]: Launching the whole pipeline 03/09/2025, 10:25:41
2025-03-09 10:25:41,306 [INFO]: Reading total number of vectors and dimension 03/09/2025, 10:25:41
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1144.42it/s]
2025-03-09 10:25:41,336 [INFO]: There are 5018 embeddings of dim 49152
2025-03-09 10:25:41,336 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0297 secs
2025-03-09 10:25:41,336 [INFO]: 	Compute estimated construction time of the index 03/09/2025, 10:25:41
2025-03-09 10:25:41,336 [INFO]: 		-> Train: 16.7 minutes
2025-03-09 10:25:41,336 [INFO]: 		-> Add: 2.8 seconds
2025-03-09 10:25:41,336 [INFO]: 		Total: 16.7 minutes
2025-03-09 10:25:41,336 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0001 secs
2025-03-09 10:25:41,336 [INFO]: 	Checking that your have enough memory available to create the index 03/09/2025, 10:25:41
2025-03-09 10:25:41,336 [INFO]: 1.0GB of memory will be needed to build the index (more might be used if you have more)
2025-03-09 10:25:41,337 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0003 secs
2025-03-09 10:25:41,337 [INFO]: 	Selecting most promising index types given data characteristics 03/09/2025, 10:25:41
2025-03-09 10:25:41,337 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-09 10:25:41,337 [INFO]: 	Creating the index 03/09/2025, 10:25:41
2025-03-09 10:25:41,337 [INFO]: 		-> Instanciate the index HNSW15 03/09/2025, 10:25:41
2025-03-09 10:25:41,338 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0013 secs
2025-03-09 10:25:41,338 [INFO]: 		-> Adding the vectors to the index 03/09/2025, 10:25:41
2025-03-09 10:25:41,338 [INFO]: The memory available for adding the vectors is 49.1GB(total available - used by the index)
2025-03-09 10:25:41,338 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/20 [00:00<?, ?it/s]  5%|▌         | 1/20 [00:00<00:04,  4.45it/s] 10%|█         | 2/20 [00:00<00:02,  6.23it/s] 15%|█▌        | 3/20 [00:00<00:02,  7.14it/s] 20%|██        | 4/20 [00:00<00:02,  7.66it/s] 25%|██▌       | 5/20 [00:00<00:01,  7.87it/s] 30%|███       | 6/20 [00:00<00:01,  8.12it/s] 35%|███▌      | 7/20 [00:00<00:01,  8.39it/s] 40%|████      | 8/20 [00:01<00:01,  8.49it/s] 45%|████▌     | 9/20 [00:01<00:01,  8.61it/s] 50%|█████     | 10/20 [00:01<00:01,  8.69it/s] 70%|███████   | 14/20 [00:01<00:00, 13.75it/s] 80%|████████  | 16/20 [00:01<00:00, 11.60it/s] 90%|█████████ | 18/20 [00:02<00:00,  8.89it/s]100%|██████████| 20/20 [00:06<00:00,  1.27it/s]100%|██████████| 20/20 [00:06<00:00,  3.01it/s]
2025-03-09 10:25:48,001 [INFO]: 	Computing best hyperparameters for index knn.index 03/09/2025, 10:25:48
2025-03-09 10:26:31,825 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 43.8234 secs
2025-03-09 10:26:31,825 [INFO]: The best hyperparameters are: efSearch=258
2025-03-09 10:26:31,825 [INFO]: 	Compute fast metrics 03/09/2025, 10:26:31
  0%|          | 0/4 [00:00<?, ?it/s] 50%|█████     | 2/4 [00:00<00:00, 19.09it/s] 75%|███████▌  | 3/4 [00:00<00:00, 21.52it/s]
2025-03-09 10:26:45,272 [INFO]: 	>>> Finished "Compute fast metrics" in 13.4467 secs
2025-03-09 10:26:45,276 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 63.9375 secs
2025-03-09 10:26:45,276 [INFO]: {
2025-03-09 10:26:45,276 [INFO]: 	index_key: HNSW15
2025-03-09 10:26:45,276 [INFO]: 	index_param: efSearch=258
2025-03-09 10:26:45,276 [INFO]: 	index_path: knn.index
2025-03-09 10:26:45,276 [INFO]: 	size in bytes: 987261550
2025-03-09 10:26:45,276 [INFO]: 	avg_search_speed_ms: 13.164435526490898
2025-03-09 10:26:45,276 [INFO]: 	99p_search_speed_ms: 26.853066734038265
2025-03-09 10:26:45,276 [INFO]: 	reconstruction error %: 0.0
2025-03-09 10:26:45,276 [INFO]: 	nb vectors: 5018
2025-03-09 10:26:45,276 [INFO]: 	vectors dimension: 49152
2025-03-09 10:26:45,276 [INFO]: 	compression ratio: 0.9993085864632326
2025-03-09 10:26:45,276 [INFO]: }
2025-03-09 10:26:45,276 [INFO]: 	>>> Finished "Creating the index" in 63.9393 secs
2025-03-09 10:26:45,276 [INFO]: >>> Finished "Launching the whole pipeline" in 63.9698 secs
2025-03-09 10:26:48: [retrieval_preprocessing] calculating distances ...
2025-03-09 10:26:49: [retrieval_preprocessing] finished and saved retrieval indices for episode 64802 [episode count 14/20]
[retrieval_preprocessing] for episode 66849 [episode count 15/20], we have num_retrieval=np.int64(5056) num_query=np.int64(230)
2025-03-09 10:26:51,079 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-09 10:26:51,898 [INFO]: Launching the whole pipeline 03/09/2025, 10:26:51
2025-03-09 10:26:51,898 [INFO]: Reading total number of vectors and dimension 03/09/2025, 10:26:51
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1411.75it/s]
2025-03-09 10:26:51,932 [INFO]: There are 5056 embeddings of dim 49152
2025-03-09 10:26:51,933 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0346 secs
2025-03-09 10:26:51,933 [INFO]: 	Compute estimated construction time of the index 03/09/2025, 10:26:51
2025-03-09 10:26:51,933 [INFO]: 		-> Train: 16.7 minutes
2025-03-09 10:26:51,933 [INFO]: 		-> Add: 2.8 seconds
2025-03-09 10:26:51,933 [INFO]: 		Total: 16.7 minutes
2025-03-09 10:26:51,933 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0001 secs
2025-03-09 10:26:51,933 [INFO]: 	Checking that your have enough memory available to create the index 03/09/2025, 10:26:51
2025-03-09 10:26:51,933 [INFO]: 1.0GB of memory will be needed to build the index (more might be used if you have more)
2025-03-09 10:26:51,933 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0002 secs
2025-03-09 10:26:51,933 [INFO]: 	Selecting most promising index types given data characteristics 03/09/2025, 10:26:51
2025-03-09 10:26:51,933 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-09 10:26:51,933 [INFO]: 	Creating the index 03/09/2025, 10:26:51
2025-03-09 10:26:51,933 [INFO]: 		-> Instanciate the index HNSW15 03/09/2025, 10:26:51
2025-03-09 10:26:51,934 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0011 secs
2025-03-09 10:26:51,934 [INFO]: 		-> Adding the vectors to the index 03/09/2025, 10:26:51
2025-03-09 10:26:51,934 [INFO]: The memory available for adding the vectors is 49.1GB(total available - used by the index)
2025-03-09 10:26:51,935 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/20 [00:00<?, ?it/s]  5%|▌         | 1/20 [00:00<00:03,  5.35it/s] 15%|█▌        | 3/20 [00:00<00:01,  9.28it/s] 25%|██▌       | 5/20 [00:00<00:01, 10.31it/s] 35%|███▌      | 7/20 [00:00<00:01, 10.41it/s] 45%|████▌     | 9/20 [00:00<00:01, 10.15it/s] 55%|█████▌    | 11/20 [00:01<00:00,  9.91it/s] 60%|██████    | 12/20 [00:01<00:00,  9.84it/s] 70%|███████   | 14/20 [00:01<00:00,  9.73it/s] 75%|███████▌  | 15/20 [00:01<00:00,  9.34it/s] 80%|████████  | 16/20 [00:01<00:00,  9.09it/s] 90%|█████████ | 18/20 [00:01<00:00, 10.05it/s]100%|██████████| 20/20 [00:05<00:00,  1.26it/s]100%|██████████| 20/20 [00:05<00:00,  3.39it/s]
2025-03-09 10:26:57,848 [INFO]: 	Computing best hyperparameters for index knn.index 03/09/2025, 10:26:57
2025-03-09 10:27:37,963 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 40.1139 secs
2025-03-09 10:27:37,963 [INFO]: The best hyperparameters are: efSearch=258
2025-03-09 10:27:37,963 [INFO]: 	Compute fast metrics 03/09/2025, 10:27:37
  0%|          | 0/4 [00:00<?, ?it/s] 25%|██▌       | 1/4 [00:00<00:00,  6.41it/s] 75%|███████▌  | 3/4 [00:00<00:00,  9.65it/s] 75%|███████▌  | 3/4 [00:00<00:00,  7.38it/s]
2025-03-09 10:27:51,969 [INFO]: 	>>> Finished "Compute fast metrics" in 14.0057 secs
2025-03-09 10:27:51,972 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 60.0379 secs
2025-03-09 10:27:51,972 [INFO]: {
2025-03-09 10:27:51,972 [INFO]: 	index_key: HNSW15
2025-03-09 10:27:51,972 [INFO]: 	index_param: efSearch=258
2025-03-09 10:27:51,973 [INFO]: 	index_path: knn.index
2025-03-09 10:27:51,973 [INFO]: 	size in bytes: 994737970
2025-03-09 10:27:51,973 [INFO]: 	avg_search_speed_ms: 9.755562736493784
2025-03-09 10:27:51,973 [INFO]: 	99p_search_speed_ms: 14.095011418685317
2025-03-09 10:27:51,973 [INFO]: 	reconstruction error %: 0.0
2025-03-09 10:27:51,973 [INFO]: 	nb vectors: 5056
2025-03-09 10:27:51,973 [INFO]: 	vectors dimension: 49152
2025-03-09 10:27:51,973 [INFO]: 	compression ratio: 0.9993084389851933
2025-03-09 10:27:51,973 [INFO]: }
2025-03-09 10:27:51,973 [INFO]: 	>>> Finished "Creating the index" in 60.0395 secs
2025-03-09 10:27:51,973 [INFO]: >>> Finished "Launching the whole pipeline" in 60.0748 secs
2025-03-09 10:27:53: [retrieval_preprocessing] calculating distances ...
2025-03-09 10:27:54: [retrieval_preprocessing] finished and saved retrieval indices for episode 66849 [episode count 15/20]
[retrieval_preprocessing] for episode 76576 [episode count 16/20], we have num_retrieval=np.int64(4983) num_query=np.int64(303)
2025-03-09 10:27:55,721 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-09 10:27:56,341 [INFO]: Launching the whole pipeline 03/09/2025, 10:27:56
2025-03-09 10:27:56,341 [INFO]: Reading total number of vectors and dimension 03/09/2025, 10:27:56
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1306.64it/s]
2025-03-09 10:27:56,367 [INFO]: There are 4983 embeddings of dim 49152
2025-03-09 10:27:56,367 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0266 secs
2025-03-09 10:27:56,367 [INFO]: 	Compute estimated construction time of the index 03/09/2025, 10:27:56
2025-03-09 10:27:56,368 [INFO]: 		-> Train: 16.7 minutes
2025-03-09 10:27:56,368 [INFO]: 		-> Add: 2.7 seconds
2025-03-09 10:27:56,368 [INFO]: 		Total: 16.7 minutes
2025-03-09 10:27:56,368 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0001 secs
2025-03-09 10:27:56,368 [INFO]: 	Checking that your have enough memory available to create the index 03/09/2025, 10:27:56
2025-03-09 10:27:56,368 [INFO]: 1.0GB of memory will be needed to build the index (more might be used if you have more)
2025-03-09 10:27:56,368 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0002 secs
2025-03-09 10:27:56,368 [INFO]: 	Selecting most promising index types given data characteristics 03/09/2025, 10:27:56
2025-03-09 10:27:56,368 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-09 10:27:56,368 [INFO]: 	Creating the index 03/09/2025, 10:27:56
2025-03-09 10:27:56,368 [INFO]: 		-> Instanciate the index HNSW15 03/09/2025, 10:27:56
2025-03-09 10:27:56,369 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0010 secs
2025-03-09 10:27:56,369 [INFO]: 		-> Adding the vectors to the index 03/09/2025, 10:27:56
2025-03-09 10:27:56,369 [INFO]: The memory available for adding the vectors is 49.1GB(total available - used by the index)
2025-03-09 10:27:56,369 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/20 [00:00<?, ?it/s]  5%|▌         | 1/20 [00:00<00:03,  5.26it/s] 15%|█▌        | 3/20 [00:00<00:02,  8.13it/s] 20%|██        | 4/20 [00:00<00:01,  8.47it/s] 30%|███       | 6/20 [00:00<00:01,  9.40it/s] 40%|████      | 8/20 [00:00<00:01,  9.62it/s] 45%|████▌     | 9/20 [00:00<00:01,  9.54it/s] 50%|█████     | 10/20 [00:01<00:01,  9.57it/s] 55%|█████▌    | 11/20 [00:01<00:00,  9.57it/s] 60%|██████    | 12/20 [00:01<00:00,  9.59it/s] 65%|██████▌   | 13/20 [00:01<00:00,  9.57it/s] 70%|███████   | 14/20 [00:01<00:00,  9.46it/s] 75%|███████▌  | 15/20 [00:01<00:00,  9.55it/s] 80%|████████  | 16/20 [00:01<00:00,  9.58it/s] 85%|████████▌ | 17/20 [00:01<00:00,  9.48it/s] 90%|█████████ | 18/20 [00:01<00:00,  9.52it/s] 95%|█████████▌| 19/20 [00:02<00:00,  9.41it/s]100%|██████████| 20/20 [00:05<00:00,  1.21s/it]100%|██████████| 20/20 [00:05<00:00,  3.42it/s]
2025-03-09 10:28:02,218 [INFO]: 	Computing best hyperparameters for index knn.index 03/09/2025, 10:28:02
2025-03-09 10:28:46,339 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 44.1200 secs
2025-03-09 10:28:46,339 [INFO]: The best hyperparameters are: efSearch=242
2025-03-09 10:28:46,339 [INFO]: 	Compute fast metrics 03/09/2025, 10:28:46
  0%|          | 0/4 [00:00<?, ?it/s] 75%|███████▌  | 3/4 [00:00<00:00, 27.68it/s] 75%|███████▌  | 3/4 [00:00<00:00, 24.04it/s]
2025-03-09 10:29:00,134 [INFO]: 	>>> Finished "Compute fast metrics" in 13.7944 secs
2025-03-09 10:29:00,136 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 63.7673 secs
2025-03-09 10:29:00,137 [INFO]: {
2025-03-09 10:29:00,137 [INFO]: 	index_key: HNSW15
2025-03-09 10:29:00,137 [INFO]: 	index_param: efSearch=242
2025-03-09 10:29:00,137 [INFO]: 	index_path: knn.index
2025-03-09 10:29:00,137 [INFO]: 	size in bytes: 980375410
2025-03-09 10:29:00,137 [INFO]: 	avg_search_speed_ms: 9.274370578706872
2025-03-09 10:29:00,137 [INFO]: 	99p_search_speed_ms: 13.936482674907895
2025-03-09 10:29:00,137 [INFO]: 	reconstruction error %: 0.0
2025-03-09 10:29:00,137 [INFO]: 	nb vectors: 4983
2025-03-09 10:29:00,137 [INFO]: 	vectors dimension: 49152
2025-03-09 10:29:00,137 [INFO]: 	compression ratio: 0.9993086872711342
2025-03-09 10:29:00,137 [INFO]: }
2025-03-09 10:29:00,137 [INFO]: 	>>> Finished "Creating the index" in 63.7688 secs
2025-03-09 10:29:00,137 [INFO]: >>> Finished "Launching the whole pipeline" in 63.7960 secs
2025-03-09 10:29:02: [retrieval_preprocessing] calculating distances ...
2025-03-09 10:29:03: [retrieval_preprocessing] finished and saved retrieval indices for episode 76576 [episode count 16/20]
[retrieval_preprocessing] for episode 77727 [episode count 17/20], we have num_retrieval=np.int64(5055) num_query=np.int64(231)
2025-03-09 10:29:03,686 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-09 10:29:04,247 [INFO]: Launching the whole pipeline 03/09/2025, 10:29:04
2025-03-09 10:29:04,247 [INFO]: Reading total number of vectors and dimension 03/09/2025, 10:29:04
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 2379.07it/s]
2025-03-09 10:29:04,273 [INFO]: There are 5055 embeddings of dim 49152
2025-03-09 10:29:04,274 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0267 secs
2025-03-09 10:29:04,274 [INFO]: 	Compute estimated construction time of the index 03/09/2025, 10:29:04
2025-03-09 10:29:04,274 [INFO]: 		-> Train: 16.7 minutes
2025-03-09 10:29:04,274 [INFO]: 		-> Add: 2.8 seconds
2025-03-09 10:29:04,274 [INFO]: 		Total: 16.7 minutes
2025-03-09 10:29:04,274 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0001 secs
2025-03-09 10:29:04,274 [INFO]: 	Checking that your have enough memory available to create the index 03/09/2025, 10:29:04
2025-03-09 10:29:04,274 [INFO]: 1.0GB of memory will be needed to build the index (more might be used if you have more)
2025-03-09 10:29:04,274 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0001 secs
2025-03-09 10:29:04,274 [INFO]: 	Selecting most promising index types given data characteristics 03/09/2025, 10:29:04
2025-03-09 10:29:04,274 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-09 10:29:04,274 [INFO]: 	Creating the index 03/09/2025, 10:29:04
2025-03-09 10:29:04,274 [INFO]: 		-> Instanciate the index HNSW15 03/09/2025, 10:29:04
2025-03-09 10:29:04,275 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0010 secs
2025-03-09 10:29:04,275 [INFO]: 		-> Adding the vectors to the index 03/09/2025, 10:29:04
2025-03-09 10:29:04,275 [INFO]: The memory available for adding the vectors is 49.1GB(total available - used by the index)
2025-03-09 10:29:04,275 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/20 [00:00<?, ?it/s]  5%|▌         | 1/20 [00:00<00:03,  5.22it/s] 25%|██▌       | 5/20 [00:00<00:00, 19.00it/s] 50%|█████     | 10/20 [00:00<00:00, 29.05it/s] 80%|████████  | 16/20 [00:00<00:00, 35.44it/s]100%|██████████| 20/20 [00:04<00:00,  3.10it/s]100%|██████████| 20/20 [00:04<00:00,  4.68it/s]
2025-03-09 10:29:08,556 [INFO]: 	Computing best hyperparameters for index knn.index 03/09/2025, 10:29:08
2025-03-09 10:29:45,601 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 37.0450 secs
2025-03-09 10:29:45,602 [INFO]: The best hyperparameters are: efSearch=269
2025-03-09 10:29:45,602 [INFO]: 	Compute fast metrics 03/09/2025, 10:29:45
  0%|          | 0/4 [00:00<?, ?it/s] 75%|███████▌  | 3/4 [00:00<00:00, 27.95it/s] 75%|███████▌  | 3/4 [00:00<00:00, 24.66it/s]
2025-03-09 10:30:00,237 [INFO]: 	>>> Finished "Compute fast metrics" in 14.6351 secs
2025-03-09 10:30:00,239 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 55.9636 secs
2025-03-09 10:30:00,239 [INFO]: {
2025-03-09 10:30:00,239 [INFO]: 	index_key: HNSW15
2025-03-09 10:30:00,239 [INFO]: 	index_param: efSearch=269
2025-03-09 10:30:00,239 [INFO]: 	index_path: knn.index
2025-03-09 10:30:00,239 [INFO]: 	size in bytes: 994541230
2025-03-09 10:30:00,239 [INFO]: 	avg_search_speed_ms: 9.568142834560652
2025-03-09 10:30:00,239 [INFO]: 	99p_search_speed_ms: 13.435910260304809
2025-03-09 10:30:00,239 [INFO]: 	reconstruction error %: 0.0
2025-03-09 10:30:00,239 [INFO]: 	nb vectors: 5055
2025-03-09 10:30:00,239 [INFO]: 	vectors dimension: 49152
2025-03-09 10:30:00,239 [INFO]: 	compression ratio: 0.9993084349052075
2025-03-09 10:30:00,239 [INFO]: }
2025-03-09 10:30:00,239 [INFO]: 	>>> Finished "Creating the index" in 55.9651 secs
2025-03-09 10:30:00,239 [INFO]: >>> Finished "Launching the whole pipeline" in 55.9923 secs
2025-03-09 10:30:01: [retrieval_preprocessing] calculating distances ...
2025-03-09 10:30:02: [retrieval_preprocessing] finished and saved retrieval indices for episode 77727 [episode count 17/20]
[retrieval_preprocessing] for episode 50342 [episode count 18/20], we have num_retrieval=np.int64(5006) num_query=np.int64(280)
2025-03-09 10:30:02,547 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-09 10:30:03,340 [INFO]: Launching the whole pipeline 03/09/2025, 10:30:03
2025-03-09 10:30:03,340 [INFO]: Reading total number of vectors and dimension 03/09/2025, 10:30:03
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1966.39it/s]
2025-03-09 10:30:03,512 [INFO]: There are 5006 embeddings of dim 49152
2025-03-09 10:30:03,512 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.1721 secs
2025-03-09 10:30:03,512 [INFO]: 	Compute estimated construction time of the index 03/09/2025, 10:30:03
2025-03-09 10:30:03,513 [INFO]: 		-> Train: 16.7 minutes
2025-03-09 10:30:03,513 [INFO]: 		-> Add: 2.7 seconds
2025-03-09 10:30:03,513 [INFO]: 		Total: 16.7 minutes
2025-03-09 10:30:03,513 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0001 secs
2025-03-09 10:30:03,513 [INFO]: 	Checking that your have enough memory available to create the index 03/09/2025, 10:30:03
2025-03-09 10:30:03,513 [INFO]: 1.0GB of memory will be needed to build the index (more might be used if you have more)
2025-03-09 10:30:03,513 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0001 secs
2025-03-09 10:30:03,513 [INFO]: 	Selecting most promising index types given data characteristics 03/09/2025, 10:30:03
2025-03-09 10:30:03,513 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-09 10:30:03,513 [INFO]: 	Creating the index 03/09/2025, 10:30:03
2025-03-09 10:30:03,513 [INFO]: 		-> Instanciate the index HNSW15 03/09/2025, 10:30:03
2025-03-09 10:30:03,514 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0009 secs
2025-03-09 10:30:03,514 [INFO]: 		-> Adding the vectors to the index 03/09/2025, 10:30:03
2025-03-09 10:30:03,514 [INFO]: The memory available for adding the vectors is 49.1GB(total available - used by the index)
2025-03-09 10:30:03,514 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/20 [00:00<?, ?it/s] 10%|█         | 2/20 [00:00<00:00, 19.88it/s] 45%|████▌     | 9/20 [00:00<00:00, 48.67it/s] 85%|████████▌ | 17/20 [00:00<00:00, 60.15it/s]100%|██████████| 20/20 [00:03<00:00,  5.63it/s]
2025-03-09 10:30:07,073 [INFO]: 	Computing best hyperparameters for index knn.index 03/09/2025, 10:30:07
2025-03-09 10:30:47,804 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 40.7306 secs
2025-03-09 10:30:47,804 [INFO]: The best hyperparameters are: efSearch=248
2025-03-09 10:30:47,804 [INFO]: 	Compute fast metrics 03/09/2025, 10:30:47
  0%|          | 0/4 [00:00<?, ?it/s] 25%|██▌       | 1/4 [00:00<00:00,  5.46it/s] 50%|█████     | 2/4 [00:00<00:00,  7.23it/s] 75%|███████▌  | 3/4 [00:00<00:00,  8.05it/s] 75%|███████▌  | 3/4 [00:00<00:00,  6.07it/s]
2025-03-09 10:31:02,990 [INFO]: 	>>> Finished "Compute fast metrics" in 15.1861 secs
2025-03-09 10:31:02,992 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 59.4785 secs
2025-03-09 10:31:02,993 [INFO]: {
2025-03-09 10:31:02,993 [INFO]: 	index_key: HNSW15
2025-03-09 10:31:02,993 [INFO]: 	index_param: efSearch=248
2025-03-09 10:31:02,993 [INFO]: 	index_path: knn.index
2025-03-09 10:31:02,993 [INFO]: 	size in bytes: 984900670
2025-03-09 10:31:02,993 [INFO]: 	avg_search_speed_ms: 9.383639721304709
2025-03-09 10:31:02,993 [INFO]: 	99p_search_speed_ms: 13.679710484575471
2025-03-09 10:31:02,993 [INFO]: 	reconstruction error %: 0.0
2025-03-09 10:31:02,993 [INFO]: 	nb vectors: 5006
2025-03-09 10:31:02,993 [INFO]: 	vectors dimension: 49152
2025-03-09 10:31:02,993 [INFO]: 	compression ratio: 0.999308537377683
2025-03-09 10:31:02,993 [INFO]: }
2025-03-09 10:31:02,993 [INFO]: 	>>> Finished "Creating the index" in 59.4798 secs
2025-03-09 10:31:02,993 [INFO]: >>> Finished "Launching the whole pipeline" in 59.6525 secs
2025-03-09 10:31:04: [retrieval_preprocessing] calculating distances ...
2025-03-09 10:31:05: [retrieval_preprocessing] finished and saved retrieval indices for episode 50342 [episode count 18/20]
[retrieval_preprocessing] for episode 83362 [episode count 19/20], we have num_retrieval=np.int64(5053) num_query=np.int64(233)
2025-03-09 10:31:05,788 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-09 10:31:06,364 [INFO]: Launching the whole pipeline 03/09/2025, 10:31:06
2025-03-09 10:31:06,364 [INFO]: Reading total number of vectors and dimension 03/09/2025, 10:31:06
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 2307.10it/s]
2025-03-09 10:31:06,390 [INFO]: There are 5053 embeddings of dim 49152
2025-03-09 10:31:06,390 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0264 secs
2025-03-09 10:31:06,391 [INFO]: 	Compute estimated construction time of the index 03/09/2025, 10:31:06
2025-03-09 10:31:06,391 [INFO]: 		-> Train: 16.7 minutes
2025-03-09 10:31:06,391 [INFO]: 		-> Add: 2.8 seconds
2025-03-09 10:31:06,391 [INFO]: 		Total: 16.7 minutes
2025-03-09 10:31:06,391 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0001 secs
2025-03-09 10:31:06,391 [INFO]: 	Checking that your have enough memory available to create the index 03/09/2025, 10:31:06
2025-03-09 10:31:06,391 [INFO]: 1.0GB of memory will be needed to build the index (more might be used if you have more)
2025-03-09 10:31:06,391 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0002 secs
2025-03-09 10:31:06,391 [INFO]: 	Selecting most promising index types given data characteristics 03/09/2025, 10:31:06
2025-03-09 10:31:06,391 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-09 10:31:06,391 [INFO]: 	Creating the index 03/09/2025, 10:31:06
2025-03-09 10:31:06,391 [INFO]: 		-> Instanciate the index HNSW15 03/09/2025, 10:31:06
2025-03-09 10:31:06,392 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0008 secs
2025-03-09 10:31:06,392 [INFO]: 		-> Adding the vectors to the index 03/09/2025, 10:31:06
2025-03-09 10:31:06,392 [INFO]: The memory available for adding the vectors is 49.1GB(total available - used by the index)
2025-03-09 10:31:06,392 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/20 [00:00<?, ?it/s] 10%|█         | 2/20 [00:00<00:00, 18.90it/s] 40%|████      | 8/20 [00:00<00:00, 42.12it/s] 70%|███████   | 14/20 [00:00<00:00, 49.98it/s]100%|██████████| 20/20 [00:03<00:00,  3.68it/s]100%|██████████| 20/20 [00:03<00:00,  5.11it/s]
2025-03-09 10:31:10,307 [INFO]: 	Computing best hyperparameters for index knn.index 03/09/2025, 10:31:10
2025-03-09 10:31:52,764 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 42.4570 secs
2025-03-09 10:31:52,764 [INFO]: The best hyperparameters are: efSearch=246
2025-03-09 10:31:52,764 [INFO]: 	Compute fast metrics 03/09/2025, 10:31:52
  0%|          | 0/4 [00:00<?, ?it/s] 25%|██▌       | 1/4 [00:00<00:00,  5.39it/s] 50%|█████     | 2/4 [00:00<00:00,  7.29it/s] 75%|███████▌  | 3/4 [00:00<00:00,  8.08it/s] 75%|███████▌  | 3/4 [00:00<00:00,  6.06it/s]
2025-03-09 10:32:08,409 [INFO]: 	>>> Finished "Compute fast metrics" in 15.6448 secs
2025-03-09 10:32:08,412 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 62.0197 secs
2025-03-09 10:32:08,412 [INFO]: {
2025-03-09 10:32:08,412 [INFO]: 	index_key: HNSW15
2025-03-09 10:32:08,412 [INFO]: 	index_param: efSearch=246
2025-03-09 10:32:08,412 [INFO]: 	index_path: knn.index
2025-03-09 10:32:08,412 [INFO]: 	size in bytes: 994147750
2025-03-09 10:32:08,412 [INFO]: 	avg_search_speed_ms: 9.368255153785423
2025-03-09 10:32:08,412 [INFO]: 	99p_search_speed_ms: 13.706816122867165
2025-03-09 10:32:08,412 [INFO]: 	reconstruction error %: 0.0
2025-03-09 10:32:08,412 [INFO]: 	nb vectors: 5053
2025-03-09 10:32:08,412 [INFO]: 	vectors dimension: 49152
2025-03-09 10:32:08,412 [INFO]: 	compression ratio: 0.9993084267403914
2025-03-09 10:32:08,412 [INFO]: }
2025-03-09 10:32:08,412 [INFO]: 	>>> Finished "Creating the index" in 62.0210 secs
2025-03-09 10:32:08,412 [INFO]: >>> Finished "Launching the whole pipeline" in 62.0481 secs
2025-03-09 10:32:09: [retrieval_preprocessing] calculating distances ...
2025-03-09 10:32:10: [retrieval_preprocessing] finished and saved retrieval indices for episode 83362 [episode count 19/20]
2025-03-09 10:32:10: [retrieval_preprocessing] finished for (4312815282, 'marker') [chosen_id count 7/10]
2025-03-09 10:32:11: [retrieval_preprocessing] concatenated all embeddings and indices for 20 episodes for (-1, 'cup') [chosen_id count 8/10]
2025-03-09 10:32:11: [retrieval_preprocessing] we have num_total=2717 embedding_dim=49152
[retrieval_preprocessing] for episode 50176 [episode count 0/20], we have num_retrieval=np.int64(2587) num_query=np.int64(130)
2025-03-09 10:32:11,982 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-09 10:32:12,269 [INFO]: Launching the whole pipeline 03/09/2025, 10:32:12
2025-03-09 10:32:12,270 [INFO]: Reading total number of vectors and dimension 03/09/2025, 10:32:12
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1506.03it/s]
2025-03-09 10:32:12,297 [INFO]: There are 2587 embeddings of dim 49152
2025-03-09 10:32:12,297 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0274 secs
2025-03-09 10:32:12,297 [INFO]: 	Compute estimated construction time of the index 03/09/2025, 10:32:12
2025-03-09 10:32:12,297 [INFO]: 		-> Train: 16.7 minutes
2025-03-09 10:32:12,297 [INFO]: 		-> Add: 1.4 seconds
2025-03-09 10:32:12,297 [INFO]: 		Total: 16.7 minutes
2025-03-09 10:32:12,297 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0003 secs
2025-03-09 10:32:12,298 [INFO]: 	Checking that your have enough memory available to create the index 03/09/2025, 10:32:12
2025-03-09 10:32:12,298 [INFO]: 533.9MB of memory will be needed to build the index (more might be used if you have more)
2025-03-09 10:32:12,298 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0004 secs
2025-03-09 10:32:12,298 [INFO]: 	Selecting most promising index types given data characteristics 03/09/2025, 10:32:12
2025-03-09 10:32:12,298 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-09 10:32:12,298 [INFO]: 	Creating the index 03/09/2025, 10:32:12
2025-03-09 10:32:12,298 [INFO]: 		-> Instanciate the index HNSW15 03/09/2025, 10:32:12
2025-03-09 10:32:12,301 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0027 secs
2025-03-09 10:32:12,301 [INFO]: 		-> Adding the vectors to the index 03/09/2025, 10:32:12
2025-03-09 10:32:12,302 [INFO]: The memory available for adding the vectors is 49.5GB(total available - used by the index)
2025-03-09 10:32:12,302 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/11 [00:00<?, ?it/s] 27%|██▋       | 3/11 [00:00<00:00, 27.34it/s] 91%|█████████ | 10/11 [00:00<00:00, 48.96it/s]100%|██████████| 11/11 [00:01<00:00,  7.22it/s]
2025-03-09 10:32:13,831 [INFO]: 	Computing best hyperparameters for index knn.index 03/09/2025, 10:32:13
2025-03-09 10:32:39,563 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 25.7325 secs
2025-03-09 10:32:39,563 [INFO]: The best hyperparameters are: efSearch=328
2025-03-09 10:32:39,563 [INFO]: 	Compute fast metrics 03/09/2025, 10:32:39
  0%|          | 0/4 [00:00<?, ?it/s] 75%|███████▌  | 3/4 [00:00<00:00, 27.87it/s] 75%|███████▌  | 3/4 [00:00<00:00, 24.19it/s]
2025-03-09 10:32:55,936 [INFO]: 	>>> Finished "Compute fast metrics" in 16.3723 secs
2025-03-09 10:32:55,937 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 43.6359 secs
2025-03-09 10:32:55,937 [INFO]: {
2025-03-09 10:32:55,937 [INFO]: 	index_key: HNSW15
2025-03-09 10:32:55,938 [INFO]: 	index_param: efSearch=328
2025-03-09 10:32:55,938 [INFO]: 	index_path: knn.index
2025-03-09 10:32:55,938 [INFO]: 	size in bytes: 508976410
2025-03-09 10:32:55,938 [INFO]: 	avg_search_speed_ms: 10.069454387524367
2025-03-09 10:32:55,938 [INFO]: 	99p_search_speed_ms: 14.888635538518429
2025-03-09 10:32:55,938 [INFO]: 	reconstruction error %: 0.0
2025-03-09 10:32:55,938 [INFO]: 	nb vectors: 2587
2025-03-09 10:32:55,938 [INFO]: 	vectors dimension: 49152
2025-03-09 10:32:55,938 [INFO]: 	compression ratio: 0.9993093707427423
2025-03-09 10:32:55,938 [INFO]: }
2025-03-09 10:32:55,938 [INFO]: 	>>> Finished "Creating the index" in 43.6393 secs
2025-03-09 10:32:55,938 [INFO]: >>> Finished "Launching the whole pipeline" in 43.6682 secs
2025-03-09 10:32:56: [retrieval_preprocessing] calculating distances ...
2025-03-09 10:32:56: [retrieval_preprocessing] finished and saved retrieval indices for episode 50176 [episode count 0/20]
[retrieval_preprocessing] for episode 83457 [episode count 1/20], we have num_retrieval=np.int64(2623) num_query=np.int64(94)
2025-03-09 10:32:57,122 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-09 10:32:57,412 [INFO]: Launching the whole pipeline 03/09/2025, 10:32:57
2025-03-09 10:32:57,412 [INFO]: Reading total number of vectors and dimension 03/09/2025, 10:32:57
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1500.11it/s]
2025-03-09 10:32:57,438 [INFO]: There are 2623 embeddings of dim 49152
2025-03-09 10:32:57,438 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0260 secs
2025-03-09 10:32:57,438 [INFO]: 	Compute estimated construction time of the index 03/09/2025, 10:32:57
2025-03-09 10:32:57,438 [INFO]: 		-> Train: 16.7 minutes
2025-03-09 10:32:57,438 [INFO]: 		-> Add: 1.4 seconds
2025-03-09 10:32:57,438 [INFO]: 		Total: 16.7 minutes
2025-03-09 10:32:57,438 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0001 secs
2025-03-09 10:32:57,438 [INFO]: 	Checking that your have enough memory available to create the index 03/09/2025, 10:32:57
2025-03-09 10:32:57,438 [INFO]: 541.3MB of memory will be needed to build the index (more might be used if you have more)
2025-03-09 10:32:57,438 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0001 secs
2025-03-09 10:32:57,438 [INFO]: 	Selecting most promising index types given data characteristics 03/09/2025, 10:32:57
2025-03-09 10:32:57,438 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-09 10:32:57,438 [INFO]: 	Creating the index 03/09/2025, 10:32:57
2025-03-09 10:32:57,438 [INFO]: 		-> Instanciate the index HNSW15 03/09/2025, 10:32:57
2025-03-09 10:32:57,440 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0012 secs
2025-03-09 10:32:57,440 [INFO]: 		-> Adding the vectors to the index 03/09/2025, 10:32:57
2025-03-09 10:32:57,440 [INFO]: The memory available for adding the vectors is 49.5GB(total available - used by the index)
2025-03-09 10:32:57,440 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/11 [00:00<?, ?it/s] 27%|██▋       | 3/11 [00:00<00:00, 28.22it/s]100%|██████████| 11/11 [00:01<00:00,  6.83it/s]100%|██████████| 11/11 [00:01<00:00,  7.28it/s]
2025-03-09 10:32:58,955 [INFO]: 	Computing best hyperparameters for index knn.index 03/09/2025, 10:32:58
2025-03-09 10:33:20,532 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 21.5766 secs
2025-03-09 10:33:20,532 [INFO]: The best hyperparameters are: efSearch=325
2025-03-09 10:33:20,532 [INFO]: 	Compute fast metrics 03/09/2025, 10:33:20
  0%|          | 0/4 [00:00<?, ?it/s] 25%|██▌       | 1/4 [00:00<00:00,  7.49it/s] 75%|███████▌  | 3/4 [00:00<00:00, 12.49it/s] 75%|███████▌  | 3/4 [00:00<00:00,  9.52it/s]
2025-03-09 10:33:34,586 [INFO]: 	>>> Finished "Compute fast metrics" in 14.0536 secs
2025-03-09 10:33:34,587 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 37.1475 secs
2025-03-09 10:33:34,587 [INFO]: {
2025-03-09 10:33:34,587 [INFO]: 	index_key: HNSW15
2025-03-09 10:33:34,587 [INFO]: 	index_param: efSearch=325
2025-03-09 10:33:34,587 [INFO]: 	index_path: knn.index
2025-03-09 10:33:34,587 [INFO]: 	size in bytes: 516059170
2025-03-09 10:33:34,588 [INFO]: 	avg_search_speed_ms: 9.228612780416336
2025-03-09 10:33:34,588 [INFO]: 	99p_search_speed_ms: 12.33242369024083
2025-03-09 10:33:34,588 [INFO]: 	reconstruction error %: 0.0
2025-03-09 10:33:34,588 [INFO]: 	nb vectors: 2623
2025-03-09 10:33:34,588 [INFO]: 	vectors dimension: 49152
2025-03-09 10:33:34,588 [INFO]: 	compression ratio: 0.9993094086478495
2025-03-09 10:33:34,588 [INFO]: }
2025-03-09 10:33:34,588 [INFO]: 	>>> Finished "Creating the index" in 37.1492 secs
2025-03-09 10:33:34,588 [INFO]: >>> Finished "Launching the whole pipeline" in 37.1758 secs
2025-03-09 10:33:35: [retrieval_preprocessing] calculating distances ...
2025-03-09 10:33:35: [retrieval_preprocessing] finished and saved retrieval indices for episode 83457 [episode count 1/20]
[retrieval_preprocessing] for episode 70669 [episode count 2/20], we have num_retrieval=np.int64(2582) num_query=np.int64(135)
2025-03-09 10:33:35,578 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-09 10:33:35,884 [INFO]: Launching the whole pipeline 03/09/2025, 10:33:35
2025-03-09 10:33:35,884 [INFO]: Reading total number of vectors and dimension 03/09/2025, 10:33:35
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1561.54it/s]
2025-03-09 10:33:35,907 [INFO]: There are 2582 embeddings of dim 49152
2025-03-09 10:33:35,907 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0226 secs
2025-03-09 10:33:35,907 [INFO]: 	Compute estimated construction time of the index 03/09/2025, 10:33:35
2025-03-09 10:33:35,907 [INFO]: 		-> Train: 16.7 minutes
2025-03-09 10:33:35,907 [INFO]: 		-> Add: 1.4 seconds
2025-03-09 10:33:35,907 [INFO]: 		Total: 16.7 minutes
2025-03-09 10:33:35,907 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0001 secs
2025-03-09 10:33:35,907 [INFO]: 	Checking that your have enough memory available to create the index 03/09/2025, 10:33:35
2025-03-09 10:33:35,907 [INFO]: 532.9MB of memory will be needed to build the index (more might be used if you have more)
2025-03-09 10:33:35,907 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0001 secs
2025-03-09 10:33:35,907 [INFO]: 	Selecting most promising index types given data characteristics 03/09/2025, 10:33:35
2025-03-09 10:33:35,907 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-09 10:33:35,907 [INFO]: 	Creating the index 03/09/2025, 10:33:35
2025-03-09 10:33:35,907 [INFO]: 		-> Instanciate the index HNSW15 03/09/2025, 10:33:35
2025-03-09 10:33:35,908 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0007 secs
2025-03-09 10:33:35,908 [INFO]: 		-> Adding the vectors to the index 03/09/2025, 10:33:35
2025-03-09 10:33:35,908 [INFO]: The memory available for adding the vectors is 49.5GB(total available - used by the index)
2025-03-09 10:33:35,908 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/11 [00:00<?, ?it/s] 18%|█▊        | 2/11 [00:00<00:00, 19.09it/s] 73%|███████▎  | 8/11 [00:00<00:00, 42.49it/s]100%|██████████| 11/11 [00:01<00:00,  6.46it/s]
2025-03-09 10:33:37,614 [INFO]: 	Computing best hyperparameters for index knn.index 03/09/2025, 10:33:37
2025-03-09 10:34:01,056 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 23.4411 secs
2025-03-09 10:34:01,056 [INFO]: The best hyperparameters are: efSearch=284
2025-03-09 10:34:01,056 [INFO]: 	Compute fast metrics 03/09/2025, 10:34:01
  0%|          | 0/4 [00:00<?, ?it/s] 25%|██▌       | 1/4 [00:00<00:00,  6.47it/s] 75%|███████▌  | 3/4 [00:00<00:00, 10.77it/s] 75%|███████▌  | 3/4 [00:00<00:00,  8.19it/s]
2025-03-09 10:34:14,241 [INFO]: 	>>> Finished "Compute fast metrics" in 13.1845 secs
2025-03-09 10:34:14,242 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 38.3338 secs
2025-03-09 10:34:14,242 [INFO]: {
2025-03-09 10:34:14,242 [INFO]: 	index_key: HNSW15
2025-03-09 10:34:14,242 [INFO]: 	index_param: efSearch=284
2025-03-09 10:34:14,242 [INFO]: 	index_path: knn.index
2025-03-09 10:34:14,242 [INFO]: 	size in bytes: 507992650
2025-03-09 10:34:14,242 [INFO]: 	avg_search_speed_ms: 9.604854323148842
2025-03-09 10:34:14,242 [INFO]: 	99p_search_speed_ms: 12.923976872116327
2025-03-09 10:34:14,242 [INFO]: 	reconstruction error %: 0.0
2025-03-09 10:34:14,242 [INFO]: 	nb vectors: 2582
2025-03-09 10:34:14,242 [INFO]: 	vectors dimension: 49152
2025-03-09 10:34:14,242 [INFO]: 	compression ratio: 0.9993094506387051
2025-03-09 10:34:14,242 [INFO]: }
2025-03-09 10:34:14,242 [INFO]: 	>>> Finished "Creating the index" in 38.3349 secs
2025-03-09 10:34:14,242 [INFO]: >>> Finished "Launching the whole pipeline" in 38.3579 secs
2025-03-09 10:34:14: [retrieval_preprocessing] calculating distances ...
2025-03-09 10:34:15: [retrieval_preprocessing] finished and saved retrieval indices for episode 70669 [episode count 2/20]
[retrieval_preprocessing] for episode 8725 [episode count 3/20], we have num_retrieval=np.int64(2573) num_query=np.int64(144)
2025-03-09 10:34:15,456 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-09 10:34:15,750 [INFO]: Launching the whole pipeline 03/09/2025, 10:34:15
2025-03-09 10:34:15,750 [INFO]: Reading total number of vectors and dimension 03/09/2025, 10:34:15
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 2371.00it/s]
2025-03-09 10:34:15,774 [INFO]: There are 2573 embeddings of dim 49152
2025-03-09 10:34:15,774 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0241 secs
2025-03-09 10:34:15,774 [INFO]: 	Compute estimated construction time of the index 03/09/2025, 10:34:15
2025-03-09 10:34:15,774 [INFO]: 		-> Train: 16.7 minutes
2025-03-09 10:34:15,774 [INFO]: 		-> Add: 1.4 seconds
2025-03-09 10:34:15,774 [INFO]: 		Total: 16.7 minutes
2025-03-09 10:34:15,774 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0001 secs
2025-03-09 10:34:15,774 [INFO]: 	Checking that your have enough memory available to create the index 03/09/2025, 10:34:15
2025-03-09 10:34:15,774 [INFO]: 531.0MB of memory will be needed to build the index (more might be used if you have more)
2025-03-09 10:34:15,774 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0001 secs
2025-03-09 10:34:15,774 [INFO]: 	Selecting most promising index types given data characteristics 03/09/2025, 10:34:15
2025-03-09 10:34:15,774 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-09 10:34:15,774 [INFO]: 	Creating the index 03/09/2025, 10:34:15
2025-03-09 10:34:15,774 [INFO]: 		-> Instanciate the index HNSW15 03/09/2025, 10:34:15
2025-03-09 10:34:15,775 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0010 secs
2025-03-09 10:34:15,776 [INFO]: 		-> Adding the vectors to the index 03/09/2025, 10:34:15
2025-03-09 10:34:15,776 [INFO]: The memory available for adding the vectors is 49.5GB(total available - used by the index)
2025-03-09 10:34:15,776 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/11 [00:00<?, ?it/s] 27%|██▋       | 3/11 [00:00<00:00, 26.44it/s] 91%|█████████ | 10/11 [00:00<00:00, 49.21it/s]100%|██████████| 11/11 [00:01<00:00,  6.34it/s]
2025-03-09 10:34:17,512 [INFO]: 	Computing best hyperparameters for index knn.index 03/09/2025, 10:34:17
2025-03-09 10:34:40,275 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 22.7625 secs
2025-03-09 10:34:40,275 [INFO]: The best hyperparameters are: efSearch=246
2025-03-09 10:34:40,276 [INFO]: 	Compute fast metrics 03/09/2025, 10:34:40
  0%|          | 0/4 [00:00<?, ?it/s] 25%|██▌       | 1/4 [00:00<00:00,  6.40it/s] 75%|███████▌  | 3/4 [00:00<00:00, 10.35it/s] 75%|███████▌  | 3/4 [00:00<00:00,  7.96it/s]
2025-03-09 10:34:53,454 [INFO]: 	>>> Finished "Compute fast metrics" in 13.1783 secs
2025-03-09 10:34:53,455 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 37.6797 secs
2025-03-09 10:34:53,455 [INFO]: {
2025-03-09 10:34:53,455 [INFO]: 	index_key: HNSW15
2025-03-09 10:34:53,455 [INFO]: 	index_param: efSearch=246
2025-03-09 10:34:53,455 [INFO]: 	index_path: knn.index
2025-03-09 10:34:53,455 [INFO]: 	size in bytes: 506221870
2025-03-09 10:34:53,455 [INFO]: 	avg_search_speed_ms: 8.16822753214046
2025-03-09 10:34:53,455 [INFO]: 	99p_search_speed_ms: 10.997105920687316
2025-03-09 10:34:53,455 [INFO]: 	reconstruction error %: 0.0
2025-03-09 10:34:53,455 [INFO]: 	nb vectors: 2573
2025-03-09 10:34:53,455 [INFO]: 	vectors dimension: 49152
2025-03-09 10:34:53,456 [INFO]: 	compression ratio: 0.9993096189226277
2025-03-09 10:34:53,456 [INFO]: }
2025-03-09 10:34:53,456 [INFO]: 	>>> Finished "Creating the index" in 37.6812 secs
2025-03-09 10:34:53,456 [INFO]: >>> Finished "Launching the whole pipeline" in 37.7058 secs
2025-03-09 10:34:54: [retrieval_preprocessing] calculating distances ...
2025-03-09 10:34:54: [retrieval_preprocessing] finished and saved retrieval indices for episode 8725 [episode count 3/20]
[retrieval_preprocessing] for episode 75292 [episode count 4/20], we have num_retrieval=np.int64(2510) num_query=np.int64(207)
2025-03-09 10:34:54,930 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-09 10:34:55,216 [INFO]: Launching the whole pipeline 03/09/2025, 10:34:55
2025-03-09 10:34:55,217 [INFO]: Reading total number of vectors and dimension 03/09/2025, 10:34:55
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1831.57it/s]
2025-03-09 10:34:55,249 [INFO]: There are 2510 embeddings of dim 49152
2025-03-09 10:34:55,249 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0326 secs
2025-03-09 10:34:55,249 [INFO]: 	Compute estimated construction time of the index 03/09/2025, 10:34:55
2025-03-09 10:34:55,249 [INFO]: 		-> Train: 16.7 minutes
2025-03-09 10:34:55,249 [INFO]: 		-> Add: 1.4 seconds
2025-03-09 10:34:55,249 [INFO]: 		Total: 16.7 minutes
2025-03-09 10:34:55,250 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0002 secs
2025-03-09 10:34:55,250 [INFO]: 	Checking that your have enough memory available to create the index 03/09/2025, 10:34:55
2025-03-09 10:34:55,250 [INFO]: 518.0MB of memory will be needed to build the index (more might be used if you have more)
2025-03-09 10:34:55,250 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0003 secs
2025-03-09 10:34:55,250 [INFO]: 	Selecting most promising index types given data characteristics 03/09/2025, 10:34:55
2025-03-09 10:34:55,250 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-09 10:34:55,250 [INFO]: 	Creating the index 03/09/2025, 10:34:55
2025-03-09 10:34:55,250 [INFO]: 		-> Instanciate the index HNSW15 03/09/2025, 10:34:55
2025-03-09 10:34:55,252 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0020 secs
2025-03-09 10:34:55,253 [INFO]: 		-> Adding the vectors to the index 03/09/2025, 10:34:55
2025-03-09 10:34:55,253 [INFO]: The memory available for adding the vectors is 49.5GB(total available - used by the index)
2025-03-09 10:34:55,253 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/10 [00:00<?, ?it/s] 20%|██        | 2/10 [00:00<00:00, 19.12it/s] 80%|████████  | 8/10 [00:00<00:00, 42.02it/s]100%|██████████| 10/10 [00:01<00:00,  5.86it/s]
2025-03-09 10:34:56,963 [INFO]: 	Computing best hyperparameters for index knn.index 03/09/2025, 10:34:56
2025-03-09 10:35:20,497 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 23.5330 secs
2025-03-09 10:35:20,497 [INFO]: The best hyperparameters are: efSearch=285
2025-03-09 10:35:20,497 [INFO]: 	Compute fast metrics 03/09/2025, 10:35:20
  0%|          | 0/4 [00:00<?, ?it/s] 25%|██▌       | 1/4 [00:00<00:00,  5.31it/s] 50%|█████     | 2/4 [00:00<00:00,  7.13it/s] 75%|███████▌  | 3/4 [00:00<00:00,  8.08it/s] 75%|███████▌  | 3/4 [00:00<00:00,  6.01it/s]
2025-03-09 10:35:34,268 [INFO]: 	>>> Finished "Compute fast metrics" in 13.7713 secs
2025-03-09 10:35:34,270 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 39.0169 secs
2025-03-09 10:35:34,270 [INFO]: {
2025-03-09 10:35:34,270 [INFO]: 	index_key: HNSW15
2025-03-09 10:35:34,270 [INFO]: 	index_param: efSearch=285
2025-03-09 10:35:34,270 [INFO]: 	index_path: knn.index
2025-03-09 10:35:34,270 [INFO]: 	size in bytes: 493826890
2025-03-09 10:35:34,270 [INFO]: 	avg_search_speed_ms: 9.520946802305323
2025-03-09 10:35:34,270 [INFO]: 	99p_search_speed_ms: 12.806331729516387
2025-03-09 10:35:34,270 [INFO]: 	reconstruction error %: 0.0
2025-03-09 10:35:34,270 [INFO]: 	nb vectors: 2510
2025-03-09 10:35:34,270 [INFO]: 	vectors dimension: 49152
2025-03-09 10:35:34,270 [INFO]: 	compression ratio: 0.9993098593719755
2025-03-09 10:35:34,270 [INFO]: }
2025-03-09 10:35:34,270 [INFO]: 	>>> Finished "Creating the index" in 39.0196 secs
2025-03-09 10:35:34,270 [INFO]: >>> Finished "Launching the whole pipeline" in 39.0533 secs
2025-03-09 10:35:35: [retrieval_preprocessing] calculating distances ...
2025-03-09 10:35:36: [retrieval_preprocessing] finished and saved retrieval indices for episode 75292 [episode count 4/20]
[retrieval_preprocessing] for episode 6181 [episode count 5/20], we have num_retrieval=np.int64(2593) num_query=np.int64(124)
2025-03-09 10:35:36,727 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-09 10:35:37,042 [INFO]: Launching the whole pipeline 03/09/2025, 10:35:37
2025-03-09 10:35:37,042 [INFO]: Reading total number of vectors and dimension 03/09/2025, 10:35:37
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1341.75it/s]
2025-03-09 10:35:37,072 [INFO]: There are 2593 embeddings of dim 49152
2025-03-09 10:35:37,072 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0298 secs
2025-03-09 10:35:37,073 [INFO]: 	Compute estimated construction time of the index 03/09/2025, 10:35:37
2025-03-09 10:35:37,073 [INFO]: 		-> Train: 16.7 minutes
2025-03-09 10:35:37,073 [INFO]: 		-> Add: 1.4 seconds
2025-03-09 10:35:37,073 [INFO]: 		Total: 16.7 minutes
2025-03-09 10:35:37,073 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0003 secs
2025-03-09 10:35:37,073 [INFO]: 	Checking that your have enough memory available to create the index 03/09/2025, 10:35:37
2025-03-09 10:35:37,073 [INFO]: 535.1MB of memory will be needed to build the index (more might be used if you have more)
2025-03-09 10:35:37,074 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0005 secs
2025-03-09 10:35:37,074 [INFO]: 	Selecting most promising index types given data characteristics 03/09/2025, 10:35:37
2025-03-09 10:35:37,074 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-09 10:35:37,074 [INFO]: 	Creating the index 03/09/2025, 10:35:37
2025-03-09 10:35:37,074 [INFO]: 		-> Instanciate the index HNSW15 03/09/2025, 10:35:37
2025-03-09 10:35:37,077 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0025 secs
2025-03-09 10:35:37,077 [INFO]: 		-> Adding the vectors to the index 03/09/2025, 10:35:37
2025-03-09 10:35:37,077 [INFO]: The memory available for adding the vectors is 49.5GB(total available - used by the index)
2025-03-09 10:35:37,077 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/11 [00:00<?, ?it/s] 18%|█▊        | 2/11 [00:00<00:00, 19.63it/s] 82%|████████▏ | 9/11 [00:00<00:00, 44.68it/s]100%|██████████| 11/11 [00:01<00:00,  6.25it/s]
2025-03-09 10:35:38,842 [INFO]: 	Computing best hyperparameters for index knn.index 03/09/2025, 10:35:38
2025-03-09 10:36:01,981 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 23.1386 secs
2025-03-09 10:36:01,981 [INFO]: The best hyperparameters are: efSearch=290
2025-03-09 10:36:01,981 [INFO]: 	Compute fast metrics 03/09/2025, 10:36:01
  0%|          | 0/4 [00:00<?, ?it/s] 25%|██▌       | 1/4 [00:00<00:00,  6.91it/s] 75%|███████▌  | 3/4 [00:00<00:00, 10.96it/s] 75%|███████▌  | 3/4 [00:00<00:00,  8.44it/s]
2025-03-09 10:36:15,401 [INFO]: 	>>> Finished "Compute fast metrics" in 13.4203 secs
2025-03-09 10:36:15,403 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 38.3257 secs
2025-03-09 10:36:15,403 [INFO]: {
2025-03-09 10:36:15,403 [INFO]: 	index_key: HNSW15
2025-03-09 10:36:15,403 [INFO]: 	index_param: efSearch=290
2025-03-09 10:36:15,403 [INFO]: 	index_path: knn.index
2025-03-09 10:36:15,403 [INFO]: 	size in bytes: 510156850
2025-03-09 10:36:15,403 [INFO]: 	avg_search_speed_ms: 9.397132077107305
2025-03-09 10:36:15,403 [INFO]: 	99p_search_speed_ms: 12.38415324827656
2025-03-09 10:36:15,403 [INFO]: 	reconstruction error %: 0.0
2025-03-09 10:36:15,403 [INFO]: 	nb vectors: 2593
2025-03-09 10:36:15,403 [INFO]: 	vectors dimension: 49152
2025-03-09 10:36:15,403 [INFO]: 	compression ratio: 0.9993094163099054
2025-03-09 10:36:15,403 [INFO]: }
2025-03-09 10:36:15,403 [INFO]: 	>>> Finished "Creating the index" in 38.3294 secs
2025-03-09 10:36:15,403 [INFO]: >>> Finished "Launching the whole pipeline" in 38.3609 secs
2025-03-09 10:36:16: [retrieval_preprocessing] calculating distances ...
2025-03-09 10:36:16: [retrieval_preprocessing] finished and saved retrieval indices for episode 6181 [episode count 5/20]
[retrieval_preprocessing] for episode 72753 [episode count 6/20], we have num_retrieval=np.int64(2548) num_query=np.int64(169)
2025-03-09 10:36:16,818 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-09 10:36:17,105 [INFO]: Launching the whole pipeline 03/09/2025, 10:36:17
2025-03-09 10:36:17,105 [INFO]: Reading total number of vectors and dimension 03/09/2025, 10:36:17
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 2277.04it/s]
2025-03-09 10:36:17,128 [INFO]: There are 2548 embeddings of dim 49152
2025-03-09 10:36:17,129 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0237 secs
2025-03-09 10:36:17,129 [INFO]: 	Compute estimated construction time of the index 03/09/2025, 10:36:17
2025-03-09 10:36:17,129 [INFO]: 		-> Train: 16.7 minutes
2025-03-09 10:36:17,129 [INFO]: 		-> Add: 1.4 seconds
2025-03-09 10:36:17,129 [INFO]: 		Total: 16.7 minutes
2025-03-09 10:36:17,129 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0001 secs
2025-03-09 10:36:17,129 [INFO]: 	Checking that your have enough memory available to create the index 03/09/2025, 10:36:17
2025-03-09 10:36:17,129 [INFO]: 525.8MB of memory will be needed to build the index (more might be used if you have more)
2025-03-09 10:36:17,129 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0001 secs
2025-03-09 10:36:17,129 [INFO]: 	Selecting most promising index types given data characteristics 03/09/2025, 10:36:17
2025-03-09 10:36:17,129 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-09 10:36:17,129 [INFO]: 	Creating the index 03/09/2025, 10:36:17
2025-03-09 10:36:17,129 [INFO]: 		-> Instanciate the index HNSW15 03/09/2025, 10:36:17
2025-03-09 10:36:17,130 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0010 secs
2025-03-09 10:36:17,130 [INFO]: 		-> Adding the vectors to the index 03/09/2025, 10:36:17
2025-03-09 10:36:17,130 [INFO]: The memory available for adding the vectors is 49.5GB(total available - used by the index)
2025-03-09 10:36:17,130 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/11 [00:00<?, ?it/s] 27%|██▋       | 3/11 [00:00<00:00, 28.20it/s] 91%|█████████ | 10/11 [00:00<00:00, 50.92it/s]100%|██████████| 11/11 [00:01<00:00,  6.67it/s]
2025-03-09 10:36:18,781 [INFO]: 	Computing best hyperparameters for index knn.index 03/09/2025, 10:36:18
2025-03-09 10:36:42,669 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 23.8879 secs
2025-03-09 10:36:42,670 [INFO]: The best hyperparameters are: efSearch=285
2025-03-09 10:36:42,670 [INFO]: 	Compute fast metrics 03/09/2025, 10:36:42
  0%|          | 0/4 [00:00<?, ?it/s] 25%|██▌       | 1/4 [00:00<00:00,  7.20it/s] 75%|███████▌  | 3/4 [00:00<00:00, 11.54it/s] 75%|███████▌  | 3/4 [00:00<00:00,  8.69it/s]
2025-03-09 10:36:55,694 [INFO]: 	>>> Finished "Compute fast metrics" in 13.0241 secs
2025-03-09 10:36:55,695 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 38.5650 secs
2025-03-09 10:36:55,695 [INFO]: {
2025-03-09 10:36:55,695 [INFO]: 	index_key: HNSW15
2025-03-09 10:36:55,695 [INFO]: 	index_param: efSearch=285
2025-03-09 10:36:55,695 [INFO]: 	index_path: knn.index
2025-03-09 10:36:55,695 [INFO]: 	size in bytes: 501303310
2025-03-09 10:36:55,695 [INFO]: 	avg_search_speed_ms: 9.811493099719227
2025-03-09 10:36:55,695 [INFO]: 	99p_search_speed_ms: 12.334226970560849
2025-03-09 10:36:55,696 [INFO]: 	reconstruction error %: 0.0
2025-03-09 10:36:55,696 [INFO]: 	nb vectors: 2548
2025-03-09 10:36:55,696 [INFO]: 	vectors dimension: 49152
2025-03-09 10:36:55,696 [INFO]: 	compression ratio: 0.9993095477466526
2025-03-09 10:36:55,696 [INFO]: }
2025-03-09 10:36:55,696 [INFO]: 	>>> Finished "Creating the index" in 38.5665 secs
2025-03-09 10:36:55,696 [INFO]: >>> Finished "Launching the whole pipeline" in 38.5906 secs
2025-03-09 10:36:56: [retrieval_preprocessing] calculating distances ...
2025-03-09 10:36:57: [retrieval_preprocessing] finished and saved retrieval indices for episode 72753 [episode count 6/20]
[retrieval_preprocessing] for episode 19506 [episode count 7/20], we have num_retrieval=np.int64(2564) num_query=np.int64(153)
2025-03-09 10:36:57,326 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-09 10:36:57,620 [INFO]: Launching the whole pipeline 03/09/2025, 10:36:57
2025-03-09 10:36:57,620 [INFO]: Reading total number of vectors and dimension 03/09/2025, 10:36:57
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 2281.99it/s]
2025-03-09 10:36:57,643 [INFO]: There are 2564 embeddings of dim 49152
2025-03-09 10:36:57,643 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0230 secs
2025-03-09 10:36:57,644 [INFO]: 	Compute estimated construction time of the index 03/09/2025, 10:36:57
2025-03-09 10:36:57,644 [INFO]: 		-> Train: 16.7 minutes
2025-03-09 10:36:57,644 [INFO]: 		-> Add: 1.4 seconds
2025-03-09 10:36:57,644 [INFO]: 		Total: 16.7 minutes
2025-03-09 10:36:57,644 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0001 secs
2025-03-09 10:36:57,644 [INFO]: 	Checking that your have enough memory available to create the index 03/09/2025, 10:36:57
2025-03-09 10:36:57,644 [INFO]: 529.1MB of memory will be needed to build the index (more might be used if you have more)
2025-03-09 10:36:57,644 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0001 secs
2025-03-09 10:36:57,644 [INFO]: 	Selecting most promising index types given data characteristics 03/09/2025, 10:36:57
2025-03-09 10:36:57,644 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-09 10:36:57,644 [INFO]: 	Creating the index 03/09/2025, 10:36:57
2025-03-09 10:36:57,644 [INFO]: 		-> Instanciate the index HNSW15 03/09/2025, 10:36:57
2025-03-09 10:36:57,645 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0009 secs
2025-03-09 10:36:57,645 [INFO]: 		-> Adding the vectors to the index 03/09/2025, 10:36:57
2025-03-09 10:36:57,645 [INFO]: The memory available for adding the vectors is 49.5GB(total available - used by the index)
2025-03-09 10:36:57,645 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/11 [00:00<?, ?it/s]  9%|▉         | 1/11 [00:00<00:01,  9.21it/s] 64%|██████▎   | 7/11 [00:00<00:00, 35.78it/s]100%|██████████| 11/11 [00:01<00:00,  5.13it/s]100%|██████████| 11/11 [00:01<00:00,  6.17it/s]
2025-03-09 10:36:59,432 [INFO]: 	Computing best hyperparameters for index knn.index 03/09/2025, 10:36:59
2025-03-09 10:37:23,420 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 23.9876 secs
2025-03-09 10:37:23,420 [INFO]: The best hyperparameters are: efSearch=271
2025-03-09 10:37:23,420 [INFO]: 	Compute fast metrics 03/09/2025, 10:37:23
  0%|          | 0/4 [00:00<?, ?it/s] 50%|█████     | 2/4 [00:00<00:00, 18.18it/s] 75%|███████▌  | 3/4 [00:00<00:00, 21.19it/s]
2025-03-09 10:37:36,190 [INFO]: 	>>> Finished "Compute fast metrics" in 12.7694 secs
2025-03-09 10:37:36,191 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 38.5462 secs
2025-03-09 10:37:36,191 [INFO]: {
2025-03-09 10:37:36,191 [INFO]: 	index_key: HNSW15
2025-03-09 10:37:36,191 [INFO]: 	index_param: efSearch=271
2025-03-09 10:37:36,191 [INFO]: 	index_path: knn.index
2025-03-09 10:37:36,191 [INFO]: 	size in bytes: 504451150
2025-03-09 10:37:36,191 [INFO]: 	avg_search_speed_ms: 9.468670085576983
2025-03-09 10:37:36,191 [INFO]: 	99p_search_speed_ms: 14.028330508153891
2025-03-09 10:37:36,191 [INFO]: 	reconstruction error %: 0.0
2025-03-09 10:37:36,191 [INFO]: 	nb vectors: 2564
2025-03-09 10:37:36,191 [INFO]: 	vectors dimension: 49152
2025-03-09 10:37:36,191 [INFO]: 	compression ratio: 0.9993096695289524
2025-03-09 10:37:36,191 [INFO]: }
2025-03-09 10:37:36,191 [INFO]: 	>>> Finished "Creating the index" in 38.5475 secs
2025-03-09 10:37:36,192 [INFO]: >>> Finished "Launching the whole pipeline" in 38.5710 secs
2025-03-09 10:37:37: [retrieval_preprocessing] calculating distances ...
2025-03-09 10:37:37: [retrieval_preprocessing] finished and saved retrieval indices for episode 19506 [episode count 7/20]
[retrieval_preprocessing] for episode 21043 [episode count 8/20], we have num_retrieval=np.int64(2595) num_query=np.int64(122)
2025-03-09 10:37:37,696 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-09 10:37:37,986 [INFO]: Launching the whole pipeline 03/09/2025, 10:37:37
2025-03-09 10:37:37,986 [INFO]: Reading total number of vectors and dimension 03/09/2025, 10:37:37
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1995.39it/s]
2025-03-09 10:37:38,010 [INFO]: There are 2595 embeddings of dim 49152
2025-03-09 10:37:38,010 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0245 secs
2025-03-09 10:37:38,010 [INFO]: 	Compute estimated construction time of the index 03/09/2025, 10:37:38
2025-03-09 10:37:38,010 [INFO]: 		-> Train: 16.7 minutes
2025-03-09 10:37:38,010 [INFO]: 		-> Add: 1.4 seconds
2025-03-09 10:37:38,010 [INFO]: 		Total: 16.7 minutes
2025-03-09 10:37:38,010 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0001 secs
2025-03-09 10:37:38,010 [INFO]: 	Checking that your have enough memory available to create the index 03/09/2025, 10:37:38
2025-03-09 10:37:38,011 [INFO]: 535.5MB of memory will be needed to build the index (more might be used if you have more)
2025-03-09 10:37:38,011 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0001 secs
2025-03-09 10:37:38,011 [INFO]: 	Selecting most promising index types given data characteristics 03/09/2025, 10:37:38
2025-03-09 10:37:38,011 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-09 10:37:38,011 [INFO]: 	Creating the index 03/09/2025, 10:37:38
2025-03-09 10:37:38,011 [INFO]: 		-> Instanciate the index HNSW15 03/09/2025, 10:37:38
2025-03-09 10:37:38,012 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0012 secs
2025-03-09 10:37:38,012 [INFO]: 		-> Adding the vectors to the index 03/09/2025, 10:37:38
2025-03-09 10:37:38,012 [INFO]: The memory available for adding the vectors is 49.5GB(total available - used by the index)
2025-03-09 10:37:38,012 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/11 [00:00<?, ?it/s] 18%|█▊        | 2/11 [00:00<00:00, 18.15it/s] 82%|████████▏ | 9/11 [00:00<00:00, 46.20it/s]100%|██████████| 11/11 [00:01<00:00,  6.77it/s]
2025-03-09 10:37:39,641 [INFO]: 	Computing best hyperparameters for index knn.index 03/09/2025, 10:37:39
2025-03-09 10:38:02,443 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 22.8017 secs
2025-03-09 10:38:02,443 [INFO]: The best hyperparameters are: efSearch=275
2025-03-09 10:38:02,443 [INFO]: 	Compute fast metrics 03/09/2025, 10:38:02
  0%|          | 0/4 [00:00<?, ?it/s] 25%|██▌       | 1/4 [00:00<00:00,  6.25it/s] 50%|█████     | 2/4 [00:00<00:00,  7.68it/s] 75%|███████▌  | 3/4 [00:00<00:00,  8.32it/s] 75%|███████▌  | 3/4 [00:00<00:00,  6.14it/s]
2025-03-09 10:38:15,807 [INFO]: 	>>> Finished "Compute fast metrics" in 13.3631 secs
2025-03-09 10:38:15,808 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 37.7958 secs
2025-03-09 10:38:15,808 [INFO]: {
2025-03-09 10:38:15,808 [INFO]: 	index_key: HNSW15
2025-03-09 10:38:15,808 [INFO]: 	index_param: efSearch=275
2025-03-09 10:38:15,808 [INFO]: 	index_path: knn.index
2025-03-09 10:38:15,808 [INFO]: 	size in bytes: 510550330
2025-03-09 10:38:15,808 [INFO]: 	avg_search_speed_ms: 9.119670938720812
2025-03-09 10:38:15,808 [INFO]: 	99p_search_speed_ms: 13.17253805696964
2025-03-09 10:38:15,808 [INFO]: 	reconstruction error %: 0.0
2025-03-09 10:38:15,808 [INFO]: 	nb vectors: 2595
2025-03-09 10:38:15,808 [INFO]: 	vectors dimension: 49152
2025-03-09 10:38:15,808 [INFO]: 	compression ratio: 0.9993094314521352
2025-03-09 10:38:15,808 [INFO]: }
2025-03-09 10:38:15,808 [INFO]: 	>>> Finished "Creating the index" in 37.7976 secs
2025-03-09 10:38:15,808 [INFO]: >>> Finished "Launching the whole pipeline" in 37.8227 secs
2025-03-09 10:38:16: [retrieval_preprocessing] calculating distances ...
2025-03-09 10:38:16: [retrieval_preprocessing] finished and saved retrieval indices for episode 21043 [episode count 8/20]
[retrieval_preprocessing] for episode 41010 [episode count 9/20], we have num_retrieval=np.int64(2578) num_query=np.int64(139)
2025-03-09 10:38:17,272 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-09 10:38:17,585 [INFO]: Launching the whole pipeline 03/09/2025, 10:38:17
2025-03-09 10:38:17,585 [INFO]: Reading total number of vectors and dimension 03/09/2025, 10:38:17
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 997.93it/s]
2025-03-09 10:38:17,614 [INFO]: There are 2578 embeddings of dim 49152
2025-03-09 10:38:17,614 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0289 secs
2025-03-09 10:38:17,614 [INFO]: 	Compute estimated construction time of the index 03/09/2025, 10:38:17
2025-03-09 10:38:17,614 [INFO]: 		-> Train: 16.7 minutes
2025-03-09 10:38:17,614 [INFO]: 		-> Add: 1.4 seconds
2025-03-09 10:38:17,615 [INFO]: 		Total: 16.7 minutes
2025-03-09 10:38:17,615 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0004 secs
2025-03-09 10:38:17,615 [INFO]: 	Checking that your have enough memory available to create the index 03/09/2025, 10:38:17
2025-03-09 10:38:17,615 [INFO]: 532.0MB of memory will be needed to build the index (more might be used if you have more)
2025-03-09 10:38:17,615 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0005 secs
2025-03-09 10:38:17,615 [INFO]: 	Selecting most promising index types given data characteristics 03/09/2025, 10:38:17
2025-03-09 10:38:17,615 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-09 10:38:17,616 [INFO]: 	Creating the index 03/09/2025, 10:38:17
2025-03-09 10:38:17,616 [INFO]: 		-> Instanciate the index HNSW15 03/09/2025, 10:38:17
2025-03-09 10:38:17,619 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0028 secs
2025-03-09 10:38:17,619 [INFO]: 		-> Adding the vectors to the index 03/09/2025, 10:38:17
2025-03-09 10:38:17,619 [INFO]: The memory available for adding the vectors is 49.5GB(total available - used by the index)
2025-03-09 10:38:17,619 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/11 [00:00<?, ?it/s] 27%|██▋       | 3/11 [00:00<00:00, 26.96it/s] 82%|████████▏ | 9/11 [00:00<00:00, 44.56it/s]100%|██████████| 11/11 [00:01<00:00,  6.68it/s]
2025-03-09 10:38:19,272 [INFO]: 	Computing best hyperparameters for index knn.index 03/09/2025, 10:38:19
2025-03-09 10:38:43,156 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 23.8834 secs
2025-03-09 10:38:43,156 [INFO]: The best hyperparameters are: efSearch=292
2025-03-09 10:38:43,156 [INFO]: 	Compute fast metrics 03/09/2025, 10:38:43
  0%|          | 0/4 [00:00<?, ?it/s] 75%|███████▌  | 3/4 [00:00<00:00, 27.61it/s] 75%|███████▌  | 3/4 [00:00<00:00, 24.35it/s]
2025-03-09 10:38:55,625 [INFO]: 	>>> Finished "Compute fast metrics" in 12.4692 secs
2025-03-09 10:38:55,627 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 38.0078 secs
2025-03-09 10:38:55,627 [INFO]: {
2025-03-09 10:38:55,627 [INFO]: 	index_key: HNSW15
2025-03-09 10:38:55,627 [INFO]: 	index_param: efSearch=292
2025-03-09 10:38:55,627 [INFO]: 	index_path: knn.index
2025-03-09 10:38:55,627 [INFO]: 	size in bytes: 507205690
2025-03-09 10:38:55,627 [INFO]: 	avg_search_speed_ms: 9.766637381972032
2025-03-09 10:38:55,627 [INFO]: 	99p_search_speed_ms: 13.975819102488456
2025-03-09 10:38:55,627 [INFO]: 	reconstruction error %: 0.0
2025-03-09 10:38:55,627 [INFO]: 	nb vectors: 2578
2025-03-09 10:38:55,627 [INFO]: 	vectors dimension: 49152
2025-03-09 10:38:55,627 [INFO]: 	compression ratio: 0.9993094202078057
2025-03-09 10:38:55,627 [INFO]: }
2025-03-09 10:38:55,627 [INFO]: 	>>> Finished "Creating the index" in 38.0114 secs
2025-03-09 10:38:55,627 [INFO]: >>> Finished "Launching the whole pipeline" in 38.0420 secs
2025-03-09 10:38:56: [retrieval_preprocessing] calculating distances ...
2025-03-09 10:38:57: [retrieval_preprocessing] finished and saved retrieval indices for episode 41010 [episode count 9/20]
[retrieval_preprocessing] for episode 72754 [episode count 10/20], we have num_retrieval=np.int64(2614) num_query=np.int64(103)
2025-03-09 10:38:57,200 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-09 10:38:57,509 [INFO]: Launching the whole pipeline 03/09/2025, 10:38:57
2025-03-09 10:38:57,509 [INFO]: Reading total number of vectors and dimension 03/09/2025, 10:38:57
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1551.15it/s]
2025-03-09 10:38:57,534 [INFO]: There are 2614 embeddings of dim 49152
2025-03-09 10:38:57,534 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0253 secs
2025-03-09 10:38:57,534 [INFO]: 	Compute estimated construction time of the index 03/09/2025, 10:38:57
2025-03-09 10:38:57,534 [INFO]: 		-> Train: 16.7 minutes
2025-03-09 10:38:57,534 [INFO]: 		-> Add: 1.4 seconds
2025-03-09 10:38:57,534 [INFO]: 		Total: 16.7 minutes
2025-03-09 10:38:57,534 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0001 secs
2025-03-09 10:38:57,535 [INFO]: 	Checking that your have enough memory available to create the index 03/09/2025, 10:38:57
2025-03-09 10:38:57,535 [INFO]: 539.5MB of memory will be needed to build the index (more might be used if you have more)
2025-03-09 10:38:57,535 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0001 secs
2025-03-09 10:38:57,535 [INFO]: 	Selecting most promising index types given data characteristics 03/09/2025, 10:38:57
2025-03-09 10:38:57,535 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-09 10:38:57,535 [INFO]: 	Creating the index 03/09/2025, 10:38:57
2025-03-09 10:38:57,535 [INFO]: 		-> Instanciate the index HNSW15 03/09/2025, 10:38:57
2025-03-09 10:38:57,536 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0012 secs
2025-03-09 10:38:57,536 [INFO]: 		-> Adding the vectors to the index 03/09/2025, 10:38:57
2025-03-09 10:38:57,536 [INFO]: The memory available for adding the vectors is 49.5GB(total available - used by the index)
2025-03-09 10:38:57,536 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/11 [00:00<?, ?it/s] 18%|█▊        | 2/11 [00:00<00:00, 17.77it/s] 82%|████████▏ | 9/11 [00:00<00:00, 43.85it/s]100%|██████████| 11/11 [00:01<00:00,  6.47it/s]
2025-03-09 10:38:59,238 [INFO]: 	Computing best hyperparameters for index knn.index 03/09/2025, 10:38:59
2025-03-09 10:39:24,710 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 25.4715 secs
2025-03-09 10:39:24,711 [INFO]: The best hyperparameters are: efSearch=291
2025-03-09 10:39:24,711 [INFO]: 	Compute fast metrics 03/09/2025, 10:39:24
  0%|          | 0/4 [00:00<?, ?it/s] 75%|███████▌  | 3/4 [00:00<00:00, 26.56it/s] 75%|███████▌  | 3/4 [00:00<00:00, 23.01it/s]
2025-03-09 10:39:38,615 [INFO]: 	>>> Finished "Compute fast metrics" in 13.9047 secs
2025-03-09 10:39:38,617 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 41.0808 secs
2025-03-09 10:39:38,617 [INFO]: {
2025-03-09 10:39:38,617 [INFO]: 	index_key: HNSW15
2025-03-09 10:39:38,617 [INFO]: 	index_param: efSearch=291
2025-03-09 10:39:38,617 [INFO]: 	index_path: knn.index
2025-03-09 10:39:38,617 [INFO]: 	size in bytes: 514288510
2025-03-09 10:39:38,617 [INFO]: 	avg_search_speed_ms: 10.861281643295003
2025-03-09 10:39:38,617 [INFO]: 	99p_search_speed_ms: 14.492083340883255
2025-03-09 10:39:38,617 [INFO]: 	reconstruction error %: 0.0
2025-03-09 10:39:38,617 [INFO]: 	nb vectors: 2614
2025-03-09 10:39:38,617 [INFO]: 	vectors dimension: 49152
2025-03-09 10:39:38,617 [INFO]: 	compression ratio: 0.9993093409767214
2025-03-09 10:39:38,617 [INFO]: }
2025-03-09 10:39:38,617 [INFO]: 	>>> Finished "Creating the index" in 41.0825 secs
2025-03-09 10:39:38,617 [INFO]: >>> Finished "Launching the whole pipeline" in 41.1085 secs
2025-03-09 10:39:39: [retrieval_preprocessing] calculating distances ...
2025-03-09 10:39:39: [retrieval_preprocessing] finished and saved retrieval indices for episode 72754 [episode count 10/20]
[retrieval_preprocessing] for episode 92725 [episode count 11/20], we have num_retrieval=np.int64(2602) num_query=np.int64(115)
2025-03-09 10:39:40,108 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-09 10:39:40,413 [INFO]: Launching the whole pipeline 03/09/2025, 10:39:40
2025-03-09 10:39:40,413 [INFO]: Reading total number of vectors and dimension 03/09/2025, 10:39:40
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1504.95it/s]
2025-03-09 10:39:40,439 [INFO]: There are 2602 embeddings of dim 49152
2025-03-09 10:39:40,439 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0263 secs
2025-03-09 10:39:40,439 [INFO]: 	Compute estimated construction time of the index 03/09/2025, 10:39:40
2025-03-09 10:39:40,439 [INFO]: 		-> Train: 16.7 minutes
2025-03-09 10:39:40,439 [INFO]: 		-> Add: 1.4 seconds
2025-03-09 10:39:40,440 [INFO]: 		Total: 16.7 minutes
2025-03-09 10:39:40,440 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0001 secs
2025-03-09 10:39:40,440 [INFO]: 	Checking that your have enough memory available to create the index 03/09/2025, 10:39:40
2025-03-09 10:39:40,440 [INFO]: 537.0MB of memory will be needed to build the index (more might be used if you have more)
2025-03-09 10:39:40,440 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0002 secs
2025-03-09 10:39:40,440 [INFO]: 	Selecting most promising index types given data characteristics 03/09/2025, 10:39:40
2025-03-09 10:39:40,440 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-09 10:39:40,440 [INFO]: 	Creating the index 03/09/2025, 10:39:40
2025-03-09 10:39:40,440 [INFO]: 		-> Instanciate the index HNSW15 03/09/2025, 10:39:40
2025-03-09 10:39:40,441 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0011 secs
2025-03-09 10:39:40,441 [INFO]: 		-> Adding the vectors to the index 03/09/2025, 10:39:40
2025-03-09 10:39:40,441 [INFO]: The memory available for adding the vectors is 49.5GB(total available - used by the index)
2025-03-09 10:39:40,441 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/11 [00:00<?, ?it/s]  9%|▉         | 1/11 [00:00<00:01,  8.30it/s] 55%|█████▍    | 6/11 [00:00<00:00, 29.19it/s]100%|██████████| 11/11 [00:01<00:00,  4.80it/s]100%|██████████| 11/11 [00:01<00:00,  5.58it/s]
2025-03-09 10:39:42,414 [INFO]: 	Computing best hyperparameters for index knn.index 03/09/2025, 10:39:42
2025-03-09 10:40:06,550 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 24.1353 secs
2025-03-09 10:40:06,550 [INFO]: The best hyperparameters are: efSearch=212
2025-03-09 10:40:06,550 [INFO]: 	Compute fast metrics 03/09/2025, 10:40:06
  0%|          | 0/4 [00:00<?, ?it/s] 25%|██▌       | 1/4 [00:00<00:00,  8.82it/s] 75%|███████▌  | 3/4 [00:00<00:00,  9.79it/s] 75%|███████▌  | 3/4 [00:00<00:00,  7.40it/s]
2025-03-09 10:40:20,238 [INFO]: 	>>> Finished "Compute fast metrics" in 13.6881 secs
2025-03-09 10:40:20,240 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 39.7986 secs
2025-03-09 10:40:20,240 [INFO]: {
2025-03-09 10:40:20,240 [INFO]: 	index_key: HNSW15
2025-03-09 10:40:20,240 [INFO]: 	index_param: efSearch=212
2025-03-09 10:40:20,240 [INFO]: 	index_path: knn.index
2025-03-09 10:40:20,240 [INFO]: 	size in bytes: 511927510
2025-03-09 10:40:20,240 [INFO]: 	avg_search_speed_ms: 8.080859985895207
2025-03-09 10:40:20,240 [INFO]: 	99p_search_speed_ms: 11.102785337716348
2025-03-09 10:40:20,240 [INFO]: 	reconstruction error %: 0.0
2025-03-09 10:40:20,240 [INFO]: 	nb vectors: 2602
2025-03-09 10:40:20,240 [INFO]: 	vectors dimension: 49152
2025-03-09 10:40:20,240 [INFO]: 	compression ratio: 0.9993094842666299
2025-03-09 10:40:20,240 [INFO]: }
2025-03-09 10:40:20,240 [INFO]: 	>>> Finished "Creating the index" in 39.8002 secs
2025-03-09 10:40:20,240 [INFO]: >>> Finished "Launching the whole pipeline" in 39.8273 secs
2025-03-09 10:40:20: [retrieval_preprocessing] calculating distances ...
2025-03-09 10:40:20: [retrieval_preprocessing] finished and saved retrieval indices for episode 92725 [episode count 11/20]
[retrieval_preprocessing] for episode 85057 [episode count 12/20], we have num_retrieval=np.int64(2648) num_query=np.int64(69)
2025-03-09 10:40:21,068 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-09 10:40:21,367 [INFO]: Launching the whole pipeline 03/09/2025, 10:40:21
2025-03-09 10:40:21,367 [INFO]: Reading total number of vectors and dimension 03/09/2025, 10:40:21
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 2206.37it/s]
2025-03-09 10:40:21,391 [INFO]: There are 2648 embeddings of dim 49152
2025-03-09 10:40:21,391 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0239 secs
2025-03-09 10:40:21,391 [INFO]: 	Compute estimated construction time of the index 03/09/2025, 10:40:21
2025-03-09 10:40:21,391 [INFO]: 		-> Train: 16.7 minutes
2025-03-09 10:40:21,391 [INFO]: 		-> Add: 1.5 seconds
2025-03-09 10:40:21,391 [INFO]: 		Total: 16.7 minutes
2025-03-09 10:40:21,391 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0001 secs
2025-03-09 10:40:21,391 [INFO]: 	Checking that your have enough memory available to create the index 03/09/2025, 10:40:21
2025-03-09 10:40:21,391 [INFO]: 546.5MB of memory will be needed to build the index (more might be used if you have more)
2025-03-09 10:40:21,392 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0002 secs
2025-03-09 10:40:21,392 [INFO]: 	Selecting most promising index types given data characteristics 03/09/2025, 10:40:21
2025-03-09 10:40:21,392 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-09 10:40:21,392 [INFO]: 	Creating the index 03/09/2025, 10:40:21
2025-03-09 10:40:21,392 [INFO]: 		-> Instanciate the index HNSW15 03/09/2025, 10:40:21
2025-03-09 10:40:21,393 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0010 secs
2025-03-09 10:40:21,393 [INFO]: 		-> Adding the vectors to the index 03/09/2025, 10:40:21
2025-03-09 10:40:21,393 [INFO]: The memory available for adding the vectors is 49.5GB(total available - used by the index)
2025-03-09 10:40:21,393 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/11 [00:00<?, ?it/s] 27%|██▋       | 3/11 [00:00<00:00, 27.17it/s] 91%|█████████ | 10/11 [00:00<00:00, 50.61it/s]100%|██████████| 11/11 [00:01<00:00,  6.05it/s]
2025-03-09 10:40:23,213 [INFO]: 	Computing best hyperparameters for index knn.index 03/09/2025, 10:40:23
2025-03-09 10:40:48,173 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 24.9595 secs
2025-03-09 10:40:48,173 [INFO]: The best hyperparameters are: efSearch=295
2025-03-09 10:40:48,173 [INFO]: 	Compute fast metrics 03/09/2025, 10:40:48
  0%|          | 0/4 [00:00<?, ?it/s] 25%|██▌       | 1/4 [00:00<00:00,  7.00it/s] 75%|███████▌  | 3/4 [00:00<00:00, 10.48it/s]
2025-03-09 10:41:01,208 [INFO]: 	>>> Finished "Compute fast metrics" in 13.0346 secs
2025-03-09 10:41:01,209 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 39.8164 secs
2025-03-09 10:41:01,209 [INFO]: {
2025-03-09 10:41:01,209 [INFO]: 	index_key: HNSW15
2025-03-09 10:41:01,209 [INFO]: 	index_param: efSearch=295
2025-03-09 10:41:01,209 [INFO]: 	index_path: knn.index
2025-03-09 10:41:01,209 [INFO]: 	size in bytes: 520977730
2025-03-09 10:41:01,209 [INFO]: 	avg_search_speed_ms: 9.525744316744662
2025-03-09 10:41:01,209 [INFO]: 	99p_search_speed_ms: 12.98642641166225
2025-03-09 10:41:01,209 [INFO]: 	reconstruction error %: 0.0
2025-03-09 10:41:01,209 [INFO]: 	nb vectors: 2648
2025-03-09 10:41:01,210 [INFO]: 	vectors dimension: 49152
2025-03-09 10:41:01,210 [INFO]: 	compression ratio: 0.9993094791211133
2025-03-09 10:41:01,210 [INFO]: }
2025-03-09 10:41:01,210 [INFO]: 	>>> Finished "Creating the index" in 39.8179 secs
2025-03-09 10:41:01,210 [INFO]: >>> Finished "Launching the whole pipeline" in 39.8424 secs
2025-03-09 10:41:01: [retrieval_preprocessing] calculating distances ...
2025-03-09 10:41:02: [retrieval_preprocessing] finished and saved retrieval indices for episode 85057 [episode count 12/20]
[retrieval_preprocessing] for episode 36933 [episode count 13/20], we have num_retrieval=np.int64(2538) num_query=np.int64(179)
2025-03-09 10:41:02,244 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-09 10:41:02,547 [INFO]: Launching the whole pipeline 03/09/2025, 10:41:02
2025-03-09 10:41:02,547 [INFO]: Reading total number of vectors and dimension 03/09/2025, 10:41:02
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 2114.06it/s]
2025-03-09 10:41:02,573 [INFO]: There are 2538 embeddings of dim 49152
2025-03-09 10:41:02,574 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0264 secs
2025-03-09 10:41:02,574 [INFO]: 	Compute estimated construction time of the index 03/09/2025, 10:41:02
2025-03-09 10:41:02,574 [INFO]: 		-> Train: 16.7 minutes
2025-03-09 10:41:02,574 [INFO]: 		-> Add: 1.4 seconds
2025-03-09 10:41:02,574 [INFO]: 		Total: 16.7 minutes
2025-03-09 10:41:02,574 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0001 secs
2025-03-09 10:41:02,574 [INFO]: 	Checking that your have enough memory available to create the index 03/09/2025, 10:41:02
2025-03-09 10:41:02,574 [INFO]: 523.8MB of memory will be needed to build the index (more might be used if you have more)
2025-03-09 10:41:02,574 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0002 secs
2025-03-09 10:41:02,574 [INFO]: 	Selecting most promising index types given data characteristics 03/09/2025, 10:41:02
2025-03-09 10:41:02,574 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-09 10:41:02,574 [INFO]: 	Creating the index 03/09/2025, 10:41:02
2025-03-09 10:41:02,574 [INFO]: 		-> Instanciate the index HNSW15 03/09/2025, 10:41:02
2025-03-09 10:41:02,576 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0011 secs
2025-03-09 10:41:02,576 [INFO]: 		-> Adding the vectors to the index 03/09/2025, 10:41:02
2025-03-09 10:41:02,576 [INFO]: The memory available for adding the vectors is 49.5GB(total available - used by the index)
2025-03-09 10:41:02,576 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/10 [00:00<?, ?it/s] 10%|█         | 1/10 [00:00<00:01,  7.01it/s] 30%|███       | 3/10 [00:00<00:00, 12.29it/s] 70%|███████   | 7/10 [00:00<00:00, 22.83it/s]100%|██████████| 10/10 [00:02<00:00,  3.62it/s]100%|██████████| 10/10 [00:02<00:00,  4.63it/s]
2025-03-09 10:41:04,738 [INFO]: 	Computing best hyperparameters for index knn.index 03/09/2025, 10:41:04
2025-03-09 10:41:28,870 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 24.1316 secs
2025-03-09 10:41:28,870 [INFO]: The best hyperparameters are: efSearch=276
2025-03-09 10:41:28,870 [INFO]: 	Compute fast metrics 03/09/2025, 10:41:28
  0%|          | 0/4 [00:00<?, ?it/s] 25%|██▌       | 1/4 [00:00<00:00,  7.40it/s] 75%|███████▌  | 3/4 [00:00<00:00, 12.71it/s] 75%|███████▌  | 3/4 [00:00<00:00,  9.21it/s]
2025-03-09 10:41:42,112 [INFO]: 	>>> Finished "Compute fast metrics" in 13.2416 secs
2025-03-09 10:41:42,113 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 39.5371 secs
2025-03-09 10:41:42,113 [INFO]: {
2025-03-09 10:41:42,113 [INFO]: 	index_key: HNSW15
2025-03-09 10:41:42,113 [INFO]: 	index_param: efSearch=276
2025-03-09 10:41:42,113 [INFO]: 	index_path: knn.index
2025-03-09 10:41:42,113 [INFO]: 	size in bytes: 499335790
2025-03-09 10:41:42,113 [INFO]: 	avg_search_speed_ms: 9.512257070185795
2025-03-09 10:41:42,113 [INFO]: 	99p_search_speed_ms: 12.609067489393055
2025-03-09 10:41:42,113 [INFO]: 	reconstruction error %: 0.0
2025-03-09 10:41:42,113 [INFO]: 	nb vectors: 2538
2025-03-09 10:41:42,113 [INFO]: 	vectors dimension: 49152
2025-03-09 10:41:42,113 [INFO]: 	compression ratio: 0.999309711006295
2025-03-09 10:41:42,113 [INFO]: }
2025-03-09 10:41:42,113 [INFO]: 	>>> Finished "Creating the index" in 39.5387 secs
2025-03-09 10:41:42,113 [INFO]: >>> Finished "Launching the whole pipeline" in 39.5659 secs
2025-03-09 10:41:43: [retrieval_preprocessing] calculating distances ...
2025-03-09 10:41:43: [retrieval_preprocessing] finished and saved retrieval indices for episode 36933 [episode count 13/20]
[retrieval_preprocessing] for episode 83534 [episode count 14/20], we have num_retrieval=np.int64(2565) num_query=np.int64(152)
2025-03-09 10:41:44,150 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-09 10:41:44,446 [INFO]: Launching the whole pipeline 03/09/2025, 10:41:44
2025-03-09 10:41:44,446 [INFO]: Reading total number of vectors and dimension 03/09/2025, 10:41:44
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1910.84it/s]
2025-03-09 10:41:44,471 [INFO]: There are 2565 embeddings of dim 49152
2025-03-09 10:41:44,471 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0249 secs
2025-03-09 10:41:44,471 [INFO]: 	Compute estimated construction time of the index 03/09/2025, 10:41:44
2025-03-09 10:41:44,471 [INFO]: 		-> Train: 16.7 minutes
2025-03-09 10:41:44,471 [INFO]: 		-> Add: 1.4 seconds
2025-03-09 10:41:44,472 [INFO]: 		Total: 16.7 minutes
2025-03-09 10:41:44,472 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0001 secs
2025-03-09 10:41:44,472 [INFO]: 	Checking that your have enough memory available to create the index 03/09/2025, 10:41:44
2025-03-09 10:41:44,472 [INFO]: 529.4MB of memory will be needed to build the index (more might be used if you have more)
2025-03-09 10:41:44,472 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0001 secs
2025-03-09 10:41:44,472 [INFO]: 	Selecting most promising index types given data characteristics 03/09/2025, 10:41:44
2025-03-09 10:41:44,472 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-09 10:41:44,472 [INFO]: 	Creating the index 03/09/2025, 10:41:44
2025-03-09 10:41:44,472 [INFO]: 		-> Instanciate the index HNSW15 03/09/2025, 10:41:44
2025-03-09 10:41:44,473 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0012 secs
2025-03-09 10:41:44,473 [INFO]: 		-> Adding the vectors to the index 03/09/2025, 10:41:44
2025-03-09 10:41:44,473 [INFO]: The memory available for adding the vectors is 49.5GB(total available - used by the index)
2025-03-09 10:41:44,473 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/11 [00:00<?, ?it/s]  9%|▉         | 1/11 [00:00<00:01,  7.31it/s] 64%|██████▎   | 7/11 [00:00<00:00, 32.30it/s]100%|██████████| 11/11 [00:01<00:00,  4.91it/s]100%|██████████| 11/11 [00:01<00:00,  5.86it/s]
2025-03-09 10:41:46,352 [INFO]: 	Computing best hyperparameters for index knn.index 03/09/2025, 10:41:46
2025-03-09 10:42:10,403 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 24.0502 secs
2025-03-09 10:42:10,403 [INFO]: The best hyperparameters are: efSearch=296
2025-03-09 10:42:10,403 [INFO]: 	Compute fast metrics 03/09/2025, 10:42:10
  0%|          | 0/4 [00:00<?, ?it/s] 25%|██▌       | 1/4 [00:00<00:00,  6.64it/s] 75%|███████▌  | 3/4 [00:00<00:00, 11.24it/s] 75%|███████▌  | 3/4 [00:00<00:00,  8.57it/s]
2025-03-09 10:42:24,506 [INFO]: 	>>> Finished "Compute fast metrics" in 14.1033 secs
2025-03-09 10:42:24,508 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 40.0345 secs
2025-03-09 10:42:24,508 [INFO]: {
2025-03-09 10:42:24,508 [INFO]: 	index_key: HNSW15
2025-03-09 10:42:24,508 [INFO]: 	index_param: efSearch=296
2025-03-09 10:42:24,508 [INFO]: 	index_path: knn.index
2025-03-09 10:42:24,508 [INFO]: 	size in bytes: 504647890
2025-03-09 10:42:24,508 [INFO]: 	avg_search_speed_ms: 10.384190732831772
2025-03-09 10:42:24,508 [INFO]: 	99p_search_speed_ms: 14.568565650843084
2025-03-09 10:42:24,508 [INFO]: 	reconstruction error %: 0.0
2025-03-09 10:42:24,508 [INFO]: 	nb vectors: 2565
2025-03-09 10:42:24,508 [INFO]: 	vectors dimension: 49152
2025-03-09 10:42:24,508 [INFO]: 	compression ratio: 0.9993096770899013
2025-03-09 10:42:24,508 [INFO]: }
2025-03-09 10:42:24,508 [INFO]: 	>>> Finished "Creating the index" in 40.0361 secs
2025-03-09 10:42:24,508 [INFO]: >>> Finished "Launching the whole pipeline" in 40.0615 secs
2025-03-09 10:42:25: [retrieval_preprocessing] calculating distances ...
2025-03-09 10:42:25: [retrieval_preprocessing] finished and saved retrieval indices for episode 83534 [episode count 14/20]
[retrieval_preprocessing] for episode 20566 [episode count 15/20], we have num_retrieval=np.int64(2615) num_query=np.int64(102)
2025-03-09 10:42:26,161 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-09 10:42:26,461 [INFO]: Launching the whole pipeline 03/09/2025, 10:42:26
2025-03-09 10:42:26,461 [INFO]: Reading total number of vectors and dimension 03/09/2025, 10:42:26
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 2193.67it/s]
2025-03-09 10:42:26,487 [INFO]: There are 2615 embeddings of dim 49152
2025-03-09 10:42:26,488 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0269 secs
2025-03-09 10:42:26,488 [INFO]: 	Compute estimated construction time of the index 03/09/2025, 10:42:26
2025-03-09 10:42:26,488 [INFO]: 		-> Train: 16.7 minutes
2025-03-09 10:42:26,488 [INFO]: 		-> Add: 1.4 seconds
2025-03-09 10:42:26,488 [INFO]: 		Total: 16.7 minutes
2025-03-09 10:42:26,488 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0003 secs
2025-03-09 10:42:26,488 [INFO]: 	Checking that your have enough memory available to create the index 03/09/2025, 10:42:26
2025-03-09 10:42:26,489 [INFO]: 539.7MB of memory will be needed to build the index (more might be used if you have more)
2025-03-09 10:42:26,489 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0004 secs
2025-03-09 10:42:26,489 [INFO]: 	Selecting most promising index types given data characteristics 03/09/2025, 10:42:26
2025-03-09 10:42:26,489 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-09 10:42:26,489 [INFO]: 	Creating the index 03/09/2025, 10:42:26
2025-03-09 10:42:26,489 [INFO]: 		-> Instanciate the index HNSW15 03/09/2025, 10:42:26
2025-03-09 10:42:26,492 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0024 secs
2025-03-09 10:42:26,492 [INFO]: 		-> Adding the vectors to the index 03/09/2025, 10:42:26
2025-03-09 10:42:26,492 [INFO]: The memory available for adding the vectors is 49.5GB(total available - used by the index)
2025-03-09 10:42:26,493 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/11 [00:00<?, ?it/s]  9%|▉         | 1/11 [00:00<00:01,  6.09it/s] 45%|████▌     | 5/11 [00:00<00:00, 20.73it/s] 82%|████████▏ | 9/11 [00:00<00:00, 25.09it/s]100%|██████████| 11/11 [00:02<00:00,  4.98it/s]
2025-03-09 10:42:28,705 [INFO]: 	Computing best hyperparameters for index knn.index 03/09/2025, 10:42:28
2025-03-09 10:42:53,421 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 24.7152 secs
2025-03-09 10:42:53,421 [INFO]: The best hyperparameters are: efSearch=254
2025-03-09 10:42:53,421 [INFO]: 	Compute fast metrics 03/09/2025, 10:42:53
  0%|          | 0/4 [00:00<?, ?it/s] 25%|██▌       | 1/4 [00:00<00:00,  6.79it/s] 75%|███████▌  | 3/4 [00:00<00:00, 11.04it/s] 75%|███████▌  | 3/4 [00:00<00:00,  8.47it/s]
2025-03-09 10:43:07,172 [INFO]: 	>>> Finished "Compute fast metrics" in 13.7509 secs
2025-03-09 10:43:07,173 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 40.6810 secs
2025-03-09 10:43:07,173 [INFO]: {
2025-03-09 10:43:07,173 [INFO]: 	index_key: HNSW15
2025-03-09 10:43:07,174 [INFO]: 	index_param: efSearch=254
2025-03-09 10:43:07,174 [INFO]: 	index_path: knn.index
2025-03-09 10:43:07,174 [INFO]: 	size in bytes: 514485250
2025-03-09 10:43:07,174 [INFO]: 	avg_search_speed_ms: 8.989287986505522
2025-03-09 10:43:07,174 [INFO]: 	99p_search_speed_ms: 12.309962469153108
2025-03-09 10:43:07,174 [INFO]: 	reconstruction error %: 0.0
2025-03-09 10:43:07,174 [INFO]: 	nb vectors: 2615
2025-03-09 10:43:07,174 [INFO]: 	vectors dimension: 49152
2025-03-09 10:43:07,174 [INFO]: 	compression ratio: 0.9993093485187379
2025-03-09 10:43:07,174 [INFO]: }
2025-03-09 10:43:07,174 [INFO]: 	>>> Finished "Creating the index" in 40.6843 secs
2025-03-09 10:43:07,174 [INFO]: >>> Finished "Launching the whole pipeline" in 40.7128 secs
2025-03-09 10:43:07: [retrieval_preprocessing] calculating distances ...
2025-03-09 10:43:08: [retrieval_preprocessing] finished and saved retrieval indices for episode 20566 [episode count 15/20]
[retrieval_preprocessing] for episode 31830 [episode count 16/20], we have num_retrieval=np.int64(2559) num_query=np.int64(158)
2025-03-09 10:43:08,381 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-09 10:43:08,674 [INFO]: Launching the whole pipeline 03/09/2025, 10:43:08
2025-03-09 10:43:08,674 [INFO]: Reading total number of vectors and dimension 03/09/2025, 10:43:08
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1909.97it/s]
2025-03-09 10:43:08,698 [INFO]: There are 2559 embeddings of dim 49152
2025-03-09 10:43:08,698 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0240 secs
2025-03-09 10:43:08,698 [INFO]: 	Compute estimated construction time of the index 03/09/2025, 10:43:08
2025-03-09 10:43:08,698 [INFO]: 		-> Train: 16.7 minutes
2025-03-09 10:43:08,698 [INFO]: 		-> Add: 1.4 seconds
2025-03-09 10:43:08,698 [INFO]: 		Total: 16.7 minutes
2025-03-09 10:43:08,698 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0001 secs
2025-03-09 10:43:08,699 [INFO]: 	Checking that your have enough memory available to create the index 03/09/2025, 10:43:08
2025-03-09 10:43:08,699 [INFO]: 528.1MB of memory will be needed to build the index (more might be used if you have more)
2025-03-09 10:43:08,699 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0001 secs
2025-03-09 10:43:08,699 [INFO]: 	Selecting most promising index types given data characteristics 03/09/2025, 10:43:08
2025-03-09 10:43:08,699 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-09 10:43:08,699 [INFO]: 	Creating the index 03/09/2025, 10:43:08
2025-03-09 10:43:08,699 [INFO]: 		-> Instanciate the index HNSW15 03/09/2025, 10:43:08
2025-03-09 10:43:08,700 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0010 secs
2025-03-09 10:43:08,700 [INFO]: 		-> Adding the vectors to the index 03/09/2025, 10:43:08
2025-03-09 10:43:08,700 [INFO]: The memory available for adding the vectors is 49.5GB(total available - used by the index)
2025-03-09 10:43:08,700 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/11 [00:00<?, ?it/s]  9%|▉         | 1/11 [00:00<00:01,  5.76it/s] 55%|█████▍    | 6/11 [00:00<00:00, 24.36it/s] 82%|████████▏ | 9/11 [00:00<00:00, 22.94it/s]100%|██████████| 11/11 [00:02<00:00,  5.28it/s]
2025-03-09 10:43:10,786 [INFO]: 	Computing best hyperparameters for index knn.index 03/09/2025, 10:43:10
2025-03-09 10:43:34,146 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 23.3593 secs
2025-03-09 10:43:34,146 [INFO]: The best hyperparameters are: efSearch=282
2025-03-09 10:43:34,146 [INFO]: 	Compute fast metrics 03/09/2025, 10:43:34
  0%|          | 0/4 [00:00<?, ?it/s] 75%|███████▌  | 3/4 [00:00<00:00, 28.46it/s] 75%|███████▌  | 3/4 [00:00<00:00, 24.73it/s]
2025-03-09 10:43:47,253 [INFO]: 	>>> Finished "Compute fast metrics" in 13.1065 secs
2025-03-09 10:43:47,254 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 38.5543 secs
2025-03-09 10:43:47,254 [INFO]: {
2025-03-09 10:43:47,254 [INFO]: 	index_key: HNSW15
2025-03-09 10:43:47,254 [INFO]: 	index_param: efSearch=282
2025-03-09 10:43:47,254 [INFO]: 	index_path: knn.index
2025-03-09 10:43:47,255 [INFO]: 	size in bytes: 503467450
2025-03-09 10:43:47,255 [INFO]: 	avg_search_speed_ms: 10.276833933683347
2025-03-09 10:43:47,255 [INFO]: 	99p_search_speed_ms: 16.87008704990148
2025-03-09 10:43:47,255 [INFO]: 	reconstruction error %: 0.0
2025-03-09 10:43:47,255 [INFO]: 	nb vectors: 2559
2025-03-09 10:43:47,255 [INFO]: 	vectors dimension: 49152
2025-03-09 10:43:47,255 [INFO]: 	compression ratio: 0.9993096316355705
2025-03-09 10:43:47,255 [INFO]: }
2025-03-09 10:43:47,255 [INFO]: 	>>> Finished "Creating the index" in 38.5557 secs
2025-03-09 10:43:47,255 [INFO]: >>> Finished "Launching the whole pipeline" in 38.5803 secs
2025-03-09 10:43:48: [retrieval_preprocessing] calculating distances ...
2025-03-09 10:43:48: [retrieval_preprocessing] finished and saved retrieval indices for episode 31830 [episode count 16/20]
[retrieval_preprocessing] for episode 40536 [episode count 17/20], we have num_retrieval=np.int64(2551) num_query=np.int64(166)
2025-03-09 10:43:49,038 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-09 10:43:49,327 [INFO]: Launching the whole pipeline 03/09/2025, 10:43:49
2025-03-09 10:43:49,327 [INFO]: Reading total number of vectors and dimension 03/09/2025, 10:43:49
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 2314.74it/s]
2025-03-09 10:43:49,351 [INFO]: There are 2551 embeddings of dim 49152
2025-03-09 10:43:49,351 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0233 secs
2025-03-09 10:43:49,351 [INFO]: 	Compute estimated construction time of the index 03/09/2025, 10:43:49
2025-03-09 10:43:49,351 [INFO]: 		-> Train: 16.7 minutes
2025-03-09 10:43:49,351 [INFO]: 		-> Add: 1.4 seconds
2025-03-09 10:43:49,351 [INFO]: 		Total: 16.7 minutes
2025-03-09 10:43:49,351 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0001 secs
2025-03-09 10:43:49,351 [INFO]: 	Checking that your have enough memory available to create the index 03/09/2025, 10:43:49
2025-03-09 10:43:49,351 [INFO]: 526.5MB of memory will be needed to build the index (more might be used if you have more)
2025-03-09 10:43:49,351 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0001 secs
2025-03-09 10:43:49,351 [INFO]: 	Selecting most promising index types given data characteristics 03/09/2025, 10:43:49
2025-03-09 10:43:49,351 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-09 10:43:49,351 [INFO]: 	Creating the index 03/09/2025, 10:43:49
2025-03-09 10:43:49,351 [INFO]: 		-> Instanciate the index HNSW15 03/09/2025, 10:43:49
2025-03-09 10:43:49,352 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0010 secs
2025-03-09 10:43:49,352 [INFO]: 		-> Adding the vectors to the index 03/09/2025, 10:43:49
2025-03-09 10:43:49,352 [INFO]: The memory available for adding the vectors is 49.5GB(total available - used by the index)
2025-03-09 10:43:49,353 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/11 [00:00<?, ?it/s] 18%|█▊        | 2/11 [00:00<00:00, 17.94it/s] 82%|████████▏ | 9/11 [00:00<00:00, 43.72it/s]100%|██████████| 11/11 [00:01<00:00,  5.96it/s]
2025-03-09 10:43:51,201 [INFO]: 	Computing best hyperparameters for index knn.index 03/09/2025, 10:43:51
2025-03-09 10:44:14,461 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 23.2598 secs
2025-03-09 10:44:14,461 [INFO]: The best hyperparameters are: efSearch=302
2025-03-09 10:44:14,461 [INFO]: 	Compute fast metrics 03/09/2025, 10:44:14
  0%|          | 0/4 [00:00<?, ?it/s] 25%|██▌       | 1/4 [00:00<00:00,  6.74it/s] 75%|███████▌  | 3/4 [00:00<00:00, 12.74it/s] 75%|███████▌  | 3/4 [00:00<00:00,  9.66it/s]
2025-03-09 10:44:27,777 [INFO]: 	>>> Finished "Compute fast metrics" in 13.3164 secs
2025-03-09 10:44:27,779 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 38.4263 secs
2025-03-09 10:44:27,779 [INFO]: {
2025-03-09 10:44:27,779 [INFO]: 	index_key: HNSW15
2025-03-09 10:44:27,779 [INFO]: 	index_param: efSearch=302
2025-03-09 10:44:27,779 [INFO]: 	index_path: knn.index
2025-03-09 10:44:27,779 [INFO]: 	size in bytes: 501893530
2025-03-09 10:44:27,779 [INFO]: 	avg_search_speed_ms: 9.674097972469877
2025-03-09 10:44:27,779 [INFO]: 	99p_search_speed_ms: 12.4764207447879
2025-03-09 10:44:27,779 [INFO]: 	reconstruction error %: 0.0
2025-03-09 10:44:27,779 [INFO]: 	nb vectors: 2551
2025-03-09 10:44:27,779 [INFO]: 	vectors dimension: 49152
2025-03-09 10:44:27,779 [INFO]: 	compression ratio: 0.9993095706971955
2025-03-09 10:44:27,779 [INFO]: }
2025-03-09 10:44:27,779 [INFO]: 	>>> Finished "Creating the index" in 38.4277 secs
2025-03-09 10:44:27,779 [INFO]: >>> Finished "Launching the whole pipeline" in 38.4516 secs
2025-03-09 10:44:29: [retrieval_preprocessing] calculating distances ...
2025-03-09 10:44:29: [retrieval_preprocessing] finished and saved retrieval indices for episode 40536 [episode count 17/20]
[retrieval_preprocessing] for episode 89686 [episode count 18/20], we have num_retrieval=np.int64(2555) num_query=np.int64(162)
2025-03-09 10:44:29,587 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-09 10:44:29,899 [INFO]: Launching the whole pipeline 03/09/2025, 10:44:29
2025-03-09 10:44:29,899 [INFO]: Reading total number of vectors and dimension 03/09/2025, 10:44:29
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1319.79it/s]
2025-03-09 10:44:29,924 [INFO]: There are 2555 embeddings of dim 49152
2025-03-09 10:44:29,924 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0249 secs
2025-03-09 10:44:29,924 [INFO]: 	Compute estimated construction time of the index 03/09/2025, 10:44:29
2025-03-09 10:44:29,924 [INFO]: 		-> Train: 16.7 minutes
2025-03-09 10:44:29,924 [INFO]: 		-> Add: 1.4 seconds
2025-03-09 10:44:29,924 [INFO]: 		Total: 16.7 minutes
2025-03-09 10:44:29,924 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0001 secs
2025-03-09 10:44:29,924 [INFO]: 	Checking that your have enough memory available to create the index 03/09/2025, 10:44:29
2025-03-09 10:44:29,924 [INFO]: 527.3MB of memory will be needed to build the index (more might be used if you have more)
2025-03-09 10:44:29,924 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0002 secs
2025-03-09 10:44:29,924 [INFO]: 	Selecting most promising index types given data characteristics 03/09/2025, 10:44:29
2025-03-09 10:44:29,924 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-09 10:44:29,924 [INFO]: 	Creating the index 03/09/2025, 10:44:29
2025-03-09 10:44:29,924 [INFO]: 		-> Instanciate the index HNSW15 03/09/2025, 10:44:29
2025-03-09 10:44:29,926 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0012 secs
2025-03-09 10:44:29,926 [INFO]: 		-> Adding the vectors to the index 03/09/2025, 10:44:29
2025-03-09 10:44:29,926 [INFO]: The memory available for adding the vectors is 49.5GB(total available - used by the index)
2025-03-09 10:44:29,926 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/11 [00:00<?, ?it/s] 18%|█▊        | 2/11 [00:00<00:00, 17.68it/s] 82%|████████▏ | 9/11 [00:00<00:00, 46.03it/s]100%|██████████| 11/11 [00:01<00:00,  6.02it/s]
2025-03-09 10:44:31,755 [INFO]: 	Computing best hyperparameters for index knn.index 03/09/2025, 10:44:31
2025-03-09 10:44:54,373 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 22.6176 secs
2025-03-09 10:44:54,373 [INFO]: The best hyperparameters are: efSearch=289
2025-03-09 10:44:54,373 [INFO]: 	Compute fast metrics 03/09/2025, 10:44:54
  0%|          | 0/4 [00:00<?, ?it/s] 25%|██▌       | 1/4 [00:00<00:00,  6.92it/s] 75%|███████▌  | 3/4 [00:00<00:00, 11.15it/s] 75%|███████▌  | 3/4 [00:00<00:00,  8.61it/s]
2025-03-09 10:45:07,189 [INFO]: 	>>> Finished "Compute fast metrics" in 12.8158 secs
2025-03-09 10:45:07,190 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 37.2642 secs
2025-03-09 10:45:07,190 [INFO]: {
2025-03-09 10:45:07,190 [INFO]: 	index_key: HNSW15
2025-03-09 10:45:07,190 [INFO]: 	index_param: efSearch=289
2025-03-09 10:45:07,190 [INFO]: 	index_path: knn.index
2025-03-09 10:45:07,190 [INFO]: 	size in bytes: 502680490
2025-03-09 10:45:07,190 [INFO]: 	avg_search_speed_ms: 8.90660986183203
2025-03-09 10:45:07,190 [INFO]: 	99p_search_speed_ms: 11.76258992869407
2025-03-09 10:45:07,190 [INFO]: 	reconstruction error %: 0.0
2025-03-09 10:45:07,190 [INFO]: 	nb vectors: 2555
2025-03-09 10:45:07,190 [INFO]: 	vectors dimension: 49152
2025-03-09 10:45:07,190 [INFO]: 	compression ratio: 0.9993096012140833
2025-03-09 10:45:07,190 [INFO]: }
2025-03-09 10:45:07,190 [INFO]: 	>>> Finished "Creating the index" in 37.2658 secs
2025-03-09 10:45:07,190 [INFO]: >>> Finished "Launching the whole pipeline" in 37.2914 secs
2025-03-09 10:45:08: [retrieval_preprocessing] calculating distances ...
2025-03-09 10:45:08: [retrieval_preprocessing] finished and saved retrieval indices for episode 89686 [episode count 18/20]
[retrieval_preprocessing] for episode 8285 [episode count 19/20], we have num_retrieval=np.int64(2623) num_query=np.int64(94)
2025-03-09 10:45:08,608 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-09 10:45:08,904 [INFO]: Launching the whole pipeline 03/09/2025, 10:45:08
2025-03-09 10:45:08,904 [INFO]: Reading total number of vectors and dimension 03/09/2025, 10:45:08
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 2614.90it/s]
2025-03-09 10:45:08,927 [INFO]: There are 2623 embeddings of dim 49152
2025-03-09 10:45:08,927 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0231 secs
2025-03-09 10:45:08,927 [INFO]: 	Compute estimated construction time of the index 03/09/2025, 10:45:08
2025-03-09 10:45:08,927 [INFO]: 		-> Train: 16.7 minutes
2025-03-09 10:45:08,927 [INFO]: 		-> Add: 1.4 seconds
2025-03-09 10:45:08,927 [INFO]: 		Total: 16.7 minutes
2025-03-09 10:45:08,927 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0001 secs
2025-03-09 10:45:08,927 [INFO]: 	Checking that your have enough memory available to create the index 03/09/2025, 10:45:08
2025-03-09 10:45:08,927 [INFO]: 541.3MB of memory will be needed to build the index (more might be used if you have more)
2025-03-09 10:45:08,928 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0001 secs
2025-03-09 10:45:08,928 [INFO]: 	Selecting most promising index types given data characteristics 03/09/2025, 10:45:08
2025-03-09 10:45:08,928 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-09 10:45:08,928 [INFO]: 	Creating the index 03/09/2025, 10:45:08
2025-03-09 10:45:08,928 [INFO]: 		-> Instanciate the index HNSW15 03/09/2025, 10:45:08
2025-03-09 10:45:08,929 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0009 secs
2025-03-09 10:45:08,929 [INFO]: 		-> Adding the vectors to the index 03/09/2025, 10:45:08
2025-03-09 10:45:08,929 [INFO]: The memory available for adding the vectors is 49.5GB(total available - used by the index)
2025-03-09 10:45:08,929 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/11 [00:00<?, ?it/s] 18%|█▊        | 2/11 [00:00<00:00, 18.01it/s] 36%|███▋      | 4/11 [00:00<00:00, 17.96it/s] 64%|██████▎   | 7/11 [00:00<00:00, 22.42it/s]100%|██████████| 11/11 [00:01<00:00,  4.23it/s]100%|██████████| 11/11 [00:01<00:00,  5.50it/s]
2025-03-09 10:45:10,930 [INFO]: 	Computing best hyperparameters for index knn.index 03/09/2025, 10:45:10
2025-03-09 10:45:34,984 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 24.0538 secs
2025-03-09 10:45:34,985 [INFO]: The best hyperparameters are: efSearch=293
2025-03-09 10:45:34,985 [INFO]: 	Compute fast metrics 03/09/2025, 10:45:34
  0%|          | 0/4 [00:00<?, ?it/s] 25%|██▌       | 1/4 [00:00<00:00,  6.83it/s] 75%|███████▌  | 3/4 [00:00<00:00, 11.23it/s] 75%|███████▌  | 3/4 [00:00<00:00,  8.56it/s]
2025-03-09 10:45:48,604 [INFO]: 	>>> Finished "Compute fast metrics" in 13.6191 secs
2025-03-09 10:45:48,606 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 39.6769 secs
2025-03-09 10:45:48,606 [INFO]: {
2025-03-09 10:45:48,606 [INFO]: 	index_key: HNSW15
2025-03-09 10:45:48,606 [INFO]: 	index_param: efSearch=293
2025-03-09 10:45:48,606 [INFO]: 	index_path: knn.index
2025-03-09 10:45:48,606 [INFO]: 	size in bytes: 516059170
2025-03-09 10:45:48,606 [INFO]: 	avg_search_speed_ms: 9.699977268162252
2025-03-09 10:45:48,606 [INFO]: 	99p_search_speed_ms: 13.003555778414015
2025-03-09 10:45:48,606 [INFO]: 	reconstruction error %: 0.0
2025-03-09 10:45:48,606 [INFO]: 	nb vectors: 2623
2025-03-09 10:45:48,606 [INFO]: 	vectors dimension: 49152
2025-03-09 10:45:48,606 [INFO]: 	compression ratio: 0.9993094086478495
2025-03-09 10:45:48,606 [INFO]: }
2025-03-09 10:45:48,606 [INFO]: 	>>> Finished "Creating the index" in 39.6782 secs
2025-03-09 10:45:48,606 [INFO]: >>> Finished "Launching the whole pipeline" in 39.7018 secs
2025-03-09 10:45:49: [retrieval_preprocessing] calculating distances ...
2025-03-09 10:45:49: [retrieval_preprocessing] finished and saved retrieval indices for episode 8285 [episode count 19/20]
2025-03-09 10:45:49: [retrieval_preprocessing] finished for (-1, 'cup') [chosen_id count 8/10]
2025-03-09 10:45:51: [retrieval_preprocessing] concatenated all embeddings and indices for 20 episodes for (8922050678, 'lid') [chosen_id count 9/10]
2025-03-09 10:45:51: [retrieval_preprocessing] we have num_total=3014 embedding_dim=49152
[retrieval_preprocessing] for episode 5120 [episode count 0/20], we have num_retrieval=np.int64(2837) num_query=np.int64(177)
2025-03-09 10:45:51,627 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-09 10:45:51,968 [INFO]: Launching the whole pipeline 03/09/2025, 10:45:51
2025-03-09 10:45:51,968 [INFO]: Reading total number of vectors and dimension 03/09/2025, 10:45:51
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 2339.27it/s]
2025-03-09 10:45:51,992 [INFO]: There are 2837 embeddings of dim 49152
2025-03-09 10:45:51,992 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0238 secs
2025-03-09 10:45:51,992 [INFO]: 	Compute estimated construction time of the index 03/09/2025, 10:45:51
2025-03-09 10:45:51,992 [INFO]: 		-> Train: 16.7 minutes
2025-03-09 10:45:51,992 [INFO]: 		-> Add: 1.6 seconds
2025-03-09 10:45:51,992 [INFO]: 		Total: 16.7 minutes
2025-03-09 10:45:51,992 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0001 secs
2025-03-09 10:45:51,992 [INFO]: 	Checking that your have enough memory available to create the index 03/09/2025, 10:45:51
2025-03-09 10:45:51,992 [INFO]: 585.5MB of memory will be needed to build the index (more might be used if you have more)
2025-03-09 10:45:51,992 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0001 secs
2025-03-09 10:45:51,992 [INFO]: 	Selecting most promising index types given data characteristics 03/09/2025, 10:45:51
2025-03-09 10:45:51,992 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-09 10:45:51,992 [INFO]: 	Creating the index 03/09/2025, 10:45:51
2025-03-09 10:45:51,992 [INFO]: 		-> Instanciate the index HNSW15 03/09/2025, 10:45:51
2025-03-09 10:45:51,993 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0010 secs
2025-03-09 10:45:51,994 [INFO]: 		-> Adding the vectors to the index 03/09/2025, 10:45:51
2025-03-09 10:45:51,994 [INFO]: The memory available for adding the vectors is 49.5GB(total available - used by the index)
2025-03-09 10:45:51,994 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/12 [00:00<?, ?it/s] 25%|██▌       | 3/12 [00:00<00:00, 26.77it/s] 83%|████████▎ | 10/12 [00:00<00:00, 50.08it/s]100%|██████████| 12/12 [00:01<00:00,  6.42it/s]
2025-03-09 10:45:53,866 [INFO]: 	Computing best hyperparameters for index knn.index 03/09/2025, 10:45:53
2025-03-09 10:46:19,743 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 25.8766 secs
2025-03-09 10:46:19,744 [INFO]: The best hyperparameters are: efSearch=297
2025-03-09 10:46:19,744 [INFO]: 	Compute fast metrics 03/09/2025, 10:46:19
  0%|          | 0/4 [00:00<?, ?it/s] 25%|██▌       | 1/4 [00:00<00:00,  5.63it/s] 75%|███████▌  | 3/4 [00:00<00:00,  9.59it/s] 75%|███████▌  | 3/4 [00:00<00:00,  7.36it/s]
2025-03-09 10:46:33,889 [INFO]: 	>>> Finished "Compute fast metrics" in 14.1450 secs
2025-03-09 10:46:33,890 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 41.8967 secs
2025-03-09 10:46:33,890 [INFO]: {
2025-03-09 10:46:33,890 [INFO]: 	index_key: HNSW15
2025-03-09 10:46:33,890 [INFO]: 	index_param: efSearch=297
2025-03-09 10:46:33,890 [INFO]: 	index_path: knn.index
2025-03-09 10:46:33,890 [INFO]: 	size in bytes: 558162250
2025-03-09 10:46:33,890 [INFO]: 	avg_search_speed_ms: 9.346156210255609
2025-03-09 10:46:33,890 [INFO]: 	99p_search_speed_ms: 12.6084671029821
2025-03-09 10:46:33,890 [INFO]: 	reconstruction error %: 0.0
2025-03-09 10:46:33,890 [INFO]: 	nb vectors: 2837
2025-03-09 10:46:33,890 [INFO]: 	vectors dimension: 49152
2025-03-09 10:46:33,890 [INFO]: 	compression ratio: 0.9993096021810862
2025-03-09 10:46:33,890 [INFO]: }
2025-03-09 10:46:33,891 [INFO]: 	>>> Finished "Creating the index" in 41.8980 secs
2025-03-09 10:46:33,891 [INFO]: >>> Finished "Launching the whole pipeline" in 41.9224 secs
2025-03-09 10:46:35: [retrieval_preprocessing] calculating distances ...
2025-03-09 10:46:35: [retrieval_preprocessing] finished and saved retrieval indices for episode 5120 [episode count 0/20]
[retrieval_preprocessing] for episode 23936 [episode count 1/20], we have num_retrieval=np.int64(2926) num_query=np.int64(88)
2025-03-09 10:46:35,885 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-09 10:46:36,217 [INFO]: Launching the whole pipeline 03/09/2025, 10:46:36
2025-03-09 10:46:36,217 [INFO]: Reading total number of vectors and dimension 03/09/2025, 10:46:36
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 2255.00it/s]
2025-03-09 10:46:36,242 [INFO]: There are 2926 embeddings of dim 49152
2025-03-09 10:46:36,242 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0250 secs
2025-03-09 10:46:36,242 [INFO]: 	Compute estimated construction time of the index 03/09/2025, 10:46:36
2025-03-09 10:46:36,242 [INFO]: 		-> Train: 16.7 minutes
2025-03-09 10:46:36,242 [INFO]: 		-> Add: 1.6 seconds
2025-03-09 10:46:36,242 [INFO]: 		Total: 16.7 minutes
2025-03-09 10:46:36,242 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0001 secs
2025-03-09 10:46:36,242 [INFO]: 	Checking that your have enough memory available to create the index 03/09/2025, 10:46:36
2025-03-09 10:46:36,242 [INFO]: 603.9MB of memory will be needed to build the index (more might be used if you have more)
2025-03-09 10:46:36,242 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0001 secs
2025-03-09 10:46:36,242 [INFO]: 	Selecting most promising index types given data characteristics 03/09/2025, 10:46:36
2025-03-09 10:46:36,242 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-09 10:46:36,242 [INFO]: 	Creating the index 03/09/2025, 10:46:36
2025-03-09 10:46:36,242 [INFO]: 		-> Instanciate the index HNSW15 03/09/2025, 10:46:36
2025-03-09 10:46:36,244 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0012 secs
2025-03-09 10:46:36,244 [INFO]: 		-> Adding the vectors to the index 03/09/2025, 10:46:36
2025-03-09 10:46:36,244 [INFO]: The memory available for adding the vectors is 49.5GB(total available - used by the index)
2025-03-09 10:46:36,244 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/12 [00:00<?, ?it/s]  8%|▊         | 1/12 [00:00<00:01,  7.82it/s] 42%|████▏     | 5/12 [00:00<00:00, 21.80it/s] 75%|███████▌  | 9/12 [00:00<00:00, 25.42it/s]100%|██████████| 12/12 [00:02<00:00,  3.85it/s]100%|██████████| 12/12 [00:02<00:00,  5.23it/s]
2025-03-09 10:46:38,542 [INFO]: 	Computing best hyperparameters for index knn.index 03/09/2025, 10:46:38
2025-03-09 10:47:08,270 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 29.7286 secs
2025-03-09 10:47:08,270 [INFO]: The best hyperparameters are: efSearch=257
2025-03-09 10:47:08,271 [INFO]: 	Compute fast metrics 03/09/2025, 10:47:08
  0%|          | 0/4 [00:00<?, ?it/s] 75%|███████▌  | 3/4 [00:00<00:00, 27.07it/s] 75%|███████▌  | 3/4 [00:00<00:00, 23.52it/s]
2025-03-09 10:47:22,156 [INFO]: 	>>> Finished "Compute fast metrics" in 13.8852 secs
2025-03-09 10:47:22,157 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 45.9136 secs
2025-03-09 10:47:22,157 [INFO]: {
2025-03-09 10:47:22,157 [INFO]: 	index_key: HNSW15
2025-03-09 10:47:22,157 [INFO]: 	index_param: efSearch=257
2025-03-09 10:47:22,157 [INFO]: 	index_path: knn.index
2025-03-09 10:47:22,157 [INFO]: 	size in bytes: 575672290
2025-03-09 10:47:22,157 [INFO]: 	avg_search_speed_ms: 9.023812985289775
2025-03-09 10:47:22,158 [INFO]: 	99p_search_speed_ms: 11.656845181714747
2025-03-09 10:47:22,158 [INFO]: 	reconstruction error %: 0.0
2025-03-09 10:47:22,158 [INFO]: 	nb vectors: 2926
2025-03-09 10:47:22,158 [INFO]: 	vectors dimension: 49152
2025-03-09 10:47:22,158 [INFO]: 	compression ratio: 0.9993098816689614
2025-03-09 10:47:22,158 [INFO]: }
2025-03-09 10:47:22,158 [INFO]: 	>>> Finished "Creating the index" in 45.9153 secs
2025-03-09 10:47:22,158 [INFO]: >>> Finished "Launching the whole pipeline" in 45.9410 secs
2025-03-09 10:47:22: [retrieval_preprocessing] calculating distances ...
2025-03-09 10:47:22: [retrieval_preprocessing] finished and saved retrieval indices for episode 23936 [episode count 1/20]
[retrieval_preprocessing] for episode 61057 [episode count 2/20], we have num_retrieval=np.int64(2922) num_query=np.int64(92)
2025-03-09 10:47:23,139 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-09 10:47:23,464 [INFO]: Launching the whole pipeline 03/09/2025, 10:47:23
2025-03-09 10:47:23,464 [INFO]: Reading total number of vectors and dimension 03/09/2025, 10:47:23
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1702.23it/s]
2025-03-09 10:47:23,490 [INFO]: There are 2922 embeddings of dim 49152
2025-03-09 10:47:23,490 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0257 secs
2025-03-09 10:47:23,490 [INFO]: 	Compute estimated construction time of the index 03/09/2025, 10:47:23
2025-03-09 10:47:23,490 [INFO]: 		-> Train: 16.7 minutes
2025-03-09 10:47:23,490 [INFO]: 		-> Add: 1.6 seconds
2025-03-09 10:47:23,490 [INFO]: 		Total: 16.7 minutes
2025-03-09 10:47:23,490 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0001 secs
2025-03-09 10:47:23,490 [INFO]: 	Checking that your have enough memory available to create the index 03/09/2025, 10:47:23
2025-03-09 10:47:23,490 [INFO]: 603.0MB of memory will be needed to build the index (more might be used if you have more)
2025-03-09 10:47:23,490 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0001 secs
2025-03-09 10:47:23,490 [INFO]: 	Selecting most promising index types given data characteristics 03/09/2025, 10:47:23
2025-03-09 10:47:23,490 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-09 10:47:23,490 [INFO]: 	Creating the index 03/09/2025, 10:47:23
2025-03-09 10:47:23,490 [INFO]: 		-> Instanciate the index HNSW15 03/09/2025, 10:47:23
2025-03-09 10:47:23,491 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0010 secs
2025-03-09 10:47:23,491 [INFO]: 		-> Adding the vectors to the index 03/09/2025, 10:47:23
2025-03-09 10:47:23,492 [INFO]: The memory available for adding the vectors is 49.5GB(total available - used by the index)
2025-03-09 10:47:23,492 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/12 [00:00<?, ?it/s] 25%|██▌       | 3/12 [00:00<00:00, 26.13it/s] 83%|████████▎ | 10/12 [00:00<00:00, 49.21it/s]100%|██████████| 12/12 [00:01<00:00,  6.32it/s]
2025-03-09 10:47:25,396 [INFO]: 	Computing best hyperparameters for index knn.index 03/09/2025, 10:47:25
2025-03-09 10:47:52,939 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 27.5424 secs
2025-03-09 10:47:52,939 [INFO]: The best hyperparameters are: efSearch=288
2025-03-09 10:47:52,939 [INFO]: 	Compute fast metrics 03/09/2025, 10:47:52
  0%|          | 0/4 [00:00<?, ?it/s] 25%|██▌       | 1/4 [00:00<00:00,  6.20it/s] 75%|███████▌  | 3/4 [00:00<00:00, 10.29it/s] 75%|███████▌  | 3/4 [00:00<00:00,  7.92it/s]
2025-03-09 10:48:07,089 [INFO]: 	>>> Finished "Compute fast metrics" in 14.1497 secs
2025-03-09 10:48:07,090 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 43.5986 secs
2025-03-09 10:48:07,090 [INFO]: {
2025-03-09 10:48:07,090 [INFO]: 	index_key: HNSW15
2025-03-09 10:48:07,090 [INFO]: 	index_param: efSearch=288
2025-03-09 10:48:07,090 [INFO]: 	index_path: knn.index
2025-03-09 10:48:07,090 [INFO]: 	size in bytes: 574885330
2025-03-09 10:48:07,090 [INFO]: 	avg_search_speed_ms: 9.362634291221852
2025-03-09 10:48:07,090 [INFO]: 	99p_search_speed_ms: 12.610130023676902
2025-03-09 10:48:07,090 [INFO]: 	reconstruction error %: 0.0
2025-03-09 10:48:07,090 [INFO]: 	nb vectors: 2922
2025-03-09 10:48:07,090 [INFO]: 	vectors dimension: 49152
2025-03-09 10:48:07,090 [INFO]: 	compression ratio: 0.9993098554106433
2025-03-09 10:48:07,090 [INFO]: }
2025-03-09 10:48:07,090 [INFO]: 	>>> Finished "Creating the index" in 43.6001 secs
2025-03-09 10:48:07,090 [INFO]: >>> Finished "Launching the whole pipeline" in 43.6264 secs
2025-03-09 10:48:07: [retrieval_preprocessing] calculating distances ...
2025-03-09 10:48:07: [retrieval_preprocessing] finished and saved retrieval indices for episode 61057 [episode count 2/20]
[retrieval_preprocessing] for episode 21636 [episode count 3/20], we have num_retrieval=np.int64(2897) num_query=np.int64(117)
2025-03-09 10:48:08,084 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-09 10:48:08,415 [INFO]: Launching the whole pipeline 03/09/2025, 10:48:08
2025-03-09 10:48:08,415 [INFO]: Reading total number of vectors and dimension 03/09/2025, 10:48:08
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1987.82it/s]
2025-03-09 10:48:08,441 [INFO]: There are 2897 embeddings of dim 49152
2025-03-09 10:48:08,441 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0254 secs
2025-03-09 10:48:08,441 [INFO]: 	Compute estimated construction time of the index 03/09/2025, 10:48:08
2025-03-09 10:48:08,441 [INFO]: 		-> Train: 16.7 minutes
2025-03-09 10:48:08,441 [INFO]: 		-> Add: 1.6 seconds
2025-03-09 10:48:08,441 [INFO]: 		Total: 16.7 minutes
2025-03-09 10:48:08,441 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0001 secs
2025-03-09 10:48:08,441 [INFO]: 	Checking that your have enough memory available to create the index 03/09/2025, 10:48:08
2025-03-09 10:48:08,441 [INFO]: 597.9MB of memory will be needed to build the index (more might be used if you have more)
2025-03-09 10:48:08,441 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0001 secs
2025-03-09 10:48:08,441 [INFO]: 	Selecting most promising index types given data characteristics 03/09/2025, 10:48:08
2025-03-09 10:48:08,441 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-09 10:48:08,441 [INFO]: 	Creating the index 03/09/2025, 10:48:08
2025-03-09 10:48:08,441 [INFO]: 		-> Instanciate the index HNSW15 03/09/2025, 10:48:08
2025-03-09 10:48:08,443 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0011 secs
2025-03-09 10:48:08,443 [INFO]: 		-> Adding the vectors to the index 03/09/2025, 10:48:08
2025-03-09 10:48:08,443 [INFO]: The memory available for adding the vectors is 49.5GB(total available - used by the index)
2025-03-09 10:48:08,443 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/12 [00:00<?, ?it/s] 17%|█▋        | 2/12 [00:00<00:00, 19.41it/s] 75%|███████▌  | 9/12 [00:00<00:00, 48.39it/s]100%|██████████| 12/12 [00:01<00:00,  6.23it/s]
2025-03-09 10:48:10,371 [INFO]: 	Computing best hyperparameters for index knn.index 03/09/2025, 10:48:10
2025-03-09 10:48:37,829 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 27.4578 secs
2025-03-09 10:48:37,829 [INFO]: The best hyperparameters are: efSearch=284
2025-03-09 10:48:37,829 [INFO]: 	Compute fast metrics 03/09/2025, 10:48:37
  0%|          | 0/4 [00:00<?, ?it/s] 25%|██▌       | 1/4 [00:00<00:00,  6.31it/s] 75%|███████▌  | 3/4 [00:00<00:00, 10.29it/s] 75%|███████▌  | 3/4 [00:00<00:00,  7.94it/s]
2025-03-09 10:48:51,374 [INFO]: 	>>> Finished "Compute fast metrics" in 13.5450 secs
2025-03-09 10:48:51,375 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 42.9328 secs
2025-03-09 10:48:51,376 [INFO]: {
2025-03-09 10:48:51,376 [INFO]: 	index_key: HNSW15
2025-03-09 10:48:51,376 [INFO]: 	index_param: efSearch=284
2025-03-09 10:48:51,376 [INFO]: 	index_path: knn.index
2025-03-09 10:48:51,376 [INFO]: 	size in bytes: 569966770
2025-03-09 10:48:51,376 [INFO]: 	avg_search_speed_ms: 9.254963824285968
2025-03-09 10:48:51,376 [INFO]: 	99p_search_speed_ms: 12.19641398638487
2025-03-09 10:48:51,376 [INFO]: 	reconstruction error %: 0.0
2025-03-09 10:48:51,376 [INFO]: 	nb vectors: 2897
2025-03-09 10:48:51,376 [INFO]: 	vectors dimension: 49152
2025-03-09 10:48:51,376 [INFO]: 	compression ratio: 0.99930979484997
2025-03-09 10:48:51,376 [INFO]: }
2025-03-09 10:48:51,376 [INFO]: 	>>> Finished "Creating the index" in 42.9343 secs
2025-03-09 10:48:51,376 [INFO]: >>> Finished "Launching the whole pipeline" in 42.9603 secs
2025-03-09 10:48:52: [retrieval_preprocessing] calculating distances ...
2025-03-09 10:48:52: [retrieval_preprocessing] finished and saved retrieval indices for episode 21636 [episode count 3/20]
[retrieval_preprocessing] for episode 42117 [episode count 4/20], we have num_retrieval=np.int64(2883) num_query=np.int64(131)
2025-03-09 10:48:52,499 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-09 10:48:52,844 [INFO]: Launching the whole pipeline 03/09/2025, 10:48:52
2025-03-09 10:48:52,844 [INFO]: Reading total number of vectors and dimension 03/09/2025, 10:48:52
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 2400.86it/s]
2025-03-09 10:48:52,865 [INFO]: There are 2883 embeddings of dim 49152
2025-03-09 10:48:52,865 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0217 secs
2025-03-09 10:48:52,865 [INFO]: 	Compute estimated construction time of the index 03/09/2025, 10:48:52
2025-03-09 10:48:52,866 [INFO]: 		-> Train: 16.7 minutes
2025-03-09 10:48:52,866 [INFO]: 		-> Add: 1.6 seconds
2025-03-09 10:48:52,866 [INFO]: 		Total: 16.7 minutes
2025-03-09 10:48:52,866 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0001 secs
2025-03-09 10:48:52,866 [INFO]: 	Checking that your have enough memory available to create the index 03/09/2025, 10:48:52
2025-03-09 10:48:52,866 [INFO]: 595.0MB of memory will be needed to build the index (more might be used if you have more)
2025-03-09 10:48:52,866 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0001 secs
2025-03-09 10:48:52,866 [INFO]: 	Selecting most promising index types given data characteristics 03/09/2025, 10:48:52
2025-03-09 10:48:52,866 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-09 10:48:52,866 [INFO]: 	Creating the index 03/09/2025, 10:48:52
2025-03-09 10:48:52,866 [INFO]: 		-> Instanciate the index HNSW15 03/09/2025, 10:48:52
2025-03-09 10:48:52,867 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0010 secs
2025-03-09 10:48:52,867 [INFO]: 		-> Adding the vectors to the index 03/09/2025, 10:48:52
2025-03-09 10:48:52,867 [INFO]: The memory available for adding the vectors is 49.5GB(total available - used by the index)
2025-03-09 10:48:52,867 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/12 [00:00<?, ?it/s]  8%|▊         | 1/12 [00:00<00:01,  6.85it/s] 33%|███▎      | 4/12 [00:00<00:00, 17.35it/s] 75%|███████▌  | 9/12 [00:00<00:00, 29.80it/s]100%|██████████| 12/12 [00:02<00:00,  4.86it/s]
2025-03-09 10:48:55,339 [INFO]: 	Computing best hyperparameters for index knn.index 03/09/2025, 10:48:55
2025-03-09 10:49:21,646 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 26.3057 secs
2025-03-09 10:49:21,646 [INFO]: The best hyperparameters are: efSearch=274
2025-03-09 10:49:21,646 [INFO]: 	Compute fast metrics 03/09/2025, 10:49:21
  0%|          | 0/4 [00:00<?, ?it/s] 25%|██▌       | 1/4 [00:00<00:00,  7.24it/s] 75%|███████▌  | 3/4 [00:00<00:00, 12.59it/s] 75%|███████▌  | 3/4 [00:00<00:00,  9.58it/s]
2025-03-09 10:49:35,248 [INFO]: 	>>> Finished "Compute fast metrics" in 13.6018 secs
2025-03-09 10:49:35,249 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 42.3822 secs
2025-03-09 10:49:35,250 [INFO]: {
2025-03-09 10:49:35,250 [INFO]: 	index_key: HNSW15
2025-03-09 10:49:35,250 [INFO]: 	index_param: efSearch=274
2025-03-09 10:49:35,250 [INFO]: 	index_path: knn.index
2025-03-09 10:49:35,250 [INFO]: 	size in bytes: 567212410
2025-03-09 10:49:35,250 [INFO]: 	avg_search_speed_ms: 8.589134154532463
2025-03-09 10:49:35,250 [INFO]: 	99p_search_speed_ms: 11.327422137837853
2025-03-09 10:49:35,250 [INFO]: 	reconstruction error %: 0.0
2025-03-09 10:49:35,250 [INFO]: 	nb vectors: 2883
2025-03-09 10:49:35,250 [INFO]: 	vectors dimension: 49152
2025-03-09 10:49:35,250 [INFO]: 	compression ratio: 0.9993097012810421
2025-03-09 10:49:35,250 [INFO]: }
2025-03-09 10:49:35,250 [INFO]: 	>>> Finished "Creating the index" in 42.3839 secs
2025-03-09 10:49:35,250 [INFO]: >>> Finished "Launching the whole pipeline" in 42.4061 secs
2025-03-09 10:49:36: [retrieval_preprocessing] calculating distances ...
2025-03-09 10:49:36: [retrieval_preprocessing] finished and saved retrieval indices for episode 42117 [episode count 4/20]
[retrieval_preprocessing] for episode 14728 [episode count 5/20], we have num_retrieval=np.int64(2772) num_query=np.int64(242)
2025-03-09 10:49:36,782 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-09 10:49:37,098 [INFO]: Launching the whole pipeline 03/09/2025, 10:49:37
2025-03-09 10:49:37,098 [INFO]: Reading total number of vectors and dimension 03/09/2025, 10:49:37
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1833.17it/s]
2025-03-09 10:49:37,123 [INFO]: There are 2772 embeddings of dim 49152
2025-03-09 10:49:37,123 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0248 secs
2025-03-09 10:49:37,123 [INFO]: 	Compute estimated construction time of the index 03/09/2025, 10:49:37
2025-03-09 10:49:37,123 [INFO]: 		-> Train: 16.7 minutes
2025-03-09 10:49:37,123 [INFO]: 		-> Add: 1.5 seconds
2025-03-09 10:49:37,123 [INFO]: 		Total: 16.7 minutes
2025-03-09 10:49:37,124 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0001 secs
2025-03-09 10:49:37,124 [INFO]: 	Checking that your have enough memory available to create the index 03/09/2025, 10:49:37
2025-03-09 10:49:37,124 [INFO]: 572.1MB of memory will be needed to build the index (more might be used if you have more)
2025-03-09 10:49:37,124 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0001 secs
2025-03-09 10:49:37,124 [INFO]: 	Selecting most promising index types given data characteristics 03/09/2025, 10:49:37
2025-03-09 10:49:37,124 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-09 10:49:37,124 [INFO]: 	Creating the index 03/09/2025, 10:49:37
2025-03-09 10:49:37,124 [INFO]: 		-> Instanciate the index HNSW15 03/09/2025, 10:49:37
2025-03-09 10:49:37,125 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0012 secs
2025-03-09 10:49:37,125 [INFO]: 		-> Adding the vectors to the index 03/09/2025, 10:49:37
2025-03-09 10:49:37,125 [INFO]: The memory available for adding the vectors is 49.5GB(total available - used by the index)
2025-03-09 10:49:37,125 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/11 [00:00<?, ?it/s]  9%|▉         | 1/11 [00:00<00:01,  8.49it/s] 64%|██████▎   | 7/11 [00:00<00:00, 34.43it/s]100%|██████████| 11/11 [00:01<00:00,  4.80it/s]100%|██████████| 11/11 [00:01<00:00,  5.78it/s]
2025-03-09 10:49:39,035 [INFO]: 	Computing best hyperparameters for index knn.index 03/09/2025, 10:49:39
2025-03-09 10:50:03,313 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 24.2782 secs
2025-03-09 10:50:03,313 [INFO]: The best hyperparameters are: efSearch=290
2025-03-09 10:50:03,314 [INFO]: 	Compute fast metrics 03/09/2025, 10:50:03
  0%|          | 0/4 [00:00<?, ?it/s] 75%|███████▌  | 3/4 [00:00<00:00, 28.90it/s] 75%|███████▌  | 3/4 [00:00<00:00, 25.83it/s]
2025-03-09 10:50:16,907 [INFO]: 	>>> Finished "Compute fast metrics" in 13.5929 secs
2025-03-09 10:50:16,908 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 39.7828 secs
2025-03-09 10:50:16,908 [INFO]: {
2025-03-09 10:50:16,908 [INFO]: 	index_key: HNSW15
2025-03-09 10:50:16,908 [INFO]: 	index_param: efSearch=290
2025-03-09 10:50:16,908 [INFO]: 	index_path: knn.index
2025-03-09 10:50:16,908 [INFO]: 	size in bytes: 545373790
2025-03-09 10:50:16,908 [INFO]: 	avg_search_speed_ms: 8.829124873571446
2025-03-09 10:50:16,908 [INFO]: 	99p_search_speed_ms: 11.305220825597646
2025-03-09 10:50:16,908 [INFO]: 	reconstruction error %: 0.0
2025-03-09 10:50:16,908 [INFO]: 	nb vectors: 2772
2025-03-09 10:50:16,908 [INFO]: 	vectors dimension: 49152
2025-03-09 10:50:16,908 [INFO]: 	compression ratio: 0.999309805482218
2025-03-09 10:50:16,908 [INFO]: }
2025-03-09 10:50:16,908 [INFO]: 	>>> Finished "Creating the index" in 39.7845 secs
2025-03-09 10:50:16,908 [INFO]: >>> Finished "Launching the whole pipeline" in 39.8100 secs
2025-03-09 10:50:18: [retrieval_preprocessing] calculating distances ...
2025-03-09 10:50:18: [retrieval_preprocessing] finished and saved retrieval indices for episode 14728 [episode count 5/20]
[retrieval_preprocessing] for episode 49934 [episode count 6/20], we have num_retrieval=np.int64(2781) num_query=np.int64(233)
2025-03-09 10:50:19,123 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-09 10:50:19,424 [INFO]: Launching the whole pipeline 03/09/2025, 10:50:19
2025-03-09 10:50:19,424 [INFO]: Reading total number of vectors and dimension 03/09/2025, 10:50:19
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1628.86it/s]
2025-03-09 10:50:19,448 [INFO]: There are 2781 embeddings of dim 49152
2025-03-09 10:50:19,449 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0245 secs
2025-03-09 10:50:19,449 [INFO]: 	Compute estimated construction time of the index 03/09/2025, 10:50:19
2025-03-09 10:50:19,449 [INFO]: 		-> Train: 16.7 minutes
2025-03-09 10:50:19,449 [INFO]: 		-> Add: 1.5 seconds
2025-03-09 10:50:19,449 [INFO]: 		Total: 16.7 minutes
2025-03-09 10:50:19,449 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0001 secs
2025-03-09 10:50:19,449 [INFO]: 	Checking that your have enough memory available to create the index 03/09/2025, 10:50:19
2025-03-09 10:50:19,449 [INFO]: 573.9MB of memory will be needed to build the index (more might be used if you have more)
2025-03-09 10:50:19,449 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0001 secs
2025-03-09 10:50:19,449 [INFO]: 	Selecting most promising index types given data characteristics 03/09/2025, 10:50:19
2025-03-09 10:50:19,449 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-09 10:50:19,449 [INFO]: 	Creating the index 03/09/2025, 10:50:19
2025-03-09 10:50:19,449 [INFO]: 		-> Instanciate the index HNSW15 03/09/2025, 10:50:19
2025-03-09 10:50:19,450 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0010 secs
2025-03-09 10:50:19,450 [INFO]: 		-> Adding the vectors to the index 03/09/2025, 10:50:19
2025-03-09 10:50:19,450 [INFO]: The memory available for adding the vectors is 49.5GB(total available - used by the index)
2025-03-09 10:50:19,450 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/11 [00:00<?, ?it/s] 27%|██▋       | 3/11 [00:00<00:00, 27.08it/s] 82%|████████▏ | 9/11 [00:00<00:00, 42.82it/s]100%|██████████| 11/11 [00:01<00:00,  6.12it/s]
2025-03-09 10:50:21,253 [INFO]: 	Computing best hyperparameters for index knn.index 03/09/2025, 10:50:21
2025-03-09 10:50:45,759 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 24.5058 secs
2025-03-09 10:50:45,759 [INFO]: The best hyperparameters are: efSearch=270
2025-03-09 10:50:45,759 [INFO]: 	Compute fast metrics 03/09/2025, 10:50:45
  0%|          | 0/4 [00:00<?, ?it/s] 50%|█████     | 2/4 [00:00<00:00, 18.81it/s] 75%|███████▌  | 3/4 [00:00<00:00, 19.96it/s]
2025-03-09 10:50:59,211 [INFO]: 	>>> Finished "Compute fast metrics" in 13.4523 secs
2025-03-09 10:50:59,213 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 39.7626 secs
2025-03-09 10:50:59,213 [INFO]: {
2025-03-09 10:50:59,213 [INFO]: 	index_key: HNSW15
2025-03-09 10:50:59,213 [INFO]: 	index_param: efSearch=270
2025-03-09 10:50:59,213 [INFO]: 	index_path: knn.index
2025-03-09 10:50:59,213 [INFO]: 	size in bytes: 547144450
2025-03-09 10:50:59,213 [INFO]: 	avg_search_speed_ms: 9.159548868230738
2025-03-09 10:50:59,213 [INFO]: 	99p_search_speed_ms: 11.934892383869734
2025-03-09 10:50:59,213 [INFO]: 	reconstruction error %: 0.0
2025-03-09 10:50:59,213 [INFO]: 	nb vectors: 2781
2025-03-09 10:50:59,213 [INFO]: 	vectors dimension: 49152
2025-03-09 10:50:59,213 [INFO]: 	compression ratio: 0.9993098678054763
2025-03-09 10:50:59,213 [INFO]: }
2025-03-09 10:50:59,213 [INFO]: 	>>> Finished "Creating the index" in 39.7640 secs
2025-03-09 10:50:59,213 [INFO]: >>> Finished "Launching the whole pipeline" in 39.7890 secs
2025-03-09 10:51:00: [retrieval_preprocessing] calculating distances ...
2025-03-09 10:51:01: [retrieval_preprocessing] finished and saved retrieval indices for episode 49934 [episode count 6/20]
[retrieval_preprocessing] for episode 28175 [episode count 7/20], we have num_retrieval=np.int64(2905) num_query=np.int64(109)
2025-03-09 10:51:01,221 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-09 10:51:01,545 [INFO]: Launching the whole pipeline 03/09/2025, 10:51:01
2025-03-09 10:51:01,545 [INFO]: Reading total number of vectors and dimension 03/09/2025, 10:51:01
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 2361.66it/s]
2025-03-09 10:51:01,573 [INFO]: There are 2905 embeddings of dim 49152
2025-03-09 10:51:01,573 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0280 secs
2025-03-09 10:51:01,574 [INFO]: 	Compute estimated construction time of the index 03/09/2025, 10:51:01
2025-03-09 10:51:01,574 [INFO]: 		-> Train: 16.7 minutes
2025-03-09 10:51:01,574 [INFO]: 		-> Add: 1.6 seconds
2025-03-09 10:51:01,574 [INFO]: 		Total: 16.7 minutes
2025-03-09 10:51:01,574 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0003 secs
2025-03-09 10:51:01,574 [INFO]: 	Checking that your have enough memory available to create the index 03/09/2025, 10:51:01
2025-03-09 10:51:01,574 [INFO]: 599.5MB of memory will be needed to build the index (more might be used if you have more)
2025-03-09 10:51:01,574 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0004 secs
2025-03-09 10:51:01,574 [INFO]: 	Selecting most promising index types given data characteristics 03/09/2025, 10:51:01
2025-03-09 10:51:01,575 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-09 10:51:01,575 [INFO]: 	Creating the index 03/09/2025, 10:51:01
2025-03-09 10:51:01,575 [INFO]: 		-> Instanciate the index HNSW15 03/09/2025, 10:51:01
2025-03-09 10:51:01,578 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0025 secs
2025-03-09 10:51:01,578 [INFO]: 		-> Adding the vectors to the index 03/09/2025, 10:51:01
2025-03-09 10:51:01,578 [INFO]: The memory available for adding the vectors is 49.5GB(total available - used by the index)
2025-03-09 10:51:01,578 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/12 [00:00<?, ?it/s] 33%|███▎      | 4/12 [00:00<00:00, 36.02it/s]100%|██████████| 12/12 [00:01<00:00,  6.27it/s]100%|██████████| 12/12 [00:01<00:00,  6.82it/s]
2025-03-09 10:51:03,341 [INFO]: 	Computing best hyperparameters for index knn.index 03/09/2025, 10:51:03
2025-03-09 10:51:30,052 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 26.7104 secs
2025-03-09 10:51:30,053 [INFO]: The best hyperparameters are: efSearch=286
2025-03-09 10:51:30,053 [INFO]: 	Compute fast metrics 03/09/2025, 10:51:30
  0%|          | 0/4 [00:00<?, ?it/s] 75%|███████▌  | 3/4 [00:00<00:00, 28.73it/s] 75%|███████▌  | 3/4 [00:00<00:00, 25.64it/s]
2025-03-09 10:51:43,533 [INFO]: 	>>> Finished "Compute fast metrics" in 13.4801 secs
2025-03-09 10:51:43,534 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 41.9563 secs
2025-03-09 10:51:43,534 [INFO]: {
2025-03-09 10:51:43,534 [INFO]: 	index_key: HNSW15
2025-03-09 10:51:43,534 [INFO]: 	index_param: efSearch=286
2025-03-09 10:51:43,534 [INFO]: 	index_path: knn.index
2025-03-09 10:51:43,534 [INFO]: 	size in bytes: 571540690
2025-03-09 10:51:43,534 [INFO]: 	avg_search_speed_ms: 9.004763705810175
2025-03-09 10:51:43,534 [INFO]: 	99p_search_speed_ms: 12.551846564747397
2025-03-09 10:51:43,534 [INFO]: 	reconstruction error %: 0.0
2025-03-09 10:51:43,534 [INFO]: 	nb vectors: 2905
2025-03-09 10:51:43,534 [INFO]: 	vectors dimension: 49152
2025-03-09 10:51:43,534 [INFO]: 	compression ratio: 0.9993098479130156
2025-03-09 10:51:43,534 [INFO]: }
2025-03-09 10:51:43,534 [INFO]: 	>>> Finished "Creating the index" in 41.9594 secs
2025-03-09 10:51:43,534 [INFO]: >>> Finished "Launching the whole pipeline" in 41.9890 secs
2025-03-09 10:51:44: [retrieval_preprocessing] calculating distances ...
2025-03-09 10:51:44: [retrieval_preprocessing] finished and saved retrieval indices for episode 28175 [episode count 7/20]
[retrieval_preprocessing] for episode 17685 [episode count 8/20], we have num_retrieval=np.int64(2910) num_query=np.int64(104)
2025-03-09 10:51:44,569 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-09 10:51:44,885 [INFO]: Launching the whole pipeline 03/09/2025, 10:51:44
2025-03-09 10:51:44,885 [INFO]: Reading total number of vectors and dimension 03/09/2025, 10:51:44
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 2162.01it/s]
2025-03-09 10:51:44,910 [INFO]: There are 2910 embeddings of dim 49152
2025-03-09 10:51:44,910 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0255 secs
2025-03-09 10:51:44,911 [INFO]: 	Compute estimated construction time of the index 03/09/2025, 10:51:44
2025-03-09 10:51:44,911 [INFO]: 		-> Train: 16.7 minutes
2025-03-09 10:51:44,911 [INFO]: 		-> Add: 1.6 seconds
2025-03-09 10:51:44,911 [INFO]: 		Total: 16.7 minutes
2025-03-09 10:51:44,911 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0004 secs
2025-03-09 10:51:44,911 [INFO]: 	Checking that your have enough memory available to create the index 03/09/2025, 10:51:44
2025-03-09 10:51:44,911 [INFO]: 600.6MB of memory will be needed to build the index (more might be used if you have more)
2025-03-09 10:51:44,912 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0004 secs
2025-03-09 10:51:44,912 [INFO]: 	Selecting most promising index types given data characteristics 03/09/2025, 10:51:44
2025-03-09 10:51:44,912 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-09 10:51:44,912 [INFO]: 	Creating the index 03/09/2025, 10:51:44
2025-03-09 10:51:44,912 [INFO]: 		-> Instanciate the index HNSW15 03/09/2025, 10:51:44
2025-03-09 10:51:44,915 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0024 secs
2025-03-09 10:51:44,915 [INFO]: 		-> Adding the vectors to the index 03/09/2025, 10:51:44
2025-03-09 10:51:44,915 [INFO]: The memory available for adding the vectors is 49.5GB(total available - used by the index)
2025-03-09 10:51:44,915 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/12 [00:00<?, ?it/s] 25%|██▌       | 3/12 [00:00<00:00, 29.56it/s] 83%|████████▎ | 10/12 [00:00<00:00, 50.73it/s]100%|██████████| 12/12 [00:01<00:00,  6.34it/s]
2025-03-09 10:51:46,812 [INFO]: 	Computing best hyperparameters for index knn.index 03/09/2025, 10:51:46
2025-03-09 10:52:11,913 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 25.1001 secs
2025-03-09 10:52:11,913 [INFO]: The best hyperparameters are: efSearch=306
2025-03-09 10:52:11,913 [INFO]: 	Compute fast metrics 03/09/2025, 10:52:11
  0%|          | 0/4 [00:00<?, ?it/s] 50%|█████     | 2/4 [00:00<00:00, 19.86it/s] 75%|███████▌  | 3/4 [00:00<00:00, 23.03it/s]
2025-03-09 10:52:25,755 [INFO]: 	>>> Finished "Compute fast metrics" in 13.8421 secs
2025-03-09 10:52:25,757 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 40.8418 secs
2025-03-09 10:52:25,757 [INFO]: {
2025-03-09 10:52:25,757 [INFO]: 	index_key: HNSW15
2025-03-09 10:52:25,757 [INFO]: 	index_param: efSearch=306
2025-03-09 10:52:25,757 [INFO]: 	index_path: knn.index
2025-03-09 10:52:25,757 [INFO]: 	size in bytes: 572524390
2025-03-09 10:52:25,757 [INFO]: 	avg_search_speed_ms: 9.317158134541435
2025-03-09 10:52:25,757 [INFO]: 	99p_search_speed_ms: 11.719169931020588
2025-03-09 10:52:25,757 [INFO]: 	reconstruction error %: 0.0
2025-03-09 10:52:25,757 [INFO]: 	nb vectors: 2910
2025-03-09 10:52:25,757 [INFO]: 	vectors dimension: 49152
2025-03-09 10:52:25,757 [INFO]: 	compression ratio: 0.9993098809292649
2025-03-09 10:52:25,757 [INFO]: }
2025-03-09 10:52:25,757 [INFO]: 	>>> Finished "Creating the index" in 40.8450 secs
2025-03-09 10:52:25,757 [INFO]: >>> Finished "Launching the whole pipeline" in 40.8721 secs
2025-03-09 10:52:26: [retrieval_preprocessing] calculating distances ...
2025-03-09 10:52:26: [retrieval_preprocessing] finished and saved retrieval indices for episode 17685 [episode count 8/20]
[retrieval_preprocessing] for episode 68630 [episode count 9/20], we have num_retrieval=np.int64(2931) num_query=np.int64(83)
2025-03-09 10:52:26,892 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-09 10:52:27,209 [INFO]: Launching the whole pipeline 03/09/2025, 10:52:27
2025-03-09 10:52:27,209 [INFO]: Reading total number of vectors and dimension 03/09/2025, 10:52:27
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 2194.82it/s]
2025-03-09 10:52:27,236 [INFO]: There are 2931 embeddings of dim 49152
2025-03-09 10:52:27,236 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0270 secs
2025-03-09 10:52:27,236 [INFO]: 	Compute estimated construction time of the index 03/09/2025, 10:52:27
2025-03-09 10:52:27,236 [INFO]: 		-> Train: 16.7 minutes
2025-03-09 10:52:27,236 [INFO]: 		-> Add: 1.6 seconds
2025-03-09 10:52:27,236 [INFO]: 		Total: 16.7 minutes
2025-03-09 10:52:27,236 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0001 secs
2025-03-09 10:52:27,236 [INFO]: 	Checking that your have enough memory available to create the index 03/09/2025, 10:52:27
2025-03-09 10:52:27,236 [INFO]: 604.9MB of memory will be needed to build the index (more might be used if you have more)
2025-03-09 10:52:27,236 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0001 secs
2025-03-09 10:52:27,236 [INFO]: 	Selecting most promising index types given data characteristics 03/09/2025, 10:52:27
2025-03-09 10:52:27,236 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-09 10:52:27,236 [INFO]: 	Creating the index 03/09/2025, 10:52:27
2025-03-09 10:52:27,236 [INFO]: 		-> Instanciate the index HNSW15 03/09/2025, 10:52:27
2025-03-09 10:52:27,237 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0008 secs
2025-03-09 10:52:27,237 [INFO]: 		-> Adding the vectors to the index 03/09/2025, 10:52:27
2025-03-09 10:52:27,237 [INFO]: The memory available for adding the vectors is 49.5GB(total available - used by the index)
2025-03-09 10:52:27,237 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/12 [00:00<?, ?it/s] 17%|█▋        | 2/12 [00:00<00:00, 19.35it/s] 75%|███████▌  | 9/12 [00:00<00:00, 47.94it/s]100%|██████████| 12/12 [00:01<00:00,  6.14it/s]
2025-03-09 10:52:29,195 [INFO]: 	Computing best hyperparameters for index knn.index 03/09/2025, 10:52:29
2025-03-09 10:52:54,535 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 25.3394 secs
2025-03-09 10:52:54,535 [INFO]: The best hyperparameters are: efSearch=295
2025-03-09 10:52:54,535 [INFO]: 	Compute fast metrics 03/09/2025, 10:52:54
  0%|          | 0/4 [00:00<?, ?it/s] 75%|███████▌  | 3/4 [00:00<00:00, 28.43it/s] 75%|███████▌  | 3/4 [00:00<00:00, 25.54it/s]
2025-03-09 10:53:08,321 [INFO]: 	>>> Finished "Compute fast metrics" in 13.7858 secs
2025-03-09 10:53:08,322 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 41.0850 secs
2025-03-09 10:53:08,322 [INFO]: {
2025-03-09 10:53:08,322 [INFO]: 	index_key: HNSW15
2025-03-09 10:53:08,322 [INFO]: 	index_param: efSearch=295
2025-03-09 10:53:08,322 [INFO]: 	index_path: knn.index
2025-03-09 10:53:08,322 [INFO]: 	size in bytes: 576656050
2025-03-09 10:53:08,322 [INFO]: 	avg_search_speed_ms: 9.395536351424287
2025-03-09 10:53:08,323 [INFO]: 	99p_search_speed_ms: 12.667774325236676
2025-03-09 10:53:08,323 [INFO]: 	reconstruction error %: 0.0
2025-03-09 10:53:08,323 [INFO]: 	nb vectors: 2931
2025-03-09 10:53:08,323 [INFO]: 	vectors dimension: 49152
2025-03-09 10:53:08,323 [INFO]: 	compression ratio: 0.9993098104147178
2025-03-09 10:53:08,323 [INFO]: }
2025-03-09 10:53:08,323 [INFO]: 	>>> Finished "Creating the index" in 41.0862 secs
2025-03-09 10:53:08,323 [INFO]: >>> Finished "Launching the whole pipeline" in 41.1138 secs
2025-03-09 10:53:08: [retrieval_preprocessing] calculating distances ...
2025-03-09 10:53:09: [retrieval_preprocessing] finished and saved retrieval indices for episode 68630 [episode count 9/20]
[retrieval_preprocessing] for episode 1689 [episode count 10/20], we have num_retrieval=np.int64(2881) num_query=np.int64(133)
2025-03-09 10:53:09,207 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-09 10:53:09,521 [INFO]: Launching the whole pipeline 03/09/2025, 10:53:09
2025-03-09 10:53:09,521 [INFO]: Reading total number of vectors and dimension 03/09/2025, 10:53:09
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 2050.00it/s]
2025-03-09 10:53:09,546 [INFO]: There are 2881 embeddings of dim 49152
2025-03-09 10:53:09,546 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0249 secs
2025-03-09 10:53:09,546 [INFO]: 	Compute estimated construction time of the index 03/09/2025, 10:53:09
2025-03-09 10:53:09,546 [INFO]: 		-> Train: 16.7 minutes
2025-03-09 10:53:09,546 [INFO]: 		-> Add: 1.6 seconds
2025-03-09 10:53:09,546 [INFO]: 		Total: 16.7 minutes
2025-03-09 10:53:09,546 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0001 secs
2025-03-09 10:53:09,546 [INFO]: 	Checking that your have enough memory available to create the index 03/09/2025, 10:53:09
2025-03-09 10:53:09,546 [INFO]: 594.6MB of memory will be needed to build the index (more might be used if you have more)
2025-03-09 10:53:09,546 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0001 secs
2025-03-09 10:53:09,546 [INFO]: 	Selecting most promising index types given data characteristics 03/09/2025, 10:53:09
2025-03-09 10:53:09,546 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-09 10:53:09,546 [INFO]: 	Creating the index 03/09/2025, 10:53:09
2025-03-09 10:53:09,546 [INFO]: 		-> Instanciate the index HNSW15 03/09/2025, 10:53:09
2025-03-09 10:53:09,548 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0010 secs
2025-03-09 10:53:09,548 [INFO]: 		-> Adding the vectors to the index 03/09/2025, 10:53:09
2025-03-09 10:53:09,548 [INFO]: The memory available for adding the vectors is 49.5GB(total available - used by the index)
2025-03-09 10:53:09,548 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/12 [00:00<?, ?it/s] 17%|█▋        | 2/12 [00:00<00:00, 19.84it/s] 67%|██████▋   | 8/12 [00:00<00:00, 39.57it/s]100%|██████████| 12/12 [00:01<00:00,  5.24it/s]100%|██████████| 12/12 [00:01<00:00,  6.52it/s]
2025-03-09 10:53:11,391 [INFO]: 	Computing best hyperparameters for index knn.index 03/09/2025, 10:53:11
2025-03-09 10:53:36,749 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 25.3578 secs
2025-03-09 10:53:36,749 [INFO]: The best hyperparameters are: efSearch=307
2025-03-09 10:53:36,749 [INFO]: 	Compute fast metrics 03/09/2025, 10:53:36
  0%|          | 0/4 [00:00<?, ?it/s] 75%|███████▌  | 3/4 [00:00<00:00, 28.45it/s] 75%|███████▌  | 3/4 [00:00<00:00, 25.57it/s]
2025-03-09 10:53:50,381 [INFO]: 	>>> Finished "Compute fast metrics" in 13.6321 secs
2025-03-09 10:53:50,383 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 40.8349 secs
2025-03-09 10:53:50,383 [INFO]: {
2025-03-09 10:53:50,383 [INFO]: 	index_key: HNSW15
2025-03-09 10:53:50,383 [INFO]: 	index_param: efSearch=307
2025-03-09 10:53:50,383 [INFO]: 	index_path: knn.index
2025-03-09 10:53:50,383 [INFO]: 	size in bytes: 566818930
2025-03-09 10:53:50,383 [INFO]: 	avg_search_speed_ms: 9.423431652517403
2025-03-09 10:53:50,383 [INFO]: 	99p_search_speed_ms: 11.651677389163527
2025-03-09 10:53:50,383 [INFO]: 	reconstruction error %: 0.0
2025-03-09 10:53:50,383 [INFO]: 	nb vectors: 2881
2025-03-09 10:53:50,383 [INFO]: 	vectors dimension: 49152
2025-03-09 10:53:50,383 [INFO]: 	compression ratio: 0.9993096878398187
2025-03-09 10:53:50,383 [INFO]: }
2025-03-09 10:53:50,383 [INFO]: 	>>> Finished "Creating the index" in 40.8364 secs
2025-03-09 10:53:50,383 [INFO]: >>> Finished "Launching the whole pipeline" in 40.8620 secs
2025-03-09 10:53:51: [retrieval_preprocessing] calculating distances ...
2025-03-09 10:53:51: [retrieval_preprocessing] finished and saved retrieval indices for episode 1689 [episode count 10/20]
[retrieval_preprocessing] for episode 46361 [episode count 11/20], we have num_retrieval=np.int64(2866) num_query=np.int64(148)
2025-03-09 10:53:51,718 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-09 10:53:52,028 [INFO]: Launching the whole pipeline 03/09/2025, 10:53:52
2025-03-09 10:53:52,028 [INFO]: Reading total number of vectors and dimension 03/09/2025, 10:53:52
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 2508.56it/s]
2025-03-09 10:53:52,052 [INFO]: There are 2866 embeddings of dim 49152
2025-03-09 10:53:52,052 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0238 secs
2025-03-09 10:53:52,052 [INFO]: 	Compute estimated construction time of the index 03/09/2025, 10:53:52
2025-03-09 10:53:52,052 [INFO]: 		-> Train: 16.7 minutes
2025-03-09 10:53:52,052 [INFO]: 		-> Add: 1.6 seconds
2025-03-09 10:53:52,052 [INFO]: 		Total: 16.7 minutes
2025-03-09 10:53:52,052 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0001 secs
2025-03-09 10:53:52,052 [INFO]: 	Checking that your have enough memory available to create the index 03/09/2025, 10:53:52
2025-03-09 10:53:52,052 [INFO]: 591.5MB of memory will be needed to build the index (more might be used if you have more)
2025-03-09 10:53:52,052 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0001 secs
2025-03-09 10:53:52,052 [INFO]: 	Selecting most promising index types given data characteristics 03/09/2025, 10:53:52
2025-03-09 10:53:52,052 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-09 10:53:52,052 [INFO]: 	Creating the index 03/09/2025, 10:53:52
2025-03-09 10:53:52,052 [INFO]: 		-> Instanciate the index HNSW15 03/09/2025, 10:53:52
2025-03-09 10:53:52,054 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0010 secs
2025-03-09 10:53:52,054 [INFO]: 		-> Adding the vectors to the index 03/09/2025, 10:53:52
2025-03-09 10:53:52,054 [INFO]: The memory available for adding the vectors is 49.5GB(total available - used by the index)
2025-03-09 10:53:52,054 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/12 [00:00<?, ?it/s] 25%|██▌       | 3/12 [00:00<00:00, 29.05it/s]100%|██████████| 12/12 [00:01<00:00,  6.57it/s]100%|██████████| 12/12 [00:01<00:00,  6.97it/s]
2025-03-09 10:53:53,778 [INFO]: 	Computing best hyperparameters for index knn.index 03/09/2025, 10:53:53
2025-03-09 10:54:19,029 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 25.2501 secs
2025-03-09 10:54:19,029 [INFO]: The best hyperparameters are: efSearch=287
2025-03-09 10:54:19,029 [INFO]: 	Compute fast metrics 03/09/2025, 10:54:19
  0%|          | 0/4 [00:00<?, ?it/s] 75%|███████▌  | 3/4 [00:00<00:00, 26.55it/s] 75%|███████▌  | 3/4 [00:00<00:00, 22.76it/s]
2025-03-09 10:54:33,030 [INFO]: 	>>> Finished "Compute fast metrics" in 14.0006 secs
2025-03-09 10:54:33,031 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 40.9775 secs
2025-03-09 10:54:33,031 [INFO]: {
2025-03-09 10:54:33,031 [INFO]: 	index_key: HNSW15
2025-03-09 10:54:33,031 [INFO]: 	index_param: efSearch=287
2025-03-09 10:54:33,031 [INFO]: 	index_path: knn.index
2025-03-09 10:54:33,031 [INFO]: 	size in bytes: 563867770
2025-03-09 10:54:33,031 [INFO]: 	avg_search_speed_ms: 9.432884332073748
2025-03-09 10:54:33,031 [INFO]: 	99p_search_speed_ms: 12.4592301202938
2025-03-09 10:54:33,031 [INFO]: 	reconstruction error %: 0.0
2025-03-09 10:54:33,031 [INFO]: 	nb vectors: 2866
2025-03-09 10:54:33,031 [INFO]: 	vectors dimension: 49152
2025-03-09 10:54:33,031 [INFO]: 	compression ratio: 0.9993096927671535
2025-03-09 10:54:33,031 [INFO]: }
2025-03-09 10:54:33,031 [INFO]: 	>>> Finished "Creating the index" in 40.9790 secs
2025-03-09 10:54:33,031 [INFO]: >>> Finished "Launching the whole pipeline" in 41.0035 secs
2025-03-09 10:54:33: [retrieval_preprocessing] calculating distances ...
2025-03-09 10:54:34: [retrieval_preprocessing] finished and saved retrieval indices for episode 46361 [episode count 11/20]
[retrieval_preprocessing] for episode 39074 [episode count 12/20], we have num_retrieval=np.int64(2710) num_query=np.int64(304)
2025-03-09 10:54:34,280 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-09 10:54:34,573 [INFO]: Launching the whole pipeline 03/09/2025, 10:54:34
2025-03-09 10:54:34,573 [INFO]: Reading total number of vectors and dimension 03/09/2025, 10:54:34
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 2136.68it/s]
2025-03-09 10:54:34,597 [INFO]: There are 2710 embeddings of dim 49152
2025-03-09 10:54:34,598 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0246 secs
2025-03-09 10:54:34,598 [INFO]: 	Compute estimated construction time of the index 03/09/2025, 10:54:34
2025-03-09 10:54:34,598 [INFO]: 		-> Train: 16.7 minutes
2025-03-09 10:54:34,598 [INFO]: 		-> Add: 1.5 seconds
2025-03-09 10:54:34,598 [INFO]: 		Total: 16.7 minutes
2025-03-09 10:54:34,598 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0001 secs
2025-03-09 10:54:34,598 [INFO]: 	Checking that your have enough memory available to create the index 03/09/2025, 10:54:34
2025-03-09 10:54:34,598 [INFO]: 559.3MB of memory will be needed to build the index (more might be used if you have more)
2025-03-09 10:54:34,598 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0001 secs
2025-03-09 10:54:34,598 [INFO]: 	Selecting most promising index types given data characteristics 03/09/2025, 10:54:34
2025-03-09 10:54:34,598 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-09 10:54:34,598 [INFO]: 	Creating the index 03/09/2025, 10:54:34
2025-03-09 10:54:34,598 [INFO]: 		-> Instanciate the index HNSW15 03/09/2025, 10:54:34
2025-03-09 10:54:34,599 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0009 secs
2025-03-09 10:54:34,599 [INFO]: 		-> Adding the vectors to the index 03/09/2025, 10:54:34
2025-03-09 10:54:34,599 [INFO]: The memory available for adding the vectors is 49.5GB(total available - used by the index)
2025-03-09 10:54:34,599 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/11 [00:00<?, ?it/s] 27%|██▋       | 3/11 [00:00<00:00, 26.94it/s]100%|██████████| 11/11 [00:01<00:00,  6.19it/s]100%|██████████| 11/11 [00:01<00:00,  6.60it/s]
2025-03-09 10:54:36,269 [INFO]: 	Computing best hyperparameters for index knn.index 03/09/2025, 10:54:36
2025-03-09 10:55:00,405 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 24.1355 secs
2025-03-09 10:55:00,405 [INFO]: The best hyperparameters are: efSearch=303
2025-03-09 10:55:00,405 [INFO]: 	Compute fast metrics 03/09/2025, 10:55:00
  0%|          | 0/4 [00:00<?, ?it/s] 75%|███████▌  | 3/4 [00:00<00:00, 27.02it/s] 75%|███████▌  | 3/4 [00:00<00:00, 24.08it/s]
2025-03-09 10:55:13,821 [INFO]: 	>>> Finished "Compute fast metrics" in 13.4162 secs
2025-03-09 10:55:13,822 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 39.2231 secs
2025-03-09 10:55:13,822 [INFO]: {
2025-03-09 10:55:13,822 [INFO]: 	index_key: HNSW15
2025-03-09 10:55:13,822 [INFO]: 	index_param: efSearch=303
2025-03-09 10:55:13,822 [INFO]: 	index_path: knn.index
2025-03-09 10:55:13,822 [INFO]: 	size in bytes: 533175730
2025-03-09 10:55:13,822 [INFO]: 	avg_search_speed_ms: 9.212516471837917
2025-03-09 10:55:13,822 [INFO]: 	99p_search_speed_ms: 11.317128140944988
2025-03-09 10:55:13,822 [INFO]: 	reconstruction error %: 0.0
2025-03-09 10:55:13,822 [INFO]: 	nb vectors: 2710
2025-03-09 10:55:13,822 [INFO]: 	vectors dimension: 49152
2025-03-09 10:55:13,822 [INFO]: 	compression ratio: 0.9993097022627042
2025-03-09 10:55:13,822 [INFO]: }
2025-03-09 10:55:13,822 [INFO]: 	>>> Finished "Creating the index" in 39.2244 secs
2025-03-09 10:55:13,822 [INFO]: >>> Finished "Launching the whole pipeline" in 39.2495 secs
2025-03-09 10:55:15: [retrieval_preprocessing] calculating distances ...
2025-03-09 10:55:16: [retrieval_preprocessing] finished and saved retrieval indices for episode 39074 [episode count 12/20]
[retrieval_preprocessing] for episode 14761 [episode count 13/20], we have num_retrieval=np.int64(2920) num_query=np.int64(94)
2025-03-09 10:55:16,601 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-09 10:55:16,917 [INFO]: Launching the whole pipeline 03/09/2025, 10:55:16
2025-03-09 10:55:16,917 [INFO]: Reading total number of vectors and dimension 03/09/2025, 10:55:16
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 2483.31it/s]
2025-03-09 10:55:16,944 [INFO]: There are 2920 embeddings of dim 49152
2025-03-09 10:55:16,944 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0271 secs
2025-03-09 10:55:16,944 [INFO]: 	Compute estimated construction time of the index 03/09/2025, 10:55:16
2025-03-09 10:55:16,944 [INFO]: 		-> Train: 16.7 minutes
2025-03-09 10:55:16,944 [INFO]: 		-> Add: 1.6 seconds
2025-03-09 10:55:16,944 [INFO]: 		Total: 16.7 minutes
2025-03-09 10:55:16,944 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0003 secs
2025-03-09 10:55:16,945 [INFO]: 	Checking that your have enough memory available to create the index 03/09/2025, 10:55:16
2025-03-09 10:55:16,945 [INFO]: 602.6MB of memory will be needed to build the index (more might be used if you have more)
2025-03-09 10:55:16,945 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0004 secs
2025-03-09 10:55:16,945 [INFO]: 	Selecting most promising index types given data characteristics 03/09/2025, 10:55:16
2025-03-09 10:55:16,945 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-09 10:55:16,945 [INFO]: 	Creating the index 03/09/2025, 10:55:16
2025-03-09 10:55:16,945 [INFO]: 		-> Instanciate the index HNSW15 03/09/2025, 10:55:16
2025-03-09 10:55:16,948 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0022 secs
2025-03-09 10:55:16,948 [INFO]: 		-> Adding the vectors to the index 03/09/2025, 10:55:16
2025-03-09 10:55:16,948 [INFO]: The memory available for adding the vectors is 49.5GB(total available - used by the index)
2025-03-09 10:55:16,948 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/12 [00:00<?, ?it/s] 17%|█▋        | 2/12 [00:00<00:00, 19.12it/s] 67%|██████▋   | 8/12 [00:00<00:00, 41.60it/s]100%|██████████| 12/12 [00:01<00:00,  6.27it/s]
2025-03-09 10:55:18,867 [INFO]: 	Computing best hyperparameters for index knn.index 03/09/2025, 10:55:18
2025-03-09 10:55:44,428 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 25.5606 secs
2025-03-09 10:55:44,428 [INFO]: The best hyperparameters are: efSearch=297
2025-03-09 10:55:44,428 [INFO]: 	Compute fast metrics 03/09/2025, 10:55:44
  0%|          | 0/4 [00:00<?, ?it/s] 50%|█████     | 2/4 [00:00<00:00, 18.92it/s] 75%|███████▌  | 3/4 [00:00<00:00, 20.60it/s]
2025-03-09 10:55:58,172 [INFO]: 	>>> Finished "Compute fast metrics" in 13.7445 secs
2025-03-09 10:55:58,174 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 41.2259 secs
2025-03-09 10:55:58,174 [INFO]: {
2025-03-09 10:55:58,174 [INFO]: 	index_key: HNSW15
2025-03-09 10:55:58,174 [INFO]: 	index_param: efSearch=297
2025-03-09 10:55:58,174 [INFO]: 	index_path: knn.index
2025-03-09 10:55:58,174 [INFO]: 	size in bytes: 574491850
2025-03-09 10:55:58,174 [INFO]: 	avg_search_speed_ms: 9.397897308060367
2025-03-09 10:55:58,174 [INFO]: 	99p_search_speed_ms: 12.842723876237867
2025-03-09 10:55:58,174 [INFO]: 	reconstruction error %: 0.0
2025-03-09 10:55:58,174 [INFO]: 	nb vectors: 2920
2025-03-09 10:55:58,174 [INFO]: 	vectors dimension: 49152
2025-03-09 10:55:58,174 [INFO]: 	compression ratio: 0.9993098422545071
2025-03-09 10:55:58,174 [INFO]: }
2025-03-09 10:55:58,174 [INFO]: 	>>> Finished "Creating the index" in 41.2287 secs
2025-03-09 10:55:58,174 [INFO]: >>> Finished "Launching the whole pipeline" in 41.2571 secs
2025-03-09 10:55:58: [retrieval_preprocessing] calculating distances ...
2025-03-09 10:55:59: [retrieval_preprocessing] finished and saved retrieval indices for episode 14761 [episode count 13/20]
[retrieval_preprocessing] for episode 20139 [episode count 14/20], we have num_retrieval=np.int64(2876) num_query=np.int64(138)
2025-03-09 10:55:59,169 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-09 10:55:59,477 [INFO]: Launching the whole pipeline 03/09/2025, 10:55:59
2025-03-09 10:55:59,477 [INFO]: Reading total number of vectors and dimension 03/09/2025, 10:55:59
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 2628.01it/s]
2025-03-09 10:55:59,504 [INFO]: There are 2876 embeddings of dim 49152
2025-03-09 10:55:59,504 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0264 secs
2025-03-09 10:55:59,504 [INFO]: 	Compute estimated construction time of the index 03/09/2025, 10:55:59
2025-03-09 10:55:59,504 [INFO]: 		-> Train: 16.7 minutes
2025-03-09 10:55:59,504 [INFO]: 		-> Add: 1.6 seconds
2025-03-09 10:55:59,504 [INFO]: 		Total: 16.7 minutes
2025-03-09 10:55:59,504 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0001 secs
2025-03-09 10:55:59,504 [INFO]: 	Checking that your have enough memory available to create the index 03/09/2025, 10:55:59
2025-03-09 10:55:59,504 [INFO]: 593.5MB of memory will be needed to build the index (more might be used if you have more)
2025-03-09 10:55:59,504 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0001 secs
2025-03-09 10:55:59,504 [INFO]: 	Selecting most promising index types given data characteristics 03/09/2025, 10:55:59
2025-03-09 10:55:59,504 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-09 10:55:59,504 [INFO]: 	Creating the index 03/09/2025, 10:55:59
2025-03-09 10:55:59,504 [INFO]: 		-> Instanciate the index HNSW15 03/09/2025, 10:55:59
2025-03-09 10:55:59,505 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0008 secs
2025-03-09 10:55:59,505 [INFO]: 		-> Adding the vectors to the index 03/09/2025, 10:55:59
2025-03-09 10:55:59,505 [INFO]: The memory available for adding the vectors is 49.5GB(total available - used by the index)
2025-03-09 10:55:59,505 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/12 [00:00<?, ?it/s] 17%|█▋        | 2/12 [00:00<00:00, 18.72it/s] 92%|█████████▏| 11/12 [00:00<00:00, 57.17it/s]100%|██████████| 12/12 [00:01<00:00,  6.82it/s]
2025-03-09 10:56:01,269 [INFO]: 	Computing best hyperparameters for index knn.index 03/09/2025, 10:56:01
2025-03-09 10:56:27,311 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 26.0417 secs
2025-03-09 10:56:27,311 [INFO]: The best hyperparameters are: efSearch=293
2025-03-09 10:56:27,311 [INFO]: 	Compute fast metrics 03/09/2025, 10:56:27
  0%|          | 0/4 [00:00<?, ?it/s] 50%|█████     | 2/4 [00:00<00:00, 17.61it/s] 75%|███████▌  | 3/4 [00:00<00:00, 18.49it/s]
2025-03-09 10:56:40,835 [INFO]: 	>>> Finished "Compute fast metrics" in 13.5236 secs
2025-03-09 10:56:40,836 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 41.3308 secs
2025-03-09 10:56:40,836 [INFO]: {
2025-03-09 10:56:40,836 [INFO]: 	index_key: HNSW15
2025-03-09 10:56:40,836 [INFO]: 	index_param: efSearch=293
2025-03-09 10:56:40,836 [INFO]: 	index_path: knn.index
2025-03-09 10:56:40,836 [INFO]: 	size in bytes: 565835170
2025-03-09 10:56:40,836 [INFO]: 	avg_search_speed_ms: 9.252566970440247
2025-03-09 10:56:40,836 [INFO]: 	99p_search_speed_ms: 12.500192550942304
2025-03-09 10:56:40,836 [INFO]: 	reconstruction error %: 0.0
2025-03-09 10:56:40,836 [INFO]: 	nb vectors: 2876
2025-03-09 10:56:40,836 [INFO]: 	vectors dimension: 49152
2025-03-09 10:56:40,836 [INFO]: 	compression ratio: 0.9993097601197183
2025-03-09 10:56:40,836 [INFO]: }
2025-03-09 10:56:40,836 [INFO]: 	>>> Finished "Creating the index" in 41.3320 secs
2025-03-09 10:56:40,836 [INFO]: >>> Finished "Launching the whole pipeline" in 41.3588 secs
2025-03-09 10:56:41: [retrieval_preprocessing] calculating distances ...
2025-03-09 10:56:42: [retrieval_preprocessing] finished and saved retrieval indices for episode 20139 [episode count 14/20]
[retrieval_preprocessing] for episode 48556 [episode count 15/20], we have num_retrieval=np.int64(2930) num_query=np.int64(84)
2025-03-09 10:56:42,245 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-09 10:56:42,562 [INFO]: Launching the whole pipeline 03/09/2025, 10:56:42
2025-03-09 10:56:42,562 [INFO]: Reading total number of vectors and dimension 03/09/2025, 10:56:42
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 2428.66it/s]
2025-03-09 10:56:42,588 [INFO]: There are 2930 embeddings of dim 49152
2025-03-09 10:56:42,589 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0266 secs
2025-03-09 10:56:42,589 [INFO]: 	Compute estimated construction time of the index 03/09/2025, 10:56:42
2025-03-09 10:56:42,589 [INFO]: 		-> Train: 16.7 minutes
2025-03-09 10:56:42,589 [INFO]: 		-> Add: 1.6 seconds
2025-03-09 10:56:42,589 [INFO]: 		Total: 16.7 minutes
2025-03-09 10:56:42,589 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0001 secs
2025-03-09 10:56:42,589 [INFO]: 	Checking that your have enough memory available to create the index 03/09/2025, 10:56:42
2025-03-09 10:56:42,589 [INFO]: 604.7MB of memory will be needed to build the index (more might be used if you have more)
2025-03-09 10:56:42,589 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0001 secs
2025-03-09 10:56:42,589 [INFO]: 	Selecting most promising index types given data characteristics 03/09/2025, 10:56:42
2025-03-09 10:56:42,589 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-09 10:56:42,589 [INFO]: 	Creating the index 03/09/2025, 10:56:42
2025-03-09 10:56:42,589 [INFO]: 		-> Instanciate the index HNSW15 03/09/2025, 10:56:42
2025-03-09 10:56:42,590 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0011 secs
2025-03-09 10:56:42,590 [INFO]: 		-> Adding the vectors to the index 03/09/2025, 10:56:42
2025-03-09 10:56:42,590 [INFO]: The memory available for adding the vectors is 49.5GB(total available - used by the index)
2025-03-09 10:56:42,590 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/12 [00:00<?, ?it/s] 25%|██▌       | 3/12 [00:00<00:00, 26.63it/s] 83%|████████▎ | 10/12 [00:00<00:00, 49.06it/s]100%|██████████| 12/12 [00:01<00:00,  6.15it/s]
2025-03-09 10:56:44,545 [INFO]: 	Computing best hyperparameters for index knn.index 03/09/2025, 10:56:44
2025-03-09 10:57:09,704 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 25.1588 secs
2025-03-09 10:57:09,704 [INFO]: The best hyperparameters are: efSearch=294
2025-03-09 10:57:09,704 [INFO]: 	Compute fast metrics 03/09/2025, 10:57:09
  0%|          | 0/4 [00:00<?, ?it/s] 75%|███████▌  | 3/4 [00:00<00:00, 27.83it/s] 75%|███████▌  | 3/4 [00:00<00:00, 24.89it/s]
2025-03-09 10:57:23,232 [INFO]: 	>>> Finished "Compute fast metrics" in 13.5271 secs
2025-03-09 10:57:23,233 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 40.6427 secs
2025-03-09 10:57:23,233 [INFO]: {
2025-03-09 10:57:23,233 [INFO]: 	index_key: HNSW15
2025-03-09 10:57:23,233 [INFO]: 	index_param: efSearch=294
2025-03-09 10:57:23,233 [INFO]: 	index_path: knn.index
2025-03-09 10:57:23,233 [INFO]: 	size in bytes: 576459310
2025-03-09 10:57:23,233 [INFO]: 	avg_search_speed_ms: 9.013464430825332
2025-03-09 10:57:23,233 [INFO]: 	99p_search_speed_ms: 11.451049386523666
2025-03-09 10:57:23,233 [INFO]: 	reconstruction error %: 0.0
2025-03-09 10:57:23,233 [INFO]: 	nb vectors: 2930
2025-03-09 10:57:23,233 [INFO]: 	vectors dimension: 49152
2025-03-09 10:57:23,233 [INFO]: 	compression ratio: 0.999309803843744
2025-03-09 10:57:23,233 [INFO]: }
2025-03-09 10:57:23,233 [INFO]: 	>>> Finished "Creating the index" in 40.6442 secs
2025-03-09 10:57:23,233 [INFO]: >>> Finished "Launching the whole pipeline" in 40.6714 secs
2025-03-09 10:57:23: [retrieval_preprocessing] calculating distances ...
2025-03-09 10:57:23: [retrieval_preprocessing] finished and saved retrieval indices for episode 48556 [episode count 15/20]
[retrieval_preprocessing] for episode 40752 [episode count 16/20], we have num_retrieval=np.int64(2896) num_query=np.int64(118)
2025-03-09 10:57:24,142 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-09 10:57:24,457 [INFO]: Launching the whole pipeline 03/09/2025, 10:57:24
2025-03-09 10:57:24,457 [INFO]: Reading total number of vectors and dimension 03/09/2025, 10:57:24
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 2666.44it/s]
2025-03-09 10:57:24,480 [INFO]: There are 2896 embeddings of dim 49152
2025-03-09 10:57:24,480 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0231 secs
2025-03-09 10:57:24,480 [INFO]: 	Compute estimated construction time of the index 03/09/2025, 10:57:24
2025-03-09 10:57:24,480 [INFO]: 		-> Train: 16.7 minutes
2025-03-09 10:57:24,480 [INFO]: 		-> Add: 1.6 seconds
2025-03-09 10:57:24,480 [INFO]: 		Total: 16.7 minutes
2025-03-09 10:57:24,480 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0001 secs
2025-03-09 10:57:24,480 [INFO]: 	Checking that your have enough memory available to create the index 03/09/2025, 10:57:24
2025-03-09 10:57:24,480 [INFO]: 597.7MB of memory will be needed to build the index (more might be used if you have more)
2025-03-09 10:57:24,480 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0001 secs
2025-03-09 10:57:24,480 [INFO]: 	Selecting most promising index types given data characteristics 03/09/2025, 10:57:24
2025-03-09 10:57:24,480 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-09 10:57:24,480 [INFO]: 	Creating the index 03/09/2025, 10:57:24
2025-03-09 10:57:24,480 [INFO]: 		-> Instanciate the index HNSW15 03/09/2025, 10:57:24
2025-03-09 10:57:24,481 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0008 secs
2025-03-09 10:57:24,481 [INFO]: 		-> Adding the vectors to the index 03/09/2025, 10:57:24
2025-03-09 10:57:24,481 [INFO]: The memory available for adding the vectors is 49.5GB(total available - used by the index)
2025-03-09 10:57:24,481 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/12 [00:00<?, ?it/s] 25%|██▌       | 3/12 [00:00<00:00, 27.28it/s] 83%|████████▎ | 10/12 [00:00<00:00, 49.15it/s]100%|██████████| 12/12 [00:01<00:00,  6.32it/s]
2025-03-09 10:57:26,382 [INFO]: 	Computing best hyperparameters for index knn.index 03/09/2025, 10:57:26
2025-03-09 10:57:51,784 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 25.4012 secs
2025-03-09 10:57:51,785 [INFO]: The best hyperparameters are: efSearch=298
2025-03-09 10:57:51,785 [INFO]: 	Compute fast metrics 03/09/2025, 10:57:51
  0%|          | 0/4 [00:00<?, ?it/s] 75%|███████▌  | 3/4 [00:00<00:00, 28.63it/s] 75%|███████▌  | 3/4 [00:00<00:00, 25.46it/s]
2025-03-09 10:58:05,507 [INFO]: 	>>> Finished "Compute fast metrics" in 13.7225 secs
2025-03-09 10:58:05,509 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 41.0273 secs
2025-03-09 10:58:05,509 [INFO]: {
2025-03-09 10:58:05,509 [INFO]: 	index_key: HNSW15
2025-03-09 10:58:05,509 [INFO]: 	index_param: efSearch=298
2025-03-09 10:58:05,509 [INFO]: 	index_path: knn.index
2025-03-09 10:58:05,509 [INFO]: 	size in bytes: 569770030
2025-03-09 10:58:05,509 [INFO]: 	avg_search_speed_ms: 9.058340039463593
2025-03-09 10:58:05,509 [INFO]: 	99p_search_speed_ms: 11.45228056702763
2025-03-09 10:58:05,509 [INFO]: 	reconstruction error %: 0.0
2025-03-09 10:58:05,509 [INFO]: 	nb vectors: 2896
2025-03-09 10:58:05,509 [INFO]: 	vectors dimension: 49152
2025-03-09 10:58:05,509 [INFO]: 	compression ratio: 0.9993097881964764
2025-03-09 10:58:05,509 [INFO]: }
2025-03-09 10:58:05,509 [INFO]: 	>>> Finished "Creating the index" in 41.0286 secs
2025-03-09 10:58:05,509 [INFO]: >>> Finished "Launching the whole pipeline" in 41.0522 secs
2025-03-09 10:58:06: [retrieval_preprocessing] calculating distances ...
2025-03-09 10:58:06: [retrieval_preprocessing] finished and saved retrieval indices for episode 40752 [episode count 16/20]
[retrieval_preprocessing] for episode 84401 [episode count 17/20], we have num_retrieval=np.int64(2775) num_query=np.int64(239)
2025-03-09 10:58:06,809 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-09 10:58:07,108 [INFO]: Launching the whole pipeline 03/09/2025, 10:58:07
2025-03-09 10:58:07,108 [INFO]: Reading total number of vectors and dimension 03/09/2025, 10:58:07
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1923.11it/s]
2025-03-09 10:58:07,135 [INFO]: There are 2775 embeddings of dim 49152
2025-03-09 10:58:07,136 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0272 secs
2025-03-09 10:58:07,136 [INFO]: 	Compute estimated construction time of the index 03/09/2025, 10:58:07
2025-03-09 10:58:07,136 [INFO]: 		-> Train: 16.7 minutes
2025-03-09 10:58:07,136 [INFO]: 		-> Add: 1.5 seconds
2025-03-09 10:58:07,136 [INFO]: 		Total: 16.7 minutes
2025-03-09 10:58:07,136 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0004 secs
2025-03-09 10:58:07,136 [INFO]: 	Checking that your have enough memory available to create the index 03/09/2025, 10:58:07
2025-03-09 10:58:07,136 [INFO]: 572.7MB of memory will be needed to build the index (more might be used if you have more)
2025-03-09 10:58:07,137 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0004 secs
2025-03-09 10:58:07,137 [INFO]: 	Selecting most promising index types given data characteristics 03/09/2025, 10:58:07
2025-03-09 10:58:07,137 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-09 10:58:07,137 [INFO]: 	Creating the index 03/09/2025, 10:58:07
2025-03-09 10:58:07,137 [INFO]: 		-> Instanciate the index HNSW15 03/09/2025, 10:58:07
2025-03-09 10:58:07,139 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0023 secs
2025-03-09 10:58:07,140 [INFO]: 		-> Adding the vectors to the index 03/09/2025, 10:58:07
2025-03-09 10:58:07,140 [INFO]: The memory available for adding the vectors is 49.5GB(total available - used by the index)
2025-03-09 10:58:07,140 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/11 [00:00<?, ?it/s] 36%|███▋      | 4/11 [00:00<00:00, 36.32it/s]100%|██████████| 11/11 [00:01<00:00,  5.81it/s]100%|██████████| 11/11 [00:01<00:00,  6.39it/s]
2025-03-09 10:58:08,866 [INFO]: 	Computing best hyperparameters for index knn.index 03/09/2025, 10:58:08
2025-03-09 10:58:33,970 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 25.1040 secs
2025-03-09 10:58:33,970 [INFO]: The best hyperparameters are: efSearch=276
2025-03-09 10:58:33,970 [INFO]: 	Compute fast metrics 03/09/2025, 10:58:33
  0%|          | 0/4 [00:00<?, ?it/s] 75%|███████▌  | 3/4 [00:00<00:00, 27.04it/s] 75%|███████▌  | 3/4 [00:00<00:00, 24.30it/s]
2025-03-09 10:58:46,857 [INFO]: 	>>> Finished "Compute fast metrics" in 12.8869 secs
2025-03-09 10:58:46,859 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 39.7191 secs
2025-03-09 10:58:46,859 [INFO]: {
2025-03-09 10:58:46,859 [INFO]: 	index_key: HNSW15
2025-03-09 10:58:46,859 [INFO]: 	index_param: efSearch=276
2025-03-09 10:58:46,859 [INFO]: 	index_path: knn.index
2025-03-09 10:58:46,859 [INFO]: 	size in bytes: 545964010
2025-03-09 10:58:46,859 [INFO]: 	avg_search_speed_ms: 8.739477910029773
2025-03-09 10:58:46,859 [INFO]: 	99p_search_speed_ms: 10.966644159052521
2025-03-09 10:58:46,859 [INFO]: 	reconstruction error %: 0.0
2025-03-09 10:58:46,859 [INFO]: 	nb vectors: 2775
2025-03-09 10:58:46,859 [INFO]: 	vectors dimension: 49152
2025-03-09 10:58:46,859 [INFO]: 	compression ratio: 0.9993098263015542
2025-03-09 10:58:46,859 [INFO]: }
2025-03-09 10:58:46,859 [INFO]: 	>>> Finished "Creating the index" in 39.7219 secs
2025-03-09 10:58:46,859 [INFO]: >>> Finished "Launching the whole pipeline" in 39.7506 secs
2025-03-09 10:58:48: [retrieval_preprocessing] calculating distances ...
2025-03-09 10:58:48: [retrieval_preprocessing] finished and saved retrieval indices for episode 84401 [episode count 17/20]
[retrieval_preprocessing] for episode 21810 [episode count 18/20], we have num_retrieval=np.int64(2867) num_query=np.int64(147)
2025-03-09 10:58:48,945 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-09 10:58:49,256 [INFO]: Launching the whole pipeline 03/09/2025, 10:58:49
2025-03-09 10:58:49,256 [INFO]: Reading total number of vectors and dimension 03/09/2025, 10:58:49
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1069.70it/s]
2025-03-09 10:58:49,300 [INFO]: There are 2867 embeddings of dim 49152
2025-03-09 10:58:49,300 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0446 secs
2025-03-09 10:58:49,301 [INFO]: 	Compute estimated construction time of the index 03/09/2025, 10:58:49
2025-03-09 10:58:49,301 [INFO]: 		-> Train: 16.7 minutes
2025-03-09 10:58:49,301 [INFO]: 		-> Add: 1.6 seconds
2025-03-09 10:58:49,301 [INFO]: 		Total: 16.7 minutes
2025-03-09 10:58:49,301 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0003 secs
2025-03-09 10:58:49,301 [INFO]: 	Checking that your have enough memory available to create the index 03/09/2025, 10:58:49
2025-03-09 10:58:49,301 [INFO]: 591.7MB of memory will be needed to build the index (more might be used if you have more)
2025-03-09 10:58:49,301 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0004 secs
2025-03-09 10:58:49,302 [INFO]: 	Selecting most promising index types given data characteristics 03/09/2025, 10:58:49
2025-03-09 10:58:49,302 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-09 10:58:49,302 [INFO]: 	Creating the index 03/09/2025, 10:58:49
2025-03-09 10:58:49,302 [INFO]: 		-> Instanciate the index HNSW15 03/09/2025, 10:58:49
2025-03-09 10:58:49,305 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0024 secs
2025-03-09 10:58:49,305 [INFO]: 		-> Adding the vectors to the index 03/09/2025, 10:58:49
2025-03-09 10:58:49,305 [INFO]: The memory available for adding the vectors is 49.5GB(total available - used by the index)
2025-03-09 10:58:49,305 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/12 [00:00<?, ?it/s] 17%|█▋        | 2/12 [00:00<00:00, 18.95it/s] 92%|█████████▏| 11/12 [00:00<00:00, 57.24it/s]100%|██████████| 12/12 [00:01<00:00,  6.84it/s]
2025-03-09 10:58:51,066 [INFO]: 	Computing best hyperparameters for index knn.index 03/09/2025, 10:58:51
2025-03-09 10:59:16,387 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 25.3200 secs
2025-03-09 10:59:16,387 [INFO]: The best hyperparameters are: efSearch=284
2025-03-09 10:59:16,387 [INFO]: 	Compute fast metrics 03/09/2025, 10:59:16
  0%|          | 0/4 [00:00<?, ?it/s] 75%|███████▌  | 3/4 [00:00<00:00, 28.25it/s] 75%|███████▌  | 3/4 [00:00<00:00, 25.30it/s]
2025-03-09 10:59:29,959 [INFO]: 	>>> Finished "Compute fast metrics" in 13.5724 secs
2025-03-09 10:59:29,961 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 40.6557 secs
2025-03-09 10:59:29,961 [INFO]: {
2025-03-09 10:59:29,961 [INFO]: 	index_key: HNSW15
2025-03-09 10:59:29,961 [INFO]: 	index_param: efSearch=284
2025-03-09 10:59:29,961 [INFO]: 	index_path: knn.index
2025-03-09 10:59:29,961 [INFO]: 	size in bytes: 564064510
2025-03-09 10:59:29,961 [INFO]: 	avg_search_speed_ms: 8.91785558650134
2025-03-09 10:59:29,961 [INFO]: 	99p_search_speed_ms: 11.220622493419794
2025-03-09 10:59:29,961 [INFO]: 	reconstruction error %: 0.0
2025-03-09 10:59:29,961 [INFO]: 	nb vectors: 2867
2025-03-09 10:59:29,961 [INFO]: 	vectors dimension: 49152
2025-03-09 10:59:29,961 [INFO]: 	compression ratio: 0.9993096995235528
2025-03-09 10:59:29,961 [INFO]: }
2025-03-09 10:59:29,961 [INFO]: 	>>> Finished "Creating the index" in 40.6589 secs
2025-03-09 10:59:29,961 [INFO]: >>> Finished "Launching the whole pipeline" in 40.7053 secs
2025-03-09 10:59:30: [retrieval_preprocessing] calculating distances ...
2025-03-09 10:59:31: [retrieval_preprocessing] finished and saved retrieval indices for episode 21810 [episode count 18/20]
[retrieval_preprocessing] for episode 62258 [episode count 19/20], we have num_retrieval=np.int64(2781) num_query=np.int64(233)
2025-03-09 10:59:31,327 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-09 10:59:31,631 [INFO]: Launching the whole pipeline 03/09/2025, 10:59:31
2025-03-09 10:59:31,631 [INFO]: Reading total number of vectors and dimension 03/09/2025, 10:59:31
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 2593.88it/s]
2025-03-09 10:59:31,654 [INFO]: There are 2781 embeddings of dim 49152
2025-03-09 10:59:31,654 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0233 secs
2025-03-09 10:59:31,654 [INFO]: 	Compute estimated construction time of the index 03/09/2025, 10:59:31
2025-03-09 10:59:31,654 [INFO]: 		-> Train: 16.7 minutes
2025-03-09 10:59:31,654 [INFO]: 		-> Add: 1.5 seconds
2025-03-09 10:59:31,654 [INFO]: 		Total: 16.7 minutes
2025-03-09 10:59:31,654 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0001 secs
2025-03-09 10:59:31,654 [INFO]: 	Checking that your have enough memory available to create the index 03/09/2025, 10:59:31
2025-03-09 10:59:31,654 [INFO]: 573.9MB of memory will be needed to build the index (more might be used if you have more)
2025-03-09 10:59:31,654 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0001 secs
2025-03-09 10:59:31,654 [INFO]: 	Selecting most promising index types given data characteristics 03/09/2025, 10:59:31
2025-03-09 10:59:31,654 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-09 10:59:31,654 [INFO]: 	Creating the index 03/09/2025, 10:59:31
2025-03-09 10:59:31,654 [INFO]: 		-> Instanciate the index HNSW15 03/09/2025, 10:59:31
2025-03-09 10:59:31,656 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0010 secs
2025-03-09 10:59:31,656 [INFO]: 		-> Adding the vectors to the index 03/09/2025, 10:59:31
2025-03-09 10:59:31,656 [INFO]: The memory available for adding the vectors is 49.5GB(total available - used by the index)
2025-03-09 10:59:31,656 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/11 [00:00<?, ?it/s] 18%|█▊        | 2/11 [00:00<00:00, 17.32it/s] 73%|███████▎  | 8/11 [00:00<00:00, 38.47it/s]100%|██████████| 11/11 [00:01<00:00,  6.18it/s]
2025-03-09 10:59:33,439 [INFO]: 	Computing best hyperparameters for index knn.index 03/09/2025, 10:59:33
2025-03-09 10:59:58,044 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 24.6043 secs
2025-03-09 10:59:58,044 [INFO]: The best hyperparameters are: efSearch=302
2025-03-09 10:59:58,044 [INFO]: 	Compute fast metrics 03/09/2025, 10:59:58
  0%|          | 0/4 [00:00<?, ?it/s] 50%|█████     | 2/4 [00:00<00:00, 18.14it/s] 75%|███████▌  | 3/4 [00:00<00:00, 20.39it/s]
2025-03-09 11:00:11,528 [INFO]: 	>>> Finished "Compute fast metrics" in 13.4836 secs
2025-03-09 11:00:11,529 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 39.8738 secs
2025-03-09 11:00:11,530 [INFO]: {
2025-03-09 11:00:11,530 [INFO]: 	index_key: HNSW15
2025-03-09 11:00:11,530 [INFO]: 	index_param: efSearch=302
2025-03-09 11:00:11,530 [INFO]: 	index_path: knn.index
2025-03-09 11:00:11,530 [INFO]: 	size in bytes: 547144450
2025-03-09 11:00:11,530 [INFO]: 	avg_search_speed_ms: 9.423138136166918
2025-03-09 11:00:11,530 [INFO]: 	99p_search_speed_ms: 12.607197281904526
2025-03-09 11:00:11,530 [INFO]: 	reconstruction error %: 0.0
2025-03-09 11:00:11,530 [INFO]: 	nb vectors: 2781
2025-03-09 11:00:11,530 [INFO]: 	vectors dimension: 49152
2025-03-09 11:00:11,530 [INFO]: 	compression ratio: 0.9993098678054763
2025-03-09 11:00:11,530 [INFO]: }
2025-03-09 11:00:11,530 [INFO]: 	>>> Finished "Creating the index" in 39.8755 secs
2025-03-09 11:00:11,530 [INFO]: >>> Finished "Launching the whole pipeline" in 39.8993 secs
2025-03-09 11:00:13: [retrieval_preprocessing] calculating distances ...
2025-03-09 11:00:13: [retrieval_preprocessing] finished and saved retrieval indices for episode 62258 [episode count 19/20]
2025-03-09 11:00:13: [retrieval_preprocessing] finished for (8922050678, 'lid') [chosen_id count 9/10]
2025-03-09 11:00:13: [retrieval_preprocessing] done for embedding_type='embeddings__wrist_image_left'!
