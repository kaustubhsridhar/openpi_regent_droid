nohup: ignoring input
2025-03-09 06:47:55: got the info dicts: there are 36687 groupings

2025-03-09 06:47:55: number of groupings with atleast 50 episodes [in the first 95658 episodes]: 105

these groupings have chosen_id-->num_episodes as

 {(1297764552, 'bottle'): 53, (2515873443, 'cloth'): 50, (5235850418, 'drawer'): 612, (5879622450, 'block'): 108, (1431810548, 'lid'): 51, (3485794757, 'marker'): 97, (8756300955, 'block'): 117, (1180576306, 'cloth'): 60, (9154343709, 'drawer'): 96, (6498288010, 'bottle'): 138, (8911427557, 'bottle'): 50, (1058976383, 'drawer'): 148, (4045730075, 'lid'): 61, (1712293193, 'marker'): 163, (65137982, 'block'): 100, (4329524892, 'cup'): 166, (484659531, 'marker'): 96, (-1, 'marker'): 1032, (6078642573, 'marker'): 54, (452818143, 'lid'): 221, (1461982682, 'cloth'): 76, (5235850418, 'block'): 97, (7495112204, 'marker'): 102, (666854965, 'marker'): 68, (395700094, 'block'): 72, (3827924651, 'lid'): 67, (6612454114, 'block'): 65, (2782099537, 'marker'): 75, (8376714657, 'marker'): 464, (3452853472, 'drawer'): 91, (9306310171, 'marker'): 97, (3816161570, 'drawer'): 78, (5511329841, 'marker'): 59, (3951366978, 'cup'): 112, (1959308322, 'marker'): 65, (3163748394, 'cup'): 127, (7644292911, 'marker'): 50, (1775582436, 'marker'): 98, (4706041793, 'cloth'): 142, (2370783071, 'block'): 50, (9551783935, 'drawer'): 65, (2782099537, 'cup'): 153, (7489911085, 'cloth'): 179, (5576515039, 'marker'): 50, (4465064685, 'marker'): 198, (9186164821, 'bottle'): 57, (5207831207, 'cup'): 139, (3774560981, 'cloth'): 99, (4823049285, 'bottle'): 234, (9130122211, 'marker'): 159, (6313680013, 'cup'): 50, (9088223759, 'bottle'): 99, (8098563998, 'lid'): 73, (9505766118, 'drawer'): 108, (441689524, 'mug'): 77, (8150285641, 'marker'): 63, (8456936732, 'bottle'): 54, (446878712, 'marker'): 83, (6093644330, 'cloth'): 52, (4345518188, 'lid'): 89, (5024387521, 'marker'): 60, (6498288010, 'lid'): 96, (4823049285, 'block'): 174, (6667529842, 'lid'): 90, (5507987860, 'marker'): 100, (8898968162, 'block'): 58, (-1, 'mug'): 228, (9965421062, 'bottle'): 63, (6357288647, 'lid'): 71, (5701580274, 'marker'): 67, (1469427884, 'marker'): 63, (9933578360, 'drawer'): 53, (1498834123, 'cup'): 77, (440287856, 'drawer'): 75, (376702246, 'cup'): 53, (9883209091, 'mug'): 201, (9934859632, 'marker'): 62, (4312815282, 'marker'): 66, (-1, 'cup'): 113, (8922050678, 'lid'): 64, (2883696971, 'cup'): 69, (9209350647, 'drawer'): 76, (6655265581, 'cup'): 51, (4345518188, 'cloth'): 91, (4545879864, 'marker'): 51, (818725642, 'block'): 63, (3854327802, 'bottle'): 97, (3951366978, 'lid'): 72, (5059283044, 'drawer'): 113, (4846810092, 'cloth'): 93, (8690198922, 'marker'): 65, (1477699675, 'marker'): 89, (4400212150, 'marker'): 52, (1526685371, 'marker'): 62, (6074146895, 'lid'): 59, (8911427557, 'cup'): 112, (8702636502, 'lid'): 90, (8172596608, 'cup'): 51, (1575177183, 'marker'): 59, (5414640868, 'lid'): 56, (1477699675, 'mug'): 57, (9228483020, 'marker'): 80, (2927338332, 'cloth'): 51, (52817038, 'block'): 54, (8815207926, 'block'): 54}
2025-03-09 06:47:55: [retrieval_preprocessing] starting retrieval preprocessing for embeddings__wrist_image_left
2025-03-09 06:47:57: [retrieval_preprocessing] concatenated all embeddings and indices for 20 episodes for (2883696971, 'cup') [chosen_id count 0/10]
2025-03-09 06:47:57: [retrieval_preprocessing] we have num_total=2997 embedding_dim=49152
[retrieval_preprocessing] for episode 27264 [episode count 0/20], we have num_retrieval=np.int64(2889) num_query=np.int64(108)
2025-03-09 06:47:57,670 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-09 06:47:58,128 [INFO]: Launching the whole pipeline 03/09/2025, 06:47:58
2025-03-09 06:47:58,128 [INFO]: Reading total number of vectors and dimension 03/09/2025, 06:47:58
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 763.57it/s]
2025-03-09 06:47:58,177 [INFO]: There are 2889 embeddings of dim 49152
2025-03-09 06:47:58,178 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0498 secs
2025-03-09 06:47:58,178 [INFO]: 	Compute estimated construction time of the index 03/09/2025, 06:47:58
2025-03-09 06:47:58,178 [INFO]: 		-> Train: 16.7 minutes
2025-03-09 06:47:58,178 [INFO]: 		-> Add: 1.6 seconds
2025-03-09 06:47:58,178 [INFO]: 		Total: 16.7 minutes
2025-03-09 06:47:58,178 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0002 secs
2025-03-09 06:47:58,178 [INFO]: 	Checking that your have enough memory available to create the index 03/09/2025, 06:47:58
2025-03-09 06:47:58,179 [INFO]: 596.2MB of memory will be needed to build the index (more might be used if you have more)
2025-03-09 06:47:58,179 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0007 secs
2025-03-09 06:47:58,179 [INFO]: 	Selecting most promising index types given data characteristics 03/09/2025, 06:47:58
2025-03-09 06:47:58,179 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-09 06:47:58,179 [INFO]: 	Creating the index 03/09/2025, 06:47:58
2025-03-09 06:47:58,179 [INFO]: 		-> Instanciate the index HNSW15 03/09/2025, 06:47:58
2025-03-09 06:47:58,181 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0016 secs
2025-03-09 06:47:58,181 [INFO]: 		-> Adding the vectors to the index 03/09/2025, 06:47:58
2025-03-09 06:47:58,181 [INFO]: The memory available for adding the vectors is 49.5GB(total available - used by the index)
2025-03-09 06:47:58,181 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/12 [00:00<?, ?it/s] 17%|█▋        | 2/12 [00:00<00:00, 18.70it/s] 67%|██████▋   | 8/12 [00:00<00:00, 38.97it/s]100%|██████████| 12/12 [00:02<00:00,  3.98it/s]100%|██████████| 12/12 [00:02<00:00,  5.01it/s]
2025-03-09 06:48:00,582 [INFO]: 	Computing best hyperparameters for index knn.index 03/09/2025, 06:48:00
2025-03-09 06:48:35,667 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 35.0845 secs
2025-03-09 06:48:35,667 [INFO]: The best hyperparameters are: efSearch=298
2025-03-09 06:48:35,667 [INFO]: 	Compute fast metrics 03/09/2025, 06:48:35
  0%|          | 0/4 [00:00<?, ?it/s] 50%|█████     | 2/4 [00:00<00:00, 16.25it/s] 75%|███████▌  | 3/4 [00:00<00:00, 17.69it/s]
2025-03-09 06:48:48,356 [INFO]: 	>>> Finished "Compute fast metrics" in 12.6881 secs
2025-03-09 06:48:48,358 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 50.1767 secs
2025-03-09 06:48:48,358 [INFO]: {
2025-03-09 06:48:48,358 [INFO]: 	index_key: HNSW15
2025-03-09 06:48:48,358 [INFO]: 	index_param: efSearch=298
2025-03-09 06:48:48,358 [INFO]: 	index_path: knn.index
2025-03-09 06:48:48,358 [INFO]: 	size in bytes: 568392850
2025-03-09 06:48:48,358 [INFO]: 	avg_search_speed_ms: 11.222355300299279
2025-03-09 06:48:48,358 [INFO]: 	99p_search_speed_ms: 16.908898646943275
2025-03-09 06:48:48,358 [INFO]: 	reconstruction error %: 0.0
2025-03-09 06:48:48,358 [INFO]: 	nb vectors: 2889
2025-03-09 06:48:48,358 [INFO]: 	vectors dimension: 49152
2025-03-09 06:48:48,358 [INFO]: 	compression ratio: 0.9993097414930536
2025-03-09 06:48:48,358 [INFO]: }
2025-03-09 06:48:48,358 [INFO]: 	>>> Finished "Creating the index" in 50.1788 secs
2025-03-09 06:48:48,358 [INFO]: >>> Finished "Launching the whole pipeline" in 50.2302 secs
2025-03-09 06:48:48: [retrieval_preprocessing] calculating distances ...
2025-03-09 06:48:49: [retrieval_preprocessing] finished and saved retrieval indices for episode 27264 [episode count 0/20]
[retrieval_preprocessing] for episode 27521 [episode count 1/20], we have num_retrieval=np.int64(2764) num_query=np.int64(233)
2025-03-09 06:48:49,739 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-09 06:48:50,093 [INFO]: Launching the whole pipeline 03/09/2025, 06:48:50
2025-03-09 06:48:50,093 [INFO]: Reading total number of vectors and dimension 03/09/2025, 06:48:50
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1955.39it/s]
2025-03-09 06:48:50,121 [INFO]: There are 2764 embeddings of dim 49152
2025-03-09 06:48:50,121 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0285 secs
2025-03-09 06:48:50,121 [INFO]: 	Compute estimated construction time of the index 03/09/2025, 06:48:50
2025-03-09 06:48:50,121 [INFO]: 		-> Train: 16.7 minutes
2025-03-09 06:48:50,121 [INFO]: 		-> Add: 1.5 seconds
2025-03-09 06:48:50,121 [INFO]: 		Total: 16.7 minutes
2025-03-09 06:48:50,121 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0001 secs
2025-03-09 06:48:50,122 [INFO]: 	Checking that your have enough memory available to create the index 03/09/2025, 06:48:50
2025-03-09 06:48:50,122 [INFO]: 570.4MB of memory will be needed to build the index (more might be used if you have more)
2025-03-09 06:48:50,122 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0002 secs
2025-03-09 06:48:50,122 [INFO]: 	Selecting most promising index types given data characteristics 03/09/2025, 06:48:50
2025-03-09 06:48:50,122 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-09 06:48:50,122 [INFO]: 	Creating the index 03/09/2025, 06:48:50
2025-03-09 06:48:50,122 [INFO]: 		-> Instanciate the index HNSW15 03/09/2025, 06:48:50
2025-03-09 06:48:50,123 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0008 secs
2025-03-09 06:48:50,123 [INFO]: 		-> Adding the vectors to the index 03/09/2025, 06:48:50
2025-03-09 06:48:50,123 [INFO]: The memory available for adding the vectors is 49.5GB(total available - used by the index)
2025-03-09 06:48:50,123 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/11 [00:00<?, ?it/s]  9%|▉         | 1/11 [00:00<00:01,  8.90it/s] 55%|█████▍    | 6/11 [00:00<00:00, 29.40it/s]100%|██████████| 11/11 [00:02<00:00,  4.45it/s]100%|██████████| 11/11 [00:02<00:00,  5.21it/s]
2025-03-09 06:48:52,238 [INFO]: 	Computing best hyperparameters for index knn.index 03/09/2025, 06:48:52
2025-03-09 06:49:27,752 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 35.5139 secs
2025-03-09 06:49:27,753 [INFO]: The best hyperparameters are: efSearch=307
2025-03-09 06:49:27,753 [INFO]: 	Compute fast metrics 03/09/2025, 06:49:27
  0%|          | 0/4 [00:00<?, ?it/s] 50%|█████     | 2/4 [00:00<00:00, 19.44it/s] 75%|███████▌  | 3/4 [00:00<00:00, 20.40it/s]
2025-03-09 06:49:39,880 [INFO]: 	>>> Finished "Compute fast metrics" in 12.1270 secs
2025-03-09 06:49:39,881 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 49.7586 secs
2025-03-09 06:49:39,882 [INFO]: {
2025-03-09 06:49:39,882 [INFO]: 	index_key: HNSW15
2025-03-09 06:49:39,882 [INFO]: 	index_param: efSearch=307
2025-03-09 06:49:39,882 [INFO]: 	index_path: knn.index
2025-03-09 06:49:39,882 [INFO]: 	size in bytes: 543799810
2025-03-09 06:49:39,882 [INFO]: 	avg_search_speed_ms: 12.234152881610765
2025-03-09 06:49:39,882 [INFO]: 	99p_search_speed_ms: 32.39944822154941
2025-03-09 06:49:39,882 [INFO]: 	reconstruction error %: 0.0
2025-03-09 06:49:39,882 [INFO]: 	nb vectors: 2764
2025-03-09 06:49:39,882 [INFO]: 	vectors dimension: 49152
2025-03-09 06:49:39,882 [INFO]: 	compression ratio: 0.9993098600016062
2025-03-09 06:49:39,882 [INFO]: }
2025-03-09 06:49:39,882 [INFO]: 	>>> Finished "Creating the index" in 49.7600 secs
2025-03-09 06:49:39,882 [INFO]: >>> Finished "Launching the whole pipeline" in 49.7891 secs
2025-03-09 06:49:41: [retrieval_preprocessing] calculating distances ...
2025-03-09 06:49:42: [retrieval_preprocessing] finished and saved retrieval indices for episode 27521 [episode count 1/20]
[retrieval_preprocessing] for episode 82177 [episode count 2/20], we have num_retrieval=np.int64(2852) num_query=np.int64(145)
2025-03-09 06:49:42,675 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-09 06:49:43,291 [INFO]: Launching the whole pipeline 03/09/2025, 06:49:43
2025-03-09 06:49:43,291 [INFO]: Reading total number of vectors and dimension 03/09/2025, 06:49:43
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1165.08it/s]
2025-03-09 06:49:43,321 [INFO]: There are 2852 embeddings of dim 49152
2025-03-09 06:49:43,322 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0305 secs
2025-03-09 06:49:43,322 [INFO]: 	Compute estimated construction time of the index 03/09/2025, 06:49:43
2025-03-09 06:49:43,322 [INFO]: 		-> Train: 16.7 minutes
2025-03-09 06:49:43,322 [INFO]: 		-> Add: 1.6 seconds
2025-03-09 06:49:43,322 [INFO]: 		Total: 16.7 minutes
2025-03-09 06:49:43,322 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0001 secs
2025-03-09 06:49:43,322 [INFO]: 	Checking that your have enough memory available to create the index 03/09/2025, 06:49:43
2025-03-09 06:49:43,322 [INFO]: 588.6MB of memory will be needed to build the index (more might be used if you have more)
2025-03-09 06:49:43,322 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0001 secs
2025-03-09 06:49:43,322 [INFO]: 	Selecting most promising index types given data characteristics 03/09/2025, 06:49:43
2025-03-09 06:49:43,322 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-09 06:49:43,322 [INFO]: 	Creating the index 03/09/2025, 06:49:43
2025-03-09 06:49:43,322 [INFO]: 		-> Instanciate the index HNSW15 03/09/2025, 06:49:43
2025-03-09 06:49:43,323 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0010 secs
2025-03-09 06:49:43,323 [INFO]: 		-> Adding the vectors to the index 03/09/2025, 06:49:43
2025-03-09 06:49:43,323 [INFO]: The memory available for adding the vectors is 49.5GB(total available - used by the index)
2025-03-09 06:49:43,323 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/12 [00:00<?, ?it/s] 17%|█▋        | 2/12 [00:00<00:00, 19.25it/s] 58%|█████▊    | 7/12 [00:00<00:00, 36.81it/s]100%|██████████| 12/12 [00:02<00:00,  4.34it/s]100%|██████████| 12/12 [00:02<00:00,  5.29it/s]
2025-03-09 06:49:45,596 [INFO]: 	Computing best hyperparameters for index knn.index 03/09/2025, 06:49:45
2025-03-09 06:50:26,721 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 41.1245 secs
2025-03-09 06:50:26,722 [INFO]: The best hyperparameters are: efSearch=269
2025-03-09 06:50:26,722 [INFO]: 	Compute fast metrics 03/09/2025, 06:50:26
  0%|          | 0/4 [00:00<?, ?it/s] 75%|███████▌  | 3/4 [00:00<00:00, 25.38it/s] 75%|███████▌  | 3/4 [00:00<00:00, 21.81it/s]
2025-03-09 06:50:38,866 [INFO]: 	>>> Finished "Compute fast metrics" in 12.1443 secs
2025-03-09 06:50:38,868 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 55.5443 secs
2025-03-09 06:50:38,868 [INFO]: {
2025-03-09 06:50:38,868 [INFO]: 	index_key: HNSW15
2025-03-09 06:50:38,868 [INFO]: 	index_param: efSearch=269
2025-03-09 06:50:38,868 [INFO]: 	index_path: knn.index
2025-03-09 06:50:38,868 [INFO]: 	size in bytes: 561113350
2025-03-09 06:50:38,868 [INFO]: 	avg_search_speed_ms: 10.973125124572809
2025-03-09 06:50:38,868 [INFO]: 	99p_search_speed_ms: 27.111510236281866
2025-03-09 06:50:38,868 [INFO]: 	reconstruction error %: 0.0
2025-03-09 06:50:38,868 [INFO]: 	nb vectors: 2852
2025-03-09 06:50:38,868 [INFO]: 	vectors dimension: 49152
2025-03-09 06:50:38,868 [INFO]: 	compression ratio: 0.9993097045365255
2025-03-09 06:50:38,868 [INFO]: }
2025-03-09 06:50:38,868 [INFO]: 	>>> Finished "Creating the index" in 55.5459 secs
2025-03-09 06:50:38,868 [INFO]: >>> Finished "Launching the whole pipeline" in 55.5770 secs
2025-03-09 06:50:39: [retrieval_preprocessing] calculating distances ...
2025-03-09 06:50:40: [retrieval_preprocessing] finished and saved retrieval indices for episode 82177 [episode count 2/20]
[retrieval_preprocessing] for episode 90497 [episode count 3/20], we have num_retrieval=np.int64(2825) num_query=np.int64(172)
2025-03-09 06:50:40,469 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-09 06:50:41,031 [INFO]: Launching the whole pipeline 03/09/2025, 06:50:41
2025-03-09 06:50:41,031 [INFO]: Reading total number of vectors and dimension 03/09/2025, 06:50:41
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1246.82it/s]
2025-03-09 06:50:41,077 [INFO]: There are 2825 embeddings of dim 49152
2025-03-09 06:50:41,077 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0463 secs
2025-03-09 06:50:41,077 [INFO]: 	Compute estimated construction time of the index 03/09/2025, 06:50:41
2025-03-09 06:50:41,077 [INFO]: 		-> Train: 16.7 minutes
2025-03-09 06:50:41,077 [INFO]: 		-> Add: 1.6 seconds
2025-03-09 06:50:41,077 [INFO]: 		Total: 16.7 minutes
2025-03-09 06:50:41,077 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0001 secs
2025-03-09 06:50:41,077 [INFO]: 	Checking that your have enough memory available to create the index 03/09/2025, 06:50:41
2025-03-09 06:50:41,077 [INFO]: 583.0MB of memory will be needed to build the index (more might be used if you have more)
2025-03-09 06:50:41,077 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0001 secs
2025-03-09 06:50:41,077 [INFO]: 	Selecting most promising index types given data characteristics 03/09/2025, 06:50:41
2025-03-09 06:50:41,078 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-09 06:50:41,078 [INFO]: 	Creating the index 03/09/2025, 06:50:41
2025-03-09 06:50:41,078 [INFO]: 		-> Instanciate the index HNSW15 03/09/2025, 06:50:41
2025-03-09 06:50:41,079 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0010 secs
2025-03-09 06:50:41,079 [INFO]: 		-> Adding the vectors to the index 03/09/2025, 06:50:41
2025-03-09 06:50:41,079 [INFO]: The memory available for adding the vectors is 49.5GB(total available - used by the index)
2025-03-09 06:50:41,079 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/12 [00:00<?, ?it/s] 17%|█▋        | 2/12 [00:00<00:00, 19.13it/s] 67%|██████▋   | 8/12 [00:00<00:00, 39.72it/s]100%|██████████| 12/12 [00:02<00:00,  3.99it/s]100%|██████████| 12/12 [00:02<00:00,  5.02it/s]
2025-03-09 06:50:43,472 [INFO]: 	Computing best hyperparameters for index knn.index 03/09/2025, 06:50:43
2025-03-09 06:51:17,506 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 34.0339 secs
2025-03-09 06:51:17,506 [INFO]: The best hyperparameters are: efSearch=237
2025-03-09 06:51:17,506 [INFO]: 	Compute fast metrics 03/09/2025, 06:51:17
  0%|          | 0/4 [00:00<?, ?it/s] 75%|███████▌  | 3/4 [00:00<00:00, 27.26it/s] 75%|███████▌  | 3/4 [00:00<00:00, 23.32it/s]
2025-03-09 06:51:29,901 [INFO]: 	>>> Finished "Compute fast metrics" in 12.3945 secs
2025-03-09 06:51:29,903 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 48.8242 secs
2025-03-09 06:51:29,903 [INFO]: {
2025-03-09 06:51:29,903 [INFO]: 	index_key: HNSW15
2025-03-09 06:51:29,903 [INFO]: 	index_param: efSearch=237
2025-03-09 06:51:29,903 [INFO]: 	index_path: knn.index
2025-03-09 06:51:29,903 [INFO]: 	size in bytes: 555801250
2025-03-09 06:51:29,903 [INFO]: 	avg_search_speed_ms: 10.20906148426174
2025-03-09 06:51:29,903 [INFO]: 	99p_search_speed_ms: 29.139055078849214
2025-03-09 06:51:29,903 [INFO]: 	reconstruction error %: 0.0
2025-03-09 06:51:29,903 [INFO]: 	nb vectors: 2825
2025-03-09 06:51:29,903 [INFO]: 	vectors dimension: 49152
2025-03-09 06:51:29,903 [INFO]: 	compression ratio: 0.999309735269577
2025-03-09 06:51:29,903 [INFO]: }
2025-03-09 06:51:29,903 [INFO]: 	>>> Finished "Creating the index" in 48.8256 secs
2025-03-09 06:51:29,903 [INFO]: >>> Finished "Launching the whole pipeline" in 48.8723 secs
2025-03-09 06:51:30: [retrieval_preprocessing] calculating distances ...
2025-03-09 06:51:31: [retrieval_preprocessing] finished and saved retrieval indices for episode 90497 [episode count 3/20]
[retrieval_preprocessing] for episode 30724 [episode count 4/20], we have num_retrieval=np.int64(2838) num_query=np.int64(159)
2025-03-09 06:51:31,793 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-09 06:51:32,264 [INFO]: Launching the whole pipeline 03/09/2025, 06:51:32
2025-03-09 06:51:32,264 [INFO]: Reading total number of vectors and dimension 03/09/2025, 06:51:32
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1761.57it/s]
2025-03-09 06:51:32,293 [INFO]: There are 2838 embeddings of dim 49152
2025-03-09 06:51:32,294 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0293 secs
2025-03-09 06:51:32,294 [INFO]: 	Compute estimated construction time of the index 03/09/2025, 06:51:32
2025-03-09 06:51:32,294 [INFO]: 		-> Train: 16.7 minutes
2025-03-09 06:51:32,294 [INFO]: 		-> Add: 1.6 seconds
2025-03-09 06:51:32,294 [INFO]: 		Total: 16.7 minutes
2025-03-09 06:51:32,294 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0001 secs
2025-03-09 06:51:32,294 [INFO]: 	Checking that your have enough memory available to create the index 03/09/2025, 06:51:32
2025-03-09 06:51:32,294 [INFO]: 585.7MB of memory will be needed to build the index (more might be used if you have more)
2025-03-09 06:51:32,294 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0001 secs
2025-03-09 06:51:32,294 [INFO]: 	Selecting most promising index types given data characteristics 03/09/2025, 06:51:32
2025-03-09 06:51:32,294 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-09 06:51:32,294 [INFO]: 	Creating the index 03/09/2025, 06:51:32
2025-03-09 06:51:32,294 [INFO]: 		-> Instanciate the index HNSW15 03/09/2025, 06:51:32
2025-03-09 06:51:32,295 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0010 secs
2025-03-09 06:51:32,295 [INFO]: 		-> Adding the vectors to the index 03/09/2025, 06:51:32
2025-03-09 06:51:32,295 [INFO]: The memory available for adding the vectors is 49.5GB(total available - used by the index)
2025-03-09 06:51:32,295 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/12 [00:00<?, ?it/s] 17%|█▋        | 2/12 [00:00<00:00, 17.08it/s] 67%|██████▋   | 8/12 [00:00<00:00, 37.31it/s]100%|██████████| 12/12 [00:02<00:00,  4.80it/s]100%|██████████| 12/12 [00:02<00:00,  5.97it/s]
2025-03-09 06:51:34,310 [INFO]: 	Computing best hyperparameters for index knn.index 03/09/2025, 06:51:34
2025-03-09 06:52:02,877 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 28.5660 secs
2025-03-09 06:52:02,877 [INFO]: The best hyperparameters are: efSearch=260
2025-03-09 06:52:02,877 [INFO]: 	Compute fast metrics 03/09/2025, 06:52:02
  0%|          | 0/4 [00:00<?, ?it/s] 50%|█████     | 2/4 [00:00<00:00, 18.87it/s] 75%|███████▌  | 3/4 [00:00<00:00, 21.21it/s]
2025-03-09 06:52:15,064 [INFO]: 	>>> Finished "Compute fast metrics" in 12.1867 secs
2025-03-09 06:52:15,067 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 42.7713 secs
2025-03-09 06:52:15,067 [INFO]: {
2025-03-09 06:52:15,067 [INFO]: 	index_key: HNSW15
2025-03-09 06:52:15,067 [INFO]: 	index_param: efSearch=260
2025-03-09 06:52:15,067 [INFO]: 	index_path: knn.index
2025-03-09 06:52:15,067 [INFO]: 	size in bytes: 558358990
2025-03-09 06:52:15,067 [INFO]: 	avg_search_speed_ms: 11.48730183119675
2025-03-09 06:52:15,067 [INFO]: 	99p_search_speed_ms: 21.776037244126183
2025-03-09 06:52:15,067 [INFO]: 	reconstruction error %: 0.0
2025-03-09 06:52:15,067 [INFO]: 	nb vectors: 2838
2025-03-09 06:52:15,067 [INFO]: 	vectors dimension: 49152
2025-03-09 06:52:15,067 [INFO]: 	compression ratio: 0.9993096090384431
2025-03-09 06:52:15,067 [INFO]: }
2025-03-09 06:52:15,067 [INFO]: 	>>> Finished "Creating the index" in 42.7729 secs
2025-03-09 06:52:15,067 [INFO]: >>> Finished "Launching the whole pipeline" in 42.8028 secs
2025-03-09 06:52:16: [retrieval_preprocessing] calculating distances ...
2025-03-09 06:52:16: [retrieval_preprocessing] finished and saved retrieval indices for episode 30724 [episode count 4/20]
[retrieval_preprocessing] for episode 35716 [episode count 5/20], we have num_retrieval=np.int64(2846) num_query=np.int64(151)
2025-03-09 06:52:17,070 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-09 06:52:17,663 [INFO]: Launching the whole pipeline 03/09/2025, 06:52:17
2025-03-09 06:52:17,664 [INFO]: Reading total number of vectors and dimension 03/09/2025, 06:52:17
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1682.43it/s]
2025-03-09 06:52:17,696 [INFO]: There are 2846 embeddings of dim 49152
2025-03-09 06:52:17,696 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0327 secs
2025-03-09 06:52:17,697 [INFO]: 	Compute estimated construction time of the index 03/09/2025, 06:52:17
2025-03-09 06:52:17,697 [INFO]: 		-> Train: 16.7 minutes
2025-03-09 06:52:17,697 [INFO]: 		-> Add: 1.6 seconds
2025-03-09 06:52:17,697 [INFO]: 		Total: 16.7 minutes
2025-03-09 06:52:17,697 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0002 secs
2025-03-09 06:52:17,697 [INFO]: 	Checking that your have enough memory available to create the index 03/09/2025, 06:52:17
2025-03-09 06:52:17,697 [INFO]: 587.3MB of memory will be needed to build the index (more might be used if you have more)
2025-03-09 06:52:17,697 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0005 secs
2025-03-09 06:52:17,697 [INFO]: 	Selecting most promising index types given data characteristics 03/09/2025, 06:52:17
2025-03-09 06:52:17,698 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-09 06:52:17,698 [INFO]: 	Creating the index 03/09/2025, 06:52:17
2025-03-09 06:52:17,698 [INFO]: 		-> Instanciate the index HNSW15 03/09/2025, 06:52:17
2025-03-09 06:52:17,700 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0018 secs
2025-03-09 06:52:17,700 [INFO]: 		-> Adding the vectors to the index 03/09/2025, 06:52:17
2025-03-09 06:52:17,700 [INFO]: The memory available for adding the vectors is 49.5GB(total available - used by the index)
2025-03-09 06:52:17,700 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/12 [00:00<?, ?it/s]  8%|▊         | 1/12 [00:00<00:01,  9.63it/s] 50%|█████     | 6/12 [00:00<00:00, 32.12it/s] 92%|█████████▏| 11/12 [00:00<00:00, 39.43it/s]100%|██████████| 12/12 [00:02<00:00,  5.64it/s]
2025-03-09 06:52:19,830 [INFO]: 	Computing best hyperparameters for index knn.index 03/09/2025, 06:52:19
2025-03-09 06:52:50,803 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 30.9728 secs
2025-03-09 06:52:50,803 [INFO]: The best hyperparameters are: efSearch=270
2025-03-09 06:52:50,803 [INFO]: 	Compute fast metrics 03/09/2025, 06:52:50
  0%|          | 0/4 [00:00<?, ?it/s] 25%|██▌       | 1/4 [00:00<00:00,  6.24it/s] 75%|███████▌  | 3/4 [00:00<00:00, 13.60it/s]
2025-03-09 06:53:02,740 [INFO]: 	>>> Finished "Compute fast metrics" in 11.9366 secs
2025-03-09 06:53:02,741 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 45.0417 secs
2025-03-09 06:53:02,742 [INFO]: {
2025-03-09 06:53:02,742 [INFO]: 	index_key: HNSW15
2025-03-09 06:53:02,742 [INFO]: 	index_param: efSearch=270
2025-03-09 06:53:02,742 [INFO]: 	index_path: knn.index
2025-03-09 06:53:02,742 [INFO]: 	size in bytes: 559932910
2025-03-09 06:53:02,742 [INFO]: 	avg_search_speed_ms: 10.0080855659212
2025-03-09 06:53:02,742 [INFO]: 	99p_search_speed_ms: 22.45130092371255
2025-03-09 06:53:02,742 [INFO]: 	reconstruction error %: 0.0
2025-03-09 06:53:02,742 [INFO]: 	nb vectors: 2846
2025-03-09 06:53:02,742 [INFO]: 	vectors dimension: 49152
2025-03-09 06:53:02,742 [INFO]: 	compression ratio: 0.99930966372382
2025-03-09 06:53:02,742 [INFO]: }
2025-03-09 06:53:02,742 [INFO]: 	>>> Finished "Creating the index" in 45.0442 secs
2025-03-09 06:53:02,742 [INFO]: >>> Finished "Launching the whole pipeline" in 45.0781 secs
2025-03-09 06:53:03: [retrieval_preprocessing] calculating distances ...
2025-03-09 06:53:04: [retrieval_preprocessing] finished and saved retrieval indices for episode 35716 [episode count 5/20]
[retrieval_preprocessing] for episode 67206 [episode count 6/20], we have num_retrieval=np.int64(2844) num_query=np.int64(153)
2025-03-09 06:53:04,420 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-09 06:53:04,786 [INFO]: Launching the whole pipeline 03/09/2025, 06:53:04
2025-03-09 06:53:04,786 [INFO]: Reading total number of vectors and dimension 03/09/2025, 06:53:04
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1851.79it/s]
2025-03-09 06:53:04,816 [INFO]: There are 2844 embeddings of dim 49152
2025-03-09 06:53:04,816 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0299 secs
2025-03-09 06:53:04,816 [INFO]: 	Compute estimated construction time of the index 03/09/2025, 06:53:04
2025-03-09 06:53:04,816 [INFO]: 		-> Train: 16.7 minutes
2025-03-09 06:53:04,816 [INFO]: 		-> Add: 1.6 seconds
2025-03-09 06:53:04,816 [INFO]: 		Total: 16.7 minutes
2025-03-09 06:53:04,816 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0001 secs
2025-03-09 06:53:04,816 [INFO]: 	Checking that your have enough memory available to create the index 03/09/2025, 06:53:04
2025-03-09 06:53:04,816 [INFO]: 586.9MB of memory will be needed to build the index (more might be used if you have more)
2025-03-09 06:53:04,817 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0001 secs
2025-03-09 06:53:04,817 [INFO]: 	Selecting most promising index types given data characteristics 03/09/2025, 06:53:04
2025-03-09 06:53:04,817 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-09 06:53:04,817 [INFO]: 	Creating the index 03/09/2025, 06:53:04
2025-03-09 06:53:04,817 [INFO]: 		-> Instanciate the index HNSW15 03/09/2025, 06:53:04
2025-03-09 06:53:04,818 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0010 secs
2025-03-09 06:53:04,818 [INFO]: 		-> Adding the vectors to the index 03/09/2025, 06:53:04
2025-03-09 06:53:04,818 [INFO]: The memory available for adding the vectors is 49.5GB(total available - used by the index)
2025-03-09 06:53:04,818 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/12 [00:00<?, ?it/s]  8%|▊         | 1/12 [00:00<00:01,  7.60it/s] 25%|██▌       | 3/12 [00:00<00:00, 12.09it/s] 42%|████▏     | 5/12 [00:00<00:00, 13.39it/s] 67%|██████▋   | 8/12 [00:00<00:00, 17.89it/s]100%|██████████| 12/12 [00:02<00:00,  3.94it/s]100%|██████████| 12/12 [00:02<00:00,  5.16it/s]
2025-03-09 06:53:07,149 [INFO]: 	Computing best hyperparameters for index knn.index 03/09/2025, 06:53:07
2025-03-09 06:53:40,943 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 33.7941 secs
2025-03-09 06:53:40,943 [INFO]: The best hyperparameters are: efSearch=286
2025-03-09 06:53:40,943 [INFO]: 	Compute fast metrics 03/09/2025, 06:53:40
  0%|          | 0/4 [00:00<?, ?it/s] 25%|██▌       | 1/4 [00:00<00:00,  5.24it/s] 50%|█████     | 2/4 [00:00<00:00,  6.79it/s] 75%|███████▌  | 3/4 [00:00<00:00,  7.45it/s] 75%|███████▌  | 3/4 [00:00<00:00,  5.59it/s]
2025-03-09 06:53:53,765 [INFO]: 	>>> Finished "Compute fast metrics" in 12.8219 secs
2025-03-09 06:53:53,767 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 48.9495 secs
2025-03-09 06:53:53,768 [INFO]: {
2025-03-09 06:53:53,768 [INFO]: 	index_key: HNSW15
2025-03-09 06:53:53,768 [INFO]: 	index_param: efSearch=286
2025-03-09 06:53:53,768 [INFO]: 	index_path: knn.index
2025-03-09 06:53:53,768 [INFO]: 	size in bytes: 559539430
2025-03-09 06:53:53,768 [INFO]: 	avg_search_speed_ms: 11.536133729647565
2025-03-09 06:53:53,768 [INFO]: 	99p_search_speed_ms: 17.841682089492682
2025-03-09 06:53:53,768 [INFO]: 	reconstruction error %: 0.0
2025-03-09 06:53:53,768 [INFO]: 	nb vectors: 2844
2025-03-09 06:53:53,768 [INFO]: 	vectors dimension: 49152
2025-03-09 06:53:53,768 [INFO]: 	compression ratio: 0.9993096500813178
2025-03-09 06:53:53,768 [INFO]: }
2025-03-09 06:53:53,768 [INFO]: 	>>> Finished "Creating the index" in 48.9511 secs
2025-03-09 06:53:53,768 [INFO]: >>> Finished "Launching the whole pipeline" in 48.9816 secs
2025-03-09 06:53:54: [retrieval_preprocessing] calculating distances ...
2025-03-09 06:53:55: [retrieval_preprocessing] finished and saved retrieval indices for episode 67206 [episode count 6/20]
[retrieval_preprocessing] for episode 70284 [episode count 7/20], we have num_retrieval=np.int64(2794) num_query=np.int64(203)
2025-03-09 06:53:55,485 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-09 06:53:55,882 [INFO]: Launching the whole pipeline 03/09/2025, 06:53:55
2025-03-09 06:53:55,882 [INFO]: Reading total number of vectors and dimension 03/09/2025, 06:53:55
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1406.54it/s]
2025-03-09 06:53:55,913 [INFO]: There are 2794 embeddings of dim 49152
2025-03-09 06:53:55,913 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0310 secs
2025-03-09 06:53:55,913 [INFO]: 	Compute estimated construction time of the index 03/09/2025, 06:53:55
2025-03-09 06:53:55,913 [INFO]: 		-> Train: 16.7 minutes
2025-03-09 06:53:55,913 [INFO]: 		-> Add: 1.5 seconds
2025-03-09 06:53:55,913 [INFO]: 		Total: 16.7 minutes
2025-03-09 06:53:55,913 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0001 secs
2025-03-09 06:53:55,913 [INFO]: 	Checking that your have enough memory available to create the index 03/09/2025, 06:53:55
2025-03-09 06:53:55,913 [INFO]: 576.6MB of memory will be needed to build the index (more might be used if you have more)
2025-03-09 06:53:55,913 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0002 secs
2025-03-09 06:53:55,914 [INFO]: 	Selecting most promising index types given data characteristics 03/09/2025, 06:53:55
2025-03-09 06:53:55,914 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-09 06:53:55,914 [INFO]: 	Creating the index 03/09/2025, 06:53:55
2025-03-09 06:53:55,914 [INFO]: 		-> Instanciate the index HNSW15 03/09/2025, 06:53:55
2025-03-09 06:53:55,915 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0010 secs
2025-03-09 06:53:55,915 [INFO]: 		-> Adding the vectors to the index 03/09/2025, 06:53:55
2025-03-09 06:53:55,915 [INFO]: The memory available for adding the vectors is 49.5GB(total available - used by the index)
2025-03-09 06:53:55,915 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/11 [00:00<?, ?it/s] 18%|█▊        | 2/11 [00:00<00:00, 17.92it/s] 64%|██████▎   | 7/11 [00:00<00:00, 34.56it/s]100%|██████████| 11/11 [00:02<00:00,  4.01it/s]100%|██████████| 11/11 [00:02<00:00,  4.99it/s]
2025-03-09 06:53:58,123 [INFO]: 	Computing best hyperparameters for index knn.index 03/09/2025, 06:53:58
2025-03-09 06:54:38,497 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 40.3735 secs
2025-03-09 06:54:38,498 [INFO]: The best hyperparameters are: efSearch=224
2025-03-09 06:54:38,498 [INFO]: 	Compute fast metrics 03/09/2025, 06:54:38
  0%|          | 0/4 [00:00<?, ?it/s] 50%|█████     | 2/4 [00:00<00:00, 18.37it/s] 75%|███████▌  | 3/4 [00:00<00:00, 19.71it/s]
2025-03-09 06:54:50,334 [INFO]: 	>>> Finished "Compute fast metrics" in 11.8366 secs
2025-03-09 06:54:50,337 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 54.4225 secs
2025-03-09 06:54:50,338 [INFO]: {
2025-03-09 06:54:50,338 [INFO]: 	index_key: HNSW15
2025-03-09 06:54:50,338 [INFO]: 	index_param: efSearch=224
2025-03-09 06:54:50,338 [INFO]: 	index_path: knn.index
2025-03-09 06:54:50,338 [INFO]: 	size in bytes: 549702130
2025-03-09 06:54:50,338 [INFO]: 	avg_search_speed_ms: 10.419082698839096
2025-03-09 06:54:50,338 [INFO]: 	99p_search_speed_ms: 22.118604558054354
2025-03-09 06:54:50,338 [INFO]: 	reconstruction error %: 0.0
2025-03-09 06:54:50,338 [INFO]: 	nb vectors: 2794
2025-03-09 06:54:50,338 [INFO]: 	vectors dimension: 49152
2025-03-09 06:54:50,338 [INFO]: 	compression ratio: 0.9993098480444309
2025-03-09 06:54:50,338 [INFO]: }
2025-03-09 06:54:50,338 [INFO]: 	>>> Finished "Creating the index" in 54.4242 secs
2025-03-09 06:54:50,338 [INFO]: >>> Finished "Launching the whole pipeline" in 54.4559 secs
2025-03-09 06:54:51: [retrieval_preprocessing] calculating distances ...
2025-03-09 06:54:52: [retrieval_preprocessing] finished and saved retrieval indices for episode 70284 [episode count 7/20]
[retrieval_preprocessing] for episode 90381 [episode count 8/20], we have num_retrieval=np.int64(2788) num_query=np.int64(209)
2025-03-09 06:54:52,254 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-09 06:54:52,624 [INFO]: Launching the whole pipeline 03/09/2025, 06:54:52
2025-03-09 06:54:52,624 [INFO]: Reading total number of vectors and dimension 03/09/2025, 06:54:52
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1412.70it/s]
2025-03-09 06:54:52,660 [INFO]: There are 2788 embeddings of dim 49152
2025-03-09 06:54:52,660 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0356 secs
2025-03-09 06:54:52,660 [INFO]: 	Compute estimated construction time of the index 03/09/2025, 06:54:52
2025-03-09 06:54:52,660 [INFO]: 		-> Train: 16.7 minutes
2025-03-09 06:54:52,660 [INFO]: 		-> Add: 1.5 seconds
2025-03-09 06:54:52,660 [INFO]: 		Total: 16.7 minutes
2025-03-09 06:54:52,660 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0001 secs
2025-03-09 06:54:52,660 [INFO]: 	Checking that your have enough memory available to create the index 03/09/2025, 06:54:52
2025-03-09 06:54:52,660 [INFO]: 575.4MB of memory will be needed to build the index (more might be used if you have more)
2025-03-09 06:54:52,660 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0001 secs
2025-03-09 06:54:52,661 [INFO]: 	Selecting most promising index types given data characteristics 03/09/2025, 06:54:52
2025-03-09 06:54:52,661 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-09 06:54:52,661 [INFO]: 	Creating the index 03/09/2025, 06:54:52
2025-03-09 06:54:52,661 [INFO]: 		-> Instanciate the index HNSW15 03/09/2025, 06:54:52
2025-03-09 06:54:52,662 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0011 secs
2025-03-09 06:54:52,662 [INFO]: 		-> Adding the vectors to the index 03/09/2025, 06:54:52
2025-03-09 06:54:52,662 [INFO]: The memory available for adding the vectors is 49.5GB(total available - used by the index)
2025-03-09 06:54:52,662 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/11 [00:00<?, ?it/s] 18%|█▊        | 2/11 [00:00<00:00, 18.19it/s] 73%|███████▎  | 8/11 [00:00<00:00, 37.63it/s]100%|██████████| 11/11 [00:02<00:00,  4.94it/s]
2025-03-09 06:54:54,892 [INFO]: 	Computing best hyperparameters for index knn.index 03/09/2025, 06:54:54
2025-03-09 06:55:33,803 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 38.9109 secs
2025-03-09 06:55:33,803 [INFO]: The best hyperparameters are: efSearch=252
2025-03-09 06:55:33,803 [INFO]: 	Compute fast metrics 03/09/2025, 06:55:33
  0%|          | 0/4 [00:00<?, ?it/s] 50%|█████     | 2/4 [00:00<00:00, 18.92it/s] 75%|███████▌  | 3/4 [00:00<00:00, 20.33it/s]
2025-03-09 06:55:45,406 [INFO]: 	>>> Finished "Compute fast metrics" in 11.6022 secs
2025-03-09 06:55:45,407 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 52.7455 secs
2025-03-09 06:55:45,407 [INFO]: {
2025-03-09 06:55:45,408 [INFO]: 	index_key: HNSW15
2025-03-09 06:55:45,408 [INFO]: 	index_param: efSearch=252
2025-03-09 06:55:45,408 [INFO]: 	index_path: knn.index
2025-03-09 06:55:45,408 [INFO]: 	size in bytes: 548521630
2025-03-09 06:55:45,408 [INFO]: 	avg_search_speed_ms: 11.261404472820645
2025-03-09 06:55:45,408 [INFO]: 	99p_search_speed_ms: 25.358830767218024
2025-03-09 06:55:45,408 [INFO]: 	reconstruction error %: 0.0
2025-03-09 06:55:45,408 [INFO]: 	nb vectors: 2788
2025-03-09 06:55:45,408 [INFO]: 	vectors dimension: 49152
2025-03-09 06:55:45,408 [INFO]: 	compression ratio: 0.9993099160009424
2025-03-09 06:55:45,408 [INFO]: }
2025-03-09 06:55:45,408 [INFO]: 	>>> Finished "Creating the index" in 52.7471 secs
2025-03-09 06:55:45,408 [INFO]: >>> Finished "Launching the whole pipeline" in 52.7833 secs
2025-03-09 06:55:46: [retrieval_preprocessing] calculating distances ...
2025-03-09 06:55:47: [retrieval_preprocessing] finished and saved retrieval indices for episode 90381 [episode count 8/20]
[retrieval_preprocessing] for episode 32018 [episode count 9/20], we have num_retrieval=np.int64(2873) num_query=np.int64(124)
2025-03-09 06:55:47,697 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-09 06:55:48,075 [INFO]: Launching the whole pipeline 03/09/2025, 06:55:48
2025-03-09 06:55:48,075 [INFO]: Reading total number of vectors and dimension 03/09/2025, 06:55:48
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1276.42it/s]
2025-03-09 06:55:48,107 [INFO]: There are 2873 embeddings of dim 49152
2025-03-09 06:55:48,107 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0317 secs
2025-03-09 06:55:48,107 [INFO]: 	Compute estimated construction time of the index 03/09/2025, 06:55:48
2025-03-09 06:55:48,107 [INFO]: 		-> Train: 16.7 minutes
2025-03-09 06:55:48,107 [INFO]: 		-> Add: 1.6 seconds
2025-03-09 06:55:48,107 [INFO]: 		Total: 16.7 minutes
2025-03-09 06:55:48,107 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0001 secs
2025-03-09 06:55:48,107 [INFO]: 	Checking that your have enough memory available to create the index 03/09/2025, 06:55:48
2025-03-09 06:55:48,107 [INFO]: 592.9MB of memory will be needed to build the index (more might be used if you have more)
2025-03-09 06:55:48,107 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0001 secs
2025-03-09 06:55:48,107 [INFO]: 	Selecting most promising index types given data characteristics 03/09/2025, 06:55:48
2025-03-09 06:55:48,107 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-09 06:55:48,107 [INFO]: 	Creating the index 03/09/2025, 06:55:48
2025-03-09 06:55:48,108 [INFO]: 		-> Instanciate the index HNSW15 03/09/2025, 06:55:48
2025-03-09 06:55:48,109 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0010 secs
2025-03-09 06:55:48,109 [INFO]: 		-> Adding the vectors to the index 03/09/2025, 06:55:48
2025-03-09 06:55:48,109 [INFO]: The memory available for adding the vectors is 49.5GB(total available - used by the index)
2025-03-09 06:55:48,109 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/12 [00:00<?, ?it/s] 17%|█▋        | 2/12 [00:00<00:00, 17.20it/s] 58%|█████▊    | 7/12 [00:00<00:00, 30.59it/s] 92%|█████████▏| 11/12 [00:00<00:00, 28.65it/s]100%|██████████| 12/12 [00:02<00:00,  4.43it/s]
2025-03-09 06:55:50,819 [INFO]: 	Computing best hyperparameters for index knn.index 03/09/2025, 06:55:50
2025-03-09 06:56:30,361 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 39.5415 secs
2025-03-09 06:56:30,361 [INFO]: The best hyperparameters are: efSearch=246
2025-03-09 06:56:30,361 [INFO]: 	Compute fast metrics 03/09/2025, 06:56:30
  0%|          | 0/4 [00:00<?, ?it/s] 50%|█████     | 2/4 [00:00<00:00, 19.03it/s] 75%|███████▌  | 3/4 [00:00<00:00, 19.89it/s]
2025-03-09 06:56:43,649 [INFO]: 	>>> Finished "Compute fast metrics" in 13.2880 secs
2025-03-09 06:56:43,651 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 55.5427 secs
2025-03-09 06:56:43,652 [INFO]: {
2025-03-09 06:56:43,652 [INFO]: 	index_key: HNSW15
2025-03-09 06:56:43,652 [INFO]: 	index_param: efSearch=246
2025-03-09 06:56:43,652 [INFO]: 	index_path: knn.index
2025-03-09 06:56:43,652 [INFO]: 	size in bytes: 565244950
2025-03-09 06:56:43,652 [INFO]: 	avg_search_speed_ms: 11.00908414172818
2025-03-09 06:56:43,652 [INFO]: 	99p_search_speed_ms: 26.19780972599983
2025-03-09 06:56:43,652 [INFO]: 	reconstruction error %: 0.0
2025-03-09 06:56:43,652 [INFO]: 	nb vectors: 2873
2025-03-09 06:56:43,652 [INFO]: 	vectors dimension: 49152
2025-03-09 06:56:43,652 [INFO]: 	compression ratio: 0.9993097399631788
2025-03-09 06:56:43,652 [INFO]: }
2025-03-09 06:56:43,652 [INFO]: 	>>> Finished "Creating the index" in 55.5443 secs
2025-03-09 06:56:43,652 [INFO]: >>> Finished "Launching the whole pipeline" in 55.5766 secs
2025-03-09 06:56:44: [retrieval_preprocessing] calculating distances ...
2025-03-09 06:56:44: [retrieval_preprocessing] finished and saved retrieval indices for episode 32018 [episode count 9/20]
[retrieval_preprocessing] for episode 20883 [episode count 10/20], we have num_retrieval=np.int64(2864) num_query=np.int64(133)
2025-03-09 06:56:45,282 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-09 06:56:45,709 [INFO]: Launching the whole pipeline 03/09/2025, 06:56:45
2025-03-09 06:56:45,709 [INFO]: Reading total number of vectors and dimension 03/09/2025, 06:56:45
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1734.62it/s]
2025-03-09 06:56:45,739 [INFO]: There are 2864 embeddings of dim 49152
2025-03-09 06:56:45,739 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0299 secs
2025-03-09 06:56:45,739 [INFO]: 	Compute estimated construction time of the index 03/09/2025, 06:56:45
2025-03-09 06:56:45,739 [INFO]: 		-> Train: 16.7 minutes
2025-03-09 06:56:45,739 [INFO]: 		-> Add: 1.6 seconds
2025-03-09 06:56:45,739 [INFO]: 		Total: 16.7 minutes
2025-03-09 06:56:45,740 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0001 secs
2025-03-09 06:56:45,740 [INFO]: 	Checking that your have enough memory available to create the index 03/09/2025, 06:56:45
2025-03-09 06:56:45,740 [INFO]: 591.1MB of memory will be needed to build the index (more might be used if you have more)
2025-03-09 06:56:45,740 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0001 secs
2025-03-09 06:56:45,740 [INFO]: 	Selecting most promising index types given data characteristics 03/09/2025, 06:56:45
2025-03-09 06:56:45,740 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-09 06:56:45,740 [INFO]: 	Creating the index 03/09/2025, 06:56:45
2025-03-09 06:56:45,740 [INFO]: 		-> Instanciate the index HNSW15 03/09/2025, 06:56:45
2025-03-09 06:56:45,741 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0009 secs
2025-03-09 06:56:45,741 [INFO]: 		-> Adding the vectors to the index 03/09/2025, 06:56:45
2025-03-09 06:56:45,741 [INFO]: The memory available for adding the vectors is 49.5GB(total available - used by the index)
2025-03-09 06:56:45,741 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/12 [00:00<?, ?it/s]  8%|▊         | 1/12 [00:00<00:01,  8.71it/s] 58%|█████▊    | 7/12 [00:00<00:00, 33.48it/s]100%|██████████| 12/12 [00:02<00:00,  4.08it/s]100%|██████████| 12/12 [00:02<00:00,  4.86it/s]
2025-03-09 06:56:48,215 [INFO]: 	Computing best hyperparameters for index knn.index 03/09/2025, 06:56:48
2025-03-09 06:57:23,597 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 35.3815 secs
2025-03-09 06:57:23,597 [INFO]: The best hyperparameters are: efSearch=272
2025-03-09 06:57:23,597 [INFO]: 	Compute fast metrics 03/09/2025, 06:57:23
  0%|          | 0/4 [00:00<?, ?it/s] 50%|█████     | 2/4 [00:00<00:00, 18.10it/s] 75%|███████▌  | 3/4 [00:00<00:00, 20.02it/s]
2025-03-09 06:57:35,204 [INFO]: 	>>> Finished "Compute fast metrics" in 11.6068 secs
2025-03-09 06:57:35,206 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 49.4650 secs
2025-03-09 06:57:35,206 [INFO]: {
2025-03-09 06:57:35,206 [INFO]: 	index_key: HNSW15
2025-03-09 06:57:35,206 [INFO]: 	index_param: efSearch=272
2025-03-09 06:57:35,206 [INFO]: 	index_path: knn.index
2025-03-09 06:57:35,206 [INFO]: 	size in bytes: 563474290
2025-03-09 06:57:35,206 [INFO]: 	avg_search_speed_ms: 9.728082984319892
2025-03-09 06:57:35,206 [INFO]: 	99p_search_speed_ms: 13.203520423267038
2025-03-09 06:57:35,206 [INFO]: 	reconstruction error %: 0.0
2025-03-09 06:57:35,206 [INFO]: 	nb vectors: 2864
2025-03-09 06:57:35,206 [INFO]: 	vectors dimension: 49152
2025-03-09 06:57:35,206 [INFO]: 	compression ratio: 0.999309679240201
2025-03-09 06:57:35,206 [INFO]: }
2025-03-09 06:57:35,206 [INFO]: 	>>> Finished "Creating the index" in 49.4663 secs
2025-03-09 06:57:35,206 [INFO]: >>> Finished "Launching the whole pipeline" in 49.4968 secs
2025-03-09 06:57:36: [retrieval_preprocessing] calculating distances ...
2025-03-09 06:57:36: [retrieval_preprocessing] finished and saved retrieval indices for episode 20883 [episode count 10/20]
[retrieval_preprocessing] for episode 9366 [episode count 11/20], we have num_retrieval=np.int64(2827) num_query=np.int64(170)
2025-03-09 06:57:36,604 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-09 06:57:36,956 [INFO]: Launching the whole pipeline 03/09/2025, 06:57:36
2025-03-09 06:57:36,956 [INFO]: Reading total number of vectors and dimension 03/09/2025, 06:57:36
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1532.45it/s]
2025-03-09 06:57:36,987 [INFO]: There are 2827 embeddings of dim 49152
2025-03-09 06:57:36,988 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0314 secs
2025-03-09 06:57:36,988 [INFO]: 	Compute estimated construction time of the index 03/09/2025, 06:57:36
2025-03-09 06:57:36,988 [INFO]: 		-> Train: 16.7 minutes
2025-03-09 06:57:36,988 [INFO]: 		-> Add: 1.6 seconds
2025-03-09 06:57:36,988 [INFO]: 		Total: 16.7 minutes
2025-03-09 06:57:36,988 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0001 secs
2025-03-09 06:57:36,988 [INFO]: 	Checking that your have enough memory available to create the index 03/09/2025, 06:57:36
2025-03-09 06:57:36,988 [INFO]: 583.4MB of memory will be needed to build the index (more might be used if you have more)
2025-03-09 06:57:36,988 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0001 secs
2025-03-09 06:57:36,988 [INFO]: 	Selecting most promising index types given data characteristics 03/09/2025, 06:57:36
2025-03-09 06:57:36,988 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-09 06:57:36,988 [INFO]: 	Creating the index 03/09/2025, 06:57:36
2025-03-09 06:57:36,988 [INFO]: 		-> Instanciate the index HNSW15 03/09/2025, 06:57:36
2025-03-09 06:57:36,989 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0010 secs
2025-03-09 06:57:36,989 [INFO]: 		-> Adding the vectors to the index 03/09/2025, 06:57:36
2025-03-09 06:57:36,989 [INFO]: The memory available for adding the vectors is 49.5GB(total available - used by the index)
2025-03-09 06:57:36,989 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/12 [00:00<?, ?it/s] 17%|█▋        | 2/12 [00:00<00:00, 17.51it/s] 58%|█████▊    | 7/12 [00:00<00:00, 35.53it/s]100%|██████████| 12/12 [00:02<00:00,  4.28it/s]100%|██████████| 12/12 [00:02<00:00,  5.20it/s]
2025-03-09 06:57:39,298 [INFO]: 	Computing best hyperparameters for index knn.index 03/09/2025, 06:57:39
2025-03-09 06:58:16,782 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 37.4840 secs
2025-03-09 06:58:16,782 [INFO]: The best hyperparameters are: efSearch=262
2025-03-09 06:58:16,782 [INFO]: 	Compute fast metrics 03/09/2025, 06:58:16
  0%|          | 0/4 [00:00<?, ?it/s] 50%|█████     | 2/4 [00:00<00:00, 19.77it/s] 75%|███████▌  | 3/4 [00:00<00:00, 22.14it/s]
2025-03-09 06:58:28,402 [INFO]: 	>>> Finished "Compute fast metrics" in 11.6195 secs
2025-03-09 06:58:28,403 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 51.4140 secs
2025-03-09 06:58:28,403 [INFO]: {
2025-03-09 06:58:28,403 [INFO]: 	index_key: HNSW15
2025-03-09 06:58:28,403 [INFO]: 	index_param: efSearch=262
2025-03-09 06:58:28,403 [INFO]: 	index_path: knn.index
2025-03-09 06:58:28,403 [INFO]: 	size in bytes: 556194730
2025-03-09 06:58:28,403 [INFO]: 	avg_search_speed_ms: 10.328146782010979
2025-03-09 06:58:28,403 [INFO]: 	99p_search_speed_ms: 15.04488280043007
2025-03-09 06:58:28,403 [INFO]: 	reconstruction error %: 0.0
2025-03-09 06:58:28,403 [INFO]: 	nb vectors: 2827
2025-03-09 06:58:28,403 [INFO]: 	vectors dimension: 49152
2025-03-09 06:58:28,403 [INFO]: 	compression ratio: 0.999309748943504
2025-03-09 06:58:28,403 [INFO]: }
2025-03-09 06:58:28,403 [INFO]: 	>>> Finished "Creating the index" in 51.4154 secs
2025-03-09 06:58:28,403 [INFO]: >>> Finished "Launching the whole pipeline" in 51.4473 secs
2025-03-09 06:58:29: [retrieval_preprocessing] calculating distances ...
2025-03-09 06:58:29: [retrieval_preprocessing] finished and saved retrieval indices for episode 9366 [episode count 11/20]
[retrieval_preprocessing] for episode 1817 [episode count 12/20], we have num_retrieval=np.int64(2844) num_query=np.int64(153)
2025-03-09 06:58:30,225 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-09 06:58:30,594 [INFO]: Launching the whole pipeline 03/09/2025, 06:58:30
2025-03-09 06:58:30,594 [INFO]: Reading total number of vectors and dimension 03/09/2025, 06:58:30
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1694.67it/s]
2025-03-09 06:58:30,623 [INFO]: There are 2844 embeddings of dim 49152
2025-03-09 06:58:30,624 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0297 secs
2025-03-09 06:58:30,624 [INFO]: 	Compute estimated construction time of the index 03/09/2025, 06:58:30
2025-03-09 06:58:30,624 [INFO]: 		-> Train: 16.7 minutes
2025-03-09 06:58:30,624 [INFO]: 		-> Add: 1.6 seconds
2025-03-09 06:58:30,624 [INFO]: 		Total: 16.7 minutes
2025-03-09 06:58:30,624 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0001 secs
2025-03-09 06:58:30,624 [INFO]: 	Checking that your have enough memory available to create the index 03/09/2025, 06:58:30
2025-03-09 06:58:30,624 [INFO]: 586.9MB of memory will be needed to build the index (more might be used if you have more)
2025-03-09 06:58:30,624 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0001 secs
2025-03-09 06:58:30,624 [INFO]: 	Selecting most promising index types given data characteristics 03/09/2025, 06:58:30
2025-03-09 06:58:30,624 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-09 06:58:30,624 [INFO]: 	Creating the index 03/09/2025, 06:58:30
2025-03-09 06:58:30,624 [INFO]: 		-> Instanciate the index HNSW15 03/09/2025, 06:58:30
2025-03-09 06:58:30,625 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0009 secs
2025-03-09 06:58:30,625 [INFO]: 		-> Adding the vectors to the index 03/09/2025, 06:58:30
2025-03-09 06:58:30,625 [INFO]: The memory available for adding the vectors is 49.5GB(total available - used by the index)
2025-03-09 06:58:30,625 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/12 [00:00<?, ?it/s]  8%|▊         | 1/12 [00:00<00:01,  9.33it/s] 58%|█████▊    | 7/12 [00:00<00:00, 35.78it/s]100%|██████████| 12/12 [00:02<00:00,  3.92it/s]100%|██████████| 12/12 [00:02<00:00,  4.68it/s]
2025-03-09 06:58:33,191 [INFO]: 	Computing best hyperparameters for index knn.index 03/09/2025, 06:58:33
2025-03-09 06:59:09,102 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 35.9108 secs
2025-03-09 06:59:09,103 [INFO]: The best hyperparameters are: efSearch=291
2025-03-09 06:59:09,103 [INFO]: 	Compute fast metrics 03/09/2025, 06:59:09
  0%|          | 0/4 [00:00<?, ?it/s] 50%|█████     | 2/4 [00:00<00:00, 16.28it/s] 75%|███████▌  | 3/4 [00:00<00:00, 17.66it/s]
2025-03-09 06:59:21,233 [INFO]: 	>>> Finished "Compute fast metrics" in 12.1300 secs
2025-03-09 06:59:21,234 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 50.6091 secs
2025-03-09 06:59:21,234 [INFO]: {
2025-03-09 06:59:21,234 [INFO]: 	index_key: HNSW15
2025-03-09 06:59:21,234 [INFO]: 	index_param: efSearch=291
2025-03-09 06:59:21,234 [INFO]: 	index_path: knn.index
2025-03-09 06:59:21,235 [INFO]: 	size in bytes: 559539430
2025-03-09 06:59:21,235 [INFO]: 	avg_search_speed_ms: 12.485403248682134
2025-03-09 06:59:21,235 [INFO]: 	99p_search_speed_ms: 20.067152101546526
2025-03-09 06:59:21,235 [INFO]: 	reconstruction error %: 0.0
2025-03-09 06:59:21,235 [INFO]: 	nb vectors: 2844
2025-03-09 06:59:21,235 [INFO]: 	vectors dimension: 49152
2025-03-09 06:59:21,235 [INFO]: 	compression ratio: 0.9993096500813178
2025-03-09 06:59:21,235 [INFO]: }
2025-03-09 06:59:21,235 [INFO]: 	>>> Finished "Creating the index" in 50.6105 secs
2025-03-09 06:59:21,235 [INFO]: >>> Finished "Launching the whole pipeline" in 50.6407 secs
2025-03-09 06:59:22: [retrieval_preprocessing] calculating distances ...
2025-03-09 06:59:22: [retrieval_preprocessing] finished and saved retrieval indices for episode 1817 [episode count 12/20]
[retrieval_preprocessing] for episode 67743 [episode count 13/20], we have num_retrieval=np.int64(2896) num_query=np.int64(101)
2025-03-09 06:59:22,828 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-09 06:59:23,201 [INFO]: Launching the whole pipeline 03/09/2025, 06:59:23
2025-03-09 06:59:23,201 [INFO]: Reading total number of vectors and dimension 03/09/2025, 06:59:23
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 2211.02it/s]
2025-03-09 06:59:23,230 [INFO]: There are 2896 embeddings of dim 49152
2025-03-09 06:59:23,230 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0286 secs
2025-03-09 06:59:23,230 [INFO]: 	Compute estimated construction time of the index 03/09/2025, 06:59:23
2025-03-09 06:59:23,230 [INFO]: 		-> Train: 16.7 minutes
2025-03-09 06:59:23,230 [INFO]: 		-> Add: 1.6 seconds
2025-03-09 06:59:23,230 [INFO]: 		Total: 16.7 minutes
2025-03-09 06:59:23,230 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0001 secs
2025-03-09 06:59:23,230 [INFO]: 	Checking that your have enough memory available to create the index 03/09/2025, 06:59:23
2025-03-09 06:59:23,230 [INFO]: 597.7MB of memory will be needed to build the index (more might be used if you have more)
2025-03-09 06:59:23,230 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0001 secs
2025-03-09 06:59:23,230 [INFO]: 	Selecting most promising index types given data characteristics 03/09/2025, 06:59:23
2025-03-09 06:59:23,230 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-09 06:59:23,230 [INFO]: 	Creating the index 03/09/2025, 06:59:23
2025-03-09 06:59:23,230 [INFO]: 		-> Instanciate the index HNSW15 03/09/2025, 06:59:23
2025-03-09 06:59:23,231 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0010 secs
2025-03-09 06:59:23,231 [INFO]: 		-> Adding the vectors to the index 03/09/2025, 06:59:23
2025-03-09 06:59:23,232 [INFO]: The memory available for adding the vectors is 49.5GB(total available - used by the index)
2025-03-09 06:59:23,232 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/12 [00:00<?, ?it/s]  8%|▊         | 1/12 [00:00<00:01,  9.78it/s] 50%|█████     | 6/12 [00:00<00:00, 32.07it/s]100%|██████████| 12/12 [00:02<00:00,  4.49it/s]100%|██████████| 12/12 [00:02<00:00,  5.19it/s]
2025-03-09 06:59:25,547 [INFO]: 	Computing best hyperparameters for index knn.index 03/09/2025, 06:59:25
2025-03-09 07:00:00,489 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 34.9409 secs
2025-03-09 07:00:00,489 [INFO]: The best hyperparameters are: efSearch=278
2025-03-09 07:00:00,490 [INFO]: 	Compute fast metrics 03/09/2025, 07:00:00
  0%|          | 0/4 [00:00<?, ?it/s] 50%|█████     | 2/4 [00:00<00:00, 18.08it/s] 75%|███████▌  | 3/4 [00:00<00:00, 19.94it/s]
2025-03-09 07:00:12,245 [INFO]: 	>>> Finished "Compute fast metrics" in 11.7556 secs
2025-03-09 07:00:12,247 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 49.0158 secs
2025-03-09 07:00:12,247 [INFO]: {
2025-03-09 07:00:12,248 [INFO]: 	index_key: HNSW15
2025-03-09 07:00:12,248 [INFO]: 	index_param: efSearch=278
2025-03-09 07:00:12,248 [INFO]: 	index_path: knn.index
2025-03-09 07:00:12,248 [INFO]: 	size in bytes: 569770030
2025-03-09 07:00:12,248 [INFO]: 	avg_search_speed_ms: 10.827797921868324
2025-03-09 07:00:12,248 [INFO]: 	99p_search_speed_ms: 16.338460939005017
2025-03-09 07:00:12,248 [INFO]: 	reconstruction error %: 0.0
2025-03-09 07:00:12,248 [INFO]: 	nb vectors: 2896
2025-03-09 07:00:12,248 [INFO]: 	vectors dimension: 49152
2025-03-09 07:00:12,248 [INFO]: 	compression ratio: 0.9993097881964764
2025-03-09 07:00:12,248 [INFO]: }
2025-03-09 07:00:12,248 [INFO]: 	>>> Finished "Creating the index" in 49.0175 secs
2025-03-09 07:00:12,248 [INFO]: >>> Finished "Launching the whole pipeline" in 49.0466 secs
2025-03-09 07:00:13: [retrieval_preprocessing] calculating distances ...
2025-03-09 07:00:13: [retrieval_preprocessing] finished and saved retrieval indices for episode 67743 [episode count 13/20]
[retrieval_preprocessing] for episode 90401 [episode count 14/20], we have num_retrieval=np.int64(2852) num_query=np.int64(145)
2025-03-09 07:00:13,781 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-09 07:00:14,333 [INFO]: Launching the whole pipeline 03/09/2025, 07:00:14
2025-03-09 07:00:14,333 [INFO]: Reading total number of vectors and dimension 03/09/2025, 07:00:14
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1291.75it/s]
2025-03-09 07:00:14,370 [INFO]: There are 2852 embeddings of dim 49152
2025-03-09 07:00:14,371 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0377 secs
2025-03-09 07:00:14,371 [INFO]: 	Compute estimated construction time of the index 03/09/2025, 07:00:14
2025-03-09 07:00:14,371 [INFO]: 		-> Train: 16.7 minutes
2025-03-09 07:00:14,372 [INFO]: 		-> Add: 1.6 seconds
2025-03-09 07:00:14,372 [INFO]: 		Total: 16.7 minutes
2025-03-09 07:00:14,372 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0004 secs
2025-03-09 07:00:14,372 [INFO]: 	Checking that your have enough memory available to create the index 03/09/2025, 07:00:14
2025-03-09 07:00:14,372 [INFO]: 588.6MB of memory will be needed to build the index (more might be used if you have more)
2025-03-09 07:00:14,372 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0003 secs
2025-03-09 07:00:14,372 [INFO]: 	Selecting most promising index types given data characteristics 03/09/2025, 07:00:14
2025-03-09 07:00:14,372 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-09 07:00:14,373 [INFO]: 	Creating the index 03/09/2025, 07:00:14
2025-03-09 07:00:14,373 [INFO]: 		-> Instanciate the index HNSW15 03/09/2025, 07:00:14
2025-03-09 07:00:14,375 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0017 secs
2025-03-09 07:00:14,375 [INFO]: 		-> Adding the vectors to the index 03/09/2025, 07:00:14
2025-03-09 07:00:14,375 [INFO]: The memory available for adding the vectors is 49.5GB(total available - used by the index)
2025-03-09 07:00:14,375 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/12 [00:00<?, ?it/s] 17%|█▋        | 2/12 [00:00<00:00, 17.91it/s] 50%|█████     | 6/12 [00:00<00:00, 29.71it/s] 83%|████████▎ | 10/12 [00:00<00:00, 33.70it/s]100%|██████████| 12/12 [00:02<00:00,  4.73it/s]
2025-03-09 07:00:16,914 [INFO]: 	Computing best hyperparameters for index knn.index 03/09/2025, 07:00:16
2025-03-09 07:00:52,688 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 35.7734 secs
2025-03-09 07:00:52,688 [INFO]: The best hyperparameters are: efSearch=285
2025-03-09 07:00:52,688 [INFO]: 	Compute fast metrics 03/09/2025, 07:00:52
  0%|          | 0/4 [00:00<?, ?it/s] 50%|█████     | 2/4 [00:00<00:00, 19.14it/s] 75%|███████▌  | 3/4 [00:00<00:00, 20.73it/s]
2025-03-09 07:01:06,621 [INFO]: 	>>> Finished "Compute fast metrics" in 13.9332 secs
2025-03-09 07:01:06,623 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 52.2483 secs
2025-03-09 07:01:06,623 [INFO]: {
2025-03-09 07:01:06,623 [INFO]: 	index_key: HNSW15
2025-03-09 07:01:06,623 [INFO]: 	index_param: efSearch=285
2025-03-09 07:01:06,623 [INFO]: 	index_path: knn.index
2025-03-09 07:01:06,623 [INFO]: 	size in bytes: 561113350
2025-03-09 07:01:06,623 [INFO]: 	avg_search_speed_ms: 10.568985773777587
2025-03-09 07:01:06,623 [INFO]: 	99p_search_speed_ms: 14.08364115282893
2025-03-09 07:01:06,623 [INFO]: 	reconstruction error %: 0.0
2025-03-09 07:01:06,623 [INFO]: 	nb vectors: 2852
2025-03-09 07:01:06,623 [INFO]: 	vectors dimension: 49152
2025-03-09 07:01:06,623 [INFO]: 	compression ratio: 0.9993097045365255
2025-03-09 07:01:06,623 [INFO]: }
2025-03-09 07:01:06,623 [INFO]: 	>>> Finished "Creating the index" in 52.2506 secs
2025-03-09 07:01:06,623 [INFO]: >>> Finished "Launching the whole pipeline" in 52.2903 secs
2025-03-09 07:01:07: [retrieval_preprocessing] calculating distances ...
2025-03-09 07:01:08: [retrieval_preprocessing] finished and saved retrieval indices for episode 90401 [episode count 14/20]
[retrieval_preprocessing] for episode 7331 [episode count 15/20], we have num_retrieval=np.int64(2885) num_query=np.int64(112)
2025-03-09 07:01:08,239 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-09 07:01:08,753 [INFO]: Launching the whole pipeline 03/09/2025, 07:01:08
2025-03-09 07:01:08,753 [INFO]: Reading total number of vectors and dimension 03/09/2025, 07:01:08
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1361.79it/s]
2025-03-09 07:01:08,788 [INFO]: There are 2885 embeddings of dim 49152
2025-03-09 07:01:08,788 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0351 secs
2025-03-09 07:01:08,788 [INFO]: 	Compute estimated construction time of the index 03/09/2025, 07:01:08
2025-03-09 07:01:08,788 [INFO]: 		-> Train: 16.7 minutes
2025-03-09 07:01:08,788 [INFO]: 		-> Add: 1.6 seconds
2025-03-09 07:01:08,788 [INFO]: 		Total: 16.7 minutes
2025-03-09 07:01:08,788 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0001 secs
2025-03-09 07:01:08,788 [INFO]: 	Checking that your have enough memory available to create the index 03/09/2025, 07:01:08
2025-03-09 07:01:08,788 [INFO]: 595.4MB of memory will be needed to build the index (more might be used if you have more)
2025-03-09 07:01:08,788 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0002 secs
2025-03-09 07:01:08,788 [INFO]: 	Selecting most promising index types given data characteristics 03/09/2025, 07:01:08
2025-03-09 07:01:08,788 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-09 07:01:08,789 [INFO]: 	Creating the index 03/09/2025, 07:01:08
2025-03-09 07:01:08,789 [INFO]: 		-> Instanciate the index HNSW15 03/09/2025, 07:01:08
2025-03-09 07:01:08,790 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0010 secs
2025-03-09 07:01:08,790 [INFO]: 		-> Adding the vectors to the index 03/09/2025, 07:01:08
2025-03-09 07:01:08,790 [INFO]: The memory available for adding the vectors is 49.5GB(total available - used by the index)
2025-03-09 07:01:08,790 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/12 [00:00<?, ?it/s] 17%|█▋        | 2/12 [00:00<00:00, 18.21it/s] 50%|█████     | 6/12 [00:00<00:00, 29.87it/s] 92%|█████████▏| 11/12 [00:00<00:00, 35.20it/s]100%|██████████| 12/12 [00:02<00:00,  4.69it/s]
2025-03-09 07:01:11,366 [INFO]: 	Computing best hyperparameters for index knn.index 03/09/2025, 07:01:11
2025-03-09 07:01:49,663 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 38.2969 secs
2025-03-09 07:01:49,663 [INFO]: The best hyperparameters are: efSearch=261
2025-03-09 07:01:49,663 [INFO]: 	Compute fast metrics 03/09/2025, 07:01:49
  0%|          | 0/4 [00:00<?, ?it/s] 50%|█████     | 2/4 [00:00<00:00, 19.19it/s] 75%|███████▌  | 3/4 [00:00<00:00, 20.79it/s]
2025-03-09 07:02:01,896 [INFO]: 	>>> Finished "Compute fast metrics" in 12.2326 secs
2025-03-09 07:02:01,898 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 53.1080 secs
2025-03-09 07:02:01,898 [INFO]: {
2025-03-09 07:02:01,898 [INFO]: 	index_key: HNSW15
2025-03-09 07:02:01,898 [INFO]: 	index_param: efSearch=261
2025-03-09 07:02:01,898 [INFO]: 	index_path: knn.index
2025-03-09 07:02:01,898 [INFO]: 	size in bytes: 567605890
2025-03-09 07:02:01,898 [INFO]: 	avg_search_speed_ms: 10.422645279565282
2025-03-09 07:02:01,898 [INFO]: 	99p_search_speed_ms: 15.17436424968764
2025-03-09 07:02:01,898 [INFO]: 	reconstruction error %: 0.0
2025-03-09 07:02:01,898 [INFO]: 	nb vectors: 2885
2025-03-09 07:02:01,898 [INFO]: 	vectors dimension: 49152
2025-03-09 07:02:01,898 [INFO]: 	compression ratio: 0.9993097147036301
2025-03-09 07:02:01,898 [INFO]: }
2025-03-09 07:02:01,898 [INFO]: 	>>> Finished "Creating the index" in 53.1094 secs
2025-03-09 07:02:01,898 [INFO]: >>> Finished "Launching the whole pipeline" in 53.1452 secs
2025-03-09 07:02:02: [retrieval_preprocessing] calculating distances ...
2025-03-09 07:02:03: [retrieval_preprocessing] finished and saved retrieval indices for episode 7331 [episode count 15/20]
[retrieval_preprocessing] for episode 30757 [episode count 16/20], we have num_retrieval=np.int64(2808) num_query=np.int64(189)
2025-03-09 07:02:03,243 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-09 07:02:03,625 [INFO]: Launching the whole pipeline 03/09/2025, 07:02:03
2025-03-09 07:02:03,625 [INFO]: Reading total number of vectors and dimension 03/09/2025, 07:02:03
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1383.80it/s]
2025-03-09 07:02:03,656 [INFO]: There are 2808 embeddings of dim 49152
2025-03-09 07:02:03,656 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0306 secs
2025-03-09 07:02:03,656 [INFO]: 	Compute estimated construction time of the index 03/09/2025, 07:02:03
2025-03-09 07:02:03,656 [INFO]: 		-> Train: 16.7 minutes
2025-03-09 07:02:03,656 [INFO]: 		-> Add: 1.5 seconds
2025-03-09 07:02:03,656 [INFO]: 		Total: 16.7 minutes
2025-03-09 07:02:03,656 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0001 secs
2025-03-09 07:02:03,656 [INFO]: 	Checking that your have enough memory available to create the index 03/09/2025, 07:02:03
2025-03-09 07:02:03,656 [INFO]: 579.5MB of memory will be needed to build the index (more might be used if you have more)
2025-03-09 07:02:03,656 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0002 secs
2025-03-09 07:02:03,657 [INFO]: 	Selecting most promising index types given data characteristics 03/09/2025, 07:02:03
2025-03-09 07:02:03,657 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-09 07:02:03,657 [INFO]: 	Creating the index 03/09/2025, 07:02:03
2025-03-09 07:02:03,657 [INFO]: 		-> Instanciate the index HNSW15 03/09/2025, 07:02:03
2025-03-09 07:02:03,658 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0011 secs
2025-03-09 07:02:03,658 [INFO]: 		-> Adding the vectors to the index 03/09/2025, 07:02:03
2025-03-09 07:02:03,658 [INFO]: The memory available for adding the vectors is 49.5GB(total available - used by the index)
2025-03-09 07:02:03,658 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/12 [00:00<?, ?it/s] 17%|█▋        | 2/12 [00:00<00:00, 17.69it/s] 67%|██████▋   | 8/12 [00:00<00:00, 38.73it/s]100%|██████████| 12/12 [00:02<00:00,  4.18it/s]100%|██████████| 12/12 [00:02<00:00,  5.24it/s]
2025-03-09 07:02:05,951 [INFO]: 	Computing best hyperparameters for index knn.index 03/09/2025, 07:02:05
2025-03-09 07:02:40,945 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 34.9940 secs
2025-03-09 07:02:40,946 [INFO]: The best hyperparameters are: efSearch=283
2025-03-09 07:02:40,946 [INFO]: 	Compute fast metrics 03/09/2025, 07:02:40
  0%|          | 0/4 [00:00<?, ?it/s] 50%|█████     | 2/4 [00:00<00:00, 18.68it/s] 75%|███████▌  | 3/4 [00:00<00:00, 20.57it/s]
2025-03-09 07:02:53,310 [INFO]: 	>>> Finished "Compute fast metrics" in 12.3645 secs
2025-03-09 07:02:53,312 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 49.6540 secs
2025-03-09 07:02:53,312 [INFO]: {
2025-03-09 07:02:53,312 [INFO]: 	index_key: HNSW15
2025-03-09 07:02:53,312 [INFO]: 	index_param: efSearch=283
2025-03-09 07:02:53,312 [INFO]: 	index_path: knn.index
2025-03-09 07:02:53,312 [INFO]: 	size in bytes: 552456610
2025-03-09 07:02:53,312 [INFO]: 	avg_search_speed_ms: 9.869537986024318
2025-03-09 07:02:53,312 [INFO]: 	99p_search_speed_ms: 13.411415675655007
2025-03-09 07:02:53,312 [INFO]: 	reconstruction error %: 0.0
2025-03-09 07:02:53,312 [INFO]: 	nb vectors: 2808
2025-03-09 07:02:53,312 [INFO]: 	vectors dimension: 49152
2025-03-09 07:02:53,312 [INFO]: 	compression ratio: 0.9993097267856023
2025-03-09 07:02:53,312 [INFO]: }
2025-03-09 07:02:53,312 [INFO]: 	>>> Finished "Creating the index" in 49.6555 secs
2025-03-09 07:02:53,312 [INFO]: >>> Finished "Launching the whole pipeline" in 49.6871 secs
2025-03-09 07:02:54: [retrieval_preprocessing] calculating distances ...
2025-03-09 07:02:55: [retrieval_preprocessing] finished and saved retrieval indices for episode 30757 [episode count 16/20]
[retrieval_preprocessing] for episode 46972 [episode count 17/20], we have num_retrieval=np.int64(2889) num_query=np.int64(108)
2025-03-09 07:02:55,372 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-09 07:02:55,717 [INFO]: Launching the whole pipeline 03/09/2025, 07:02:55
2025-03-09 07:02:55,717 [INFO]: Reading total number of vectors and dimension 03/09/2025, 07:02:55
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 2221.56it/s]
2025-03-09 07:02:55,746 [INFO]: There are 2889 embeddings of dim 49152
2025-03-09 07:02:55,746 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0291 secs
2025-03-09 07:02:55,746 [INFO]: 	Compute estimated construction time of the index 03/09/2025, 07:02:55
2025-03-09 07:02:55,746 [INFO]: 		-> Train: 16.7 minutes
2025-03-09 07:02:55,746 [INFO]: 		-> Add: 1.6 seconds
2025-03-09 07:02:55,746 [INFO]: 		Total: 16.7 minutes
2025-03-09 07:02:55,746 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0001 secs
2025-03-09 07:02:55,746 [INFO]: 	Checking that your have enough memory available to create the index 03/09/2025, 07:02:55
2025-03-09 07:02:55,746 [INFO]: 596.2MB of memory will be needed to build the index (more might be used if you have more)
2025-03-09 07:02:55,746 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0001 secs
2025-03-09 07:02:55,746 [INFO]: 	Selecting most promising index types given data characteristics 03/09/2025, 07:02:55
2025-03-09 07:02:55,746 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-09 07:02:55,746 [INFO]: 	Creating the index 03/09/2025, 07:02:55
2025-03-09 07:02:55,746 [INFO]: 		-> Instanciate the index HNSW15 03/09/2025, 07:02:55
2025-03-09 07:02:55,747 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0011 secs
2025-03-09 07:02:55,748 [INFO]: 		-> Adding the vectors to the index 03/09/2025, 07:02:55
2025-03-09 07:02:55,748 [INFO]: The memory available for adding the vectors is 49.5GB(total available - used by the index)
2025-03-09 07:02:55,748 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/12 [00:00<?, ?it/s] 17%|█▋        | 2/12 [00:00<00:00, 17.02it/s] 67%|██████▋   | 8/12 [00:00<00:00, 39.04it/s]100%|██████████| 12/12 [00:02<00:00,  4.31it/s]100%|██████████| 12/12 [00:02<00:00,  5.39it/s]
2025-03-09 07:02:57,975 [INFO]: 	Computing best hyperparameters for index knn.index 03/09/2025, 07:02:57
2025-03-09 07:03:40,201 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 42.2251 secs
2025-03-09 07:03:40,201 [INFO]: The best hyperparameters are: efSearch=256
2025-03-09 07:03:40,201 [INFO]: 	Compute fast metrics 03/09/2025, 07:03:40
  0%|          | 0/4 [00:00<?, ?it/s] 50%|█████     | 2/4 [00:00<00:00, 17.72it/s] 75%|███████▌  | 3/4 [00:00<00:00, 17.75it/s]
2025-03-09 07:03:53,821 [INFO]: 	>>> Finished "Compute fast metrics" in 13.6191 secs
2025-03-09 07:03:53,823 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 58.0748 secs
2025-03-09 07:03:53,823 [INFO]: {
2025-03-09 07:03:53,823 [INFO]: 	index_key: HNSW15
2025-03-09 07:03:53,823 [INFO]: 	index_param: efSearch=256
2025-03-09 07:03:53,823 [INFO]: 	index_path: knn.index
2025-03-09 07:03:53,823 [INFO]: 	size in bytes: 568392850
2025-03-09 07:03:53,823 [INFO]: 	avg_search_speed_ms: 9.992645658947133
2025-03-09 07:03:53,823 [INFO]: 	99p_search_speed_ms: 15.326336026191711
2025-03-09 07:03:53,823 [INFO]: 	reconstruction error %: 0.0
2025-03-09 07:03:53,823 [INFO]: 	nb vectors: 2889
2025-03-09 07:03:53,823 [INFO]: 	vectors dimension: 49152
2025-03-09 07:03:53,823 [INFO]: 	compression ratio: 0.9993097414930536
2025-03-09 07:03:53,823 [INFO]: }
2025-03-09 07:03:53,823 [INFO]: 	>>> Finished "Creating the index" in 58.0766 secs
2025-03-09 07:03:53,823 [INFO]: >>> Finished "Launching the whole pipeline" in 58.1063 secs
2025-03-09 07:03:54: [retrieval_preprocessing] calculating distances ...
2025-03-09 07:03:54: [retrieval_preprocessing] finished and saved retrieval indices for episode 46972 [episode count 17/20]
[retrieval_preprocessing] for episode 12074 [episode count 18/20], we have num_retrieval=np.int64(2887) num_query=np.int64(110)
2025-03-09 07:03:55,001 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-09 07:03:55,510 [INFO]: Launching the whole pipeline 03/09/2025, 07:03:55
2025-03-09 07:03:55,510 [INFO]: Reading total number of vectors and dimension 03/09/2025, 07:03:55
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1736.77it/s]
2025-03-09 07:03:55,539 [INFO]: There are 2887 embeddings of dim 49152
2025-03-09 07:03:55,540 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0298 secs
2025-03-09 07:03:55,540 [INFO]: 	Compute estimated construction time of the index 03/09/2025, 07:03:55
2025-03-09 07:03:55,540 [INFO]: 		-> Train: 16.7 minutes
2025-03-09 07:03:55,540 [INFO]: 		-> Add: 1.6 seconds
2025-03-09 07:03:55,540 [INFO]: 		Total: 16.7 minutes
2025-03-09 07:03:55,540 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0002 secs
2025-03-09 07:03:55,540 [INFO]: 	Checking that your have enough memory available to create the index 03/09/2025, 07:03:55
2025-03-09 07:03:55,540 [INFO]: 595.8MB of memory will be needed to build the index (more might be used if you have more)
2025-03-09 07:03:55,540 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0001 secs
2025-03-09 07:03:55,540 [INFO]: 	Selecting most promising index types given data characteristics 03/09/2025, 07:03:55
2025-03-09 07:03:55,540 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-09 07:03:55,540 [INFO]: 	Creating the index 03/09/2025, 07:03:55
2025-03-09 07:03:55,540 [INFO]: 		-> Instanciate the index HNSW15 03/09/2025, 07:03:55
2025-03-09 07:03:55,541 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0008 secs
2025-03-09 07:03:55,541 [INFO]: 		-> Adding the vectors to the index 03/09/2025, 07:03:55
2025-03-09 07:03:55,541 [INFO]: The memory available for adding the vectors is 49.5GB(total available - used by the index)
2025-03-09 07:03:55,541 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/12 [00:00<?, ?it/s]  8%|▊         | 1/12 [00:00<00:01,  9.28it/s] 58%|█████▊    | 7/12 [00:00<00:00, 36.14it/s]100%|██████████| 12/12 [00:02<00:00,  4.57it/s]100%|██████████| 12/12 [00:02<00:00,  5.43it/s]
2025-03-09 07:03:57,754 [INFO]: 	Computing best hyperparameters for index knn.index 03/09/2025, 07:03:57
2025-03-09 07:04:34,304 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 36.5499 secs
2025-03-09 07:04:34,304 [INFO]: The best hyperparameters are: efSearch=276
2025-03-09 07:04:34,304 [INFO]: 	Compute fast metrics 03/09/2025, 07:04:34
  0%|          | 0/4 [00:00<?, ?it/s] 50%|█████     | 2/4 [00:00<00:00, 18.62it/s] 75%|███████▌  | 3/4 [00:00<00:00, 20.72it/s]
2025-03-09 07:04:45,883 [INFO]: 	>>> Finished "Compute fast metrics" in 11.5794 secs
2025-03-09 07:04:45,885 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 50.3442 secs
2025-03-09 07:04:45,885 [INFO]: {
2025-03-09 07:04:45,885 [INFO]: 	index_key: HNSW15
2025-03-09 07:04:45,885 [INFO]: 	index_param: efSearch=276
2025-03-09 07:04:45,886 [INFO]: 	index_path: knn.index
2025-03-09 07:04:45,886 [INFO]: 	size in bytes: 567999370
2025-03-09 07:04:45,886 [INFO]: 	avg_search_speed_ms: 9.697162613740586
2025-03-09 07:04:45,886 [INFO]: 	99p_search_speed_ms: 13.191562262363732
2025-03-09 07:04:45,886 [INFO]: 	reconstruction error %: 0.0
2025-03-09 07:04:45,886 [INFO]: 	nb vectors: 2887
2025-03-09 07:04:45,886 [INFO]: 	vectors dimension: 49152
2025-03-09 07:04:45,886 [INFO]: 	compression ratio: 0.999309728107621
2025-03-09 07:04:45,886 [INFO]: }
2025-03-09 07:04:45,886 [INFO]: 	>>> Finished "Creating the index" in 50.3455 secs
2025-03-09 07:04:45,886 [INFO]: >>> Finished "Launching the whole pipeline" in 50.3759 secs
2025-03-09 07:04:46: [retrieval_preprocessing] calculating distances ...
2025-03-09 07:04:46: [retrieval_preprocessing] finished and saved retrieval indices for episode 12074 [episode count 18/20]
[retrieval_preprocessing] for episode 5163 [episode count 19/20], we have num_retrieval=np.int64(2878) num_query=np.int64(119)
2025-03-09 07:04:47,181 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-09 07:04:47,514 [INFO]: Launching the whole pipeline 03/09/2025, 07:04:47
2025-03-09 07:04:47,514 [INFO]: Reading total number of vectors and dimension 03/09/2025, 07:04:47
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1176.19it/s]
2025-03-09 07:04:47,544 [INFO]: There are 2878 embeddings of dim 49152
2025-03-09 07:04:47,544 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0301 secs
2025-03-09 07:04:47,544 [INFO]: 	Compute estimated construction time of the index 03/09/2025, 07:04:47
2025-03-09 07:04:47,544 [INFO]: 		-> Train: 16.7 minutes
2025-03-09 07:04:47,544 [INFO]: 		-> Add: 1.6 seconds
2025-03-09 07:04:47,544 [INFO]: 		Total: 16.7 minutes
2025-03-09 07:04:47,544 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0001 secs
2025-03-09 07:04:47,544 [INFO]: 	Checking that your have enough memory available to create the index 03/09/2025, 07:04:47
2025-03-09 07:04:47,544 [INFO]: 593.9MB of memory will be needed to build the index (more might be used if you have more)
2025-03-09 07:04:47,544 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0001 secs
2025-03-09 07:04:47,544 [INFO]: 	Selecting most promising index types given data characteristics 03/09/2025, 07:04:47
2025-03-09 07:04:47,544 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-09 07:04:47,544 [INFO]: 	Creating the index 03/09/2025, 07:04:47
2025-03-09 07:04:47,544 [INFO]: 		-> Instanciate the index HNSW15 03/09/2025, 07:04:47
2025-03-09 07:04:47,545 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0010 secs
2025-03-09 07:04:47,545 [INFO]: 		-> Adding the vectors to the index 03/09/2025, 07:04:47
2025-03-09 07:04:47,545 [INFO]: The memory available for adding the vectors is 49.5GB(total available - used by the index)
2025-03-09 07:04:47,546 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/12 [00:00<?, ?it/s] 17%|█▋        | 2/12 [00:00<00:00, 17.57it/s] 67%|██████▋   | 8/12 [00:00<00:00, 37.76it/s]100%|██████████| 12/12 [00:02<00:00,  4.19it/s]100%|██████████| 12/12 [00:02<00:00,  5.25it/s]
2025-03-09 07:04:49,836 [INFO]: 	Computing best hyperparameters for index knn.index 03/09/2025, 07:04:49
2025-03-09 07:05:29,501 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 39.6646 secs
2025-03-09 07:05:29,501 [INFO]: The best hyperparameters are: efSearch=271
2025-03-09 07:05:29,501 [INFO]: 	Compute fast metrics 03/09/2025, 07:05:29
  0%|          | 0/4 [00:00<?, ?it/s] 50%|█████     | 2/4 [00:00<00:00, 18.87it/s] 75%|███████▌  | 3/4 [00:00<00:00, 21.08it/s]
2025-03-09 07:05:41,537 [INFO]: 	>>> Finished "Compute fast metrics" in 12.0353 secs
2025-03-09 07:05:41,539 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 53.9936 secs
2025-03-09 07:05:41,539 [INFO]: {
2025-03-09 07:05:41,539 [INFO]: 	index_key: HNSW15
2025-03-09 07:05:41,539 [INFO]: 	index_param: efSearch=271
2025-03-09 07:05:41,539 [INFO]: 	index_path: knn.index
2025-03-09 07:05:41,539 [INFO]: 	size in bytes: 566228650
2025-03-09 07:05:41,539 [INFO]: 	avg_search_speed_ms: 11.218495837949433
2025-03-09 07:05:41,539 [INFO]: 	99p_search_speed_ms: 17.777145782019943
2025-03-09 07:05:41,539 [INFO]: 	reconstruction error %: 0.0
2025-03-09 07:05:41,540 [INFO]: 	nb vectors: 2878
2025-03-09 07:05:41,540 [INFO]: 	vectors dimension: 49152
2025-03-09 07:05:41,540 [INFO]: 	compression ratio: 0.9993097735340661
2025-03-09 07:05:41,540 [INFO]: }
2025-03-09 07:05:41,540 [INFO]: 	>>> Finished "Creating the index" in 53.9952 secs
2025-03-09 07:05:41,540 [INFO]: >>> Finished "Launching the whole pipeline" in 54.0258 secs
2025-03-09 07:05:42: [retrieval_preprocessing] calculating distances ...
2025-03-09 07:05:42: [retrieval_preprocessing] finished and saved retrieval indices for episode 5163 [episode count 19/20]
2025-03-09 07:05:42: [retrieval_preprocessing] finished for (2883696971, 'cup') [chosen_id count 0/10]
2025-03-09 07:05:43: [retrieval_preprocessing] concatenated all embeddings and indices for 20 episodes for (9209350647, 'drawer') [chosen_id count 1/10]
2025-03-09 07:05:43: [retrieval_preprocessing] we have num_total=5749 embedding_dim=49152
[retrieval_preprocessing] for episode 53504 [episode count 0/20], we have num_retrieval=np.int64(5519) num_query=np.int64(230)
2025-03-09 07:05:44,126 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-09 07:05:44,780 [INFO]: Launching the whole pipeline 03/09/2025, 07:05:44
2025-03-09 07:05:44,780 [INFO]: Reading total number of vectors and dimension 03/09/2025, 07:05:44
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 2155.35it/s]
2025-03-09 07:05:44,807 [INFO]: There are 5519 embeddings of dim 49152
2025-03-09 07:05:44,807 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0268 secs
2025-03-09 07:05:44,807 [INFO]: 	Compute estimated construction time of the index 03/09/2025, 07:05:44
2025-03-09 07:05:44,807 [INFO]: 		-> Train: 16.7 minutes
2025-03-09 07:05:44,807 [INFO]: 		-> Add: 3.0 seconds
2025-03-09 07:05:44,807 [INFO]: 		Total: 16.7 minutes
2025-03-09 07:05:44,807 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0001 secs
2025-03-09 07:05:44,807 [INFO]: 	Checking that your have enough memory available to create the index 03/09/2025, 07:05:44
2025-03-09 07:05:44,807 [INFO]: 1.1GB of memory will be needed to build the index (more might be used if you have more)
2025-03-09 07:05:44,807 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0001 secs
2025-03-09 07:05:44,807 [INFO]: 	Selecting most promising index types given data characteristics 03/09/2025, 07:05:44
2025-03-09 07:05:44,807 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-09 07:05:44,807 [INFO]: 	Creating the index 03/09/2025, 07:05:44
2025-03-09 07:05:44,807 [INFO]: 		-> Instanciate the index HNSW15 03/09/2025, 07:05:44
2025-03-09 07:05:44,808 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0009 secs
2025-03-09 07:05:44,808 [INFO]: 		-> Adding the vectors to the index 03/09/2025, 07:05:44
2025-03-09 07:05:44,808 [INFO]: The memory available for adding the vectors is 49.0GB(total available - used by the index)
2025-03-09 07:05:44,808 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/23 [00:00<?, ?it/s]  9%|▊         | 2/23 [00:00<00:01, 16.16it/s] 30%|███       | 7/23 [00:00<00:00, 31.50it/s] 57%|█████▋    | 13/23 [00:00<00:00, 41.54it/s] 83%|████████▎ | 19/23 [00:00<00:00, 47.93it/s]100%|██████████| 23/23 [00:05<00:00,  4.05it/s]
2025-03-09 07:05:50,490 [INFO]: 	Computing best hyperparameters for index knn.index 03/09/2025, 07:05:50
2025-03-09 07:06:40,061 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 49.5706 secs
2025-03-09 07:06:40,061 [INFO]: The best hyperparameters are: efSearch=153
2025-03-09 07:06:40,061 [INFO]: 	Compute fast metrics 03/09/2025, 07:06:40
  0%|          | 0/4 [00:00<?, ?it/s] 50%|█████     | 2/4 [00:00<00:00, 18.35it/s] 75%|███████▌  | 3/4 [00:00<00:00, 18.79it/s]
2025-03-09 07:06:53,033 [INFO]: 	>>> Finished "Compute fast metrics" in 12.9714 secs
2025-03-09 07:06:53,033 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 68.2249 secs
2025-03-09 07:06:53,033 [INFO]: {
2025-03-09 07:06:53,033 [INFO]: 	index_key: HNSW15
2025-03-09 07:06:53,033 [INFO]: 	index_param: efSearch=153
2025-03-09 07:06:53,033 [INFO]: 	index_path: knn.index
2025-03-09 07:06:53,033 [INFO]: 	size in bytes: 1085830930
2025-03-09 07:06:53,033 [INFO]: 	avg_search_speed_ms: 9.25677821850749
2025-03-09 07:06:53,034 [INFO]: 	99p_search_speed_ms: 14.857320333831014
2025-03-09 07:06:53,034 [INFO]: 	reconstruction error %: 0.0
2025-03-09 07:06:53,034 [INFO]: 	nb vectors: 5519
2025-03-09 07:06:53,034 [INFO]: 	vectors dimension: 49152
2025-03-09 07:06:53,034 [INFO]: 	compression ratio: 0.9993080156594913
2025-03-09 07:06:53,034 [INFO]: }
2025-03-09 07:06:53,034 [INFO]: 	>>> Finished "Creating the index" in 68.2263 secs
2025-03-09 07:06:53,034 [INFO]: >>> Finished "Launching the whole pipeline" in 68.2535 secs
2025-03-09 07:06:53: [retrieval_preprocessing] calculating distances ...
2025-03-09 07:06:54: [retrieval_preprocessing] finished and saved retrieval indices for episode 53504 [episode count 0/20]
[retrieval_preprocessing] for episode 62080 [episode count 1/20], we have num_retrieval=np.int64(5589) num_query=np.int64(160)
2025-03-09 07:06:55,081 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-09 07:06:55,881 [INFO]: Launching the whole pipeline 03/09/2025, 07:06:55
2025-03-09 07:06:55,881 [INFO]: Reading total number of vectors and dimension 03/09/2025, 07:06:55
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1793.97it/s]
2025-03-09 07:06:55,908 [INFO]: There are 5589 embeddings of dim 49152
2025-03-09 07:06:55,908 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0269 secs
2025-03-09 07:06:55,908 [INFO]: 	Compute estimated construction time of the index 03/09/2025, 07:06:55
2025-03-09 07:06:55,908 [INFO]: 		-> Train: 16.7 minutes
2025-03-09 07:06:55,908 [INFO]: 		-> Add: 3.1 seconds
2025-03-09 07:06:55,908 [INFO]: 		Total: 16.7 minutes
2025-03-09 07:06:55,908 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0001 secs
2025-03-09 07:06:55,908 [INFO]: 	Checking that your have enough memory available to create the index 03/09/2025, 07:06:55
2025-03-09 07:06:55,908 [INFO]: 1.1GB of memory will be needed to build the index (more might be used if you have more)
2025-03-09 07:06:55,908 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0001 secs
2025-03-09 07:06:55,908 [INFO]: 	Selecting most promising index types given data characteristics 03/09/2025, 07:06:55
2025-03-09 07:06:55,908 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-09 07:06:55,908 [INFO]: 	Creating the index 03/09/2025, 07:06:55
2025-03-09 07:06:55,908 [INFO]: 		-> Instanciate the index HNSW15 03/09/2025, 07:06:55
2025-03-09 07:06:55,909 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0010 secs
2025-03-09 07:06:55,909 [INFO]: 		-> Adding the vectors to the index 03/09/2025, 07:06:55
2025-03-09 07:06:55,909 [INFO]: The memory available for adding the vectors is 49.0GB(total available - used by the index)
2025-03-09 07:06:55,910 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/23 [00:00<?, ?it/s]  4%|▍         | 1/23 [00:00<00:02,  8.77it/s] 30%|███       | 7/23 [00:00<00:00, 33.69it/s] 57%|█████▋    | 13/23 [00:00<00:00, 42.51it/s] 83%|████████▎ | 19/23 [00:00<00:00, 46.19it/s]100%|██████████| 23/23 [00:06<00:00,  3.40it/s]
2025-03-09 07:07:02,668 [INFO]: 	Computing best hyperparameters for index knn.index 03/09/2025, 07:07:02
2025-03-09 07:07:55,454 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 52.7853 secs
2025-03-09 07:07:55,483 [INFO]: The best hyperparameters are: efSearch=190
2025-03-09 07:07:55,483 [INFO]: 	Compute fast metrics 03/09/2025, 07:07:55
  0%|          | 0/4 [00:00<?, ?it/s] 25%|██▌       | 1/4 [00:00<00:00,  9.62it/s] 75%|███████▌  | 3/4 [00:00<00:00, 18.10it/s]
2025-03-09 07:08:08,349 [INFO]: 	>>> Finished "Compute fast metrics" in 12.8656 secs
2025-03-09 07:08:08,350 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 72.4404 secs
2025-03-09 07:08:08,350 [INFO]: {
2025-03-09 07:08:08,351 [INFO]: 	index_key: HNSW15
2025-03-09 07:08:08,351 [INFO]: 	index_param: efSearch=190
2025-03-09 07:08:08,351 [INFO]: 	index_path: knn.index
2025-03-09 07:08:08,351 [INFO]: 	size in bytes: 1099603090
2025-03-09 07:08:08,351 [INFO]: 	avg_search_speed_ms: 11.23434989990125
2025-03-09 07:08:08,351 [INFO]: 	99p_search_speed_ms: 20.530246640555568
2025-03-09 07:08:08,351 [INFO]: 	reconstruction error %: 0.0
2025-03-09 07:08:08,351 [INFO]: 	nb vectors: 5589
2025-03-09 07:08:08,351 [INFO]: 	vectors dimension: 49152
2025-03-09 07:08:08,351 [INFO]: 	compression ratio: 0.9993079521084285
2025-03-09 07:08:08,351 [INFO]: }
2025-03-09 07:08:08,351 [INFO]: 	>>> Finished "Creating the index" in 72.4424 secs
2025-03-09 07:08:08,351 [INFO]: >>> Finished "Launching the whole pipeline" in 72.4699 secs
2025-03-09 07:08:09: [retrieval_preprocessing] calculating distances ...
2025-03-09 07:08:09: [retrieval_preprocessing] finished and saved retrieval indices for episode 62080 [episode count 1/20]
[retrieval_preprocessing] for episode 2436 [episode count 2/20], we have num_retrieval=np.int64(5448) num_query=np.int64(301)
2025-03-09 07:08:10,002 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-09 07:08:10,738 [INFO]: Launching the whole pipeline 03/09/2025, 07:08:10
2025-03-09 07:08:10,738 [INFO]: Reading total number of vectors and dimension 03/09/2025, 07:08:10
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1424.21it/s]
2025-03-09 07:08:10,770 [INFO]: There are 5448 embeddings of dim 49152
2025-03-09 07:08:10,770 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0323 secs
2025-03-09 07:08:10,771 [INFO]: 	Compute estimated construction time of the index 03/09/2025, 07:08:10
2025-03-09 07:08:10,771 [INFO]: 		-> Train: 16.7 minutes
2025-03-09 07:08:10,771 [INFO]: 		-> Add: 3.0 seconds
2025-03-09 07:08:10,771 [INFO]: 		Total: 16.7 minutes
2025-03-09 07:08:10,771 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0008 secs
2025-03-09 07:08:10,772 [INFO]: 	Checking that your have enough memory available to create the index 03/09/2025, 07:08:10
2025-03-09 07:08:10,772 [INFO]: 1.1GB of memory will be needed to build the index (more might be used if you have more)
2025-03-09 07:08:10,772 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0005 secs
2025-03-09 07:08:10,772 [INFO]: 	Selecting most promising index types given data characteristics 03/09/2025, 07:08:10
2025-03-09 07:08:10,773 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-09 07:08:10,773 [INFO]: 	Creating the index 03/09/2025, 07:08:10
2025-03-09 07:08:10,773 [INFO]: 		-> Instanciate the index HNSW15 03/09/2025, 07:08:10
2025-03-09 07:08:10,778 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0047 secs
2025-03-09 07:08:10,778 [INFO]: 		-> Adding the vectors to the index 03/09/2025, 07:08:10
2025-03-09 07:08:10,778 [INFO]: The memory available for adding the vectors is 49.0GB(total available - used by the index)
2025-03-09 07:08:10,779 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/23 [00:00<?, ?it/s]  9%|▊         | 2/23 [00:00<00:01, 19.23it/s] 35%|███▍      | 8/23 [00:00<00:00, 39.81it/s] 61%|██████    | 14/23 [00:00<00:00, 46.86it/s] 87%|████████▋ | 20/23 [00:00<00:00, 50.35it/s]100%|██████████| 23/23 [00:06<00:00,  3.76it/s]
2025-03-09 07:08:16,908 [INFO]: 	Computing best hyperparameters for index knn.index 03/09/2025, 07:08:16
2025-03-09 07:09:10,109 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 53.2006 secs
2025-03-09 07:09:10,110 [INFO]: The best hyperparameters are: efSearch=175
2025-03-09 07:09:10,110 [INFO]: 	Compute fast metrics 03/09/2025, 07:09:10
  0%|          | 0/4 [00:00<?, ?it/s] 25%|██▌       | 1/4 [00:00<00:00,  5.23it/s] 75%|███████▌  | 3/4 [00:00<00:00,  8.40it/s] 75%|███████▌  | 3/4 [00:00<00:00,  6.52it/s]
2025-03-09 07:09:23,179 [INFO]: 	>>> Finished "Compute fast metrics" in 13.0687 secs
2025-03-09 07:09:23,179 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 72.4012 secs
2025-03-09 07:09:23,180 [INFO]: {
2025-03-09 07:09:23,180 [INFO]: 	index_key: HNSW15
2025-03-09 07:09:23,180 [INFO]: 	index_param: efSearch=175
2025-03-09 07:09:23,180 [INFO]: 	index_path: knn.index
2025-03-09 07:09:23,180 [INFO]: 	size in bytes: 1071862030
2025-03-09 07:09:23,180 [INFO]: 	avg_search_speed_ms: 11.365881029632874
2025-03-09 07:09:23,180 [INFO]: 	99p_search_speed_ms: 25.229553519748155
2025-03-09 07:09:23,180 [INFO]: 	reconstruction error %: 0.0
2025-03-09 07:09:23,180 [INFO]: 	nb vectors: 5448
2025-03-09 07:09:23,180 [INFO]: 	vectors dimension: 49152
2025-03-09 07:09:23,180 [INFO]: 	compression ratio: 0.9993080769919613
2025-03-09 07:09:23,180 [INFO]: }
2025-03-09 07:09:23,180 [INFO]: 	>>> Finished "Creating the index" in 72.4069 secs
2025-03-09 07:09:23,180 [INFO]: >>> Finished "Launching the whole pipeline" in 72.4419 secs
2025-03-09 07:09:24: [retrieval_preprocessing] calculating distances ...
2025-03-09 07:09:26: [retrieval_preprocessing] finished and saved retrieval indices for episode 2436 [episode count 2/20]
[retrieval_preprocessing] for episode 44293 [episode count 3/20], we have num_retrieval=np.int64(5639) num_query=np.int64(110)
2025-03-09 07:09:31,572 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-09 07:09:32,694 [INFO]: Launching the whole pipeline 03/09/2025, 07:09:32
2025-03-09 07:09:32,694 [INFO]: Reading total number of vectors and dimension 03/09/2025, 07:09:32
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1181.49it/s]
2025-03-09 07:09:32,724 [INFO]: There are 5639 embeddings of dim 49152
2025-03-09 07:09:32,724 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0305 secs
2025-03-09 07:09:32,724 [INFO]: 	Compute estimated construction time of the index 03/09/2025, 07:09:32
2025-03-09 07:09:32,724 [INFO]: 		-> Train: 16.7 minutes
2025-03-09 07:09:32,724 [INFO]: 		-> Add: 3.1 seconds
2025-03-09 07:09:32,724 [INFO]: 		Total: 16.7 minutes
2025-03-09 07:09:32,724 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0001 secs
2025-03-09 07:09:32,724 [INFO]: 	Checking that your have enough memory available to create the index 03/09/2025, 07:09:32
2025-03-09 07:09:32,724 [INFO]: 1.1GB of memory will be needed to build the index (more might be used if you have more)
2025-03-09 07:09:32,725 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0002 secs
2025-03-09 07:09:32,725 [INFO]: 	Selecting most promising index types given data characteristics 03/09/2025, 07:09:32
2025-03-09 07:09:32,725 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-09 07:09:32,725 [INFO]: 	Creating the index 03/09/2025, 07:09:32
2025-03-09 07:09:32,725 [INFO]: 		-> Instanciate the index HNSW15 03/09/2025, 07:09:32
2025-03-09 07:09:32,726 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0010 secs
2025-03-09 07:09:32,726 [INFO]: 		-> Adding the vectors to the index 03/09/2025, 07:09:32
2025-03-09 07:09:32,726 [INFO]: The memory available for adding the vectors is 49.0GB(total available - used by the index)
2025-03-09 07:09:32,726 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/24 [00:00<?, ?it/s]  4%|▍         | 1/24 [00:00<00:02,  9.35it/s] 25%|██▌       | 6/24 [00:00<00:00, 32.52it/s] 50%|█████     | 12/24 [00:00<00:00, 41.65it/s] 75%|███████▌  | 18/24 [00:00<00:00, 45.57it/s] 96%|█████████▌| 23/24 [00:07<00:00,  2.05it/s]100%|██████████| 24/24 [00:08<00:00,  2.87it/s]
2025-03-09 07:09:41,087 [INFO]: 	Computing best hyperparameters for index knn.index 03/09/2025, 07:09:41
2025-03-09 07:10:31,360 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 50.2718 secs
2025-03-09 07:10:31,375 [INFO]: The best hyperparameters are: efSearch=150
2025-03-09 07:10:31,375 [INFO]: 	Compute fast metrics 03/09/2025, 07:10:31
  0%|          | 0/4 [00:00<?, ?it/s] 25%|██▌       | 1/4 [00:00<00:00,  6.03it/s] 75%|███████▌  | 3/4 [00:00<00:00, 13.21it/s]
2025-03-09 07:10:44,337 [INFO]: 	>>> Finished "Compute fast metrics" in 12.9612 secs
2025-03-09 07:10:44,342 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 71.6164 secs
2025-03-09 07:10:44,342 [INFO]: {
2025-03-09 07:10:44,342 [INFO]: 	index_key: HNSW15
2025-03-09 07:10:44,342 [INFO]: 	index_param: efSearch=150
2025-03-09 07:10:44,342 [INFO]: 	index_path: knn.index
2025-03-09 07:10:44,342 [INFO]: 	size in bytes: 1109440270
2025-03-09 07:10:44,342 [INFO]: 	avg_search_speed_ms: 9.209975541713364
2025-03-09 07:10:44,343 [INFO]: 	99p_search_speed_ms: 22.651094128377743
2025-03-09 07:10:44,343 [INFO]: 	reconstruction error %: 0.0
2025-03-09 07:10:44,343 [INFO]: 	nb vectors: 5639
2025-03-09 07:10:44,343 [INFO]: 	vectors dimension: 49152
2025-03-09 07:10:44,343 [INFO]: 	compression ratio: 0.999307977165819
2025-03-09 07:10:44,343 [INFO]: }
2025-03-09 07:10:44,343 [INFO]: 	>>> Finished "Creating the index" in 71.6179 secs
2025-03-09 07:10:44,343 [INFO]: >>> Finished "Launching the whole pipeline" in 71.6490 secs
2025-03-09 07:10:44: [retrieval_preprocessing] calculating distances ...
2025-03-09 07:10:45: [retrieval_preprocessing] finished and saved retrieval indices for episode 44293 [episode count 3/20]
[retrieval_preprocessing] for episode 19467 [episode count 4/20], we have num_retrieval=np.int64(5523) num_query=np.int64(226)
2025-03-09 07:10:45,664 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-09 07:10:46,420 [INFO]: Launching the whole pipeline 03/09/2025, 07:10:46
2025-03-09 07:10:46,420 [INFO]: Reading total number of vectors and dimension 03/09/2025, 07:10:46
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1261.44it/s]
2025-03-09 07:10:46,460 [INFO]: There are 5523 embeddings of dim 49152
2025-03-09 07:10:46,460 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0400 secs
2025-03-09 07:10:46,460 [INFO]: 	Compute estimated construction time of the index 03/09/2025, 07:10:46
2025-03-09 07:10:46,460 [INFO]: 		-> Train: 16.7 minutes
2025-03-09 07:10:46,460 [INFO]: 		-> Add: 3.0 seconds
2025-03-09 07:10:46,460 [INFO]: 		Total: 16.7 minutes
2025-03-09 07:10:46,460 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0001 secs
2025-03-09 07:10:46,460 [INFO]: 	Checking that your have enough memory available to create the index 03/09/2025, 07:10:46
2025-03-09 07:10:46,460 [INFO]: 1.1GB of memory will be needed to build the index (more might be used if you have more)
2025-03-09 07:10:46,460 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0001 secs
2025-03-09 07:10:46,460 [INFO]: 	Selecting most promising index types given data characteristics 03/09/2025, 07:10:46
2025-03-09 07:10:46,460 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-09 07:10:46,461 [INFO]: 	Creating the index 03/09/2025, 07:10:46
2025-03-09 07:10:46,461 [INFO]: 		-> Instanciate the index HNSW15 03/09/2025, 07:10:46
2025-03-09 07:10:46,462 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0010 secs
2025-03-09 07:10:46,462 [INFO]: 		-> Adding the vectors to the index 03/09/2025, 07:10:46
2025-03-09 07:10:46,462 [INFO]: The memory available for adding the vectors is 49.0GB(total available - used by the index)
2025-03-09 07:10:46,462 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/23 [00:00<?, ?it/s]  4%|▍         | 1/23 [00:00<00:02,  7.39it/s] 26%|██▌       | 6/23 [00:00<00:00, 29.10it/s] 48%|████▊     | 11/23 [00:00<00:00, 37.77it/s] 70%|██████▉   | 16/23 [00:00<00:00, 42.14it/s] 91%|█████████▏| 21/23 [00:04<00:00,  2.85it/s]100%|██████████| 23/23 [00:05<00:00,  3.89it/s]
2025-03-09 07:10:52,384 [INFO]: 	Computing best hyperparameters for index knn.index 03/09/2025, 07:10:52
2025-03-09 07:11:42,503 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 50.1187 secs
2025-03-09 07:11:42,504 [INFO]: The best hyperparameters are: efSearch=149
2025-03-09 07:11:42,504 [INFO]: 	Compute fast metrics 03/09/2025, 07:11:42
  0%|          | 0/4 [00:00<?, ?it/s] 50%|█████     | 2/4 [00:00<00:00, 18.74it/s] 75%|███████▌  | 3/4 [00:00<00:00, 20.35it/s]
2025-03-09 07:11:55,101 [INFO]: 	>>> Finished "Compute fast metrics" in 12.5969 secs
2025-03-09 07:11:55,101 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 68.6397 secs
2025-03-09 07:11:55,101 [INFO]: {
2025-03-09 07:11:55,101 [INFO]: 	index_key: HNSW15
2025-03-09 07:11:55,102 [INFO]: 	index_param: efSearch=149
2025-03-09 07:11:55,102 [INFO]: 	index_path: knn.index
2025-03-09 07:11:55,102 [INFO]: 	size in bytes: 1086617890
2025-03-09 07:11:55,102 [INFO]: 	avg_search_speed_ms: 9.459222676391056
2025-03-09 07:11:55,102 [INFO]: 	99p_search_speed_ms: 26.613800534978527
2025-03-09 07:11:55,102 [INFO]: 	reconstruction error %: 0.0
2025-03-09 07:11:55,102 [INFO]: 	nb vectors: 5523
2025-03-09 07:11:55,102 [INFO]: 	vectors dimension: 49152
2025-03-09 07:11:55,102 [INFO]: 	compression ratio: 0.9993080309031172
2025-03-09 07:11:55,102 [INFO]: }
2025-03-09 07:11:55,102 [INFO]: 	>>> Finished "Creating the index" in 68.6411 secs
2025-03-09 07:11:55,102 [INFO]: >>> Finished "Launching the whole pipeline" in 68.6816 secs
2025-03-09 07:11:55: [retrieval_preprocessing] calculating distances ...
2025-03-09 07:11:56: [retrieval_preprocessing] finished and saved retrieval indices for episode 19467 [episode count 4/20]
[retrieval_preprocessing] for episode 23565 [episode count 5/20], we have num_retrieval=np.int64(5661) num_query=np.int64(88)
2025-03-09 07:11:57,160 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-09 07:11:57,838 [INFO]: Launching the whole pipeline 03/09/2025, 07:11:57
2025-03-09 07:11:57,838 [INFO]: Reading total number of vectors and dimension 03/09/2025, 07:11:57
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 2298.25it/s]
2025-03-09 07:11:57,864 [INFO]: There are 5661 embeddings of dim 49152
2025-03-09 07:11:57,865 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0264 secs
2025-03-09 07:11:57,865 [INFO]: 	Compute estimated construction time of the index 03/09/2025, 07:11:57
2025-03-09 07:11:57,865 [INFO]: 		-> Train: 16.7 minutes
2025-03-09 07:11:57,865 [INFO]: 		-> Add: 3.1 seconds
2025-03-09 07:11:57,865 [INFO]: 		Total: 16.7 minutes
2025-03-09 07:11:57,865 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0001 secs
2025-03-09 07:11:57,865 [INFO]: 	Checking that your have enough memory available to create the index 03/09/2025, 07:11:57
2025-03-09 07:11:57,865 [INFO]: 1.1GB of memory will be needed to build the index (more might be used if you have more)
2025-03-09 07:11:57,865 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0001 secs
2025-03-09 07:11:57,865 [INFO]: 	Selecting most promising index types given data characteristics 03/09/2025, 07:11:57
2025-03-09 07:11:57,865 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-09 07:11:57,865 [INFO]: 	Creating the index 03/09/2025, 07:11:57
2025-03-09 07:11:57,865 [INFO]: 		-> Instanciate the index HNSW15 03/09/2025, 07:11:57
2025-03-09 07:11:57,866 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0009 secs
2025-03-09 07:11:57,866 [INFO]: 		-> Adding the vectors to the index 03/09/2025, 07:11:57
2025-03-09 07:11:57,866 [INFO]: The memory available for adding the vectors is 49.0GB(total available - used by the index)
2025-03-09 07:11:57,866 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/24 [00:00<?, ?it/s]  8%|▊         | 2/24 [00:00<00:01, 18.90it/s] 38%|███▊      | 9/24 [00:00<00:00, 44.86it/s] 67%|██████▋   | 16/24 [00:00<00:00, 52.37it/s] 92%|█████████▏| 22/24 [00:05<00:00,  2.65it/s]100%|██████████| 24/24 [00:07<00:00,  3.21it/s]
2025-03-09 07:12:05,350 [INFO]: 	Computing best hyperparameters for index knn.index 03/09/2025, 07:12:05
2025-03-09 07:12:58,538 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 53.1873 secs
2025-03-09 07:12:58,538 [INFO]: The best hyperparameters are: efSearch=184
2025-03-09 07:12:58,538 [INFO]: 	Compute fast metrics 03/09/2025, 07:12:58
  0%|          | 0/4 [00:00<?, ?it/s] 25%|██▌       | 1/4 [00:00<00:00,  7.87it/s] 75%|███████▌  | 3/4 [00:00<00:00, 14.05it/s] 75%|███████▌  | 3/4 [00:00<00:00, 12.04it/s]
2025-03-09 07:13:11,553 [INFO]: 	>>> Finished "Compute fast metrics" in 13.0153 secs
2025-03-09 07:13:11,557 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 73.6908 secs
2025-03-09 07:13:11,557 [INFO]: {
2025-03-09 07:13:11,557 [INFO]: 	index_key: HNSW15
2025-03-09 07:13:11,557 [INFO]: 	index_param: efSearch=184
2025-03-09 07:13:11,557 [INFO]: 	index_path: knn.index
2025-03-09 07:13:11,557 [INFO]: 	size in bytes: 1113768550
2025-03-09 07:13:11,557 [INFO]: 	avg_search_speed_ms: 10.278755949928836
2025-03-09 07:13:11,557 [INFO]: 	99p_search_speed_ms: 24.016402848064875
2025-03-09 07:13:11,557 [INFO]: 	reconstruction error %: 0.0
2025-03-09 07:13:11,557 [INFO]: 	nb vectors: 5661
2025-03-09 07:13:11,557 [INFO]: 	vectors dimension: 49152
2025-03-09 07:13:11,557 [INFO]: 	compression ratio: 0.9993080591115632
2025-03-09 07:13:11,557 [INFO]: }
2025-03-09 07:13:11,557 [INFO]: 	>>> Finished "Creating the index" in 73.6922 secs
2025-03-09 07:13:11,557 [INFO]: >>> Finished "Launching the whole pipeline" in 73.7191 secs
2025-03-09 07:13:12: [retrieval_preprocessing] calculating distances ...
2025-03-09 07:13:12: [retrieval_preprocessing] finished and saved retrieval indices for episode 23565 [episode count 5/20]
[retrieval_preprocessing] for episode 53006 [episode count 6/20], we have num_retrieval=np.int64(5459) num_query=np.int64(290)
2025-03-09 07:13:12,918 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-09 07:13:13,721 [INFO]: Launching the whole pipeline 03/09/2025, 07:13:13
2025-03-09 07:13:13,721 [INFO]: Reading total number of vectors and dimension 03/09/2025, 07:13:13
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1139.45it/s]
2025-03-09 07:13:13,750 [INFO]: There are 5459 embeddings of dim 49152
2025-03-09 07:13:13,750 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0290 secs
2025-03-09 07:13:13,750 [INFO]: 	Compute estimated construction time of the index 03/09/2025, 07:13:13
2025-03-09 07:13:13,750 [INFO]: 		-> Train: 16.7 minutes
2025-03-09 07:13:13,750 [INFO]: 		-> Add: 3.0 seconds
2025-03-09 07:13:13,750 [INFO]: 		Total: 16.7 minutes
2025-03-09 07:13:13,750 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0001 secs
2025-03-09 07:13:13,750 [INFO]: 	Checking that your have enough memory available to create the index 03/09/2025, 07:13:13
2025-03-09 07:13:13,750 [INFO]: 1.1GB of memory will be needed to build the index (more might be used if you have more)
2025-03-09 07:13:13,750 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0001 secs
2025-03-09 07:13:13,750 [INFO]: 	Selecting most promising index types given data characteristics 03/09/2025, 07:13:13
2025-03-09 07:13:13,750 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-09 07:13:13,750 [INFO]: 	Creating the index 03/09/2025, 07:13:13
2025-03-09 07:13:13,750 [INFO]: 		-> Instanciate the index HNSW15 03/09/2025, 07:13:13
2025-03-09 07:13:13,751 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0011 secs
2025-03-09 07:13:13,752 [INFO]: 		-> Adding the vectors to the index 03/09/2025, 07:13:13
2025-03-09 07:13:13,752 [INFO]: The memory available for adding the vectors is 49.0GB(total available - used by the index)
2025-03-09 07:13:13,752 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/23 [00:00<?, ?it/s]  4%|▍         | 1/23 [00:00<00:02,  8.24it/s] 26%|██▌       | 6/23 [00:00<00:00, 30.49it/s] 48%|████▊     | 11/23 [00:00<00:00, 38.60it/s] 70%|██████▉   | 16/23 [00:00<00:00, 42.55it/s] 91%|█████████▏| 21/23 [00:04<00:00,  2.85it/s]100%|██████████| 23/23 [00:05<00:00,  4.03it/s]
2025-03-09 07:13:19,461 [INFO]: 	Computing best hyperparameters for index knn.index 03/09/2025, 07:13:19
2025-03-09 07:14:11,092 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 51.6307 secs
2025-03-09 07:14:11,092 [INFO]: The best hyperparameters are: efSearch=183
2025-03-09 07:14:11,092 [INFO]: 	Compute fast metrics 03/09/2025, 07:14:11
  0%|          | 0/4 [00:00<?, ?it/s] 50%|█████     | 2/4 [00:00<00:00, 19.12it/s] 75%|███████▌  | 3/4 [00:00<00:00, 20.93it/s]
2025-03-09 07:14:24,027 [INFO]: 	>>> Finished "Compute fast metrics" in 12.9349 secs
2025-03-09 07:14:24,028 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 70.2760 secs
2025-03-09 07:14:24,028 [INFO]: {
2025-03-09 07:14:24,028 [INFO]: 	index_key: HNSW15
2025-03-09 07:14:24,028 [INFO]: 	index_param: efSearch=183
2025-03-09 07:14:24,028 [INFO]: 	index_path: knn.index
2025-03-09 07:14:24,028 [INFO]: 	size in bytes: 1074026290
2025-03-09 07:14:24,028 [INFO]: 	avg_search_speed_ms: 12.65712042745863
2025-03-09 07:14:24,028 [INFO]: 	99p_search_speed_ms: 25.778766516596086
2025-03-09 07:14:24,028 [INFO]: 	reconstruction error %: 0.0
2025-03-09 07:14:24,028 [INFO]: 	nb vectors: 5459
2025-03-09 07:14:24,028 [INFO]: 	vectors dimension: 49152
2025-03-09 07:14:24,028 [INFO]: 	compression ratio: 0.999308007628007
2025-03-09 07:14:24,028 [INFO]: }
2025-03-09 07:14:24,028 [INFO]: 	>>> Finished "Creating the index" in 70.2778 secs
2025-03-09 07:14:24,028 [INFO]: >>> Finished "Launching the whole pipeline" in 70.3074 secs
2025-03-09 07:14:25: [retrieval_preprocessing] calculating distances ...
2025-03-09 07:14:26: [retrieval_preprocessing] finished and saved retrieval indices for episode 53006 [episode count 6/20]
[retrieval_preprocessing] for episode 32527 [episode count 7/20], we have num_retrieval=np.int64(5680) num_query=np.int64(69)
2025-03-09 07:14:26,615 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-09 07:14:27,386 [INFO]: Launching the whole pipeline 03/09/2025, 07:14:27
2025-03-09 07:14:27,387 [INFO]: Reading total number of vectors and dimension 03/09/2025, 07:14:27
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1508.20it/s]
2025-03-09 07:14:27,415 [INFO]: There are 5680 embeddings of dim 49152
2025-03-09 07:14:27,415 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0283 secs
2025-03-09 07:14:27,415 [INFO]: 	Compute estimated construction time of the index 03/09/2025, 07:14:27
2025-03-09 07:14:27,415 [INFO]: 		-> Train: 16.7 minutes
2025-03-09 07:14:27,415 [INFO]: 		-> Add: 3.1 seconds
2025-03-09 07:14:27,415 [INFO]: 		Total: 16.7 minutes
2025-03-09 07:14:27,415 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0001 secs
2025-03-09 07:14:27,415 [INFO]: 	Checking that your have enough memory available to create the index 03/09/2025, 07:14:27
2025-03-09 07:14:27,415 [INFO]: 1.1GB of memory will be needed to build the index (more might be used if you have more)
2025-03-09 07:14:27,415 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0001 secs
2025-03-09 07:14:27,415 [INFO]: 	Selecting most promising index types given data characteristics 03/09/2025, 07:14:27
2025-03-09 07:14:27,415 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-09 07:14:27,415 [INFO]: 	Creating the index 03/09/2025, 07:14:27
2025-03-09 07:14:27,415 [INFO]: 		-> Instanciate the index HNSW15 03/09/2025, 07:14:27
2025-03-09 07:14:27,416 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0009 secs
2025-03-09 07:14:27,416 [INFO]: 		-> Adding the vectors to the index 03/09/2025, 07:14:27
2025-03-09 07:14:27,417 [INFO]: The memory available for adding the vectors is 49.0GB(total available - used by the index)
2025-03-09 07:14:27,417 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/24 [00:00<?, ?it/s]  4%|▍         | 1/24 [00:00<00:02,  8.22it/s] 21%|██        | 5/24 [00:00<00:00, 24.84it/s] 42%|████▏     | 10/24 [00:00<00:00, 33.38it/s] 62%|██████▎   | 15/24 [00:00<00:00, 38.52it/s] 83%|████████▎ | 20/24 [00:00<00:00, 40.57it/s]100%|██████████| 24/24 [00:06<00:00,  3.68it/s]
2025-03-09 07:14:33,933 [INFO]: 	Computing best hyperparameters for index knn.index 03/09/2025, 07:14:33
2025-03-09 07:15:21,717 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 47.7838 secs
2025-03-09 07:15:21,718 [INFO]: The best hyperparameters are: efSearch=136
2025-03-09 07:15:21,718 [INFO]: 	Compute fast metrics 03/09/2025, 07:15:21
  0%|          | 0/4 [00:00<?, ?it/s] 50%|█████     | 2/4 [00:00<00:00, 18.56it/s] 75%|███████▌  | 3/4 [00:00<00:00, 18.61it/s]
2025-03-09 07:15:35,070 [INFO]: 	>>> Finished "Compute fast metrics" in 13.3524 secs
2025-03-09 07:15:35,072 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 67.6550 secs
2025-03-09 07:15:35,072 [INFO]: {
2025-03-09 07:15:35,072 [INFO]: 	index_key: HNSW15
2025-03-09 07:15:35,072 [INFO]: 	index_param: efSearch=136
2025-03-09 07:15:35,072 [INFO]: 	index_path: knn.index
2025-03-09 07:15:35,072 [INFO]: 	size in bytes: 1117506670
2025-03-09 07:15:35,072 [INFO]: 	avg_search_speed_ms: 9.794362044202694
2025-03-09 07:15:35,072 [INFO]: 	99p_search_speed_ms: 21.368922851979725
2025-03-09 07:15:35,072 [INFO]: 	reconstruction error %: 0.0
2025-03-09 07:15:35,072 [INFO]: 	nb vectors: 5680
2025-03-09 07:15:35,072 [INFO]: 	vectors dimension: 49152
2025-03-09 07:15:35,072 [INFO]: 	compression ratio: 0.9993080757182415
2025-03-09 07:15:35,072 [INFO]: }
2025-03-09 07:15:35,072 [INFO]: 	>>> Finished "Creating the index" in 67.6565 secs
2025-03-09 07:15:35,072 [INFO]: >>> Finished "Launching the whole pipeline" in 67.6855 secs
2025-03-09 07:15:35: [retrieval_preprocessing] calculating distances ...
2025-03-09 07:15:35: [retrieval_preprocessing] finished and saved retrieval indices for episode 32527 [episode count 7/20]
[retrieval_preprocessing] for episode 3984 [episode count 8/20], we have num_retrieval=np.int64(5289) num_query=np.int64(460)
2025-03-09 07:15:36,154 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-09 07:15:37,161 [INFO]: Launching the whole pipeline 03/09/2025, 07:15:37
2025-03-09 07:15:37,162 [INFO]: Reading total number of vectors and dimension 03/09/2025, 07:15:37
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 969.11it/s]
2025-03-09 07:15:37,205 [INFO]: There are 5289 embeddings of dim 49152
2025-03-09 07:15:37,206 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0440 secs
2025-03-09 07:15:37,206 [INFO]: 	Compute estimated construction time of the index 03/09/2025, 07:15:37
2025-03-09 07:15:37,206 [INFO]: 		-> Train: 16.7 minutes
2025-03-09 07:15:37,206 [INFO]: 		-> Add: 2.9 seconds
2025-03-09 07:15:37,206 [INFO]: 		Total: 16.7 minutes
2025-03-09 07:15:37,206 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0002 secs
2025-03-09 07:15:37,206 [INFO]: 	Checking that your have enough memory available to create the index 03/09/2025, 07:15:37
2025-03-09 07:15:37,206 [INFO]: 1.1GB of memory will be needed to build the index (more might be used if you have more)
2025-03-09 07:15:37,207 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0004 secs
2025-03-09 07:15:37,207 [INFO]: 	Selecting most promising index types given data characteristics 03/09/2025, 07:15:37
2025-03-09 07:15:37,207 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-09 07:15:37,207 [INFO]: 	Creating the index 03/09/2025, 07:15:37
2025-03-09 07:15:37,207 [INFO]: 		-> Instanciate the index HNSW15 03/09/2025, 07:15:37
2025-03-09 07:15:37,209 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0022 secs
2025-03-09 07:15:37,210 [INFO]: 		-> Adding the vectors to the index 03/09/2025, 07:15:37
2025-03-09 07:15:37,210 [INFO]: The memory available for adding the vectors is 49.0GB(total available - used by the index)
2025-03-09 07:15:37,210 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/22 [00:00<?, ?it/s]  5%|▍         | 1/22 [00:00<00:02,  7.08it/s] 27%|██▋       | 6/22 [00:00<00:00, 26.04it/s] 50%|█████     | 11/22 [00:00<00:00, 32.80it/s] 68%|██████▊   | 15/22 [00:00<00:00, 31.79it/s] 91%|█████████ | 20/22 [00:00<00:00, 35.08it/s]100%|██████████| 22/22 [00:06<00:00,  3.54it/s]
2025-03-09 07:15:43,435 [INFO]: 	Computing best hyperparameters for index knn.index 03/09/2025, 07:15:43
2025-03-09 07:16:35,896 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 52.4605 secs
2025-03-09 07:16:35,897 [INFO]: The best hyperparameters are: efSearch=157
2025-03-09 07:16:35,897 [INFO]: 	Compute fast metrics 03/09/2025, 07:16:35
  0%|          | 0/4 [00:00<?, ?it/s] 75%|███████▌  | 3/4 [00:00<00:00, 29.28it/s] 75%|███████▌  | 3/4 [00:00<00:00, 24.83it/s]
2025-03-09 07:16:48,928 [INFO]: 	>>> Finished "Compute fast metrics" in 13.0311 secs
2025-03-09 07:16:48,928 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 71.7189 secs
2025-03-09 07:16:48,929 [INFO]: {
2025-03-09 07:16:48,929 [INFO]: 	index_key: HNSW15
2025-03-09 07:16:48,929 [INFO]: 	index_param: efSearch=157
2025-03-09 07:16:48,929 [INFO]: 	index_path: knn.index
2025-03-09 07:16:48,929 [INFO]: 	size in bytes: 1040579530
2025-03-09 07:16:48,929 [INFO]: 	avg_search_speed_ms: 9.25865613325085
2025-03-09 07:16:48,929 [INFO]: 	99p_search_speed_ms: 20.86190399946646
2025-03-09 07:16:48,929 [INFO]: 	reconstruction error %: 0.0
2025-03-09 07:16:48,929 [INFO]: 	nb vectors: 5289
2025-03-09 07:16:48,929 [INFO]: 	vectors dimension: 49152
2025-03-09 07:16:48,929 [INFO]: 	compression ratio: 0.9993082527771808
2025-03-09 07:16:48,929 [INFO]: }
2025-03-09 07:16:48,929 [INFO]: 	>>> Finished "Creating the index" in 71.7217 secs
2025-03-09 07:16:48,929 [INFO]: >>> Finished "Launching the whole pipeline" in 71.7673 secs
2025-03-09 07:16:50: [retrieval_preprocessing] calculating distances ...
2025-03-09 07:16:52: [retrieval_preprocessing] finished and saved retrieval indices for episode 3984 [episode count 8/20]
[retrieval_preprocessing] for episode 60943 [episode count 9/20], we have num_retrieval=np.int64(5651) num_query=np.int64(98)
2025-03-09 07:16:52,619 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-09 07:16:53,446 [INFO]: Launching the whole pipeline 03/09/2025, 07:16:53
2025-03-09 07:16:53,446 [INFO]: Reading total number of vectors and dimension 03/09/2025, 07:16:53
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 974.97it/s]
2025-03-09 07:16:53,476 [INFO]: There are 5651 embeddings of dim 49152
2025-03-09 07:16:53,477 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0304 secs
2025-03-09 07:16:53,477 [INFO]: 	Compute estimated construction time of the index 03/09/2025, 07:16:53
2025-03-09 07:16:53,477 [INFO]: 		-> Train: 16.7 minutes
2025-03-09 07:16:53,477 [INFO]: 		-> Add: 3.1 seconds
2025-03-09 07:16:53,477 [INFO]: 		Total: 16.7 minutes
2025-03-09 07:16:53,477 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0001 secs
2025-03-09 07:16:53,477 [INFO]: 	Checking that your have enough memory available to create the index 03/09/2025, 07:16:53
2025-03-09 07:16:53,477 [INFO]: 1.1GB of memory will be needed to build the index (more might be used if you have more)
2025-03-09 07:16:53,477 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0002 secs
2025-03-09 07:16:53,477 [INFO]: 	Selecting most promising index types given data characteristics 03/09/2025, 07:16:53
2025-03-09 07:16:53,477 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-09 07:16:53,477 [INFO]: 	Creating the index 03/09/2025, 07:16:53
2025-03-09 07:16:53,477 [INFO]: 		-> Instanciate the index HNSW15 03/09/2025, 07:16:53
2025-03-09 07:16:53,478 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0009 secs
2025-03-09 07:16:53,478 [INFO]: 		-> Adding the vectors to the index 03/09/2025, 07:16:53
2025-03-09 07:16:53,478 [INFO]: The memory available for adding the vectors is 49.0GB(total available - used by the index)
2025-03-09 07:16:53,478 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/24 [00:00<?, ?it/s]  4%|▍         | 1/24 [00:00<00:04,  5.16it/s] 25%|██▌       | 6/24 [00:00<00:00, 23.77it/s] 46%|████▌     | 11/24 [00:00<00:00, 32.87it/s] 62%|██████▎   | 15/24 [00:00<00:00, 34.34it/s] 83%|████████▎ | 20/24 [00:00<00:00, 38.82it/s]100%|██████████| 24/24 [00:06<00:00,  3.96it/s]
2025-03-09 07:16:59,546 [INFO]: 	Computing best hyperparameters for index knn.index 03/09/2025, 07:16:59
2025-03-09 07:17:51,704 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 52.1586 secs
2025-03-09 07:17:51,705 [INFO]: The best hyperparameters are: efSearch=177
2025-03-09 07:17:51,705 [INFO]: 	Compute fast metrics 03/09/2025, 07:17:51
  0%|          | 0/4 [00:00<?, ?it/s] 75%|███████▌  | 3/4 [00:00<00:00, 27.16it/s] 75%|███████▌  | 3/4 [00:00<00:00, 23.17it/s]
2025-03-09 07:18:04,716 [INFO]: 	>>> Finished "Compute fast metrics" in 13.0113 secs
2025-03-09 07:18:04,717 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 71.2386 secs
2025-03-09 07:18:04,717 [INFO]: {
2025-03-09 07:18:04,717 [INFO]: 	index_key: HNSW15
2025-03-09 07:18:04,717 [INFO]: 	index_param: efSearch=177
2025-03-09 07:18:04,717 [INFO]: 	index_path: knn.index
2025-03-09 07:18:04,717 [INFO]: 	size in bytes: 1111801150
2025-03-09 07:18:04,717 [INFO]: 	avg_search_speed_ms: 10.337695872655507
2025-03-09 07:18:04,717 [INFO]: 	99p_search_speed_ms: 26.82829242898153
2025-03-09 07:18:04,717 [INFO]: 	reconstruction error %: 0.0
2025-03-09 07:18:04,717 [INFO]: 	nb vectors: 5651
2025-03-09 07:18:04,717 [INFO]: 	vectors dimension: 49152
2025-03-09 07:18:04,717 [INFO]: 	compression ratio: 0.9993080219425928
2025-03-09 07:18:04,717 [INFO]: }
2025-03-09 07:18:04,717 [INFO]: 	>>> Finished "Creating the index" in 71.2399 secs
2025-03-09 07:18:04,717 [INFO]: >>> Finished "Launching the whole pipeline" in 71.2710 secs
2025-03-09 07:18:05: [retrieval_preprocessing] calculating distances ...
2025-03-09 07:18:05: [retrieval_preprocessing] finished and saved retrieval indices for episode 60943 [episode count 9/20]
[retrieval_preprocessing] for episode 75023 [episode count 10/20], we have num_retrieval=np.int64(5376) num_query=np.int64(373)
2025-03-09 07:18:05,925 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-09 07:18:06,575 [INFO]: Launching the whole pipeline 03/09/2025, 07:18:06
2025-03-09 07:18:06,576 [INFO]: Reading total number of vectors and dimension 03/09/2025, 07:18:06
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1447.81it/s]
2025-03-09 07:18:06,602 [INFO]: There are 5376 embeddings of dim 49152
2025-03-09 07:18:06,603 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0269 secs
2025-03-09 07:18:06,603 [INFO]: 	Compute estimated construction time of the index 03/09/2025, 07:18:06
2025-03-09 07:18:06,603 [INFO]: 		-> Train: 16.7 minutes
2025-03-09 07:18:06,603 [INFO]: 		-> Add: 3.0 seconds
2025-03-09 07:18:06,603 [INFO]: 		Total: 16.7 minutes
2025-03-09 07:18:06,603 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0001 secs
2025-03-09 07:18:06,603 [INFO]: 	Checking that your have enough memory available to create the index 03/09/2025, 07:18:06
2025-03-09 07:18:06,603 [INFO]: 1.1GB of memory will be needed to build the index (more might be used if you have more)
2025-03-09 07:18:06,603 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0001 secs
2025-03-09 07:18:06,603 [INFO]: 	Selecting most promising index types given data characteristics 03/09/2025, 07:18:06
2025-03-09 07:18:06,603 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-09 07:18:06,603 [INFO]: 	Creating the index 03/09/2025, 07:18:06
2025-03-09 07:18:06,603 [INFO]: 		-> Instanciate the index HNSW15 03/09/2025, 07:18:06
2025-03-09 07:18:06,604 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0009 secs
2025-03-09 07:18:06,604 [INFO]: 		-> Adding the vectors to the index 03/09/2025, 07:18:06
2025-03-09 07:18:06,604 [INFO]: The memory available for adding the vectors is 49.0GB(total available - used by the index)
2025-03-09 07:18:06,604 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/23 [00:00<?, ?it/s]  4%|▍         | 1/23 [00:00<00:03,  6.84it/s] 35%|███▍      | 8/23 [00:00<00:00, 35.67it/s] 65%|██████▌   | 15/23 [00:00<00:00, 47.33it/s] 91%|█████████▏| 21/23 [00:04<00:00,  3.47it/s]100%|██████████| 23/23 [00:05<00:00,  4.29it/s]
2025-03-09 07:18:11,974 [INFO]: 	Computing best hyperparameters for index knn.index 03/09/2025, 07:18:11
2025-03-09 07:19:06,796 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 54.8218 secs
2025-03-09 07:19:06,796 [INFO]: The best hyperparameters are: efSearch=171
2025-03-09 07:19:06,796 [INFO]: 	Compute fast metrics 03/09/2025, 07:19:06
  0%|          | 0/4 [00:00<?, ?it/s] 50%|█████     | 2/4 [00:00<00:00, 17.08it/s] 75%|███████▌  | 3/4 [00:00<00:00, 18.70it/s]
2025-03-09 07:19:24,114 [INFO]: 	>>> Finished "Compute fast metrics" in 17.3180 secs
2025-03-09 07:19:24,115 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 77.5110 secs
2025-03-09 07:19:24,115 [INFO]: {
2025-03-09 07:19:24,115 [INFO]: 	index_key: HNSW15
2025-03-09 07:19:24,115 [INFO]: 	index_param: efSearch=171
2025-03-09 07:19:24,115 [INFO]: 	index_path: knn.index
2025-03-09 07:19:24,115 [INFO]: 	size in bytes: 1057696450
2025-03-09 07:19:24,115 [INFO]: 	avg_search_speed_ms: 9.898834714048201
2025-03-09 07:19:24,115 [INFO]: 	99p_search_speed_ms: 23.936209667008338
2025-03-09 07:19:24,115 [INFO]: 	reconstruction error %: 0.0
2025-03-09 07:19:24,116 [INFO]: 	nb vectors: 5376
2025-03-09 07:19:24,116 [INFO]: 	vectors dimension: 49152
2025-03-09 07:19:24,116 [INFO]: 	compression ratio: 0.9993080793643583
2025-03-09 07:19:24,116 [INFO]: }
2025-03-09 07:19:24,116 [INFO]: 	>>> Finished "Creating the index" in 77.5124 secs
2025-03-09 07:19:24,116 [INFO]: >>> Finished "Launching the whole pipeline" in 77.5400 secs
2025-03-09 07:19:26: [retrieval_preprocessing] calculating distances ...
2025-03-09 07:19:28: [retrieval_preprocessing] finished and saved retrieval indices for episode 75023 [episode count 10/20]
[retrieval_preprocessing] for episode 57236 [episode count 11/20], we have num_retrieval=np.int64(5178) num_query=np.int64(571)
2025-03-09 07:19:28,487 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-09 07:19:29,262 [INFO]: Launching the whole pipeline 03/09/2025, 07:19:29
2025-03-09 07:19:29,262 [INFO]: Reading total number of vectors and dimension 03/09/2025, 07:19:29
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1239.82it/s]
2025-03-09 07:19:29,294 [INFO]: There are 5178 embeddings of dim 49152
2025-03-09 07:19:29,294 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0327 secs
2025-03-09 07:19:29,295 [INFO]: 	Compute estimated construction time of the index 03/09/2025, 07:19:29
2025-03-09 07:19:29,295 [INFO]: 		-> Train: 16.7 minutes
2025-03-09 07:19:29,295 [INFO]: 		-> Add: 2.8 seconds
2025-03-09 07:19:29,295 [INFO]: 		Total: 16.7 minutes
2025-03-09 07:19:29,295 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0003 secs
2025-03-09 07:19:29,295 [INFO]: 	Checking that your have enough memory available to create the index 03/09/2025, 07:19:29
2025-03-09 07:19:29,295 [INFO]: 1.0GB of memory will be needed to build the index (more might be used if you have more)
2025-03-09 07:19:29,295 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0002 secs
2025-03-09 07:19:29,295 [INFO]: 	Selecting most promising index types given data characteristics 03/09/2025, 07:19:29
2025-03-09 07:19:29,295 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-09 07:19:29,295 [INFO]: 	Creating the index 03/09/2025, 07:19:29
2025-03-09 07:19:29,295 [INFO]: 		-> Instanciate the index HNSW15 03/09/2025, 07:19:29
2025-03-09 07:19:29,296 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0008 secs
2025-03-09 07:19:29,296 [INFO]: 		-> Adding the vectors to the index 03/09/2025, 07:19:29
2025-03-09 07:19:29,296 [INFO]: The memory available for adding the vectors is 49.1GB(total available - used by the index)
2025-03-09 07:19:29,296 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/22 [00:00<?, ?it/s]  5%|▍         | 1/22 [00:00<00:02,  7.91it/s] 23%|██▎       | 5/22 [00:00<00:00, 21.85it/s] 36%|███▋      | 8/22 [00:00<00:00, 23.36it/s] 59%|█████▉    | 13/22 [00:00<00:00, 31.24it/s] 82%|████████▏ | 18/22 [00:00<00:00, 36.52it/s]100%|██████████| 22/22 [00:06<00:00,  2.10it/s]100%|██████████| 22/22 [00:06<00:00,  3.58it/s]
2025-03-09 07:19:35,442 [INFO]: 	Computing best hyperparameters for index knn.index 03/09/2025, 07:19:35
2025-03-09 07:20:22,698 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 47.2552 secs
2025-03-09 07:20:22,698 [INFO]: The best hyperparameters are: efSearch=197
2025-03-09 07:20:22,698 [INFO]: 	Compute fast metrics 03/09/2025, 07:20:22
  0%|          | 0/4 [00:00<?, ?it/s] 50%|█████     | 2/4 [00:00<00:00, 19.28it/s] 75%|███████▌  | 3/4 [00:00<00:00, 21.61it/s]
2025-03-09 07:20:36,185 [INFO]: 	>>> Finished "Compute fast metrics" in 13.4874 secs
2025-03-09 07:20:36,186 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 66.8896 secs
2025-03-09 07:20:36,186 [INFO]: {
2025-03-09 07:20:36,186 [INFO]: 	index_key: HNSW15
2025-03-09 07:20:36,186 [INFO]: 	index_param: efSearch=197
2025-03-09 07:20:36,186 [INFO]: 	index_path: knn.index
2025-03-09 07:20:36,186 [INFO]: 	size in bytes: 1018740730
2025-03-09 07:20:36,186 [INFO]: 	avg_search_speed_ms: 11.11165877742072
2025-03-09 07:20:36,186 [INFO]: 	99p_search_speed_ms: 24.90340545307845
2025-03-09 07:20:36,186 [INFO]: 	reconstruction error %: 0.0
2025-03-09 07:20:36,186 [INFO]: 	nb vectors: 5178
2025-03-09 07:20:36,186 [INFO]: 	vectors dimension: 49152
2025-03-09 07:20:36,186 [INFO]: 	compression ratio: 0.9993084540754545
2025-03-09 07:20:36,186 [INFO]: }
2025-03-09 07:20:36,186 [INFO]: 	>>> Finished "Creating the index" in 66.8908 secs
2025-03-09 07:20:36,186 [INFO]: >>> Finished "Launching the whole pipeline" in 66.9244 secs
2025-03-09 07:20:39: [retrieval_preprocessing] calculating distances ...
2025-03-09 07:20:41: [retrieval_preprocessing] finished and saved retrieval indices for episode 57236 [episode count 11/20]
[retrieval_preprocessing] for episode 2069 [episode count 12/20], we have num_retrieval=np.int64(5370) num_query=np.int64(379)
2025-03-09 07:20:41,839 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-09 07:20:42,640 [INFO]: Launching the whole pipeline 03/09/2025, 07:20:42
2025-03-09 07:20:42,640 [INFO]: Reading total number of vectors and dimension 03/09/2025, 07:20:42
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1085.48it/s]
2025-03-09 07:20:42,673 [INFO]: There are 5370 embeddings of dim 49152
2025-03-09 07:20:42,674 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0334 secs
2025-03-09 07:20:42,674 [INFO]: 	Compute estimated construction time of the index 03/09/2025, 07:20:42
2025-03-09 07:20:42,674 [INFO]: 		-> Train: 16.7 minutes
2025-03-09 07:20:42,674 [INFO]: 		-> Add: 2.9 seconds
2025-03-09 07:20:42,674 [INFO]: 		Total: 16.7 minutes
2025-03-09 07:20:42,674 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0001 secs
2025-03-09 07:20:42,674 [INFO]: 	Checking that your have enough memory available to create the index 03/09/2025, 07:20:42
2025-03-09 07:20:42,674 [INFO]: 1.1GB of memory will be needed to build the index (more might be used if you have more)
2025-03-09 07:20:42,674 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0002 secs
2025-03-09 07:20:42,674 [INFO]: 	Selecting most promising index types given data characteristics 03/09/2025, 07:20:42
2025-03-09 07:20:42,674 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-09 07:20:42,674 [INFO]: 	Creating the index 03/09/2025, 07:20:42
2025-03-09 07:20:42,674 [INFO]: 		-> Instanciate the index HNSW15 03/09/2025, 07:20:42
2025-03-09 07:20:42,675 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0010 secs
2025-03-09 07:20:42,675 [INFO]: 		-> Adding the vectors to the index 03/09/2025, 07:20:42
2025-03-09 07:20:42,675 [INFO]: The memory available for adding the vectors is 49.0GB(total available - used by the index)
2025-03-09 07:20:42,675 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/23 [00:00<?, ?it/s]  4%|▍         | 1/23 [00:00<00:03,  7.03it/s] 26%|██▌       | 6/23 [00:00<00:00, 26.24it/s] 48%|████▊     | 11/23 [00:00<00:00, 33.97it/s] 70%|██████▉   | 16/23 [00:00<00:00, 38.08it/s] 91%|█████████▏| 21/23 [00:05<00:00,  2.55it/s]100%|██████████| 23/23 [00:06<00:00,  3.70it/s]
2025-03-09 07:20:48,896 [INFO]: 	Computing best hyperparameters for index knn.index 03/09/2025, 07:20:48
2025-03-09 07:21:41,657 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 52.7612 secs
2025-03-09 07:21:41,658 [INFO]: The best hyperparameters are: efSearch=184
2025-03-09 07:21:41,658 [INFO]: 	Compute fast metrics 03/09/2025, 07:21:41
  0%|          | 0/4 [00:00<?, ?it/s] 25%|██▌       | 1/4 [00:00<00:00,  8.84it/s] 75%|███████▌  | 3/4 [00:00<00:00, 16.43it/s]
2025-03-09 07:21:55,200 [INFO]: 	>>> Finished "Compute fast metrics" in 13.5418 secs
2025-03-09 07:21:55,200 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 72.5250 secs
2025-03-09 07:21:55,201 [INFO]: {
2025-03-09 07:21:55,201 [INFO]: 	index_key: HNSW15
2025-03-09 07:21:55,201 [INFO]: 	index_param: efSearch=184
2025-03-09 07:21:55,201 [INFO]: 	index_path: knn.index
2025-03-09 07:21:55,201 [INFO]: 	size in bytes: 1056515950
2025-03-09 07:21:55,201 [INFO]: 	avg_search_speed_ms: 10.953360917056866
2025-03-09 07:21:55,201 [INFO]: 	99p_search_speed_ms: 25.167552744969722
2025-03-09 07:21:55,201 [INFO]: 	reconstruction error %: 0.0
2025-03-09 07:21:55,201 [INFO]: 	nb vectors: 5370
2025-03-09 07:21:55,201 [INFO]: 	vectors dimension: 49152
2025-03-09 07:21:55,201 [INFO]: 	compression ratio: 0.9993081126697614
2025-03-09 07:21:55,201 [INFO]: }
2025-03-09 07:21:55,201 [INFO]: 	>>> Finished "Creating the index" in 72.5266 secs
2025-03-09 07:21:55,201 [INFO]: >>> Finished "Launching the whole pipeline" in 72.5606 secs
2025-03-09 07:21:56: [retrieval_preprocessing] calculating distances ...
2025-03-09 07:21:58: [retrieval_preprocessing] finished and saved retrieval indices for episode 2069 [episode count 12/20]
[retrieval_preprocessing] for episode 32022 [episode count 13/20], we have num_retrieval=np.int64(5487) num_query=np.int64(262)
2025-03-09 07:21:58,734 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-09 07:21:59,482 [INFO]: Launching the whole pipeline 03/09/2025, 07:21:59
2025-03-09 07:21:59,483 [INFO]: Reading total number of vectors and dimension 03/09/2025, 07:21:59
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1219.98it/s]
2025-03-09 07:21:59,511 [INFO]: There are 5487 embeddings of dim 49152
2025-03-09 07:21:59,511 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0287 secs
2025-03-09 07:21:59,511 [INFO]: 	Compute estimated construction time of the index 03/09/2025, 07:21:59
2025-03-09 07:21:59,511 [INFO]: 		-> Train: 16.7 minutes
2025-03-09 07:21:59,511 [INFO]: 		-> Add: 3.0 seconds
2025-03-09 07:21:59,511 [INFO]: 		Total: 16.7 minutes
2025-03-09 07:21:59,511 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0001 secs
2025-03-09 07:21:59,512 [INFO]: 	Checking that your have enough memory available to create the index 03/09/2025, 07:21:59
2025-03-09 07:21:59,512 [INFO]: 1.1GB of memory will be needed to build the index (more might be used if you have more)
2025-03-09 07:21:59,512 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0001 secs
2025-03-09 07:21:59,512 [INFO]: 	Selecting most promising index types given data characteristics 03/09/2025, 07:21:59
2025-03-09 07:21:59,512 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-09 07:21:59,512 [INFO]: 	Creating the index 03/09/2025, 07:21:59
2025-03-09 07:21:59,512 [INFO]: 		-> Instanciate the index HNSW15 03/09/2025, 07:21:59
2025-03-09 07:21:59,513 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0009 secs
2025-03-09 07:21:59,513 [INFO]: 		-> Adding the vectors to the index 03/09/2025, 07:21:59
2025-03-09 07:21:59,513 [INFO]: The memory available for adding the vectors is 49.0GB(total available - used by the index)
2025-03-09 07:21:59,513 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/23 [00:00<?, ?it/s]  4%|▍         | 1/23 [00:00<00:02,  7.89it/s] 26%|██▌       | 6/23 [00:00<00:00, 29.81it/s] 48%|████▊     | 11/23 [00:00<00:00, 35.77it/s] 74%|███████▍  | 17/23 [00:00<00:00, 41.74it/s] 96%|█████████▌| 22/23 [00:04<00:00,  3.10it/s]100%|██████████| 23/23 [00:05<00:00,  4.03it/s]
2025-03-09 07:22:05,223 [INFO]: 	Computing best hyperparameters for index knn.index 03/09/2025, 07:22:05
2025-03-09 07:22:53,367 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 48.1438 secs
2025-03-09 07:22:53,368 [INFO]: The best hyperparameters are: efSearch=66
2025-03-09 07:22:53,368 [INFO]: 	Compute fast metrics 03/09/2025, 07:22:53
  0%|          | 0/4 [00:00<?, ?it/s] 25%|██▌       | 1/4 [00:00<00:00,  9.70it/s] 75%|███████▌  | 3/4 [00:00<00:00, 17.39it/s]
2025-03-09 07:23:05,126 [INFO]: 	>>> Finished "Compute fast metrics" in 11.7583 secs
2025-03-09 07:23:05,127 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 65.6138 secs
2025-03-09 07:23:05,127 [INFO]: {
2025-03-09 07:23:05,127 [INFO]: 	index_key: HNSW15
2025-03-09 07:23:05,127 [INFO]: 	index_param: efSearch=66
2025-03-09 07:23:05,127 [INFO]: 	index_path: knn.index
2025-03-09 07:23:05,127 [INFO]: 	size in bytes: 1079535190
2025-03-09 07:23:05,127 [INFO]: 	avg_search_speed_ms: 4.482637197943404
2025-03-09 07:23:05,127 [INFO]: 	99p_search_speed_ms: 9.034607459325342
2025-03-09 07:23:05,127 [INFO]: 	reconstruction error %: 0.0
2025-03-09 07:23:05,127 [INFO]: 	nb vectors: 5487
2025-03-09 07:23:05,127 [INFO]: 	vectors dimension: 49152
2025-03-09 07:23:05,127 [INFO]: 	compression ratio: 0.9993079484514071
2025-03-09 07:23:05,127 [INFO]: }
2025-03-09 07:23:05,127 [INFO]: 	>>> Finished "Creating the index" in 65.6151 secs
2025-03-09 07:23:05,127 [INFO]: >>> Finished "Launching the whole pipeline" in 65.6444 secs
2025-03-09 07:23:05: [retrieval_preprocessing] calculating distances ...
2025-03-09 07:23:06: [retrieval_preprocessing] finished and saved retrieval indices for episode 32022 [episode count 13/20]
[retrieval_preprocessing] for episode 32663 [episode count 14/20], we have num_retrieval=np.int64(5502) num_query=np.int64(247)
2025-03-09 07:23:06,912 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-09 07:23:07,656 [INFO]: Launching the whole pipeline 03/09/2025, 07:23:07
2025-03-09 07:23:07,656 [INFO]: Reading total number of vectors and dimension 03/09/2025, 07:23:07
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1662.43it/s]
2025-03-09 07:23:07,683 [INFO]: There are 5502 embeddings of dim 49152
2025-03-09 07:23:07,683 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0273 secs
2025-03-09 07:23:07,684 [INFO]: 	Compute estimated construction time of the index 03/09/2025, 07:23:07
2025-03-09 07:23:07,684 [INFO]: 		-> Train: 16.7 minutes
2025-03-09 07:23:07,684 [INFO]: 		-> Add: 3.0 seconds
2025-03-09 07:23:07,684 [INFO]: 		Total: 16.7 minutes
2025-03-09 07:23:07,684 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0001 secs
2025-03-09 07:23:07,684 [INFO]: 	Checking that your have enough memory available to create the index 03/09/2025, 07:23:07
2025-03-09 07:23:07,684 [INFO]: 1.1GB of memory will be needed to build the index (more might be used if you have more)
2025-03-09 07:23:07,684 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0001 secs
2025-03-09 07:23:07,684 [INFO]: 	Selecting most promising index types given data characteristics 03/09/2025, 07:23:07
2025-03-09 07:23:07,684 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-09 07:23:07,684 [INFO]: 	Creating the index 03/09/2025, 07:23:07
2025-03-09 07:23:07,684 [INFO]: 		-> Instanciate the index HNSW15 03/09/2025, 07:23:07
2025-03-09 07:23:07,685 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0009 secs
2025-03-09 07:23:07,685 [INFO]: 		-> Adding the vectors to the index 03/09/2025, 07:23:07
2025-03-09 07:23:07,685 [INFO]: The memory available for adding the vectors is 49.0GB(total available - used by the index)
2025-03-09 07:23:07,685 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/23 [00:00<?, ?it/s]  4%|▍         | 1/23 [00:00<00:02,  9.61it/s] 26%|██▌       | 6/23 [00:00<00:00, 32.45it/s] 48%|████▊     | 11/23 [00:00<00:00, 39.27it/s] 65%|██████▌   | 15/23 [00:00<00:00, 36.27it/s] 87%|████████▋ | 20/23 [00:00<00:00, 38.60it/s]100%|██████████| 23/23 [00:06<00:00,  3.69it/s]
2025-03-09 07:23:13,919 [INFO]: 	Computing best hyperparameters for index knn.index 03/09/2025, 07:23:13
2025-03-09 07:24:14,183 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 60.2635 secs
2025-03-09 07:24:14,183 [INFO]: The best hyperparameters are: efSearch=159
2025-03-09 07:24:14,183 [INFO]: 	Compute fast metrics 03/09/2025, 07:24:14
  0%|          | 0/4 [00:00<?, ?it/s] 25%|██▌       | 1/4 [00:00<00:01,  2.14it/s] 75%|███████▌  | 3/4 [00:00<00:00,  5.60it/s]
2025-03-09 07:24:30,556 [INFO]: 	>>> Finished "Compute fast metrics" in 16.3725 secs
2025-03-09 07:24:30,557 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 82.8718 secs
2025-03-09 07:24:30,557 [INFO]: {
2025-03-09 07:24:30,557 [INFO]: 	index_key: HNSW15
2025-03-09 07:24:30,557 [INFO]: 	index_param: efSearch=159
2025-03-09 07:24:30,557 [INFO]: 	index_path: knn.index
2025-03-09 07:24:30,557 [INFO]: 	size in bytes: 1082486290
2025-03-09 07:24:30,557 [INFO]: 	avg_search_speed_ms: 9.729776011892243
2025-03-09 07:24:30,557 [INFO]: 	99p_search_speed_ms: 22.967430809512738
2025-03-09 07:24:30,557 [INFO]: 	reconstruction error %: 0.0
2025-03-09 07:24:30,557 [INFO]: 	nb vectors: 5502
2025-03-09 07:24:30,557 [INFO]: 	vectors dimension: 49152
2025-03-09 07:24:30,557 [INFO]: 	compression ratio: 0.9993080060164088
2025-03-09 07:24:30,557 [INFO]: }
2025-03-09 07:24:30,557 [INFO]: 	>>> Finished "Creating the index" in 82.8731 secs
2025-03-09 07:24:30,557 [INFO]: >>> Finished "Launching the whole pipeline" in 82.9009 secs
2025-03-09 07:24:31: [retrieval_preprocessing] calculating distances ...
2025-03-09 07:24:32: [retrieval_preprocessing] finished and saved retrieval indices for episode 32663 [episode count 14/20]
[retrieval_preprocessing] for episode 33814 [episode count 15/20], we have num_retrieval=np.int64(5275) num_query=np.int64(474)
2025-03-09 07:24:32,951 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-09 07:24:33,712 [INFO]: Launching the whole pipeline 03/09/2025, 07:24:33
2025-03-09 07:24:33,712 [INFO]: Reading total number of vectors and dimension 03/09/2025, 07:24:33
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1008.25it/s]
2025-03-09 07:24:33,742 [INFO]: There are 5275 embeddings of dim 49152
2025-03-09 07:24:33,743 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0305 secs
2025-03-09 07:24:33,743 [INFO]: 	Compute estimated construction time of the index 03/09/2025, 07:24:33
2025-03-09 07:24:33,743 [INFO]: 		-> Train: 16.7 minutes
2025-03-09 07:24:33,743 [INFO]: 		-> Add: 2.9 seconds
2025-03-09 07:24:33,743 [INFO]: 		Total: 16.7 minutes
2025-03-09 07:24:33,743 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0001 secs
2025-03-09 07:24:33,743 [INFO]: 	Checking that your have enough memory available to create the index 03/09/2025, 07:24:33
2025-03-09 07:24:33,743 [INFO]: 1.1GB of memory will be needed to build the index (more might be used if you have more)
2025-03-09 07:24:33,743 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0002 secs
2025-03-09 07:24:33,743 [INFO]: 	Selecting most promising index types given data characteristics 03/09/2025, 07:24:33
2025-03-09 07:24:33,743 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-09 07:24:33,743 [INFO]: 	Creating the index 03/09/2025, 07:24:33
2025-03-09 07:24:33,743 [INFO]: 		-> Instanciate the index HNSW15 03/09/2025, 07:24:33
2025-03-09 07:24:33,744 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0009 secs
2025-03-09 07:24:33,744 [INFO]: 		-> Adding the vectors to the index 03/09/2025, 07:24:33
2025-03-09 07:24:33,744 [INFO]: The memory available for adding the vectors is 49.0GB(total available - used by the index)
2025-03-09 07:24:33,744 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/22 [00:00<?, ?it/s]  5%|▍         | 1/22 [00:00<00:02,  9.42it/s] 32%|███▏      | 7/22 [00:00<00:00, 35.19it/s] 59%|█████▉    | 13/22 [00:00<00:00, 43.41it/s] 86%|████████▋ | 19/22 [00:00<00:00, 47.15it/s]100%|██████████| 22/22 [00:05<00:00,  4.00it/s]
2025-03-09 07:24:39,249 [INFO]: 	Computing best hyperparameters for index knn.index 03/09/2025, 07:24:39
2025-03-09 07:25:25,413 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 46.1635 secs
2025-03-09 07:25:25,413 [INFO]: The best hyperparameters are: efSearch=167
2025-03-09 07:25:25,414 [INFO]: 	Compute fast metrics 03/09/2025, 07:25:25
  0%|          | 0/4 [00:00<?, ?it/s] 25%|██▌       | 1/4 [00:00<00:01,  2.72it/s] 50%|█████     | 2/4 [00:00<00:00,  3.31it/s] 75%|███████▌  | 3/4 [00:01<00:00,  2.55it/s] 75%|███████▌  | 3/4 [00:01<00:00,  2.05it/s]
2025-03-09 07:25:39,424 [INFO]: 	>>> Finished "Compute fast metrics" in 14.0104 secs
2025-03-09 07:25:39,425 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 65.6806 secs
2025-03-09 07:25:39,425 [INFO]: {
2025-03-09 07:25:39,425 [INFO]: 	index_key: HNSW15
2025-03-09 07:25:39,425 [INFO]: 	index_param: efSearch=167
2025-03-09 07:25:39,425 [INFO]: 	index_path: knn.index
2025-03-09 07:25:39,425 [INFO]: 	size in bytes: 1037825110
2025-03-09 07:25:39,425 [INFO]: 	avg_search_speed_ms: 9.138397146501601
2025-03-09 07:25:39,425 [INFO]: 	99p_search_speed_ms: 22.278482152614668
2025-03-09 07:25:39,425 [INFO]: 	reconstruction error %: 0.0
2025-03-09 07:25:39,425 [INFO]: 	nb vectors: 5275
2025-03-09 07:25:39,425 [INFO]: 	vectors dimension: 49152
2025-03-09 07:25:39,425 [INFO]: 	compression ratio: 0.9993082553186635
2025-03-09 07:25:39,425 [INFO]: }
2025-03-09 07:25:39,425 [INFO]: 	>>> Finished "Creating the index" in 65.6819 secs
2025-03-09 07:25:39,425 [INFO]: >>> Finished "Launching the whole pipeline" in 65.7131 secs
2025-03-09 07:25:41: [retrieval_preprocessing] calculating distances ...
2025-03-09 07:25:42: [retrieval_preprocessing] finished and saved retrieval indices for episode 33814 [episode count 15/20]
[retrieval_preprocessing] for episode 52886 [episode count 16/20], we have num_retrieval=np.int64(5361) num_query=np.int64(388)
2025-03-09 07:25:43,237 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-09 07:25:43,990 [INFO]: Launching the whole pipeline 03/09/2025, 07:25:43
2025-03-09 07:25:43,990 [INFO]: Reading total number of vectors and dimension 03/09/2025, 07:25:43
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1135.13it/s]
2025-03-09 07:25:44,020 [INFO]: There are 5361 embeddings of dim 49152
2025-03-09 07:25:44,020 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0302 secs
2025-03-09 07:25:44,020 [INFO]: 	Compute estimated construction time of the index 03/09/2025, 07:25:44
2025-03-09 07:25:44,020 [INFO]: 		-> Train: 16.7 minutes
2025-03-09 07:25:44,020 [INFO]: 		-> Add: 2.9 seconds
2025-03-09 07:25:44,020 [INFO]: 		Total: 16.7 minutes
2025-03-09 07:25:44,020 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0001 secs
2025-03-09 07:25:44,020 [INFO]: 	Checking that your have enough memory available to create the index 03/09/2025, 07:25:44
2025-03-09 07:25:44,020 [INFO]: 1.1GB of memory will be needed to build the index (more might be used if you have more)
2025-03-09 07:25:44,020 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0001 secs
2025-03-09 07:25:44,020 [INFO]: 	Selecting most promising index types given data characteristics 03/09/2025, 07:25:44
2025-03-09 07:25:44,020 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-09 07:25:44,020 [INFO]: 	Creating the index 03/09/2025, 07:25:44
2025-03-09 07:25:44,020 [INFO]: 		-> Instanciate the index HNSW15 03/09/2025, 07:25:44
2025-03-09 07:25:44,021 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0010 secs
2025-03-09 07:25:44,022 [INFO]: 		-> Adding the vectors to the index 03/09/2025, 07:25:44
2025-03-09 07:25:44,022 [INFO]: The memory available for adding the vectors is 49.0GB(total available - used by the index)
2025-03-09 07:25:44,022 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/23 [00:00<?, ?it/s]  4%|▍         | 1/23 [00:00<00:02,  9.70it/s] 22%|██▏       | 5/23 [00:00<00:00, 24.68it/s] 48%|████▊     | 11/23 [00:00<00:00, 37.41it/s] 74%|███████▍  | 17/23 [00:00<00:00, 43.21it/s] 96%|█████████▌| 22/23 [00:04<00:00,  2.92it/s]100%|██████████| 23/23 [00:05<00:00,  3.91it/s]
2025-03-09 07:25:49,908 [INFO]: 	Computing best hyperparameters for index knn.index 03/09/2025, 07:25:49
2025-03-09 07:26:53,346 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 63.4379 secs
2025-03-09 07:26:53,347 [INFO]: The best hyperparameters are: efSearch=143
2025-03-09 07:26:53,347 [INFO]: 	Compute fast metrics 03/09/2025, 07:26:53
  0%|          | 0/4 [00:00<?, ?it/s] 50%|█████     | 2/4 [00:00<00:00, 17.68it/s] 75%|███████▌  | 3/4 [00:00<00:00, 19.30it/s]
2025-03-09 07:27:06,115 [INFO]: 	>>> Finished "Compute fast metrics" in 12.7682 secs
2025-03-09 07:27:06,116 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 82.0944 secs
2025-03-09 07:27:06,116 [INFO]: {
2025-03-09 07:27:06,116 [INFO]: 	index_key: HNSW15
2025-03-09 07:27:06,116 [INFO]: 	index_param: efSearch=143
2025-03-09 07:27:06,116 [INFO]: 	index_path: knn.index
2025-03-09 07:27:06,116 [INFO]: 	size in bytes: 1054745230
2025-03-09 07:27:06,116 [INFO]: 	avg_search_speed_ms: 8.410681894047482
2025-03-09 07:27:06,116 [INFO]: 	99p_search_speed_ms: 18.796909991651756
2025-03-09 07:27:06,116 [INFO]: 	reconstruction error %: 0.0
2025-03-09 07:27:06,116 [INFO]: 	nb vectors: 5361
2025-03-09 07:27:06,116 [INFO]: 	vectors dimension: 49152
2025-03-09 07:27:06,116 [INFO]: 	compression ratio: 0.9993081343444425
2025-03-09 07:27:06,116 [INFO]: }
2025-03-09 07:27:06,116 [INFO]: 	>>> Finished "Creating the index" in 82.0958 secs
2025-03-09 07:27:06,116 [INFO]: >>> Finished "Launching the whole pipeline" in 82.1266 secs
2025-03-09 07:27:07: [retrieval_preprocessing] calculating distances ...
2025-03-09 07:27:08: [retrieval_preprocessing] finished and saved retrieval indices for episode 52886 [episode count 16/20]
[retrieval_preprocessing] for episode 19482 [episode count 17/20], we have num_retrieval=np.int64(5349) num_query=np.int64(400)
2025-03-09 07:27:08,946 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-09 07:27:09,816 [INFO]: Launching the whole pipeline 03/09/2025, 07:27:09
2025-03-09 07:27:09,816 [INFO]: Reading total number of vectors and dimension 03/09/2025, 07:27:09
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1444.82it/s]
2025-03-09 07:27:09,844 [INFO]: There are 5349 embeddings of dim 49152
2025-03-09 07:27:09,844 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0276 secs
2025-03-09 07:27:09,844 [INFO]: 	Compute estimated construction time of the index 03/09/2025, 07:27:09
2025-03-09 07:27:09,844 [INFO]: 		-> Train: 16.7 minutes
2025-03-09 07:27:09,844 [INFO]: 		-> Add: 2.9 seconds
2025-03-09 07:27:09,844 [INFO]: 		Total: 16.7 minutes
2025-03-09 07:27:09,844 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0001 secs
2025-03-09 07:27:09,844 [INFO]: 	Checking that your have enough memory available to create the index 03/09/2025, 07:27:09
2025-03-09 07:27:09,844 [INFO]: 1.1GB of memory will be needed to build the index (more might be used if you have more)
2025-03-09 07:27:09,844 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0001 secs
2025-03-09 07:27:09,844 [INFO]: 	Selecting most promising index types given data characteristics 03/09/2025, 07:27:09
2025-03-09 07:27:09,844 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-09 07:27:09,844 [INFO]: 	Creating the index 03/09/2025, 07:27:09
2025-03-09 07:27:09,844 [INFO]: 		-> Instanciate the index HNSW15 03/09/2025, 07:27:09
2025-03-09 07:27:09,845 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0009 secs
2025-03-09 07:27:09,845 [INFO]: 		-> Adding the vectors to the index 03/09/2025, 07:27:09
2025-03-09 07:27:09,845 [INFO]: The memory available for adding the vectors is 49.0GB(total available - used by the index)
2025-03-09 07:27:09,845 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/23 [00:00<?, ?it/s]  9%|▊         | 2/23 [00:00<00:01, 16.79it/s] 30%|███       | 7/23 [00:00<00:00, 34.06it/s] 57%|█████▋    | 13/23 [00:00<00:00, 43.36it/s] 83%|████████▎ | 19/23 [00:00<00:00, 47.54it/s]100%|██████████| 23/23 [00:05<00:00,  4.07it/s]
2025-03-09 07:27:15,500 [INFO]: 	Computing best hyperparameters for index knn.index 03/09/2025, 07:27:15
2025-03-09 07:28:04,329 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 48.8290 secs
2025-03-09 07:28:04,329 [INFO]: The best hyperparameters are: efSearch=154
2025-03-09 07:28:04,329 [INFO]: 	Compute fast metrics 03/09/2025, 07:28:04
  0%|          | 0/4 [00:00<?, ?it/s] 50%|█████     | 2/4 [00:00<00:00, 18.98it/s] 75%|███████▌  | 3/4 [00:00<00:00, 20.58it/s]
2025-03-09 07:28:19,521 [INFO]: 	>>> Finished "Compute fast metrics" in 15.1922 secs
2025-03-09 07:28:19,522 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 69.6770 secs
2025-03-09 07:28:19,522 [INFO]: {
2025-03-09 07:28:19,522 [INFO]: 	index_key: HNSW15
2025-03-09 07:28:19,522 [INFO]: 	index_param: efSearch=154
2025-03-09 07:28:19,522 [INFO]: 	index_path: knn.index
2025-03-09 07:28:19,522 [INFO]: 	size in bytes: 1052384350
2025-03-09 07:28:19,522 [INFO]: 	avg_search_speed_ms: 9.327383711499705
2025-03-09 07:28:19,523 [INFO]: 	99p_search_speed_ms: 23.625735177192826
2025-03-09 07:28:19,523 [INFO]: 	reconstruction error %: 0.0
2025-03-09 07:28:19,523 [INFO]: 	nb vectors: 5349
2025-03-09 07:28:19,523 [INFO]: 	vectors dimension: 49152
2025-03-09 07:28:19,523 [INFO]: 	compression ratio: 0.9993080873922155
2025-03-09 07:28:19,523 [INFO]: }
2025-03-09 07:28:19,523 [INFO]: 	>>> Finished "Creating the index" in 69.6783 secs
2025-03-09 07:28:19,523 [INFO]: >>> Finished "Launching the whole pipeline" in 69.7064 secs
2025-03-09 07:28:20: [retrieval_preprocessing] calculating distances ...
2025-03-09 07:28:22: [retrieval_preprocessing] finished and saved retrieval indices for episode 19482 [episode count 17/20]
[retrieval_preprocessing] for episode 27419 [episode count 18/20], we have num_retrieval=np.int64(5573) num_query=np.int64(176)
2025-03-09 07:28:22,866 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-09 07:28:23,697 [INFO]: Launching the whole pipeline 03/09/2025, 07:28:23
2025-03-09 07:28:23,697 [INFO]: Reading total number of vectors and dimension 03/09/2025, 07:28:23
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1965.47it/s]
2025-03-09 07:28:23,729 [INFO]: There are 5573 embeddings of dim 49152
2025-03-09 07:28:23,730 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0327 secs
2025-03-09 07:28:23,730 [INFO]: 	Compute estimated construction time of the index 03/09/2025, 07:28:23
2025-03-09 07:28:23,730 [INFO]: 		-> Train: 16.7 minutes
2025-03-09 07:28:23,731 [INFO]: 		-> Add: 3.1 seconds
2025-03-09 07:28:23,731 [INFO]: 		Total: 16.7 minutes
2025-03-09 07:28:23,731 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0008 secs
2025-03-09 07:28:23,731 [INFO]: 	Checking that your have enough memory available to create the index 03/09/2025, 07:28:23
2025-03-09 07:28:23,731 [INFO]: 1.1GB of memory will be needed to build the index (more might be used if you have more)
2025-03-09 07:28:23,732 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0005 secs
2025-03-09 07:28:23,732 [INFO]: 	Selecting most promising index types given data characteristics 03/09/2025, 07:28:23
2025-03-09 07:28:23,732 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-09 07:28:23,732 [INFO]: 	Creating the index 03/09/2025, 07:28:23
2025-03-09 07:28:23,732 [INFO]: 		-> Instanciate the index HNSW15 03/09/2025, 07:28:23
2025-03-09 07:28:23,735 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0029 secs
2025-03-09 07:28:23,736 [INFO]: 		-> Adding the vectors to the index 03/09/2025, 07:28:23
2025-03-09 07:28:23,736 [INFO]: The memory available for adding the vectors is 49.0GB(total available - used by the index)
2025-03-09 07:28:23,736 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/23 [00:00<?, ?it/s]  9%|▊         | 2/23 [00:00<00:01, 16.78it/s] 30%|███       | 7/23 [00:00<00:00, 33.15it/s] 48%|████▊     | 11/23 [00:00<00:00, 32.66it/s] 70%|██████▉   | 16/23 [00:00<00:00, 37.42it/s] 91%|█████████▏| 21/23 [00:05<00:00,  2.43it/s]100%|██████████| 23/23 [00:07<00:00,  3.20it/s]
2025-03-09 07:28:30,939 [INFO]: 	Computing best hyperparameters for index knn.index 03/09/2025, 07:28:30
2025-03-09 07:29:25,202 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 54.2626 secs
2025-03-09 07:29:25,203 [INFO]: The best hyperparameters are: efSearch=174
2025-03-09 07:29:25,203 [INFO]: 	Compute fast metrics 03/09/2025, 07:29:25
  0%|          | 0/4 [00:00<?, ?it/s] 25%|██▌       | 1/4 [00:00<00:00,  5.75it/s] 75%|███████▌  | 3/4 [00:00<00:00, 12.94it/s]
2025-03-09 07:29:40,915 [INFO]: 	>>> Finished "Compute fast metrics" in 15.7120 secs
2025-03-09 07:29:40,916 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 77.1800 secs
2025-03-09 07:29:40,916 [INFO]: {
2025-03-09 07:29:40,916 [INFO]: 	index_key: HNSW15
2025-03-09 07:29:40,916 [INFO]: 	index_param: efSearch=174
2025-03-09 07:29:40,916 [INFO]: 	index_path: knn.index
2025-03-09 07:29:40,916 [INFO]: 	size in bytes: 1096455190
2025-03-09 07:29:40,916 [INFO]: 	avg_search_speed_ms: 10.638882084303793
2025-03-09 07:29:40,916 [INFO]: 	99p_search_speed_ms: 19.08345806179568
2025-03-09 07:29:40,916 [INFO]: 	reconstruction error %: 0.0
2025-03-09 07:29:40,916 [INFO]: 	nb vectors: 5573
2025-03-09 07:29:40,916 [INFO]: 	vectors dimension: 49152
2025-03-09 07:29:40,916 [INFO]: 	compression ratio: 0.999307946182461
2025-03-09 07:29:40,916 [INFO]: }
2025-03-09 07:29:40,916 [INFO]: 	>>> Finished "Creating the index" in 77.1837 secs
2025-03-09 07:29:40,916 [INFO]: >>> Finished "Launching the whole pipeline" in 77.2188 secs
2025-03-09 07:29:41: [retrieval_preprocessing] calculating distances ...
2025-03-09 07:29:42: [retrieval_preprocessing] finished and saved retrieval indices for episode 27419 [episode count 18/20]
[retrieval_preprocessing] for episode 53143 [episode count 19/20], we have num_retrieval=np.int64(5302) num_query=np.int64(447)
2025-03-09 07:29:42,946 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-09 07:29:43,679 [INFO]: Launching the whole pipeline 03/09/2025, 07:29:43
2025-03-09 07:29:43,679 [INFO]: Reading total number of vectors and dimension 03/09/2025, 07:29:43
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1505.49it/s]
2025-03-09 07:29:43,707 [INFO]: There are 5302 embeddings of dim 49152
2025-03-09 07:29:43,707 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0275 secs
2025-03-09 07:29:43,707 [INFO]: 	Compute estimated construction time of the index 03/09/2025, 07:29:43
2025-03-09 07:29:43,707 [INFO]: 		-> Train: 16.7 minutes
2025-03-09 07:29:43,707 [INFO]: 		-> Add: 2.9 seconds
2025-03-09 07:29:43,707 [INFO]: 		Total: 16.7 minutes
2025-03-09 07:29:43,707 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0001 secs
2025-03-09 07:29:43,707 [INFO]: 	Checking that your have enough memory available to create the index 03/09/2025, 07:29:43
2025-03-09 07:29:43,707 [INFO]: 1.1GB of memory will be needed to build the index (more might be used if you have more)
2025-03-09 07:29:43,707 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0001 secs
2025-03-09 07:29:43,707 [INFO]: 	Selecting most promising index types given data characteristics 03/09/2025, 07:29:43
2025-03-09 07:29:43,707 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-09 07:29:43,707 [INFO]: 	Creating the index 03/09/2025, 07:29:43
2025-03-09 07:29:43,707 [INFO]: 		-> Instanciate the index HNSW15 03/09/2025, 07:29:43
2025-03-09 07:29:43,708 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0009 secs
2025-03-09 07:29:43,708 [INFO]: 		-> Adding the vectors to the index 03/09/2025, 07:29:43
2025-03-09 07:29:43,709 [INFO]: The memory available for adding the vectors is 49.0GB(total available - used by the index)
2025-03-09 07:29:43,709 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/22 [00:00<?, ?it/s]  5%|▍         | 1/22 [00:00<00:02,  9.24it/s] 27%|██▋       | 6/22 [00:00<00:00, 32.30it/s] 55%|█████▍    | 12/22 [00:00<00:00, 42.31it/s] 77%|███████▋  | 17/22 [00:00<00:00, 41.42it/s]100%|██████████| 22/22 [00:05<00:00,  2.51it/s]100%|██████████| 22/22 [00:05<00:00,  3.95it/s]
2025-03-09 07:29:49,288 [INFO]: 	Computing best hyperparameters for index knn.index 03/09/2025, 07:29:49
2025-03-09 07:30:48,239 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 58.9505 secs
2025-03-09 07:30:48,240 [INFO]: The best hyperparameters are: efSearch=131
2025-03-09 07:30:48,240 [INFO]: 	Compute fast metrics 03/09/2025, 07:30:48
  0%|          | 0/4 [00:00<?, ?it/s] 25%|██▌       | 1/4 [00:00<00:00,  8.92it/s] 75%|███████▌  | 3/4 [00:00<00:00, 17.83it/s]
2025-03-09 07:31:00,874 [INFO]: 	>>> Finished "Compute fast metrics" in 12.6340 secs
2025-03-09 07:31:00,875 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 77.1663 secs
2025-03-09 07:31:00,875 [INFO]: {
2025-03-09 07:31:00,875 [INFO]: 	index_key: HNSW15
2025-03-09 07:31:00,875 [INFO]: 	index_param: efSearch=131
2025-03-09 07:31:00,875 [INFO]: 	index_path: knn.index
2025-03-09 07:31:00,875 [INFO]: 	size in bytes: 1043137210
2025-03-09 07:31:00,875 [INFO]: 	avg_search_speed_ms: 7.892750247161844
2025-03-09 07:31:00,875 [INFO]: 	99p_search_speed_ms: 21.45687013864515
2025-03-09 07:31:00,875 [INFO]: 	reconstruction error %: 0.0
2025-03-09 07:31:00,875 [INFO]: 	nb vectors: 5302
2025-03-09 07:31:00,875 [INFO]: 	vectors dimension: 49152
2025-03-09 07:31:00,875 [INFO]: 	compression ratio: 0.9993082463236068
2025-03-09 07:31:00,875 [INFO]: }
2025-03-09 07:31:00,875 [INFO]: 	>>> Finished "Creating the index" in 77.1676 secs
2025-03-09 07:31:00,875 [INFO]: >>> Finished "Launching the whole pipeline" in 77.1957 secs
2025-03-09 07:31:01: [retrieval_preprocessing] calculating distances ...
2025-03-09 07:31:03: [retrieval_preprocessing] finished and saved retrieval indices for episode 53143 [episode count 19/20]
2025-03-09 07:31:03: [retrieval_preprocessing] finished for (9209350647, 'drawer') [chosen_id count 1/10]
2025-03-09 07:31:05: [retrieval_preprocessing] concatenated all embeddings and indices for 20 episodes for (6655265581, 'cup') [chosen_id count 2/10]
2025-03-09 07:31:05: [retrieval_preprocessing] we have num_total=6928 embedding_dim=49152
[retrieval_preprocessing] for episode 18180 [episode count 0/20], we have num_retrieval=np.int64(6567) num_query=np.int64(361)
2025-03-09 07:31:06,304 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-09 07:31:07,127 [INFO]: Launching the whole pipeline 03/09/2025, 07:31:07
2025-03-09 07:31:07,127 [INFO]: Reading total number of vectors and dimension 03/09/2025, 07:31:07
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1372.48it/s]
2025-03-09 07:31:07,159 [INFO]: There are 6567 embeddings of dim 49152
2025-03-09 07:31:07,159 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0324 secs
2025-03-09 07:31:07,159 [INFO]: 	Compute estimated construction time of the index 03/09/2025, 07:31:07
2025-03-09 07:31:07,159 [INFO]: 		-> Train: 16.7 minutes
2025-03-09 07:31:07,159 [INFO]: 		-> Add: 3.6 seconds
2025-03-09 07:31:07,159 [INFO]: 		Total: 16.7 minutes
2025-03-09 07:31:07,159 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0001 secs
2025-03-09 07:31:07,159 [INFO]: 	Checking that your have enough memory available to create the index 03/09/2025, 07:31:07
2025-03-09 07:31:07,160 [INFO]: 1.3GB of memory will be needed to build the index (more might be used if you have more)
2025-03-09 07:31:07,160 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0002 secs
2025-03-09 07:31:07,160 [INFO]: 	Selecting most promising index types given data characteristics 03/09/2025, 07:31:07
2025-03-09 07:31:07,160 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-09 07:31:07,160 [INFO]: 	Creating the index 03/09/2025, 07:31:07
2025-03-09 07:31:07,160 [INFO]: 		-> Instanciate the index HNSW15 03/09/2025, 07:31:07
2025-03-09 07:31:07,161 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0010 secs
2025-03-09 07:31:07,161 [INFO]: 		-> Adding the vectors to the index 03/09/2025, 07:31:07
2025-03-09 07:31:07,161 [INFO]: The memory available for adding the vectors is 48.8GB(total available - used by the index)
2025-03-09 07:31:07,161 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/27 [00:00<?, ?it/s]  4%|▎         | 1/27 [00:00<00:02,  9.16it/s] 26%|██▌       | 7/27 [00:00<00:00, 35.65it/s] 48%|████▊     | 13/27 [00:00<00:00, 44.37it/s] 70%|███████   | 19/27 [00:00<00:00, 48.48it/s] 89%|████████▉ | 24/27 [00:05<00:01,  2.73it/s]100%|██████████| 27/27 [00:07<00:00,  3.53it/s]
2025-03-09 07:31:14,819 [INFO]: 	Computing best hyperparameters for index knn.index 03/09/2025, 07:31:14
2025-03-09 07:32:14,413 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 59.5940 secs
2025-03-09 07:32:14,414 [INFO]: The best hyperparameters are: efSearch=221
2025-03-09 07:32:14,414 [INFO]: 	Compute fast metrics 03/09/2025, 07:32:14
  0%|          | 0/4 [00:00<?, ?it/s] 25%|██▌       | 1/4 [00:00<00:00,  5.27it/s] 75%|███████▌  | 3/4 [00:00<00:00, 11.50it/s]
2025-03-09 07:32:30,406 [INFO]: 	>>> Finished "Compute fast metrics" in 15.9920 secs
2025-03-09 07:32:30,412 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 83.2512 secs
2025-03-09 07:32:30,412 [INFO]: {
2025-03-09 07:32:30,412 [INFO]: 	index_key: HNSW15
2025-03-09 07:32:30,412 [INFO]: 	index_param: efSearch=221
2025-03-09 07:32:30,412 [INFO]: 	index_path: knn.index
2025-03-09 07:32:30,412 [INFO]: 	size in bytes: 1292018290
2025-03-09 07:32:30,412 [INFO]: 	avg_search_speed_ms: 9.578621918398001
2025-03-09 07:32:30,412 [INFO]: 	99p_search_speed_ms: 22.250376716256138
2025-03-09 07:32:30,412 [INFO]: 	reconstruction error %: 0.0
2025-03-09 07:32:30,412 [INFO]: 	nb vectors: 6567
2025-03-09 07:32:30,412 [INFO]: 	vectors dimension: 49152
2025-03-09 07:32:30,412 [INFO]: 	compression ratio: 0.9993084045273074
2025-03-09 07:32:30,412 [INFO]: }
2025-03-09 07:32:30,412 [INFO]: 	>>> Finished "Creating the index" in 83.2526 secs
2025-03-09 07:32:30,412 [INFO]: >>> Finished "Launching the whole pipeline" in 83.2857 secs
2025-03-09 07:32:32: [retrieval_preprocessing] calculating distances ...
2025-03-09 07:32:33: [retrieval_preprocessing] finished and saved retrieval indices for episode 18180 [episode count 0/20]
[retrieval_preprocessing] for episode 81924 [episode count 1/20], we have num_retrieval=np.int64(6762) num_query=np.int64(166)
2025-03-09 07:32:33,899 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-09 07:32:35,133 [INFO]: Launching the whole pipeline 03/09/2025, 07:32:35
2025-03-09 07:32:35,133 [INFO]: Reading total number of vectors and dimension 03/09/2025, 07:32:35
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1212.93it/s]
2025-03-09 07:32:35,166 [INFO]: There are 6762 embeddings of dim 49152
2025-03-09 07:32:35,167 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0332 secs
2025-03-09 07:32:35,167 [INFO]: 	Compute estimated construction time of the index 03/09/2025, 07:32:35
2025-03-09 07:32:35,167 [INFO]: 		-> Train: 16.7 minutes
2025-03-09 07:32:35,167 [INFO]: 		-> Add: 3.7 seconds
2025-03-09 07:32:35,167 [INFO]: 		Total: 16.7 minutes
2025-03-09 07:32:35,167 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0001 secs
2025-03-09 07:32:35,167 [INFO]: 	Checking that your have enough memory available to create the index 03/09/2025, 07:32:35
2025-03-09 07:32:35,167 [INFO]: 1.4GB of memory will be needed to build the index (more might be used if you have more)
2025-03-09 07:32:35,167 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0003 secs
2025-03-09 07:32:35,167 [INFO]: 	Selecting most promising index types given data characteristics 03/09/2025, 07:32:35
2025-03-09 07:32:35,167 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-09 07:32:35,167 [INFO]: 	Creating the index 03/09/2025, 07:32:35
2025-03-09 07:32:35,168 [INFO]: 		-> Instanciate the index HNSW15 03/09/2025, 07:32:35
2025-03-09 07:32:35,169 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0012 secs
2025-03-09 07:32:35,169 [INFO]: 		-> Adding the vectors to the index 03/09/2025, 07:32:35
2025-03-09 07:32:35,169 [INFO]: The memory available for adding the vectors is 48.8GB(total available - used by the index)
2025-03-09 07:32:35,169 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/28 [00:00<?, ?it/s]  4%|▎         | 1/28 [00:00<00:05,  4.64it/s] 11%|█         | 3/28 [00:00<00:03,  7.53it/s] 18%|█▊        | 5/28 [00:00<00:02,  8.80it/s] 21%|██▏       | 6/28 [00:00<00:02,  8.94it/s] 25%|██▌       | 7/28 [00:00<00:02,  9.06it/s] 32%|███▏      | 9/28 [00:01<00:02,  9.31it/s] 36%|███▌      | 10/28 [00:01<00:01,  9.14it/s] 39%|███▉      | 11/28 [00:01<00:01,  8.82it/s] 43%|████▎     | 12/28 [00:01<00:01,  8.63it/s] 46%|████▋     | 13/28 [00:01<00:01,  8.50it/s] 50%|█████     | 14/28 [00:01<00:01,  8.27it/s] 54%|█████▎    | 15/28 [00:01<00:01,  8.18it/s] 57%|█████▋    | 16/28 [00:01<00:01,  7.95it/s] 61%|██████    | 17/28 [00:02<00:01,  7.75it/s] 64%|██████▍   | 18/28 [00:02<00:01,  7.72it/s] 68%|██████▊   | 19/28 [00:02<00:01,  7.78it/s] 71%|███████▏  | 20/28 [00:02<00:00,  8.03it/s] 75%|███████▌  | 21/28 [00:06<00:09,  1.34s/it] 86%|████████▌ | 24/28 [00:06<00:02,  1.65it/s] 93%|█████████▎| 26/28 [00:06<00:00,  2.33it/s]100%|██████████| 28/28 [00:08<00:00,  1.58it/s]100%|██████████| 28/28 [00:09<00:00,  3.11it/s]
2025-03-09 07:32:44,177 [INFO]: 	Computing best hyperparameters for index knn.index 03/09/2025, 07:32:44
2025-03-09 07:34:04,273 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 80.0946 secs
2025-03-09 07:34:04,273 [INFO]: The best hyperparameters are: efSearch=147
2025-03-09 07:34:04,273 [INFO]: 	Compute fast metrics 03/09/2025, 07:34:04
  0%|          | 0/4 [00:00<?, ?it/s] 25%|██▌       | 1/4 [00:00<00:00,  4.39it/s] 50%|█████     | 2/4 [00:00<00:00,  5.79it/s] 75%|███████▌  | 3/4 [00:00<00:00,  6.03it/s]
2025-03-09 07:34:20,896 [INFO]: 	>>> Finished "Compute fast metrics" in 16.6224 secs
2025-03-09 07:34:20,897 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 105.7284 secs
2025-03-09 07:34:20,897 [INFO]: {
2025-03-09 07:34:20,897 [INFO]: 	index_key: HNSW15
2025-03-09 07:34:20,897 [INFO]: 	index_param: efSearch=147
2025-03-09 07:34:20,897 [INFO]: 	index_path: knn.index
2025-03-09 07:34:20,898 [INFO]: 	size in bytes: 1330383310
2025-03-09 07:34:20,898 [INFO]: 	avg_search_speed_ms: 6.534139794796657
2025-03-09 07:34:20,898 [INFO]: 	99p_search_speed_ms: 14.257061914540836
2025-03-09 07:34:20,898 [INFO]: 	reconstruction error %: 0.0
2025-03-09 07:34:20,898 [INFO]: 	nb vectors: 6762
2025-03-09 07:34:20,898 [INFO]: 	vectors dimension: 49152
2025-03-09 07:34:20,898 [INFO]: 	compression ratio: 0.999308459454441
2025-03-09 07:34:20,898 [INFO]: }
2025-03-09 07:34:20,898 [INFO]: 	>>> Finished "Creating the index" in 105.7301 secs
2025-03-09 07:34:20,898 [INFO]: >>> Finished "Launching the whole pipeline" in 105.7643 secs
2025-03-09 07:34:21: [retrieval_preprocessing] calculating distances ...
2025-03-09 07:34:22: [retrieval_preprocessing] finished and saved retrieval indices for episode 81924 [episode count 1/20]
[retrieval_preprocessing] for episode 53257 [episode count 2/20], we have num_retrieval=np.int64(6688) num_query=np.int64(240)
2025-03-09 07:34:25,123 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-09 07:34:26,012 [INFO]: Launching the whole pipeline 03/09/2025, 07:34:26
2025-03-09 07:34:26,012 [INFO]: Reading total number of vectors and dimension 03/09/2025, 07:34:26
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1402.31it/s]
2025-03-09 07:34:26,041 [INFO]: There are 6688 embeddings of dim 49152
2025-03-09 07:34:26,041 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0296 secs
2025-03-09 07:34:26,041 [INFO]: 	Compute estimated construction time of the index 03/09/2025, 07:34:26
2025-03-09 07:34:26,041 [INFO]: 		-> Train: 16.7 minutes
2025-03-09 07:34:26,041 [INFO]: 		-> Add: 3.7 seconds
2025-03-09 07:34:26,041 [INFO]: 		Total: 16.7 minutes
2025-03-09 07:34:26,042 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0001 secs
2025-03-09 07:34:26,042 [INFO]: 	Checking that your have enough memory available to create the index 03/09/2025, 07:34:26
2025-03-09 07:34:26,042 [INFO]: 1.3GB of memory will be needed to build the index (more might be used if you have more)
2025-03-09 07:34:26,042 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0002 secs
2025-03-09 07:34:26,042 [INFO]: 	Selecting most promising index types given data characteristics 03/09/2025, 07:34:26
2025-03-09 07:34:26,042 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-09 07:34:26,042 [INFO]: 	Creating the index 03/09/2025, 07:34:26
2025-03-09 07:34:26,042 [INFO]: 		-> Instanciate the index HNSW15 03/09/2025, 07:34:26
2025-03-09 07:34:26,043 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0013 secs
2025-03-09 07:34:26,043 [INFO]: 		-> Adding the vectors to the index 03/09/2025, 07:34:26
2025-03-09 07:34:26,044 [INFO]: The memory available for adding the vectors is 48.8GB(total available - used by the index)
2025-03-09 07:34:26,044 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/28 [00:00<?, ?it/s]  4%|▎         | 1/28 [00:00<00:04,  5.41it/s]  7%|▋         | 2/28 [00:00<00:03,  7.33it/s] 14%|█▍        | 4/28 [00:00<00:02,  9.07it/s] 21%|██▏       | 6/28 [00:00<00:02,  9.74it/s] 29%|██▊       | 8/28 [00:00<00:01, 10.09it/s] 36%|███▌      | 10/28 [00:01<00:01, 10.34it/s] 43%|████▎     | 12/28 [00:01<00:01, 10.37it/s] 50%|█████     | 14/28 [00:01<00:01, 10.27it/s] 57%|█████▋    | 16/28 [00:01<00:01, 10.42it/s] 64%|██████▍   | 18/28 [00:01<00:00, 10.45it/s] 71%|███████▏  | 20/28 [00:01<00:00, 10.55it/s] 79%|███████▊  | 22/28 [00:06<00:04,  1.40it/s] 86%|████████▌ | 24/28 [00:06<00:02,  1.93it/s] 93%|█████████▎| 26/28 [00:06<00:00,  2.63it/s]100%|██████████| 28/28 [00:08<00:00,  1.81it/s]100%|██████████| 28/28 [00:08<00:00,  3.34it/s]
2025-03-09 07:34:34,430 [INFO]: 	Computing best hyperparameters for index knn.index 03/09/2025, 07:34:34
2025-03-09 07:35:36,119 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 61.6882 secs
2025-03-09 07:35:36,119 [INFO]: The best hyperparameters are: efSearch=174
2025-03-09 07:35:36,120 [INFO]: 	Compute fast metrics 03/09/2025, 07:35:36
  0%|          | 0/4 [00:00<?, ?it/s] 25%|██▌       | 1/4 [00:00<00:00,  7.41it/s] 75%|███████▌  | 3/4 [00:00<00:00, 12.67it/s] 75%|███████▌  | 3/4 [00:00<00:00,  8.92it/s]
2025-03-09 07:35:56,932 [INFO]: 	>>> Finished "Compute fast metrics" in 20.8121 secs
2025-03-09 07:35:56,934 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 90.8901 secs
2025-03-09 07:35:56,934 [INFO]: {
2025-03-09 07:35:56,934 [INFO]: 	index_key: HNSW15
2025-03-09 07:35:56,934 [INFO]: 	index_param: efSearch=174
2025-03-09 07:35:56,934 [INFO]: 	index_path: knn.index
2025-03-09 07:35:56,934 [INFO]: 	size in bytes: 1315824370
2025-03-09 07:35:56,934 [INFO]: 	avg_search_speed_ms: 8.295603239735833
2025-03-09 07:35:56,934 [INFO]: 	99p_search_speed_ms: 17.226208385545778
2025-03-09 07:35:56,934 [INFO]: 	reconstruction error %: 0.0
2025-03-09 07:35:56,934 [INFO]: 	nb vectors: 6688
2025-03-09 07:35:56,934 [INFO]: 	vectors dimension: 49152
2025-03-09 07:35:56,934 [INFO]: 	compression ratio: 0.9993083681829057
2025-03-09 07:35:56,934 [INFO]: }
2025-03-09 07:35:56,934 [INFO]: 	>>> Finished "Creating the index" in 90.8920 secs
2025-03-09 07:35:56,934 [INFO]: >>> Finished "Launching the whole pipeline" in 90.9223 secs
2025-03-09 07:35:57: [retrieval_preprocessing] calculating distances ...
2025-03-09 07:35:58: [retrieval_preprocessing] finished and saved retrieval indices for episode 53257 [episode count 2/20]
[retrieval_preprocessing] for episode 82444 [episode count 3/20], we have num_retrieval=np.int64(6402) num_query=np.int64(526)
2025-03-09 07:36:06,198 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-09 07:36:07,058 [INFO]: Launching the whole pipeline 03/09/2025, 07:36:07
2025-03-09 07:36:07,058 [INFO]: Reading total number of vectors and dimension 03/09/2025, 07:36:07
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1785.57it/s]
2025-03-09 07:36:07,087 [INFO]: There are 6402 embeddings of dim 49152
2025-03-09 07:36:07,088 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0290 secs
2025-03-09 07:36:07,088 [INFO]: 	Compute estimated construction time of the index 03/09/2025, 07:36:07
2025-03-09 07:36:07,088 [INFO]: 		-> Train: 16.7 minutes
2025-03-09 07:36:07,088 [INFO]: 		-> Add: 3.5 seconds
2025-03-09 07:36:07,088 [INFO]: 		Total: 16.7 minutes
2025-03-09 07:36:07,088 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0003 secs
2025-03-09 07:36:07,088 [INFO]: 	Checking that your have enough memory available to create the index 03/09/2025, 07:36:07
2025-03-09 07:36:07,089 [INFO]: 1.3GB of memory will be needed to build the index (more might be used if you have more)
2025-03-09 07:36:07,089 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0004 secs
2025-03-09 07:36:07,089 [INFO]: 	Selecting most promising index types given data characteristics 03/09/2025, 07:36:07
2025-03-09 07:36:07,089 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-09 07:36:07,089 [INFO]: 	Creating the index 03/09/2025, 07:36:07
2025-03-09 07:36:07,089 [INFO]: 		-> Instanciate the index HNSW15 03/09/2025, 07:36:07
2025-03-09 07:36:07,092 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0027 secs
2025-03-09 07:36:07,092 [INFO]: 		-> Adding the vectors to the index 03/09/2025, 07:36:07
2025-03-09 07:36:07,092 [INFO]: The memory available for adding the vectors is 48.8GB(total available - used by the index)
2025-03-09 07:36:07,092 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/27 [00:00<?, ?it/s]  4%|▎         | 1/27 [00:00<00:15,  1.68it/s]  7%|▋         | 2/27 [00:01<00:12,  1.99it/s] 11%|█         | 3/27 [00:01<00:10,  2.25it/s] 15%|█▍        | 4/27 [00:01<00:09,  2.48it/s] 19%|█▊        | 5/27 [00:02<00:08,  2.51it/s] 22%|██▏       | 6/27 [00:02<00:08,  2.57it/s] 26%|██▌       | 7/27 [00:02<00:07,  2.71it/s] 30%|██▉       | 8/27 [00:03<00:08,  2.30it/s] 33%|███▎      | 9/27 [00:03<00:07,  2.34it/s] 37%|███▋      | 10/27 [00:04<00:06,  2.73it/s] 44%|████▍     | 12/27 [00:04<00:03,  4.54it/s] 56%|█████▌    | 15/27 [00:04<00:01,  7.88it/s] 70%|███████   | 19/27 [00:04<00:00, 12.43it/s] 78%|███████▊  | 21/27 [00:08<00:03,  1.58it/s] 89%|████████▉ | 24/27 [00:08<00:01,  2.36it/s]100%|██████████| 27/27 [00:11<00:00,  1.77it/s]100%|██████████| 27/27 [00:11<00:00,  2.35it/s]
2025-03-09 07:36:18,579 [INFO]: 	Computing best hyperparameters for index knn.index 03/09/2025, 07:36:18
2025-03-09 07:37:26,591 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 68.0108 secs
2025-03-09 07:37:26,592 [INFO]: The best hyperparameters are: efSearch=118
2025-03-09 07:37:26,592 [INFO]: 	Compute fast metrics 03/09/2025, 07:37:26
  0%|          | 0/4 [00:00<?, ?it/s] 25%|██▌       | 1/4 [00:00<00:00,  6.09it/s] 75%|███████▌  | 3/4 [00:00<00:00, 12.95it/s]
2025-03-09 07:37:40,278 [INFO]: 	>>> Finished "Compute fast metrics" in 13.6863 secs
2025-03-09 07:37:40,280 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 93.1873 secs
2025-03-09 07:37:40,280 [INFO]: {
2025-03-09 07:37:40,280 [INFO]: 	index_key: HNSW15
2025-03-09 07:37:40,280 [INFO]: 	index_param: efSearch=118
2025-03-09 07:37:40,280 [INFO]: 	index_path: knn.index
2025-03-09 07:37:40,280 [INFO]: 	size in bytes: 1259555590
2025-03-09 07:37:40,280 [INFO]: 	avg_search_speed_ms: 6.538393855931821
2025-03-09 07:37:40,280 [INFO]: 	99p_search_speed_ms: 18.543418170884262
2025-03-09 07:37:40,280 [INFO]: 	reconstruction error %: 0.0
2025-03-09 07:37:40,280 [INFO]: 	nb vectors: 6402
2025-03-09 07:37:40,280 [INFO]: 	vectors dimension: 49152
2025-03-09 07:37:40,280 [INFO]: 	compression ratio: 0.9993083481134802
2025-03-09 07:37:40,280 [INFO]: }
2025-03-09 07:37:40,280 [INFO]: 	>>> Finished "Creating the index" in 93.1909 secs
2025-03-09 07:37:40,280 [INFO]: >>> Finished "Launching the whole pipeline" in 93.2215 secs
2025-03-09 07:37:41: [retrieval_preprocessing] calculating distances ...
2025-03-09 07:37:43: [retrieval_preprocessing] finished and saved retrieval indices for episode 82444 [episode count 3/20]
[retrieval_preprocessing] for episode 75920 [episode count 4/20], we have num_retrieval=np.int64(6529) num_query=np.int64(399)
2025-03-09 07:37:44,157 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-09 07:37:45,062 [INFO]: Launching the whole pipeline 03/09/2025, 07:37:45
2025-03-09 07:37:45,062 [INFO]: Reading total number of vectors and dimension 03/09/2025, 07:37:45
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1009.46it/s]
2025-03-09 07:37:45,097 [INFO]: There are 6529 embeddings of dim 49152
2025-03-09 07:37:45,098 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0352 secs
2025-03-09 07:37:45,098 [INFO]: 	Compute estimated construction time of the index 03/09/2025, 07:37:45
2025-03-09 07:37:45,098 [INFO]: 		-> Train: 16.7 minutes
2025-03-09 07:37:45,098 [INFO]: 		-> Add: 3.6 seconds
2025-03-09 07:37:45,098 [INFO]: 		Total: 16.7 minutes
2025-03-09 07:37:45,098 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0001 secs
2025-03-09 07:37:45,098 [INFO]: 	Checking that your have enough memory available to create the index 03/09/2025, 07:37:45
2025-03-09 07:37:45,098 [INFO]: 1.3GB of memory will be needed to build the index (more might be used if you have more)
2025-03-09 07:37:45,098 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0002 secs
2025-03-09 07:37:45,098 [INFO]: 	Selecting most promising index types given data characteristics 03/09/2025, 07:37:45
2025-03-09 07:37:45,098 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-09 07:37:45,098 [INFO]: 	Creating the index 03/09/2025, 07:37:45
2025-03-09 07:37:45,098 [INFO]: 		-> Instanciate the index HNSW15 03/09/2025, 07:37:45
2025-03-09 07:37:45,099 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0009 secs
2025-03-09 07:37:45,099 [INFO]: 		-> Adding the vectors to the index 03/09/2025, 07:37:45
2025-03-09 07:37:45,099 [INFO]: The memory available for adding the vectors is 48.8GB(total available - used by the index)
2025-03-09 07:37:45,099 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/27 [00:00<?, ?it/s]  4%|▎         | 1/27 [00:00<00:02,  8.76it/s] 19%|█▊        | 5/27 [00:00<00:00, 23.22it/s] 33%|███▎      | 9/27 [00:00<00:00, 29.00it/s] 44%|████▍     | 12/27 [00:00<00:00, 27.58it/s] 56%|█████▌    | 15/27 [00:00<00:00, 27.91it/s] 74%|███████▍  | 20/27 [00:00<00:00, 32.90it/s] 89%|████████▉ | 24/27 [00:04<00:01,  2.74it/s]100%|██████████| 27/27 [00:06<00:00,  2.18it/s]100%|██████████| 27/27 [00:06<00:00,  3.92it/s]
2025-03-09 07:37:51,986 [INFO]: 	Computing best hyperparameters for index knn.index 03/09/2025, 07:37:51
2025-03-09 07:38:57,532 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 65.5455 secs
2025-03-09 07:38:57,533 [INFO]: The best hyperparameters are: efSearch=144
2025-03-09 07:38:57,533 [INFO]: 	Compute fast metrics 03/09/2025, 07:38:57
  0%|          | 0/4 [00:00<?, ?it/s] 25%|██▌       | 1/4 [00:00<00:00,  4.93it/s] 50%|█████     | 2/4 [00:00<00:00,  6.37it/s] 75%|███████▌  | 3/4 [00:00<00:00,  7.16it/s] 75%|███████▌  | 3/4 [00:00<00:00,  5.42it/s]
2025-03-09 07:39:13,621 [INFO]: 	>>> Finished "Compute fast metrics" in 16.0878 secs
2025-03-09 07:39:13,623 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 88.5231 secs
2025-03-09 07:39:13,623 [INFO]: {
2025-03-09 07:39:13,623 [INFO]: 	index_key: HNSW15
2025-03-09 07:39:13,623 [INFO]: 	index_param: efSearch=144
2025-03-09 07:39:13,623 [INFO]: 	index_path: knn.index
2025-03-09 07:39:13,623 [INFO]: 	size in bytes: 1284541930
2025-03-09 07:39:13,623 [INFO]: 	avg_search_speed_ms: 8.736625158606202
2025-03-09 07:39:13,623 [INFO]: 	99p_search_speed_ms: 16.064543584361648
2025-03-09 07:39:13,623 [INFO]: 	reconstruction error %: 0.0
2025-03-09 07:39:13,623 [INFO]: 	nb vectors: 6529
2025-03-09 07:39:13,623 [INFO]: 	vectors dimension: 49152
2025-03-09 07:39:13,623 [INFO]: 	compression ratio: 0.9993084709971282
2025-03-09 07:39:13,623 [INFO]: }
2025-03-09 07:39:13,623 [INFO]: 	>>> Finished "Creating the index" in 88.5247 secs
2025-03-09 07:39:13,623 [INFO]: >>> Finished "Launching the whole pipeline" in 88.5606 secs
2025-03-09 07:39:15: [retrieval_preprocessing] calculating distances ...
2025-03-09 07:39:16: [retrieval_preprocessing] finished and saved retrieval indices for episode 75920 [episode count 4/20]
[retrieval_preprocessing] for episode 86928 [episode count 5/20], we have num_retrieval=np.int64(6505) num_query=np.int64(423)
2025-03-09 07:39:19,012 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-09 07:39:19,900 [INFO]: Launching the whole pipeline 03/09/2025, 07:39:19
2025-03-09 07:39:19,900 [INFO]: Reading total number of vectors and dimension 03/09/2025, 07:39:19
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1085.76it/s]
2025-03-09 07:39:19,929 [INFO]: There are 6505 embeddings of dim 49152
2025-03-09 07:39:19,929 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0297 secs
2025-03-09 07:39:19,930 [INFO]: 	Compute estimated construction time of the index 03/09/2025, 07:39:19
2025-03-09 07:39:19,930 [INFO]: 		-> Train: 16.7 minutes
2025-03-09 07:39:19,930 [INFO]: 		-> Add: 3.6 seconds
2025-03-09 07:39:19,930 [INFO]: 		Total: 16.7 minutes
2025-03-09 07:39:19,930 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0001 secs
2025-03-09 07:39:19,930 [INFO]: 	Checking that your have enough memory available to create the index 03/09/2025, 07:39:19
2025-03-09 07:39:19,930 [INFO]: 1.3GB of memory will be needed to build the index (more might be used if you have more)
2025-03-09 07:39:19,930 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0002 secs
2025-03-09 07:39:19,930 [INFO]: 	Selecting most promising index types given data characteristics 03/09/2025, 07:39:19
2025-03-09 07:39:19,930 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-09 07:39:19,930 [INFO]: 	Creating the index 03/09/2025, 07:39:19
2025-03-09 07:39:19,930 [INFO]: 		-> Instanciate the index HNSW15 03/09/2025, 07:39:19
2025-03-09 07:39:19,931 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0011 secs
2025-03-09 07:39:19,931 [INFO]: 		-> Adding the vectors to the index 03/09/2025, 07:39:19
2025-03-09 07:39:19,932 [INFO]: The memory available for adding the vectors is 48.8GB(total available - used by the index)
2025-03-09 07:39:19,932 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/27 [00:00<?, ?it/s]  4%|▎         | 1/27 [00:00<00:06,  4.25it/s]  7%|▋         | 2/27 [00:00<00:04,  5.89it/s] 11%|█         | 3/27 [00:00<00:03,  6.70it/s] 15%|█▍        | 4/27 [00:00<00:03,  7.22it/s] 19%|█▊        | 5/27 [00:00<00:02,  7.50it/s] 22%|██▏       | 6/27 [00:00<00:02,  7.76it/s] 26%|██▌       | 7/27 [00:00<00:02,  7.92it/s] 33%|███▎      | 9/27 [00:01<00:01,  9.49it/s] 52%|█████▏    | 14/27 [00:01<00:00, 17.61it/s] 59%|█████▉    | 16/27 [00:01<00:00, 14.88it/s] 67%|██████▋   | 18/27 [00:01<00:00, 12.24it/s] 74%|███████▍  | 20/27 [00:01<00:00, 10.91it/s] 81%|████████▏ | 22/27 [00:06<00:03,  1.51it/s] 89%|████████▉ | 24/27 [00:06<00:01,  2.05it/s] 96%|█████████▋| 26/27 [00:06<00:00,  2.74it/s]100%|██████████| 27/27 [00:08<00:00,  3.22it/s]
2025-03-09 07:39:28,333 [INFO]: 	Computing best hyperparameters for index knn.index 03/09/2025, 07:39:28
2025-03-09 07:40:32,230 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 63.8959 secs
2025-03-09 07:40:32,231 [INFO]: The best hyperparameters are: efSearch=177
2025-03-09 07:40:32,231 [INFO]: 	Compute fast metrics 03/09/2025, 07:40:32
  0%|          | 0/4 [00:00<?, ?it/s] 25%|██▌       | 1/4 [00:00<00:00,  6.16it/s] 75%|███████▌  | 3/4 [00:00<00:00, 10.76it/s] 75%|███████▌  | 3/4 [00:00<00:00,  7.92it/s]
2025-03-09 07:40:49,506 [INFO]: 	>>> Finished "Compute fast metrics" in 17.2751 secs
2025-03-09 07:40:49,507 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 89.5758 secs
2025-03-09 07:40:49,507 [INFO]: {
2025-03-09 07:40:49,507 [INFO]: 	index_key: HNSW15
2025-03-09 07:40:49,507 [INFO]: 	index_param: efSearch=177
2025-03-09 07:40:49,507 [INFO]: 	index_path: knn.index
2025-03-09 07:40:49,507 [INFO]: 	size in bytes: 1279820110
2025-03-09 07:40:49,507 [INFO]: 	avg_search_speed_ms: 7.228157420414389
2025-03-09 07:40:49,507 [INFO]: 	99p_search_speed_ms: 12.10916374344379
2025-03-09 07:40:49,508 [INFO]: 	reconstruction error %: 0.0
2025-03-09 07:40:49,508 [INFO]: 	nb vectors: 6505
2025-03-09 07:40:49,508 [INFO]: 	vectors dimension: 49152
2025-03-09 07:40:49,508 [INFO]: 	compression ratio: 0.999308441871569
2025-03-09 07:40:49,508 [INFO]: }
2025-03-09 07:40:49,508 [INFO]: 	>>> Finished "Creating the index" in 89.5774 secs
2025-03-09 07:40:49,508 [INFO]: >>> Finished "Launching the whole pipeline" in 89.6079 secs
2025-03-09 07:40:50: [retrieval_preprocessing] calculating distances ...
2025-03-09 07:40:52: [retrieval_preprocessing] finished and saved retrieval indices for episode 86928 [episode count 5/20]
[retrieval_preprocessing] for episode 82962 [episode count 6/20], we have num_retrieval=np.int64(6597) num_query=np.int64(331)
2025-03-09 07:40:54,201 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-09 07:40:55,142 [INFO]: Launching the whole pipeline 03/09/2025, 07:40:55
2025-03-09 07:40:55,142 [INFO]: Reading total number of vectors and dimension 03/09/2025, 07:40:55
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1263.34it/s]
2025-03-09 07:40:55,168 [INFO]: There are 6597 embeddings of dim 49152
2025-03-09 07:40:55,168 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0266 secs
2025-03-09 07:40:55,169 [INFO]: 	Compute estimated construction time of the index 03/09/2025, 07:40:55
2025-03-09 07:40:55,169 [INFO]: 		-> Train: 16.7 minutes
2025-03-09 07:40:55,169 [INFO]: 		-> Add: 3.6 seconds
2025-03-09 07:40:55,169 [INFO]: 		Total: 16.7 minutes
2025-03-09 07:40:55,169 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0001 secs
2025-03-09 07:40:55,169 [INFO]: 	Checking that your have enough memory available to create the index 03/09/2025, 07:40:55
2025-03-09 07:40:55,169 [INFO]: 1.3GB of memory will be needed to build the index (more might be used if you have more)
2025-03-09 07:40:55,169 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0001 secs
2025-03-09 07:40:55,169 [INFO]: 	Selecting most promising index types given data characteristics 03/09/2025, 07:40:55
2025-03-09 07:40:55,169 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-09 07:40:55,169 [INFO]: 	Creating the index 03/09/2025, 07:40:55
2025-03-09 07:40:55,169 [INFO]: 		-> Instanciate the index HNSW15 03/09/2025, 07:40:55
2025-03-09 07:40:55,170 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0009 secs
2025-03-09 07:40:55,170 [INFO]: 		-> Adding the vectors to the index 03/09/2025, 07:40:55
2025-03-09 07:40:55,170 [INFO]: The memory available for adding the vectors is 48.8GB(total available - used by the index)
2025-03-09 07:40:55,170 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/27 [00:00<?, ?it/s]  4%|▎         | 1/27 [00:00<00:05,  5.17it/s] 11%|█         | 3/27 [00:00<00:02,  8.96it/s] 19%|█▊        | 5/27 [00:00<00:02, 10.00it/s] 26%|██▌       | 7/27 [00:00<00:01, 10.75it/s] 33%|███▎      | 9/27 [00:00<00:01, 11.14it/s] 41%|████      | 11/27 [00:01<00:01, 11.30it/s] 48%|████▊     | 13/27 [00:01<00:01, 11.52it/s] 56%|█████▌    | 15/27 [00:01<00:01, 11.58it/s] 63%|██████▎   | 17/27 [00:01<00:00, 11.57it/s] 70%|███████   | 19/27 [00:01<00:00, 11.66it/s] 78%|███████▊  | 21/27 [00:05<00:03,  1.69it/s] 85%|████████▌ | 23/27 [00:05<00:01,  2.30it/s]100%|██████████| 27/27 [00:08<00:00,  1.73it/s]100%|██████████| 27/27 [00:08<00:00,  3.25it/s]
2025-03-09 07:41:03,478 [INFO]: 	Computing best hyperparameters for index knn.index 03/09/2025, 07:41:03
2025-03-09 07:42:04,157 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 60.6785 secs
2025-03-09 07:42:04,157 [INFO]: The best hyperparameters are: efSearch=202
2025-03-09 07:42:04,157 [INFO]: 	Compute fast metrics 03/09/2025, 07:42:04
  0%|          | 0/4 [00:00<?, ?it/s] 25%|██▌       | 1/4 [00:00<00:00,  5.79it/s] 75%|███████▌  | 3/4 [00:00<00:00,  8.78it/s] 75%|███████▌  | 3/4 [00:00<00:00,  6.71it/s]
2025-03-09 07:42:19,563 [INFO]: 	>>> Finished "Compute fast metrics" in 15.4061 secs
2025-03-09 07:42:19,564 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 84.3942 secs
2025-03-09 07:42:19,564 [INFO]: {
2025-03-09 07:42:19,564 [INFO]: 	index_key: HNSW15
2025-03-09 07:42:19,564 [INFO]: 	index_param: efSearch=202
2025-03-09 07:42:19,564 [INFO]: 	index_path: knn.index
2025-03-09 07:42:19,564 [INFO]: 	size in bytes: 1297920610
2025-03-09 07:42:19,564 [INFO]: 	avg_search_speed_ms: 8.737546847880838
2025-03-09 07:42:19,564 [INFO]: 	99p_search_speed_ms: 15.946701441425812
2025-03-09 07:42:19,564 [INFO]: 	reconstruction error %: 0.0
2025-03-09 07:42:19,565 [INFO]: 	nb vectors: 6597
2025-03-09 07:42:19,565 [INFO]: 	vectors dimension: 49152
2025-03-09 07:42:19,565 [INFO]: 	compression ratio: 0.9993084060819406
2025-03-09 07:42:19,565 [INFO]: }
2025-03-09 07:42:19,565 [INFO]: 	>>> Finished "Creating the index" in 84.3955 secs
2025-03-09 07:42:19,565 [INFO]: >>> Finished "Launching the whole pipeline" in 84.4227 secs
2025-03-09 07:42:21: [retrieval_preprocessing] calculating distances ...
2025-03-09 07:42:22: [retrieval_preprocessing] finished and saved retrieval indices for episode 82962 [episode count 6/20]
[retrieval_preprocessing] for episode 17171 [episode count 7/20], we have num_retrieval=np.int64(6737) num_query=np.int64(191)
2025-03-09 07:42:24,290 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-09 07:42:25,204 [INFO]: Launching the whole pipeline 03/09/2025, 07:42:25
2025-03-09 07:42:25,204 [INFO]: Reading total number of vectors and dimension 03/09/2025, 07:42:25
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1881.70it/s]
2025-03-09 07:42:25,233 [INFO]: There are 6737 embeddings of dim 49152
2025-03-09 07:42:25,233 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0290 secs
2025-03-09 07:42:25,233 [INFO]: 	Compute estimated construction time of the index 03/09/2025, 07:42:25
2025-03-09 07:42:25,233 [INFO]: 		-> Train: 16.7 minutes
2025-03-09 07:42:25,233 [INFO]: 		-> Add: 3.7 seconds
2025-03-09 07:42:25,233 [INFO]: 		Total: 16.7 minutes
2025-03-09 07:42:25,233 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0001 secs
2025-03-09 07:42:25,233 [INFO]: 	Checking that your have enough memory available to create the index 03/09/2025, 07:42:25
2025-03-09 07:42:25,233 [INFO]: 1.4GB of memory will be needed to build the index (more might be used if you have more)
2025-03-09 07:42:25,233 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0001 secs
2025-03-09 07:42:25,233 [INFO]: 	Selecting most promising index types given data characteristics 03/09/2025, 07:42:25
2025-03-09 07:42:25,233 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-09 07:42:25,233 [INFO]: 	Creating the index 03/09/2025, 07:42:25
2025-03-09 07:42:25,233 [INFO]: 		-> Instanciate the index HNSW15 03/09/2025, 07:42:25
2025-03-09 07:42:25,234 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0010 secs
2025-03-09 07:42:25,234 [INFO]: 		-> Adding the vectors to the index 03/09/2025, 07:42:25
2025-03-09 07:42:25,234 [INFO]: The memory available for adding the vectors is 48.8GB(total available - used by the index)
2025-03-09 07:42:25,235 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/28 [00:00<?, ?it/s]  4%|▎         | 1/28 [00:00<00:05,  5.06it/s] 11%|█         | 3/28 [00:00<00:02,  9.60it/s] 18%|█▊        | 5/28 [00:00<00:02, 10.96it/s] 25%|██▌       | 7/28 [00:00<00:01, 11.47it/s] 32%|███▏      | 9/28 [00:00<00:01, 11.64it/s] 39%|███▉      | 11/28 [00:00<00:01, 11.72it/s] 46%|████▋     | 13/28 [00:01<00:01, 11.75it/s] 54%|█████▎    | 15/28 [00:01<00:01, 12.75it/s] 68%|██████▊   | 19/28 [00:01<00:00, 17.61it/s] 75%|███████▌  | 21/28 [00:05<00:03,  1.90it/s] 82%|████████▏ | 23/28 [00:05<00:02,  2.44it/s] 89%|████████▉ | 25/28 [00:05<00:00,  3.13it/s] 96%|█████████▋| 27/28 [00:05<00:00,  3.96it/s]100%|██████████| 28/28 [00:07<00:00,  3.74it/s]
2025-03-09 07:42:32,731 [INFO]: 	Computing best hyperparameters for index knn.index 03/09/2025, 07:42:32
2025-03-09 07:43:27,534 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 54.8020 secs
2025-03-09 07:43:27,534 [INFO]: The best hyperparameters are: efSearch=207
2025-03-09 07:43:27,534 [INFO]: 	Compute fast metrics 03/09/2025, 07:43:27
  0%|          | 0/4 [00:00<?, ?it/s] 25%|██▌       | 1/4 [00:00<00:00,  5.71it/s] 50%|█████     | 2/4 [00:00<00:00,  6.99it/s] 75%|███████▌  | 3/4 [00:00<00:00,  7.59it/s] 75%|███████▌  | 3/4 [00:00<00:00,  5.70it/s]
2025-03-09 07:43:44,293 [INFO]: 	>>> Finished "Compute fast metrics" in 16.7589 secs
2025-03-09 07:43:44,295 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 79.0602 secs
2025-03-09 07:43:44,295 [INFO]: {
2025-03-09 07:43:44,295 [INFO]: 	index_key: HNSW15
2025-03-09 07:43:44,295 [INFO]: 	index_param: efSearch=207
2025-03-09 07:43:44,295 [INFO]: 	index_path: knn.index
2025-03-09 07:43:44,295 [INFO]: 	size in bytes: 1325464810
2025-03-09 07:43:44,295 [INFO]: 	avg_search_speed_ms: 9.531850807610242
2025-03-09 07:43:44,295 [INFO]: 	99p_search_speed_ms: 22.439131336286657
2025-03-09 07:43:44,295 [INFO]: 	reconstruction error %: 0.0
2025-03-09 07:43:44,295 [INFO]: 	nb vectors: 6737
2025-03-09 07:43:44,295 [INFO]: 	vectors dimension: 49152
2025-03-09 07:43:44,295 [INFO]: 	compression ratio: 0.9993083829966033
2025-03-09 07:43:44,295 [INFO]: }
2025-03-09 07:43:44,295 [INFO]: 	>>> Finished "Creating the index" in 79.0616 secs
2025-03-09 07:43:44,295 [INFO]: >>> Finished "Launching the whole pipeline" in 79.0911 secs
2025-03-09 07:43:45: [retrieval_preprocessing] calculating distances ...
2025-03-09 07:43:45: [retrieval_preprocessing] finished and saved retrieval indices for episode 17171 [episode count 7/20]
[retrieval_preprocessing] for episode 75667 [episode count 8/20], we have num_retrieval=np.int64(6566) num_query=np.int64(362)
2025-03-09 07:43:48,303 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-09 07:43:49,379 [INFO]: Launching the whole pipeline 03/09/2025, 07:43:49
2025-03-09 07:43:49,379 [INFO]: Reading total number of vectors and dimension 03/09/2025, 07:43:49
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1125.38it/s]
2025-03-09 07:43:49,404 [INFO]: There are 6566 embeddings of dim 49152
2025-03-09 07:43:49,404 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0254 secs
2025-03-09 07:43:49,404 [INFO]: 	Compute estimated construction time of the index 03/09/2025, 07:43:49
2025-03-09 07:43:49,405 [INFO]: 		-> Train: 16.7 minutes
2025-03-09 07:43:49,405 [INFO]: 		-> Add: 3.6 seconds
2025-03-09 07:43:49,405 [INFO]: 		Total: 16.7 minutes
2025-03-09 07:43:49,405 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0001 secs
2025-03-09 07:43:49,405 [INFO]: 	Checking that your have enough memory available to create the index 03/09/2025, 07:43:49
2025-03-09 07:43:49,405 [INFO]: 1.3GB of memory will be needed to build the index (more might be used if you have more)
2025-03-09 07:43:49,405 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0002 secs
2025-03-09 07:43:49,405 [INFO]: 	Selecting most promising index types given data characteristics 03/09/2025, 07:43:49
2025-03-09 07:43:49,405 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-09 07:43:49,405 [INFO]: 	Creating the index 03/09/2025, 07:43:49
2025-03-09 07:43:49,405 [INFO]: 		-> Instanciate the index HNSW15 03/09/2025, 07:43:49
2025-03-09 07:43:49,406 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0011 secs
2025-03-09 07:43:49,406 [INFO]: 		-> Adding the vectors to the index 03/09/2025, 07:43:49
2025-03-09 07:43:49,406 [INFO]: The memory available for adding the vectors is 48.8GB(total available - used by the index)
2025-03-09 07:43:49,406 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/27 [00:00<?, ?it/s]  4%|▎         | 1/27 [00:00<00:06,  4.10it/s]  7%|▋         | 2/27 [00:00<00:04,  5.76it/s] 11%|█         | 3/27 [00:00<00:03,  6.59it/s] 15%|█▍        | 4/27 [00:00<00:03,  7.28it/s] 19%|█▊        | 5/27 [00:00<00:02,  7.68it/s] 22%|██▏       | 6/27 [00:00<00:02,  8.12it/s] 26%|██▌       | 7/27 [00:00<00:02,  8.10it/s] 30%|██▉       | 8/27 [00:01<00:02,  8.08it/s] 33%|███▎      | 9/27 [00:01<00:02,  8.15it/s] 37%|███▋      | 10/27 [00:01<00:02,  8.28it/s] 44%|████▍     | 12/27 [00:01<00:01, 10.86it/s] 52%|█████▏    | 14/27 [00:01<00:01, 10.56it/s] 59%|█████▉    | 16/27 [00:01<00:01,  9.87it/s] 67%|██████▋   | 18/27 [00:02<00:00,  9.49it/s] 70%|███████   | 19/27 [00:02<00:00,  8.63it/s] 74%|███████▍  | 20/27 [00:02<00:00,  8.09it/s] 78%|███████▊  | 21/27 [00:06<00:06,  1.10s/it] 81%|████████▏ | 22/27 [00:06<00:04,  1.18it/s] 89%|████████▉ | 24/27 [00:06<00:01,  1.89it/s] 96%|█████████▋| 26/27 [00:07<00:00,  2.76it/s]100%|██████████| 27/27 [00:09<00:00,  1.28it/s]100%|██████████| 27/27 [00:09<00:00,  2.86it/s]
2025-03-09 07:43:58,846 [INFO]: 	Computing best hyperparameters for index knn.index 03/09/2025, 07:43:58
2025-03-09 07:44:54,448 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 55.6016 secs
2025-03-09 07:44:54,448 [INFO]: The best hyperparameters are: efSearch=191
2025-03-09 07:44:54,448 [INFO]: 	Compute fast metrics 03/09/2025, 07:44:54
  0%|          | 0/4 [00:00<?, ?it/s] 25%|██▌       | 1/4 [00:00<00:00,  5.04it/s] 50%|█████     | 2/4 [00:00<00:00,  6.58it/s] 75%|███████▌  | 3/4 [00:00<00:00,  7.44it/s] 75%|███████▌  | 3/4 [00:00<00:00,  5.52it/s]
2025-03-09 07:45:10,687 [INFO]: 	>>> Finished "Compute fast metrics" in 16.2383 secs
2025-03-09 07:45:10,688 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 81.2819 secs
2025-03-09 07:45:10,688 [INFO]: {
2025-03-09 07:45:10,688 [INFO]: 	index_key: HNSW15
2025-03-09 07:45:10,688 [INFO]: 	index_param: efSearch=191
2025-03-09 07:45:10,688 [INFO]: 	index_path: knn.index
2025-03-09 07:45:10,688 [INFO]: 	size in bytes: 1291821550
2025-03-09 07:45:10,688 [INFO]: 	avg_search_speed_ms: 8.674919344961372
2025-03-09 07:45:10,688 [INFO]: 	99p_search_speed_ms: 14.62005096487701
2025-03-09 07:45:10,688 [INFO]: 	reconstruction error %: 0.0
2025-03-09 07:45:10,688 [INFO]: 	nb vectors: 6566
2025-03-09 07:45:10,688 [INFO]: 	vectors dimension: 49152
2025-03-09 07:45:10,688 [INFO]: 	compression ratio: 0.9993084013809802
2025-03-09 07:45:10,688 [INFO]: }
2025-03-09 07:45:10,688 [INFO]: 	>>> Finished "Creating the index" in 81.2834 secs
2025-03-09 07:45:10,688 [INFO]: >>> Finished "Launching the whole pipeline" in 81.3095 secs
2025-03-09 07:45:12: [retrieval_preprocessing] calculating distances ...
2025-03-09 07:45:13: [retrieval_preprocessing] finished and saved retrieval indices for episode 75667 [episode count 8/20]
[retrieval_preprocessing] for episode 82199 [episode count 9/20], we have num_retrieval=np.int64(6509) num_query=np.int64(419)
2025-03-09 07:45:15,267 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-09 07:45:16,168 [INFO]: Launching the whole pipeline 03/09/2025, 07:45:16
2025-03-09 07:45:16,168 [INFO]: Reading total number of vectors and dimension 03/09/2025, 07:45:16
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1495.83it/s]
2025-03-09 07:45:16,201 [INFO]: There are 6509 embeddings of dim 49152
2025-03-09 07:45:16,201 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0331 secs
2025-03-09 07:45:16,201 [INFO]: 	Compute estimated construction time of the index 03/09/2025, 07:45:16
2025-03-09 07:45:16,201 [INFO]: 		-> Train: 16.7 minutes
2025-03-09 07:45:16,201 [INFO]: 		-> Add: 3.6 seconds
2025-03-09 07:45:16,201 [INFO]: 		Total: 16.7 minutes
2025-03-09 07:45:16,201 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0001 secs
2025-03-09 07:45:16,201 [INFO]: 	Checking that your have enough memory available to create the index 03/09/2025, 07:45:16
2025-03-09 07:45:16,201 [INFO]: 1.3GB of memory will be needed to build the index (more might be used if you have more)
2025-03-09 07:45:16,201 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0001 secs
2025-03-09 07:45:16,201 [INFO]: 	Selecting most promising index types given data characteristics 03/09/2025, 07:45:16
2025-03-09 07:45:16,201 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-09 07:45:16,201 [INFO]: 	Creating the index 03/09/2025, 07:45:16
2025-03-09 07:45:16,201 [INFO]: 		-> Instanciate the index HNSW15 03/09/2025, 07:45:16
2025-03-09 07:45:16,202 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0010 secs
2025-03-09 07:45:16,202 [INFO]: 		-> Adding the vectors to the index 03/09/2025, 07:45:16
2025-03-09 07:45:16,202 [INFO]: The memory available for adding the vectors is 48.8GB(total available - used by the index)
2025-03-09 07:45:16,203 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/27 [00:00<?, ?it/s]  4%|▎         | 1/27 [00:00<00:04,  5.27it/s] 11%|█         | 3/27 [00:00<00:02, 10.00it/s] 19%|█▊        | 5/27 [00:00<00:01, 12.88it/s] 26%|██▌       | 7/27 [00:00<00:01, 13.84it/s] 33%|███▎      | 9/27 [00:00<00:01, 13.25it/s] 41%|████      | 11/27 [00:00<00:01, 12.79it/s] 48%|████▊     | 13/27 [00:01<00:01, 12.56it/s] 56%|█████▌    | 15/27 [00:01<00:00, 12.96it/s] 63%|██████▎   | 17/27 [00:01<00:00, 13.53it/s] 70%|███████   | 19/27 [00:01<00:00, 13.33it/s] 78%|███████▊  | 21/27 [00:05<00:03,  1.63it/s] 81%|████████▏ | 22/27 [00:05<00:02,  1.88it/s] 85%|████████▌ | 23/27 [00:05<00:01,  2.23it/s] 93%|█████████▎| 25/27 [00:05<00:00,  3.27it/s]100%|██████████| 27/27 [00:08<00:00,  1.59it/s]100%|██████████| 27/27 [00:08<00:00,  3.36it/s]
2025-03-09 07:45:24,242 [INFO]: 	Computing best hyperparameters for index knn.index 03/09/2025, 07:45:24
2025-03-09 07:46:19,827 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 55.5846 secs
2025-03-09 07:46:19,827 [INFO]: The best hyperparameters are: efSearch=183
2025-03-09 07:46:19,827 [INFO]: 	Compute fast metrics 03/09/2025, 07:46:19
  0%|          | 0/4 [00:00<?, ?it/s] 25%|██▌       | 1/4 [00:00<00:00,  4.95it/s] 50%|█████     | 2/4 [00:00<00:00,  5.83it/s] 75%|███████▌  | 3/4 [00:00<00:00,  7.12it/s] 75%|███████▌  | 3/4 [00:00<00:00,  5.55it/s]
2025-03-09 07:46:44,397 [INFO]: 	>>> Finished "Compute fast metrics" in 24.5696 secs
2025-03-09 07:46:44,399 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 88.1964 secs
2025-03-09 07:46:44,399 [INFO]: {
2025-03-09 07:46:44,399 [INFO]: 	index_key: HNSW15
2025-03-09 07:46:44,399 [INFO]: 	index_param: efSearch=183
2025-03-09 07:46:44,399 [INFO]: 	index_path: knn.index
2025-03-09 07:46:44,399 [INFO]: 	size in bytes: 1280607070
2025-03-09 07:46:44,399 [INFO]: 	avg_search_speed_ms: 8.988613267793166
2025-03-09 07:46:44,399 [INFO]: 	99p_search_speed_ms: 16.088190181180817
2025-03-09 07:46:44,399 [INFO]: 	reconstruction error %: 0.0
2025-03-09 07:46:44,399 [INFO]: 	nb vectors: 6509
2025-03-09 07:46:44,399 [INFO]: 	vectors dimension: 49152
2025-03-09 07:46:44,399 [INFO]: 	compression ratio: 0.9993084545441405
2025-03-09 07:46:44,399 [INFO]: }
2025-03-09 07:46:44,399 [INFO]: 	>>> Finished "Creating the index" in 88.1978 secs
2025-03-09 07:46:44,399 [INFO]: >>> Finished "Launching the whole pipeline" in 88.2316 secs
2025-03-09 07:46:46: [retrieval_preprocessing] calculating distances ...
2025-03-09 07:46:48: [retrieval_preprocessing] finished and saved retrieval indices for episode 82199 [episode count 9/20]
[retrieval_preprocessing] for episode 43548 [episode count 10/20], we have num_retrieval=np.int64(6730) num_query=np.int64(198)
2025-03-09 07:46:50,165 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-09 07:46:51,106 [INFO]: Launching the whole pipeline 03/09/2025, 07:46:51
2025-03-09 07:46:51,106 [INFO]: Reading total number of vectors and dimension 03/09/2025, 07:46:51
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1359.58it/s]
2025-03-09 07:46:51,133 [INFO]: There are 6730 embeddings of dim 49152
2025-03-09 07:46:51,133 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0268 secs
2025-03-09 07:46:51,133 [INFO]: 	Compute estimated construction time of the index 03/09/2025, 07:46:51
2025-03-09 07:46:51,133 [INFO]: 		-> Train: 16.7 minutes
2025-03-09 07:46:51,133 [INFO]: 		-> Add: 3.7 seconds
2025-03-09 07:46:51,133 [INFO]: 		Total: 16.7 minutes
2025-03-09 07:46:51,133 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0001 secs
2025-03-09 07:46:51,133 [INFO]: 	Checking that your have enough memory available to create the index 03/09/2025, 07:46:51
2025-03-09 07:46:51,134 [INFO]: 1.4GB of memory will be needed to build the index (more might be used if you have more)
2025-03-09 07:46:51,134 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0002 secs
2025-03-09 07:46:51,134 [INFO]: 	Selecting most promising index types given data characteristics 03/09/2025, 07:46:51
2025-03-09 07:46:51,134 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-09 07:46:51,134 [INFO]: 	Creating the index 03/09/2025, 07:46:51
2025-03-09 07:46:51,134 [INFO]: 		-> Instanciate the index HNSW15 03/09/2025, 07:46:51
2025-03-09 07:46:51,135 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0015 secs
2025-03-09 07:46:51,135 [INFO]: 		-> Adding the vectors to the index 03/09/2025, 07:46:51
2025-03-09 07:46:51,136 [INFO]: The memory available for adding the vectors is 48.8GB(total available - used by the index)
2025-03-09 07:46:51,136 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/28 [00:00<?, ?it/s]  4%|▎         | 1/28 [00:00<00:06,  3.91it/s]  7%|▋         | 2/28 [00:00<00:04,  5.71it/s] 11%|█         | 3/28 [00:00<00:03,  6.76it/s] 14%|█▍        | 4/28 [00:00<00:03,  7.66it/s] 18%|█▊        | 5/28 [00:00<00:02,  8.31it/s] 21%|██▏       | 6/28 [00:00<00:02,  8.57it/s] 29%|██▊       | 8/28 [00:00<00:02,  9.68it/s] 36%|███▌      | 10/28 [00:01<00:01, 10.29it/s] 43%|████▎     | 12/28 [00:01<00:01, 10.41it/s] 50%|█████     | 14/28 [00:01<00:01, 10.69it/s] 57%|█████▋    | 16/28 [00:01<00:01, 10.52it/s] 64%|██████▍   | 18/28 [00:01<00:00, 10.50it/s] 71%|███████▏  | 20/28 [00:02<00:00, 10.57it/s] 79%|███████▊  | 22/28 [00:07<00:04,  1.21it/s] 82%|████████▏ | 23/28 [00:07<00:03,  1.43it/s] 86%|████████▌ | 24/28 [00:07<00:02,  1.74it/s] 89%|████████▉ | 25/28 [00:07<00:01,  2.14it/s] 96%|█████████▋| 27/28 [00:07<00:00,  3.16it/s]100%|██████████| 28/28 [00:09<00:00,  1.48it/s]100%|██████████| 28/28 [00:09<00:00,  2.96it/s]
2025-03-09 07:47:00,589 [INFO]: 	Computing best hyperparameters for index knn.index 03/09/2025, 07:47:00
2025-03-09 07:47:52,217 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 51.6275 secs
2025-03-09 07:47:52,217 [INFO]: The best hyperparameters are: efSearch=147
2025-03-09 07:47:52,217 [INFO]: 	Compute fast metrics 03/09/2025, 07:47:52
  0%|          | 0/4 [00:00<?, ?it/s] 25%|██▌       | 1/4 [00:00<00:00,  4.09it/s] 50%|█████     | 2/4 [00:00<00:00,  6.11it/s] 75%|███████▌  | 3/4 [00:00<00:00,  5.54it/s]
2025-03-09 07:48:08,020 [INFO]: 	>>> Finished "Compute fast metrics" in 15.8034 secs
2025-03-09 07:48:08,022 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 76.8864 secs
2025-03-09 07:48:08,022 [INFO]: {
2025-03-09 07:48:08,022 [INFO]: 	index_key: HNSW15
2025-03-09 07:48:08,022 [INFO]: 	index_param: efSearch=147
2025-03-09 07:48:08,022 [INFO]: 	index_path: knn.index
2025-03-09 07:48:08,022 [INFO]: 	size in bytes: 1324087570
2025-03-09 07:48:08,022 [INFO]: 	avg_search_speed_ms: 7.319260501278234
2025-03-09 07:48:08,022 [INFO]: 	99p_search_speed_ms: 13.92396053997799
2025-03-09 07:48:08,022 [INFO]: 	reconstruction error %: 0.0
2025-03-09 07:48:08,022 [INFO]: 	nb vectors: 6730
2025-03-09 07:48:08,022 [INFO]: 	vectors dimension: 49152
2025-03-09 07:48:08,022 [INFO]: 	compression ratio: 0.999308406769501
2025-03-09 07:48:08,022 [INFO]: }
2025-03-09 07:48:08,022 [INFO]: 	>>> Finished "Creating the index" in 76.8885 secs
2025-03-09 07:48:08,022 [INFO]: >>> Finished "Launching the whole pipeline" in 76.9160 secs
2025-03-09 07:48:08: [retrieval_preprocessing] calculating distances ...
2025-03-09 07:48:09: [retrieval_preprocessing] finished and saved retrieval indices for episode 43548 [episode count 10/20]
[retrieval_preprocessing] for episode 6434 [episode count 11/20], we have num_retrieval=np.int64(6539) num_query=np.int64(389)
2025-03-09 07:48:11,896 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-09 07:48:12,800 [INFO]: Launching the whole pipeline 03/09/2025, 07:48:12
2025-03-09 07:48:12,800 [INFO]: Reading total number of vectors and dimension 03/09/2025, 07:48:12
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1233.98it/s]
2025-03-09 07:48:12,833 [INFO]: There are 6539 embeddings of dim 49152
2025-03-09 07:48:12,834 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0334 secs
2025-03-09 07:48:12,834 [INFO]: 	Compute estimated construction time of the index 03/09/2025, 07:48:12
2025-03-09 07:48:12,834 [INFO]: 		-> Train: 16.7 minutes
2025-03-09 07:48:12,834 [INFO]: 		-> Add: 3.6 seconds
2025-03-09 07:48:12,834 [INFO]: 		Total: 16.7 minutes
2025-03-09 07:48:12,834 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0003 secs
2025-03-09 07:48:12,834 [INFO]: 	Checking that your have enough memory available to create the index 03/09/2025, 07:48:12
2025-03-09 07:48:12,835 [INFO]: 1.3GB of memory will be needed to build the index (more might be used if you have more)
2025-03-09 07:48:12,835 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0004 secs
2025-03-09 07:48:12,835 [INFO]: 	Selecting most promising index types given data characteristics 03/09/2025, 07:48:12
2025-03-09 07:48:12,835 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-09 07:48:12,835 [INFO]: 	Creating the index 03/09/2025, 07:48:12
2025-03-09 07:48:12,835 [INFO]: 		-> Instanciate the index HNSW15 03/09/2025, 07:48:12
2025-03-09 07:48:12,838 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0024 secs
2025-03-09 07:48:12,838 [INFO]: 		-> Adding the vectors to the index 03/09/2025, 07:48:12
2025-03-09 07:48:12,838 [INFO]: The memory available for adding the vectors is 48.8GB(total available - used by the index)
2025-03-09 07:48:12,838 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/27 [00:00<?, ?it/s]  4%|▎         | 1/27 [00:00<00:05,  4.65it/s]  7%|▋         | 2/27 [00:00<00:03,  6.33it/s] 11%|█         | 3/27 [00:00<00:03,  7.09it/s] 15%|█▍        | 4/27 [00:00<00:02,  7.68it/s] 19%|█▊        | 5/27 [00:00<00:02,  7.94it/s] 22%|██▏       | 6/27 [00:00<00:02,  8.13it/s] 26%|██▌       | 7/27 [00:00<00:02,  8.19it/s] 30%|██▉       | 8/27 [00:01<00:02,  8.25it/s] 33%|███▎      | 9/27 [00:01<00:02,  8.41it/s] 37%|███▋      | 10/27 [00:01<00:02,  8.42it/s] 41%|████      | 11/27 [00:01<00:01,  8.25it/s] 44%|████▍     | 12/27 [00:01<00:01,  8.33it/s] 48%|████▊     | 13/27 [00:01<00:01,  8.35it/s] 52%|█████▏    | 14/27 [00:01<00:01,  8.34it/s] 56%|█████▌    | 15/27 [00:01<00:01,  8.40it/s] 59%|█████▉    | 16/27 [00:01<00:01,  8.82it/s] 67%|██████▋   | 18/27 [00:02<00:00,  9.91it/s] 74%|███████▍  | 20/27 [00:02<00:00, 10.66it/s] 81%|████████▏ | 22/27 [00:05<00:03,  1.39it/s] 85%|████████▌ | 23/27 [00:06<00:02,  1.69it/s] 89%|████████▉ | 24/27 [00:06<00:01,  2.08it/s] 93%|█████████▎| 25/27 [00:06<00:00,  2.57it/s] 96%|█████████▋| 26/27 [00:06<00:00,  3.18it/s]100%|██████████| 27/27 [00:08<00:00,  1.11it/s]100%|██████████| 27/27 [00:08<00:00,  3.05it/s]
2025-03-09 07:48:21,689 [INFO]: 	Computing best hyperparameters for index knn.index 03/09/2025, 07:48:21
2025-03-09 07:49:17,662 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 55.9726 secs
2025-03-09 07:49:17,663 [INFO]: The best hyperparameters are: efSearch=192
2025-03-09 07:49:17,663 [INFO]: 	Compute fast metrics 03/09/2025, 07:49:17
  0%|          | 0/4 [00:00<?, ?it/s] 25%|██▌       | 1/4 [00:00<00:00,  6.26it/s] 75%|███████▌  | 3/4 [00:00<00:00, 13.81it/s]
2025-03-09 07:49:35,495 [INFO]: 	>>> Finished "Compute fast metrics" in 17.8319 secs
2025-03-09 07:49:35,496 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 82.6577 secs
2025-03-09 07:49:35,496 [INFO]: {
2025-03-09 07:49:35,496 [INFO]: 	index_key: HNSW15
2025-03-09 07:49:35,496 [INFO]: 	index_param: efSearch=192
2025-03-09 07:49:35,496 [INFO]: 	index_path: knn.index
2025-03-09 07:49:35,496 [INFO]: 	size in bytes: 1286509330
2025-03-09 07:49:35,496 [INFO]: 	avg_search_speed_ms: 9.21320989255875
2025-03-09 07:49:35,496 [INFO]: 	99p_search_speed_ms: 16.35037189349539
2025-03-09 07:49:35,496 [INFO]: 	reconstruction error %: 0.0
2025-03-09 07:49:35,496 [INFO]: 	nb vectors: 6539
2025-03-09 07:49:35,496 [INFO]: 	vectors dimension: 49152
2025-03-09 07:49:35,496 [INFO]: 	compression ratio: 0.9993085024886683
2025-03-09 07:49:35,496 [INFO]: }
2025-03-09 07:49:35,496 [INFO]: 	>>> Finished "Creating the index" in 82.6608 secs
2025-03-09 07:49:35,496 [INFO]: >>> Finished "Launching the whole pipeline" in 82.6959 secs
2025-03-09 07:49:37: [retrieval_preprocessing] calculating distances ...
2025-03-09 07:49:38: [retrieval_preprocessing] finished and saved retrieval indices for episode 6434 [episode count 11/20]
[retrieval_preprocessing] for episode 39715 [episode count 12/20], we have num_retrieval=np.int64(6673) num_query=np.int64(255)
2025-03-09 07:49:40,602 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-09 07:49:41,526 [INFO]: Launching the whole pipeline 03/09/2025, 07:49:41
2025-03-09 07:49:41,527 [INFO]: Reading total number of vectors and dimension 03/09/2025, 07:49:41
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1897.02it/s]
2025-03-09 07:49:41,553 [INFO]: There are 6673 embeddings of dim 49152
2025-03-09 07:49:41,553 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0266 secs
2025-03-09 07:49:41,553 [INFO]: 	Compute estimated construction time of the index 03/09/2025, 07:49:41
2025-03-09 07:49:41,553 [INFO]: 		-> Train: 16.7 minutes
2025-03-09 07:49:41,553 [INFO]: 		-> Add: 3.7 seconds
2025-03-09 07:49:41,553 [INFO]: 		Total: 16.7 minutes
2025-03-09 07:49:41,553 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0001 secs
2025-03-09 07:49:41,553 [INFO]: 	Checking that your have enough memory available to create the index 03/09/2025, 07:49:41
2025-03-09 07:49:41,554 [INFO]: 1.3GB of memory will be needed to build the index (more might be used if you have more)
2025-03-09 07:49:41,554 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0002 secs
2025-03-09 07:49:41,554 [INFO]: 	Selecting most promising index types given data characteristics 03/09/2025, 07:49:41
2025-03-09 07:49:41,554 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-09 07:49:41,554 [INFO]: 	Creating the index 03/09/2025, 07:49:41
2025-03-09 07:49:41,554 [INFO]: 		-> Instanciate the index HNSW15 03/09/2025, 07:49:41
2025-03-09 07:49:41,555 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0011 secs
2025-03-09 07:49:41,555 [INFO]: 		-> Adding the vectors to the index 03/09/2025, 07:49:41
2025-03-09 07:49:41,555 [INFO]: The memory available for adding the vectors is 48.8GB(total available - used by the index)
2025-03-09 07:49:41,555 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/28 [00:00<?, ?it/s]  4%|▎         | 1/28 [00:00<00:05,  4.93it/s] 11%|█         | 3/28 [00:00<00:03,  8.20it/s] 18%|█▊        | 5/28 [00:00<00:02,  9.00it/s] 25%|██▌       | 7/28 [00:00<00:02,  9.14it/s] 29%|██▊       | 8/28 [00:00<00:02,  8.83it/s] 36%|███▌      | 10/28 [00:01<00:01,  9.53it/s] 39%|███▉      | 11/28 [00:01<00:01,  9.40it/s] 43%|████▎     | 12/28 [00:01<00:01,  9.18it/s] 46%|████▋     | 13/28 [00:01<00:01,  8.94it/s] 50%|█████     | 14/28 [00:01<00:01,  9.19it/s] 57%|█████▋    | 16/28 [00:01<00:01, 10.91it/s] 64%|██████▍   | 18/28 [00:01<00:00, 12.78it/s] 71%|███████▏  | 20/28 [00:01<00:00, 14.31it/s] 79%|███████▊  | 22/28 [00:05<00:03,  1.54it/s] 86%|████████▌ | 24/28 [00:05<00:01,  2.12it/s] 93%|█████████▎| 26/28 [00:05<00:00,  2.83it/s]100%|██████████| 28/28 [00:07<00:00,  2.02it/s]100%|██████████| 28/28 [00:07<00:00,  3.72it/s]
2025-03-09 07:49:49,094 [INFO]: 	Computing best hyperparameters for index knn.index 03/09/2025, 07:49:49
2025-03-09 07:50:40,023 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 50.9281 secs
2025-03-09 07:50:40,023 [INFO]: The best hyperparameters are: efSearch=191
2025-03-09 07:50:40,023 [INFO]: 	Compute fast metrics 03/09/2025, 07:50:40
  0%|          | 0/4 [00:00<?, ?it/s] 25%|██▌       | 1/4 [00:00<00:00,  5.54it/s] 50%|█████     | 2/4 [00:00<00:00,  6.99it/s] 75%|███████▌  | 3/4 [00:00<00:00,  7.64it/s] 75%|███████▌  | 3/4 [00:00<00:00,  5.73it/s]
2025-03-09 07:50:57,550 [INFO]: 	>>> Finished "Compute fast metrics" in 17.5271 secs
2025-03-09 07:50:57,552 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 75.9966 secs
2025-03-09 07:50:57,552 [INFO]: {
2025-03-09 07:50:57,552 [INFO]: 	index_key: HNSW15
2025-03-09 07:50:57,552 [INFO]: 	index_param: efSearch=191
2025-03-09 07:50:57,552 [INFO]: 	index_path: knn.index
2025-03-09 07:50:57,552 [INFO]: 	size in bytes: 1312873210
2025-03-09 07:50:57,552 [INFO]: 	avg_search_speed_ms: 8.90321583210931
2025-03-09 07:50:57,552 [INFO]: 	99p_search_speed_ms: 16.480270307511084
2025-03-09 07:50:57,552 [INFO]: 	reconstruction error %: 0.0
2025-03-09 07:50:57,552 [INFO]: 	nb vectors: 6673
2025-03-09 07:50:57,552 [INFO]: 	vectors dimension: 49152
2025-03-09 07:50:57,552 [INFO]: 	compression ratio: 0.999308367332745
2025-03-09 07:50:57,552 [INFO]: }
2025-03-09 07:50:57,552 [INFO]: 	>>> Finished "Creating the index" in 75.9983 secs
2025-03-09 07:50:57,552 [INFO]: >>> Finished "Launching the whole pipeline" in 76.0256 secs
2025-03-09 07:50:58: [retrieval_preprocessing] calculating distances ...
2025-03-09 07:50:59: [retrieval_preprocessing] finished and saved retrieval indices for episode 39715 [episode count 12/20]
[retrieval_preprocessing] for episode 75555 [episode count 13/20], we have num_retrieval=np.int64(6350) num_query=np.int64(578)
2025-03-09 07:51:01,654 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-09 07:51:02,761 [INFO]: Launching the whole pipeline 03/09/2025, 07:51:02
2025-03-09 07:51:02,762 [INFO]: Reading total number of vectors and dimension 03/09/2025, 07:51:02
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1445.81it/s]
2025-03-09 07:51:02,789 [INFO]: There are 6350 embeddings of dim 49152
2025-03-09 07:51:02,790 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0281 secs
2025-03-09 07:51:02,790 [INFO]: 	Compute estimated construction time of the index 03/09/2025, 07:51:02
2025-03-09 07:51:02,790 [INFO]: 		-> Train: 16.7 minutes
2025-03-09 07:51:02,790 [INFO]: 		-> Add: 3.5 seconds
2025-03-09 07:51:02,790 [INFO]: 		Total: 16.7 minutes
2025-03-09 07:51:02,790 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0002 secs
2025-03-09 07:51:02,790 [INFO]: 	Checking that your have enough memory available to create the index 03/09/2025, 07:51:02
2025-03-09 07:51:02,790 [INFO]: 1.3GB of memory will be needed to build the index (more might be used if you have more)
2025-03-09 07:51:02,790 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0002 secs
2025-03-09 07:51:02,790 [INFO]: 	Selecting most promising index types given data characteristics 03/09/2025, 07:51:02
2025-03-09 07:51:02,790 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-09 07:51:02,790 [INFO]: 	Creating the index 03/09/2025, 07:51:02
2025-03-09 07:51:02,790 [INFO]: 		-> Instanciate the index HNSW15 03/09/2025, 07:51:02
2025-03-09 07:51:02,792 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0012 secs
2025-03-09 07:51:02,792 [INFO]: 		-> Adding the vectors to the index 03/09/2025, 07:51:02
2025-03-09 07:51:02,792 [INFO]: The memory available for adding the vectors is 48.8GB(total available - used by the index)
2025-03-09 07:51:02,792 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/26 [00:00<?, ?it/s]  4%|▍         | 1/26 [00:00<00:05,  4.69it/s] 12%|█▏        | 3/26 [00:00<00:03,  7.50it/s] 15%|█▌        | 4/26 [00:00<00:02,  7.85it/s] 19%|█▉        | 5/26 [00:00<00:02,  8.06it/s] 23%|██▎       | 6/26 [00:00<00:02,  8.25it/s] 27%|██▋       | 7/26 [00:00<00:02,  8.34it/s] 31%|███       | 8/26 [00:00<00:02,  8.56it/s] 35%|███▍      | 9/26 [00:01<00:01,  8.56it/s] 38%|███▊      | 10/26 [00:01<00:01,  8.60it/s] 42%|████▏     | 11/26 [00:01<00:01,  8.65it/s] 46%|████▌     | 12/26 [00:01<00:01,  8.67it/s] 50%|█████     | 13/26 [00:01<00:01,  8.76it/s] 58%|█████▊    | 15/26 [00:01<00:01,  9.99it/s] 65%|██████▌   | 17/26 [00:01<00:00, 10.80it/s] 73%|███████▎  | 19/26 [00:02<00:00, 11.38it/s] 81%|████████  | 21/26 [00:05<00:03,  1.62it/s] 88%|████████▊ | 23/26 [00:05<00:01,  2.24it/s] 96%|█████████▌| 25/26 [00:05<00:00,  3.03it/s]100%|██████████| 26/26 [00:07<00:00,  1.64it/s]100%|██████████| 26/26 [00:07<00:00,  3.45it/s]
2025-03-09 07:51:10,328 [INFO]: 	Computing best hyperparameters for index knn.index 03/09/2025, 07:51:10
2025-03-09 07:51:59,110 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 48.7820 secs
2025-03-09 07:51:59,110 [INFO]: The best hyperparameters are: efSearch=248
2025-03-09 07:51:59,110 [INFO]: 	Compute fast metrics 03/09/2025, 07:51:59
  0%|          | 0/4 [00:00<?, ?it/s] 25%|██▌       | 1/4 [00:00<00:00,  5.10it/s] 75%|███████▌  | 3/4 [00:00<00:00,  8.89it/s] 75%|███████▌  | 3/4 [00:00<00:00,  6.86it/s]
2025-03-09 07:52:14,873 [INFO]: 	>>> Finished "Compute fast metrics" in 15.7622 secs
2025-03-09 07:52:14,874 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 72.0822 secs
2025-03-09 07:52:14,874 [INFO]: {
2025-03-09 07:52:14,874 [INFO]: 	index_key: HNSW15
2025-03-09 07:52:14,874 [INFO]: 	index_param: efSearch=248
2025-03-09 07:52:14,874 [INFO]: 	index_path: knn.index
2025-03-09 07:52:14,874 [INFO]: 	size in bytes: 1249324810
2025-03-09 07:52:14,874 [INFO]: 	avg_search_speed_ms: 11.680360371029336
2025-03-09 07:52:14,874 [INFO]: 	99p_search_speed_ms: 23.429057933390148
2025-03-09 07:52:14,874 [INFO]: 	reconstruction error %: 0.0
2025-03-09 07:52:14,874 [INFO]: 	nb vectors: 6350
2025-03-09 07:52:14,874 [INFO]: 	vectors dimension: 49152
2025-03-09 07:52:14,874 [INFO]: 	compression ratio: 0.9993084184408376
2025-03-09 07:52:14,874 [INFO]: }
2025-03-09 07:52:14,874 [INFO]: 	>>> Finished "Creating the index" in 72.0840 secs
2025-03-09 07:52:14,874 [INFO]: >>> Finished "Launching the whole pipeline" in 72.1128 secs
2025-03-09 07:52:19: [retrieval_preprocessing] calculating distances ...
2025-03-09 07:52:21: [retrieval_preprocessing] finished and saved retrieval indices for episode 75555 [episode count 13/20]
[retrieval_preprocessing] for episode 40621 [episode count 14/20], we have num_retrieval=np.int64(6642) num_query=np.int64(286)
2025-03-09 07:52:24,958 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-09 07:52:25,780 [INFO]: Launching the whole pipeline 03/09/2025, 07:52:25
2025-03-09 07:52:25,780 [INFO]: Reading total number of vectors and dimension 03/09/2025, 07:52:25
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1088.86it/s]
2025-03-09 07:52:25,806 [INFO]: There are 6642 embeddings of dim 49152
2025-03-09 07:52:25,806 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0264 secs
2025-03-09 07:52:25,807 [INFO]: 	Compute estimated construction time of the index 03/09/2025, 07:52:25
2025-03-09 07:52:25,807 [INFO]: 		-> Train: 16.7 minutes
2025-03-09 07:52:25,807 [INFO]: 		-> Add: 3.6 seconds
2025-03-09 07:52:25,807 [INFO]: 		Total: 16.7 minutes
2025-03-09 07:52:25,807 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0001 secs
2025-03-09 07:52:25,807 [INFO]: 	Checking that your have enough memory available to create the index 03/09/2025, 07:52:25
2025-03-09 07:52:25,807 [INFO]: 1.3GB of memory will be needed to build the index (more might be used if you have more)
2025-03-09 07:52:25,807 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0003 secs
2025-03-09 07:52:25,807 [INFO]: 	Selecting most promising index types given data characteristics 03/09/2025, 07:52:25
2025-03-09 07:52:25,807 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-09 07:52:25,807 [INFO]: 	Creating the index 03/09/2025, 07:52:25
2025-03-09 07:52:25,807 [INFO]: 		-> Instanciate the index HNSW15 03/09/2025, 07:52:25
2025-03-09 07:52:25,808 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0010 secs
2025-03-09 07:52:25,808 [INFO]: 		-> Adding the vectors to the index 03/09/2025, 07:52:25
2025-03-09 07:52:25,808 [INFO]: The memory available for adding the vectors is 48.8GB(total available - used by the index)
2025-03-09 07:52:25,808 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/28 [00:00<?, ?it/s]  4%|▎         | 1/28 [00:00<00:06,  4.41it/s]  7%|▋         | 2/28 [00:00<00:04,  6.28it/s] 11%|█         | 3/28 [00:00<00:03,  7.17it/s] 14%|█▍        | 4/28 [00:00<00:03,  7.75it/s] 18%|█▊        | 5/28 [00:00<00:02,  8.07it/s] 21%|██▏       | 6/28 [00:00<00:02,  8.30it/s] 25%|██▌       | 7/28 [00:00<00:02,  8.41it/s] 29%|██▊       | 8/28 [00:01<00:02,  8.67it/s] 36%|███▌      | 10/28 [00:01<00:01,  9.79it/s] 43%|████▎     | 12/28 [00:01<00:01,  9.66it/s] 46%|████▋     | 13/28 [00:01<00:01,  9.28it/s] 50%|█████     | 14/28 [00:01<00:01,  9.35it/s] 57%|█████▋    | 16/28 [00:01<00:01, 11.11it/s] 64%|██████▍   | 18/28 [00:01<00:00, 12.23it/s] 71%|███████▏  | 20/28 [00:02<00:00, 11.60it/s] 79%|███████▊  | 22/28 [00:05<00:03,  1.64it/s] 86%|████████▌ | 24/28 [00:05<00:01,  2.26it/s] 93%|█████████▎| 26/28 [00:05<00:00,  3.05it/s]100%|██████████| 28/28 [00:07<00:00,  2.12it/s]100%|██████████| 28/28 [00:07<00:00,  3.81it/s]
2025-03-09 07:52:33,157 [INFO]: 	Computing best hyperparameters for index knn.index 03/09/2025, 07:52:33
2025-03-09 07:53:27,962 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 54.8049 secs
2025-03-09 07:53:27,962 [INFO]: The best hyperparameters are: efSearch=218
2025-03-09 07:53:27,962 [INFO]: 	Compute fast metrics 03/09/2025, 07:53:27
  0%|          | 0/4 [00:00<?, ?it/s] 25%|██▌       | 1/4 [00:00<00:00,  5.74it/s] 50%|█████     | 2/4 [00:00<00:00,  7.14it/s] 75%|███████▌  | 3/4 [00:00<00:00,  7.64it/s] 75%|███████▌  | 3/4 [00:00<00:00,  5.74it/s]
2025-03-09 07:53:45,047 [INFO]: 	>>> Finished "Compute fast metrics" in 17.0849 secs
2025-03-09 07:53:45,049 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 79.2407 secs
2025-03-09 07:53:45,049 [INFO]: {
2025-03-09 07:53:45,049 [INFO]: 	index_key: HNSW15
2025-03-09 07:53:45,049 [INFO]: 	index_param: efSearch=218
2025-03-09 07:53:45,049 [INFO]: 	index_path: knn.index
2025-03-09 07:53:45,049 [INFO]: 	size in bytes: 1306774210
2025-03-09 07:53:45,049 [INFO]: 	avg_search_speed_ms: 9.170844989247756
2025-03-09 07:53:45,049 [INFO]: 	99p_search_speed_ms: 16.025079740211314
2025-03-09 07:53:45,049 [INFO]: 	reconstruction error %: 0.0
2025-03-09 07:53:45,049 [INFO]: 	nb vectors: 6642
2025-03-09 07:53:45,049 [INFO]: 	vectors dimension: 49152
2025-03-09 07:53:45,049 [INFO]: 	compression ratio: 0.9993083166218899
2025-03-09 07:53:45,049 [INFO]: }
2025-03-09 07:53:45,049 [INFO]: 	>>> Finished "Creating the index" in 79.2421 secs
2025-03-09 07:53:45,049 [INFO]: >>> Finished "Launching the whole pipeline" in 79.2692 secs
2025-03-09 07:53:46: [retrieval_preprocessing] calculating distances ...
2025-03-09 07:53:47: [retrieval_preprocessing] finished and saved retrieval indices for episode 40621 [episode count 14/20]
[retrieval_preprocessing] for episode 62256 [episode count 15/20], we have num_retrieval=np.int64(6689) num_query=np.int64(239)
2025-03-09 07:53:49,287 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-09 07:53:50,247 [INFO]: Launching the whole pipeline 03/09/2025, 07:53:50
2025-03-09 07:53:50,247 [INFO]: Reading total number of vectors and dimension 03/09/2025, 07:53:50
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1273.70it/s]
2025-03-09 07:53:50,272 [INFO]: There are 6689 embeddings of dim 49152
2025-03-09 07:53:50,272 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0252 secs
2025-03-09 07:53:50,272 [INFO]: 	Compute estimated construction time of the index 03/09/2025, 07:53:50
2025-03-09 07:53:50,272 [INFO]: 		-> Train: 16.7 minutes
2025-03-09 07:53:50,272 [INFO]: 		-> Add: 3.7 seconds
2025-03-09 07:53:50,272 [INFO]: 		Total: 16.7 minutes
2025-03-09 07:53:50,272 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0001 secs
2025-03-09 07:53:50,272 [INFO]: 	Checking that your have enough memory available to create the index 03/09/2025, 07:53:50
2025-03-09 07:53:50,272 [INFO]: 1.3GB of memory will be needed to build the index (more might be used if you have more)
2025-03-09 07:53:50,272 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0001 secs
2025-03-09 07:53:50,272 [INFO]: 	Selecting most promising index types given data characteristics 03/09/2025, 07:53:50
2025-03-09 07:53:50,272 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-09 07:53:50,273 [INFO]: 	Creating the index 03/09/2025, 07:53:50
2025-03-09 07:53:50,273 [INFO]: 		-> Instanciate the index HNSW15 03/09/2025, 07:53:50
2025-03-09 07:53:50,274 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0010 secs
2025-03-09 07:53:50,274 [INFO]: 		-> Adding the vectors to the index 03/09/2025, 07:53:50
2025-03-09 07:53:50,274 [INFO]: The memory available for adding the vectors is 48.8GB(total available - used by the index)
2025-03-09 07:53:50,274 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/28 [00:00<?, ?it/s]  4%|▎         | 1/28 [00:00<00:05,  4.96it/s]  7%|▋         | 2/28 [00:00<00:03,  7.04it/s] 14%|█▍        | 4/28 [00:00<00:02,  9.09it/s] 18%|█▊        | 5/28 [00:00<00:02,  9.08it/s] 21%|██▏       | 6/28 [00:00<00:02,  8.98it/s] 25%|██▌       | 7/28 [00:00<00:02,  8.82it/s] 29%|██▊       | 8/28 [00:00<00:02,  8.69it/s] 32%|███▏      | 9/28 [00:01<00:02,  8.65it/s] 36%|███▌      | 10/28 [00:01<00:02,  8.58it/s] 39%|███▉      | 11/28 [00:01<00:01,  8.53it/s] 43%|████▎     | 12/28 [00:01<00:01,  8.45it/s] 46%|████▋     | 13/28 [00:01<00:01,  8.44it/s] 50%|█████     | 14/28 [00:01<00:01,  8.48it/s] 54%|█████▎    | 15/28 [00:01<00:01,  8.61it/s] 57%|█████▋    | 16/28 [00:01<00:01,  8.36it/s] 61%|██████    | 17/28 [00:02<00:01,  8.37it/s] 64%|██████▍   | 18/28 [00:02<00:01,  8.39it/s] 68%|██████▊   | 19/28 [00:02<00:01,  8.39it/s] 71%|███████▏  | 20/28 [00:02<00:00,  8.43it/s] 75%|███████▌  | 21/28 [00:06<00:08,  1.23s/it] 79%|███████▊  | 22/28 [00:06<00:05,  1.12it/s] 86%|████████▌ | 24/28 [00:06<00:02,  1.92it/s] 93%|█████████▎| 26/28 [00:06<00:00,  2.87it/s]100%|██████████| 28/28 [00:08<00:00,  1.60it/s]100%|██████████| 28/28 [00:08<00:00,  3.15it/s]
2025-03-09 07:53:59,159 [INFO]: 	Computing best hyperparameters for index knn.index 03/09/2025, 07:53:59
2025-03-09 07:54:49,646 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 50.4870 secs
2025-03-09 07:54:49,647 [INFO]: The best hyperparameters are: efSearch=168
2025-03-09 07:54:49,647 [INFO]: 	Compute fast metrics 03/09/2025, 07:54:49
  0%|          | 0/4 [00:00<?, ?it/s] 25%|██▌       | 1/4 [00:00<00:00,  9.73it/s] 75%|███████▌  | 3/4 [00:00<00:00, 15.33it/s]
2025-03-09 07:55:13,083 [INFO]: 	>>> Finished "Compute fast metrics" in 23.4364 secs
2025-03-09 07:55:13,085 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 82.8109 secs
2025-03-09 07:55:13,085 [INFO]: {
2025-03-09 07:55:13,085 [INFO]: 	index_key: HNSW15
2025-03-09 07:55:13,085 [INFO]: 	index_param: efSearch=168
2025-03-09 07:55:13,085 [INFO]: 	index_path: knn.index
2025-03-09 07:55:13,085 [INFO]: 	size in bytes: 1316021110
2025-03-09 07:55:13,085 [INFO]: 	avg_search_speed_ms: 7.959628723128729
2025-03-09 07:55:13,085 [INFO]: 	99p_search_speed_ms: 16.978401364758614
2025-03-09 07:55:13,085 [INFO]: 	reconstruction error %: 0.0
2025-03-09 07:55:13,085 [INFO]: 	nb vectors: 6689
2025-03-09 07:55:13,085 [INFO]: 	vectors dimension: 49152
2025-03-09 07:55:13,085 [INFO]: 	compression ratio: 0.9993083712768103
2025-03-09 07:55:13,085 [INFO]: }
2025-03-09 07:55:13,085 [INFO]: 	>>> Finished "Creating the index" in 82.8124 secs
2025-03-09 07:55:13,085 [INFO]: >>> Finished "Launching the whole pipeline" in 82.8380 secs
2025-03-09 07:55:13: [retrieval_preprocessing] calculating distances ...
2025-03-09 07:55:14: [retrieval_preprocessing] finished and saved retrieval indices for episode 62256 [episode count 15/20]
[retrieval_preprocessing] for episode 92721 [episode count 16/20], we have num_retrieval=np.int64(6598) num_query=np.int64(330)
2025-03-09 07:55:16,645 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-09 07:55:17,639 [INFO]: Launching the whole pipeline 03/09/2025, 07:55:17
2025-03-09 07:55:17,639 [INFO]: Reading total number of vectors and dimension 03/09/2025, 07:55:17
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1364.89it/s]
2025-03-09 07:55:17,667 [INFO]: There are 6598 embeddings of dim 49152
2025-03-09 07:55:17,668 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0287 secs
2025-03-09 07:55:17,668 [INFO]: 	Compute estimated construction time of the index 03/09/2025, 07:55:17
2025-03-09 07:55:17,668 [INFO]: 		-> Train: 16.7 minutes
2025-03-09 07:55:17,668 [INFO]: 		-> Add: 3.6 seconds
2025-03-09 07:55:17,668 [INFO]: 		Total: 16.7 minutes
2025-03-09 07:55:17,668 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0001 secs
2025-03-09 07:55:17,668 [INFO]: 	Checking that your have enough memory available to create the index 03/09/2025, 07:55:17
2025-03-09 07:55:17,668 [INFO]: 1.3GB of memory will be needed to build the index (more might be used if you have more)
2025-03-09 07:55:17,668 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0002 secs
2025-03-09 07:55:17,668 [INFO]: 	Selecting most promising index types given data characteristics 03/09/2025, 07:55:17
2025-03-09 07:55:17,668 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-09 07:55:17,668 [INFO]: 	Creating the index 03/09/2025, 07:55:17
2025-03-09 07:55:17,668 [INFO]: 		-> Instanciate the index HNSW15 03/09/2025, 07:55:17
2025-03-09 07:55:17,669 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0011 secs
2025-03-09 07:55:17,670 [INFO]: 		-> Adding the vectors to the index 03/09/2025, 07:55:17
2025-03-09 07:55:17,670 [INFO]: The memory available for adding the vectors is 48.8GB(total available - used by the index)
2025-03-09 07:55:17,670 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/27 [00:00<?, ?it/s]  4%|▎         | 1/27 [00:00<00:05,  5.01it/s] 11%|█         | 3/27 [00:00<00:02,  8.75it/s] 19%|█▊        | 5/27 [00:00<00:02, 10.02it/s] 26%|██▌       | 7/27 [00:00<00:01, 10.82it/s] 33%|███▎      | 9/27 [00:00<00:01, 11.15it/s] 41%|████      | 11/27 [00:01<00:01, 11.43it/s] 48%|████▊     | 13/27 [00:01<00:01, 11.66it/s] 56%|█████▌    | 15/27 [00:01<00:01, 11.59it/s] 63%|██████▎   | 17/27 [00:01<00:00, 11.76it/s] 70%|███████   | 19/27 [00:01<00:00, 11.71it/s] 78%|███████▊  | 21/27 [00:05<00:03,  1.69it/s] 81%|████████▏ | 22/27 [00:05<00:02,  1.98it/s] 89%|████████▉ | 24/27 [00:05<00:01,  2.76it/s] 96%|█████████▋| 26/27 [00:05<00:00,  3.68it/s]100%|██████████| 27/27 [00:07<00:00,  3.45it/s]
2025-03-09 07:55:25,501 [INFO]: 	Computing best hyperparameters for index knn.index 03/09/2025, 07:55:25
2025-03-09 07:56:21,107 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 55.6063 secs
2025-03-09 07:56:21,108 [INFO]: The best hyperparameters are: efSearch=209
2025-03-09 07:56:21,108 [INFO]: 	Compute fast metrics 03/09/2025, 07:56:21
  0%|          | 0/4 [00:00<?, ?it/s] 50%|█████     | 2/4 [00:00<00:00, 17.41it/s] 75%|███████▌  | 3/4 [00:00<00:00, 18.52it/s]
2025-03-09 07:56:39,466 [INFO]: 	>>> Finished "Compute fast metrics" in 18.3585 secs
2025-03-09 07:56:39,469 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 81.7990 secs
2025-03-09 07:56:39,469 [INFO]: {
2025-03-09 07:56:39,469 [INFO]: 	index_key: HNSW15
2025-03-09 07:56:39,469 [INFO]: 	index_param: efSearch=209
2025-03-09 07:56:39,469 [INFO]: 	index_path: knn.index
2025-03-09 07:56:39,469 [INFO]: 	size in bytes: 1298117350
2025-03-09 07:56:39,469 [INFO]: 	avg_search_speed_ms: 9.373525046501674
2025-03-09 07:56:39,469 [INFO]: 	99p_search_speed_ms: 19.724664581008245
2025-03-09 07:56:39,469 [INFO]: 	reconstruction error %: 0.0
2025-03-09 07:56:39,469 [INFO]: 	nb vectors: 6598
2025-03-09 07:56:39,469 [INFO]: 	vectors dimension: 49152
2025-03-09 07:56:39,469 [INFO]: 	compression ratio: 0.9993084092127726
2025-03-09 07:56:39,469 [INFO]: }
2025-03-09 07:56:39,469 [INFO]: 	>>> Finished "Creating the index" in 81.8009 secs
2025-03-09 07:56:39,469 [INFO]: >>> Finished "Launching the whole pipeline" in 81.8303 secs
2025-03-09 07:56:40: [retrieval_preprocessing] calculating distances ...
2025-03-09 07:56:42: [retrieval_preprocessing] finished and saved retrieval indices for episode 92721 [episode count 16/20]
[retrieval_preprocessing] for episode 4150 [episode count 17/20], we have num_retrieval=np.int64(6661) num_query=np.int64(267)
2025-03-09 07:56:44,461 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-09 07:56:45,393 [INFO]: Launching the whole pipeline 03/09/2025, 07:56:45
2025-03-09 07:56:45,393 [INFO]: Reading total number of vectors and dimension 03/09/2025, 07:56:45
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1127.50it/s]
2025-03-09 07:56:45,422 [INFO]: There are 6661 embeddings of dim 49152
2025-03-09 07:56:45,422 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0291 secs
2025-03-09 07:56:45,422 [INFO]: 	Compute estimated construction time of the index 03/09/2025, 07:56:45
2025-03-09 07:56:45,422 [INFO]: 		-> Train: 16.7 minutes
2025-03-09 07:56:45,422 [INFO]: 		-> Add: 3.7 seconds
2025-03-09 07:56:45,422 [INFO]: 		Total: 16.7 minutes
2025-03-09 07:56:45,422 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0001 secs
2025-03-09 07:56:45,422 [INFO]: 	Checking that your have enough memory available to create the index 03/09/2025, 07:56:45
2025-03-09 07:56:45,422 [INFO]: 1.3GB of memory will be needed to build the index (more might be used if you have more)
2025-03-09 07:56:45,422 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0001 secs
2025-03-09 07:56:45,422 [INFO]: 	Selecting most promising index types given data characteristics 03/09/2025, 07:56:45
2025-03-09 07:56:45,423 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-09 07:56:45,423 [INFO]: 	Creating the index 03/09/2025, 07:56:45
2025-03-09 07:56:45,423 [INFO]: 		-> Instanciate the index HNSW15 03/09/2025, 07:56:45
2025-03-09 07:56:45,424 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0011 secs
2025-03-09 07:56:45,424 [INFO]: 		-> Adding the vectors to the index 03/09/2025, 07:56:45
2025-03-09 07:56:45,424 [INFO]: The memory available for adding the vectors is 48.8GB(total available - used by the index)
2025-03-09 07:56:45,424 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/28 [00:00<?, ?it/s]  4%|▎         | 1/28 [00:00<00:05,  4.60it/s] 11%|█         | 3/28 [00:00<00:02,  9.28it/s] 18%|█▊        | 5/28 [00:00<00:02, 10.26it/s] 25%|██▌       | 7/28 [00:00<00:01, 10.93it/s] 32%|███▏      | 9/28 [00:00<00:01, 11.57it/s] 39%|███▉      | 11/28 [00:01<00:01, 11.96it/s] 46%|████▋     | 13/28 [00:01<00:01, 12.24it/s] 54%|█████▎    | 15/28 [00:01<00:01, 12.64it/s] 61%|██████    | 17/28 [00:01<00:00, 12.92it/s] 68%|██████▊   | 19/28 [00:01<00:00, 13.00it/s] 75%|███████▌  | 21/28 [00:04<00:03,  1.81it/s] 79%|███████▊  | 22/28 [00:04<00:02,  2.12it/s] 86%|████████▌ | 24/28 [00:05<00:01,  2.91it/s] 93%|█████████▎| 26/28 [00:05<00:00,  3.80it/s]100%|██████████| 28/28 [00:07<00:00,  1.99it/s]100%|██████████| 28/28 [00:07<00:00,  3.80it/s]
2025-03-09 07:56:52,805 [INFO]: 	Computing best hyperparameters for index knn.index 03/09/2025, 07:56:52
2025-03-09 07:57:42,926 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 50.1208 secs
2025-03-09 07:57:42,926 [INFO]: The best hyperparameters are: efSearch=220
2025-03-09 07:57:42,926 [INFO]: 	Compute fast metrics 03/09/2025, 07:57:42
  0%|          | 0/4 [00:00<?, ?it/s] 25%|██▌       | 1/4 [00:00<00:00,  5.55it/s] 50%|█████     | 2/4 [00:00<00:00,  7.00it/s] 75%|███████▌  | 3/4 [00:00<00:00,  7.59it/s] 75%|███████▌  | 3/4 [00:00<00:00,  5.75it/s]
2025-03-09 07:58:04,244 [INFO]: 	>>> Finished "Compute fast metrics" in 21.3177 secs
2025-03-09 07:58:04,245 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 78.8216 secs
2025-03-09 07:58:04,246 [INFO]: {
2025-03-09 07:58:04,246 [INFO]: 	index_key: HNSW15
2025-03-09 07:58:04,246 [INFO]: 	index_param: efSearch=220
2025-03-09 07:58:04,246 [INFO]: 	index_path: knn.index
2025-03-09 07:58:04,246 [INFO]: 	size in bytes: 1310512330
2025-03-09 07:58:04,246 [INFO]: 	avg_search_speed_ms: 8.956639179801334
2025-03-09 07:58:04,246 [INFO]: 	99p_search_speed_ms: 14.316946605686079
2025-03-09 07:58:04,246 [INFO]: 	reconstruction error %: 0.0
2025-03-09 07:58:04,246 [INFO]: 	nb vectors: 6661
2025-03-09 07:58:04,246 [INFO]: 	vectors dimension: 49152
2025-03-09 07:58:04,246 [INFO]: 	compression ratio: 0.9993083300482949
2025-03-09 07:58:04,246 [INFO]: }
2025-03-09 07:58:04,246 [INFO]: 	>>> Finished "Creating the index" in 78.8232 secs
2025-03-09 07:58:04,246 [INFO]: >>> Finished "Launching the whole pipeline" in 78.8528 secs
2025-03-09 07:58:05: [retrieval_preprocessing] calculating distances ...
2025-03-09 07:58:06: [retrieval_preprocessing] finished and saved retrieval indices for episode 4150 [episode count 17/20]
[retrieval_preprocessing] for episode 4409 [episode count 18/20], we have num_retrieval=np.int64(6463) num_query=np.int64(465)
2025-03-09 07:58:08,670 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-09 07:58:09,523 [INFO]: Launching the whole pipeline 03/09/2025, 07:58:09
2025-03-09 07:58:09,523 [INFO]: Reading total number of vectors and dimension 03/09/2025, 07:58:09
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1157.69it/s]
2025-03-09 07:58:09,550 [INFO]: There are 6463 embeddings of dim 49152
2025-03-09 07:58:09,550 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0269 secs
2025-03-09 07:58:09,550 [INFO]: 	Compute estimated construction time of the index 03/09/2025, 07:58:09
2025-03-09 07:58:09,550 [INFO]: 		-> Train: 16.7 minutes
2025-03-09 07:58:09,550 [INFO]: 		-> Add: 3.6 seconds
2025-03-09 07:58:09,550 [INFO]: 		Total: 16.7 minutes
2025-03-09 07:58:09,551 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0001 secs
2025-03-09 07:58:09,551 [INFO]: 	Checking that your have enough memory available to create the index 03/09/2025, 07:58:09
2025-03-09 07:58:09,551 [INFO]: 1.3GB of memory will be needed to build the index (more might be used if you have more)
2025-03-09 07:58:09,551 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0002 secs
2025-03-09 07:58:09,551 [INFO]: 	Selecting most promising index types given data characteristics 03/09/2025, 07:58:09
2025-03-09 07:58:09,551 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-09 07:58:09,551 [INFO]: 	Creating the index 03/09/2025, 07:58:09
2025-03-09 07:58:09,551 [INFO]: 		-> Instanciate the index HNSW15 03/09/2025, 07:58:09
2025-03-09 07:58:09,552 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0011 secs
2025-03-09 07:58:09,552 [INFO]: 		-> Adding the vectors to the index 03/09/2025, 07:58:09
2025-03-09 07:58:09,552 [INFO]: The memory available for adding the vectors is 48.8GB(total available - used by the index)
2025-03-09 07:58:09,552 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/27 [00:00<?, ?it/s]  4%|▎         | 1/27 [00:00<00:04,  5.39it/s] 11%|█         | 3/27 [00:00<00:02,  9.28it/s] 19%|█▊        | 5/27 [00:00<00:02, 10.45it/s] 26%|██▌       | 7/27 [00:00<00:01, 11.08it/s] 33%|███▎      | 9/27 [00:00<00:01, 11.48it/s] 41%|████      | 11/27 [00:01<00:01, 11.76it/s] 48%|████▊     | 13/27 [00:01<00:01, 11.83it/s] 56%|█████▌    | 15/27 [00:01<00:00, 12.01it/s] 63%|██████▎   | 17/27 [00:01<00:00, 12.16it/s] 70%|███████   | 19/27 [00:01<00:00, 12.24it/s] 78%|███████▊  | 21/27 [00:05<00:03,  1.71it/s] 81%|████████▏ | 22/27 [00:05<00:02,  2.00it/s] 89%|████████▉ | 24/27 [00:05<00:01,  2.78it/s] 96%|█████████▋| 26/27 [00:05<00:00,  3.70it/s]100%|██████████| 27/27 [00:07<00:00,  3.53it/s]
2025-03-09 07:58:17,196 [INFO]: 	Computing best hyperparameters for index knn.index 03/09/2025, 07:58:17
2025-03-09 07:59:06,254 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 49.0570 secs
2025-03-09 07:59:06,254 [INFO]: The best hyperparameters are: efSearch=162
2025-03-09 07:59:06,254 [INFO]: 	Compute fast metrics 03/09/2025, 07:59:06
  0%|          | 0/4 [00:00<?, ?it/s] 25%|██▌       | 1/4 [00:00<00:00,  3.67it/s] 50%|█████     | 2/4 [00:00<00:00,  4.91it/s] 75%|███████▌  | 3/4 [00:00<00:00,  6.13it/s] 75%|███████▌  | 3/4 [00:00<00:00,  4.56it/s]
2025-03-09 07:59:26,315 [INFO]: 	>>> Finished "Compute fast metrics" in 20.0611 secs
2025-03-09 07:59:26,317 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 76.7644 secs
2025-03-09 07:59:26,317 [INFO]: {
2025-03-09 07:59:26,317 [INFO]: 	index_key: HNSW15
2025-03-09 07:59:26,317 [INFO]: 	index_param: efSearch=162
2025-03-09 07:59:26,317 [INFO]: 	index_path: knn.index
2025-03-09 07:59:26,317 [INFO]: 	size in bytes: 1271556970
2025-03-09 07:59:26,317 [INFO]: 	avg_search_speed_ms: 8.13267651893823
2025-03-09 07:59:26,317 [INFO]: 	99p_search_speed_ms: 18.506232639774684
2025-03-09 07:59:26,317 [INFO]: 	reconstruction error %: 0.0
2025-03-09 07:59:26,317 [INFO]: 	nb vectors: 6463
2025-03-09 07:59:26,317 [INFO]: 	vectors dimension: 49152
2025-03-09 07:59:26,317 [INFO]: 	compression ratio: 0.9993083550161342
2025-03-09 07:59:26,317 [INFO]: }
2025-03-09 07:59:26,317 [INFO]: 	>>> Finished "Creating the index" in 76.7660 secs
2025-03-09 07:59:26,317 [INFO]: >>> Finished "Launching the whole pipeline" in 76.7936 secs
2025-03-09 07:59:27: [retrieval_preprocessing] calculating distances ...
2025-03-09 07:59:29: [retrieval_preprocessing] finished and saved retrieval indices for episode 4409 [episode count 18/20]
[retrieval_preprocessing] for episode 39098 [episode count 19/20], we have num_retrieval=np.int64(6425) num_query=np.int64(503)
2025-03-09 07:59:31,265 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-09 07:59:32,293 [INFO]: Launching the whole pipeline 03/09/2025, 07:59:32
2025-03-09 07:59:32,293 [INFO]: Reading total number of vectors and dimension 03/09/2025, 07:59:32
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1110.49it/s]
2025-03-09 07:59:32,320 [INFO]: There are 6425 embeddings of dim 49152
2025-03-09 07:59:32,320 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0277 secs
2025-03-09 07:59:32,320 [INFO]: 	Compute estimated construction time of the index 03/09/2025, 07:59:32
2025-03-09 07:59:32,321 [INFO]: 		-> Train: 16.7 minutes
2025-03-09 07:59:32,321 [INFO]: 		-> Add: 3.5 seconds
2025-03-09 07:59:32,321 [INFO]: 		Total: 16.7 minutes
2025-03-09 07:59:32,321 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0001 secs
2025-03-09 07:59:32,321 [INFO]: 	Checking that your have enough memory available to create the index 03/09/2025, 07:59:32
2025-03-09 07:59:32,321 [INFO]: 1.3GB of memory will be needed to build the index (more might be used if you have more)
2025-03-09 07:59:32,321 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0002 secs
2025-03-09 07:59:32,321 [INFO]: 	Selecting most promising index types given data characteristics 03/09/2025, 07:59:32
2025-03-09 07:59:32,321 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-09 07:59:32,321 [INFO]: 	Creating the index 03/09/2025, 07:59:32
2025-03-09 07:59:32,321 [INFO]: 		-> Instanciate the index HNSW15 03/09/2025, 07:59:32
2025-03-09 07:59:32,322 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0011 secs
2025-03-09 07:59:32,322 [INFO]: 		-> Adding the vectors to the index 03/09/2025, 07:59:32
2025-03-09 07:59:32,322 [INFO]: The memory available for adding the vectors is 48.8GB(total available - used by the index)
2025-03-09 07:59:32,322 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/27 [00:00<?, ?it/s]  4%|▎         | 1/27 [00:00<00:06,  4.07it/s]  7%|▋         | 2/27 [00:00<00:04,  6.21it/s] 11%|█         | 3/27 [00:00<00:03,  6.97it/s] 15%|█▍        | 4/27 [00:00<00:03,  7.30it/s] 22%|██▏       | 6/27 [00:00<00:02,  8.81it/s] 30%|██▉       | 8/27 [00:00<00:01, 10.02it/s] 37%|███▋      | 10/27 [00:01<00:01,  9.67it/s] 41%|████      | 11/27 [00:01<00:01,  9.49it/s] 44%|████▍     | 12/27 [00:01<00:01,  9.25it/s] 48%|████▊     | 13/27 [00:01<00:01,  9.07it/s] 52%|█████▏    | 14/27 [00:01<00:01,  8.99it/s] 59%|█████▉    | 16/27 [00:01<00:01, 10.19it/s] 67%|██████▋   | 18/27 [00:01<00:00, 10.80it/s] 74%|███████▍  | 20/27 [00:02<00:00, 11.07it/s] 81%|████████▏ | 22/27 [00:06<00:03,  1.34it/s] 89%|████████▉ | 24/27 [00:06<00:01,  1.89it/s] 96%|█████████▋| 26/27 [00:06<00:00,  2.57it/s]100%|██████████| 27/27 [00:08<00:00,  3.02it/s]
2025-03-09 07:59:41,278 [INFO]: 	Computing best hyperparameters for index knn.index 03/09/2025, 07:59:41
2025-03-09 08:00:38,065 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 56.7874 secs
2025-03-09 08:00:38,066 [INFO]: The best hyperparameters are: efSearch=158
2025-03-09 08:00:38,066 [INFO]: 	Compute fast metrics 03/09/2025, 08:00:38
  0%|          | 0/4 [00:00<?, ?it/s] 25%|██▌       | 1/4 [00:00<00:00,  6.60it/s] 50%|█████     | 2/4 [00:00<00:00,  7.94it/s] 75%|███████▌  | 3/4 [00:00<00:00,  6.54it/s]
2025-03-09 08:00:57,977 [INFO]: 	>>> Finished "Compute fast metrics" in 19.9112 secs
2025-03-09 08:00:57,978 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 85.6560 secs
2025-03-09 08:00:57,978 [INFO]: {
2025-03-09 08:00:57,978 [INFO]: 	index_key: HNSW15
2025-03-09 08:00:57,979 [INFO]: 	index_param: efSearch=158
2025-03-09 08:00:57,979 [INFO]: 	index_path: knn.index
2025-03-09 08:00:57,979 [INFO]: 	size in bytes: 1264080610
2025-03-09 08:00:57,979 [INFO]: 	avg_search_speed_ms: 7.522938354851845
2025-03-09 08:00:57,979 [INFO]: 	99p_search_speed_ms: 15.048270802944902
2025-03-09 08:00:57,979 [INFO]: 	reconstruction error %: 0.0
2025-03-09 08:00:57,979 [INFO]: 	nb vectors: 6425
2025-03-09 08:00:57,979 [INFO]: 	vectors dimension: 49152
2025-03-09 08:00:57,979 [INFO]: 	compression ratio: 0.9993084222690514
2025-03-09 08:00:57,979 [INFO]: }
2025-03-09 08:00:57,979 [INFO]: 	>>> Finished "Creating the index" in 85.6576 secs
2025-03-09 08:00:57,979 [INFO]: >>> Finished "Launching the whole pipeline" in 85.6860 secs
2025-03-09 08:00:59: [retrieval_preprocessing] calculating distances ...
2025-03-09 08:01:01: [retrieval_preprocessing] finished and saved retrieval indices for episode 39098 [episode count 19/20]
2025-03-09 08:01:01: [retrieval_preprocessing] finished for (6655265581, 'cup') [chosen_id count 2/10]
2025-03-09 08:01:03: [retrieval_preprocessing] concatenated all embeddings and indices for 20 episodes for (4345518188, 'cloth') [chosen_id count 3/10]
2025-03-09 08:01:03: [retrieval_preprocessing] we have num_total=4031 embedding_dim=49152
[retrieval_preprocessing] for episode 3585 [episode count 0/20], we have num_retrieval=np.int64(3774) num_query=np.int64(257)
2025-03-09 08:01:04,754 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-09 08:01:05,399 [INFO]: Launching the whole pipeline 03/09/2025, 08:01:05
2025-03-09 08:01:05,399 [INFO]: Reading total number of vectors and dimension 03/09/2025, 08:01:05
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1377.89it/s]
2025-03-09 08:01:05,427 [INFO]: There are 3774 embeddings of dim 49152
2025-03-09 08:01:05,428 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0287 secs
2025-03-09 08:01:05,428 [INFO]: 	Compute estimated construction time of the index 03/09/2025, 08:01:05
2025-03-09 08:01:05,428 [INFO]: 		-> Train: 16.7 minutes
2025-03-09 08:01:05,428 [INFO]: 		-> Add: 2.1 seconds
2025-03-09 08:01:05,428 [INFO]: 		Total: 16.7 minutes
2025-03-09 08:01:05,428 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0001 secs
2025-03-09 08:01:05,428 [INFO]: 	Checking that your have enough memory available to create the index 03/09/2025, 08:01:05
2025-03-09 08:01:05,428 [INFO]: 778.9MB of memory will be needed to build the index (more might be used if you have more)
2025-03-09 08:01:05,428 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0002 secs
2025-03-09 08:01:05,428 [INFO]: 	Selecting most promising index types given data characteristics 03/09/2025, 08:01:05
2025-03-09 08:01:05,428 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-09 08:01:05,428 [INFO]: 	Creating the index 03/09/2025, 08:01:05
2025-03-09 08:01:05,428 [INFO]: 		-> Instanciate the index HNSW15 03/09/2025, 08:01:05
2025-03-09 08:01:05,429 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0010 secs
2025-03-09 08:01:05,430 [INFO]: 		-> Adding the vectors to the index 03/09/2025, 08:01:05
2025-03-09 08:01:05,430 [INFO]: The memory available for adding the vectors is 49.3GB(total available - used by the index)
2025-03-09 08:01:05,430 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/15 [00:00<?, ?it/s]  7%|▋         | 1/15 [00:00<00:02,  5.00it/s] 20%|██        | 3/15 [00:00<00:01,  8.02it/s] 27%|██▋       | 4/15 [00:00<00:01,  8.39it/s] 33%|███▎      | 5/15 [00:00<00:01,  8.78it/s] 40%|████      | 6/15 [00:00<00:01,  8.74it/s] 47%|████▋     | 7/15 [00:00<00:00,  8.80it/s] 60%|██████    | 9/15 [00:01<00:00,  9.18it/s] 67%|██████▋   | 10/15 [00:01<00:00,  9.18it/s] 73%|███████▎  | 11/15 [00:01<00:00,  9.08it/s] 87%|████████▋ | 13/15 [00:01<00:00,  9.72it/s] 93%|█████████▎| 14/15 [00:01<00:00,  9.68it/s]100%|██████████| 15/15 [00:04<00:00,  1.22it/s]100%|██████████| 15/15 [00:04<00:00,  3.33it/s]
2025-03-09 08:01:09,940 [INFO]: 	Computing best hyperparameters for index knn.index 03/09/2025, 08:01:09
2025-03-09 08:01:47,023 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 37.0834 secs
2025-03-09 08:01:47,024 [INFO]: The best hyperparameters are: efSearch=177
2025-03-09 08:01:47,024 [INFO]: 	Compute fast metrics 03/09/2025, 08:01:47
  0%|          | 0/4 [00:00<?, ?it/s] 25%|██▌       | 1/4 [00:00<00:00,  5.97it/s] 75%|███████▌  | 3/4 [00:00<00:00,  9.02it/s] 75%|███████▌  | 3/4 [00:00<00:00,  6.94it/s]
2025-03-09 08:02:01,878 [INFO]: 	>>> Finished "Compute fast metrics" in 14.8542 secs
2025-03-09 08:02:01,881 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 56.4510 secs
2025-03-09 08:02:01,881 [INFO]: {
2025-03-09 08:02:01,881 [INFO]: 	index_key: HNSW15
2025-03-09 08:02:01,881 [INFO]: 	index_param: efSearch=177
2025-03-09 08:02:01,881 [INFO]: 	index_path: knn.index
2025-03-09 08:02:01,881 [INFO]: 	size in bytes: 742511530
2025-03-09 08:02:01,881 [INFO]: 	avg_search_speed_ms: 10.424324142823348
2025-03-09 08:02:01,881 [INFO]: 	99p_search_speed_ms: 20.498632271774113
2025-03-09 08:02:01,881 [INFO]: 	reconstruction error %: 0.0
2025-03-09 08:02:01,881 [INFO]: 	nb vectors: 3774
2025-03-09 08:02:01,881 [INFO]: 	vectors dimension: 49152
2025-03-09 08:02:01,881 [INFO]: 	compression ratio: 0.9993091851381756
2025-03-09 08:02:01,881 [INFO]: }
2025-03-09 08:02:01,881 [INFO]: 	>>> Finished "Creating the index" in 56.4526 secs
2025-03-09 08:02:01,881 [INFO]: >>> Finished "Launching the whole pipeline" in 56.4820 secs
2025-03-09 08:02:03: [retrieval_preprocessing] calculating distances ...
2025-03-09 08:02:04: [retrieval_preprocessing] finished and saved retrieval indices for episode 3585 [episode count 0/20]
[retrieval_preprocessing] for episode 52745 [episode count 1/20], we have num_retrieval=np.int64(3865) num_query=np.int64(166)
2025-03-09 08:02:05,299 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-09 08:02:05,907 [INFO]: Launching the whole pipeline 03/09/2025, 08:02:05
2025-03-09 08:02:05,907 [INFO]: Reading total number of vectors and dimension 03/09/2025, 08:02:05
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 963.10it/s]
2025-03-09 08:02:05,935 [INFO]: There are 3865 embeddings of dim 49152
2025-03-09 08:02:05,936 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0280 secs
2025-03-09 08:02:05,936 [INFO]: 	Compute estimated construction time of the index 03/09/2025, 08:02:05
2025-03-09 08:02:05,936 [INFO]: 		-> Train: 16.7 minutes
2025-03-09 08:02:05,936 [INFO]: 		-> Add: 2.1 seconds
2025-03-09 08:02:05,936 [INFO]: 		Total: 16.7 minutes
2025-03-09 08:02:05,936 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0001 secs
2025-03-09 08:02:05,936 [INFO]: 	Checking that your have enough memory available to create the index 03/09/2025, 08:02:05
2025-03-09 08:02:05,936 [INFO]: 797.6MB of memory will be needed to build the index (more might be used if you have more)
2025-03-09 08:02:05,936 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0002 secs
2025-03-09 08:02:05,936 [INFO]: 	Selecting most promising index types given data characteristics 03/09/2025, 08:02:05
2025-03-09 08:02:05,936 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-09 08:02:05,936 [INFO]: 	Creating the index 03/09/2025, 08:02:05
2025-03-09 08:02:05,936 [INFO]: 		-> Instanciate the index HNSW15 03/09/2025, 08:02:05
2025-03-09 08:02:05,937 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0012 secs
2025-03-09 08:02:05,938 [INFO]: 		-> Adding the vectors to the index 03/09/2025, 08:02:05
2025-03-09 08:02:05,938 [INFO]: The memory available for adding the vectors is 49.3GB(total available - used by the index)
2025-03-09 08:02:05,938 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/16 [00:00<?, ?it/s]  6%|▋         | 1/16 [00:00<00:02,  5.69it/s] 19%|█▉        | 3/16 [00:00<00:01,  9.15it/s] 31%|███▏      | 5/16 [00:00<00:01,  9.96it/s] 44%|████▍     | 7/16 [00:00<00:00, 10.28it/s] 56%|█████▋    | 9/16 [00:00<00:00, 10.67it/s] 69%|██████▉   | 11/16 [00:01<00:00, 10.79it/s] 81%|████████▏ | 13/16 [00:01<00:00, 11.06it/s] 94%|█████████▍| 15/16 [00:01<00:00, 11.32it/s]100%|██████████| 16/16 [00:05<00:00,  3.03it/s]
2025-03-09 08:02:11,216 [INFO]: 	Computing best hyperparameters for index knn.index 03/09/2025, 08:02:11
2025-03-09 08:02:57,452 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 46.2355 secs
2025-03-09 08:02:57,452 [INFO]: The best hyperparameters are: efSearch=157
2025-03-09 08:02:57,452 [INFO]: 	Compute fast metrics 03/09/2025, 08:02:57
  0%|          | 0/4 [00:00<?, ?it/s] 25%|██▌       | 1/4 [00:00<00:00,  5.71it/s] 75%|███████▌  | 3/4 [00:00<00:00,  9.07it/s] 75%|███████▌  | 3/4 [00:00<00:00,  7.01it/s]
2025-03-09 08:03:15,308 [INFO]: 	>>> Finished "Compute fast metrics" in 17.8561 secs
2025-03-09 08:03:15,311 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 69.3734 secs
2025-03-09 08:03:15,311 [INFO]: {
2025-03-09 08:03:15,311 [INFO]: 	index_key: HNSW15
2025-03-09 08:03:15,311 [INFO]: 	index_param: efSearch=157
2025-03-09 08:03:15,311 [INFO]: 	index_path: knn.index
2025-03-09 08:03:15,311 [INFO]: 	size in bytes: 760415470
2025-03-09 08:03:15,311 [INFO]: 	avg_search_speed_ms: 9.590315420228777
2025-03-09 08:03:15,311 [INFO]: 	99p_search_speed_ms: 18.400036022067066
2025-03-09 08:03:15,311 [INFO]: 	reconstruction error %: 0.0
2025-03-09 08:03:15,311 [INFO]: 	nb vectors: 3865
2025-03-09 08:03:15,311 [INFO]: 	vectors dimension: 49152
2025-03-09 08:03:15,311 [INFO]: 	compression ratio: 0.999308864665786
2025-03-09 08:03:15,311 [INFO]: }
2025-03-09 08:03:15,311 [INFO]: 	>>> Finished "Creating the index" in 69.3752 secs
2025-03-09 08:03:15,311 [INFO]: >>> Finished "Launching the whole pipeline" in 69.4039 secs
2025-03-09 08:03:15: [retrieval_preprocessing] calculating distances ...
2025-03-09 08:03:16: [retrieval_preprocessing] finished and saved retrieval indices for episode 52745 [episode count 1/20]
[retrieval_preprocessing] for episode 65034 [episode count 2/20], we have num_retrieval=np.int64(3808) num_query=np.int64(223)
2025-03-09 08:03:17,833 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-09 08:03:18,434 [INFO]: Launching the whole pipeline 03/09/2025, 08:03:18
2025-03-09 08:03:18,434 [INFO]: Reading total number of vectors and dimension 03/09/2025, 08:03:18
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1141.31it/s]
2025-03-09 08:03:18,462 [INFO]: There are 3808 embeddings of dim 49152
2025-03-09 08:03:18,462 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0275 secs
2025-03-09 08:03:18,462 [INFO]: 	Compute estimated construction time of the index 03/09/2025, 08:03:18
2025-03-09 08:03:18,462 [INFO]: 		-> Train: 16.7 minutes
2025-03-09 08:03:18,462 [INFO]: 		-> Add: 2.1 seconds
2025-03-09 08:03:18,462 [INFO]: 		Total: 16.7 minutes
2025-03-09 08:03:18,462 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0001 secs
2025-03-09 08:03:18,462 [INFO]: 	Checking that your have enough memory available to create the index 03/09/2025, 08:03:18
2025-03-09 08:03:18,462 [INFO]: 785.9MB of memory will be needed to build the index (more might be used if you have more)
2025-03-09 08:03:18,462 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0002 secs
2025-03-09 08:03:18,462 [INFO]: 	Selecting most promising index types given data characteristics 03/09/2025, 08:03:18
2025-03-09 08:03:18,462 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-09 08:03:18,462 [INFO]: 	Creating the index 03/09/2025, 08:03:18
2025-03-09 08:03:18,463 [INFO]: 		-> Instanciate the index HNSW15 03/09/2025, 08:03:18
2025-03-09 08:03:18,464 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0011 secs
2025-03-09 08:03:18,464 [INFO]: 		-> Adding the vectors to the index 03/09/2025, 08:03:18
2025-03-09 08:03:18,464 [INFO]: The memory available for adding the vectors is 49.3GB(total available - used by the index)
2025-03-09 08:03:18,464 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/15 [00:00<?, ?it/s]  7%|▋         | 1/15 [00:00<00:03,  4.26it/s] 20%|██        | 3/15 [00:00<00:01,  7.77it/s] 33%|███▎      | 5/15 [00:00<00:01,  9.90it/s] 47%|████▋     | 7/15 [00:00<00:00, 10.49it/s] 60%|██████    | 9/15 [00:00<00:00, 10.75it/s] 73%|███████▎  | 11/15 [00:01<00:00, 10.85it/s] 87%|████████▋ | 13/15 [00:01<00:00, 12.41it/s]100%|██████████| 15/15 [00:04<00:00,  1.77it/s]100%|██████████| 15/15 [00:04<00:00,  3.42it/s]
2025-03-09 08:03:22,855 [INFO]: 	Computing best hyperparameters for index knn.index 03/09/2025, 08:03:22
2025-03-09 08:04:03,411 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 40.5552 secs
2025-03-09 08:04:03,411 [INFO]: The best hyperparameters are: efSearch=177
2025-03-09 08:04:03,411 [INFO]: 	Compute fast metrics 03/09/2025, 08:04:03
  0%|          | 0/4 [00:00<?, ?it/s] 25%|██▌       | 1/4 [00:00<00:00,  3.97it/s] 50%|█████     | 2/4 [00:00<00:00,  5.47it/s] 75%|███████▌  | 3/4 [00:00<00:00,  6.53it/s] 75%|███████▌  | 3/4 [00:00<00:00,  4.90it/s]
2025-03-09 08:04:22,332 [INFO]: 	>>> Finished "Compute fast metrics" in 18.9205 secs
2025-03-09 08:04:22,335 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 63.8708 secs
2025-03-09 08:04:22,335 [INFO]: {
2025-03-09 08:04:22,335 [INFO]: 	index_key: HNSW15
2025-03-09 08:04:22,335 [INFO]: 	index_param: efSearch=177
2025-03-09 08:04:22,335 [INFO]: 	index_path: knn.index
2025-03-09 08:04:22,335 [INFO]: 	size in bytes: 749200930
2025-03-09 08:04:22,335 [INFO]: 	avg_search_speed_ms: 10.12366388661425
2025-03-09 08:04:22,335 [INFO]: 	99p_search_speed_ms: 14.254355812445283
2025-03-09 08:04:22,335 [INFO]: 	reconstruction error %: 0.0
2025-03-09 08:04:22,335 [INFO]: 	nb vectors: 3808
2025-03-09 08:04:22,335 [INFO]: 	vectors dimension: 49152
2025-03-09 08:04:22,335 [INFO]: 	compression ratio: 0.9993090425021229
2025-03-09 08:04:22,335 [INFO]: }
2025-03-09 08:04:22,335 [INFO]: 	>>> Finished "Creating the index" in 63.8728 secs
2025-03-09 08:04:22,335 [INFO]: >>> Finished "Launching the whole pipeline" in 63.9009 secs
2025-03-09 08:04:23: [retrieval_preprocessing] calculating distances ...
2025-03-09 08:04:24: [retrieval_preprocessing] finished and saved retrieval indices for episode 65034 [episode count 2/20]
[retrieval_preprocessing] for episode 30230 [episode count 3/20], we have num_retrieval=np.int64(3902) num_query=np.int64(129)
2025-03-09 08:04:25,774 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-09 08:04:26,396 [INFO]: Launching the whole pipeline 03/09/2025, 08:04:26
2025-03-09 08:04:26,396 [INFO]: Reading total number of vectors and dimension 03/09/2025, 08:04:26
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1358.26it/s]
2025-03-09 08:04:26,424 [INFO]: There are 3902 embeddings of dim 49152
2025-03-09 08:04:26,424 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0278 secs
2025-03-09 08:04:26,424 [INFO]: 	Compute estimated construction time of the index 03/09/2025, 08:04:26
2025-03-09 08:04:26,424 [INFO]: 		-> Train: 16.7 minutes
2025-03-09 08:04:26,424 [INFO]: 		-> Add: 2.1 seconds
2025-03-09 08:04:26,424 [INFO]: 		Total: 16.7 minutes
2025-03-09 08:04:26,424 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0001 secs
2025-03-09 08:04:26,424 [INFO]: 	Checking that your have enough memory available to create the index 03/09/2025, 08:04:26
2025-03-09 08:04:26,424 [INFO]: 805.3MB of memory will be needed to build the index (more might be used if you have more)
2025-03-09 08:04:26,424 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0002 secs
2025-03-09 08:04:26,425 [INFO]: 	Selecting most promising index types given data characteristics 03/09/2025, 08:04:26
2025-03-09 08:04:26,425 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-09 08:04:26,425 [INFO]: 	Creating the index 03/09/2025, 08:04:26
2025-03-09 08:04:26,425 [INFO]: 		-> Instanciate the index HNSW15 03/09/2025, 08:04:26
2025-03-09 08:04:26,426 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0012 secs
2025-03-09 08:04:26,426 [INFO]: 		-> Adding the vectors to the index 03/09/2025, 08:04:26
2025-03-09 08:04:26,426 [INFO]: The memory available for adding the vectors is 49.3GB(total available - used by the index)
2025-03-09 08:04:26,426 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/16 [00:00<?, ?it/s]  6%|▋         | 1/16 [00:00<00:02,  5.72it/s] 19%|█▉        | 3/16 [00:00<00:01,  9.10it/s] 31%|███▏      | 5/16 [00:00<00:01, 10.12it/s] 44%|████▍     | 7/16 [00:00<00:00, 11.00it/s] 56%|█████▋    | 9/16 [00:00<00:00, 11.47it/s] 69%|██████▉   | 11/16 [00:01<00:00, 11.82it/s] 81%|████████▏ | 13/16 [00:01<00:00, 12.15it/s] 94%|█████████▍| 15/16 [00:01<00:00, 11.67it/s]100%|██████████| 16/16 [00:04<00:00,  3.71it/s]
2025-03-09 08:04:30,745 [INFO]: 	Computing best hyperparameters for index knn.index 03/09/2025, 08:04:30
2025-03-09 08:05:10,060 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 39.3154 secs
2025-03-09 08:05:10,060 [INFO]: The best hyperparameters are: efSearch=183
2025-03-09 08:05:10,061 [INFO]: 	Compute fast metrics 03/09/2025, 08:05:10
  0%|          | 0/4 [00:00<?, ?it/s] 25%|██▌       | 1/4 [00:00<00:00,  4.73it/s] 50%|█████     | 2/4 [00:00<00:00,  6.50it/s] 75%|███████▌  | 3/4 [00:00<00:00,  6.28it/s]
2025-03-09 08:05:27,647 [INFO]: 	>>> Finished "Compute fast metrics" in 17.5859 secs
2025-03-09 08:05:27,654 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 61.2278 secs
2025-03-09 08:05:27,654 [INFO]: {
2025-03-09 08:05:27,654 [INFO]: 	index_key: HNSW15
2025-03-09 08:05:27,654 [INFO]: 	index_param: efSearch=183
2025-03-09 08:05:27,654 [INFO]: 	index_path: knn.index
2025-03-09 08:05:27,654 [INFO]: 	size in bytes: 767695030
2025-03-09 08:05:27,654 [INFO]: 	avg_search_speed_ms: 9.298838966114577
2025-03-09 08:05:27,654 [INFO]: 	99p_search_speed_ms: 14.227561047300695
2025-03-09 08:05:27,654 [INFO]: 	reconstruction error %: 0.0
2025-03-09 08:05:27,654 [INFO]: 	nb vectors: 3902
2025-03-09 08:05:27,654 [INFO]: 	vectors dimension: 49152
2025-03-09 08:05:27,654 [INFO]: 	compression ratio: 0.999308821889859
2025-03-09 08:05:27,654 [INFO]: }
2025-03-09 08:05:27,654 [INFO]: 	>>> Finished "Creating the index" in 61.2295 secs
2025-03-09 08:05:27,654 [INFO]: >>> Finished "Launching the whole pipeline" in 61.2580 secs
2025-03-09 08:05:28: [retrieval_preprocessing] calculating distances ...
2025-03-09 08:05:28: [retrieval_preprocessing] finished and saved retrieval indices for episode 30230 [episode count 3/20]
[retrieval_preprocessing] for episode 71712 [episode count 4/20], we have num_retrieval=np.int64(3524) num_query=np.int64(507)
2025-03-09 08:05:29,810 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-09 08:05:30,324 [INFO]: Launching the whole pipeline 03/09/2025, 08:05:30
2025-03-09 08:05:30,324 [INFO]: Reading total number of vectors and dimension 03/09/2025, 08:05:30
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1415.56it/s]
2025-03-09 08:05:30,353 [INFO]: There are 3524 embeddings of dim 49152
2025-03-09 08:05:30,353 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0292 secs
2025-03-09 08:05:30,353 [INFO]: 	Compute estimated construction time of the index 03/09/2025, 08:05:30
2025-03-09 08:05:30,354 [INFO]: 		-> Train: 16.7 minutes
2025-03-09 08:05:30,354 [INFO]: 		-> Add: 1.9 seconds
2025-03-09 08:05:30,354 [INFO]: 		Total: 16.7 minutes
2025-03-09 08:05:30,354 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0003 secs
2025-03-09 08:05:30,354 [INFO]: 	Checking that your have enough memory available to create the index 03/09/2025, 08:05:30
2025-03-09 08:05:30,354 [INFO]: 727.3MB of memory will be needed to build the index (more might be used if you have more)
2025-03-09 08:05:30,354 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0004 secs
2025-03-09 08:05:30,354 [INFO]: 	Selecting most promising index types given data characteristics 03/09/2025, 08:05:30
2025-03-09 08:05:30,355 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-09 08:05:30,355 [INFO]: 	Creating the index 03/09/2025, 08:05:30
2025-03-09 08:05:30,355 [INFO]: 		-> Instanciate the index HNSW15 03/09/2025, 08:05:30
2025-03-09 08:05:30,358 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0030 secs
2025-03-09 08:05:30,358 [INFO]: 		-> Adding the vectors to the index 03/09/2025, 08:05:30
2025-03-09 08:05:30,358 [INFO]: The memory available for adding the vectors is 49.4GB(total available - used by the index)
2025-03-09 08:05:30,359 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/14 [00:00<?, ?it/s]  7%|▋         | 1/14 [00:00<00:01,  6.65it/s] 21%|██▏       | 3/14 [00:00<00:01, 10.26it/s] 36%|███▌      | 5/14 [00:00<00:00, 11.24it/s] 50%|█████     | 7/14 [00:00<00:00, 11.76it/s] 64%|██████▍   | 9/14 [00:00<00:00, 12.02it/s] 79%|███████▊  | 11/14 [00:00<00:00, 12.18it/s] 93%|█████████▎| 13/14 [00:01<00:00, 12.32it/s]100%|██████████| 14/14 [00:04<00:00,  3.19it/s]
2025-03-09 08:05:34,753 [INFO]: 	Computing best hyperparameters for index knn.index 03/09/2025, 08:05:34
2025-03-09 08:06:12,478 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 37.7249 secs
2025-03-09 08:06:12,478 [INFO]: The best hyperparameters are: efSearch=194
2025-03-09 08:06:12,478 [INFO]: 	Compute fast metrics 03/09/2025, 08:06:12
  0%|          | 0/4 [00:00<?, ?it/s] 25%|██▌       | 1/4 [00:00<00:00,  5.92it/s] 75%|███████▌  | 3/4 [00:00<00:00,  9.31it/s] 75%|███████▌  | 3/4 [00:00<00:00,  7.11it/s]
2025-03-09 08:06:31,385 [INFO]: 	>>> Finished "Compute fast metrics" in 18.9067 secs
2025-03-09 08:06:31,388 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 61.0296 secs
2025-03-09 08:06:31,388 [INFO]: {
2025-03-09 08:06:31,388 [INFO]: 	index_key: HNSW15
2025-03-09 08:06:31,388 [INFO]: 	index_param: efSearch=194
2025-03-09 08:06:31,388 [INFO]: 	index_path: knn.index
2025-03-09 08:06:31,388 [INFO]: 	size in bytes: 693325270
2025-03-09 08:06:31,388 [INFO]: 	avg_search_speed_ms: 9.71797005436157
2025-03-09 08:06:31,388 [INFO]: 	99p_search_speed_ms: 18.097653011791408
2025-03-09 08:06:31,388 [INFO]: 	reconstruction error %: 0.0
2025-03-09 08:06:31,388 [INFO]: 	nb vectors: 3524
2025-03-09 08:06:31,388 [INFO]: 	vectors dimension: 49152
2025-03-09 08:06:31,388 [INFO]: 	compression ratio: 0.9993095910091377
2025-03-09 08:06:31,388 [INFO]: }
2025-03-09 08:06:31,388 [INFO]: 	>>> Finished "Creating the index" in 61.0335 secs
2025-03-09 08:06:31,388 [INFO]: >>> Finished "Launching the whole pipeline" in 61.0644 secs
2025-03-09 08:06:33: [retrieval_preprocessing] calculating distances ...
2025-03-09 08:06:35: [retrieval_preprocessing] finished and saved retrieval indices for episode 71712 [episode count 4/20]
[retrieval_preprocessing] for episode 72226 [episode count 5/20], we have num_retrieval=np.int64(3859) num_query=np.int64(172)
2025-03-09 08:06:37,748 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-09 08:06:38,416 [INFO]: Launching the whole pipeline 03/09/2025, 08:06:38
2025-03-09 08:06:38,416 [INFO]: Reading total number of vectors and dimension 03/09/2025, 08:06:38
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1159.29it/s]
2025-03-09 08:06:38,442 [INFO]: There are 3859 embeddings of dim 49152
2025-03-09 08:06:38,442 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0260 secs
2025-03-09 08:06:38,442 [INFO]: 	Compute estimated construction time of the index 03/09/2025, 08:06:38
2025-03-09 08:06:38,443 [INFO]: 		-> Train: 16.7 minutes
2025-03-09 08:06:38,443 [INFO]: 		-> Add: 2.1 seconds
2025-03-09 08:06:38,443 [INFO]: 		Total: 16.7 minutes
2025-03-09 08:06:38,443 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0004 secs
2025-03-09 08:06:38,443 [INFO]: 	Checking that your have enough memory available to create the index 03/09/2025, 08:06:38
2025-03-09 08:06:38,443 [INFO]: 796.4MB of memory will be needed to build the index (more might be used if you have more)
2025-03-09 08:06:38,444 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0005 secs
2025-03-09 08:06:38,444 [INFO]: 	Selecting most promising index types given data characteristics 03/09/2025, 08:06:38
2025-03-09 08:06:38,444 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-09 08:06:38,444 [INFO]: 	Creating the index 03/09/2025, 08:06:38
2025-03-09 08:06:38,444 [INFO]: 		-> Instanciate the index HNSW15 03/09/2025, 08:06:38
2025-03-09 08:06:38,447 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0027 secs
2025-03-09 08:06:38,447 [INFO]: 		-> Adding the vectors to the index 03/09/2025, 08:06:38
2025-03-09 08:06:38,447 [INFO]: The memory available for adding the vectors is 49.3GB(total available - used by the index)
2025-03-09 08:06:38,447 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/16 [00:00<?, ?it/s]  6%|▋         | 1/16 [00:00<00:02,  6.28it/s] 19%|█▉        | 3/16 [00:00<00:01,  9.92it/s] 31%|███▏      | 5/16 [00:00<00:00, 11.29it/s] 44%|████▍     | 7/16 [00:00<00:00, 11.96it/s] 56%|█████▋    | 9/16 [00:00<00:00, 11.63it/s] 69%|██████▉   | 11/16 [00:00<00:00, 11.70it/s] 81%|████████▏ | 13/16 [00:01<00:00, 11.73it/s] 94%|█████████▍| 15/16 [00:01<00:00, 11.62it/s]100%|██████████| 16/16 [00:04<00:00,  3.45it/s]
2025-03-09 08:06:43,089 [INFO]: 	Computing best hyperparameters for index knn.index 03/09/2025, 08:06:43
2025-03-09 08:07:18,273 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 35.1845 secs
2025-03-09 08:07:18,274 [INFO]: The best hyperparameters are: efSearch=188
2025-03-09 08:07:18,274 [INFO]: 	Compute fast metrics 03/09/2025, 08:07:18
  0%|          | 0/4 [00:00<?, ?it/s] 25%|██▌       | 1/4 [00:00<00:00,  4.73it/s] 50%|█████     | 2/4 [00:00<00:00,  5.73it/s] 75%|███████▌  | 3/4 [00:00<00:00,  6.47it/s] 75%|███████▌  | 3/4 [00:00<00:00,  5.11it/s]
2025-03-09 08:07:37,637 [INFO]: 	>>> Finished "Compute fast metrics" in 19.3623 secs
2025-03-09 08:07:37,639 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 59.1922 secs
2025-03-09 08:07:37,639 [INFO]: {
2025-03-09 08:07:37,639 [INFO]: 	index_key: HNSW15
2025-03-09 08:07:37,639 [INFO]: 	index_param: efSearch=188
2025-03-09 08:07:37,640 [INFO]: 	index_path: knn.index
2025-03-09 08:07:37,640 [INFO]: 	size in bytes: 759234970
2025-03-09 08:07:37,640 [INFO]: 	avg_search_speed_ms: 9.952522651639892
2025-03-09 08:07:37,640 [INFO]: 	99p_search_speed_ms: 18.266754504293225
2025-03-09 08:07:37,640 [INFO]: 	reconstruction error %: 0.0
2025-03-09 08:07:37,640 [INFO]: 	nb vectors: 3859
2025-03-09 08:07:37,640 [INFO]: 	vectors dimension: 49152
2025-03-09 08:07:37,640 [INFO]: 	compression ratio: 0.9993089122330601
2025-03-09 08:07:37,640 [INFO]: }
2025-03-09 08:07:37,640 [INFO]: 	>>> Finished "Creating the index" in 59.1957 secs
2025-03-09 08:07:37,640 [INFO]: >>> Finished "Launching the whole pipeline" in 59.2236 secs
2025-03-09 08:07:38: [retrieval_preprocessing] calculating distances ...
2025-03-09 08:07:38: [retrieval_preprocessing] finished and saved retrieval indices for episode 72226 [episode count 5/20]
[retrieval_preprocessing] for episode 61481 [episode count 6/20], we have num_retrieval=np.int64(3873) num_query=np.int64(158)
2025-03-09 08:07:40,073 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-09 08:07:40,567 [INFO]: Launching the whole pipeline 03/09/2025, 08:07:40
2025-03-09 08:07:40,567 [INFO]: Reading total number of vectors and dimension 03/09/2025, 08:07:40
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1813.36it/s]
2025-03-09 08:07:40,594 [INFO]: There are 3873 embeddings of dim 49152
2025-03-09 08:07:40,594 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0267 secs
2025-03-09 08:07:40,594 [INFO]: 	Compute estimated construction time of the index 03/09/2025, 08:07:40
2025-03-09 08:07:40,594 [INFO]: 		-> Train: 16.7 minutes
2025-03-09 08:07:40,594 [INFO]: 		-> Add: 2.1 seconds
2025-03-09 08:07:40,595 [INFO]: 		Total: 16.7 minutes
2025-03-09 08:07:40,595 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0004 secs
2025-03-09 08:07:40,595 [INFO]: 	Checking that your have enough memory available to create the index 03/09/2025, 08:07:40
2025-03-09 08:07:40,595 [INFO]: 799.3MB of memory will be needed to build the index (more might be used if you have more)
2025-03-09 08:07:40,595 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0004 secs
2025-03-09 08:07:40,595 [INFO]: 	Selecting most promising index types given data characteristics 03/09/2025, 08:07:40
2025-03-09 08:07:40,596 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-09 08:07:40,596 [INFO]: 	Creating the index 03/09/2025, 08:07:40
2025-03-09 08:07:40,596 [INFO]: 		-> Instanciate the index HNSW15 03/09/2025, 08:07:40
2025-03-09 08:07:40,599 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0026 secs
2025-03-09 08:07:40,599 [INFO]: 		-> Adding the vectors to the index 03/09/2025, 08:07:40
2025-03-09 08:07:40,599 [INFO]: The memory available for adding the vectors is 49.3GB(total available - used by the index)
2025-03-09 08:07:40,599 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/16 [00:00<?, ?it/s]  6%|▋         | 1/16 [00:00<00:02,  5.45it/s] 12%|█▎        | 2/16 [00:00<00:01,  7.20it/s] 19%|█▉        | 3/16 [00:00<00:01,  8.02it/s] 25%|██▌       | 4/16 [00:00<00:01,  8.46it/s] 31%|███▏      | 5/16 [00:00<00:01,  8.82it/s] 38%|███▊      | 6/16 [00:00<00:01,  8.99it/s] 44%|████▍     | 7/16 [00:00<00:00,  9.05it/s] 50%|█████     | 8/16 [00:00<00:00,  9.08it/s] 56%|█████▋    | 9/16 [00:01<00:00,  9.08it/s] 62%|██████▎   | 10/16 [00:01<00:00,  9.08it/s] 69%|██████▉   | 11/16 [00:01<00:00,  9.13it/s] 75%|███████▌  | 12/16 [00:01<00:00,  8.95it/s] 81%|████████▏ | 13/16 [00:01<00:00,  8.74it/s] 88%|████████▊ | 14/16 [00:01<00:00,  8.62it/s] 94%|█████████▍| 15/16 [00:01<00:00,  8.57it/s]100%|██████████| 16/16 [00:04<00:00,  1.02s/it]100%|██████████| 16/16 [00:04<00:00,  3.30it/s]
2025-03-09 08:07:45,457 [INFO]: 	Computing best hyperparameters for index knn.index 03/09/2025, 08:07:45
2025-03-09 08:08:22,552 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 37.0952 secs
2025-03-09 08:08:22,553 [INFO]: The best hyperparameters are: efSearch=174
2025-03-09 08:08:22,553 [INFO]: 	Compute fast metrics 03/09/2025, 08:08:22
  0%|          | 0/4 [00:00<?, ?it/s] 25%|██▌       | 1/4 [00:00<00:00,  6.26it/s] 50%|█████     | 2/4 [00:00<00:00,  7.80it/s] 75%|███████▌  | 3/4 [00:00<00:00,  8.26it/s] 75%|███████▌  | 3/4 [00:00<00:00,  6.34it/s]
2025-03-09 08:08:41,138 [INFO]: 	>>> Finished "Compute fast metrics" in 18.5850 secs
2025-03-09 08:08:41,141 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 60.5416 secs
2025-03-09 08:08:41,141 [INFO]: {
2025-03-09 08:08:41,141 [INFO]: 	index_key: HNSW15
2025-03-09 08:08:41,141 [INFO]: 	index_param: efSearch=174
2025-03-09 08:08:41,141 [INFO]: 	index_path: knn.index
2025-03-09 08:08:41,141 [INFO]: 	size in bytes: 761989390
2025-03-09 08:08:41,141 [INFO]: 	avg_search_speed_ms: 9.683707941527274
2025-03-09 08:08:41,141 [INFO]: 	99p_search_speed_ms: 19.368163552135226
2025-03-09 08:08:41,141 [INFO]: 	reconstruction error %: 0.0
2025-03-09 08:08:41,141 [INFO]: 	nb vectors: 3873
2025-03-09 08:08:41,141 [INFO]: 	vectors dimension: 49152
2025-03-09 08:08:41,141 [INFO]: 	compression ratio: 0.999308906387791
2025-03-09 08:08:41,141 [INFO]: }
2025-03-09 08:08:41,141 [INFO]: 	>>> Finished "Creating the index" in 60.5456 secs
2025-03-09 08:08:41,141 [INFO]: >>> Finished "Launching the whole pipeline" in 60.5742 secs
2025-03-09 08:08:41: [retrieval_preprocessing] calculating distances ...
2025-03-09 08:08:42: [retrieval_preprocessing] finished and saved retrieval indices for episode 61481 [episode count 6/20]
[retrieval_preprocessing] for episode 75817 [episode count 7/20], we have num_retrieval=np.int64(3865) num_query=np.int64(166)
2025-03-09 08:08:43,910 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-09 08:08:45,145 [INFO]: Launching the whole pipeline 03/09/2025, 08:08:45
2025-03-09 08:08:45,145 [INFO]: Reading total number of vectors and dimension 03/09/2025, 08:08:45
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1334.07it/s]
2025-03-09 08:08:45,174 [INFO]: There are 3865 embeddings of dim 49152
2025-03-09 08:08:45,175 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0294 secs
2025-03-09 08:08:45,175 [INFO]: 	Compute estimated construction time of the index 03/09/2025, 08:08:45
2025-03-09 08:08:45,175 [INFO]: 		-> Train: 16.7 minutes
2025-03-09 08:08:45,175 [INFO]: 		-> Add: 2.1 seconds
2025-03-09 08:08:45,175 [INFO]: 		Total: 16.7 minutes
2025-03-09 08:08:45,175 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0002 secs
2025-03-09 08:08:45,175 [INFO]: 	Checking that your have enough memory available to create the index 03/09/2025, 08:08:45
2025-03-09 08:08:45,175 [INFO]: 797.6MB of memory will be needed to build the index (more might be used if you have more)
2025-03-09 08:08:45,175 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0002 secs
2025-03-09 08:08:45,175 [INFO]: 	Selecting most promising index types given data characteristics 03/09/2025, 08:08:45
2025-03-09 08:08:45,175 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-09 08:08:45,175 [INFO]: 	Creating the index 03/09/2025, 08:08:45
2025-03-09 08:08:45,175 [INFO]: 		-> Instanciate the index HNSW15 03/09/2025, 08:08:45
2025-03-09 08:08:45,177 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0012 secs
2025-03-09 08:08:45,177 [INFO]: 		-> Adding the vectors to the index 03/09/2025, 08:08:45
2025-03-09 08:08:45,177 [INFO]: The memory available for adding the vectors is 49.3GB(total available - used by the index)
2025-03-09 08:08:45,177 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/16 [00:00<?, ?it/s]  6%|▋         | 1/16 [00:00<00:02,  5.05it/s] 12%|█▎        | 2/16 [00:00<00:02,  6.55it/s] 19%|█▉        | 3/16 [00:00<00:01,  7.12it/s] 25%|██▌       | 4/16 [00:00<00:01,  7.64it/s] 31%|███▏      | 5/16 [00:00<00:01,  7.84it/s] 38%|███▊      | 6/16 [00:00<00:01,  8.03it/s] 44%|████▍     | 7/16 [00:00<00:01,  8.02it/s] 50%|█████     | 8/16 [00:01<00:00,  8.08it/s] 56%|█████▋    | 9/16 [00:01<00:00,  8.12it/s] 62%|██████▎   | 10/16 [00:01<00:00,  8.27it/s] 69%|██████▉   | 11/16 [00:01<00:00,  8.24it/s] 75%|███████▌  | 12/16 [00:01<00:00,  8.16it/s] 81%|████████▏ | 13/16 [00:01<00:00,  8.16it/s] 88%|████████▊ | 14/16 [00:01<00:00,  8.19it/s] 94%|█████████▍| 15/16 [00:01<00:00,  8.28it/s]100%|██████████| 16/16 [00:06<00:00,  1.41s/it]100%|██████████| 16/16 [00:06<00:00,  2.54it/s]
2025-03-09 08:08:51,488 [INFO]: 	Computing best hyperparameters for index knn.index 03/09/2025, 08:08:51
2025-03-09 08:09:28,240 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 36.7520 secs
2025-03-09 08:09:28,241 [INFO]: The best hyperparameters are: efSearch=203
2025-03-09 08:09:28,241 [INFO]: 	Compute fast metrics 03/09/2025, 08:09:28
  0%|          | 0/4 [00:00<?, ?it/s] 25%|██▌       | 1/4 [00:00<00:00,  5.39it/s] 50%|█████     | 2/4 [00:00<00:00,  7.21it/s] 75%|███████▌  | 3/4 [00:00<00:00,  7.91it/s] 75%|███████▌  | 3/4 [00:00<00:00,  5.96it/s]
2025-03-09 08:09:49,002 [INFO]: 	>>> Finished "Compute fast metrics" in 20.7617 secs
2025-03-09 08:09:49,005 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 63.8284 secs
2025-03-09 08:09:49,005 [INFO]: {
2025-03-09 08:09:49,005 [INFO]: 	index_key: HNSW15
2025-03-09 08:09:49,005 [INFO]: 	index_param: efSearch=203
2025-03-09 08:09:49,005 [INFO]: 	index_path: knn.index
2025-03-09 08:09:49,005 [INFO]: 	size in bytes: 760415470
2025-03-09 08:09:49,005 [INFO]: 	avg_search_speed_ms: 11.351712094038454
2025-03-09 08:09:49,005 [INFO]: 	99p_search_speed_ms: 20.309858769178398
2025-03-09 08:09:49,005 [INFO]: 	reconstruction error %: 0.0
2025-03-09 08:09:49,005 [INFO]: 	nb vectors: 3865
2025-03-09 08:09:49,005 [INFO]: 	vectors dimension: 49152
2025-03-09 08:09:49,005 [INFO]: 	compression ratio: 0.999308864665786
2025-03-09 08:09:49,005 [INFO]: }
2025-03-09 08:09:49,005 [INFO]: 	>>> Finished "Creating the index" in 63.8301 secs
2025-03-09 08:09:49,005 [INFO]: >>> Finished "Launching the whole pipeline" in 63.8603 secs
2025-03-09 08:09:49: [retrieval_preprocessing] calculating distances ...
2025-03-09 08:09:50: [retrieval_preprocessing] finished and saved retrieval indices for episode 75817 [episode count 7/20]
[retrieval_preprocessing] for episode 49719 [episode count 8/20], we have num_retrieval=np.int64(3817) num_query=np.int64(214)
2025-03-09 08:09:51,698 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-09 08:09:52,200 [INFO]: Launching the whole pipeline 03/09/2025, 08:09:52
2025-03-09 08:09:52,200 [INFO]: Reading total number of vectors and dimension 03/09/2025, 08:09:52
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1390.22it/s]
2025-03-09 08:09:52,229 [INFO]: There are 3817 embeddings of dim 49152
2025-03-09 08:09:52,229 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0289 secs
2025-03-09 08:09:52,229 [INFO]: 	Compute estimated construction time of the index 03/09/2025, 08:09:52
2025-03-09 08:09:52,229 [INFO]: 		-> Train: 16.7 minutes
2025-03-09 08:09:52,230 [INFO]: 		-> Add: 2.1 seconds
2025-03-09 08:09:52,230 [INFO]: 		Total: 16.7 minutes
2025-03-09 08:09:52,230 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0004 secs
2025-03-09 08:09:52,230 [INFO]: 	Checking that your have enough memory available to create the index 03/09/2025, 08:09:52
2025-03-09 08:09:52,230 [INFO]: 787.7MB of memory will be needed to build the index (more might be used if you have more)
2025-03-09 08:09:52,230 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0004 secs
2025-03-09 08:09:52,230 [INFO]: 	Selecting most promising index types given data characteristics 03/09/2025, 08:09:52
2025-03-09 08:09:52,230 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-09 08:09:52,231 [INFO]: 	Creating the index 03/09/2025, 08:09:52
2025-03-09 08:09:52,231 [INFO]: 		-> Instanciate the index HNSW15 03/09/2025, 08:09:52
2025-03-09 08:09:52,234 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0030 secs
2025-03-09 08:09:52,234 [INFO]: 		-> Adding the vectors to the index 03/09/2025, 08:09:52
2025-03-09 08:09:52,234 [INFO]: The memory available for adding the vectors is 49.3GB(total available - used by the index)
2025-03-09 08:09:52,234 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/16 [00:00<?, ?it/s]  6%|▋         | 1/16 [00:00<00:02,  6.32it/s] 19%|█▉        | 3/16 [00:00<00:01,  9.33it/s] 31%|███▏      | 5/16 [00:00<00:01, 10.35it/s] 44%|████▍     | 7/16 [00:00<00:00, 11.11it/s] 56%|█████▋    | 9/16 [00:00<00:00, 11.54it/s] 69%|██████▉   | 11/16 [00:00<00:00, 11.87it/s] 81%|████████▏ | 13/16 [00:01<00:00, 12.14it/s] 94%|█████████▍| 15/16 [00:01<00:00, 11.99it/s]100%|██████████| 16/16 [00:03<00:00,  4.06it/s]
2025-03-09 08:09:56,185 [INFO]: 	Computing best hyperparameters for index knn.index 03/09/2025, 08:09:56
2025-03-09 08:10:36,137 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 39.9517 secs
2025-03-09 08:10:36,137 [INFO]: The best hyperparameters are: efSearch=192
2025-03-09 08:10:36,137 [INFO]: 	Compute fast metrics 03/09/2025, 08:10:36
  0%|          | 0/4 [00:00<?, ?it/s] 25%|██▌       | 1/4 [00:00<00:00,  5.09it/s] 50%|█████     | 2/4 [00:00<00:00,  6.87it/s] 75%|███████▌  | 3/4 [00:00<00:00,  7.49it/s] 75%|███████▌  | 3/4 [00:00<00:00,  5.72it/s]
2025-03-09 08:10:52,621 [INFO]: 	>>> Finished "Compute fast metrics" in 16.4834 secs
2025-03-09 08:10:52,623 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 60.3893 secs
2025-03-09 08:10:52,624 [INFO]: {
2025-03-09 08:10:52,624 [INFO]: 	index_key: HNSW15
2025-03-09 08:10:52,624 [INFO]: 	index_param: efSearch=192
2025-03-09 08:10:52,624 [INFO]: 	index_path: knn.index
2025-03-09 08:10:52,624 [INFO]: 	size in bytes: 750971590
2025-03-09 08:10:52,624 [INFO]: 	avg_search_speed_ms: 9.381152662155035
2025-03-09 08:10:52,624 [INFO]: 	99p_search_speed_ms: 14.950388134457153
2025-03-09 08:10:52,624 [INFO]: 	reconstruction error %: 0.0
2025-03-09 08:10:52,624 [INFO]: 	nb vectors: 3817
2025-03-09 08:10:52,624 [INFO]: 	vectors dimension: 49152
2025-03-09 08:10:52,624 [INFO]: 	compression ratio: 0.9993090897087066
2025-03-09 08:10:52,624 [INFO]: }
2025-03-09 08:10:52,624 [INFO]: 	>>> Finished "Creating the index" in 60.3932 secs
2025-03-09 08:10:52,624 [INFO]: >>> Finished "Launching the whole pipeline" in 60.4237 secs
2025-03-09 08:10:53: [retrieval_preprocessing] calculating distances ...
2025-03-09 08:10:54: [retrieval_preprocessing] finished and saved retrieval indices for episode 49719 [episode count 8/20]
[retrieval_preprocessing] for episode 41017 [episode count 9/20], we have num_retrieval=np.int64(3796) num_query=np.int64(235)
2025-03-09 08:10:55,482 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-09 08:10:57,053 [INFO]: Launching the whole pipeline 03/09/2025, 08:10:57
2025-03-09 08:10:57,053 [INFO]: Reading total number of vectors and dimension 03/09/2025, 08:10:57
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1506.03it/s]
2025-03-09 08:10:57,078 [INFO]: There are 3796 embeddings of dim 49152
2025-03-09 08:10:57,078 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0246 secs
2025-03-09 08:10:57,078 [INFO]: 	Compute estimated construction time of the index 03/09/2025, 08:10:57
2025-03-09 08:10:57,078 [INFO]: 		-> Train: 16.7 minutes
2025-03-09 08:10:57,078 [INFO]: 		-> Add: 2.1 seconds
2025-03-09 08:10:57,078 [INFO]: 		Total: 16.7 minutes
2025-03-09 08:10:57,078 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0001 secs
2025-03-09 08:10:57,078 [INFO]: 	Checking that your have enough memory available to create the index 03/09/2025, 08:10:57
2025-03-09 08:10:57,078 [INFO]: 783.4MB of memory will be needed to build the index (more might be used if you have more)
2025-03-09 08:10:57,078 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0001 secs
2025-03-09 08:10:57,078 [INFO]: 	Selecting most promising index types given data characteristics 03/09/2025, 08:10:57
2025-03-09 08:10:57,078 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-09 08:10:57,078 [INFO]: 	Creating the index 03/09/2025, 08:10:57
2025-03-09 08:10:57,078 [INFO]: 		-> Instanciate the index HNSW15 03/09/2025, 08:10:57
2025-03-09 08:10:57,080 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0010 secs
2025-03-09 08:10:57,080 [INFO]: 		-> Adding the vectors to the index 03/09/2025, 08:10:57
2025-03-09 08:10:57,080 [INFO]: The memory available for adding the vectors is 49.3GB(total available - used by the index)
2025-03-09 08:10:57,080 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/15 [00:00<?, ?it/s]  7%|▋         | 1/15 [00:00<00:02,  5.65it/s] 20%|██        | 3/15 [00:00<00:01,  9.81it/s] 33%|███▎      | 5/15 [00:00<00:00, 10.77it/s] 47%|████▋     | 7/15 [00:00<00:00,  9.88it/s] 60%|██████    | 9/15 [00:00<00:00,  9.55it/s] 67%|██████▋   | 10/15 [00:01<00:00,  9.42it/s] 73%|███████▎  | 11/15 [00:01<00:00,  9.26it/s] 80%|████████  | 12/15 [00:01<00:00,  9.20it/s] 87%|████████▋ | 13/15 [00:01<00:00,  9.14it/s] 93%|█████████▎| 14/15 [00:01<00:00,  9.23it/s]100%|██████████| 15/15 [00:04<00:00,  1.02it/s]100%|██████████| 15/15 [00:04<00:00,  3.17it/s]
2025-03-09 08:11:01,816 [INFO]: 	Computing best hyperparameters for index knn.index 03/09/2025, 08:11:01
2025-03-09 08:11:41,545 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 39.7292 secs
2025-03-09 08:11:41,546 [INFO]: The best hyperparameters are: efSearch=176
2025-03-09 08:11:41,546 [INFO]: 	Compute fast metrics 03/09/2025, 08:11:41
  0%|          | 0/4 [00:00<?, ?it/s] 25%|██▌       | 1/4 [00:00<00:00,  5.43it/s] 75%|███████▌  | 3/4 [00:00<00:00,  8.65it/s] 75%|███████▌  | 3/4 [00:00<00:00,  6.41it/s]
2025-03-09 08:11:57,215 [INFO]: 	>>> Finished "Compute fast metrics" in 15.6694 secs
2025-03-09 08:11:57,218 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 60.1378 secs
2025-03-09 08:11:57,218 [INFO]: {
2025-03-09 08:11:57,218 [INFO]: 	index_key: HNSW15
2025-03-09 08:11:57,218 [INFO]: 	index_param: efSearch=176
2025-03-09 08:11:57,218 [INFO]: 	index_path: knn.index
2025-03-09 08:11:57,218 [INFO]: 	size in bytes: 746839870
2025-03-09 08:11:57,218 [INFO]: 	avg_search_speed_ms: 9.758817597133357
2025-03-09 08:11:57,218 [INFO]: 	99p_search_speed_ms: 17.3194876499474
2025-03-09 08:11:57,218 [INFO]: 	reconstruction error %: 0.0
2025-03-09 08:11:57,218 [INFO]: 	nb vectors: 3796
2025-03-09 08:11:57,218 [INFO]: 	vectors dimension: 49152
2025-03-09 08:11:57,218 [INFO]: 	compression ratio: 0.9993092200607876
2025-03-09 08:11:57,218 [INFO]: }
2025-03-09 08:11:57,218 [INFO]: 	>>> Finished "Creating the index" in 60.1394 secs
2025-03-09 08:11:57,218 [INFO]: >>> Finished "Launching the whole pipeline" in 60.1646 secs
2025-03-09 08:11:58: [retrieval_preprocessing] calculating distances ...
2025-03-09 08:11:58: [retrieval_preprocessing] finished and saved retrieval indices for episode 41017 [episode count 9/20]
[retrieval_preprocessing] for episode 24635 [episode count 10/20], we have num_retrieval=np.int64(3859) num_query=np.int64(172)
2025-03-09 08:12:00,058 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-09 08:12:00,568 [INFO]: Launching the whole pipeline 03/09/2025, 08:12:00
2025-03-09 08:12:00,568 [INFO]: Reading total number of vectors and dimension 03/09/2025, 08:12:00
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1884.23it/s]
2025-03-09 08:12:00,590 [INFO]: There are 3859 embeddings of dim 49152
2025-03-09 08:12:00,590 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0222 secs
2025-03-09 08:12:00,590 [INFO]: 	Compute estimated construction time of the index 03/09/2025, 08:12:00
2025-03-09 08:12:00,590 [INFO]: 		-> Train: 16.7 minutes
2025-03-09 08:12:00,590 [INFO]: 		-> Add: 2.1 seconds
2025-03-09 08:12:00,590 [INFO]: 		Total: 16.7 minutes
2025-03-09 08:12:00,591 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0001 secs
2025-03-09 08:12:00,591 [INFO]: 	Checking that your have enough memory available to create the index 03/09/2025, 08:12:00
2025-03-09 08:12:00,591 [INFO]: 796.4MB of memory will be needed to build the index (more might be used if you have more)
2025-03-09 08:12:00,591 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0001 secs
2025-03-09 08:12:00,591 [INFO]: 	Selecting most promising index types given data characteristics 03/09/2025, 08:12:00
2025-03-09 08:12:00,591 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-09 08:12:00,591 [INFO]: 	Creating the index 03/09/2025, 08:12:00
2025-03-09 08:12:00,591 [INFO]: 		-> Instanciate the index HNSW15 03/09/2025, 08:12:00
2025-03-09 08:12:00,592 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0009 secs
2025-03-09 08:12:00,592 [INFO]: 		-> Adding the vectors to the index 03/09/2025, 08:12:00
2025-03-09 08:12:00,592 [INFO]: The memory available for adding the vectors is 49.3GB(total available - used by the index)
2025-03-09 08:12:00,592 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/16 [00:00<?, ?it/s]  6%|▋         | 1/16 [00:00<00:02,  5.58it/s] 19%|█▉        | 3/16 [00:00<00:01,  9.13it/s] 31%|███▏      | 5/16 [00:00<00:01,  9.67it/s] 44%|████▍     | 7/16 [00:00<00:00, 10.04it/s] 56%|█████▋    | 9/16 [00:00<00:00, 10.39it/s] 69%|██████▉   | 11/16 [00:01<00:00, 11.13it/s] 81%|████████▏ | 13/16 [00:01<00:00, 11.67it/s] 94%|█████████▍| 15/16 [00:01<00:00, 11.96it/s]100%|██████████| 16/16 [00:04<00:00,  3.86it/s]
2025-03-09 08:12:04,740 [INFO]: 	Computing best hyperparameters for index knn.index 03/09/2025, 08:12:04
2025-03-09 08:12:43,608 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 38.8671 secs
2025-03-09 08:12:43,608 [INFO]: The best hyperparameters are: efSearch=179
2025-03-09 08:12:43,608 [INFO]: 	Compute fast metrics 03/09/2025, 08:12:43
  0%|          | 0/4 [00:00<?, ?it/s] 25%|██▌       | 1/4 [00:00<00:00,  5.71it/s] 50%|█████     | 2/4 [00:00<00:00,  7.59it/s] 75%|███████▌  | 3/4 [00:00<00:00,  8.47it/s] 75%|███████▌  | 3/4 [00:00<00:00,  6.40it/s]
2025-03-09 08:13:02,639 [INFO]: 	>>> Finished "Compute fast metrics" in 19.0309 secs
2025-03-09 08:13:02,642 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 62.0501 secs
2025-03-09 08:13:02,642 [INFO]: {
2025-03-09 08:13:02,642 [INFO]: 	index_key: HNSW15
2025-03-09 08:13:02,642 [INFO]: 	index_param: efSearch=179
2025-03-09 08:13:02,642 [INFO]: 	index_path: knn.index
2025-03-09 08:13:02,642 [INFO]: 	size in bytes: 759234970
2025-03-09 08:13:02,642 [INFO]: 	avg_search_speed_ms: 9.565464541472737
2025-03-09 08:13:02,642 [INFO]: 	99p_search_speed_ms: 18.139479879755513
2025-03-09 08:13:02,642 [INFO]: 	reconstruction error %: 0.0
2025-03-09 08:13:02,642 [INFO]: 	nb vectors: 3859
2025-03-09 08:13:02,642 [INFO]: 	vectors dimension: 49152
2025-03-09 08:13:02,642 [INFO]: 	compression ratio: 0.9993089122330601
2025-03-09 08:13:02,642 [INFO]: }
2025-03-09 08:13:02,642 [INFO]: 	>>> Finished "Creating the index" in 62.0514 secs
2025-03-09 08:13:02,642 [INFO]: >>> Finished "Launching the whole pipeline" in 62.0743 secs
2025-03-09 08:13:03: [retrieval_preprocessing] calculating distances ...
2025-03-09 08:13:03: [retrieval_preprocessing] finished and saved retrieval indices for episode 24635 [episode count 10/20]
[retrieval_preprocessing] for episode 24125 [episode count 11/20], we have num_retrieval=np.int64(3894) num_query=np.int64(137)
2025-03-09 08:13:04,910 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-09 08:13:05,564 [INFO]: Launching the whole pipeline 03/09/2025, 08:13:05
2025-03-09 08:13:05,564 [INFO]: Reading total number of vectors and dimension 03/09/2025, 08:13:05
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1370.69it/s]
2025-03-09 08:13:05,591 [INFO]: There are 3894 embeddings of dim 49152
2025-03-09 08:13:05,591 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0272 secs
2025-03-09 08:13:05,592 [INFO]: 	Compute estimated construction time of the index 03/09/2025, 08:13:05
2025-03-09 08:13:05,592 [INFO]: 		-> Train: 16.7 minutes
2025-03-09 08:13:05,592 [INFO]: 		-> Add: 2.1 seconds
2025-03-09 08:13:05,592 [INFO]: 		Total: 16.7 minutes
2025-03-09 08:13:05,592 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0004 secs
2025-03-09 08:13:05,592 [INFO]: 	Checking that your have enough memory available to create the index 03/09/2025, 08:13:05
2025-03-09 08:13:05,593 [INFO]: 803.6MB of memory will be needed to build the index (more might be used if you have more)
2025-03-09 08:13:05,593 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0004 secs
2025-03-09 08:13:05,593 [INFO]: 	Selecting most promising index types given data characteristics 03/09/2025, 08:13:05
2025-03-09 08:13:05,593 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-09 08:13:05,593 [INFO]: 	Creating the index 03/09/2025, 08:13:05
2025-03-09 08:13:05,593 [INFO]: 		-> Instanciate the index HNSW15 03/09/2025, 08:13:05
2025-03-09 08:13:05,596 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0024 secs
2025-03-09 08:13:05,596 [INFO]: 		-> Adding the vectors to the index 03/09/2025, 08:13:05
2025-03-09 08:13:05,596 [INFO]: The memory available for adding the vectors is 49.3GB(total available - used by the index)
2025-03-09 08:13:05,597 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/16 [00:00<?, ?it/s]  6%|▋         | 1/16 [00:00<00:02,  5.54it/s] 19%|█▉        | 3/16 [00:00<00:01, 10.19it/s] 31%|███▏      | 5/16 [00:00<00:01, 10.91it/s] 44%|████▍     | 7/16 [00:00<00:00, 11.20it/s] 56%|█████▋    | 9/16 [00:00<00:00, 11.64it/s] 69%|██████▉   | 11/16 [00:00<00:00, 11.92it/s] 81%|████████▏ | 13/16 [00:01<00:00, 12.21it/s] 94%|█████████▍| 15/16 [00:01<00:00, 12.45it/s]100%|██████████| 16/16 [00:04<00:00,  3.53it/s]
2025-03-09 08:13:10,140 [INFO]: 	Computing best hyperparameters for index knn.index 03/09/2025, 08:13:10
2025-03-09 08:13:50,926 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 40.7860 secs
2025-03-09 08:13:50,927 [INFO]: The best hyperparameters are: efSearch=181
2025-03-09 08:13:50,927 [INFO]: 	Compute fast metrics 03/09/2025, 08:13:50
  0%|          | 0/4 [00:00<?, ?it/s] 25%|██▌       | 1/4 [00:00<00:00,  6.31it/s] 75%|███████▌  | 3/4 [00:00<00:00, 10.43it/s] 75%|███████▌  | 3/4 [00:00<00:00,  7.93it/s]
2025-03-09 08:14:08,448 [INFO]: 	>>> Finished "Compute fast metrics" in 17.5210 secs
2025-03-09 08:14:08,450 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 62.8540 secs
2025-03-09 08:14:08,451 [INFO]: {
2025-03-09 08:14:08,451 [INFO]: 	index_key: HNSW15
2025-03-09 08:14:08,451 [INFO]: 	index_param: efSearch=181
2025-03-09 08:14:08,451 [INFO]: 	index_path: knn.index
2025-03-09 08:14:08,451 [INFO]: 	size in bytes: 766121110
2025-03-09 08:14:08,451 [INFO]: 	avg_search_speed_ms: 10.073121645546932
2025-03-09 08:14:08,451 [INFO]: 	99p_search_speed_ms: 23.086099829524777
2025-03-09 08:14:08,451 [INFO]: 	reconstruction error %: 0.0
2025-03-09 08:14:08,451 [INFO]: 	nb vectors: 3894
2025-03-09 08:14:08,451 [INFO]: 	vectors dimension: 49152
2025-03-09 08:14:08,451 [INFO]: 	compression ratio: 0.9993087803049834
2025-03-09 08:14:08,451 [INFO]: }
2025-03-09 08:14:08,451 [INFO]: 	>>> Finished "Creating the index" in 62.8573 secs
2025-03-09 08:14:08,451 [INFO]: >>> Finished "Launching the whole pipeline" in 62.8865 secs
2025-03-09 08:14:09: [retrieval_preprocessing] calculating distances ...
2025-03-09 08:14:09: [retrieval_preprocessing] finished and saved retrieval indices for episode 24125 [episode count 11/20]
[retrieval_preprocessing] for episode 62528 [episode count 12/20], we have num_retrieval=np.int64(3808) num_query=np.int64(223)
2025-03-09 08:14:10,800 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-09 08:14:11,958 [INFO]: Launching the whole pipeline 03/09/2025, 08:14:11
2025-03-09 08:14:11,958 [INFO]: Reading total number of vectors and dimension 03/09/2025, 08:14:11
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1514.19it/s]
2025-03-09 08:14:11,982 [INFO]: There are 3808 embeddings of dim 49152
2025-03-09 08:14:11,982 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0242 secs
2025-03-09 08:14:11,982 [INFO]: 	Compute estimated construction time of the index 03/09/2025, 08:14:11
2025-03-09 08:14:11,982 [INFO]: 		-> Train: 16.7 minutes
2025-03-09 08:14:11,982 [INFO]: 		-> Add: 2.1 seconds
2025-03-09 08:14:11,982 [INFO]: 		Total: 16.7 minutes
2025-03-09 08:14:11,982 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0002 secs
2025-03-09 08:14:11,982 [INFO]: 	Checking that your have enough memory available to create the index 03/09/2025, 08:14:11
2025-03-09 08:14:11,982 [INFO]: 785.9MB of memory will be needed to build the index (more might be used if you have more)
2025-03-09 08:14:11,982 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0001 secs
2025-03-09 08:14:11,982 [INFO]: 	Selecting most promising index types given data characteristics 03/09/2025, 08:14:11
2025-03-09 08:14:11,982 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-09 08:14:11,983 [INFO]: 	Creating the index 03/09/2025, 08:14:11
2025-03-09 08:14:11,983 [INFO]: 		-> Instanciate the index HNSW15 03/09/2025, 08:14:11
2025-03-09 08:14:11,984 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0010 secs
2025-03-09 08:14:11,984 [INFO]: 		-> Adding the vectors to the index 03/09/2025, 08:14:11
2025-03-09 08:14:11,984 [INFO]: The memory available for adding the vectors is 49.3GB(total available - used by the index)
2025-03-09 08:14:11,984 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/15 [00:00<?, ?it/s]  7%|▋         | 1/15 [00:00<00:02,  6.29it/s] 20%|██        | 3/15 [00:00<00:01,  9.67it/s] 33%|███▎      | 5/15 [00:00<00:00, 10.88it/s] 47%|████▋     | 7/15 [00:00<00:00, 11.48it/s] 60%|██████    | 9/15 [00:00<00:00, 11.84it/s] 73%|███████▎  | 11/15 [00:00<00:00, 11.93it/s] 87%|████████▋ | 13/15 [00:01<00:00, 12.14it/s]100%|██████████| 15/15 [00:04<00:00,  1.62it/s]100%|██████████| 15/15 [00:04<00:00,  3.24it/s]
2025-03-09 08:14:16,622 [INFO]: 	Computing best hyperparameters for index knn.index 03/09/2025, 08:14:16
2025-03-09 08:14:58,846 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 42.2237 secs
2025-03-09 08:14:58,847 [INFO]: The best hyperparameters are: efSearch=185
2025-03-09 08:14:58,847 [INFO]: 	Compute fast metrics 03/09/2025, 08:14:58
  0%|          | 0/4 [00:00<?, ?it/s] 25%|██▌       | 1/4 [00:00<00:00,  5.32it/s] 50%|█████     | 2/4 [00:00<00:00,  7.27it/s] 75%|███████▌  | 3/4 [00:00<00:00,  8.12it/s] 75%|███████▌  | 3/4 [00:00<00:00,  6.09it/s]
2025-03-09 08:15:16,132 [INFO]: 	>>> Finished "Compute fast metrics" in 17.2848 secs
2025-03-09 08:15:16,134 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 64.1501 secs
2025-03-09 08:15:16,134 [INFO]: {
2025-03-09 08:15:16,134 [INFO]: 	index_key: HNSW15
2025-03-09 08:15:16,134 [INFO]: 	index_param: efSearch=185
2025-03-09 08:15:16,134 [INFO]: 	index_path: knn.index
2025-03-09 08:15:16,134 [INFO]: 	size in bytes: 749200930
2025-03-09 08:15:16,134 [INFO]: 	avg_search_speed_ms: 9.659182810301077
2025-03-09 08:15:16,134 [INFO]: 	99p_search_speed_ms: 15.060849874280393
2025-03-09 08:15:16,134 [INFO]: 	reconstruction error %: 0.0
2025-03-09 08:15:16,134 [INFO]: 	nb vectors: 3808
2025-03-09 08:15:16,134 [INFO]: 	vectors dimension: 49152
2025-03-09 08:15:16,134 [INFO]: 	compression ratio: 0.9993090425021229
2025-03-09 08:15:16,134 [INFO]: }
2025-03-09 08:15:16,134 [INFO]: 	>>> Finished "Creating the index" in 64.1517 secs
2025-03-09 08:15:16,134 [INFO]: >>> Finished "Launching the whole pipeline" in 64.1765 secs
2025-03-09 08:15:17: [retrieval_preprocessing] calculating distances ...
2025-03-09 08:15:17: [retrieval_preprocessing] finished and saved retrieval indices for episode 62528 [episode count 12/20]
[retrieval_preprocessing] for episode 68189 [episode count 13/20], we have num_retrieval=np.int64(3857) num_query=np.int64(174)
2025-03-09 08:15:18,841 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-09 08:15:19,386 [INFO]: Launching the whole pipeline 03/09/2025, 08:15:19
2025-03-09 08:15:19,386 [INFO]: Reading total number of vectors and dimension 03/09/2025, 08:15:19
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1655.86it/s]
2025-03-09 08:15:19,412 [INFO]: There are 3857 embeddings of dim 49152
2025-03-09 08:15:19,412 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0265 secs
2025-03-09 08:15:19,412 [INFO]: 	Compute estimated construction time of the index 03/09/2025, 08:15:19
2025-03-09 08:15:19,412 [INFO]: 		-> Train: 16.7 minutes
2025-03-09 08:15:19,412 [INFO]: 		-> Add: 2.1 seconds
2025-03-09 08:15:19,412 [INFO]: 		Total: 16.7 minutes
2025-03-09 08:15:19,413 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0001 secs
2025-03-09 08:15:19,413 [INFO]: 	Checking that your have enough memory available to create the index 03/09/2025, 08:15:19
2025-03-09 08:15:19,413 [INFO]: 796.0MB of memory will be needed to build the index (more might be used if you have more)
2025-03-09 08:15:19,413 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0002 secs
2025-03-09 08:15:19,413 [INFO]: 	Selecting most promising index types given data characteristics 03/09/2025, 08:15:19
2025-03-09 08:15:19,413 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-09 08:15:19,413 [INFO]: 	Creating the index 03/09/2025, 08:15:19
2025-03-09 08:15:19,413 [INFO]: 		-> Instanciate the index HNSW15 03/09/2025, 08:15:19
2025-03-09 08:15:19,414 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0012 secs
2025-03-09 08:15:19,414 [INFO]: 		-> Adding the vectors to the index 03/09/2025, 08:15:19
2025-03-09 08:15:19,414 [INFO]: The memory available for adding the vectors is 49.3GB(total available - used by the index)
2025-03-09 08:15:19,414 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/16 [00:00<?, ?it/s]  6%|▋         | 1/16 [00:00<00:02,  5.30it/s] 12%|█▎        | 2/16 [00:00<00:01,  7.22it/s] 25%|██▌       | 4/16 [00:00<00:01,  8.71it/s] 38%|███▊      | 6/16 [00:00<00:01,  9.21it/s] 44%|████▍     | 7/16 [00:00<00:00,  9.31it/s] 50%|█████     | 8/16 [00:00<00:00,  9.48it/s] 56%|█████▋    | 9/16 [00:01<00:00,  9.48it/s] 62%|██████▎   | 10/16 [00:01<00:00,  9.50it/s] 69%|██████▉   | 11/16 [00:01<00:00,  9.54it/s] 75%|███████▌  | 12/16 [00:01<00:00,  9.56it/s] 81%|████████▏ | 13/16 [00:01<00:00,  9.29it/s] 88%|████████▊ | 14/16 [00:01<00:00,  9.34it/s] 94%|█████████▍| 15/16 [00:01<00:00,  9.25it/s]100%|██████████| 16/16 [00:04<00:00,  1.02it/s]100%|██████████| 16/16 [00:04<00:00,  3.40it/s]
2025-03-09 08:15:24,121 [INFO]: 	Computing best hyperparameters for index knn.index 03/09/2025, 08:15:24
2025-03-09 08:16:01,190 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 37.0686 secs
2025-03-09 08:16:01,190 [INFO]: The best hyperparameters are: efSearch=162
2025-03-09 08:16:01,190 [INFO]: 	Compute fast metrics 03/09/2025, 08:16:01
  0%|          | 0/4 [00:00<?, ?it/s] 25%|██▌       | 1/4 [00:00<00:00,  5.27it/s] 50%|█████     | 2/4 [00:00<00:00,  7.00it/s] 75%|███████▌  | 3/4 [00:00<00:00,  7.46it/s] 75%|███████▌  | 3/4 [00:00<00:00,  5.49it/s]
2025-03-09 08:16:22,016 [INFO]: 	>>> Finished "Compute fast metrics" in 20.8263 secs
2025-03-09 08:16:22,081 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 62.6672 secs
2025-03-09 08:16:22,082 [INFO]: {
2025-03-09 08:16:22,082 [INFO]: 	index_key: HNSW15
2025-03-09 08:16:22,082 [INFO]: 	index_param: efSearch=162
2025-03-09 08:16:22,082 [INFO]: 	index_path: knn.index
2025-03-09 08:16:22,082 [INFO]: 	size in bytes: 758841490
2025-03-09 08:16:22,082 [INFO]: 	avg_search_speed_ms: 9.251412981216495
2025-03-09 08:16:22,082 [INFO]: 	99p_search_speed_ms: 17.663013609126214
2025-03-09 08:16:22,082 [INFO]: 	reconstruction error %: 0.0
2025-03-09 08:16:22,082 [INFO]: 	nb vectors: 3857
2025-03-09 08:16:22,082 [INFO]: 	vectors dimension: 49152
2025-03-09 08:16:22,082 [INFO]: 	compression ratio: 0.9993089017839549
2025-03-09 08:16:22,082 [INFO]: }
2025-03-09 08:16:22,083 [INFO]: 	>>> Finished "Creating the index" in 62.6696 secs
2025-03-09 08:16:22,083 [INFO]: >>> Finished "Launching the whole pipeline" in 62.6968 secs
2025-03-09 08:16:22: [retrieval_preprocessing] calculating distances ...
2025-03-09 08:16:23: [retrieval_preprocessing] finished and saved retrieval indices for episode 68189 [episode count 13/20]
[retrieval_preprocessing] for episode 84067 [episode count 14/20], we have num_retrieval=np.int64(3840) num_query=np.int64(191)
2025-03-09 08:16:24,559 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-09 08:16:25,158 [INFO]: Launching the whole pipeline 03/09/2025, 08:16:25
2025-03-09 08:16:25,158 [INFO]: Reading total number of vectors and dimension 03/09/2025, 08:16:25
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1771.99it/s]
2025-03-09 08:16:25,184 [INFO]: There are 3840 embeddings of dim 49152
2025-03-09 08:16:25,185 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0269 secs
2025-03-09 08:16:25,185 [INFO]: 	Compute estimated construction time of the index 03/09/2025, 08:16:25
2025-03-09 08:16:25,185 [INFO]: 		-> Train: 16.7 minutes
2025-03-09 08:16:25,185 [INFO]: 		-> Add: 2.1 seconds
2025-03-09 08:16:25,185 [INFO]: 		Total: 16.7 minutes
2025-03-09 08:16:25,185 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0001 secs
2025-03-09 08:16:25,185 [INFO]: 	Checking that your have enough memory available to create the index 03/09/2025, 08:16:25
2025-03-09 08:16:25,185 [INFO]: 792.5MB of memory will be needed to build the index (more might be used if you have more)
2025-03-09 08:16:25,185 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0002 secs
2025-03-09 08:16:25,185 [INFO]: 	Selecting most promising index types given data characteristics 03/09/2025, 08:16:25
2025-03-09 08:16:25,185 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-09 08:16:25,185 [INFO]: 	Creating the index 03/09/2025, 08:16:25
2025-03-09 08:16:25,186 [INFO]: 		-> Instanciate the index HNSW15 03/09/2025, 08:16:25
2025-03-09 08:16:25,187 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0016 secs
2025-03-09 08:16:25,187 [INFO]: 		-> Adding the vectors to the index 03/09/2025, 08:16:25
2025-03-09 08:16:25,187 [INFO]: The memory available for adding the vectors is 49.3GB(total available - used by the index)
2025-03-09 08:16:25,188 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/16 [00:00<?, ?it/s]  6%|▋         | 1/16 [00:00<00:03,  4.88it/s] 12%|█▎        | 2/16 [00:00<00:02,  6.46it/s] 19%|█▉        | 3/16 [00:00<00:01,  7.23it/s] 25%|██▌       | 4/16 [00:00<00:01,  7.60it/s] 31%|███▏      | 5/16 [00:00<00:01,  7.80it/s] 38%|███▊      | 6/16 [00:00<00:01,  8.09it/s] 44%|████▍     | 7/16 [00:00<00:01,  8.05it/s] 50%|█████     | 8/16 [00:01<00:00,  8.16it/s] 56%|█████▋    | 9/16 [00:01<00:00,  8.33it/s] 62%|██████▎   | 10/16 [00:01<00:00,  8.43it/s] 69%|██████▉   | 11/16 [00:01<00:00,  8.64it/s] 75%|███████▌  | 12/16 [00:01<00:00,  8.88it/s] 81%|████████▏ | 13/16 [00:01<00:00,  9.08it/s] 94%|█████████▍| 15/16 [00:01<00:00, 10.30it/s]100%|██████████| 16/16 [00:04<00:00,  3.40it/s]
2025-03-09 08:16:29,893 [INFO]: 	Computing best hyperparameters for index knn.index 03/09/2025, 08:16:29
2025-03-09 08:17:10,351 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 40.4574 secs
2025-03-09 08:17:10,351 [INFO]: The best hyperparameters are: efSearch=193
2025-03-09 08:17:10,351 [INFO]: 	Compute fast metrics 03/09/2025, 08:17:10
  0%|          | 0/4 [00:00<?, ?it/s] 25%|██▌       | 1/4 [00:00<00:00,  4.61it/s] 50%|█████     | 2/4 [00:00<00:00,  5.96it/s] 75%|███████▌  | 3/4 [00:00<00:00,  6.01it/s]
2025-03-09 08:17:28,284 [INFO]: 	>>> Finished "Compute fast metrics" in 17.9330 secs
2025-03-09 08:17:28,287 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 63.1000 secs
2025-03-09 08:17:28,288 [INFO]: {
2025-03-09 08:17:28,288 [INFO]: 	index_key: HNSW15
2025-03-09 08:17:28,288 [INFO]: 	index_param: efSearch=193
2025-03-09 08:17:28,288 [INFO]: 	index_path: knn.index
2025-03-09 08:17:28,288 [INFO]: 	size in bytes: 755496850
2025-03-09 08:17:28,288 [INFO]: 	avg_search_speed_ms: 10.788284159519637
2025-03-09 08:17:28,288 [INFO]: 	99p_search_speed_ms: 21.241894452832643
2025-03-09 08:17:28,288 [INFO]: 	reconstruction error %: 0.0
2025-03-09 08:17:28,288 [INFO]: 	nb vectors: 3840
2025-03-09 08:17:28,288 [INFO]: 	vectors dimension: 49152
2025-03-09 08:17:28,288 [INFO]: 	compression ratio: 0.9993088918901515
2025-03-09 08:17:28,288 [INFO]: }
2025-03-09 08:17:28,288 [INFO]: 	>>> Finished "Creating the index" in 63.1023 secs
2025-03-09 08:17:28,288 [INFO]: >>> Finished "Launching the whole pipeline" in 63.1299 secs
2025-03-09 08:17:29: [retrieval_preprocessing] calculating distances ...
2025-03-09 08:17:30: [retrieval_preprocessing] finished and saved retrieval indices for episode 84067 [episode count 14/20]
[retrieval_preprocessing] for episode 19046 [episode count 15/20], we have num_retrieval=np.int64(3840) num_query=np.int64(191)
2025-03-09 08:17:32,270 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-09 08:17:32,969 [INFO]: Launching the whole pipeline 03/09/2025, 08:17:32
2025-03-09 08:17:32,969 [INFO]: Reading total number of vectors and dimension 03/09/2025, 08:17:32
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1132.68it/s]
2025-03-09 08:17:33,006 [INFO]: There are 3840 embeddings of dim 49152
2025-03-09 08:17:33,006 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0367 secs
2025-03-09 08:17:33,006 [INFO]: 	Compute estimated construction time of the index 03/09/2025, 08:17:33
2025-03-09 08:17:33,006 [INFO]: 		-> Train: 16.7 minutes
2025-03-09 08:17:33,006 [INFO]: 		-> Add: 2.1 seconds
2025-03-09 08:17:33,006 [INFO]: 		Total: 16.7 minutes
2025-03-09 08:17:33,007 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0002 secs
2025-03-09 08:17:33,007 [INFO]: 	Checking that your have enough memory available to create the index 03/09/2025, 08:17:33
2025-03-09 08:17:33,007 [INFO]: 792.5MB of memory will be needed to build the index (more might be used if you have more)
2025-03-09 08:17:33,007 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0003 secs
2025-03-09 08:17:33,007 [INFO]: 	Selecting most promising index types given data characteristics 03/09/2025, 08:17:33
2025-03-09 08:17:33,007 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-09 08:17:33,007 [INFO]: 	Creating the index 03/09/2025, 08:17:33
2025-03-09 08:17:33,007 [INFO]: 		-> Instanciate the index HNSW15 03/09/2025, 08:17:33
2025-03-09 08:17:33,009 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0018 secs
2025-03-09 08:17:33,009 [INFO]: 		-> Adding the vectors to the index 03/09/2025, 08:17:33
2025-03-09 08:17:33,009 [INFO]: The memory available for adding the vectors is 49.3GB(total available - used by the index)
2025-03-09 08:17:33,010 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/16 [00:00<?, ?it/s]  6%|▋         | 1/16 [00:00<00:02,  5.45it/s] 12%|█▎        | 2/16 [00:00<00:02,  6.99it/s] 19%|█▉        | 3/16 [00:00<00:01,  7.67it/s] 25%|██▌       | 4/16 [00:00<00:01,  6.94it/s] 31%|███▏      | 5/16 [00:00<00:01,  7.10it/s] 38%|███▊      | 6/16 [00:00<00:01,  7.61it/s] 44%|████▍     | 7/16 [00:00<00:01,  7.93it/s] 50%|█████     | 8/16 [00:01<00:01,  7.50it/s] 56%|█████▋    | 9/16 [00:01<00:00,  7.36it/s] 62%|██████▎   | 10/16 [00:01<00:00,  7.80it/s] 69%|██████▉   | 11/16 [00:01<00:00,  8.19it/s] 75%|███████▌  | 12/16 [00:01<00:00,  8.27it/s] 81%|████████▏ | 13/16 [00:01<00:00,  7.52it/s] 88%|████████▊ | 14/16 [00:01<00:00,  7.94it/s] 94%|█████████▍| 15/16 [00:01<00:00,  8.29it/s]100%|██████████| 16/16 [00:04<00:00,  1.06it/s]100%|██████████| 16/16 [00:04<00:00,  3.33it/s]
2025-03-09 08:17:37,813 [INFO]: 	Computing best hyperparameters for index knn.index 03/09/2025, 08:17:37
2025-03-09 08:18:11,774 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 33.9603 secs
2025-03-09 08:18:11,774 [INFO]: The best hyperparameters are: efSearch=187
2025-03-09 08:18:11,774 [INFO]: 	Compute fast metrics 03/09/2025, 08:18:11
  0%|          | 0/4 [00:00<?, ?it/s] 25%|██▌       | 1/4 [00:00<00:00,  6.95it/s] 75%|███████▌  | 3/4 [00:00<00:00, 12.68it/s] 75%|███████▌  | 3/4 [00:00<00:00,  9.75it/s]
2025-03-09 08:18:26,931 [INFO]: 	>>> Finished "Compute fast metrics" in 15.1563 secs
2025-03-09 08:18:26,933 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 53.9238 secs
2025-03-09 08:18:26,933 [INFO]: {
2025-03-09 08:18:26,933 [INFO]: 	index_key: HNSW15
2025-03-09 08:18:26,933 [INFO]: 	index_param: efSearch=187
2025-03-09 08:18:26,933 [INFO]: 	index_path: knn.index
2025-03-09 08:18:26,933 [INFO]: 	size in bytes: 755496850
2025-03-09 08:18:26,933 [INFO]: 	avg_search_speed_ms: 8.880448785484777
2025-03-09 08:18:26,933 [INFO]: 	99p_search_speed_ms: 13.26817343942821
2025-03-09 08:18:26,933 [INFO]: 	reconstruction error %: 0.0
2025-03-09 08:18:26,933 [INFO]: 	nb vectors: 3840
2025-03-09 08:18:26,933 [INFO]: 	vectors dimension: 49152
2025-03-09 08:18:26,933 [INFO]: 	compression ratio: 0.9993088918901515
2025-03-09 08:18:26,933 [INFO]: }
2025-03-09 08:18:26,934 [INFO]: 	>>> Finished "Creating the index" in 53.9263 secs
2025-03-09 08:18:26,934 [INFO]: >>> Finished "Launching the whole pipeline" in 53.9642 secs
2025-03-09 08:18:27: [retrieval_preprocessing] calculating distances ...
2025-03-09 08:18:28: [retrieval_preprocessing] finished and saved retrieval indices for episode 19046 [episode count 15/20]
[retrieval_preprocessing] for episode 2152 [episode count 16/20], we have num_retrieval=np.int64(3834) num_query=np.int64(197)
2025-03-09 08:18:29,504 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-09 08:18:30,224 [INFO]: Launching the whole pipeline 03/09/2025, 08:18:30
2025-03-09 08:18:30,224 [INFO]: Reading total number of vectors and dimension 03/09/2025, 08:18:30
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 2107.69it/s]
2025-03-09 08:18:30,248 [INFO]: There are 3834 embeddings of dim 49152
2025-03-09 08:18:30,248 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0241 secs
2025-03-09 08:18:30,248 [INFO]: 	Compute estimated construction time of the index 03/09/2025, 08:18:30
2025-03-09 08:18:30,249 [INFO]: 		-> Train: 16.7 minutes
2025-03-09 08:18:30,249 [INFO]: 		-> Add: 2.1 seconds
2025-03-09 08:18:30,249 [INFO]: 		Total: 16.7 minutes
2025-03-09 08:18:30,249 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0001 secs
2025-03-09 08:18:30,249 [INFO]: 	Checking that your have enough memory available to create the index 03/09/2025, 08:18:30
2025-03-09 08:18:30,249 [INFO]: 791.2MB of memory will be needed to build the index (more might be used if you have more)
2025-03-09 08:18:30,249 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0002 secs
2025-03-09 08:18:30,249 [INFO]: 	Selecting most promising index types given data characteristics 03/09/2025, 08:18:30
2025-03-09 08:18:30,249 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-09 08:18:30,249 [INFO]: 	Creating the index 03/09/2025, 08:18:30
2025-03-09 08:18:30,249 [INFO]: 		-> Instanciate the index HNSW15 03/09/2025, 08:18:30
2025-03-09 08:18:30,250 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0010 secs
2025-03-09 08:18:30,250 [INFO]: 		-> Adding the vectors to the index 03/09/2025, 08:18:30
2025-03-09 08:18:30,250 [INFO]: The memory available for adding the vectors is 49.3GB(total available - used by the index)
2025-03-09 08:18:30,250 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/16 [00:00<?, ?it/s]  6%|▋         | 1/16 [00:00<00:02,  5.83it/s] 19%|█▉        | 3/16 [00:00<00:01,  9.80it/s] 31%|███▏      | 5/16 [00:00<00:00, 11.04it/s] 44%|████▍     | 7/16 [00:00<00:00, 11.51it/s] 56%|█████▋    | 9/16 [00:00<00:00, 11.99it/s] 69%|██████▉   | 11/16 [00:00<00:00, 12.32it/s] 81%|████████▏ | 13/16 [00:01<00:00, 12.53it/s] 94%|█████████▍| 15/16 [00:01<00:00, 12.76it/s]100%|██████████| 16/16 [00:04<00:00,  3.83it/s]
2025-03-09 08:18:34,434 [INFO]: 	Computing best hyperparameters for index knn.index 03/09/2025, 08:18:34
2025-03-09 08:19:12,930 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 38.4951 secs
2025-03-09 08:19:12,930 [INFO]: The best hyperparameters are: efSearch=200
2025-03-09 08:19:12,930 [INFO]: 	Compute fast metrics 03/09/2025, 08:19:12
  0%|          | 0/4 [00:00<?, ?it/s] 25%|██▌       | 1/4 [00:00<00:00,  5.32it/s] 50%|█████     | 2/4 [00:00<00:00,  7.04it/s] 75%|███████▌  | 3/4 [00:00<00:00,  7.61it/s] 75%|███████▌  | 3/4 [00:00<00:00,  5.70it/s]
2025-03-09 08:19:33,684 [INFO]: 	>>> Finished "Compute fast metrics" in 20.7544 secs
2025-03-09 08:19:33,687 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 63.4365 secs
2025-03-09 08:19:33,687 [INFO]: {
2025-03-09 08:19:33,687 [INFO]: 	index_key: HNSW15
2025-03-09 08:19:33,687 [INFO]: 	index_param: efSearch=200
2025-03-09 08:19:33,687 [INFO]: 	index_path: knn.index
2025-03-09 08:19:33,687 [INFO]: 	size in bytes: 754316410
2025-03-09 08:19:33,687 [INFO]: 	avg_search_speed_ms: 10.261168690541616
2025-03-09 08:19:33,687 [INFO]: 	99p_search_speed_ms: 19.572671223431826
2025-03-09 08:19:33,687 [INFO]: 	reconstruction error %: 0.0
2025-03-09 08:19:33,687 [INFO]: 	nb vectors: 3834
2025-03-09 08:19:33,687 [INFO]: 	vectors dimension: 49152
2025-03-09 08:19:33,687 [INFO]: 	compression ratio: 0.9993088603229512
2025-03-09 08:19:33,687 [INFO]: }
2025-03-09 08:19:33,687 [INFO]: 	>>> Finished "Creating the index" in 63.4380 secs
2025-03-09 08:19:33,687 [INFO]: >>> Finished "Launching the whole pipeline" in 63.4629 secs
2025-03-09 08:19:34: [retrieval_preprocessing] calculating distances ...
2025-03-09 08:19:35: [retrieval_preprocessing] finished and saved retrieval indices for episode 2152 [episode count 16/20]
[retrieval_preprocessing] for episode 90216 [episode count 17/20], we have num_retrieval=np.int64(3892) num_query=np.int64(139)
2025-03-09 08:19:36,164 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-09 08:19:36,652 [INFO]: Launching the whole pipeline 03/09/2025, 08:19:36
2025-03-09 08:19:36,652 [INFO]: Reading total number of vectors and dimension 03/09/2025, 08:19:36
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 2257.43it/s]
2025-03-09 08:19:36,675 [INFO]: There are 3892 embeddings of dim 49152
2025-03-09 08:19:36,676 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0233 secs
2025-03-09 08:19:36,676 [INFO]: 	Compute estimated construction time of the index 03/09/2025, 08:19:36
2025-03-09 08:19:36,676 [INFO]: 		-> Train: 16.7 minutes
2025-03-09 08:19:36,676 [INFO]: 		-> Add: 2.1 seconds
2025-03-09 08:19:36,676 [INFO]: 		Total: 16.7 minutes
2025-03-09 08:19:36,676 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0002 secs
2025-03-09 08:19:36,676 [INFO]: 	Checking that your have enough memory available to create the index 03/09/2025, 08:19:36
2025-03-09 08:19:36,676 [INFO]: 803.2MB of memory will be needed to build the index (more might be used if you have more)
2025-03-09 08:19:36,676 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0001 secs
2025-03-09 08:19:36,676 [INFO]: 	Selecting most promising index types given data characteristics 03/09/2025, 08:19:36
2025-03-09 08:19:36,676 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-09 08:19:36,676 [INFO]: 	Creating the index 03/09/2025, 08:19:36
2025-03-09 08:19:36,676 [INFO]: 		-> Instanciate the index HNSW15 03/09/2025, 08:19:36
2025-03-09 08:19:36,677 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0010 secs
2025-03-09 08:19:36,677 [INFO]: 		-> Adding the vectors to the index 03/09/2025, 08:19:36
2025-03-09 08:19:36,677 [INFO]: The memory available for adding the vectors is 49.3GB(total available - used by the index)
2025-03-09 08:19:36,677 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/16 [00:00<?, ?it/s]  6%|▋         | 1/16 [00:00<00:02,  5.17it/s] 12%|█▎        | 2/16 [00:00<00:02,  6.91it/s] 19%|█▉        | 3/16 [00:00<00:01,  7.75it/s] 25%|██▌       | 4/16 [00:00<00:01,  8.01it/s] 31%|███▏      | 5/16 [00:00<00:01,  8.15it/s] 38%|███▊      | 6/16 [00:00<00:01,  8.22it/s] 44%|████▍     | 7/16 [00:00<00:01,  8.24it/s] 50%|█████     | 8/16 [00:01<00:00,  8.32it/s] 56%|█████▋    | 9/16 [00:01<00:00,  8.24it/s] 62%|██████▎   | 10/16 [00:01<00:00,  8.20it/s] 69%|██████▉   | 11/16 [00:01<00:00,  8.26it/s] 75%|███████▌  | 12/16 [00:01<00:00,  8.35it/s] 81%|████████▏ | 13/16 [00:01<00:00,  8.39it/s] 88%|████████▊ | 14/16 [00:01<00:00,  8.50it/s] 94%|█████████▍| 15/16 [00:01<00:00,  8.48it/s]100%|██████████| 16/16 [00:05<00:00,  1.09s/it]100%|██████████| 16/16 [00:05<00:00,  3.09it/s]
2025-03-09 08:19:41,862 [INFO]: 	Computing best hyperparameters for index knn.index 03/09/2025, 08:19:41
2025-03-09 08:20:19,690 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 37.8273 secs
2025-03-09 08:20:19,690 [INFO]: The best hyperparameters are: efSearch=218
2025-03-09 08:20:19,691 [INFO]: 	Compute fast metrics 03/09/2025, 08:20:19
  0%|          | 0/4 [00:00<?, ?it/s] 25%|██▌       | 1/4 [00:00<00:00,  5.44it/s] 50%|█████     | 2/4 [00:00<00:00,  7.03it/s] 75%|███████▌  | 3/4 [00:00<00:00,  7.88it/s] 75%|███████▌  | 3/4 [00:00<00:00,  5.86it/s]
2025-03-09 08:20:40,028 [INFO]: 	>>> Finished "Compute fast metrics" in 20.3377 secs
2025-03-09 08:20:40,031 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 63.3541 secs
2025-03-09 08:20:40,032 [INFO]: {
2025-03-09 08:20:40,032 [INFO]: 	index_key: HNSW15
2025-03-09 08:20:40,032 [INFO]: 	index_param: efSearch=218
2025-03-09 08:20:40,032 [INFO]: 	index_path: knn.index
2025-03-09 08:20:40,032 [INFO]: 	size in bytes: 765727630
2025-03-09 08:20:40,032 [INFO]: 	avg_search_speed_ms: 10.41335139630031
2025-03-09 08:20:40,032 [INFO]: 	99p_search_speed_ms: 19.255986390635346
2025-03-09 08:20:40,032 [INFO]: 	reconstruction error %: 0.0
2025-03-09 08:20:40,032 [INFO]: 	nb vectors: 3892
2025-03-09 08:20:40,032 [INFO]: 	vectors dimension: 49152
2025-03-09 08:20:40,032 [INFO]: 	compression ratio: 0.9993087698820532
2025-03-09 08:20:40,032 [INFO]: }
2025-03-09 08:20:40,032 [INFO]: 	>>> Finished "Creating the index" in 63.3556 secs
2025-03-09 08:20:40,032 [INFO]: >>> Finished "Launching the whole pipeline" in 63.3796 secs
2025-03-09 08:20:40: [retrieval_preprocessing] calculating distances ...
2025-03-09 08:20:41: [retrieval_preprocessing] finished and saved retrieval indices for episode 90216 [episode count 17/20]
[retrieval_preprocessing] for episode 24682 [episode count 18/20], we have num_retrieval=np.int64(3857) num_query=np.int64(174)
2025-03-09 08:20:42,807 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-09 08:20:43,577 [INFO]: Launching the whole pipeline 03/09/2025, 08:20:43
2025-03-09 08:20:43,577 [INFO]: Reading total number of vectors and dimension 03/09/2025, 08:20:43
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1099.42it/s]
2025-03-09 08:20:43,610 [INFO]: There are 3857 embeddings of dim 49152
2025-03-09 08:20:43,610 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0331 secs
2025-03-09 08:20:43,610 [INFO]: 	Compute estimated construction time of the index 03/09/2025, 08:20:43
2025-03-09 08:20:43,610 [INFO]: 		-> Train: 16.7 minutes
2025-03-09 08:20:43,610 [INFO]: 		-> Add: 2.1 seconds
2025-03-09 08:20:43,610 [INFO]: 		Total: 16.7 minutes
2025-03-09 08:20:43,610 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0002 secs
2025-03-09 08:20:43,610 [INFO]: 	Checking that your have enough memory available to create the index 03/09/2025, 08:20:43
2025-03-09 08:20:43,610 [INFO]: 796.0MB of memory will be needed to build the index (more might be used if you have more)
2025-03-09 08:20:43,611 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0002 secs
2025-03-09 08:20:43,611 [INFO]: 	Selecting most promising index types given data characteristics 03/09/2025, 08:20:43
2025-03-09 08:20:43,611 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-09 08:20:43,611 [INFO]: 	Creating the index 03/09/2025, 08:20:43
2025-03-09 08:20:43,611 [INFO]: 		-> Instanciate the index HNSW15 03/09/2025, 08:20:43
2025-03-09 08:20:43,613 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0021 secs
2025-03-09 08:20:43,613 [INFO]: 		-> Adding the vectors to the index 03/09/2025, 08:20:43
2025-03-09 08:20:43,613 [INFO]: The memory available for adding the vectors is 49.3GB(total available - used by the index)
2025-03-09 08:20:43,613 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/16 [00:00<?, ?it/s]  6%|▋         | 1/16 [00:00<00:02,  5.57it/s] 12%|█▎        | 2/16 [00:00<00:01,  7.15it/s] 19%|█▉        | 3/16 [00:00<00:01,  7.96it/s] 25%|██▌       | 4/16 [00:00<00:01,  8.24it/s] 31%|███▏      | 5/16 [00:00<00:01,  8.33it/s] 38%|███▊      | 6/16 [00:00<00:01,  8.47it/s] 44%|████▍     | 7/16 [00:00<00:01,  8.62it/s] 50%|█████     | 8/16 [00:00<00:00,  8.81it/s] 56%|█████▋    | 9/16 [00:01<00:00,  8.75it/s] 62%|██████▎   | 10/16 [00:01<00:00,  8.79it/s] 69%|██████▉   | 11/16 [00:01<00:00,  8.78it/s] 75%|███████▌  | 12/16 [00:01<00:00,  8.75it/s] 81%|████████▏ | 13/16 [00:01<00:00,  8.74it/s] 88%|████████▊ | 14/16 [00:01<00:00,  8.83it/s] 94%|█████████▍| 15/16 [00:01<00:00,  8.98it/s]100%|██████████| 16/16 [00:04<00:00,  1.10it/s]100%|██████████| 16/16 [00:04<00:00,  3.53it/s]
2025-03-09 08:20:48,149 [INFO]: 	Computing best hyperparameters for index knn.index 03/09/2025, 08:20:48
2025-03-09 08:21:25,895 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 37.7454 secs
2025-03-09 08:21:25,895 [INFO]: The best hyperparameters are: efSearch=193
2025-03-09 08:21:25,895 [INFO]: 	Compute fast metrics 03/09/2025, 08:21:25
  0%|          | 0/4 [00:00<?, ?it/s] 25%|██▌       | 1/4 [00:00<00:00,  6.10it/s] 75%|███████▌  | 3/4 [00:00<00:00, 10.80it/s] 75%|███████▌  | 3/4 [00:00<00:00,  8.30it/s]
2025-03-09 08:21:41,945 [INFO]: 	>>> Finished "Compute fast metrics" in 16.0496 secs
2025-03-09 08:21:42,171 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 58.5575 secs
2025-03-09 08:21:42,172 [INFO]: {
2025-03-09 08:21:42,172 [INFO]: 	index_key: HNSW15
2025-03-09 08:21:42,172 [INFO]: 	index_param: efSearch=193
2025-03-09 08:21:42,172 [INFO]: 	index_path: knn.index
2025-03-09 08:21:42,172 [INFO]: 	size in bytes: 758841490
2025-03-09 08:21:42,172 [INFO]: 	avg_search_speed_ms: 9.77363736452471
2025-03-09 08:21:42,172 [INFO]: 	99p_search_speed_ms: 16.100220917724073
2025-03-09 08:21:42,172 [INFO]: 	reconstruction error %: 0.0
2025-03-09 08:21:42,172 [INFO]: 	nb vectors: 3857
2025-03-09 08:21:42,172 [INFO]: 	vectors dimension: 49152
2025-03-09 08:21:42,172 [INFO]: 	compression ratio: 0.9993089017839549
2025-03-09 08:21:42,172 [INFO]: }
2025-03-09 08:21:42,172 [INFO]: 	>>> Finished "Creating the index" in 58.5615 secs
2025-03-09 08:21:42,172 [INFO]: >>> Finished "Launching the whole pipeline" in 58.5957 secs
2025-03-09 08:21:42: [retrieval_preprocessing] calculating distances ...
2025-03-09 08:21:43: [retrieval_preprocessing] finished and saved retrieval indices for episode 24682 [episode count 18/20]
[retrieval_preprocessing] for episode 92268 [episode count 19/20], we have num_retrieval=np.int64(3825) num_query=np.int64(206)
2025-03-09 08:21:44,658 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-09 08:21:45,192 [INFO]: Launching the whole pipeline 03/09/2025, 08:21:45
2025-03-09 08:21:45,192 [INFO]: Reading total number of vectors and dimension 03/09/2025, 08:21:45
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 2284.48it/s]
2025-03-09 08:21:45,217 [INFO]: There are 3825 embeddings of dim 49152
2025-03-09 08:21:45,217 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0255 secs
2025-03-09 08:21:45,218 [INFO]: 	Compute estimated construction time of the index 03/09/2025, 08:21:45
2025-03-09 08:21:45,218 [INFO]: 		-> Train: 16.7 minutes
2025-03-09 08:21:45,218 [INFO]: 		-> Add: 2.1 seconds
2025-03-09 08:21:45,218 [INFO]: 		Total: 16.7 minutes
2025-03-09 08:21:45,218 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0003 secs
2025-03-09 08:21:45,218 [INFO]: 	Checking that your have enough memory available to create the index 03/09/2025, 08:21:45
2025-03-09 08:21:45,218 [INFO]: 789.4MB of memory will be needed to build the index (more might be used if you have more)
2025-03-09 08:21:45,219 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0004 secs
2025-03-09 08:21:45,219 [INFO]: 	Selecting most promising index types given data characteristics 03/09/2025, 08:21:45
2025-03-09 08:21:45,219 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-09 08:21:45,219 [INFO]: 	Creating the index 03/09/2025, 08:21:45
2025-03-09 08:21:45,219 [INFO]: 		-> Instanciate the index HNSW15 03/09/2025, 08:21:45
2025-03-09 08:21:45,222 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0026 secs
2025-03-09 08:21:45,222 [INFO]: 		-> Adding the vectors to the index 03/09/2025, 08:21:45
2025-03-09 08:21:45,222 [INFO]: The memory available for adding the vectors is 49.3GB(total available - used by the index)
2025-03-09 08:21:45,222 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/16 [00:00<?, ?it/s]  6%|▋         | 1/16 [00:00<00:02,  5.34it/s] 12%|█▎        | 2/16 [00:00<00:01,  7.03it/s] 19%|█▉        | 3/16 [00:00<00:01,  7.74it/s] 25%|██▌       | 4/16 [00:00<00:01,  8.11it/s] 31%|███▏      | 5/16 [00:00<00:01,  8.32it/s] 38%|███▊      | 6/16 [00:00<00:01,  8.43it/s] 44%|████▍     | 7/16 [00:00<00:01,  8.70it/s] 50%|█████     | 8/16 [00:00<00:00,  8.64it/s] 56%|█████▋    | 9/16 [00:01<00:00,  8.61it/s] 62%|██████▎   | 10/16 [00:01<00:00,  8.71it/s] 69%|██████▉   | 11/16 [00:01<00:00,  8.76it/s] 75%|███████▌  | 12/16 [00:01<00:00,  8.42it/s] 81%|████████▏ | 13/16 [00:01<00:00,  8.65it/s] 88%|████████▊ | 14/16 [00:01<00:00,  8.41it/s] 94%|█████████▍| 15/16 [00:01<00:00,  8.50it/s]100%|██████████| 16/16 [00:04<00:00,  1.09it/s]100%|██████████| 16/16 [00:04<00:00,  3.50it/s]
2025-03-09 08:21:49,795 [INFO]: 	Computing best hyperparameters for index knn.index 03/09/2025, 08:21:49
2025-03-09 08:22:29,490 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 39.6952 secs
2025-03-09 08:22:29,491 [INFO]: The best hyperparameters are: efSearch=165
2025-03-09 08:22:29,491 [INFO]: 	Compute fast metrics 03/09/2025, 08:22:29
  0%|          | 0/4 [00:00<?, ?it/s] 25%|██▌       | 1/4 [00:00<00:00,  5.84it/s] 50%|█████     | 2/4 [00:00<00:00,  7.48it/s] 75%|███████▌  | 3/4 [00:00<00:00,  8.08it/s] 75%|███████▌  | 3/4 [00:00<00:00,  6.09it/s]
2025-03-09 08:22:48,671 [INFO]: 	>>> Finished "Compute fast metrics" in 19.1803 secs
2025-03-09 08:22:48,674 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 63.4519 secs
2025-03-09 08:22:48,674 [INFO]: {
2025-03-09 08:22:48,674 [INFO]: 	index_key: HNSW15
2025-03-09 08:22:48,674 [INFO]: 	index_param: efSearch=165
2025-03-09 08:22:48,674 [INFO]: 	index_path: knn.index
2025-03-09 08:22:48,674 [INFO]: 	size in bytes: 752545570
2025-03-09 08:22:48,674 [INFO]: 	avg_search_speed_ms: 9.930386897703668
2025-03-09 08:22:48,674 [INFO]: 	99p_search_speed_ms: 19.528338550589957
2025-03-09 08:22:48,674 [INFO]: 	reconstruction error %: 0.0
2025-03-09 08:22:48,674 [INFO]: 	nb vectors: 3825
2025-03-09 08:22:48,674 [INFO]: 	vectors dimension: 49152
2025-03-09 08:22:48,674 [INFO]: 	compression ratio: 0.9993090518093144
2025-03-09 08:22:48,674 [INFO]: }
2025-03-09 08:22:48,674 [INFO]: 	>>> Finished "Creating the index" in 63.4553 secs
2025-03-09 08:22:48,674 [INFO]: >>> Finished "Launching the whole pipeline" in 63.4824 secs
2025-03-09 08:22:49: [retrieval_preprocessing] calculating distances ...
2025-03-09 08:22:49: [retrieval_preprocessing] finished and saved retrieval indices for episode 92268 [episode count 19/20]
2025-03-09 08:22:49: [retrieval_preprocessing] finished for (4345518188, 'cloth') [chosen_id count 3/10]
2025-03-09 08:22:53: [retrieval_preprocessing] concatenated all embeddings and indices for 20 episodes for (4545879864, 'marker') [chosen_id count 4/10]
2025-03-09 08:22:53: [retrieval_preprocessing] we have num_total=5075 embedding_dim=49152
[retrieval_preprocessing] for episode 33411 [episode count 0/20], we have num_retrieval=np.int64(4857) num_query=np.int64(218)
2025-03-09 08:22:53,511 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-09 08:22:55,026 [INFO]: Launching the whole pipeline 03/09/2025, 08:22:55
2025-03-09 08:22:55,026 [INFO]: Reading total number of vectors and dimension 03/09/2025, 08:22:55
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 997.93it/s]
2025-03-09 08:22:55,064 [INFO]: There are 4857 embeddings of dim 49152
2025-03-09 08:22:55,064 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0374 secs
2025-03-09 08:22:55,064 [INFO]: 	Compute estimated construction time of the index 03/09/2025, 08:22:55
2025-03-09 08:22:55,064 [INFO]: 		-> Train: 16.7 minutes
2025-03-09 08:22:55,064 [INFO]: 		-> Add: 2.7 seconds
2025-03-09 08:22:55,064 [INFO]: 		Total: 16.7 minutes
2025-03-09 08:22:55,064 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0002 secs
2025-03-09 08:22:55,064 [INFO]: 	Checking that your have enough memory available to create the index 03/09/2025, 08:22:55
2025-03-09 08:22:55,064 [INFO]: 1002.4MB of memory will be needed to build the index (more might be used if you have more)
2025-03-09 08:22:55,064 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0003 secs
2025-03-09 08:22:55,065 [INFO]: 	Selecting most promising index types given data characteristics 03/09/2025, 08:22:55
2025-03-09 08:22:55,065 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-09 08:22:55,065 [INFO]: 	Creating the index 03/09/2025, 08:22:55
2025-03-09 08:22:55,065 [INFO]: 		-> Instanciate the index HNSW15 03/09/2025, 08:22:55
2025-03-09 08:22:55,066 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0015 secs
2025-03-09 08:22:55,066 [INFO]: 		-> Adding the vectors to the index 03/09/2025, 08:22:55
2025-03-09 08:22:55,067 [INFO]: The memory available for adding the vectors is 49.1GB(total available - used by the index)
2025-03-09 08:22:55,067 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/20 [00:00<?, ?it/s]  5%|▌         | 1/20 [00:00<00:02,  7.95it/s] 35%|███▌      | 7/20 [00:00<00:00, 34.24it/s] 65%|██████▌   | 13/20 [00:00<00:00, 43.07it/s] 95%|█████████▌| 19/20 [00:00<00:00, 47.11it/s]100%|██████████| 20/20 [00:04<00:00,  4.44it/s]
2025-03-09 08:22:59,832 [INFO]: 	Computing best hyperparameters for index knn.index 03/09/2025, 08:22:59
2025-03-09 08:23:44,363 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 44.5308 secs
2025-03-09 08:23:44,364 [INFO]: The best hyperparameters are: efSearch=104
2025-03-09 08:23:44,364 [INFO]: 	Compute fast metrics 03/09/2025, 08:23:44
  0%|          | 0/4 [00:00<?, ?it/s] 25%|██▌       | 1/4 [00:00<00:00,  5.62it/s] 50%|█████     | 2/4 [00:00<00:00,  7.32it/s] 75%|███████▌  | 3/4 [00:00<00:00,  7.97it/s] 75%|███████▌  | 3/4 [00:00<00:00,  5.99it/s]
2025-03-09 08:24:05,714 [INFO]: 	>>> Finished "Compute fast metrics" in 21.3497 secs
2025-03-09 08:24:05,717 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 70.6509 secs
2025-03-09 08:24:05,718 [INFO]: {
2025-03-09 08:24:05,718 [INFO]: 	index_key: HNSW15
2025-03-09 08:24:05,718 [INFO]: 	index_param: efSearch=104
2025-03-09 08:24:05,718 [INFO]: 	index_path: knn.index
2025-03-09 08:24:05,718 [INFO]: 	size in bytes: 955585690
2025-03-09 08:24:05,718 [INFO]: 	avg_search_speed_ms: 5.814678073037675
2025-03-09 08:24:05,718 [INFO]: 	99p_search_speed_ms: 9.043083128053693
2025-03-09 08:24:05,718 [INFO]: 	reconstruction error %: 0.0
2025-03-09 08:24:05,718 [INFO]: 	nb vectors: 4857
2025-03-09 08:24:05,718 [INFO]: 	vectors dimension: 49152
2025-03-09 08:24:05,718 [INFO]: 	compression ratio: 0.9993086606393196
2025-03-09 08:24:05,718 [INFO]: }
2025-03-09 08:24:05,718 [INFO]: 	>>> Finished "Creating the index" in 70.6530 secs
2025-03-09 08:24:05,718 [INFO]: >>> Finished "Launching the whole pipeline" in 70.6914 secs
2025-03-09 08:24:06: [retrieval_preprocessing] calculating distances ...
2025-03-09 08:24:07: [retrieval_preprocessing] finished and saved retrieval indices for episode 33411 [episode count 0/20]
[retrieval_preprocessing] for episode 68100 [episode count 1/20], we have num_retrieval=np.int64(4844) num_query=np.int64(231)
2025-03-09 08:24:08,768 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-09 08:24:09,706 [INFO]: Launching the whole pipeline 03/09/2025, 08:24:09
2025-03-09 08:24:09,706 [INFO]: Reading total number of vectors and dimension 03/09/2025, 08:24:09
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1259.93it/s]
2025-03-09 08:24:09,748 [INFO]: There are 4844 embeddings of dim 49152
2025-03-09 08:24:09,749 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0420 secs
2025-03-09 08:24:09,749 [INFO]: 	Compute estimated construction time of the index 03/09/2025, 08:24:09
2025-03-09 08:24:09,749 [INFO]: 		-> Train: 16.7 minutes
2025-03-09 08:24:09,749 [INFO]: 		-> Add: 2.7 seconds
2025-03-09 08:24:09,749 [INFO]: 		Total: 16.7 minutes
2025-03-09 08:24:09,749 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0002 secs
2025-03-09 08:24:09,749 [INFO]: 	Checking that your have enough memory available to create the index 03/09/2025, 08:24:09
2025-03-09 08:24:09,750 [INFO]: 999.7MB of memory will be needed to build the index (more might be used if you have more)
2025-03-09 08:24:09,750 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0004 secs
2025-03-09 08:24:09,750 [INFO]: 	Selecting most promising index types given data characteristics 03/09/2025, 08:24:09
2025-03-09 08:24:09,750 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-09 08:24:09,750 [INFO]: 	Creating the index 03/09/2025, 08:24:09
2025-03-09 08:24:09,750 [INFO]: 		-> Instanciate the index HNSW15 03/09/2025, 08:24:09
2025-03-09 08:24:09,752 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0019 secs
2025-03-09 08:24:09,752 [INFO]: 		-> Adding the vectors to the index 03/09/2025, 08:24:09
2025-03-09 08:24:09,752 [INFO]: The memory available for adding the vectors is 49.1GB(total available - used by the index)
2025-03-09 08:24:09,753 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/20 [00:00<?, ?it/s]  5%|▌         | 1/20 [00:00<00:03,  5.70it/s] 10%|█         | 2/20 [00:00<00:02,  7.22it/s] 15%|█▌        | 3/20 [00:00<00:02,  7.90it/s] 20%|██        | 4/20 [00:00<00:01,  8.40it/s] 25%|██▌       | 5/20 [00:00<00:01,  8.70it/s] 30%|███       | 6/20 [00:00<00:01,  8.84it/s] 35%|███▌      | 7/20 [00:00<00:01,  8.72it/s] 40%|████      | 8/20 [00:00<00:01,  8.72it/s] 45%|████▌     | 9/20 [00:01<00:01,  9.00it/s] 50%|█████     | 10/20 [00:01<00:01,  9.17it/s] 55%|█████▌    | 11/20 [00:01<00:00,  9.12it/s] 60%|██████    | 12/20 [00:01<00:00,  9.04it/s] 65%|██████▌   | 13/20 [00:01<00:00,  9.00it/s] 70%|███████   | 14/20 [00:01<00:00,  9.01it/s] 75%|███████▌  | 15/20 [00:01<00:00,  8.85it/s] 80%|████████  | 16/20 [00:01<00:00,  8.73it/s] 85%|████████▌ | 17/20 [00:01<00:00,  8.62it/s] 90%|█████████ | 18/20 [00:02<00:00,  8.75it/s]100%|██████████| 20/20 [00:05<00:00,  1.12it/s]100%|██████████| 20/20 [00:05<00:00,  3.52it/s]
2025-03-09 08:24:15,433 [INFO]: 	Computing best hyperparameters for index knn.index 03/09/2025, 08:24:15
2025-03-09 08:25:07,451 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 52.0172 secs
2025-03-09 08:25:07,451 [INFO]: The best hyperparameters are: efSearch=202
2025-03-09 08:25:07,451 [INFO]: 	Compute fast metrics 03/09/2025, 08:25:07
  0%|          | 0/4 [00:00<?, ?it/s] 25%|██▌       | 1/4 [00:00<00:00,  5.70it/s] 50%|█████     | 2/4 [00:00<00:00,  7.49it/s] 75%|███████▌  | 3/4 [00:00<00:00,  8.22it/s] 75%|███████▌  | 3/4 [00:00<00:00,  6.10it/s]
2025-03-09 08:25:33,526 [INFO]: 	>>> Finished "Compute fast metrics" in 26.0748 secs
2025-03-09 08:25:33,530 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 83.7775 secs
2025-03-09 08:25:33,530 [INFO]: {
2025-03-09 08:25:33,530 [INFO]: 	index_key: HNSW15
2025-03-09 08:25:33,530 [INFO]: 	index_param: efSearch=202
2025-03-09 08:25:33,530 [INFO]: 	index_path: knn.index
2025-03-09 08:25:33,530 [INFO]: 	size in bytes: 953028070
2025-03-09 08:25:33,530 [INFO]: 	avg_search_speed_ms: 10.944920853116596
2025-03-09 08:25:33,530 [INFO]: 	99p_search_speed_ms: 20.18776491284371
2025-03-09 08:25:33,530 [INFO]: 	reconstruction error %: 0.0
2025-03-09 08:25:33,530 [INFO]: 	nb vectors: 4844
2025-03-09 08:25:33,530 [INFO]: 	vectors dimension: 49152
2025-03-09 08:25:33,530 [INFO]: 	compression ratio: 0.9993086058839799
2025-03-09 08:25:33,530 [INFO]: }
2025-03-09 08:25:33,530 [INFO]: 	>>> Finished "Creating the index" in 83.7803 secs
2025-03-09 08:25:33,530 [INFO]: >>> Finished "Launching the whole pipeline" in 83.8239 secs
2025-03-09 08:25:34: [retrieval_preprocessing] calculating distances ...
2025-03-09 08:25:35: [retrieval_preprocessing] finished and saved retrieval indices for episode 68100 [episode count 1/20]
[retrieval_preprocessing] for episode 95107 [episode count 2/20], we have num_retrieval=np.int64(4786) num_query=np.int64(289)
2025-03-09 08:25:37,706 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-09 08:25:38,604 [INFO]: Launching the whole pipeline 03/09/2025, 08:25:38
2025-03-09 08:25:38,604 [INFO]: Reading total number of vectors and dimension 03/09/2025, 08:25:38
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 978.83it/s]
2025-03-09 08:25:38,649 [INFO]: There are 4786 embeddings of dim 49152
2025-03-09 08:25:38,650 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0454 secs
2025-03-09 08:25:38,650 [INFO]: 	Compute estimated construction time of the index 03/09/2025, 08:25:38
2025-03-09 08:25:38,650 [INFO]: 		-> Train: 16.7 minutes
2025-03-09 08:25:38,651 [INFO]: 		-> Add: 2.6 seconds
2025-03-09 08:25:38,651 [INFO]: 		Total: 16.7 minutes
2025-03-09 08:25:38,651 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0011 secs
2025-03-09 08:25:38,651 [INFO]: 	Checking that your have enough memory available to create the index 03/09/2025, 08:25:38
2025-03-09 08:25:38,652 [INFO]: 987.7MB of memory will be needed to build the index (more might be used if you have more)
2025-03-09 08:25:38,652 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0006 secs
2025-03-09 08:25:38,652 [INFO]: 	Selecting most promising index types given data characteristics 03/09/2025, 08:25:38
2025-03-09 08:25:38,652 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-09 08:25:38,652 [INFO]: 	Creating the index 03/09/2025, 08:25:38
2025-03-09 08:25:38,653 [INFO]: 		-> Instanciate the index HNSW15 03/09/2025, 08:25:38
2025-03-09 08:25:38,657 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0039 secs
2025-03-09 08:25:38,657 [INFO]: 		-> Adding the vectors to the index 03/09/2025, 08:25:38
2025-03-09 08:25:38,657 [INFO]: The memory available for adding the vectors is 49.1GB(total available - used by the index)
2025-03-09 08:25:38,657 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/19 [00:00<?, ?it/s]  5%|▌         | 1/19 [00:00<00:01,  9.26it/s] 26%|██▋       | 5/19 [00:00<00:00, 25.66it/s] 47%|████▋     | 9/19 [00:00<00:00, 30.94it/s] 74%|███████▎  | 14/19 [00:00<00:00, 35.01it/s] 95%|█████████▍| 18/19 [00:00<00:00, 34.23it/s]100%|██████████| 19/19 [00:04<00:00,  4.18it/s]
2025-03-09 08:25:43,209 [INFO]: 	Computing best hyperparameters for index knn.index 03/09/2025, 08:25:43
2025-03-09 08:26:31,399 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 48.1901 secs
2025-03-09 08:26:31,400 [INFO]: The best hyperparameters are: efSearch=163
2025-03-09 08:26:31,400 [INFO]: 	Compute fast metrics 03/09/2025, 08:26:31
  0%|          | 0/4 [00:00<?, ?it/s] 25%|██▌       | 1/4 [00:00<00:00,  5.42it/s] 50%|█████     | 2/4 [00:00<00:00,  6.83it/s] 75%|███████▌  | 3/4 [00:00<00:00,  7.51it/s] 75%|███████▌  | 3/4 [00:00<00:00,  5.62it/s]
2025-03-09 08:26:50,575 [INFO]: 	>>> Finished "Compute fast metrics" in 19.1750 secs
2025-03-09 08:26:50,578 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 71.9209 secs
2025-03-09 08:26:50,578 [INFO]: {
2025-03-09 08:26:50,578 [INFO]: 	index_key: HNSW15
2025-03-09 08:26:50,578 [INFO]: 	index_param: efSearch=163
2025-03-09 08:26:50,578 [INFO]: 	index_path: knn.index
2025-03-09 08:26:50,578 [INFO]: 	size in bytes: 941616850
2025-03-09 08:26:50,578 [INFO]: 	avg_search_speed_ms: 10.861491389829467
2025-03-09 08:26:50,578 [INFO]: 	99p_search_speed_ms: 21.64272358641028
2025-03-09 08:26:50,578 [INFO]: 	reconstruction error %: 0.0
2025-03-09 08:26:50,578 [INFO]: 	nb vectors: 4786
2025-03-09 08:26:50,578 [INFO]: 	vectors dimension: 49152
2025-03-09 08:26:50,578 [INFO]: 	compression ratio: 0.9993086763474974
2025-03-09 08:26:50,578 [INFO]: }
2025-03-09 08:26:50,578 [INFO]: 	>>> Finished "Creating the index" in 71.9258 secs
2025-03-09 08:26:50,578 [INFO]: >>> Finished "Launching the whole pipeline" in 71.9743 secs
2025-03-09 08:26:51: [retrieval_preprocessing] calculating distances ...
2025-03-09 08:26:52: [retrieval_preprocessing] finished and saved retrieval indices for episode 95107 [episode count 2/20]
[retrieval_preprocessing] for episode 67463 [episode count 3/20], we have num_retrieval=np.int64(4830) num_query=np.int64(245)
2025-03-09 08:26:53,888 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-09 08:26:54,580 [INFO]: Launching the whole pipeline 03/09/2025, 08:26:54
2025-03-09 08:26:54,580 [INFO]: Reading total number of vectors and dimension 03/09/2025, 08:26:54
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1468.59it/s]
2025-03-09 08:26:54,604 [INFO]: There are 4830 embeddings of dim 49152
2025-03-09 08:26:54,604 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0245 secs
2025-03-09 08:26:54,604 [INFO]: 	Compute estimated construction time of the index 03/09/2025, 08:26:54
2025-03-09 08:26:54,604 [INFO]: 		-> Train: 16.7 minutes
2025-03-09 08:26:54,604 [INFO]: 		-> Add: 2.7 seconds
2025-03-09 08:26:54,604 [INFO]: 		Total: 16.7 minutes
2025-03-09 08:26:54,604 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0001 secs
2025-03-09 08:26:54,604 [INFO]: 	Checking that your have enough memory available to create the index 03/09/2025, 08:26:54
2025-03-09 08:26:54,605 [INFO]: 996.8MB of memory will be needed to build the index (more might be used if you have more)
2025-03-09 08:26:54,605 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0002 secs
2025-03-09 08:26:54,605 [INFO]: 	Selecting most promising index types given data characteristics 03/09/2025, 08:26:54
2025-03-09 08:26:54,605 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-09 08:26:54,605 [INFO]: 	Creating the index 03/09/2025, 08:26:54
2025-03-09 08:26:54,605 [INFO]: 		-> Instanciate the index HNSW15 03/09/2025, 08:26:54
2025-03-09 08:26:54,606 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0011 secs
2025-03-09 08:26:54,606 [INFO]: 		-> Adding the vectors to the index 03/09/2025, 08:26:54
2025-03-09 08:26:54,606 [INFO]: The memory available for adding the vectors is 49.1GB(total available - used by the index)
2025-03-09 08:26:54,606 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/20 [00:00<?, ?it/s]  5%|▌         | 1/20 [00:00<00:03,  5.41it/s] 15%|█▌        | 3/20 [00:00<00:01,  9.25it/s] 25%|██▌       | 5/20 [00:00<00:01, 10.70it/s] 35%|███▌      | 7/20 [00:00<00:01, 11.28it/s] 45%|████▌     | 9/20 [00:00<00:00, 11.66it/s] 55%|█████▌    | 11/20 [00:00<00:00, 11.96it/s] 65%|██████▌   | 13/20 [00:01<00:00, 12.23it/s] 75%|███████▌  | 15/20 [00:01<00:00, 12.26it/s] 85%|████████▌ | 17/20 [00:01<00:00, 12.38it/s] 95%|█████████▌| 19/20 [00:01<00:00, 12.43it/s]100%|██████████| 20/20 [00:05<00:00,  3.70it/s]
2025-03-09 08:27:00,008 [INFO]: 	Computing best hyperparameters for index knn.index 03/09/2025, 08:27:00
2025-03-09 08:27:44,957 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 44.9486 secs
2025-03-09 08:27:44,958 [INFO]: The best hyperparameters are: efSearch=209
2025-03-09 08:27:44,958 [INFO]: 	Compute fast metrics 03/09/2025, 08:27:44
  0%|          | 0/4 [00:00<?, ?it/s] 25%|██▌       | 1/4 [00:00<00:00,  5.89it/s] 50%|█████     | 2/4 [00:00<00:00,  7.53it/s] 75%|███████▌  | 3/4 [00:00<00:00,  8.07it/s] 75%|███████▌  | 3/4 [00:00<00:00,  6.03it/s]
2025-03-09 08:28:07,436 [INFO]: 	>>> Finished "Compute fast metrics" in 22.4781 secs
2025-03-09 08:28:07,440 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 72.8337 secs
2025-03-09 08:28:07,440 [INFO]: {
2025-03-09 08:28:07,440 [INFO]: 	index_key: HNSW15
2025-03-09 08:28:07,440 [INFO]: 	index_param: efSearch=209
2025-03-09 08:28:07,440 [INFO]: 	index_path: knn.index
2025-03-09 08:28:07,440 [INFO]: 	size in bytes: 950273650
2025-03-09 08:28:07,440 [INFO]: 	avg_search_speed_ms: 9.059667927879449
2025-03-09 08:28:07,440 [INFO]: 	99p_search_speed_ms: 15.482157382648438
2025-03-09 08:28:07,440 [INFO]: 	reconstruction error %: 0.0
2025-03-09 08:28:07,440 [INFO]: 	nb vectors: 4830
2025-03-09 08:28:07,440 [INFO]: 	vectors dimension: 49152
2025-03-09 08:28:07,440 [INFO]: 	compression ratio: 0.999308609683116
2025-03-09 08:28:07,440 [INFO]: }
2025-03-09 08:28:07,440 [INFO]: 	>>> Finished "Creating the index" in 72.8354 secs
2025-03-09 08:28:07,440 [INFO]: >>> Finished "Launching the whole pipeline" in 72.8604 secs
2025-03-09 08:28:08: [retrieval_preprocessing] calculating distances ...
2025-03-09 08:28:09: [retrieval_preprocessing] finished and saved retrieval indices for episode 67463 [episode count 3/20]
[retrieval_preprocessing] for episode 28682 [episode count 4/20], we have num_retrieval=np.int64(4551) num_query=np.int64(524)
2025-03-09 08:28:11,247 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-09 08:28:11,854 [INFO]: Launching the whole pipeline 03/09/2025, 08:28:11
2025-03-09 08:28:11,854 [INFO]: Reading total number of vectors and dimension 03/09/2025, 08:28:11
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1723.21it/s]
2025-03-09 08:28:11,886 [INFO]: There are 4551 embeddings of dim 49152
2025-03-09 08:28:11,887 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0329 secs
2025-03-09 08:28:11,887 [INFO]: 	Compute estimated construction time of the index 03/09/2025, 08:28:11
2025-03-09 08:28:11,887 [INFO]: 		-> Train: 16.7 minutes
2025-03-09 08:28:11,887 [INFO]: 		-> Add: 2.5 seconds
2025-03-09 08:28:11,887 [INFO]: 		Total: 16.7 minutes
2025-03-09 08:28:11,887 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0002 secs
2025-03-09 08:28:11,887 [INFO]: 	Checking that your have enough memory available to create the index 03/09/2025, 08:28:11
2025-03-09 08:28:11,887 [INFO]: 939.2MB of memory will be needed to build the index (more might be used if you have more)
2025-03-09 08:28:11,887 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0002 secs
2025-03-09 08:28:11,887 [INFO]: 	Selecting most promising index types given data characteristics 03/09/2025, 08:28:11
2025-03-09 08:28:11,887 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-09 08:28:11,887 [INFO]: 	Creating the index 03/09/2025, 08:28:11
2025-03-09 08:28:11,887 [INFO]: 		-> Instanciate the index HNSW15 03/09/2025, 08:28:11
2025-03-09 08:28:11,888 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0010 secs
2025-03-09 08:28:11,888 [INFO]: 		-> Adding the vectors to the index 03/09/2025, 08:28:11
2025-03-09 08:28:11,888 [INFO]: The memory available for adding the vectors is 49.2GB(total available - used by the index)
2025-03-09 08:28:11,888 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/18 [00:00<?, ?it/s]  6%|▌         | 1/18 [00:00<00:02,  6.17it/s] 17%|█▋        | 3/18 [00:00<00:01, 10.00it/s] 28%|██▊       | 5/18 [00:00<00:01, 11.37it/s] 39%|███▉      | 7/18 [00:00<00:00, 11.83it/s] 50%|█████     | 9/18 [00:00<00:00, 12.19it/s] 61%|██████    | 11/18 [00:00<00:00, 12.34it/s] 72%|███████▏  | 13/18 [00:01<00:00, 12.52it/s] 83%|████████▎ | 15/18 [00:01<00:00, 12.45it/s] 94%|█████████▍| 17/18 [00:01<00:00, 12.50it/s]100%|██████████| 18/18 [00:04<00:00,  3.64it/s]
2025-03-09 08:28:16,849 [INFO]: 	Computing best hyperparameters for index knn.index 03/09/2025, 08:28:16
2025-03-09 08:28:59,204 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 42.3538 secs
2025-03-09 08:28:59,204 [INFO]: The best hyperparameters are: efSearch=236
2025-03-09 08:28:59,204 [INFO]: 	Compute fast metrics 03/09/2025, 08:28:59
  0%|          | 0/4 [00:00<?, ?it/s] 25%|██▌       | 1/4 [00:00<00:00,  5.73it/s] 50%|█████     | 2/4 [00:00<00:00,  7.09it/s] 75%|███████▌  | 3/4 [00:00<00:00,  7.55it/s] 75%|███████▌  | 3/4 [00:00<00:00,  5.70it/s]
2025-03-09 08:29:15,027 [INFO]: 	>>> Finished "Compute fast metrics" in 15.8229 secs
2025-03-09 08:29:15,031 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 63.1423 secs
2025-03-09 08:29:15,031 [INFO]: {
2025-03-09 08:29:15,031 [INFO]: 	index_key: HNSW15
2025-03-09 08:29:15,031 [INFO]: 	index_param: efSearch=236
2025-03-09 08:29:15,031 [INFO]: 	index_path: knn.index
2025-03-09 08:29:15,031 [INFO]: 	size in bytes: 895381930
2025-03-09 08:29:15,031 [INFO]: 	avg_search_speed_ms: 9.518154492277429
2025-03-09 08:29:15,031 [INFO]: 	99p_search_speed_ms: 15.390926506370306
2025-03-09 08:29:15,031 [INFO]: 	reconstruction error %: 0.0
2025-03-09 08:29:15,031 [INFO]: 	nb vectors: 4551
2025-03-09 08:29:15,031 [INFO]: 	vectors dimension: 49152
2025-03-09 08:29:15,031 [INFO]: 	compression ratio: 0.999308762016227
2025-03-09 08:29:15,031 [INFO]: }
2025-03-09 08:29:15,031 [INFO]: 	>>> Finished "Creating the index" in 63.1438 secs
2025-03-09 08:29:15,031 [INFO]: >>> Finished "Launching the whole pipeline" in 63.1774 secs
2025-03-09 08:29:18: [retrieval_preprocessing] calculating distances ...
2025-03-09 08:29:20: [retrieval_preprocessing] finished and saved retrieval indices for episode 28682 [episode count 4/20]
[retrieval_preprocessing] for episode 7181 [episode count 5/20], we have num_retrieval=np.int64(4777) num_query=np.int64(298)
2025-03-09 08:29:22,027 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-09 08:29:22,803 [INFO]: Launching the whole pipeline 03/09/2025, 08:29:22
2025-03-09 08:29:22,803 [INFO]: Reading total number of vectors and dimension 03/09/2025, 08:29:22
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1774.99it/s]
2025-03-09 08:29:22,827 [INFO]: There are 4777 embeddings of dim 49152
2025-03-09 08:29:22,828 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0247 secs
2025-03-09 08:29:22,828 [INFO]: 	Compute estimated construction time of the index 03/09/2025, 08:29:22
2025-03-09 08:29:22,828 [INFO]: 		-> Train: 16.7 minutes
2025-03-09 08:29:22,828 [INFO]: 		-> Add: 2.6 seconds
2025-03-09 08:29:22,828 [INFO]: 		Total: 16.7 minutes
2025-03-09 08:29:22,828 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0001 secs
2025-03-09 08:29:22,828 [INFO]: 	Checking that your have enough memory available to create the index 03/09/2025, 08:29:22
2025-03-09 08:29:22,828 [INFO]: 985.9MB of memory will be needed to build the index (more might be used if you have more)
2025-03-09 08:29:22,828 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0001 secs
2025-03-09 08:29:22,828 [INFO]: 	Selecting most promising index types given data characteristics 03/09/2025, 08:29:22
2025-03-09 08:29:22,828 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-09 08:29:22,828 [INFO]: 	Creating the index 03/09/2025, 08:29:22
2025-03-09 08:29:22,828 [INFO]: 		-> Instanciate the index HNSW15 03/09/2025, 08:29:22
2025-03-09 08:29:22,829 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0010 secs
2025-03-09 08:29:22,829 [INFO]: 		-> Adding the vectors to the index 03/09/2025, 08:29:22
2025-03-09 08:29:22,829 [INFO]: The memory available for adding the vectors is 49.1GB(total available - used by the index)
2025-03-09 08:29:22,830 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/19 [00:00<?, ?it/s]  5%|▌         | 1/19 [00:00<00:03,  5.90it/s] 16%|█▌        | 3/19 [00:00<00:01,  9.57it/s] 26%|██▋       | 5/19 [00:00<00:01, 10.71it/s] 37%|███▋      | 7/19 [00:00<00:01, 11.17it/s] 47%|████▋     | 9/19 [00:00<00:00, 11.72it/s] 58%|█████▊    | 11/19 [00:00<00:00, 12.09it/s] 68%|██████▊   | 13/19 [00:01<00:00, 12.12it/s] 79%|███████▉  | 15/19 [00:01<00:00, 12.25it/s] 89%|████████▉ | 17/19 [00:01<00:00, 12.48it/s]100%|██████████| 19/19 [00:05<00:00,  1.63it/s]100%|██████████| 19/19 [00:05<00:00,  3.76it/s]
2025-03-09 08:29:27,888 [INFO]: 	Computing best hyperparameters for index knn.index 03/09/2025, 08:29:27
2025-03-09 08:30:12,814 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 44.9257 secs
2025-03-09 08:30:12,814 [INFO]: The best hyperparameters are: efSearch=232
2025-03-09 08:30:12,815 [INFO]: 	Compute fast metrics 03/09/2025, 08:30:12
  0%|          | 0/4 [00:00<?, ?it/s] 75%|███████▌  | 3/4 [00:00<00:00, 25.87it/s] 75%|███████▌  | 3/4 [00:00<00:00, 22.54it/s]
2025-03-09 08:30:31,471 [INFO]: 	>>> Finished "Compute fast metrics" in 18.6560 secs
2025-03-09 08:30:31,474 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 68.6445 secs
2025-03-09 08:30:31,474 [INFO]: {
2025-03-09 08:30:31,474 [INFO]: 	index_key: HNSW15
2025-03-09 08:30:31,474 [INFO]: 	index_param: efSearch=232
2025-03-09 08:30:31,474 [INFO]: 	index_path: knn.index
2025-03-09 08:30:31,474 [INFO]: 	size in bytes: 939846190
2025-03-09 08:30:31,474 [INFO]: 	avg_search_speed_ms: 9.91434014468787
2025-03-09 08:30:31,474 [INFO]: 	99p_search_speed_ms: 19.062704388052225
2025-03-09 08:30:31,474 [INFO]: 	reconstruction error %: 0.0
2025-03-09 08:30:31,474 [INFO]: 	nb vectors: 4777
2025-03-09 08:30:31,474 [INFO]: 	vectors dimension: 49152
2025-03-09 08:30:31,474 [INFO]: 	compression ratio: 0.9993086379378736
2025-03-09 08:30:31,474 [INFO]: }
2025-03-09 08:30:31,474 [INFO]: 	>>> Finished "Creating the index" in 68.6461 secs
2025-03-09 08:30:31,474 [INFO]: >>> Finished "Launching the whole pipeline" in 68.6713 secs
2025-03-09 08:30:33: [retrieval_preprocessing] calculating distances ...
2025-03-09 08:30:34: [retrieval_preprocessing] finished and saved retrieval indices for episode 7181 [episode count 5/20]
[retrieval_preprocessing] for episode 27037 [episode count 6/20], we have num_retrieval=np.int64(4877) num_query=np.int64(198)
2025-03-09 08:30:35,692 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-09 08:30:36,360 [INFO]: Launching the whole pipeline 03/09/2025, 08:30:36
2025-03-09 08:30:36,360 [INFO]: Reading total number of vectors and dimension 03/09/2025, 08:30:36
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1160.57it/s]
2025-03-09 08:30:36,390 [INFO]: There are 4877 embeddings of dim 49152
2025-03-09 08:30:36,390 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0295 secs
2025-03-09 08:30:36,390 [INFO]: 	Compute estimated construction time of the index 03/09/2025, 08:30:36
2025-03-09 08:30:36,390 [INFO]: 		-> Train: 16.7 minutes
2025-03-09 08:30:36,390 [INFO]: 		-> Add: 2.7 seconds
2025-03-09 08:30:36,390 [INFO]: 		Total: 16.7 minutes
2025-03-09 08:30:36,390 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0001 secs
2025-03-09 08:30:36,390 [INFO]: 	Checking that your have enough memory available to create the index 03/09/2025, 08:30:36
2025-03-09 08:30:36,390 [INFO]: 1006.5MB of memory will be needed to build the index (more might be used if you have more)
2025-03-09 08:30:36,390 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0001 secs
2025-03-09 08:30:36,390 [INFO]: 	Selecting most promising index types given data characteristics 03/09/2025, 08:30:36
2025-03-09 08:30:36,390 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-09 08:30:36,390 [INFO]: 	Creating the index 03/09/2025, 08:30:36
2025-03-09 08:30:36,390 [INFO]: 		-> Instanciate the index HNSW15 03/09/2025, 08:30:36
2025-03-09 08:30:36,391 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0010 secs
2025-03-09 08:30:36,392 [INFO]: 		-> Adding the vectors to the index 03/09/2025, 08:30:36
2025-03-09 08:30:36,392 [INFO]: The memory available for adding the vectors is 49.1GB(total available - used by the index)
2025-03-09 08:30:36,392 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/20 [00:00<?, ?it/s]  5%|▌         | 1/20 [00:00<00:03,  5.23it/s] 15%|█▌        | 3/20 [00:00<00:02,  8.09it/s] 25%|██▌       | 5/20 [00:00<00:01,  9.37it/s] 30%|███       | 6/20 [00:00<00:01,  9.37it/s] 35%|███▌      | 7/20 [00:00<00:01,  9.27it/s] 40%|████      | 8/20 [00:00<00:01,  9.21it/s] 45%|████▌     | 9/20 [00:01<00:01,  9.11it/s] 50%|█████     | 10/20 [00:01<00:01,  9.07it/s] 55%|█████▌    | 11/20 [00:01<00:01,  8.91it/s] 60%|██████    | 12/20 [00:01<00:00,  8.89it/s] 65%|██████▌   | 13/20 [00:01<00:00,  8.87it/s] 70%|███████   | 14/20 [00:01<00:00,  8.78it/s] 75%|███████▌  | 15/20 [00:01<00:00,  8.72it/s] 80%|████████  | 16/20 [00:01<00:00,  8.59it/s] 85%|████████▌ | 17/20 [00:01<00:00,  8.53it/s] 95%|█████████▌| 19/20 [00:02<00:00,  9.76it/s]100%|██████████| 20/20 [00:05<00:00,  1.05it/s]100%|██████████| 20/20 [00:05<00:00,  3.55it/s]
2025-03-09 08:30:42,024 [INFO]: 	Computing best hyperparameters for index knn.index 03/09/2025, 08:30:42
2025-03-09 08:31:21,498 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 39.4736 secs
2025-03-09 08:31:21,498 [INFO]: The best hyperparameters are: efSearch=200
2025-03-09 08:31:21,498 [INFO]: 	Compute fast metrics 03/09/2025, 08:31:21
  0%|          | 0/4 [00:00<?, ?it/s] 25%|██▌       | 1/4 [00:00<00:00,  5.61it/s] 75%|███████▌  | 3/4 [00:00<00:00,  9.31it/s] 75%|███████▌  | 3/4 [00:00<00:00,  7.18it/s]
2025-03-09 08:31:37,334 [INFO]: 	>>> Finished "Compute fast metrics" in 15.8356 secs
2025-03-09 08:31:37,338 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 60.9462 secs
2025-03-09 08:31:37,338 [INFO]: {
2025-03-09 08:31:37,338 [INFO]: 	index_key: HNSW15
2025-03-09 08:31:37,338 [INFO]: 	index_param: efSearch=200
2025-03-09 08:31:37,338 [INFO]: 	index_path: knn.index
2025-03-09 08:31:37,338 [INFO]: 	size in bytes: 959520550
2025-03-09 08:31:37,338 [INFO]: 	avg_search_speed_ms: 9.123245501422145
2025-03-09 08:31:37,338 [INFO]: 	99p_search_speed_ms: 16.98953497223556
2025-03-09 08:31:37,338 [INFO]: 	reconstruction error %: 0.0
2025-03-09 08:31:37,338 [INFO]: 	nb vectors: 4877
2025-03-09 08:31:37,338 [INFO]: 	vectors dimension: 49152
2025-03-09 08:31:37,338 [INFO]: 	compression ratio: 0.9993086818203112
2025-03-09 08:31:37,338 [INFO]: }
2025-03-09 08:31:37,338 [INFO]: 	>>> Finished "Creating the index" in 60.9480 secs
2025-03-09 08:31:37,338 [INFO]: >>> Finished "Launching the whole pipeline" in 60.9781 secs
2025-03-09 08:31:38: [retrieval_preprocessing] calculating distances ...
2025-03-09 08:31:39: [retrieval_preprocessing] finished and saved retrieval indices for episode 27037 [episode count 6/20]
[retrieval_preprocessing] for episode 11553 [episode count 7/20], we have num_retrieval=np.int64(4885) num_query=np.int64(190)
2025-03-09 08:31:40,536 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-09 08:31:41,199 [INFO]: Launching the whole pipeline 03/09/2025, 08:31:41
2025-03-09 08:31:41,200 [INFO]: Reading total number of vectors and dimension 03/09/2025, 08:31:41
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1463.47it/s]
2025-03-09 08:31:41,227 [INFO]: There are 4885 embeddings of dim 49152
2025-03-09 08:31:41,227 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0276 secs
2025-03-09 08:31:41,227 [INFO]: 	Compute estimated construction time of the index 03/09/2025, 08:31:41
2025-03-09 08:31:41,227 [INFO]: 		-> Train: 16.7 minutes
2025-03-09 08:31:41,227 [INFO]: 		-> Add: 2.7 seconds
2025-03-09 08:31:41,227 [INFO]: 		Total: 16.7 minutes
2025-03-09 08:31:41,227 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0001 secs
2025-03-09 08:31:41,227 [INFO]: 	Checking that your have enough memory available to create the index 03/09/2025, 08:31:41
2025-03-09 08:31:41,228 [INFO]: 1008.1MB of memory will be needed to build the index (more might be used if you have more)
2025-03-09 08:31:41,228 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0001 secs
2025-03-09 08:31:41,228 [INFO]: 	Selecting most promising index types given data characteristics 03/09/2025, 08:31:41
2025-03-09 08:31:41,228 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-09 08:31:41,228 [INFO]: 	Creating the index 03/09/2025, 08:31:41
2025-03-09 08:31:41,228 [INFO]: 		-> Instanciate the index HNSW15 03/09/2025, 08:31:41
2025-03-09 08:31:41,229 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0008 secs
2025-03-09 08:31:41,229 [INFO]: 		-> Adding the vectors to the index 03/09/2025, 08:31:41
2025-03-09 08:31:41,229 [INFO]: The memory available for adding the vectors is 49.1GB(total available - used by the index)
2025-03-09 08:31:41,229 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/20 [00:00<?, ?it/s]  5%|▌         | 1/20 [00:00<00:03,  5.03it/s] 15%|█▌        | 3/20 [00:00<00:01,  8.54it/s] 25%|██▌       | 5/20 [00:00<00:01,  8.94it/s] 35%|███▌      | 7/20 [00:00<00:01,  9.32it/s] 40%|████      | 8/20 [00:00<00:01,  9.33it/s] 45%|████▌     | 9/20 [00:01<00:01,  9.02it/s] 50%|█████     | 10/20 [00:01<00:01,  8.64it/s] 55%|█████▌    | 11/20 [00:01<00:01,  8.38it/s] 60%|██████    | 12/20 [00:01<00:00,  8.15it/s] 65%|██████▌   | 13/20 [00:01<00:00,  8.03it/s] 70%|███████   | 14/20 [00:01<00:00,  7.75it/s] 75%|███████▌  | 15/20 [00:01<00:00,  7.60it/s] 80%|████████  | 16/20 [00:01<00:00,  7.78it/s] 85%|████████▌ | 17/20 [00:02<00:00,  7.93it/s] 90%|█████████ | 18/20 [00:02<00:00,  8.43it/s]100%|██████████| 20/20 [00:06<00:00,  1.01s/it]100%|██████████| 20/20 [00:06<00:00,  3.18it/s]
2025-03-09 08:31:47,530 [INFO]: 	Computing best hyperparameters for index knn.index 03/09/2025, 08:31:47
2025-03-09 08:32:38,454 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 50.9238 secs
2025-03-09 08:32:38,455 [INFO]: The best hyperparameters are: efSearch=216
2025-03-09 08:32:38,455 [INFO]: 	Compute fast metrics 03/09/2025, 08:32:38
  0%|          | 0/4 [00:00<?, ?it/s] 25%|██▌       | 1/4 [00:00<00:00,  5.44it/s] 50%|█████     | 2/4 [00:00<00:00,  7.05it/s] 75%|███████▌  | 3/4 [00:00<00:00,  7.69it/s] 75%|███████▌  | 3/4 [00:00<00:00,  5.72it/s]
2025-03-09 08:32:58,538 [INFO]: 	>>> Finished "Compute fast metrics" in 20.0834 secs
2025-03-09 08:32:58,542 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 77.3132 secs
2025-03-09 08:32:58,542 [INFO]: {
2025-03-09 08:32:58,542 [INFO]: 	index_key: HNSW15
2025-03-09 08:32:58,542 [INFO]: 	index_param: efSearch=216
2025-03-09 08:32:58,542 [INFO]: 	index_path: knn.index
2025-03-09 08:32:58,542 [INFO]: 	size in bytes: 961094470
2025-03-09 08:32:58,542 [INFO]: 	avg_search_speed_ms: 9.925217333061266
2025-03-09 08:32:58,543 [INFO]: 	99p_search_speed_ms: 18.544975090771885
2025-03-09 08:32:58,543 [INFO]: 	reconstruction error %: 0.0
2025-03-09 08:32:58,543 [INFO]: 	nb vectors: 4885
2025-03-09 08:32:58,543 [INFO]: 	vectors dimension: 49152
2025-03-09 08:32:58,543 [INFO]: 	compression ratio: 0.9993087151984134
2025-03-09 08:32:58,543 [INFO]: }
2025-03-09 08:32:58,543 [INFO]: 	>>> Finished "Creating the index" in 77.3150 secs
2025-03-09 08:32:58,543 [INFO]: >>> Finished "Launching the whole pipeline" in 77.3432 secs
2025-03-09 08:32:59: [retrieval_preprocessing] calculating distances ...
2025-03-09 08:32:59: [retrieval_preprocessing] finished and saved retrieval indices for episode 11553 [episode count 7/20]
[retrieval_preprocessing] for episode 74918 [episode count 8/20], we have num_retrieval=np.int64(4893) num_query=np.int64(182)
2025-03-09 08:33:01,609 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-09 08:33:02,461 [INFO]: Launching the whole pipeline 03/09/2025, 08:33:02
2025-03-09 08:33:02,461 [INFO]: Reading total number of vectors and dimension 03/09/2025, 08:33:02
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1409.85it/s]
2025-03-09 08:33:02,491 [INFO]: There are 4893 embeddings of dim 49152
2025-03-09 08:33:02,491 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0295 secs
2025-03-09 08:33:02,491 [INFO]: 	Compute estimated construction time of the index 03/09/2025, 08:33:02
2025-03-09 08:33:02,491 [INFO]: 		-> Train: 16.7 minutes
2025-03-09 08:33:02,491 [INFO]: 		-> Add: 2.7 seconds
2025-03-09 08:33:02,491 [INFO]: 		Total: 16.7 minutes
2025-03-09 08:33:02,491 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0001 secs
2025-03-09 08:33:02,491 [INFO]: 	Checking that your have enough memory available to create the index 03/09/2025, 08:33:02
2025-03-09 08:33:02,491 [INFO]: 1009.8MB of memory will be needed to build the index (more might be used if you have more)
2025-03-09 08:33:02,491 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0001 secs
2025-03-09 08:33:02,491 [INFO]: 	Selecting most promising index types given data characteristics 03/09/2025, 08:33:02
2025-03-09 08:33:02,491 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-09 08:33:02,491 [INFO]: 	Creating the index 03/09/2025, 08:33:02
2025-03-09 08:33:02,491 [INFO]: 		-> Instanciate the index HNSW15 03/09/2025, 08:33:02
2025-03-09 08:33:02,492 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0010 secs
2025-03-09 08:33:02,492 [INFO]: 		-> Adding the vectors to the index 03/09/2025, 08:33:02
2025-03-09 08:33:02,493 [INFO]: The memory available for adding the vectors is 49.1GB(total available - used by the index)
2025-03-09 08:33:02,493 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/20 [00:00<?, ?it/s]  5%|▌         | 1/20 [00:00<00:03,  6.18it/s] 15%|█▌        | 3/20 [00:00<00:01, 10.91it/s] 25%|██▌       | 5/20 [00:00<00:01, 11.14it/s] 35%|███▌      | 7/20 [00:00<00:01, 11.38it/s] 45%|████▌     | 9/20 [00:00<00:00, 11.41it/s] 55%|█████▌    | 11/20 [00:00<00:00, 11.50it/s] 65%|██████▌   | 13/20 [00:01<00:00, 11.48it/s] 75%|███████▌  | 15/20 [00:01<00:00, 11.70it/s] 85%|████████▌ | 17/20 [00:01<00:00, 11.92it/s] 95%|█████████▌| 19/20 [00:01<00:00, 12.25it/s]100%|██████████| 20/20 [00:05<00:00,  3.82it/s]
2025-03-09 08:33:07,734 [INFO]: 	Computing best hyperparameters for index knn.index 03/09/2025, 08:33:07
2025-03-09 08:33:53,605 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 45.8707 secs
2025-03-09 08:33:53,605 [INFO]: The best hyperparameters are: efSearch=267
2025-03-09 08:33:53,606 [INFO]: 	Compute fast metrics 03/09/2025, 08:33:53
  0%|          | 0/4 [00:00<?, ?it/s] 25%|██▌       | 1/4 [00:00<00:00,  5.10it/s] 50%|█████     | 2/4 [00:00<00:00,  6.50it/s] 75%|███████▌  | 3/4 [00:00<00:00,  6.71it/s] 75%|███████▌  | 3/4 [00:00<00:00,  5.01it/s]
2025-03-09 08:34:09,090 [INFO]: 	>>> Finished "Compute fast metrics" in 15.4837 secs
2025-03-09 08:34:09,093 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 66.6002 secs
2025-03-09 08:34:09,093 [INFO]: {
2025-03-09 08:34:09,093 [INFO]: 	index_key: HNSW15
2025-03-09 08:34:09,093 [INFO]: 	index_param: efSearch=267
2025-03-09 08:34:09,093 [INFO]: 	index_path: knn.index
2025-03-09 08:34:09,093 [INFO]: 	size in bytes: 962668390
2025-03-09 08:34:09,093 [INFO]: 	avg_search_speed_ms: 12.735252403268579
2025-03-09 08:34:09,093 [INFO]: 	99p_search_speed_ms: 23.309520175680518
2025-03-09 08:34:09,093 [INFO]: 	reconstruction error %: 0.0
2025-03-09 08:34:09,093 [INFO]: 	nb vectors: 4893
2025-03-09 08:34:09,093 [INFO]: 	vectors dimension: 49152
2025-03-09 08:34:09,093 [INFO]: 	compression ratio: 0.999308748467372
2025-03-09 08:34:09,093 [INFO]: }
2025-03-09 08:34:09,093 [INFO]: 	>>> Finished "Creating the index" in 66.6017 secs
2025-03-09 08:34:09,093 [INFO]: >>> Finished "Launching the whole pipeline" in 66.6318 secs
2025-03-09 08:34:10: [retrieval_preprocessing] calculating distances ...
2025-03-09 08:34:11: [retrieval_preprocessing] finished and saved retrieval indices for episode 74918 [episode count 8/20]
[retrieval_preprocessing] for episode 60073 [episode count 9/20], we have num_retrieval=np.int64(4889) num_query=np.int64(186)
2025-03-09 08:34:12,750 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-09 08:34:13,387 [INFO]: Launching the whole pipeline 03/09/2025, 08:34:13
2025-03-09 08:34:13,387 [INFO]: Reading total number of vectors and dimension 03/09/2025, 08:34:13
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1316.48it/s]
2025-03-09 08:34:13,419 [INFO]: There are 4889 embeddings of dim 49152
2025-03-09 08:34:13,419 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0319 secs
2025-03-09 08:34:13,420 [INFO]: 	Compute estimated construction time of the index 03/09/2025, 08:34:13
2025-03-09 08:34:13,420 [INFO]: 		-> Train: 16.7 minutes
2025-03-09 08:34:13,420 [INFO]: 		-> Add: 2.7 seconds
2025-03-09 08:34:13,420 [INFO]: 		Total: 16.7 minutes
2025-03-09 08:34:13,420 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0004 secs
2025-03-09 08:34:13,420 [INFO]: 	Checking that your have enough memory available to create the index 03/09/2025, 08:34:13
2025-03-09 08:34:13,420 [INFO]: 1009.0MB of memory will be needed to build the index (more might be used if you have more)
2025-03-09 08:34:13,421 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0004 secs
2025-03-09 08:34:13,421 [INFO]: 	Selecting most promising index types given data characteristics 03/09/2025, 08:34:13
2025-03-09 08:34:13,421 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-09 08:34:13,421 [INFO]: 	Creating the index 03/09/2025, 08:34:13
2025-03-09 08:34:13,421 [INFO]: 		-> Instanciate the index HNSW15 03/09/2025, 08:34:13
2025-03-09 08:34:13,424 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0028 secs
2025-03-09 08:34:13,424 [INFO]: 		-> Adding the vectors to the index 03/09/2025, 08:34:13
2025-03-09 08:34:13,425 [INFO]: The memory available for adding the vectors is 49.1GB(total available - used by the index)
2025-03-09 08:34:13,425 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/20 [00:00<?, ?it/s]  5%|▌         | 1/20 [00:00<00:02,  6.49it/s] 15%|█▌        | 3/20 [00:00<00:01, 10.50it/s] 25%|██▌       | 5/20 [00:00<00:01, 11.27it/s] 35%|███▌      | 7/20 [00:00<00:01, 11.49it/s] 45%|████▌     | 9/20 [00:00<00:00, 12.05it/s] 55%|█████▌    | 11/20 [00:00<00:00, 12.28it/s] 65%|██████▌   | 13/20 [00:01<00:00, 12.58it/s] 75%|███████▌  | 15/20 [00:01<00:00, 12.70it/s] 85%|████████▌ | 17/20 [00:01<00:00, 12.64it/s] 95%|█████████▌| 19/20 [00:01<00:00, 12.56it/s]100%|██████████| 20/20 [00:05<00:00,  3.66it/s]
2025-03-09 08:34:18,899 [INFO]: 	Computing best hyperparameters for index knn.index 03/09/2025, 08:34:18
2025-03-09 08:35:03,618 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 44.7183 secs
2025-03-09 08:35:03,618 [INFO]: The best hyperparameters are: efSearch=249
2025-03-09 08:35:03,618 [INFO]: 	Compute fast metrics 03/09/2025, 08:35:03
  0%|          | 0/4 [00:00<?, ?it/s] 25%|██▌       | 1/4 [00:00<00:00,  7.02it/s] 75%|███████▌  | 3/4 [00:00<00:00, 10.56it/s] 75%|███████▌  | 3/4 [00:00<00:00,  8.02it/s]
2025-03-09 08:35:20,937 [INFO]: 	>>> Finished "Compute fast metrics" in 17.3191 secs
2025-03-09 08:35:20,941 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 67.5166 secs
2025-03-09 08:35:20,941 [INFO]: {
2025-03-09 08:35:20,941 [INFO]: 	index_key: HNSW15
2025-03-09 08:35:20,941 [INFO]: 	index_param: efSearch=249
2025-03-09 08:35:20,941 [INFO]: 	index_path: knn.index
2025-03-09 08:35:20,941 [INFO]: 	size in bytes: 961881430
2025-03-09 08:35:20,941 [INFO]: 	avg_search_speed_ms: 9.972232129751655
2025-03-09 08:35:20,941 [INFO]: 	99p_search_speed_ms: 18.197386492975056
2025-03-09 08:35:20,941 [INFO]: 	reconstruction error %: 0.0
2025-03-09 08:35:20,941 [INFO]: 	nb vectors: 4889
2025-03-09 08:35:20,941 [INFO]: 	vectors dimension: 49152
2025-03-09 08:35:20,941 [INFO]: 	compression ratio: 0.9993087318465022
2025-03-09 08:35:20,941 [INFO]: }
2025-03-09 08:35:20,941 [INFO]: 	>>> Finished "Creating the index" in 67.5203 secs
2025-03-09 08:35:20,941 [INFO]: >>> Finished "Launching the whole pipeline" in 67.5541 secs
2025-03-09 08:35:22: [retrieval_preprocessing] calculating distances ...
2025-03-09 08:35:22: [retrieval_preprocessing] finished and saved retrieval indices for episode 60073 [episode count 9/20]
[retrieval_preprocessing] for episode 86443 [episode count 10/20], we have num_retrieval=np.int64(4828) num_query=np.int64(247)
2025-03-09 08:35:24,692 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-09 08:35:25,436 [INFO]: Launching the whole pipeline 03/09/2025, 08:35:25
2025-03-09 08:35:25,436 [INFO]: Reading total number of vectors and dimension 03/09/2025, 08:35:25
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1445.31it/s]
2025-03-09 08:35:25,462 [INFO]: There are 4828 embeddings of dim 49152
2025-03-09 08:35:25,462 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0259 secs
2025-03-09 08:35:25,462 [INFO]: 	Compute estimated construction time of the index 03/09/2025, 08:35:25
2025-03-09 08:35:25,462 [INFO]: 		-> Train: 16.7 minutes
2025-03-09 08:35:25,462 [INFO]: 		-> Add: 2.7 seconds
2025-03-09 08:35:25,462 [INFO]: 		Total: 16.7 minutes
2025-03-09 08:35:25,462 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0001 secs
2025-03-09 08:35:25,462 [INFO]: 	Checking that your have enough memory available to create the index 03/09/2025, 08:35:25
2025-03-09 08:35:25,462 [INFO]: 996.4MB of memory will be needed to build the index (more might be used if you have more)
2025-03-09 08:35:25,462 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0001 secs
2025-03-09 08:35:25,462 [INFO]: 	Selecting most promising index types given data characteristics 03/09/2025, 08:35:25
2025-03-09 08:35:25,462 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-09 08:35:25,462 [INFO]: 	Creating the index 03/09/2025, 08:35:25
2025-03-09 08:35:25,462 [INFO]: 		-> Instanciate the index HNSW15 03/09/2025, 08:35:25
2025-03-09 08:35:25,463 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0011 secs
2025-03-09 08:35:25,464 [INFO]: 		-> Adding the vectors to the index 03/09/2025, 08:35:25
2025-03-09 08:35:25,464 [INFO]: The memory available for adding the vectors is 49.1GB(total available - used by the index)
2025-03-09 08:35:25,464 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/20 [00:00<?, ?it/s]  5%|▌         | 1/20 [00:00<00:03,  5.25it/s] 15%|█▌        | 3/20 [00:00<00:01,  9.12it/s] 25%|██▌       | 5/20 [00:00<00:01, 10.48it/s] 35%|███▌      | 7/20 [00:00<00:01, 11.17it/s] 45%|████▌     | 9/20 [00:00<00:00, 11.65it/s] 55%|█████▌    | 11/20 [00:01<00:00, 11.80it/s] 65%|██████▌   | 13/20 [00:01<00:00, 12.02it/s] 75%|███████▌  | 15/20 [00:01<00:00, 12.04it/s] 85%|████████▌ | 17/20 [00:01<00:00, 11.99it/s] 95%|█████████▌| 19/20 [00:01<00:00, 11.96it/s]100%|██████████| 20/20 [00:05<00:00,  3.97it/s]
2025-03-09 08:35:30,501 [INFO]: 	Computing best hyperparameters for index knn.index 03/09/2025, 08:35:30
2025-03-09 08:36:08,385 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 37.8834 secs
2025-03-09 08:36:08,386 [INFO]: The best hyperparameters are: efSearch=217
2025-03-09 08:36:08,386 [INFO]: 	Compute fast metrics 03/09/2025, 08:36:08
  0%|          | 0/4 [00:00<?, ?it/s] 25%|██▌       | 1/4 [00:00<00:00,  5.47it/s] 50%|█████     | 2/4 [00:00<00:00,  7.40it/s] 75%|███████▌  | 3/4 [00:00<00:00,  8.04it/s] 75%|███████▌  | 3/4 [00:00<00:00,  6.35it/s]
2025-03-09 08:36:23,500 [INFO]: 	>>> Finished "Compute fast metrics" in 15.1143 secs
2025-03-09 08:36:23,503 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 58.0396 secs
2025-03-09 08:36:23,503 [INFO]: {
2025-03-09 08:36:23,503 [INFO]: 	index_key: HNSW15
2025-03-09 08:36:23,503 [INFO]: 	index_param: efSearch=217
2025-03-09 08:36:23,503 [INFO]: 	index_path: knn.index
2025-03-09 08:36:23,503 [INFO]: 	size in bytes: 949880170
2025-03-09 08:36:23,504 [INFO]: 	avg_search_speed_ms: 9.978842491678105
2025-03-09 08:36:23,504 [INFO]: 	99p_search_speed_ms: 18.79226449178532
2025-03-09 08:36:23,504 [INFO]: 	reconstruction error %: 0.0
2025-03-09 08:36:23,504 [INFO]: 	nb vectors: 4828
2025-03-09 08:36:23,504 [INFO]: 	vectors dimension: 49152
2025-03-09 08:36:23,504 [INFO]: 	compression ratio: 0.9993086012101926
2025-03-09 08:36:23,504 [INFO]: }
2025-03-09 08:36:23,504 [INFO]: 	>>> Finished "Creating the index" in 58.0412 secs
2025-03-09 08:36:23,504 [INFO]: >>> Finished "Launching the whole pipeline" in 58.0677 secs
2025-03-09 08:36:24: [retrieval_preprocessing] calculating distances ...
2025-03-09 08:36:25: [retrieval_preprocessing] finished and saved retrieval indices for episode 86443 [episode count 10/20]
[retrieval_preprocessing] for episode 78765 [episode count 11/20], we have num_retrieval=np.int64(4800) num_query=np.int64(275)
2025-03-09 08:36:27,005 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-09 08:36:27,794 [INFO]: Launching the whole pipeline 03/09/2025, 08:36:27
2025-03-09 08:36:27,794 [INFO]: Reading total number of vectors and dimension 03/09/2025, 08:36:27
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1391.15it/s]
2025-03-09 08:36:27,821 [INFO]: There are 4800 embeddings of dim 49152
2025-03-09 08:36:27,821 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0271 secs
2025-03-09 08:36:27,821 [INFO]: 	Compute estimated construction time of the index 03/09/2025, 08:36:27
2025-03-09 08:36:27,821 [INFO]: 		-> Train: 16.7 minutes
2025-03-09 08:36:27,821 [INFO]: 		-> Add: 2.6 seconds
2025-03-09 08:36:27,822 [INFO]: 		Total: 16.7 minutes
2025-03-09 08:36:27,822 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0001 secs
2025-03-09 08:36:27,822 [INFO]: 	Checking that your have enough memory available to create the index 03/09/2025, 08:36:27
2025-03-09 08:36:27,822 [INFO]: 990.6MB of memory will be needed to build the index (more might be used if you have more)
2025-03-09 08:36:27,822 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0002 secs
2025-03-09 08:36:27,822 [INFO]: 	Selecting most promising index types given data characteristics 03/09/2025, 08:36:27
2025-03-09 08:36:27,822 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-09 08:36:27,822 [INFO]: 	Creating the index 03/09/2025, 08:36:27
2025-03-09 08:36:27,822 [INFO]: 		-> Instanciate the index HNSW15 03/09/2025, 08:36:27
2025-03-09 08:36:27,823 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0010 secs
2025-03-09 08:36:27,823 [INFO]: 		-> Adding the vectors to the index 03/09/2025, 08:36:27
2025-03-09 08:36:27,823 [INFO]: The memory available for adding the vectors is 49.1GB(total available - used by the index)
2025-03-09 08:36:27,823 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/19 [00:00<?, ?it/s]  5%|▌         | 1/19 [00:00<00:03,  4.68it/s] 11%|█         | 2/19 [00:00<00:02,  6.26it/s] 16%|█▌        | 3/19 [00:00<00:02,  6.97it/s] 21%|██        | 4/19 [00:00<00:01,  7.55it/s] 26%|██▋       | 5/19 [00:00<00:01,  7.84it/s] 32%|███▏      | 6/19 [00:00<00:01,  7.93it/s] 37%|███▋      | 7/19 [00:00<00:01,  8.00it/s] 42%|████▏     | 8/19 [00:01<00:01,  8.06it/s] 47%|████▋     | 9/19 [00:01<00:01,  8.16it/s] 53%|█████▎    | 10/19 [00:01<00:01,  8.47it/s] 58%|█████▊    | 11/19 [00:01<00:00,  8.31it/s] 63%|██████▎   | 12/19 [00:01<00:00,  8.00it/s] 68%|██████▊   | 13/19 [00:01<00:00,  7.94it/s] 74%|███████▎  | 14/19 [00:01<00:00,  7.82it/s] 79%|███████▉  | 15/19 [00:01<00:00,  7.70it/s] 84%|████████▍ | 16/19 [00:02<00:00,  7.71it/s] 89%|████████▉ | 17/19 [00:02<00:00,  7.67it/s] 95%|█████████▍| 18/19 [00:02<00:00,  8.06it/s]100%|██████████| 19/19 [00:06<00:00,  1.34s/it]100%|██████████| 19/19 [00:06<00:00,  2.93it/s]
2025-03-09 08:36:34,309 [INFO]: 	Computing best hyperparameters for index knn.index 03/09/2025, 08:36:34
2025-03-09 08:37:17,055 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 42.7453 secs
2025-03-09 08:37:17,055 [INFO]: The best hyperparameters are: efSearch=241
2025-03-09 08:37:17,055 [INFO]: 	Compute fast metrics 03/09/2025, 08:37:17
  0%|          | 0/4 [00:00<?, ?it/s] 25%|██▌       | 1/4 [00:00<00:00,  7.28it/s] 75%|███████▌  | 3/4 [00:00<00:00, 11.03it/s] 75%|███████▌  | 3/4 [00:00<00:00,  8.37it/s]
2025-03-09 08:37:31,750 [INFO]: 	>>> Finished "Compute fast metrics" in 14.6945 secs
2025-03-09 08:37:32,012 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 64.1891 secs
2025-03-09 08:37:32,013 [INFO]: {
2025-03-09 08:37:32,013 [INFO]: 	index_key: HNSW15
2025-03-09 08:37:32,013 [INFO]: 	index_param: efSearch=241
2025-03-09 08:37:32,013 [INFO]: 	index_path: knn.index
2025-03-09 08:37:32,013 [INFO]: 	size in bytes: 944371270
2025-03-09 08:37:32,013 [INFO]: 	avg_search_speed_ms: 10.327290667342176
2025-03-09 08:37:32,013 [INFO]: 	99p_search_speed_ms: 19.432326667010805
2025-03-09 08:37:32,013 [INFO]: 	reconstruction error %: 0.0
2025-03-09 08:37:32,013 [INFO]: 	nb vectors: 4800
2025-03-09 08:37:32,013 [INFO]: 	vectors dimension: 49152
2025-03-09 08:37:32,013 [INFO]: 	compression ratio: 0.9993086723190976
2025-03-09 08:37:32,013 [INFO]: }
2025-03-09 08:37:32,013 [INFO]: 	>>> Finished "Creating the index" in 64.1914 secs
2025-03-09 08:37:32,013 [INFO]: >>> Finished "Launching the whole pipeline" in 64.2192 secs
2025-03-09 08:37:34: [retrieval_preprocessing] calculating distances ...
2025-03-09 08:37:35: [retrieval_preprocessing] finished and saved retrieval indices for episode 78765 [episode count 11/20]
[retrieval_preprocessing] for episode 39347 [episode count 12/20], we have num_retrieval=np.int64(4858) num_query=np.int64(217)
2025-03-09 08:37:37,300 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-09 08:37:38,231 [INFO]: Launching the whole pipeline 03/09/2025, 08:37:38
2025-03-09 08:37:38,231 [INFO]: Reading total number of vectors and dimension 03/09/2025, 08:37:38
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1256.91it/s]
2025-03-09 08:37:38,260 [INFO]: There are 4858 embeddings of dim 49152
2025-03-09 08:37:38,260 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0288 secs
2025-03-09 08:37:38,260 [INFO]: 	Compute estimated construction time of the index 03/09/2025, 08:37:38
2025-03-09 08:37:38,260 [INFO]: 		-> Train: 16.7 minutes
2025-03-09 08:37:38,260 [INFO]: 		-> Add: 2.7 seconds
2025-03-09 08:37:38,260 [INFO]: 		Total: 16.7 minutes
2025-03-09 08:37:38,260 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0001 secs
2025-03-09 08:37:38,260 [INFO]: 	Checking that your have enough memory available to create the index 03/09/2025, 08:37:38
2025-03-09 08:37:38,261 [INFO]: 1002.6MB of memory will be needed to build the index (more might be used if you have more)
2025-03-09 08:37:38,261 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0002 secs
2025-03-09 08:37:38,261 [INFO]: 	Selecting most promising index types given data characteristics 03/09/2025, 08:37:38
2025-03-09 08:37:38,261 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-09 08:37:38,261 [INFO]: 	Creating the index 03/09/2025, 08:37:38
2025-03-09 08:37:38,261 [INFO]: 		-> Instanciate the index HNSW15 03/09/2025, 08:37:38
2025-03-09 08:37:38,262 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0012 secs
2025-03-09 08:37:38,262 [INFO]: 		-> Adding the vectors to the index 03/09/2025, 08:37:38
2025-03-09 08:37:38,262 [INFO]: The memory available for adding the vectors is 49.1GB(total available - used by the index)
2025-03-09 08:37:38,262 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/20 [00:00<?, ?it/s]  5%|▌         | 1/20 [00:00<00:03,  5.05it/s] 15%|█▌        | 3/20 [00:00<00:01,  8.78it/s] 25%|██▌       | 5/20 [00:00<00:01,  9.85it/s] 35%|███▌      | 7/20 [00:00<00:01, 10.37it/s] 45%|████▌     | 9/20 [00:00<00:01, 10.72it/s] 55%|█████▌    | 11/20 [00:01<00:00, 10.72it/s] 65%|██████▌   | 13/20 [00:01<00:00, 10.87it/s] 75%|███████▌  | 15/20 [00:01<00:00, 11.10it/s] 85%|████████▌ | 17/20 [00:01<00:00, 11.27it/s] 95%|█████████▌| 19/20 [00:01<00:00, 11.54it/s]100%|██████████| 20/20 [00:05<00:00,  3.87it/s]
2025-03-09 08:37:43,440 [INFO]: 	Computing best hyperparameters for index knn.index 03/09/2025, 08:37:43
2025-03-09 08:38:27,676 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 44.2354 secs
2025-03-09 08:38:27,676 [INFO]: The best hyperparameters are: efSearch=232
2025-03-09 08:38:27,676 [INFO]: 	Compute fast metrics 03/09/2025, 08:38:27
  0%|          | 0/4 [00:00<?, ?it/s] 25%|██▌       | 1/4 [00:00<00:00,  5.88it/s] 75%|███████▌  | 3/4 [00:00<00:00,  9.78it/s] 75%|███████▌  | 3/4 [00:00<00:00,  7.43it/s]
2025-03-09 08:38:42,764 [INFO]: 	>>> Finished "Compute fast metrics" in 15.0881 secs
2025-03-09 08:38:43,062 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 64.8001 secs
2025-03-09 08:38:43,063 [INFO]: {
2025-03-09 08:38:43,063 [INFO]: 	index_key: HNSW15
2025-03-09 08:38:43,063 [INFO]: 	index_param: efSearch=232
2025-03-09 08:38:43,063 [INFO]: 	index_path: knn.index
2025-03-09 08:38:43,063 [INFO]: 	size in bytes: 955782430
2025-03-09 08:38:43,063 [INFO]: 	avg_search_speed_ms: 10.481465905875483
2025-03-09 08:38:43,063 [INFO]: 	99p_search_speed_ms: 18.639958505518738
2025-03-09 08:38:43,063 [INFO]: 	reconstruction error %: 0.0
2025-03-09 08:38:43,063 [INFO]: 	nb vectors: 4858
2025-03-09 08:38:43,063 [INFO]: 	vectors dimension: 49152
2025-03-09 08:38:43,063 [INFO]: 	compression ratio: 0.9993086648391308
2025-03-09 08:38:43,063 [INFO]: }
2025-03-09 08:38:43,063 [INFO]: 	>>> Finished "Creating the index" in 64.8025 secs
2025-03-09 08:38:43,063 [INFO]: >>> Finished "Launching the whole pipeline" in 64.8321 secs
2025-03-09 08:38:45: [retrieval_preprocessing] calculating distances ...
2025-03-09 08:38:45: [retrieval_preprocessing] finished and saved retrieval indices for episode 39347 [episode count 12/20]
[retrieval_preprocessing] for episode 31029 [episode count 13/20], we have num_retrieval=np.int64(4829) num_query=np.int64(246)
2025-03-09 08:38:47,331 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-09 08:38:48,410 [INFO]: Launching the whole pipeline 03/09/2025, 08:38:48
2025-03-09 08:38:48,410 [INFO]: Reading total number of vectors and dimension 03/09/2025, 08:38:48
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1483.13it/s]
2025-03-09 08:38:48,435 [INFO]: There are 4829 embeddings of dim 49152
2025-03-09 08:38:48,435 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0257 secs
2025-03-09 08:38:48,436 [INFO]: 	Compute estimated construction time of the index 03/09/2025, 08:38:48
2025-03-09 08:38:48,436 [INFO]: 		-> Train: 16.7 minutes
2025-03-09 08:38:48,436 [INFO]: 		-> Add: 2.7 seconds
2025-03-09 08:38:48,436 [INFO]: 		Total: 16.7 minutes
2025-03-09 08:38:48,436 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0001 secs
2025-03-09 08:38:48,436 [INFO]: 	Checking that your have enough memory available to create the index 03/09/2025, 08:38:48
2025-03-09 08:38:48,436 [INFO]: 996.6MB of memory will be needed to build the index (more might be used if you have more)
2025-03-09 08:38:48,436 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0001 secs
2025-03-09 08:38:48,436 [INFO]: 	Selecting most promising index types given data characteristics 03/09/2025, 08:38:48
2025-03-09 08:38:48,436 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-09 08:38:48,436 [INFO]: 	Creating the index 03/09/2025, 08:38:48
2025-03-09 08:38:48,436 [INFO]: 		-> Instanciate the index HNSW15 03/09/2025, 08:38:48
2025-03-09 08:38:48,437 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0010 secs
2025-03-09 08:38:48,437 [INFO]: 		-> Adding the vectors to the index 03/09/2025, 08:38:48
2025-03-09 08:38:48,437 [INFO]: The memory available for adding the vectors is 49.1GB(total available - used by the index)
2025-03-09 08:38:48,437 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/20 [00:00<?, ?it/s]  5%|▌         | 1/20 [00:00<00:03,  5.74it/s] 15%|█▌        | 3/20 [00:00<00:01,  8.90it/s] 25%|██▌       | 5/20 [00:00<00:01,  9.76it/s] 35%|███▌      | 7/20 [00:00<00:01, 10.37it/s] 45%|████▌     | 9/20 [00:00<00:01, 10.96it/s] 55%|█████▌    | 11/20 [00:01<00:00, 11.48it/s] 65%|██████▌   | 13/20 [00:01<00:00, 11.94it/s] 75%|███████▌  | 15/20 [00:01<00:00, 12.40it/s] 85%|████████▌ | 17/20 [00:01<00:00, 12.70it/s] 95%|█████████▌| 19/20 [00:01<00:00, 13.13it/s]100%|██████████| 20/20 [00:05<00:00,  3.78it/s]
2025-03-09 08:38:53,731 [INFO]: 	Computing best hyperparameters for index knn.index 03/09/2025, 08:38:53
2025-03-09 08:39:32,904 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 39.1730 secs
2025-03-09 08:39:32,904 [INFO]: The best hyperparameters are: efSearch=265
2025-03-09 08:39:32,905 [INFO]: 	Compute fast metrics 03/09/2025, 08:39:32
  0%|          | 0/4 [00:00<?, ?it/s] 25%|██▌       | 1/4 [00:00<00:00,  5.38it/s] 50%|█████     | 2/4 [00:00<00:00,  7.20it/s] 75%|███████▌  | 3/4 [00:00<00:00,  7.89it/s] 75%|███████▌  | 3/4 [00:00<00:00,  5.87it/s]
2025-03-09 08:39:54,787 [INFO]: 	>>> Finished "Compute fast metrics" in 21.8819 secs
2025-03-09 08:39:54,790 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 66.3527 secs
2025-03-09 08:39:54,790 [INFO]: {
2025-03-09 08:39:54,790 [INFO]: 	index_key: HNSW15
2025-03-09 08:39:54,790 [INFO]: 	index_param: efSearch=265
2025-03-09 08:39:54,790 [INFO]: 	index_path: knn.index
2025-03-09 08:39:54,790 [INFO]: 	size in bytes: 950076910
2025-03-09 08:39:54,790 [INFO]: 	avg_search_speed_ms: 12.093941127586358
2025-03-09 08:39:54,790 [INFO]: 	99p_search_speed_ms: 22.042223662137985
2025-03-09 08:39:54,790 [INFO]: 	reconstruction error %: 0.0
2025-03-09 08:39:54,790 [INFO]: 	nb vectors: 4829
2025-03-09 08:39:54,790 [INFO]: 	vectors dimension: 49152
2025-03-09 08:39:54,790 [INFO]: 	compression ratio: 0.9993086054475316
2025-03-09 08:39:54,790 [INFO]: }
2025-03-09 08:39:54,790 [INFO]: 	>>> Finished "Creating the index" in 66.3541 secs
2025-03-09 08:39:54,790 [INFO]: >>> Finished "Launching the whole pipeline" in 66.3804 secs
2025-03-09 08:39:56: [retrieval_preprocessing] calculating distances ...
2025-03-09 08:39:57: [retrieval_preprocessing] finished and saved retrieval indices for episode 31029 [episode count 13/20]
[retrieval_preprocessing] for episode 90421 [episode count 14/20], we have num_retrieval=np.int64(4862) num_query=np.int64(213)
2025-03-09 08:39:58,854 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-09 08:39:59,699 [INFO]: Launching the whole pipeline 03/09/2025, 08:39:59
2025-03-09 08:39:59,699 [INFO]: Reading total number of vectors and dimension 03/09/2025, 08:39:59
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1129.32it/s]
2025-03-09 08:39:59,728 [INFO]: There are 4862 embeddings of dim 49152
2025-03-09 08:39:59,728 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0287 secs
2025-03-09 08:39:59,728 [INFO]: 	Compute estimated construction time of the index 03/09/2025, 08:39:59
2025-03-09 08:39:59,728 [INFO]: 		-> Train: 16.7 minutes
2025-03-09 08:39:59,728 [INFO]: 		-> Add: 2.7 seconds
2025-03-09 08:39:59,728 [INFO]: 		Total: 16.7 minutes
2025-03-09 08:39:59,728 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0001 secs
2025-03-09 08:39:59,728 [INFO]: 	Checking that your have enough memory available to create the index 03/09/2025, 08:39:59
2025-03-09 08:39:59,728 [INFO]: 1003.4MB of memory will be needed to build the index (more might be used if you have more)
2025-03-09 08:39:59,729 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0002 secs
2025-03-09 08:39:59,729 [INFO]: 	Selecting most promising index types given data characteristics 03/09/2025, 08:39:59
2025-03-09 08:39:59,729 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-09 08:39:59,729 [INFO]: 	Creating the index 03/09/2025, 08:39:59
2025-03-09 08:39:59,729 [INFO]: 		-> Instanciate the index HNSW15 03/09/2025, 08:39:59
2025-03-09 08:39:59,730 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0011 secs
2025-03-09 08:39:59,730 [INFO]: 		-> Adding the vectors to the index 03/09/2025, 08:39:59
2025-03-09 08:39:59,730 [INFO]: The memory available for adding the vectors is 49.1GB(total available - used by the index)
2025-03-09 08:39:59,730 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/20 [00:00<?, ?it/s]  5%|▌         | 1/20 [00:00<00:04,  4.73it/s] 10%|█         | 2/20 [00:00<00:02,  6.31it/s] 15%|█▌        | 3/20 [00:00<00:02,  7.09it/s] 20%|██        | 4/20 [00:00<00:02,  7.37it/s] 25%|██▌       | 5/20 [00:00<00:01,  7.62it/s] 30%|███       | 6/20 [00:00<00:01,  7.93it/s] 35%|███▌      | 7/20 [00:00<00:01,  8.14it/s] 40%|████      | 8/20 [00:01<00:01,  8.09it/s] 45%|████▌     | 9/20 [00:01<00:01,  8.10it/s] 50%|█████     | 10/20 [00:01<00:01,  8.10it/s] 55%|█████▌    | 11/20 [00:01<00:01,  8.08it/s] 60%|██████    | 12/20 [00:01<00:00,  8.20it/s] 70%|███████   | 14/20 [00:01<00:00,  9.10it/s] 80%|████████  | 16/20 [00:01<00:00,  9.76it/s] 90%|█████████ | 18/20 [00:02<00:00, 10.26it/s]100%|██████████| 20/20 [00:05<00:00,  1.53it/s]100%|██████████| 20/20 [00:05<00:00,  3.60it/s]
2025-03-09 08:40:05,289 [INFO]: 	Computing best hyperparameters for index knn.index 03/09/2025, 08:40:05
2025-03-09 08:40:42,811 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 37.5218 secs
2025-03-09 08:40:42,812 [INFO]: The best hyperparameters are: efSearch=303
2025-03-09 08:40:42,812 [INFO]: 	Compute fast metrics 03/09/2025, 08:40:42
  0%|          | 0/4 [00:00<?, ?it/s] 25%|██▌       | 1/4 [00:00<00:00,  5.62it/s] 50%|█████     | 2/4 [00:00<00:00,  7.26it/s] 75%|███████▌  | 3/4 [00:00<00:00,  8.14it/s] 75%|███████▌  | 3/4 [00:00<00:00,  6.08it/s]
2025-03-09 08:41:03,844 [INFO]: 	>>> Finished "Compute fast metrics" in 21.0323 secs
2025-03-09 08:41:03,849 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 64.1191 secs
2025-03-09 08:41:03,849 [INFO]: {
2025-03-09 08:41:03,849 [INFO]: 	index_key: HNSW15
2025-03-09 08:41:03,849 [INFO]: 	index_param: efSearch=303
2025-03-09 08:41:03,849 [INFO]: 	index_path: knn.index
2025-03-09 08:41:03,849 [INFO]: 	size in bytes: 956569390
2025-03-09 08:41:03,849 [INFO]: 	avg_search_speed_ms: 13.128589811243527
2025-03-09 08:41:03,849 [INFO]: 	99p_search_speed_ms: 26.349738112185147
2025-03-09 08:41:03,849 [INFO]: 	reconstruction error %: 0.0
2025-03-09 08:41:03,849 [INFO]: 	nb vectors: 4862
2025-03-09 08:41:03,849 [INFO]: 	vectors dimension: 49152
2025-03-09 08:41:03,849 [INFO]: 	compression ratio: 0.9993086816211002
2025-03-09 08:41:03,849 [INFO]: }
2025-03-09 08:41:03,849 [INFO]: 	>>> Finished "Creating the index" in 64.1207 secs
2025-03-09 08:41:03,849 [INFO]: >>> Finished "Launching the whole pipeline" in 64.1501 secs
2025-03-09 08:41:06: [retrieval_preprocessing] calculating distances ...
2025-03-09 08:41:07: [retrieval_preprocessing] finished and saved retrieval indices for episode 90421 [episode count 14/20]
[retrieval_preprocessing] for episode 34615 [episode count 15/20], we have num_retrieval=np.int64(4538) num_query=np.int64(537)
2025-03-09 08:41:09,277 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-09 08:41:10,012 [INFO]: Launching the whole pipeline 03/09/2025, 08:41:10
2025-03-09 08:41:10,012 [INFO]: Reading total number of vectors and dimension 03/09/2025, 08:41:10
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1218.92it/s]
2025-03-09 08:41:10,040 [INFO]: There are 4538 embeddings of dim 49152
2025-03-09 08:41:10,041 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0287 secs
2025-03-09 08:41:10,041 [INFO]: 	Compute estimated construction time of the index 03/09/2025, 08:41:10
2025-03-09 08:41:10,041 [INFO]: 		-> Train: 16.7 minutes
2025-03-09 08:41:10,041 [INFO]: 		-> Add: 2.5 seconds
2025-03-09 08:41:10,041 [INFO]: 		Total: 16.7 minutes
2025-03-09 08:41:10,041 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0001 secs
2025-03-09 08:41:10,041 [INFO]: 	Checking that your have enough memory available to create the index 03/09/2025, 08:41:10
2025-03-09 08:41:10,041 [INFO]: 936.5MB of memory will be needed to build the index (more might be used if you have more)
2025-03-09 08:41:10,041 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0002 secs
2025-03-09 08:41:10,041 [INFO]: 	Selecting most promising index types given data characteristics 03/09/2025, 08:41:10
2025-03-09 08:41:10,041 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-09 08:41:10,041 [INFO]: 	Creating the index 03/09/2025, 08:41:10
2025-03-09 08:41:10,041 [INFO]: 		-> Instanciate the index HNSW15 03/09/2025, 08:41:10
2025-03-09 08:41:10,043 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0012 secs
2025-03-09 08:41:10,043 [INFO]: 		-> Adding the vectors to the index 03/09/2025, 08:41:10
2025-03-09 08:41:10,043 [INFO]: The memory available for adding the vectors is 49.2GB(total available - used by the index)
2025-03-09 08:41:10,043 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/18 [00:00<?, ?it/s]  6%|▌         | 1/18 [00:00<00:03,  5.59it/s] 17%|█▋        | 3/18 [00:00<00:01, 11.23it/s] 28%|██▊       | 5/18 [00:00<00:00, 13.01it/s] 39%|███▉      | 7/18 [00:00<00:00, 13.79it/s] 50%|█████     | 9/18 [00:00<00:00, 14.97it/s] 61%|██████    | 11/18 [00:00<00:00, 15.55it/s] 72%|███████▏  | 13/18 [00:00<00:00, 14.77it/s] 83%|████████▎ | 15/18 [00:01<00:00, 13.51it/s] 94%|█████████▍| 17/18 [00:01<00:00, 12.63it/s]100%|██████████| 18/18 [00:05<00:00,  3.42it/s]
2025-03-09 08:41:15,311 [INFO]: 	Computing best hyperparameters for index knn.index 03/09/2025, 08:41:15
2025-03-09 08:41:56,452 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 41.1400 secs
2025-03-09 08:41:56,452 [INFO]: The best hyperparameters are: efSearch=259
2025-03-09 08:41:56,452 [INFO]: 	Compute fast metrics 03/09/2025, 08:41:56
  0%|          | 0/4 [00:00<?, ?it/s] 25%|██▌       | 1/4 [00:00<00:00,  5.68it/s] 50%|█████     | 2/4 [00:00<00:00,  7.32it/s] 75%|███████▌  | 3/4 [00:00<00:00,  7.99it/s] 75%|███████▌  | 3/4 [00:00<00:00,  5.94it/s]
2025-03-09 08:42:19,562 [INFO]: 	>>> Finished "Compute fast metrics" in 23.1101 secs
2025-03-09 08:42:19,565 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 69.5226 secs
2025-03-09 08:42:19,565 [INFO]: {
2025-03-09 08:42:19,565 [INFO]: 	index_key: HNSW15
2025-03-09 08:42:19,565 [INFO]: 	index_param: efSearch=259
2025-03-09 08:42:19,566 [INFO]: 	index_path: knn.index
2025-03-09 08:42:19,566 [INFO]: 	size in bytes: 892824310
2025-03-09 08:42:19,566 [INFO]: 	avg_search_speed_ms: 10.260024527326609
2025-03-09 08:42:19,566 [INFO]: 	99p_search_speed_ms: 19.328234358690676
2025-03-09 08:42:19,566 [INFO]: 	reconstruction error %: 0.0
2025-03-09 08:42:19,566 [INFO]: 	nb vectors: 4538
2025-03-09 08:42:19,566 [INFO]: 	vectors dimension: 49152
2025-03-09 08:42:19,566 [INFO]: 	compression ratio: 0.9993087038591053
2025-03-09 08:42:19,566 [INFO]: }
2025-03-09 08:42:19,566 [INFO]: 	>>> Finished "Creating the index" in 69.5244 secs
2025-03-09 08:42:19,566 [INFO]: >>> Finished "Launching the whole pipeline" in 69.5538 secs
2025-03-09 08:42:22: [retrieval_preprocessing] calculating distances ...
2025-03-09 08:42:24: [retrieval_preprocessing] finished and saved retrieval indices for episode 34615 [episode count 15/20]
[retrieval_preprocessing] for episode 55351 [episode count 16/20], we have num_retrieval=np.int64(4898) num_query=np.int64(177)
2025-03-09 08:42:25,212 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-09 08:42:26,001 [INFO]: Launching the whole pipeline 03/09/2025, 08:42:26
2025-03-09 08:42:26,001 [INFO]: Reading total number of vectors and dimension 03/09/2025, 08:42:26
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1806.33it/s]
2025-03-09 08:42:26,026 [INFO]: There are 4898 embeddings of dim 49152
2025-03-09 08:42:26,026 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0248 secs
2025-03-09 08:42:26,026 [INFO]: 	Compute estimated construction time of the index 03/09/2025, 08:42:26
2025-03-09 08:42:26,026 [INFO]: 		-> Train: 16.7 minutes
2025-03-09 08:42:26,026 [INFO]: 		-> Add: 2.7 seconds
2025-03-09 08:42:26,026 [INFO]: 		Total: 16.7 minutes
2025-03-09 08:42:26,026 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0002 secs
2025-03-09 08:42:26,026 [INFO]: 	Checking that your have enough memory available to create the index 03/09/2025, 08:42:26
2025-03-09 08:42:26,026 [INFO]: 1010.8MB of memory will be needed to build the index (more might be used if you have more)
2025-03-09 08:42:26,026 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0001 secs
2025-03-09 08:42:26,026 [INFO]: 	Selecting most promising index types given data characteristics 03/09/2025, 08:42:26
2025-03-09 08:42:26,026 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-09 08:42:26,026 [INFO]: 	Creating the index 03/09/2025, 08:42:26
2025-03-09 08:42:26,026 [INFO]: 		-> Instanciate the index HNSW15 03/09/2025, 08:42:26
2025-03-09 08:42:26,027 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0010 secs
2025-03-09 08:42:26,028 [INFO]: 		-> Adding the vectors to the index 03/09/2025, 08:42:26
2025-03-09 08:42:26,028 [INFO]: The memory available for adding the vectors is 49.1GB(total available - used by the index)
2025-03-09 08:42:26,028 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/20 [00:00<?, ?it/s]  5%|▌         | 1/20 [00:00<00:03,  4.82it/s] 10%|█         | 2/20 [00:00<00:02,  6.39it/s] 15%|█▌        | 3/20 [00:00<00:02,  7.21it/s] 20%|██        | 4/20 [00:00<00:02,  7.63it/s] 25%|██▌       | 5/20 [00:00<00:01,  7.90it/s] 30%|███       | 6/20 [00:00<00:01,  7.92it/s] 35%|███▌      | 7/20 [00:00<00:01,  8.00it/s] 40%|████      | 8/20 [00:01<00:01,  8.03it/s] 45%|████▌     | 9/20 [00:01<00:01,  8.06it/s] 50%|█████     | 10/20 [00:01<00:01,  8.17it/s] 55%|█████▌    | 11/20 [00:01<00:01,  8.34it/s] 60%|██████    | 12/20 [00:01<00:00,  8.29it/s] 65%|██████▌   | 13/20 [00:01<00:00,  8.26it/s] 70%|███████   | 14/20 [00:01<00:00,  8.18it/s] 75%|███████▌  | 15/20 [00:01<00:00,  8.20it/s] 80%|████████  | 16/20 [00:02<00:00,  8.42it/s] 90%|█████████ | 18/20 [00:02<00:00,  9.42it/s]100%|██████████| 20/20 [00:05<00:00,  1.42it/s]100%|██████████| 20/20 [00:05<00:00,  3.69it/s]
2025-03-09 08:42:31,453 [INFO]: 	Computing best hyperparameters for index knn.index 03/09/2025, 08:42:31
2025-03-09 08:43:15,916 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 44.4629 secs
2025-03-09 08:43:15,916 [INFO]: The best hyperparameters are: efSearch=192
2025-03-09 08:43:15,916 [INFO]: 	Compute fast metrics 03/09/2025, 08:43:15
  0%|          | 0/4 [00:00<?, ?it/s] 25%|██▌       | 1/4 [00:00<00:00,  3.50it/s] 50%|█████     | 2/4 [00:00<00:00,  5.31it/s] 75%|███████▌  | 3/4 [00:00<00:00,  6.36it/s] 75%|███████▌  | 3/4 [00:00<00:00,  4.71it/s]
2025-03-09 08:43:36,778 [INFO]: 	>>> Finished "Compute fast metrics" in 20.8620 secs
2025-03-09 08:43:36,782 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 70.7539 secs
2025-03-09 08:43:36,782 [INFO]: {
2025-03-09 08:43:36,782 [INFO]: 	index_key: HNSW15
2025-03-09 08:43:36,782 [INFO]: 	index_param: efSearch=192
2025-03-09 08:43:36,782 [INFO]: 	index_path: knn.index
2025-03-09 08:43:36,782 [INFO]: 	size in bytes: 963652090
2025-03-09 08:43:36,782 [INFO]: 	avg_search_speed_ms: 8.019356658262497
2025-03-09 08:43:36,782 [INFO]: 	99p_search_speed_ms: 14.776592538692054
2025-03-09 08:43:36,782 [INFO]: 	reconstruction error %: 0.0
2025-03-09 08:43:36,782 [INFO]: 	nb vectors: 4898
2025-03-09 08:43:36,782 [INFO]: 	vectors dimension: 49152
2025-03-09 08:43:36,782 [INFO]: 	compression ratio: 0.9993087692052844
2025-03-09 08:43:36,782 [INFO]: }
2025-03-09 08:43:36,782 [INFO]: 	>>> Finished "Creating the index" in 70.7555 secs
2025-03-09 08:43:36,782 [INFO]: >>> Finished "Launching the whole pipeline" in 70.7810 secs
2025-03-09 08:43:37: [retrieval_preprocessing] calculating distances ...
2025-03-09 08:43:38: [retrieval_preprocessing] finished and saved retrieval indices for episode 55351 [episode count 16/20]
[retrieval_preprocessing] for episode 15419 [episode count 17/20], we have num_retrieval=np.int64(4864) num_query=np.int64(211)
2025-03-09 08:43:39,507 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-09 08:43:40,204 [INFO]: Launching the whole pipeline 03/09/2025, 08:43:40
2025-03-09 08:43:40,204 [INFO]: Reading total number of vectors and dimension 03/09/2025, 08:43:40
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1701.54it/s]
2025-03-09 08:43:40,230 [INFO]: There are 4864 embeddings of dim 49152
2025-03-09 08:43:40,230 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0264 secs
2025-03-09 08:43:40,230 [INFO]: 	Compute estimated construction time of the index 03/09/2025, 08:43:40
2025-03-09 08:43:40,231 [INFO]: 		-> Train: 16.7 minutes
2025-03-09 08:43:40,231 [INFO]: 		-> Add: 2.7 seconds
2025-03-09 08:43:40,231 [INFO]: 		Total: 16.7 minutes
2025-03-09 08:43:40,231 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0001 secs
2025-03-09 08:43:40,231 [INFO]: 	Checking that your have enough memory available to create the index 03/09/2025, 08:43:40
2025-03-09 08:43:40,231 [INFO]: 1003.8MB of memory will be needed to build the index (more might be used if you have more)
2025-03-09 08:43:40,231 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0003 secs
2025-03-09 08:43:40,231 [INFO]: 	Selecting most promising index types given data characteristics 03/09/2025, 08:43:40
2025-03-09 08:43:40,231 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-09 08:43:40,231 [INFO]: 	Creating the index 03/09/2025, 08:43:40
2025-03-09 08:43:40,231 [INFO]: 		-> Instanciate the index HNSW15 03/09/2025, 08:43:40
2025-03-09 08:43:40,232 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0011 secs
2025-03-09 08:43:40,232 [INFO]: 		-> Adding the vectors to the index 03/09/2025, 08:43:40
2025-03-09 08:43:40,232 [INFO]: The memory available for adding the vectors is 49.1GB(total available - used by the index)
2025-03-09 08:43:40,232 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/20 [00:00<?, ?it/s]  5%|▌         | 1/20 [00:00<00:03,  6.31it/s] 15%|█▌        | 3/20 [00:00<00:01, 10.40it/s] 25%|██▌       | 5/20 [00:00<00:01, 12.26it/s] 35%|███▌      | 7/20 [00:00<00:00, 13.82it/s] 45%|████▌     | 9/20 [00:00<00:00, 14.78it/s] 55%|█████▌    | 11/20 [00:00<00:00, 15.53it/s] 65%|██████▌   | 13/20 [00:00<00:00, 14.01it/s] 75%|███████▌  | 15/20 [00:01<00:00, 12.98it/s] 85%|████████▌ | 17/20 [00:01<00:00, 12.20it/s] 95%|█████████▌| 19/20 [00:01<00:00, 11.65it/s]100%|██████████| 20/20 [00:05<00:00,  3.73it/s]
2025-03-09 08:43:45,604 [INFO]: 	Computing best hyperparameters for index knn.index 03/09/2025, 08:43:45
2025-03-09 08:44:28,636 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 43.0314 secs
2025-03-09 08:44:28,637 [INFO]: The best hyperparameters are: efSearch=219
2025-03-09 08:44:28,637 [INFO]: 	Compute fast metrics 03/09/2025, 08:44:28
  0%|          | 0/4 [00:00<?, ?it/s] 25%|██▌       | 1/4 [00:00<00:00,  5.72it/s] 50%|█████     | 2/4 [00:00<00:00,  7.40it/s] 75%|███████▌  | 3/4 [00:00<00:00,  8.17it/s] 75%|███████▌  | 3/4 [00:00<00:00,  6.08it/s]
2025-03-09 08:44:52,909 [INFO]: 	>>> Finished "Compute fast metrics" in 24.2726 secs
2025-03-09 08:44:52,913 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 72.6804 secs
2025-03-09 08:44:52,913 [INFO]: {
2025-03-09 08:44:52,913 [INFO]: 	index_key: HNSW15
2025-03-09 08:44:52,913 [INFO]: 	index_param: efSearch=219
2025-03-09 08:44:52,913 [INFO]: 	index_path: knn.index
2025-03-09 08:44:52,913 [INFO]: 	size in bytes: 956962870
2025-03-09 08:44:52,913 [INFO]: 	avg_search_speed_ms: 9.557370008076283
2025-03-09 08:44:52,913 [INFO]: 	99p_search_speed_ms: 16.99018992949276
2025-03-09 08:44:52,913 [INFO]: 	reconstruction error %: 0.0
2025-03-09 08:44:52,913 [INFO]: 	nb vectors: 4864
2025-03-09 08:44:52,913 [INFO]: 	vectors dimension: 49152
2025-03-09 08:44:52,913 [INFO]: 	compression ratio: 0.9993086900017344
2025-03-09 08:44:52,913 [INFO]: }
2025-03-09 08:44:52,913 [INFO]: 	>>> Finished "Creating the index" in 72.6821 secs
2025-03-09 08:44:52,913 [INFO]: >>> Finished "Launching the whole pipeline" in 72.7092 secs
2025-03-09 08:44:53: [retrieval_preprocessing] calculating distances ...
2025-03-09 08:44:54: [retrieval_preprocessing] finished and saved retrieval indices for episode 15419 [episode count 17/20]
[retrieval_preprocessing] for episode 83900 [episode count 18/20], we have num_retrieval=np.int64(4906) num_query=np.int64(169)
2025-03-09 08:44:56,110 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-09 08:44:56,782 [INFO]: Launching the whole pipeline 03/09/2025, 08:44:56
2025-03-09 08:44:56,782 [INFO]: Reading total number of vectors and dimension 03/09/2025, 08:44:56
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1434.44it/s]
2025-03-09 08:44:56,808 [INFO]: There are 4906 embeddings of dim 49152
2025-03-09 08:44:56,808 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0265 secs
2025-03-09 08:44:56,808 [INFO]: 	Compute estimated construction time of the index 03/09/2025, 08:44:56
2025-03-09 08:44:56,808 [INFO]: 		-> Train: 16.7 minutes
2025-03-09 08:44:56,808 [INFO]: 		-> Add: 2.7 seconds
2025-03-09 08:44:56,808 [INFO]: 		Total: 16.7 minutes
2025-03-09 08:44:56,809 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0001 secs
2025-03-09 08:44:56,809 [INFO]: 	Checking that your have enough memory available to create the index 03/09/2025, 08:44:56
2025-03-09 08:44:56,809 [INFO]: 1012.5MB of memory will be needed to build the index (more might be used if you have more)
2025-03-09 08:44:56,809 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0001 secs
2025-03-09 08:44:56,809 [INFO]: 	Selecting most promising index types given data characteristics 03/09/2025, 08:44:56
2025-03-09 08:44:56,809 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-09 08:44:56,809 [INFO]: 	Creating the index 03/09/2025, 08:44:56
2025-03-09 08:44:56,809 [INFO]: 		-> Instanciate the index HNSW15 03/09/2025, 08:44:56
2025-03-09 08:44:56,810 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0011 secs
2025-03-09 08:44:56,810 [INFO]: 		-> Adding the vectors to the index 03/09/2025, 08:44:56
2025-03-09 08:44:56,810 [INFO]: The memory available for adding the vectors is 49.1GB(total available - used by the index)
2025-03-09 08:44:56,810 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/20 [00:00<?, ?it/s]  5%|▌         | 1/20 [00:00<00:03,  5.09it/s] 15%|█▌        | 3/20 [00:00<00:01,  9.79it/s] 25%|██▌       | 5/20 [00:00<00:01, 12.40it/s] 35%|███▌      | 7/20 [00:00<00:00, 13.64it/s] 45%|████▌     | 9/20 [00:00<00:00, 14.33it/s] 55%|█████▌    | 11/20 [00:00<00:00, 15.35it/s] 65%|██████▌   | 13/20 [00:01<00:00, 12.02it/s] 75%|███████▌  | 15/20 [00:01<00:00, 11.19it/s] 85%|████████▌ | 17/20 [00:01<00:00, 10.81it/s] 95%|█████████▌| 19/20 [00:01<00:00, 10.47it/s]100%|██████████| 20/20 [00:05<00:00,  3.62it/s]
2025-03-09 08:45:02,344 [INFO]: 	Computing best hyperparameters for index knn.index 03/09/2025, 08:45:02
2025-03-09 08:45:47,610 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 45.2658 secs
2025-03-09 08:45:47,610 [INFO]: The best hyperparameters are: efSearch=259
2025-03-09 08:45:47,611 [INFO]: 	Compute fast metrics 03/09/2025, 08:45:47
  0%|          | 0/4 [00:00<?, ?it/s] 25%|██▌       | 1/4 [00:00<00:00,  4.62it/s] 50%|█████     | 2/4 [00:00<00:00,  5.61it/s] 75%|███████▌  | 3/4 [00:00<00:00,  6.76it/s] 75%|███████▌  | 3/4 [00:00<00:00,  5.12it/s]
2025-03-09 08:46:11,273 [INFO]: 	>>> Finished "Compute fast metrics" in 23.6628 secs
2025-03-09 08:46:11,277 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 74.4666 secs
2025-03-09 08:46:11,277 [INFO]: {
2025-03-09 08:46:11,277 [INFO]: 	index_key: HNSW15
2025-03-09 08:46:11,277 [INFO]: 	index_param: efSearch=259
2025-03-09 08:46:11,277 [INFO]: 	index_path: knn.index
2025-03-09 08:46:11,277 [INFO]: 	size in bytes: 965226010
2025-03-09 08:46:11,277 [INFO]: 	avg_search_speed_ms: 10.125600189198684
2025-03-09 08:46:11,277 [INFO]: 	99p_search_speed_ms: 15.792958633974191
2025-03-09 08:46:11,277 [INFO]: 	reconstruction error %: 0.0
2025-03-09 08:46:11,277 [INFO]: 	nb vectors: 4906
2025-03-09 08:46:11,277 [INFO]: 	vectors dimension: 49152
2025-03-09 08:46:11,277 [INFO]: 	compression ratio: 0.9993088022980234
2025-03-09 08:46:11,277 [INFO]: }
2025-03-09 08:46:11,277 [INFO]: 	>>> Finished "Creating the index" in 74.4682 secs
2025-03-09 08:46:11,277 [INFO]: >>> Finished "Launching the whole pipeline" in 74.4953 secs
2025-03-09 08:46:12: [retrieval_preprocessing] calculating distances ...
2025-03-09 08:46:13: [retrieval_preprocessing] finished and saved retrieval indices for episode 83900 [episode count 18/20]
[retrieval_preprocessing] for episode 2237 [episode count 19/20], we have num_retrieval=np.int64(4853) num_query=np.int64(222)
2025-03-09 08:46:14,677 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-09 08:46:15,577 [INFO]: Launching the whole pipeline 03/09/2025, 08:46:15
2025-03-09 08:46:15,577 [INFO]: Reading total number of vectors and dimension 03/09/2025, 08:46:15
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 980.66it/s]
2025-03-09 08:46:15,602 [INFO]: There are 4853 embeddings of dim 49152
2025-03-09 08:46:15,602 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0254 secs
2025-03-09 08:46:15,602 [INFO]: 	Compute estimated construction time of the index 03/09/2025, 08:46:15
2025-03-09 08:46:15,603 [INFO]: 		-> Train: 16.7 minutes
2025-03-09 08:46:15,603 [INFO]: 		-> Add: 2.7 seconds
2025-03-09 08:46:15,603 [INFO]: 		Total: 16.7 minutes
2025-03-09 08:46:15,603 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0001 secs
2025-03-09 08:46:15,603 [INFO]: 	Checking that your have enough memory available to create the index 03/09/2025, 08:46:15
2025-03-09 08:46:15,603 [INFO]: 1001.5MB of memory will be needed to build the index (more might be used if you have more)
2025-03-09 08:46:15,603 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0003 secs
2025-03-09 08:46:15,603 [INFO]: 	Selecting most promising index types given data characteristics 03/09/2025, 08:46:15
2025-03-09 08:46:15,603 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-09 08:46:15,603 [INFO]: 	Creating the index 03/09/2025, 08:46:15
2025-03-09 08:46:15,603 [INFO]: 		-> Instanciate the index HNSW15 03/09/2025, 08:46:15
2025-03-09 08:46:15,604 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0010 secs
2025-03-09 08:46:15,604 [INFO]: 		-> Adding the vectors to the index 03/09/2025, 08:46:15
2025-03-09 08:46:15,604 [INFO]: The memory available for adding the vectors is 49.1GB(total available - used by the index)
2025-03-09 08:46:15,604 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/20 [00:00<?, ?it/s]  5%|▌         | 1/20 [00:00<00:04,  4.33it/s] 10%|█         | 2/20 [00:00<00:02,  6.20it/s] 15%|█▌        | 3/20 [00:00<00:02,  7.34it/s] 20%|██        | 4/20 [00:00<00:01,  8.19it/s] 25%|██▌       | 5/20 [00:00<00:01,  8.26it/s] 30%|███       | 6/20 [00:00<00:01,  8.32it/s] 35%|███▌      | 7/20 [00:00<00:01,  8.58it/s] 40%|████      | 8/20 [00:01<00:01,  8.82it/s] 45%|████▌     | 9/20 [00:01<00:01,  8.95it/s] 50%|█████     | 10/20 [00:01<00:01,  9.18it/s] 55%|█████▌    | 11/20 [00:01<00:00,  9.38it/s] 60%|██████    | 12/20 [00:01<00:00,  9.47it/s] 65%|██████▌   | 13/20 [00:01<00:00,  9.47it/s] 75%|███████▌  | 15/20 [00:01<00:00,  9.68it/s] 80%|████████  | 16/20 [00:01<00:00,  9.53it/s] 85%|████████▌ | 17/20 [00:01<00:00,  9.39it/s] 90%|█████████ | 18/20 [00:02<00:00,  9.29it/s] 95%|█████████▌| 19/20 [00:02<00:00,  9.23it/s]100%|██████████| 20/20 [00:05<00:00,  1.04s/it]100%|██████████| 20/20 [00:05<00:00,  3.60it/s]
2025-03-09 08:46:21,159 [INFO]: 	Computing best hyperparameters for index knn.index 03/09/2025, 08:46:21
2025-03-09 08:47:07,978 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 46.8190 secs
2025-03-09 08:47:07,979 [INFO]: The best hyperparameters are: efSearch=246
2025-03-09 08:47:07,979 [INFO]: 	Compute fast metrics 03/09/2025, 08:47:07
  0%|          | 0/4 [00:00<?, ?it/s] 25%|██▌       | 1/4 [00:00<00:00,  6.00it/s] 75%|███████▌  | 3/4 [00:00<00:00, 11.96it/s] 75%|███████▌  | 3/4 [00:00<00:00,  7.96it/s]
2025-03-09 08:47:31,737 [INFO]: 	>>> Finished "Compute fast metrics" in 23.7583 secs
2025-03-09 08:47:31,740 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 76.1359 secs
2025-03-09 08:47:31,740 [INFO]: {
2025-03-09 08:47:31,740 [INFO]: 	index_key: HNSW15
2025-03-09 08:47:31,740 [INFO]: 	index_param: efSearch=246
2025-03-09 08:47:31,740 [INFO]: 	index_path: knn.index
2025-03-09 08:47:31,740 [INFO]: 	size in bytes: 954798730
2025-03-09 08:47:31,740 [INFO]: 	avg_search_speed_ms: 8.91471999666675
2025-03-09 08:47:31,740 [INFO]: 	99p_search_speed_ms: 14.05978153925388
2025-03-09 08:47:31,740 [INFO]: 	reconstruction error %: 0.0
2025-03-09 08:47:31,741 [INFO]: 	nb vectors: 4853
2025-03-09 08:47:31,741 [INFO]: 	vectors dimension: 49152
2025-03-09 08:47:31,741 [INFO]: 	compression ratio: 0.9993086438227667
2025-03-09 08:47:31,741 [INFO]: }
2025-03-09 08:47:31,741 [INFO]: 	>>> Finished "Creating the index" in 76.1375 secs
2025-03-09 08:47:31,741 [INFO]: >>> Finished "Launching the whole pipeline" in 76.1636 secs
2025-03-09 08:47:33: [retrieval_preprocessing] calculating distances ...
2025-03-09 08:47:34: [retrieval_preprocessing] finished and saved retrieval indices for episode 2237 [episode count 19/20]
2025-03-09 08:47:34: [retrieval_preprocessing] finished for (4545879864, 'marker') [chosen_id count 4/10]
2025-03-09 08:47:37: [retrieval_preprocessing] concatenated all embeddings and indices for 20 episodes for (818725642, 'block') [chosen_id count 5/10]
2025-03-09 08:47:37: [retrieval_preprocessing] we have num_total=4585 embedding_dim=49152
[retrieval_preprocessing] for episode 41607 [episode count 0/20], we have num_retrieval=np.int64(4324) num_query=np.int64(261)
2025-03-09 08:47:39,334 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-09 08:47:39,992 [INFO]: Launching the whole pipeline 03/09/2025, 08:47:39
2025-03-09 08:47:39,992 [INFO]: Reading total number of vectors and dimension 03/09/2025, 08:47:39
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1249.05it/s]
2025-03-09 08:47:40,021 [INFO]: There are 4324 embeddings of dim 49152
2025-03-09 08:47:40,022 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0293 secs
2025-03-09 08:47:40,022 [INFO]: 	Compute estimated construction time of the index 03/09/2025, 08:47:40
2025-03-09 08:47:40,022 [INFO]: 		-> Train: 16.7 minutes
2025-03-09 08:47:40,022 [INFO]: 		-> Add: 2.4 seconds
2025-03-09 08:47:40,022 [INFO]: 		Total: 16.7 minutes
2025-03-09 08:47:40,022 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0001 secs
2025-03-09 08:47:40,022 [INFO]: 	Checking that your have enough memory available to create the index 03/09/2025, 08:47:40
2025-03-09 08:47:40,022 [INFO]: 892.4MB of memory will be needed to build the index (more might be used if you have more)
2025-03-09 08:47:40,022 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0002 secs
2025-03-09 08:47:40,022 [INFO]: 	Selecting most promising index types given data characteristics 03/09/2025, 08:47:40
2025-03-09 08:47:40,022 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-09 08:47:40,022 [INFO]: 	Creating the index 03/09/2025, 08:47:40
2025-03-09 08:47:40,022 [INFO]: 		-> Instanciate the index HNSW15 03/09/2025, 08:47:40
2025-03-09 08:47:40,024 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0012 secs
2025-03-09 08:47:40,024 [INFO]: 		-> Adding the vectors to the index 03/09/2025, 08:47:40
2025-03-09 08:47:40,024 [INFO]: The memory available for adding the vectors is 49.2GB(total available - used by the index)
2025-03-09 08:47:40,024 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/18 [00:00<?, ?it/s]  6%|▌         | 1/18 [00:00<00:03,  4.91it/s] 11%|█         | 2/18 [00:00<00:02,  6.75it/s] 17%|█▋        | 3/18 [00:00<00:01,  7.66it/s] 28%|██▊       | 5/18 [00:00<00:01,  8.91it/s] 39%|███▉      | 7/18 [00:00<00:01, 10.11it/s] 50%|█████     | 9/18 [00:00<00:00, 10.33it/s] 61%|██████    | 11/18 [00:01<00:00, 11.87it/s] 72%|███████▏  | 13/18 [00:01<00:00, 13.56it/s] 89%|████████▉ | 16/18 [00:01<00:00, 15.16it/s]100%|██████████| 18/18 [00:04<00:00,  2.00it/s]100%|██████████| 18/18 [00:04<00:00,  3.97it/s]
2025-03-09 08:47:44,565 [INFO]: 	Computing best hyperparameters for index knn.index 03/09/2025, 08:47:44
2025-03-09 08:48:28,228 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 43.6628 secs
2025-03-09 08:48:28,229 [INFO]: The best hyperparameters are: efSearch=202
2025-03-09 08:48:28,229 [INFO]: 	Compute fast metrics 03/09/2025, 08:48:28
  0%|          | 0/4 [00:00<?, ?it/s] 25%|██▌       | 1/4 [00:00<00:00,  5.64it/s] 50%|█████     | 2/4 [00:00<00:00,  7.38it/s] 75%|███████▌  | 3/4 [00:00<00:00,  8.06it/s] 75%|███████▌  | 3/4 [00:00<00:00,  6.03it/s]
2025-03-09 08:48:50,164 [INFO]: 	>>> Finished "Compute fast metrics" in 21.9352 secs
2025-03-09 08:48:50,167 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 70.1432 secs
2025-03-09 08:48:50,167 [INFO]: {
2025-03-09 08:48:50,167 [INFO]: 	index_key: HNSW15
2025-03-09 08:48:50,167 [INFO]: 	index_param: efSearch=202
2025-03-09 08:48:50,167 [INFO]: 	index_path: knn.index
2025-03-09 08:48:50,167 [INFO]: 	size in bytes: 850721170
2025-03-09 08:48:50,167 [INFO]: 	avg_search_speed_ms: 8.423703868395595
2025-03-09 08:48:50,167 [INFO]: 	99p_search_speed_ms: 13.121571433730427
2025-03-09 08:48:50,167 [INFO]: 	reconstruction error %: 0.0
2025-03-09 08:48:50,167 [INFO]: 	nb vectors: 4324
2025-03-09 08:48:50,167 [INFO]: 	vectors dimension: 49152
2025-03-09 08:48:50,167 [INFO]: 	compression ratio: 0.9993086124799269
2025-03-09 08:48:50,167 [INFO]: }
2025-03-09 08:48:50,167 [INFO]: 	>>> Finished "Creating the index" in 70.1450 secs
2025-03-09 08:48:50,167 [INFO]: >>> Finished "Launching the whole pipeline" in 70.1751 secs
2025-03-09 08:48:52: [retrieval_preprocessing] calculating distances ...
2025-03-09 08:48:53: [retrieval_preprocessing] finished and saved retrieval indices for episode 41607 [episode count 0/20]
[retrieval_preprocessing] for episode 74759 [episode count 1/20], we have num_retrieval=np.int64(4358) num_query=np.int64(227)
2025-03-09 08:48:54,544 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-09 08:48:55,200 [INFO]: Launching the whole pipeline 03/09/2025, 08:48:55
2025-03-09 08:48:55,200 [INFO]: Reading total number of vectors and dimension 03/09/2025, 08:48:55
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1507.12it/s]
2025-03-09 08:48:55,229 [INFO]: There are 4358 embeddings of dim 49152
2025-03-09 08:48:55,229 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0292 secs
2025-03-09 08:48:55,229 [INFO]: 	Compute estimated construction time of the index 03/09/2025, 08:48:55
2025-03-09 08:48:55,229 [INFO]: 		-> Train: 16.7 minutes
2025-03-09 08:48:55,229 [INFO]: 		-> Add: 2.4 seconds
2025-03-09 08:48:55,229 [INFO]: 		Total: 16.7 minutes
2025-03-09 08:48:55,229 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0001 secs
2025-03-09 08:48:55,229 [INFO]: 	Checking that your have enough memory available to create the index 03/09/2025, 08:48:55
2025-03-09 08:48:55,230 [INFO]: 899.4MB of memory will be needed to build the index (more might be used if you have more)
2025-03-09 08:48:55,230 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0001 secs
2025-03-09 08:48:55,230 [INFO]: 	Selecting most promising index types given data characteristics 03/09/2025, 08:48:55
2025-03-09 08:48:55,230 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-09 08:48:55,230 [INFO]: 	Creating the index 03/09/2025, 08:48:55
2025-03-09 08:48:55,230 [INFO]: 		-> Instanciate the index HNSW15 03/09/2025, 08:48:55
2025-03-09 08:48:55,231 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0011 secs
2025-03-09 08:48:55,231 [INFO]: 		-> Adding the vectors to the index 03/09/2025, 08:48:55
2025-03-09 08:48:55,231 [INFO]: The memory available for adding the vectors is 49.2GB(total available - used by the index)
2025-03-09 08:48:55,231 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/18 [00:00<?, ?it/s]  6%|▌         | 1/18 [00:00<00:03,  4.88it/s] 17%|█▋        | 3/18 [00:00<00:01,  9.06it/s] 28%|██▊       | 5/18 [00:00<00:01, 10.73it/s] 39%|███▉      | 7/18 [00:00<00:01, 10.32it/s] 50%|█████     | 9/18 [00:00<00:00, 10.07it/s] 61%|██████    | 11/18 [00:01<00:00,  9.75it/s] 67%|██████▋   | 12/18 [00:01<00:00,  9.58it/s] 72%|███████▏  | 13/18 [00:01<00:00,  9.55it/s] 78%|███████▊  | 14/18 [00:01<00:00,  9.52it/s] 83%|████████▎ | 15/18 [00:01<00:00,  9.59it/s] 94%|█████████▍| 17/18 [00:01<00:00, 10.50it/s]100%|██████████| 18/18 [00:05<00:00,  3.49it/s]
2025-03-09 08:49:00,399 [INFO]: 	Computing best hyperparameters for index knn.index 03/09/2025, 08:49:00
2025-03-09 08:49:52,639 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 52.2400 secs
2025-03-09 08:49:52,640 [INFO]: The best hyperparameters are: efSearch=200
2025-03-09 08:49:52,640 [INFO]: 	Compute fast metrics 03/09/2025, 08:49:52
  0%|          | 0/4 [00:00<?, ?it/s] 25%|██▌       | 1/4 [00:00<00:00,  5.22it/s] 50%|█████     | 2/4 [00:00<00:00,  7.19it/s] 75%|███████▌  | 3/4 [00:00<00:00,  7.96it/s] 75%|███████▌  | 3/4 [00:00<00:00,  5.96it/s]
2025-03-09 08:50:12,856 [INFO]: 	>>> Finished "Compute fast metrics" in 20.2164 secs
2025-03-09 08:50:13,368 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 78.1367 secs
2025-03-09 08:50:13,368 [INFO]: {
2025-03-09 08:50:13,368 [INFO]: 	index_key: HNSW15
2025-03-09 08:50:13,368 [INFO]: 	index_param: efSearch=200
2025-03-09 08:50:13,368 [INFO]: 	index_path: knn.index
2025-03-09 08:50:13,368 [INFO]: 	size in bytes: 857410510
2025-03-09 08:50:13,368 [INFO]: 	avg_search_speed_ms: 8.860038515045064
2025-03-09 08:50:13,368 [INFO]: 	99p_search_speed_ms: 15.244370736181741
2025-03-09 08:50:13,369 [INFO]: 	reconstruction error %: 0.0
2025-03-09 08:50:13,369 [INFO]: 	nb vectors: 4358
2025-03-09 08:50:13,369 [INFO]: 	vectors dimension: 49152
2025-03-09 08:50:13,369 [INFO]: 	compression ratio: 0.9993085622428398
2025-03-09 08:50:13,369 [INFO]: }
2025-03-09 08:50:13,369 [INFO]: 	>>> Finished "Creating the index" in 78.1390 secs
2025-03-09 08:50:13,369 [INFO]: >>> Finished "Launching the whole pipeline" in 78.1688 secs
2025-03-09 08:50:14: [retrieval_preprocessing] calculating distances ...
2025-03-09 08:50:15: [retrieval_preprocessing] finished and saved retrieval indices for episode 74759 [episode count 1/20]
[retrieval_preprocessing] for episode 4105 [episode count 2/20], we have num_retrieval=np.int64(4406) num_query=np.int64(179)
2025-03-09 08:50:16,830 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-09 08:50:17,423 [INFO]: Launching the whole pipeline 03/09/2025, 08:50:17
2025-03-09 08:50:17,423 [INFO]: Reading total number of vectors and dimension 03/09/2025, 08:50:17
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1165.08it/s]
2025-03-09 08:50:17,451 [INFO]: There are 4406 embeddings of dim 49152
2025-03-09 08:50:17,451 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0287 secs
2025-03-09 08:50:17,452 [INFO]: 	Compute estimated construction time of the index 03/09/2025, 08:50:17
2025-03-09 08:50:17,452 [INFO]: 		-> Train: 16.7 minutes
2025-03-09 08:50:17,452 [INFO]: 		-> Add: 2.4 seconds
2025-03-09 08:50:17,452 [INFO]: 		Total: 16.7 minutes
2025-03-09 08:50:17,452 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0001 secs
2025-03-09 08:50:17,452 [INFO]: 	Checking that your have enough memory available to create the index 03/09/2025, 08:50:17
2025-03-09 08:50:17,452 [INFO]: 909.3MB of memory will be needed to build the index (more might be used if you have more)
2025-03-09 08:50:17,452 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0002 secs
2025-03-09 08:50:17,452 [INFO]: 	Selecting most promising index types given data characteristics 03/09/2025, 08:50:17
2025-03-09 08:50:17,452 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-09 08:50:17,452 [INFO]: 	Creating the index 03/09/2025, 08:50:17
2025-03-09 08:50:17,452 [INFO]: 		-> Instanciate the index HNSW15 03/09/2025, 08:50:17
2025-03-09 08:50:17,453 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0012 secs
2025-03-09 08:50:17,453 [INFO]: 		-> Adding the vectors to the index 03/09/2025, 08:50:17
2025-03-09 08:50:17,453 [INFO]: The memory available for adding the vectors is 49.2GB(total available - used by the index)
2025-03-09 08:50:17,454 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/18 [00:00<?, ?it/s]  6%|▌         | 1/18 [00:00<00:03,  5.39it/s] 17%|█▋        | 3/18 [00:00<00:01,  9.24it/s] 28%|██▊       | 5/18 [00:00<00:01, 10.70it/s] 39%|███▉      | 7/18 [00:00<00:00, 11.33it/s] 50%|█████     | 9/18 [00:00<00:00, 11.72it/s] 61%|██████    | 11/18 [00:00<00:00, 12.05it/s] 72%|███████▏  | 13/18 [00:01<00:00, 12.20it/s] 83%|████████▎ | 15/18 [00:01<00:00, 11.99it/s] 94%|█████████▍| 17/18 [00:01<00:00, 11.99it/s]100%|██████████| 18/18 [00:04<00:00,  3.91it/s]
2025-03-09 08:50:22,057 [INFO]: 	Computing best hyperparameters for index knn.index 03/09/2025, 08:50:22
2025-03-09 08:51:13,649 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 51.5909 secs
2025-03-09 08:51:13,649 [INFO]: The best hyperparameters are: efSearch=219
2025-03-09 08:51:13,649 [INFO]: 	Compute fast metrics 03/09/2025, 08:51:13
  0%|          | 0/4 [00:00<?, ?it/s] 25%|██▌       | 1/4 [00:00<00:00,  4.91it/s] 50%|█████     | 2/4 [00:00<00:00,  6.45it/s] 75%|███████▌  | 3/4 [00:00<00:00,  6.90it/s] 75%|███████▌  | 3/4 [00:00<00:00,  5.16it/s]
2025-03-09 08:51:29,803 [INFO]: 	>>> Finished "Compute fast metrics" in 16.1544 secs
2025-03-09 08:51:29,806 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 72.3528 secs
2025-03-09 08:51:29,806 [INFO]: {
2025-03-09 08:51:29,806 [INFO]: 	index_key: HNSW15
2025-03-09 08:51:29,806 [INFO]: 	index_param: efSearch=219
2025-03-09 08:51:29,806 [INFO]: 	index_path: knn.index
2025-03-09 08:51:29,806 [INFO]: 	size in bytes: 866854150
2025-03-09 08:51:29,806 [INFO]: 	avg_search_speed_ms: 10.384145079043412
2025-03-09 08:51:29,806 [INFO]: 	99p_search_speed_ms: 17.91935078566894
2025-03-09 08:51:29,806 [INFO]: 	reconstruction error %: 0.0
2025-03-09 08:51:29,807 [INFO]: 	nb vectors: 4406
2025-03-09 08:51:29,807 [INFO]: 	vectors dimension: 49152
2025-03-09 08:51:29,807 [INFO]: 	compression ratio: 0.9993086472505207
2025-03-09 08:51:29,807 [INFO]: }
2025-03-09 08:51:29,807 [INFO]: 	>>> Finished "Creating the index" in 72.3545 secs
2025-03-09 08:51:29,807 [INFO]: >>> Finished "Launching the whole pipeline" in 72.3838 secs
2025-03-09 08:51:30: [retrieval_preprocessing] calculating distances ...
2025-03-09 08:51:31: [retrieval_preprocessing] finished and saved retrieval indices for episode 4105 [episode count 2/20]
[retrieval_preprocessing] for episode 10635 [episode count 3/20], we have num_retrieval=np.int64(4360) num_query=np.int64(225)
2025-03-09 08:51:33,329 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-09 08:51:34,078 [INFO]: Launching the whole pipeline 03/09/2025, 08:51:34
2025-03-09 08:51:34,078 [INFO]: Reading total number of vectors and dimension 03/09/2025, 08:51:34
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1430.04it/s]
2025-03-09 08:51:34,106 [INFO]: There are 4360 embeddings of dim 49152
2025-03-09 08:51:34,106 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0285 secs
2025-03-09 08:51:34,106 [INFO]: 	Compute estimated construction time of the index 03/09/2025, 08:51:34
2025-03-09 08:51:34,106 [INFO]: 		-> Train: 16.7 minutes
2025-03-09 08:51:34,107 [INFO]: 		-> Add: 2.4 seconds
2025-03-09 08:51:34,107 [INFO]: 		Total: 16.7 minutes
2025-03-09 08:51:34,107 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0001 secs
2025-03-09 08:51:34,107 [INFO]: 	Checking that your have enough memory available to create the index 03/09/2025, 08:51:34
2025-03-09 08:51:34,107 [INFO]: 899.8MB of memory will be needed to build the index (more might be used if you have more)
2025-03-09 08:51:34,107 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0003 secs
2025-03-09 08:51:34,107 [INFO]: 	Selecting most promising index types given data characteristics 03/09/2025, 08:51:34
2025-03-09 08:51:34,107 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-09 08:51:34,107 [INFO]: 	Creating the index 03/09/2025, 08:51:34
2025-03-09 08:51:34,107 [INFO]: 		-> Instanciate the index HNSW15 03/09/2025, 08:51:34
2025-03-09 08:51:34,108 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0011 secs
2025-03-09 08:51:34,108 [INFO]: 		-> Adding the vectors to the index 03/09/2025, 08:51:34
2025-03-09 08:51:34,108 [INFO]: The memory available for adding the vectors is 49.2GB(total available - used by the index)
2025-03-09 08:51:34,108 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/18 [00:00<?, ?it/s]  6%|▌         | 1/18 [00:00<00:03,  5.05it/s] 11%|█         | 2/18 [00:00<00:02,  6.82it/s] 17%|█▋        | 3/18 [00:00<00:01,  7.95it/s] 22%|██▏       | 4/18 [00:00<00:01,  8.44it/s] 28%|██▊       | 5/18 [00:00<00:01,  8.67it/s] 33%|███▎      | 6/18 [00:00<00:01,  8.88it/s] 39%|███▉      | 7/18 [00:00<00:01,  8.94it/s] 44%|████▍     | 8/18 [00:00<00:01,  9.02it/s] 50%|█████     | 9/18 [00:01<00:01,  8.97it/s] 56%|█████▌    | 10/18 [00:01<00:00,  8.94it/s] 61%|██████    | 11/18 [00:01<00:00,  8.94it/s] 67%|██████▋   | 12/18 [00:01<00:00,  8.95it/s] 72%|███████▏  | 13/18 [00:01<00:00,  9.07it/s] 78%|███████▊  | 14/18 [00:01<00:00,  9.05it/s] 83%|████████▎ | 15/18 [00:01<00:00,  9.01it/s] 94%|█████████▍| 17/18 [00:01<00:00, 10.27it/s]100%|██████████| 18/18 [00:05<00:00,  1.10it/s]100%|██████████| 18/18 [00:05<00:00,  3.42it/s]
2025-03-09 08:51:39,380 [INFO]: 	Computing best hyperparameters for index knn.index 03/09/2025, 08:51:39
2025-03-09 08:52:28,028 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 48.6472 secs
2025-03-09 08:52:28,028 [INFO]: The best hyperparameters are: efSearch=199
2025-03-09 08:52:28,028 [INFO]: 	Compute fast metrics 03/09/2025, 08:52:28
  0%|          | 0/4 [00:00<?, ?it/s] 25%|██▌       | 1/4 [00:00<00:00,  5.14it/s] 50%|█████     | 2/4 [00:00<00:00,  6.88it/s] 75%|███████▌  | 3/4 [00:00<00:00,  7.49it/s] 75%|███████▌  | 3/4 [00:00<00:00,  5.58it/s]
2025-03-09 08:52:50,951 [INFO]: 	>>> Finished "Compute fast metrics" in 22.9232 secs
2025-03-09 08:52:50,954 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 76.8459 secs
2025-03-09 08:52:50,954 [INFO]: {
2025-03-09 08:52:50,954 [INFO]: 	index_key: HNSW15
2025-03-09 08:52:50,954 [INFO]: 	index_param: efSearch=199
2025-03-09 08:52:50,954 [INFO]: 	index_path: knn.index
2025-03-09 08:52:50,954 [INFO]: 	size in bytes: 857803990
2025-03-09 08:52:50,954 [INFO]: 	avg_search_speed_ms: 9.45090928109669
2025-03-09 08:52:50,954 [INFO]: 	99p_search_speed_ms: 18.716122717596612
2025-03-09 08:52:50,955 [INFO]: 	reconstruction error %: 0.0
2025-03-09 08:52:50,955 [INFO]: 	nb vectors: 4360
2025-03-09 08:52:50,955 [INFO]: 	vectors dimension: 49152
2025-03-09 08:52:50,955 [INFO]: 	compression ratio: 0.9993085716470029
2025-03-09 08:52:50,955 [INFO]: }
2025-03-09 08:52:50,955 [INFO]: 	>>> Finished "Creating the index" in 76.8475 secs
2025-03-09 08:52:50,955 [INFO]: >>> Finished "Launching the whole pipeline" in 76.8768 secs
2025-03-09 08:52:52: [retrieval_preprocessing] calculating distances ...
2025-03-09 08:52:52: [retrieval_preprocessing] finished and saved retrieval indices for episode 10635 [episode count 3/20]
[retrieval_preprocessing] for episode 50699 [episode count 4/20], we have num_retrieval=np.int64(4292) num_query=np.int64(293)
2025-03-09 08:52:54,010 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-09 08:52:54,633 [INFO]: Launching the whole pipeline 03/09/2025, 08:52:54
2025-03-09 08:52:54,633 [INFO]: Reading total number of vectors and dimension 03/09/2025, 08:52:54
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1172.90it/s]
2025-03-09 08:52:54,659 [INFO]: There are 4292 embeddings of dim 49152
2025-03-09 08:52:54,659 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0259 secs
2025-03-09 08:52:54,659 [INFO]: 	Compute estimated construction time of the index 03/09/2025, 08:52:54
2025-03-09 08:52:54,660 [INFO]: 		-> Train: 16.7 minutes
2025-03-09 08:52:54,660 [INFO]: 		-> Add: 2.4 seconds
2025-03-09 08:52:54,660 [INFO]: 		Total: 16.7 minutes
2025-03-09 08:52:54,660 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0001 secs
2025-03-09 08:52:54,660 [INFO]: 	Checking that your have enough memory available to create the index 03/09/2025, 08:52:54
2025-03-09 08:52:54,660 [INFO]: 885.8MB of memory will be needed to build the index (more might be used if you have more)
2025-03-09 08:52:54,660 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0001 secs
2025-03-09 08:52:54,660 [INFO]: 	Selecting most promising index types given data characteristics 03/09/2025, 08:52:54
2025-03-09 08:52:54,660 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-09 08:52:54,660 [INFO]: 	Creating the index 03/09/2025, 08:52:54
2025-03-09 08:52:54,660 [INFO]: 		-> Instanciate the index HNSW15 03/09/2025, 08:52:54
2025-03-09 08:52:54,661 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0010 secs
2025-03-09 08:52:54,661 [INFO]: 		-> Adding the vectors to the index 03/09/2025, 08:52:54
2025-03-09 08:52:54,661 [INFO]: The memory available for adding the vectors is 49.2GB(total available - used by the index)
2025-03-09 08:52:54,661 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/17 [00:00<?, ?it/s]  6%|▌         | 1/17 [00:00<00:02,  5.92it/s] 18%|█▊        | 3/17 [00:00<00:01,  9.13it/s] 29%|██▉       | 5/17 [00:00<00:01, 10.37it/s] 41%|████      | 7/17 [00:00<00:00, 10.87it/s] 53%|█████▎    | 9/17 [00:00<00:00, 11.15it/s] 65%|██████▍   | 11/17 [00:01<00:00, 11.30it/s] 76%|███████▋  | 13/17 [00:01<00:00, 11.36it/s] 88%|████████▊ | 15/17 [00:01<00:00, 11.45it/s]100%|██████████| 17/17 [00:04<00:00,  1.74it/s]100%|██████████| 17/17 [00:04<00:00,  3.67it/s]
2025-03-09 08:52:59,304 [INFO]: 	Computing best hyperparameters for index knn.index 03/09/2025, 08:52:59
2025-03-09 08:53:51,624 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 52.3194 secs
2025-03-09 08:53:51,624 [INFO]: The best hyperparameters are: efSearch=197
2025-03-09 08:53:51,624 [INFO]: 	Compute fast metrics 03/09/2025, 08:53:51
  0%|          | 0/4 [00:00<?, ?it/s] 25%|██▌       | 1/4 [00:00<00:00,  8.12it/s] 75%|███████▌  | 3/4 [00:00<00:00, 11.80it/s] 75%|███████▌  | 3/4 [00:00<00:00,  9.14it/s]
2025-03-09 08:54:10,312 [INFO]: 	>>> Finished "Compute fast metrics" in 18.6874 secs
2025-03-09 08:54:10,315 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 75.6535 secs
2025-03-09 08:54:10,315 [INFO]: {
2025-03-09 08:54:10,315 [INFO]: 	index_key: HNSW15
2025-03-09 08:54:10,315 [INFO]: 	index_param: efSearch=197
2025-03-09 08:54:10,315 [INFO]: 	index_path: knn.index
2025-03-09 08:54:10,315 [INFO]: 	size in bytes: 844425310
2025-03-09 08:54:10,315 [INFO]: 	avg_search_speed_ms: 8.81686993045946
2025-03-09 08:54:10,315 [INFO]: 	99p_search_speed_ms: 16.395536225754782
2025-03-09 08:54:10,315 [INFO]: 	reconstruction error %: 0.0
2025-03-09 08:54:10,315 [INFO]: 	nb vectors: 4292
2025-03-09 08:54:10,315 [INFO]: 	vectors dimension: 49152
2025-03-09 08:54:10,315 [INFO]: 	compression ratio: 0.9993086730192869
2025-03-09 08:54:10,315 [INFO]: }
2025-03-09 08:54:10,315 [INFO]: 	>>> Finished "Creating the index" in 75.6551 secs
2025-03-09 08:54:10,315 [INFO]: >>> Finished "Launching the whole pipeline" in 75.6816 secs
2025-03-09 08:54:11: [retrieval_preprocessing] calculating distances ...
2025-03-09 08:54:12: [retrieval_preprocessing] finished and saved retrieval indices for episode 50699 [episode count 4/20]
[retrieval_preprocessing] for episode 50189 [episode count 5/20], we have num_retrieval=np.int64(4372) num_query=np.int64(213)
2025-03-09 08:54:14,703 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-09 08:54:15,369 [INFO]: Launching the whole pipeline 03/09/2025, 08:54:15
2025-03-09 08:54:15,369 [INFO]: Reading total number of vectors and dimension 03/09/2025, 08:54:15
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1432.48it/s]
2025-03-09 08:54:15,399 [INFO]: There are 4372 embeddings of dim 49152
2025-03-09 08:54:15,399 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0294 secs
2025-03-09 08:54:15,399 [INFO]: 	Compute estimated construction time of the index 03/09/2025, 08:54:15
2025-03-09 08:54:15,399 [INFO]: 		-> Train: 16.7 minutes
2025-03-09 08:54:15,399 [INFO]: 		-> Add: 2.4 seconds
2025-03-09 08:54:15,399 [INFO]: 		Total: 16.7 minutes
2025-03-09 08:54:15,399 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0001 secs
2025-03-09 08:54:15,400 [INFO]: 	Checking that your have enough memory available to create the index 03/09/2025, 08:54:15
2025-03-09 08:54:15,400 [INFO]: 902.3MB of memory will be needed to build the index (more might be used if you have more)
2025-03-09 08:54:15,400 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0002 secs
2025-03-09 08:54:15,400 [INFO]: 	Selecting most promising index types given data characteristics 03/09/2025, 08:54:15
2025-03-09 08:54:15,400 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-09 08:54:15,400 [INFO]: 	Creating the index 03/09/2025, 08:54:15
2025-03-09 08:54:15,400 [INFO]: 		-> Instanciate the index HNSW15 03/09/2025, 08:54:15
2025-03-09 08:54:15,401 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0011 secs
2025-03-09 08:54:15,401 [INFO]: 		-> Adding the vectors to the index 03/09/2025, 08:54:15
2025-03-09 08:54:15,401 [INFO]: The memory available for adding the vectors is 49.2GB(total available - used by the index)
2025-03-09 08:54:15,401 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/18 [00:00<?, ?it/s]  6%|▌         | 1/18 [00:00<00:03,  5.45it/s] 17%|█▋        | 3/18 [00:00<00:01,  8.24it/s] 22%|██▏       | 4/18 [00:00<00:01,  8.65it/s] 28%|██▊       | 5/18 [00:00<00:01,  8.72it/s] 33%|███▎      | 6/18 [00:00<00:01,  8.65it/s] 39%|███▉      | 7/18 [00:00<00:01,  8.89it/s] 44%|████▍     | 8/18 [00:00<00:01,  8.91it/s] 50%|█████     | 9/18 [00:01<00:00,  9.02it/s] 56%|█████▌    | 10/18 [00:01<00:00,  9.10it/s] 61%|██████    | 11/18 [00:01<00:00,  9.13it/s] 67%|██████▋   | 12/18 [00:01<00:00,  9.05it/s] 72%|███████▏  | 13/18 [00:01<00:00,  9.09it/s] 83%|████████▎ | 15/18 [00:01<00:00, 10.20it/s] 94%|█████████▍| 17/18 [00:01<00:00, 10.84it/s]100%|██████████| 18/18 [00:05<00:00,  3.57it/s]
2025-03-09 08:54:20,442 [INFO]: 	Computing best hyperparameters for index knn.index 03/09/2025, 08:54:20
2025-03-09 08:55:09,605 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 49.1624 secs
2025-03-09 08:55:09,605 [INFO]: The best hyperparameters are: efSearch=188
2025-03-09 08:55:09,605 [INFO]: 	Compute fast metrics 03/09/2025, 08:55:09
  0%|          | 0/4 [00:00<?, ?it/s] 25%|██▌       | 1/4 [00:00<00:00,  5.36it/s] 50%|█████     | 2/4 [00:00<00:00,  6.92it/s] 75%|███████▌  | 3/4 [00:00<00:00,  7.66it/s] 75%|███████▌  | 3/4 [00:00<00:00,  5.90it/s]
2025-03-09 08:55:28,481 [INFO]: 	>>> Finished "Compute fast metrics" in 18.8758 secs
2025-03-09 08:55:28,484 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 73.0827 secs
2025-03-09 08:55:28,484 [INFO]: {
2025-03-09 08:55:28,484 [INFO]: 	index_key: HNSW15
2025-03-09 08:55:28,484 [INFO]: 	index_param: efSearch=188
2025-03-09 08:55:28,484 [INFO]: 	index_path: knn.index
2025-03-09 08:55:28,484 [INFO]: 	size in bytes: 860164870
2025-03-09 08:55:28,484 [INFO]: 	avg_search_speed_ms: 8.742703889110745
2025-03-09 08:55:28,484 [INFO]: 	99p_search_speed_ms: 14.951792398933302
2025-03-09 08:55:28,484 [INFO]: 	reconstruction error %: 0.0
2025-03-09 08:55:28,484 [INFO]: 	nb vectors: 4372
2025-03-09 08:55:28,484 [INFO]: 	vectors dimension: 49152
2025-03-09 08:55:28,484 [INFO]: 	compression ratio: 0.9993086278913018
2025-03-09 08:55:28,484 [INFO]: }
2025-03-09 08:55:28,484 [INFO]: 	>>> Finished "Creating the index" in 73.0842 secs
2025-03-09 08:55:28,484 [INFO]: >>> Finished "Launching the whole pipeline" in 73.1148 secs
2025-03-09 08:55:29: [retrieval_preprocessing] calculating distances ...
2025-03-09 08:55:30: [retrieval_preprocessing] finished and saved retrieval indices for episode 50189 [episode count 5/20]
[retrieval_preprocessing] for episode 45328 [episode count 6/20], we have num_retrieval=np.int64(4347) num_query=np.int64(238)
2025-03-09 08:55:31,708 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-09 08:55:32,321 [INFO]: Launching the whole pipeline 03/09/2025, 08:55:32
2025-03-09 08:55:32,321 [INFO]: Reading total number of vectors and dimension 03/09/2025, 08:55:32
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1698.10it/s]
2025-03-09 08:55:32,347 [INFO]: There are 4347 embeddings of dim 49152
2025-03-09 08:55:32,347 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0256 secs
2025-03-09 08:55:32,347 [INFO]: 	Compute estimated construction time of the index 03/09/2025, 08:55:32
2025-03-09 08:55:32,347 [INFO]: 		-> Train: 16.7 minutes
2025-03-09 08:55:32,347 [INFO]: 		-> Add: 2.4 seconds
2025-03-09 08:55:32,347 [INFO]: 		Total: 16.7 minutes
2025-03-09 08:55:32,347 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0001 secs
2025-03-09 08:55:32,347 [INFO]: 	Checking that your have enough memory available to create the index 03/09/2025, 08:55:32
2025-03-09 08:55:32,347 [INFO]: 897.1MB of memory will be needed to build the index (more might be used if you have more)
2025-03-09 08:55:32,347 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0001 secs
2025-03-09 08:55:32,347 [INFO]: 	Selecting most promising index types given data characteristics 03/09/2025, 08:55:32
2025-03-09 08:55:32,347 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-09 08:55:32,347 [INFO]: 	Creating the index 03/09/2025, 08:55:32
2025-03-09 08:55:32,347 [INFO]: 		-> Instanciate the index HNSW15 03/09/2025, 08:55:32
2025-03-09 08:55:32,348 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0009 secs
2025-03-09 08:55:32,349 [INFO]: 		-> Adding the vectors to the index 03/09/2025, 08:55:32
2025-03-09 08:55:32,349 [INFO]: The memory available for adding the vectors is 49.2GB(total available - used by the index)
2025-03-09 08:55:32,349 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/18 [00:00<?, ?it/s]  6%|▌         | 1/18 [00:00<00:03,  5.24it/s] 17%|█▋        | 3/18 [00:00<00:01,  9.17it/s] 28%|██▊       | 5/18 [00:00<00:01, 10.46it/s] 39%|███▉      | 7/18 [00:00<00:00, 11.15it/s] 50%|█████     | 9/18 [00:00<00:00, 11.66it/s] 61%|██████    | 11/18 [00:01<00:00, 11.85it/s] 72%|███████▏  | 13/18 [00:01<00:00, 11.86it/s] 83%|████████▎ | 15/18 [00:01<00:00, 11.93it/s] 94%|█████████▍| 17/18 [00:01<00:00, 11.96it/s]100%|██████████| 18/18 [00:05<00:00,  3.51it/s]
2025-03-09 08:55:37,479 [INFO]: 	Computing best hyperparameters for index knn.index 03/09/2025, 08:55:37
2025-03-09 08:56:33,194 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 55.7134 secs
2025-03-09 08:56:33,194 [INFO]: The best hyperparameters are: efSearch=196
2025-03-09 08:56:33,194 [INFO]: 	Compute fast metrics 03/09/2025, 08:56:33
  0%|          | 0/4 [00:00<?, ?it/s] 50%|█████     | 2/4 [00:00<00:00, 19.52it/s] 75%|███████▌  | 3/4 [00:00<00:00, 20.59it/s]
2025-03-09 08:56:47,901 [INFO]: 	>>> Finished "Compute fast metrics" in 14.7069 secs
2025-03-09 08:56:47,904 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 75.5554 secs
2025-03-09 08:56:47,904 [INFO]: {
2025-03-09 08:56:47,904 [INFO]: 	index_key: HNSW15
2025-03-09 08:56:47,904 [INFO]: 	index_param: efSearch=196
2025-03-09 08:56:47,904 [INFO]: 	index_path: knn.index
2025-03-09 08:56:47,904 [INFO]: 	size in bytes: 855246310
2025-03-09 08:56:47,904 [INFO]: 	avg_search_speed_ms: 9.736255591620981
2025-03-09 08:56:47,904 [INFO]: 	99p_search_speed_ms: 18.95069929305464
2025-03-09 08:56:47,904 [INFO]: 	reconstruction error %: 0.0
2025-03-09 08:56:47,904 [INFO]: 	nb vectors: 4347
2025-03-09 08:56:47,904 [INFO]: 	vectors dimension: 49152
2025-03-09 08:56:47,904 [INFO]: 	compression ratio: 0.9993085804719812
2025-03-09 08:56:47,904 [INFO]: }
2025-03-09 08:56:47,904 [INFO]: 	>>> Finished "Creating the index" in 75.5569 secs
2025-03-09 08:56:47,904 [INFO]: >>> Finished "Launching the whole pipeline" in 75.5830 secs
2025-03-09 08:56:49: [retrieval_preprocessing] calculating distances ...
2025-03-09 08:56:49: [retrieval_preprocessing] finished and saved retrieval indices for episode 45328 [episode count 6/20]
[retrieval_preprocessing] for episode 36508 [episode count 7/20], we have num_retrieval=np.int64(4383) num_query=np.int64(202)
2025-03-09 08:56:50,277 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-09 08:56:51,122 [INFO]: Launching the whole pipeline 03/09/2025, 08:56:51
2025-03-09 08:56:51,122 [INFO]: Reading total number of vectors and dimension 03/09/2025, 08:56:51
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 760.39it/s]
2025-03-09 08:56:51,154 [INFO]: There are 4383 embeddings of dim 49152
2025-03-09 08:56:51,154 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0321 secs
2025-03-09 08:56:51,154 [INFO]: 	Compute estimated construction time of the index 03/09/2025, 08:56:51
2025-03-09 08:56:51,154 [INFO]: 		-> Train: 16.7 minutes
2025-03-09 08:56:51,154 [INFO]: 		-> Add: 2.4 seconds
2025-03-09 08:56:51,155 [INFO]: 		Total: 16.7 minutes
2025-03-09 08:56:51,155 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0003 secs
2025-03-09 08:56:51,155 [INFO]: 	Checking that your have enough memory available to create the index 03/09/2025, 08:56:51
2025-03-09 08:56:51,155 [INFO]: 904.5MB of memory will be needed to build the index (more might be used if you have more)
2025-03-09 08:56:51,155 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0005 secs
2025-03-09 08:56:51,155 [INFO]: 	Selecting most promising index types given data characteristics 03/09/2025, 08:56:51
2025-03-09 08:56:51,155 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-09 08:56:51,155 [INFO]: 	Creating the index 03/09/2025, 08:56:51
2025-03-09 08:56:51,156 [INFO]: 		-> Instanciate the index HNSW15 03/09/2025, 08:56:51
2025-03-09 08:56:51,158 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0027 secs
2025-03-09 08:56:51,159 [INFO]: 		-> Adding the vectors to the index 03/09/2025, 08:56:51
2025-03-09 08:56:51,159 [INFO]: The memory available for adding the vectors is 49.2GB(total available - used by the index)
2025-03-09 08:56:51,159 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/18 [00:00<?, ?it/s]  6%|▌         | 1/18 [00:00<00:03,  4.72it/s] 11%|█         | 2/18 [00:00<00:02,  6.59it/s] 17%|█▋        | 3/18 [00:00<00:02,  7.26it/s] 22%|██▏       | 4/18 [00:00<00:01,  7.72it/s] 28%|██▊       | 5/18 [00:00<00:01,  7.93it/s] 33%|███▎      | 6/18 [00:00<00:01,  8.01it/s] 39%|███▉      | 7/18 [00:00<00:01,  8.31it/s] 44%|████▍     | 8/18 [00:01<00:01,  8.36it/s] 50%|█████     | 9/18 [00:01<00:01,  8.41it/s] 56%|█████▌    | 10/18 [00:01<00:00,  8.36it/s] 61%|██████    | 11/18 [00:01<00:00,  8.44it/s] 67%|██████▋   | 12/18 [00:01<00:00,  8.55it/s] 72%|███████▏  | 13/18 [00:01<00:00,  8.54it/s] 78%|███████▊  | 14/18 [00:01<00:00,  8.49it/s] 83%|████████▎ | 15/18 [00:01<00:00,  8.54it/s] 89%|████████▉ | 16/18 [00:01<00:00,  8.53it/s] 94%|█████████▍| 17/18 [00:02<00:00,  8.48it/s]100%|██████████| 18/18 [00:05<00:00,  1.23s/it]100%|██████████| 18/18 [00:05<00:00,  3.04it/s]
2025-03-09 08:56:57,340 [INFO]: 	Computing best hyperparameters for index knn.index 03/09/2025, 08:56:57
2025-03-09 08:57:40,788 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 43.4469 secs
2025-03-09 08:57:40,788 [INFO]: The best hyperparameters are: efSearch=227
2025-03-09 08:57:40,788 [INFO]: 	Compute fast metrics 03/09/2025, 08:57:40
  0%|          | 0/4 [00:00<?, ?it/s] 50%|█████     | 2/4 [00:00<00:00, 18.35it/s] 75%|███████▌  | 3/4 [00:00<00:00, 19.56it/s]
2025-03-09 08:57:57,775 [INFO]: 	>>> Finished "Compute fast metrics" in 16.9866 secs
2025-03-09 08:57:58,261 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 67.1025 secs
2025-03-09 08:57:58,262 [INFO]: {
2025-03-09 08:57:58,262 [INFO]: 	index_key: HNSW15
2025-03-09 08:57:58,262 [INFO]: 	index_param: efSearch=227
2025-03-09 08:57:58,262 [INFO]: 	index_path: knn.index
2025-03-09 08:57:58,262 [INFO]: 	size in bytes: 862329070
2025-03-09 08:57:58,262 [INFO]: 	avg_search_speed_ms: 13.661734618900518
2025-03-09 08:57:58,262 [INFO]: 	99p_search_speed_ms: 29.527576058171686
2025-03-09 08:57:58,262 [INFO]: 	reconstruction error %: 0.0
2025-03-09 08:57:58,262 [INFO]: 	nb vectors: 4383
2025-03-09 08:57:58,262 [INFO]: 	vectors dimension: 49152
2025-03-09 08:57:58,262 [INFO]: 	compression ratio: 0.999308609647127
2025-03-09 08:57:58,262 [INFO]: }
2025-03-09 08:57:58,262 [INFO]: 	>>> Finished "Creating the index" in 67.1068 secs
2025-03-09 08:57:58,262 [INFO]: >>> Finished "Launching the whole pipeline" in 67.1405 secs
2025-03-09 08:58:00: [retrieval_preprocessing] calculating distances ...
2025-03-09 08:58:01: [retrieval_preprocessing] finished and saved retrieval indices for episode 36508 [episode count 7/20]
[retrieval_preprocessing] for episode 16285 [episode count 8/20], we have num_retrieval=np.int64(4321) num_query=np.int64(264)
2025-03-09 08:58:02,826 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-09 08:58:04,195 [INFO]: Launching the whole pipeline 03/09/2025, 08:58:04
2025-03-09 08:58:04,196 [INFO]: Reading total number of vectors and dimension 03/09/2025, 08:58:04
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1031.81it/s]
2025-03-09 08:58:04,224 [INFO]: There are 4321 embeddings of dim 49152
2025-03-09 08:58:04,225 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0290 secs
2025-03-09 08:58:04,225 [INFO]: 	Compute estimated construction time of the index 03/09/2025, 08:58:04
2025-03-09 08:58:04,225 [INFO]: 		-> Train: 16.7 minutes
2025-03-09 08:58:04,225 [INFO]: 		-> Add: 2.4 seconds
2025-03-09 08:58:04,225 [INFO]: 		Total: 16.7 minutes
2025-03-09 08:58:04,225 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0001 secs
2025-03-09 08:58:04,225 [INFO]: 	Checking that your have enough memory available to create the index 03/09/2025, 08:58:04
2025-03-09 08:58:04,225 [INFO]: 891.8MB of memory will be needed to build the index (more might be used if you have more)
2025-03-09 08:58:04,225 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0002 secs
2025-03-09 08:58:04,225 [INFO]: 	Selecting most promising index types given data characteristics 03/09/2025, 08:58:04
2025-03-09 08:58:04,225 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-09 08:58:04,225 [INFO]: 	Creating the index 03/09/2025, 08:58:04
2025-03-09 08:58:04,225 [INFO]: 		-> Instanciate the index HNSW15 03/09/2025, 08:58:04
2025-03-09 08:58:04,226 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0010 secs
2025-03-09 08:58:04,226 [INFO]: 		-> Adding the vectors to the index 03/09/2025, 08:58:04
2025-03-09 08:58:04,226 [INFO]: The memory available for adding the vectors is 49.2GB(total available - used by the index)
2025-03-09 08:58:04,226 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/18 [00:00<?, ?it/s]  6%|▌         | 1/18 [00:00<00:03,  4.78it/s] 11%|█         | 2/18 [00:00<00:02,  6.31it/s] 17%|█▋        | 3/18 [00:00<00:02,  7.07it/s] 22%|██▏       | 4/18 [00:00<00:01,  7.68it/s] 28%|██▊       | 5/18 [00:00<00:01,  8.17it/s] 33%|███▎      | 6/18 [00:00<00:01,  8.39it/s] 39%|███▉      | 7/18 [00:00<00:01,  8.57it/s] 44%|████▍     | 8/18 [00:01<00:01,  8.84it/s] 50%|█████     | 9/18 [00:01<00:01,  8.90it/s] 56%|█████▌    | 10/18 [00:01<00:00,  8.97it/s] 61%|██████    | 11/18 [00:01<00:00,  9.11it/s] 67%|██████▋   | 12/18 [00:01<00:00,  9.10it/s] 72%|███████▏  | 13/18 [00:01<00:00,  9.09it/s] 78%|███████▊  | 14/18 [00:01<00:00,  9.03it/s] 83%|████████▎ | 15/18 [00:01<00:00,  9.04it/s] 89%|████████▉ | 16/18 [00:01<00:00,  9.12it/s] 94%|█████████▍| 17/18 [00:01<00:00,  9.11it/s]100%|██████████| 18/18 [00:05<00:00,  1.15s/it]100%|██████████| 18/18 [00:05<00:00,  3.24it/s]
2025-03-09 08:58:09,780 [INFO]: 	Computing best hyperparameters for index knn.index 03/09/2025, 08:58:09
2025-03-09 08:58:59,472 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 49.6918 secs
2025-03-09 08:58:59,472 [INFO]: The best hyperparameters are: efSearch=210
2025-03-09 08:58:59,472 [INFO]: 	Compute fast metrics 03/09/2025, 08:58:59
  0%|          | 0/4 [00:00<?, ?it/s] 25%|██▌       | 1/4 [00:00<00:00,  5.11it/s] 50%|█████     | 2/4 [00:00<00:00,  6.73it/s] 75%|███████▌  | 3/4 [00:00<00:00,  7.71it/s] 75%|███████▌  | 3/4 [00:00<00:00,  5.79it/s]
2025-03-09 08:59:18,707 [INFO]: 	>>> Finished "Compute fast metrics" in 19.2342 secs
2025-03-09 08:59:18,709 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 74.4829 secs
2025-03-09 08:59:18,709 [INFO]: {
2025-03-09 08:59:18,709 [INFO]: 	index_key: HNSW15
2025-03-09 08:59:18,709 [INFO]: 	index_param: efSearch=210
2025-03-09 08:59:18,709 [INFO]: 	index_path: knn.index
2025-03-09 08:59:18,709 [INFO]: 	size in bytes: 850130950
2025-03-09 08:59:18,709 [INFO]: 	avg_search_speed_ms: 9.575502574533024
2025-03-09 08:59:18,710 [INFO]: 	99p_search_speed_ms: 17.11824415018782
2025-03-09 08:59:18,710 [INFO]: 	reconstruction error %: 0.0
2025-03-09 08:59:18,710 [INFO]: 	nb vectors: 4321
2025-03-09 08:59:18,710 [INFO]: 	vectors dimension: 49152
2025-03-09 08:59:18,710 [INFO]: 	compression ratio: 0.9993085982812413
2025-03-09 08:59:18,710 [INFO]: }
2025-03-09 08:59:18,710 [INFO]: 	>>> Finished "Creating the index" in 74.4844 secs
2025-03-09 08:59:18,710 [INFO]: >>> Finished "Launching the whole pipeline" in 74.5141 secs
2025-03-09 08:59:19: [retrieval_preprocessing] calculating distances ...
2025-03-09 08:59:20: [retrieval_preprocessing] finished and saved retrieval indices for episode 16285 [episode count 8/20]
[retrieval_preprocessing] for episode 65948 [episode count 9/20], we have num_retrieval=np.int64(4378) num_query=np.int64(207)
2025-03-09 08:59:21,900 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-09 08:59:22,433 [INFO]: Launching the whole pipeline 03/09/2025, 08:59:22
2025-03-09 08:59:22,433 [INFO]: Reading total number of vectors and dimension 03/09/2025, 08:59:22
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1681.76it/s]
2025-03-09 08:59:22,459 [INFO]: There are 4378 embeddings of dim 49152
2025-03-09 08:59:22,460 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0263 secs
2025-03-09 08:59:22,460 [INFO]: 	Compute estimated construction time of the index 03/09/2025, 08:59:22
2025-03-09 08:59:22,460 [INFO]: 		-> Train: 16.7 minutes
2025-03-09 08:59:22,460 [INFO]: 		-> Add: 2.4 seconds
2025-03-09 08:59:22,460 [INFO]: 		Total: 16.7 minutes
2025-03-09 08:59:22,460 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0003 secs
2025-03-09 08:59:22,460 [INFO]: 	Checking that your have enough memory available to create the index 03/09/2025, 08:59:22
2025-03-09 08:59:22,461 [INFO]: 903.5MB of memory will be needed to build the index (more might be used if you have more)
2025-03-09 08:59:22,461 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0005 secs
2025-03-09 08:59:22,461 [INFO]: 	Selecting most promising index types given data characteristics 03/09/2025, 08:59:22
2025-03-09 08:59:22,461 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-09 08:59:22,461 [INFO]: 	Creating the index 03/09/2025, 08:59:22
2025-03-09 08:59:22,461 [INFO]: 		-> Instanciate the index HNSW15 03/09/2025, 08:59:22
2025-03-09 08:59:22,464 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0028 secs
2025-03-09 08:59:22,464 [INFO]: 		-> Adding the vectors to the index 03/09/2025, 08:59:22
2025-03-09 08:59:22,465 [INFO]: The memory available for adding the vectors is 49.2GB(total available - used by the index)
2025-03-09 08:59:22,465 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/18 [00:00<?, ?it/s]  6%|▌         | 1/18 [00:00<00:02,  6.22it/s] 17%|█▋        | 3/18 [00:00<00:01,  9.86it/s] 28%|██▊       | 5/18 [00:00<00:01, 10.59it/s] 39%|███▉      | 7/18 [00:00<00:01, 10.77it/s] 50%|█████     | 9/18 [00:00<00:00, 10.92it/s] 61%|██████    | 11/18 [00:01<00:00, 11.02it/s] 72%|███████▏  | 13/18 [00:01<00:00, 10.98it/s] 83%|████████▎ | 15/18 [00:01<00:00, 11.11it/s] 94%|█████████▍| 17/18 [00:01<00:00, 11.38it/s]100%|██████████| 18/18 [00:04<00:00,  4.13it/s]
2025-03-09 08:59:26,832 [INFO]: 	Computing best hyperparameters for index knn.index 03/09/2025, 08:59:26
2025-03-09 09:00:14,474 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 47.6412 secs
2025-03-09 09:00:14,474 [INFO]: The best hyperparameters are: efSearch=235
2025-03-09 09:00:14,474 [INFO]: 	Compute fast metrics 03/09/2025, 09:00:14
  0%|          | 0/4 [00:00<?, ?it/s] 25%|██▌       | 1/4 [00:00<00:00,  6.04it/s] 75%|███████▌  | 3/4 [00:00<00:00,  9.72it/s] 75%|███████▌  | 3/4 [00:00<00:00,  7.42it/s]
2025-03-09 09:00:31,011 [INFO]: 	>>> Finished "Compute fast metrics" in 16.5370 secs
2025-03-09 09:00:31,014 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 68.5499 secs
2025-03-09 09:00:31,015 [INFO]: {
2025-03-09 09:00:31,015 [INFO]: 	index_key: HNSW15
2025-03-09 09:00:31,015 [INFO]: 	index_param: efSearch=235
2025-03-09 09:00:31,015 [INFO]: 	index_path: knn.index
2025-03-09 09:00:31,015 [INFO]: 	size in bytes: 861345370
2025-03-09 09:00:31,015 [INFO]: 	avg_search_speed_ms: 10.918411957740572
2025-03-09 09:00:31,015 [INFO]: 	99p_search_speed_ms: 16.92672990029678
2025-03-09 09:00:31,015 [INFO]: 	reconstruction error %: 0.0
2025-03-09 09:00:31,015 [INFO]: 	nb vectors: 4378
2025-03-09 09:00:31,015 [INFO]: 	vectors dimension: 49152
2025-03-09 09:00:31,015 [INFO]: 	compression ratio: 0.9993085862875191
2025-03-09 09:00:31,015 [INFO]: }
2025-03-09 09:00:31,015 [INFO]: 	>>> Finished "Creating the index" in 68.5535 secs
2025-03-09 09:00:31,015 [INFO]: >>> Finished "Launching the whole pipeline" in 68.5813 secs
2025-03-09 09:00:32: [retrieval_preprocessing] calculating distances ...
2025-03-09 09:00:33: [retrieval_preprocessing] finished and saved retrieval indices for episode 65948 [episode count 9/20]
[retrieval_preprocessing] for episode 47137 [episode count 10/20], we have num_retrieval=np.int64(4385) num_query=np.int64(200)
2025-03-09 09:00:34,712 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-09 09:00:35,317 [INFO]: Launching the whole pipeline 03/09/2025, 09:00:35
2025-03-09 09:00:35,317 [INFO]: Reading total number of vectors and dimension 03/09/2025, 09:00:35
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 920.81it/s]
2025-03-09 09:00:35,355 [INFO]: There are 4385 embeddings of dim 49152
2025-03-09 09:00:35,355 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0382 secs
2025-03-09 09:00:35,355 [INFO]: 	Compute estimated construction time of the index 03/09/2025, 09:00:35
2025-03-09 09:00:35,355 [INFO]: 		-> Train: 16.7 minutes
2025-03-09 09:00:35,356 [INFO]: 		-> Add: 2.4 seconds
2025-03-09 09:00:35,356 [INFO]: 		Total: 16.7 minutes
2025-03-09 09:00:35,356 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0002 secs
2025-03-09 09:00:35,356 [INFO]: 	Checking that your have enough memory available to create the index 03/09/2025, 09:00:35
2025-03-09 09:00:35,356 [INFO]: 905.0MB of memory will be needed to build the index (more might be used if you have more)
2025-03-09 09:00:35,356 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0003 secs
2025-03-09 09:00:35,356 [INFO]: 	Selecting most promising index types given data characteristics 03/09/2025, 09:00:35
2025-03-09 09:00:35,356 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-09 09:00:35,356 [INFO]: 	Creating the index 03/09/2025, 09:00:35
2025-03-09 09:00:35,356 [INFO]: 		-> Instanciate the index HNSW15 03/09/2025, 09:00:35
2025-03-09 09:00:35,359 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0023 secs
2025-03-09 09:00:35,359 [INFO]: 		-> Adding the vectors to the index 03/09/2025, 09:00:35
2025-03-09 09:00:35,359 [INFO]: The memory available for adding the vectors is 49.2GB(total available - used by the index)
2025-03-09 09:00:35,359 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/18 [00:00<?, ?it/s]  6%|▌         | 1/18 [00:00<00:02,  5.69it/s] 11%|█         | 2/18 [00:00<00:02,  7.03it/s] 17%|█▋        | 3/18 [00:00<00:01,  7.57it/s] 28%|██▊       | 5/18 [00:00<00:01, 10.06it/s] 39%|███▉      | 7/18 [00:00<00:01,  9.58it/s] 44%|████▍     | 8/18 [00:00<00:01,  9.46it/s] 50%|█████     | 9/18 [00:01<00:00,  9.33it/s] 56%|█████▌    | 10/18 [00:01<00:00,  9.17it/s] 61%|██████    | 11/18 [00:01<00:00,  9.13it/s] 67%|██████▋   | 12/18 [00:01<00:00,  9.00it/s] 72%|███████▏  | 13/18 [00:01<00:00,  8.89it/s] 78%|███████▊  | 14/18 [00:01<00:00,  8.72it/s] 83%|████████▎ | 15/18 [00:01<00:00,  8.55it/s] 89%|████████▉ | 16/18 [00:01<00:00,  8.44it/s] 94%|█████████▍| 17/18 [00:01<00:00,  8.28it/s]100%|██████████| 18/18 [00:05<00:00,  1.10s/it]100%|██████████| 18/18 [00:05<00:00,  3.36it/s]
2025-03-09 09:00:40,714 [INFO]: 	Computing best hyperparameters for index knn.index 03/09/2025, 09:00:40
2025-03-09 09:01:33,950 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 53.2356 secs
2025-03-09 09:01:33,950 [INFO]: The best hyperparameters are: efSearch=203
2025-03-09 09:01:33,950 [INFO]: 	Compute fast metrics 03/09/2025, 09:01:33
  0%|          | 0/4 [00:00<?, ?it/s] 25%|██▌       | 1/4 [00:00<00:00,  5.28it/s] 50%|█████     | 2/4 [00:00<00:00,  6.99it/s] 75%|███████▌  | 3/4 [00:00<00:00,  7.63it/s] 75%|███████▌  | 3/4 [00:00<00:00,  5.72it/s]
2025-03-09 09:01:51,600 [INFO]: 	>>> Finished "Compute fast metrics" in 17.6497 secs
2025-03-09 09:01:51,603 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 76.2440 secs
2025-03-09 09:01:51,603 [INFO]: {
2025-03-09 09:01:51,603 [INFO]: 	index_key: HNSW15
2025-03-09 09:01:51,603 [INFO]: 	index_param: efSearch=203
2025-03-09 09:01:51,603 [INFO]: 	index_path: knn.index
2025-03-09 09:01:51,603 [INFO]: 	size in bytes: 862722550
2025-03-09 09:01:51,603 [INFO]: 	avg_search_speed_ms: 9.259633778991109
2025-03-09 09:01:51,603 [INFO]: 	99p_search_speed_ms: 16.115472505334775
2025-03-09 09:01:51,603 [INFO]: 	reconstruction error %: 0.0
2025-03-09 09:01:51,603 [INFO]: 	nb vectors: 4385
2025-03-09 09:01:51,603 [INFO]: 	vectors dimension: 49152
2025-03-09 09:01:51,603 [INFO]: 	compression ratio: 0.9993086189760544
2025-03-09 09:01:51,603 [INFO]: }
2025-03-09 09:01:51,603 [INFO]: 	>>> Finished "Creating the index" in 76.2471 secs
2025-03-09 09:01:51,603 [INFO]: >>> Finished "Launching the whole pipeline" in 76.2866 secs
2025-03-09 09:01:53: [retrieval_preprocessing] calculating distances ...
2025-03-09 09:01:53: [retrieval_preprocessing] finished and saved retrieval indices for episode 47137 [episode count 10/20]
[retrieval_preprocessing] for episode 12579 [episode count 11/20], we have num_retrieval=np.int64(4349) num_query=np.int64(236)
2025-03-09 09:01:55,673 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-09 09:01:56,526 [INFO]: Launching the whole pipeline 03/09/2025, 09:01:56
2025-03-09 09:01:56,526 [INFO]: Reading total number of vectors and dimension 03/09/2025, 09:01:56
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1317.31it/s]
2025-03-09 09:01:56,556 [INFO]: There are 4349 embeddings of dim 49152
2025-03-09 09:01:56,556 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0303 secs
2025-03-09 09:01:56,556 [INFO]: 	Compute estimated construction time of the index 03/09/2025, 09:01:56
2025-03-09 09:01:56,556 [INFO]: 		-> Train: 16.7 minutes
2025-03-09 09:01:56,556 [INFO]: 		-> Add: 2.4 seconds
2025-03-09 09:01:56,556 [INFO]: 		Total: 16.7 minutes
2025-03-09 09:01:56,556 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0001 secs
2025-03-09 09:01:56,556 [INFO]: 	Checking that your have enough memory available to create the index 03/09/2025, 09:01:56
2025-03-09 09:01:56,557 [INFO]: 897.5MB of memory will be needed to build the index (more might be used if you have more)
2025-03-09 09:01:56,557 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0002 secs
2025-03-09 09:01:56,557 [INFO]: 	Selecting most promising index types given data characteristics 03/09/2025, 09:01:56
2025-03-09 09:01:56,557 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-09 09:01:56,557 [INFO]: 	Creating the index 03/09/2025, 09:01:56
2025-03-09 09:01:56,557 [INFO]: 		-> Instanciate the index HNSW15 03/09/2025, 09:01:56
2025-03-09 09:01:56,558 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0011 secs
2025-03-09 09:01:56,558 [INFO]: 		-> Adding the vectors to the index 03/09/2025, 09:01:56
2025-03-09 09:01:56,558 [INFO]: The memory available for adding the vectors is 49.2GB(total available - used by the index)
2025-03-09 09:01:56,558 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/18 [00:00<?, ?it/s]  6%|▌         | 1/18 [00:00<00:03,  4.97it/s] 11%|█         | 2/18 [00:00<00:02,  6.93it/s] 17%|█▋        | 3/18 [00:00<00:01,  7.96it/s] 22%|██▏       | 4/18 [00:00<00:01,  8.46it/s] 28%|██▊       | 5/18 [00:00<00:01,  8.80it/s] 33%|███▎      | 6/18 [00:00<00:01,  9.03it/s] 39%|███▉      | 7/18 [00:00<00:01,  9.25it/s] 44%|████▍     | 8/18 [00:00<00:01,  9.43it/s] 50%|█████     | 9/18 [00:01<00:00,  9.49it/s] 56%|█████▌    | 10/18 [00:01<00:00,  9.49it/s] 61%|██████    | 11/18 [00:01<00:00,  9.47it/s] 67%|██████▋   | 12/18 [00:01<00:00,  9.56it/s] 72%|███████▏  | 13/18 [00:01<00:00,  9.62it/s] 78%|███████▊  | 14/18 [00:01<00:00,  9.58it/s] 83%|████████▎ | 15/18 [00:01<00:00,  9.31it/s] 94%|█████████▍| 17/18 [00:01<00:00,  9.94it/s]100%|██████████| 18/18 [00:05<00:00,  1.15it/s]100%|██████████| 18/18 [00:05<00:00,  3.56it/s]
2025-03-09 09:02:01,613 [INFO]: 	Computing best hyperparameters for index knn.index 03/09/2025, 09:02:01
2025-03-09 09:02:55,968 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 54.3543 secs
2025-03-09 09:02:55,968 [INFO]: The best hyperparameters are: efSearch=217
2025-03-09 09:02:55,969 [INFO]: 	Compute fast metrics 03/09/2025, 09:02:55
  0%|          | 0/4 [00:00<?, ?it/s] 25%|██▌       | 1/4 [00:00<00:00,  5.39it/s] 50%|█████     | 2/4 [00:00<00:00,  7.06it/s] 75%|███████▌  | 3/4 [00:00<00:00,  7.77it/s] 75%|███████▌  | 3/4 [00:00<00:00,  5.82it/s]
2025-03-09 09:03:15,333 [INFO]: 	>>> Finished "Compute fast metrics" in 19.3643 secs
2025-03-09 09:03:15,336 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 78.7777 secs
2025-03-09 09:03:15,336 [INFO]: {
2025-03-09 09:03:15,336 [INFO]: 	index_key: HNSW15
2025-03-09 09:03:15,336 [INFO]: 	index_param: efSearch=217
2025-03-09 09:03:15,336 [INFO]: 	index_path: knn.index
2025-03-09 09:03:15,336 [INFO]: 	size in bytes: 855639850
2025-03-09 09:03:15,336 [INFO]: 	avg_search_speed_ms: 9.539922086958791
2025-03-09 09:03:15,336 [INFO]: 	99p_search_speed_ms: 17.16903167776763
2025-03-09 09:03:15,336 [INFO]: 	reconstruction error %: 0.0
2025-03-09 09:03:15,336 [INFO]: 	nb vectors: 4349
2025-03-09 09:03:15,336 [INFO]: 	vectors dimension: 49152
2025-03-09 09:03:15,336 [INFO]: 	compression ratio: 0.9993085198170703
2025-03-09 09:03:15,336 [INFO]: }
2025-03-09 09:03:15,336 [INFO]: 	>>> Finished "Creating the index" in 78.7793 secs
2025-03-09 09:03:15,336 [INFO]: >>> Finished "Launching the whole pipeline" in 78.8104 secs
2025-03-09 09:03:16: [retrieval_preprocessing] calculating distances ...
2025-03-09 09:03:17: [retrieval_preprocessing] finished and saved retrieval indices for episode 12579 [episode count 11/20]
[retrieval_preprocessing] for episode 26020 [episode count 12/20], we have num_retrieval=np.int64(4340) num_query=np.int64(245)
2025-03-09 09:03:18,543 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-09 09:03:19,197 [INFO]: Launching the whole pipeline 03/09/2025, 09:03:19
2025-03-09 09:03:19,198 [INFO]: Reading total number of vectors and dimension 03/09/2025, 09:03:19
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1632.02it/s]
2025-03-09 09:03:19,222 [INFO]: There are 4340 embeddings of dim 49152
2025-03-09 09:03:19,223 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0250 secs
2025-03-09 09:03:19,223 [INFO]: 	Compute estimated construction time of the index 03/09/2025, 09:03:19
2025-03-09 09:03:19,223 [INFO]: 		-> Train: 16.7 minutes
2025-03-09 09:03:19,223 [INFO]: 		-> Add: 2.4 seconds
2025-03-09 09:03:19,223 [INFO]: 		Total: 16.7 minutes
2025-03-09 09:03:19,223 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0002 secs
2025-03-09 09:03:19,223 [INFO]: 	Checking that your have enough memory available to create the index 03/09/2025, 09:03:19
2025-03-09 09:03:19,223 [INFO]: 895.7MB of memory will be needed to build the index (more might be used if you have more)
2025-03-09 09:03:19,223 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0001 secs
2025-03-09 09:03:19,223 [INFO]: 	Selecting most promising index types given data characteristics 03/09/2025, 09:03:19
2025-03-09 09:03:19,223 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-09 09:03:19,223 [INFO]: 	Creating the index 03/09/2025, 09:03:19
2025-03-09 09:03:19,223 [INFO]: 		-> Instanciate the index HNSW15 03/09/2025, 09:03:19
2025-03-09 09:03:19,224 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0009 secs
2025-03-09 09:03:19,224 [INFO]: 		-> Adding the vectors to the index 03/09/2025, 09:03:19
2025-03-09 09:03:19,224 [INFO]: The memory available for adding the vectors is 49.2GB(total available - used by the index)
2025-03-09 09:03:19,224 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/18 [00:00<?, ?it/s]  6%|▌         | 1/18 [00:00<00:03,  4.90it/s] 11%|█         | 2/18 [00:00<00:02,  6.44it/s] 17%|█▋        | 3/18 [00:00<00:02,  7.20it/s] 22%|██▏       | 4/18 [00:00<00:01,  7.66it/s] 28%|██▊       | 5/18 [00:00<00:01,  7.92it/s] 33%|███▎      | 6/18 [00:00<00:01,  8.15it/s] 39%|███▉      | 7/18 [00:00<00:01,  8.16it/s] 44%|████▍     | 8/18 [00:01<00:01,  8.24it/s] 50%|█████     | 9/18 [00:01<00:01,  8.21it/s] 56%|█████▌    | 10/18 [00:01<00:00,  8.16it/s] 61%|██████    | 11/18 [00:01<00:00,  8.25it/s] 67%|██████▋   | 12/18 [00:01<00:00,  8.50it/s] 72%|███████▏  | 13/18 [00:01<00:00,  8.77it/s] 78%|███████▊  | 14/18 [00:01<00:00,  8.80it/s] 83%|████████▎ | 15/18 [00:01<00:00,  8.89it/s] 89%|████████▉ | 16/18 [00:01<00:00,  8.95it/s] 94%|█████████▍| 17/18 [00:02<00:00,  9.12it/s]100%|██████████| 18/18 [00:04<00:00,  1.10it/s]100%|██████████| 18/18 [00:04<00:00,  3.72it/s]
2025-03-09 09:03:24,066 [INFO]: 	Computing best hyperparameters for index knn.index 03/09/2025, 09:03:24
2025-03-09 09:04:11,017 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 46.9500 secs
2025-03-09 09:04:11,017 [INFO]: The best hyperparameters are: efSearch=214
2025-03-09 09:04:11,017 [INFO]: 	Compute fast metrics 03/09/2025, 09:04:11
  0%|          | 0/4 [00:00<?, ?it/s] 25%|██▌       | 1/4 [00:00<00:00,  5.24it/s] 50%|█████     | 2/4 [00:00<00:00,  6.96it/s] 75%|███████▌  | 3/4 [00:00<00:00,  7.61it/s] 75%|███████▌  | 3/4 [00:00<00:00,  5.71it/s]
2025-03-09 09:04:27,809 [INFO]: 	>>> Finished "Compute fast metrics" in 16.7913 secs
2025-03-09 09:04:27,812 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 68.5876 secs
2025-03-09 09:04:27,812 [INFO]: {
2025-03-09 09:04:27,812 [INFO]: 	index_key: HNSW15
2025-03-09 09:04:27,812 [INFO]: 	index_param: efSearch=214
2025-03-09 09:04:27,812 [INFO]: 	index_path: knn.index
2025-03-09 09:04:27,812 [INFO]: 	size in bytes: 853869070
2025-03-09 09:04:27,812 [INFO]: 	avg_search_speed_ms: 9.341134742792804
2025-03-09 09:04:27,812 [INFO]: 	99p_search_speed_ms: 17.02328328974544
2025-03-09 09:04:27,812 [INFO]: 	reconstruction error %: 0.0
2025-03-09 09:04:27,812 [INFO]: 	nb vectors: 4340
2025-03-09 09:04:27,812 [INFO]: 	vectors dimension: 49152
2025-03-09 09:04:27,812 [INFO]: 	compression ratio: 0.9993086176549292
2025-03-09 09:04:27,812 [INFO]: }
2025-03-09 09:04:27,812 [INFO]: 	>>> Finished "Creating the index" in 68.5892 secs
2025-03-09 09:04:27,812 [INFO]: >>> Finished "Launching the whole pipeline" in 68.6149 secs
2025-03-09 09:04:28: [retrieval_preprocessing] calculating distances ...
2025-03-09 09:04:29: [retrieval_preprocessing] finished and saved retrieval indices for episode 26020 [episode count 12/20]
[retrieval_preprocessing] for episode 63396 [episode count 13/20], we have num_retrieval=np.int64(4359) num_query=np.int64(226)
2025-03-09 09:04:31,271 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-09 09:04:31,908 [INFO]: Launching the whole pipeline 03/09/2025, 09:04:31
2025-03-09 09:04:31,909 [INFO]: Reading total number of vectors and dimension 03/09/2025, 09:04:31
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1449.81it/s]
2025-03-09 09:04:31,924 [INFO]: There are 4359 embeddings of dim 49152
2025-03-09 09:04:31,924 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0158 secs
2025-03-09 09:04:31,925 [INFO]: 	Compute estimated construction time of the index 03/09/2025, 09:04:31
2025-03-09 09:04:31,925 [INFO]: 		-> Train: 16.7 minutes
2025-03-09 09:04:31,925 [INFO]: 		-> Add: 2.4 seconds
2025-03-09 09:04:31,925 [INFO]: 		Total: 16.7 minutes
2025-03-09 09:04:31,925 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0002 secs
2025-03-09 09:04:31,925 [INFO]: 	Checking that your have enough memory available to create the index 03/09/2025, 09:04:31
2025-03-09 09:04:31,925 [INFO]: 899.6MB of memory will be needed to build the index (more might be used if you have more)
2025-03-09 09:04:31,925 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0003 secs
2025-03-09 09:04:31,925 [INFO]: 	Selecting most promising index types given data characteristics 03/09/2025, 09:04:31
2025-03-09 09:04:31,925 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-09 09:04:31,926 [INFO]: 	Creating the index 03/09/2025, 09:04:31
2025-03-09 09:04:31,926 [INFO]: 		-> Instanciate the index HNSW15 03/09/2025, 09:04:31
2025-03-09 09:04:31,927 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0017 secs
2025-03-09 09:04:31,928 [INFO]: 		-> Adding the vectors to the index 03/09/2025, 09:04:31
2025-03-09 09:04:31,928 [INFO]: The memory available for adding the vectors is 49.2GB(total available - used by the index)
2025-03-09 09:04:31,928 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/18 [00:00<?, ?it/s]  6%|▌         | 1/18 [00:00<00:02,  6.14it/s] 11%|█         | 2/18 [00:00<00:02,  7.80it/s] 17%|█▋        | 3/18 [00:00<00:01,  8.56it/s] 22%|██▏       | 4/18 [00:00<00:01,  9.05it/s] 33%|███▎      | 6/18 [00:00<00:01,  9.56it/s] 39%|███▉      | 7/18 [00:00<00:01,  9.59it/s] 44%|████▍     | 8/18 [00:00<00:01,  9.56it/s] 50%|█████     | 9/18 [00:00<00:00,  9.58it/s] 56%|█████▌    | 10/18 [00:01<00:00,  9.67it/s] 61%|██████    | 11/18 [00:01<00:00,  9.50it/s] 67%|██████▋   | 12/18 [00:01<00:00,  9.37it/s] 72%|███████▏  | 13/18 [00:01<00:00,  9.20it/s] 78%|███████▊  | 14/18 [00:01<00:00,  9.18it/s] 83%|████████▎ | 15/18 [00:01<00:00,  9.22it/s] 89%|████████▉ | 16/18 [00:01<00:00,  9.17it/s]100%|██████████| 18/18 [00:05<00:00,  1.04it/s]100%|██████████| 18/18 [00:05<00:00,  3.19it/s]
2025-03-09 09:04:37,581 [INFO]: 	Computing best hyperparameters for index knn.index 03/09/2025, 09:04:37
2025-03-09 09:05:29,162 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 51.5807 secs
2025-03-09 09:05:29,163 [INFO]: The best hyperparameters are: efSearch=229
2025-03-09 09:05:29,163 [INFO]: 	Compute fast metrics 03/09/2025, 09:05:29
  0%|          | 0/4 [00:00<?, ?it/s] 25%|██▌       | 1/4 [00:00<00:00,  5.43it/s] 50%|█████     | 2/4 [00:00<00:00,  7.18it/s] 75%|███████▌  | 3/4 [00:00<00:00,  7.81it/s] 75%|███████▌  | 3/4 [00:00<00:00,  5.86it/s]
2025-03-09 09:05:50,359 [INFO]: 	>>> Finished "Compute fast metrics" in 21.1960 secs
2025-03-09 09:05:50,362 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 78.4340 secs
2025-03-09 09:05:50,362 [INFO]: {
2025-03-09 09:05:50,362 [INFO]: 	index_key: HNSW15
2025-03-09 09:05:50,362 [INFO]: 	index_param: efSearch=229
2025-03-09 09:05:50,362 [INFO]: 	index_path: knn.index
2025-03-09 09:05:50,362 [INFO]: 	size in bytes: 857607250
2025-03-09 09:05:50,362 [INFO]: 	avg_search_speed_ms: 11.349846277265438
2025-03-09 09:05:50,362 [INFO]: 	99p_search_speed_ms: 22.476092353463184
2025-03-09 09:05:50,362 [INFO]: 	reconstruction error %: 0.0
2025-03-09 09:05:50,362 [INFO]: 	nb vectors: 4359
2025-03-09 09:05:50,362 [INFO]: 	vectors dimension: 49152
2025-03-09 09:05:50,362 [INFO]: 	compression ratio: 0.999308566946
2025-03-09 09:05:50,362 [INFO]: }
2025-03-09 09:05:50,362 [INFO]: 	>>> Finished "Creating the index" in 78.4367 secs
2025-03-09 09:05:50,362 [INFO]: >>> Finished "Launching the whole pipeline" in 78.4537 secs
2025-03-09 09:05:51: [retrieval_preprocessing] calculating distances ...
2025-03-09 09:05:52: [retrieval_preprocessing] finished and saved retrieval indices for episode 63396 [episode count 13/20]
[retrieval_preprocessing] for episode 34086 [episode count 14/20], we have num_retrieval=np.int64(4394) num_query=np.int64(191)
2025-03-09 09:05:53,845 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-09 09:05:54,477 [INFO]: Launching the whole pipeline 03/09/2025, 09:05:54
2025-03-09 09:05:54,477 [INFO]: Reading total number of vectors and dimension 03/09/2025, 09:05:54
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1940.91it/s]
2025-03-09 09:05:54,503 [INFO]: There are 4394 embeddings of dim 49152
2025-03-09 09:05:54,504 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0270 secs
2025-03-09 09:05:54,504 [INFO]: 	Compute estimated construction time of the index 03/09/2025, 09:05:54
2025-03-09 09:05:54,504 [INFO]: 		-> Train: 16.7 minutes
2025-03-09 09:05:54,504 [INFO]: 		-> Add: 2.4 seconds
2025-03-09 09:05:54,504 [INFO]: 		Total: 16.7 minutes
2025-03-09 09:05:54,504 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0001 secs
2025-03-09 09:05:54,504 [INFO]: 	Checking that your have enough memory available to create the index 03/09/2025, 09:05:54
2025-03-09 09:05:54,504 [INFO]: 906.8MB of memory will be needed to build the index (more might be used if you have more)
2025-03-09 09:05:54,504 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0001 secs
2025-03-09 09:05:54,504 [INFO]: 	Selecting most promising index types given data characteristics 03/09/2025, 09:05:54
2025-03-09 09:05:54,504 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-09 09:05:54,504 [INFO]: 	Creating the index 03/09/2025, 09:05:54
2025-03-09 09:05:54,504 [INFO]: 		-> Instanciate the index HNSW15 03/09/2025, 09:05:54
2025-03-09 09:05:54,505 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0011 secs
2025-03-09 09:05:54,505 [INFO]: 		-> Adding the vectors to the index 03/09/2025, 09:05:54
2025-03-09 09:05:54,505 [INFO]: The memory available for adding the vectors is 49.2GB(total available - used by the index)
2025-03-09 09:05:54,506 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/18 [00:00<?, ?it/s]  6%|▌         | 1/18 [00:00<00:02,  5.97it/s] 17%|█▋        | 3/18 [00:00<00:01,  9.22it/s] 28%|██▊       | 5/18 [00:00<00:01, 10.11it/s] 39%|███▉      | 7/18 [00:00<00:01, 10.73it/s] 50%|█████     | 9/18 [00:00<00:00, 11.02it/s] 61%|██████    | 11/18 [00:01<00:00, 11.32it/s] 72%|███████▏  | 13/18 [00:01<00:00, 11.49it/s] 83%|████████▎ | 15/18 [00:01<00:00, 11.56it/s] 94%|█████████▍| 17/18 [00:01<00:00, 11.59it/s]100%|██████████| 18/18 [00:04<00:00,  3.71it/s]
2025-03-09 09:05:59,365 [INFO]: 	Computing best hyperparameters for index knn.index 03/09/2025, 09:05:59
2025-03-09 09:06:50,151 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 50.7856 secs
2025-03-09 09:06:50,151 [INFO]: The best hyperparameters are: efSearch=190
2025-03-09 09:06:50,151 [INFO]: 	Compute fast metrics 03/09/2025, 09:06:50
  0%|          | 0/4 [00:00<?, ?it/s] 25%|██▌       | 1/4 [00:00<00:00,  5.03it/s] 50%|█████     | 2/4 [00:00<00:00,  6.70it/s] 75%|███████▌  | 3/4 [00:00<00:00,  7.64it/s] 75%|███████▌  | 3/4 [00:00<00:00,  5.72it/s]
2025-03-09 09:07:08,932 [INFO]: 	>>> Finished "Compute fast metrics" in 18.7811 secs
2025-03-09 09:07:08,935 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 74.4296 secs
2025-03-09 09:07:08,935 [INFO]: {
2025-03-09 09:07:08,935 [INFO]: 	index_key: HNSW15
2025-03-09 09:07:08,935 [INFO]: 	index_param: efSearch=190
2025-03-09 09:07:08,935 [INFO]: 	index_path: knn.index
2025-03-09 09:07:08,935 [INFO]: 	size in bytes: 864493210
2025-03-09 09:07:08,935 [INFO]: 	avg_search_speed_ms: 8.547188926679201
2025-03-09 09:07:08,935 [INFO]: 	99p_search_speed_ms: 15.140420193783921
2025-03-09 09:07:08,935 [INFO]: 	reconstruction error %: 0.0
2025-03-09 09:07:08,935 [INFO]: 	nb vectors: 4394
2025-03-09 09:07:08,935 [INFO]: 	vectors dimension: 49152
2025-03-09 09:07:08,935 [INFO]: 	compression ratio: 0.9993086608511361
2025-03-09 09:07:08,935 [INFO]: }
2025-03-09 09:07:08,935 [INFO]: 	>>> Finished "Creating the index" in 74.4312 secs
2025-03-09 09:07:08,935 [INFO]: >>> Finished "Launching the whole pipeline" in 74.4587 secs
2025-03-09 09:07:09: [retrieval_preprocessing] calculating distances ...
2025-03-09 09:07:10: [retrieval_preprocessing] finished and saved retrieval indices for episode 34086 [episode count 14/20]
[retrieval_preprocessing] for episode 43686 [episode count 15/20], we have num_retrieval=np.int64(4342) num_query=np.int64(243)
2025-03-09 09:07:11,632 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-09 09:07:12,209 [INFO]: Launching the whole pipeline 03/09/2025, 09:07:12
2025-03-09 09:07:12,209 [INFO]: Reading total number of vectors and dimension 03/09/2025, 09:07:12
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1749.08it/s]
2025-03-09 09:07:12,236 [INFO]: There are 4342 embeddings of dim 49152
2025-03-09 09:07:12,236 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0265 secs
2025-03-09 09:07:12,236 [INFO]: 	Compute estimated construction time of the index 03/09/2025, 09:07:12
2025-03-09 09:07:12,236 [INFO]: 		-> Train: 16.7 minutes
2025-03-09 09:07:12,236 [INFO]: 		-> Add: 2.4 seconds
2025-03-09 09:07:12,236 [INFO]: 		Total: 16.7 minutes
2025-03-09 09:07:12,237 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0004 secs
2025-03-09 09:07:12,237 [INFO]: 	Checking that your have enough memory available to create the index 03/09/2025, 09:07:12
2025-03-09 09:07:12,237 [INFO]: 896.1MB of memory will be needed to build the index (more might be used if you have more)
2025-03-09 09:07:12,237 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0004 secs
2025-03-09 09:07:12,237 [INFO]: 	Selecting most promising index types given data characteristics 03/09/2025, 09:07:12
2025-03-09 09:07:12,237 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-09 09:07:12,237 [INFO]: 	Creating the index 03/09/2025, 09:07:12
2025-03-09 09:07:12,238 [INFO]: 		-> Instanciate the index HNSW15 03/09/2025, 09:07:12
2025-03-09 09:07:12,240 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0028 secs
2025-03-09 09:07:12,241 [INFO]: 		-> Adding the vectors to the index 03/09/2025, 09:07:12
2025-03-09 09:07:12,241 [INFO]: The memory available for adding the vectors is 49.2GB(total available - used by the index)
2025-03-09 09:07:12,241 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/18 [00:00<?, ?it/s]  6%|▌         | 1/18 [00:00<00:02,  6.43it/s] 17%|█▋        | 3/18 [00:00<00:01, 10.09it/s] 28%|██▊       | 5/18 [00:00<00:01, 11.40it/s] 39%|███▉      | 7/18 [00:00<00:00, 12.15it/s] 50%|█████     | 9/18 [00:00<00:00, 12.46it/s] 61%|██████    | 11/18 [00:00<00:00, 12.76it/s] 72%|███████▏  | 13/18 [00:01<00:00, 13.04it/s] 83%|████████▎ | 15/18 [00:01<00:00, 13.18it/s] 94%|█████████▍| 17/18 [00:01<00:00, 13.14it/s]100%|██████████| 18/18 [00:04<00:00,  3.91it/s]
2025-03-09 09:07:16,844 [INFO]: 	Computing best hyperparameters for index knn.index 03/09/2025, 09:07:16
2025-03-09 09:08:01,034 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 44.1898 secs
2025-03-09 09:08:01,034 [INFO]: The best hyperparameters are: efSearch=226
2025-03-09 09:08:01,035 [INFO]: 	Compute fast metrics 03/09/2025, 09:08:01
  0%|          | 0/4 [00:00<?, ?it/s] 25%|██▌       | 1/4 [00:00<00:00,  5.35it/s] 50%|█████     | 2/4 [00:00<00:00,  7.16it/s] 75%|███████▌  | 3/4 [00:00<00:00,  8.00it/s] 75%|███████▌  | 3/4 [00:00<00:00,  5.89it/s]
2025-03-09 09:08:18,446 [INFO]: 	>>> Finished "Compute fast metrics" in 17.4113 secs
2025-03-09 09:08:19,183 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 66.9424 secs
2025-03-09 09:08:19,184 [INFO]: {
2025-03-09 09:08:19,184 [INFO]: 	index_key: HNSW15
2025-03-09 09:08:19,184 [INFO]: 	index_param: efSearch=226
2025-03-09 09:08:19,184 [INFO]: 	index_path: knn.index
2025-03-09 09:08:19,184 [INFO]: 	size in bytes: 854262550
2025-03-09 09:08:19,184 [INFO]: 	avg_search_speed_ms: 9.263348352181277
2025-03-09 09:08:19,184 [INFO]: 	99p_search_speed_ms: 15.400253233965502
2025-03-09 09:08:19,184 [INFO]: 	reconstruction error %: 0.0
2025-03-09 09:08:19,184 [INFO]: 	nb vectors: 4342
2025-03-09 09:08:19,184 [INFO]: 	vectors dimension: 49152
2025-03-09 09:08:19,184 [INFO]: 	compression ratio: 0.9993086270725552
2025-03-09 09:08:19,184 [INFO]: }
2025-03-09 09:08:19,184 [INFO]: 	>>> Finished "Creating the index" in 66.9468 secs
2025-03-09 09:08:19,184 [INFO]: >>> Finished "Launching the whole pipeline" in 66.9750 secs
2025-03-09 09:08:20: [retrieval_preprocessing] calculating distances ...
2025-03-09 09:08:21: [retrieval_preprocessing] finished and saved retrieval indices for episode 43686 [episode count 15/20]
[retrieval_preprocessing] for episode 16936 [episode count 16/20], we have num_retrieval=np.int64(4303) num_query=np.int64(282)
2025-03-09 09:08:22,531 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-09 09:08:23,078 [INFO]: Launching the whole pipeline 03/09/2025, 09:08:23
2025-03-09 09:08:23,078 [INFO]: Reading total number of vectors and dimension 03/09/2025, 09:08:23
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1443.82it/s]
2025-03-09 09:08:23,103 [INFO]: There are 4303 embeddings of dim 49152
2025-03-09 09:08:23,103 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0248 secs
2025-03-09 09:08:23,103 [INFO]: 	Compute estimated construction time of the index 03/09/2025, 09:08:23
2025-03-09 09:08:23,103 [INFO]: 		-> Train: 16.7 minutes
2025-03-09 09:08:23,103 [INFO]: 		-> Add: 2.4 seconds
2025-03-09 09:08:23,103 [INFO]: 		Total: 16.7 minutes
2025-03-09 09:08:23,103 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0001 secs
2025-03-09 09:08:23,104 [INFO]: 	Checking that your have enough memory available to create the index 03/09/2025, 09:08:23
2025-03-09 09:08:23,104 [INFO]: 888.0MB of memory will be needed to build the index (more might be used if you have more)
2025-03-09 09:08:23,104 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0002 secs
2025-03-09 09:08:23,104 [INFO]: 	Selecting most promising index types given data characteristics 03/09/2025, 09:08:23
2025-03-09 09:08:23,104 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-09 09:08:23,104 [INFO]: 	Creating the index 03/09/2025, 09:08:23
2025-03-09 09:08:23,104 [INFO]: 		-> Instanciate the index HNSW15 03/09/2025, 09:08:23
2025-03-09 09:08:23,105 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0011 secs
2025-03-09 09:08:23,105 [INFO]: 		-> Adding the vectors to the index 03/09/2025, 09:08:23
2025-03-09 09:08:23,105 [INFO]: The memory available for adding the vectors is 49.2GB(total available - used by the index)
2025-03-09 09:08:23,105 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/17 [00:00<?, ?it/s]  6%|▌         | 1/17 [00:00<00:03,  5.33it/s] 18%|█▊        | 3/17 [00:00<00:01,  9.45it/s] 29%|██▉       | 5/17 [00:00<00:01, 11.05it/s] 41%|████      | 7/17 [00:00<00:00, 11.68it/s] 53%|█████▎    | 9/17 [00:00<00:00, 12.20it/s] 65%|██████▍   | 11/17 [00:00<00:00, 13.25it/s] 76%|███████▋  | 13/17 [00:01<00:00, 14.22it/s] 88%|████████▊ | 15/17 [00:01<00:00, 13.93it/s]100%|██████████| 17/17 [00:04<00:00,  1.99it/s]100%|██████████| 17/17 [00:04<00:00,  4.18it/s]
2025-03-09 09:08:27,186 [INFO]: 	Computing best hyperparameters for index knn.index 03/09/2025, 09:08:27
2025-03-09 09:09:17,402 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 50.2151 secs
2025-03-09 09:09:17,402 [INFO]: The best hyperparameters are: efSearch=200
2025-03-09 09:09:17,402 [INFO]: 	Compute fast metrics 03/09/2025, 09:09:17
  0%|          | 0/4 [00:00<?, ?it/s] 25%|██▌       | 1/4 [00:00<00:00,  6.19it/s] 75%|███████▌  | 3/4 [00:00<00:00, 10.06it/s] 75%|███████▌  | 3/4 [00:00<00:00,  7.68it/s]
2025-03-09 09:09:33,286 [INFO]: 	>>> Finished "Compute fast metrics" in 15.8841 secs
2025-03-09 09:09:33,679 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 70.5737 secs
2025-03-09 09:09:33,679 [INFO]: {
2025-03-09 09:09:33,679 [INFO]: 	index_key: HNSW15
2025-03-09 09:09:33,679 [INFO]: 	index_param: efSearch=200
2025-03-09 09:09:33,679 [INFO]: 	index_path: knn.index
2025-03-09 09:09:33,679 [INFO]: 	size in bytes: 846589570
2025-03-09 09:09:33,679 [INFO]: 	avg_search_speed_ms: 8.754241188715707
2025-03-09 09:09:33,680 [INFO]: 	99p_search_speed_ms: 14.10700015490874
2025-03-09 09:09:33,680 [INFO]: 	reconstruction error %: 0.0
2025-03-09 09:09:33,680 [INFO]: 	nb vectors: 4303
2025-03-09 09:09:33,680 [INFO]: 	vectors dimension: 49152
2025-03-09 09:09:33,680 [INFO]: 	compression ratio: 0.9993085834969595
2025-03-09 09:09:33,680 [INFO]: }
2025-03-09 09:09:33,680 [INFO]: 	>>> Finished "Creating the index" in 70.5760 secs
2025-03-09 09:09:33,680 [INFO]: >>> Finished "Launching the whole pipeline" in 70.6014 secs
2025-03-09 09:09:34: [retrieval_preprocessing] calculating distances ...
2025-03-09 09:09:35: [retrieval_preprocessing] finished and saved retrieval indices for episode 16936 [episode count 16/20]
[retrieval_preprocessing] for episode 44969 [episode count 17/20], we have num_retrieval=np.int64(4337) num_query=np.int64(248)
2025-03-09 09:09:37,009 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-09 09:09:37,564 [INFO]: Launching the whole pipeline 03/09/2025, 09:09:37
2025-03-09 09:09:37,564 [INFO]: Reading total number of vectors and dimension 03/09/2025, 09:09:37
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1663.75it/s]
2025-03-09 09:09:37,592 [INFO]: There are 4337 embeddings of dim 49152
2025-03-09 09:09:37,592 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0280 secs
2025-03-09 09:09:37,592 [INFO]: 	Compute estimated construction time of the index 03/09/2025, 09:09:37
2025-03-09 09:09:37,592 [INFO]: 		-> Train: 16.7 minutes
2025-03-09 09:09:37,592 [INFO]: 		-> Add: 2.4 seconds
2025-03-09 09:09:37,592 [INFO]: 		Total: 16.7 minutes
2025-03-09 09:09:37,592 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0001 secs
2025-03-09 09:09:37,592 [INFO]: 	Checking that your have enough memory available to create the index 03/09/2025, 09:09:37
2025-03-09 09:09:37,592 [INFO]: 895.1MB of memory will be needed to build the index (more might be used if you have more)
2025-03-09 09:09:37,592 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0002 secs
2025-03-09 09:09:37,592 [INFO]: 	Selecting most promising index types given data characteristics 03/09/2025, 09:09:37
2025-03-09 09:09:37,592 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-09 09:09:37,592 [INFO]: 	Creating the index 03/09/2025, 09:09:37
2025-03-09 09:09:37,592 [INFO]: 		-> Instanciate the index HNSW15 03/09/2025, 09:09:37
2025-03-09 09:09:37,593 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0008 secs
2025-03-09 09:09:37,593 [INFO]: 		-> Adding the vectors to the index 03/09/2025, 09:09:37
2025-03-09 09:09:37,593 [INFO]: The memory available for adding the vectors is 49.2GB(total available - used by the index)
2025-03-09 09:09:37,593 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/18 [00:00<?, ?it/s]  6%|▌         | 1/18 [00:00<00:02,  6.35it/s] 17%|█▋        | 3/18 [00:00<00:01, 10.18it/s] 28%|██▊       | 5/18 [00:00<00:01, 11.50it/s] 39%|███▉      | 7/18 [00:00<00:00, 11.64it/s] 50%|█████     | 9/18 [00:00<00:00, 11.97it/s] 61%|██████    | 11/18 [00:00<00:00, 12.25it/s] 72%|███████▏  | 13/18 [00:01<00:00, 12.37it/s] 83%|████████▎ | 15/18 [00:01<00:00, 12.59it/s] 94%|█████████▍| 17/18 [00:01<00:00, 12.75it/s]100%|██████████| 18/18 [00:04<00:00,  3.88it/s]
2025-03-09 09:09:42,234 [INFO]: 	Computing best hyperparameters for index knn.index 03/09/2025, 09:09:42
2025-03-09 09:10:32,937 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 50.7027 secs
2025-03-09 09:10:32,938 [INFO]: The best hyperparameters are: efSearch=207
2025-03-09 09:10:32,938 [INFO]: 	Compute fast metrics 03/09/2025, 09:10:32
  0%|          | 0/4 [00:00<?, ?it/s] 25%|██▌       | 1/4 [00:00<00:00,  5.03it/s] 50%|█████     | 2/4 [00:00<00:00,  6.73it/s] 75%|███████▌  | 3/4 [00:00<00:00,  7.40it/s] 75%|███████▌  | 3/4 [00:00<00:00,  5.53it/s]
2025-03-09 09:10:50,950 [INFO]: 	>>> Finished "Compute fast metrics" in 18.0124 secs
2025-03-09 09:10:50,953 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 73.3599 secs
2025-03-09 09:10:50,953 [INFO]: {
2025-03-09 09:10:50,953 [INFO]: 	index_key: HNSW15
2025-03-09 09:10:50,953 [INFO]: 	index_param: efSearch=207
2025-03-09 09:10:50,953 [INFO]: 	index_path: knn.index
2025-03-09 09:10:50,953 [INFO]: 	size in bytes: 853278850
2025-03-09 09:10:50,953 [INFO]: 	avg_search_speed_ms: 10.172265154022499
2025-03-09 09:10:50,953 [INFO]: 	99p_search_speed_ms: 19.369835420511663
2025-03-09 09:10:50,953 [INFO]: 	reconstruction error %: 0.0
2025-03-09 09:10:50,954 [INFO]: 	nb vectors: 4337
2025-03-09 09:10:50,954 [INFO]: 	vectors dimension: 49152
2025-03-09 09:10:50,954 [INFO]: 	compression ratio: 0.9993086035122047
2025-03-09 09:10:50,954 [INFO]: }
2025-03-09 09:10:50,954 [INFO]: 	>>> Finished "Creating the index" in 73.3612 secs
2025-03-09 09:10:50,954 [INFO]: >>> Finished "Launching the whole pipeline" in 73.3897 secs
2025-03-09 09:10:52: [retrieval_preprocessing] calculating distances ...
2025-03-09 09:10:53: [retrieval_preprocessing] finished and saved retrieval indices for episode 44969 [episode count 17/20]
[retrieval_preprocessing] for episode 18348 [episode count 18/20], we have num_retrieval=np.int64(4391) num_query=np.int64(194)
2025-03-09 09:10:54,929 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-09 09:10:55,475 [INFO]: Launching the whole pipeline 03/09/2025, 09:10:55
2025-03-09 09:10:55,476 [INFO]: Reading total number of vectors and dimension 03/09/2025, 09:10:55
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 996.51it/s]
2025-03-09 09:10:55,516 [INFO]: There are 4391 embeddings of dim 49152
2025-03-09 09:10:55,517 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0410 secs
2025-03-09 09:10:55,517 [INFO]: 	Compute estimated construction time of the index 03/09/2025, 09:10:55
2025-03-09 09:10:55,517 [INFO]: 		-> Train: 16.7 minutes
2025-03-09 09:10:55,517 [INFO]: 		-> Add: 2.4 seconds
2025-03-09 09:10:55,517 [INFO]: 		Total: 16.7 minutes
2025-03-09 09:10:55,517 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0003 secs
2025-03-09 09:10:55,517 [INFO]: 	Checking that your have enough memory available to create the index 03/09/2025, 09:10:55
2025-03-09 09:10:55,517 [INFO]: 906.2MB of memory will be needed to build the index (more might be used if you have more)
2025-03-09 09:10:55,517 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0003 secs
2025-03-09 09:10:55,517 [INFO]: 	Selecting most promising index types given data characteristics 03/09/2025, 09:10:55
2025-03-09 09:10:55,518 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-09 09:10:55,518 [INFO]: 	Creating the index 03/09/2025, 09:10:55
2025-03-09 09:10:55,518 [INFO]: 		-> Instanciate the index HNSW15 03/09/2025, 09:10:55
2025-03-09 09:10:55,521 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0020 secs
2025-03-09 09:10:55,521 [INFO]: 		-> Adding the vectors to the index 03/09/2025, 09:10:55
2025-03-09 09:10:55,521 [INFO]: The memory available for adding the vectors is 49.2GB(total available - used by the index)
2025-03-09 09:10:55,521 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/18 [00:00<?, ?it/s]  6%|▌         | 1/18 [00:00<00:01,  9.21it/s] 33%|███▎      | 6/18 [00:00<00:00, 29.56it/s] 61%|██████    | 11/18 [00:00<00:00, 35.52it/s] 89%|████████▉ | 16/18 [00:00<00:00, 38.30it/s]100%|██████████| 18/18 [00:03<00:00,  5.39it/s]
2025-03-09 09:10:58,867 [INFO]: 	Computing best hyperparameters for index knn.index 03/09/2025, 09:10:58
2025-03-09 09:11:44,197 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 45.3302 secs
2025-03-09 09:11:44,198 [INFO]: The best hyperparameters are: efSearch=252
2025-03-09 09:11:44,198 [INFO]: 	Compute fast metrics 03/09/2025, 09:11:44
  0%|          | 0/4 [00:00<?, ?it/s] 25%|██▌       | 1/4 [00:00<00:00,  7.23it/s] 50%|█████     | 2/4 [00:00<00:00,  8.36it/s] 75%|███████▌  | 3/4 [00:00<00:00,  8.47it/s] 75%|███████▌  | 3/4 [00:00<00:00,  6.47it/s]
2025-03-09 09:12:06,945 [INFO]: 	>>> Finished "Compute fast metrics" in 22.7473 secs
2025-03-09 09:12:06,948 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 71.4270 secs
2025-03-09 09:12:06,948 [INFO]: {
2025-03-09 09:12:06,948 [INFO]: 	index_key: HNSW15
2025-03-09 09:12:06,948 [INFO]: 	index_param: efSearch=252
2025-03-09 09:12:06,948 [INFO]: 	index_path: knn.index
2025-03-09 09:12:06,948 [INFO]: 	size in bytes: 863902990
2025-03-09 09:12:06,948 [INFO]: 	avg_search_speed_ms: 10.283091223491441
2025-03-09 09:12:06,948 [INFO]: 	99p_search_speed_ms: 15.539961494505404
2025-03-09 09:12:06,948 [INFO]: 	reconstruction error %: 0.0
2025-03-09 09:12:06,948 [INFO]: 	nb vectors: 4391
2025-03-09 09:12:06,948 [INFO]: 	vectors dimension: 49152
2025-03-09 09:12:06,948 [INFO]: 	compression ratio: 0.9993086469118483
2025-03-09 09:12:06,948 [INFO]: }
2025-03-09 09:12:06,948 [INFO]: 	>>> Finished "Creating the index" in 71.4297 secs
2025-03-09 09:12:06,948 [INFO]: >>> Finished "Launching the whole pipeline" in 71.4725 secs
2025-03-09 09:12:07: [retrieval_preprocessing] calculating distances ...
2025-03-09 09:12:08: [retrieval_preprocessing] finished and saved retrieval indices for episode 18348 [episode count 18/20]
[retrieval_preprocessing] for episode 71215 [episode count 19/20], we have num_retrieval=np.int64(4374) num_query=np.int64(211)
2025-03-09 09:12:09,899 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-09 09:12:10,652 [INFO]: Launching the whole pipeline 03/09/2025, 09:12:10
2025-03-09 09:12:10,652 [INFO]: Reading total number of vectors and dimension 03/09/2025, 09:12:10
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1195.30it/s]
2025-03-09 09:12:10,682 [INFO]: There are 4374 embeddings of dim 49152
2025-03-09 09:12:10,683 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0309 secs
2025-03-09 09:12:10,683 [INFO]: 	Compute estimated construction time of the index 03/09/2025, 09:12:10
2025-03-09 09:12:10,683 [INFO]: 		-> Train: 16.7 minutes
2025-03-09 09:12:10,684 [INFO]: 		-> Add: 2.4 seconds
2025-03-09 09:12:10,684 [INFO]: 		Total: 16.7 minutes
2025-03-09 09:12:10,684 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0005 secs
2025-03-09 09:12:10,684 [INFO]: 	Checking that your have enough memory available to create the index 03/09/2025, 09:12:10
2025-03-09 09:12:10,684 [INFO]: 902.7MB of memory will be needed to build the index (more might be used if you have more)
2025-03-09 09:12:10,684 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0005 secs
2025-03-09 09:12:10,685 [INFO]: 	Selecting most promising index types given data characteristics 03/09/2025, 09:12:10
2025-03-09 09:12:10,685 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-09 09:12:10,685 [INFO]: 	Creating the index 03/09/2025, 09:12:10
2025-03-09 09:12:10,685 [INFO]: 		-> Instanciate the index HNSW15 03/09/2025, 09:12:10
2025-03-09 09:12:10,688 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0030 secs
2025-03-09 09:12:10,688 [INFO]: 		-> Adding the vectors to the index 03/09/2025, 09:12:10
2025-03-09 09:12:10,688 [INFO]: The memory available for adding the vectors is 49.2GB(total available - used by the index)
2025-03-09 09:12:10,689 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/18 [00:00<?, ?it/s]  6%|▌         | 1/18 [00:00<00:03,  4.88it/s] 11%|█         | 2/18 [00:00<00:02,  6.62it/s] 17%|█▋        | 3/18 [00:00<00:02,  7.48it/s] 22%|██▏       | 4/18 [00:00<00:01,  8.00it/s] 28%|██▊       | 5/18 [00:00<00:01,  8.37it/s] 33%|███▎      | 6/18 [00:00<00:01,  8.66it/s] 39%|███▉      | 7/18 [00:00<00:01,  8.70it/s] 44%|████▍     | 8/18 [00:00<00:01,  8.75it/s] 56%|█████▌    | 10/18 [00:01<00:00, 11.67it/s] 67%|██████▋   | 12/18 [00:01<00:00, 12.41it/s] 78%|███████▊  | 14/18 [00:01<00:00, 10.71it/s] 89%|████████▉ | 16/18 [00:01<00:00,  9.92it/s]100%|██████████| 18/18 [00:04<00:00,  1.69it/s]100%|██████████| 18/18 [00:04<00:00,  3.69it/s]
2025-03-09 09:12:15,574 [INFO]: 	Computing best hyperparameters for index knn.index 03/09/2025, 09:12:15
2025-03-09 09:13:09,087 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 53.5128 secs
2025-03-09 09:13:09,087 [INFO]: The best hyperparameters are: efSearch=185
2025-03-09 09:13:09,087 [INFO]: 	Compute fast metrics 03/09/2025, 09:13:09
  0%|          | 0/4 [00:00<?, ?it/s] 25%|██▌       | 1/4 [00:00<00:00,  5.08it/s] 50%|█████     | 2/4 [00:00<00:00,  6.99it/s] 75%|███████▌  | 3/4 [00:00<00:00,  7.65it/s] 75%|███████▌  | 3/4 [00:00<00:00,  5.61it/s]
2025-03-09 09:13:25,428 [INFO]: 	>>> Finished "Compute fast metrics" in 16.3402 secs
2025-03-09 09:13:25,431 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 74.7424 secs
2025-03-09 09:13:25,431 [INFO]: {
2025-03-09 09:13:25,431 [INFO]: 	index_key: HNSW15
2025-03-09 09:13:25,431 [INFO]: 	index_param: efSearch=185
2025-03-09 09:13:25,431 [INFO]: 	index_path: knn.index
2025-03-09 09:13:25,431 [INFO]: 	size in bytes: 860558350
2025-03-09 09:13:25,431 [INFO]: 	avg_search_speed_ms: 8.199722106913082
2025-03-09 09:13:25,431 [INFO]: 	99p_search_speed_ms: 15.661011296324427
2025-03-09 09:13:25,431 [INFO]: 	reconstruction error %: 0.0
2025-03-09 09:13:25,431 [INFO]: 	nb vectors: 4374
2025-03-09 09:13:25,431 [INFO]: 	vectors dimension: 49152
2025-03-09 09:13:25,431 [INFO]: 	compression ratio: 0.9993086372353485
2025-03-09 09:13:25,431 [INFO]: }
2025-03-09 09:13:25,431 [INFO]: 	>>> Finished "Creating the index" in 74.7462 secs
2025-03-09 09:13:25,431 [INFO]: >>> Finished "Launching the whole pipeline" in 74.7791 secs
2025-03-09 09:13:26: [retrieval_preprocessing] calculating distances ...
2025-03-09 09:13:26: [retrieval_preprocessing] finished and saved retrieval indices for episode 71215 [episode count 19/20]
2025-03-09 09:13:26: [retrieval_preprocessing] finished for (818725642, 'block') [chosen_id count 5/10]
2025-03-09 09:13:29: [retrieval_preprocessing] concatenated all embeddings and indices for 20 episodes for (3854327802, 'bottle') [chosen_id count 6/10]
2025-03-09 09:13:29: [retrieval_preprocessing] we have num_total=3402 embedding_dim=49152
[retrieval_preprocessing] for episode 54799 [episode count 0/20], we have num_retrieval=np.int64(3254) num_query=np.int64(148)
2025-03-09 09:13:30,236 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-09 09:13:30,697 [INFO]: Launching the whole pipeline 03/09/2025, 09:13:30
2025-03-09 09:13:30,697 [INFO]: Reading total number of vectors and dimension 03/09/2025, 09:13:30
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1259.17it/s]
2025-03-09 09:13:30,727 [INFO]: There are 3254 embeddings of dim 49152
2025-03-09 09:13:30,728 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0302 secs
2025-03-09 09:13:30,728 [INFO]: 	Compute estimated construction time of the index 03/09/2025, 09:13:30
2025-03-09 09:13:30,728 [INFO]: 		-> Train: 16.7 minutes
2025-03-09 09:13:30,728 [INFO]: 		-> Add: 1.8 seconds
2025-03-09 09:13:30,728 [INFO]: 		Total: 16.7 minutes
2025-03-09 09:13:30,728 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0001 secs
2025-03-09 09:13:30,728 [INFO]: 	Checking that your have enough memory available to create the index 03/09/2025, 09:13:30
2025-03-09 09:13:30,728 [INFO]: 671.5MB of memory will be needed to build the index (more might be used if you have more)
2025-03-09 09:13:30,728 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0002 secs
2025-03-09 09:13:30,728 [INFO]: 	Selecting most promising index types given data characteristics 03/09/2025, 09:13:30
2025-03-09 09:13:30,728 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-09 09:13:30,728 [INFO]: 	Creating the index 03/09/2025, 09:13:30
2025-03-09 09:13:30,728 [INFO]: 		-> Instanciate the index HNSW15 03/09/2025, 09:13:30
2025-03-09 09:13:30,729 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0010 secs
2025-03-09 09:13:30,729 [INFO]: 		-> Adding the vectors to the index 03/09/2025, 09:13:30
2025-03-09 09:13:30,729 [INFO]: The memory available for adding the vectors is 49.4GB(total available - used by the index)
2025-03-09 09:13:30,729 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/13 [00:00<?, ?it/s]  8%|▊         | 1/13 [00:00<00:02,  5.84it/s] 15%|█▌        | 2/13 [00:00<00:01,  7.16it/s] 23%|██▎       | 3/13 [00:00<00:01,  7.70it/s] 31%|███       | 4/13 [00:00<00:01,  8.01it/s] 38%|███▊      | 5/13 [00:00<00:00,  8.31it/s] 46%|████▌     | 6/13 [00:00<00:00,  8.46it/s] 54%|█████▍    | 7/13 [00:00<00:00,  8.56it/s] 69%|██████▉   | 9/13 [00:01<00:00, 10.08it/s] 77%|███████▋  | 10/13 [00:01<00:00,  9.69it/s] 85%|████████▍ | 11/13 [00:01<00:00,  9.45it/s] 92%|█████████▏| 12/13 [00:01<00:00,  9.18it/s]100%|██████████| 13/13 [00:03<00:00,  1.43it/s]100%|██████████| 13/13 [00:03<00:00,  3.65it/s]
2025-03-09 09:13:34,303 [INFO]: 	Computing best hyperparameters for index knn.index 03/09/2025, 09:13:34
2025-03-09 09:14:07,087 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 32.7831 secs
2025-03-09 09:14:07,087 [INFO]: The best hyperparameters are: efSearch=305
2025-03-09 09:14:07,088 [INFO]: 	Compute fast metrics 03/09/2025, 09:14:07
  0%|          | 0/4 [00:00<?, ?it/s] 25%|██▌       | 1/4 [00:00<00:00,  5.31it/s] 75%|███████▌  | 3/4 [00:00<00:00,  8.78it/s] 75%|███████▌  | 3/4 [00:00<00:00,  6.81it/s]
2025-03-09 09:14:24,916 [INFO]: 	>>> Finished "Compute fast metrics" in 17.8279 secs
2025-03-09 09:14:24,918 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 54.1885 secs
2025-03-09 09:14:24,918 [INFO]: {
2025-03-09 09:14:24,918 [INFO]: 	index_key: HNSW15
2025-03-09 09:14:24,918 [INFO]: 	index_param: efSearch=305
2025-03-09 09:14:24,918 [INFO]: 	index_path: knn.index
2025-03-09 09:14:24,918 [INFO]: 	size in bytes: 640204690
2025-03-09 09:14:24,918 [INFO]: 	avg_search_speed_ms: 12.06004042942324
2025-03-09 09:14:24,918 [INFO]: 	99p_search_speed_ms: 22.338718743994843
2025-03-09 09:14:24,918 [INFO]: 	reconstruction error %: 0.0
2025-03-09 09:14:24,918 [INFO]: 	nb vectors: 3254
2025-03-09 09:14:24,918 [INFO]: 	vectors dimension: 49152
2025-03-09 09:14:24,918 [INFO]: 	compression ratio: 0.9993091928145669
2025-03-09 09:14:24,918 [INFO]: }
2025-03-09 09:14:24,918 [INFO]: 	>>> Finished "Creating the index" in 54.1900 secs
2025-03-09 09:14:24,918 [INFO]: >>> Finished "Launching the whole pipeline" in 54.2208 secs
2025-03-09 09:14:26: [retrieval_preprocessing] calculating distances ...
2025-03-09 09:14:26: [retrieval_preprocessing] finished and saved retrieval indices for episode 54799 [episode count 0/20]
[retrieval_preprocessing] for episode 7696 [episode count 1/20], we have num_retrieval=np.int64(3222) num_query=np.int64(180)
2025-03-09 09:14:27,597 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-09 09:14:28,066 [INFO]: Launching the whole pipeline 03/09/2025, 09:14:28
2025-03-09 09:14:28,066 [INFO]: Reading total number of vectors and dimension 03/09/2025, 09:14:28
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1906.50it/s]
2025-03-09 09:14:28,090 [INFO]: There are 3222 embeddings of dim 49152
2025-03-09 09:14:28,091 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0249 secs
2025-03-09 09:14:28,091 [INFO]: 	Compute estimated construction time of the index 03/09/2025, 09:14:28
2025-03-09 09:14:28,091 [INFO]: 		-> Train: 16.7 minutes
2025-03-09 09:14:28,091 [INFO]: 		-> Add: 1.8 seconds
2025-03-09 09:14:28,091 [INFO]: 		Total: 16.7 minutes
2025-03-09 09:14:28,091 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0002 secs
2025-03-09 09:14:28,091 [INFO]: 	Checking that your have enough memory available to create the index 03/09/2025, 09:14:28
2025-03-09 09:14:28,091 [INFO]: 664.9MB of memory will be needed to build the index (more might be used if you have more)
2025-03-09 09:14:28,091 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0002 secs
2025-03-09 09:14:28,091 [INFO]: 	Selecting most promising index types given data characteristics 03/09/2025, 09:14:28
2025-03-09 09:14:28,091 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-09 09:14:28,091 [INFO]: 	Creating the index 03/09/2025, 09:14:28
2025-03-09 09:14:28,091 [INFO]: 		-> Instanciate the index HNSW15 03/09/2025, 09:14:28
2025-03-09 09:14:28,092 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0012 secs
2025-03-09 09:14:28,093 [INFO]: 		-> Adding the vectors to the index 03/09/2025, 09:14:28
2025-03-09 09:14:28,093 [INFO]: The memory available for adding the vectors is 49.4GB(total available - used by the index)
2025-03-09 09:14:28,093 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/13 [00:00<?, ?it/s]  8%|▊         | 1/13 [00:00<00:01,  8.82it/s] 23%|██▎       | 3/13 [00:00<00:00, 11.26it/s] 38%|███▊      | 5/13 [00:00<00:00, 11.97it/s] 54%|█████▍    | 7/13 [00:00<00:00, 12.24it/s] 69%|██████▉   | 9/13 [00:00<00:00, 11.98it/s] 85%|████████▍ | 11/13 [00:00<00:00, 12.61it/s]100%|██████████| 13/13 [00:03<00:00,  2.28it/s]100%|██████████| 13/13 [00:03<00:00,  4.03it/s]
2025-03-09 09:14:31,328 [INFO]: 	Computing best hyperparameters for index knn.index 03/09/2025, 09:14:31
2025-03-09 09:15:08,445 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 37.1159 secs
2025-03-09 09:15:08,445 [INFO]: The best hyperparameters are: efSearch=258
2025-03-09 09:15:08,445 [INFO]: 	Compute fast metrics 03/09/2025, 09:15:08
  0%|          | 0/4 [00:00<?, ?it/s] 25%|██▌       | 1/4 [00:00<00:00,  5.13it/s] 50%|█████     | 2/4 [00:00<00:00,  7.04it/s] 75%|███████▌  | 3/4 [00:00<00:00,  6.27it/s] 75%|███████▌  | 3/4 [00:00<00:00,  5.01it/s]
2025-03-09 09:15:23,278 [INFO]: 	>>> Finished "Compute fast metrics" in 14.8328 secs
2025-03-09 09:15:23,280 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 55.1875 secs
2025-03-09 09:15:23,280 [INFO]: {
2025-03-09 09:15:23,280 [INFO]: 	index_key: HNSW15
2025-03-09 09:15:23,280 [INFO]: 	index_param: efSearch=258
2025-03-09 09:15:23,280 [INFO]: 	index_path: knn.index
2025-03-09 09:15:23,280 [INFO]: 	size in bytes: 633908590
2025-03-09 09:15:23,280 [INFO]: 	avg_search_speed_ms: 10.31087774365718
2025-03-09 09:15:23,280 [INFO]: 	99p_search_speed_ms: 16.915324726141986
2025-03-09 09:15:23,280 [INFO]: 	reconstruction error %: 0.0
2025-03-09 09:15:23,280 [INFO]: 	nb vectors: 3222
2025-03-09 09:15:23,280 [INFO]: 	vectors dimension: 49152
2025-03-09 09:15:23,280 [INFO]: 	compression ratio: 0.9993096575643501
2025-03-09 09:15:23,280 [INFO]: }
2025-03-09 09:15:23,280 [INFO]: 	>>> Finished "Creating the index" in 55.1892 secs
2025-03-09 09:15:23,280 [INFO]: >>> Finished "Launching the whole pipeline" in 55.2148 secs
2025-03-09 09:15:24: [retrieval_preprocessing] calculating distances ...
2025-03-09 09:15:24: [retrieval_preprocessing] finished and saved retrieval indices for episode 7696 [episode count 1/20]
[retrieval_preprocessing] for episode 54814 [episode count 2/20], we have num_retrieval=np.int64(3248) num_query=np.int64(154)
2025-03-09 09:15:25,509 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-09 09:15:25,899 [INFO]: Launching the whole pipeline 03/09/2025, 09:15:25
2025-03-09 09:15:25,899 [INFO]: Reading total number of vectors and dimension 03/09/2025, 09:15:25
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1506.03it/s]
2025-03-09 09:15:25,924 [INFO]: There are 3248 embeddings of dim 49152
2025-03-09 09:15:25,924 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0252 secs
2025-03-09 09:15:25,924 [INFO]: 	Compute estimated construction time of the index 03/09/2025, 09:15:25
2025-03-09 09:15:25,925 [INFO]: 		-> Train: 16.7 minutes
2025-03-09 09:15:25,925 [INFO]: 		-> Add: 1.8 seconds
2025-03-09 09:15:25,925 [INFO]: 		Total: 16.7 minutes
2025-03-09 09:15:25,925 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0001 secs
2025-03-09 09:15:25,925 [INFO]: 	Checking that your have enough memory available to create the index 03/09/2025, 09:15:25
2025-03-09 09:15:25,925 [INFO]: 670.3MB of memory will be needed to build the index (more might be used if you have more)
2025-03-09 09:15:25,925 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0001 secs
2025-03-09 09:15:25,925 [INFO]: 	Selecting most promising index types given data characteristics 03/09/2025, 09:15:25
2025-03-09 09:15:25,925 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-09 09:15:25,925 [INFO]: 	Creating the index 03/09/2025, 09:15:25
2025-03-09 09:15:25,925 [INFO]: 		-> Instanciate the index HNSW15 03/09/2025, 09:15:25
2025-03-09 09:15:25,926 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0011 secs
2025-03-09 09:15:25,926 [INFO]: 		-> Adding the vectors to the index 03/09/2025, 09:15:25
2025-03-09 09:15:25,926 [INFO]: The memory available for adding the vectors is 49.4GB(total available - used by the index)
2025-03-09 09:15:25,926 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/13 [00:00<?, ?it/s]  8%|▊         | 1/13 [00:00<00:02,  5.78it/s] 15%|█▌        | 2/13 [00:00<00:01,  7.41it/s] 23%|██▎       | 3/13 [00:00<00:01,  8.10it/s] 31%|███       | 4/13 [00:00<00:01,  8.48it/s] 38%|███▊      | 5/13 [00:00<00:00,  8.83it/s] 46%|████▌     | 6/13 [00:00<00:00,  8.86it/s] 54%|█████▍    | 7/13 [00:00<00:00,  8.80it/s] 62%|██████▏   | 8/13 [00:00<00:00,  8.73it/s] 69%|██████▉   | 9/13 [00:01<00:00,  7.87it/s] 77%|███████▋  | 10/13 [00:01<00:00,  7.70it/s] 85%|████████▍ | 11/13 [00:01<00:00,  8.00it/s]100%|██████████| 13/13 [00:03<00:00,  1.71it/s]100%|██████████| 13/13 [00:03<00:00,  3.64it/s]
2025-03-09 09:15:29,506 [INFO]: 	Computing best hyperparameters for index knn.index 03/09/2025, 09:15:29
2025-03-09 09:15:58,815 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 29.3087 secs
2025-03-09 09:15:58,816 [INFO]: The best hyperparameters are: efSearch=155
2025-03-09 09:15:58,816 [INFO]: 	Compute fast metrics 03/09/2025, 09:15:58
  0%|          | 0/4 [00:00<?, ?it/s] 25%|██▌       | 1/4 [00:00<00:00,  6.91it/s] 75%|███████▌  | 3/4 [00:00<00:00, 14.16it/s]
2025-03-09 09:16:17,392 [INFO]: 	>>> Finished "Compute fast metrics" in 18.5763 secs
2025-03-09 09:16:17,395 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 51.4684 secs
2025-03-09 09:16:17,395 [INFO]: {
2025-03-09 09:16:17,395 [INFO]: 	index_key: HNSW15
2025-03-09 09:16:17,395 [INFO]: 	index_param: efSearch=155
2025-03-09 09:16:17,395 [INFO]: 	index_path: knn.index
2025-03-09 09:16:17,395 [INFO]: 	size in bytes: 639024250
2025-03-09 09:16:17,395 [INFO]: 	avg_search_speed_ms: 7.389290280659399
2025-03-09 09:16:17,395 [INFO]: 	99p_search_speed_ms: 14.53628527000548
2025-03-09 09:16:17,395 [INFO]: 	reconstruction error %: 0.0
2025-03-09 09:16:17,395 [INFO]: 	nb vectors: 3248
2025-03-09 09:16:17,395 [INFO]: 	vectors dimension: 49152
2025-03-09 09:16:17,395 [INFO]: 	compression ratio: 0.9993091561079255
2025-03-09 09:16:17,395 [INFO]: }
2025-03-09 09:16:17,395 [INFO]: 	>>> Finished "Creating the index" in 51.4699 secs
2025-03-09 09:16:17,395 [INFO]: >>> Finished "Launching the whole pipeline" in 51.4957 secs
2025-03-09 09:16:17: [retrieval_preprocessing] calculating distances ...
2025-03-09 09:16:18: [retrieval_preprocessing] finished and saved retrieval indices for episode 54814 [episode count 2/20]
[retrieval_preprocessing] for episode 61474 [episode count 3/20], we have num_retrieval=np.int64(3233) num_query=np.int64(169)
2025-03-09 09:16:19,016 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-09 09:16:19,498 [INFO]: Launching the whole pipeline 03/09/2025, 09:16:19
2025-03-09 09:16:19,498 [INFO]: Reading total number of vectors and dimension 03/09/2025, 09:16:19
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1539.19it/s]
2025-03-09 09:16:19,525 [INFO]: There are 3233 embeddings of dim 49152
2025-03-09 09:16:19,525 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0267 secs
2025-03-09 09:16:19,525 [INFO]: 	Compute estimated construction time of the index 03/09/2025, 09:16:19
2025-03-09 09:16:19,525 [INFO]: 		-> Train: 16.7 minutes
2025-03-09 09:16:19,525 [INFO]: 		-> Add: 1.8 seconds
2025-03-09 09:16:19,525 [INFO]: 		Total: 16.7 minutes
2025-03-09 09:16:19,525 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0001 secs
2025-03-09 09:16:19,525 [INFO]: 	Checking that your have enough memory available to create the index 03/09/2025, 09:16:19
2025-03-09 09:16:19,525 [INFO]: 667.2MB of memory will be needed to build the index (more might be used if you have more)
2025-03-09 09:16:19,525 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0001 secs
2025-03-09 09:16:19,526 [INFO]: 	Selecting most promising index types given data characteristics 03/09/2025, 09:16:19
2025-03-09 09:16:19,526 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-09 09:16:19,526 [INFO]: 	Creating the index 03/09/2025, 09:16:19
2025-03-09 09:16:19,526 [INFO]: 		-> Instanciate the index HNSW15 03/09/2025, 09:16:19
2025-03-09 09:16:19,527 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0011 secs
2025-03-09 09:16:19,527 [INFO]: 		-> Adding the vectors to the index 03/09/2025, 09:16:19
2025-03-09 09:16:19,527 [INFO]: The memory available for adding the vectors is 49.4GB(total available - used by the index)
2025-03-09 09:16:19,527 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/13 [00:00<?, ?it/s]  8%|▊         | 1/13 [00:00<00:01,  6.55it/s] 23%|██▎       | 3/13 [00:00<00:00, 12.76it/s] 38%|███▊      | 5/13 [00:00<00:00, 15.07it/s] 54%|█████▍    | 7/13 [00:00<00:00, 14.01it/s] 69%|██████▉   | 9/13 [00:00<00:00, 13.40it/s] 85%|████████▍ | 11/13 [00:00<00:00, 12.75it/s]100%|██████████| 13/13 [00:03<00:00,  2.32it/s]100%|██████████| 13/13 [00:03<00:00,  4.15it/s]
2025-03-09 09:16:22,666 [INFO]: 	Computing best hyperparameters for index knn.index 03/09/2025, 09:16:22
2025-03-09 09:16:57,955 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 35.2884 secs
2025-03-09 09:16:57,956 [INFO]: The best hyperparameters are: efSearch=245
2025-03-09 09:16:57,956 [INFO]: 	Compute fast metrics 03/09/2025, 09:16:57
  0%|          | 0/4 [00:00<?, ?it/s] 25%|██▌       | 1/4 [00:00<00:00,  5.33it/s] 50%|█████     | 2/4 [00:00<00:00,  7.04it/s] 75%|███████▌  | 3/4 [00:00<00:00,  7.90it/s] 75%|███████▌  | 3/4 [00:00<00:00,  5.84it/s]
2025-03-09 09:17:21,661 [INFO]: 	>>> Finished "Compute fast metrics" in 23.7050 secs
2025-03-09 09:17:21,663 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 62.1363 secs
2025-03-09 09:17:21,663 [INFO]: {
2025-03-09 09:17:21,663 [INFO]: 	index_key: HNSW15
2025-03-09 09:17:21,663 [INFO]: 	index_param: efSearch=245
2025-03-09 09:17:21,663 [INFO]: 	index_path: knn.index
2025-03-09 09:17:21,663 [INFO]: 	size in bytes: 636072970
2025-03-09 09:17:21,663 [INFO]: 	avg_search_speed_ms: 9.64760324978804
2025-03-09 09:17:21,663 [INFO]: 	99p_search_speed_ms: 18.053808333352215
2025-03-09 09:17:21,663 [INFO]: 	reconstruction error %: 0.0
2025-03-09 09:17:21,663 [INFO]: 	nb vectors: 3233
2025-03-09 09:17:21,663 [INFO]: 	vectors dimension: 49152
2025-03-09 09:17:21,663 [INFO]: 	compression ratio: 0.9993093465361372
2025-03-09 09:17:21,664 [INFO]: }
2025-03-09 09:17:21,664 [INFO]: 	>>> Finished "Creating the index" in 62.1379 secs
2025-03-09 09:17:21,664 [INFO]: >>> Finished "Launching the whole pipeline" in 62.1652 secs
2025-03-09 09:17:22: [retrieval_preprocessing] calculating distances ...
2025-03-09 09:17:23: [retrieval_preprocessing] finished and saved retrieval indices for episode 61474 [episode count 3/20]
[retrieval_preprocessing] for episode 3624 [episode count 4/20], we have num_retrieval=np.int64(3234) num_query=np.int64(168)
2025-03-09 09:17:23,815 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-09 09:17:24,282 [INFO]: Launching the whole pipeline 03/09/2025, 09:17:24
2025-03-09 09:17:24,282 [INFO]: Reading total number of vectors and dimension 03/09/2025, 09:17:24
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1180.50it/s]
2025-03-09 09:17:24,311 [INFO]: There are 3234 embeddings of dim 49152
2025-03-09 09:17:24,311 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0294 secs
2025-03-09 09:17:24,312 [INFO]: 	Compute estimated construction time of the index 03/09/2025, 09:17:24
2025-03-09 09:17:24,312 [INFO]: 		-> Train: 16.7 minutes
2025-03-09 09:17:24,312 [INFO]: 		-> Add: 1.8 seconds
2025-03-09 09:17:24,312 [INFO]: 		Total: 16.7 minutes
2025-03-09 09:17:24,312 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0002 secs
2025-03-09 09:17:24,312 [INFO]: 	Checking that your have enough memory available to create the index 03/09/2025, 09:17:24
2025-03-09 09:17:24,312 [INFO]: 667.4MB of memory will be needed to build the index (more might be used if you have more)
2025-03-09 09:17:24,312 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0002 secs
2025-03-09 09:17:24,312 [INFO]: 	Selecting most promising index types given data characteristics 03/09/2025, 09:17:24
2025-03-09 09:17:24,312 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-09 09:17:24,312 [INFO]: 	Creating the index 03/09/2025, 09:17:24
2025-03-09 09:17:24,312 [INFO]: 		-> Instanciate the index HNSW15 03/09/2025, 09:17:24
2025-03-09 09:17:24,315 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0020 secs
2025-03-09 09:17:24,315 [INFO]: 		-> Adding the vectors to the index 03/09/2025, 09:17:24
2025-03-09 09:17:24,315 [INFO]: The memory available for adding the vectors is 49.4GB(total available - used by the index)
2025-03-09 09:17:24,315 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/13 [00:00<?, ?it/s]  8%|▊         | 1/13 [00:00<00:01,  8.95it/s] 23%|██▎       | 3/13 [00:00<00:00, 15.02it/s] 46%|████▌     | 6/13 [00:00<00:00, 17.74it/s] 62%|██████▏   | 8/13 [00:00<00:00, 16.69it/s] 77%|███████▋  | 10/13 [00:00<00:00, 17.38it/s] 92%|█████████▏| 12/13 [00:00<00:00, 17.88it/s]100%|██████████| 13/13 [00:02<00:00,  4.48it/s]
2025-03-09 09:17:27,224 [INFO]: 	Computing best hyperparameters for index knn.index 03/09/2025, 09:17:27
2025-03-09 09:18:06,016 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 38.7915 secs
2025-03-09 09:18:06,016 [INFO]: The best hyperparameters are: efSearch=222
2025-03-09 09:18:06,016 [INFO]: 	Compute fast metrics 03/09/2025, 09:18:06
  0%|          | 0/4 [00:00<?, ?it/s] 25%|██▌       | 1/4 [00:00<00:00,  6.80it/s] 75%|███████▌  | 3/4 [00:00<00:00,  9.27it/s] 75%|███████▌  | 3/4 [00:00<00:00,  6.90it/s]
2025-03-09 09:18:25,795 [INFO]: 	>>> Finished "Compute fast metrics" in 19.7787 secs
2025-03-09 09:18:25,797 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 61.4824 secs
2025-03-09 09:18:25,797 [INFO]: {
2025-03-09 09:18:25,797 [INFO]: 	index_key: HNSW15
2025-03-09 09:18:25,797 [INFO]: 	index_param: efSearch=222
2025-03-09 09:18:25,797 [INFO]: 	index_path: knn.index
2025-03-09 09:18:25,797 [INFO]: 	size in bytes: 636269710
2025-03-09 09:18:25,797 [INFO]: 	avg_search_speed_ms: 9.679375374815917
2025-03-09 09:18:25,797 [INFO]: 	99p_search_speed_ms: 17.663960121572003
2025-03-09 09:18:25,797 [INFO]: 	reconstruction error %: 0.0
2025-03-09 09:18:25,797 [INFO]: 	nb vectors: 3234
2025-03-09 09:18:25,797 [INFO]: 	vectors dimension: 49152
2025-03-09 09:18:25,797 [INFO]: 	compression ratio: 0.9993093526328638
2025-03-09 09:18:25,797 [INFO]: }
2025-03-09 09:18:25,797 [INFO]: 	>>> Finished "Creating the index" in 61.4851 secs
2025-03-09 09:18:25,797 [INFO]: >>> Finished "Launching the whole pipeline" in 61.5155 secs
2025-03-09 09:18:26: [retrieval_preprocessing] calculating distances ...
2025-03-09 09:18:27: [retrieval_preprocessing] finished and saved retrieval indices for episode 3624 [episode count 4/20]
[retrieval_preprocessing] for episode 14377 [episode count 5/20], we have num_retrieval=np.int64(3269) num_query=np.int64(133)
2025-03-09 09:18:28,545 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-09 09:18:29,674 [INFO]: Launching the whole pipeline 03/09/2025, 09:18:29
2025-03-09 09:18:29,674 [INFO]: Reading total number of vectors and dimension 03/09/2025, 09:18:29
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 2285.72it/s]
2025-03-09 09:18:29,700 [INFO]: There are 3269 embeddings of dim 49152
2025-03-09 09:18:29,700 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0261 secs
2025-03-09 09:18:29,700 [INFO]: 	Compute estimated construction time of the index 03/09/2025, 09:18:29
2025-03-09 09:18:29,700 [INFO]: 		-> Train: 16.7 minutes
2025-03-09 09:18:29,701 [INFO]: 		-> Add: 1.8 seconds
2025-03-09 09:18:29,701 [INFO]: 		Total: 16.7 minutes
2025-03-09 09:18:29,701 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0003 secs
2025-03-09 09:18:29,701 [INFO]: 	Checking that your have enough memory available to create the index 03/09/2025, 09:18:29
2025-03-09 09:18:29,701 [INFO]: 674.6MB of memory will be needed to build the index (more might be used if you have more)
2025-03-09 09:18:29,702 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0004 secs
2025-03-09 09:18:29,702 [INFO]: 	Selecting most promising index types given data characteristics 03/09/2025, 09:18:29
2025-03-09 09:18:29,702 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-09 09:18:29,702 [INFO]: 	Creating the index 03/09/2025, 09:18:29
2025-03-09 09:18:29,702 [INFO]: 		-> Instanciate the index HNSW15 03/09/2025, 09:18:29
2025-03-09 09:18:29,705 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0027 secs
2025-03-09 09:18:29,705 [INFO]: 		-> Adding the vectors to the index 03/09/2025, 09:18:29
2025-03-09 09:18:29,705 [INFO]: The memory available for adding the vectors is 49.4GB(total available - used by the index)
2025-03-09 09:18:29,705 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/13 [00:00<?, ?it/s]  8%|▊         | 1/13 [00:00<00:01,  6.12it/s] 15%|█▌        | 2/13 [00:00<00:01,  7.29it/s] 23%|██▎       | 3/13 [00:00<00:01,  7.62it/s] 31%|███       | 4/13 [00:00<00:01,  7.61it/s] 38%|███▊      | 5/13 [00:00<00:01,  7.68it/s] 46%|████▌     | 6/13 [00:00<00:00,  7.82it/s] 54%|█████▍    | 7/13 [00:00<00:00,  7.79it/s] 62%|██████▏   | 8/13 [00:01<00:00,  7.70it/s] 69%|██████▉   | 9/13 [00:01<00:00,  7.72it/s] 77%|███████▋  | 10/13 [00:01<00:00,  7.75it/s] 85%|████████▍ | 11/13 [00:01<00:00,  7.86it/s] 92%|█████████▏| 12/13 [00:01<00:00,  7.75it/s]100%|██████████| 13/13 [00:04<00:00,  1.15it/s]100%|██████████| 13/13 [00:04<00:00,  3.14it/s]
2025-03-09 09:18:33,852 [INFO]: 	Computing best hyperparameters for index knn.index 03/09/2025, 09:18:33
2025-03-09 09:19:05,835 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 31.9829 secs
2025-03-09 09:19:05,835 [INFO]: The best hyperparameters are: efSearch=212
2025-03-09 09:19:05,835 [INFO]: 	Compute fast metrics 03/09/2025, 09:19:05
  0%|          | 0/4 [00:00<?, ?it/s] 25%|██▌       | 1/4 [00:00<00:00,  6.95it/s] 75%|███████▌  | 3/4 [00:00<00:00, 10.48it/s] 75%|███████▌  | 3/4 [00:00<00:00,  7.85it/s]
2025-03-09 09:19:23,140 [INFO]: 	>>> Finished "Compute fast metrics" in 17.3046 secs
2025-03-09 09:19:23,143 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 53.4377 secs
2025-03-09 09:19:23,143 [INFO]: {
2025-03-09 09:19:23,143 [INFO]: 	index_key: HNSW15
2025-03-09 09:19:23,143 [INFO]: 	index_param: efSearch=212
2025-03-09 09:19:23,143 [INFO]: 	index_path: knn.index
2025-03-09 09:19:23,143 [INFO]: 	size in bytes: 643155970
2025-03-09 09:19:23,143 [INFO]: 	avg_search_speed_ms: 8.699525463588543
2025-03-09 09:19:23,143 [INFO]: 	99p_search_speed_ms: 13.28901377506554
2025-03-09 09:19:23,143 [INFO]: 	reconstruction error %: 0.0
2025-03-09 09:19:23,143 [INFO]: 	nb vectors: 3269
2025-03-09 09:19:23,143 [INFO]: 	vectors dimension: 49152
2025-03-09 09:19:23,143 [INFO]: 	compression ratio: 0.9993090043150809
2025-03-09 09:19:23,143 [INFO]: }
2025-03-09 09:19:23,143 [INFO]: 	>>> Finished "Creating the index" in 53.4413 secs
2025-03-09 09:19:23,143 [INFO]: >>> Finished "Launching the whole pipeline" in 53.4694 secs
2025-03-09 09:19:23: [retrieval_preprocessing] calculating distances ...
2025-03-09 09:19:24: [retrieval_preprocessing] finished and saved retrieval indices for episode 14377 [episode count 5/20]
[retrieval_preprocessing] for episode 71214 [episode count 6/20], we have num_retrieval=np.int64(3217) num_query=np.int64(185)
2025-03-09 09:19:25,192 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-09 09:19:25,589 [INFO]: Launching the whole pipeline 03/09/2025, 09:19:25
2025-03-09 09:19:25,589 [INFO]: Reading total number of vectors and dimension 03/09/2025, 09:19:25
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1476.87it/s]
2025-03-09 09:19:25,615 [INFO]: There are 3217 embeddings of dim 49152
2025-03-09 09:19:25,615 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0259 secs
2025-03-09 09:19:25,615 [INFO]: 	Compute estimated construction time of the index 03/09/2025, 09:19:25
2025-03-09 09:19:25,616 [INFO]: 		-> Train: 16.7 minutes
2025-03-09 09:19:25,616 [INFO]: 		-> Add: 1.8 seconds
2025-03-09 09:19:25,616 [INFO]: 		Total: 16.7 minutes
2025-03-09 09:19:25,616 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0001 secs
2025-03-09 09:19:25,616 [INFO]: 	Checking that your have enough memory available to create the index 03/09/2025, 09:19:25
2025-03-09 09:19:25,616 [INFO]: 663.9MB of memory will be needed to build the index (more might be used if you have more)
2025-03-09 09:19:25,616 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0001 secs
2025-03-09 09:19:25,616 [INFO]: 	Selecting most promising index types given data characteristics 03/09/2025, 09:19:25
2025-03-09 09:19:25,616 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-09 09:19:25,616 [INFO]: 	Creating the index 03/09/2025, 09:19:25
2025-03-09 09:19:25,616 [INFO]: 		-> Instanciate the index HNSW15 03/09/2025, 09:19:25
2025-03-09 09:19:25,617 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0010 secs
2025-03-09 09:19:25,617 [INFO]: 		-> Adding the vectors to the index 03/09/2025, 09:19:25
2025-03-09 09:19:25,617 [INFO]: The memory available for adding the vectors is 49.4GB(total available - used by the index)
2025-03-09 09:19:25,617 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/13 [00:00<?, ?it/s]  8%|▊         | 1/13 [00:00<00:01,  6.19it/s] 23%|██▎       | 3/13 [00:00<00:00, 10.61it/s] 38%|███▊      | 5/13 [00:00<00:00, 11.92it/s] 54%|█████▍    | 7/13 [00:00<00:00, 12.99it/s] 69%|██████▉   | 9/13 [00:00<00:00, 12.97it/s] 85%|████████▍ | 11/13 [00:00<00:00, 12.90it/s]100%|██████████| 13/13 [00:03<00:00,  2.28it/s]100%|██████████| 13/13 [00:03<00:00,  4.03it/s]
2025-03-09 09:19:28,842 [INFO]: 	Computing best hyperparameters for index knn.index 03/09/2025, 09:19:28
2025-03-09 09:19:57,620 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 28.7771 secs
2025-03-09 09:19:57,620 [INFO]: The best hyperparameters are: efSearch=206
2025-03-09 09:19:57,620 [INFO]: 	Compute fast metrics 03/09/2025, 09:19:57
  0%|          | 0/4 [00:00<?, ?it/s] 25%|██▌       | 1/4 [00:00<00:00,  5.16it/s] 50%|█████     | 2/4 [00:00<00:00,  7.14it/s] 75%|███████▌  | 3/4 [00:00<00:00,  7.85it/s] 75%|███████▌  | 3/4 [00:00<00:00,  5.80it/s]
2025-03-09 09:20:14,242 [INFO]: 	>>> Finished "Compute fast metrics" in 16.6215 secs
2025-03-09 09:20:14,244 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 48.6267 secs
2025-03-09 09:20:14,244 [INFO]: {
2025-03-09 09:20:14,244 [INFO]: 	index_key: HNSW15
2025-03-09 09:20:14,244 [INFO]: 	index_param: efSearch=206
2025-03-09 09:20:14,244 [INFO]: 	index_path: knn.index
2025-03-09 09:20:14,244 [INFO]: 	size in bytes: 632924770
2025-03-09 09:20:14,244 [INFO]: 	avg_search_speed_ms: 8.737946387313723
2025-03-09 09:20:14,244 [INFO]: 	99p_search_speed_ms: 15.990350639913222
2025-03-09 09:20:14,244 [INFO]: 	reconstruction error %: 0.0
2025-03-09 09:20:14,244 [INFO]: 	nb vectors: 3217
2025-03-09 09:20:14,244 [INFO]: 	vectors dimension: 49152
2025-03-09 09:20:14,244 [INFO]: 	compression ratio: 0.9993098168681248
2025-03-09 09:20:14,244 [INFO]: }
2025-03-09 09:20:14,244 [INFO]: 	>>> Finished "Creating the index" in 48.6282 secs
2025-03-09 09:20:14,244 [INFO]: >>> Finished "Launching the whole pipeline" in 48.6546 secs
2025-03-09 09:20:14: [retrieval_preprocessing] calculating distances ...
2025-03-09 09:20:15: [retrieval_preprocessing] finished and saved retrieval indices for episode 71214 [episode count 6/20]
[retrieval_preprocessing] for episode 48178 [episode count 7/20], we have num_retrieval=np.int64(3231) num_query=np.int64(171)
2025-03-09 09:20:16,401 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-09 09:20:16,847 [INFO]: Launching the whole pipeline 03/09/2025, 09:20:16
2025-03-09 09:20:16,847 [INFO]: Reading total number of vectors and dimension 03/09/2025, 09:20:16
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1589.96it/s]
2025-03-09 09:20:16,876 [INFO]: There are 3231 embeddings of dim 49152
2025-03-09 09:20:16,876 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0289 secs
2025-03-09 09:20:16,876 [INFO]: 	Compute estimated construction time of the index 03/09/2025, 09:20:16
2025-03-09 09:20:16,876 [INFO]: 		-> Train: 16.7 minutes
2025-03-09 09:20:16,876 [INFO]: 		-> Add: 1.8 seconds
2025-03-09 09:20:16,876 [INFO]: 		Total: 16.7 minutes
2025-03-09 09:20:16,876 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0001 secs
2025-03-09 09:20:16,876 [INFO]: 	Checking that your have enough memory available to create the index 03/09/2025, 09:20:16
2025-03-09 09:20:16,876 [INFO]: 666.8MB of memory will be needed to build the index (more might be used if you have more)
2025-03-09 09:20:16,876 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0001 secs
2025-03-09 09:20:16,876 [INFO]: 	Selecting most promising index types given data characteristics 03/09/2025, 09:20:16
2025-03-09 09:20:16,876 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-09 09:20:16,876 [INFO]: 	Creating the index 03/09/2025, 09:20:16
2025-03-09 09:20:16,876 [INFO]: 		-> Instanciate the index HNSW15 03/09/2025, 09:20:16
2025-03-09 09:20:16,877 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0008 secs
2025-03-09 09:20:16,877 [INFO]: 		-> Adding the vectors to the index 03/09/2025, 09:20:16
2025-03-09 09:20:16,877 [INFO]: The memory available for adding the vectors is 49.4GB(total available - used by the index)
2025-03-09 09:20:16,877 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/13 [00:00<?, ?it/s]  8%|▊         | 1/13 [00:00<00:02,  5.64it/s] 23%|██▎       | 3/13 [00:00<00:01,  8.86it/s] 31%|███       | 4/13 [00:00<00:01,  8.98it/s] 46%|████▌     | 6/13 [00:00<00:00,  9.55it/s] 54%|█████▍    | 7/13 [00:00<00:00,  9.39it/s] 62%|██████▏   | 8/13 [00:00<00:00,  9.48it/s] 69%|██████▉   | 9/13 [00:00<00:00,  9.35it/s] 77%|███████▋  | 10/13 [00:01<00:00,  9.28it/s] 85%|████████▍ | 11/13 [00:01<00:00,  9.07it/s] 92%|█████████▏| 12/13 [00:01<00:00,  8.82it/s]100%|██████████| 13/13 [00:03<00:00,  1.36it/s]100%|██████████| 13/13 [00:03<00:00,  3.65it/s]
2025-03-09 09:20:20,446 [INFO]: 	Computing best hyperparameters for index knn.index 03/09/2025, 09:20:20
2025-03-09 09:20:59,380 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 38.9340 secs
2025-03-09 09:20:59,380 [INFO]: The best hyperparameters are: efSearch=208
2025-03-09 09:20:59,380 [INFO]: 	Compute fast metrics 03/09/2025, 09:20:59
  0%|          | 0/4 [00:00<?, ?it/s] 25%|██▌       | 1/4 [00:00<00:00,  4.86it/s] 50%|█████     | 2/4 [00:00<00:00,  6.09it/s] 75%|███████▌  | 3/4 [00:00<00:00,  6.47it/s] 75%|███████▌  | 3/4 [00:00<00:00,  4.92it/s]
2025-03-09 09:21:18,478 [INFO]: 	>>> Finished "Compute fast metrics" in 19.0978 secs
2025-03-09 09:21:18,481 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 61.6035 secs
2025-03-09 09:21:18,481 [INFO]: {
2025-03-09 09:21:18,481 [INFO]: 	index_key: HNSW15
2025-03-09 09:21:18,481 [INFO]: 	index_param: efSearch=208
2025-03-09 09:21:18,481 [INFO]: 	index_path: knn.index
2025-03-09 09:21:18,481 [INFO]: 	size in bytes: 635679490
2025-03-09 09:21:18,481 [INFO]: 	avg_search_speed_ms: 8.507772169492029
2025-03-09 09:21:18,481 [INFO]: 	99p_search_speed_ms: 15.765714817680417
2025-03-09 09:21:18,481 [INFO]: 	reconstruction error %: 0.0
2025-03-09 09:21:18,481 [INFO]: 	nb vectors: 3231
2025-03-09 09:21:18,481 [INFO]: 	vectors dimension: 49152
2025-03-09 09:21:18,481 [INFO]: 	compression ratio: 0.9993093343313625
2025-03-09 09:21:18,481 [INFO]: }
2025-03-09 09:21:18,481 [INFO]: 	>>> Finished "Creating the index" in 61.6048 secs
2025-03-09 09:21:18,481 [INFO]: >>> Finished "Launching the whole pipeline" in 61.6342 secs
2025-03-09 09:21:19: [retrieval_preprocessing] calculating distances ...
2025-03-09 09:21:19: [retrieval_preprocessing] finished and saved retrieval indices for episode 48178 [episode count 7/20]
[retrieval_preprocessing] for episode 44084 [episode count 8/20], we have num_retrieval=np.int64(3227) num_query=np.int64(175)
2025-03-09 09:21:20,585 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-09 09:21:21,151 [INFO]: Launching the whole pipeline 03/09/2025, 09:21:21
2025-03-09 09:21:21,151 [INFO]: Reading total number of vectors and dimension 03/09/2025, 09:21:21
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1156.09it/s]
2025-03-09 09:21:21,182 [INFO]: There are 3227 embeddings of dim 49152
2025-03-09 09:21:21,183 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0317 secs
2025-03-09 09:21:21,183 [INFO]: 	Compute estimated construction time of the index 03/09/2025, 09:21:21
2025-03-09 09:21:21,183 [INFO]: 		-> Train: 16.7 minutes
2025-03-09 09:21:21,183 [INFO]: 		-> Add: 1.8 seconds
2025-03-09 09:21:21,183 [INFO]: 		Total: 16.7 minutes
2025-03-09 09:21:21,183 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0004 secs
2025-03-09 09:21:21,183 [INFO]: 	Checking that your have enough memory available to create the index 03/09/2025, 09:21:21
2025-03-09 09:21:21,184 [INFO]: 666.0MB of memory will be needed to build the index (more might be used if you have more)
2025-03-09 09:21:21,184 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0005 secs
2025-03-09 09:21:21,184 [INFO]: 	Selecting most promising index types given data characteristics 03/09/2025, 09:21:21
2025-03-09 09:21:21,184 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-09 09:21:21,184 [INFO]: 	Creating the index 03/09/2025, 09:21:21
2025-03-09 09:21:21,184 [INFO]: 		-> Instanciate the index HNSW15 03/09/2025, 09:21:21
2025-03-09 09:21:21,187 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0031 secs
2025-03-09 09:21:21,188 [INFO]: 		-> Adding the vectors to the index 03/09/2025, 09:21:21
2025-03-09 09:21:21,188 [INFO]: The memory available for adding the vectors is 49.4GB(total available - used by the index)
2025-03-09 09:21:21,188 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/13 [00:00<?, ?it/s]  8%|▊         | 1/13 [00:00<00:01,  6.16it/s] 23%|██▎       | 3/13 [00:00<00:01,  9.64it/s] 38%|███▊      | 5/13 [00:00<00:00, 10.66it/s] 54%|█████▍    | 7/13 [00:00<00:00, 11.39it/s] 69%|██████▉   | 9/13 [00:00<00:00, 11.83it/s] 85%|████████▍ | 11/13 [00:00<00:00, 11.95it/s]100%|██████████| 13/13 [00:03<00:00,  2.41it/s]100%|██████████| 13/13 [00:03<00:00,  4.15it/s]
2025-03-09 09:21:24,335 [INFO]: 	Computing best hyperparameters for index knn.index 03/09/2025, 09:21:24
2025-03-09 09:22:02,669 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 38.3335 secs
2025-03-09 09:22:02,669 [INFO]: The best hyperparameters are: efSearch=239
2025-03-09 09:22:02,669 [INFO]: 	Compute fast metrics 03/09/2025, 09:22:02
  0%|          | 0/4 [00:00<?, ?it/s] 25%|██▌       | 1/4 [00:00<00:00,  5.24it/s] 50%|█████     | 2/4 [00:00<00:00,  6.91it/s] 75%|███████▌  | 3/4 [00:00<00:00,  7.61it/s] 75%|███████▌  | 3/4 [00:00<00:00,  6.26it/s]
2025-03-09 09:22:22,161 [INFO]: 	>>> Finished "Compute fast metrics" in 19.4918 secs
2025-03-09 09:22:22,164 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 60.9755 secs
2025-03-09 09:22:22,164 [INFO]: {
2025-03-09 09:22:22,164 [INFO]: 	index_key: HNSW15
2025-03-09 09:22:22,164 [INFO]: 	index_param: efSearch=239
2025-03-09 09:22:22,164 [INFO]: 	index_path: knn.index
2025-03-09 09:22:22,164 [INFO]: 	size in bytes: 634892410
2025-03-09 09:22:22,164 [INFO]: 	avg_search_speed_ms: 9.06567372941494
2025-03-09 09:22:22,164 [INFO]: 	99p_search_speed_ms: 14.565357915125801
2025-03-09 09:22:22,164 [INFO]: 	reconstruction error %: 0.0
2025-03-09 09:22:22,164 [INFO]: 	nb vectors: 3227
2025-03-09 09:22:22,164 [INFO]: 	vectors dimension: 49152
2025-03-09 09:22:22,164 [INFO]: 	compression ratio: 0.999309498754285
2025-03-09 09:22:22,164 [INFO]: }
2025-03-09 09:22:22,164 [INFO]: 	>>> Finished "Creating the index" in 60.9797 secs
2025-03-09 09:22:22,164 [INFO]: >>> Finished "Launching the whole pipeline" in 61.0132 secs
2025-03-09 09:22:23: [retrieval_preprocessing] calculating distances ...
2025-03-09 09:22:23: [retrieval_preprocessing] finished and saved retrieval indices for episode 44084 [episode count 8/20]
[retrieval_preprocessing] for episode 71224 [episode count 9/20], we have num_retrieval=np.int64(3153) num_query=np.int64(249)
2025-03-09 09:22:25,112 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-09 09:22:25,507 [INFO]: Launching the whole pipeline 03/09/2025, 09:22:25
2025-03-09 09:22:25,507 [INFO]: Reading total number of vectors and dimension 03/09/2025, 09:22:25
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1552.87it/s]
2025-03-09 09:22:25,532 [INFO]: There are 3153 embeddings of dim 49152
2025-03-09 09:22:25,532 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0255 secs
2025-03-09 09:22:25,532 [INFO]: 	Compute estimated construction time of the index 03/09/2025, 09:22:25
2025-03-09 09:22:25,533 [INFO]: 		-> Train: 16.7 minutes
2025-03-09 09:22:25,533 [INFO]: 		-> Add: 1.7 seconds
2025-03-09 09:22:25,533 [INFO]: 		Total: 16.7 minutes
2025-03-09 09:22:25,533 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0002 secs
2025-03-09 09:22:25,533 [INFO]: 	Checking that your have enough memory available to create the index 03/09/2025, 09:22:25
2025-03-09 09:22:25,533 [INFO]: 650.7MB of memory will be needed to build the index (more might be used if you have more)
2025-03-09 09:22:25,533 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0002 secs
2025-03-09 09:22:25,533 [INFO]: 	Selecting most promising index types given data characteristics 03/09/2025, 09:22:25
2025-03-09 09:22:25,533 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-09 09:22:25,533 [INFO]: 	Creating the index 03/09/2025, 09:22:25
2025-03-09 09:22:25,533 [INFO]: 		-> Instanciate the index HNSW15 03/09/2025, 09:22:25
2025-03-09 09:22:25,535 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0018 secs
2025-03-09 09:22:25,535 [INFO]: 		-> Adding the vectors to the index 03/09/2025, 09:22:25
2025-03-09 09:22:25,535 [INFO]: The memory available for adding the vectors is 49.4GB(total available - used by the index)
2025-03-09 09:22:25,535 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/13 [00:00<?, ?it/s]  8%|▊         | 1/13 [00:00<00:02,  5.50it/s] 15%|█▌        | 2/13 [00:00<00:01,  7.35it/s] 23%|██▎       | 3/13 [00:00<00:01,  8.22it/s] 31%|███       | 4/13 [00:00<00:01,  8.71it/s] 46%|████▌     | 6/13 [00:00<00:00,  9.05it/s] 54%|█████▍    | 7/13 [00:00<00:00,  8.96it/s] 62%|██████▏   | 8/13 [00:00<00:00,  8.88it/s] 69%|██████▉   | 9/13 [00:01<00:00,  8.70it/s] 85%|████████▍ | 11/13 [00:01<00:00,  9.99it/s]100%|██████████| 13/13 [00:03<00:00,  1.85it/s]100%|██████████| 13/13 [00:03<00:00,  3.54it/s]
2025-03-09 09:22:29,213 [INFO]: 	Computing best hyperparameters for index knn.index 03/09/2025, 09:22:29
2025-03-09 09:23:08,193 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 38.9802 secs
2025-03-09 09:23:08,194 [INFO]: The best hyperparameters are: efSearch=256
2025-03-09 09:23:08,194 [INFO]: 	Compute fast metrics 03/09/2025, 09:23:08
  0%|          | 0/4 [00:00<?, ?it/s] 25%|██▌       | 1/4 [00:00<00:00,  5.68it/s] 50%|█████     | 2/4 [00:00<00:00,  7.09it/s] 75%|███████▌  | 3/4 [00:00<00:00,  7.77it/s] 75%|███████▌  | 3/4 [00:00<00:00,  5.87it/s]
2025-03-09 09:23:31,192 [INFO]: 	>>> Finished "Compute fast metrics" in 22.9981 secs
2025-03-09 09:23:31,194 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 65.6587 secs
2025-03-09 09:23:31,194 [INFO]: {
2025-03-09 09:23:31,194 [INFO]: 	index_key: HNSW15
2025-03-09 09:23:31,194 [INFO]: 	index_param: efSearch=256
2025-03-09 09:23:31,194 [INFO]: 	index_path: knn.index
2025-03-09 09:23:31,194 [INFO]: 	size in bytes: 620333290
2025-03-09 09:23:31,194 [INFO]: 	avg_search_speed_ms: 10.749999080133394
2025-03-09 09:23:31,194 [INFO]: 	99p_search_speed_ms: 19.381728977896277
2025-03-09 09:23:31,194 [INFO]: 	reconstruction error %: 0.0
2025-03-09 09:23:31,194 [INFO]: 	nb vectors: 3153
2025-03-09 09:23:31,194 [INFO]: 	vectors dimension: 49152
2025-03-09 09:23:31,194 [INFO]: 	compression ratio: 0.9993096195111502
2025-03-09 09:23:31,194 [INFO]: }
2025-03-09 09:23:31,194 [INFO]: 	>>> Finished "Creating the index" in 65.6612 secs
2025-03-09 09:23:31,194 [INFO]: >>> Finished "Launching the whole pipeline" in 65.6875 secs
2025-03-09 09:23:32: [retrieval_preprocessing] calculating distances ...
2025-03-09 09:23:33: [retrieval_preprocessing] finished and saved retrieval indices for episode 71224 [episode count 9/20]
[retrieval_preprocessing] for episode 32315 [episode count 10/20], we have num_retrieval=np.int64(3212) num_query=np.int64(190)
2025-03-09 09:23:34,347 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-09 09:23:34,757 [INFO]: Launching the whole pipeline 03/09/2025, 09:23:34
2025-03-09 09:23:34,757 [INFO]: Reading total number of vectors and dimension 03/09/2025, 09:23:34
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 2305.83it/s]
2025-03-09 09:23:34,788 [INFO]: There are 3212 embeddings of dim 49152
2025-03-09 09:23:34,788 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0309 secs
2025-03-09 09:23:34,788 [INFO]: 	Compute estimated construction time of the index 03/09/2025, 09:23:34
2025-03-09 09:23:34,788 [INFO]: 		-> Train: 16.7 minutes
2025-03-09 09:23:34,788 [INFO]: 		-> Add: 1.8 seconds
2025-03-09 09:23:34,788 [INFO]: 		Total: 16.7 minutes
2025-03-09 09:23:34,788 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0001 secs
2025-03-09 09:23:34,788 [INFO]: 	Checking that your have enough memory available to create the index 03/09/2025, 09:23:34
2025-03-09 09:23:34,788 [INFO]: 662.9MB of memory will be needed to build the index (more might be used if you have more)
2025-03-09 09:23:34,788 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0001 secs
2025-03-09 09:23:34,788 [INFO]: 	Selecting most promising index types given data characteristics 03/09/2025, 09:23:34
2025-03-09 09:23:34,788 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-09 09:23:34,788 [INFO]: 	Creating the index 03/09/2025, 09:23:34
2025-03-09 09:23:34,788 [INFO]: 		-> Instanciate the index HNSW15 03/09/2025, 09:23:34
2025-03-09 09:23:34,789 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0009 secs
2025-03-09 09:23:34,789 [INFO]: 		-> Adding the vectors to the index 03/09/2025, 09:23:34
2025-03-09 09:23:34,789 [INFO]: The memory available for adding the vectors is 49.4GB(total available - used by the index)
2025-03-09 09:23:34,789 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/13 [00:00<?, ?it/s]  8%|▊         | 1/13 [00:00<00:01,  6.20it/s] 15%|█▌        | 2/13 [00:00<00:01,  7.61it/s] 23%|██▎       | 3/13 [00:00<00:01,  8.24it/s] 31%|███       | 4/13 [00:00<00:01,  8.58it/s] 46%|████▌     | 6/13 [00:00<00:00,  9.23it/s] 54%|█████▍    | 7/13 [00:00<00:00,  9.41it/s] 62%|██████▏   | 8/13 [00:00<00:00,  9.21it/s] 69%|██████▉   | 9/13 [00:01<00:00,  9.08it/s] 77%|███████▋  | 10/13 [00:01<00:00,  9.00it/s] 85%|████████▍ | 11/13 [00:01<00:00,  8.76it/s] 92%|█████████▏| 12/13 [00:01<00:00,  8.74it/s]100%|██████████| 13/13 [00:03<00:00,  1.33it/s]100%|██████████| 13/13 [00:03<00:00,  3.58it/s]
2025-03-09 09:23:38,425 [INFO]: 	Computing best hyperparameters for index knn.index 03/09/2025, 09:23:38
2025-03-09 09:24:15,276 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 36.8510 secs
2025-03-09 09:24:15,276 [INFO]: The best hyperparameters are: efSearch=250
2025-03-09 09:24:15,276 [INFO]: 	Compute fast metrics 03/09/2025, 09:24:15
  0%|          | 0/4 [00:00<?, ?it/s] 25%|██▌       | 1/4 [00:00<00:00,  5.11it/s] 50%|█████     | 2/4 [00:00<00:00,  6.85it/s] 75%|███████▌  | 3/4 [00:00<00:00,  7.59it/s] 75%|███████▌  | 3/4 [00:00<00:00,  5.71it/s]
2025-03-09 09:24:30,200 [INFO]: 	>>> Finished "Compute fast metrics" in 14.9236 secs
2025-03-09 09:24:30,202 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 55.4126 secs
2025-03-09 09:24:30,202 [INFO]: {
2025-03-09 09:24:30,202 [INFO]: 	index_key: HNSW15
2025-03-09 09:24:30,202 [INFO]: 	index_param: efSearch=250
2025-03-09 09:24:30,202 [INFO]: 	index_path: knn.index
2025-03-09 09:24:30,202 [INFO]: 	size in bytes: 631941070
2025-03-09 09:24:30,202 [INFO]: 	avg_search_speed_ms: 10.242465674041267
2025-03-09 09:24:30,202 [INFO]: 	99p_search_speed_ms: 17.35278801061213
2025-03-09 09:24:30,202 [INFO]: 	reconstruction error %: 0.0
2025-03-09 09:24:30,202 [INFO]: 	nb vectors: 3212
2025-03-09 09:24:30,202 [INFO]: 	vectors dimension: 49152
2025-03-09 09:24:30,202 [INFO]: 	compression ratio: 0.9993097869078204
2025-03-09 09:24:30,202 [INFO]: }
2025-03-09 09:24:30,202 [INFO]: 	>>> Finished "Creating the index" in 55.4139 secs
2025-03-09 09:24:30,202 [INFO]: >>> Finished "Launching the whole pipeline" in 55.4455 secs
2025-03-09 09:24:31: [retrieval_preprocessing] calculating distances ...
2025-03-09 09:24:31: [retrieval_preprocessing] finished and saved retrieval indices for episode 32315 [episode count 10/20]
[retrieval_preprocessing] for episode 93249 [episode count 11/20], we have num_retrieval=np.int64(3238) num_query=np.int64(164)
2025-03-09 09:24:32,848 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-09 09:24:33,329 [INFO]: Launching the whole pipeline 03/09/2025, 09:24:33
2025-03-09 09:24:33,329 [INFO]: Reading total number of vectors and dimension 03/09/2025, 09:24:33
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1959.96it/s]
2025-03-09 09:24:33,356 [INFO]: There are 3238 embeddings of dim 49152
2025-03-09 09:24:33,356 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0264 secs
2025-03-09 09:24:33,356 [INFO]: 	Compute estimated construction time of the index 03/09/2025, 09:24:33
2025-03-09 09:24:33,356 [INFO]: 		-> Train: 16.7 minutes
2025-03-09 09:24:33,356 [INFO]: 		-> Add: 1.8 seconds
2025-03-09 09:24:33,356 [INFO]: 		Total: 16.7 minutes
2025-03-09 09:24:33,356 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0002 secs
2025-03-09 09:24:33,356 [INFO]: 	Checking that your have enough memory available to create the index 03/09/2025, 09:24:33
2025-03-09 09:24:33,356 [INFO]: 668.2MB of memory will be needed to build the index (more might be used if you have more)
2025-03-09 09:24:33,356 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0001 secs
2025-03-09 09:24:33,356 [INFO]: 	Selecting most promising index types given data characteristics 03/09/2025, 09:24:33
2025-03-09 09:24:33,356 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-09 09:24:33,356 [INFO]: 	Creating the index 03/09/2025, 09:24:33
2025-03-09 09:24:33,356 [INFO]: 		-> Instanciate the index HNSW15 03/09/2025, 09:24:33
2025-03-09 09:24:33,357 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0009 secs
2025-03-09 09:24:33,357 [INFO]: 		-> Adding the vectors to the index 03/09/2025, 09:24:33
2025-03-09 09:24:33,357 [INFO]: The memory available for adding the vectors is 49.4GB(total available - used by the index)
2025-03-09 09:24:33,357 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/13 [00:00<?, ?it/s]  8%|▊         | 1/13 [00:00<00:01,  6.55it/s] 23%|██▎       | 3/13 [00:00<00:00, 10.26it/s] 38%|███▊      | 5/13 [00:00<00:00, 11.52it/s] 54%|█████▍    | 7/13 [00:00<00:00, 11.95it/s] 69%|██████▉   | 9/13 [00:00<00:00, 12.10it/s] 85%|████████▍ | 11/13 [00:00<00:00, 12.37it/s]100%|██████████| 13/13 [00:03<00:00,  2.39it/s]100%|██████████| 13/13 [00:03<00:00,  4.15it/s]
2025-03-09 09:24:36,497 [INFO]: 	Computing best hyperparameters for index knn.index 03/09/2025, 09:24:36
2025-03-09 09:25:11,417 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 34.9199 secs
2025-03-09 09:25:11,417 [INFO]: The best hyperparameters are: efSearch=256
2025-03-09 09:25:11,417 [INFO]: 	Compute fast metrics 03/09/2025, 09:25:11
  0%|          | 0/4 [00:00<?, ?it/s] 25%|██▌       | 1/4 [00:00<00:00,  5.97it/s] 75%|███████▌  | 3/4 [00:00<00:00,  9.94it/s] 75%|███████▌  | 3/4 [00:00<00:00,  7.59it/s]
2025-03-09 09:25:25,633 [INFO]: 	>>> Finished "Compute fast metrics" in 14.2160 secs
2025-03-09 09:25:25,636 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 52.2785 secs
2025-03-09 09:25:25,636 [INFO]: {
2025-03-09 09:25:25,636 [INFO]: 	index_key: HNSW15
2025-03-09 09:25:25,636 [INFO]: 	index_param: efSearch=256
2025-03-09 09:25:25,636 [INFO]: 	index_path: knn.index
2025-03-09 09:25:25,636 [INFO]: 	size in bytes: 637056790
2025-03-09 09:25:25,636 [INFO]: 	avg_search_speed_ms: 10.23471304201192
2025-03-09 09:25:25,636 [INFO]: 	99p_search_speed_ms: 17.83585261553526
2025-03-09 09:25:25,636 [INFO]: 	reconstruction error %: 0.0
2025-03-09 09:25:25,636 [INFO]: 	nb vectors: 3238
2025-03-09 09:25:25,636 [INFO]: 	vectors dimension: 49152
2025-03-09 09:25:25,636 [INFO]: 	compression ratio: 0.9993091887459515
2025-03-09 09:25:25,636 [INFO]: }
2025-03-09 09:25:25,636 [INFO]: 	>>> Finished "Creating the index" in 52.2799 secs
2025-03-09 09:25:25,636 [INFO]: >>> Finished "Launching the whole pipeline" in 52.3069 secs
2025-03-09 09:25:26: [retrieval_preprocessing] calculating distances ...
2025-03-09 09:25:27: [retrieval_preprocessing] finished and saved retrieval indices for episode 93249 [episode count 11/20]
[retrieval_preprocessing] for episode 79426 [episode count 12/20], we have num_retrieval=np.int64(3231) num_query=np.int64(171)
2025-03-09 09:25:28,242 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-09 09:25:28,669 [INFO]: Launching the whole pipeline 03/09/2025, 09:25:28
2025-03-09 09:25:28,669 [INFO]: Reading total number of vectors and dimension 03/09/2025, 09:25:28
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1400.90it/s]
2025-03-09 09:25:28,694 [INFO]: There are 3231 embeddings of dim 49152
2025-03-09 09:25:28,694 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0255 secs
2025-03-09 09:25:28,695 [INFO]: 	Compute estimated construction time of the index 03/09/2025, 09:25:28
2025-03-09 09:25:28,695 [INFO]: 		-> Train: 16.7 minutes
2025-03-09 09:25:28,695 [INFO]: 		-> Add: 1.8 seconds
2025-03-09 09:25:28,695 [INFO]: 		Total: 16.7 minutes
2025-03-09 09:25:28,695 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0001 secs
2025-03-09 09:25:28,695 [INFO]: 	Checking that your have enough memory available to create the index 03/09/2025, 09:25:28
2025-03-09 09:25:28,695 [INFO]: 666.8MB of memory will be needed to build the index (more might be used if you have more)
2025-03-09 09:25:28,695 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0002 secs
2025-03-09 09:25:28,695 [INFO]: 	Selecting most promising index types given data characteristics 03/09/2025, 09:25:28
2025-03-09 09:25:28,695 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-09 09:25:28,695 [INFO]: 	Creating the index 03/09/2025, 09:25:28
2025-03-09 09:25:28,695 [INFO]: 		-> Instanciate the index HNSW15 03/09/2025, 09:25:28
2025-03-09 09:25:28,696 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0008 secs
2025-03-09 09:25:28,696 [INFO]: 		-> Adding the vectors to the index 03/09/2025, 09:25:28
2025-03-09 09:25:28,696 [INFO]: The memory available for adding the vectors is 49.4GB(total available - used by the index)
2025-03-09 09:25:28,696 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/13 [00:00<?, ?it/s]  8%|▊         | 1/13 [00:00<00:01,  6.38it/s] 23%|██▎       | 3/13 [00:00<00:00, 10.02it/s] 38%|███▊      | 5/13 [00:00<00:00, 11.31it/s] 54%|█████▍    | 7/13 [00:00<00:00, 12.14it/s] 69%|██████▉   | 9/13 [00:00<00:00, 12.30it/s] 85%|████████▍ | 11/13 [00:00<00:00, 12.43it/s]100%|██████████| 13/13 [00:03<00:00,  2.49it/s]100%|██████████| 13/13 [00:03<00:00,  4.29it/s]
2025-03-09 09:25:31,734 [INFO]: 	Computing best hyperparameters for index knn.index 03/09/2025, 09:25:31
2025-03-09 09:26:05,609 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 33.8737 secs
2025-03-09 09:26:05,609 [INFO]: The best hyperparameters are: efSearch=257
2025-03-09 09:26:05,609 [INFO]: 	Compute fast metrics 03/09/2025, 09:26:05
  0%|          | 0/4 [00:00<?, ?it/s] 25%|██▌       | 1/4 [00:00<00:00,  5.92it/s] 50%|█████     | 2/4 [00:00<00:00,  7.64it/s] 75%|███████▌  | 3/4 [00:00<00:00,  8.27it/s] 75%|███████▌  | 3/4 [00:00<00:00,  6.26it/s]
2025-03-09 09:26:23,109 [INFO]: 	>>> Finished "Compute fast metrics" in 17.4996 secs
2025-03-09 09:26:23,111 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 54.4149 secs
2025-03-09 09:26:23,111 [INFO]: {
2025-03-09 09:26:23,111 [INFO]: 	index_key: HNSW15
2025-03-09 09:26:23,111 [INFO]: 	index_param: efSearch=257
2025-03-09 09:26:23,111 [INFO]: 	index_path: knn.index
2025-03-09 09:26:23,111 [INFO]: 	size in bytes: 635679490
2025-03-09 09:26:23,111 [INFO]: 	avg_search_speed_ms: 10.846640482350958
2025-03-09 09:26:23,111 [INFO]: 	99p_search_speed_ms: 19.91555899614468
2025-03-09 09:26:23,111 [INFO]: 	reconstruction error %: 0.0
2025-03-09 09:26:23,111 [INFO]: 	nb vectors: 3231
2025-03-09 09:26:23,111 [INFO]: 	vectors dimension: 49152
2025-03-09 09:26:23,111 [INFO]: 	compression ratio: 0.9993093343313625
2025-03-09 09:26:23,111 [INFO]: }
2025-03-09 09:26:23,111 [INFO]: 	>>> Finished "Creating the index" in 54.4162 secs
2025-03-09 09:26:23,111 [INFO]: >>> Finished "Launching the whole pipeline" in 54.4423 secs
2025-03-09 09:26:24: [retrieval_preprocessing] calculating distances ...
2025-03-09 09:26:24: [retrieval_preprocessing] finished and saved retrieval indices for episode 79426 [episode count 12/20]
[retrieval_preprocessing] for episode 78917 [episode count 13/20], we have num_retrieval=np.int64(3230) num_query=np.int64(172)
2025-03-09 09:26:25,653 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-09 09:26:26,090 [INFO]: Launching the whole pipeline 03/09/2025, 09:26:26
2025-03-09 09:26:26,091 [INFO]: Reading total number of vectors and dimension 03/09/2025, 09:26:26
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1504.95it/s]
2025-03-09 09:26:26,115 [INFO]: There are 3230 embeddings of dim 49152
2025-03-09 09:26:26,115 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0247 secs
2025-03-09 09:26:26,115 [INFO]: 	Compute estimated construction time of the index 03/09/2025, 09:26:26
2025-03-09 09:26:26,115 [INFO]: 		-> Train: 16.7 minutes
2025-03-09 09:26:26,115 [INFO]: 		-> Add: 1.8 seconds
2025-03-09 09:26:26,115 [INFO]: 		Total: 16.7 minutes
2025-03-09 09:26:26,115 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0001 secs
2025-03-09 09:26:26,116 [INFO]: 	Checking that your have enough memory available to create the index 03/09/2025, 09:26:26
2025-03-09 09:26:26,116 [INFO]: 666.6MB of memory will be needed to build the index (more might be used if you have more)
2025-03-09 09:26:26,116 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0001 secs
2025-03-09 09:26:26,116 [INFO]: 	Selecting most promising index types given data characteristics 03/09/2025, 09:26:26
2025-03-09 09:26:26,116 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-09 09:26:26,116 [INFO]: 	Creating the index 03/09/2025, 09:26:26
2025-03-09 09:26:26,116 [INFO]: 		-> Instanciate the index HNSW15 03/09/2025, 09:26:26
2025-03-09 09:26:26,117 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0009 secs
2025-03-09 09:26:26,117 [INFO]: 		-> Adding the vectors to the index 03/09/2025, 09:26:26
2025-03-09 09:26:26,117 [INFO]: The memory available for adding the vectors is 49.4GB(total available - used by the index)
2025-03-09 09:26:26,117 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/13 [00:00<?, ?it/s]  8%|▊         | 1/13 [00:00<00:02,  5.53it/s] 15%|█▌        | 2/13 [00:00<00:01,  7.25it/s] 23%|██▎       | 3/13 [00:00<00:01,  7.91it/s] 31%|███       | 4/13 [00:00<00:01,  8.25it/s] 38%|███▊      | 5/13 [00:00<00:00,  8.44it/s] 46%|████▌     | 6/13 [00:00<00:00,  8.45it/s] 54%|█████▍    | 7/13 [00:00<00:00,  8.63it/s] 62%|██████▏   | 8/13 [00:00<00:00,  8.85it/s] 69%|██████▉   | 9/13 [00:01<00:00,  8.84it/s] 77%|███████▋  | 10/13 [00:01<00:00,  8.83it/s] 85%|████████▍ | 11/13 [00:01<00:00,  9.06it/s] 92%|█████████▏| 12/13 [00:01<00:00,  9.31it/s]100%|██████████| 13/13 [00:03<00:00,  1.19it/s]100%|██████████| 13/13 [00:03<00:00,  3.32it/s]
2025-03-09 09:26:30,042 [INFO]: 	Computing best hyperparameters for index knn.index 03/09/2025, 09:26:30
2025-03-09 09:27:10,720 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 40.6776 secs
2025-03-09 09:27:10,720 [INFO]: The best hyperparameters are: efSearch=222
2025-03-09 09:27:10,720 [INFO]: 	Compute fast metrics 03/09/2025, 09:27:10
  0%|          | 0/4 [00:00<?, ?it/s] 25%|██▌       | 1/4 [00:00<00:00,  5.84it/s] 75%|███████▌  | 3/4 [00:00<00:00,  9.01it/s] 75%|███████▌  | 3/4 [00:00<00:00,  7.10it/s]
2025-03-09 09:27:28,628 [INFO]: 	>>> Finished "Compute fast metrics" in 17.9084 secs
2025-03-09 09:27:28,631 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 62.5137 secs
2025-03-09 09:27:28,631 [INFO]: {
2025-03-09 09:27:28,631 [INFO]: 	index_key: HNSW15
2025-03-09 09:27:28,631 [INFO]: 	index_param: efSearch=222
2025-03-09 09:27:28,631 [INFO]: 	index_path: knn.index
2025-03-09 09:27:28,631 [INFO]: 	size in bytes: 635482750
2025-03-09 09:27:28,631 [INFO]: 	avg_search_speed_ms: 10.529596871990515
2025-03-09 09:27:28,631 [INFO]: 	99p_search_speed_ms: 18.57797407545149
2025-03-09 09:27:28,631 [INFO]: 	reconstruction error %: 0.0
2025-03-09 09:27:28,631 [INFO]: 	nb vectors: 3230
2025-03-09 09:27:28,631 [INFO]: 	vectors dimension: 49152
2025-03-09 09:27:28,631 [INFO]: 	compression ratio: 0.9993093282233074
2025-03-09 09:27:28,631 [INFO]: }
2025-03-09 09:27:28,631 [INFO]: 	>>> Finished "Creating the index" in 62.5151 secs
2025-03-09 09:27:28,631 [INFO]: >>> Finished "Launching the whole pipeline" in 62.5403 secs
2025-03-09 09:27:29: [retrieval_preprocessing] calculating distances ...
2025-03-09 09:27:29: [retrieval_preprocessing] finished and saved retrieval indices for episode 78917 [episode count 13/20]
[retrieval_preprocessing] for episode 60486 [episode count 14/20], we have num_retrieval=np.int64(3190) num_query=np.int64(212)
2025-03-09 09:27:30,641 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-09 09:27:31,077 [INFO]: Launching the whole pipeline 03/09/2025, 09:27:31
2025-03-09 09:27:31,077 [INFO]: Reading total number of vectors and dimension 03/09/2025, 09:27:31
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1489.98it/s]
2025-03-09 09:27:31,103 [INFO]: There are 3190 embeddings of dim 49152
2025-03-09 09:27:31,103 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0258 secs
2025-03-09 09:27:31,103 [INFO]: 	Compute estimated construction time of the index 03/09/2025, 09:27:31
2025-03-09 09:27:31,103 [INFO]: 		-> Train: 16.7 minutes
2025-03-09 09:27:31,103 [INFO]: 		-> Add: 1.8 seconds
2025-03-09 09:27:31,103 [INFO]: 		Total: 16.7 minutes
2025-03-09 09:27:31,103 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0001 secs
2025-03-09 09:27:31,103 [INFO]: 	Checking that your have enough memory available to create the index 03/09/2025, 09:27:31
2025-03-09 09:27:31,103 [INFO]: 658.3MB of memory will be needed to build the index (more might be used if you have more)
2025-03-09 09:27:31,103 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0001 secs
2025-03-09 09:27:31,103 [INFO]: 	Selecting most promising index types given data characteristics 03/09/2025, 09:27:31
2025-03-09 09:27:31,103 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-09 09:27:31,103 [INFO]: 	Creating the index 03/09/2025, 09:27:31
2025-03-09 09:27:31,104 [INFO]: 		-> Instanciate the index HNSW15 03/09/2025, 09:27:31
2025-03-09 09:27:31,105 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0010 secs
2025-03-09 09:27:31,105 [INFO]: 		-> Adding the vectors to the index 03/09/2025, 09:27:31
2025-03-09 09:27:31,105 [INFO]: The memory available for adding the vectors is 49.4GB(total available - used by the index)
2025-03-09 09:27:31,105 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/13 [00:00<?, ?it/s]  8%|▊         | 1/13 [00:00<00:01,  7.82it/s] 23%|██▎       | 3/13 [00:00<00:00, 11.99it/s] 38%|███▊      | 5/13 [00:00<00:00, 13.35it/s] 54%|█████▍    | 7/13 [00:00<00:00, 13.80it/s] 69%|██████▉   | 9/13 [00:00<00:00, 14.28it/s] 85%|████████▍ | 11/13 [00:00<00:00, 14.09it/s]100%|██████████| 13/13 [00:02<00:00,  2.45it/s]100%|██████████| 13/13 [00:02<00:00,  4.36it/s]
2025-03-09 09:27:34,091 [INFO]: 	Computing best hyperparameters for index knn.index 03/09/2025, 09:27:34
2025-03-09 09:28:06,519 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 32.4275 secs
2025-03-09 09:28:06,520 [INFO]: The best hyperparameters are: efSearch=308
2025-03-09 09:28:06,520 [INFO]: 	Compute fast metrics 03/09/2025, 09:28:06
  0%|          | 0/4 [00:00<?, ?it/s] 25%|██▌       | 1/4 [00:00<00:00,  5.32it/s] 50%|█████     | 2/4 [00:00<00:00,  6.85it/s] 75%|███████▌  | 3/4 [00:00<00:00,  7.46it/s] 75%|███████▌  | 3/4 [00:00<00:00,  5.57it/s]
2025-03-09 09:28:24,888 [INFO]: 	>>> Finished "Compute fast metrics" in 18.3686 secs
2025-03-09 09:28:24,891 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 53.7858 secs
2025-03-09 09:28:24,891 [INFO]: {
2025-03-09 09:28:24,891 [INFO]: 	index_key: HNSW15
2025-03-09 09:28:24,891 [INFO]: 	index_param: efSearch=308
2025-03-09 09:28:24,891 [INFO]: 	index_path: knn.index
2025-03-09 09:28:24,891 [INFO]: 	size in bytes: 627612730
2025-03-09 09:28:24,891 [INFO]: 	avg_search_speed_ms: 11.823822904450747
2025-03-09 09:28:24,891 [INFO]: 	99p_search_speed_ms: 20.039364565163844
2025-03-09 09:28:24,891 [INFO]: 	reconstruction error %: 0.0
2025-03-09 09:28:24,891 [INFO]: 	nb vectors: 3190
2025-03-09 09:28:24,891 [INFO]: 	vectors dimension: 49152
2025-03-09 09:28:24,891 [INFO]: 	compression ratio: 0.9993097495010976
2025-03-09 09:28:24,891 [INFO]: }
2025-03-09 09:28:24,891 [INFO]: 	>>> Finished "Creating the index" in 53.7874 secs
2025-03-09 09:28:24,891 [INFO]: >>> Finished "Launching the whole pipeline" in 53.8138 secs
2025-03-09 09:28:26: [retrieval_preprocessing] calculating distances ...
2025-03-09 09:28:27: [retrieval_preprocessing] finished and saved retrieval indices for episode 60486 [episode count 14/20]
[retrieval_preprocessing] for episode 4686 [episode count 15/20], we have num_retrieval=np.int64(3254) num_query=np.int64(148)
2025-03-09 09:28:28,008 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-09 09:28:28,402 [INFO]: Launching the whole pipeline 03/09/2025, 09:28:28
2025-03-09 09:28:28,402 [INFO]: Reading total number of vectors and dimension 03/09/2025, 09:28:28
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 2241.74it/s]
2025-03-09 09:28:28,426 [INFO]: There are 3254 embeddings of dim 49152
2025-03-09 09:28:28,427 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0241 secs
2025-03-09 09:28:28,427 [INFO]: 	Compute estimated construction time of the index 03/09/2025, 09:28:28
2025-03-09 09:28:28,427 [INFO]: 		-> Train: 16.7 minutes
2025-03-09 09:28:28,427 [INFO]: 		-> Add: 1.8 seconds
2025-03-09 09:28:28,427 [INFO]: 		Total: 16.7 minutes
2025-03-09 09:28:28,427 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0002 secs
2025-03-09 09:28:28,427 [INFO]: 	Checking that your have enough memory available to create the index 03/09/2025, 09:28:28
2025-03-09 09:28:28,427 [INFO]: 671.5MB of memory will be needed to build the index (more might be used if you have more)
2025-03-09 09:28:28,427 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0001 secs
2025-03-09 09:28:28,427 [INFO]: 	Selecting most promising index types given data characteristics 03/09/2025, 09:28:28
2025-03-09 09:28:28,427 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-09 09:28:28,427 [INFO]: 	Creating the index 03/09/2025, 09:28:28
2025-03-09 09:28:28,427 [INFO]: 		-> Instanciate the index HNSW15 03/09/2025, 09:28:28
2025-03-09 09:28:28,428 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0008 secs
2025-03-09 09:28:28,428 [INFO]: 		-> Adding the vectors to the index 03/09/2025, 09:28:28
2025-03-09 09:28:28,428 [INFO]: The memory available for adding the vectors is 49.4GB(total available - used by the index)
2025-03-09 09:28:28,428 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/13 [00:00<?, ?it/s]  8%|▊         | 1/13 [00:00<00:02,  5.64it/s] 15%|█▌        | 2/13 [00:00<00:01,  7.30it/s] 23%|██▎       | 3/13 [00:00<00:01,  7.98it/s] 31%|███       | 4/13 [00:00<00:01,  8.34it/s] 38%|███▊      | 5/13 [00:00<00:00,  8.69it/s] 46%|████▌     | 6/13 [00:00<00:00,  8.75it/s] 54%|█████▍    | 7/13 [00:00<00:00,  8.75it/s] 62%|██████▏   | 8/13 [00:00<00:00,  8.69it/s] 69%|██████▉   | 9/13 [00:01<00:00,  8.62it/s] 77%|███████▋  | 10/13 [00:01<00:00,  8.53it/s] 85%|████████▍ | 11/13 [00:01<00:00,  8.55it/s] 92%|█████████▏| 12/13 [00:01<00:00,  8.47it/s]100%|██████████| 13/13 [00:03<00:00,  1.24it/s]100%|██████████| 13/13 [00:03<00:00,  3.39it/s]
2025-03-09 09:28:32,266 [INFO]: 	Computing best hyperparameters for index knn.index 03/09/2025, 09:28:32
2025-03-09 09:29:08,768 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 36.5014 secs
2025-03-09 09:29:08,768 [INFO]: The best hyperparameters are: efSearch=238
2025-03-09 09:29:08,768 [INFO]: 	Compute fast metrics 03/09/2025, 09:29:08
  0%|          | 0/4 [00:00<?, ?it/s] 25%|██▌       | 1/4 [00:00<00:00,  5.46it/s] 50%|█████     | 2/4 [00:00<00:00,  7.32it/s] 75%|███████▌  | 3/4 [00:00<00:00,  8.15it/s] 75%|███████▌  | 3/4 [00:00<00:00,  6.09it/s]
2025-03-09 09:29:31,341 [INFO]: 	>>> Finished "Compute fast metrics" in 22.5732 secs
2025-03-09 09:29:31,343 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 62.9154 secs
2025-03-09 09:29:31,344 [INFO]: {
2025-03-09 09:29:31,344 [INFO]: 	index_key: HNSW15
2025-03-09 09:29:31,344 [INFO]: 	index_param: efSearch=238
2025-03-09 09:29:31,344 [INFO]: 	index_path: knn.index
2025-03-09 09:29:31,344 [INFO]: 	size in bytes: 640204690
2025-03-09 09:29:31,344 [INFO]: 	avg_search_speed_ms: 9.408358300520021
2025-03-09 09:29:31,344 [INFO]: 	99p_search_speed_ms: 12.854762631468473
2025-03-09 09:29:31,344 [INFO]: 	reconstruction error %: 0.0
2025-03-09 09:29:31,344 [INFO]: 	nb vectors: 3254
2025-03-09 09:29:31,344 [INFO]: 	vectors dimension: 49152
2025-03-09 09:29:31,344 [INFO]: 	compression ratio: 0.9993091928145669
2025-03-09 09:29:31,344 [INFO]: }
2025-03-09 09:29:31,344 [INFO]: 	>>> Finished "Creating the index" in 62.9166 secs
2025-03-09 09:29:31,344 [INFO]: >>> Finished "Launching the whole pipeline" in 62.9414 secs
2025-03-09 09:29:32: [retrieval_preprocessing] calculating distances ...
2025-03-09 09:29:33: [retrieval_preprocessing] finished and saved retrieval indices for episode 4686 [episode count 15/20]
[retrieval_preprocessing] for episode 5713 [episode count 16/20], we have num_retrieval=np.int64(3290) num_query=np.int64(112)
2025-03-09 09:29:34,169 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-09 09:29:34,667 [INFO]: Launching the whole pipeline 03/09/2025, 09:29:34
2025-03-09 09:29:34,667 [INFO]: Reading total number of vectors and dimension 03/09/2025, 09:29:34
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1956.30it/s]
2025-03-09 09:29:34,691 [INFO]: There are 3290 embeddings of dim 49152
2025-03-09 09:29:34,691 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0240 secs
2025-03-09 09:29:34,691 [INFO]: 	Compute estimated construction time of the index 03/09/2025, 09:29:34
2025-03-09 09:29:34,691 [INFO]: 		-> Train: 16.7 minutes
2025-03-09 09:29:34,692 [INFO]: 		-> Add: 1.8 seconds
2025-03-09 09:29:34,692 [INFO]: 		Total: 16.7 minutes
2025-03-09 09:29:34,692 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0001 secs
2025-03-09 09:29:34,692 [INFO]: 	Checking that your have enough memory available to create the index 03/09/2025, 09:29:34
2025-03-09 09:29:34,692 [INFO]: 679.0MB of memory will be needed to build the index (more might be used if you have more)
2025-03-09 09:29:34,692 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0001 secs
2025-03-09 09:29:34,692 [INFO]: 	Selecting most promising index types given data characteristics 03/09/2025, 09:29:34
2025-03-09 09:29:34,692 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-09 09:29:34,692 [INFO]: 	Creating the index 03/09/2025, 09:29:34
2025-03-09 09:29:34,692 [INFO]: 		-> Instanciate the index HNSW15 03/09/2025, 09:29:34
2025-03-09 09:29:34,693 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0011 secs
2025-03-09 09:29:34,693 [INFO]: 		-> Adding the vectors to the index 03/09/2025, 09:29:34
2025-03-09 09:29:34,693 [INFO]: The memory available for adding the vectors is 49.4GB(total available - used by the index)
2025-03-09 09:29:34,693 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/13 [00:00<?, ?it/s]  8%|▊         | 1/13 [00:00<00:01,  6.30it/s] 23%|██▎       | 3/13 [00:00<00:01,  9.57it/s] 38%|███▊      | 5/13 [00:00<00:00, 10.49it/s] 54%|█████▍    | 7/13 [00:00<00:00, 10.95it/s] 69%|██████▉   | 9/13 [00:00<00:00, 11.11it/s] 85%|████████▍ | 11/13 [00:01<00:00, 11.06it/s]100%|██████████| 13/13 [00:03<00:00,  2.34it/s]100%|██████████| 13/13 [00:03<00:00,  4.01it/s]
2025-03-09 09:29:37,943 [INFO]: 	Computing best hyperparameters for index knn.index 03/09/2025, 09:29:37
2025-03-09 09:30:16,759 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 38.8156 secs
2025-03-09 09:30:16,759 [INFO]: The best hyperparameters are: efSearch=204
2025-03-09 09:30:16,759 [INFO]: 	Compute fast metrics 03/09/2025, 09:30:16
  0%|          | 0/4 [00:00<?, ?it/s] 25%|██▌       | 1/4 [00:00<00:00,  5.82it/s] 50%|█████     | 2/4 [00:00<00:00,  7.32it/s] 75%|███████▌  | 3/4 [00:00<00:00,  7.85it/s] 75%|███████▌  | 3/4 [00:00<00:00,  5.90it/s]
2025-03-09 09:30:34,807 [INFO]: 	>>> Finished "Compute fast metrics" in 18.0477 secs
2025-03-09 09:30:34,810 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 60.1163 secs
2025-03-09 09:30:34,810 [INFO]: {
2025-03-09 09:30:34,810 [INFO]: 	index_key: HNSW15
2025-03-09 09:30:34,810 [INFO]: 	index_param: efSearch=204
2025-03-09 09:30:34,810 [INFO]: 	index_path: knn.index
2025-03-09 09:30:34,810 [INFO]: 	size in bytes: 647287570
2025-03-09 09:30:34,810 [INFO]: 	avg_search_speed_ms: 9.131600561479456
2025-03-09 09:30:34,810 [INFO]: 	99p_search_speed_ms: 16.610221154987805
2025-03-09 09:30:34,810 [INFO]: 	reconstruction error %: 0.0
2025-03-09 09:30:34,810 [INFO]: 	nb vectors: 3290
2025-03-09 09:30:34,810 [INFO]: 	vectors dimension: 49152
2025-03-09 09:30:34,810 [INFO]: 	compression ratio: 0.9993090397209389
2025-03-09 09:30:34,810 [INFO]: }
2025-03-09 09:30:34,810 [INFO]: 	>>> Finished "Creating the index" in 60.1179 secs
2025-03-09 09:30:34,810 [INFO]: >>> Finished "Launching the whole pipeline" in 60.1425 secs
2025-03-09 09:30:35: [retrieval_preprocessing] calculating distances ...
2025-03-09 09:30:35: [retrieval_preprocessing] finished and saved retrieval indices for episode 5713 [episode count 16/20]
[retrieval_preprocessing] for episode 9814 [episode count 17/20], we have num_retrieval=np.int64(3238) num_query=np.int64(164)
2025-03-09 09:30:36,529 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-09 09:30:36,970 [INFO]: Launching the whole pipeline 03/09/2025, 09:30:36
2025-03-09 09:30:36,970 [INFO]: Reading total number of vectors and dimension 03/09/2025, 09:30:36
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 2080.51it/s]
2025-03-09 09:30:36,996 [INFO]: There are 3238 embeddings of dim 49152
2025-03-09 09:30:36,996 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0256 secs
2025-03-09 09:30:36,996 [INFO]: 	Compute estimated construction time of the index 03/09/2025, 09:30:36
2025-03-09 09:30:36,996 [INFO]: 		-> Train: 16.7 minutes
2025-03-09 09:30:36,996 [INFO]: 		-> Add: 1.8 seconds
2025-03-09 09:30:36,996 [INFO]: 		Total: 16.7 minutes
2025-03-09 09:30:36,996 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0002 secs
2025-03-09 09:30:36,996 [INFO]: 	Checking that your have enough memory available to create the index 03/09/2025, 09:30:36
2025-03-09 09:30:36,996 [INFO]: 668.2MB of memory will be needed to build the index (more might be used if you have more)
2025-03-09 09:30:36,996 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0001 secs
2025-03-09 09:30:36,997 [INFO]: 	Selecting most promising index types given data characteristics 03/09/2025, 09:30:36
2025-03-09 09:30:36,997 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-09 09:30:36,997 [INFO]: 	Creating the index 03/09/2025, 09:30:36
2025-03-09 09:30:36,997 [INFO]: 		-> Instanciate the index HNSW15 03/09/2025, 09:30:36
2025-03-09 09:30:36,998 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0011 secs
2025-03-09 09:30:36,998 [INFO]: 		-> Adding the vectors to the index 03/09/2025, 09:30:36
2025-03-09 09:30:36,998 [INFO]: The memory available for adding the vectors is 49.4GB(total available - used by the index)
2025-03-09 09:30:36,998 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/13 [00:00<?, ?it/s]  8%|▊         | 1/13 [00:00<00:02,  5.37it/s] 15%|█▌        | 2/13 [00:00<00:01,  6.90it/s] 23%|██▎       | 3/13 [00:00<00:01,  7.75it/s] 31%|███       | 4/13 [00:00<00:01,  8.08it/s] 38%|███▊      | 5/13 [00:00<00:00,  8.21it/s] 46%|████▌     | 6/13 [00:00<00:00,  8.36it/s] 54%|█████▍    | 7/13 [00:00<00:00,  8.45it/s] 62%|██████▏   | 8/13 [00:00<00:00,  8.61it/s] 69%|██████▉   | 9/13 [00:01<00:00,  8.60it/s] 77%|███████▋  | 10/13 [00:01<00:00,  8.51it/s] 85%|████████▍ | 11/13 [00:01<00:00,  8.48it/s] 92%|█████████▏| 12/13 [00:01<00:00,  8.39it/s]100%|██████████| 13/13 [00:03<00:00,  1.30it/s]100%|██████████| 13/13 [00:03<00:00,  3.48it/s]
2025-03-09 09:30:40,737 [INFO]: 	Computing best hyperparameters for index knn.index 03/09/2025, 09:30:40
2025-03-09 09:31:17,833 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 37.0958 secs
2025-03-09 09:31:17,833 [INFO]: The best hyperparameters are: efSearch=254
2025-03-09 09:31:17,833 [INFO]: 	Compute fast metrics 03/09/2025, 09:31:17
  0%|          | 0/4 [00:00<?, ?it/s] 25%|██▌       | 1/4 [00:00<00:00,  5.68it/s] 75%|███████▌  | 3/4 [00:00<00:00,  9.50it/s] 75%|███████▌  | 3/4 [00:00<00:00,  7.22it/s]
2025-03-09 09:31:32,800 [INFO]: 	>>> Finished "Compute fast metrics" in 14.9665 secs
2025-03-09 09:31:32,802 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 55.8040 secs
2025-03-09 09:31:32,802 [INFO]: {
2025-03-09 09:31:32,802 [INFO]: 	index_key: HNSW15
2025-03-09 09:31:32,802 [INFO]: 	index_param: efSearch=254
2025-03-09 09:31:32,802 [INFO]: 	index_path: knn.index
2025-03-09 09:31:32,802 [INFO]: 	size in bytes: 637056790
2025-03-09 09:31:32,802 [INFO]: 	avg_search_speed_ms: 9.614668527501635
2025-03-09 09:31:32,802 [INFO]: 	99p_search_speed_ms: 15.716704861260926
2025-03-09 09:31:32,802 [INFO]: 	reconstruction error %: 0.0
2025-03-09 09:31:32,802 [INFO]: 	nb vectors: 3238
2025-03-09 09:31:32,802 [INFO]: 	vectors dimension: 49152
2025-03-09 09:31:32,802 [INFO]: 	compression ratio: 0.9993091887459515
2025-03-09 09:31:32,802 [INFO]: }
2025-03-09 09:31:32,802 [INFO]: 	>>> Finished "Creating the index" in 55.8055 secs
2025-03-09 09:31:32,802 [INFO]: >>> Finished "Launching the whole pipeline" in 55.8318 secs
2025-03-09 09:31:33: [retrieval_preprocessing] calculating distances ...
2025-03-09 09:31:34: [retrieval_preprocessing] finished and saved retrieval indices for episode 9814 [episode count 17/20]
[retrieval_preprocessing] for episode 40023 [episode count 18/20], we have num_retrieval=np.int64(3209) num_query=np.int64(193)
2025-03-09 09:31:35,287 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-09 09:31:35,926 [INFO]: Launching the whole pipeline 03/09/2025, 09:31:35
2025-03-09 09:31:35,926 [INFO]: Reading total number of vectors and dimension 03/09/2025, 09:31:35
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1787.85it/s]
2025-03-09 09:31:35,960 [INFO]: There are 3209 embeddings of dim 49152
2025-03-09 09:31:35,960 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0335 secs
2025-03-09 09:31:35,960 [INFO]: 	Compute estimated construction time of the index 03/09/2025, 09:31:35
2025-03-09 09:31:35,960 [INFO]: 		-> Train: 16.7 minutes
2025-03-09 09:31:35,960 [INFO]: 		-> Add: 1.8 seconds
2025-03-09 09:31:35,960 [INFO]: 		Total: 16.7 minutes
2025-03-09 09:31:35,960 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0001 secs
2025-03-09 09:31:35,960 [INFO]: 	Checking that your have enough memory available to create the index 03/09/2025, 09:31:35
2025-03-09 09:31:35,960 [INFO]: 662.3MB of memory will be needed to build the index (more might be used if you have more)
2025-03-09 09:31:35,960 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0002 secs
2025-03-09 09:31:35,960 [INFO]: 	Selecting most promising index types given data characteristics 03/09/2025, 09:31:35
2025-03-09 09:31:35,960 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-09 09:31:35,960 [INFO]: 	Creating the index 03/09/2025, 09:31:35
2025-03-09 09:31:35,961 [INFO]: 		-> Instanciate the index HNSW15 03/09/2025, 09:31:35
2025-03-09 09:31:35,962 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0012 secs
2025-03-09 09:31:35,962 [INFO]: 		-> Adding the vectors to the index 03/09/2025, 09:31:35
2025-03-09 09:31:35,962 [INFO]: The memory available for adding the vectors is 49.4GB(total available - used by the index)
2025-03-09 09:31:35,962 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/13 [00:00<?, ?it/s]  8%|▊         | 1/13 [00:00<00:01,  7.94it/s] 46%|████▌     | 6/13 [00:00<00:00, 28.79it/s] 85%|████████▍ | 11/13 [00:00<00:00, 37.14it/s]100%|██████████| 13/13 [00:02<00:00,  4.58it/s]
2025-03-09 09:31:38,803 [INFO]: 	Computing best hyperparameters for index knn.index 03/09/2025, 09:31:38
2025-03-09 09:32:18,500 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 39.6961 secs
2025-03-09 09:32:18,500 [INFO]: The best hyperparameters are: efSearch=169
2025-03-09 09:32:18,500 [INFO]: 	Compute fast metrics 03/09/2025, 09:32:18
  0%|          | 0/4 [00:00<?, ?it/s] 25%|██▌       | 1/4 [00:00<00:00,  5.62it/s] 50%|█████     | 2/4 [00:00<00:00,  7.35it/s] 75%|███████▌  | 3/4 [00:00<00:00,  7.97it/s] 75%|███████▌  | 3/4 [00:00<00:00,  5.99it/s]
2025-03-09 09:32:36,513 [INFO]: 	>>> Finished "Compute fast metrics" in 18.0128 secs
2025-03-09 09:32:36,516 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 60.5537 secs
2025-03-09 09:32:36,516 [INFO]: {
2025-03-09 09:32:36,516 [INFO]: 	index_key: HNSW15
2025-03-09 09:32:36,516 [INFO]: 	index_param: efSearch=169
2025-03-09 09:32:36,516 [INFO]: 	index_path: knn.index
2025-03-09 09:32:36,516 [INFO]: 	size in bytes: 631350850
2025-03-09 09:32:36,516 [INFO]: 	avg_search_speed_ms: 8.962497167083965
2025-03-09 09:32:36,516 [INFO]: 	99p_search_speed_ms: 15.906368265859767
2025-03-09 09:32:36,516 [INFO]: 	reconstruction error %: 0.0
2025-03-09 09:32:36,516 [INFO]: 	nb vectors: 3209
2025-03-09 09:32:36,516 [INFO]: 	vectors dimension: 49152
2025-03-09 09:32:36,516 [INFO]: 	compression ratio: 0.9993097688868242
2025-03-09 09:32:36,516 [INFO]: }
2025-03-09 09:32:36,516 [INFO]: 	>>> Finished "Creating the index" in 60.5555 secs
2025-03-09 09:32:36,516 [INFO]: >>> Finished "Launching the whole pipeline" in 60.5897 secs
2025-03-09 09:32:37: [retrieval_preprocessing] calculating distances ...
2025-03-09 09:32:37: [retrieval_preprocessing] finished and saved retrieval indices for episode 40023 [episode count 18/20]
[retrieval_preprocessing] for episode 78428 [episode count 19/20], we have num_retrieval=np.int64(3258) num_query=np.int64(144)
2025-03-09 09:32:38,793 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-09 09:32:39,235 [INFO]: Launching the whole pipeline 03/09/2025, 09:32:39
2025-03-09 09:32:39,235 [INFO]: Reading total number of vectors and dimension 03/09/2025, 09:32:39
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1337.04it/s]
2025-03-09 09:32:39,262 [INFO]: There are 3258 embeddings of dim 49152
2025-03-09 09:32:39,262 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0273 secs
2025-03-09 09:32:39,262 [INFO]: 	Compute estimated construction time of the index 03/09/2025, 09:32:39
2025-03-09 09:32:39,262 [INFO]: 		-> Train: 16.7 minutes
2025-03-09 09:32:39,262 [INFO]: 		-> Add: 1.8 seconds
2025-03-09 09:32:39,262 [INFO]: 		Total: 16.7 minutes
2025-03-09 09:32:39,263 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0001 secs
2025-03-09 09:32:39,263 [INFO]: 	Checking that your have enough memory available to create the index 03/09/2025, 09:32:39
2025-03-09 09:32:39,263 [INFO]: 672.4MB of memory will be needed to build the index (more might be used if you have more)
2025-03-09 09:32:39,263 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0002 secs
2025-03-09 09:32:39,263 [INFO]: 	Selecting most promising index types given data characteristics 03/09/2025, 09:32:39
2025-03-09 09:32:39,263 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-09 09:32:39,263 [INFO]: 	Creating the index 03/09/2025, 09:32:39
2025-03-09 09:32:39,263 [INFO]: 		-> Instanciate the index HNSW15 03/09/2025, 09:32:39
2025-03-09 09:32:39,264 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0011 secs
2025-03-09 09:32:39,264 [INFO]: 		-> Adding the vectors to the index 03/09/2025, 09:32:39
2025-03-09 09:32:39,264 [INFO]: The memory available for adding the vectors is 49.4GB(total available - used by the index)
2025-03-09 09:32:39,264 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/13 [00:00<?, ?it/s]  8%|▊         | 1/13 [00:00<00:01,  7.58it/s] 38%|███▊      | 5/13 [00:00<00:00, 23.12it/s] 69%|██████▉   | 9/13 [00:00<00:00, 28.98it/s] 92%|█████████▏| 12/13 [00:00<00:00, 25.62it/s]100%|██████████| 13/13 [00:02<00:00,  4.50it/s]
2025-03-09 09:32:42,161 [INFO]: 	Computing best hyperparameters for index knn.index 03/09/2025, 09:32:42
2025-03-09 09:33:19,382 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 37.2205 secs
2025-03-09 09:33:19,382 [INFO]: The best hyperparameters are: efSearch=167
2025-03-09 09:33:19,382 [INFO]: 	Compute fast metrics 03/09/2025, 09:33:19
  0%|          | 0/4 [00:00<?, ?it/s] 50%|█████     | 2/4 [00:00<00:00, 16.48it/s] 75%|███████▌  | 3/4 [00:00<00:00, 18.10it/s]
2025-03-09 09:33:36,279 [INFO]: 	>>> Finished "Compute fast metrics" in 16.8968 secs
2025-03-09 09:33:36,281 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 57.0171 secs
2025-03-09 09:33:36,282 [INFO]: {
2025-03-09 09:33:36,282 [INFO]: 	index_key: HNSW15
2025-03-09 09:33:36,282 [INFO]: 	index_param: efSearch=167
2025-03-09 09:33:36,282 [INFO]: 	index_path: knn.index
2025-03-09 09:33:36,282 [INFO]: 	size in bytes: 640991710
2025-03-09 09:33:36,282 [INFO]: 	avg_search_speed_ms: 8.588744235613873
2025-03-09 09:33:36,282 [INFO]: 	99p_search_speed_ms: 12.943633431568662
2025-03-09 09:33:36,282 [INFO]: 	reconstruction error %: 0.0
2025-03-09 09:33:36,282 [INFO]: 	nb vectors: 3258
2025-03-09 09:33:36,282 [INFO]: 	vectors dimension: 49152
2025-03-09 09:33:36,282 [INFO]: 	compression ratio: 0.9993091236702578
2025-03-09 09:33:36,282 [INFO]: }
2025-03-09 09:33:36,282 [INFO]: 	>>> Finished "Creating the index" in 57.0187 secs
2025-03-09 09:33:36,282 [INFO]: >>> Finished "Launching the whole pipeline" in 57.0469 secs
2025-03-09 09:33:36: [retrieval_preprocessing] calculating distances ...
2025-03-09 09:33:37: [retrieval_preprocessing] finished and saved retrieval indices for episode 78428 [episode count 19/20]
2025-03-09 09:33:37: [retrieval_preprocessing] finished for (3854327802, 'bottle') [chosen_id count 6/10]
2025-03-09 09:33:39: [retrieval_preprocessing] concatenated all embeddings and indices for 20 episodes for (3951366978, 'lid') [chosen_id count 7/10]
2025-03-09 09:33:39: [retrieval_preprocessing] we have num_total=5638 embedding_dim=49152
[retrieval_preprocessing] for episode 87939 [episode count 0/20], we have num_retrieval=np.int64(5383) num_query=np.int64(255)
2025-03-09 09:33:39,876 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-09 09:33:40,751 [INFO]: Launching the whole pipeline 03/09/2025, 09:33:40
2025-03-09 09:33:40,751 [INFO]: Reading total number of vectors and dimension 03/09/2025, 09:33:40
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 681.67it/s]
2025-03-09 09:33:40,789 [INFO]: There are 5383 embeddings of dim 49152
2025-03-09 09:33:40,789 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0379 secs
2025-03-09 09:33:40,790 [INFO]: 	Compute estimated construction time of the index 03/09/2025, 09:33:40
2025-03-09 09:33:40,790 [INFO]: 		-> Train: 16.7 minutes
2025-03-09 09:33:40,790 [INFO]: 		-> Add: 3.0 seconds
2025-03-09 09:33:40,790 [INFO]: 		Total: 16.7 minutes
2025-03-09 09:33:40,790 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0003 secs
2025-03-09 09:33:40,790 [INFO]: 	Checking that your have enough memory available to create the index 03/09/2025, 09:33:40
2025-03-09 09:33:40,791 [INFO]: 1.1GB of memory will be needed to build the index (more might be used if you have more)
2025-03-09 09:33:40,791 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0006 secs
2025-03-09 09:33:40,791 [INFO]: 	Selecting most promising index types given data characteristics 03/09/2025, 09:33:40
2025-03-09 09:33:40,791 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-09 09:33:40,791 [INFO]: 	Creating the index 03/09/2025, 09:33:40
2025-03-09 09:33:40,792 [INFO]: 		-> Instanciate the index HNSW15 03/09/2025, 09:33:40
2025-03-09 09:33:40,794 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0023 secs
2025-03-09 09:33:40,794 [INFO]: 		-> Adding the vectors to the index 03/09/2025, 09:33:40
2025-03-09 09:33:40,794 [INFO]: The memory available for adding the vectors is 49.0GB(total available - used by the index)
2025-03-09 09:33:40,795 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/23 [00:00<?, ?it/s]  4%|▍         | 1/23 [00:00<00:04,  5.27it/s] 13%|█▎        | 3/23 [00:00<00:01, 10.99it/s] 22%|██▏       | 5/23 [00:00<00:01, 14.28it/s] 30%|███       | 7/23 [00:00<00:01, 14.79it/s] 39%|███▉      | 9/23 [00:00<00:00, 14.59it/s] 48%|████▊     | 11/23 [00:00<00:00, 13.30it/s] 57%|█████▋    | 13/23 [00:01<00:00, 12.89it/s] 65%|██████▌   | 15/23 [00:01<00:00, 12.05it/s] 74%|███████▍  | 17/23 [00:01<00:00, 10.89it/s] 83%|████████▎ | 19/23 [00:01<00:00, 10.28it/s] 91%|█████████▏| 21/23 [00:05<00:01,  1.45it/s]100%|██████████| 23/23 [00:06<00:00,  1.57it/s]100%|██████████| 23/23 [00:06<00:00,  3.42it/s]
2025-03-09 09:33:47,517 [INFO]: 	Computing best hyperparameters for index knn.index 03/09/2025, 09:33:47
2025-03-09 09:34:30,580 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 43.0629 secs
2025-03-09 09:34:30,581 [INFO]: The best hyperparameters are: efSearch=217
2025-03-09 09:34:30,581 [INFO]: 	Compute fast metrics 03/09/2025, 09:34:30
  0%|          | 0/4 [00:00<?, ?it/s] 25%|██▌       | 1/4 [00:00<00:00,  8.57it/s] 75%|███████▌  | 3/4 [00:00<00:00, 11.14it/s]
2025-03-09 09:34:48,973 [INFO]: 	>>> Finished "Compute fast metrics" in 18.3920 secs
2025-03-09 09:34:48,974 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 68.1801 secs
2025-03-09 09:34:48,975 [INFO]: {
2025-03-09 09:34:48,975 [INFO]: 	index_key: HNSW15
2025-03-09 09:34:48,975 [INFO]: 	index_param: efSearch=217
2025-03-09 09:34:48,975 [INFO]: 	index_path: knn.index
2025-03-09 09:34:48,975 [INFO]: 	size in bytes: 1059073750
2025-03-09 09:34:48,975 [INFO]: 	avg_search_speed_ms: 10.09901715324947
2025-03-09 09:34:48,975 [INFO]: 	99p_search_speed_ms: 17.546950369141996
2025-03-09 09:34:48,975 [INFO]: 	reconstruction error %: 0.0
2025-03-09 09:34:48,975 [INFO]: 	nb vectors: 5383
2025-03-09 09:34:48,975 [INFO]: 	vectors dimension: 49152
2025-03-09 09:34:48,975 [INFO]: 	compression ratio: 0.9993079934234986
2025-03-09 09:34:48,975 [INFO]: }
2025-03-09 09:34:48,975 [INFO]: 	>>> Finished "Creating the index" in 68.1834 secs
2025-03-09 09:34:48,975 [INFO]: >>> Finished "Launching the whole pipeline" in 68.2234 secs
2025-03-09 09:34:49: [retrieval_preprocessing] calculating distances ...
2025-03-09 09:34:50: [retrieval_preprocessing] finished and saved retrieval indices for episode 87939 [episode count 0/20]
[retrieval_preprocessing] for episode 57732 [episode count 1/20], we have num_retrieval=np.int64(5266) num_query=np.int64(372)
2025-03-09 09:34:52,761 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-09 09:34:54,143 [INFO]: Launching the whole pipeline 03/09/2025, 09:34:54
2025-03-09 09:34:54,143 [INFO]: Reading total number of vectors and dimension 03/09/2025, 09:34:54
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1178.51it/s]
2025-03-09 09:34:54,173 [INFO]: There are 5266 embeddings of dim 49152
2025-03-09 09:34:54,174 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0306 secs
2025-03-09 09:34:54,174 [INFO]: 	Compute estimated construction time of the index 03/09/2025, 09:34:54
2025-03-09 09:34:54,174 [INFO]: 		-> Train: 16.7 minutes
2025-03-09 09:34:54,174 [INFO]: 		-> Add: 2.9 seconds
2025-03-09 09:34:54,174 [INFO]: 		Total: 16.7 minutes
2025-03-09 09:34:54,174 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0004 secs
2025-03-09 09:34:54,174 [INFO]: 	Checking that your have enough memory available to create the index 03/09/2025, 09:34:54
2025-03-09 09:34:54,175 [INFO]: 1.1GB of memory will be needed to build the index (more might be used if you have more)
2025-03-09 09:34:54,175 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0005 secs
2025-03-09 09:34:54,175 [INFO]: 	Selecting most promising index types given data characteristics 03/09/2025, 09:34:54
2025-03-09 09:34:54,175 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-09 09:34:54,175 [INFO]: 	Creating the index 03/09/2025, 09:34:54
2025-03-09 09:34:54,175 [INFO]: 		-> Instanciate the index HNSW15 03/09/2025, 09:34:54
2025-03-09 09:34:54,178 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0029 secs
2025-03-09 09:34:54,179 [INFO]: 		-> Adding the vectors to the index 03/09/2025, 09:34:54
2025-03-09 09:34:54,179 [INFO]: The memory available for adding the vectors is 49.0GB(total available - used by the index)
2025-03-09 09:34:54,179 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/22 [00:00<?, ?it/s]  5%|▍         | 1/22 [00:00<00:04,  4.80it/s]  9%|▉         | 2/22 [00:00<00:03,  6.60it/s] 14%|█▎        | 3/22 [00:00<00:02,  7.47it/s] 18%|█▊        | 4/22 [00:00<00:02,  7.94it/s] 23%|██▎       | 5/22 [00:00<00:02,  8.27it/s] 27%|██▋       | 6/22 [00:00<00:01,  8.73it/s] 36%|███▋      | 8/22 [00:00<00:01,  9.71it/s] 41%|████      | 9/22 [00:01<00:01,  9.38it/s] 45%|████▌     | 10/22 [00:01<00:01,  9.22it/s] 50%|█████     | 11/22 [00:01<00:01,  9.23it/s] 55%|█████▍    | 12/22 [00:01<00:01,  9.12it/s] 59%|█████▉    | 13/22 [00:01<00:00,  9.06it/s] 64%|██████▎   | 14/22 [00:01<00:00,  9.08it/s] 68%|██████▊   | 15/22 [00:01<00:00,  8.85it/s] 73%|███████▎  | 16/22 [00:01<00:00,  9.06it/s] 77%|███████▋  | 17/22 [00:01<00:00,  8.91it/s] 82%|████████▏ | 18/22 [00:02<00:00,  8.85it/s] 86%|████████▋ | 19/22 [00:02<00:00,  8.83it/s] 95%|█████████▌| 21/22 [00:05<00:00,  1.15it/s]100%|██████████| 22/22 [00:06<00:00,  1.15it/s]100%|██████████| 22/22 [00:06<00:00,  3.35it/s]
2025-03-09 09:35:00,757 [INFO]: 	Computing best hyperparameters for index knn.index 03/09/2025, 09:35:00
2025-03-09 09:35:58,479 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 57.7216 secs
2025-03-09 09:35:58,479 [INFO]: The best hyperparameters are: efSearch=215
2025-03-09 09:35:58,479 [INFO]: 	Compute fast metrics 03/09/2025, 09:35:58
  0%|          | 0/4 [00:00<?, ?it/s] 25%|██▌       | 1/4 [00:00<00:00,  5.76it/s] 75%|███████▌  | 3/4 [00:00<00:00,  9.20it/s] 75%|███████▌  | 3/4 [00:00<00:00,  7.02it/s]
2025-03-09 09:36:16,548 [INFO]: 	>>> Finished "Compute fast metrics" in 18.0685 secs
2025-03-09 09:36:16,548 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 82.3697 secs
2025-03-09 09:36:16,548 [INFO]: {
2025-03-09 09:36:16,549 [INFO]: 	index_key: HNSW15
2025-03-09 09:36:16,549 [INFO]: 	index_param: efSearch=215
2025-03-09 09:36:16,549 [INFO]: 	index_path: knn.index
2025-03-09 09:36:16,549 [INFO]: 	size in bytes: 1036054450
2025-03-09 09:36:16,549 [INFO]: 	avg_search_speed_ms: 9.123840523088337
2025-03-09 09:36:16,549 [INFO]: 	99p_search_speed_ms: 16.43990775337442
2025-03-09 09:36:16,549 [INFO]: 	reconstruction error %: 0.0
2025-03-09 09:36:16,549 [INFO]: 	nb vectors: 5266
2025-03-09 09:36:16,549 [INFO]: 	vectors dimension: 49152
2025-03-09 09:36:16,549 [INFO]: 	compression ratio: 0.9993082197562106
2025-03-09 09:36:16,549 [INFO]: }
2025-03-09 09:36:16,549 [INFO]: 	>>> Finished "Creating the index" in 82.3733 secs
2025-03-09 09:36:16,549 [INFO]: >>> Finished "Launching the whole pipeline" in 82.4057 secs
2025-03-09 09:36:18: [retrieval_preprocessing] calculating distances ...
2025-03-09 09:36:19: [retrieval_preprocessing] finished and saved retrieval indices for episode 57732 [episode count 1/20]
[retrieval_preprocessing] for episode 21253 [episode count 2/20], we have num_retrieval=np.int64(5326) num_query=np.int64(312)
2025-03-09 09:36:21,346 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-09 09:36:22,038 [INFO]: Launching the whole pipeline 03/09/2025, 09:36:22
2025-03-09 09:36:22,039 [INFO]: Reading total number of vectors and dimension 03/09/2025, 09:36:22
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1502.80it/s]
2025-03-09 09:36:22,068 [INFO]: There are 5326 embeddings of dim 49152
2025-03-09 09:36:22,068 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0294 secs
2025-03-09 09:36:22,068 [INFO]: 	Compute estimated construction time of the index 03/09/2025, 09:36:22
2025-03-09 09:36:22,068 [INFO]: 		-> Train: 16.7 minutes
2025-03-09 09:36:22,068 [INFO]: 		-> Add: 2.9 seconds
2025-03-09 09:36:22,068 [INFO]: 		Total: 16.7 minutes
2025-03-09 09:36:22,068 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0003 secs
2025-03-09 09:36:22,069 [INFO]: 	Checking that your have enough memory available to create the index 03/09/2025, 09:36:22
2025-03-09 09:36:22,069 [INFO]: 1.1GB of memory will be needed to build the index (more might be used if you have more)
2025-03-09 09:36:22,069 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0004 secs
2025-03-09 09:36:22,069 [INFO]: 	Selecting most promising index types given data characteristics 03/09/2025, 09:36:22
2025-03-09 09:36:22,069 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-09 09:36:22,069 [INFO]: 	Creating the index 03/09/2025, 09:36:22
2025-03-09 09:36:22,069 [INFO]: 		-> Instanciate the index HNSW15 03/09/2025, 09:36:22
2025-03-09 09:36:22,072 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0027 secs
2025-03-09 09:36:22,073 [INFO]: 		-> Adding the vectors to the index 03/09/2025, 09:36:22
2025-03-09 09:36:22,073 [INFO]: The memory available for adding the vectors is 49.0GB(total available - used by the index)
2025-03-09 09:36:22,073 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/22 [00:00<?, ?it/s]  5%|▍         | 1/22 [00:00<00:03,  5.87it/s] 14%|█▎        | 3/22 [00:00<00:02,  9.36it/s] 23%|██▎       | 5/22 [00:00<00:01, 10.66it/s] 32%|███▏      | 7/22 [00:00<00:01, 11.24it/s] 41%|████      | 9/22 [00:00<00:01, 11.61it/s] 50%|█████     | 11/22 [00:01<00:00, 11.64it/s] 59%|█████▉    | 13/22 [00:01<00:00, 11.62it/s] 68%|██████▊   | 15/22 [00:01<00:00, 12.59it/s] 77%|███████▋  | 17/22 [00:01<00:00, 13.35it/s] 86%|████████▋ | 19/22 [00:01<00:00, 12.77it/s] 95%|█████████▌| 21/22 [00:05<00:00,  1.57it/s]100%|██████████| 22/22 [00:06<00:00,  1.42it/s]100%|██████████| 22/22 [00:06<00:00,  3.43it/s]
2025-03-09 09:36:28,496 [INFO]: 	Computing best hyperparameters for index knn.index 03/09/2025, 09:36:28
2025-03-09 09:37:28,799 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 60.3020 secs
2025-03-09 09:37:28,799 [INFO]: The best hyperparameters are: efSearch=200
2025-03-09 09:37:28,799 [INFO]: 	Compute fast metrics 03/09/2025, 09:37:28
  0%|          | 0/4 [00:00<?, ?it/s] 25%|██▌       | 1/4 [00:00<00:00,  5.39it/s] 50%|█████     | 2/4 [00:00<00:00,  5.75it/s] 75%|███████▌  | 3/4 [00:00<00:00,  6.40it/s] 75%|███████▌  | 3/4 [00:00<00:00,  5.08it/s]
2025-03-09 09:37:47,122 [INFO]: 	>>> Finished "Compute fast metrics" in 18.3228 secs
2025-03-09 09:37:47,123 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 85.0507 secs
2025-03-09 09:37:47,123 [INFO]: {
2025-03-09 09:37:47,123 [INFO]: 	index_key: HNSW15
2025-03-09 09:37:47,123 [INFO]: 	index_param: efSearch=200
2025-03-09 09:37:47,123 [INFO]: 	index_path: knn.index
2025-03-09 09:37:47,124 [INFO]: 	size in bytes: 1047859150
2025-03-09 09:37:47,124 [INFO]: 	avg_search_speed_ms: 9.615609572322752
2025-03-09 09:37:47,124 [INFO]: 	99p_search_speed_ms: 21.02869342546903
2025-03-09 09:37:47,124 [INFO]: 	reconstruction error %: 0.0
2025-03-09 09:37:47,124 [INFO]: 	nb vectors: 5326
2025-03-09 09:37:47,124 [INFO]: 	vectors dimension: 49152
2025-03-09 09:37:47,124 [INFO]: 	compression ratio: 0.999308168469016
2025-03-09 09:37:47,124 [INFO]: }
2025-03-09 09:37:47,124 [INFO]: 	>>> Finished "Creating the index" in 85.0542 secs
2025-03-09 09:37:47,124 [INFO]: >>> Finished "Launching the whole pipeline" in 85.0851 secs
2025-03-09 09:37:48: [retrieval_preprocessing] calculating distances ...
2025-03-09 09:37:49: [retrieval_preprocessing] finished and saved retrieval indices for episode 21253 [episode count 2/20]
[retrieval_preprocessing] for episode 89861 [episode count 3/20], we have num_retrieval=np.int64(5394) num_query=np.int64(244)
2025-03-09 09:37:51,113 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-09 09:37:51,892 [INFO]: Launching the whole pipeline 03/09/2025, 09:37:51
2025-03-09 09:37:51,892 [INFO]: Reading total number of vectors and dimension 03/09/2025, 09:37:51
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1209.08it/s]
2025-03-09 09:37:51,917 [INFO]: There are 5394 embeddings of dim 49152
2025-03-09 09:37:51,917 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0248 secs
2025-03-09 09:37:51,917 [INFO]: 	Compute estimated construction time of the index 03/09/2025, 09:37:51
2025-03-09 09:37:51,917 [INFO]: 		-> Train: 16.7 minutes
2025-03-09 09:37:51,917 [INFO]: 		-> Add: 3.0 seconds
2025-03-09 09:37:51,917 [INFO]: 		Total: 16.7 minutes
2025-03-09 09:37:51,917 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0001 secs
2025-03-09 09:37:51,917 [INFO]: 	Checking that your have enough memory available to create the index 03/09/2025, 09:37:51
2025-03-09 09:37:51,917 [INFO]: 1.1GB of memory will be needed to build the index (more might be used if you have more)
2025-03-09 09:37:51,917 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0001 secs
2025-03-09 09:37:51,917 [INFO]: 	Selecting most promising index types given data characteristics 03/09/2025, 09:37:51
2025-03-09 09:37:51,917 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-09 09:37:51,917 [INFO]: 	Creating the index 03/09/2025, 09:37:51
2025-03-09 09:37:51,917 [INFO]: 		-> Instanciate the index HNSW15 03/09/2025, 09:37:51
2025-03-09 09:37:51,918 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0008 secs
2025-03-09 09:37:51,918 [INFO]: 		-> Adding the vectors to the index 03/09/2025, 09:37:51
2025-03-09 09:37:51,918 [INFO]: The memory available for adding the vectors is 49.0GB(total available - used by the index)
2025-03-09 09:37:51,918 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/23 [00:00<?, ?it/s]  4%|▍         | 1/23 [00:00<00:02,  7.55it/s] 13%|█▎        | 3/23 [00:00<00:01, 10.28it/s] 22%|██▏       | 5/23 [00:00<00:01, 10.17it/s] 30%|███       | 7/23 [00:00<00:01, 11.12it/s] 39%|███▉      | 9/23 [00:00<00:01, 12.64it/s] 52%|█████▏    | 12/23 [00:00<00:00, 15.42it/s] 61%|██████    | 14/23 [00:01<00:00, 15.91it/s] 70%|██████▉   | 16/23 [00:01<00:00, 16.31it/s] 78%|███████▊  | 18/23 [00:01<00:00, 16.34it/s] 87%|████████▋ | 20/23 [00:01<00:00, 16.47it/s] 96%|█████████▌| 22/23 [00:04<00:00,  1.78it/s]100%|██████████| 23/23 [00:05<00:00,  3.99it/s]
2025-03-09 09:37:57,678 [INFO]: 	Computing best hyperparameters for index knn.index 03/09/2025, 09:37:57
2025-03-09 09:38:43,511 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 45.8325 secs
2025-03-09 09:38:43,511 [INFO]: The best hyperparameters are: efSearch=259
2025-03-09 09:38:43,511 [INFO]: 	Compute fast metrics 03/09/2025, 09:38:43
  0%|          | 0/4 [00:00<?, ?it/s] 25%|██▌       | 1/4 [00:00<00:00,  5.23it/s] 50%|█████     | 2/4 [00:00<00:00,  6.88it/s] 75%|███████▌  | 3/4 [00:00<00:00,  7.63it/s] 75%|███████▌  | 3/4 [00:00<00:00,  6.16it/s]
2025-03-09 09:39:00,282 [INFO]: 	>>> Finished "Compute fast metrics" in 16.7715 secs
2025-03-09 09:39:00,283 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 68.3648 secs
2025-03-09 09:39:00,283 [INFO]: {
2025-03-09 09:39:00,283 [INFO]: 	index_key: HNSW15
2025-03-09 09:39:00,283 [INFO]: 	index_param: efSearch=259
2025-03-09 09:39:00,283 [INFO]: 	index_path: knn.index
2025-03-09 09:39:00,283 [INFO]: 	size in bytes: 1061237950
2025-03-09 09:39:00,283 [INFO]: 	avg_search_speed_ms: 10.861330379981721
2025-03-09 09:39:00,283 [INFO]: 	99p_search_speed_ms: 20.46435633674264
2025-03-09 09:39:00,283 [INFO]: 	reconstruction error %: 0.0
2025-03-09 09:39:00,283 [INFO]: 	nb vectors: 5394
2025-03-09 09:39:00,283 [INFO]: 	vectors dimension: 49152
2025-03-09 09:39:00,283 [INFO]: 	compression ratio: 0.9993079798927281
2025-03-09 09:39:00,283 [INFO]: }
2025-03-09 09:39:00,283 [INFO]: 	>>> Finished "Creating the index" in 68.3660 secs
2025-03-09 09:39:00,283 [INFO]: >>> Finished "Launching the whole pipeline" in 68.3913 secs
2025-03-09 09:39:01: [retrieval_preprocessing] calculating distances ...
2025-03-09 09:39:02: [retrieval_preprocessing] finished and saved retrieval indices for episode 89861 [episode count 3/20]
[retrieval_preprocessing] for episode 10760 [episode count 4/20], we have num_retrieval=np.int64(5325) num_query=np.int64(313)
2025-03-09 09:39:04,239 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-09 09:39:04,951 [INFO]: Launching the whole pipeline 03/09/2025, 09:39:04
2025-03-09 09:39:04,951 [INFO]: Reading total number of vectors and dimension 03/09/2025, 09:39:04
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1766.02it/s]
2025-03-09 09:39:04,978 [INFO]: There are 5325 embeddings of dim 49152
2025-03-09 09:39:04,978 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0274 secs
2025-03-09 09:39:04,978 [INFO]: 	Compute estimated construction time of the index 03/09/2025, 09:39:04
2025-03-09 09:39:04,979 [INFO]: 		-> Train: 16.7 minutes
2025-03-09 09:39:04,979 [INFO]: 		-> Add: 2.9 seconds
2025-03-09 09:39:04,979 [INFO]: 		Total: 16.7 minutes
2025-03-09 09:39:04,979 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0005 secs
2025-03-09 09:39:04,979 [INFO]: 	Checking that your have enough memory available to create the index 03/09/2025, 09:39:04
2025-03-09 09:39:04,979 [INFO]: 1.1GB of memory will be needed to build the index (more might be used if you have more)
2025-03-09 09:39:04,980 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0004 secs
2025-03-09 09:39:04,980 [INFO]: 	Selecting most promising index types given data characteristics 03/09/2025, 09:39:04
2025-03-09 09:39:04,980 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-09 09:39:04,980 [INFO]: 	Creating the index 03/09/2025, 09:39:04
2025-03-09 09:39:04,980 [INFO]: 		-> Instanciate the index HNSW15 03/09/2025, 09:39:04
2025-03-09 09:39:04,983 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0026 secs
2025-03-09 09:39:04,983 [INFO]: 		-> Adding the vectors to the index 03/09/2025, 09:39:04
2025-03-09 09:39:04,983 [INFO]: The memory available for adding the vectors is 49.0GB(total available - used by the index)
2025-03-09 09:39:04,983 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/22 [00:00<?, ?it/s]  5%|▍         | 1/22 [00:00<00:04,  4.82it/s]  9%|▉         | 2/22 [00:00<00:03,  6.55it/s] 14%|█▎        | 3/22 [00:00<00:02,  7.60it/s] 23%|██▎       | 5/22 [00:00<00:01,  9.05it/s] 32%|███▏      | 7/22 [00:00<00:01,  9.37it/s] 36%|███▋      | 8/22 [00:00<00:01,  9.31it/s] 41%|████      | 9/22 [00:01<00:01,  9.07it/s] 45%|████▌     | 10/22 [00:01<00:01,  8.96it/s] 50%|█████     | 11/22 [00:01<00:01,  8.88it/s] 55%|█████▍    | 12/22 [00:01<00:01,  8.85it/s] 59%|█████▉    | 13/22 [00:01<00:01,  8.92it/s] 64%|██████▎   | 14/22 [00:01<00:00,  8.84it/s] 68%|██████▊   | 15/22 [00:01<00:00,  8.87it/s] 77%|███████▋  | 17/22 [00:01<00:00, 10.23it/s] 86%|████████▋ | 19/22 [00:02<00:00, 10.99it/s] 95%|█████████▌| 21/22 [00:05<00:00,  1.47it/s]100%|██████████| 22/22 [00:06<00:00,  1.36it/s]100%|██████████| 22/22 [00:06<00:00,  3.40it/s]
2025-03-09 09:39:11,455 [INFO]: 	Computing best hyperparameters for index knn.index 03/09/2025, 09:39:11
2025-03-09 09:40:05,945 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 54.4890 secs
2025-03-09 09:40:05,945 [INFO]: The best hyperparameters are: efSearch=228
2025-03-09 09:40:05,945 [INFO]: 	Compute fast metrics 03/09/2025, 09:40:05
  0%|          | 0/4 [00:00<?, ?it/s] 25%|██▌       | 1/4 [00:00<00:00,  5.68it/s] 75%|███████▌  | 3/4 [00:00<00:00,  9.84it/s] 75%|███████▌  | 3/4 [00:00<00:00,  7.57it/s]
2025-03-09 09:40:25,164 [INFO]: 	>>> Finished "Compute fast metrics" in 19.2188 secs
2025-03-09 09:40:25,165 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 80.1821 secs
2025-03-09 09:40:25,165 [INFO]: {
2025-03-09 09:40:25,165 [INFO]: 	index_key: HNSW15
2025-03-09 09:40:25,165 [INFO]: 	index_param: efSearch=228
2025-03-09 09:40:25,165 [INFO]: 	index_path: knn.index
2025-03-09 09:40:25,165 [INFO]: 	size in bytes: 1047662410
2025-03-09 09:40:25,165 [INFO]: 	avg_search_speed_ms: 11.463555365580843
2025-03-09 09:40:25,165 [INFO]: 	99p_search_speed_ms: 22.868341973517076
2025-03-09 09:40:25,165 [INFO]: 	reconstruction error %: 0.0
2025-03-09 09:40:25,165 [INFO]: 	nb vectors: 5325
2025-03-09 09:40:25,165 [INFO]: 	vectors dimension: 49152
2025-03-09 09:40:25,165 [INFO]: 	compression ratio: 0.9993081645451038
2025-03-09 09:40:25,165 [INFO]: }
2025-03-09 09:40:25,165 [INFO]: 	>>> Finished "Creating the index" in 80.1855 secs
2025-03-09 09:40:25,166 [INFO]: >>> Finished "Launching the whole pipeline" in 80.2147 secs
2025-03-09 09:40:27: [retrieval_preprocessing] calculating distances ...
2025-03-09 09:40:29: [retrieval_preprocessing] finished and saved retrieval indices for episode 10760 [episode count 4/20]
[retrieval_preprocessing] for episode 84008 [episode count 5/20], we have num_retrieval=np.int64(5341) num_query=np.int64(297)
2025-03-09 09:40:29,490 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-09 09:40:30,155 [INFO]: Launching the whole pipeline 03/09/2025, 09:40:30
2025-03-09 09:40:30,155 [INFO]: Reading total number of vectors and dimension 03/09/2025, 09:40:30
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 998.41it/s]
2025-03-09 09:40:30,188 [INFO]: There are 5341 embeddings of dim 49152
2025-03-09 09:40:30,188 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0328 secs
2025-03-09 09:40:30,188 [INFO]: 	Compute estimated construction time of the index 03/09/2025, 09:40:30
2025-03-09 09:40:30,188 [INFO]: 		-> Train: 16.7 minutes
2025-03-09 09:40:30,188 [INFO]: 		-> Add: 2.9 seconds
2025-03-09 09:40:30,188 [INFO]: 		Total: 16.7 minutes
2025-03-09 09:40:30,188 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0001 secs
2025-03-09 09:40:30,188 [INFO]: 	Checking that your have enough memory available to create the index 03/09/2025, 09:40:30
2025-03-09 09:40:30,188 [INFO]: 1.1GB of memory will be needed to build the index (more might be used if you have more)
2025-03-09 09:40:30,189 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0002 secs
2025-03-09 09:40:30,189 [INFO]: 	Selecting most promising index types given data characteristics 03/09/2025, 09:40:30
2025-03-09 09:40:30,189 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-09 09:40:30,189 [INFO]: 	Creating the index 03/09/2025, 09:40:30
2025-03-09 09:40:30,189 [INFO]: 		-> Instanciate the index HNSW15 03/09/2025, 09:40:30
2025-03-09 09:40:30,190 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0011 secs
2025-03-09 09:40:30,190 [INFO]: 		-> Adding the vectors to the index 03/09/2025, 09:40:30
2025-03-09 09:40:30,190 [INFO]: The memory available for adding the vectors is 49.0GB(total available - used by the index)
2025-03-09 09:40:30,190 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/23 [00:00<?, ?it/s]  4%|▍         | 1/23 [00:00<00:02,  7.69it/s] 30%|███       | 7/23 [00:00<00:00, 32.20it/s] 57%|█████▋    | 13/23 [00:00<00:00, 42.63it/s] 83%|████████▎ | 19/23 [00:00<00:00, 46.71it/s]100%|██████████| 23/23 [00:05<00:00,  4.51it/s]
2025-03-09 09:40:35,297 [INFO]: 	Computing best hyperparameters for index knn.index 03/09/2025, 09:40:35
2025-03-09 09:41:34,567 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 59.2696 secs
2025-03-09 09:41:34,568 [INFO]: The best hyperparameters are: efSearch=190
2025-03-09 09:41:34,568 [INFO]: 	Compute fast metrics 03/09/2025, 09:41:34
  0%|          | 0/4 [00:00<?, ?it/s] 25%|██▌       | 1/4 [00:00<00:00,  6.43it/s] 75%|███████▌  | 3/4 [00:00<00:00,  9.47it/s] 75%|███████▌  | 3/4 [00:00<00:00,  7.21it/s]
2025-03-09 09:41:57,668 [INFO]: 	>>> Finished "Compute fast metrics" in 23.1000 secs
2025-03-09 09:41:57,669 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 87.4789 secs
2025-03-09 09:41:57,669 [INFO]: {
2025-03-09 09:41:57,669 [INFO]: 	index_key: HNSW15
2025-03-09 09:41:57,669 [INFO]: 	index_param: efSearch=190
2025-03-09 09:41:57,669 [INFO]: 	index_path: knn.index
2025-03-09 09:41:57,669 [INFO]: 	size in bytes: 1050810430
2025-03-09 09:41:57,669 [INFO]: 	avg_search_speed_ms: 10.149394775395693
2025-03-09 09:41:57,669 [INFO]: 	99p_search_speed_ms: 20.98765177652239
2025-03-09 09:41:57,669 [INFO]: 	reconstruction error %: 0.0
2025-03-09 09:41:57,669 [INFO]: 	nb vectors: 5341
2025-03-09 09:41:57,669 [INFO]: 	vectors dimension: 49152
2025-03-09 09:41:57,669 [INFO]: 	compression ratio: 0.9993080559735213
2025-03-09 09:41:57,669 [INFO]: }
2025-03-09 09:41:57,669 [INFO]: 	>>> Finished "Creating the index" in 87.4805 secs
2025-03-09 09:41:57,669 [INFO]: >>> Finished "Launching the whole pipeline" in 87.5140 secs
2025-03-09 09:41:58: [retrieval_preprocessing] calculating distances ...
2025-03-09 09:41:59: [retrieval_preprocessing] finished and saved retrieval indices for episode 84008 [episode count 5/20]
[retrieval_preprocessing] for episode 15631 [episode count 6/20], we have num_retrieval=np.int64(5362) num_query=np.int64(276)
2025-03-09 09:42:01,516 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-09 09:42:03,222 [INFO]: Launching the whole pipeline 03/09/2025, 09:42:03
2025-03-09 09:42:03,222 [INFO]: Reading total number of vectors and dimension 03/09/2025, 09:42:03
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1425.18it/s]
2025-03-09 09:42:03,245 [INFO]: There are 5362 embeddings of dim 49152
2025-03-09 09:42:03,245 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0236 secs
2025-03-09 09:42:03,246 [INFO]: 	Compute estimated construction time of the index 03/09/2025, 09:42:03
2025-03-09 09:42:03,246 [INFO]: 		-> Train: 16.7 minutes
2025-03-09 09:42:03,246 [INFO]: 		-> Add: 2.9 seconds
2025-03-09 09:42:03,246 [INFO]: 		Total: 16.7 minutes
2025-03-09 09:42:03,246 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0001 secs
2025-03-09 09:42:03,246 [INFO]: 	Checking that your have enough memory available to create the index 03/09/2025, 09:42:03
2025-03-09 09:42:03,246 [INFO]: 1.1GB of memory will be needed to build the index (more might be used if you have more)
2025-03-09 09:42:03,246 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0001 secs
2025-03-09 09:42:03,246 [INFO]: 	Selecting most promising index types given data characteristics 03/09/2025, 09:42:03
2025-03-09 09:42:03,246 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-09 09:42:03,246 [INFO]: 	Creating the index 03/09/2025, 09:42:03
2025-03-09 09:42:03,246 [INFO]: 		-> Instanciate the index HNSW15 03/09/2025, 09:42:03
2025-03-09 09:42:03,247 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0009 secs
2025-03-09 09:42:03,247 [INFO]: 		-> Adding the vectors to the index 03/09/2025, 09:42:03
2025-03-09 09:42:03,247 [INFO]: The memory available for adding the vectors is 49.0GB(total available - used by the index)
2025-03-09 09:42:03,247 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/23 [00:00<?, ?it/s]  4%|▍         | 1/23 [00:00<00:04,  5.26it/s] 13%|█▎        | 3/23 [00:00<00:02,  8.25it/s] 22%|██▏       | 5/23 [00:00<00:02,  8.87it/s] 26%|██▌       | 6/23 [00:00<00:01,  8.90it/s] 30%|███       | 7/23 [00:00<00:01,  8.90it/s] 35%|███▍      | 8/23 [00:00<00:01,  8.91it/s] 39%|███▉      | 9/23 [00:01<00:01,  9.03it/s] 43%|████▎     | 10/23 [00:01<00:01,  8.96it/s] 48%|████▊     | 11/23 [00:01<00:01,  8.94it/s] 52%|█████▏    | 12/23 [00:01<00:01,  8.86it/s] 57%|█████▋    | 13/23 [00:01<00:01,  8.86it/s] 61%|██████    | 14/23 [00:01<00:01,  8.93it/s] 65%|██████▌   | 15/23 [00:01<00:00,  8.95it/s] 70%|██████▉   | 16/23 [00:01<00:00,  8.71it/s] 74%|███████▍  | 17/23 [00:01<00:00,  8.59it/s] 78%|███████▊  | 18/23 [00:02<00:00,  8.96it/s] 87%|████████▋ | 20/23 [00:02<00:00, 10.92it/s] 96%|█████████▌| 22/23 [00:06<00:00,  1.16it/s]100%|██████████| 23/23 [00:07<00:00,  1.13it/s]100%|██████████| 23/23 [00:07<00:00,  3.18it/s]
2025-03-09 09:42:10,472 [INFO]: 	Computing best hyperparameters for index knn.index 03/09/2025, 09:42:10
2025-03-09 09:43:11,123 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 60.6502 secs
2025-03-09 09:43:11,123 [INFO]: The best hyperparameters are: efSearch=204
2025-03-09 09:43:11,123 [INFO]: 	Compute fast metrics 03/09/2025, 09:43:11
  0%|          | 0/4 [00:00<?, ?it/s] 25%|██▌       | 1/4 [00:00<00:00,  6.39it/s] 50%|█████     | 2/4 [00:00<00:00,  7.55it/s] 75%|███████▌  | 3/4 [00:00<00:00,  8.21it/s] 75%|███████▌  | 3/4 [00:00<00:00,  6.22it/s]
2025-03-09 09:43:32,114 [INFO]: 	>>> Finished "Compute fast metrics" in 20.9900 secs
2025-03-09 09:43:32,456 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 89.2087 secs
2025-03-09 09:43:32,456 [INFO]: {
2025-03-09 09:43:32,456 [INFO]: 	index_key: HNSW15
2025-03-09 09:43:32,456 [INFO]: 	index_param: efSearch=204
2025-03-09 09:43:32,456 [INFO]: 	index_path: knn.index
2025-03-09 09:43:32,457 [INFO]: 	size in bytes: 1054941970
2025-03-09 09:43:32,457 [INFO]: 	avg_search_speed_ms: 10.252429965692453
2025-03-09 09:43:32,457 [INFO]: 	99p_search_speed_ms: 18.470166488550603
2025-03-09 09:43:32,457 [INFO]: 	reconstruction error %: 0.0
2025-03-09 09:43:32,457 [INFO]: 	nb vectors: 5362
2025-03-09 09:43:32,457 [INFO]: 	vectors dimension: 49152
2025-03-09 09:43:32,457 [INFO]: 	compression ratio: 0.9993081382476422
2025-03-09 09:43:32,457 [INFO]: }
2025-03-09 09:43:32,457 [INFO]: 	>>> Finished "Creating the index" in 89.2110 secs
2025-03-09 09:43:32,457 [INFO]: >>> Finished "Launching the whole pipeline" in 89.2352 secs
2025-03-09 09:43:33: [retrieval_preprocessing] calculating distances ...
2025-03-09 09:43:34: [retrieval_preprocessing] finished and saved retrieval indices for episode 15631 [episode count 6/20]
[retrieval_preprocessing] for episode 82833 [episode count 7/20], we have num_retrieval=np.int64(5321) num_query=np.int64(317)
2025-03-09 09:43:35,642 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-09 09:43:36,307 [INFO]: Launching the whole pipeline 03/09/2025, 09:43:36
2025-03-09 09:43:36,307 [INFO]: Reading total number of vectors and dimension 03/09/2025, 09:43:36
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1549.43it/s]
2025-03-09 09:43:36,332 [INFO]: There are 5321 embeddings of dim 49152
2025-03-09 09:43:36,333 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0256 secs
2025-03-09 09:43:36,333 [INFO]: 	Compute estimated construction time of the index 03/09/2025, 09:43:36
2025-03-09 09:43:36,333 [INFO]: 		-> Train: 16.7 minutes
2025-03-09 09:43:36,333 [INFO]: 		-> Add: 2.9 seconds
2025-03-09 09:43:36,333 [INFO]: 		Total: 16.7 minutes
2025-03-09 09:43:36,333 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0001 secs
2025-03-09 09:43:36,333 [INFO]: 	Checking that your have enough memory available to create the index 03/09/2025, 09:43:36
2025-03-09 09:43:36,333 [INFO]: 1.1GB of memory will be needed to build the index (more might be used if you have more)
2025-03-09 09:43:36,333 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0001 secs
2025-03-09 09:43:36,333 [INFO]: 	Selecting most promising index types given data characteristics 03/09/2025, 09:43:36
2025-03-09 09:43:36,333 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-09 09:43:36,333 [INFO]: 	Creating the index 03/09/2025, 09:43:36
2025-03-09 09:43:36,333 [INFO]: 		-> Instanciate the index HNSW15 03/09/2025, 09:43:36
2025-03-09 09:43:36,334 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0009 secs
2025-03-09 09:43:36,334 [INFO]: 		-> Adding the vectors to the index 03/09/2025, 09:43:36
2025-03-09 09:43:36,334 [INFO]: The memory available for adding the vectors is 49.0GB(total available - used by the index)
2025-03-09 09:43:36,334 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/22 [00:00<?, ?it/s]  5%|▍         | 1/22 [00:00<00:04,  4.93it/s]  9%|▉         | 2/22 [00:00<00:03,  6.32it/s] 14%|█▎        | 3/22 [00:00<00:02,  6.98it/s] 23%|██▎       | 5/22 [00:00<00:01,  9.63it/s] 36%|███▋      | 8/22 [00:00<00:00, 14.42it/s] 50%|█████     | 11/22 [00:00<00:00, 17.39it/s] 64%|██████▎   | 14/22 [00:00<00:00, 19.96it/s] 77%|███████▋  | 17/22 [00:01<00:00, 21.60it/s] 91%|█████████ | 20/22 [00:01<00:00, 18.81it/s]100%|██████████| 22/22 [00:05<00:00,  1.73it/s]100%|██████████| 22/22 [00:05<00:00,  3.85it/s]
2025-03-09 09:43:42,055 [INFO]: 	Computing best hyperparameters for index knn.index 03/09/2025, 09:43:42
2025-03-09 09:44:24,925 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 42.8698 secs
2025-03-09 09:44:24,926 [INFO]: The best hyperparameters are: efSearch=182
2025-03-09 09:44:24,926 [INFO]: 	Compute fast metrics 03/09/2025, 09:44:24
  0%|          | 0/4 [00:00<?, ?it/s] 25%|██▌       | 1/4 [00:00<00:00,  5.07it/s] 50%|█████     | 2/4 [00:00<00:00,  6.89it/s] 75%|███████▌  | 3/4 [00:00<00:00,  7.70it/s] 75%|███████▌  | 3/4 [00:00<00:00,  5.78it/s]
2025-03-09 09:44:47,429 [INFO]: 	>>> Finished "Compute fast metrics" in 22.5027 secs
2025-03-09 09:44:47,429 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 71.0951 secs
2025-03-09 09:44:47,429 [INFO]: {
2025-03-09 09:44:47,429 [INFO]: 	index_key: HNSW15
2025-03-09 09:44:47,429 [INFO]: 	index_param: efSearch=182
2025-03-09 09:44:47,429 [INFO]: 	index_path: knn.index
2025-03-09 09:44:47,429 [INFO]: 	size in bytes: 1046875390
2025-03-09 09:44:47,429 [INFO]: 	avg_search_speed_ms: 8.73452092004395
2025-03-09 09:44:47,430 [INFO]: 	99p_search_speed_ms: 15.756138572469352
2025-03-09 09:44:47,430 [INFO]: 	reconstruction error %: 0.0
2025-03-09 09:44:47,430 [INFO]: 	nb vectors: 5321
2025-03-09 09:44:47,430 [INFO]: 	vectors dimension: 49152
2025-03-09 09:44:47,430 [INFO]: 	compression ratio: 0.9993082061084653
2025-03-09 09:44:47,430 [INFO]: }
2025-03-09 09:44:47,430 [INFO]: 	>>> Finished "Creating the index" in 71.0964 secs
2025-03-09 09:44:47,430 [INFO]: >>> Finished "Launching the whole pipeline" in 71.1226 secs
2025-03-09 09:44:49: [retrieval_preprocessing] calculating distances ...
2025-03-09 09:44:50: [retrieval_preprocessing] finished and saved retrieval indices for episode 82833 [episode count 7/20]
[retrieval_preprocessing] for episode 29463 [episode count 8/20], we have num_retrieval=np.int64(5411) num_query=np.int64(227)
2025-03-09 09:44:52,093 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-09 09:44:53,447 [INFO]: Launching the whole pipeline 03/09/2025, 09:44:53
2025-03-09 09:44:53,447 [INFO]: Reading total number of vectors and dimension 03/09/2025, 09:44:53
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1479.99it/s]
2025-03-09 09:44:53,474 [INFO]: There are 5411 embeddings of dim 49152
2025-03-09 09:44:53,474 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0272 secs
2025-03-09 09:44:53,474 [INFO]: 	Compute estimated construction time of the index 03/09/2025, 09:44:53
2025-03-09 09:44:53,474 [INFO]: 		-> Train: 16.7 minutes
2025-03-09 09:44:53,474 [INFO]: 		-> Add: 3.0 seconds
2025-03-09 09:44:53,474 [INFO]: 		Total: 16.7 minutes
2025-03-09 09:44:53,474 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0001 secs
2025-03-09 09:44:53,474 [INFO]: 	Checking that your have enough memory available to create the index 03/09/2025, 09:44:53
2025-03-09 09:44:53,474 [INFO]: 1.1GB of memory will be needed to build the index (more might be used if you have more)
2025-03-09 09:44:53,475 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0002 secs
2025-03-09 09:44:53,475 [INFO]: 	Selecting most promising index types given data characteristics 03/09/2025, 09:44:53
2025-03-09 09:44:53,475 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-09 09:44:53,475 [INFO]: 	Creating the index 03/09/2025, 09:44:53
2025-03-09 09:44:53,475 [INFO]: 		-> Instanciate the index HNSW15 03/09/2025, 09:44:53
2025-03-09 09:44:53,476 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0012 secs
2025-03-09 09:44:53,476 [INFO]: 		-> Adding the vectors to the index 03/09/2025, 09:44:53
2025-03-09 09:44:53,476 [INFO]: The memory available for adding the vectors is 49.0GB(total available - used by the index)
2025-03-09 09:44:53,476 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/23 [00:00<?, ?it/s]  4%|▍         | 1/23 [00:00<00:04,  5.31it/s] 13%|█▎        | 3/23 [00:00<00:02,  9.26it/s] 22%|██▏       | 5/23 [00:00<00:01, 10.87it/s] 30%|███       | 7/23 [00:00<00:01, 11.56it/s] 39%|███▉      | 9/23 [00:00<00:01, 12.00it/s] 48%|████▊     | 11/23 [00:00<00:00, 12.30it/s] 57%|█████▋    | 13/23 [00:01<00:00, 12.44it/s] 65%|██████▌   | 15/23 [00:01<00:00, 12.50it/s] 74%|███████▍  | 17/23 [00:01<00:00, 12.46it/s] 83%|████████▎ | 19/23 [00:01<00:00, 12.28it/s] 91%|█████████▏| 21/23 [00:05<00:01,  1.45it/s]100%|██████████| 23/23 [00:06<00:00,  1.55it/s]100%|██████████| 23/23 [00:06<00:00,  3.37it/s]
2025-03-09 09:45:00,313 [INFO]: 	Computing best hyperparameters for index knn.index 03/09/2025, 09:45:00
2025-03-09 09:45:56,939 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 56.6261 secs
2025-03-09 09:45:56,940 [INFO]: The best hyperparameters are: efSearch=228
2025-03-09 09:45:56,940 [INFO]: 	Compute fast metrics 03/09/2025, 09:45:56
  0%|          | 0/4 [00:00<?, ?it/s] 25%|██▌       | 1/4 [00:00<00:00,  4.35it/s] 50%|█████     | 2/4 [00:00<00:00,  5.50it/s] 75%|███████▌  | 3/4 [00:00<00:00,  6.38it/s] 75%|███████▌  | 3/4 [00:00<00:00,  4.90it/s]
2025-03-09 09:46:21,845 [INFO]: 	>>> Finished "Compute fast metrics" in 24.9057 secs
2025-03-09 09:46:21,846 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 88.3699 secs
2025-03-09 09:46:21,846 [INFO]: {
2025-03-09 09:46:21,846 [INFO]: 	index_key: HNSW15
2025-03-09 09:46:21,846 [INFO]: 	index_param: efSearch=228
2025-03-09 09:46:21,846 [INFO]: 	index_path: knn.index
2025-03-09 09:46:21,846 [INFO]: 	size in bytes: 1064582590
2025-03-09 09:46:21,846 [INFO]: 	avg_search_speed_ms: 10.922403284501057
2025-03-09 09:46:21,846 [INFO]: 	99p_search_speed_ms: 20.752229331992588
2025-03-09 09:46:21,846 [INFO]: 	reconstruction error %: 0.0
2025-03-09 09:46:21,846 [INFO]: 	nb vectors: 5411
2025-03-09 09:46:21,846 [INFO]: 	vectors dimension: 49152
2025-03-09 09:46:21,846 [INFO]: 	compression ratio: 0.9993079898103537
2025-03-09 09:46:21,846 [INFO]: }
2025-03-09 09:46:21,846 [INFO]: 	>>> Finished "Creating the index" in 88.3717 secs
2025-03-09 09:46:21,846 [INFO]: >>> Finished "Launching the whole pipeline" in 88.3995 secs
2025-03-09 09:46:23: [retrieval_preprocessing] calculating distances ...
2025-03-09 09:46:24: [retrieval_preprocessing] finished and saved retrieval indices for episode 29463 [episode count 8/20]
[retrieval_preprocessing] for episode 33815 [episode count 9/20], we have num_retrieval=np.int64(5305) num_query=np.int64(333)
2025-03-09 09:46:26,035 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-09 09:46:26,730 [INFO]: Launching the whole pipeline 03/09/2025, 09:46:26
2025-03-09 09:46:26,730 [INFO]: Reading total number of vectors and dimension 03/09/2025, 09:46:26
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 2234.58it/s]
2025-03-09 09:46:26,754 [INFO]: There are 5305 embeddings of dim 49152
2025-03-09 09:46:26,754 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0243 secs
2025-03-09 09:46:26,754 [INFO]: 	Compute estimated construction time of the index 03/09/2025, 09:46:26
2025-03-09 09:46:26,754 [INFO]: 		-> Train: 16.7 minutes
2025-03-09 09:46:26,754 [INFO]: 		-> Add: 2.9 seconds
2025-03-09 09:46:26,754 [INFO]: 		Total: 16.7 minutes
2025-03-09 09:46:26,754 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0001 secs
2025-03-09 09:46:26,754 [INFO]: 	Checking that your have enough memory available to create the index 03/09/2025, 09:46:26
2025-03-09 09:46:26,754 [INFO]: 1.1GB of memory will be needed to build the index (more might be used if you have more)
2025-03-09 09:46:26,754 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0001 secs
2025-03-09 09:46:26,754 [INFO]: 	Selecting most promising index types given data characteristics 03/09/2025, 09:46:26
2025-03-09 09:46:26,754 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-09 09:46:26,754 [INFO]: 	Creating the index 03/09/2025, 09:46:26
2025-03-09 09:46:26,754 [INFO]: 		-> Instanciate the index HNSW15 03/09/2025, 09:46:26
2025-03-09 09:46:26,755 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0009 secs
2025-03-09 09:46:26,756 [INFO]: 		-> Adding the vectors to the index 03/09/2025, 09:46:26
2025-03-09 09:46:26,756 [INFO]: The memory available for adding the vectors is 49.0GB(total available - used by the index)
2025-03-09 09:46:26,756 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/22 [00:00<?, ?it/s]  5%|▍         | 1/22 [00:00<00:03,  5.88it/s] 14%|█▎        | 3/22 [00:00<00:01,  9.80it/s] 23%|██▎       | 5/22 [00:00<00:01, 11.10it/s] 32%|███▏      | 7/22 [00:00<00:01, 11.74it/s] 41%|████      | 9/22 [00:00<00:01, 11.96it/s] 50%|█████     | 11/22 [00:00<00:00, 12.18it/s] 59%|█████▉    | 13/22 [00:01<00:00, 12.37it/s] 68%|██████▊   | 15/22 [00:01<00:00, 12.36it/s] 77%|███████▋  | 17/22 [00:01<00:00, 12.43it/s] 86%|████████▋ | 19/22 [00:01<00:00, 12.56it/s] 95%|█████████▌| 21/22 [00:05<00:00,  1.56it/s]100%|██████████| 22/22 [00:06<00:00,  1.39it/s]100%|██████████| 22/22 [00:06<00:00,  3.39it/s]
2025-03-09 09:46:33,261 [INFO]: 	Computing best hyperparameters for index knn.index 03/09/2025, 09:46:33
2025-03-09 09:47:17,011 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 43.7494 secs
2025-03-09 09:47:17,011 [INFO]: The best hyperparameters are: efSearch=144
2025-03-09 09:47:17,012 [INFO]: 	Compute fast metrics 03/09/2025, 09:47:17
  0%|          | 0/4 [00:00<?, ?it/s] 25%|██▌       | 1/4 [00:00<00:00,  5.66it/s] 50%|█████     | 2/4 [00:00<00:00,  7.09it/s] 75%|███████▌  | 3/4 [00:00<00:00,  7.59it/s] 75%|███████▌  | 3/4 [00:00<00:00,  5.63it/s]
2025-03-09 09:47:36,581 [INFO]: 	>>> Finished "Compute fast metrics" in 19.5692 secs
2025-03-09 09:47:36,582 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 69.8260 secs
2025-03-09 09:47:36,582 [INFO]: {
2025-03-09 09:47:36,582 [INFO]: 	index_key: HNSW15
2025-03-09 09:47:36,582 [INFO]: 	index_param: efSearch=144
2025-03-09 09:47:36,582 [INFO]: 	index_path: knn.index
2025-03-09 09:47:36,582 [INFO]: 	size in bytes: 1043727430
2025-03-09 09:47:36,582 [INFO]: 	avg_search_speed_ms: 7.341637381245813
2025-03-09 09:47:36,582 [INFO]: 	99p_search_speed_ms: 14.304248855914922
2025-03-09 09:47:36,582 [INFO]: 	reconstruction error %: 0.0
2025-03-09 09:47:36,582 [INFO]: 	nb vectors: 5305
2025-03-09 09:47:36,582 [INFO]: 	vectors dimension: 49152
2025-03-09 09:47:36,582 [INFO]: 	compression ratio: 0.9993082580956985
2025-03-09 09:47:36,582 [INFO]: }
2025-03-09 09:47:36,582 [INFO]: 	>>> Finished "Creating the index" in 69.8275 secs
2025-03-09 09:47:36,582 [INFO]: >>> Finished "Launching the whole pipeline" in 69.8523 secs
2025-03-09 09:47:37: [retrieval_preprocessing] calculating distances ...
2025-03-09 09:47:38: [retrieval_preprocessing] finished and saved retrieval indices for episode 33815 [episode count 9/20]
[retrieval_preprocessing] for episode 66839 [episode count 10/20], we have num_retrieval=np.int64(5407) num_query=np.int64(231)
2025-03-09 09:47:40,244 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-09 09:47:41,608 [INFO]: Launching the whole pipeline 03/09/2025, 09:47:41
2025-03-09 09:47:41,608 [INFO]: Reading total number of vectors and dimension 03/09/2025, 09:47:41
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1149.12it/s]
2025-03-09 09:47:41,636 [INFO]: There are 5407 embeddings of dim 49152
2025-03-09 09:47:41,637 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0286 secs
2025-03-09 09:47:41,637 [INFO]: 	Compute estimated construction time of the index 03/09/2025, 09:47:41
2025-03-09 09:47:41,637 [INFO]: 		-> Train: 16.7 minutes
2025-03-09 09:47:41,637 [INFO]: 		-> Add: 3.0 seconds
2025-03-09 09:47:41,637 [INFO]: 		Total: 16.7 minutes
2025-03-09 09:47:41,637 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0003 secs
2025-03-09 09:47:41,637 [INFO]: 	Checking that your have enough memory available to create the index 03/09/2025, 09:47:41
2025-03-09 09:47:41,637 [INFO]: 1.1GB of memory will be needed to build the index (more might be used if you have more)
2025-03-09 09:47:41,638 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0002 secs
2025-03-09 09:47:41,638 [INFO]: 	Selecting most promising index types given data characteristics 03/09/2025, 09:47:41
2025-03-09 09:47:41,638 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-09 09:47:41,638 [INFO]: 	Creating the index 03/09/2025, 09:47:41
2025-03-09 09:47:41,638 [INFO]: 		-> Instanciate the index HNSW15 03/09/2025, 09:47:41
2025-03-09 09:47:41,640 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0020 secs
2025-03-09 09:47:41,640 [INFO]: 		-> Adding the vectors to the index 03/09/2025, 09:47:41
2025-03-09 09:47:41,640 [INFO]: The memory available for adding the vectors is 49.0GB(total available - used by the index)
2025-03-09 09:47:41,640 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/23 [00:00<?, ?it/s]  4%|▍         | 1/23 [00:00<00:04,  5.18it/s] 13%|█▎        | 3/23 [00:00<00:02,  8.71it/s] 22%|██▏       | 5/23 [00:00<00:01, 10.14it/s] 30%|███       | 7/23 [00:00<00:01, 10.76it/s] 39%|███▉      | 9/23 [00:00<00:01, 11.04it/s] 48%|████▊     | 11/23 [00:01<00:01, 10.75it/s] 57%|█████▋    | 13/23 [00:01<00:00, 10.62it/s] 65%|██████▌   | 15/23 [00:01<00:00, 10.53it/s] 74%|███████▍  | 17/23 [00:01<00:00, 10.47it/s] 83%|████████▎ | 19/23 [00:01<00:00, 10.37it/s] 91%|█████████▏| 21/23 [00:05<00:01,  1.58it/s]100%|██████████| 23/23 [00:06<00:00,  1.60it/s]100%|██████████| 23/23 [00:06<00:00,  3.41it/s]
2025-03-09 09:47:48,400 [INFO]: 	Computing best hyperparameters for index knn.index 03/09/2025, 09:47:48
2025-03-09 09:48:40,468 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 52.0677 secs
2025-03-09 09:48:40,469 [INFO]: The best hyperparameters are: efSearch=155
2025-03-09 09:48:40,469 [INFO]: 	Compute fast metrics 03/09/2025, 09:48:40
  0%|          | 0/4 [00:00<?, ?it/s] 25%|██▌       | 1/4 [00:00<00:00,  5.18it/s] 50%|█████     | 2/4 [00:00<00:00,  6.83it/s] 75%|███████▌  | 3/4 [00:00<00:00,  7.59it/s] 75%|███████▌  | 3/4 [00:00<00:00,  6.03it/s]
2025-03-09 09:49:08,970 [INFO]: 	>>> Finished "Compute fast metrics" in 28.5012 secs
2025-03-09 09:49:08,971 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 87.3307 secs
2025-03-09 09:49:08,971 [INFO]: {
2025-03-09 09:49:08,971 [INFO]: 	index_key: HNSW15
2025-03-09 09:49:08,971 [INFO]: 	index_param: efSearch=155
2025-03-09 09:49:08,971 [INFO]: 	index_path: knn.index
2025-03-09 09:49:08,971 [INFO]: 	size in bytes: 1063795630
2025-03-09 09:49:08,971 [INFO]: 	avg_search_speed_ms: 8.899657721084367
2025-03-09 09:49:08,971 [INFO]: 	99p_search_speed_ms: 13.152808856684713
2025-03-09 09:49:08,971 [INFO]: 	reconstruction error %: 0.0
2025-03-09 09:49:08,971 [INFO]: 	nb vectors: 5407
2025-03-09 09:49:08,971 [INFO]: 	vectors dimension: 49152
2025-03-09 09:49:08,971 [INFO]: 	compression ratio: 0.9993079742205747
2025-03-09 09:49:08,971 [INFO]: }
2025-03-09 09:49:08,971 [INFO]: 	>>> Finished "Creating the index" in 87.3334 secs
2025-03-09 09:49:08,971 [INFO]: >>> Finished "Launching the whole pipeline" in 87.3634 secs
2025-03-09 09:49:09: [retrieval_preprocessing] calculating distances ...
2025-03-09 09:49:10: [retrieval_preprocessing] finished and saved retrieval indices for episode 66839 [episode count 10/20]
[retrieval_preprocessing] for episode 11802 [episode count 11/20], we have num_retrieval=np.int64(5515) num_query=np.int64(123)
2025-03-09 09:49:12,758 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-09 09:49:13,582 [INFO]: Launching the whole pipeline 03/09/2025, 09:49:13
2025-03-09 09:49:13,582 [INFO]: Reading total number of vectors and dimension 03/09/2025, 09:49:13
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1829.98it/s]
2025-03-09 09:49:13,613 [INFO]: There are 5515 embeddings of dim 49152
2025-03-09 09:49:13,613 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0304 secs
2025-03-09 09:49:13,613 [INFO]: 	Compute estimated construction time of the index 03/09/2025, 09:49:13
2025-03-09 09:49:13,613 [INFO]: 		-> Train: 16.7 minutes
2025-03-09 09:49:13,613 [INFO]: 		-> Add: 3.0 seconds
2025-03-09 09:49:13,613 [INFO]: 		Total: 16.7 minutes
2025-03-09 09:49:13,614 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0004 secs
2025-03-09 09:49:13,614 [INFO]: 	Checking that your have enough memory available to create the index 03/09/2025, 09:49:13
2025-03-09 09:49:13,614 [INFO]: 1.1GB of memory will be needed to build the index (more might be used if you have more)
2025-03-09 09:49:13,614 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0004 secs
2025-03-09 09:49:13,614 [INFO]: 	Selecting most promising index types given data characteristics 03/09/2025, 09:49:13
2025-03-09 09:49:13,614 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-09 09:49:13,614 [INFO]: 	Creating the index 03/09/2025, 09:49:13
2025-03-09 09:49:13,615 [INFO]: 		-> Instanciate the index HNSW15 03/09/2025, 09:49:13
2025-03-09 09:49:13,617 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0028 secs
2025-03-09 09:49:13,618 [INFO]: 		-> Adding the vectors to the index 03/09/2025, 09:49:13
2025-03-09 09:49:13,618 [INFO]: The memory available for adding the vectors is 49.0GB(total available - used by the index)
2025-03-09 09:49:13,618 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/23 [00:00<?, ?it/s]  4%|▍         | 1/23 [00:00<00:03,  6.95it/s] 13%|█▎        | 3/23 [00:00<00:01, 12.89it/s] 22%|██▏       | 5/23 [00:00<00:01, 15.21it/s] 30%|███       | 7/23 [00:00<00:00, 16.18it/s] 39%|███▉      | 9/23 [00:00<00:00, 17.06it/s] 48%|████▊     | 11/23 [00:00<00:00, 17.31it/s] 57%|█████▋    | 13/23 [00:00<00:00, 17.56it/s] 65%|██████▌   | 15/23 [00:00<00:00, 18.25it/s] 74%|███████▍  | 17/23 [00:01<00:00, 18.28it/s] 83%|████████▎ | 19/23 [00:01<00:00, 18.32it/s] 91%|█████████▏| 21/23 [00:05<00:01,  1.44it/s]100%|██████████| 23/23 [00:06<00:00,  1.47it/s]100%|██████████| 23/23 [00:06<00:00,  3.44it/s]
2025-03-09 09:49:20,308 [INFO]: 	Computing best hyperparameters for index knn.index 03/09/2025, 09:49:20
2025-03-09 09:50:15,069 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 54.7603 secs
2025-03-09 09:50:15,069 [INFO]: The best hyperparameters are: efSearch=235
2025-03-09 09:50:15,069 [INFO]: 	Compute fast metrics 03/09/2025, 09:50:15
  0%|          | 0/4 [00:00<?, ?it/s] 25%|██▌       | 1/4 [00:00<00:00,  5.32it/s] 50%|█████     | 2/4 [00:00<00:00,  6.86it/s] 75%|███████▌  | 3/4 [00:00<00:00,  7.52it/s] 75%|███████▌  | 3/4 [00:00<00:00,  5.64it/s]
2025-03-09 09:50:41,715 [INFO]: 	>>> Finished "Compute fast metrics" in 26.6453 secs
2025-03-09 09:50:41,716 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 88.0979 secs
2025-03-09 09:50:41,716 [INFO]: {
2025-03-09 09:50:41,716 [INFO]: 	index_key: HNSW15
2025-03-09 09:50:41,716 [INFO]: 	index_param: efSearch=235
2025-03-09 09:50:41,716 [INFO]: 	index_path: knn.index
2025-03-09 09:50:41,716 [INFO]: 	size in bytes: 1085043970
2025-03-09 09:50:41,716 [INFO]: 	avg_search_speed_ms: 10.303151831663877
2025-03-09 09:50:41,716 [INFO]: 	99p_search_speed_ms: 17.991233384236686
2025-03-09 09:50:41,716 [INFO]: 	reconstruction error %: 0.0
2025-03-09 09:50:41,716 [INFO]: 	nb vectors: 5515
2025-03-09 09:50:41,716 [INFO]: 	vectors dimension: 49152
2025-03-09 09:50:41,716 [INFO]: 	compression ratio: 0.9993080003937537
2025-03-09 09:50:41,716 [INFO]: }
2025-03-09 09:50:41,716 [INFO]: 	>>> Finished "Creating the index" in 88.1014 secs
2025-03-09 09:50:41,716 [INFO]: >>> Finished "Launching the whole pipeline" in 88.1335 secs
2025-03-09 09:50:42: [retrieval_preprocessing] calculating distances ...
2025-03-09 09:50:43: [retrieval_preprocessing] finished and saved retrieval indices for episode 11802 [episode count 11/20]
[retrieval_preprocessing] for episode 21019 [episode count 12/20], we have num_retrieval=np.int64(5352) num_query=np.int64(286)
2025-03-09 09:50:44,945 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-09 09:50:45,704 [INFO]: Launching the whole pipeline 03/09/2025, 09:50:45
2025-03-09 09:50:45,704 [INFO]: Reading total number of vectors and dimension 03/09/2025, 09:50:45
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 2205.21it/s]
2025-03-09 09:50:45,728 [INFO]: There are 5352 embeddings of dim 49152
2025-03-09 09:50:45,729 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0241 secs
2025-03-09 09:50:45,729 [INFO]: 	Compute estimated construction time of the index 03/09/2025, 09:50:45
2025-03-09 09:50:45,729 [INFO]: 		-> Train: 16.7 minutes
2025-03-09 09:50:45,729 [INFO]: 		-> Add: 2.9 seconds
2025-03-09 09:50:45,729 [INFO]: 		Total: 16.7 minutes
2025-03-09 09:50:45,729 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0001 secs
2025-03-09 09:50:45,729 [INFO]: 	Checking that your have enough memory available to create the index 03/09/2025, 09:50:45
2025-03-09 09:50:45,729 [INFO]: 1.1GB of memory will be needed to build the index (more might be used if you have more)
2025-03-09 09:50:45,729 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0001 secs
2025-03-09 09:50:45,729 [INFO]: 	Selecting most promising index types given data characteristics 03/09/2025, 09:50:45
2025-03-09 09:50:45,729 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-09 09:50:45,729 [INFO]: 	Creating the index 03/09/2025, 09:50:45
2025-03-09 09:50:45,729 [INFO]: 		-> Instanciate the index HNSW15 03/09/2025, 09:50:45
2025-03-09 09:50:45,730 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0011 secs
2025-03-09 09:50:45,730 [INFO]: 		-> Adding the vectors to the index 03/09/2025, 09:50:45
2025-03-09 09:50:45,730 [INFO]: The memory available for adding the vectors is 49.0GB(total available - used by the index)
2025-03-09 09:50:45,730 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/23 [00:00<?, ?it/s]  4%|▍         | 1/23 [00:00<00:03,  5.65it/s] 13%|█▎        | 3/23 [00:00<00:02,  9.36it/s] 22%|██▏       | 5/23 [00:00<00:01, 10.64it/s] 30%|███       | 7/23 [00:00<00:01, 11.17it/s] 39%|███▉      | 9/23 [00:00<00:01, 11.51it/s] 48%|████▊     | 11/23 [00:01<00:01, 11.63it/s] 57%|█████▋    | 13/23 [00:01<00:00, 11.70it/s] 65%|██████▌   | 15/23 [00:01<00:00, 11.74it/s] 74%|███████▍  | 17/23 [00:01<00:00, 11.75it/s] 83%|████████▎ | 19/23 [00:01<00:00, 11.79it/s] 91%|█████████▏| 21/23 [00:05<00:01,  1.63it/s] 96%|█████████▌| 22/23 [00:05<00:00,  1.91it/s]100%|██████████| 23/23 [00:06<00:00,  1.65it/s]100%|██████████| 23/23 [00:06<00:00,  3.63it/s]
2025-03-09 09:50:52,072 [INFO]: 	Computing best hyperparameters for index knn.index 03/09/2025, 09:50:52
2025-03-09 09:51:51,428 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 59.3555 secs
2025-03-09 09:51:51,428 [INFO]: The best hyperparameters are: efSearch=195
2025-03-09 09:51:51,428 [INFO]: 	Compute fast metrics 03/09/2025, 09:51:51
  0%|          | 0/4 [00:00<?, ?it/s] 25%|██▌       | 1/4 [00:00<00:00,  5.25it/s] 50%|█████     | 2/4 [00:00<00:00,  6.78it/s] 75%|███████▌  | 3/4 [00:00<00:00,  7.54it/s] 75%|███████▌  | 3/4 [00:00<00:00,  5.66it/s]
2025-03-09 09:52:11,223 [INFO]: 	>>> Finished "Compute fast metrics" in 19.7950 secs
2025-03-09 09:52:11,223 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 85.4931 secs
2025-03-09 09:52:11,224 [INFO]: {
2025-03-09 09:52:11,224 [INFO]: 	index_key: HNSW15
2025-03-09 09:52:11,224 [INFO]: 	index_param: efSearch=195
2025-03-09 09:52:11,224 [INFO]: 	index_path: knn.index
2025-03-09 09:52:11,224 [INFO]: 	size in bytes: 1052974570
2025-03-09 09:52:11,224 [INFO]: 	avg_search_speed_ms: 9.021162422330182
2025-03-09 09:52:11,224 [INFO]: 	99p_search_speed_ms: 18.004401365760717
2025-03-09 09:52:11,224 [INFO]: 	reconstruction error %: 0.0
2025-03-09 09:52:11,224 [INFO]: 	nb vectors: 5352
2025-03-09 09:52:11,224 [INFO]: 	vectors dimension: 49152
2025-03-09 09:52:11,224 [INFO]: 	compression ratio: 0.9993080991500108
2025-03-09 09:52:11,224 [INFO]: }
2025-03-09 09:52:11,224 [INFO]: 	>>> Finished "Creating the index" in 85.4946 secs
2025-03-09 09:52:11,224 [INFO]: >>> Finished "Launching the whole pipeline" in 85.5193 secs
2025-03-09 09:52:12: [retrieval_preprocessing] calculating distances ...
2025-03-09 09:52:13: [retrieval_preprocessing] finished and saved retrieval indices for episode 21019 [episode count 12/20]
[retrieval_preprocessing] for episode 17692 [episode count 13/20], we have num_retrieval=np.int64(5317) num_query=np.int64(321)
2025-03-09 09:52:14,752 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-09 09:52:15,911 [INFO]: Launching the whole pipeline 03/09/2025, 09:52:15
2025-03-09 09:52:15,911 [INFO]: Reading total number of vectors and dimension 03/09/2025, 09:52:15
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00,  1.44it/s]100%|██████████| 1/1 [00:00<00:00,  1.44it/s]
2025-03-09 09:52:16,629 [INFO]: There are 5317 embeddings of dim 49152
2025-03-09 09:52:16,629 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.7181 secs
2025-03-09 09:52:16,629 [INFO]: 	Compute estimated construction time of the index 03/09/2025, 09:52:16
2025-03-09 09:52:16,630 [INFO]: 		-> Train: 16.7 minutes
2025-03-09 09:52:16,630 [INFO]: 		-> Add: 2.9 seconds
2025-03-09 09:52:16,630 [INFO]: 		Total: 16.7 minutes
2025-03-09 09:52:16,630 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0003 secs
2025-03-09 09:52:16,630 [INFO]: 	Checking that your have enough memory available to create the index 03/09/2025, 09:52:16
2025-03-09 09:52:16,630 [INFO]: 1.1GB of memory will be needed to build the index (more might be used if you have more)
2025-03-09 09:52:16,630 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0004 secs
2025-03-09 09:52:16,630 [INFO]: 	Selecting most promising index types given data characteristics 03/09/2025, 09:52:16
2025-03-09 09:52:16,630 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-09 09:52:16,631 [INFO]: 	Creating the index 03/09/2025, 09:52:16
2025-03-09 09:52:16,631 [INFO]: 		-> Instanciate the index HNSW15 03/09/2025, 09:52:16
2025-03-09 09:52:16,633 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0024 secs
2025-03-09 09:52:16,634 [INFO]: 		-> Adding the vectors to the index 03/09/2025, 09:52:16
2025-03-09 09:52:16,634 [INFO]: The memory available for adding the vectors is 49.0GB(total available - used by the index)
2025-03-09 09:52:16,634 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/22 [00:00<?, ?it/s]  5%|▍         | 1/22 [00:00<00:03,  5.62it/s] 14%|█▎        | 3/22 [00:00<00:01,  9.77it/s] 23%|██▎       | 5/22 [00:00<00:01, 11.36it/s] 32%|███▏      | 7/22 [00:00<00:01, 11.96it/s] 41%|████      | 9/22 [00:00<00:01, 12.45it/s] 50%|█████     | 11/22 [00:00<00:00, 12.63it/s] 59%|█████▉    | 13/22 [00:01<00:00, 12.71it/s] 68%|██████▊   | 15/22 [00:01<00:00, 12.80it/s] 77%|███████▋  | 17/22 [00:01<00:00, 12.75it/s] 86%|████████▋ | 19/22 [00:01<00:00, 13.06it/s] 95%|█████████▌| 21/22 [00:04<00:00,  1.75it/s]100%|██████████| 22/22 [00:05<00:00,  1.58it/s]100%|██████████| 22/22 [00:05<00:00,  3.77it/s]
2025-03-09 09:52:22,481 [INFO]: 	Computing best hyperparameters for index knn.index 03/09/2025, 09:52:22
2025-03-09 09:53:13,892 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 51.4107 secs
2025-03-09 09:53:13,893 [INFO]: The best hyperparameters are: efSearch=253
2025-03-09 09:53:13,893 [INFO]: 	Compute fast metrics 03/09/2025, 09:53:13
  0%|          | 0/4 [00:00<?, ?it/s] 25%|██▌       | 1/4 [00:00<00:00,  5.09it/s] 50%|█████     | 2/4 [00:00<00:00,  7.11it/s] 75%|███████▌  | 3/4 [00:00<00:00,  8.08it/s] 75%|███████▌  | 3/4 [00:00<00:00,  5.95it/s]
2025-03-09 09:53:38,376 [INFO]: 	>>> Finished "Compute fast metrics" in 24.4836 secs
2025-03-09 09:53:38,377 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 81.7433 secs
2025-03-09 09:53:38,377 [INFO]: {
2025-03-09 09:53:38,377 [INFO]: 	index_key: HNSW15
2025-03-09 09:53:38,377 [INFO]: 	index_param: efSearch=253
2025-03-09 09:53:38,377 [INFO]: 	index_path: knn.index
2025-03-09 09:53:38,377 [INFO]: 	size in bytes: 1046088430
2025-03-09 09:53:38,377 [INFO]: 	avg_search_speed_ms: 10.39864429758703
2025-03-09 09:53:38,377 [INFO]: 	99p_search_speed_ms: 17.617517034523186
2025-03-09 09:53:38,377 [INFO]: 	reconstruction error %: 0.0
2025-03-09 09:53:38,377 [INFO]: 	nb vectors: 5317
2025-03-09 09:53:38,377 [INFO]: 	vectors dimension: 49152
2025-03-09 09:53:38,377 [INFO]: 	compression ratio: 0.9993081904175156
2025-03-09 09:53:38,377 [INFO]: }
2025-03-09 09:53:38,377 [INFO]: 	>>> Finished "Creating the index" in 81.7465 secs
2025-03-09 09:53:38,377 [INFO]: >>> Finished "Launching the whole pipeline" in 82.4661 secs
2025-03-09 09:53:40: [retrieval_preprocessing] calculating distances ...
2025-03-09 09:53:41: [retrieval_preprocessing] finished and saved retrieval indices for episode 17692 [episode count 13/20]
[retrieval_preprocessing] for episode 22429 [episode count 14/20], we have num_retrieval=np.int64(5279) num_query=np.int64(359)
2025-03-09 09:53:43,556 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-09 09:53:44,417 [INFO]: Launching the whole pipeline 03/09/2025, 09:53:44
2025-03-09 09:53:44,417 [INFO]: Reading total number of vectors and dimension 03/09/2025, 09:53:44
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1530.21it/s]
2025-03-09 09:53:44,443 [INFO]: There are 5279 embeddings of dim 49152
2025-03-09 09:53:44,443 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0259 secs
2025-03-09 09:53:44,443 [INFO]: 	Compute estimated construction time of the index 03/09/2025, 09:53:44
2025-03-09 09:53:44,443 [INFO]: 		-> Train: 16.7 minutes
2025-03-09 09:53:44,443 [INFO]: 		-> Add: 2.9 seconds
2025-03-09 09:53:44,443 [INFO]: 		Total: 16.7 minutes
2025-03-09 09:53:44,443 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0001 secs
2025-03-09 09:53:44,443 [INFO]: 	Checking that your have enough memory available to create the index 03/09/2025, 09:53:44
2025-03-09 09:53:44,444 [INFO]: 1.1GB of memory will be needed to build the index (more might be used if you have more)
2025-03-09 09:53:44,444 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0002 secs
2025-03-09 09:53:44,444 [INFO]: 	Selecting most promising index types given data characteristics 03/09/2025, 09:53:44
2025-03-09 09:53:44,444 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-09 09:53:44,444 [INFO]: 	Creating the index 03/09/2025, 09:53:44
2025-03-09 09:53:44,444 [INFO]: 		-> Instanciate the index HNSW15 03/09/2025, 09:53:44
2025-03-09 09:53:44,445 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0010 secs
2025-03-09 09:53:44,445 [INFO]: 		-> Adding the vectors to the index 03/09/2025, 09:53:44
2025-03-09 09:53:44,445 [INFO]: The memory available for adding the vectors is 49.0GB(total available - used by the index)
2025-03-09 09:53:44,445 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/22 [00:00<?, ?it/s]  5%|▍         | 1/22 [00:00<00:03,  5.54it/s]  9%|▉         | 2/22 [00:00<00:02,  7.40it/s] 14%|█▎        | 3/22 [00:00<00:02,  8.02it/s] 18%|█▊        | 4/22 [00:00<00:02,  8.67it/s] 23%|██▎       | 5/22 [00:00<00:01,  9.06it/s] 27%|██▋       | 6/22 [00:00<00:01,  9.13it/s] 32%|███▏      | 7/22 [00:00<00:01,  9.12it/s] 36%|███▋      | 8/22 [00:00<00:01,  9.19it/s] 41%|████      | 9/22 [00:01<00:01,  9.25it/s] 45%|████▌     | 10/22 [00:01<00:01,  9.02it/s] 50%|█████     | 11/22 [00:01<00:01,  8.16it/s] 55%|█████▍    | 12/22 [00:01<00:01,  8.53it/s] 59%|█████▉    | 13/22 [00:01<00:01,  8.84it/s] 64%|██████▎   | 14/22 [00:01<00:00,  9.02it/s] 68%|██████▊   | 15/22 [00:01<00:00,  9.22it/s] 73%|███████▎  | 16/22 [00:01<00:00,  9.31it/s] 77%|███████▋  | 17/22 [00:01<00:00,  9.39it/s] 82%|████████▏ | 18/22 [00:02<00:00,  9.50it/s] 86%|████████▋ | 19/22 [00:02<00:00,  9.48it/s] 91%|█████████ | 20/22 [00:02<00:00,  9.57it/s] 95%|█████████▌| 21/22 [00:06<00:01,  1.26s/it]100%|██████████| 22/22 [00:07<00:00,  1.17s/it]100%|██████████| 22/22 [00:07<00:00,  3.08it/s]
2025-03-09 09:53:51,591 [INFO]: 	Computing best hyperparameters for index knn.index 03/09/2025, 09:53:51
2025-03-09 09:54:47,705 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 56.1130 secs
2025-03-09 09:54:47,705 [INFO]: The best hyperparameters are: efSearch=213
2025-03-09 09:54:47,705 [INFO]: 	Compute fast metrics 03/09/2025, 09:54:47
  0%|          | 0/4 [00:00<?, ?it/s] 25%|██▌       | 1/4 [00:00<00:00,  5.26it/s] 50%|█████     | 2/4 [00:00<00:00,  6.99it/s] 75%|███████▌  | 3/4 [00:00<00:00,  7.68it/s] 75%|███████▌  | 3/4 [00:00<00:00,  5.83it/s]
2025-03-09 09:55:11,465 [INFO]: 	>>> Finished "Compute fast metrics" in 23.7596 secs
2025-03-09 09:55:11,465 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 87.0203 secs
2025-03-09 09:55:11,465 [INFO]: {
2025-03-09 09:55:11,465 [INFO]: 	index_key: HNSW15
2025-03-09 09:55:11,465 [INFO]: 	index_param: efSearch=213
2025-03-09 09:55:11,465 [INFO]: 	index_path: knn.index
2025-03-09 09:55:11,465 [INFO]: 	size in bytes: 1038612070
2025-03-09 09:55:11,465 [INFO]: 	avg_search_speed_ms: 10.028753133533652
2025-03-09 09:55:11,465 [INFO]: 	99p_search_speed_ms: 18.449713261798017
2025-03-09 09:55:11,465 [INFO]: 	reconstruction error %: 0.0
2025-03-09 09:55:11,465 [INFO]: 	nb vectors: 5279
2025-03-09 09:55:11,465 [INFO]: 	vectors dimension: 49152
2025-03-09 09:55:11,465 [INFO]: 	compression ratio: 0.9993082710852763
2025-03-09 09:55:11,465 [INFO]: }
2025-03-09 09:55:11,465 [INFO]: 	>>> Finished "Creating the index" in 87.0218 secs
2025-03-09 09:55:11,466 [INFO]: >>> Finished "Launching the whole pipeline" in 87.0484 secs
2025-03-09 09:55:13: [retrieval_preprocessing] calculating distances ...
2025-03-09 09:55:14: [retrieval_preprocessing] finished and saved retrieval indices for episode 22429 [episode count 14/20]
[retrieval_preprocessing] for episode 36763 [episode count 15/20], we have num_retrieval=np.int64(5390) num_query=np.int64(248)
2025-03-09 09:55:15,860 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-09 09:55:16,530 [INFO]: Launching the whole pipeline 03/09/2025, 09:55:16
2025-03-09 09:55:16,530 [INFO]: Reading total number of vectors and dimension 03/09/2025, 09:55:16
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1834.78it/s]
2025-03-09 09:55:16,560 [INFO]: There are 5390 embeddings of dim 49152
2025-03-09 09:55:16,560 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0302 secs
2025-03-09 09:55:16,561 [INFO]: 	Compute estimated construction time of the index 03/09/2025, 09:55:16
2025-03-09 09:55:16,561 [INFO]: 		-> Train: 16.7 minutes
2025-03-09 09:55:16,561 [INFO]: 		-> Add: 3.0 seconds
2025-03-09 09:55:16,561 [INFO]: 		Total: 16.7 minutes
2025-03-09 09:55:16,561 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0003 secs
2025-03-09 09:55:16,561 [INFO]: 	Checking that your have enough memory available to create the index 03/09/2025, 09:55:16
2025-03-09 09:55:16,561 [INFO]: 1.1GB of memory will be needed to build the index (more might be used if you have more)
2025-03-09 09:55:16,562 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0004 secs
2025-03-09 09:55:16,562 [INFO]: 	Selecting most promising index types given data characteristics 03/09/2025, 09:55:16
2025-03-09 09:55:16,562 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-09 09:55:16,562 [INFO]: 	Creating the index 03/09/2025, 09:55:16
2025-03-09 09:55:16,562 [INFO]: 		-> Instanciate the index HNSW15 03/09/2025, 09:55:16
2025-03-09 09:55:16,565 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0031 secs
2025-03-09 09:55:16,566 [INFO]: 		-> Adding the vectors to the index 03/09/2025, 09:55:16
2025-03-09 09:55:16,566 [INFO]: The memory available for adding the vectors is 49.0GB(total available - used by the index)
2025-03-09 09:55:16,566 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/23 [00:00<?, ?it/s]  4%|▍         | 1/23 [00:00<00:04,  5.27it/s] 13%|█▎        | 3/23 [00:00<00:02,  8.48it/s] 22%|██▏       | 5/23 [00:00<00:01,  9.22it/s] 30%|███       | 7/23 [00:00<00:01,  9.60it/s] 35%|███▍      | 8/23 [00:00<00:01,  9.66it/s] 43%|████▎     | 10/23 [00:01<00:01,  9.85it/s] 48%|████▊     | 11/23 [00:01<00:01,  9.87it/s] 52%|█████▏    | 12/23 [00:01<00:01,  9.79it/s] 57%|█████▋    | 13/23 [00:01<00:01,  9.72it/s] 61%|██████    | 14/23 [00:01<00:00,  9.77it/s] 78%|███████▊  | 18/23 [00:01<00:00, 17.25it/s] 87%|████████▋ | 20/23 [00:01<00:00, 16.81it/s] 96%|█████████▌| 22/23 [00:05<00:00,  1.59it/s]100%|██████████| 23/23 [00:06<00:00,  3.49it/s]
2025-03-09 09:55:23,156 [INFO]: 	Computing best hyperparameters for index knn.index 03/09/2025, 09:55:23
2025-03-09 09:56:20,984 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 57.8261 secs
2025-03-09 09:56:20,984 [INFO]: The best hyperparameters are: efSearch=194
2025-03-09 09:56:20,984 [INFO]: 	Compute fast metrics 03/09/2025, 09:56:20
  0%|          | 0/4 [00:00<?, ?it/s] 50%|█████     | 2/4 [00:00<00:00, 19.00it/s] 75%|███████▌  | 3/4 [00:00<00:00, 17.78it/s]
2025-03-09 09:56:40,123 [INFO]: 	>>> Finished "Compute fast metrics" in 19.1382 secs
2025-03-09 09:56:40,124 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 83.5578 secs
2025-03-09 09:56:40,124 [INFO]: {
2025-03-09 09:56:40,124 [INFO]: 	index_key: HNSW15
2025-03-09 09:56:40,124 [INFO]: 	index_param: efSearch=194
2025-03-09 09:56:40,124 [INFO]: 	index_path: knn.index
2025-03-09 09:56:40,124 [INFO]: 	size in bytes: 1060450930
2025-03-09 09:56:40,124 [INFO]: 	avg_search_speed_ms: 8.55681123797542
2025-03-09 09:56:40,124 [INFO]: 	99p_search_speed_ms: 22.32576130889356
2025-03-09 09:56:40,124 [INFO]: 	reconstruction error %: 0.0
2025-03-09 09:56:40,124 [INFO]: 	nb vectors: 5390
2025-03-09 09:56:40,124 [INFO]: 	vectors dimension: 49152
2025-03-09 09:56:40,124 [INFO]: 	compression ratio: 0.9993080207869685
2025-03-09 09:56:40,124 [INFO]: }
2025-03-09 09:56:40,124 [INFO]: 	>>> Finished "Creating the index" in 83.5621 secs
2025-03-09 09:56:40,124 [INFO]: >>> Finished "Launching the whole pipeline" in 83.5940 secs
2025-03-09 09:56:41: [retrieval_preprocessing] calculating distances ...
2025-03-09 09:56:42: [retrieval_preprocessing] finished and saved retrieval indices for episode 36763 [episode count 15/20]
[retrieval_preprocessing] for episode 2463 [episode count 16/20], we have num_retrieval=np.int64(5391) num_query=np.int64(247)
2025-03-09 09:56:43,052 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-09 09:56:43,900 [INFO]: Launching the whole pipeline 03/09/2025, 09:56:43
2025-03-09 09:56:43,900 [INFO]: Reading total number of vectors and dimension 03/09/2025, 09:56:43
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1363.11it/s]
2025-03-09 09:56:43,935 [INFO]: There are 5391 embeddings of dim 49152
2025-03-09 09:56:43,936 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0357 secs
2025-03-09 09:56:43,936 [INFO]: 	Compute estimated construction time of the index 03/09/2025, 09:56:43
2025-03-09 09:56:43,936 [INFO]: 		-> Train: 16.7 minutes
2025-03-09 09:56:43,936 [INFO]: 		-> Add: 3.0 seconds
2025-03-09 09:56:43,936 [INFO]: 		Total: 16.7 minutes
2025-03-09 09:56:43,936 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0002 secs
2025-03-09 09:56:43,936 [INFO]: 	Checking that your have enough memory available to create the index 03/09/2025, 09:56:43
2025-03-09 09:56:43,936 [INFO]: 1.1GB of memory will be needed to build the index (more might be used if you have more)
2025-03-09 09:56:43,937 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0003 secs
2025-03-09 09:56:43,937 [INFO]: 	Selecting most promising index types given data characteristics 03/09/2025, 09:56:43
2025-03-09 09:56:43,937 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-09 09:56:43,937 [INFO]: 	Creating the index 03/09/2025, 09:56:43
2025-03-09 09:56:43,937 [INFO]: 		-> Instanciate the index HNSW15 03/09/2025, 09:56:43
2025-03-09 09:56:43,938 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0014 secs
2025-03-09 09:56:43,938 [INFO]: 		-> Adding the vectors to the index 03/09/2025, 09:56:43
2025-03-09 09:56:43,938 [INFO]: The memory available for adding the vectors is 49.0GB(total available - used by the index)
2025-03-09 09:56:43,938 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/23 [00:00<?, ?it/s]  9%|▊         | 2/23 [00:00<00:01, 17.68it/s] 35%|███▍      | 8/23 [00:00<00:00, 38.88it/s] 57%|█████▋    | 13/23 [00:00<00:00, 43.03it/s] 78%|███████▊  | 18/23 [00:00<00:00, 41.36it/s]100%|██████████| 23/23 [00:05<00:00,  2.62it/s]100%|██████████| 23/23 [00:05<00:00,  4.25it/s]
2025-03-09 09:56:49,349 [INFO]: 	Computing best hyperparameters for index knn.index 03/09/2025, 09:56:49
2025-03-09 09:57:34,846 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 45.4965 secs
2025-03-09 09:57:34,846 [INFO]: The best hyperparameters are: efSearch=185
2025-03-09 09:57:34,846 [INFO]: 	Compute fast metrics 03/09/2025, 09:57:34
  0%|          | 0/4 [00:00<?, ?it/s] 50%|█████     | 2/4 [00:00<00:00, 18.69it/s] 75%|███████▌  | 3/4 [00:00<00:00, 20.22it/s]
2025-03-09 09:57:51,350 [INFO]: 	>>> Finished "Compute fast metrics" in 16.5036 secs
2025-03-09 09:57:51,351 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 67.4127 secs
2025-03-09 09:57:51,351 [INFO]: {
2025-03-09 09:57:51,351 [INFO]: 	index_key: HNSW15
2025-03-09 09:57:51,351 [INFO]: 	index_param: efSearch=185
2025-03-09 09:57:51,351 [INFO]: 	index_path: knn.index
2025-03-09 09:57:51,351 [INFO]: 	size in bytes: 1060647670
2025-03-09 09:57:51,351 [INFO]: 	avg_search_speed_ms: 9.407609746277137
2025-03-09 09:57:51,351 [INFO]: 	99p_search_speed_ms: 18.935605227015888
2025-03-09 09:57:51,351 [INFO]: 	reconstruction error %: 0.0
2025-03-09 09:57:51,351 [INFO]: 	nb vectors: 5391
2025-03-09 09:57:51,351 [INFO]: 	vectors dimension: 49152
2025-03-09 09:57:51,351 [INFO]: 	compression ratio: 0.9993080246902348
2025-03-09 09:57:51,351 [INFO]: }
2025-03-09 09:57:51,351 [INFO]: 	>>> Finished "Creating the index" in 67.4146 secs
2025-03-09 09:57:51,351 [INFO]: >>> Finished "Launching the whole pipeline" in 67.4513 secs
2025-03-09 09:57:52: [retrieval_preprocessing] calculating distances ...
2025-03-09 09:57:53: [retrieval_preprocessing] finished and saved retrieval indices for episode 2463 [episode count 16/20]
[retrieval_preprocessing] for episode 5920 [episode count 17/20], we have num_retrieval=np.int64(5324) num_query=np.int64(314)
2025-03-09 09:57:53,549 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-09 09:57:54,183 [INFO]: Launching the whole pipeline 03/09/2025, 09:57:54
2025-03-09 09:57:54,183 [INFO]: Reading total number of vectors and dimension 03/09/2025, 09:57:54
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1560.38it/s]
2025-03-09 09:57:54,212 [INFO]: There are 5324 embeddings of dim 49152
2025-03-09 09:57:54,213 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0291 secs
2025-03-09 09:57:54,213 [INFO]: 	Compute estimated construction time of the index 03/09/2025, 09:57:54
2025-03-09 09:57:54,213 [INFO]: 		-> Train: 16.7 minutes
2025-03-09 09:57:54,213 [INFO]: 		-> Add: 2.9 seconds
2025-03-09 09:57:54,213 [INFO]: 		Total: 16.7 minutes
2025-03-09 09:57:54,213 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0001 secs
2025-03-09 09:57:54,213 [INFO]: 	Checking that your have enough memory available to create the index 03/09/2025, 09:57:54
2025-03-09 09:57:54,213 [INFO]: 1.1GB of memory will be needed to build the index (more might be used if you have more)
2025-03-09 09:57:54,213 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0001 secs
2025-03-09 09:57:54,213 [INFO]: 	Selecting most promising index types given data characteristics 03/09/2025, 09:57:54
2025-03-09 09:57:54,213 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-09 09:57:54,213 [INFO]: 	Creating the index 03/09/2025, 09:57:54
2025-03-09 09:57:54,213 [INFO]: 		-> Instanciate the index HNSW15 03/09/2025, 09:57:54
2025-03-09 09:57:54,214 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0009 secs
2025-03-09 09:57:54,214 [INFO]: 		-> Adding the vectors to the index 03/09/2025, 09:57:54
2025-03-09 09:57:54,214 [INFO]: The memory available for adding the vectors is 49.0GB(total available - used by the index)
2025-03-09 09:57:54,214 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/22 [00:00<?, ?it/s]  9%|▉         | 2/22 [00:00<00:01, 16.74it/s] 41%|████      | 9/22 [00:00<00:00, 41.97it/s] 73%|███████▎  | 16/22 [00:00<00:00, 50.14it/s]100%|██████████| 22/22 [00:04<00:00,  3.17it/s]100%|██████████| 22/22 [00:04<00:00,  4.49it/s]
2025-03-09 09:57:59,122 [INFO]: 	Computing best hyperparameters for index knn.index 03/09/2025, 09:57:59
2025-03-09 09:58:55,539 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 56.4155 secs
2025-03-09 09:58:55,539 [INFO]: The best hyperparameters are: efSearch=206
2025-03-09 09:58:55,539 [INFO]: 	Compute fast metrics 03/09/2025, 09:58:55
  0%|          | 0/4 [00:00<?, ?it/s] 50%|█████     | 2/4 [00:00<00:00, 16.90it/s] 75%|███████▌  | 3/4 [00:00<00:00, 18.19it/s]
2025-03-09 09:59:14,110 [INFO]: 	>>> Finished "Compute fast metrics" in 18.5704 secs
2025-03-09 09:59:14,111 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 79.8964 secs
2025-03-09 09:59:14,111 [INFO]: {
2025-03-09 09:59:14,111 [INFO]: 	index_key: HNSW15
2025-03-09 09:59:14,111 [INFO]: 	index_param: efSearch=206
2025-03-09 09:59:14,111 [INFO]: 	index_path: knn.index
2025-03-09 09:59:14,111 [INFO]: 	size in bytes: 1047465670
2025-03-09 09:59:14,111 [INFO]: 	avg_search_speed_ms: 10.333433421857825
2025-03-09 09:59:14,111 [INFO]: 	99p_search_speed_ms: 22.230678088963046
2025-03-09 09:59:14,111 [INFO]: 	reconstruction error %: 0.0
2025-03-09 09:59:14,111 [INFO]: 	nb vectors: 5324
2025-03-09 09:59:14,111 [INFO]: 	vectors dimension: 49152
2025-03-09 09:59:14,111 [INFO]: 	compression ratio: 0.9993081606197175
2025-03-09 09:59:14,111 [INFO]: }
2025-03-09 09:59:14,111 [INFO]: 	>>> Finished "Creating the index" in 79.8978 secs
2025-03-09 09:59:14,111 [INFO]: >>> Finished "Launching the whole pipeline" in 79.9275 secs
2025-03-09 09:59:15: [retrieval_preprocessing] calculating distances ...
2025-03-09 09:59:16: [retrieval_preprocessing] finished and saved retrieval indices for episode 5920 [episode count 17/20]
[retrieval_preprocessing] for episode 63387 [episode count 18/20], we have num_retrieval=np.int64(5302) num_query=np.int64(336)
2025-03-09 09:59:17,076 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-09 09:59:17,797 [INFO]: Launching the whole pipeline 03/09/2025, 09:59:17
2025-03-09 09:59:17,797 [INFO]: Reading total number of vectors and dimension 03/09/2025, 09:59:17
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 2046.00it/s]
2025-03-09 09:59:17,829 [INFO]: There are 5302 embeddings of dim 49152
2025-03-09 09:59:17,830 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0324 secs
2025-03-09 09:59:17,830 [INFO]: 	Compute estimated construction time of the index 03/09/2025, 09:59:17
2025-03-09 09:59:17,830 [INFO]: 		-> Train: 16.7 minutes
2025-03-09 09:59:17,830 [INFO]: 		-> Add: 2.9 seconds
2025-03-09 09:59:17,831 [INFO]: 		Total: 16.7 minutes
2025-03-09 09:59:17,831 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0004 secs
2025-03-09 09:59:17,831 [INFO]: 	Checking that your have enough memory available to create the index 03/09/2025, 09:59:17
2025-03-09 09:59:17,831 [INFO]: 1.1GB of memory will be needed to build the index (more might be used if you have more)
2025-03-09 09:59:17,831 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0005 secs
2025-03-09 09:59:17,831 [INFO]: 	Selecting most promising index types given data characteristics 03/09/2025, 09:59:17
2025-03-09 09:59:17,831 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-09 09:59:17,832 [INFO]: 	Creating the index 03/09/2025, 09:59:17
2025-03-09 09:59:17,832 [INFO]: 		-> Instanciate the index HNSW15 03/09/2025, 09:59:17
2025-03-09 09:59:17,835 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0028 secs
2025-03-09 09:59:17,835 [INFO]: 		-> Adding the vectors to the index 03/09/2025, 09:59:17
2025-03-09 09:59:17,835 [INFO]: The memory available for adding the vectors is 49.0GB(total available - used by the index)
2025-03-09 09:59:17,835 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/22 [00:00<?, ?it/s]  9%|▉         | 2/22 [00:00<00:01, 19.30it/s] 36%|███▋      | 8/22 [00:00<00:00, 38.98it/s] 64%|██████▎   | 14/22 [00:00<00:00, 45.58it/s] 86%|████████▋ | 19/22 [00:00<00:00, 42.99it/s]100%|██████████| 22/22 [00:04<00:00,  4.56it/s]
2025-03-09 09:59:22,670 [INFO]: 	Computing best hyperparameters for index knn.index 03/09/2025, 09:59:22
2025-03-09 10:00:19,569 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 56.8989 secs
2025-03-09 10:00:19,569 [INFO]: The best hyperparameters are: efSearch=210
2025-03-09 10:00:19,569 [INFO]: 	Compute fast metrics 03/09/2025, 10:00:19
  0%|          | 0/4 [00:00<?, ?it/s] 50%|█████     | 2/4 [00:00<00:00, 17.45it/s] 75%|███████▌  | 3/4 [00:00<00:00, 18.75it/s]
2025-03-09 10:00:39,863 [INFO]: 	>>> Finished "Compute fast metrics" in 20.2934 secs
2025-03-09 10:00:39,863 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 82.0283 secs
2025-03-09 10:00:39,864 [INFO]: {
2025-03-09 10:00:39,864 [INFO]: 	index_key: HNSW15
2025-03-09 10:00:39,864 [INFO]: 	index_param: efSearch=210
2025-03-09 10:00:39,864 [INFO]: 	index_path: knn.index
2025-03-09 10:00:39,864 [INFO]: 	size in bytes: 1043137210
2025-03-09 10:00:39,864 [INFO]: 	avg_search_speed_ms: 10.276429458279143
2025-03-09 10:00:39,864 [INFO]: 	99p_search_speed_ms: 23.72583055868745
2025-03-09 10:00:39,864 [INFO]: 	reconstruction error %: 0.0
2025-03-09 10:00:39,864 [INFO]: 	nb vectors: 5302
2025-03-09 10:00:39,864 [INFO]: 	vectors dimension: 49152
2025-03-09 10:00:39,864 [INFO]: 	compression ratio: 0.9993082463236068
2025-03-09 10:00:39,864 [INFO]: }
2025-03-09 10:00:39,864 [INFO]: 	>>> Finished "Creating the index" in 82.0323 secs
2025-03-09 10:00:39,864 [INFO]: >>> Finished "Launching the whole pipeline" in 82.0666 secs
2025-03-09 10:00:41: [retrieval_preprocessing] calculating distances ...
2025-03-09 10:00:42: [retrieval_preprocessing] finished and saved retrieval indices for episode 63387 [episode count 18/20]
[retrieval_preprocessing] for episode 64414 [episode count 19/20], we have num_retrieval=np.int64(5411) num_query=np.int64(227)
2025-03-09 10:00:43,008 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-09 10:00:43,841 [INFO]: Launching the whole pipeline 03/09/2025, 10:00:43
2025-03-09 10:00:43,841 [INFO]: Reading total number of vectors and dimension 03/09/2025, 10:00:43
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1492.63it/s]
2025-03-09 10:00:43,868 [INFO]: There are 5411 embeddings of dim 49152
2025-03-09 10:00:43,868 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0276 secs
2025-03-09 10:00:43,868 [INFO]: 	Compute estimated construction time of the index 03/09/2025, 10:00:43
2025-03-09 10:00:43,869 [INFO]: 		-> Train: 16.7 minutes
2025-03-09 10:00:43,869 [INFO]: 		-> Add: 3.0 seconds
2025-03-09 10:00:43,869 [INFO]: 		Total: 16.7 minutes
2025-03-09 10:00:43,869 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0001 secs
2025-03-09 10:00:43,869 [INFO]: 	Checking that your have enough memory available to create the index 03/09/2025, 10:00:43
2025-03-09 10:00:43,869 [INFO]: 1.1GB of memory will be needed to build the index (more might be used if you have more)
2025-03-09 10:00:43,869 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0002 secs
2025-03-09 10:00:43,869 [INFO]: 	Selecting most promising index types given data characteristics 03/09/2025, 10:00:43
2025-03-09 10:00:43,869 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-09 10:00:43,869 [INFO]: 	Creating the index 03/09/2025, 10:00:43
2025-03-09 10:00:43,869 [INFO]: 		-> Instanciate the index HNSW15 03/09/2025, 10:00:43
2025-03-09 10:00:43,870 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0012 secs
2025-03-09 10:00:43,870 [INFO]: 		-> Adding the vectors to the index 03/09/2025, 10:00:43
2025-03-09 10:00:43,870 [INFO]: The memory available for adding the vectors is 49.0GB(total available - used by the index)
2025-03-09 10:00:43,870 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/23 [00:00<?, ?it/s]  9%|▊         | 2/23 [00:00<00:01, 17.48it/s] 35%|███▍      | 8/23 [00:00<00:00, 41.01it/s] 61%|██████    | 14/23 [00:00<00:00, 49.05it/s] 87%|████████▋ | 20/23 [00:00<00:00, 50.69it/s]100%|██████████| 23/23 [00:04<00:00,  4.74it/s]
2025-03-09 10:00:48,730 [INFO]: 	Computing best hyperparameters for index knn.index 03/09/2025, 10:00:48
2025-03-09 10:01:30,008 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 41.2772 secs
2025-03-09 10:01:30,008 [INFO]: The best hyperparameters are: efSearch=236
2025-03-09 10:01:30,008 [INFO]: 	Compute fast metrics 03/09/2025, 10:01:30
  0%|          | 0/4 [00:00<?, ?it/s] 50%|█████     | 2/4 [00:00<00:00, 18.92it/s] 75%|███████▌  | 3/4 [00:00<00:00, 20.97it/s]
2025-03-09 10:01:50,838 [INFO]: 	>>> Finished "Compute fast metrics" in 20.8302 secs
2025-03-09 10:01:50,839 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 66.9690 secs
2025-03-09 10:01:50,839 [INFO]: {
2025-03-09 10:01:50,840 [INFO]: 	index_key: HNSW15
2025-03-09 10:01:50,840 [INFO]: 	index_param: efSearch=236
2025-03-09 10:01:50,840 [INFO]: 	index_path: knn.index
2025-03-09 10:01:50,840 [INFO]: 	size in bytes: 1064582590
2025-03-09 10:01:50,840 [INFO]: 	avg_search_speed_ms: 9.656188570630007
2025-03-09 10:01:50,840 [INFO]: 	99p_search_speed_ms: 16.403933940455346
2025-03-09 10:01:50,840 [INFO]: 	reconstruction error %: 0.0
2025-03-09 10:01:50,840 [INFO]: 	nb vectors: 5411
2025-03-09 10:01:50,840 [INFO]: 	vectors dimension: 49152
2025-03-09 10:01:50,840 [INFO]: 	compression ratio: 0.9993079898103537
2025-03-09 10:01:50,840 [INFO]: }
2025-03-09 10:01:50,840 [INFO]: 	>>> Finished "Creating the index" in 66.9708 secs
2025-03-09 10:01:50,840 [INFO]: >>> Finished "Launching the whole pipeline" in 66.9990 secs
2025-03-09 10:01:53: [retrieval_preprocessing] calculating distances ...
2025-03-09 10:01:54: [retrieval_preprocessing] finished and saved retrieval indices for episode 64414 [episode count 19/20]
2025-03-09 10:01:54: [retrieval_preprocessing] finished for (3951366978, 'lid') [chosen_id count 7/10]
2025-03-09 10:01:55: [retrieval_preprocessing] concatenated all embeddings and indices for 20 episodes for (5059283044, 'drawer') [chosen_id count 8/10]
2025-03-09 10:01:55: [retrieval_preprocessing] we have num_total=3362 embedding_dim=49152
[retrieval_preprocessing] for episode 58369 [episode count 0/20], we have num_retrieval=np.int64(3239) num_query=np.int64(123)
2025-03-09 10:01:56,163 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-09 10:01:56,945 [INFO]: Launching the whole pipeline 03/09/2025, 10:01:56
2025-03-09 10:01:56,945 [INFO]: Reading total number of vectors and dimension 03/09/2025, 10:01:56
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1515.83it/s]
2025-03-09 10:01:56,979 [INFO]: There are 3239 embeddings of dim 49152
2025-03-09 10:01:56,979 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0344 secs
2025-03-09 10:01:56,979 [INFO]: 	Compute estimated construction time of the index 03/09/2025, 10:01:56
2025-03-09 10:01:56,980 [INFO]: 		-> Train: 16.7 minutes
2025-03-09 10:01:56,980 [INFO]: 		-> Add: 1.8 seconds
2025-03-09 10:01:56,980 [INFO]: 		Total: 16.7 minutes
2025-03-09 10:01:56,980 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0001 secs
2025-03-09 10:01:56,980 [INFO]: 	Checking that your have enough memory available to create the index 03/09/2025, 10:01:56
2025-03-09 10:01:56,980 [INFO]: 668.5MB of memory will be needed to build the index (more might be used if you have more)
2025-03-09 10:01:56,980 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0002 secs
2025-03-09 10:01:56,980 [INFO]: 	Selecting most promising index types given data characteristics 03/09/2025, 10:01:56
2025-03-09 10:01:56,980 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-09 10:01:56,980 [INFO]: 	Creating the index 03/09/2025, 10:01:56
2025-03-09 10:01:56,980 [INFO]: 		-> Instanciate the index HNSW15 03/09/2025, 10:01:56
2025-03-09 10:01:56,981 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0013 secs
2025-03-09 10:01:56,981 [INFO]: 		-> Adding the vectors to the index 03/09/2025, 10:01:56
2025-03-09 10:01:56,981 [INFO]: The memory available for adding the vectors is 49.4GB(total available - used by the index)
2025-03-09 10:01:56,982 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/13 [00:00<?, ?it/s]  8%|▊         | 1/13 [00:00<00:01,  9.62it/s] 54%|█████▍    | 7/13 [00:00<00:00, 36.50it/s]100%|██████████| 13/13 [00:02<00:00,  4.38it/s]100%|██████████| 13/13 [00:02<00:00,  5.14it/s]
2025-03-09 10:01:59,515 [INFO]: 	Computing best hyperparameters for index knn.index 03/09/2025, 10:01:59
2025-03-09 10:02:34,012 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 34.4971 secs
2025-03-09 10:02:34,012 [INFO]: The best hyperparameters are: efSearch=272
2025-03-09 10:02:34,012 [INFO]: 	Compute fast metrics 03/09/2025, 10:02:34
  0%|          | 0/4 [00:00<?, ?it/s] 25%|██▌       | 1/4 [00:00<00:00,  3.29it/s] 75%|███████▌  | 3/4 [00:00<00:00,  8.30it/s]
2025-03-09 10:02:49,923 [INFO]: 	>>> Finished "Compute fast metrics" in 15.9105 secs
2025-03-09 10:02:49,925 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 52.9434 secs
2025-03-09 10:02:49,925 [INFO]: {
2025-03-09 10:02:49,925 [INFO]: 	index_key: HNSW15
2025-03-09 10:02:49,925 [INFO]: 	index_param: efSearch=272
2025-03-09 10:02:49,925 [INFO]: 	index_path: knn.index
2025-03-09 10:02:49,925 [INFO]: 	size in bytes: 637253530
2025-03-09 10:02:49,925 [INFO]: 	avg_search_speed_ms: 10.42142031074036
2025-03-09 10:02:49,925 [INFO]: 	99p_search_speed_ms: 21.41266121063379
2025-03-09 10:02:49,925 [INFO]: 	reconstruction error %: 0.0
2025-03-09 10:02:49,925 [INFO]: 	nb vectors: 3239
2025-03-09 10:02:49,925 [INFO]: 	vectors dimension: 49152
2025-03-09 10:02:49,925 [INFO]: 	compression ratio: 0.9993091948819804
2025-03-09 10:02:49,925 [INFO]: }
2025-03-09 10:02:49,925 [INFO]: 	>>> Finished "Creating the index" in 52.9454 secs
2025-03-09 10:02:49,925 [INFO]: >>> Finished "Launching the whole pipeline" in 52.9805 secs
2025-03-09 10:02:50: [retrieval_preprocessing] calculating distances ...
2025-03-09 10:02:51: [retrieval_preprocessing] finished and saved retrieval indices for episode 58369 [episode count 0/20]
[retrieval_preprocessing] for episode 71681 [episode count 1/20], we have num_retrieval=np.int64(3217) num_query=np.int64(145)
2025-03-09 10:02:51,257 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-09 10:02:52,008 [INFO]: Launching the whole pipeline 03/09/2025, 10:02:52
2025-03-09 10:02:52,008 [INFO]: Reading total number of vectors and dimension 03/09/2025, 10:02:52
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1497.97it/s]
2025-03-09 10:02:52,033 [INFO]: There are 3217 embeddings of dim 49152
2025-03-09 10:02:52,033 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0252 secs
2025-03-09 10:02:52,034 [INFO]: 	Compute estimated construction time of the index 03/09/2025, 10:02:52
2025-03-09 10:02:52,034 [INFO]: 		-> Train: 16.7 minutes
2025-03-09 10:02:52,034 [INFO]: 		-> Add: 1.8 seconds
2025-03-09 10:02:52,034 [INFO]: 		Total: 16.7 minutes
2025-03-09 10:02:52,034 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0001 secs
2025-03-09 10:02:52,034 [INFO]: 	Checking that your have enough memory available to create the index 03/09/2025, 10:02:52
2025-03-09 10:02:52,034 [INFO]: 663.9MB of memory will be needed to build the index (more might be used if you have more)
2025-03-09 10:02:52,034 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0001 secs
2025-03-09 10:02:52,034 [INFO]: 	Selecting most promising index types given data characteristics 03/09/2025, 10:02:52
2025-03-09 10:02:52,034 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-09 10:02:52,034 [INFO]: 	Creating the index 03/09/2025, 10:02:52
2025-03-09 10:02:52,034 [INFO]: 		-> Instanciate the index HNSW15 03/09/2025, 10:02:52
2025-03-09 10:02:52,035 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0010 secs
2025-03-09 10:02:52,035 [INFO]: 		-> Adding the vectors to the index 03/09/2025, 10:02:52
2025-03-09 10:02:52,035 [INFO]: The memory available for adding the vectors is 49.4GB(total available - used by the index)
2025-03-09 10:02:52,035 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/13 [00:00<?, ?it/s] 15%|█▌        | 2/13 [00:00<00:00, 17.54it/s] 62%|██████▏   | 8/13 [00:00<00:00, 40.16it/s]100%|██████████| 13/13 [00:02<00:00,  4.26it/s]100%|██████████| 13/13 [00:02<00:00,  5.25it/s]
2025-03-09 10:02:54,516 [INFO]: 	Computing best hyperparameters for index knn.index 03/09/2025, 10:02:54
2025-03-09 10:03:24,862 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 30.3454 secs
2025-03-09 10:03:24,862 [INFO]: The best hyperparameters are: efSearch=250
2025-03-09 10:03:24,862 [INFO]: 	Compute fast metrics 03/09/2025, 10:03:24
  0%|          | 0/4 [00:00<?, ?it/s] 50%|█████     | 2/4 [00:00<00:00, 19.23it/s] 75%|███████▌  | 3/4 [00:00<00:00, 20.48it/s]
2025-03-09 10:03:40,677 [INFO]: 	>>> Finished "Compute fast metrics" in 15.8148 secs
2025-03-09 10:03:40,679 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 48.6436 secs
2025-03-09 10:03:40,679 [INFO]: {
2025-03-09 10:03:40,679 [INFO]: 	index_key: HNSW15
2025-03-09 10:03:40,679 [INFO]: 	index_param: efSearch=250
2025-03-09 10:03:40,679 [INFO]: 	index_path: knn.index
2025-03-09 10:03:40,679 [INFO]: 	size in bytes: 632924770
2025-03-09 10:03:40,679 [INFO]: 	avg_search_speed_ms: 10.665834842891153
2025-03-09 10:03:40,679 [INFO]: 	99p_search_speed_ms: 21.802886435762048
2025-03-09 10:03:40,679 [INFO]: 	reconstruction error %: 0.0
2025-03-09 10:03:40,679 [INFO]: 	nb vectors: 3217
2025-03-09 10:03:40,679 [INFO]: 	vectors dimension: 49152
2025-03-09 10:03:40,679 [INFO]: 	compression ratio: 0.9993098168681248
2025-03-09 10:03:40,679 [INFO]: }
2025-03-09 10:03:40,679 [INFO]: 	>>> Finished "Creating the index" in 48.6452 secs
2025-03-09 10:03:40,679 [INFO]: >>> Finished "Launching the whole pipeline" in 48.6710 secs
2025-03-09 10:03:41: [retrieval_preprocessing] calculating distances ...
2025-03-09 10:03:41: [retrieval_preprocessing] finished and saved retrieval indices for episode 71681 [episode count 1/20]
[retrieval_preprocessing] for episode 36358 [episode count 2/20], we have num_retrieval=np.int64(3213) num_query=np.int64(149)
2025-03-09 10:03:42,211 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-09 10:03:42,596 [INFO]: Launching the whole pipeline 03/09/2025, 10:03:42
2025-03-09 10:03:42,596 [INFO]: Reading total number of vectors and dimension 03/09/2025, 10:03:42
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 2256.22it/s]
2025-03-09 10:03:42,624 [INFO]: There are 3213 embeddings of dim 49152
2025-03-09 10:03:42,625 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0284 secs
2025-03-09 10:03:42,625 [INFO]: 	Compute estimated construction time of the index 03/09/2025, 10:03:42
2025-03-09 10:03:42,625 [INFO]: 		-> Train: 16.7 minutes
2025-03-09 10:03:42,625 [INFO]: 		-> Add: 1.8 seconds
2025-03-09 10:03:42,625 [INFO]: 		Total: 16.7 minutes
2025-03-09 10:03:42,625 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0003 secs
2025-03-09 10:03:42,625 [INFO]: 	Checking that your have enough memory available to create the index 03/09/2025, 10:03:42
2025-03-09 10:03:42,626 [INFO]: 663.1MB of memory will be needed to build the index (more might be used if you have more)
2025-03-09 10:03:42,626 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0004 secs
2025-03-09 10:03:42,626 [INFO]: 	Selecting most promising index types given data characteristics 03/09/2025, 10:03:42
2025-03-09 10:03:42,626 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-09 10:03:42,626 [INFO]: 	Creating the index 03/09/2025, 10:03:42
2025-03-09 10:03:42,626 [INFO]: 		-> Instanciate the index HNSW15 03/09/2025, 10:03:42
2025-03-09 10:03:42,629 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0026 secs
2025-03-09 10:03:42,629 [INFO]: 		-> Adding the vectors to the index 03/09/2025, 10:03:42
2025-03-09 10:03:42,630 [INFO]: The memory available for adding the vectors is 49.4GB(total available - used by the index)
2025-03-09 10:03:42,630 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/13 [00:00<?, ?it/s] 23%|██▎       | 3/13 [00:00<00:00, 24.29it/s] 69%|██████▉   | 9/13 [00:00<00:00, 40.52it/s]100%|██████████| 13/13 [00:02<00:00,  5.13it/s]
2025-03-09 10:03:45,168 [INFO]: 	Computing best hyperparameters for index knn.index 03/09/2025, 10:03:45
2025-03-09 10:04:16,005 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 30.8365 secs
2025-03-09 10:04:16,005 [INFO]: The best hyperparameters are: efSearch=244
2025-03-09 10:04:16,005 [INFO]: 	Compute fast metrics 03/09/2025, 10:04:16
  0%|          | 0/4 [00:00<?, ?it/s] 50%|█████     | 2/4 [00:00<00:00, 19.33it/s] 75%|███████▌  | 3/4 [00:00<00:00, 21.24it/s]
2025-03-09 10:04:31,310 [INFO]: 	>>> Finished "Compute fast metrics" in 15.3051 secs
2025-03-09 10:04:31,312 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 48.6828 secs
2025-03-09 10:04:31,312 [INFO]: {
2025-03-09 10:04:31,312 [INFO]: 	index_key: HNSW15
2025-03-09 10:04:31,312 [INFO]: 	index_param: efSearch=244
2025-03-09 10:04:31,312 [INFO]: 	index_path: knn.index
2025-03-09 10:04:31,312 [INFO]: 	size in bytes: 632137810
2025-03-09 10:04:31,312 [INFO]: 	avg_search_speed_ms: 10.290352247009599
2025-03-09 10:04:31,313 [INFO]: 	99p_search_speed_ms: 21.092694471590217
2025-03-09 10:04:31,313 [INFO]: 	reconstruction error %: 0.0
2025-03-09 10:04:31,313 [INFO]: 	nb vectors: 3213
2025-03-09 10:04:31,313 [INFO]: 	vectors dimension: 49152
2025-03-09 10:04:31,313 [INFO]: 	compression ratio: 0.9993097929073409
2025-03-09 10:04:31,313 [INFO]: }
2025-03-09 10:04:31,313 [INFO]: 	>>> Finished "Creating the index" in 48.6863 secs
2025-03-09 10:04:31,313 [INFO]: >>> Finished "Launching the whole pipeline" in 48.7165 secs
2025-03-09 10:04:32: [retrieval_preprocessing] calculating distances ...
2025-03-09 10:04:32: [retrieval_preprocessing] finished and saved retrieval indices for episode 36358 [episode count 2/20]
[retrieval_preprocessing] for episode 12822 [episode count 3/20], we have num_retrieval=np.int64(3095) num_query=np.int64(267)
2025-03-09 10:04:32,864 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-09 10:04:33,262 [INFO]: Launching the whole pipeline 03/09/2025, 10:04:33
2025-03-09 10:04:33,262 [INFO]: Reading total number of vectors and dimension 03/09/2025, 10:04:33
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1572.67it/s]
2025-03-09 10:04:33,286 [INFO]: There are 3095 embeddings of dim 49152
2025-03-09 10:04:33,286 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0240 secs
2025-03-09 10:04:33,286 [INFO]: 	Compute estimated construction time of the index 03/09/2025, 10:04:33
2025-03-09 10:04:33,286 [INFO]: 		-> Train: 16.7 minutes
2025-03-09 10:04:33,286 [INFO]: 		-> Add: 1.7 seconds
2025-03-09 10:04:33,286 [INFO]: 		Total: 16.7 minutes
2025-03-09 10:04:33,286 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0001 secs
2025-03-09 10:04:33,286 [INFO]: 	Checking that your have enough memory available to create the index 03/09/2025, 10:04:33
2025-03-09 10:04:33,286 [INFO]: 638.7MB of memory will be needed to build the index (more might be used if you have more)
2025-03-09 10:04:33,286 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0001 secs
2025-03-09 10:04:33,286 [INFO]: 	Selecting most promising index types given data characteristics 03/09/2025, 10:04:33
2025-03-09 10:04:33,286 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-09 10:04:33,286 [INFO]: 	Creating the index 03/09/2025, 10:04:33
2025-03-09 10:04:33,286 [INFO]: 		-> Instanciate the index HNSW15 03/09/2025, 10:04:33
2025-03-09 10:04:33,287 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0010 secs
2025-03-09 10:04:33,288 [INFO]: 		-> Adding the vectors to the index 03/09/2025, 10:04:33
2025-03-09 10:04:33,288 [INFO]: The memory available for adding the vectors is 49.4GB(total available - used by the index)
2025-03-09 10:04:33,288 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/13 [00:00<?, ?it/s] 15%|█▌        | 2/13 [00:00<00:00, 19.46it/s] 62%|██████▏   | 8/13 [00:00<00:00, 41.54it/s]100%|██████████| 13/13 [00:02<00:00,  4.23it/s]100%|██████████| 13/13 [00:02<00:00,  5.21it/s]
2025-03-09 10:04:35,786 [INFO]: 	Computing best hyperparameters for index knn.index 03/09/2025, 10:04:35
2025-03-09 10:05:04,344 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 28.5573 secs
2025-03-09 10:05:04,344 [INFO]: The best hyperparameters are: efSearch=160
2025-03-09 10:05:04,344 [INFO]: 	Compute fast metrics 03/09/2025, 10:05:04
  0%|          | 0/4 [00:00<?, ?it/s] 75%|███████▌  | 3/4 [00:00<00:00, 27.02it/s] 75%|███████▌  | 3/4 [00:00<00:00, 23.26it/s]
2025-03-09 10:05:21,802 [INFO]: 	>>> Finished "Compute fast metrics" in 17.4573 secs
2025-03-09 10:05:21,803 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 48.5157 secs
2025-03-09 10:05:21,803 [INFO]: {
2025-03-09 10:05:21,804 [INFO]: 	index_key: HNSW15
2025-03-09 10:05:21,804 [INFO]: 	index_param: efSearch=160
2025-03-09 10:05:21,804 [INFO]: 	index_path: knn.index
2025-03-09 10:05:21,804 [INFO]: 	size in bytes: 608922070
2025-03-09 10:05:21,804 [INFO]: 	avg_search_speed_ms: 7.059336545789744
2025-03-09 10:05:21,804 [INFO]: 	99p_search_speed_ms: 11.324420962482685
2025-03-09 10:05:21,804 [INFO]: 	reconstruction error %: 0.0
2025-03-09 10:05:21,804 [INFO]: 	nb vectors: 3095
2025-03-09 10:05:21,804 [INFO]: 	vectors dimension: 49152
2025-03-09 10:05:21,804 [INFO]: 	compression ratio: 0.9993097474689988
2025-03-09 10:05:21,804 [INFO]: }
2025-03-09 10:05:21,804 [INFO]: 	>>> Finished "Creating the index" in 48.5172 secs
2025-03-09 10:05:21,804 [INFO]: >>> Finished "Launching the whole pipeline" in 48.5418 secs
2025-03-09 10:05:22: [retrieval_preprocessing] calculating distances ...
2025-03-09 10:05:23: [retrieval_preprocessing] finished and saved retrieval indices for episode 12822 [episode count 3/20]
[retrieval_preprocessing] for episode 54294 [episode count 4/20], we have num_retrieval=np.int64(3209) num_query=np.int64(153)
2025-03-09 10:05:23,467 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-09 10:05:23,857 [INFO]: Launching the whole pipeline 03/09/2025, 10:05:23
2025-03-09 10:05:23,857 [INFO]: Reading total number of vectors and dimension 03/09/2025, 10:05:23
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 2235.77it/s]
2025-03-09 10:05:23,883 [INFO]: There are 3209 embeddings of dim 49152
2025-03-09 10:05:23,883 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0258 secs
2025-03-09 10:05:23,883 [INFO]: 	Compute estimated construction time of the index 03/09/2025, 10:05:23
2025-03-09 10:05:23,883 [INFO]: 		-> Train: 16.7 minutes
2025-03-09 10:05:23,883 [INFO]: 		-> Add: 1.8 seconds
2025-03-09 10:05:23,883 [INFO]: 		Total: 16.7 minutes
2025-03-09 10:05:23,883 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0001 secs
2025-03-09 10:05:23,883 [INFO]: 	Checking that your have enough memory available to create the index 03/09/2025, 10:05:23
2025-03-09 10:05:23,883 [INFO]: 662.3MB of memory will be needed to build the index (more might be used if you have more)
2025-03-09 10:05:23,883 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0001 secs
2025-03-09 10:05:23,883 [INFO]: 	Selecting most promising index types given data characteristics 03/09/2025, 10:05:23
2025-03-09 10:05:23,883 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-09 10:05:23,883 [INFO]: 	Creating the index 03/09/2025, 10:05:23
2025-03-09 10:05:23,883 [INFO]: 		-> Instanciate the index HNSW15 03/09/2025, 10:05:23
2025-03-09 10:05:23,884 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0010 secs
2025-03-09 10:05:23,884 [INFO]: 		-> Adding the vectors to the index 03/09/2025, 10:05:23
2025-03-09 10:05:23,884 [INFO]: The memory available for adding the vectors is 49.4GB(total available - used by the index)
2025-03-09 10:05:23,885 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/13 [00:00<?, ?it/s]  8%|▊         | 1/13 [00:00<00:01,  9.91it/s] 54%|█████▍    | 7/13 [00:00<00:00, 36.05it/s] 92%|█████████▏| 12/13 [00:00<00:00, 39.66it/s]100%|██████████| 13/13 [00:02<00:00,  5.04it/s]
2025-03-09 10:05:26,468 [INFO]: 	Computing best hyperparameters for index knn.index 03/09/2025, 10:05:26
2025-03-09 10:05:55,622 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 29.1538 secs
2025-03-09 10:05:55,622 [INFO]: The best hyperparameters are: efSearch=253
2025-03-09 10:05:55,622 [INFO]: 	Compute fast metrics 03/09/2025, 10:05:55
  0%|          | 0/4 [00:00<?, ?it/s] 75%|███████▌  | 3/4 [00:00<00:00, 25.89it/s] 75%|███████▌  | 3/4 [00:00<00:00, 22.36it/s]
2025-03-09 10:06:11,477 [INFO]: 	>>> Finished "Compute fast metrics" in 15.8547 secs
2025-03-09 10:06:11,479 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 47.5944 secs
2025-03-09 10:06:11,479 [INFO]: {
2025-03-09 10:06:11,479 [INFO]: 	index_key: HNSW15
2025-03-09 10:06:11,479 [INFO]: 	index_param: efSearch=253
2025-03-09 10:06:11,479 [INFO]: 	index_path: knn.index
2025-03-09 10:06:11,479 [INFO]: 	size in bytes: 631350850
2025-03-09 10:06:11,479 [INFO]: 	avg_search_speed_ms: 9.467961438614028
2025-03-09 10:06:11,479 [INFO]: 	99p_search_speed_ms: 15.049590857233854
2025-03-09 10:06:11,479 [INFO]: 	reconstruction error %: 0.0
2025-03-09 10:06:11,479 [INFO]: 	nb vectors: 3209
2025-03-09 10:06:11,479 [INFO]: 	vectors dimension: 49152
2025-03-09 10:06:11,479 [INFO]: 	compression ratio: 0.9993097688868242
2025-03-09 10:06:11,479 [INFO]: }
2025-03-09 10:06:11,479 [INFO]: 	>>> Finished "Creating the index" in 47.5959 secs
2025-03-09 10:06:11,479 [INFO]: >>> Finished "Launching the whole pipeline" in 47.6223 secs
2025-03-09 10:06:12: [retrieval_preprocessing] calculating distances ...
2025-03-09 10:06:12: [retrieval_preprocessing] finished and saved retrieval indices for episode 54294 [episode count 4/20]
[retrieval_preprocessing] for episode 39963 [episode count 5/20], we have num_retrieval=np.int64(3194) num_query=np.int64(168)
2025-03-09 10:06:13,125 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-09 10:06:13,542 [INFO]: Launching the whole pipeline 03/09/2025, 10:06:13
2025-03-09 10:06:13,542 [INFO]: Reading total number of vectors and dimension 03/09/2025, 10:06:13
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1918.71it/s]
2025-03-09 10:06:13,567 [INFO]: There are 3194 embeddings of dim 49152
2025-03-09 10:06:13,567 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0245 secs
2025-03-09 10:06:13,567 [INFO]: 	Compute estimated construction time of the index 03/09/2025, 10:06:13
2025-03-09 10:06:13,567 [INFO]: 		-> Train: 16.7 minutes
2025-03-09 10:06:13,567 [INFO]: 		-> Add: 1.8 seconds
2025-03-09 10:06:13,567 [INFO]: 		Total: 16.7 minutes
2025-03-09 10:06:13,567 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0001 secs
2025-03-09 10:06:13,567 [INFO]: 	Checking that your have enough memory available to create the index 03/09/2025, 10:06:13
2025-03-09 10:06:13,567 [INFO]: 659.2MB of memory will be needed to build the index (more might be used if you have more)
2025-03-09 10:06:13,567 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0001 secs
2025-03-09 10:06:13,568 [INFO]: 	Selecting most promising index types given data characteristics 03/09/2025, 10:06:13
2025-03-09 10:06:13,568 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-09 10:06:13,568 [INFO]: 	Creating the index 03/09/2025, 10:06:13
2025-03-09 10:06:13,568 [INFO]: 		-> Instanciate the index HNSW15 03/09/2025, 10:06:13
2025-03-09 10:06:13,569 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0010 secs
2025-03-09 10:06:13,569 [INFO]: 		-> Adding the vectors to the index 03/09/2025, 10:06:13
2025-03-09 10:06:13,569 [INFO]: The memory available for adding the vectors is 49.4GB(total available - used by the index)
2025-03-09 10:06:13,569 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/13 [00:00<?, ?it/s] 15%|█▌        | 2/13 [00:00<00:00, 18.33it/s] 62%|██████▏   | 8/13 [00:00<00:00, 40.26it/s]100%|██████████| 13/13 [00:02<00:00,  4.24it/s]100%|██████████| 13/13 [00:02<00:00,  5.22it/s]
2025-03-09 10:06:16,065 [INFO]: 	Computing best hyperparameters for index knn.index 03/09/2025, 10:06:16
2025-03-09 10:06:47,224 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 31.1583 secs
2025-03-09 10:06:47,224 [INFO]: The best hyperparameters are: efSearch=257
2025-03-09 10:06:47,224 [INFO]: 	Compute fast metrics 03/09/2025, 10:06:47
  0%|          | 0/4 [00:00<?, ?it/s] 50%|█████     | 2/4 [00:00<00:00, 19.54it/s] 75%|███████▌  | 3/4 [00:00<00:00, 21.79it/s]
2025-03-09 10:07:02,663 [INFO]: 	>>> Finished "Compute fast metrics" in 15.4384 secs
2025-03-09 10:07:02,711 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 49.1421 secs
2025-03-09 10:07:02,711 [INFO]: {
2025-03-09 10:07:02,711 [INFO]: 	index_key: HNSW15
2025-03-09 10:07:02,711 [INFO]: 	index_param: efSearch=257
2025-03-09 10:07:02,711 [INFO]: 	index_path: knn.index
2025-03-09 10:07:02,711 [INFO]: 	size in bytes: 628399690
2025-03-09 10:07:02,711 [INFO]: 	avg_search_speed_ms: 10.860858275529795
2025-03-09 10:07:02,712 [INFO]: 	99p_search_speed_ms: 24.09435138106345
2025-03-09 10:07:02,712 [INFO]: 	reconstruction error %: 0.0
2025-03-09 10:07:02,712 [INFO]: 	nb vectors: 3194
2025-03-09 10:07:02,712 [INFO]: 	vectors dimension: 49152
2025-03-09 10:07:02,712 [INFO]: 	compression ratio: 0.9993097736887808
2025-03-09 10:07:02,712 [INFO]: }
2025-03-09 10:07:02,712 [INFO]: 	>>> Finished "Creating the index" in 49.1441 secs
2025-03-09 10:07:02,712 [INFO]: >>> Finished "Launching the whole pipeline" in 49.1693 secs
2025-03-09 10:07:04: [retrieval_preprocessing] calculating distances ...
2025-03-09 10:07:04: [retrieval_preprocessing] finished and saved retrieval indices for episode 39963 [episode count 5/20]
[retrieval_preprocessing] for episode 36893 [episode count 6/20], we have num_retrieval=np.int64(3118) num_query=np.int64(244)
2025-03-09 10:07:04,943 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-09 10:07:05,311 [INFO]: Launching the whole pipeline 03/09/2025, 10:07:05
2025-03-09 10:07:05,311 [INFO]: Reading total number of vectors and dimension 03/09/2025, 10:07:05
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1872.46it/s]
2025-03-09 10:07:05,339 [INFO]: There are 3118 embeddings of dim 49152
2025-03-09 10:07:05,339 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0281 secs
2025-03-09 10:07:05,339 [INFO]: 	Compute estimated construction time of the index 03/09/2025, 10:07:05
2025-03-09 10:07:05,339 [INFO]: 		-> Train: 16.7 minutes
2025-03-09 10:07:05,339 [INFO]: 		-> Add: 1.7 seconds
2025-03-09 10:07:05,340 [INFO]: 		Total: 16.7 minutes
2025-03-09 10:07:05,340 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0001 secs
2025-03-09 10:07:05,340 [INFO]: 	Checking that your have enough memory available to create the index 03/09/2025, 10:07:05
2025-03-09 10:07:05,340 [INFO]: 643.5MB of memory will be needed to build the index (more might be used if you have more)
2025-03-09 10:07:05,340 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0001 secs
2025-03-09 10:07:05,340 [INFO]: 	Selecting most promising index types given data characteristics 03/09/2025, 10:07:05
2025-03-09 10:07:05,340 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-09 10:07:05,340 [INFO]: 	Creating the index 03/09/2025, 10:07:05
2025-03-09 10:07:05,340 [INFO]: 		-> Instanciate the index HNSW15 03/09/2025, 10:07:05
2025-03-09 10:07:05,341 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0009 secs
2025-03-09 10:07:05,341 [INFO]: 		-> Adding the vectors to the index 03/09/2025, 10:07:05
2025-03-09 10:07:05,341 [INFO]: The memory available for adding the vectors is 49.4GB(total available - used by the index)
2025-03-09 10:07:05,341 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/13 [00:00<?, ?it/s]  8%|▊         | 1/13 [00:00<00:01,  8.08it/s] 54%|█████▍    | 7/13 [00:00<00:00, 35.27it/s]100%|██████████| 13/13 [00:02<00:00,  4.15it/s]100%|██████████| 13/13 [00:02<00:00,  4.86it/s]
2025-03-09 10:07:08,018 [INFO]: 	Computing best hyperparameters for index knn.index 03/09/2025, 10:07:08
2025-03-09 10:07:36,253 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 28.2352 secs
2025-03-09 10:07:36,254 [INFO]: The best hyperparameters are: efSearch=278
2025-03-09 10:07:36,254 [INFO]: 	Compute fast metrics 03/09/2025, 10:07:36
  0%|          | 0/4 [00:00<?, ?it/s] 75%|███████▌  | 3/4 [00:00<00:00, 26.08it/s] 75%|███████▌  | 3/4 [00:00<00:00, 22.47it/s]
2025-03-09 10:07:48,475 [INFO]: 	>>> Finished "Compute fast metrics" in 12.2211 secs
2025-03-09 10:07:48,477 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 43.1358 secs
2025-03-09 10:07:48,477 [INFO]: {
2025-03-09 10:07:48,477 [INFO]: 	index_key: HNSW15
2025-03-09 10:07:48,477 [INFO]: 	index_param: efSearch=278
2025-03-09 10:07:48,477 [INFO]: 	index_path: knn.index
2025-03-09 10:07:48,477 [INFO]: 	size in bytes: 613447150
2025-03-09 10:07:48,477 [INFO]: 	avg_search_speed_ms: 10.48054254005626
2025-03-09 10:07:48,477 [INFO]: 	99p_search_speed_ms: 18.309648002032198
2025-03-09 10:07:48,477 [INFO]: 	reconstruction error %: 0.0
2025-03-09 10:07:48,477 [INFO]: 	nb vectors: 3118
2025-03-09 10:07:48,477 [INFO]: 	vectors dimension: 49152
2025-03-09 10:07:48,477 [INFO]: 	compression ratio: 0.999309792212744
2025-03-09 10:07:48,477 [INFO]: }
2025-03-09 10:07:48,477 [INFO]: 	>>> Finished "Creating the index" in 43.1371 secs
2025-03-09 10:07:48,477 [INFO]: >>> Finished "Launching the whole pipeline" in 43.1657 secs
2025-03-09 10:07:50: [retrieval_preprocessing] calculating distances ...
2025-03-09 10:07:50: [retrieval_preprocessing] finished and saved retrieval indices for episode 36893 [episode count 6/20]
[retrieval_preprocessing] for episode 91172 [episode count 7/20], we have num_retrieval=np.int64(3217) num_query=np.int64(145)
2025-03-09 10:07:50,859 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-09 10:07:51,260 [INFO]: Launching the whole pipeline 03/09/2025, 10:07:51
2025-03-09 10:07:51,260 [INFO]: Reading total number of vectors and dimension 03/09/2025, 10:07:51
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 2023.30it/s]
2025-03-09 10:07:51,283 [INFO]: There are 3217 embeddings of dim 49152
2025-03-09 10:07:51,283 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0224 secs
2025-03-09 10:07:51,283 [INFO]: 	Compute estimated construction time of the index 03/09/2025, 10:07:51
2025-03-09 10:07:51,283 [INFO]: 		-> Train: 16.7 minutes
2025-03-09 10:07:51,284 [INFO]: 		-> Add: 1.8 seconds
2025-03-09 10:07:51,284 [INFO]: 		Total: 16.7 minutes
2025-03-09 10:07:51,284 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0005 secs
2025-03-09 10:07:51,284 [INFO]: 	Checking that your have enough memory available to create the index 03/09/2025, 10:07:51
2025-03-09 10:07:51,284 [INFO]: 663.9MB of memory will be needed to build the index (more might be used if you have more)
2025-03-09 10:07:51,284 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0005 secs
2025-03-09 10:07:51,285 [INFO]: 	Selecting most promising index types given data characteristics 03/09/2025, 10:07:51
2025-03-09 10:07:51,285 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-09 10:07:51,285 [INFO]: 	Creating the index 03/09/2025, 10:07:51
2025-03-09 10:07:51,285 [INFO]: 		-> Instanciate the index HNSW15 03/09/2025, 10:07:51
2025-03-09 10:07:51,288 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0026 secs
2025-03-09 10:07:51,288 [INFO]: 		-> Adding the vectors to the index 03/09/2025, 10:07:51
2025-03-09 10:07:51,288 [INFO]: The memory available for adding the vectors is 49.4GB(total available - used by the index)
2025-03-09 10:07:51,289 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/13 [00:00<?, ?it/s]  8%|▊         | 1/13 [00:00<00:01,  9.55it/s] 54%|█████▍    | 7/13 [00:00<00:00, 37.46it/s]100%|██████████| 13/13 [00:02<00:00,  4.08it/s]100%|██████████| 13/13 [00:02<00:00,  4.80it/s]
2025-03-09 10:07:54,007 [INFO]: 	Computing best hyperparameters for index knn.index 03/09/2025, 10:07:54
2025-03-09 10:08:23,659 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 29.6512 secs
2025-03-09 10:08:23,659 [INFO]: The best hyperparameters are: efSearch=287
2025-03-09 10:08:23,659 [INFO]: 	Compute fast metrics 03/09/2025, 10:08:23
  0%|          | 0/4 [00:00<?, ?it/s] 50%|█████     | 2/4 [00:00<00:00, 18.97it/s] 75%|███████▌  | 3/4 [00:00<00:00, 21.19it/s]
2025-03-09 10:08:38,234 [INFO]: 	>>> Finished "Compute fast metrics" in 14.5751 secs
2025-03-09 10:08:38,236 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 46.9478 secs
2025-03-09 10:08:38,236 [INFO]: {
2025-03-09 10:08:38,236 [INFO]: 	index_key: HNSW15
2025-03-09 10:08:38,236 [INFO]: 	index_param: efSearch=287
2025-03-09 10:08:38,236 [INFO]: 	index_path: knn.index
2025-03-09 10:08:38,236 [INFO]: 	size in bytes: 632924770
2025-03-09 10:08:38,236 [INFO]: 	avg_search_speed_ms: 10.570754924194443
2025-03-09 10:08:38,236 [INFO]: 	99p_search_speed_ms: 17.799143120646477
2025-03-09 10:08:38,236 [INFO]: 	reconstruction error %: 0.0
2025-03-09 10:08:38,236 [INFO]: 	nb vectors: 3217
2025-03-09 10:08:38,236 [INFO]: 	vectors dimension: 49152
2025-03-09 10:08:38,236 [INFO]: 	compression ratio: 0.9993098168681248
2025-03-09 10:08:38,236 [INFO]: }
2025-03-09 10:08:38,236 [INFO]: 	>>> Finished "Creating the index" in 46.9514 secs
2025-03-09 10:08:38,236 [INFO]: >>> Finished "Launching the whole pipeline" in 46.9759 secs
2025-03-09 10:08:39: [retrieval_preprocessing] calculating distances ...
2025-03-09 10:08:39: [retrieval_preprocessing] finished and saved retrieval indices for episode 91172 [episode count 7/20]
[retrieval_preprocessing] for episode 76843 [episode count 8/20], we have num_retrieval=np.int64(3174) num_query=np.int64(188)
2025-03-09 10:08:39,846 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-09 10:08:40,293 [INFO]: Launching the whole pipeline 03/09/2025, 10:08:40
2025-03-09 10:08:40,294 [INFO]: Reading total number of vectors and dimension 03/09/2025, 10:08:40
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1575.62it/s]
2025-03-09 10:08:40,323 [INFO]: There are 3174 embeddings of dim 49152
2025-03-09 10:08:40,324 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0300 secs
2025-03-09 10:08:40,324 [INFO]: 	Compute estimated construction time of the index 03/09/2025, 10:08:40
2025-03-09 10:08:40,324 [INFO]: 		-> Train: 16.7 minutes
2025-03-09 10:08:40,324 [INFO]: 		-> Add: 1.7 seconds
2025-03-09 10:08:40,324 [INFO]: 		Total: 16.7 minutes
2025-03-09 10:08:40,324 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0001 secs
2025-03-09 10:08:40,324 [INFO]: 	Checking that your have enough memory available to create the index 03/09/2025, 10:08:40
2025-03-09 10:08:40,324 [INFO]: 655.0MB of memory will be needed to build the index (more might be used if you have more)
2025-03-09 10:08:40,324 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0002 secs
2025-03-09 10:08:40,324 [INFO]: 	Selecting most promising index types given data characteristics 03/09/2025, 10:08:40
2025-03-09 10:08:40,324 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-09 10:08:40,324 [INFO]: 	Creating the index 03/09/2025, 10:08:40
2025-03-09 10:08:40,324 [INFO]: 		-> Instanciate the index HNSW15 03/09/2025, 10:08:40
2025-03-09 10:08:40,325 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0011 secs
2025-03-09 10:08:40,325 [INFO]: 		-> Adding the vectors to the index 03/09/2025, 10:08:40
2025-03-09 10:08:40,325 [INFO]: The memory available for adding the vectors is 49.4GB(total available - used by the index)
2025-03-09 10:08:40,326 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/13 [00:00<?, ?it/s]  8%|▊         | 1/13 [00:00<00:01,  8.83it/s] 46%|████▌     | 6/13 [00:00<00:00, 31.19it/s] 85%|████████▍ | 11/13 [00:00<00:00, 39.00it/s]100%|██████████| 13/13 [00:02<00:00,  4.43it/s]
2025-03-09 10:08:43,265 [INFO]: 	Computing best hyperparameters for index knn.index 03/09/2025, 10:08:43
2025-03-09 10:09:12,337 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 29.0717 secs
2025-03-09 10:09:12,337 [INFO]: The best hyperparameters are: efSearch=290
2025-03-09 10:09:12,338 [INFO]: 	Compute fast metrics 03/09/2025, 10:09:12
  0%|          | 0/4 [00:00<?, ?it/s] 75%|███████▌  | 3/4 [00:00<00:00, 25.86it/s] 75%|███████▌  | 3/4 [00:00<00:00, 21.70it/s]
2025-03-09 10:09:27,091 [INFO]: 	>>> Finished "Compute fast metrics" in 14.7539 secs
2025-03-09 10:09:27,093 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 46.7679 secs
2025-03-09 10:09:27,093 [INFO]: {
2025-03-09 10:09:27,093 [INFO]: 	index_key: HNSW15
2025-03-09 10:09:27,093 [INFO]: 	index_param: efSearch=290
2025-03-09 10:09:27,093 [INFO]: 	index_path: knn.index
2025-03-09 10:09:27,093 [INFO]: 	size in bytes: 624464830
2025-03-09 10:09:27,093 [INFO]: 	avg_search_speed_ms: 10.13933393384498
2025-03-09 10:09:27,093 [INFO]: 	99p_search_speed_ms: 15.32152269501239
2025-03-09 10:09:27,093 [INFO]: 	reconstruction error %: 0.0
2025-03-09 10:09:27,093 [INFO]: 	nb vectors: 3174
2025-03-09 10:09:27,093 [INFO]: 	vectors dimension: 49152
2025-03-09 10:09:27,093 [INFO]: 	compression ratio: 0.9993097481566736
2025-03-09 10:09:27,093 [INFO]: }
2025-03-09 10:09:27,094 [INFO]: 	>>> Finished "Creating the index" in 46.7694 secs
2025-03-09 10:09:27,094 [INFO]: >>> Finished "Launching the whole pipeline" in 46.8000 secs
2025-03-09 10:09:28: [retrieval_preprocessing] calculating distances ...
2025-03-09 10:09:28: [retrieval_preprocessing] finished and saved retrieval indices for episode 76843 [episode count 8/20]
[retrieval_preprocessing] for episode 79919 [episode count 9/20], we have num_retrieval=np.int64(3125) num_query=np.int64(237)
2025-03-09 10:09:29,080 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-09 10:09:29,440 [INFO]: Launching the whole pipeline 03/09/2025, 10:09:29
2025-03-09 10:09:29,440 [INFO]: Reading total number of vectors and dimension 03/09/2025, 10:09:29
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 2317.30it/s]
2025-03-09 10:09:29,464 [INFO]: There are 3125 embeddings of dim 49152
2025-03-09 10:09:29,464 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0239 secs
2025-03-09 10:09:29,464 [INFO]: 	Compute estimated construction time of the index 03/09/2025, 10:09:29
2025-03-09 10:09:29,464 [INFO]: 		-> Train: 16.7 minutes
2025-03-09 10:09:29,464 [INFO]: 		-> Add: 1.7 seconds
2025-03-09 10:09:29,464 [INFO]: 		Total: 16.7 minutes
2025-03-09 10:09:29,464 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0001 secs
2025-03-09 10:09:29,465 [INFO]: 	Checking that your have enough memory available to create the index 03/09/2025, 10:09:29
2025-03-09 10:09:29,465 [INFO]: 644.9MB of memory will be needed to build the index (more might be used if you have more)
2025-03-09 10:09:29,465 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0001 secs
2025-03-09 10:09:29,465 [INFO]: 	Selecting most promising index types given data characteristics 03/09/2025, 10:09:29
2025-03-09 10:09:29,465 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-09 10:09:29,465 [INFO]: 	Creating the index 03/09/2025, 10:09:29
2025-03-09 10:09:29,465 [INFO]: 		-> Instanciate the index HNSW15 03/09/2025, 10:09:29
2025-03-09 10:09:29,466 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0008 secs
2025-03-09 10:09:29,466 [INFO]: 		-> Adding the vectors to the index 03/09/2025, 10:09:29
2025-03-09 10:09:29,466 [INFO]: The memory available for adding the vectors is 49.4GB(total available - used by the index)
2025-03-09 10:09:29,466 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/13 [00:00<?, ?it/s] 15%|█▌        | 2/13 [00:00<00:00, 18.34it/s] 62%|██████▏   | 8/13 [00:00<00:00, 40.51it/s]100%|██████████| 13/13 [00:02<00:00,  4.16it/s]100%|██████████| 13/13 [00:02<00:00,  5.13it/s]
2025-03-09 10:09:32,003 [INFO]: 	Computing best hyperparameters for index knn.index 03/09/2025, 10:09:32
2025-03-09 10:10:00,130 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 28.1271 secs
2025-03-09 10:10:00,130 [INFO]: The best hyperparameters are: efSearch=290
2025-03-09 10:10:00,131 [INFO]: 	Compute fast metrics 03/09/2025, 10:10:00
  0%|          | 0/4 [00:00<?, ?it/s] 75%|███████▌  | 3/4 [00:00<00:00, 27.70it/s] 75%|███████▌  | 3/4 [00:00<00:00, 23.82it/s]
2025-03-09 10:10:13,468 [INFO]: 	>>> Finished "Compute fast metrics" in 13.3372 secs
2025-03-09 10:10:13,470 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 44.0037 secs
2025-03-09 10:10:13,470 [INFO]: {
2025-03-09 10:10:13,470 [INFO]: 	index_key: HNSW15
2025-03-09 10:10:13,470 [INFO]: 	index_param: efSearch=290
2025-03-09 10:10:13,470 [INFO]: 	index_path: knn.index
2025-03-09 10:10:13,470 [INFO]: 	size in bytes: 614824510
2025-03-09 10:10:13,470 [INFO]: 	avg_search_speed_ms: 9.754189591082495
2025-03-09 10:10:13,470 [INFO]: 	99p_search_speed_ms: 13.518235720694065
2025-03-09 10:10:13,470 [INFO]: 	reconstruction error %: 0.0
2025-03-09 10:10:13,470 [INFO]: 	nb vectors: 3125
2025-03-09 10:10:13,470 [INFO]: 	vectors dimension: 49152
2025-03-09 10:10:13,470 [INFO]: 	compression ratio: 0.9993095428157215
2025-03-09 10:10:13,470 [INFO]: }
2025-03-09 10:10:13,470 [INFO]: 	>>> Finished "Creating the index" in 44.0051 secs
2025-03-09 10:10:13,470 [INFO]: >>> Finished "Launching the whole pipeline" in 44.0295 secs
2025-03-09 10:10:14: [retrieval_preprocessing] calculating distances ...
2025-03-09 10:10:15: [retrieval_preprocessing] finished and saved retrieval indices for episode 79919 [episode count 9/20]
[retrieval_preprocessing] for episode 52272 [episode count 10/20], we have num_retrieval=np.int64(3236) num_query=np.int64(126)
2025-03-09 10:10:15,549 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-09 10:10:15,921 [INFO]: Launching the whole pipeline 03/09/2025, 10:10:15
2025-03-09 10:10:15,921 [INFO]: Reading total number of vectors and dimension 03/09/2025, 10:10:15
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1782.53it/s]
2025-03-09 10:10:15,950 [INFO]: There are 3236 embeddings of dim 49152
2025-03-09 10:10:15,951 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0291 secs
2025-03-09 10:10:15,951 [INFO]: 	Compute estimated construction time of the index 03/09/2025, 10:10:15
2025-03-09 10:10:15,951 [INFO]: 		-> Train: 16.7 minutes
2025-03-09 10:10:15,951 [INFO]: 		-> Add: 1.8 seconds
2025-03-09 10:10:15,951 [INFO]: 		Total: 16.7 minutes
2025-03-09 10:10:15,951 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0002 secs
2025-03-09 10:10:15,951 [INFO]: 	Checking that your have enough memory available to create the index 03/09/2025, 10:10:15
2025-03-09 10:10:15,951 [INFO]: 667.8MB of memory will be needed to build the index (more might be used if you have more)
2025-03-09 10:10:15,951 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0002 secs
2025-03-09 10:10:15,951 [INFO]: 	Selecting most promising index types given data characteristics 03/09/2025, 10:10:15
2025-03-09 10:10:15,951 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-09 10:10:15,951 [INFO]: 	Creating the index 03/09/2025, 10:10:15
2025-03-09 10:10:15,951 [INFO]: 		-> Instanciate the index HNSW15 03/09/2025, 10:10:15
2025-03-09 10:10:15,952 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0010 secs
2025-03-09 10:10:15,952 [INFO]: 		-> Adding the vectors to the index 03/09/2025, 10:10:15
2025-03-09 10:10:15,952 [INFO]: The memory available for adding the vectors is 49.4GB(total available - used by the index)
2025-03-09 10:10:15,953 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/13 [00:00<?, ?it/s]  8%|▊         | 1/13 [00:00<00:01,  9.38it/s] 62%|██████▏   | 8/13 [00:00<00:00, 42.82it/s]100%|██████████| 13/13 [00:02<00:00,  4.64it/s]100%|██████████| 13/13 [00:02<00:00,  5.59it/s]
2025-03-09 10:10:18,283 [INFO]: 	Computing best hyperparameters for index knn.index 03/09/2025, 10:10:18
2025-03-09 10:10:47,597 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 29.3134 secs
2025-03-09 10:10:47,597 [INFO]: The best hyperparameters are: efSearch=280
2025-03-09 10:10:47,597 [INFO]: 	Compute fast metrics 03/09/2025, 10:10:47
  0%|          | 0/4 [00:00<?, ?it/s] 75%|███████▌  | 3/4 [00:00<00:00, 26.00it/s] 75%|███████▌  | 3/4 [00:00<00:00, 22.49it/s]
2025-03-09 10:11:03,308 [INFO]: 	>>> Finished "Compute fast metrics" in 15.7105 secs
2025-03-09 10:11:03,309 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 47.3570 secs
2025-03-09 10:11:03,310 [INFO]: {
2025-03-09 10:11:03,310 [INFO]: 	index_key: HNSW15
2025-03-09 10:11:03,310 [INFO]: 	index_param: efSearch=280
2025-03-09 10:11:03,310 [INFO]: 	index_path: knn.index
2025-03-09 10:11:03,310 [INFO]: 	size in bytes: 636663310
2025-03-09 10:11:03,310 [INFO]: 	avg_search_speed_ms: 9.845147026000603
2025-03-09 10:11:03,310 [INFO]: 	99p_search_speed_ms: 14.002144662663344
2025-03-09 10:11:03,310 [INFO]: 	reconstruction error %: 0.0
2025-03-09 10:11:03,310 [INFO]: 	nb vectors: 3236
2025-03-09 10:11:03,310 [INFO]: 	vectors dimension: 49152
2025-03-09 10:11:03,310 [INFO]: 	compression ratio: 0.9993091764625167
2025-03-09 10:11:03,310 [INFO]: }
2025-03-09 10:11:03,310 [INFO]: 	>>> Finished "Creating the index" in 47.3584 secs
2025-03-09 10:11:03,310 [INFO]: >>> Finished "Launching the whole pipeline" in 47.3883 secs
2025-03-09 10:11:04: [retrieval_preprocessing] calculating distances ...
2025-03-09 10:11:04: [retrieval_preprocessing] finished and saved retrieval indices for episode 52272 [episode count 10/20]
[retrieval_preprocessing] for episode 76849 [episode count 11/20], we have num_retrieval=np.int64(3251) num_query=np.int64(111)
2025-03-09 10:11:04,572 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-09 10:11:04,941 [INFO]: Launching the whole pipeline 03/09/2025, 10:11:04
2025-03-09 10:11:04,941 [INFO]: Reading total number of vectors and dimension 03/09/2025, 10:11:04
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 2155.35it/s]
2025-03-09 10:11:04,963 [INFO]: There are 3251 embeddings of dim 49152
2025-03-09 10:11:04,964 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0220 secs
2025-03-09 10:11:04,964 [INFO]: 	Compute estimated construction time of the index 03/09/2025, 10:11:04
2025-03-09 10:11:04,964 [INFO]: 		-> Train: 16.7 minutes
2025-03-09 10:11:04,964 [INFO]: 		-> Add: 1.8 seconds
2025-03-09 10:11:04,964 [INFO]: 		Total: 16.7 minutes
2025-03-09 10:11:04,964 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0001 secs
2025-03-09 10:11:04,964 [INFO]: 	Checking that your have enough memory available to create the index 03/09/2025, 10:11:04
2025-03-09 10:11:04,964 [INFO]: 670.9MB of memory will be needed to build the index (more might be used if you have more)
2025-03-09 10:11:04,964 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0001 secs
2025-03-09 10:11:04,964 [INFO]: 	Selecting most promising index types given data characteristics 03/09/2025, 10:11:04
2025-03-09 10:11:04,964 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-09 10:11:04,964 [INFO]: 	Creating the index 03/09/2025, 10:11:04
2025-03-09 10:11:04,964 [INFO]: 		-> Instanciate the index HNSW15 03/09/2025, 10:11:04
2025-03-09 10:11:04,965 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0010 secs
2025-03-09 10:11:04,965 [INFO]: 		-> Adding the vectors to the index 03/09/2025, 10:11:04
2025-03-09 10:11:04,965 [INFO]: The memory available for adding the vectors is 49.4GB(total available - used by the index)
2025-03-09 10:11:04,965 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/13 [00:00<?, ?it/s] 15%|█▌        | 2/13 [00:00<00:00, 17.87it/s] 69%|██████▉   | 9/13 [00:00<00:00, 45.47it/s]100%|██████████| 13/13 [00:02<00:00,  5.41it/s]
2025-03-09 10:11:07,374 [INFO]: 	Computing best hyperparameters for index knn.index 03/09/2025, 10:11:07
2025-03-09 10:11:35,241 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 27.8669 secs
2025-03-09 10:11:35,241 [INFO]: The best hyperparameters are: efSearch=288
2025-03-09 10:11:35,242 [INFO]: 	Compute fast metrics 03/09/2025, 10:11:35
  0%|          | 0/4 [00:00<?, ?it/s] 75%|███████▌  | 3/4 [00:00<00:00, 26.58it/s] 75%|███████▌  | 3/4 [00:00<00:00, 22.88it/s]
2025-03-09 10:11:49,001 [INFO]: 	>>> Finished "Compute fast metrics" in 13.7596 secs
2025-03-09 10:11:49,003 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 44.0376 secs
2025-03-09 10:11:49,003 [INFO]: {
2025-03-09 10:11:49,003 [INFO]: 	index_key: HNSW15
2025-03-09 10:11:49,003 [INFO]: 	index_param: efSearch=288
2025-03-09 10:11:49,003 [INFO]: 	index_path: knn.index
2025-03-09 10:11:49,003 [INFO]: 	size in bytes: 639614470
2025-03-09 10:11:49,003 [INFO]: 	avg_search_speed_ms: 9.923581153363182
2025-03-09 10:11:49,003 [INFO]: 	99p_search_speed_ms: 14.446000785101203
2025-03-09 10:11:49,003 [INFO]: 	reconstruction error %: 0.0
2025-03-09 10:11:49,003 [INFO]: 	nb vectors: 3251
2025-03-09 10:11:49,003 [INFO]: 	vectors dimension: 49152
2025-03-09 10:11:49,003 [INFO]: 	compression ratio: 0.9993091744781821
2025-03-09 10:11:49,003 [INFO]: }
2025-03-09 10:11:49,003 [INFO]: 	>>> Finished "Creating the index" in 44.0390 secs
2025-03-09 10:11:49,003 [INFO]: >>> Finished "Launching the whole pipeline" in 44.0617 secs
2025-03-09 10:11:49: [retrieval_preprocessing] calculating distances ...
2025-03-09 10:11:49: [retrieval_preprocessing] finished and saved retrieval indices for episode 76849 [episode count 11/20]
[retrieval_preprocessing] for episode 30259 [episode count 12/20], we have num_retrieval=np.int64(3190) num_query=np.int64(172)
2025-03-09 10:11:50,134 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-09 10:11:50,485 [INFO]: Launching the whole pipeline 03/09/2025, 10:11:50
2025-03-09 10:11:50,485 [INFO]: Reading total number of vectors and dimension 03/09/2025, 10:11:50
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 2291.97it/s]
2025-03-09 10:11:50,510 [INFO]: There are 3190 embeddings of dim 49152
2025-03-09 10:11:50,510 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0253 secs
2025-03-09 10:11:50,511 [INFO]: 	Compute estimated construction time of the index 03/09/2025, 10:11:50
2025-03-09 10:11:50,511 [INFO]: 		-> Train: 16.7 minutes
2025-03-09 10:11:50,511 [INFO]: 		-> Add: 1.8 seconds
2025-03-09 10:11:50,511 [INFO]: 		Total: 16.7 minutes
2025-03-09 10:11:50,511 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0001 secs
2025-03-09 10:11:50,511 [INFO]: 	Checking that your have enough memory available to create the index 03/09/2025, 10:11:50
2025-03-09 10:11:50,511 [INFO]: 658.3MB of memory will be needed to build the index (more might be used if you have more)
2025-03-09 10:11:50,511 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0002 secs
2025-03-09 10:11:50,511 [INFO]: 	Selecting most promising index types given data characteristics 03/09/2025, 10:11:50
2025-03-09 10:11:50,511 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-09 10:11:50,511 [INFO]: 	Creating the index 03/09/2025, 10:11:50
2025-03-09 10:11:50,511 [INFO]: 		-> Instanciate the index HNSW15 03/09/2025, 10:11:50
2025-03-09 10:11:50,512 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0009 secs
2025-03-09 10:11:50,512 [INFO]: 		-> Adding the vectors to the index 03/09/2025, 10:11:50
2025-03-09 10:11:50,512 [INFO]: The memory available for adding the vectors is 49.4GB(total available - used by the index)
2025-03-09 10:11:50,512 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/13 [00:00<?, ?it/s] 15%|█▌        | 2/13 [00:00<00:00, 17.48it/s] 62%|██████▏   | 8/13 [00:00<00:00, 40.86it/s]100%|██████████| 13/13 [00:02<00:00,  4.99it/s]100%|██████████| 13/13 [00:02<00:00,  6.10it/s]
2025-03-09 10:11:52,644 [INFO]: 	Computing best hyperparameters for index knn.index 03/09/2025, 10:11:52
2025-03-09 10:12:18,341 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 25.6967 secs
2025-03-09 10:12:18,341 [INFO]: The best hyperparameters are: efSearch=279
2025-03-09 10:12:18,341 [INFO]: 	Compute fast metrics 03/09/2025, 10:12:18
  0%|          | 0/4 [00:00<?, ?it/s] 75%|███████▌  | 3/4 [00:00<00:00, 27.87it/s] 75%|███████▌  | 3/4 [00:00<00:00, 24.29it/s]
2025-03-09 10:12:30,661 [INFO]: 	>>> Finished "Compute fast metrics" in 12.3201 secs
2025-03-09 10:12:30,663 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 40.1512 secs
2025-03-09 10:12:30,663 [INFO]: {
2025-03-09 10:12:30,663 [INFO]: 	index_key: HNSW15
2025-03-09 10:12:30,663 [INFO]: 	index_param: efSearch=279
2025-03-09 10:12:30,663 [INFO]: 	index_path: knn.index
2025-03-09 10:12:30,663 [INFO]: 	size in bytes: 627612730
2025-03-09 10:12:30,663 [INFO]: 	avg_search_speed_ms: 9.381178840094964
2025-03-09 10:12:30,663 [INFO]: 	99p_search_speed_ms: 12.933641544077524
2025-03-09 10:12:30,663 [INFO]: 	reconstruction error %: 0.0
2025-03-09 10:12:30,663 [INFO]: 	nb vectors: 3190
2025-03-09 10:12:30,664 [INFO]: 	vectors dimension: 49152
2025-03-09 10:12:30,664 [INFO]: 	compression ratio: 0.9993097495010976
2025-03-09 10:12:30,664 [INFO]: }
2025-03-09 10:12:30,664 [INFO]: 	>>> Finished "Creating the index" in 40.1525 secs
2025-03-09 10:12:30,664 [INFO]: >>> Finished "Launching the whole pipeline" in 40.1784 secs
2025-03-09 10:12:31: [retrieval_preprocessing] calculating distances ...
2025-03-09 10:12:32: [retrieval_preprocessing] finished and saved retrieval indices for episode 30259 [episode count 12/20]
[retrieval_preprocessing] for episode 42035 [episode count 13/20], we have num_retrieval=np.int64(3224) num_query=np.int64(138)
2025-03-09 10:12:32,231 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-09 10:12:32,607 [INFO]: Launching the whole pipeline 03/09/2025, 10:12:32
2025-03-09 10:12:32,607 [INFO]: Reading total number of vectors and dimension 03/09/2025, 10:12:32
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1492.63it/s]
2025-03-09 10:12:32,633 [INFO]: There are 3224 embeddings of dim 49152
2025-03-09 10:12:32,633 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0256 secs
2025-03-09 10:12:32,633 [INFO]: 	Compute estimated construction time of the index 03/09/2025, 10:12:32
2025-03-09 10:12:32,633 [INFO]: 		-> Train: 16.7 minutes
2025-03-09 10:12:32,633 [INFO]: 		-> Add: 1.8 seconds
2025-03-09 10:12:32,633 [INFO]: 		Total: 16.7 minutes
2025-03-09 10:12:32,633 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0001 secs
2025-03-09 10:12:32,633 [INFO]: 	Checking that your have enough memory available to create the index 03/09/2025, 10:12:32
2025-03-09 10:12:32,634 [INFO]: 665.4MB of memory will be needed to build the index (more might be used if you have more)
2025-03-09 10:12:32,634 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0001 secs
2025-03-09 10:12:32,634 [INFO]: 	Selecting most promising index types given data characteristics 03/09/2025, 10:12:32
2025-03-09 10:12:32,634 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-09 10:12:32,634 [INFO]: 	Creating the index 03/09/2025, 10:12:32
2025-03-09 10:12:32,634 [INFO]: 		-> Instanciate the index HNSW15 03/09/2025, 10:12:32
2025-03-09 10:12:32,635 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0010 secs
2025-03-09 10:12:32,635 [INFO]: 		-> Adding the vectors to the index 03/09/2025, 10:12:32
2025-03-09 10:12:32,635 [INFO]: The memory available for adding the vectors is 49.4GB(total available - used by the index)
2025-03-09 10:12:32,635 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/13 [00:00<?, ?it/s] 23%|██▎       | 3/13 [00:00<00:00, 26.74it/s] 77%|███████▋  | 10/13 [00:00<00:00, 46.92it/s]100%|██████████| 13/13 [00:02<00:00,  5.55it/s]
2025-03-09 10:12:34,980 [INFO]: 	Computing best hyperparameters for index knn.index 03/09/2025, 10:12:34
2025-03-09 10:13:03,206 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 28.2260 secs
2025-03-09 10:13:03,207 [INFO]: The best hyperparameters are: efSearch=283
2025-03-09 10:13:03,207 [INFO]: 	Compute fast metrics 03/09/2025, 10:13:03
  0%|          | 0/4 [00:00<?, ?it/s] 75%|███████▌  | 3/4 [00:00<00:00, 25.70it/s] 75%|███████▌  | 3/4 [00:00<00:00, 22.05it/s]
2025-03-09 10:13:18,454 [INFO]: 	>>> Finished "Compute fast metrics" in 15.2468 secs
2025-03-09 10:13:18,456 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 45.8208 secs
2025-03-09 10:13:18,456 [INFO]: {
2025-03-09 10:13:18,456 [INFO]: 	index_key: HNSW15
2025-03-09 10:13:18,456 [INFO]: 	index_param: efSearch=283
2025-03-09 10:13:18,456 [INFO]: 	index_path: knn.index
2025-03-09 10:13:18,456 [INFO]: 	size in bytes: 634302130
2025-03-09 10:13:18,456 [INFO]: 	avg_search_speed_ms: 9.89827654914617
2025-03-09 10:13:18,456 [INFO]: 	99p_search_speed_ms: 13.082306978758423
2025-03-09 10:13:18,456 [INFO]: 	reconstruction error %: 0.0
2025-03-09 10:13:18,456 [INFO]: 	nb vectors: 3224
2025-03-09 10:13:18,456 [INFO]: 	vectors dimension: 49152
2025-03-09 10:13:18,456 [INFO]: 	compression ratio: 0.9993095750758396
2025-03-09 10:13:18,456 [INFO]: }
2025-03-09 10:13:18,456 [INFO]: 	>>> Finished "Creating the index" in 45.8223 secs
2025-03-09 10:13:18,456 [INFO]: >>> Finished "Launching the whole pipeline" in 45.8486 secs
2025-03-09 10:13:19: [retrieval_preprocessing] calculating distances ...
2025-03-09 10:13:19: [retrieval_preprocessing] finished and saved retrieval indices for episode 42035 [episode count 13/20]
[retrieval_preprocessing] for episode 38454 [episode count 14/20], we have num_retrieval=np.int64(3229) num_query=np.int64(133)
2025-03-09 10:13:19,864 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-09 10:13:20,233 [INFO]: Launching the whole pipeline 03/09/2025, 10:13:20
2025-03-09 10:13:20,233 [INFO]: Reading total number of vectors and dimension 03/09/2025, 10:13:20
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1577.99it/s]
2025-03-09 10:13:20,261 [INFO]: There are 3229 embeddings of dim 49152
2025-03-09 10:13:20,261 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0282 secs
2025-03-09 10:13:20,261 [INFO]: 	Compute estimated construction time of the index 03/09/2025, 10:13:20
2025-03-09 10:13:20,261 [INFO]: 		-> Train: 16.7 minutes
2025-03-09 10:13:20,261 [INFO]: 		-> Add: 1.8 seconds
2025-03-09 10:13:20,261 [INFO]: 		Total: 16.7 minutes
2025-03-09 10:13:20,261 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0002 secs
2025-03-09 10:13:20,261 [INFO]: 	Checking that your have enough memory available to create the index 03/09/2025, 10:13:20
2025-03-09 10:13:20,261 [INFO]: 666.4MB of memory will be needed to build the index (more might be used if you have more)
2025-03-09 10:13:20,261 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0001 secs
2025-03-09 10:13:20,262 [INFO]: 	Selecting most promising index types given data characteristics 03/09/2025, 10:13:20
2025-03-09 10:13:20,262 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-09 10:13:20,262 [INFO]: 	Creating the index 03/09/2025, 10:13:20
2025-03-09 10:13:20,262 [INFO]: 		-> Instanciate the index HNSW15 03/09/2025, 10:13:20
2025-03-09 10:13:20,263 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0011 secs
2025-03-09 10:13:20,263 [INFO]: 		-> Adding the vectors to the index 03/09/2025, 10:13:20
2025-03-09 10:13:20,263 [INFO]: The memory available for adding the vectors is 49.4GB(total available - used by the index)
2025-03-09 10:13:20,263 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/13 [00:00<?, ?it/s] 15%|█▌        | 2/13 [00:00<00:00, 18.12it/s] 62%|██████▏   | 8/13 [00:00<00:00, 41.09it/s]100%|██████████| 13/13 [00:02<00:00,  4.40it/s]100%|██████████| 13/13 [00:02<00:00,  5.41it/s]
2025-03-09 10:13:22,669 [INFO]: 	Computing best hyperparameters for index knn.index 03/09/2025, 10:13:22
2025-03-09 10:13:51,946 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 29.2758 secs
2025-03-09 10:13:51,946 [INFO]: The best hyperparameters are: efSearch=312
2025-03-09 10:13:51,946 [INFO]: 	Compute fast metrics 03/09/2025, 10:13:51
  0%|          | 0/4 [00:00<?, ?it/s] 75%|███████▌  | 3/4 [00:00<00:00, 26.05it/s] 75%|███████▌  | 3/4 [00:00<00:00, 22.29it/s]
2025-03-09 10:14:06,248 [INFO]: 	>>> Finished "Compute fast metrics" in 14.3023 secs
2025-03-09 10:14:06,250 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 45.9875 secs
2025-03-09 10:14:06,251 [INFO]: {
2025-03-09 10:14:06,251 [INFO]: 	index_key: HNSW15
2025-03-09 10:14:06,251 [INFO]: 	index_param: efSearch=312
2025-03-09 10:14:06,251 [INFO]: 	index_path: knn.index
2025-03-09 10:14:06,251 [INFO]: 	size in bytes: 635285950
2025-03-09 10:14:06,251 [INFO]: 	avg_search_speed_ms: 10.998844074052569
2025-03-09 10:14:06,251 [INFO]: 	99p_search_speed_ms: 15.486546717584133
2025-03-09 10:14:06,251 [INFO]: 	reconstruction error %: 0.0
2025-03-09 10:14:06,251 [INFO]: 	nb vectors: 3229
2025-03-09 10:14:06,251 [INFO]: 	vectors dimension: 49152
2025-03-09 10:14:06,251 [INFO]: 	compression ratio: 0.9993094164918963
2025-03-09 10:14:06,251 [INFO]: }
2025-03-09 10:14:06,251 [INFO]: 	>>> Finished "Creating the index" in 45.9891 secs
2025-03-09 10:14:06,251 [INFO]: >>> Finished "Launching the whole pipeline" in 46.0180 secs
2025-03-09 10:14:07: [retrieval_preprocessing] calculating distances ...
2025-03-09 10:14:07: [retrieval_preprocessing] finished and saved retrieval indices for episode 38454 [episode count 14/20]
[retrieval_preprocessing] for episode 70710 [episode count 15/20], we have num_retrieval=np.int64(3165) num_query=np.int64(197)
2025-03-09 10:14:07,878 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-09 10:14:08,338 [INFO]: Launching the whole pipeline 03/09/2025, 10:14:08
2025-03-09 10:14:08,339 [INFO]: Reading total number of vectors and dimension 03/09/2025, 10:14:08
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 2109.81it/s]
2025-03-09 10:14:08,364 [INFO]: There are 3165 embeddings of dim 49152
2025-03-09 10:14:08,364 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0253 secs
2025-03-09 10:14:08,364 [INFO]: 	Compute estimated construction time of the index 03/09/2025, 10:14:08
2025-03-09 10:14:08,364 [INFO]: 		-> Train: 16.7 minutes
2025-03-09 10:14:08,364 [INFO]: 		-> Add: 1.7 seconds
2025-03-09 10:14:08,364 [INFO]: 		Total: 16.7 minutes
2025-03-09 10:14:08,364 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0001 secs
2025-03-09 10:14:08,364 [INFO]: 	Checking that your have enough memory available to create the index 03/09/2025, 10:14:08
2025-03-09 10:14:08,364 [INFO]: 653.2MB of memory will be needed to build the index (more might be used if you have more)
2025-03-09 10:14:08,364 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0001 secs
2025-03-09 10:14:08,364 [INFO]: 	Selecting most promising index types given data characteristics 03/09/2025, 10:14:08
2025-03-09 10:14:08,365 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-09 10:14:08,365 [INFO]: 	Creating the index 03/09/2025, 10:14:08
2025-03-09 10:14:08,365 [INFO]: 		-> Instanciate the index HNSW15 03/09/2025, 10:14:08
2025-03-09 10:14:08,366 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0010 secs
2025-03-09 10:14:08,366 [INFO]: 		-> Adding the vectors to the index 03/09/2025, 10:14:08
2025-03-09 10:14:08,366 [INFO]: The memory available for adding the vectors is 49.4GB(total available - used by the index)
2025-03-09 10:14:08,366 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/13 [00:00<?, ?it/s] 23%|██▎       | 3/13 [00:00<00:00, 26.59it/s] 77%|███████▋  | 10/13 [00:00<00:00, 46.60it/s]100%|██████████| 13/13 [00:02<00:00,  6.02it/s]
2025-03-09 10:14:10,526 [INFO]: 	Computing best hyperparameters for index knn.index 03/09/2025, 10:14:10
2025-03-09 10:14:37,518 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 26.9917 secs
2025-03-09 10:14:37,518 [INFO]: The best hyperparameters are: efSearch=309
2025-03-09 10:14:37,518 [INFO]: 	Compute fast metrics 03/09/2025, 10:14:37
  0%|          | 0/4 [00:00<?, ?it/s] 75%|███████▌  | 3/4 [00:00<00:00, 27.45it/s] 75%|███████▌  | 3/4 [00:00<00:00, 24.65it/s]
2025-03-09 10:14:51,540 [INFO]: 	>>> Finished "Compute fast metrics" in 14.0221 secs
2025-03-09 10:14:51,542 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 43.1762 secs
2025-03-09 10:14:51,542 [INFO]: {
2025-03-09 10:14:51,542 [INFO]: 	index_key: HNSW15
2025-03-09 10:14:51,542 [INFO]: 	index_param: efSearch=309
2025-03-09 10:14:51,542 [INFO]: 	index_path: knn.index
2025-03-09 10:14:51,542 [INFO]: 	size in bytes: 622694170
2025-03-09 10:14:51,542 [INFO]: 	avg_search_speed_ms: 9.55930259212296
2025-03-09 10:14:51,542 [INFO]: 	99p_search_speed_ms: 12.755101360380648
2025-03-09 10:14:51,542 [INFO]: 	reconstruction error %: 0.0
2025-03-09 10:14:51,542 [INFO]: 	nb vectors: 3165
2025-03-09 10:14:51,542 [INFO]: 	vectors dimension: 49152
2025-03-09 10:14:51,542 [INFO]: 	compression ratio: 0.9993096932319119
2025-03-09 10:14:51,542 [INFO]: }
2025-03-09 10:14:51,542 [INFO]: 	>>> Finished "Creating the index" in 43.1776 secs
2025-03-09 10:14:51,542 [INFO]: >>> Finished "Launching the whole pipeline" in 43.2037 secs
2025-03-09 10:14:52: [retrieval_preprocessing] calculating distances ...
2025-03-09 10:14:53: [retrieval_preprocessing] finished and saved retrieval indices for episode 70710 [episode count 15/20]
[retrieval_preprocessing] for episode 69696 [episode count 16/20], we have num_retrieval=np.int64(3180) num_query=np.int64(182)
2025-03-09 10:14:53,583 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-09 10:14:53,960 [INFO]: Launching the whole pipeline 03/09/2025, 10:14:53
2025-03-09 10:14:53,960 [INFO]: Reading total number of vectors and dimension 03/09/2025, 10:14:53
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1733.18it/s]
2025-03-09 10:14:53,984 [INFO]: There are 3180 embeddings of dim 49152
2025-03-09 10:14:53,984 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0243 secs
2025-03-09 10:14:53,985 [INFO]: 	Compute estimated construction time of the index 03/09/2025, 10:14:53
2025-03-09 10:14:53,985 [INFO]: 		-> Train: 16.7 minutes
2025-03-09 10:14:53,985 [INFO]: 		-> Add: 1.7 seconds
2025-03-09 10:14:53,985 [INFO]: 		Total: 16.7 minutes
2025-03-09 10:14:53,985 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0001 secs
2025-03-09 10:14:53,985 [INFO]: 	Checking that your have enough memory available to create the index 03/09/2025, 10:14:53
2025-03-09 10:14:53,985 [INFO]: 656.3MB of memory will be needed to build the index (more might be used if you have more)
2025-03-09 10:14:53,985 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0001 secs
2025-03-09 10:14:53,985 [INFO]: 	Selecting most promising index types given data characteristics 03/09/2025, 10:14:53
2025-03-09 10:14:53,985 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-09 10:14:53,985 [INFO]: 	Creating the index 03/09/2025, 10:14:53
2025-03-09 10:14:53,985 [INFO]: 		-> Instanciate the index HNSW15 03/09/2025, 10:14:53
2025-03-09 10:14:53,986 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0009 secs
2025-03-09 10:14:53,986 [INFO]: 		-> Adding the vectors to the index 03/09/2025, 10:14:53
2025-03-09 10:14:53,986 [INFO]: The memory available for adding the vectors is 49.4GB(total available - used by the index)
2025-03-09 10:14:53,986 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/13 [00:00<?, ?it/s]  8%|▊         | 1/13 [00:00<00:01,  9.93it/s] 62%|██████▏   | 8/13 [00:00<00:00, 42.59it/s]100%|██████████| 13/13 [00:02<00:00,  4.54it/s]100%|██████████| 13/13 [00:02<00:00,  5.48it/s]
2025-03-09 10:14:56,362 [INFO]: 	Computing best hyperparameters for index knn.index 03/09/2025, 10:14:56
2025-03-09 10:15:23,616 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 27.2529 secs
2025-03-09 10:15:23,616 [INFO]: The best hyperparameters are: efSearch=290
2025-03-09 10:15:23,616 [INFO]: 	Compute fast metrics 03/09/2025, 10:15:23
  0%|          | 0/4 [00:00<?, ?it/s] 75%|███████▌  | 3/4 [00:00<00:00, 26.65it/s] 75%|███████▌  | 3/4 [00:00<00:00, 23.09it/s]
2025-03-09 10:15:36,387 [INFO]: 	>>> Finished "Compute fast metrics" in 12.7712 secs
2025-03-09 10:15:36,389 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 42.4027 secs
2025-03-09 10:15:36,389 [INFO]: {
2025-03-09 10:15:36,389 [INFO]: 	index_key: HNSW15
2025-03-09 10:15:36,389 [INFO]: 	index_param: efSearch=290
2025-03-09 10:15:36,389 [INFO]: 	index_path: knn.index
2025-03-09 10:15:36,389 [INFO]: 	size in bytes: 625645330
2025-03-09 10:15:36,389 [INFO]: 	avg_search_speed_ms: 9.638260083447115
2025-03-09 10:15:36,389 [INFO]: 	99p_search_speed_ms: 14.816262682434171
2025-03-09 10:15:36,389 [INFO]: 	reconstruction error %: 0.0
2025-03-09 10:15:36,389 [INFO]: 	nb vectors: 3180
2025-03-09 10:15:36,389 [INFO]: 	vectors dimension: 49152
2025-03-09 10:15:36,389 [INFO]: 	compression ratio: 0.9993096887656782
2025-03-09 10:15:36,389 [INFO]: }
2025-03-09 10:15:36,389 [INFO]: 	>>> Finished "Creating the index" in 42.4040 secs
2025-03-09 10:15:36,389 [INFO]: >>> Finished "Launching the whole pipeline" in 42.4289 secs
2025-03-09 10:15:37: [retrieval_preprocessing] calculating distances ...
2025-03-09 10:15:37: [retrieval_preprocessing] finished and saved retrieval indices for episode 69696 [episode count 16/20]
[retrieval_preprocessing] for episode 10817 [episode count 17/20], we have num_retrieval=np.int64(3212) num_query=np.int64(150)
2025-03-09 10:15:38,163 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-09 10:15:38,522 [INFO]: Launching the whole pipeline 03/09/2025, 10:15:38
2025-03-09 10:15:38,522 [INFO]: Reading total number of vectors and dimension 03/09/2025, 10:15:38
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 2362.99it/s]
2025-03-09 10:15:38,544 [INFO]: There are 3212 embeddings of dim 49152
2025-03-09 10:15:38,545 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0227 secs
2025-03-09 10:15:38,545 [INFO]: 	Compute estimated construction time of the index 03/09/2025, 10:15:38
2025-03-09 10:15:38,545 [INFO]: 		-> Train: 16.7 minutes
2025-03-09 10:15:38,545 [INFO]: 		-> Add: 1.8 seconds
2025-03-09 10:15:38,545 [INFO]: 		Total: 16.7 minutes
2025-03-09 10:15:38,545 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0001 secs
2025-03-09 10:15:38,545 [INFO]: 	Checking that your have enough memory available to create the index 03/09/2025, 10:15:38
2025-03-09 10:15:38,545 [INFO]: 662.9MB of memory will be needed to build the index (more might be used if you have more)
2025-03-09 10:15:38,545 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0001 secs
2025-03-09 10:15:38,545 [INFO]: 	Selecting most promising index types given data characteristics 03/09/2025, 10:15:38
2025-03-09 10:15:38,545 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-09 10:15:38,545 [INFO]: 	Creating the index 03/09/2025, 10:15:38
2025-03-09 10:15:38,545 [INFO]: 		-> Instanciate the index HNSW15 03/09/2025, 10:15:38
2025-03-09 10:15:38,546 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0009 secs
2025-03-09 10:15:38,546 [INFO]: 		-> Adding the vectors to the index 03/09/2025, 10:15:38
2025-03-09 10:15:38,546 [INFO]: The memory available for adding the vectors is 49.4GB(total available - used by the index)
2025-03-09 10:15:38,546 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/13 [00:00<?, ?it/s]  8%|▊         | 1/13 [00:00<00:01,  9.79it/s] 54%|█████▍    | 7/13 [00:00<00:00, 38.46it/s]100%|██████████| 13/13 [00:02<00:00,  4.64it/s]100%|██████████| 13/13 [00:02<00:00,  5.45it/s]
2025-03-09 10:15:40,935 [INFO]: 	Computing best hyperparameters for index knn.index 03/09/2025, 10:15:40
2025-03-09 10:16:08,241 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 27.3059 secs
2025-03-09 10:16:08,241 [INFO]: The best hyperparameters are: efSearch=289
2025-03-09 10:16:08,242 [INFO]: 	Compute fast metrics 03/09/2025, 10:16:08
  0%|          | 0/4 [00:00<?, ?it/s] 75%|███████▌  | 3/4 [00:00<00:00, 26.95it/s] 75%|███████▌  | 3/4 [00:00<00:00, 23.52it/s]
2025-03-09 10:16:22,808 [INFO]: 	>>> Finished "Compute fast metrics" in 14.5664 secs
2025-03-09 10:16:22,810 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 44.2637 secs
2025-03-09 10:16:22,810 [INFO]: {
2025-03-09 10:16:22,810 [INFO]: 	index_key: HNSW15
2025-03-09 10:16:22,810 [INFO]: 	index_param: efSearch=289
2025-03-09 10:16:22,810 [INFO]: 	index_path: knn.index
2025-03-09 10:16:22,810 [INFO]: 	size in bytes: 631941070
2025-03-09 10:16:22,810 [INFO]: 	avg_search_speed_ms: 9.566890375251976
2025-03-09 10:16:22,810 [INFO]: 	99p_search_speed_ms: 13.542548585683104
2025-03-09 10:16:22,810 [INFO]: 	reconstruction error %: 0.0
2025-03-09 10:16:22,810 [INFO]: 	nb vectors: 3212
2025-03-09 10:16:22,810 [INFO]: 	vectors dimension: 49152
2025-03-09 10:16:22,810 [INFO]: 	compression ratio: 0.9993097869078204
2025-03-09 10:16:22,810 [INFO]: }
2025-03-09 10:16:22,810 [INFO]: 	>>> Finished "Creating the index" in 44.2650 secs
2025-03-09 10:16:22,810 [INFO]: >>> Finished "Launching the whole pipeline" in 44.2883 secs
2025-03-09 10:16:23: [retrieval_preprocessing] calculating distances ...
2025-03-09 10:16:24: [retrieval_preprocessing] finished and saved retrieval indices for episode 10817 [episode count 17/20]
[retrieval_preprocessing] for episode 7746 [episode count 18/20], we have num_retrieval=np.int64(3187) num_query=np.int64(175)
2025-03-09 10:16:24,236 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-09 10:16:24,594 [INFO]: Launching the whole pipeline 03/09/2025, 10:16:24
2025-03-09 10:16:24,594 [INFO]: Reading total number of vectors and dimension 03/09/2025, 10:16:24
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1594.79it/s]
2025-03-09 10:16:24,620 [INFO]: There are 3187 embeddings of dim 49152
2025-03-09 10:16:24,620 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0256 secs
2025-03-09 10:16:24,620 [INFO]: 	Compute estimated construction time of the index 03/09/2025, 10:16:24
2025-03-09 10:16:24,620 [INFO]: 		-> Train: 16.7 minutes
2025-03-09 10:16:24,620 [INFO]: 		-> Add: 1.8 seconds
2025-03-09 10:16:24,620 [INFO]: 		Total: 16.7 minutes
2025-03-09 10:16:24,620 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0001 secs
2025-03-09 10:16:24,620 [INFO]: 	Checking that your have enough memory available to create the index 03/09/2025, 10:16:24
2025-03-09 10:16:24,620 [INFO]: 657.7MB of memory will be needed to build the index (more might be used if you have more)
2025-03-09 10:16:24,620 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0001 secs
2025-03-09 10:16:24,620 [INFO]: 	Selecting most promising index types given data characteristics 03/09/2025, 10:16:24
2025-03-09 10:16:24,620 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-09 10:16:24,620 [INFO]: 	Creating the index 03/09/2025, 10:16:24
2025-03-09 10:16:24,620 [INFO]: 		-> Instanciate the index HNSW15 03/09/2025, 10:16:24
2025-03-09 10:16:24,621 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0010 secs
2025-03-09 10:16:24,621 [INFO]: 		-> Adding the vectors to the index 03/09/2025, 10:16:24
2025-03-09 10:16:24,621 [INFO]: The memory available for adding the vectors is 49.4GB(total available - used by the index)
2025-03-09 10:16:24,621 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/13 [00:00<?, ?it/s] 15%|█▌        | 2/13 [00:00<00:00, 17.56it/s] 62%|██████▏   | 8/13 [00:00<00:00, 41.12it/s]100%|██████████| 13/13 [00:02<00:00,  4.21it/s]100%|██████████| 13/13 [00:02<00:00,  5.18it/s]
2025-03-09 10:16:27,132 [INFO]: 	Computing best hyperparameters for index knn.index 03/09/2025, 10:16:27
2025-03-09 10:16:53,920 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 26.7877 secs
2025-03-09 10:16:53,920 [INFO]: The best hyperparameters are: efSearch=210
2025-03-09 10:16:53,920 [INFO]: 	Compute fast metrics 03/09/2025, 10:16:53
  0%|          | 0/4 [00:00<?, ?it/s] 75%|███████▌  | 3/4 [00:00<00:00, 26.60it/s] 75%|███████▌  | 3/4 [00:00<00:00, 22.94it/s]
2025-03-09 10:17:08,536 [INFO]: 	>>> Finished "Compute fast metrics" in 14.6158 secs
2025-03-09 10:17:08,538 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 43.9162 secs
2025-03-09 10:17:08,538 [INFO]: {
2025-03-09 10:17:08,538 [INFO]: 	index_key: HNSW15
2025-03-09 10:17:08,538 [INFO]: 	index_param: efSearch=210
2025-03-09 10:17:08,538 [INFO]: 	index_path: knn.index
2025-03-09 10:17:08,538 [INFO]: 	size in bytes: 627022510
2025-03-09 10:17:08,538 [INFO]: 	avg_search_speed_ms: 8.050052860778743
2025-03-09 10:17:08,538 [INFO]: 	99p_search_speed_ms: 10.69253085181117
2025-03-09 10:17:08,538 [INFO]: 	reconstruction error %: 0.0
2025-03-09 10:17:08,538 [INFO]: 	nb vectors: 3187
2025-03-09 10:17:08,538 [INFO]: 	vectors dimension: 49152
2025-03-09 10:17:08,538 [INFO]: 	compression ratio: 0.9993097313204912
2025-03-09 10:17:08,538 [INFO]: }
2025-03-09 10:17:08,538 [INFO]: 	>>> Finished "Creating the index" in 43.9176 secs
2025-03-09 10:17:08,538 [INFO]: >>> Finished "Launching the whole pipeline" in 43.9438 secs
2025-03-09 10:17:09: [retrieval_preprocessing] calculating distances ...
2025-03-09 10:17:09: [retrieval_preprocessing] finished and saved retrieval indices for episode 7746 [episode count 18/20]
[retrieval_preprocessing] for episode 4170 [episode count 19/20], we have num_retrieval=np.int64(3203) num_query=np.int64(159)
2025-03-09 10:17:09,874 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-09 10:17:10,242 [INFO]: Launching the whole pipeline 03/09/2025, 10:17:10
2025-03-09 10:17:10,242 [INFO]: Reading total number of vectors and dimension 03/09/2025, 10:17:10
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 2822.55it/s]
2025-03-09 10:17:10,267 [INFO]: There are 3203 embeddings of dim 49152
2025-03-09 10:17:10,267 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0248 secs
2025-03-09 10:17:10,267 [INFO]: 	Compute estimated construction time of the index 03/09/2025, 10:17:10
2025-03-09 10:17:10,267 [INFO]: 		-> Train: 16.7 minutes
2025-03-09 10:17:10,267 [INFO]: 		-> Add: 1.8 seconds
2025-03-09 10:17:10,267 [INFO]: 		Total: 16.7 minutes
2025-03-09 10:17:10,267 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0001 secs
2025-03-09 10:17:10,267 [INFO]: 	Checking that your have enough memory available to create the index 03/09/2025, 10:17:10
2025-03-09 10:17:10,267 [INFO]: 661.0MB of memory will be needed to build the index (more might be used if you have more)
2025-03-09 10:17:10,267 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0002 secs
2025-03-09 10:17:10,267 [INFO]: 	Selecting most promising index types given data characteristics 03/09/2025, 10:17:10
2025-03-09 10:17:10,267 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-09 10:17:10,268 [INFO]: 	Creating the index 03/09/2025, 10:17:10
2025-03-09 10:17:10,268 [INFO]: 		-> Instanciate the index HNSW15 03/09/2025, 10:17:10
2025-03-09 10:17:10,269 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0012 secs
2025-03-09 10:17:10,269 [INFO]: 		-> Adding the vectors to the index 03/09/2025, 10:17:10
2025-03-09 10:17:10,269 [INFO]: The memory available for adding the vectors is 49.4GB(total available - used by the index)
2025-03-09 10:17:10,269 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/13 [00:00<?, ?it/s]  8%|▊         | 1/13 [00:00<00:01,  9.52it/s] 54%|█████▍    | 7/13 [00:00<00:00, 38.04it/s]100%|██████████| 13/13 [00:02<00:00,  4.40it/s]100%|██████████| 13/13 [00:02<00:00,  5.16it/s]
2025-03-09 10:17:12,790 [INFO]: 	Computing best hyperparameters for index knn.index 03/09/2025, 10:17:12
2025-03-09 10:17:41,564 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 28.7741 secs
2025-03-09 10:17:41,564 [INFO]: The best hyperparameters are: efSearch=276
2025-03-09 10:17:41,564 [INFO]: 	Compute fast metrics 03/09/2025, 10:17:41
  0%|          | 0/4 [00:00<?, ?it/s] 50%|█████     | 2/4 [00:00<00:00, 19.15it/s] 75%|███████▌  | 3/4 [00:00<00:00, 20.96it/s]
2025-03-09 10:17:57,021 [INFO]: 	>>> Finished "Compute fast metrics" in 15.4564 secs
2025-03-09 10:17:57,023 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 46.7538 secs
2025-03-09 10:17:57,023 [INFO]: {
2025-03-09 10:17:57,023 [INFO]: 	index_key: HNSW15
2025-03-09 10:17:57,023 [INFO]: 	index_param: efSearch=276
2025-03-09 10:17:57,023 [INFO]: 	index_path: knn.index
2025-03-09 10:17:57,023 [INFO]: 	size in bytes: 630170350
2025-03-09 10:17:57,023 [INFO]: 	avg_search_speed_ms: 10.009090750579825
2025-03-09 10:17:57,023 [INFO]: 	99p_search_speed_ms: 17.284078737720844
2025-03-09 10:17:57,023 [INFO]: 	reconstruction error %: 0.0
2025-03-09 10:17:57,023 [INFO]: 	nb vectors: 3203
2025-03-09 10:17:57,023 [INFO]: 	vectors dimension: 49152
2025-03-09 10:17:57,023 [INFO]: 	compression ratio: 0.9993098278901887
2025-03-09 10:17:57,023 [INFO]: }
2025-03-09 10:17:57,023 [INFO]: 	>>> Finished "Creating the index" in 46.7554 secs
2025-03-09 10:17:57,023 [INFO]: >>> Finished "Launching the whole pipeline" in 46.7808 secs
2025-03-09 10:17:58: [retrieval_preprocessing] calculating distances ...
2025-03-09 10:17:58: [retrieval_preprocessing] finished and saved retrieval indices for episode 4170 [episode count 19/20]
2025-03-09 10:17:58: [retrieval_preprocessing] finished for (5059283044, 'drawer') [chosen_id count 8/10]
2025-03-09 10:18:00: [retrieval_preprocessing] concatenated all embeddings and indices for 20 episodes for (4846810092, 'cloth') [chosen_id count 9/10]
2025-03-09 10:18:00: [retrieval_preprocessing] we have num_total=3631 embedding_dim=49152
[retrieval_preprocessing] for episode 24577 [episode count 0/20], we have num_retrieval=np.int64(3474) num_query=np.int64(157)
2025-03-09 10:18:00,265 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-09 10:18:00,789 [INFO]: Launching the whole pipeline 03/09/2025, 10:18:00
2025-03-09 10:18:00,789 [INFO]: Reading total number of vectors and dimension 03/09/2025, 10:18:00
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 2372.34it/s]
2025-03-09 10:18:00,815 [INFO]: There are 3474 embeddings of dim 49152
2025-03-09 10:18:00,816 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0264 secs
2025-03-09 10:18:00,816 [INFO]: 	Compute estimated construction time of the index 03/09/2025, 10:18:00
2025-03-09 10:18:00,816 [INFO]: 		-> Train: 16.7 minutes
2025-03-09 10:18:00,816 [INFO]: 		-> Add: 1.9 seconds
2025-03-09 10:18:00,816 [INFO]: 		Total: 16.7 minutes
2025-03-09 10:18:00,816 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0001 secs
2025-03-09 10:18:00,816 [INFO]: 	Checking that your have enough memory available to create the index 03/09/2025, 10:18:00
2025-03-09 10:18:00,816 [INFO]: 716.9MB of memory will be needed to build the index (more might be used if you have more)
2025-03-09 10:18:00,816 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0001 secs
2025-03-09 10:18:00,816 [INFO]: 	Selecting most promising index types given data characteristics 03/09/2025, 10:18:00
2025-03-09 10:18:00,816 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-09 10:18:00,816 [INFO]: 	Creating the index 03/09/2025, 10:18:00
2025-03-09 10:18:00,816 [INFO]: 		-> Instanciate the index HNSW15 03/09/2025, 10:18:00
2025-03-09 10:18:00,817 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0011 secs
2025-03-09 10:18:00,817 [INFO]: 		-> Adding the vectors to the index 03/09/2025, 10:18:00
2025-03-09 10:18:00,817 [INFO]: The memory available for adding the vectors is 49.4GB(total available - used by the index)
2025-03-09 10:18:00,818 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/14 [00:00<?, ?it/s] 14%|█▍        | 2/14 [00:00<00:00, 17.84it/s] 57%|█████▋    | 8/14 [00:00<00:00, 40.93it/s]100%|██████████| 14/14 [00:02<00:00,  3.91it/s]100%|██████████| 14/14 [00:02<00:00,  4.75it/s]
2025-03-09 10:18:03,767 [INFO]: 	Computing best hyperparameters for index knn.index 03/09/2025, 10:18:03
2025-03-09 10:18:44,500 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 40.7328 secs
2025-03-09 10:18:44,500 [INFO]: The best hyperparameters are: efSearch=205
2025-03-09 10:18:44,500 [INFO]: 	Compute fast metrics 03/09/2025, 10:18:44
  0%|          | 0/4 [00:00<?, ?it/s] 75%|███████▌  | 3/4 [00:00<00:00, 26.07it/s] 75%|███████▌  | 3/4 [00:00<00:00, 22.56it/s]
2025-03-09 10:18:59,866 [INFO]: 	>>> Finished "Compute fast metrics" in 15.3659 secs
2025-03-09 10:18:59,868 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 59.0506 secs
2025-03-09 10:18:59,868 [INFO]: {
2025-03-09 10:18:59,868 [INFO]: 	index_key: HNSW15
2025-03-09 10:18:59,868 [INFO]: 	index_param: efSearch=205
2025-03-09 10:18:59,868 [INFO]: 	index_path: knn.index
2025-03-09 10:18:59,868 [INFO]: 	size in bytes: 683488210
2025-03-09 10:18:59,868 [INFO]: 	avg_search_speed_ms: 10.46808818101914
2025-03-09 10:18:59,868 [INFO]: 	99p_search_speed_ms: 17.49525968916722
2025-03-09 10:18:59,868 [INFO]: 	reconstruction error %: 0.0
2025-03-09 10:18:59,868 [INFO]: 	nb vectors: 3474
2025-03-09 10:18:59,868 [INFO]: 	vectors dimension: 49152
2025-03-09 10:18:59,868 [INFO]: 	compression ratio: 0.9993093984752129
2025-03-09 10:18:59,868 [INFO]: }
2025-03-09 10:18:59,868 [INFO]: 	>>> Finished "Creating the index" in 59.0521 secs
2025-03-09 10:18:59,868 [INFO]: >>> Finished "Launching the whole pipeline" in 59.0792 secs
2025-03-09 10:19:00: [retrieval_preprocessing] calculating distances ...
2025-03-09 10:19:00: [retrieval_preprocessing] finished and saved retrieval indices for episode 24577 [episode count 0/20]
[retrieval_preprocessing] for episode 28163 [episode count 1/20], we have num_retrieval=np.int64(3515) num_query=np.int64(116)
2025-03-09 10:19:01,213 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-09 10:19:01,625 [INFO]: Launching the whole pipeline 03/09/2025, 10:19:01
2025-03-09 10:19:01,625 [INFO]: Reading total number of vectors and dimension 03/09/2025, 10:19:01
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1807.89it/s]
2025-03-09 10:19:01,654 [INFO]: There are 3515 embeddings of dim 49152
2025-03-09 10:19:01,655 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0297 secs
2025-03-09 10:19:01,655 [INFO]: 	Compute estimated construction time of the index 03/09/2025, 10:19:01
2025-03-09 10:19:01,655 [INFO]: 		-> Train: 16.7 minutes
2025-03-09 10:19:01,655 [INFO]: 		-> Add: 1.9 seconds
2025-03-09 10:19:01,655 [INFO]: 		Total: 16.7 minutes
2025-03-09 10:19:01,655 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0003 secs
2025-03-09 10:19:01,655 [INFO]: 	Checking that your have enough memory available to create the index 03/09/2025, 10:19:01
2025-03-09 10:19:01,656 [INFO]: 725.4MB of memory will be needed to build the index (more might be used if you have more)
2025-03-09 10:19:01,656 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0004 secs
2025-03-09 10:19:01,656 [INFO]: 	Selecting most promising index types given data characteristics 03/09/2025, 10:19:01
2025-03-09 10:19:01,656 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-09 10:19:01,656 [INFO]: 	Creating the index 03/09/2025, 10:19:01
2025-03-09 10:19:01,656 [INFO]: 		-> Instanciate the index HNSW15 03/09/2025, 10:19:01
2025-03-09 10:19:01,659 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0028 secs
2025-03-09 10:19:01,660 [INFO]: 		-> Adding the vectors to the index 03/09/2025, 10:19:01
2025-03-09 10:19:01,660 [INFO]: The memory available for adding the vectors is 49.4GB(total available - used by the index)
2025-03-09 10:19:01,660 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/14 [00:00<?, ?it/s] 14%|█▍        | 2/14 [00:00<00:00, 19.72it/s] 57%|█████▋    | 8/14 [00:00<00:00, 42.09it/s]100%|██████████| 14/14 [00:02<00:00,  4.14it/s]100%|██████████| 14/14 [00:02<00:00,  5.03it/s]
2025-03-09 10:19:04,450 [INFO]: 	Computing best hyperparameters for index knn.index 03/09/2025, 10:19:04
2025-03-09 10:19:40,403 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 35.9527 secs
2025-03-09 10:19:40,404 [INFO]: The best hyperparameters are: efSearch=234
2025-03-09 10:19:40,404 [INFO]: 	Compute fast metrics 03/09/2025, 10:19:40
  0%|          | 0/4 [00:00<?, ?it/s] 75%|███████▌  | 3/4 [00:00<00:00, 26.23it/s] 75%|███████▌  | 3/4 [00:00<00:00, 23.01it/s]
2025-03-09 10:19:54,969 [INFO]: 	>>> Finished "Compute fast metrics" in 14.5650 secs
2025-03-09 10:19:54,971 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 53.3110 secs
2025-03-09 10:19:54,971 [INFO]: {
2025-03-09 10:19:54,971 [INFO]: 	index_key: HNSW15
2025-03-09 10:19:54,971 [INFO]: 	index_param: efSearch=234
2025-03-09 10:19:54,971 [INFO]: 	index_path: knn.index
2025-03-09 10:19:54,971 [INFO]: 	size in bytes: 691554610
2025-03-09 10:19:54,971 [INFO]: 	avg_search_speed_ms: 11.708656285905786
2025-03-09 10:19:54,971 [INFO]: 	99p_search_speed_ms: 20.58164030779153
2025-03-09 10:19:54,971 [INFO]: 	reconstruction error %: 0.0
2025-03-09 10:19:54,971 [INFO]: 	nb vectors: 3515
2025-03-09 10:19:54,971 [INFO]: 	vectors dimension: 49152
2025-03-09 10:19:54,971 [INFO]: 	compression ratio: 0.9993095411510596
2025-03-09 10:19:54,971 [INFO]: }
2025-03-09 10:19:54,971 [INFO]: 	>>> Finished "Creating the index" in 53.3146 secs
2025-03-09 10:19:54,971 [INFO]: >>> Finished "Launching the whole pipeline" in 53.3460 secs
2025-03-09 10:19:55: [retrieval_preprocessing] calculating distances ...
2025-03-09 10:19:56: [retrieval_preprocessing] finished and saved retrieval indices for episode 28163 [episode count 1/20]
[retrieval_preprocessing] for episode 77316 [episode count 2/20], we have num_retrieval=np.int64(3506) num_query=np.int64(125)
2025-03-09 10:19:56,386 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-09 10:19:56,790 [INFO]: Launching the whole pipeline 03/09/2025, 10:19:56
2025-03-09 10:19:56,790 [INFO]: Reading total number of vectors and dimension 03/09/2025, 10:19:56
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1513.64it/s]
2025-03-09 10:19:56,818 [INFO]: There are 3506 embeddings of dim 49152
2025-03-09 10:19:56,818 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0281 secs
2025-03-09 10:19:56,818 [INFO]: 	Compute estimated construction time of the index 03/09/2025, 10:19:56
2025-03-09 10:19:56,818 [INFO]: 		-> Train: 16.7 minutes
2025-03-09 10:19:56,818 [INFO]: 		-> Add: 1.9 seconds
2025-03-09 10:19:56,818 [INFO]: 		Total: 16.7 minutes
2025-03-09 10:19:56,818 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0001 secs
2025-03-09 10:19:56,818 [INFO]: 	Checking that your have enough memory available to create the index 03/09/2025, 10:19:56
2025-03-09 10:19:56,818 [INFO]: 723.6MB of memory will be needed to build the index (more might be used if you have more)
2025-03-09 10:19:56,818 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0001 secs
2025-03-09 10:19:56,818 [INFO]: 	Selecting most promising index types given data characteristics 03/09/2025, 10:19:56
2025-03-09 10:19:56,818 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-09 10:19:56,818 [INFO]: 	Creating the index 03/09/2025, 10:19:56
2025-03-09 10:19:56,818 [INFO]: 		-> Instanciate the index HNSW15 03/09/2025, 10:19:56
2025-03-09 10:19:56,820 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0012 secs
2025-03-09 10:19:56,820 [INFO]: 		-> Adding the vectors to the index 03/09/2025, 10:19:56
2025-03-09 10:19:56,820 [INFO]: The memory available for adding the vectors is 49.4GB(total available - used by the index)
2025-03-09 10:19:56,820 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/14 [00:00<?, ?it/s] 14%|█▍        | 2/14 [00:00<00:00, 19.62it/s] 57%|█████▋    | 8/14 [00:00<00:00, 42.90it/s]100%|██████████| 14/14 [00:02<00:00,  3.90it/s]100%|██████████| 14/14 [00:02<00:00,  4.75it/s]
2025-03-09 10:19:59,771 [INFO]: 	Computing best hyperparameters for index knn.index 03/09/2025, 10:19:59
2025-03-09 10:20:34,871 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 35.0998 secs
2025-03-09 10:20:34,872 [INFO]: The best hyperparameters are: efSearch=264
2025-03-09 10:20:34,872 [INFO]: 	Compute fast metrics 03/09/2025, 10:20:34
  0%|          | 0/4 [00:00<?, ?it/s] 75%|███████▌  | 3/4 [00:00<00:00, 26.97it/s] 75%|███████▌  | 3/4 [00:00<00:00, 23.60it/s]
2025-03-09 10:20:49,838 [INFO]: 	>>> Finished "Compute fast metrics" in 14.9666 secs
2025-03-09 10:20:49,876 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 53.0558 secs
2025-03-09 10:20:49,876 [INFO]: {
2025-03-09 10:20:49,876 [INFO]: 	index_key: HNSW15
2025-03-09 10:20:49,876 [INFO]: 	index_param: efSearch=264
2025-03-09 10:20:49,876 [INFO]: 	index_path: knn.index
2025-03-09 10:20:49,876 [INFO]: 	size in bytes: 689783950
2025-03-09 10:20:49,876 [INFO]: 	avg_search_speed_ms: 11.422402123372033
2025-03-09 10:20:49,876 [INFO]: 	99p_search_speed_ms: 14.470967464148998
2025-03-09 10:20:49,876 [INFO]: 	reconstruction error %: 0.0
2025-03-09 10:20:49,876 [INFO]: 	nb vectors: 3506
2025-03-09 10:20:49,876 [INFO]: 	vectors dimension: 49152
2025-03-09 10:20:49,876 [INFO]: 	compression ratio: 0.9993094910370124
2025-03-09 10:20:49,876 [INFO]: }
2025-03-09 10:20:49,876 [INFO]: 	>>> Finished "Creating the index" in 53.0579 secs
2025-03-09 10:20:49,876 [INFO]: >>> Finished "Launching the whole pipeline" in 53.0866 secs
2025-03-09 10:20:51: [retrieval_preprocessing] calculating distances ...
2025-03-09 10:20:51: [retrieval_preprocessing] finished and saved retrieval indices for episode 77316 [episode count 2/20]
[retrieval_preprocessing] for episode 74247 [episode count 3/20], we have num_retrieval=np.int64(3461) num_query=np.int64(170)
2025-03-09 10:20:51,605 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-09 10:20:51,997 [INFO]: Launching the whole pipeline 03/09/2025, 10:20:51
2025-03-09 10:20:51,997 [INFO]: Reading total number of vectors and dimension 03/09/2025, 10:20:51
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1876.65it/s]
2025-03-09 10:20:52,023 [INFO]: There are 3461 embeddings of dim 49152
2025-03-09 10:20:52,023 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0261 secs
2025-03-09 10:20:52,024 [INFO]: 	Compute estimated construction time of the index 03/09/2025, 10:20:52
2025-03-09 10:20:52,024 [INFO]: 		-> Train: 16.7 minutes
2025-03-09 10:20:52,024 [INFO]: 		-> Add: 1.9 seconds
2025-03-09 10:20:52,024 [INFO]: 		Total: 16.7 minutes
2025-03-09 10:20:52,024 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0001 secs
2025-03-09 10:20:52,024 [INFO]: 	Checking that your have enough memory available to create the index 03/09/2025, 10:20:52
2025-03-09 10:20:52,024 [INFO]: 714.3MB of memory will be needed to build the index (more might be used if you have more)
2025-03-09 10:20:52,024 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0001 secs
2025-03-09 10:20:52,024 [INFO]: 	Selecting most promising index types given data characteristics 03/09/2025, 10:20:52
2025-03-09 10:20:52,024 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-09 10:20:52,024 [INFO]: 	Creating the index 03/09/2025, 10:20:52
2025-03-09 10:20:52,024 [INFO]: 		-> Instanciate the index HNSW15 03/09/2025, 10:20:52
2025-03-09 10:20:52,025 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0009 secs
2025-03-09 10:20:52,025 [INFO]: 		-> Adding the vectors to the index 03/09/2025, 10:20:52
2025-03-09 10:20:52,025 [INFO]: The memory available for adding the vectors is 49.4GB(total available - used by the index)
2025-03-09 10:20:52,025 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/14 [00:00<?, ?it/s]  7%|▋         | 1/14 [00:00<00:01,  9.57it/s] 50%|█████     | 7/14 [00:00<00:00, 37.29it/s] 93%|█████████▎| 13/14 [00:00<00:00, 47.01it/s]100%|██████████| 14/14 [00:02<00:00,  5.19it/s]
2025-03-09 10:20:54,728 [INFO]: 	Computing best hyperparameters for index knn.index 03/09/2025, 10:20:54
2025-03-09 10:21:30,927 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 36.1990 secs
2025-03-09 10:21:30,928 [INFO]: The best hyperparameters are: efSearch=255
2025-03-09 10:21:30,928 [INFO]: 	Compute fast metrics 03/09/2025, 10:21:30
  0%|          | 0/4 [00:00<?, ?it/s] 50%|█████     | 2/4 [00:00<00:00, 19.66it/s] 75%|███████▌  | 3/4 [00:00<00:00, 21.99it/s]
2025-03-09 10:21:46,925 [INFO]: 	>>> Finished "Compute fast metrics" in 15.9969 secs
2025-03-09 10:21:46,926 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 54.9013 secs
2025-03-09 10:21:46,926 [INFO]: {
2025-03-09 10:21:46,926 [INFO]: 	index_key: HNSW15
2025-03-09 10:21:46,926 [INFO]: 	index_param: efSearch=255
2025-03-09 10:21:46,926 [INFO]: 	index_path: knn.index
2025-03-09 10:21:46,926 [INFO]: 	size in bytes: 680930530
2025-03-09 10:21:46,927 [INFO]: 	avg_search_speed_ms: 11.357085223792799
2025-03-09 10:21:46,927 [INFO]: 	99p_search_speed_ms: 15.587389748543501
2025-03-09 10:21:46,927 [INFO]: 	reconstruction error %: 0.0
2025-03-09 10:21:46,927 [INFO]: 	nb vectors: 3461
2025-03-09 10:21:46,927 [INFO]: 	vectors dimension: 49152
2025-03-09 10:21:46,927 [INFO]: 	compression ratio: 0.9993094126650482
2025-03-09 10:21:46,927 [INFO]: }
2025-03-09 10:21:46,927 [INFO]: 	>>> Finished "Creating the index" in 54.9027 secs
2025-03-09 10:21:46,927 [INFO]: >>> Finished "Launching the whole pipeline" in 54.9293 secs
2025-03-09 10:21:48: [retrieval_preprocessing] calculating distances ...
2025-03-09 10:21:48: [retrieval_preprocessing] finished and saved retrieval indices for episode 74247 [episode count 3/20]
[retrieval_preprocessing] for episode 55308 [episode count 4/20], we have num_retrieval=np.int64(3266) num_query=np.int64(365)
2025-03-09 10:21:48,658 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-09 10:21:49,038 [INFO]: Launching the whole pipeline 03/09/2025, 10:21:49
2025-03-09 10:21:49,038 [INFO]: Reading total number of vectors and dimension 03/09/2025, 10:21:49
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 2090.88it/s]
2025-03-09 10:21:49,065 [INFO]: There are 3266 embeddings of dim 49152
2025-03-09 10:21:49,065 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0265 secs
2025-03-09 10:21:49,065 [INFO]: 	Compute estimated construction time of the index 03/09/2025, 10:21:49
2025-03-09 10:21:49,065 [INFO]: 		-> Train: 16.7 minutes
2025-03-09 10:21:49,065 [INFO]: 		-> Add: 1.8 seconds
2025-03-09 10:21:49,065 [INFO]: 		Total: 16.7 minutes
2025-03-09 10:21:49,065 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0001 secs
2025-03-09 10:21:49,065 [INFO]: 	Checking that your have enough memory available to create the index 03/09/2025, 10:21:49
2025-03-09 10:21:49,065 [INFO]: 674.0MB of memory will be needed to build the index (more might be used if you have more)
2025-03-09 10:21:49,065 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0001 secs
2025-03-09 10:21:49,065 [INFO]: 	Selecting most promising index types given data characteristics 03/09/2025, 10:21:49
2025-03-09 10:21:49,065 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-09 10:21:49,065 [INFO]: 	Creating the index 03/09/2025, 10:21:49
2025-03-09 10:21:49,065 [INFO]: 		-> Instanciate the index HNSW15 03/09/2025, 10:21:49
2025-03-09 10:21:49,066 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0012 secs
2025-03-09 10:21:49,067 [INFO]: 		-> Adding the vectors to the index 03/09/2025, 10:21:49
2025-03-09 10:21:49,067 [INFO]: The memory available for adding the vectors is 49.4GB(total available - used by the index)
2025-03-09 10:21:49,067 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/13 [00:00<?, ?it/s]  8%|▊         | 1/13 [00:00<00:01,  9.37it/s] 54%|█████▍    | 7/13 [00:00<00:00, 36.83it/s]100%|██████████| 13/13 [00:03<00:00,  3.40it/s]100%|██████████| 13/13 [00:03<00:00,  4.02it/s]
2025-03-09 10:21:52,305 [INFO]: 	Computing best hyperparameters for index knn.index 03/09/2025, 10:21:52
2025-03-09 10:22:27,979 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 35.6732 secs
2025-03-09 10:22:27,979 [INFO]: The best hyperparameters are: efSearch=255
2025-03-09 10:22:27,979 [INFO]: 	Compute fast metrics 03/09/2025, 10:22:27
  0%|          | 0/4 [00:00<?, ?it/s] 75%|███████▌  | 3/4 [00:00<00:00, 27.15it/s] 75%|███████▌  | 3/4 [00:00<00:00, 23.86it/s]
2025-03-09 10:22:40,298 [INFO]: 	>>> Finished "Compute fast metrics" in 12.3185 secs
2025-03-09 10:22:40,300 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 51.2330 secs
2025-03-09 10:22:40,300 [INFO]: {
2025-03-09 10:22:40,300 [INFO]: 	index_key: HNSW15
2025-03-09 10:22:40,300 [INFO]: 	index_param: efSearch=255
2025-03-09 10:22:40,300 [INFO]: 	index_path: knn.index
2025-03-09 10:22:40,300 [INFO]: 	size in bytes: 642565750
2025-03-09 10:22:40,300 [INFO]: 	avg_search_speed_ms: 10.65041882574114
2025-03-09 10:22:40,300 [INFO]: 	99p_search_speed_ms: 13.295042607933283
2025-03-09 10:22:40,300 [INFO]: 	reconstruction error %: 0.0
2025-03-09 10:22:40,300 [INFO]: 	nb vectors: 3266
2025-03-09 10:22:40,300 [INFO]: 	vectors dimension: 49152
2025-03-09 10:22:40,300 [INFO]: 	compression ratio: 0.9993089858897708
2025-03-09 10:22:40,300 [INFO]: }
2025-03-09 10:22:40,300 [INFO]: 	>>> Finished "Creating the index" in 51.2346 secs
2025-03-09 10:22:40,300 [INFO]: >>> Finished "Launching the whole pipeline" in 51.2617 secs
2025-03-09 10:22:42: [retrieval_preprocessing] calculating distances ...
2025-03-09 10:22:44: [retrieval_preprocessing] finished and saved retrieval indices for episode 55308 [episode count 4/20]
[retrieval_preprocessing] for episode 75791 [episode count 5/20], we have num_retrieval=np.int64(3432) num_query=np.int64(199)
2025-03-09 10:22:44,498 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-09 10:22:45,017 [INFO]: Launching the whole pipeline 03/09/2025, 10:22:45
2025-03-09 10:22:45,017 [INFO]: Reading total number of vectors and dimension 03/09/2025, 10:22:45
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 2245.34it/s]
2025-03-09 10:22:45,044 [INFO]: There are 3432 embeddings of dim 49152
2025-03-09 10:22:45,044 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0272 secs
2025-03-09 10:22:45,044 [INFO]: 	Compute estimated construction time of the index 03/09/2025, 10:22:45
2025-03-09 10:22:45,044 [INFO]: 		-> Train: 16.7 minutes
2025-03-09 10:22:45,044 [INFO]: 		-> Add: 1.9 seconds
2025-03-09 10:22:45,044 [INFO]: 		Total: 16.7 minutes
2025-03-09 10:22:45,044 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0001 secs
2025-03-09 10:22:45,044 [INFO]: 	Checking that your have enough memory available to create the index 03/09/2025, 10:22:45
2025-03-09 10:22:45,044 [INFO]: 708.3MB of memory will be needed to build the index (more might be used if you have more)
2025-03-09 10:22:45,044 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0001 secs
2025-03-09 10:22:45,044 [INFO]: 	Selecting most promising index types given data characteristics 03/09/2025, 10:22:45
2025-03-09 10:22:45,044 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-09 10:22:45,044 [INFO]: 	Creating the index 03/09/2025, 10:22:45
2025-03-09 10:22:45,045 [INFO]: 		-> Instanciate the index HNSW15 03/09/2025, 10:22:45
2025-03-09 10:22:45,046 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0011 secs
2025-03-09 10:22:45,046 [INFO]: 		-> Adding the vectors to the index 03/09/2025, 10:22:45
2025-03-09 10:22:45,046 [INFO]: The memory available for adding the vectors is 49.4GB(total available - used by the index)
2025-03-09 10:22:45,046 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/14 [00:00<?, ?it/s]  7%|▋         | 1/14 [00:00<00:01,  9.83it/s] 50%|█████     | 7/14 [00:00<00:00, 38.65it/s] 93%|█████████▎| 13/14 [00:00<00:00, 47.88it/s]100%|██████████| 14/14 [00:02<00:00,  4.91it/s]
2025-03-09 10:22:47,899 [INFO]: 	Computing best hyperparameters for index knn.index 03/09/2025, 10:22:47
2025-03-09 10:23:24,978 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 37.0780 secs
2025-03-09 10:23:24,978 [INFO]: The best hyperparameters are: efSearch=246
2025-03-09 10:23:24,978 [INFO]: 	Compute fast metrics 03/09/2025, 10:23:24
  0%|          | 0/4 [00:00<?, ?it/s] 50%|█████     | 2/4 [00:00<00:00, 19.89it/s] 75%|███████▌  | 3/4 [00:00<00:00, 22.20it/s]
2025-03-09 10:23:38,795 [INFO]: 	>>> Finished "Compute fast metrics" in 13.8166 secs
2025-03-09 10:23:38,797 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 53.7509 secs
2025-03-09 10:23:38,797 [INFO]: {
2025-03-09 10:23:38,797 [INFO]: 	index_key: HNSW15
2025-03-09 10:23:38,797 [INFO]: 	index_param: efSearch=246
2025-03-09 10:23:38,797 [INFO]: 	index_path: knn.index
2025-03-09 10:23:38,797 [INFO]: 	size in bytes: 675224950
2025-03-09 10:23:38,797 [INFO]: 	avg_search_speed_ms: 10.94932479583159
2025-03-09 10:23:38,797 [INFO]: 	99p_search_speed_ms: 14.310797122307122
2025-03-09 10:23:38,797 [INFO]: 	reconstruction error %: 0.0
2025-03-09 10:23:38,797 [INFO]: 	nb vectors: 3432
2025-03-09 10:23:38,797 [INFO]: 	vectors dimension: 49152
2025-03-09 10:23:38,797 [INFO]: 	compression ratio: 0.9993094242148487
2025-03-09 10:23:38,797 [INFO]: }
2025-03-09 10:23:38,797 [INFO]: 	>>> Finished "Creating the index" in 53.7524 secs
2025-03-09 10:23:38,797 [INFO]: >>> Finished "Launching the whole pipeline" in 53.7802 secs
2025-03-09 10:23:40: [retrieval_preprocessing] calculating distances ...
2025-03-09 10:23:40: [retrieval_preprocessing] finished and saved retrieval indices for episode 75791 [episode count 5/20]
[retrieval_preprocessing] for episode 85007 [episode count 6/20], we have num_retrieval=np.int64(3476) num_query=np.int64(155)
2025-03-09 10:23:40,989 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-09 10:23:41,394 [INFO]: Launching the whole pipeline 03/09/2025, 10:23:41
2025-03-09 10:23:41,394 [INFO]: Reading total number of vectors and dimension 03/09/2025, 10:23:41
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1336.62it/s]
2025-03-09 10:23:41,420 [INFO]: There are 3476 embeddings of dim 49152
2025-03-09 10:23:41,420 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0267 secs
2025-03-09 10:23:41,421 [INFO]: 	Compute estimated construction time of the index 03/09/2025, 10:23:41
2025-03-09 10:23:41,421 [INFO]: 		-> Train: 16.7 minutes
2025-03-09 10:23:41,421 [INFO]: 		-> Add: 1.9 seconds
2025-03-09 10:23:41,421 [INFO]: 		Total: 16.7 minutes
2025-03-09 10:23:41,421 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0003 secs
2025-03-09 10:23:41,421 [INFO]: 	Checking that your have enough memory available to create the index 03/09/2025, 10:23:41
2025-03-09 10:23:41,421 [INFO]: 717.4MB of memory will be needed to build the index (more might be used if you have more)
2025-03-09 10:23:41,422 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0005 secs
2025-03-09 10:23:41,422 [INFO]: 	Selecting most promising index types given data characteristics 03/09/2025, 10:23:41
2025-03-09 10:23:41,422 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-09 10:23:41,422 [INFO]: 	Creating the index 03/09/2025, 10:23:41
2025-03-09 10:23:41,422 [INFO]: 		-> Instanciate the index HNSW15 03/09/2025, 10:23:41
2025-03-09 10:23:41,425 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0027 secs
2025-03-09 10:23:41,425 [INFO]: 		-> Adding the vectors to the index 03/09/2025, 10:23:41
2025-03-09 10:23:41,426 [INFO]: The memory available for adding the vectors is 49.4GB(total available - used by the index)
2025-03-09 10:23:41,426 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/14 [00:00<?, ?it/s] 21%|██▏       | 3/14 [00:00<00:00, 27.85it/s] 64%|██████▍   | 9/14 [00:00<00:00, 45.29it/s]100%|██████████| 14/14 [00:02<00:00,  3.91it/s]100%|██████████| 14/14 [00:02<00:00,  4.96it/s]
2025-03-09 10:23:44,253 [INFO]: 	Computing best hyperparameters for index knn.index 03/09/2025, 10:23:44
2025-03-09 10:24:21,249 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 36.9955 secs
2025-03-09 10:24:21,250 [INFO]: The best hyperparameters are: efSearch=257
2025-03-09 10:24:21,250 [INFO]: 	Compute fast metrics 03/09/2025, 10:24:21
  0%|          | 0/4 [00:00<?, ?it/s] 75%|███████▌  | 3/4 [00:00<00:00, 28.21it/s] 75%|███████▌  | 3/4 [00:00<00:00, 25.24it/s]
2025-03-09 10:24:34,569 [INFO]: 	>>> Finished "Compute fast metrics" in 13.3190 secs
2025-03-09 10:24:34,570 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 53.1451 secs
2025-03-09 10:24:34,571 [INFO]: {
2025-03-09 10:24:34,571 [INFO]: 	index_key: HNSW15
2025-03-09 10:24:34,571 [INFO]: 	index_param: efSearch=257
2025-03-09 10:24:34,571 [INFO]: 	index_path: knn.index
2025-03-09 10:24:34,571 [INFO]: 	size in bytes: 683881690
2025-03-09 10:24:34,571 [INFO]: 	avg_search_speed_ms: 11.663474737653521
2025-03-09 10:24:34,571 [INFO]: 	99p_search_speed_ms: 23.46690585603937
2025-03-09 10:24:34,571 [INFO]: 	reconstruction error %: 0.0
2025-03-09 10:24:34,571 [INFO]: 	nb vectors: 3476
2025-03-09 10:24:34,571 [INFO]: 	vectors dimension: 49152
2025-03-09 10:24:34,571 [INFO]: 	compression ratio: 0.9993094097898717
2025-03-09 10:24:34,571 [INFO]: }
2025-03-09 10:24:34,571 [INFO]: 	>>> Finished "Creating the index" in 53.1487 secs
2025-03-09 10:24:34,571 [INFO]: >>> Finished "Launching the whole pipeline" in 53.1772 secs
2025-03-09 10:24:35: [retrieval_preprocessing] calculating distances ...
2025-03-09 10:24:36: [retrieval_preprocessing] finished and saved retrieval indices for episode 85007 [episode count 6/20]
[retrieval_preprocessing] for episode 33819 [episode count 7/20], we have num_retrieval=np.int64(3372) num_query=np.int64(259)
2025-03-09 10:24:36,273 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-09 10:24:36,655 [INFO]: Launching the whole pipeline 03/09/2025, 10:24:36
2025-03-09 10:24:36,655 [INFO]: Reading total number of vectors and dimension 03/09/2025, 10:24:36
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1547.14it/s]
2025-03-09 10:24:36,681 [INFO]: There are 3372 embeddings of dim 49152
2025-03-09 10:24:36,681 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0263 secs
2025-03-09 10:24:36,681 [INFO]: 	Compute estimated construction time of the index 03/09/2025, 10:24:36
2025-03-09 10:24:36,681 [INFO]: 		-> Train: 16.7 minutes
2025-03-09 10:24:36,681 [INFO]: 		-> Add: 1.9 seconds
2025-03-09 10:24:36,681 [INFO]: 		Total: 16.7 minutes
2025-03-09 10:24:36,681 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0001 secs
2025-03-09 10:24:36,681 [INFO]: 	Checking that your have enough memory available to create the index 03/09/2025, 10:24:36
2025-03-09 10:24:36,681 [INFO]: 695.9MB of memory will be needed to build the index (more might be used if you have more)
2025-03-09 10:24:36,681 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0001 secs
2025-03-09 10:24:36,681 [INFO]: 	Selecting most promising index types given data characteristics 03/09/2025, 10:24:36
2025-03-09 10:24:36,681 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-09 10:24:36,682 [INFO]: 	Creating the index 03/09/2025, 10:24:36
2025-03-09 10:24:36,682 [INFO]: 		-> Instanciate the index HNSW15 03/09/2025, 10:24:36
2025-03-09 10:24:36,682 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0009 secs
2025-03-09 10:24:36,683 [INFO]: 		-> Adding the vectors to the index 03/09/2025, 10:24:36
2025-03-09 10:24:36,683 [INFO]: The memory available for adding the vectors is 49.4GB(total available - used by the index)
2025-03-09 10:24:36,683 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/14 [00:00<?, ?it/s]  7%|▋         | 1/14 [00:00<00:01,  9.67it/s] 57%|█████▋    | 8/14 [00:00<00:00, 41.24it/s]100%|██████████| 14/14 [00:02<00:00,  4.07it/s]100%|██████████| 14/14 [00:02<00:00,  4.85it/s]
2025-03-09 10:24:39,571 [INFO]: 	Computing best hyperparameters for index knn.index 03/09/2025, 10:24:39
2025-03-09 10:25:16,637 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 37.0656 secs
2025-03-09 10:25:16,637 [INFO]: The best hyperparameters are: efSearch=236
2025-03-09 10:25:16,637 [INFO]: 	Compute fast metrics 03/09/2025, 10:25:16
  0%|          | 0/4 [00:00<?, ?it/s] 75%|███████▌  | 3/4 [00:00<00:00, 26.95it/s] 75%|███████▌  | 3/4 [00:00<00:00, 23.39it/s]
2025-03-09 10:25:33,165 [INFO]: 	>>> Finished "Compute fast metrics" in 16.5281 secs
2025-03-09 10:25:33,167 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 56.4843 secs
2025-03-09 10:25:33,167 [INFO]: {
2025-03-09 10:25:33,167 [INFO]: 	index_key: HNSW15
2025-03-09 10:25:33,168 [INFO]: 	index_param: efSearch=236
2025-03-09 10:25:33,168 [INFO]: 	index_path: knn.index
2025-03-09 10:25:33,168 [INFO]: 	size in bytes: 663420370
2025-03-09 10:25:33,168 [INFO]: 	avg_search_speed_ms: 10.776504252511398
2025-03-09 10:25:33,168 [INFO]: 	99p_search_speed_ms: 17.0353150041774
2025-03-09 10:25:33,168 [INFO]: 	reconstruction error %: 0.0
2025-03-09 10:25:33,168 [INFO]: 	nb vectors: 3372
2025-03-09 10:25:33,168 [INFO]: 	vectors dimension: 49152
2025-03-09 10:25:33,168 [INFO]: 	compression ratio: 0.9993093458978355
2025-03-09 10:25:33,168 [INFO]: }
2025-03-09 10:25:33,168 [INFO]: 	>>> Finished "Creating the index" in 56.4861 secs
2025-03-09 10:25:33,168 [INFO]: >>> Finished "Launching the whole pipeline" in 56.5129 secs
2025-03-09 10:25:34: [retrieval_preprocessing] calculating distances ...
2025-03-09 10:25:35: [retrieval_preprocessing] finished and saved retrieval indices for episode 33819 [episode count 7/20]
[retrieval_preprocessing] for episode 73760 [episode count 8/20], we have num_retrieval=np.int64(3340) num_query=np.int64(291)
2025-03-09 10:25:35,857 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-09 10:25:36,238 [INFO]: Launching the whole pipeline 03/09/2025, 10:25:36
2025-03-09 10:25:36,239 [INFO]: Reading total number of vectors and dimension 03/09/2025, 10:25:36
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1728.90it/s]
2025-03-09 10:25:36,265 [INFO]: There are 3340 embeddings of dim 49152
2025-03-09 10:25:36,266 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0270 secs
2025-03-09 10:25:36,266 [INFO]: 	Compute estimated construction time of the index 03/09/2025, 10:25:36
2025-03-09 10:25:36,266 [INFO]: 		-> Train: 16.7 minutes
2025-03-09 10:25:36,266 [INFO]: 		-> Add: 1.8 seconds
2025-03-09 10:25:36,266 [INFO]: 		Total: 16.7 minutes
2025-03-09 10:25:36,266 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0001 secs
2025-03-09 10:25:36,266 [INFO]: 	Checking that your have enough memory available to create the index 03/09/2025, 10:25:36
2025-03-09 10:25:36,266 [INFO]: 689.3MB of memory will be needed to build the index (more might be used if you have more)
2025-03-09 10:25:36,266 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0001 secs
2025-03-09 10:25:36,266 [INFO]: 	Selecting most promising index types given data characteristics 03/09/2025, 10:25:36
2025-03-09 10:25:36,266 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-09 10:25:36,266 [INFO]: 	Creating the index 03/09/2025, 10:25:36
2025-03-09 10:25:36,266 [INFO]: 		-> Instanciate the index HNSW15 03/09/2025, 10:25:36
2025-03-09 10:25:36,267 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0010 secs
2025-03-09 10:25:36,267 [INFO]: 		-> Adding the vectors to the index 03/09/2025, 10:25:36
2025-03-09 10:25:36,267 [INFO]: The memory available for adding the vectors is 49.4GB(total available - used by the index)
2025-03-09 10:25:36,267 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/14 [00:00<?, ?it/s]  7%|▋         | 1/14 [00:00<00:01,  9.91it/s] 50%|█████     | 7/14 [00:00<00:00, 38.30it/s] 93%|█████████▎| 13/14 [00:00<00:00, 47.46it/s]100%|██████████| 14/14 [00:02<00:00,  4.97it/s]
2025-03-09 10:25:39,089 [INFO]: 	Computing best hyperparameters for index knn.index 03/09/2025, 10:25:39
2025-03-09 10:26:17,167 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 38.0779 secs
2025-03-09 10:26:17,167 [INFO]: The best hyperparameters are: efSearch=216
2025-03-09 10:26:17,167 [INFO]: 	Compute fast metrics 03/09/2025, 10:26:17
  0%|          | 0/4 [00:00<?, ?it/s] 75%|███████▌  | 3/4 [00:00<00:00, 27.36it/s] 75%|███████▌  | 3/4 [00:00<00:00, 23.57it/s]
2025-03-09 10:26:32,882 [INFO]: 	>>> Finished "Compute fast metrics" in 15.7143 secs
2025-03-09 10:26:32,883 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 56.6159 secs
2025-03-09 10:26:32,883 [INFO]: {
2025-03-09 10:26:32,883 [INFO]: 	index_key: HNSW15
2025-03-09 10:26:32,883 [INFO]: 	index_param: efSearch=216
2025-03-09 10:26:32,883 [INFO]: 	index_path: knn.index
2025-03-09 10:26:32,883 [INFO]: 	size in bytes: 657124690
2025-03-09 10:26:32,883 [INFO]: 	avg_search_speed_ms: 10.582016664433969
2025-03-09 10:26:32,883 [INFO]: 	99p_search_speed_ms: 16.632533958181735
2025-03-09 10:26:32,883 [INFO]: 	reconstruction error %: 0.0
2025-03-09 10:26:32,884 [INFO]: 	nb vectors: 3340
2025-03-09 10:26:32,884 [INFO]: 	vectors dimension: 49152
2025-03-09 10:26:32,884 [INFO]: 	compression ratio: 0.9993091569881509
2025-03-09 10:26:32,884 [INFO]: }
2025-03-09 10:26:32,884 [INFO]: 	>>> Finished "Creating the index" in 56.6174 secs
2025-03-09 10:26:32,884 [INFO]: >>> Finished "Launching the whole pipeline" in 56.6450 secs
2025-03-09 10:26:34: [retrieval_preprocessing] calculating distances ...
2025-03-09 10:26:34: [retrieval_preprocessing] finished and saved retrieval indices for episode 73760 [episode count 8/20]
[retrieval_preprocessing] for episode 19495 [episode count 9/20], we have num_retrieval=np.int64(3502) num_query=np.int64(129)
2025-03-09 10:26:34,839 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-09 10:26:35,274 [INFO]: Launching the whole pipeline 03/09/2025, 10:26:35
2025-03-09 10:26:35,274 [INFO]: Reading total number of vectors and dimension 03/09/2025, 10:26:35
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 2335.36it/s]
2025-03-09 10:26:35,298 [INFO]: There are 3502 embeddings of dim 49152
2025-03-09 10:26:35,298 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0241 secs
2025-03-09 10:26:35,298 [INFO]: 	Compute estimated construction time of the index 03/09/2025, 10:26:35
2025-03-09 10:26:35,298 [INFO]: 		-> Train: 16.7 minutes
2025-03-09 10:26:35,298 [INFO]: 		-> Add: 1.9 seconds
2025-03-09 10:26:35,298 [INFO]: 		Total: 16.7 minutes
2025-03-09 10:26:35,298 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0001 secs
2025-03-09 10:26:35,298 [INFO]: 	Checking that your have enough memory available to create the index 03/09/2025, 10:26:35
2025-03-09 10:26:35,298 [INFO]: 722.7MB of memory will be needed to build the index (more might be used if you have more)
2025-03-09 10:26:35,298 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0001 secs
2025-03-09 10:26:35,298 [INFO]: 	Selecting most promising index types given data characteristics 03/09/2025, 10:26:35
2025-03-09 10:26:35,299 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-09 10:26:35,299 [INFO]: 	Creating the index 03/09/2025, 10:26:35
2025-03-09 10:26:35,299 [INFO]: 		-> Instanciate the index HNSW15 03/09/2025, 10:26:35
2025-03-09 10:26:35,300 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0009 secs
2025-03-09 10:26:35,300 [INFO]: 		-> Adding the vectors to the index 03/09/2025, 10:26:35
2025-03-09 10:26:35,300 [INFO]: The memory available for adding the vectors is 49.4GB(total available - used by the index)
2025-03-09 10:26:35,300 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/14 [00:00<?, ?it/s]  7%|▋         | 1/14 [00:00<00:01,  9.75it/s] 43%|████▎     | 6/14 [00:00<00:00, 30.37it/s] 93%|█████████▎| 13/14 [00:00<00:00, 45.01it/s]100%|██████████| 14/14 [00:02<00:00,  4.79it/s]
2025-03-09 10:26:38,225 [INFO]: 	Computing best hyperparameters for index knn.index 03/09/2025, 10:26:38
2025-03-09 10:27:15,472 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 37.2458 secs
2025-03-09 10:27:15,472 [INFO]: The best hyperparameters are: efSearch=245
2025-03-09 10:27:15,472 [INFO]: 	Compute fast metrics 03/09/2025, 10:27:15
  0%|          | 0/4 [00:00<?, ?it/s] 75%|███████▌  | 3/4 [00:00<00:00, 27.23it/s] 75%|███████▌  | 3/4 [00:00<00:00, 23.91it/s]
2025-03-09 10:27:31,476 [INFO]: 	>>> Finished "Compute fast metrics" in 16.0037 secs
2025-03-09 10:27:31,477 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 56.1775 secs
2025-03-09 10:27:31,477 [INFO]: {
2025-03-09 10:27:31,477 [INFO]: 	index_key: HNSW15
2025-03-09 10:27:31,477 [INFO]: 	index_param: efSearch=245
2025-03-09 10:27:31,477 [INFO]: 	index_path: knn.index
2025-03-09 10:27:31,477 [INFO]: 	size in bytes: 688996990
2025-03-09 10:27:31,477 [INFO]: 	avg_search_speed_ms: 10.830660518188255
2025-03-09 10:27:31,477 [INFO]: 	99p_search_speed_ms: 14.064384044613687
2025-03-09 10:27:31,477 [INFO]: 	reconstruction error %: 0.0
2025-03-09 10:27:31,477 [INFO]: 	nb vectors: 3502
2025-03-09 10:27:31,477 [INFO]: 	vectors dimension: 49152
2025-03-09 10:27:31,477 [INFO]: 	compression ratio: 0.9993094686814235
2025-03-09 10:27:31,478 [INFO]: }
2025-03-09 10:27:31,478 [INFO]: 	>>> Finished "Creating the index" in 56.1789 secs
2025-03-09 10:27:31,478 [INFO]: >>> Finished "Launching the whole pipeline" in 56.2037 secs
2025-03-09 10:27:32: [retrieval_preprocessing] calculating distances ...
2025-03-09 10:27:32: [retrieval_preprocessing] finished and saved retrieval indices for episode 19495 [episode count 9/20]
[retrieval_preprocessing] for episode 28715 [episode count 10/20], we have num_retrieval=np.int64(3488) num_query=np.int64(143)
2025-03-09 10:27:32,968 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-09 10:27:33,402 [INFO]: Launching the whole pipeline 03/09/2025, 10:27:33
2025-03-09 10:27:33,402 [INFO]: Reading total number of vectors and dimension 03/09/2025, 10:27:33
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 2242.94it/s]
2025-03-09 10:27:33,430 [INFO]: There are 3488 embeddings of dim 49152
2025-03-09 10:27:33,430 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0276 secs
2025-03-09 10:27:33,430 [INFO]: 	Compute estimated construction time of the index 03/09/2025, 10:27:33
2025-03-09 10:27:33,430 [INFO]: 		-> Train: 16.7 minutes
2025-03-09 10:27:33,430 [INFO]: 		-> Add: 1.9 seconds
2025-03-09 10:27:33,430 [INFO]: 		Total: 16.7 minutes
2025-03-09 10:27:33,430 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0001 secs
2025-03-09 10:27:33,430 [INFO]: 	Checking that your have enough memory available to create the index 03/09/2025, 10:27:33
2025-03-09 10:27:33,430 [INFO]: 719.8MB of memory will be needed to build the index (more might be used if you have more)
2025-03-09 10:27:33,430 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0002 secs
2025-03-09 10:27:33,430 [INFO]: 	Selecting most promising index types given data characteristics 03/09/2025, 10:27:33
2025-03-09 10:27:33,430 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-09 10:27:33,430 [INFO]: 	Creating the index 03/09/2025, 10:27:33
2025-03-09 10:27:33,430 [INFO]: 		-> Instanciate the index HNSW15 03/09/2025, 10:27:33
2025-03-09 10:27:33,432 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0011 secs
2025-03-09 10:27:33,432 [INFO]: 		-> Adding the vectors to the index 03/09/2025, 10:27:33
2025-03-09 10:27:33,432 [INFO]: The memory available for adding the vectors is 49.4GB(total available - used by the index)
2025-03-09 10:27:33,432 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/14 [00:00<?, ?it/s]  7%|▋         | 1/14 [00:00<00:01,  8.50it/s] 50%|█████     | 7/14 [00:00<00:00, 35.85it/s] 93%|█████████▎| 13/14 [00:00<00:00, 45.34it/s]100%|██████████| 14/14 [00:03<00:00,  4.41it/s]
2025-03-09 10:27:36,612 [INFO]: 	Computing best hyperparameters for index knn.index 03/09/2025, 10:27:36
2025-03-09 10:28:15,304 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 38.6914 secs
2025-03-09 10:28:15,304 [INFO]: The best hyperparameters are: efSearch=223
2025-03-09 10:28:15,304 [INFO]: 	Compute fast metrics 03/09/2025, 10:28:15
  0%|          | 0/4 [00:00<?, ?it/s] 75%|███████▌  | 3/4 [00:00<00:00, 26.54it/s] 75%|███████▌  | 3/4 [00:00<00:00, 22.91it/s]
2025-03-09 10:28:30,117 [INFO]: 	>>> Finished "Compute fast metrics" in 14.8126 secs
2025-03-09 10:28:30,119 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 56.6869 secs
2025-03-09 10:28:30,119 [INFO]: {
2025-03-09 10:28:30,119 [INFO]: 	index_key: HNSW15
2025-03-09 10:28:30,119 [INFO]: 	index_param: efSearch=223
2025-03-09 10:28:30,119 [INFO]: 	index_path: knn.index
2025-03-09 10:28:30,119 [INFO]: 	size in bytes: 686242570
2025-03-09 10:28:30,119 [INFO]: 	avg_search_speed_ms: 10.507486917630246
2025-03-09 10:28:30,119 [INFO]: 	99p_search_speed_ms: 14.10286997212097
2025-03-09 10:28:30,119 [INFO]: 	reconstruction error %: 0.0
2025-03-09 10:28:30,119 [INFO]: 	nb vectors: 3488
2025-03-09 10:28:30,119 [INFO]: 	vectors dimension: 49152
2025-03-09 10:28:30,119 [INFO]: 	compression ratio: 0.9993094774053437
2025-03-09 10:28:30,119 [INFO]: }
2025-03-09 10:28:30,119 [INFO]: 	>>> Finished "Creating the index" in 56.6886 secs
2025-03-09 10:28:30,119 [INFO]: >>> Finished "Launching the whole pipeline" in 56.7168 secs
2025-03-09 10:28:30: [retrieval_preprocessing] calculating distances ...
2025-03-09 10:28:31: [retrieval_preprocessing] finished and saved retrieval indices for episode 28715 [episode count 10/20]
[retrieval_preprocessing] for episode 6193 [episode count 11/20], we have num_retrieval=np.int64(3498) num_query=np.int64(133)
2025-03-09 10:28:31,345 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-09 10:28:31,749 [INFO]: Launching the whole pipeline 03/09/2025, 10:28:31
2025-03-09 10:28:31,749 [INFO]: Reading total number of vectors and dimension 03/09/2025, 10:28:31
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1603.94it/s]
2025-03-09 10:28:31,776 [INFO]: There are 3498 embeddings of dim 49152
2025-03-09 10:28:31,776 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0267 secs
2025-03-09 10:28:31,776 [INFO]: 	Compute estimated construction time of the index 03/09/2025, 10:28:31
2025-03-09 10:28:31,776 [INFO]: 		-> Train: 16.7 minutes
2025-03-09 10:28:31,776 [INFO]: 		-> Add: 1.9 seconds
2025-03-09 10:28:31,776 [INFO]: 		Total: 16.7 minutes
2025-03-09 10:28:31,776 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0001 secs
2025-03-09 10:28:31,776 [INFO]: 	Checking that your have enough memory available to create the index 03/09/2025, 10:28:31
2025-03-09 10:28:31,776 [INFO]: 721.9MB of memory will be needed to build the index (more might be used if you have more)
2025-03-09 10:28:31,776 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0001 secs
2025-03-09 10:28:31,776 [INFO]: 	Selecting most promising index types given data characteristics 03/09/2025, 10:28:31
2025-03-09 10:28:31,776 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-09 10:28:31,776 [INFO]: 	Creating the index 03/09/2025, 10:28:31
2025-03-09 10:28:31,777 [INFO]: 		-> Instanciate the index HNSW15 03/09/2025, 10:28:31
2025-03-09 10:28:31,777 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0009 secs
2025-03-09 10:28:31,778 [INFO]: 		-> Adding the vectors to the index 03/09/2025, 10:28:31
2025-03-09 10:28:31,778 [INFO]: The memory available for adding the vectors is 49.4GB(total available - used by the index)
2025-03-09 10:28:31,778 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/14 [00:00<?, ?it/s]  7%|▋         | 1/14 [00:00<00:01,  8.53it/s] 50%|█████     | 7/14 [00:00<00:00, 35.94it/s] 93%|█████████▎| 13/14 [00:00<00:00, 46.06it/s]100%|██████████| 14/14 [00:02<00:00,  5.09it/s]
2025-03-09 10:28:34,532 [INFO]: 	Computing best hyperparameters for index knn.index 03/09/2025, 10:28:34
2025-03-09 10:29:11,643 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 37.1108 secs
2025-03-09 10:29:11,643 [INFO]: The best hyperparameters are: efSearch=254
2025-03-09 10:29:11,643 [INFO]: 	Compute fast metrics 03/09/2025, 10:29:11
  0%|          | 0/4 [00:00<?, ?it/s] 75%|███████▌  | 3/4 [00:00<00:00, 26.55it/s] 75%|███████▌  | 3/4 [00:00<00:00, 23.31it/s]
2025-03-09 10:29:25,174 [INFO]: 	>>> Finished "Compute fast metrics" in 13.5310 secs
2025-03-09 10:29:25,176 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 53.3989 secs
2025-03-09 10:29:25,177 [INFO]: {
2025-03-09 10:29:25,177 [INFO]: 	index_key: HNSW15
2025-03-09 10:29:25,177 [INFO]: 	index_param: efSearch=254
2025-03-09 10:29:25,177 [INFO]: 	index_path: knn.index
2025-03-09 10:29:25,177 [INFO]: 	size in bytes: 688209970
2025-03-09 10:29:25,177 [INFO]: 	avg_search_speed_ms: 11.621200702662616
2025-03-09 10:29:25,177 [INFO]: 	99p_search_speed_ms: 17.601428693160415
2025-03-09 10:29:25,177 [INFO]: 	reconstruction error %: 0.0
2025-03-09 10:29:25,177 [INFO]: 	nb vectors: 3498
2025-03-09 10:29:25,177 [INFO]: 	vectors dimension: 49152
2025-03-09 10:29:25,177 [INFO]: 	compression ratio: 0.9993095333971985
2025-03-09 10:29:25,177 [INFO]: }
2025-03-09 10:29:25,177 [INFO]: 	>>> Finished "Creating the index" in 53.4002 secs
2025-03-09 10:29:25,177 [INFO]: >>> Finished "Launching the whole pipeline" in 53.4276 secs
2025-03-09 10:29:26: [retrieval_preprocessing] calculating distances ...
2025-03-09 10:29:26: [retrieval_preprocessing] finished and saved retrieval indices for episode 6193 [episode count 11/20]
[retrieval_preprocessing] for episode 39986 [episode count 12/20], we have num_retrieval=np.int64(3482) num_query=np.int64(149)
2025-03-09 10:29:26,550 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-09 10:29:26,913 [INFO]: Launching the whole pipeline 03/09/2025, 10:29:26
2025-03-09 10:29:26,913 [INFO]: Reading total number of vectors and dimension 03/09/2025, 10:29:26
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1227.84it/s]
2025-03-09 10:29:26,943 [INFO]: There are 3482 embeddings of dim 49152
2025-03-09 10:29:26,943 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0304 secs
2025-03-09 10:29:26,943 [INFO]: 	Compute estimated construction time of the index 03/09/2025, 10:29:26
2025-03-09 10:29:26,944 [INFO]: 		-> Train: 16.7 minutes
2025-03-09 10:29:26,944 [INFO]: 		-> Add: 1.9 seconds
2025-03-09 10:29:26,944 [INFO]: 		Total: 16.7 minutes
2025-03-09 10:29:26,944 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0004 secs
2025-03-09 10:29:26,944 [INFO]: 	Checking that your have enough memory available to create the index 03/09/2025, 10:29:26
2025-03-09 10:29:26,944 [INFO]: 718.6MB of memory will be needed to build the index (more might be used if you have more)
2025-03-09 10:29:26,944 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0004 secs
2025-03-09 10:29:26,945 [INFO]: 	Selecting most promising index types given data characteristics 03/09/2025, 10:29:26
2025-03-09 10:29:26,945 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-09 10:29:26,945 [INFO]: 	Creating the index 03/09/2025, 10:29:26
2025-03-09 10:29:26,945 [INFO]: 		-> Instanciate the index HNSW15 03/09/2025, 10:29:26
2025-03-09 10:29:26,948 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0026 secs
2025-03-09 10:29:26,948 [INFO]: 		-> Adding the vectors to the index 03/09/2025, 10:29:26
2025-03-09 10:29:26,948 [INFO]: The memory available for adding the vectors is 49.4GB(total available - used by the index)
2025-03-09 10:29:26,948 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/14 [00:00<?, ?it/s] 14%|█▍        | 2/14 [00:00<00:00, 19.41it/s] 64%|██████▍   | 9/14 [00:00<00:00, 47.50it/s]100%|██████████| 14/14 [00:02<00:00,  4.07it/s]100%|██████████| 14/14 [00:02<00:00,  5.07it/s]
2025-03-09 10:29:29,715 [INFO]: 	Computing best hyperparameters for index knn.index 03/09/2025, 10:29:29
2025-03-09 10:30:04,820 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 35.1043 secs
2025-03-09 10:30:04,820 [INFO]: The best hyperparameters are: efSearch=264
2025-03-09 10:30:04,820 [INFO]: 	Compute fast metrics 03/09/2025, 10:30:04
  0%|          | 0/4 [00:00<?, ?it/s] 75%|███████▌  | 3/4 [00:00<00:00, 27.54it/s]
2025-03-09 10:30:18,369 [INFO]: 	>>> Finished "Compute fast metrics" in 13.5489 secs
2025-03-09 10:30:18,371 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 51.4230 secs
2025-03-09 10:30:18,371 [INFO]: {
2025-03-09 10:30:18,371 [INFO]: 	index_key: HNSW15
2025-03-09 10:30:18,371 [INFO]: 	index_param: efSearch=264
2025-03-09 10:30:18,371 [INFO]: 	index_path: knn.index
2025-03-09 10:30:18,371 [INFO]: 	size in bytes: 685062130
2025-03-09 10:30:18,371 [INFO]: 	avg_search_speed_ms: 11.066792441111684
2025-03-09 10:30:18,371 [INFO]: 	99p_search_speed_ms: 13.870085389353337
2025-03-09 10:30:18,371 [INFO]: 	reconstruction error %: 0.0
2025-03-09 10:30:18,371 [INFO]: 	nb vectors: 3482
2025-03-09 10:30:18,371 [INFO]: 	vectors dimension: 49152
2025-03-09 10:30:18,371 [INFO]: 	compression ratio: 0.9993094436558623
2025-03-09 10:30:18,371 [INFO]: }
2025-03-09 10:30:18,371 [INFO]: 	>>> Finished "Creating the index" in 51.4265 secs
2025-03-09 10:30:18,371 [INFO]: >>> Finished "Launching the whole pipeline" in 51.4585 secs
2025-03-09 10:30:19: [retrieval_preprocessing] calculating distances ...
2025-03-09 10:30:19: [retrieval_preprocessing] finished and saved retrieval indices for episode 39986 [episode count 12/20]
[retrieval_preprocessing] for episode 77887 [episode count 13/20], we have num_retrieval=np.int64(3530) num_query=np.int64(101)
2025-03-09 10:30:19,857 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-09 10:30:20,229 [INFO]: Launching the whole pipeline 03/09/2025, 10:30:20
2025-03-09 10:30:20,230 [INFO]: Reading total number of vectors and dimension 03/09/2025, 10:30:20
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1679.06it/s]
2025-03-09 10:30:20,256 [INFO]: There are 3530 embeddings of dim 49152
2025-03-09 10:30:20,256 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0265 secs
2025-03-09 10:30:20,256 [INFO]: 	Compute estimated construction time of the index 03/09/2025, 10:30:20
2025-03-09 10:30:20,256 [INFO]: 		-> Train: 16.7 minutes
2025-03-09 10:30:20,256 [INFO]: 		-> Add: 1.9 seconds
2025-03-09 10:30:20,256 [INFO]: 		Total: 16.7 minutes
2025-03-09 10:30:20,256 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0001 secs
2025-03-09 10:30:20,256 [INFO]: 	Checking that your have enough memory available to create the index 03/09/2025, 10:30:20
2025-03-09 10:30:20,256 [INFO]: 728.5MB of memory will be needed to build the index (more might be used if you have more)
2025-03-09 10:30:20,256 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0001 secs
2025-03-09 10:30:20,257 [INFO]: 	Selecting most promising index types given data characteristics 03/09/2025, 10:30:20
2025-03-09 10:30:20,257 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-09 10:30:20,257 [INFO]: 	Creating the index 03/09/2025, 10:30:20
2025-03-09 10:30:20,257 [INFO]: 		-> Instanciate the index HNSW15 03/09/2025, 10:30:20
2025-03-09 10:30:20,258 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0011 secs
2025-03-09 10:30:20,258 [INFO]: 		-> Adding the vectors to the index 03/09/2025, 10:30:20
2025-03-09 10:30:20,258 [INFO]: The memory available for adding the vectors is 49.4GB(total available - used by the index)
2025-03-09 10:30:20,258 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/14 [00:00<?, ?it/s]  7%|▋         | 1/14 [00:00<00:01,  8.76it/s] 57%|█████▋    | 8/14 [00:00<00:00, 40.74it/s]100%|██████████| 14/14 [00:02<00:00,  4.12it/s]100%|██████████| 14/14 [00:02<00:00,  4.90it/s]
2025-03-09 10:30:23,117 [INFO]: 	Computing best hyperparameters for index knn.index 03/09/2025, 10:30:23
2025-03-09 10:30:57,596 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 34.4791 secs
2025-03-09 10:30:57,596 [INFO]: The best hyperparameters are: efSearch=269
2025-03-09 10:30:57,596 [INFO]: 	Compute fast metrics 03/09/2025, 10:30:57
  0%|          | 0/4 [00:00<?, ?it/s] 75%|███████▌  | 3/4 [00:00<00:00, 28.10it/s] 75%|███████▌  | 3/4 [00:00<00:00, 25.05it/s]
2025-03-09 10:31:10,599 [INFO]: 	>>> Finished "Compute fast metrics" in 13.0029 secs
2025-03-09 10:31:10,601 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 50.3430 secs
2025-03-09 10:31:10,601 [INFO]: {
2025-03-09 10:31:10,601 [INFO]: 	index_key: HNSW15
2025-03-09 10:31:10,601 [INFO]: 	index_param: efSearch=269
2025-03-09 10:31:10,601 [INFO]: 	index_path: knn.index
2025-03-09 10:31:10,601 [INFO]: 	size in bytes: 694505770
2025-03-09 10:31:10,601 [INFO]: 	avg_search_speed_ms: 11.066894801601405
2025-03-09 10:31:10,601 [INFO]: 	99p_search_speed_ms: 14.257511179894212
2025-03-09 10:31:10,601 [INFO]: 	reconstruction error %: 0.0
2025-03-09 10:31:10,601 [INFO]: 	nb vectors: 3530
2025-03-09 10:31:10,601 [INFO]: 	vectors dimension: 49152
2025-03-09 10:31:10,601 [INFO]: 	compression ratio: 0.9993095377738906
2025-03-09 10:31:10,601 [INFO]: }
2025-03-09 10:31:10,601 [INFO]: 	>>> Finished "Creating the index" in 50.3446 secs
2025-03-09 10:31:10,601 [INFO]: >>> Finished "Launching the whole pipeline" in 50.3717 secs
2025-03-09 10:31:11: [retrieval_preprocessing] calculating distances ...
2025-03-09 10:31:11: [retrieval_preprocessing] finished and saved retrieval indices for episode 77887 [episode count 13/20]
[retrieval_preprocessing] for episode 25156 [episode count 14/20], we have num_retrieval=np.int64(3249) num_query=np.int64(382)
2025-03-09 10:31:11,778 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-09 10:31:12,120 [INFO]: Launching the whole pipeline 03/09/2025, 10:31:12
2025-03-09 10:31:12,120 [INFO]: Reading total number of vectors and dimension 03/09/2025, 10:31:12
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 2368.33it/s]
2025-03-09 10:31:12,147 [INFO]: There are 3249 embeddings of dim 49152
2025-03-09 10:31:12,147 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0265 secs
2025-03-09 10:31:12,147 [INFO]: 	Compute estimated construction time of the index 03/09/2025, 10:31:12
2025-03-09 10:31:12,147 [INFO]: 		-> Train: 16.7 minutes
2025-03-09 10:31:12,147 [INFO]: 		-> Add: 1.8 seconds
2025-03-09 10:31:12,147 [INFO]: 		Total: 16.7 minutes
2025-03-09 10:31:12,147 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0001 secs
2025-03-09 10:31:12,147 [INFO]: 	Checking that your have enough memory available to create the index 03/09/2025, 10:31:12
2025-03-09 10:31:12,147 [INFO]: 670.5MB of memory will be needed to build the index (more might be used if you have more)
2025-03-09 10:31:12,147 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0001 secs
2025-03-09 10:31:12,147 [INFO]: 	Selecting most promising index types given data characteristics 03/09/2025, 10:31:12
2025-03-09 10:31:12,147 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-09 10:31:12,147 [INFO]: 	Creating the index 03/09/2025, 10:31:12
2025-03-09 10:31:12,147 [INFO]: 		-> Instanciate the index HNSW15 03/09/2025, 10:31:12
2025-03-09 10:31:12,148 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0010 secs
2025-03-09 10:31:12,148 [INFO]: 		-> Adding the vectors to the index 03/09/2025, 10:31:12
2025-03-09 10:31:12,148 [INFO]: The memory available for adding the vectors is 49.4GB(total available - used by the index)
2025-03-09 10:31:12,149 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/13 [00:00<?, ?it/s] 23%|██▎       | 3/13 [00:00<00:00, 27.28it/s] 77%|███████▋  | 10/13 [00:00<00:00, 50.74it/s]100%|██████████| 13/13 [00:02<00:00,  5.18it/s]
2025-03-09 10:31:14,659 [INFO]: 	Computing best hyperparameters for index knn.index 03/09/2025, 10:31:14
2025-03-09 10:31:47,873 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 33.2134 secs
2025-03-09 10:31:47,874 [INFO]: The best hyperparameters are: efSearch=261
2025-03-09 10:31:47,874 [INFO]: 	Compute fast metrics 03/09/2025, 10:31:47
  0%|          | 0/4 [00:00<?, ?it/s] 75%|███████▌  | 3/4 [00:00<00:00, 26.35it/s] 75%|███████▌  | 3/4 [00:00<00:00, 22.85it/s]
2025-03-09 10:32:00,793 [INFO]: 	>>> Finished "Compute fast metrics" in 12.9195 secs
2025-03-09 10:32:00,795 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 48.6464 secs
2025-03-09 10:32:00,795 [INFO]: {
2025-03-09 10:32:00,795 [INFO]: 	index_key: HNSW15
2025-03-09 10:32:00,795 [INFO]: 	index_param: efSearch=261
2025-03-09 10:32:00,795 [INFO]: 	index_path: knn.index
2025-03-09 10:32:00,795 [INFO]: 	size in bytes: 639220990
2025-03-09 10:32:00,795 [INFO]: 	avg_search_speed_ms: 11.096550701258337
2025-03-09 10:32:00,795 [INFO]: 	99p_search_speed_ms: 14.382533617317677
2025-03-09 10:32:00,795 [INFO]: 	reconstruction error %: 0.0
2025-03-09 10:32:00,795 [INFO]: 	nb vectors: 3249
2025-03-09 10:32:00,795 [INFO]: 	vectors dimension: 49152
2025-03-09 10:32:00,795 [INFO]: 	compression ratio: 0.9993091622351137
2025-03-09 10:32:00,795 [INFO]: }
2025-03-09 10:32:00,795 [INFO]: 	>>> Finished "Creating the index" in 48.6478 secs
2025-03-09 10:32:00,795 [INFO]: >>> Finished "Launching the whole pipeline" in 48.6748 secs
2025-03-09 10:32:03: [retrieval_preprocessing] calculating distances ...
2025-03-09 10:32:04: [retrieval_preprocessing] finished and saved retrieval indices for episode 25156 [episode count 14/20]
[retrieval_preprocessing] for episode 19527 [episode count 15/20], we have num_retrieval=np.int64(3540) num_query=np.int64(91)
2025-03-09 10:32:05,144 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-09 10:32:05,654 [INFO]: Launching the whole pipeline 03/09/2025, 10:32:05
2025-03-09 10:32:05,654 [INFO]: Reading total number of vectors and dimension 03/09/2025, 10:32:05
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 937.69it/s]
2025-03-09 10:32:05,699 [INFO]: There are 3540 embeddings of dim 49152
2025-03-09 10:32:05,699 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0450 secs
2025-03-09 10:32:05,699 [INFO]: 	Compute estimated construction time of the index 03/09/2025, 10:32:05
2025-03-09 10:32:05,699 [INFO]: 		-> Train: 16.7 minutes
2025-03-09 10:32:05,699 [INFO]: 		-> Add: 1.9 seconds
2025-03-09 10:32:05,699 [INFO]: 		Total: 16.7 minutes
2025-03-09 10:32:05,699 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0002 secs
2025-03-09 10:32:05,699 [INFO]: 	Checking that your have enough memory available to create the index 03/09/2025, 10:32:05
2025-03-09 10:32:05,699 [INFO]: 730.6MB of memory will be needed to build the index (more might be used if you have more)
2025-03-09 10:32:05,700 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0002 secs
2025-03-09 10:32:05,700 [INFO]: 	Selecting most promising index types given data characteristics 03/09/2025, 10:32:05
2025-03-09 10:32:05,700 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-09 10:32:05,700 [INFO]: 	Creating the index 03/09/2025, 10:32:05
2025-03-09 10:32:05,700 [INFO]: 		-> Instanciate the index HNSW15 03/09/2025, 10:32:05
2025-03-09 10:32:05,702 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0019 secs
2025-03-09 10:32:05,702 [INFO]: 		-> Adding the vectors to the index 03/09/2025, 10:32:05
2025-03-09 10:32:05,703 [INFO]: The memory available for adding the vectors is 49.4GB(total available - used by the index)
2025-03-09 10:32:05,703 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/14 [00:00<?, ?it/s]  7%|▋         | 1/14 [00:00<00:01,  9.12it/s] 57%|█████▋    | 8/14 [00:00<00:00, 41.59it/s]100%|██████████| 14/14 [00:02<00:00,  4.25it/s]100%|██████████| 14/14 [00:02<00:00,  5.06it/s]
2025-03-09 10:32:08,475 [INFO]: 	Computing best hyperparameters for index knn.index 03/09/2025, 10:32:08
2025-03-09 10:32:42,093 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 33.6176 secs
2025-03-09 10:32:42,094 [INFO]: The best hyperparameters are: efSearch=268
2025-03-09 10:32:42,094 [INFO]: 	Compute fast metrics 03/09/2025, 10:32:42
  0%|          | 0/4 [00:00<?, ?it/s] 75%|███████▌  | 3/4 [00:00<00:00, 26.18it/s] 75%|███████▌  | 3/4 [00:00<00:00, 23.07it/s]
2025-03-09 10:32:56,801 [INFO]: 	>>> Finished "Compute fast metrics" in 14.7074 secs
2025-03-09 10:32:56,803 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 51.1004 secs
2025-03-09 10:32:56,803 [INFO]: {
2025-03-09 10:32:56,803 [INFO]: 	index_key: HNSW15
2025-03-09 10:32:56,803 [INFO]: 	index_param: efSearch=268
2025-03-09 10:32:56,803 [INFO]: 	index_path: knn.index
2025-03-09 10:32:56,803 [INFO]: 	size in bytes: 696473170
2025-03-09 10:32:56,803 [INFO]: 	avg_search_speed_ms: 11.232478441419676
2025-03-09 10:32:56,803 [INFO]: 	99p_search_speed_ms: 14.959383942186834
2025-03-09 10:32:56,803 [INFO]: 	reconstruction error %: 0.0
2025-03-09 10:32:56,803 [INFO]: 	nb vectors: 3540
2025-03-09 10:32:56,803 [INFO]: 	vectors dimension: 49152
2025-03-09 10:32:56,803 [INFO]: 	compression ratio: 0.9993095929309093
2025-03-09 10:32:56,803 [INFO]: }
2025-03-09 10:32:56,803 [INFO]: 	>>> Finished "Creating the index" in 51.1028 secs
2025-03-09 10:32:56,803 [INFO]: >>> Finished "Launching the whole pipeline" in 51.1493 secs
2025-03-09 10:32:57: [retrieval_preprocessing] calculating distances ...
2025-03-09 10:32:57: [retrieval_preprocessing] finished and saved retrieval indices for episode 19527 [episode count 15/20]
[retrieval_preprocessing] for episode 14936 [episode count 16/20], we have num_retrieval=np.int64(3441) num_query=np.int64(190)
2025-03-09 10:32:57,980 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-09 10:32:58,337 [INFO]: Launching the whole pipeline 03/09/2025, 10:32:58
2025-03-09 10:32:58,337 [INFO]: Reading total number of vectors and dimension 03/09/2025, 10:32:58
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 2027.21it/s]
2025-03-09 10:32:58,362 [INFO]: There are 3441 embeddings of dim 49152
2025-03-09 10:32:58,362 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0248 secs
2025-03-09 10:32:58,362 [INFO]: 	Compute estimated construction time of the index 03/09/2025, 10:32:58
2025-03-09 10:32:58,362 [INFO]: 		-> Train: 16.7 minutes
2025-03-09 10:32:58,362 [INFO]: 		-> Add: 1.9 seconds
2025-03-09 10:32:58,362 [INFO]: 		Total: 16.7 minutes
2025-03-09 10:32:58,362 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0001 secs
2025-03-09 10:32:58,362 [INFO]: 	Checking that your have enough memory available to create the index 03/09/2025, 10:32:58
2025-03-09 10:32:58,362 [INFO]: 710.1MB of memory will be needed to build the index (more might be used if you have more)
2025-03-09 10:32:58,362 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0001 secs
2025-03-09 10:32:58,362 [INFO]: 	Selecting most promising index types given data characteristics 03/09/2025, 10:32:58
2025-03-09 10:32:58,362 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-09 10:32:58,362 [INFO]: 	Creating the index 03/09/2025, 10:32:58
2025-03-09 10:32:58,362 [INFO]: 		-> Instanciate the index HNSW15 03/09/2025, 10:32:58
2025-03-09 10:32:58,363 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0009 secs
2025-03-09 10:32:58,363 [INFO]: 		-> Adding the vectors to the index 03/09/2025, 10:32:58
2025-03-09 10:32:58,363 [INFO]: The memory available for adding the vectors is 49.4GB(total available - used by the index)
2025-03-09 10:32:58,363 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/14 [00:00<?, ?it/s] 14%|█▍        | 2/14 [00:00<00:00, 18.26it/s] 64%|██████▍   | 9/14 [00:00<00:00, 46.16it/s]100%|██████████| 14/14 [00:02<00:00,  4.26it/s]100%|██████████| 14/14 [00:02<00:00,  5.29it/s]
2025-03-09 10:33:01,011 [INFO]: 	Computing best hyperparameters for index knn.index 03/09/2025, 10:33:01
2025-03-09 10:33:36,019 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 35.0072 secs
2025-03-09 10:33:36,019 [INFO]: The best hyperparameters are: efSearch=263
2025-03-09 10:33:36,019 [INFO]: 	Compute fast metrics 03/09/2025, 10:33:36
  0%|          | 0/4 [00:00<?, ?it/s] 75%|███████▌  | 3/4 [00:00<00:00, 28.19it/s] 75%|███████▌  | 3/4 [00:00<00:00, 25.20it/s]
2025-03-09 10:33:48,709 [INFO]: 	>>> Finished "Compute fast metrics" in 12.6894 secs
2025-03-09 10:33:48,710 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 50.3470 secs
2025-03-09 10:33:48,710 [INFO]: {
2025-03-09 10:33:48,710 [INFO]: 	index_key: HNSW15
2025-03-09 10:33:48,710 [INFO]: 	index_param: efSearch=263
2025-03-09 10:33:48,710 [INFO]: 	index_path: knn.index
2025-03-09 10:33:48,710 [INFO]: 	size in bytes: 676995670
2025-03-09 10:33:48,711 [INFO]: 	avg_search_speed_ms: 11.11472906001533
2025-03-09 10:33:48,711 [INFO]: 	99p_search_speed_ms: 14.293685106094927
2025-03-09 10:33:48,711 [INFO]: 	reconstruction error %: 0.0
2025-03-09 10:33:48,711 [INFO]: 	nb vectors: 3441
2025-03-09 10:33:48,711 [INFO]: 	vectors dimension: 49152
2025-03-09 10:33:48,711 [INFO]: 	compression ratio: 0.9993093870157249
2025-03-09 10:33:48,711 [INFO]: }
2025-03-09 10:33:48,711 [INFO]: 	>>> Finished "Creating the index" in 50.3483 secs
2025-03-09 10:33:48,711 [INFO]: >>> Finished "Launching the whole pipeline" in 50.3736 secs
2025-03-09 10:33:50: [retrieval_preprocessing] calculating distances ...
2025-03-09 10:33:50: [retrieval_preprocessing] finished and saved retrieval indices for episode 14936 [episode count 16/20]
[retrieval_preprocessing] for episode 54360 [episode count 17/20], we have num_retrieval=np.int64(3441) num_query=np.int64(190)
2025-03-09 10:33:50,661 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-09 10:33:51,025 [INFO]: Launching the whole pipeline 03/09/2025, 10:33:51
2025-03-09 10:33:51,025 [INFO]: Reading total number of vectors and dimension 03/09/2025, 10:33:51
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1991.60it/s]
2025-03-09 10:33:51,051 [INFO]: There are 3441 embeddings of dim 49152
2025-03-09 10:33:51,051 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0258 secs
2025-03-09 10:33:51,051 [INFO]: 	Compute estimated construction time of the index 03/09/2025, 10:33:51
2025-03-09 10:33:51,051 [INFO]: 		-> Train: 16.7 minutes
2025-03-09 10:33:51,051 [INFO]: 		-> Add: 1.9 seconds
2025-03-09 10:33:51,052 [INFO]: 		Total: 16.7 minutes
2025-03-09 10:33:51,052 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0004 secs
2025-03-09 10:33:51,052 [INFO]: 	Checking that your have enough memory available to create the index 03/09/2025, 10:33:51
2025-03-09 10:33:51,052 [INFO]: 710.1MB of memory will be needed to build the index (more might be used if you have more)
2025-03-09 10:33:51,052 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0004 secs
2025-03-09 10:33:51,052 [INFO]: 	Selecting most promising index types given data characteristics 03/09/2025, 10:33:51
2025-03-09 10:33:51,052 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-09 10:33:51,052 [INFO]: 	Creating the index 03/09/2025, 10:33:51
2025-03-09 10:33:51,053 [INFO]: 		-> Instanciate the index HNSW15 03/09/2025, 10:33:51
2025-03-09 10:33:51,055 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0026 secs
2025-03-09 10:33:51,056 [INFO]: 		-> Adding the vectors to the index 03/09/2025, 10:33:51
2025-03-09 10:33:51,056 [INFO]: The memory available for adding the vectors is 49.4GB(total available - used by the index)
2025-03-09 10:33:51,056 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/14 [00:00<?, ?it/s] 21%|██▏       | 3/14 [00:00<00:00, 27.29it/s] 86%|████████▌ | 12/14 [00:00<00:00, 58.94it/s]100%|██████████| 14/14 [00:02<00:00,  5.32it/s]
2025-03-09 10:33:53,690 [INFO]: 	Computing best hyperparameters for index knn.index 03/09/2025, 10:33:53
2025-03-09 10:34:27,615 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 33.9240 secs
2025-03-09 10:34:27,615 [INFO]: The best hyperparameters are: efSearch=265
2025-03-09 10:34:27,615 [INFO]: 	Compute fast metrics 03/09/2025, 10:34:27
  0%|          | 0/4 [00:00<?, ?it/s] 75%|███████▌  | 3/4 [00:00<00:00, 27.80it/s] 75%|███████▌  | 3/4 [00:00<00:00, 24.41it/s]
2025-03-09 10:34:40,264 [INFO]: 	>>> Finished "Compute fast metrics" in 12.6486 secs
2025-03-09 10:34:40,266 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 49.2098 secs
2025-03-09 10:34:40,266 [INFO]: {
2025-03-09 10:34:40,266 [INFO]: 	index_key: HNSW15
2025-03-09 10:34:40,266 [INFO]: 	index_param: efSearch=265
2025-03-09 10:34:40,266 [INFO]: 	index_path: knn.index
2025-03-09 10:34:40,266 [INFO]: 	size in bytes: 676995670
2025-03-09 10:34:40,266 [INFO]: 	avg_search_speed_ms: 11.28471090850414
2025-03-09 10:34:40,266 [INFO]: 	99p_search_speed_ms: 14.85783130628988
2025-03-09 10:34:40,266 [INFO]: 	reconstruction error %: 0.0
2025-03-09 10:34:40,266 [INFO]: 	nb vectors: 3441
2025-03-09 10:34:40,266 [INFO]: 	vectors dimension: 49152
2025-03-09 10:34:40,266 [INFO]: 	compression ratio: 0.9993093870157249
2025-03-09 10:34:40,266 [INFO]: }
2025-03-09 10:34:40,266 [INFO]: 	>>> Finished "Creating the index" in 49.2133 secs
2025-03-09 10:34:40,266 [INFO]: >>> Finished "Launching the whole pipeline" in 49.2407 secs
2025-03-09 10:34:41: [retrieval_preprocessing] calculating distances ...
2025-03-09 10:34:42: [retrieval_preprocessing] finished and saved retrieval indices for episode 54360 [episode count 17/20]
[retrieval_preprocessing] for episode 94808 [episode count 18/20], we have num_retrieval=np.int64(3450) num_query=np.int64(181)
2025-03-09 10:34:42,308 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-09 10:34:42,672 [INFO]: Launching the whole pipeline 03/09/2025, 10:34:42
2025-03-09 10:34:42,672 [INFO]: Reading total number of vectors and dimension 03/09/2025, 10:34:42
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 2289.47it/s]
2025-03-09 10:34:42,699 [INFO]: There are 3450 embeddings of dim 49152
2025-03-09 10:34:42,699 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0268 secs
2025-03-09 10:34:42,699 [INFO]: 	Compute estimated construction time of the index 03/09/2025, 10:34:42
2025-03-09 10:34:42,699 [INFO]: 		-> Train: 16.7 minutes
2025-03-09 10:34:42,699 [INFO]: 		-> Add: 1.9 seconds
2025-03-09 10:34:42,699 [INFO]: 		Total: 16.7 minutes
2025-03-09 10:34:42,700 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0003 secs
2025-03-09 10:34:42,700 [INFO]: 	Checking that your have enough memory available to create the index 03/09/2025, 10:34:42
2025-03-09 10:34:42,700 [INFO]: 712.0MB of memory will be needed to build the index (more might be used if you have more)
2025-03-09 10:34:42,700 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0004 secs
2025-03-09 10:34:42,700 [INFO]: 	Selecting most promising index types given data characteristics 03/09/2025, 10:34:42
2025-03-09 10:34:42,700 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-09 10:34:42,700 [INFO]: 	Creating the index 03/09/2025, 10:34:42
2025-03-09 10:34:42,700 [INFO]: 		-> Instanciate the index HNSW15 03/09/2025, 10:34:42
2025-03-09 10:34:42,703 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0029 secs
2025-03-09 10:34:42,704 [INFO]: 		-> Adding the vectors to the index 03/09/2025, 10:34:42
2025-03-09 10:34:42,704 [INFO]: The memory available for adding the vectors is 49.4GB(total available - used by the index)
2025-03-09 10:34:42,704 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/14 [00:00<?, ?it/s] 14%|█▍        | 2/14 [00:00<00:00, 18.41it/s] 64%|██████▍   | 9/14 [00:00<00:00, 46.46it/s]100%|██████████| 14/14 [00:02<00:00,  4.09it/s]100%|██████████| 14/14 [00:02<00:00,  5.09it/s]
2025-03-09 10:34:45,462 [INFO]: 	Computing best hyperparameters for index knn.index 03/09/2025, 10:34:45
2025-03-09 10:35:19,692 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 34.2290 secs
2025-03-09 10:35:19,692 [INFO]: The best hyperparameters are: efSearch=260
2025-03-09 10:35:19,692 [INFO]: 	Compute fast metrics 03/09/2025, 10:35:19
  0%|          | 0/4 [00:00<?, ?it/s] 75%|███████▌  | 3/4 [00:00<00:00, 28.80it/s] 75%|███████▌  | 3/4 [00:00<00:00, 25.69it/s]
2025-03-09 10:35:32,756 [INFO]: 	>>> Finished "Compute fast metrics" in 13.0644 secs
2025-03-09 10:35:32,758 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 50.0541 secs
2025-03-09 10:35:32,758 [INFO]: {
2025-03-09 10:35:32,758 [INFO]: 	index_key: HNSW15
2025-03-09 10:35:32,758 [INFO]: 	index_param: efSearch=260
2025-03-09 10:35:32,758 [INFO]: 	index_path: knn.index
2025-03-09 10:35:32,758 [INFO]: 	size in bytes: 678766390
2025-03-09 10:35:32,758 [INFO]: 	avg_search_speed_ms: 10.963501311024611
2025-03-09 10:35:32,758 [INFO]: 	99p_search_speed_ms: 13.983642058447003
2025-03-09 10:35:32,758 [INFO]: 	reconstruction error %: 0.0
2025-03-09 10:35:32,758 [INFO]: 	nb vectors: 3450
2025-03-09 10:35:32,758 [INFO]: 	vectors dimension: 49152
2025-03-09 10:35:32,758 [INFO]: 	compression ratio: 0.9993093500106863
2025-03-09 10:35:32,758 [INFO]: }
2025-03-09 10:35:32,758 [INFO]: 	>>> Finished "Creating the index" in 50.0579 secs
2025-03-09 10:35:32,758 [INFO]: >>> Finished "Launching the whole pipeline" in 50.0861 secs
2025-03-09 10:35:33: [retrieval_preprocessing] calculating distances ...
2025-03-09 10:35:34: [retrieval_preprocessing] finished and saved retrieval indices for episode 94808 [episode count 18/20]
[retrieval_preprocessing] for episode 27230 [episode count 19/20], we have num_retrieval=np.int64(3526) num_query=np.int64(105)
2025-03-09 10:35:34,584 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-09 10:35:34,972 [INFO]: Launching the whole pipeline 03/09/2025, 10:35:34
2025-03-09 10:35:34,972 [INFO]: Reading total number of vectors and dimension 03/09/2025, 10:35:34
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 2307.10it/s]
2025-03-09 10:35:34,998 [INFO]: There are 3526 embeddings of dim 49152
2025-03-09 10:35:34,998 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0253 secs
2025-03-09 10:35:34,998 [INFO]: 	Compute estimated construction time of the index 03/09/2025, 10:35:34
2025-03-09 10:35:34,998 [INFO]: 		-> Train: 16.7 minutes
2025-03-09 10:35:34,998 [INFO]: 		-> Add: 1.9 seconds
2025-03-09 10:35:34,998 [INFO]: 		Total: 16.7 minutes
2025-03-09 10:35:34,998 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0001 secs
2025-03-09 10:35:34,998 [INFO]: 	Checking that your have enough memory available to create the index 03/09/2025, 10:35:34
2025-03-09 10:35:34,998 [INFO]: 727.7MB of memory will be needed to build the index (more might be used if you have more)
2025-03-09 10:35:34,998 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0001 secs
2025-03-09 10:35:34,998 [INFO]: 	Selecting most promising index types given data characteristics 03/09/2025, 10:35:34
2025-03-09 10:35:34,998 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-09 10:35:34,998 [INFO]: 	Creating the index 03/09/2025, 10:35:34
2025-03-09 10:35:34,998 [INFO]: 		-> Instanciate the index HNSW15 03/09/2025, 10:35:34
2025-03-09 10:35:34,999 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0009 secs
2025-03-09 10:35:35,000 [INFO]: 		-> Adding the vectors to the index 03/09/2025, 10:35:34
2025-03-09 10:35:35,000 [INFO]: The memory available for adding the vectors is 49.4GB(total available - used by the index)
2025-03-09 10:35:35,000 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/14 [00:00<?, ?it/s] 14%|█▍        | 2/14 [00:00<00:00, 17.30it/s] 64%|██████▍   | 9/14 [00:00<00:00, 43.66it/s]100%|██████████| 14/14 [00:02<00:00,  4.14it/s]100%|██████████| 14/14 [00:02<00:00,  5.14it/s]
2025-03-09 10:35:37,730 [INFO]: 	Computing best hyperparameters for index knn.index 03/09/2025, 10:35:37
2025-03-09 10:36:12,948 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 35.2169 secs
2025-03-09 10:36:12,948 [INFO]: The best hyperparameters are: efSearch=270
2025-03-09 10:36:12,948 [INFO]: 	Compute fast metrics 03/09/2025, 10:36:12
  0%|          | 0/4 [00:00<?, ?it/s] 75%|███████▌  | 3/4 [00:00<00:00, 28.16it/s] 75%|███████▌  | 3/4 [00:00<00:00, 25.06it/s]
2025-03-09 10:36:25,334 [INFO]: 	>>> Finished "Compute fast metrics" in 12.3865 secs
2025-03-09 10:36:25,336 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 50.3364 secs
2025-03-09 10:36:25,336 [INFO]: {
2025-03-09 10:36:25,336 [INFO]: 	index_key: HNSW15
2025-03-09 10:36:25,336 [INFO]: 	index_param: efSearch=270
2025-03-09 10:36:25,336 [INFO]: 	index_path: knn.index
2025-03-09 10:36:25,336 [INFO]: 	size in bytes: 693718750
2025-03-09 10:36:25,336 [INFO]: 	avg_search_speed_ms: 10.989072388498583
2025-03-09 10:36:25,336 [INFO]: 	99p_search_speed_ms: 13.81491145119071
2025-03-09 10:36:25,336 [INFO]: 	reconstruction error %: 0.0
2025-03-09 10:36:25,336 [INFO]: 	nb vectors: 3526
2025-03-09 10:36:25,336 [INFO]: 	vectors dimension: 49152
2025-03-09 10:36:25,336 [INFO]: 	compression ratio: 0.9993096020541465
2025-03-09 10:36:25,336 [INFO]: }
2025-03-09 10:36:25,336 [INFO]: 	>>> Finished "Creating the index" in 50.3382 secs
2025-03-09 10:36:25,336 [INFO]: >>> Finished "Launching the whole pipeline" in 50.3640 secs
2025-03-09 10:36:26: [retrieval_preprocessing] calculating distances ...
2025-03-09 10:36:26: [retrieval_preprocessing] finished and saved retrieval indices for episode 27230 [episode count 19/20]
2025-03-09 10:36:26: [retrieval_preprocessing] finished for (4846810092, 'cloth') [chosen_id count 9/10]
2025-03-09 10:36:26: [retrieval_preprocessing] done for embedding_type='embeddings__wrist_image_left'!
