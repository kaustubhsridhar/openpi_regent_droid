nohup: ignoring input
2025-03-09 06:48:02: got the info dicts: there are 36687 groupings

2025-03-09 06:48:02: number of groupings with atleast 50 episodes [in the first 95658 episodes]: 105

these groupings have chosen_id-->num_episodes as

 {(1297764552, 'bottle'): 53, (2515873443, 'cloth'): 50, (5235850418, 'drawer'): 612, (5879622450, 'block'): 108, (1431810548, 'lid'): 51, (3485794757, 'marker'): 97, (8756300955, 'block'): 117, (1180576306, 'cloth'): 60, (9154343709, 'drawer'): 96, (6498288010, 'bottle'): 138, (8911427557, 'bottle'): 50, (1058976383, 'drawer'): 148, (4045730075, 'lid'): 61, (1712293193, 'marker'): 163, (65137982, 'block'): 100, (4329524892, 'cup'): 166, (484659531, 'marker'): 96, (-1, 'marker'): 1032, (6078642573, 'marker'): 54, (452818143, 'lid'): 221, (1461982682, 'cloth'): 76, (5235850418, 'block'): 97, (7495112204, 'marker'): 102, (666854965, 'marker'): 68, (395700094, 'block'): 72, (3827924651, 'lid'): 67, (6612454114, 'block'): 65, (2782099537, 'marker'): 75, (8376714657, 'marker'): 464, (3452853472, 'drawer'): 91, (9306310171, 'marker'): 97, (3816161570, 'drawer'): 78, (5511329841, 'marker'): 59, (3951366978, 'cup'): 112, (1959308322, 'marker'): 65, (3163748394, 'cup'): 127, (7644292911, 'marker'): 50, (1775582436, 'marker'): 98, (4706041793, 'cloth'): 142, (2370783071, 'block'): 50, (9551783935, 'drawer'): 65, (2782099537, 'cup'): 153, (7489911085, 'cloth'): 179, (5576515039, 'marker'): 50, (4465064685, 'marker'): 198, (9186164821, 'bottle'): 57, (5207831207, 'cup'): 139, (3774560981, 'cloth'): 99, (4823049285, 'bottle'): 234, (9130122211, 'marker'): 159, (6313680013, 'cup'): 50, (9088223759, 'bottle'): 99, (8098563998, 'lid'): 73, (9505766118, 'drawer'): 108, (441689524, 'mug'): 77, (8150285641, 'marker'): 63, (8456936732, 'bottle'): 54, (446878712, 'marker'): 83, (6093644330, 'cloth'): 52, (4345518188, 'lid'): 89, (5024387521, 'marker'): 60, (6498288010, 'lid'): 96, (4823049285, 'block'): 174, (6667529842, 'lid'): 90, (5507987860, 'marker'): 100, (8898968162, 'block'): 58, (-1, 'mug'): 228, (9965421062, 'bottle'): 63, (6357288647, 'lid'): 71, (5701580274, 'marker'): 67, (1469427884, 'marker'): 63, (9933578360, 'drawer'): 53, (1498834123, 'cup'): 77, (440287856, 'drawer'): 75, (376702246, 'cup'): 53, (9883209091, 'mug'): 201, (9934859632, 'marker'): 62, (4312815282, 'marker'): 66, (-1, 'cup'): 113, (8922050678, 'lid'): 64, (2883696971, 'cup'): 69, (9209350647, 'drawer'): 76, (6655265581, 'cup'): 51, (4345518188, 'cloth'): 91, (4545879864, 'marker'): 51, (818725642, 'block'): 63, (3854327802, 'bottle'): 97, (3951366978, 'lid'): 72, (5059283044, 'drawer'): 113, (4846810092, 'cloth'): 93, (8690198922, 'marker'): 65, (1477699675, 'marker'): 89, (4400212150, 'marker'): 52, (1526685371, 'marker'): 62, (6074146895, 'lid'): 59, (8911427557, 'cup'): 112, (8702636502, 'lid'): 90, (8172596608, 'cup'): 51, (1575177183, 'marker'): 59, (5414640868, 'lid'): 56, (1477699675, 'mug'): 57, (9228483020, 'marker'): 80, (2927338332, 'cloth'): 51, (52817038, 'block'): 54, (8815207926, 'block'): 54}
2025-03-09 06:48:02: [retrieval_preprocessing] starting retrieval preprocessing for embeddings__wrist_image_left
2025-03-09 06:48:03: [retrieval_preprocessing] concatenated all embeddings and indices for 20 episodes for (8690198922, 'marker') [chosen_id count 0/10]
2025-03-09 06:48:03: [retrieval_preprocessing] we have num_total=5516 embedding_dim=49152
[retrieval_preprocessing] for episode 22917 [episode count 0/20], we have num_retrieval=np.int64(5298) num_query=np.int64(218)
2025-03-09 06:48:04,286 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-09 06:48:05,049 [INFO]: Launching the whole pipeline 03/09/2025, 06:48:05
2025-03-09 06:48:05,049 [INFO]: Reading total number of vectors and dimension 03/09/2025, 06:48:05
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 729.44it/s]
2025-03-09 06:48:05,114 [INFO]: There are 5298 embeddings of dim 49152
2025-03-09 06:48:05,115 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0655 secs
2025-03-09 06:48:05,115 [INFO]: 	Compute estimated construction time of the index 03/09/2025, 06:48:05
2025-03-09 06:48:05,115 [INFO]: 		-> Train: 16.7 minutes
2025-03-09 06:48:05,115 [INFO]: 		-> Add: 2.9 seconds
2025-03-09 06:48:05,115 [INFO]: 		Total: 16.7 minutes
2025-03-09 06:48:05,115 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0003 secs
2025-03-09 06:48:05,116 [INFO]: 	Checking that your have enough memory available to create the index 03/09/2025, 06:48:05
2025-03-09 06:48:05,117 [INFO]: 1.1GB of memory will be needed to build the index (more might be used if you have more)
2025-03-09 06:48:05,117 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0010 secs
2025-03-09 06:48:05,117 [INFO]: 	Selecting most promising index types given data characteristics 03/09/2025, 06:48:05
2025-03-09 06:48:05,117 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-09 06:48:05,117 [INFO]: 	Creating the index 03/09/2025, 06:48:05
2025-03-09 06:48:05,117 [INFO]: 		-> Instanciate the index HNSW15 03/09/2025, 06:48:05
2025-03-09 06:48:05,119 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0019 secs
2025-03-09 06:48:05,119 [INFO]: 		-> Adding the vectors to the index 03/09/2025, 06:48:05
2025-03-09 06:48:05,119 [INFO]: The memory available for adding the vectors is 49.0GB(total available - used by the index)
2025-03-09 06:48:05,119 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/22 [00:00<?, ?it/s]  5%|▍         | 1/22 [00:00<00:02,  9.01it/s] 27%|██▋       | 6/22 [00:00<00:00, 30.78it/s] 50%|█████     | 11/22 [00:00<00:00, 38.14it/s] 73%|███████▎  | 16/22 [00:00<00:00, 40.17it/s] 95%|█████████▌| 21/22 [00:04<00:00,  3.32it/s]100%|██████████| 22/22 [00:04<00:00,  4.58it/s]
2025-03-09 06:48:09,924 [INFO]: 	Computing best hyperparameters for index knn.index 03/09/2025, 06:48:09
2025-03-09 06:48:53,797 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 43.8733 secs
2025-03-09 06:48:53,798 [INFO]: The best hyperparameters are: efSearch=224
2025-03-09 06:48:53,798 [INFO]: 	Compute fast metrics 03/09/2025, 06:48:53
  0%|          | 0/4 [00:00<?, ?it/s] 75%|███████▌  | 3/4 [00:00<00:00, 28.40it/s] 75%|███████▌  | 3/4 [00:00<00:00, 23.99it/s]
2025-03-09 06:49:06,563 [INFO]: 	>>> Finished "Compute fast metrics" in 12.7650 secs
2025-03-09 06:49:06,564 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 61.4442 secs
2025-03-09 06:49:06,564 [INFO]: {
2025-03-09 06:49:06,564 [INFO]: 	index_key: HNSW15
2025-03-09 06:49:06,564 [INFO]: 	index_param: efSearch=224
2025-03-09 06:49:06,564 [INFO]: 	index_path: knn.index
2025-03-09 06:49:06,564 [INFO]: 	size in bytes: 1042350250
2025-03-09 06:49:06,564 [INFO]: 	avg_search_speed_ms: 10.13830234626876
2025-03-09 06:49:06,564 [INFO]: 	99p_search_speed_ms: 21.499513098970056
2025-03-09 06:49:06,564 [INFO]: 	reconstruction error %: 0.0
2025-03-09 06:49:06,564 [INFO]: 	nb vectors: 5298
2025-03-09 06:49:06,564 [INFO]: 	vectors dimension: 49152
2025-03-09 06:49:06,564 [INFO]: 	compression ratio: 0.9993082306067467
2025-03-09 06:49:06,564 [INFO]: }
2025-03-09 06:49:06,564 [INFO]: 	>>> Finished "Creating the index" in 61.4469 secs
2025-03-09 06:49:06,564 [INFO]: >>> Finished "Launching the whole pipeline" in 61.5147 secs
2025-03-09 06:49:07: [retrieval_preprocessing] calculating distances ...
2025-03-09 06:49:08: [retrieval_preprocessing] finished and saved retrieval indices for episode 22917 [episode count 0/20]
[retrieval_preprocessing] for episode 14087 [episode count 1/20], we have num_retrieval=np.int64(5285) num_query=np.int64(231)
2025-03-09 06:49:08,682 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-09 06:49:09,605 [INFO]: Launching the whole pipeline 03/09/2025, 06:49:09
2025-03-09 06:49:09,605 [INFO]: Reading total number of vectors and dimension 03/09/2025, 06:49:09
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1633.93it/s]
2025-03-09 06:49:09,630 [INFO]: There are 5285 embeddings of dim 49152
2025-03-09 06:49:09,631 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0258 secs
2025-03-09 06:49:09,631 [INFO]: 	Compute estimated construction time of the index 03/09/2025, 06:49:09
2025-03-09 06:49:09,631 [INFO]: 		-> Train: 16.7 minutes
2025-03-09 06:49:09,631 [INFO]: 		-> Add: 2.9 seconds
2025-03-09 06:49:09,631 [INFO]: 		Total: 16.7 minutes
2025-03-09 06:49:09,631 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0001 secs
2025-03-09 06:49:09,631 [INFO]: 	Checking that your have enough memory available to create the index 03/09/2025, 06:49:09
2025-03-09 06:49:09,631 [INFO]: 1.1GB of memory will be needed to build the index (more might be used if you have more)
2025-03-09 06:49:09,631 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0002 secs
2025-03-09 06:49:09,631 [INFO]: 	Selecting most promising index types given data characteristics 03/09/2025, 06:49:09
2025-03-09 06:49:09,631 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-09 06:49:09,631 [INFO]: 	Creating the index 03/09/2025, 06:49:09
2025-03-09 06:49:09,631 [INFO]: 		-> Instanciate the index HNSW15 03/09/2025, 06:49:09
2025-03-09 06:49:09,632 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0010 secs
2025-03-09 06:49:09,632 [INFO]: 		-> Adding the vectors to the index 03/09/2025, 06:49:09
2025-03-09 06:49:09,632 [INFO]: The memory available for adding the vectors is 49.0GB(total available - used by the index)
2025-03-09 06:49:09,633 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/22 [00:00<?, ?it/s]  5%|▍         | 1/22 [00:00<00:02,  9.08it/s] 27%|██▋       | 6/22 [00:00<00:00, 31.30it/s] 50%|█████     | 11/22 [00:00<00:00, 39.00it/s] 73%|███████▎  | 16/22 [00:00<00:00, 42.75it/s] 95%|█████████▌| 21/22 [00:04<00:00,  2.93it/s]100%|██████████| 22/22 [00:05<00:00,  4.11it/s]
2025-03-09 06:49:14,985 [INFO]: 	Computing best hyperparameters for index knn.index 03/09/2025, 06:49:14
2025-03-09 06:50:00,447 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 45.4620 secs
2025-03-09 06:50:00,448 [INFO]: The best hyperparameters are: efSearch=160
2025-03-09 06:50:00,448 [INFO]: 	Compute fast metrics 03/09/2025, 06:50:00
  0%|          | 0/4 [00:00<?, ?it/s] 50%|█████     | 2/4 [00:00<00:00, 17.20it/s] 75%|███████▌  | 3/4 [00:00<00:00, 18.48it/s]
2025-03-09 06:50:13,495 [INFO]: 	>>> Finished "Compute fast metrics" in 13.0469 secs
2025-03-09 06:50:13,495 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 63.8629 secs
2025-03-09 06:50:13,495 [INFO]: {
2025-03-09 06:50:13,495 [INFO]: 	index_key: HNSW15
2025-03-09 06:50:13,495 [INFO]: 	index_param: efSearch=160
2025-03-09 06:50:13,495 [INFO]: 	index_path: knn.index
2025-03-09 06:50:13,495 [INFO]: 	size in bytes: 1039792510
2025-03-09 06:50:13,495 [INFO]: 	avg_search_speed_ms: 7.833849353724529
2025-03-09 06:50:13,495 [INFO]: 	99p_search_speed_ms: 21.231295503675938
2025-03-09 06:50:13,495 [INFO]: 	reconstruction error %: 0.0
2025-03-09 06:50:13,495 [INFO]: 	nb vectors: 5285
2025-03-09 06:50:13,496 [INFO]: 	vectors dimension: 49152
2025-03-09 06:50:13,496 [INFO]: 	compression ratio: 0.9993082946904475
2025-03-09 06:50:13,496 [INFO]: }
2025-03-09 06:50:13,496 [INFO]: 	>>> Finished "Creating the index" in 63.8643 secs
2025-03-09 06:50:13,496 [INFO]: >>> Finished "Launching the whole pipeline" in 63.8908 secs
2025-03-09 06:50:14: [retrieval_preprocessing] calculating distances ...
2025-03-09 06:50:14: [retrieval_preprocessing] finished and saved retrieval indices for episode 14087 [episode count 1/20]
[retrieval_preprocessing] for episode 11016 [episode count 2/20], we have num_retrieval=np.int64(5018) num_query=np.int64(498)
2025-03-09 06:50:15,505 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-09 06:50:16,154 [INFO]: Launching the whole pipeline 03/09/2025, 06:50:16
2025-03-09 06:50:16,154 [INFO]: Reading total number of vectors and dimension 03/09/2025, 06:50:16
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1418.91it/s]
2025-03-09 06:50:16,180 [INFO]: There are 5018 embeddings of dim 49152
2025-03-09 06:50:16,180 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0266 secs
2025-03-09 06:50:16,180 [INFO]: 	Compute estimated construction time of the index 03/09/2025, 06:50:16
2025-03-09 06:50:16,181 [INFO]: 		-> Train: 16.7 minutes
2025-03-09 06:50:16,181 [INFO]: 		-> Add: 2.8 seconds
2025-03-09 06:50:16,181 [INFO]: 		Total: 16.7 minutes
2025-03-09 06:50:16,181 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0001 secs
2025-03-09 06:50:16,181 [INFO]: 	Checking that your have enough memory available to create the index 03/09/2025, 06:50:16
2025-03-09 06:50:16,181 [INFO]: 1.0GB of memory will be needed to build the index (more might be used if you have more)
2025-03-09 06:50:16,181 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0001 secs
2025-03-09 06:50:16,181 [INFO]: 	Selecting most promising index types given data characteristics 03/09/2025, 06:50:16
2025-03-09 06:50:16,181 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-09 06:50:16,181 [INFO]: 	Creating the index 03/09/2025, 06:50:16
2025-03-09 06:50:16,181 [INFO]: 		-> Instanciate the index HNSW15 03/09/2025, 06:50:16
2025-03-09 06:50:16,182 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0010 secs
2025-03-09 06:50:16,182 [INFO]: 		-> Adding the vectors to the index 03/09/2025, 06:50:16
2025-03-09 06:50:16,182 [INFO]: The memory available for adding the vectors is 49.1GB(total available - used by the index)
2025-03-09 06:50:16,182 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/20 [00:00<?, ?it/s]  5%|▌         | 1/20 [00:00<00:02,  7.16it/s] 30%|███       | 6/20 [00:00<00:00, 27.93it/s] 55%|█████▌    | 11/20 [00:00<00:00, 36.32it/s] 80%|████████  | 16/20 [00:00<00:00, 40.84it/s]100%|██████████| 20/20 [00:04<00:00,  4.50it/s]
2025-03-09 06:50:20,628 [INFO]: 	Computing best hyperparameters for index knn.index 03/09/2025, 06:50:20
2025-03-09 06:51:07,843 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 47.2146 secs
2025-03-09 06:51:07,844 [INFO]: The best hyperparameters are: efSearch=159
2025-03-09 06:51:07,844 [INFO]: 	Compute fast metrics 03/09/2025, 06:51:07
  0%|          | 0/4 [00:00<?, ?it/s] 25%|██▌       | 1/4 [00:00<00:00,  8.44it/s] 75%|███████▌  | 3/4 [00:00<00:00, 15.96it/s]
2025-03-09 06:51:20,990 [INFO]: 	>>> Finished "Compute fast metrics" in 13.1462 secs
2025-03-09 06:51:20,993 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 64.8108 secs
2025-03-09 06:51:20,993 [INFO]: {
2025-03-09 06:51:20,993 [INFO]: 	index_key: HNSW15
2025-03-09 06:51:20,993 [INFO]: 	index_param: efSearch=159
2025-03-09 06:51:20,993 [INFO]: 	index_path: knn.index
2025-03-09 06:51:20,993 [INFO]: 	size in bytes: 987261550
2025-03-09 06:51:20,993 [INFO]: 	avg_search_speed_ms: 9.049350853874538
2025-03-09 06:51:20,993 [INFO]: 	99p_search_speed_ms: 19.690430564805865
2025-03-09 06:51:20,993 [INFO]: 	reconstruction error %: 0.0
2025-03-09 06:51:20,993 [INFO]: 	nb vectors: 5018
2025-03-09 06:51:20,993 [INFO]: 	vectors dimension: 49152
2025-03-09 06:51:20,993 [INFO]: 	compression ratio: 0.9993085864632326
2025-03-09 06:51:20,993 [INFO]: }
2025-03-09 06:51:20,993 [INFO]: 	>>> Finished "Creating the index" in 64.8123 secs
2025-03-09 06:51:20,993 [INFO]: >>> Finished "Launching the whole pipeline" in 64.8395 secs
2025-03-09 06:51:22: [retrieval_preprocessing] calculating distances ...
2025-03-09 06:51:23: [retrieval_preprocessing] finished and saved retrieval indices for episode 11016 [episode count 2/20]
[retrieval_preprocessing] for episode 5001 [episode count 3/20], we have num_retrieval=np.int64(5302) num_query=np.int64(214)
2025-03-09 06:51:24,649 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-09 06:51:25,347 [INFO]: Launching the whole pipeline 03/09/2025, 06:51:25
2025-03-09 06:51:25,347 [INFO]: Reading total number of vectors and dimension 03/09/2025, 06:51:25
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1096.84it/s]
2025-03-09 06:51:25,378 [INFO]: There are 5302 embeddings of dim 49152
2025-03-09 06:51:25,378 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0310 secs
2025-03-09 06:51:25,379 [INFO]: 	Compute estimated construction time of the index 03/09/2025, 06:51:25
2025-03-09 06:51:25,379 [INFO]: 		-> Train: 16.7 minutes
2025-03-09 06:51:25,379 [INFO]: 		-> Add: 2.9 seconds
2025-03-09 06:51:25,379 [INFO]: 		Total: 16.7 minutes
2025-03-09 06:51:25,379 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0004 secs
2025-03-09 06:51:25,379 [INFO]: 	Checking that your have enough memory available to create the index 03/09/2025, 06:51:25
2025-03-09 06:51:25,379 [INFO]: 1.1GB of memory will be needed to build the index (more might be used if you have more)
2025-03-09 06:51:25,380 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0005 secs
2025-03-09 06:51:25,380 [INFO]: 	Selecting most promising index types given data characteristics 03/09/2025, 06:51:25
2025-03-09 06:51:25,380 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-09 06:51:25,380 [INFO]: 	Creating the index 03/09/2025, 06:51:25
2025-03-09 06:51:25,380 [INFO]: 		-> Instanciate the index HNSW15 03/09/2025, 06:51:25
2025-03-09 06:51:25,383 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0032 secs
2025-03-09 06:51:25,384 [INFO]: 		-> Adding the vectors to the index 03/09/2025, 06:51:25
2025-03-09 06:51:25,384 [INFO]: The memory available for adding the vectors is 49.0GB(total available - used by the index)
2025-03-09 06:51:25,384 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/22 [00:00<?, ?it/s]  9%|▉         | 2/22 [00:00<00:01, 19.68it/s] 36%|███▋      | 8/22 [00:00<00:00, 39.47it/s] 64%|██████▎   | 14/22 [00:00<00:00, 45.34it/s] 91%|█████████ | 20/22 [00:00<00:00, 48.28it/s]100%|██████████| 22/22 [00:05<00:00,  4.39it/s]
2025-03-09 06:51:30,405 [INFO]: 	Computing best hyperparameters for index knn.index 03/09/2025, 06:51:30
2025-03-09 06:52:15,728 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 45.3228 secs
2025-03-09 06:52:15,728 [INFO]: The best hyperparameters are: efSearch=171
2025-03-09 06:52:15,729 [INFO]: 	Compute fast metrics 03/09/2025, 06:52:15
  0%|          | 0/4 [00:00<?, ?it/s] 50%|█████     | 2/4 [00:00<00:00, 18.19it/s] 75%|███████▌  | 3/4 [00:00<00:00, 19.33it/s]
2025-03-09 06:52:30,492 [INFO]: 	>>> Finished "Compute fast metrics" in 14.7630 secs
2025-03-09 06:52:30,493 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 65.1094 secs
2025-03-09 06:52:30,493 [INFO]: {
2025-03-09 06:52:30,494 [INFO]: 	index_key: HNSW15
2025-03-09 06:52:30,494 [INFO]: 	index_param: efSearch=171
2025-03-09 06:52:30,494 [INFO]: 	index_path: knn.index
2025-03-09 06:52:30,494 [INFO]: 	size in bytes: 1043137210
2025-03-09 06:52:30,494 [INFO]: 	avg_search_speed_ms: 8.000157649628818
2025-03-09 06:52:30,494 [INFO]: 	99p_search_speed_ms: 12.168017707299441
2025-03-09 06:52:30,494 [INFO]: 	reconstruction error %: 0.0
2025-03-09 06:52:30,494 [INFO]: 	nb vectors: 5302
2025-03-09 06:52:30,494 [INFO]: 	vectors dimension: 49152
2025-03-09 06:52:30,494 [INFO]: 	compression ratio: 0.9993082463236068
2025-03-09 06:52:30,494 [INFO]: }
2025-03-09 06:52:30,494 [INFO]: 	>>> Finished "Creating the index" in 65.1140 secs
2025-03-09 06:52:30,494 [INFO]: >>> Finished "Launching the whole pipeline" in 65.1469 secs
2025-03-09 06:52:31: [retrieval_preprocessing] calculating distances ...
2025-03-09 06:52:32: [retrieval_preprocessing] finished and saved retrieval indices for episode 5001 [episode count 3/20]
[retrieval_preprocessing] for episode 13961 [episode count 4/20], we have num_retrieval=np.int64(5260) num_query=np.int64(256)
2025-03-09 06:52:33,039 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-09 06:52:33,980 [INFO]: Launching the whole pipeline 03/09/2025, 06:52:33
2025-03-09 06:52:33,980 [INFO]: Reading total number of vectors and dimension 03/09/2025, 06:52:33
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1393.92it/s]
2025-03-09 06:52:34,006 [INFO]: There are 5260 embeddings of dim 49152
2025-03-09 06:52:34,006 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0258 secs
2025-03-09 06:52:34,006 [INFO]: 	Compute estimated construction time of the index 03/09/2025, 06:52:34
2025-03-09 06:52:34,006 [INFO]: 		-> Train: 16.7 minutes
2025-03-09 06:52:34,006 [INFO]: 		-> Add: 2.9 seconds
2025-03-09 06:52:34,006 [INFO]: 		Total: 16.7 minutes
2025-03-09 06:52:34,006 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0001 secs
2025-03-09 06:52:34,006 [INFO]: 	Checking that your have enough memory available to create the index 03/09/2025, 06:52:34
2025-03-09 06:52:34,006 [INFO]: 1.1GB of memory will be needed to build the index (more might be used if you have more)
2025-03-09 06:52:34,006 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0002 secs
2025-03-09 06:52:34,006 [INFO]: 	Selecting most promising index types given data characteristics 03/09/2025, 06:52:34
2025-03-09 06:52:34,007 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-09 06:52:34,007 [INFO]: 	Creating the index 03/09/2025, 06:52:34
2025-03-09 06:52:34,007 [INFO]: 		-> Instanciate the index HNSW15 03/09/2025, 06:52:34
2025-03-09 06:52:34,008 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0011 secs
2025-03-09 06:52:34,008 [INFO]: 		-> Adding the vectors to the index 03/09/2025, 06:52:34
2025-03-09 06:52:34,008 [INFO]: The memory available for adding the vectors is 49.0GB(total available - used by the index)
2025-03-09 06:52:34,008 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/22 [00:00<?, ?it/s]  5%|▍         | 1/22 [00:00<00:02,  7.73it/s] 27%|██▋       | 6/22 [00:00<00:00, 29.06it/s] 50%|█████     | 11/22 [00:00<00:00, 37.01it/s] 73%|███████▎  | 16/22 [00:00<00:00, 41.05it/s] 95%|█████████▌| 21/22 [00:04<00:00,  3.38it/s]100%|██████████| 22/22 [00:04<00:00,  4.69it/s]
2025-03-09 06:52:38,699 [INFO]: 	Computing best hyperparameters for index knn.index 03/09/2025, 06:52:38
2025-03-09 06:53:25,359 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 46.6593 secs
2025-03-09 06:53:25,359 [INFO]: The best hyperparameters are: efSearch=174
2025-03-09 06:53:25,359 [INFO]: 	Compute fast metrics 03/09/2025, 06:53:25
  0%|          | 0/4 [00:00<?, ?it/s] 75%|███████▌  | 3/4 [00:00<00:00, 26.83it/s] 75%|███████▌  | 3/4 [00:00<00:00, 22.81it/s]
2025-03-09 06:53:38,624 [INFO]: 	>>> Finished "Compute fast metrics" in 13.2647 secs
2025-03-09 06:53:38,625 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 64.6167 secs
2025-03-09 06:53:38,625 [INFO]: {
2025-03-09 06:53:38,625 [INFO]: 	index_key: HNSW15
2025-03-09 06:53:38,625 [INFO]: 	index_param: efSearch=174
2025-03-09 06:53:38,625 [INFO]: 	index_path: knn.index
2025-03-09 06:53:38,625 [INFO]: 	size in bytes: 1034874010
2025-03-09 06:53:38,625 [INFO]: 	avg_search_speed_ms: 8.666228084741046
2025-03-09 06:53:38,625 [INFO]: 	99p_search_speed_ms: 17.09579897578806
2025-03-09 06:53:38,625 [INFO]: 	reconstruction error %: 0.0
2025-03-09 06:53:38,625 [INFO]: 	nb vectors: 5260
2025-03-09 06:53:38,625 [INFO]: 	vectors dimension: 49152
2025-03-09 06:53:38,625 [INFO]: 	compression ratio: 0.9993081959803011
2025-03-09 06:53:38,625 [INFO]: }
2025-03-09 06:53:38,625 [INFO]: 	>>> Finished "Creating the index" in 64.6184 secs
2025-03-09 06:53:38,625 [INFO]: >>> Finished "Launching the whole pipeline" in 64.6448 secs
2025-03-09 06:53:39: [retrieval_preprocessing] calculating distances ...
2025-03-09 06:53:40: [retrieval_preprocessing] finished and saved retrieval indices for episode 13961 [episode count 4/20]
[retrieval_preprocessing] for episode 59658 [episode count 5/20], we have num_retrieval=np.int64(5353) num_query=np.int64(163)
2025-03-09 06:53:41,053 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-09 06:53:41,767 [INFO]: Launching the whole pipeline 03/09/2025, 06:53:41
2025-03-09 06:53:41,767 [INFO]: Reading total number of vectors and dimension 03/09/2025, 06:53:41
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1395.31it/s]
2025-03-09 06:53:41,788 [INFO]: There are 5353 embeddings of dim 49152
2025-03-09 06:53:41,789 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0219 secs
2025-03-09 06:53:41,789 [INFO]: 	Compute estimated construction time of the index 03/09/2025, 06:53:41
2025-03-09 06:53:41,789 [INFO]: 		-> Train: 16.7 minutes
2025-03-09 06:53:41,789 [INFO]: 		-> Add: 2.9 seconds
2025-03-09 06:53:41,789 [INFO]: 		Total: 16.7 minutes
2025-03-09 06:53:41,789 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0001 secs
2025-03-09 06:53:41,789 [INFO]: 	Checking that your have enough memory available to create the index 03/09/2025, 06:53:41
2025-03-09 06:53:41,789 [INFO]: 1.1GB of memory will be needed to build the index (more might be used if you have more)
2025-03-09 06:53:41,789 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0002 secs
2025-03-09 06:53:41,789 [INFO]: 	Selecting most promising index types given data characteristics 03/09/2025, 06:53:41
2025-03-09 06:53:41,789 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-09 06:53:41,789 [INFO]: 	Creating the index 03/09/2025, 06:53:41
2025-03-09 06:53:41,789 [INFO]: 		-> Instanciate the index HNSW15 03/09/2025, 06:53:41
2025-03-09 06:53:41,790 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0011 secs
2025-03-09 06:53:41,790 [INFO]: 		-> Adding the vectors to the index 03/09/2025, 06:53:41
2025-03-09 06:53:41,790 [INFO]: The memory available for adding the vectors is 49.0GB(total available - used by the index)
2025-03-09 06:53:41,790 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/23 [00:00<?, ?it/s]  9%|▊         | 2/23 [00:00<00:01, 17.14it/s] 30%|███       | 7/23 [00:00<00:00, 35.04it/s] 52%|█████▏    | 12/23 [00:00<00:00, 41.36it/s] 74%|███████▍  | 17/23 [00:00<00:00, 44.45it/s] 96%|█████████▌| 22/23 [00:03<00:00,  3.60it/s]100%|██████████| 23/23 [00:04<00:00,  5.03it/s]
2025-03-09 06:53:46,364 [INFO]: 	Computing best hyperparameters for index knn.index 03/09/2025, 06:53:46
2025-03-09 06:54:31,760 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 45.3957 secs
2025-03-09 06:54:31,760 [INFO]: The best hyperparameters are: efSearch=136
2025-03-09 06:54:31,760 [INFO]: 	Compute fast metrics 03/09/2025, 06:54:31
  0%|          | 0/4 [00:00<?, ?it/s] 50%|█████     | 2/4 [00:00<00:00, 17.19it/s] 75%|███████▌  | 3/4 [00:00<00:00, 18.44it/s]
2025-03-09 06:54:44,468 [INFO]: 	>>> Finished "Compute fast metrics" in 12.7079 secs
2025-03-09 06:54:44,469 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 62.6784 secs
2025-03-09 06:54:44,469 [INFO]: {
2025-03-09 06:54:44,469 [INFO]: 	index_key: HNSW15
2025-03-09 06:54:44,469 [INFO]: 	index_param: efSearch=136
2025-03-09 06:54:44,469 [INFO]: 	index_path: knn.index
2025-03-09 06:54:44,469 [INFO]: 	size in bytes: 1053171310
2025-03-09 06:54:44,469 [INFO]: 	avg_search_speed_ms: 7.042833582111175
2025-03-09 06:54:44,469 [INFO]: 	99p_search_speed_ms: 13.128409902565181
2025-03-09 06:54:44,469 [INFO]: 	reconstruction error %: 0.0
2025-03-09 06:54:44,469 [INFO]: 	nb vectors: 5353
2025-03-09 06:54:44,469 [INFO]: 	vectors dimension: 49152
2025-03-09 06:54:44,469 [INFO]: 	compression ratio: 0.9993081030663473
2025-03-09 06:54:44,469 [INFO]: }
2025-03-09 06:54:44,469 [INFO]: 	>>> Finished "Creating the index" in 62.6799 secs
2025-03-09 06:54:44,469 [INFO]: >>> Finished "Launching the whole pipeline" in 62.7024 secs
2025-03-09 06:54:44: [retrieval_preprocessing] calculating distances ...
2025-03-09 06:54:45: [retrieval_preprocessing] finished and saved retrieval indices for episode 59658 [episode count 5/20]
[retrieval_preprocessing] for episode 9868 [episode count 6/20], we have num_retrieval=np.int64(5288) num_query=np.int64(228)
2025-03-09 06:54:45,974 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-09 06:54:46,661 [INFO]: Launching the whole pipeline 03/09/2025, 06:54:46
2025-03-09 06:54:46,661 [INFO]: Reading total number of vectors and dimension 03/09/2025, 06:54:46
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1429.06it/s]
2025-03-09 06:54:46,687 [INFO]: There are 5288 embeddings of dim 49152
2025-03-09 06:54:46,688 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0265 secs
2025-03-09 06:54:46,688 [INFO]: 	Compute estimated construction time of the index 03/09/2025, 06:54:46
2025-03-09 06:54:46,688 [INFO]: 		-> Train: 16.7 minutes
2025-03-09 06:54:46,688 [INFO]: 		-> Add: 2.9 seconds
2025-03-09 06:54:46,688 [INFO]: 		Total: 16.7 minutes
2025-03-09 06:54:46,688 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0001 secs
2025-03-09 06:54:46,688 [INFO]: 	Checking that your have enough memory available to create the index 03/09/2025, 06:54:46
2025-03-09 06:54:46,688 [INFO]: 1.1GB of memory will be needed to build the index (more might be used if you have more)
2025-03-09 06:54:46,688 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0001 secs
2025-03-09 06:54:46,688 [INFO]: 	Selecting most promising index types given data characteristics 03/09/2025, 06:54:46
2025-03-09 06:54:46,688 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-09 06:54:46,688 [INFO]: 	Creating the index 03/09/2025, 06:54:46
2025-03-09 06:54:46,688 [INFO]: 		-> Instanciate the index HNSW15 03/09/2025, 06:54:46
2025-03-09 06:54:46,689 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0010 secs
2025-03-09 06:54:46,689 [INFO]: 		-> Adding the vectors to the index 03/09/2025, 06:54:46
2025-03-09 06:54:46,689 [INFO]: The memory available for adding the vectors is 49.0GB(total available - used by the index)
2025-03-09 06:54:46,689 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/22 [00:00<?, ?it/s]  5%|▍         | 1/22 [00:00<00:02,  8.66it/s] 27%|██▋       | 6/22 [00:00<00:00, 27.81it/s] 55%|█████▍    | 12/22 [00:00<00:00, 38.41it/s] 82%|████████▏ | 18/22 [00:00<00:00, 43.02it/s]100%|██████████| 22/22 [00:05<00:00,  4.38it/s]
2025-03-09 06:54:51,711 [INFO]: 	Computing best hyperparameters for index knn.index 03/09/2025, 06:54:51
2025-03-09 06:55:36,585 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 44.8740 secs
2025-03-09 06:55:36,585 [INFO]: The best hyperparameters are: efSearch=187
2025-03-09 06:55:36,585 [INFO]: 	Compute fast metrics 03/09/2025, 06:55:36
  0%|          | 0/4 [00:00<?, ?it/s] 25%|██▌       | 1/4 [00:00<00:00,  7.01it/s] 75%|███████▌  | 3/4 [00:00<00:00, 11.85it/s]
2025-03-09 06:55:49,986 [INFO]: 	>>> Finished "Compute fast metrics" in 13.4013 secs
2025-03-09 06:55:49,987 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 63.2979 secs
2025-03-09 06:55:49,987 [INFO]: {
2025-03-09 06:55:49,987 [INFO]: 	index_key: HNSW15
2025-03-09 06:55:49,987 [INFO]: 	index_param: efSearch=187
2025-03-09 06:55:49,987 [INFO]: 	index_path: knn.index
2025-03-09 06:55:49,987 [INFO]: 	size in bytes: 1040382730
2025-03-09 06:55:49,987 [INFO]: 	avg_search_speed_ms: 9.245294154847175
2025-03-09 06:55:49,987 [INFO]: 	99p_search_speed_ms: 21.753645606804646
2025-03-09 06:55:49,987 [INFO]: 	reconstruction error %: 0.0
2025-03-09 06:55:49,987 [INFO]: 	nb vectors: 5288
2025-03-09 06:55:49,987 [INFO]: 	vectors dimension: 49152
2025-03-09 06:55:49,987 [INFO]: 	compression ratio: 0.9993083064729458
2025-03-09 06:55:49,987 [INFO]: }
2025-03-09 06:55:49,987 [INFO]: 	>>> Finished "Creating the index" in 63.2994 secs
2025-03-09 06:55:49,987 [INFO]: >>> Finished "Launching the whole pipeline" in 63.3264 secs
2025-03-09 06:55:51: [retrieval_preprocessing] calculating distances ...
2025-03-09 06:55:51: [retrieval_preprocessing] finished and saved retrieval indices for episode 9868 [episode count 6/20]
[retrieval_preprocessing] for episode 68107 [episode count 7/20], we have num_retrieval=np.int64(5261) num_query=np.int64(255)
2025-03-09 06:55:52,466 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-09 06:55:53,496 [INFO]: Launching the whole pipeline 03/09/2025, 06:55:53
2025-03-09 06:55:53,496 [INFO]: Reading total number of vectors and dimension 03/09/2025, 06:55:53
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1457.87it/s]
2025-03-09 06:55:53,537 [INFO]: There are 5261 embeddings of dim 49152
2025-03-09 06:55:53,537 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0409 secs
2025-03-09 06:55:53,537 [INFO]: 	Compute estimated construction time of the index 03/09/2025, 06:55:53
2025-03-09 06:55:53,538 [INFO]: 		-> Train: 16.7 minutes
2025-03-09 06:55:53,538 [INFO]: 		-> Add: 2.9 seconds
2025-03-09 06:55:53,538 [INFO]: 		Total: 16.7 minutes
2025-03-09 06:55:53,538 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0001 secs
2025-03-09 06:55:53,538 [INFO]: 	Checking that your have enough memory available to create the index 03/09/2025, 06:55:53
2025-03-09 06:55:53,538 [INFO]: 1.1GB of memory will be needed to build the index (more might be used if you have more)
2025-03-09 06:55:53,538 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0002 secs
2025-03-09 06:55:53,538 [INFO]: 	Selecting most promising index types given data characteristics 03/09/2025, 06:55:53
2025-03-09 06:55:53,538 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-09 06:55:53,538 [INFO]: 	Creating the index 03/09/2025, 06:55:53
2025-03-09 06:55:53,538 [INFO]: 		-> Instanciate the index HNSW15 03/09/2025, 06:55:53
2025-03-09 06:55:53,539 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0011 secs
2025-03-09 06:55:53,539 [INFO]: 		-> Adding the vectors to the index 03/09/2025, 06:55:53
2025-03-09 06:55:53,539 [INFO]: The memory available for adding the vectors is 49.0GB(total available - used by the index)
2025-03-09 06:55:53,539 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/22 [00:00<?, ?it/s]  5%|▍         | 1/22 [00:00<00:03,  6.31it/s] 18%|█▊        | 4/22 [00:00<00:01, 16.89it/s] 36%|███▋      | 8/22 [00:00<00:00, 25.80it/s] 59%|█████▉    | 13/22 [00:00<00:00, 32.51it/s] 82%|████████▏ | 18/22 [00:00<00:00, 36.24it/s]100%|██████████| 22/22 [00:05<00:00,  2.57it/s]100%|██████████| 22/22 [00:05<00:00,  4.30it/s]
2025-03-09 06:55:58,663 [INFO]: 	Computing best hyperparameters for index knn.index 03/09/2025, 06:55:58
2025-03-09 06:56:43,984 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 45.3197 secs
2025-03-09 06:56:43,984 [INFO]: The best hyperparameters are: efSearch=190
2025-03-09 06:56:43,984 [INFO]: 	Compute fast metrics 03/09/2025, 06:56:43
  0%|          | 0/4 [00:00<?, ?it/s] 50%|█████     | 2/4 [00:00<00:00, 17.91it/s] 75%|███████▌  | 3/4 [00:00<00:00, 19.68it/s]
2025-03-09 06:56:56,839 [INFO]: 	>>> Finished "Compute fast metrics" in 12.8548 secs
2025-03-09 06:56:56,840 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 63.3004 secs
2025-03-09 06:56:56,840 [INFO]: {
2025-03-09 06:56:56,840 [INFO]: 	index_key: HNSW15
2025-03-09 06:56:56,840 [INFO]: 	index_param: efSearch=190
2025-03-09 06:56:56,840 [INFO]: 	index_path: knn.index
2025-03-09 06:56:56,840 [INFO]: 	size in bytes: 1035070750
2025-03-09 06:56:56,840 [INFO]: 	avg_search_speed_ms: 9.441363472646284
2025-03-09 06:56:56,840 [INFO]: 	99p_search_speed_ms: 21.127800787799064
2025-03-09 06:56:56,840 [INFO]: 	reconstruction error %: 0.0
2025-03-09 06:56:56,840 [INFO]: 	nb vectors: 5261
2025-03-09 06:56:56,840 [INFO]: 	vectors dimension: 49152
2025-03-09 06:56:56,840 [INFO]: 	compression ratio: 0.9993081999467186
2025-03-09 06:56:56,840 [INFO]: }
2025-03-09 06:56:56,840 [INFO]: 	>>> Finished "Creating the index" in 63.3020 secs
2025-03-09 06:56:56,840 [INFO]: >>> Finished "Launching the whole pipeline" in 63.3435 secs
2025-03-09 06:56:57: [retrieval_preprocessing] calculating distances ...
2025-03-09 06:56:58: [retrieval_preprocessing] finished and saved retrieval indices for episode 68107 [episode count 7/20]
[retrieval_preprocessing] for episode 72334 [episode count 8/20], we have num_retrieval=np.int64(4904) num_query=np.int64(612)
2025-03-09 06:56:59,218 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-09 06:56:59,849 [INFO]: Launching the whole pipeline 03/09/2025, 06:56:59
2025-03-09 06:56:59,849 [INFO]: Reading total number of vectors and dimension 03/09/2025, 06:56:59
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 2200.58it/s]
2025-03-09 06:56:59,873 [INFO]: There are 4904 embeddings of dim 49152
2025-03-09 06:56:59,873 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0239 secs
2025-03-09 06:56:59,873 [INFO]: 	Compute estimated construction time of the index 03/09/2025, 06:56:59
2025-03-09 06:56:59,873 [INFO]: 		-> Train: 16.7 minutes
2025-03-09 06:56:59,873 [INFO]: 		-> Add: 2.7 seconds
2025-03-09 06:56:59,873 [INFO]: 		Total: 16.7 minutes
2025-03-09 06:56:59,873 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0001 secs
2025-03-09 06:56:59,873 [INFO]: 	Checking that your have enough memory available to create the index 03/09/2025, 06:56:59
2025-03-09 06:56:59,873 [INFO]: 1012.1MB of memory will be needed to build the index (more might be used if you have more)
2025-03-09 06:56:59,873 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0001 secs
2025-03-09 06:56:59,873 [INFO]: 	Selecting most promising index types given data characteristics 03/09/2025, 06:56:59
2025-03-09 06:56:59,873 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-09 06:56:59,873 [INFO]: 	Creating the index 03/09/2025, 06:56:59
2025-03-09 06:56:59,873 [INFO]: 		-> Instanciate the index HNSW15 03/09/2025, 06:56:59
2025-03-09 06:56:59,874 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0009 secs
2025-03-09 06:56:59,874 [INFO]: 		-> Adding the vectors to the index 03/09/2025, 06:56:59
2025-03-09 06:56:59,874 [INFO]: The memory available for adding the vectors is 49.1GB(total available - used by the index)
2025-03-09 06:56:59,874 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/20 [00:00<?, ?it/s] 10%|█         | 2/20 [00:00<00:01, 17.28it/s] 40%|████      | 8/20 [00:00<00:00, 38.06it/s] 70%|███████   | 14/20 [00:00<00:00, 44.98it/s]100%|██████████| 20/20 [00:04<00:00,  3.44it/s]100%|██████████| 20/20 [00:04<00:00,  4.77it/s]
2025-03-09 06:57:04,074 [INFO]: 	Computing best hyperparameters for index knn.index 03/09/2025, 06:57:04
2025-03-09 06:57:45,196 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 41.1211 secs
2025-03-09 06:57:45,196 [INFO]: The best hyperparameters are: efSearch=226
2025-03-09 06:57:45,196 [INFO]: 	Compute fast metrics 03/09/2025, 06:57:45
  0%|          | 0/4 [00:00<?, ?it/s] 75%|███████▌  | 3/4 [00:00<00:00, 26.11it/s] 75%|███████▌  | 3/4 [00:00<00:00, 22.36it/s]
2025-03-09 06:57:59,120 [INFO]: 	>>> Finished "Compute fast metrics" in 13.9243 secs
2025-03-09 06:57:59,124 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 59.2492 secs
2025-03-09 06:57:59,124 [INFO]: {
2025-03-09 06:57:59,124 [INFO]: 	index_key: HNSW15
2025-03-09 06:57:59,124 [INFO]: 	index_param: efSearch=226
2025-03-09 06:57:59,124 [INFO]: 	index_path: knn.index
2025-03-09 06:57:59,124 [INFO]: 	size in bytes: 964832530
2025-03-09 06:57:59,124 [INFO]: 	avg_search_speed_ms: 9.513999797584583
2025-03-09 06:57:59,124 [INFO]: 	99p_search_speed_ms: 13.170310063287616
2025-03-09 06:57:59,124 [INFO]: 	reconstruction error %: 0.0
2025-03-09 06:57:59,124 [INFO]: 	nb vectors: 4904
2025-03-09 06:57:59,124 [INFO]: 	vectors dimension: 49152
2025-03-09 06:57:59,124 [INFO]: 	compression ratio: 0.9993087940349606
2025-03-09 06:57:59,124 [INFO]: }
2025-03-09 06:57:59,124 [INFO]: 	>>> Finished "Creating the index" in 59.2506 secs
2025-03-09 06:57:59,124 [INFO]: >>> Finished "Launching the whole pipeline" in 59.2751 secs
2025-03-09 06:58:02: [retrieval_preprocessing] calculating distances ...
2025-03-09 06:58:04: [retrieval_preprocessing] finished and saved retrieval indices for episode 72334 [episode count 8/20]
[retrieval_preprocessing] for episode 45967 [episode count 9/20], we have num_retrieval=np.int64(5263) num_query=np.int64(253)
2025-03-09 06:58:04,518 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-09 06:58:05,137 [INFO]: Launching the whole pipeline 03/09/2025, 06:58:05
2025-03-09 06:58:05,137 [INFO]: Reading total number of vectors and dimension 03/09/2025, 06:58:05
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1139.76it/s]
2025-03-09 06:58:05,163 [INFO]: There are 5263 embeddings of dim 49152
2025-03-09 06:58:05,163 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0258 secs
2025-03-09 06:58:05,163 [INFO]: 	Compute estimated construction time of the index 03/09/2025, 06:58:05
2025-03-09 06:58:05,163 [INFO]: 		-> Train: 16.7 minutes
2025-03-09 06:58:05,163 [INFO]: 		-> Add: 2.9 seconds
2025-03-09 06:58:05,163 [INFO]: 		Total: 16.7 minutes
2025-03-09 06:58:05,163 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0001 secs
2025-03-09 06:58:05,163 [INFO]: 	Checking that your have enough memory available to create the index 03/09/2025, 06:58:05
2025-03-09 06:58:05,163 [INFO]: 1.1GB of memory will be needed to build the index (more might be used if you have more)
2025-03-09 06:58:05,163 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0002 secs
2025-03-09 06:58:05,163 [INFO]: 	Selecting most promising index types given data characteristics 03/09/2025, 06:58:05
2025-03-09 06:58:05,163 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-09 06:58:05,163 [INFO]: 	Creating the index 03/09/2025, 06:58:05
2025-03-09 06:58:05,163 [INFO]: 		-> Instanciate the index HNSW15 03/09/2025, 06:58:05
2025-03-09 06:58:05,165 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0012 secs
2025-03-09 06:58:05,165 [INFO]: 		-> Adding the vectors to the index 03/09/2025, 06:58:05
2025-03-09 06:58:05,165 [INFO]: The memory available for adding the vectors is 49.0GB(total available - used by the index)
2025-03-09 06:58:05,165 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/22 [00:00<?, ?it/s]  5%|▍         | 1/22 [00:00<00:02,  9.47it/s] 32%|███▏      | 7/22 [00:00<00:00, 36.17it/s] 59%|█████▉    | 13/22 [00:00<00:00, 44.05it/s] 86%|████████▋ | 19/22 [00:00<00:00, 47.67it/s]100%|██████████| 22/22 [00:05<00:00,  4.13it/s]
2025-03-09 06:58:10,489 [INFO]: 	Computing best hyperparameters for index knn.index 03/09/2025, 06:58:10
2025-03-09 06:58:56,094 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 45.6045 secs
2025-03-09 06:58:56,094 [INFO]: The best hyperparameters are: efSearch=194
2025-03-09 06:58:56,094 [INFO]: 	Compute fast metrics 03/09/2025, 06:58:56
  0%|          | 0/4 [00:00<?, ?it/s] 50%|█████     | 2/4 [00:00<00:00, 19.99it/s] 75%|███████▌  | 3/4 [00:00<00:00, 21.47it/s]
2025-03-09 06:59:11,665 [INFO]: 	>>> Finished "Compute fast metrics" in 15.5709 secs
2025-03-09 06:59:11,666 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 66.5015 secs
2025-03-09 06:59:11,666 [INFO]: {
2025-03-09 06:59:11,666 [INFO]: 	index_key: HNSW15
2025-03-09 06:59:11,666 [INFO]: 	index_param: efSearch=194
2025-03-09 06:59:11,666 [INFO]: 	index_path: knn.index
2025-03-09 06:59:11,666 [INFO]: 	size in bytes: 1035464230
2025-03-09 06:59:11,667 [INFO]: 	avg_search_speed_ms: 8.339340253472887
2025-03-09 06:59:11,667 [INFO]: 	99p_search_speed_ms: 12.005993449129164
2025-03-09 06:59:11,667 [INFO]: 	reconstruction error %: 0.0
2025-03-09 06:59:11,667 [INFO]: 	nb vectors: 5263
2025-03-09 06:59:11,667 [INFO]: 	vectors dimension: 49152
2025-03-09 06:59:11,667 [INFO]: 	compression ratio: 0.999308207875032
2025-03-09 06:59:11,667 [INFO]: }
2025-03-09 06:59:11,667 [INFO]: 	>>> Finished "Creating the index" in 66.5032 secs
2025-03-09 06:59:11,667 [INFO]: >>> Finished "Launching the whole pipeline" in 66.5298 secs
2025-03-09 06:59:13: [retrieval_preprocessing] calculating distances ...
2025-03-09 06:59:14: [retrieval_preprocessing] finished and saved retrieval indices for episode 45967 [episode count 9/20]
[retrieval_preprocessing] for episode 55061 [episode count 10/20], we have num_retrieval=np.int64(5314) num_query=np.int64(202)
2025-03-09 06:59:14,599 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-09 06:59:15,300 [INFO]: Launching the whole pipeline 03/09/2025, 06:59:15
2025-03-09 06:59:15,300 [INFO]: Reading total number of vectors and dimension 03/09/2025, 06:59:15
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1446.81it/s]
2025-03-09 06:59:15,324 [INFO]: There are 5314 embeddings of dim 49152
2025-03-09 06:59:15,324 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0239 secs
2025-03-09 06:59:15,324 [INFO]: 	Compute estimated construction time of the index 03/09/2025, 06:59:15
2025-03-09 06:59:15,324 [INFO]: 		-> Train: 16.7 minutes
2025-03-09 06:59:15,324 [INFO]: 		-> Add: 2.9 seconds
2025-03-09 06:59:15,324 [INFO]: 		Total: 16.7 minutes
2025-03-09 06:59:15,324 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0001 secs
2025-03-09 06:59:15,324 [INFO]: 	Checking that your have enough memory available to create the index 03/09/2025, 06:59:15
2025-03-09 06:59:15,325 [INFO]: 1.1GB of memory will be needed to build the index (more might be used if you have more)
2025-03-09 06:59:15,325 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0001 secs
2025-03-09 06:59:15,325 [INFO]: 	Selecting most promising index types given data characteristics 03/09/2025, 06:59:15
2025-03-09 06:59:15,325 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-09 06:59:15,325 [INFO]: 	Creating the index 03/09/2025, 06:59:15
2025-03-09 06:59:15,325 [INFO]: 		-> Instanciate the index HNSW15 03/09/2025, 06:59:15
2025-03-09 06:59:15,326 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0010 secs
2025-03-09 06:59:15,326 [INFO]: 		-> Adding the vectors to the index 03/09/2025, 06:59:15
2025-03-09 06:59:15,326 [INFO]: The memory available for adding the vectors is 49.0GB(total available - used by the index)
2025-03-09 06:59:15,326 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/22 [00:00<?, ?it/s]  5%|▍         | 1/22 [00:00<00:02,  9.99it/s] 27%|██▋       | 6/22 [00:00<00:00, 32.69it/s] 50%|█████     | 11/22 [00:00<00:00, 40.08it/s] 77%|███████▋  | 17/22 [00:00<00:00, 45.64it/s]100%|██████████| 22/22 [00:05<00:00,  2.57it/s]100%|██████████| 22/22 [00:05<00:00,  3.97it/s]
2025-03-09 06:59:20,866 [INFO]: 	Computing best hyperparameters for index knn.index 03/09/2025, 06:59:20
2025-03-09 07:00:02,861 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 41.9948 secs
2025-03-09 07:00:02,861 [INFO]: The best hyperparameters are: efSearch=190
2025-03-09 07:00:02,861 [INFO]: 	Compute fast metrics 03/09/2025, 07:00:02
  0%|          | 0/4 [00:00<?, ?it/s] 50%|█████     | 2/4 [00:00<00:00, 18.29it/s] 75%|███████▌  | 3/4 [00:00<00:00, 20.02it/s]
2025-03-09 07:00:16,700 [INFO]: 	>>> Finished "Compute fast metrics" in 13.8386 secs
2025-03-09 07:00:16,700 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 61.3744 secs
2025-03-09 07:00:16,700 [INFO]: {
2025-03-09 07:00:16,701 [INFO]: 	index_key: HNSW15
2025-03-09 07:00:16,701 [INFO]: 	index_param: efSearch=190
2025-03-09 07:00:16,701 [INFO]: 	index_path: knn.index
2025-03-09 07:00:16,701 [INFO]: 	size in bytes: 1045498210
2025-03-09 07:00:16,701 [INFO]: 	avg_search_speed_ms: 9.430250162381633
2025-03-09 07:00:16,701 [INFO]: 	99p_search_speed_ms: 19.315676018595706
2025-03-09 07:00:16,701 [INFO]: 	reconstruction error %: 0.0
2025-03-09 07:00:16,701 [INFO]: 	nb vectors: 5314
2025-03-09 07:00:16,701 [INFO]: 	vectors dimension: 49152
2025-03-09 07:00:16,701 [INFO]: 	compression ratio: 0.9993081786338017
2025-03-09 07:00:16,701 [INFO]: }
2025-03-09 07:00:16,701 [INFO]: 	>>> Finished "Creating the index" in 61.3759 secs
2025-03-09 07:00:16,701 [INFO]: >>> Finished "Launching the whole pipeline" in 61.4004 secs
2025-03-09 07:00:17: [retrieval_preprocessing] calculating distances ...
2025-03-09 07:00:18: [retrieval_preprocessing] finished and saved retrieval indices for episode 55061 [episode count 10/20]
[retrieval_preprocessing] for episode 88982 [episode count 11/20], we have num_retrieval=np.int64(5252) num_query=np.int64(264)
2025-03-09 07:00:18,705 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-09 07:00:19,458 [INFO]: Launching the whole pipeline 03/09/2025, 07:00:19
2025-03-09 07:00:19,458 [INFO]: Reading total number of vectors and dimension 03/09/2025, 07:00:19
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1009.70it/s]
2025-03-09 07:00:19,485 [INFO]: There are 5252 embeddings of dim 49152
2025-03-09 07:00:19,485 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0271 secs
2025-03-09 07:00:19,485 [INFO]: 	Compute estimated construction time of the index 03/09/2025, 07:00:19
2025-03-09 07:00:19,485 [INFO]: 		-> Train: 16.7 minutes
2025-03-09 07:00:19,485 [INFO]: 		-> Add: 2.9 seconds
2025-03-09 07:00:19,485 [INFO]: 		Total: 16.7 minutes
2025-03-09 07:00:19,485 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0001 secs
2025-03-09 07:00:19,485 [INFO]: 	Checking that your have enough memory available to create the index 03/09/2025, 07:00:19
2025-03-09 07:00:19,485 [INFO]: 1.1GB of memory will be needed to build the index (more might be used if you have more)
2025-03-09 07:00:19,485 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0001 secs
2025-03-09 07:00:19,485 [INFO]: 	Selecting most promising index types given data characteristics 03/09/2025, 07:00:19
2025-03-09 07:00:19,486 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-09 07:00:19,486 [INFO]: 	Creating the index 03/09/2025, 07:00:19
2025-03-09 07:00:19,486 [INFO]: 		-> Instanciate the index HNSW15 03/09/2025, 07:00:19
2025-03-09 07:00:19,487 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0010 secs
2025-03-09 07:00:19,487 [INFO]: 		-> Adding the vectors to the index 03/09/2025, 07:00:19
2025-03-09 07:00:19,487 [INFO]: The memory available for adding the vectors is 49.0GB(total available - used by the index)
2025-03-09 07:00:19,487 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/22 [00:00<?, ?it/s]  5%|▍         | 1/22 [00:00<00:02,  8.81it/s] 27%|██▋       | 6/22 [00:00<00:00, 30.26it/s] 50%|█████     | 11/22 [00:00<00:00, 37.12it/s] 68%|██████▊   | 15/22 [00:00<00:00, 37.97it/s] 91%|█████████ | 20/22 [00:00<00:00, 39.57it/s]100%|██████████| 22/22 [00:05<00:00,  3.86it/s]
2025-03-09 07:00:25,193 [INFO]: 	Computing best hyperparameters for index knn.index 03/09/2025, 07:00:25
2025-03-09 07:01:04,924 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 39.7308 secs
2025-03-09 07:01:04,924 [INFO]: The best hyperparameters are: efSearch=200
2025-03-09 07:01:04,924 [INFO]: 	Compute fast metrics 03/09/2025, 07:01:04
  0%|          | 0/4 [00:00<?, ?it/s] 50%|█████     | 2/4 [00:00<00:00, 17.86it/s] 75%|███████▌  | 3/4 [00:00<00:00, 18.92it/s]
2025-03-09 07:01:18,665 [INFO]: 	>>> Finished "Compute fast metrics" in 13.7411 secs
2025-03-09 07:01:18,666 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 59.1790 secs
2025-03-09 07:01:18,666 [INFO]: {
2025-03-09 07:01:18,666 [INFO]: 	index_key: HNSW15
2025-03-09 07:01:18,666 [INFO]: 	index_param: efSearch=200
2025-03-09 07:01:18,666 [INFO]: 	index_path: knn.index
2025-03-09 07:01:18,666 [INFO]: 	size in bytes: 1033300030
2025-03-09 07:01:18,666 [INFO]: 	avg_search_speed_ms: 9.385063606061
2025-03-09 07:01:18,666 [INFO]: 	99p_search_speed_ms: 15.526889730244871
2025-03-09 07:01:18,666 [INFO]: 	reconstruction error %: 0.0
2025-03-09 07:01:18,666 [INFO]: 	nb vectors: 5252
2025-03-09 07:01:18,666 [INFO]: 	vectors dimension: 49152
2025-03-09 07:01:18,666 [INFO]: 	compression ratio: 0.9993082222208006
2025-03-09 07:01:18,666 [INFO]: }
2025-03-09 07:01:18,666 [INFO]: 	>>> Finished "Creating the index" in 59.1805 secs
2025-03-09 07:01:18,666 [INFO]: >>> Finished "Launching the whole pipeline" in 59.2083 secs
2025-03-09 07:01:19: [retrieval_preprocessing] calculating distances ...
2025-03-09 07:01:20: [retrieval_preprocessing] finished and saved retrieval indices for episode 88982 [episode count 11/20]
[retrieval_preprocessing] for episode 21532 [episode count 12/20], we have num_retrieval=np.int64(5234) num_query=np.int64(282)
2025-03-09 07:01:21,011 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-09 07:01:21,760 [INFO]: Launching the whole pipeline 03/09/2025, 07:01:21
2025-03-09 07:01:21,760 [INFO]: Reading total number of vectors and dimension 03/09/2025, 07:01:21
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1415.08it/s]
2025-03-09 07:01:21,788 [INFO]: There are 5234 embeddings of dim 49152
2025-03-09 07:01:21,788 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0279 secs
2025-03-09 07:01:21,788 [INFO]: 	Compute estimated construction time of the index 03/09/2025, 07:01:21
2025-03-09 07:01:21,788 [INFO]: 		-> Train: 16.7 minutes
2025-03-09 07:01:21,788 [INFO]: 		-> Add: 2.9 seconds
2025-03-09 07:01:21,788 [INFO]: 		Total: 16.7 minutes
2025-03-09 07:01:21,789 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0001 secs
2025-03-09 07:01:21,789 [INFO]: 	Checking that your have enough memory available to create the index 03/09/2025, 07:01:21
2025-03-09 07:01:21,789 [INFO]: 1.1GB of memory will be needed to build the index (more might be used if you have more)
2025-03-09 07:01:21,789 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0002 secs
2025-03-09 07:01:21,789 [INFO]: 	Selecting most promising index types given data characteristics 03/09/2025, 07:01:21
2025-03-09 07:01:21,789 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-09 07:01:21,789 [INFO]: 	Creating the index 03/09/2025, 07:01:21
2025-03-09 07:01:21,789 [INFO]: 		-> Instanciate the index HNSW15 03/09/2025, 07:01:21
2025-03-09 07:01:21,790 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0009 secs
2025-03-09 07:01:21,790 [INFO]: 		-> Adding the vectors to the index 03/09/2025, 07:01:21
2025-03-09 07:01:21,790 [INFO]: The memory available for adding the vectors is 49.0GB(total available - used by the index)
2025-03-09 07:01:21,790 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/22 [00:00<?, ?it/s]  5%|▍         | 1/22 [00:00<00:02,  9.40it/s] 27%|██▋       | 6/22 [00:00<00:00, 31.67it/s] 50%|█████     | 11/22 [00:00<00:00, 39.05it/s] 73%|███████▎  | 16/22 [00:00<00:00, 42.53it/s] 95%|█████████▌| 21/22 [00:04<00:00,  3.00it/s]100%|██████████| 22/22 [00:05<00:00,  4.24it/s]
2025-03-09 07:01:26,984 [INFO]: 	Computing best hyperparameters for index knn.index 03/09/2025, 07:01:26
2025-03-09 07:02:09,114 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 42.1304 secs
2025-03-09 07:02:09,115 [INFO]: The best hyperparameters are: efSearch=140
2025-03-09 07:02:09,115 [INFO]: 	Compute fast metrics 03/09/2025, 07:02:09
  0%|          | 0/4 [00:00<?, ?it/s] 50%|█████     | 2/4 [00:00<00:00, 18.12it/s] 75%|███████▌  | 3/4 [00:00<00:00, 19.76it/s]
2025-03-09 07:02:21,744 [INFO]: 	>>> Finished "Compute fast metrics" in 12.6296 secs
2025-03-09 07:02:21,745 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 59.9547 secs
2025-03-09 07:02:21,745 [INFO]: {
2025-03-09 07:02:21,745 [INFO]: 	index_key: HNSW15
2025-03-09 07:02:21,745 [INFO]: 	index_param: efSearch=140
2025-03-09 07:02:21,745 [INFO]: 	index_path: knn.index
2025-03-09 07:02:21,745 [INFO]: 	size in bytes: 1029758590
2025-03-09 07:02:21,745 [INFO]: 	avg_search_speed_ms: 6.723925221564841
2025-03-09 07:02:21,745 [INFO]: 	99p_search_speed_ms: 10.1726004248485
2025-03-09 07:02:21,745 [INFO]: 	reconstruction error %: 0.0
2025-03-09 07:02:21,745 [INFO]: 	nb vectors: 5234
2025-03-09 07:02:21,745 [INFO]: 	vectors dimension: 49152
2025-03-09 07:02:21,745 [INFO]: 	compression ratio: 0.999308266998773
2025-03-09 07:02:21,745 [INFO]: }
2025-03-09 07:02:21,745 [INFO]: 	>>> Finished "Creating the index" in 59.9561 secs
2025-03-09 07:02:21,745 [INFO]: >>> Finished "Launching the whole pipeline" in 59.9847 secs
2025-03-09 07:02:22: [retrieval_preprocessing] calculating distances ...
2025-03-09 07:02:23: [retrieval_preprocessing] finished and saved retrieval indices for episode 21532 [episode count 12/20]
[retrieval_preprocessing] for episode 76956 [episode count 13/20], we have num_retrieval=np.int64(5313) num_query=np.int64(203)
2025-03-09 07:02:23,807 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-09 07:02:24,454 [INFO]: Launching the whole pipeline 03/09/2025, 07:02:24
2025-03-09 07:02:24,455 [INFO]: Reading total number of vectors and dimension 03/09/2025, 07:02:24
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 2102.41it/s]
2025-03-09 07:02:24,478 [INFO]: There are 5313 embeddings of dim 49152
2025-03-09 07:02:24,479 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0241 secs
2025-03-09 07:02:24,479 [INFO]: 	Compute estimated construction time of the index 03/09/2025, 07:02:24
2025-03-09 07:02:24,479 [INFO]: 		-> Train: 16.7 minutes
2025-03-09 07:02:24,479 [INFO]: 		-> Add: 2.9 seconds
2025-03-09 07:02:24,479 [INFO]: 		Total: 16.7 minutes
2025-03-09 07:02:24,479 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0003 secs
2025-03-09 07:02:24,479 [INFO]: 	Checking that your have enough memory available to create the index 03/09/2025, 07:02:24
2025-03-09 07:02:24,479 [INFO]: 1.1GB of memory will be needed to build the index (more might be used if you have more)
2025-03-09 07:02:24,479 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0002 secs
2025-03-09 07:02:24,479 [INFO]: 	Selecting most promising index types given data characteristics 03/09/2025, 07:02:24
2025-03-09 07:02:24,479 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-09 07:02:24,479 [INFO]: 	Creating the index 03/09/2025, 07:02:24
2025-03-09 07:02:24,480 [INFO]: 		-> Instanciate the index HNSW15 03/09/2025, 07:02:24
2025-03-09 07:02:24,481 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0011 secs
2025-03-09 07:02:24,481 [INFO]: 		-> Adding the vectors to the index 03/09/2025, 07:02:24
2025-03-09 07:02:24,481 [INFO]: The memory available for adding the vectors is 49.0GB(total available - used by the index)
2025-03-09 07:02:24,481 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/22 [00:00<?, ?it/s]  5%|▍         | 1/22 [00:00<00:02,  8.51it/s] 27%|██▋       | 6/22 [00:00<00:00, 30.15it/s] 50%|█████     | 11/22 [00:00<00:00, 38.00it/s] 73%|███████▎  | 16/22 [00:00<00:00, 41.82it/s] 95%|█████████▌| 21/22 [00:04<00:00,  3.24it/s]100%|██████████| 22/22 [00:04<00:00,  4.48it/s]
2025-03-09 07:02:29,391 [INFO]: 	Computing best hyperparameters for index knn.index 03/09/2025, 07:02:29
2025-03-09 07:03:15,287 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 45.8958 secs
2025-03-09 07:03:15,287 [INFO]: The best hyperparameters are: efSearch=96
2025-03-09 07:03:15,287 [INFO]: 	Compute fast metrics 03/09/2025, 07:03:15
  0%|          | 0/4 [00:00<?, ?it/s] 50%|█████     | 2/4 [00:00<00:00, 19.12it/s] 75%|███████▌  | 3/4 [00:00<00:00, 20.13it/s]
2025-03-09 07:03:27,710 [INFO]: 	>>> Finished "Compute fast metrics" in 12.4230 secs
2025-03-09 07:03:27,711 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 63.2303 secs
2025-03-09 07:03:27,711 [INFO]: {
2025-03-09 07:03:27,711 [INFO]: 	index_key: HNSW15
2025-03-09 07:03:27,711 [INFO]: 	index_param: efSearch=96
2025-03-09 07:03:27,711 [INFO]: 	index_path: knn.index
2025-03-09 07:03:27,711 [INFO]: 	size in bytes: 1045301470
2025-03-09 07:03:27,711 [INFO]: 	avg_search_speed_ms: 4.658876175060868
2025-03-09 07:03:27,711 [INFO]: 	99p_search_speed_ms: 7.458584550768137
2025-03-09 07:03:27,711 [INFO]: 	reconstruction error %: 0.0
2025-03-09 07:03:27,711 [INFO]: 	nb vectors: 5313
2025-03-09 07:03:27,711 [INFO]: 	vectors dimension: 49152
2025-03-09 07:03:27,711 [INFO]: 	compression ratio: 0.99930817470294
2025-03-09 07:03:27,711 [INFO]: }
2025-03-09 07:03:27,711 [INFO]: 	>>> Finished "Creating the index" in 63.2318 secs
2025-03-09 07:03:27,711 [INFO]: >>> Finished "Launching the whole pipeline" in 63.2568 secs
2025-03-09 07:03:28: [retrieval_preprocessing] calculating distances ...
2025-03-09 07:03:28: [retrieval_preprocessing] finished and saved retrieval indices for episode 76956 [episode count 13/20]
[retrieval_preprocessing] for episode 92958 [episode count 14/20], we have num_retrieval=np.int64(5054) num_query=np.int64(462)
2025-03-09 07:03:29,009 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-09 07:03:29,577 [INFO]: Launching the whole pipeline 03/09/2025, 07:03:29
2025-03-09 07:03:29,577 [INFO]: Reading total number of vectors and dimension 03/09/2025, 07:03:29
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1445.81it/s]
2025-03-09 07:03:29,603 [INFO]: There are 5054 embeddings of dim 49152
2025-03-09 07:03:29,604 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0263 secs
2025-03-09 07:03:29,604 [INFO]: 	Compute estimated construction time of the index 03/09/2025, 07:03:29
2025-03-09 07:03:29,604 [INFO]: 		-> Train: 16.7 minutes
2025-03-09 07:03:29,604 [INFO]: 		-> Add: 2.8 seconds
2025-03-09 07:03:29,604 [INFO]: 		Total: 16.7 minutes
2025-03-09 07:03:29,604 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0001 secs
2025-03-09 07:03:29,604 [INFO]: 	Checking that your have enough memory available to create the index 03/09/2025, 07:03:29
2025-03-09 07:03:29,604 [INFO]: 1.0GB of memory will be needed to build the index (more might be used if you have more)
2025-03-09 07:03:29,604 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0001 secs
2025-03-09 07:03:29,604 [INFO]: 	Selecting most promising index types given data characteristics 03/09/2025, 07:03:29
2025-03-09 07:03:29,604 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-09 07:03:29,604 [INFO]: 	Creating the index 03/09/2025, 07:03:29
2025-03-09 07:03:29,604 [INFO]: 		-> Instanciate the index HNSW15 03/09/2025, 07:03:29
2025-03-09 07:03:29,605 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0008 secs
2025-03-09 07:03:29,605 [INFO]: 		-> Adding the vectors to the index 03/09/2025, 07:03:29
2025-03-09 07:03:29,605 [INFO]: The memory available for adding the vectors is 49.1GB(total available - used by the index)
2025-03-09 07:03:29,605 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/20 [00:00<?, ?it/s]  5%|▌         | 1/20 [00:00<00:02,  9.08it/s] 35%|███▌      | 7/20 [00:00<00:00, 34.95it/s] 65%|██████▌   | 13/20 [00:00<00:00, 42.65it/s] 95%|█████████▌| 19/20 [00:00<00:00, 46.23it/s]100%|██████████| 20/20 [00:03<00:00,  5.14it/s]
2025-03-09 07:03:33,497 [INFO]: 	Computing best hyperparameters for index knn.index 03/09/2025, 07:03:33
2025-03-09 07:04:13,221 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 39.7244 secs
2025-03-09 07:04:13,222 [INFO]: The best hyperparameters are: efSearch=130
2025-03-09 07:04:13,222 [INFO]: 	Compute fast metrics 03/09/2025, 07:04:13
  0%|          | 0/4 [00:00<?, ?it/s] 50%|█████     | 2/4 [00:00<00:00, 18.35it/s] 75%|███████▌  | 3/4 [00:00<00:00, 20.17it/s]
2025-03-09 07:04:25,684 [INFO]: 	>>> Finished "Compute fast metrics" in 12.4619 secs
2025-03-09 07:04:25,686 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 56.0813 secs
2025-03-09 07:04:25,687 [INFO]: {
2025-03-09 07:04:25,687 [INFO]: 	index_key: HNSW15
2025-03-09 07:04:25,687 [INFO]: 	index_param: efSearch=130
2025-03-09 07:04:25,687 [INFO]: 	index_path: knn.index
2025-03-09 07:04:25,687 [INFO]: 	size in bytes: 994344490
2025-03-09 07:04:25,687 [INFO]: 	avg_search_speed_ms: 5.994819782923336
2025-03-09 07:04:25,687 [INFO]: 	99p_search_speed_ms: 9.323706324212246
2025-03-09 07:04:25,687 [INFO]: 	reconstruction error %: 0.0
2025-03-09 07:04:25,687 [INFO]: 	nb vectors: 5054
2025-03-09 07:04:25,687 [INFO]: 	vectors dimension: 49152
2025-03-09 07:04:25,687 [INFO]: 	compression ratio: 0.9993084308236072
2025-03-09 07:04:25,687 [INFO]: }
2025-03-09 07:04:25,687 [INFO]: 	>>> Finished "Creating the index" in 56.0826 secs
2025-03-09 07:04:25,687 [INFO]: >>> Finished "Launching the whole pipeline" in 56.1095 secs
2025-03-09 07:04:26: [retrieval_preprocessing] calculating distances ...
2025-03-09 07:04:28: [retrieval_preprocessing] finished and saved retrieval indices for episode 92958 [episode count 14/20]
[retrieval_preprocessing] for episode 38559 [episode count 15/20], we have num_retrieval=np.int64(5313) num_query=np.int64(203)
2025-03-09 07:04:28,447 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-09 07:04:29,105 [INFO]: Launching the whole pipeline 03/09/2025, 07:04:29
2025-03-09 07:04:29,105 [INFO]: Reading total number of vectors and dimension 03/09/2025, 07:04:29
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1418.91it/s]
2025-03-09 07:04:29,128 [INFO]: There are 5313 embeddings of dim 49152
2025-03-09 07:04:29,129 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0238 secs
2025-03-09 07:04:29,129 [INFO]: 	Compute estimated construction time of the index 03/09/2025, 07:04:29
2025-03-09 07:04:29,129 [INFO]: 		-> Train: 16.7 minutes
2025-03-09 07:04:29,129 [INFO]: 		-> Add: 2.9 seconds
2025-03-09 07:04:29,129 [INFO]: 		Total: 16.7 minutes
2025-03-09 07:04:29,129 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0001 secs
2025-03-09 07:04:29,129 [INFO]: 	Checking that your have enough memory available to create the index 03/09/2025, 07:04:29
2025-03-09 07:04:29,129 [INFO]: 1.1GB of memory will be needed to build the index (more might be used if you have more)
2025-03-09 07:04:29,129 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0001 secs
2025-03-09 07:04:29,129 [INFO]: 	Selecting most promising index types given data characteristics 03/09/2025, 07:04:29
2025-03-09 07:04:29,129 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-09 07:04:29,129 [INFO]: 	Creating the index 03/09/2025, 07:04:29
2025-03-09 07:04:29,129 [INFO]: 		-> Instanciate the index HNSW15 03/09/2025, 07:04:29
2025-03-09 07:04:29,130 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0009 secs
2025-03-09 07:04:29,130 [INFO]: 		-> Adding the vectors to the index 03/09/2025, 07:04:29
2025-03-09 07:04:29,130 [INFO]: The memory available for adding the vectors is 49.0GB(total available - used by the index)
2025-03-09 07:04:29,130 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/22 [00:00<?, ?it/s]  5%|▍         | 1/22 [00:00<00:02,  9.64it/s] 27%|██▋       | 6/22 [00:00<00:00, 32.49it/s] 50%|█████     | 11/22 [00:00<00:00, 38.75it/s] 73%|███████▎  | 16/22 [00:00<00:00, 41.43it/s] 95%|█████████▌| 21/22 [00:03<00:00,  3.50it/s]100%|██████████| 22/22 [00:04<00:00,  4.79it/s]
2025-03-09 07:04:33,724 [INFO]: 	Computing best hyperparameters for index knn.index 03/09/2025, 07:04:33
2025-03-09 07:05:15,517 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 41.7927 secs
2025-03-09 07:05:15,517 [INFO]: The best hyperparameters are: efSearch=188
2025-03-09 07:05:15,517 [INFO]: 	Compute fast metrics 03/09/2025, 07:05:15
  0%|          | 0/4 [00:00<?, ?it/s] 75%|███████▌  | 3/4 [00:00<00:00, 25.51it/s] 75%|███████▌  | 3/4 [00:00<00:00, 22.15it/s]
2025-03-09 07:05:28,086 [INFO]: 	>>> Finished "Compute fast metrics" in 12.5688 secs
2025-03-09 07:05:28,087 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 58.9567 secs
2025-03-09 07:05:28,087 [INFO]: {
2025-03-09 07:05:28,087 [INFO]: 	index_key: HNSW15
2025-03-09 07:05:28,087 [INFO]: 	index_param: efSearch=188
2025-03-09 07:05:28,087 [INFO]: 	index_path: knn.index
2025-03-09 07:05:28,087 [INFO]: 	size in bytes: 1045301470
2025-03-09 07:05:28,087 [INFO]: 	avg_search_speed_ms: 7.8877524593228046
2025-03-09 07:05:28,087 [INFO]: 	99p_search_speed_ms: 10.358633287250994
2025-03-09 07:05:28,087 [INFO]: 	reconstruction error %: 0.0
2025-03-09 07:05:28,087 [INFO]: 	nb vectors: 5313
2025-03-09 07:05:28,087 [INFO]: 	vectors dimension: 49152
2025-03-09 07:05:28,087 [INFO]: 	compression ratio: 0.99930817470294
2025-03-09 07:05:28,087 [INFO]: }
2025-03-09 07:05:28,087 [INFO]: 	>>> Finished "Creating the index" in 58.9580 secs
2025-03-09 07:05:28,087 [INFO]: >>> Finished "Launching the whole pipeline" in 58.9824 secs
2025-03-09 07:05:28: [retrieval_preprocessing] calculating distances ...
2025-03-09 07:05:29: [retrieval_preprocessing] finished and saved retrieval indices for episode 38559 [episode count 15/20]
[retrieval_preprocessing] for episode 57888 [episode count 16/20], we have num_retrieval=np.int64(5312) num_query=np.int64(204)
2025-03-09 07:05:29,959 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-09 07:05:30,738 [INFO]: Launching the whole pipeline 03/09/2025, 07:05:30
2025-03-09 07:05:30,738 [INFO]: Reading total number of vectors and dimension 03/09/2025, 07:05:30
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 2226.28it/s]
2025-03-09 07:05:30,762 [INFO]: There are 5312 embeddings of dim 49152
2025-03-09 07:05:30,762 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0241 secs
2025-03-09 07:05:30,762 [INFO]: 	Compute estimated construction time of the index 03/09/2025, 07:05:30
2025-03-09 07:05:30,762 [INFO]: 		-> Train: 16.7 minutes
2025-03-09 07:05:30,762 [INFO]: 		-> Add: 2.9 seconds
2025-03-09 07:05:30,762 [INFO]: 		Total: 16.7 minutes
2025-03-09 07:05:30,762 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0001 secs
2025-03-09 07:05:30,763 [INFO]: 	Checking that your have enough memory available to create the index 03/09/2025, 07:05:30
2025-03-09 07:05:30,763 [INFO]: 1.1GB of memory will be needed to build the index (more might be used if you have more)
2025-03-09 07:05:30,763 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0001 secs
2025-03-09 07:05:30,763 [INFO]: 	Selecting most promising index types given data characteristics 03/09/2025, 07:05:30
2025-03-09 07:05:30,763 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-09 07:05:30,763 [INFO]: 	Creating the index 03/09/2025, 07:05:30
2025-03-09 07:05:30,763 [INFO]: 		-> Instanciate the index HNSW15 03/09/2025, 07:05:30
2025-03-09 07:05:30,764 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0010 secs
2025-03-09 07:05:30,764 [INFO]: 		-> Adding the vectors to the index 03/09/2025, 07:05:30
2025-03-09 07:05:30,764 [INFO]: The memory available for adding the vectors is 49.0GB(total available - used by the index)
2025-03-09 07:05:30,764 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/22 [00:00<?, ?it/s]  5%|▍         | 1/22 [00:00<00:02,  8.87it/s] 32%|███▏      | 7/22 [00:00<00:00, 34.89it/s] 59%|█████▉    | 13/22 [00:00<00:00, 42.21it/s] 86%|████████▋ | 19/22 [00:00<00:00, 45.39it/s]100%|██████████| 22/22 [00:04<00:00,  4.83it/s]
2025-03-09 07:05:35,326 [INFO]: 	Computing best hyperparameters for index knn.index 03/09/2025, 07:05:35
2025-03-09 07:06:18,521 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 43.1954 secs
2025-03-09 07:06:18,522 [INFO]: The best hyperparameters are: efSearch=197
2025-03-09 07:06:18,522 [INFO]: 	Compute fast metrics 03/09/2025, 07:06:18
  0%|          | 0/4 [00:00<?, ?it/s] 50%|█████     | 2/4 [00:00<00:00, 17.96it/s] 75%|███████▌  | 3/4 [00:00<00:00, 20.14it/s]
2025-03-09 07:06:31,216 [INFO]: 	>>> Finished "Compute fast metrics" in 12.6943 secs
2025-03-09 07:06:31,217 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 60.4526 secs
2025-03-09 07:06:31,217 [INFO]: {
2025-03-09 07:06:31,217 [INFO]: 	index_key: HNSW15
2025-03-09 07:06:31,217 [INFO]: 	index_param: efSearch=197
2025-03-09 07:06:31,217 [INFO]: 	index_path: knn.index
2025-03-09 07:06:31,217 [INFO]: 	size in bytes: 1045104730
2025-03-09 07:06:31,217 [INFO]: 	avg_search_speed_ms: 8.208778466989573
2025-03-09 07:06:31,217 [INFO]: 	99p_search_speed_ms: 14.085192775819426
2025-03-09 07:06:31,217 [INFO]: 	reconstruction error %: 0.0
2025-03-09 07:06:31,217 [INFO]: 	nb vectors: 5312
2025-03-09 07:06:31,217 [INFO]: 	vectors dimension: 49152
2025-03-09 07:06:31,217 [INFO]: 	compression ratio: 0.9993081707705983
2025-03-09 07:06:31,217 [INFO]: }
2025-03-09 07:06:31,217 [INFO]: 	>>> Finished "Creating the index" in 60.4540 secs
2025-03-09 07:06:31,217 [INFO]: >>> Finished "Launching the whole pipeline" in 60.4789 secs
2025-03-09 07:06:31: [retrieval_preprocessing] calculating distances ...
2025-03-09 07:06:32: [retrieval_preprocessing] finished and saved retrieval indices for episode 57888 [episode count 16/20]
[retrieval_preprocessing] for episode 71968 [episode count 17/20], we have num_retrieval=np.int64(5187) num_query=np.int64(329)
2025-03-09 07:06:33,100 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-09 07:06:33,862 [INFO]: Launching the whole pipeline 03/09/2025, 07:06:33
2025-03-09 07:06:33,862 [INFO]: Reading total number of vectors and dimension 03/09/2025, 07:06:33
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1753.47it/s]
2025-03-09 07:06:33,887 [INFO]: There are 5187 embeddings of dim 49152
2025-03-09 07:06:33,887 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0251 secs
2025-03-09 07:06:33,887 [INFO]: 	Compute estimated construction time of the index 03/09/2025, 07:06:33
2025-03-09 07:06:33,887 [INFO]: 		-> Train: 16.7 minutes
2025-03-09 07:06:33,887 [INFO]: 		-> Add: 2.8 seconds
2025-03-09 07:06:33,887 [INFO]: 		Total: 16.7 minutes
2025-03-09 07:06:33,887 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0001 secs
2025-03-09 07:06:33,887 [INFO]: 	Checking that your have enough memory available to create the index 03/09/2025, 07:06:33
2025-03-09 07:06:33,887 [INFO]: 1.0GB of memory will be needed to build the index (more might be used if you have more)
2025-03-09 07:06:33,887 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0001 secs
2025-03-09 07:06:33,887 [INFO]: 	Selecting most promising index types given data characteristics 03/09/2025, 07:06:33
2025-03-09 07:06:33,888 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-09 07:06:33,888 [INFO]: 	Creating the index 03/09/2025, 07:06:33
2025-03-09 07:06:33,888 [INFO]: 		-> Instanciate the index HNSW15 03/09/2025, 07:06:33
2025-03-09 07:06:33,888 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0008 secs
2025-03-09 07:06:33,888 [INFO]: 		-> Adding the vectors to the index 03/09/2025, 07:06:33
2025-03-09 07:06:33,888 [INFO]: The memory available for adding the vectors is 49.0GB(total available - used by the index)
2025-03-09 07:06:33,889 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/22 [00:00<?, ?it/s]  5%|▍         | 1/22 [00:00<00:02,  7.94it/s] 27%|██▋       | 6/22 [00:00<00:00, 29.16it/s] 50%|█████     | 11/22 [00:00<00:00, 37.03it/s] 73%|███████▎  | 16/22 [00:00<00:00, 40.92it/s] 95%|█████████▌| 21/22 [00:04<00:00,  3.22it/s]100%|██████████| 22/22 [00:05<00:00,  4.35it/s]
2025-03-09 07:06:38,953 [INFO]: 	Computing best hyperparameters for index knn.index 03/09/2025, 07:06:38
2025-03-09 07:07:31,627 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 52.6731 secs
2025-03-09 07:07:31,658 [INFO]: The best hyperparameters are: efSearch=158
2025-03-09 07:07:31,659 [INFO]: 	Compute fast metrics 03/09/2025, 07:07:31
  0%|          | 0/4 [00:00<?, ?it/s] 25%|██▌       | 1/4 [00:00<00:00,  6.01it/s] 75%|███████▌  | 3/4 [00:00<00:00, 12.60it/s]
2025-03-09 07:07:46,022 [INFO]: 	>>> Finished "Compute fast metrics" in 14.3629 secs
2025-03-09 07:07:46,022 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 72.1334 secs
2025-03-09 07:07:46,022 [INFO]: {
2025-03-09 07:07:46,022 [INFO]: 	index_key: HNSW15
2025-03-09 07:07:46,022 [INFO]: 	index_param: efSearch=158
2025-03-09 07:07:46,022 [INFO]: 	index_path: knn.index
2025-03-09 07:07:46,022 [INFO]: 	size in bytes: 1020511510
2025-03-09 07:07:46,022 [INFO]: 	avg_search_speed_ms: 7.2274244135727495
2025-03-09 07:07:46,022 [INFO]: 	99p_search_speed_ms: 13.427840466611094
2025-03-09 07:07:46,022 [INFO]: 	reconstruction error %: 0.0
2025-03-09 07:07:46,022 [INFO]: 	nb vectors: 5187
2025-03-09 07:07:46,022 [INFO]: 	vectors dimension: 49152
2025-03-09 07:07:46,022 [INFO]: 	compression ratio: 0.9993083723279123
2025-03-09 07:07:46,022 [INFO]: }
2025-03-09 07:07:46,022 [INFO]: 	>>> Finished "Creating the index" in 72.1346 secs
2025-03-09 07:07:46,022 [INFO]: >>> Finished "Launching the whole pipeline" in 72.1603 secs
2025-03-09 07:07:47: [retrieval_preprocessing] calculating distances ...
2025-03-09 07:07:48: [retrieval_preprocessing] finished and saved retrieval indices for episode 71968 [episode count 17/20]
[retrieval_preprocessing] for episode 22950 [episode count 18/20], we have num_retrieval=np.int64(5298) num_query=np.int64(218)
2025-03-09 07:07:49,026 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-09 07:07:49,744 [INFO]: Launching the whole pipeline 03/09/2025, 07:07:49
2025-03-09 07:07:49,744 [INFO]: Reading total number of vectors and dimension 03/09/2025, 07:07:49
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1333.22it/s]
2025-03-09 07:07:49,770 [INFO]: There are 5298 embeddings of dim 49152
2025-03-09 07:07:49,770 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0259 secs
2025-03-09 07:07:49,770 [INFO]: 	Compute estimated construction time of the index 03/09/2025, 07:07:49
2025-03-09 07:07:49,770 [INFO]: 		-> Train: 16.7 minutes
2025-03-09 07:07:49,770 [INFO]: 		-> Add: 2.9 seconds
2025-03-09 07:07:49,770 [INFO]: 		Total: 16.7 minutes
2025-03-09 07:07:49,770 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0001 secs
2025-03-09 07:07:49,770 [INFO]: 	Checking that your have enough memory available to create the index 03/09/2025, 07:07:49
2025-03-09 07:07:49,770 [INFO]: 1.1GB of memory will be needed to build the index (more might be used if you have more)
2025-03-09 07:07:49,770 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0001 secs
2025-03-09 07:07:49,770 [INFO]: 	Selecting most promising index types given data characteristics 03/09/2025, 07:07:49
2025-03-09 07:07:49,771 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-09 07:07:49,771 [INFO]: 	Creating the index 03/09/2025, 07:07:49
2025-03-09 07:07:49,771 [INFO]: 		-> Instanciate the index HNSW15 03/09/2025, 07:07:49
2025-03-09 07:07:49,771 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0008 secs
2025-03-09 07:07:49,772 [INFO]: 		-> Adding the vectors to the index 03/09/2025, 07:07:49
2025-03-09 07:07:49,772 [INFO]: The memory available for adding the vectors is 49.0GB(total available - used by the index)
2025-03-09 07:07:49,772 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/22 [00:00<?, ?it/s]  5%|▍         | 1/22 [00:00<00:02,  8.11it/s] 27%|██▋       | 6/22 [00:00<00:00, 30.43it/s] 55%|█████▍    | 12/22 [00:00<00:00, 39.94it/s] 82%|████████▏ | 18/22 [00:00<00:00, 44.43it/s]100%|██████████| 22/22 [00:04<00:00,  4.72it/s]
2025-03-09 07:07:54,438 [INFO]: 	Computing best hyperparameters for index knn.index 03/09/2025, 07:07:54
2025-03-09 07:08:38,381 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 43.9428 secs
2025-03-09 07:08:38,381 [INFO]: The best hyperparameters are: efSearch=198
2025-03-09 07:08:38,382 [INFO]: 	Compute fast metrics 03/09/2025, 07:08:38
  0%|          | 0/4 [00:00<?, ?it/s] 50%|█████     | 2/4 [00:00<00:00, 19.09it/s] 75%|███████▌  | 3/4 [00:00<00:00, 21.13it/s]
2025-03-09 07:08:50,918 [INFO]: 	>>> Finished "Compute fast metrics" in 12.5355 secs
2025-03-09 07:08:50,918 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 61.1467 secs
2025-03-09 07:08:50,918 [INFO]: {
2025-03-09 07:08:50,918 [INFO]: 	index_key: HNSW15
2025-03-09 07:08:50,918 [INFO]: 	index_param: efSearch=198
2025-03-09 07:08:50,918 [INFO]: 	index_path: knn.index
2025-03-09 07:08:50,918 [INFO]: 	size in bytes: 1042350250
2025-03-09 07:08:50,918 [INFO]: 	avg_search_speed_ms: 8.348458986465069
2025-03-09 07:08:50,918 [INFO]: 	99p_search_speed_ms: 15.984803568571804
2025-03-09 07:08:50,918 [INFO]: 	reconstruction error %: 0.0
2025-03-09 07:08:50,919 [INFO]: 	nb vectors: 5298
2025-03-09 07:08:50,919 [INFO]: 	vectors dimension: 49152
2025-03-09 07:08:50,919 [INFO]: 	compression ratio: 0.9993082306067467
2025-03-09 07:08:50,919 [INFO]: }
2025-03-09 07:08:50,919 [INFO]: 	>>> Finished "Creating the index" in 61.1480 secs
2025-03-09 07:08:50,919 [INFO]: >>> Finished "Launching the whole pipeline" in 61.1744 secs
2025-03-09 07:08:51: [retrieval_preprocessing] calculating distances ...
2025-03-09 07:08:52: [retrieval_preprocessing] finished and saved retrieval indices for episode 22950 [episode count 18/20]
[retrieval_preprocessing] for episode 39591 [episode count 19/20], we have num_retrieval=np.int64(5295) num_query=np.int64(221)
2025-03-09 07:08:52,983 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-09 07:08:53,698 [INFO]: Launching the whole pipeline 03/09/2025, 07:08:53
2025-03-09 07:08:53,698 [INFO]: Reading total number of vectors and dimension 03/09/2025, 07:08:53
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1322.29it/s]
2025-03-09 07:08:53,723 [INFO]: There are 5295 embeddings of dim 49152
2025-03-09 07:08:53,723 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0251 secs
2025-03-09 07:08:53,723 [INFO]: 	Compute estimated construction time of the index 03/09/2025, 07:08:53
2025-03-09 07:08:53,723 [INFO]: 		-> Train: 16.7 minutes
2025-03-09 07:08:53,723 [INFO]: 		-> Add: 2.9 seconds
2025-03-09 07:08:53,723 [INFO]: 		Total: 16.7 minutes
2025-03-09 07:08:53,723 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0001 secs
2025-03-09 07:08:53,723 [INFO]: 	Checking that your have enough memory available to create the index 03/09/2025, 07:08:53
2025-03-09 07:08:53,723 [INFO]: 1.1GB of memory will be needed to build the index (more might be used if you have more)
2025-03-09 07:08:53,723 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0001 secs
2025-03-09 07:08:53,723 [INFO]: 	Selecting most promising index types given data characteristics 03/09/2025, 07:08:53
2025-03-09 07:08:53,723 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-09 07:08:53,723 [INFO]: 	Creating the index 03/09/2025, 07:08:53
2025-03-09 07:08:53,723 [INFO]: 		-> Instanciate the index HNSW15 03/09/2025, 07:08:53
2025-03-09 07:08:53,724 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0009 secs
2025-03-09 07:08:53,724 [INFO]: 		-> Adding the vectors to the index 03/09/2025, 07:08:53
2025-03-09 07:08:53,724 [INFO]: The memory available for adding the vectors is 49.0GB(total available - used by the index)
2025-03-09 07:08:53,724 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/22 [00:00<?, ?it/s]  5%|▍         | 1/22 [00:00<00:02,  8.11it/s] 27%|██▋       | 6/22 [00:00<00:00, 30.01it/s] 50%|█████     | 11/22 [00:00<00:00, 38.15it/s] 73%|███████▎  | 16/22 [00:00<00:00, 42.50it/s] 95%|█████████▌| 21/22 [00:04<00:00,  3.37it/s]100%|██████████| 22/22 [00:04<00:00,  4.67it/s]
2025-03-09 07:08:58,443 [INFO]: 	Computing best hyperparameters for index knn.index 03/09/2025, 07:08:58
2025-03-09 07:09:45,347 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 46.9039 secs
2025-03-09 07:09:45,347 [INFO]: The best hyperparameters are: efSearch=171
2025-03-09 07:09:45,347 [INFO]: 	Compute fast metrics 03/09/2025, 07:09:45
  0%|          | 0/4 [00:00<?, ?it/s] 50%|█████     | 2/4 [00:00<00:00, 17.64it/s] 75%|███████▌  | 3/4 [00:00<00:00, 19.10it/s]
2025-03-09 07:09:58,262 [INFO]: 	>>> Finished "Compute fast metrics" in 12.9146 secs
2025-03-09 07:09:58,263 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 64.5383 secs
2025-03-09 07:09:58,263 [INFO]: {
2025-03-09 07:09:58,263 [INFO]: 	index_key: HNSW15
2025-03-09 07:09:58,263 [INFO]: 	index_param: efSearch=171
2025-03-09 07:09:58,263 [INFO]: 	index_path: knn.index
2025-03-09 07:09:58,263 [INFO]: 	size in bytes: 1041759970
2025-03-09 07:09:58,263 [INFO]: 	avg_search_speed_ms: 7.279458870227399
2025-03-09 07:09:58,263 [INFO]: 	99p_search_speed_ms: 17.646224424242973
2025-03-09 07:09:58,263 [INFO]: 	reconstruction error %: 0.0
2025-03-09 07:09:58,263 [INFO]: 	nb vectors: 5295
2025-03-09 07:09:58,263 [INFO]: 	vectors dimension: 49152
2025-03-09 07:09:58,263 [INFO]: 	compression ratio: 0.9993082763585166
2025-03-09 07:09:58,263 [INFO]: }
2025-03-09 07:09:58,263 [INFO]: 	>>> Finished "Creating the index" in 64.5396 secs
2025-03-09 07:09:58,263 [INFO]: >>> Finished "Launching the whole pipeline" in 64.5653 secs
2025-03-09 07:09:59: [retrieval_preprocessing] calculating distances ...
2025-03-09 07:09:59: [retrieval_preprocessing] finished and saved retrieval indices for episode 39591 [episode count 19/20]
2025-03-09 07:09:59: [retrieval_preprocessing] finished for (8690198922, 'marker') [chosen_id count 0/10]
2025-03-09 07:10:01: [retrieval_preprocessing] concatenated all embeddings and indices for 20 episodes for (1477699675, 'marker') [chosen_id count 1/10]
2025-03-09 07:10:01: [retrieval_preprocessing] we have num_total=4294 embedding_dim=49152
[retrieval_preprocessing] for episode 60931 [episode count 0/20], we have num_retrieval=np.int64(4151) num_query=np.int64(143)
2025-03-09 07:10:01,936 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-09 07:10:02,529 [INFO]: Launching the whole pipeline 03/09/2025, 07:10:02
2025-03-09 07:10:02,529 [INFO]: Reading total number of vectors and dimension 03/09/2025, 07:10:02
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1696.72it/s]
2025-03-09 07:10:02,554 [INFO]: There are 4151 embeddings of dim 49152
2025-03-09 07:10:02,554 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0249 secs
2025-03-09 07:10:02,554 [INFO]: 	Compute estimated construction time of the index 03/09/2025, 07:10:02
2025-03-09 07:10:02,554 [INFO]: 		-> Train: 16.7 minutes
2025-03-09 07:10:02,554 [INFO]: 		-> Add: 2.3 seconds
2025-03-09 07:10:02,554 [INFO]: 		Total: 16.7 minutes
2025-03-09 07:10:02,554 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0001 secs
2025-03-09 07:10:02,554 [INFO]: 	Checking that your have enough memory available to create the index 03/09/2025, 07:10:02
2025-03-09 07:10:02,555 [INFO]: 856.7MB of memory will be needed to build the index (more might be used if you have more)
2025-03-09 07:10:02,555 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0002 secs
2025-03-09 07:10:02,555 [INFO]: 	Selecting most promising index types given data characteristics 03/09/2025, 07:10:02
2025-03-09 07:10:02,555 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-09 07:10:02,555 [INFO]: 	Creating the index 03/09/2025, 07:10:02
2025-03-09 07:10:02,555 [INFO]: 		-> Instanciate the index HNSW15 03/09/2025, 07:10:02
2025-03-09 07:10:02,556 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0010 secs
2025-03-09 07:10:02,556 [INFO]: 		-> Adding the vectors to the index 03/09/2025, 07:10:02
2025-03-09 07:10:02,556 [INFO]: The memory available for adding the vectors is 49.2GB(total available - used by the index)
2025-03-09 07:10:02,556 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/17 [00:00<?, ?it/s]  6%|▌         | 1/17 [00:00<00:02,  7.79it/s] 35%|███▌      | 6/17 [00:00<00:00, 27.84it/s] 65%|██████▍   | 11/17 [00:00<00:00, 34.92it/s] 94%|█████████▍| 16/17 [00:00<00:00, 38.36it/s]100%|██████████| 17/17 [00:04<00:00,  4.22it/s]
2025-03-09 07:10:06,585 [INFO]: 	Computing best hyperparameters for index knn.index 03/09/2025, 07:10:06
2025-03-09 07:10:54,336 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 47.7500 secs
2025-03-09 07:10:54,336 [INFO]: The best hyperparameters are: efSearch=240
2025-03-09 07:10:54,336 [INFO]: 	Compute fast metrics 03/09/2025, 07:10:54
  0%|          | 0/4 [00:00<?, ?it/s] 50%|█████     | 2/4 [00:00<00:00, 19.39it/s] 75%|███████▌  | 3/4 [00:00<00:00, 22.04it/s]
2025-03-09 07:11:06,914 [INFO]: 	>>> Finished "Compute fast metrics" in 12.5781 secs
2025-03-09 07:11:06,917 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 64.3609 secs
2025-03-09 07:11:06,917 [INFO]: {
2025-03-09 07:11:06,917 [INFO]: 	index_key: HNSW15
2025-03-09 07:11:06,917 [INFO]: 	index_param: efSearch=240
2025-03-09 07:11:06,917 [INFO]: 	index_path: knn.index
2025-03-09 07:11:06,917 [INFO]: 	size in bytes: 816684370
2025-03-09 07:11:06,917 [INFO]: 	avg_search_speed_ms: 11.268681259238505
2025-03-09 07:11:06,917 [INFO]: 	99p_search_speed_ms: 29.205052289180454
2025-03-09 07:11:06,917 [INFO]: 	reconstruction error %: 0.0
2025-03-09 07:11:06,917 [INFO]: 	nb vectors: 4151
2025-03-09 07:11:06,917 [INFO]: 	vectors dimension: 49152
2025-03-09 07:11:06,917 [INFO]: 	compression ratio: 0.9993087145772117
2025-03-09 07:11:06,917 [INFO]: }
2025-03-09 07:11:06,917 [INFO]: 	>>> Finished "Creating the index" in 64.3623 secs
2025-03-09 07:11:06,917 [INFO]: >>> Finished "Launching the whole pipeline" in 64.3879 secs
2025-03-09 07:11:08: [retrieval_preprocessing] calculating distances ...
2025-03-09 07:11:08: [retrieval_preprocessing] finished and saved retrieval indices for episode 60931 [episode count 0/20]
[retrieval_preprocessing] for episode 51206 [episode count 1/20], we have num_retrieval=np.int64(3961) num_query=np.int64(333)
2025-03-09 07:11:08,940 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-09 07:11:09,549 [INFO]: Launching the whole pipeline 03/09/2025, 07:11:09
2025-03-09 07:11:09,549 [INFO]: Reading total number of vectors and dimension 03/09/2025, 07:11:09
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1521.88it/s]
2025-03-09 07:11:09,576 [INFO]: There are 3961 embeddings of dim 49152
2025-03-09 07:11:09,576 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0274 secs
2025-03-09 07:11:09,576 [INFO]: 	Compute estimated construction time of the index 03/09/2025, 07:11:09
2025-03-09 07:11:09,576 [INFO]: 		-> Train: 16.7 minutes
2025-03-09 07:11:09,576 [INFO]: 		-> Add: 2.2 seconds
2025-03-09 07:11:09,576 [INFO]: 		Total: 16.7 minutes
2025-03-09 07:11:09,576 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0001 secs
2025-03-09 07:11:09,576 [INFO]: 	Checking that your have enough memory available to create the index 03/09/2025, 07:11:09
2025-03-09 07:11:09,576 [INFO]: 817.5MB of memory will be needed to build the index (more might be used if you have more)
2025-03-09 07:11:09,576 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0001 secs
2025-03-09 07:11:09,576 [INFO]: 	Selecting most promising index types given data characteristics 03/09/2025, 07:11:09
2025-03-09 07:11:09,576 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-09 07:11:09,577 [INFO]: 	Creating the index 03/09/2025, 07:11:09
2025-03-09 07:11:09,577 [INFO]: 		-> Instanciate the index HNSW15 03/09/2025, 07:11:09
2025-03-09 07:11:09,577 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0009 secs
2025-03-09 07:11:09,578 [INFO]: 		-> Adding the vectors to the index 03/09/2025, 07:11:09
2025-03-09 07:11:09,578 [INFO]: The memory available for adding the vectors is 49.3GB(total available - used by the index)
2025-03-09 07:11:09,578 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/16 [00:00<?, ?it/s]  6%|▋         | 1/16 [00:00<00:01,  8.19it/s] 44%|████▍     | 7/16 [00:00<00:00, 33.77it/s] 81%|████████▏ | 13/16 [00:00<00:00, 42.84it/s]100%|██████████| 16/16 [00:03<00:00,  4.65it/s]
2025-03-09 07:11:13,022 [INFO]: 	Computing best hyperparameters for index knn.index 03/09/2025, 07:11:13
2025-03-09 07:11:57,009 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 43.9870 secs
2025-03-09 07:11:57,010 [INFO]: The best hyperparameters are: efSearch=250
2025-03-09 07:11:57,010 [INFO]: 	Compute fast metrics 03/09/2025, 07:11:57
  0%|          | 0/4 [00:00<?, ?it/s] 50%|█████     | 2/4 [00:00<00:00, 18.93it/s] 75%|███████▌  | 3/4 [00:00<00:00, 19.43it/s]
2025-03-09 07:12:11,817 [INFO]: 	>>> Finished "Compute fast metrics" in 14.8075 secs
2025-03-09 07:12:11,820 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 62.2422 secs
2025-03-09 07:12:11,821 [INFO]: {
2025-03-09 07:12:11,821 [INFO]: 	index_key: HNSW15
2025-03-09 07:12:11,821 [INFO]: 	index_param: efSearch=250
2025-03-09 07:12:11,821 [INFO]: 	index_path: knn.index
2025-03-09 07:12:11,821 [INFO]: 	size in bytes: 779303170
2025-03-09 07:12:11,821 [INFO]: 	avg_search_speed_ms: 12.657975804508675
2025-03-09 07:12:11,821 [INFO]: 	99p_search_speed_ms: 31.582110100425787
2025-03-09 07:12:11,821 [INFO]: 	reconstruction error %: 0.0
2025-03-09 07:12:11,821 [INFO]: 	nb vectors: 3961
2025-03-09 07:12:11,821 [INFO]: 	vectors dimension: 49152
2025-03-09 07:12:11,821 [INFO]: 	compression ratio: 0.9993085078814705
2025-03-09 07:12:11,821 [INFO]: }
2025-03-09 07:12:11,821 [INFO]: 	>>> Finished "Creating the index" in 62.2443 secs
2025-03-09 07:12:11,821 [INFO]: >>> Finished "Launching the whole pipeline" in 62.2722 secs
2025-03-09 07:12:14: [retrieval_preprocessing] calculating distances ...
2025-03-09 07:12:15: [retrieval_preprocessing] finished and saved retrieval indices for episode 51206 [episode count 1/20]
[retrieval_preprocessing] for episode 74250 [episode count 2/20], we have num_retrieval=np.int64(4105) num_query=np.int64(189)
2025-03-09 07:12:15,962 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-09 07:12:16,742 [INFO]: Launching the whole pipeline 03/09/2025, 07:12:16
2025-03-09 07:12:16,743 [INFO]: Reading total number of vectors and dimension 03/09/2025, 07:12:16
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1223.19it/s]
2025-03-09 07:12:16,774 [INFO]: There are 4105 embeddings of dim 49152
2025-03-09 07:12:16,775 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0320 secs
2025-03-09 07:12:16,775 [INFO]: 	Compute estimated construction time of the index 03/09/2025, 07:12:16
2025-03-09 07:12:16,775 [INFO]: 		-> Train: 16.7 minutes
2025-03-09 07:12:16,776 [INFO]: 		-> Add: 2.3 seconds
2025-03-09 07:12:16,776 [INFO]: 		Total: 16.7 minutes
2025-03-09 07:12:16,776 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0005 secs
2025-03-09 07:12:16,776 [INFO]: 	Checking that your have enough memory available to create the index 03/09/2025, 07:12:16
2025-03-09 07:12:16,776 [INFO]: 847.2MB of memory will be needed to build the index (more might be used if you have more)
2025-03-09 07:12:16,776 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0005 secs
2025-03-09 07:12:16,776 [INFO]: 	Selecting most promising index types given data characteristics 03/09/2025, 07:12:16
2025-03-09 07:12:16,777 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-09 07:12:16,777 [INFO]: 	Creating the index 03/09/2025, 07:12:16
2025-03-09 07:12:16,777 [INFO]: 		-> Instanciate the index HNSW15 03/09/2025, 07:12:16
2025-03-09 07:12:16,780 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0028 secs
2025-03-09 07:12:16,780 [INFO]: 		-> Adding the vectors to the index 03/09/2025, 07:12:16
2025-03-09 07:12:16,780 [INFO]: The memory available for adding the vectors is 49.2GB(total available - used by the index)
2025-03-09 07:12:16,781 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/17 [00:00<?, ?it/s] 12%|█▏        | 2/17 [00:00<00:00, 18.29it/s] 41%|████      | 7/17 [00:00<00:00, 33.71it/s] 71%|███████   | 12/17 [00:00<00:00, 38.19it/s]100%|██████████| 17/17 [00:04<00:00,  2.83it/s]100%|██████████| 17/17 [00:04<00:00,  3.97it/s]
2025-03-09 07:12:21,067 [INFO]: 	Computing best hyperparameters for index knn.index 03/09/2025, 07:12:21
2025-03-09 07:13:03,110 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 42.0430 secs
2025-03-09 07:13:03,110 [INFO]: The best hyperparameters are: efSearch=201
2025-03-09 07:13:03,111 [INFO]: 	Compute fast metrics 03/09/2025, 07:13:03
  0%|          | 0/4 [00:00<?, ?it/s] 25%|██▌       | 1/4 [00:00<00:00,  9.77it/s] 75%|███████▌  | 3/4 [00:00<00:00, 18.03it/s]
2025-03-09 07:13:17,456 [INFO]: 	>>> Finished "Compute fast metrics" in 14.3451 secs
2025-03-09 07:13:17,459 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 60.6783 secs
2025-03-09 07:13:17,459 [INFO]: {
2025-03-09 07:13:17,459 [INFO]: 	index_key: HNSW15
2025-03-09 07:13:17,459 [INFO]: 	index_param: efSearch=201
2025-03-09 07:13:17,459 [INFO]: 	index_path: knn.index
2025-03-09 07:13:17,459 [INFO]: 	size in bytes: 807634210
2025-03-09 07:13:17,459 [INFO]: 	avg_search_speed_ms: 9.838521435001503
2025-03-09 07:13:17,459 [INFO]: 	99p_search_speed_ms: 18.423845432698734
2025-03-09 07:13:17,459 [INFO]: 	reconstruction error %: 0.0
2025-03-09 07:13:17,459 [INFO]: 	nb vectors: 4105
2025-03-09 07:13:17,459 [INFO]: 	vectors dimension: 49152
2025-03-09 07:13:17,459 [INFO]: 	compression ratio: 0.9993086350316933
2025-03-09 07:13:17,459 [INFO]: }
2025-03-09 07:13:17,459 [INFO]: 	>>> Finished "Creating the index" in 60.6823 secs
2025-03-09 07:13:17,459 [INFO]: >>> Finished "Launching the whole pipeline" in 60.7163 secs
2025-03-09 07:13:18: [retrieval_preprocessing] calculating distances ...
2025-03-09 07:13:19: [retrieval_preprocessing] finished and saved retrieval indices for episode 74250 [episode count 2/20]
[retrieval_preprocessing] for episode 23054 [episode count 3/20], we have num_retrieval=np.int64(3845) num_query=np.int64(449)
2025-03-09 07:13:19,608 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-09 07:13:20,170 [INFO]: Launching the whole pipeline 03/09/2025, 07:13:20
2025-03-09 07:13:20,170 [INFO]: Reading total number of vectors and dimension 03/09/2025, 07:13:20
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1125.69it/s]
2025-03-09 07:13:20,199 [INFO]: There are 3845 embeddings of dim 49152
2025-03-09 07:13:20,199 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0294 secs
2025-03-09 07:13:20,199 [INFO]: 	Compute estimated construction time of the index 03/09/2025, 07:13:20
2025-03-09 07:13:20,199 [INFO]: 		-> Train: 16.7 minutes
2025-03-09 07:13:20,199 [INFO]: 		-> Add: 2.1 seconds
2025-03-09 07:13:20,199 [INFO]: 		Total: 16.7 minutes
2025-03-09 07:13:20,199 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0001 secs
2025-03-09 07:13:20,199 [INFO]: 	Checking that your have enough memory available to create the index 03/09/2025, 07:13:20
2025-03-09 07:13:20,200 [INFO]: 793.5MB of memory will be needed to build the index (more might be used if you have more)
2025-03-09 07:13:20,200 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0001 secs
2025-03-09 07:13:20,200 [INFO]: 	Selecting most promising index types given data characteristics 03/09/2025, 07:13:20
2025-03-09 07:13:20,200 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-09 07:13:20,200 [INFO]: 	Creating the index 03/09/2025, 07:13:20
2025-03-09 07:13:20,200 [INFO]: 		-> Instanciate the index HNSW15 03/09/2025, 07:13:20
2025-03-09 07:13:20,201 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0010 secs
2025-03-09 07:13:20,201 [INFO]: 		-> Adding the vectors to the index 03/09/2025, 07:13:20
2025-03-09 07:13:20,201 [INFO]: The memory available for adding the vectors is 49.3GB(total available - used by the index)
2025-03-09 07:13:20,201 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/16 [00:00<?, ?it/s] 12%|█▎        | 2/16 [00:00<00:00, 18.13it/s] 44%|████▍     | 7/16 [00:00<00:00, 35.65it/s] 75%|███████▌  | 12/16 [00:00<00:00, 41.27it/s]100%|██████████| 16/16 [00:03<00:00,  4.30it/s]
2025-03-09 07:13:23,929 [INFO]: 	Computing best hyperparameters for index knn.index 03/09/2025, 07:13:23
2025-03-09 07:14:01,366 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 37.4367 secs
2025-03-09 07:14:01,366 [INFO]: The best hyperparameters are: efSearch=202
2025-03-09 07:14:01,366 [INFO]: 	Compute fast metrics 03/09/2025, 07:14:01
  0%|          | 0/4 [00:00<?, ?it/s] 75%|███████▌  | 3/4 [00:00<00:00, 24.18it/s] 75%|███████▌  | 3/4 [00:00<00:00, 19.95it/s]
2025-03-09 07:14:13,437 [INFO]: 	>>> Finished "Compute fast metrics" in 12.0701 secs
2025-03-09 07:14:13,440 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 53.2390 secs
2025-03-09 07:14:13,440 [INFO]: {
2025-03-09 07:14:13,440 [INFO]: 	index_key: HNSW15
2025-03-09 07:14:13,440 [INFO]: 	index_param: efSearch=202
2025-03-09 07:14:13,440 [INFO]: 	index_path: knn.index
2025-03-09 07:14:13,440 [INFO]: 	size in bytes: 756480550
2025-03-09 07:14:13,440 [INFO]: 	avg_search_speed_ms: 9.456955874206706
2025-03-09 07:14:13,440 [INFO]: 	99p_search_speed_ms: 16.79530993802473
2025-03-09 07:14:13,440 [INFO]: 	reconstruction error %: 0.0
2025-03-09 07:14:13,440 [INFO]: 	nb vectors: 3845
2025-03-09 07:14:13,440 [INFO]: 	vectors dimension: 49152
2025-03-09 07:14:13,440 [INFO]: 	compression ratio: 0.9993089181208955
2025-03-09 07:14:13,440 [INFO]: }
2025-03-09 07:14:13,440 [INFO]: 	>>> Finished "Creating the index" in 53.2405 secs
2025-03-09 07:14:13,440 [INFO]: >>> Finished "Launching the whole pipeline" in 53.2705 secs
2025-03-09 07:14:15: [retrieval_preprocessing] calculating distances ...
2025-03-09 07:14:17: [retrieval_preprocessing] finished and saved retrieval indices for episode 23054 [episode count 3/20]
[retrieval_preprocessing] for episode 67598 [episode count 4/20], we have num_retrieval=np.int64(4171) num_query=np.int64(123)
2025-03-09 07:14:17,769 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-09 07:14:18,512 [INFO]: Launching the whole pipeline 03/09/2025, 07:14:18
2025-03-09 07:14:18,512 [INFO]: Reading total number of vectors and dimension 03/09/2025, 07:14:18
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 2189.09it/s]
2025-03-09 07:14:18,538 [INFO]: There are 4171 embeddings of dim 49152
2025-03-09 07:14:18,538 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0256 secs
2025-03-09 07:14:18,538 [INFO]: 	Compute estimated construction time of the index 03/09/2025, 07:14:18
2025-03-09 07:14:18,538 [INFO]: 		-> Train: 16.7 minutes
2025-03-09 07:14:18,538 [INFO]: 		-> Add: 2.3 seconds
2025-03-09 07:14:18,538 [INFO]: 		Total: 16.7 minutes
2025-03-09 07:14:18,538 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0001 secs
2025-03-09 07:14:18,538 [INFO]: 	Checking that your have enough memory available to create the index 03/09/2025, 07:14:18
2025-03-09 07:14:18,538 [INFO]: 860.8MB of memory will be needed to build the index (more might be used if you have more)
2025-03-09 07:14:18,538 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0002 secs
2025-03-09 07:14:18,538 [INFO]: 	Selecting most promising index types given data characteristics 03/09/2025, 07:14:18
2025-03-09 07:14:18,538 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-09 07:14:18,538 [INFO]: 	Creating the index 03/09/2025, 07:14:18
2025-03-09 07:14:18,538 [INFO]: 		-> Instanciate the index HNSW15 03/09/2025, 07:14:18
2025-03-09 07:14:18,540 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0011 secs
2025-03-09 07:14:18,540 [INFO]: 		-> Adding the vectors to the index 03/09/2025, 07:14:18
2025-03-09 07:14:18,540 [INFO]: The memory available for adding the vectors is 49.2GB(total available - used by the index)
2025-03-09 07:14:18,540 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/17 [00:00<?, ?it/s]  6%|▌         | 1/17 [00:00<00:01,  9.03it/s] 41%|████      | 7/17 [00:00<00:00, 34.81it/s] 71%|███████   | 12/17 [00:00<00:00, 39.39it/s] 94%|█████████▍| 16/17 [00:00<00:00, 37.95it/s]100%|██████████| 17/17 [00:03<00:00,  4.61it/s]
2025-03-09 07:14:22,227 [INFO]: 	Computing best hyperparameters for index knn.index 03/09/2025, 07:14:22
2025-03-09 07:15:00,920 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 38.6925 secs
2025-03-09 07:15:00,920 [INFO]: The best hyperparameters are: efSearch=198
2025-03-09 07:15:00,920 [INFO]: 	Compute fast metrics 03/09/2025, 07:15:00
  0%|          | 0/4 [00:00<?, ?it/s] 75%|███████▌  | 3/4 [00:00<00:00, 25.40it/s] 75%|███████▌  | 3/4 [00:00<00:00, 21.76it/s]
2025-03-09 07:15:14,101 [INFO]: 	>>> Finished "Compute fast metrics" in 13.1806 secs
2025-03-09 07:15:14,103 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 55.5637 secs
2025-03-09 07:15:14,104 [INFO]: {
2025-03-09 07:15:14,104 [INFO]: 	index_key: HNSW15
2025-03-09 07:15:14,104 [INFO]: 	index_param: efSearch=198
2025-03-09 07:15:14,104 [INFO]: 	index_path: knn.index
2025-03-09 07:15:14,104 [INFO]: 	size in bytes: 820619290
2025-03-09 07:15:14,104 [INFO]: 	avg_search_speed_ms: 9.653573513703428
2025-03-09 07:15:14,104 [INFO]: 	99p_search_speed_ms: 23.14762216992677
2025-03-09 07:15:14,104 [INFO]: 	reconstruction error %: 0.0
2025-03-09 07:15:14,104 [INFO]: 	nb vectors: 4171
2025-03-09 07:15:14,104 [INFO]: 	vectors dimension: 49152
2025-03-09 07:15:14,104 [INFO]: 	compression ratio: 0.9993086660197812
2025-03-09 07:15:14,104 [INFO]: }
2025-03-09 07:15:14,104 [INFO]: 	>>> Finished "Creating the index" in 55.5655 secs
2025-03-09 07:15:14,104 [INFO]: >>> Finished "Launching the whole pipeline" in 55.5919 secs
2025-03-09 07:15:14: [retrieval_preprocessing] calculating distances ...
2025-03-09 07:15:15: [retrieval_preprocessing] finished and saved retrieval indices for episode 67598 [episode count 4/20]
[retrieval_preprocessing] for episode 64021 [episode count 5/20], we have num_retrieval=np.int64(4108) num_query=np.int64(186)
2025-03-09 07:15:15,440 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-09 07:15:15,999 [INFO]: Launching the whole pipeline 03/09/2025, 07:15:15
2025-03-09 07:15:15,999 [INFO]: Reading total number of vectors and dimension 03/09/2025, 07:15:15
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1179.17it/s]
2025-03-09 07:15:16,030 [INFO]: There are 4108 embeddings of dim 49152
2025-03-09 07:15:16,031 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0315 secs
2025-03-09 07:15:16,031 [INFO]: 	Compute estimated construction time of the index 03/09/2025, 07:15:16
2025-03-09 07:15:16,031 [INFO]: 		-> Train: 16.7 minutes
2025-03-09 07:15:16,031 [INFO]: 		-> Add: 2.3 seconds
2025-03-09 07:15:16,031 [INFO]: 		Total: 16.7 minutes
2025-03-09 07:15:16,032 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0003 secs
2025-03-09 07:15:16,032 [INFO]: 	Checking that your have enough memory available to create the index 03/09/2025, 07:15:16
2025-03-09 07:15:16,032 [INFO]: 847.8MB of memory will be needed to build the index (more might be used if you have more)
2025-03-09 07:15:16,032 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0004 secs
2025-03-09 07:15:16,032 [INFO]: 	Selecting most promising index types given data characteristics 03/09/2025, 07:15:16
2025-03-09 07:15:16,032 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-09 07:15:16,032 [INFO]: 	Creating the index 03/09/2025, 07:15:16
2025-03-09 07:15:16,033 [INFO]: 		-> Instanciate the index HNSW15 03/09/2025, 07:15:16
2025-03-09 07:15:16,035 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0028 secs
2025-03-09 07:15:16,036 [INFO]: 		-> Adding the vectors to the index 03/09/2025, 07:15:16
2025-03-09 07:15:16,036 [INFO]: The memory available for adding the vectors is 49.2GB(total available - used by the index)
2025-03-09 07:15:16,036 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/17 [00:00<?, ?it/s] 18%|█▊        | 3/17 [00:00<00:00, 25.85it/s] 53%|█████▎    | 9/17 [00:00<00:00, 42.46it/s] 88%|████████▊ | 15/17 [00:00<00:00, 47.53it/s]100%|██████████| 17/17 [00:04<00:00,  4.24it/s]
2025-03-09 07:15:20,051 [INFO]: 	Computing best hyperparameters for index knn.index 03/09/2025, 07:15:20
2025-03-09 07:16:02,964 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 42.9124 secs
2025-03-09 07:16:02,965 [INFO]: The best hyperparameters are: efSearch=202
2025-03-09 07:16:02,965 [INFO]: 	Compute fast metrics 03/09/2025, 07:16:02
  0%|          | 0/4 [00:00<?, ?it/s] 50%|█████     | 2/4 [00:00<00:00, 19.08it/s] 75%|███████▌  | 3/4 [00:00<00:00, 18.29it/s]
2025-03-09 07:16:15,934 [INFO]: 	>>> Finished "Compute fast metrics" in 12.9691 secs
2025-03-09 07:16:15,936 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 59.9001 secs
2025-03-09 07:16:15,936 [INFO]: {
2025-03-09 07:16:15,936 [INFO]: 	index_key: HNSW15
2025-03-09 07:16:15,936 [INFO]: 	index_param: efSearch=202
2025-03-09 07:16:15,936 [INFO]: 	index_path: knn.index
2025-03-09 07:16:15,936 [INFO]: 	size in bytes: 808224430
2025-03-09 07:16:15,936 [INFO]: 	avg_search_speed_ms: 9.728223344959783
2025-03-09 07:16:15,936 [INFO]: 	99p_search_speed_ms: 23.106078957207504
2025-03-09 07:16:15,936 [INFO]: 	reconstruction error %: 0.0
2025-03-09 07:16:15,936 [INFO]: 	nb vectors: 4108
2025-03-09 07:16:15,936 [INFO]: 	vectors dimension: 49152
2025-03-09 07:16:15,936 [INFO]: 	compression ratio: 0.9993086499501135
2025-03-09 07:16:15,936 [INFO]: }
2025-03-09 07:16:15,936 [INFO]: 	>>> Finished "Creating the index" in 59.9038 secs
2025-03-09 07:16:15,936 [INFO]: >>> Finished "Launching the whole pipeline" in 59.9373 secs
2025-03-09 07:16:16: [retrieval_preprocessing] calculating distances ...
2025-03-09 07:16:17: [retrieval_preprocessing] finished and saved retrieval indices for episode 64021 [episode count 5/20]
[retrieval_preprocessing] for episode 82472 [episode count 6/20], we have num_retrieval=np.int64(4109) num_query=np.int64(185)
2025-03-09 07:16:17,728 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-09 07:16:18,260 [INFO]: Launching the whole pipeline 03/09/2025, 07:16:18
2025-03-09 07:16:18,261 [INFO]: Reading total number of vectors and dimension 03/09/2025, 07:16:18
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1356.06it/s]
2025-03-09 07:16:18,288 [INFO]: There are 4109 embeddings of dim 49152
2025-03-09 07:16:18,288 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0278 secs
2025-03-09 07:16:18,289 [INFO]: 	Compute estimated construction time of the index 03/09/2025, 07:16:18
2025-03-09 07:16:18,289 [INFO]: 		-> Train: 16.7 minutes
2025-03-09 07:16:18,289 [INFO]: 		-> Add: 2.3 seconds
2025-03-09 07:16:18,289 [INFO]: 		Total: 16.7 minutes
2025-03-09 07:16:18,289 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0003 secs
2025-03-09 07:16:18,289 [INFO]: 	Checking that your have enough memory available to create the index 03/09/2025, 07:16:18
2025-03-09 07:16:18,290 [INFO]: 848.0MB of memory will be needed to build the index (more might be used if you have more)
2025-03-09 07:16:18,290 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0005 secs
2025-03-09 07:16:18,290 [INFO]: 	Selecting most promising index types given data characteristics 03/09/2025, 07:16:18
2025-03-09 07:16:18,290 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-09 07:16:18,290 [INFO]: 	Creating the index 03/09/2025, 07:16:18
2025-03-09 07:16:18,291 [INFO]: 		-> Instanciate the index HNSW15 03/09/2025, 07:16:18
2025-03-09 07:16:18,294 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0029 secs
2025-03-09 07:16:18,294 [INFO]: 		-> Adding the vectors to the index 03/09/2025, 07:16:18
2025-03-09 07:16:18,294 [INFO]: The memory available for adding the vectors is 49.2GB(total available - used by the index)
2025-03-09 07:16:18,294 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/17 [00:00<?, ?it/s] 18%|█▊        | 3/17 [00:00<00:00, 25.83it/s] 53%|█████▎    | 9/17 [00:00<00:00, 42.08it/s] 88%|████████▊ | 15/17 [00:00<00:00, 47.46it/s]100%|██████████| 17/17 [00:03<00:00,  4.65it/s]
2025-03-09 07:16:21,956 [INFO]: 	Computing best hyperparameters for index knn.index 03/09/2025, 07:16:21
2025-03-09 07:17:07,668 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 45.7113 secs
2025-03-09 07:17:07,668 [INFO]: The best hyperparameters are: efSearch=186
2025-03-09 07:17:07,668 [INFO]: 	Compute fast metrics 03/09/2025, 07:17:07
  0%|          | 0/4 [00:00<?, ?it/s] 50%|█████     | 2/4 [00:00<00:00, 18.36it/s] 75%|███████▌  | 3/4 [00:00<00:00, 19.92it/s]
2025-03-09 07:17:20,092 [INFO]: 	>>> Finished "Compute fast metrics" in 12.4238 secs
2025-03-09 07:17:20,094 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 61.8001 secs
2025-03-09 07:17:20,094 [INFO]: {
2025-03-09 07:17:20,094 [INFO]: 	index_key: HNSW15
2025-03-09 07:17:20,094 [INFO]: 	index_param: efSearch=186
2025-03-09 07:17:20,094 [INFO]: 	index_path: knn.index
2025-03-09 07:17:20,094 [INFO]: 	size in bytes: 808421170
2025-03-09 07:17:20,094 [INFO]: 	avg_search_speed_ms: 9.422013531926174
2025-03-09 07:17:20,094 [INFO]: 	99p_search_speed_ms: 18.40803301893175
2025-03-09 07:17:20,094 [INFO]: 	reconstruction error %: 0.0
2025-03-09 07:17:20,094 [INFO]: 	nb vectors: 4109
2025-03-09 07:17:20,094 [INFO]: 	vectors dimension: 49152
2025-03-09 07:17:20,094 [INFO]: 	compression ratio: 0.9993086549180794
2025-03-09 07:17:20,094 [INFO]: }
2025-03-09 07:17:20,094 [INFO]: 	>>> Finished "Creating the index" in 61.8039 secs
2025-03-09 07:17:20,094 [INFO]: >>> Finished "Launching the whole pipeline" in 61.8338 secs
2025-03-09 07:17:20: [retrieval_preprocessing] calculating distances ...
2025-03-09 07:17:21: [retrieval_preprocessing] finished and saved retrieval indices for episode 82472 [episode count 6/20]
[retrieval_preprocessing] for episode 78378 [episode count 7/20], we have num_retrieval=np.int64(4052) num_query=np.int64(242)
2025-03-09 07:17:22,047 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-09 07:17:22,732 [INFO]: Launching the whole pipeline 03/09/2025, 07:17:22
2025-03-09 07:17:22,733 [INFO]: Reading total number of vectors and dimension 03/09/2025, 07:17:22
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1329.41it/s]
2025-03-09 07:17:22,763 [INFO]: There are 4052 embeddings of dim 49152
2025-03-09 07:17:22,763 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0303 secs
2025-03-09 07:17:22,763 [INFO]: 	Compute estimated construction time of the index 03/09/2025, 07:17:22
2025-03-09 07:17:22,763 [INFO]: 		-> Train: 16.7 minutes
2025-03-09 07:17:22,763 [INFO]: 		-> Add: 2.2 seconds
2025-03-09 07:17:22,763 [INFO]: 		Total: 16.7 minutes
2025-03-09 07:17:22,763 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0002 secs
2025-03-09 07:17:22,763 [INFO]: 	Checking that your have enough memory available to create the index 03/09/2025, 07:17:22
2025-03-09 07:17:22,763 [INFO]: 836.2MB of memory will be needed to build the index (more might be used if you have more)
2025-03-09 07:17:22,763 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0002 secs
2025-03-09 07:17:22,764 [INFO]: 	Selecting most promising index types given data characteristics 03/09/2025, 07:17:22
2025-03-09 07:17:22,764 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-09 07:17:22,764 [INFO]: 	Creating the index 03/09/2025, 07:17:22
2025-03-09 07:17:22,764 [INFO]: 		-> Instanciate the index HNSW15 03/09/2025, 07:17:22
2025-03-09 07:17:22,765 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0011 secs
2025-03-09 07:17:22,765 [INFO]: 		-> Adding the vectors to the index 03/09/2025, 07:17:22
2025-03-09 07:17:22,765 [INFO]: The memory available for adding the vectors is 49.3GB(total available - used by the index)
2025-03-09 07:17:22,765 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/16 [00:00<?, ?it/s]  6%|▋         | 1/16 [00:00<00:02,  7.28it/s] 38%|███▊      | 6/16 [00:00<00:00, 28.96it/s] 69%|██████▉   | 11/16 [00:00<00:00, 37.53it/s]100%|██████████| 16/16 [00:03<00:00,  3.36it/s]100%|██████████| 16/16 [00:03<00:00,  4.53it/s]
2025-03-09 07:17:26,301 [INFO]: 	Computing best hyperparameters for index knn.index 03/09/2025, 07:17:26
2025-03-09 07:18:04,275 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 37.9733 secs
2025-03-09 07:18:04,275 [INFO]: The best hyperparameters are: efSearch=220
2025-03-09 07:18:04,275 [INFO]: 	Compute fast metrics 03/09/2025, 07:18:04
  0%|          | 0/4 [00:00<?, ?it/s] 50%|█████     | 2/4 [00:00<00:00, 17.35it/s] 75%|███████▌  | 3/4 [00:00<00:00, 18.44it/s]
2025-03-09 07:18:19,360 [INFO]: 	>>> Finished "Compute fast metrics" in 15.0856 secs
2025-03-09 07:18:19,363 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 56.5976 secs
2025-03-09 07:18:19,363 [INFO]: {
2025-03-09 07:18:19,363 [INFO]: 	index_key: HNSW15
2025-03-09 07:18:19,363 [INFO]: 	index_param: efSearch=220
2025-03-09 07:18:19,363 [INFO]: 	index_path: knn.index
2025-03-09 07:18:19,363 [INFO]: 	size in bytes: 797206810
2025-03-09 07:18:19,363 [INFO]: 	avg_search_speed_ms: 10.69285497109159
2025-03-09 07:18:19,363 [INFO]: 	99p_search_speed_ms: 25.354469276499
2025-03-09 07:18:19,363 [INFO]: 	reconstruction error %: 0.0
2025-03-09 07:18:19,363 [INFO]: 	nb vectors: 4052
2025-03-09 07:18:19,363 [INFO]: 	vectors dimension: 49152
2025-03-09 07:18:19,363 [INFO]: 	compression ratio: 0.9993085934627176
2025-03-09 07:18:19,363 [INFO]: }
2025-03-09 07:18:19,363 [INFO]: 	>>> Finished "Creating the index" in 56.5992 secs
2025-03-09 07:18:19,363 [INFO]: >>> Finished "Launching the whole pipeline" in 56.6303 secs
2025-03-09 07:18:20: [retrieval_preprocessing] calculating distances ...
2025-03-09 07:18:21: [retrieval_preprocessing] finished and saved retrieval indices for episode 78378 [episode count 7/20]
[retrieval_preprocessing] for episode 20014 [episode count 8/20], we have num_retrieval=np.int64(4063) num_query=np.int64(231)
2025-03-09 07:18:21,372 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-09 07:18:22,005 [INFO]: Launching the whole pipeline 03/09/2025, 07:18:22
2025-03-09 07:18:22,005 [INFO]: Reading total number of vectors and dimension 03/09/2025, 07:18:22
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1791.67it/s]
2025-03-09 07:18:22,082 [INFO]: There are 4063 embeddings of dim 49152
2025-03-09 07:18:22,083 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0778 secs
2025-03-09 07:18:22,083 [INFO]: 	Compute estimated construction time of the index 03/09/2025, 07:18:22
2025-03-09 07:18:22,083 [INFO]: 		-> Train: 16.7 minutes
2025-03-09 07:18:22,083 [INFO]: 		-> Add: 2.2 seconds
2025-03-09 07:18:22,083 [INFO]: 		Total: 16.7 minutes
2025-03-09 07:18:22,083 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0002 secs
2025-03-09 07:18:22,083 [INFO]: 	Checking that your have enough memory available to create the index 03/09/2025, 07:18:22
2025-03-09 07:18:22,083 [INFO]: 838.5MB of memory will be needed to build the index (more might be used if you have more)
2025-03-09 07:18:22,084 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0003 secs
2025-03-09 07:18:22,084 [INFO]: 	Selecting most promising index types given data characteristics 03/09/2025, 07:18:22
2025-03-09 07:18:22,084 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-09 07:18:22,084 [INFO]: 	Creating the index 03/09/2025, 07:18:22
2025-03-09 07:18:22,084 [INFO]: 		-> Instanciate the index HNSW15 03/09/2025, 07:18:22
2025-03-09 07:18:22,086 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0020 secs
2025-03-09 07:18:22,086 [INFO]: 		-> Adding the vectors to the index 03/09/2025, 07:18:22
2025-03-09 07:18:22,086 [INFO]: The memory available for adding the vectors is 49.3GB(total available - used by the index)
2025-03-09 07:18:22,086 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/16 [00:00<?, ?it/s]  6%|▋         | 1/16 [00:00<00:01,  7.78it/s] 38%|███▊      | 6/16 [00:00<00:00, 28.04it/s] 69%|██████▉   | 11/16 [00:00<00:00, 35.25it/s]100%|██████████| 16/16 [00:03<00:00,  3.24it/s]100%|██████████| 16/16 [00:03<00:00,  4.37it/s]
2025-03-09 07:18:25,758 [INFO]: 	Computing best hyperparameters for index knn.index 03/09/2025, 07:18:25
2025-03-09 07:19:07,405 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 41.6466 secs
2025-03-09 07:19:07,405 [INFO]: The best hyperparameters are: efSearch=219
2025-03-09 07:19:07,405 [INFO]: 	Compute fast metrics 03/09/2025, 07:19:07
  0%|          | 0/4 [00:00<?, ?it/s] 50%|█████     | 2/4 [00:00<00:00, 18.52it/s] 75%|███████▌  | 3/4 [00:00<00:00, 19.94it/s]
2025-03-09 07:19:23,925 [INFO]: 	>>> Finished "Compute fast metrics" in 16.5195 secs
2025-03-09 07:19:23,928 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 61.8414 secs
2025-03-09 07:19:23,928 [INFO]: {
2025-03-09 07:19:23,928 [INFO]: 	index_key: HNSW15
2025-03-09 07:19:23,928 [INFO]: 	index_param: efSearch=219
2025-03-09 07:19:23,928 [INFO]: 	index_path: knn.index
2025-03-09 07:19:23,928 [INFO]: 	size in bytes: 799370950
2025-03-09 07:19:23,928 [INFO]: 	avg_search_speed_ms: 10.217094749442479
2025-03-09 07:19:23,928 [INFO]: 	99p_search_speed_ms: 23.77454850357027
2025-03-09 07:19:23,928 [INFO]: 	reconstruction error %: 0.0
2025-03-09 07:19:23,928 [INFO]: 	nb vectors: 4063
2025-03-09 07:19:23,928 [INFO]: 	vectors dimension: 49152
2025-03-09 07:19:23,928 [INFO]: 	compression ratio: 0.999308648881974
2025-03-09 07:19:23,928 [INFO]: }
2025-03-09 07:19:23,928 [INFO]: 	>>> Finished "Creating the index" in 61.8441 secs
2025-03-09 07:19:23,928 [INFO]: >>> Finished "Launching the whole pipeline" in 61.9231 secs
2025-03-09 07:19:25: [retrieval_preprocessing] calculating distances ...
2025-03-09 07:19:26: [retrieval_preprocessing] finished and saved retrieval indices for episode 20014 [episode count 8/20]
[retrieval_preprocessing] for episode 58417 [episode count 9/20], we have num_retrieval=np.int64(4036) num_query=np.int64(258)
2025-03-09 07:19:26,594 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-09 07:19:27,328 [INFO]: Launching the whole pipeline 03/09/2025, 07:19:27
2025-03-09 07:19:27,329 [INFO]: Reading total number of vectors and dimension 03/09/2025, 07:19:27
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1199.40it/s]
2025-03-09 07:19:27,363 [INFO]: There are 4036 embeddings of dim 49152
2025-03-09 07:19:27,363 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0344 secs
2025-03-09 07:19:27,363 [INFO]: 	Compute estimated construction time of the index 03/09/2025, 07:19:27
2025-03-09 07:19:27,364 [INFO]: 		-> Train: 16.7 minutes
2025-03-09 07:19:27,364 [INFO]: 		-> Add: 2.2 seconds
2025-03-09 07:19:27,364 [INFO]: 		Total: 16.7 minutes
2025-03-09 07:19:27,364 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0003 secs
2025-03-09 07:19:27,364 [INFO]: 	Checking that your have enough memory available to create the index 03/09/2025, 07:19:27
2025-03-09 07:19:27,364 [INFO]: 832.9MB of memory will be needed to build the index (more might be used if you have more)
2025-03-09 07:19:27,364 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0004 secs
2025-03-09 07:19:27,365 [INFO]: 	Selecting most promising index types given data characteristics 03/09/2025, 07:19:27
2025-03-09 07:19:27,365 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-09 07:19:27,365 [INFO]: 	Creating the index 03/09/2025, 07:19:27
2025-03-09 07:19:27,365 [INFO]: 		-> Instanciate the index HNSW15 03/09/2025, 07:19:27
2025-03-09 07:19:27,367 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0019 secs
2025-03-09 07:19:27,367 [INFO]: 		-> Adding the vectors to the index 03/09/2025, 07:19:27
2025-03-09 07:19:27,368 [INFO]: The memory available for adding the vectors is 49.3GB(total available - used by the index)
2025-03-09 07:19:27,368 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/16 [00:00<?, ?it/s]  6%|▋         | 1/16 [00:00<00:02,  6.79it/s] 25%|██▌       | 4/16 [00:00<00:00, 16.86it/s] 50%|█████     | 8/16 [00:00<00:00, 25.81it/s] 75%|███████▌  | 12/16 [00:00<00:00, 30.89it/s]100%|██████████| 16/16 [00:03<00:00,  2.85it/s]100%|██████████| 16/16 [00:03<00:00,  4.22it/s]
2025-03-09 07:19:31,169 [INFO]: 	Computing best hyperparameters for index knn.index 03/09/2025, 07:19:31
2025-03-09 07:20:21,095 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 49.9258 secs
2025-03-09 07:20:21,095 [INFO]: The best hyperparameters are: efSearch=177
2025-03-09 07:20:21,096 [INFO]: 	Compute fast metrics 03/09/2025, 07:20:21
  0%|          | 0/4 [00:00<?, ?it/s] 75%|███████▌  | 3/4 [00:00<00:00, 25.84it/s] 75%|███████▌  | 3/4 [00:00<00:00, 21.88it/s]
2025-03-09 07:20:33,611 [INFO]: 	>>> Finished "Compute fast metrics" in 12.5152 secs
2025-03-09 07:20:33,613 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 66.2455 secs
2025-03-09 07:20:33,613 [INFO]: {
2025-03-09 07:20:33,613 [INFO]: 	index_key: HNSW15
2025-03-09 07:20:33,613 [INFO]: 	index_param: efSearch=177
2025-03-09 07:20:33,613 [INFO]: 	index_path: knn.index
2025-03-09 07:20:33,613 [INFO]: 	size in bytes: 794058910
2025-03-09 07:20:33,613 [INFO]: 	avg_search_speed_ms: 8.943387491950075
2025-03-09 07:20:33,613 [INFO]: 	99p_search_speed_ms: 16.99033522978425
2025-03-09 07:20:33,613 [INFO]: 	reconstruction error %: 0.0
2025-03-09 07:20:33,613 [INFO]: 	nb vectors: 4036
2025-03-09 07:20:33,614 [INFO]: 	vectors dimension: 49152
2025-03-09 07:20:33,614 [INFO]: 	compression ratio: 0.9993085878225332
2025-03-09 07:20:33,614 [INFO]: }
2025-03-09 07:20:33,614 [INFO]: 	>>> Finished "Creating the index" in 66.2487 secs
2025-03-09 07:20:33,614 [INFO]: >>> Finished "Launching the whole pipeline" in 66.2850 secs
2025-03-09 07:20:34: [retrieval_preprocessing] calculating distances ...
2025-03-09 07:20:35: [retrieval_preprocessing] finished and saved retrieval indices for episode 58417 [episode count 9/20]
[retrieval_preprocessing] for episode 2615 [episode count 10/20], we have num_retrieval=np.int64(4118) num_query=np.int64(176)
2025-03-09 07:20:35,843 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-09 07:20:36,402 [INFO]: Launching the whole pipeline 03/09/2025, 07:20:36
2025-03-09 07:20:36,402 [INFO]: Reading total number of vectors and dimension 03/09/2025, 07:20:36
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1117.88it/s]
2025-03-09 07:20:36,427 [INFO]: There are 4118 embeddings of dim 49152
2025-03-09 07:20:36,427 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0253 secs
2025-03-09 07:20:36,428 [INFO]: 	Compute estimated construction time of the index 03/09/2025, 07:20:36
2025-03-09 07:20:36,428 [INFO]: 		-> Train: 16.7 minutes
2025-03-09 07:20:36,428 [INFO]: 		-> Add: 2.3 seconds
2025-03-09 07:20:36,428 [INFO]: 		Total: 16.7 minutes
2025-03-09 07:20:36,428 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0001 secs
2025-03-09 07:20:36,428 [INFO]: 	Checking that your have enough memory available to create the index 03/09/2025, 07:20:36
2025-03-09 07:20:36,428 [INFO]: 849.9MB of memory will be needed to build the index (more might be used if you have more)
2025-03-09 07:20:36,428 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0001 secs
2025-03-09 07:20:36,428 [INFO]: 	Selecting most promising index types given data characteristics 03/09/2025, 07:20:36
2025-03-09 07:20:36,428 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-09 07:20:36,428 [INFO]: 	Creating the index 03/09/2025, 07:20:36
2025-03-09 07:20:36,428 [INFO]: 		-> Instanciate the index HNSW15 03/09/2025, 07:20:36
2025-03-09 07:20:36,429 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0010 secs
2025-03-09 07:20:36,429 [INFO]: 		-> Adding the vectors to the index 03/09/2025, 07:20:36
2025-03-09 07:20:36,429 [INFO]: The memory available for adding the vectors is 49.2GB(total available - used by the index)
2025-03-09 07:20:36,429 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/17 [00:00<?, ?it/s]  6%|▌         | 1/17 [00:00<00:02,  7.76it/s] 41%|████      | 7/17 [00:00<00:00, 31.91it/s] 76%|███████▋  | 13/17 [00:00<00:00, 36.57it/s]100%|██████████| 17/17 [00:03<00:00,  3.62it/s]100%|██████████| 17/17 [00:03<00:00,  5.06it/s]
2025-03-09 07:20:39,794 [INFO]: 	Computing best hyperparameters for index knn.index 03/09/2025, 07:20:39
2025-03-09 07:21:21,531 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 41.7360 secs
2025-03-09 07:21:21,531 [INFO]: The best hyperparameters are: efSearch=207
2025-03-09 07:21:21,531 [INFO]: 	Compute fast metrics 03/09/2025, 07:21:21
  0%|          | 0/4 [00:00<?, ?it/s] 50%|█████     | 2/4 [00:00<00:00, 18.35it/s] 75%|███████▌  | 3/4 [00:00<00:00, 19.46it/s]
2025-03-09 07:21:34,919 [INFO]: 	>>> Finished "Compute fast metrics" in 13.3882 secs
2025-03-09 07:21:34,922 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 58.4930 secs
2025-03-09 07:21:34,922 [INFO]: {
2025-03-09 07:21:34,922 [INFO]: 	index_key: HNSW15
2025-03-09 07:21:34,922 [INFO]: 	index_param: efSearch=207
2025-03-09 07:21:34,922 [INFO]: 	index_path: knn.index
2025-03-09 07:21:34,922 [INFO]: 	size in bytes: 810191890
2025-03-09 07:21:34,922 [INFO]: 	avg_search_speed_ms: 10.246990928684026
2025-03-09 07:21:34,922 [INFO]: 	99p_search_speed_ms: 20.480953971855342
2025-03-09 07:21:34,922 [INFO]: 	reconstruction error %: 0.0
2025-03-09 07:21:34,922 [INFO]: 	nb vectors: 4118
2025-03-09 07:21:34,922 [INFO]: 	vectors dimension: 49152
2025-03-09 07:21:34,922 [INFO]: 	compression ratio: 0.9993086255158639
2025-03-09 07:21:34,922 [INFO]: }
2025-03-09 07:21:34,922 [INFO]: 	>>> Finished "Creating the index" in 58.4945 secs
2025-03-09 07:21:34,922 [INFO]: >>> Finished "Launching the whole pipeline" in 58.5203 secs
2025-03-09 07:21:36: [retrieval_preprocessing] calculating distances ...
2025-03-09 07:21:36: [retrieval_preprocessing] finished and saved retrieval indices for episode 2615 [episode count 10/20]
[retrieval_preprocessing] for episode 19002 [episode count 11/20], we have num_retrieval=np.int64(4100) num_query=np.int64(194)
2025-03-09 07:21:36,996 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-09 07:21:37,542 [INFO]: Launching the whole pipeline 03/09/2025, 07:21:37
2025-03-09 07:21:37,542 [INFO]: Reading total number of vectors and dimension 03/09/2025, 07:21:37
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1811.01it/s]
2025-03-09 07:21:37,569 [INFO]: There are 4100 embeddings of dim 49152
2025-03-09 07:21:37,569 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0270 secs
2025-03-09 07:21:37,569 [INFO]: 	Compute estimated construction time of the index 03/09/2025, 07:21:37
2025-03-09 07:21:37,569 [INFO]: 		-> Train: 16.7 minutes
2025-03-09 07:21:37,569 [INFO]: 		-> Add: 2.3 seconds
2025-03-09 07:21:37,569 [INFO]: 		Total: 16.7 minutes
2025-03-09 07:21:37,569 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0001 secs
2025-03-09 07:21:37,569 [INFO]: 	Checking that your have enough memory available to create the index 03/09/2025, 07:21:37
2025-03-09 07:21:37,569 [INFO]: 846.1MB of memory will be needed to build the index (more might be used if you have more)
2025-03-09 07:21:37,569 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0001 secs
2025-03-09 07:21:37,569 [INFO]: 	Selecting most promising index types given data characteristics 03/09/2025, 07:21:37
2025-03-09 07:21:37,569 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-09 07:21:37,569 [INFO]: 	Creating the index 03/09/2025, 07:21:37
2025-03-09 07:21:37,569 [INFO]: 		-> Instanciate the index HNSW15 03/09/2025, 07:21:37
2025-03-09 07:21:37,570 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0009 secs
2025-03-09 07:21:37,570 [INFO]: 		-> Adding the vectors to the index 03/09/2025, 07:21:37
2025-03-09 07:21:37,570 [INFO]: The memory available for adding the vectors is 49.2GB(total available - used by the index)
2025-03-09 07:21:37,571 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/17 [00:00<?, ?it/s]  6%|▌         | 1/17 [00:00<00:01,  9.38it/s] 35%|███▌      | 6/17 [00:00<00:00, 31.79it/s] 65%|██████▍   | 11/17 [00:00<00:00, 39.38it/s] 94%|█████████▍| 16/17 [00:00<00:00, 40.20it/s]100%|██████████| 17/17 [00:03<00:00,  5.19it/s]
2025-03-09 07:21:40,847 [INFO]: 	Computing best hyperparameters for index knn.index 03/09/2025, 07:21:40
2025-03-09 07:22:25,799 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 44.9515 secs
2025-03-09 07:22:25,800 [INFO]: The best hyperparameters are: efSearch=195
2025-03-09 07:22:25,800 [INFO]: 	Compute fast metrics 03/09/2025, 07:22:25
  0%|          | 0/4 [00:00<?, ?it/s] 50%|█████     | 2/4 [00:00<00:00, 19.21it/s] 75%|███████▌  | 3/4 [00:00<00:00, 21.41it/s]
2025-03-09 07:22:38,015 [INFO]: 	>>> Finished "Compute fast metrics" in 12.2149 secs
2025-03-09 07:22:38,017 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 60.4465 secs
2025-03-09 07:22:38,017 [INFO]: {
2025-03-09 07:22:38,017 [INFO]: 	index_key: HNSW15
2025-03-09 07:22:38,017 [INFO]: 	index_param: efSearch=195
2025-03-09 07:22:38,017 [INFO]: 	index_path: knn.index
2025-03-09 07:22:38,017 [INFO]: 	size in bytes: 806650450
2025-03-09 07:22:38,017 [INFO]: 	avg_search_speed_ms: 8.863283767331097
2025-03-09 07:22:38,017 [INFO]: 	99p_search_speed_ms: 18.268411261960875
2025-03-09 07:22:38,017 [INFO]: 	reconstruction error %: 0.0
2025-03-09 07:22:38,017 [INFO]: 	nb vectors: 4100
2025-03-09 07:22:38,017 [INFO]: 	vectors dimension: 49152
2025-03-09 07:22:38,017 [INFO]: 	compression ratio: 0.9993086844493795
2025-03-09 07:22:38,017 [INFO]: }
2025-03-09 07:22:38,017 [INFO]: 	>>> Finished "Creating the index" in 60.4479 secs
2025-03-09 07:22:38,017 [INFO]: >>> Finished "Launching the whole pipeline" in 60.4754 secs
2025-03-09 07:22:38: [retrieval_preprocessing] calculating distances ...
2025-03-09 07:22:39: [retrieval_preprocessing] finished and saved retrieval indices for episode 19002 [episode count 11/20]
[retrieval_preprocessing] for episode 69691 [episode count 12/20], we have num_retrieval=np.int64(4117) num_query=np.int64(177)
2025-03-09 07:22:39,805 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-09 07:22:40,426 [INFO]: Launching the whole pipeline 03/09/2025, 07:22:40
2025-03-09 07:22:40,426 [INFO]: Reading total number of vectors and dimension 03/09/2025, 07:22:40
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 972.93it/s]
2025-03-09 07:22:40,456 [INFO]: There are 4117 embeddings of dim 49152
2025-03-09 07:22:40,456 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0302 secs
2025-03-09 07:22:40,456 [INFO]: 	Compute estimated construction time of the index 03/09/2025, 07:22:40
2025-03-09 07:22:40,457 [INFO]: 		-> Train: 16.7 minutes
2025-03-09 07:22:40,457 [INFO]: 		-> Add: 2.3 seconds
2025-03-09 07:22:40,457 [INFO]: 		Total: 16.7 minutes
2025-03-09 07:22:40,457 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0003 secs
2025-03-09 07:22:40,457 [INFO]: 	Checking that your have enough memory available to create the index 03/09/2025, 07:22:40
2025-03-09 07:22:40,457 [INFO]: 849.6MB of memory will be needed to build the index (more might be used if you have more)
2025-03-09 07:22:40,457 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0005 secs
2025-03-09 07:22:40,458 [INFO]: 	Selecting most promising index types given data characteristics 03/09/2025, 07:22:40
2025-03-09 07:22:40,458 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-09 07:22:40,458 [INFO]: 	Creating the index 03/09/2025, 07:22:40
2025-03-09 07:22:40,458 [INFO]: 		-> Instanciate the index HNSW15 03/09/2025, 07:22:40
2025-03-09 07:22:40,461 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0027 secs
2025-03-09 07:22:40,461 [INFO]: 		-> Adding the vectors to the index 03/09/2025, 07:22:40
2025-03-09 07:22:40,461 [INFO]: The memory available for adding the vectors is 49.2GB(total available - used by the index)
2025-03-09 07:22:40,461 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/17 [00:00<?, ?it/s] 12%|█▏        | 2/17 [00:00<00:00, 16.58it/s] 41%|████      | 7/17 [00:00<00:00, 27.43it/s] 71%|███████   | 12/17 [00:00<00:00, 33.12it/s]100%|██████████| 17/17 [00:03<00:00,  3.14it/s]100%|██████████| 17/17 [00:03<00:00,  4.36it/s]
2025-03-09 07:22:44,370 [INFO]: 	Computing best hyperparameters for index knn.index 03/09/2025, 07:22:44
2025-03-09 07:23:29,031 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 44.6601 secs
2025-03-09 07:23:29,031 [INFO]: The best hyperparameters are: efSearch=206
2025-03-09 07:23:29,031 [INFO]: 	Compute fast metrics 03/09/2025, 07:23:29
  0%|          | 0/4 [00:00<?, ?it/s] 25%|██▌       | 1/4 [00:00<00:00,  8.03it/s] 75%|███████▌  | 3/4 [00:00<00:00, 16.35it/s]
2025-03-09 07:23:42,859 [INFO]: 	>>> Finished "Compute fast metrics" in 13.8282 secs
2025-03-09 07:23:42,862 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 62.4008 secs
2025-03-09 07:23:42,862 [INFO]: {
2025-03-09 07:23:42,862 [INFO]: 	index_key: HNSW15
2025-03-09 07:23:42,862 [INFO]: 	index_param: efSearch=206
2025-03-09 07:23:42,862 [INFO]: 	index_path: knn.index
2025-03-09 07:23:42,862 [INFO]: 	size in bytes: 809995150
2025-03-09 07:23:42,862 [INFO]: 	avg_search_speed_ms: 9.799849295333743
2025-03-09 07:23:42,862 [INFO]: 	99p_search_speed_ms: 20.764779346063705
2025-03-09 07:23:42,862 [INFO]: 	reconstruction error %: 0.0
2025-03-09 07:23:42,862 [INFO]: 	nb vectors: 4117
2025-03-09 07:23:42,862 [INFO]: 	vectors dimension: 49152
2025-03-09 07:23:42,862 [INFO]: 	compression ratio: 0.9993086205516168
2025-03-09 07:23:42,862 [INFO]: }
2025-03-09 07:23:42,862 [INFO]: 	>>> Finished "Creating the index" in 62.4043 secs
2025-03-09 07:23:42,862 [INFO]: >>> Finished "Launching the whole pipeline" in 62.4362 secs
2025-03-09 07:23:43: [retrieval_preprocessing] calculating distances ...
2025-03-09 07:23:44: [retrieval_preprocessing] finished and saved retrieval indices for episode 69691 [episode count 12/20]
[retrieval_preprocessing] for episode 20546 [episode count 13/20], we have num_retrieval=np.int64(4004) num_query=np.int64(290)
2025-03-09 07:23:44,909 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-09 07:23:45,499 [INFO]: Launching the whole pipeline 03/09/2025, 07:23:45
2025-03-09 07:23:45,499 [INFO]: Reading total number of vectors and dimension 03/09/2025, 07:23:45
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 2089.84it/s]
2025-03-09 07:23:45,527 [INFO]: There are 4004 embeddings of dim 49152
2025-03-09 07:23:45,527 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0282 secs
2025-03-09 07:23:45,527 [INFO]: 	Compute estimated construction time of the index 03/09/2025, 07:23:45
2025-03-09 07:23:45,527 [INFO]: 		-> Train: 16.7 minutes
2025-03-09 07:23:45,527 [INFO]: 		-> Add: 2.2 seconds
2025-03-09 07:23:45,527 [INFO]: 		Total: 16.7 minutes
2025-03-09 07:23:45,527 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0001 secs
2025-03-09 07:23:45,527 [INFO]: 	Checking that your have enough memory available to create the index 03/09/2025, 07:23:45
2025-03-09 07:23:45,528 [INFO]: 826.3MB of memory will be needed to build the index (more might be used if you have more)
2025-03-09 07:23:45,528 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0001 secs
2025-03-09 07:23:45,528 [INFO]: 	Selecting most promising index types given data characteristics 03/09/2025, 07:23:45
2025-03-09 07:23:45,528 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-09 07:23:45,528 [INFO]: 	Creating the index 03/09/2025, 07:23:45
2025-03-09 07:23:45,528 [INFO]: 		-> Instanciate the index HNSW15 03/09/2025, 07:23:45
2025-03-09 07:23:45,529 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0009 secs
2025-03-09 07:23:45,529 [INFO]: 		-> Adding the vectors to the index 03/09/2025, 07:23:45
2025-03-09 07:23:45,529 [INFO]: The memory available for adding the vectors is 49.3GB(total available - used by the index)
2025-03-09 07:23:45,529 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/16 [00:00<?, ?it/s]  6%|▋         | 1/16 [00:00<00:01,  9.45it/s] 44%|████▍     | 7/16 [00:00<00:00, 34.54it/s] 75%|███████▌  | 12/16 [00:00<00:00, 40.81it/s]100%|██████████| 16/16 [00:03<00:00,  4.11it/s]
2025-03-09 07:23:49,429 [INFO]: 	Computing best hyperparameters for index knn.index 03/09/2025, 07:23:49
2025-03-09 07:24:31,280 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 41.8504 secs
2025-03-09 07:24:31,282 [INFO]: The best hyperparameters are: efSearch=182
2025-03-09 07:24:31,282 [INFO]: 	Compute fast metrics 03/09/2025, 07:24:31
  0%|          | 0/4 [00:00<?, ?it/s] 50%|█████     | 2/4 [00:00<00:00, 18.64it/s] 75%|███████▌  | 3/4 [00:00<00:00, 20.02it/s]
2025-03-09 07:24:43,926 [INFO]: 	>>> Finished "Compute fast metrics" in 12.6441 secs
2025-03-09 07:24:43,928 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 58.3996 secs
2025-03-09 07:24:43,929 [INFO]: {
2025-03-09 07:24:43,929 [INFO]: 	index_key: HNSW15
2025-03-09 07:24:43,929 [INFO]: 	index_param: efSearch=182
2025-03-09 07:24:43,929 [INFO]: 	index_path: knn.index
2025-03-09 07:24:43,929 [INFO]: 	size in bytes: 787763110
2025-03-09 07:24:43,929 [INFO]: 	avg_search_speed_ms: 9.646516848982401
2025-03-09 07:24:43,929 [INFO]: 	99p_search_speed_ms: 20.502176731824907
2025-03-09 07:24:43,929 [INFO]: 	reconstruction error %: 0.0
2025-03-09 07:24:43,929 [INFO]: 	nb vectors: 4004
2025-03-09 07:24:43,929 [INFO]: 	vectors dimension: 49152
2025-03-09 07:24:43,929 [INFO]: 	compression ratio: 0.9993085764069354
2025-03-09 07:24:43,929 [INFO]: }
2025-03-09 07:24:43,929 [INFO]: 	>>> Finished "Creating the index" in 58.4010 secs
2025-03-09 07:24:43,929 [INFO]: >>> Finished "Launching the whole pipeline" in 58.4297 secs
2025-03-09 07:24:44: [retrieval_preprocessing] calculating distances ...
2025-03-09 07:24:45: [retrieval_preprocessing] finished and saved retrieval indices for episode 20546 [episode count 13/20]
[retrieval_preprocessing] for episode 37961 [episode count 14/20], we have num_retrieval=np.int64(4154) num_query=np.int64(140)
2025-03-09 07:24:46,211 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-09 07:24:46,894 [INFO]: Launching the whole pipeline 03/09/2025, 07:24:46
2025-03-09 07:24:46,895 [INFO]: Reading total number of vectors and dimension 03/09/2025, 07:24:46
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1140.69it/s]
2025-03-09 07:24:46,921 [INFO]: There are 4154 embeddings of dim 49152
2025-03-09 07:24:46,921 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0266 secs
2025-03-09 07:24:46,921 [INFO]: 	Compute estimated construction time of the index 03/09/2025, 07:24:46
2025-03-09 07:24:46,921 [INFO]: 		-> Train: 16.7 minutes
2025-03-09 07:24:46,921 [INFO]: 		-> Add: 2.3 seconds
2025-03-09 07:24:46,921 [INFO]: 		Total: 16.7 minutes
2025-03-09 07:24:46,921 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0001 secs
2025-03-09 07:24:46,921 [INFO]: 	Checking that your have enough memory available to create the index 03/09/2025, 07:24:46
2025-03-09 07:24:46,921 [INFO]: 857.3MB of memory will be needed to build the index (more might be used if you have more)
2025-03-09 07:24:46,922 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0001 secs
2025-03-09 07:24:46,922 [INFO]: 	Selecting most promising index types given data characteristics 03/09/2025, 07:24:46
2025-03-09 07:24:46,922 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-09 07:24:46,922 [INFO]: 	Creating the index 03/09/2025, 07:24:46
2025-03-09 07:24:46,922 [INFO]: 		-> Instanciate the index HNSW15 03/09/2025, 07:24:46
2025-03-09 07:24:46,923 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0010 secs
2025-03-09 07:24:46,923 [INFO]: 		-> Adding the vectors to the index 03/09/2025, 07:24:46
2025-03-09 07:24:46,923 [INFO]: The memory available for adding the vectors is 49.2GB(total available - used by the index)
2025-03-09 07:24:46,923 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/17 [00:00<?, ?it/s]  6%|▌         | 1/17 [00:00<00:02,  7.28it/s] 35%|███▌      | 6/17 [00:00<00:00, 27.36it/s] 65%|██████▍   | 11/17 [00:00<00:00, 35.37it/s] 94%|█████████▍| 16/17 [00:00<00:00, 38.89it/s]100%|██████████| 17/17 [00:03<00:00,  5.36it/s]
2025-03-09 07:24:50,097 [INFO]: 	Computing best hyperparameters for index knn.index 03/09/2025, 07:24:50
2025-03-09 07:25:31,774 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 41.6765 secs
2025-03-09 07:25:31,774 [INFO]: The best hyperparameters are: efSearch=230
2025-03-09 07:25:31,774 [INFO]: 	Compute fast metrics 03/09/2025, 07:25:31
  0%|          | 0/4 [00:00<?, ?it/s] 75%|███████▌  | 3/4 [00:00<00:00, 25.36it/s] 75%|███████▌  | 3/4 [00:00<00:00, 21.72it/s]
2025-03-09 07:25:47,509 [INFO]: 	>>> Finished "Compute fast metrics" in 15.7347 secs
2025-03-09 07:25:47,512 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 60.5893 secs
2025-03-09 07:25:47,512 [INFO]: {
2025-03-09 07:25:47,512 [INFO]: 	index_key: HNSW15
2025-03-09 07:25:47,512 [INFO]: 	index_param: efSearch=230
2025-03-09 07:25:47,512 [INFO]: 	index_path: knn.index
2025-03-09 07:25:47,512 [INFO]: 	size in bytes: 817274590
2025-03-09 07:25:47,512 [INFO]: 	avg_search_speed_ms: 11.271666531159484
2025-03-09 07:25:47,512 [INFO]: 	99p_search_speed_ms: 25.789091996848583
2025-03-09 07:25:47,512 [INFO]: 	reconstruction error %: 0.0
2025-03-09 07:25:47,512 [INFO]: 	nb vectors: 4154
2025-03-09 07:25:47,513 [INFO]: 	vectors dimension: 49152
2025-03-09 07:25:47,513 [INFO]: 	compression ratio: 0.9993087292729852
2025-03-09 07:25:47,513 [INFO]: }
2025-03-09 07:25:47,513 [INFO]: 	>>> Finished "Creating the index" in 60.5909 secs
2025-03-09 07:25:47,513 [INFO]: >>> Finished "Launching the whole pipeline" in 60.6180 secs
2025-03-09 07:25:48: [retrieval_preprocessing] calculating distances ...
2025-03-09 07:25:49: [retrieval_preprocessing] finished and saved retrieval indices for episode 37961 [episode count 14/20]
[retrieval_preprocessing] for episode 47689 [episode count 15/20], we have num_retrieval=np.int64(4109) num_query=np.int64(185)
2025-03-09 07:25:49,875 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-09 07:25:50,474 [INFO]: Launching the whole pipeline 03/09/2025, 07:25:50
2025-03-09 07:25:50,474 [INFO]: Reading total number of vectors and dimension 03/09/2025, 07:25:50
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 2406.37it/s]
2025-03-09 07:25:50,503 [INFO]: There are 4109 embeddings of dim 49152
2025-03-09 07:25:50,503 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0285 secs
2025-03-09 07:25:50,503 [INFO]: 	Compute estimated construction time of the index 03/09/2025, 07:25:50
2025-03-09 07:25:50,503 [INFO]: 		-> Train: 16.7 minutes
2025-03-09 07:25:50,503 [INFO]: 		-> Add: 2.3 seconds
2025-03-09 07:25:50,503 [INFO]: 		Total: 16.7 minutes
2025-03-09 07:25:50,503 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0001 secs
2025-03-09 07:25:50,503 [INFO]: 	Checking that your have enough memory available to create the index 03/09/2025, 07:25:50
2025-03-09 07:25:50,503 [INFO]: 848.0MB of memory will be needed to build the index (more might be used if you have more)
2025-03-09 07:25:50,503 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0001 secs
2025-03-09 07:25:50,503 [INFO]: 	Selecting most promising index types given data characteristics 03/09/2025, 07:25:50
2025-03-09 07:25:50,503 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-09 07:25:50,503 [INFO]: 	Creating the index 03/09/2025, 07:25:50
2025-03-09 07:25:50,503 [INFO]: 		-> Instanciate the index HNSW15 03/09/2025, 07:25:50
2025-03-09 07:25:50,504 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0009 secs
2025-03-09 07:25:50,504 [INFO]: 		-> Adding the vectors to the index 03/09/2025, 07:25:50
2025-03-09 07:25:50,504 [INFO]: The memory available for adding the vectors is 49.2GB(total available - used by the index)
2025-03-09 07:25:50,504 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/17 [00:00<?, ?it/s]  6%|▌         | 1/17 [00:00<00:01,  8.81it/s] 35%|███▌      | 6/17 [00:00<00:00, 30.07it/s] 65%|██████▍   | 11/17 [00:00<00:00, 38.40it/s] 88%|████████▊ | 15/17 [00:00<00:00, 37.37it/s]100%|██████████| 17/17 [00:03<00:00,  4.47it/s]
2025-03-09 07:25:54,313 [INFO]: 	Computing best hyperparameters for index knn.index 03/09/2025, 07:25:54
2025-03-09 07:26:39,225 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 44.9115 secs
2025-03-09 07:26:39,225 [INFO]: The best hyperparameters are: efSearch=198
2025-03-09 07:26:39,225 [INFO]: 	Compute fast metrics 03/09/2025, 07:26:39
  0%|          | 0/4 [00:00<?, ?it/s] 50%|█████     | 2/4 [00:00<00:00, 13.45it/s] 75%|███████▌  | 3/4 [00:00<00:00, 15.89it/s]
2025-03-09 07:26:52,531 [INFO]: 	>>> Finished "Compute fast metrics" in 13.3058 secs
2025-03-09 07:26:52,533 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 62.0288 secs
2025-03-09 07:26:52,533 [INFO]: {
2025-03-09 07:26:52,533 [INFO]: 	index_key: HNSW15
2025-03-09 07:26:52,533 [INFO]: 	index_param: efSearch=198
2025-03-09 07:26:52,533 [INFO]: 	index_path: knn.index
2025-03-09 07:26:52,533 [INFO]: 	size in bytes: 808421170
2025-03-09 07:26:52,533 [INFO]: 	avg_search_speed_ms: 9.83597300027283
2025-03-09 07:26:52,533 [INFO]: 	99p_search_speed_ms: 23.63704712828623
2025-03-09 07:26:52,533 [INFO]: 	reconstruction error %: 0.0
2025-03-09 07:26:52,533 [INFO]: 	nb vectors: 4109
2025-03-09 07:26:52,533 [INFO]: 	vectors dimension: 49152
2025-03-09 07:26:52,533 [INFO]: 	compression ratio: 0.9993086549180794
2025-03-09 07:26:52,533 [INFO]: }
2025-03-09 07:26:52,533 [INFO]: 	>>> Finished "Creating the index" in 62.0302 secs
2025-03-09 07:26:52,533 [INFO]: >>> Finished "Launching the whole pipeline" in 62.0593 secs
2025-03-09 07:26:53: [retrieval_preprocessing] calculating distances ...
2025-03-09 07:26:54: [retrieval_preprocessing] finished and saved retrieval indices for episode 47689 [episode count 15/20]
[retrieval_preprocessing] for episode 64073 [episode count 16/20], we have num_retrieval=np.int64(4141) num_query=np.int64(153)
2025-03-09 07:26:54,535 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-09 07:26:55,318 [INFO]: Launching the whole pipeline 03/09/2025, 07:26:55
2025-03-09 07:26:55,318 [INFO]: Reading total number of vectors and dimension 03/09/2025, 07:26:55
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1279.14it/s]
2025-03-09 07:26:55,342 [INFO]: There are 4141 embeddings of dim 49152
2025-03-09 07:26:55,342 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0247 secs
2025-03-09 07:26:55,343 [INFO]: 	Compute estimated construction time of the index 03/09/2025, 07:26:55
2025-03-09 07:26:55,343 [INFO]: 		-> Train: 16.7 minutes
2025-03-09 07:26:55,343 [INFO]: 		-> Add: 2.3 seconds
2025-03-09 07:26:55,343 [INFO]: 		Total: 16.7 minutes
2025-03-09 07:26:55,343 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0001 secs
2025-03-09 07:26:55,343 [INFO]: 	Checking that your have enough memory available to create the index 03/09/2025, 07:26:55
2025-03-09 07:26:55,343 [INFO]: 854.6MB of memory will be needed to build the index (more might be used if you have more)
2025-03-09 07:26:55,343 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0002 secs
2025-03-09 07:26:55,343 [INFO]: 	Selecting most promising index types given data characteristics 03/09/2025, 07:26:55
2025-03-09 07:26:55,343 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-09 07:26:55,343 [INFO]: 	Creating the index 03/09/2025, 07:26:55
2025-03-09 07:26:55,343 [INFO]: 		-> Instanciate the index HNSW15 03/09/2025, 07:26:55
2025-03-09 07:26:55,344 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0010 secs
2025-03-09 07:26:55,344 [INFO]: 		-> Adding the vectors to the index 03/09/2025, 07:26:55
2025-03-09 07:26:55,344 [INFO]: The memory available for adding the vectors is 49.2GB(total available - used by the index)
2025-03-09 07:26:55,344 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/17 [00:00<?, ?it/s]  6%|▌         | 1/17 [00:00<00:01,  8.16it/s] 35%|███▌      | 6/17 [00:00<00:00, 28.94it/s] 65%|██████▍   | 11/17 [00:00<00:00, 31.60it/s] 94%|█████████▍| 16/17 [00:00<00:00, 36.33it/s]100%|██████████| 17/17 [00:03<00:00,  4.67it/s]
2025-03-09 07:26:58,992 [INFO]: 	Computing best hyperparameters for index knn.index 03/09/2025, 07:26:58
2025-03-09 07:27:45,600 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 46.6071 secs
2025-03-09 07:27:45,600 [INFO]: The best hyperparameters are: efSearch=198
2025-03-09 07:27:45,600 [INFO]: 	Compute fast metrics 03/09/2025, 07:27:45
  0%|          | 0/4 [00:00<?, ?it/s] 50%|█████     | 2/4 [00:00<00:00, 18.57it/s] 75%|███████▌  | 3/4 [00:00<00:00, 19.57it/s]
2025-03-09 07:27:57,758 [INFO]: 	>>> Finished "Compute fast metrics" in 12.1579 secs
2025-03-09 07:27:57,761 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 62.4164 secs
2025-03-09 07:27:57,761 [INFO]: {
2025-03-09 07:27:57,761 [INFO]: 	index_key: HNSW15
2025-03-09 07:27:57,761 [INFO]: 	index_param: efSearch=198
2025-03-09 07:27:57,761 [INFO]: 	index_path: knn.index
2025-03-09 07:27:57,761 [INFO]: 	size in bytes: 814716970
2025-03-09 07:27:57,761 [INFO]: 	avg_search_speed_ms: 9.512699431360845
2025-03-09 07:27:57,761 [INFO]: 	99p_search_speed_ms: 16.7194186267443
2025-03-09 07:27:57,761 [INFO]: 	reconstruction error %: 0.0
2025-03-09 07:27:57,761 [INFO]: 	nb vectors: 4141
2025-03-09 07:27:57,761 [INFO]: 	vectors dimension: 49152
2025-03-09 07:27:57,761 [INFO]: 	compression ratio: 0.99930866543752
2025-03-09 07:27:57,761 [INFO]: }
2025-03-09 07:27:57,761 [INFO]: 	>>> Finished "Creating the index" in 62.4178 secs
2025-03-09 07:27:57,761 [INFO]: >>> Finished "Launching the whole pipeline" in 62.4432 secs
2025-03-09 07:27:58: [retrieval_preprocessing] calculating distances ...
2025-03-09 07:27:59: [retrieval_preprocessing] finished and saved retrieval indices for episode 64073 [episode count 16/20]
[retrieval_preprocessing] for episode 84574 [episode count 17/20], we have num_retrieval=np.int64(4064) num_query=np.int64(230)
2025-03-09 07:27:59,477 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-09 07:28:00,040 [INFO]: Launching the whole pipeline 03/09/2025, 07:28:00
2025-03-09 07:28:00,040 [INFO]: Reading total number of vectors and dimension 03/09/2025, 07:28:00
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 2122.62it/s]
2025-03-09 07:28:00,067 [INFO]: There are 4064 embeddings of dim 49152
2025-03-09 07:28:00,067 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0274 secs
2025-03-09 07:28:00,067 [INFO]: 	Compute estimated construction time of the index 03/09/2025, 07:28:00
2025-03-09 07:28:00,067 [INFO]: 		-> Train: 16.7 minutes
2025-03-09 07:28:00,067 [INFO]: 		-> Add: 2.2 seconds
2025-03-09 07:28:00,067 [INFO]: 		Total: 16.7 minutes
2025-03-09 07:28:00,067 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0001 secs
2025-03-09 07:28:00,067 [INFO]: 	Checking that your have enough memory available to create the index 03/09/2025, 07:28:00
2025-03-09 07:28:00,067 [INFO]: 838.7MB of memory will be needed to build the index (more might be used if you have more)
2025-03-09 07:28:00,067 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0001 secs
2025-03-09 07:28:00,067 [INFO]: 	Selecting most promising index types given data characteristics 03/09/2025, 07:28:00
2025-03-09 07:28:00,067 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-09 07:28:00,068 [INFO]: 	Creating the index 03/09/2025, 07:28:00
2025-03-09 07:28:00,068 [INFO]: 		-> Instanciate the index HNSW15 03/09/2025, 07:28:00
2025-03-09 07:28:00,069 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0009 secs
2025-03-09 07:28:00,069 [INFO]: 		-> Adding the vectors to the index 03/09/2025, 07:28:00
2025-03-09 07:28:00,069 [INFO]: The memory available for adding the vectors is 49.3GB(total available - used by the index)
2025-03-09 07:28:00,069 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/16 [00:00<?, ?it/s]  6%|▋         | 1/16 [00:00<00:01,  7.62it/s] 38%|███▊      | 6/16 [00:00<00:00, 28.58it/s] 69%|██████▉   | 11/16 [00:00<00:00, 36.67it/s]100%|██████████| 16/16 [00:03<00:00,  3.11it/s]100%|██████████| 16/16 [00:03<00:00,  4.21it/s]
2025-03-09 07:28:03,875 [INFO]: 	Computing best hyperparameters for index knn.index 03/09/2025, 07:28:03
2025-03-09 07:28:50,623 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 46.7472 secs
2025-03-09 07:28:50,623 [INFO]: The best hyperparameters are: efSearch=201
2025-03-09 07:28:50,623 [INFO]: 	Compute fast metrics 03/09/2025, 07:28:50
  0%|          | 0/4 [00:00<?, ?it/s] 25%|██▌       | 1/4 [00:00<00:00,  9.73it/s] 75%|███████▌  | 3/4 [00:00<00:00, 19.32it/s]
2025-03-09 07:29:02,896 [INFO]: 	>>> Finished "Compute fast metrics" in 12.2735 secs
2025-03-09 07:29:02,899 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 62.8299 secs
2025-03-09 07:29:02,899 [INFO]: {
2025-03-09 07:29:02,899 [INFO]: 	index_key: HNSW15
2025-03-09 07:29:02,899 [INFO]: 	index_param: efSearch=201
2025-03-09 07:29:02,899 [INFO]: 	index_path: knn.index
2025-03-09 07:29:02,899 [INFO]: 	size in bytes: 799567690
2025-03-09 07:29:02,899 [INFO]: 	avg_search_speed_ms: 9.67528251007855
2025-03-09 07:29:02,899 [INFO]: 	99p_search_speed_ms: 18.137755084317174
2025-03-09 07:29:02,899 [INFO]: 	reconstruction error %: 0.0
2025-03-09 07:29:02,899 [INFO]: 	nb vectors: 4064
2025-03-09 07:29:02,899 [INFO]: 	vectors dimension: 49152
2025-03-09 07:29:02,899 [INFO]: 	compression ratio: 0.9993086539052122
2025-03-09 07:29:02,899 [INFO]: }
2025-03-09 07:29:02,899 [INFO]: 	>>> Finished "Creating the index" in 62.8313 secs
2025-03-09 07:29:02,899 [INFO]: >>> Finished "Launching the whole pipeline" in 62.8592 secs
2025-03-09 07:29:03: [retrieval_preprocessing] calculating distances ...
2025-03-09 07:29:04: [retrieval_preprocessing] finished and saved retrieval indices for episode 84574 [episode count 17/20]
[retrieval_preprocessing] for episode 42597 [episode count 18/20], we have num_retrieval=np.int64(4116) num_query=np.int64(178)
2025-03-09 07:29:04,930 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-09 07:29:05,453 [INFO]: Launching the whole pipeline 03/09/2025, 07:29:05
2025-03-09 07:29:05,453 [INFO]: Reading total number of vectors and dimension 03/09/2025, 07:29:05
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1671.04it/s]
2025-03-09 07:29:05,478 [INFO]: There are 4116 embeddings of dim 49152
2025-03-09 07:29:05,479 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0260 secs
2025-03-09 07:29:05,479 [INFO]: 	Compute estimated construction time of the index 03/09/2025, 07:29:05
2025-03-09 07:29:05,479 [INFO]: 		-> Train: 16.7 minutes
2025-03-09 07:29:05,479 [INFO]: 		-> Add: 2.3 seconds
2025-03-09 07:29:05,480 [INFO]: 		Total: 16.7 minutes
2025-03-09 07:29:05,480 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0006 secs
2025-03-09 07:29:05,480 [INFO]: 	Checking that your have enough memory available to create the index 03/09/2025, 07:29:05
2025-03-09 07:29:05,480 [INFO]: 849.4MB of memory will be needed to build the index (more might be used if you have more)
2025-03-09 07:29:05,480 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0005 secs
2025-03-09 07:29:05,481 [INFO]: 	Selecting most promising index types given data characteristics 03/09/2025, 07:29:05
2025-03-09 07:29:05,481 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-09 07:29:05,481 [INFO]: 	Creating the index 03/09/2025, 07:29:05
2025-03-09 07:29:05,481 [INFO]: 		-> Instanciate the index HNSW15 03/09/2025, 07:29:05
2025-03-09 07:29:05,484 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0026 secs
2025-03-09 07:29:05,484 [INFO]: 		-> Adding the vectors to the index 03/09/2025, 07:29:05
2025-03-09 07:29:05,484 [INFO]: The memory available for adding the vectors is 49.2GB(total available - used by the index)
2025-03-09 07:29:05,484 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/17 [00:00<?, ?it/s] 18%|█▊        | 3/17 [00:00<00:00, 25.61it/s] 53%|█████▎    | 9/17 [00:00<00:00, 41.48it/s] 88%|████████▊ | 15/17 [00:00<00:00, 46.68it/s]100%|██████████| 17/17 [00:03<00:00,  5.26it/s]
2025-03-09 07:29:08,725 [INFO]: 	Computing best hyperparameters for index knn.index 03/09/2025, 07:29:08
2025-03-09 07:29:50,624 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 41.8982 secs
2025-03-09 07:29:50,624 [INFO]: The best hyperparameters are: efSearch=174
2025-03-09 07:29:50,624 [INFO]: 	Compute fast metrics 03/09/2025, 07:29:50
  0%|          | 0/4 [00:00<?, ?it/s] 50%|█████     | 2/4 [00:00<00:00, 19.45it/s] 75%|███████▌  | 3/4 [00:00<00:00, 21.13it/s]
2025-03-09 07:30:04,849 [INFO]: 	>>> Finished "Compute fast metrics" in 14.2248 secs
2025-03-09 07:30:04,852 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 59.3676 secs
2025-03-09 07:30:04,852 [INFO]: {
2025-03-09 07:30:04,852 [INFO]: 	index_key: HNSW15
2025-03-09 07:30:04,852 [INFO]: 	index_param: efSearch=174
2025-03-09 07:30:04,852 [INFO]: 	index_path: knn.index
2025-03-09 07:30:04,852 [INFO]: 	size in bytes: 809798410
2025-03-09 07:30:04,852 [INFO]: 	avg_search_speed_ms: 8.169058589074684
2025-03-09 07:30:04,852 [INFO]: 	99p_search_speed_ms: 17.97478634864091
2025-03-09 07:30:04,852 [INFO]: 	reconstruction error %: 0.0
2025-03-09 07:30:04,852 [INFO]: 	nb vectors: 4116
2025-03-09 07:30:04,852 [INFO]: 	vectors dimension: 49152
2025-03-09 07:30:04,852 [INFO]: 	compression ratio: 0.9993086155849578
2025-03-09 07:30:04,852 [INFO]: }
2025-03-09 07:30:04,852 [INFO]: 	>>> Finished "Creating the index" in 59.3712 secs
2025-03-09 07:30:04,852 [INFO]: >>> Finished "Launching the whole pipeline" in 59.3994 secs
2025-03-09 07:30:05: [retrieval_preprocessing] calculating distances ...
2025-03-09 07:30:06: [retrieval_preprocessing] finished and saved retrieval indices for episode 42597 [episode count 18/20]
[retrieval_preprocessing] for episode 46184 [episode count 19/20], we have num_retrieval=np.int64(4062) num_query=np.int64(232)
2025-03-09 07:30:06,361 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-09 07:30:06,982 [INFO]: Launching the whole pipeline 03/09/2025, 07:30:06
2025-03-09 07:30:06,982 [INFO]: Reading total number of vectors and dimension 03/09/2025, 07:30:06
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1902.18it/s]
2025-03-09 07:30:07,085 [INFO]: There are 4062 embeddings of dim 49152
2025-03-09 07:30:07,085 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.1033 secs
2025-03-09 07:30:07,085 [INFO]: 	Compute estimated construction time of the index 03/09/2025, 07:30:07
2025-03-09 07:30:07,085 [INFO]: 		-> Train: 16.7 minutes
2025-03-09 07:30:07,085 [INFO]: 		-> Add: 2.2 seconds
2025-03-09 07:30:07,085 [INFO]: 		Total: 16.7 minutes
2025-03-09 07:30:07,085 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0002 secs
2025-03-09 07:30:07,086 [INFO]: 	Checking that your have enough memory available to create the index 03/09/2025, 07:30:07
2025-03-09 07:30:07,086 [INFO]: 838.3MB of memory will be needed to build the index (more might be used if you have more)
2025-03-09 07:30:07,086 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0002 secs
2025-03-09 07:30:07,086 [INFO]: 	Selecting most promising index types given data characteristics 03/09/2025, 07:30:07
2025-03-09 07:30:07,086 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-09 07:30:07,086 [INFO]: 	Creating the index 03/09/2025, 07:30:07
2025-03-09 07:30:07,086 [INFO]: 		-> Instanciate the index HNSW15 03/09/2025, 07:30:07
2025-03-09 07:30:07,088 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0020 secs
2025-03-09 07:30:07,089 [INFO]: 		-> Adding the vectors to the index 03/09/2025, 07:30:07
2025-03-09 07:30:07,089 [INFO]: The memory available for adding the vectors is 49.3GB(total available - used by the index)
2025-03-09 07:30:07,089 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/16 [00:00<?, ?it/s] 12%|█▎        | 2/16 [00:00<00:00, 16.68it/s] 44%|████▍     | 7/16 [00:00<00:00, 34.14it/s] 81%|████████▏ | 13/16 [00:00<00:00, 41.85it/s]100%|██████████| 16/16 [00:03<00:00,  4.24it/s]
2025-03-09 07:30:10,872 [INFO]: 	Computing best hyperparameters for index knn.index 03/09/2025, 07:30:10
2025-03-09 07:30:58,225 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 47.3527 secs
2025-03-09 07:30:58,226 [INFO]: The best hyperparameters are: efSearch=189
2025-03-09 07:30:58,226 [INFO]: 	Compute fast metrics 03/09/2025, 07:30:58
  0%|          | 0/4 [00:00<?, ?it/s] 50%|█████     | 2/4 [00:00<00:00, 14.60it/s] 75%|███████▌  | 3/4 [00:00<00:00, 16.77it/s]
2025-03-09 07:31:12,919 [INFO]: 	>>> Finished "Compute fast metrics" in 14.6935 secs
2025-03-09 07:31:12,922 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 65.8333 secs
2025-03-09 07:31:12,922 [INFO]: {
2025-03-09 07:31:12,922 [INFO]: 	index_key: HNSW15
2025-03-09 07:31:12,922 [INFO]: 	index_param: efSearch=189
2025-03-09 07:31:12,922 [INFO]: 	index_path: knn.index
2025-03-09 07:31:12,922 [INFO]: 	size in bytes: 799174210
2025-03-09 07:31:12,922 [INFO]: 	avg_search_speed_ms: 9.539127704653648
2025-03-09 07:31:12,922 [INFO]: 	99p_search_speed_ms: 20.077050288673483
2025-03-09 07:31:12,922 [INFO]: 	reconstruction error %: 0.0
2025-03-09 07:31:12,922 [INFO]: 	nb vectors: 4062
2025-03-09 07:31:12,922 [INFO]: 	vectors dimension: 49152
2025-03-09 07:31:12,922 [INFO]: 	compression ratio: 0.9993086438562626
2025-03-09 07:31:12,922 [INFO]: }
2025-03-09 07:31:12,922 [INFO]: 	>>> Finished "Creating the index" in 65.8363 secs
2025-03-09 07:31:12,922 [INFO]: >>> Finished "Launching the whole pipeline" in 65.9406 secs
2025-03-09 07:31:13: [retrieval_preprocessing] calculating distances ...
2025-03-09 07:31:14: [retrieval_preprocessing] finished and saved retrieval indices for episode 46184 [episode count 19/20]
2025-03-09 07:31:14: [retrieval_preprocessing] finished for (1477699675, 'marker') [chosen_id count 1/10]
2025-03-09 07:31:17: [retrieval_preprocessing] concatenated all embeddings and indices for 20 episodes for (4400212150, 'marker') [chosen_id count 2/10]
2025-03-09 07:31:17: [retrieval_preprocessing] we have num_total=5987 embedding_dim=49152
[retrieval_preprocessing] for episode 29312 [episode count 0/20], we have num_retrieval=np.int64(5702) num_query=np.int64(285)
2025-03-09 07:31:17,585 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-09 07:31:18,444 [INFO]: Launching the whole pipeline 03/09/2025, 07:31:18
2025-03-09 07:31:18,444 [INFO]: Reading total number of vectors and dimension 03/09/2025, 07:31:18
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1653.25it/s]
2025-03-09 07:31:18,470 [INFO]: There are 5702 embeddings of dim 49152
2025-03-09 07:31:18,470 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0260 secs
2025-03-09 07:31:18,470 [INFO]: 	Compute estimated construction time of the index 03/09/2025, 07:31:18
2025-03-09 07:31:18,470 [INFO]: 		-> Train: 16.7 minutes
2025-03-09 07:31:18,470 [INFO]: 		-> Add: 3.1 seconds
2025-03-09 07:31:18,470 [INFO]: 		Total: 16.7 minutes
2025-03-09 07:31:18,471 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0001 secs
2025-03-09 07:31:18,471 [INFO]: 	Checking that your have enough memory available to create the index 03/09/2025, 07:31:18
2025-03-09 07:31:18,471 [INFO]: 1.1GB of memory will be needed to build the index (more might be used if you have more)
2025-03-09 07:31:18,471 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0003 secs
2025-03-09 07:31:18,471 [INFO]: 	Selecting most promising index types given data characteristics 03/09/2025, 07:31:18
2025-03-09 07:31:18,471 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-09 07:31:18,471 [INFO]: 	Creating the index 03/09/2025, 07:31:18
2025-03-09 07:31:18,471 [INFO]: 		-> Instanciate the index HNSW15 03/09/2025, 07:31:18
2025-03-09 07:31:18,473 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0013 secs
2025-03-09 07:31:18,473 [INFO]: 		-> Adding the vectors to the index 03/09/2025, 07:31:18
2025-03-09 07:31:18,473 [INFO]: The memory available for adding the vectors is 49.0GB(total available - used by the index)
2025-03-09 07:31:18,473 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/24 [00:00<?, ?it/s]  4%|▍         | 1/24 [00:00<00:02,  7.78it/s] 25%|██▌       | 6/24 [00:00<00:00, 29.68it/s] 42%|████▏     | 10/24 [00:00<00:00, 32.12it/s] 62%|██████▎   | 15/24 [00:00<00:00, 38.32it/s] 83%|████████▎ | 20/24 [00:00<00:00, 41.92it/s]100%|██████████| 24/24 [00:07<00:00,  3.31it/s]
2025-03-09 07:31:25,720 [INFO]: 	Computing best hyperparameters for index knn.index 03/09/2025, 07:31:25
2025-03-09 07:32:13,842 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 48.1211 secs
2025-03-09 07:32:13,842 [INFO]: The best hyperparameters are: efSearch=190
2025-03-09 07:32:13,842 [INFO]: 	Compute fast metrics 03/09/2025, 07:32:13
  0%|          | 0/4 [00:00<?, ?it/s] 50%|█████     | 2/4 [00:00<00:00, 19.09it/s] 75%|███████▌  | 3/4 [00:00<00:00, 21.02it/s]
2025-03-09 07:32:28,475 [INFO]: 	>>> Finished "Compute fast metrics" in 14.6322 secs
2025-03-09 07:32:28,479 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 70.0061 secs
2025-03-09 07:32:28,479 [INFO]: {
2025-03-09 07:32:28,479 [INFO]: 	index_key: HNSW15
2025-03-09 07:32:28,479 [INFO]: 	index_param: efSearch=190
2025-03-09 07:32:28,479 [INFO]: 	index_path: knn.index
2025-03-09 07:32:28,479 [INFO]: 	size in bytes: 1121835010
2025-03-09 07:32:28,479 [INFO]: 	avg_search_speed_ms: 10.371235397323595
2025-03-09 07:32:28,479 [INFO]: 	99p_search_speed_ms: 23.896293002180755
2025-03-09 07:32:28,479 [INFO]: 	reconstruction error %: 0.0
2025-03-09 07:32:28,479 [INFO]: 	nb vectors: 5702
2025-03-09 07:32:28,479 [INFO]: 	vectors dimension: 49152
2025-03-09 07:32:28,479 [INFO]: 	compression ratio: 0.9993081032477316
2025-03-09 07:32:28,479 [INFO]: }
2025-03-09 07:32:28,479 [INFO]: 	>>> Finished "Creating the index" in 70.0079 secs
2025-03-09 07:32:28,479 [INFO]: >>> Finished "Launching the whole pipeline" in 70.0350 secs
2025-03-09 07:32:29: [retrieval_preprocessing] calculating distances ...
2025-03-09 07:32:30: [retrieval_preprocessing] finished and saved retrieval indices for episode 29312 [episode count 0/20]
[retrieval_preprocessing] for episode 61063 [episode count 1/20], we have num_retrieval=np.int64(5697) num_query=np.int64(290)
2025-03-09 07:32:31,081 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-09 07:32:31,953 [INFO]: Launching the whole pipeline 03/09/2025, 07:32:31
2025-03-09 07:32:31,954 [INFO]: Reading total number of vectors and dimension 03/09/2025, 07:32:31
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1128.71it/s]
2025-03-09 07:32:31,987 [INFO]: There are 5697 embeddings of dim 49152
2025-03-09 07:32:31,987 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0331 secs
2025-03-09 07:32:31,987 [INFO]: 	Compute estimated construction time of the index 03/09/2025, 07:32:31
2025-03-09 07:32:31,987 [INFO]: 		-> Train: 16.7 minutes
2025-03-09 07:32:31,987 [INFO]: 		-> Add: 3.1 seconds
2025-03-09 07:32:31,987 [INFO]: 		Total: 16.7 minutes
2025-03-09 07:32:31,987 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0002 secs
2025-03-09 07:32:31,987 [INFO]: 	Checking that your have enough memory available to create the index 03/09/2025, 07:32:31
2025-03-09 07:32:31,987 [INFO]: 1.1GB of memory will be needed to build the index (more might be used if you have more)
2025-03-09 07:32:31,987 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0002 secs
2025-03-09 07:32:31,988 [INFO]: 	Selecting most promising index types given data characteristics 03/09/2025, 07:32:31
2025-03-09 07:32:31,988 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-09 07:32:31,988 [INFO]: 	Creating the index 03/09/2025, 07:32:31
2025-03-09 07:32:31,988 [INFO]: 		-> Instanciate the index HNSW15 03/09/2025, 07:32:31
2025-03-09 07:32:31,989 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0013 secs
2025-03-09 07:32:31,989 [INFO]: 		-> Adding the vectors to the index 03/09/2025, 07:32:31
2025-03-09 07:32:31,989 [INFO]: The memory available for adding the vectors is 49.0GB(total available - used by the index)
2025-03-09 07:32:31,989 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/24 [00:00<?, ?it/s]  4%|▍         | 1/24 [00:00<00:03,  7.28it/s] 25%|██▌       | 6/24 [00:00<00:00, 28.97it/s] 46%|████▌     | 11/24 [00:00<00:00, 37.60it/s] 67%|██████▋   | 16/24 [00:00<00:00, 42.04it/s] 88%|████████▊ | 21/24 [00:04<00:00,  3.42it/s]100%|██████████| 24/24 [00:05<00:00,  3.14it/s]100%|██████████| 24/24 [00:05<00:00,  4.60it/s]
2025-03-09 07:32:37,204 [INFO]: 	Computing best hyperparameters for index knn.index 03/09/2025, 07:32:37
2025-03-09 07:33:31,796 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 54.5920 secs
2025-03-09 07:33:31,797 [INFO]: The best hyperparameters are: efSearch=188
2025-03-09 07:33:31,797 [INFO]: 	Compute fast metrics 03/09/2025, 07:33:31
  0%|          | 0/4 [00:00<?, ?it/s] 25%|██▌       | 1/4 [00:00<00:00,  3.81it/s] 50%|█████     | 2/4 [00:01<00:01,  1.32it/s] 75%|███████▌  | 3/4 [00:02<00:01,  1.11s/it] 75%|███████▌  | 3/4 [00:02<00:00,  1.00it/s]
2025-03-09 07:33:55,388 [INFO]: 	>>> Finished "Compute fast metrics" in 23.5908 secs
2025-03-09 07:33:55,389 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 83.3994 secs
2025-03-09 07:33:55,389 [INFO]: {
2025-03-09 07:33:55,389 [INFO]: 	index_key: HNSW15
2025-03-09 07:33:55,389 [INFO]: 	index_param: efSearch=188
2025-03-09 07:33:55,389 [INFO]: 	index_path: knn.index
2025-03-09 07:33:55,389 [INFO]: 	size in bytes: 1120851250
2025-03-09 07:33:55,389 [INFO]: 	avg_search_speed_ms: 8.40592467453049
2025-03-09 07:33:55,389 [INFO]: 	99p_search_speed_ms: 11.76963651319964
2025-03-09 07:33:55,389 [INFO]: 	reconstruction error %: 0.0
2025-03-09 07:33:55,389 [INFO]: 	nb vectors: 5697
2025-03-09 07:33:55,389 [INFO]: 	vectors dimension: 49152
2025-03-09 07:33:55,389 [INFO]: 	compression ratio: 0.999308138345744
2025-03-09 07:33:55,389 [INFO]: }
2025-03-09 07:33:55,389 [INFO]: 	>>> Finished "Creating the index" in 83.4013 secs
2025-03-09 07:33:55,389 [INFO]: >>> Finished "Launching the whole pipeline" in 83.4353 secs
2025-03-09 07:33:56: [retrieval_preprocessing] calculating distances ...
2025-03-09 07:33:57: [retrieval_preprocessing] finished and saved retrieval indices for episode 61063 [episode count 1/20]
[retrieval_preprocessing] for episode 91400 [episode count 2/20], we have num_retrieval=np.int64(5698) num_query=np.int64(289)
2025-03-09 07:33:57,898 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-09 07:33:58,707 [INFO]: Launching the whole pipeline 03/09/2025, 07:33:58
2025-03-09 07:33:58,707 [INFO]: Reading total number of vectors and dimension 03/09/2025, 07:33:58
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 2076.39it/s]
2025-03-09 07:33:58,736 [INFO]: There are 5698 embeddings of dim 49152
2025-03-09 07:33:58,736 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0287 secs
2025-03-09 07:33:58,736 [INFO]: 	Compute estimated construction time of the index 03/09/2025, 07:33:58
2025-03-09 07:33:58,736 [INFO]: 		-> Train: 16.7 minutes
2025-03-09 07:33:58,736 [INFO]: 		-> Add: 3.1 seconds
2025-03-09 07:33:58,737 [INFO]: 		Total: 16.7 minutes
2025-03-09 07:33:58,737 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0003 secs
2025-03-09 07:33:58,737 [INFO]: 	Checking that your have enough memory available to create the index 03/09/2025, 07:33:58
2025-03-09 07:33:58,737 [INFO]: 1.1GB of memory will be needed to build the index (more might be used if you have more)
2025-03-09 07:33:58,737 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0004 secs
2025-03-09 07:33:58,737 [INFO]: 	Selecting most promising index types given data characteristics 03/09/2025, 07:33:58
2025-03-09 07:33:58,737 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-09 07:33:58,737 [INFO]: 	Creating the index 03/09/2025, 07:33:58
2025-03-09 07:33:58,738 [INFO]: 		-> Instanciate the index HNSW15 03/09/2025, 07:33:58
2025-03-09 07:33:58,741 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0029 secs
2025-03-09 07:33:58,741 [INFO]: 		-> Adding the vectors to the index 03/09/2025, 07:33:58
2025-03-09 07:33:58,741 [INFO]: The memory available for adding the vectors is 49.0GB(total available - used by the index)
2025-03-09 07:33:58,741 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/24 [00:00<?, ?it/s]  8%|▊         | 2/24 [00:00<00:01, 17.20it/s] 33%|███▎      | 8/24 [00:00<00:00, 39.03it/s] 58%|█████▊    | 14/24 [00:00<00:00, 45.05it/s] 79%|███████▉  | 19/24 [00:00<00:00, 45.54it/s]100%|██████████| 24/24 [00:06<00:00,  2.12it/s]100%|██████████| 24/24 [00:06<00:00,  3.50it/s]
2025-03-09 07:34:05,605 [INFO]: 	Computing best hyperparameters for index knn.index 03/09/2025, 07:34:05
2025-03-09 07:35:04,152 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 58.5457 secs
2025-03-09 07:35:04,152 [INFO]: The best hyperparameters are: efSearch=175
2025-03-09 07:35:04,152 [INFO]: 	Compute fast metrics 03/09/2025, 07:35:04
  0%|          | 0/4 [00:00<?, ?it/s] 25%|██▌       | 1/4 [00:00<00:02,  1.49it/s] 50%|█████     | 2/4 [00:00<00:00,  2.16it/s] 75%|███████▌  | 3/4 [00:01<00:00,  2.60it/s] 75%|███████▌  | 3/4 [00:01<00:00,  1.93it/s]
2025-03-09 07:35:18,899 [INFO]: 	>>> Finished "Compute fast metrics" in 14.7461 secs
2025-03-09 07:35:18,903 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 80.1617 secs
2025-03-09 07:35:18,903 [INFO]: {
2025-03-09 07:35:18,903 [INFO]: 	index_key: HNSW15
2025-03-09 07:35:18,903 [INFO]: 	index_param: efSearch=175
2025-03-09 07:35:18,903 [INFO]: 	index_path: knn.index
2025-03-09 07:35:18,903 [INFO]: 	size in bytes: 1121047990
2025-03-09 07:35:18,903 [INFO]: 	avg_search_speed_ms: 9.631076996834075
2025-03-09 07:35:18,903 [INFO]: 	99p_search_speed_ms: 24.062927328050137
2025-03-09 07:35:18,903 [INFO]: 	reconstruction error %: 0.0
2025-03-09 07:35:18,903 [INFO]: 	nb vectors: 5698
2025-03-09 07:35:18,903 [INFO]: 	vectors dimension: 49152
2025-03-09 07:35:18,903 [INFO]: 	compression ratio: 0.9993081420180772
2025-03-09 07:35:18,903 [INFO]: }
2025-03-09 07:35:18,903 [INFO]: 	>>> Finished "Creating the index" in 80.1656 secs
2025-03-09 07:35:18,903 [INFO]: >>> Finished "Launching the whole pipeline" in 80.1959 secs
2025-03-09 07:35:19: [retrieval_preprocessing] calculating distances ...
2025-03-09 07:35:20: [retrieval_preprocessing] finished and saved retrieval indices for episode 91400 [episode count 2/20]
[retrieval_preprocessing] for episode 71820 [episode count 3/20], we have num_retrieval=np.int64(5774) num_query=np.int64(213)
2025-03-09 07:35:21,289 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-09 07:35:22,352 [INFO]: Launching the whole pipeline 03/09/2025, 07:35:22
2025-03-09 07:35:22,352 [INFO]: Reading total number of vectors and dimension 03/09/2025, 07:35:22
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1594.19it/s]
2025-03-09 07:35:22,384 [INFO]: There are 5774 embeddings of dim 49152
2025-03-09 07:35:22,385 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0332 secs
2025-03-09 07:35:22,385 [INFO]: 	Compute estimated construction time of the index 03/09/2025, 07:35:22
2025-03-09 07:35:22,385 [INFO]: 		-> Train: 16.7 minutes
2025-03-09 07:35:22,385 [INFO]: 		-> Add: 3.2 seconds
2025-03-09 07:35:22,385 [INFO]: 		Total: 16.7 minutes
2025-03-09 07:35:22,385 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0003 secs
2025-03-09 07:35:22,386 [INFO]: 	Checking that your have enough memory available to create the index 03/09/2025, 07:35:22
2025-03-09 07:35:22,386 [INFO]: 1.2GB of memory will be needed to build the index (more might be used if you have more)
2025-03-09 07:35:22,386 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0005 secs
2025-03-09 07:35:22,386 [INFO]: 	Selecting most promising index types given data characteristics 03/09/2025, 07:35:22
2025-03-09 07:35:22,386 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-09 07:35:22,387 [INFO]: 	Creating the index 03/09/2025, 07:35:22
2025-03-09 07:35:22,387 [INFO]: 		-> Instanciate the index HNSW15 03/09/2025, 07:35:22
2025-03-09 07:35:22,390 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0027 secs
2025-03-09 07:35:22,390 [INFO]: 		-> Adding the vectors to the index 03/09/2025, 07:35:22
2025-03-09 07:35:22,390 [INFO]: The memory available for adding the vectors is 48.9GB(total available - used by the index)
2025-03-09 07:35:22,390 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/24 [00:00<?, ?it/s]  8%|▊         | 2/24 [00:00<00:01, 14.73it/s] 17%|█▋        | 4/24 [00:00<00:01, 14.37it/s] 25%|██▌       | 6/24 [00:00<00:01, 13.30it/s] 33%|███▎      | 8/24 [00:00<00:01, 13.04it/s] 42%|████▏     | 10/24 [00:00<00:01, 12.90it/s] 50%|█████     | 12/24 [00:00<00:00, 12.83it/s] 58%|█████▊    | 14/24 [00:01<00:01,  6.73it/s] 75%|███████▌  | 18/24 [00:01<00:00, 11.07it/s] 83%|████████▎ | 20/24 [00:01<00:00, 12.28it/s] 92%|█████████▏| 22/24 [00:08<00:01,  1.10it/s]100%|██████████| 24/24 [00:09<00:00,  1.17it/s]100%|██████████| 24/24 [00:09<00:00,  2.53it/s]
2025-03-09 07:35:31,892 [INFO]: 	Computing best hyperparameters for index knn.index 03/09/2025, 07:35:31
2025-03-09 07:36:28,976 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 57.0831 secs
2025-03-09 07:36:28,976 [INFO]: The best hyperparameters are: efSearch=157
2025-03-09 07:36:28,976 [INFO]: 	Compute fast metrics 03/09/2025, 07:36:28
  0%|          | 0/4 [00:00<?, ?it/s] 25%|██▌       | 1/4 [00:00<00:00,  7.19it/s] 75%|███████▌  | 3/4 [00:00<00:00, 12.86it/s]
2025-03-09 07:36:42,708 [INFO]: 	>>> Finished "Compute fast metrics" in 13.7320 secs
2025-03-09 07:36:42,711 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 80.3209 secs
2025-03-09 07:36:42,711 [INFO]: {
2025-03-09 07:36:42,711 [INFO]: 	index_key: HNSW15
2025-03-09 07:36:42,711 [INFO]: 	index_param: efSearch=157
2025-03-09 07:36:42,711 [INFO]: 	index_path: knn.index
2025-03-09 07:36:42,711 [INFO]: 	size in bytes: 1136000410
2025-03-09 07:36:42,711 [INFO]: 	avg_search_speed_ms: 9.066869072229386
2025-03-09 07:36:42,711 [INFO]: 	99p_search_speed_ms: 23.81259433925152
2025-03-09 07:36:42,711 [INFO]: 	reconstruction error %: 0.0
2025-03-09 07:36:42,712 [INFO]: 	nb vectors: 5774
2025-03-09 07:36:42,712 [INFO]: 	vectors dimension: 49152
2025-03-09 07:36:42,712 [INFO]: 	compression ratio: 0.9993082590524769
2025-03-09 07:36:42,712 [INFO]: }
2025-03-09 07:36:42,712 [INFO]: 	>>> Finished "Creating the index" in 80.3249 secs
2025-03-09 07:36:42,712 [INFO]: >>> Finished "Launching the whole pipeline" in 80.3600 secs
2025-03-09 07:36:43: [retrieval_preprocessing] calculating distances ...
2025-03-09 07:36:44: [retrieval_preprocessing] finished and saved retrieval indices for episode 71820 [episode count 3/20]
[retrieval_preprocessing] for episode 9232 [episode count 4/20], we have num_retrieval=np.int64(5760) num_query=np.int64(227)
2025-03-09 07:36:44,802 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-09 07:36:45,668 [INFO]: Launching the whole pipeline 03/09/2025, 07:36:45
2025-03-09 07:36:45,668 [INFO]: Reading total number of vectors and dimension 03/09/2025, 07:36:45
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1695.35it/s]
2025-03-09 07:36:45,693 [INFO]: There are 5760 embeddings of dim 49152
2025-03-09 07:36:45,693 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0250 secs
2025-03-09 07:36:45,693 [INFO]: 	Compute estimated construction time of the index 03/09/2025, 07:36:45
2025-03-09 07:36:45,694 [INFO]: 		-> Train: 16.7 minutes
2025-03-09 07:36:45,694 [INFO]: 		-> Add: 3.2 seconds
2025-03-09 07:36:45,694 [INFO]: 		Total: 16.7 minutes
2025-03-09 07:36:45,694 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0001 secs
2025-03-09 07:36:45,694 [INFO]: 	Checking that your have enough memory available to create the index 03/09/2025, 07:36:45
2025-03-09 07:36:45,694 [INFO]: 1.2GB of memory will be needed to build the index (more might be used if you have more)
2025-03-09 07:36:45,694 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0002 secs
2025-03-09 07:36:45,694 [INFO]: 	Selecting most promising index types given data characteristics 03/09/2025, 07:36:45
2025-03-09 07:36:45,694 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-09 07:36:45,694 [INFO]: 	Creating the index 03/09/2025, 07:36:45
2025-03-09 07:36:45,694 [INFO]: 		-> Instanciate the index HNSW15 03/09/2025, 07:36:45
2025-03-09 07:36:45,695 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0010 secs
2025-03-09 07:36:45,695 [INFO]: 		-> Adding the vectors to the index 03/09/2025, 07:36:45
2025-03-09 07:36:45,695 [INFO]: The memory available for adding the vectors is 48.9GB(total available - used by the index)
2025-03-09 07:36:45,695 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/24 [00:00<?, ?it/s]  4%|▍         | 1/24 [00:00<00:03,  7.63it/s] 25%|██▌       | 6/24 [00:00<00:00, 29.06it/s] 46%|████▌     | 11/24 [00:00<00:00, 37.37it/s] 67%|██████▋   | 16/24 [00:00<00:00, 41.63it/s] 88%|████████▊ | 21/24 [00:04<00:01,  2.82it/s]100%|██████████| 24/24 [00:06<00:00,  2.46it/s]100%|██████████| 24/24 [00:06<00:00,  3.68it/s]
2025-03-09 07:36:52,213 [INFO]: 	Computing best hyperparameters for index knn.index 03/09/2025, 07:36:52
2025-03-09 07:37:43,351 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 51.1382 secs
2025-03-09 07:37:43,352 [INFO]: The best hyperparameters are: efSearch=152
2025-03-09 07:37:43,352 [INFO]: 	Compute fast metrics 03/09/2025, 07:37:43
  0%|          | 0/4 [00:00<?, ?it/s] 50%|█████     | 2/4 [00:00<00:00, 16.93it/s] 75%|███████▌  | 3/4 [00:00<00:00, 17.88it/s]
2025-03-09 07:37:58,034 [INFO]: 	>>> Finished "Compute fast metrics" in 14.6821 secs
2025-03-09 07:37:58,035 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 72.3395 secs
2025-03-09 07:37:58,035 [INFO]: {
2025-03-09 07:37:58,035 [INFO]: 	index_key: HNSW15
2025-03-09 07:37:58,035 [INFO]: 	index_param: efSearch=152
2025-03-09 07:37:58,035 [INFO]: 	index_path: knn.index
2025-03-09 07:37:58,035 [INFO]: 	size in bytes: 1133246050
2025-03-09 07:37:58,035 [INFO]: 	avg_search_speed_ms: 8.92115547010466
2025-03-09 07:37:58,035 [INFO]: 	99p_search_speed_ms: 23.369076217059035
2025-03-09 07:37:58,035 [INFO]: 	reconstruction error %: 0.0
2025-03-09 07:37:58,035 [INFO]: 	nb vectors: 5760
2025-03-09 07:37:58,035 [INFO]: 	vectors dimension: 49152
2025-03-09 07:37:58,035 [INFO]: 	compression ratio: 0.999308208486586
2025-03-09 07:37:58,035 [INFO]: }
2025-03-09 07:37:58,035 [INFO]: 	>>> Finished "Creating the index" in 72.3410 secs
2025-03-09 07:37:58,035 [INFO]: >>> Finished "Launching the whole pipeline" in 72.3666 secs
2025-03-09 07:37:58: [retrieval_preprocessing] calculating distances ...
2025-03-09 07:37:59: [retrieval_preprocessing] finished and saved retrieval indices for episode 9232 [episode count 4/20]
[retrieval_preprocessing] for episode 87699 [episode count 5/20], we have num_retrieval=np.int64(5642) num_query=np.int64(345)
2025-03-09 07:38:00,331 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-09 07:38:01,494 [INFO]: Launching the whole pipeline 03/09/2025, 07:38:01
2025-03-09 07:38:01,494 [INFO]: Reading total number of vectors and dimension 03/09/2025, 07:38:01
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 2014.56it/s]
2025-03-09 07:38:01,522 [INFO]: There are 5642 embeddings of dim 49152
2025-03-09 07:38:01,522 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0281 secs
2025-03-09 07:38:01,522 [INFO]: 	Compute estimated construction time of the index 03/09/2025, 07:38:01
2025-03-09 07:38:01,522 [INFO]: 		-> Train: 16.7 minutes
2025-03-09 07:38:01,522 [INFO]: 		-> Add: 3.1 seconds
2025-03-09 07:38:01,522 [INFO]: 		Total: 16.7 minutes
2025-03-09 07:38:01,522 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0001 secs
2025-03-09 07:38:01,522 [INFO]: 	Checking that your have enough memory available to create the index 03/09/2025, 07:38:01
2025-03-09 07:38:01,522 [INFO]: 1.1GB of memory will be needed to build the index (more might be used if you have more)
2025-03-09 07:38:01,522 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0001 secs
2025-03-09 07:38:01,522 [INFO]: 	Selecting most promising index types given data characteristics 03/09/2025, 07:38:01
2025-03-09 07:38:01,522 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-09 07:38:01,522 [INFO]: 	Creating the index 03/09/2025, 07:38:01
2025-03-09 07:38:01,522 [INFO]: 		-> Instanciate the index HNSW15 03/09/2025, 07:38:01
2025-03-09 07:38:01,523 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0011 secs
2025-03-09 07:38:01,524 [INFO]: 		-> Adding the vectors to the index 03/09/2025, 07:38:01
2025-03-09 07:38:01,524 [INFO]: The memory available for adding the vectors is 49.0GB(total available - used by the index)
2025-03-09 07:38:01,524 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/24 [00:00<?, ?it/s]  4%|▍         | 1/24 [00:00<00:02,  7.69it/s] 25%|██▌       | 6/24 [00:00<00:00, 26.63it/s] 46%|████▌     | 11/24 [00:00<00:00, 33.12it/s] 67%|██████▋   | 16/24 [00:00<00:00, 36.34it/s] 88%|████████▊ | 21/24 [00:05<00:01,  2.72it/s]100%|██████████| 24/24 [00:06<00:00,  2.51it/s]100%|██████████| 24/24 [00:06<00:00,  3.69it/s]
2025-03-09 07:38:08,031 [INFO]: 	Computing best hyperparameters for index knn.index 03/09/2025, 07:38:08
2025-03-09 07:38:58,150 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 50.1186 secs
2025-03-09 07:38:58,151 [INFO]: The best hyperparameters are: efSearch=145
2025-03-09 07:38:58,151 [INFO]: 	Compute fast metrics 03/09/2025, 07:38:58
  0%|          | 0/4 [00:00<?, ?it/s] 50%|█████     | 2/4 [00:00<00:00, 17.93it/s] 75%|███████▌  | 3/4 [00:00<00:00, 19.82it/s]
2025-03-09 07:39:12,636 [INFO]: 	>>> Finished "Compute fast metrics" in 14.4851 secs
2025-03-09 07:39:12,637 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 71.1133 secs
2025-03-09 07:39:12,637 [INFO]: {
2025-03-09 07:39:12,637 [INFO]: 	index_key: HNSW15
2025-03-09 07:39:12,637 [INFO]: 	index_param: efSearch=145
2025-03-09 07:39:12,637 [INFO]: 	index_path: knn.index
2025-03-09 07:39:12,637 [INFO]: 	size in bytes: 1110030490
2025-03-09 07:39:12,637 [INFO]: 	avg_search_speed_ms: 9.632785277672628
2025-03-09 07:39:12,637 [INFO]: 	99p_search_speed_ms: 20.100189505610608
2025-03-09 07:39:12,637 [INFO]: 	reconstruction error %: 0.0
2025-03-09 07:39:12,637 [INFO]: 	nb vectors: 5642
2025-03-09 07:39:12,637 [INFO]: 	vectors dimension: 49152
2025-03-09 07:39:12,637 [INFO]: 	compression ratio: 0.9993079883778688
2025-03-09 07:39:12,637 [INFO]: }
2025-03-09 07:39:12,637 [INFO]: 	>>> Finished "Creating the index" in 71.1149 secs
2025-03-09 07:39:12,637 [INFO]: >>> Finished "Launching the whole pipeline" in 71.1436 secs
2025-03-09 07:39:13: [retrieval_preprocessing] calculating distances ...
2025-03-09 07:39:15: [retrieval_preprocessing] finished and saved retrieval indices for episode 87699 [episode count 5/20]
[retrieval_preprocessing] for episode 10901 [episode count 6/20], we have num_retrieval=np.int64(5715) num_query=np.int64(272)
2025-03-09 07:39:15,673 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-09 07:39:16,533 [INFO]: Launching the whole pipeline 03/09/2025, 07:39:16
2025-03-09 07:39:16,533 [INFO]: Reading total number of vectors and dimension 03/09/2025, 07:39:16
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1116.40it/s]
2025-03-09 07:39:16,562 [INFO]: There are 5715 embeddings of dim 49152
2025-03-09 07:39:16,562 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0293 secs
2025-03-09 07:39:16,562 [INFO]: 	Compute estimated construction time of the index 03/09/2025, 07:39:16
2025-03-09 07:39:16,563 [INFO]: 		-> Train: 16.7 minutes
2025-03-09 07:39:16,563 [INFO]: 		-> Add: 3.1 seconds
2025-03-09 07:39:16,563 [INFO]: 		Total: 16.7 minutes
2025-03-09 07:39:16,563 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0002 secs
2025-03-09 07:39:16,563 [INFO]: 	Checking that your have enough memory available to create the index 03/09/2025, 07:39:16
2025-03-09 07:39:16,563 [INFO]: 1.2GB of memory will be needed to build the index (more might be used if you have more)
2025-03-09 07:39:16,563 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0003 secs
2025-03-09 07:39:16,563 [INFO]: 	Selecting most promising index types given data characteristics 03/09/2025, 07:39:16
2025-03-09 07:39:16,563 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-09 07:39:16,563 [INFO]: 	Creating the index 03/09/2025, 07:39:16
2025-03-09 07:39:16,563 [INFO]: 		-> Instanciate the index HNSW15 03/09/2025, 07:39:16
2025-03-09 07:39:16,565 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0015 secs
2025-03-09 07:39:16,565 [INFO]: 		-> Adding the vectors to the index 03/09/2025, 07:39:16
2025-03-09 07:39:16,565 [INFO]: The memory available for adding the vectors is 49.0GB(total available - used by the index)
2025-03-09 07:39:16,565 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/24 [00:00<?, ?it/s]  4%|▍         | 1/24 [00:00<00:02,  8.21it/s] 21%|██        | 5/24 [00:00<00:00, 25.32it/s] 38%|███▊      | 9/24 [00:00<00:00, 31.68it/s] 58%|█████▊    | 14/24 [00:00<00:00, 35.48it/s] 79%|███████▉  | 19/24 [00:00<00:00, 36.45it/s] 96%|█████████▌| 23/24 [00:04<00:00,  2.92it/s]100%|██████████| 24/24 [00:05<00:00,  4.18it/s]
2025-03-09 07:39:22,308 [INFO]: 	Computing best hyperparameters for index knn.index 03/09/2025, 07:39:22
2025-03-09 07:40:09,936 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 47.6279 secs
2025-03-09 07:40:09,936 [INFO]: The best hyperparameters are: efSearch=164
2025-03-09 07:40:09,936 [INFO]: 	Compute fast metrics 03/09/2025, 07:40:09
  0%|          | 0/4 [00:00<?, ?it/s] 50%|█████     | 2/4 [00:00<00:00, 16.65it/s] 75%|███████▌  | 3/4 [00:00<00:00, 18.17it/s]
2025-03-09 07:40:23,206 [INFO]: 	>>> Finished "Compute fast metrics" in 13.2697 secs
2025-03-09 07:40:23,207 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 66.6419 secs
2025-03-09 07:40:23,207 [INFO]: {
2025-03-09 07:40:23,207 [INFO]: 	index_key: HNSW15
2025-03-09 07:40:23,207 [INFO]: 	index_param: efSearch=164
2025-03-09 07:40:23,207 [INFO]: 	index_path: knn.index
2025-03-09 07:40:23,207 [INFO]: 	size in bytes: 1124392630
2025-03-09 07:40:23,207 [INFO]: 	avg_search_speed_ms: 8.831348374457997
2025-03-09 07:40:23,207 [INFO]: 	99p_search_speed_ms: 19.24650763161481
2025-03-09 07:40:23,207 [INFO]: 	reconstruction error %: 0.0
2025-03-09 07:40:23,207 [INFO]: 	nb vectors: 5715
2025-03-09 07:40:23,207 [INFO]: 	vectors dimension: 49152
2025-03-09 07:40:23,207 [INFO]: 	compression ratio: 0.9993081509258914
2025-03-09 07:40:23,207 [INFO]: }
2025-03-09 07:40:23,207 [INFO]: 	>>> Finished "Creating the index" in 66.6439 secs
2025-03-09 07:40:23,207 [INFO]: >>> Finished "Launching the whole pipeline" in 66.6741 secs
2025-03-09 07:40:24: [retrieval_preprocessing] calculating distances ...
2025-03-09 07:40:25: [retrieval_preprocessing] finished and saved retrieval indices for episode 10901 [episode count 6/20]
[retrieval_preprocessing] for episode 13846 [episode count 7/20], we have num_retrieval=np.int64(5755) num_query=np.int64(232)
2025-03-09 07:40:25,723 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-09 07:40:26,535 [INFO]: Launching the whole pipeline 03/09/2025, 07:40:26
2025-03-09 07:40:26,535 [INFO]: Reading total number of vectors and dimension 03/09/2025, 07:40:26
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 2163.13it/s]
2025-03-09 07:40:26,564 [INFO]: There are 5755 embeddings of dim 49152
2025-03-09 07:40:26,564 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0288 secs
2025-03-09 07:40:26,564 [INFO]: 	Compute estimated construction time of the index 03/09/2025, 07:40:26
2025-03-09 07:40:26,564 [INFO]: 		-> Train: 16.7 minutes
2025-03-09 07:40:26,564 [INFO]: 		-> Add: 3.2 seconds
2025-03-09 07:40:26,564 [INFO]: 		Total: 16.7 minutes
2025-03-09 07:40:26,564 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0001 secs
2025-03-09 07:40:26,564 [INFO]: 	Checking that your have enough memory available to create the index 03/09/2025, 07:40:26
2025-03-09 07:40:26,565 [INFO]: 1.2GB of memory will be needed to build the index (more might be used if you have more)
2025-03-09 07:40:26,565 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0001 secs
2025-03-09 07:40:26,565 [INFO]: 	Selecting most promising index types given data characteristics 03/09/2025, 07:40:26
2025-03-09 07:40:26,565 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-09 07:40:26,565 [INFO]: 	Creating the index 03/09/2025, 07:40:26
2025-03-09 07:40:26,565 [INFO]: 		-> Instanciate the index HNSW15 03/09/2025, 07:40:26
2025-03-09 07:40:26,566 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0012 secs
2025-03-09 07:40:26,566 [INFO]: 		-> Adding the vectors to the index 03/09/2025, 07:40:26
2025-03-09 07:40:26,566 [INFO]: The memory available for adding the vectors is 48.9GB(total available - used by the index)
2025-03-09 07:40:26,566 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/24 [00:00<?, ?it/s]  4%|▍         | 1/24 [00:00<00:02,  8.14it/s] 25%|██▌       | 6/24 [00:00<00:00, 29.84it/s] 46%|████▌     | 11/24 [00:00<00:00, 35.19it/s] 62%|██████▎   | 15/24 [00:00<00:00, 36.02it/s] 83%|████████▎ | 20/24 [00:00<00:00, 40.02it/s]100%|██████████| 24/24 [00:06<00:00,  3.67it/s]
2025-03-09 07:40:33,117 [INFO]: 	Computing best hyperparameters for index knn.index 03/09/2025, 07:40:33
2025-03-09 07:41:21,610 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 48.4928 secs
2025-03-09 07:41:21,610 [INFO]: The best hyperparameters are: efSearch=173
2025-03-09 07:41:21,611 [INFO]: 	Compute fast metrics 03/09/2025, 07:41:21
  0%|          | 0/4 [00:00<?, ?it/s] 50%|█████     | 2/4 [00:00<00:00, 17.10it/s] 75%|███████▌  | 3/4 [00:00<00:00, 18.68it/s]
2025-03-09 07:41:34,815 [INFO]: 	>>> Finished "Compute fast metrics" in 13.2040 secs
2025-03-09 07:41:34,819 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 68.2532 secs
2025-03-09 07:41:34,820 [INFO]: {
2025-03-09 07:41:34,820 [INFO]: 	index_key: HNSW15
2025-03-09 07:41:34,820 [INFO]: 	index_param: efSearch=173
2025-03-09 07:41:34,820 [INFO]: 	index_path: knn.index
2025-03-09 07:41:34,820 [INFO]: 	size in bytes: 1132262350
2025-03-09 07:41:34,820 [INFO]: 	avg_search_speed_ms: 9.014915820627706
2025-03-09 07:41:34,820 [INFO]: 	99p_search_speed_ms: 19.13753634318718
2025-03-09 07:41:34,820 [INFO]: 	reconstruction error %: 0.0
2025-03-09 07:41:34,820 [INFO]: 	nb vectors: 5755
2025-03-09 07:41:34,820 [INFO]: 	vectors dimension: 49152
2025-03-09 07:41:34,820 [INFO]: 	compression ratio: 0.9993081903677182
2025-03-09 07:41:34,820 [INFO]: }
2025-03-09 07:41:34,820 [INFO]: 	>>> Finished "Creating the index" in 68.2549 secs
2025-03-09 07:41:34,820 [INFO]: >>> Finished "Launching the whole pipeline" in 68.2843 secs
2025-03-09 07:41:35: [retrieval_preprocessing] calculating distances ...
2025-03-09 07:41:36: [retrieval_preprocessing] finished and saved retrieval indices for episode 13846 [episode count 7/20]
[retrieval_preprocessing] for episode 2711 [episode count 8/20], we have num_retrieval=np.int64(5682) num_query=np.int64(305)
2025-03-09 07:41:37,428 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-09 07:41:38,309 [INFO]: Launching the whole pipeline 03/09/2025, 07:41:38
2025-03-09 07:41:38,309 [INFO]: Reading total number of vectors and dimension 03/09/2025, 07:41:38
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1235.44it/s]
2025-03-09 07:41:38,348 [INFO]: There are 5682 embeddings of dim 49152
2025-03-09 07:41:38,348 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0387 secs
2025-03-09 07:41:38,348 [INFO]: 	Compute estimated construction time of the index 03/09/2025, 07:41:38
2025-03-09 07:41:38,348 [INFO]: 		-> Train: 16.7 minutes
2025-03-09 07:41:38,348 [INFO]: 		-> Add: 3.1 seconds
2025-03-09 07:41:38,348 [INFO]: 		Total: 16.7 minutes
2025-03-09 07:41:38,348 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0002 secs
2025-03-09 07:41:38,349 [INFO]: 	Checking that your have enough memory available to create the index 03/09/2025, 07:41:38
2025-03-09 07:41:38,349 [INFO]: 1.1GB of memory will be needed to build the index (more might be used if you have more)
2025-03-09 07:41:38,349 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0002 secs
2025-03-09 07:41:38,349 [INFO]: 	Selecting most promising index types given data characteristics 03/09/2025, 07:41:38
2025-03-09 07:41:38,349 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-09 07:41:38,349 [INFO]: 	Creating the index 03/09/2025, 07:41:38
2025-03-09 07:41:38,349 [INFO]: 		-> Instanciate the index HNSW15 03/09/2025, 07:41:38
2025-03-09 07:41:38,350 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0014 secs
2025-03-09 07:41:38,351 [INFO]: 		-> Adding the vectors to the index 03/09/2025, 07:41:38
2025-03-09 07:41:38,351 [INFO]: The memory available for adding the vectors is 49.0GB(total available - used by the index)
2025-03-09 07:41:38,351 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/24 [00:00<?, ?it/s]  4%|▍         | 1/24 [00:00<00:02,  9.13it/s] 25%|██▌       | 6/24 [00:00<00:00, 29.44it/s] 46%|████▌     | 11/24 [00:00<00:00, 35.89it/s] 67%|██████▋   | 16/24 [00:00<00:00, 36.07it/s] 88%|████████▊ | 21/24 [00:04<00:00,  3.26it/s]100%|██████████| 24/24 [00:05<00:00,  3.03it/s]100%|██████████| 24/24 [00:05<00:00,  4.42it/s]
2025-03-09 07:41:43,778 [INFO]: 	Computing best hyperparameters for index knn.index 03/09/2025, 07:41:43
2025-03-09 07:42:32,532 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 48.7530 secs
2025-03-09 07:42:32,532 [INFO]: The best hyperparameters are: efSearch=173
2025-03-09 07:42:32,532 [INFO]: 	Compute fast metrics 03/09/2025, 07:42:32
  0%|          | 0/4 [00:00<?, ?it/s] 25%|██▌       | 1/4 [00:00<00:00,  8.80it/s] 75%|███████▌  | 3/4 [00:00<00:00, 16.28it/s]
2025-03-09 07:42:46,464 [INFO]: 	>>> Finished "Compute fast metrics" in 13.9320 secs
2025-03-09 07:42:46,465 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 68.1144 secs
2025-03-09 07:42:46,465 [INFO]: {
2025-03-09 07:42:46,465 [INFO]: 	index_key: HNSW15
2025-03-09 07:42:46,465 [INFO]: 	index_param: efSearch=173
2025-03-09 07:42:46,465 [INFO]: 	index_path: knn.index
2025-03-09 07:42:46,465 [INFO]: 	size in bytes: 1117900150
2025-03-09 07:42:46,465 [INFO]: 	avg_search_speed_ms: 10.91422241838958
2025-03-09 07:42:46,465 [INFO]: 	99p_search_speed_ms: 19.904374470934272
2025-03-09 07:42:46,465 [INFO]: 	reconstruction error %: 0.0
2025-03-09 07:42:46,465 [INFO]: 	nb vectors: 5682
2025-03-09 07:42:46,465 [INFO]: 	vectors dimension: 49152
2025-03-09 07:42:46,465 [INFO]: 	compression ratio: 0.9993080831056333
2025-03-09 07:42:46,465 [INFO]: }
2025-03-09 07:42:46,465 [INFO]: 	>>> Finished "Creating the index" in 68.1164 secs
2025-03-09 07:42:46,465 [INFO]: >>> Finished "Launching the whole pipeline" in 68.1559 secs
2025-03-09 07:42:47: [retrieval_preprocessing] calculating distances ...
2025-03-09 07:42:48: [retrieval_preprocessing] finished and saved retrieval indices for episode 2711 [episode count 8/20]
[retrieval_preprocessing] for episode 13847 [episode count 9/20], we have num_retrieval=np.int64(5600) num_query=np.int64(387)
2025-03-09 07:42:49,085 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-09 07:42:49,776 [INFO]: Launching the whole pipeline 03/09/2025, 07:42:49
2025-03-09 07:42:49,776 [INFO]: Reading total number of vectors and dimension 03/09/2025, 07:42:49
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1556.33it/s]
2025-03-09 07:42:49,814 [INFO]: There are 5600 embeddings of dim 49152
2025-03-09 07:42:49,814 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0378 secs
2025-03-09 07:42:49,814 [INFO]: 	Compute estimated construction time of the index 03/09/2025, 07:42:49
2025-03-09 07:42:49,815 [INFO]: 		-> Train: 16.7 minutes
2025-03-09 07:42:49,815 [INFO]: 		-> Add: 3.1 seconds
2025-03-09 07:42:49,815 [INFO]: 		Total: 16.7 minutes
2025-03-09 07:42:49,815 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0005 secs
2025-03-09 07:42:49,815 [INFO]: 	Checking that your have enough memory available to create the index 03/09/2025, 07:42:49
2025-03-09 07:42:49,815 [INFO]: 1.1GB of memory will be needed to build the index (more might be used if you have more)
2025-03-09 07:42:49,815 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0003 secs
2025-03-09 07:42:49,816 [INFO]: 	Selecting most promising index types given data characteristics 03/09/2025, 07:42:49
2025-03-09 07:42:49,816 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-09 07:42:49,816 [INFO]: 	Creating the index 03/09/2025, 07:42:49
2025-03-09 07:42:49,816 [INFO]: 		-> Instanciate the index HNSW15 03/09/2025, 07:42:49
2025-03-09 07:42:49,818 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0023 secs
2025-03-09 07:42:49,818 [INFO]: 		-> Adding the vectors to the index 03/09/2025, 07:42:49
2025-03-09 07:42:49,819 [INFO]: The memory available for adding the vectors is 49.0GB(total available - used by the index)
2025-03-09 07:42:49,819 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/24 [00:00<?, ?it/s]  4%|▍         | 1/24 [00:00<00:02,  8.00it/s] 25%|██▌       | 6/24 [00:00<00:00, 29.65it/s] 46%|████▌     | 11/24 [00:00<00:00, 37.68it/s] 67%|██████▋   | 16/24 [00:00<00:00, 41.69it/s] 88%|████████▊ | 21/24 [00:04<00:00,  3.09it/s]100%|██████████| 24/24 [00:05<00:00,  3.00it/s]100%|██████████| 24/24 [00:05<00:00,  4.36it/s]
2025-03-09 07:42:55,333 [INFO]: 	Computing best hyperparameters for index knn.index 03/09/2025, 07:42:55
2025-03-09 07:43:46,374 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 51.0406 secs
2025-03-09 07:43:46,374 [INFO]: The best hyperparameters are: efSearch=171
2025-03-09 07:43:46,375 [INFO]: 	Compute fast metrics 03/09/2025, 07:43:46
  0%|          | 0/4 [00:00<?, ?it/s] 25%|██▌       | 1/4 [00:00<00:00,  7.67it/s] 75%|███████▌  | 3/4 [00:00<00:00, 15.08it/s]
2025-03-09 07:44:02,128 [INFO]: 	>>> Finished "Compute fast metrics" in 15.7535 secs
2025-03-09 07:44:02,129 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 72.3104 secs
2025-03-09 07:44:02,129 [INFO]: {
2025-03-09 07:44:02,129 [INFO]: 	index_key: HNSW15
2025-03-09 07:44:02,129 [INFO]: 	index_param: efSearch=171
2025-03-09 07:44:02,129 [INFO]: 	index_path: knn.index
2025-03-09 07:44:02,129 [INFO]: 	size in bytes: 1101767230
2025-03-09 07:44:02,129 [INFO]: 	avg_search_speed_ms: 9.850666254501919
2025-03-09 07:44:02,129 [INFO]: 	99p_search_speed_ms: 19.90923175122589
2025-03-09 07:44:02,129 [INFO]: 	reconstruction error %: 0.0
2025-03-09 07:44:02,129 [INFO]: 	nb vectors: 5600
2025-03-09 07:44:02,129 [INFO]: 	vectors dimension: 49152
2025-03-09 07:44:02,129 [INFO]: 	compression ratio: 0.9993079935768284
2025-03-09 07:44:02,129 [INFO]: }
2025-03-09 07:44:02,129 [INFO]: 	>>> Finished "Creating the index" in 72.3135 secs
2025-03-09 07:44:02,129 [INFO]: >>> Finished "Launching the whole pipeline" in 72.3529 secs
2025-03-09 07:44:04: [retrieval_preprocessing] calculating distances ...
2025-03-09 07:44:05: [retrieval_preprocessing] finished and saved retrieval indices for episode 13847 [episode count 9/20]
[retrieval_preprocessing] for episode 21528 [episode count 10/20], we have num_retrieval=np.int64(5781) num_query=np.int64(206)
2025-03-09 07:44:06,564 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-09 07:44:07,341 [INFO]: Launching the whole pipeline 03/09/2025, 07:44:07
2025-03-09 07:44:07,341 [INFO]: Reading total number of vectors and dimension 03/09/2025, 07:44:07
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1646.76it/s]
2025-03-09 07:44:07,365 [INFO]: There are 5781 embeddings of dim 49152
2025-03-09 07:44:07,365 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0239 secs
2025-03-09 07:44:07,365 [INFO]: 	Compute estimated construction time of the index 03/09/2025, 07:44:07
2025-03-09 07:44:07,365 [INFO]: 		-> Train: 16.7 minutes
2025-03-09 07:44:07,365 [INFO]: 		-> Add: 3.2 seconds
2025-03-09 07:44:07,365 [INFO]: 		Total: 16.7 minutes
2025-03-09 07:44:07,365 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0001 secs
2025-03-09 07:44:07,365 [INFO]: 	Checking that your have enough memory available to create the index 03/09/2025, 07:44:07
2025-03-09 07:44:07,365 [INFO]: 1.2GB of memory will be needed to build the index (more might be used if you have more)
2025-03-09 07:44:07,365 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0002 secs
2025-03-09 07:44:07,365 [INFO]: 	Selecting most promising index types given data characteristics 03/09/2025, 07:44:07
2025-03-09 07:44:07,365 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-09 07:44:07,365 [INFO]: 	Creating the index 03/09/2025, 07:44:07
2025-03-09 07:44:07,365 [INFO]: 		-> Instanciate the index HNSW15 03/09/2025, 07:44:07
2025-03-09 07:44:07,366 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0009 secs
2025-03-09 07:44:07,367 [INFO]: 		-> Adding the vectors to the index 03/09/2025, 07:44:07
2025-03-09 07:44:07,367 [INFO]: The memory available for adding the vectors is 48.9GB(total available - used by the index)
2025-03-09 07:44:07,367 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/24 [00:00<?, ?it/s]  4%|▍         | 1/24 [00:00<00:02,  8.57it/s] 21%|██        | 5/24 [00:00<00:00, 23.60it/s] 46%|████▌     | 11/24 [00:00<00:00, 36.29it/s] 71%|███████   | 17/24 [00:00<00:00, 42.32it/s] 92%|█████████▏| 22/24 [00:04<00:00,  3.01it/s]100%|██████████| 24/24 [00:06<00:00,  3.78it/s]
2025-03-09 07:44:13,722 [INFO]: 	Computing best hyperparameters for index knn.index 03/09/2025, 07:44:13
2025-03-09 07:45:06,186 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 52.4630 secs
2025-03-09 07:45:06,186 [INFO]: The best hyperparameters are: efSearch=177
2025-03-09 07:45:06,186 [INFO]: 	Compute fast metrics 03/09/2025, 07:45:06
  0%|          | 0/4 [00:00<?, ?it/s] 50%|█████     | 2/4 [00:00<00:00, 18.56it/s] 75%|███████▌  | 3/4 [00:00<00:00, 17.06it/s]
2025-03-09 07:45:23,100 [INFO]: 	>>> Finished "Compute fast metrics" in 16.9136 secs
2025-03-09 07:45:23,101 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 75.7344 secs
2025-03-09 07:45:23,101 [INFO]: {
2025-03-09 07:45:23,101 [INFO]: 	index_key: HNSW15
2025-03-09 07:45:23,101 [INFO]: 	index_param: efSearch=177
2025-03-09 07:45:23,101 [INFO]: 	index_path: knn.index
2025-03-09 07:45:23,101 [INFO]: 	size in bytes: 1137377710
2025-03-09 07:45:23,101 [INFO]: 	avg_search_speed_ms: 9.3739758958759
2025-03-09 07:45:23,101 [INFO]: 	99p_search_speed_ms: 22.507922640070312
2025-03-09 07:45:23,101 [INFO]: 	reconstruction error %: 0.0
2025-03-09 07:45:23,101 [INFO]: 	nb vectors: 5781
2025-03-09 07:45:23,101 [INFO]: 	vectors dimension: 49152
2025-03-09 07:45:23,101 [INFO]: 	compression ratio: 0.9993081788107137
2025-03-09 07:45:23,101 [INFO]: }
2025-03-09 07:45:23,101 [INFO]: 	>>> Finished "Creating the index" in 75.7358 secs
2025-03-09 07:45:23,101 [INFO]: >>> Finished "Launching the whole pipeline" in 75.7604 secs
2025-03-09 07:45:24: [retrieval_preprocessing] calculating distances ...
2025-03-09 07:45:25: [retrieval_preprocessing] finished and saved retrieval indices for episode 21528 [episode count 10/20]
[retrieval_preprocessing] for episode 95642 [episode count 11/20], we have num_retrieval=np.int64(5761) num_query=np.int64(226)
2025-03-09 07:45:25,630 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-09 07:45:26,424 [INFO]: Launching the whole pipeline 03/09/2025, 07:45:26
2025-03-09 07:45:26,424 [INFO]: Reading total number of vectors and dimension 03/09/2025, 07:45:26
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1685.14it/s]
2025-03-09 07:45:26,452 [INFO]: There are 5761 embeddings of dim 49152
2025-03-09 07:45:26,452 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0274 secs
2025-03-09 07:45:26,452 [INFO]: 	Compute estimated construction time of the index 03/09/2025, 07:45:26
2025-03-09 07:45:26,452 [INFO]: 		-> Train: 16.7 minutes
2025-03-09 07:45:26,452 [INFO]: 		-> Add: 3.2 seconds
2025-03-09 07:45:26,452 [INFO]: 		Total: 16.7 minutes
2025-03-09 07:45:26,452 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0002 secs
2025-03-09 07:45:26,452 [INFO]: 	Checking that your have enough memory available to create the index 03/09/2025, 07:45:26
2025-03-09 07:45:26,452 [INFO]: 1.2GB of memory will be needed to build the index (more might be used if you have more)
2025-03-09 07:45:26,452 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0001 secs
2025-03-09 07:45:26,452 [INFO]: 	Selecting most promising index types given data characteristics 03/09/2025, 07:45:26
2025-03-09 07:45:26,452 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-09 07:45:26,452 [INFO]: 	Creating the index 03/09/2025, 07:45:26
2025-03-09 07:45:26,452 [INFO]: 		-> Instanciate the index HNSW15 03/09/2025, 07:45:26
2025-03-09 07:45:26,454 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0012 secs
2025-03-09 07:45:26,454 [INFO]: 		-> Adding the vectors to the index 03/09/2025, 07:45:26
2025-03-09 07:45:26,454 [INFO]: The memory available for adding the vectors is 48.9GB(total available - used by the index)
2025-03-09 07:45:26,454 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/24 [00:00<?, ?it/s]  4%|▍         | 1/24 [00:00<00:02,  9.03it/s] 21%|██        | 5/24 [00:00<00:00, 26.06it/s] 46%|████▌     | 11/24 [00:00<00:00, 39.12it/s] 71%|███████   | 17/24 [00:00<00:00, 45.20it/s] 92%|█████████▏| 22/24 [00:04<00:00,  3.47it/s]100%|██████████| 24/24 [00:05<00:00,  4.43it/s]
2025-03-09 07:45:31,875 [INFO]: 	Computing best hyperparameters for index knn.index 03/09/2025, 07:45:31
2025-03-09 07:46:20,151 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 48.2764 secs
2025-03-09 07:46:20,152 [INFO]: The best hyperparameters are: efSearch=163
2025-03-09 07:46:20,152 [INFO]: 	Compute fast metrics 03/09/2025, 07:46:20
  0%|          | 0/4 [00:00<?, ?it/s] 50%|█████     | 2/4 [00:00<00:00, 17.81it/s] 75%|███████▌  | 3/4 [00:00<00:00, 19.49it/s]
2025-03-09 07:46:43,297 [INFO]: 	>>> Finished "Compute fast metrics" in 23.1455 secs
2025-03-09 07:46:43,298 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 76.8445 secs
2025-03-09 07:46:43,298 [INFO]: {
2025-03-09 07:46:43,298 [INFO]: 	index_key: HNSW15
2025-03-09 07:46:43,298 [INFO]: 	index_param: efSearch=163
2025-03-09 07:46:43,298 [INFO]: 	index_path: knn.index
2025-03-09 07:46:43,298 [INFO]: 	size in bytes: 1133442790
2025-03-09 07:46:43,298 [INFO]: 	avg_search_speed_ms: 9.207446504603817
2025-03-09 07:46:43,299 [INFO]: 	99p_search_speed_ms: 20.524142577778548
2025-03-09 07:46:43,299 [INFO]: 	reconstruction error %: 0.0
2025-03-09 07:46:43,299 [INFO]: 	nb vectors: 5761
2025-03-09 07:46:43,299 [INFO]: 	vectors dimension: 49152
2025-03-09 07:46:43,299 [INFO]: 	compression ratio: 0.9993082121065855
2025-03-09 07:46:43,299 [INFO]: }
2025-03-09 07:46:43,299 [INFO]: 	>>> Finished "Creating the index" in 76.8462 secs
2025-03-09 07:46:43,299 [INFO]: >>> Finished "Launching the whole pipeline" in 76.8743 secs
2025-03-09 07:46:44: [retrieval_preprocessing] calculating distances ...
2025-03-09 07:46:44: [retrieval_preprocessing] finished and saved retrieval indices for episode 95642 [episode count 11/20]
[retrieval_preprocessing] for episode 84381 [episode count 12/20], we have num_retrieval=np.int64(5709) num_query=np.int64(278)
2025-03-09 07:46:45,499 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-09 07:46:46,290 [INFO]: Launching the whole pipeline 03/09/2025, 07:46:46
2025-03-09 07:46:46,290 [INFO]: Reading total number of vectors and dimension 03/09/2025, 07:46:46
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 2145.42it/s]
2025-03-09 07:46:46,319 [INFO]: There are 5709 embeddings of dim 49152
2025-03-09 07:46:46,319 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0295 secs
2025-03-09 07:46:46,320 [INFO]: 	Compute estimated construction time of the index 03/09/2025, 07:46:46
2025-03-09 07:46:46,320 [INFO]: 		-> Train: 16.7 minutes
2025-03-09 07:46:46,320 [INFO]: 		-> Add: 3.1 seconds
2025-03-09 07:46:46,320 [INFO]: 		Total: 16.7 minutes
2025-03-09 07:46:46,320 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0005 secs
2025-03-09 07:46:46,320 [INFO]: 	Checking that your have enough memory available to create the index 03/09/2025, 07:46:46
2025-03-09 07:46:46,321 [INFO]: 1.2GB of memory will be needed to build the index (more might be used if you have more)
2025-03-09 07:46:46,321 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0005 secs
2025-03-09 07:46:46,321 [INFO]: 	Selecting most promising index types given data characteristics 03/09/2025, 07:46:46
2025-03-09 07:46:46,321 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-09 07:46:46,321 [INFO]: 	Creating the index 03/09/2025, 07:46:46
2025-03-09 07:46:46,322 [INFO]: 		-> Instanciate the index HNSW15 03/09/2025, 07:46:46
2025-03-09 07:46:46,325 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0028 secs
2025-03-09 07:46:46,325 [INFO]: 		-> Adding the vectors to the index 03/09/2025, 07:46:46
2025-03-09 07:46:46,325 [INFO]: The memory available for adding the vectors is 49.0GB(total available - used by the index)
2025-03-09 07:46:46,325 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/24 [00:00<?, ?it/s]  8%|▊         | 2/24 [00:00<00:01, 13.42it/s] 25%|██▌       | 6/24 [00:00<00:00, 24.97it/s] 46%|████▌     | 11/24 [00:00<00:00, 34.59it/s] 67%|██████▋   | 16/24 [00:00<00:00, 39.16it/s] 88%|████████▊ | 21/24 [00:04<00:00,  3.14it/s]100%|██████████| 24/24 [00:05<00:00,  2.95it/s]100%|██████████| 24/24 [00:05<00:00,  4.33it/s]
2025-03-09 07:46:51,876 [INFO]: 	Computing best hyperparameters for index knn.index 03/09/2025, 07:46:51
2025-03-09 07:47:40,445 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 48.5694 secs
2025-03-09 07:47:40,445 [INFO]: The best hyperparameters are: efSearch=171
2025-03-09 07:47:40,445 [INFO]: 	Compute fast metrics 03/09/2025, 07:47:40
  0%|          | 0/4 [00:00<?, ?it/s] 25%|██▌       | 1/4 [00:00<00:00,  9.99it/s] 75%|███████▌  | 3/4 [00:00<00:00, 14.59it/s]
2025-03-09 07:48:00,051 [INFO]: 	>>> Finished "Compute fast metrics" in 19.6059 secs
2025-03-09 07:48:00,052 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 73.7274 secs
2025-03-09 07:48:00,053 [INFO]: {
2025-03-09 07:48:00,053 [INFO]: 	index_key: HNSW15
2025-03-09 07:48:00,053 [INFO]: 	index_param: efSearch=171
2025-03-09 07:48:00,053 [INFO]: 	index_path: knn.index
2025-03-09 07:48:00,053 [INFO]: 	size in bytes: 1123212190
2025-03-09 07:48:00,053 [INFO]: 	avg_search_speed_ms: 10.546320843026985
2025-03-09 07:48:00,053 [INFO]: 	99p_search_speed_ms: 23.765017522964627
2025-03-09 07:48:00,053 [INFO]: 	reconstruction error %: 0.0
2025-03-09 07:48:00,053 [INFO]: 	nb vectors: 5709
2025-03-09 07:48:00,053 [INFO]: 	vectors dimension: 49152
2025-03-09 07:48:00,053 [INFO]: 	compression ratio: 0.9993081289475678
2025-03-09 07:48:00,053 [INFO]: }
2025-03-09 07:48:00,053 [INFO]: 	>>> Finished "Creating the index" in 73.7312 secs
2025-03-09 07:48:00,053 [INFO]: >>> Finished "Launching the whole pipeline" in 73.7628 secs
2025-03-09 07:48:01: [retrieval_preprocessing] calculating distances ...
2025-03-09 07:48:02: [retrieval_preprocessing] finished and saved retrieval indices for episode 84381 [episode count 12/20]
[retrieval_preprocessing] for episode 37023 [episode count 13/20], we have num_retrieval=np.int64(5763) num_query=np.int64(224)
2025-03-09 07:48:02,584 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-09 07:48:03,321 [INFO]: Launching the whole pipeline 03/09/2025, 07:48:03
2025-03-09 07:48:03,321 [INFO]: Reading total number of vectors and dimension 03/09/2025, 07:48:03
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1549.43it/s]
2025-03-09 07:48:03,348 [INFO]: There are 5763 embeddings of dim 49152
2025-03-09 07:48:03,349 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0277 secs
2025-03-09 07:48:03,349 [INFO]: 	Compute estimated construction time of the index 03/09/2025, 07:48:03
2025-03-09 07:48:03,349 [INFO]: 		-> Train: 16.7 minutes
2025-03-09 07:48:03,349 [INFO]: 		-> Add: 3.2 seconds
2025-03-09 07:48:03,349 [INFO]: 		Total: 16.7 minutes
2025-03-09 07:48:03,349 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0001 secs
2025-03-09 07:48:03,349 [INFO]: 	Checking that your have enough memory available to create the index 03/09/2025, 07:48:03
2025-03-09 07:48:03,349 [INFO]: 1.2GB of memory will be needed to build the index (more might be used if you have more)
2025-03-09 07:48:03,349 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0001 secs
2025-03-09 07:48:03,349 [INFO]: 	Selecting most promising index types given data characteristics 03/09/2025, 07:48:03
2025-03-09 07:48:03,349 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-09 07:48:03,349 [INFO]: 	Creating the index 03/09/2025, 07:48:03
2025-03-09 07:48:03,349 [INFO]: 		-> Instanciate the index HNSW15 03/09/2025, 07:48:03
2025-03-09 07:48:03,350 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0011 secs
2025-03-09 07:48:03,350 [INFO]: 		-> Adding the vectors to the index 03/09/2025, 07:48:03
2025-03-09 07:48:03,350 [INFO]: The memory available for adding the vectors is 48.9GB(total available - used by the index)
2025-03-09 07:48:03,350 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/24 [00:00<?, ?it/s]  4%|▍         | 1/24 [00:00<00:02,  8.39it/s] 29%|██▉       | 7/24 [00:00<00:00, 34.59it/s] 54%|█████▍    | 13/24 [00:00<00:00, 43.60it/s] 79%|███████▉  | 19/24 [00:00<00:00, 45.04it/s]100%|██████████| 24/24 [00:05<00:00,  2.62it/s]100%|██████████| 24/24 [00:05<00:00,  4.16it/s]
2025-03-09 07:48:09,127 [INFO]: 	Computing best hyperparameters for index knn.index 03/09/2025, 07:48:09
2025-03-09 07:48:55,701 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 46.5737 secs
2025-03-09 07:48:55,701 [INFO]: The best hyperparameters are: efSearch=142
2025-03-09 07:48:55,701 [INFO]: 	Compute fast metrics 03/09/2025, 07:48:55
  0%|          | 0/4 [00:00<?, ?it/s] 50%|█████     | 2/4 [00:00<00:00, 19.18it/s] 75%|███████▌  | 3/4 [00:00<00:00, 20.67it/s]
2025-03-09 07:49:13,077 [INFO]: 	>>> Finished "Compute fast metrics" in 17.3756 secs
2025-03-09 07:49:13,078 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 69.7279 secs
2025-03-09 07:49:13,078 [INFO]: {
2025-03-09 07:49:13,078 [INFO]: 	index_key: HNSW15
2025-03-09 07:49:13,078 [INFO]: 	index_param: efSearch=142
2025-03-09 07:49:13,078 [INFO]: 	index_path: knn.index
2025-03-09 07:49:13,078 [INFO]: 	size in bytes: 1133836270
2025-03-09 07:49:13,079 [INFO]: 	avg_search_speed_ms: 8.369125585643307
2025-03-09 07:49:13,079 [INFO]: 	99p_search_speed_ms: 17.628414591308655
2025-03-09 07:49:13,079 [INFO]: 	reconstruction error %: 0.0
2025-03-09 07:49:13,079 [INFO]: 	nb vectors: 5763
2025-03-09 07:49:13,079 [INFO]: 	vectors dimension: 49152
2025-03-09 07:49:13,079 [INFO]: 	compression ratio: 0.9993082193428157
2025-03-09 07:49:13,079 [INFO]: }
2025-03-09 07:49:13,079 [INFO]: 	>>> Finished "Creating the index" in 69.7296 secs
2025-03-09 07:49:13,079 [INFO]: >>> Finished "Launching the whole pipeline" in 69.7579 secs
2025-03-09 07:49:14: [retrieval_preprocessing] calculating distances ...
2025-03-09 07:49:14: [retrieval_preprocessing] finished and saved retrieval indices for episode 37023 [episode count 13/20]
[retrieval_preprocessing] for episode 32418 [episode count 14/20], we have num_retrieval=np.int64(5378) num_query=np.int64(609)
2025-03-09 07:49:15,429 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-09 07:49:16,267 [INFO]: Launching the whole pipeline 03/09/2025, 07:49:16
2025-03-09 07:49:16,267 [INFO]: Reading total number of vectors and dimension 03/09/2025, 07:49:16
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1650.00it/s]
2025-03-09 07:49:16,295 [INFO]: There are 5378 embeddings of dim 49152
2025-03-09 07:49:16,295 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0283 secs
2025-03-09 07:49:16,295 [INFO]: 	Compute estimated construction time of the index 03/09/2025, 07:49:16
2025-03-09 07:49:16,295 [INFO]: 		-> Train: 16.7 minutes
2025-03-09 07:49:16,295 [INFO]: 		-> Add: 3.0 seconds
2025-03-09 07:49:16,295 [INFO]: 		Total: 16.7 minutes
2025-03-09 07:49:16,295 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0001 secs
2025-03-09 07:49:16,295 [INFO]: 	Checking that your have enough memory available to create the index 03/09/2025, 07:49:16
2025-03-09 07:49:16,295 [INFO]: 1.1GB of memory will be needed to build the index (more might be used if you have more)
2025-03-09 07:49:16,295 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0002 secs
2025-03-09 07:49:16,296 [INFO]: 	Selecting most promising index types given data characteristics 03/09/2025, 07:49:16
2025-03-09 07:49:16,296 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-09 07:49:16,296 [INFO]: 	Creating the index 03/09/2025, 07:49:16
2025-03-09 07:49:16,296 [INFO]: 		-> Instanciate the index HNSW15 03/09/2025, 07:49:16
2025-03-09 07:49:16,297 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0011 secs
2025-03-09 07:49:16,297 [INFO]: 		-> Adding the vectors to the index 03/09/2025, 07:49:16
2025-03-09 07:49:16,297 [INFO]: The memory available for adding the vectors is 49.0GB(total available - used by the index)
2025-03-09 07:49:16,297 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/23 [00:00<?, ?it/s]  4%|▍         | 1/23 [00:00<00:03,  5.62it/s] 30%|███       | 7/23 [00:00<00:00, 27.77it/s] 57%|█████▋    | 13/23 [00:00<00:00, 37.70it/s] 83%|████████▎ | 19/23 [00:00<00:00, 39.64it/s]100%|██████████| 23/23 [00:04<00:00,  4.73it/s]
2025-03-09 07:49:21,163 [INFO]: 	Computing best hyperparameters for index knn.index 03/09/2025, 07:49:21
2025-03-09 07:50:10,020 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 48.8568 secs
2025-03-09 07:50:10,021 [INFO]: The best hyperparameters are: efSearch=206
2025-03-09 07:50:10,021 [INFO]: 	Compute fast metrics 03/09/2025, 07:50:10
  0%|          | 0/4 [00:00<?, ?it/s] 50%|█████     | 2/4 [00:00<00:00, 19.89it/s] 75%|███████▌  | 3/4 [00:00<00:00, 19.51it/s]
2025-03-09 07:50:25,878 [INFO]: 	>>> Finished "Compute fast metrics" in 15.8570 secs
2025-03-09 07:50:25,879 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 69.5821 secs
2025-03-09 07:50:25,879 [INFO]: {
2025-03-09 07:50:25,879 [INFO]: 	index_key: HNSW15
2025-03-09 07:50:25,879 [INFO]: 	index_param: efSearch=206
2025-03-09 07:50:25,879 [INFO]: 	index_path: knn.index
2025-03-09 07:50:25,879 [INFO]: 	size in bytes: 1058089930
2025-03-09 07:50:25,879 [INFO]: 	avg_search_speed_ms: 10.322920059481534
2025-03-09 07:50:25,879 [INFO]: 	99p_search_speed_ms: 19.646144257858374
2025-03-09 07:50:25,879 [INFO]: 	reconstruction error %: 0.0
2025-03-09 07:50:25,879 [INFO]: 	nb vectors: 5378
2025-03-09 07:50:25,879 [INFO]: 	vectors dimension: 49152
2025-03-09 07:50:25,879 [INFO]: 	compression ratio: 0.9993080871679783
2025-03-09 07:50:25,879 [INFO]: }
2025-03-09 07:50:25,880 [INFO]: 	>>> Finished "Creating the index" in 69.5840 secs
2025-03-09 07:50:25,880 [INFO]: >>> Finished "Launching the whole pipeline" in 69.6130 secs
2025-03-09 07:50:28: [retrieval_preprocessing] calculating distances ...
2025-03-09 07:50:31: [retrieval_preprocessing] finished and saved retrieval indices for episode 32418 [episode count 14/20]
[retrieval_preprocessing] for episode 54050 [episode count 15/20], we have num_retrieval=np.int64(5532) num_query=np.int64(455)
2025-03-09 07:50:32,455 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-09 07:50:33,365 [INFO]: Launching the whole pipeline 03/09/2025, 07:50:33
2025-03-09 07:50:33,365 [INFO]: Reading total number of vectors and dimension 03/09/2025, 07:50:33
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1002.70it/s]
2025-03-09 07:50:33,407 [INFO]: There are 5532 embeddings of dim 49152
2025-03-09 07:50:33,407 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0419 secs
2025-03-09 07:50:33,407 [INFO]: 	Compute estimated construction time of the index 03/09/2025, 07:50:33
2025-03-09 07:50:33,408 [INFO]: 		-> Train: 16.7 minutes
2025-03-09 07:50:33,408 [INFO]: 		-> Add: 3.0 seconds
2025-03-09 07:50:33,408 [INFO]: 		Total: 16.7 minutes
2025-03-09 07:50:33,408 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0001 secs
2025-03-09 07:50:33,408 [INFO]: 	Checking that your have enough memory available to create the index 03/09/2025, 07:50:33
2025-03-09 07:50:33,408 [INFO]: 1.1GB of memory will be needed to build the index (more might be used if you have more)
2025-03-09 07:50:33,408 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0002 secs
2025-03-09 07:50:33,408 [INFO]: 	Selecting most promising index types given data characteristics 03/09/2025, 07:50:33
2025-03-09 07:50:33,408 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-09 07:50:33,408 [INFO]: 	Creating the index 03/09/2025, 07:50:33
2025-03-09 07:50:33,408 [INFO]: 		-> Instanciate the index HNSW15 03/09/2025, 07:50:33
2025-03-09 07:50:33,409 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0008 secs
2025-03-09 07:50:33,409 [INFO]: 		-> Adding the vectors to the index 03/09/2025, 07:50:33
2025-03-09 07:50:33,409 [INFO]: The memory available for adding the vectors is 49.0GB(total available - used by the index)
2025-03-09 07:50:33,409 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/23 [00:00<?, ?it/s]  4%|▍         | 1/23 [00:00<00:02,  8.42it/s] 26%|██▌       | 6/23 [00:00<00:00, 30.93it/s] 52%|█████▏    | 12/23 [00:00<00:00, 40.64it/s] 78%|███████▊  | 18/23 [00:00<00:00, 44.78it/s]100%|██████████| 23/23 [00:05<00:00,  2.53it/s]100%|██████████| 23/23 [00:05<00:00,  3.95it/s]
2025-03-09 07:50:39,233 [INFO]: 	Computing best hyperparameters for index knn.index 03/09/2025, 07:50:39
2025-03-09 07:51:23,336 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 44.1020 secs
2025-03-09 07:51:23,336 [INFO]: The best hyperparameters are: efSearch=193
2025-03-09 07:51:23,336 [INFO]: 	Compute fast metrics 03/09/2025, 07:51:23
  0%|          | 0/4 [00:00<?, ?it/s] 75%|███████▌  | 3/4 [00:00<00:00, 25.24it/s] 75%|███████▌  | 3/4 [00:00<00:00, 21.59it/s]
2025-03-09 07:51:45,247 [INFO]: 	>>> Finished "Compute fast metrics" in 21.9112 secs
2025-03-09 07:51:45,248 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 71.8391 secs
2025-03-09 07:51:45,248 [INFO]: {
2025-03-09 07:51:45,248 [INFO]: 	index_key: HNSW15
2025-03-09 07:51:45,248 [INFO]: 	index_param: efSearch=193
2025-03-09 07:51:45,248 [INFO]: 	index_path: knn.index
2025-03-09 07:51:45,248 [INFO]: 	size in bytes: 1088388670
2025-03-09 07:51:45,248 [INFO]: 	avg_search_speed_ms: 10.236960425620238
2025-03-09 07:51:45,248 [INFO]: 	99p_search_speed_ms: 18.753698319196705
2025-03-09 07:51:45,248 [INFO]: 	reconstruction error %: 0.0
2025-03-09 07:51:45,248 [INFO]: 	nb vectors: 5532
2025-03-09 07:51:45,248 [INFO]: 	vectors dimension: 49152
2025-03-09 07:51:45,248 [INFO]: 	compression ratio: 0.9993079549422359
2025-03-09 07:51:45,248 [INFO]: }
2025-03-09 07:51:45,248 [INFO]: 	>>> Finished "Creating the index" in 71.8404 secs
2025-03-09 07:51:45,248 [INFO]: >>> Finished "Launching the whole pipeline" in 71.8829 secs
2025-03-09 07:51:47: [retrieval_preprocessing] calculating distances ...
2025-03-09 07:51:49: [retrieval_preprocessing] finished and saved retrieval indices for episode 54050 [episode count 15/20]
[retrieval_preprocessing] for episode 56867 [episode count 16/20], we have num_retrieval=np.int64(5711) num_query=np.int64(276)
2025-03-09 07:51:50,059 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-09 07:51:50,954 [INFO]: Launching the whole pipeline 03/09/2025, 07:51:50
2025-03-09 07:51:50,954 [INFO]: Reading total number of vectors and dimension 03/09/2025, 07:51:50
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1717.57it/s]
2025-03-09 07:51:50,991 [INFO]: There are 5711 embeddings of dim 49152
2025-03-09 07:51:50,991 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0370 secs
2025-03-09 07:51:50,992 [INFO]: 	Compute estimated construction time of the index 03/09/2025, 07:51:50
2025-03-09 07:51:50,992 [INFO]: 		-> Train: 16.7 minutes
2025-03-09 07:51:50,992 [INFO]: 		-> Add: 3.1 seconds
2025-03-09 07:51:50,992 [INFO]: 		Total: 16.7 minutes
2025-03-09 07:51:50,992 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0002 secs
2025-03-09 07:51:50,992 [INFO]: 	Checking that your have enough memory available to create the index 03/09/2025, 07:51:50
2025-03-09 07:51:50,992 [INFO]: 1.2GB of memory will be needed to build the index (more might be used if you have more)
2025-03-09 07:51:50,992 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0002 secs
2025-03-09 07:51:50,992 [INFO]: 	Selecting most promising index types given data characteristics 03/09/2025, 07:51:50
2025-03-09 07:51:50,992 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-09 07:51:50,992 [INFO]: 	Creating the index 03/09/2025, 07:51:50
2025-03-09 07:51:50,992 [INFO]: 		-> Instanciate the index HNSW15 03/09/2025, 07:51:50
2025-03-09 07:51:50,994 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0012 secs
2025-03-09 07:51:50,994 [INFO]: 		-> Adding the vectors to the index 03/09/2025, 07:51:50
2025-03-09 07:51:50,994 [INFO]: The memory available for adding the vectors is 49.0GB(total available - used by the index)
2025-03-09 07:51:50,994 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/24 [00:00<?, ?it/s]  4%|▍         | 1/24 [00:00<00:04,  4.84it/s] 21%|██        | 5/24 [00:00<00:00, 19.06it/s] 38%|███▊      | 9/24 [00:00<00:00, 26.18it/s] 54%|█████▍    | 13/24 [00:00<00:00, 30.32it/s] 71%|███████   | 17/24 [00:00<00:00, 30.87it/s] 88%|████████▊ | 21/24 [00:05<00:01,  2.38it/s]100%|██████████| 24/24 [00:06<00:00,  2.42it/s]100%|██████████| 24/24 [00:06<00:00,  3.79it/s]
2025-03-09 07:51:57,325 [INFO]: 	Computing best hyperparameters for index knn.index 03/09/2025, 07:51:57
2025-03-09 07:52:44,380 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 47.0542 secs
2025-03-09 07:52:44,380 [INFO]: The best hyperparameters are: efSearch=187
2025-03-09 07:52:44,380 [INFO]: 	Compute fast metrics 03/09/2025, 07:52:44
  0%|          | 0/4 [00:00<?, ?it/s] 50%|█████     | 2/4 [00:00<00:00, 17.86it/s] 75%|███████▌  | 3/4 [00:00<00:00, 19.96it/s]
2025-03-09 07:53:00,258 [INFO]: 	>>> Finished "Compute fast metrics" in 15.8777 secs
2025-03-09 07:53:00,259 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 69.2654 secs
2025-03-09 07:53:00,259 [INFO]: {
2025-03-09 07:53:00,259 [INFO]: 	index_key: HNSW15
2025-03-09 07:53:00,259 [INFO]: 	index_param: efSearch=187
2025-03-09 07:53:00,259 [INFO]: 	index_path: knn.index
2025-03-09 07:53:00,259 [INFO]: 	size in bytes: 1123605670
2025-03-09 07:53:00,259 [INFO]: 	avg_search_speed_ms: 9.463468045366323
2025-03-09 07:53:00,259 [INFO]: 	99p_search_speed_ms: 20.99087341688578
2025-03-09 07:53:00,259 [INFO]: 	reconstruction error %: 0.0
2025-03-09 07:53:00,259 [INFO]: 	nb vectors: 5711
2025-03-09 07:53:00,259 [INFO]: 	vectors dimension: 49152
2025-03-09 07:53:00,259 [INFO]: 	compression ratio: 0.9993081362788068
2025-03-09 07:53:00,259 [INFO]: }
2025-03-09 07:53:00,259 [INFO]: 	>>> Finished "Creating the index" in 69.2671 secs
2025-03-09 07:53:00,259 [INFO]: >>> Finished "Launching the whole pipeline" in 69.3050 secs
2025-03-09 07:53:01: [retrieval_preprocessing] calculating distances ...
2025-03-09 07:53:02: [retrieval_preprocessing] finished and saved retrieval indices for episode 56867 [episode count 16/20]
[retrieval_preprocessing] for episode 85158 [episode count 17/20], we have num_retrieval=np.int64(5689) num_query=np.int64(298)
2025-03-09 07:53:03,272 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-09 07:53:04,013 [INFO]: Launching the whole pipeline 03/09/2025, 07:53:04
2025-03-09 07:53:04,013 [INFO]: Reading total number of vectors and dimension 03/09/2025, 07:53:04
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1289.36it/s]
2025-03-09 07:53:04,041 [INFO]: There are 5689 embeddings of dim 49152
2025-03-09 07:53:04,041 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0285 secs
2025-03-09 07:53:04,041 [INFO]: 	Compute estimated construction time of the index 03/09/2025, 07:53:04
2025-03-09 07:53:04,041 [INFO]: 		-> Train: 16.7 minutes
2025-03-09 07:53:04,041 [INFO]: 		-> Add: 3.1 seconds
2025-03-09 07:53:04,041 [INFO]: 		Total: 16.7 minutes
2025-03-09 07:53:04,041 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0001 secs
2025-03-09 07:53:04,041 [INFO]: 	Checking that your have enough memory available to create the index 03/09/2025, 07:53:04
2025-03-09 07:53:04,041 [INFO]: 1.1GB of memory will be needed to build the index (more might be used if you have more)
2025-03-09 07:53:04,042 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0001 secs
2025-03-09 07:53:04,042 [INFO]: 	Selecting most promising index types given data characteristics 03/09/2025, 07:53:04
2025-03-09 07:53:04,042 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-09 07:53:04,042 [INFO]: 	Creating the index 03/09/2025, 07:53:04
2025-03-09 07:53:04,042 [INFO]: 		-> Instanciate the index HNSW15 03/09/2025, 07:53:04
2025-03-09 07:53:04,043 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0009 secs
2025-03-09 07:53:04,043 [INFO]: 		-> Adding the vectors to the index 03/09/2025, 07:53:04
2025-03-09 07:53:04,043 [INFO]: The memory available for adding the vectors is 49.0GB(total available - used by the index)
2025-03-09 07:53:04,043 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/24 [00:00<?, ?it/s]  4%|▍         | 1/24 [00:00<00:03,  7.25it/s] 29%|██▉       | 7/24 [00:00<00:00, 31.40it/s] 54%|█████▍    | 13/24 [00:00<00:00, 40.13it/s] 79%|███████▉  | 19/24 [00:00<00:00, 44.45it/s]100%|██████████| 24/24 [00:05<00:00,  2.66it/s]100%|██████████| 24/24 [00:05<00:00,  4.20it/s]
2025-03-09 07:53:09,756 [INFO]: 	Computing best hyperparameters for index knn.index 03/09/2025, 07:53:09
2025-03-09 07:53:57,341 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 47.5847 secs
2025-03-09 07:53:57,341 [INFO]: The best hyperparameters are: efSearch=163
2025-03-09 07:53:57,341 [INFO]: 	Compute fast metrics 03/09/2025, 07:53:57
  0%|          | 0/4 [00:00<?, ?it/s] 50%|█████     | 2/4 [00:00<00:00, 18.19it/s] 75%|███████▌  | 3/4 [00:00<00:00, 19.89it/s]
2025-03-09 07:54:15,775 [INFO]: 	>>> Finished "Compute fast metrics" in 18.4338 secs
2025-03-09 07:54:15,776 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 71.7329 secs
2025-03-09 07:54:15,776 [INFO]: {
2025-03-09 07:54:15,776 [INFO]: 	index_key: HNSW15
2025-03-09 07:54:15,776 [INFO]: 	index_param: efSearch=163
2025-03-09 07:54:15,776 [INFO]: 	index_path: knn.index
2025-03-09 07:54:15,776 [INFO]: 	size in bytes: 1119277330
2025-03-09 07:54:15,776 [INFO]: 	avg_search_speed_ms: 8.394804067079269
2025-03-09 07:54:15,776 [INFO]: 	99p_search_speed_ms: 20.83445959724485
2025-03-09 07:54:15,776 [INFO]: 	reconstruction error %: 0.0
2025-03-09 07:54:15,776 [INFO]: 	nb vectors: 5689
2025-03-09 07:54:15,776 [INFO]: 	vectors dimension: 49152
2025-03-09 07:54:15,776 [INFO]: 	compression ratio: 0.9993081089206015
2025-03-09 07:54:15,776 [INFO]: }
2025-03-09 07:54:15,776 [INFO]: 	>>> Finished "Creating the index" in 71.7342 secs
2025-03-09 07:54:15,776 [INFO]: >>> Finished "Launching the whole pipeline" in 71.7633 secs
2025-03-09 07:54:16: [retrieval_preprocessing] calculating distances ...
2025-03-09 07:54:18: [retrieval_preprocessing] finished and saved retrieval indices for episode 85158 [episode count 17/20]
[retrieval_preprocessing] for episode 19500 [episode count 18/20], we have num_retrieval=np.int64(5701) num_query=np.int64(286)
2025-03-09 07:54:18,709 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-09 07:54:19,602 [INFO]: Launching the whole pipeline 03/09/2025, 07:54:19
2025-03-09 07:54:19,602 [INFO]: Reading total number of vectors and dimension 03/09/2025, 07:54:19
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1993.49it/s]
2025-03-09 07:54:19,633 [INFO]: There are 5701 embeddings of dim 49152
2025-03-09 07:54:19,633 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0312 secs
2025-03-09 07:54:19,633 [INFO]: 	Compute estimated construction time of the index 03/09/2025, 07:54:19
2025-03-09 07:54:19,634 [INFO]: 		-> Train: 16.7 minutes
2025-03-09 07:54:19,634 [INFO]: 		-> Add: 3.1 seconds
2025-03-09 07:54:19,634 [INFO]: 		Total: 16.7 minutes
2025-03-09 07:54:19,634 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0006 secs
2025-03-09 07:54:19,634 [INFO]: 	Checking that your have enough memory available to create the index 03/09/2025, 07:54:19
2025-03-09 07:54:19,634 [INFO]: 1.1GB of memory will be needed to build the index (more might be used if you have more)
2025-03-09 07:54:19,635 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0005 secs
2025-03-09 07:54:19,635 [INFO]: 	Selecting most promising index types given data characteristics 03/09/2025, 07:54:19
2025-03-09 07:54:19,635 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-09 07:54:19,635 [INFO]: 	Creating the index 03/09/2025, 07:54:19
2025-03-09 07:54:19,635 [INFO]: 		-> Instanciate the index HNSW15 03/09/2025, 07:54:19
2025-03-09 07:54:19,638 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0029 secs
2025-03-09 07:54:19,639 [INFO]: 		-> Adding the vectors to the index 03/09/2025, 07:54:19
2025-03-09 07:54:19,639 [INFO]: The memory available for adding the vectors is 49.0GB(total available - used by the index)
2025-03-09 07:54:19,639 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/24 [00:00<?, ?it/s]  8%|▊         | 2/24 [00:00<00:01, 16.70it/s] 29%|██▉       | 7/24 [00:00<00:00, 32.05it/s] 46%|████▌     | 11/24 [00:00<00:00, 32.84it/s] 71%|███████   | 17/24 [00:00<00:00, 40.76it/s] 92%|█████████▏| 22/24 [00:04<00:00,  3.08it/s]100%|██████████| 24/24 [00:05<00:00,  4.04it/s]
2025-03-09 07:54:25,579 [INFO]: 	Computing best hyperparameters for index knn.index 03/09/2025, 07:54:25
2025-03-09 07:55:17,276 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 51.6964 secs
2025-03-09 07:55:17,276 [INFO]: The best hyperparameters are: efSearch=175
2025-03-09 07:55:17,276 [INFO]: 	Compute fast metrics 03/09/2025, 07:55:17
  0%|          | 0/4 [00:00<?, ?it/s] 50%|█████     | 2/4 [00:00<00:00, 17.59it/s] 75%|███████▌  | 3/4 [00:00<00:00, 19.40it/s]
2025-03-09 07:55:31,060 [INFO]: 	>>> Finished "Compute fast metrics" in 13.7838 secs
2025-03-09 07:55:31,061 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 71.4220 secs
2025-03-09 07:55:31,061 [INFO]: {
2025-03-09 07:55:31,061 [INFO]: 	index_key: HNSW15
2025-03-09 07:55:31,061 [INFO]: 	index_param: efSearch=175
2025-03-09 07:55:31,061 [INFO]: 	index_path: knn.index
2025-03-09 07:55:31,061 [INFO]: 	size in bytes: 1121638270
2025-03-09 07:55:31,061 [INFO]: 	avg_search_speed_ms: 9.974667378808052
2025-03-09 07:55:31,061 [INFO]: 	99p_search_speed_ms: 21.28217712510377
2025-03-09 07:55:31,061 [INFO]: 	reconstruction error %: 0.0
2025-03-09 07:55:31,061 [INFO]: 	nb vectors: 5701
2025-03-09 07:55:31,061 [INFO]: 	vectors dimension: 49152
2025-03-09 07:55:31,061 [INFO]: 	compression ratio: 0.9993080995711746
2025-03-09 07:55:31,061 [INFO]: }
2025-03-09 07:55:31,061 [INFO]: 	>>> Finished "Creating the index" in 71.4258 secs
2025-03-09 07:55:31,061 [INFO]: >>> Finished "Launching the whole pipeline" in 71.4596 secs
2025-03-09 07:55:33: [retrieval_preprocessing] calculating distances ...
2025-03-09 07:55:34: [retrieval_preprocessing] finished and saved retrieval indices for episode 19500 [episode count 18/20]
[retrieval_preprocessing] for episode 35121 [episode count 19/20], we have num_retrieval=np.int64(5703) num_query=np.int64(284)
2025-03-09 07:55:35,764 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-09 07:55:36,679 [INFO]: Launching the whole pipeline 03/09/2025, 07:55:36
2025-03-09 07:55:36,679 [INFO]: Reading total number of vectors and dimension 03/09/2025, 07:55:36
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1392.99it/s]
2025-03-09 07:55:36,710 [INFO]: There are 5703 embeddings of dim 49152
2025-03-09 07:55:36,711 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0319 secs
2025-03-09 07:55:36,711 [INFO]: 	Compute estimated construction time of the index 03/09/2025, 07:55:36
2025-03-09 07:55:36,711 [INFO]: 		-> Train: 16.7 minutes
2025-03-09 07:55:36,711 [INFO]: 		-> Add: 3.1 seconds
2025-03-09 07:55:36,711 [INFO]: 		Total: 16.7 minutes
2025-03-09 07:55:36,711 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0001 secs
2025-03-09 07:55:36,711 [INFO]: 	Checking that your have enough memory available to create the index 03/09/2025, 07:55:36
2025-03-09 07:55:36,711 [INFO]: 1.1GB of memory will be needed to build the index (more might be used if you have more)
2025-03-09 07:55:36,711 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0002 secs
2025-03-09 07:55:36,711 [INFO]: 	Selecting most promising index types given data characteristics 03/09/2025, 07:55:36
2025-03-09 07:55:36,711 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-09 07:55:36,711 [INFO]: 	Creating the index 03/09/2025, 07:55:36
2025-03-09 07:55:36,711 [INFO]: 		-> Instanciate the index HNSW15 03/09/2025, 07:55:36
2025-03-09 07:55:36,713 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0013 secs
2025-03-09 07:55:36,713 [INFO]: 		-> Adding the vectors to the index 03/09/2025, 07:55:36
2025-03-09 07:55:36,713 [INFO]: The memory available for adding the vectors is 49.0GB(total available - used by the index)
2025-03-09 07:55:36,713 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/24 [00:00<?, ?it/s]  4%|▍         | 1/24 [00:00<00:03,  7.15it/s] 29%|██▉       | 7/24 [00:00<00:00, 30.62it/s] 54%|█████▍    | 13/24 [00:00<00:00, 41.72it/s] 79%|███████▉  | 19/24 [00:00<00:00, 47.65it/s]100%|██████████| 24/24 [00:05<00:00,  2.84it/s]100%|██████████| 24/24 [00:05<00:00,  4.48it/s]
2025-03-09 07:55:42,075 [INFO]: 	Computing best hyperparameters for index knn.index 03/09/2025, 07:55:42
2025-03-09 07:56:28,192 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 46.1161 secs
2025-03-09 07:56:28,192 [INFO]: The best hyperparameters are: efSearch=189
2025-03-09 07:56:28,192 [INFO]: 	Compute fast metrics 03/09/2025, 07:56:28
  0%|          | 0/4 [00:00<?, ?it/s] 50%|█████     | 2/4 [00:00<00:00, 19.61it/s] 75%|███████▌  | 3/4 [00:00<00:00, 20.74it/s]
2025-03-09 07:56:48,001 [INFO]: 	>>> Finished "Compute fast metrics" in 19.8094 secs
2025-03-09 07:56:48,002 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 71.2895 secs
2025-03-09 07:56:48,003 [INFO]: {
2025-03-09 07:56:48,003 [INFO]: 	index_key: HNSW15
2025-03-09 07:56:48,003 [INFO]: 	index_param: efSearch=189
2025-03-09 07:56:48,003 [INFO]: 	index_path: knn.index
2025-03-09 07:56:48,003 [INFO]: 	size in bytes: 1122031750
2025-03-09 07:56:48,003 [INFO]: 	avg_search_speed_ms: 9.885514780820122
2025-03-09 07:56:48,003 [INFO]: 	99p_search_speed_ms: 20.707903681322932
2025-03-09 07:56:48,003 [INFO]: 	reconstruction error %: 0.0
2025-03-09 07:56:48,003 [INFO]: 	nb vectors: 5703
2025-03-09 07:56:48,003 [INFO]: 	vectors dimension: 49152
2025-03-09 07:56:48,003 [INFO]: 	compression ratio: 0.9993081069229993
2025-03-09 07:56:48,003 [INFO]: }
2025-03-09 07:56:48,003 [INFO]: 	>>> Finished "Creating the index" in 71.2912 secs
2025-03-09 07:56:48,003 [INFO]: >>> Finished "Launching the whole pipeline" in 71.3239 secs
2025-03-09 07:56:49: [retrieval_preprocessing] calculating distances ...
2025-03-09 07:56:49: [retrieval_preprocessing] finished and saved retrieval indices for episode 35121 [episode count 19/20]
2025-03-09 07:56:49: [retrieval_preprocessing] finished for (4400212150, 'marker') [chosen_id count 2/10]
2025-03-09 07:56:52: [retrieval_preprocessing] concatenated all embeddings and indices for 20 episodes for (1526685371, 'marker') [chosen_id count 3/10]
2025-03-09 07:56:52: [retrieval_preprocessing] we have num_total=8662 embedding_dim=49152
[retrieval_preprocessing] for episode 8705 [episode count 0/20], we have num_retrieval=np.int64(8340) num_query=np.int64(322)
2025-03-09 07:56:52,623 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-09 07:56:53,537 [INFO]: Launching the whole pipeline 03/09/2025, 07:56:53
2025-03-09 07:56:53,537 [INFO]: Reading total number of vectors and dimension 03/09/2025, 07:56:53
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1233.62it/s]
2025-03-09 07:56:53,564 [INFO]: There are 8340 embeddings of dim 49152
2025-03-09 07:56:53,564 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0274 secs
2025-03-09 07:56:53,565 [INFO]: 	Compute estimated construction time of the index 03/09/2025, 07:56:53
2025-03-09 07:56:53,565 [INFO]: 		-> Train: 16.7 minutes
2025-03-09 07:56:53,565 [INFO]: 		-> Add: 4.6 seconds
2025-03-09 07:56:53,565 [INFO]: 		Total: 16.7 minutes
2025-03-09 07:56:53,565 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0003 secs
2025-03-09 07:56:53,565 [INFO]: 	Checking that your have enough memory available to create the index 03/09/2025, 07:56:53
2025-03-09 07:56:53,565 [INFO]: 1.7GB of memory will be needed to build the index (more might be used if you have more)
2025-03-09 07:56:53,566 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0004 secs
2025-03-09 07:56:53,566 [INFO]: 	Selecting most promising index types given data characteristics 03/09/2025, 07:56:53
2025-03-09 07:56:53,566 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-09 07:56:53,566 [INFO]: 	Creating the index 03/09/2025, 07:56:53
2025-03-09 07:56:53,567 [INFO]: 		-> Instanciate the index HNSW15 03/09/2025, 07:56:53
2025-03-09 07:56:53,569 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0026 secs
2025-03-09 07:56:53,569 [INFO]: 		-> Adding the vectors to the index 03/09/2025, 07:56:53
2025-03-09 07:56:53,570 [INFO]: The memory available for adding the vectors is 48.5GB(total available - used by the index)
2025-03-09 07:56:53,570 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/34 [00:00<?, ?it/s]  6%|▌         | 2/34 [00:00<00:01, 17.15it/s] 24%|██▎       | 8/34 [00:00<00:00, 40.17it/s] 41%|████      | 14/34 [00:00<00:00, 48.07it/s] 59%|█████▉    | 20/34 [00:00<00:00, 52.18it/s] 76%|███████▋  | 26/34 [00:04<00:01,  4.15it/s] 94%|█████████▍| 32/34 [00:04<00:00,  6.15it/s]100%|██████████| 34/34 [00:07<00:00,  4.59it/s]
2025-03-09 07:57:00,985 [INFO]: 	Computing best hyperparameters for index knn.index 03/09/2025, 07:57:00
2025-03-09 07:58:02,917 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 61.9315 secs
2025-03-09 07:58:02,918 [INFO]: The best hyperparameters are: efSearch=232
2025-03-09 07:58:02,918 [INFO]: 	Compute fast metrics 03/09/2025, 07:58:02
  0%|          | 0/4 [00:00<?, ?it/s] 50%|█████     | 2/4 [00:00<00:00, 16.89it/s] 75%|███████▌  | 3/4 [00:00<00:00, 16.94it/s]
2025-03-09 07:58:19,957 [INFO]: 	>>> Finished "Compute fast metrics" in 17.0391 secs
2025-03-09 07:58:19,959 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 86.3892 secs
2025-03-09 07:58:19,959 [INFO]: {
2025-03-09 07:58:19,959 [INFO]: 	index_key: HNSW15
2025-03-09 07:58:19,959 [INFO]: 	index_param: efSearch=232
2025-03-09 07:58:19,959 [INFO]: 	index_path: knn.index
2025-03-09 07:58:19,959 [INFO]: 	size in bytes: 1640845630
2025-03-09 07:58:19,959 [INFO]: 	avg_search_speed_ms: 12.083151324872594
2025-03-09 07:58:19,959 [INFO]: 	99p_search_speed_ms: 28.058600130025305
2025-03-09 07:58:19,959 [INFO]: 	reconstruction error %: 0.0
2025-03-09 07:58:19,959 [INFO]: 	nb vectors: 8340
2025-03-09 07:58:19,959 [INFO]: 	vectors dimension: 49152
2025-03-09 07:58:19,959 [INFO]: 	compression ratio: 0.9993083383474654
2025-03-09 07:58:19,959 [INFO]: }
2025-03-09 07:58:19,959 [INFO]: 	>>> Finished "Creating the index" in 86.3927 secs
2025-03-09 07:58:19,959 [INFO]: >>> Finished "Launching the whole pipeline" in 86.4220 secs
2025-03-09 07:58:22: [retrieval_preprocessing] calculating distances ...
2025-03-09 07:58:23: [retrieval_preprocessing] finished and saved retrieval indices for episode 8705 [episode count 0/20]
[retrieval_preprocessing] for episode 82818 [episode count 1/20], we have num_retrieval=np.int64(8221) num_query=np.int64(441)
2025-03-09 07:58:24,358 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-09 07:58:25,712 [INFO]: Launching the whole pipeline 03/09/2025, 07:58:25
2025-03-09 07:58:25,713 [INFO]: Reading total number of vectors and dimension 03/09/2025, 07:58:25
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1340.03it/s]
2025-03-09 07:58:25,744 [INFO]: There are 8221 embeddings of dim 49152
2025-03-09 07:58:25,744 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0313 secs
2025-03-09 07:58:25,744 [INFO]: 	Compute estimated construction time of the index 03/09/2025, 07:58:25
2025-03-09 07:58:25,744 [INFO]: 		-> Train: 16.7 minutes
2025-03-09 07:58:25,744 [INFO]: 		-> Add: 4.5 seconds
2025-03-09 07:58:25,744 [INFO]: 		Total: 16.7 minutes
2025-03-09 07:58:25,745 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0003 secs
2025-03-09 07:58:25,745 [INFO]: 	Checking that your have enough memory available to create the index 03/09/2025, 07:58:25
2025-03-09 07:58:25,745 [INFO]: 1.7GB of memory will be needed to build the index (more might be used if you have more)
2025-03-09 07:58:25,745 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0005 secs
2025-03-09 07:58:25,745 [INFO]: 	Selecting most promising index types given data characteristics 03/09/2025, 07:58:25
2025-03-09 07:58:25,746 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-09 07:58:25,746 [INFO]: 	Creating the index 03/09/2025, 07:58:25
2025-03-09 07:58:25,746 [INFO]: 		-> Instanciate the index HNSW15 03/09/2025, 07:58:25
2025-03-09 07:58:25,749 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0029 secs
2025-03-09 07:58:25,749 [INFO]: 		-> Adding the vectors to the index 03/09/2025, 07:58:25
2025-03-09 07:58:25,749 [INFO]: The memory available for adding the vectors is 48.5GB(total available - used by the index)
2025-03-09 07:58:25,749 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/34 [00:00<?, ?it/s]  3%|▎         | 1/34 [00:00<00:03,  9.94it/s] 18%|█▊        | 6/34 [00:00<00:00, 32.80it/s] 32%|███▏      | 11/34 [00:00<00:00, 40.13it/s] 47%|████▋     | 16/34 [00:00<00:00, 43.49it/s] 62%|██████▏   | 21/34 [00:04<00:04,  2.86it/s] 79%|███████▉  | 27/34 [00:04<00:01,  4.59it/s] 97%|█████████▋| 33/34 [00:04<00:00,  6.90it/s]100%|██████████| 34/34 [00:08<00:00,  4.20it/s]
2025-03-09 07:58:34,236 [INFO]: 	Computing best hyperparameters for index knn.index 03/09/2025, 07:58:34
2025-03-09 07:59:32,165 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 57.9290 secs
2025-03-09 07:59:32,166 [INFO]: The best hyperparameters are: efSearch=142
2025-03-09 07:59:32,166 [INFO]: 	Compute fast metrics 03/09/2025, 07:59:32
  0%|          | 0/4 [00:00<?, ?it/s] 50%|█████     | 2/4 [00:00<00:00, 18.86it/s] 75%|███████▌  | 3/4 [00:00<00:00, 20.32it/s]
2025-03-09 08:00:00,410 [INFO]: 	>>> Finished "Compute fast metrics" in 28.2445 secs
2025-03-09 08:00:01,128 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 95.3783 secs
2025-03-09 08:00:01,128 [INFO]: {
2025-03-09 08:00:01,128 [INFO]: 	index_key: HNSW15
2025-03-09 08:00:01,128 [INFO]: 	index_param: efSearch=142
2025-03-09 08:00:01,128 [INFO]: 	index_path: knn.index
2025-03-09 08:00:01,128 [INFO]: 	size in bytes: 1617433330
2025-03-09 08:00:01,128 [INFO]: 	avg_search_speed_ms: 9.480428823239007
2025-03-09 08:00:01,128 [INFO]: 	99p_search_speed_ms: 22.925822483375672
2025-03-09 08:00:01,128 [INFO]: 	reconstruction error %: 0.0
2025-03-09 08:00:01,128 [INFO]: 	nb vectors: 8221
2025-03-09 08:00:01,128 [INFO]: 	vectors dimension: 49152
2025-03-09 08:00:01,128 [INFO]: 	compression ratio: 0.9993081866317173
2025-03-09 08:00:01,128 [INFO]: }
2025-03-09 08:00:01,129 [INFO]: 	>>> Finished "Creating the index" in 95.3828 secs
2025-03-09 08:00:01,129 [INFO]: >>> Finished "Launching the whole pipeline" in 95.4160 secs
2025-03-09 08:00:02: [retrieval_preprocessing] calculating distances ...
2025-03-09 08:00:04: [retrieval_preprocessing] finished and saved retrieval indices for episode 82818 [episode count 1/20]
[retrieval_preprocessing] for episode 3337 [episode count 2/20], we have num_retrieval=np.int64(8328) num_query=np.int64(334)
2025-03-09 08:00:04,862 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-09 08:00:05,998 [INFO]: Launching the whole pipeline 03/09/2025, 08:00:05
2025-03-09 08:00:05,998 [INFO]: Reading total number of vectors and dimension 03/09/2025, 08:00:05
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1467.57it/s]
2025-03-09 08:00:06,024 [INFO]: There are 8328 embeddings of dim 49152
2025-03-09 08:00:06,024 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0261 secs
2025-03-09 08:00:06,024 [INFO]: 	Compute estimated construction time of the index 03/09/2025, 08:00:06
2025-03-09 08:00:06,025 [INFO]: 		-> Train: 16.7 minutes
2025-03-09 08:00:06,025 [INFO]: 		-> Add: 4.6 seconds
2025-03-09 08:00:06,025 [INFO]: 		Total: 16.7 minutes
2025-03-09 08:00:06,025 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0001 secs
2025-03-09 08:00:06,025 [INFO]: 	Checking that your have enough memory available to create the index 03/09/2025, 08:00:06
2025-03-09 08:00:06,025 [INFO]: 1.7GB of memory will be needed to build the index (more might be used if you have more)
2025-03-09 08:00:06,025 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0001 secs
2025-03-09 08:00:06,025 [INFO]: 	Selecting most promising index types given data characteristics 03/09/2025, 08:00:06
2025-03-09 08:00:06,025 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-09 08:00:06,025 [INFO]: 	Creating the index 03/09/2025, 08:00:06
2025-03-09 08:00:06,025 [INFO]: 		-> Instanciate the index HNSW15 03/09/2025, 08:00:06
2025-03-09 08:00:06,026 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0010 secs
2025-03-09 08:00:06,026 [INFO]: 		-> Adding the vectors to the index 03/09/2025, 08:00:06
2025-03-09 08:00:06,026 [INFO]: The memory available for adding the vectors is 48.5GB(total available - used by the index)
2025-03-09 08:00:06,026 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/34 [00:00<?, ?it/s]  3%|▎         | 1/34 [00:00<00:04,  7.20it/s] 18%|█▊        | 6/34 [00:00<00:01, 27.35it/s] 32%|███▏      | 11/34 [00:00<00:00, 33.22it/s] 47%|████▋     | 16/34 [00:00<00:00, 36.62it/s] 62%|██████▏   | 21/34 [00:04<00:03,  3.43it/s] 79%|███████▉  | 27/34 [00:04<00:01,  5.48it/s] 97%|█████████▋| 33/34 [00:04<00:00,  8.16it/s]100%|██████████| 34/34 [00:07<00:00,  4.62it/s]
2025-03-09 08:00:13,393 [INFO]: 	Computing best hyperparameters for index knn.index 03/09/2025, 08:00:13
2025-03-09 08:01:14,492 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 61.0985 secs
2025-03-09 08:01:14,492 [INFO]: The best hyperparameters are: efSearch=185
2025-03-09 08:01:14,492 [INFO]: 	Compute fast metrics 03/09/2025, 08:01:14
  0%|          | 0/4 [00:00<?, ?it/s] 25%|██▌       | 1/4 [00:00<00:00,  8.48it/s] 75%|███████▌  | 3/4 [00:00<00:00, 15.02it/s]
2025-03-09 08:01:42,013 [INFO]: 	>>> Finished "Compute fast metrics" in 27.5213 secs
2025-03-09 08:01:42,016 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 95.9901 secs
2025-03-09 08:01:42,016 [INFO]: {
2025-03-09 08:01:42,016 [INFO]: 	index_key: HNSW15
2025-03-09 08:01:42,016 [INFO]: 	index_param: efSearch=185
2025-03-09 08:01:42,016 [INFO]: 	index_path: knn.index
2025-03-09 08:01:42,016 [INFO]: 	size in bytes: 1638484750
2025-03-09 08:01:42,016 [INFO]: 	avg_search_speed_ms: 11.069185287223931
2025-03-09 08:01:42,016 [INFO]: 	99p_search_speed_ms: 29.491488614585258
2025-03-09 08:01:42,016 [INFO]: 	reconstruction error %: 0.0
2025-03-09 08:01:42,017 [INFO]: 	nb vectors: 8328
2025-03-09 08:01:42,017 [INFO]: 	vectors dimension: 49152
2025-03-09 08:01:42,017 [INFO]: 	compression ratio: 0.9993083084844091
2025-03-09 08:01:42,017 [INFO]: }
2025-03-09 08:01:42,017 [INFO]: 	>>> Finished "Creating the index" in 95.9917 secs
2025-03-09 08:01:42,017 [INFO]: >>> Finished "Launching the whole pipeline" in 96.0184 secs
2025-03-09 08:01:44: [retrieval_preprocessing] calculating distances ...
2025-03-09 08:01:45: [retrieval_preprocessing] finished and saved retrieval indices for episode 3337 [episode count 2/20]
[retrieval_preprocessing] for episode 74762 [episode count 3/20], we have num_retrieval=np.int64(7219) num_query=np.int64(1443)
2025-03-09 08:01:45,887 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-09 08:01:46,912 [INFO]: Launching the whole pipeline 03/09/2025, 08:01:46
2025-03-09 08:01:46,912 [INFO]: Reading total number of vectors and dimension 03/09/2025, 08:01:46
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1258.79it/s]
2025-03-09 08:01:46,935 [INFO]: There are 7219 embeddings of dim 49152
2025-03-09 08:01:46,935 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0230 secs
2025-03-09 08:01:46,935 [INFO]: 	Compute estimated construction time of the index 03/09/2025, 08:01:46
2025-03-09 08:01:46,935 [INFO]: 		-> Train: 16.7 minutes
2025-03-09 08:01:46,935 [INFO]: 		-> Add: 4.0 seconds
2025-03-09 08:01:46,935 [INFO]: 		Total: 16.7 minutes
2025-03-09 08:01:46,935 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0001 secs
2025-03-09 08:01:46,935 [INFO]: 	Checking that your have enough memory available to create the index 03/09/2025, 08:01:46
2025-03-09 08:01:46,935 [INFO]: 1.5GB of memory will be needed to build the index (more might be used if you have more)
2025-03-09 08:01:46,935 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0001 secs
2025-03-09 08:01:46,935 [INFO]: 	Selecting most promising index types given data characteristics 03/09/2025, 08:01:46
2025-03-09 08:01:46,935 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-09 08:01:46,935 [INFO]: 	Creating the index 03/09/2025, 08:01:46
2025-03-09 08:01:46,935 [INFO]: 		-> Instanciate the index HNSW15 03/09/2025, 08:01:46
2025-03-09 08:01:46,936 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0009 secs
2025-03-09 08:01:46,936 [INFO]: 		-> Adding the vectors to the index 03/09/2025, 08:01:46
2025-03-09 08:01:46,936 [INFO]: The memory available for adding the vectors is 48.7GB(total available - used by the index)
2025-03-09 08:01:46,936 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/30 [00:00<?, ?it/s]  3%|▎         | 1/30 [00:00<00:03,  9.23it/s] 23%|██▎       | 7/30 [00:00<00:00, 35.48it/s] 43%|████▎     | 13/30 [00:00<00:00, 45.66it/s] 60%|██████    | 18/30 [00:00<00:00, 42.25it/s] 77%|███████▋  | 23/30 [00:04<00:02,  3.43it/s] 97%|█████████▋| 29/30 [00:04<00:00,  5.37it/s]100%|██████████| 30/30 [00:06<00:00,  4.44it/s]
2025-03-09 08:01:53,695 [INFO]: 	Computing best hyperparameters for index knn.index 03/09/2025, 08:01:53
2025-03-09 08:02:49,992 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 56.2964 secs
2025-03-09 08:02:49,992 [INFO]: The best hyperparameters are: efSearch=207
2025-03-09 08:02:49,992 [INFO]: 	Compute fast metrics 03/09/2025, 08:02:49
  0%|          | 0/4 [00:00<?, ?it/s] 50%|█████     | 2/4 [00:00<00:00, 16.66it/s] 75%|███████▌  | 3/4 [00:00<00:00, 17.47it/s]
2025-03-09 08:03:10,449 [INFO]: 	>>> Finished "Compute fast metrics" in 20.4561 secs
2025-03-09 08:03:10,450 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 83.5140 secs
2025-03-09 08:03:10,451 [INFO]: {
2025-03-09 08:03:10,451 [INFO]: 	index_key: HNSW15
2025-03-09 08:03:10,451 [INFO]: 	index_param: efSearch=207
2025-03-09 08:03:10,451 [INFO]: 	index_path: knn.index
2025-03-09 08:03:10,451 [INFO]: 	size in bytes: 1420295710
2025-03-09 08:03:10,451 [INFO]: 	avg_search_speed_ms: 11.709747278454344
2025-03-09 08:03:10,451 [INFO]: 	99p_search_speed_ms: 24.256402880419074
2025-03-09 08:03:10,451 [INFO]: 	reconstruction error %: 0.0
2025-03-09 08:03:10,451 [INFO]: 	nb vectors: 7219
2025-03-09 08:03:10,451 [INFO]: 	vectors dimension: 49152
2025-03-09 08:03:10,451 [INFO]: 	compression ratio: 0.9993082018110159
2025-03-09 08:03:10,451 [INFO]: }
2025-03-09 08:03:10,451 [INFO]: 	>>> Finished "Creating the index" in 83.5154 secs
2025-03-09 08:03:10,451 [INFO]: >>> Finished "Launching the whole pipeline" in 83.5390 secs
2025-03-09 08:03:18: [retrieval_preprocessing] calculating distances ...
2025-03-09 08:03:24: [retrieval_preprocessing] finished and saved retrieval indices for episode 74762 [episode count 3/20]
[retrieval_preprocessing] for episode 55819 [episode count 4/20], we have num_retrieval=np.int64(8151) num_query=np.int64(511)
2025-03-09 08:03:24,894 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-09 08:03:26,041 [INFO]: Launching the whole pipeline 03/09/2025, 08:03:26
2025-03-09 08:03:26,041 [INFO]: Reading total number of vectors and dimension 03/09/2025, 08:03:26
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1425.66it/s]
2025-03-09 08:03:26,070 [INFO]: There are 8151 embeddings of dim 49152
2025-03-09 08:03:26,071 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0298 secs
2025-03-09 08:03:26,071 [INFO]: 	Compute estimated construction time of the index 03/09/2025, 08:03:26
2025-03-09 08:03:26,071 [INFO]: 		-> Train: 16.7 minutes
2025-03-09 08:03:26,071 [INFO]: 		-> Add: 4.5 seconds
2025-03-09 08:03:26,072 [INFO]: 		Total: 16.7 minutes
2025-03-09 08:03:26,072 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0006 secs
2025-03-09 08:03:26,072 [INFO]: 	Checking that your have enough memory available to create the index 03/09/2025, 08:03:26
2025-03-09 08:03:26,072 [INFO]: 1.6GB of memory will be needed to build the index (more might be used if you have more)
2025-03-09 08:03:26,073 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0005 secs
2025-03-09 08:03:26,073 [INFO]: 	Selecting most promising index types given data characteristics 03/09/2025, 08:03:26
2025-03-09 08:03:26,073 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-09 08:03:26,073 [INFO]: 	Creating the index 03/09/2025, 08:03:26
2025-03-09 08:03:26,074 [INFO]: 		-> Instanciate the index HNSW15 03/09/2025, 08:03:26
2025-03-09 08:03:26,076 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0025 secs
2025-03-09 08:03:26,077 [INFO]: 		-> Adding the vectors to the index 03/09/2025, 08:03:26
2025-03-09 08:03:26,077 [INFO]: The memory available for adding the vectors is 48.5GB(total available - used by the index)
2025-03-09 08:03:26,077 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/34 [00:00<?, ?it/s]  3%|▎         | 1/34 [00:00<00:05,  6.10it/s] 18%|█▊        | 6/34 [00:00<00:01, 24.36it/s] 32%|███▏      | 11/34 [00:00<00:00, 32.41it/s] 47%|████▋     | 16/34 [00:00<00:00, 36.54it/s] 62%|██████▏   | 21/34 [00:05<00:04,  2.60it/s] 76%|███████▋  | 26/34 [00:05<00:02,  3.92it/s] 91%|█████████ | 31/34 [00:05<00:00,  5.68it/s]100%|██████████| 34/34 [00:08<00:00,  3.81it/s]
2025-03-09 08:03:35,010 [INFO]: 	Computing best hyperparameters for index knn.index 03/09/2025, 08:03:35
2025-03-09 08:04:36,181 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 61.1704 secs
2025-03-09 08:04:36,181 [INFO]: The best hyperparameters are: efSearch=137
2025-03-09 08:04:36,181 [INFO]: 	Compute fast metrics 03/09/2025, 08:04:36
  0%|          | 0/4 [00:00<?, ?it/s] 50%|█████     | 2/4 [00:00<00:00, 18.45it/s] 75%|███████▌  | 3/4 [00:00<00:00, 16.52it/s]
2025-03-09 08:04:56,266 [INFO]: 	>>> Finished "Compute fast metrics" in 20.0846 secs
2025-03-09 08:04:56,268 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 90.1909 secs
2025-03-09 08:04:56,268 [INFO]: {
2025-03-09 08:04:56,268 [INFO]: 	index_key: HNSW15
2025-03-09 08:04:56,268 [INFO]: 	index_param: efSearch=137
2025-03-09 08:04:56,268 [INFO]: 	index_path: knn.index
2025-03-09 08:04:56,268 [INFO]: 	size in bytes: 1603661170
2025-03-09 08:04:56,268 [INFO]: 	avg_search_speed_ms: 8.260570890074066
2025-03-09 08:04:56,268 [INFO]: 	99p_search_speed_ms: 19.77372418623421
2025-03-09 08:04:56,268 [INFO]: 	reconstruction error %: 0.0
2025-03-09 08:04:56,268 [INFO]: 	nb vectors: 8151
2025-03-09 08:04:56,268 [INFO]: 	vectors dimension: 49152
2025-03-09 08:04:56,268 [INFO]: 	compression ratio: 0.999308231675897
2025-03-09 08:04:56,268 [INFO]: }
2025-03-09 08:04:56,268 [INFO]: 	>>> Finished "Creating the index" in 90.1947 secs
2025-03-09 08:04:56,268 [INFO]: >>> Finished "Launching the whole pipeline" in 90.2273 secs
2025-03-09 08:04:57: [retrieval_preprocessing] calculating distances ...
2025-03-09 08:05:00: [retrieval_preprocessing] finished and saved retrieval indices for episode 55819 [episode count 4/20]
[retrieval_preprocessing] for episode 29710 [episode count 5/20], we have num_retrieval=np.int64(8280) num_query=np.int64(382)
2025-03-09 08:05:02,734 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-09 08:05:03,793 [INFO]: Launching the whole pipeline 03/09/2025, 08:05:03
2025-03-09 08:05:03,793 [INFO]: Reading total number of vectors and dimension 03/09/2025, 08:05:03
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1169.63it/s]
2025-03-09 08:05:03,823 [INFO]: There are 8280 embeddings of dim 49152
2025-03-09 08:05:03,823 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0295 secs
2025-03-09 08:05:03,823 [INFO]: 	Compute estimated construction time of the index 03/09/2025, 08:05:03
2025-03-09 08:05:03,823 [INFO]: 		-> Train: 16.7 minutes
2025-03-09 08:05:03,823 [INFO]: 		-> Add: 4.5 seconds
2025-03-09 08:05:03,823 [INFO]: 		Total: 16.7 minutes
2025-03-09 08:05:03,823 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0001 secs
2025-03-09 08:05:03,823 [INFO]: 	Checking that your have enough memory available to create the index 03/09/2025, 08:05:03
2025-03-09 08:05:03,823 [INFO]: 1.7GB of memory will be needed to build the index (more might be used if you have more)
2025-03-09 08:05:03,823 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0002 secs
2025-03-09 08:05:03,823 [INFO]: 	Selecting most promising index types given data characteristics 03/09/2025, 08:05:03
2025-03-09 08:05:03,823 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-09 08:05:03,824 [INFO]: 	Creating the index 03/09/2025, 08:05:03
2025-03-09 08:05:03,824 [INFO]: 		-> Instanciate the index HNSW15 03/09/2025, 08:05:03
2025-03-09 08:05:03,825 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0012 secs
2025-03-09 08:05:03,825 [INFO]: 		-> Adding the vectors to the index 03/09/2025, 08:05:03
2025-03-09 08:05:03,825 [INFO]: The memory available for adding the vectors is 48.5GB(total available - used by the index)
2025-03-09 08:05:03,825 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/34 [00:00<?, ?it/s]  3%|▎         | 1/34 [00:00<00:06,  4.81it/s]  9%|▉         | 3/34 [00:00<00:03,  8.53it/s] 15%|█▍        | 5/34 [00:00<00:02,  9.91it/s] 21%|██        | 7/34 [00:00<00:02, 10.68it/s] 26%|██▋       | 9/34 [00:00<00:02, 11.35it/s] 32%|███▏      | 11/34 [00:01<00:01, 11.93it/s] 38%|███▊      | 13/34 [00:01<00:01, 12.47it/s] 44%|████▍     | 15/34 [00:01<00:01, 12.46it/s] 50%|█████     | 17/34 [00:01<00:01, 12.45it/s] 56%|█████▌    | 19/34 [00:01<00:01, 13.49it/s] 62%|██████▏   | 21/34 [00:05<00:08,  1.48it/s] 68%|██████▊   | 23/34 [00:05<00:05,  2.03it/s] 74%|███████▎  | 25/34 [00:05<00:03,  2.77it/s] 79%|███████▉  | 27/34 [00:06<00:01,  3.72it/s] 85%|████████▌ | 29/34 [00:06<00:01,  4.86it/s] 91%|█████████ | 31/34 [00:06<00:00,  6.07it/s] 97%|█████████▋| 33/34 [00:06<00:00,  7.49it/s]100%|██████████| 34/34 [00:09<00:00,  3.51it/s]
2025-03-09 08:05:13,527 [INFO]: 	Computing best hyperparameters for index knn.index 03/09/2025, 08:05:13
2025-03-09 08:06:17,839 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 64.3119 secs
2025-03-09 08:06:17,840 [INFO]: The best hyperparameters are: efSearch=159
2025-03-09 08:06:17,840 [INFO]: 	Compute fast metrics 03/09/2025, 08:06:17
  0%|          | 0/4 [00:00<?, ?it/s] 50%|█████     | 2/4 [00:00<00:00, 18.09it/s] 75%|███████▌  | 3/4 [00:00<00:00, 19.93it/s]
2025-03-09 08:06:41,517 [INFO]: 	>>> Finished "Compute fast metrics" in 23.6769 secs
2025-03-09 08:06:41,519 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 97.6943 secs
2025-03-09 08:06:41,519 [INFO]: {
2025-03-09 08:06:41,519 [INFO]: 	index_key: HNSW15
2025-03-09 08:06:41,519 [INFO]: 	index_param: efSearch=159
2025-03-09 08:06:41,519 [INFO]: 	index_path: knn.index
2025-03-09 08:06:41,520 [INFO]: 	size in bytes: 1629041050
2025-03-09 08:06:41,520 [INFO]: 	avg_search_speed_ms: 9.81068791263171
2025-03-09 08:06:41,520 [INFO]: 	99p_search_speed_ms: 20.58714879211038
2025-03-09 08:06:41,520 [INFO]: 	reconstruction error %: 0.0
2025-03-09 08:06:41,520 [INFO]: 	nb vectors: 8280
2025-03-09 08:06:41,520 [INFO]: 	vectors dimension: 49152
2025-03-09 08:06:41,520 [INFO]: 	compression ratio: 0.9993082985846182
2025-03-09 08:06:41,520 [INFO]: }
2025-03-09 08:06:41,520 [INFO]: 	>>> Finished "Creating the index" in 97.6961 secs
2025-03-09 08:06:41,520 [INFO]: >>> Finished "Launching the whole pipeline" in 97.7263 secs
2025-03-09 08:06:42: [retrieval_preprocessing] calculating distances ...
2025-03-09 08:06:44: [retrieval_preprocessing] finished and saved retrieval indices for episode 29710 [episode count 5/20]
[retrieval_preprocessing] for episode 48526 [episode count 6/20], we have num_retrieval=np.int64(8236) num_query=np.int64(426)
2025-03-09 08:06:45,439 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-09 08:06:46,472 [INFO]: Launching the whole pipeline 03/09/2025, 08:06:46
2025-03-09 08:06:46,472 [INFO]: Reading total number of vectors and dimension 03/09/2025, 08:06:46
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1305.82it/s]
2025-03-09 08:06:46,502 [INFO]: There are 8236 embeddings of dim 49152
2025-03-09 08:06:46,502 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0299 secs
2025-03-09 08:06:46,502 [INFO]: 	Compute estimated construction time of the index 03/09/2025, 08:06:46
2025-03-09 08:06:46,503 [INFO]: 		-> Train: 16.7 minutes
2025-03-09 08:06:46,503 [INFO]: 		-> Add: 4.5 seconds
2025-03-09 08:06:46,503 [INFO]: 		Total: 16.7 minutes
2025-03-09 08:06:46,503 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0006 secs
2025-03-09 08:06:46,503 [INFO]: 	Checking that your have enough memory available to create the index 03/09/2025, 08:06:46
2025-03-09 08:06:46,503 [INFO]: 1.7GB of memory will be needed to build the index (more might be used if you have more)
2025-03-09 08:06:46,504 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0005 secs
2025-03-09 08:06:46,504 [INFO]: 	Selecting most promising index types given data characteristics 03/09/2025, 08:06:46
2025-03-09 08:06:46,504 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-09 08:06:46,504 [INFO]: 	Creating the index 03/09/2025, 08:06:46
2025-03-09 08:06:46,504 [INFO]: 		-> Instanciate the index HNSW15 03/09/2025, 08:06:46
2025-03-09 08:06:46,507 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0029 secs
2025-03-09 08:06:46,508 [INFO]: 		-> Adding the vectors to the index 03/09/2025, 08:06:46
2025-03-09 08:06:46,508 [INFO]: The memory available for adding the vectors is 48.5GB(total available - used by the index)
2025-03-09 08:06:46,508 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/34 [00:00<?, ?it/s]  3%|▎         | 1/34 [00:00<00:03,  9.95it/s] 18%|█▊        | 6/34 [00:00<00:00, 33.29it/s] 29%|██▉       | 10/34 [00:00<00:00, 35.37it/s] 44%|████▍     | 15/34 [00:00<00:00, 41.01it/s] 59%|█████▉    | 20/34 [00:00<00:00, 43.75it/s] 74%|███████▎  | 25/34 [00:04<00:02,  3.04it/s] 85%|████████▌ | 29/34 [00:04<00:01,  4.17it/s]100%|██████████| 34/34 [00:08<00:00,  2.42it/s]100%|██████████| 34/34 [00:08<00:00,  3.93it/s]
2025-03-09 08:06:55,158 [INFO]: 	Computing best hyperparameters for index knn.index 03/09/2025, 08:06:55
2025-03-09 08:07:52,308 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 57.1499 secs
2025-03-09 08:07:52,308 [INFO]: The best hyperparameters are: efSearch=212
2025-03-09 08:07:52,309 [INFO]: 	Compute fast metrics 03/09/2025, 08:07:52
  0%|          | 0/4 [00:00<?, ?it/s] 50%|█████     | 2/4 [00:00<00:00, 16.99it/s] 75%|███████▌  | 3/4 [00:00<00:00, 17.81it/s]
2025-03-09 08:08:17,393 [INFO]: 	>>> Finished "Compute fast metrics" in 25.0840 secs
2025-03-09 08:08:17,395 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 90.8877 secs
2025-03-09 08:08:17,396 [INFO]: {
2025-03-09 08:08:17,396 [INFO]: 	index_key: HNSW15
2025-03-09 08:08:17,396 [INFO]: 	index_param: efSearch=212
2025-03-09 08:08:17,396 [INFO]: 	index_path: knn.index
2025-03-09 08:08:17,396 [INFO]: 	size in bytes: 1620384430
2025-03-09 08:08:17,396 [INFO]: 	avg_search_speed_ms: 13.760125830749041
2025-03-09 08:08:17,396 [INFO]: 	99p_search_speed_ms: 28.73523290269077
2025-03-09 08:08:17,396 [INFO]: 	reconstruction error %: 0.0
2025-03-09 08:08:17,396 [INFO]: 	nb vectors: 8236
2025-03-09 08:08:17,396 [INFO]: 	vectors dimension: 49152
2025-03-09 08:08:17,396 [INFO]: 	compression ratio: 0.9993082246538249
2025-03-09 08:08:17,396 [INFO]: }
2025-03-09 08:08:17,396 [INFO]: 	>>> Finished "Creating the index" in 90.8922 secs
2025-03-09 08:08:17,396 [INFO]: >>> Finished "Launching the whole pipeline" in 90.9242 secs
2025-03-09 08:08:19: [retrieval_preprocessing] calculating distances ...
2025-03-09 08:08:21: [retrieval_preprocessing] finished and saved retrieval indices for episode 48526 [episode count 6/20]
[retrieval_preprocessing] for episode 93969 [episode count 7/20], we have num_retrieval=np.int64(8262) num_query=np.int64(400)
2025-03-09 08:08:22,486 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-09 08:08:24,375 [INFO]: Launching the whole pipeline 03/09/2025, 08:08:24
2025-03-09 08:08:24,375 [INFO]: Reading total number of vectors and dimension 03/09/2025, 08:08:24
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1294.54it/s]
2025-03-09 08:08:24,406 [INFO]: There are 8262 embeddings of dim 49152
2025-03-09 08:08:24,406 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0316 secs
2025-03-09 08:08:24,407 [INFO]: 	Compute estimated construction time of the index 03/09/2025, 08:08:24
2025-03-09 08:08:24,407 [INFO]: 		-> Train: 16.7 minutes
2025-03-09 08:08:24,407 [INFO]: 		-> Add: 4.5 seconds
2025-03-09 08:08:24,407 [INFO]: 		Total: 16.7 minutes
2025-03-09 08:08:24,407 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0005 secs
2025-03-09 08:08:24,407 [INFO]: 	Checking that your have enough memory available to create the index 03/09/2025, 08:08:24
2025-03-09 08:08:24,408 [INFO]: 1.7GB of memory will be needed to build the index (more might be used if you have more)
2025-03-09 08:08:24,408 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0005 secs
2025-03-09 08:08:24,408 [INFO]: 	Selecting most promising index types given data characteristics 03/09/2025, 08:08:24
2025-03-09 08:08:24,408 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-09 08:08:24,408 [INFO]: 	Creating the index 03/09/2025, 08:08:24
2025-03-09 08:08:24,408 [INFO]: 		-> Instanciate the index HNSW15 03/09/2025, 08:08:24
2025-03-09 08:08:24,411 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0027 secs
2025-03-09 08:08:24,411 [INFO]: 		-> Adding the vectors to the index 03/09/2025, 08:08:24
2025-03-09 08:08:24,412 [INFO]: The memory available for adding the vectors is 48.5GB(total available - used by the index)
2025-03-09 08:08:24,412 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/34 [00:00<?, ?it/s]  3%|▎         | 1/34 [00:00<00:04,  7.99it/s] 15%|█▍        | 5/34 [00:00<00:01, 22.16it/s] 29%|██▉       | 10/34 [00:00<00:00, 30.32it/s] 41%|████      | 14/34 [00:00<00:00, 33.47it/s] 53%|█████▎    | 18/34 [00:00<00:00, 35.30it/s] 65%|██████▍   | 22/34 [00:04<00:04,  2.84it/s] 82%|████████▏ | 28/34 [00:04<00:01,  4.76it/s]100%|██████████| 34/34 [00:07<00:00,  3.09it/s]100%|██████████| 34/34 [00:07<00:00,  4.46it/s]
2025-03-09 08:08:32,036 [INFO]: 	Computing best hyperparameters for index knn.index 03/09/2025, 08:08:32
2025-03-09 08:09:31,056 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 59.0197 secs
2025-03-09 08:09:31,057 [INFO]: The best hyperparameters are: efSearch=153
2025-03-09 08:09:31,057 [INFO]: 	Compute fast metrics 03/09/2025, 08:09:31
  0%|          | 0/4 [00:00<?, ?it/s] 50%|█████     | 2/4 [00:00<00:00, 19.53it/s] 75%|███████▌  | 3/4 [00:00<00:00, 21.05it/s]
2025-03-09 08:09:55,662 [INFO]: 	>>> Finished "Compute fast metrics" in 24.6045 secs
2025-03-09 08:09:55,664 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 91.2520 secs
2025-03-09 08:09:55,664 [INFO]: {
2025-03-09 08:09:55,664 [INFO]: 	index_key: HNSW15
2025-03-09 08:09:55,664 [INFO]: 	index_param: efSearch=153
2025-03-09 08:09:55,664 [INFO]: 	index_path: knn.index
2025-03-09 08:09:55,664 [INFO]: 	size in bytes: 1625499670
2025-03-09 08:09:55,664 [INFO]: 	avg_search_speed_ms: 8.593324911092564
2025-03-09 08:09:55,664 [INFO]: 	99p_search_speed_ms: 18.14814621815456
2025-03-09 08:09:55,664 [INFO]: 	reconstruction error %: 0.0
2025-03-09 08:09:55,664 [INFO]: 	nb vectors: 8262
2025-03-09 08:09:55,664 [INFO]: 	vectors dimension: 49152
2025-03-09 08:09:55,664 [INFO]: 	compression ratio: 0.999308290231766
2025-03-09 08:09:55,664 [INFO]: }
2025-03-09 08:09:55,664 [INFO]: 	>>> Finished "Creating the index" in 91.2556 secs
2025-03-09 08:09:55,664 [INFO]: >>> Finished "Launching the whole pipeline" in 91.2892 secs
2025-03-09 08:09:56: [retrieval_preprocessing] calculating distances ...
2025-03-09 08:09:58: [retrieval_preprocessing] finished and saved retrieval indices for episode 93969 [episode count 7/20]
[retrieval_preprocessing] for episode 10258 [episode count 8/20], we have num_retrieval=np.int64(8308) num_query=np.int64(354)
2025-03-09 08:09:59,431 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-09 08:10:00,627 [INFO]: Launching the whole pipeline 03/09/2025, 08:10:00
2025-03-09 08:10:00,627 [INFO]: Reading total number of vectors and dimension 03/09/2025, 08:10:00
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1097.70it/s]
2025-03-09 08:10:00,652 [INFO]: There are 8308 embeddings of dim 49152
2025-03-09 08:10:00,653 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0258 secs
2025-03-09 08:10:00,653 [INFO]: 	Compute estimated construction time of the index 03/09/2025, 08:10:00
2025-03-09 08:10:00,653 [INFO]: 		-> Train: 16.7 minutes
2025-03-09 08:10:00,653 [INFO]: 		-> Add: 4.6 seconds
2025-03-09 08:10:00,653 [INFO]: 		Total: 16.7 minutes
2025-03-09 08:10:00,653 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0001 secs
2025-03-09 08:10:00,653 [INFO]: 	Checking that your have enough memory available to create the index 03/09/2025, 08:10:00
2025-03-09 08:10:00,653 [INFO]: 1.7GB of memory will be needed to build the index (more might be used if you have more)
2025-03-09 08:10:00,653 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0002 secs
2025-03-09 08:10:00,653 [INFO]: 	Selecting most promising index types given data characteristics 03/09/2025, 08:10:00
2025-03-09 08:10:00,653 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-09 08:10:00,653 [INFO]: 	Creating the index 03/09/2025, 08:10:00
2025-03-09 08:10:00,653 [INFO]: 		-> Instanciate the index HNSW15 03/09/2025, 08:10:00
2025-03-09 08:10:00,654 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0009 secs
2025-03-09 08:10:00,654 [INFO]: 		-> Adding the vectors to the index 03/09/2025, 08:10:00
2025-03-09 08:10:00,654 [INFO]: The memory available for adding the vectors is 48.5GB(total available - used by the index)
2025-03-09 08:10:00,654 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/34 [00:00<?, ?it/s]  3%|▎         | 1/34 [00:00<00:03,  9.13it/s] 18%|█▊        | 6/34 [00:00<00:00, 29.07it/s] 32%|███▏      | 11/34 [00:00<00:00, 35.07it/s] 44%|████▍     | 15/34 [00:00<00:00, 36.82it/s] 56%|█████▌    | 19/34 [00:00<00:00, 36.80it/s] 68%|██████▊   | 23/34 [00:04<00:04,  2.57it/s] 82%|████████▏ | 28/34 [00:05<00:01,  3.98it/s] 97%|█████████▋| 33/34 [00:05<00:00,  5.84it/s]100%|██████████| 34/34 [00:08<00:00,  3.92it/s]
2025-03-09 08:10:09,661 [INFO]: 	Computing best hyperparameters for index knn.index 03/09/2025, 08:10:09
2025-03-09 08:11:08,520 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 58.8586 secs
2025-03-09 08:11:08,521 [INFO]: The best hyperparameters are: efSearch=114
2025-03-09 08:11:08,521 [INFO]: 	Compute fast metrics 03/09/2025, 08:11:08
  0%|          | 0/4 [00:00<?, ?it/s] 50%|█████     | 2/4 [00:00<00:00, 19.01it/s] 75%|███████▌  | 3/4 [00:00<00:00, 18.67it/s]
2025-03-09 08:11:32,067 [INFO]: 	>>> Finished "Compute fast metrics" in 23.5460 secs
2025-03-09 08:11:32,069 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 91.4146 secs
2025-03-09 08:11:32,069 [INFO]: {
2025-03-09 08:11:32,069 [INFO]: 	index_key: HNSW15
2025-03-09 08:11:32,069 [INFO]: 	index_param: efSearch=114
2025-03-09 08:11:32,069 [INFO]: 	index_path: knn.index
2025-03-09 08:11:32,069 [INFO]: 	size in bytes: 1634549890
2025-03-09 08:11:32,069 [INFO]: 	avg_search_speed_ms: 7.302102704709192
2025-03-09 08:11:32,069 [INFO]: 	99p_search_speed_ms: 15.540969241410464
2025-03-09 08:11:32,069 [INFO]: 	reconstruction error %: 0.0
2025-03-09 08:11:32,069 [INFO]: 	nb vectors: 8308
2025-03-09 08:11:32,069 [INFO]: 	vectors dimension: 49152
2025-03-09 08:11:32,069 [INFO]: 	compression ratio: 0.9993082952029075
2025-03-09 08:11:32,069 [INFO]: }
2025-03-09 08:11:32,069 [INFO]: 	>>> Finished "Creating the index" in 91.4160 secs
2025-03-09 08:11:32,069 [INFO]: >>> Finished "Launching the whole pipeline" in 91.4425 secs
2025-03-09 08:11:32: [retrieval_preprocessing] calculating distances ...
2025-03-09 08:11:34: [retrieval_preprocessing] finished and saved retrieval indices for episode 10258 [episode count 8/20]
[retrieval_preprocessing] for episode 53523 [episode count 9/20], we have num_retrieval=np.int64(8380) num_query=np.int64(282)
2025-03-09 08:11:34,904 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-09 08:11:35,940 [INFO]: Launching the whole pipeline 03/09/2025, 08:11:35
2025-03-09 08:11:35,941 [INFO]: Reading total number of vectors and dimension 03/09/2025, 08:11:35
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 2042.02it/s]
2025-03-09 08:11:35,966 [INFO]: There are 8380 embeddings of dim 49152
2025-03-09 08:11:35,966 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0255 secs
2025-03-09 08:11:35,966 [INFO]: 	Compute estimated construction time of the index 03/09/2025, 08:11:35
2025-03-09 08:11:35,966 [INFO]: 		-> Train: 16.7 minutes
2025-03-09 08:11:35,966 [INFO]: 		-> Add: 4.6 seconds
2025-03-09 08:11:35,966 [INFO]: 		Total: 16.7 minutes
2025-03-09 08:11:35,966 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0001 secs
2025-03-09 08:11:35,966 [INFO]: 	Checking that your have enough memory available to create the index 03/09/2025, 08:11:35
2025-03-09 08:11:35,967 [INFO]: 1.7GB of memory will be needed to build the index (more might be used if you have more)
2025-03-09 08:11:35,967 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0001 secs
2025-03-09 08:11:35,967 [INFO]: 	Selecting most promising index types given data characteristics 03/09/2025, 08:11:35
2025-03-09 08:11:35,967 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-09 08:11:35,967 [INFO]: 	Creating the index 03/09/2025, 08:11:35
2025-03-09 08:11:35,967 [INFO]: 		-> Instanciate the index HNSW15 03/09/2025, 08:11:35
2025-03-09 08:11:35,968 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0009 secs
2025-03-09 08:11:35,968 [INFO]: 		-> Adding the vectors to the index 03/09/2025, 08:11:35
2025-03-09 08:11:35,968 [INFO]: The memory available for adding the vectors is 48.5GB(total available - used by the index)
2025-03-09 08:11:35,968 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/34 [00:00<?, ?it/s]  6%|▌         | 2/34 [00:00<00:01, 16.52it/s] 21%|██        | 7/34 [00:00<00:00, 34.15it/s] 35%|███▌      | 12/34 [00:00<00:00, 40.51it/s] 50%|█████     | 17/34 [00:00<00:00, 38.36it/s] 62%|██████▏   | 21/34 [00:04<00:04,  2.61it/s] 76%|███████▋  | 26/34 [00:05<00:01,  4.02it/s] 94%|█████████▍| 32/34 [00:05<00:00,  6.28it/s]100%|██████████| 34/34 [00:08<00:00,  3.78it/s]
2025-03-09 08:11:45,261 [INFO]: 	Computing best hyperparameters for index knn.index 03/09/2025, 08:11:45
2025-03-09 08:12:44,202 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 58.9400 secs
2025-03-09 08:12:44,202 [INFO]: The best hyperparameters are: efSearch=176
2025-03-09 08:12:44,202 [INFO]: 	Compute fast metrics 03/09/2025, 08:12:44
  0%|          | 0/4 [00:00<?, ?it/s] 50%|█████     | 2/4 [00:00<00:00, 18.77it/s] 75%|███████▌  | 3/4 [00:00<00:00, 20.38it/s]
2025-03-09 08:13:15,132 [INFO]: 	>>> Finished "Compute fast metrics" in 30.9301 secs
2025-03-09 08:13:15,135 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 99.1671 secs
2025-03-09 08:13:15,135 [INFO]: {
2025-03-09 08:13:15,135 [INFO]: 	index_key: HNSW15
2025-03-09 08:13:15,135 [INFO]: 	index_param: efSearch=176
2025-03-09 08:13:15,135 [INFO]: 	index_path: knn.index
2025-03-09 08:13:15,135 [INFO]: 	size in bytes: 1648715290
2025-03-09 08:13:15,135 [INFO]: 	avg_search_speed_ms: 10.041415975765066
2025-03-09 08:13:15,135 [INFO]: 	99p_search_speed_ms: 23.236827433574938
2025-03-09 08:13:15,135 [INFO]: 	reconstruction error %: 0.0
2025-03-09 08:13:15,135 [INFO]: 	nb vectors: 8380
2025-03-09 08:13:15,135 [INFO]: 	vectors dimension: 49152
2025-03-09 08:13:15,135 [INFO]: 	compression ratio: 0.9993084009065022
2025-03-09 08:13:15,135 [INFO]: }
2025-03-09 08:13:15,135 [INFO]: 	>>> Finished "Creating the index" in 99.1686 secs
2025-03-09 08:13:15,135 [INFO]: >>> Finished "Launching the whole pipeline" in 99.1948 secs
2025-03-09 08:13:16: [retrieval_preprocessing] calculating distances ...
2025-03-09 08:13:17: [retrieval_preprocessing] finished and saved retrieval indices for episode 53523 [episode count 9/20]
[retrieval_preprocessing] for episode 15512 [episode count 10/20], we have num_retrieval=np.int64(8310) num_query=np.int64(352)
2025-03-09 08:13:18,557 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-09 08:13:19,772 [INFO]: Launching the whole pipeline 03/09/2025, 08:13:19
2025-03-09 08:13:19,772 [INFO]: Reading total number of vectors and dimension 03/09/2025, 08:13:19
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1152.28it/s]
2025-03-09 08:13:19,799 [INFO]: There are 8310 embeddings of dim 49152
2025-03-09 08:13:19,799 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0271 secs
2025-03-09 08:13:19,799 [INFO]: 	Compute estimated construction time of the index 03/09/2025, 08:13:19
2025-03-09 08:13:19,799 [INFO]: 		-> Train: 16.7 minutes
2025-03-09 08:13:19,799 [INFO]: 		-> Add: 4.6 seconds
2025-03-09 08:13:19,799 [INFO]: 		Total: 16.7 minutes
2025-03-09 08:13:19,799 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0001 secs
2025-03-09 08:13:19,799 [INFO]: 	Checking that your have enough memory available to create the index 03/09/2025, 08:13:19
2025-03-09 08:13:19,799 [INFO]: 1.7GB of memory will be needed to build the index (more might be used if you have more)
2025-03-09 08:13:19,799 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0001 secs
2025-03-09 08:13:19,799 [INFO]: 	Selecting most promising index types given data characteristics 03/09/2025, 08:13:19
2025-03-09 08:13:19,800 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-09 08:13:19,800 [INFO]: 	Creating the index 03/09/2025, 08:13:19
2025-03-09 08:13:19,800 [INFO]: 		-> Instanciate the index HNSW15 03/09/2025, 08:13:19
2025-03-09 08:13:19,801 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0010 secs
2025-03-09 08:13:19,801 [INFO]: 		-> Adding the vectors to the index 03/09/2025, 08:13:19
2025-03-09 08:13:19,801 [INFO]: The memory available for adding the vectors is 48.5GB(total available - used by the index)
2025-03-09 08:13:19,801 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/34 [00:00<?, ?it/s]  3%|▎         | 1/34 [00:00<00:04,  6.67it/s] 18%|█▊        | 6/34 [00:00<00:01, 25.76it/s] 32%|███▏      | 11/34 [00:00<00:00, 34.79it/s] 47%|████▋     | 16/34 [00:00<00:00, 39.59it/s] 62%|██████▏   | 21/34 [00:05<00:04,  2.71it/s] 76%|███████▋  | 26/34 [00:05<00:01,  4.08it/s] 94%|█████████▍| 32/34 [00:05<00:00,  6.22it/s]100%|██████████| 34/34 [00:08<00:00,  3.93it/s]
2025-03-09 08:13:28,445 [INFO]: 	Computing best hyperparameters for index knn.index 03/09/2025, 08:13:28
2025-03-09 08:14:24,325 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 55.8794 secs
2025-03-09 08:14:24,325 [INFO]: The best hyperparameters are: efSearch=179
2025-03-09 08:14:24,325 [INFO]: 	Compute fast metrics 03/09/2025, 08:14:24
  0%|          | 0/4 [00:00<?, ?it/s] 50%|█████     | 2/4 [00:00<00:00, 19.12it/s] 75%|███████▌  | 3/4 [00:00<00:00, 20.98it/s]
2025-03-09 08:14:46,079 [INFO]: 	>>> Finished "Compute fast metrics" in 21.7535 secs
2025-03-09 08:14:46,083 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 86.2823 secs
2025-03-09 08:14:46,083 [INFO]: {
2025-03-09 08:14:46,083 [INFO]: 	index_key: HNSW15
2025-03-09 08:14:46,083 [INFO]: 	index_param: efSearch=179
2025-03-09 08:14:46,084 [INFO]: 	index_path: knn.index
2025-03-09 08:14:46,084 [INFO]: 	size in bytes: 1634943370
2025-03-09 08:14:46,084 [INFO]: 	avg_search_speed_ms: 10.674412678847668
2025-03-09 08:14:46,084 [INFO]: 	99p_search_speed_ms: 24.672192865982648
2025-03-09 08:14:46,084 [INFO]: 	reconstruction error %: 0.0
2025-03-09 08:14:46,084 [INFO]: 	nb vectors: 8310
2025-03-09 08:14:46,084 [INFO]: 	vectors dimension: 49152
2025-03-09 08:14:46,084 [INFO]: 	compression ratio: 0.999308300201248
2025-03-09 08:14:46,084 [INFO]: }
2025-03-09 08:14:46,084 [INFO]: 	>>> Finished "Creating the index" in 86.2843 secs
2025-03-09 08:14:46,084 [INFO]: >>> Finished "Launching the whole pipeline" in 86.3122 secs
2025-03-09 08:14:47: [retrieval_preprocessing] calculating distances ...
2025-03-09 08:14:49: [retrieval_preprocessing] finished and saved retrieval indices for episode 15512 [episode count 10/20]
[retrieval_preprocessing] for episode 60184 [episode count 11/20], we have num_retrieval=np.int64(8376) num_query=np.int64(286)
2025-03-09 08:14:49,918 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-09 08:14:51,169 [INFO]: Launching the whole pipeline 03/09/2025, 08:14:51
2025-03-09 08:14:51,169 [INFO]: Reading total number of vectors and dimension 03/09/2025, 08:14:51
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1119.08it/s]
2025-03-09 08:14:51,193 [INFO]: There are 8376 embeddings of dim 49152
2025-03-09 08:14:51,193 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0247 secs
2025-03-09 08:14:51,193 [INFO]: 	Compute estimated construction time of the index 03/09/2025, 08:14:51
2025-03-09 08:14:51,194 [INFO]: 		-> Train: 16.7 minutes
2025-03-09 08:14:51,194 [INFO]: 		-> Add: 4.6 seconds
2025-03-09 08:14:51,194 [INFO]: 		Total: 16.7 minutes
2025-03-09 08:14:51,194 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0001 secs
2025-03-09 08:14:51,194 [INFO]: 	Checking that your have enough memory available to create the index 03/09/2025, 08:14:51
2025-03-09 08:14:51,194 [INFO]: 1.7GB of memory will be needed to build the index (more might be used if you have more)
2025-03-09 08:14:51,194 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0001 secs
2025-03-09 08:14:51,194 [INFO]: 	Selecting most promising index types given data characteristics 03/09/2025, 08:14:51
2025-03-09 08:14:51,194 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-09 08:14:51,194 [INFO]: 	Creating the index 03/09/2025, 08:14:51
2025-03-09 08:14:51,194 [INFO]: 		-> Instanciate the index HNSW15 03/09/2025, 08:14:51
2025-03-09 08:14:51,195 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0010 secs
2025-03-09 08:14:51,195 [INFO]: 		-> Adding the vectors to the index 03/09/2025, 08:14:51
2025-03-09 08:14:51,195 [INFO]: The memory available for adding the vectors is 48.5GB(total available - used by the index)
2025-03-09 08:14:51,195 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/34 [00:00<?, ?it/s]  3%|▎         | 1/34 [00:00<00:04,  7.79it/s] 15%|█▍        | 5/34 [00:00<00:01, 24.64it/s] 32%|███▏      | 11/34 [00:00<00:00, 36.94it/s] 50%|█████     | 17/34 [00:00<00:00, 42.66it/s] 65%|██████▍   | 22/34 [00:04<00:03,  3.51it/s] 82%|████████▏ | 28/34 [00:04<00:01,  5.48it/s] 97%|█████████▋| 33/34 [00:04<00:00,  7.58it/s]100%|██████████| 34/34 [00:07<00:00,  4.60it/s]
2025-03-09 08:14:58,597 [INFO]: 	Computing best hyperparameters for index knn.index 03/09/2025, 08:14:58
2025-03-09 08:15:51,204 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 52.6067 secs
2025-03-09 08:15:51,204 [INFO]: The best hyperparameters are: efSearch=219
2025-03-09 08:15:51,204 [INFO]: 	Compute fast metrics 03/09/2025, 08:15:51
  0%|          | 0/4 [00:00<?, ?it/s] 50%|█████     | 2/4 [00:00<00:00, 18.85it/s] 75%|███████▌  | 3/4 [00:00<00:00, 20.55it/s]
2025-03-09 08:16:17,222 [INFO]: 	>>> Finished "Compute fast metrics" in 26.0180 secs
2025-03-09 08:16:17,225 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 86.0294 secs
2025-03-09 08:16:17,225 [INFO]: {
2025-03-09 08:16:17,225 [INFO]: 	index_key: HNSW15
2025-03-09 08:16:17,225 [INFO]: 	index_param: efSearch=219
2025-03-09 08:16:17,225 [INFO]: 	index_path: knn.index
2025-03-09 08:16:17,225 [INFO]: 	size in bytes: 1647928330
2025-03-09 08:16:17,225 [INFO]: 	avg_search_speed_ms: 11.528471514822975
2025-03-09 08:16:17,225 [INFO]: 	99p_search_speed_ms: 24.646800162736334
2025-03-09 08:16:17,225 [INFO]: 	reconstruction error %: 0.0
2025-03-09 08:16:17,225 [INFO]: 	nb vectors: 8376
2025-03-09 08:16:17,225 [INFO]: 	vectors dimension: 49152
2025-03-09 08:16:17,225 [INFO]: 	compression ratio: 0.999308391039069
2025-03-09 08:16:17,225 [INFO]: }
2025-03-09 08:16:17,225 [INFO]: 	>>> Finished "Creating the index" in 86.0310 secs
2025-03-09 08:16:17,225 [INFO]: >>> Finished "Launching the whole pipeline" in 86.0562 secs
2025-03-09 08:16:18: [retrieval_preprocessing] calculating distances ...
2025-03-09 08:16:20: [retrieval_preprocessing] finished and saved retrieval indices for episode 60184 [episode count 11/20]
[retrieval_preprocessing] for episode 8602 [episode count 12/20], we have num_retrieval=np.int64(8299) num_query=np.int64(363)
2025-03-09 08:16:20,719 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-09 08:16:21,883 [INFO]: Launching the whole pipeline 03/09/2025, 08:16:21
2025-03-09 08:16:21,883 [INFO]: Reading total number of vectors and dimension 03/09/2025, 08:16:21
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1181.83it/s]
2025-03-09 08:16:21,909 [INFO]: There are 8299 embeddings of dim 49152
2025-03-09 08:16:21,909 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0260 secs
2025-03-09 08:16:21,909 [INFO]: 	Compute estimated construction time of the index 03/09/2025, 08:16:21
2025-03-09 08:16:21,909 [INFO]: 		-> Train: 16.7 minutes
2025-03-09 08:16:21,909 [INFO]: 		-> Add: 4.6 seconds
2025-03-09 08:16:21,909 [INFO]: 		Total: 16.7 minutes
2025-03-09 08:16:21,909 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0002 secs
2025-03-09 08:16:21,909 [INFO]: 	Checking that your have enough memory available to create the index 03/09/2025, 08:16:21
2025-03-09 08:16:21,909 [INFO]: 1.7GB of memory will be needed to build the index (more might be used if you have more)
2025-03-09 08:16:21,909 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0002 secs
2025-03-09 08:16:21,910 [INFO]: 	Selecting most promising index types given data characteristics 03/09/2025, 08:16:21
2025-03-09 08:16:21,910 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-09 08:16:21,910 [INFO]: 	Creating the index 03/09/2025, 08:16:21
2025-03-09 08:16:21,910 [INFO]: 		-> Instanciate the index HNSW15 03/09/2025, 08:16:21
2025-03-09 08:16:21,911 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0011 secs
2025-03-09 08:16:21,911 [INFO]: 		-> Adding the vectors to the index 03/09/2025, 08:16:21
2025-03-09 08:16:21,911 [INFO]: The memory available for adding the vectors is 48.5GB(total available - used by the index)
2025-03-09 08:16:21,911 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/34 [00:00<?, ?it/s]  6%|▌         | 2/34 [00:00<00:01, 17.50it/s] 24%|██▎       | 8/34 [00:00<00:00, 37.47it/s] 41%|████      | 14/34 [00:00<00:00, 44.79it/s] 59%|█████▉    | 20/34 [00:00<00:00, 49.45it/s] 74%|███████▎  | 25/34 [00:04<00:02,  3.42it/s] 91%|█████████ | 31/34 [00:04<00:00,  5.23it/s]100%|██████████| 34/34 [00:08<00:00,  4.23it/s]
2025-03-09 08:16:30,127 [INFO]: 	Computing best hyperparameters for index knn.index 03/09/2025, 08:16:30
2025-03-09 08:17:27,301 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 57.1733 secs
2025-03-09 08:17:27,301 [INFO]: The best hyperparameters are: efSearch=154
2025-03-09 08:17:27,301 [INFO]: 	Compute fast metrics 03/09/2025, 08:17:27
  0%|          | 0/4 [00:00<?, ?it/s] 50%|█████     | 2/4 [00:00<00:00, 16.37it/s] 75%|███████▌  | 3/4 [00:00<00:00, 17.40it/s]
2025-03-09 08:17:49,814 [INFO]: 	>>> Finished "Compute fast metrics" in 22.5130 secs
2025-03-09 08:17:49,817 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 87.9062 secs
2025-03-09 08:17:49,817 [INFO]: {
2025-03-09 08:17:49,817 [INFO]: 	index_key: HNSW15
2025-03-09 08:17:49,817 [INFO]: 	index_param: efSearch=154
2025-03-09 08:17:49,817 [INFO]: 	index_path: knn.index
2025-03-09 08:17:49,817 [INFO]: 	size in bytes: 1632779170
2025-03-09 08:17:49,818 [INFO]: 	avg_search_speed_ms: 8.765941948977327
2025-03-09 08:17:49,818 [INFO]: 	99p_search_speed_ms: 14.660111260600367
2025-03-09 08:17:49,818 [INFO]: 	reconstruction error %: 0.0
2025-03-09 08:17:49,818 [INFO]: 	nb vectors: 8299
2025-03-09 08:17:49,818 [INFO]: 	vectors dimension: 49152
2025-03-09 08:17:49,818 [INFO]: 	compression ratio: 0.9993083094023057
2025-03-09 08:17:49,818 [INFO]: }
2025-03-09 08:17:49,818 [INFO]: 	>>> Finished "Creating the index" in 87.9080 secs
2025-03-09 08:17:49,818 [INFO]: >>> Finished "Launching the whole pipeline" in 87.9348 secs
2025-03-09 08:17:50: [retrieval_preprocessing] calculating distances ...
2025-03-09 08:17:52: [retrieval_preprocessing] finished and saved retrieval indices for episode 8602 [episode count 12/20]
[retrieval_preprocessing] for episode 88602 [episode count 13/20], we have num_retrieval=np.int64(8365) num_query=np.int64(297)
2025-03-09 08:17:55,257 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-09 08:17:56,799 [INFO]: Launching the whole pipeline 03/09/2025, 08:17:56
2025-03-09 08:17:56,799 [INFO]: Reading total number of vectors and dimension 03/09/2025, 08:17:56
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1363.11it/s]
2025-03-09 08:17:56,836 [INFO]: There are 8365 embeddings of dim 49152
2025-03-09 08:17:56,836 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0375 secs
2025-03-09 08:17:56,837 [INFO]: 	Compute estimated construction time of the index 03/09/2025, 08:17:56
2025-03-09 08:17:56,837 [INFO]: 		-> Train: 16.7 minutes
2025-03-09 08:17:56,837 [INFO]: 		-> Add: 4.6 seconds
2025-03-09 08:17:56,837 [INFO]: 		Total: 16.7 minutes
2025-03-09 08:17:56,837 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0005 secs
2025-03-09 08:17:56,837 [INFO]: 	Checking that your have enough memory available to create the index 03/09/2025, 08:17:56
2025-03-09 08:17:56,838 [INFO]: 1.7GB of memory will be needed to build the index (more might be used if you have more)
2025-03-09 08:17:56,838 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0007 secs
2025-03-09 08:17:56,838 [INFO]: 	Selecting most promising index types given data characteristics 03/09/2025, 08:17:56
2025-03-09 08:17:56,838 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-09 08:17:56,838 [INFO]: 	Creating the index 03/09/2025, 08:17:56
2025-03-09 08:17:56,838 [INFO]: 		-> Instanciate the index HNSW15 03/09/2025, 08:17:56
2025-03-09 08:17:56,841 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0024 secs
2025-03-09 08:17:56,841 [INFO]: 		-> Adding the vectors to the index 03/09/2025, 08:17:56
2025-03-09 08:17:56,841 [INFO]: The memory available for adding the vectors is 48.5GB(total available - used by the index)
2025-03-09 08:17:56,841 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/34 [00:00<?, ?it/s]  3%|▎         | 1/34 [00:00<00:06,  5.05it/s]  9%|▉         | 3/34 [00:00<00:03,  8.96it/s] 15%|█▍        | 5/34 [00:00<00:02, 10.55it/s] 21%|██        | 7/34 [00:00<00:02, 11.20it/s] 26%|██▋       | 9/34 [00:00<00:02, 11.46it/s] 32%|███▏      | 11/34 [00:01<00:01, 11.70it/s] 38%|███▊      | 13/34 [00:01<00:01, 11.76it/s] 44%|████▍     | 15/34 [00:01<00:01, 11.91it/s] 50%|█████     | 17/34 [00:01<00:01, 12.15it/s] 56%|█████▌    | 19/34 [00:01<00:01, 11.90it/s] 62%|██████▏   | 21/34 [00:06<00:10,  1.26it/s] 71%|███████   | 24/34 [00:06<00:04,  2.02it/s] 79%|███████▉  | 27/34 [00:06<00:02,  3.04it/s] 91%|█████████ | 31/34 [00:06<00:00,  4.81it/s]100%|██████████| 34/34 [00:10<00:00,  1.95it/s]100%|██████████| 34/34 [00:10<00:00,  3.25it/s]
2025-03-09 08:18:07,305 [INFO]: 	Computing best hyperparameters for index knn.index 03/09/2025, 08:18:07
2025-03-09 08:19:09,046 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 61.7394 secs
2025-03-09 08:19:09,046 [INFO]: The best hyperparameters are: efSearch=161
2025-03-09 08:19:09,046 [INFO]: 	Compute fast metrics 03/09/2025, 08:19:09
  0%|          | 0/4 [00:00<?, ?it/s] 75%|███████▌  | 3/4 [00:00<00:00, 26.65it/s] 75%|███████▌  | 3/4 [00:00<00:00, 22.44it/s]
2025-03-09 08:19:37,802 [INFO]: 	>>> Finished "Compute fast metrics" in 28.7552 secs
2025-03-09 08:19:37,805 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 100.9634 secs
2025-03-09 08:19:37,805 [INFO]: {
2025-03-09 08:19:37,805 [INFO]: 	index_key: HNSW15
2025-03-09 08:19:37,805 [INFO]: 	index_param: efSearch=161
2025-03-09 08:19:37,805 [INFO]: 	index_path: knn.index
2025-03-09 08:19:37,805 [INFO]: 	size in bytes: 1645764130
2025-03-09 08:19:37,805 [INFO]: 	avg_search_speed_ms: 8.94889787126046
2025-03-09 08:19:37,805 [INFO]: 	99p_search_speed_ms: 20.86878962814806
2025-03-09 08:19:37,805 [INFO]: 	reconstruction error %: 0.0
2025-03-09 08:19:37,805 [INFO]: 	nb vectors: 8365
2025-03-09 08:19:37,805 [INFO]: 	vectors dimension: 49152
2025-03-09 08:19:37,805 [INFO]: 	compression ratio: 0.999308400286984
2025-03-09 08:19:37,805 [INFO]: }
2025-03-09 08:19:37,805 [INFO]: 	>>> Finished "Creating the index" in 100.9667 secs
2025-03-09 08:19:37,805 [INFO]: >>> Finished "Launching the whole pipeline" in 101.0062 secs
2025-03-09 08:19:38: [retrieval_preprocessing] calculating distances ...
2025-03-09 08:19:40: [retrieval_preprocessing] finished and saved retrieval indices for episode 88602 [episode count 13/20]
[retrieval_preprocessing] for episode 14496 [episode count 14/20], we have num_retrieval=np.int64(8237) num_query=np.int64(425)
2025-03-09 08:19:41,285 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-09 08:19:43,342 [INFO]: Launching the whole pipeline 03/09/2025, 08:19:43
2025-03-09 08:19:43,342 [INFO]: Reading total number of vectors and dimension 03/09/2025, 08:19:43
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1201.12it/s]
2025-03-09 08:19:43,377 [INFO]: There are 8237 embeddings of dim 49152
2025-03-09 08:19:43,377 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0349 secs
2025-03-09 08:19:43,377 [INFO]: 	Compute estimated construction time of the index 03/09/2025, 08:19:43
2025-03-09 08:19:43,377 [INFO]: 		-> Train: 16.7 minutes
2025-03-09 08:19:43,377 [INFO]: 		-> Add: 4.5 seconds
2025-03-09 08:19:43,377 [INFO]: 		Total: 16.7 minutes
2025-03-09 08:19:43,377 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0001 secs
2025-03-09 08:19:43,378 [INFO]: 	Checking that your have enough memory available to create the index 03/09/2025, 08:19:43
2025-03-09 08:19:43,378 [INFO]: 1.7GB of memory will be needed to build the index (more might be used if you have more)
2025-03-09 08:19:43,378 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0002 secs
2025-03-09 08:19:43,378 [INFO]: 	Selecting most promising index types given data characteristics 03/09/2025, 08:19:43
2025-03-09 08:19:43,378 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-09 08:19:43,378 [INFO]: 	Creating the index 03/09/2025, 08:19:43
2025-03-09 08:19:43,378 [INFO]: 		-> Instanciate the index HNSW15 03/09/2025, 08:19:43
2025-03-09 08:19:43,379 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0013 secs
2025-03-09 08:19:43,379 [INFO]: 		-> Adding the vectors to the index 03/09/2025, 08:19:43
2025-03-09 08:19:43,380 [INFO]: The memory available for adding the vectors is 48.5GB(total available - used by the index)
2025-03-09 08:19:43,380 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/34 [00:00<?, ?it/s]  3%|▎         | 1/34 [00:00<00:04,  7.52it/s] 21%|██        | 7/34 [00:00<00:00, 34.09it/s] 38%|███▊      | 13/34 [00:00<00:00, 44.58it/s] 56%|█████▌    | 19/34 [00:00<00:00, 49.87it/s] 74%|███████▎  | 25/34 [00:04<00:02,  3.59it/s] 94%|█████████▍| 32/34 [00:04<00:00,  5.72it/s]100%|██████████| 34/34 [00:08<00:00,  4.07it/s]
2025-03-09 08:19:51,734 [INFO]: 	Computing best hyperparameters for index knn.index 03/09/2025, 08:19:51
2025-03-09 08:20:53,894 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 62.1589 secs
2025-03-09 08:20:53,894 [INFO]: The best hyperparameters are: efSearch=147
2025-03-09 08:20:53,895 [INFO]: 	Compute fast metrics 03/09/2025, 08:20:53
  0%|          | 0/4 [00:00<?, ?it/s] 25%|██▌       | 1/4 [00:00<00:00,  5.67it/s] 50%|█████     | 2/4 [00:00<00:00,  7.51it/s] 75%|███████▌  | 3/4 [00:00<00:00,  8.18it/s] 75%|███████▌  | 3/4 [00:00<00:00,  6.20it/s]
2025-03-09 08:21:15,996 [INFO]: 	>>> Finished "Compute fast metrics" in 22.1009 secs
2025-03-09 08:21:15,998 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 92.6184 secs
2025-03-09 08:21:15,998 [INFO]: {
2025-03-09 08:21:15,998 [INFO]: 	index_key: HNSW15
2025-03-09 08:21:15,998 [INFO]: 	index_param: efSearch=147
2025-03-09 08:21:15,998 [INFO]: 	index_path: knn.index
2025-03-09 08:21:15,998 [INFO]: 	size in bytes: 1620581170
2025-03-09 08:21:15,998 [INFO]: 	avg_search_speed_ms: 9.62514301073577
2025-03-09 08:21:15,998 [INFO]: 	99p_search_speed_ms: 20.210615377873175
2025-03-09 08:21:15,998 [INFO]: 	reconstruction error %: 0.0
2025-03-09 08:21:15,998 [INFO]: 	nb vectors: 8237
2025-03-09 08:21:15,998 [INFO]: 	vectors dimension: 49152
2025-03-09 08:21:15,998 [INFO]: 	compression ratio: 0.9993082271837084
2025-03-09 08:21:15,998 [INFO]: }
2025-03-09 08:21:15,998 [INFO]: 	>>> Finished "Creating the index" in 92.6204 secs
2025-03-09 08:21:15,998 [INFO]: >>> Finished "Launching the whole pipeline" in 92.6561 secs
2025-03-09 08:21:17: [retrieval_preprocessing] calculating distances ...
2025-03-09 08:21:18: [retrieval_preprocessing] finished and saved retrieval indices for episode 14496 [episode count 14/20]
[retrieval_preprocessing] for episode 42659 [episode count 15/20], we have num_retrieval=np.int64(8360) num_query=np.int64(302)
2025-03-09 08:21:20,282 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-09 08:21:21,724 [INFO]: Launching the whole pipeline 03/09/2025, 08:21:21
2025-03-09 08:21:21,724 [INFO]: Reading total number of vectors and dimension 03/09/2025, 08:21:21
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1325.21it/s]
2025-03-09 08:21:21,756 [INFO]: There are 8360 embeddings of dim 49152
2025-03-09 08:21:21,756 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0324 secs
2025-03-09 08:21:21,757 [INFO]: 	Compute estimated construction time of the index 03/09/2025, 08:21:21
2025-03-09 08:21:21,757 [INFO]: 		-> Train: 16.7 minutes
2025-03-09 08:21:21,757 [INFO]: 		-> Add: 4.6 seconds
2025-03-09 08:21:21,757 [INFO]: 		Total: 16.7 minutes
2025-03-09 08:21:21,757 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0001 secs
2025-03-09 08:21:21,757 [INFO]: 	Checking that your have enough memory available to create the index 03/09/2025, 08:21:21
2025-03-09 08:21:21,757 [INFO]: 1.7GB of memory will be needed to build the index (more might be used if you have more)
2025-03-09 08:21:21,757 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0002 secs
2025-03-09 08:21:21,757 [INFO]: 	Selecting most promising index types given data characteristics 03/09/2025, 08:21:21
2025-03-09 08:21:21,757 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-09 08:21:21,757 [INFO]: 	Creating the index 03/09/2025, 08:21:21
2025-03-09 08:21:21,757 [INFO]: 		-> Instanciate the index HNSW15 03/09/2025, 08:21:21
2025-03-09 08:21:21,758 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0013 secs
2025-03-09 08:21:21,759 [INFO]: 		-> Adding the vectors to the index 03/09/2025, 08:21:21
2025-03-09 08:21:21,759 [INFO]: The memory available for adding the vectors is 48.5GB(total available - used by the index)
2025-03-09 08:21:21,759 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/34 [00:00<?, ?it/s]  3%|▎         | 1/34 [00:00<00:03,  8.33it/s] 18%|█▊        | 6/34 [00:00<00:00, 29.32it/s] 32%|███▏      | 11/34 [00:00<00:00, 36.86it/s] 44%|████▍     | 15/34 [00:00<00:00, 36.35it/s] 59%|█████▉    | 20/34 [00:00<00:00, 40.28it/s] 74%|███████▎  | 25/34 [00:04<00:02,  3.16it/s] 91%|█████████ | 31/34 [00:04<00:00,  4.97it/s]100%|██████████| 34/34 [00:08<00:00,  4.05it/s]
2025-03-09 08:21:30,158 [INFO]: 	Computing best hyperparameters for index knn.index 03/09/2025, 08:21:30
2025-03-09 08:22:32,373 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 62.2144 secs
2025-03-09 08:22:32,373 [INFO]: The best hyperparameters are: efSearch=148
2025-03-09 08:22:32,373 [INFO]: 	Compute fast metrics 03/09/2025, 08:22:32
  0%|          | 0/4 [00:00<?, ?it/s] 25%|██▌       | 1/4 [00:00<00:00,  8.54it/s] 75%|███████▌  | 3/4 [00:00<00:00, 16.02it/s]
2025-03-09 08:22:54,983 [INFO]: 	>>> Finished "Compute fast metrics" in 22.6098 secs
2025-03-09 08:22:55,328 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 93.5691 secs
2025-03-09 08:22:55,328 [INFO]: {
2025-03-09 08:22:55,328 [INFO]: 	index_key: HNSW15
2025-03-09 08:22:55,328 [INFO]: 	index_param: efSearch=148
2025-03-09 08:22:55,328 [INFO]: 	index_path: knn.index
2025-03-09 08:22:55,328 [INFO]: 	size in bytes: 1644780430
2025-03-09 08:22:55,328 [INFO]: 	avg_search_speed_ms: 8.575822311568539
2025-03-09 08:22:55,328 [INFO]: 	99p_search_speed_ms: 23.157525085844025
2025-03-09 08:22:55,328 [INFO]: 	reconstruction error %: 0.0
2025-03-09 08:22:55,329 [INFO]: 	nb vectors: 8360
2025-03-09 08:22:55,329 [INFO]: 	vectors dimension: 49152
2025-03-09 08:22:55,329 [INFO]: 	compression ratio: 0.9993083879287158
2025-03-09 08:22:55,329 [INFO]: }
2025-03-09 08:22:55,329 [INFO]: 	>>> Finished "Creating the index" in 93.5716 secs
2025-03-09 08:22:55,329 [INFO]: >>> Finished "Launching the whole pipeline" in 93.6048 secs
2025-03-09 08:22:56: [retrieval_preprocessing] calculating distances ...
2025-03-09 08:22:57: [retrieval_preprocessing] finished and saved retrieval indices for episode 42659 [episode count 15/20]
[retrieval_preprocessing] for episode 78244 [episode count 16/20], we have num_retrieval=np.int64(8189) num_query=np.int64(473)
2025-03-09 08:22:58,289 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-09 08:22:59,486 [INFO]: Launching the whole pipeline 03/09/2025, 08:22:59
2025-03-09 08:22:59,486 [INFO]: Reading total number of vectors and dimension 03/09/2025, 08:22:59
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1233.98it/s]
2025-03-09 08:22:59,514 [INFO]: There are 8189 embeddings of dim 49152
2025-03-09 08:22:59,514 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0273 secs
2025-03-09 08:22:59,514 [INFO]: 	Compute estimated construction time of the index 03/09/2025, 08:22:59
2025-03-09 08:22:59,514 [INFO]: 		-> Train: 16.7 minutes
2025-03-09 08:22:59,514 [INFO]: 		-> Add: 4.5 seconds
2025-03-09 08:22:59,514 [INFO]: 		Total: 16.7 minutes
2025-03-09 08:22:59,514 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0001 secs
2025-03-09 08:22:59,514 [INFO]: 	Checking that your have enough memory available to create the index 03/09/2025, 08:22:59
2025-03-09 08:22:59,514 [INFO]: 1.7GB of memory will be needed to build the index (more might be used if you have more)
2025-03-09 08:22:59,514 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0001 secs
2025-03-09 08:22:59,514 [INFO]: 	Selecting most promising index types given data characteristics 03/09/2025, 08:22:59
2025-03-09 08:22:59,514 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-09 08:22:59,514 [INFO]: 	Creating the index 03/09/2025, 08:22:59
2025-03-09 08:22:59,514 [INFO]: 		-> Instanciate the index HNSW15 03/09/2025, 08:22:59
2025-03-09 08:22:59,515 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0008 secs
2025-03-09 08:22:59,515 [INFO]: 		-> Adding the vectors to the index 03/09/2025, 08:22:59
2025-03-09 08:22:59,515 [INFO]: The memory available for adding the vectors is 48.5GB(total available - used by the index)
2025-03-09 08:22:59,516 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/34 [00:00<?, ?it/s]  3%|▎         | 1/34 [00:00<00:04,  7.29it/s] 18%|█▊        | 6/34 [00:00<00:00, 28.59it/s] 29%|██▉       | 10/34 [00:00<00:01, 23.56it/s] 44%|████▍     | 15/34 [00:00<00:00, 30.32it/s] 62%|██████▏   | 21/34 [00:04<00:04,  3.07it/s] 76%|███████▋  | 26/34 [00:04<00:01,  4.54it/s] 94%|█████████▍| 32/34 [00:04<00:00,  6.83it/s]100%|██████████| 34/34 [00:08<00:00,  4.10it/s]
2025-03-09 08:23:07,821 [INFO]: 	Computing best hyperparameters for index knn.index 03/09/2025, 08:23:07
2025-03-09 08:24:08,413 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 60.5905 secs
2025-03-09 08:24:08,413 [INFO]: The best hyperparameters are: efSearch=159
2025-03-09 08:24:08,413 [INFO]: 	Compute fast metrics 03/09/2025, 08:24:08
  0%|          | 0/4 [00:00<?, ?it/s] 50%|█████     | 2/4 [00:00<00:00, 19.72it/s] 75%|███████▌  | 3/4 [00:00<00:00, 21.15it/s]
2025-03-09 08:24:32,600 [INFO]: 	>>> Finished "Compute fast metrics" in 24.1869 secs
2025-03-09 08:24:32,602 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 93.0865 secs
2025-03-09 08:24:32,602 [INFO]: {
2025-03-09 08:24:32,602 [INFO]: 	index_key: HNSW15
2025-03-09 08:24:32,602 [INFO]: 	index_param: efSearch=159
2025-03-09 08:24:32,602 [INFO]: 	index_path: knn.index
2025-03-09 08:24:32,602 [INFO]: 	size in bytes: 1611137530
2025-03-09 08:24:32,602 [INFO]: 	avg_search_speed_ms: 10.8153191883419
2025-03-09 08:24:32,602 [INFO]: 	99p_search_speed_ms: 21.736645167693496
2025-03-09 08:24:32,602 [INFO]: 	reconstruction error %: 0.0
2025-03-09 08:24:32,602 [INFO]: 	nb vectors: 8189
2025-03-09 08:24:32,602 [INFO]: 	vectors dimension: 49152
2025-03-09 08:24:32,602 [INFO]: 	compression ratio: 0.9993081794823562
2025-03-09 08:24:32,602 [INFO]: }
2025-03-09 08:24:32,602 [INFO]: 	>>> Finished "Creating the index" in 93.0879 secs
2025-03-09 08:24:32,602 [INFO]: >>> Finished "Launching the whole pipeline" in 93.1158 secs
2025-03-09 08:24:33: [retrieval_preprocessing] calculating distances ...
2025-03-09 08:24:35: [retrieval_preprocessing] finished and saved retrieval indices for episode 78244 [episode count 16/20]
[retrieval_preprocessing] for episode 24487 [episode count 17/20], we have num_retrieval=np.int64(8310) num_query=np.int64(352)
2025-03-09 08:24:36,104 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-09 08:24:37,097 [INFO]: Launching the whole pipeline 03/09/2025, 08:24:37
2025-03-09 08:24:37,097 [INFO]: Reading total number of vectors and dimension 03/09/2025, 08:24:37
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 999.12it/s]
2025-03-09 08:24:37,126 [INFO]: There are 8310 embeddings of dim 49152
2025-03-09 08:24:37,127 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0295 secs
2025-03-09 08:24:37,127 [INFO]: 	Compute estimated construction time of the index 03/09/2025, 08:24:37
2025-03-09 08:24:37,127 [INFO]: 		-> Train: 16.7 minutes
2025-03-09 08:24:37,127 [INFO]: 		-> Add: 4.6 seconds
2025-03-09 08:24:37,128 [INFO]: 		Total: 16.7 minutes
2025-03-09 08:24:37,128 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0003 secs
2025-03-09 08:24:37,128 [INFO]: 	Checking that your have enough memory available to create the index 03/09/2025, 08:24:37
2025-03-09 08:24:37,128 [INFO]: 1.7GB of memory will be needed to build the index (more might be used if you have more)
2025-03-09 08:24:37,128 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0005 secs
2025-03-09 08:24:37,128 [INFO]: 	Selecting most promising index types given data characteristics 03/09/2025, 08:24:37
2025-03-09 08:24:37,129 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-09 08:24:37,129 [INFO]: 	Creating the index 03/09/2025, 08:24:37
2025-03-09 08:24:37,129 [INFO]: 		-> Instanciate the index HNSW15 03/09/2025, 08:24:37
2025-03-09 08:24:37,132 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0029 secs
2025-03-09 08:24:37,132 [INFO]: 		-> Adding the vectors to the index 03/09/2025, 08:24:37
2025-03-09 08:24:37,132 [INFO]: The memory available for adding the vectors is 48.5GB(total available - used by the index)
2025-03-09 08:24:37,132 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/34 [00:00<?, ?it/s]  6%|▌         | 2/34 [00:00<00:01, 16.80it/s] 24%|██▎       | 8/34 [00:00<00:00, 38.25it/s] 41%|████      | 14/34 [00:00<00:00, 45.63it/s] 59%|█████▉    | 20/34 [00:00<00:00, 47.50it/s] 74%|███████▎  | 25/34 [00:04<00:02,  3.38it/s] 91%|█████████ | 31/34 [00:04<00:00,  5.16it/s]100%|██████████| 34/34 [00:08<00:00,  4.22it/s]
2025-03-09 08:24:45,198 [INFO]: 	Computing best hyperparameters for index knn.index 03/09/2025, 08:24:45
2025-03-09 08:25:43,161 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 57.9619 secs
2025-03-09 08:25:43,161 [INFO]: The best hyperparameters are: efSearch=119
2025-03-09 08:25:43,161 [INFO]: 	Compute fast metrics 03/09/2025, 08:25:43
  0%|          | 0/4 [00:00<?, ?it/s] 50%|█████     | 2/4 [00:00<00:00, 18.26it/s] 75%|███████▌  | 3/4 [00:00<00:00, 19.66it/s]
2025-03-09 08:26:00,792 [INFO]: 	>>> Finished "Compute fast metrics" in 17.6309 secs
2025-03-09 08:26:00,794 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 83.6621 secs
2025-03-09 08:26:00,794 [INFO]: {
2025-03-09 08:26:00,794 [INFO]: 	index_key: HNSW15
2025-03-09 08:26:00,794 [INFO]: 	index_param: efSearch=119
2025-03-09 08:26:00,794 [INFO]: 	index_path: knn.index
2025-03-09 08:26:00,794 [INFO]: 	size in bytes: 1634943370
2025-03-09 08:26:00,794 [INFO]: 	avg_search_speed_ms: 7.878564783079158
2025-03-09 08:26:00,794 [INFO]: 	99p_search_speed_ms: 15.901429578661904
2025-03-09 08:26:00,794 [INFO]: 	reconstruction error %: 0.0
2025-03-09 08:26:00,794 [INFO]: 	nb vectors: 8310
2025-03-09 08:26:00,794 [INFO]: 	vectors dimension: 49152
2025-03-09 08:26:00,794 [INFO]: 	compression ratio: 0.999308300201248
2025-03-09 08:26:00,795 [INFO]: }
2025-03-09 08:26:00,795 [INFO]: 	>>> Finished "Creating the index" in 83.6659 secs
2025-03-09 08:26:00,795 [INFO]: >>> Finished "Launching the whole pipeline" in 83.6972 secs
2025-03-09 08:26:01: [retrieval_preprocessing] calculating distances ...
2025-03-09 08:26:02: [retrieval_preprocessing] finished and saved retrieval indices for episode 24487 [episode count 17/20]
[retrieval_preprocessing] for episode 31527 [episode count 18/20], we have num_retrieval=np.int64(8195) num_query=np.int64(467)
2025-03-09 08:26:03,492 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-09 08:26:04,561 [INFO]: Launching the whole pipeline 03/09/2025, 08:26:04
2025-03-09 08:26:04,561 [INFO]: Reading total number of vectors and dimension 03/09/2025, 08:26:04
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1328.99it/s]
2025-03-09 08:26:04,586 [INFO]: There are 8195 embeddings of dim 49152
2025-03-09 08:26:04,586 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0247 secs
2025-03-09 08:26:04,586 [INFO]: 	Compute estimated construction time of the index 03/09/2025, 08:26:04
2025-03-09 08:26:04,586 [INFO]: 		-> Train: 16.7 minutes
2025-03-09 08:26:04,586 [INFO]: 		-> Add: 4.5 seconds
2025-03-09 08:26:04,586 [INFO]: 		Total: 16.7 minutes
2025-03-09 08:26:04,586 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0002 secs
2025-03-09 08:26:04,586 [INFO]: 	Checking that your have enough memory available to create the index 03/09/2025, 08:26:04
2025-03-09 08:26:04,586 [INFO]: 1.7GB of memory will be needed to build the index (more might be used if you have more)
2025-03-09 08:26:04,586 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0001 secs
2025-03-09 08:26:04,586 [INFO]: 	Selecting most promising index types given data characteristics 03/09/2025, 08:26:04
2025-03-09 08:26:04,586 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-09 08:26:04,586 [INFO]: 	Creating the index 03/09/2025, 08:26:04
2025-03-09 08:26:04,587 [INFO]: 		-> Instanciate the index HNSW15 03/09/2025, 08:26:04
2025-03-09 08:26:04,588 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0010 secs
2025-03-09 08:26:04,588 [INFO]: 		-> Adding the vectors to the index 03/09/2025, 08:26:04
2025-03-09 08:26:04,588 [INFO]: The memory available for adding the vectors is 48.5GB(total available - used by the index)
2025-03-09 08:26:04,588 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/34 [00:00<?, ?it/s]  3%|▎         | 1/34 [00:00<00:04,  7.07it/s] 15%|█▍        | 5/34 [00:00<00:01, 23.48it/s] 29%|██▉       | 10/34 [00:00<00:00, 33.45it/s] 44%|████▍     | 15/34 [00:00<00:00, 38.65it/s] 62%|██████▏   | 21/34 [00:04<00:04,  2.97it/s] 76%|███████▋  | 26/34 [00:04<00:01,  4.39it/s] 94%|█████████▍| 32/34 [00:05<00:00,  6.68it/s]100%|██████████| 34/34 [00:08<00:00,  4.12it/s]
2025-03-09 08:26:12,835 [INFO]: 	Computing best hyperparameters for index knn.index 03/09/2025, 08:26:12
2025-03-09 08:27:11,244 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 58.4082 secs
2025-03-09 08:27:11,244 [INFO]: The best hyperparameters are: efSearch=140
2025-03-09 08:27:11,244 [INFO]: 	Compute fast metrics 03/09/2025, 08:27:11
  0%|          | 0/4 [00:00<?, ?it/s] 25%|██▌       | 1/4 [00:00<00:00,  9.62it/s] 75%|███████▌  | 3/4 [00:00<00:00, 18.47it/s]
2025-03-09 08:27:34,888 [INFO]: 	>>> Finished "Compute fast metrics" in 23.6439 secs
2025-03-09 08:27:34,890 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 90.3024 secs
2025-03-09 08:27:34,890 [INFO]: {
2025-03-09 08:27:34,890 [INFO]: 	index_key: HNSW15
2025-03-09 08:27:34,890 [INFO]: 	index_param: efSearch=140
2025-03-09 08:27:34,890 [INFO]: 	index_path: knn.index
2025-03-09 08:27:34,890 [INFO]: 	size in bytes: 1612318090
2025-03-09 08:27:34,890 [INFO]: 	avg_search_speed_ms: 7.732657745749922
2025-03-09 08:27:34,890 [INFO]: 	99p_search_speed_ms: 13.603683887049547
2025-03-09 08:27:34,890 [INFO]: 	reconstruction error %: 0.0
2025-03-09 08:27:34,890 [INFO]: 	nb vectors: 8195
2025-03-09 08:27:34,890 [INFO]: 	vectors dimension: 49152
2025-03-09 08:27:34,890 [INFO]: 	compression ratio: 0.9993081203970118
2025-03-09 08:27:34,890 [INFO]: }
2025-03-09 08:27:34,890 [INFO]: 	>>> Finished "Creating the index" in 90.3039 secs
2025-03-09 08:27:34,890 [INFO]: >>> Finished "Launching the whole pipeline" in 90.3293 secs
2025-03-09 08:27:36: [retrieval_preprocessing] calculating distances ...
2025-03-09 08:27:38: [retrieval_preprocessing] finished and saved retrieval indices for episode 31527 [episode count 18/20]
[retrieval_preprocessing] for episode 2988 [episode count 19/20], we have num_retrieval=np.int64(8212) num_query=np.int64(450)
2025-03-09 08:27:38,755 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-09 08:27:39,998 [INFO]: Launching the whole pipeline 03/09/2025, 08:27:39
2025-03-09 08:27:39,998 [INFO]: Reading total number of vectors and dimension 03/09/2025, 08:27:39
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1344.33it/s]
2025-03-09 08:27:40,026 [INFO]: There are 8212 embeddings of dim 49152
2025-03-09 08:27:40,026 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0278 secs
2025-03-09 08:27:40,026 [INFO]: 	Compute estimated construction time of the index 03/09/2025, 08:27:40
2025-03-09 08:27:40,026 [INFO]: 		-> Train: 16.7 minutes
2025-03-09 08:27:40,026 [INFO]: 		-> Add: 4.5 seconds
2025-03-09 08:27:40,026 [INFO]: 		Total: 16.7 minutes
2025-03-09 08:27:40,026 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0001 secs
2025-03-09 08:27:40,026 [INFO]: 	Checking that your have enough memory available to create the index 03/09/2025, 08:27:40
2025-03-09 08:27:40,026 [INFO]: 1.7GB of memory will be needed to build the index (more might be used if you have more)
2025-03-09 08:27:40,026 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0002 secs
2025-03-09 08:27:40,026 [INFO]: 	Selecting most promising index types given data characteristics 03/09/2025, 08:27:40
2025-03-09 08:27:40,026 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-09 08:27:40,026 [INFO]: 	Creating the index 03/09/2025, 08:27:40
2025-03-09 08:27:40,027 [INFO]: 		-> Instanciate the index HNSW15 03/09/2025, 08:27:40
2025-03-09 08:27:40,028 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0011 secs
2025-03-09 08:27:40,028 [INFO]: 		-> Adding the vectors to the index 03/09/2025, 08:27:40
2025-03-09 08:27:40,028 [INFO]: The memory available for adding the vectors is 48.5GB(total available - used by the index)
2025-03-09 08:27:40,028 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/34 [00:00<?, ?it/s]  3%|▎         | 1/34 [00:00<00:03,  8.75it/s] 18%|█▊        | 6/34 [00:00<00:00, 29.21it/s] 32%|███▏      | 11/34 [00:00<00:00, 31.28it/s] 47%|████▋     | 16/34 [00:00<00:00, 36.91it/s] 62%|██████▏   | 21/34 [00:04<00:04,  2.95it/s] 79%|███████▉  | 27/34 [00:04<00:01,  4.73it/s] 91%|█████████ | 31/34 [00:04<00:00,  6.21it/s]100%|██████████| 34/34 [00:08<00:00,  4.21it/s]
2025-03-09 08:27:48,112 [INFO]: 	Computing best hyperparameters for index knn.index 03/09/2025, 08:27:48
2025-03-09 08:28:47,375 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 59.2622 secs
2025-03-09 08:28:47,375 [INFO]: The best hyperparameters are: efSearch=187
2025-03-09 08:28:47,375 [INFO]: 	Compute fast metrics 03/09/2025, 08:28:47
  0%|          | 0/4 [00:00<?, ?it/s] 50%|█████     | 2/4 [00:00<00:00, 18.98it/s] 75%|███████▌  | 3/4 [00:00<00:00, 20.19it/s]
2025-03-09 08:29:06,194 [INFO]: 	>>> Finished "Compute fast metrics" in 18.8193 secs
2025-03-09 08:29:06,196 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 86.1685 secs
2025-03-09 08:29:06,197 [INFO]: {
2025-03-09 08:29:06,197 [INFO]: 	index_key: HNSW15
2025-03-09 08:29:06,197 [INFO]: 	index_param: efSearch=187
2025-03-09 08:29:06,197 [INFO]: 	index_path: knn.index
2025-03-09 08:29:06,197 [INFO]: 	size in bytes: 1615662670
2025-03-09 08:29:06,197 [INFO]: 	avg_search_speed_ms: 10.517726915268586
2025-03-09 08:29:06,197 [INFO]: 	99p_search_speed_ms: 21.16951602511108
2025-03-09 08:29:06,197 [INFO]: 	reconstruction error %: 0.0
2025-03-09 08:29:06,197 [INFO]: 	nb vectors: 8212
2025-03-09 08:29:06,197 [INFO]: 	vectors dimension: 49152
2025-03-09 08:29:06,197 [INFO]: 	compression ratio: 0.9993081637517812
2025-03-09 08:29:06,197 [INFO]: }
2025-03-09 08:29:06,197 [INFO]: 	>>> Finished "Creating the index" in 86.1702 secs
2025-03-09 08:29:06,197 [INFO]: >>> Finished "Launching the whole pipeline" in 86.1986 secs
2025-03-09 08:29:08: [retrieval_preprocessing] calculating distances ...
2025-03-09 08:29:09: [retrieval_preprocessing] finished and saved retrieval indices for episode 2988 [episode count 19/20]
2025-03-09 08:29:09: [retrieval_preprocessing] finished for (1526685371, 'marker') [chosen_id count 3/10]
2025-03-09 08:29:11: [retrieval_preprocessing] concatenated all embeddings and indices for 20 episodes for (6074146895, 'lid') [chosen_id count 4/10]
2025-03-09 08:29:11: [retrieval_preprocessing] we have num_total=3790 embedding_dim=49152
[retrieval_preprocessing] for episode 66048 [episode count 0/20], we have num_retrieval=np.int64(3669) num_query=np.int64(121)
2025-03-09 08:29:11,758 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-09 08:29:12,233 [INFO]: Launching the whole pipeline 03/09/2025, 08:29:12
2025-03-09 08:29:12,233 [INFO]: Reading total number of vectors and dimension 03/09/2025, 08:29:12
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1374.28it/s]
2025-03-09 08:29:12,258 [INFO]: There are 3669 embeddings of dim 49152
2025-03-09 08:29:12,258 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0251 secs
2025-03-09 08:29:12,258 [INFO]: 	Compute estimated construction time of the index 03/09/2025, 08:29:12
2025-03-09 08:29:12,258 [INFO]: 		-> Train: 16.7 minutes
2025-03-09 08:29:12,258 [INFO]: 		-> Add: 2.0 seconds
2025-03-09 08:29:12,258 [INFO]: 		Total: 16.7 minutes
2025-03-09 08:29:12,258 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0001 secs
2025-03-09 08:29:12,258 [INFO]: 	Checking that your have enough memory available to create the index 03/09/2025, 08:29:12
2025-03-09 08:29:12,258 [INFO]: 757.2MB of memory will be needed to build the index (more might be used if you have more)
2025-03-09 08:29:12,258 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0001 secs
2025-03-09 08:29:12,258 [INFO]: 	Selecting most promising index types given data characteristics 03/09/2025, 08:29:12
2025-03-09 08:29:12,258 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-09 08:29:12,258 [INFO]: 	Creating the index 03/09/2025, 08:29:12
2025-03-09 08:29:12,258 [INFO]: 		-> Instanciate the index HNSW15 03/09/2025, 08:29:12
2025-03-09 08:29:12,259 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0010 secs
2025-03-09 08:29:12,260 [INFO]: 		-> Adding the vectors to the index 03/09/2025, 08:29:12
2025-03-09 08:29:12,260 [INFO]: The memory available for adding the vectors is 49.3GB(total available - used by the index)
2025-03-09 08:29:12,260 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/15 [00:00<?, ?it/s]  7%|▋         | 1/15 [00:00<00:01,  7.52it/s] 47%|████▋     | 7/15 [00:00<00:00, 32.48it/s] 87%|████████▋ | 13/15 [00:00<00:00, 41.81it/s]100%|██████████| 15/15 [00:02<00:00,  5.18it/s]
2025-03-09 08:29:15,157 [INFO]: 	Computing best hyperparameters for index knn.index 03/09/2025, 08:29:15
2025-03-09 08:29:52,410 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 37.2520 secs
2025-03-09 08:29:52,410 [INFO]: The best hyperparameters are: efSearch=258
2025-03-09 08:29:52,410 [INFO]: 	Compute fast metrics 03/09/2025, 08:29:52
  0%|          | 0/4 [00:00<?, ?it/s] 50%|█████     | 2/4 [00:00<00:00, 18.54it/s] 75%|███████▌  | 3/4 [00:00<00:00, 20.15it/s]
2025-03-09 08:30:09,932 [INFO]: 	>>> Finished "Compute fast metrics" in 17.5219 secs
2025-03-09 08:30:09,934 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 57.6745 secs
2025-03-09 08:30:09,934 [INFO]: {
2025-03-09 08:30:09,934 [INFO]: 	index_key: HNSW15
2025-03-09 08:30:09,934 [INFO]: 	index_param: efSearch=258
2025-03-09 08:30:09,934 [INFO]: 	index_path: knn.index
2025-03-09 08:30:09,934 [INFO]: 	size in bytes: 721853350
2025-03-09 08:30:09,934 [INFO]: 	avg_search_speed_ms: 11.09683559122149
2025-03-09 08:30:09,934 [INFO]: 	99p_search_speed_ms: 25.904373032972217
2025-03-09 08:30:09,934 [INFO]: 	reconstruction error %: 0.0
2025-03-09 08:30:09,934 [INFO]: 	nb vectors: 3669
2025-03-09 08:30:09,934 [INFO]: 	vectors dimension: 49152
2025-03-09 08:30:09,935 [INFO]: 	compression ratio: 0.9993092807562645
2025-03-09 08:30:09,935 [INFO]: }
2025-03-09 08:30:09,935 [INFO]: 	>>> Finished "Creating the index" in 57.6761 secs
2025-03-09 08:30:09,935 [INFO]: >>> Finished "Launching the whole pipeline" in 57.7018 secs
2025-03-09 08:30:10: [retrieval_preprocessing] calculating distances ...
2025-03-09 08:30:11: [retrieval_preprocessing] finished and saved retrieval indices for episode 66048 [episode count 0/20]
[retrieval_preprocessing] for episode 17665 [episode count 1/20], we have num_retrieval=np.int64(3612) num_query=np.int64(178)
2025-03-09 08:30:11,412 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-09 08:30:11,884 [INFO]: Launching the whole pipeline 03/09/2025, 08:30:11
2025-03-09 08:30:11,884 [INFO]: Reading total number of vectors and dimension 03/09/2025, 08:30:11
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 2295.73it/s]
2025-03-09 08:30:11,906 [INFO]: There are 3612 embeddings of dim 49152
2025-03-09 08:30:11,906 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0221 secs
2025-03-09 08:30:11,906 [INFO]: 	Compute estimated construction time of the index 03/09/2025, 08:30:11
2025-03-09 08:30:11,906 [INFO]: 		-> Train: 16.7 minutes
2025-03-09 08:30:11,906 [INFO]: 		-> Add: 2.0 seconds
2025-03-09 08:30:11,906 [INFO]: 		Total: 16.7 minutes
2025-03-09 08:30:11,906 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0001 secs
2025-03-09 08:30:11,906 [INFO]: 	Checking that your have enough memory available to create the index 03/09/2025, 08:30:11
2025-03-09 08:30:11,906 [INFO]: 745.4MB of memory will be needed to build the index (more might be used if you have more)
2025-03-09 08:30:11,906 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0001 secs
2025-03-09 08:30:11,906 [INFO]: 	Selecting most promising index types given data characteristics 03/09/2025, 08:30:11
2025-03-09 08:30:11,906 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-09 08:30:11,906 [INFO]: 	Creating the index 03/09/2025, 08:30:11
2025-03-09 08:30:11,906 [INFO]: 		-> Instanciate the index HNSW15 03/09/2025, 08:30:11
2025-03-09 08:30:11,907 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0009 secs
2025-03-09 08:30:11,907 [INFO]: 		-> Adding the vectors to the index 03/09/2025, 08:30:11
2025-03-09 08:30:11,907 [INFO]: The memory available for adding the vectors is 49.3GB(total available - used by the index)
2025-03-09 08:30:11,907 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/15 [00:00<?, ?it/s] 13%|█▎        | 2/15 [00:00<00:00, 18.40it/s] 47%|████▋     | 7/15 [00:00<00:00, 34.12it/s] 87%|████████▋ | 13/15 [00:00<00:00, 44.83it/s]100%|██████████| 15/15 [00:03<00:00,  4.51it/s]
2025-03-09 08:30:15,239 [INFO]: 	Computing best hyperparameters for index knn.index 03/09/2025, 08:30:15
2025-03-09 08:30:48,802 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 33.5624 secs
2025-03-09 08:30:48,802 [INFO]: The best hyperparameters are: efSearch=210
2025-03-09 08:30:48,802 [INFO]: 	Compute fast metrics 03/09/2025, 08:30:48
  0%|          | 0/4 [00:00<?, ?it/s] 50%|█████     | 2/4 [00:00<00:00, 18.05it/s] 75%|███████▌  | 3/4 [00:00<00:00, 19.49it/s]
2025-03-09 08:31:07,912 [INFO]: 	>>> Finished "Compute fast metrics" in 19.1098 secs
2025-03-09 08:31:07,914 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 56.0066 secs
2025-03-09 08:31:07,915 [INFO]: {
2025-03-09 08:31:07,915 [INFO]: 	index_key: HNSW15
2025-03-09 08:31:07,915 [INFO]: 	index_param: efSearch=210
2025-03-09 08:31:07,915 [INFO]: 	index_path: knn.index
2025-03-09 08:31:07,915 [INFO]: 	size in bytes: 710638810
2025-03-09 08:31:07,915 [INFO]: 	avg_search_speed_ms: 8.794733385818379
2025-03-09 08:31:07,915 [INFO]: 	99p_search_speed_ms: 16.35838233865799
2025-03-09 08:31:07,915 [INFO]: 	reconstruction error %: 0.0
2025-03-09 08:31:07,915 [INFO]: 	nb vectors: 3612
2025-03-09 08:31:07,915 [INFO]: 	vectors dimension: 49152
2025-03-09 08:31:07,915 [INFO]: 	compression ratio: 0.9993094748090102
2025-03-09 08:31:07,915 [INFO]: }
2025-03-09 08:31:07,915 [INFO]: 	>>> Finished "Creating the index" in 56.0086 secs
2025-03-09 08:31:07,915 [INFO]: >>> Finished "Launching the whole pipeline" in 56.0312 secs
2025-03-09 08:31:08: [retrieval_preprocessing] calculating distances ...
2025-03-09 08:31:09: [retrieval_preprocessing] finished and saved retrieval indices for episode 17665 [episode count 1/20]
[retrieval_preprocessing] for episode 6275 [episode count 2/20], we have num_retrieval=np.int64(3615) num_query=np.int64(175)
2025-03-09 08:31:09,497 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-09 08:31:10,515 [INFO]: Launching the whole pipeline 03/09/2025, 08:31:10
2025-03-09 08:31:10,515 [INFO]: Reading total number of vectors and dimension 03/09/2025, 08:31:10
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1494.23it/s]
2025-03-09 08:31:10,541 [INFO]: There are 3615 embeddings of dim 49152
2025-03-09 08:31:10,542 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0269 secs
2025-03-09 08:31:10,542 [INFO]: 	Compute estimated construction time of the index 03/09/2025, 08:31:10
2025-03-09 08:31:10,542 [INFO]: 		-> Train: 16.7 minutes
2025-03-09 08:31:10,542 [INFO]: 		-> Add: 2.0 seconds
2025-03-09 08:31:10,542 [INFO]: 		Total: 16.7 minutes
2025-03-09 08:31:10,542 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0001 secs
2025-03-09 08:31:10,542 [INFO]: 	Checking that your have enough memory available to create the index 03/09/2025, 08:31:10
2025-03-09 08:31:10,542 [INFO]: 746.0MB of memory will be needed to build the index (more might be used if you have more)
2025-03-09 08:31:10,542 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0001 secs
2025-03-09 08:31:10,542 [INFO]: 	Selecting most promising index types given data characteristics 03/09/2025, 08:31:10
2025-03-09 08:31:10,542 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-09 08:31:10,542 [INFO]: 	Creating the index 03/09/2025, 08:31:10
2025-03-09 08:31:10,542 [INFO]: 		-> Instanciate the index HNSW15 03/09/2025, 08:31:10
2025-03-09 08:31:10,543 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0009 secs
2025-03-09 08:31:10,543 [INFO]: 		-> Adding the vectors to the index 03/09/2025, 08:31:10
2025-03-09 08:31:10,543 [INFO]: The memory available for adding the vectors is 49.3GB(total available - used by the index)
2025-03-09 08:31:10,543 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/15 [00:00<?, ?it/s]  7%|▋         | 1/15 [00:00<00:01,  8.70it/s] 40%|████      | 6/15 [00:00<00:00, 29.19it/s] 73%|███████▎  | 11/15 [00:00<00:00, 35.58it/s]100%|██████████| 15/15 [00:02<00:00,  3.86it/s]100%|██████████| 15/15 [00:02<00:00,  5.29it/s]
2025-03-09 08:31:13,384 [INFO]: 	Computing best hyperparameters for index knn.index 03/09/2025, 08:31:13
2025-03-09 08:31:47,779 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 34.3943 secs
2025-03-09 08:31:47,779 [INFO]: The best hyperparameters are: efSearch=222
2025-03-09 08:31:47,779 [INFO]: 	Compute fast metrics 03/09/2025, 08:31:47
  0%|          | 0/4 [00:00<?, ?it/s] 50%|█████     | 2/4 [00:00<00:00, 16.65it/s] 75%|███████▌  | 3/4 [00:00<00:00, 17.99it/s]
2025-03-09 08:32:03,839 [INFO]: 	>>> Finished "Compute fast metrics" in 16.0593 secs
2025-03-09 08:32:03,841 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 53.2973 secs
2025-03-09 08:32:03,841 [INFO]: {
2025-03-09 08:32:03,841 [INFO]: 	index_key: HNSW15
2025-03-09 08:32:03,841 [INFO]: 	index_param: efSearch=222
2025-03-09 08:32:03,841 [INFO]: 	index_path: knn.index
2025-03-09 08:32:03,841 [INFO]: 	size in bytes: 711229030
2025-03-09 08:32:03,841 [INFO]: 	avg_search_speed_ms: 10.667265166462993
2025-03-09 08:32:03,841 [INFO]: 	99p_search_speed_ms: 22.45557717513293
2025-03-09 08:32:03,841 [INFO]: 	reconstruction error %: 0.0
2025-03-09 08:32:03,841 [INFO]: 	nb vectors: 3615
2025-03-09 08:32:03,841 [INFO]: 	vectors dimension: 49152
2025-03-09 08:32:03,841 [INFO]: 	compression ratio: 0.9993094910650652
2025-03-09 08:32:03,841 [INFO]: }
2025-03-09 08:32:03,841 [INFO]: 	>>> Finished "Creating the index" in 53.2988 secs
2025-03-09 08:32:03,841 [INFO]: >>> Finished "Launching the whole pipeline" in 53.3263 secs
2025-03-09 08:32:04: [retrieval_preprocessing] calculating distances ...
2025-03-09 08:32:05: [retrieval_preprocessing] finished and saved retrieval indices for episode 6275 [episode count 2/20]
[retrieval_preprocessing] for episode 63369 [episode count 3/20], we have num_retrieval=np.int64(3570) num_query=np.int64(220)
2025-03-09 08:32:05,455 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-09 08:32:05,954 [INFO]: Launching the whole pipeline 03/09/2025, 08:32:05
2025-03-09 08:32:05,954 [INFO]: Reading total number of vectors and dimension 03/09/2025, 08:32:05
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1657.17it/s]
2025-03-09 08:32:05,988 [INFO]: There are 3570 embeddings of dim 49152
2025-03-09 08:32:05,988 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0342 secs
2025-03-09 08:32:05,989 [INFO]: 	Compute estimated construction time of the index 03/09/2025, 08:32:05
2025-03-09 08:32:05,989 [INFO]: 		-> Train: 16.7 minutes
2025-03-09 08:32:05,989 [INFO]: 		-> Add: 2.0 seconds
2025-03-09 08:32:05,989 [INFO]: 		Total: 16.7 minutes
2025-03-09 08:32:05,989 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0003 secs
2025-03-09 08:32:05,989 [INFO]: 	Checking that your have enough memory available to create the index 03/09/2025, 08:32:05
2025-03-09 08:32:05,989 [INFO]: 736.8MB of memory will be needed to build the index (more might be used if you have more)
2025-03-09 08:32:05,990 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0004 secs
2025-03-09 08:32:05,990 [INFO]: 	Selecting most promising index types given data characteristics 03/09/2025, 08:32:05
2025-03-09 08:32:05,990 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-09 08:32:05,990 [INFO]: 	Creating the index 03/09/2025, 08:32:05
2025-03-09 08:32:05,990 [INFO]: 		-> Instanciate the index HNSW15 03/09/2025, 08:32:05
2025-03-09 08:32:05,992 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0025 secs
2025-03-09 08:32:05,993 [INFO]: 		-> Adding the vectors to the index 03/09/2025, 08:32:05
2025-03-09 08:32:05,993 [INFO]: The memory available for adding the vectors is 49.3GB(total available - used by the index)
2025-03-09 08:32:05,993 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/15 [00:00<?, ?it/s]  7%|▋         | 1/15 [00:00<00:01,  7.86it/s] 40%|████      | 6/15 [00:00<00:00, 28.08it/s] 73%|███████▎  | 11/15 [00:00<00:00, 34.66it/s]100%|██████████| 15/15 [00:03<00:00,  3.60it/s]100%|██████████| 15/15 [00:03<00:00,  4.95it/s]
2025-03-09 08:32:09,030 [INFO]: 	Computing best hyperparameters for index knn.index 03/09/2025, 08:32:09
2025-03-09 08:32:44,285 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 35.2546 secs
2025-03-09 08:32:44,285 [INFO]: The best hyperparameters are: efSearch=203
2025-03-09 08:32:44,286 [INFO]: 	Compute fast metrics 03/09/2025, 08:32:44
  0%|          | 0/4 [00:00<?, ?it/s] 75%|███████▌  | 3/4 [00:00<00:00, 26.30it/s] 75%|███████▌  | 3/4 [00:00<00:00, 22.56it/s]
2025-03-09 08:32:58,350 [INFO]: 	>>> Finished "Compute fast metrics" in 14.0642 secs
2025-03-09 08:32:58,352 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 52.3592 secs
2025-03-09 08:32:58,352 [INFO]: {
2025-03-09 08:32:58,352 [INFO]: 	index_key: HNSW15
2025-03-09 08:32:58,352 [INFO]: 	index_param: efSearch=203
2025-03-09 08:32:58,352 [INFO]: 	index_path: knn.index
2025-03-09 08:32:58,352 [INFO]: 	size in bytes: 702375490
2025-03-09 08:32:58,352 [INFO]: 	avg_search_speed_ms: 9.118118475351752
2025-03-09 08:32:58,352 [INFO]: 	99p_search_speed_ms: 21.715917196124785
2025-03-09 08:32:58,352 [INFO]: 	reconstruction error %: 0.0
2025-03-09 08:32:58,352 [INFO]: 	nb vectors: 3570
2025-03-09 08:32:58,352 [INFO]: 	vectors dimension: 49152
2025-03-09 08:32:58,352 [INFO]: 	compression ratio: 0.9993095858171247
2025-03-09 08:32:58,352 [INFO]: }
2025-03-09 08:32:58,352 [INFO]: 	>>> Finished "Creating the index" in 52.3625 secs
2025-03-09 08:32:58,352 [INFO]: >>> Finished "Launching the whole pipeline" in 52.3982 secs
2025-03-09 08:32:59: [retrieval_preprocessing] calculating distances ...
2025-03-09 08:32:59: [retrieval_preprocessing] finished and saved retrieval indices for episode 63369 [episode count 3/20]
[retrieval_preprocessing] for episode 93961 [episode count 4/20], we have num_retrieval=np.int64(3647) num_query=np.int64(143)
2025-03-09 08:33:00,268 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-09 08:33:00,807 [INFO]: Launching the whole pipeline 03/09/2025, 08:33:00
2025-03-09 08:33:00,807 [INFO]: Reading total number of vectors and dimension 03/09/2025, 08:33:00
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1562.12it/s]
2025-03-09 08:33:00,836 [INFO]: There are 3647 embeddings of dim 49152
2025-03-09 08:33:00,836 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0285 secs
2025-03-09 08:33:00,836 [INFO]: 	Compute estimated construction time of the index 03/09/2025, 08:33:00
2025-03-09 08:33:00,837 [INFO]: 		-> Train: 16.7 minutes
2025-03-09 08:33:00,837 [INFO]: 		-> Add: 2.0 seconds
2025-03-09 08:33:00,837 [INFO]: 		Total: 16.7 minutes
2025-03-09 08:33:00,837 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0008 secs
2025-03-09 08:33:00,838 [INFO]: 	Checking that your have enough memory available to create the index 03/09/2025, 08:33:00
2025-03-09 08:33:00,838 [INFO]: 752.7MB of memory will be needed to build the index (more might be used if you have more)
2025-03-09 08:33:00,838 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0006 secs
2025-03-09 08:33:00,839 [INFO]: 	Selecting most promising index types given data characteristics 03/09/2025, 08:33:00
2025-03-09 08:33:00,839 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-09 08:33:00,839 [INFO]: 	Creating the index 03/09/2025, 08:33:00
2025-03-09 08:33:00,840 [INFO]: 		-> Instanciate the index HNSW15 03/09/2025, 08:33:00
2025-03-09 08:33:00,843 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0033 secs
2025-03-09 08:33:00,843 [INFO]: 		-> Adding the vectors to the index 03/09/2025, 08:33:00
2025-03-09 08:33:00,844 [INFO]: The memory available for adding the vectors is 49.3GB(total available - used by the index)
2025-03-09 08:33:00,844 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/15 [00:00<?, ?it/s] 13%|█▎        | 2/15 [00:00<00:00, 18.29it/s] 47%|████▋     | 7/15 [00:00<00:00, 31.50it/s] 87%|████████▋ | 13/15 [00:00<00:00, 40.69it/s]100%|██████████| 15/15 [00:02<00:00,  5.37it/s]
2025-03-09 08:33:03,643 [INFO]: 	Computing best hyperparameters for index knn.index 03/09/2025, 08:33:03
2025-03-09 08:33:37,997 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 34.3536 secs
2025-03-09 08:33:37,998 [INFO]: The best hyperparameters are: efSearch=168
2025-03-09 08:33:37,998 [INFO]: 	Compute fast metrics 03/09/2025, 08:33:37
  0%|          | 0/4 [00:00<?, ?it/s] 50%|█████     | 2/4 [00:00<00:00, 17.55it/s] 75%|███████▌  | 3/4 [00:00<00:00, 18.41it/s]
2025-03-09 08:33:54,430 [INFO]: 	>>> Finished "Compute fast metrics" in 16.4322 secs
2025-03-09 08:33:54,432 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 53.5887 secs
2025-03-09 08:33:54,432 [INFO]: {
2025-03-09 08:33:54,432 [INFO]: 	index_key: HNSW15
2025-03-09 08:33:54,433 [INFO]: 	index_param: efSearch=168
2025-03-09 08:33:54,433 [INFO]: 	index_path: knn.index
2025-03-09 08:33:54,433 [INFO]: 	size in bytes: 717525010
2025-03-09 08:33:54,433 [INFO]: 	avg_search_speed_ms: 7.774020958341322
2025-03-09 08:33:54,433 [INFO]: 	99p_search_speed_ms: 17.795625142753195
2025-03-09 08:33:54,433 [INFO]: 	reconstruction error %: 0.0
2025-03-09 08:33:54,433 [INFO]: 	nb vectors: 3647
2025-03-09 08:33:54,433 [INFO]: 	vectors dimension: 49152
2025-03-09 08:33:54,433 [INFO]: 	compression ratio: 0.9993092449836696
2025-03-09 08:33:54,433 [INFO]: }
2025-03-09 08:33:54,433 [INFO]: 	>>> Finished "Creating the index" in 53.5932 secs
2025-03-09 08:33:54,433 [INFO]: >>> Finished "Launching the whole pipeline" in 53.6252 secs
2025-03-09 08:33:54: [retrieval_preprocessing] calculating distances ...
2025-03-09 08:33:55: [retrieval_preprocessing] finished and saved retrieval indices for episode 93961 [episode count 4/20]
[retrieval_preprocessing] for episode 23821 [episode count 5/20], we have num_retrieval=np.int64(3601) num_query=np.int64(189)
2025-03-09 08:33:55,809 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-09 08:33:56,345 [INFO]: Launching the whole pipeline 03/09/2025, 08:33:56
2025-03-09 08:33:56,346 [INFO]: Reading total number of vectors and dimension 03/09/2025, 08:33:56
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1119.97it/s]
2025-03-09 08:33:56,373 [INFO]: There are 3601 embeddings of dim 49152
2025-03-09 08:33:56,373 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0279 secs
2025-03-09 08:33:56,374 [INFO]: 	Compute estimated construction time of the index 03/09/2025, 08:33:56
2025-03-09 08:33:56,374 [INFO]: 		-> Train: 16.7 minutes
2025-03-09 08:33:56,374 [INFO]: 		-> Add: 2.0 seconds
2025-03-09 08:33:56,374 [INFO]: 		Total: 16.7 minutes
2025-03-09 08:33:56,374 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0004 secs
2025-03-09 08:33:56,374 [INFO]: 	Checking that your have enough memory available to create the index 03/09/2025, 08:33:56
2025-03-09 08:33:56,374 [INFO]: 743.2MB of memory will be needed to build the index (more might be used if you have more)
2025-03-09 08:33:56,375 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0004 secs
2025-03-09 08:33:56,375 [INFO]: 	Selecting most promising index types given data characteristics 03/09/2025, 08:33:56
2025-03-09 08:33:56,375 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-09 08:33:56,375 [INFO]: 	Creating the index 03/09/2025, 08:33:56
2025-03-09 08:33:56,375 [INFO]: 		-> Instanciate the index HNSW15 03/09/2025, 08:33:56
2025-03-09 08:33:56,378 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0028 secs
2025-03-09 08:33:56,379 [INFO]: 		-> Adding the vectors to the index 03/09/2025, 08:33:56
2025-03-09 08:33:56,379 [INFO]: The memory available for adding the vectors is 49.3GB(total available - used by the index)
2025-03-09 08:33:56,379 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/15 [00:00<?, ?it/s] 20%|██        | 3/15 [00:00<00:00, 26.68it/s] 60%|██████    | 9/15 [00:00<00:00, 43.52it/s] 93%|█████████▎| 14/15 [00:00<00:00, 42.37it/s]100%|██████████| 15/15 [00:02<00:00,  5.56it/s]
2025-03-09 08:33:59,085 [INFO]: 	Computing best hyperparameters for index knn.index 03/09/2025, 08:33:59
2025-03-09 08:34:32,598 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 33.5130 secs
2025-03-09 08:34:32,598 [INFO]: The best hyperparameters are: efSearch=237
2025-03-09 08:34:32,598 [INFO]: 	Compute fast metrics 03/09/2025, 08:34:32
  0%|          | 0/4 [00:00<?, ?it/s] 25%|██▌       | 1/4 [00:00<00:00,  9.50it/s] 75%|███████▌  | 3/4 [00:00<00:00, 18.61it/s]
2025-03-09 08:34:49,946 [INFO]: 	>>> Finished "Compute fast metrics" in 17.3472 secs
2025-03-09 08:34:49,948 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 53.5692 secs
2025-03-09 08:34:49,948 [INFO]: {
2025-03-09 08:34:49,948 [INFO]: 	index_key: HNSW15
2025-03-09 08:34:49,948 [INFO]: 	index_param: efSearch=237
2025-03-09 08:34:49,948 [INFO]: 	index_path: knn.index
2025-03-09 08:34:49,948 [INFO]: 	size in bytes: 708474490
2025-03-09 08:34:49,948 [INFO]: 	avg_search_speed_ms: 9.938320136687311
2025-03-09 08:34:49,948 [INFO]: 	99p_search_speed_ms: 20.851102396845796
2025-03-09 08:34:49,948 [INFO]: 	reconstruction error %: 0.0
2025-03-09 08:34:49,948 [INFO]: 	nb vectors: 3601
2025-03-09 08:34:49,948 [INFO]: 	vectors dimension: 49152
2025-03-09 08:34:49,948 [INFO]: 	compression ratio: 0.9993096688633065
2025-03-09 08:34:49,948 [INFO]: }
2025-03-09 08:34:49,948 [INFO]: 	>>> Finished "Creating the index" in 53.5729 secs
2025-03-09 08:34:49,948 [INFO]: >>> Finished "Launching the whole pipeline" in 53.6027 secs
2025-03-09 08:34:52: [retrieval_preprocessing] calculating distances ...
2025-03-09 08:34:52: [retrieval_preprocessing] finished and saved retrieval indices for episode 23821 [episode count 5/20]
[retrieval_preprocessing] for episode 12558 [episode count 6/20], we have num_retrieval=np.int64(3646) num_query=np.int64(144)
2025-03-09 08:34:53,129 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-09 08:34:53,621 [INFO]: Launching the whole pipeline 03/09/2025, 08:34:53
2025-03-09 08:34:53,622 [INFO]: Reading total number of vectors and dimension 03/09/2025, 08:34:53
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 2165.36it/s]
2025-03-09 08:34:53,647 [INFO]: There are 3646 embeddings of dim 49152
2025-03-09 08:34:53,648 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0263 secs
2025-03-09 08:34:53,648 [INFO]: 	Compute estimated construction time of the index 03/09/2025, 08:34:53
2025-03-09 08:34:53,648 [INFO]: 		-> Train: 16.7 minutes
2025-03-09 08:34:53,648 [INFO]: 		-> Add: 2.0 seconds
2025-03-09 08:34:53,649 [INFO]: 		Total: 16.7 minutes
2025-03-09 08:34:53,649 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0004 secs
2025-03-09 08:34:53,649 [INFO]: 	Checking that your have enough memory available to create the index 03/09/2025, 08:34:53
2025-03-09 08:34:53,649 [INFO]: 752.4MB of memory will be needed to build the index (more might be used if you have more)
2025-03-09 08:34:53,649 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0004 secs
2025-03-09 08:34:53,649 [INFO]: 	Selecting most promising index types given data characteristics 03/09/2025, 08:34:53
2025-03-09 08:34:53,650 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-09 08:34:53,650 [INFO]: 	Creating the index 03/09/2025, 08:34:53
2025-03-09 08:34:53,650 [INFO]: 		-> Instanciate the index HNSW15 03/09/2025, 08:34:53
2025-03-09 08:34:53,653 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0025 secs
2025-03-09 08:34:53,653 [INFO]: 		-> Adding the vectors to the index 03/09/2025, 08:34:53
2025-03-09 08:34:53,653 [INFO]: The memory available for adding the vectors is 49.3GB(total available - used by the index)
2025-03-09 08:34:53,654 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/15 [00:00<?, ?it/s] 13%|█▎        | 2/15 [00:00<00:00, 18.77it/s] 53%|█████▎    | 8/15 [00:00<00:00, 40.06it/s] 93%|█████████▎| 14/15 [00:00<00:00, 46.63it/s]100%|██████████| 15/15 [00:02<00:00,  5.40it/s]
2025-03-09 08:34:56,435 [INFO]: 	Computing best hyperparameters for index knn.index 03/09/2025, 08:34:56
2025-03-09 08:35:30,359 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 33.9235 secs
2025-03-09 08:35:30,359 [INFO]: The best hyperparameters are: efSearch=187
2025-03-09 08:35:30,359 [INFO]: 	Compute fast metrics 03/09/2025, 08:35:30
  0%|          | 0/4 [00:00<?, ?it/s] 50%|█████     | 2/4 [00:00<00:00, 18.80it/s] 75%|███████▌  | 3/4 [00:00<00:00, 20.45it/s]
2025-03-09 08:35:46,039 [INFO]: 	>>> Finished "Compute fast metrics" in 15.6797 secs
2025-03-09 08:35:46,042 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 52.3889 secs
2025-03-09 08:35:46,042 [INFO]: {
2025-03-09 08:35:46,042 [INFO]: 	index_key: HNSW15
2025-03-09 08:35:46,042 [INFO]: 	index_param: efSearch=187
2025-03-09 08:35:46,042 [INFO]: 	index_path: knn.index
2025-03-09 08:35:46,042 [INFO]: 	size in bytes: 717328270
2025-03-09 08:35:46,042 [INFO]: 	avg_search_speed_ms: 8.833543899552994
2025-03-09 08:35:46,042 [INFO]: 	99p_search_speed_ms: 12.713500924874099
2025-03-09 08:35:46,042 [INFO]: 	reconstruction error %: 0.0
2025-03-09 08:35:46,042 [INFO]: 	nb vectors: 3646
2025-03-09 08:35:46,042 [INFO]: 	vectors dimension: 49152
2025-03-09 08:35:46,042 [INFO]: 	compression ratio: 0.9993092395480245
2025-03-09 08:35:46,043 [INFO]: }
2025-03-09 08:35:46,043 [INFO]: 	>>> Finished "Creating the index" in 52.3926 secs
2025-03-09 08:35:46,043 [INFO]: >>> Finished "Launching the whole pipeline" in 52.4210 secs
2025-03-09 08:35:46: [retrieval_preprocessing] calculating distances ...
2025-03-09 08:35:47: [retrieval_preprocessing] finished and saved retrieval indices for episode 12558 [episode count 6/20]
[retrieval_preprocessing] for episode 9750 [episode count 7/20], we have num_retrieval=np.int64(3567) num_query=np.int64(223)
2025-03-09 08:35:48,456 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-09 08:35:48,921 [INFO]: Launching the whole pipeline 03/09/2025, 08:35:48
2025-03-09 08:35:48,921 [INFO]: Reading total number of vectors and dimension 03/09/2025, 08:35:48
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1371.14it/s]
2025-03-09 08:35:48,950 [INFO]: There are 3567 embeddings of dim 49152
2025-03-09 08:35:48,950 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0293 secs
2025-03-09 08:35:48,950 [INFO]: 	Compute estimated construction time of the index 03/09/2025, 08:35:48
2025-03-09 08:35:48,950 [INFO]: 		-> Train: 16.7 minutes
2025-03-09 08:35:48,950 [INFO]: 		-> Add: 2.0 seconds
2025-03-09 08:35:48,950 [INFO]: 		Total: 16.7 minutes
2025-03-09 08:35:48,950 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0001 secs
2025-03-09 08:35:48,950 [INFO]: 	Checking that your have enough memory available to create the index 03/09/2025, 08:35:48
2025-03-09 08:35:48,951 [INFO]: 736.1MB of memory will be needed to build the index (more might be used if you have more)
2025-03-09 08:35:48,951 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0002 secs
2025-03-09 08:35:48,951 [INFO]: 	Selecting most promising index types given data characteristics 03/09/2025, 08:35:48
2025-03-09 08:35:48,951 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-09 08:35:48,951 [INFO]: 	Creating the index 03/09/2025, 08:35:48
2025-03-09 08:35:48,951 [INFO]: 		-> Instanciate the index HNSW15 03/09/2025, 08:35:48
2025-03-09 08:35:48,952 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0011 secs
2025-03-09 08:35:48,952 [INFO]: 		-> Adding the vectors to the index 03/09/2025, 08:35:48
2025-03-09 08:35:48,952 [INFO]: The memory available for adding the vectors is 49.3GB(total available - used by the index)
2025-03-09 08:35:48,952 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/15 [00:00<?, ?it/s]  7%|▋         | 1/15 [00:00<00:02,  5.83it/s] 20%|██        | 3/15 [00:00<00:01,  9.13it/s] 33%|███▎      | 5/15 [00:00<00:00, 11.66it/s] 47%|████▋     | 7/15 [00:00<00:00, 11.76it/s] 60%|██████    | 9/15 [00:00<00:00, 11.98it/s] 73%|███████▎  | 11/15 [00:00<00:00, 11.94it/s] 87%|████████▋ | 13/15 [00:01<00:00, 11.93it/s]100%|██████████| 15/15 [00:04<00:00,  1.91it/s]100%|██████████| 15/15 [00:04<00:00,  3.71it/s]
2025-03-09 08:35:52,999 [INFO]: 	Computing best hyperparameters for index knn.index 03/09/2025, 08:35:52
2025-03-09 08:36:33,753 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 40.7531 secs
2025-03-09 08:36:33,753 [INFO]: The best hyperparameters are: efSearch=132
2025-03-09 08:36:33,753 [INFO]: 	Compute fast metrics 03/09/2025, 08:36:33
  0%|          | 0/4 [00:00<?, ?it/s] 25%|██▌       | 1/4 [00:00<00:00,  9.08it/s] 75%|███████▌  | 3/4 [00:00<00:00, 17.11it/s]
2025-03-09 08:36:49,080 [INFO]: 	>>> Finished "Compute fast metrics" in 15.3263 secs
2025-03-09 08:36:49,083 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 60.1307 secs
2025-03-09 08:36:49,083 [INFO]: {
2025-03-09 08:36:49,083 [INFO]: 	index_key: HNSW15
2025-03-09 08:36:49,083 [INFO]: 	index_param: efSearch=132
2025-03-09 08:36:49,083 [INFO]: 	index_path: knn.index
2025-03-09 08:36:49,083 [INFO]: 	size in bytes: 701785270
2025-03-09 08:36:49,083 [INFO]: 	avg_search_speed_ms: 6.536264103326271
2025-03-09 08:36:49,083 [INFO]: 	99p_search_speed_ms: 11.490693809464577
2025-03-09 08:36:49,083 [INFO]: 	reconstruction error %: 0.0
2025-03-09 08:36:49,083 [INFO]: 	nb vectors: 3567
2025-03-09 08:36:49,083 [INFO]: 	vectors dimension: 49152
2025-03-09 08:36:49,083 [INFO]: 	compression ratio: 0.9993095694356765
2025-03-09 08:36:49,083 [INFO]: }
2025-03-09 08:36:49,083 [INFO]: 	>>> Finished "Creating the index" in 60.1324 secs
2025-03-09 08:36:49,083 [INFO]: >>> Finished "Launching the whole pipeline" in 60.1623 secs
2025-03-09 08:36:49: [retrieval_preprocessing] calculating distances ...
2025-03-09 08:36:50: [retrieval_preprocessing] finished and saved retrieval indices for episode 9750 [episode count 7/20]
[retrieval_preprocessing] for episode 37402 [episode count 8/20], we have num_retrieval=np.int64(3619) num_query=np.int64(171)
2025-03-09 08:36:51,620 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-09 08:36:52,140 [INFO]: Launching the whole pipeline 03/09/2025, 08:36:52
2025-03-09 08:36:52,140 [INFO]: Reading total number of vectors and dimension 03/09/2025, 08:36:52
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1343.04it/s]
2025-03-09 08:36:52,168 [INFO]: There are 3619 embeddings of dim 49152
2025-03-09 08:36:52,168 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0286 secs
2025-03-09 08:36:52,169 [INFO]: 	Compute estimated construction time of the index 03/09/2025, 08:36:52
2025-03-09 08:36:52,169 [INFO]: 		-> Train: 16.7 minutes
2025-03-09 08:36:52,169 [INFO]: 		-> Add: 2.0 seconds
2025-03-09 08:36:52,169 [INFO]: 		Total: 16.7 minutes
2025-03-09 08:36:52,169 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0002 secs
2025-03-09 08:36:52,169 [INFO]: 	Checking that your have enough memory available to create the index 03/09/2025, 08:36:52
2025-03-09 08:36:52,169 [INFO]: 746.9MB of memory will be needed to build the index (more might be used if you have more)
2025-03-09 08:36:52,169 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0002 secs
2025-03-09 08:36:52,169 [INFO]: 	Selecting most promising index types given data characteristics 03/09/2025, 08:36:52
2025-03-09 08:36:52,169 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-09 08:36:52,169 [INFO]: 	Creating the index 03/09/2025, 08:36:52
2025-03-09 08:36:52,169 [INFO]: 		-> Instanciate the index HNSW15 03/09/2025, 08:36:52
2025-03-09 08:36:52,171 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0012 secs
2025-03-09 08:36:52,171 [INFO]: 		-> Adding the vectors to the index 03/09/2025, 08:36:52
2025-03-09 08:36:52,171 [INFO]: The memory available for adding the vectors is 49.3GB(total available - used by the index)
2025-03-09 08:36:52,171 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/15 [00:00<?, ?it/s]  7%|▋         | 1/15 [00:00<00:02,  6.32it/s] 20%|██        | 3/15 [00:00<00:01,  9.85it/s] 33%|███▎      | 5/15 [00:00<00:00, 10.98it/s] 47%|████▋     | 7/15 [00:00<00:00, 11.60it/s] 60%|██████    | 9/15 [00:00<00:00, 11.79it/s] 73%|███████▎  | 11/15 [00:00<00:00, 11.97it/s] 87%|████████▋ | 13/15 [00:01<00:00, 12.24it/s]100%|██████████| 15/15 [00:03<00:00,  2.00it/s]100%|██████████| 15/15 [00:03<00:00,  3.86it/s]
2025-03-09 08:36:56,066 [INFO]: 	Computing best hyperparameters for index knn.index 03/09/2025, 08:36:56
2025-03-09 08:37:27,898 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 31.8317 secs
2025-03-09 08:37:27,898 [INFO]: The best hyperparameters are: efSearch=238
2025-03-09 08:37:27,898 [INFO]: 	Compute fast metrics 03/09/2025, 08:37:27
  0%|          | 0/4 [00:00<?, ?it/s] 25%|██▌       | 1/4 [00:00<00:00,  8.09it/s] 75%|███████▌  | 3/4 [00:00<00:00, 11.65it/s] 75%|███████▌  | 3/4 [00:00<00:00,  8.93it/s]
2025-03-09 08:37:43,540 [INFO]: 	>>> Finished "Compute fast metrics" in 15.6419 secs
2025-03-09 08:37:43,543 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 51.3720 secs
2025-03-09 08:37:43,543 [INFO]: {
2025-03-09 08:37:43,543 [INFO]: 	index_key: HNSW15
2025-03-09 08:37:43,543 [INFO]: 	index_param: efSearch=238
2025-03-09 08:37:43,543 [INFO]: 	index_path: knn.index
2025-03-09 08:37:43,543 [INFO]: 	size in bytes: 712016050
2025-03-09 08:37:43,543 [INFO]: 	avg_search_speed_ms: 9.36582509087301
2025-03-09 08:37:43,543 [INFO]: 	99p_search_speed_ms: 14.98263821704313
2025-03-09 08:37:43,543 [INFO]: 	reconstruction error %: 0.0
2025-03-09 08:37:43,543 [INFO]: 	nb vectors: 3619
2025-03-09 08:37:43,543 [INFO]: 	vectors dimension: 49152
2025-03-09 08:37:43,543 [INFO]: 	compression ratio: 0.9993094284883044
2025-03-09 08:37:43,543 [INFO]: }
2025-03-09 08:37:43,543 [INFO]: 	>>> Finished "Creating the index" in 51.3738 secs
2025-03-09 08:37:43,543 [INFO]: >>> Finished "Launching the whole pipeline" in 51.4033 secs
2025-03-09 08:37:44: [retrieval_preprocessing] calculating distances ...
2025-03-09 08:37:45: [retrieval_preprocessing] finished and saved retrieval indices for episode 37402 [episode count 8/20]
[retrieval_preprocessing] for episode 83452 [episode count 9/20], we have num_retrieval=np.int64(3574) num_query=np.int64(216)
2025-03-09 08:37:46,443 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-09 08:37:46,930 [INFO]: Launching the whole pipeline 03/09/2025, 08:37:46
2025-03-09 08:37:46,930 [INFO]: Reading total number of vectors and dimension 03/09/2025, 08:37:46
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1412.70it/s]
2025-03-09 08:37:46,956 [INFO]: There are 3574 embeddings of dim 49152
2025-03-09 08:37:46,956 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0261 secs
2025-03-09 08:37:46,956 [INFO]: 	Compute estimated construction time of the index 03/09/2025, 08:37:46
2025-03-09 08:37:46,956 [INFO]: 		-> Train: 16.7 minutes
2025-03-09 08:37:46,956 [INFO]: 		-> Add: 2.0 seconds
2025-03-09 08:37:46,956 [INFO]: 		Total: 16.7 minutes
2025-03-09 08:37:46,956 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0001 secs
2025-03-09 08:37:46,956 [INFO]: 	Checking that your have enough memory available to create the index 03/09/2025, 08:37:46
2025-03-09 08:37:46,956 [INFO]: 737.6MB of memory will be needed to build the index (more might be used if you have more)
2025-03-09 08:37:46,956 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0002 secs
2025-03-09 08:37:46,956 [INFO]: 	Selecting most promising index types given data characteristics 03/09/2025, 08:37:46
2025-03-09 08:37:46,956 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-09 08:37:46,956 [INFO]: 	Creating the index 03/09/2025, 08:37:46
2025-03-09 08:37:46,956 [INFO]: 		-> Instanciate the index HNSW15 03/09/2025, 08:37:46
2025-03-09 08:37:46,958 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0012 secs
2025-03-09 08:37:46,958 [INFO]: 		-> Adding the vectors to the index 03/09/2025, 08:37:46
2025-03-09 08:37:46,958 [INFO]: The memory available for adding the vectors is 49.3GB(total available - used by the index)
2025-03-09 08:37:46,958 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/15 [00:00<?, ?it/s]  7%|▋         | 1/15 [00:00<00:03,  3.63it/s] 13%|█▎        | 2/15 [00:00<00:02,  5.30it/s] 20%|██        | 3/15 [00:00<00:01,  6.40it/s] 27%|██▋       | 4/15 [00:00<00:01,  7.09it/s] 33%|███▎      | 5/15 [00:00<00:01,  7.67it/s] 40%|████      | 6/15 [00:00<00:01,  7.99it/s] 47%|████▋     | 7/15 [00:00<00:00,  8.17it/s] 53%|█████▎    | 8/15 [00:01<00:00,  8.21it/s] 60%|██████    | 9/15 [00:01<00:00,  8.21it/s] 67%|██████▋   | 10/15 [00:01<00:00,  8.22it/s] 73%|███████▎  | 11/15 [00:01<00:00,  8.14it/s] 80%|████████  | 12/15 [00:01<00:00,  8.00it/s] 93%|█████████▎| 14/15 [00:01<00:00,  9.00it/s]100%|██████████| 15/15 [00:04<00:00,  1.39it/s]100%|██████████| 15/15 [00:04<00:00,  3.45it/s]
2025-03-09 08:37:51,305 [INFO]: 	Computing best hyperparameters for index knn.index 03/09/2025, 08:37:51
2025-03-09 08:38:22,757 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 31.4521 secs
2025-03-09 08:38:22,757 [INFO]: The best hyperparameters are: efSearch=232
2025-03-09 08:38:22,757 [INFO]: 	Compute fast metrics 03/09/2025, 08:38:22
  0%|          | 0/4 [00:00<?, ?it/s] 25%|██▌       | 1/4 [00:00<00:00,  5.54it/s] 50%|█████     | 2/4 [00:00<00:00,  7.19it/s] 75%|███████▌  | 3/4 [00:00<00:00,  7.94it/s] 75%|███████▌  | 3/4 [00:00<00:00,  5.96it/s]
2025-03-09 08:38:39,815 [INFO]: 	>>> Finished "Compute fast metrics" in 17.0572 secs
2025-03-09 08:38:39,817 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 52.8590 secs
2025-03-09 08:38:39,817 [INFO]: {
2025-03-09 08:38:39,817 [INFO]: 	index_key: HNSW15
2025-03-09 08:38:39,817 [INFO]: 	index_param: efSearch=232
2025-03-09 08:38:39,817 [INFO]: 	index_path: knn.index
2025-03-09 08:38:39,817 [INFO]: 	size in bytes: 703162450
2025-03-09 08:38:39,817 [INFO]: 	avg_search_speed_ms: 10.161485339371048
2025-03-09 08:38:39,817 [INFO]: 	99p_search_speed_ms: 16.603779026772823
2025-03-09 08:38:39,817 [INFO]: 	reconstruction error %: 0.0
2025-03-09 08:38:39,817 [INFO]: 	nb vectors: 3574
2025-03-09 08:38:39,817 [INFO]: 	vectors dimension: 49152
2025-03-09 08:38:39,817 [INFO]: 	compression ratio: 0.999309607616277
2025-03-09 08:38:39,817 [INFO]: }
2025-03-09 08:38:39,817 [INFO]: 	>>> Finished "Creating the index" in 52.8607 secs
2025-03-09 08:38:39,817 [INFO]: >>> Finished "Launching the whole pipeline" in 52.8875 secs
2025-03-09 08:38:41: [retrieval_preprocessing] calculating distances ...
2025-03-09 08:38:42: [retrieval_preprocessing] finished and saved retrieval indices for episode 83452 [episode count 9/20]
[retrieval_preprocessing] for episode 61085 [episode count 10/20], we have num_retrieval=np.int64(3650) num_query=np.int64(140)
2025-03-09 08:38:42,353 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-09 08:38:43,652 [INFO]: Launching the whole pipeline 03/09/2025, 08:38:43
2025-03-09 08:38:43,652 [INFO]: Reading total number of vectors and dimension 03/09/2025, 08:38:43
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1874.13it/s]
2025-03-09 08:38:43,680 [INFO]: There are 3650 embeddings of dim 49152
2025-03-09 08:38:43,680 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0280 secs
2025-03-09 08:38:43,681 [INFO]: 	Compute estimated construction time of the index 03/09/2025, 08:38:43
2025-03-09 08:38:43,681 [INFO]: 		-> Train: 16.7 minutes
2025-03-09 08:38:43,681 [INFO]: 		-> Add: 2.0 seconds
2025-03-09 08:38:43,681 [INFO]: 		Total: 16.7 minutes
2025-03-09 08:38:43,681 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0001 secs
2025-03-09 08:38:43,681 [INFO]: 	Checking that your have enough memory available to create the index 03/09/2025, 08:38:43
2025-03-09 08:38:43,681 [INFO]: 753.3MB of memory will be needed to build the index (more might be used if you have more)
2025-03-09 08:38:43,681 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0002 secs
2025-03-09 08:38:43,681 [INFO]: 	Selecting most promising index types given data characteristics 03/09/2025, 08:38:43
2025-03-09 08:38:43,681 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-09 08:38:43,681 [INFO]: 	Creating the index 03/09/2025, 08:38:43
2025-03-09 08:38:43,681 [INFO]: 		-> Instanciate the index HNSW15 03/09/2025, 08:38:43
2025-03-09 08:38:43,682 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0012 secs
2025-03-09 08:38:43,682 [INFO]: 		-> Adding the vectors to the index 03/09/2025, 08:38:43
2025-03-09 08:38:43,682 [INFO]: The memory available for adding the vectors is 49.3GB(total available - used by the index)
2025-03-09 08:38:43,683 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/15 [00:00<?, ?it/s]  7%|▋         | 1/15 [00:00<00:01,  9.09it/s] 47%|████▋     | 7/15 [00:00<00:00, 34.52it/s] 80%|████████  | 12/15 [00:00<00:00, 41.02it/s]100%|██████████| 15/15 [00:02<00:00,  5.99it/s]
2025-03-09 08:38:46,191 [INFO]: 	Computing best hyperparameters for index knn.index 03/09/2025, 08:38:46
2025-03-09 08:39:17,879 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 31.6878 secs
2025-03-09 08:39:17,880 [INFO]: The best hyperparameters are: efSearch=161
2025-03-09 08:39:17,881 [INFO]: 	Compute fast metrics 03/09/2025, 08:39:17
  0%|          | 0/4 [00:00<?, ?it/s] 25%|██▌       | 1/4 [00:00<00:00,  5.05it/s] 50%|█████     | 2/4 [00:00<00:00,  6.71it/s] 75%|███████▌  | 3/4 [00:00<00:00,  7.37it/s] 75%|███████▌  | 3/4 [00:00<00:00,  5.55it/s]
2025-03-09 08:39:35,368 [INFO]: 	>>> Finished "Compute fast metrics" in 17.4868 secs
2025-03-09 08:39:35,370 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 51.6880 secs
2025-03-09 08:39:35,371 [INFO]: {
2025-03-09 08:39:35,371 [INFO]: 	index_key: HNSW15
2025-03-09 08:39:35,371 [INFO]: 	index_param: efSearch=161
2025-03-09 08:39:35,371 [INFO]: 	index_path: knn.index
2025-03-09 08:39:35,371 [INFO]: 	size in bytes: 718115230
2025-03-09 08:39:35,371 [INFO]: 	avg_search_speed_ms: 9.223799362333622
2025-03-09 08:39:35,371 [INFO]: 	99p_search_speed_ms: 12.713141757994896
2025-03-09 08:39:35,371 [INFO]: 	reconstruction error %: 0.0
2025-03-09 08:39:35,371 [INFO]: 	nb vectors: 3650
2025-03-09 08:39:35,371 [INFO]: 	vectors dimension: 49152
2025-03-09 08:39:35,371 [INFO]: 	compression ratio: 0.9993092612727348
2025-03-09 08:39:35,371 [INFO]: }
2025-03-09 08:39:35,371 [INFO]: 	>>> Finished "Creating the index" in 51.6903 secs
2025-03-09 08:39:35,371 [INFO]: >>> Finished "Launching the whole pipeline" in 51.7190 secs
2025-03-09 08:39:35: [retrieval_preprocessing] calculating distances ...
2025-03-09 08:39:36: [retrieval_preprocessing] finished and saved retrieval indices for episode 61085 [episode count 10/20]
[retrieval_preprocessing] for episode 33054 [episode count 11/20], we have num_retrieval=np.int64(3629) num_query=np.int64(161)
2025-03-09 08:39:37,532 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-09 08:39:38,072 [INFO]: Launching the whole pipeline 03/09/2025, 08:39:38
2025-03-09 08:39:38,073 [INFO]: Reading total number of vectors and dimension 03/09/2025, 08:39:38
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1384.26it/s]
2025-03-09 08:39:38,100 [INFO]: There are 3629 embeddings of dim 49152
2025-03-09 08:39:38,100 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0273 secs
2025-03-09 08:39:38,100 [INFO]: 	Compute estimated construction time of the index 03/09/2025, 08:39:38
2025-03-09 08:39:38,100 [INFO]: 		-> Train: 16.7 minutes
2025-03-09 08:39:38,100 [INFO]: 		-> Add: 2.0 seconds
2025-03-09 08:39:38,100 [INFO]: 		Total: 16.7 minutes
2025-03-09 08:39:38,100 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0001 secs
2025-03-09 08:39:38,100 [INFO]: 	Checking that your have enough memory available to create the index 03/09/2025, 08:39:38
2025-03-09 08:39:38,100 [INFO]: 748.9MB of memory will be needed to build the index (more might be used if you have more)
2025-03-09 08:39:38,100 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0002 secs
2025-03-09 08:39:38,100 [INFO]: 	Selecting most promising index types given data characteristics 03/09/2025, 08:39:38
2025-03-09 08:39:38,100 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-09 08:39:38,100 [INFO]: 	Creating the index 03/09/2025, 08:39:38
2025-03-09 08:39:38,100 [INFO]: 		-> Instanciate the index HNSW15 03/09/2025, 08:39:38
2025-03-09 08:39:38,101 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0009 secs
2025-03-09 08:39:38,101 [INFO]: 		-> Adding the vectors to the index 03/09/2025, 08:39:38
2025-03-09 08:39:38,102 [INFO]: The memory available for adding the vectors is 49.3GB(total available - used by the index)
2025-03-09 08:39:38,102 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/15 [00:00<?, ?it/s]  7%|▋         | 1/15 [00:00<00:01,  9.29it/s] 27%|██▋       | 4/15 [00:00<00:00, 20.08it/s] 53%|█████▎    | 8/15 [00:00<00:00, 25.91it/s] 87%|████████▋ | 13/15 [00:00<00:00, 33.69it/s]100%|██████████| 15/15 [00:02<00:00,  5.37it/s]
2025-03-09 08:39:40,897 [INFO]: 	Computing best hyperparameters for index knn.index 03/09/2025, 08:39:40
2025-03-09 08:40:15,566 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 34.6682 secs
2025-03-09 08:40:15,566 [INFO]: The best hyperparameters are: efSearch=216
2025-03-09 08:40:15,566 [INFO]: 	Compute fast metrics 03/09/2025, 08:40:15
  0%|          | 0/4 [00:00<?, ?it/s] 50%|█████     | 2/4 [00:00<00:00, 18.39it/s] 75%|███████▌  | 3/4 [00:00<00:00, 19.25it/s]
2025-03-09 08:40:35,584 [INFO]: 	>>> Finished "Compute fast metrics" in 20.0173 secs
2025-03-09 08:40:35,784 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 57.6827 secs
2025-03-09 08:40:35,785 [INFO]: {
2025-03-09 08:40:35,785 [INFO]: 	index_key: HNSW15
2025-03-09 08:40:35,785 [INFO]: 	index_param: efSearch=216
2025-03-09 08:40:35,785 [INFO]: 	index_path: knn.index
2025-03-09 08:40:35,785 [INFO]: 	size in bytes: 713983510
2025-03-09 08:40:35,785 [INFO]: 	avg_search_speed_ms: 8.47340283335297
2025-03-09 08:40:35,785 [INFO]: 	99p_search_speed_ms: 12.062946225050839
2025-03-09 08:40:35,785 [INFO]: 	reconstruction error %: 0.0
2025-03-09 08:40:35,785 [INFO]: 	nb vectors: 3629
2025-03-09 08:40:35,785 [INFO]: 	vectors dimension: 49152
2025-03-09 08:40:35,785 [INFO]: 	compression ratio: 0.9993093986162229
2025-03-09 08:40:35,785 [INFO]: }
2025-03-09 08:40:35,785 [INFO]: 	>>> Finished "Creating the index" in 57.6849 secs
2025-03-09 08:40:35,785 [INFO]: >>> Finished "Launching the whole pipeline" in 57.7129 secs
2025-03-09 08:40:36: [retrieval_preprocessing] calculating distances ...
2025-03-09 08:40:37: [retrieval_preprocessing] finished and saved retrieval indices for episode 33054 [episode count 11/20]
[retrieval_preprocessing] for episode 15776 [episode count 12/20], we have num_retrieval=np.int64(3595) num_query=np.int64(195)
2025-03-09 08:40:37,397 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-09 08:40:37,960 [INFO]: Launching the whole pipeline 03/09/2025, 08:40:37
2025-03-09 08:40:37,960 [INFO]: Reading total number of vectors and dimension 03/09/2025, 08:40:37
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 993.44it/s]
2025-03-09 08:40:37,989 [INFO]: There are 3595 embeddings of dim 49152
2025-03-09 08:40:37,989 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0291 secs
2025-03-09 08:40:37,989 [INFO]: 	Compute estimated construction time of the index 03/09/2025, 08:40:37
2025-03-09 08:40:37,989 [INFO]: 		-> Train: 16.7 minutes
2025-03-09 08:40:37,989 [INFO]: 		-> Add: 2.0 seconds
2025-03-09 08:40:37,989 [INFO]: 		Total: 16.7 minutes
2025-03-09 08:40:37,989 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0001 secs
2025-03-09 08:40:37,989 [INFO]: 	Checking that your have enough memory available to create the index 03/09/2025, 08:40:37
2025-03-09 08:40:37,989 [INFO]: 741.9MB of memory will be needed to build the index (more might be used if you have more)
2025-03-09 08:40:37,989 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0002 secs
2025-03-09 08:40:37,989 [INFO]: 	Selecting most promising index types given data characteristics 03/09/2025, 08:40:37
2025-03-09 08:40:37,989 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-09 08:40:37,989 [INFO]: 	Creating the index 03/09/2025, 08:40:37
2025-03-09 08:40:37,989 [INFO]: 		-> Instanciate the index HNSW15 03/09/2025, 08:40:37
2025-03-09 08:40:37,991 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0011 secs
2025-03-09 08:40:37,991 [INFO]: 		-> Adding the vectors to the index 03/09/2025, 08:40:37
2025-03-09 08:40:37,991 [INFO]: The memory available for adding the vectors is 49.3GB(total available - used by the index)
2025-03-09 08:40:37,991 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/15 [00:00<?, ?it/s]  7%|▋         | 1/15 [00:00<00:01,  7.59it/s] 40%|████      | 6/15 [00:00<00:00, 29.35it/s] 80%|████████  | 12/15 [00:00<00:00, 42.11it/s]100%|██████████| 15/15 [00:02<00:00,  5.13it/s]
2025-03-09 08:40:40,919 [INFO]: 	Computing best hyperparameters for index knn.index 03/09/2025, 08:40:40
2025-03-09 08:41:15,410 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 34.4909 secs
2025-03-09 08:41:15,410 [INFO]: The best hyperparameters are: efSearch=152
2025-03-09 08:41:15,410 [INFO]: 	Compute fast metrics 03/09/2025, 08:41:15
  0%|          | 0/4 [00:00<?, ?it/s] 50%|█████     | 2/4 [00:00<00:00, 18.48it/s] 75%|███████▌  | 3/4 [00:00<00:00, 19.65it/s]
2025-03-09 08:41:32,172 [INFO]: 	>>> Finished "Compute fast metrics" in 16.7614 secs
2025-03-09 08:41:32,175 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 54.1838 secs
2025-03-09 08:41:32,175 [INFO]: {
2025-03-09 08:41:32,175 [INFO]: 	index_key: HNSW15
2025-03-09 08:41:32,175 [INFO]: 	index_param: efSearch=152
2025-03-09 08:41:32,175 [INFO]: 	index_path: knn.index
2025-03-09 08:41:32,175 [INFO]: 	size in bytes: 707294050
2025-03-09 08:41:32,175 [INFO]: 	avg_search_speed_ms: 7.941824425980153
2025-03-09 08:41:32,175 [INFO]: 	99p_search_speed_ms: 17.95688605401665
2025-03-09 08:41:32,175 [INFO]: 	reconstruction error %: 0.0
2025-03-09 08:41:32,175 [INFO]: 	nb vectors: 3595
2025-03-09 08:41:32,175 [INFO]: 	vectors dimension: 49152
2025-03-09 08:41:32,175 [INFO]: 	compression ratio: 0.9993096364941851
2025-03-09 08:41:32,175 [INFO]: }
2025-03-09 08:41:32,175 [INFO]: 	>>> Finished "Creating the index" in 54.1856 secs
2025-03-09 08:41:32,175 [INFO]: >>> Finished "Launching the whole pipeline" in 54.2153 secs
2025-03-09 08:41:32: [retrieval_preprocessing] calculating distances ...
2025-03-09 08:41:33: [retrieval_preprocessing] finished and saved retrieval indices for episode 15776 [episode count 12/20]
[retrieval_preprocessing] for episode 2978 [episode count 13/20], we have num_retrieval=np.int64(3561) num_query=np.int64(229)
2025-03-09 08:41:33,817 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-09 08:41:34,320 [INFO]: Launching the whole pipeline 03/09/2025, 08:41:34
2025-03-09 08:41:34,321 [INFO]: Reading total number of vectors and dimension 03/09/2025, 08:41:34
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1234.34it/s]
2025-03-09 08:41:34,346 [INFO]: There are 3561 embeddings of dim 49152
2025-03-09 08:41:34,346 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0251 secs
2025-03-09 08:41:34,346 [INFO]: 	Compute estimated construction time of the index 03/09/2025, 08:41:34
2025-03-09 08:41:34,346 [INFO]: 		-> Train: 16.7 minutes
2025-03-09 08:41:34,346 [INFO]: 		-> Add: 2.0 seconds
2025-03-09 08:41:34,346 [INFO]: 		Total: 16.7 minutes
2025-03-09 08:41:34,346 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0001 secs
2025-03-09 08:41:34,346 [INFO]: 	Checking that your have enough memory available to create the index 03/09/2025, 08:41:34
2025-03-09 08:41:34,346 [INFO]: 734.9MB of memory will be needed to build the index (more might be used if you have more)
2025-03-09 08:41:34,346 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0002 secs
2025-03-09 08:41:34,346 [INFO]: 	Selecting most promising index types given data characteristics 03/09/2025, 08:41:34
2025-03-09 08:41:34,346 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-09 08:41:34,346 [INFO]: 	Creating the index 03/09/2025, 08:41:34
2025-03-09 08:41:34,346 [INFO]: 		-> Instanciate the index HNSW15 03/09/2025, 08:41:34
2025-03-09 08:41:34,347 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0010 secs
2025-03-09 08:41:34,347 [INFO]: 		-> Adding the vectors to the index 03/09/2025, 08:41:34
2025-03-09 08:41:34,348 [INFO]: The memory available for adding the vectors is 49.3GB(total available - used by the index)
2025-03-09 08:41:34,348 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/15 [00:00<?, ?it/s]  7%|▋         | 1/15 [00:00<00:01,  9.73it/s] 47%|████▋     | 7/15 [00:00<00:00, 38.72it/s] 80%|████████  | 12/15 [00:00<00:00, 43.31it/s]100%|██████████| 15/15 [00:02<00:00,  5.01it/s]
2025-03-09 08:41:37,344 [INFO]: 	Computing best hyperparameters for index knn.index 03/09/2025, 08:41:37
2025-03-09 08:42:10,854 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 33.5097 secs
2025-03-09 08:42:10,854 [INFO]: The best hyperparameters are: efSearch=210
2025-03-09 08:42:10,854 [INFO]: 	Compute fast metrics 03/09/2025, 08:42:10
  0%|          | 0/4 [00:00<?, ?it/s] 50%|█████     | 2/4 [00:00<00:00, 18.85it/s] 75%|███████▌  | 3/4 [00:00<00:00, 20.38it/s]
2025-03-09 08:42:29,427 [INFO]: 	>>> Finished "Compute fast metrics" in 18.5728 secs
2025-03-09 08:42:29,429 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 55.0817 secs
2025-03-09 08:42:29,430 [INFO]: {
2025-03-09 08:42:29,430 [INFO]: 	index_key: HNSW15
2025-03-09 08:42:29,430 [INFO]: 	index_param: efSearch=210
2025-03-09 08:42:29,430 [INFO]: 	index_path: knn.index
2025-03-09 08:42:29,430 [INFO]: 	size in bytes: 700604830
2025-03-09 08:42:29,430 [INFO]: 	avg_search_speed_ms: 8.718369022188766
2025-03-09 08:42:29,430 [INFO]: 	99p_search_speed_ms: 17.513788901269432
2025-03-09 08:42:29,430 [INFO]: 	reconstruction error %: 0.0
2025-03-09 08:42:29,430 [INFO]: 	nb vectors: 3561
2025-03-09 08:42:29,430 [INFO]: 	vectors dimension: 49152
2025-03-09 08:42:29,430 [INFO]: 	compression ratio: 0.9993095365899776
2025-03-09 08:42:29,430 [INFO]: }
2025-03-09 08:42:29,430 [INFO]: 	>>> Finished "Creating the index" in 55.0836 secs
2025-03-09 08:42:29,430 [INFO]: >>> Finished "Launching the whole pipeline" in 55.1093 secs
2025-03-09 08:42:30: [retrieval_preprocessing] calculating distances ...
2025-03-09 08:42:31: [retrieval_preprocessing] finished and saved retrieval indices for episode 2978 [episode count 13/20]
[retrieval_preprocessing] for episode 68644 [episode count 14/20], we have num_retrieval=np.int64(3654) num_query=np.int64(136)
2025-03-09 08:42:31,841 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-09 08:42:33,001 [INFO]: Launching the whole pipeline 03/09/2025, 08:42:33
2025-03-09 08:42:33,001 [INFO]: Reading total number of vectors and dimension 03/09/2025, 08:42:33
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 2083.61it/s]
2025-03-09 08:42:33,028 [INFO]: There are 3654 embeddings of dim 49152
2025-03-09 08:42:33,028 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0267 secs
2025-03-09 08:42:33,028 [INFO]: 	Compute estimated construction time of the index 03/09/2025, 08:42:33
2025-03-09 08:42:33,028 [INFO]: 		-> Train: 16.7 minutes
2025-03-09 08:42:33,028 [INFO]: 		-> Add: 2.0 seconds
2025-03-09 08:42:33,028 [INFO]: 		Total: 16.7 minutes
2025-03-09 08:42:33,028 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0001 secs
2025-03-09 08:42:33,028 [INFO]: 	Checking that your have enough memory available to create the index 03/09/2025, 08:42:33
2025-03-09 08:42:33,028 [INFO]: 754.1MB of memory will be needed to build the index (more might be used if you have more)
2025-03-09 08:42:33,028 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0002 secs
2025-03-09 08:42:33,028 [INFO]: 	Selecting most promising index types given data characteristics 03/09/2025, 08:42:33
2025-03-09 08:42:33,028 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-09 08:42:33,028 [INFO]: 	Creating the index 03/09/2025, 08:42:33
2025-03-09 08:42:33,029 [INFO]: 		-> Instanciate the index HNSW15 03/09/2025, 08:42:33
2025-03-09 08:42:33,030 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0012 secs
2025-03-09 08:42:33,030 [INFO]: 		-> Adding the vectors to the index 03/09/2025, 08:42:33
2025-03-09 08:42:33,030 [INFO]: The memory available for adding the vectors is 49.3GB(total available - used by the index)
2025-03-09 08:42:33,030 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/15 [00:00<?, ?it/s]  7%|▋         | 1/15 [00:00<00:01,  7.62it/s] 47%|████▋     | 7/15 [00:00<00:00, 32.96it/s] 87%|████████▋ | 13/15 [00:00<00:00, 42.28it/s]100%|██████████| 15/15 [00:03<00:00,  4.54it/s]
2025-03-09 08:42:36,338 [INFO]: 	Computing best hyperparameters for index knn.index 03/09/2025, 08:42:36
2025-03-09 08:43:10,762 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 34.4239 secs
2025-03-09 08:43:10,762 [INFO]: The best hyperparameters are: efSearch=235
2025-03-09 08:43:10,762 [INFO]: 	Compute fast metrics 03/09/2025, 08:43:10
  0%|          | 0/4 [00:00<?, ?it/s] 50%|█████     | 2/4 [00:00<00:00, 18.77it/s] 75%|███████▌  | 3/4 [00:00<00:00, 19.95it/s]
2025-03-09 08:43:27,079 [INFO]: 	>>> Finished "Compute fast metrics" in 16.3166 secs
2025-03-09 08:43:27,081 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 54.0511 secs
2025-03-09 08:43:27,081 [INFO]: {
2025-03-09 08:43:27,081 [INFO]: 	index_key: HNSW15
2025-03-09 08:43:27,081 [INFO]: 	index_param: efSearch=235
2025-03-09 08:43:27,081 [INFO]: 	index_path: knn.index
2025-03-09 08:43:27,081 [INFO]: 	size in bytes: 718902250
2025-03-09 08:43:27,081 [INFO]: 	avg_search_speed_ms: 9.303693297254139
2025-03-09 08:43:27,081 [INFO]: 	99p_search_speed_ms: 18.502263245172795
2025-03-09 08:43:27,081 [INFO]: 	reconstruction error %: 0.0
2025-03-09 08:43:27,081 [INFO]: 	nb vectors: 3654
2025-03-09 08:43:27,081 [INFO]: 	vectors dimension: 49152
2025-03-09 08:43:27,081 [INFO]: 	compression ratio: 0.9993091995469482
2025-03-09 08:43:27,081 [INFO]: }
2025-03-09 08:43:27,081 [INFO]: 	>>> Finished "Creating the index" in 54.0527 secs
2025-03-09 08:43:27,081 [INFO]: >>> Finished "Launching the whole pipeline" in 54.0801 secs
2025-03-09 08:43:27: [retrieval_preprocessing] calculating distances ...
2025-03-09 08:43:28: [retrieval_preprocessing] finished and saved retrieval indices for episode 68644 [episode count 14/20]
[retrieval_preprocessing] for episode 20774 [episode count 15/20], we have num_retrieval=np.int64(3587) num_query=np.int64(203)
2025-03-09 08:43:28,627 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-09 08:43:29,118 [INFO]: Launching the whole pipeline 03/09/2025, 08:43:29
2025-03-09 08:43:29,118 [INFO]: Reading total number of vectors and dimension 03/09/2025, 08:43:29
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1714.76it/s]
2025-03-09 08:43:29,148 [INFO]: There are 3587 embeddings of dim 49152
2025-03-09 08:43:29,148 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0292 secs
2025-03-09 08:43:29,148 [INFO]: 	Compute estimated construction time of the index 03/09/2025, 08:43:29
2025-03-09 08:43:29,148 [INFO]: 		-> Train: 16.7 minutes
2025-03-09 08:43:29,148 [INFO]: 		-> Add: 2.0 seconds
2025-03-09 08:43:29,148 [INFO]: 		Total: 16.7 minutes
2025-03-09 08:43:29,148 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0001 secs
2025-03-09 08:43:29,148 [INFO]: 	Checking that your have enough memory available to create the index 03/09/2025, 08:43:29
2025-03-09 08:43:29,148 [INFO]: 740.3MB of memory will be needed to build the index (more might be used if you have more)
2025-03-09 08:43:29,148 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0001 secs
2025-03-09 08:43:29,148 [INFO]: 	Selecting most promising index types given data characteristics 03/09/2025, 08:43:29
2025-03-09 08:43:29,148 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-09 08:43:29,148 [INFO]: 	Creating the index 03/09/2025, 08:43:29
2025-03-09 08:43:29,148 [INFO]: 		-> Instanciate the index HNSW15 03/09/2025, 08:43:29
2025-03-09 08:43:29,149 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0009 secs
2025-03-09 08:43:29,149 [INFO]: 		-> Adding the vectors to the index 03/09/2025, 08:43:29
2025-03-09 08:43:29,149 [INFO]: The memory available for adding the vectors is 49.3GB(total available - used by the index)
2025-03-09 08:43:29,149 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/15 [00:00<?, ?it/s]  7%|▋         | 1/15 [00:00<00:01,  9.23it/s] 40%|████      | 6/15 [00:00<00:00, 32.36it/s] 73%|███████▎  | 11/15 [00:00<00:00, 40.13it/s]100%|██████████| 15/15 [00:02<00:00,  5.20it/s]
2025-03-09 08:43:32,036 [INFO]: 	Computing best hyperparameters for index knn.index 03/09/2025, 08:43:32
2025-03-09 08:44:04,531 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 32.4943 secs
2025-03-09 08:44:04,531 [INFO]: The best hyperparameters are: efSearch=241
2025-03-09 08:44:04,531 [INFO]: 	Compute fast metrics 03/09/2025, 08:44:04
  0%|          | 0/4 [00:00<?, ?it/s] 75%|███████▌  | 3/4 [00:00<00:00, 25.91it/s] 75%|███████▌  | 3/4 [00:00<00:00, 21.91it/s]
2025-03-09 08:44:21,657 [INFO]: 	>>> Finished "Compute fast metrics" in 17.1258 secs
2025-03-09 08:44:21,659 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 52.5099 secs
2025-03-09 08:44:21,659 [INFO]: {
2025-03-09 08:44:21,659 [INFO]: 	index_key: HNSW15
2025-03-09 08:44:21,659 [INFO]: 	index_param: efSearch=241
2025-03-09 08:44:21,659 [INFO]: 	index_path: knn.index
2025-03-09 08:44:21,659 [INFO]: 	size in bytes: 705720130
2025-03-09 08:44:21,659 [INFO]: 	avg_search_speed_ms: 10.297826170944345
2025-03-09 08:44:21,659 [INFO]: 	99p_search_speed_ms: 20.72548584546893
2025-03-09 08:44:21,659 [INFO]: 	reconstruction error %: 0.0
2025-03-09 08:44:21,659 [INFO]: 	nb vectors: 3587
2025-03-09 08:44:21,659 [INFO]: 	vectors dimension: 49152
2025-03-09 08:44:21,659 [INFO]: 	compression ratio: 0.9993095931669117
2025-03-09 08:44:21,659 [INFO]: }
2025-03-09 08:44:21,660 [INFO]: 	>>> Finished "Creating the index" in 52.5113 secs
2025-03-09 08:44:21,660 [INFO]: >>> Finished "Launching the whole pipeline" in 52.5410 secs
2025-03-09 08:44:22: [retrieval_preprocessing] calculating distances ...
2025-03-09 08:44:23: [retrieval_preprocessing] finished and saved retrieval indices for episode 20774 [episode count 15/20]
[retrieval_preprocessing] for episode 43434 [episode count 16/20], we have num_retrieval=np.int64(3530) num_query=np.int64(260)
2025-03-09 08:44:24,116 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-09 08:44:24,756 [INFO]: Launching the whole pipeline 03/09/2025, 08:44:24
2025-03-09 08:44:24,756 [INFO]: Reading total number of vectors and dimension 03/09/2025, 08:44:24
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 2123.70it/s]
2025-03-09 08:44:24,782 [INFO]: There are 3530 embeddings of dim 49152
2025-03-09 08:44:24,782 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0259 secs
2025-03-09 08:44:24,782 [INFO]: 	Compute estimated construction time of the index 03/09/2025, 08:44:24
2025-03-09 08:44:24,782 [INFO]: 		-> Train: 16.7 minutes
2025-03-09 08:44:24,782 [INFO]: 		-> Add: 1.9 seconds
2025-03-09 08:44:24,782 [INFO]: 		Total: 16.7 minutes
2025-03-09 08:44:24,782 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0001 secs
2025-03-09 08:44:24,782 [INFO]: 	Checking that your have enough memory available to create the index 03/09/2025, 08:44:24
2025-03-09 08:44:24,782 [INFO]: 728.5MB of memory will be needed to build the index (more might be used if you have more)
2025-03-09 08:44:24,782 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0001 secs
2025-03-09 08:44:24,782 [INFO]: 	Selecting most promising index types given data characteristics 03/09/2025, 08:44:24
2025-03-09 08:44:24,782 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-09 08:44:24,782 [INFO]: 	Creating the index 03/09/2025, 08:44:24
2025-03-09 08:44:24,782 [INFO]: 		-> Instanciate the index HNSW15 03/09/2025, 08:44:24
2025-03-09 08:44:24,784 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0011 secs
2025-03-09 08:44:24,784 [INFO]: 		-> Adding the vectors to the index 03/09/2025, 08:44:24
2025-03-09 08:44:24,784 [INFO]: The memory available for adding the vectors is 49.4GB(total available - used by the index)
2025-03-09 08:44:24,784 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/14 [00:00<?, ?it/s]  7%|▋         | 1/14 [00:00<00:01,  8.72it/s] 43%|████▎     | 6/14 [00:00<00:00, 28.57it/s] 86%|████████▌ | 12/14 [00:00<00:00, 40.60it/s]100%|██████████| 14/14 [00:02<00:00,  4.92it/s]
2025-03-09 08:44:27,633 [INFO]: 	Computing best hyperparameters for index knn.index 03/09/2025, 08:44:27
2025-03-09 08:44:58,572 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 30.9396 secs
2025-03-09 08:44:58,573 [INFO]: The best hyperparameters are: efSearch=250
2025-03-09 08:44:58,573 [INFO]: 	Compute fast metrics 03/09/2025, 08:44:58
  0%|          | 0/4 [00:00<?, ?it/s] 50%|█████     | 2/4 [00:00<00:00, 19.17it/s] 75%|███████▌  | 3/4 [00:00<00:00, 20.74it/s]
2025-03-09 08:45:16,546 [INFO]: 	>>> Finished "Compute fast metrics" in 17.9728 secs
2025-03-09 08:45:16,548 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 51.7638 secs
2025-03-09 08:45:16,548 [INFO]: {
2025-03-09 08:45:16,548 [INFO]: 	index_key: HNSW15
2025-03-09 08:45:16,548 [INFO]: 	index_param: efSearch=250
2025-03-09 08:45:16,548 [INFO]: 	index_path: knn.index
2025-03-09 08:45:16,548 [INFO]: 	size in bytes: 694505770
2025-03-09 08:45:16,548 [INFO]: 	avg_search_speed_ms: 9.63016931161184
2025-03-09 08:45:16,548 [INFO]: 	99p_search_speed_ms: 17.188080591149625
2025-03-09 08:45:16,548 [INFO]: 	reconstruction error %: 0.0
2025-03-09 08:45:16,548 [INFO]: 	nb vectors: 3530
2025-03-09 08:45:16,548 [INFO]: 	vectors dimension: 49152
2025-03-09 08:45:16,548 [INFO]: 	compression ratio: 0.9993095377738906
2025-03-09 08:45:16,548 [INFO]: }
2025-03-09 08:45:16,548 [INFO]: 	>>> Finished "Creating the index" in 51.7655 secs
2025-03-09 08:45:16,548 [INFO]: >>> Finished "Launching the whole pipeline" in 51.7920 secs
2025-03-09 08:45:18: [retrieval_preprocessing] calculating distances ...
2025-03-09 08:45:19: [retrieval_preprocessing] finished and saved retrieval indices for episode 43434 [episode count 16/20]
[retrieval_preprocessing] for episode 29867 [episode count 17/20], we have num_retrieval=np.int64(3536) num_query=np.int64(254)
2025-03-09 08:45:19,442 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-09 08:45:19,903 [INFO]: Launching the whole pipeline 03/09/2025, 08:45:19
2025-03-09 08:45:19,903 [INFO]: Reading total number of vectors and dimension 03/09/2025, 08:45:19
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 2267.19it/s]
2025-03-09 08:45:19,927 [INFO]: There are 3536 embeddings of dim 49152
2025-03-09 08:45:19,927 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0236 secs
2025-03-09 08:45:19,927 [INFO]: 	Compute estimated construction time of the index 03/09/2025, 08:45:19
2025-03-09 08:45:19,927 [INFO]: 		-> Train: 16.7 minutes
2025-03-09 08:45:19,927 [INFO]: 		-> Add: 1.9 seconds
2025-03-09 08:45:19,927 [INFO]: 		Total: 16.7 minutes
2025-03-09 08:45:19,927 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0001 secs
2025-03-09 08:45:19,927 [INFO]: 	Checking that your have enough memory available to create the index 03/09/2025, 08:45:19
2025-03-09 08:45:19,927 [INFO]: 729.7MB of memory will be needed to build the index (more might be used if you have more)
2025-03-09 08:45:19,927 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0001 secs
2025-03-09 08:45:19,927 [INFO]: 	Selecting most promising index types given data characteristics 03/09/2025, 08:45:19
2025-03-09 08:45:19,927 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-09 08:45:19,927 [INFO]: 	Creating the index 03/09/2025, 08:45:19
2025-03-09 08:45:19,927 [INFO]: 		-> Instanciate the index HNSW15 03/09/2025, 08:45:19
2025-03-09 08:45:19,928 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0009 secs
2025-03-09 08:45:19,928 [INFO]: 		-> Adding the vectors to the index 03/09/2025, 08:45:19
2025-03-09 08:45:19,928 [INFO]: The memory available for adding the vectors is 49.4GB(total available - used by the index)
2025-03-09 08:45:19,928 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/14 [00:00<?, ?it/s] 14%|█▍        | 2/14 [00:00<00:00, 19.79it/s] 64%|██████▍   | 9/14 [00:00<00:00, 45.22it/s]100%|██████████| 14/14 [00:02<00:00,  4.87it/s]100%|██████████| 14/14 [00:02<00:00,  6.04it/s]
2025-03-09 08:45:22,252 [INFO]: 	Computing best hyperparameters for index knn.index 03/09/2025, 08:45:22
2025-03-09 08:45:53,371 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 31.1191 secs
2025-03-09 08:45:53,371 [INFO]: The best hyperparameters are: efSearch=270
2025-03-09 08:45:53,371 [INFO]: 	Compute fast metrics 03/09/2025, 08:45:53
  0%|          | 0/4 [00:00<?, ?it/s] 25%|██▌       | 1/4 [00:00<00:00,  8.12it/s] 75%|███████▌  | 3/4 [00:00<00:00, 14.22it/s]
2025-03-09 08:46:14,005 [INFO]: 	>>> Finished "Compute fast metrics" in 20.6339 secs
2025-03-09 08:46:14,460 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 54.5318 secs
2025-03-09 08:46:14,461 [INFO]: {
2025-03-09 08:46:14,461 [INFO]: 	index_key: HNSW15
2025-03-09 08:46:14,461 [INFO]: 	index_param: efSearch=270
2025-03-09 08:46:14,461 [INFO]: 	index_path: knn.index
2025-03-09 08:46:14,461 [INFO]: 	size in bytes: 695686210
2025-03-09 08:46:14,461 [INFO]: 	avg_search_speed_ms: 9.662485574394609
2025-03-09 08:46:14,461 [INFO]: 	99p_search_speed_ms: 17.746200012043115
2025-03-09 08:46:14,461 [INFO]: 	reconstruction error %: 0.0
2025-03-09 08:46:14,461 [INFO]: 	nb vectors: 3536
2025-03-09 08:46:14,461 [INFO]: 	vectors dimension: 49152
2025-03-09 08:46:14,461 [INFO]: 	compression ratio: 0.999309570905538
2025-03-09 08:46:14,461 [INFO]: }
2025-03-09 08:46:14,461 [INFO]: 	>>> Finished "Creating the index" in 54.5338 secs
2025-03-09 08:46:14,461 [INFO]: >>> Finished "Launching the whole pipeline" in 54.5580 secs
2025-03-09 08:46:16: [retrieval_preprocessing] calculating distances ...
2025-03-09 08:46:17: [retrieval_preprocessing] finished and saved retrieval indices for episode 29867 [episode count 17/20]
[retrieval_preprocessing] for episode 85805 [episode count 18/20], we have num_retrieval=np.int64(3522) num_query=np.int64(268)
2025-03-09 08:46:17,692 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-09 08:46:18,227 [INFO]: Launching the whole pipeline 03/09/2025, 08:46:18
2025-03-09 08:46:18,227 [INFO]: Reading total number of vectors and dimension 03/09/2025, 08:46:18
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1744.72it/s]
2025-03-09 08:46:18,255 [INFO]: There are 3522 embeddings of dim 49152
2025-03-09 08:46:18,255 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0277 secs
2025-03-09 08:46:18,255 [INFO]: 	Compute estimated construction time of the index 03/09/2025, 08:46:18
2025-03-09 08:46:18,255 [INFO]: 		-> Train: 16.7 minutes
2025-03-09 08:46:18,255 [INFO]: 		-> Add: 1.9 seconds
2025-03-09 08:46:18,255 [INFO]: 		Total: 16.7 minutes
2025-03-09 08:46:18,255 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0001 secs
2025-03-09 08:46:18,255 [INFO]: 	Checking that your have enough memory available to create the index 03/09/2025, 08:46:18
2025-03-09 08:46:18,255 [INFO]: 726.9MB of memory will be needed to build the index (more might be used if you have more)
2025-03-09 08:46:18,255 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0002 secs
2025-03-09 08:46:18,255 [INFO]: 	Selecting most promising index types given data characteristics 03/09/2025, 08:46:18
2025-03-09 08:46:18,255 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-09 08:46:18,255 [INFO]: 	Creating the index 03/09/2025, 08:46:18
2025-03-09 08:46:18,255 [INFO]: 		-> Instanciate the index HNSW15 03/09/2025, 08:46:18
2025-03-09 08:46:18,257 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0012 secs
2025-03-09 08:46:18,257 [INFO]: 		-> Adding the vectors to the index 03/09/2025, 08:46:18
2025-03-09 08:46:18,257 [INFO]: The memory available for adding the vectors is 49.4GB(total available - used by the index)
2025-03-09 08:46:18,257 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/14 [00:00<?, ?it/s]  7%|▋         | 1/14 [00:00<00:01,  7.22it/s] 50%|█████     | 7/14 [00:00<00:00, 32.56it/s] 93%|█████████▎| 13/14 [00:00<00:00, 40.96it/s]100%|██████████| 14/14 [00:03<00:00,  4.53it/s]
2025-03-09 08:46:21,350 [INFO]: 	Computing best hyperparameters for index knn.index 03/09/2025, 08:46:21
2025-03-09 08:46:54,099 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 32.7488 secs
2025-03-09 08:46:54,099 [INFO]: The best hyperparameters are: efSearch=247
2025-03-09 08:46:54,099 [INFO]: 	Compute fast metrics 03/09/2025, 08:46:54
  0%|          | 0/4 [00:00<?, ?it/s] 50%|█████     | 2/4 [00:00<00:00, 19.63it/s] 75%|███████▌  | 3/4 [00:00<00:00, 21.40it/s]
2025-03-09 08:47:08,963 [INFO]: 	>>> Finished "Compute fast metrics" in 14.8639 secs
2025-03-09 08:47:08,966 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 50.7088 secs
2025-03-09 08:47:08,966 [INFO]: {
2025-03-09 08:47:08,966 [INFO]: 	index_key: HNSW15
2025-03-09 08:47:08,966 [INFO]: 	index_param: efSearch=247
2025-03-09 08:47:08,966 [INFO]: 	index_path: knn.index
2025-03-09 08:47:08,966 [INFO]: 	size in bytes: 692931790
2025-03-09 08:47:08,966 [INFO]: 	avg_search_speed_ms: 10.532723891940948
2025-03-09 08:47:08,966 [INFO]: 	99p_search_speed_ms: 22.79987619025632
2025-03-09 08:47:08,966 [INFO]: 	reconstruction error %: 0.0
2025-03-09 08:47:08,966 [INFO]: 	nb vectors: 3522
2025-03-09 08:47:08,966 [INFO]: 	vectors dimension: 49152
2025-03-09 08:47:08,966 [INFO]: 	compression ratio: 0.9993095799515851
2025-03-09 08:47:08,966 [INFO]: }
2025-03-09 08:47:08,966 [INFO]: 	>>> Finished "Creating the index" in 50.7105 secs
2025-03-09 08:47:08,966 [INFO]: >>> Finished "Launching the whole pipeline" in 50.7390 secs
2025-03-09 08:47:10: [retrieval_preprocessing] calculating distances ...
2025-03-09 08:47:11: [retrieval_preprocessing] finished and saved retrieval indices for episode 85805 [episode count 18/20]
[retrieval_preprocessing] for episode 13359 [episode count 19/20], we have num_retrieval=np.int64(3626) num_query=np.int64(164)
2025-03-09 08:47:11,973 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-09 08:47:13,039 [INFO]: Launching the whole pipeline 03/09/2025, 08:47:13
2025-03-09 08:47:13,039 [INFO]: Reading total number of vectors and dimension 03/09/2025, 08:47:13
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1205.26it/s]
2025-03-09 08:47:13,065 [INFO]: There are 3626 embeddings of dim 49152
2025-03-09 08:47:13,065 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0252 secs
2025-03-09 08:47:13,065 [INFO]: 	Compute estimated construction time of the index 03/09/2025, 08:47:13
2025-03-09 08:47:13,065 [INFO]: 		-> Train: 16.7 minutes
2025-03-09 08:47:13,065 [INFO]: 		-> Add: 2.0 seconds
2025-03-09 08:47:13,065 [INFO]: 		Total: 16.7 minutes
2025-03-09 08:47:13,065 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0001 secs
2025-03-09 08:47:13,065 [INFO]: 	Checking that your have enough memory available to create the index 03/09/2025, 08:47:13
2025-03-09 08:47:13,065 [INFO]: 748.3MB of memory will be needed to build the index (more might be used if you have more)
2025-03-09 08:47:13,065 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0001 secs
2025-03-09 08:47:13,065 [INFO]: 	Selecting most promising index types given data characteristics 03/09/2025, 08:47:13
2025-03-09 08:47:13,065 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-09 08:47:13,065 [INFO]: 	Creating the index 03/09/2025, 08:47:13
2025-03-09 08:47:13,065 [INFO]: 		-> Instanciate the index HNSW15 03/09/2025, 08:47:13
2025-03-09 08:47:13,066 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0011 secs
2025-03-09 08:47:13,066 [INFO]: 		-> Adding the vectors to the index 03/09/2025, 08:47:13
2025-03-09 08:47:13,067 [INFO]: The memory available for adding the vectors is 49.3GB(total available - used by the index)
2025-03-09 08:47:13,067 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/15 [00:00<?, ?it/s]  7%|▋         | 1/15 [00:00<00:01,  9.22it/s] 47%|████▋     | 7/15 [00:00<00:00, 37.28it/s] 87%|████████▋ | 13/15 [00:00<00:00, 46.76it/s]100%|██████████| 15/15 [00:02<00:00,  5.39it/s]
2025-03-09 08:47:15,853 [INFO]: 	Computing best hyperparameters for index knn.index 03/09/2025, 08:47:15
2025-03-09 08:47:48,225 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 32.3709 secs
2025-03-09 08:47:48,225 [INFO]: The best hyperparameters are: efSearch=94
2025-03-09 08:47:48,225 [INFO]: 	Compute fast metrics 03/09/2025, 08:47:48
  0%|          | 0/4 [00:00<?, ?it/s] 50%|█████     | 2/4 [00:00<00:00, 18.85it/s] 75%|███████▌  | 3/4 [00:00<00:00, 20.13it/s]
2025-03-09 08:48:04,181 [INFO]: 	>>> Finished "Compute fast metrics" in 15.9560 secs
2025-03-09 08:48:04,184 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 51.1175 secs
2025-03-09 08:48:04,184 [INFO]: {
2025-03-09 08:48:04,184 [INFO]: 	index_key: HNSW15
2025-03-09 08:48:04,184 [INFO]: 	index_param: efSearch=94
2025-03-09 08:48:04,184 [INFO]: 	index_path: knn.index
2025-03-09 08:48:04,184 [INFO]: 	size in bytes: 713393230
2025-03-09 08:48:04,184 [INFO]: 	avg_search_speed_ms: 6.89817599791648
2025-03-09 08:48:04,184 [INFO]: 	99p_search_speed_ms: 12.54849084885791
2025-03-09 08:48:04,184 [INFO]: 	reconstruction error %: 0.0
2025-03-09 08:48:04,184 [INFO]: 	nb vectors: 3626
2025-03-09 08:48:04,184 [INFO]: 	vectors dimension: 49152
2025-03-09 08:48:04,184 [INFO]: 	compression ratio: 0.9993094663934503
2025-03-09 08:48:04,184 [INFO]: }
2025-03-09 08:48:04,184 [INFO]: 	>>> Finished "Creating the index" in 51.1191 secs
2025-03-09 08:48:04,184 [INFO]: >>> Finished "Launching the whole pipeline" in 51.1449 secs
2025-03-09 08:48:04: [retrieval_preprocessing] calculating distances ...
2025-03-09 08:48:05: [retrieval_preprocessing] finished and saved retrieval indices for episode 13359 [episode count 19/20]
2025-03-09 08:48:05: [retrieval_preprocessing] finished for (6074146895, 'lid') [chosen_id count 4/10]
2025-03-09 08:48:06: [retrieval_preprocessing] concatenated all embeddings and indices for 20 episodes for (8911427557, 'cup') [chosen_id count 5/10]
2025-03-09 08:48:06: [retrieval_preprocessing] we have num_total=2865 embedding_dim=49152
[retrieval_preprocessing] for episode 76293 [episode count 0/20], we have num_retrieval=np.int64(2708) num_query=np.int64(157)
2025-03-09 08:48:07,318 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-09 08:48:07,746 [INFO]: Launching the whole pipeline 03/09/2025, 08:48:07
2025-03-09 08:48:07,746 [INFO]: Reading total number of vectors and dimension 03/09/2025, 08:48:07
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1173.89it/s]
2025-03-09 08:48:07,775 [INFO]: There are 2708 embeddings of dim 49152
2025-03-09 08:48:07,775 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0292 secs
2025-03-09 08:48:07,775 [INFO]: 	Compute estimated construction time of the index 03/09/2025, 08:48:07
2025-03-09 08:48:07,775 [INFO]: 		-> Train: 16.7 minutes
2025-03-09 08:48:07,775 [INFO]: 		-> Add: 1.5 seconds
2025-03-09 08:48:07,775 [INFO]: 		Total: 16.7 minutes
2025-03-09 08:48:07,775 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0001 secs
2025-03-09 08:48:07,775 [INFO]: 	Checking that your have enough memory available to create the index 03/09/2025, 08:48:07
2025-03-09 08:48:07,775 [INFO]: 558.9MB of memory will be needed to build the index (more might be used if you have more)
2025-03-09 08:48:07,776 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0002 secs
2025-03-09 08:48:07,776 [INFO]: 	Selecting most promising index types given data characteristics 03/09/2025, 08:48:07
2025-03-09 08:48:07,776 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-09 08:48:07,776 [INFO]: 	Creating the index 03/09/2025, 08:48:07
2025-03-09 08:48:07,776 [INFO]: 		-> Instanciate the index HNSW15 03/09/2025, 08:48:07
2025-03-09 08:48:07,777 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0012 secs
2025-03-09 08:48:07,777 [INFO]: 		-> Adding the vectors to the index 03/09/2025, 08:48:07
2025-03-09 08:48:07,777 [INFO]: The memory available for adding the vectors is 49.5GB(total available - used by the index)
2025-03-09 08:48:07,777 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/11 [00:00<?, ?it/s]  9%|▉         | 1/11 [00:00<00:01,  9.01it/s] 64%|██████▎   | 7/11 [00:00<00:00, 35.23it/s]100%|██████████| 11/11 [00:02<00:00,  4.10it/s]100%|██████████| 11/11 [00:02<00:00,  4.97it/s]
2025-03-09 08:48:09,992 [INFO]: 	Computing best hyperparameters for index knn.index 03/09/2025, 08:48:09
2025-03-09 08:48:39,410 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 29.4175 secs
2025-03-09 08:48:39,410 [INFO]: The best hyperparameters are: efSearch=269
2025-03-09 08:48:39,410 [INFO]: 	Compute fast metrics 03/09/2025, 08:48:39
  0%|          | 0/4 [00:00<?, ?it/s] 25%|██▌       | 1/4 [00:00<00:00,  5.23it/s] 50%|█████     | 2/4 [00:00<00:00,  6.86it/s] 75%|███████▌  | 3/4 [00:00<00:00,  7.77it/s] 75%|███████▌  | 3/4 [00:00<00:00,  5.87it/s]
2025-03-09 08:48:56,997 [INFO]: 	>>> Finished "Compute fast metrics" in 17.5865 secs
2025-03-09 08:48:56,999 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 49.2221 secs
2025-03-09 08:48:57,000 [INFO]: {
2025-03-09 08:48:57,000 [INFO]: 	index_key: HNSW15
2025-03-09 08:48:57,000 [INFO]: 	index_param: efSearch=269
2025-03-09 08:48:57,000 [INFO]: 	index_path: knn.index
2025-03-09 08:48:57,000 [INFO]: 	size in bytes: 532782250
2025-03-09 08:48:57,000 [INFO]: 	avg_search_speed_ms: 10.562672870579828
2025-03-09 08:48:57,000 [INFO]: 	99p_search_speed_ms: 20.24204761255531
2025-03-09 08:48:57,000 [INFO]: 	reconstruction error %: 0.0
2025-03-09 08:48:57,000 [INFO]: 	nb vectors: 2708
2025-03-09 08:48:57,000 [INFO]: 	vectors dimension: 49152
2025-03-09 08:48:57,000 [INFO]: 	compression ratio: 0.999309687963516
2025-03-09 08:48:57,000 [INFO]: }
2025-03-09 08:48:57,000 [INFO]: 	>>> Finished "Creating the index" in 49.2244 secs
2025-03-09 08:48:57,000 [INFO]: >>> Finished "Launching the whole pipeline" in 49.2543 secs
2025-03-09 08:48:58: [retrieval_preprocessing] calculating distances ...
2025-03-09 08:48:58: [retrieval_preprocessing] finished and saved retrieval indices for episode 76293 [episode count 0/20]
[retrieval_preprocessing] for episode 56344 [episode count 1/20], we have num_retrieval=np.int64(2710) num_query=np.int64(155)
2025-03-09 08:48:58,838 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-09 08:48:59,200 [INFO]: Launching the whole pipeline 03/09/2025, 08:48:59
2025-03-09 08:48:59,200 [INFO]: Reading total number of vectors and dimension 03/09/2025, 08:48:59
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1434.93it/s]
2025-03-09 08:48:59,225 [INFO]: There are 2710 embeddings of dim 49152
2025-03-09 08:48:59,225 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0254 secs
2025-03-09 08:48:59,225 [INFO]: 	Compute estimated construction time of the index 03/09/2025, 08:48:59
2025-03-09 08:48:59,225 [INFO]: 		-> Train: 16.7 minutes
2025-03-09 08:48:59,225 [INFO]: 		-> Add: 1.5 seconds
2025-03-09 08:48:59,225 [INFO]: 		Total: 16.7 minutes
2025-03-09 08:48:59,225 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0001 secs
2025-03-09 08:48:59,226 [INFO]: 	Checking that your have enough memory available to create the index 03/09/2025, 08:48:59
2025-03-09 08:48:59,226 [INFO]: 559.3MB of memory will be needed to build the index (more might be used if you have more)
2025-03-09 08:48:59,226 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0003 secs
2025-03-09 08:48:59,226 [INFO]: 	Selecting most promising index types given data characteristics 03/09/2025, 08:48:59
2025-03-09 08:48:59,226 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-09 08:48:59,226 [INFO]: 	Creating the index 03/09/2025, 08:48:59
2025-03-09 08:48:59,226 [INFO]: 		-> Instanciate the index HNSW15 03/09/2025, 08:48:59
2025-03-09 08:48:59,227 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0011 secs
2025-03-09 08:48:59,227 [INFO]: 		-> Adding the vectors to the index 03/09/2025, 08:48:59
2025-03-09 08:48:59,227 [INFO]: The memory available for adding the vectors is 49.5GB(total available - used by the index)
2025-03-09 08:48:59,227 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/11 [00:00<?, ?it/s]  9%|▉         | 1/11 [00:00<00:01,  8.68it/s] 64%|██████▎   | 7/11 [00:00<00:00, 33.72it/s]100%|██████████| 11/11 [00:02<00:00,  3.58it/s]100%|██████████| 11/11 [00:02<00:00,  4.36it/s]
2025-03-09 08:49:01,756 [INFO]: 	Computing best hyperparameters for index knn.index 03/09/2025, 08:49:01
2025-03-09 08:49:40,646 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 38.8890 secs
2025-03-09 08:49:40,646 [INFO]: The best hyperparameters are: efSearch=273
2025-03-09 08:49:40,646 [INFO]: 	Compute fast metrics 03/09/2025, 08:49:40
  0%|          | 0/4 [00:00<?, ?it/s] 50%|█████     | 2/4 [00:00<00:00, 14.77it/s] 75%|███████▌  | 3/4 [00:00<00:00, 13.72it/s]
2025-03-09 08:49:57,740 [INFO]: 	>>> Finished "Compute fast metrics" in 17.0937 secs
2025-03-09 08:49:57,742 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 58.5146 secs
2025-03-09 08:49:57,742 [INFO]: {
2025-03-09 08:49:57,742 [INFO]: 	index_key: HNSW15
2025-03-09 08:49:57,742 [INFO]: 	index_param: efSearch=273
2025-03-09 08:49:57,742 [INFO]: 	index_path: knn.index
2025-03-09 08:49:57,742 [INFO]: 	size in bytes: 533175730
2025-03-09 08:49:57,742 [INFO]: 	avg_search_speed_ms: 9.902565441057455
2025-03-09 08:49:57,742 [INFO]: 	99p_search_speed_ms: 21.950577835086726
2025-03-09 08:49:57,742 [INFO]: 	reconstruction error %: 0.0
2025-03-09 08:49:57,742 [INFO]: 	nb vectors: 2710
2025-03-09 08:49:57,742 [INFO]: 	vectors dimension: 49152
2025-03-09 08:49:57,742 [INFO]: 	compression ratio: 0.9993097022627042
2025-03-09 08:49:57,742 [INFO]: }
2025-03-09 08:49:57,742 [INFO]: 	>>> Finished "Creating the index" in 58.5162 secs
2025-03-09 08:49:57,742 [INFO]: >>> Finished "Launching the whole pipeline" in 58.5423 secs
2025-03-09 08:49:58: [retrieval_preprocessing] calculating distances ...
2025-03-09 08:49:59: [retrieval_preprocessing] finished and saved retrieval indices for episode 56344 [episode count 1/20]
[retrieval_preprocessing] for episode 94752 [episode count 2/20], we have num_retrieval=np.int64(2723) num_query=np.int64(142)
2025-03-09 08:49:59,514 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-09 08:49:59,851 [INFO]: Launching the whole pipeline 03/09/2025, 08:49:59
2025-03-09 08:49:59,851 [INFO]: Reading total number of vectors and dimension 03/09/2025, 08:49:59
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1470.65it/s]
2025-03-09 08:49:59,877 [INFO]: There are 2723 embeddings of dim 49152
2025-03-09 08:49:59,877 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0263 secs
2025-03-09 08:49:59,877 [INFO]: 	Compute estimated construction time of the index 03/09/2025, 08:49:59
2025-03-09 08:49:59,878 [INFO]: 		-> Train: 16.7 minutes
2025-03-09 08:49:59,878 [INFO]: 		-> Add: 1.5 seconds
2025-03-09 08:49:59,878 [INFO]: 		Total: 16.7 minutes
2025-03-09 08:49:59,878 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0001 secs
2025-03-09 08:49:59,878 [INFO]: 	Checking that your have enough memory available to create the index 03/09/2025, 08:49:59
2025-03-09 08:49:59,878 [INFO]: 562.0MB of memory will be needed to build the index (more might be used if you have more)
2025-03-09 08:49:59,878 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0002 secs
2025-03-09 08:49:59,878 [INFO]: 	Selecting most promising index types given data characteristics 03/09/2025, 08:49:59
2025-03-09 08:49:59,878 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-09 08:49:59,878 [INFO]: 	Creating the index 03/09/2025, 08:49:59
2025-03-09 08:49:59,878 [INFO]: 		-> Instanciate the index HNSW15 03/09/2025, 08:49:59
2025-03-09 08:49:59,879 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0012 secs
2025-03-09 08:49:59,880 [INFO]: 		-> Adding the vectors to the index 03/09/2025, 08:49:59
2025-03-09 08:49:59,880 [INFO]: The memory available for adding the vectors is 49.5GB(total available - used by the index)
2025-03-09 08:49:59,880 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/11 [00:00<?, ?it/s] 18%|█▊        | 2/11 [00:00<00:00, 18.21it/s] 73%|███████▎  | 8/11 [00:00<00:00, 38.35it/s]100%|██████████| 11/11 [00:01<00:00,  5.60it/s]
2025-03-09 08:50:01,850 [INFO]: 	Computing best hyperparameters for index knn.index 03/09/2025, 08:50:01
2025-03-09 08:50:38,166 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 36.3165 secs
2025-03-09 08:50:38,167 [INFO]: The best hyperparameters are: efSearch=267
2025-03-09 08:50:38,167 [INFO]: 	Compute fast metrics 03/09/2025, 08:50:38
  0%|          | 0/4 [00:00<?, ?it/s] 75%|███████▌  | 3/4 [00:00<00:00, 26.74it/s] 75%|███████▌  | 3/4 [00:00<00:00, 22.38it/s]
2025-03-09 08:50:54,281 [INFO]: 	>>> Finished "Compute fast metrics" in 16.1139 secs
2025-03-09 08:50:54,574 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 54.6940 secs
2025-03-09 08:50:54,574 [INFO]: {
2025-03-09 08:50:54,574 [INFO]: 	index_key: HNSW15
2025-03-09 08:50:54,574 [INFO]: 	index_param: efSearch=267
2025-03-09 08:50:54,574 [INFO]: 	index_path: knn.index
2025-03-09 08:50:54,574 [INFO]: 	size in bytes: 535733350
2025-03-09 08:50:54,574 [INFO]: 	avg_search_speed_ms: 9.512366980870745
2025-03-09 08:50:54,574 [INFO]: 	99p_search_speed_ms: 16.956073930487037
2025-03-09 08:50:54,574 [INFO]: 	reconstruction error %: 0.0
2025-03-09 08:50:54,574 [INFO]: 	nb vectors: 2723
2025-03-09 08:50:54,574 [INFO]: 	vectors dimension: 49152
2025-03-09 08:50:54,574 [INFO]: 	compression ratio: 0.9993097946954395
2025-03-09 08:50:54,575 [INFO]: }
2025-03-09 08:50:54,575 [INFO]: 	>>> Finished "Creating the index" in 54.6965 secs
2025-03-09 08:50:54,575 [INFO]: >>> Finished "Launching the whole pipeline" in 54.7236 secs
2025-03-09 08:50:55: [retrieval_preprocessing] calculating distances ...
2025-03-09 08:50:56: [retrieval_preprocessing] finished and saved retrieval indices for episode 94752 [episode count 2/20]
[retrieval_preprocessing] for episode 36897 [episode count 3/20], we have num_retrieval=np.int64(2726) num_query=np.int64(139)
2025-03-09 08:50:57,154 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-09 08:50:57,565 [INFO]: Launching the whole pipeline 03/09/2025, 08:50:57
2025-03-09 08:50:57,565 [INFO]: Reading total number of vectors and dimension 03/09/2025, 08:50:57
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1354.75it/s]
2025-03-09 08:50:57,595 [INFO]: There are 2726 embeddings of dim 49152
2025-03-09 08:50:57,596 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0309 secs
2025-03-09 08:50:57,596 [INFO]: 	Compute estimated construction time of the index 03/09/2025, 08:50:57
2025-03-09 08:50:57,596 [INFO]: 		-> Train: 16.7 minutes
2025-03-09 08:50:57,596 [INFO]: 		-> Add: 1.5 seconds
2025-03-09 08:50:57,596 [INFO]: 		Total: 16.7 minutes
2025-03-09 08:50:57,596 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0004 secs
2025-03-09 08:50:57,597 [INFO]: 	Checking that your have enough memory available to create the index 03/09/2025, 08:50:57
2025-03-09 08:50:57,597 [INFO]: 562.6MB of memory will be needed to build the index (more might be used if you have more)
2025-03-09 08:50:57,597 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0005 secs
2025-03-09 08:50:57,597 [INFO]: 	Selecting most promising index types given data characteristics 03/09/2025, 08:50:57
2025-03-09 08:50:57,597 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-09 08:50:57,597 [INFO]: 	Creating the index 03/09/2025, 08:50:57
2025-03-09 08:50:57,598 [INFO]: 		-> Instanciate the index HNSW15 03/09/2025, 08:50:57
2025-03-09 08:50:57,601 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0029 secs
2025-03-09 08:50:57,601 [INFO]: 		-> Adding the vectors to the index 03/09/2025, 08:50:57
2025-03-09 08:50:57,601 [INFO]: The memory available for adding the vectors is 49.5GB(total available - used by the index)
2025-03-09 08:50:57,601 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/11 [00:00<?, ?it/s]  9%|▉         | 1/11 [00:00<00:01,  6.70it/s] 27%|██▋       | 3/11 [00:00<00:00, 10.13it/s] 45%|████▌     | 5/11 [00:00<00:00, 11.24it/s] 64%|██████▎   | 7/11 [00:00<00:00, 11.70it/s] 82%|████████▏ | 9/11 [00:00<00:00, 12.02it/s]100%|██████████| 11/11 [00:03<00:00,  2.22it/s]100%|██████████| 11/11 [00:03<00:00,  3.60it/s]
2025-03-09 08:51:00,673 [INFO]: 	Computing best hyperparameters for index knn.index 03/09/2025, 08:51:00
2025-03-09 08:51:30,256 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 29.5816 secs
2025-03-09 08:51:30,256 [INFO]: The best hyperparameters are: efSearch=314
2025-03-09 08:51:30,256 [INFO]: 	Compute fast metrics 03/09/2025, 08:51:30
  0%|          | 0/4 [00:00<?, ?it/s] 25%|██▌       | 1/4 [00:00<00:00,  4.79it/s] 50%|█████     | 2/4 [00:00<00:00,  6.44it/s] 75%|███████▌  | 3/4 [00:00<00:00,  7.13it/s] 75%|███████▌  | 3/4 [00:00<00:00,  5.31it/s]
2025-03-09 08:51:48,518 [INFO]: 	>>> Finished "Compute fast metrics" in 18.2617 secs
2025-03-09 08:51:48,520 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 50.9187 secs
2025-03-09 08:51:48,520 [INFO]: {
2025-03-09 08:51:48,520 [INFO]: 	index_key: HNSW15
2025-03-09 08:51:48,520 [INFO]: 	index_param: efSearch=314
2025-03-09 08:51:48,520 [INFO]: 	index_path: knn.index
2025-03-09 08:51:48,520 [INFO]: 	size in bytes: 536323570
2025-03-09 08:51:48,520 [INFO]: 	avg_search_speed_ms: 10.522716520599237
2025-03-09 08:51:48,520 [INFO]: 	99p_search_speed_ms: 18.433322100900114
2025-03-09 08:51:48,520 [INFO]: 	reconstruction error %: 0.0
2025-03-09 08:51:48,520 [INFO]: 	nb vectors: 2726
2025-03-09 08:51:48,520 [INFO]: 	vectors dimension: 49152
2025-03-09 08:51:48,520 [INFO]: 	compression ratio: 0.9993098159008749
2025-03-09 08:51:48,520 [INFO]: }
2025-03-09 08:51:48,520 [INFO]: 	>>> Finished "Creating the index" in 50.9227 secs
2025-03-09 08:51:48,520 [INFO]: >>> Finished "Launching the whole pipeline" in 50.9555 secs
2025-03-09 08:51:49: [retrieval_preprocessing] calculating distances ...
2025-03-09 08:51:50: [retrieval_preprocessing] finished and saved retrieval indices for episode 36897 [episode count 3/20]
[retrieval_preprocessing] for episode 37922 [episode count 4/20], we have num_retrieval=np.int64(2735) num_query=np.int64(130)
2025-03-09 08:51:51,210 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-09 08:51:51,683 [INFO]: Launching the whole pipeline 03/09/2025, 08:51:51
2025-03-09 08:51:51,683 [INFO]: Reading total number of vectors and dimension 03/09/2025, 08:51:51
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 2352.39it/s]
2025-03-09 08:51:51,711 [INFO]: There are 2735 embeddings of dim 49152
2025-03-09 08:51:51,711 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0284 secs
2025-03-09 08:51:51,711 [INFO]: 	Compute estimated construction time of the index 03/09/2025, 08:51:51
2025-03-09 08:51:51,711 [INFO]: 		-> Train: 16.7 minutes
2025-03-09 08:51:51,711 [INFO]: 		-> Add: 1.5 seconds
2025-03-09 08:51:51,711 [INFO]: 		Total: 16.7 minutes
2025-03-09 08:51:51,712 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0001 secs
2025-03-09 08:51:51,712 [INFO]: 	Checking that your have enough memory available to create the index 03/09/2025, 08:51:51
2025-03-09 08:51:51,712 [INFO]: 564.4MB of memory will be needed to build the index (more might be used if you have more)
2025-03-09 08:51:51,712 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0002 secs
2025-03-09 08:51:51,712 [INFO]: 	Selecting most promising index types given data characteristics 03/09/2025, 08:51:51
2025-03-09 08:51:51,712 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-09 08:51:51,712 [INFO]: 	Creating the index 03/09/2025, 08:51:51
2025-03-09 08:51:51,712 [INFO]: 		-> Instanciate the index HNSW15 03/09/2025, 08:51:51
2025-03-09 08:51:51,713 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0013 secs
2025-03-09 08:51:51,713 [INFO]: 		-> Adding the vectors to the index 03/09/2025, 08:51:51
2025-03-09 08:51:51,713 [INFO]: The memory available for adding the vectors is 49.5GB(total available - used by the index)
2025-03-09 08:51:51,713 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/11 [00:00<?, ?it/s]  9%|▉         | 1/11 [00:00<00:01,  6.18it/s] 27%|██▋       | 3/11 [00:00<00:00,  9.85it/s] 45%|████▌     | 5/11 [00:00<00:00, 11.20it/s] 64%|██████▎   | 7/11 [00:00<00:00, 11.80it/s] 82%|████████▏ | 9/11 [00:00<00:00, 12.02it/s]100%|██████████| 11/11 [00:03<00:00,  2.02it/s]100%|██████████| 11/11 [00:03<00:00,  3.31it/s]
2025-03-09 08:51:55,047 [INFO]: 	Computing best hyperparameters for index knn.index 03/09/2025, 08:51:55
2025-03-09 08:52:28,966 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 33.9186 secs
2025-03-09 08:52:28,966 [INFO]: The best hyperparameters are: efSearch=297
2025-03-09 08:52:28,966 [INFO]: 	Compute fast metrics 03/09/2025, 08:52:28
  0%|          | 0/4 [00:00<?, ?it/s] 25%|██▌       | 1/4 [00:00<00:00,  5.41it/s] 50%|█████     | 2/4 [00:00<00:00,  7.00it/s] 75%|███████▌  | 3/4 [00:00<00:00,  7.70it/s] 75%|███████▌  | 3/4 [00:00<00:00,  5.64it/s]
2025-03-09 08:52:49,122 [INFO]: 	>>> Finished "Compute fast metrics" in 20.1558 secs
2025-03-09 08:52:49,124 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 57.4107 secs
2025-03-09 08:52:49,124 [INFO]: {
2025-03-09 08:52:49,124 [INFO]: 	index_key: HNSW15
2025-03-09 08:52:49,124 [INFO]: 	index_param: efSearch=297
2025-03-09 08:52:49,124 [INFO]: 	index_path: knn.index
2025-03-09 08:52:49,124 [INFO]: 	size in bytes: 538094230
2025-03-09 08:52:49,124 [INFO]: 	avg_search_speed_ms: 10.36848420364097
2025-03-09 08:52:49,124 [INFO]: 	99p_search_speed_ms: 21.10180796124041
2025-03-09 08:52:49,124 [INFO]: 	reconstruction error %: 0.0
2025-03-09 08:52:49,124 [INFO]: 	nb vectors: 2735
2025-03-09 08:52:49,124 [INFO]: 	vectors dimension: 49152
2025-03-09 08:52:49,124 [INFO]: 	compression ratio: 0.9993098792380658
2025-03-09 08:52:49,124 [INFO]: }
2025-03-09 08:52:49,124 [INFO]: 	>>> Finished "Creating the index" in 57.4125 secs
2025-03-09 08:52:49,124 [INFO]: >>> Finished "Launching the whole pipeline" in 57.4416 secs
2025-03-09 08:52:49: [retrieval_preprocessing] calculating distances ...
2025-03-09 08:52:50: [retrieval_preprocessing] finished and saved retrieval indices for episode 37922 [episode count 4/20]
[retrieval_preprocessing] for episode 95264 [episode count 5/20], we have num_retrieval=np.int64(2730) num_query=np.int64(135)
2025-03-09 08:52:51,053 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-09 08:52:51,467 [INFO]: Launching the whole pipeline 03/09/2025, 08:52:51
2025-03-09 08:52:51,467 [INFO]: Reading total number of vectors and dimension 03/09/2025, 08:52:51
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1280.70it/s]
2025-03-09 08:52:51,502 [INFO]: There are 2730 embeddings of dim 49152
2025-03-09 08:52:51,502 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0354 secs
2025-03-09 08:52:51,502 [INFO]: 	Compute estimated construction time of the index 03/09/2025, 08:52:51
2025-03-09 08:52:51,503 [INFO]: 		-> Train: 16.7 minutes
2025-03-09 08:52:51,503 [INFO]: 		-> Add: 1.5 seconds
2025-03-09 08:52:51,503 [INFO]: 		Total: 16.7 minutes
2025-03-09 08:52:51,503 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0001 secs
2025-03-09 08:52:51,503 [INFO]: 	Checking that your have enough memory available to create the index 03/09/2025, 08:52:51
2025-03-09 08:52:51,503 [INFO]: 563.4MB of memory will be needed to build the index (more might be used if you have more)
2025-03-09 08:52:51,503 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0003 secs
2025-03-09 08:52:51,503 [INFO]: 	Selecting most promising index types given data characteristics 03/09/2025, 08:52:51
2025-03-09 08:52:51,503 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-09 08:52:51,503 [INFO]: 	Creating the index 03/09/2025, 08:52:51
2025-03-09 08:52:51,503 [INFO]: 		-> Instanciate the index HNSW15 03/09/2025, 08:52:51
2025-03-09 08:52:51,505 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0013 secs
2025-03-09 08:52:51,505 [INFO]: 		-> Adding the vectors to the index 03/09/2025, 08:52:51
2025-03-09 08:52:51,505 [INFO]: The memory available for adding the vectors is 49.5GB(total available - used by the index)
2025-03-09 08:52:51,505 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/11 [00:00<?, ?it/s]  9%|▉         | 1/11 [00:00<00:01,  8.38it/s] 36%|███▋      | 4/11 [00:00<00:00, 17.73it/s] 64%|██████▎   | 7/11 [00:00<00:00, 19.23it/s]100%|██████████| 11/11 [00:02<00:00,  3.44it/s]100%|██████████| 11/11 [00:02<00:00,  4.42it/s]
2025-03-09 08:52:54,001 [INFO]: 	Computing best hyperparameters for index knn.index 03/09/2025, 08:52:54
2025-03-09 08:53:29,069 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 35.0671 secs
2025-03-09 08:53:29,069 [INFO]: The best hyperparameters are: efSearch=297
2025-03-09 08:53:29,069 [INFO]: 	Compute fast metrics 03/09/2025, 08:53:29
  0%|          | 0/4 [00:00<?, ?it/s] 25%|██▌       | 1/4 [00:00<00:00,  5.23it/s] 50%|█████     | 2/4 [00:00<00:00,  7.18it/s] 75%|███████▌  | 3/4 [00:00<00:00,  7.95it/s] 75%|███████▌  | 3/4 [00:00<00:00,  5.93it/s]
2025-03-09 08:53:45,709 [INFO]: 	>>> Finished "Compute fast metrics" in 16.6402 secs
2025-03-09 08:53:45,712 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 54.2075 secs
2025-03-09 08:53:45,712 [INFO]: {
2025-03-09 08:53:45,712 [INFO]: 	index_key: HNSW15
2025-03-09 08:53:45,712 [INFO]: 	index_param: efSearch=297
2025-03-09 08:53:45,712 [INFO]: 	index_path: knn.index
2025-03-09 08:53:45,712 [INFO]: 	size in bytes: 537110530
2025-03-09 08:53:45,712 [INFO]: 	avg_search_speed_ms: 9.863400004512062
2025-03-09 08:53:45,712 [INFO]: 	99p_search_speed_ms: 16.892902774270624
2025-03-09 08:53:45,712 [INFO]: 	reconstruction error %: 0.0
2025-03-09 08:53:45,712 [INFO]: 	nb vectors: 2730
2025-03-09 08:53:45,712 [INFO]: 	vectors dimension: 49152
2025-03-09 08:53:45,712 [INFO]: 	compression ratio: 0.9993098441022931
2025-03-09 08:53:45,712 [INFO]: }
2025-03-09 08:53:45,712 [INFO]: 	>>> Finished "Creating the index" in 54.2093 secs
2025-03-09 08:53:45,712 [INFO]: >>> Finished "Launching the whole pipeline" in 54.2456 secs
2025-03-09 08:53:46: [retrieval_preprocessing] calculating distances ...
2025-03-09 08:53:47: [retrieval_preprocessing] finished and saved retrieval indices for episode 95264 [episode count 5/20]
[retrieval_preprocessing] for episode 4644 [episode count 6/20], we have num_retrieval=np.int64(2714) num_query=np.int64(151)
2025-03-09 08:53:47,952 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-09 08:53:48,394 [INFO]: Launching the whole pipeline 03/09/2025, 08:53:48
2025-03-09 08:53:48,394 [INFO]: Reading total number of vectors and dimension 03/09/2025, 08:53:48
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1391.15it/s]
2025-03-09 08:53:48,419 [INFO]: There are 2714 embeddings of dim 49152
2025-03-09 08:53:48,420 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0256 secs
2025-03-09 08:53:48,420 [INFO]: 	Compute estimated construction time of the index 03/09/2025, 08:53:48
2025-03-09 08:53:48,420 [INFO]: 		-> Train: 16.7 minutes
2025-03-09 08:53:48,420 [INFO]: 		-> Add: 1.5 seconds
2025-03-09 08:53:48,420 [INFO]: 		Total: 16.7 minutes
2025-03-09 08:53:48,420 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0001 secs
2025-03-09 08:53:48,420 [INFO]: 	Checking that your have enough memory available to create the index 03/09/2025, 08:53:48
2025-03-09 08:53:48,420 [INFO]: 560.1MB of memory will be needed to build the index (more might be used if you have more)
2025-03-09 08:53:48,420 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0002 secs
2025-03-09 08:53:48,420 [INFO]: 	Selecting most promising index types given data characteristics 03/09/2025, 08:53:48
2025-03-09 08:53:48,420 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-09 08:53:48,420 [INFO]: 	Creating the index 03/09/2025, 08:53:48
2025-03-09 08:53:48,420 [INFO]: 		-> Instanciate the index HNSW15 03/09/2025, 08:53:48
2025-03-09 08:53:48,421 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0011 secs
2025-03-09 08:53:48,421 [INFO]: 		-> Adding the vectors to the index 03/09/2025, 08:53:48
2025-03-09 08:53:48,421 [INFO]: The memory available for adding the vectors is 49.5GB(total available - used by the index)
2025-03-09 08:53:48,421 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/11 [00:00<?, ?it/s]  9%|▉         | 1/11 [00:00<00:01,  5.91it/s] 36%|███▋      | 4/11 [00:00<00:00, 13.24it/s] 55%|█████▍    | 6/11 [00:00<00:00, 13.02it/s] 73%|███████▎  | 8/11 [00:00<00:00, 14.96it/s] 91%|█████████ | 10/11 [00:00<00:00, 14.88it/s]100%|██████████| 11/11 [00:02<00:00,  4.22it/s]
2025-03-09 08:53:51,037 [INFO]: 	Computing best hyperparameters for index knn.index 03/09/2025, 08:53:51
2025-03-09 08:54:22,160 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 31.1226 secs
2025-03-09 08:54:22,160 [INFO]: The best hyperparameters are: efSearch=280
2025-03-09 08:54:22,160 [INFO]: 	Compute fast metrics 03/09/2025, 08:54:22
  0%|          | 0/4 [00:00<?, ?it/s] 50%|█████     | 2/4 [00:00<00:00, 18.79it/s] 75%|███████▌  | 3/4 [00:00<00:00, 20.48it/s]
2025-03-09 08:54:39,928 [INFO]: 	>>> Finished "Compute fast metrics" in 17.7675 secs
2025-03-09 08:54:40,246 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 51.8248 secs
2025-03-09 08:54:40,247 [INFO]: {
2025-03-09 08:54:40,247 [INFO]: 	index_key: HNSW15
2025-03-09 08:54:40,247 [INFO]: 	index_param: efSearch=280
2025-03-09 08:54:40,247 [INFO]: 	index_path: knn.index
2025-03-09 08:54:40,247 [INFO]: 	size in bytes: 533962690
2025-03-09 08:54:40,247 [INFO]: 	avg_search_speed_ms: 9.608740749027254
2025-03-09 08:54:40,247 [INFO]: 	99p_search_speed_ms: 18.518328247591807
2025-03-09 08:54:40,247 [INFO]: 	reconstruction error %: 0.0
2025-03-09 08:54:40,247 [INFO]: 	nb vectors: 2714
2025-03-09 08:54:40,247 [INFO]: 	vectors dimension: 49152
2025-03-09 08:54:40,247 [INFO]: 	compression ratio: 0.9993097307978578
2025-03-09 08:54:40,247 [INFO]: }
2025-03-09 08:54:40,247 [INFO]: 	>>> Finished "Creating the index" in 51.8272 secs
2025-03-09 08:54:40,247 [INFO]: >>> Finished "Launching the whole pipeline" in 51.8535 secs
2025-03-09 08:54:41: [retrieval_preprocessing] calculating distances ...
2025-03-09 08:54:41: [retrieval_preprocessing] finished and saved retrieval indices for episode 4644 [episode count 6/20]
[retrieval_preprocessing] for episode 3109 [episode count 7/20], we have num_retrieval=np.int64(2721) num_query=np.int64(144)
2025-03-09 08:54:42,480 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-09 08:54:42,897 [INFO]: Launching the whole pipeline 03/09/2025, 08:54:42
2025-03-09 08:54:42,897 [INFO]: Reading total number of vectors and dimension 03/09/2025, 08:54:42
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1432.97it/s]
2025-03-09 08:54:42,923 [INFO]: There are 2721 embeddings of dim 49152
2025-03-09 08:54:42,923 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0259 secs
2025-03-09 08:54:42,923 [INFO]: 	Compute estimated construction time of the index 03/09/2025, 08:54:42
2025-03-09 08:54:42,923 [INFO]: 		-> Train: 16.7 minutes
2025-03-09 08:54:42,923 [INFO]: 		-> Add: 1.5 seconds
2025-03-09 08:54:42,923 [INFO]: 		Total: 16.7 minutes
2025-03-09 08:54:42,923 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0001 secs
2025-03-09 08:54:42,923 [INFO]: 	Checking that your have enough memory available to create the index 03/09/2025, 08:54:42
2025-03-09 08:54:42,923 [INFO]: 561.5MB of memory will be needed to build the index (more might be used if you have more)
2025-03-09 08:54:42,923 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0001 secs
2025-03-09 08:54:42,923 [INFO]: 	Selecting most promising index types given data characteristics 03/09/2025, 08:54:42
2025-03-09 08:54:42,923 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-09 08:54:42,923 [INFO]: 	Creating the index 03/09/2025, 08:54:42
2025-03-09 08:54:42,923 [INFO]: 		-> Instanciate the index HNSW15 03/09/2025, 08:54:42
2025-03-09 08:54:42,924 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0008 secs
2025-03-09 08:54:42,924 [INFO]: 		-> Adding the vectors to the index 03/09/2025, 08:54:42
2025-03-09 08:54:42,924 [INFO]: The memory available for adding the vectors is 49.5GB(total available - used by the index)
2025-03-09 08:54:42,924 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/11 [00:00<?, ?it/s]  9%|▉         | 1/11 [00:00<00:01,  6.09it/s] 27%|██▋       | 3/11 [00:00<00:00,  9.68it/s] 45%|████▌     | 5/11 [00:00<00:00, 10.83it/s] 64%|██████▎   | 7/11 [00:00<00:00, 11.38it/s] 82%|████████▏ | 9/11 [00:00<00:00, 11.68it/s]100%|██████████| 11/11 [00:02<00:00,  2.65it/s]100%|██████████| 11/11 [00:02<00:00,  4.13it/s]
2025-03-09 08:54:45,593 [INFO]: 	Computing best hyperparameters for index knn.index 03/09/2025, 08:54:45
2025-03-09 08:55:23,353 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 37.7587 secs
2025-03-09 08:55:23,353 [INFO]: The best hyperparameters are: efSearch=255
2025-03-09 08:55:23,353 [INFO]: 	Compute fast metrics 03/09/2025, 08:55:23
  0%|          | 0/4 [00:00<?, ?it/s] 25%|██▌       | 1/4 [00:00<00:00,  7.09it/s] 75%|███████▌  | 3/4 [00:00<00:00, 11.18it/s] 75%|███████▌  | 3/4 [00:00<00:00,  7.79it/s]
2025-03-09 08:55:39,715 [INFO]: 	>>> Finished "Compute fast metrics" in 16.3616 secs
2025-03-09 08:55:39,716 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 56.7921 secs
2025-03-09 08:55:39,717 [INFO]: {
2025-03-09 08:55:39,717 [INFO]: 	index_key: HNSW15
2025-03-09 08:55:39,717 [INFO]: 	index_param: efSearch=255
2025-03-09 08:55:39,717 [INFO]: 	index_path: knn.index
2025-03-09 08:55:39,717 [INFO]: 	size in bytes: 535339870
2025-03-09 08:55:39,717 [INFO]: 	avg_search_speed_ms: 9.594947843090228
2025-03-09 08:55:39,717 [INFO]: 	99p_search_speed_ms: 16.103204635437567
2025-03-09 08:55:39,717 [INFO]: 	reconstruction error %: 0.0
2025-03-09 08:55:39,717 [INFO]: 	nb vectors: 2721
2025-03-09 08:55:39,717 [INFO]: 	vectors dimension: 49152
2025-03-09 08:55:39,717 [INFO]: 	compression ratio: 0.9993097805325054
2025-03-09 08:55:39,717 [INFO]: }
2025-03-09 08:55:39,717 [INFO]: 	>>> Finished "Creating the index" in 56.7934 secs
2025-03-09 08:55:39,717 [INFO]: >>> Finished "Launching the whole pipeline" in 56.8198 secs
2025-03-09 08:55:40: [retrieval_preprocessing] calculating distances ...
2025-03-09 08:55:41: [retrieval_preprocessing] finished and saved retrieval indices for episode 3109 [episode count 7/20]
[retrieval_preprocessing] for episode 34351 [episode count 8/20], we have num_retrieval=np.int64(2709) num_query=np.int64(156)
2025-03-09 08:55:41,745 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-09 08:55:42,259 [INFO]: Launching the whole pipeline 03/09/2025, 08:55:42
2025-03-09 08:55:42,259 [INFO]: Reading total number of vectors and dimension 03/09/2025, 08:55:42
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1929.30it/s]
2025-03-09 08:55:42,287 [INFO]: There are 2709 embeddings of dim 49152
2025-03-09 08:55:42,287 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0276 secs
2025-03-09 08:55:42,287 [INFO]: 	Compute estimated construction time of the index 03/09/2025, 08:55:42
2025-03-09 08:55:42,287 [INFO]: 		-> Train: 16.7 minutes
2025-03-09 08:55:42,287 [INFO]: 		-> Add: 1.5 seconds
2025-03-09 08:55:42,287 [INFO]: 		Total: 16.7 minutes
2025-03-09 08:55:42,287 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0001 secs
2025-03-09 08:55:42,287 [INFO]: 	Checking that your have enough memory available to create the index 03/09/2025, 08:55:42
2025-03-09 08:55:42,287 [INFO]: 559.1MB of memory will be needed to build the index (more might be used if you have more)
2025-03-09 08:55:42,287 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0002 secs
2025-03-09 08:55:42,287 [INFO]: 	Selecting most promising index types given data characteristics 03/09/2025, 08:55:42
2025-03-09 08:55:42,287 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-09 08:55:42,287 [INFO]: 	Creating the index 03/09/2025, 08:55:42
2025-03-09 08:55:42,288 [INFO]: 		-> Instanciate the index HNSW15 03/09/2025, 08:55:42
2025-03-09 08:55:42,289 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0011 secs
2025-03-09 08:55:42,289 [INFO]: 		-> Adding the vectors to the index 03/09/2025, 08:55:42
2025-03-09 08:55:42,289 [INFO]: The memory available for adding the vectors is 49.5GB(total available - used by the index)
2025-03-09 08:55:42,289 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/11 [00:00<?, ?it/s]  9%|▉         | 1/11 [00:00<00:01,  9.24it/s] 55%|█████▍    | 6/11 [00:00<00:00, 32.28it/s] 91%|█████████ | 10/11 [00:00<00:00, 19.07it/s]100%|██████████| 11/11 [00:02<00:00,  4.36it/s]
2025-03-09 08:55:44,818 [INFO]: 	Computing best hyperparameters for index knn.index 03/09/2025, 08:55:44
2025-03-09 08:56:19,978 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 35.1595 secs
2025-03-09 08:56:19,978 [INFO]: The best hyperparameters are: efSearch=277
2025-03-09 08:56:19,978 [INFO]: 	Compute fast metrics 03/09/2025, 08:56:19
  0%|          | 0/4 [00:00<?, ?it/s] 25%|██▌       | 1/4 [00:00<00:00,  6.70it/s] 75%|███████▌  | 3/4 [00:00<00:00, 10.12it/s] 75%|███████▌  | 3/4 [00:00<00:00,  7.80it/s]
2025-03-09 08:56:34,013 [INFO]: 	>>> Finished "Compute fast metrics" in 14.0345 secs
2025-03-09 08:56:34,036 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 51.7472 secs
2025-03-09 08:56:34,036 [INFO]: {
2025-03-09 08:56:34,036 [INFO]: 	index_key: HNSW15
2025-03-09 08:56:34,036 [INFO]: 	index_param: efSearch=277
2025-03-09 08:56:34,036 [INFO]: 	index_path: knn.index
2025-03-09 08:56:34,036 [INFO]: 	size in bytes: 532978990
2025-03-09 08:56:34,036 [INFO]: 	avg_search_speed_ms: 8.979676108258898
2025-03-09 08:56:34,036 [INFO]: 	99p_search_speed_ms: 15.388258602470156
2025-03-09 08:56:34,036 [INFO]: 	reconstruction error %: 0.0
2025-03-09 08:56:34,036 [INFO]: 	nb vectors: 2709
2025-03-09 08:56:34,036 [INFO]: 	vectors dimension: 49152
2025-03-09 08:56:34,036 [INFO]: 	compression ratio: 0.9993096951157493
2025-03-09 08:56:34,036 [INFO]: }
2025-03-09 08:56:34,036 [INFO]: 	>>> Finished "Creating the index" in 51.7489 secs
2025-03-09 08:56:34,036 [INFO]: >>> Finished "Launching the whole pipeline" in 51.7773 secs
2025-03-09 08:56:34: [retrieval_preprocessing] calculating distances ...
2025-03-09 08:56:35: [retrieval_preprocessing] finished and saved retrieval indices for episode 34351 [episode count 8/20]
[retrieval_preprocessing] for episode 27188 [episode count 9/20], we have num_retrieval=np.int64(2719) num_query=np.int64(146)
2025-03-09 08:56:36,266 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-09 08:56:36,663 [INFO]: Launching the whole pipeline 03/09/2025, 08:56:36
2025-03-09 08:56:36,663 [INFO]: Reading total number of vectors and dimension 03/09/2025, 08:56:36
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 2300.77it/s]
2025-03-09 08:56:36,687 [INFO]: There are 2719 embeddings of dim 49152
2025-03-09 08:56:36,688 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0242 secs
2025-03-09 08:56:36,688 [INFO]: 	Compute estimated construction time of the index 03/09/2025, 08:56:36
2025-03-09 08:56:36,688 [INFO]: 		-> Train: 16.7 minutes
2025-03-09 08:56:36,688 [INFO]: 		-> Add: 1.5 seconds
2025-03-09 08:56:36,688 [INFO]: 		Total: 16.7 minutes
2025-03-09 08:56:36,688 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0001 secs
2025-03-09 08:56:36,688 [INFO]: 	Checking that your have enough memory available to create the index 03/09/2025, 08:56:36
2025-03-09 08:56:36,688 [INFO]: 561.1MB of memory will be needed to build the index (more might be used if you have more)
2025-03-09 08:56:36,688 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0001 secs
2025-03-09 08:56:36,688 [INFO]: 	Selecting most promising index types given data characteristics 03/09/2025, 08:56:36
2025-03-09 08:56:36,688 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-09 08:56:36,688 [INFO]: 	Creating the index 03/09/2025, 08:56:36
2025-03-09 08:56:36,688 [INFO]: 		-> Instanciate the index HNSW15 03/09/2025, 08:56:36
2025-03-09 08:56:36,689 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0010 secs
2025-03-09 08:56:36,689 [INFO]: 		-> Adding the vectors to the index 03/09/2025, 08:56:36
2025-03-09 08:56:36,689 [INFO]: The memory available for adding the vectors is 49.5GB(total available - used by the index)
2025-03-09 08:56:36,689 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/11 [00:00<?, ?it/s]  9%|▉         | 1/11 [00:00<00:01,  5.25it/s] 18%|█▊        | 2/11 [00:00<00:01,  6.85it/s] 27%|██▋       | 3/11 [00:00<00:01,  7.61it/s] 36%|███▋      | 4/11 [00:00<00:00,  8.15it/s] 45%|████▌     | 5/11 [00:00<00:00,  8.32it/s] 55%|█████▍    | 6/11 [00:00<00:00,  8.38it/s] 64%|██████▎   | 7/11 [00:00<00:00,  8.46it/s] 73%|███████▎  | 8/11 [00:00<00:00,  8.58it/s] 82%|████████▏ | 9/11 [00:01<00:00,  8.78it/s] 91%|█████████ | 10/11 [00:01<00:00,  8.78it/s]100%|██████████| 11/11 [00:02<00:00,  1.65it/s]100%|██████████| 11/11 [00:02<00:00,  3.74it/s]
2025-03-09 08:56:39,640 [INFO]: 	Computing best hyperparameters for index knn.index 03/09/2025, 08:56:39
2025-03-09 08:57:10,114 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 30.4728 secs
2025-03-09 08:57:10,114 [INFO]: The best hyperparameters are: efSearch=327
2025-03-09 08:57:10,114 [INFO]: 	Compute fast metrics 03/09/2025, 08:57:10
  0%|          | 0/4 [00:00<?, ?it/s] 25%|██▌       | 1/4 [00:00<00:00,  5.63it/s] 50%|█████     | 2/4 [00:00<00:00,  7.24it/s] 75%|███████▌  | 3/4 [00:00<00:00,  8.01it/s] 75%|███████▌  | 3/4 [00:00<00:00,  6.04it/s]
2025-03-09 08:57:28,854 [INFO]: 	>>> Finished "Compute fast metrics" in 18.7401 secs
2025-03-09 08:57:28,856 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 52.1666 secs
2025-03-09 08:57:28,856 [INFO]: {
2025-03-09 08:57:28,856 [INFO]: 	index_key: HNSW15
2025-03-09 08:57:28,856 [INFO]: 	index_param: efSearch=327
2025-03-09 08:57:28,856 [INFO]: 	index_path: knn.index
2025-03-09 08:57:28,856 [INFO]: 	size in bytes: 534946390
2025-03-09 08:57:28,856 [INFO]: 	avg_search_speed_ms: 9.977120669101348
2025-03-09 08:57:28,856 [INFO]: 	99p_search_speed_ms: 15.708454968407752
2025-03-09 08:57:28,856 [INFO]: 	reconstruction error %: 0.0
2025-03-09 08:57:28,856 [INFO]: 	nb vectors: 2719
2025-03-09 08:57:28,856 [INFO]: 	vectors dimension: 49152
2025-03-09 08:57:28,856 [INFO]: 	compression ratio: 0.9993097663487364
2025-03-09 08:57:28,856 [INFO]: }
2025-03-09 08:57:28,856 [INFO]: 	>>> Finished "Creating the index" in 52.1680 secs
2025-03-09 08:57:28,856 [INFO]: >>> Finished "Launching the whole pipeline" in 52.1927 secs
2025-03-09 08:57:30: [retrieval_preprocessing] calculating distances ...
2025-03-09 08:57:30: [retrieval_preprocessing] finished and saved retrieval indices for episode 27188 [episode count 9/20]
[retrieval_preprocessing] for episode 18490 [episode count 10/20], we have num_retrieval=np.int64(2739) num_query=np.int64(126)
2025-03-09 08:57:31,205 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-09 08:57:31,615 [INFO]: Launching the whole pipeline 03/09/2025, 08:57:31
2025-03-09 08:57:31,616 [INFO]: Reading total number of vectors and dimension 03/09/2025, 08:57:31
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1710.56it/s]
2025-03-09 08:57:31,641 [INFO]: There are 2739 embeddings of dim 49152
2025-03-09 08:57:31,641 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0253 secs
2025-03-09 08:57:31,641 [INFO]: 	Compute estimated construction time of the index 03/09/2025, 08:57:31
2025-03-09 08:57:31,641 [INFO]: 		-> Train: 16.7 minutes
2025-03-09 08:57:31,641 [INFO]: 		-> Add: 1.5 seconds
2025-03-09 08:57:31,641 [INFO]: 		Total: 16.7 minutes
2025-03-09 08:57:31,641 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0001 secs
2025-03-09 08:57:31,641 [INFO]: 	Checking that your have enough memory available to create the index 03/09/2025, 08:57:31
2025-03-09 08:57:31,641 [INFO]: 565.3MB of memory will be needed to build the index (more might be used if you have more)
2025-03-09 08:57:31,641 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0001 secs
2025-03-09 08:57:31,641 [INFO]: 	Selecting most promising index types given data characteristics 03/09/2025, 08:57:31
2025-03-09 08:57:31,641 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-09 08:57:31,641 [INFO]: 	Creating the index 03/09/2025, 08:57:31
2025-03-09 08:57:31,641 [INFO]: 		-> Instanciate the index HNSW15 03/09/2025, 08:57:31
2025-03-09 08:57:31,643 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0011 secs
2025-03-09 08:57:31,643 [INFO]: 		-> Adding the vectors to the index 03/09/2025, 08:57:31
2025-03-09 08:57:31,643 [INFO]: The memory available for adding the vectors is 49.5GB(total available - used by the index)
2025-03-09 08:57:31,643 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/11 [00:00<?, ?it/s]  9%|▉         | 1/11 [00:00<00:01,  7.05it/s] 18%|█▊        | 2/11 [00:00<00:01,  8.21it/s] 36%|███▋      | 4/11 [00:00<00:00, 10.35it/s] 55%|█████▍    | 6/11 [00:00<00:00, 11.41it/s] 73%|███████▎  | 8/11 [00:00<00:00, 11.70it/s] 91%|█████████ | 10/11 [00:00<00:00, 12.04it/s]100%|██████████| 11/11 [00:02<00:00,  4.03it/s]
2025-03-09 08:57:34,381 [INFO]: 	Computing best hyperparameters for index knn.index 03/09/2025, 08:57:34
2025-03-09 08:58:11,659 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 37.2780 secs
2025-03-09 08:58:11,660 [INFO]: The best hyperparameters are: efSearch=299
2025-03-09 08:58:11,660 [INFO]: 	Compute fast metrics 03/09/2025, 08:58:11
  0%|          | 0/4 [00:00<?, ?it/s] 25%|██▌       | 1/4 [00:00<00:00,  5.45it/s] 50%|█████     | 2/4 [00:00<00:00,  7.27it/s] 75%|███████▌  | 3/4 [00:00<00:00,  6.38it/s]
2025-03-09 08:58:27,308 [INFO]: 	>>> Finished "Compute fast metrics" in 15.6480 secs
2025-03-09 08:58:27,310 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 55.6667 secs
2025-03-09 08:58:27,310 [INFO]: {
2025-03-09 08:58:27,310 [INFO]: 	index_key: HNSW15
2025-03-09 08:58:27,310 [INFO]: 	index_param: efSearch=299
2025-03-09 08:58:27,310 [INFO]: 	index_path: knn.index
2025-03-09 08:58:27,310 [INFO]: 	size in bytes: 538881190
2025-03-09 08:58:27,310 [INFO]: 	avg_search_speed_ms: 9.48062575228018
2025-03-09 08:58:27,310 [INFO]: 	99p_search_speed_ms: 15.374589287675917
2025-03-09 08:58:27,310 [INFO]: 	reconstruction error %: 0.0
2025-03-09 08:58:27,310 [INFO]: 	nb vectors: 2739
2025-03-09 08:58:27,310 [INFO]: 	vectors dimension: 49152
2025-03-09 08:58:27,310 [INFO]: 	compression ratio: 0.9993099072543244
2025-03-09 08:58:27,310 [INFO]: }
2025-03-09 08:58:27,310 [INFO]: 	>>> Finished "Creating the index" in 55.6685 secs
2025-03-09 08:58:27,310 [INFO]: >>> Finished "Launching the whole pipeline" in 55.6944 secs
2025-03-09 08:58:28: [retrieval_preprocessing] calculating distances ...
2025-03-09 08:58:28: [retrieval_preprocessing] finished and saved retrieval indices for episode 18490 [episode count 10/20]
[retrieval_preprocessing] for episode 11324 [episode count 11/20], we have num_retrieval=np.int64(2751) num_query=np.int64(114)
2025-03-09 08:58:29,289 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-09 08:58:29,769 [INFO]: Launching the whole pipeline 03/09/2025, 08:58:29
2025-03-09 08:58:29,769 [INFO]: Reading total number of vectors and dimension 03/09/2025, 08:58:29
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1534.13it/s]
2025-03-09 08:58:29,798 [INFO]: There are 2751 embeddings of dim 49152
2025-03-09 08:58:29,798 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0290 secs
2025-03-09 08:58:29,798 [INFO]: 	Compute estimated construction time of the index 03/09/2025, 08:58:29
2025-03-09 08:58:29,798 [INFO]: 		-> Train: 16.7 minutes
2025-03-09 08:58:29,798 [INFO]: 		-> Add: 1.5 seconds
2025-03-09 08:58:29,798 [INFO]: 		Total: 16.7 minutes
2025-03-09 08:58:29,798 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0001 secs
2025-03-09 08:58:29,798 [INFO]: 	Checking that your have enough memory available to create the index 03/09/2025, 08:58:29
2025-03-09 08:58:29,798 [INFO]: 567.7MB of memory will be needed to build the index (more might be used if you have more)
2025-03-09 08:58:29,798 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0001 secs
2025-03-09 08:58:29,798 [INFO]: 	Selecting most promising index types given data characteristics 03/09/2025, 08:58:29
2025-03-09 08:58:29,798 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-09 08:58:29,798 [INFO]: 	Creating the index 03/09/2025, 08:58:29
2025-03-09 08:58:29,798 [INFO]: 		-> Instanciate the index HNSW15 03/09/2025, 08:58:29
2025-03-09 08:58:29,800 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0010 secs
2025-03-09 08:58:29,800 [INFO]: 		-> Adding the vectors to the index 03/09/2025, 08:58:29
2025-03-09 08:58:29,800 [INFO]: The memory available for adding the vectors is 49.5GB(total available - used by the index)
2025-03-09 08:58:29,800 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/11 [00:00<?, ?it/s]  9%|▉         | 1/11 [00:00<00:02,  3.81it/s] 27%|██▋       | 3/11 [00:00<00:01,  7.98it/s] 45%|████▌     | 5/11 [00:00<00:00,  9.22it/s] 64%|██████▎   | 7/11 [00:00<00:00, 10.44it/s] 82%|████████▏ | 9/11 [00:00<00:00, 10.56it/s]100%|██████████| 11/11 [00:03<00:00,  2.34it/s]100%|██████████| 11/11 [00:03<00:00,  3.63it/s]
2025-03-09 08:58:32,838 [INFO]: 	Computing best hyperparameters for index knn.index 03/09/2025, 08:58:32
2025-03-09 08:59:02,029 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 29.1901 secs
2025-03-09 08:59:02,029 [INFO]: The best hyperparameters are: efSearch=357
2025-03-09 08:59:02,029 [INFO]: 	Compute fast metrics 03/09/2025, 08:59:02
  0%|          | 0/4 [00:00<?, ?it/s] 25%|██▌       | 1/4 [00:00<00:00,  4.86it/s] 50%|█████     | 2/4 [00:00<00:00,  6.31it/s] 75%|███████▌  | 3/4 [00:00<00:00,  6.96it/s] 75%|███████▌  | 3/4 [00:00<00:00,  5.30it/s]
2025-03-09 08:59:18,635 [INFO]: 	>>> Finished "Compute fast metrics" in 16.6061 secs
2025-03-09 08:59:18,637 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 48.8374 secs
2025-03-09 08:59:18,637 [INFO]: {
2025-03-09 08:59:18,637 [INFO]: 	index_key: HNSW15
2025-03-09 08:59:18,637 [INFO]: 	index_param: efSearch=357
2025-03-09 08:59:18,637 [INFO]: 	index_path: knn.index
2025-03-09 08:59:18,637 [INFO]: 	size in bytes: 541242070
2025-03-09 08:59:18,637 [INFO]: 	avg_search_speed_ms: 11.36301131522156
2025-03-09 08:59:18,637 [INFO]: 	99p_search_speed_ms: 22.796087665483356
2025-03-09 08:59:18,637 [INFO]: 	reconstruction error %: 0.0
2025-03-09 08:59:18,637 [INFO]: 	nb vectors: 2751
2025-03-09 08:59:18,637 [INFO]: 	vectors dimension: 49152
2025-03-09 08:59:18,637 [INFO]: 	compression ratio: 0.9993099908142765
2025-03-09 08:59:18,637 [INFO]: }
2025-03-09 08:59:18,637 [INFO]: 	>>> Finished "Creating the index" in 48.8390 secs
2025-03-09 08:59:18,637 [INFO]: >>> Finished "Launching the whole pipeline" in 48.8687 secs
2025-03-09 08:59:19: [retrieval_preprocessing] calculating distances ...
2025-03-09 08:59:20: [retrieval_preprocessing] finished and saved retrieval indices for episode 11324 [episode count 11/20]
[retrieval_preprocessing] for episode 55869 [episode count 12/20], we have num_retrieval=np.int64(2725) num_query=np.int64(140)
2025-03-09 08:59:21,087 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-09 08:59:21,492 [INFO]: Launching the whole pipeline 03/09/2025, 08:59:21
2025-03-09 08:59:21,492 [INFO]: Reading total number of vectors and dimension 03/09/2025, 08:59:21
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 2201.73it/s]
2025-03-09 08:59:21,516 [INFO]: There are 2725 embeddings of dim 49152
2025-03-09 08:59:21,516 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0237 secs
2025-03-09 08:59:21,516 [INFO]: 	Compute estimated construction time of the index 03/09/2025, 08:59:21
2025-03-09 08:59:21,516 [INFO]: 		-> Train: 16.7 minutes
2025-03-09 08:59:21,516 [INFO]: 		-> Add: 1.5 seconds
2025-03-09 08:59:21,516 [INFO]: 		Total: 16.7 minutes
2025-03-09 08:59:21,516 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0002 secs
2025-03-09 08:59:21,516 [INFO]: 	Checking that your have enough memory available to create the index 03/09/2025, 08:59:21
2025-03-09 08:59:21,517 [INFO]: 562.4MB of memory will be needed to build the index (more might be used if you have more)
2025-03-09 08:59:21,517 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0001 secs
2025-03-09 08:59:21,517 [INFO]: 	Selecting most promising index types given data characteristics 03/09/2025, 08:59:21
2025-03-09 08:59:21,517 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-09 08:59:21,517 [INFO]: 	Creating the index 03/09/2025, 08:59:21
2025-03-09 08:59:21,517 [INFO]: 		-> Instanciate the index HNSW15 03/09/2025, 08:59:21
2025-03-09 08:59:21,518 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0011 secs
2025-03-09 08:59:21,518 [INFO]: 		-> Adding the vectors to the index 03/09/2025, 08:59:21
2025-03-09 08:59:21,518 [INFO]: The memory available for adding the vectors is 49.5GB(total available - used by the index)
2025-03-09 08:59:21,518 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/11 [00:00<?, ?it/s]  9%|▉         | 1/11 [00:00<00:01,  6.27it/s] 27%|██▋       | 3/11 [00:00<00:00, 10.57it/s] 55%|█████▍    | 6/11 [00:00<00:00, 14.15it/s] 73%|███████▎  | 8/11 [00:00<00:00, 13.66it/s] 91%|█████████ | 10/11 [00:00<00:00, 13.35it/s]100%|██████████| 11/11 [00:02<00:00,  4.41it/s]
2025-03-09 08:59:24,022 [INFO]: 	Computing best hyperparameters for index knn.index 03/09/2025, 08:59:24
2025-03-09 08:59:48,892 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 24.8703 secs
2025-03-09 08:59:48,893 [INFO]: The best hyperparameters are: efSearch=363
2025-03-09 08:59:48,893 [INFO]: 	Compute fast metrics 03/09/2025, 08:59:48
  0%|          | 0/4 [00:00<?, ?it/s] 25%|██▌       | 1/4 [00:00<00:00,  5.81it/s] 50%|█████     | 2/4 [00:00<00:00,  7.08it/s] 75%|███████▌  | 3/4 [00:00<00:00,  7.71it/s] 75%|███████▌  | 3/4 [00:00<00:00,  5.86it/s]
2025-03-09 09:00:05,799 [INFO]: 	>>> Finished "Compute fast metrics" in 16.9068 secs
2025-03-09 09:00:05,802 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 44.2839 secs
2025-03-09 09:00:05,802 [INFO]: {
2025-03-09 09:00:05,802 [INFO]: 	index_key: HNSW15
2025-03-09 09:00:05,802 [INFO]: 	index_param: efSearch=363
2025-03-09 09:00:05,802 [INFO]: 	index_path: knn.index
2025-03-09 09:00:05,802 [INFO]: 	size in bytes: 536126830
2025-03-09 09:00:05,802 [INFO]: 	avg_search_speed_ms: 10.521235948988677
2025-03-09 09:00:05,802 [INFO]: 	99p_search_speed_ms: 18.997317063622177
2025-03-09 09:00:05,802 [INFO]: 	reconstruction error %: 0.0
2025-03-09 09:00:05,802 [INFO]: 	nb vectors: 2725
2025-03-09 09:00:05,802 [INFO]: 	vectors dimension: 49152
2025-03-09 09:00:05,802 [INFO]: 	compression ratio: 0.9993098088375842
2025-03-09 09:00:05,802 [INFO]: }
2025-03-09 09:00:05,802 [INFO]: 	>>> Finished "Creating the index" in 44.2854 secs
2025-03-09 09:00:05,802 [INFO]: >>> Finished "Launching the whole pipeline" in 44.3098 secs
2025-03-09 09:00:07: [retrieval_preprocessing] calculating distances ...
2025-03-09 09:00:07: [retrieval_preprocessing] finished and saved retrieval indices for episode 55869 [episode count 12/20]
[retrieval_preprocessing] for episode 37456 [episode count 13/20], we have num_retrieval=np.int64(2724) num_query=np.int64(141)
2025-03-09 09:00:08,401 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-09 09:00:08,810 [INFO]: Launching the whole pipeline 03/09/2025, 09:00:08
2025-03-09 09:00:08,810 [INFO]: Reading total number of vectors and dimension 03/09/2025, 09:00:08
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1479.99it/s]
2025-03-09 09:00:08,836 [INFO]: There are 2724 embeddings of dim 49152
2025-03-09 09:00:08,836 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0264 secs
2025-03-09 09:00:08,836 [INFO]: 	Compute estimated construction time of the index 03/09/2025, 09:00:08
2025-03-09 09:00:08,837 [INFO]: 		-> Train: 16.7 minutes
2025-03-09 09:00:08,837 [INFO]: 		-> Add: 1.5 seconds
2025-03-09 09:00:08,837 [INFO]: 		Total: 16.7 minutes
2025-03-09 09:00:08,837 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0001 secs
2025-03-09 09:00:08,837 [INFO]: 	Checking that your have enough memory available to create the index 03/09/2025, 09:00:08
2025-03-09 09:00:08,837 [INFO]: 562.2MB of memory will be needed to build the index (more might be used if you have more)
2025-03-09 09:00:08,837 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0002 secs
2025-03-09 09:00:08,837 [INFO]: 	Selecting most promising index types given data characteristics 03/09/2025, 09:00:08
2025-03-09 09:00:08,837 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-09 09:00:08,837 [INFO]: 	Creating the index 03/09/2025, 09:00:08
2025-03-09 09:00:08,837 [INFO]: 		-> Instanciate the index HNSW15 03/09/2025, 09:00:08
2025-03-09 09:00:08,838 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0012 secs
2025-03-09 09:00:08,838 [INFO]: 		-> Adding the vectors to the index 03/09/2025, 09:00:08
2025-03-09 09:00:08,838 [INFO]: The memory available for adding the vectors is 49.5GB(total available - used by the index)
2025-03-09 09:00:08,839 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/11 [00:00<?, ?it/s]  9%|▉         | 1/11 [00:00<00:01,  5.49it/s] 18%|█▊        | 2/11 [00:00<00:01,  7.37it/s] 27%|██▋       | 3/11 [00:00<00:00,  8.21it/s] 36%|███▋      | 4/11 [00:00<00:00,  8.70it/s] 45%|████▌     | 5/11 [00:00<00:00,  9.00it/s] 55%|█████▍    | 6/11 [00:00<00:00,  9.19it/s] 64%|██████▎   | 7/11 [00:00<00:00,  9.29it/s] 73%|███████▎  | 8/11 [00:00<00:00,  9.33it/s] 82%|████████▏ | 9/11 [00:01<00:00,  9.42it/s] 91%|█████████ | 10/11 [00:01<00:00,  9.46it/s]100%|██████████| 11/11 [00:02<00:00,  1.67it/s]100%|██████████| 11/11 [00:02<00:00,  3.87it/s]
2025-03-09 09:00:11,689 [INFO]: 	Computing best hyperparameters for index knn.index 03/09/2025, 09:00:11
2025-03-09 09:00:45,621 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 33.9321 secs
2025-03-09 09:00:45,621 [INFO]: The best hyperparameters are: efSearch=298
2025-03-09 09:00:45,622 [INFO]: 	Compute fast metrics 03/09/2025, 09:00:45
  0%|          | 0/4 [00:00<?, ?it/s] 25%|██▌       | 1/4 [00:00<00:00,  5.23it/s] 50%|█████     | 2/4 [00:00<00:00,  6.94it/s] 75%|███████▌  | 3/4 [00:00<00:00,  7.75it/s] 75%|███████▌  | 3/4 [00:00<00:00,  5.96it/s]
2025-03-09 09:01:00,309 [INFO]: 	>>> Finished "Compute fast metrics" in 14.6872 secs
2025-03-09 09:01:00,311 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 51.4727 secs
2025-03-09 09:01:00,311 [INFO]: {
2025-03-09 09:01:00,311 [INFO]: 	index_key: HNSW15
2025-03-09 09:01:00,311 [INFO]: 	index_param: efSearch=298
2025-03-09 09:01:00,311 [INFO]: 	index_path: knn.index
2025-03-09 09:01:00,311 [INFO]: 	size in bytes: 535930090
2025-03-09 09:01:00,311 [INFO]: 	avg_search_speed_ms: 9.311888211066844
2025-03-09 09:01:00,311 [INFO]: 	99p_search_speed_ms: 15.76583792222663
2025-03-09 09:01:00,311 [INFO]: 	reconstruction error %: 0.0
2025-03-09 09:01:00,311 [INFO]: 	nb vectors: 2724
2025-03-09 09:01:00,311 [INFO]: 	vectors dimension: 49152
2025-03-09 09:01:00,311 [INFO]: 	compression ratio: 0.9993098017691077
2025-03-09 09:01:00,311 [INFO]: }
2025-03-09 09:01:00,311 [INFO]: 	>>> Finished "Creating the index" in 51.4744 secs
2025-03-09 09:01:00,311 [INFO]: >>> Finished "Launching the whole pipeline" in 51.5015 secs
2025-03-09 09:01:01: [retrieval_preprocessing] calculating distances ...
2025-03-09 09:01:01: [retrieval_preprocessing] finished and saved retrieval indices for episode 37456 [episode count 13/20]
[retrieval_preprocessing] for episode 40030 [episode count 14/20], we have num_retrieval=np.int64(2660) num_query=np.int64(205)
2025-03-09 09:01:02,529 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-09 09:01:02,884 [INFO]: Launching the whole pipeline 03/09/2025, 09:01:02
2025-03-09 09:01:02,884 [INFO]: Reading total number of vectors and dimension 03/09/2025, 09:01:02
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1447.31it/s]
2025-03-09 09:01:02,910 [INFO]: There are 2660 embeddings of dim 49152
2025-03-09 09:01:02,910 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0260 secs
2025-03-09 09:01:02,910 [INFO]: 	Compute estimated construction time of the index 03/09/2025, 09:01:02
2025-03-09 09:01:02,910 [INFO]: 		-> Train: 16.7 minutes
2025-03-09 09:01:02,910 [INFO]: 		-> Add: 1.5 seconds
2025-03-09 09:01:02,910 [INFO]: 		Total: 16.7 minutes
2025-03-09 09:01:02,910 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0001 secs
2025-03-09 09:01:02,910 [INFO]: 	Checking that your have enough memory available to create the index 03/09/2025, 09:01:02
2025-03-09 09:01:02,911 [INFO]: 549.0MB of memory will be needed to build the index (more might be used if you have more)
2025-03-09 09:01:02,911 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0001 secs
2025-03-09 09:01:02,911 [INFO]: 	Selecting most promising index types given data characteristics 03/09/2025, 09:01:02
2025-03-09 09:01:02,911 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-09 09:01:02,911 [INFO]: 	Creating the index 03/09/2025, 09:01:02
2025-03-09 09:01:02,911 [INFO]: 		-> Instanciate the index HNSW15 03/09/2025, 09:01:02
2025-03-09 09:01:02,912 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0009 secs
2025-03-09 09:01:02,912 [INFO]: 		-> Adding the vectors to the index 03/09/2025, 09:01:02
2025-03-09 09:01:02,912 [INFO]: The memory available for adding the vectors is 49.5GB(total available - used by the index)
2025-03-09 09:01:02,912 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/11 [00:00<?, ?it/s]  9%|▉         | 1/11 [00:00<00:01,  6.52it/s] 27%|██▋       | 3/11 [00:00<00:00, 10.00it/s] 45%|████▌     | 5/11 [00:00<00:00, 11.22it/s] 64%|██████▎   | 7/11 [00:00<00:00, 11.81it/s] 82%|████████▏ | 9/11 [00:00<00:00, 12.09it/s]100%|██████████| 11/11 [00:02<00:00,  2.87it/s]100%|██████████| 11/11 [00:02<00:00,  4.45it/s]
2025-03-09 09:01:05,388 [INFO]: 	Computing best hyperparameters for index knn.index 03/09/2025, 09:01:05
2025-03-09 09:01:36,116 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 30.7276 secs
2025-03-09 09:01:36,116 [INFO]: The best hyperparameters are: efSearch=309
2025-03-09 09:01:36,116 [INFO]: 	Compute fast metrics 03/09/2025, 09:01:36
  0%|          | 0/4 [00:00<?, ?it/s] 25%|██▌       | 1/4 [00:00<00:00,  7.08it/s] 75%|███████▌  | 3/4 [00:00<00:00,  9.73it/s] 75%|███████▌  | 3/4 [00:00<00:00,  7.59it/s]
2025-03-09 09:01:51,384 [INFO]: 	>>> Finished "Compute fast metrics" in 15.2682 secs
2025-03-09 09:01:51,386 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 48.4742 secs
2025-03-09 09:01:51,387 [INFO]: {
2025-03-09 09:01:51,387 [INFO]: 	index_key: HNSW15
2025-03-09 09:01:51,387 [INFO]: 	index_param: efSearch=309
2025-03-09 09:01:51,387 [INFO]: 	index_path: knn.index
2025-03-09 09:01:51,387 [INFO]: 	size in bytes: 523338610
2025-03-09 09:01:51,387 [INFO]: 	avg_search_speed_ms: 9.763674062696737
2025-03-09 09:01:51,387 [INFO]: 	99p_search_speed_ms: 17.47385751456022
2025-03-09 09:01:51,387 [INFO]: 	reconstruction error %: 0.0
2025-03-09 09:01:51,387 [INFO]: 	nb vectors: 2660
2025-03-09 09:01:51,387 [INFO]: 	vectors dimension: 49152
2025-03-09 09:01:51,387 [INFO]: 	compression ratio: 0.999309567471049
2025-03-09 09:01:51,387 [INFO]: }
2025-03-09 09:01:51,387 [INFO]: 	>>> Finished "Creating the index" in 48.4761 secs
2025-03-09 09:01:51,387 [INFO]: >>> Finished "Launching the whole pipeline" in 48.5026 secs
2025-03-09 09:01:52: [retrieval_preprocessing] calculating distances ...
2025-03-09 09:01:53: [retrieval_preprocessing] finished and saved retrieval indices for episode 40030 [episode count 14/20]
[retrieval_preprocessing] for episode 48734 [episode count 15/20], we have num_retrieval=np.int64(2733) num_query=np.int64(132)
2025-03-09 09:01:53,906 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-09 09:01:54,222 [INFO]: Launching the whole pipeline 03/09/2025, 09:01:54
2025-03-09 09:01:54,222 [INFO]: Reading total number of vectors and dimension 03/09/2025, 09:01:54
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1818.08it/s]
2025-03-09 09:01:54,246 [INFO]: There are 2733 embeddings of dim 49152
2025-03-09 09:01:54,246 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0240 secs
2025-03-09 09:01:54,246 [INFO]: 	Compute estimated construction time of the index 03/09/2025, 09:01:54
2025-03-09 09:01:54,246 [INFO]: 		-> Train: 16.7 minutes
2025-03-09 09:01:54,246 [INFO]: 		-> Add: 1.5 seconds
2025-03-09 09:01:54,246 [INFO]: 		Total: 16.7 minutes
2025-03-09 09:01:54,247 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0001 secs
2025-03-09 09:01:54,247 [INFO]: 	Checking that your have enough memory available to create the index 03/09/2025, 09:01:54
2025-03-09 09:01:54,247 [INFO]: 564.0MB of memory will be needed to build the index (more might be used if you have more)
2025-03-09 09:01:54,247 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0001 secs
2025-03-09 09:01:54,247 [INFO]: 	Selecting most promising index types given data characteristics 03/09/2025, 09:01:54
2025-03-09 09:01:54,247 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-09 09:01:54,247 [INFO]: 	Creating the index 03/09/2025, 09:01:54
2025-03-09 09:01:54,247 [INFO]: 		-> Instanciate the index HNSW15 03/09/2025, 09:01:54
2025-03-09 09:01:54,248 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0009 secs
2025-03-09 09:01:54,248 [INFO]: 		-> Adding the vectors to the index 03/09/2025, 09:01:54
2025-03-09 09:01:54,248 [INFO]: The memory available for adding the vectors is 49.5GB(total available - used by the index)
2025-03-09 09:01:54,248 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/11 [00:00<?, ?it/s]  9%|▉         | 1/11 [00:00<00:01,  7.02it/s] 27%|██▋       | 3/11 [00:00<00:00, 10.98it/s] 45%|████▌     | 5/11 [00:00<00:00, 12.13it/s] 64%|██████▎   | 7/11 [00:00<00:00, 12.77it/s] 82%|████████▏ | 9/11 [00:00<00:00, 12.95it/s]100%|██████████| 11/11 [00:02<00:00,  2.61it/s]100%|██████████| 11/11 [00:02<00:00,  4.16it/s]
2025-03-09 09:01:56,897 [INFO]: 	Computing best hyperparameters for index knn.index 03/09/2025, 09:01:56
2025-03-09 09:02:39,858 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 42.9608 secs
2025-03-09 09:02:39,859 [INFO]: The best hyperparameters are: efSearch=200
2025-03-09 09:02:39,859 [INFO]: 	Compute fast metrics 03/09/2025, 09:02:39
  0%|          | 0/4 [00:00<?, ?it/s] 25%|██▌       | 1/4 [00:00<00:00,  5.92it/s] 75%|███████▌  | 3/4 [00:00<00:00, 10.65it/s] 75%|███████▌  | 3/4 [00:00<00:00,  8.30it/s]
2025-03-09 09:02:54,333 [INFO]: 	>>> Finished "Compute fast metrics" in 14.4739 secs
2025-03-09 09:02:54,335 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 60.0872 secs
2025-03-09 09:02:54,335 [INFO]: {
2025-03-09 09:02:54,335 [INFO]: 	index_key: HNSW15
2025-03-09 09:02:54,336 [INFO]: 	index_param: efSearch=200
2025-03-09 09:02:54,336 [INFO]: 	index_path: knn.index
2025-03-09 09:02:54,336 [INFO]: 	size in bytes: 537700750
2025-03-09 09:02:54,336 [INFO]: 	avg_search_speed_ms: 7.295201291044644
2025-03-09 09:02:54,336 [INFO]: 	99p_search_speed_ms: 14.218226659577338
2025-03-09 09:02:54,336 [INFO]: 	reconstruction error %: 0.0
2025-03-09 09:02:54,336 [INFO]: 	nb vectors: 2733
2025-03-09 09:02:54,336 [INFO]: 	vectors dimension: 49152
2025-03-09 09:02:54,336 [INFO]: 	compression ratio: 0.9993098651991837
2025-03-09 09:02:54,336 [INFO]: }
2025-03-09 09:02:54,336 [INFO]: 	>>> Finished "Creating the index" in 60.0888 secs
2025-03-09 09:02:54,336 [INFO]: >>> Finished "Launching the whole pipeline" in 60.1134 secs
2025-03-09 09:02:54: [retrieval_preprocessing] calculating distances ...
2025-03-09 09:02:55: [retrieval_preprocessing] finished and saved retrieval indices for episode 48734 [episode count 15/20]
[retrieval_preprocessing] for episode 43111 [episode count 16/20], we have num_retrieval=np.int64(2727) num_query=np.int64(138)
2025-03-09 09:02:55,974 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-09 09:02:56,353 [INFO]: Launching the whole pipeline 03/09/2025, 09:02:56
2025-03-09 09:02:56,354 [INFO]: Reading total number of vectors and dimension 03/09/2025, 09:02:56
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1202.15it/s]
2025-03-09 09:02:56,379 [INFO]: There are 2727 embeddings of dim 49152
2025-03-09 09:02:56,379 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0258 secs
2025-03-09 09:02:56,379 [INFO]: 	Compute estimated construction time of the index 03/09/2025, 09:02:56
2025-03-09 09:02:56,380 [INFO]: 		-> Train: 16.7 minutes
2025-03-09 09:02:56,380 [INFO]: 		-> Add: 1.5 seconds
2025-03-09 09:02:56,380 [INFO]: 		Total: 16.7 minutes
2025-03-09 09:02:56,380 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0001 secs
2025-03-09 09:02:56,380 [INFO]: 	Checking that your have enough memory available to create the index 03/09/2025, 09:02:56
2025-03-09 09:02:56,380 [INFO]: 562.8MB of memory will be needed to build the index (more might be used if you have more)
2025-03-09 09:02:56,380 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0001 secs
2025-03-09 09:02:56,380 [INFO]: 	Selecting most promising index types given data characteristics 03/09/2025, 09:02:56
2025-03-09 09:02:56,380 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-09 09:02:56,380 [INFO]: 	Creating the index 03/09/2025, 09:02:56
2025-03-09 09:02:56,380 [INFO]: 		-> Instanciate the index HNSW15 03/09/2025, 09:02:56
2025-03-09 09:02:56,381 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0009 secs
2025-03-09 09:02:56,381 [INFO]: 		-> Adding the vectors to the index 03/09/2025, 09:02:56
2025-03-09 09:02:56,381 [INFO]: The memory available for adding the vectors is 49.5GB(total available - used by the index)
2025-03-09 09:02:56,381 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/11 [00:00<?, ?it/s]  9%|▉         | 1/11 [00:00<00:01,  7.07it/s] 27%|██▋       | 3/11 [00:00<00:00, 11.48it/s] 45%|████▌     | 5/11 [00:00<00:00, 14.35it/s] 64%|██████▎   | 7/11 [00:00<00:00, 14.16it/s] 82%|████████▏ | 9/11 [00:00<00:00, 13.96it/s]100%|██████████| 11/11 [00:02<00:00,  3.05it/s]100%|██████████| 11/11 [00:02<00:00,  4.82it/s]
2025-03-09 09:02:58,673 [INFO]: 	Computing best hyperparameters for index knn.index 03/09/2025, 09:02:58
2025-03-09 09:03:25,202 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 26.5282 secs
2025-03-09 09:03:25,202 [INFO]: The best hyperparameters are: efSearch=354
2025-03-09 09:03:25,202 [INFO]: 	Compute fast metrics 03/09/2025, 09:03:25
  0%|          | 0/4 [00:00<?, ?it/s] 25%|██▌       | 1/4 [00:00<00:00,  5.38it/s] 50%|█████     | 2/4 [00:00<00:00,  6.98it/s] 75%|███████▌  | 3/4 [00:00<00:00,  7.70it/s] 75%|███████▌  | 3/4 [00:00<00:00,  5.79it/s]
2025-03-09 09:03:40,203 [INFO]: 	>>> Finished "Compute fast metrics" in 15.0007 secs
2025-03-09 09:03:40,205 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 43.8235 secs
2025-03-09 09:03:40,205 [INFO]: {
2025-03-09 09:03:40,205 [INFO]: 	index_key: HNSW15
2025-03-09 09:03:40,205 [INFO]: 	index_param: efSearch=354
2025-03-09 09:03:40,205 [INFO]: 	index_path: knn.index
2025-03-09 09:03:40,205 [INFO]: 	size in bytes: 536520310
2025-03-09 09:03:40,205 [INFO]: 	avg_search_speed_ms: 10.753674373301047
2025-03-09 09:03:40,205 [INFO]: 	99p_search_speed_ms: 19.210381188895557
2025-03-09 09:03:40,205 [INFO]: 	reconstruction error %: 0.0
2025-03-09 09:03:40,205 [INFO]: 	nb vectors: 2727
2025-03-09 09:03:40,205 [INFO]: 	vectors dimension: 49152
2025-03-09 09:03:40,205 [INFO]: 	compression ratio: 0.9993098229589855
2025-03-09 09:03:40,205 [INFO]: }
2025-03-09 09:03:40,205 [INFO]: 	>>> Finished "Creating the index" in 43.8249 secs
2025-03-09 09:03:40,205 [INFO]: >>> Finished "Launching the whole pipeline" in 43.8513 secs
2025-03-09 09:03:41: [retrieval_preprocessing] calculating distances ...
2025-03-09 09:03:42: [retrieval_preprocessing] finished and saved retrieval indices for episode 43111 [episode count 16/20]
[retrieval_preprocessing] for episode 74859 [episode count 17/20], we have num_retrieval=np.int64(2703) num_query=np.int64(162)
2025-03-09 09:03:43,015 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-09 09:03:43,396 [INFO]: Launching the whole pipeline 03/09/2025, 09:03:43
2025-03-09 09:03:43,396 [INFO]: Reading total number of vectors and dimension 03/09/2025, 09:03:43
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1407.96it/s]
2025-03-09 09:03:43,422 [INFO]: There are 2703 embeddings of dim 49152
2025-03-09 09:03:43,422 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0262 secs
2025-03-09 09:03:43,422 [INFO]: 	Compute estimated construction time of the index 03/09/2025, 09:03:43
2025-03-09 09:03:43,423 [INFO]: 		-> Train: 16.7 minutes
2025-03-09 09:03:43,423 [INFO]: 		-> Add: 1.5 seconds
2025-03-09 09:03:43,423 [INFO]: 		Total: 16.7 minutes
2025-03-09 09:03:43,423 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0001 secs
2025-03-09 09:03:43,423 [INFO]: 	Checking that your have enough memory available to create the index 03/09/2025, 09:03:43
2025-03-09 09:03:43,423 [INFO]: 557.8MB of memory will be needed to build the index (more might be used if you have more)
2025-03-09 09:03:43,423 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0002 secs
2025-03-09 09:03:43,423 [INFO]: 	Selecting most promising index types given data characteristics 03/09/2025, 09:03:43
2025-03-09 09:03:43,423 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-09 09:03:43,423 [INFO]: 	Creating the index 03/09/2025, 09:03:43
2025-03-09 09:03:43,423 [INFO]: 		-> Instanciate the index HNSW15 03/09/2025, 09:03:43
2025-03-09 09:03:43,424 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0009 secs
2025-03-09 09:03:43,424 [INFO]: 		-> Adding the vectors to the index 03/09/2025, 09:03:43
2025-03-09 09:03:43,424 [INFO]: The memory available for adding the vectors is 49.5GB(total available - used by the index)
2025-03-09 09:03:43,424 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/11 [00:00<?, ?it/s]  9%|▉         | 1/11 [00:00<00:02,  4.87it/s] 18%|█▊        | 2/11 [00:00<00:01,  6.40it/s] 36%|███▋      | 4/11 [00:00<00:00,  9.07it/s] 55%|█████▍    | 6/11 [00:00<00:00, 10.21it/s] 73%|███████▎  | 8/11 [00:00<00:00, 10.73it/s] 91%|█████████ | 10/11 [00:01<00:00, 10.06it/s]100%|██████████| 11/11 [00:02<00:00,  3.92it/s]
2025-03-09 09:03:46,235 [INFO]: 	Computing best hyperparameters for index knn.index 03/09/2025, 09:03:46
2025-03-09 09:04:22,136 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 35.9013 secs
2025-03-09 09:04:22,137 [INFO]: The best hyperparameters are: efSearch=300
2025-03-09 09:04:22,137 [INFO]: 	Compute fast metrics 03/09/2025, 09:04:22
  0%|          | 0/4 [00:00<?, ?it/s] 25%|██▌       | 1/4 [00:00<00:00,  8.69it/s] 75%|███████▌  | 3/4 [00:00<00:00, 11.56it/s] 75%|███████▌  | 3/4 [00:00<00:00,  9.16it/s]
2025-03-09 09:04:35,538 [INFO]: 	>>> Finished "Compute fast metrics" in 13.4015 secs
2025-03-09 09:04:35,541 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 52.1169 secs
2025-03-09 09:04:35,541 [INFO]: {
2025-03-09 09:04:35,541 [INFO]: 	index_key: HNSW15
2025-03-09 09:04:35,541 [INFO]: 	index_param: efSearch=300
2025-03-09 09:04:35,541 [INFO]: 	index_path: knn.index
2025-03-09 09:04:35,541 [INFO]: 	size in bytes: 531798550
2025-03-09 09:04:35,541 [INFO]: 	avg_search_speed_ms: 8.778767459931816
2025-03-09 09:04:35,541 [INFO]: 	99p_search_speed_ms: 14.435576703399398
2025-03-09 09:04:35,541 [INFO]: 	reconstruction error %: 0.0
2025-03-09 09:04:35,541 [INFO]: 	nb vectors: 2703
2025-03-09 09:04:35,541 [INFO]: 	vectors dimension: 49152
2025-03-09 09:04:35,541 [INFO]: 	compression ratio: 0.9993096521229703
2025-03-09 09:04:35,541 [INFO]: }
2025-03-09 09:04:35,541 [INFO]: 	>>> Finished "Creating the index" in 52.1184 secs
2025-03-09 09:04:35,541 [INFO]: >>> Finished "Launching the whole pipeline" in 52.1453 secs
2025-03-09 09:04:37: [retrieval_preprocessing] calculating distances ...
2025-03-09 09:04:37: [retrieval_preprocessing] finished and saved retrieval indices for episode 74859 [episode count 17/20]
[retrieval_preprocessing] for episode 86638 [episode count 18/20], we have num_retrieval=np.int64(2744) num_query=np.int64(121)
2025-03-09 09:04:38,689 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-09 09:04:39,098 [INFO]: Launching the whole pipeline 03/09/2025, 09:04:39
2025-03-09 09:04:39,098 [INFO]: Reading total number of vectors and dimension 03/09/2025, 09:04:39
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1757.14it/s]
2025-03-09 09:04:39,123 [INFO]: There are 2744 embeddings of dim 49152
2025-03-09 09:04:39,123 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0246 secs
2025-03-09 09:04:39,123 [INFO]: 	Compute estimated construction time of the index 03/09/2025, 09:04:39
2025-03-09 09:04:39,123 [INFO]: 		-> Train: 16.7 minutes
2025-03-09 09:04:39,123 [INFO]: 		-> Add: 1.5 seconds
2025-03-09 09:04:39,123 [INFO]: 		Total: 16.7 minutes
2025-03-09 09:04:39,123 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0001 secs
2025-03-09 09:04:39,123 [INFO]: 	Checking that your have enough memory available to create the index 03/09/2025, 09:04:39
2025-03-09 09:04:39,123 [INFO]: 566.3MB of memory will be needed to build the index (more might be used if you have more)
2025-03-09 09:04:39,123 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0002 secs
2025-03-09 09:04:39,123 [INFO]: 	Selecting most promising index types given data characteristics 03/09/2025, 09:04:39
2025-03-09 09:04:39,123 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-09 09:04:39,123 [INFO]: 	Creating the index 03/09/2025, 09:04:39
2025-03-09 09:04:39,124 [INFO]: 		-> Instanciate the index HNSW15 03/09/2025, 09:04:39
2025-03-09 09:04:39,125 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0010 secs
2025-03-09 09:04:39,125 [INFO]: 		-> Adding the vectors to the index 03/09/2025, 09:04:39
2025-03-09 09:04:39,125 [INFO]: The memory available for adding the vectors is 49.5GB(total available - used by the index)
2025-03-09 09:04:39,125 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/11 [00:00<?, ?it/s]  9%|▉         | 1/11 [00:00<00:01,  5.92it/s] 27%|██▋       | 3/11 [00:00<00:00, 10.38it/s] 45%|████▌     | 5/11 [00:00<00:00, 11.06it/s] 64%|██████▎   | 7/11 [00:00<00:00, 11.55it/s] 82%|████████▏ | 9/11 [00:00<00:00, 11.93it/s]100%|██████████| 11/11 [00:02<00:00,  2.67it/s]100%|██████████| 11/11 [00:02<00:00,  4.18it/s]
2025-03-09 09:04:41,761 [INFO]: 	Computing best hyperparameters for index knn.index 03/09/2025, 09:04:41
2025-03-09 09:05:17,328 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 35.5660 secs
2025-03-09 09:05:17,328 [INFO]: The best hyperparameters are: efSearch=279
2025-03-09 09:05:17,328 [INFO]: 	Compute fast metrics 03/09/2025, 09:05:17
  0%|          | 0/4 [00:00<?, ?it/s] 25%|██▌       | 1/4 [00:00<00:00,  6.05it/s] 50%|█████     | 2/4 [00:00<00:00,  7.81it/s] 75%|███████▌  | 3/4 [00:00<00:00,  8.63it/s] 75%|███████▌  | 3/4 [00:00<00:00,  6.55it/s]
2025-03-09 09:05:33,630 [INFO]: 	>>> Finished "Compute fast metrics" in 16.3023 secs
2025-03-09 09:05:33,632 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 54.5072 secs
2025-03-09 09:05:33,632 [INFO]: {
2025-03-09 09:05:33,632 [INFO]: 	index_key: HNSW15
2025-03-09 09:05:33,632 [INFO]: 	index_param: efSearch=279
2025-03-09 09:05:33,632 [INFO]: 	index_path: knn.index
2025-03-09 09:05:33,632 [INFO]: 	size in bytes: 539864890
2025-03-09 09:05:33,632 [INFO]: 	avg_search_speed_ms: 8.302815728418627
2025-03-09 09:05:33,632 [INFO]: 	99p_search_speed_ms: 13.130724453367296
2025-03-09 09:05:33,632 [INFO]: 	reconstruction error %: 0.0
2025-03-09 09:05:33,632 [INFO]: 	nb vectors: 2744
2025-03-09 09:05:33,632 [INFO]: 	vectors dimension: 49152
2025-03-09 09:05:33,632 [INFO]: 	compression ratio: 0.9993099421597874
2025-03-09 09:05:33,632 [INFO]: }
2025-03-09 09:05:33,632 [INFO]: 	>>> Finished "Creating the index" in 54.5087 secs
2025-03-09 09:05:33,632 [INFO]: >>> Finished "Launching the whole pipeline" in 54.5339 secs
2025-03-09 09:05:34: [retrieval_preprocessing] calculating distances ...
2025-03-09 09:05:34: [retrieval_preprocessing] finished and saved retrieval indices for episode 86638 [episode count 18/20]
[retrieval_preprocessing] for episode 64634 [episode count 19/20], we have num_retrieval=np.int64(2734) num_query=np.int64(131)
2025-03-09 09:05:35,320 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-09 09:05:35,664 [INFO]: Launching the whole pipeline 03/09/2025, 09:05:35
2025-03-09 09:05:35,664 [INFO]: Reading total number of vectors and dimension 03/09/2025, 09:05:35
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 2465.79it/s]
2025-03-09 09:05:35,692 [INFO]: There are 2734 embeddings of dim 49152
2025-03-09 09:05:35,693 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0284 secs
2025-03-09 09:05:35,693 [INFO]: 	Compute estimated construction time of the index 03/09/2025, 09:05:35
2025-03-09 09:05:35,693 [INFO]: 		-> Train: 16.7 minutes
2025-03-09 09:05:35,693 [INFO]: 		-> Add: 1.5 seconds
2025-03-09 09:05:35,693 [INFO]: 		Total: 16.7 minutes
2025-03-09 09:05:35,693 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0004 secs
2025-03-09 09:05:35,693 [INFO]: 	Checking that your have enough memory available to create the index 03/09/2025, 09:05:35
2025-03-09 09:05:35,694 [INFO]: 564.2MB of memory will be needed to build the index (more might be used if you have more)
2025-03-09 09:05:35,694 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0004 secs
2025-03-09 09:05:35,694 [INFO]: 	Selecting most promising index types given data characteristics 03/09/2025, 09:05:35
2025-03-09 09:05:35,694 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-09 09:05:35,694 [INFO]: 	Creating the index 03/09/2025, 09:05:35
2025-03-09 09:05:35,694 [INFO]: 		-> Instanciate the index HNSW15 03/09/2025, 09:05:35
2025-03-09 09:05:35,697 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0025 secs
2025-03-09 09:05:35,697 [INFO]: 		-> Adding the vectors to the index 03/09/2025, 09:05:35
2025-03-09 09:05:35,697 [INFO]: The memory available for adding the vectors is 49.5GB(total available - used by the index)
2025-03-09 09:05:35,697 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/11 [00:00<?, ?it/s]  9%|▉         | 1/11 [00:00<00:01,  6.43it/s] 27%|██▋       | 3/11 [00:00<00:00, 10.97it/s] 45%|████▌     | 5/11 [00:00<00:00, 12.18it/s] 64%|██████▎   | 7/11 [00:00<00:00, 14.45it/s] 82%|████████▏ | 9/11 [00:00<00:00, 16.10it/s]100%|██████████| 11/11 [00:02<00:00,  2.79it/s]100%|██████████| 11/11 [00:02<00:00,  4.46it/s]
2025-03-09 09:05:38,170 [INFO]: 	Computing best hyperparameters for index knn.index 03/09/2025, 09:05:38
2025-03-09 09:06:11,654 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 33.4822 secs
2025-03-09 09:06:11,654 [INFO]: The best hyperparameters are: efSearch=318
2025-03-09 09:06:11,654 [INFO]: 	Compute fast metrics 03/09/2025, 09:06:11
  0%|          | 0/4 [00:00<?, ?it/s] 25%|██▌       | 1/4 [00:00<00:00,  5.60it/s] 50%|█████     | 2/4 [00:00<00:00,  7.23it/s] 75%|███████▌  | 3/4 [00:00<00:00,  7.83it/s] 75%|███████▌  | 3/4 [00:00<00:00,  6.02it/s]
2025-03-09 09:06:29,569 [INFO]: 	>>> Finished "Compute fast metrics" in 17.9146 secs
2025-03-09 09:06:29,571 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 53.8737 secs
2025-03-09 09:06:29,571 [INFO]: {
2025-03-09 09:06:29,571 [INFO]: 	index_key: HNSW15
2025-03-09 09:06:29,571 [INFO]: 	index_param: efSearch=318
2025-03-09 09:06:29,571 [INFO]: 	index_path: knn.index
2025-03-09 09:06:29,571 [INFO]: 	size in bytes: 537897490
2025-03-09 09:06:29,571 [INFO]: 	avg_search_speed_ms: 9.86059834166656
2025-03-09 09:06:29,571 [INFO]: 	99p_search_speed_ms: 16.969133384991437
2025-03-09 09:06:29,571 [INFO]: 	reconstruction error %: 0.0
2025-03-09 09:06:29,571 [INFO]: 	nb vectors: 2734
2025-03-09 09:06:29,571 [INFO]: 	vectors dimension: 49152
2025-03-09 09:06:29,571 [INFO]: 	compression ratio: 0.9993098722211922
2025-03-09 09:06:29,571 [INFO]: }
2025-03-09 09:06:29,571 [INFO]: 	>>> Finished "Creating the index" in 53.8768 secs
2025-03-09 09:06:29,571 [INFO]: >>> Finished "Launching the whole pipeline" in 53.9070 secs
2025-03-09 09:06:30: [retrieval_preprocessing] calculating distances ...
2025-03-09 09:06:30: [retrieval_preprocessing] finished and saved retrieval indices for episode 64634 [episode count 19/20]
2025-03-09 09:06:30: [retrieval_preprocessing] finished for (8911427557, 'cup') [chosen_id count 5/10]
2025-03-09 09:06:34: [retrieval_preprocessing] concatenated all embeddings and indices for 20 episodes for (8702636502, 'lid') [chosen_id count 6/10]
2025-03-09 09:06:34: [retrieval_preprocessing] we have num_total=5361 embedding_dim=49152
[retrieval_preprocessing] for episode 4611 [episode count 0/20], we have num_retrieval=np.int64(4696) num_query=np.int64(665)
2025-03-09 09:06:35,991 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-09 09:06:36,639 [INFO]: Launching the whole pipeline 03/09/2025, 09:06:36
2025-03-09 09:06:36,639 [INFO]: Reading total number of vectors and dimension 03/09/2025, 09:06:36
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1638.40it/s]
2025-03-09 09:06:36,664 [INFO]: There are 4696 embeddings of dim 49152
2025-03-09 09:06:36,664 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0250 secs
2025-03-09 09:06:36,664 [INFO]: 	Compute estimated construction time of the index 03/09/2025, 09:06:36
2025-03-09 09:06:36,665 [INFO]: 		-> Train: 16.7 minutes
2025-03-09 09:06:36,665 [INFO]: 		-> Add: 2.6 seconds
2025-03-09 09:06:36,665 [INFO]: 		Total: 16.7 minutes
2025-03-09 09:06:36,665 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0001 secs
2025-03-09 09:06:36,665 [INFO]: 	Checking that your have enough memory available to create the index 03/09/2025, 09:06:36
2025-03-09 09:06:36,665 [INFO]: 969.1MB of memory will be needed to build the index (more might be used if you have more)
2025-03-09 09:06:36,665 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0002 secs
2025-03-09 09:06:36,665 [INFO]: 	Selecting most promising index types given data characteristics 03/09/2025, 09:06:36
2025-03-09 09:06:36,665 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-09 09:06:36,665 [INFO]: 	Creating the index 03/09/2025, 09:06:36
2025-03-09 09:06:36,665 [INFO]: 		-> Instanciate the index HNSW15 03/09/2025, 09:06:36
2025-03-09 09:06:36,667 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0016 secs
2025-03-09 09:06:36,667 [INFO]: 		-> Adding the vectors to the index 03/09/2025, 09:06:36
2025-03-09 09:06:36,667 [INFO]: The memory available for adding the vectors is 49.1GB(total available - used by the index)
2025-03-09 09:06:36,667 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/19 [00:00<?, ?it/s]  5%|▌         | 1/19 [00:00<00:04,  3.93it/s] 11%|█         | 2/19 [00:00<00:02,  5.80it/s] 16%|█▌        | 3/19 [00:00<00:02,  6.96it/s] 21%|██        | 4/19 [00:00<00:01,  7.62it/s] 26%|██▋       | 5/19 [00:00<00:01,  8.12it/s] 32%|███▏      | 6/19 [00:00<00:01,  8.49it/s] 37%|███▋      | 7/19 [00:00<00:01,  8.79it/s] 42%|████▏     | 8/19 [00:01<00:01,  8.75it/s] 47%|████▋     | 9/19 [00:01<00:01,  8.63it/s] 53%|█████▎    | 10/19 [00:01<00:01,  8.58it/s] 58%|█████▊    | 11/19 [00:01<00:00,  8.89it/s] 63%|██████▎   | 12/19 [00:01<00:00,  9.11it/s] 68%|██████▊   | 13/19 [00:01<00:00,  9.32it/s] 79%|███████▉  | 15/19 [00:01<00:00,  9.54it/s] 89%|████████▉ | 17/19 [00:01<00:00, 10.80it/s]100%|██████████| 19/19 [00:05<00:00,  1.56it/s]100%|██████████| 19/19 [00:05<00:00,  3.70it/s]
2025-03-09 09:06:41,800 [INFO]: 	Computing best hyperparameters for index knn.index 03/09/2025, 09:06:41
2025-03-09 09:07:22,480 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 40.6806 secs
2025-03-09 09:07:22,481 [INFO]: The best hyperparameters are: efSearch=211
2025-03-09 09:07:22,481 [INFO]: 	Compute fast metrics 03/09/2025, 09:07:22
  0%|          | 0/4 [00:00<?, ?it/s] 25%|██▌       | 1/4 [00:00<00:00,  5.34it/s] 50%|█████     | 2/4 [00:00<00:00,  6.84it/s] 75%|███████▌  | 3/4 [00:00<00:00,  7.66it/s] 75%|███████▌  | 3/4 [00:00<00:00,  5.79it/s]
2025-03-09 09:07:41,073 [INFO]: 	>>> Finished "Compute fast metrics" in 18.5925 secs
2025-03-09 09:07:41,077 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 64.4096 secs
2025-03-09 09:07:41,077 [INFO]: {
2025-03-09 09:07:41,077 [INFO]: 	index_key: HNSW15
2025-03-09 09:07:41,077 [INFO]: 	index_param: efSearch=211
2025-03-09 09:07:41,077 [INFO]: 	index_path: knn.index
2025-03-09 09:07:41,077 [INFO]: 	size in bytes: 923909890
2025-03-09 09:07:41,077 [INFO]: 	avg_search_speed_ms: 9.10828016441356
2025-03-09 09:07:41,077 [INFO]: 	99p_search_speed_ms: 15.316788381896883
2025-03-09 09:07:41,077 [INFO]: 	reconstruction error %: 0.0
2025-03-09 09:07:41,077 [INFO]: 	nb vectors: 4696
2025-03-09 09:07:41,077 [INFO]: 	vectors dimension: 49152
2025-03-09 09:07:41,077 [INFO]: 	compression ratio: 0.9993086750050917
2025-03-09 09:07:41,077 [INFO]: }
2025-03-09 09:07:41,077 [INFO]: 	>>> Finished "Creating the index" in 64.4118 secs
2025-03-09 09:07:41,077 [INFO]: >>> Finished "Launching the whole pipeline" in 64.4376 secs
2025-03-09 09:07:43: [retrieval_preprocessing] calculating distances ...
2025-03-09 09:07:45: [retrieval_preprocessing] finished and saved retrieval indices for episode 4611 [episode count 0/20]
[retrieval_preprocessing] for episode 22536 [episode count 1/20], we have num_retrieval=np.int64(5202) num_query=np.int64(159)
2025-03-09 09:07:47,290 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-09 09:07:48,051 [INFO]: Launching the whole pipeline 03/09/2025, 09:07:48
2025-03-09 09:07:48,051 [INFO]: Reading total number of vectors and dimension 03/09/2025, 09:07:48
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 2031.14it/s]
2025-03-09 09:07:48,074 [INFO]: There are 5202 embeddings of dim 49152
2025-03-09 09:07:48,074 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0229 secs
2025-03-09 09:07:48,074 [INFO]: 	Compute estimated construction time of the index 03/09/2025, 09:07:48
2025-03-09 09:07:48,074 [INFO]: 		-> Train: 16.7 minutes
2025-03-09 09:07:48,074 [INFO]: 		-> Add: 2.9 seconds
2025-03-09 09:07:48,074 [INFO]: 		Total: 16.7 minutes
2025-03-09 09:07:48,074 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0001 secs
2025-03-09 09:07:48,074 [INFO]: 	Checking that your have enough memory available to create the index 03/09/2025, 09:07:48
2025-03-09 09:07:48,075 [INFO]: 1.0GB of memory will be needed to build the index (more might be used if you have more)
2025-03-09 09:07:48,075 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0001 secs
2025-03-09 09:07:48,075 [INFO]: 	Selecting most promising index types given data characteristics 03/09/2025, 09:07:48
2025-03-09 09:07:48,075 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-09 09:07:48,075 [INFO]: 	Creating the index 03/09/2025, 09:07:48
2025-03-09 09:07:48,075 [INFO]: 		-> Instanciate the index HNSW15 03/09/2025, 09:07:48
2025-03-09 09:07:48,076 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0011 secs
2025-03-09 09:07:48,076 [INFO]: 		-> Adding the vectors to the index 03/09/2025, 09:07:48
2025-03-09 09:07:48,076 [INFO]: The memory available for adding the vectors is 49.0GB(total available - used by the index)
2025-03-09 09:07:48,076 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/22 [00:00<?, ?it/s]  5%|▍         | 1/22 [00:00<00:04,  5.11it/s]  9%|▉         | 2/22 [00:00<00:02,  6.80it/s] 14%|█▎        | 3/22 [00:00<00:02,  7.62it/s] 18%|█▊        | 4/22 [00:00<00:02,  8.11it/s] 23%|██▎       | 5/22 [00:00<00:02,  8.32it/s] 27%|██▋       | 6/22 [00:00<00:01,  8.52it/s] 32%|███▏      | 7/22 [00:00<00:01,  8.75it/s] 36%|███▋      | 8/22 [00:00<00:01,  8.83it/s] 41%|████      | 9/22 [00:01<00:01,  8.93it/s] 45%|████▌     | 10/22 [00:01<00:01,  8.95it/s] 50%|█████     | 11/22 [00:01<00:01,  8.97it/s] 55%|█████▍    | 12/22 [00:01<00:01,  9.02it/s] 59%|█████▉    | 13/22 [00:01<00:01,  8.99it/s] 64%|██████▎   | 14/22 [00:01<00:00,  8.93it/s] 68%|██████▊   | 15/22 [00:01<00:00,  8.82it/s] 73%|███████▎  | 16/22 [00:01<00:00,  8.72it/s] 77%|███████▋  | 17/22 [00:01<00:00,  9.02it/s] 86%|████████▋ | 19/22 [00:02<00:00, 10.35it/s] 95%|█████████▌| 21/22 [00:05<00:00,  1.42it/s]100%|██████████| 22/22 [00:06<00:00,  1.43it/s]100%|██████████| 22/22 [00:06<00:00,  3.62it/s]
2025-03-09 09:07:54,155 [INFO]: 	Computing best hyperparameters for index knn.index 03/09/2025, 09:07:54
2025-03-09 09:08:35,307 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 41.1520 secs
2025-03-09 09:08:35,308 [INFO]: The best hyperparameters are: efSearch=263
2025-03-09 09:08:35,308 [INFO]: 	Compute fast metrics 03/09/2025, 09:08:35
  0%|          | 0/4 [00:00<?, ?it/s] 25%|██▌       | 1/4 [00:00<00:00,  8.87it/s] 75%|███████▌  | 3/4 [00:00<00:00, 16.04it/s]
2025-03-09 09:08:49,822 [INFO]: 	>>> Finished "Compute fast metrics" in 14.5147 secs
2025-03-09 09:08:49,823 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 61.7467 secs
2025-03-09 09:08:49,823 [INFO]: {
2025-03-09 09:08:49,823 [INFO]: 	index_key: HNSW15
2025-03-09 09:08:49,823 [INFO]: 	index_param: efSearch=263
2025-03-09 09:08:49,823 [INFO]: 	index_path: knn.index
2025-03-09 09:08:49,823 [INFO]: 	size in bytes: 1023462730
2025-03-09 09:08:49,823 [INFO]: 	avg_search_speed_ms: 10.668391377735672
2025-03-09 09:08:49,823 [INFO]: 	99p_search_speed_ms: 16.312639312818646
2025-03-09 09:08:49,823 [INFO]: 	reconstruction error %: 0.0
2025-03-09 09:08:49,823 [INFO]: 	nb vectors: 5202
2025-03-09 09:08:49,823 [INFO]: 	vectors dimension: 49152
2025-03-09 09:08:49,823 [INFO]: 	compression ratio: 0.9993083148225632
2025-03-09 09:08:49,823 [INFO]: }
2025-03-09 09:08:49,823 [INFO]: 	>>> Finished "Creating the index" in 61.7482 secs
2025-03-09 09:08:49,823 [INFO]: >>> Finished "Launching the whole pipeline" in 61.7718 secs
2025-03-09 09:08:51: [retrieval_preprocessing] calculating distances ...
2025-03-09 09:08:51: [retrieval_preprocessing] finished and saved retrieval indices for episode 22536 [episode count 1/20]
[retrieval_preprocessing] for episode 77324 [episode count 2/20], we have num_retrieval=np.int64(5165) num_query=np.int64(196)
2025-03-09 09:08:53,060 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-09 09:08:54,109 [INFO]: Launching the whole pipeline 03/09/2025, 09:08:54
2025-03-09 09:08:54,109 [INFO]: Reading total number of vectors and dimension 03/09/2025, 09:08:54
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1409.85it/s]
2025-03-09 09:08:54,136 [INFO]: There are 5165 embeddings of dim 49152
2025-03-09 09:08:54,136 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0271 secs
2025-03-09 09:08:54,136 [INFO]: 	Compute estimated construction time of the index 03/09/2025, 09:08:54
2025-03-09 09:08:54,137 [INFO]: 		-> Train: 16.7 minutes
2025-03-09 09:08:54,137 [INFO]: 		-> Add: 2.8 seconds
2025-03-09 09:08:54,137 [INFO]: 		Total: 16.7 minutes
2025-03-09 09:08:54,137 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0003 secs
2025-03-09 09:08:54,137 [INFO]: 	Checking that your have enough memory available to create the index 03/09/2025, 09:08:54
2025-03-09 09:08:54,137 [INFO]: 1.0GB of memory will be needed to build the index (more might be used if you have more)
2025-03-09 09:08:54,137 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0004 secs
2025-03-09 09:08:54,138 [INFO]: 	Selecting most promising index types given data characteristics 03/09/2025, 09:08:54
2025-03-09 09:08:54,138 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-09 09:08:54,138 [INFO]: 	Creating the index 03/09/2025, 09:08:54
2025-03-09 09:08:54,138 [INFO]: 		-> Instanciate the index HNSW15 03/09/2025, 09:08:54
2025-03-09 09:08:54,141 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0027 secs
2025-03-09 09:08:54,141 [INFO]: 		-> Adding the vectors to the index 03/09/2025, 09:08:54
2025-03-09 09:08:54,141 [INFO]: The memory available for adding the vectors is 49.1GB(total available - used by the index)
2025-03-09 09:08:54,141 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/22 [00:00<?, ?it/s]  5%|▍         | 1/22 [00:00<00:03,  6.27it/s] 14%|█▎        | 3/22 [00:00<00:01, 10.24it/s] 23%|██▎       | 5/22 [00:00<00:01, 11.59it/s] 32%|███▏      | 7/22 [00:00<00:01, 12.32it/s] 41%|████      | 9/22 [00:00<00:01, 12.64it/s] 50%|█████     | 11/22 [00:00<00:00, 12.86it/s] 59%|█████▉    | 13/22 [00:01<00:00, 13.07it/s] 68%|██████▊   | 15/22 [00:01<00:00, 13.15it/s] 77%|███████▋  | 17/22 [00:01<00:00, 13.19it/s] 86%|████████▋ | 19/22 [00:01<00:00, 13.12it/s] 95%|█████████▌| 21/22 [00:06<00:00,  1.34it/s]100%|██████████| 22/22 [00:07<00:00,  1.21it/s]100%|██████████| 22/22 [00:07<00:00,  3.05it/s]
2025-03-09 09:09:01,353 [INFO]: 	Computing best hyperparameters for index knn.index 03/09/2025, 09:09:01
2025-03-09 09:09:49,547 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 48.1939 secs
2025-03-09 09:09:49,547 [INFO]: The best hyperparameters are: efSearch=224
2025-03-09 09:09:49,547 [INFO]: 	Compute fast metrics 03/09/2025, 09:09:49
  0%|          | 0/4 [00:00<?, ?it/s] 25%|██▌       | 1/4 [00:00<00:01,  2.13it/s] 50%|█████     | 2/4 [00:00<00:00,  3.86it/s] 75%|███████▌  | 3/4 [00:00<00:00,  5.21it/s] 75%|███████▌  | 3/4 [00:00<00:00,  3.77it/s]
2025-03-09 09:10:07,541 [INFO]: 	>>> Finished "Compute fast metrics" in 17.9934 secs
2025-03-09 09:10:08,177 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 74.0362 secs
2025-03-09 09:10:08,178 [INFO]: {
2025-03-09 09:10:08,178 [INFO]: 	index_key: HNSW15
2025-03-09 09:10:08,178 [INFO]: 	index_param: efSearch=224
2025-03-09 09:10:08,178 [INFO]: 	index_path: knn.index
2025-03-09 09:10:08,178 [INFO]: 	size in bytes: 1016183050
2025-03-09 09:10:08,178 [INFO]: 	avg_search_speed_ms: 9.583586103896614
2025-03-09 09:10:08,178 [INFO]: 	99p_search_speed_ms: 19.729005950502962
2025-03-09 09:10:08,178 [INFO]: 	reconstruction error %: 0.0
2025-03-09 09:10:08,179 [INFO]: 	nb vectors: 5165
2025-03-09 09:10:08,179 [INFO]: 	vectors dimension: 49152
2025-03-09 09:10:08,179 [INFO]: 	compression ratio: 0.9993084612068662
2025-03-09 09:10:08,179 [INFO]: }
2025-03-09 09:10:08,179 [INFO]: 	>>> Finished "Creating the index" in 74.0410 secs
2025-03-09 09:10:08,179 [INFO]: >>> Finished "Launching the whole pipeline" in 74.0699 secs
2025-03-09 09:10:09: [retrieval_preprocessing] calculating distances ...
2025-03-09 09:10:10: [retrieval_preprocessing] finished and saved retrieval indices for episode 77324 [episode count 2/20]
[retrieval_preprocessing] for episode 83482 [episode count 3/20], we have num_retrieval=np.int64(5161) num_query=np.int64(200)
2025-03-09 09:10:12,380 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-09 09:10:13,106 [INFO]: Launching the whole pipeline 03/09/2025, 09:10:13
2025-03-09 09:10:13,106 [INFO]: Reading total number of vectors and dimension 03/09/2025, 09:10:13
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1348.65it/s]
2025-03-09 09:10:13,132 [INFO]: There are 5161 embeddings of dim 49152
2025-03-09 09:10:13,133 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0268 secs
2025-03-09 09:10:13,133 [INFO]: 	Compute estimated construction time of the index 03/09/2025, 09:10:13
2025-03-09 09:10:13,133 [INFO]: 		-> Train: 16.7 minutes
2025-03-09 09:10:13,133 [INFO]: 		-> Add: 2.8 seconds
2025-03-09 09:10:13,133 [INFO]: 		Total: 16.7 minutes
2025-03-09 09:10:13,133 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0002 secs
2025-03-09 09:10:13,133 [INFO]: 	Checking that your have enough memory available to create the index 03/09/2025, 09:10:13
2025-03-09 09:10:13,133 [INFO]: 1.0GB of memory will be needed to build the index (more might be used if you have more)
2025-03-09 09:10:13,133 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0002 secs
2025-03-09 09:10:13,133 [INFO]: 	Selecting most promising index types given data characteristics 03/09/2025, 09:10:13
2025-03-09 09:10:13,133 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-09 09:10:13,134 [INFO]: 	Creating the index 03/09/2025, 09:10:13
2025-03-09 09:10:13,134 [INFO]: 		-> Instanciate the index HNSW15 03/09/2025, 09:10:13
2025-03-09 09:10:13,135 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0014 secs
2025-03-09 09:10:13,135 [INFO]: 		-> Adding the vectors to the index 03/09/2025, 09:10:13
2025-03-09 09:10:13,135 [INFO]: The memory available for adding the vectors is 49.1GB(total available - used by the index)
2025-03-09 09:10:13,135 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/22 [00:00<?, ?it/s]  5%|▍         | 1/22 [00:00<00:03,  5.50it/s] 14%|█▎        | 3/22 [00:00<00:01,  9.61it/s] 23%|██▎       | 5/22 [00:00<00:01, 11.19it/s] 32%|███▏      | 7/22 [00:00<00:01, 11.48it/s] 41%|████      | 9/22 [00:00<00:01, 11.86it/s] 50%|█████     | 11/22 [00:00<00:00, 12.11it/s] 59%|█████▉    | 13/22 [00:01<00:00, 12.42it/s] 68%|██████▊   | 15/22 [00:01<00:00, 12.44it/s] 77%|███████▋  | 17/22 [00:01<00:00, 12.69it/s] 86%|████████▋ | 19/22 [00:01<00:00, 12.59it/s] 95%|█████████▌| 21/22 [00:05<00:00,  1.51it/s]100%|██████████| 22/22 [00:06<00:00,  1.44it/s]100%|██████████| 22/22 [00:06<00:00,  3.45it/s]
2025-03-09 09:10:19,516 [INFO]: 	Computing best hyperparameters for index knn.index 03/09/2025, 09:10:19
2025-03-09 09:10:59,934 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 40.4183 secs
2025-03-09 09:10:59,935 [INFO]: The best hyperparameters are: efSearch=224
2025-03-09 09:10:59,935 [INFO]: 	Compute fast metrics 03/09/2025, 09:10:59
  0%|          | 0/4 [00:00<?, ?it/s] 25%|██▌       | 1/4 [00:00<00:00,  4.75it/s] 50%|█████     | 2/4 [00:00<00:00,  5.14it/s] 75%|███████▌  | 3/4 [00:00<00:00,  6.26it/s] 75%|███████▌  | 3/4 [00:00<00:00,  4.81it/s]
2025-03-09 09:11:14,173 [INFO]: 	>>> Finished "Compute fast metrics" in 14.2388 secs
2025-03-09 09:11:14,174 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 61.0385 secs
2025-03-09 09:11:14,174 [INFO]: {
2025-03-09 09:11:14,174 [INFO]: 	index_key: HNSW15
2025-03-09 09:11:14,174 [INFO]: 	index_param: efSearch=224
2025-03-09 09:11:14,174 [INFO]: 	index_path: knn.index
2025-03-09 09:11:14,174 [INFO]: 	size in bytes: 1015396030
2025-03-09 09:11:14,174 [INFO]: 	avg_search_speed_ms: 8.8678658776834
2025-03-09 09:11:14,174 [INFO]: 	99p_search_speed_ms: 13.67339976830408
2025-03-09 09:11:14,174 [INFO]: 	reconstruction error %: 0.0
2025-03-09 09:11:14,174 [INFO]: 	nb vectors: 5161
2025-03-09 09:11:14,174 [INFO]: 	vectors dimension: 49152
2025-03-09 09:11:14,174 [INFO]: 	compression ratio: 0.9993085042887158
2025-03-09 09:11:14,174 [INFO]: }
2025-03-09 09:11:14,174 [INFO]: 	>>> Finished "Creating the index" in 61.0404 secs
2025-03-09 09:11:14,174 [INFO]: >>> Finished "Launching the whole pipeline" in 61.0682 secs
2025-03-09 09:11:15: [retrieval_preprocessing] calculating distances ...
2025-03-09 09:11:15: [retrieval_preprocessing] finished and saved retrieval indices for episode 83482 [episode count 3/20]
[retrieval_preprocessing] for episode 53804 [episode count 4/20], we have num_retrieval=np.int64(4859) num_query=np.int64(502)
2025-03-09 09:11:17,159 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-09 09:11:17,923 [INFO]: Launching the whole pipeline 03/09/2025, 09:11:17
2025-03-09 09:11:17,923 [INFO]: Reading total number of vectors and dimension 03/09/2025, 09:11:17
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 2288.22it/s]
2025-03-09 09:11:17,946 [INFO]: There are 4859 embeddings of dim 49152
2025-03-09 09:11:17,947 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0236 secs
2025-03-09 09:11:17,947 [INFO]: 	Compute estimated construction time of the index 03/09/2025, 09:11:17
2025-03-09 09:11:17,947 [INFO]: 		-> Train: 16.7 minutes
2025-03-09 09:11:17,947 [INFO]: 		-> Add: 2.7 seconds
2025-03-09 09:11:17,947 [INFO]: 		Total: 16.7 minutes
2025-03-09 09:11:17,947 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0002 secs
2025-03-09 09:11:17,947 [INFO]: 	Checking that your have enough memory available to create the index 03/09/2025, 09:11:17
2025-03-09 09:11:17,947 [INFO]: 1002.8MB of memory will be needed to build the index (more might be used if you have more)
2025-03-09 09:11:17,947 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0001 secs
2025-03-09 09:11:17,947 [INFO]: 	Selecting most promising index types given data characteristics 03/09/2025, 09:11:17
2025-03-09 09:11:17,947 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-09 09:11:17,947 [INFO]: 	Creating the index 03/09/2025, 09:11:17
2025-03-09 09:11:17,947 [INFO]: 		-> Instanciate the index HNSW15 03/09/2025, 09:11:17
2025-03-09 09:11:17,948 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0008 secs
2025-03-09 09:11:17,948 [INFO]: 		-> Adding the vectors to the index 03/09/2025, 09:11:17
2025-03-09 09:11:17,948 [INFO]: The memory available for adding the vectors is 49.1GB(total available - used by the index)
2025-03-09 09:11:17,948 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/20 [00:00<?, ?it/s]  5%|▌         | 1/20 [00:00<00:03,  5.18it/s] 15%|█▌        | 3/20 [00:00<00:01,  9.21it/s] 25%|██▌       | 5/20 [00:00<00:01, 10.68it/s] 35%|███▌      | 7/20 [00:00<00:01, 11.17it/s] 45%|████▌     | 9/20 [00:00<00:00, 11.61it/s] 55%|█████▌    | 11/20 [00:01<00:00, 11.75it/s] 65%|██████▌   | 13/20 [00:01<00:00, 11.87it/s] 75%|███████▌  | 15/20 [00:01<00:00, 11.94it/s] 85%|████████▌ | 17/20 [00:01<00:00, 11.87it/s] 95%|█████████▌| 19/20 [00:01<00:00, 11.86it/s]100%|██████████| 20/20 [00:04<00:00,  4.17it/s]
2025-03-09 09:11:22,747 [INFO]: 	Computing best hyperparameters for index knn.index 03/09/2025, 09:11:22
2025-03-09 09:11:59,696 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 36.9483 secs
2025-03-09 09:11:59,696 [INFO]: The best hyperparameters are: efSearch=229
2025-03-09 09:11:59,696 [INFO]: 	Compute fast metrics 03/09/2025, 09:11:59
  0%|          | 0/4 [00:00<?, ?it/s] 25%|██▌       | 1/4 [00:00<00:00,  4.87it/s] 50%|█████     | 2/4 [00:00<00:00,  5.84it/s] 75%|███████▌  | 3/4 [00:00<00:00,  5.90it/s]
2025-03-09 09:12:20,132 [INFO]: 	>>> Finished "Compute fast metrics" in 20.4359 secs
2025-03-09 09:12:20,135 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 62.1869 secs
2025-03-09 09:12:20,135 [INFO]: {
2025-03-09 09:12:20,135 [INFO]: 	index_key: HNSW15
2025-03-09 09:12:20,135 [INFO]: 	index_param: efSearch=229
2025-03-09 09:12:20,135 [INFO]: 	index_path: knn.index
2025-03-09 09:12:20,135 [INFO]: 	size in bytes: 955979170
2025-03-09 09:12:20,135 [INFO]: 	avg_search_speed_ms: 9.043415840572019
2025-03-09 09:12:20,135 [INFO]: 	99p_search_speed_ms: 13.821334822569057
2025-03-09 09:12:20,135 [INFO]: 	reconstruction error %: 0.0
2025-03-09 09:12:20,135 [INFO]: 	nb vectors: 4859
2025-03-09 09:12:20,135 [INFO]: 	vectors dimension: 49152
2025-03-09 09:12:20,135 [INFO]: 	compression ratio: 0.9993086690372134
2025-03-09 09:12:20,135 [INFO]: }
2025-03-09 09:12:20,135 [INFO]: 	>>> Finished "Creating the index" in 62.1882 secs
2025-03-09 09:12:20,135 [INFO]: >>> Finished "Launching the whole pipeline" in 62.2125 secs
2025-03-09 09:12:23: [retrieval_preprocessing] calculating distances ...
2025-03-09 09:12:25: [retrieval_preprocessing] finished and saved retrieval indices for episode 53804 [episode count 4/20]
[retrieval_preprocessing] for episode 52787 [episode count 5/20], we have num_retrieval=np.int64(5185) num_query=np.int64(176)
2025-03-09 09:12:27,814 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-09 09:12:28,561 [INFO]: Launching the whole pipeline 03/09/2025, 09:12:28
2025-03-09 09:12:28,561 [INFO]: Reading total number of vectors and dimension 03/09/2025, 09:12:28
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1458.38it/s]
2025-03-09 09:12:28,590 [INFO]: There are 5185 embeddings of dim 49152
2025-03-09 09:12:28,590 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0289 secs
2025-03-09 09:12:28,590 [INFO]: 	Compute estimated construction time of the index 03/09/2025, 09:12:28
2025-03-09 09:12:28,591 [INFO]: 		-> Train: 16.7 minutes
2025-03-09 09:12:28,591 [INFO]: 		-> Add: 2.8 seconds
2025-03-09 09:12:28,591 [INFO]: 		Total: 16.7 minutes
2025-03-09 09:12:28,591 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0006 secs
2025-03-09 09:12:28,591 [INFO]: 	Checking that your have enough memory available to create the index 03/09/2025, 09:12:28
2025-03-09 09:12:28,591 [INFO]: 1.0GB of memory will be needed to build the index (more might be used if you have more)
2025-03-09 09:12:28,592 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0005 secs
2025-03-09 09:12:28,592 [INFO]: 	Selecting most promising index types given data characteristics 03/09/2025, 09:12:28
2025-03-09 09:12:28,592 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-09 09:12:28,592 [INFO]: 	Creating the index 03/09/2025, 09:12:28
2025-03-09 09:12:28,592 [INFO]: 		-> Instanciate the index HNSW15 03/09/2025, 09:12:28
2025-03-09 09:12:28,595 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0028 secs
2025-03-09 09:12:28,595 [INFO]: 		-> Adding the vectors to the index 03/09/2025, 09:12:28
2025-03-09 09:12:28,595 [INFO]: The memory available for adding the vectors is 49.1GB(total available - used by the index)
2025-03-09 09:12:28,596 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/22 [00:00<?, ?it/s]  5%|▍         | 1/22 [00:00<00:03,  5.43it/s] 14%|█▎        | 3/22 [00:00<00:02,  8.78it/s] 23%|██▎       | 5/22 [00:00<00:01,  9.85it/s] 32%|███▏      | 7/22 [00:00<00:01, 10.27it/s] 41%|████      | 9/22 [00:00<00:01, 10.41it/s] 50%|█████     | 11/22 [00:01<00:01, 10.50it/s] 59%|█████▉    | 13/22 [00:01<00:00, 10.81it/s] 68%|██████▊   | 15/22 [00:01<00:00, 11.48it/s] 77%|███████▋  | 17/22 [00:01<00:00, 11.41it/s] 86%|████████▋ | 19/22 [00:01<00:00, 11.34it/s] 95%|█████████▌| 21/22 [00:05<00:00,  1.58it/s]100%|██████████| 22/22 [00:06<00:00,  1.43it/s]100%|██████████| 22/22 [00:06<00:00,  3.39it/s]
2025-03-09 09:12:35,096 [INFO]: 	Computing best hyperparameters for index knn.index 03/09/2025, 09:12:35
2025-03-09 09:13:21,123 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 46.0273 secs
2025-03-09 09:13:21,123 [INFO]: The best hyperparameters are: efSearch=232
2025-03-09 09:13:21,123 [INFO]: 	Compute fast metrics 03/09/2025, 09:13:21
  0%|          | 0/4 [00:00<?, ?it/s] 50%|█████     | 2/4 [00:00<00:00, 17.43it/s] 75%|███████▌  | 3/4 [00:00<00:00, 18.67it/s]
2025-03-09 09:13:38,357 [INFO]: 	>>> Finished "Compute fast metrics" in 17.2337 secs
2025-03-09 09:13:38,888 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 70.2921 secs
2025-03-09 09:13:38,888 [INFO]: {
2025-03-09 09:13:38,888 [INFO]: 	index_key: HNSW15
2025-03-09 09:13:38,888 [INFO]: 	index_param: efSearch=232
2025-03-09 09:13:38,888 [INFO]: 	index_path: knn.index
2025-03-09 09:13:38,888 [INFO]: 	size in bytes: 1020118030
2025-03-09 09:13:38,888 [INFO]: 	avg_search_speed_ms: 9.222385704446914
2025-03-09 09:13:38,888 [INFO]: 	99p_search_speed_ms: 18.00403262488545
2025-03-09 09:13:38,888 [INFO]: 	reconstruction error %: 0.0
2025-03-09 09:13:38,888 [INFO]: 	nb vectors: 5185
2025-03-09 09:13:38,888 [INFO]: 	vectors dimension: 49152
2025-03-09 09:13:38,888 [INFO]: 	compression ratio: 0.9993083643468198
2025-03-09 09:13:38,888 [INFO]: }
2025-03-09 09:13:38,889 [INFO]: 	>>> Finished "Creating the index" in 70.2965 secs
2025-03-09 09:13:38,889 [INFO]: >>> Finished "Launching the whole pipeline" in 70.3274 secs
2025-03-09 09:13:40: [retrieval_preprocessing] calculating distances ...
2025-03-09 09:13:40: [retrieval_preprocessing] finished and saved retrieval indices for episode 52787 [episode count 5/20]
[retrieval_preprocessing] for episode 87094 [episode count 6/20], we have num_retrieval=np.int64(5119) num_query=np.int64(242)
2025-03-09 09:13:42,265 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-09 09:13:42,954 [INFO]: Launching the whole pipeline 03/09/2025, 09:13:42
2025-03-09 09:13:42,954 [INFO]: Reading total number of vectors and dimension 03/09/2025, 09:13:42
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1822.82it/s]
2025-03-09 09:13:42,981 [INFO]: There are 5119 embeddings of dim 49152
2025-03-09 09:13:42,981 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0272 secs
2025-03-09 09:13:42,981 [INFO]: 	Compute estimated construction time of the index 03/09/2025, 09:13:42
2025-03-09 09:13:42,982 [INFO]: 		-> Train: 16.7 minutes
2025-03-09 09:13:42,982 [INFO]: 		-> Add: 2.8 seconds
2025-03-09 09:13:42,982 [INFO]: 		Total: 16.7 minutes
2025-03-09 09:13:42,982 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0001 secs
2025-03-09 09:13:42,982 [INFO]: 	Checking that your have enough memory available to create the index 03/09/2025, 09:13:42
2025-03-09 09:13:42,982 [INFO]: 1.0GB of memory will be needed to build the index (more might be used if you have more)
2025-03-09 09:13:42,982 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0001 secs
2025-03-09 09:13:42,982 [INFO]: 	Selecting most promising index types given data characteristics 03/09/2025, 09:13:42
2025-03-09 09:13:42,982 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-09 09:13:42,982 [INFO]: 	Creating the index 03/09/2025, 09:13:42
2025-03-09 09:13:42,982 [INFO]: 		-> Instanciate the index HNSW15 03/09/2025, 09:13:42
2025-03-09 09:13:42,983 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0009 secs
2025-03-09 09:13:42,983 [INFO]: 		-> Adding the vectors to the index 03/09/2025, 09:13:42
2025-03-09 09:13:42,983 [INFO]: The memory available for adding the vectors is 49.1GB(total available - used by the index)
2025-03-09 09:13:42,983 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/22 [00:00<?, ?it/s]  5%|▍         | 1/22 [00:00<00:03,  5.59it/s] 14%|█▎        | 3/22 [00:00<00:02,  9.42it/s] 23%|██▎       | 5/22 [00:00<00:01, 10.51it/s] 32%|███▏      | 7/22 [00:00<00:01, 12.79it/s] 41%|████      | 9/22 [00:00<00:00, 14.30it/s] 50%|█████     | 11/22 [00:00<00:00, 15.35it/s] 59%|█████▉    | 13/22 [00:00<00:00, 15.93it/s] 68%|██████▊   | 15/22 [00:01<00:00, 14.26it/s] 77%|███████▋  | 17/22 [00:01<00:00, 13.46it/s] 86%|████████▋ | 19/22 [00:01<00:00, 13.28it/s] 95%|█████████▌| 21/22 [00:05<00:00,  1.65it/s]100%|██████████| 22/22 [00:05<00:00,  1.60it/s]100%|██████████| 22/22 [00:05<00:00,  3.81it/s]
2025-03-09 09:13:48,762 [INFO]: 	Computing best hyperparameters for index knn.index 03/09/2025, 09:13:48
2025-03-09 09:14:34,532 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 45.7698 secs
2025-03-09 09:14:34,532 [INFO]: The best hyperparameters are: efSearch=215
2025-03-09 09:14:34,533 [INFO]: 	Compute fast metrics 03/09/2025, 09:14:34
  0%|          | 0/4 [00:00<?, ?it/s] 25%|██▌       | 1/4 [00:00<00:00,  5.06it/s] 50%|█████     | 2/4 [00:00<00:00,  6.76it/s] 75%|███████▌  | 3/4 [00:00<00:00,  7.66it/s] 75%|███████▌  | 3/4 [00:00<00:00,  5.67it/s]
2025-03-09 09:14:56,333 [INFO]: 	>>> Finished "Compute fast metrics" in 21.7999 secs
2025-03-09 09:14:56,333 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 73.3500 secs
2025-03-09 09:14:56,333 [INFO]: {
2025-03-09 09:14:56,333 [INFO]: 	index_key: HNSW15
2025-03-09 09:14:56,333 [INFO]: 	index_param: efSearch=215
2025-03-09 09:14:56,333 [INFO]: 	index_path: knn.index
2025-03-09 09:14:56,333 [INFO]: 	size in bytes: 1007132830
2025-03-09 09:14:56,333 [INFO]: 	avg_search_speed_ms: 9.600239171514255
2025-03-09 09:14:56,333 [INFO]: 	99p_search_speed_ms: 20.122848702594624
2025-03-09 09:14:56,333 [INFO]: 	reconstruction error %: 0.0
2025-03-09 09:14:56,333 [INFO]: 	nb vectors: 5119
2025-03-09 09:14:56,333 [INFO]: 	vectors dimension: 49152
2025-03-09 09:14:56,333 [INFO]: 	compression ratio: 0.9993084546752388
2025-03-09 09:14:56,333 [INFO]: }
2025-03-09 09:14:56,333 [INFO]: 	>>> Finished "Creating the index" in 73.3516 secs
2025-03-09 09:14:56,334 [INFO]: >>> Finished "Launching the whole pipeline" in 73.3794 secs
2025-03-09 09:14:57: [retrieval_preprocessing] calculating distances ...
2025-03-09 09:14:58: [retrieval_preprocessing] finished and saved retrieval indices for episode 87094 [episode count 6/20]
[retrieval_preprocessing] for episode 3129 [episode count 7/20], we have num_retrieval=np.int64(5141) num_query=np.int64(220)
2025-03-09 09:14:59,654 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-09 09:15:00,393 [INFO]: Launching the whole pipeline 03/09/2025, 09:15:00
2025-03-09 09:15:00,394 [INFO]: Reading total number of vectors and dimension 03/09/2025, 09:15:00
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1152.91it/s]
2025-03-09 09:15:00,421 [INFO]: There are 5141 embeddings of dim 49152
2025-03-09 09:15:00,422 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0280 secs
2025-03-09 09:15:00,422 [INFO]: 	Compute estimated construction time of the index 03/09/2025, 09:15:00
2025-03-09 09:15:00,422 [INFO]: 		-> Train: 16.7 minutes
2025-03-09 09:15:00,422 [INFO]: 		-> Add: 2.8 seconds
2025-03-09 09:15:00,422 [INFO]: 		Total: 16.7 minutes
2025-03-09 09:15:00,422 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0001 secs
2025-03-09 09:15:00,422 [INFO]: 	Checking that your have enough memory available to create the index 03/09/2025, 09:15:00
2025-03-09 09:15:00,422 [INFO]: 1.0GB of memory will be needed to build the index (more might be used if you have more)
2025-03-09 09:15:00,422 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0002 secs
2025-03-09 09:15:00,422 [INFO]: 	Selecting most promising index types given data characteristics 03/09/2025, 09:15:00
2025-03-09 09:15:00,422 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-09 09:15:00,422 [INFO]: 	Creating the index 03/09/2025, 09:15:00
2025-03-09 09:15:00,422 [INFO]: 		-> Instanciate the index HNSW15 03/09/2025, 09:15:00
2025-03-09 09:15:00,423 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0012 secs
2025-03-09 09:15:00,424 [INFO]: 		-> Adding the vectors to the index 03/09/2025, 09:15:00
2025-03-09 09:15:00,424 [INFO]: The memory available for adding the vectors is 49.1GB(total available - used by the index)
2025-03-09 09:15:00,424 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/22 [00:00<?, ?it/s]  5%|▍         | 1/22 [00:00<00:05,  3.90it/s]  9%|▉         | 2/22 [00:00<00:03,  5.56it/s] 14%|█▎        | 3/22 [00:00<00:02,  6.61it/s] 18%|█▊        | 4/22 [00:00<00:02,  7.26it/s] 23%|██▎       | 5/22 [00:00<00:02,  7.67it/s] 27%|██▋       | 6/22 [00:00<00:02,  7.98it/s] 32%|███▏      | 7/22 [00:00<00:01,  8.22it/s] 36%|███▋      | 8/22 [00:01<00:01,  8.33it/s] 41%|████      | 9/22 [00:01<00:01,  8.38it/s] 45%|████▌     | 10/22 [00:01<00:01,  8.40it/s] 50%|█████     | 11/22 [00:01<00:01,  8.44it/s] 55%|█████▍    | 12/22 [00:01<00:01,  8.49it/s] 59%|█████▉    | 13/22 [00:01<00:01,  8.45it/s] 64%|██████▎   | 14/22 [00:01<00:00,  8.40it/s] 68%|██████▊   | 15/22 [00:01<00:00,  8.37it/s] 73%|███████▎  | 16/22 [00:02<00:00,  8.37it/s] 77%|███████▋  | 17/22 [00:02<00:00,  8.52it/s] 82%|████████▏ | 18/22 [00:02<00:00,  8.58it/s] 86%|████████▋ | 19/22 [00:02<00:00,  8.60it/s] 91%|█████████ | 20/22 [00:02<00:00,  8.90it/s] 95%|█████████▌| 21/22 [00:06<00:01,  1.18s/it]100%|██████████| 22/22 [00:06<00:00,  1.06s/it]100%|██████████| 22/22 [00:06<00:00,  3.17it/s]
2025-03-09 09:15:07,359 [INFO]: 	Computing best hyperparameters for index knn.index 03/09/2025, 09:15:07
2025-03-09 09:15:48,444 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 41.0841 secs
2025-03-09 09:15:48,444 [INFO]: The best hyperparameters are: efSearch=208
2025-03-09 09:15:48,444 [INFO]: 	Compute fast metrics 03/09/2025, 09:15:48
  0%|          | 0/4 [00:00<?, ?it/s] 25%|██▌       | 1/4 [00:00<00:00,  5.10it/s] 50%|█████     | 2/4 [00:00<00:00,  6.64it/s] 75%|███████▌  | 3/4 [00:00<00:00,  7.55it/s] 75%|███████▌  | 3/4 [00:00<00:00,  5.71it/s]
2025-03-09 09:16:05,309 [INFO]: 	>>> Finished "Compute fast metrics" in 16.8645 secs
2025-03-09 09:16:05,309 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 64.8854 secs
2025-03-09 09:16:05,309 [INFO]: {
2025-03-09 09:16:05,309 [INFO]: 	index_key: HNSW15
2025-03-09 09:16:05,309 [INFO]: 	index_param: efSearch=208
2025-03-09 09:16:05,309 [INFO]: 	index_path: knn.index
2025-03-09 09:16:05,309 [INFO]: 	size in bytes: 1011461170
2025-03-09 09:16:05,309 [INFO]: 	avg_search_speed_ms: 9.002239894772385
2025-03-09 09:16:05,309 [INFO]: 	99p_search_speed_ms: 18.330109491944313
2025-03-09 09:16:05,309 [INFO]: 	reconstruction error %: 0.0
2025-03-09 09:16:05,309 [INFO]: 	nb vectors: 5141
2025-03-09 09:16:05,309 [INFO]: 	vectors dimension: 49152
2025-03-09 09:16:05,309 [INFO]: 	compression ratio: 0.9993084835871653
2025-03-09 09:16:05,309 [INFO]: }
2025-03-09 09:16:05,309 [INFO]: 	>>> Finished "Creating the index" in 64.8870 secs
2025-03-09 09:16:05,309 [INFO]: >>> Finished "Launching the whole pipeline" in 64.9157 secs
2025-03-09 09:16:06: [retrieval_preprocessing] calculating distances ...
2025-03-09 09:16:06: [retrieval_preprocessing] finished and saved retrieval indices for episode 3129 [episode count 7/20]
[retrieval_preprocessing] for episode 93263 [episode count 8/20], we have num_retrieval=np.int64(5135) num_query=np.int64(226)
2025-03-09 09:16:08,538 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-09 09:16:09,218 [INFO]: Launching the whole pipeline 03/09/2025, 09:16:09
2025-03-09 09:16:09,218 [INFO]: Reading total number of vectors and dimension 03/09/2025, 09:16:09
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 2205.21it/s]
2025-03-09 09:16:09,243 [INFO]: There are 5135 embeddings of dim 49152
2025-03-09 09:16:09,243 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0252 secs
2025-03-09 09:16:09,244 [INFO]: 	Compute estimated construction time of the index 03/09/2025, 09:16:09
2025-03-09 09:16:09,244 [INFO]: 		-> Train: 16.7 minutes
2025-03-09 09:16:09,244 [INFO]: 		-> Add: 2.8 seconds
2025-03-09 09:16:09,244 [INFO]: 		Total: 16.7 minutes
2025-03-09 09:16:09,244 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0001 secs
2025-03-09 09:16:09,244 [INFO]: 	Checking that your have enough memory available to create the index 03/09/2025, 09:16:09
2025-03-09 09:16:09,244 [INFO]: 1.0GB of memory will be needed to build the index (more might be used if you have more)
2025-03-09 09:16:09,244 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0001 secs
2025-03-09 09:16:09,244 [INFO]: 	Selecting most promising index types given data characteristics 03/09/2025, 09:16:09
2025-03-09 09:16:09,244 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-09 09:16:09,244 [INFO]: 	Creating the index 03/09/2025, 09:16:09
2025-03-09 09:16:09,244 [INFO]: 		-> Instanciate the index HNSW15 03/09/2025, 09:16:09
2025-03-09 09:16:09,245 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0010 secs
2025-03-09 09:16:09,245 [INFO]: 		-> Adding the vectors to the index 03/09/2025, 09:16:09
2025-03-09 09:16:09,245 [INFO]: The memory available for adding the vectors is 49.1GB(total available - used by the index)
2025-03-09 09:16:09,245 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/22 [00:00<?, ?it/s]  5%|▍         | 1/22 [00:00<00:04,  5.03it/s]  9%|▉         | 2/22 [00:00<00:02,  6.75it/s] 14%|█▎        | 3/22 [00:00<00:02,  7.60it/s] 18%|█▊        | 4/22 [00:00<00:02,  8.08it/s] 23%|██▎       | 5/22 [00:00<00:02,  8.35it/s] 27%|██▋       | 6/22 [00:00<00:01,  8.51it/s] 32%|███▏      | 7/22 [00:00<00:01,  8.68it/s] 36%|███▋      | 8/22 [00:00<00:01,  8.81it/s] 41%|████      | 9/22 [00:01<00:01,  8.89it/s] 45%|████▌     | 10/22 [00:01<00:01,  8.86it/s] 50%|█████     | 11/22 [00:01<00:01,  8.87it/s] 55%|█████▍    | 12/22 [00:01<00:01,  8.93it/s] 59%|█████▉    | 13/22 [00:01<00:01,  8.92it/s] 64%|██████▎   | 14/22 [00:01<00:00,  8.88it/s] 68%|██████▊   | 15/22 [00:01<00:00,  8.87it/s] 73%|███████▎  | 16/22 [00:01<00:00,  8.87it/s] 82%|████████▏ | 18/22 [00:02<00:00,  9.91it/s] 91%|█████████ | 20/22 [00:02<00:00, 10.81it/s]100%|██████████| 22/22 [00:06<00:00,  1.27it/s]100%|██████████| 22/22 [00:06<00:00,  3.53it/s]
2025-03-09 09:16:15,479 [INFO]: 	Computing best hyperparameters for index knn.index 03/09/2025, 09:16:15
2025-03-09 09:17:04,659 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 49.1803 secs
2025-03-09 09:17:04,660 [INFO]: The best hyperparameters are: efSearch=202
2025-03-09 09:17:04,660 [INFO]: 	Compute fast metrics 03/09/2025, 09:17:04
  0%|          | 0/4 [00:00<?, ?it/s] 25%|██▌       | 1/4 [00:00<00:00,  8.54it/s] 75%|███████▌  | 3/4 [00:00<00:00, 13.22it/s]
2025-03-09 09:17:32,890 [INFO]: 	>>> Finished "Compute fast metrics" in 28.2300 secs
2025-03-09 09:17:32,891 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 83.6454 secs
2025-03-09 09:17:32,891 [INFO]: {
2025-03-09 09:17:32,891 [INFO]: 	index_key: HNSW15
2025-03-09 09:17:32,891 [INFO]: 	index_param: efSearch=202
2025-03-09 09:17:32,891 [INFO]: 	index_path: knn.index
2025-03-09 09:17:32,891 [INFO]: 	size in bytes: 1010280730
2025-03-09 09:17:32,891 [INFO]: 	avg_search_speed_ms: 10.414573401552238
2025-03-09 09:17:32,891 [INFO]: 	99p_search_speed_ms: 16.28750001778826
2025-03-09 09:17:32,891 [INFO]: 	reconstruction error %: 0.0
2025-03-09 09:17:32,891 [INFO]: 	nb vectors: 5135
2025-03-09 09:17:32,891 [INFO]: 	vectors dimension: 49152
2025-03-09 09:17:32,891 [INFO]: 	compression ratio: 0.9993084595407457
2025-03-09 09:17:32,891 [INFO]: }
2025-03-09 09:17:32,891 [INFO]: 	>>> Finished "Creating the index" in 83.6468 secs
2025-03-09 09:17:32,891 [INFO]: >>> Finished "Launching the whole pipeline" in 83.6727 secs
2025-03-09 09:17:34: [retrieval_preprocessing] calculating distances ...
2025-03-09 09:17:35: [retrieval_preprocessing] finished and saved retrieval indices for episode 93263 [episode count 8/20]
[retrieval_preprocessing] for episode 36947 [episode count 9/20], we have num_retrieval=np.int64(5134) num_query=np.int64(227)
2025-03-09 09:17:37,392 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-09 09:17:38,106 [INFO]: Launching the whole pipeline 03/09/2025, 09:17:38
2025-03-09 09:17:38,106 [INFO]: Reading total number of vectors and dimension 03/09/2025, 09:17:38
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1249.05it/s]
2025-03-09 09:17:38,133 [INFO]: There are 5134 embeddings of dim 49152
2025-03-09 09:17:38,133 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0274 secs
2025-03-09 09:17:38,133 [INFO]: 	Compute estimated construction time of the index 03/09/2025, 09:17:38
2025-03-09 09:17:38,134 [INFO]: 		-> Train: 16.7 minutes
2025-03-09 09:17:38,134 [INFO]: 		-> Add: 2.8 seconds
2025-03-09 09:17:38,134 [INFO]: 		Total: 16.7 minutes
2025-03-09 09:17:38,134 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0001 secs
2025-03-09 09:17:38,134 [INFO]: 	Checking that your have enough memory available to create the index 03/09/2025, 09:17:38
2025-03-09 09:17:38,134 [INFO]: 1.0GB of memory will be needed to build the index (more might be used if you have more)
2025-03-09 09:17:38,134 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0002 secs
2025-03-09 09:17:38,134 [INFO]: 	Selecting most promising index types given data characteristics 03/09/2025, 09:17:38
2025-03-09 09:17:38,134 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-09 09:17:38,134 [INFO]: 	Creating the index 03/09/2025, 09:17:38
2025-03-09 09:17:38,134 [INFO]: 		-> Instanciate the index HNSW15 03/09/2025, 09:17:38
2025-03-09 09:17:38,135 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0012 secs
2025-03-09 09:17:38,135 [INFO]: 		-> Adding the vectors to the index 03/09/2025, 09:17:38
2025-03-09 09:17:38,136 [INFO]: The memory available for adding the vectors is 49.1GB(total available - used by the index)
2025-03-09 09:17:38,136 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/22 [00:00<?, ?it/s]  5%|▍         | 1/22 [00:00<00:03,  5.76it/s] 14%|█▎        | 3/22 [00:00<00:02,  9.10it/s] 23%|██▎       | 5/22 [00:00<00:01, 10.22it/s] 32%|███▏      | 7/22 [00:00<00:01, 10.84it/s] 41%|████      | 9/22 [00:00<00:01, 11.04it/s] 50%|█████     | 11/22 [00:01<00:00, 11.22it/s] 59%|█████▉    | 13/22 [00:01<00:00, 11.36it/s] 68%|██████▊   | 15/22 [00:01<00:00, 12.28it/s] 77%|███████▋  | 17/22 [00:01<00:00, 13.48it/s] 86%|████████▋ | 19/22 [00:01<00:00, 14.39it/s] 95%|█████████▌| 21/22 [00:05<00:00,  1.62it/s]100%|██████████| 22/22 [00:06<00:00,  3.64it/s]
2025-03-09 09:17:44,180 [INFO]: 	Computing best hyperparameters for index knn.index 03/09/2025, 09:17:44
2025-03-09 09:18:34,322 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 50.1423 secs
2025-03-09 09:18:34,323 [INFO]: The best hyperparameters are: efSearch=203
2025-03-09 09:18:34,323 [INFO]: 	Compute fast metrics 03/09/2025, 09:18:34
  0%|          | 0/4 [00:00<?, ?it/s] 25%|██▌       | 1/4 [00:00<00:00,  6.83it/s] 75%|███████▌  | 3/4 [00:00<00:00, 11.12it/s] 75%|███████▌  | 3/4 [00:00<00:00,  8.79it/s]
2025-03-09 09:18:52,025 [INFO]: 	>>> Finished "Compute fast metrics" in 17.7020 secs
2025-03-09 09:18:52,025 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 73.8897 secs
2025-03-09 09:18:52,025 [INFO]: {
2025-03-09 09:18:52,025 [INFO]: 	index_key: HNSW15
2025-03-09 09:18:52,025 [INFO]: 	index_param: efSearch=203
2025-03-09 09:18:52,025 [INFO]: 	index_path: knn.index
2025-03-09 09:18:52,025 [INFO]: 	size in bytes: 1010083990
2025-03-09 09:18:52,025 [INFO]: 	avg_search_speed_ms: 9.192192331872374
2025-03-09 09:18:52,025 [INFO]: 	99p_search_speed_ms: 15.632734743412582
2025-03-09 09:18:52,025 [INFO]: 	reconstruction error %: 0.0
2025-03-09 09:18:52,025 [INFO]: 	nb vectors: 5134
2025-03-09 09:18:52,025 [INFO]: 	vectors dimension: 49152
2025-03-09 09:18:52,025 [INFO]: 	compression ratio: 0.9993084555275448
2025-03-09 09:18:52,025 [INFO]: }
2025-03-09 09:18:52,025 [INFO]: 	>>> Finished "Creating the index" in 73.8915 secs
2025-03-09 09:18:52,025 [INFO]: >>> Finished "Launching the whole pipeline" in 73.9195 secs
2025-03-09 09:18:52: [retrieval_preprocessing] calculating distances ...
2025-03-09 09:18:53: [retrieval_preprocessing] finished and saved retrieval indices for episode 36947 [episode count 9/20]
[retrieval_preprocessing] for episode 61527 [episode count 10/20], we have num_retrieval=np.int64(5179) num_query=np.int64(182)
2025-03-09 09:18:55,041 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-09 09:18:55,963 [INFO]: Launching the whole pipeline 03/09/2025, 09:18:55
2025-03-09 09:18:55,964 [INFO]: Reading total number of vectors and dimension 03/09/2025, 09:18:55
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1274.48it/s]
2025-03-09 09:18:56,288 [INFO]: There are 5179 embeddings of dim 49152
2025-03-09 09:18:56,288 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.3244 secs
2025-03-09 09:18:56,288 [INFO]: 	Compute estimated construction time of the index 03/09/2025, 09:18:56
2025-03-09 09:18:56,288 [INFO]: 		-> Train: 16.7 minutes
2025-03-09 09:18:56,288 [INFO]: 		-> Add: 2.8 seconds
2025-03-09 09:18:56,288 [INFO]: 		Total: 16.7 minutes
2025-03-09 09:18:56,288 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0003 secs
2025-03-09 09:18:56,289 [INFO]: 	Checking that your have enough memory available to create the index 03/09/2025, 09:18:56
2025-03-09 09:18:56,289 [INFO]: 1.0GB of memory will be needed to build the index (more might be used if you have more)
2025-03-09 09:18:56,289 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0004 secs
2025-03-09 09:18:56,289 [INFO]: 	Selecting most promising index types given data characteristics 03/09/2025, 09:18:56
2025-03-09 09:18:56,289 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-09 09:18:56,289 [INFO]: 	Creating the index 03/09/2025, 09:18:56
2025-03-09 09:18:56,289 [INFO]: 		-> Instanciate the index HNSW15 03/09/2025, 09:18:56
2025-03-09 09:18:56,292 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0025 secs
2025-03-09 09:18:56,292 [INFO]: 		-> Adding the vectors to the index 03/09/2025, 09:18:56
2025-03-09 09:18:56,292 [INFO]: The memory available for adding the vectors is 49.1GB(total available - used by the index)
2025-03-09 09:18:56,292 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/22 [00:00<?, ?it/s]  5%|▍         | 1/22 [00:00<00:03,  5.41it/s] 14%|█▎        | 3/22 [00:00<00:02,  7.92it/s] 18%|█▊        | 4/22 [00:00<00:02,  8.13it/s] 23%|██▎       | 5/22 [00:00<00:01,  8.52it/s] 27%|██▋       | 6/22 [00:00<00:01,  8.56it/s] 36%|███▋      | 8/22 [00:00<00:01,  8.88it/s] 41%|████      | 9/22 [00:01<00:01,  8.71it/s] 45%|████▌     | 10/22 [00:01<00:01,  8.53it/s] 50%|█████     | 11/22 [00:01<00:01,  8.57it/s] 55%|█████▍    | 12/22 [00:01<00:01,  8.67it/s] 59%|█████▉    | 13/22 [00:01<00:01,  8.62it/s] 64%|██████▎   | 14/22 [00:01<00:00,  8.58it/s] 68%|██████▊   | 15/22 [00:01<00:00,  8.60it/s] 73%|███████▎  | 16/22 [00:01<00:00,  8.60it/s] 77%|███████▋  | 17/22 [00:02<00:00,  8.75it/s] 86%|████████▋ | 19/22 [00:02<00:00, 10.55it/s] 95%|█████████▌| 21/22 [00:06<00:00,  1.17it/s]100%|██████████| 22/22 [00:07<00:00,  1.14it/s]100%|██████████| 22/22 [00:07<00:00,  3.09it/s]
2025-03-09 09:19:03,407 [INFO]: 	Computing best hyperparameters for index knn.index 03/09/2025, 09:19:03
2025-03-09 09:19:46,640 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 43.2324 secs
2025-03-09 09:19:46,640 [INFO]: The best hyperparameters are: efSearch=228
2025-03-09 09:19:46,640 [INFO]: 	Compute fast metrics 03/09/2025, 09:19:46
  0%|          | 0/4 [00:00<?, ?it/s] 25%|██▌       | 1/4 [00:00<00:00,  5.56it/s] 50%|█████     | 2/4 [00:00<00:00,  6.98it/s] 75%|███████▌  | 3/4 [00:00<00:00,  7.95it/s] 75%|███████▌  | 3/4 [00:00<00:00,  5.94it/s]
2025-03-09 09:20:04,183 [INFO]: 	>>> Finished "Compute fast metrics" in 17.5427 secs
2025-03-09 09:20:04,183 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 67.8911 secs
2025-03-09 09:20:04,183 [INFO]: {
2025-03-09 09:20:04,183 [INFO]: 	index_key: HNSW15
2025-03-09 09:20:04,183 [INFO]: 	index_param: efSearch=228
2025-03-09 09:20:04,183 [INFO]: 	index_path: knn.index
2025-03-09 09:20:04,183 [INFO]: 	size in bytes: 1018937470
2025-03-09 09:20:04,183 [INFO]: 	avg_search_speed_ms: 10.340050572670048
2025-03-09 09:20:04,183 [INFO]: 	99p_search_speed_ms: 19.14159156847746
2025-03-09 09:20:04,183 [INFO]: 	reconstruction error %: 0.0
2025-03-09 09:20:04,183 [INFO]: 	nb vectors: 5179
2025-03-09 09:20:04,184 [INFO]: 	vectors dimension: 49152
2025-03-09 09:20:04,184 [INFO]: 	compression ratio: 0.9993084580548403
2025-03-09 09:20:04,184 [INFO]: }
2025-03-09 09:20:04,184 [INFO]: 	>>> Finished "Creating the index" in 67.8942 secs
2025-03-09 09:20:04,184 [INFO]: >>> Finished "Launching the whole pipeline" in 68.2200 secs
2025-03-09 09:20:05: [retrieval_preprocessing] calculating distances ...
2025-03-09 09:20:05: [retrieval_preprocessing] finished and saved retrieval indices for episode 61527 [episode count 10/20]
[retrieval_preprocessing] for episode 90210 [episode count 11/20], we have num_retrieval=np.int64(5068) num_query=np.int64(293)
2025-03-09 09:20:07,495 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-09 09:20:08,195 [INFO]: Launching the whole pipeline 03/09/2025, 09:20:08
2025-03-09 09:20:08,195 [INFO]: Reading total number of vectors and dimension 03/09/2025, 09:20:08
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1518.03it/s]
2025-03-09 09:20:08,220 [INFO]: There are 5068 embeddings of dim 49152
2025-03-09 09:20:08,221 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0251 secs
2025-03-09 09:20:08,221 [INFO]: 	Compute estimated construction time of the index 03/09/2025, 09:20:08
2025-03-09 09:20:08,221 [INFO]: 		-> Train: 16.7 minutes
2025-03-09 09:20:08,221 [INFO]: 		-> Add: 2.8 seconds
2025-03-09 09:20:08,221 [INFO]: 		Total: 16.7 minutes
2025-03-09 09:20:08,221 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0001 secs
2025-03-09 09:20:08,221 [INFO]: 	Checking that your have enough memory available to create the index 03/09/2025, 09:20:08
2025-03-09 09:20:08,221 [INFO]: 1.0GB of memory will be needed to build the index (more might be used if you have more)
2025-03-09 09:20:08,221 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0001 secs
2025-03-09 09:20:08,221 [INFO]: 	Selecting most promising index types given data characteristics 03/09/2025, 09:20:08
2025-03-09 09:20:08,221 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-09 09:20:08,221 [INFO]: 	Creating the index 03/09/2025, 09:20:08
2025-03-09 09:20:08,221 [INFO]: 		-> Instanciate the index HNSW15 03/09/2025, 09:20:08
2025-03-09 09:20:08,222 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0009 secs
2025-03-09 09:20:08,222 [INFO]: 		-> Adding the vectors to the index 03/09/2025, 09:20:08
2025-03-09 09:20:08,222 [INFO]: The memory available for adding the vectors is 49.1GB(total available - used by the index)
2025-03-09 09:20:08,222 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/20 [00:00<?, ?it/s]  5%|▌         | 1/20 [00:00<00:04,  4.69it/s] 10%|█         | 2/20 [00:00<00:02,  6.47it/s] 15%|█▌        | 3/20 [00:00<00:02,  7.43it/s] 20%|██        | 4/20 [00:00<00:02,  7.91it/s] 25%|██▌       | 5/20 [00:00<00:01,  8.25it/s] 30%|███       | 6/20 [00:00<00:01,  8.45it/s] 35%|███▌      | 7/20 [00:00<00:01,  8.55it/s] 40%|████      | 8/20 [00:01<00:01,  8.63it/s] 45%|████▌     | 9/20 [00:01<00:01,  8.53it/s] 50%|█████     | 10/20 [00:01<00:01,  8.70it/s] 55%|█████▌    | 11/20 [00:01<00:01,  8.75it/s] 60%|██████    | 12/20 [00:01<00:00,  8.80it/s] 65%|██████▌   | 13/20 [00:01<00:00,  8.80it/s] 70%|███████   | 14/20 [00:01<00:00,  8.79it/s] 75%|███████▌  | 15/20 [00:01<00:00,  8.73it/s] 85%|████████▌ | 17/20 [00:01<00:00,  9.87it/s] 95%|█████████▌| 19/20 [00:02<00:00, 10.40it/s]100%|██████████| 20/20 [00:05<00:00,  3.43it/s]
2025-03-09 09:20:14,062 [INFO]: 	Computing best hyperparameters for index knn.index 03/09/2025, 09:20:14
2025-03-09 09:20:58,953 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 44.8910 secs
2025-03-09 09:20:58,954 [INFO]: The best hyperparameters are: efSearch=220
2025-03-09 09:20:58,954 [INFO]: 	Compute fast metrics 03/09/2025, 09:20:58
  0%|          | 0/4 [00:00<?, ?it/s] 25%|██▌       | 1/4 [00:00<00:00,  6.68it/s] 75%|███████▌  | 3/4 [00:00<00:00, 12.17it/s] 75%|███████▌  | 3/4 [00:00<00:00,  9.41it/s]
2025-03-09 09:21:20,399 [INFO]: 	>>> Finished "Compute fast metrics" in 21.4449 secs
2025-03-09 09:21:20,402 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 72.1803 secs
2025-03-09 09:21:20,403 [INFO]: {
2025-03-09 09:21:20,403 [INFO]: 	index_key: HNSW15
2025-03-09 09:21:20,403 [INFO]: 	index_param: efSearch=220
2025-03-09 09:21:20,403 [INFO]: 	index_path: knn.index
2025-03-09 09:21:20,403 [INFO]: 	size in bytes: 997098850
2025-03-09 09:21:20,403 [INFO]: 	avg_search_speed_ms: 8.891148068424728
2025-03-09 09:21:20,403 [INFO]: 	99p_search_speed_ms: 17.016319911926985
2025-03-09 09:21:20,403 [INFO]: 	reconstruction error %: 0.0
2025-03-09 09:21:20,403 [INFO]: 	nb vectors: 5068
2025-03-09 09:21:20,403 [INFO]: 	vectors dimension: 49152
2025-03-09 09:21:20,403 [INFO]: 	compression ratio: 0.9993084878194374
2025-03-09 09:21:20,403 [INFO]: }
2025-03-09 09:21:20,403 [INFO]: 	>>> Finished "Creating the index" in 72.1817 secs
2025-03-09 09:21:20,403 [INFO]: >>> Finished "Launching the whole pipeline" in 72.2073 secs
2025-03-09 09:21:21: [retrieval_preprocessing] calculating distances ...
2025-03-09 09:21:22: [retrieval_preprocessing] finished and saved retrieval indices for episode 90210 [episode count 11/20]
[retrieval_preprocessing] for episode 34917 [episode count 12/20], we have num_retrieval=np.int64(5109) num_query=np.int64(252)
2025-03-09 09:21:24,614 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-09 09:21:25,267 [INFO]: Launching the whole pipeline 03/09/2025, 09:21:25
2025-03-09 09:21:25,268 [INFO]: Reading total number of vectors and dimension 03/09/2025, 09:21:25
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1365.33it/s]
2025-03-09 09:21:25,292 [INFO]: There are 5109 embeddings of dim 49152
2025-03-09 09:21:25,293 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0250 secs
2025-03-09 09:21:25,293 [INFO]: 	Compute estimated construction time of the index 03/09/2025, 09:21:25
2025-03-09 09:21:25,293 [INFO]: 		-> Train: 16.7 minutes
2025-03-09 09:21:25,293 [INFO]: 		-> Add: 2.8 seconds
2025-03-09 09:21:25,293 [INFO]: 		Total: 16.7 minutes
2025-03-09 09:21:25,293 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0001 secs
2025-03-09 09:21:25,293 [INFO]: 	Checking that your have enough memory available to create the index 03/09/2025, 09:21:25
2025-03-09 09:21:25,293 [INFO]: 1.0GB of memory will be needed to build the index (more might be used if you have more)
2025-03-09 09:21:25,293 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0001 secs
2025-03-09 09:21:25,293 [INFO]: 	Selecting most promising index types given data characteristics 03/09/2025, 09:21:25
2025-03-09 09:21:25,293 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-09 09:21:25,293 [INFO]: 	Creating the index 03/09/2025, 09:21:25
2025-03-09 09:21:25,293 [INFO]: 		-> Instanciate the index HNSW15 03/09/2025, 09:21:25
2025-03-09 09:21:25,294 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0011 secs
2025-03-09 09:21:25,294 [INFO]: 		-> Adding the vectors to the index 03/09/2025, 09:21:25
2025-03-09 09:21:25,294 [INFO]: The memory available for adding the vectors is 49.1GB(total available - used by the index)
2025-03-09 09:21:25,294 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/22 [00:00<?, ?it/s]  5%|▍         | 1/22 [00:00<00:04,  4.94it/s] 14%|█▎        | 3/22 [00:00<00:02,  8.07it/s] 23%|██▎       | 5/22 [00:00<00:01,  9.21it/s] 32%|███▏      | 7/22 [00:00<00:01,  9.78it/s] 41%|████      | 9/22 [00:00<00:01, 10.07it/s] 50%|█████     | 11/22 [00:01<00:01, 10.20it/s] 59%|█████▉    | 13/22 [00:01<00:00, 10.15it/s] 68%|██████▊   | 15/22 [00:01<00:00, 10.22it/s] 77%|███████▋  | 17/22 [00:01<00:00, 10.49it/s] 86%|████████▋ | 19/22 [00:01<00:00, 10.88it/s] 95%|█████████▌| 21/22 [00:05<00:00,  1.53it/s]100%|██████████| 22/22 [00:06<00:00,  1.52it/s]100%|██████████| 22/22 [00:06<00:00,  3.44it/s]
2025-03-09 09:21:31,701 [INFO]: 	Computing best hyperparameters for index knn.index 03/09/2025, 09:21:31
2025-03-09 09:22:15,146 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 43.4444 secs
2025-03-09 09:22:15,146 [INFO]: The best hyperparameters are: efSearch=226
2025-03-09 09:22:15,146 [INFO]: 	Compute fast metrics 03/09/2025, 09:22:15
  0%|          | 0/4 [00:00<?, ?it/s] 25%|██▌       | 1/4 [00:00<00:00,  5.11it/s] 50%|█████     | 2/4 [00:00<00:00,  5.48it/s] 75%|███████▌  | 3/4 [00:00<00:00,  5.59it/s]
2025-03-09 09:22:35,549 [INFO]: 	>>> Finished "Compute fast metrics" in 20.4031 secs
2025-03-09 09:22:35,549 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 70.2550 secs
2025-03-09 09:22:35,549 [INFO]: {
2025-03-09 09:22:35,549 [INFO]: 	index_key: HNSW15
2025-03-09 09:22:35,549 [INFO]: 	index_param: efSearch=226
2025-03-09 09:22:35,549 [INFO]: 	index_path: knn.index
2025-03-09 09:22:35,549 [INFO]: 	size in bytes: 1005165370
2025-03-09 09:22:35,549 [INFO]: 	avg_search_speed_ms: 9.343968473252989
2025-03-09 09:22:35,550 [INFO]: 	99p_search_speed_ms: 14.655934954062099
2025-03-09 09:22:35,550 [INFO]: 	reconstruction error %: 0.0
2025-03-09 09:22:35,550 [INFO]: 	nb vectors: 5109
2025-03-09 09:22:35,550 [INFO]: 	vectors dimension: 49152
2025-03-09 09:22:35,550 [INFO]: 	compression ratio: 0.999308473987718
2025-03-09 09:22:35,550 [INFO]: }
2025-03-09 09:22:35,550 [INFO]: 	>>> Finished "Creating the index" in 70.2564 secs
2025-03-09 09:22:35,550 [INFO]: >>> Finished "Launching the whole pipeline" in 70.2820 secs
2025-03-09 09:22:36: [retrieval_preprocessing] calculating distances ...
2025-03-09 09:22:37: [retrieval_preprocessing] finished and saved retrieval indices for episode 34917 [episode count 12/20]
[retrieval_preprocessing] for episode 26727 [episode count 13/20], we have num_retrieval=np.int64(5159) num_query=np.int64(202)
2025-03-09 09:22:38,789 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-09 09:22:39,548 [INFO]: Launching the whole pipeline 03/09/2025, 09:22:39
2025-03-09 09:22:39,548 [INFO]: Reading total number of vectors and dimension 03/09/2025, 09:22:39
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1791.67it/s]
2025-03-09 09:22:39,573 [INFO]: There are 5159 embeddings of dim 49152
2025-03-09 09:22:39,573 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0253 secs
2025-03-09 09:22:39,573 [INFO]: 	Compute estimated construction time of the index 03/09/2025, 09:22:39
2025-03-09 09:22:39,573 [INFO]: 		-> Train: 16.7 minutes
2025-03-09 09:22:39,573 [INFO]: 		-> Add: 2.8 seconds
2025-03-09 09:22:39,574 [INFO]: 		Total: 16.7 minutes
2025-03-09 09:22:39,574 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0001 secs
2025-03-09 09:22:39,574 [INFO]: 	Checking that your have enough memory available to create the index 03/09/2025, 09:22:39
2025-03-09 09:22:39,574 [INFO]: 1.0GB of memory will be needed to build the index (more might be used if you have more)
2025-03-09 09:22:39,574 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0002 secs
2025-03-09 09:22:39,574 [INFO]: 	Selecting most promising index types given data characteristics 03/09/2025, 09:22:39
2025-03-09 09:22:39,574 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-09 09:22:39,574 [INFO]: 	Creating the index 03/09/2025, 09:22:39
2025-03-09 09:22:39,574 [INFO]: 		-> Instanciate the index HNSW15 03/09/2025, 09:22:39
2025-03-09 09:22:39,575 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0010 secs
2025-03-09 09:22:39,575 [INFO]: 		-> Adding the vectors to the index 03/09/2025, 09:22:39
2025-03-09 09:22:39,575 [INFO]: The memory available for adding the vectors is 49.1GB(total available - used by the index)
2025-03-09 09:22:39,575 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/22 [00:00<?, ?it/s]  5%|▍         | 1/22 [00:00<00:03,  5.73it/s] 14%|█▎        | 3/22 [00:00<00:02,  8.94it/s] 23%|██▎       | 5/22 [00:00<00:01, 11.55it/s] 32%|███▏      | 7/22 [00:00<00:01, 13.34it/s] 41%|████      | 9/22 [00:00<00:00, 14.25it/s] 50%|█████     | 11/22 [00:00<00:00, 14.26it/s] 59%|█████▉    | 13/22 [00:00<00:00, 14.55it/s] 68%|██████▊   | 15/22 [00:01<00:00, 12.70it/s] 77%|███████▋  | 17/22 [00:01<00:00, 11.98it/s] 86%|████████▋ | 19/22 [00:01<00:00, 11.92it/s] 95%|█████████▌| 21/22 [00:06<00:00,  1.32it/s]100%|██████████| 22/22 [00:07<00:00,  1.21it/s]100%|██████████| 22/22 [00:07<00:00,  3.04it/s]
2025-03-09 09:22:46,818 [INFO]: 	Computing best hyperparameters for index knn.index 03/09/2025, 09:22:46
2025-03-09 09:23:31,037 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 44.2182 secs
2025-03-09 09:23:31,037 [INFO]: The best hyperparameters are: efSearch=234
2025-03-09 09:23:31,037 [INFO]: 	Compute fast metrics 03/09/2025, 09:23:31
  0%|          | 0/4 [00:00<?, ?it/s] 25%|██▌       | 1/4 [00:00<00:00,  4.84it/s] 50%|█████     | 2/4 [00:00<00:00,  6.27it/s] 75%|███████▌  | 3/4 [00:00<00:00,  7.04it/s] 75%|███████▌  | 3/4 [00:00<00:00,  5.25it/s]
2025-03-09 09:23:49,129 [INFO]: 	>>> Finished "Compute fast metrics" in 18.0921 secs
2025-03-09 09:23:49,129 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 69.5543 secs
2025-03-09 09:23:49,129 [INFO]: {
2025-03-09 09:23:49,130 [INFO]: 	index_key: HNSW15
2025-03-09 09:23:49,130 [INFO]: 	index_param: efSearch=234
2025-03-09 09:23:49,130 [INFO]: 	index_path: knn.index
2025-03-09 09:23:49,130 [INFO]: 	size in bytes: 1015002550
2025-03-09 09:23:49,130 [INFO]: 	avg_search_speed_ms: 10.046210765707583
2025-03-09 09:23:49,130 [INFO]: 	99p_search_speed_ms: 17.524551837705072
2025-03-09 09:23:49,130 [INFO]: 	reconstruction error %: 0.0
2025-03-09 09:23:49,130 [INFO]: 	nb vectors: 5159
2025-03-09 09:23:49,130 [INFO]: 	vectors dimension: 49152
2025-03-09 09:23:49,130 [INFO]: 	compression ratio: 0.999308496318556
2025-03-09 09:23:49,130 [INFO]: }
2025-03-09 09:23:49,130 [INFO]: 	>>> Finished "Creating the index" in 69.5558 secs
2025-03-09 09:23:49,130 [INFO]: >>> Finished "Launching the whole pipeline" in 69.5817 secs
2025-03-09 09:23:50: [retrieval_preprocessing] calculating distances ...
2025-03-09 09:23:51: [retrieval_preprocessing] finished and saved retrieval indices for episode 26727 [episode count 13/20]
[retrieval_preprocessing] for episode 83567 [episode count 14/20], we have num_retrieval=np.int64(5106) num_query=np.int64(255)
2025-03-09 09:23:52,680 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-09 09:23:53,433 [INFO]: Launching the whole pipeline 03/09/2025, 09:23:53
2025-03-09 09:23:53,433 [INFO]: Reading total number of vectors and dimension 03/09/2025, 09:23:53
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 2078.45it/s]
2025-03-09 09:23:53,459 [INFO]: There are 5106 embeddings of dim 49152
2025-03-09 09:23:53,459 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0260 secs
2025-03-09 09:23:53,459 [INFO]: 	Compute estimated construction time of the index 03/09/2025, 09:23:53
2025-03-09 09:23:53,459 [INFO]: 		-> Train: 16.7 minutes
2025-03-09 09:23:53,459 [INFO]: 		-> Add: 2.8 seconds
2025-03-09 09:23:53,459 [INFO]: 		Total: 16.7 minutes
2025-03-09 09:23:53,459 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0001 secs
2025-03-09 09:23:53,459 [INFO]: 	Checking that your have enough memory available to create the index 03/09/2025, 09:23:53
2025-03-09 09:23:53,459 [INFO]: 1.0GB of memory will be needed to build the index (more might be used if you have more)
2025-03-09 09:23:53,459 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0002 secs
2025-03-09 09:23:53,460 [INFO]: 	Selecting most promising index types given data characteristics 03/09/2025, 09:23:53
2025-03-09 09:23:53,460 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-09 09:23:53,460 [INFO]: 	Creating the index 03/09/2025, 09:23:53
2025-03-09 09:23:53,460 [INFO]: 		-> Instanciate the index HNSW15 03/09/2025, 09:23:53
2025-03-09 09:23:53,460 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0008 secs
2025-03-09 09:23:53,461 [INFO]: 		-> Adding the vectors to the index 03/09/2025, 09:23:53
2025-03-09 09:23:53,461 [INFO]: The memory available for adding the vectors is 49.1GB(total available - used by the index)
2025-03-09 09:23:53,461 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/22 [00:00<?, ?it/s]  5%|▍         | 1/22 [00:00<00:04,  5.21it/s] 14%|█▎        | 3/22 [00:00<00:02,  8.62it/s] 23%|██▎       | 5/22 [00:00<00:01, 10.42it/s] 32%|███▏      | 7/22 [00:00<00:01, 11.36it/s] 41%|████      | 9/22 [00:00<00:01, 11.78it/s] 50%|█████     | 11/22 [00:01<00:00, 11.99it/s] 59%|█████▉    | 13/22 [00:01<00:00, 12.38it/s] 68%|██████▊   | 15/22 [00:01<00:00, 12.56it/s] 77%|███████▋  | 17/22 [00:01<00:00, 12.83it/s] 86%|████████▋ | 19/22 [00:01<00:00, 13.05it/s] 95%|█████████▌| 21/22 [00:05<00:00,  1.61it/s]100%|██████████| 22/22 [00:06<00:00,  1.57it/s]100%|██████████| 22/22 [00:06<00:00,  3.66it/s]
2025-03-09 09:23:59,472 [INFO]: 	Computing best hyperparameters for index knn.index 03/09/2025, 09:23:59
2025-03-09 09:24:42,456 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 42.9833 secs
2025-03-09 09:24:42,456 [INFO]: The best hyperparameters are: efSearch=238
2025-03-09 09:24:42,456 [INFO]: 	Compute fast metrics 03/09/2025, 09:24:42
  0%|          | 0/4 [00:00<?, ?it/s] 25%|██▌       | 1/4 [00:00<00:00,  4.84it/s] 50%|█████     | 2/4 [00:00<00:00,  6.50it/s] 75%|███████▌  | 3/4 [00:00<00:00,  7.45it/s] 75%|███████▌  | 3/4 [00:00<00:00,  5.43it/s]
2025-03-09 09:25:04,054 [INFO]: 	>>> Finished "Compute fast metrics" in 21.5970 secs
2025-03-09 09:25:04,054 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 70.5934 secs
2025-03-09 09:25:04,054 [INFO]: {
2025-03-09 09:25:04,054 [INFO]: 	index_key: HNSW15
2025-03-09 09:25:04,054 [INFO]: 	index_param: efSearch=238
2025-03-09 09:25:04,054 [INFO]: 	index_path: knn.index
2025-03-09 09:25:04,054 [INFO]: 	size in bytes: 1004575150
2025-03-09 09:25:04,054 [INFO]: 	avg_search_speed_ms: 10.22361945965592
2025-03-09 09:25:04,054 [INFO]: 	99p_search_speed_ms: 19.849400662351407
2025-03-09 09:25:04,054 [INFO]: 	reconstruction error %: 0.0
2025-03-09 09:25:04,054 [INFO]: 	nb vectors: 5106
2025-03-09 09:25:04,054 [INFO]: 	vectors dimension: 49152
2025-03-09 09:25:04,054 [INFO]: 	compression ratio: 0.9993084618905813
2025-03-09 09:25:04,054 [INFO]: }
2025-03-09 09:25:04,054 [INFO]: 	>>> Finished "Creating the index" in 70.5946 secs
2025-03-09 09:25:04,054 [INFO]: >>> Finished "Launching the whole pipeline" in 70.6212 secs
2025-03-09 09:25:05: [retrieval_preprocessing] calculating distances ...
2025-03-09 09:25:06: [retrieval_preprocessing] finished and saved retrieval indices for episode 83567 [episode count 14/20]
[retrieval_preprocessing] for episode 4231 [episode count 15/20], we have num_retrieval=np.int64(5110) num_query=np.int64(251)
2025-03-09 09:25:08,431 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-09 09:25:09,159 [INFO]: Launching the whole pipeline 03/09/2025, 09:25:09
2025-03-09 09:25:09,159 [INFO]: Reading total number of vectors and dimension 03/09/2025, 09:25:09
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1172.58it/s]
2025-03-09 09:25:09,186 [INFO]: There are 5110 embeddings of dim 49152
2025-03-09 09:25:09,186 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0271 secs
2025-03-09 09:25:09,186 [INFO]: 	Compute estimated construction time of the index 03/09/2025, 09:25:09
2025-03-09 09:25:09,186 [INFO]: 		-> Train: 16.7 minutes
2025-03-09 09:25:09,186 [INFO]: 		-> Add: 2.8 seconds
2025-03-09 09:25:09,186 [INFO]: 		Total: 16.7 minutes
2025-03-09 09:25:09,186 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0001 secs
2025-03-09 09:25:09,186 [INFO]: 	Checking that your have enough memory available to create the index 03/09/2025, 09:25:09
2025-03-09 09:25:09,186 [INFO]: 1.0GB of memory will be needed to build the index (more might be used if you have more)
2025-03-09 09:25:09,186 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0002 secs
2025-03-09 09:25:09,186 [INFO]: 	Selecting most promising index types given data characteristics 03/09/2025, 09:25:09
2025-03-09 09:25:09,186 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-09 09:25:09,187 [INFO]: 	Creating the index 03/09/2025, 09:25:09
2025-03-09 09:25:09,187 [INFO]: 		-> Instanciate the index HNSW15 03/09/2025, 09:25:09
2025-03-09 09:25:09,188 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0012 secs
2025-03-09 09:25:09,188 [INFO]: 		-> Adding the vectors to the index 03/09/2025, 09:25:09
2025-03-09 09:25:09,188 [INFO]: The memory available for adding the vectors is 49.1GB(total available - used by the index)
2025-03-09 09:25:09,188 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/22 [00:00<?, ?it/s]  5%|▍         | 1/22 [00:00<00:03,  5.83it/s] 14%|█▎        | 3/22 [00:00<00:01,  9.60it/s] 23%|██▎       | 5/22 [00:00<00:01, 10.90it/s] 32%|███▏      | 7/22 [00:00<00:01, 11.44it/s] 41%|████      | 9/22 [00:00<00:01, 11.81it/s] 50%|█████     | 11/22 [00:00<00:00, 12.05it/s] 59%|█████▉    | 13/22 [00:01<00:00, 12.10it/s] 68%|██████▊   | 15/22 [00:01<00:00, 12.17it/s] 77%|███████▋  | 17/22 [00:01<00:00, 12.33it/s] 86%|████████▋ | 19/22 [00:01<00:00, 12.44it/s] 95%|█████████▌| 21/22 [00:05<00:00,  1.55it/s]100%|██████████| 22/22 [00:06<00:00,  1.52it/s]100%|██████████| 22/22 [00:06<00:00,  3.56it/s]
2025-03-09 09:25:15,369 [INFO]: 	Computing best hyperparameters for index knn.index 03/09/2025, 09:25:15
2025-03-09 09:26:00,518 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 45.1490 secs
2025-03-09 09:26:00,518 [INFO]: The best hyperparameters are: efSearch=223
2025-03-09 09:26:00,518 [INFO]: 	Compute fast metrics 03/09/2025, 09:26:00
  0%|          | 0/4 [00:00<?, ?it/s] 25%|██▌       | 1/4 [00:00<00:00,  6.02it/s] 50%|█████     | 2/4 [00:00<00:00,  7.52it/s] 75%|███████▌  | 3/4 [00:00<00:00,  8.29it/s] 75%|███████▌  | 3/4 [00:00<00:00,  6.30it/s]
2025-03-09 09:26:22,628 [INFO]: 	>>> Finished "Compute fast metrics" in 22.1101 secs
2025-03-09 09:26:22,629 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 73.4407 secs
2025-03-09 09:26:22,629 [INFO]: {
2025-03-09 09:26:22,629 [INFO]: 	index_key: HNSW15
2025-03-09 09:26:22,629 [INFO]: 	index_param: efSearch=223
2025-03-09 09:26:22,629 [INFO]: 	index_path: knn.index
2025-03-09 09:26:22,629 [INFO]: 	size in bytes: 1005362170
2025-03-09 09:26:22,629 [INFO]: 	avg_search_speed_ms: 9.645813393290716
2025-03-09 09:26:22,629 [INFO]: 	99p_search_speed_ms: 18.776193968951745
2025-03-09 09:26:22,629 [INFO]: 	reconstruction error %: 0.0
2025-03-09 09:26:22,629 [INFO]: 	nb vectors: 5110
2025-03-09 09:26:22,629 [INFO]: 	vectors dimension: 49152
2025-03-09 09:26:22,629 [INFO]: 	compression ratio: 0.9993084183782248
2025-03-09 09:26:22,629 [INFO]: }
2025-03-09 09:26:22,629 [INFO]: 	>>> Finished "Creating the index" in 73.4423 secs
2025-03-09 09:26:22,629 [INFO]: >>> Finished "Launching the whole pipeline" in 73.4700 secs
2025-03-09 09:26:23: [retrieval_preprocessing] calculating distances ...
2025-03-09 09:26:24: [retrieval_preprocessing] finished and saved retrieval indices for episode 4231 [episode count 15/20]
[retrieval_preprocessing] for episode 48778 [episode count 16/20], we have num_retrieval=np.int64(5124) num_query=np.int64(237)
2025-03-09 09:26:26,067 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-09 09:26:26,779 [INFO]: Launching the whole pipeline 03/09/2025, 09:26:26
2025-03-09 09:26:26,779 [INFO]: Reading total number of vectors and dimension 03/09/2025, 09:26:26
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 2225.09it/s]
2025-03-09 09:26:26,804 [INFO]: There are 5124 embeddings of dim 49152
2025-03-09 09:26:26,804 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0251 secs
2025-03-09 09:26:26,804 [INFO]: 	Compute estimated construction time of the index 03/09/2025, 09:26:26
2025-03-09 09:26:26,804 [INFO]: 		-> Train: 16.7 minutes
2025-03-09 09:26:26,804 [INFO]: 		-> Add: 2.8 seconds
2025-03-09 09:26:26,804 [INFO]: 		Total: 16.7 minutes
2025-03-09 09:26:26,804 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0001 secs
2025-03-09 09:26:26,804 [INFO]: 	Checking that your have enough memory available to create the index 03/09/2025, 09:26:26
2025-03-09 09:26:26,804 [INFO]: 1.0GB of memory will be needed to build the index (more might be used if you have more)
2025-03-09 09:26:26,804 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0001 secs
2025-03-09 09:26:26,804 [INFO]: 	Selecting most promising index types given data characteristics 03/09/2025, 09:26:26
2025-03-09 09:26:26,804 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-09 09:26:26,805 [INFO]: 	Creating the index 03/09/2025, 09:26:26
2025-03-09 09:26:26,805 [INFO]: 		-> Instanciate the index HNSW15 03/09/2025, 09:26:26
2025-03-09 09:26:26,806 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0010 secs
2025-03-09 09:26:26,806 [INFO]: 		-> Adding the vectors to the index 03/09/2025, 09:26:26
2025-03-09 09:26:26,806 [INFO]: The memory available for adding the vectors is 49.1GB(total available - used by the index)
2025-03-09 09:26:26,806 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/22 [00:00<?, ?it/s]  5%|▍         | 1/22 [00:00<00:03,  5.33it/s]  9%|▉         | 2/22 [00:00<00:02,  7.06it/s] 14%|█▎        | 3/22 [00:00<00:02,  7.75it/s] 18%|█▊        | 4/22 [00:00<00:02,  8.13it/s] 23%|██▎       | 5/22 [00:00<00:01,  8.58it/s] 27%|██▋       | 6/22 [00:00<00:01,  8.92it/s] 32%|███▏      | 7/22 [00:00<00:01,  9.01it/s] 36%|███▋      | 8/22 [00:00<00:01,  8.87it/s] 41%|████      | 9/22 [00:01<00:01,  8.79it/s] 45%|████▌     | 10/22 [00:01<00:01,  8.75it/s] 50%|█████     | 11/22 [00:01<00:01,  8.72it/s] 55%|█████▍    | 12/22 [00:01<00:01,  8.77it/s] 59%|█████▉    | 13/22 [00:01<00:01,  8.70it/s] 64%|██████▎   | 14/22 [00:01<00:00,  8.61it/s] 68%|██████▊   | 15/22 [00:01<00:00,  8.52it/s] 77%|███████▋  | 17/22 [00:01<00:00,  9.48it/s] 86%|████████▋ | 19/22 [00:02<00:00, 10.15it/s] 95%|█████████▌| 21/22 [00:06<00:00,  1.25it/s]100%|██████████| 22/22 [00:06<00:00,  1.26it/s]100%|██████████| 22/22 [00:06<00:00,  3.15it/s]
2025-03-09 09:26:33,798 [INFO]: 	Computing best hyperparameters for index knn.index 03/09/2025, 09:26:33
2025-03-09 09:27:17,209 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 43.4102 secs
2025-03-09 09:27:17,209 [INFO]: The best hyperparameters are: efSearch=239
2025-03-09 09:27:17,209 [INFO]: 	Compute fast metrics 03/09/2025, 09:27:17
  0%|          | 0/4 [00:00<?, ?it/s] 25%|██▌       | 1/4 [00:00<00:00,  5.50it/s] 75%|███████▌  | 3/4 [00:00<00:00,  8.92it/s] 75%|███████▌  | 3/4 [00:00<00:00,  6.84it/s]
2025-03-09 09:27:31,864 [INFO]: 	>>> Finished "Compute fast metrics" in 14.6556 secs
2025-03-09 09:27:31,865 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 65.0590 secs
2025-03-09 09:27:31,865 [INFO]: {
2025-03-09 09:27:31,865 [INFO]: 	index_key: HNSW15
2025-03-09 09:27:31,865 [INFO]: 	index_param: efSearch=239
2025-03-09 09:27:31,865 [INFO]: 	index_path: knn.index
2025-03-09 09:27:31,865 [INFO]: 	size in bytes: 1008116590
2025-03-09 09:27:31,865 [INFO]: 	avg_search_speed_ms: 9.45954303263335
2025-03-09 09:27:31,865 [INFO]: 	99p_search_speed_ms: 16.981747839599862
2025-03-09 09:27:31,865 [INFO]: 	reconstruction error %: 0.0
2025-03-09 09:27:31,865 [INFO]: 	nb vectors: 5124
2025-03-09 09:27:31,865 [INFO]: 	vectors dimension: 49152
2025-03-09 09:27:31,865 [INFO]: 	compression ratio: 0.999308415309384
2025-03-09 09:27:31,865 [INFO]: }
2025-03-09 09:27:31,865 [INFO]: 	>>> Finished "Creating the index" in 65.0605 secs
2025-03-09 09:27:31,865 [INFO]: >>> Finished "Launching the whole pipeline" in 65.0861 secs
2025-03-09 09:27:33: [retrieval_preprocessing] calculating distances ...
2025-03-09 09:27:34: [retrieval_preprocessing] finished and saved retrieval indices for episode 48778 [episode count 16/20]
[retrieval_preprocessing] for episode 52894 [episode count 17/20], we have num_retrieval=np.int64(5171) num_query=np.int64(190)
2025-03-09 09:27:35,242 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-09 09:27:36,286 [INFO]: Launching the whole pipeline 03/09/2025, 09:27:36
2025-03-09 09:27:36,286 [INFO]: Reading total number of vectors and dimension 03/09/2025, 09:27:36
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1181.16it/s]
2025-03-09 09:27:36,486 [INFO]: There are 5171 embeddings of dim 49152
2025-03-09 09:27:36,486 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.2002 secs
2025-03-09 09:27:36,486 [INFO]: 	Compute estimated construction time of the index 03/09/2025, 09:27:36
2025-03-09 09:27:36,486 [INFO]: 		-> Train: 16.7 minutes
2025-03-09 09:27:36,486 [INFO]: 		-> Add: 2.8 seconds
2025-03-09 09:27:36,486 [INFO]: 		Total: 16.7 minutes
2025-03-09 09:27:36,487 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0002 secs
2025-03-09 09:27:36,487 [INFO]: 	Checking that your have enough memory available to create the index 03/09/2025, 09:27:36
2025-03-09 09:27:36,487 [INFO]: 1.0GB of memory will be needed to build the index (more might be used if you have more)
2025-03-09 09:27:36,487 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0005 secs
2025-03-09 09:27:36,487 [INFO]: 	Selecting most promising index types given data characteristics 03/09/2025, 09:27:36
2025-03-09 09:27:36,487 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-09 09:27:36,487 [INFO]: 	Creating the index 03/09/2025, 09:27:36
2025-03-09 09:27:36,487 [INFO]: 		-> Instanciate the index HNSW15 03/09/2025, 09:27:36
2025-03-09 09:27:36,490 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0021 secs
2025-03-09 09:27:36,490 [INFO]: 		-> Adding the vectors to the index 03/09/2025, 09:27:36
2025-03-09 09:27:36,490 [INFO]: The memory available for adding the vectors is 49.1GB(total available - used by the index)
2025-03-09 09:27:36,490 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/22 [00:00<?, ?it/s]  5%|▍         | 1/22 [00:00<00:02,  8.27it/s] 27%|██▋       | 6/22 [00:00<00:00, 30.38it/s] 50%|█████     | 11/22 [00:00<00:00, 38.42it/s] 68%|██████▊   | 15/22 [00:00<00:00, 38.64it/s] 91%|█████████ | 20/22 [00:00<00:00, 40.60it/s]100%|██████████| 22/22 [00:05<00:00,  3.84it/s]
2025-03-09 09:27:42,237 [INFO]: 	Computing best hyperparameters for index knn.index 03/09/2025, 09:27:42
2025-03-09 09:28:26,769 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 44.5316 secs
2025-03-09 09:28:26,769 [INFO]: The best hyperparameters are: efSearch=215
2025-03-09 09:28:26,770 [INFO]: 	Compute fast metrics 03/09/2025, 09:28:26
  0%|          | 0/4 [00:00<?, ?it/s] 25%|██▌       | 1/4 [00:00<00:00,  5.65it/s] 50%|█████     | 2/4 [00:00<00:00,  6.95it/s] 75%|███████▌  | 3/4 [00:00<00:00,  7.59it/s] 75%|███████▌  | 3/4 [00:00<00:00,  5.79it/s]
2025-03-09 09:28:44,322 [INFO]: 	>>> Finished "Compute fast metrics" in 17.5525 secs
2025-03-09 09:28:44,323 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 67.8328 secs
2025-03-09 09:28:44,323 [INFO]: {
2025-03-09 09:28:44,323 [INFO]: 	index_key: HNSW15
2025-03-09 09:28:44,323 [INFO]: 	index_param: efSearch=215
2025-03-09 09:28:44,323 [INFO]: 	index_path: knn.index
2025-03-09 09:28:44,323 [INFO]: 	size in bytes: 1017363550
2025-03-09 09:28:44,323 [INFO]: 	avg_search_speed_ms: 9.927635813361292
2025-03-09 09:28:44,323 [INFO]: 	99p_search_speed_ms: 20.256894659250968
2025-03-09 09:28:44,323 [INFO]: 	reconstruction error %: 0.0
2025-03-09 09:28:44,323 [INFO]: 	nb vectors: 5171
2025-03-09 09:28:44,323 [INFO]: 	vectors dimension: 49152
2025-03-09 09:28:44,323 [INFO]: 	compression ratio: 0.9993084261766603
2025-03-09 09:28:44,323 [INFO]: }
2025-03-09 09:28:44,323 [INFO]: 	>>> Finished "Creating the index" in 67.8357 secs
2025-03-09 09:28:44,323 [INFO]: >>> Finished "Launching the whole pipeline" in 68.0374 secs
2025-03-09 09:28:45: [retrieval_preprocessing] calculating distances ...
2025-03-09 09:28:45: [retrieval_preprocessing] finished and saved retrieval indices for episode 52894 [episode count 17/20]
[retrieval_preprocessing] for episode 21151 [episode count 18/20], we have num_retrieval=np.int64(4901) num_query=np.int64(460)
2025-03-09 09:28:47,298 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-09 09:28:48,237 [INFO]: Launching the whole pipeline 03/09/2025, 09:28:48
2025-03-09 09:28:48,237 [INFO]: Reading total number of vectors and dimension 03/09/2025, 09:28:48
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1239.09it/s]
2025-03-09 09:28:48,264 [INFO]: There are 4901 embeddings of dim 49152
2025-03-09 09:28:48,264 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0274 secs
2025-03-09 09:28:48,264 [INFO]: 	Compute estimated construction time of the index 03/09/2025, 09:28:48
2025-03-09 09:28:48,265 [INFO]: 		-> Train: 16.7 minutes
2025-03-09 09:28:48,265 [INFO]: 		-> Add: 2.7 seconds
2025-03-09 09:28:48,265 [INFO]: 		Total: 16.7 minutes
2025-03-09 09:28:48,265 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0001 secs
2025-03-09 09:28:48,265 [INFO]: 	Checking that your have enough memory available to create the index 03/09/2025, 09:28:48
2025-03-09 09:28:48,265 [INFO]: 1011.4MB of memory will be needed to build the index (more might be used if you have more)
2025-03-09 09:28:48,265 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0001 secs
2025-03-09 09:28:48,265 [INFO]: 	Selecting most promising index types given data characteristics 03/09/2025, 09:28:48
2025-03-09 09:28:48,265 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-09 09:28:48,265 [INFO]: 	Creating the index 03/09/2025, 09:28:48
2025-03-09 09:28:48,265 [INFO]: 		-> Instanciate the index HNSW15 03/09/2025, 09:28:48
2025-03-09 09:28:48,266 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0009 secs
2025-03-09 09:28:48,266 [INFO]: 		-> Adding the vectors to the index 03/09/2025, 09:28:48
2025-03-09 09:28:48,266 [INFO]: The memory available for adding the vectors is 49.1GB(total available - used by the index)
2025-03-09 09:28:48,266 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/20 [00:00<?, ?it/s]  5%|▌         | 1/20 [00:00<00:02,  7.59it/s] 15%|█▌        | 3/20 [00:00<00:01, 10.88it/s] 25%|██▌       | 5/20 [00:00<00:01, 12.12it/s] 35%|███▌      | 7/20 [00:00<00:01, 12.45it/s] 45%|████▌     | 9/20 [00:00<00:00, 12.84it/s] 55%|█████▌    | 11/20 [00:00<00:00, 14.05it/s] 65%|██████▌   | 13/20 [00:00<00:00, 14.69it/s] 75%|███████▌  | 15/20 [00:01<00:00, 15.73it/s] 85%|████████▌ | 17/20 [00:01<00:00, 16.44it/s] 95%|█████████▌| 19/20 [00:01<00:00, 17.15it/s]100%|██████████| 20/20 [00:04<00:00,  4.50it/s]
2025-03-09 09:28:52,718 [INFO]: 	Computing best hyperparameters for index knn.index 03/09/2025, 09:28:52
2025-03-09 09:29:34,159 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 41.4398 secs
2025-03-09 09:29:34,159 [INFO]: The best hyperparameters are: efSearch=198
2025-03-09 09:29:34,159 [INFO]: 	Compute fast metrics 03/09/2025, 09:29:34
  0%|          | 0/4 [00:00<?, ?it/s] 25%|██▌       | 1/4 [00:00<00:00,  5.60it/s] 50%|█████     | 2/4 [00:00<00:00,  6.86it/s] 75%|███████▌  | 3/4 [00:00<00:00,  7.48it/s] 75%|███████▌  | 3/4 [00:00<00:00,  5.70it/s]
2025-03-09 09:29:51,103 [INFO]: 	>>> Finished "Compute fast metrics" in 16.9434 secs
2025-03-09 09:29:51,106 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 62.8397 secs
2025-03-09 09:29:51,106 [INFO]: {
2025-03-09 09:29:51,106 [INFO]: 	index_key: HNSW15
2025-03-09 09:29:51,106 [INFO]: 	index_param: efSearch=198
2025-03-09 09:29:51,106 [INFO]: 	index_path: knn.index
2025-03-09 09:29:51,106 [INFO]: 	size in bytes: 964242310
2025-03-09 09:29:51,106 [INFO]: 	avg_search_speed_ms: 8.770361027410743
2025-03-09 09:29:51,106 [INFO]: 	99p_search_speed_ms: 14.036301414016606
2025-03-09 09:29:51,106 [INFO]: 	reconstruction error %: 0.0
2025-03-09 09:29:51,106 [INFO]: 	nb vectors: 4901
2025-03-09 09:29:51,106 [INFO]: 	vectors dimension: 49152
2025-03-09 09:29:51,106 [INFO]: 	compression ratio: 0.9993087816277217
2025-03-09 09:29:51,106 [INFO]: }
2025-03-09 09:29:51,106 [INFO]: 	>>> Finished "Creating the index" in 62.8411 secs
2025-03-09 09:29:51,106 [INFO]: >>> Finished "Launching the whole pipeline" in 62.8690 secs
2025-03-09 09:29:52: [retrieval_preprocessing] calculating distances ...
2025-03-09 09:29:53: [retrieval_preprocessing] finished and saved retrieval indices for episode 21151 [episode count 18/20]
[retrieval_preprocessing] for episode 54431 [episode count 19/20], we have num_retrieval=np.int64(5135) num_query=np.int64(226)
2025-03-09 09:29:55,272 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-09 09:29:55,945 [INFO]: Launching the whole pipeline 03/09/2025, 09:29:55
2025-03-09 09:29:55,945 [INFO]: Reading total number of vectors and dimension 03/09/2025, 09:29:55
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1444.82it/s]
2025-03-09 09:29:55,971 [INFO]: There are 5135 embeddings of dim 49152
2025-03-09 09:29:55,971 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0265 secs
2025-03-09 09:29:55,972 [INFO]: 	Compute estimated construction time of the index 03/09/2025, 09:29:55
2025-03-09 09:29:55,972 [INFO]: 		-> Train: 16.7 minutes
2025-03-09 09:29:55,972 [INFO]: 		-> Add: 2.8 seconds
2025-03-09 09:29:55,972 [INFO]: 		Total: 16.7 minutes
2025-03-09 09:29:55,972 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0001 secs
2025-03-09 09:29:55,972 [INFO]: 	Checking that your have enough memory available to create the index 03/09/2025, 09:29:55
2025-03-09 09:29:55,972 [INFO]: 1.0GB of memory will be needed to build the index (more might be used if you have more)
2025-03-09 09:29:55,972 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0002 secs
2025-03-09 09:29:55,972 [INFO]: 	Selecting most promising index types given data characteristics 03/09/2025, 09:29:55
2025-03-09 09:29:55,972 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-09 09:29:55,972 [INFO]: 	Creating the index 03/09/2025, 09:29:55
2025-03-09 09:29:55,972 [INFO]: 		-> Instanciate the index HNSW15 03/09/2025, 09:29:55
2025-03-09 09:29:55,973 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0009 secs
2025-03-09 09:29:55,973 [INFO]: 		-> Adding the vectors to the index 03/09/2025, 09:29:55
2025-03-09 09:29:55,973 [INFO]: The memory available for adding the vectors is 49.1GB(total available - used by the index)
2025-03-09 09:29:55,973 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/22 [00:00<?, ?it/s]  5%|▍         | 1/22 [00:00<00:03,  5.56it/s] 14%|█▎        | 3/22 [00:00<00:02,  9.35it/s] 23%|██▎       | 5/22 [00:00<00:01, 10.76it/s] 32%|███▏      | 7/22 [00:00<00:01, 11.55it/s] 41%|████      | 9/22 [00:00<00:01, 11.93it/s] 50%|█████     | 11/22 [00:00<00:00, 12.20it/s] 59%|█████▉    | 13/22 [00:01<00:00, 12.38it/s] 68%|██████▊   | 15/22 [00:01<00:00, 12.47it/s] 77%|███████▋  | 17/22 [00:01<00:00, 12.54it/s] 86%|████████▋ | 19/22 [00:01<00:00, 12.62it/s] 95%|█████████▌| 21/22 [00:04<00:00,  1.76it/s]100%|██████████| 22/22 [00:05<00:00,  1.65it/s]100%|██████████| 22/22 [00:05<00:00,  3.85it/s]
2025-03-09 09:30:01,692 [INFO]: 	Computing best hyperparameters for index knn.index 03/09/2025, 09:30:01
2025-03-09 09:30:44,081 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 42.3897 secs
2025-03-09 09:30:44,082 [INFO]: The best hyperparameters are: efSearch=231
2025-03-09 09:30:44,082 [INFO]: 	Compute fast metrics 03/09/2025, 09:30:44
  0%|          | 0/4 [00:00<?, ?it/s] 25%|██▌       | 1/4 [00:00<00:00,  4.65it/s] 50%|█████     | 2/4 [00:00<00:00,  6.35it/s] 75%|███████▌  | 3/4 [00:00<00:00,  7.45it/s] 75%|███████▌  | 3/4 [00:00<00:00,  5.53it/s]
2025-03-09 09:31:06,372 [INFO]: 	>>> Finished "Compute fast metrics" in 22.2901 secs
2025-03-09 09:31:06,372 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 70.3991 secs
2025-03-09 09:31:06,372 [INFO]: {
2025-03-09 09:31:06,372 [INFO]: 	index_key: HNSW15
2025-03-09 09:31:06,372 [INFO]: 	index_param: efSearch=231
2025-03-09 09:31:06,372 [INFO]: 	index_path: knn.index
2025-03-09 09:31:06,372 [INFO]: 	size in bytes: 1010280730
2025-03-09 09:31:06,372 [INFO]: 	avg_search_speed_ms: 9.8879589044243
2025-03-09 09:31:06,372 [INFO]: 	99p_search_speed_ms: 18.022716930136085
2025-03-09 09:31:06,372 [INFO]: 	reconstruction error %: 0.0
2025-03-09 09:31:06,372 [INFO]: 	nb vectors: 5135
2025-03-09 09:31:06,372 [INFO]: 	vectors dimension: 49152
2025-03-09 09:31:06,372 [INFO]: 	compression ratio: 0.9993084595407457
2025-03-09 09:31:06,372 [INFO]: }
2025-03-09 09:31:06,372 [INFO]: 	>>> Finished "Creating the index" in 70.4004 secs
2025-03-09 09:31:06,372 [INFO]: >>> Finished "Launching the whole pipeline" in 70.4275 secs
2025-03-09 09:31:07: [retrieval_preprocessing] calculating distances ...
2025-03-09 09:31:08: [retrieval_preprocessing] finished and saved retrieval indices for episode 54431 [episode count 19/20]
2025-03-09 09:31:08: [retrieval_preprocessing] finished for (8702636502, 'lid') [chosen_id count 6/10]
2025-03-09 09:31:10: [retrieval_preprocessing] concatenated all embeddings and indices for 20 episodes for (8172596608, 'cup') [chosen_id count 7/10]
2025-03-09 09:31:10: [retrieval_preprocessing] we have num_total=2478 embedding_dim=49152
[retrieval_preprocessing] for episode 83970 [episode count 0/20], we have num_retrieval=np.int64(2381) num_query=np.int64(97)
2025-03-09 09:31:11,325 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-09 09:31:11,914 [INFO]: Launching the whole pipeline 03/09/2025, 09:31:11
2025-03-09 09:31:11,914 [INFO]: Reading total number of vectors and dimension 03/09/2025, 09:31:11
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1743.27it/s]
2025-03-09 09:31:11,940 [INFO]: There are 2381 embeddings of dim 49152
2025-03-09 09:31:11,940 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0264 secs
2025-03-09 09:31:11,940 [INFO]: 	Compute estimated construction time of the index 03/09/2025, 09:31:11
2025-03-09 09:31:11,940 [INFO]: 		-> Train: 16.7 minutes
2025-03-09 09:31:11,940 [INFO]: 		-> Add: 1.3 seconds
2025-03-09 09:31:11,940 [INFO]: 		Total: 16.7 minutes
2025-03-09 09:31:11,940 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0001 secs
2025-03-09 09:31:11,940 [INFO]: 	Checking that your have enough memory available to create the index 03/09/2025, 09:31:11
2025-03-09 09:31:11,940 [INFO]: 491.4MB of memory will be needed to build the index (more might be used if you have more)
2025-03-09 09:31:11,941 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0001 secs
2025-03-09 09:31:11,941 [INFO]: 	Selecting most promising index types given data characteristics 03/09/2025, 09:31:11
2025-03-09 09:31:11,941 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-09 09:31:11,941 [INFO]: 	Creating the index 03/09/2025, 09:31:11
2025-03-09 09:31:11,941 [INFO]: 		-> Instanciate the index HNSW15 03/09/2025, 09:31:11
2025-03-09 09:31:11,942 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0011 secs
2025-03-09 09:31:11,942 [INFO]: 		-> Adding the vectors to the index 03/09/2025, 09:31:11
2025-03-09 09:31:11,942 [INFO]: The memory available for adding the vectors is 49.6GB(total available - used by the index)
2025-03-09 09:31:11,942 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/10 [00:00<?, ?it/s] 10%|█         | 1/10 [00:00<00:01,  8.37it/s] 40%|████      | 4/10 [00:00<00:00, 18.33it/s] 70%|███████   | 7/10 [00:00<00:00, 18.96it/s] 90%|█████████ | 9/10 [00:00<00:00, 18.84it/s]100%|██████████| 10/10 [00:01<00:00,  5.01it/s]
2025-03-09 09:31:13,939 [INFO]: 	Computing best hyperparameters for index knn.index 03/09/2025, 09:31:13
2025-03-09 09:31:40,312 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 26.3719 secs
2025-03-09 09:31:40,312 [INFO]: The best hyperparameters are: efSearch=345
2025-03-09 09:31:40,312 [INFO]: 	Compute fast metrics 03/09/2025, 09:31:40
  0%|          | 0/4 [00:00<?, ?it/s] 25%|██▌       | 1/4 [00:00<00:00,  6.30it/s] 50%|█████     | 2/4 [00:00<00:00,  7.09it/s] 75%|███████▌  | 3/4 [00:00<00:00,  7.50it/s] 75%|███████▌  | 3/4 [00:00<00:00,  5.60it/s]
2025-03-09 09:31:56,871 [INFO]: 	>>> Finished "Compute fast metrics" in 16.5592 secs
2025-03-09 09:31:56,873 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 44.9310 secs
2025-03-09 09:31:56,873 [INFO]: {
2025-03-09 09:31:56,873 [INFO]: 	index_key: HNSW15
2025-03-09 09:31:56,873 [INFO]: 	index_param: efSearch=345
2025-03-09 09:31:56,873 [INFO]: 	index_path: knn.index
2025-03-09 09:31:56,873 [INFO]: 	size in bytes: 468447010
2025-03-09 09:31:56,873 [INFO]: 	avg_search_speed_ms: 8.694228523451349
2025-03-09 09:31:56,873 [INFO]: 	99p_search_speed_ms: 12.015394035261124
2025-03-09 09:31:56,873 [INFO]: 	reconstruction error %: 0.0
2025-03-09 09:31:56,873 [INFO]: 	nb vectors: 2381
2025-03-09 09:31:56,873 [INFO]: 	vectors dimension: 49152
2025-03-09 09:31:56,873 [INFO]: 	compression ratio: 0.9993097148810919
2025-03-09 09:31:56,873 [INFO]: }
2025-03-09 09:31:56,873 [INFO]: 	>>> Finished "Creating the index" in 44.9326 secs
2025-03-09 09:31:56,873 [INFO]: >>> Finished "Launching the whole pipeline" in 44.9597 secs
2025-03-09 09:31:57: [retrieval_preprocessing] calculating distances ...
2025-03-09 09:31:58: [retrieval_preprocessing] finished and saved retrieval indices for episode 83970 [episode count 0/20]
[retrieval_preprocessing] for episode 55044 [episode count 1/20], we have num_retrieval=np.int64(2355) num_query=np.int64(123)
2025-03-09 09:31:58,986 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-09 09:31:59,324 [INFO]: Launching the whole pipeline 03/09/2025, 09:31:59
2025-03-09 09:31:59,324 [INFO]: Reading total number of vectors and dimension 03/09/2025, 09:31:59
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1447.81it/s]
2025-03-09 09:31:59,350 [INFO]: There are 2355 embeddings of dim 49152
2025-03-09 09:31:59,350 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0258 secs
2025-03-09 09:31:59,350 [INFO]: 	Compute estimated construction time of the index 03/09/2025, 09:31:59
2025-03-09 09:31:59,350 [INFO]: 		-> Train: 16.7 minutes
2025-03-09 09:31:59,350 [INFO]: 		-> Add: 1.3 seconds
2025-03-09 09:31:59,350 [INFO]: 		Total: 16.7 minutes
2025-03-09 09:31:59,350 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0001 secs
2025-03-09 09:31:59,350 [INFO]: 	Checking that your have enough memory available to create the index 03/09/2025, 09:31:59
2025-03-09 09:31:59,350 [INFO]: 486.0MB of memory will be needed to build the index (more might be used if you have more)
2025-03-09 09:31:59,350 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0001 secs
2025-03-09 09:31:59,350 [INFO]: 	Selecting most promising index types given data characteristics 03/09/2025, 09:31:59
2025-03-09 09:31:59,350 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-09 09:31:59,350 [INFO]: 	Creating the index 03/09/2025, 09:31:59
2025-03-09 09:31:59,350 [INFO]: 		-> Instanciate the index HNSW15 03/09/2025, 09:31:59
2025-03-09 09:31:59,352 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0011 secs
2025-03-09 09:31:59,352 [INFO]: 		-> Adding the vectors to the index 03/09/2025, 09:31:59
2025-03-09 09:31:59,352 [INFO]: The memory available for adding the vectors is 49.6GB(total available - used by the index)
2025-03-09 09:31:59,352 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/10 [00:00<?, ?it/s] 10%|█         | 1/10 [00:00<00:01,  6.60it/s] 30%|███       | 3/10 [00:00<00:00, 10.22it/s] 50%|█████     | 5/10 [00:00<00:00, 11.24it/s] 70%|███████   | 7/10 [00:00<00:00, 11.61it/s] 90%|█████████ | 9/10 [00:00<00:00, 11.93it/s]100%|██████████| 10/10 [00:02<00:00,  4.35it/s]
2025-03-09 09:32:01,652 [INFO]: 	Computing best hyperparameters for index knn.index 03/09/2025, 09:32:01
2025-03-09 09:32:27,991 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 26.3389 secs
2025-03-09 09:32:27,991 [INFO]: The best hyperparameters are: efSearch=333
2025-03-09 09:32:27,991 [INFO]: 	Compute fast metrics 03/09/2025, 09:32:27
  0%|          | 0/4 [00:00<?, ?it/s] 25%|██▌       | 1/4 [00:00<00:00,  5.73it/s] 50%|█████     | 2/4 [00:00<00:00,  7.33it/s] 75%|███████▌  | 3/4 [00:00<00:00,  7.96it/s] 75%|███████▌  | 3/4 [00:00<00:00,  5.98it/s]
2025-03-09 09:32:42,160 [INFO]: 	>>> Finished "Compute fast metrics" in 14.1688 secs
2025-03-09 09:32:42,162 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 42.8100 secs
2025-03-09 09:32:42,162 [INFO]: {
2025-03-09 09:32:42,162 [INFO]: 	index_key: HNSW15
2025-03-09 09:32:42,162 [INFO]: 	index_param: efSearch=333
2025-03-09 09:32:42,162 [INFO]: 	index_path: knn.index
2025-03-09 09:32:42,162 [INFO]: 	size in bytes: 463331710
2025-03-09 09:32:42,162 [INFO]: 	avg_search_speed_ms: 9.518247814831296
2025-03-09 09:32:42,162 [INFO]: 	99p_search_speed_ms: 15.784453018568456
2025-03-09 09:32:42,162 [INFO]: 	reconstruction error %: 0.0
2025-03-09 09:32:42,162 [INFO]: 	nb vectors: 2355
2025-03-09 09:32:42,162 [INFO]: 	vectors dimension: 49152
2025-03-09 09:32:42,162 [INFO]: 	compression ratio: 0.9993096306747492
2025-03-09 09:32:42,162 [INFO]: }
2025-03-09 09:32:42,162 [INFO]: 	>>> Finished "Creating the index" in 42.8117 secs
2025-03-09 09:32:42,162 [INFO]: >>> Finished "Launching the whole pipeline" in 42.8381 secs
2025-03-09 09:32:42: [retrieval_preprocessing] calculating distances ...
2025-03-09 09:32:43: [retrieval_preprocessing] finished and saved retrieval indices for episode 55044 [episode count 1/20]
[retrieval_preprocessing] for episode 65540 [episode count 2/20], we have num_retrieval=np.int64(2307) num_query=np.int64(171)
2025-03-09 09:32:44,007 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-09 09:32:44,306 [INFO]: Launching the whole pipeline 03/09/2025, 09:32:44
2025-03-09 09:32:44,306 [INFO]: Reading total number of vectors and dimension 03/09/2025, 09:32:44
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1535.81it/s]
2025-03-09 09:32:44,344 [INFO]: There are 2307 embeddings of dim 49152
2025-03-09 09:32:44,344 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0377 secs
2025-03-09 09:32:44,344 [INFO]: 	Compute estimated construction time of the index 03/09/2025, 09:32:44
2025-03-09 09:32:44,344 [INFO]: 		-> Train: 16.7 minutes
2025-03-09 09:32:44,344 [INFO]: 		-> Add: 1.3 seconds
2025-03-09 09:32:44,345 [INFO]: 		Total: 16.7 minutes
2025-03-09 09:32:44,345 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0002 secs
2025-03-09 09:32:44,345 [INFO]: 	Checking that your have enough memory available to create the index 03/09/2025, 09:32:44
2025-03-09 09:32:44,345 [INFO]: 476.1MB of memory will be needed to build the index (more might be used if you have more)
2025-03-09 09:32:44,345 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0004 secs
2025-03-09 09:32:44,345 [INFO]: 	Selecting most promising index types given data characteristics 03/09/2025, 09:32:44
2025-03-09 09:32:44,345 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-09 09:32:44,345 [INFO]: 	Creating the index 03/09/2025, 09:32:44
2025-03-09 09:32:44,346 [INFO]: 		-> Instanciate the index HNSW15 03/09/2025, 09:32:44
2025-03-09 09:32:44,348 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0021 secs
2025-03-09 09:32:44,348 [INFO]: 		-> Adding the vectors to the index 03/09/2025, 09:32:44
2025-03-09 09:32:44,348 [INFO]: The memory available for adding the vectors is 49.6GB(total available - used by the index)
2025-03-09 09:32:44,348 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/10 [00:00<?, ?it/s] 10%|█         | 1/10 [00:00<00:01,  5.43it/s] 20%|██        | 2/10 [00:00<00:01,  7.09it/s] 30%|███       | 3/10 [00:00<00:00,  7.92it/s] 40%|████      | 4/10 [00:00<00:00,  8.31it/s] 50%|█████     | 5/10 [00:00<00:00,  8.39it/s] 60%|██████    | 6/10 [00:00<00:00,  8.63it/s] 70%|███████   | 7/10 [00:00<00:00,  8.70it/s] 80%|████████  | 8/10 [00:00<00:00,  8.74it/s]100%|██████████| 10/10 [00:02<00:00,  2.08it/s]100%|██████████| 10/10 [00:02<00:00,  3.66it/s]
2025-03-09 09:32:47,088 [INFO]: 	Computing best hyperparameters for index knn.index 03/09/2025, 09:32:47
2025-03-09 09:33:12,928 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 25.8401 secs
2025-03-09 09:33:12,928 [INFO]: The best hyperparameters are: efSearch=313
2025-03-09 09:33:12,928 [INFO]: 	Compute fast metrics 03/09/2025, 09:33:12
  0%|          | 0/4 [00:00<?, ?it/s] 25%|██▌       | 1/4 [00:00<00:00,  5.31it/s] 50%|█████     | 2/4 [00:00<00:00,  6.97it/s] 75%|███████▌  | 3/4 [00:00<00:00,  7.42it/s]
2025-03-09 09:33:27,147 [INFO]: 	>>> Finished "Compute fast metrics" in 14.2183 secs
2025-03-09 09:33:27,148 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 42.8004 secs
2025-03-09 09:33:27,149 [INFO]: {
2025-03-09 09:33:27,149 [INFO]: 	index_key: HNSW15
2025-03-09 09:33:27,149 [INFO]: 	index_param: efSearch=313
2025-03-09 09:33:27,149 [INFO]: 	index_path: knn.index
2025-03-09 09:33:27,149 [INFO]: 	size in bytes: 453888070
2025-03-09 09:33:27,149 [INFO]: 	avg_search_speed_ms: 9.486292471863555
2025-03-09 09:33:27,149 [INFO]: 	99p_search_speed_ms: 17.030860830564073
2025-03-09 09:33:27,149 [INFO]: 	reconstruction error %: 0.0
2025-03-09 09:33:27,149 [INFO]: 	nb vectors: 2307
2025-03-09 09:33:27,149 [INFO]: 	vectors dimension: 49152
2025-03-09 09:33:27,149 [INFO]: 	compression ratio: 0.999309490553475
2025-03-09 09:33:27,149 [INFO]: }
2025-03-09 09:33:27,149 [INFO]: 	>>> Finished "Creating the index" in 42.8032 secs
2025-03-09 09:33:27,149 [INFO]: >>> Finished "Launching the whole pipeline" in 42.8424 secs
2025-03-09 09:33:28: [retrieval_preprocessing] calculating distances ...
2025-03-09 09:33:28: [retrieval_preprocessing] finished and saved retrieval indices for episode 65540 [episode count 2/20]
[retrieval_preprocessing] for episode 39687 [episode count 3/20], we have num_retrieval=np.int64(2371) num_query=np.int64(107)
2025-03-09 09:33:29,314 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-09 09:33:29,623 [INFO]: Launching the whole pipeline 03/09/2025, 09:33:29
2025-03-09 09:33:29,623 [INFO]: Reading total number of vectors and dimension 03/09/2025, 09:33:29
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 2189.09it/s]
2025-03-09 09:33:29,647 [INFO]: There are 2371 embeddings of dim 49152
2025-03-09 09:33:29,647 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0243 secs
2025-03-09 09:33:29,647 [INFO]: 	Compute estimated construction time of the index 03/09/2025, 09:33:29
2025-03-09 09:33:29,647 [INFO]: 		-> Train: 16.7 minutes
2025-03-09 09:33:29,647 [INFO]: 		-> Add: 1.3 seconds
2025-03-09 09:33:29,647 [INFO]: 		Total: 16.7 minutes
2025-03-09 09:33:29,647 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0001 secs
2025-03-09 09:33:29,647 [INFO]: 	Checking that your have enough memory available to create the index 03/09/2025, 09:33:29
2025-03-09 09:33:29,647 [INFO]: 489.3MB of memory will be needed to build the index (more might be used if you have more)
2025-03-09 09:33:29,648 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0002 secs
2025-03-09 09:33:29,648 [INFO]: 	Selecting most promising index types given data characteristics 03/09/2025, 09:33:29
2025-03-09 09:33:29,648 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-09 09:33:29,648 [INFO]: 	Creating the index 03/09/2025, 09:33:29
2025-03-09 09:33:29,648 [INFO]: 		-> Instanciate the index HNSW15 03/09/2025, 09:33:29
2025-03-09 09:33:29,649 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0010 secs
2025-03-09 09:33:29,649 [INFO]: 		-> Adding the vectors to the index 03/09/2025, 09:33:29
2025-03-09 09:33:29,649 [INFO]: The memory available for adding the vectors is 49.6GB(total available - used by the index)
2025-03-09 09:33:29,649 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/10 [00:00<?, ?it/s] 10%|█         | 1/10 [00:00<00:01,  5.34it/s] 30%|███       | 3/10 [00:00<00:00,  8.05it/s] 50%|█████     | 5/10 [00:00<00:00,  8.73it/s] 60%|██████    | 6/10 [00:00<00:00,  8.80it/s] 70%|███████   | 7/10 [00:00<00:00,  8.81it/s] 80%|████████  | 8/10 [00:00<00:00,  8.95it/s] 90%|█████████ | 9/10 [00:01<00:00,  8.89it/s]100%|██████████| 10/10 [00:02<00:00,  1.72it/s]100%|██████████| 10/10 [00:02<00:00,  3.61it/s]
2025-03-09 09:33:32,426 [INFO]: 	Computing best hyperparameters for index knn.index 03/09/2025, 09:33:32
2025-03-09 09:33:56,701 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 24.2752 secs
2025-03-09 09:33:56,701 [INFO]: The best hyperparameters are: efSearch=329
2025-03-09 09:33:56,701 [INFO]: 	Compute fast metrics 03/09/2025, 09:33:56
  0%|          | 0/4 [00:00<?, ?it/s] 25%|██▌       | 1/4 [00:00<00:00,  8.53it/s] 75%|███████▌  | 3/4 [00:00<00:00, 11.16it/s]
2025-03-09 09:34:19,625 [INFO]: 	>>> Finished "Compute fast metrics" in 22.9232 secs
2025-03-09 09:34:19,626 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 49.9775 secs
2025-03-09 09:34:19,626 [INFO]: {
2025-03-09 09:34:19,626 [INFO]: 	index_key: HNSW15
2025-03-09 09:34:19,626 [INFO]: 	index_param: efSearch=329
2025-03-09 09:34:19,626 [INFO]: 	index_path: knn.index
2025-03-09 09:34:19,626 [INFO]: 	size in bytes: 466479610
2025-03-09 09:34:19,627 [INFO]: 	avg_search_speed_ms: 8.822065995303122
2025-03-09 09:34:19,627 [INFO]: 	99p_search_speed_ms: 12.249673102051023
2025-03-09 09:34:19,627 [INFO]: 	reconstruction error %: 0.0
2025-03-09 09:34:19,627 [INFO]: 	nb vectors: 2371
2025-03-09 09:34:19,627 [INFO]: 	vectors dimension: 49152
2025-03-09 09:34:19,627 [INFO]: 	compression ratio: 0.9993096332763612
2025-03-09 09:34:19,627 [INFO]: }
2025-03-09 09:34:19,627 [INFO]: 	>>> Finished "Creating the index" in 49.9789 secs
2025-03-09 09:34:19,627 [INFO]: >>> Finished "Launching the whole pipeline" in 50.0040 secs
2025-03-09 09:34:22: [retrieval_preprocessing] calculating distances ...
2025-03-09 09:34:22: [retrieval_preprocessing] finished and saved retrieval indices for episode 39687 [episode count 3/20]
[retrieval_preprocessing] for episode 53640 [episode count 4/20], we have num_retrieval=np.int64(2348) num_query=np.int64(130)
2025-03-09 09:34:24,045 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-09 09:34:24,382 [INFO]: Launching the whole pipeline 03/09/2025, 09:34:24
2025-03-09 09:34:24,382 [INFO]: Reading total number of vectors and dimension 03/09/2025, 09:34:24
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1264.87it/s]
2025-03-09 09:34:24,418 [INFO]: There are 2348 embeddings of dim 49152
2025-03-09 09:34:24,419 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0365 secs
2025-03-09 09:34:24,419 [INFO]: 	Compute estimated construction time of the index 03/09/2025, 09:34:24
2025-03-09 09:34:24,419 [INFO]: 		-> Train: 16.7 minutes
2025-03-09 09:34:24,419 [INFO]: 		-> Add: 1.3 seconds
2025-03-09 09:34:24,419 [INFO]: 		Total: 16.7 minutes
2025-03-09 09:34:24,419 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0003 secs
2025-03-09 09:34:24,419 [INFO]: 	Checking that your have enough memory available to create the index 03/09/2025, 09:34:24
2025-03-09 09:34:24,419 [INFO]: 484.6MB of memory will be needed to build the index (more might be used if you have more)
2025-03-09 09:34:24,419 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0003 secs
2025-03-09 09:34:24,420 [INFO]: 	Selecting most promising index types given data characteristics 03/09/2025, 09:34:24
2025-03-09 09:34:24,420 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-09 09:34:24,420 [INFO]: 	Creating the index 03/09/2025, 09:34:24
2025-03-09 09:34:24,420 [INFO]: 		-> Instanciate the index HNSW15 03/09/2025, 09:34:24
2025-03-09 09:34:24,422 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0022 secs
2025-03-09 09:34:24,422 [INFO]: 		-> Adding the vectors to the index 03/09/2025, 09:34:24
2025-03-09 09:34:24,422 [INFO]: The memory available for adding the vectors is 49.6GB(total available - used by the index)
2025-03-09 09:34:24,422 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/10 [00:00<?, ?it/s] 10%|█         | 1/10 [00:00<00:01,  8.34it/s] 30%|███       | 3/10 [00:00<00:00, 13.41it/s] 50%|█████     | 5/10 [00:00<00:00, 13.39it/s] 90%|█████████ | 9/10 [00:00<00:00, 21.71it/s]100%|██████████| 10/10 [00:02<00:00,  4.96it/s]
2025-03-09 09:34:26,444 [INFO]: 	Computing best hyperparameters for index knn.index 03/09/2025, 09:34:26
2025-03-09 09:34:57,778 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 31.3333 secs
2025-03-09 09:34:57,778 [INFO]: The best hyperparameters are: efSearch=280
2025-03-09 09:34:57,779 [INFO]: 	Compute fast metrics 03/09/2025, 09:34:57
  0%|          | 0/4 [00:00<?, ?it/s] 25%|██▌       | 1/4 [00:00<00:00,  8.95it/s] 75%|███████▌  | 3/4 [00:00<00:00, 17.99it/s]
2025-03-09 09:35:12,103 [INFO]: 	>>> Finished "Compute fast metrics" in 14.3244 secs
2025-03-09 09:35:12,105 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 47.6832 secs
2025-03-09 09:35:12,106 [INFO]: {
2025-03-09 09:35:12,106 [INFO]: 	index_key: HNSW15
2025-03-09 09:35:12,106 [INFO]: 	index_param: efSearch=280
2025-03-09 09:35:12,106 [INFO]: 	index_path: knn.index
2025-03-09 09:35:12,106 [INFO]: 	size in bytes: 461954530
2025-03-09 09:35:12,106 [INFO]: 	avg_search_speed_ms: 9.308708645446742
2025-03-09 09:35:12,106 [INFO]: 	99p_search_speed_ms: 23.757498043123626
2025-03-09 09:35:12,106 [INFO]: 	reconstruction error %: 0.0
2025-03-09 09:35:12,106 [INFO]: 	nb vectors: 2348
2025-03-09 09:35:12,106 [INFO]: 	vectors dimension: 49152
2025-03-09 09:35:12,106 [INFO]: 	compression ratio: 0.9993095727408496
2025-03-09 09:35:12,106 [INFO]: }
2025-03-09 09:35:12,106 [INFO]: 	>>> Finished "Creating the index" in 47.6861 secs
2025-03-09 09:35:12,106 [INFO]: >>> Finished "Launching the whole pipeline" in 47.7239 secs
2025-03-09 09:35:12: [retrieval_preprocessing] calculating distances ...
2025-03-09 09:35:13: [retrieval_preprocessing] finished and saved retrieval indices for episode 53640 [episode count 4/20]
[retrieval_preprocessing] for episode 81160 [episode count 5/20], we have num_retrieval=np.int64(2358) num_query=np.int64(120)
2025-03-09 09:35:13,494 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-09 09:35:14,520 [INFO]: Launching the whole pipeline 03/09/2025, 09:35:14
2025-03-09 09:35:14,520 [INFO]: Reading total number of vectors and dimension 03/09/2025, 09:35:14
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1061.31it/s]
2025-03-09 09:35:14,551 [INFO]: There are 2358 embeddings of dim 49152
2025-03-09 09:35:14,552 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0315 secs
2025-03-09 09:35:14,552 [INFO]: 	Compute estimated construction time of the index 03/09/2025, 09:35:14
2025-03-09 09:35:14,552 [INFO]: 		-> Train: 16.7 minutes
2025-03-09 09:35:14,552 [INFO]: 		-> Add: 1.3 seconds
2025-03-09 09:35:14,552 [INFO]: 		Total: 16.7 minutes
2025-03-09 09:35:14,552 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0002 secs
2025-03-09 09:35:14,552 [INFO]: 	Checking that your have enough memory available to create the index 03/09/2025, 09:35:14
2025-03-09 09:35:14,552 [INFO]: 486.6MB of memory will be needed to build the index (more might be used if you have more)
2025-03-09 09:35:14,552 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0002 secs
2025-03-09 09:35:14,552 [INFO]: 	Selecting most promising index types given data characteristics 03/09/2025, 09:35:14
2025-03-09 09:35:14,552 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-09 09:35:14,552 [INFO]: 	Creating the index 03/09/2025, 09:35:14
2025-03-09 09:35:14,552 [INFO]: 		-> Instanciate the index HNSW15 03/09/2025, 09:35:14
2025-03-09 09:35:14,554 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0013 secs
2025-03-09 09:35:14,554 [INFO]: 		-> Adding the vectors to the index 03/09/2025, 09:35:14
2025-03-09 09:35:14,554 [INFO]: The memory available for adding the vectors is 49.6GB(total available - used by the index)
2025-03-09 09:35:14,554 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/10 [00:00<?, ?it/s] 10%|█         | 1/10 [00:00<00:01,  8.32it/s] 60%|██████    | 6/10 [00:00<00:00, 29.82it/s]100%|██████████| 10/10 [00:01<00:00,  4.72it/s]100%|██████████| 10/10 [00:01<00:00,  5.59it/s]
2025-03-09 09:35:16,346 [INFO]: 	Computing best hyperparameters for index knn.index 03/09/2025, 09:35:16
2025-03-09 09:35:46,974 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 30.6281 secs
2025-03-09 09:35:46,974 [INFO]: The best hyperparameters are: efSearch=302
2025-03-09 09:35:46,975 [INFO]: 	Compute fast metrics 03/09/2025, 09:35:46
  0%|          | 0/4 [00:00<?, ?it/s] 50%|█████     | 2/4 [00:00<00:00, 16.65it/s] 75%|███████▌  | 3/4 [00:00<00:00, 18.65it/s]
2025-03-09 09:36:02,890 [INFO]: 	>>> Finished "Compute fast metrics" in 15.9149 secs
2025-03-09 09:36:02,892 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 48.3379 secs
2025-03-09 09:36:02,892 [INFO]: {
2025-03-09 09:36:02,892 [INFO]: 	index_key: HNSW15
2025-03-09 09:36:02,892 [INFO]: 	index_param: efSearch=302
2025-03-09 09:36:02,892 [INFO]: 	index_path: knn.index
2025-03-09 09:36:02,892 [INFO]: 	size in bytes: 463921930
2025-03-09 09:36:02,892 [INFO]: 	avg_search_speed_ms: 11.33334661579753
2025-03-09 09:36:02,892 [INFO]: 	99p_search_speed_ms: 20.038340371102088
2025-03-09 09:36:02,892 [INFO]: 	reconstruction error %: 0.0
2025-03-09 09:36:02,892 [INFO]: 	nb vectors: 2358
2025-03-09 09:36:02,892 [INFO]: 	vectors dimension: 49152
2025-03-09 09:36:02,892 [INFO]: 	compression ratio: 0.9993096553982693
2025-03-09 09:36:02,892 [INFO]: }
2025-03-09 09:36:02,892 [INFO]: 	>>> Finished "Creating the index" in 48.3396 secs
2025-03-09 09:36:02,892 [INFO]: >>> Finished "Launching the whole pipeline" in 48.3720 secs
2025-03-09 09:36:03: [retrieval_preprocessing] calculating distances ...
2025-03-09 09:36:03: [retrieval_preprocessing] finished and saved retrieval indices for episode 81160 [episode count 5/20]
[retrieval_preprocessing] for episode 67469 [episode count 6/20], we have num_retrieval=np.int64(2318) num_query=np.int64(160)
2025-03-09 09:36:04,481 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-09 09:36:04,774 [INFO]: Launching the whole pipeline 03/09/2025, 09:36:04
2025-03-09 09:36:04,774 [INFO]: Reading total number of vectors and dimension 03/09/2025, 09:36:04
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1466.54it/s]
2025-03-09 09:36:04,800 [INFO]: There are 2318 embeddings of dim 49152
2025-03-09 09:36:04,800 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0261 secs
2025-03-09 09:36:04,800 [INFO]: 	Compute estimated construction time of the index 03/09/2025, 09:36:04
2025-03-09 09:36:04,800 [INFO]: 		-> Train: 16.7 minutes
2025-03-09 09:36:04,800 [INFO]: 		-> Add: 1.3 seconds
2025-03-09 09:36:04,800 [INFO]: 		Total: 16.7 minutes
2025-03-09 09:36:04,800 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0001 secs
2025-03-09 09:36:04,800 [INFO]: 	Checking that your have enough memory available to create the index 03/09/2025, 09:36:04
2025-03-09 09:36:04,800 [INFO]: 478.4MB of memory will be needed to build the index (more might be used if you have more)
2025-03-09 09:36:04,801 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0001 secs
2025-03-09 09:36:04,801 [INFO]: 	Selecting most promising index types given data characteristics 03/09/2025, 09:36:04
2025-03-09 09:36:04,801 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-09 09:36:04,801 [INFO]: 	Creating the index 03/09/2025, 09:36:04
2025-03-09 09:36:04,801 [INFO]: 		-> Instanciate the index HNSW15 03/09/2025, 09:36:04
2025-03-09 09:36:04,802 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0010 secs
2025-03-09 09:36:04,802 [INFO]: 		-> Adding the vectors to the index 03/09/2025, 09:36:04
2025-03-09 09:36:04,802 [INFO]: The memory available for adding the vectors is 49.6GB(total available - used by the index)
2025-03-09 09:36:04,802 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/10 [00:00<?, ?it/s] 10%|█         | 1/10 [00:00<00:01,  5.48it/s] 20%|██        | 2/10 [00:00<00:01,  7.12it/s] 30%|███       | 3/10 [00:00<00:00,  7.80it/s] 40%|████      | 4/10 [00:00<00:00,  8.26it/s] 60%|██████    | 6/10 [00:00<00:00,  9.54it/s] 80%|████████  | 8/10 [00:00<00:00, 10.04it/s] 90%|█████████ | 9/10 [00:00<00:00,  9.89it/s]100%|██████████| 10/10 [00:02<00:00,  2.02it/s]100%|██████████| 10/10 [00:02<00:00,  3.76it/s]
2025-03-09 09:36:07,466 [INFO]: 	Computing best hyperparameters for index knn.index 03/09/2025, 09:36:07
2025-03-09 09:36:36,812 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 29.3461 secs
2025-03-09 09:36:36,813 [INFO]: The best hyperparameters are: efSearch=250
2025-03-09 09:36:36,813 [INFO]: 	Compute fast metrics 03/09/2025, 09:36:36
  0%|          | 0/4 [00:00<?, ?it/s] 25%|██▌       | 1/4 [00:00<00:00,  9.08it/s] 75%|███████▌  | 3/4 [00:00<00:00, 16.90it/s]
2025-03-09 09:36:52,583 [INFO]: 	>>> Finished "Compute fast metrics" in 15.7705 secs
2025-03-09 09:36:52,585 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 47.7837 secs
2025-03-09 09:36:52,586 [INFO]: {
2025-03-09 09:36:52,586 [INFO]: 	index_key: HNSW15
2025-03-09 09:36:52,586 [INFO]: 	index_param: efSearch=250
2025-03-09 09:36:52,586 [INFO]: 	index_path: knn.index
2025-03-09 09:36:52,586 [INFO]: 	size in bytes: 456052270
2025-03-09 09:36:52,586 [INFO]: 	avg_search_speed_ms: 8.434657200793676
2025-03-09 09:36:52,586 [INFO]: 	99p_search_speed_ms: 14.30327087640763
2025-03-09 09:36:52,586 [INFO]: 	reconstruction error %: 0.0
2025-03-09 09:36:52,586 [INFO]: 	nb vectors: 2318
2025-03-09 09:36:52,586 [INFO]: 	vectors dimension: 49152
2025-03-09 09:36:52,586 [INFO]: 	compression ratio: 0.9993094519626007
2025-03-09 09:36:52,586 [INFO]: }
2025-03-09 09:36:52,586 [INFO]: 	>>> Finished "Creating the index" in 47.7852 secs
2025-03-09 09:36:52,586 [INFO]: >>> Finished "Launching the whole pipeline" in 47.8119 secs
2025-03-09 09:36:53: [retrieval_preprocessing] calculating distances ...
2025-03-09 09:36:53: [retrieval_preprocessing] finished and saved retrieval indices for episode 67469 [episode count 6/20]
[retrieval_preprocessing] for episode 14225 [episode count 7/20], we have num_retrieval=np.int64(2348) num_query=np.int64(130)
2025-03-09 09:36:54,411 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-09 09:36:54,742 [INFO]: Launching the whole pipeline 03/09/2025, 09:36:54
2025-03-09 09:36:54,742 [INFO]: Reading total number of vectors and dimension 03/09/2025, 09:36:54
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1341.75it/s]
2025-03-09 09:36:54,776 [INFO]: There are 2348 embeddings of dim 49152
2025-03-09 09:36:54,776 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0337 secs
2025-03-09 09:36:54,776 [INFO]: 	Compute estimated construction time of the index 03/09/2025, 09:36:54
2025-03-09 09:36:54,776 [INFO]: 		-> Train: 16.7 minutes
2025-03-09 09:36:54,776 [INFO]: 		-> Add: 1.3 seconds
2025-03-09 09:36:54,776 [INFO]: 		Total: 16.7 minutes
2025-03-09 09:36:54,776 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0001 secs
2025-03-09 09:36:54,776 [INFO]: 	Checking that your have enough memory available to create the index 03/09/2025, 09:36:54
2025-03-09 09:36:54,776 [INFO]: 484.6MB of memory will be needed to build the index (more might be used if you have more)
2025-03-09 09:36:54,777 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0002 secs
2025-03-09 09:36:54,777 [INFO]: 	Selecting most promising index types given data characteristics 03/09/2025, 09:36:54
2025-03-09 09:36:54,777 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-09 09:36:54,777 [INFO]: 	Creating the index 03/09/2025, 09:36:54
2025-03-09 09:36:54,777 [INFO]: 		-> Instanciate the index HNSW15 03/09/2025, 09:36:54
2025-03-09 09:36:54,778 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0013 secs
2025-03-09 09:36:54,778 [INFO]: 		-> Adding the vectors to the index 03/09/2025, 09:36:54
2025-03-09 09:36:54,778 [INFO]: The memory available for adding the vectors is 49.6GB(total available - used by the index)
2025-03-09 09:36:54,778 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/10 [00:00<?, ?it/s] 10%|█         | 1/10 [00:00<00:01,  6.87it/s] 30%|███       | 3/10 [00:00<00:00, 12.34it/s] 50%|█████     | 5/10 [00:00<00:00, 14.44it/s] 70%|███████   | 7/10 [00:00<00:00, 15.37it/s] 90%|█████████ | 9/10 [00:00<00:00, 15.28it/s]100%|██████████| 10/10 [00:01<00:00,  5.01it/s]
2025-03-09 09:36:56,779 [INFO]: 	Computing best hyperparameters for index knn.index 03/09/2025, 09:36:56
2025-03-09 09:37:23,162 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 26.3827 secs
2025-03-09 09:37:23,163 [INFO]: The best hyperparameters are: efSearch=344
2025-03-09 09:37:23,163 [INFO]: 	Compute fast metrics 03/09/2025, 09:37:23
  0%|          | 0/4 [00:00<?, ?it/s] 25%|██▌       | 1/4 [00:00<00:00,  9.85it/s] 75%|███████▌  | 3/4 [00:00<00:00, 19.03it/s]
2025-03-09 09:37:36,359 [INFO]: 	>>> Finished "Compute fast metrics" in 13.1962 secs
2025-03-09 09:37:36,361 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 41.5830 secs
2025-03-09 09:37:36,362 [INFO]: {
2025-03-09 09:37:36,362 [INFO]: 	index_key: HNSW15
2025-03-09 09:37:36,362 [INFO]: 	index_param: efSearch=344
2025-03-09 09:37:36,362 [INFO]: 	index_path: knn.index
2025-03-09 09:37:36,362 [INFO]: 	size in bytes: 461954530
2025-03-09 09:37:36,362 [INFO]: 	avg_search_speed_ms: 9.649674019038951
2025-03-09 09:37:36,362 [INFO]: 	99p_search_speed_ms: 16.696296334266673
2025-03-09 09:37:36,362 [INFO]: 	reconstruction error %: 0.0
2025-03-09 09:37:36,362 [INFO]: 	nb vectors: 2348
2025-03-09 09:37:36,362 [INFO]: 	vectors dimension: 49152
2025-03-09 09:37:36,362 [INFO]: 	compression ratio: 0.9993095727408496
2025-03-09 09:37:36,362 [INFO]: }
2025-03-09 09:37:36,362 [INFO]: 	>>> Finished "Creating the index" in 41.5852 secs
2025-03-09 09:37:36,362 [INFO]: >>> Finished "Launching the whole pipeline" in 41.6196 secs
2025-03-09 09:37:37: [retrieval_preprocessing] calculating distances ...
2025-03-09 09:37:38: [retrieval_preprocessing] finished and saved retrieval indices for episode 14225 [episode count 7/20]
[retrieval_preprocessing] for episode 82835 [episode count 8/20], we have num_retrieval=np.int64(2354) num_query=np.int64(124)
2025-03-09 09:37:39,054 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-09 09:37:39,413 [INFO]: Launching the whole pipeline 03/09/2025, 09:37:39
2025-03-09 09:37:39,413 [INFO]: Reading total number of vectors and dimension 03/09/2025, 09:37:39
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1369.79it/s]
2025-03-09 09:37:39,441 [INFO]: There are 2354 embeddings of dim 49152
2025-03-09 09:37:39,442 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0287 secs
2025-03-09 09:37:39,442 [INFO]: 	Compute estimated construction time of the index 03/09/2025, 09:37:39
2025-03-09 09:37:39,442 [INFO]: 		-> Train: 16.7 minutes
2025-03-09 09:37:39,442 [INFO]: 		-> Add: 1.3 seconds
2025-03-09 09:37:39,442 [INFO]: 		Total: 16.7 minutes
2025-03-09 09:37:39,442 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0001 secs
2025-03-09 09:37:39,442 [INFO]: 	Checking that your have enough memory available to create the index 03/09/2025, 09:37:39
2025-03-09 09:37:39,442 [INFO]: 485.8MB of memory will be needed to build the index (more might be used if you have more)
2025-03-09 09:37:39,442 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0002 secs
2025-03-09 09:37:39,442 [INFO]: 	Selecting most promising index types given data characteristics 03/09/2025, 09:37:39
2025-03-09 09:37:39,442 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-09 09:37:39,442 [INFO]: 	Creating the index 03/09/2025, 09:37:39
2025-03-09 09:37:39,442 [INFO]: 		-> Instanciate the index HNSW15 03/09/2025, 09:37:39
2025-03-09 09:37:39,443 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0010 secs
2025-03-09 09:37:39,443 [INFO]: 		-> Adding the vectors to the index 03/09/2025, 09:37:39
2025-03-09 09:37:39,443 [INFO]: The memory available for adding the vectors is 49.6GB(total available - used by the index)
2025-03-09 09:37:39,444 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/10 [00:00<?, ?it/s] 10%|█         | 1/10 [00:00<00:01,  4.55it/s] 30%|███       | 3/10 [00:00<00:00,  8.47it/s] 50%|█████     | 5/10 [00:00<00:00, 11.41it/s] 70%|███████   | 7/10 [00:00<00:00, 13.86it/s] 90%|█████████ | 9/10 [00:00<00:00, 14.57it/s]100%|██████████| 10/10 [00:02<00:00,  4.10it/s]
2025-03-09 09:37:41,885 [INFO]: 	Computing best hyperparameters for index knn.index 03/09/2025, 09:37:41
2025-03-09 09:38:09,335 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 27.4502 secs
2025-03-09 09:38:09,336 [INFO]: The best hyperparameters are: efSearch=325
2025-03-09 09:38:09,336 [INFO]: 	Compute fast metrics 03/09/2025, 09:38:09
  0%|          | 0/4 [00:00<?, ?it/s] 25%|██▌       | 1/4 [00:00<00:00,  4.82it/s] 50%|█████     | 2/4 [00:00<00:00,  6.27it/s] 75%|███████▌  | 3/4 [00:00<00:00,  7.05it/s] 75%|███████▌  | 3/4 [00:00<00:00,  5.30it/s]
2025-03-09 09:38:24,677 [INFO]: 	>>> Finished "Compute fast metrics" in 15.3415 secs
2025-03-09 09:38:24,831 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 45.3880 secs
2025-03-09 09:38:24,832 [INFO]: {
2025-03-09 09:38:24,832 [INFO]: 	index_key: HNSW15
2025-03-09 09:38:24,832 [INFO]: 	index_param: efSearch=325
2025-03-09 09:38:24,832 [INFO]: 	index_path: knn.index
2025-03-09 09:38:24,832 [INFO]: 	size in bytes: 463134970
2025-03-09 09:38:24,832 [INFO]: 	avg_search_speed_ms: 9.555988519917284
2025-03-09 09:38:24,832 [INFO]: 	99p_search_speed_ms: 16.17382642580195
2025-03-09 09:38:24,832 [INFO]: 	reconstruction error %: 0.0
2025-03-09 09:38:24,832 [INFO]: 	nb vectors: 2354
2025-03-09 09:38:24,832 [INFO]: 	vectors dimension: 49152
2025-03-09 09:38:24,832 [INFO]: 	compression ratio: 0.9993096224195724
2025-03-09 09:38:24,832 [INFO]: }
2025-03-09 09:38:24,833 [INFO]: 	>>> Finished "Creating the index" in 45.3904 secs
2025-03-09 09:38:24,833 [INFO]: >>> Finished "Launching the whole pipeline" in 45.4198 secs
2025-03-09 09:38:25: [retrieval_preprocessing] calculating distances ...
2025-03-09 09:38:25: [retrieval_preprocessing] finished and saved retrieval indices for episode 82835 [episode count 8/20]
[retrieval_preprocessing] for episode 10778 [episode count 9/20], we have num_retrieval=np.int64(2375) num_query=np.int64(103)
2025-03-09 09:38:26,570 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-09 09:38:26,902 [INFO]: Launching the whole pipeline 03/09/2025, 09:38:26
2025-03-09 09:38:26,902 [INFO]: Reading total number of vectors and dimension 03/09/2025, 09:38:26
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1236.16it/s]
2025-03-09 09:38:26,929 [INFO]: There are 2375 embeddings of dim 49152
2025-03-09 09:38:26,929 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0270 secs
2025-03-09 09:38:26,929 [INFO]: 	Compute estimated construction time of the index 03/09/2025, 09:38:26
2025-03-09 09:38:26,929 [INFO]: 		-> Train: 16.7 minutes
2025-03-09 09:38:26,929 [INFO]: 		-> Add: 1.3 seconds
2025-03-09 09:38:26,929 [INFO]: 		Total: 16.7 minutes
2025-03-09 09:38:26,929 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0001 secs
2025-03-09 09:38:26,929 [INFO]: 	Checking that your have enough memory available to create the index 03/09/2025, 09:38:26
2025-03-09 09:38:26,929 [INFO]: 490.1MB of memory will be needed to build the index (more might be used if you have more)
2025-03-09 09:38:26,929 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0002 secs
2025-03-09 09:38:26,929 [INFO]: 	Selecting most promising index types given data characteristics 03/09/2025, 09:38:26
2025-03-09 09:38:26,930 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-09 09:38:26,930 [INFO]: 	Creating the index 03/09/2025, 09:38:26
2025-03-09 09:38:26,930 [INFO]: 		-> Instanciate the index HNSW15 03/09/2025, 09:38:26
2025-03-09 09:38:26,931 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0010 secs
2025-03-09 09:38:26,931 [INFO]: 		-> Adding the vectors to the index 03/09/2025, 09:38:26
2025-03-09 09:38:26,931 [INFO]: The memory available for adding the vectors is 49.6GB(total available - used by the index)
2025-03-09 09:38:26,931 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/10 [00:00<?, ?it/s] 10%|█         | 1/10 [00:00<00:01,  6.19it/s] 30%|███       | 3/10 [00:00<00:00,  9.72it/s] 50%|█████     | 5/10 [00:00<00:00, 10.58it/s] 70%|███████   | 7/10 [00:00<00:00, 11.03it/s] 90%|█████████ | 9/10 [00:00<00:00, 11.29it/s]100%|██████████| 10/10 [00:02<00:00,  3.99it/s]
2025-03-09 09:38:29,440 [INFO]: 	Computing best hyperparameters for index knn.index 03/09/2025, 09:38:29
2025-03-09 09:38:55,974 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 26.5337 secs
2025-03-09 09:38:55,975 [INFO]: The best hyperparameters are: efSearch=323
2025-03-09 09:38:55,975 [INFO]: 	Compute fast metrics 03/09/2025, 09:38:55
  0%|          | 0/4 [00:00<?, ?it/s] 25%|██▌       | 1/4 [00:00<00:00,  5.41it/s] 50%|█████     | 2/4 [00:00<00:00,  7.29it/s] 75%|███████▌  | 3/4 [00:00<00:00,  6.24it/s]
2025-03-09 09:39:14,040 [INFO]: 	>>> Finished "Compute fast metrics" in 18.0650 secs
2025-03-09 09:39:14,041 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 47.1106 secs
2025-03-09 09:39:14,041 [INFO]: {
2025-03-09 09:39:14,042 [INFO]: 	index_key: HNSW15
2025-03-09 09:39:14,042 [INFO]: 	index_param: efSearch=323
2025-03-09 09:39:14,042 [INFO]: 	index_path: knn.index
2025-03-09 09:39:14,042 [INFO]: 	size in bytes: 467266570
2025-03-09 09:39:14,042 [INFO]: 	avg_search_speed_ms: 9.311486492141581
2025-03-09 09:39:14,042 [INFO]: 	99p_search_speed_ms: 14.158212228212504
2025-03-09 09:39:14,042 [INFO]: 	reconstruction error %: 0.0
2025-03-09 09:39:14,042 [INFO]: 	nb vectors: 2375
2025-03-09 09:39:14,042 [INFO]: 	vectors dimension: 49152
2025-03-09 09:39:14,042 [INFO]: 	compression ratio: 0.9993096660007156
2025-03-09 09:39:14,042 [INFO]: }
2025-03-09 09:39:14,042 [INFO]: 	>>> Finished "Creating the index" in 47.1121 secs
2025-03-09 09:39:14,042 [INFO]: >>> Finished "Launching the whole pipeline" in 47.1398 secs
2025-03-09 09:39:14: [retrieval_preprocessing] calculating distances ...
2025-03-09 09:39:15: [retrieval_preprocessing] finished and saved retrieval indices for episode 10778 [episode count 9/20]
[retrieval_preprocessing] for episode 44315 [episode count 10/20], we have num_retrieval=np.int64(2365) num_query=np.int64(113)
2025-03-09 09:39:15,731 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-09 09:39:16,040 [INFO]: Launching the whole pipeline 03/09/2025, 09:39:16
2025-03-09 09:39:16,040 [INFO]: Reading total number of vectors and dimension 03/09/2025, 09:39:16
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 2213.35it/s]
2025-03-09 09:39:16,064 [INFO]: There are 2365 embeddings of dim 49152
2025-03-09 09:39:16,065 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0243 secs
2025-03-09 09:39:16,065 [INFO]: 	Compute estimated construction time of the index 03/09/2025, 09:39:16
2025-03-09 09:39:16,065 [INFO]: 		-> Train: 16.7 minutes
2025-03-09 09:39:16,065 [INFO]: 		-> Add: 1.3 seconds
2025-03-09 09:39:16,065 [INFO]: 		Total: 16.7 minutes
2025-03-09 09:39:16,065 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0001 secs
2025-03-09 09:39:16,065 [INFO]: 	Checking that your have enough memory available to create the index 03/09/2025, 09:39:16
2025-03-09 09:39:16,065 [INFO]: 488.1MB of memory will be needed to build the index (more might be used if you have more)
2025-03-09 09:39:16,065 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0002 secs
2025-03-09 09:39:16,065 [INFO]: 	Selecting most promising index types given data characteristics 03/09/2025, 09:39:16
2025-03-09 09:39:16,065 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-09 09:39:16,065 [INFO]: 	Creating the index 03/09/2025, 09:39:16
2025-03-09 09:39:16,065 [INFO]: 		-> Instanciate the index HNSW15 03/09/2025, 09:39:16
2025-03-09 09:39:16,066 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0012 secs
2025-03-09 09:39:16,066 [INFO]: 		-> Adding the vectors to the index 03/09/2025, 09:39:16
2025-03-09 09:39:16,067 [INFO]: The memory available for adding the vectors is 49.6GB(total available - used by the index)
2025-03-09 09:39:16,067 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/10 [00:00<?, ?it/s] 10%|█         | 1/10 [00:00<00:01,  5.53it/s] 30%|███       | 3/10 [00:00<00:00,  9.54it/s] 40%|████      | 4/10 [00:00<00:00,  9.54it/s] 60%|██████    | 6/10 [00:00<00:00, 11.09it/s] 80%|████████  | 8/10 [00:00<00:00, 10.06it/s]100%|██████████| 10/10 [00:02<00:00,  2.78it/s]100%|██████████| 10/10 [00:02<00:00,  4.14it/s]
2025-03-09 09:39:18,485 [INFO]: 	Computing best hyperparameters for index knn.index 03/09/2025, 09:39:18
2025-03-09 09:39:43,162 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 24.6772 secs
2025-03-09 09:39:43,163 [INFO]: The best hyperparameters are: efSearch=342
2025-03-09 09:39:43,163 [INFO]: 	Compute fast metrics 03/09/2025, 09:39:43
  0%|          | 0/4 [00:00<?, ?it/s] 25%|██▌       | 1/4 [00:00<00:00,  4.91it/s] 50%|█████     | 2/4 [00:00<00:00,  6.47it/s] 75%|███████▌  | 3/4 [00:00<00:00,  7.14it/s] 75%|███████▌  | 3/4 [00:00<00:00,  5.34it/s]
2025-03-09 09:39:58,022 [INFO]: 	>>> Finished "Compute fast metrics" in 14.8590 secs
2025-03-09 09:39:58,023 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 41.9569 secs
2025-03-09 09:39:58,023 [INFO]: {
2025-03-09 09:39:58,023 [INFO]: 	index_key: HNSW15
2025-03-09 09:39:58,023 [INFO]: 	index_param: efSearch=342
2025-03-09 09:39:58,024 [INFO]: 	index_path: knn.index
2025-03-09 09:39:58,024 [INFO]: 	size in bytes: 465299170
2025-03-09 09:39:58,024 [INFO]: 	avg_search_speed_ms: 9.269501586885738
2025-03-09 09:39:58,024 [INFO]: 	99p_search_speed_ms: 14.598112753592432
2025-03-09 09:39:58,024 [INFO]: 	reconstruction error %: 0.0
2025-03-09 09:39:58,024 [INFO]: 	nb vectors: 2365
2025-03-09 09:39:58,024 [INFO]: 	vectors dimension: 49152
2025-03-09 09:39:58,024 [INFO]: 	compression ratio: 0.9993095839822796
2025-03-09 09:39:58,024 [INFO]: }
2025-03-09 09:39:58,024 [INFO]: 	>>> Finished "Creating the index" in 41.9585 secs
2025-03-09 09:39:58,024 [INFO]: >>> Finished "Launching the whole pipeline" in 41.9834 secs
2025-03-09 09:39:59: [retrieval_preprocessing] calculating distances ...
2025-03-09 09:39:59: [retrieval_preprocessing] finished and saved retrieval indices for episode 44315 [episode count 10/20]
[retrieval_preprocessing] for episode 3229 [episode count 11/20], we have num_retrieval=np.int64(2371) num_query=np.int64(107)
2025-03-09 09:40:00,074 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-09 09:40:00,889 [INFO]: Launching the whole pipeline 03/09/2025, 09:40:00
2025-03-09 09:40:00,889 [INFO]: Reading total number of vectors and dimension 03/09/2025, 09:40:00
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1922.23it/s]
2025-03-09 09:40:00,912 [INFO]: There are 2371 embeddings of dim 49152
2025-03-09 09:40:00,912 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0236 secs
2025-03-09 09:40:00,913 [INFO]: 	Compute estimated construction time of the index 03/09/2025, 09:40:00
2025-03-09 09:40:00,913 [INFO]: 		-> Train: 16.7 minutes
2025-03-09 09:40:00,913 [INFO]: 		-> Add: 1.3 seconds
2025-03-09 09:40:00,913 [INFO]: 		Total: 16.7 minutes
2025-03-09 09:40:00,913 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0001 secs
2025-03-09 09:40:00,913 [INFO]: 	Checking that your have enough memory available to create the index 03/09/2025, 09:40:00
2025-03-09 09:40:00,913 [INFO]: 489.3MB of memory will be needed to build the index (more might be used if you have more)
2025-03-09 09:40:00,913 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0001 secs
2025-03-09 09:40:00,913 [INFO]: 	Selecting most promising index types given data characteristics 03/09/2025, 09:40:00
2025-03-09 09:40:00,913 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-09 09:40:00,913 [INFO]: 	Creating the index 03/09/2025, 09:40:00
2025-03-09 09:40:00,913 [INFO]: 		-> Instanciate the index HNSW15 03/09/2025, 09:40:00
2025-03-09 09:40:00,914 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0010 secs
2025-03-09 09:40:00,914 [INFO]: 		-> Adding the vectors to the index 03/09/2025, 09:40:00
2025-03-09 09:40:00,914 [INFO]: The memory available for adding the vectors is 49.6GB(total available - used by the index)
2025-03-09 09:40:00,914 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/10 [00:00<?, ?it/s] 10%|█         | 1/10 [00:00<00:01,  6.01it/s] 30%|███       | 3/10 [00:00<00:00,  9.64it/s] 50%|█████     | 5/10 [00:00<00:00, 10.91it/s] 70%|███████   | 7/10 [00:00<00:00, 11.35it/s] 90%|█████████ | 9/10 [00:00<00:00, 11.66it/s]100%|██████████| 10/10 [00:02<00:00,  4.54it/s]
2025-03-09 09:40:03,119 [INFO]: 	Computing best hyperparameters for index knn.index 03/09/2025, 09:40:03
2025-03-09 09:40:28,927 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 25.8070 secs
2025-03-09 09:40:28,927 [INFO]: The best hyperparameters are: efSearch=262
2025-03-09 09:40:28,927 [INFO]: 	Compute fast metrics 03/09/2025, 09:40:28
  0%|          | 0/4 [00:00<?, ?it/s] 50%|█████     | 2/4 [00:00<00:00, 16.70it/s] 75%|███████▌  | 3/4 [00:00<00:00, 18.05it/s]
2025-03-09 09:40:43,860 [INFO]: 	>>> Finished "Compute fast metrics" in 14.9327 secs
2025-03-09 09:40:43,862 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 42.9477 secs
2025-03-09 09:40:43,862 [INFO]: {
2025-03-09 09:40:43,862 [INFO]: 	index_key: HNSW15
2025-03-09 09:40:43,862 [INFO]: 	index_param: efSearch=262
2025-03-09 09:40:43,862 [INFO]: 	index_path: knn.index
2025-03-09 09:40:43,862 [INFO]: 	size in bytes: 466479610
2025-03-09 09:40:43,862 [INFO]: 	avg_search_speed_ms: 8.765443832198065
2025-03-09 09:40:43,862 [INFO]: 	99p_search_speed_ms: 19.04531205072997
2025-03-09 09:40:43,862 [INFO]: 	reconstruction error %: 0.0
2025-03-09 09:40:43,862 [INFO]: 	nb vectors: 2371
2025-03-09 09:40:43,862 [INFO]: 	vectors dimension: 49152
2025-03-09 09:40:43,862 [INFO]: 	compression ratio: 0.9993096332763612
2025-03-09 09:40:43,862 [INFO]: }
2025-03-09 09:40:43,862 [INFO]: 	>>> Finished "Creating the index" in 42.9492 secs
2025-03-09 09:40:43,862 [INFO]: >>> Finished "Launching the whole pipeline" in 42.9734 secs
2025-03-09 09:40:44: [retrieval_preprocessing] calculating distances ...
2025-03-09 09:40:44: [retrieval_preprocessing] finished and saved retrieval indices for episode 3229 [episode count 11/20]
[retrieval_preprocessing] for episode 38696 [episode count 12/20], we have num_retrieval=np.int64(2349) num_query=np.int64(129)
2025-03-09 09:40:45,346 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-09 09:40:45,680 [INFO]: Launching the whole pipeline 03/09/2025, 09:40:45
2025-03-09 09:40:45,680 [INFO]: Reading total number of vectors and dimension 03/09/2025, 09:40:45
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1430.04it/s]
2025-03-09 09:40:45,706 [INFO]: There are 2349 embeddings of dim 49152
2025-03-09 09:40:45,707 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0267 secs
2025-03-09 09:40:45,707 [INFO]: 	Compute estimated construction time of the index 03/09/2025, 09:40:45
2025-03-09 09:40:45,707 [INFO]: 		-> Train: 16.7 minutes
2025-03-09 09:40:45,707 [INFO]: 		-> Add: 1.3 seconds
2025-03-09 09:40:45,707 [INFO]: 		Total: 16.7 minutes
2025-03-09 09:40:45,707 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0002 secs
2025-03-09 09:40:45,707 [INFO]: 	Checking that your have enough memory available to create the index 03/09/2025, 09:40:45
2025-03-09 09:40:45,707 [INFO]: 484.8MB of memory will be needed to build the index (more might be used if you have more)
2025-03-09 09:40:45,707 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0002 secs
2025-03-09 09:40:45,707 [INFO]: 	Selecting most promising index types given data characteristics 03/09/2025, 09:40:45
2025-03-09 09:40:45,707 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-09 09:40:45,707 [INFO]: 	Creating the index 03/09/2025, 09:40:45
2025-03-09 09:40:45,707 [INFO]: 		-> Instanciate the index HNSW15 03/09/2025, 09:40:45
2025-03-09 09:40:45,709 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0010 secs
2025-03-09 09:40:45,709 [INFO]: 		-> Adding the vectors to the index 03/09/2025, 09:40:45
2025-03-09 09:40:45,709 [INFO]: The memory available for adding the vectors is 49.6GB(total available - used by the index)
2025-03-09 09:40:45,709 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/10 [00:00<?, ?it/s] 10%|█         | 1/10 [00:00<00:01,  6.48it/s] 30%|███       | 3/10 [00:00<00:00, 11.02it/s] 50%|█████     | 5/10 [00:00<00:00, 12.38it/s] 70%|███████   | 7/10 [00:00<00:00, 13.14it/s] 90%|█████████ | 9/10 [00:00<00:00, 13.59it/s]100%|██████████| 10/10 [00:02<00:00,  4.84it/s]
2025-03-09 09:40:47,779 [INFO]: 	Computing best hyperparameters for index knn.index 03/09/2025, 09:40:47
2025-03-09 09:41:11,330 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 23.5500 secs
2025-03-09 09:41:11,330 [INFO]: The best hyperparameters are: efSearch=341
2025-03-09 09:41:11,330 [INFO]: 	Compute fast metrics 03/09/2025, 09:41:11
  0%|          | 0/4 [00:00<?, ?it/s] 25%|██▌       | 1/4 [00:00<00:00,  5.81it/s] 75%|███████▌  | 3/4 [00:00<00:00,  9.34it/s] 75%|███████▌  | 3/4 [00:00<00:00,  7.22it/s]
2025-03-09 09:41:27,346 [INFO]: 	>>> Finished "Compute fast metrics" in 16.0160 secs
2025-03-09 09:41:27,348 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 41.6391 secs
2025-03-09 09:41:27,348 [INFO]: {
2025-03-09 09:41:27,348 [INFO]: 	index_key: HNSW15
2025-03-09 09:41:27,348 [INFO]: 	index_param: efSearch=341
2025-03-09 09:41:27,348 [INFO]: 	index_path: knn.index
2025-03-09 09:41:27,348 [INFO]: 	size in bytes: 462151270
2025-03-09 09:41:27,348 [INFO]: 	avg_search_speed_ms: 9.494601821187258
2025-03-09 09:41:27,348 [INFO]: 	99p_search_speed_ms: 16.837971610948447
2025-03-09 09:41:27,348 [INFO]: 	reconstruction error %: 0.0
2025-03-09 09:41:27,348 [INFO]: 	nb vectors: 2349
2025-03-09 09:41:27,348 [INFO]: 	vectors dimension: 49152
2025-03-09 09:41:27,348 [INFO]: 	compression ratio: 0.9993095810382605
2025-03-09 09:41:27,348 [INFO]: }
2025-03-09 09:41:27,348 [INFO]: 	>>> Finished "Creating the index" in 41.6406 secs
2025-03-09 09:41:27,348 [INFO]: >>> Finished "Launching the whole pipeline" in 41.6682 secs
2025-03-09 09:41:30: [retrieval_preprocessing] calculating distances ...
2025-03-09 09:41:30: [retrieval_preprocessing] finished and saved retrieval indices for episode 38696 [episode count 12/20]
[retrieval_preprocessing] for episode 43048 [episode count 13/20], we have num_retrieval=np.int64(2330) num_query=np.int64(148)
2025-03-09 09:41:31,134 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-09 09:41:31,449 [INFO]: Launching the whole pipeline 03/09/2025, 09:41:31
2025-03-09 09:41:31,449 [INFO]: Reading total number of vectors and dimension 03/09/2025, 09:41:31
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1442.83it/s]
2025-03-09 09:41:31,474 [INFO]: There are 2330 embeddings of dim 49152
2025-03-09 09:41:31,475 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0254 secs
2025-03-09 09:41:31,475 [INFO]: 	Compute estimated construction time of the index 03/09/2025, 09:41:31
2025-03-09 09:41:31,475 [INFO]: 		-> Train: 16.7 minutes
2025-03-09 09:41:31,475 [INFO]: 		-> Add: 1.3 seconds
2025-03-09 09:41:31,475 [INFO]: 		Total: 16.7 minutes
2025-03-09 09:41:31,475 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0002 secs
2025-03-09 09:41:31,475 [INFO]: 	Checking that your have enough memory available to create the index 03/09/2025, 09:41:31
2025-03-09 09:41:31,475 [INFO]: 480.9MB of memory will be needed to build the index (more might be used if you have more)
2025-03-09 09:41:31,475 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0001 secs
2025-03-09 09:41:31,475 [INFO]: 	Selecting most promising index types given data characteristics 03/09/2025, 09:41:31
2025-03-09 09:41:31,475 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-09 09:41:31,475 [INFO]: 	Creating the index 03/09/2025, 09:41:31
2025-03-09 09:41:31,475 [INFO]: 		-> Instanciate the index HNSW15 03/09/2025, 09:41:31
2025-03-09 09:41:31,476 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0010 secs
2025-03-09 09:41:31,477 [INFO]: 		-> Adding the vectors to the index 03/09/2025, 09:41:31
2025-03-09 09:41:31,477 [INFO]: The memory available for adding the vectors is 49.6GB(total available - used by the index)
2025-03-09 09:41:31,477 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/10 [00:00<?, ?it/s] 10%|█         | 1/10 [00:00<00:01,  7.57it/s] 30%|███       | 3/10 [00:00<00:00, 11.33it/s] 50%|█████     | 5/10 [00:00<00:00, 11.79it/s] 70%|███████   | 7/10 [00:00<00:00, 12.02it/s] 90%|█████████ | 9/10 [00:00<00:00, 12.27it/s]100%|██████████| 10/10 [00:02<00:00,  4.41it/s]
2025-03-09 09:41:33,749 [INFO]: 	Computing best hyperparameters for index knn.index 03/09/2025, 09:41:33
2025-03-09 09:41:57,807 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 24.0577 secs
2025-03-09 09:41:57,807 [INFO]: The best hyperparameters are: efSearch=345
2025-03-09 09:41:57,807 [INFO]: 	Compute fast metrics 03/09/2025, 09:41:57
  0%|          | 0/4 [00:00<?, ?it/s] 25%|██▌       | 1/4 [00:00<00:00,  5.56it/s] 75%|███████▌  | 3/4 [00:00<00:00,  8.07it/s] 75%|███████▌  | 3/4 [00:00<00:00,  6.12it/s]
2025-03-09 09:42:14,768 [INFO]: 	>>> Finished "Compute fast metrics" in 16.9608 secs
2025-03-09 09:42:14,770 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 43.2937 secs
2025-03-09 09:42:14,771 [INFO]: {
2025-03-09 09:42:14,771 [INFO]: 	index_key: HNSW15
2025-03-09 09:42:14,771 [INFO]: 	index_param: efSearch=345
2025-03-09 09:42:14,771 [INFO]: 	index_path: knn.index
2025-03-09 09:42:14,771 [INFO]: 	size in bytes: 458413210
2025-03-09 09:42:14,771 [INFO]: 	avg_search_speed_ms: 10.206802133993454
2025-03-09 09:42:14,771 [INFO]: 	99p_search_speed_ms: 14.975942010059958
2025-03-09 09:42:14,771 [INFO]: 	reconstruction error %: 0.0
2025-03-09 09:42:14,771 [INFO]: 	nb vectors: 2330
2025-03-09 09:42:14,771 [INFO]: 	vectors dimension: 49152
2025-03-09 09:42:14,771 [INFO]: 	compression ratio: 0.999309422169575
2025-03-09 09:42:14,771 [INFO]: }
2025-03-09 09:42:14,771 [INFO]: 	>>> Finished "Creating the index" in 43.2957 secs
2025-03-09 09:42:14,771 [INFO]: >>> Finished "Launching the whole pipeline" in 43.3219 secs
2025-03-09 09:42:16: [retrieval_preprocessing] calculating distances ...
2025-03-09 09:42:16: [retrieval_preprocessing] finished and saved retrieval indices for episode 43048 [episode count 13/20]
[retrieval_preprocessing] for episode 18730 [episode count 14/20], we have num_retrieval=np.int64(2380) num_query=np.int64(98)
2025-03-09 09:42:17,585 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-09 09:42:17,891 [INFO]: Launching the whole pipeline 03/09/2025, 09:42:17
2025-03-09 09:42:17,891 [INFO]: Reading total number of vectors and dimension 03/09/2025, 09:42:17
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 958.70it/s]
2025-03-09 09:42:17,919 [INFO]: There are 2380 embeddings of dim 49152
2025-03-09 09:42:17,919 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0280 secs
2025-03-09 09:42:17,919 [INFO]: 	Compute estimated construction time of the index 03/09/2025, 09:42:17
2025-03-09 09:42:17,919 [INFO]: 		-> Train: 16.7 minutes
2025-03-09 09:42:17,920 [INFO]: 		-> Add: 1.3 seconds
2025-03-09 09:42:17,920 [INFO]: 		Total: 16.7 minutes
2025-03-09 09:42:17,920 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0003 secs
2025-03-09 09:42:17,920 [INFO]: 	Checking that your have enough memory available to create the index 03/09/2025, 09:42:17
2025-03-09 09:42:17,920 [INFO]: 491.2MB of memory will be needed to build the index (more might be used if you have more)
2025-03-09 09:42:17,920 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0004 secs
2025-03-09 09:42:17,920 [INFO]: 	Selecting most promising index types given data characteristics 03/09/2025, 09:42:17
2025-03-09 09:42:17,921 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-09 09:42:17,921 [INFO]: 	Creating the index 03/09/2025, 09:42:17
2025-03-09 09:42:17,921 [INFO]: 		-> Instanciate the index HNSW15 03/09/2025, 09:42:17
2025-03-09 09:42:17,923 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0025 secs
2025-03-09 09:42:17,924 [INFO]: 		-> Adding the vectors to the index 03/09/2025, 09:42:17
2025-03-09 09:42:17,924 [INFO]: The memory available for adding the vectors is 49.6GB(total available - used by the index)
2025-03-09 09:42:17,924 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/10 [00:00<?, ?it/s] 10%|█         | 1/10 [00:00<00:01,  5.42it/s] 20%|██        | 2/10 [00:00<00:01,  6.90it/s] 30%|███       | 3/10 [00:00<00:00,  7.75it/s] 40%|████      | 4/10 [00:00<00:00,  8.09it/s] 50%|█████     | 5/10 [00:00<00:00,  8.21it/s] 60%|██████    | 6/10 [00:00<00:00,  8.23it/s] 70%|███████   | 7/10 [00:00<00:00,  8.26it/s] 80%|████████  | 8/10 [00:01<00:00,  8.22it/s] 90%|█████████ | 9/10 [00:01<00:00,  8.21it/s]100%|██████████| 10/10 [00:03<00:00,  1.47it/s]100%|██████████| 10/10 [00:03<00:00,  3.27it/s]
2025-03-09 09:42:21,255 [INFO]: 	Computing best hyperparameters for index knn.index 03/09/2025, 09:42:21
2025-03-09 09:42:50,889 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 29.6329 secs
2025-03-09 09:42:50,889 [INFO]: The best hyperparameters are: efSearch=308
2025-03-09 09:42:50,889 [INFO]: 	Compute fast metrics 03/09/2025, 09:42:50
  0%|          | 0/4 [00:00<?, ?it/s] 25%|██▌       | 1/4 [00:00<00:00,  5.27it/s] 50%|█████     | 2/4 [00:00<00:00,  6.83it/s] 75%|███████▌  | 3/4 [00:00<00:00,  7.60it/s] 75%|███████▌  | 3/4 [00:00<00:00,  5.76it/s]
2025-03-09 09:43:05,618 [INFO]: 	>>> Finished "Compute fast metrics" in 14.7297 secs
2025-03-09 09:43:05,884 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 47.9604 secs
2025-03-09 09:43:05,884 [INFO]: {
2025-03-09 09:43:05,884 [INFO]: 	index_key: HNSW15
2025-03-09 09:43:05,884 [INFO]: 	index_param: efSearch=308
2025-03-09 09:43:05,885 [INFO]: 	index_path: knn.index
2025-03-09 09:43:05,885 [INFO]: 	size in bytes: 468250270
2025-03-09 09:43:05,885 [INFO]: 	avg_search_speed_ms: 8.816019185355534
2025-03-09 09:43:05,885 [INFO]: 	99p_search_speed_ms: 14.5463042636402
2025-03-09 09:43:05,885 [INFO]: 	reconstruction error %: 0.0
2025-03-09 09:43:05,885 [INFO]: 	nb vectors: 2380
2025-03-09 09:43:05,885 [INFO]: 	vectors dimension: 49152
2025-03-09 09:43:05,885 [INFO]: 	compression ratio: 0.9993097067514771
2025-03-09 09:43:05,885 [INFO]: }
2025-03-09 09:43:05,885 [INFO]: 	>>> Finished "Creating the index" in 47.9643 secs
2025-03-09 09:43:05,885 [INFO]: >>> Finished "Launching the whole pipeline" in 47.9941 secs
2025-03-09 09:43:06: [retrieval_preprocessing] calculating distances ...
2025-03-09 09:43:06: [retrieval_preprocessing] finished and saved retrieval indices for episode 18730 [episode count 14/20]
[retrieval_preprocessing] for episode 50603 [episode count 15/20], we have num_retrieval=np.int64(2362) num_query=np.int64(116)
2025-03-09 09:43:07,441 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-09 09:43:07,756 [INFO]: Launching the whole pipeline 03/09/2025, 09:43:07
2025-03-09 09:43:07,756 [INFO]: Reading total number of vectors and dimension 03/09/2025, 09:43:07
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 2316.02it/s]
2025-03-09 09:43:07,779 [INFO]: There are 2362 embeddings of dim 49152
2025-03-09 09:43:07,779 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0230 secs
2025-03-09 09:43:07,779 [INFO]: 	Compute estimated construction time of the index 03/09/2025, 09:43:07
2025-03-09 09:43:07,779 [INFO]: 		-> Train: 16.7 minutes
2025-03-09 09:43:07,779 [INFO]: 		-> Add: 1.3 seconds
2025-03-09 09:43:07,779 [INFO]: 		Total: 16.7 minutes
2025-03-09 09:43:07,779 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0001 secs
2025-03-09 09:43:07,779 [INFO]: 	Checking that your have enough memory available to create the index 03/09/2025, 09:43:07
2025-03-09 09:43:07,779 [INFO]: 487.5MB of memory will be needed to build the index (more might be used if you have more)
2025-03-09 09:43:07,779 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0001 secs
2025-03-09 09:43:07,779 [INFO]: 	Selecting most promising index types given data characteristics 03/09/2025, 09:43:07
2025-03-09 09:43:07,779 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-09 09:43:07,779 [INFO]: 	Creating the index 03/09/2025, 09:43:07
2025-03-09 09:43:07,779 [INFO]: 		-> Instanciate the index HNSW15 03/09/2025, 09:43:07
2025-03-09 09:43:07,780 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0009 secs
2025-03-09 09:43:07,780 [INFO]: 		-> Adding the vectors to the index 03/09/2025, 09:43:07
2025-03-09 09:43:07,780 [INFO]: The memory available for adding the vectors is 49.6GB(total available - used by the index)
2025-03-09 09:43:07,780 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/10 [00:00<?, ?it/s] 10%|█         | 1/10 [00:00<00:01,  5.69it/s] 30%|███       | 3/10 [00:00<00:00,  9.45it/s] 50%|█████     | 5/10 [00:00<00:00, 10.72it/s] 70%|███████   | 7/10 [00:00<00:00, 11.28it/s] 90%|█████████ | 9/10 [00:00<00:00, 11.73it/s]100%|██████████| 10/10 [00:02<00:00,  4.47it/s]
2025-03-09 09:43:10,021 [INFO]: 	Computing best hyperparameters for index knn.index 03/09/2025, 09:43:10
2025-03-09 09:43:35,004 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 24.9823 secs
2025-03-09 09:43:35,004 [INFO]: The best hyperparameters are: efSearch=345
2025-03-09 09:43:35,004 [INFO]: 	Compute fast metrics 03/09/2025, 09:43:35
  0%|          | 0/4 [00:00<?, ?it/s] 25%|██▌       | 1/4 [00:00<00:00,  5.86it/s] 75%|███████▌  | 3/4 [00:00<00:00,  9.39it/s] 75%|███████▌  | 3/4 [00:00<00:00,  7.33it/s]
2025-03-09 09:43:53,759 [INFO]: 	>>> Finished "Compute fast metrics" in 18.7542 secs
2025-03-09 09:43:53,761 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 45.9807 secs
2025-03-09 09:43:53,761 [INFO]: {
2025-03-09 09:43:53,761 [INFO]: 	index_key: HNSW15
2025-03-09 09:43:53,761 [INFO]: 	index_param: efSearch=345
2025-03-09 09:43:53,761 [INFO]: 	index_path: knn.index
2025-03-09 09:43:53,761 [INFO]: 	size in bytes: 464708950
2025-03-09 09:43:53,761 [INFO]: 	avg_search_speed_ms: 9.28615990934501
2025-03-09 09:43:53,761 [INFO]: 	99p_search_speed_ms: 19.18556567281485
2025-03-09 09:43:53,761 [INFO]: 	reconstruction error %: 0.0
2025-03-09 09:43:53,761 [INFO]: 	nb vectors: 2362
2025-03-09 09:43:53,761 [INFO]: 	vectors dimension: 49152
2025-03-09 09:43:53,761 [INFO]: 	compression ratio: 0.9993095592413272
2025-03-09 09:43:53,761 [INFO]: }
2025-03-09 09:43:53,761 [INFO]: 	>>> Finished "Creating the index" in 45.9821 secs
2025-03-09 09:43:53,761 [INFO]: >>> Finished "Launching the whole pipeline" in 46.0057 secs
2025-03-09 09:43:55: [retrieval_preprocessing] calculating distances ...
2025-03-09 09:43:55: [retrieval_preprocessing] finished and saved retrieval indices for episode 50603 [episode count 15/20]
[retrieval_preprocessing] for episode 46892 [episode count 16/20], we have num_retrieval=np.int64(2371) num_query=np.int64(107)
2025-03-09 09:43:56,192 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-09 09:43:57,080 [INFO]: Launching the whole pipeline 03/09/2025, 09:43:57
2025-03-09 09:43:57,080 [INFO]: Reading total number of vectors and dimension 03/09/2025, 09:43:57
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1225.33it/s]
2025-03-09 09:43:57,105 [INFO]: There are 2371 embeddings of dim 49152
2025-03-09 09:43:57,105 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0251 secs
2025-03-09 09:43:57,105 [INFO]: 	Compute estimated construction time of the index 03/09/2025, 09:43:57
2025-03-09 09:43:57,105 [INFO]: 		-> Train: 16.7 minutes
2025-03-09 09:43:57,105 [INFO]: 		-> Add: 1.3 seconds
2025-03-09 09:43:57,105 [INFO]: 		Total: 16.7 minutes
2025-03-09 09:43:57,105 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0001 secs
2025-03-09 09:43:57,105 [INFO]: 	Checking that your have enough memory available to create the index 03/09/2025, 09:43:57
2025-03-09 09:43:57,106 [INFO]: 489.3MB of memory will be needed to build the index (more might be used if you have more)
2025-03-09 09:43:57,106 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0001 secs
2025-03-09 09:43:57,106 [INFO]: 	Selecting most promising index types given data characteristics 03/09/2025, 09:43:57
2025-03-09 09:43:57,106 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-09 09:43:57,106 [INFO]: 	Creating the index 03/09/2025, 09:43:57
2025-03-09 09:43:57,106 [INFO]: 		-> Instanciate the index HNSW15 03/09/2025, 09:43:57
2025-03-09 09:43:57,107 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0011 secs
2025-03-09 09:43:57,107 [INFO]: 		-> Adding the vectors to the index 03/09/2025, 09:43:57
2025-03-09 09:43:57,107 [INFO]: The memory available for adding the vectors is 49.6GB(total available - used by the index)
2025-03-09 09:43:57,107 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/10 [00:00<?, ?it/s] 10%|█         | 1/10 [00:00<00:01,  5.48it/s] 20%|██        | 2/10 [00:00<00:01,  7.13it/s] 30%|███       | 3/10 [00:00<00:00,  7.95it/s] 40%|████      | 4/10 [00:00<00:00,  8.46it/s] 50%|█████     | 5/10 [00:00<00:00,  8.65it/s] 60%|██████    | 6/10 [00:00<00:00,  8.76it/s] 70%|███████   | 7/10 [00:00<00:00,  8.78it/s] 80%|████████  | 8/10 [00:00<00:00,  8.85it/s] 90%|█████████ | 9/10 [00:01<00:00,  8.88it/s]100%|██████████| 10/10 [00:02<00:00,  2.00it/s]100%|██████████| 10/10 [00:02<00:00,  4.10it/s]
2025-03-09 09:43:59,548 [INFO]: 	Computing best hyperparameters for index knn.index 03/09/2025, 09:43:59
2025-03-09 09:44:24,807 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 25.2586 secs
2025-03-09 09:44:24,807 [INFO]: The best hyperparameters are: efSearch=286
2025-03-09 09:44:24,807 [INFO]: 	Compute fast metrics 03/09/2025, 09:44:24
  0%|          | 0/4 [00:00<?, ?it/s] 25%|██▌       | 1/4 [00:00<00:00,  6.74it/s] 75%|███████▌  | 3/4 [00:00<00:00, 10.42it/s] 75%|███████▌  | 3/4 [00:00<00:00,  8.02it/s]
2025-03-09 09:44:42,491 [INFO]: 	>>> Finished "Compute fast metrics" in 17.6839 secs
2025-03-09 09:44:42,493 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 45.3856 secs
2025-03-09 09:44:42,493 [INFO]: {
2025-03-09 09:44:42,493 [INFO]: 	index_key: HNSW15
2025-03-09 09:44:42,493 [INFO]: 	index_param: efSearch=286
2025-03-09 09:44:42,493 [INFO]: 	index_path: knn.index
2025-03-09 09:44:42,493 [INFO]: 	size in bytes: 466479610
2025-03-09 09:44:42,493 [INFO]: 	avg_search_speed_ms: 8.002459597215056
2025-03-09 09:44:42,493 [INFO]: 	99p_search_speed_ms: 13.924420019611716
2025-03-09 09:44:42,493 [INFO]: 	reconstruction error %: 0.0
2025-03-09 09:44:42,493 [INFO]: 	nb vectors: 2371
2025-03-09 09:44:42,493 [INFO]: 	vectors dimension: 49152
2025-03-09 09:44:42,493 [INFO]: 	compression ratio: 0.9993096332763612
2025-03-09 09:44:42,493 [INFO]: }
2025-03-09 09:44:42,493 [INFO]: 	>>> Finished "Creating the index" in 45.3871 secs
2025-03-09 09:44:42,493 [INFO]: >>> Finished "Launching the whole pipeline" in 45.4128 secs
2025-03-09 09:44:43: [retrieval_preprocessing] calculating distances ...
2025-03-09 09:44:43: [retrieval_preprocessing] finished and saved retrieval indices for episode 46892 [episode count 16/20]
[retrieval_preprocessing] for episode 65581 [episode count 17/20], we have num_retrieval=np.int64(2369) num_query=np.int64(109)
2025-03-09 09:44:44,154 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-09 09:44:44,484 [INFO]: Launching the whole pipeline 03/09/2025, 09:44:44
2025-03-09 09:44:44,484 [INFO]: Reading total number of vectors and dimension 03/09/2025, 09:44:44
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1442.83it/s]
2025-03-09 09:44:44,511 [INFO]: There are 2369 embeddings of dim 49152
2025-03-09 09:44:44,512 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0271 secs
2025-03-09 09:44:44,512 [INFO]: 	Compute estimated construction time of the index 03/09/2025, 09:44:44
2025-03-09 09:44:44,512 [INFO]: 		-> Train: 16.7 minutes
2025-03-09 09:44:44,512 [INFO]: 		-> Add: 1.3 seconds
2025-03-09 09:44:44,512 [INFO]: 		Total: 16.7 minutes
2025-03-09 09:44:44,512 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0004 secs
2025-03-09 09:44:44,512 [INFO]: 	Checking that your have enough memory available to create the index 03/09/2025, 09:44:44
2025-03-09 09:44:44,513 [INFO]: 488.9MB of memory will be needed to build the index (more might be used if you have more)
2025-03-09 09:44:44,513 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0004 secs
2025-03-09 09:44:44,513 [INFO]: 	Selecting most promising index types given data characteristics 03/09/2025, 09:44:44
2025-03-09 09:44:44,513 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-09 09:44:44,513 [INFO]: 	Creating the index 03/09/2025, 09:44:44
2025-03-09 09:44:44,513 [INFO]: 		-> Instanciate the index HNSW15 03/09/2025, 09:44:44
2025-03-09 09:44:44,516 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0028 secs
2025-03-09 09:44:44,516 [INFO]: 		-> Adding the vectors to the index 03/09/2025, 09:44:44
2025-03-09 09:44:44,517 [INFO]: The memory available for adding the vectors is 49.6GB(total available - used by the index)
2025-03-09 09:44:44,517 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/10 [00:00<?, ?it/s] 10%|█         | 1/10 [00:00<00:01,  7.33it/s] 30%|███       | 3/10 [00:00<00:00, 10.54it/s] 50%|█████     | 5/10 [00:00<00:00, 11.45it/s] 70%|███████   | 7/10 [00:00<00:00, 12.01it/s] 90%|█████████ | 9/10 [00:00<00:00, 12.18it/s]100%|██████████| 10/10 [00:02<00:00,  4.52it/s]
2025-03-09 09:44:46,733 [INFO]: 	Computing best hyperparameters for index knn.index 03/09/2025, 09:44:46
2025-03-09 09:45:13,120 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 26.3862 secs
2025-03-09 09:45:13,120 [INFO]: The best hyperparameters are: efSearch=334
2025-03-09 09:45:13,120 [INFO]: 	Compute fast metrics 03/09/2025, 09:45:13
  0%|          | 0/4 [00:00<?, ?it/s] 25%|██▌       | 1/4 [00:00<00:00,  5.39it/s] 50%|█████     | 2/4 [00:00<00:00,  6.96it/s] 75%|███████▌  | 3/4 [00:00<00:00,  7.69it/s] 75%|███████▌  | 3/4 [00:00<00:00,  5.77it/s]
2025-03-09 09:45:27,315 [INFO]: 	>>> Finished "Compute fast metrics" in 14.1952 secs
2025-03-09 09:45:27,317 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 42.8004 secs
2025-03-09 09:45:27,317 [INFO]: {
2025-03-09 09:45:27,317 [INFO]: 	index_key: HNSW15
2025-03-09 09:45:27,317 [INFO]: 	index_param: efSearch=334
2025-03-09 09:45:27,317 [INFO]: 	index_path: knn.index
2025-03-09 09:45:27,317 [INFO]: 	size in bytes: 466086130
2025-03-09 09:45:27,317 [INFO]: 	avg_search_speed_ms: 9.810051285562135
2025-03-09 09:45:27,317 [INFO]: 	99p_search_speed_ms: 17.109289872460057
2025-03-09 09:45:27,317 [INFO]: 	reconstruction error %: 0.0
2025-03-09 09:45:27,317 [INFO]: 	nb vectors: 2369
2025-03-09 09:45:27,317 [INFO]: 	vectors dimension: 49152
2025-03-09 09:45:27,317 [INFO]: 	compression ratio: 0.9993096168727441
2025-03-09 09:45:27,317 [INFO]: }
2025-03-09 09:45:27,317 [INFO]: 	>>> Finished "Creating the index" in 42.8041 secs
2025-03-09 09:45:27,317 [INFO]: >>> Finished "Launching the whole pipeline" in 42.8328 secs
2025-03-09 09:45:27: [retrieval_preprocessing] calculating distances ...
2025-03-09 09:45:28: [retrieval_preprocessing] finished and saved retrieval indices for episode 65581 [episode count 17/20]
[retrieval_preprocessing] for episode 25006 [episode count 18/20], we have num_retrieval=np.int64(2337) num_query=np.int64(141)
2025-03-09 09:45:29,010 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-09 09:45:29,362 [INFO]: Launching the whole pipeline 03/09/2025, 09:45:29
2025-03-09 09:45:29,362 [INFO]: Reading total number of vectors and dimension 03/09/2025, 09:45:29
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 2008.77it/s]
2025-03-09 09:45:29,387 [INFO]: There are 2337 embeddings of dim 49152
2025-03-09 09:45:29,387 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0255 secs
2025-03-09 09:45:29,387 [INFO]: 	Compute estimated construction time of the index 03/09/2025, 09:45:29
2025-03-09 09:45:29,387 [INFO]: 		-> Train: 16.7 minutes
2025-03-09 09:45:29,387 [INFO]: 		-> Add: 1.3 seconds
2025-03-09 09:45:29,388 [INFO]: 		Total: 16.7 minutes
2025-03-09 09:45:29,388 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0001 secs
2025-03-09 09:45:29,388 [INFO]: 	Checking that your have enough memory available to create the index 03/09/2025, 09:45:29
2025-03-09 09:45:29,388 [INFO]: 482.3MB of memory will be needed to build the index (more might be used if you have more)
2025-03-09 09:45:29,388 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0002 secs
2025-03-09 09:45:29,388 [INFO]: 	Selecting most promising index types given data characteristics 03/09/2025, 09:45:29
2025-03-09 09:45:29,388 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-09 09:45:29,388 [INFO]: 	Creating the index 03/09/2025, 09:45:29
2025-03-09 09:45:29,388 [INFO]: 		-> Instanciate the index HNSW15 03/09/2025, 09:45:29
2025-03-09 09:45:29,389 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0011 secs
2025-03-09 09:45:29,389 [INFO]: 		-> Adding the vectors to the index 03/09/2025, 09:45:29
2025-03-09 09:45:29,389 [INFO]: The memory available for adding the vectors is 49.6GB(total available - used by the index)
2025-03-09 09:45:29,389 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/10 [00:00<?, ?it/s] 10%|█         | 1/10 [00:00<00:01,  5.61it/s] 30%|███       | 3/10 [00:00<00:00,  8.70it/s] 50%|█████     | 5/10 [00:00<00:00,  9.88it/s] 70%|███████   | 7/10 [00:00<00:00, 10.35it/s] 90%|█████████ | 9/10 [00:00<00:00, 11.01it/s]100%|██████████| 10/10 [00:02<00:00,  3.73it/s]
2025-03-09 09:45:32,075 [INFO]: 	Computing best hyperparameters for index knn.index 03/09/2025, 09:45:32
2025-03-09 09:45:56,648 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 24.5733 secs
2025-03-09 09:45:56,648 [INFO]: The best hyperparameters are: efSearch=351
2025-03-09 09:45:56,648 [INFO]: 	Compute fast metrics 03/09/2025, 09:45:56
  0%|          | 0/4 [00:00<?, ?it/s] 25%|██▌       | 1/4 [00:00<00:00,  5.68it/s] 50%|█████     | 2/4 [00:00<00:00,  7.49it/s] 75%|███████▌  | 3/4 [00:00<00:00,  8.25it/s] 75%|███████▌  | 3/4 [00:00<00:00,  6.23it/s]
2025-03-09 09:46:16,788 [INFO]: 	>>> Finished "Compute fast metrics" in 20.1395 secs
2025-03-09 09:46:16,790 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 47.4012 secs
2025-03-09 09:46:16,790 [INFO]: {
2025-03-09 09:46:16,790 [INFO]: 	index_key: HNSW15
2025-03-09 09:46:16,791 [INFO]: 	index_param: efSearch=351
2025-03-09 09:46:16,791 [INFO]: 	index_path: knn.index
2025-03-09 09:46:16,791 [INFO]: 	size in bytes: 459790390
2025-03-09 09:46:16,791 [INFO]: 	avg_search_speed_ms: 11.253603987620204
2025-03-09 09:46:16,791 [INFO]: 	99p_search_speed_ms: 22.369850378017873
2025-03-09 09:46:16,791 [INFO]: 	reconstruction error %: 0.0
2025-03-09 09:46:16,791 [INFO]: 	nb vectors: 2337
2025-03-09 09:46:16,791 [INFO]: 	vectors dimension: 49152
2025-03-09 09:46:16,791 [INFO]: 	compression ratio: 0.9993094810006795
2025-03-09 09:46:16,791 [INFO]: }
2025-03-09 09:46:16,791 [INFO]: 	>>> Finished "Creating the index" in 47.4028 secs
2025-03-09 09:46:16,791 [INFO]: >>> Finished "Launching the whole pipeline" in 47.4289 secs
2025-03-09 09:46:18: [retrieval_preprocessing] calculating distances ...
2025-03-09 09:46:18: [retrieval_preprocessing] finished and saved retrieval indices for episode 25006 [episode count 18/20]
[retrieval_preprocessing] for episode 77224 [episode count 19/20], we have num_retrieval=np.int64(2333) num_query=np.int64(145)
2025-03-09 09:46:19,624 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-09 09:46:20,334 [INFO]: Launching the whole pipeline 03/09/2025, 09:46:20
2025-03-09 09:46:20,334 [INFO]: Reading total number of vectors and dimension 03/09/2025, 09:46:20
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1432.48it/s]
2025-03-09 09:46:20,361 [INFO]: There are 2333 embeddings of dim 49152
2025-03-09 09:46:20,361 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0266 secs
2025-03-09 09:46:20,361 [INFO]: 	Compute estimated construction time of the index 03/09/2025, 09:46:20
2025-03-09 09:46:20,361 [INFO]: 		-> Train: 16.7 minutes
2025-03-09 09:46:20,361 [INFO]: 		-> Add: 1.3 seconds
2025-03-09 09:46:20,361 [INFO]: 		Total: 16.7 minutes
2025-03-09 09:46:20,361 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0001 secs
2025-03-09 09:46:20,361 [INFO]: 	Checking that your have enough memory available to create the index 03/09/2025, 09:46:20
2025-03-09 09:46:20,361 [INFO]: 481.5MB of memory will be needed to build the index (more might be used if you have more)
2025-03-09 09:46:20,361 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0002 secs
2025-03-09 09:46:20,361 [INFO]: 	Selecting most promising index types given data characteristics 03/09/2025, 09:46:20
2025-03-09 09:46:20,361 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-09 09:46:20,361 [INFO]: 	Creating the index 03/09/2025, 09:46:20
2025-03-09 09:46:20,361 [INFO]: 		-> Instanciate the index HNSW15 03/09/2025, 09:46:20
2025-03-09 09:46:20,363 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0011 secs
2025-03-09 09:46:20,363 [INFO]: 		-> Adding the vectors to the index 03/09/2025, 09:46:20
2025-03-09 09:46:20,363 [INFO]: The memory available for adding the vectors is 49.6GB(total available - used by the index)
2025-03-09 09:46:20,363 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/10 [00:00<?, ?it/s] 10%|█         | 1/10 [00:00<00:01,  6.82it/s] 30%|███       | 3/10 [00:00<00:00,  9.96it/s] 50%|█████     | 5/10 [00:00<00:00, 10.63it/s] 70%|███████   | 7/10 [00:00<00:00, 11.59it/s] 90%|█████████ | 9/10 [00:00<00:00, 12.10it/s]100%|██████████| 10/10 [00:02<00:00,  4.37it/s]
2025-03-09 09:46:22,655 [INFO]: 	Computing best hyperparameters for index knn.index 03/09/2025, 09:46:22
2025-03-09 09:46:49,074 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 26.4185 secs
2025-03-09 09:46:49,074 [INFO]: The best hyperparameters are: efSearch=328
2025-03-09 09:46:49,074 [INFO]: 	Compute fast metrics 03/09/2025, 09:46:49
  0%|          | 0/4 [00:00<?, ?it/s] 25%|██▌       | 1/4 [00:00<00:00,  5.87it/s] 75%|███████▌  | 3/4 [00:00<00:00,  9.80it/s] 75%|███████▌  | 3/4 [00:00<00:00,  7.39it/s]
2025-03-09 09:47:02,510 [INFO]: 	>>> Finished "Compute fast metrics" in 13.4356 secs
2025-03-09 09:47:02,512 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 42.1490 secs
2025-03-09 09:47:02,512 [INFO]: {
2025-03-09 09:47:02,512 [INFO]: 	index_key: HNSW15
2025-03-09 09:47:02,512 [INFO]: 	index_param: efSearch=328
2025-03-09 09:47:02,512 [INFO]: 	index_path: knn.index
2025-03-09 09:47:02,512 [INFO]: 	size in bytes: 459003430
2025-03-09 09:47:02,512 [INFO]: 	avg_search_speed_ms: 9.244105872670584
2025-03-09 09:47:02,512 [INFO]: 	99p_search_speed_ms: 15.91990427346901
2025-03-09 09:47:02,512 [INFO]: 	reconstruction error %: 0.0
2025-03-09 09:47:02,512 [INFO]: 	nb vectors: 2333
2025-03-09 09:47:02,512 [INFO]: 	vectors dimension: 49152
2025-03-09 09:47:02,512 [INFO]: 	compression ratio: 0.9993094474261336
2025-03-09 09:47:02,512 [INFO]: }
2025-03-09 09:47:02,512 [INFO]: 	>>> Finished "Creating the index" in 42.1507 secs
2025-03-09 09:47:02,512 [INFO]: >>> Finished "Launching the whole pipeline" in 42.1780 secs
2025-03-09 09:47:03: [retrieval_preprocessing] calculating distances ...
2025-03-09 09:47:03: [retrieval_preprocessing] finished and saved retrieval indices for episode 77224 [episode count 19/20]
2025-03-09 09:47:03: [retrieval_preprocessing] finished for (8172596608, 'cup') [chosen_id count 7/10]
2025-03-09 09:47:06: [retrieval_preprocessing] concatenated all embeddings and indices for 20 episodes for (1575177183, 'marker') [chosen_id count 8/10]
2025-03-09 09:47:06: [retrieval_preprocessing] we have num_total=4742 embedding_dim=49152
[retrieval_preprocessing] for episode 3331 [episode count 0/20], we have num_retrieval=np.int64(4545) num_query=np.int64(197)
2025-03-09 09:47:07,869 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-09 09:47:08,543 [INFO]: Launching the whole pipeline 03/09/2025, 09:47:08
2025-03-09 09:47:08,543 [INFO]: Reading total number of vectors and dimension 03/09/2025, 09:47:08
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1494.76it/s]
2025-03-09 09:47:08,569 [INFO]: There are 4545 embeddings of dim 49152
2025-03-09 09:47:08,569 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0261 secs
2025-03-09 09:47:08,569 [INFO]: 	Compute estimated construction time of the index 03/09/2025, 09:47:08
2025-03-09 09:47:08,569 [INFO]: 		-> Train: 16.7 minutes
2025-03-09 09:47:08,569 [INFO]: 		-> Add: 2.5 seconds
2025-03-09 09:47:08,569 [INFO]: 		Total: 16.7 minutes
2025-03-09 09:47:08,569 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0001 secs
2025-03-09 09:47:08,569 [INFO]: 	Checking that your have enough memory available to create the index 03/09/2025, 09:47:08
2025-03-09 09:47:08,569 [INFO]: 938.0MB of memory will be needed to build the index (more might be used if you have more)
2025-03-09 09:47:08,570 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0001 secs
2025-03-09 09:47:08,570 [INFO]: 	Selecting most promising index types given data characteristics 03/09/2025, 09:47:08
2025-03-09 09:47:08,570 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-09 09:47:08,570 [INFO]: 	Creating the index 03/09/2025, 09:47:08
2025-03-09 09:47:08,570 [INFO]: 		-> Instanciate the index HNSW15 03/09/2025, 09:47:08
2025-03-09 09:47:08,571 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0011 secs
2025-03-09 09:47:08,571 [INFO]: 		-> Adding the vectors to the index 03/09/2025, 09:47:08
2025-03-09 09:47:08,571 [INFO]: The memory available for adding the vectors is 49.2GB(total available - used by the index)
2025-03-09 09:47:08,571 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/18 [00:00<?, ?it/s]  6%|▌         | 1/18 [00:00<00:02,  6.10it/s] 17%|█▋        | 3/18 [00:00<00:01,  9.18it/s] 28%|██▊       | 5/18 [00:00<00:01, 10.62it/s] 39%|███▉      | 7/18 [00:00<00:00, 11.34it/s] 50%|█████     | 9/18 [00:00<00:00, 11.71it/s] 61%|██████    | 11/18 [00:00<00:00, 12.05it/s] 72%|███████▏  | 13/18 [00:01<00:00, 12.19it/s] 83%|████████▎ | 15/18 [00:01<00:00, 12.17it/s] 94%|█████████▍| 17/18 [00:01<00:00, 12.26it/s]100%|██████████| 18/18 [00:04<00:00,  3.66it/s]
2025-03-09 09:47:13,505 [INFO]: 	Computing best hyperparameters for index knn.index 03/09/2025, 09:47:13
2025-03-09 09:47:49,766 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 36.2610 secs
2025-03-09 09:47:49,766 [INFO]: The best hyperparameters are: efSearch=285
2025-03-09 09:47:49,766 [INFO]: 	Compute fast metrics 03/09/2025, 09:47:49
  0%|          | 0/4 [00:00<?, ?it/s] 25%|██▌       | 1/4 [00:00<00:00,  6.83it/s] 75%|███████▌  | 3/4 [00:00<00:00, 12.23it/s] 75%|███████▌  | 3/4 [00:00<00:00,  9.18it/s]
2025-03-09 09:48:03,783 [INFO]: 	>>> Finished "Compute fast metrics" in 14.0168 secs
2025-03-09 09:48:03,786 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 55.2147 secs
2025-03-09 09:48:03,786 [INFO]: {
2025-03-09 09:48:03,786 [INFO]: 	index_key: HNSW15
2025-03-09 09:48:03,786 [INFO]: 	index_param: efSearch=285
2025-03-09 09:48:03,786 [INFO]: 	index_path: knn.index
2025-03-09 09:48:03,786 [INFO]: 	size in bytes: 894201490
2025-03-09 09:48:03,786 [INFO]: 	avg_search_speed_ms: 10.947868321192832
2025-03-09 09:48:03,786 [INFO]: 	99p_search_speed_ms: 20.04722120705992
2025-03-09 09:48:03,786 [INFO]: 	reconstruction error %: 0.0
2025-03-09 09:48:03,786 [INFO]: 	nb vectors: 4545
2025-03-09 09:48:03,786 [INFO]: 	vectors dimension: 49152
2025-03-09 09:48:03,786 [INFO]: 	compression ratio: 0.9993087352158181
2025-03-09 09:48:03,786 [INFO]: }
2025-03-09 09:48:03,786 [INFO]: 	>>> Finished "Creating the index" in 55.2164 secs
2025-03-09 09:48:03,786 [INFO]: >>> Finished "Launching the whole pipeline" in 55.2432 secs
2025-03-09 09:48:05: [retrieval_preprocessing] calculating distances ...
2025-03-09 09:48:05: [retrieval_preprocessing] finished and saved retrieval indices for episode 3331 [episode count 0/20]
[retrieval_preprocessing] for episode 47235 [episode count 1/20], we have num_retrieval=np.int64(4411) num_query=np.int64(331)
2025-03-09 09:48:06,904 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-09 09:48:07,478 [INFO]: Launching the whole pipeline 03/09/2025, 09:48:07
2025-03-09 09:48:07,478 [INFO]: Reading total number of vectors and dimension 03/09/2025, 09:48:07
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 2516.08it/s]
2025-03-09 09:48:07,502 [INFO]: There are 4411 embeddings of dim 49152
2025-03-09 09:48:07,502 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0242 secs
2025-03-09 09:48:07,503 [INFO]: 	Compute estimated construction time of the index 03/09/2025, 09:48:07
2025-03-09 09:48:07,503 [INFO]: 		-> Train: 16.7 minutes
2025-03-09 09:48:07,503 [INFO]: 		-> Add: 2.4 seconds
2025-03-09 09:48:07,503 [INFO]: 		Total: 16.7 minutes
2025-03-09 09:48:07,503 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0001 secs
2025-03-09 09:48:07,503 [INFO]: 	Checking that your have enough memory available to create the index 03/09/2025, 09:48:07
2025-03-09 09:48:07,503 [INFO]: 910.3MB of memory will be needed to build the index (more might be used if you have more)
2025-03-09 09:48:07,503 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0003 secs
2025-03-09 09:48:07,503 [INFO]: 	Selecting most promising index types given data characteristics 03/09/2025, 09:48:07
2025-03-09 09:48:07,503 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-09 09:48:07,503 [INFO]: 	Creating the index 03/09/2025, 09:48:07
2025-03-09 09:48:07,503 [INFO]: 		-> Instanciate the index HNSW15 03/09/2025, 09:48:07
2025-03-09 09:48:07,504 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0009 secs
2025-03-09 09:48:07,504 [INFO]: 		-> Adding the vectors to the index 03/09/2025, 09:48:07
2025-03-09 09:48:07,504 [INFO]: The memory available for adding the vectors is 49.2GB(total available - used by the index)
2025-03-09 09:48:07,504 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/18 [00:00<?, ?it/s]  6%|▌         | 1/18 [00:00<00:02,  6.06it/s] 17%|█▋        | 3/18 [00:00<00:01,  9.00it/s] 28%|██▊       | 5/18 [00:00<00:01,  9.88it/s] 39%|███▉      | 7/18 [00:00<00:01, 10.33it/s] 50%|█████     | 9/18 [00:00<00:00, 10.63it/s] 61%|██████    | 11/18 [00:01<00:00, 10.76it/s] 72%|███████▏  | 13/18 [00:01<00:00, 10.83it/s] 83%|████████▎ | 15/18 [00:01<00:00, 10.62it/s] 94%|█████████▍| 17/18 [00:01<00:00, 10.51it/s]100%|██████████| 18/18 [00:04<00:00,  4.00it/s]
2025-03-09 09:48:12,009 [INFO]: 	Computing best hyperparameters for index knn.index 03/09/2025, 09:48:12
2025-03-09 09:48:46,603 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 34.5943 secs
2025-03-09 09:48:46,603 [INFO]: The best hyperparameters are: efSearch=283
2025-03-09 09:48:46,603 [INFO]: 	Compute fast metrics 03/09/2025, 09:48:46
  0%|          | 0/4 [00:00<?, ?it/s] 25%|██▌       | 1/4 [00:00<00:00,  5.72it/s] 50%|█████     | 2/4 [00:00<00:00,  7.07it/s] 75%|███████▌  | 3/4 [00:00<00:00,  7.66it/s] 75%|███████▌  | 3/4 [00:00<00:00,  5.81it/s]
2025-03-09 09:49:10,603 [INFO]: 	>>> Finished "Compute fast metrics" in 23.9990 secs
2025-03-09 09:49:10,605 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 63.1010 secs
2025-03-09 09:49:10,606 [INFO]: {
2025-03-09 09:49:10,606 [INFO]: 	index_key: HNSW15
2025-03-09 09:49:10,606 [INFO]: 	index_param: efSearch=283
2025-03-09 09:49:10,606 [INFO]: 	index_path: knn.index
2025-03-09 09:49:10,606 [INFO]: 	size in bytes: 867837850
2025-03-09 09:49:10,606 [INFO]: 	avg_search_speed_ms: 11.217198531705085
2025-03-09 09:49:10,606 [INFO]: 	99p_search_speed_ms: 14.816123845521362
2025-03-09 09:49:10,606 [INFO]: 	reconstruction error %: 0.0
2025-03-09 09:49:10,606 [INFO]: 	nb vectors: 4411
2025-03-09 09:49:10,606 [INFO]: 	vectors dimension: 49152
2025-03-09 09:49:10,606 [INFO]: 	compression ratio: 0.9993086703927467
2025-03-09 09:49:10,606 [INFO]: }
2025-03-09 09:49:10,606 [INFO]: 	>>> Finished "Creating the index" in 63.1024 secs
2025-03-09 09:49:10,606 [INFO]: >>> Finished "Launching the whole pipeline" in 63.1274 secs
2025-03-09 09:49:13: [retrieval_preprocessing] calculating distances ...
2025-03-09 09:49:14: [retrieval_preprocessing] finished and saved retrieval indices for episode 47235 [episode count 1/20]
[retrieval_preprocessing] for episode 67459 [episode count 2/20], we have num_retrieval=np.int64(4501) num_query=np.int64(241)
2025-03-09 09:49:16,125 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-09 09:49:17,544 [INFO]: Launching the whole pipeline 03/09/2025, 09:49:17
2025-03-09 09:49:17,544 [INFO]: Reading total number of vectors and dimension 03/09/2025, 09:49:17
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1646.76it/s]
2025-03-09 09:49:17,572 [INFO]: There are 4501 embeddings of dim 49152
2025-03-09 09:49:17,572 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0278 secs
2025-03-09 09:49:17,572 [INFO]: 	Compute estimated construction time of the index 03/09/2025, 09:49:17
2025-03-09 09:49:17,572 [INFO]: 		-> Train: 16.7 minutes
2025-03-09 09:49:17,572 [INFO]: 		-> Add: 2.5 seconds
2025-03-09 09:49:17,572 [INFO]: 		Total: 16.7 minutes
2025-03-09 09:49:17,572 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0001 secs
2025-03-09 09:49:17,572 [INFO]: 	Checking that your have enough memory available to create the index 03/09/2025, 09:49:17
2025-03-09 09:49:17,573 [INFO]: 928.9MB of memory will be needed to build the index (more might be used if you have more)
2025-03-09 09:49:17,573 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0002 secs
2025-03-09 09:49:17,573 [INFO]: 	Selecting most promising index types given data characteristics 03/09/2025, 09:49:17
2025-03-09 09:49:17,573 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-09 09:49:17,573 [INFO]: 	Creating the index 03/09/2025, 09:49:17
2025-03-09 09:49:17,573 [INFO]: 		-> Instanciate the index HNSW15 03/09/2025, 09:49:17
2025-03-09 09:49:17,574 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0011 secs
2025-03-09 09:49:17,574 [INFO]: 		-> Adding the vectors to the index 03/09/2025, 09:49:17
2025-03-09 09:49:17,574 [INFO]: The memory available for adding the vectors is 49.2GB(total available - used by the index)
2025-03-09 09:49:17,574 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/18 [00:00<?, ?it/s]  6%|▌         | 1/18 [00:00<00:03,  5.37it/s] 17%|█▋        | 3/18 [00:00<00:01,  8.46it/s] 28%|██▊       | 5/18 [00:00<00:01,  9.31it/s] 39%|███▉      | 7/18 [00:00<00:01,  9.80it/s] 50%|█████     | 9/18 [00:00<00:00, 10.33it/s] 61%|██████    | 11/18 [00:01<00:00, 10.99it/s] 72%|███████▏  | 13/18 [00:01<00:00, 11.47it/s] 83%|████████▎ | 15/18 [00:01<00:00, 11.92it/s] 94%|█████████▍| 17/18 [00:01<00:00, 13.04it/s]100%|██████████| 18/18 [00:04<00:00,  4.08it/s]
2025-03-09 09:49:21,999 [INFO]: 	Computing best hyperparameters for index knn.index 03/09/2025, 09:49:21
2025-03-09 09:50:00,440 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 38.4409 secs
2025-03-09 09:50:00,441 [INFO]: The best hyperparameters are: efSearch=248
2025-03-09 09:50:00,441 [INFO]: 	Compute fast metrics 03/09/2025, 09:50:00
  0%|          | 0/4 [00:00<?, ?it/s] 25%|██▌       | 1/4 [00:00<00:00,  5.12it/s] 50%|█████     | 2/4 [00:00<00:00,  6.79it/s] 75%|███████▌  | 3/4 [00:00<00:00,  7.59it/s] 75%|███████▌  | 3/4 [00:00<00:00,  5.72it/s]
2025-03-09 09:50:16,704 [INFO]: 	>>> Finished "Compute fast metrics" in 16.2630 secs
2025-03-09 09:50:16,707 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 59.1326 secs
2025-03-09 09:50:16,707 [INFO]: {
2025-03-09 09:50:16,707 [INFO]: 	index_key: HNSW15
2025-03-09 09:50:16,707 [INFO]: 	index_param: efSearch=248
2025-03-09 09:50:16,707 [INFO]: 	index_path: knn.index
2025-03-09 09:50:16,707 [INFO]: 	size in bytes: 885544810
2025-03-09 09:50:16,707 [INFO]: 	avg_search_speed_ms: 9.11484427521737
2025-03-09 09:50:16,707 [INFO]: 	99p_search_speed_ms: 17.539004357531642
2025-03-09 09:50:16,707 [INFO]: 	reconstruction error %: 0.0
2025-03-09 09:50:16,707 [INFO]: 	nb vectors: 4501
2025-03-09 09:50:16,707 [INFO]: 	vectors dimension: 49152
2025-03-09 09:50:16,707 [INFO]: 	compression ratio: 0.999308671912379
2025-03-09 09:50:16,707 [INFO]: }
2025-03-09 09:50:16,707 [INFO]: 	>>> Finished "Creating the index" in 59.1343 secs
2025-03-09 09:50:16,707 [INFO]: >>> Finished "Launching the whole pipeline" in 59.1628 secs
2025-03-09 09:50:18: [retrieval_preprocessing] calculating distances ...
2025-03-09 09:50:19: [retrieval_preprocessing] finished and saved retrieval indices for episode 67459 [episode count 2/20]
[retrieval_preprocessing] for episode 71686 [episode count 3/20], we have num_retrieval=np.int64(4493) num_query=np.int64(249)
2025-03-09 09:50:21,011 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-09 09:50:21,650 [INFO]: Launching the whole pipeline 03/09/2025, 09:50:21
2025-03-09 09:50:21,650 [INFO]: Reading total number of vectors and dimension 03/09/2025, 09:50:21
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1348.65it/s]
2025-03-09 09:50:21,675 [INFO]: There are 4493 embeddings of dim 49152
2025-03-09 09:50:21,675 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0250 secs
2025-03-09 09:50:21,675 [INFO]: 	Compute estimated construction time of the index 03/09/2025, 09:50:21
2025-03-09 09:50:21,675 [INFO]: 		-> Train: 16.7 minutes
2025-03-09 09:50:21,675 [INFO]: 		-> Add: 2.5 seconds
2025-03-09 09:50:21,675 [INFO]: 		Total: 16.7 minutes
2025-03-09 09:50:21,675 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0002 secs
2025-03-09 09:50:21,676 [INFO]: 	Checking that your have enough memory available to create the index 03/09/2025, 09:50:21
2025-03-09 09:50:21,676 [INFO]: 927.2MB of memory will be needed to build the index (more might be used if you have more)
2025-03-09 09:50:21,676 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0002 secs
2025-03-09 09:50:21,676 [INFO]: 	Selecting most promising index types given data characteristics 03/09/2025, 09:50:21
2025-03-09 09:50:21,676 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-09 09:50:21,676 [INFO]: 	Creating the index 03/09/2025, 09:50:21
2025-03-09 09:50:21,676 [INFO]: 		-> Instanciate the index HNSW15 03/09/2025, 09:50:21
2025-03-09 09:50:21,677 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0013 secs
2025-03-09 09:50:21,677 [INFO]: 		-> Adding the vectors to the index 03/09/2025, 09:50:21
2025-03-09 09:50:21,678 [INFO]: The memory available for adding the vectors is 49.2GB(total available - used by the index)
2025-03-09 09:50:21,678 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/18 [00:00<?, ?it/s]  6%|▌         | 1/18 [00:00<00:03,  4.77it/s] 11%|█         | 2/18 [00:00<00:02,  6.55it/s] 17%|█▋        | 3/18 [00:00<00:02,  7.46it/s] 22%|██▏       | 4/18 [00:00<00:01,  7.94it/s] 28%|██▊       | 5/18 [00:00<00:01,  8.37it/s] 33%|███▎      | 6/18 [00:00<00:01,  8.55it/s] 39%|███▉      | 7/18 [00:00<00:01,  8.72it/s] 44%|████▍     | 8/18 [00:00<00:01,  8.84it/s] 50%|█████     | 9/18 [00:01<00:01,  8.93it/s] 56%|█████▌    | 10/18 [00:01<00:00,  9.08it/s] 61%|██████    | 11/18 [00:01<00:00,  9.08it/s] 67%|██████▋   | 12/18 [00:01<00:00,  9.09it/s] 72%|███████▏  | 13/18 [00:01<00:00,  9.12it/s] 78%|███████▊  | 14/18 [00:01<00:00,  9.11it/s] 89%|████████▉ | 16/18 [00:01<00:00, 10.06it/s]100%|██████████| 18/18 [00:05<00:00,  1.37it/s]100%|██████████| 18/18 [00:05<00:00,  3.47it/s]
2025-03-09 09:50:26,870 [INFO]: 	Computing best hyperparameters for index knn.index 03/09/2025, 09:50:26
2025-03-09 09:51:06,804 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 39.9339 secs
2025-03-09 09:51:06,805 [INFO]: The best hyperparameters are: efSearch=229
2025-03-09 09:51:06,805 [INFO]: 	Compute fast metrics 03/09/2025, 09:51:06
  0%|          | 0/4 [00:00<?, ?it/s] 25%|██▌       | 1/4 [00:00<00:00,  5.36it/s] 50%|█████     | 2/4 [00:00<00:00,  6.98it/s] 75%|███████▌  | 3/4 [00:00<00:00,  7.53it/s] 75%|███████▌  | 3/4 [00:00<00:00,  5.63it/s]
2025-03-09 09:51:29,291 [INFO]: 	>>> Finished "Compute fast metrics" in 22.4860 secs
2025-03-09 09:51:29,294 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 67.6162 secs
2025-03-09 09:51:29,294 [INFO]: {
2025-03-09 09:51:29,294 [INFO]: 	index_key: HNSW15
2025-03-09 09:51:29,294 [INFO]: 	index_param: efSearch=229
2025-03-09 09:51:29,294 [INFO]: 	index_path: knn.index
2025-03-09 09:51:29,294 [INFO]: 	size in bytes: 883970890
2025-03-09 09:51:29,294 [INFO]: 	avg_search_speed_ms: 9.17085043363991
2025-03-09 09:51:29,294 [INFO]: 	99p_search_speed_ms: 17.412419510073928
2025-03-09 09:51:29,294 [INFO]: 	reconstruction error %: 0.0
2025-03-09 09:51:29,294 [INFO]: 	nb vectors: 4493
2025-03-09 09:51:29,294 [INFO]: 	vectors dimension: 49152
2025-03-09 09:51:29,294 [INFO]: 	compression ratio: 0.999308635604505
2025-03-09 09:51:29,294 [INFO]: }
2025-03-09 09:51:29,294 [INFO]: 	>>> Finished "Creating the index" in 67.6180 secs
2025-03-09 09:51:29,294 [INFO]: >>> Finished "Launching the whole pipeline" in 67.6438 secs
2025-03-09 09:51:31: [retrieval_preprocessing] calculating distances ...
2025-03-09 09:51:31: [retrieval_preprocessing] finished and saved retrieval indices for episode 71686 [episode count 3/20]
[retrieval_preprocessing] for episode 72710 [episode count 4/20], we have num_retrieval=np.int64(4547) num_query=np.int64(195)
2025-03-09 09:51:32,844 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-09 09:51:33,481 [INFO]: Launching the whole pipeline 03/09/2025, 09:51:33
2025-03-09 09:51:33,482 [INFO]: Reading total number of vectors and dimension 03/09/2025, 09:51:33
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1261.07it/s]
2025-03-09 09:51:33,508 [INFO]: There are 4547 embeddings of dim 49152
2025-03-09 09:51:33,508 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0267 secs
2025-03-09 09:51:33,508 [INFO]: 	Compute estimated construction time of the index 03/09/2025, 09:51:33
2025-03-09 09:51:33,508 [INFO]: 		-> Train: 16.7 minutes
2025-03-09 09:51:33,508 [INFO]: 		-> Add: 2.5 seconds
2025-03-09 09:51:33,508 [INFO]: 		Total: 16.7 minutes
2025-03-09 09:51:33,508 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0001 secs
2025-03-09 09:51:33,508 [INFO]: 	Checking that your have enough memory available to create the index 03/09/2025, 09:51:33
2025-03-09 09:51:33,509 [INFO]: 938.4MB of memory will be needed to build the index (more might be used if you have more)
2025-03-09 09:51:33,509 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0002 secs
2025-03-09 09:51:33,509 [INFO]: 	Selecting most promising index types given data characteristics 03/09/2025, 09:51:33
2025-03-09 09:51:33,509 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-09 09:51:33,509 [INFO]: 	Creating the index 03/09/2025, 09:51:33
2025-03-09 09:51:33,509 [INFO]: 		-> Instanciate the index HNSW15 03/09/2025, 09:51:33
2025-03-09 09:51:33,510 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0013 secs
2025-03-09 09:51:33,510 [INFO]: 		-> Adding the vectors to the index 03/09/2025, 09:51:33
2025-03-09 09:51:33,510 [INFO]: The memory available for adding the vectors is 49.2GB(total available - used by the index)
2025-03-09 09:51:33,510 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/18 [00:00<?, ?it/s]  6%|▌         | 1/18 [00:00<00:02,  6.40it/s] 28%|██▊       | 5/18 [00:00<00:00, 21.13it/s] 50%|█████     | 9/18 [00:00<00:00, 26.94it/s] 67%|██████▋   | 12/18 [00:00<00:00, 25.77it/s] 83%|████████▎ | 15/18 [00:00<00:00, 24.39it/s]100%|██████████| 18/18 [00:04<00:00,  2.28it/s]100%|██████████| 18/18 [00:04<00:00,  4.12it/s]
2025-03-09 09:51:37,890 [INFO]: 	Computing best hyperparameters for index knn.index 03/09/2025, 09:51:37
2025-03-09 09:52:18,084 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 40.1936 secs
2025-03-09 09:52:18,085 [INFO]: The best hyperparameters are: efSearch=243
2025-03-09 09:52:18,085 [INFO]: 	Compute fast metrics 03/09/2025, 09:52:18
  0%|          | 0/4 [00:00<?, ?it/s] 25%|██▌       | 1/4 [00:00<00:00,  5.54it/s] 50%|█████     | 2/4 [00:00<00:00,  7.26it/s] 75%|███████▌  | 3/4 [00:00<00:00,  7.96it/s] 75%|███████▌  | 3/4 [00:00<00:00,  6.00it/s]
2025-03-09 09:52:43,546 [INFO]: 	>>> Finished "Compute fast metrics" in 25.4613 secs
2025-03-09 09:52:43,549 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 70.0385 secs
2025-03-09 09:52:43,549 [INFO]: {
2025-03-09 09:52:43,549 [INFO]: 	index_key: HNSW15
2025-03-09 09:52:43,549 [INFO]: 	index_param: efSearch=243
2025-03-09 09:52:43,549 [INFO]: 	index_path: knn.index
2025-03-09 09:52:43,549 [INFO]: 	size in bytes: 894594970
2025-03-09 09:52:43,549 [INFO]: 	avg_search_speed_ms: 9.767646053660428
2025-03-09 09:52:43,549 [INFO]: 	99p_search_speed_ms: 19.445442412979897
2025-03-09 09:52:43,549 [INFO]: 	reconstruction error %: 0.0
2025-03-09 09:52:43,549 [INFO]: 	nb vectors: 4547
2025-03-09 09:52:43,549 [INFO]: 	vectors dimension: 49152
2025-03-09 09:52:43,549 [INFO]: 	compression ratio: 0.9993087441571463
2025-03-09 09:52:43,549 [INFO]: }
2025-03-09 09:52:43,549 [INFO]: 	>>> Finished "Creating the index" in 70.0403 secs
2025-03-09 09:52:43,549 [INFO]: >>> Finished "Launching the whole pipeline" in 70.0677 secs
2025-03-09 09:52:44: [retrieval_preprocessing] calculating distances ...
2025-03-09 09:52:45: [retrieval_preprocessing] finished and saved retrieval indices for episode 72710 [episode count 4/20]
[retrieval_preprocessing] for episode 50313 [episode count 5/20], we have num_retrieval=np.int64(4469) num_query=np.int64(273)
2025-03-09 09:52:46,565 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-09 09:52:47,148 [INFO]: Launching the whole pipeline 03/09/2025, 09:52:47
2025-03-09 09:52:47,148 [INFO]: Reading total number of vectors and dimension 03/09/2025, 09:52:47
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1459.40it/s]
2025-03-09 09:52:47,174 [INFO]: There are 4469 embeddings of dim 49152
2025-03-09 09:52:47,174 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0261 secs
2025-03-09 09:52:47,174 [INFO]: 	Compute estimated construction time of the index 03/09/2025, 09:52:47
2025-03-09 09:52:47,174 [INFO]: 		-> Train: 16.7 minutes
2025-03-09 09:52:47,174 [INFO]: 		-> Add: 2.5 seconds
2025-03-09 09:52:47,174 [INFO]: 		Total: 16.7 minutes
2025-03-09 09:52:47,174 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0001 secs
2025-03-09 09:52:47,174 [INFO]: 	Checking that your have enough memory available to create the index 03/09/2025, 09:52:47
2025-03-09 09:52:47,174 [INFO]: 922.3MB of memory will be needed to build the index (more might be used if you have more)
2025-03-09 09:52:47,174 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0001 secs
2025-03-09 09:52:47,174 [INFO]: 	Selecting most promising index types given data characteristics 03/09/2025, 09:52:47
2025-03-09 09:52:47,174 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-09 09:52:47,174 [INFO]: 	Creating the index 03/09/2025, 09:52:47
2025-03-09 09:52:47,174 [INFO]: 		-> Instanciate the index HNSW15 03/09/2025, 09:52:47
2025-03-09 09:52:47,176 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0011 secs
2025-03-09 09:52:47,176 [INFO]: 		-> Adding the vectors to the index 03/09/2025, 09:52:47
2025-03-09 09:52:47,176 [INFO]: The memory available for adding the vectors is 49.2GB(total available - used by the index)
2025-03-09 09:52:47,176 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/18 [00:00<?, ?it/s]  6%|▌         | 1/18 [00:00<00:03,  4.87it/s] 11%|█         | 2/18 [00:00<00:02,  6.57it/s] 17%|█▋        | 3/18 [00:00<00:02,  7.43it/s] 22%|██▏       | 4/18 [00:00<00:01,  7.97it/s] 28%|██▊       | 5/18 [00:00<00:01,  8.52it/s] 33%|███▎      | 6/18 [00:00<00:01,  8.68it/s] 39%|███▉      | 7/18 [00:00<00:01,  8.73it/s] 44%|████▍     | 8/18 [00:00<00:01,  8.76it/s] 50%|█████     | 9/18 [00:01<00:01,  8.78it/s] 56%|█████▌    | 10/18 [00:01<00:00,  8.80it/s] 61%|██████    | 11/18 [00:01<00:00,  8.94it/s] 67%|██████▋   | 12/18 [00:01<00:00,  8.84it/s] 72%|███████▏  | 13/18 [00:01<00:00,  8.79it/s] 78%|███████▊  | 14/18 [00:01<00:00,  9.11it/s] 89%|████████▉ | 16/18 [00:01<00:00, 10.63it/s]100%|██████████| 18/18 [00:05<00:00,  1.40it/s]100%|██████████| 18/18 [00:05<00:00,  3.51it/s]
2025-03-09 09:52:52,302 [INFO]: 	Computing best hyperparameters for index knn.index 03/09/2025, 09:52:52
2025-03-09 09:53:31,787 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 39.4850 secs
2025-03-09 09:53:31,788 [INFO]: The best hyperparameters are: efSearch=240
2025-03-09 09:53:31,788 [INFO]: 	Compute fast metrics 03/09/2025, 09:53:31
  0%|          | 0/4 [00:00<?, ?it/s] 25%|██▌       | 1/4 [00:00<00:00,  5.52it/s] 50%|█████     | 2/4 [00:00<00:00,  7.41it/s] 75%|███████▌  | 3/4 [00:00<00:00,  8.32it/s] 75%|███████▌  | 3/4 [00:00<00:00,  6.23it/s]
2025-03-09 09:53:54,077 [INFO]: 	>>> Finished "Compute fast metrics" in 22.2894 secs
2025-03-09 09:53:54,080 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 66.9045 secs
2025-03-09 09:53:54,080 [INFO]: {
2025-03-09 09:53:54,080 [INFO]: 	index_key: HNSW15
2025-03-09 09:53:54,080 [INFO]: 	index_param: efSearch=240
2025-03-09 09:53:54,080 [INFO]: 	index_path: knn.index
2025-03-09 09:53:54,080 [INFO]: 	size in bytes: 879249010
2025-03-09 09:53:54,080 [INFO]: 	avg_search_speed_ms: 9.764518983729431
2025-03-09 09:53:54,080 [INFO]: 	99p_search_speed_ms: 19.115778575651344
2025-03-09 09:53:54,080 [INFO]: 	reconstruction error %: 0.0
2025-03-09 09:53:54,080 [INFO]: 	nb vectors: 4469
2025-03-09 09:53:54,080 [INFO]: 	vectors dimension: 49152
2025-03-09 09:53:54,080 [INFO]: 	compression ratio: 0.9993086622866939
2025-03-09 09:53:54,081 [INFO]: }
2025-03-09 09:53:54,081 [INFO]: 	>>> Finished "Creating the index" in 66.9062 secs
2025-03-09 09:53:54,081 [INFO]: >>> Finished "Launching the whole pipeline" in 66.9328 secs
2025-03-09 09:53:56: [retrieval_preprocessing] calculating distances ...
2025-03-09 09:53:57: [retrieval_preprocessing] finished and saved retrieval indices for episode 50313 [episode count 5/20]
[retrieval_preprocessing] for episode 53905 [episode count 6/20], we have num_retrieval=np.int64(4460) num_query=np.int64(282)
2025-03-09 09:53:59,411 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-09 09:54:00,180 [INFO]: Launching the whole pipeline 03/09/2025, 09:54:00
2025-03-09 09:54:00,180 [INFO]: Reading total number of vectors and dimension 03/09/2025, 09:54:00
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 2208.69it/s]
2025-03-09 09:54:00,208 [INFO]: There are 4460 embeddings of dim 49152
2025-03-09 09:54:00,208 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0282 secs
2025-03-09 09:54:00,208 [INFO]: 	Compute estimated construction time of the index 03/09/2025, 09:54:00
2025-03-09 09:54:00,209 [INFO]: 		-> Train: 16.7 minutes
2025-03-09 09:54:00,209 [INFO]: 		-> Add: 2.4 seconds
2025-03-09 09:54:00,209 [INFO]: 		Total: 16.7 minutes
2025-03-09 09:54:00,209 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0005 secs
2025-03-09 09:54:00,209 [INFO]: 	Checking that your have enough memory available to create the index 03/09/2025, 09:54:00
2025-03-09 09:54:00,210 [INFO]: 920.4MB of memory will be needed to build the index (more might be used if you have more)
2025-03-09 09:54:00,210 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0005 secs
2025-03-09 09:54:00,210 [INFO]: 	Selecting most promising index types given data characteristics 03/09/2025, 09:54:00
2025-03-09 09:54:00,210 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-09 09:54:00,210 [INFO]: 	Creating the index 03/09/2025, 09:54:00
2025-03-09 09:54:00,211 [INFO]: 		-> Instanciate the index HNSW15 03/09/2025, 09:54:00
2025-03-09 09:54:00,214 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0028 secs
2025-03-09 09:54:00,214 [INFO]: 		-> Adding the vectors to the index 03/09/2025, 09:54:00
2025-03-09 09:54:00,214 [INFO]: The memory available for adding the vectors is 49.2GB(total available - used by the index)
2025-03-09 09:54:00,214 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/18 [00:00<?, ?it/s]  6%|▌         | 1/18 [00:00<00:02,  5.92it/s] 17%|█▋        | 3/18 [00:00<00:01, 10.73it/s] 28%|██▊       | 5/18 [00:00<00:01, 12.09it/s] 39%|███▉      | 7/18 [00:00<00:00, 12.11it/s] 50%|█████     | 9/18 [00:00<00:00, 12.05it/s] 61%|██████    | 11/18 [00:00<00:00, 12.10it/s] 72%|███████▏  | 13/18 [00:01<00:00, 11.86it/s] 83%|████████▎ | 15/18 [00:01<00:00, 11.81it/s] 94%|█████████▍| 17/18 [00:01<00:00, 11.49it/s]100%|██████████| 18/18 [00:04<00:00,  3.92it/s]
2025-03-09 09:54:04,811 [INFO]: 	Computing best hyperparameters for index knn.index 03/09/2025, 09:54:04
2025-03-09 09:54:43,845 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 39.0332 secs
2025-03-09 09:54:43,845 [INFO]: The best hyperparameters are: efSearch=217
2025-03-09 09:54:43,845 [INFO]: 	Compute fast metrics 03/09/2025, 09:54:43
  0%|          | 0/4 [00:00<?, ?it/s] 25%|██▌       | 1/4 [00:00<00:00,  5.60it/s] 50%|█████     | 2/4 [00:00<00:00,  5.90it/s] 75%|███████▌  | 3/4 [00:00<00:00,  6.21it/s] 75%|███████▌  | 3/4 [00:00<00:00,  5.08it/s]
2025-03-09 09:55:05,640 [INFO]: 	>>> Finished "Compute fast metrics" in 21.7952 secs
2025-03-09 09:55:05,643 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 65.4291 secs
2025-03-09 09:55:05,644 [INFO]: {
2025-03-09 09:55:05,644 [INFO]: 	index_key: HNSW15
2025-03-09 09:55:05,644 [INFO]: 	index_param: efSearch=217
2025-03-09 09:55:05,644 [INFO]: 	index_path: knn.index
2025-03-09 09:55:05,644 [INFO]: 	size in bytes: 877478350
2025-03-09 09:55:05,644 [INFO]: 	avg_search_speed_ms: 8.349468904346825
2025-03-09 09:55:05,644 [INFO]: 	99p_search_speed_ms: 15.080000718589869
2025-03-09 09:55:05,644 [INFO]: 	reconstruction error %: 0.0
2025-03-09 09:55:05,644 [INFO]: 	nb vectors: 4460
2025-03-09 09:55:05,644 [INFO]: 	vectors dimension: 49152
2025-03-09 09:55:05,644 [INFO]: 	compression ratio: 0.9993086211186862
2025-03-09 09:55:05,644 [INFO]: }
2025-03-09 09:55:05,644 [INFO]: 	>>> Finished "Creating the index" in 65.4335 secs
2025-03-09 09:55:05,644 [INFO]: >>> Finished "Launching the whole pipeline" in 65.4642 secs
2025-03-09 09:55:07: [retrieval_preprocessing] calculating distances ...
2025-03-09 09:55:08: [retrieval_preprocessing] finished and saved retrieval indices for episode 53905 [episode count 6/20]
[retrieval_preprocessing] for episode 46738 [episode count 7/20], we have num_retrieval=np.int64(4529) num_query=np.int64(213)
2025-03-09 09:55:09,445 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-09 09:55:10,068 [INFO]: Launching the whole pipeline 03/09/2025, 09:55:10
2025-03-09 09:55:10,068 [INFO]: Reading total number of vectors and dimension 03/09/2025, 09:55:10
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 2319.86it/s]
2025-03-09 09:55:10,092 [INFO]: There are 4529 embeddings of dim 49152
2025-03-09 09:55:10,092 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0242 secs
2025-03-09 09:55:10,092 [INFO]: 	Compute estimated construction time of the index 03/09/2025, 09:55:10
2025-03-09 09:55:10,092 [INFO]: 		-> Train: 16.7 minutes
2025-03-09 09:55:10,092 [INFO]: 		-> Add: 2.5 seconds
2025-03-09 09:55:10,092 [INFO]: 		Total: 16.7 minutes
2025-03-09 09:55:10,093 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0001 secs
2025-03-09 09:55:10,093 [INFO]: 	Checking that your have enough memory available to create the index 03/09/2025, 09:55:10
2025-03-09 09:55:10,093 [INFO]: 934.7MB of memory will be needed to build the index (more might be used if you have more)
2025-03-09 09:55:10,093 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0001 secs
2025-03-09 09:55:10,093 [INFO]: 	Selecting most promising index types given data characteristics 03/09/2025, 09:55:10
2025-03-09 09:55:10,093 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-09 09:55:10,093 [INFO]: 	Creating the index 03/09/2025, 09:55:10
2025-03-09 09:55:10,093 [INFO]: 		-> Instanciate the index HNSW15 03/09/2025, 09:55:10
2025-03-09 09:55:10,094 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0010 secs
2025-03-09 09:55:10,094 [INFO]: 		-> Adding the vectors to the index 03/09/2025, 09:55:10
2025-03-09 09:55:10,094 [INFO]: The memory available for adding the vectors is 49.2GB(total available - used by the index)
2025-03-09 09:55:10,094 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/18 [00:00<?, ?it/s]  6%|▌         | 1/18 [00:00<00:02,  6.52it/s] 22%|██▏       | 4/18 [00:00<00:00, 16.19it/s] 33%|███▎      | 6/18 [00:00<00:00, 16.80it/s] 50%|█████     | 9/18 [00:00<00:00, 17.87it/s] 61%|██████    | 11/18 [00:00<00:00, 16.82it/s] 72%|███████▏  | 13/18 [00:00<00:00, 15.12it/s] 83%|████████▎ | 15/18 [00:01<00:00, 14.09it/s] 94%|█████████▍| 17/18 [00:01<00:00, 14.03it/s]100%|██████████| 18/18 [00:04<00:00,  3.96it/s]
2025-03-09 09:55:14,651 [INFO]: 	Computing best hyperparameters for index knn.index 03/09/2025, 09:55:14
2025-03-09 09:55:52,310 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 37.6589 secs
2025-03-09 09:55:52,311 [INFO]: The best hyperparameters are: efSearch=149
2025-03-09 09:55:52,311 [INFO]: 	Compute fast metrics 03/09/2025, 09:55:52
  0%|          | 0/4 [00:00<?, ?it/s] 25%|██▌       | 1/4 [00:00<00:00,  5.81it/s] 75%|███████▌  | 3/4 [00:00<00:00,  9.65it/s] 75%|███████▌  | 3/4 [00:00<00:00,  7.43it/s]
2025-03-09 09:56:16,711 [INFO]: 	>>> Finished "Compute fast metrics" in 24.4005 secs
2025-03-09 09:56:16,714 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 66.6200 secs
2025-03-09 09:56:16,714 [INFO]: {
2025-03-09 09:56:16,714 [INFO]: 	index_key: HNSW15
2025-03-09 09:56:16,714 [INFO]: 	index_param: efSearch=149
2025-03-09 09:56:16,714 [INFO]: 	index_path: knn.index
2025-03-09 09:56:16,714 [INFO]: 	size in bytes: 891053530
2025-03-09 09:56:16,714 [INFO]: 	avg_search_speed_ms: 6.041863909148783
2025-03-09 09:56:16,714 [INFO]: 	99p_search_speed_ms: 11.179063539020719
2025-03-09 09:56:16,714 [INFO]: 	reconstruction error %: 0.0
2025-03-09 09:56:16,714 [INFO]: 	nb vectors: 4529
2025-03-09 09:56:16,714 [INFO]: 	vectors dimension: 49152
2025-03-09 09:56:16,714 [INFO]: 	compression ratio: 0.9993087979798475
2025-03-09 09:56:16,714 [INFO]: }
2025-03-09 09:56:16,714 [INFO]: 	>>> Finished "Creating the index" in 66.6216 secs
2025-03-09 09:56:16,714 [INFO]: >>> Finished "Launching the whole pipeline" in 66.6464 secs
2025-03-09 09:56:17: [retrieval_preprocessing] calculating distances ...
2025-03-09 09:56:18: [retrieval_preprocessing] finished and saved retrieval indices for episode 46738 [episode count 7/20]
[retrieval_preprocessing] for episode 62228 [episode count 8/20], we have num_retrieval=np.int64(4532) num_query=np.int64(210)
2025-03-09 09:56:19,619 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-09 09:56:20,246 [INFO]: Launching the whole pipeline 03/09/2025, 09:56:20
2025-03-09 09:56:20,246 [INFO]: Reading total number of vectors and dimension 03/09/2025, 09:56:20
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1712.66it/s]
2025-03-09 09:56:20,271 [INFO]: There are 4532 embeddings of dim 49152
2025-03-09 09:56:20,272 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0252 secs
2025-03-09 09:56:20,272 [INFO]: 	Compute estimated construction time of the index 03/09/2025, 09:56:20
2025-03-09 09:56:20,272 [INFO]: 		-> Train: 16.7 minutes
2025-03-09 09:56:20,272 [INFO]: 		-> Add: 2.5 seconds
2025-03-09 09:56:20,272 [INFO]: 		Total: 16.7 minutes
2025-03-09 09:56:20,272 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0005 secs
2025-03-09 09:56:20,272 [INFO]: 	Checking that your have enough memory available to create the index 03/09/2025, 09:56:20
2025-03-09 09:56:20,273 [INFO]: 935.3MB of memory will be needed to build the index (more might be used if you have more)
2025-03-09 09:56:20,273 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0004 secs
2025-03-09 09:56:20,273 [INFO]: 	Selecting most promising index types given data characteristics 03/09/2025, 09:56:20
2025-03-09 09:56:20,273 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-09 09:56:20,274 [INFO]: 	Creating the index 03/09/2025, 09:56:20
2025-03-09 09:56:20,274 [INFO]: 		-> Instanciate the index HNSW15 03/09/2025, 09:56:20
2025-03-09 09:56:20,277 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0026 secs
2025-03-09 09:56:20,277 [INFO]: 		-> Adding the vectors to the index 03/09/2025, 09:56:20
2025-03-09 09:56:20,277 [INFO]: The memory available for adding the vectors is 49.2GB(total available - used by the index)
2025-03-09 09:56:20,277 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/18 [00:00<?, ?it/s]  6%|▌         | 1/18 [00:00<00:03,  4.88it/s] 11%|█         | 2/18 [00:00<00:02,  6.49it/s] 17%|█▋        | 3/18 [00:00<00:02,  7.38it/s] 22%|██▏       | 4/18 [00:00<00:01,  7.75it/s] 28%|██▊       | 5/18 [00:00<00:01,  7.98it/s] 33%|███▎      | 6/18 [00:00<00:01,  8.13it/s] 39%|███▉      | 7/18 [00:00<00:01,  8.22it/s] 44%|████▍     | 8/18 [00:01<00:01,  8.40it/s] 50%|█████     | 9/18 [00:01<00:01,  8.42it/s] 56%|█████▌    | 10/18 [00:01<00:00,  8.22it/s] 61%|██████    | 11/18 [00:01<00:00,  8.22it/s] 67%|██████▋   | 12/18 [00:01<00:00,  8.13it/s] 72%|███████▏  | 13/18 [00:01<00:00,  8.19it/s] 78%|███████▊  | 14/18 [00:01<00:00,  8.42it/s] 83%|████████▎ | 15/18 [00:01<00:00,  8.56it/s] 89%|████████▉ | 16/18 [00:01<00:00,  8.71it/s]100%|██████████| 18/18 [00:05<00:00,  1.21it/s]100%|██████████| 18/18 [00:05<00:00,  3.41it/s]
2025-03-09 09:56:25,571 [INFO]: 	Computing best hyperparameters for index knn.index 03/09/2025, 09:56:25
2025-03-09 09:57:06,527 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 40.9552 secs
2025-03-09 09:57:06,528 [INFO]: The best hyperparameters are: efSearch=239
2025-03-09 09:57:06,528 [INFO]: 	Compute fast metrics 03/09/2025, 09:57:06
  0%|          | 0/4 [00:00<?, ?it/s] 25%|██▌       | 1/4 [00:00<00:00,  5.77it/s] 50%|█████     | 2/4 [00:00<00:00,  7.47it/s] 75%|███████▌  | 3/4 [00:00<00:00,  8.15it/s] 75%|███████▌  | 3/4 [00:00<00:00,  6.18it/s]
2025-03-09 09:57:29,205 [INFO]: 	>>> Finished "Compute fast metrics" in 22.6771 secs
2025-03-09 09:57:29,209 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 68.9320 secs
2025-03-09 09:57:29,209 [INFO]: {
2025-03-09 09:57:29,209 [INFO]: 	index_key: HNSW15
2025-03-09 09:57:29,209 [INFO]: 	index_param: efSearch=239
2025-03-09 09:57:29,209 [INFO]: 	index_path: knn.index
2025-03-09 09:57:29,209 [INFO]: 	size in bytes: 891643750
2025-03-09 09:57:29,209 [INFO]: 	avg_search_speed_ms: 10.086085379037227
2025-03-09 09:57:29,209 [INFO]: 	99p_search_speed_ms: 18.070854269899428
2025-03-09 09:57:29,209 [INFO]: 	reconstruction error %: 0.0
2025-03-09 09:57:29,209 [INFO]: 	nb vectors: 4532
2025-03-09 09:57:29,209 [INFO]: 	vectors dimension: 49152
2025-03-09 09:57:29,209 [INFO]: 	compression ratio: 0.9993088113946854
2025-03-09 09:57:29,209 [INFO]: }
2025-03-09 09:57:29,209 [INFO]: 	>>> Finished "Creating the index" in 68.9358 secs
2025-03-09 09:57:29,209 [INFO]: >>> Finished "Launching the whole pipeline" in 68.9632 secs
2025-03-09 09:57:30: [retrieval_preprocessing] calculating distances ...
2025-03-09 09:57:31: [retrieval_preprocessing] finished and saved retrieval indices for episode 62228 [episode count 8/20]
[retrieval_preprocessing] for episode 57368 [episode count 9/20], we have num_retrieval=np.int64(4344) num_query=np.int64(398)
2025-03-09 09:57:32,965 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-09 09:57:33,604 [INFO]: Launching the whole pipeline 03/09/2025, 09:57:33
2025-03-09 09:57:33,605 [INFO]: Reading total number of vectors and dimension 03/09/2025, 09:57:33
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1449.31it/s]
2025-03-09 09:57:33,631 [INFO]: There are 4344 embeddings of dim 49152
2025-03-09 09:57:33,631 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0262 secs
2025-03-09 09:57:33,631 [INFO]: 	Compute estimated construction time of the index 03/09/2025, 09:57:33
2025-03-09 09:57:33,631 [INFO]: 		-> Train: 16.7 minutes
2025-03-09 09:57:33,631 [INFO]: 		-> Add: 2.4 seconds
2025-03-09 09:57:33,631 [INFO]: 		Total: 16.7 minutes
2025-03-09 09:57:33,631 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0001 secs
2025-03-09 09:57:33,631 [INFO]: 	Checking that your have enough memory available to create the index 03/09/2025, 09:57:33
2025-03-09 09:57:33,631 [INFO]: 896.5MB of memory will be needed to build the index (more might be used if you have more)
2025-03-09 09:57:33,631 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0001 secs
2025-03-09 09:57:33,631 [INFO]: 	Selecting most promising index types given data characteristics 03/09/2025, 09:57:33
2025-03-09 09:57:33,631 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-09 09:57:33,631 [INFO]: 	Creating the index 03/09/2025, 09:57:33
2025-03-09 09:57:33,631 [INFO]: 		-> Instanciate the index HNSW15 03/09/2025, 09:57:33
2025-03-09 09:57:33,632 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0010 secs
2025-03-09 09:57:33,633 [INFO]: 		-> Adding the vectors to the index 03/09/2025, 09:57:33
2025-03-09 09:57:33,633 [INFO]: The memory available for adding the vectors is 49.2GB(total available - used by the index)
2025-03-09 09:57:33,633 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/18 [00:00<?, ?it/s]  6%|▌         | 1/18 [00:00<00:03,  5.27it/s] 17%|█▋        | 3/18 [00:00<00:01,  9.19it/s] 28%|██▊       | 5/18 [00:00<00:01, 10.93it/s] 39%|███▉      | 7/18 [00:00<00:00, 11.73it/s] 50%|█████     | 9/18 [00:00<00:00, 12.20it/s] 61%|██████    | 11/18 [00:00<00:00, 12.66it/s] 72%|███████▏  | 13/18 [00:01<00:00, 12.80it/s] 83%|████████▎ | 15/18 [00:01<00:00, 13.42it/s] 94%|█████████▍| 17/18 [00:01<00:00, 13.12it/s]100%|██████████| 18/18 [00:04<00:00,  4.19it/s]
2025-03-09 09:57:37,933 [INFO]: 	Computing best hyperparameters for index knn.index 03/09/2025, 09:57:37
2025-03-09 09:58:15,221 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 37.2884 secs
2025-03-09 09:58:15,221 [INFO]: The best hyperparameters are: efSearch=223
2025-03-09 09:58:15,222 [INFO]: 	Compute fast metrics 03/09/2025, 09:58:15
  0%|          | 0/4 [00:00<?, ?it/s] 25%|██▌       | 1/4 [00:00<00:00,  5.54it/s] 50%|█████     | 2/4 [00:00<00:00,  7.35it/s] 75%|███████▌  | 3/4 [00:00<00:00,  8.25it/s] 75%|███████▌  | 3/4 [00:00<00:00,  6.12it/s]
2025-03-09 09:58:34,480 [INFO]: 	>>> Finished "Compute fast metrics" in 19.2585 secs
2025-03-09 09:58:34,587 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 60.9547 secs
2025-03-09 09:58:34,588 [INFO]: {
2025-03-09 09:58:34,588 [INFO]: 	index_key: HNSW15
2025-03-09 09:58:34,588 [INFO]: 	index_param: efSearch=223
2025-03-09 09:58:34,588 [INFO]: 	index_path: knn.index
2025-03-09 09:58:34,588 [INFO]: 	size in bytes: 854656090
2025-03-09 09:58:34,588 [INFO]: 	avg_search_speed_ms: 8.206671884716206
2025-03-09 09:58:34,588 [INFO]: 	99p_search_speed_ms: 12.977873568888718
2025-03-09 09:58:34,588 [INFO]: 	reconstruction error %: 0.0
2025-03-09 09:58:34,588 [INFO]: 	nb vectors: 4344
2025-03-09 09:58:34,588 [INFO]: 	vectors dimension: 49152
2025-03-09 09:58:34,588 [INFO]: 	compression ratio: 0.9993085663263688
2025-03-09 09:58:34,588 [INFO]: }
2025-03-09 09:58:34,588 [INFO]: 	>>> Finished "Creating the index" in 60.9569 secs
2025-03-09 09:58:34,588 [INFO]: >>> Finished "Launching the whole pipeline" in 60.9838 secs
2025-03-09 09:58:36: [retrieval_preprocessing] calculating distances ...
2025-03-09 09:58:37: [retrieval_preprocessing] finished and saved retrieval indices for episode 57368 [episode count 9/20]
[retrieval_preprocessing] for episode 86296 [episode count 10/20], we have num_retrieval=np.int64(4550) num_query=np.int64(192)
2025-03-09 09:58:38,988 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-09 09:58:39,588 [INFO]: Launching the whole pipeline 03/09/2025, 09:58:39
2025-03-09 09:58:39,588 [INFO]: Reading total number of vectors and dimension 03/09/2025, 09:58:39
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1308.27it/s]
2025-03-09 09:58:39,618 [INFO]: There are 4550 embeddings of dim 49152
2025-03-09 09:58:39,619 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0306 secs
2025-03-09 09:58:39,619 [INFO]: 	Compute estimated construction time of the index 03/09/2025, 09:58:39
2025-03-09 09:58:39,619 [INFO]: 		-> Train: 16.7 minutes
2025-03-09 09:58:39,619 [INFO]: 		-> Add: 2.5 seconds
2025-03-09 09:58:39,619 [INFO]: 		Total: 16.7 minutes
2025-03-09 09:58:39,619 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0003 secs
2025-03-09 09:58:39,620 [INFO]: 	Checking that your have enough memory available to create the index 03/09/2025, 09:58:39
2025-03-09 09:58:39,620 [INFO]: 939.0MB of memory will be needed to build the index (more might be used if you have more)
2025-03-09 09:58:39,620 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0005 secs
2025-03-09 09:58:39,620 [INFO]: 	Selecting most promising index types given data characteristics 03/09/2025, 09:58:39
2025-03-09 09:58:39,620 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-09 09:58:39,620 [INFO]: 	Creating the index 03/09/2025, 09:58:39
2025-03-09 09:58:39,621 [INFO]: 		-> Instanciate the index HNSW15 03/09/2025, 09:58:39
2025-03-09 09:58:39,623 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0027 secs
2025-03-09 09:58:39,624 [INFO]: 		-> Adding the vectors to the index 03/09/2025, 09:58:39
2025-03-09 09:58:39,624 [INFO]: The memory available for adding the vectors is 49.2GB(total available - used by the index)
2025-03-09 09:58:39,624 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/18 [00:00<?, ?it/s]  6%|▌         | 1/18 [00:00<00:02,  6.20it/s] 17%|█▋        | 3/18 [00:00<00:01,  9.56it/s] 28%|██▊       | 5/18 [00:00<00:01, 11.09it/s] 39%|███▉      | 7/18 [00:00<00:00, 11.91it/s] 50%|█████     | 9/18 [00:00<00:00, 12.21it/s] 61%|██████    | 11/18 [00:00<00:00, 12.29it/s] 72%|███████▏  | 13/18 [00:01<00:00, 12.39it/s] 83%|████████▎ | 15/18 [00:01<00:00, 12.32it/s] 94%|█████████▍| 17/18 [00:01<00:00, 12.44it/s]100%|██████████| 18/18 [00:04<00:00,  3.86it/s]
2025-03-09 09:58:44,305 [INFO]: 	Computing best hyperparameters for index knn.index 03/09/2025, 09:58:44
2025-03-09 09:59:22,485 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 38.1794 secs
2025-03-09 09:59:22,485 [INFO]: The best hyperparameters are: efSearch=223
2025-03-09 09:59:22,485 [INFO]: 	Compute fast metrics 03/09/2025, 09:59:22
  0%|          | 0/4 [00:00<?, ?it/s] 25%|██▌       | 1/4 [00:00<00:00,  5.25it/s] 50%|█████     | 2/4 [00:00<00:00,  6.56it/s] 75%|███████▌  | 3/4 [00:00<00:00,  7.35it/s] 75%|███████▌  | 3/4 [00:00<00:00,  5.58it/s]
2025-03-09 09:59:44,797 [INFO]: 	>>> Finished "Compute fast metrics" in 22.3115 secs
2025-03-09 09:59:44,800 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 65.1763 secs
2025-03-09 09:59:44,800 [INFO]: {
2025-03-09 09:59:44,800 [INFO]: 	index_key: HNSW15
2025-03-09 09:59:44,800 [INFO]: 	index_param: efSearch=223
2025-03-09 09:59:44,800 [INFO]: 	index_path: knn.index
2025-03-09 09:59:44,800 [INFO]: 	size in bytes: 895185190
2025-03-09 09:59:44,800 [INFO]: 	avg_search_speed_ms: 9.485107543701536
2025-03-09 09:59:44,800 [INFO]: 	99p_search_speed_ms: 20.338553108740633
2025-03-09 09:59:44,800 [INFO]: 	reconstruction error %: 0.0
2025-03-09 09:59:44,800 [INFO]: 	nb vectors: 4550
2025-03-09 09:59:44,800 [INFO]: 	vectors dimension: 49152
2025-03-09 09:59:44,800 [INFO]: 	compression ratio: 0.9993087575544005
2025-03-09 09:59:44,800 [INFO]: }
2025-03-09 09:59:44,800 [INFO]: 	>>> Finished "Creating the index" in 65.1799 secs
2025-03-09 09:59:44,800 [INFO]: >>> Finished "Launching the whole pipeline" in 65.2124 secs
2025-03-09 09:59:45: [retrieval_preprocessing] calculating distances ...
2025-03-09 09:59:46: [retrieval_preprocessing] finished and saved retrieval indices for episode 86296 [episode count 10/20]
[retrieval_preprocessing] for episode 15004 [episode count 11/20], we have num_retrieval=np.int64(4549) num_query=np.int64(193)
2025-03-09 09:59:47,351 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-09 09:59:47,941 [INFO]: Launching the whole pipeline 03/09/2025, 09:59:47
2025-03-09 09:59:47,941 [INFO]: Reading total number of vectors and dimension 03/09/2025, 09:59:47
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1186.17it/s]
2025-03-09 09:59:47,967 [INFO]: There are 4549 embeddings of dim 49152
2025-03-09 09:59:47,967 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0260 secs
2025-03-09 09:59:47,967 [INFO]: 	Compute estimated construction time of the index 03/09/2025, 09:59:47
2025-03-09 09:59:47,967 [INFO]: 		-> Train: 16.7 minutes
2025-03-09 09:59:47,967 [INFO]: 		-> Add: 2.5 seconds
2025-03-09 09:59:47,967 [INFO]: 		Total: 16.7 minutes
2025-03-09 09:59:47,967 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0002 secs
2025-03-09 09:59:47,967 [INFO]: 	Checking that your have enough memory available to create the index 03/09/2025, 09:59:47
2025-03-09 09:59:47,967 [INFO]: 938.8MB of memory will be needed to build the index (more might be used if you have more)
2025-03-09 09:59:47,967 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0002 secs
2025-03-09 09:59:47,967 [INFO]: 	Selecting most promising index types given data characteristics 03/09/2025, 09:59:47
2025-03-09 09:59:47,968 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-09 09:59:47,968 [INFO]: 	Creating the index 03/09/2025, 09:59:47
2025-03-09 09:59:47,968 [INFO]: 		-> Instanciate the index HNSW15 03/09/2025, 09:59:47
2025-03-09 09:59:47,969 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0013 secs
2025-03-09 09:59:47,969 [INFO]: 		-> Adding the vectors to the index 03/09/2025, 09:59:47
2025-03-09 09:59:47,969 [INFO]: The memory available for adding the vectors is 49.2GB(total available - used by the index)
2025-03-09 09:59:47,969 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/18 [00:00<?, ?it/s]  6%|▌         | 1/18 [00:00<00:03,  4.94it/s] 11%|█         | 2/18 [00:00<00:02,  6.68it/s] 17%|█▋        | 3/18 [00:00<00:01,  7.60it/s] 22%|██▏       | 4/18 [00:00<00:01,  7.99it/s] 28%|██▊       | 5/18 [00:00<00:01,  8.25it/s] 33%|███▎      | 6/18 [00:00<00:01,  8.41it/s] 39%|███▉      | 7/18 [00:00<00:01,  8.49it/s] 44%|████▍     | 8/18 [00:01<00:01,  8.54it/s] 50%|█████     | 9/18 [00:01<00:01,  8.58it/s] 56%|█████▌    | 10/18 [00:01<00:00,  8.46it/s] 61%|██████    | 11/18 [00:01<00:00,  8.48it/s] 67%|██████▋   | 12/18 [00:01<00:00,  8.53it/s] 72%|███████▏  | 13/18 [00:01<00:00,  8.61it/s] 78%|███████▊  | 14/18 [00:01<00:00,  8.79it/s] 83%|████████▎ | 15/18 [00:01<00:00,  8.83it/s] 89%|████████▉ | 16/18 [00:01<00:00,  9.03it/s]100%|██████████| 18/18 [00:05<00:00,  1.24it/s]100%|██████████| 18/18 [00:05<00:00,  3.51it/s]
2025-03-09 09:59:53,113 [INFO]: 	Computing best hyperparameters for index knn.index 03/09/2025, 09:59:53
2025-03-09 10:00:36,930 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 43.8164 secs
2025-03-09 10:00:36,930 [INFO]: The best hyperparameters are: efSearch=211
2025-03-09 10:00:36,930 [INFO]: 	Compute fast metrics 03/09/2025, 10:00:36
  0%|          | 0/4 [00:00<?, ?it/s] 25%|██▌       | 1/4 [00:00<00:00,  4.69it/s] 50%|█████     | 2/4 [00:00<00:00,  5.31it/s] 75%|███████▌  | 3/4 [00:00<00:00,  6.56it/s] 75%|███████▌  | 3/4 [00:00<00:00,  5.24it/s]
2025-03-09 10:00:52,857 [INFO]: 	>>> Finished "Compute fast metrics" in 15.9272 secs
2025-03-09 10:00:52,860 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 64.8906 secs
2025-03-09 10:00:52,860 [INFO]: {
2025-03-09 10:00:52,860 [INFO]: 	index_key: HNSW15
2025-03-09 10:00:52,860 [INFO]: 	index_param: efSearch=211
2025-03-09 10:00:52,860 [INFO]: 	index_path: knn.index
2025-03-09 10:00:52,860 [INFO]: 	size in bytes: 894988450
2025-03-09 10:00:52,860 [INFO]: 	avg_search_speed_ms: 9.403736700165554
2025-03-09 10:00:52,860 [INFO]: 	99p_search_speed_ms: 20.40082854684441
2025-03-09 10:00:52,860 [INFO]: 	reconstruction error %: 0.0
2025-03-09 10:00:52,860 [INFO]: 	nb vectors: 4549
2025-03-09 10:00:52,860 [INFO]: 	vectors dimension: 49152
2025-03-09 10:00:52,860 [INFO]: 	compression ratio: 0.9993087530906125
2025-03-09 10:00:52,860 [INFO]: }
2025-03-09 10:00:52,860 [INFO]: 	>>> Finished "Creating the index" in 64.8924 secs
2025-03-09 10:00:52,860 [INFO]: >>> Finished "Launching the whole pipeline" in 64.9194 secs
2025-03-09 10:00:53: [retrieval_preprocessing] calculating distances ...
2025-03-09 10:00:54: [retrieval_preprocessing] finished and saved retrieval indices for episode 15004 [episode count 11/20]
[retrieval_preprocessing] for episode 66719 [episode count 12/20], we have num_retrieval=np.int64(4427) num_query=np.int64(315)
2025-03-09 10:00:55,914 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-09 10:00:57,172 [INFO]: Launching the whole pipeline 03/09/2025, 10:00:57
2025-03-09 10:00:57,172 [INFO]: Reading total number of vectors and dimension 03/09/2025, 10:00:57
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1920.47it/s]
2025-03-09 10:00:57,196 [INFO]: There are 4427 embeddings of dim 49152
2025-03-09 10:00:57,196 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0246 secs
2025-03-09 10:00:57,196 [INFO]: 	Compute estimated construction time of the index 03/09/2025, 10:00:57
2025-03-09 10:00:57,196 [INFO]: 		-> Train: 16.7 minutes
2025-03-09 10:00:57,197 [INFO]: 		-> Add: 2.4 seconds
2025-03-09 10:00:57,197 [INFO]: 		Total: 16.7 minutes
2025-03-09 10:00:57,197 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0001 secs
2025-03-09 10:00:57,197 [INFO]: 	Checking that your have enough memory available to create the index 03/09/2025, 10:00:57
2025-03-09 10:00:57,197 [INFO]: 913.6MB of memory will be needed to build the index (more might be used if you have more)
2025-03-09 10:00:57,197 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0001 secs
2025-03-09 10:00:57,197 [INFO]: 	Selecting most promising index types given data characteristics 03/09/2025, 10:00:57
2025-03-09 10:00:57,197 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-09 10:00:57,197 [INFO]: 	Creating the index 03/09/2025, 10:00:57
2025-03-09 10:00:57,197 [INFO]: 		-> Instanciate the index HNSW15 03/09/2025, 10:00:57
2025-03-09 10:00:57,198 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0010 secs
2025-03-09 10:00:57,198 [INFO]: 		-> Adding the vectors to the index 03/09/2025, 10:00:57
2025-03-09 10:00:57,198 [INFO]: The memory available for adding the vectors is 49.2GB(total available - used by the index)
2025-03-09 10:00:57,198 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/18 [00:00<?, ?it/s]  6%|▌         | 1/18 [00:00<00:02,  5.94it/s] 17%|█▋        | 3/18 [00:00<00:01,  9.93it/s] 28%|██▊       | 5/18 [00:00<00:01, 11.01it/s] 39%|███▉      | 7/18 [00:00<00:00, 11.56it/s] 50%|█████     | 9/18 [00:00<00:00, 11.32it/s] 61%|██████    | 11/18 [00:01<00:00, 11.09it/s] 72%|███████▏  | 13/18 [00:01<00:00, 11.07it/s] 83%|████████▎ | 15/18 [00:01<00:00, 11.10it/s] 94%|█████████▍| 17/18 [00:01<00:00, 10.96it/s]100%|██████████| 18/18 [00:04<00:00,  3.80it/s]
2025-03-09 10:01:01,934 [INFO]: 	Computing best hyperparameters for index knn.index 03/09/2025, 10:01:01
2025-03-09 10:01:40,045 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 38.1105 secs
2025-03-09 10:01:40,045 [INFO]: The best hyperparameters are: efSearch=198
2025-03-09 10:01:40,045 [INFO]: 	Compute fast metrics 03/09/2025, 10:01:40
  0%|          | 0/4 [00:00<?, ?it/s] 25%|██▌       | 1/4 [00:00<00:00,  4.96it/s] 50%|█████     | 2/4 [00:00<00:00,  6.70it/s] 75%|███████▌  | 3/4 [00:00<00:00,  7.44it/s] 75%|███████▌  | 3/4 [00:00<00:00,  5.59it/s]
2025-03-09 10:01:56,386 [INFO]: 	>>> Finished "Compute fast metrics" in 16.3403 secs
2025-03-09 10:01:56,394 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 59.1960 secs
2025-03-09 10:01:56,394 [INFO]: {
2025-03-09 10:01:56,394 [INFO]: 	index_key: HNSW15
2025-03-09 10:01:56,394 [INFO]: 	index_param: efSearch=198
2025-03-09 10:01:56,394 [INFO]: 	index_path: knn.index
2025-03-09 10:01:56,394 [INFO]: 	size in bytes: 870985810
2025-03-09 10:01:56,394 [INFO]: 	avg_search_speed_ms: 8.292941865974583
2025-03-09 10:01:56,394 [INFO]: 	99p_search_speed_ms: 15.855354245286438
2025-03-09 10:01:56,394 [INFO]: 	reconstruction error %: 0.0
2025-03-09 10:01:56,394 [INFO]: 	nb vectors: 4427
2025-03-09 10:01:56,394 [INFO]: 	vectors dimension: 49152
2025-03-09 10:01:56,394 [INFO]: 	compression ratio: 0.9993086064169059
2025-03-09 10:01:56,394 [INFO]: }
2025-03-09 10:01:56,394 [INFO]: 	>>> Finished "Creating the index" in 59.1974 secs
2025-03-09 10:01:56,394 [INFO]: >>> Finished "Launching the whole pipeline" in 59.2226 secs
2025-03-09 10:01:57: [retrieval_preprocessing] calculating distances ...
2025-03-09 10:01:58: [retrieval_preprocessing] finished and saved retrieval indices for episode 66719 [episode count 12/20]
[retrieval_preprocessing] for episode 38560 [episode count 13/20], we have num_retrieval=np.int64(4568) num_query=np.int64(174)
2025-03-09 10:02:00,069 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-09 10:02:00,703 [INFO]: Launching the whole pipeline 03/09/2025, 10:02:00
2025-03-09 10:02:00,703 [INFO]: Reading total number of vectors and dimension 03/09/2025, 10:02:00
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 2184.53it/s]
2025-03-09 10:02:00,727 [INFO]: There are 4568 embeddings of dim 49152
2025-03-09 10:02:00,727 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0234 secs
2025-03-09 10:02:00,727 [INFO]: 	Compute estimated construction time of the index 03/09/2025, 10:02:00
2025-03-09 10:02:00,727 [INFO]: 		-> Train: 16.7 minutes
2025-03-09 10:02:00,727 [INFO]: 		-> Add: 2.5 seconds
2025-03-09 10:02:00,727 [INFO]: 		Total: 16.7 minutes
2025-03-09 10:02:00,727 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0001 secs
2025-03-09 10:02:00,727 [INFO]: 	Checking that your have enough memory available to create the index 03/09/2025, 10:02:00
2025-03-09 10:02:00,727 [INFO]: 942.7MB of memory will be needed to build the index (more might be used if you have more)
2025-03-09 10:02:00,727 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0001 secs
2025-03-09 10:02:00,727 [INFO]: 	Selecting most promising index types given data characteristics 03/09/2025, 10:02:00
2025-03-09 10:02:00,727 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-09 10:02:00,727 [INFO]: 	Creating the index 03/09/2025, 10:02:00
2025-03-09 10:02:00,727 [INFO]: 		-> Instanciate the index HNSW15 03/09/2025, 10:02:00
2025-03-09 10:02:00,728 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0009 secs
2025-03-09 10:02:00,728 [INFO]: 		-> Adding the vectors to the index 03/09/2025, 10:02:00
2025-03-09 10:02:00,728 [INFO]: The memory available for adding the vectors is 49.2GB(total available - used by the index)
2025-03-09 10:02:00,728 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/18 [00:00<?, ?it/s]  6%|▌         | 1/18 [00:00<00:02,  6.34it/s] 17%|█▋        | 3/18 [00:00<00:01, 10.41it/s] 28%|██▊       | 5/18 [00:00<00:01, 11.65it/s] 39%|███▉      | 7/18 [00:00<00:00, 11.89it/s] 50%|█████     | 9/18 [00:00<00:00, 12.01it/s] 61%|██████    | 11/18 [00:00<00:00, 12.11it/s] 72%|███████▏  | 13/18 [00:01<00:00, 12.05it/s] 83%|████████▎ | 15/18 [00:01<00:00, 13.23it/s] 94%|█████████▍| 17/18 [00:01<00:00, 12.86it/s]100%|██████████| 18/18 [00:05<00:00,  3.49it/s]
2025-03-09 10:02:05,904 [INFO]: 	Computing best hyperparameters for index knn.index 03/09/2025, 10:02:05
2025-03-09 10:02:44,834 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 38.9302 secs
2025-03-09 10:02:44,835 [INFO]: The best hyperparameters are: efSearch=167
2025-03-09 10:02:44,835 [INFO]: 	Compute fast metrics 03/09/2025, 10:02:44
  0%|          | 0/4 [00:00<?, ?it/s] 25%|██▌       | 1/4 [00:00<00:00,  6.01it/s] 50%|█████     | 2/4 [00:00<00:00,  7.68it/s] 75%|███████▌  | 3/4 [00:00<00:00,  8.44it/s] 75%|███████▌  | 3/4 [00:00<00:00,  6.24it/s]
2025-03-09 10:03:06,622 [INFO]: 	>>> Finished "Compute fast metrics" in 21.7871 secs
2025-03-09 10:03:07,290 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 66.5613 secs
2025-03-09 10:03:07,290 [INFO]: {
2025-03-09 10:03:07,290 [INFO]: 	index_key: HNSW15
2025-03-09 10:03:07,290 [INFO]: 	index_param: efSearch=167
2025-03-09 10:03:07,290 [INFO]: 	index_path: knn.index
2025-03-09 10:03:07,290 [INFO]: 	size in bytes: 898726630
2025-03-09 10:03:07,290 [INFO]: 	avg_search_speed_ms: 7.009182818923642
2025-03-09 10:03:07,291 [INFO]: 	99p_search_speed_ms: 15.418796567246318
2025-03-09 10:03:07,291 [INFO]: 	reconstruction error %: 0.0
2025-03-09 10:03:07,291 [INFO]: 	nb vectors: 4568
2025-03-09 10:03:07,291 [INFO]: 	vectors dimension: 49152
2025-03-09 10:03:07,291 [INFO]: 	compression ratio: 0.999308704138432
2025-03-09 10:03:07,291 [INFO]: }
2025-03-09 10:03:07,291 [INFO]: 	>>> Finished "Creating the index" in 66.5635 secs
2025-03-09 10:03:07,291 [INFO]: >>> Finished "Launching the whole pipeline" in 66.5874 secs
2025-03-09 10:03:07: [retrieval_preprocessing] calculating distances ...
2025-03-09 10:03:08: [retrieval_preprocessing] finished and saved retrieval indices for episode 38560 [episode count 13/20]
[retrieval_preprocessing] for episode 91935 [episode count 14/20], we have num_retrieval=np.int64(4564) num_query=np.int64(178)
2025-03-09 10:03:09,776 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-09 10:03:10,573 [INFO]: Launching the whole pipeline 03/09/2025, 10:03:10
2025-03-09 10:03:10,573 [INFO]: Reading total number of vectors and dimension 03/09/2025, 10:03:10
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1381.52it/s]
2025-03-09 10:03:10,600 [INFO]: There are 4564 embeddings of dim 49152
2025-03-09 10:03:10,601 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0276 secs
2025-03-09 10:03:10,601 [INFO]: 	Compute estimated construction time of the index 03/09/2025, 10:03:10
2025-03-09 10:03:10,601 [INFO]: 		-> Train: 16.7 minutes
2025-03-09 10:03:10,601 [INFO]: 		-> Add: 2.5 seconds
2025-03-09 10:03:10,601 [INFO]: 		Total: 16.7 minutes
2025-03-09 10:03:10,601 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0001 secs
2025-03-09 10:03:10,601 [INFO]: 	Checking that your have enough memory available to create the index 03/09/2025, 10:03:10
2025-03-09 10:03:10,601 [INFO]: 941.9MB of memory will be needed to build the index (more might be used if you have more)
2025-03-09 10:03:10,601 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0002 secs
2025-03-09 10:03:10,601 [INFO]: 	Selecting most promising index types given data characteristics 03/09/2025, 10:03:10
2025-03-09 10:03:10,601 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-09 10:03:10,601 [INFO]: 	Creating the index 03/09/2025, 10:03:10
2025-03-09 10:03:10,601 [INFO]: 		-> Instanciate the index HNSW15 03/09/2025, 10:03:10
2025-03-09 10:03:10,602 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0011 secs
2025-03-09 10:03:10,603 [INFO]: 		-> Adding the vectors to the index 03/09/2025, 10:03:10
2025-03-09 10:03:10,603 [INFO]: The memory available for adding the vectors is 49.2GB(total available - used by the index)
2025-03-09 10:03:10,603 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/18 [00:00<?, ?it/s]  6%|▌         | 1/18 [00:00<00:03,  5.18it/s] 11%|█         | 2/18 [00:00<00:02,  6.90it/s] 17%|█▋        | 3/18 [00:00<00:01,  7.75it/s] 22%|██▏       | 4/18 [00:00<00:01,  8.12it/s] 28%|██▊       | 5/18 [00:00<00:01,  8.52it/s] 33%|███▎      | 6/18 [00:00<00:01,  8.70it/s] 39%|███▉      | 7/18 [00:00<00:01,  8.80it/s] 44%|████▍     | 8/18 [00:00<00:01,  8.87it/s] 50%|█████     | 9/18 [00:01<00:01,  8.86it/s] 56%|█████▌    | 10/18 [00:01<00:00,  8.99it/s] 61%|██████    | 11/18 [00:01<00:00,  9.01it/s] 67%|██████▋   | 12/18 [00:01<00:00,  9.17it/s] 72%|███████▏  | 13/18 [00:01<00:00,  9.21it/s] 78%|███████▊  | 14/18 [00:01<00:00,  9.16it/s] 83%|████████▎ | 15/18 [00:01<00:00,  9.26it/s] 89%|████████▉ | 16/18 [00:01<00:00,  9.42it/s] 94%|█████████▍| 17/18 [00:01<00:00,  9.43it/s]100%|██████████| 18/18 [00:05<00:00,  1.00it/s]100%|██████████| 18/18 [00:05<00:00,  3.59it/s]
2025-03-09 10:03:15,617 [INFO]: 	Computing best hyperparameters for index knn.index 03/09/2025, 10:03:15
2025-03-09 10:03:55,670 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 40.0527 secs
2025-03-09 10:03:55,670 [INFO]: The best hyperparameters are: efSearch=247
2025-03-09 10:03:55,670 [INFO]: 	Compute fast metrics 03/09/2025, 10:03:55
  0%|          | 0/4 [00:00<?, ?it/s] 25%|██▌       | 1/4 [00:00<00:00,  6.15it/s] 75%|███████▌  | 3/4 [00:00<00:00, 10.12it/s] 75%|███████▌  | 3/4 [00:00<00:00,  7.79it/s]
2025-03-09 10:04:14,707 [INFO]: 	>>> Finished "Compute fast metrics" in 19.0364 secs
2025-03-09 10:04:14,709 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 64.1069 secs
2025-03-09 10:04:14,710 [INFO]: {
2025-03-09 10:04:14,710 [INFO]: 	index_key: HNSW15
2025-03-09 10:04:14,710 [INFO]: 	index_param: efSearch=247
2025-03-09 10:04:14,710 [INFO]: 	index_path: knn.index
2025-03-09 10:04:14,710 [INFO]: 	size in bytes: 897939670
2025-03-09 10:04:14,710 [INFO]: 	avg_search_speed_ms: 9.073250385520206
2025-03-09 10:04:14,710 [INFO]: 	99p_search_speed_ms: 17.39454407710582
2025-03-09 10:04:14,710 [INFO]: 	reconstruction error %: 0.0
2025-03-09 10:04:14,710 [INFO]: 	nb vectors: 4564
2025-03-09 10:04:14,710 [INFO]: 	vectors dimension: 49152
2025-03-09 10:04:14,710 [INFO]: 	compression ratio: 0.9993086862951495
2025-03-09 10:04:14,710 [INFO]: }
2025-03-09 10:04:14,710 [INFO]: 	>>> Finished "Creating the index" in 64.1085 secs
2025-03-09 10:04:14,710 [INFO]: >>> Finished "Launching the whole pipeline" in 64.1367 secs
2025-03-09 10:04:15: [retrieval_preprocessing] calculating distances ...
2025-03-09 10:04:16: [retrieval_preprocessing] finished and saved retrieval indices for episode 91935 [episode count 14/20]
[retrieval_preprocessing] for episode 48294 [episode count 15/20], we have num_retrieval=np.int64(4572) num_query=np.int64(170)
2025-03-09 10:04:17,666 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-09 10:04:18,256 [INFO]: Launching the whole pipeline 03/09/2025, 10:04:18
2025-03-09 10:04:18,257 [INFO]: Reading total number of vectors and dimension 03/09/2025, 10:04:18
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 2144.33it/s]
2025-03-09 10:04:18,283 [INFO]: There are 4572 embeddings of dim 49152
2025-03-09 10:04:18,283 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0266 secs
2025-03-09 10:04:18,283 [INFO]: 	Compute estimated construction time of the index 03/09/2025, 10:04:18
2025-03-09 10:04:18,284 [INFO]: 		-> Train: 16.7 minutes
2025-03-09 10:04:18,284 [INFO]: 		-> Add: 2.5 seconds
2025-03-09 10:04:18,284 [INFO]: 		Total: 16.7 minutes
2025-03-09 10:04:18,284 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0004 secs
2025-03-09 10:04:18,284 [INFO]: 	Checking that your have enough memory available to create the index 03/09/2025, 10:04:18
2025-03-09 10:04:18,284 [INFO]: 943.6MB of memory will be needed to build the index (more might be used if you have more)
2025-03-09 10:04:18,284 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0004 secs
2025-03-09 10:04:18,285 [INFO]: 	Selecting most promising index types given data characteristics 03/09/2025, 10:04:18
2025-03-09 10:04:18,285 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-09 10:04:18,285 [INFO]: 	Creating the index 03/09/2025, 10:04:18
2025-03-09 10:04:18,285 [INFO]: 		-> Instanciate the index HNSW15 03/09/2025, 10:04:18
2025-03-09 10:04:18,288 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0025 secs
2025-03-09 10:04:18,288 [INFO]: 		-> Adding the vectors to the index 03/09/2025, 10:04:18
2025-03-09 10:04:18,288 [INFO]: The memory available for adding the vectors is 49.2GB(total available - used by the index)
2025-03-09 10:04:18,288 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/18 [00:00<?, ?it/s]  6%|▌         | 1/18 [00:00<00:02,  6.52it/s] 17%|█▋        | 3/18 [00:00<00:01, 10.48it/s] 28%|██▊       | 5/18 [00:00<00:01, 11.93it/s] 39%|███▉      | 7/18 [00:00<00:00, 12.29it/s] 50%|█████     | 9/18 [00:00<00:00, 12.86it/s] 61%|██████    | 11/18 [00:00<00:00, 13.13it/s] 72%|███████▏  | 13/18 [00:01<00:00, 13.28it/s] 83%|████████▎ | 15/18 [00:01<00:00, 13.44it/s] 94%|█████████▍| 17/18 [00:01<00:00, 13.65it/s]100%|██████████| 18/18 [00:04<00:00,  4.08it/s]
2025-03-09 10:04:22,717 [INFO]: 	Computing best hyperparameters for index knn.index 03/09/2025, 10:04:22
2025-03-09 10:05:03,223 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 40.5057 secs
2025-03-09 10:05:03,224 [INFO]: The best hyperparameters are: efSearch=216
2025-03-09 10:05:03,224 [INFO]: 	Compute fast metrics 03/09/2025, 10:05:03
  0%|          | 0/4 [00:00<?, ?it/s] 25%|██▌       | 1/4 [00:00<00:00,  5.13it/s] 50%|█████     | 2/4 [00:00<00:00,  6.66it/s] 75%|███████▌  | 3/4 [00:00<00:00,  7.25it/s] 75%|███████▌  | 3/4 [00:00<00:00,  5.57it/s]
2025-03-09 10:05:24,162 [INFO]: 	>>> Finished "Compute fast metrics" in 20.9384 secs
2025-03-09 10:05:24,165 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 65.8774 secs
2025-03-09 10:05:24,165 [INFO]: {
2025-03-09 10:05:24,166 [INFO]: 	index_key: HNSW15
2025-03-09 10:05:24,166 [INFO]: 	index_param: efSearch=216
2025-03-09 10:05:24,166 [INFO]: 	index_path: knn.index
2025-03-09 10:05:24,166 [INFO]: 	size in bytes: 899513590
2025-03-09 10:05:24,166 [INFO]: 	avg_search_speed_ms: 8.040486512461623
2025-03-09 10:05:24,166 [INFO]: 	99p_search_speed_ms: 13.398873370606449
2025-03-09 10:05:24,166 [INFO]: 	reconstruction error %: 0.0
2025-03-09 10:05:24,166 [INFO]: 	nb vectors: 4572
2025-03-09 10:05:24,166 [INFO]: 	vectors dimension: 49152
2025-03-09 10:05:24,166 [INFO]: 	compression ratio: 0.9993087219504933
2025-03-09 10:05:24,166 [INFO]: }
2025-03-09 10:05:24,166 [INFO]: 	>>> Finished "Creating the index" in 65.8808 secs
2025-03-09 10:05:24,166 [INFO]: >>> Finished "Launching the whole pipeline" in 65.9091 secs
2025-03-09 10:05:24: [retrieval_preprocessing] calculating distances ...
2025-03-09 10:05:25: [retrieval_preprocessing] finished and saved retrieval indices for episode 48294 [episode count 15/20]
[retrieval_preprocessing] for episode 76199 [episode count 16/20], we have num_retrieval=np.int64(4552) num_query=np.int64(190)
2025-03-09 10:05:26,810 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-09 10:05:27,444 [INFO]: Launching the whole pipeline 03/09/2025, 10:05:27
2025-03-09 10:05:27,445 [INFO]: Reading total number of vectors and dimension 03/09/2025, 10:05:27
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1472.72it/s]
2025-03-09 10:05:27,473 [INFO]: There are 4552 embeddings of dim 49152
2025-03-09 10:05:27,473 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0287 secs
2025-03-09 10:05:27,474 [INFO]: 	Compute estimated construction time of the index 03/09/2025, 10:05:27
2025-03-09 10:05:27,474 [INFO]: 		-> Train: 16.7 minutes
2025-03-09 10:05:27,474 [INFO]: 		-> Add: 2.5 seconds
2025-03-09 10:05:27,474 [INFO]: 		Total: 16.7 minutes
2025-03-09 10:05:27,474 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0003 secs
2025-03-09 10:05:27,474 [INFO]: 	Checking that your have enough memory available to create the index 03/09/2025, 10:05:27
2025-03-09 10:05:27,474 [INFO]: 939.4MB of memory will be needed to build the index (more might be used if you have more)
2025-03-09 10:05:27,475 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0004 secs
2025-03-09 10:05:27,475 [INFO]: 	Selecting most promising index types given data characteristics 03/09/2025, 10:05:27
2025-03-09 10:05:27,475 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-09 10:05:27,475 [INFO]: 	Creating the index 03/09/2025, 10:05:27
2025-03-09 10:05:27,475 [INFO]: 		-> Instanciate the index HNSW15 03/09/2025, 10:05:27
2025-03-09 10:05:27,478 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0028 secs
2025-03-09 10:05:27,478 [INFO]: 		-> Adding the vectors to the index 03/09/2025, 10:05:27
2025-03-09 10:05:27,478 [INFO]: The memory available for adding the vectors is 49.2GB(total available - used by the index)
2025-03-09 10:05:27,479 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/18 [00:00<?, ?it/s]  6%|▌         | 1/18 [00:00<00:02,  6.35it/s] 17%|█▋        | 3/18 [00:00<00:01, 10.34it/s] 28%|██▊       | 5/18 [00:00<00:01, 11.76it/s] 39%|███▉      | 7/18 [00:00<00:00, 12.31it/s] 50%|█████     | 9/18 [00:00<00:00, 12.43it/s] 61%|██████    | 11/18 [00:00<00:00, 12.47it/s] 72%|███████▏  | 13/18 [00:01<00:00, 12.49it/s] 83%|████████▎ | 15/18 [00:01<00:00, 12.57it/s] 94%|█████████▍| 17/18 [00:01<00:00,  9.83it/s]100%|██████████| 18/18 [00:04<00:00,  3.79it/s]
2025-03-09 10:05:32,241 [INFO]: 	Computing best hyperparameters for index knn.index 03/09/2025, 10:05:32
2025-03-09 10:06:09,553 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 37.3118 secs
2025-03-09 10:06:09,553 [INFO]: The best hyperparameters are: efSearch=253
2025-03-09 10:06:09,553 [INFO]: 	Compute fast metrics 03/09/2025, 10:06:09
  0%|          | 0/4 [00:00<?, ?it/s] 25%|██▌       | 1/4 [00:00<00:00,  6.66it/s] 75%|███████▌  | 3/4 [00:00<00:00, 10.39it/s] 75%|███████▌  | 3/4 [00:00<00:00,  7.95it/s]
2025-03-09 10:06:25,186 [INFO]: 	>>> Finished "Compute fast metrics" in 15.6328 secs
2025-03-09 10:06:25,189 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 57.7107 secs
2025-03-09 10:06:25,189 [INFO]: {
2025-03-09 10:06:25,189 [INFO]: 	index_key: HNSW15
2025-03-09 10:06:25,189 [INFO]: 	index_param: efSearch=253
2025-03-09 10:06:25,189 [INFO]: 	index_path: knn.index
2025-03-09 10:06:25,189 [INFO]: 	size in bytes: 895578670
2025-03-09 10:06:25,189 [INFO]: 	avg_search_speed_ms: 8.951609638447048
2025-03-09 10:06:25,189 [INFO]: 	99p_search_speed_ms: 15.780442347750038
2025-03-09 10:06:25,189 [INFO]: 	reconstruction error %: 0.0
2025-03-09 10:06:25,189 [INFO]: 	nb vectors: 4552
2025-03-09 10:06:25,189 [INFO]: 	vectors dimension: 49152
2025-03-09 10:06:25,189 [INFO]: 	compression ratio: 0.999308766476093
2025-03-09 10:06:25,189 [INFO]: }
2025-03-09 10:06:25,189 [INFO]: 	>>> Finished "Creating the index" in 57.7143 secs
2025-03-09 10:06:25,189 [INFO]: >>> Finished "Launching the whole pipeline" in 57.7449 secs
2025-03-09 10:06:26: [retrieval_preprocessing] calculating distances ...
2025-03-09 10:06:27: [retrieval_preprocessing] finished and saved retrieval indices for episode 76199 [episode count 16/20]
[retrieval_preprocessing] for episode 25001 [episode count 17/20], we have num_retrieval=np.int64(4392) num_query=np.int64(350)
2025-03-09 10:06:29,436 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-09 10:06:30,904 [INFO]: Launching the whole pipeline 03/09/2025, 10:06:30
2025-03-09 10:06:30,904 [INFO]: Reading total number of vectors and dimension 03/09/2025, 10:06:30
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1090.85it/s]
2025-03-09 10:06:30,938 [INFO]: There are 4392 embeddings of dim 49152
2025-03-09 10:06:30,938 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0340 secs
2025-03-09 10:06:30,938 [INFO]: 	Compute estimated construction time of the index 03/09/2025, 10:06:30
2025-03-09 10:06:30,938 [INFO]: 		-> Train: 16.7 minutes
2025-03-09 10:06:30,939 [INFO]: 		-> Add: 2.4 seconds
2025-03-09 10:06:30,939 [INFO]: 		Total: 16.7 minutes
2025-03-09 10:06:30,939 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0002 secs
2025-03-09 10:06:30,939 [INFO]: 	Checking that your have enough memory available to create the index 03/09/2025, 10:06:30
2025-03-09 10:06:30,939 [INFO]: 906.4MB of memory will be needed to build the index (more might be used if you have more)
2025-03-09 10:06:30,939 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0003 secs
2025-03-09 10:06:30,939 [INFO]: 	Selecting most promising index types given data characteristics 03/09/2025, 10:06:30
2025-03-09 10:06:30,939 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-09 10:06:30,939 [INFO]: 	Creating the index 03/09/2025, 10:06:30
2025-03-09 10:06:30,939 [INFO]: 		-> Instanciate the index HNSW15 03/09/2025, 10:06:30
2025-03-09 10:06:30,941 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0016 secs
2025-03-09 10:06:30,941 [INFO]: 		-> Adding the vectors to the index 03/09/2025, 10:06:30
2025-03-09 10:06:30,941 [INFO]: The memory available for adding the vectors is 49.2GB(total available - used by the index)
2025-03-09 10:06:30,941 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/18 [00:00<?, ?it/s]  6%|▌         | 1/18 [00:00<00:03,  4.75it/s] 11%|█         | 2/18 [00:00<00:02,  6.61it/s] 17%|█▋        | 3/18 [00:00<00:02,  7.33it/s] 22%|██▏       | 4/18 [00:00<00:01,  7.81it/s] 28%|██▊       | 5/18 [00:00<00:01,  8.11it/s] 33%|███▎      | 6/18 [00:00<00:01,  8.29it/s] 39%|███▉      | 7/18 [00:00<00:01,  8.52it/s] 44%|████▍     | 8/18 [00:01<00:01,  8.46it/s] 50%|█████     | 9/18 [00:01<00:01,  8.49it/s] 56%|█████▌    | 10/18 [00:01<00:00,  8.57it/s] 61%|██████    | 11/18 [00:01<00:00,  8.68it/s] 67%|██████▋   | 12/18 [00:01<00:00,  8.89it/s] 72%|███████▏  | 13/18 [00:01<00:00,  8.92it/s] 78%|███████▊  | 14/18 [00:01<00:00,  8.93it/s] 83%|████████▎ | 15/18 [00:01<00:00,  8.99it/s] 89%|████████▉ | 16/18 [00:01<00:00,  8.97it/s] 94%|█████████▍| 17/18 [00:02<00:00,  8.98it/s]100%|██████████| 18/18 [00:05<00:00,  1.03it/s]100%|██████████| 18/18 [00:05<00:00,  3.60it/s]
2025-03-09 10:06:35,949 [INFO]: 	Computing best hyperparameters for index knn.index 03/09/2025, 10:06:35
2025-03-09 10:07:13,397 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 37.4479 secs
2025-03-09 10:07:13,397 [INFO]: The best hyperparameters are: efSearch=255
2025-03-09 10:07:13,398 [INFO]: 	Compute fast metrics 03/09/2025, 10:07:13
  0%|          | 0/4 [00:00<?, ?it/s] 25%|██▌       | 1/4 [00:00<00:00,  5.72it/s] 50%|█████     | 2/4 [00:00<00:00,  7.56it/s] 75%|███████▌  | 3/4 [00:00<00:00,  8.21it/s] 75%|███████▌  | 3/4 [00:00<00:00,  6.19it/s]
2025-03-09 10:07:28,827 [INFO]: 	>>> Finished "Compute fast metrics" in 15.4291 secs
2025-03-09 10:07:28,830 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 57.8887 secs
2025-03-09 10:07:28,830 [INFO]: {
2025-03-09 10:07:28,830 [INFO]: 	index_key: HNSW15
2025-03-09 10:07:28,830 [INFO]: 	index_param: efSearch=255
2025-03-09 10:07:28,830 [INFO]: 	index_path: knn.index
2025-03-09 10:07:28,830 [INFO]: 	size in bytes: 864099730
2025-03-09 10:07:28,830 [INFO]: 	avg_search_speed_ms: 8.667822483365313
2025-03-09 10:07:28,830 [INFO]: 	99p_search_speed_ms: 14.791621039621537
2025-03-09 10:07:28,830 [INFO]: 	reconstruction error %: 0.0
2025-03-09 10:07:28,830 [INFO]: 	nb vectors: 4392
2025-03-09 10:07:28,830 [INFO]: 	vectors dimension: 49152
2025-03-09 10:07:28,830 [INFO]: 	compression ratio: 0.9993086515603934
2025-03-09 10:07:28,830 [INFO]: }
2025-03-09 10:07:28,830 [INFO]: 	>>> Finished "Creating the index" in 57.8909 secs
2025-03-09 10:07:28,830 [INFO]: >>> Finished "Launching the whole pipeline" in 57.9262 secs
2025-03-09 10:07:31: [retrieval_preprocessing] calculating distances ...
2025-03-09 10:07:32: [retrieval_preprocessing] finished and saved retrieval indices for episode 25001 [episode count 17/20]
[retrieval_preprocessing] for episode 27947 [episode count 18/20], we have num_retrieval=np.int64(4513) num_query=np.int64(229)
2025-03-09 10:07:33,519 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-09 10:07:34,099 [INFO]: Launching the whole pipeline 03/09/2025, 10:07:34
2025-03-09 10:07:34,100 [INFO]: Reading total number of vectors and dimension 03/09/2025, 10:07:34
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1207.69it/s]
2025-03-09 10:07:34,126 [INFO]: There are 4513 embeddings of dim 49152
2025-03-09 10:07:34,126 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0266 secs
2025-03-09 10:07:34,126 [INFO]: 	Compute estimated construction time of the index 03/09/2025, 10:07:34
2025-03-09 10:07:34,126 [INFO]: 		-> Train: 16.7 minutes
2025-03-09 10:07:34,126 [INFO]: 		-> Add: 2.5 seconds
2025-03-09 10:07:34,126 [INFO]: 		Total: 16.7 minutes
2025-03-09 10:07:34,126 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0001 secs
2025-03-09 10:07:34,126 [INFO]: 	Checking that your have enough memory available to create the index 03/09/2025, 10:07:34
2025-03-09 10:07:34,127 [INFO]: 931.4MB of memory will be needed to build the index (more might be used if you have more)
2025-03-09 10:07:34,127 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0002 secs
2025-03-09 10:07:34,127 [INFO]: 	Selecting most promising index types given data characteristics 03/09/2025, 10:07:34
2025-03-09 10:07:34,127 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-09 10:07:34,127 [INFO]: 	Creating the index 03/09/2025, 10:07:34
2025-03-09 10:07:34,127 [INFO]: 		-> Instanciate the index HNSW15 03/09/2025, 10:07:34
2025-03-09 10:07:34,128 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0012 secs
2025-03-09 10:07:34,128 [INFO]: 		-> Adding the vectors to the index 03/09/2025, 10:07:34
2025-03-09 10:07:34,128 [INFO]: The memory available for adding the vectors is 49.2GB(total available - used by the index)
2025-03-09 10:07:34,128 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/18 [00:00<?, ?it/s]  6%|▌         | 1/18 [00:00<00:02,  6.43it/s] 17%|█▋        | 3/18 [00:00<00:01, 10.42it/s] 28%|██▊       | 5/18 [00:00<00:01, 11.65it/s] 39%|███▉      | 7/18 [00:00<00:00, 13.10it/s] 50%|█████     | 9/18 [00:00<00:00, 13.08it/s] 61%|██████    | 11/18 [00:00<00:00, 13.10it/s] 72%|███████▏  | 13/18 [00:01<00:00, 13.19it/s] 83%|████████▎ | 15/18 [00:01<00:00, 13.21it/s] 94%|█████████▍| 17/18 [00:01<00:00, 13.28it/s]100%|██████████| 18/18 [00:04<00:00,  3.90it/s]
2025-03-09 10:07:38,754 [INFO]: 	Computing best hyperparameters for index knn.index 03/09/2025, 10:07:38
2025-03-09 10:08:14,824 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 36.0693 secs
2025-03-09 10:08:14,825 [INFO]: The best hyperparameters are: efSearch=256
2025-03-09 10:08:14,825 [INFO]: 	Compute fast metrics 03/09/2025, 10:08:14
  0%|          | 0/4 [00:00<?, ?it/s] 25%|██▌       | 1/4 [00:00<00:00,  5.81it/s] 75%|███████▌  | 3/4 [00:00<00:00,  8.47it/s] 75%|███████▌  | 3/4 [00:00<00:00,  6.49it/s]
2025-03-09 10:08:35,355 [INFO]: 	>>> Finished "Compute fast metrics" in 20.5302 secs
2025-03-09 10:08:35,358 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 61.2294 secs
2025-03-09 10:08:35,358 [INFO]: {
2025-03-09 10:08:35,358 [INFO]: 	index_key: HNSW15
2025-03-09 10:08:35,358 [INFO]: 	index_param: efSearch=256
2025-03-09 10:08:35,358 [INFO]: 	index_path: knn.index
2025-03-09 10:08:35,358 [INFO]: 	size in bytes: 887905690
2025-03-09 10:08:35,358 [INFO]: 	avg_search_speed_ms: 9.116311931563244
2025-03-09 10:08:35,358 [INFO]: 	99p_search_speed_ms: 15.203816415742036
2025-03-09 10:08:35,358 [INFO]: 	reconstruction error %: 0.0
2025-03-09 10:08:35,358 [INFO]: 	nb vectors: 4513
2025-03-09 10:08:35,358 [INFO]: 	vectors dimension: 49152
2025-03-09 10:08:35,358 [INFO]: 	compression ratio: 0.9993087261328396
2025-03-09 10:08:35,358 [INFO]: }
2025-03-09 10:08:35,358 [INFO]: 	>>> Finished "Creating the index" in 61.2311 secs
2025-03-09 10:08:35,358 [INFO]: >>> Finished "Launching the whole pipeline" in 61.2584 secs
2025-03-09 10:08:37: [retrieval_preprocessing] calculating distances ...
2025-03-09 10:08:37: [retrieval_preprocessing] finished and saved retrieval indices for episode 27947 [episode count 18/20]
[retrieval_preprocessing] for episode 24109 [episode count 19/20], we have num_retrieval=np.int64(4580) num_query=np.int64(162)
2025-03-09 10:08:38,357 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-09 10:08:39,167 [INFO]: Launching the whole pipeline 03/09/2025, 10:08:39
2025-03-09 10:08:39,168 [INFO]: Reading total number of vectors and dimension 03/09/2025, 10:08:39
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1799.36it/s]
2025-03-09 10:08:39,194 [INFO]: There are 4580 embeddings of dim 49152
2025-03-09 10:08:39,194 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0264 secs
2025-03-09 10:08:39,194 [INFO]: 	Compute estimated construction time of the index 03/09/2025, 10:08:39
2025-03-09 10:08:39,194 [INFO]: 		-> Train: 16.7 minutes
2025-03-09 10:08:39,194 [INFO]: 		-> Add: 2.5 seconds
2025-03-09 10:08:39,194 [INFO]: 		Total: 16.7 minutes
2025-03-09 10:08:39,194 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0001 secs
2025-03-09 10:08:39,194 [INFO]: 	Checking that your have enough memory available to create the index 03/09/2025, 10:08:39
2025-03-09 10:08:39,194 [INFO]: 945.2MB of memory will be needed to build the index (more might be used if you have more)
2025-03-09 10:08:39,194 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0001 secs
2025-03-09 10:08:39,195 [INFO]: 	Selecting most promising index types given data characteristics 03/09/2025, 10:08:39
2025-03-09 10:08:39,195 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-09 10:08:39,195 [INFO]: 	Creating the index 03/09/2025, 10:08:39
2025-03-09 10:08:39,195 [INFO]: 		-> Instanciate the index HNSW15 03/09/2025, 10:08:39
2025-03-09 10:08:39,196 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0011 secs
2025-03-09 10:08:39,196 [INFO]: 		-> Adding the vectors to the index 03/09/2025, 10:08:39
2025-03-09 10:08:39,196 [INFO]: The memory available for adding the vectors is 49.2GB(total available - used by the index)
2025-03-09 10:08:39,196 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/19 [00:00<?, ?it/s]  5%|▌         | 1/19 [00:00<00:03,  4.92it/s] 11%|█         | 2/19 [00:00<00:02,  6.82it/s] 16%|█▌        | 3/19 [00:00<00:02,  7.72it/s] 21%|██        | 4/19 [00:00<00:01,  8.30it/s] 26%|██▋       | 5/19 [00:00<00:01,  8.68it/s] 32%|███▏      | 6/19 [00:00<00:01,  8.73it/s] 37%|███▋      | 7/19 [00:00<00:01,  8.91it/s] 42%|████▏     | 8/19 [00:00<00:01,  8.42it/s] 47%|████▋     | 9/19 [00:01<00:01,  8.34it/s] 53%|█████▎    | 10/19 [00:01<00:01,  8.20it/s] 58%|█████▊    | 11/19 [00:01<00:00,  8.12it/s] 63%|██████▎   | 12/19 [00:01<00:00,  8.21it/s] 68%|██████▊   | 13/19 [00:01<00:00,  8.16it/s] 74%|███████▎  | 14/19 [00:01<00:00,  8.04it/s] 79%|███████▉  | 15/19 [00:01<00:00,  7.83it/s] 84%|████████▍ | 16/19 [00:02<00:00,  7.58it/s] 89%|████████▉ | 17/19 [00:02<00:00,  7.41it/s] 95%|█████████▍| 18/19 [00:02<00:00,  7.64it/s]100%|██████████| 19/19 [00:05<00:00,  1.04s/it]100%|██████████| 19/19 [00:05<00:00,  3.49it/s]
2025-03-09 10:08:44,647 [INFO]: 	Computing best hyperparameters for index knn.index 03/09/2025, 10:08:44
2025-03-09 10:09:21,655 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 37.0071 secs
2025-03-09 10:09:21,655 [INFO]: The best hyperparameters are: efSearch=227
2025-03-09 10:09:21,655 [INFO]: 	Compute fast metrics 03/09/2025, 10:09:21
  0%|          | 0/4 [00:00<?, ?it/s] 75%|███████▌  | 3/4 [00:00<00:00, 25.58it/s] 75%|███████▌  | 3/4 [00:00<00:00, 21.64it/s]
2025-03-09 10:09:37,008 [INFO]: 	>>> Finished "Compute fast metrics" in 15.3533 secs
2025-03-09 10:09:37,011 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 57.8153 secs
2025-03-09 10:09:37,012 [INFO]: {
2025-03-09 10:09:37,012 [INFO]: 	index_key: HNSW15
2025-03-09 10:09:37,012 [INFO]: 	index_param: efSearch=227
2025-03-09 10:09:37,012 [INFO]: 	index_path: knn.index
2025-03-09 10:09:37,012 [INFO]: 	size in bytes: 901087510
2025-03-09 10:09:37,012 [INFO]: 	avg_search_speed_ms: 8.825462359593095
2025-03-09 10:09:37,012 [INFO]: 	99p_search_speed_ms: 15.809526136144996
2025-03-09 10:09:37,012 [INFO]: 	reconstruction error %: 0.0
2025-03-09 10:09:37,012 [INFO]: 	nb vectors: 4580
2025-03-09 10:09:37,012 [INFO]: 	vectors dimension: 49152
2025-03-09 10:09:37,012 [INFO]: 	compression ratio: 0.9993087574812795
2025-03-09 10:09:37,012 [INFO]: }
2025-03-09 10:09:37,012 [INFO]: 	>>> Finished "Creating the index" in 57.8171 secs
2025-03-09 10:09:37,012 [INFO]: >>> Finished "Launching the whole pipeline" in 57.8441 secs
2025-03-09 10:09:38: [retrieval_preprocessing] calculating distances ...
2025-03-09 10:09:38: [retrieval_preprocessing] finished and saved retrieval indices for episode 24109 [episode count 19/20]
2025-03-09 10:09:38: [retrieval_preprocessing] finished for (1575177183, 'marker') [chosen_id count 8/10]
2025-03-09 10:09:39: [retrieval_preprocessing] concatenated all embeddings and indices for 20 episodes for (5414640868, 'lid') [chosen_id count 9/10]
2025-03-09 10:09:39: [retrieval_preprocessing] we have num_total=3972 embedding_dim=49152
[retrieval_preprocessing] for episode 40577 [episode count 0/20], we have num_retrieval=np.int64(3774) num_query=np.int64(198)
2025-03-09 10:09:39,878 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-09 10:09:40,299 [INFO]: Launching the whole pipeline 03/09/2025, 10:09:40
2025-03-09 10:09:40,299 [INFO]: Reading total number of vectors and dimension 03/09/2025, 10:09:40
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 2285.72it/s]
2025-03-09 10:09:40,323 [INFO]: There are 3774 embeddings of dim 49152
2025-03-09 10:09:40,323 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0238 secs
2025-03-09 10:09:40,323 [INFO]: 	Compute estimated construction time of the index 03/09/2025, 10:09:40
2025-03-09 10:09:40,323 [INFO]: 		-> Train: 16.7 minutes
2025-03-09 10:09:40,323 [INFO]: 		-> Add: 2.1 seconds
2025-03-09 10:09:40,323 [INFO]: 		Total: 16.7 minutes
2025-03-09 10:09:40,324 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0001 secs
2025-03-09 10:09:40,324 [INFO]: 	Checking that your have enough memory available to create the index 03/09/2025, 10:09:40
2025-03-09 10:09:40,324 [INFO]: 778.9MB of memory will be needed to build the index (more might be used if you have more)
2025-03-09 10:09:40,324 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0001 secs
2025-03-09 10:09:40,324 [INFO]: 	Selecting most promising index types given data characteristics 03/09/2025, 10:09:40
2025-03-09 10:09:40,324 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-09 10:09:40,324 [INFO]: 	Creating the index 03/09/2025, 10:09:40
2025-03-09 10:09:40,324 [INFO]: 		-> Instanciate the index HNSW15 03/09/2025, 10:09:40
2025-03-09 10:09:40,325 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0010 secs
2025-03-09 10:09:40,325 [INFO]: 		-> Adding the vectors to the index 03/09/2025, 10:09:40
2025-03-09 10:09:40,325 [INFO]: The memory available for adding the vectors is 49.3GB(total available - used by the index)
2025-03-09 10:09:40,325 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/15 [00:00<?, ?it/s]  7%|▋         | 1/15 [00:00<00:02,  6.86it/s] 20%|██        | 3/15 [00:00<00:01, 10.65it/s] 33%|███▎      | 5/15 [00:00<00:00, 12.40it/s] 47%|████▋     | 7/15 [00:00<00:00, 13.03it/s] 60%|██████    | 9/15 [00:00<00:00, 13.16it/s] 73%|███████▎  | 11/15 [00:00<00:00, 13.39it/s] 87%|████████▋ | 13/15 [00:01<00:00, 13.36it/s]100%|██████████| 15/15 [00:03<00:00,  2.38it/s]100%|██████████| 15/15 [00:03<00:00,  4.53it/s]
2025-03-09 10:09:43,644 [INFO]: 	Computing best hyperparameters for index knn.index 03/09/2025, 10:09:43
2025-03-09 10:10:19,475 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 35.8305 secs
2025-03-09 10:10:19,475 [INFO]: The best hyperparameters are: efSearch=344
2025-03-09 10:10:19,475 [INFO]: 	Compute fast metrics 03/09/2025, 10:10:19
  0%|          | 0/4 [00:00<?, ?it/s] 25%|██▌       | 1/4 [00:00<00:00,  9.99it/s] 75%|███████▌  | 3/4 [00:00<00:00, 13.21it/s]
2025-03-09 10:10:35,458 [INFO]: 	>>> Finished "Compute fast metrics" in 15.9823 secs
2025-03-09 10:10:35,460 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 55.1352 secs
2025-03-09 10:10:35,460 [INFO]: {
2025-03-09 10:10:35,460 [INFO]: 	index_key: HNSW15
2025-03-09 10:10:35,460 [INFO]: 	index_param: efSearch=344
2025-03-09 10:10:35,460 [INFO]: 	index_path: knn.index
2025-03-09 10:10:35,460 [INFO]: 	size in bytes: 742511530
2025-03-09 10:10:35,460 [INFO]: 	avg_search_speed_ms: 10.523664895200023
2025-03-09 10:10:35,460 [INFO]: 	99p_search_speed_ms: 16.711479413788762
2025-03-09 10:10:35,461 [INFO]: 	reconstruction error %: 0.0
2025-03-09 10:10:35,461 [INFO]: 	nb vectors: 3774
2025-03-09 10:10:35,461 [INFO]: 	vectors dimension: 49152
2025-03-09 10:10:35,461 [INFO]: 	compression ratio: 0.9993091851381756
2025-03-09 10:10:35,461 [INFO]: }
2025-03-09 10:10:35,461 [INFO]: 	>>> Finished "Creating the index" in 55.1367 secs
2025-03-09 10:10:35,461 [INFO]: >>> Finished "Launching the whole pipeline" in 55.1611 secs
2025-03-09 10:10:38: [retrieval_preprocessing] calculating distances ...
2025-03-09 10:10:38: [retrieval_preprocessing] finished and saved retrieval indices for episode 40577 [episode count 0/20]
[retrieval_preprocessing] for episode 71816 [episode count 1/20], we have num_retrieval=np.int64(3776) num_query=np.int64(196)
2025-03-09 10:10:39,567 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-09 10:10:40,043 [INFO]: Launching the whole pipeline 03/09/2025, 10:10:40
2025-03-09 10:10:40,043 [INFO]: Reading total number of vectors and dimension 03/09/2025, 10:10:40
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 2155.35it/s]
2025-03-09 10:10:40,066 [INFO]: There are 3776 embeddings of dim 49152
2025-03-09 10:10:40,067 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0233 secs
2025-03-09 10:10:40,067 [INFO]: 	Compute estimated construction time of the index 03/09/2025, 10:10:40
2025-03-09 10:10:40,067 [INFO]: 		-> Train: 16.7 minutes
2025-03-09 10:10:40,067 [INFO]: 		-> Add: 2.1 seconds
2025-03-09 10:10:40,067 [INFO]: 		Total: 16.7 minutes
2025-03-09 10:10:40,067 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0002 secs
2025-03-09 10:10:40,067 [INFO]: 	Checking that your have enough memory available to create the index 03/09/2025, 10:10:40
2025-03-09 10:10:40,067 [INFO]: 779.3MB of memory will be needed to build the index (more might be used if you have more)
2025-03-09 10:10:40,067 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0001 secs
2025-03-09 10:10:40,067 [INFO]: 	Selecting most promising index types given data characteristics 03/09/2025, 10:10:40
2025-03-09 10:10:40,067 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-09 10:10:40,067 [INFO]: 	Creating the index 03/09/2025, 10:10:40
2025-03-09 10:10:40,067 [INFO]: 		-> Instanciate the index HNSW15 03/09/2025, 10:10:40
2025-03-09 10:10:40,068 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0009 secs
2025-03-09 10:10:40,068 [INFO]: 		-> Adding the vectors to the index 03/09/2025, 10:10:40
2025-03-09 10:10:40,068 [INFO]: The memory available for adding the vectors is 49.3GB(total available - used by the index)
2025-03-09 10:10:40,068 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/15 [00:00<?, ?it/s]  7%|▋         | 1/15 [00:00<00:02,  5.81it/s] 20%|██        | 3/15 [00:00<00:01, 10.24it/s] 33%|███▎      | 5/15 [00:00<00:00, 11.59it/s] 47%|████▋     | 7/15 [00:00<00:00, 12.66it/s] 60%|██████    | 9/15 [00:00<00:00, 12.34it/s] 73%|███████▎  | 11/15 [00:00<00:00, 12.14it/s] 87%|████████▋ | 13/15 [00:01<00:00, 12.15it/s]100%|██████████| 15/15 [00:03<00:00,  2.11it/s]100%|██████████| 15/15 [00:03<00:00,  4.06it/s]
2025-03-09 10:10:43,775 [INFO]: 	Computing best hyperparameters for index knn.index 03/09/2025, 10:10:43
2025-03-09 10:11:17,060 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 33.2846 secs
2025-03-09 10:11:17,060 [INFO]: The best hyperparameters are: efSearch=352
2025-03-09 10:11:17,060 [INFO]: 	Compute fast metrics 03/09/2025, 10:11:17
  0%|          | 0/4 [00:00<?, ?it/s] 25%|██▌       | 1/4 [00:00<00:00,  6.50it/s] 75%|███████▌  | 3/4 [00:00<00:00, 10.29it/s] 75%|███████▌  | 3/4 [00:00<00:00,  7.90it/s]
2025-03-09 10:11:31,351 [INFO]: 	>>> Finished "Compute fast metrics" in 14.2905 secs
2025-03-09 10:11:31,353 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 51.2849 secs
2025-03-09 10:11:31,353 [INFO]: {
2025-03-09 10:11:31,353 [INFO]: 	index_key: HNSW15
2025-03-09 10:11:31,353 [INFO]: 	index_param: efSearch=352
2025-03-09 10:11:31,353 [INFO]: 	index_path: knn.index
2025-03-09 10:11:31,353 [INFO]: 	size in bytes: 742905010
2025-03-09 10:11:31,353 [INFO]: 	avg_search_speed_ms: 10.369853722559544
2025-03-09 10:11:31,353 [INFO]: 	99p_search_speed_ms: 15.526985949836673
2025-03-09 10:11:31,353 [INFO]: 	reconstruction error %: 0.0
2025-03-09 10:11:31,353 [INFO]: 	nb vectors: 3776
2025-03-09 10:11:31,353 [INFO]: 	vectors dimension: 49152
2025-03-09 10:11:31,354 [INFO]: 	compression ratio: 0.9993091956668861
2025-03-09 10:11:31,354 [INFO]: }
2025-03-09 10:11:31,354 [INFO]: 	>>> Finished "Creating the index" in 51.2863 secs
2025-03-09 10:11:31,354 [INFO]: >>> Finished "Launching the whole pipeline" in 51.3102 secs
2025-03-09 10:11:33: [retrieval_preprocessing] calculating distances ...
2025-03-09 10:11:33: [retrieval_preprocessing] finished and saved retrieval indices for episode 71816 [episode count 1/20]
[retrieval_preprocessing] for episode 87690 [episode count 2/20], we have num_retrieval=np.int64(3814) num_query=np.int64(158)
2025-03-09 10:11:34,991 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-09 10:11:35,609 [INFO]: Launching the whole pipeline 03/09/2025, 10:11:35
2025-03-09 10:11:35,609 [INFO]: Reading total number of vectors and dimension 03/09/2025, 10:11:35
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 2179.99it/s]
2025-03-09 10:11:35,633 [INFO]: There are 3814 embeddings of dim 49152
2025-03-09 10:11:35,633 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0244 secs
2025-03-09 10:11:35,633 [INFO]: 	Compute estimated construction time of the index 03/09/2025, 10:11:35
2025-03-09 10:11:35,633 [INFO]: 		-> Train: 16.7 minutes
2025-03-09 10:11:35,633 [INFO]: 		-> Add: 2.1 seconds
2025-03-09 10:11:35,633 [INFO]: 		Total: 16.7 minutes
2025-03-09 10:11:35,633 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0001 secs
2025-03-09 10:11:35,633 [INFO]: 	Checking that your have enough memory available to create the index 03/09/2025, 10:11:35
2025-03-09 10:11:35,633 [INFO]: 787.1MB of memory will be needed to build the index (more might be used if you have more)
2025-03-09 10:11:35,634 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0001 secs
2025-03-09 10:11:35,634 [INFO]: 	Selecting most promising index types given data characteristics 03/09/2025, 10:11:35
2025-03-09 10:11:35,634 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-09 10:11:35,634 [INFO]: 	Creating the index 03/09/2025, 10:11:35
2025-03-09 10:11:35,634 [INFO]: 		-> Instanciate the index HNSW15 03/09/2025, 10:11:35
2025-03-09 10:11:35,635 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0009 secs
2025-03-09 10:11:35,635 [INFO]: 		-> Adding the vectors to the index 03/09/2025, 10:11:35
2025-03-09 10:11:35,635 [INFO]: The memory available for adding the vectors is 49.3GB(total available - used by the index)
2025-03-09 10:11:35,635 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/16 [00:00<?, ?it/s]  6%|▋         | 1/16 [00:00<00:02,  5.66it/s] 19%|█▉        | 3/16 [00:00<00:01,  8.48it/s] 31%|███▏      | 5/16 [00:00<00:01, 10.38it/s] 44%|████▍     | 7/16 [00:00<00:00, 10.81it/s] 56%|█████▋    | 9/16 [00:00<00:00, 10.69it/s] 69%|██████▉   | 11/16 [00:01<00:00, 10.63it/s] 81%|████████▏ | 13/16 [00:01<00:00, 10.23it/s] 94%|█████████▍| 15/16 [00:01<00:00, 10.17it/s]100%|██████████| 16/16 [00:03<00:00,  4.20it/s]
2025-03-09 10:11:39,451 [INFO]: 	Computing best hyperparameters for index knn.index 03/09/2025, 10:11:39
2025-03-09 10:12:14,956 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 35.5050 secs
2025-03-09 10:12:14,956 [INFO]: The best hyperparameters are: efSearch=341
2025-03-09 10:12:14,956 [INFO]: 	Compute fast metrics 03/09/2025, 10:12:14
  0%|          | 0/4 [00:00<?, ?it/s] 75%|███████▌  | 3/4 [00:00<00:00, 26.37it/s] 75%|███████▌  | 3/4 [00:00<00:00, 23.11it/s]
2025-03-09 10:12:29,268 [INFO]: 	>>> Finished "Compute fast metrics" in 14.3115 secs
2025-03-09 10:12:29,270 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 53.6353 secs
2025-03-09 10:12:29,270 [INFO]: {
2025-03-09 10:12:29,270 [INFO]: 	index_key: HNSW15
2025-03-09 10:12:29,270 [INFO]: 	index_param: efSearch=341
2025-03-09 10:12:29,270 [INFO]: 	index_path: knn.index
2025-03-09 10:12:29,270 [INFO]: 	size in bytes: 750381370
2025-03-09 10:12:29,270 [INFO]: 	avg_search_speed_ms: 10.251188759747357
2025-03-09 10:12:29,270 [INFO]: 	99p_search_speed_ms: 16.609779733698815
2025-03-09 10:12:29,270 [INFO]: 	reconstruction error %: 0.0
2025-03-09 10:12:29,270 [INFO]: 	nb vectors: 3814
2025-03-09 10:12:29,270 [INFO]: 	vectors dimension: 49152
2025-03-09 10:12:29,270 [INFO]: 	compression ratio: 0.9993090739979326
2025-03-09 10:12:29,270 [INFO]: }
2025-03-09 10:12:29,270 [INFO]: 	>>> Finished "Creating the index" in 53.6366 secs
2025-03-09 10:12:29,270 [INFO]: >>> Finished "Launching the whole pipeline" in 53.6616 secs
2025-03-09 10:12:30: [retrieval_preprocessing] calculating distances ...
2025-03-09 10:12:31: [retrieval_preprocessing] finished and saved retrieval indices for episode 87690 [episode count 2/20]
[retrieval_preprocessing] for episode 18702 [episode count 3/20], we have num_retrieval=np.int64(3736) num_query=np.int64(236)
2025-03-09 10:12:32,565 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-09 10:12:33,047 [INFO]: Launching the whole pipeline 03/09/2025, 10:12:33
2025-03-09 10:12:33,047 [INFO]: Reading total number of vectors and dimension 03/09/2025, 10:12:33
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1906.50it/s]
2025-03-09 10:12:33,071 [INFO]: There are 3736 embeddings of dim 49152
2025-03-09 10:12:33,071 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0236 secs
2025-03-09 10:12:33,071 [INFO]: 	Compute estimated construction time of the index 03/09/2025, 10:12:33
2025-03-09 10:12:33,071 [INFO]: 		-> Train: 16.7 minutes
2025-03-09 10:12:33,071 [INFO]: 		-> Add: 2.1 seconds
2025-03-09 10:12:33,071 [INFO]: 		Total: 16.7 minutes
2025-03-09 10:12:33,071 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0001 secs
2025-03-09 10:12:33,071 [INFO]: 	Checking that your have enough memory available to create the index 03/09/2025, 10:12:33
2025-03-09 10:12:33,071 [INFO]: 771.0MB of memory will be needed to build the index (more might be used if you have more)
2025-03-09 10:12:33,071 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0001 secs
2025-03-09 10:12:33,071 [INFO]: 	Selecting most promising index types given data characteristics 03/09/2025, 10:12:33
2025-03-09 10:12:33,071 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-09 10:12:33,072 [INFO]: 	Creating the index 03/09/2025, 10:12:33
2025-03-09 10:12:33,072 [INFO]: 		-> Instanciate the index HNSW15 03/09/2025, 10:12:33
2025-03-09 10:12:33,072 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0008 secs
2025-03-09 10:12:33,072 [INFO]: 		-> Adding the vectors to the index 03/09/2025, 10:12:33
2025-03-09 10:12:33,072 [INFO]: The memory available for adding the vectors is 49.3GB(total available - used by the index)
2025-03-09 10:12:33,072 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/15 [00:00<?, ?it/s]  7%|▋         | 1/15 [00:00<00:02,  6.57it/s] 20%|██        | 3/15 [00:00<00:01, 10.43it/s] 33%|███▎      | 5/15 [00:00<00:00, 11.62it/s] 47%|████▋     | 7/15 [00:00<00:00, 12.16it/s] 60%|██████    | 9/15 [00:00<00:00, 12.59it/s] 80%|████████  | 12/15 [00:00<00:00, 16.78it/s]100%|██████████| 15/15 [00:03<00:00,  3.01it/s]100%|██████████| 15/15 [00:03<00:00,  4.76it/s]
2025-03-09 10:12:36,229 [INFO]: 	Computing best hyperparameters for index knn.index 03/09/2025, 10:12:36
2025-03-09 10:13:09,035 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 32.8062 secs
2025-03-09 10:13:09,036 [INFO]: The best hyperparameters are: efSearch=344
2025-03-09 10:13:09,036 [INFO]: 	Compute fast metrics 03/09/2025, 10:13:09
  0%|          | 0/4 [00:00<?, ?it/s] 25%|██▌       | 1/4 [00:00<00:00,  5.97it/s] 75%|███████▌  | 3/4 [00:00<00:00,  9.96it/s] 75%|███████▌  | 3/4 [00:00<00:00,  7.69it/s]
2025-03-09 10:13:22,411 [INFO]: 	>>> Finished "Compute fast metrics" in 13.3754 secs
2025-03-09 10:13:22,414 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 49.3413 secs
2025-03-09 10:13:22,414 [INFO]: {
2025-03-09 10:13:22,414 [INFO]: 	index_key: HNSW15
2025-03-09 10:13:22,414 [INFO]: 	index_param: efSearch=344
2025-03-09 10:13:22,414 [INFO]: 	index_path: knn.index
2025-03-09 10:13:22,414 [INFO]: 	size in bytes: 735035230
2025-03-09 10:13:22,414 [INFO]: 	avg_search_speed_ms: 10.680726662170715
2025-03-09 10:13:22,414 [INFO]: 	99p_search_speed_ms: 15.473537263460456
2025-03-09 10:13:22,414 [INFO]: 	reconstruction error %: 0.0
2025-03-09 10:13:22,414 [INFO]: 	nb vectors: 3736
2025-03-09 10:13:22,414 [INFO]: 	vectors dimension: 49152
2025-03-09 10:13:22,414 [INFO]: 	compression ratio: 0.9993092276679038
2025-03-09 10:13:22,414 [INFO]: }
2025-03-09 10:13:22,414 [INFO]: 	>>> Finished "Creating the index" in 49.3425 secs
2025-03-09 10:13:22,414 [INFO]: >>> Finished "Launching the whole pipeline" in 49.3666 secs
2025-03-09 10:13:25: [retrieval_preprocessing] calculating distances ...
2025-03-09 10:13:25: [retrieval_preprocessing] finished and saved retrieval indices for episode 18702 [episode count 3/20]
[retrieval_preprocessing] for episode 53391 [episode count 4/20], we have num_retrieval=np.int64(3811) num_query=np.int64(161)
2025-03-09 10:13:26,903 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-09 10:13:27,384 [INFO]: Launching the whole pipeline 03/09/2025, 10:13:27
2025-03-09 10:13:27,384 [INFO]: Reading total number of vectors and dimension 03/09/2025, 10:13:27
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1491.57it/s]
2025-03-09 10:13:27,409 [INFO]: There are 3811 embeddings of dim 49152
2025-03-09 10:13:27,409 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0255 secs
2025-03-09 10:13:27,410 [INFO]: 	Compute estimated construction time of the index 03/09/2025, 10:13:27
2025-03-09 10:13:27,410 [INFO]: 		-> Train: 16.7 minutes
2025-03-09 10:13:27,410 [INFO]: 		-> Add: 2.1 seconds
2025-03-09 10:13:27,410 [INFO]: 		Total: 16.7 minutes
2025-03-09 10:13:27,410 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0001 secs
2025-03-09 10:13:27,410 [INFO]: 	Checking that your have enough memory available to create the index 03/09/2025, 10:13:27
2025-03-09 10:13:27,410 [INFO]: 786.5MB of memory will be needed to build the index (more might be used if you have more)
2025-03-09 10:13:27,410 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0001 secs
2025-03-09 10:13:27,410 [INFO]: 	Selecting most promising index types given data characteristics 03/09/2025, 10:13:27
2025-03-09 10:13:27,410 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-09 10:13:27,410 [INFO]: 	Creating the index 03/09/2025, 10:13:27
2025-03-09 10:13:27,410 [INFO]: 		-> Instanciate the index HNSW15 03/09/2025, 10:13:27
2025-03-09 10:13:27,411 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0010 secs
2025-03-09 10:13:27,411 [INFO]: 		-> Adding the vectors to the index 03/09/2025, 10:13:27
2025-03-09 10:13:27,411 [INFO]: The memory available for adding the vectors is 49.3GB(total available - used by the index)
2025-03-09 10:13:27,411 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/16 [00:00<?, ?it/s]  6%|▋         | 1/16 [00:00<00:02,  5.92it/s] 31%|███▏      | 5/16 [00:00<00:00, 20.01it/s] 50%|█████     | 8/16 [00:00<00:00, 17.04it/s] 62%|██████▎   | 10/16 [00:00<00:00, 16.03it/s] 75%|███████▌  | 12/16 [00:00<00:00, 15.66it/s] 88%|████████▊ | 14/16 [00:00<00:00, 14.80it/s]100%|██████████| 16/16 [00:03<00:00,  2.45it/s]100%|██████████| 16/16 [00:03<00:00,  4.86it/s]
2025-03-09 10:13:30,706 [INFO]: 	Computing best hyperparameters for index knn.index 03/09/2025, 10:13:30
2025-03-09 10:14:06,428 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 35.7210 secs
2025-03-09 10:14:06,428 [INFO]: The best hyperparameters are: efSearch=347
2025-03-09 10:14:06,428 [INFO]: 	Compute fast metrics 03/09/2025, 10:14:06
  0%|          | 0/4 [00:00<?, ?it/s] 25%|██▌       | 1/4 [00:00<00:00,  6.61it/s] 75%|███████▌  | 3/4 [00:00<00:00, 10.25it/s] 75%|███████▌  | 3/4 [00:00<00:00,  7.91it/s]
2025-03-09 10:14:22,803 [INFO]: 	>>> Finished "Compute fast metrics" in 16.3743 secs
2025-03-09 10:14:22,805 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 55.3937 secs
2025-03-09 10:14:22,805 [INFO]: {
2025-03-09 10:14:22,805 [INFO]: 	index_key: HNSW15
2025-03-09 10:14:22,805 [INFO]: 	index_param: efSearch=347
2025-03-09 10:14:22,805 [INFO]: 	index_path: knn.index
2025-03-09 10:14:22,805 [INFO]: 	size in bytes: 749791150
2025-03-09 10:14:22,805 [INFO]: 	avg_search_speed_ms: 11.00249900610524
2025-03-09 10:14:22,805 [INFO]: 	99p_search_speed_ms: 18.85981724364683
2025-03-09 10:14:22,805 [INFO]: 	reconstruction error %: 0.0
2025-03-09 10:14:22,805 [INFO]: 	nb vectors: 3811
2025-03-09 10:14:22,805 [INFO]: 	vectors dimension: 49152
2025-03-09 10:14:22,805 [INFO]: 	compression ratio: 0.9993090582624241
2025-03-09 10:14:22,805 [INFO]: }
2025-03-09 10:14:22,805 [INFO]: 	>>> Finished "Creating the index" in 55.3952 secs
2025-03-09 10:14:22,805 [INFO]: >>> Finished "Launching the whole pipeline" in 55.4213 secs
2025-03-09 10:14:24: [retrieval_preprocessing] calculating distances ...
2025-03-09 10:14:25: [retrieval_preprocessing] finished and saved retrieval indices for episode 53391 [episode count 4/20]
[retrieval_preprocessing] for episode 74899 [episode count 5/20], we have num_retrieval=np.int64(3719) num_query=np.int64(253)
2025-03-09 10:14:25,896 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-09 10:14:26,338 [INFO]: Launching the whole pipeline 03/09/2025, 10:14:26
2025-03-09 10:14:26,338 [INFO]: Reading total number of vectors and dimension 03/09/2025, 10:14:26
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1487.87it/s]
2025-03-09 10:14:26,365 [INFO]: There are 3719 embeddings of dim 49152
2025-03-09 10:14:26,365 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0264 secs
2025-03-09 10:14:26,365 [INFO]: 	Compute estimated construction time of the index 03/09/2025, 10:14:26
2025-03-09 10:14:26,365 [INFO]: 		-> Train: 16.7 minutes
2025-03-09 10:14:26,365 [INFO]: 		-> Add: 2.0 seconds
2025-03-09 10:14:26,365 [INFO]: 		Total: 16.7 minutes
2025-03-09 10:14:26,365 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0001 secs
2025-03-09 10:14:26,365 [INFO]: 	Checking that your have enough memory available to create the index 03/09/2025, 10:14:26
2025-03-09 10:14:26,365 [INFO]: 767.5MB of memory will be needed to build the index (more might be used if you have more)
2025-03-09 10:14:26,365 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0002 secs
2025-03-09 10:14:26,365 [INFO]: 	Selecting most promising index types given data characteristics 03/09/2025, 10:14:26
2025-03-09 10:14:26,365 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-09 10:14:26,366 [INFO]: 	Creating the index 03/09/2025, 10:14:26
2025-03-09 10:14:26,366 [INFO]: 		-> Instanciate the index HNSW15 03/09/2025, 10:14:26
2025-03-09 10:14:26,367 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0012 secs
2025-03-09 10:14:26,367 [INFO]: 		-> Adding the vectors to the index 03/09/2025, 10:14:26
2025-03-09 10:14:26,367 [INFO]: The memory available for adding the vectors is 49.3GB(total available - used by the index)
2025-03-09 10:14:26,367 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/15 [00:00<?, ?it/s]  7%|▋         | 1/15 [00:00<00:02,  6.79it/s] 20%|██        | 3/15 [00:00<00:01, 10.84it/s] 33%|███▎      | 5/15 [00:00<00:00, 12.12it/s] 47%|████▋     | 7/15 [00:00<00:00, 12.70it/s] 60%|██████    | 9/15 [00:00<00:00, 13.05it/s] 73%|███████▎  | 11/15 [00:00<00:00, 13.22it/s] 87%|████████▋ | 13/15 [00:00<00:00, 14.50it/s]100%|██████████| 15/15 [00:03<00:00,  2.57it/s]100%|██████████| 15/15 [00:03<00:00,  4.82it/s]
2025-03-09 10:14:29,483 [INFO]: 	Computing best hyperparameters for index knn.index 03/09/2025, 10:14:29
2025-03-09 10:14:59,954 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 30.4707 secs
2025-03-09 10:14:59,954 [INFO]: The best hyperparameters are: efSearch=363
2025-03-09 10:14:59,955 [INFO]: 	Compute fast metrics 03/09/2025, 10:14:59
  0%|          | 0/4 [00:00<?, ?it/s] 25%|██▌       | 1/4 [00:00<00:00,  5.28it/s] 50%|█████     | 2/4 [00:00<00:00,  7.27it/s] 75%|███████▌  | 3/4 [00:00<00:00,  8.14it/s] 75%|███████▌  | 3/4 [00:00<00:00,  6.09it/s]
2025-03-09 10:15:15,698 [INFO]: 	>>> Finished "Compute fast metrics" in 15.7434 secs
2025-03-09 10:15:15,700 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 49.3335 secs
2025-03-09 10:15:15,701 [INFO]: {
2025-03-09 10:15:15,701 [INFO]: 	index_key: HNSW15
2025-03-09 10:15:15,701 [INFO]: 	index_param: efSearch=363
2025-03-09 10:15:15,701 [INFO]: 	index_path: knn.index
2025-03-09 10:15:15,701 [INFO]: 	size in bytes: 731690410
2025-03-09 10:15:15,701 [INFO]: 	avg_search_speed_ms: 10.498140115488285
2025-03-09 10:15:15,701 [INFO]: 	99p_search_speed_ms: 19.087727060541514
2025-03-09 10:15:15,701 [INFO]: 	reconstruction error %: 0.0
2025-03-09 10:15:15,701 [INFO]: 	nb vectors: 3719
2025-03-09 10:15:15,701 [INFO]: 	vectors dimension: 49152
2025-03-09 10:15:15,701 [INFO]: 	compression ratio: 0.9993094647775963
2025-03-09 10:15:15,701 [INFO]: }
2025-03-09 10:15:15,701 [INFO]: 	>>> Finished "Creating the index" in 49.3352 secs
2025-03-09 10:15:15,701 [INFO]: >>> Finished "Launching the whole pipeline" in 49.3624 secs
2025-03-09 10:15:18: [retrieval_preprocessing] calculating distances ...
2025-03-09 10:15:19: [retrieval_preprocessing] finished and saved retrieval indices for episode 74899 [episode count 5/20]
[retrieval_preprocessing] for episode 67220 [episode count 6/20], we have num_retrieval=np.int64(3754) num_query=np.int64(218)
2025-03-09 10:15:20,461 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-09 10:15:20,965 [INFO]: Launching the whole pipeline 03/09/2025, 10:15:20
2025-03-09 10:15:20,966 [INFO]: Reading total number of vectors and dimension 03/09/2025, 10:15:20
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1494.23it/s]
2025-03-09 10:15:20,990 [INFO]: There are 3754 embeddings of dim 49152
2025-03-09 10:15:20,990 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0247 secs
2025-03-09 10:15:20,990 [INFO]: 	Compute estimated construction time of the index 03/09/2025, 10:15:20
2025-03-09 10:15:20,990 [INFO]: 		-> Train: 16.7 minutes
2025-03-09 10:15:20,991 [INFO]: 		-> Add: 2.1 seconds
2025-03-09 10:15:20,991 [INFO]: 		Total: 16.7 minutes
2025-03-09 10:15:20,991 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0001 secs
2025-03-09 10:15:20,991 [INFO]: 	Checking that your have enough memory available to create the index 03/09/2025, 10:15:20
2025-03-09 10:15:20,991 [INFO]: 774.7MB of memory will be needed to build the index (more might be used if you have more)
2025-03-09 10:15:20,991 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0001 secs
2025-03-09 10:15:20,991 [INFO]: 	Selecting most promising index types given data characteristics 03/09/2025, 10:15:20
2025-03-09 10:15:20,991 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-09 10:15:20,991 [INFO]: 	Creating the index 03/09/2025, 10:15:20
2025-03-09 10:15:20,991 [INFO]: 		-> Instanciate the index HNSW15 03/09/2025, 10:15:20
2025-03-09 10:15:20,992 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0009 secs
2025-03-09 10:15:20,992 [INFO]: 		-> Adding the vectors to the index 03/09/2025, 10:15:20
2025-03-09 10:15:20,992 [INFO]: The memory available for adding the vectors is 49.3GB(total available - used by the index)
2025-03-09 10:15:20,992 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/15 [00:00<?, ?it/s]  7%|▋         | 1/15 [00:00<00:01,  8.62it/s] 40%|████      | 6/15 [00:00<00:00, 30.49it/s] 67%|██████▋   | 10/15 [00:00<00:00, 34.12it/s] 93%|█████████▎| 14/15 [00:00<00:00, 35.33it/s]100%|██████████| 15/15 [00:02<00:00,  5.17it/s]
2025-03-09 10:15:23,898 [INFO]: 	Computing best hyperparameters for index knn.index 03/09/2025, 10:15:23
2025-03-09 10:15:56,544 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 32.6453 secs
2025-03-09 10:15:56,544 [INFO]: The best hyperparameters are: efSearch=354
2025-03-09 10:15:56,544 [INFO]: 	Compute fast metrics 03/09/2025, 10:15:56
  0%|          | 0/4 [00:00<?, ?it/s] 25%|██▌       | 1/4 [00:00<00:00,  5.93it/s] 50%|█████     | 2/4 [00:00<00:00,  7.50it/s] 75%|███████▌  | 3/4 [00:00<00:00,  8.23it/s] 75%|███████▌  | 3/4 [00:00<00:00,  6.21it/s]
2025-03-09 10:16:13,185 [INFO]: 	>>> Finished "Compute fast metrics" in 16.6407 secs
2025-03-09 10:16:13,187 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 52.1948 secs
2025-03-09 10:16:13,187 [INFO]: {
2025-03-09 10:16:13,187 [INFO]: 	index_key: HNSW15
2025-03-09 10:16:13,187 [INFO]: 	index_param: efSearch=354
2025-03-09 10:16:13,187 [INFO]: 	index_path: knn.index
2025-03-09 10:16:13,187 [INFO]: 	size in bytes: 738576670
2025-03-09 10:16:13,187 [INFO]: 	avg_search_speed_ms: 10.62921570256693
2025-03-09 10:16:13,187 [INFO]: 	99p_search_speed_ms: 14.317133696749806
2025-03-09 10:16:13,187 [INFO]: 	reconstruction error %: 0.0
2025-03-09 10:16:13,187 [INFO]: 	nb vectors: 3754
2025-03-09 10:16:13,187 [INFO]: 	vectors dimension: 49152
2025-03-09 10:16:13,187 [INFO]: 	compression ratio: 0.999309160415262
2025-03-09 10:16:13,187 [INFO]: }
2025-03-09 10:16:13,187 [INFO]: 	>>> Finished "Creating the index" in 52.1961 secs
2025-03-09 10:16:13,187 [INFO]: >>> Finished "Launching the whole pipeline" in 52.2215 secs
2025-03-09 10:16:15: [retrieval_preprocessing] calculating distances ...
2025-03-09 10:16:16: [retrieval_preprocessing] finished and saved retrieval indices for episode 67220 [episode count 6/20]
[retrieval_preprocessing] for episode 44181 [episode count 7/20], we have num_retrieval=np.int64(3791) num_query=np.int64(181)
2025-03-09 10:16:17,204 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-09 10:16:17,666 [INFO]: Launching the whole pipeline 03/09/2025, 10:16:17
2025-03-09 10:16:17,666 [INFO]: Reading total number of vectors and dimension 03/09/2025, 10:16:17
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1534.13it/s]
2025-03-09 10:16:17,693 [INFO]: There are 3791 embeddings of dim 49152
2025-03-09 10:16:17,693 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0277 secs
2025-03-09 10:16:17,694 [INFO]: 	Compute estimated construction time of the index 03/09/2025, 10:16:17
2025-03-09 10:16:17,694 [INFO]: 		-> Train: 16.7 minutes
2025-03-09 10:16:17,694 [INFO]: 		-> Add: 2.1 seconds
2025-03-09 10:16:17,694 [INFO]: 		Total: 16.7 minutes
2025-03-09 10:16:17,694 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0003 secs
2025-03-09 10:16:17,694 [INFO]: 	Checking that your have enough memory available to create the index 03/09/2025, 10:16:17
2025-03-09 10:16:17,694 [INFO]: 782.4MB of memory will be needed to build the index (more might be used if you have more)
2025-03-09 10:16:17,694 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0004 secs
2025-03-09 10:16:17,695 [INFO]: 	Selecting most promising index types given data characteristics 03/09/2025, 10:16:17
2025-03-09 10:16:17,695 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-09 10:16:17,695 [INFO]: 	Creating the index 03/09/2025, 10:16:17
2025-03-09 10:16:17,695 [INFO]: 		-> Instanciate the index HNSW15 03/09/2025, 10:16:17
2025-03-09 10:16:17,698 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0026 secs
2025-03-09 10:16:17,698 [INFO]: 		-> Adding the vectors to the index 03/09/2025, 10:16:17
2025-03-09 10:16:17,698 [INFO]: The memory available for adding the vectors is 49.3GB(total available - used by the index)
2025-03-09 10:16:17,698 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/15 [00:00<?, ?it/s]  7%|▋         | 1/15 [00:00<00:02,  5.53it/s] 20%|██        | 3/15 [00:00<00:01,  8.20it/s] 27%|██▋       | 4/15 [00:00<00:01,  8.59it/s] 33%|███▎      | 5/15 [00:00<00:01,  8.92it/s] 40%|████      | 6/15 [00:00<00:00,  9.15it/s] 47%|████▋     | 7/15 [00:00<00:00,  9.36it/s] 53%|█████▎    | 8/15 [00:00<00:00,  9.31it/s] 60%|██████    | 9/15 [00:01<00:00,  9.32it/s] 67%|██████▋   | 10/15 [00:01<00:00,  9.23it/s] 80%|████████  | 12/15 [00:01<00:00,  9.48it/s] 87%|████████▋ | 13/15 [00:01<00:00,  9.23it/s] 93%|█████████▎| 14/15 [00:01<00:00,  9.07it/s]100%|██████████| 15/15 [00:04<00:00,  1.23it/s]100%|██████████| 15/15 [00:04<00:00,  3.53it/s]
2025-03-09 10:16:21,967 [INFO]: 	Computing best hyperparameters for index knn.index 03/09/2025, 10:16:21
2025-03-09 10:16:55,281 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 33.3135 secs
2025-03-09 10:16:55,281 [INFO]: The best hyperparameters are: efSearch=339
2025-03-09 10:16:55,281 [INFO]: 	Compute fast metrics 03/09/2025, 10:16:55
  0%|          | 0/4 [00:00<?, ?it/s] 25%|██▌       | 1/4 [00:00<00:00,  5.57it/s] 50%|█████     | 2/4 [00:00<00:00,  7.28it/s] 75%|███████▌  | 3/4 [00:00<00:00,  8.04it/s] 75%|███████▌  | 3/4 [00:00<00:00,  6.08it/s]
2025-03-09 10:17:11,063 [INFO]: 	>>> Finished "Compute fast metrics" in 15.7816 secs
2025-03-09 10:17:11,066 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 53.3676 secs
2025-03-09 10:17:11,066 [INFO]: {
2025-03-09 10:17:11,066 [INFO]: 	index_key: HNSW15
2025-03-09 10:17:11,066 [INFO]: 	index_param: efSearch=339
2025-03-09 10:17:11,066 [INFO]: 	index_path: knn.index
2025-03-09 10:17:11,066 [INFO]: 	size in bytes: 745856170
2025-03-09 10:17:11,066 [INFO]: 	avg_search_speed_ms: 10.202274195450757
2025-03-09 10:17:11,066 [INFO]: 	99p_search_speed_ms: 14.050948929507289
2025-03-09 10:17:11,066 [INFO]: 	reconstruction error %: 0.0
2025-03-09 10:17:11,066 [INFO]: 	nb vectors: 3791
2025-03-09 10:17:11,066 [INFO]: 	vectors dimension: 49152
2025-03-09 10:17:11,066 [INFO]: 	compression ratio: 0.9993091938892186
2025-03-09 10:17:11,066 [INFO]: }
2025-03-09 10:17:11,066 [INFO]: 	>>> Finished "Creating the index" in 53.3709 secs
2025-03-09 10:17:11,066 [INFO]: >>> Finished "Launching the whole pipeline" in 53.4002 secs
2025-03-09 10:17:12: [retrieval_preprocessing] calculating distances ...
2025-03-09 10:17:12: [retrieval_preprocessing] finished and saved retrieval indices for episode 44181 [episode count 7/20]
[retrieval_preprocessing] for episode 38678 [episode count 8/20], we have num_retrieval=np.int64(3841) num_query=np.int64(131)
2025-03-09 10:17:13,805 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-09 10:17:14,308 [INFO]: Launching the whole pipeline 03/09/2025, 10:17:14
2025-03-09 10:17:14,308 [INFO]: Reading total number of vectors and dimension 03/09/2025, 10:17:14
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1493.70it/s]
2025-03-09 10:17:14,332 [INFO]: There are 3841 embeddings of dim 49152
2025-03-09 10:17:14,332 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0240 secs
2025-03-09 10:17:14,332 [INFO]: 	Compute estimated construction time of the index 03/09/2025, 10:17:14
2025-03-09 10:17:14,332 [INFO]: 		-> Train: 16.7 minutes
2025-03-09 10:17:14,332 [INFO]: 		-> Add: 2.1 seconds
2025-03-09 10:17:14,332 [INFO]: 		Total: 16.7 minutes
2025-03-09 10:17:14,332 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0001 secs
2025-03-09 10:17:14,333 [INFO]: 	Checking that your have enough memory available to create the index 03/09/2025, 10:17:14
2025-03-09 10:17:14,333 [INFO]: 792.7MB of memory will be needed to build the index (more might be used if you have more)
2025-03-09 10:17:14,333 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0001 secs
2025-03-09 10:17:14,333 [INFO]: 	Selecting most promising index types given data characteristics 03/09/2025, 10:17:14
2025-03-09 10:17:14,333 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-09 10:17:14,333 [INFO]: 	Creating the index 03/09/2025, 10:17:14
2025-03-09 10:17:14,333 [INFO]: 		-> Instanciate the index HNSW15 03/09/2025, 10:17:14
2025-03-09 10:17:14,334 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0009 secs
2025-03-09 10:17:14,334 [INFO]: 		-> Adding the vectors to the index 03/09/2025, 10:17:14
2025-03-09 10:17:14,334 [INFO]: The memory available for adding the vectors is 49.3GB(total available - used by the index)
2025-03-09 10:17:14,334 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/16 [00:00<?, ?it/s]  6%|▋         | 1/16 [00:00<00:02,  6.44it/s] 19%|█▉        | 3/16 [00:00<00:01, 11.10it/s] 31%|███▏      | 5/16 [00:00<00:00, 12.30it/s] 44%|████▍     | 7/16 [00:00<00:00, 12.72it/s] 56%|█████▋    | 9/16 [00:01<00:00,  7.00it/s] 69%|██████▉   | 11/16 [00:01<00:00,  8.32it/s] 81%|████████▏ | 13/16 [00:01<00:00,  9.64it/s] 94%|█████████▍| 15/16 [00:01<00:00, 10.69it/s]100%|██████████| 16/16 [00:03<00:00,  4.13it/s]
2025-03-09 10:17:18,208 [INFO]: 	Computing best hyperparameters for index knn.index 03/09/2025, 10:17:18
2025-03-09 10:17:53,014 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 34.8056 secs
2025-03-09 10:17:53,014 [INFO]: The best hyperparameters are: efSearch=325
2025-03-09 10:17:53,014 [INFO]: 	Compute fast metrics 03/09/2025, 10:17:53
  0%|          | 0/4 [00:00<?, ?it/s] 25%|██▌       | 1/4 [00:00<00:00,  6.21it/s] 75%|███████▌  | 3/4 [00:00<00:00, 10.20it/s] 75%|███████▌  | 3/4 [00:00<00:00,  7.78it/s]
2025-03-09 10:18:07,997 [INFO]: 	>>> Finished "Compute fast metrics" in 14.9825 secs
2025-03-09 10:18:07,999 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 53.6650 secs
2025-03-09 10:18:07,999 [INFO]: {
2025-03-09 10:18:07,999 [INFO]: 	index_key: HNSW15
2025-03-09 10:18:07,999 [INFO]: 	index_param: efSearch=325
2025-03-09 10:18:07,999 [INFO]: 	index_path: knn.index
2025-03-09 10:18:07,999 [INFO]: 	size in bytes: 755693590
2025-03-09 10:18:07,999 [INFO]: 	avg_search_speed_ms: 10.091881072956893
2025-03-09 10:18:07,999 [INFO]: 	99p_search_speed_ms: 14.195203455165032
2025-03-09 10:18:07,999 [INFO]: 	reconstruction error %: 0.0
2025-03-09 10:18:07,999 [INFO]: 	nb vectors: 3841
2025-03-09 10:18:07,999 [INFO]: 	vectors dimension: 49152
2025-03-09 10:18:07,999 [INFO]: 	compression ratio: 0.9993088971417635
2025-03-09 10:18:07,999 [INFO]: }
2025-03-09 10:18:07,999 [INFO]: 	>>> Finished "Creating the index" in 53.6664 secs
2025-03-09 10:18:07,999 [INFO]: >>> Finished "Launching the whole pipeline" in 53.6910 secs
2025-03-09 10:18:08: [retrieval_preprocessing] calculating distances ...
2025-03-09 10:18:09: [retrieval_preprocessing] finished and saved retrieval indices for episode 38678 [episode count 8/20]
[retrieval_preprocessing] for episode 68888 [episode count 9/20], we have num_retrieval=np.int64(3788) num_query=np.int64(184)
2025-03-09 10:18:10,285 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-09 10:18:10,770 [INFO]: Launching the whole pipeline 03/09/2025, 10:18:10
2025-03-09 10:18:10,770 [INFO]: Reading total number of vectors and dimension 03/09/2025, 10:18:10
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1374.73it/s]
2025-03-09 10:18:10,794 [INFO]: There are 3788 embeddings of dim 49152
2025-03-09 10:18:10,795 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0241 secs
2025-03-09 10:18:10,795 [INFO]: 	Compute estimated construction time of the index 03/09/2025, 10:18:10
2025-03-09 10:18:10,795 [INFO]: 		-> Train: 16.7 minutes
2025-03-09 10:18:10,795 [INFO]: 		-> Add: 2.1 seconds
2025-03-09 10:18:10,795 [INFO]: 		Total: 16.7 minutes
2025-03-09 10:18:10,795 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0002 secs
2025-03-09 10:18:10,795 [INFO]: 	Checking that your have enough memory available to create the index 03/09/2025, 10:18:10
2025-03-09 10:18:10,795 [INFO]: 781.8MB of memory will be needed to build the index (more might be used if you have more)
2025-03-09 10:18:10,795 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0001 secs
2025-03-09 10:18:10,795 [INFO]: 	Selecting most promising index types given data characteristics 03/09/2025, 10:18:10
2025-03-09 10:18:10,795 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-09 10:18:10,795 [INFO]: 	Creating the index 03/09/2025, 10:18:10
2025-03-09 10:18:10,795 [INFO]: 		-> Instanciate the index HNSW15 03/09/2025, 10:18:10
2025-03-09 10:18:10,796 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0010 secs
2025-03-09 10:18:10,796 [INFO]: 		-> Adding the vectors to the index 03/09/2025, 10:18:10
2025-03-09 10:18:10,796 [INFO]: The memory available for adding the vectors is 49.3GB(total available - used by the index)
2025-03-09 10:18:10,796 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/15 [00:00<?, ?it/s]  7%|▋         | 1/15 [00:00<00:02,  6.19it/s] 13%|█▎        | 2/15 [00:00<00:01,  7.69it/s] 20%|██        | 3/15 [00:00<00:01,  8.30it/s] 27%|██▋       | 4/15 [00:00<00:01,  8.83it/s] 33%|███▎      | 5/15 [00:00<00:01,  9.19it/s] 40%|████      | 6/15 [00:00<00:00,  9.34it/s] 47%|████▋     | 7/15 [00:00<00:00,  9.43it/s] 53%|█████▎    | 8/15 [00:00<00:00,  9.50it/s] 60%|██████    | 9/15 [00:00<00:00,  9.56it/s] 67%|██████▋   | 10/15 [00:01<00:00,  9.68it/s] 73%|███████▎  | 11/15 [00:01<00:00,  9.69it/s] 80%|████████  | 12/15 [00:01<00:00,  9.72it/s] 87%|████████▋ | 13/15 [00:01<00:00,  9.75it/s]100%|██████████| 15/15 [00:03<00:00,  1.58it/s]100%|██████████| 15/15 [00:03<00:00,  3.85it/s]
2025-03-09 10:18:14,701 [INFO]: 	Computing best hyperparameters for index knn.index 03/09/2025, 10:18:14
2025-03-09 10:18:49,090 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 34.3882 secs
2025-03-09 10:18:49,090 [INFO]: The best hyperparameters are: efSearch=381
2025-03-09 10:18:49,090 [INFO]: 	Compute fast metrics 03/09/2025, 10:18:49
  0%|          | 0/4 [00:00<?, ?it/s] 25%|██▌       | 1/4 [00:00<00:00,  8.02it/s] 75%|███████▌  | 3/4 [00:00<00:00, 11.35it/s]
2025-03-09 10:19:01,928 [INFO]: 	>>> Finished "Compute fast metrics" in 12.8377 secs
2025-03-09 10:19:01,930 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 51.1337 secs
2025-03-09 10:19:01,930 [INFO]: {
2025-03-09 10:19:01,930 [INFO]: 	index_key: HNSW15
2025-03-09 10:19:01,930 [INFO]: 	index_param: efSearch=381
2025-03-09 10:19:01,930 [INFO]: 	index_path: knn.index
2025-03-09 10:19:01,930 [INFO]: 	size in bytes: 745265890
2025-03-09 10:19:01,930 [INFO]: 	avg_search_speed_ms: 10.967100601798544
2025-03-09 10:19:01,930 [INFO]: 	99p_search_speed_ms: 15.571164400316773
2025-03-09 10:19:01,930 [INFO]: 	reconstruction error %: 0.0
2025-03-09 10:19:01,930 [INFO]: 	nb vectors: 3788
2025-03-09 10:19:01,930 [INFO]: 	vectors dimension: 49152
2025-03-09 10:19:01,930 [INFO]: 	compression ratio: 0.999309258605677
2025-03-09 10:19:01,930 [INFO]: }
2025-03-09 10:19:01,930 [INFO]: 	>>> Finished "Creating the index" in 51.1351 secs
2025-03-09 10:19:01,930 [INFO]: >>> Finished "Launching the whole pipeline" in 51.1598 secs
2025-03-09 10:19:04: [retrieval_preprocessing] calculating distances ...
2025-03-09 10:19:04: [retrieval_preprocessing] finished and saved retrieval indices for episode 68888 [episode count 9/20]
[retrieval_preprocessing] for episode 92186 [episode count 10/20], we have num_retrieval=np.int64(3817) num_query=np.int64(155)
2025-03-09 10:19:05,244 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-09 10:19:05,705 [INFO]: Launching the whole pipeline 03/09/2025, 10:19:05
2025-03-09 10:19:05,705 [INFO]: Reading total number of vectors and dimension 03/09/2025, 10:19:05
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 2129.09it/s]
2025-03-09 10:19:05,730 [INFO]: There are 3817 embeddings of dim 49152
2025-03-09 10:19:05,730 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0248 secs
2025-03-09 10:19:05,730 [INFO]: 	Compute estimated construction time of the index 03/09/2025, 10:19:05
2025-03-09 10:19:05,730 [INFO]: 		-> Train: 16.7 minutes
2025-03-09 10:19:05,731 [INFO]: 		-> Add: 2.1 seconds
2025-03-09 10:19:05,731 [INFO]: 		Total: 16.7 minutes
2025-03-09 10:19:05,731 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0005 secs
2025-03-09 10:19:05,731 [INFO]: 	Checking that your have enough memory available to create the index 03/09/2025, 10:19:05
2025-03-09 10:19:05,731 [INFO]: 787.7MB of memory will be needed to build the index (more might be used if you have more)
2025-03-09 10:19:05,731 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0003 secs
2025-03-09 10:19:05,731 [INFO]: 	Selecting most promising index types given data characteristics 03/09/2025, 10:19:05
2025-03-09 10:19:05,732 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-09 10:19:05,732 [INFO]: 	Creating the index 03/09/2025, 10:19:05
2025-03-09 10:19:05,732 [INFO]: 		-> Instanciate the index HNSW15 03/09/2025, 10:19:05
2025-03-09 10:19:05,735 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0027 secs
2025-03-09 10:19:05,735 [INFO]: 		-> Adding the vectors to the index 03/09/2025, 10:19:05
2025-03-09 10:19:05,735 [INFO]: The memory available for adding the vectors is 49.3GB(total available - used by the index)
2025-03-09 10:19:05,735 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/16 [00:00<?, ?it/s]  6%|▋         | 1/16 [00:00<00:02,  6.58it/s] 19%|█▉        | 3/16 [00:00<00:01, 11.13it/s] 31%|███▏      | 5/16 [00:00<00:00, 12.56it/s] 44%|████▍     | 7/16 [00:00<00:00, 13.07it/s] 56%|█████▋    | 9/16 [00:00<00:00, 13.10it/s] 69%|██████▉   | 11/16 [00:00<00:00, 13.16it/s] 81%|████████▏ | 13/16 [00:01<00:00, 13.43it/s] 94%|█████████▍| 15/16 [00:01<00:00, 13.40it/s]100%|██████████| 16/16 [00:03<00:00,  4.34it/s]
2025-03-09 10:19:09,424 [INFO]: 	Computing best hyperparameters for index knn.index 03/09/2025, 10:19:09
2025-03-09 10:19:41,325 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 31.9006 secs
2025-03-09 10:19:41,325 [INFO]: The best hyperparameters are: efSearch=365
2025-03-09 10:19:41,325 [INFO]: 	Compute fast metrics 03/09/2025, 10:19:41
  0%|          | 0/4 [00:00<?, ?it/s] 25%|██▌       | 1/4 [00:00<00:00,  5.47it/s] 50%|█████     | 2/4 [00:00<00:00,  7.17it/s] 75%|███████▌  | 3/4 [00:00<00:00,  7.97it/s] 75%|███████▌  | 3/4 [00:00<00:00,  5.99it/s]
2025-03-09 10:19:58,057 [INFO]: 	>>> Finished "Compute fast metrics" in 16.7316 secs
2025-03-09 10:19:58,059 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 52.3244 secs
2025-03-09 10:19:58,059 [INFO]: {
2025-03-09 10:19:58,059 [INFO]: 	index_key: HNSW15
2025-03-09 10:19:58,059 [INFO]: 	index_param: efSearch=365
2025-03-09 10:19:58,060 [INFO]: 	index_path: knn.index
2025-03-09 10:19:58,060 [INFO]: 	size in bytes: 750971590
2025-03-09 10:19:58,060 [INFO]: 	avg_search_speed_ms: 11.999741636609716
2025-03-09 10:19:58,060 [INFO]: 	99p_search_speed_ms: 23.788664385210712
2025-03-09 10:19:58,060 [INFO]: 	reconstruction error %: 0.0
2025-03-09 10:19:58,060 [INFO]: 	nb vectors: 3817
2025-03-09 10:19:58,060 [INFO]: 	vectors dimension: 49152
2025-03-09 10:19:58,060 [INFO]: 	compression ratio: 0.9993090897087066
2025-03-09 10:19:58,060 [INFO]: }
2025-03-09 10:19:58,060 [INFO]: 	>>> Finished "Creating the index" in 52.3282 secs
2025-03-09 10:19:58,060 [INFO]: >>> Finished "Launching the whole pipeline" in 52.3546 secs
2025-03-09 10:20:00: [retrieval_preprocessing] calculating distances ...
2025-03-09 10:20:00: [retrieval_preprocessing] finished and saved retrieval indices for episode 92186 [episode count 10/20]
[retrieval_preprocessing] for episode 14107 [episode count 11/20], we have num_retrieval=np.int64(3774) num_query=np.int64(198)
2025-03-09 10:20:01,469 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-09 10:20:01,947 [INFO]: Launching the whole pipeline 03/09/2025, 10:20:01
2025-03-09 10:20:01,947 [INFO]: Reading total number of vectors and dimension 03/09/2025, 10:20:01
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1769.00it/s]
2025-03-09 10:20:01,972 [INFO]: There are 3774 embeddings of dim 49152
2025-03-09 10:20:01,972 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0249 secs
2025-03-09 10:20:01,972 [INFO]: 	Compute estimated construction time of the index 03/09/2025, 10:20:01
2025-03-09 10:20:01,972 [INFO]: 		-> Train: 16.7 minutes
2025-03-09 10:20:01,972 [INFO]: 		-> Add: 2.1 seconds
2025-03-09 10:20:01,972 [INFO]: 		Total: 16.7 minutes
2025-03-09 10:20:01,972 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0001 secs
2025-03-09 10:20:01,972 [INFO]: 	Checking that your have enough memory available to create the index 03/09/2025, 10:20:01
2025-03-09 10:20:01,972 [INFO]: 778.9MB of memory will be needed to build the index (more might be used if you have more)
2025-03-09 10:20:01,972 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0001 secs
2025-03-09 10:20:01,972 [INFO]: 	Selecting most promising index types given data characteristics 03/09/2025, 10:20:01
2025-03-09 10:20:01,973 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-09 10:20:01,973 [INFO]: 	Creating the index 03/09/2025, 10:20:01
2025-03-09 10:20:01,973 [INFO]: 		-> Instanciate the index HNSW15 03/09/2025, 10:20:01
2025-03-09 10:20:01,974 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0010 secs
2025-03-09 10:20:01,974 [INFO]: 		-> Adding the vectors to the index 03/09/2025, 10:20:01
2025-03-09 10:20:01,974 [INFO]: The memory available for adding the vectors is 49.3GB(total available - used by the index)
2025-03-09 10:20:01,974 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/15 [00:00<?, ?it/s]  7%|▋         | 1/15 [00:00<00:02,  5.63it/s] 20%|██        | 3/15 [00:00<00:01, 10.85it/s] 33%|███▎      | 5/15 [00:00<00:00, 13.70it/s] 47%|████▋     | 7/15 [00:00<00:00, 13.10it/s] 60%|██████    | 9/15 [00:00<00:00, 12.18it/s] 73%|███████▎  | 11/15 [00:00<00:00, 12.72it/s] 87%|████████▋ | 13/15 [00:01<00:00, 12.53it/s]100%|██████████| 15/15 [00:03<00:00,  2.25it/s]100%|██████████| 15/15 [00:03<00:00,  4.30it/s]
2025-03-09 10:20:05,471 [INFO]: 	Computing best hyperparameters for index knn.index 03/09/2025, 10:20:05
2025-03-09 10:20:38,284 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 32.8129 secs
2025-03-09 10:20:38,284 [INFO]: The best hyperparameters are: efSearch=343
2025-03-09 10:20:38,284 [INFO]: 	Compute fast metrics 03/09/2025, 10:20:38
  0%|          | 0/4 [00:00<?, ?it/s] 25%|██▌       | 1/4 [00:00<00:00,  6.31it/s] 75%|███████▌  | 3/4 [00:00<00:00, 10.27it/s] 75%|███████▌  | 3/4 [00:00<00:00,  7.90it/s]
2025-03-09 10:20:51,508 [INFO]: 	>>> Finished "Compute fast metrics" in 13.2235 secs
2025-03-09 10:20:51,510 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 49.5364 secs
2025-03-09 10:20:51,510 [INFO]: {
2025-03-09 10:20:51,510 [INFO]: 	index_key: HNSW15
2025-03-09 10:20:51,510 [INFO]: 	index_param: efSearch=343
2025-03-09 10:20:51,510 [INFO]: 	index_path: knn.index
2025-03-09 10:20:51,510 [INFO]: 	size in bytes: 742511530
2025-03-09 10:20:51,510 [INFO]: 	avg_search_speed_ms: 10.409647478449713
2025-03-09 10:20:51,510 [INFO]: 	99p_search_speed_ms: 14.29182481952011
2025-03-09 10:20:51,510 [INFO]: 	reconstruction error %: 0.0
2025-03-09 10:20:51,510 [INFO]: 	nb vectors: 3774
2025-03-09 10:20:51,510 [INFO]: 	vectors dimension: 49152
2025-03-09 10:20:51,510 [INFO]: 	compression ratio: 0.9993091851381756
2025-03-09 10:20:51,510 [INFO]: }
2025-03-09 10:20:51,510 [INFO]: 	>>> Finished "Creating the index" in 49.5379 secs
2025-03-09 10:20:51,510 [INFO]: >>> Finished "Launching the whole pipeline" in 49.5633 secs
2025-03-09 10:20:53: [retrieval_preprocessing] calculating distances ...
2025-03-09 10:20:54: [retrieval_preprocessing] finished and saved retrieval indices for episode 14107 [episode count 11/20]
[retrieval_preprocessing] for episode 9115 [episode count 12/20], we have num_retrieval=np.int64(3714) num_query=np.int64(258)
2025-03-09 10:20:55,396 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-09 10:20:55,864 [INFO]: Launching the whole pipeline 03/09/2025, 10:20:55
2025-03-09 10:20:55,864 [INFO]: Reading total number of vectors and dimension 03/09/2025, 10:20:55
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 2268.42it/s]
2025-03-09 10:20:55,890 [INFO]: There are 3714 embeddings of dim 49152
2025-03-09 10:20:55,890 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0256 secs
2025-03-09 10:20:55,890 [INFO]: 	Compute estimated construction time of the index 03/09/2025, 10:20:55
2025-03-09 10:20:55,890 [INFO]: 		-> Train: 16.7 minutes
2025-03-09 10:20:55,890 [INFO]: 		-> Add: 2.0 seconds
2025-03-09 10:20:55,890 [INFO]: 		Total: 16.7 minutes
2025-03-09 10:20:55,890 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0003 secs
2025-03-09 10:20:55,891 [INFO]: 	Checking that your have enough memory available to create the index 03/09/2025, 10:20:55
2025-03-09 10:20:55,891 [INFO]: 766.5MB of memory will be needed to build the index (more might be used if you have more)
2025-03-09 10:20:55,891 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0004 secs
2025-03-09 10:20:55,891 [INFO]: 	Selecting most promising index types given data characteristics 03/09/2025, 10:20:55
2025-03-09 10:20:55,891 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-09 10:20:55,891 [INFO]: 	Creating the index 03/09/2025, 10:20:55
2025-03-09 10:20:55,891 [INFO]: 		-> Instanciate the index HNSW15 03/09/2025, 10:20:55
2025-03-09 10:20:55,894 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0027 secs
2025-03-09 10:20:55,894 [INFO]: 		-> Adding the vectors to the index 03/09/2025, 10:20:55
2025-03-09 10:20:55,895 [INFO]: The memory available for adding the vectors is 49.3GB(total available - used by the index)
2025-03-09 10:20:55,895 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/15 [00:00<?, ?it/s]  7%|▋         | 1/15 [00:00<00:02,  6.98it/s] 20%|██        | 3/15 [00:00<00:01, 11.00it/s] 33%|███▎      | 5/15 [00:00<00:00, 12.38it/s] 47%|████▋     | 7/15 [00:00<00:00, 12.77it/s] 60%|██████    | 9/15 [00:00<00:00, 12.92it/s] 73%|███████▎  | 11/15 [00:00<00:00, 13.06it/s] 87%|████████▋ | 13/15 [00:01<00:00, 13.09it/s]100%|██████████| 15/15 [00:03<00:00,  1.91it/s]100%|██████████| 15/15 [00:03<00:00,  3.78it/s]
2025-03-09 10:20:59,870 [INFO]: 	Computing best hyperparameters for index knn.index 03/09/2025, 10:20:59
2025-03-09 10:21:32,556 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 32.6856 secs
2025-03-09 10:21:32,556 [INFO]: The best hyperparameters are: efSearch=341
2025-03-09 10:21:32,556 [INFO]: 	Compute fast metrics 03/09/2025, 10:21:32
  0%|          | 0/4 [00:00<?, ?it/s] 25%|██▌       | 1/4 [00:00<00:00,  6.08it/s] 75%|███████▌  | 3/4 [00:00<00:00, 10.17it/s] 75%|███████▌  | 3/4 [00:00<00:00,  7.81it/s]
2025-03-09 10:21:48,139 [INFO]: 	>>> Finished "Compute fast metrics" in 15.5829 secs
2025-03-09 10:21:48,142 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 52.2470 secs
2025-03-09 10:21:48,142 [INFO]: {
2025-03-09 10:21:48,142 [INFO]: 	index_key: HNSW15
2025-03-09 10:21:48,142 [INFO]: 	index_param: efSearch=341
2025-03-09 10:21:48,142 [INFO]: 	index_path: knn.index
2025-03-09 10:21:48,142 [INFO]: 	size in bytes: 730706710
2025-03-09 10:21:48,142 [INFO]: 	avg_search_speed_ms: 10.081055676217206
2025-03-09 10:21:48,142 [INFO]: 	99p_search_speed_ms: 13.234964124858385
2025-03-09 10:21:48,142 [INFO]: 	reconstruction error %: 0.0
2025-03-09 10:21:48,142 [INFO]: 	nb vectors: 3714
2025-03-09 10:21:48,142 [INFO]: 	vectors dimension: 49152
2025-03-09 10:21:48,142 [INFO]: 	compression ratio: 0.9993094383928677
2025-03-09 10:21:48,142 [INFO]: }
2025-03-09 10:21:48,142 [INFO]: 	>>> Finished "Creating the index" in 52.2504 secs
2025-03-09 10:21:48,142 [INFO]: >>> Finished "Launching the whole pipeline" in 52.2777 secs
2025-03-09 10:21:50: [retrieval_preprocessing] calculating distances ...
2025-03-09 10:21:51: [retrieval_preprocessing] finished and saved retrieval indices for episode 9115 [episode count 12/20]
[retrieval_preprocessing] for episode 25501 [episode count 13/20], we have num_retrieval=np.int64(3787) num_query=np.int64(185)
2025-03-09 10:21:53,011 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-09 10:21:53,496 [INFO]: Launching the whole pipeline 03/09/2025, 10:21:53
2025-03-09 10:21:53,496 [INFO]: Reading total number of vectors and dimension 03/09/2025, 10:21:53
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1483.66it/s]
2025-03-09 10:21:53,522 [INFO]: There are 3787 embeddings of dim 49152
2025-03-09 10:21:53,523 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0261 secs
2025-03-09 10:21:53,523 [INFO]: 	Compute estimated construction time of the index 03/09/2025, 10:21:53
2025-03-09 10:21:53,523 [INFO]: 		-> Train: 16.7 minutes
2025-03-09 10:21:53,523 [INFO]: 		-> Add: 2.1 seconds
2025-03-09 10:21:53,523 [INFO]: 		Total: 16.7 minutes
2025-03-09 10:21:53,523 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0001 secs
2025-03-09 10:21:53,523 [INFO]: 	Checking that your have enough memory available to create the index 03/09/2025, 10:21:53
2025-03-09 10:21:53,523 [INFO]: 781.5MB of memory will be needed to build the index (more might be used if you have more)
2025-03-09 10:21:53,523 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0001 secs
2025-03-09 10:21:53,523 [INFO]: 	Selecting most promising index types given data characteristics 03/09/2025, 10:21:53
2025-03-09 10:21:53,523 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-09 10:21:53,523 [INFO]: 	Creating the index 03/09/2025, 10:21:53
2025-03-09 10:21:53,523 [INFO]: 		-> Instanciate the index HNSW15 03/09/2025, 10:21:53
2025-03-09 10:21:53,524 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0009 secs
2025-03-09 10:21:53,524 [INFO]: 		-> Adding the vectors to the index 03/09/2025, 10:21:53
2025-03-09 10:21:53,524 [INFO]: The memory available for adding the vectors is 49.3GB(total available - used by the index)
2025-03-09 10:21:53,524 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/15 [00:00<?, ?it/s]  7%|▋         | 1/15 [00:00<00:02,  6.04it/s] 20%|██        | 3/15 [00:00<00:01, 10.59it/s] 33%|███▎      | 5/15 [00:00<00:00, 12.09it/s] 47%|████▋     | 7/15 [00:00<00:00, 12.88it/s] 60%|██████    | 9/15 [00:00<00:00, 13.02it/s] 73%|███████▎  | 11/15 [00:00<00:00, 13.18it/s] 87%|████████▋ | 13/15 [00:01<00:00, 13.30it/s]100%|██████████| 15/15 [00:03<00:00,  2.19it/s]100%|██████████| 15/15 [00:03<00:00,  4.23it/s]
2025-03-09 10:21:57,083 [INFO]: 	Computing best hyperparameters for index knn.index 03/09/2025, 10:21:57
2025-03-09 10:22:30,642 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 33.5586 secs
2025-03-09 10:22:30,642 [INFO]: The best hyperparameters are: efSearch=350
2025-03-09 10:22:30,642 [INFO]: 	Compute fast metrics 03/09/2025, 10:22:30
  0%|          | 0/4 [00:00<?, ?it/s] 25%|██▌       | 1/4 [00:00<00:00,  5.43it/s] 50%|█████     | 2/4 [00:00<00:00,  7.15it/s] 75%|███████▌  | 3/4 [00:00<00:00,  7.99it/s] 75%|███████▌  | 3/4 [00:00<00:00,  6.04it/s]
2025-03-09 10:22:46,416 [INFO]: 	>>> Finished "Compute fast metrics" in 15.7739 secs
2025-03-09 10:22:46,419 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 52.8950 secs
2025-03-09 10:22:46,419 [INFO]: {
2025-03-09 10:22:46,419 [INFO]: 	index_key: HNSW15
2025-03-09 10:22:46,419 [INFO]: 	index_param: efSearch=350
2025-03-09 10:22:46,419 [INFO]: 	index_path: knn.index
2025-03-09 10:22:46,419 [INFO]: 	size in bytes: 745069150
2025-03-09 10:22:46,419 [INFO]: 	avg_search_speed_ms: 10.803267483189138
2025-03-09 10:22:46,419 [INFO]: 	99p_search_speed_ms: 14.333845756482333
2025-03-09 10:22:46,419 [INFO]: 	reconstruction error %: 0.0
2025-03-09 10:22:46,419 [INFO]: 	nb vectors: 3787
2025-03-09 10:22:46,419 [INFO]: 	vectors dimension: 49152
2025-03-09 10:22:46,419 [INFO]: 	compression ratio: 0.9993092533760122
2025-03-09 10:22:46,419 [INFO]: }
2025-03-09 10:22:46,419 [INFO]: 	>>> Finished "Creating the index" in 52.8963 secs
2025-03-09 10:22:46,419 [INFO]: >>> Finished "Launching the whole pipeline" in 52.9230 secs
2025-03-09 10:22:48: [retrieval_preprocessing] calculating distances ...
2025-03-09 10:22:49: [retrieval_preprocessing] finished and saved retrieval indices for episode 25501 [episode count 13/20]
[retrieval_preprocessing] for episode 49307 [episode count 14/20], we have num_retrieval=np.int64(3817) num_query=np.int64(155)
2025-03-09 10:22:50,226 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-09 10:22:50,745 [INFO]: Launching the whole pipeline 03/09/2025, 10:22:50
2025-03-09 10:22:50,745 [INFO]: Reading total number of vectors and dimension 03/09/2025, 10:22:50
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1212.23it/s]
2025-03-09 10:22:50,770 [INFO]: There are 3817 embeddings of dim 49152
2025-03-09 10:22:50,770 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0254 secs
2025-03-09 10:22:50,770 [INFO]: 	Compute estimated construction time of the index 03/09/2025, 10:22:50
2025-03-09 10:22:50,770 [INFO]: 		-> Train: 16.7 minutes
2025-03-09 10:22:50,770 [INFO]: 		-> Add: 2.1 seconds
2025-03-09 10:22:50,770 [INFO]: 		Total: 16.7 minutes
2025-03-09 10:22:50,770 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0001 secs
2025-03-09 10:22:50,770 [INFO]: 	Checking that your have enough memory available to create the index 03/09/2025, 10:22:50
2025-03-09 10:22:50,770 [INFO]: 787.7MB of memory will be needed to build the index (more might be used if you have more)
2025-03-09 10:22:50,770 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0002 secs
2025-03-09 10:22:50,771 [INFO]: 	Selecting most promising index types given data characteristics 03/09/2025, 10:22:50
2025-03-09 10:22:50,771 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-09 10:22:50,771 [INFO]: 	Creating the index 03/09/2025, 10:22:50
2025-03-09 10:22:50,771 [INFO]: 		-> Instanciate the index HNSW15 03/09/2025, 10:22:50
2025-03-09 10:22:50,772 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0011 secs
2025-03-09 10:22:50,772 [INFO]: 		-> Adding the vectors to the index 03/09/2025, 10:22:50
2025-03-09 10:22:50,772 [INFO]: The memory available for adding the vectors is 49.3GB(total available - used by the index)
2025-03-09 10:22:50,772 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/16 [00:00<?, ?it/s]  6%|▋         | 1/16 [00:00<00:02,  5.02it/s] 12%|█▎        | 2/16 [00:00<00:02,  6.72it/s] 19%|█▉        | 3/16 [00:00<00:01,  7.42it/s] 25%|██▌       | 4/16 [00:00<00:01,  7.73it/s] 31%|███▏      | 5/16 [00:00<00:01,  8.07it/s] 38%|███▊      | 6/16 [00:00<00:01,  8.30it/s] 44%|████▍     | 7/16 [00:00<00:01,  8.58it/s] 50%|█████     | 8/16 [00:01<00:00,  8.62it/s] 56%|█████▋    | 9/16 [00:01<00:00,  8.62it/s] 62%|██████▎   | 10/16 [00:01<00:00,  8.66it/s] 69%|██████▉   | 11/16 [00:01<00:00,  8.67it/s] 75%|███████▌  | 12/16 [00:01<00:00,  8.71it/s] 81%|████████▏ | 13/16 [00:01<00:00,  8.49it/s] 94%|█████████▍| 15/16 [00:01<00:00,  9.79it/s]100%|██████████| 16/16 [00:04<00:00,  1.36it/s]100%|██████████| 16/16 [00:04<00:00,  3.63it/s]
2025-03-09 10:22:55,179 [INFO]: 	Computing best hyperparameters for index knn.index 03/09/2025, 10:22:55
2025-03-09 10:23:27,133 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 31.9529 secs
2025-03-09 10:23:27,133 [INFO]: The best hyperparameters are: efSearch=320
2025-03-09 10:23:27,133 [INFO]: 	Compute fast metrics 03/09/2025, 10:23:27
  0%|          | 0/4 [00:00<?, ?it/s] 25%|██▌       | 1/4 [00:00<00:00,  6.03it/s] 75%|███████▌  | 3/4 [00:00<00:00, 10.27it/s] 75%|███████▌  | 3/4 [00:00<00:00,  7.90it/s]
2025-03-09 10:23:40,897 [INFO]: 	>>> Finished "Compute fast metrics" in 13.7639 secs
2025-03-09 10:23:40,900 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 50.1276 secs
2025-03-09 10:23:40,900 [INFO]: {
2025-03-09 10:23:40,900 [INFO]: 	index_key: HNSW15
2025-03-09 10:23:40,900 [INFO]: 	index_param: efSearch=320
2025-03-09 10:23:40,900 [INFO]: 	index_path: knn.index
2025-03-09 10:23:40,900 [INFO]: 	size in bytes: 750971590
2025-03-09 10:23:40,900 [INFO]: 	avg_search_speed_ms: 10.164059727212292
2025-03-09 10:23:40,900 [INFO]: 	99p_search_speed_ms: 13.848525597713888
2025-03-09 10:23:40,900 [INFO]: 	reconstruction error %: 0.0
2025-03-09 10:23:40,900 [INFO]: 	nb vectors: 3817
2025-03-09 10:23:40,900 [INFO]: 	vectors dimension: 49152
2025-03-09 10:23:40,900 [INFO]: 	compression ratio: 0.9993090897087066
2025-03-09 10:23:40,900 [INFO]: }
2025-03-09 10:23:40,900 [INFO]: 	>>> Finished "Creating the index" in 50.1293 secs
2025-03-09 10:23:40,900 [INFO]: >>> Finished "Launching the whole pipeline" in 50.1554 secs
2025-03-09 10:23:41: [retrieval_preprocessing] calculating distances ...
2025-03-09 10:23:42: [retrieval_preprocessing] finished and saved retrieval indices for episode 49307 [episode count 14/20]
[retrieval_preprocessing] for episode 65055 [episode count 15/20], we have num_retrieval=np.int64(3769) num_query=np.int64(203)
2025-03-09 10:23:43,617 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-09 10:23:44,181 [INFO]: Launching the whole pipeline 03/09/2025, 10:23:44
2025-03-09 10:23:44,181 [INFO]: Reading total number of vectors and dimension 03/09/2025, 10:23:44
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1477.39it/s]
2025-03-09 10:23:44,206 [INFO]: There are 3769 embeddings of dim 49152
2025-03-09 10:23:44,206 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0245 secs
2025-03-09 10:23:44,206 [INFO]: 	Compute estimated construction time of the index 03/09/2025, 10:23:44
2025-03-09 10:23:44,206 [INFO]: 		-> Train: 16.7 minutes
2025-03-09 10:23:44,206 [INFO]: 		-> Add: 2.1 seconds
2025-03-09 10:23:44,206 [INFO]: 		Total: 16.7 minutes
2025-03-09 10:23:44,206 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0001 secs
2025-03-09 10:23:44,206 [INFO]: 	Checking that your have enough memory available to create the index 03/09/2025, 10:23:44
2025-03-09 10:23:44,206 [INFO]: 777.8MB of memory will be needed to build the index (more might be used if you have more)
2025-03-09 10:23:44,206 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0001 secs
2025-03-09 10:23:44,206 [INFO]: 	Selecting most promising index types given data characteristics 03/09/2025, 10:23:44
2025-03-09 10:23:44,206 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-09 10:23:44,206 [INFO]: 	Creating the index 03/09/2025, 10:23:44
2025-03-09 10:23:44,206 [INFO]: 		-> Instanciate the index HNSW15 03/09/2025, 10:23:44
2025-03-09 10:23:44,207 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0010 secs
2025-03-09 10:23:44,207 [INFO]: 		-> Adding the vectors to the index 03/09/2025, 10:23:44
2025-03-09 10:23:44,208 [INFO]: The memory available for adding the vectors is 49.3GB(total available - used by the index)
2025-03-09 10:23:44,208 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/15 [00:00<?, ?it/s]  7%|▋         | 1/15 [00:00<00:02,  6.60it/s] 20%|██        | 3/15 [00:00<00:01, 10.20it/s] 33%|███▎      | 5/15 [00:00<00:00, 11.63it/s] 47%|████▋     | 7/15 [00:00<00:00, 12.18it/s] 60%|██████    | 9/15 [00:00<00:00, 12.66it/s] 73%|███████▎  | 11/15 [00:00<00:00, 12.80it/s] 87%|████████▋ | 13/15 [00:01<00:00, 12.88it/s]100%|██████████| 15/15 [00:03<00:00,  2.23it/s]100%|██████████| 15/15 [00:03<00:00,  4.25it/s]
2025-03-09 10:23:47,742 [INFO]: 	Computing best hyperparameters for index knn.index 03/09/2025, 10:23:47
2025-03-09 10:24:21,953 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 34.2110 secs
2025-03-09 10:24:21,953 [INFO]: The best hyperparameters are: efSearch=335
2025-03-09 10:24:21,953 [INFO]: 	Compute fast metrics 03/09/2025, 10:24:21
  0%|          | 0/4 [00:00<?, ?it/s] 25%|██▌       | 1/4 [00:00<00:00,  5.38it/s] 50%|█████     | 2/4 [00:00<00:00,  7.07it/s] 75%|███████▌  | 3/4 [00:00<00:00,  7.66it/s] 75%|███████▌  | 3/4 [00:00<00:00,  5.64it/s]
2025-03-09 10:24:38,789 [INFO]: 	>>> Finished "Compute fast metrics" in 16.8355 secs
2025-03-09 10:24:38,792 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 54.5845 secs
2025-03-09 10:24:38,792 [INFO]: {
2025-03-09 10:24:38,792 [INFO]: 	index_key: HNSW15
2025-03-09 10:24:38,792 [INFO]: 	index_param: efSearch=335
2025-03-09 10:24:38,792 [INFO]: 	index_path: knn.index
2025-03-09 10:24:38,792 [INFO]: 	size in bytes: 741527830
2025-03-09 10:24:38,792 [INFO]: 	avg_search_speed_ms: 10.271368403412264
2025-03-09 10:24:38,792 [INFO]: 	99p_search_speed_ms: 15.365791702643037
2025-03-09 10:24:38,792 [INFO]: 	reconstruction error %: 0.0
2025-03-09 10:24:38,792 [INFO]: 	nb vectors: 3769
2025-03-09 10:24:38,792 [INFO]: 	vectors dimension: 49152
2025-03-09 10:24:38,792 [INFO]: 	compression ratio: 0.9993091587675138
2025-03-09 10:24:38,792 [INFO]: }
2025-03-09 10:24:38,792 [INFO]: 	>>> Finished "Creating the index" in 54.5861 secs
2025-03-09 10:24:38,792 [INFO]: >>> Finished "Launching the whole pipeline" in 54.6112 secs
2025-03-09 10:24:40: [retrieval_preprocessing] calculating distances ...
2025-03-09 10:24:40: [retrieval_preprocessing] finished and saved retrieval indices for episode 65055 [episode count 15/20]
[retrieval_preprocessing] for episode 39202 [episode count 16/20], we have num_retrieval=np.int64(3787) num_query=np.int64(185)
2025-03-09 10:24:41,822 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-09 10:24:42,345 [INFO]: Launching the whole pipeline 03/09/2025, 10:24:42
2025-03-09 10:24:42,345 [INFO]: Reading total number of vectors and dimension 03/09/2025, 10:24:42
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1408.90it/s]
2025-03-09 10:24:42,370 [INFO]: There are 3787 embeddings of dim 49152
2025-03-09 10:24:42,371 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0257 secs
2025-03-09 10:24:42,371 [INFO]: 	Compute estimated construction time of the index 03/09/2025, 10:24:42
2025-03-09 10:24:42,371 [INFO]: 		-> Train: 16.7 minutes
2025-03-09 10:24:42,371 [INFO]: 		-> Add: 2.1 seconds
2025-03-09 10:24:42,371 [INFO]: 		Total: 16.7 minutes
2025-03-09 10:24:42,371 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0001 secs
2025-03-09 10:24:42,371 [INFO]: 	Checking that your have enough memory available to create the index 03/09/2025, 10:24:42
2025-03-09 10:24:42,371 [INFO]: 781.5MB of memory will be needed to build the index (more might be used if you have more)
2025-03-09 10:24:42,371 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0002 secs
2025-03-09 10:24:42,371 [INFO]: 	Selecting most promising index types given data characteristics 03/09/2025, 10:24:42
2025-03-09 10:24:42,371 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-09 10:24:42,371 [INFO]: 	Creating the index 03/09/2025, 10:24:42
2025-03-09 10:24:42,371 [INFO]: 		-> Instanciate the index HNSW15 03/09/2025, 10:24:42
2025-03-09 10:24:42,373 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0011 secs
2025-03-09 10:24:42,373 [INFO]: 		-> Adding the vectors to the index 03/09/2025, 10:24:42
2025-03-09 10:24:42,373 [INFO]: The memory available for adding the vectors is 49.3GB(total available - used by the index)
2025-03-09 10:24:42,373 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/15 [00:00<?, ?it/s]  7%|▋         | 1/15 [00:00<00:02,  5.84it/s] 20%|██        | 3/15 [00:00<00:01,  9.64it/s] 33%|███▎      | 5/15 [00:00<00:00, 11.02it/s] 47%|████▋     | 7/15 [00:00<00:00, 11.55it/s] 60%|██████    | 9/15 [00:00<00:00, 11.63it/s] 73%|███████▎  | 11/15 [00:00<00:00, 11.93it/s] 87%|████████▋ | 13/15 [00:01<00:00, 12.09it/s]100%|██████████| 15/15 [00:03<00:00,  2.23it/s]100%|██████████| 15/15 [00:03<00:00,  4.20it/s]
2025-03-09 10:24:45,952 [INFO]: 	Computing best hyperparameters for index knn.index 03/09/2025, 10:24:45
2025-03-09 10:25:19,226 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 33.2733 secs
2025-03-09 10:25:19,226 [INFO]: The best hyperparameters are: efSearch=333
2025-03-09 10:25:19,226 [INFO]: 	Compute fast metrics 03/09/2025, 10:25:19
  0%|          | 0/4 [00:00<?, ?it/s] 25%|██▌       | 1/4 [00:00<00:00,  5.79it/s] 50%|█████     | 2/4 [00:00<00:00,  7.43it/s] 75%|███████▌  | 3/4 [00:00<00:00,  8.15it/s] 75%|███████▌  | 3/4 [00:00<00:00,  6.15it/s]
2025-03-09 10:25:36,556 [INFO]: 	>>> Finished "Compute fast metrics" in 17.3300 secs
2025-03-09 10:25:36,559 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 54.1861 secs
2025-03-09 10:25:36,559 [INFO]: {
2025-03-09 10:25:36,559 [INFO]: 	index_key: HNSW15
2025-03-09 10:25:36,559 [INFO]: 	index_param: efSearch=333
2025-03-09 10:25:36,559 [INFO]: 	index_path: knn.index
2025-03-09 10:25:36,559 [INFO]: 	size in bytes: 745069150
2025-03-09 10:25:36,559 [INFO]: 	avg_search_speed_ms: 9.781099757937799
2025-03-09 10:25:36,559 [INFO]: 	99p_search_speed_ms: 13.258382531348612
2025-03-09 10:25:36,559 [INFO]: 	reconstruction error %: 0.0
2025-03-09 10:25:36,559 [INFO]: 	nb vectors: 3787
2025-03-09 10:25:36,559 [INFO]: 	vectors dimension: 49152
2025-03-09 10:25:36,559 [INFO]: 	compression ratio: 0.9993092533760122
2025-03-09 10:25:36,559 [INFO]: }
2025-03-09 10:25:36,559 [INFO]: 	>>> Finished "Creating the index" in 54.1877 secs
2025-03-09 10:25:36,559 [INFO]: >>> Finished "Launching the whole pipeline" in 54.2142 secs
2025-03-09 10:25:37: [retrieval_preprocessing] calculating distances ...
2025-03-09 10:25:38: [retrieval_preprocessing] finished and saved retrieval indices for episode 39202 [episode count 16/20]
[retrieval_preprocessing] for episode 53542 [episode count 17/20], we have num_retrieval=np.int64(3708) num_query=np.int64(264)
2025-03-09 10:25:39,443 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-09 10:25:39,911 [INFO]: Launching the whole pipeline 03/09/2025, 10:25:39
2025-03-09 10:25:39,911 [INFO]: Reading total number of vectors and dimension 03/09/2025, 10:25:39
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1550.57it/s]
2025-03-09 10:25:39,936 [INFO]: There are 3708 embeddings of dim 49152
2025-03-09 10:25:39,937 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0253 secs
2025-03-09 10:25:39,937 [INFO]: 	Compute estimated construction time of the index 03/09/2025, 10:25:39
2025-03-09 10:25:39,937 [INFO]: 		-> Train: 16.7 minutes
2025-03-09 10:25:39,937 [INFO]: 		-> Add: 2.0 seconds
2025-03-09 10:25:39,937 [INFO]: 		Total: 16.7 minutes
2025-03-09 10:25:39,937 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0001 secs
2025-03-09 10:25:39,937 [INFO]: 	Checking that your have enough memory available to create the index 03/09/2025, 10:25:39
2025-03-09 10:25:39,937 [INFO]: 765.2MB of memory will be needed to build the index (more might be used if you have more)
2025-03-09 10:25:39,937 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0001 secs
2025-03-09 10:25:39,937 [INFO]: 	Selecting most promising index types given data characteristics 03/09/2025, 10:25:39
2025-03-09 10:25:39,937 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-09 10:25:39,937 [INFO]: 	Creating the index 03/09/2025, 10:25:39
2025-03-09 10:25:39,937 [INFO]: 		-> Instanciate the index HNSW15 03/09/2025, 10:25:39
2025-03-09 10:25:39,938 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0008 secs
2025-03-09 10:25:39,938 [INFO]: 		-> Adding the vectors to the index 03/09/2025, 10:25:39
2025-03-09 10:25:39,938 [INFO]: The memory available for adding the vectors is 49.3GB(total available - used by the index)
2025-03-09 10:25:39,938 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/15 [00:00<?, ?it/s]  7%|▋         | 1/15 [00:00<00:01,  7.59it/s] 20%|██        | 3/15 [00:00<00:00, 12.46it/s] 33%|███▎      | 5/15 [00:00<00:00, 11.02it/s] 47%|████▋     | 7/15 [00:00<00:00, 10.40it/s] 67%|██████▋   | 10/15 [00:00<00:00, 15.04it/s]100%|██████████| 15/15 [00:03<00:00,  3.54it/s]100%|██████████| 15/15 [00:03<00:00,  4.79it/s]
2025-03-09 10:25:43,071 [INFO]: 	Computing best hyperparameters for index knn.index 03/09/2025, 10:25:43
2025-03-09 10:26:16,998 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 33.9264 secs
2025-03-09 10:26:16,998 [INFO]: The best hyperparameters are: efSearch=354
2025-03-09 10:26:16,998 [INFO]: 	Compute fast metrics 03/09/2025, 10:26:16
  0%|          | 0/4 [00:00<?, ?it/s] 25%|██▌       | 1/4 [00:00<00:00,  6.44it/s] 75%|███████▌  | 3/4 [00:00<00:00,  9.84it/s] 75%|███████▌  | 3/4 [00:00<00:00,  7.61it/s]
2025-03-09 10:26:33,812 [INFO]: 	>>> Finished "Compute fast metrics" in 16.8140 secs
2025-03-09 10:26:33,814 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 53.8759 secs
2025-03-09 10:26:33,814 [INFO]: {
2025-03-09 10:26:33,814 [INFO]: 	index_key: HNSW15
2025-03-09 10:26:33,814 [INFO]: 	index_param: efSearch=354
2025-03-09 10:26:33,814 [INFO]: 	index_path: knn.index
2025-03-09 10:26:33,814 [INFO]: 	size in bytes: 729526210
2025-03-09 10:26:33,814 [INFO]: 	avg_search_speed_ms: 10.696363759620544
2025-03-09 10:26:33,814 [INFO]: 	99p_search_speed_ms: 14.352443423122166
2025-03-09 10:26:33,814 [INFO]: 	reconstruction error %: 0.0
2025-03-09 10:26:33,814 [INFO]: 	nb vectors: 3708
2025-03-09 10:26:33,814 [INFO]: 	vectors dimension: 49152
2025-03-09 10:26:33,814 [INFO]: 	compression ratio: 0.9993094888256311
2025-03-09 10:26:33,814 [INFO]: }
2025-03-09 10:26:33,814 [INFO]: 	>>> Finished "Creating the index" in 53.8771 secs
2025-03-09 10:26:33,814 [INFO]: >>> Finished "Launching the whole pipeline" in 53.9029 secs
2025-03-09 10:26:36: [retrieval_preprocessing] calculating distances ...
2025-03-09 10:26:37: [retrieval_preprocessing] finished and saved retrieval indices for episode 53542 [episode count 17/20]
[retrieval_preprocessing] for episode 92843 [episode count 18/20], we have num_retrieval=np.int64(3798) num_query=np.int64(174)
2025-03-09 10:26:38,438 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-09 10:26:38,898 [INFO]: Launching the whole pipeline 03/09/2025, 10:26:38
2025-03-09 10:26:38,898 [INFO]: Reading total number of vectors and dimension 03/09/2025, 10:26:38
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 2296.99it/s]
2025-03-09 10:26:38,922 [INFO]: There are 3798 embeddings of dim 49152
2025-03-09 10:26:38,922 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0239 secs
2025-03-09 10:26:38,922 [INFO]: 	Compute estimated construction time of the index 03/09/2025, 10:26:38
2025-03-09 10:26:38,922 [INFO]: 		-> Train: 16.7 minutes
2025-03-09 10:26:38,922 [INFO]: 		-> Add: 2.1 seconds
2025-03-09 10:26:38,922 [INFO]: 		Total: 16.7 minutes
2025-03-09 10:26:38,922 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0001 secs
2025-03-09 10:26:38,922 [INFO]: 	Checking that your have enough memory available to create the index 03/09/2025, 10:26:38
2025-03-09 10:26:38,922 [INFO]: 783.8MB of memory will be needed to build the index (more might be used if you have more)
2025-03-09 10:26:38,922 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0001 secs
2025-03-09 10:26:38,922 [INFO]: 	Selecting most promising index types given data characteristics 03/09/2025, 10:26:38
2025-03-09 10:26:38,922 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-09 10:26:38,923 [INFO]: 	Creating the index 03/09/2025, 10:26:38
2025-03-09 10:26:38,923 [INFO]: 		-> Instanciate the index HNSW15 03/09/2025, 10:26:38
2025-03-09 10:26:38,923 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0009 secs
2025-03-09 10:26:38,924 [INFO]: 		-> Adding the vectors to the index 03/09/2025, 10:26:38
2025-03-09 10:26:38,924 [INFO]: The memory available for adding the vectors is 49.3GB(total available - used by the index)
2025-03-09 10:26:38,924 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/15 [00:00<?, ?it/s]  7%|▋         | 1/15 [00:00<00:02,  5.33it/s] 13%|█▎        | 2/15 [00:00<00:01,  7.21it/s] 20%|██        | 3/15 [00:00<00:01,  7.99it/s] 27%|██▋       | 4/15 [00:00<00:01,  8.40it/s] 33%|███▎      | 5/15 [00:00<00:01,  8.57it/s] 40%|████      | 6/15 [00:00<00:01,  8.67it/s] 47%|████▋     | 7/15 [00:00<00:00,  8.83it/s] 53%|█████▎    | 8/15 [00:00<00:00,  8.79it/s] 60%|██████    | 9/15 [00:01<00:00,  8.73it/s] 67%|██████▋   | 10/15 [00:01<00:00,  8.70it/s] 73%|███████▎  | 11/15 [00:01<00:00,  8.65it/s] 80%|████████  | 12/15 [00:01<00:00,  8.63it/s] 87%|████████▋ | 13/15 [00:01<00:00,  8.74it/s] 93%|█████████▎| 14/15 [00:01<00:00,  8.70it/s]100%|██████████| 15/15 [00:04<00:00,  1.19it/s]100%|██████████| 15/15 [00:04<00:00,  3.60it/s]
2025-03-09 10:26:43,099 [INFO]: 	Computing best hyperparameters for index knn.index 03/09/2025, 10:26:43
2025-03-09 10:27:16,336 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 33.2359 secs
2025-03-09 10:27:16,336 [INFO]: The best hyperparameters are: efSearch=349
2025-03-09 10:27:16,336 [INFO]: 	Compute fast metrics 03/09/2025, 10:27:16
  0%|          | 0/4 [00:00<?, ?it/s] 25%|██▌       | 1/4 [00:00<00:00,  5.48it/s] 50%|█████     | 2/4 [00:00<00:00,  7.24it/s] 75%|███████▌  | 3/4 [00:00<00:00,  7.99it/s] 75%|███████▌  | 3/4 [00:00<00:00,  6.03it/s]
2025-03-09 10:27:32,628 [INFO]: 	>>> Finished "Compute fast metrics" in 16.2921 secs
2025-03-09 10:27:32,631 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 53.7070 secs
2025-03-09 10:27:32,631 [INFO]: {
2025-03-09 10:27:32,631 [INFO]: 	index_key: HNSW15
2025-03-09 10:27:32,631 [INFO]: 	index_param: efSearch=349
2025-03-09 10:27:32,631 [INFO]: 	index_path: knn.index
2025-03-09 10:27:32,631 [INFO]: 	size in bytes: 747233350
2025-03-09 10:27:32,631 [INFO]: 	avg_search_speed_ms: 10.50363651583433
2025-03-09 10:27:32,631 [INFO]: 	99p_search_speed_ms: 15.91572150355205
2025-03-09 10:27:32,631 [INFO]: 	reconstruction error %: 0.0
2025-03-09 10:27:32,631 [INFO]: 	nb vectors: 3798
2025-03-09 10:27:32,631 [INFO]: 	vectors dimension: 49152
2025-03-09 10:27:32,631 [INFO]: 	compression ratio: 0.9993092305101211
2025-03-09 10:27:32,631 [INFO]: }
2025-03-09 10:27:32,631 [INFO]: 	>>> Finished "Creating the index" in 53.7085 secs
2025-03-09 10:27:32,631 [INFO]: >>> Finished "Launching the whole pipeline" in 53.7330 secs
2025-03-09 10:27:34: [retrieval_preprocessing] calculating distances ...
2025-03-09 10:27:35: [retrieval_preprocessing] finished and saved retrieval indices for episode 92843 [episode count 18/20]
[retrieval_preprocessing] for episode 50737 [episode count 19/20], we have num_retrieval=np.int64(3693) num_query=np.int64(279)
2025-03-09 10:27:36,643 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-09 10:27:37,106 [INFO]: Launching the whole pipeline 03/09/2025, 10:27:37
2025-03-09 10:27:37,106 [INFO]: Reading total number of vectors and dimension 03/09/2025, 10:27:37
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 2070.24it/s]
2025-03-09 10:27:37,130 [INFO]: There are 3693 embeddings of dim 49152
2025-03-09 10:27:37,130 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0240 secs
2025-03-09 10:27:37,130 [INFO]: 	Compute estimated construction time of the index 03/09/2025, 10:27:37
2025-03-09 10:27:37,130 [INFO]: 		-> Train: 16.7 minutes
2025-03-09 10:27:37,130 [INFO]: 		-> Add: 2.0 seconds
2025-03-09 10:27:37,130 [INFO]: 		Total: 16.7 minutes
2025-03-09 10:27:37,130 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0001 secs
2025-03-09 10:27:37,130 [INFO]: 	Checking that your have enough memory available to create the index 03/09/2025, 10:27:37
2025-03-09 10:27:37,130 [INFO]: 762.1MB of memory will be needed to build the index (more might be used if you have more)
2025-03-09 10:27:37,130 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0001 secs
2025-03-09 10:27:37,130 [INFO]: 	Selecting most promising index types given data characteristics 03/09/2025, 10:27:37
2025-03-09 10:27:37,131 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-09 10:27:37,131 [INFO]: 	Creating the index 03/09/2025, 10:27:37
2025-03-09 10:27:37,131 [INFO]: 		-> Instanciate the index HNSW15 03/09/2025, 10:27:37
2025-03-09 10:27:37,132 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0010 secs
2025-03-09 10:27:37,132 [INFO]: 		-> Adding the vectors to the index 03/09/2025, 10:27:37
2025-03-09 10:27:37,132 [INFO]: The memory available for adding the vectors is 49.3GB(total available - used by the index)
2025-03-09 10:27:37,132 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/15 [00:00<?, ?it/s]  7%|▋         | 1/15 [00:00<00:02,  5.07it/s] 13%|█▎        | 2/15 [00:00<00:01,  6.88it/s] 20%|██        | 3/15 [00:00<00:01,  7.81it/s] 27%|██▋       | 4/15 [00:00<00:01,  8.30it/s] 33%|███▎      | 5/15 [00:00<00:01,  8.72it/s] 40%|████      | 6/15 [00:00<00:01,  8.88it/s] 47%|████▋     | 7/15 [00:00<00:00,  8.94it/s] 53%|█████▎    | 8/15 [00:00<00:00,  9.04it/s] 60%|██████    | 9/15 [00:01<00:00,  9.10it/s] 67%|██████▋   | 10/15 [00:01<00:00,  9.24it/s] 73%|███████▎  | 11/15 [00:01<00:00,  9.19it/s] 80%|████████  | 12/15 [00:01<00:00,  8.69it/s] 87%|████████▋ | 13/15 [00:01<00:00,  8.51it/s] 93%|█████████▎| 14/15 [00:01<00:00,  8.71it/s]100%|██████████| 15/15 [00:04<00:00,  1.18it/s]100%|██████████| 15/15 [00:04<00:00,  3.58it/s]
2025-03-09 10:27:41,319 [INFO]: 	Computing best hyperparameters for index knn.index 03/09/2025, 10:27:41
2025-03-09 10:28:15,150 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 33.8300 secs
2025-03-09 10:28:15,150 [INFO]: The best hyperparameters are: efSearch=333
2025-03-09 10:28:15,150 [INFO]: 	Compute fast metrics 03/09/2025, 10:28:15
  0%|          | 0/4 [00:00<?, ?it/s] 25%|██▌       | 1/4 [00:00<00:00,  5.36it/s] 50%|█████     | 2/4 [00:00<00:00,  7.01it/s] 75%|███████▌  | 3/4 [00:00<00:00,  7.81it/s] 75%|███████▌  | 3/4 [00:00<00:00,  5.89it/s]
2025-03-09 10:28:30,053 [INFO]: 	>>> Finished "Compute fast metrics" in 14.9024 secs
2025-03-09 10:28:30,055 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 52.9228 secs
2025-03-09 10:28:30,055 [INFO]: {
2025-03-09 10:28:30,055 [INFO]: 	index_key: HNSW15
2025-03-09 10:28:30,055 [INFO]: 	index_param: efSearch=333
2025-03-09 10:28:30,055 [INFO]: 	index_path: knn.index
2025-03-09 10:28:30,055 [INFO]: 	size in bytes: 726575110
2025-03-09 10:28:30,055 [INFO]: 	avg_search_speed_ms: 10.279524815819185
2025-03-09 10:28:30,055 [INFO]: 	99p_search_speed_ms: 15.117779215797777
2025-03-09 10:28:30,055 [INFO]: 	reconstruction error %: 0.0
2025-03-09 10:28:30,055 [INFO]: 	nb vectors: 3693
2025-03-09 10:28:30,055 [INFO]: 	vectors dimension: 49152
2025-03-09 10:28:30,055 [INFO]: 	compression ratio: 0.9993094093190172
2025-03-09 10:28:30,055 [INFO]: }
2025-03-09 10:28:30,055 [INFO]: 	>>> Finished "Creating the index" in 52.9244 secs
2025-03-09 10:28:30,055 [INFO]: >>> Finished "Launching the whole pipeline" in 52.9489 secs
2025-03-09 10:28:31: [retrieval_preprocessing] calculating distances ...
2025-03-09 10:28:32: [retrieval_preprocessing] finished and saved retrieval indices for episode 50737 [episode count 19/20]
2025-03-09 10:28:32: [retrieval_preprocessing] finished for (5414640868, 'lid') [chosen_id count 9/10]
2025-03-09 10:28:32: [retrieval_preprocessing] done for embedding_type='embeddings__wrist_image_left'!
