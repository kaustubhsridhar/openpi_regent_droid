nohup: ignoring input
2025-03-12 17:53:41: [retrieval_preprocessing] starting retrieval preprocessing for wrist_image
2025-03-12 17:53:43: [retrieval_preprocessing] concatenated all embeddings and indices for 19 episodes for collected_demos_training/2025-03-10_pick_up_the_apple_and_put_it_in_the_bowl [chosen_id count 0/8]
2025-03-12 17:53:43: [retrieval_preprocessing] we have num_total=2340 embedding_dim=49152
[retrieval_preprocessing] for episode 0 [episode count 0/19], we have num_retrieval=np.int64(2197) num_query=np.int64(143)
2025-03-12 17:53:43,181 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-12 17:53:43,523 [INFO]: Launching the whole pipeline 03/12/2025, 17:53:43
2025-03-12 17:53:43,523 [INFO]: Reading total number of vectors and dimension 03/12/2025, 17:53:43
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 563.98it/s]
2025-03-12 17:53:43,582 [INFO]: There are 2197 embeddings of dim 49152
2025-03-12 17:53:43,582 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0588 secs
2025-03-12 17:53:43,582 [INFO]: 	Compute estimated construction time of the index 03/12/2025, 17:53:43
2025-03-12 17:53:43,582 [INFO]: 		-> Train: 16.7 minutes
2025-03-12 17:53:43,583 [INFO]: 		-> Add: 1.2 seconds
2025-03-12 17:53:43,583 [INFO]: 		Total: 16.7 minutes
2025-03-12 17:53:43,583 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0002 secs
2025-03-12 17:53:43,583 [INFO]: 	Checking that your have enough memory available to create the index 03/12/2025, 17:53:43
2025-03-12 17:53:43,583 [INFO]: 453.4MB of memory will be needed to build the index (more might be used if you have more)
2025-03-12 17:53:43,583 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0008 secs
2025-03-12 17:53:43,584 [INFO]: 	Selecting most promising index types given data characteristics 03/12/2025, 17:53:43
2025-03-12 17:53:43,584 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-12 17:53:43,584 [INFO]: 	Creating the index 03/12/2025, 17:53:43
2025-03-12 17:53:43,584 [INFO]: 		-> Instanciate the index HNSW15 03/12/2025, 17:53:43
2025-03-12 17:53:43,586 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0019 secs
2025-03-12 17:53:43,586 [INFO]: 		-> Adding the vectors to the index 03/12/2025, 17:53:43
2025-03-12 17:53:43,586 [INFO]: The memory available for adding the vectors is 49.6GB(total available - used by the index)
2025-03-12 17:53:43,586 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/9 [00:00<?, ?it/s] 33%|███▎      | 3/9 [00:00<00:00, 27.60it/s]100%|██████████| 9/9 [00:01<00:00,  6.13it/s]100%|██████████| 9/9 [00:01<00:00,  6.63it/s]
2025-03-12 17:53:44,946 [INFO]: 	Computing best hyperparameters for index knn.index 03/12/2025, 17:53:44
2025-03-12 17:54:07,058 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 22.1112 secs
2025-03-12 17:54:07,058 [INFO]: The best hyperparameters are: efSearch=287
2025-03-12 17:54:07,058 [INFO]: 	Compute fast metrics 03/12/2025, 17:54:07
  0%|          | 0/4 [00:00<?, ?it/s] 75%|███████▌  | 3/4 [00:00<00:00, 28.90it/s] 75%|███████▌  | 3/4 [00:00<00:00, 24.75it/s]
2025-03-12 17:54:18,283 [INFO]: 	>>> Finished "Compute fast metrics" in 11.2247 secs
2025-03-12 17:54:18,284 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 34.6986 secs
2025-03-12 17:54:18,284 [INFO]: {
2025-03-12 17:54:18,284 [INFO]: 	index_key: HNSW15
2025-03-12 17:54:18,284 [INFO]: 	index_param: efSearch=287
2025-03-12 17:54:18,284 [INFO]: 	index_path: knn.index
2025-03-12 17:54:18,285 [INFO]: 	size in bytes: 432246490
2025-03-12 17:54:18,285 [INFO]: 	avg_search_speed_ms: 9.673595151501912
2025-03-12 17:54:18,285 [INFO]: 	99p_search_speed_ms: 12.224986990913749
2025-03-12 17:54:18,285 [INFO]: 	reconstruction error %: 0.0
2025-03-12 17:54:18,285 [INFO]: 	nb vectors: 2197
2025-03-12 17:54:18,285 [INFO]: 	vectors dimension: 49152
2025-03-12 17:54:18,285 [INFO]: 	compression ratio: 0.9993089267191042
2025-03-12 17:54:18,285 [INFO]: }
2025-03-12 17:54:18,285 [INFO]: 	>>> Finished "Creating the index" in 34.7010 secs
2025-03-12 17:54:18,285 [INFO]: >>> Finished "Launching the whole pipeline" in 34.7612 secs
2025-03-12 17:54:19: [retrieval_preprocessing] calculating distances ...
2025-03-12 17:54:19: [retrieval_preprocessing] finished and saved retrieval indices for episode 0 [episode count 0/19]
[retrieval_preprocessing] for episode 1 [episode count 1/19], we have num_retrieval=np.int64(2208) num_query=np.int64(132)
2025-03-12 17:54:19,698 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-12 17:54:19,948 [INFO]: Launching the whole pipeline 03/12/2025, 17:54:19
2025-03-12 17:54:19,948 [INFO]: Reading total number of vectors and dimension 03/12/2025, 17:54:19
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1733.18it/s]
2025-03-12 17:54:19,977 [INFO]: There are 2208 embeddings of dim 49152
2025-03-12 17:54:19,977 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0291 secs
2025-03-12 17:54:19,977 [INFO]: 	Compute estimated construction time of the index 03/12/2025, 17:54:19
2025-03-12 17:54:19,977 [INFO]: 		-> Train: 16.7 minutes
2025-03-12 17:54:19,977 [INFO]: 		-> Add: 1.2 seconds
2025-03-12 17:54:19,977 [INFO]: 		Total: 16.7 minutes
2025-03-12 17:54:19,977 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0001 secs
2025-03-12 17:54:19,977 [INFO]: 	Checking that your have enough memory available to create the index 03/12/2025, 17:54:19
2025-03-12 17:54:19,977 [INFO]: 455.7MB of memory will be needed to build the index (more might be used if you have more)
2025-03-12 17:54:19,977 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0001 secs
2025-03-12 17:54:19,977 [INFO]: 	Selecting most promising index types given data characteristics 03/12/2025, 17:54:19
2025-03-12 17:54:19,977 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-12 17:54:19,977 [INFO]: 	Creating the index 03/12/2025, 17:54:19
2025-03-12 17:54:19,977 [INFO]: 		-> Instanciate the index HNSW15 03/12/2025, 17:54:19
2025-03-12 17:54:19,978 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0009 secs
2025-03-12 17:54:19,978 [INFO]: 		-> Adding the vectors to the index 03/12/2025, 17:54:19
2025-03-12 17:54:19,978 [INFO]: The memory available for adding the vectors is 49.6GB(total available - used by the index)
2025-03-12 17:54:19,978 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/9 [00:00<?, ?it/s] 33%|███▎      | 3/9 [00:00<00:00, 28.04it/s]100%|██████████| 9/9 [00:01<00:00,  6.30it/s]100%|██████████| 9/9 [00:01<00:00,  6.82it/s]
2025-03-12 17:54:21,300 [INFO]: 	Computing best hyperparameters for index knn.index 03/12/2025, 17:54:21
2025-03-12 17:54:42,182 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 20.8810 secs
2025-03-12 17:54:42,182 [INFO]: The best hyperparameters are: efSearch=342
2025-03-12 17:54:42,182 [INFO]: 	Compute fast metrics 03/12/2025, 17:54:42
  0%|          | 0/4 [00:00<?, ?it/s] 75%|███████▌  | 3/4 [00:00<00:00, 27.89it/s] 75%|███████▌  | 3/4 [00:00<00:00, 24.04it/s]
2025-03-12 17:54:53,483 [INFO]: 	>>> Finished "Compute fast metrics" in 11.3015 secs
2025-03-12 17:54:53,485 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 33.5062 secs
2025-03-12 17:54:53,485 [INFO]: {
2025-03-12 17:54:53,485 [INFO]: 	index_key: HNSW15
2025-03-12 17:54:53,485 [INFO]: 	index_param: efSearch=342
2025-03-12 17:54:53,485 [INFO]: 	index_path: knn.index
2025-03-12 17:54:53,485 [INFO]: 	size in bytes: 434410630
2025-03-12 17:54:53,485 [INFO]: 	avg_search_speed_ms: 10.523829903682747
2025-03-12 17:54:53,485 [INFO]: 	99p_search_speed_ms: 13.43858556356281
2025-03-12 17:54:53,485 [INFO]: 	reconstruction error %: 0.0
2025-03-12 17:54:53,485 [INFO]: 	nb vectors: 2208
2025-03-12 17:54:53,485 [INFO]: 	vectors dimension: 49152
2025-03-12 17:54:53,485 [INFO]: 	compression ratio: 0.9993090270373909
2025-03-12 17:54:53,485 [INFO]: }
2025-03-12 17:54:53,485 [INFO]: 	>>> Finished "Creating the index" in 33.5076 secs
2025-03-12 17:54:53,485 [INFO]: >>> Finished "Launching the whole pipeline" in 33.5372 secs
2025-03-12 17:54:54: [retrieval_preprocessing] calculating distances ...
2025-03-12 17:54:55: [retrieval_preprocessing] finished and saved retrieval indices for episode 1 [episode count 1/19]
[retrieval_preprocessing] for episode 2 [episode count 2/19], we have num_retrieval=np.int64(2231) num_query=np.int64(109)
2025-03-12 17:54:55,330 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-12 17:54:55,583 [INFO]: Launching the whole pipeline 03/12/2025, 17:54:55
2025-03-12 17:54:55,584 [INFO]: Reading total number of vectors and dimension 03/12/2025, 17:54:55
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1755.67it/s]
2025-03-12 17:54:55,611 [INFO]: There are 2231 embeddings of dim 49152
2025-03-12 17:54:55,612 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0281 secs
2025-03-12 17:54:55,612 [INFO]: 	Compute estimated construction time of the index 03/12/2025, 17:54:55
2025-03-12 17:54:55,612 [INFO]: 		-> Train: 16.7 minutes
2025-03-12 17:54:55,612 [INFO]: 		-> Add: 1.2 seconds
2025-03-12 17:54:55,612 [INFO]: 		Total: 16.7 minutes
2025-03-12 17:54:55,612 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0001 secs
2025-03-12 17:54:55,612 [INFO]: 	Checking that your have enough memory available to create the index 03/12/2025, 17:54:55
2025-03-12 17:54:55,612 [INFO]: 460.4MB of memory will be needed to build the index (more might be used if you have more)
2025-03-12 17:54:55,612 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0001 secs
2025-03-12 17:54:55,612 [INFO]: 	Selecting most promising index types given data characteristics 03/12/2025, 17:54:55
2025-03-12 17:54:55,612 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-12 17:54:55,612 [INFO]: 	Creating the index 03/12/2025, 17:54:55
2025-03-12 17:54:55,612 [INFO]: 		-> Instanciate the index HNSW15 03/12/2025, 17:54:55
2025-03-12 17:54:55,613 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0008 secs
2025-03-12 17:54:55,613 [INFO]: 		-> Adding the vectors to the index 03/12/2025, 17:54:55
2025-03-12 17:54:55,613 [INFO]: The memory available for adding the vectors is 49.6GB(total available - used by the index)
2025-03-12 17:54:55,613 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/9 [00:00<?, ?it/s] 22%|██▏       | 2/9 [00:00<00:00, 17.72it/s]100%|██████████| 9/9 [00:01<00:00,  6.39it/s]100%|██████████| 9/9 [00:01<00:00,  6.67it/s]
2025-03-12 17:54:56,966 [INFO]: 	Computing best hyperparameters for index knn.index 03/12/2025, 17:54:56
2025-03-12 17:55:18,711 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 21.7442 secs
2025-03-12 17:55:18,711 [INFO]: The best hyperparameters are: efSearch=334
2025-03-12 17:55:18,711 [INFO]: 	Compute fast metrics 03/12/2025, 17:55:18
  0%|          | 0/4 [00:00<?, ?it/s] 75%|███████▌  | 3/4 [00:00<00:00, 28.47it/s] 75%|███████▌  | 3/4 [00:00<00:00, 25.10it/s]
2025-03-12 17:55:29,919 [INFO]: 	>>> Finished "Compute fast metrics" in 11.2080 secs
2025-03-12 17:55:29,920 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 34.3070 secs
2025-03-12 17:55:29,920 [INFO]: {
2025-03-12 17:55:29,920 [INFO]: 	index_key: HNSW15
2025-03-12 17:55:29,920 [INFO]: 	index_param: efSearch=334
2025-03-12 17:55:29,920 [INFO]: 	index_path: knn.index
2025-03-12 17:55:29,920 [INFO]: 	size in bytes: 438935650
2025-03-12 17:55:29,920 [INFO]: 	avg_search_speed_ms: 9.798001581903302
2025-03-12 17:55:29,920 [INFO]: 	99p_search_speed_ms: 11.836646543815732
2025-03-12 17:55:29,920 [INFO]: 	reconstruction error %: 0.0
2025-03-12 17:55:29,920 [INFO]: 	nb vectors: 2231
2025-03-12 17:55:29,920 [INFO]: 	vectors dimension: 49152
2025-03-12 17:55:29,920 [INFO]: 	compression ratio: 0.9993092335972255
2025-03-12 17:55:29,920 [INFO]: }
2025-03-12 17:55:29,920 [INFO]: 	>>> Finished "Creating the index" in 34.3082 secs
2025-03-12 17:55:29,920 [INFO]: >>> Finished "Launching the whole pipeline" in 34.3368 secs
2025-03-12 17:55:30: [retrieval_preprocessing] calculating distances ...
2025-03-12 17:55:30: [retrieval_preprocessing] finished and saved retrieval indices for episode 2 [episode count 2/19]
[retrieval_preprocessing] for episode 3 [episode count 3/19], we have num_retrieval=np.int64(2236) num_query=np.int64(104)
2025-03-12 17:55:31,024 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-12 17:55:31,273 [INFO]: Launching the whole pipeline 03/12/2025, 17:55:31
2025-03-12 17:55:31,273 [INFO]: Reading total number of vectors and dimension 03/12/2025, 17:55:31
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 2236.96it/s]
2025-03-12 17:55:31,299 [INFO]: There are 2236 embeddings of dim 49152
2025-03-12 17:55:31,300 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0265 secs
2025-03-12 17:55:31,300 [INFO]: 	Compute estimated construction time of the index 03/12/2025, 17:55:31
2025-03-12 17:55:31,300 [INFO]: 		-> Train: 16.7 minutes
2025-03-12 17:55:31,300 [INFO]: 		-> Add: 1.2 seconds
2025-03-12 17:55:31,300 [INFO]: 		Total: 16.7 minutes
2025-03-12 17:55:31,300 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0001 secs
2025-03-12 17:55:31,300 [INFO]: 	Checking that your have enough memory available to create the index 03/12/2025, 17:55:31
2025-03-12 17:55:31,300 [INFO]: 461.5MB of memory will be needed to build the index (more might be used if you have more)
2025-03-12 17:55:31,300 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0001 secs
2025-03-12 17:55:31,300 [INFO]: 	Selecting most promising index types given data characteristics 03/12/2025, 17:55:31
2025-03-12 17:55:31,300 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-12 17:55:31,300 [INFO]: 	Creating the index 03/12/2025, 17:55:31
2025-03-12 17:55:31,300 [INFO]: 		-> Instanciate the index HNSW15 03/12/2025, 17:55:31
2025-03-12 17:55:31,301 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0009 secs
2025-03-12 17:55:31,301 [INFO]: 		-> Adding the vectors to the index 03/12/2025, 17:55:31
2025-03-12 17:55:31,301 [INFO]: The memory available for adding the vectors is 49.6GB(total available - used by the index)
2025-03-12 17:55:31,301 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/9 [00:00<?, ?it/s] 33%|███▎      | 3/9 [00:00<00:00, 27.05it/s]100%|██████████| 9/9 [00:01<00:00,  6.20it/s]100%|██████████| 9/9 [00:01<00:00,  6.71it/s]
2025-03-12 17:55:32,645 [INFO]: 	Computing best hyperparameters for index knn.index 03/12/2025, 17:55:32
2025-03-12 17:55:56,302 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 23.6560 secs
2025-03-12 17:55:56,302 [INFO]: The best hyperparameters are: efSearch=286
2025-03-12 17:55:56,302 [INFO]: 	Compute fast metrics 03/12/2025, 17:55:56
  0%|          | 0/4 [00:00<?, ?it/s] 75%|███████▌  | 3/4 [00:00<00:00, 27.35it/s] 75%|███████▌  | 3/4 [00:00<00:00, 23.46it/s]
2025-03-12 17:56:07,514 [INFO]: 	>>> Finished "Compute fast metrics" in 11.2114 secs
2025-03-12 17:56:07,515 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 36.2140 secs
2025-03-12 17:56:07,515 [INFO]: {
2025-03-12 17:56:07,515 [INFO]: 	index_key: HNSW15
2025-03-12 17:56:07,515 [INFO]: 	index_param: efSearch=286
2025-03-12 17:56:07,515 [INFO]: 	index_path: knn.index
2025-03-12 17:56:07,515 [INFO]: 	size in bytes: 439919350
2025-03-12 17:56:07,515 [INFO]: 	avg_search_speed_ms: 10.173173286380779
2025-03-12 17:56:07,515 [INFO]: 	99p_search_speed_ms: 12.237013787962496
2025-03-12 17:56:07,515 [INFO]: 	reconstruction error %: 0.0
2025-03-12 17:56:07,515 [INFO]: 	nb vectors: 2236
2025-03-12 17:56:07,515 [INFO]: 	vectors dimension: 49152
2025-03-12 17:56:07,515 [INFO]: 	compression ratio: 0.9993092779392404
2025-03-12 17:56:07,515 [INFO]: }
2025-03-12 17:56:07,515 [INFO]: 	>>> Finished "Creating the index" in 36.2152 secs
2025-03-12 17:56:07,515 [INFO]: >>> Finished "Launching the whole pipeline" in 36.2422 secs
2025-03-12 17:56:08: [retrieval_preprocessing] calculating distances ...
2025-03-12 17:56:08: [retrieval_preprocessing] finished and saved retrieval indices for episode 3 [episode count 3/19]
[retrieval_preprocessing] for episode 4 [episode count 4/19], we have num_retrieval=np.int64(2240) num_query=np.int64(100)
2025-03-12 17:56:08,559 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-12 17:56:08,815 [INFO]: Launching the whole pipeline 03/12/2025, 17:56:08
2025-03-12 17:56:08,815 [INFO]: Reading total number of vectors and dimension 03/12/2025, 17:56:08
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 2068.20it/s]
2025-03-12 17:56:08,844 [INFO]: There are 2240 embeddings of dim 49152
2025-03-12 17:56:08,844 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0290 secs
2025-03-12 17:56:08,844 [INFO]: 	Compute estimated construction time of the index 03/12/2025, 17:56:08
2025-03-12 17:56:08,844 [INFO]: 		-> Train: 16.7 minutes
2025-03-12 17:56:08,844 [INFO]: 		-> Add: 1.2 seconds
2025-03-12 17:56:08,844 [INFO]: 		Total: 16.7 minutes
2025-03-12 17:56:08,844 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0001 secs
2025-03-12 17:56:08,844 [INFO]: 	Checking that your have enough memory available to create the index 03/12/2025, 17:56:08
2025-03-12 17:56:08,844 [INFO]: 462.3MB of memory will be needed to build the index (more might be used if you have more)
2025-03-12 17:56:08,844 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0001 secs
2025-03-12 17:56:08,844 [INFO]: 	Selecting most promising index types given data characteristics 03/12/2025, 17:56:08
2025-03-12 17:56:08,844 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-12 17:56:08,844 [INFO]: 	Creating the index 03/12/2025, 17:56:08
2025-03-12 17:56:08,845 [INFO]: 		-> Instanciate the index HNSW15 03/12/2025, 17:56:08
2025-03-12 17:56:08,845 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0009 secs
2025-03-12 17:56:08,846 [INFO]: 		-> Adding the vectors to the index 03/12/2025, 17:56:08
2025-03-12 17:56:08,846 [INFO]: The memory available for adding the vectors is 49.6GB(total available - used by the index)
2025-03-12 17:56:08,846 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/9 [00:00<?, ?it/s] 33%|███▎      | 3/9 [00:00<00:00, 26.19it/s]100%|██████████| 9/9 [00:01<00:00,  6.14it/s]100%|██████████| 9/9 [00:01<00:00,  6.64it/s]
2025-03-12 17:56:10,204 [INFO]: 	Computing best hyperparameters for index knn.index 03/12/2025, 17:56:10
2025-03-12 17:56:31,357 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 21.1530 secs
2025-03-12 17:56:31,357 [INFO]: The best hyperparameters are: efSearch=332
2025-03-12 17:56:31,357 [INFO]: 	Compute fast metrics 03/12/2025, 17:56:31
  0%|          | 0/4 [00:00<?, ?it/s] 75%|███████▌  | 3/4 [00:00<00:00, 27.85it/s] 75%|███████▌  | 3/4 [00:00<00:00, 24.26it/s]
2025-03-12 17:56:42,597 [INFO]: 	>>> Finished "Compute fast metrics" in 11.2396 secs
2025-03-12 17:56:42,598 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 33.7528 secs
2025-03-12 17:56:42,598 [INFO]: {
2025-03-12 17:56:42,598 [INFO]: 	index_key: HNSW15
2025-03-12 17:56:42,598 [INFO]: 	index_param: efSearch=332
2025-03-12 17:56:42,598 [INFO]: 	index_path: knn.index
2025-03-12 17:56:42,598 [INFO]: 	size in bytes: 440706310
2025-03-12 17:56:42,598 [INFO]: 	avg_search_speed_ms: 10.381758601657845
2025-03-12 17:56:42,598 [INFO]: 	99p_search_speed_ms: 12.832033715676516
2025-03-12 17:56:42,598 [INFO]: 	reconstruction error %: 0.0
2025-03-12 17:56:42,598 [INFO]: 	nb vectors: 2240
2025-03-12 17:56:42,599 [INFO]: 	vectors dimension: 49152
2025-03-12 17:56:42,599 [INFO]: 	compression ratio: 0.9993093132703273
2025-03-12 17:56:42,599 [INFO]: }
2025-03-12 17:56:42,599 [INFO]: 	>>> Finished "Creating the index" in 33.7540 secs
2025-03-12 17:56:42,599 [INFO]: >>> Finished "Launching the whole pipeline" in 33.7836 secs
2025-03-12 17:56:43: [retrieval_preprocessing] calculating distances ...
2025-03-12 17:56:43: [retrieval_preprocessing] finished and saved retrieval indices for episode 4 [episode count 4/19]
[retrieval_preprocessing] for episode 5 [episode count 5/19], we have num_retrieval=np.int64(2241) num_query=np.int64(99)
2025-03-12 17:56:43,650 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-12 17:56:43,908 [INFO]: Launching the whole pipeline 03/12/2025, 17:56:43
2025-03-12 17:56:43,908 [INFO]: Reading total number of vectors and dimension 03/12/2025, 17:56:43
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 2190.24it/s]
2025-03-12 17:56:43,934 [INFO]: There are 2241 embeddings of dim 49152
2025-03-12 17:56:43,935 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0264 secs
2025-03-12 17:56:43,935 [INFO]: 	Compute estimated construction time of the index 03/12/2025, 17:56:43
2025-03-12 17:56:43,935 [INFO]: 		-> Train: 16.7 minutes
2025-03-12 17:56:43,935 [INFO]: 		-> Add: 1.2 seconds
2025-03-12 17:56:43,935 [INFO]: 		Total: 16.7 minutes
2025-03-12 17:56:43,935 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0001 secs
2025-03-12 17:56:43,935 [INFO]: 	Checking that your have enough memory available to create the index 03/12/2025, 17:56:43
2025-03-12 17:56:43,935 [INFO]: 462.5MB of memory will be needed to build the index (more might be used if you have more)
2025-03-12 17:56:43,935 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0001 secs
2025-03-12 17:56:43,935 [INFO]: 	Selecting most promising index types given data characteristics 03/12/2025, 17:56:43
2025-03-12 17:56:43,935 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-12 17:56:43,935 [INFO]: 	Creating the index 03/12/2025, 17:56:43
2025-03-12 17:56:43,935 [INFO]: 		-> Instanciate the index HNSW15 03/12/2025, 17:56:43
2025-03-12 17:56:43,936 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0008 secs
2025-03-12 17:56:43,936 [INFO]: 		-> Adding the vectors to the index 03/12/2025, 17:56:43
2025-03-12 17:56:43,936 [INFO]: The memory available for adding the vectors is 49.6GB(total available - used by the index)
2025-03-12 17:56:43,936 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/9 [00:00<?, ?it/s] 33%|███▎      | 3/9 [00:00<00:00, 26.58it/s]100%|██████████| 9/9 [00:01<00:00,  6.17it/s]100%|██████████| 9/9 [00:01<00:00,  6.67it/s]
2025-03-12 17:56:45,288 [INFO]: 	Computing best hyperparameters for index knn.index 03/12/2025, 17:56:45
2025-03-12 17:57:06,725 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 21.4375 secs
2025-03-12 17:57:06,726 [INFO]: The best hyperparameters are: efSearch=312
2025-03-12 17:57:06,726 [INFO]: 	Compute fast metrics 03/12/2025, 17:57:06
  0%|          | 0/4 [00:00<?, ?it/s] 75%|███████▌  | 3/4 [00:00<00:00, 26.74it/s]
2025-03-12 17:57:17,956 [INFO]: 	>>> Finished "Compute fast metrics" in 11.2299 secs
2025-03-12 17:57:17,957 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 34.0207 secs
2025-03-12 17:57:17,957 [INFO]: {
2025-03-12 17:57:17,957 [INFO]: 	index_key: HNSW15
2025-03-12 17:57:17,957 [INFO]: 	index_param: efSearch=312
2025-03-12 17:57:17,957 [INFO]: 	index_path: knn.index
2025-03-12 17:57:17,957 [INFO]: 	size in bytes: 440903050
2025-03-12 17:57:17,957 [INFO]: 	avg_search_speed_ms: 9.486019722472317
2025-03-12 17:57:17,957 [INFO]: 	99p_search_speed_ms: 11.875330929178745
2025-03-12 17:57:17,957 [INFO]: 	reconstruction error %: 0.0
2025-03-12 17:57:17,957 [INFO]: 	nb vectors: 2241
2025-03-12 17:57:17,957 [INFO]: 	vectors dimension: 49152
2025-03-12 17:57:17,957 [INFO]: 	compression ratio: 0.9993093220833923
2025-03-12 17:57:17,957 [INFO]: }
2025-03-12 17:57:17,957 [INFO]: 	>>> Finished "Creating the index" in 34.0219 secs
2025-03-12 17:57:17,957 [INFO]: >>> Finished "Launching the whole pipeline" in 34.0487 secs
2025-03-12 17:57:18: [retrieval_preprocessing] calculating distances ...
2025-03-12 17:57:18: [retrieval_preprocessing] finished and saved retrieval indices for episode 5 [episode count 5/19]
[retrieval_preprocessing] for episode 6 [episode count 6/19], we have num_retrieval=np.int64(2196) num_query=np.int64(144)
2025-03-12 17:57:18,985 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-12 17:57:19,236 [INFO]: Launching the whole pipeline 03/12/2025, 17:57:19
2025-03-12 17:57:19,236 [INFO]: Reading total number of vectors and dimension 03/12/2025, 17:57:19
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1495.83it/s]
2025-03-12 17:57:19,263 [INFO]: There are 2196 embeddings of dim 49152
2025-03-12 17:57:19,264 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0273 secs
2025-03-12 17:57:19,264 [INFO]: 	Compute estimated construction time of the index 03/12/2025, 17:57:19
2025-03-12 17:57:19,264 [INFO]: 		-> Train: 16.7 minutes
2025-03-12 17:57:19,264 [INFO]: 		-> Add: 1.2 seconds
2025-03-12 17:57:19,264 [INFO]: 		Total: 16.7 minutes
2025-03-12 17:57:19,264 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0001 secs
2025-03-12 17:57:19,264 [INFO]: 	Checking that your have enough memory available to create the index 03/12/2025, 17:57:19
2025-03-12 17:57:19,264 [INFO]: 453.2MB of memory will be needed to build the index (more might be used if you have more)
2025-03-12 17:57:19,264 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0001 secs
2025-03-12 17:57:19,264 [INFO]: 	Selecting most promising index types given data characteristics 03/12/2025, 17:57:19
2025-03-12 17:57:19,264 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-12 17:57:19,264 [INFO]: 	Creating the index 03/12/2025, 17:57:19
2025-03-12 17:57:19,264 [INFO]: 		-> Instanciate the index HNSW15 03/12/2025, 17:57:19
2025-03-12 17:57:19,265 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0008 secs
2025-03-12 17:57:19,265 [INFO]: 		-> Adding the vectors to the index 03/12/2025, 17:57:19
2025-03-12 17:57:19,265 [INFO]: The memory available for adding the vectors is 49.6GB(total available - used by the index)
2025-03-12 17:57:19,265 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/9 [00:00<?, ?it/s] 33%|███▎      | 3/9 [00:00<00:00, 26.47it/s]100%|██████████| 9/9 [00:01<00:00,  5.79it/s]100%|██████████| 9/9 [00:01<00:00,  6.28it/s]
2025-03-12 17:57:20,702 [INFO]: 	Computing best hyperparameters for index knn.index 03/12/2025, 17:57:20
2025-03-12 17:57:43,676 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 22.9732 secs
2025-03-12 17:57:43,676 [INFO]: The best hyperparameters are: efSearch=282
2025-03-12 17:57:43,676 [INFO]: 	Compute fast metrics 03/12/2025, 17:57:43
  0%|          | 0/4 [00:00<?, ?it/s] 75%|███████▌  | 3/4 [00:00<00:00, 29.32it/s] 75%|███████▌  | 3/4 [00:00<00:00, 25.62it/s]
2025-03-12 17:57:54,919 [INFO]: 	>>> Finished "Compute fast metrics" in 11.2433 secs
2025-03-12 17:57:54,920 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 35.6554 secs
2025-03-12 17:57:54,920 [INFO]: {
2025-03-12 17:57:54,921 [INFO]: 	index_key: HNSW15
2025-03-12 17:57:54,921 [INFO]: 	index_param: efSearch=282
2025-03-12 17:57:54,921 [INFO]: 	index_path: knn.index
2025-03-12 17:57:54,921 [INFO]: 	size in bytes: 432049750
2025-03-12 17:57:54,921 [INFO]: 	avg_search_speed_ms: 9.914715084864788
2025-03-12 17:57:54,921 [INFO]: 	99p_search_speed_ms: 12.186445705592629
2025-03-12 17:57:54,921 [INFO]: 	reconstruction error %: 0.0
2025-03-12 17:57:54,921 [INFO]: 	nb vectors: 2196
2025-03-12 17:57:54,921 [INFO]: 	vectors dimension: 49152
2025-03-12 17:57:54,921 [INFO]: 	compression ratio: 0.9993089175494257
2025-03-12 17:57:54,921 [INFO]: }
2025-03-12 17:57:54,921 [INFO]: 	>>> Finished "Creating the index" in 35.6566 secs
2025-03-12 17:57:54,921 [INFO]: >>> Finished "Launching the whole pipeline" in 35.6844 secs
2025-03-12 17:57:55: [retrieval_preprocessing] calculating distances ...
2025-03-12 17:57:56: [retrieval_preprocessing] finished and saved retrieval indices for episode 6 [episode count 6/19]
[retrieval_preprocessing] for episode 7 [episode count 7/19], we have num_retrieval=np.int64(2185) num_query=np.int64(155)
2025-03-12 17:57:56,295 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-12 17:57:56,544 [INFO]: Launching the whole pipeline 03/12/2025, 17:57:56
2025-03-12 17:57:56,545 [INFO]: Reading total number of vectors and dimension 03/12/2025, 17:57:56
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1940.01it/s]
2025-03-12 17:57:56,572 [INFO]: There are 2185 embeddings of dim 49152
2025-03-12 17:57:56,572 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0275 secs
2025-03-12 17:57:56,572 [INFO]: 	Compute estimated construction time of the index 03/12/2025, 17:57:56
2025-03-12 17:57:56,572 [INFO]: 		-> Train: 16.7 minutes
2025-03-12 17:57:56,572 [INFO]: 		-> Add: 1.2 seconds
2025-03-12 17:57:56,572 [INFO]: 		Total: 16.7 minutes
2025-03-12 17:57:56,572 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0001 secs
2025-03-12 17:57:56,572 [INFO]: 	Checking that your have enough memory available to create the index 03/12/2025, 17:57:56
2025-03-12 17:57:56,572 [INFO]: 450.9MB of memory will be needed to build the index (more might be used if you have more)
2025-03-12 17:57:56,572 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0001 secs
2025-03-12 17:57:56,572 [INFO]: 	Selecting most promising index types given data characteristics 03/12/2025, 17:57:56
2025-03-12 17:57:56,573 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-12 17:57:56,573 [INFO]: 	Creating the index 03/12/2025, 17:57:56
2025-03-12 17:57:56,573 [INFO]: 		-> Instanciate the index HNSW15 03/12/2025, 17:57:56
2025-03-12 17:57:56,574 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0009 secs
2025-03-12 17:57:56,574 [INFO]: 		-> Adding the vectors to the index 03/12/2025, 17:57:56
2025-03-12 17:57:56,574 [INFO]: The memory available for adding the vectors is 49.6GB(total available - used by the index)
2025-03-12 17:57:56,574 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/9 [00:00<?, ?it/s] 22%|██▏       | 2/9 [00:00<00:00, 19.48it/s]100%|██████████| 9/9 [00:01<00:00,  5.74it/s]100%|██████████| 9/9 [00:01<00:00,  6.02it/s]
2025-03-12 17:57:58,073 [INFO]: 	Computing best hyperparameters for index knn.index 03/12/2025, 17:57:58
2025-03-12 17:58:21,456 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 23.3834 secs
2025-03-12 17:58:21,456 [INFO]: The best hyperparameters are: efSearch=283
2025-03-12 17:58:21,456 [INFO]: 	Compute fast metrics 03/12/2025, 17:58:21
  0%|          | 0/4 [00:00<?, ?it/s] 25%|██▌       | 1/4 [00:01<00:03,  1.23s/it] 75%|███████▌  | 3/4 [00:01<00:00,  2.69it/s] 75%|███████▌  | 3/4 [00:01<00:00,  2.07it/s]
2025-03-12 17:58:33,965 [INFO]: 	>>> Finished "Compute fast metrics" in 12.5083 secs
2025-03-12 17:58:33,966 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 37.3925 secs
2025-03-12 17:58:33,966 [INFO]: {
2025-03-12 17:58:33,966 [INFO]: 	index_key: HNSW15
2025-03-12 17:58:33,966 [INFO]: 	index_param: efSearch=283
2025-03-12 17:58:33,966 [INFO]: 	index_path: knn.index
2025-03-12 17:58:33,966 [INFO]: 	size in bytes: 429885490
2025-03-12 17:58:33,966 [INFO]: 	avg_search_speed_ms: 9.695411976535134
2025-03-12 17:58:33,966 [INFO]: 	99p_search_speed_ms: 11.496520459186282
2025-03-12 17:58:33,966 [INFO]: 	reconstruction error %: 0.0
2025-03-12 17:58:33,966 [INFO]: 	nb vectors: 2185
2025-03-12 17:58:33,966 [INFO]: 	vectors dimension: 49152
2025-03-12 17:58:33,966 [INFO]: 	compression ratio: 0.9993090950801805
2025-03-12 17:58:33,966 [INFO]: }
2025-03-12 17:58:33,966 [INFO]: 	>>> Finished "Creating the index" in 37.3938 secs
2025-03-12 17:58:33,966 [INFO]: >>> Finished "Launching the whole pipeline" in 37.4218 secs
2025-03-12 17:58:35: [retrieval_preprocessing] calculating distances ...
2025-03-12 17:58:35: [retrieval_preprocessing] finished and saved retrieval indices for episode 7 [episode count 7/19]
[retrieval_preprocessing] for episode 8 [episode count 8/19], we have num_retrieval=np.int64(2178) num_query=np.int64(162)
2025-03-12 17:58:35,587 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-12 17:58:35,834 [INFO]: Launching the whole pipeline 03/12/2025, 17:58:35
2025-03-12 17:58:35,834 [INFO]: Reading total number of vectors and dimension 03/12/2025, 17:58:35
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 2407.75it/s]
2025-03-12 17:58:35,859 [INFO]: There are 2178 embeddings of dim 49152
2025-03-12 17:58:35,859 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0247 secs
2025-03-12 17:58:35,859 [INFO]: 	Compute estimated construction time of the index 03/12/2025, 17:58:35
2025-03-12 17:58:35,859 [INFO]: 		-> Train: 16.7 minutes
2025-03-12 17:58:35,859 [INFO]: 		-> Add: 1.2 seconds
2025-03-12 17:58:35,859 [INFO]: 		Total: 16.7 minutes
2025-03-12 17:58:35,859 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0001 secs
2025-03-12 17:58:35,859 [INFO]: 	Checking that your have enough memory available to create the index 03/12/2025, 17:58:35
2025-03-12 17:58:35,859 [INFO]: 449.5MB of memory will be needed to build the index (more might be used if you have more)
2025-03-12 17:58:35,859 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0001 secs
2025-03-12 17:58:35,859 [INFO]: 	Selecting most promising index types given data characteristics 03/12/2025, 17:58:35
2025-03-12 17:58:35,859 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-12 17:58:35,859 [INFO]: 	Creating the index 03/12/2025, 17:58:35
2025-03-12 17:58:35,859 [INFO]: 		-> Instanciate the index HNSW15 03/12/2025, 17:58:35
2025-03-12 17:58:35,860 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0008 secs
2025-03-12 17:58:35,860 [INFO]: 		-> Adding the vectors to the index 03/12/2025, 17:58:35
2025-03-12 17:58:35,860 [INFO]: The memory available for adding the vectors is 49.6GB(total available - used by the index)
2025-03-12 17:58:35,860 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/9 [00:00<?, ?it/s] 44%|████▍     | 4/9 [00:00<00:00, 37.21it/s]100%|██████████| 9/9 [00:01<00:00,  5.70it/s]100%|██████████| 9/9 [00:01<00:00,  6.42it/s]
2025-03-12 17:58:37,266 [INFO]: 	Computing best hyperparameters for index knn.index 03/12/2025, 17:58:37
2025-03-12 17:59:01,422 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 24.1563 secs
2025-03-12 17:59:01,423 [INFO]: The best hyperparameters are: efSearch=303
2025-03-12 17:59:01,423 [INFO]: 	Compute fast metrics 03/12/2025, 17:59:01
  0%|          | 0/4 [00:00<?, ?it/s] 75%|███████▌  | 3/4 [00:00<00:00, 29.36it/s] 75%|███████▌  | 3/4 [00:00<00:00, 25.80it/s]
2025-03-12 17:59:12,596 [INFO]: 	>>> Finished "Compute fast metrics" in 11.1731 secs
2025-03-12 17:59:12,597 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 36.7366 secs
2025-03-12 17:59:12,597 [INFO]: {
2025-03-12 17:59:12,597 [INFO]: 	index_key: HNSW15
2025-03-12 17:59:12,597 [INFO]: 	index_param: efSearch=303
2025-03-12 17:59:12,597 [INFO]: 	index_path: knn.index
2025-03-12 17:59:12,597 [INFO]: 	size in bytes: 428508310
2025-03-12 17:59:12,597 [INFO]: 	avg_search_speed_ms: 9.949323526161969
2025-03-12 17:59:12,597 [INFO]: 	99p_search_speed_ms: 11.858275989070536
2025-03-12 17:59:12,597 [INFO]: 	reconstruction error %: 0.0
2025-03-12 17:59:12,597 [INFO]: 	nb vectors: 2178
2025-03-12 17:59:12,597 [INFO]: 	vectors dimension: 49152
2025-03-12 17:59:12,597 [INFO]: 	compression ratio: 0.9993090309030414
2025-03-12 17:59:12,597 [INFO]: }
2025-03-12 17:59:12,597 [INFO]: 	>>> Finished "Creating the index" in 36.7379 secs
2025-03-12 17:59:12,597 [INFO]: >>> Finished "Launching the whole pipeline" in 36.7630 secs
2025-03-12 17:59:13: [retrieval_preprocessing] calculating distances ...
2025-03-12 17:59:14: [retrieval_preprocessing] finished and saved retrieval indices for episode 8 [episode count 8/19]
[retrieval_preprocessing] for episode 9 [episode count 9/19], we have num_retrieval=np.int64(2243) num_query=np.int64(97)
2025-03-12 17:59:14,316 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-12 17:59:14,568 [INFO]: Launching the whole pipeline 03/12/2025, 17:59:14
2025-03-12 17:59:14,568 [INFO]: Reading total number of vectors and dimension 03/12/2025, 17:59:14
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1871.62it/s]
2025-03-12 17:59:14,594 [INFO]: There are 2243 embeddings of dim 49152
2025-03-12 17:59:14,594 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0261 secs
2025-03-12 17:59:14,594 [INFO]: 	Compute estimated construction time of the index 03/12/2025, 17:59:14
2025-03-12 17:59:14,594 [INFO]: 		-> Train: 16.7 minutes
2025-03-12 17:59:14,594 [INFO]: 		-> Add: 1.2 seconds
2025-03-12 17:59:14,594 [INFO]: 		Total: 16.7 minutes
2025-03-12 17:59:14,594 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0001 secs
2025-03-12 17:59:14,594 [INFO]: 	Checking that your have enough memory available to create the index 03/12/2025, 17:59:14
2025-03-12 17:59:14,594 [INFO]: 462.9MB of memory will be needed to build the index (more might be used if you have more)
2025-03-12 17:59:14,594 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0001 secs
2025-03-12 17:59:14,594 [INFO]: 	Selecting most promising index types given data characteristics 03/12/2025, 17:59:14
2025-03-12 17:59:14,594 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-12 17:59:14,594 [INFO]: 	Creating the index 03/12/2025, 17:59:14
2025-03-12 17:59:14,594 [INFO]: 		-> Instanciate the index HNSW15 03/12/2025, 17:59:14
2025-03-12 17:59:14,595 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0009 secs
2025-03-12 17:59:14,595 [INFO]: 		-> Adding the vectors to the index 03/12/2025, 17:59:14
2025-03-12 17:59:14,595 [INFO]: The memory available for adding the vectors is 49.6GB(total available - used by the index)
2025-03-12 17:59:14,595 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/9 [00:00<?, ?it/s] 22%|██▏       | 2/9 [00:00<00:00, 19.28it/s]100%|██████████| 9/9 [00:01<00:00,  6.46it/s]100%|██████████| 9/9 [00:01<00:00,  6.76it/s]
2025-03-12 17:59:15,931 [INFO]: 	Computing best hyperparameters for index knn.index 03/12/2025, 17:59:15
2025-03-12 17:59:40,296 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 24.3644 secs
2025-03-12 17:59:40,296 [INFO]: The best hyperparameters are: efSearch=293
2025-03-12 17:59:40,296 [INFO]: 	Compute fast metrics 03/12/2025, 17:59:40
  0%|          | 0/4 [00:00<?, ?it/s] 75%|███████▌  | 3/4 [00:00<00:00, 29.07it/s] 75%|███████▌  | 3/4 [00:00<00:00, 25.84it/s]
2025-03-12 17:59:53,478 [INFO]: 	>>> Finished "Compute fast metrics" in 13.1816 secs
2025-03-12 17:59:53,479 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 38.8834 secs
2025-03-12 17:59:53,479 [INFO]: {
2025-03-12 17:59:53,479 [INFO]: 	index_key: HNSW15
2025-03-12 17:59:53,479 [INFO]: 	index_param: efSearch=293
2025-03-12 17:59:53,479 [INFO]: 	index_path: knn.index
2025-03-12 17:59:53,479 [INFO]: 	size in bytes: 441296530
2025-03-12 17:59:53,479 [INFO]: 	avg_search_speed_ms: 9.804033804639225
2025-03-12 17:59:53,479 [INFO]: 	99p_search_speed_ms: 12.039880449883638
2025-03-12 17:59:53,479 [INFO]: 	reconstruction error %: 0.0
2025-03-12 17:59:53,479 [INFO]: 	nb vectors: 2243
2025-03-12 17:59:53,479 [INFO]: 	vectors dimension: 49152
2025-03-12 17:59:53,479 [INFO]: 	compression ratio: 0.9993093396859477
2025-03-12 17:59:53,479 [INFO]: }
2025-03-12 17:59:53,479 [INFO]: 	>>> Finished "Creating the index" in 38.8847 secs
2025-03-12 17:59:53,479 [INFO]: >>> Finished "Launching the whole pipeline" in 38.9113 secs
2025-03-12 17:59:54: [retrieval_preprocessing] calculating distances ...
2025-03-12 17:59:54: [retrieval_preprocessing] finished and saved retrieval indices for episode 9 [episode count 9/19]
[retrieval_preprocessing] for episode 10 [episode count 10/19], we have num_retrieval=np.int64(2247) num_query=np.int64(93)
2025-03-12 17:59:54,500 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-12 17:59:54,749 [INFO]: Launching the whole pipeline 03/12/2025, 17:59:54
2025-03-12 17:59:54,749 [INFO]: Reading total number of vectors and dimension 03/12/2025, 17:59:54
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 2131.25it/s]
2025-03-12 17:59:54,778 [INFO]: There are 2247 embeddings of dim 49152
2025-03-12 17:59:54,778 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0288 secs
2025-03-12 17:59:54,778 [INFO]: 	Compute estimated construction time of the index 03/12/2025, 17:59:54
2025-03-12 17:59:54,779 [INFO]: 		-> Train: 16.7 minutes
2025-03-12 17:59:54,779 [INFO]: 		-> Add: 1.2 seconds
2025-03-12 17:59:54,779 [INFO]: 		Total: 16.7 minutes
2025-03-12 17:59:54,779 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0004 secs
2025-03-12 17:59:54,779 [INFO]: 	Checking that your have enough memory available to create the index 03/12/2025, 17:59:54
2025-03-12 17:59:54,779 [INFO]: 463.7MB of memory will be needed to build the index (more might be used if you have more)
2025-03-12 17:59:54,779 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0003 secs
2025-03-12 17:59:54,779 [INFO]: 	Selecting most promising index types given data characteristics 03/12/2025, 17:59:54
2025-03-12 17:59:54,780 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-12 17:59:54,780 [INFO]: 	Creating the index 03/12/2025, 17:59:54
2025-03-12 17:59:54,780 [INFO]: 		-> Instanciate the index HNSW15 03/12/2025, 17:59:54
2025-03-12 17:59:54,783 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0029 secs
2025-03-12 17:59:54,783 [INFO]: 		-> Adding the vectors to the index 03/12/2025, 17:59:54
2025-03-12 17:59:54,783 [INFO]: The memory available for adding the vectors is 49.6GB(total available - used by the index)
2025-03-12 17:59:54,783 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/9 [00:00<?, ?it/s] 44%|████▍     | 4/9 [00:00<00:00, 37.57it/s]100%|██████████| 9/9 [00:01<00:00,  6.14it/s]100%|██████████| 9/9 [00:01<00:00,  6.91it/s]
2025-03-12 17:59:56,092 [INFO]: 	Computing best hyperparameters for index knn.index 03/12/2025, 17:59:56
2025-03-12 18:00:23,057 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 26.9648 secs
2025-03-12 18:00:23,057 [INFO]: The best hyperparameters are: efSearch=308
2025-03-12 18:00:23,057 [INFO]: 	Compute fast metrics 03/12/2025, 18:00:23
  0%|          | 0/4 [00:00<?, ?it/s] 75%|███████▌  | 3/4 [00:00<00:00, 27.47it/s]
2025-03-12 18:00:35,745 [INFO]: 	>>> Finished "Compute fast metrics" in 12.6877 secs
2025-03-12 18:00:35,746 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 40.9631 secs
2025-03-12 18:00:35,746 [INFO]: {
2025-03-12 18:00:35,746 [INFO]: 	index_key: HNSW15
2025-03-12 18:00:35,746 [INFO]: 	index_param: efSearch=308
2025-03-12 18:00:35,746 [INFO]: 	index_path: knn.index
2025-03-12 18:00:35,746 [INFO]: 	size in bytes: 442083490
2025-03-12 18:00:35,746 [INFO]: 	avg_search_speed_ms: 10.22754922906291
2025-03-12 18:00:35,746 [INFO]: 	99p_search_speed_ms: 13.117664207238704
2025-03-12 18:00:35,746 [INFO]: 	reconstruction error %: 0.0
2025-03-12 18:00:35,746 [INFO]: 	nb vectors: 2247
2025-03-12 18:00:35,746 [INFO]: 	vectors dimension: 49152
2025-03-12 18:00:35,746 [INFO]: 	compression ratio: 0.9993093747970547
2025-03-12 18:00:35,746 [INFO]: }
2025-03-12 18:00:35,746 [INFO]: 	>>> Finished "Creating the index" in 40.9668 secs
2025-03-12 18:00:35,746 [INFO]: >>> Finished "Launching the whole pipeline" in 40.9970 secs
2025-03-12 18:00:36: [retrieval_preprocessing] calculating distances ...
2025-03-12 18:00:36: [retrieval_preprocessing] finished and saved retrieval indices for episode 10 [episode count 10/19]
[retrieval_preprocessing] for episode 11 [episode count 11/19], we have num_retrieval=np.int64(2270) num_query=np.int64(70)
2025-03-12 18:00:36,812 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-12 18:00:37,063 [INFO]: Launching the whole pipeline 03/12/2025, 18:00:37
2025-03-12 18:00:37,063 [INFO]: Reading total number of vectors and dimension 03/12/2025, 18:00:37
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1584.55it/s]
2025-03-12 18:00:37,090 [INFO]: There are 2270 embeddings of dim 49152
2025-03-12 18:00:37,090 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0274 secs
2025-03-12 18:00:37,090 [INFO]: 	Compute estimated construction time of the index 03/12/2025, 18:00:37
2025-03-12 18:00:37,090 [INFO]: 		-> Train: 16.7 minutes
2025-03-12 18:00:37,090 [INFO]: 		-> Add: 1.2 seconds
2025-03-12 18:00:37,090 [INFO]: 		Total: 16.7 minutes
2025-03-12 18:00:37,090 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0001 secs
2025-03-12 18:00:37,090 [INFO]: 	Checking that your have enough memory available to create the index 03/12/2025, 18:00:37
2025-03-12 18:00:37,090 [INFO]: 468.5MB of memory will be needed to build the index (more might be used if you have more)
2025-03-12 18:00:37,090 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0001 secs
2025-03-12 18:00:37,090 [INFO]: 	Selecting most promising index types given data characteristics 03/12/2025, 18:00:37
2025-03-12 18:00:37,091 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-12 18:00:37,091 [INFO]: 	Creating the index 03/12/2025, 18:00:37
2025-03-12 18:00:37,091 [INFO]: 		-> Instanciate the index HNSW15 03/12/2025, 18:00:37
2025-03-12 18:00:37,091 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0009 secs
2025-03-12 18:00:37,092 [INFO]: 		-> Adding the vectors to the index 03/12/2025, 18:00:37
2025-03-12 18:00:37,092 [INFO]: The memory available for adding the vectors is 49.6GB(total available - used by the index)
2025-03-12 18:00:37,092 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/9 [00:00<?, ?it/s] 22%|██▏       | 2/9 [00:00<00:00, 18.18it/s]100%|██████████| 9/9 [00:01<00:00,  5.69it/s]100%|██████████| 9/9 [00:01<00:00,  5.96it/s]
2025-03-12 18:00:38,606 [INFO]: 	Computing best hyperparameters for index knn.index 03/12/2025, 18:00:38
2025-03-12 18:01:01,369 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 22.7626 secs
2025-03-12 18:01:01,369 [INFO]: The best hyperparameters are: efSearch=307
2025-03-12 18:01:01,369 [INFO]: 	Compute fast metrics 03/12/2025, 18:01:01
  0%|          | 0/4 [00:00<?, ?it/s] 75%|███████▌  | 3/4 [00:00<00:00, 28.10it/s] 75%|███████▌  | 3/4 [00:00<00:00, 24.58it/s]
2025-03-12 18:01:12,621 [INFO]: 	>>> Finished "Compute fast metrics" in 11.2515 secs
2025-03-12 18:01:12,622 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 35.5304 secs
2025-03-12 18:01:12,622 [INFO]: {
2025-03-12 18:01:12,622 [INFO]: 	index_key: HNSW15
2025-03-12 18:01:12,622 [INFO]: 	index_param: efSearch=307
2025-03-12 18:01:12,622 [INFO]: 	index_path: knn.index
2025-03-12 18:01:12,622 [INFO]: 	size in bytes: 446608570
2025-03-12 18:01:12,622 [INFO]: 	avg_search_speed_ms: 10.837753379782047
2025-03-12 18:01:12,622 [INFO]: 	99p_search_speed_ms: 13.757149102166295
2025-03-12 18:01:12,622 [INFO]: 	reconstruction error %: 0.0
2025-03-12 18:01:12,622 [INFO]: 	nb vectors: 2270
2025-03-12 18:01:12,622 [INFO]: 	vectors dimension: 49152
2025-03-12 18:01:12,622 [INFO]: 	compression ratio: 0.9993094400315695
2025-03-12 18:01:12,622 [INFO]: }
2025-03-12 18:01:12,622 [INFO]: 	>>> Finished "Creating the index" in 35.5317 secs
2025-03-12 18:01:12,622 [INFO]: >>> Finished "Launching the whole pipeline" in 35.5595 secs
2025-03-12 18:01:13: [retrieval_preprocessing] calculating distances ...
2025-03-12 18:01:13: [retrieval_preprocessing] finished and saved retrieval indices for episode 11 [episode count 11/19]
[retrieval_preprocessing] for episode 12 [episode count 12/19], we have num_retrieval=np.int64(2246) num_query=np.int64(94)
2025-03-12 18:01:13,482 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-12 18:01:13,738 [INFO]: Launching the whole pipeline 03/12/2025, 18:01:13
2025-03-12 18:01:13,738 [INFO]: Reading total number of vectors and dimension 03/12/2025, 18:01:13
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1673.70it/s]
2025-03-12 18:01:13,767 [INFO]: There are 2246 embeddings of dim 49152
2025-03-12 18:01:13,767 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0294 secs
2025-03-12 18:01:13,767 [INFO]: 	Compute estimated construction time of the index 03/12/2025, 18:01:13
2025-03-12 18:01:13,768 [INFO]: 		-> Train: 16.7 minutes
2025-03-12 18:01:13,768 [INFO]: 		-> Add: 1.2 seconds
2025-03-12 18:01:13,768 [INFO]: 		Total: 16.7 minutes
2025-03-12 18:01:13,768 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0003 secs
2025-03-12 18:01:13,768 [INFO]: 	Checking that your have enough memory available to create the index 03/12/2025, 18:01:13
2025-03-12 18:01:13,768 [INFO]: 463.5MB of memory will be needed to build the index (more might be used if you have more)
2025-03-12 18:01:13,768 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0004 secs
2025-03-12 18:01:13,768 [INFO]: 	Selecting most promising index types given data characteristics 03/12/2025, 18:01:13
2025-03-12 18:01:13,768 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-12 18:01:13,768 [INFO]: 	Creating the index 03/12/2025, 18:01:13
2025-03-12 18:01:13,769 [INFO]: 		-> Instanciate the index HNSW15 03/12/2025, 18:01:13
2025-03-12 18:01:13,771 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0026 secs
2025-03-12 18:01:13,771 [INFO]: 		-> Adding the vectors to the index 03/12/2025, 18:01:13
2025-03-12 18:01:13,772 [INFO]: The memory available for adding the vectors is 49.6GB(total available - used by the index)
2025-03-12 18:01:13,772 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/9 [00:00<?, ?it/s] 33%|███▎      | 3/9 [00:00<00:00, 29.29it/s]100%|██████████| 9/9 [00:01<00:00,  5.50it/s]100%|██████████| 9/9 [00:01<00:00,  5.97it/s]
2025-03-12 18:01:15,285 [INFO]: 	Computing best hyperparameters for index knn.index 03/12/2025, 18:01:15
2025-03-12 18:01:37,587 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 22.3017 secs
2025-03-12 18:01:37,588 [INFO]: The best hyperparameters are: efSearch=298
2025-03-12 18:01:37,588 [INFO]: 	Compute fast metrics 03/12/2025, 18:01:37
  0%|          | 0/4 [00:00<?, ?it/s] 75%|███████▌  | 3/4 [00:00<00:00, 28.67it/s] 75%|███████▌  | 3/4 [00:00<00:00, 25.36it/s]
2025-03-12 18:01:49,171 [INFO]: 	>>> Finished "Compute fast metrics" in 11.5838 secs
2025-03-12 18:01:49,173 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 35.4010 secs
2025-03-12 18:01:49,173 [INFO]: {
2025-03-12 18:01:49,173 [INFO]: 	index_key: HNSW15
2025-03-12 18:01:49,173 [INFO]: 	index_param: efSearch=298
2025-03-12 18:01:49,173 [INFO]: 	index_path: knn.index
2025-03-12 18:01:49,173 [INFO]: 	size in bytes: 441886750
2025-03-12 18:01:49,173 [INFO]: 	avg_search_speed_ms: 9.917224083802818
2025-03-12 18:01:49,173 [INFO]: 	99p_search_speed_ms: 11.597289983183144
2025-03-12 18:01:49,173 [INFO]: 	reconstruction error %: 0.0
2025-03-12 18:01:49,173 [INFO]: 	nb vectors: 2246
2025-03-12 18:01:49,173 [INFO]: 	vectors dimension: 49152
2025-03-12 18:01:49,173 [INFO]: 	compression ratio: 0.9993093660310023
2025-03-12 18:01:49,173 [INFO]: }
2025-03-12 18:01:49,173 [INFO]: 	>>> Finished "Creating the index" in 35.4044 secs
2025-03-12 18:01:49,173 [INFO]: >>> Finished "Launching the whole pipeline" in 35.4352 secs
2025-03-12 18:01:49: [retrieval_preprocessing] calculating distances ...
2025-03-12 18:01:50: [retrieval_preprocessing] finished and saved retrieval indices for episode 12 [episode count 12/19]
[retrieval_preprocessing] for episode 13 [episode count 13/19], we have num_retrieval=np.int64(2245) num_query=np.int64(95)
2025-03-12 18:01:50,201 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-12 18:01:50,460 [INFO]: Launching the whole pipeline 03/12/2025, 18:01:50
2025-03-12 18:01:50,460 [INFO]: Reading total number of vectors and dimension 03/12/2025, 18:01:50
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1682.43it/s]
2025-03-12 18:01:50,487 [INFO]: There are 2245 embeddings of dim 49152
2025-03-12 18:01:50,487 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0275 secs
2025-03-12 18:01:50,488 [INFO]: 	Compute estimated construction time of the index 03/12/2025, 18:01:50
2025-03-12 18:01:50,488 [INFO]: 		-> Train: 16.7 minutes
2025-03-12 18:01:50,488 [INFO]: 		-> Add: 1.2 seconds
2025-03-12 18:01:50,488 [INFO]: 		Total: 16.7 minutes
2025-03-12 18:01:50,488 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0001 secs
2025-03-12 18:01:50,488 [INFO]: 	Checking that your have enough memory available to create the index 03/12/2025, 18:01:50
2025-03-12 18:01:50,488 [INFO]: 463.3MB of memory will be needed to build the index (more might be used if you have more)
2025-03-12 18:01:50,488 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0001 secs
2025-03-12 18:01:50,488 [INFO]: 	Selecting most promising index types given data characteristics 03/12/2025, 18:01:50
2025-03-12 18:01:50,488 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-12 18:01:50,488 [INFO]: 	Creating the index 03/12/2025, 18:01:50
2025-03-12 18:01:50,488 [INFO]: 		-> Instanciate the index HNSW15 03/12/2025, 18:01:50
2025-03-12 18:01:50,489 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0008 secs
2025-03-12 18:01:50,489 [INFO]: 		-> Adding the vectors to the index 03/12/2025, 18:01:50
2025-03-12 18:01:50,489 [INFO]: The memory available for adding the vectors is 49.6GB(total available - used by the index)
2025-03-12 18:01:50,489 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/9 [00:00<?, ?it/s] 22%|██▏       | 2/9 [00:00<00:00, 19.98it/s]100%|██████████| 9/9 [00:01<00:00,  5.76it/s]100%|██████████| 9/9 [00:01<00:00,  6.04it/s]
2025-03-12 18:01:51,981 [INFO]: 	Computing best hyperparameters for index knn.index 03/12/2025, 18:01:51
2025-03-12 18:02:15,511 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 23.5296 secs
2025-03-12 18:02:15,511 [INFO]: The best hyperparameters are: efSearch=291
2025-03-12 18:02:15,512 [INFO]: 	Compute fast metrics 03/12/2025, 18:02:15
  0%|          | 0/4 [00:00<?, ?it/s] 75%|███████▌  | 3/4 [00:00<00:00, 29.35it/s] 75%|███████▌  | 3/4 [00:00<00:00, 24.94it/s]
2025-03-12 18:02:26,753 [INFO]: 	>>> Finished "Compute fast metrics" in 11.2417 secs
2025-03-12 18:02:26,754 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 36.2655 secs
2025-03-12 18:02:26,755 [INFO]: {
2025-03-12 18:02:26,755 [INFO]: 	index_key: HNSW15
2025-03-12 18:02:26,755 [INFO]: 	index_param: efSearch=291
2025-03-12 18:02:26,755 [INFO]: 	index_path: knn.index
2025-03-12 18:02:26,755 [INFO]: 	size in bytes: 441690010
2025-03-12 18:02:26,755 [INFO]: 	avg_search_speed_ms: 10.093286876659747
2025-03-12 18:02:26,755 [INFO]: 	99p_search_speed_ms: 12.727065966464579
2025-03-12 18:02:26,755 [INFO]: 	reconstruction error %: 0.0
2025-03-12 18:02:26,755 [INFO]: 	nb vectors: 2245
2025-03-12 18:02:26,755 [INFO]: 	vectors dimension: 49152
2025-03-12 18:02:26,755 [INFO]: 	compression ratio: 0.9993093572571405
2025-03-12 18:02:26,755 [INFO]: }
2025-03-12 18:02:26,755 [INFO]: 	>>> Finished "Creating the index" in 36.2668 secs
2025-03-12 18:02:26,755 [INFO]: >>> Finished "Launching the whole pipeline" in 36.2948 secs
2025-03-12 18:02:27: [retrieval_preprocessing] calculating distances ...
2025-03-12 18:02:28: [retrieval_preprocessing] finished and saved retrieval indices for episode 13 [episode count 13/19]
[retrieval_preprocessing] for episode 14 [episode count 14/19], we have num_retrieval=np.int64(2079) num_query=np.int64(261)
2025-03-12 18:02:28,208 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-12 18:02:28,457 [INFO]: Launching the whole pipeline 03/12/2025, 18:02:28
2025-03-12 18:02:28,457 [INFO]: Reading total number of vectors and dimension 03/12/2025, 18:02:28
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 2191.38it/s]
2025-03-12 18:02:28,485 [INFO]: There are 2079 embeddings of dim 49152
2025-03-12 18:02:28,485 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0280 secs
2025-03-12 18:02:28,485 [INFO]: 	Compute estimated construction time of the index 03/12/2025, 18:02:28
2025-03-12 18:02:28,485 [INFO]: 		-> Train: 16.7 minutes
2025-03-12 18:02:28,485 [INFO]: 		-> Add: 1.1 seconds
2025-03-12 18:02:28,485 [INFO]: 		Total: 16.7 minutes
2025-03-12 18:02:28,485 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0001 secs
2025-03-12 18:02:28,485 [INFO]: 	Checking that your have enough memory available to create the index 03/12/2025, 18:02:28
2025-03-12 18:02:28,485 [INFO]: 429.1MB of memory will be needed to build the index (more might be used if you have more)
2025-03-12 18:02:28,485 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0001 secs
2025-03-12 18:02:28,485 [INFO]: 	Selecting most promising index types given data characteristics 03/12/2025, 18:02:28
2025-03-12 18:02:28,485 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-12 18:02:28,485 [INFO]: 	Creating the index 03/12/2025, 18:02:28
2025-03-12 18:02:28,485 [INFO]: 		-> Instanciate the index HNSW15 03/12/2025, 18:02:28
2025-03-12 18:02:28,486 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0009 secs
2025-03-12 18:02:28,486 [INFO]: 		-> Adding the vectors to the index 03/12/2025, 18:02:28
2025-03-12 18:02:28,486 [INFO]: The memory available for adding the vectors is 49.6GB(total available - used by the index)
2025-03-12 18:02:28,487 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/9 [00:00<?, ?it/s] 22%|██▏       | 2/9 [00:00<00:00, 19.88it/s]100%|██████████| 9/9 [00:01<00:00,  6.15it/s]100%|██████████| 9/9 [00:01<00:00,  6.44it/s]
2025-03-12 18:02:29,888 [INFO]: 	Computing best hyperparameters for index knn.index 03/12/2025, 18:02:29
2025-03-12 18:02:52,585 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 22.6968 secs
2025-03-12 18:02:52,585 [INFO]: The best hyperparameters are: efSearch=297
2025-03-12 18:02:52,585 [INFO]: 	Compute fast metrics 03/12/2025, 18:02:52
  0%|          | 0/4 [00:00<?, ?it/s] 75%|███████▌  | 3/4 [00:00<00:00, 28.23it/s] 75%|███████▌  | 3/4 [00:00<00:00, 25.01it/s]
2025-03-12 18:03:03,752 [INFO]: 	>>> Finished "Compute fast metrics" in 11.1670 secs
2025-03-12 18:03:03,753 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 35.2668 secs
2025-03-12 18:03:03,753 [INFO]: {
2025-03-12 18:03:03,753 [INFO]: 	index_key: HNSW15
2025-03-12 18:03:03,753 [INFO]: 	index_param: efSearch=297
2025-03-12 18:03:03,753 [INFO]: 	index_path: knn.index
2025-03-12 18:03:03,753 [INFO]: 	size in bytes: 409030630
2025-03-12 18:03:03,753 [INFO]: 	avg_search_speed_ms: 9.503917993689337
2025-03-12 18:03:03,753 [INFO]: 	99p_search_speed_ms: 11.351954452693464
2025-03-12 18:03:03,753 [INFO]: 	reconstruction error %: 0.0
2025-03-12 18:03:03,754 [INFO]: 	nb vectors: 2079
2025-03-12 18:03:03,754 [INFO]: 	vectors dimension: 49152
2025-03-12 18:03:03,754 [INFO]: 	compression ratio: 0.9993091030859963
2025-03-12 18:03:03,754 [INFO]: }
2025-03-12 18:03:03,754 [INFO]: 	>>> Finished "Creating the index" in 35.2681 secs
2025-03-12 18:03:03,754 [INFO]: >>> Finished "Launching the whole pipeline" in 35.2967 secs
2025-03-12 18:03:05: [retrieval_preprocessing] calculating distances ...
2025-03-12 18:03:06: [retrieval_preprocessing] finished and saved retrieval indices for episode 14 [episode count 14/19]
[retrieval_preprocessing] for episode 15 [episode count 15/19], we have num_retrieval=np.int64(2240) num_query=np.int64(100)
2025-03-12 18:03:06,211 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-12 18:03:06,468 [INFO]: Launching the whole pipeline 03/12/2025, 18:03:06
2025-03-12 18:03:06,468 [INFO]: Reading total number of vectors and dimension 03/12/2025, 18:03:06
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 2259.86it/s]
2025-03-12 18:03:06,495 [INFO]: There are 2240 embeddings of dim 49152
2025-03-12 18:03:06,495 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0270 secs
2025-03-12 18:03:06,495 [INFO]: 	Compute estimated construction time of the index 03/12/2025, 18:03:06
2025-03-12 18:03:06,496 [INFO]: 		-> Train: 16.7 minutes
2025-03-12 18:03:06,496 [INFO]: 		-> Add: 1.2 seconds
2025-03-12 18:03:06,496 [INFO]: 		Total: 16.7 minutes
2025-03-12 18:03:06,496 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0001 secs
2025-03-12 18:03:06,496 [INFO]: 	Checking that your have enough memory available to create the index 03/12/2025, 18:03:06
2025-03-12 18:03:06,496 [INFO]: 462.3MB of memory will be needed to build the index (more might be used if you have more)
2025-03-12 18:03:06,496 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0001 secs
2025-03-12 18:03:06,496 [INFO]: 	Selecting most promising index types given data characteristics 03/12/2025, 18:03:06
2025-03-12 18:03:06,496 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-12 18:03:06,496 [INFO]: 	Creating the index 03/12/2025, 18:03:06
2025-03-12 18:03:06,496 [INFO]: 		-> Instanciate the index HNSW15 03/12/2025, 18:03:06
2025-03-12 18:03:06,497 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0008 secs
2025-03-12 18:03:06,497 [INFO]: 		-> Adding the vectors to the index 03/12/2025, 18:03:06
2025-03-12 18:03:06,497 [INFO]: The memory available for adding the vectors is 49.6GB(total available - used by the index)
2025-03-12 18:03:06,497 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/9 [00:00<?, ?it/s] 33%|███▎      | 3/9 [00:00<00:00, 26.71it/s]100%|██████████| 9/9 [00:01<00:00,  5.48it/s]100%|██████████| 9/9 [00:01<00:00,  5.95it/s]
2025-03-12 18:03:08,012 [INFO]: 	Computing best hyperparameters for index knn.index 03/12/2025, 18:03:08
2025-03-12 18:03:31,413 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 23.4001 secs
2025-03-12 18:03:31,413 [INFO]: The best hyperparameters are: efSearch=295
2025-03-12 18:03:31,413 [INFO]: 	Compute fast metrics 03/12/2025, 18:03:31
  0%|          | 0/4 [00:00<?, ?it/s] 75%|███████▌  | 3/4 [00:00<00:00, 28.58it/s] 75%|███████▌  | 3/4 [00:00<00:00, 25.21it/s]
2025-03-12 18:03:42,637 [INFO]: 	>>> Finished "Compute fast metrics" in 11.2236 secs
2025-03-12 18:03:42,638 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 36.1410 secs
2025-03-12 18:03:42,638 [INFO]: {
2025-03-12 18:03:42,638 [INFO]: 	index_key: HNSW15
2025-03-12 18:03:42,638 [INFO]: 	index_param: efSearch=295
2025-03-12 18:03:42,638 [INFO]: 	index_path: knn.index
2025-03-12 18:03:42,638 [INFO]: 	size in bytes: 440706310
2025-03-12 18:03:42,638 [INFO]: 	avg_search_speed_ms: 9.864955217002558
2025-03-12 18:03:42,638 [INFO]: 	99p_search_speed_ms: 11.849605557508767
2025-03-12 18:03:42,638 [INFO]: 	reconstruction error %: 0.0
2025-03-12 18:03:42,638 [INFO]: 	nb vectors: 2240
2025-03-12 18:03:42,638 [INFO]: 	vectors dimension: 49152
2025-03-12 18:03:42,638 [INFO]: 	compression ratio: 0.9993093132703273
2025-03-12 18:03:42,638 [INFO]: }
2025-03-12 18:03:42,638 [INFO]: 	>>> Finished "Creating the index" in 36.1423 secs
2025-03-12 18:03:42,638 [INFO]: >>> Finished "Launching the whole pipeline" in 36.1698 secs
2025-03-12 18:03:43: [retrieval_preprocessing] calculating distances ...
2025-03-12 18:03:43: [retrieval_preprocessing] finished and saved retrieval indices for episode 15 [episode count 15/19]
[retrieval_preprocessing] for episode 16 [episode count 16/19], we have num_retrieval=np.int64(2237) num_query=np.int64(103)
2025-03-12 18:03:43,739 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-12 18:03:43,994 [INFO]: Launching the whole pipeline 03/12/2025, 18:03:43
2025-03-12 18:03:43,995 [INFO]: Reading total number of vectors and dimension 03/12/2025, 18:03:43
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1887.63it/s]
2025-03-12 18:03:44,022 [INFO]: There are 2237 embeddings of dim 49152
2025-03-12 18:03:44,022 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0279 secs
2025-03-12 18:03:44,023 [INFO]: 	Compute estimated construction time of the index 03/12/2025, 18:03:44
2025-03-12 18:03:44,023 [INFO]: 		-> Train: 16.7 minutes
2025-03-12 18:03:44,023 [INFO]: 		-> Add: 1.2 seconds
2025-03-12 18:03:44,023 [INFO]: 		Total: 16.7 minutes
2025-03-12 18:03:44,023 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0001 secs
2025-03-12 18:03:44,023 [INFO]: 	Checking that your have enough memory available to create the index 03/12/2025, 18:03:44
2025-03-12 18:03:44,023 [INFO]: 461.7MB of memory will be needed to build the index (more might be used if you have more)
2025-03-12 18:03:44,023 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0002 secs
2025-03-12 18:03:44,023 [INFO]: 	Selecting most promising index types given data characteristics 03/12/2025, 18:03:44
2025-03-12 18:03:44,023 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-12 18:03:44,023 [INFO]: 	Creating the index 03/12/2025, 18:03:44
2025-03-12 18:03:44,023 [INFO]: 		-> Instanciate the index HNSW15 03/12/2025, 18:03:44
2025-03-12 18:03:44,024 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0009 secs
2025-03-12 18:03:44,024 [INFO]: 		-> Adding the vectors to the index 03/12/2025, 18:03:44
2025-03-12 18:03:44,024 [INFO]: The memory available for adding the vectors is 49.6GB(total available - used by the index)
2025-03-12 18:03:44,024 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/9 [00:00<?, ?it/s] 11%|█         | 1/9 [00:00<00:00,  9.09it/s] 89%|████████▉ | 8/9 [00:00<00:00, 42.43it/s]100%|██████████| 9/9 [00:01<00:00,  5.82it/s]
2025-03-12 18:03:45,574 [INFO]: 	Computing best hyperparameters for index knn.index 03/12/2025, 18:03:45
2025-03-12 18:04:08,485 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 22.9106 secs
2025-03-12 18:04:08,486 [INFO]: The best hyperparameters are: efSearch=259
2025-03-12 18:04:08,486 [INFO]: 	Compute fast metrics 03/12/2025, 18:04:08
  0%|          | 0/4 [00:00<?, ?it/s] 75%|███████▌  | 3/4 [00:00<00:00, 28.18it/s] 75%|███████▌  | 3/4 [00:00<00:00, 24.79it/s]
2025-03-12 18:04:20,041 [INFO]: 	>>> Finished "Compute fast metrics" in 11.5557 secs
2025-03-12 18:04:20,043 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 36.0185 secs
2025-03-12 18:04:20,043 [INFO]: {
2025-03-12 18:04:20,043 [INFO]: 	index_key: HNSW15
2025-03-12 18:04:20,043 [INFO]: 	index_param: efSearch=259
2025-03-12 18:04:20,043 [INFO]: 	index_path: knn.index
2025-03-12 18:04:20,043 [INFO]: 	size in bytes: 440116090
2025-03-12 18:04:20,043 [INFO]: 	avg_search_speed_ms: 8.97201057272909
2025-03-12 18:04:20,043 [INFO]: 	99p_search_speed_ms: 10.655637457966801
2025-03-12 18:04:20,043 [INFO]: 	reconstruction error %: 0.0
2025-03-12 18:04:20,043 [INFO]: 	nb vectors: 2237
2025-03-12 18:04:20,043 [INFO]: 	vectors dimension: 49152
2025-03-12 18:04:20,043 [INFO]: 	compression ratio: 0.9993092867838574
2025-03-12 18:04:20,043 [INFO]: }
2025-03-12 18:04:20,043 [INFO]: 	>>> Finished "Creating the index" in 36.0199 secs
2025-03-12 18:04:20,043 [INFO]: >>> Finished "Launching the whole pipeline" in 36.0484 secs
2025-03-12 18:04:20: [retrieval_preprocessing] calculating distances ...
2025-03-12 18:04:20: [retrieval_preprocessing] finished and saved retrieval indices for episode 16 [episode count 16/19]
[retrieval_preprocessing] for episode 17 [episode count 17/19], we have num_retrieval=np.int64(2184) num_query=np.int64(156)
2025-03-12 18:04:21,064 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-12 18:04:21,307 [INFO]: Launching the whole pipeline 03/12/2025, 18:04:21
2025-03-12 18:04:21,307 [INFO]: Reading total number of vectors and dimension 03/12/2025, 18:04:21
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 2368.33it/s]
2025-03-12 18:04:21,335 [INFO]: There are 2184 embeddings of dim 49152
2025-03-12 18:04:21,336 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0285 secs
2025-03-12 18:04:21,336 [INFO]: 	Compute estimated construction time of the index 03/12/2025, 18:04:21
2025-03-12 18:04:21,336 [INFO]: 		-> Train: 16.7 minutes
2025-03-12 18:04:21,336 [INFO]: 		-> Add: 1.2 seconds
2025-03-12 18:04:21,336 [INFO]: 		Total: 16.7 minutes
2025-03-12 18:04:21,336 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0003 secs
2025-03-12 18:04:21,336 [INFO]: 	Checking that your have enough memory available to create the index 03/12/2025, 18:04:21
2025-03-12 18:04:21,336 [INFO]: 450.7MB of memory will be needed to build the index (more might be used if you have more)
2025-03-12 18:04:21,337 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0005 secs
2025-03-12 18:04:21,337 [INFO]: 	Selecting most promising index types given data characteristics 03/12/2025, 18:04:21
2025-03-12 18:04:21,337 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-12 18:04:21,337 [INFO]: 	Creating the index 03/12/2025, 18:04:21
2025-03-12 18:04:21,337 [INFO]: 		-> Instanciate the index HNSW15 03/12/2025, 18:04:21
2025-03-12 18:04:21,340 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0025 secs
2025-03-12 18:04:21,340 [INFO]: 		-> Adding the vectors to the index 03/12/2025, 18:04:21
2025-03-12 18:04:21,340 [INFO]: The memory available for adding the vectors is 49.6GB(total available - used by the index)
2025-03-12 18:04:21,340 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/9 [00:00<?, ?it/s] 44%|████▍     | 4/9 [00:00<00:00, 35.90it/s]100%|██████████| 9/9 [00:01<00:00,  5.53it/s]100%|██████████| 9/9 [00:01<00:00,  6.23it/s]
2025-03-12 18:04:22,790 [INFO]: 	Computing best hyperparameters for index knn.index 03/12/2025, 18:04:22
2025-03-12 18:04:45,878 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 23.0876 secs
2025-03-12 18:04:45,878 [INFO]: The best hyperparameters are: efSearch=286
2025-03-12 18:04:45,878 [INFO]: 	Compute fast metrics 03/12/2025, 18:04:45
  0%|          | 0/4 [00:00<?, ?it/s] 75%|███████▌  | 3/4 [00:00<00:00, 25.97it/s]
2025-03-12 18:04:57,067 [INFO]: 	>>> Finished "Compute fast metrics" in 11.1891 secs
2025-03-12 18:04:57,069 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 35.7289 secs
2025-03-12 18:04:57,069 [INFO]: {
2025-03-12 18:04:57,069 [INFO]: 	index_key: HNSW15
2025-03-12 18:04:57,069 [INFO]: 	index_param: efSearch=286
2025-03-12 18:04:57,069 [INFO]: 	index_path: knn.index
2025-03-12 18:04:57,069 [INFO]: 	size in bytes: 429688750
2025-03-12 18:04:57,069 [INFO]: 	avg_search_speed_ms: 9.547393744809638
2025-03-12 18:04:57,069 [INFO]: 	99p_search_speed_ms: 12.355199551675467
2025-03-12 18:04:57,069 [INFO]: 	reconstruction error %: 0.0
2025-03-12 18:04:57,069 [INFO]: 	nb vectors: 2184
2025-03-12 18:04:57,069 [INFO]: 	vectors dimension: 49152
2025-03-12 18:04:57,069 [INFO]: 	compression ratio: 0.9993090859372046
2025-03-12 18:04:57,069 [INFO]: }
2025-03-12 18:04:57,069 [INFO]: 	>>> Finished "Creating the index" in 35.7321 secs
2025-03-12 18:04:57,069 [INFO]: >>> Finished "Launching the whole pipeline" in 35.7621 secs
2025-03-12 18:04:58: [retrieval_preprocessing] calculating distances ...
2025-03-12 18:04:58: [retrieval_preprocessing] finished and saved retrieval indices for episode 17 [episode count 17/19]
[retrieval_preprocessing] for episode 18 [episode count 18/19], we have num_retrieval=np.int64(2217) num_query=np.int64(123)
2025-03-12 18:04:58,481 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-12 18:04:58,730 [INFO]: Launching the whole pipeline 03/12/2025, 18:04:58
2025-03-12 18:04:58,730 [INFO]: Reading total number of vectors and dimension 03/12/2025, 18:04:58
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1276.42it/s]
2025-03-12 18:04:58,759 [INFO]: There are 2217 embeddings of dim 49152
2025-03-12 18:04:58,760 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0299 secs
2025-03-12 18:04:58,760 [INFO]: 	Compute estimated construction time of the index 03/12/2025, 18:04:58
2025-03-12 18:04:58,760 [INFO]: 		-> Train: 16.7 minutes
2025-03-12 18:04:58,760 [INFO]: 		-> Add: 1.2 seconds
2025-03-12 18:04:58,760 [INFO]: 		Total: 16.7 minutes
2025-03-12 18:04:58,760 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0001 secs
2025-03-12 18:04:58,760 [INFO]: 	Checking that your have enough memory available to create the index 03/12/2025, 18:04:58
2025-03-12 18:04:58,760 [INFO]: 457.5MB of memory will be needed to build the index (more might be used if you have more)
2025-03-12 18:04:58,760 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0002 secs
2025-03-12 18:04:58,760 [INFO]: 	Selecting most promising index types given data characteristics 03/12/2025, 18:04:58
2025-03-12 18:04:58,760 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-12 18:04:58,760 [INFO]: 	Creating the index 03/12/2025, 18:04:58
2025-03-12 18:04:58,760 [INFO]: 		-> Instanciate the index HNSW15 03/12/2025, 18:04:58
2025-03-12 18:04:58,761 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0009 secs
2025-03-12 18:04:58,761 [INFO]: 		-> Adding the vectors to the index 03/12/2025, 18:04:58
2025-03-12 18:04:58,761 [INFO]: The memory available for adding the vectors is 49.6GB(total available - used by the index)
2025-03-12 18:04:58,761 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/9 [00:00<?, ?it/s] 22%|██▏       | 2/9 [00:00<00:00, 17.96it/s]100%|██████████| 9/9 [00:01<00:00,  5.75it/s]100%|██████████| 9/9 [00:01<00:00,  6.02it/s]
2025-03-12 18:05:00,259 [INFO]: 	Computing best hyperparameters for index knn.index 03/12/2025, 18:05:00
2025-03-12 18:05:23,263 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 23.0033 secs
2025-03-12 18:05:23,263 [INFO]: The best hyperparameters are: efSearch=303
2025-03-12 18:05:23,263 [INFO]: 	Compute fast metrics 03/12/2025, 18:05:23
  0%|          | 0/4 [00:00<?, ?it/s] 75%|███████▌  | 3/4 [00:00<00:00, 28.68it/s] 75%|███████▌  | 3/4 [00:00<00:00, 25.50it/s]
2025-03-12 18:05:34,450 [INFO]: 	>>> Finished "Compute fast metrics" in 11.1865 secs
2025-03-12 18:05:34,451 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 35.6900 secs
2025-03-12 18:05:34,451 [INFO]: {
2025-03-12 18:05:34,451 [INFO]: 	index_key: HNSW15
2025-03-12 18:05:34,451 [INFO]: 	index_param: efSearch=303
2025-03-12 18:05:34,451 [INFO]: 	index_path: knn.index
2025-03-12 18:05:34,451 [INFO]: 	size in bytes: 436181290
2025-03-12 18:05:34,451 [INFO]: 	avg_search_speed_ms: 9.804239902901006
2025-03-12 18:05:34,451 [INFO]: 	99p_search_speed_ms: 11.598958938848227
2025-03-12 18:05:34,451 [INFO]: 	reconstruction error %: 0.0
2025-03-12 18:05:34,451 [INFO]: 	nb vectors: 2217
2025-03-12 18:05:34,451 [INFO]: 	vectors dimension: 49152
2025-03-12 18:05:34,451 [INFO]: 	compression ratio: 0.9993091083755564
2025-03-12 18:05:34,451 [INFO]: }
2025-03-12 18:05:34,451 [INFO]: 	>>> Finished "Creating the index" in 35.6913 secs
2025-03-12 18:05:34,451 [INFO]: >>> Finished "Launching the whole pipeline" in 35.7218 secs
2025-03-12 18:05:35: [retrieval_preprocessing] calculating distances ...
2025-03-12 18:05:35: [retrieval_preprocessing] finished and saved retrieval indices for episode 18 [episode count 18/19]
2025-03-12 18:05:35: [retrieval_preprocessing] finished for collected_demos_training/2025-03-10_pick_up_the_apple_and_put_it_in_the_bowl [chosen_id count 0/8]
2025-03-12 18:05:36: [retrieval_preprocessing] concatenated all embeddings and indices for 7 episodes for collected_demos_training/2025-03-10_pour_the_cup_of_pasta_into_the_bowl [chosen_id count 1/8]
2025-03-12 18:05:36: [retrieval_preprocessing] we have num_total=2224 embedding_dim=49152
[retrieval_preprocessing] for episode 19 [episode count 0/7], we have num_retrieval=np.int64(1849) num_query=np.int64(375)
2025-03-12 18:05:36,153 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-12 18:05:36,357 [INFO]: Launching the whole pipeline 03/12/2025, 18:05:36
2025-03-12 18:05:36,357 [INFO]: Reading total number of vectors and dimension 03/12/2025, 18:05:36
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 2349.75it/s]
2025-03-12 18:05:36,384 [INFO]: There are 1849 embeddings of dim 49152
2025-03-12 18:05:36,385 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0276 secs
2025-03-12 18:05:36,385 [INFO]: 	Compute estimated construction time of the index 03/12/2025, 18:05:36
2025-03-12 18:05:36,385 [INFO]: 		-> Train: 16.7 minutes
2025-03-12 18:05:36,385 [INFO]: 		-> Add: 1.0 seconds
2025-03-12 18:05:36,385 [INFO]: 		Total: 16.7 minutes
2025-03-12 18:05:36,385 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0001 secs
2025-03-12 18:05:36,385 [INFO]: 	Checking that your have enough memory available to create the index 03/12/2025, 18:05:36
2025-03-12 18:05:36,385 [INFO]: 381.6MB of memory will be needed to build the index (more might be used if you have more)
2025-03-12 18:05:36,385 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0001 secs
2025-03-12 18:05:36,385 [INFO]: 	Selecting most promising index types given data characteristics 03/12/2025, 18:05:36
2025-03-12 18:05:36,385 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-12 18:05:36,385 [INFO]: 	Creating the index 03/12/2025, 18:05:36
2025-03-12 18:05:36,385 [INFO]: 		-> Instanciate the index HNSW15 03/12/2025, 18:05:36
2025-03-12 18:05:36,386 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0007 secs
2025-03-12 18:05:36,386 [INFO]: 		-> Adding the vectors to the index 03/12/2025, 18:05:36
2025-03-12 18:05:36,386 [INFO]: The memory available for adding the vectors is 49.7GB(total available - used by the index)
2025-03-12 18:05:36,386 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/8 [00:00<?, ?it/s] 38%|███▊      | 3/8 [00:00<00:00, 26.03it/s]100%|██████████| 8/8 [00:01<00:00,  6.68it/s]100%|██████████| 8/8 [00:01<00:00,  7.28it/s]
2025-03-12 18:05:37,488 [INFO]: 	Computing best hyperparameters for index knn.index 03/12/2025, 18:05:37
2025-03-12 18:05:56,051 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 18.5628 secs
2025-03-12 18:05:56,051 [INFO]: The best hyperparameters are: efSearch=396
2025-03-12 18:05:56,051 [INFO]: 	Compute fast metrics 03/12/2025, 18:05:56
  0%|          | 0/4 [00:00<?, ?it/s] 75%|███████▌  | 3/4 [00:00<00:00, 29.43it/s] 75%|███████▌  | 3/4 [00:00<00:00, 25.93it/s]
2025-03-12 18:06:07,105 [INFO]: 	>>> Finished "Compute fast metrics" in 11.0537 secs
2025-03-12 18:06:07,106 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 30.7203 secs
2025-03-12 18:06:07,106 [INFO]: {
2025-03-12 18:06:07,106 [INFO]: 	index_key: HNSW15
2025-03-12 18:06:07,106 [INFO]: 	index_param: efSearch=396
2025-03-12 18:06:07,106 [INFO]: 	index_path: knn.index
2025-03-12 18:06:07,106 [INFO]: 	size in bytes: 363779470
2025-03-12 18:06:07,106 [INFO]: 	avg_search_speed_ms: 10.189658381299035
2025-03-12 18:06:07,106 [INFO]: 	99p_search_speed_ms: 12.250078660435967
2025-03-12 18:06:07,106 [INFO]: 	reconstruction error %: 0.0
2025-03-12 18:06:07,106 [INFO]: 	nb vectors: 1849
2025-03-12 18:06:07,106 [INFO]: 	vectors dimension: 49152
2025-03-12 18:06:07,106 [INFO]: 	compression ratio: 0.9993092573365946
2025-03-12 18:06:07,106 [INFO]: }
2025-03-12 18:06:07,106 [INFO]: 	>>> Finished "Creating the index" in 30.7214 secs
2025-03-12 18:06:07,107 [INFO]: >>> Finished "Launching the whole pipeline" in 30.7495 secs
2025-03-12 18:06:11: [retrieval_preprocessing] calculating distances ...
2025-03-12 18:06:12: [retrieval_preprocessing] finished and saved retrieval indices for episode 19 [episode count 0/7]
[retrieval_preprocessing] for episode 20 [episode count 1/7], we have num_retrieval=np.int64(1952) num_query=np.int64(272)
2025-03-12 18:06:12,240 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-12 18:06:12,460 [INFO]: Launching the whole pipeline 03/12/2025, 18:06:12
2025-03-12 18:06:12,460 [INFO]: Reading total number of vectors and dimension 03/12/2025, 18:06:12
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1977.51it/s]
2025-03-12 18:06:12,488 [INFO]: There are 1952 embeddings of dim 49152
2025-03-12 18:06:12,488 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0283 secs
2025-03-12 18:06:12,488 [INFO]: 	Compute estimated construction time of the index 03/12/2025, 18:06:12
2025-03-12 18:06:12,488 [INFO]: 		-> Train: 16.7 minutes
2025-03-12 18:06:12,488 [INFO]: 		-> Add: 1.1 seconds
2025-03-12 18:06:12,488 [INFO]: 		Total: 16.7 minutes
2025-03-12 18:06:12,488 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0001 secs
2025-03-12 18:06:12,488 [INFO]: 	Checking that your have enough memory available to create the index 03/12/2025, 18:06:12
2025-03-12 18:06:12,488 [INFO]: 402.8MB of memory will be needed to build the index (more might be used if you have more)
2025-03-12 18:06:12,488 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0001 secs
2025-03-12 18:06:12,488 [INFO]: 	Selecting most promising index types given data characteristics 03/12/2025, 18:06:12
2025-03-12 18:06:12,488 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-12 18:06:12,488 [INFO]: 	Creating the index 03/12/2025, 18:06:12
2025-03-12 18:06:12,488 [INFO]: 		-> Instanciate the index HNSW15 03/12/2025, 18:06:12
2025-03-12 18:06:12,489 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0010 secs
2025-03-12 18:06:12,489 [INFO]: 		-> Adding the vectors to the index 03/12/2025, 18:06:12
2025-03-12 18:06:12,490 [INFO]: The memory available for adding the vectors is 49.6GB(total available - used by the index)
2025-03-12 18:06:12,490 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/8 [00:00<?, ?it/s] 25%|██▌       | 2/8 [00:00<00:00, 19.10it/s]100%|██████████| 8/8 [00:01<00:00,  6.77it/s]100%|██████████| 8/8 [00:01<00:00,  7.10it/s]
2025-03-12 18:06:13,619 [INFO]: 	Computing best hyperparameters for index knn.index 03/12/2025, 18:06:13
2025-03-12 18:06:31,985 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 18.3652 secs
2025-03-12 18:06:31,985 [INFO]: The best hyperparameters are: efSearch=422
2025-03-12 18:06:31,985 [INFO]: 	Compute fast metrics 03/12/2025, 18:06:31
  0%|          | 0/4 [00:00<?, ?it/s] 75%|███████▌  | 3/4 [00:00<00:00, 28.71it/s] 75%|███████▌  | 3/4 [00:00<00:00, 25.15it/s]
2025-03-12 18:06:43,109 [INFO]: 	>>> Finished "Compute fast metrics" in 11.1236 secs
2025-03-12 18:06:43,110 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 30.6205 secs
2025-03-12 18:06:43,110 [INFO]: {
2025-03-12 18:06:43,110 [INFO]: 	index_key: HNSW15
2025-03-12 18:06:43,110 [INFO]: 	index_param: efSearch=422
2025-03-12 18:06:43,110 [INFO]: 	index_path: knn.index
2025-03-12 18:06:43,110 [INFO]: 	size in bytes: 384044350
2025-03-12 18:06:43,110 [INFO]: 	avg_search_speed_ms: 10.190142944071996
2025-03-12 18:06:43,110 [INFO]: 	99p_search_speed_ms: 12.103501607198266
2025-03-12 18:06:43,110 [INFO]: 	reconstruction error %: 0.0
2025-03-12 18:06:43,110 [INFO]: 	nb vectors: 1952
2025-03-12 18:06:43,110 [INFO]: 	vectors dimension: 49152
2025-03-12 18:06:43,110 [INFO]: 	compression ratio: 0.9993085850631575
2025-03-12 18:06:43,110 [INFO]: }
2025-03-12 18:06:43,110 [INFO]: 	>>> Finished "Creating the index" in 30.6218 secs
2025-03-12 18:06:43,110 [INFO]: >>> Finished "Launching the whole pipeline" in 30.6506 secs
2025-03-12 18:06:45: [retrieval_preprocessing] calculating distances ...
2025-03-12 18:06:46: [retrieval_preprocessing] finished and saved retrieval indices for episode 20 [episode count 1/7]
[retrieval_preprocessing] for episode 21 [episode count 2/7], we have num_retrieval=np.int64(1780) num_query=np.int64(444)
2025-03-12 18:06:46,764 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-12 18:06:46,963 [INFO]: Launching the whole pipeline 03/12/2025, 18:06:46
2025-03-12 18:06:46,963 [INFO]: Reading total number of vectors and dimension 03/12/2025, 18:06:46
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 2377.72it/s]
2025-03-12 18:06:46,991 [INFO]: There are 1780 embeddings of dim 49152
2025-03-12 18:06:46,991 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0279 secs
2025-03-12 18:06:46,991 [INFO]: 	Compute estimated construction time of the index 03/12/2025, 18:06:46
2025-03-12 18:06:46,991 [INFO]: 		-> Train: 16.7 minutes
2025-03-12 18:06:46,991 [INFO]: 		-> Add: 1.0 seconds
2025-03-12 18:06:46,991 [INFO]: 		Total: 16.7 minutes
2025-03-12 18:06:46,991 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0001 secs
2025-03-12 18:06:46,991 [INFO]: 	Checking that your have enough memory available to create the index 03/12/2025, 18:06:46
2025-03-12 18:06:46,991 [INFO]: 367.3MB of memory will be needed to build the index (more might be used if you have more)
2025-03-12 18:06:46,992 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0001 secs
2025-03-12 18:06:46,992 [INFO]: 	Selecting most promising index types given data characteristics 03/12/2025, 18:06:46
2025-03-12 18:06:46,992 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-12 18:06:46,992 [INFO]: 	Creating the index 03/12/2025, 18:06:46
2025-03-12 18:06:46,992 [INFO]: 		-> Instanciate the index HNSW15 03/12/2025, 18:06:46
2025-03-12 18:06:46,993 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0009 secs
2025-03-12 18:06:46,993 [INFO]: 		-> Adding the vectors to the index 03/12/2025, 18:06:46
2025-03-12 18:06:46,993 [INFO]: The memory available for adding the vectors is 49.7GB(total available - used by the index)
2025-03-12 18:06:46,993 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/8 [00:00<?, ?it/s] 38%|███▊      | 3/8 [00:00<00:00, 26.90it/s]100%|██████████| 8/8 [00:01<00:00,  6.70it/s]100%|██████████| 8/8 [00:01<00:00,  7.30it/s]
2025-03-12 18:06:48,091 [INFO]: 	Computing best hyperparameters for index knn.index 03/12/2025, 18:06:48
2025-03-12 18:07:05,434 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 17.3431 secs
2025-03-12 18:07:05,434 [INFO]: The best hyperparameters are: efSearch=457
2025-03-12 18:07:05,434 [INFO]: 	Compute fast metrics 03/12/2025, 18:07:05
  0%|          | 0/4 [00:00<?, ?it/s] 75%|███████▌  | 3/4 [00:00<00:00, 27.58it/s] 75%|███████▌  | 3/4 [00:00<00:00, 23.83it/s]
2025-03-12 18:07:16,679 [INFO]: 	>>> Finished "Compute fast metrics" in 11.2445 secs
2025-03-12 18:07:16,680 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 29.6875 secs
2025-03-12 18:07:16,680 [INFO]: {
2025-03-12 18:07:16,680 [INFO]: 	index_key: HNSW15
2025-03-12 18:07:16,680 [INFO]: 	index_param: efSearch=457
2025-03-12 18:07:16,680 [INFO]: 	index_path: knn.index
2025-03-12 18:07:16,680 [INFO]: 	size in bytes: 350204350
2025-03-12 18:07:16,680 [INFO]: 	avg_search_speed_ms: 10.333641573655889
2025-03-12 18:07:16,680 [INFO]: 	99p_search_speed_ms: 12.623477464076132
2025-03-12 18:07:16,680 [INFO]: 	reconstruction error %: 0.0
2025-03-12 18:07:16,680 [INFO]: 	nb vectors: 1780
2025-03-12 18:07:16,680 [INFO]: 	vectors dimension: 49152
2025-03-12 18:07:16,680 [INFO]: 	compression ratio: 0.9993086607861953
2025-03-12 18:07:16,680 [INFO]: }
2025-03-12 18:07:16,680 [INFO]: 	>>> Finished "Creating the index" in 29.6887 secs
2025-03-12 18:07:16,680 [INFO]: >>> Finished "Launching the whole pipeline" in 29.7171 secs
2025-03-12 18:07:21: [retrieval_preprocessing] calculating distances ...
2025-03-12 18:07:22: [retrieval_preprocessing] finished and saved retrieval indices for episode 21 [episode count 2/7]
[retrieval_preprocessing] for episode 22 [episode count 3/7], we have num_retrieval=np.int64(1956) num_query=np.int64(268)
2025-03-12 18:07:22,560 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-12 18:07:22,786 [INFO]: Launching the whole pipeline 03/12/2025, 18:07:22
2025-03-12 18:07:22,786 [INFO]: Reading total number of vectors and dimension 03/12/2025, 18:07:22
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 2344.50it/s]
2025-03-12 18:07:22,814 [INFO]: There are 1956 embeddings of dim 49152
2025-03-12 18:07:22,814 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0279 secs
2025-03-12 18:07:22,814 [INFO]: 	Compute estimated construction time of the index 03/12/2025, 18:07:22
2025-03-12 18:07:22,814 [INFO]: 		-> Train: 16.7 minutes
2025-03-12 18:07:22,814 [INFO]: 		-> Add: 1.1 seconds
2025-03-12 18:07:22,814 [INFO]: 		Total: 16.7 minutes
2025-03-12 18:07:22,814 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0001 secs
2025-03-12 18:07:22,814 [INFO]: 	Checking that your have enough memory available to create the index 03/12/2025, 18:07:22
2025-03-12 18:07:22,814 [INFO]: 403.7MB of memory will be needed to build the index (more might be used if you have more)
2025-03-12 18:07:22,814 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0001 secs
2025-03-12 18:07:22,814 [INFO]: 	Selecting most promising index types given data characteristics 03/12/2025, 18:07:22
2025-03-12 18:07:22,814 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-12 18:07:22,814 [INFO]: 	Creating the index 03/12/2025, 18:07:22
2025-03-12 18:07:22,814 [INFO]: 		-> Instanciate the index HNSW15 03/12/2025, 18:07:22
2025-03-12 18:07:22,815 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0008 secs
2025-03-12 18:07:22,815 [INFO]: 		-> Adding the vectors to the index 03/12/2025, 18:07:22
2025-03-12 18:07:22,815 [INFO]: The memory available for adding the vectors is 49.6GB(total available - used by the index)
2025-03-12 18:07:22,815 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/8 [00:00<?, ?it/s] 25%|██▌       | 2/8 [00:00<00:00, 19.73it/s]100%|██████████| 8/8 [00:01<00:00,  7.19it/s]100%|██████████| 8/8 [00:01<00:00,  7.54it/s]
2025-03-12 18:07:23,879 [INFO]: 	Computing best hyperparameters for index knn.index 03/12/2025, 18:07:23
2025-03-12 18:07:42,436 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 18.5570 secs
2025-03-12 18:07:42,437 [INFO]: The best hyperparameters are: efSearch=387
2025-03-12 18:07:42,437 [INFO]: 	Compute fast metrics 03/12/2025, 18:07:42
  0%|          | 0/4 [00:00<?, ?it/s] 75%|███████▌  | 3/4 [00:00<00:00, 27.47it/s] 75%|███████▌  | 3/4 [00:00<00:00, 24.15it/s]
2025-03-12 18:07:53,561 [INFO]: 	>>> Finished "Compute fast metrics" in 11.1247 secs
2025-03-12 18:07:53,563 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 30.7476 secs
2025-03-12 18:07:53,563 [INFO]: {
2025-03-12 18:07:53,563 [INFO]: 	index_key: HNSW15
2025-03-12 18:07:53,563 [INFO]: 	index_param: efSearch=387
2025-03-12 18:07:53,563 [INFO]: 	index_path: knn.index
2025-03-12 18:07:53,563 [INFO]: 	size in bytes: 384831310
2025-03-12 18:07:53,563 [INFO]: 	avg_search_speed_ms: 9.176668132561336
2025-03-12 18:07:53,563 [INFO]: 	99p_search_speed_ms: 11.307415121700615
2025-03-12 18:07:53,563 [INFO]: 	reconstruction error %: 0.0
2025-03-12 18:07:53,563 [INFO]: 	nb vectors: 1956
2025-03-12 18:07:53,563 [INFO]: 	vectors dimension: 49152
2025-03-12 18:07:53,563 [INFO]: 	compression ratio: 0.9993086269409835
2025-03-12 18:07:53,563 [INFO]: }
2025-03-12 18:07:53,563 [INFO]: 	>>> Finished "Creating the index" in 30.7488 secs
2025-03-12 18:07:53,563 [INFO]: >>> Finished "Launching the whole pipeline" in 30.7772 secs
2025-03-12 18:07:56: [retrieval_preprocessing] calculating distances ...
2025-03-12 18:07:56: [retrieval_preprocessing] finished and saved retrieval indices for episode 22 [episode count 3/7]
[retrieval_preprocessing] for episode 23 [episode count 4/7], we have num_retrieval=np.int64(2039) num_query=np.int64(185)
2025-03-12 18:07:57,094 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-12 18:07:57,346 [INFO]: Launching the whole pipeline 03/12/2025, 18:07:57
2025-03-12 18:07:57,346 [INFO]: Reading total number of vectors and dimension 03/12/2025, 18:07:57
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1548.28it/s]
2025-03-12 18:07:57,375 [INFO]: There are 2039 embeddings of dim 49152
2025-03-12 18:07:57,375 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0295 secs
2025-03-12 18:07:57,376 [INFO]: 	Compute estimated construction time of the index 03/12/2025, 18:07:57
2025-03-12 18:07:57,376 [INFO]: 		-> Train: 16.7 minutes
2025-03-12 18:07:57,376 [INFO]: 		-> Add: 1.1 seconds
2025-03-12 18:07:57,376 [INFO]: 		Total: 16.7 minutes
2025-03-12 18:07:57,376 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0001 secs
2025-03-12 18:07:57,376 [INFO]: 	Checking that your have enough memory available to create the index 03/12/2025, 18:07:57
2025-03-12 18:07:57,376 [INFO]: 420.8MB of memory will be needed to build the index (more might be used if you have more)
2025-03-12 18:07:57,376 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0001 secs
2025-03-12 18:07:57,376 [INFO]: 	Selecting most promising index types given data characteristics 03/12/2025, 18:07:57
2025-03-12 18:07:57,376 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-12 18:07:57,376 [INFO]: 	Creating the index 03/12/2025, 18:07:57
2025-03-12 18:07:57,376 [INFO]: 		-> Instanciate the index HNSW15 03/12/2025, 18:07:57
2025-03-12 18:07:57,377 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0010 secs
2025-03-12 18:07:57,377 [INFO]: 		-> Adding the vectors to the index 03/12/2025, 18:07:57
2025-03-12 18:07:57,377 [INFO]: The memory available for adding the vectors is 49.6GB(total available - used by the index)
2025-03-12 18:07:57,377 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/9 [00:00<?, ?it/s] 22%|██▏       | 2/9 [00:00<00:00, 18.35it/s]100%|██████████| 9/9 [00:01<00:00,  7.09it/s]100%|██████████| 9/9 [00:01<00:00,  7.38it/s]
2025-03-12 18:07:58,599 [INFO]: 	Computing best hyperparameters for index knn.index 03/12/2025, 18:07:58
2025-03-12 18:08:18,295 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 19.6951 secs
2025-03-12 18:08:18,295 [INFO]: The best hyperparameters are: efSearch=398
2025-03-12 18:08:18,295 [INFO]: 	Compute fast metrics 03/12/2025, 18:08:18
  0%|          | 0/4 [00:00<?, ?it/s] 75%|███████▌  | 3/4 [00:00<00:00, 27.45it/s] 75%|███████▌  | 3/4 [00:00<00:00, 23.86it/s]
2025-03-12 18:08:29,405 [INFO]: 	>>> Finished "Compute fast metrics" in 11.1098 secs
2025-03-12 18:08:29,406 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 32.0289 secs
2025-03-12 18:08:29,406 [INFO]: {
2025-03-12 18:08:29,406 [INFO]: 	index_key: HNSW15
2025-03-12 18:08:29,406 [INFO]: 	index_param: efSearch=398
2025-03-12 18:08:29,406 [INFO]: 	index_path: knn.index
2025-03-12 18:08:29,406 [INFO]: 	size in bytes: 401161030
2025-03-12 18:08:29,406 [INFO]: 	avg_search_speed_ms: 10.043722600068328
2025-03-12 18:08:29,406 [INFO]: 	99p_search_speed_ms: 12.732015200890599
2025-03-12 18:08:29,406 [INFO]: 	reconstruction error %: 0.0
2025-03-12 18:08:29,406 [INFO]: 	nb vectors: 2039
2025-03-12 18:08:29,406 [INFO]: 	vectors dimension: 49152
2025-03-12 18:08:29,406 [INFO]: 	compression ratio: 0.9993087115166696
2025-03-12 18:08:29,406 [INFO]: }
2025-03-12 18:08:29,406 [INFO]: 	>>> Finished "Creating the index" in 32.0302 secs
2025-03-12 18:08:29,406 [INFO]: >>> Finished "Launching the whole pipeline" in 32.0603 secs
2025-03-12 18:08:31: [retrieval_preprocessing] calculating distances ...
2025-03-12 18:08:31: [retrieval_preprocessing] finished and saved retrieval indices for episode 23 [episode count 4/7]
[retrieval_preprocessing] for episode 24 [episode count 5/7], we have num_retrieval=np.int64(1878) num_query=np.int64(346)
2025-03-12 18:08:31,873 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-12 18:08:32,081 [INFO]: Launching the whole pipeline 03/12/2025, 18:08:32
2025-03-12 18:08:32,081 [INFO]: Reading total number of vectors and dimension 03/12/2025, 18:08:32
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1992.54it/s]
2025-03-12 18:08:32,108 [INFO]: There are 1878 embeddings of dim 49152
2025-03-12 18:08:32,109 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0273 secs
2025-03-12 18:08:32,109 [INFO]: 	Compute estimated construction time of the index 03/12/2025, 18:08:32
2025-03-12 18:08:32,109 [INFO]: 		-> Train: 16.7 minutes
2025-03-12 18:08:32,109 [INFO]: 		-> Add: 1.0 seconds
2025-03-12 18:08:32,109 [INFO]: 		Total: 16.7 minutes
2025-03-12 18:08:32,109 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0001 secs
2025-03-12 18:08:32,109 [INFO]: 	Checking that your have enough memory available to create the index 03/12/2025, 18:08:32
2025-03-12 18:08:32,109 [INFO]: 387.6MB of memory will be needed to build the index (more might be used if you have more)
2025-03-12 18:08:32,109 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0001 secs
2025-03-12 18:08:32,109 [INFO]: 	Selecting most promising index types given data characteristics 03/12/2025, 18:08:32
2025-03-12 18:08:32,109 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-12 18:08:32,109 [INFO]: 	Creating the index 03/12/2025, 18:08:32
2025-03-12 18:08:32,109 [INFO]: 		-> Instanciate the index HNSW15 03/12/2025, 18:08:32
2025-03-12 18:08:32,110 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0008 secs
2025-03-12 18:08:32,110 [INFO]: 		-> Adding the vectors to the index 03/12/2025, 18:08:32
2025-03-12 18:08:32,110 [INFO]: The memory available for adding the vectors is 49.7GB(total available - used by the index)
2025-03-12 18:08:32,110 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/8 [00:00<?, ?it/s] 38%|███▊      | 3/8 [00:00<00:00, 26.21it/s]100%|██████████| 8/8 [00:01<00:00,  6.77it/s]100%|██████████| 8/8 [00:01<00:00,  7.37it/s]
2025-03-12 18:08:33,198 [INFO]: 	Computing best hyperparameters for index knn.index 03/12/2025, 18:08:33
2025-03-12 18:08:51,402 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 18.2039 secs
2025-03-12 18:08:51,402 [INFO]: The best hyperparameters are: efSearch=442
2025-03-12 18:08:51,403 [INFO]: 	Compute fast metrics 03/12/2025, 18:08:51
  0%|          | 0/4 [00:00<?, ?it/s] 75%|███████▌  | 3/4 [00:00<00:00, 28.00it/s] 75%|███████▌  | 3/4 [00:00<00:00, 24.84it/s]
2025-03-12 18:09:02,519 [INFO]: 	>>> Finished "Compute fast metrics" in 11.1168 secs
2025-03-12 18:09:02,520 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 30.4105 secs
2025-03-12 18:09:02,521 [INFO]: {
2025-03-12 18:09:02,521 [INFO]: 	index_key: HNSW15
2025-03-12 18:09:02,521 [INFO]: 	index_param: efSearch=442
2025-03-12 18:09:02,521 [INFO]: 	index_path: knn.index
2025-03-12 18:09:02,521 [INFO]: 	size in bytes: 369485230
2025-03-12 18:09:02,521 [INFO]: 	avg_search_speed_ms: 10.191502416593663
2025-03-12 18:09:02,521 [INFO]: 	99p_search_speed_ms: 12.045149817131456
2025-03-12 18:09:02,521 [INFO]: 	reconstruction error %: 0.0
2025-03-12 18:09:02,521 [INFO]: 	nb vectors: 1878
2025-03-12 18:09:02,521 [INFO]: 	vectors dimension: 49152
2025-03-12 18:09:02,521 [INFO]: 	compression ratio: 0.9993087518004441
2025-03-12 18:09:02,521 [INFO]: }
2025-03-12 18:09:02,521 [INFO]: 	>>> Finished "Creating the index" in 30.4117 secs
2025-03-12 18:09:02,521 [INFO]: >>> Finished "Launching the whole pipeline" in 30.4394 secs
2025-03-12 18:09:06: [retrieval_preprocessing] calculating distances ...
2025-03-12 18:09:07: [retrieval_preprocessing] finished and saved retrieval indices for episode 24 [episode count 5/7]
[retrieval_preprocessing] for episode 25 [episode count 6/7], we have num_retrieval=np.int64(1890) num_query=np.int64(334)
2025-03-12 18:09:07,151 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-12 18:09:07,361 [INFO]: Launching the whole pipeline 03/12/2025, 18:09:07
2025-03-12 18:09:07,361 [INFO]: Reading total number of vectors and dimension 03/12/2025, 18:09:07
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 2160.90it/s]
2025-03-12 18:09:07,388 [INFO]: There are 1890 embeddings of dim 49152
2025-03-12 18:09:07,388 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0265 secs
2025-03-12 18:09:07,388 [INFO]: 	Compute estimated construction time of the index 03/12/2025, 18:09:07
2025-03-12 18:09:07,388 [INFO]: 		-> Train: 16.7 minutes
2025-03-12 18:09:07,388 [INFO]: 		-> Add: 1.0 seconds
2025-03-12 18:09:07,388 [INFO]: 		Total: 16.7 minutes
2025-03-12 18:09:07,388 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0001 secs
2025-03-12 18:09:07,388 [INFO]: 	Checking that your have enough memory available to create the index 03/12/2025, 18:09:07
2025-03-12 18:09:07,388 [INFO]: 390.1MB of memory will be needed to build the index (more might be used if you have more)
2025-03-12 18:09:07,388 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0001 secs
2025-03-12 18:09:07,388 [INFO]: 	Selecting most promising index types given data characteristics 03/12/2025, 18:09:07
2025-03-12 18:09:07,388 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-12 18:09:07,388 [INFO]: 	Creating the index 03/12/2025, 18:09:07
2025-03-12 18:09:07,388 [INFO]: 		-> Instanciate the index HNSW15 03/12/2025, 18:09:07
2025-03-12 18:09:07,389 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0008 secs
2025-03-12 18:09:07,389 [INFO]: 		-> Adding the vectors to the index 03/12/2025, 18:09:07
2025-03-12 18:09:07,389 [INFO]: The memory available for adding the vectors is 49.7GB(total available - used by the index)
2025-03-12 18:09:07,389 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/8 [00:00<?, ?it/s] 38%|███▊      | 3/8 [00:00<00:00, 27.76it/s]100%|██████████| 8/8 [00:01<00:00,  6.79it/s]100%|██████████| 8/8 [00:01<00:00,  7.41it/s]
2025-03-12 18:09:08,472 [INFO]: 	Computing best hyperparameters for index knn.index 03/12/2025, 18:09:08
2025-03-12 18:09:26,507 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 18.0349 secs
2025-03-12 18:09:26,507 [INFO]: The best hyperparameters are: efSearch=432
2025-03-12 18:09:26,507 [INFO]: 	Compute fast metrics 03/12/2025, 18:09:26
  0%|          | 0/4 [00:00<?, ?it/s] 75%|███████▌  | 3/4 [00:00<00:00, 27.12it/s] 75%|███████▌  | 3/4 [00:00<00:00, 23.53it/s]
2025-03-12 18:09:37,600 [INFO]: 	>>> Finished "Compute fast metrics" in 11.0925 secs
2025-03-12 18:09:37,601 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 30.2113 secs
2025-03-12 18:09:37,601 [INFO]: {
2025-03-12 18:09:37,601 [INFO]: 	index_key: HNSW15
2025-03-12 18:09:37,601 [INFO]: 	index_param: efSearch=432
2025-03-12 18:09:37,601 [INFO]: 	index_path: knn.index
2025-03-12 18:09:37,601 [INFO]: 	size in bytes: 371846230
2025-03-12 18:09:37,601 [INFO]: 	avg_search_speed_ms: 10.072125694297126
2025-03-12 18:09:37,601 [INFO]: 	99p_search_speed_ms: 12.176589565351607
2025-03-12 18:09:37,601 [INFO]: 	reconstruction error %: 0.0
2025-03-12 18:09:37,601 [INFO]: 	nb vectors: 1890
2025-03-12 18:09:37,601 [INFO]: 	vectors dimension: 49152
2025-03-12 18:09:37,601 [INFO]: 	compression ratio: 0.9993085582715199
2025-03-12 18:09:37,601 [INFO]: }
2025-03-12 18:09:37,601 [INFO]: 	>>> Finished "Creating the index" in 30.2125 secs
2025-03-12 18:09:37,601 [INFO]: >>> Finished "Launching the whole pipeline" in 30.2396 secs
2025-03-12 18:09:41: [retrieval_preprocessing] calculating distances ...
2025-03-12 18:09:41: [retrieval_preprocessing] finished and saved retrieval indices for episode 25 [episode count 6/7]
2025-03-12 18:09:41: [retrieval_preprocessing] finished for collected_demos_training/2025-03-10_pour_the_cup_of_pasta_into_the_bowl [chosen_id count 1/8]
2025-03-12 18:09:42: [retrieval_preprocessing] concatenated all embeddings and indices for 20 episodes for collected_demos_training/2025-03-10_pick_up_the_duck_and_put_it_in_the_bowl [chosen_id count 2/8]
2025-03-12 18:09:42: [retrieval_preprocessing] we have num_total=1917 embedding_dim=49152
[retrieval_preprocessing] for episode 26 [episode count 0/20], we have num_retrieval=np.int64(1790) num_query=np.int64(127)
2025-03-12 18:09:42,541 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-12 18:09:42,739 [INFO]: Launching the whole pipeline 03/12/2025, 18:09:42
2025-03-12 18:09:42,739 [INFO]: Reading total number of vectors and dimension 03/12/2025, 18:09:42
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1685.14it/s]
2025-03-12 18:09:42,763 [INFO]: There are 1790 embeddings of dim 49152
2025-03-12 18:09:42,764 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0246 secs
2025-03-12 18:09:42,764 [INFO]: 	Compute estimated construction time of the index 03/12/2025, 18:09:42
2025-03-12 18:09:42,764 [INFO]: 		-> Train: 16.7 minutes
2025-03-12 18:09:42,764 [INFO]: 		-> Add: 1.0 seconds
2025-03-12 18:09:42,764 [INFO]: 		Total: 16.7 minutes
2025-03-12 18:09:42,764 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0001 secs
2025-03-12 18:09:42,764 [INFO]: 	Checking that your have enough memory available to create the index 03/12/2025, 18:09:42
2025-03-12 18:09:42,764 [INFO]: 369.4MB of memory will be needed to build the index (more might be used if you have more)
2025-03-12 18:09:42,764 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0001 secs
2025-03-12 18:09:42,764 [INFO]: 	Selecting most promising index types given data characteristics 03/12/2025, 18:09:42
2025-03-12 18:09:42,764 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-12 18:09:42,764 [INFO]: 	Creating the index 03/12/2025, 18:09:42
2025-03-12 18:09:42,764 [INFO]: 		-> Instanciate the index HNSW15 03/12/2025, 18:09:42
2025-03-12 18:09:42,765 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0008 secs
2025-03-12 18:09:42,765 [INFO]: 		-> Adding the vectors to the index 03/12/2025, 18:09:42
2025-03-12 18:09:42,765 [INFO]: The memory available for adding the vectors is 49.7GB(total available - used by the index)
2025-03-12 18:09:42,765 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/8 [00:00<?, ?it/s] 38%|███▊      | 3/8 [00:00<00:00, 28.07it/s]100%|██████████| 8/8 [00:01<00:00,  6.13it/s]100%|██████████| 8/8 [00:01<00:00,  6.71it/s]
2025-03-12 18:09:43,960 [INFO]: 	Computing best hyperparameters for index knn.index 03/12/2025, 18:09:43
2025-03-12 18:10:06,982 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 23.0211 secs
2025-03-12 18:10:06,982 [INFO]: The best hyperparameters are: efSearch=345
2025-03-12 18:10:06,982 [INFO]: 	Compute fast metrics 03/12/2025, 18:10:06
  0%|          | 0/4 [00:00<?, ?it/s] 75%|███████▌  | 3/4 [00:00<00:00, 27.66it/s] 75%|███████▌  | 3/4 [00:00<00:00, 24.05it/s]
2025-03-12 18:10:18,035 [INFO]: 	>>> Finished "Compute fast metrics" in 11.0525 secs
2025-03-12 18:10:18,036 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 35.2707 secs
2025-03-12 18:10:18,036 [INFO]: {
2025-03-12 18:10:18,036 [INFO]: 	index_key: HNSW15
2025-03-12 18:10:18,036 [INFO]: 	index_param: efSearch=345
2025-03-12 18:10:18,036 [INFO]: 	index_path: knn.index
2025-03-12 18:10:18,036 [INFO]: 	size in bytes: 352171750
2025-03-12 18:10:18,036 [INFO]: 	avg_search_speed_ms: 10.169607495114859
2025-03-12 18:10:18,036 [INFO]: 	99p_search_speed_ms: 13.67910117842257
2025-03-12 18:10:18,036 [INFO]: 	reconstruction error %: 0.0
2025-03-12 18:10:18,036 [INFO]: 	nb vectors: 1790
2025-03-12 18:10:18,036 [INFO]: 	vectors dimension: 49152
2025-03-12 18:10:18,036 [INFO]: 	compression ratio: 0.9993087747668573
2025-03-12 18:10:18,036 [INFO]: }
2025-03-12 18:10:18,036 [INFO]: 	>>> Finished "Creating the index" in 35.2719 secs
2025-03-12 18:10:18,036 [INFO]: >>> Finished "Launching the whole pipeline" in 35.2970 secs
2025-03-12 18:10:19: [retrieval_preprocessing] calculating distances ...
2025-03-12 18:10:19: [retrieval_preprocessing] finished and saved retrieval indices for episode 26 [episode count 0/20]
[retrieval_preprocessing] for episode 27 [episode count 1/20], we have num_retrieval=np.int64(1844) num_query=np.int64(73)
2025-03-12 18:10:19,747 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-12 18:10:19,954 [INFO]: Launching the whole pipeline 03/12/2025, 18:10:19
2025-03-12 18:10:19,954 [INFO]: Reading total number of vectors and dimension 03/12/2025, 18:10:19
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 2250.16it/s]
2025-03-12 18:10:19,979 [INFO]: There are 1844 embeddings of dim 49152
2025-03-12 18:10:19,979 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0252 secs
2025-03-12 18:10:19,979 [INFO]: 	Compute estimated construction time of the index 03/12/2025, 18:10:19
2025-03-12 18:10:19,979 [INFO]: 		-> Train: 16.7 minutes
2025-03-12 18:10:19,979 [INFO]: 		-> Add: 1.0 seconds
2025-03-12 18:10:19,979 [INFO]: 		Total: 16.7 minutes
2025-03-12 18:10:19,979 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0001 secs
2025-03-12 18:10:19,979 [INFO]: 	Checking that your have enough memory available to create the index 03/12/2025, 18:10:19
2025-03-12 18:10:19,980 [INFO]: 380.6MB of memory will be needed to build the index (more might be used if you have more)
2025-03-12 18:10:19,980 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0001 secs
2025-03-12 18:10:19,980 [INFO]: 	Selecting most promising index types given data characteristics 03/12/2025, 18:10:19
2025-03-12 18:10:19,980 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-12 18:10:19,980 [INFO]: 	Creating the index 03/12/2025, 18:10:19
2025-03-12 18:10:19,980 [INFO]: 		-> Instanciate the index HNSW15 03/12/2025, 18:10:19
2025-03-12 18:10:19,981 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0009 secs
2025-03-12 18:10:19,981 [INFO]: 		-> Adding the vectors to the index 03/12/2025, 18:10:19
2025-03-12 18:10:19,981 [INFO]: The memory available for adding the vectors is 49.7GB(total available - used by the index)
2025-03-12 18:10:19,981 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/8 [00:00<?, ?it/s] 25%|██▌       | 2/8 [00:00<00:00, 18.77it/s]100%|██████████| 8/8 [00:01<00:00,  6.21it/s]100%|██████████| 8/8 [00:01<00:00,  6.53it/s]
2025-03-12 18:10:21,208 [INFO]: 	Computing best hyperparameters for index knn.index 03/12/2025, 18:10:21
2025-03-12 18:10:41,306 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 20.0977 secs
2025-03-12 18:10:41,306 [INFO]: The best hyperparameters are: efSearch=356
2025-03-12 18:10:41,306 [INFO]: 	Compute fast metrics 03/12/2025, 18:10:41
  0%|          | 0/4 [00:00<?, ?it/s] 75%|███████▌  | 3/4 [00:00<00:00, 25.94it/s]
2025-03-12 18:10:52,354 [INFO]: 	>>> Finished "Compute fast metrics" in 11.0481 secs
2025-03-12 18:10:52,355 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 32.3744 secs
2025-03-12 18:10:52,355 [INFO]: {
2025-03-12 18:10:52,355 [INFO]: 	index_key: HNSW15
2025-03-12 18:10:52,355 [INFO]: 	index_param: efSearch=356
2025-03-12 18:10:52,355 [INFO]: 	index_path: knn.index
2025-03-12 18:10:52,355 [INFO]: 	size in bytes: 362795770
2025-03-12 18:10:52,355 [INFO]: 	avg_search_speed_ms: 10.853410689887507
2025-03-12 18:10:52,355 [INFO]: 	99p_search_speed_ms: 14.246376533992587
2025-03-12 18:10:52,355 [INFO]: 	reconstruction error %: 0.0
2025-03-12 18:10:52,355 [INFO]: 	nb vectors: 1844
2025-03-12 18:10:52,355 [INFO]: 	vectors dimension: 49152
2025-03-12 18:10:52,355 [INFO]: 	compression ratio: 0.9993092036326664
2025-03-12 18:10:52,355 [INFO]: }
2025-03-12 18:10:52,355 [INFO]: 	>>> Finished "Creating the index" in 32.3756 secs
2025-03-12 18:10:52,355 [INFO]: >>> Finished "Launching the whole pipeline" in 32.4013 secs
2025-03-12 18:10:53: [retrieval_preprocessing] calculating distances ...
2025-03-12 18:10:53: [retrieval_preprocessing] finished and saved retrieval indices for episode 27 [episode count 1/20]
[retrieval_preprocessing] for episode 28 [episode count 2/20], we have num_retrieval=np.int64(1828) num_query=np.int64(89)
2025-03-12 18:10:53,439 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-12 18:10:53,645 [INFO]: Launching the whole pipeline 03/12/2025, 18:10:53
2025-03-12 18:10:53,645 [INFO]: Reading total number of vectors and dimension 03/12/2025, 18:10:53
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 2448.51it/s]
2025-03-12 18:10:53,670 [INFO]: There are 1828 embeddings of dim 49152
2025-03-12 18:10:53,671 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0258 secs
2025-03-12 18:10:53,671 [INFO]: 	Compute estimated construction time of the index 03/12/2025, 18:10:53
2025-03-12 18:10:53,671 [INFO]: 		-> Train: 16.7 minutes
2025-03-12 18:10:53,671 [INFO]: 		-> Add: 1.0 seconds
2025-03-12 18:10:53,671 [INFO]: 		Total: 16.7 minutes
2025-03-12 18:10:53,671 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0003 secs
2025-03-12 18:10:53,671 [INFO]: 	Checking that your have enough memory available to create the index 03/12/2025, 18:10:53
2025-03-12 18:10:53,672 [INFO]: 377.3MB of memory will be needed to build the index (more might be used if you have more)
2025-03-12 18:10:53,672 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0003 secs
2025-03-12 18:10:53,672 [INFO]: 	Selecting most promising index types given data characteristics 03/12/2025, 18:10:53
2025-03-12 18:10:53,672 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-12 18:10:53,672 [INFO]: 	Creating the index 03/12/2025, 18:10:53
2025-03-12 18:10:53,672 [INFO]: 		-> Instanciate the index HNSW15 03/12/2025, 18:10:53
2025-03-12 18:10:53,675 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0026 secs
2025-03-12 18:10:53,675 [INFO]: 		-> Adding the vectors to the index 03/12/2025, 18:10:53
2025-03-12 18:10:53,675 [INFO]: The memory available for adding the vectors is 49.7GB(total available - used by the index)
2025-03-12 18:10:53,676 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/8 [00:00<?, ?it/s] 50%|█████     | 4/8 [00:00<00:00, 36.77it/s]100%|██████████| 8/8 [00:01<00:00,  5.88it/s]100%|██████████| 8/8 [00:01<00:00,  6.72it/s]
2025-03-12 18:10:54,871 [INFO]: 	Computing best hyperparameters for index knn.index 03/12/2025, 18:10:54
2025-03-12 18:11:14,421 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 19.5500 secs
2025-03-12 18:11:14,422 [INFO]: The best hyperparameters are: efSearch=359
2025-03-12 18:11:14,422 [INFO]: 	Compute fast metrics 03/12/2025, 18:11:14
  0%|          | 0/4 [00:00<?, ?it/s] 75%|███████▌  | 3/4 [00:00<00:00, 28.04it/s]
2025-03-12 18:11:25,503 [INFO]: 	>>> Finished "Compute fast metrics" in 11.0813 secs
2025-03-12 18:11:25,504 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 31.8288 secs
2025-03-12 18:11:25,504 [INFO]: {
2025-03-12 18:11:25,504 [INFO]: 	index_key: HNSW15
2025-03-12 18:11:25,504 [INFO]: 	index_param: efSearch=359
2025-03-12 18:11:25,504 [INFO]: 	index_path: knn.index
2025-03-12 18:11:25,504 [INFO]: 	size in bytes: 359647930
2025-03-12 18:11:25,504 [INFO]: 	avg_search_speed_ms: 10.53712131245527
2025-03-12 18:11:25,504 [INFO]: 	99p_search_speed_ms: 14.104813840240238
2025-03-12 18:11:25,504 [INFO]: 	reconstruction error %: 0.0
2025-03-12 18:11:25,504 [INFO]: 	nb vectors: 1828
2025-03-12 18:11:25,504 [INFO]: 	vectors dimension: 49152
2025-03-12 18:11:25,504 [INFO]: 	compression ratio: 0.9993090298058993
2025-03-12 18:11:25,504 [INFO]: }
2025-03-12 18:11:25,504 [INFO]: 	>>> Finished "Creating the index" in 31.8322 secs
2025-03-12 18:11:25,504 [INFO]: >>> Finished "Launching the whole pipeline" in 31.8596 secs
2025-03-12 18:11:26: [retrieval_preprocessing] calculating distances ...
2025-03-12 18:11:26: [retrieval_preprocessing] finished and saved retrieval indices for episode 28 [episode count 2/20]
[retrieval_preprocessing] for episode 29 [episode count 3/20], we have num_retrieval=np.int64(1858) num_query=np.int64(59)
2025-03-12 18:11:26,794 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-12 18:11:27,005 [INFO]: Launching the whole pipeline 03/12/2025, 18:11:27
2025-03-12 18:11:27,005 [INFO]: Reading total number of vectors and dimension 03/12/2025, 18:11:27
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 2341.88it/s]
2025-03-12 18:11:27,034 [INFO]: There are 1858 embeddings of dim 49152
2025-03-12 18:11:27,034 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0287 secs
2025-03-12 18:11:27,034 [INFO]: 	Compute estimated construction time of the index 03/12/2025, 18:11:27
2025-03-12 18:11:27,035 [INFO]: 		-> Train: 16.7 minutes
2025-03-12 18:11:27,035 [INFO]: 		-> Add: 1.0 seconds
2025-03-12 18:11:27,035 [INFO]: 		Total: 16.7 minutes
2025-03-12 18:11:27,035 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0003 secs
2025-03-12 18:11:27,035 [INFO]: 	Checking that your have enough memory available to create the index 03/12/2025, 18:11:27
2025-03-12 18:11:27,035 [INFO]: 383.4MB of memory will be needed to build the index (more might be used if you have more)
2025-03-12 18:11:27,035 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0004 secs
2025-03-12 18:11:27,035 [INFO]: 	Selecting most promising index types given data characteristics 03/12/2025, 18:11:27
2025-03-12 18:11:27,036 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-12 18:11:27,036 [INFO]: 	Creating the index 03/12/2025, 18:11:27
2025-03-12 18:11:27,036 [INFO]: 		-> Instanciate the index HNSW15 03/12/2025, 18:11:27
2025-03-12 18:11:27,039 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0027 secs
2025-03-12 18:11:27,039 [INFO]: 		-> Adding the vectors to the index 03/12/2025, 18:11:27
2025-03-12 18:11:27,039 [INFO]: The memory available for adding the vectors is 49.7GB(total available - used by the index)
2025-03-12 18:11:27,039 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/8 [00:00<?, ?it/s] 50%|█████     | 4/8 [00:00<00:00, 35.97it/s]100%|██████████| 8/8 [00:01<00:00,  5.74it/s]100%|██████████| 8/8 [00:01<00:00,  6.56it/s]
2025-03-12 18:11:28,264 [INFO]: 	Computing best hyperparameters for index knn.index 03/12/2025, 18:11:28
2025-03-12 18:11:47,874 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 19.6099 secs
2025-03-12 18:11:47,874 [INFO]: The best hyperparameters are: efSearch=352
2025-03-12 18:11:47,874 [INFO]: 	Compute fast metrics 03/12/2025, 18:11:47
  0%|          | 0/4 [00:00<?, ?it/s] 75%|███████▌  | 3/4 [00:00<00:00, 26.83it/s]
2025-03-12 18:11:58,956 [INFO]: 	>>> Finished "Compute fast metrics" in 11.0821 secs
2025-03-12 18:11:58,957 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 31.9182 secs
2025-03-12 18:11:58,957 [INFO]: {
2025-03-12 18:11:58,957 [INFO]: 	index_key: HNSW15
2025-03-12 18:11:58,957 [INFO]: 	index_param: efSearch=352
2025-03-12 18:11:58,957 [INFO]: 	index_path: knn.index
2025-03-12 18:11:58,957 [INFO]: 	size in bytes: 365550250
2025-03-12 18:11:58,957 [INFO]: 	avg_search_speed_ms: 10.380949440056698
2025-03-12 18:11:58,958 [INFO]: 	99p_search_speed_ms: 13.903811215423048
2025-03-12 18:11:58,958 [INFO]: 	reconstruction error %: 0.0
2025-03-12 18:11:58,958 [INFO]: 	nb vectors: 1858
2025-03-12 18:11:58,958 [INFO]: 	vectors dimension: 49152
2025-03-12 18:11:58,958 [INFO]: 	compression ratio: 0.9993090252297735
2025-03-12 18:11:58,958 [INFO]: }
2025-03-12 18:11:58,958 [INFO]: 	>>> Finished "Creating the index" in 31.9218 secs
2025-03-12 18:11:58,958 [INFO]: >>> Finished "Launching the whole pipeline" in 31.9521 secs
2025-03-12 18:11:59: [retrieval_preprocessing] calculating distances ...
2025-03-12 18:11:59: [retrieval_preprocessing] finished and saved retrieval indices for episode 29 [episode count 3/20]
[retrieval_preprocessing] for episode 30 [episode count 4/20], we have num_retrieval=np.int64(1833) num_query=np.int64(84)
2025-03-12 18:11:59,836 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-12 18:12:00,043 [INFO]: Launching the whole pipeline 03/12/2025, 18:12:00
2025-03-12 18:12:00,043 [INFO]: Reading total number of vectors and dimension 03/12/2025, 18:12:00
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 2072.28it/s]
2025-03-12 18:12:00,068 [INFO]: There are 1833 embeddings of dim 49152
2025-03-12 18:12:00,068 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0253 secs
2025-03-12 18:12:00,069 [INFO]: 	Compute estimated construction time of the index 03/12/2025, 18:12:00
2025-03-12 18:12:00,069 [INFO]: 		-> Train: 16.7 minutes
2025-03-12 18:12:00,069 [INFO]: 		-> Add: 1.0 seconds
2025-03-12 18:12:00,069 [INFO]: 		Total: 16.7 minutes
2025-03-12 18:12:00,069 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0001 secs
2025-03-12 18:12:00,069 [INFO]: 	Checking that your have enough memory available to create the index 03/12/2025, 18:12:00
2025-03-12 18:12:00,069 [INFO]: 378.3MB of memory will be needed to build the index (more might be used if you have more)
2025-03-12 18:12:00,069 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0001 secs
2025-03-12 18:12:00,069 [INFO]: 	Selecting most promising index types given data characteristics 03/12/2025, 18:12:00
2025-03-12 18:12:00,069 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-12 18:12:00,069 [INFO]: 	Creating the index 03/12/2025, 18:12:00
2025-03-12 18:12:00,069 [INFO]: 		-> Instanciate the index HNSW15 03/12/2025, 18:12:00
2025-03-12 18:12:00,070 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0008 secs
2025-03-12 18:12:00,070 [INFO]: 		-> Adding the vectors to the index 03/12/2025, 18:12:00
2025-03-12 18:12:00,070 [INFO]: The memory available for adding the vectors is 49.7GB(total available - used by the index)
2025-03-12 18:12:00,070 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/8 [00:00<?, ?it/s] 25%|██▌       | 2/8 [00:00<00:00, 19.75it/s]100%|██████████| 8/8 [00:01<00:00,  6.24it/s]100%|██████████| 8/8 [00:01<00:00,  6.57it/s]
2025-03-12 18:12:01,291 [INFO]: 	Computing best hyperparameters for index knn.index 03/12/2025, 18:12:01
2025-03-12 18:12:21,780 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 20.4885 secs
2025-03-12 18:12:21,780 [INFO]: The best hyperparameters are: efSearch=346
2025-03-12 18:12:21,780 [INFO]: 	Compute fast metrics 03/12/2025, 18:12:21
  0%|          | 0/4 [00:00<?, ?it/s] 75%|███████▌  | 3/4 [00:00<00:00, 26.12it/s]
2025-03-12 18:12:32,868 [INFO]: 	>>> Finished "Compute fast metrics" in 11.0883 secs
2025-03-12 18:12:32,869 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 32.7995 secs
2025-03-12 18:12:32,869 [INFO]: {
2025-03-12 18:12:32,869 [INFO]: 	index_key: HNSW15
2025-03-12 18:12:32,869 [INFO]: 	index_param: efSearch=346
2025-03-12 18:12:32,869 [INFO]: 	index_path: knn.index
2025-03-12 18:12:32,869 [INFO]: 	size in bytes: 360631630
2025-03-12 18:12:32,870 [INFO]: 	avg_search_speed_ms: 10.458980019888198
2025-03-12 18:12:32,870 [INFO]: 	99p_search_speed_ms: 13.667904341127727
2025-03-12 18:12:32,870 [INFO]: 	reconstruction error %: 0.0
2025-03-12 18:12:32,870 [INFO]: 	nb vectors: 1833
2025-03-12 18:12:32,870 [INFO]: 	vectors dimension: 49152
2025-03-12 18:12:32,870 [INFO]: 	compression ratio: 0.999309084452742
2025-03-12 18:12:32,870 [INFO]: }
2025-03-12 18:12:32,870 [INFO]: 	>>> Finished "Creating the index" in 32.8007 secs
2025-03-12 18:12:32,870 [INFO]: >>> Finished "Launching the whole pipeline" in 32.8264 secs
2025-03-12 18:12:33: [retrieval_preprocessing] calculating distances ...
2025-03-12 18:12:33: [retrieval_preprocessing] finished and saved retrieval indices for episode 30 [episode count 4/20]
[retrieval_preprocessing] for episode 31 [episode count 5/20], we have num_retrieval=np.int64(1811) num_query=np.int64(106)
2025-03-12 18:12:34,005 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-12 18:12:34,206 [INFO]: Launching the whole pipeline 03/12/2025, 18:12:34
2025-03-12 18:12:34,206 [INFO]: Reading total number of vectors and dimension 03/12/2025, 18:12:34
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 2391.28it/s]
2025-03-12 18:12:34,232 [INFO]: There are 1811 embeddings of dim 49152
2025-03-12 18:12:34,232 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0259 secs
2025-03-12 18:12:34,232 [INFO]: 	Compute estimated construction time of the index 03/12/2025, 18:12:34
2025-03-12 18:12:34,232 [INFO]: 		-> Train: 16.7 minutes
2025-03-12 18:12:34,232 [INFO]: 		-> Add: 1.0 seconds
2025-03-12 18:12:34,232 [INFO]: 		Total: 16.7 minutes
2025-03-12 18:12:34,232 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0001 secs
2025-03-12 18:12:34,232 [INFO]: 	Checking that your have enough memory available to create the index 03/12/2025, 18:12:34
2025-03-12 18:12:34,233 [INFO]: 373.7MB of memory will be needed to build the index (more might be used if you have more)
2025-03-12 18:12:34,233 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0001 secs
2025-03-12 18:12:34,233 [INFO]: 	Selecting most promising index types given data characteristics 03/12/2025, 18:12:34
2025-03-12 18:12:34,233 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-12 18:12:34,233 [INFO]: 	Creating the index 03/12/2025, 18:12:34
2025-03-12 18:12:34,233 [INFO]: 		-> Instanciate the index HNSW15 03/12/2025, 18:12:34
2025-03-12 18:12:34,234 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0009 secs
2025-03-12 18:12:34,234 [INFO]: 		-> Adding the vectors to the index 03/12/2025, 18:12:34
2025-03-12 18:12:34,234 [INFO]: The memory available for adding the vectors is 49.7GB(total available - used by the index)
2025-03-12 18:12:34,234 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/8 [00:00<?, ?it/s] 38%|███▊      | 3/8 [00:00<00:00, 27.12it/s]100%|██████████| 8/8 [00:01<00:00,  6.13it/s]100%|██████████| 8/8 [00:01<00:00,  6.71it/s]
2025-03-12 18:12:35,429 [INFO]: 	Computing best hyperparameters for index knn.index 03/12/2025, 18:12:35
2025-03-12 18:12:54,803 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 19.3734 secs
2025-03-12 18:12:54,803 [INFO]: The best hyperparameters are: efSearch=352
2025-03-12 18:12:54,803 [INFO]: 	Compute fast metrics 03/12/2025, 18:12:54
  0%|          | 0/4 [00:00<?, ?it/s] 75%|███████▌  | 3/4 [00:00<00:00, 28.33it/s] 75%|███████▌  | 3/4 [00:00<00:00, 24.59it/s]
2025-03-12 18:13:05,889 [INFO]: 	>>> Finished "Compute fast metrics" in 11.0854 secs
2025-03-12 18:13:05,890 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 31.6559 secs
2025-03-12 18:13:05,890 [INFO]: {
2025-03-12 18:13:05,890 [INFO]: 	index_key: HNSW15
2025-03-12 18:13:05,890 [INFO]: 	index_param: efSearch=352
2025-03-12 18:13:05,890 [INFO]: 	index_path: knn.index
2025-03-12 18:13:05,890 [INFO]: 	size in bytes: 356303350
2025-03-12 18:13:05,890 [INFO]: 	avg_search_speed_ms: 10.344188780771354
2025-03-12 18:13:05,890 [INFO]: 	99p_search_speed_ms: 13.494190941564742
2025-03-12 18:13:05,890 [INFO]: 	reconstruction error %: 0.0
2025-03-12 18:13:05,890 [INFO]: 	nb vectors: 1811
2025-03-12 18:13:05,890 [INFO]: 	vectors dimension: 49152
2025-03-12 18:13:05,890 [INFO]: 	compression ratio: 0.9993088417495934
2025-03-12 18:13:05,890 [INFO]: }
2025-03-12 18:13:05,890 [INFO]: 	>>> Finished "Creating the index" in 31.6572 secs
2025-03-12 18:13:05,890 [INFO]: >>> Finished "Launching the whole pipeline" in 31.6836 secs
2025-03-12 18:13:07: [retrieval_preprocessing] calculating distances ...
2025-03-12 18:13:07: [retrieval_preprocessing] finished and saved retrieval indices for episode 31 [episode count 5/20]
[retrieval_preprocessing] for episode 32 [episode count 6/20], we have num_retrieval=np.int64(1832) num_query=np.int64(85)
2025-03-12 18:13:07,430 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-12 18:13:07,640 [INFO]: Launching the whole pipeline 03/12/2025, 18:13:07
2025-03-12 18:13:07,640 [INFO]: Reading total number of vectors and dimension 03/12/2025, 18:13:07
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1683.78it/s]
2025-03-12 18:13:07,668 [INFO]: There are 1832 embeddings of dim 49152
2025-03-12 18:13:07,668 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0281 secs
2025-03-12 18:13:07,668 [INFO]: 	Compute estimated construction time of the index 03/12/2025, 18:13:07
2025-03-12 18:13:07,668 [INFO]: 		-> Train: 16.7 minutes
2025-03-12 18:13:07,668 [INFO]: 		-> Add: 1.0 seconds
2025-03-12 18:13:07,668 [INFO]: 		Total: 16.7 minutes
2025-03-12 18:13:07,668 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0001 secs
2025-03-12 18:13:07,668 [INFO]: 	Checking that your have enough memory available to create the index 03/12/2025, 18:13:07
2025-03-12 18:13:07,668 [INFO]: 378.1MB of memory will be needed to build the index (more might be used if you have more)
2025-03-12 18:13:07,668 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0001 secs
2025-03-12 18:13:07,668 [INFO]: 	Selecting most promising index types given data characteristics 03/12/2025, 18:13:07
2025-03-12 18:13:07,668 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-12 18:13:07,669 [INFO]: 	Creating the index 03/12/2025, 18:13:07
2025-03-12 18:13:07,669 [INFO]: 		-> Instanciate the index HNSW15 03/12/2025, 18:13:07
2025-03-12 18:13:07,670 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0009 secs
2025-03-12 18:13:07,670 [INFO]: 		-> Adding the vectors to the index 03/12/2025, 18:13:07
2025-03-12 18:13:07,670 [INFO]: The memory available for adding the vectors is 49.7GB(total available - used by the index)
2025-03-12 18:13:07,670 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/8 [00:00<?, ?it/s] 25%|██▌       | 2/8 [00:00<00:00, 19.83it/s]100%|██████████| 8/8 [00:01<00:00,  6.09it/s]100%|██████████| 8/8 [00:01<00:00,  6.42it/s]
2025-03-12 18:13:08,919 [INFO]: 	Computing best hyperparameters for index knn.index 03/12/2025, 18:13:08
2025-03-12 18:13:29,168 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 20.2488 secs
2025-03-12 18:13:29,169 [INFO]: The best hyperparameters are: efSearch=349
2025-03-12 18:13:29,169 [INFO]: 	Compute fast metrics 03/12/2025, 18:13:29
  0%|          | 0/4 [00:00<?, ?it/s] 75%|███████▌  | 3/4 [00:00<00:00, 28.31it/s] 75%|███████▌  | 3/4 [00:00<00:00, 24.51it/s]
2025-03-12 18:13:40,223 [INFO]: 	>>> Finished "Compute fast metrics" in 11.0542 secs
2025-03-12 18:13:40,224 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 32.5545 secs
2025-03-12 18:13:40,224 [INFO]: {
2025-03-12 18:13:40,224 [INFO]: 	index_key: HNSW15
2025-03-12 18:13:40,224 [INFO]: 	index_param: efSearch=349
2025-03-12 18:13:40,224 [INFO]: 	index_path: knn.index
2025-03-12 18:13:40,224 [INFO]: 	size in bytes: 360434890
2025-03-12 18:13:40,224 [INFO]: 	avg_search_speed_ms: 10.184704355256303
2025-03-12 18:13:40,224 [INFO]: 	99p_search_speed_ms: 13.615017549600438
2025-03-12 18:13:40,224 [INFO]: 	reconstruction error %: 0.0
2025-03-12 18:13:40,224 [INFO]: 	nb vectors: 1832
2025-03-12 18:13:40,224 [INFO]: 	vectors dimension: 49152
2025-03-12 18:13:40,224 [INFO]: 	compression ratio: 0.9993090735472362
2025-03-12 18:13:40,224 [INFO]: }
2025-03-12 18:13:40,224 [INFO]: 	>>> Finished "Creating the index" in 32.5558 secs
2025-03-12 18:13:40,224 [INFO]: >>> Finished "Launching the whole pipeline" in 32.5844 secs
2025-03-12 18:13:41: [retrieval_preprocessing] calculating distances ...
2025-03-12 18:13:41: [retrieval_preprocessing] finished and saved retrieval indices for episode 32 [episode count 6/20]
[retrieval_preprocessing] for episode 33 [episode count 7/20], we have num_retrieval=np.int64(1702) num_query=np.int64(215)
2025-03-12 18:13:41,441 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-12 18:13:41,639 [INFO]: Launching the whole pipeline 03/12/2025, 18:13:41
2025-03-12 18:13:41,639 [INFO]: Reading total number of vectors and dimension 03/12/2025, 18:13:41
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1858.35it/s]
2025-03-12 18:13:41,667 [INFO]: There are 1702 embeddings of dim 49152
2025-03-12 18:13:41,667 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0276 secs
2025-03-12 18:13:41,667 [INFO]: 	Compute estimated construction time of the index 03/12/2025, 18:13:41
2025-03-12 18:13:41,667 [INFO]: 		-> Train: 16.7 minutes
2025-03-12 18:13:41,667 [INFO]: 		-> Add: 0.9 seconds
2025-03-12 18:13:41,667 [INFO]: 		Total: 16.7 minutes
2025-03-12 18:13:41,667 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0003 secs
2025-03-12 18:13:41,668 [INFO]: 	Checking that your have enough memory available to create the index 03/12/2025, 18:13:41
2025-03-12 18:13:41,668 [INFO]: 351.3MB of memory will be needed to build the index (more might be used if you have more)
2025-03-12 18:13:41,668 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0004 secs
2025-03-12 18:13:41,668 [INFO]: 	Selecting most promising index types given data characteristics 03/12/2025, 18:13:41
2025-03-12 18:13:41,668 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-12 18:13:41,668 [INFO]: 	Creating the index 03/12/2025, 18:13:41
2025-03-12 18:13:41,668 [INFO]: 		-> Instanciate the index HNSW15 03/12/2025, 18:13:41
2025-03-12 18:13:41,671 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0024 secs
2025-03-12 18:13:41,671 [INFO]: 		-> Adding the vectors to the index 03/12/2025, 18:13:41
2025-03-12 18:13:41,671 [INFO]: The memory available for adding the vectors is 49.7GB(total available - used by the index)
2025-03-12 18:13:41,671 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/7 [00:00<?, ?it/s] 43%|████▎     | 3/7 [00:00<00:00, 26.63it/s]100%|██████████| 7/7 [00:01<00:00,  5.00it/s]100%|██████████| 7/7 [00:01<00:00,  5.57it/s]
2025-03-12 18:13:42,933 [INFO]: 	Computing best hyperparameters for index knn.index 03/12/2025, 18:13:42
2025-03-12 18:14:01,832 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 18.8990 secs
2025-03-12 18:14:01,832 [INFO]: The best hyperparameters are: efSearch=368
2025-03-12 18:14:01,833 [INFO]: 	Compute fast metrics 03/12/2025, 18:14:01
  0%|          | 0/4 [00:00<?, ?it/s] 75%|███████▌  | 3/4 [00:00<00:00, 27.65it/s] 75%|███████▌  | 3/4 [00:00<00:00, 24.29it/s]
2025-03-12 18:14:12,818 [INFO]: 	>>> Finished "Compute fast metrics" in 10.9857 secs
2025-03-12 18:14:12,819 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 31.1482 secs
2025-03-12 18:14:12,819 [INFO]: {
2025-03-12 18:14:12,819 [INFO]: 	index_key: HNSW15
2025-03-12 18:14:12,819 [INFO]: 	index_param: efSearch=368
2025-03-12 18:14:12,820 [INFO]: 	index_path: knn.index
2025-03-12 18:14:12,820 [INFO]: 	size in bytes: 334858210
2025-03-12 18:14:12,820 [INFO]: 	avg_search_speed_ms: 9.843881957656448
2025-03-12 18:14:12,820 [INFO]: 	99p_search_speed_ms: 12.912669335491955
2025-03-12 18:14:12,820 [INFO]: 	reconstruction error %: 0.0
2025-03-12 18:14:12,820 [INFO]: 	nb vectors: 1702
2025-03-12 18:14:12,820 [INFO]: 	vectors dimension: 49152
2025-03-12 18:14:12,820 [INFO]: 	compression ratio: 0.999308979164644
2025-03-12 18:14:12,820 [INFO]: }
2025-03-12 18:14:12,820 [INFO]: 	>>> Finished "Creating the index" in 31.1514 secs
2025-03-12 18:14:12,820 [INFO]: >>> Finished "Launching the whole pipeline" in 31.1804 secs
2025-03-12 18:14:14: [retrieval_preprocessing] calculating distances ...
2025-03-12 18:14:15: [retrieval_preprocessing] finished and saved retrieval indices for episode 33 [episode count 7/20]
[retrieval_preprocessing] for episode 34 [episode count 8/20], we have num_retrieval=np.int64(1833) num_query=np.int64(84)
2025-03-12 18:14:15,255 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-12 18:14:15,468 [INFO]: Launching the whole pipeline 03/12/2025, 18:14:15
2025-03-12 18:14:15,468 [INFO]: Reading total number of vectors and dimension 03/12/2025, 18:14:15
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1881.70it/s]
2025-03-12 18:14:15,493 [INFO]: There are 1833 embeddings of dim 49152
2025-03-12 18:14:15,493 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0250 secs
2025-03-12 18:14:15,493 [INFO]: 	Compute estimated construction time of the index 03/12/2025, 18:14:15
2025-03-12 18:14:15,494 [INFO]: 		-> Train: 16.7 minutes
2025-03-12 18:14:15,494 [INFO]: 		-> Add: 1.0 seconds
2025-03-12 18:14:15,494 [INFO]: 		Total: 16.7 minutes
2025-03-12 18:14:15,494 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0001 secs
2025-03-12 18:14:15,494 [INFO]: 	Checking that your have enough memory available to create the index 03/12/2025, 18:14:15
2025-03-12 18:14:15,494 [INFO]: 378.3MB of memory will be needed to build the index (more might be used if you have more)
2025-03-12 18:14:15,494 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0001 secs
2025-03-12 18:14:15,494 [INFO]: 	Selecting most promising index types given data characteristics 03/12/2025, 18:14:15
2025-03-12 18:14:15,494 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-12 18:14:15,494 [INFO]: 	Creating the index 03/12/2025, 18:14:15
2025-03-12 18:14:15,494 [INFO]: 		-> Instanciate the index HNSW15 03/12/2025, 18:14:15
2025-03-12 18:14:15,495 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0010 secs
2025-03-12 18:14:15,495 [INFO]: 		-> Adding the vectors to the index 03/12/2025, 18:14:15
2025-03-12 18:14:15,495 [INFO]: The memory available for adding the vectors is 49.7GB(total available - used by the index)
2025-03-12 18:14:15,495 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/8 [00:00<?, ?it/s] 38%|███▊      | 3/8 [00:00<00:00, 28.55it/s]100%|██████████| 8/8 [00:01<00:00,  5.88it/s]100%|██████████| 8/8 [00:01<00:00,  6.45it/s]
2025-03-12 18:14:16,739 [INFO]: 	Computing best hyperparameters for index knn.index 03/12/2025, 18:14:16
2025-03-12 18:14:34,986 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 18.2473 secs
2025-03-12 18:14:34,987 [INFO]: The best hyperparameters are: efSearch=303
2025-03-12 18:14:34,987 [INFO]: 	Compute fast metrics 03/12/2025, 18:14:34
  0%|          | 0/4 [00:00<?, ?it/s] 75%|███████▌  | 3/4 [00:00<00:00, 28.17it/s] 75%|███████▌  | 3/4 [00:00<00:00, 24.41it/s]
2025-03-12 18:14:46,062 [INFO]: 	>>> Finished "Compute fast metrics" in 11.0747 secs
2025-03-12 18:14:46,063 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 30.5679 secs
2025-03-12 18:14:46,063 [INFO]: {
2025-03-12 18:14:46,063 [INFO]: 	index_key: HNSW15
2025-03-12 18:14:46,063 [INFO]: 	index_param: efSearch=303
2025-03-12 18:14:46,063 [INFO]: 	index_path: knn.index
2025-03-12 18:14:46,063 [INFO]: 	size in bytes: 360631630
2025-03-12 18:14:46,063 [INFO]: 	avg_search_speed_ms: 9.43573588606427
2025-03-12 18:14:46,063 [INFO]: 	99p_search_speed_ms: 12.608387700747699
2025-03-12 18:14:46,063 [INFO]: 	reconstruction error %: 0.0
2025-03-12 18:14:46,063 [INFO]: 	nb vectors: 1833
2025-03-12 18:14:46,063 [INFO]: 	vectors dimension: 49152
2025-03-12 18:14:46,063 [INFO]: 	compression ratio: 0.999309084452742
2025-03-12 18:14:46,063 [INFO]: }
2025-03-12 18:14:46,063 [INFO]: 	>>> Finished "Creating the index" in 30.5693 secs
2025-03-12 18:14:46,063 [INFO]: >>> Finished "Launching the whole pipeline" in 30.5948 secs
2025-03-12 18:14:46: [retrieval_preprocessing] calculating distances ...
2025-03-12 18:14:46: [retrieval_preprocessing] finished and saved retrieval indices for episode 34 [episode count 8/20]
[retrieval_preprocessing] for episode 35 [episode count 9/20], we have num_retrieval=np.int64(1801) num_query=np.int64(116)
2025-03-12 18:14:46,921 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-12 18:14:47,125 [INFO]: Launching the whole pipeline 03/12/2025, 18:14:47
2025-03-12 18:14:47,125 [INFO]: Reading total number of vectors and dimension 03/12/2025, 18:14:47
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1577.99it/s]
2025-03-12 18:14:47,153 [INFO]: There are 1801 embeddings of dim 49152
2025-03-12 18:14:47,153 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0284 secs
2025-03-12 18:14:47,153 [INFO]: 	Compute estimated construction time of the index 03/12/2025, 18:14:47
2025-03-12 18:14:47,154 [INFO]: 		-> Train: 16.7 minutes
2025-03-12 18:14:47,154 [INFO]: 		-> Add: 1.0 seconds
2025-03-12 18:14:47,154 [INFO]: 		Total: 16.7 minutes
2025-03-12 18:14:47,154 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0001 secs
2025-03-12 18:14:47,154 [INFO]: 	Checking that your have enough memory available to create the index 03/12/2025, 18:14:47
2025-03-12 18:14:47,154 [INFO]: 371.7MB of memory will be needed to build the index (more might be used if you have more)
2025-03-12 18:14:47,154 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0001 secs
2025-03-12 18:14:47,154 [INFO]: 	Selecting most promising index types given data characteristics 03/12/2025, 18:14:47
2025-03-12 18:14:47,154 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-12 18:14:47,154 [INFO]: 	Creating the index 03/12/2025, 18:14:47
2025-03-12 18:14:47,154 [INFO]: 		-> Instanciate the index HNSW15 03/12/2025, 18:14:47
2025-03-12 18:14:47,155 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0009 secs
2025-03-12 18:14:47,155 [INFO]: 		-> Adding the vectors to the index 03/12/2025, 18:14:47
2025-03-12 18:14:47,155 [INFO]: The memory available for adding the vectors is 49.7GB(total available - used by the index)
2025-03-12 18:14:47,155 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/8 [00:00<?, ?it/s] 25%|██▌       | 2/8 [00:00<00:00, 19.82it/s]100%|██████████| 8/8 [00:01<00:00,  6.23it/s]100%|██████████| 8/8 [00:01<00:00,  6.56it/s]
2025-03-12 18:14:48,377 [INFO]: 	Computing best hyperparameters for index knn.index 03/12/2025, 18:14:48
2025-03-12 18:15:07,132 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 18.7548 secs
2025-03-12 18:15:07,132 [INFO]: The best hyperparameters are: efSearch=284
2025-03-12 18:15:07,132 [INFO]: 	Compute fast metrics 03/12/2025, 18:15:07
  0%|          | 0/4 [00:00<?, ?it/s] 75%|███████▌  | 3/4 [00:00<00:00, 27.06it/s] 75%|███████▌  | 3/4 [00:00<00:00, 23.88it/s]
2025-03-12 18:15:18,213 [INFO]: 	>>> Finished "Compute fast metrics" in 11.0800 secs
2025-03-12 18:15:18,214 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 31.0590 secs
2025-03-12 18:15:18,214 [INFO]: {
2025-03-12 18:15:18,214 [INFO]: 	index_key: HNSW15
2025-03-12 18:15:18,214 [INFO]: 	index_param: efSearch=284
2025-03-12 18:15:18,214 [INFO]: 	index_path: knn.index
2025-03-12 18:15:18,214 [INFO]: 	size in bytes: 354335950
2025-03-12 18:15:18,214 [INFO]: 	avg_search_speed_ms: 9.205939888381305
2025-03-12 18:15:18,214 [INFO]: 	99p_search_speed_ms: 12.170986935961999
2025-03-12 18:15:18,214 [INFO]: 	reconstruction error %: 0.0
2025-03-12 18:15:18,214 [INFO]: 	nb vectors: 1801
2025-03-12 18:15:18,214 [INFO]: 	vectors dimension: 49152
2025-03-12 18:15:18,214 [INFO]: 	compression ratio: 0.9993087294698717
2025-03-12 18:15:18,214 [INFO]: }
2025-03-12 18:15:18,214 [INFO]: 	>>> Finished "Creating the index" in 31.0603 secs
2025-03-12 18:15:18,214 [INFO]: >>> Finished "Launching the whole pipeline" in 31.0891 secs
2025-03-12 18:15:18: [retrieval_preprocessing] calculating distances ...
2025-03-12 18:15:19: [retrieval_preprocessing] finished and saved retrieval indices for episode 35 [episode count 9/20]
[retrieval_preprocessing] for episode 36 [episode count 10/20], we have num_retrieval=np.int64(1809) num_query=np.int64(108)
2025-03-12 18:15:19,325 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-12 18:15:19,538 [INFO]: Launching the whole pipeline 03/12/2025, 18:15:19
2025-03-12 18:15:19,538 [INFO]: Reading total number of vectors and dimension 03/12/2025, 18:15:19
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1536.94it/s]
2025-03-12 18:15:19,567 [INFO]: There are 1809 embeddings of dim 49152
2025-03-12 18:15:19,568 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0292 secs
2025-03-12 18:15:19,568 [INFO]: 	Compute estimated construction time of the index 03/12/2025, 18:15:19
2025-03-12 18:15:19,568 [INFO]: 		-> Train: 16.7 minutes
2025-03-12 18:15:19,568 [INFO]: 		-> Add: 1.0 seconds
2025-03-12 18:15:19,568 [INFO]: 		Total: 16.7 minutes
2025-03-12 18:15:19,568 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0001 secs
2025-03-12 18:15:19,568 [INFO]: 	Checking that your have enough memory available to create the index 03/12/2025, 18:15:19
2025-03-12 18:15:19,568 [INFO]: 373.3MB of memory will be needed to build the index (more might be used if you have more)
2025-03-12 18:15:19,568 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0001 secs
2025-03-12 18:15:19,568 [INFO]: 	Selecting most promising index types given data characteristics 03/12/2025, 18:15:19
2025-03-12 18:15:19,568 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-12 18:15:19,568 [INFO]: 	Creating the index 03/12/2025, 18:15:19
2025-03-12 18:15:19,568 [INFO]: 		-> Instanciate the index HNSW15 03/12/2025, 18:15:19
2025-03-12 18:15:19,569 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0008 secs
2025-03-12 18:15:19,569 [INFO]: 		-> Adding the vectors to the index 03/12/2025, 18:15:19
2025-03-12 18:15:19,569 [INFO]: The memory available for adding the vectors is 49.7GB(total available - used by the index)
2025-03-12 18:15:19,569 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/8 [00:00<?, ?it/s] 38%|███▊      | 3/8 [00:00<00:00, 26.48it/s]100%|██████████| 8/8 [00:01<00:00,  5.83it/s]100%|██████████| 8/8 [00:01<00:00,  6.38it/s]
2025-03-12 18:15:20,827 [INFO]: 	Computing best hyperparameters for index knn.index 03/12/2025, 18:15:20
2025-03-12 18:15:40,869 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 20.0420 secs
2025-03-12 18:15:40,869 [INFO]: The best hyperparameters are: efSearch=347
2025-03-12 18:15:40,869 [INFO]: 	Compute fast metrics 03/12/2025, 18:15:40
  0%|          | 0/4 [00:00<?, ?it/s] 75%|███████▌  | 3/4 [00:00<00:00, 26.69it/s] 75%|███████▌  | 3/4 [00:00<00:00, 23.72it/s]
2025-03-12 18:15:51,917 [INFO]: 	>>> Finished "Compute fast metrics" in 11.0477 secs
2025-03-12 18:15:51,918 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 32.3488 secs
2025-03-12 18:15:51,918 [INFO]: {
2025-03-12 18:15:51,918 [INFO]: 	index_key: HNSW15
2025-03-12 18:15:51,918 [INFO]: 	index_param: efSearch=347
2025-03-12 18:15:51,918 [INFO]: 	index_path: knn.index
2025-03-12 18:15:51,918 [INFO]: 	size in bytes: 355909870
2025-03-12 18:15:51,918 [INFO]: 	avg_search_speed_ms: 10.189989404354526
2025-03-12 18:15:51,918 [INFO]: 	99p_search_speed_ms: 13.511628312990068
2025-03-12 18:15:51,918 [INFO]: 	reconstruction error %: 0.0
2025-03-12 18:15:51,918 [INFO]: 	nb vectors: 1809
2025-03-12 18:15:51,918 [INFO]: 	vectors dimension: 49152
2025-03-12 18:15:51,918 [INFO]: 	compression ratio: 0.9993088193929547
2025-03-12 18:15:51,918 [INFO]: }
2025-03-12 18:15:51,918 [INFO]: 	>>> Finished "Creating the index" in 32.3501 secs
2025-03-12 18:15:51,918 [INFO]: >>> Finished "Launching the whole pipeline" in 32.3798 secs
2025-03-12 18:15:53: [retrieval_preprocessing] calculating distances ...
2025-03-12 18:15:53: [retrieval_preprocessing] finished and saved retrieval indices for episode 36 [episode count 10/20]
[retrieval_preprocessing] for episode 37 [episode count 11/20], we have num_retrieval=np.int64(1824) num_query=np.int64(93)
2025-03-12 18:15:53,450 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-12 18:15:53,657 [INFO]: Launching the whole pipeline 03/12/2025, 18:15:53
2025-03-12 18:15:53,657 [INFO]: Reading total number of vectors and dimension 03/12/2025, 18:15:53
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 2441.39it/s]
2025-03-12 18:15:53,683 [INFO]: There are 1824 embeddings of dim 49152
2025-03-12 18:15:53,684 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0263 secs
2025-03-12 18:15:53,684 [INFO]: 	Compute estimated construction time of the index 03/12/2025, 18:15:53
2025-03-12 18:15:53,684 [INFO]: 		-> Train: 16.7 minutes
2025-03-12 18:15:53,684 [INFO]: 		-> Add: 1.0 seconds
2025-03-12 18:15:53,684 [INFO]: 		Total: 16.7 minutes
2025-03-12 18:15:53,684 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0001 secs
2025-03-12 18:15:53,684 [INFO]: 	Checking that your have enough memory available to create the index 03/12/2025, 18:15:53
2025-03-12 18:15:53,684 [INFO]: 376.4MB of memory will be needed to build the index (more might be used if you have more)
2025-03-12 18:15:53,684 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0001 secs
2025-03-12 18:15:53,684 [INFO]: 	Selecting most promising index types given data characteristics 03/12/2025, 18:15:53
2025-03-12 18:15:53,684 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-12 18:15:53,684 [INFO]: 	Creating the index 03/12/2025, 18:15:53
2025-03-12 18:15:53,684 [INFO]: 		-> Instanciate the index HNSW15 03/12/2025, 18:15:53
2025-03-12 18:15:53,685 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0008 secs
2025-03-12 18:15:53,685 [INFO]: 		-> Adding the vectors to the index 03/12/2025, 18:15:53
2025-03-12 18:15:53,685 [INFO]: The memory available for adding the vectors is 49.7GB(total available - used by the index)
2025-03-12 18:15:53,685 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/8 [00:00<?, ?it/s] 50%|█████     | 4/8 [00:00<00:00, 36.41it/s]100%|██████████| 8/8 [00:01<00:00,  5.57it/s]100%|██████████| 8/8 [00:01<00:00,  6.38it/s]
2025-03-12 18:15:54,942 [INFO]: 	Computing best hyperparameters for index knn.index 03/12/2025, 18:15:54
2025-03-12 18:16:14,344 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 19.4014 secs
2025-03-12 18:16:14,344 [INFO]: The best hyperparameters are: efSearch=341
2025-03-12 18:16:14,344 [INFO]: 	Compute fast metrics 03/12/2025, 18:16:14
  0%|          | 0/4 [00:00<?, ?it/s] 75%|███████▌  | 3/4 [00:00<00:00, 28.84it/s] 75%|███████▌  | 3/4 [00:00<00:00, 25.26it/s]
2025-03-12 18:16:25,439 [INFO]: 	>>> Finished "Compute fast metrics" in 11.0946 secs
2025-03-12 18:16:25,440 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 31.7550 secs
2025-03-12 18:16:25,441 [INFO]: {
2025-03-12 18:16:25,441 [INFO]: 	index_key: HNSW15
2025-03-12 18:16:25,441 [INFO]: 	index_param: efSearch=341
2025-03-12 18:16:25,441 [INFO]: 	index_path: knn.index
2025-03-12 18:16:25,441 [INFO]: 	size in bytes: 358860970
2025-03-12 18:16:25,441 [INFO]: 	avg_search_speed_ms: 10.19607846521669
2025-03-12 18:16:25,441 [INFO]: 	99p_search_speed_ms: 13.757192157208921
2025-03-12 18:16:25,441 [INFO]: 	reconstruction error %: 0.0
2025-03-12 18:16:25,441 [INFO]: 	nb vectors: 1824
2025-03-12 18:16:25,441 [INFO]: 	vectors dimension: 49152
2025-03-12 18:16:25,441 [INFO]: 	compression ratio: 0.9993089858727183
2025-03-12 18:16:25,441 [INFO]: }
2025-03-12 18:16:25,441 [INFO]: 	>>> Finished "Creating the index" in 31.7570 secs
2025-03-12 18:16:25,441 [INFO]: >>> Finished "Launching the whole pipeline" in 31.7838 secs
2025-03-12 18:16:26: [retrieval_preprocessing] calculating distances ...
2025-03-12 18:16:26: [retrieval_preprocessing] finished and saved retrieval indices for episode 37 [episode count 11/20]
[retrieval_preprocessing] for episode 38 [episode count 12/20], we have num_retrieval=np.int64(1827) num_query=np.int64(90)
2025-03-12 18:16:26,724 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-12 18:16:26,935 [INFO]: Launching the whole pipeline 03/12/2025, 18:16:26
2025-03-12 18:16:26,935 [INFO]: Reading total number of vectors and dimension 03/12/2025, 18:16:26
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1564.46it/s]
2025-03-12 18:16:26,966 [INFO]: There are 1827 embeddings of dim 49152
2025-03-12 18:16:26,966 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0310 secs
2025-03-12 18:16:26,966 [INFO]: 	Compute estimated construction time of the index 03/12/2025, 18:16:26
2025-03-12 18:16:26,967 [INFO]: 		-> Train: 16.7 minutes
2025-03-12 18:16:26,967 [INFO]: 		-> Add: 1.0 seconds
2025-03-12 18:16:26,967 [INFO]: 		Total: 16.7 minutes
2025-03-12 18:16:26,967 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0004 secs
2025-03-12 18:16:26,967 [INFO]: 	Checking that your have enough memory available to create the index 03/12/2025, 18:16:26
2025-03-12 18:16:26,967 [INFO]: 377.0MB of memory will be needed to build the index (more might be used if you have more)
2025-03-12 18:16:26,968 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0004 secs
2025-03-12 18:16:26,968 [INFO]: 	Selecting most promising index types given data characteristics 03/12/2025, 18:16:26
2025-03-12 18:16:26,968 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-12 18:16:26,968 [INFO]: 	Creating the index 03/12/2025, 18:16:26
2025-03-12 18:16:26,969 [INFO]: 		-> Instanciate the index HNSW15 03/12/2025, 18:16:26
2025-03-12 18:16:26,972 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0030 secs
2025-03-12 18:16:26,972 [INFO]: 		-> Adding the vectors to the index 03/12/2025, 18:16:26
2025-03-12 18:16:26,972 [INFO]: The memory available for adding the vectors is 49.7GB(total available - used by the index)
2025-03-12 18:16:26,972 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/8 [00:00<?, ?it/s] 50%|█████     | 4/8 [00:00<00:00, 38.45it/s]100%|██████████| 8/8 [00:01<00:00,  5.89it/s]100%|██████████| 8/8 [00:01<00:00,  6.73it/s]
2025-03-12 18:16:28,165 [INFO]: 	Computing best hyperparameters for index knn.index 03/12/2025, 18:16:28
2025-03-12 18:16:47,451 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 19.2864 secs
2025-03-12 18:16:47,452 [INFO]: The best hyperparameters are: efSearch=360
2025-03-12 18:16:47,452 [INFO]: 	Compute fast metrics 03/12/2025, 18:16:47
  0%|          | 0/4 [00:00<?, ?it/s] 75%|███████▌  | 3/4 [00:00<00:00, 28.72it/s] 75%|███████▌  | 3/4 [00:00<00:00, 24.72it/s]
2025-03-12 18:16:58,695 [INFO]: 	>>> Finished "Compute fast metrics" in 11.2436 secs
2025-03-12 18:16:58,696 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 31.7243 secs
2025-03-12 18:16:58,697 [INFO]: {
2025-03-12 18:16:58,697 [INFO]: 	index_key: HNSW15
2025-03-12 18:16:58,697 [INFO]: 	index_param: efSearch=360
2025-03-12 18:16:58,697 [INFO]: 	index_path: knn.index
2025-03-12 18:16:58,697 [INFO]: 	size in bytes: 359451190
2025-03-12 18:16:58,697 [INFO]: 	avg_search_speed_ms: 10.430692848278456
2025-03-12 18:16:58,697 [INFO]: 	99p_search_speed_ms: 13.730931933969252
2025-03-12 18:16:58,697 [INFO]: 	reconstruction error %: 0.0
2025-03-12 18:16:58,697 [INFO]: 	nb vectors: 1827
2025-03-12 18:16:58,697 [INFO]: 	vectors dimension: 49152
2025-03-12 18:16:58,697 [INFO]: 	compression ratio: 0.9993090188406387
2025-03-12 18:16:58,697 [INFO]: }
2025-03-12 18:16:58,697 [INFO]: 	>>> Finished "Creating the index" in 31.7283 secs
2025-03-12 18:16:58,697 [INFO]: >>> Finished "Launching the whole pipeline" in 31.7615 secs
2025-03-12 18:16:59: [retrieval_preprocessing] calculating distances ...
2025-03-12 18:16:59: [retrieval_preprocessing] finished and saved retrieval indices for episode 38 [episode count 12/20]
[retrieval_preprocessing] for episode 39 [episode count 13/20], we have num_retrieval=np.int64(1752) num_query=np.int64(165)
2025-03-12 18:16:59,982 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-12 18:17:00,179 [INFO]: Launching the whole pipeline 03/12/2025, 18:17:00
2025-03-12 18:17:00,179 [INFO]: Reading total number of vectors and dimension 03/12/2025, 18:17:00
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 2493.64it/s]
2025-03-12 18:17:00,203 [INFO]: There are 1752 embeddings of dim 49152
2025-03-12 18:17:00,203 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0243 secs
2025-03-12 18:17:00,203 [INFO]: 	Compute estimated construction time of the index 03/12/2025, 18:17:00
2025-03-12 18:17:00,203 [INFO]: 		-> Train: 16.7 minutes
2025-03-12 18:17:00,203 [INFO]: 		-> Add: 1.0 seconds
2025-03-12 18:17:00,203 [INFO]: 		Total: 16.7 minutes
2025-03-12 18:17:00,203 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0001 secs
2025-03-12 18:17:00,203 [INFO]: 	Checking that your have enough memory available to create the index 03/12/2025, 18:17:00
2025-03-12 18:17:00,204 [INFO]: 361.6MB of memory will be needed to build the index (more might be used if you have more)
2025-03-12 18:17:00,204 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0001 secs
2025-03-12 18:17:00,204 [INFO]: 	Selecting most promising index types given data characteristics 03/12/2025, 18:17:00
2025-03-12 18:17:00,204 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-12 18:17:00,204 [INFO]: 	Creating the index 03/12/2025, 18:17:00
2025-03-12 18:17:00,204 [INFO]: 		-> Instanciate the index HNSW15 03/12/2025, 18:17:00
2025-03-12 18:17:00,205 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0010 secs
2025-03-12 18:17:00,205 [INFO]: 		-> Adding the vectors to the index 03/12/2025, 18:17:00
2025-03-12 18:17:00,205 [INFO]: The memory available for adding the vectors is 49.7GB(total available - used by the index)
2025-03-12 18:17:00,205 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/7 [00:00<?, ?it/s] 57%|█████▋    | 4/7 [00:00<00:00, 38.83it/s]100%|██████████| 7/7 [00:01<00:00,  6.33it/s]
2025-03-12 18:17:01,314 [INFO]: 	Computing best hyperparameters for index knn.index 03/12/2025, 18:17:01
2025-03-12 18:17:19,954 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 18.6390 secs
2025-03-12 18:17:19,954 [INFO]: The best hyperparameters are: efSearch=381
2025-03-12 18:17:19,954 [INFO]: 	Compute fast metrics 03/12/2025, 18:17:19
  0%|          | 0/4 [00:00<?, ?it/s] 75%|███████▌  | 3/4 [00:00<00:00, 29.49it/s] 75%|███████▌  | 3/4 [00:00<00:00, 25.56it/s]
2025-03-12 18:17:30,979 [INFO]: 	>>> Finished "Compute fast metrics" in 11.0245 secs
2025-03-12 18:17:30,980 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 30.7748 secs
2025-03-12 18:17:30,980 [INFO]: {
2025-03-12 18:17:30,980 [INFO]: 	index_key: HNSW15
2025-03-12 18:17:30,980 [INFO]: 	index_param: efSearch=381
2025-03-12 18:17:30,980 [INFO]: 	index_path: knn.index
2025-03-12 18:17:30,980 [INFO]: 	size in bytes: 344695510
2025-03-12 18:17:30,980 [INFO]: 	avg_search_speed_ms: 10.90592862438967
2025-03-12 18:17:30,980 [INFO]: 	99p_search_speed_ms: 14.607558818534022
2025-03-12 18:17:30,980 [INFO]: 	reconstruction error %: 0.0
2025-03-12 18:17:30,980 [INFO]: 	nb vectors: 1752
2025-03-12 18:17:30,980 [INFO]: 	vectors dimension: 49152
2025-03-12 18:17:30,980 [INFO]: 	compression ratio: 0.9993086826109223
2025-03-12 18:17:30,980 [INFO]: }
2025-03-12 18:17:30,980 [INFO]: 	>>> Finished "Creating the index" in 30.7766 secs
2025-03-12 18:17:30,980 [INFO]: >>> Finished "Launching the whole pipeline" in 30.8015 secs
2025-03-12 18:17:32: [retrieval_preprocessing] calculating distances ...
2025-03-12 18:17:33: [retrieval_preprocessing] finished and saved retrieval indices for episode 39 [episode count 13/20]
[retrieval_preprocessing] for episode 40 [episode count 14/20], we have num_retrieval=np.int64(1856) num_query=np.int64(61)
2025-03-12 18:17:33,375 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-12 18:17:33,583 [INFO]: Launching the whole pipeline 03/12/2025, 18:17:33
2025-03-12 18:17:33,583 [INFO]: Reading total number of vectors and dimension 03/12/2025, 18:17:33
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 2318.58it/s]
2025-03-12 18:17:33,611 [INFO]: There are 1856 embeddings of dim 49152
2025-03-12 18:17:33,612 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0283 secs
2025-03-12 18:17:33,612 [INFO]: 	Compute estimated construction time of the index 03/12/2025, 18:17:33
2025-03-12 18:17:33,612 [INFO]: 		-> Train: 16.7 minutes
2025-03-12 18:17:33,612 [INFO]: 		-> Add: 1.0 seconds
2025-03-12 18:17:33,612 [INFO]: 		Total: 16.7 minutes
2025-03-12 18:17:33,612 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0003 secs
2025-03-12 18:17:33,612 [INFO]: 	Checking that your have enough memory available to create the index 03/12/2025, 18:17:33
2025-03-12 18:17:33,612 [INFO]: 383.0MB of memory will be needed to build the index (more might be used if you have more)
2025-03-12 18:17:33,613 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0004 secs
2025-03-12 18:17:33,613 [INFO]: 	Selecting most promising index types given data characteristics 03/12/2025, 18:17:33
2025-03-12 18:17:33,613 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-12 18:17:33,613 [INFO]: 	Creating the index 03/12/2025, 18:17:33
2025-03-12 18:17:33,613 [INFO]: 		-> Instanciate the index HNSW15 03/12/2025, 18:17:33
2025-03-12 18:17:33,616 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0026 secs
2025-03-12 18:17:33,616 [INFO]: 		-> Adding the vectors to the index 03/12/2025, 18:17:33
2025-03-12 18:17:33,616 [INFO]: The memory available for adding the vectors is 49.7GB(total available - used by the index)
2025-03-12 18:17:33,616 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/8 [00:00<?, ?it/s] 50%|█████     | 4/8 [00:00<00:00, 39.39it/s]100%|██████████| 8/8 [00:01<00:00,  5.70it/s]100%|██████████| 8/8 [00:01<00:00,  6.53it/s]
2025-03-12 18:17:34,846 [INFO]: 	Computing best hyperparameters for index knn.index 03/12/2025, 18:17:34
2025-03-12 18:17:53,451 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 18.6049 secs
2025-03-12 18:17:53,451 [INFO]: The best hyperparameters are: efSearch=304
2025-03-12 18:17:53,452 [INFO]: 	Compute fast metrics 03/12/2025, 18:17:53
  0%|          | 0/4 [00:00<?, ?it/s] 75%|███████▌  | 3/4 [00:00<00:00, 28.79it/s]
2025-03-12 18:18:04,500 [INFO]: 	>>> Finished "Compute fast metrics" in 11.0489 secs
2025-03-12 18:18:04,501 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 30.8854 secs
2025-03-12 18:18:04,502 [INFO]: {
2025-03-12 18:18:04,502 [INFO]: 	index_key: HNSW15
2025-03-12 18:18:04,502 [INFO]: 	index_param: efSearch=304
2025-03-12 18:18:04,502 [INFO]: 	index_path: knn.index
2025-03-12 18:18:04,502 [INFO]: 	size in bytes: 365156710
2025-03-12 18:18:04,502 [INFO]: 	avg_search_speed_ms: 9.427115356928821
2025-03-12 18:18:04,502 [INFO]: 	99p_search_speed_ms: 12.727061379700903
2025-03-12 18:18:04,502 [INFO]: 	reconstruction error %: 0.0
2025-03-12 18:18:04,502 [INFO]: 	nb vectors: 1856
2025-03-12 18:18:04,502 [INFO]: 	vectors dimension: 49152
2025-03-12 18:18:04,502 [INFO]: 	compression ratio: 0.9993091678364612
2025-03-12 18:18:04,502 [INFO]: }
2025-03-12 18:18:04,502 [INFO]: 	>>> Finished "Creating the index" in 30.8887 secs
2025-03-12 18:18:04,502 [INFO]: >>> Finished "Launching the whole pipeline" in 30.9186 secs
2025-03-12 18:18:04: [retrieval_preprocessing] calculating distances ...
2025-03-12 18:18:05: [retrieval_preprocessing] finished and saved retrieval indices for episode 40 [episode count 14/20]
[retrieval_preprocessing] for episode 41 [episode count 15/20], we have num_retrieval=np.int64(1833) num_query=np.int64(84)
2025-03-12 18:18:05,139 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-12 18:18:05,354 [INFO]: Launching the whole pipeline 03/12/2025, 18:18:05
2025-03-12 18:18:05,354 [INFO]: Reading total number of vectors and dimension 03/12/2025, 18:18:05
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1620.05it/s]
2025-03-12 18:18:05,380 [INFO]: There are 1833 embeddings of dim 49152
2025-03-12 18:18:05,381 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0271 secs
2025-03-12 18:18:05,381 [INFO]: 	Compute estimated construction time of the index 03/12/2025, 18:18:05
2025-03-12 18:18:05,381 [INFO]: 		-> Train: 16.7 minutes
2025-03-12 18:18:05,381 [INFO]: 		-> Add: 1.0 seconds
2025-03-12 18:18:05,381 [INFO]: 		Total: 16.7 minutes
2025-03-12 18:18:05,381 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0003 secs
2025-03-12 18:18:05,381 [INFO]: 	Checking that your have enough memory available to create the index 03/12/2025, 18:18:05
2025-03-12 18:18:05,382 [INFO]: 378.3MB of memory will be needed to build the index (more might be used if you have more)
2025-03-12 18:18:05,382 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0004 secs
2025-03-12 18:18:05,382 [INFO]: 	Selecting most promising index types given data characteristics 03/12/2025, 18:18:05
2025-03-12 18:18:05,382 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-12 18:18:05,382 [INFO]: 	Creating the index 03/12/2025, 18:18:05
2025-03-12 18:18:05,382 [INFO]: 		-> Instanciate the index HNSW15 03/12/2025, 18:18:05
2025-03-12 18:18:05,385 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0024 secs
2025-03-12 18:18:05,385 [INFO]: 		-> Adding the vectors to the index 03/12/2025, 18:18:05
2025-03-12 18:18:05,385 [INFO]: The memory available for adding the vectors is 49.7GB(total available - used by the index)
2025-03-12 18:18:05,385 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/8 [00:00<?, ?it/s] 50%|█████     | 4/8 [00:00<00:00, 37.23it/s]100%|██████████| 8/8 [00:01<00:00,  5.82it/s]100%|██████████| 8/8 [00:01<00:00,  6.65it/s]
2025-03-12 18:18:06,593 [INFO]: 	Computing best hyperparameters for index knn.index 03/12/2025, 18:18:06
2025-03-12 18:18:26,097 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 19.5044 secs
2025-03-12 18:18:26,098 [INFO]: The best hyperparameters are: efSearch=372
2025-03-12 18:18:26,098 [INFO]: 	Compute fast metrics 03/12/2025, 18:18:26
  0%|          | 0/4 [00:00<?, ?it/s] 75%|███████▌  | 3/4 [00:00<00:00, 28.49it/s] 75%|███████▌  | 3/4 [00:00<00:00, 24.73it/s]
2025-03-12 18:18:37,169 [INFO]: 	>>> Finished "Compute fast metrics" in 11.0716 secs
2025-03-12 18:18:37,171 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 31.7854 secs
2025-03-12 18:18:37,171 [INFO]: {
2025-03-12 18:18:37,171 [INFO]: 	index_key: HNSW15
2025-03-12 18:18:37,171 [INFO]: 	index_param: efSearch=372
2025-03-12 18:18:37,171 [INFO]: 	index_path: knn.index
2025-03-12 18:18:37,171 [INFO]: 	size in bytes: 360631630
2025-03-12 18:18:37,171 [INFO]: 	avg_search_speed_ms: 10.600112278706995
2025-03-12 18:18:37,171 [INFO]: 	99p_search_speed_ms: 14.189254338853054
2025-03-12 18:18:37,171 [INFO]: 	reconstruction error %: 0.0
2025-03-12 18:18:37,171 [INFO]: 	nb vectors: 1833
2025-03-12 18:18:37,171 [INFO]: 	vectors dimension: 49152
2025-03-12 18:18:37,171 [INFO]: 	compression ratio: 0.999309084452742
2025-03-12 18:18:37,171 [INFO]: }
2025-03-12 18:18:37,171 [INFO]: 	>>> Finished "Creating the index" in 31.7885 secs
2025-03-12 18:18:37,171 [INFO]: >>> Finished "Launching the whole pipeline" in 31.8171 secs
2025-03-12 18:18:38: [retrieval_preprocessing] calculating distances ...
2025-03-12 18:18:38: [retrieval_preprocessing] finished and saved retrieval indices for episode 41 [episode count 15/20]
[retrieval_preprocessing] for episode 42 [episode count 16/20], we have num_retrieval=np.int64(1847) num_query=np.int64(70)
2025-03-12 18:18:38,444 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-12 18:18:38,656 [INFO]: Launching the whole pipeline 03/12/2025, 18:18:38
2025-03-12 18:18:38,656 [INFO]: Reading total number of vectors and dimension 03/12/2025, 18:18:38
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 2150.93it/s]
2025-03-12 18:18:38,682 [INFO]: There are 1847 embeddings of dim 49152
2025-03-12 18:18:38,683 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0268 secs
2025-03-12 18:18:38,683 [INFO]: 	Compute estimated construction time of the index 03/12/2025, 18:18:38
2025-03-12 18:18:38,683 [INFO]: 		-> Train: 16.7 minutes
2025-03-12 18:18:38,683 [INFO]: 		-> Add: 1.0 seconds
2025-03-12 18:18:38,683 [INFO]: 		Total: 16.7 minutes
2025-03-12 18:18:38,683 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0001 secs
2025-03-12 18:18:38,683 [INFO]: 	Checking that your have enough memory available to create the index 03/12/2025, 18:18:38
2025-03-12 18:18:38,683 [INFO]: 381.2MB of memory will be needed to build the index (more might be used if you have more)
2025-03-12 18:18:38,683 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0002 secs
2025-03-12 18:18:38,683 [INFO]: 	Selecting most promising index types given data characteristics 03/12/2025, 18:18:38
2025-03-12 18:18:38,683 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-12 18:18:38,683 [INFO]: 	Creating the index 03/12/2025, 18:18:38
2025-03-12 18:18:38,683 [INFO]: 		-> Instanciate the index HNSW15 03/12/2025, 18:18:38
2025-03-12 18:18:38,684 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0009 secs
2025-03-12 18:18:38,684 [INFO]: 		-> Adding the vectors to the index 03/12/2025, 18:18:38
2025-03-12 18:18:38,684 [INFO]: The memory available for adding the vectors is 49.7GB(total available - used by the index)
2025-03-12 18:18:38,684 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/8 [00:00<?, ?it/s] 38%|███▊      | 3/8 [00:00<00:00, 26.79it/s]100%|██████████| 8/8 [00:01<00:00,  6.07it/s]100%|██████████| 8/8 [00:01<00:00,  6.64it/s]
2025-03-12 18:18:39,892 [INFO]: 	Computing best hyperparameters for index knn.index 03/12/2025, 18:18:39
2025-03-12 18:18:59,052 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 19.1597 secs
2025-03-12 18:18:59,052 [INFO]: The best hyperparameters are: efSearch=362
2025-03-12 18:18:59,052 [INFO]: 	Compute fast metrics 03/12/2025, 18:18:59
  0%|          | 0/4 [00:00<?, ?it/s] 75%|███████▌  | 3/4 [00:00<00:00, 28.82it/s] 75%|███████▌  | 3/4 [00:00<00:00, 25.24it/s]
2025-03-12 18:19:10,090 [INFO]: 	>>> Finished "Compute fast metrics" in 11.0377 secs
2025-03-12 18:19:10,091 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 31.4069 secs
2025-03-12 18:19:10,091 [INFO]: {
2025-03-12 18:19:10,091 [INFO]: 	index_key: HNSW15
2025-03-12 18:19:10,091 [INFO]: 	index_param: efSearch=362
2025-03-12 18:19:10,091 [INFO]: 	index_path: knn.index
2025-03-12 18:19:10,091 [INFO]: 	size in bytes: 363385990
2025-03-12 18:19:10,091 [INFO]: 	avg_search_speed_ms: 10.70895257138705
2025-03-12 18:19:10,091 [INFO]: 	99p_search_speed_ms: 14.12403570720926
2025-03-12 18:19:10,091 [INFO]: 	reconstruction error %: 0.0
2025-03-12 18:19:10,091 [INFO]: 	nb vectors: 1847
2025-03-12 18:19:10,091 [INFO]: 	vectors dimension: 49152
2025-03-12 18:19:10,091 [INFO]: 	compression ratio: 0.9993092358899142
2025-03-12 18:19:10,091 [INFO]: }
2025-03-12 18:19:10,091 [INFO]: 	>>> Finished "Creating the index" in 31.4082 secs
2025-03-12 18:19:10,091 [INFO]: >>> Finished "Launching the whole pipeline" in 31.4356 secs
2025-03-12 18:19:10: [retrieval_preprocessing] calculating distances ...
2025-03-12 18:19:11: [retrieval_preprocessing] finished and saved retrieval indices for episode 42 [episode count 16/20]
[retrieval_preprocessing] for episode 43 [episode count 17/20], we have num_retrieval=np.int64(1848) num_query=np.int64(69)
2025-03-12 18:19:11,134 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-12 18:19:11,337 [INFO]: Launching the whole pipeline 03/12/2025, 18:19:11
2025-03-12 18:19:11,337 [INFO]: Reading total number of vectors and dimension 03/12/2025, 18:19:11
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 2046.00it/s]
2025-03-12 18:19:11,363 [INFO]: There are 1848 embeddings of dim 49152
2025-03-12 18:19:11,363 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0261 secs
2025-03-12 18:19:11,363 [INFO]: 	Compute estimated construction time of the index 03/12/2025, 18:19:11
2025-03-12 18:19:11,363 [INFO]: 		-> Train: 16.7 minutes
2025-03-12 18:19:11,364 [INFO]: 		-> Add: 1.0 seconds
2025-03-12 18:19:11,364 [INFO]: 		Total: 16.7 minutes
2025-03-12 18:19:11,364 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0003 secs
2025-03-12 18:19:11,364 [INFO]: 	Checking that your have enough memory available to create the index 03/12/2025, 18:19:11
2025-03-12 18:19:11,364 [INFO]: 381.4MB of memory will be needed to build the index (more might be used if you have more)
2025-03-12 18:19:11,364 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0004 secs
2025-03-12 18:19:11,364 [INFO]: 	Selecting most promising index types given data characteristics 03/12/2025, 18:19:11
2025-03-12 18:19:11,364 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-12 18:19:11,365 [INFO]: 	Creating the index 03/12/2025, 18:19:11
2025-03-12 18:19:11,365 [INFO]: 		-> Instanciate the index HNSW15 03/12/2025, 18:19:11
2025-03-12 18:19:11,367 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0024 secs
2025-03-12 18:19:11,367 [INFO]: 		-> Adding the vectors to the index 03/12/2025, 18:19:11
2025-03-12 18:19:11,367 [INFO]: The memory available for adding the vectors is 49.7GB(total available - used by the index)
2025-03-12 18:19:11,368 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/8 [00:00<?, ?it/s] 38%|███▊      | 3/8 [00:00<00:00, 28.40it/s]100%|██████████| 8/8 [00:01<00:00,  6.01it/s]100%|██████████| 8/8 [00:01<00:00,  6.58it/s]
2025-03-12 18:19:12,587 [INFO]: 	Computing best hyperparameters for index knn.index 03/12/2025, 18:19:12
2025-03-12 18:19:31,971 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 19.3836 secs
2025-03-12 18:19:31,971 [INFO]: The best hyperparameters are: efSearch=369
2025-03-12 18:19:31,971 [INFO]: 	Compute fast metrics 03/12/2025, 18:19:31
  0%|          | 0/4 [00:00<?, ?it/s] 75%|███████▌  | 3/4 [00:00<00:00, 28.01it/s] 75%|███████▌  | 3/4 [00:00<00:00, 24.81it/s]
2025-03-12 18:19:43,352 [INFO]: 	>>> Finished "Compute fast metrics" in 11.3809 secs
2025-03-12 18:19:43,353 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 31.9859 secs
2025-03-12 18:19:43,353 [INFO]: {
2025-03-12 18:19:43,353 [INFO]: 	index_key: HNSW15
2025-03-12 18:19:43,353 [INFO]: 	index_param: efSearch=369
2025-03-12 18:19:43,353 [INFO]: 	index_path: knn.index
2025-03-12 18:19:43,353 [INFO]: 	size in bytes: 363582730
2025-03-12 18:19:43,353 [INFO]: 	avg_search_speed_ms: 10.26283018458157
2025-03-12 18:19:43,353 [INFO]: 	99p_search_speed_ms: 13.757291375659406
2025-03-12 18:19:43,353 [INFO]: 	reconstruction error %: 0.0
2025-03-12 18:19:43,353 [INFO]: 	nb vectors: 1848
2025-03-12 18:19:43,353 [INFO]: 	vectors dimension: 49152
2025-03-12 18:19:43,353 [INFO]: 	compression ratio: 0.999309246619057
2025-03-12 18:19:43,353 [INFO]: }
2025-03-12 18:19:43,354 [INFO]: 	>>> Finished "Creating the index" in 31.9889 secs
2025-03-12 18:19:43,354 [INFO]: >>> Finished "Launching the whole pipeline" in 32.0165 secs
2025-03-12 18:19:44: [retrieval_preprocessing] calculating distances ...
2025-03-12 18:19:44: [retrieval_preprocessing] finished and saved retrieval indices for episode 43 [episode count 17/20]
[retrieval_preprocessing] for episode 44 [episode count 18/20], we have num_retrieval=np.int64(1830) num_query=np.int64(87)
2025-03-12 18:19:44,351 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-12 18:19:44,563 [INFO]: Launching the whole pipeline 03/12/2025, 18:19:44
2025-03-12 18:19:44,563 [INFO]: Reading total number of vectors and dimension 03/12/2025, 18:19:44
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 2369.66it/s]
2025-03-12 18:19:44,589 [INFO]: There are 1830 embeddings of dim 49152
2025-03-12 18:19:44,589 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0259 secs
2025-03-12 18:19:44,589 [INFO]: 	Compute estimated construction time of the index 03/12/2025, 18:19:44
2025-03-12 18:19:44,589 [INFO]: 		-> Train: 16.7 minutes
2025-03-12 18:19:44,589 [INFO]: 		-> Add: 1.0 seconds
2025-03-12 18:19:44,589 [INFO]: 		Total: 16.7 minutes
2025-03-12 18:19:44,589 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0002 secs
2025-03-12 18:19:44,589 [INFO]: 	Checking that your have enough memory available to create the index 03/12/2025, 18:19:44
2025-03-12 18:19:44,589 [INFO]: 377.7MB of memory will be needed to build the index (more might be used if you have more)
2025-03-12 18:19:44,589 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0001 secs
2025-03-12 18:19:44,589 [INFO]: 	Selecting most promising index types given data characteristics 03/12/2025, 18:19:44
2025-03-12 18:19:44,589 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-12 18:19:44,589 [INFO]: 	Creating the index 03/12/2025, 18:19:44
2025-03-12 18:19:44,589 [INFO]: 		-> Instanciate the index HNSW15 03/12/2025, 18:19:44
2025-03-12 18:19:44,590 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0009 secs
2025-03-12 18:19:44,590 [INFO]: 		-> Adding the vectors to the index 03/12/2025, 18:19:44
2025-03-12 18:19:44,590 [INFO]: The memory available for adding the vectors is 49.7GB(total available - used by the index)
2025-03-12 18:19:44,590 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/8 [00:00<?, ?it/s] 38%|███▊      | 3/8 [00:00<00:00, 27.60it/s]100%|██████████| 8/8 [00:01<00:00,  5.98it/s]100%|██████████| 8/8 [00:01<00:00,  6.55it/s]
2025-03-12 18:19:45,815 [INFO]: 	Computing best hyperparameters for index knn.index 03/12/2025, 18:19:45
2025-03-12 18:20:05,786 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 19.9708 secs
2025-03-12 18:20:05,786 [INFO]: The best hyperparameters are: efSearch=350
2025-03-12 18:20:05,786 [INFO]: 	Compute fast metrics 03/12/2025, 18:20:05
  0%|          | 0/4 [00:00<?, ?it/s] 75%|███████▌  | 3/4 [00:00<00:00, 26.04it/s]
2025-03-12 18:20:16,879 [INFO]: 	>>> Finished "Compute fast metrics" in 11.0925 secs
2025-03-12 18:20:16,880 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 32.2896 secs
2025-03-12 18:20:16,880 [INFO]: {
2025-03-12 18:20:16,880 [INFO]: 	index_key: HNSW15
2025-03-12 18:20:16,880 [INFO]: 	index_param: efSearch=350
2025-03-12 18:20:16,880 [INFO]: 	index_path: knn.index
2025-03-12 18:20:16,880 [INFO]: 	size in bytes: 360041410
2025-03-12 18:20:16,880 [INFO]: 	avg_search_speed_ms: 10.124570714132597
2025-03-12 18:20:16,880 [INFO]: 	99p_search_speed_ms: 13.342172128614038
2025-03-12 18:20:16,880 [INFO]: 	reconstruction error %: 0.0
2025-03-12 18:20:16,880 [INFO]: 	nb vectors: 1830
2025-03-12 18:20:16,880 [INFO]: 	vectors dimension: 49152
2025-03-12 18:20:16,880 [INFO]: 	compression ratio: 0.9993090517004697
2025-03-12 18:20:16,880 [INFO]: }
2025-03-12 18:20:16,880 [INFO]: 	>>> Finished "Creating the index" in 32.2908 secs
2025-03-12 18:20:16,880 [INFO]: >>> Finished "Launching the whole pipeline" in 32.3173 secs
2025-03-12 18:20:17: [retrieval_preprocessing] calculating distances ...
2025-03-12 18:20:18: [retrieval_preprocessing] finished and saved retrieval indices for episode 44 [episode count 18/20]
[retrieval_preprocessing] for episode 45 [episode count 19/20], we have num_retrieval=np.int64(1865) num_query=np.int64(52)
2025-03-12 18:20:18,114 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-12 18:20:18,322 [INFO]: Launching the whole pipeline 03/12/2025, 18:20:18
2025-03-12 18:20:18,322 [INFO]: Reading total number of vectors and dimension 03/12/2025, 18:20:18
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1698.10it/s]
2025-03-12 18:20:18,347 [INFO]: There are 1865 embeddings of dim 49152
2025-03-12 18:20:18,347 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0246 secs
2025-03-12 18:20:18,347 [INFO]: 	Compute estimated construction time of the index 03/12/2025, 18:20:18
2025-03-12 18:20:18,347 [INFO]: 		-> Train: 16.7 minutes
2025-03-12 18:20:18,347 [INFO]: 		-> Add: 1.0 seconds
2025-03-12 18:20:18,347 [INFO]: 		Total: 16.7 minutes
2025-03-12 18:20:18,347 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0001 secs
2025-03-12 18:20:18,347 [INFO]: 	Checking that your have enough memory available to create the index 03/12/2025, 18:20:18
2025-03-12 18:20:18,347 [INFO]: 384.9MB of memory will be needed to build the index (more might be used if you have more)
2025-03-12 18:20:18,347 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0001 secs
2025-03-12 18:20:18,347 [INFO]: 	Selecting most promising index types given data characteristics 03/12/2025, 18:20:18
2025-03-12 18:20:18,347 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-12 18:20:18,348 [INFO]: 	Creating the index 03/12/2025, 18:20:18
2025-03-12 18:20:18,348 [INFO]: 		-> Instanciate the index HNSW15 03/12/2025, 18:20:18
2025-03-12 18:20:18,349 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0009 secs
2025-03-12 18:20:18,349 [INFO]: 		-> Adding the vectors to the index 03/12/2025, 18:20:18
2025-03-12 18:20:18,349 [INFO]: The memory available for adding the vectors is 49.7GB(total available - used by the index)
2025-03-12 18:20:18,349 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/8 [00:00<?, ?it/s] 38%|███▊      | 3/8 [00:00<00:00, 29.11it/s]100%|██████████| 8/8 [00:01<00:00,  6.14it/s]100%|██████████| 8/8 [00:01<00:00,  6.72it/s]
2025-03-12 18:20:19,543 [INFO]: 	Computing best hyperparameters for index knn.index 03/12/2025, 18:20:19
2025-03-12 18:20:38,700 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 19.1561 secs
2025-03-12 18:20:38,700 [INFO]: The best hyperparameters are: efSearch=367
2025-03-12 18:20:38,700 [INFO]: 	Compute fast metrics 03/12/2025, 18:20:38
  0%|          | 0/4 [00:00<?, ?it/s] 75%|███████▌  | 3/4 [00:00<00:00, 29.61it/s] 75%|███████▌  | 3/4 [00:00<00:00, 25.46it/s]
2025-03-12 18:20:49,980 [INFO]: 	>>> Finished "Compute fast metrics" in 11.2795 secs
2025-03-12 18:20:49,981 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 31.6321 secs
2025-03-12 18:20:49,981 [INFO]: {
2025-03-12 18:20:49,981 [INFO]: 	index_key: HNSW15
2025-03-12 18:20:49,981 [INFO]: 	index_param: efSearch=367
2025-03-12 18:20:49,981 [INFO]: 	index_path: knn.index
2025-03-12 18:20:49,981 [INFO]: 	size in bytes: 366927490
2025-03-12 18:20:49,981 [INFO]: 	avg_search_speed_ms: 10.803106442077757
2025-03-12 18:20:49,981 [INFO]: 	99p_search_speed_ms: 14.259302930440754
2025-03-12 18:20:49,981 [INFO]: 	reconstruction error %: 0.0
2025-03-12 18:20:49,981 [INFO]: 	nb vectors: 1865
2025-03-12 18:20:49,981 [INFO]: 	vectors dimension: 49152
2025-03-12 18:20:49,981 [INFO]: 	compression ratio: 0.9993089370327636
2025-03-12 18:20:49,981 [INFO]: }
2025-03-12 18:20:49,981 [INFO]: 	>>> Finished "Creating the index" in 31.6334 secs
2025-03-12 18:20:49,981 [INFO]: >>> Finished "Launching the whole pipeline" in 31.6585 secs
2025-03-12 18:20:50: [retrieval_preprocessing] calculating distances ...
2025-03-12 18:20:50: [retrieval_preprocessing] finished and saved retrieval indices for episode 45 [episode count 19/20]
2025-03-12 18:20:50: [retrieval_preprocessing] finished for collected_demos_training/2025-03-10_pick_up_the_duck_and_put_it_in_the_bowl [chosen_id count 2/8]
2025-03-12 18:20:51: [retrieval_preprocessing] concatenated all embeddings and indices for 20 episodes for collected_demos_training/2023-03-04_pick_up_the_pineapple_and_put_it_in_the_bowl [chosen_id count 3/8]
2025-03-12 18:20:51: [retrieval_preprocessing] we have num_total=2137 embedding_dim=49152
[retrieval_preprocessing] for episode 46 [episode count 0/20], we have num_retrieval=np.int64(2021) num_query=np.int64(116)
2025-03-12 18:20:51,198 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-12 18:20:51,427 [INFO]: Launching the whole pipeline 03/12/2025, 18:20:51
2025-03-12 18:20:51,427 [INFO]: Reading total number of vectors and dimension 03/12/2025, 18:20:51
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1819.65it/s]
2025-03-12 18:20:51,455 [INFO]: There are 2021 embeddings of dim 49152
2025-03-12 18:20:51,455 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0283 secs
2025-03-12 18:20:51,455 [INFO]: 	Compute estimated construction time of the index 03/12/2025, 18:20:51
2025-03-12 18:20:51,456 [INFO]: 		-> Train: 16.7 minutes
2025-03-12 18:20:51,456 [INFO]: 		-> Add: 1.1 seconds
2025-03-12 18:20:51,456 [INFO]: 		Total: 16.7 minutes
2025-03-12 18:20:51,456 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0001 secs
2025-03-12 18:20:51,456 [INFO]: 	Checking that your have enough memory available to create the index 03/12/2025, 18:20:51
2025-03-12 18:20:51,456 [INFO]: 417.1MB of memory will be needed to build the index (more might be used if you have more)
2025-03-12 18:20:51,456 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0002 secs
2025-03-12 18:20:51,456 [INFO]: 	Selecting most promising index types given data characteristics 03/12/2025, 18:20:51
2025-03-12 18:20:51,456 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-12 18:20:51,456 [INFO]: 	Creating the index 03/12/2025, 18:20:51
2025-03-12 18:20:51,456 [INFO]: 		-> Instanciate the index HNSW15 03/12/2025, 18:20:51
2025-03-12 18:20:51,458 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0014 secs
2025-03-12 18:20:51,458 [INFO]: 		-> Adding the vectors to the index 03/12/2025, 18:20:51
2025-03-12 18:20:51,458 [INFO]: The memory available for adding the vectors is 49.6GB(total available - used by the index)
2025-03-12 18:20:51,458 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/8 [00:00<?, ?it/s] 25%|██▌       | 2/8 [00:00<00:00, 17.54it/s]100%|██████████| 8/8 [00:01<00:00,  5.84it/s]100%|██████████| 8/8 [00:01<00:00,  6.14it/s]
2025-03-12 18:20:52,764 [INFO]: 	Computing best hyperparameters for index knn.index 03/12/2025, 18:20:52
2025-03-12 18:21:12,558 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 19.7932 secs
2025-03-12 18:21:12,558 [INFO]: The best hyperparameters are: efSearch=398
2025-03-12 18:21:12,558 [INFO]: 	Compute fast metrics 03/12/2025, 18:21:12
  0%|          | 0/4 [00:00<?, ?it/s] 75%|███████▌  | 3/4 [00:00<00:00, 29.17it/s] 75%|███████▌  | 3/4 [00:00<00:00, 25.77it/s]
2025-03-12 18:21:23,656 [INFO]: 	>>> Finished "Compute fast metrics" in 11.0983 secs
2025-03-12 18:21:23,658 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 32.1997 secs
2025-03-12 18:21:23,658 [INFO]: {
2025-03-12 18:21:23,658 [INFO]: 	index_key: HNSW15
2025-03-12 18:21:23,658 [INFO]: 	index_param: efSearch=398
2025-03-12 18:21:23,658 [INFO]: 	index_path: knn.index
2025-03-12 18:21:23,658 [INFO]: 	size in bytes: 397619590
2025-03-12 18:21:23,658 [INFO]: 	avg_search_speed_ms: 10.240661633556504
2025-03-12 18:21:23,658 [INFO]: 	99p_search_speed_ms: 12.863030079752209
2025-03-12 18:21:23,658 [INFO]: 	reconstruction error %: 0.0
2025-03-12 18:21:23,658 [INFO]: 	nb vectors: 2021
2025-03-12 18:21:23,658 [INFO]: 	vectors dimension: 49152
2025-03-12 18:21:23,658 [INFO]: 	compression ratio: 0.9993088318410066
2025-03-12 18:21:23,658 [INFO]: }
2025-03-12 18:21:23,658 [INFO]: 	>>> Finished "Creating the index" in 32.2017 secs
2025-03-12 18:21:23,658 [INFO]: >>> Finished "Launching the whole pipeline" in 32.2308 secs
2025-03-12 18:21:24: [retrieval_preprocessing] calculating distances ...
2025-03-12 18:21:25: [retrieval_preprocessing] finished and saved retrieval indices for episode 46 [episode count 0/20]
[retrieval_preprocessing] for episode 47 [episode count 1/20], we have num_retrieval=np.int64(2032) num_query=np.int64(105)
2025-03-12 18:21:25,330 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-12 18:21:25,559 [INFO]: Launching the whole pipeline 03/12/2025, 18:21:25
2025-03-12 18:21:25,559 [INFO]: Reading total number of vectors and dimension 03/12/2025, 18:21:25
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 2568.47it/s]
2025-03-12 18:21:25,583 [INFO]: There are 2032 embeddings of dim 49152
2025-03-12 18:21:25,583 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0241 secs
2025-03-12 18:21:25,583 [INFO]: 	Compute estimated construction time of the index 03/12/2025, 18:21:25
2025-03-12 18:21:25,583 [INFO]: 		-> Train: 16.7 minutes
2025-03-12 18:21:25,583 [INFO]: 		-> Add: 1.1 seconds
2025-03-12 18:21:25,583 [INFO]: 		Total: 16.7 minutes
2025-03-12 18:21:25,583 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0001 secs
2025-03-12 18:21:25,583 [INFO]: 	Checking that your have enough memory available to create the index 03/12/2025, 18:21:25
2025-03-12 18:21:25,584 [INFO]: 419.4MB of memory will be needed to build the index (more might be used if you have more)
2025-03-12 18:21:25,584 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0001 secs
2025-03-12 18:21:25,584 [INFO]: 	Selecting most promising index types given data characteristics 03/12/2025, 18:21:25
2025-03-12 18:21:25,584 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-12 18:21:25,584 [INFO]: 	Creating the index 03/12/2025, 18:21:25
2025-03-12 18:21:25,584 [INFO]: 		-> Instanciate the index HNSW15 03/12/2025, 18:21:25
2025-03-12 18:21:25,585 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0010 secs
2025-03-12 18:21:25,585 [INFO]: 		-> Adding the vectors to the index 03/12/2025, 18:21:25
2025-03-12 18:21:25,585 [INFO]: The memory available for adding the vectors is 49.6GB(total available - used by the index)
2025-03-12 18:21:25,585 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/8 [00:00<?, ?it/s] 25%|██▌       | 2/8 [00:00<00:00, 18.97it/s]100%|██████████| 8/8 [00:01<00:00,  6.08it/s]100%|██████████| 8/8 [00:01<00:00,  6.39it/s]
2025-03-12 18:21:26,841 [INFO]: 	Computing best hyperparameters for index knn.index 03/12/2025, 18:21:26
2025-03-12 18:21:46,491 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 19.6497 secs
2025-03-12 18:21:46,491 [INFO]: The best hyperparameters are: efSearch=375
2025-03-12 18:21:46,491 [INFO]: 	Compute fast metrics 03/12/2025, 18:21:46
  0%|          | 0/4 [00:00<?, ?it/s] 75%|███████▌  | 3/4 [00:00<00:00, 27.47it/s] 75%|███████▌  | 3/4 [00:00<00:00, 24.28it/s]
2025-03-12 18:21:57,652 [INFO]: 	>>> Finished "Compute fast metrics" in 11.1604 secs
2025-03-12 18:21:57,653 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 32.0681 secs
2025-03-12 18:21:57,653 [INFO]: {
2025-03-12 18:21:57,653 [INFO]: 	index_key: HNSW15
2025-03-12 18:21:57,653 [INFO]: 	index_param: efSearch=375
2025-03-12 18:21:57,653 [INFO]: 	index_path: knn.index
2025-03-12 18:21:57,653 [INFO]: 	size in bytes: 399783790
2025-03-12 18:21:57,653 [INFO]: 	avg_search_speed_ms: 9.53795684495314
2025-03-12 18:21:57,653 [INFO]: 	99p_search_speed_ms: 12.17543164268136
2025-03-12 18:21:57,653 [INFO]: 	reconstruction error %: 0.0
2025-03-12 18:21:57,653 [INFO]: 	nb vectors: 2032
2025-03-12 18:21:57,653 [INFO]: 	vectors dimension: 49152
2025-03-12 18:21:57,653 [INFO]: 	compression ratio: 0.999308791384463
2025-03-12 18:21:57,653 [INFO]: }
2025-03-12 18:21:57,653 [INFO]: 	>>> Finished "Creating the index" in 32.0694 secs
2025-03-12 18:21:57,653 [INFO]: >>> Finished "Launching the whole pipeline" in 32.0941 secs
2025-03-12 18:21:58: [retrieval_preprocessing] calculating distances ...
2025-03-12 18:21:58: [retrieval_preprocessing] finished and saved retrieval indices for episode 47 [episode count 1/20]
[retrieval_preprocessing] for episode 48 [episode count 2/20], we have num_retrieval=np.int64(2025) num_query=np.int64(112)
2025-03-12 18:21:59,021 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-12 18:21:59,247 [INFO]: Launching the whole pipeline 03/12/2025, 18:21:59
2025-03-12 18:21:59,247 [INFO]: Reading total number of vectors and dimension 03/12/2025, 18:21:59
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1599.66it/s]
2025-03-12 18:21:59,277 [INFO]: There are 2025 embeddings of dim 49152
2025-03-12 18:21:59,277 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0295 secs
2025-03-12 18:21:59,277 [INFO]: 	Compute estimated construction time of the index 03/12/2025, 18:21:59
2025-03-12 18:21:59,277 [INFO]: 		-> Train: 16.7 minutes
2025-03-12 18:21:59,277 [INFO]: 		-> Add: 1.1 seconds
2025-03-12 18:21:59,277 [INFO]: 		Total: 16.7 minutes
2025-03-12 18:21:59,277 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0001 secs
2025-03-12 18:21:59,277 [INFO]: 	Checking that your have enough memory available to create the index 03/12/2025, 18:21:59
2025-03-12 18:21:59,277 [INFO]: 417.9MB of memory will be needed to build the index (more might be used if you have more)
2025-03-12 18:21:59,277 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0001 secs
2025-03-12 18:21:59,277 [INFO]: 	Selecting most promising index types given data characteristics 03/12/2025, 18:21:59
2025-03-12 18:21:59,277 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-12 18:21:59,277 [INFO]: 	Creating the index 03/12/2025, 18:21:59
2025-03-12 18:21:59,277 [INFO]: 		-> Instanciate the index HNSW15 03/12/2025, 18:21:59
2025-03-12 18:21:59,278 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0009 secs
2025-03-12 18:21:59,278 [INFO]: 		-> Adding the vectors to the index 03/12/2025, 18:21:59
2025-03-12 18:21:59,278 [INFO]: The memory available for adding the vectors is 49.6GB(total available - used by the index)
2025-03-12 18:21:59,278 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/8 [00:00<?, ?it/s] 38%|███▊      | 3/8 [00:00<00:00, 28.25it/s]100%|██████████| 8/8 [00:01<00:00,  5.84it/s]100%|██████████| 8/8 [00:01<00:00,  6.40it/s]
2025-03-12 18:22:00,531 [INFO]: 	Computing best hyperparameters for index knn.index 03/12/2025, 18:22:00
2025-03-12 18:22:20,079 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 19.5477 secs
2025-03-12 18:22:20,079 [INFO]: The best hyperparameters are: efSearch=377
2025-03-12 18:22:20,079 [INFO]: 	Compute fast metrics 03/12/2025, 18:22:20
  0%|          | 0/4 [00:00<?, ?it/s] 75%|███████▌  | 3/4 [00:00<00:00, 29.08it/s] 75%|███████▌  | 3/4 [00:00<00:00, 25.46it/s]
2025-03-12 18:22:31,205 [INFO]: 	>>> Finished "Compute fast metrics" in 11.1255 secs
2025-03-12 18:22:31,206 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 31.9273 secs
2025-03-12 18:22:31,206 [INFO]: {
2025-03-12 18:22:31,206 [INFO]: 	index_key: HNSW15
2025-03-12 18:22:31,206 [INFO]: 	index_param: efSearch=377
2025-03-12 18:22:31,206 [INFO]: 	index_path: knn.index
2025-03-12 18:22:31,206 [INFO]: 	size in bytes: 398406610
2025-03-12 18:22:31,206 [INFO]: 	avg_search_speed_ms: 9.44011836984845
2025-03-12 18:22:31,206 [INFO]: 	99p_search_speed_ms: 12.791663487441838
2025-03-12 18:22:31,206 [INFO]: 	reconstruction error %: 0.0
2025-03-12 18:22:31,206 [INFO]: 	nb vectors: 2025
2025-03-12 18:22:31,206 [INFO]: 	vectors dimension: 49152
2025-03-12 18:22:31,206 [INFO]: 	compression ratio: 0.9993087213086148
2025-03-12 18:22:31,206 [INFO]: }
2025-03-12 18:22:31,206 [INFO]: 	>>> Finished "Creating the index" in 31.9287 secs
2025-03-12 18:22:31,206 [INFO]: >>> Finished "Launching the whole pipeline" in 31.9586 secs
2025-03-12 18:22:32: [retrieval_preprocessing] calculating distances ...
2025-03-12 18:22:32: [retrieval_preprocessing] finished and saved retrieval indices for episode 48 [episode count 2/20]
[retrieval_preprocessing] for episode 49 [episode count 3/20], we have num_retrieval=np.int64(2022) num_query=np.int64(115)
2025-03-12 18:22:32,754 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-12 18:22:32,986 [INFO]: Launching the whole pipeline 03/12/2025, 18:22:32
2025-03-12 18:22:32,986 [INFO]: Reading total number of vectors and dimension 03/12/2025, 18:22:32
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 2376.38it/s]
2025-03-12 18:22:33,010 [INFO]: There are 2022 embeddings of dim 49152
2025-03-12 18:22:33,010 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0242 secs
2025-03-12 18:22:33,010 [INFO]: 	Compute estimated construction time of the index 03/12/2025, 18:22:33
2025-03-12 18:22:33,010 [INFO]: 		-> Train: 16.7 minutes
2025-03-12 18:22:33,010 [INFO]: 		-> Add: 1.1 seconds
2025-03-12 18:22:33,010 [INFO]: 		Total: 16.7 minutes
2025-03-12 18:22:33,010 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0001 secs
2025-03-12 18:22:33,010 [INFO]: 	Checking that your have enough memory available to create the index 03/12/2025, 18:22:33
2025-03-12 18:22:33,010 [INFO]: 417.3MB of memory will be needed to build the index (more might be used if you have more)
2025-03-12 18:22:33,010 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0001 secs
2025-03-12 18:22:33,010 [INFO]: 	Selecting most promising index types given data characteristics 03/12/2025, 18:22:33
2025-03-12 18:22:33,010 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-12 18:22:33,010 [INFO]: 	Creating the index 03/12/2025, 18:22:33
2025-03-12 18:22:33,011 [INFO]: 		-> Instanciate the index HNSW15 03/12/2025, 18:22:33
2025-03-12 18:22:33,011 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0009 secs
2025-03-12 18:22:33,012 [INFO]: 		-> Adding the vectors to the index 03/12/2025, 18:22:33
2025-03-12 18:22:33,012 [INFO]: The memory available for adding the vectors is 49.6GB(total available - used by the index)
2025-03-12 18:22:33,012 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/8 [00:00<?, ?it/s] 38%|███▊      | 3/8 [00:00<00:00, 29.44it/s]100%|██████████| 8/8 [00:01<00:00,  5.74it/s]100%|██████████| 8/8 [00:01<00:00,  6.30it/s]
2025-03-12 18:22:34,284 [INFO]: 	Computing best hyperparameters for index knn.index 03/12/2025, 18:22:34
2025-03-12 18:22:53,692 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 19.4081 secs
2025-03-12 18:22:53,692 [INFO]: The best hyperparameters are: efSearch=378
2025-03-12 18:22:53,692 [INFO]: 	Compute fast metrics 03/12/2025, 18:22:53
  0%|          | 0/4 [00:00<?, ?it/s] 75%|███████▌  | 3/4 [00:00<00:00, 28.97it/s] 75%|███████▌  | 3/4 [00:00<00:00, 25.05it/s]
2025-03-12 18:23:04,883 [INFO]: 	>>> Finished "Compute fast metrics" in 11.1904 secs
2025-03-12 18:23:04,884 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 31.8724 secs
2025-03-12 18:23:04,884 [INFO]: {
2025-03-12 18:23:04,884 [INFO]: 	index_key: HNSW15
2025-03-12 18:23:04,884 [INFO]: 	index_param: efSearch=378
2025-03-12 18:23:04,884 [INFO]: 	index_path: knn.index
2025-03-12 18:23:04,884 [INFO]: 	size in bytes: 397816330
2025-03-12 18:23:04,884 [INFO]: 	avg_search_speed_ms: 9.976185876124001
2025-03-12 18:23:04,884 [INFO]: 	99p_search_speed_ms: 13.414586926810443
2025-03-12 18:23:04,884 [INFO]: 	reconstruction error %: 0.0
2025-03-12 18:23:04,884 [INFO]: 	nb vectors: 2022
2025-03-12 18:23:04,884 [INFO]: 	vectors dimension: 49152
2025-03-12 18:23:04,884 [INFO]: 	compression ratio: 0.9993088418466884
2025-03-12 18:23:04,884 [INFO]: }
2025-03-12 18:23:04,884 [INFO]: 	>>> Finished "Creating the index" in 31.8738 secs
2025-03-12 18:23:04,884 [INFO]: >>> Finished "Launching the whole pipeline" in 31.8986 secs
2025-03-12 18:23:06: [retrieval_preprocessing] calculating distances ...
2025-03-12 18:23:06: [retrieval_preprocessing] finished and saved retrieval indices for episode 49 [episode count 3/20]
[retrieval_preprocessing] for episode 50 [episode count 4/20], we have num_retrieval=np.int64(2017) num_query=np.int64(120)
2025-03-12 18:23:06,511 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-12 18:23:06,746 [INFO]: Launching the whole pipeline 03/12/2025, 18:23:06
2025-03-12 18:23:06,746 [INFO]: Reading total number of vectors and dimension 03/12/2025, 18:23:06
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1815.72it/s]
2025-03-12 18:23:06,774 [INFO]: There are 2017 embeddings of dim 49152
2025-03-12 18:23:06,775 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0281 secs
2025-03-12 18:23:06,775 [INFO]: 	Compute estimated construction time of the index 03/12/2025, 18:23:06
2025-03-12 18:23:06,775 [INFO]: 		-> Train: 16.7 minutes
2025-03-12 18:23:06,775 [INFO]: 		-> Add: 1.1 seconds
2025-03-12 18:23:06,775 [INFO]: 		Total: 16.7 minutes
2025-03-12 18:23:06,775 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0001 secs
2025-03-12 18:23:06,775 [INFO]: 	Checking that your have enough memory available to create the index 03/12/2025, 18:23:06
2025-03-12 18:23:06,775 [INFO]: 416.3MB of memory will be needed to build the index (more might be used if you have more)
2025-03-12 18:23:06,775 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0001 secs
2025-03-12 18:23:06,775 [INFO]: 	Selecting most promising index types given data characteristics 03/12/2025, 18:23:06
2025-03-12 18:23:06,775 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-12 18:23:06,775 [INFO]: 	Creating the index 03/12/2025, 18:23:06
2025-03-12 18:23:06,775 [INFO]: 		-> Instanciate the index HNSW15 03/12/2025, 18:23:06
2025-03-12 18:23:06,776 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0011 secs
2025-03-12 18:23:06,776 [INFO]: 		-> Adding the vectors to the index 03/12/2025, 18:23:06
2025-03-12 18:23:06,776 [INFO]: The memory available for adding the vectors is 49.6GB(total available - used by the index)
2025-03-12 18:23:06,776 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/8 [00:00<?, ?it/s] 25%|██▌       | 2/8 [00:00<00:00, 19.65it/s]100%|██████████| 8/8 [00:01<00:00,  5.45it/s]100%|██████████| 8/8 [00:01<00:00,  5.76it/s]
2025-03-12 18:23:08,168 [INFO]: 	Computing best hyperparameters for index knn.index 03/12/2025, 18:23:08
2025-03-12 18:23:29,175 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 21.0063 secs
2025-03-12 18:23:29,175 [INFO]: The best hyperparameters are: efSearch=330
2025-03-12 18:23:29,175 [INFO]: 	Compute fast metrics 03/12/2025, 18:23:29
  0%|          | 0/4 [00:00<?, ?it/s] 75%|███████▌  | 3/4 [00:00<00:00, 29.15it/s] 75%|███████▌  | 3/4 [00:00<00:00, 24.97it/s]
2025-03-12 18:23:40,318 [INFO]: 	>>> Finished "Compute fast metrics" in 11.1426 secs
2025-03-12 18:23:40,319 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 33.5427 secs
2025-03-12 18:23:40,319 [INFO]: {
2025-03-12 18:23:40,319 [INFO]: 	index_key: HNSW15
2025-03-12 18:23:40,319 [INFO]: 	index_param: efSearch=330
2025-03-12 18:23:40,319 [INFO]: 	index_path: knn.index
2025-03-12 18:23:40,319 [INFO]: 	size in bytes: 396832570
2025-03-12 18:23:40,319 [INFO]: 	avg_search_speed_ms: 8.75599821580936
2025-03-12 18:23:40,319 [INFO]: 	99p_search_speed_ms: 12.09072621539235
2025-03-12 18:23:40,319 [INFO]: 	reconstruction error %: 0.0
2025-03-12 18:23:40,319 [INFO]: 	nb vectors: 2017
2025-03-12 18:23:40,319 [INFO]: 	vectors dimension: 49152
2025-03-12 18:23:40,319 [INFO]: 	compression ratio: 0.9993089428118261
2025-03-12 18:23:40,319 [INFO]: }
2025-03-12 18:23:40,319 [INFO]: 	>>> Finished "Creating the index" in 33.5443 secs
2025-03-12 18:23:40,319 [INFO]: >>> Finished "Launching the whole pipeline" in 33.5728 secs
2025-03-12 18:23:41: [retrieval_preprocessing] calculating distances ...
2025-03-12 18:23:41: [retrieval_preprocessing] finished and saved retrieval indices for episode 50 [episode count 4/20]
[retrieval_preprocessing] for episode 51 [episode count 5/20], we have num_retrieval=np.int64(2020) num_query=np.int64(117)
2025-03-12 18:23:41,599 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-12 18:23:41,915 [INFO]: Launching the whole pipeline 03/12/2025, 18:23:41
2025-03-12 18:23:41,915 [INFO]: Reading total number of vectors and dimension 03/12/2025, 18:23:41
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 2387.20it/s]
2025-03-12 18:23:41,942 [INFO]: There are 2020 embeddings of dim 49152
2025-03-12 18:23:41,942 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0266 secs
2025-03-12 18:23:41,942 [INFO]: 	Compute estimated construction time of the index 03/12/2025, 18:23:41
2025-03-12 18:23:41,942 [INFO]: 		-> Train: 16.7 minutes
2025-03-12 18:23:41,942 [INFO]: 		-> Add: 1.1 seconds
2025-03-12 18:23:41,942 [INFO]: 		Total: 16.7 minutes
2025-03-12 18:23:41,942 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0001 secs
2025-03-12 18:23:41,942 [INFO]: 	Checking that your have enough memory available to create the index 03/12/2025, 18:23:41
2025-03-12 18:23:41,942 [INFO]: 416.9MB of memory will be needed to build the index (more might be used if you have more)
2025-03-12 18:23:41,942 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0001 secs
2025-03-12 18:23:41,943 [INFO]: 	Selecting most promising index types given data characteristics 03/12/2025, 18:23:41
2025-03-12 18:23:41,943 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-12 18:23:41,943 [INFO]: 	Creating the index 03/12/2025, 18:23:41
2025-03-12 18:23:41,943 [INFO]: 		-> Instanciate the index HNSW15 03/12/2025, 18:23:41
2025-03-12 18:23:41,944 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0010 secs
2025-03-12 18:23:41,944 [INFO]: 		-> Adding the vectors to the index 03/12/2025, 18:23:41
2025-03-12 18:23:41,944 [INFO]: The memory available for adding the vectors is 49.6GB(total available - used by the index)
2025-03-12 18:23:41,944 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/8 [00:00<?, ?it/s] 38%|███▊      | 3/8 [00:00<00:00, 28.65it/s]100%|██████████| 8/8 [00:01<00:00,  5.71it/s]100%|██████████| 8/8 [00:01<00:00,  6.27it/s]
2025-03-12 18:23:43,224 [INFO]: 	Computing best hyperparameters for index knn.index 03/12/2025, 18:23:43
2025-03-12 18:24:04,096 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 20.8718 secs
2025-03-12 18:24:04,096 [INFO]: The best hyperparameters are: efSearch=360
2025-03-12 18:24:04,096 [INFO]: 	Compute fast metrics 03/12/2025, 18:24:04
  0%|          | 0/4 [00:00<?, ?it/s] 75%|███████▌  | 3/4 [00:00<00:00, 26.19it/s]
2025-03-12 18:24:15,255 [INFO]: 	>>> Finished "Compute fast metrics" in 11.1583 secs
2025-03-12 18:24:15,256 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 33.3119 secs
2025-03-12 18:24:15,256 [INFO]: {
2025-03-12 18:24:15,256 [INFO]: 	index_key: HNSW15
2025-03-12 18:24:15,256 [INFO]: 	index_param: efSearch=360
2025-03-12 18:24:15,256 [INFO]: 	index_path: knn.index
2025-03-12 18:24:15,256 [INFO]: 	size in bytes: 397422850
2025-03-12 18:24:15,256 [INFO]: 	avg_search_speed_ms: 9.710099847390524
2025-03-12 18:24:15,256 [INFO]: 	99p_search_speed_ms: 13.005398795939984
2025-03-12 18:24:15,256 [INFO]: 	reconstruction error %: 0.0
2025-03-12 18:24:15,256 [INFO]: 	nb vectors: 2020
2025-03-12 18:24:15,256 [INFO]: 	vectors dimension: 49152
2025-03-12 18:24:15,256 [INFO]: 	compression ratio: 0.9993088218254185
2025-03-12 18:24:15,256 [INFO]: }
2025-03-12 18:24:15,256 [INFO]: 	>>> Finished "Creating the index" in 33.3135 secs
2025-03-12 18:24:15,256 [INFO]: >>> Finished "Launching the whole pipeline" in 33.3407 secs
2025-03-12 18:24:16: [retrieval_preprocessing] calculating distances ...
2025-03-12 18:24:16: [retrieval_preprocessing] finished and saved retrieval indices for episode 51 [episode count 5/20]
[retrieval_preprocessing] for episode 52 [episode count 6/20], we have num_retrieval=np.int64(2043) num_query=np.int64(94)
2025-03-12 18:24:16,837 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-12 18:24:17,074 [INFO]: Launching the whole pipeline 03/12/2025, 18:24:17
2025-03-12 18:24:17,074 [INFO]: Reading total number of vectors and dimension 03/12/2025, 18:24:17
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1784.05it/s]
2025-03-12 18:24:17,102 [INFO]: There are 2043 embeddings of dim 49152
2025-03-12 18:24:17,102 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0278 secs
2025-03-12 18:24:17,102 [INFO]: 	Compute estimated construction time of the index 03/12/2025, 18:24:17
2025-03-12 18:24:17,102 [INFO]: 		-> Train: 16.7 minutes
2025-03-12 18:24:17,102 [INFO]: 		-> Add: 1.1 seconds
2025-03-12 18:24:17,102 [INFO]: 		Total: 16.7 minutes
2025-03-12 18:24:17,102 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0001 secs
2025-03-12 18:24:17,102 [INFO]: 	Checking that your have enough memory available to create the index 03/12/2025, 18:24:17
2025-03-12 18:24:17,103 [INFO]: 421.6MB of memory will be needed to build the index (more might be used if you have more)
2025-03-12 18:24:17,103 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0001 secs
2025-03-12 18:24:17,103 [INFO]: 	Selecting most promising index types given data characteristics 03/12/2025, 18:24:17
2025-03-12 18:24:17,103 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-12 18:24:17,103 [INFO]: 	Creating the index 03/12/2025, 18:24:17
2025-03-12 18:24:17,103 [INFO]: 		-> Instanciate the index HNSW15 03/12/2025, 18:24:17
2025-03-12 18:24:17,104 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0008 secs
2025-03-12 18:24:17,104 [INFO]: 		-> Adding the vectors to the index 03/12/2025, 18:24:17
2025-03-12 18:24:17,104 [INFO]: The memory available for adding the vectors is 49.6GB(total available - used by the index)
2025-03-12 18:24:17,104 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/9 [00:00<?, ?it/s] 33%|███▎      | 3/9 [00:00<00:00, 26.24it/s]100%|██████████| 9/9 [00:01<00:00,  6.28it/s]100%|██████████| 9/9 [00:01<00:00,  6.79it/s]
2025-03-12 18:24:18,432 [INFO]: 	Computing best hyperparameters for index knn.index 03/12/2025, 18:24:18
2025-03-12 18:24:38,489 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 20.0562 secs
2025-03-12 18:24:38,489 [INFO]: The best hyperparameters are: efSearch=362
2025-03-12 18:24:38,489 [INFO]: 	Compute fast metrics 03/12/2025, 18:24:38
  0%|          | 0/4 [00:00<?, ?it/s] 75%|███████▌  | 3/4 [00:00<00:00, 28.02it/s] 75%|███████▌  | 3/4 [00:00<00:00, 24.82it/s]
2025-03-12 18:24:49,762 [INFO]: 	>>> Finished "Compute fast metrics" in 11.2731 secs
2025-03-12 18:24:49,763 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 32.6594 secs
2025-03-12 18:24:49,763 [INFO]: {
2025-03-12 18:24:49,763 [INFO]: 	index_key: HNSW15
2025-03-12 18:24:49,763 [INFO]: 	index_param: efSearch=362
2025-03-12 18:24:49,763 [INFO]: 	index_path: knn.index
2025-03-12 18:24:49,763 [INFO]: 	size in bytes: 401947990
2025-03-12 18:24:49,763 [INFO]: 	avg_search_speed_ms: 9.604364185791738
2025-03-12 18:24:49,763 [INFO]: 	99p_search_speed_ms: 11.926067806780338
2025-03-12 18:24:49,763 [INFO]: 	reconstruction error %: 0.0
2025-03-12 18:24:49,763 [INFO]: 	nb vectors: 2043
2025-03-12 18:24:49,763 [INFO]: 	vectors dimension: 49152
2025-03-12 18:24:49,763 [INFO]: 	compression ratio: 0.9993087513635781
2025-03-12 18:24:49,763 [INFO]: }
2025-03-12 18:24:49,763 [INFO]: 	>>> Finished "Creating the index" in 32.6607 secs
2025-03-12 18:24:49,763 [INFO]: >>> Finished "Launching the whole pipeline" in 32.6890 secs
2025-03-12 18:24:50: [retrieval_preprocessing] calculating distances ...
2025-03-12 18:24:50: [retrieval_preprocessing] finished and saved retrieval indices for episode 52 [episode count 6/20]
[retrieval_preprocessing] for episode 53 [episode count 7/20], we have num_retrieval=np.int64(2035) num_query=np.int64(102)
2025-03-12 18:24:51,065 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-12 18:24:51,300 [INFO]: Launching the whole pipeline 03/12/2025, 18:24:51
2025-03-12 18:24:51,300 [INFO]: Reading total number of vectors and dimension 03/12/2025, 18:24:51
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1909.97it/s]
2025-03-12 18:24:51,325 [INFO]: There are 2035 embeddings of dim 49152
2025-03-12 18:24:51,325 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0254 secs
2025-03-12 18:24:51,325 [INFO]: 	Compute estimated construction time of the index 03/12/2025, 18:24:51
2025-03-12 18:24:51,325 [INFO]: 		-> Train: 16.7 minutes
2025-03-12 18:24:51,325 [INFO]: 		-> Add: 1.1 seconds
2025-03-12 18:24:51,325 [INFO]: 		Total: 16.7 minutes
2025-03-12 18:24:51,325 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0001 secs
2025-03-12 18:24:51,325 [INFO]: 	Checking that your have enough memory available to create the index 03/12/2025, 18:24:51
2025-03-12 18:24:51,326 [INFO]: 420.0MB of memory will be needed to build the index (more might be used if you have more)
2025-03-12 18:24:51,326 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0001 secs
2025-03-12 18:24:51,326 [INFO]: 	Selecting most promising index types given data characteristics 03/12/2025, 18:24:51
2025-03-12 18:24:51,326 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-12 18:24:51,326 [INFO]: 	Creating the index 03/12/2025, 18:24:51
2025-03-12 18:24:51,326 [INFO]: 		-> Instanciate the index HNSW15 03/12/2025, 18:24:51
2025-03-12 18:24:51,327 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0009 secs
2025-03-12 18:24:51,327 [INFO]: 		-> Adding the vectors to the index 03/12/2025, 18:24:51
2025-03-12 18:24:51,327 [INFO]: The memory available for adding the vectors is 49.6GB(total available - used by the index)
2025-03-12 18:24:51,327 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/9 [00:00<?, ?it/s] 22%|██▏       | 2/9 [00:00<00:00, 19.13it/s]100%|██████████| 9/9 [00:01<00:00,  6.70it/s]100%|██████████| 9/9 [00:01<00:00,  6.99it/s]
2025-03-12 18:24:52,618 [INFO]: 	Computing best hyperparameters for index knn.index 03/12/2025, 18:24:52
2025-03-12 18:25:12,387 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 19.7689 secs
2025-03-12 18:25:12,387 [INFO]: The best hyperparameters are: efSearch=385
2025-03-12 18:25:12,387 [INFO]: 	Compute fast metrics 03/12/2025, 18:25:12
  0%|          | 0/4 [00:00<?, ?it/s] 75%|███████▌  | 3/4 [00:00<00:00, 28.74it/s] 75%|███████▌  | 3/4 [00:00<00:00, 24.88it/s]
2025-03-12 18:25:23,590 [INFO]: 	>>> Finished "Compute fast metrics" in 11.2028 secs
2025-03-12 18:25:23,591 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 32.2646 secs
2025-03-12 18:25:23,592 [INFO]: {
2025-03-12 18:25:23,592 [INFO]: 	index_key: HNSW15
2025-03-12 18:25:23,592 [INFO]: 	index_param: efSearch=385
2025-03-12 18:25:23,592 [INFO]: 	index_path: knn.index
2025-03-12 18:25:23,592 [INFO]: 	size in bytes: 400374010
2025-03-12 18:25:23,592 [INFO]: 	avg_search_speed_ms: 10.382970234454529
2025-03-12 18:25:23,592 [INFO]: 	99p_search_speed_ms: 13.532053623348475
2025-03-12 18:25:23,592 [INFO]: 	reconstruction error %: 0.0
2025-03-12 18:25:23,592 [INFO]: 	nb vectors: 2035
2025-03-12 18:25:23,592 [INFO]: 	vectors dimension: 49152
2025-03-12 18:25:23,592 [INFO]: 	compression ratio: 0.9993088212693926
2025-03-12 18:25:23,592 [INFO]: }
2025-03-12 18:25:23,592 [INFO]: 	>>> Finished "Creating the index" in 32.2663 secs
2025-03-12 18:25:23,592 [INFO]: >>> Finished "Launching the whole pipeline" in 32.2922 secs
2025-03-12 18:25:24: [retrieval_preprocessing] calculating distances ...
2025-03-12 18:25:24: [retrieval_preprocessing] finished and saved retrieval indices for episode 53 [episode count 7/20]
[retrieval_preprocessing] for episode 54 [episode count 8/20], we have num_retrieval=np.int64(2039) num_query=np.int64(98)
2025-03-12 18:25:24,985 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-12 18:25:25,216 [INFO]: Launching the whole pipeline 03/12/2025, 18:25:25
2025-03-12 18:25:25,216 [INFO]: Reading total number of vectors and dimension 03/12/2025, 18:25:25
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 2537.39it/s]
2025-03-12 18:25:25,244 [INFO]: There are 2039 embeddings of dim 49152
2025-03-12 18:25:25,244 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0280 secs
2025-03-12 18:25:25,244 [INFO]: 	Compute estimated construction time of the index 03/12/2025, 18:25:25
2025-03-12 18:25:25,244 [INFO]: 		-> Train: 16.7 minutes
2025-03-12 18:25:25,244 [INFO]: 		-> Add: 1.1 seconds
2025-03-12 18:25:25,244 [INFO]: 		Total: 16.7 minutes
2025-03-12 18:25:25,244 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0001 secs
2025-03-12 18:25:25,244 [INFO]: 	Checking that your have enough memory available to create the index 03/12/2025, 18:25:25
2025-03-12 18:25:25,244 [INFO]: 420.8MB of memory will be needed to build the index (more might be used if you have more)
2025-03-12 18:25:25,244 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0001 secs
2025-03-12 18:25:25,244 [INFO]: 	Selecting most promising index types given data characteristics 03/12/2025, 18:25:25
2025-03-12 18:25:25,244 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-12 18:25:25,244 [INFO]: 	Creating the index 03/12/2025, 18:25:25
2025-03-12 18:25:25,244 [INFO]: 		-> Instanciate the index HNSW15 03/12/2025, 18:25:25
2025-03-12 18:25:25,245 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0008 secs
2025-03-12 18:25:25,245 [INFO]: 		-> Adding the vectors to the index 03/12/2025, 18:25:25
2025-03-12 18:25:25,245 [INFO]: The memory available for adding the vectors is 49.6GB(total available - used by the index)
2025-03-12 18:25:25,245 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/9 [00:00<?, ?it/s] 33%|███▎      | 3/9 [00:00<00:00, 27.14it/s]100%|██████████| 9/9 [00:01<00:00,  6.60it/s]100%|██████████| 9/9 [00:01<00:00,  7.13it/s]
2025-03-12 18:25:26,510 [INFO]: 	Computing best hyperparameters for index knn.index 03/12/2025, 18:25:26
2025-03-12 18:25:46,316 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 19.8062 secs
2025-03-12 18:25:46,317 [INFO]: The best hyperparameters are: efSearch=366
2025-03-12 18:25:46,317 [INFO]: 	Compute fast metrics 03/12/2025, 18:25:46
  0%|          | 0/4 [00:00<?, ?it/s] 75%|███████▌  | 3/4 [00:00<00:00, 27.81it/s] 75%|███████▌  | 3/4 [00:00<00:00, 24.38it/s]
2025-03-12 18:25:57,464 [INFO]: 	>>> Finished "Compute fast metrics" in 11.1474 secs
2025-03-12 18:25:57,465 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 32.2201 secs
2025-03-12 18:25:57,465 [INFO]: {
2025-03-12 18:25:57,465 [INFO]: 	index_key: HNSW15
2025-03-12 18:25:57,465 [INFO]: 	index_param: efSearch=366
2025-03-12 18:25:57,465 [INFO]: 	index_path: knn.index
2025-03-12 18:25:57,465 [INFO]: 	size in bytes: 401161030
2025-03-12 18:25:57,465 [INFO]: 	avg_search_speed_ms: 9.57526658732961
2025-03-12 18:25:57,465 [INFO]: 	99p_search_speed_ms: 12.842445783317087
2025-03-12 18:25:57,466 [INFO]: 	reconstruction error %: 0.0
2025-03-12 18:25:57,466 [INFO]: 	nb vectors: 2039
2025-03-12 18:25:57,466 [INFO]: 	vectors dimension: 49152
2025-03-12 18:25:57,466 [INFO]: 	compression ratio: 0.9993087115166696
2025-03-12 18:25:57,466 [INFO]: }
2025-03-12 18:25:57,466 [INFO]: 	>>> Finished "Creating the index" in 32.2214 secs
2025-03-12 18:25:57,466 [INFO]: >>> Finished "Launching the whole pipeline" in 32.2499 secs
2025-03-12 18:25:58: [retrieval_preprocessing] calculating distances ...
2025-03-12 18:25:58: [retrieval_preprocessing] finished and saved retrieval indices for episode 54 [episode count 8/20]
[retrieval_preprocessing] for episode 55 [episode count 9/20], we have num_retrieval=np.int64(2027) num_query=np.int64(110)
2025-03-12 18:25:58,742 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-12 18:25:58,975 [INFO]: Launching the whole pipeline 03/12/2025, 18:25:58
2025-03-12 18:25:58,975 [INFO]: Reading total number of vectors and dimension 03/12/2025, 18:25:58
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1500.11it/s]
2025-03-12 18:25:58,999 [INFO]: There are 2027 embeddings of dim 49152
2025-03-12 18:25:58,999 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0243 secs
2025-03-12 18:25:58,999 [INFO]: 	Compute estimated construction time of the index 03/12/2025, 18:25:58
2025-03-12 18:25:58,999 [INFO]: 		-> Train: 16.7 minutes
2025-03-12 18:25:58,999 [INFO]: 		-> Add: 1.1 seconds
2025-03-12 18:25:58,999 [INFO]: 		Total: 16.7 minutes
2025-03-12 18:25:58,999 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0001 secs
2025-03-12 18:25:58,999 [INFO]: 	Checking that your have enough memory available to create the index 03/12/2025, 18:25:58
2025-03-12 18:25:58,999 [INFO]: 418.3MB of memory will be needed to build the index (more might be used if you have more)
2025-03-12 18:25:58,999 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0001 secs
2025-03-12 18:25:58,999 [INFO]: 	Selecting most promising index types given data characteristics 03/12/2025, 18:25:58
2025-03-12 18:25:58,999 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-12 18:25:59,000 [INFO]: 	Creating the index 03/12/2025, 18:25:59
2025-03-12 18:25:59,000 [INFO]: 		-> Instanciate the index HNSW15 03/12/2025, 18:25:59
2025-03-12 18:25:59,000 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0009 secs
2025-03-12 18:25:59,001 [INFO]: 		-> Adding the vectors to the index 03/12/2025, 18:25:59
2025-03-12 18:25:59,001 [INFO]: The memory available for adding the vectors is 49.6GB(total available - used by the index)
2025-03-12 18:25:59,001 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/8 [00:00<?, ?it/s] 25%|██▌       | 2/8 [00:00<00:00, 18.71it/s]100%|██████████| 8/8 [00:01<00:00,  5.79it/s]100%|██████████| 8/8 [00:01<00:00,  6.10it/s]
2025-03-12 18:26:00,314 [INFO]: 	Computing best hyperparameters for index knn.index 03/12/2025, 18:26:00
2025-03-12 18:26:21,353 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 21.0382 secs
2025-03-12 18:26:21,353 [INFO]: The best hyperparameters are: efSearch=349
2025-03-12 18:26:21,353 [INFO]: 	Compute fast metrics 03/12/2025, 18:26:21
  0%|          | 0/4 [00:00<?, ?it/s] 75%|███████▌  | 3/4 [00:00<00:00, 29.42it/s] 75%|███████▌  | 3/4 [00:00<00:00, 25.46it/s]
2025-03-12 18:26:32,911 [INFO]: 	>>> Finished "Compute fast metrics" in 11.5575 secs
2025-03-12 18:26:32,912 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 33.9111 secs
2025-03-12 18:26:32,912 [INFO]: {
2025-03-12 18:26:32,912 [INFO]: 	index_key: HNSW15
2025-03-12 18:26:32,912 [INFO]: 	index_param: efSearch=349
2025-03-12 18:26:32,912 [INFO]: 	index_path: knn.index
2025-03-12 18:26:32,912 [INFO]: 	size in bytes: 398800090
2025-03-12 18:26:32,912 [INFO]: 	avg_search_speed_ms: 9.216072260131758
2025-03-12 18:26:32,912 [INFO]: 	99p_search_speed_ms: 12.516219886019826
2025-03-12 18:26:32,912 [INFO]: 	reconstruction error %: 0.0
2025-03-12 18:26:32,912 [INFO]: 	nb vectors: 2027
2025-03-12 18:26:32,912 [INFO]: 	vectors dimension: 49152
2025-03-12 18:26:32,912 [INFO]: 	compression ratio: 0.9993087413796722
2025-03-12 18:26:32,912 [INFO]: }
2025-03-12 18:26:32,912 [INFO]: 	>>> Finished "Creating the index" in 33.9124 secs
2025-03-12 18:26:32,912 [INFO]: >>> Finished "Launching the whole pipeline" in 33.9372 secs
2025-03-12 18:26:33: [retrieval_preprocessing] calculating distances ...
2025-03-12 18:26:34: [retrieval_preprocessing] finished and saved retrieval indices for episode 55 [episode count 9/20]
[retrieval_preprocessing] for episode 56 [episode count 10/20], we have num_retrieval=np.int64(2037) num_query=np.int64(100)
2025-03-12 18:26:34,336 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-12 18:26:34,571 [INFO]: Launching the whole pipeline 03/12/2025, 18:26:34
2025-03-12 18:26:34,571 [INFO]: Reading total number of vectors and dimension 03/12/2025, 18:26:34
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 2136.68it/s]
2025-03-12 18:26:34,598 [INFO]: There are 2037 embeddings of dim 49152
2025-03-12 18:26:34,598 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0271 secs
2025-03-12 18:26:34,598 [INFO]: 	Compute estimated construction time of the index 03/12/2025, 18:26:34
2025-03-12 18:26:34,598 [INFO]: 		-> Train: 16.7 minutes
2025-03-12 18:26:34,598 [INFO]: 		-> Add: 1.1 seconds
2025-03-12 18:26:34,598 [INFO]: 		Total: 16.7 minutes
2025-03-12 18:26:34,598 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0001 secs
2025-03-12 18:26:34,598 [INFO]: 	Checking that your have enough memory available to create the index 03/12/2025, 18:26:34
2025-03-12 18:26:34,598 [INFO]: 420.4MB of memory will be needed to build the index (more might be used if you have more)
2025-03-12 18:26:34,598 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0001 secs
2025-03-12 18:26:34,598 [INFO]: 	Selecting most promising index types given data characteristics 03/12/2025, 18:26:34
2025-03-12 18:26:34,598 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-12 18:26:34,598 [INFO]: 	Creating the index 03/12/2025, 18:26:34
2025-03-12 18:26:34,598 [INFO]: 		-> Instanciate the index HNSW15 03/12/2025, 18:26:34
2025-03-12 18:26:34,599 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0009 secs
2025-03-12 18:26:34,599 [INFO]: 		-> Adding the vectors to the index 03/12/2025, 18:26:34
2025-03-12 18:26:34,599 [INFO]: The memory available for adding the vectors is 49.6GB(total available - used by the index)
2025-03-12 18:26:34,600 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/9 [00:00<?, ?it/s] 33%|███▎      | 3/9 [00:00<00:00, 27.47it/s]100%|██████████| 9/9 [00:01<00:00,  6.64it/s]100%|██████████| 9/9 [00:01<00:00,  7.17it/s]
2025-03-12 18:26:35,857 [INFO]: 	Computing best hyperparameters for index knn.index 03/12/2025, 18:26:35
2025-03-12 18:26:55,852 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 19.9948 secs
2025-03-12 18:26:55,852 [INFO]: The best hyperparameters are: efSearch=373
2025-03-12 18:26:55,852 [INFO]: 	Compute fast metrics 03/12/2025, 18:26:55
  0%|          | 0/4 [00:00<?, ?it/s] 75%|███████▌  | 3/4 [00:00<00:00, 26.90it/s] 75%|███████▌  | 3/4 [00:00<00:00, 23.40it/s]
2025-03-12 18:27:07,102 [INFO]: 	>>> Finished "Compute fast metrics" in 11.2502 secs
2025-03-12 18:27:07,104 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 32.5042 secs
2025-03-12 18:27:07,104 [INFO]: {
2025-03-12 18:27:07,104 [INFO]: 	index_key: HNSW15
2025-03-12 18:27:07,104 [INFO]: 	index_param: efSearch=373
2025-03-12 18:27:07,104 [INFO]: 	index_path: knn.index
2025-03-12 18:27:07,104 [INFO]: 	size in bytes: 400767550
2025-03-12 18:27:07,104 [INFO]: 	avg_search_speed_ms: 10.025439614556984
2025-03-12 18:27:07,104 [INFO]: 	99p_search_speed_ms: 13.733060699887574
2025-03-12 18:27:07,104 [INFO]: 	reconstruction error %: 0.0
2025-03-12 18:27:07,104 [INFO]: 	nb vectors: 2037
2025-03-12 18:27:07,104 [INFO]: 	vectors dimension: 49152
2025-03-12 18:27:07,104 [INFO]: 	compression ratio: 0.9993086915345317
2025-03-12 18:27:07,104 [INFO]: }
2025-03-12 18:27:07,104 [INFO]: 	>>> Finished "Creating the index" in 32.5055 secs
2025-03-12 18:27:07,104 [INFO]: >>> Finished "Launching the whole pipeline" in 32.5332 secs
2025-03-12 18:27:08: [retrieval_preprocessing] calculating distances ...
2025-03-12 18:27:08: [retrieval_preprocessing] finished and saved retrieval indices for episode 56 [episode count 10/20]
[retrieval_preprocessing] for episode 57 [episode count 11/20], we have num_retrieval=np.int64(2036) num_query=np.int64(101)
2025-03-12 18:27:08,456 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-12 18:27:08,692 [INFO]: Launching the whole pipeline 03/12/2025, 18:27:08
2025-03-12 18:27:08,692 [INFO]: Reading total number of vectors and dimension 03/12/2025, 18:27:08
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 2347.12it/s]
2025-03-12 18:27:08,717 [INFO]: There are 2036 embeddings of dim 49152
2025-03-12 18:27:08,718 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0251 secs
2025-03-12 18:27:08,718 [INFO]: 	Compute estimated construction time of the index 03/12/2025, 18:27:08
2025-03-12 18:27:08,718 [INFO]: 		-> Train: 16.7 minutes
2025-03-12 18:27:08,718 [INFO]: 		-> Add: 1.1 seconds
2025-03-12 18:27:08,718 [INFO]: 		Total: 16.7 minutes
2025-03-12 18:27:08,718 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0001 secs
2025-03-12 18:27:08,718 [INFO]: 	Checking that your have enough memory available to create the index 03/12/2025, 18:27:08
2025-03-12 18:27:08,718 [INFO]: 420.2MB of memory will be needed to build the index (more might be used if you have more)
2025-03-12 18:27:08,718 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0001 secs
2025-03-12 18:27:08,718 [INFO]: 	Selecting most promising index types given data characteristics 03/12/2025, 18:27:08
2025-03-12 18:27:08,718 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-12 18:27:08,718 [INFO]: 	Creating the index 03/12/2025, 18:27:08
2025-03-12 18:27:08,718 [INFO]: 		-> Instanciate the index HNSW15 03/12/2025, 18:27:08
2025-03-12 18:27:08,719 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0009 secs
2025-03-12 18:27:08,719 [INFO]: 		-> Adding the vectors to the index 03/12/2025, 18:27:08
2025-03-12 18:27:08,719 [INFO]: The memory available for adding the vectors is 49.6GB(total available - used by the index)
2025-03-12 18:27:08,719 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/9 [00:00<?, ?it/s] 33%|███▎      | 3/9 [00:00<00:00, 28.97it/s]100%|██████████| 9/9 [00:01<00:00,  6.69it/s]100%|██████████| 9/9 [00:01<00:00,  7.24it/s]
2025-03-12 18:27:09,965 [INFO]: 	Computing best hyperparameters for index knn.index 03/12/2025, 18:27:09
2025-03-12 18:27:29,728 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 19.7624 secs
2025-03-12 18:27:29,728 [INFO]: The best hyperparameters are: efSearch=366
2025-03-12 18:27:29,728 [INFO]: 	Compute fast metrics 03/12/2025, 18:27:29
  0%|          | 0/4 [00:00<?, ?it/s] 75%|███████▌  | 3/4 [00:00<00:00, 26.11it/s]
2025-03-12 18:27:40,926 [INFO]: 	>>> Finished "Compute fast metrics" in 11.1978 secs
2025-03-12 18:27:40,927 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 32.2080 secs
2025-03-12 18:27:40,927 [INFO]: {
2025-03-12 18:27:40,927 [INFO]: 	index_key: HNSW15
2025-03-12 18:27:40,927 [INFO]: 	index_param: efSearch=366
2025-03-12 18:27:40,927 [INFO]: 	index_path: knn.index
2025-03-12 18:27:40,927 [INFO]: 	size in bytes: 400570810
2025-03-12 18:27:40,927 [INFO]: 	avg_search_speed_ms: 9.164064846878254
2025-03-12 18:27:40,927 [INFO]: 	99p_search_speed_ms: 12.578236870467661
2025-03-12 18:27:40,927 [INFO]: 	reconstruction error %: 0.0
2025-03-12 18:27:40,927 [INFO]: 	nb vectors: 2036
2025-03-12 18:27:40,927 [INFO]: 	vectors dimension: 49152
2025-03-12 18:27:40,927 [INFO]: 	compression ratio: 0.9993086815287414
2025-03-12 18:27:40,927 [INFO]: }
2025-03-12 18:27:40,928 [INFO]: 	>>> Finished "Creating the index" in 32.2094 secs
2025-03-12 18:27:40,928 [INFO]: >>> Finished "Launching the whole pipeline" in 32.2350 secs
2025-03-12 18:27:41: [retrieval_preprocessing] calculating distances ...
2025-03-12 18:27:42: [retrieval_preprocessing] finished and saved retrieval indices for episode 57 [episode count 11/20]
[retrieval_preprocessing] for episode 58 [episode count 12/20], we have num_retrieval=np.int64(2038) num_query=np.int64(99)
2025-03-12 18:27:42,283 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-12 18:27:42,517 [INFO]: Launching the whole pipeline 03/12/2025, 18:27:42
2025-03-12 18:27:42,517 [INFO]: Reading total number of vectors and dimension 03/12/2025, 18:27:42
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 2027.21it/s]
2025-03-12 18:27:42,543 [INFO]: There are 2038 embeddings of dim 49152
2025-03-12 18:27:42,543 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0268 secs
2025-03-12 18:27:42,544 [INFO]: 	Compute estimated construction time of the index 03/12/2025, 18:27:42
2025-03-12 18:27:42,544 [INFO]: 		-> Train: 16.7 minutes
2025-03-12 18:27:42,544 [INFO]: 		-> Add: 1.1 seconds
2025-03-12 18:27:42,544 [INFO]: 		Total: 16.7 minutes
2025-03-12 18:27:42,544 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0001 secs
2025-03-12 18:27:42,544 [INFO]: 	Checking that your have enough memory available to create the index 03/12/2025, 18:27:42
2025-03-12 18:27:42,544 [INFO]: 420.6MB of memory will be needed to build the index (more might be used if you have more)
2025-03-12 18:27:42,544 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0001 secs
2025-03-12 18:27:42,544 [INFO]: 	Selecting most promising index types given data characteristics 03/12/2025, 18:27:42
2025-03-12 18:27:42,544 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-12 18:27:42,544 [INFO]: 	Creating the index 03/12/2025, 18:27:42
2025-03-12 18:27:42,544 [INFO]: 		-> Instanciate the index HNSW15 03/12/2025, 18:27:42
2025-03-12 18:27:42,545 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0009 secs
2025-03-12 18:27:42,545 [INFO]: 		-> Adding the vectors to the index 03/12/2025, 18:27:42
2025-03-12 18:27:42,545 [INFO]: The memory available for adding the vectors is 49.6GB(total available - used by the index)
2025-03-12 18:27:42,545 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/9 [00:00<?, ?it/s] 22%|██▏       | 2/9 [00:00<00:00, 18.38it/s]100%|██████████| 9/9 [00:01<00:00,  6.76it/s]100%|██████████| 9/9 [00:01<00:00,  7.05it/s]
2025-03-12 18:27:43,824 [INFO]: 	Computing best hyperparameters for index knn.index 03/12/2025, 18:27:43
2025-03-12 18:28:02,817 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 18.9924 secs
2025-03-12 18:28:02,817 [INFO]: The best hyperparameters are: efSearch=388
2025-03-12 18:28:02,817 [INFO]: 	Compute fast metrics 03/12/2025, 18:28:02
  0%|          | 0/4 [00:00<?, ?it/s] 75%|███████▌  | 3/4 [00:00<00:00, 28.58it/s] 75%|███████▌  | 3/4 [00:00<00:00, 25.44it/s]
2025-03-12 18:28:14,063 [INFO]: 	>>> Finished "Compute fast metrics" in 11.2459 secs
2025-03-12 18:28:14,064 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 31.5190 secs
2025-03-12 18:28:14,064 [INFO]: {
2025-03-12 18:28:14,064 [INFO]: 	index_key: HNSW15
2025-03-12 18:28:14,064 [INFO]: 	index_param: efSearch=388
2025-03-12 18:28:14,064 [INFO]: 	index_path: knn.index
2025-03-12 18:28:14,064 [INFO]: 	size in bytes: 400964290
2025-03-12 18:28:14,064 [INFO]: 	avg_search_speed_ms: 9.482947277275942
2025-03-12 18:28:14,064 [INFO]: 	99p_search_speed_ms: 12.011844981461763
2025-03-12 18:28:14,064 [INFO]: 	reconstruction error %: 0.0
2025-03-12 18:28:14,064 [INFO]: 	nb vectors: 2038
2025-03-12 18:28:14,064 [INFO]: 	vectors dimension: 49152
2025-03-12 18:28:14,064 [INFO]: 	compression ratio: 0.9993087015305029
2025-03-12 18:28:14,064 [INFO]: }
2025-03-12 18:28:14,064 [INFO]: 	>>> Finished "Creating the index" in 31.5203 secs
2025-03-12 18:28:14,064 [INFO]: >>> Finished "Launching the whole pipeline" in 31.5476 secs
2025-03-12 18:28:15: [retrieval_preprocessing] calculating distances ...
2025-03-12 18:28:15: [retrieval_preprocessing] finished and saved retrieval indices for episode 58 [episode count 12/20]
[retrieval_preprocessing] for episode 59 [episode count 13/20], we have num_retrieval=np.int64(2020) num_query=np.int64(117)
2025-03-12 18:28:15,491 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-12 18:28:15,717 [INFO]: Launching the whole pipeline 03/12/2025, 18:28:15
2025-03-12 18:28:15,717 [INFO]: Reading total number of vectors and dimension 03/12/2025, 18:28:15
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 2299.51it/s]
2025-03-12 18:28:15,742 [INFO]: There are 2020 embeddings of dim 49152
2025-03-12 18:28:15,742 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0244 secs
2025-03-12 18:28:15,742 [INFO]: 	Compute estimated construction time of the index 03/12/2025, 18:28:15
2025-03-12 18:28:15,742 [INFO]: 		-> Train: 16.7 minutes
2025-03-12 18:28:15,742 [INFO]: 		-> Add: 1.1 seconds
2025-03-12 18:28:15,742 [INFO]: 		Total: 16.7 minutes
2025-03-12 18:28:15,742 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0001 secs
2025-03-12 18:28:15,742 [INFO]: 	Checking that your have enough memory available to create the index 03/12/2025, 18:28:15
2025-03-12 18:28:15,742 [INFO]: 416.9MB of memory will be needed to build the index (more might be used if you have more)
2025-03-12 18:28:15,742 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0001 secs
2025-03-12 18:28:15,742 [INFO]: 	Selecting most promising index types given data characteristics 03/12/2025, 18:28:15
2025-03-12 18:28:15,742 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-12 18:28:15,742 [INFO]: 	Creating the index 03/12/2025, 18:28:15
2025-03-12 18:28:15,742 [INFO]: 		-> Instanciate the index HNSW15 03/12/2025, 18:28:15
2025-03-12 18:28:15,743 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0010 secs
2025-03-12 18:28:15,744 [INFO]: 		-> Adding the vectors to the index 03/12/2025, 18:28:15
2025-03-12 18:28:15,744 [INFO]: The memory available for adding the vectors is 49.6GB(total available - used by the index)
2025-03-12 18:28:15,744 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/8 [00:00<?, ?it/s] 25%|██▌       | 2/8 [00:00<00:00, 19.06it/s]100%|██████████| 8/8 [00:01<00:00,  6.08it/s]100%|██████████| 8/8 [00:01<00:00,  6.40it/s]
2025-03-12 18:28:16,998 [INFO]: 	Computing best hyperparameters for index knn.index 03/12/2025, 18:28:16
2025-03-12 18:28:36,160 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 19.1622 secs
2025-03-12 18:28:36,160 [INFO]: The best hyperparameters are: efSearch=386
2025-03-12 18:28:36,161 [INFO]: 	Compute fast metrics 03/12/2025, 18:28:36
  0%|          | 0/4 [00:00<?, ?it/s] 75%|███████▌  | 3/4 [00:00<00:00, 28.88it/s] 75%|███████▌  | 3/4 [00:00<00:00, 24.92it/s]
2025-03-12 18:28:47,473 [INFO]: 	>>> Finished "Compute fast metrics" in 11.3126 secs
2025-03-12 18:28:47,474 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 31.7308 secs
2025-03-12 18:28:47,474 [INFO]: {
2025-03-12 18:28:47,475 [INFO]: 	index_key: HNSW15
2025-03-12 18:28:47,475 [INFO]: 	index_param: efSearch=386
2025-03-12 18:28:47,475 [INFO]: 	index_path: knn.index
2025-03-12 18:28:47,475 [INFO]: 	size in bytes: 397422850
2025-03-12 18:28:47,475 [INFO]: 	avg_search_speed_ms: 9.597436997739173
2025-03-12 18:28:47,475 [INFO]: 	99p_search_speed_ms: 12.942321812733999
2025-03-12 18:28:47,475 [INFO]: 	reconstruction error %: 0.0
2025-03-12 18:28:47,475 [INFO]: 	nb vectors: 2020
2025-03-12 18:28:47,475 [INFO]: 	vectors dimension: 49152
2025-03-12 18:28:47,475 [INFO]: 	compression ratio: 0.9993088218254185
2025-03-12 18:28:47,475 [INFO]: }
2025-03-12 18:28:47,475 [INFO]: 	>>> Finished "Creating the index" in 31.7323 secs
2025-03-12 18:28:47,475 [INFO]: >>> Finished "Launching the whole pipeline" in 31.7572 secs
2025-03-12 18:28:48: [retrieval_preprocessing] calculating distances ...
2025-03-12 18:28:48: [retrieval_preprocessing] finished and saved retrieval indices for episode 59 [episode count 13/20]
[retrieval_preprocessing] for episode 60 [episode count 14/20], we have num_retrieval=np.int64(2034) num_query=np.int64(103)
2025-03-12 18:28:49,046 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-12 18:28:49,271 [INFO]: Launching the whole pipeline 03/12/2025, 18:28:49
2025-03-12 18:28:49,271 [INFO]: Reading total number of vectors and dimension 03/12/2025, 18:28:49
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 2018.43it/s]
2025-03-12 18:28:49,300 [INFO]: There are 2034 embeddings of dim 49152
2025-03-12 18:28:49,300 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0293 secs
2025-03-12 18:28:49,300 [INFO]: 	Compute estimated construction time of the index 03/12/2025, 18:28:49
2025-03-12 18:28:49,300 [INFO]: 		-> Train: 16.7 minutes
2025-03-12 18:28:49,301 [INFO]: 		-> Add: 1.1 seconds
2025-03-12 18:28:49,301 [INFO]: 		Total: 16.7 minutes
2025-03-12 18:28:49,301 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0003 secs
2025-03-12 18:28:49,301 [INFO]: 	Checking that your have enough memory available to create the index 03/12/2025, 18:28:49
2025-03-12 18:28:49,301 [INFO]: 419.8MB of memory will be needed to build the index (more might be used if you have more)
2025-03-12 18:28:49,301 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0004 secs
2025-03-12 18:28:49,301 [INFO]: 	Selecting most promising index types given data characteristics 03/12/2025, 18:28:49
2025-03-12 18:28:49,301 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-12 18:28:49,301 [INFO]: 	Creating the index 03/12/2025, 18:28:49
2025-03-12 18:28:49,302 [INFO]: 		-> Instanciate the index HNSW15 03/12/2025, 18:28:49
2025-03-12 18:28:49,304 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0025 secs
2025-03-12 18:28:49,304 [INFO]: 		-> Adding the vectors to the index 03/12/2025, 18:28:49
2025-03-12 18:28:49,305 [INFO]: The memory available for adding the vectors is 49.6GB(total available - used by the index)
2025-03-12 18:28:49,305 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/9 [00:00<?, ?it/s] 44%|████▍     | 4/9 [00:00<00:00, 35.62it/s]100%|██████████| 9/9 [00:01<00:00,  6.41it/s]100%|██████████| 9/9 [00:01<00:00,  7.19it/s]
2025-03-12 18:28:50,561 [INFO]: 	Computing best hyperparameters for index knn.index 03/12/2025, 18:28:50
2025-03-12 18:29:10,441 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 19.8805 secs
2025-03-12 18:29:10,442 [INFO]: The best hyperparameters are: efSearch=364
2025-03-12 18:29:10,442 [INFO]: 	Compute fast metrics 03/12/2025, 18:29:10
  0%|          | 0/4 [00:00<?, ?it/s] 75%|███████▌  | 3/4 [00:00<00:00, 27.48it/s] 75%|███████▌  | 3/4 [00:00<00:00, 24.21it/s]
2025-03-12 18:29:21,576 [INFO]: 	>>> Finished "Compute fast metrics" in 11.1341 secs
2025-03-12 18:29:21,577 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 32.2724 secs
2025-03-12 18:29:21,577 [INFO]: {
2025-03-12 18:29:21,577 [INFO]: 	index_key: HNSW15
2025-03-12 18:29:21,577 [INFO]: 	index_param: efSearch=364
2025-03-12 18:29:21,577 [INFO]: 	index_path: knn.index
2025-03-12 18:29:21,577 [INFO]: 	size in bytes: 400177270
2025-03-12 18:29:21,577 [INFO]: 	avg_search_speed_ms: 9.518662897815004
2025-03-12 18:29:21,577 [INFO]: 	99p_search_speed_ms: 12.004580581560731
2025-03-12 18:29:21,577 [INFO]: 	reconstruction error %: 0.0
2025-03-12 18:29:21,577 [INFO]: 	nb vectors: 2034
2025-03-12 18:29:21,577 [INFO]: 	vectors dimension: 49152
2025-03-12 18:29:21,577 [INFO]: 	compression ratio: 0.9993088113175443
2025-03-12 18:29:21,577 [INFO]: }
2025-03-12 18:29:21,577 [INFO]: 	>>> Finished "Creating the index" in 32.2757 secs
2025-03-12 18:29:21,577 [INFO]: >>> Finished "Launching the whole pipeline" in 32.3064 secs
2025-03-12 18:29:22: [retrieval_preprocessing] calculating distances ...
2025-03-12 18:29:22: [retrieval_preprocessing] finished and saved retrieval indices for episode 60 [episode count 14/20]
[retrieval_preprocessing] for episode 61 [episode count 15/20], we have num_retrieval=np.int64(2028) num_query=np.int64(109)
2025-03-12 18:29:22,959 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-12 18:29:23,193 [INFO]: Launching the whole pipeline 03/12/2025, 18:29:23
2025-03-12 18:29:23,193 [INFO]: Reading total number of vectors and dimension 03/12/2025, 18:29:23
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 2404.99it/s]
2025-03-12 18:29:23,218 [INFO]: There are 2028 embeddings of dim 49152
2025-03-12 18:29:23,218 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0251 secs
2025-03-12 18:29:23,218 [INFO]: 	Compute estimated construction time of the index 03/12/2025, 18:29:23
2025-03-12 18:29:23,218 [INFO]: 		-> Train: 16.7 minutes
2025-03-12 18:29:23,218 [INFO]: 		-> Add: 1.1 seconds
2025-03-12 18:29:23,218 [INFO]: 		Total: 16.7 minutes
2025-03-12 18:29:23,218 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0001 secs
2025-03-12 18:29:23,218 [INFO]: 	Checking that your have enough memory available to create the index 03/12/2025, 18:29:23
2025-03-12 18:29:23,219 [INFO]: 418.5MB of memory will be needed to build the index (more might be used if you have more)
2025-03-12 18:29:23,219 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0001 secs
2025-03-12 18:29:23,219 [INFO]: 	Selecting most promising index types given data characteristics 03/12/2025, 18:29:23
2025-03-12 18:29:23,219 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-12 18:29:23,219 [INFO]: 	Creating the index 03/12/2025, 18:29:23
2025-03-12 18:29:23,219 [INFO]: 		-> Instanciate the index HNSW15 03/12/2025, 18:29:23
2025-03-12 18:29:23,220 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0009 secs
2025-03-12 18:29:23,220 [INFO]: 		-> Adding the vectors to the index 03/12/2025, 18:29:23
2025-03-12 18:29:23,220 [INFO]: The memory available for adding the vectors is 49.6GB(total available - used by the index)
2025-03-12 18:29:23,220 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/8 [00:00<?, ?it/s] 38%|███▊      | 3/8 [00:00<00:00, 26.49it/s]100%|██████████| 8/8 [00:01<00:00,  5.75it/s]100%|██████████| 8/8 [00:01<00:00,  6.30it/s]
2025-03-12 18:29:24,493 [INFO]: 	Computing best hyperparameters for index knn.index 03/12/2025, 18:29:24
2025-03-12 18:29:44,710 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 20.2172 secs
2025-03-12 18:29:44,711 [INFO]: The best hyperparameters are: efSearch=378
2025-03-12 18:29:44,711 [INFO]: 	Compute fast metrics 03/12/2025, 18:29:44
  0%|          | 0/4 [00:00<?, ?it/s] 75%|███████▌  | 3/4 [00:00<00:00, 31.88it/s]
2025-03-12 18:29:55,812 [INFO]: 	>>> Finished "Compute fast metrics" in 11.1016 secs
2025-03-12 18:29:55,813 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 32.5938 secs
2025-03-12 18:29:55,814 [INFO]: {
2025-03-12 18:29:55,814 [INFO]: 	index_key: HNSW15
2025-03-12 18:29:55,814 [INFO]: 	index_param: efSearch=378
2025-03-12 18:29:55,814 [INFO]: 	index_path: knn.index
2025-03-12 18:29:55,814 [INFO]: 	size in bytes: 398996830
2025-03-12 18:29:55,814 [INFO]: 	avg_search_speed_ms: 9.462884285636141
2025-03-12 18:29:55,814 [INFO]: 	99p_search_speed_ms: 12.087321644648911
2025-03-12 18:29:55,814 [INFO]: 	reconstruction error %: 0.0
2025-03-12 18:29:55,814 [INFO]: 	nb vectors: 2028
2025-03-12 18:29:55,814 [INFO]: 	vectors dimension: 49152
2025-03-12 18:29:55,814 [INFO]: 	compression ratio: 0.9993087514003557
2025-03-12 18:29:55,814 [INFO]: }
2025-03-12 18:29:55,814 [INFO]: 	>>> Finished "Creating the index" in 32.5950 secs
2025-03-12 18:29:55,814 [INFO]: >>> Finished "Launching the whole pipeline" in 32.6206 secs
2025-03-12 18:29:56: [retrieval_preprocessing] calculating distances ...
2025-03-12 18:29:57: [retrieval_preprocessing] finished and saved retrieval indices for episode 61 [episode count 15/20]
[retrieval_preprocessing] for episode 62 [episode count 16/20], we have num_retrieval=np.int64(2028) num_query=np.int64(109)
2025-03-12 18:29:57,241 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-12 18:29:57,470 [INFO]: Launching the whole pipeline 03/12/2025, 18:29:57
2025-03-12 18:29:57,470 [INFO]: Reading total number of vectors and dimension 03/12/2025, 18:29:57
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 2331.46it/s]
2025-03-12 18:29:57,499 [INFO]: There are 2028 embeddings of dim 49152
2025-03-12 18:29:57,499 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0290 secs
2025-03-12 18:29:57,499 [INFO]: 	Compute estimated construction time of the index 03/12/2025, 18:29:57
2025-03-12 18:29:57,499 [INFO]: 		-> Train: 16.7 minutes
2025-03-12 18:29:57,499 [INFO]: 		-> Add: 1.1 seconds
2025-03-12 18:29:57,499 [INFO]: 		Total: 16.7 minutes
2025-03-12 18:29:57,500 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0003 secs
2025-03-12 18:29:57,500 [INFO]: 	Checking that your have enough memory available to create the index 03/12/2025, 18:29:57
2025-03-12 18:29:57,500 [INFO]: 418.5MB of memory will be needed to build the index (more might be used if you have more)
2025-03-12 18:29:57,500 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0004 secs
2025-03-12 18:29:57,500 [INFO]: 	Selecting most promising index types given data characteristics 03/12/2025, 18:29:57
2025-03-12 18:29:57,500 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-12 18:29:57,500 [INFO]: 	Creating the index 03/12/2025, 18:29:57
2025-03-12 18:29:57,501 [INFO]: 		-> Instanciate the index HNSW15 03/12/2025, 18:29:57
2025-03-12 18:29:57,503 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0026 secs
2025-03-12 18:29:57,503 [INFO]: 		-> Adding the vectors to the index 03/12/2025, 18:29:57
2025-03-12 18:29:57,504 [INFO]: The memory available for adding the vectors is 49.6GB(total available - used by the index)
2025-03-12 18:29:57,504 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/8 [00:00<?, ?it/s] 38%|███▊      | 3/8 [00:00<00:00, 28.87it/s]100%|██████████| 8/8 [00:01<00:00,  5.85it/s]100%|██████████| 8/8 [00:01<00:00,  6.42it/s]
2025-03-12 18:29:58,755 [INFO]: 	Computing best hyperparameters for index knn.index 03/12/2025, 18:29:58
2025-03-12 18:30:17,909 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 19.1534 secs
2025-03-12 18:30:17,909 [INFO]: The best hyperparameters are: efSearch=386
2025-03-12 18:30:17,909 [INFO]: 	Compute fast metrics 03/12/2025, 18:30:17
  0%|          | 0/4 [00:00<?, ?it/s] 75%|███████▌  | 3/4 [00:00<00:00, 27.90it/s] 75%|███████▌  | 3/4 [00:00<00:00, 24.76it/s]
2025-03-12 18:30:29,071 [INFO]: 	>>> Finished "Compute fast metrics" in 11.1624 secs
2025-03-12 18:30:29,073 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 31.5690 secs
2025-03-12 18:30:29,073 [INFO]: {
2025-03-12 18:30:29,073 [INFO]: 	index_key: HNSW15
2025-03-12 18:30:29,073 [INFO]: 	index_param: efSearch=386
2025-03-12 18:30:29,073 [INFO]: 	index_path: knn.index
2025-03-12 18:30:29,073 [INFO]: 	size in bytes: 398996830
2025-03-12 18:30:29,073 [INFO]: 	avg_search_speed_ms: 9.635104266172975
2025-03-12 18:30:29,073 [INFO]: 	99p_search_speed_ms: 11.97993816109374
2025-03-12 18:30:29,073 [INFO]: 	reconstruction error %: 0.0
2025-03-12 18:30:29,073 [INFO]: 	nb vectors: 2028
2025-03-12 18:30:29,073 [INFO]: 	vectors dimension: 49152
2025-03-12 18:30:29,073 [INFO]: 	compression ratio: 0.9993087514003557
2025-03-12 18:30:29,073 [INFO]: }
2025-03-12 18:30:29,073 [INFO]: 	>>> Finished "Creating the index" in 31.5724 secs
2025-03-12 18:30:29,073 [INFO]: >>> Finished "Launching the whole pipeline" in 31.6028 secs
2025-03-12 18:30:30: [retrieval_preprocessing] calculating distances ...
2025-03-12 18:30:30: [retrieval_preprocessing] finished and saved retrieval indices for episode 62 [episode count 16/20]
[retrieval_preprocessing] for episode 63 [episode count 17/20], we have num_retrieval=np.int64(2037) num_query=np.int64(100)
2025-03-12 18:30:30,559 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-12 18:30:30,809 [INFO]: Launching the whole pipeline 03/12/2025, 18:30:30
2025-03-12 18:30:30,809 [INFO]: Reading total number of vectors and dimension 03/12/2025, 18:30:30
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1860.83it/s]
2025-03-12 18:30:30,835 [INFO]: There are 2037 embeddings of dim 49152
2025-03-12 18:30:30,835 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0263 secs
2025-03-12 18:30:30,835 [INFO]: 	Compute estimated construction time of the index 03/12/2025, 18:30:30
2025-03-12 18:30:30,835 [INFO]: 		-> Train: 16.7 minutes
2025-03-12 18:30:30,835 [INFO]: 		-> Add: 1.1 seconds
2025-03-12 18:30:30,835 [INFO]: 		Total: 16.7 minutes
2025-03-12 18:30:30,835 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0001 secs
2025-03-12 18:30:30,835 [INFO]: 	Checking that your have enough memory available to create the index 03/12/2025, 18:30:30
2025-03-12 18:30:30,835 [INFO]: 420.4MB of memory will be needed to build the index (more might be used if you have more)
2025-03-12 18:30:30,835 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0001 secs
2025-03-12 18:30:30,835 [INFO]: 	Selecting most promising index types given data characteristics 03/12/2025, 18:30:30
2025-03-12 18:30:30,836 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-12 18:30:30,836 [INFO]: 	Creating the index 03/12/2025, 18:30:30
2025-03-12 18:30:30,836 [INFO]: 		-> Instanciate the index HNSW15 03/12/2025, 18:30:30
2025-03-12 18:30:30,837 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0011 secs
2025-03-12 18:30:30,837 [INFO]: 		-> Adding the vectors to the index 03/12/2025, 18:30:30
2025-03-12 18:30:30,837 [INFO]: The memory available for adding the vectors is 49.6GB(total available - used by the index)
2025-03-12 18:30:30,837 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/9 [00:00<?, ?it/s] 33%|███▎      | 3/9 [00:00<00:00, 26.20it/s]100%|██████████| 9/9 [00:01<00:00,  6.52it/s]100%|██████████| 9/9 [00:01<00:00,  7.04it/s]
2025-03-12 18:30:32,119 [INFO]: 	Computing best hyperparameters for index knn.index 03/12/2025, 18:30:32
2025-03-12 18:30:51,623 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 19.5041 secs
2025-03-12 18:30:51,624 [INFO]: The best hyperparameters are: efSearch=384
2025-03-12 18:30:51,624 [INFO]: 	Compute fast metrics 03/12/2025, 18:30:51
  0%|          | 0/4 [00:00<?, ?it/s] 75%|███████▌  | 3/4 [00:00<00:00, 28.75it/s] 75%|███████▌  | 3/4 [00:00<00:00, 25.21it/s]
2025-03-12 18:31:02,734 [INFO]: 	>>> Finished "Compute fast metrics" in 11.1103 secs
2025-03-12 18:31:02,735 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 31.8983 secs
2025-03-12 18:31:02,735 [INFO]: {
2025-03-12 18:31:02,735 [INFO]: 	index_key: HNSW15
2025-03-12 18:31:02,735 [INFO]: 	index_param: efSearch=384
2025-03-12 18:31:02,735 [INFO]: 	index_path: knn.index
2025-03-12 18:31:02,735 [INFO]: 	size in bytes: 400767550
2025-03-12 18:31:02,735 [INFO]: 	avg_search_speed_ms: 9.58216549396886
2025-03-12 18:31:02,735 [INFO]: 	99p_search_speed_ms: 12.016625418327747
2025-03-12 18:31:02,735 [INFO]: 	reconstruction error %: 0.0
2025-03-12 18:31:02,735 [INFO]: 	nb vectors: 2037
2025-03-12 18:31:02,735 [INFO]: 	vectors dimension: 49152
2025-03-12 18:31:02,735 [INFO]: 	compression ratio: 0.9993086915345317
2025-03-12 18:31:02,735 [INFO]: }
2025-03-12 18:31:02,735 [INFO]: 	>>> Finished "Creating the index" in 31.8998 secs
2025-03-12 18:31:02,735 [INFO]: >>> Finished "Launching the whole pipeline" in 31.9266 secs
2025-03-12 18:31:03: [retrieval_preprocessing] calculating distances ...
2025-03-12 18:31:03: [retrieval_preprocessing] finished and saved retrieval indices for episode 63 [episode count 17/20]
[retrieval_preprocessing] for episode 64 [episode count 18/20], we have num_retrieval=np.int64(2031) num_query=np.int64(106)
2025-03-12 18:31:04,066 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-12 18:31:04,297 [INFO]: Launching the whole pipeline 03/12/2025, 18:31:04
2025-03-12 18:31:04,297 [INFO]: Reading total number of vectors and dimension 03/12/2025, 18:31:04
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1871.62it/s]
2025-03-12 18:31:04,324 [INFO]: There are 2031 embeddings of dim 49152
2025-03-12 18:31:04,324 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0269 secs
2025-03-12 18:31:04,324 [INFO]: 	Compute estimated construction time of the index 03/12/2025, 18:31:04
2025-03-12 18:31:04,324 [INFO]: 		-> Train: 16.7 minutes
2025-03-12 18:31:04,324 [INFO]: 		-> Add: 1.1 seconds
2025-03-12 18:31:04,324 [INFO]: 		Total: 16.7 minutes
2025-03-12 18:31:04,324 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0001 secs
2025-03-12 18:31:04,324 [INFO]: 	Checking that your have enough memory available to create the index 03/12/2025, 18:31:04
2025-03-12 18:31:04,324 [INFO]: 419.1MB of memory will be needed to build the index (more might be used if you have more)
2025-03-12 18:31:04,324 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0001 secs
2025-03-12 18:31:04,324 [INFO]: 	Selecting most promising index types given data characteristics 03/12/2025, 18:31:04
2025-03-12 18:31:04,324 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-12 18:31:04,324 [INFO]: 	Creating the index 03/12/2025, 18:31:04
2025-03-12 18:31:04,325 [INFO]: 		-> Instanciate the index HNSW15 03/12/2025, 18:31:04
2025-03-12 18:31:04,326 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0010 secs
2025-03-12 18:31:04,326 [INFO]: 		-> Adding the vectors to the index 03/12/2025, 18:31:04
2025-03-12 18:31:04,326 [INFO]: The memory available for adding the vectors is 49.6GB(total available - used by the index)
2025-03-12 18:31:04,326 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/8 [00:00<?, ?it/s] 25%|██▌       | 2/8 [00:00<00:00, 19.32it/s]100%|██████████| 8/8 [00:01<00:00,  6.12it/s]100%|██████████| 8/8 [00:01<00:00,  6.44it/s]
2025-03-12 18:31:05,571 [INFO]: 	Computing best hyperparameters for index knn.index 03/12/2025, 18:31:05
2025-03-12 18:31:25,669 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 20.0980 secs
2025-03-12 18:31:25,669 [INFO]: The best hyperparameters are: efSearch=372
2025-03-12 18:31:25,669 [INFO]: 	Compute fast metrics 03/12/2025, 18:31:25
  0%|          | 0/4 [00:00<?, ?it/s] 75%|███████▌  | 3/4 [00:00<00:00, 28.15it/s] 75%|███████▌  | 3/4 [00:00<00:00, 24.88it/s]
2025-03-12 18:31:36,778 [INFO]: 	>>> Finished "Compute fast metrics" in 11.1090 secs
2025-03-12 18:31:36,780 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 32.4539 secs
2025-03-12 18:31:36,780 [INFO]: {
2025-03-12 18:31:36,780 [INFO]: 	index_key: HNSW15
2025-03-12 18:31:36,780 [INFO]: 	index_param: efSearch=372
2025-03-12 18:31:36,780 [INFO]: 	index_path: knn.index
2025-03-12 18:31:36,780 [INFO]: 	size in bytes: 399587050
2025-03-12 18:31:36,780 [INFO]: 	avg_search_speed_ms: 9.669801148917433
2025-03-12 18:31:36,780 [INFO]: 	99p_search_speed_ms: 12.414669313002378
2025-03-12 18:31:36,780 [INFO]: 	reconstruction error %: 0.0
2025-03-12 18:31:36,780 [INFO]: 	nb vectors: 2031
2025-03-12 18:31:36,780 [INFO]: 	vectors dimension: 49152
2025-03-12 18:31:36,780 [INFO]: 	compression ratio: 0.9993087814032011
2025-03-12 18:31:36,780 [INFO]: }
2025-03-12 18:31:36,780 [INFO]: 	>>> Finished "Creating the index" in 32.4556 secs
2025-03-12 18:31:36,780 [INFO]: >>> Finished "Launching the whole pipeline" in 32.4830 secs
2025-03-12 18:31:37: [retrieval_preprocessing] calculating distances ...
2025-03-12 18:31:38: [retrieval_preprocessing] finished and saved retrieval indices for episode 64 [episode count 18/20]
[retrieval_preprocessing] for episode 65 [episode count 19/20], we have num_retrieval=np.int64(2033) num_query=np.int64(104)
2025-03-12 18:31:38,271 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-12 18:31:38,498 [INFO]: Launching the whole pipeline 03/12/2025, 18:31:38
2025-03-12 18:31:38,498 [INFO]: Reading total number of vectors and dimension 03/12/2025, 18:31:38
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1318.55it/s]
2025-03-12 18:31:38,525 [INFO]: There are 2033 embeddings of dim 49152
2025-03-12 18:31:38,525 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0270 secs
2025-03-12 18:31:38,525 [INFO]: 	Compute estimated construction time of the index 03/12/2025, 18:31:38
2025-03-12 18:31:38,525 [INFO]: 		-> Train: 16.7 minutes
2025-03-12 18:31:38,525 [INFO]: 		-> Add: 1.1 seconds
2025-03-12 18:31:38,525 [INFO]: 		Total: 16.7 minutes
2025-03-12 18:31:38,525 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0001 secs
2025-03-12 18:31:38,525 [INFO]: 	Checking that your have enough memory available to create the index 03/12/2025, 18:31:38
2025-03-12 18:31:38,525 [INFO]: 419.6MB of memory will be needed to build the index (more might be used if you have more)
2025-03-12 18:31:38,525 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0002 secs
2025-03-12 18:31:38,526 [INFO]: 	Selecting most promising index types given data characteristics 03/12/2025, 18:31:38
2025-03-12 18:31:38,526 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-12 18:31:38,526 [INFO]: 	Creating the index 03/12/2025, 18:31:38
2025-03-12 18:31:38,526 [INFO]: 		-> Instanciate the index HNSW15 03/12/2025, 18:31:38
2025-03-12 18:31:38,527 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0011 secs
2025-03-12 18:31:38,527 [INFO]: 		-> Adding the vectors to the index 03/12/2025, 18:31:38
2025-03-12 18:31:38,527 [INFO]: The memory available for adding the vectors is 49.6GB(total available - used by the index)
2025-03-12 18:31:38,527 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/9 [00:00<?, ?it/s] 33%|███▎      | 3/9 [00:00<00:00, 28.74it/s]100%|██████████| 9/9 [00:01<00:00,  6.62it/s]100%|██████████| 9/9 [00:01<00:00,  7.16it/s]
2025-03-12 18:31:39,787 [INFO]: 	Computing best hyperparameters for index knn.index 03/12/2025, 18:31:39
2025-03-12 18:31:59,484 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 19.6960 secs
2025-03-12 18:31:59,484 [INFO]: The best hyperparameters are: efSearch=385
2025-03-12 18:31:59,484 [INFO]: 	Compute fast metrics 03/12/2025, 18:31:59
  0%|          | 0/4 [00:00<?, ?it/s] 75%|███████▌  | 3/4 [00:00<00:00, 27.23it/s] 75%|███████▌  | 3/4 [00:00<00:00, 23.75it/s]
2025-03-12 18:32:10,629 [INFO]: 	>>> Finished "Compute fast metrics" in 11.1452 secs
2025-03-12 18:32:10,630 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 32.1034 secs
2025-03-12 18:32:10,631 [INFO]: {
2025-03-12 18:32:10,631 [INFO]: 	index_key: HNSW15
2025-03-12 18:32:10,631 [INFO]: 	index_param: efSearch=385
2025-03-12 18:32:10,631 [INFO]: 	index_path: knn.index
2025-03-12 18:32:10,631 [INFO]: 	size in bytes: 399980530
2025-03-12 18:32:10,631 [INFO]: 	avg_search_speed_ms: 10.455566189566174
2025-03-12 18:32:10,631 [INFO]: 	99p_search_speed_ms: 13.578041559085243
2025-03-12 18:32:10,631 [INFO]: 	reconstruction error %: 0.0
2025-03-12 18:32:10,631 [INFO]: 	nb vectors: 2033
2025-03-12 18:32:10,631 [INFO]: 	vectors dimension: 49152
2025-03-12 18:32:10,631 [INFO]: 	compression ratio: 0.999308801355906
2025-03-12 18:32:10,631 [INFO]: }
2025-03-12 18:32:10,631 [INFO]: 	>>> Finished "Creating the index" in 32.1050 secs
2025-03-12 18:32:10,631 [INFO]: >>> Finished "Launching the whole pipeline" in 32.1327 secs
2025-03-12 18:32:11: [retrieval_preprocessing] calculating distances ...
2025-03-12 18:32:12: [retrieval_preprocessing] finished and saved retrieval indices for episode 65 [episode count 19/20]
2025-03-12 18:32:12: [retrieval_preprocessing] finished for collected_demos_training/2023-03-04_pick_up_the_pineapple_and_put_it_in_the_bowl [chosen_id count 3/8]
2025-03-12 18:32:12: [retrieval_preprocessing] concatenated all embeddings and indices for 20 episodes for collected_demos_training/2025-03-10_move_the_jug_to_the_left [chosen_id count 4/8]
2025-03-12 18:32:12: [retrieval_preprocessing] we have num_total=1973 embedding_dim=49152
[retrieval_preprocessing] for episode 66 [episode count 0/20], we have num_retrieval=np.int64(1828) num_query=np.int64(145)
2025-03-12 18:32:12,830 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-12 18:32:13,042 [INFO]: Launching the whole pipeline 03/12/2025, 18:32:13
2025-03-12 18:32:13,042 [INFO]: Reading total number of vectors and dimension 03/12/2025, 18:32:13
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1831.57it/s]
2025-03-12 18:32:13,071 [INFO]: There are 1828 embeddings of dim 49152
2025-03-12 18:32:13,072 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0295 secs
2025-03-12 18:32:13,072 [INFO]: 	Compute estimated construction time of the index 03/12/2025, 18:32:13
2025-03-12 18:32:13,072 [INFO]: 		-> Train: 16.7 minutes
2025-03-12 18:32:13,072 [INFO]: 		-> Add: 1.0 seconds
2025-03-12 18:32:13,072 [INFO]: 		Total: 16.7 minutes
2025-03-12 18:32:13,072 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0001 secs
2025-03-12 18:32:13,072 [INFO]: 	Checking that your have enough memory available to create the index 03/12/2025, 18:32:13
2025-03-12 18:32:13,072 [INFO]: 377.3MB of memory will be needed to build the index (more might be used if you have more)
2025-03-12 18:32:13,072 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0001 secs
2025-03-12 18:32:13,072 [INFO]: 	Selecting most promising index types given data characteristics 03/12/2025, 18:32:13
2025-03-12 18:32:13,072 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-12 18:32:13,072 [INFO]: 	Creating the index 03/12/2025, 18:32:13
2025-03-12 18:32:13,072 [INFO]: 		-> Instanciate the index HNSW15 03/12/2025, 18:32:13
2025-03-12 18:32:13,073 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0011 secs
2025-03-12 18:32:13,073 [INFO]: 		-> Adding the vectors to the index 03/12/2025, 18:32:13
2025-03-12 18:32:13,073 [INFO]: The memory available for adding the vectors is 49.7GB(total available - used by the index)
2025-03-12 18:32:13,073 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/8 [00:00<?, ?it/s] 38%|███▊      | 3/8 [00:00<00:00, 27.77it/s]100%|██████████| 8/8 [00:01<00:00,  5.88it/s]100%|██████████| 8/8 [00:01<00:00,  6.44it/s]
2025-03-12 18:32:14,318 [INFO]: 	Computing best hyperparameters for index knn.index 03/12/2025, 18:32:14
2025-03-12 18:32:33,124 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 18.8063 secs
2025-03-12 18:32:33,124 [INFO]: The best hyperparameters are: efSearch=304
2025-03-12 18:32:33,125 [INFO]: 	Compute fast metrics 03/12/2025, 18:32:33
  0%|          | 0/4 [00:00<?, ?it/s] 75%|███████▌  | 3/4 [00:00<00:00, 29.50it/s] 75%|███████▌  | 3/4 [00:00<00:00, 26.00it/s]
2025-03-12 18:32:44,200 [INFO]: 	>>> Finished "Compute fast metrics" in 11.0755 secs
2025-03-12 18:32:44,201 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 31.1281 secs
2025-03-12 18:32:44,202 [INFO]: {
2025-03-12 18:32:44,202 [INFO]: 	index_key: HNSW15
2025-03-12 18:32:44,202 [INFO]: 	index_param: efSearch=304
2025-03-12 18:32:44,202 [INFO]: 	index_path: knn.index
2025-03-12 18:32:44,202 [INFO]: 	size in bytes: 359647930
2025-03-12 18:32:44,202 [INFO]: 	avg_search_speed_ms: 9.797127396333506
2025-03-12 18:32:44,202 [INFO]: 	99p_search_speed_ms: 12.344906898215406
2025-03-12 18:32:44,202 [INFO]: 	reconstruction error %: 0.0
2025-03-12 18:32:44,202 [INFO]: 	nb vectors: 1828
2025-03-12 18:32:44,202 [INFO]: 	vectors dimension: 49152
2025-03-12 18:32:44,202 [INFO]: 	compression ratio: 0.9993090298058993
2025-03-12 18:32:44,202 [INFO]: }
2025-03-12 18:32:44,202 [INFO]: 	>>> Finished "Creating the index" in 31.1296 secs
2025-03-12 18:32:44,202 [INFO]: >>> Finished "Launching the whole pipeline" in 31.1597 secs
2025-03-12 18:32:45: [retrieval_preprocessing] calculating distances ...
2025-03-12 18:32:45: [retrieval_preprocessing] finished and saved retrieval indices for episode 66 [episode count 0/20]
[retrieval_preprocessing] for episode 67 [episode count 1/20], we have num_retrieval=np.int64(1862) num_query=np.int64(111)
2025-03-12 18:32:45,642 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-12 18:32:45,862 [INFO]: Launching the whole pipeline 03/12/2025, 18:32:45
2025-03-12 18:32:45,862 [INFO]: Reading total number of vectors and dimension 03/12/2025, 18:32:45
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1796.28it/s]
2025-03-12 18:32:45,887 [INFO]: There are 1862 embeddings of dim 49152
2025-03-12 18:32:45,887 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0257 secs
2025-03-12 18:32:45,888 [INFO]: 	Compute estimated construction time of the index 03/12/2025, 18:32:45
2025-03-12 18:32:45,888 [INFO]: 		-> Train: 16.7 minutes
2025-03-12 18:32:45,888 [INFO]: 		-> Add: 1.0 seconds
2025-03-12 18:32:45,888 [INFO]: 		Total: 16.7 minutes
2025-03-12 18:32:45,888 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0005 secs
2025-03-12 18:32:45,888 [INFO]: 	Checking that your have enough memory available to create the index 03/12/2025, 18:32:45
2025-03-12 18:32:45,888 [INFO]: 384.3MB of memory will be needed to build the index (more might be used if you have more)
2025-03-12 18:32:45,888 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0001 secs
2025-03-12 18:32:45,888 [INFO]: 	Selecting most promising index types given data characteristics 03/12/2025, 18:32:45
2025-03-12 18:32:45,888 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-12 18:32:45,888 [INFO]: 	Creating the index 03/12/2025, 18:32:45
2025-03-12 18:32:45,889 [INFO]: 		-> Instanciate the index HNSW15 03/12/2025, 18:32:45
2025-03-12 18:32:45,890 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0010 secs
2025-03-12 18:32:45,890 [INFO]: 		-> Adding the vectors to the index 03/12/2025, 18:32:45
2025-03-12 18:32:45,890 [INFO]: The memory available for adding the vectors is 49.7GB(total available - used by the index)
2025-03-12 18:32:45,890 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/8 [00:00<?, ?it/s] 50%|█████     | 4/8 [00:00<00:00, 35.45it/s]100%|██████████| 8/8 [00:01<00:00,  5.69it/s]100%|██████████| 8/8 [00:01<00:00,  6.50it/s]
2025-03-12 18:32:47,124 [INFO]: 	Computing best hyperparameters for index knn.index 03/12/2025, 18:32:47
2025-03-12 18:33:07,309 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 20.1845 secs
2025-03-12 18:33:07,309 [INFO]: The best hyperparameters are: efSearch=291
2025-03-12 18:33:07,309 [INFO]: 	Compute fast metrics 03/12/2025, 18:33:07
  0%|          | 0/4 [00:00<?, ?it/s] 75%|███████▌  | 3/4 [00:00<00:00, 28.05it/s] 75%|███████▌  | 3/4 [00:00<00:00, 24.28it/s]
2025-03-12 18:33:18,417 [INFO]: 	>>> Finished "Compute fast metrics" in 11.1077 secs
2025-03-12 18:33:18,418 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 32.5280 secs
2025-03-12 18:33:18,418 [INFO]: {
2025-03-12 18:33:18,418 [INFO]: 	index_key: HNSW15
2025-03-12 18:33:18,418 [INFO]: 	index_param: efSearch=291
2025-03-12 18:33:18,418 [INFO]: 	index_path: knn.index
2025-03-12 18:33:18,418 [INFO]: 	size in bytes: 366337270
2025-03-12 18:33:18,418 [INFO]: 	avg_search_speed_ms: 9.848230511296585
2025-03-12 18:33:18,418 [INFO]: 	99p_search_speed_ms: 13.42722907429561
2025-03-12 18:33:18,418 [INFO]: 	reconstruction error %: 0.0
2025-03-12 18:33:18,418 [INFO]: 	nb vectors: 1862
2025-03-12 18:33:18,418 [INFO]: 	vectors dimension: 49152
2025-03-12 18:33:18,418 [INFO]: 	compression ratio: 0.9993089046058568
2025-03-12 18:33:18,418 [INFO]: }
2025-03-12 18:33:18,418 [INFO]: 	>>> Finished "Creating the index" in 32.5294 secs
2025-03-12 18:33:18,418 [INFO]: >>> Finished "Launching the whole pipeline" in 32.5562 secs
2025-03-12 18:33:19: [retrieval_preprocessing] calculating distances ...
2025-03-12 18:33:19: [retrieval_preprocessing] finished and saved retrieval indices for episode 67 [episode count 1/20]
[retrieval_preprocessing] for episode 68 [episode count 2/20], we have num_retrieval=np.int64(1844) num_query=np.int64(129)
2025-03-12 18:33:19,517 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-12 18:33:19,728 [INFO]: Launching the whole pipeline 03/12/2025, 18:33:19
2025-03-12 18:33:19,729 [INFO]: Reading total number of vectors and dimension 03/12/2025, 18:33:19
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 2495.12it/s]
2025-03-12 18:33:19,756 [INFO]: There are 1844 embeddings of dim 49152
2025-03-12 18:33:19,756 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0273 secs
2025-03-12 18:33:19,756 [INFO]: 	Compute estimated construction time of the index 03/12/2025, 18:33:19
2025-03-12 18:33:19,756 [INFO]: 		-> Train: 16.7 minutes
2025-03-12 18:33:19,756 [INFO]: 		-> Add: 1.0 seconds
2025-03-12 18:33:19,756 [INFO]: 		Total: 16.7 minutes
2025-03-12 18:33:19,756 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0001 secs
2025-03-12 18:33:19,756 [INFO]: 	Checking that your have enough memory available to create the index 03/12/2025, 18:33:19
2025-03-12 18:33:19,756 [INFO]: 380.6MB of memory will be needed to build the index (more might be used if you have more)
2025-03-12 18:33:19,756 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0001 secs
2025-03-12 18:33:19,756 [INFO]: 	Selecting most promising index types given data characteristics 03/12/2025, 18:33:19
2025-03-12 18:33:19,756 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-12 18:33:19,756 [INFO]: 	Creating the index 03/12/2025, 18:33:19
2025-03-12 18:33:19,756 [INFO]: 		-> Instanciate the index HNSW15 03/12/2025, 18:33:19
2025-03-12 18:33:19,757 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0008 secs
2025-03-12 18:33:19,757 [INFO]: 		-> Adding the vectors to the index 03/12/2025, 18:33:19
2025-03-12 18:33:19,757 [INFO]: The memory available for adding the vectors is 49.7GB(total available - used by the index)
2025-03-12 18:33:19,757 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/8 [00:00<?, ?it/s] 38%|███▊      | 3/8 [00:00<00:00, 28.58it/s]100%|██████████| 8/8 [00:01<00:00,  5.94it/s]100%|██████████| 8/8 [00:01<00:00,  6.51it/s]
2025-03-12 18:33:20,989 [INFO]: 	Computing best hyperparameters for index knn.index 03/12/2025, 18:33:20
2025-03-12 18:33:41,141 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 20.1517 secs
2025-03-12 18:33:41,141 [INFO]: The best hyperparameters are: efSearch=291
2025-03-12 18:33:41,141 [INFO]: 	Compute fast metrics 03/12/2025, 18:33:41
  0%|          | 0/4 [00:00<?, ?it/s] 75%|███████▌  | 3/4 [00:00<00:00, 26.97it/s] 75%|███████▌  | 3/4 [00:00<00:00, 23.45it/s]
2025-03-12 18:33:52,205 [INFO]: 	>>> Finished "Compute fast metrics" in 11.0637 secs
2025-03-12 18:33:52,206 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 32.4490 secs
2025-03-12 18:33:52,206 [INFO]: {
2025-03-12 18:33:52,206 [INFO]: 	index_key: HNSW15
2025-03-12 18:33:52,206 [INFO]: 	index_param: efSearch=291
2025-03-12 18:33:52,207 [INFO]: 	index_path: knn.index
2025-03-12 18:33:52,207 [INFO]: 	size in bytes: 362795770
2025-03-12 18:33:52,207 [INFO]: 	avg_search_speed_ms: 9.433837310973344
2025-03-12 18:33:52,207 [INFO]: 	99p_search_speed_ms: 12.76862079976127
2025-03-12 18:33:52,207 [INFO]: 	reconstruction error %: 0.0
2025-03-12 18:33:52,207 [INFO]: 	nb vectors: 1844
2025-03-12 18:33:52,207 [INFO]: 	vectors dimension: 49152
2025-03-12 18:33:52,207 [INFO]: 	compression ratio: 0.9993092036326664
2025-03-12 18:33:52,207 [INFO]: }
2025-03-12 18:33:52,207 [INFO]: 	>>> Finished "Creating the index" in 32.4502 secs
2025-03-12 18:33:52,207 [INFO]: >>> Finished "Launching the whole pipeline" in 32.4781 secs
2025-03-12 18:33:53: [retrieval_preprocessing] calculating distances ...
2025-03-12 18:33:53: [retrieval_preprocessing] finished and saved retrieval indices for episode 68 [episode count 2/20]
[retrieval_preprocessing] for episode 69 [episode count 3/20], we have num_retrieval=np.int64(1888) num_query=np.int64(85)
2025-03-12 18:33:53,523 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-12 18:33:53,739 [INFO]: Launching the whole pipeline 03/12/2025, 18:33:53
2025-03-12 18:33:53,739 [INFO]: Reading total number of vectors and dimension 03/12/2025, 18:33:53
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1407.01it/s]
2025-03-12 18:33:53,765 [INFO]: There are 1888 embeddings of dim 49152
2025-03-12 18:33:53,765 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0261 secs
2025-03-12 18:33:53,765 [INFO]: 	Compute estimated construction time of the index 03/12/2025, 18:33:53
2025-03-12 18:33:53,765 [INFO]: 		-> Train: 16.7 minutes
2025-03-12 18:33:53,765 [INFO]: 		-> Add: 1.0 seconds
2025-03-12 18:33:53,765 [INFO]: 		Total: 16.7 minutes
2025-03-12 18:33:53,765 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0001 secs
2025-03-12 18:33:53,765 [INFO]: 	Checking that your have enough memory available to create the index 03/12/2025, 18:33:53
2025-03-12 18:33:53,765 [INFO]: 389.6MB of memory will be needed to build the index (more might be used if you have more)
2025-03-12 18:33:53,765 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0001 secs
2025-03-12 18:33:53,765 [INFO]: 	Selecting most promising index types given data characteristics 03/12/2025, 18:33:53
2025-03-12 18:33:53,765 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-12 18:33:53,766 [INFO]: 	Creating the index 03/12/2025, 18:33:53
2025-03-12 18:33:53,766 [INFO]: 		-> Instanciate the index HNSW15 03/12/2025, 18:33:53
2025-03-12 18:33:53,767 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0010 secs
2025-03-12 18:33:53,767 [INFO]: 		-> Adding the vectors to the index 03/12/2025, 18:33:53
2025-03-12 18:33:53,767 [INFO]: The memory available for adding the vectors is 49.7GB(total available - used by the index)
2025-03-12 18:33:53,767 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/8 [00:00<?, ?it/s] 38%|███▊      | 3/8 [00:00<00:00, 28.50it/s]100%|██████████| 8/8 [00:01<00:00,  5.64it/s]100%|██████████| 8/8 [00:01<00:00,  6.19it/s]
2025-03-12 18:33:55,062 [INFO]: 	Computing best hyperparameters for index knn.index 03/12/2025, 18:33:55
2025-03-12 18:34:15,841 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 20.7788 secs
2025-03-12 18:34:15,841 [INFO]: The best hyperparameters are: efSearch=288
2025-03-12 18:34:15,841 [INFO]: 	Compute fast metrics 03/12/2025, 18:34:15
  0%|          | 0/4 [00:00<?, ?it/s] 75%|███████▌  | 3/4 [00:00<00:00, 28.23it/s] 75%|███████▌  | 3/4 [00:00<00:00, 23.58it/s]
2025-03-12 18:34:26,916 [INFO]: 	>>> Finished "Compute fast metrics" in 11.0743 secs
2025-03-12 18:34:26,917 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 33.1500 secs
2025-03-12 18:34:26,917 [INFO]: {
2025-03-12 18:34:26,917 [INFO]: 	index_key: HNSW15
2025-03-12 18:34:26,917 [INFO]: 	index_param: efSearch=288
2025-03-12 18:34:26,917 [INFO]: 	index_path: knn.index
2025-03-12 18:34:26,917 [INFO]: 	size in bytes: 371452750
2025-03-12 18:34:26,917 [INFO]: 	avg_search_speed_ms: 9.775932606961486
2025-03-12 18:34:26,917 [INFO]: 	99p_search_speed_ms: 12.49142362270504
2025-03-12 18:34:26,917 [INFO]: 	reconstruction error %: 0.0
2025-03-12 18:34:26,917 [INFO]: 	nb vectors: 1888
2025-03-12 18:34:26,917 [INFO]: 	vectors dimension: 49152
2025-03-12 18:34:26,917 [INFO]: 	compression ratio: 0.9993085365500727
2025-03-12 18:34:26,917 [INFO]: }
2025-03-12 18:34:26,917 [INFO]: 	>>> Finished "Creating the index" in 33.1515 secs
2025-03-12 18:34:26,917 [INFO]: >>> Finished "Launching the whole pipeline" in 33.1781 secs
2025-03-12 18:34:27: [retrieval_preprocessing] calculating distances ...
2025-03-12 18:34:27: [retrieval_preprocessing] finished and saved retrieval indices for episode 69 [episode count 3/20]
[retrieval_preprocessing] for episode 70 [episode count 4/20], we have num_retrieval=np.int64(1872) num_query=np.int64(101)
2025-03-12 18:34:27,758 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-12 18:34:27,970 [INFO]: Launching the whole pipeline 03/12/2025, 18:34:27
2025-03-12 18:34:27,970 [INFO]: Reading total number of vectors and dimension 03/12/2025, 18:34:27
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 2332.76it/s]
2025-03-12 18:34:27,998 [INFO]: There are 1872 embeddings of dim 49152
2025-03-12 18:34:27,998 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0285 secs
2025-03-12 18:34:27,999 [INFO]: 	Compute estimated construction time of the index 03/12/2025, 18:34:27
2025-03-12 18:34:27,999 [INFO]: 		-> Train: 16.7 minutes
2025-03-12 18:34:27,999 [INFO]: 		-> Add: 1.0 seconds
2025-03-12 18:34:27,999 [INFO]: 		Total: 16.7 minutes
2025-03-12 18:34:27,999 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0001 secs
2025-03-12 18:34:27,999 [INFO]: 	Checking that your have enough memory available to create the index 03/12/2025, 18:34:27
2025-03-12 18:34:27,999 [INFO]: 386.3MB of memory will be needed to build the index (more might be used if you have more)
2025-03-12 18:34:27,999 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0002 secs
2025-03-12 18:34:27,999 [INFO]: 	Selecting most promising index types given data characteristics 03/12/2025, 18:34:27
2025-03-12 18:34:27,999 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-12 18:34:27,999 [INFO]: 	Creating the index 03/12/2025, 18:34:27
2025-03-12 18:34:27,999 [INFO]: 		-> Instanciate the index HNSW15 03/12/2025, 18:34:27
2025-03-12 18:34:28,000 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0008 secs
2025-03-12 18:34:28,000 [INFO]: 		-> Adding the vectors to the index 03/12/2025, 18:34:28
2025-03-12 18:34:28,000 [INFO]: The memory available for adding the vectors is 49.7GB(total available - used by the index)
2025-03-12 18:34:28,000 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/8 [00:00<?, ?it/s] 50%|█████     | 4/8 [00:00<00:00, 36.52it/s]100%|██████████| 8/8 [00:01<00:00,  5.64it/s]100%|██████████| 8/8 [00:01<00:00,  6.45it/s]
2025-03-12 18:34:29,242 [INFO]: 	Computing best hyperparameters for index knn.index 03/12/2025, 18:34:29
2025-03-12 18:34:49,339 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 20.0967 secs
2025-03-12 18:34:49,339 [INFO]: The best hyperparameters are: efSearch=306
2025-03-12 18:34:49,339 [INFO]: 	Compute fast metrics 03/12/2025, 18:34:49
  0%|          | 0/4 [00:00<?, ?it/s] 75%|███████▌  | 3/4 [00:00<00:00, 25.81it/s]
2025-03-12 18:35:00,443 [INFO]: 	>>> Finished "Compute fast metrics" in 11.1036 secs
2025-03-12 18:35:00,444 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 32.4442 secs
2025-03-12 18:35:00,444 [INFO]: {
2025-03-12 18:35:00,444 [INFO]: 	index_key: HNSW15
2025-03-12 18:35:00,444 [INFO]: 	index_param: efSearch=306
2025-03-12 18:35:00,444 [INFO]: 	index_path: knn.index
2025-03-12 18:35:00,444 [INFO]: 	size in bytes: 368304730
2025-03-12 18:35:00,444 [INFO]: 	avg_search_speed_ms: 9.831548773755951
2025-03-12 18:35:00,444 [INFO]: 	99p_search_speed_ms: 13.49290791898966
2025-03-12 18:35:00,444 [INFO]: 	reconstruction error %: 0.0
2025-03-12 18:35:00,444 [INFO]: 	nb vectors: 1872
2025-03-12 18:35:00,444 [INFO]: 	vectors dimension: 49152
2025-03-12 18:35:00,444 [INFO]: 	compression ratio: 0.9993088494953621
2025-03-12 18:35:00,444 [INFO]: }
2025-03-12 18:35:00,444 [INFO]: 	>>> Finished "Creating the index" in 32.4453 secs
2025-03-12 18:35:00,444 [INFO]: >>> Finished "Launching the whole pipeline" in 32.4745 secs
2025-03-12 18:35:01: [retrieval_preprocessing] calculating distances ...
2025-03-12 18:35:01: [retrieval_preprocessing] finished and saved retrieval indices for episode 70 [episode count 4/20]
[retrieval_preprocessing] for episode 71 [episode count 5/20], we have num_retrieval=np.int64(1873) num_query=np.int64(100)
2025-03-12 18:35:01,522 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-12 18:35:01,732 [INFO]: Launching the whole pipeline 03/12/2025, 18:35:01
2025-03-12 18:35:01,732 [INFO]: Reading total number of vectors and dimension 03/12/2025, 18:35:01
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1343.47it/s]
2025-03-12 18:35:01,760 [INFO]: There are 1873 embeddings of dim 49152
2025-03-12 18:35:01,761 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0284 secs
2025-03-12 18:35:01,761 [INFO]: 	Compute estimated construction time of the index 03/12/2025, 18:35:01
2025-03-12 18:35:01,761 [INFO]: 		-> Train: 16.7 minutes
2025-03-12 18:35:01,761 [INFO]: 		-> Add: 1.0 seconds
2025-03-12 18:35:01,761 [INFO]: 		Total: 16.7 minutes
2025-03-12 18:35:01,761 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0001 secs
2025-03-12 18:35:01,761 [INFO]: 	Checking that your have enough memory available to create the index 03/12/2025, 18:35:01
2025-03-12 18:35:01,761 [INFO]: 386.5MB of memory will be needed to build the index (more might be used if you have more)
2025-03-12 18:35:01,761 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0001 secs
2025-03-12 18:35:01,761 [INFO]: 	Selecting most promising index types given data characteristics 03/12/2025, 18:35:01
2025-03-12 18:35:01,761 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-12 18:35:01,761 [INFO]: 	Creating the index 03/12/2025, 18:35:01
2025-03-12 18:35:01,761 [INFO]: 		-> Instanciate the index HNSW15 03/12/2025, 18:35:01
2025-03-12 18:35:01,762 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0008 secs
2025-03-12 18:35:01,762 [INFO]: 		-> Adding the vectors to the index 03/12/2025, 18:35:01
2025-03-12 18:35:01,762 [INFO]: The memory available for adding the vectors is 49.7GB(total available - used by the index)
2025-03-12 18:35:01,762 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/8 [00:00<?, ?it/s] 38%|███▊      | 3/8 [00:00<00:00, 27.18it/s]100%|██████████| 8/8 [00:01<00:00,  5.91it/s]100%|██████████| 8/8 [00:01<00:00,  6.47it/s]
2025-03-12 18:35:03,001 [INFO]: 	Computing best hyperparameters for index knn.index 03/12/2025, 18:35:03
2025-03-12 18:35:22,687 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 19.6861 secs
2025-03-12 18:35:22,687 [INFO]: The best hyperparameters are: efSearch=301
2025-03-12 18:35:22,687 [INFO]: 	Compute fast metrics 03/12/2025, 18:35:22
  0%|          | 0/4 [00:00<?, ?it/s] 75%|███████▌  | 3/4 [00:00<00:00, 28.94it/s] 75%|███████▌  | 3/4 [00:00<00:00, 25.54it/s]
2025-03-12 18:35:33,824 [INFO]: 	>>> Finished "Compute fast metrics" in 11.1369 secs
2025-03-12 18:35:33,825 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 32.0633 secs
2025-03-12 18:35:33,825 [INFO]: {
2025-03-12 18:35:33,825 [INFO]: 	index_key: HNSW15
2025-03-12 18:35:33,825 [INFO]: 	index_param: efSearch=301
2025-03-12 18:35:33,825 [INFO]: 	index_path: knn.index
2025-03-12 18:35:33,825 [INFO]: 	size in bytes: 368501470
2025-03-12 18:35:33,825 [INFO]: 	avg_search_speed_ms: 9.532582235866155
2025-03-12 18:35:33,825 [INFO]: 	99p_search_speed_ms: 12.037881799042223
2025-03-12 18:35:33,825 [INFO]: 	reconstruction error %: 0.0
2025-03-12 18:35:33,825 [INFO]: 	nb vectors: 1873
2025-03-12 18:35:33,825 [INFO]: 	vectors dimension: 49152
2025-03-12 18:35:33,825 [INFO]: 	compression ratio: 0.9993088602875858
2025-03-12 18:35:33,825 [INFO]: }
2025-03-12 18:35:33,825 [INFO]: 	>>> Finished "Creating the index" in 32.0645 secs
2025-03-12 18:35:33,825 [INFO]: >>> Finished "Launching the whole pipeline" in 32.0934 secs
2025-03-12 18:35:34: [retrieval_preprocessing] calculating distances ...
2025-03-12 18:35:34: [retrieval_preprocessing] finished and saved retrieval indices for episode 71 [episode count 5/20]
[retrieval_preprocessing] for episode 72 [episode count 6/20], we have num_retrieval=np.int64(1876) num_query=np.int64(97)
2025-03-12 18:35:34,862 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-12 18:35:35,076 [INFO]: Launching the whole pipeline 03/12/2025, 18:35:35
2025-03-12 18:35:35,076 [INFO]: Reading total number of vectors and dimension 03/12/2025, 18:35:35
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1916.08it/s]
2025-03-12 18:35:35,104 [INFO]: There are 1876 embeddings of dim 49152
2025-03-12 18:35:35,105 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0282 secs
2025-03-12 18:35:35,105 [INFO]: 	Compute estimated construction time of the index 03/12/2025, 18:35:35
2025-03-12 18:35:35,105 [INFO]: 		-> Train: 16.7 minutes
2025-03-12 18:35:35,105 [INFO]: 		-> Add: 1.0 seconds
2025-03-12 18:35:35,105 [INFO]: 		Total: 16.7 minutes
2025-03-12 18:35:35,105 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0001 secs
2025-03-12 18:35:35,105 [INFO]: 	Checking that your have enough memory available to create the index 03/12/2025, 18:35:35
2025-03-12 18:35:35,105 [INFO]: 387.2MB of memory will be needed to build the index (more might be used if you have more)
2025-03-12 18:35:35,105 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0001 secs
2025-03-12 18:35:35,105 [INFO]: 	Selecting most promising index types given data characteristics 03/12/2025, 18:35:35
2025-03-12 18:35:35,105 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-12 18:35:35,105 [INFO]: 	Creating the index 03/12/2025, 18:35:35
2025-03-12 18:35:35,105 [INFO]: 		-> Instanciate the index HNSW15 03/12/2025, 18:35:35
2025-03-12 18:35:35,106 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0009 secs
2025-03-12 18:35:35,106 [INFO]: 		-> Adding the vectors to the index 03/12/2025, 18:35:35
2025-03-12 18:35:35,106 [INFO]: The memory available for adding the vectors is 49.7GB(total available - used by the index)
2025-03-12 18:35:35,106 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/8 [00:00<?, ?it/s] 50%|█████     | 4/8 [00:00<00:00, 34.93it/s]100%|██████████| 8/8 [00:01<00:00,  5.59it/s]100%|██████████| 8/8 [00:01<00:00,  6.39it/s]
2025-03-12 18:35:36,361 [INFO]: 	Computing best hyperparameters for index knn.index 03/12/2025, 18:35:36
2025-03-12 18:35:56,613 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 20.2511 secs
2025-03-12 18:35:56,613 [INFO]: The best hyperparameters are: efSearch=292
2025-03-12 18:35:56,613 [INFO]: 	Compute fast metrics 03/12/2025, 18:35:56
  0%|          | 0/4 [00:00<?, ?it/s] 75%|███████▌  | 3/4 [00:00<00:00, 28.45it/s] 75%|███████▌  | 3/4 [00:00<00:00, 24.81it/s]
2025-03-12 18:36:07,703 [INFO]: 	>>> Finished "Compute fast metrics" in 11.0898 secs
2025-03-12 18:36:07,704 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 32.5981 secs
2025-03-12 18:36:07,704 [INFO]: {
2025-03-12 18:36:07,704 [INFO]: 	index_key: HNSW15
2025-03-12 18:36:07,704 [INFO]: 	index_param: efSearch=292
2025-03-12 18:36:07,704 [INFO]: 	index_path: knn.index
2025-03-12 18:36:07,704 [INFO]: 	size in bytes: 369091750
2025-03-12 18:36:07,704 [INFO]: 	avg_search_speed_ms: 9.9183724781478
2025-03-12 18:36:07,704 [INFO]: 	99p_search_speed_ms: 13.379154382273553
2025-03-12 18:36:07,704 [INFO]: 	reconstruction error %: 0.0
2025-03-12 18:36:07,704 [INFO]: 	nb vectors: 1876
2025-03-12 18:36:07,704 [INFO]: 	vectors dimension: 49152
2025-03-12 18:36:07,704 [INFO]: 	compression ratio: 0.999308730146366
2025-03-12 18:36:07,704 [INFO]: }
2025-03-12 18:36:07,704 [INFO]: 	>>> Finished "Creating the index" in 32.5993 secs
2025-03-12 18:36:07,704 [INFO]: >>> Finished "Launching the whole pipeline" in 32.6280 secs
2025-03-12 18:36:08: [retrieval_preprocessing] calculating distances ...
2025-03-12 18:36:08: [retrieval_preprocessing] finished and saved retrieval indices for episode 72 [episode count 6/20]
[retrieval_preprocessing] for episode 73 [episode count 7/20], we have num_retrieval=np.int64(1839) num_query=np.int64(134)
2025-03-12 18:36:08,666 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-12 18:36:08,880 [INFO]: Launching the whole pipeline 03/12/2025, 18:36:08
2025-03-12 18:36:08,880 [INFO]: Reading total number of vectors and dimension 03/12/2025, 18:36:08
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 2030.16it/s]
2025-03-12 18:36:08,907 [INFO]: There are 1839 embeddings of dim 49152
2025-03-12 18:36:08,908 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0278 secs
2025-03-12 18:36:08,908 [INFO]: 	Compute estimated construction time of the index 03/12/2025, 18:36:08
2025-03-12 18:36:08,908 [INFO]: 		-> Train: 16.7 minutes
2025-03-12 18:36:08,908 [INFO]: 		-> Add: 1.0 seconds
2025-03-12 18:36:08,908 [INFO]: 		Total: 16.7 minutes
2025-03-12 18:36:08,908 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0001 secs
2025-03-12 18:36:08,908 [INFO]: 	Checking that your have enough memory available to create the index 03/12/2025, 18:36:08
2025-03-12 18:36:08,908 [INFO]: 379.5MB of memory will be needed to build the index (more might be used if you have more)
2025-03-12 18:36:08,908 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0001 secs
2025-03-12 18:36:08,908 [INFO]: 	Selecting most promising index types given data characteristics 03/12/2025, 18:36:08
2025-03-12 18:36:08,908 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-12 18:36:08,908 [INFO]: 	Creating the index 03/12/2025, 18:36:08
2025-03-12 18:36:08,908 [INFO]: 		-> Instanciate the index HNSW15 03/12/2025, 18:36:08
2025-03-12 18:36:08,909 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0009 secs
2025-03-12 18:36:08,909 [INFO]: 		-> Adding the vectors to the index 03/12/2025, 18:36:08
2025-03-12 18:36:08,909 [INFO]: The memory available for adding the vectors is 49.7GB(total available - used by the index)
2025-03-12 18:36:08,909 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/8 [00:00<?, ?it/s] 50%|█████     | 4/8 [00:00<00:00, 36.50it/s]100%|██████████| 8/8 [00:01<00:00,  5.97it/s]100%|██████████| 8/8 [00:01<00:00,  6.81it/s]
2025-03-12 18:36:10,086 [INFO]: 	Computing best hyperparameters for index knn.index 03/12/2025, 18:36:10
2025-03-12 18:36:29,903 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 19.8164 secs
2025-03-12 18:36:29,903 [INFO]: The best hyperparameters are: efSearch=312
2025-03-12 18:36:29,903 [INFO]: 	Compute fast metrics 03/12/2025, 18:36:29
  0%|          | 0/4 [00:00<?, ?it/s] 75%|███████▌  | 3/4 [00:00<00:00, 28.75it/s] 75%|███████▌  | 3/4 [00:00<00:00, 25.14it/s]
2025-03-12 18:36:40,973 [INFO]: 	>>> Finished "Compute fast metrics" in 11.0701 secs
2025-03-12 18:36:40,975 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 32.0657 secs
2025-03-12 18:36:40,975 [INFO]: {
2025-03-12 18:36:40,975 [INFO]: 	index_key: HNSW15
2025-03-12 18:36:40,975 [INFO]: 	index_param: efSearch=312
2025-03-12 18:36:40,975 [INFO]: 	index_path: knn.index
2025-03-12 18:36:40,975 [INFO]: 	size in bytes: 361812070
2025-03-12 18:36:40,975 [INFO]: 	avg_search_speed_ms: 9.797409611018
2025-03-12 18:36:40,975 [INFO]: 	99p_search_speed_ms: 12.21776232123375
2025-03-12 18:36:40,975 [INFO]: 	reconstruction error %: 0.0
2025-03-12 18:36:40,975 [INFO]: 	nb vectors: 1839
2025-03-12 18:36:40,975 [INFO]: 	vectors dimension: 49152
2025-03-12 18:36:40,975 [INFO]: 	compression ratio: 0.9993091496367161
2025-03-12 18:36:40,975 [INFO]: }
2025-03-12 18:36:40,975 [INFO]: 	>>> Finished "Creating the index" in 32.0669 secs
2025-03-12 18:36:40,975 [INFO]: >>> Finished "Launching the whole pipeline" in 32.0952 secs
2025-03-12 18:36:41: [retrieval_preprocessing] calculating distances ...
2025-03-12 18:36:42: [retrieval_preprocessing] finished and saved retrieval indices for episode 73 [episode count 7/20]
[retrieval_preprocessing] for episode 74 [episode count 8/20], we have num_retrieval=np.int64(1879) num_query=np.int64(94)
2025-03-12 18:36:42,322 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-12 18:36:42,535 [INFO]: Launching the whole pipeline 03/12/2025, 18:36:42
2025-03-12 18:36:42,535 [INFO]: Reading total number of vectors and dimension 03/12/2025, 18:36:42
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1774.99it/s]
2025-03-12 18:36:42,568 [INFO]: There are 1879 embeddings of dim 49152
2025-03-12 18:36:42,569 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0335 secs
2025-03-12 18:36:42,569 [INFO]: 	Compute estimated construction time of the index 03/12/2025, 18:36:42
2025-03-12 18:36:42,569 [INFO]: 		-> Train: 16.7 minutes
2025-03-12 18:36:42,569 [INFO]: 		-> Add: 1.0 seconds
2025-03-12 18:36:42,569 [INFO]: 		Total: 16.7 minutes
2025-03-12 18:36:42,569 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0003 secs
2025-03-12 18:36:42,569 [INFO]: 	Checking that your have enough memory available to create the index 03/12/2025, 18:36:42
2025-03-12 18:36:42,570 [INFO]: 387.8MB of memory will be needed to build the index (more might be used if you have more)
2025-03-12 18:36:42,570 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0004 secs
2025-03-12 18:36:42,570 [INFO]: 	Selecting most promising index types given data characteristics 03/12/2025, 18:36:42
2025-03-12 18:36:42,570 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-12 18:36:42,570 [INFO]: 	Creating the index 03/12/2025, 18:36:42
2025-03-12 18:36:42,570 [INFO]: 		-> Instanciate the index HNSW15 03/12/2025, 18:36:42
2025-03-12 18:36:42,573 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0027 secs
2025-03-12 18:36:42,573 [INFO]: 		-> Adding the vectors to the index 03/12/2025, 18:36:42
2025-03-12 18:36:42,573 [INFO]: The memory available for adding the vectors is 49.7GB(total available - used by the index)
2025-03-12 18:36:42,574 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/8 [00:00<?, ?it/s] 50%|█████     | 4/8 [00:00<00:00, 36.28it/s]100%|██████████| 8/8 [00:01<00:00,  5.65it/s]100%|██████████| 8/8 [00:01<00:00,  6.46it/s]
2025-03-12 18:36:43,816 [INFO]: 	Computing best hyperparameters for index knn.index 03/12/2025, 18:36:43
2025-03-12 18:37:03,659 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 19.8430 secs
2025-03-12 18:37:03,660 [INFO]: The best hyperparameters are: efSearch=306
2025-03-12 18:37:03,660 [INFO]: 	Compute fast metrics 03/12/2025, 18:37:03
  0%|          | 0/4 [00:00<?, ?it/s] 75%|███████▌  | 3/4 [00:00<00:00, 29.53it/s] 75%|███████▌  | 3/4 [00:00<00:00, 25.79it/s]
2025-03-12 18:37:14,759 [INFO]: 	>>> Finished "Compute fast metrics" in 11.0990 secs
2025-03-12 18:37:14,760 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 32.1865 secs
2025-03-12 18:37:14,760 [INFO]: {
2025-03-12 18:37:14,760 [INFO]: 	index_key: HNSW15
2025-03-12 18:37:14,760 [INFO]: 	index_param: efSearch=306
2025-03-12 18:37:14,760 [INFO]: 	index_path: knn.index
2025-03-12 18:37:14,760 [INFO]: 	size in bytes: 369682030
2025-03-12 18:37:14,760 [INFO]: 	avg_search_speed_ms: 9.643982516165208
2025-03-12 18:37:14,760 [INFO]: 	99p_search_speed_ms: 12.043233932927253
2025-03-12 18:37:14,760 [INFO]: 	reconstruction error %: 0.0
2025-03-12 18:37:14,760 [INFO]: 	nb vectors: 1879
2025-03-12 18:37:14,760 [INFO]: 	vectors dimension: 49152
2025-03-12 18:37:14,760 [INFO]: 	compression ratio: 0.9993086004207453
2025-03-12 18:37:14,760 [INFO]: }
2025-03-12 18:37:14,760 [INFO]: 	>>> Finished "Creating the index" in 32.1902 secs
2025-03-12 18:37:14,760 [INFO]: >>> Finished "Launching the whole pipeline" in 32.2252 secs
2025-03-12 18:37:15: [retrieval_preprocessing] calculating distances ...
2025-03-12 18:37:15: [retrieval_preprocessing] finished and saved retrieval indices for episode 74 [episode count 8/20]
[retrieval_preprocessing] for episode 75 [episode count 9/20], we have num_retrieval=np.int64(1898) num_query=np.int64(75)
2025-03-12 18:37:15,684 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-12 18:37:15,901 [INFO]: Launching the whole pipeline 03/12/2025, 18:37:15
2025-03-12 18:37:15,901 [INFO]: Reading total number of vectors and dimension 03/12/2025, 18:37:15
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 2380.42it/s]
2025-03-12 18:37:15,926 [INFO]: There are 1898 embeddings of dim 49152
2025-03-12 18:37:15,926 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0255 secs
2025-03-12 18:37:15,927 [INFO]: 	Compute estimated construction time of the index 03/12/2025, 18:37:15
2025-03-12 18:37:15,927 [INFO]: 		-> Train: 16.7 minutes
2025-03-12 18:37:15,927 [INFO]: 		-> Add: 1.0 seconds
2025-03-12 18:37:15,927 [INFO]: 		Total: 16.7 minutes
2025-03-12 18:37:15,927 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0001 secs
2025-03-12 18:37:15,927 [INFO]: 	Checking that your have enough memory available to create the index 03/12/2025, 18:37:15
2025-03-12 18:37:15,927 [INFO]: 391.7MB of memory will be needed to build the index (more might be used if you have more)
2025-03-12 18:37:15,927 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0002 secs
2025-03-12 18:37:15,927 [INFO]: 	Selecting most promising index types given data characteristics 03/12/2025, 18:37:15
2025-03-12 18:37:15,927 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-12 18:37:15,927 [INFO]: 	Creating the index 03/12/2025, 18:37:15
2025-03-12 18:37:15,927 [INFO]: 		-> Instanciate the index HNSW15 03/12/2025, 18:37:15
2025-03-12 18:37:15,928 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0010 secs
2025-03-12 18:37:15,928 [INFO]: 		-> Adding the vectors to the index 03/12/2025, 18:37:15
2025-03-12 18:37:15,928 [INFO]: The memory available for adding the vectors is 49.7GB(total available - used by the index)
2025-03-12 18:37:15,928 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/8 [00:00<?, ?it/s] 25%|██▌       | 2/8 [00:00<00:00, 18.86it/s]100%|██████████| 8/8 [00:01<00:00,  5.90it/s]100%|██████████| 8/8 [00:01<00:00,  6.21it/s]
2025-03-12 18:37:17,218 [INFO]: 	Computing best hyperparameters for index knn.index 03/12/2025, 18:37:17
2025-03-12 18:37:37,580 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 20.3614 secs
2025-03-12 18:37:37,580 [INFO]: The best hyperparameters are: efSearch=305
2025-03-12 18:37:37,580 [INFO]: 	Compute fast metrics 03/12/2025, 18:37:37
  0%|          | 0/4 [00:00<?, ?it/s] 75%|███████▌  | 3/4 [00:00<00:00, 27.92it/s] 75%|███████▌  | 3/4 [00:00<00:00, 24.40it/s]
2025-03-12 18:37:48,643 [INFO]: 	>>> Finished "Compute fast metrics" in 11.0621 secs
2025-03-12 18:37:48,644 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 32.7156 secs
2025-03-12 18:37:48,644 [INFO]: {
2025-03-12 18:37:48,644 [INFO]: 	index_key: HNSW15
2025-03-12 18:37:48,644 [INFO]: 	index_param: efSearch=305
2025-03-12 18:37:48,644 [INFO]: 	index_path: knn.index
2025-03-12 18:37:48,644 [INFO]: 	size in bytes: 373420150
2025-03-12 18:37:48,644 [INFO]: 	avg_search_speed_ms: 9.65083233785589
2025-03-12 18:37:48,644 [INFO]: 	99p_search_speed_ms: 13.210461218841381
2025-03-12 18:37:48,644 [INFO]: 	reconstruction error %: 0.0
2025-03-12 18:37:48,644 [INFO]: 	nb vectors: 1898
2025-03-12 18:37:48,644 [INFO]: 	vectors dimension: 49152
2025-03-12 18:37:48,644 [INFO]: 	compression ratio: 0.9993086446995428
2025-03-12 18:37:48,644 [INFO]: }
2025-03-12 18:37:48,644 [INFO]: 	>>> Finished "Creating the index" in 32.7170 secs
2025-03-12 18:37:48,644 [INFO]: >>> Finished "Launching the whole pipeline" in 32.7431 secs
2025-03-12 18:37:49: [retrieval_preprocessing] calculating distances ...
2025-03-12 18:37:49: [retrieval_preprocessing] finished and saved retrieval indices for episode 75 [episode count 9/20]
[retrieval_preprocessing] for episode 76 [episode count 10/20], we have num_retrieval=np.int64(1841) num_query=np.int64(132)
2025-03-12 18:37:49,483 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-12 18:37:49,712 [INFO]: Launching the whole pipeline 03/12/2025, 18:37:49
2025-03-12 18:37:49,712 [INFO]: Reading total number of vectors and dimension 03/12/2025, 18:37:49
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1723.21it/s]
2025-03-12 18:37:49,739 [INFO]: There are 1841 embeddings of dim 49152
2025-03-12 18:37:49,739 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0273 secs
2025-03-12 18:37:49,739 [INFO]: 	Compute estimated construction time of the index 03/12/2025, 18:37:49
2025-03-12 18:37:49,739 [INFO]: 		-> Train: 16.7 minutes
2025-03-12 18:37:49,739 [INFO]: 		-> Add: 1.0 seconds
2025-03-12 18:37:49,739 [INFO]: 		Total: 16.7 minutes
2025-03-12 18:37:49,739 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0001 secs
2025-03-12 18:37:49,739 [INFO]: 	Checking that your have enough memory available to create the index 03/12/2025, 18:37:49
2025-03-12 18:37:49,740 [INFO]: 379.9MB of memory will be needed to build the index (more might be used if you have more)
2025-03-12 18:37:49,740 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0001 secs
2025-03-12 18:37:49,740 [INFO]: 	Selecting most promising index types given data characteristics 03/12/2025, 18:37:49
2025-03-12 18:37:49,740 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-12 18:37:49,740 [INFO]: 	Creating the index 03/12/2025, 18:37:49
2025-03-12 18:37:49,740 [INFO]: 		-> Instanciate the index HNSW15 03/12/2025, 18:37:49
2025-03-12 18:37:49,741 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0009 secs
2025-03-12 18:37:49,741 [INFO]: 		-> Adding the vectors to the index 03/12/2025, 18:37:49
2025-03-12 18:37:49,741 [INFO]: The memory available for adding the vectors is 49.7GB(total available - used by the index)
2025-03-12 18:37:49,741 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/8 [00:00<?, ?it/s] 25%|██▌       | 2/8 [00:00<00:00, 19.90it/s]100%|██████████| 8/8 [00:01<00:00,  5.38it/s]100%|██████████| 8/8 [00:01<00:00,  5.68it/s]
2025-03-12 18:37:51,152 [INFO]: 	Computing best hyperparameters for index knn.index 03/12/2025, 18:37:51
2025-03-12 18:38:11,609 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 20.4562 secs
2025-03-12 18:38:11,609 [INFO]: The best hyperparameters are: efSearch=244
2025-03-12 18:38:11,609 [INFO]: 	Compute fast metrics 03/12/2025, 18:38:11
  0%|          | 0/4 [00:00<?, ?it/s] 75%|███████▌  | 3/4 [00:00<00:00, 28.72it/s] 75%|███████▌  | 3/4 [00:00<00:00, 25.38it/s]
2025-03-12 18:38:22,634 [INFO]: 	>>> Finished "Compute fast metrics" in 11.0251 secs
2025-03-12 18:38:22,636 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 32.8948 secs
2025-03-12 18:38:22,636 [INFO]: {
2025-03-12 18:38:22,636 [INFO]: 	index_key: HNSW15
2025-03-12 18:38:22,636 [INFO]: 	index_param: efSearch=244
2025-03-12 18:38:22,636 [INFO]: 	index_path: knn.index
2025-03-12 18:38:22,636 [INFO]: 	size in bytes: 362205550
2025-03-12 18:38:22,636 [INFO]: 	avg_search_speed_ms: 8.417412661594536
2025-03-12 18:38:22,636 [INFO]: 	99p_search_speed_ms: 10.460554400924591
2025-03-12 18:38:22,636 [INFO]: 	reconstruction error %: 0.0
2025-03-12 18:38:22,636 [INFO]: 	nb vectors: 1841
2025-03-12 18:38:22,636 [INFO]: 	vectors dimension: 49152
2025-03-12 18:38:22,636 [INFO]: 	compression ratio: 0.9993091712702912
2025-03-12 18:38:22,636 [INFO]: }
2025-03-12 18:38:22,636 [INFO]: 	>>> Finished "Creating the index" in 32.8962 secs
2025-03-12 18:38:22,636 [INFO]: >>> Finished "Launching the whole pipeline" in 32.9241 secs
2025-03-12 18:38:23: [retrieval_preprocessing] calculating distances ...
2025-03-12 18:38:23: [retrieval_preprocessing] finished and saved retrieval indices for episode 76 [episode count 10/20]
[retrieval_preprocessing] for episode 77 [episode count 11/20], we have num_retrieval=np.int64(1859) num_query=np.int64(114)
2025-03-12 18:38:23,835 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-12 18:38:24,044 [INFO]: Launching the whole pipeline 03/12/2025, 18:38:24
2025-03-12 18:38:24,045 [INFO]: Reading total number of vectors and dimension 03/12/2025, 18:38:24
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1428.58it/s]
2025-03-12 18:38:24,077 [INFO]: There are 1859 embeddings of dim 49152
2025-03-12 18:38:24,077 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0326 secs
2025-03-12 18:38:24,077 [INFO]: 	Compute estimated construction time of the index 03/12/2025, 18:38:24
2025-03-12 18:38:24,077 [INFO]: 		-> Train: 16.7 minutes
2025-03-12 18:38:24,078 [INFO]: 		-> Add: 1.0 seconds
2025-03-12 18:38:24,078 [INFO]: 		Total: 16.7 minutes
2025-03-12 18:38:24,078 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0003 secs
2025-03-12 18:38:24,078 [INFO]: 	Checking that your have enough memory available to create the index 03/12/2025, 18:38:24
2025-03-12 18:38:24,078 [INFO]: 383.7MB of memory will be needed to build the index (more might be used if you have more)
2025-03-12 18:38:24,078 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0004 secs
2025-03-12 18:38:24,078 [INFO]: 	Selecting most promising index types given data characteristics 03/12/2025, 18:38:24
2025-03-12 18:38:24,078 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-12 18:38:24,079 [INFO]: 	Creating the index 03/12/2025, 18:38:24
2025-03-12 18:38:24,079 [INFO]: 		-> Instanciate the index HNSW15 03/12/2025, 18:38:24
2025-03-12 18:38:24,082 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0029 secs
2025-03-12 18:38:24,082 [INFO]: 		-> Adding the vectors to the index 03/12/2025, 18:38:24
2025-03-12 18:38:24,082 [INFO]: The memory available for adding the vectors is 49.7GB(total available - used by the index)
2025-03-12 18:38:24,082 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/8 [00:00<?, ?it/s] 38%|███▊      | 3/8 [00:00<00:00, 29.07it/s]100%|██████████| 8/8 [00:01<00:00,  5.87it/s]100%|██████████| 8/8 [00:01<00:00,  6.44it/s]
2025-03-12 18:38:25,329 [INFO]: 	Computing best hyperparameters for index knn.index 03/12/2025, 18:38:25
2025-03-12 18:38:45,179 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 19.8498 secs
2025-03-12 18:38:45,179 [INFO]: The best hyperparameters are: efSearch=302
2025-03-12 18:38:45,180 [INFO]: 	Compute fast metrics 03/12/2025, 18:38:45
  0%|          | 0/4 [00:00<?, ?it/s] 75%|███████▌  | 3/4 [00:00<00:00, 26.71it/s]
2025-03-12 18:38:56,269 [INFO]: 	>>> Finished "Compute fast metrics" in 11.0889 secs
2025-03-12 18:38:56,270 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 32.1875 secs
2025-03-12 18:38:56,270 [INFO]: {
2025-03-12 18:38:56,270 [INFO]: 	index_key: HNSW15
2025-03-12 18:38:56,270 [INFO]: 	index_param: efSearch=302
2025-03-12 18:38:56,270 [INFO]: 	index_path: knn.index
2025-03-12 18:38:56,270 [INFO]: 	size in bytes: 365746990
2025-03-12 18:38:56,270 [INFO]: 	avg_search_speed_ms: 9.575076575243944
2025-03-12 18:38:56,270 [INFO]: 	99p_search_speed_ms: 11.905057271942495
2025-03-12 18:38:56,270 [INFO]: 	reconstruction error %: 0.0
2025-03-12 18:38:56,270 [INFO]: 	nb vectors: 1859
2025-03-12 18:38:56,270 [INFO]: 	vectors dimension: 49152
2025-03-12 18:38:56,270 [INFO]: 	compression ratio: 0.9993090360087448
2025-03-12 18:38:56,270 [INFO]: }
2025-03-12 18:38:56,270 [INFO]: 	>>> Finished "Creating the index" in 32.1912 secs
2025-03-12 18:38:56,270 [INFO]: >>> Finished "Launching the whole pipeline" in 32.2253 secs
2025-03-12 18:38:57: [retrieval_preprocessing] calculating distances ...
2025-03-12 18:38:57: [retrieval_preprocessing] finished and saved retrieval indices for episode 77 [episode count 11/20]
[retrieval_preprocessing] for episode 78 [episode count 12/20], we have num_retrieval=np.int64(1902) num_query=np.int64(71)
2025-03-12 18:38:57,435 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-12 18:38:57,649 [INFO]: Launching the whole pipeline 03/12/2025, 18:38:57
2025-03-12 18:38:57,649 [INFO]: Reading total number of vectors and dimension 03/12/2025, 18:38:57
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 2534.32it/s]
2025-03-12 18:38:57,674 [INFO]: There are 1902 embeddings of dim 49152
2025-03-12 18:38:57,675 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0253 secs
2025-03-12 18:38:57,675 [INFO]: 	Compute estimated construction time of the index 03/12/2025, 18:38:57
2025-03-12 18:38:57,675 [INFO]: 		-> Train: 16.7 minutes
2025-03-12 18:38:57,675 [INFO]: 		-> Add: 1.0 seconds
2025-03-12 18:38:57,675 [INFO]: 		Total: 16.7 minutes
2025-03-12 18:38:57,675 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0001 secs
2025-03-12 18:38:57,675 [INFO]: 	Checking that your have enough memory available to create the index 03/12/2025, 18:38:57
2025-03-12 18:38:57,675 [INFO]: 392.5MB of memory will be needed to build the index (more might be used if you have more)
2025-03-12 18:38:57,675 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0001 secs
2025-03-12 18:38:57,675 [INFO]: 	Selecting most promising index types given data characteristics 03/12/2025, 18:38:57
2025-03-12 18:38:57,675 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-12 18:38:57,675 [INFO]: 	Creating the index 03/12/2025, 18:38:57
2025-03-12 18:38:57,675 [INFO]: 		-> Instanciate the index HNSW15 03/12/2025, 18:38:57
2025-03-12 18:38:57,676 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0008 secs
2025-03-12 18:38:57,676 [INFO]: 		-> Adding the vectors to the index 03/12/2025, 18:38:57
2025-03-12 18:38:57,676 [INFO]: The memory available for adding the vectors is 49.7GB(total available - used by the index)
2025-03-12 18:38:57,676 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/8 [00:00<?, ?it/s] 25%|██▌       | 2/8 [00:00<00:00, 17.93it/s]100%|██████████| 8/8 [00:01<00:00,  5.92it/s]100%|██████████| 8/8 [00:01<00:00,  6.22it/s]
2025-03-12 18:38:58,965 [INFO]: 	Computing best hyperparameters for index knn.index 03/12/2025, 18:38:58
2025-03-12 18:39:18,929 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 19.9632 secs
2025-03-12 18:39:18,929 [INFO]: The best hyperparameters are: efSearch=310
2025-03-12 18:39:18,929 [INFO]: 	Compute fast metrics 03/12/2025, 18:39:18
  0%|          | 0/4 [00:00<?, ?it/s] 75%|███████▌  | 3/4 [00:00<00:00, 26.58it/s]
2025-03-12 18:39:30,001 [INFO]: 	>>> Finished "Compute fast metrics" in 11.0721 secs
2025-03-12 18:39:30,003 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 32.3265 secs
2025-03-12 18:39:30,003 [INFO]: {
2025-03-12 18:39:30,003 [INFO]: 	index_key: HNSW15
2025-03-12 18:39:30,003 [INFO]: 	index_param: efSearch=310
2025-03-12 18:39:30,003 [INFO]: 	index_path: knn.index
2025-03-12 18:39:30,003 [INFO]: 	size in bytes: 374207170
2025-03-12 18:39:30,003 [INFO]: 	avg_search_speed_ms: 9.833586956497975
2025-03-12 18:39:30,003 [INFO]: 	99p_search_speed_ms: 12.31960816308856
2025-03-12 18:39:30,003 [INFO]: 	reconstruction error %: 0.0
2025-03-12 18:39:30,003 [INFO]: 	nb vectors: 1902
2025-03-12 18:39:30,003 [INFO]: 	vectors dimension: 49152
2025-03-12 18:39:30,003 [INFO]: 	compression ratio: 0.9993085274127698
2025-03-12 18:39:30,003 [INFO]: }
2025-03-12 18:39:30,003 [INFO]: 	>>> Finished "Creating the index" in 32.3278 secs
2025-03-12 18:39:30,003 [INFO]: >>> Finished "Launching the whole pipeline" in 32.3537 secs
2025-03-12 18:39:30: [retrieval_preprocessing] calculating distances ...
2025-03-12 18:39:30: [retrieval_preprocessing] finished and saved retrieval indices for episode 78 [episode count 12/20]
[retrieval_preprocessing] for episode 79 [episode count 13/20], we have num_retrieval=np.int64(1916) num_query=np.int64(57)
2025-03-12 18:39:30,747 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-12 18:39:30,963 [INFO]: Launching the whole pipeline 03/12/2025, 18:39:30
2025-03-12 18:39:30,963 [INFO]: Reading total number of vectors and dimension 03/12/2025, 18:39:30
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 2359.00it/s]
2025-03-12 18:39:30,991 [INFO]: There are 1916 embeddings of dim 49152
2025-03-12 18:39:30,991 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0280 secs
2025-03-12 18:39:30,991 [INFO]: 	Compute estimated construction time of the index 03/12/2025, 18:39:30
2025-03-12 18:39:30,991 [INFO]: 		-> Train: 16.7 minutes
2025-03-12 18:39:30,991 [INFO]: 		-> Add: 1.1 seconds
2025-03-12 18:39:30,991 [INFO]: 		Total: 16.7 minutes
2025-03-12 18:39:30,991 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0001 secs
2025-03-12 18:39:30,991 [INFO]: 	Checking that your have enough memory available to create the index 03/12/2025, 18:39:30
2025-03-12 18:39:30,992 [INFO]: 395.4MB of memory will be needed to build the index (more might be used if you have more)
2025-03-12 18:39:30,992 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0001 secs
2025-03-12 18:39:30,992 [INFO]: 	Selecting most promising index types given data characteristics 03/12/2025, 18:39:30
2025-03-12 18:39:30,992 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-12 18:39:30,992 [INFO]: 	Creating the index 03/12/2025, 18:39:30
2025-03-12 18:39:30,992 [INFO]: 		-> Instanciate the index HNSW15 03/12/2025, 18:39:30
2025-03-12 18:39:30,993 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0009 secs
2025-03-12 18:39:30,993 [INFO]: 		-> Adding the vectors to the index 03/12/2025, 18:39:30
2025-03-12 18:39:30,993 [INFO]: The memory available for adding the vectors is 49.6GB(total available - used by the index)
2025-03-12 18:39:30,993 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/8 [00:00<?, ?it/s] 38%|███▊      | 3/8 [00:00<00:00, 28.49it/s]100%|██████████| 8/8 [00:01<00:00,  5.59it/s]100%|██████████| 8/8 [00:01<00:00,  6.14it/s]
2025-03-12 18:39:32,297 [INFO]: 	Computing best hyperparameters for index knn.index 03/12/2025, 18:39:32
2025-03-12 18:39:52,103 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 19.8054 secs
2025-03-12 18:39:52,103 [INFO]: The best hyperparameters are: efSearch=310
2025-03-12 18:39:52,103 [INFO]: 	Compute fast metrics 03/12/2025, 18:39:52
  0%|          | 0/4 [00:00<?, ?it/s] 75%|███████▌  | 3/4 [00:00<00:00, 26.77it/s]
2025-03-12 18:40:03,183 [INFO]: 	>>> Finished "Compute fast metrics" in 11.0804 secs
2025-03-12 18:40:03,185 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 32.1920 secs
2025-03-12 18:40:03,185 [INFO]: {
2025-03-12 18:40:03,185 [INFO]: 	index_key: HNSW15
2025-03-12 18:40:03,185 [INFO]: 	index_param: efSearch=310
2025-03-12 18:40:03,185 [INFO]: 	index_path: knn.index
2025-03-12 18:40:03,185 [INFO]: 	size in bytes: 376961590
2025-03-12 18:40:03,185 [INFO]: 	avg_search_speed_ms: 9.502017255854799
2025-03-12 18:40:03,185 [INFO]: 	99p_search_speed_ms: 11.931480336934328
2025-03-12 18:40:03,185 [INFO]: 	reconstruction error %: 0.0
2025-03-12 18:40:03,185 [INFO]: 	nb vectors: 1916
2025-03-12 18:40:03,185 [INFO]: 	vectors dimension: 49152
2025-03-12 18:40:03,185 [INFO]: 	compression ratio: 0.9993085184089976
2025-03-12 18:40:03,185 [INFO]: }
2025-03-12 18:40:03,185 [INFO]: 	>>> Finished "Creating the index" in 32.1933 secs
2025-03-12 18:40:03,185 [INFO]: >>> Finished "Launching the whole pipeline" in 32.2218 secs
2025-03-12 18:40:03: [retrieval_preprocessing] calculating distances ...
2025-03-12 18:40:03: [retrieval_preprocessing] finished and saved retrieval indices for episode 79 [episode count 13/20]
[retrieval_preprocessing] for episode 80 [episode count 14/20], we have num_retrieval=np.int64(1832) num_query=np.int64(141)
2025-03-12 18:40:03,857 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-12 18:40:04,063 [INFO]: Launching the whole pipeline 03/12/2025, 18:40:04
2025-03-12 18:40:04,063 [INFO]: Reading total number of vectors and dimension 03/12/2025, 18:40:04
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1125.99it/s]
2025-03-12 18:40:04,093 [INFO]: There are 1832 embeddings of dim 49152
2025-03-12 18:40:04,093 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0297 secs
2025-03-12 18:40:04,093 [INFO]: 	Compute estimated construction time of the index 03/12/2025, 18:40:04
2025-03-12 18:40:04,093 [INFO]: 		-> Train: 16.7 minutes
2025-03-12 18:40:04,093 [INFO]: 		-> Add: 1.0 seconds
2025-03-12 18:40:04,093 [INFO]: 		Total: 16.7 minutes
2025-03-12 18:40:04,093 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0001 secs
2025-03-12 18:40:04,093 [INFO]: 	Checking that your have enough memory available to create the index 03/12/2025, 18:40:04
2025-03-12 18:40:04,093 [INFO]: 378.1MB of memory will be needed to build the index (more might be used if you have more)
2025-03-12 18:40:04,093 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0001 secs
2025-03-12 18:40:04,093 [INFO]: 	Selecting most promising index types given data characteristics 03/12/2025, 18:40:04
2025-03-12 18:40:04,093 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-12 18:40:04,093 [INFO]: 	Creating the index 03/12/2025, 18:40:04
2025-03-12 18:40:04,093 [INFO]: 		-> Instanciate the index HNSW15 03/12/2025, 18:40:04
2025-03-12 18:40:04,094 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0009 secs
2025-03-12 18:40:04,094 [INFO]: 		-> Adding the vectors to the index 03/12/2025, 18:40:04
2025-03-12 18:40:04,094 [INFO]: The memory available for adding the vectors is 49.7GB(total available - used by the index)
2025-03-12 18:40:04,095 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/8 [00:00<?, ?it/s] 38%|███▊      | 3/8 [00:00<00:00, 27.40it/s]100%|██████████| 8/8 [00:01<00:00,  6.07it/s]100%|██████████| 8/8 [00:01<00:00,  6.65it/s]
2025-03-12 18:40:05,300 [INFO]: 	Computing best hyperparameters for index knn.index 03/12/2025, 18:40:05
2025-03-12 18:40:24,132 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 18.8311 secs
2025-03-12 18:40:24,132 [INFO]: The best hyperparameters are: efSearch=306
2025-03-12 18:40:24,132 [INFO]: 	Compute fast metrics 03/12/2025, 18:40:24
  0%|          | 0/4 [00:00<?, ?it/s] 75%|███████▌  | 3/4 [00:00<00:00, 29.51it/s] 75%|███████▌  | 3/4 [00:00<00:00, 25.95it/s]
2025-03-12 18:40:35,174 [INFO]: 	>>> Finished "Compute fast metrics" in 11.0427 secs
2025-03-12 18:40:35,176 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 31.0811 secs
2025-03-12 18:40:35,176 [INFO]: {
2025-03-12 18:40:35,176 [INFO]: 	index_key: HNSW15
2025-03-12 18:40:35,176 [INFO]: 	index_param: efSearch=306
2025-03-12 18:40:35,176 [INFO]: 	index_path: knn.index
2025-03-12 18:40:35,176 [INFO]: 	size in bytes: 360434890
2025-03-12 18:40:35,176 [INFO]: 	avg_search_speed_ms: 9.439073798668412
2025-03-12 18:40:35,176 [INFO]: 	99p_search_speed_ms: 11.912251817993821
2025-03-12 18:40:35,176 [INFO]: 	reconstruction error %: 0.0
2025-03-12 18:40:35,176 [INFO]: 	nb vectors: 1832
2025-03-12 18:40:35,176 [INFO]: 	vectors dimension: 49152
2025-03-12 18:40:35,176 [INFO]: 	compression ratio: 0.9993090735472362
2025-03-12 18:40:35,176 [INFO]: }
2025-03-12 18:40:35,176 [INFO]: 	>>> Finished "Creating the index" in 31.0824 secs
2025-03-12 18:40:35,176 [INFO]: >>> Finished "Launching the whole pipeline" in 31.1125 secs
2025-03-12 18:40:36: [retrieval_preprocessing] calculating distances ...
2025-03-12 18:40:36: [retrieval_preprocessing] finished and saved retrieval indices for episode 80 [episode count 14/20]
[retrieval_preprocessing] for episode 81 [episode count 15/20], we have num_retrieval=np.int64(1904) num_query=np.int64(69)
2025-03-12 18:40:36,671 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-12 18:40:36,888 [INFO]: Launching the whole pipeline 03/12/2025, 18:40:36
2025-03-12 18:40:36,889 [INFO]: Reading total number of vectors and dimension 03/12/2025, 18:40:36
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 2477.44it/s]
2025-03-12 18:40:36,916 [INFO]: There are 1904 embeddings of dim 49152
2025-03-12 18:40:36,916 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0278 secs
2025-03-12 18:40:36,916 [INFO]: 	Compute estimated construction time of the index 03/12/2025, 18:40:36
2025-03-12 18:40:36,916 [INFO]: 		-> Train: 16.7 minutes
2025-03-12 18:40:36,916 [INFO]: 		-> Add: 1.0 seconds
2025-03-12 18:40:36,917 [INFO]: 		Total: 16.7 minutes
2025-03-12 18:40:36,917 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0001 secs
2025-03-12 18:40:36,917 [INFO]: 	Checking that your have enough memory available to create the index 03/12/2025, 18:40:36
2025-03-12 18:40:36,917 [INFO]: 392.9MB of memory will be needed to build the index (more might be used if you have more)
2025-03-12 18:40:36,917 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0001 secs
2025-03-12 18:40:36,917 [INFO]: 	Selecting most promising index types given data characteristics 03/12/2025, 18:40:36
2025-03-12 18:40:36,917 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-12 18:40:36,917 [INFO]: 	Creating the index 03/12/2025, 18:40:36
2025-03-12 18:40:36,917 [INFO]: 		-> Instanciate the index HNSW15 03/12/2025, 18:40:36
2025-03-12 18:40:36,918 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0009 secs
2025-03-12 18:40:36,918 [INFO]: 		-> Adding the vectors to the index 03/12/2025, 18:40:36
2025-03-12 18:40:36,918 [INFO]: The memory available for adding the vectors is 49.7GB(total available - used by the index)
2025-03-12 18:40:36,918 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/8 [00:00<?, ?it/s] 38%|███▊      | 3/8 [00:00<00:00, 26.95it/s]100%|██████████| 8/8 [00:01<00:00,  5.76it/s]100%|██████████| 8/8 [00:01<00:00,  6.31it/s]
2025-03-12 18:40:38,188 [INFO]: 	Computing best hyperparameters for index knn.index 03/12/2025, 18:40:38
2025-03-12 18:40:58,141 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 19.9527 secs
2025-03-12 18:40:58,141 [INFO]: The best hyperparameters are: efSearch=310
2025-03-12 18:40:58,141 [INFO]: 	Compute fast metrics 03/12/2025, 18:40:58
  0%|          | 0/4 [00:00<?, ?it/s] 75%|███████▌  | 3/4 [00:00<00:00, 28.05it/s] 75%|███████▌  | 3/4 [00:00<00:00, 24.91it/s]
2025-03-12 18:41:09,237 [INFO]: 	>>> Finished "Compute fast metrics" in 11.0958 secs
2025-03-12 18:41:09,239 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 32.3208 secs
2025-03-12 18:41:09,239 [INFO]: {
2025-03-12 18:41:09,239 [INFO]: 	index_key: HNSW15
2025-03-12 18:41:09,239 [INFO]: 	index_param: efSearch=310
2025-03-12 18:41:09,239 [INFO]: 	index_path: knn.index
2025-03-12 18:41:09,239 [INFO]: 	size in bytes: 374600710
2025-03-12 18:41:09,239 [INFO]: 	avg_search_speed_ms: 9.584046339382457
2025-03-12 18:41:09,239 [INFO]: 	99p_search_speed_ms: 11.979399595875291
2025-03-12 18:41:09,239 [INFO]: 	reconstruction error %: 0.0
2025-03-12 18:41:09,239 [INFO]: 	nb vectors: 1904
2025-03-12 18:41:09,239 [INFO]: 	vectors dimension: 49152
2025-03-12 18:41:09,239 [INFO]: 	compression ratio: 0.9993083889243028
2025-03-12 18:41:09,239 [INFO]: }
2025-03-12 18:41:09,239 [INFO]: 	>>> Finished "Creating the index" in 32.3220 secs
2025-03-12 18:41:09,239 [INFO]: >>> Finished "Launching the whole pipeline" in 32.3503 secs
2025-03-12 18:41:09: [retrieval_preprocessing] calculating distances ...
2025-03-12 18:41:09: [retrieval_preprocessing] finished and saved retrieval indices for episode 81 [episode count 15/20]
[retrieval_preprocessing] for episode 82 [episode count 16/20], we have num_retrieval=np.int64(1905) num_query=np.int64(68)
2025-03-12 18:41:09,935 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-12 18:41:10,159 [INFO]: Launching the whole pipeline 03/12/2025, 18:41:10
2025-03-12 18:41:10,159 [INFO]: Reading total number of vectors and dimension 03/12/2025, 18:41:10
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1283.84it/s]
2025-03-12 18:41:10,188 [INFO]: There are 1905 embeddings of dim 49152
2025-03-12 18:41:10,188 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0294 secs
2025-03-12 18:41:10,188 [INFO]: 	Compute estimated construction time of the index 03/12/2025, 18:41:10
2025-03-12 18:41:10,188 [INFO]: 		-> Train: 16.7 minutes
2025-03-12 18:41:10,188 [INFO]: 		-> Add: 1.0 seconds
2025-03-12 18:41:10,188 [INFO]: 		Total: 16.7 minutes
2025-03-12 18:41:10,188 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0001 secs
2025-03-12 18:41:10,188 [INFO]: 	Checking that your have enough memory available to create the index 03/12/2025, 18:41:10
2025-03-12 18:41:10,189 [INFO]: 393.1MB of memory will be needed to build the index (more might be used if you have more)
2025-03-12 18:41:10,189 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0001 secs
2025-03-12 18:41:10,189 [INFO]: 	Selecting most promising index types given data characteristics 03/12/2025, 18:41:10
2025-03-12 18:41:10,189 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-12 18:41:10,189 [INFO]: 	Creating the index 03/12/2025, 18:41:10
2025-03-12 18:41:10,189 [INFO]: 		-> Instanciate the index HNSW15 03/12/2025, 18:41:10
2025-03-12 18:41:10,190 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0010 secs
2025-03-12 18:41:10,190 [INFO]: 		-> Adding the vectors to the index 03/12/2025, 18:41:10
2025-03-12 18:41:10,190 [INFO]: The memory available for adding the vectors is 49.7GB(total available - used by the index)
2025-03-12 18:41:10,190 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/8 [00:00<?, ?it/s] 25%|██▌       | 2/8 [00:00<00:00, 19.87it/s]100%|██████████| 8/8 [00:01<00:00,  5.87it/s]100%|██████████| 8/8 [00:01<00:00,  6.19it/s]
2025-03-12 18:41:11,485 [INFO]: 	Computing best hyperparameters for index knn.index 03/12/2025, 18:41:11
2025-03-12 18:41:31,613 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 20.1277 secs
2025-03-12 18:41:31,614 [INFO]: The best hyperparameters are: efSearch=316
2025-03-12 18:41:31,614 [INFO]: 	Compute fast metrics 03/12/2025, 18:41:31
  0%|          | 0/4 [00:00<?, ?it/s] 75%|███████▌  | 3/4 [00:00<00:00, 29.59it/s] 75%|███████▌  | 3/4 [00:00<00:00, 26.06it/s]
2025-03-12 18:41:42,704 [INFO]: 	>>> Finished "Compute fast metrics" in 11.0904 secs
2025-03-12 18:41:42,705 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 32.5153 secs
2025-03-12 18:41:42,705 [INFO]: {
2025-03-12 18:41:42,705 [INFO]: 	index_key: HNSW15
2025-03-12 18:41:42,705 [INFO]: 	index_param: efSearch=316
2025-03-12 18:41:42,705 [INFO]: 	index_path: knn.index
2025-03-12 18:41:42,705 [INFO]: 	size in bytes: 374797450
2025-03-12 18:41:42,705 [INFO]: 	avg_search_speed_ms: 9.590509827119277
2025-03-12 18:41:42,705 [INFO]: 	99p_search_speed_ms: 12.099891235120593
2025-03-12 18:41:42,705 [INFO]: 	reconstruction error %: 0.0
2025-03-12 18:41:42,705 [INFO]: 	nb vectors: 1905
2025-03-12 18:41:42,705 [INFO]: 	vectors dimension: 49152
2025-03-12 18:41:42,705 [INFO]: 	compression ratio: 0.9993083997769996
2025-03-12 18:41:42,705 [INFO]: }
2025-03-12 18:41:42,705 [INFO]: 	>>> Finished "Creating the index" in 32.5167 secs
2025-03-12 18:41:42,705 [INFO]: >>> Finished "Launching the whole pipeline" in 32.5466 secs
2025-03-12 18:41:43: [retrieval_preprocessing] calculating distances ...
2025-03-12 18:41:43: [retrieval_preprocessing] finished and saved retrieval indices for episode 82 [episode count 16/20]
[retrieval_preprocessing] for episode 83 [episode count 17/20], we have num_retrieval=np.int64(1901) num_query=np.int64(72)
2025-03-12 18:41:43,450 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-12 18:41:43,670 [INFO]: Launching the whole pipeline 03/12/2025, 18:41:43
2025-03-12 18:41:43,671 [INFO]: Reading total number of vectors and dimension 03/12/2025, 18:41:43
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 2421.65it/s]
2025-03-12 18:41:43,698 [INFO]: There are 1901 embeddings of dim 49152
2025-03-12 18:41:43,698 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0278 secs
2025-03-12 18:41:43,698 [INFO]: 	Compute estimated construction time of the index 03/12/2025, 18:41:43
2025-03-12 18:41:43,698 [INFO]: 		-> Train: 16.7 minutes
2025-03-12 18:41:43,699 [INFO]: 		-> Add: 1.0 seconds
2025-03-12 18:41:43,699 [INFO]: 		Total: 16.7 minutes
2025-03-12 18:41:43,699 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0001 secs
2025-03-12 18:41:43,699 [INFO]: 	Checking that your have enough memory available to create the index 03/12/2025, 18:41:43
2025-03-12 18:41:43,699 [INFO]: 392.3MB of memory will be needed to build the index (more might be used if you have more)
2025-03-12 18:41:43,699 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0001 secs
2025-03-12 18:41:43,699 [INFO]: 	Selecting most promising index types given data characteristics 03/12/2025, 18:41:43
2025-03-12 18:41:43,699 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-12 18:41:43,699 [INFO]: 	Creating the index 03/12/2025, 18:41:43
2025-03-12 18:41:43,699 [INFO]: 		-> Instanciate the index HNSW15 03/12/2025, 18:41:43
2025-03-12 18:41:43,700 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0009 secs
2025-03-12 18:41:43,700 [INFO]: 		-> Adding the vectors to the index 03/12/2025, 18:41:43
2025-03-12 18:41:43,700 [INFO]: The memory available for adding the vectors is 49.7GB(total available - used by the index)
2025-03-12 18:41:43,700 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/8 [00:00<?, ?it/s] 38%|███▊      | 3/8 [00:00<00:00, 26.18it/s]100%|██████████| 8/8 [00:01<00:00,  5.69it/s]100%|██████████| 8/8 [00:01<00:00,  6.23it/s]
2025-03-12 18:41:44,987 [INFO]: 	Computing best hyperparameters for index knn.index 03/12/2025, 18:41:44
2025-03-12 18:42:04,714 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 19.7265 secs
2025-03-12 18:42:04,714 [INFO]: The best hyperparameters are: efSearch=303
2025-03-12 18:42:04,714 [INFO]: 	Compute fast metrics 03/12/2025, 18:42:04
  0%|          | 0/4 [00:00<?, ?it/s] 75%|███████▌  | 3/4 [00:00<00:00, 29.00it/s] 75%|███████▌  | 3/4 [00:00<00:00, 25.44it/s]
2025-03-12 18:42:15,797 [INFO]: 	>>> Finished "Compute fast metrics" in 11.0824 secs
2025-03-12 18:42:15,798 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 32.0978 secs
2025-03-12 18:42:15,798 [INFO]: {
2025-03-12 18:42:15,798 [INFO]: 	index_key: HNSW15
2025-03-12 18:42:15,798 [INFO]: 	index_param: efSearch=303
2025-03-12 18:42:15,798 [INFO]: 	index_path: knn.index
2025-03-12 18:42:15,798 [INFO]: 	size in bytes: 374010430
2025-03-12 18:42:15,798 [INFO]: 	avg_search_speed_ms: 9.475398898234054
2025-03-12 18:42:15,798 [INFO]: 	99p_search_speed_ms: 11.912262008991092
2025-03-12 18:42:15,798 [INFO]: 	reconstruction error %: 0.0
2025-03-12 18:42:15,798 [INFO]: 	nb vectors: 1901
2025-03-12 18:42:15,798 [INFO]: 	vectors dimension: 49152
2025-03-12 18:42:15,798 [INFO]: 	compression ratio: 0.9993085166100849
2025-03-12 18:42:15,798 [INFO]: }
2025-03-12 18:42:15,798 [INFO]: 	>>> Finished "Creating the index" in 32.0991 secs
2025-03-12 18:42:15,798 [INFO]: >>> Finished "Launching the whole pipeline" in 32.1275 secs
2025-03-12 18:42:16: [retrieval_preprocessing] calculating distances ...
2025-03-12 18:42:16: [retrieval_preprocessing] finished and saved retrieval indices for episode 83 [episode count 17/20]
[retrieval_preprocessing] for episode 84 [episode count 18/20], we have num_retrieval=np.int64(1894) num_query=np.int64(79)
2025-03-12 18:42:16,593 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-12 18:42:16,811 [INFO]: Launching the whole pipeline 03/12/2025, 18:42:16
2025-03-12 18:42:16,811 [INFO]: Reading total number of vectors and dimension 03/12/2025, 18:42:16
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1588.75it/s]
2025-03-12 18:42:16,843 [INFO]: There are 1894 embeddings of dim 49152
2025-03-12 18:42:16,843 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0323 secs
2025-03-12 18:42:16,844 [INFO]: 	Compute estimated construction time of the index 03/12/2025, 18:42:16
2025-03-12 18:42:16,844 [INFO]: 		-> Train: 16.7 minutes
2025-03-12 18:42:16,844 [INFO]: 		-> Add: 1.0 seconds
2025-03-12 18:42:16,844 [INFO]: 		Total: 16.7 minutes
2025-03-12 18:42:16,844 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0003 secs
2025-03-12 18:42:16,844 [INFO]: 	Checking that your have enough memory available to create the index 03/12/2025, 18:42:16
2025-03-12 18:42:16,844 [INFO]: 390.9MB of memory will be needed to build the index (more might be used if you have more)
2025-03-12 18:42:16,844 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0003 secs
2025-03-12 18:42:16,844 [INFO]: 	Selecting most promising index types given data characteristics 03/12/2025, 18:42:16
2025-03-12 18:42:16,845 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-12 18:42:16,845 [INFO]: 	Creating the index 03/12/2025, 18:42:16
2025-03-12 18:42:16,845 [INFO]: 		-> Instanciate the index HNSW15 03/12/2025, 18:42:16
2025-03-12 18:42:16,848 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0031 secs
2025-03-12 18:42:16,848 [INFO]: 		-> Adding the vectors to the index 03/12/2025, 18:42:16
2025-03-12 18:42:16,848 [INFO]: The memory available for adding the vectors is 49.7GB(total available - used by the index)
2025-03-12 18:42:16,849 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/8 [00:00<?, ?it/s] 50%|█████     | 4/8 [00:00<00:00, 36.09it/s]100%|██████████| 8/8 [00:01<00:00,  5.57it/s]100%|██████████| 8/8 [00:01<00:00,  6.37it/s]
2025-03-12 18:42:18,109 [INFO]: 	Computing best hyperparameters for index knn.index 03/12/2025, 18:42:18
2025-03-12 18:42:37,828 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 19.7193 secs
2025-03-12 18:42:37,829 [INFO]: The best hyperparameters are: efSearch=306
2025-03-12 18:42:37,829 [INFO]: 	Compute fast metrics 03/12/2025, 18:42:37
  0%|          | 0/4 [00:00<?, ?it/s] 75%|███████▌  | 3/4 [00:00<00:00, 25.99it/s]
2025-03-12 18:42:48,929 [INFO]: 	>>> Finished "Compute fast metrics" in 11.1001 secs
2025-03-12 18:42:48,930 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 32.0818 secs
2025-03-12 18:42:48,930 [INFO]: {
2025-03-12 18:42:48,930 [INFO]: 	index_key: HNSW15
2025-03-12 18:42:48,930 [INFO]: 	index_param: efSearch=306
2025-03-12 18:42:48,930 [INFO]: 	index_path: knn.index
2025-03-12 18:42:48,930 [INFO]: 	size in bytes: 372633190
2025-03-12 18:42:48,930 [INFO]: 	avg_search_speed_ms: 9.849372134071412
2025-03-12 18:42:48,930 [INFO]: 	99p_search_speed_ms: 13.319736295379698
2025-03-12 18:42:48,930 [INFO]: 	reconstruction error %: 0.0
2025-03-12 18:42:48,930 [INFO]: 	nb vectors: 1894
2025-03-12 18:42:48,930 [INFO]: 	vectors dimension: 49152
2025-03-12 18:42:48,930 [INFO]: 	compression ratio: 0.9993086015767946
2025-03-12 18:42:48,930 [INFO]: }
2025-03-12 18:42:48,930 [INFO]: 	>>> Finished "Creating the index" in 32.0857 secs
2025-03-12 18:42:48,930 [INFO]: >>> Finished "Launching the whole pipeline" in 32.1194 secs
2025-03-12 18:42:49: [retrieval_preprocessing] calculating distances ...
2025-03-12 18:42:49: [retrieval_preprocessing] finished and saved retrieval indices for episode 84 [episode count 18/20]
[retrieval_preprocessing] for episode 85 [episode count 19/20], we have num_retrieval=np.int64(1874) num_query=np.int64(99)
2025-03-12 18:42:49,783 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-12 18:42:49,994 [INFO]: Launching the whole pipeline 03/12/2025, 18:42:49
2025-03-12 18:42:49,994 [INFO]: Reading total number of vectors and dimension 03/12/2025, 18:42:49
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1339.61it/s]
2025-03-12 18:42:50,022 [INFO]: There are 1874 embeddings of dim 49152
2025-03-12 18:42:50,022 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0275 secs
2025-03-12 18:42:50,022 [INFO]: 	Compute estimated construction time of the index 03/12/2025, 18:42:50
2025-03-12 18:42:50,022 [INFO]: 		-> Train: 16.7 minutes
2025-03-12 18:42:50,022 [INFO]: 		-> Add: 1.0 seconds
2025-03-12 18:42:50,022 [INFO]: 		Total: 16.7 minutes
2025-03-12 18:42:50,022 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0001 secs
2025-03-12 18:42:50,022 [INFO]: 	Checking that your have enough memory available to create the index 03/12/2025, 18:42:50
2025-03-12 18:42:50,022 [INFO]: 386.7MB of memory will be needed to build the index (more might be used if you have more)
2025-03-12 18:42:50,022 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0001 secs
2025-03-12 18:42:50,022 [INFO]: 	Selecting most promising index types given data characteristics 03/12/2025, 18:42:50
2025-03-12 18:42:50,022 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-12 18:42:50,022 [INFO]: 	Creating the index 03/12/2025, 18:42:50
2025-03-12 18:42:50,022 [INFO]: 		-> Instanciate the index HNSW15 03/12/2025, 18:42:50
2025-03-12 18:42:50,024 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0011 secs
2025-03-12 18:42:50,024 [INFO]: 		-> Adding the vectors to the index 03/12/2025, 18:42:50
2025-03-12 18:42:50,024 [INFO]: The memory available for adding the vectors is 49.7GB(total available - used by the index)
2025-03-12 18:42:50,024 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/8 [00:00<?, ?it/s] 38%|███▊      | 3/8 [00:00<00:00, 26.77it/s]100%|██████████| 8/8 [00:01<00:00,  5.89it/s]100%|██████████| 8/8 [00:01<00:00,  6.45it/s]
2025-03-12 18:42:51,268 [INFO]: 	Computing best hyperparameters for index knn.index 03/12/2025, 18:42:51
2025-03-12 18:43:10,215 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 18.9466 secs
2025-03-12 18:43:10,215 [INFO]: The best hyperparameters are: efSearch=320
2025-03-12 18:43:10,215 [INFO]: 	Compute fast metrics 03/12/2025, 18:43:10
  0%|          | 0/4 [00:00<?, ?it/s] 75%|███████▌  | 3/4 [00:00<00:00, 26.73it/s]
2025-03-12 18:43:21,272 [INFO]: 	>>> Finished "Compute fast metrics" in 11.0568 secs
2025-03-12 18:43:21,273 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 31.2490 secs
2025-03-12 18:43:21,273 [INFO]: {
2025-03-12 18:43:21,273 [INFO]: 	index_key: HNSW15
2025-03-12 18:43:21,273 [INFO]: 	index_param: efSearch=320
2025-03-12 18:43:21,273 [INFO]: 	index_path: knn.index
2025-03-12 18:43:21,273 [INFO]: 	size in bytes: 368698210
2025-03-12 18:43:21,273 [INFO]: 	avg_search_speed_ms: 9.755329886769376
2025-03-12 18:43:21,273 [INFO]: 	99p_search_speed_ms: 12.1122538857162
2025-03-12 18:43:21,273 [INFO]: 	reconstruction error %: 0.0
2025-03-12 18:43:21,273 [INFO]: 	nb vectors: 1874
2025-03-12 18:43:21,273 [INFO]: 	vectors dimension: 49152
2025-03-12 18:43:21,273 [INFO]: 	compression ratio: 0.9993088710682919
2025-03-12 18:43:21,273 [INFO]: }
2025-03-12 18:43:21,273 [INFO]: 	>>> Finished "Creating the index" in 31.2506 secs
2025-03-12 18:43:21,273 [INFO]: >>> Finished "Launching the whole pipeline" in 31.2787 secs
2025-03-12 18:43:22: [retrieval_preprocessing] calculating distances ...
2025-03-12 18:43:22: [retrieval_preprocessing] finished and saved retrieval indices for episode 85 [episode count 19/20]
2025-03-12 18:43:22: [retrieval_preprocessing] finished for collected_demos_training/2025-03-10_move_the_jug_to_the_left [chosen_id count 4/8]
2025-03-12 18:43:23: [retrieval_preprocessing] concatenated all embeddings and indices for 20 episodes for collected_demos_training/2025-03-10_move_the_strawberry_forwards [chosen_id count 5/8]
2025-03-12 18:43:23: [retrieval_preprocessing] we have num_total=1952 embedding_dim=49152
[retrieval_preprocessing] for episode 86 [episode count 0/20], we have num_retrieval=np.int64(1847) num_query=np.int64(105)
2025-03-12 18:43:23,148 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-12 18:43:23,358 [INFO]: Launching the whole pipeline 03/12/2025, 18:43:23
2025-03-12 18:43:23,358 [INFO]: Reading total number of vectors and dimension 03/12/2025, 18:43:23
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1956.30it/s]
2025-03-12 18:43:23,385 [INFO]: There are 1847 embeddings of dim 49152
2025-03-12 18:43:23,385 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0275 secs
2025-03-12 18:43:23,385 [INFO]: 	Compute estimated construction time of the index 03/12/2025, 18:43:23
2025-03-12 18:43:23,385 [INFO]: 		-> Train: 16.7 minutes
2025-03-12 18:43:23,385 [INFO]: 		-> Add: 1.0 seconds
2025-03-12 18:43:23,385 [INFO]: 		Total: 16.7 minutes
2025-03-12 18:43:23,385 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0001 secs
2025-03-12 18:43:23,385 [INFO]: 	Checking that your have enough memory available to create the index 03/12/2025, 18:43:23
2025-03-12 18:43:23,386 [INFO]: 381.2MB of memory will be needed to build the index (more might be used if you have more)
2025-03-12 18:43:23,386 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0001 secs
2025-03-12 18:43:23,386 [INFO]: 	Selecting most promising index types given data characteristics 03/12/2025, 18:43:23
2025-03-12 18:43:23,386 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-12 18:43:23,386 [INFO]: 	Creating the index 03/12/2025, 18:43:23
2025-03-12 18:43:23,386 [INFO]: 		-> Instanciate the index HNSW15 03/12/2025, 18:43:23
2025-03-12 18:43:23,387 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0009 secs
2025-03-12 18:43:23,387 [INFO]: 		-> Adding the vectors to the index 03/12/2025, 18:43:23
2025-03-12 18:43:23,387 [INFO]: The memory available for adding the vectors is 49.7GB(total available - used by the index)
2025-03-12 18:43:23,387 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/8 [00:00<?, ?it/s] 38%|███▊      | 3/8 [00:00<00:00, 27.82it/s]100%|██████████| 8/8 [00:01<00:00,  6.03it/s]100%|██████████| 8/8 [00:01<00:00,  6.61it/s]
2025-03-12 18:43:24,600 [INFO]: 	Computing best hyperparameters for index knn.index 03/12/2025, 18:43:24
2025-03-12 18:43:44,457 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 19.8562 secs
2025-03-12 18:43:44,457 [INFO]: The best hyperparameters are: efSearch=382
2025-03-12 18:43:44,457 [INFO]: 	Compute fast metrics 03/12/2025, 18:43:44
  0%|          | 0/4 [00:00<?, ?it/s] 75%|███████▌  | 3/4 [00:00<00:00, 27.85it/s] 75%|███████▌  | 3/4 [00:00<00:00, 24.77it/s]
2025-03-12 18:43:55,514 [INFO]: 	>>> Finished "Compute fast metrics" in 11.0564 secs
2025-03-12 18:43:55,515 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 32.1281 secs
2025-03-12 18:43:55,515 [INFO]: {
2025-03-12 18:43:55,515 [INFO]: 	index_key: HNSW15
2025-03-12 18:43:55,515 [INFO]: 	index_param: efSearch=382
2025-03-12 18:43:55,515 [INFO]: 	index_path: knn.index
2025-03-12 18:43:55,515 [INFO]: 	size in bytes: 363385990
2025-03-12 18:43:55,515 [INFO]: 	avg_search_speed_ms: 9.729425560326066
2025-03-12 18:43:55,515 [INFO]: 	99p_search_speed_ms: 12.282885699532928
2025-03-12 18:43:55,515 [INFO]: 	reconstruction error %: 0.0
2025-03-12 18:43:55,515 [INFO]: 	nb vectors: 1847
2025-03-12 18:43:55,515 [INFO]: 	vectors dimension: 49152
2025-03-12 18:43:55,515 [INFO]: 	compression ratio: 0.9993092358899142
2025-03-12 18:43:55,515 [INFO]: }
2025-03-12 18:43:55,515 [INFO]: 	>>> Finished "Creating the index" in 32.1294 secs
2025-03-12 18:43:55,515 [INFO]: >>> Finished "Launching the whole pipeline" in 32.1574 secs
2025-03-12 18:43:56: [retrieval_preprocessing] calculating distances ...
2025-03-12 18:43:56: [retrieval_preprocessing] finished and saved retrieval indices for episode 86 [episode count 0/20]
[retrieval_preprocessing] for episode 87 [episode count 1/20], we have num_retrieval=np.int64(1834) num_query=np.int64(118)
2025-03-12 18:43:56,977 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-12 18:43:57,183 [INFO]: Launching the whole pipeline 03/12/2025, 18:43:57
2025-03-12 18:43:57,183 [INFO]: Reading total number of vectors and dimension 03/12/2025, 18:43:57
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1872.46it/s]
2025-03-12 18:43:57,210 [INFO]: There are 1834 embeddings of dim 49152
2025-03-12 18:43:57,210 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0267 secs
2025-03-12 18:43:57,210 [INFO]: 	Compute estimated construction time of the index 03/12/2025, 18:43:57
2025-03-12 18:43:57,210 [INFO]: 		-> Train: 16.7 minutes
2025-03-12 18:43:57,210 [INFO]: 		-> Add: 1.0 seconds
2025-03-12 18:43:57,210 [INFO]: 		Total: 16.7 minutes
2025-03-12 18:43:57,210 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0001 secs
2025-03-12 18:43:57,210 [INFO]: 	Checking that your have enough memory available to create the index 03/12/2025, 18:43:57
2025-03-12 18:43:57,210 [INFO]: 378.5MB of memory will be needed to build the index (more might be used if you have more)
2025-03-12 18:43:57,210 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0001 secs
2025-03-12 18:43:57,210 [INFO]: 	Selecting most promising index types given data characteristics 03/12/2025, 18:43:57
2025-03-12 18:43:57,210 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-12 18:43:57,210 [INFO]: 	Creating the index 03/12/2025, 18:43:57
2025-03-12 18:43:57,210 [INFO]: 		-> Instanciate the index HNSW15 03/12/2025, 18:43:57
2025-03-12 18:43:57,211 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0008 secs
2025-03-12 18:43:57,211 [INFO]: 		-> Adding the vectors to the index 03/12/2025, 18:43:57
2025-03-12 18:43:57,211 [INFO]: The memory available for adding the vectors is 49.7GB(total available - used by the index)
2025-03-12 18:43:57,211 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/8 [00:00<?, ?it/s] 38%|███▊      | 3/8 [00:00<00:00, 28.53it/s]100%|██████████| 8/8 [00:01<00:00,  6.32it/s]100%|██████████| 8/8 [00:01<00:00,  6.91it/s]
2025-03-12 18:43:58,371 [INFO]: 	Computing best hyperparameters for index knn.index 03/12/2025, 18:43:58
2025-03-12 18:44:18,172 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 19.8004 secs
2025-03-12 18:44:18,172 [INFO]: The best hyperparameters are: efSearch=363
2025-03-12 18:44:18,172 [INFO]: 	Compute fast metrics 03/12/2025, 18:44:18
  0%|          | 0/4 [00:00<?, ?it/s] 75%|███████▌  | 3/4 [00:00<00:00, 29.57it/s] 75%|███████▌  | 3/4 [00:00<00:00, 26.05it/s]
2025-03-12 18:44:29,213 [INFO]: 	>>> Finished "Compute fast metrics" in 11.0417 secs
2025-03-12 18:44:29,215 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 32.0033 secs
2025-03-12 18:44:29,215 [INFO]: {
2025-03-12 18:44:29,215 [INFO]: 	index_key: HNSW15
2025-03-12 18:44:29,215 [INFO]: 	index_param: efSearch=363
2025-03-12 18:44:29,215 [INFO]: 	index_path: knn.index
2025-03-12 18:44:29,215 [INFO]: 	size in bytes: 360828370
2025-03-12 18:44:29,215 [INFO]: 	avg_search_speed_ms: 9.841455675810062
2025-03-12 18:44:29,215 [INFO]: 	99p_search_speed_ms: 13.025323138572277
2025-03-12 18:44:29,215 [INFO]: 	reconstruction error %: 0.0
2025-03-12 18:44:29,215 [INFO]: 	nb vectors: 1834
2025-03-12 18:44:29,215 [INFO]: 	vectors dimension: 49152
2025-03-12 18:44:29,215 [INFO]: 	compression ratio: 0.9993090953463554
2025-03-12 18:44:29,215 [INFO]: }
2025-03-12 18:44:29,215 [INFO]: 	>>> Finished "Creating the index" in 32.0046 secs
2025-03-12 18:44:29,215 [INFO]: >>> Finished "Launching the whole pipeline" in 32.0318 secs
2025-03-12 18:44:30: [retrieval_preprocessing] calculating distances ...
2025-03-12 18:44:30: [retrieval_preprocessing] finished and saved retrieval indices for episode 87 [episode count 1/20]
[retrieval_preprocessing] for episode 88 [episode count 2/20], we have num_retrieval=np.int64(1852) num_query=np.int64(100)
2025-03-12 18:44:30,812 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-12 18:44:31,024 [INFO]: Launching the whole pipeline 03/12/2025, 18:44:31
2025-03-12 18:44:31,024 [INFO]: Reading total number of vectors and dimension 03/12/2025, 18:44:31
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 2545.09it/s]
2025-03-12 18:44:31,051 [INFO]: There are 1852 embeddings of dim 49152
2025-03-12 18:44:31,051 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0272 secs
2025-03-12 18:44:31,051 [INFO]: 	Compute estimated construction time of the index 03/12/2025, 18:44:31
2025-03-12 18:44:31,051 [INFO]: 		-> Train: 16.7 minutes
2025-03-12 18:44:31,051 [INFO]: 		-> Add: 1.0 seconds
2025-03-12 18:44:31,051 [INFO]: 		Total: 16.7 minutes
2025-03-12 18:44:31,051 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0001 secs
2025-03-12 18:44:31,052 [INFO]: 	Checking that your have enough memory available to create the index 03/12/2025, 18:44:31
2025-03-12 18:44:31,052 [INFO]: 382.2MB of memory will be needed to build the index (more might be used if you have more)
2025-03-12 18:44:31,052 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0001 secs
2025-03-12 18:44:31,052 [INFO]: 	Selecting most promising index types given data characteristics 03/12/2025, 18:44:31
2025-03-12 18:44:31,052 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-12 18:44:31,052 [INFO]: 	Creating the index 03/12/2025, 18:44:31
2025-03-12 18:44:31,052 [INFO]: 		-> Instanciate the index HNSW15 03/12/2025, 18:44:31
2025-03-12 18:44:31,053 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0009 secs
2025-03-12 18:44:31,053 [INFO]: 		-> Adding the vectors to the index 03/12/2025, 18:44:31
2025-03-12 18:44:31,053 [INFO]: The memory available for adding the vectors is 49.7GB(total available - used by the index)
2025-03-12 18:44:31,053 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/8 [00:00<?, ?it/s] 38%|███▊      | 3/8 [00:00<00:00, 27.82it/s]100%|██████████| 8/8 [00:01<00:00,  6.17it/s]100%|██████████| 8/8 [00:01<00:00,  6.76it/s]
2025-03-12 18:44:32,240 [INFO]: 	Computing best hyperparameters for index knn.index 03/12/2025, 18:44:32
2025-03-12 18:44:52,295 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 20.0554 secs
2025-03-12 18:44:52,295 [INFO]: The best hyperparameters are: efSearch=344
2025-03-12 18:44:52,296 [INFO]: 	Compute fast metrics 03/12/2025, 18:44:52
  0%|          | 0/4 [00:00<?, ?it/s] 75%|███████▌  | 3/4 [00:00<00:00, 27.62it/s] 75%|███████▌  | 3/4 [00:00<00:00, 24.58it/s]
2025-03-12 18:45:03,347 [INFO]: 	>>> Finished "Compute fast metrics" in 11.0518 secs
2025-03-12 18:45:03,348 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 32.2957 secs
2025-03-12 18:45:03,349 [INFO]: {
2025-03-12 18:45:03,349 [INFO]: 	index_key: HNSW15
2025-03-12 18:45:03,349 [INFO]: 	index_param: efSearch=344
2025-03-12 18:45:03,349 [INFO]: 	index_path: knn.index
2025-03-12 18:45:03,349 [INFO]: 	size in bytes: 364369690
2025-03-12 18:45:03,349 [INFO]: 	avg_search_speed_ms: 9.544991117631945
2025-03-12 18:45:03,349 [INFO]: 	99p_search_speed_ms: 12.174827284179628
2025-03-12 18:45:03,349 [INFO]: 	reconstruction error %: 0.0
2025-03-12 18:45:03,349 [INFO]: 	nb vectors: 1852
2025-03-12 18:45:03,349 [INFO]: 	vectors dimension: 49152
2025-03-12 18:45:03,349 [INFO]: 	compression ratio: 0.9993092894197648
2025-03-12 18:45:03,349 [INFO]: }
2025-03-12 18:45:03,349 [INFO]: 	>>> Finished "Creating the index" in 32.2970 secs
2025-03-12 18:45:03,349 [INFO]: >>> Finished "Launching the whole pipeline" in 32.3246 secs
2025-03-12 18:45:04: [retrieval_preprocessing] calculating distances ...
2025-03-12 18:45:04: [retrieval_preprocessing] finished and saved retrieval indices for episode 88 [episode count 2/20]
[retrieval_preprocessing] for episode 89 [episode count 3/20], we have num_retrieval=np.int64(1860) num_query=np.int64(92)
2025-03-12 18:45:04,708 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-12 18:45:04,925 [INFO]: Launching the whole pipeline 03/12/2025, 18:45:04
2025-03-12 18:45:04,925 [INFO]: Reading total number of vectors and dimension 03/12/2025, 18:45:04
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1597.22it/s]
2025-03-12 18:45:04,954 [INFO]: There are 1860 embeddings of dim 49152
2025-03-12 18:45:04,955 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0297 secs
2025-03-12 18:45:04,955 [INFO]: 	Compute estimated construction time of the index 03/12/2025, 18:45:04
2025-03-12 18:45:04,955 [INFO]: 		-> Train: 16.7 minutes
2025-03-12 18:45:04,955 [INFO]: 		-> Add: 1.0 seconds
2025-03-12 18:45:04,955 [INFO]: 		Total: 16.7 minutes
2025-03-12 18:45:04,955 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0003 secs
2025-03-12 18:45:04,955 [INFO]: 	Checking that your have enough memory available to create the index 03/12/2025, 18:45:04
2025-03-12 18:45:04,956 [INFO]: 383.9MB of memory will be needed to build the index (more might be used if you have more)
2025-03-12 18:45:04,956 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0003 secs
2025-03-12 18:45:04,956 [INFO]: 	Selecting most promising index types given data characteristics 03/12/2025, 18:45:04
2025-03-12 18:45:04,956 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-12 18:45:04,956 [INFO]: 	Creating the index 03/12/2025, 18:45:04
2025-03-12 18:45:04,956 [INFO]: 		-> Instanciate the index HNSW15 03/12/2025, 18:45:04
2025-03-12 18:45:04,959 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0028 secs
2025-03-12 18:45:04,959 [INFO]: 		-> Adding the vectors to the index 03/12/2025, 18:45:04
2025-03-12 18:45:04,960 [INFO]: The memory available for adding the vectors is 49.7GB(total available - used by the index)
2025-03-12 18:45:04,960 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/8 [00:00<?, ?it/s] 38%|███▊      | 3/8 [00:00<00:00, 27.65it/s]100%|██████████| 8/8 [00:01<00:00,  5.98it/s]100%|██████████| 8/8 [00:01<00:00,  6.54it/s]
2025-03-12 18:45:06,187 [INFO]: 	Computing best hyperparameters for index knn.index 03/12/2025, 18:45:06
2025-03-12 18:45:28,343 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 22.1560 secs
2025-03-12 18:45:28,343 [INFO]: The best hyperparameters are: efSearch=346
2025-03-12 18:45:28,343 [INFO]: 	Compute fast metrics 03/12/2025, 18:45:28
  0%|          | 0/4 [00:00<?, ?it/s] 75%|███████▌  | 3/4 [00:00<00:00, 26.54it/s]
2025-03-12 18:45:39,396 [INFO]: 	>>> Finished "Compute fast metrics" in 11.0532 secs
2025-03-12 18:45:39,397 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 34.4378 secs
2025-03-12 18:45:39,397 [INFO]: {
2025-03-12 18:45:39,397 [INFO]: 	index_key: HNSW15
2025-03-12 18:45:39,397 [INFO]: 	index_param: efSearch=346
2025-03-12 18:45:39,397 [INFO]: 	index_path: knn.index
2025-03-12 18:45:39,397 [INFO]: 	size in bytes: 365943790
2025-03-12 18:45:39,397 [INFO]: 	avg_search_speed_ms: 9.318722618564978
2025-03-12 18:45:39,397 [INFO]: 	99p_search_speed_ms: 11.825800715014337
2025-03-12 18:45:39,397 [INFO]: 	reconstruction error %: 0.0
2025-03-12 18:45:39,397 [INFO]: 	nb vectors: 1860
2025-03-12 18:45:39,397 [INFO]: 	vectors dimension: 49152
2025-03-12 18:45:39,397 [INFO]: 	compression ratio: 0.9993088829298074
2025-03-12 18:45:39,398 [INFO]: }
2025-03-12 18:45:39,398 [INFO]: 	>>> Finished "Creating the index" in 34.4413 secs
2025-03-12 18:45:39,398 [INFO]: >>> Finished "Launching the whole pipeline" in 34.4727 secs
2025-03-12 18:45:40: [retrieval_preprocessing] calculating distances ...
2025-03-12 18:45:40: [retrieval_preprocessing] finished and saved retrieval indices for episode 89 [episode count 3/20]
[retrieval_preprocessing] for episode 90 [episode count 4/20], we have num_retrieval=np.int64(1881) num_query=np.int64(71)
2025-03-12 18:45:40,630 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-12 18:45:40,844 [INFO]: Launching the whole pipeline 03/12/2025, 18:45:40
2025-03-12 18:45:40,844 [INFO]: Reading total number of vectors and dimension 03/12/2025, 18:45:40
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 2445.66it/s]
2025-03-12 18:45:40,867 [INFO]: There are 1881 embeddings of dim 49152
2025-03-12 18:45:40,868 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0232 secs
2025-03-12 18:45:40,868 [INFO]: 	Compute estimated construction time of the index 03/12/2025, 18:45:40
2025-03-12 18:45:40,868 [INFO]: 		-> Train: 16.7 minutes
2025-03-12 18:45:40,868 [INFO]: 		-> Add: 1.0 seconds
2025-03-12 18:45:40,868 [INFO]: 		Total: 16.7 minutes
2025-03-12 18:45:40,868 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0001 secs
2025-03-12 18:45:40,868 [INFO]: 	Checking that your have enough memory available to create the index 03/12/2025, 18:45:40
2025-03-12 18:45:40,868 [INFO]: 388.2MB of memory will be needed to build the index (more might be used if you have more)
2025-03-12 18:45:40,868 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0001 secs
2025-03-12 18:45:40,868 [INFO]: 	Selecting most promising index types given data characteristics 03/12/2025, 18:45:40
2025-03-12 18:45:40,868 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-12 18:45:40,868 [INFO]: 	Creating the index 03/12/2025, 18:45:40
2025-03-12 18:45:40,868 [INFO]: 		-> Instanciate the index HNSW15 03/12/2025, 18:45:40
2025-03-12 18:45:40,869 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0008 secs
2025-03-12 18:45:40,869 [INFO]: 		-> Adding the vectors to the index 03/12/2025, 18:45:40
2025-03-12 18:45:40,869 [INFO]: The memory available for adding the vectors is 49.7GB(total available - used by the index)
2025-03-12 18:45:40,869 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/8 [00:00<?, ?it/s] 38%|███▊      | 3/8 [00:00<00:00, 27.85it/s]100%|██████████| 8/8 [00:01<00:00,  5.80it/s]100%|██████████| 8/8 [00:01<00:00,  6.35it/s]
2025-03-12 18:45:42,131 [INFO]: 	Computing best hyperparameters for index knn.index 03/12/2025, 18:45:42
2025-03-12 18:46:02,381 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 20.2495 secs
2025-03-12 18:46:02,381 [INFO]: The best hyperparameters are: efSearch=288
2025-03-12 18:46:02,381 [INFO]: 	Compute fast metrics 03/12/2025, 18:46:02
  0%|          | 0/4 [00:00<?, ?it/s] 75%|███████▌  | 3/4 [00:00<00:00, 30.00it/s] 75%|███████▌  | 3/4 [00:00<00:00, 26.04it/s]
2025-03-12 18:46:13,457 [INFO]: 	>>> Finished "Compute fast metrics" in 11.0753 secs
2025-03-12 18:46:13,458 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 32.5886 secs
2025-03-12 18:46:13,458 [INFO]: {
2025-03-12 18:46:13,458 [INFO]: 	index_key: HNSW15
2025-03-12 18:46:13,458 [INFO]: 	index_param: efSearch=288
2025-03-12 18:46:13,458 [INFO]: 	index_path: knn.index
2025-03-12 18:46:13,458 [INFO]: 	size in bytes: 370075510
2025-03-12 18:46:13,458 [INFO]: 	avg_search_speed_ms: 8.465554567951328
2025-03-12 18:46:13,458 [INFO]: 	99p_search_speed_ms: 10.831259051337838
2025-03-12 18:46:13,458 [INFO]: 	reconstruction error %: 0.0
2025-03-12 18:46:13,458 [INFO]: 	nb vectors: 1881
2025-03-12 18:46:13,458 [INFO]: 	vectors dimension: 49152
2025-03-12 18:46:13,458 [INFO]: 	compression ratio: 0.9993086221782144
2025-03-12 18:46:13,458 [INFO]: }
2025-03-12 18:46:13,458 [INFO]: 	>>> Finished "Creating the index" in 32.5898 secs
2025-03-12 18:46:13,458 [INFO]: >>> Finished "Launching the whole pipeline" in 32.6136 secs
2025-03-12 18:46:13: [retrieval_preprocessing] calculating distances ...
2025-03-12 18:46:14: [retrieval_preprocessing] finished and saved retrieval indices for episode 90 [episode count 4/20]
[retrieval_preprocessing] for episode 91 [episode count 5/20], we have num_retrieval=np.int64(1873) num_query=np.int64(79)
2025-03-12 18:46:14,225 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-12 18:46:14,440 [INFO]: Launching the whole pipeline 03/12/2025, 18:46:14
2025-03-12 18:46:14,440 [INFO]: Reading total number of vectors and dimension 03/12/2025, 18:46:14
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1867.46it/s]
2025-03-12 18:46:14,467 [INFO]: There are 1873 embeddings of dim 49152
2025-03-12 18:46:14,467 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0270 secs
2025-03-12 18:46:14,467 [INFO]: 	Compute estimated construction time of the index 03/12/2025, 18:46:14
2025-03-12 18:46:14,467 [INFO]: 		-> Train: 16.7 minutes
2025-03-12 18:46:14,467 [INFO]: 		-> Add: 1.0 seconds
2025-03-12 18:46:14,467 [INFO]: 		Total: 16.7 minutes
2025-03-12 18:46:14,467 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0001 secs
2025-03-12 18:46:14,467 [INFO]: 	Checking that your have enough memory available to create the index 03/12/2025, 18:46:14
2025-03-12 18:46:14,468 [INFO]: 386.5MB of memory will be needed to build the index (more might be used if you have more)
2025-03-12 18:46:14,468 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0001 secs
2025-03-12 18:46:14,468 [INFO]: 	Selecting most promising index types given data characteristics 03/12/2025, 18:46:14
2025-03-12 18:46:14,468 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-12 18:46:14,468 [INFO]: 	Creating the index 03/12/2025, 18:46:14
2025-03-12 18:46:14,468 [INFO]: 		-> Instanciate the index HNSW15 03/12/2025, 18:46:14
2025-03-12 18:46:14,469 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0010 secs
2025-03-12 18:46:14,469 [INFO]: 		-> Adding the vectors to the index 03/12/2025, 18:46:14
2025-03-12 18:46:14,469 [INFO]: The memory available for adding the vectors is 49.7GB(total available - used by the index)
2025-03-12 18:46:14,469 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/8 [00:00<?, ?it/s] 25%|██▌       | 2/8 [00:00<00:00, 19.81it/s]100%|██████████| 8/8 [00:01<00:00,  6.07it/s]100%|██████████| 8/8 [00:01<00:00,  6.40it/s]
2025-03-12 18:46:15,722 [INFO]: 	Computing best hyperparameters for index knn.index 03/12/2025, 18:46:15
2025-03-12 18:46:35,692 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 19.9698 secs
2025-03-12 18:46:35,693 [INFO]: The best hyperparameters are: efSearch=370
2025-03-12 18:46:35,693 [INFO]: 	Compute fast metrics 03/12/2025, 18:46:35
  0%|          | 0/4 [00:00<?, ?it/s] 75%|███████▌  | 3/4 [00:00<00:00, 28.88it/s] 75%|███████▌  | 3/4 [00:00<00:00, 25.47it/s]
2025-03-12 18:46:46,747 [INFO]: 	>>> Finished "Compute fast metrics" in 11.0547 secs
2025-03-12 18:46:46,748 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 32.2795 secs
2025-03-12 18:46:46,749 [INFO]: {
2025-03-12 18:46:46,749 [INFO]: 	index_key: HNSW15
2025-03-12 18:46:46,749 [INFO]: 	index_param: efSearch=370
2025-03-12 18:46:46,749 [INFO]: 	index_path: knn.index
2025-03-12 18:46:46,749 [INFO]: 	size in bytes: 368501470
2025-03-12 18:46:46,749 [INFO]: 	avg_search_speed_ms: 9.501732184913395
2025-03-12 18:46:46,749 [INFO]: 	99p_search_speed_ms: 11.88352769240737
2025-03-12 18:46:46,749 [INFO]: 	reconstruction error %: 0.0
2025-03-12 18:46:46,749 [INFO]: 	nb vectors: 1873
2025-03-12 18:46:46,749 [INFO]: 	vectors dimension: 49152
2025-03-12 18:46:46,749 [INFO]: 	compression ratio: 0.9993088602875858
2025-03-12 18:46:46,749 [INFO]: }
2025-03-12 18:46:46,749 [INFO]: 	>>> Finished "Creating the index" in 32.2809 secs
2025-03-12 18:46:46,749 [INFO]: >>> Finished "Launching the whole pipeline" in 32.3085 secs
2025-03-12 18:46:47: [retrieval_preprocessing] calculating distances ...
2025-03-12 18:46:47: [retrieval_preprocessing] finished and saved retrieval indices for episode 91 [episode count 5/20]
[retrieval_preprocessing] for episode 92 [episode count 6/20], we have num_retrieval=np.int64(1859) num_query=np.int64(93)
2025-03-12 18:46:47,849 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-12 18:46:48,060 [INFO]: Launching the whole pipeline 03/12/2025, 18:46:48
2025-03-12 18:46:48,060 [INFO]: Reading total number of vectors and dimension 03/12/2025, 18:46:48
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 2507.06it/s]
2025-03-12 18:46:48,087 [INFO]: There are 1859 embeddings of dim 49152
2025-03-12 18:46:48,087 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0268 secs
2025-03-12 18:46:48,087 [INFO]: 	Compute estimated construction time of the index 03/12/2025, 18:46:48
2025-03-12 18:46:48,087 [INFO]: 		-> Train: 16.7 minutes
2025-03-12 18:46:48,087 [INFO]: 		-> Add: 1.0 seconds
2025-03-12 18:46:48,087 [INFO]: 		Total: 16.7 minutes
2025-03-12 18:46:48,087 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0001 secs
2025-03-12 18:46:48,087 [INFO]: 	Checking that your have enough memory available to create the index 03/12/2025, 18:46:48
2025-03-12 18:46:48,088 [INFO]: 383.7MB of memory will be needed to build the index (more might be used if you have more)
2025-03-12 18:46:48,088 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0002 secs
2025-03-12 18:46:48,088 [INFO]: 	Selecting most promising index types given data characteristics 03/12/2025, 18:46:48
2025-03-12 18:46:48,088 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-12 18:46:48,088 [INFO]: 	Creating the index 03/12/2025, 18:46:48
2025-03-12 18:46:48,088 [INFO]: 		-> Instanciate the index HNSW15 03/12/2025, 18:46:48
2025-03-12 18:46:48,089 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0009 secs
2025-03-12 18:46:48,089 [INFO]: 		-> Adding the vectors to the index 03/12/2025, 18:46:48
2025-03-12 18:46:48,089 [INFO]: The memory available for adding the vectors is 49.7GB(total available - used by the index)
2025-03-12 18:46:48,089 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/8 [00:00<?, ?it/s] 38%|███▊      | 3/8 [00:00<00:00, 28.52it/s]100%|██████████| 8/8 [00:01<00:00,  5.94it/s]100%|██████████| 8/8 [00:01<00:00,  6.51it/s]
2025-03-12 18:46:49,321 [INFO]: 	Computing best hyperparameters for index knn.index 03/12/2025, 18:46:49
2025-03-12 18:47:08,629 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 19.3079 secs
2025-03-12 18:47:08,629 [INFO]: The best hyperparameters are: efSearch=354
2025-03-12 18:47:08,629 [INFO]: 	Compute fast metrics 03/12/2025, 18:47:08
  0%|          | 0/4 [00:00<?, ?it/s] 75%|███████▌  | 3/4 [00:00<00:00, 29.41it/s] 75%|███████▌  | 3/4 [00:00<00:00, 25.94it/s]
2025-03-12 18:47:19,703 [INFO]: 	>>> Finished "Compute fast metrics" in 11.0730 secs
2025-03-12 18:47:19,704 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 31.6148 secs
2025-03-12 18:47:19,704 [INFO]: {
2025-03-12 18:47:19,704 [INFO]: 	index_key: HNSW15
2025-03-12 18:47:19,704 [INFO]: 	index_param: efSearch=354
2025-03-12 18:47:19,704 [INFO]: 	index_path: knn.index
2025-03-12 18:47:19,704 [INFO]: 	size in bytes: 365746990
2025-03-12 18:47:19,704 [INFO]: 	avg_search_speed_ms: 9.549994743273459
2025-03-12 18:47:19,704 [INFO]: 	99p_search_speed_ms: 11.973361410200592
2025-03-12 18:47:19,704 [INFO]: 	reconstruction error %: 0.0
2025-03-12 18:47:19,704 [INFO]: 	nb vectors: 1859
2025-03-12 18:47:19,704 [INFO]: 	vectors dimension: 49152
2025-03-12 18:47:19,704 [INFO]: 	compression ratio: 0.9993090360087448
2025-03-12 18:47:19,704 [INFO]: }
2025-03-12 18:47:19,704 [INFO]: 	>>> Finished "Creating the index" in 31.6160 secs
2025-03-12 18:47:19,704 [INFO]: >>> Finished "Launching the whole pipeline" in 31.6434 secs
2025-03-12 18:47:20: [retrieval_preprocessing] calculating distances ...
2025-03-12 18:47:20: [retrieval_preprocessing] finished and saved retrieval indices for episode 92 [episode count 6/20]
[retrieval_preprocessing] for episode 93 [episode count 7/20], we have num_retrieval=np.int64(1880) num_query=np.int64(72)
2025-03-12 18:47:20,914 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-12 18:47:21,131 [INFO]: Launching the whole pipeline 03/12/2025, 18:47:21
2025-03-12 18:47:21,131 [INFO]: Reading total number of vectors and dimension 03/12/2025, 18:47:21
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1214.33it/s]
2025-03-12 18:47:21,156 [INFO]: There are 1880 embeddings of dim 49152
2025-03-12 18:47:21,156 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0249 secs
2025-03-12 18:47:21,156 [INFO]: 	Compute estimated construction time of the index 03/12/2025, 18:47:21
2025-03-12 18:47:21,156 [INFO]: 		-> Train: 16.7 minutes
2025-03-12 18:47:21,156 [INFO]: 		-> Add: 1.0 seconds
2025-03-12 18:47:21,156 [INFO]: 		Total: 16.7 minutes
2025-03-12 18:47:21,156 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0001 secs
2025-03-12 18:47:21,156 [INFO]: 	Checking that your have enough memory available to create the index 03/12/2025, 18:47:21
2025-03-12 18:47:21,156 [INFO]: 388.0MB of memory will be needed to build the index (more might be used if you have more)
2025-03-12 18:47:21,156 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0001 secs
2025-03-12 18:47:21,156 [INFO]: 	Selecting most promising index types given data characteristics 03/12/2025, 18:47:21
2025-03-12 18:47:21,156 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-12 18:47:21,156 [INFO]: 	Creating the index 03/12/2025, 18:47:21
2025-03-12 18:47:21,156 [INFO]: 		-> Instanciate the index HNSW15 03/12/2025, 18:47:21
2025-03-12 18:47:21,157 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0008 secs
2025-03-12 18:47:21,157 [INFO]: 		-> Adding the vectors to the index 03/12/2025, 18:47:21
2025-03-12 18:47:21,157 [INFO]: The memory available for adding the vectors is 49.7GB(total available - used by the index)
2025-03-12 18:47:21,157 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/8 [00:00<?, ?it/s] 38%|███▊      | 3/8 [00:00<00:00, 29.28it/s]100%|██████████| 8/8 [00:01<00:00,  6.11it/s]100%|██████████| 8/8 [00:01<00:00,  6.70it/s]
2025-03-12 18:47:22,354 [INFO]: 	Computing best hyperparameters for index knn.index 03/12/2025, 18:47:22
2025-03-12 18:47:41,485 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 19.1314 secs
2025-03-12 18:47:41,485 [INFO]: The best hyperparameters are: efSearch=364
2025-03-12 18:47:41,485 [INFO]: 	Compute fast metrics 03/12/2025, 18:47:41
  0%|          | 0/4 [00:00<?, ?it/s] 75%|███████▌  | 3/4 [00:00<00:00, 29.58it/s] 75%|███████▌  | 3/4 [00:00<00:00, 25.96it/s]
2025-03-12 18:47:52,548 [INFO]: 	>>> Finished "Compute fast metrics" in 11.0627 secs
2025-03-12 18:47:52,549 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 31.3918 secs
2025-03-12 18:47:52,549 [INFO]: {
2025-03-12 18:47:52,549 [INFO]: 	index_key: HNSW15
2025-03-12 18:47:52,549 [INFO]: 	index_param: efSearch=364
2025-03-12 18:47:52,549 [INFO]: 	index_path: knn.index
2025-03-12 18:47:52,549 [INFO]: 	size in bytes: 369878770
2025-03-12 18:47:52,549 [INFO]: 	avg_search_speed_ms: 9.637484086277269
2025-03-12 18:47:52,549 [INFO]: 	99p_search_speed_ms: 12.233796839136627
2025-03-12 18:47:52,549 [INFO]: 	reconstruction error %: 0.0
2025-03-12 18:47:52,549 [INFO]: 	nb vectors: 1880
2025-03-12 18:47:52,549 [INFO]: 	vectors dimension: 49152
2025-03-12 18:47:52,549 [INFO]: 	compression ratio: 0.9993086113052663
2025-03-12 18:47:52,549 [INFO]: }
2025-03-12 18:47:52,549 [INFO]: 	>>> Finished "Creating the index" in 31.3931 secs
2025-03-12 18:47:52,549 [INFO]: >>> Finished "Launching the whole pipeline" in 31.4185 secs
2025-03-12 18:47:53: [retrieval_preprocessing] calculating distances ...
2025-03-12 18:47:53: [retrieval_preprocessing] finished and saved retrieval indices for episode 93 [episode count 7/20]
[retrieval_preprocessing] for episode 94 [episode count 8/20], we have num_retrieval=np.int64(1873) num_query=np.int64(79)
2025-03-12 18:47:53,589 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-12 18:47:53,804 [INFO]: Launching the whole pipeline 03/12/2025, 18:47:53
2025-03-12 18:47:53,804 [INFO]: Reading total number of vectors and dimension 03/12/2025, 18:47:53
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 2525.17it/s]
2025-03-12 18:47:53,832 [INFO]: There are 1873 embeddings of dim 49152
2025-03-12 18:47:53,832 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0277 secs
2025-03-12 18:47:53,832 [INFO]: 	Compute estimated construction time of the index 03/12/2025, 18:47:53
2025-03-12 18:47:53,832 [INFO]: 		-> Train: 16.7 minutes
2025-03-12 18:47:53,832 [INFO]: 		-> Add: 1.0 seconds
2025-03-12 18:47:53,832 [INFO]: 		Total: 16.7 minutes
2025-03-12 18:47:53,832 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0002 secs
2025-03-12 18:47:53,832 [INFO]: 	Checking that your have enough memory available to create the index 03/12/2025, 18:47:53
2025-03-12 18:47:53,832 [INFO]: 386.5MB of memory will be needed to build the index (more might be used if you have more)
2025-03-12 18:47:53,832 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0001 secs
2025-03-12 18:47:53,832 [INFO]: 	Selecting most promising index types given data characteristics 03/12/2025, 18:47:53
2025-03-12 18:47:53,832 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-12 18:47:53,832 [INFO]: 	Creating the index 03/12/2025, 18:47:53
2025-03-12 18:47:53,832 [INFO]: 		-> Instanciate the index HNSW15 03/12/2025, 18:47:53
2025-03-12 18:47:53,833 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0008 secs
2025-03-12 18:47:53,833 [INFO]: 		-> Adding the vectors to the index 03/12/2025, 18:47:53
2025-03-12 18:47:53,833 [INFO]: The memory available for adding the vectors is 49.7GB(total available - used by the index)
2025-03-12 18:47:53,833 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/8 [00:00<?, ?it/s] 50%|█████     | 4/8 [00:00<00:00, 35.31it/s]100%|██████████| 8/8 [00:01<00:00,  5.77it/s]100%|██████████| 8/8 [00:01<00:00,  6.59it/s]
2025-03-12 18:47:55,051 [INFO]: 	Computing best hyperparameters for index knn.index 03/12/2025, 18:47:55
2025-03-12 18:48:14,148 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 19.0968 secs
2025-03-12 18:48:14,148 [INFO]: The best hyperparameters are: efSearch=366
2025-03-12 18:48:14,148 [INFO]: 	Compute fast metrics 03/12/2025, 18:48:14
  0%|          | 0/4 [00:00<?, ?it/s] 75%|███████▌  | 3/4 [00:00<00:00, 27.24it/s]
2025-03-12 18:48:25,244 [INFO]: 	>>> Finished "Compute fast metrics" in 11.0956 secs
2025-03-12 18:48:25,245 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 31.4114 secs
2025-03-12 18:48:25,245 [INFO]: {
2025-03-12 18:48:25,245 [INFO]: 	index_key: HNSW15
2025-03-12 18:48:25,245 [INFO]: 	index_param: efSearch=366
2025-03-12 18:48:25,245 [INFO]: 	index_path: knn.index
2025-03-12 18:48:25,245 [INFO]: 	size in bytes: 368501470
2025-03-12 18:48:25,245 [INFO]: 	avg_search_speed_ms: 9.634871978576516
2025-03-12 18:48:25,245 [INFO]: 	99p_search_speed_ms: 12.922655800357457
2025-03-12 18:48:25,245 [INFO]: 	reconstruction error %: 0.0
2025-03-12 18:48:25,245 [INFO]: 	nb vectors: 1873
2025-03-12 18:48:25,245 [INFO]: 	vectors dimension: 49152
2025-03-12 18:48:25,245 [INFO]: 	compression ratio: 0.9993088602875858
2025-03-12 18:48:25,245 [INFO]: }
2025-03-12 18:48:25,245 [INFO]: 	>>> Finished "Creating the index" in 31.4126 secs
2025-03-12 18:48:25,245 [INFO]: >>> Finished "Launching the whole pipeline" in 31.4410 secs
2025-03-12 18:48:26: [retrieval_preprocessing] calculating distances ...
2025-03-12 18:48:26: [retrieval_preprocessing] finished and saved retrieval indices for episode 94 [episode count 8/20]
[retrieval_preprocessing] for episode 95 [episode count 9/20], we have num_retrieval=np.int64(1864) num_query=np.int64(88)
2025-03-12 18:48:26,355 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-12 18:48:26,568 [INFO]: Launching the whole pipeline 03/12/2025, 18:48:26
2025-03-12 18:48:26,569 [INFO]: Reading total number of vectors and dimension 03/12/2025, 18:48:26
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 2376.38it/s]
2025-03-12 18:48:26,592 [INFO]: There are 1864 embeddings of dim 49152
2025-03-12 18:48:26,592 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0235 secs
2025-03-12 18:48:26,592 [INFO]: 	Compute estimated construction time of the index 03/12/2025, 18:48:26
2025-03-12 18:48:26,592 [INFO]: 		-> Train: 16.7 minutes
2025-03-12 18:48:26,592 [INFO]: 		-> Add: 1.0 seconds
2025-03-12 18:48:26,592 [INFO]: 		Total: 16.7 minutes
2025-03-12 18:48:26,592 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0001 secs
2025-03-12 18:48:26,592 [INFO]: 	Checking that your have enough memory available to create the index 03/12/2025, 18:48:26
2025-03-12 18:48:26,592 [INFO]: 384.7MB of memory will be needed to build the index (more might be used if you have more)
2025-03-12 18:48:26,592 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0001 secs
2025-03-12 18:48:26,592 [INFO]: 	Selecting most promising index types given data characteristics 03/12/2025, 18:48:26
2025-03-12 18:48:26,593 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-12 18:48:26,593 [INFO]: 	Creating the index 03/12/2025, 18:48:26
2025-03-12 18:48:26,593 [INFO]: 		-> Instanciate the index HNSW15 03/12/2025, 18:48:26
2025-03-12 18:48:26,593 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0008 secs
2025-03-12 18:48:26,593 [INFO]: 		-> Adding the vectors to the index 03/12/2025, 18:48:26
2025-03-12 18:48:26,594 [INFO]: The memory available for adding the vectors is 49.7GB(total available - used by the index)
2025-03-12 18:48:26,594 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/8 [00:00<?, ?it/s] 25%|██▌       | 2/8 [00:00<00:00, 19.03it/s]100%|██████████| 8/8 [00:01<00:00,  6.20it/s]100%|██████████| 8/8 [00:01<00:00,  6.52it/s]
2025-03-12 18:48:27,822 [INFO]: 	Computing best hyperparameters for index knn.index 03/12/2025, 18:48:27
2025-03-12 18:48:47,574 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 19.7510 secs
2025-03-12 18:48:47,574 [INFO]: The best hyperparameters are: efSearch=369
2025-03-12 18:48:47,574 [INFO]: 	Compute fast metrics 03/12/2025, 18:48:47
  0%|          | 0/4 [00:00<?, ?it/s] 75%|███████▌  | 3/4 [00:00<00:00, 29.68it/s] 75%|███████▌  | 3/4 [00:00<00:00, 25.53it/s]
2025-03-12 18:48:59,004 [INFO]: 	>>> Finished "Compute fast metrics" in 11.4296 secs
2025-03-12 18:48:59,005 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 32.4112 secs
2025-03-12 18:48:59,005 [INFO]: {
2025-03-12 18:48:59,005 [INFO]: 	index_key: HNSW15
2025-03-12 18:48:59,005 [INFO]: 	index_param: efSearch=369
2025-03-12 18:48:59,005 [INFO]: 	index_path: knn.index
2025-03-12 18:48:59,005 [INFO]: 	size in bytes: 366730750
2025-03-12 18:48:59,005 [INFO]: 	avg_search_speed_ms: 9.977492005429635
2025-03-12 18:48:59,005 [INFO]: 	99p_search_speed_ms: 13.359214346855879
2025-03-12 18:48:59,005 [INFO]: 	reconstruction error %: 0.0
2025-03-12 18:48:59,005 [INFO]: 	nb vectors: 1864
2025-03-12 18:48:59,005 [INFO]: 	vectors dimension: 49152
2025-03-12 18:48:59,005 [INFO]: 	compression ratio: 0.999308926235392
2025-03-12 18:48:59,005 [INFO]: }
2025-03-12 18:48:59,005 [INFO]: 	>>> Finished "Creating the index" in 32.4124 secs
2025-03-12 18:48:59,005 [INFO]: >>> Finished "Launching the whole pipeline" in 32.4365 secs
2025-03-12 18:48:59: [retrieval_preprocessing] calculating distances ...
2025-03-12 18:49:00: [retrieval_preprocessing] finished and saved retrieval indices for episode 95 [episode count 9/20]
[retrieval_preprocessing] for episode 96 [episode count 10/20], we have num_retrieval=np.int64(1868) num_query=np.int64(84)
2025-03-12 18:49:00,182 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-12 18:49:00,396 [INFO]: Launching the whole pipeline 03/12/2025, 18:49:00
2025-03-12 18:49:00,397 [INFO]: Reading total number of vectors and dimension 03/12/2025, 18:49:00
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1632.66it/s]
2025-03-12 18:49:00,424 [INFO]: There are 1868 embeddings of dim 49152
2025-03-12 18:49:00,424 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0277 secs
2025-03-12 18:49:00,424 [INFO]: 	Compute estimated construction time of the index 03/12/2025, 18:49:00
2025-03-12 18:49:00,425 [INFO]: 		-> Train: 16.7 minutes
2025-03-12 18:49:00,425 [INFO]: 		-> Add: 1.0 seconds
2025-03-12 18:49:00,425 [INFO]: 		Total: 16.7 minutes
2025-03-12 18:49:00,425 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0001 secs
2025-03-12 18:49:00,425 [INFO]: 	Checking that your have enough memory available to create the index 03/12/2025, 18:49:00
2025-03-12 18:49:00,425 [INFO]: 385.5MB of memory will be needed to build the index (more might be used if you have more)
2025-03-12 18:49:00,425 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0001 secs
2025-03-12 18:49:00,425 [INFO]: 	Selecting most promising index types given data characteristics 03/12/2025, 18:49:00
2025-03-12 18:49:00,425 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-12 18:49:00,425 [INFO]: 	Creating the index 03/12/2025, 18:49:00
2025-03-12 18:49:00,425 [INFO]: 		-> Instanciate the index HNSW15 03/12/2025, 18:49:00
2025-03-12 18:49:00,426 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0009 secs
2025-03-12 18:49:00,426 [INFO]: 		-> Adding the vectors to the index 03/12/2025, 18:49:00
2025-03-12 18:49:00,426 [INFO]: The memory available for adding the vectors is 49.7GB(total available - used by the index)
2025-03-12 18:49:00,426 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/8 [00:00<?, ?it/s] 25%|██▌       | 2/8 [00:00<00:00, 19.16it/s]100%|██████████| 8/8 [00:01<00:00,  6.06it/s]100%|██████████| 8/8 [00:01<00:00,  6.38it/s]
2025-03-12 18:49:01,683 [INFO]: 	Computing best hyperparameters for index knn.index 03/12/2025, 18:49:01
2025-03-12 18:49:21,786 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 20.1023 secs
2025-03-12 18:49:21,786 [INFO]: The best hyperparameters are: efSearch=363
2025-03-12 18:49:21,786 [INFO]: 	Compute fast metrics 03/12/2025, 18:49:21
  0%|          | 0/4 [00:00<?, ?it/s] 75%|███████▌  | 3/4 [00:00<00:00, 28.22it/s]
2025-03-12 18:49:33,002 [INFO]: 	>>> Finished "Compute fast metrics" in 11.2157 secs
2025-03-12 18:49:33,003 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 32.5767 secs
2025-03-12 18:49:33,003 [INFO]: {
2025-03-12 18:49:33,003 [INFO]: 	index_key: HNSW15
2025-03-12 18:49:33,003 [INFO]: 	index_param: efSearch=363
2025-03-12 18:49:33,003 [INFO]: 	index_path: knn.index
2025-03-12 18:49:33,003 [INFO]: 	size in bytes: 367517710
2025-03-12 18:49:33,003 [INFO]: 	avg_search_speed_ms: 9.53313550384479
2025-03-12 18:49:33,003 [INFO]: 	99p_search_speed_ms: 12.046235129237175
2025-03-12 18:49:33,003 [INFO]: 	reconstruction error %: 0.0
2025-03-12 18:49:33,003 [INFO]: 	nb vectors: 1868
2025-03-12 18:49:33,003 [INFO]: 	vectors dimension: 49152
2025-03-12 18:49:33,003 [INFO]: 	compression ratio: 0.9993089693555176
2025-03-12 18:49:33,003 [INFO]: }
2025-03-12 18:49:33,003 [INFO]: 	>>> Finished "Creating the index" in 32.5780 secs
2025-03-12 18:49:33,003 [INFO]: >>> Finished "Launching the whole pipeline" in 32.6063 secs
2025-03-12 18:49:33: [retrieval_preprocessing] calculating distances ...
2025-03-12 18:49:34: [retrieval_preprocessing] finished and saved retrieval indices for episode 96 [episode count 10/20]
[retrieval_preprocessing] for episode 97 [episode count 11/20], we have num_retrieval=np.int64(1839) num_query=np.int64(113)
2025-03-12 18:49:34,153 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-12 18:49:34,367 [INFO]: Launching the whole pipeline 03/12/2025, 18:49:34
2025-03-12 18:49:34,367 [INFO]: Reading total number of vectors and dimension 03/12/2025, 18:49:34
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1381.98it/s]
2025-03-12 18:49:34,396 [INFO]: There are 1839 embeddings of dim 49152
2025-03-12 18:49:34,396 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0287 secs
2025-03-12 18:49:34,396 [INFO]: 	Compute estimated construction time of the index 03/12/2025, 18:49:34
2025-03-12 18:49:34,397 [INFO]: 		-> Train: 16.7 minutes
2025-03-12 18:49:34,397 [INFO]: 		-> Add: 1.0 seconds
2025-03-12 18:49:34,397 [INFO]: 		Total: 16.7 minutes
2025-03-12 18:49:34,397 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0003 secs
2025-03-12 18:49:34,397 [INFO]: 	Checking that your have enough memory available to create the index 03/12/2025, 18:49:34
2025-03-12 18:49:34,397 [INFO]: 379.5MB of memory will be needed to build the index (more might be used if you have more)
2025-03-12 18:49:34,397 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0004 secs
2025-03-12 18:49:34,397 [INFO]: 	Selecting most promising index types given data characteristics 03/12/2025, 18:49:34
2025-03-12 18:49:34,398 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-12 18:49:34,398 [INFO]: 	Creating the index 03/12/2025, 18:49:34
2025-03-12 18:49:34,398 [INFO]: 		-> Instanciate the index HNSW15 03/12/2025, 18:49:34
2025-03-12 18:49:34,400 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0026 secs
2025-03-12 18:49:34,401 [INFO]: 		-> Adding the vectors to the index 03/12/2025, 18:49:34
2025-03-12 18:49:34,401 [INFO]: The memory available for adding the vectors is 49.7GB(total available - used by the index)
2025-03-12 18:49:34,401 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/8 [00:00<?, ?it/s] 50%|█████     | 4/8 [00:00<00:00, 38.40it/s]100%|██████████| 8/8 [00:01<00:00,  5.96it/s]100%|██████████| 8/8 [00:01<00:00,  6.81it/s]
2025-03-12 18:49:35,579 [INFO]: 	Computing best hyperparameters for index knn.index 03/12/2025, 18:49:35
2025-03-12 18:49:54,277 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 18.6976 secs
2025-03-12 18:49:54,277 [INFO]: The best hyperparameters are: efSearch=381
2025-03-12 18:49:54,277 [INFO]: 	Compute fast metrics 03/12/2025, 18:49:54
  0%|          | 0/4 [00:00<?, ?it/s] 75%|███████▌  | 3/4 [00:00<00:00, 29.28it/s] 75%|███████▌  | 3/4 [00:00<00:00, 25.79it/s]
2025-03-12 18:50:05,341 [INFO]: 	>>> Finished "Compute fast metrics" in 11.0636 secs
2025-03-12 18:50:05,342 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 30.9414 secs
2025-03-12 18:50:05,342 [INFO]: {
2025-03-12 18:50:05,342 [INFO]: 	index_key: HNSW15
2025-03-12 18:50:05,342 [INFO]: 	index_param: efSearch=381
2025-03-12 18:50:05,342 [INFO]: 	index_path: knn.index
2025-03-12 18:50:05,342 [INFO]: 	size in bytes: 361812070
2025-03-12 18:50:05,342 [INFO]: 	avg_search_speed_ms: 9.779253853475884
2025-03-12 18:50:05,342 [INFO]: 	99p_search_speed_ms: 12.218839875422418
2025-03-12 18:50:05,342 [INFO]: 	reconstruction error %: 0.0
2025-03-12 18:50:05,342 [INFO]: 	nb vectors: 1839
2025-03-12 18:50:05,342 [INFO]: 	vectors dimension: 49152
2025-03-12 18:50:05,342 [INFO]: 	compression ratio: 0.9993091496367161
2025-03-12 18:50:05,342 [INFO]: }
2025-03-12 18:50:05,342 [INFO]: 	>>> Finished "Creating the index" in 30.9448 secs
2025-03-12 18:50:05,342 [INFO]: >>> Finished "Launching the whole pipeline" in 30.9751 secs
2025-03-12 18:50:06: [retrieval_preprocessing] calculating distances ...
2025-03-12 18:50:06: [retrieval_preprocessing] finished and saved retrieval indices for episode 97 [episode count 11/20]
[retrieval_preprocessing] for episode 98 [episode count 12/20], we have num_retrieval=np.int64(1857) num_query=np.int64(95)
2025-03-12 18:50:06,845 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-12 18:50:07,055 [INFO]: Launching the whole pipeline 03/12/2025, 18:50:07
2025-03-12 18:50:07,055 [INFO]: Reading total number of vectors and dimension 03/12/2025, 18:50:07
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1605.78it/s]
2025-03-12 18:50:07,082 [INFO]: There are 1857 embeddings of dim 49152
2025-03-12 18:50:07,082 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0268 secs
2025-03-12 18:50:07,082 [INFO]: 	Compute estimated construction time of the index 03/12/2025, 18:50:07
2025-03-12 18:50:07,082 [INFO]: 		-> Train: 16.7 minutes
2025-03-12 18:50:07,082 [INFO]: 		-> Add: 1.0 seconds
2025-03-12 18:50:07,082 [INFO]: 		Total: 16.7 minutes
2025-03-12 18:50:07,082 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0001 secs
2025-03-12 18:50:07,082 [INFO]: 	Checking that your have enough memory available to create the index 03/12/2025, 18:50:07
2025-03-12 18:50:07,082 [INFO]: 383.2MB of memory will be needed to build the index (more might be used if you have more)
2025-03-12 18:50:07,082 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0001 secs
2025-03-12 18:50:07,082 [INFO]: 	Selecting most promising index types given data characteristics 03/12/2025, 18:50:07
2025-03-12 18:50:07,082 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-12 18:50:07,082 [INFO]: 	Creating the index 03/12/2025, 18:50:07
2025-03-12 18:50:07,082 [INFO]: 		-> Instanciate the index HNSW15 03/12/2025, 18:50:07
2025-03-12 18:50:07,083 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0009 secs
2025-03-12 18:50:07,083 [INFO]: 		-> Adding the vectors to the index 03/12/2025, 18:50:07
2025-03-12 18:50:07,083 [INFO]: The memory available for adding the vectors is 49.7GB(total available - used by the index)
2025-03-12 18:50:07,083 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/8 [00:00<?, ?it/s] 38%|███▊      | 3/8 [00:00<00:00, 29.04it/s]100%|██████████| 8/8 [00:01<00:00,  6.15it/s]100%|██████████| 8/8 [00:01<00:00,  6.74it/s]
2025-03-12 18:50:08,273 [INFO]: 	Computing best hyperparameters for index knn.index 03/12/2025, 18:50:08
2025-03-12 18:50:28,558 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 20.2846 secs
2025-03-12 18:50:28,558 [INFO]: The best hyperparameters are: efSearch=344
2025-03-12 18:50:28,558 [INFO]: 	Compute fast metrics 03/12/2025, 18:50:28
  0%|          | 0/4 [00:00<?, ?it/s] 75%|███████▌  | 3/4 [00:00<00:00, 29.49it/s] 75%|███████▌  | 3/4 [00:00<00:00, 25.79it/s]
2025-03-12 18:50:39,643 [INFO]: 	>>> Finished "Compute fast metrics" in 11.0847 secs
2025-03-12 18:50:39,644 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 32.5604 secs
2025-03-12 18:50:39,644 [INFO]: {
2025-03-12 18:50:39,644 [INFO]: 	index_key: HNSW15
2025-03-12 18:50:39,644 [INFO]: 	index_param: efSearch=344
2025-03-12 18:50:39,644 [INFO]: 	index_path: knn.index
2025-03-12 18:50:39,644 [INFO]: 	size in bytes: 365353510
2025-03-12 18:50:39,644 [INFO]: 	avg_search_speed_ms: 9.366058345538763
2025-03-12 18:50:39,644 [INFO]: 	99p_search_speed_ms: 11.861086154822251
2025-03-12 18:50:39,644 [INFO]: 	reconstruction error %: 0.0
2025-03-12 18:50:39,644 [INFO]: 	nb vectors: 1857
2025-03-12 18:50:39,644 [INFO]: 	vectors dimension: 49152
2025-03-12 18:50:39,644 [INFO]: 	compression ratio: 0.9993090144391934
2025-03-12 18:50:39,644 [INFO]: }
2025-03-12 18:50:39,644 [INFO]: 	>>> Finished "Creating the index" in 32.5616 secs
2025-03-12 18:50:39,644 [INFO]: >>> Finished "Launching the whole pipeline" in 32.5889 secs
2025-03-12 18:50:40: [retrieval_preprocessing] calculating distances ...
2025-03-12 18:50:40: [retrieval_preprocessing] finished and saved retrieval indices for episode 98 [episode count 12/20]
[retrieval_preprocessing] for episode 99 [episode count 13/20], we have num_retrieval=np.int64(1835) num_query=np.int64(117)
2025-03-12 18:50:40,867 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-12 18:50:41,083 [INFO]: Launching the whole pipeline 03/12/2025, 18:50:41
2025-03-12 18:50:41,083 [INFO]: Reading total number of vectors and dimension 03/12/2025, 18:50:41
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1913.46it/s]
2025-03-12 18:50:41,110 [INFO]: There are 1835 embeddings of dim 49152
2025-03-12 18:50:41,110 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0271 secs
2025-03-12 18:50:41,110 [INFO]: 	Compute estimated construction time of the index 03/12/2025, 18:50:41
2025-03-12 18:50:41,110 [INFO]: 		-> Train: 16.7 minutes
2025-03-12 18:50:41,110 [INFO]: 		-> Add: 1.0 seconds
2025-03-12 18:50:41,110 [INFO]: 		Total: 16.7 minutes
2025-03-12 18:50:41,110 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0001 secs
2025-03-12 18:50:41,110 [INFO]: 	Checking that your have enough memory available to create the index 03/12/2025, 18:50:41
2025-03-12 18:50:41,110 [INFO]: 378.7MB of memory will be needed to build the index (more might be used if you have more)
2025-03-12 18:50:41,110 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0001 secs
2025-03-12 18:50:41,110 [INFO]: 	Selecting most promising index types given data characteristics 03/12/2025, 18:50:41
2025-03-12 18:50:41,110 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-12 18:50:41,110 [INFO]: 	Creating the index 03/12/2025, 18:50:41
2025-03-12 18:50:41,111 [INFO]: 		-> Instanciate the index HNSW15 03/12/2025, 18:50:41
2025-03-12 18:50:41,111 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0008 secs
2025-03-12 18:50:41,112 [INFO]: 		-> Adding the vectors to the index 03/12/2025, 18:50:41
2025-03-12 18:50:41,112 [INFO]: The memory available for adding the vectors is 49.7GB(total available - used by the index)
2025-03-12 18:50:41,112 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/8 [00:00<?, ?it/s] 38%|███▊      | 3/8 [00:00<00:00, 27.22it/s]100%|██████████| 8/8 [00:01<00:00,  6.13it/s]100%|██████████| 8/8 [00:01<00:00,  6.71it/s]
2025-03-12 18:50:42,307 [INFO]: 	Computing best hyperparameters for index knn.index 03/12/2025, 18:50:42
2025-03-12 18:51:02,233 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 19.9258 secs
2025-03-12 18:51:02,233 [INFO]: The best hyperparameters are: efSearch=340
2025-03-12 18:51:02,233 [INFO]: 	Compute fast metrics 03/12/2025, 18:51:02
  0%|          | 0/4 [00:00<?, ?it/s] 75%|███████▌  | 3/4 [00:00<00:00, 27.36it/s] 75%|███████▌  | 3/4 [00:00<00:00, 23.82it/s]
2025-03-12 18:51:13,276 [INFO]: 	>>> Finished "Compute fast metrics" in 11.0432 secs
2025-03-12 18:51:13,277 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 32.1659 secs
2025-03-12 18:51:13,278 [INFO]: {
2025-03-12 18:51:13,278 [INFO]: 	index_key: HNSW15
2025-03-12 18:51:13,278 [INFO]: 	index_param: efSearch=340
2025-03-12 18:51:13,278 [INFO]: 	index_path: knn.index
2025-03-12 18:51:13,278 [INFO]: 	size in bytes: 361025110
2025-03-12 18:51:13,278 [INFO]: 	avg_search_speed_ms: 9.437319941660565
2025-03-12 18:51:13,278 [INFO]: 	99p_search_speed_ms: 12.726166471838955
2025-03-12 18:51:13,278 [INFO]: 	reconstruction error %: 0.0
2025-03-12 18:51:13,278 [INFO]: 	nb vectors: 1835
2025-03-12 18:51:13,278 [INFO]: 	vectors dimension: 49152
2025-03-12 18:51:13,278 [INFO]: 	compression ratio: 0.9993091062280959
2025-03-12 18:51:13,278 [INFO]: }
2025-03-12 18:51:13,278 [INFO]: 	>>> Finished "Creating the index" in 32.1673 secs
2025-03-12 18:51:13,278 [INFO]: >>> Finished "Launching the whole pipeline" in 32.1949 secs
2025-03-12 18:51:14: [retrieval_preprocessing] calculating distances ...
2025-03-12 18:51:14: [retrieval_preprocessing] finished and saved retrieval indices for episode 99 [episode count 13/20]
[retrieval_preprocessing] for episode 100 [episode count 14/20], we have num_retrieval=np.int64(1836) num_query=np.int64(116)
2025-03-12 18:51:14,787 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-12 18:51:14,990 [INFO]: Launching the whole pipeline 03/12/2025, 18:51:14
2025-03-12 18:51:14,991 [INFO]: Reading total number of vectors and dimension 03/12/2025, 18:51:14
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1972.86it/s]
2025-03-12 18:51:15,016 [INFO]: There are 1836 embeddings of dim 49152
2025-03-12 18:51:15,016 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0253 secs
2025-03-12 18:51:15,016 [INFO]: 	Compute estimated construction time of the index 03/12/2025, 18:51:15
2025-03-12 18:51:15,016 [INFO]: 		-> Train: 16.7 minutes
2025-03-12 18:51:15,016 [INFO]: 		-> Add: 1.0 seconds
2025-03-12 18:51:15,016 [INFO]: 		Total: 16.7 minutes
2025-03-12 18:51:15,016 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0001 secs
2025-03-12 18:51:15,016 [INFO]: 	Checking that your have enough memory available to create the index 03/12/2025, 18:51:15
2025-03-12 18:51:15,016 [INFO]: 378.9MB of memory will be needed to build the index (more might be used if you have more)
2025-03-12 18:51:15,016 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0001 secs
2025-03-12 18:51:15,016 [INFO]: 	Selecting most promising index types given data characteristics 03/12/2025, 18:51:15
2025-03-12 18:51:15,016 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-12 18:51:15,016 [INFO]: 	Creating the index 03/12/2025, 18:51:15
2025-03-12 18:51:15,016 [INFO]: 		-> Instanciate the index HNSW15 03/12/2025, 18:51:15
2025-03-12 18:51:15,017 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0009 secs
2025-03-12 18:51:15,017 [INFO]: 		-> Adding the vectors to the index 03/12/2025, 18:51:15
2025-03-12 18:51:15,017 [INFO]: The memory available for adding the vectors is 49.7GB(total available - used by the index)
2025-03-12 18:51:15,017 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/8 [00:00<?, ?it/s] 38%|███▊      | 3/8 [00:00<00:00, 29.80it/s]100%|██████████| 8/8 [00:01<00:00,  5.97it/s]100%|██████████| 8/8 [00:01<00:00,  6.56it/s]
2025-03-12 18:51:16,240 [INFO]: 	Computing best hyperparameters for index knn.index 03/12/2025, 18:51:16
2025-03-12 18:51:35,836 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 19.5955 secs
2025-03-12 18:51:35,836 [INFO]: The best hyperparameters are: efSearch=373
2025-03-12 18:51:35,836 [INFO]: 	Compute fast metrics 03/12/2025, 18:51:35
  0%|          | 0/4 [00:00<?, ?it/s] 75%|███████▌  | 3/4 [00:00<00:00, 26.54it/s]
2025-03-12 18:51:46,908 [INFO]: 	>>> Finished "Compute fast metrics" in 11.0720 secs
2025-03-12 18:51:46,909 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 31.8920 secs
2025-03-12 18:51:46,909 [INFO]: {
2025-03-12 18:51:46,909 [INFO]: 	index_key: HNSW15
2025-03-12 18:51:46,910 [INFO]: 	index_param: efSearch=373
2025-03-12 18:51:46,910 [INFO]: 	index_path: knn.index
2025-03-12 18:51:46,910 [INFO]: 	size in bytes: 361221850
2025-03-12 18:51:46,910 [INFO]: 	avg_search_speed_ms: 9.505017804860106
2025-03-12 18:51:46,910 [INFO]: 	99p_search_speed_ms: 11.81112663820386
2025-03-12 18:51:46,910 [INFO]: 	reconstruction error %: 0.0
2025-03-12 18:51:46,910 [INFO]: 	nb vectors: 1836
2025-03-12 18:51:46,910 [INFO]: 	vectors dimension: 49152
2025-03-12 18:51:46,910 [INFO]: 	compression ratio: 0.9993091170979829
2025-03-12 18:51:46,910 [INFO]: }
2025-03-12 18:51:46,910 [INFO]: 	>>> Finished "Creating the index" in 31.8933 secs
2025-03-12 18:51:46,910 [INFO]: >>> Finished "Launching the whole pipeline" in 31.9191 secs
2025-03-12 18:51:48: [retrieval_preprocessing] calculating distances ...
2025-03-12 18:51:48: [retrieval_preprocessing] finished and saved retrieval indices for episode 100 [episode count 14/20]
[retrieval_preprocessing] for episode 101 [episode count 15/20], we have num_retrieval=np.int64(1849) num_query=np.int64(103)
2025-03-12 18:51:48,445 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-12 18:51:48,654 [INFO]: Launching the whole pipeline 03/12/2025, 18:51:48
2025-03-12 18:51:48,654 [INFO]: Reading total number of vectors and dimension 03/12/2025, 18:51:48
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 2068.20it/s]
2025-03-12 18:51:48,680 [INFO]: There are 1849 embeddings of dim 49152
2025-03-12 18:51:48,680 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0262 secs
2025-03-12 18:51:48,680 [INFO]: 	Compute estimated construction time of the index 03/12/2025, 18:51:48
2025-03-12 18:51:48,680 [INFO]: 		-> Train: 16.7 minutes
2025-03-12 18:51:48,680 [INFO]: 		-> Add: 1.0 seconds
2025-03-12 18:51:48,680 [INFO]: 		Total: 16.7 minutes
2025-03-12 18:51:48,680 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0001 secs
2025-03-12 18:51:48,680 [INFO]: 	Checking that your have enough memory available to create the index 03/12/2025, 18:51:48
2025-03-12 18:51:48,681 [INFO]: 381.6MB of memory will be needed to build the index (more might be used if you have more)
2025-03-12 18:51:48,681 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0001 secs
2025-03-12 18:51:48,681 [INFO]: 	Selecting most promising index types given data characteristics 03/12/2025, 18:51:48
2025-03-12 18:51:48,681 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-12 18:51:48,681 [INFO]: 	Creating the index 03/12/2025, 18:51:48
2025-03-12 18:51:48,681 [INFO]: 		-> Instanciate the index HNSW15 03/12/2025, 18:51:48
2025-03-12 18:51:48,682 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0009 secs
2025-03-12 18:51:48,682 [INFO]: 		-> Adding the vectors to the index 03/12/2025, 18:51:48
2025-03-12 18:51:48,682 [INFO]: The memory available for adding the vectors is 49.7GB(total available - used by the index)
2025-03-12 18:51:48,682 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/8 [00:00<?, ?it/s] 25%|██▌       | 2/8 [00:00<00:00, 19.17it/s]100%|██████████| 8/8 [00:01<00:00,  6.20it/s]100%|██████████| 8/8 [00:01<00:00,  6.52it/s]
2025-03-12 18:51:49,912 [INFO]: 	Computing best hyperparameters for index knn.index 03/12/2025, 18:51:49
2025-03-12 18:52:09,914 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 20.0017 secs
2025-03-12 18:52:09,915 [INFO]: The best hyperparameters are: efSearch=361
2025-03-12 18:52:09,915 [INFO]: 	Compute fast metrics 03/12/2025, 18:52:09
  0%|          | 0/4 [00:00<?, ?it/s] 75%|███████▌  | 3/4 [00:00<00:00, 28.92it/s] 75%|███████▌  | 3/4 [00:00<00:00, 25.61it/s]
2025-03-12 18:52:20,996 [INFO]: 	>>> Finished "Compute fast metrics" in 11.0813 secs
2025-03-12 18:52:20,997 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 32.3153 secs
2025-03-12 18:52:20,997 [INFO]: {
2025-03-12 18:52:20,997 [INFO]: 	index_key: HNSW15
2025-03-12 18:52:20,997 [INFO]: 	index_param: efSearch=361
2025-03-12 18:52:20,997 [INFO]: 	index_path: knn.index
2025-03-12 18:52:20,997 [INFO]: 	size in bytes: 363779470
2025-03-12 18:52:20,997 [INFO]: 	avg_search_speed_ms: 9.445087938253769
2025-03-12 18:52:20,997 [INFO]: 	99p_search_speed_ms: 11.854939274489885
2025-03-12 18:52:20,997 [INFO]: 	reconstruction error %: 0.0
2025-03-12 18:52:20,997 [INFO]: 	nb vectors: 1849
2025-03-12 18:52:20,997 [INFO]: 	vectors dimension: 49152
2025-03-12 18:52:20,997 [INFO]: 	compression ratio: 0.9993092573365946
2025-03-12 18:52:20,997 [INFO]: }
2025-03-12 18:52:20,997 [INFO]: 	>>> Finished "Creating the index" in 32.3166 secs
2025-03-12 18:52:20,997 [INFO]: >>> Finished "Launching the whole pipeline" in 32.3434 secs
2025-03-12 18:52:21: [retrieval_preprocessing] calculating distances ...
2025-03-12 18:52:22: [retrieval_preprocessing] finished and saved retrieval indices for episode 101 [episode count 15/20]
[retrieval_preprocessing] for episode 102 [episode count 16/20], we have num_retrieval=np.int64(1800) num_query=np.int64(152)
2025-03-12 18:52:22,353 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-12 18:52:22,560 [INFO]: Launching the whole pipeline 03/12/2025, 18:52:22
2025-03-12 18:52:22,560 [INFO]: Reading total number of vectors and dimension 03/12/2025, 18:52:22
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 2052.01it/s]
2025-03-12 18:52:22,585 [INFO]: There are 1800 embeddings of dim 49152
2025-03-12 18:52:22,585 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0249 secs
2025-03-12 18:52:22,585 [INFO]: 	Compute estimated construction time of the index 03/12/2025, 18:52:22
2025-03-12 18:52:22,585 [INFO]: 		-> Train: 16.7 minutes
2025-03-12 18:52:22,585 [INFO]: 		-> Add: 1.0 seconds
2025-03-12 18:52:22,585 [INFO]: 		Total: 16.7 minutes
2025-03-12 18:52:22,585 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0001 secs
2025-03-12 18:52:22,585 [INFO]: 	Checking that your have enough memory available to create the index 03/12/2025, 18:52:22
2025-03-12 18:52:22,585 [INFO]: 371.5MB of memory will be needed to build the index (more might be used if you have more)
2025-03-12 18:52:22,585 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0001 secs
2025-03-12 18:52:22,585 [INFO]: 	Selecting most promising index types given data characteristics 03/12/2025, 18:52:22
2025-03-12 18:52:22,585 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-12 18:52:22,585 [INFO]: 	Creating the index 03/12/2025, 18:52:22
2025-03-12 18:52:22,585 [INFO]: 		-> Instanciate the index HNSW15 03/12/2025, 18:52:22
2025-03-12 18:52:22,586 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0009 secs
2025-03-12 18:52:22,586 [INFO]: 		-> Adding the vectors to the index 03/12/2025, 18:52:22
2025-03-12 18:52:22,586 [INFO]: The memory available for adding the vectors is 49.7GB(total available - used by the index)
2025-03-12 18:52:22,586 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/8 [00:00<?, ?it/s] 25%|██▌       | 2/8 [00:00<00:00, 19.67it/s]100%|██████████| 8/8 [00:01<00:00,  6.45it/s]100%|██████████| 8/8 [00:01<00:00,  6.78it/s]
2025-03-12 18:52:23,769 [INFO]: 	Computing best hyperparameters for index knn.index 03/12/2025, 18:52:23
2025-03-12 18:52:43,643 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 19.8735 secs
2025-03-12 18:52:43,643 [INFO]: The best hyperparameters are: efSearch=360
2025-03-12 18:52:43,643 [INFO]: 	Compute fast metrics 03/12/2025, 18:52:43
  0%|          | 0/4 [00:00<?, ?it/s] 75%|███████▌  | 3/4 [00:00<00:00, 28.99it/s] 75%|███████▌  | 3/4 [00:00<00:00, 25.22it/s]
2025-03-12 18:52:54,726 [INFO]: 	>>> Finished "Compute fast metrics" in 11.0823 secs
2025-03-12 18:52:54,727 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 32.1405 secs
2025-03-12 18:52:54,727 [INFO]: {
2025-03-12 18:52:54,727 [INFO]: 	index_key: HNSW15
2025-03-12 18:52:54,727 [INFO]: 	index_param: efSearch=360
2025-03-12 18:52:54,727 [INFO]: 	index_path: knn.index
2025-03-12 18:52:54,727 [INFO]: 	size in bytes: 354139210
2025-03-12 18:52:54,727 [INFO]: 	avg_search_speed_ms: 9.64740694481646
2025-03-12 18:52:54,727 [INFO]: 	99p_search_speed_ms: 13.013867801055314
2025-03-12 18:52:54,727 [INFO]: 	reconstruction error %: 0.0
2025-03-12 18:52:54,727 [INFO]: 	nb vectors: 1800
2025-03-12 18:52:54,727 [INFO]: 	vectors dimension: 49152
2025-03-12 18:52:54,727 [INFO]: 	compression ratio: 0.9993087181732856
2025-03-12 18:52:54,727 [INFO]: }
2025-03-12 18:52:54,727 [INFO]: 	>>> Finished "Creating the index" in 32.1418 secs
2025-03-12 18:52:54,727 [INFO]: >>> Finished "Launching the whole pipeline" in 32.1672 secs
2025-03-12 18:52:56: [retrieval_preprocessing] calculating distances ...
2025-03-12 18:52:56: [retrieval_preprocessing] finished and saved retrieval indices for episode 102 [episode count 16/20]
[retrieval_preprocessing] for episode 103 [episode count 17/20], we have num_retrieval=np.int64(1849) num_query=np.int64(103)
2025-03-12 18:52:56,620 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-12 18:52:56,829 [INFO]: Launching the whole pipeline 03/12/2025, 18:52:56
2025-03-12 18:52:56,829 [INFO]: Reading total number of vectors and dimension 03/12/2025, 18:52:56
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1706.39it/s]
2025-03-12 18:52:56,857 [INFO]: There are 1849 embeddings of dim 49152
2025-03-12 18:52:56,858 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0288 secs
2025-03-12 18:52:56,858 [INFO]: 	Compute estimated construction time of the index 03/12/2025, 18:52:56
2025-03-12 18:52:56,858 [INFO]: 		-> Train: 16.7 minutes
2025-03-12 18:52:56,858 [INFO]: 		-> Add: 1.0 seconds
2025-03-12 18:52:56,858 [INFO]: 		Total: 16.7 minutes
2025-03-12 18:52:56,858 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0001 secs
2025-03-12 18:52:56,858 [INFO]: 	Checking that your have enough memory available to create the index 03/12/2025, 18:52:56
2025-03-12 18:52:56,858 [INFO]: 381.6MB of memory will be needed to build the index (more might be used if you have more)
2025-03-12 18:52:56,858 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0001 secs
2025-03-12 18:52:56,858 [INFO]: 	Selecting most promising index types given data characteristics 03/12/2025, 18:52:56
2025-03-12 18:52:56,858 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-12 18:52:56,858 [INFO]: 	Creating the index 03/12/2025, 18:52:56
2025-03-12 18:52:56,858 [INFO]: 		-> Instanciate the index HNSW15 03/12/2025, 18:52:56
2025-03-12 18:52:56,859 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0008 secs
2025-03-12 18:52:56,859 [INFO]: 		-> Adding the vectors to the index 03/12/2025, 18:52:56
2025-03-12 18:52:56,859 [INFO]: The memory available for adding the vectors is 49.7GB(total available - used by the index)
2025-03-12 18:52:56,859 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/8 [00:00<?, ?it/s] 25%|██▌       | 2/8 [00:00<00:00, 19.03it/s]100%|██████████| 8/8 [00:01<00:00,  6.23it/s]100%|██████████| 8/8 [00:01<00:00,  6.55it/s]
2025-03-12 18:52:58,083 [INFO]: 	Computing best hyperparameters for index knn.index 03/12/2025, 18:52:58
2025-03-12 18:53:17,058 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 18.9751 secs
2025-03-12 18:53:17,058 [INFO]: The best hyperparameters are: efSearch=365
2025-03-12 18:53:17,059 [INFO]: 	Compute fast metrics 03/12/2025, 18:53:17
  0%|          | 0/4 [00:00<?, ?it/s] 75%|███████▌  | 3/4 [00:00<00:00, 26.68it/s]
2025-03-12 18:53:28,146 [INFO]: 	>>> Finished "Compute fast metrics" in 11.0870 secs
2025-03-12 18:53:28,147 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 31.2875 secs
2025-03-12 18:53:28,147 [INFO]: {
2025-03-12 18:53:28,147 [INFO]: 	index_key: HNSW15
2025-03-12 18:53:28,147 [INFO]: 	index_param: efSearch=365
2025-03-12 18:53:28,147 [INFO]: 	index_path: knn.index
2025-03-12 18:53:28,147 [INFO]: 	size in bytes: 363779470
2025-03-12 18:53:28,147 [INFO]: 	avg_search_speed_ms: 9.631914848997774
2025-03-12 18:53:28,147 [INFO]: 	99p_search_speed_ms: 12.169149862602346
2025-03-12 18:53:28,147 [INFO]: 	reconstruction error %: 0.0
2025-03-12 18:53:28,147 [INFO]: 	nb vectors: 1849
2025-03-12 18:53:28,147 [INFO]: 	vectors dimension: 49152
2025-03-12 18:53:28,147 [INFO]: 	compression ratio: 0.9993092573365946
2025-03-12 18:53:28,147 [INFO]: }
2025-03-12 18:53:28,147 [INFO]: 	>>> Finished "Creating the index" in 31.2888 secs
2025-03-12 18:53:28,147 [INFO]: >>> Finished "Launching the whole pipeline" in 31.3181 secs
2025-03-12 18:53:29: [retrieval_preprocessing] calculating distances ...
2025-03-12 18:53:29: [retrieval_preprocessing] finished and saved retrieval indices for episode 103 [episode count 17/20]
[retrieval_preprocessing] for episode 104 [episode count 18/20], we have num_retrieval=np.int64(1865) num_query=np.int64(87)
2025-03-12 18:53:29,542 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-12 18:53:29,755 [INFO]: Launching the whole pipeline 03/12/2025, 18:53:29
2025-03-12 18:53:29,756 [INFO]: Reading total number of vectors and dimension 03/12/2025, 18:53:29
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 2018.43it/s]
2025-03-12 18:53:29,784 [INFO]: There are 1865 embeddings of dim 49152
2025-03-12 18:53:29,784 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0287 secs
2025-03-12 18:53:29,784 [INFO]: 	Compute estimated construction time of the index 03/12/2025, 18:53:29
2025-03-12 18:53:29,784 [INFO]: 		-> Train: 16.7 minutes
2025-03-12 18:53:29,784 [INFO]: 		-> Add: 1.0 seconds
2025-03-12 18:53:29,784 [INFO]: 		Total: 16.7 minutes
2025-03-12 18:53:29,784 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0001 secs
2025-03-12 18:53:29,784 [INFO]: 	Checking that your have enough memory available to create the index 03/12/2025, 18:53:29
2025-03-12 18:53:29,785 [INFO]: 384.9MB of memory will be needed to build the index (more might be used if you have more)
2025-03-12 18:53:29,785 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0001 secs
2025-03-12 18:53:29,785 [INFO]: 	Selecting most promising index types given data characteristics 03/12/2025, 18:53:29
2025-03-12 18:53:29,785 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-12 18:53:29,785 [INFO]: 	Creating the index 03/12/2025, 18:53:29
2025-03-12 18:53:29,785 [INFO]: 		-> Instanciate the index HNSW15 03/12/2025, 18:53:29
2025-03-12 18:53:29,786 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0009 secs
2025-03-12 18:53:29,786 [INFO]: 		-> Adding the vectors to the index 03/12/2025, 18:53:29
2025-03-12 18:53:29,786 [INFO]: The memory available for adding the vectors is 49.7GB(total available - used by the index)
2025-03-12 18:53:29,786 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/8 [00:00<?, ?it/s] 38%|███▊      | 3/8 [00:00<00:00, 26.59it/s]100%|██████████| 8/8 [00:01<00:00,  5.95it/s]100%|██████████| 8/8 [00:01<00:00,  6.51it/s]
2025-03-12 18:53:31,017 [INFO]: 	Computing best hyperparameters for index knn.index 03/12/2025, 18:53:31
2025-03-12 18:53:51,080 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 20.0626 secs
2025-03-12 18:53:51,080 [INFO]: The best hyperparameters are: efSearch=362
2025-03-12 18:53:51,080 [INFO]: 	Compute fast metrics 03/12/2025, 18:53:51
  0%|          | 0/4 [00:00<?, ?it/s] 75%|███████▌  | 3/4 [00:00<00:00, 29.03it/s] 75%|███████▌  | 3/4 [00:00<00:00, 25.79it/s]
2025-03-12 18:54:02,146 [INFO]: 	>>> Finished "Compute fast metrics" in 11.0661 secs
2025-03-12 18:54:02,148 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 32.3618 secs
2025-03-12 18:54:02,148 [INFO]: {
2025-03-12 18:54:02,148 [INFO]: 	index_key: HNSW15
2025-03-12 18:54:02,148 [INFO]: 	index_param: efSearch=362
2025-03-12 18:54:02,148 [INFO]: 	index_path: knn.index
2025-03-12 18:54:02,148 [INFO]: 	size in bytes: 366927490
2025-03-12 18:54:02,148 [INFO]: 	avg_search_speed_ms: 9.448409534953852
2025-03-12 18:54:02,148 [INFO]: 	99p_search_speed_ms: 12.01688988134265
2025-03-12 18:54:02,148 [INFO]: 	reconstruction error %: 0.0
2025-03-12 18:54:02,148 [INFO]: 	nb vectors: 1865
2025-03-12 18:54:02,148 [INFO]: 	vectors dimension: 49152
2025-03-12 18:54:02,148 [INFO]: 	compression ratio: 0.9993089370327636
2025-03-12 18:54:02,148 [INFO]: }
2025-03-12 18:54:02,148 [INFO]: 	>>> Finished "Creating the index" in 32.3634 secs
2025-03-12 18:54:02,148 [INFO]: >>> Finished "Launching the whole pipeline" in 32.3926 secs
2025-03-12 18:54:03: [retrieval_preprocessing] calculating distances ...
2025-03-12 18:54:03: [retrieval_preprocessing] finished and saved retrieval indices for episode 104 [episode count 18/20]
[retrieval_preprocessing] for episode 105 [episode count 19/20], we have num_retrieval=np.int64(1867) num_query=np.int64(85)
2025-03-12 18:54:03,360 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-12 18:54:03,572 [INFO]: Launching the whole pipeline 03/12/2025, 18:54:03
2025-03-12 18:54:03,572 [INFO]: Reading total number of vectors and dimension 03/12/2025, 18:54:03
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 2048.00it/s]
2025-03-12 18:54:03,599 [INFO]: There are 1867 embeddings of dim 49152
2025-03-12 18:54:03,599 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0269 secs
2025-03-12 18:54:03,599 [INFO]: 	Compute estimated construction time of the index 03/12/2025, 18:54:03
2025-03-12 18:54:03,599 [INFO]: 		-> Train: 16.7 minutes
2025-03-12 18:54:03,599 [INFO]: 		-> Add: 1.0 seconds
2025-03-12 18:54:03,599 [INFO]: 		Total: 16.7 minutes
2025-03-12 18:54:03,599 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0001 secs
2025-03-12 18:54:03,599 [INFO]: 	Checking that your have enough memory available to create the index 03/12/2025, 18:54:03
2025-03-12 18:54:03,599 [INFO]: 385.3MB of memory will be needed to build the index (more might be used if you have more)
2025-03-12 18:54:03,599 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0001 secs
2025-03-12 18:54:03,599 [INFO]: 	Selecting most promising index types given data characteristics 03/12/2025, 18:54:03
2025-03-12 18:54:03,599 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-12 18:54:03,599 [INFO]: 	Creating the index 03/12/2025, 18:54:03
2025-03-12 18:54:03,599 [INFO]: 		-> Instanciate the index HNSW15 03/12/2025, 18:54:03
2025-03-12 18:54:03,600 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0009 secs
2025-03-12 18:54:03,600 [INFO]: 		-> Adding the vectors to the index 03/12/2025, 18:54:03
2025-03-12 18:54:03,600 [INFO]: The memory available for adding the vectors is 49.7GB(total available - used by the index)
2025-03-12 18:54:03,601 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/8 [00:00<?, ?it/s] 38%|███▊      | 3/8 [00:00<00:00, 27.47it/s]100%|██████████| 8/8 [00:01<00:00,  5.92it/s]100%|██████████| 8/8 [00:01<00:00,  6.48it/s]
2025-03-12 18:54:04,838 [INFO]: 	Computing best hyperparameters for index knn.index 03/12/2025, 18:54:04
2025-03-12 18:54:25,167 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 20.3294 secs
2025-03-12 18:54:25,167 [INFO]: The best hyperparameters are: efSearch=353
2025-03-12 18:54:25,167 [INFO]: 	Compute fast metrics 03/12/2025, 18:54:25
  0%|          | 0/4 [00:00<?, ?it/s] 75%|███████▌  | 3/4 [00:00<00:00, 28.05it/s] 75%|███████▌  | 3/4 [00:00<00:00, 24.91it/s]
2025-03-12 18:54:36,246 [INFO]: 	>>> Finished "Compute fast metrics" in 11.0784 secs
2025-03-12 18:54:36,247 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 32.6464 secs
2025-03-12 18:54:36,247 [INFO]: {
2025-03-12 18:54:36,247 [INFO]: 	index_key: HNSW15
2025-03-12 18:54:36,247 [INFO]: 	index_param: efSearch=353
2025-03-12 18:54:36,247 [INFO]: 	index_path: knn.index
2025-03-12 18:54:36,247 [INFO]: 	size in bytes: 367320970
2025-03-12 18:54:36,247 [INFO]: 	avg_search_speed_ms: 9.503369079416322
2025-03-12 18:54:36,247 [INFO]: 	99p_search_speed_ms: 11.938042500987649
2025-03-12 18:54:36,247 [INFO]: 	reconstruction error %: 0.0
2025-03-12 18:54:36,247 [INFO]: 	nb vectors: 1867
2025-03-12 18:54:36,247 [INFO]: 	vectors dimension: 49152
2025-03-12 18:54:36,247 [INFO]: 	compression ratio: 0.9993089585928078
2025-03-12 18:54:36,247 [INFO]: }
2025-03-12 18:54:36,247 [INFO]: 	>>> Finished "Creating the index" in 32.6477 secs
2025-03-12 18:54:36,247 [INFO]: >>> Finished "Launching the whole pipeline" in 32.6750 secs
2025-03-12 18:54:37: [retrieval_preprocessing] calculating distances ...
2025-03-12 18:54:37: [retrieval_preprocessing] finished and saved retrieval indices for episode 105 [episode count 19/20]
2025-03-12 18:54:37: [retrieval_preprocessing] finished for collected_demos_training/2025-03-10_move_the_strawberry_forwards [chosen_id count 5/8]
2025-03-12 18:54:37: [retrieval_preprocessing] concatenated all embeddings and indices for 20 episodes for collected_demos_training/2025-03-10_move_watermelon_to_the_right [chosen_id count 6/8]
2025-03-12 18:54:37: [retrieval_preprocessing] we have num_total=1571 embedding_dim=49152
[retrieval_preprocessing] for episode 106 [episode count 0/20], we have num_retrieval=np.int64(1462) num_query=np.int64(109)
2025-03-12 18:54:37,633 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-12 18:54:37,804 [INFO]: Launching the whole pipeline 03/12/2025, 18:54:37
2025-03-12 18:54:37,804 [INFO]: Reading total number of vectors and dimension 03/12/2025, 18:54:37
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1832.37it/s]
2025-03-12 18:54:37,832 [INFO]: There are 1462 embeddings of dim 49152
2025-03-12 18:54:37,832 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0282 secs
2025-03-12 18:54:37,832 [INFO]: 	Compute estimated construction time of the index 03/12/2025, 18:54:37
2025-03-12 18:54:37,832 [INFO]: 		-> Train: 16.7 minutes
2025-03-12 18:54:37,832 [INFO]: 		-> Add: 0.8 seconds
2025-03-12 18:54:37,832 [INFO]: 		Total: 16.7 minutes
2025-03-12 18:54:37,832 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0001 secs
2025-03-12 18:54:37,832 [INFO]: 	Checking that your have enough memory available to create the index 03/12/2025, 18:54:37
2025-03-12 18:54:37,833 [INFO]: 301.7MB of memory will be needed to build the index (more might be used if you have more)
2025-03-12 18:54:37,833 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0001 secs
2025-03-12 18:54:37,833 [INFO]: 	Selecting most promising index types given data characteristics 03/12/2025, 18:54:37
2025-03-12 18:54:37,833 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-12 18:54:37,833 [INFO]: 	Creating the index 03/12/2025, 18:54:37
2025-03-12 18:54:37,833 [INFO]: 		-> Instanciate the index HNSW15 03/12/2025, 18:54:37
2025-03-12 18:54:37,834 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0009 secs
2025-03-12 18:54:37,834 [INFO]: 		-> Adding the vectors to the index 03/12/2025, 18:54:37
2025-03-12 18:54:37,834 [INFO]: The memory available for adding the vectors is 49.7GB(total available - used by the index)
2025-03-12 18:54:37,834 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/6 [00:00<?, ?it/s] 17%|█▋        | 1/6 [00:00<00:00,  9.45it/s]100%|██████████| 6/6 [00:01<00:00,  5.10it/s]100%|██████████| 6/6 [00:01<00:00,  5.21it/s]
2025-03-12 18:54:38,989 [INFO]: 	Computing best hyperparameters for index knn.index 03/12/2025, 18:54:38
2025-03-12 18:54:57,242 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 18.2533 secs
2025-03-12 18:54:57,242 [INFO]: The best hyperparameters are: efSearch=388
2025-03-12 18:54:57,242 [INFO]: 	Compute fast metrics 03/12/2025, 18:54:57
  0%|          | 0/4 [00:00<?, ?it/s] 75%|███████▌  | 3/4 [00:00<00:00, 26.79it/s]
2025-03-12 18:55:08,168 [INFO]: 	>>> Finished "Compute fast metrics" in 10.9260 secs
2025-03-12 18:55:08,169 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 30.3355 secs
2025-03-12 18:55:08,169 [INFO]: {
2025-03-12 18:55:08,169 [INFO]: 	index_key: HNSW15
2025-03-12 18:55:08,170 [INFO]: 	index_param: efSearch=388
2025-03-12 18:55:08,170 [INFO]: 	index_path: knn.index
2025-03-12 18:55:08,170 [INFO]: 	size in bytes: 287639710
2025-03-12 18:55:08,170 [INFO]: 	avg_search_speed_ms: 10.198925378771307
2025-03-12 18:55:08,170 [INFO]: 	99p_search_speed_ms: 12.418599100783469
2025-03-12 18:55:08,170 [INFO]: 	reconstruction error %: 0.0
2025-03-12 18:55:08,170 [INFO]: 	nb vectors: 1462
2025-03-12 18:55:08,170 [INFO]: 	vectors dimension: 49152
2025-03-12 18:55:08,170 [INFO]: 	compression ratio: 0.9993088089262779
2025-03-12 18:55:08,170 [INFO]: }
2025-03-12 18:55:08,170 [INFO]: 	>>> Finished "Creating the index" in 30.3369 secs
2025-03-12 18:55:08,170 [INFO]: >>> Finished "Launching the whole pipeline" in 30.3656 secs
2025-03-12 18:55:08: [retrieval_preprocessing] calculating distances ...
2025-03-12 18:55:09: [retrieval_preprocessing] finished and saved retrieval indices for episode 106 [episode count 0/20]
[retrieval_preprocessing] for episode 107 [episode count 1/20], we have num_retrieval=np.int64(1480) num_query=np.int64(91)
2025-03-12 18:55:09,251 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-12 18:55:09,421 [INFO]: Launching the whole pipeline 03/12/2025, 18:55:09
2025-03-12 18:55:09,421 [INFO]: Reading total number of vectors and dimension 03/12/2025, 18:55:09
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1999.19it/s]
2025-03-12 18:55:09,446 [INFO]: There are 1480 embeddings of dim 49152
2025-03-12 18:55:09,446 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0252 secs
2025-03-12 18:55:09,446 [INFO]: 	Compute estimated construction time of the index 03/12/2025, 18:55:09
2025-03-12 18:55:09,446 [INFO]: 		-> Train: 16.7 minutes
2025-03-12 18:55:09,446 [INFO]: 		-> Add: 0.8 seconds
2025-03-12 18:55:09,446 [INFO]: 		Total: 16.7 minutes
2025-03-12 18:55:09,446 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0001 secs
2025-03-12 18:55:09,446 [INFO]: 	Checking that your have enough memory available to create the index 03/12/2025, 18:55:09
2025-03-12 18:55:09,446 [INFO]: 305.4MB of memory will be needed to build the index (more might be used if you have more)
2025-03-12 18:55:09,446 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0001 secs
2025-03-12 18:55:09,446 [INFO]: 	Selecting most promising index types given data characteristics 03/12/2025, 18:55:09
2025-03-12 18:55:09,446 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-12 18:55:09,446 [INFO]: 	Creating the index 03/12/2025, 18:55:09
2025-03-12 18:55:09,446 [INFO]: 		-> Instanciate the index HNSW15 03/12/2025, 18:55:09
2025-03-12 18:55:09,447 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0009 secs
2025-03-12 18:55:09,448 [INFO]: 		-> Adding the vectors to the index 03/12/2025, 18:55:09
2025-03-12 18:55:09,448 [INFO]: The memory available for adding the vectors is 49.7GB(total available - used by the index)
2025-03-12 18:55:09,448 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/6 [00:00<?, ?it/s] 67%|██████▋   | 4/6 [00:00<00:00, 35.90it/s]100%|██████████| 6/6 [00:01<00:00,  5.64it/s]
2025-03-12 18:55:10,515 [INFO]: 	Computing best hyperparameters for index knn.index 03/12/2025, 18:55:10
2025-03-12 18:55:30,504 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 19.9881 secs
2025-03-12 18:55:30,504 [INFO]: The best hyperparameters are: efSearch=357
2025-03-12 18:55:30,504 [INFO]: 	Compute fast metrics 03/12/2025, 18:55:30
  0%|          | 0/4 [00:00<?, ?it/s] 75%|███████▌  | 3/4 [00:00<00:00, 29.52it/s] 75%|███████▌  | 3/4 [00:00<00:00, 25.96it/s]
2025-03-12 18:55:41,457 [INFO]: 	>>> Finished "Compute fast metrics" in 10.9536 secs
2025-03-12 18:55:41,458 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 32.0107 secs
2025-03-12 18:55:41,459 [INFO]: {
2025-03-12 18:55:41,459 [INFO]: 	index_key: HNSW15
2025-03-12 18:55:41,459 [INFO]: 	index_param: efSearch=357
2025-03-12 18:55:41,459 [INFO]: 	index_path: knn.index
2025-03-12 18:55:41,459 [INFO]: 	size in bytes: 291181150
2025-03-12 18:55:41,459 [INFO]: 	avg_search_speed_ms: 9.727601893019685
2025-03-12 18:55:41,459 [INFO]: 	99p_search_speed_ms: 11.9917827937752
2025-03-12 18:55:41,459 [INFO]: 	reconstruction error %: 0.0
2025-03-12 18:55:41,459 [INFO]: 	nb vectors: 1480
2025-03-12 18:55:41,459 [INFO]: 	vectors dimension: 49152
2025-03-12 18:55:41,459 [INFO]: 	compression ratio: 0.9993086434338212
2025-03-12 18:55:41,459 [INFO]: }
2025-03-12 18:55:41,459 [INFO]: 	>>> Finished "Creating the index" in 32.0124 secs
2025-03-12 18:55:41,459 [INFO]: >>> Finished "Launching the whole pipeline" in 32.0381 secs
2025-03-12 18:55:41: [retrieval_preprocessing] calculating distances ...
2025-03-12 18:55:42: [retrieval_preprocessing] finished and saved retrieval indices for episode 107 [episode count 1/20]
[retrieval_preprocessing] for episode 108 [episode count 2/20], we have num_retrieval=np.int64(1491) num_query=np.int64(80)
2025-03-12 18:55:42,309 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-12 18:55:42,478 [INFO]: Launching the whole pipeline 03/12/2025, 18:55:42
2025-03-12 18:55:42,479 [INFO]: Reading total number of vectors and dimension 03/12/2025, 18:55:42
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1907.37it/s]
2025-03-12 18:55:42,505 [INFO]: There are 1491 embeddings of dim 49152
2025-03-12 18:55:42,505 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0262 secs
2025-03-12 18:55:42,505 [INFO]: 	Compute estimated construction time of the index 03/12/2025, 18:55:42
2025-03-12 18:55:42,505 [INFO]: 		-> Train: 16.7 minutes
2025-03-12 18:55:42,505 [INFO]: 		-> Add: 0.8 seconds
2025-03-12 18:55:42,505 [INFO]: 		Total: 16.7 minutes
2025-03-12 18:55:42,505 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0001 secs
2025-03-12 18:55:42,505 [INFO]: 	Checking that your have enough memory available to create the index 03/12/2025, 18:55:42
2025-03-12 18:55:42,505 [INFO]: 307.7MB of memory will be needed to build the index (more might be used if you have more)
2025-03-12 18:55:42,505 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0001 secs
2025-03-12 18:55:42,505 [INFO]: 	Selecting most promising index types given data characteristics 03/12/2025, 18:55:42
2025-03-12 18:55:42,505 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-12 18:55:42,505 [INFO]: 	Creating the index 03/12/2025, 18:55:42
2025-03-12 18:55:42,505 [INFO]: 		-> Instanciate the index HNSW15 03/12/2025, 18:55:42
2025-03-12 18:55:42,506 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0009 secs
2025-03-12 18:55:42,506 [INFO]: 		-> Adding the vectors to the index 03/12/2025, 18:55:42
2025-03-12 18:55:42,506 [INFO]: The memory available for adding the vectors is 49.7GB(total available - used by the index)
2025-03-12 18:55:42,506 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/6 [00:00<?, ?it/s] 50%|█████     | 3/6 [00:00<00:00, 28.90it/s]100%|██████████| 6/6 [00:01<00:00,  4.62it/s]100%|██████████| 6/6 [00:01<00:00,  5.28it/s]
2025-03-12 18:55:43,645 [INFO]: 	Computing best hyperparameters for index knn.index 03/12/2025, 18:55:43
2025-03-12 18:56:04,277 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 20.6315 secs
2025-03-12 18:56:04,278 [INFO]: The best hyperparameters are: efSearch=358
2025-03-12 18:56:04,278 [INFO]: 	Compute fast metrics 03/12/2025, 18:56:04
  0%|          | 0/4 [00:00<?, ?it/s] 75%|███████▌  | 3/4 [00:00<00:00, 28.13it/s] 75%|███████▌  | 3/4 [00:00<00:00, 25.05it/s]
2025-03-12 18:56:15,301 [INFO]: 	>>> Finished "Compute fast metrics" in 11.0231 secs
2025-03-12 18:56:15,302 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 32.7958 secs
2025-03-12 18:56:15,302 [INFO]: {
2025-03-12 18:56:15,302 [INFO]: 	index_key: HNSW15
2025-03-12 18:56:15,302 [INFO]: 	index_param: efSearch=358
2025-03-12 18:56:15,302 [INFO]: 	index_path: knn.index
2025-03-12 18:56:15,302 [INFO]: 	size in bytes: 293345350
2025-03-12 18:56:15,302 [INFO]: 	avg_search_speed_ms: 9.9679164271356
2025-03-12 18:56:15,302 [INFO]: 	99p_search_speed_ms: 13.471624068915846
2025-03-12 18:56:15,302 [INFO]: 	reconstruction error %: 0.0
2025-03-12 18:56:15,302 [INFO]: 	nb vectors: 1491
2025-03-12 18:56:15,302 [INFO]: 	vectors dimension: 49152
2025-03-12 18:56:15,302 [INFO]: 	compression ratio: 0.9993085896878884
2025-03-12 18:56:15,302 [INFO]: }
2025-03-12 18:56:15,302 [INFO]: 	>>> Finished "Creating the index" in 32.7971 secs
2025-03-12 18:56:15,302 [INFO]: >>> Finished "Launching the whole pipeline" in 32.8238 secs
2025-03-12 18:56:15: [retrieval_preprocessing] calculating distances ...
2025-03-12 18:56:16: [retrieval_preprocessing] finished and saved retrieval indices for episode 108 [episode count 2/20]
[retrieval_preprocessing] for episode 109 [episode count 3/20], we have num_retrieval=np.int64(1487) num_query=np.int64(84)
2025-03-12 18:56:16,143 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-12 18:56:16,321 [INFO]: Launching the whole pipeline 03/12/2025, 18:56:16
2025-03-12 18:56:16,321 [INFO]: Reading total number of vectors and dimension 03/12/2025, 18:56:16
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 2395.38it/s]
2025-03-12 18:56:16,346 [INFO]: There are 1487 embeddings of dim 49152
2025-03-12 18:56:16,347 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0257 secs
2025-03-12 18:56:16,347 [INFO]: 	Compute estimated construction time of the index 03/12/2025, 18:56:16
2025-03-12 18:56:16,347 [INFO]: 		-> Train: 16.7 minutes
2025-03-12 18:56:16,347 [INFO]: 		-> Add: 0.8 seconds
2025-03-12 18:56:16,347 [INFO]: 		Total: 16.7 minutes
2025-03-12 18:56:16,347 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0001 secs
2025-03-12 18:56:16,347 [INFO]: 	Checking that your have enough memory available to create the index 03/12/2025, 18:56:16
2025-03-12 18:56:16,347 [INFO]: 306.9MB of memory will be needed to build the index (more might be used if you have more)
2025-03-12 18:56:16,347 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0002 secs
2025-03-12 18:56:16,347 [INFO]: 	Selecting most promising index types given data characteristics 03/12/2025, 18:56:16
2025-03-12 18:56:16,347 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-12 18:56:16,347 [INFO]: 	Creating the index 03/12/2025, 18:56:16
2025-03-12 18:56:16,347 [INFO]: 		-> Instanciate the index HNSW15 03/12/2025, 18:56:16
2025-03-12 18:56:16,348 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0007 secs
2025-03-12 18:56:16,348 [INFO]: 		-> Adding the vectors to the index 03/12/2025, 18:56:16
2025-03-12 18:56:16,348 [INFO]: The memory available for adding the vectors is 49.7GB(total available - used by the index)
2025-03-12 18:56:16,348 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/6 [00:00<?, ?it/s] 67%|██████▋   | 4/6 [00:00<00:00, 37.10it/s]100%|██████████| 6/6 [00:01<00:00,  5.49it/s]
2025-03-12 18:56:17,444 [INFO]: 	Computing best hyperparameters for index knn.index 03/12/2025, 18:56:17
2025-03-12 18:56:36,915 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 19.4697 secs
2025-03-12 18:56:36,915 [INFO]: The best hyperparameters are: efSearch=364
2025-03-12 18:56:36,915 [INFO]: 	Compute fast metrics 03/12/2025, 18:56:36
  0%|          | 0/4 [00:00<?, ?it/s] 75%|███████▌  | 3/4 [00:00<00:00, 29.68it/s] 75%|███████▌  | 3/4 [00:00<00:00, 26.23it/s]
2025-03-12 18:56:47,840 [INFO]: 	>>> Finished "Compute fast metrics" in 10.9248 secs
2025-03-12 18:56:47,841 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 31.4929 secs
2025-03-12 18:56:47,841 [INFO]: {
2025-03-12 18:56:47,841 [INFO]: 	index_key: HNSW15
2025-03-12 18:56:47,841 [INFO]: 	index_param: efSearch=364
2025-03-12 18:56:47,841 [INFO]: 	index_path: knn.index
2025-03-12 18:56:47,841 [INFO]: 	size in bytes: 292558390
2025-03-12 18:56:47,841 [INFO]: 	avg_search_speed_ms: 10.204797030702156
2025-03-12 18:56:47,841 [INFO]: 	99p_search_speed_ms: 13.300362941809
2025-03-12 18:56:47,841 [INFO]: 	reconstruction error %: 0.0
2025-03-12 18:56:47,841 [INFO]: 	nb vectors: 1487
2025-03-12 18:56:47,841 [INFO]: 	vectors dimension: 49152
2025-03-12 18:56:47,841 [INFO]: 	compression ratio: 0.9993085346142355
2025-03-12 18:56:47,841 [INFO]: }
2025-03-12 18:56:47,841 [INFO]: 	>>> Finished "Creating the index" in 31.4940 secs
2025-03-12 18:56:47,841 [INFO]: >>> Finished "Launching the whole pipeline" in 31.5203 secs
2025-03-12 18:56:48: [retrieval_preprocessing] calculating distances ...
2025-03-12 18:56:48: [retrieval_preprocessing] finished and saved retrieval indices for episode 109 [episode count 3/20]
[retrieval_preprocessing] for episode 110 [episode count 4/20], we have num_retrieval=np.int64(1502) num_query=np.int64(69)
2025-03-12 18:56:48,687 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-12 18:56:48,872 [INFO]: Launching the whole pipeline 03/12/2025, 18:56:48
2025-03-12 18:56:48,872 [INFO]: Reading total number of vectors and dimension 03/12/2025, 18:56:48
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 2513.06it/s]
2025-03-12 18:56:48,897 [INFO]: There are 1502 embeddings of dim 49152
2025-03-12 18:56:48,897 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0249 secs
2025-03-12 18:56:48,897 [INFO]: 	Compute estimated construction time of the index 03/12/2025, 18:56:48
2025-03-12 18:56:48,897 [INFO]: 		-> Train: 16.7 minutes
2025-03-12 18:56:48,897 [INFO]: 		-> Add: 0.8 seconds
2025-03-12 18:56:48,897 [INFO]: 		Total: 16.7 minutes
2025-03-12 18:56:48,897 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0001 secs
2025-03-12 18:56:48,897 [INFO]: 	Checking that your have enough memory available to create the index 03/12/2025, 18:56:48
2025-03-12 18:56:48,898 [INFO]: 310.0MB of memory will be needed to build the index (more might be used if you have more)
2025-03-12 18:56:48,898 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0001 secs
2025-03-12 18:56:48,898 [INFO]: 	Selecting most promising index types given data characteristics 03/12/2025, 18:56:48
2025-03-12 18:56:48,898 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-12 18:56:48,898 [INFO]: 	Creating the index 03/12/2025, 18:56:48
2025-03-12 18:56:48,898 [INFO]: 		-> Instanciate the index HNSW15 03/12/2025, 18:56:48
2025-03-12 18:56:48,899 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0009 secs
2025-03-12 18:56:48,899 [INFO]: 		-> Adding the vectors to the index 03/12/2025, 18:56:48
2025-03-12 18:56:48,899 [INFO]: The memory available for adding the vectors is 49.7GB(total available - used by the index)
2025-03-12 18:56:48,899 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/6 [00:00<?, ?it/s] 50%|█████     | 3/6 [00:00<00:00, 27.70it/s]100%|██████████| 6/6 [00:01<00:00,  4.73it/s]100%|██████████| 6/6 [00:01<00:00,  5.40it/s]
2025-03-12 18:56:50,013 [INFO]: 	Computing best hyperparameters for index knn.index 03/12/2025, 18:56:50
2025-03-12 18:57:10,106 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 20.0923 secs
2025-03-12 18:57:10,106 [INFO]: The best hyperparameters are: efSearch=365
2025-03-12 18:57:10,106 [INFO]: 	Compute fast metrics 03/12/2025, 18:57:10
  0%|          | 0/4 [00:00<?, ?it/s] 75%|███████▌  | 3/4 [00:00<00:00, 26.84it/s]
2025-03-12 18:57:21,069 [INFO]: 	>>> Finished "Compute fast metrics" in 10.9625 secs
2025-03-12 18:57:21,070 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 32.1711 secs
2025-03-12 18:57:21,070 [INFO]: {
2025-03-12 18:57:21,070 [INFO]: 	index_key: HNSW15
2025-03-12 18:57:21,070 [INFO]: 	index_param: efSearch=365
2025-03-12 18:57:21,070 [INFO]: 	index_path: knn.index
2025-03-12 18:57:21,070 [INFO]: 	size in bytes: 295509490
2025-03-12 18:57:21,070 [INFO]: 	avg_search_speed_ms: 9.714875585236813
2025-03-12 18:57:21,070 [INFO]: 	99p_search_speed_ms: 11.876861180644482
2025-03-12 18:57:21,070 [INFO]: 	reconstruction error %: 0.0
2025-03-12 18:57:21,070 [INFO]: 	nb vectors: 1502
2025-03-12 18:57:21,070 [INFO]: 	vectors dimension: 49152
2025-03-12 18:57:21,070 [INFO]: 	compression ratio: 0.9993087396279557
2025-03-12 18:57:21,070 [INFO]: }
2025-03-12 18:57:21,070 [INFO]: 	>>> Finished "Creating the index" in 32.1725 secs
2025-03-12 18:57:21,070 [INFO]: >>> Finished "Launching the whole pipeline" in 32.1979 secs
2025-03-12 18:57:21: [retrieval_preprocessing] calculating distances ...
2025-03-12 18:57:21: [retrieval_preprocessing] finished and saved retrieval indices for episode 110 [episode count 4/20]
[retrieval_preprocessing] for episode 111 [episode count 5/20], we have num_retrieval=np.int64(1497) num_query=np.int64(74)
2025-03-12 18:57:21,783 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-12 18:57:21,956 [INFO]: Launching the whole pipeline 03/12/2025, 18:57:21
2025-03-12 18:57:21,956 [INFO]: Reading total number of vectors and dimension 03/12/2025, 18:57:21
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 2223.92it/s]
2025-03-12 18:57:21,979 [INFO]: There are 1497 embeddings of dim 49152
2025-03-12 18:57:21,980 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0235 secs
2025-03-12 18:57:21,980 [INFO]: 	Compute estimated construction time of the index 03/12/2025, 18:57:21
2025-03-12 18:57:21,980 [INFO]: 		-> Train: 16.7 minutes
2025-03-12 18:57:21,980 [INFO]: 		-> Add: 0.8 seconds
2025-03-12 18:57:21,980 [INFO]: 		Total: 16.7 minutes
2025-03-12 18:57:21,980 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0001 secs
2025-03-12 18:57:21,980 [INFO]: 	Checking that your have enough memory available to create the index 03/12/2025, 18:57:21
2025-03-12 18:57:21,980 [INFO]: 308.9MB of memory will be needed to build the index (more might be used if you have more)
2025-03-12 18:57:21,980 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0001 secs
2025-03-12 18:57:21,980 [INFO]: 	Selecting most promising index types given data characteristics 03/12/2025, 18:57:21
2025-03-12 18:57:21,980 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-12 18:57:21,980 [INFO]: 	Creating the index 03/12/2025, 18:57:21
2025-03-12 18:57:21,980 [INFO]: 		-> Instanciate the index HNSW15 03/12/2025, 18:57:21
2025-03-12 18:57:21,981 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0010 secs
2025-03-12 18:57:21,981 [INFO]: 		-> Adding the vectors to the index 03/12/2025, 18:57:21
2025-03-12 18:57:21,981 [INFO]: The memory available for adding the vectors is 49.7GB(total available - used by the index)
2025-03-12 18:57:21,981 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/6 [00:00<?, ?it/s] 50%|█████     | 3/6 [00:00<00:00, 29.05it/s]100%|██████████| 6/6 [00:01<00:00,  4.85it/s]100%|██████████| 6/6 [00:01<00:00,  5.53it/s]
2025-03-12 18:57:23,068 [INFO]: 	Computing best hyperparameters for index knn.index 03/12/2025, 18:57:23
2025-03-12 18:57:43,351 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 20.2821 secs
2025-03-12 18:57:43,351 [INFO]: The best hyperparameters are: efSearch=350
2025-03-12 18:57:43,351 [INFO]: 	Compute fast metrics 03/12/2025, 18:57:43
  0%|          | 0/4 [00:00<?, ?it/s] 75%|███████▌  | 3/4 [00:00<00:00, 26.42it/s]
2025-03-12 18:57:54,268 [INFO]: 	>>> Finished "Compute fast metrics" in 10.9177 secs
2025-03-12 18:57:54,269 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 32.2882 secs
2025-03-12 18:57:54,270 [INFO]: {
2025-03-12 18:57:54,270 [INFO]: 	index_key: HNSW15
2025-03-12 18:57:54,270 [INFO]: 	index_param: efSearch=350
2025-03-12 18:57:54,270 [INFO]: 	index_path: knn.index
2025-03-12 18:57:54,270 [INFO]: 	size in bytes: 294525790
2025-03-12 18:57:54,270 [INFO]: 	avg_search_speed_ms: 9.860443447981051
2025-03-12 18:57:54,270 [INFO]: 	99p_search_speed_ms: 12.131438802462071
2025-03-12 18:57:54,270 [INFO]: 	reconstruction error %: 0.0
2025-03-12 18:57:54,270 [INFO]: 	nb vectors: 1497
2025-03-12 18:57:54,270 [INFO]: 	vectors dimension: 49152
2025-03-12 18:57:54,270 [INFO]: 	compression ratio: 0.9993086717465387
2025-03-12 18:57:54,270 [INFO]: }
2025-03-12 18:57:54,270 [INFO]: 	>>> Finished "Creating the index" in 32.2898 secs
2025-03-12 18:57:54,270 [INFO]: >>> Finished "Launching the whole pipeline" in 32.3137 secs
2025-03-12 18:57:54: [retrieval_preprocessing] calculating distances ...
2025-03-12 18:57:54: [retrieval_preprocessing] finished and saved retrieval indices for episode 111 [episode count 5/20]
[retrieval_preprocessing] for episode 112 [episode count 6/20], we have num_retrieval=np.int64(1511) num_query=np.int64(60)
2025-03-12 18:57:54,985 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-12 18:57:55,161 [INFO]: Launching the whole pipeline 03/12/2025, 18:57:55
2025-03-12 18:57:55,162 [INFO]: Reading total number of vectors and dimension 03/12/2025, 18:57:55
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 2548.18it/s]
2025-03-12 18:57:55,187 [INFO]: There are 1511 embeddings of dim 49152
2025-03-12 18:57:55,187 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0252 secs
2025-03-12 18:57:55,187 [INFO]: 	Compute estimated construction time of the index 03/12/2025, 18:57:55
2025-03-12 18:57:55,187 [INFO]: 		-> Train: 16.7 minutes
2025-03-12 18:57:55,187 [INFO]: 		-> Add: 0.8 seconds
2025-03-12 18:57:55,187 [INFO]: 		Total: 16.7 minutes
2025-03-12 18:57:55,187 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0001 secs
2025-03-12 18:57:55,187 [INFO]: 	Checking that your have enough memory available to create the index 03/12/2025, 18:57:55
2025-03-12 18:57:55,187 [INFO]: 311.8MB of memory will be needed to build the index (more might be used if you have more)
2025-03-12 18:57:55,187 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0001 secs
2025-03-12 18:57:55,187 [INFO]: 	Selecting most promising index types given data characteristics 03/12/2025, 18:57:55
2025-03-12 18:57:55,187 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-12 18:57:55,187 [INFO]: 	Creating the index 03/12/2025, 18:57:55
2025-03-12 18:57:55,187 [INFO]: 		-> Instanciate the index HNSW15 03/12/2025, 18:57:55
2025-03-12 18:57:55,188 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0008 secs
2025-03-12 18:57:55,188 [INFO]: 		-> Adding the vectors to the index 03/12/2025, 18:57:55
2025-03-12 18:57:55,188 [INFO]: The memory available for adding the vectors is 49.7GB(total available - used by the index)
2025-03-12 18:57:55,188 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/6 [00:00<?, ?it/s] 50%|█████     | 3/6 [00:00<00:00, 28.42it/s]100%|██████████| 6/6 [00:01<00:00,  4.90it/s]100%|██████████| 6/6 [00:01<00:00,  5.58it/s]
2025-03-12 18:57:56,266 [INFO]: 	Computing best hyperparameters for index knn.index 03/12/2025, 18:57:56
2025-03-12 18:58:16,622 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 20.3562 secs
2025-03-12 18:58:16,622 [INFO]: The best hyperparameters are: efSearch=358
2025-03-12 18:58:16,622 [INFO]: 	Compute fast metrics 03/12/2025, 18:58:16
  0%|          | 0/4 [00:00<?, ?it/s] 75%|███████▌  | 3/4 [00:00<00:00, 27.63it/s] 75%|███████▌  | 3/4 [00:00<00:00, 24.08it/s]
2025-03-12 18:58:27,579 [INFO]: 	>>> Finished "Compute fast metrics" in 10.9562 secs
2025-03-12 18:58:27,580 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 32.3918 secs
2025-03-12 18:58:27,580 [INFO]: {
2025-03-12 18:58:27,580 [INFO]: 	index_key: HNSW15
2025-03-12 18:58:27,580 [INFO]: 	index_param: efSearch=358
2025-03-12 18:58:27,580 [INFO]: 	index_path: knn.index
2025-03-12 18:58:27,580 [INFO]: 	size in bytes: 297280150
2025-03-12 18:58:27,580 [INFO]: 	avg_search_speed_ms: 10.243581727454362
2025-03-12 18:58:27,580 [INFO]: 	99p_search_speed_ms: 13.374859525356442
2025-03-12 18:58:27,580 [INFO]: 	reconstruction error %: 0.0
2025-03-12 18:58:27,580 [INFO]: 	nb vectors: 1511
2025-03-12 18:58:27,580 [INFO]: 	vectors dimension: 49152
2025-03-12 18:58:27,580 [INFO]: 	compression ratio: 0.9993088606824236
2025-03-12 18:58:27,580 [INFO]: }
2025-03-12 18:58:27,580 [INFO]: 	>>> Finished "Creating the index" in 32.3930 secs
2025-03-12 18:58:27,580 [INFO]: >>> Finished "Launching the whole pipeline" in 32.4187 secs
2025-03-12 18:58:27: [retrieval_preprocessing] calculating distances ...
2025-03-12 18:58:28: [retrieval_preprocessing] finished and saved retrieval indices for episode 112 [episode count 6/20]
[retrieval_preprocessing] for episode 113 [episode count 7/20], we have num_retrieval=np.int64(1510) num_query=np.int64(61)
2025-03-12 18:58:28,203 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-12 18:58:28,374 [INFO]: Launching the whole pipeline 03/12/2025, 18:58:28
2025-03-12 18:58:28,374 [INFO]: Reading total number of vectors and dimension 03/12/2025, 18:58:28
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1554.02it/s]
2025-03-12 18:58:28,405 [INFO]: There are 1510 embeddings of dim 49152
2025-03-12 18:58:28,406 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0316 secs
2025-03-12 18:58:28,406 [INFO]: 	Compute estimated construction time of the index 03/12/2025, 18:58:28
2025-03-12 18:58:28,406 [INFO]: 		-> Train: 16.7 minutes
2025-03-12 18:58:28,406 [INFO]: 		-> Add: 0.8 seconds
2025-03-12 18:58:28,406 [INFO]: 		Total: 16.7 minutes
2025-03-12 18:58:28,406 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0003 secs
2025-03-12 18:58:28,406 [INFO]: 	Checking that your have enough memory available to create the index 03/12/2025, 18:58:28
2025-03-12 18:58:28,407 [INFO]: 311.6MB of memory will be needed to build the index (more might be used if you have more)
2025-03-12 18:58:28,407 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0004 secs
2025-03-12 18:58:28,407 [INFO]: 	Selecting most promising index types given data characteristics 03/12/2025, 18:58:28
2025-03-12 18:58:28,407 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-12 18:58:28,407 [INFO]: 	Creating the index 03/12/2025, 18:58:28
2025-03-12 18:58:28,407 [INFO]: 		-> Instanciate the index HNSW15 03/12/2025, 18:58:28
2025-03-12 18:58:28,410 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0026 secs
2025-03-12 18:58:28,410 [INFO]: 		-> Adding the vectors to the index 03/12/2025, 18:58:28
2025-03-12 18:58:28,410 [INFO]: The memory available for adding the vectors is 49.7GB(total available - used by the index)
2025-03-12 18:58:28,411 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/6 [00:00<?, ?it/s] 50%|█████     | 3/6 [00:00<00:00, 29.29it/s]100%|██████████| 6/6 [00:01<00:00,  4.52it/s]100%|██████████| 6/6 [00:01<00:00,  5.16it/s]
2025-03-12 18:58:29,578 [INFO]: 	Computing best hyperparameters for index knn.index 03/12/2025, 18:58:29
2025-03-12 18:58:51,046 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 21.4672 secs
2025-03-12 18:58:51,046 [INFO]: The best hyperparameters are: efSearch=328
2025-03-12 18:58:51,046 [INFO]: 	Compute fast metrics 03/12/2025, 18:58:51
  0%|          | 0/4 [00:00<?, ?it/s] 75%|███████▌  | 3/4 [00:00<00:00, 29.33it/s] 75%|███████▌  | 3/4 [00:00<00:00, 25.90it/s]
2025-03-12 18:59:01,989 [INFO]: 	>>> Finished "Compute fast metrics" in 10.9426 secs
2025-03-12 18:59:01,990 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 33.5794 secs
2025-03-12 18:59:01,990 [INFO]: {
2025-03-12 18:59:01,990 [INFO]: 	index_key: HNSW15
2025-03-12 18:59:01,990 [INFO]: 	index_param: efSearch=328
2025-03-12 18:59:01,990 [INFO]: 	index_path: knn.index
2025-03-12 18:59:01,990 [INFO]: 	size in bytes: 297083410
2025-03-12 18:59:01,990 [INFO]: 	avg_search_speed_ms: 9.48296827948277
2025-03-12 18:59:01,990 [INFO]: 	99p_search_speed_ms: 11.968217482790353
2025-03-12 18:59:01,990 [INFO]: 	reconstruction error %: 0.0
2025-03-12 18:59:01,990 [INFO]: 	nb vectors: 1510
2025-03-12 18:59:01,990 [INFO]: 	vectors dimension: 49152
2025-03-12 18:59:01,990 [INFO]: 	compression ratio: 0.9993088473031867
2025-03-12 18:59:01,990 [INFO]: }
2025-03-12 18:59:01,990 [INFO]: 	>>> Finished "Creating the index" in 33.5827 secs
2025-03-12 18:59:01,990 [INFO]: >>> Finished "Launching the whole pipeline" in 33.6159 secs
2025-03-12 18:59:02: [retrieval_preprocessing] calculating distances ...
2025-03-12 18:59:02: [retrieval_preprocessing] finished and saved retrieval indices for episode 113 [episode count 7/20]
[retrieval_preprocessing] for episode 114 [episode count 8/20], we have num_retrieval=np.int64(1518) num_query=np.int64(53)
2025-03-12 18:59:02,505 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-12 18:59:02,681 [INFO]: Launching the whole pipeline 03/12/2025, 18:59:02
2025-03-12 18:59:02,681 [INFO]: Reading total number of vectors and dimension 03/12/2025, 18:59:02
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1643.54it/s]
2025-03-12 18:59:02,898 [INFO]: There are 1518 embeddings of dim 49152
2025-03-12 18:59:02,899 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.2174 secs
2025-03-12 18:59:02,899 [INFO]: 	Compute estimated construction time of the index 03/12/2025, 18:59:02
2025-03-12 18:59:02,899 [INFO]: 		-> Train: 16.7 minutes
2025-03-12 18:59:02,899 [INFO]: 		-> Add: 0.8 seconds
2025-03-12 18:59:02,899 [INFO]: 		Total: 16.7 minutes
2025-03-12 18:59:02,899 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0001 secs
2025-03-12 18:59:02,899 [INFO]: 	Checking that your have enough memory available to create the index 03/12/2025, 18:59:02
2025-03-12 18:59:02,899 [INFO]: 313.3MB of memory will be needed to build the index (more might be used if you have more)
2025-03-12 18:59:02,899 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0001 secs
2025-03-12 18:59:02,899 [INFO]: 	Selecting most promising index types given data characteristics 03/12/2025, 18:59:02
2025-03-12 18:59:02,899 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-12 18:59:02,899 [INFO]: 	Creating the index 03/12/2025, 18:59:02
2025-03-12 18:59:02,899 [INFO]: 		-> Instanciate the index HNSW15 03/12/2025, 18:59:02
2025-03-12 18:59:02,900 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0008 secs
2025-03-12 18:59:02,900 [INFO]: 		-> Adding the vectors to the index 03/12/2025, 18:59:02
2025-03-12 18:59:02,900 [INFO]: The memory available for adding the vectors is 49.7GB(total available - used by the index)
2025-03-12 18:59:02,900 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/6 [00:00<?, ?it/s] 33%|███▎      | 2/6 [00:00<00:00, 19.39it/s]100%|██████████| 6/6 [00:01<00:00,  4.68it/s]100%|██████████| 6/6 [00:01<00:00,  5.06it/s]
2025-03-12 18:59:04,089 [INFO]: 	Computing best hyperparameters for index knn.index 03/12/2025, 18:59:04
2025-03-12 18:59:24,522 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 20.4326 secs
2025-03-12 18:59:24,522 [INFO]: The best hyperparameters are: efSearch=359
2025-03-12 18:59:24,522 [INFO]: 	Compute fast metrics 03/12/2025, 18:59:24
  0%|          | 0/4 [00:00<?, ?it/s] 75%|███████▌  | 3/4 [00:00<00:00, 28.88it/s] 75%|███████▌  | 3/4 [00:00<00:00, 25.51it/s]
2025-03-12 18:59:35,436 [INFO]: 	>>> Finished "Compute fast metrics" in 10.9131 secs
2025-03-12 18:59:35,437 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 32.5365 secs
2025-03-12 18:59:35,437 [INFO]: {
2025-03-12 18:59:35,437 [INFO]: 	index_key: HNSW15
2025-03-12 18:59:35,437 [INFO]: 	index_param: efSearch=359
2025-03-12 18:59:35,437 [INFO]: 	index_path: knn.index
2025-03-12 18:59:35,437 [INFO]: 	size in bytes: 298657390
2025-03-12 18:59:35,437 [INFO]: 	avg_search_speed_ms: 9.978778397026815
2025-03-12 18:59:35,437 [INFO]: 	99p_search_speed_ms: 12.185701027046889
2025-03-12 18:59:35,437 [INFO]: 	reconstruction error %: 0.0
2025-03-12 18:59:35,437 [INFO]: 	nb vectors: 1518
2025-03-12 18:59:35,437 [INFO]: 	vectors dimension: 49152
2025-03-12 18:59:35,437 [INFO]: 	compression ratio: 0.9993087530832571
2025-03-12 18:59:35,437 [INFO]: }
2025-03-12 18:59:35,437 [INFO]: 	>>> Finished "Creating the index" in 32.5377 secs
2025-03-12 18:59:35,437 [INFO]: >>> Finished "Launching the whole pipeline" in 32.7557 secs
2025-03-12 18:59:35: [retrieval_preprocessing] calculating distances ...
2025-03-12 18:59:35: [retrieval_preprocessing] finished and saved retrieval indices for episode 114 [episode count 8/20]
[retrieval_preprocessing] for episode 115 [episode count 9/20], we have num_retrieval=np.int64(1496) num_query=np.int64(75)
2025-03-12 18:59:36,004 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-12 18:59:36,175 [INFO]: Launching the whole pipeline 03/12/2025, 18:59:36
2025-03-12 18:59:36,175 [INFO]: Reading total number of vectors and dimension 03/12/2025, 18:59:36
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 2414.68it/s]
2025-03-12 18:59:36,201 [INFO]: There are 1496 embeddings of dim 49152
2025-03-12 18:59:36,201 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0265 secs
2025-03-12 18:59:36,201 [INFO]: 	Compute estimated construction time of the index 03/12/2025, 18:59:36
2025-03-12 18:59:36,201 [INFO]: 		-> Train: 16.7 minutes
2025-03-12 18:59:36,201 [INFO]: 		-> Add: 0.8 seconds
2025-03-12 18:59:36,201 [INFO]: 		Total: 16.7 minutes
2025-03-12 18:59:36,201 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0001 secs
2025-03-12 18:59:36,201 [INFO]: 	Checking that your have enough memory available to create the index 03/12/2025, 18:59:36
2025-03-12 18:59:36,202 [INFO]: 308.7MB of memory will be needed to build the index (more might be used if you have more)
2025-03-12 18:59:36,202 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0001 secs
2025-03-12 18:59:36,202 [INFO]: 	Selecting most promising index types given data characteristics 03/12/2025, 18:59:36
2025-03-12 18:59:36,202 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-12 18:59:36,202 [INFO]: 	Creating the index 03/12/2025, 18:59:36
2025-03-12 18:59:36,202 [INFO]: 		-> Instanciate the index HNSW15 03/12/2025, 18:59:36
2025-03-12 18:59:36,203 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0008 secs
2025-03-12 18:59:36,203 [INFO]: 		-> Adding the vectors to the index 03/12/2025, 18:59:36
2025-03-12 18:59:36,203 [INFO]: The memory available for adding the vectors is 49.7GB(total available - used by the index)
2025-03-12 18:59:36,203 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/6 [00:00<?, ?it/s] 50%|█████     | 3/6 [00:00<00:00, 27.83it/s]100%|██████████| 6/6 [00:01<00:00,  4.95it/s]100%|██████████| 6/6 [00:01<00:00,  5.63it/s]
2025-03-12 18:59:37,271 [INFO]: 	Computing best hyperparameters for index knn.index 03/12/2025, 18:59:37
2025-03-12 18:59:57,959 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 20.6880 secs
2025-03-12 18:59:57,960 [INFO]: The best hyperparameters are: efSearch=344
2025-03-12 18:59:57,960 [INFO]: 	Compute fast metrics 03/12/2025, 18:59:57
  0%|          | 0/4 [00:00<?, ?it/s] 75%|███████▌  | 3/4 [00:00<00:00, 26.58it/s]
2025-03-12 19:00:08,889 [INFO]: 	>>> Finished "Compute fast metrics" in 10.9290 secs
2025-03-12 19:00:08,890 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 32.6868 secs
2025-03-12 19:00:08,890 [INFO]: {
2025-03-12 19:00:08,890 [INFO]: 	index_key: HNSW15
2025-03-12 19:00:08,890 [INFO]: 	index_param: efSearch=344
2025-03-12 19:00:08,890 [INFO]: 	index_path: knn.index
2025-03-12 19:00:08,890 [INFO]: 	size in bytes: 294329050
2025-03-12 19:00:08,890 [INFO]: 	avg_search_speed_ms: 9.560723120371595
2025-03-12 19:00:08,890 [INFO]: 	99p_search_speed_ms: 11.775808606762437
2025-03-12 19:00:08,890 [INFO]: 	reconstruction error %: 0.0
2025-03-12 19:00:08,890 [INFO]: 	nb vectors: 1496
2025-03-12 19:00:08,890 [INFO]: 	vectors dimension: 49152
2025-03-12 19:00:08,890 [INFO]: 	compression ratio: 0.999308658115806
2025-03-12 19:00:08,890 [INFO]: }
2025-03-12 19:00:08,890 [INFO]: 	>>> Finished "Creating the index" in 32.6882 secs
2025-03-12 19:00:08,890 [INFO]: >>> Finished "Launching the whole pipeline" in 32.7152 secs
2025-03-12 19:00:09: [retrieval_preprocessing] calculating distances ...
2025-03-12 19:00:09: [retrieval_preprocessing] finished and saved retrieval indices for episode 115 [episode count 9/20]
[retrieval_preprocessing] for episode 116 [episode count 10/20], we have num_retrieval=np.int64(1480) num_query=np.int64(91)
2025-03-12 19:00:09,722 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-12 19:00:09,944 [INFO]: Launching the whole pipeline 03/12/2025, 19:00:09
2025-03-12 19:00:09,944 [INFO]: Reading total number of vectors and dimension 03/12/2025, 19:00:09
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1965.47it/s]
2025-03-12 19:00:09,973 [INFO]: There are 1480 embeddings of dim 49152
2025-03-12 19:00:09,973 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0284 secs
2025-03-12 19:00:09,973 [INFO]: 	Compute estimated construction time of the index 03/12/2025, 19:00:09
2025-03-12 19:00:09,973 [INFO]: 		-> Train: 16.7 minutes
2025-03-12 19:00:09,973 [INFO]: 		-> Add: 0.8 seconds
2025-03-12 19:00:09,973 [INFO]: 		Total: 16.7 minutes
2025-03-12 19:00:09,973 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0001 secs
2025-03-12 19:00:09,973 [INFO]: 	Checking that your have enough memory available to create the index 03/12/2025, 19:00:09
2025-03-12 19:00:09,973 [INFO]: 305.4MB of memory will be needed to build the index (more might be used if you have more)
2025-03-12 19:00:09,973 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0001 secs
2025-03-12 19:00:09,973 [INFO]: 	Selecting most promising index types given data characteristics 03/12/2025, 19:00:09
2025-03-12 19:00:09,973 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-12 19:00:09,973 [INFO]: 	Creating the index 03/12/2025, 19:00:09
2025-03-12 19:00:09,973 [INFO]: 		-> Instanciate the index HNSW15 03/12/2025, 19:00:09
2025-03-12 19:00:09,975 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0011 secs
2025-03-12 19:00:09,975 [INFO]: 		-> Adding the vectors to the index 03/12/2025, 19:00:09
2025-03-12 19:00:09,975 [INFO]: The memory available for adding the vectors is 49.7GB(total available - used by the index)
2025-03-12 19:00:09,975 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/6 [00:00<?, ?it/s] 50%|█████     | 3/6 [00:00<00:00, 28.13it/s]100%|██████████| 6/6 [00:01<00:00,  5.00it/s]100%|██████████| 6/6 [00:01<00:00,  5.69it/s]
2025-03-12 19:00:11,032 [INFO]: 	Computing best hyperparameters for index knn.index 03/12/2025, 19:00:11
2025-03-12 19:00:30,255 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 19.2227 secs
2025-03-12 19:00:30,255 [INFO]: The best hyperparameters are: efSearch=361
2025-03-12 19:00:30,255 [INFO]: 	Compute fast metrics 03/12/2025, 19:00:30
  0%|          | 0/4 [00:00<?, ?it/s] 75%|███████▌  | 3/4 [00:00<00:00, 29.92it/s] 75%|███████▌  | 3/4 [00:00<00:00, 26.47it/s]
2025-03-12 19:00:41,155 [INFO]: 	>>> Finished "Compute fast metrics" in 10.8992 secs
2025-03-12 19:00:41,156 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 31.1809 secs
2025-03-12 19:00:41,156 [INFO]: {
2025-03-12 19:00:41,156 [INFO]: 	index_key: HNSW15
2025-03-12 19:00:41,156 [INFO]: 	index_param: efSearch=361
2025-03-12 19:00:41,156 [INFO]: 	index_path: knn.index
2025-03-12 19:00:41,156 [INFO]: 	size in bytes: 291181150
2025-03-12 19:00:41,156 [INFO]: 	avg_search_speed_ms: 9.779228670668232
2025-03-12 19:00:41,156 [INFO]: 	99p_search_speed_ms: 12.012611390091479
2025-03-12 19:00:41,156 [INFO]: 	reconstruction error %: 0.0
2025-03-12 19:00:41,156 [INFO]: 	nb vectors: 1480
2025-03-12 19:00:41,156 [INFO]: 	vectors dimension: 49152
2025-03-12 19:00:41,156 [INFO]: 	compression ratio: 0.9993086434338212
2025-03-12 19:00:41,156 [INFO]: }
2025-03-12 19:00:41,156 [INFO]: 	>>> Finished "Creating the index" in 31.1825 secs
2025-03-12 19:00:41,156 [INFO]: >>> Finished "Launching the whole pipeline" in 31.2115 secs
2025-03-12 19:00:41: [retrieval_preprocessing] calculating distances ...
2025-03-12 19:00:41: [retrieval_preprocessing] finished and saved retrieval indices for episode 116 [episode count 10/20]
[retrieval_preprocessing] for episode 117 [episode count 11/20], we have num_retrieval=np.int64(1477) num_query=np.int64(94)
2025-03-12 19:00:42,070 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-12 19:00:42,240 [INFO]: Launching the whole pipeline 03/12/2025, 19:00:42
2025-03-12 19:00:42,240 [INFO]: Reading total number of vectors and dimension 03/12/2025, 19:00:42
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1985.94it/s]
2025-03-12 19:00:42,266 [INFO]: There are 1477 embeddings of dim 49152
2025-03-12 19:00:42,267 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0266 secs
2025-03-12 19:00:42,267 [INFO]: 	Compute estimated construction time of the index 03/12/2025, 19:00:42
2025-03-12 19:00:42,267 [INFO]: 		-> Train: 16.7 minutes
2025-03-12 19:00:42,267 [INFO]: 		-> Add: 0.8 seconds
2025-03-12 19:00:42,267 [INFO]: 		Total: 16.7 minutes
2025-03-12 19:00:42,267 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0001 secs
2025-03-12 19:00:42,267 [INFO]: 	Checking that your have enough memory available to create the index 03/12/2025, 19:00:42
2025-03-12 19:00:42,267 [INFO]: 304.8MB of memory will be needed to build the index (more might be used if you have more)
2025-03-12 19:00:42,267 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0001 secs
2025-03-12 19:00:42,267 [INFO]: 	Selecting most promising index types given data characteristics 03/12/2025, 19:00:42
2025-03-12 19:00:42,267 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-12 19:00:42,267 [INFO]: 	Creating the index 03/12/2025, 19:00:42
2025-03-12 19:00:42,267 [INFO]: 		-> Instanciate the index HNSW15 03/12/2025, 19:00:42
2025-03-12 19:00:42,268 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0009 secs
2025-03-12 19:00:42,268 [INFO]: 		-> Adding the vectors to the index 03/12/2025, 19:00:42
2025-03-12 19:00:42,268 [INFO]: The memory available for adding the vectors is 49.7GB(total available - used by the index)
2025-03-12 19:00:42,268 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/6 [00:00<?, ?it/s] 50%|█████     | 3/6 [00:00<00:00, 29.03it/s]100%|██████████| 6/6 [00:01<00:00,  5.01it/s]100%|██████████| 6/6 [00:01<00:00,  5.71it/s]
2025-03-12 19:00:43,322 [INFO]: 	Computing best hyperparameters for index knn.index 03/12/2025, 19:00:43
2025-03-12 19:01:03,420 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 20.0979 secs
2025-03-12 19:01:03,420 [INFO]: The best hyperparameters are: efSearch=360
2025-03-12 19:01:03,421 [INFO]: 	Compute fast metrics 03/12/2025, 19:01:03
  0%|          | 0/4 [00:00<?, ?it/s] 75%|███████▌  | 3/4 [00:00<00:00, 28.87it/s] 75%|███████▌  | 3/4 [00:00<00:00, 25.18it/s]
2025-03-12 19:01:14,355 [INFO]: 	>>> Finished "Compute fast metrics" in 10.9347 secs
2025-03-12 19:01:14,356 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 32.0882 secs
2025-03-12 19:01:14,356 [INFO]: {
2025-03-12 19:01:14,356 [INFO]: 	index_key: HNSW15
2025-03-12 19:01:14,356 [INFO]: 	index_param: efSearch=360
2025-03-12 19:01:14,356 [INFO]: 	index_path: knn.index
2025-03-12 19:01:14,356 [INFO]: 	size in bytes: 290590930
2025-03-12 19:01:14,356 [INFO]: 	avg_search_speed_ms: 10.319325949908286
2025-03-12 19:01:14,357 [INFO]: 	99p_search_speed_ms: 13.352637430652976
2025-03-12 19:01:14,357 [INFO]: 	reconstruction error %: 0.0
2025-03-12 19:01:14,357 [INFO]: 	nb vectors: 1477
2025-03-12 19:01:14,357 [INFO]: 	vectors dimension: 49152
2025-03-12 19:01:14,357 [INFO]: 	compression ratio: 0.9993086019580859
2025-03-12 19:01:14,357 [INFO]: }
2025-03-12 19:01:14,357 [INFO]: 	>>> Finished "Creating the index" in 32.0895 secs
2025-03-12 19:01:14,357 [INFO]: >>> Finished "Launching the whole pipeline" in 32.1166 secs
2025-03-12 19:01:14: [retrieval_preprocessing] calculating distances ...
2025-03-12 19:01:15: [retrieval_preprocessing] finished and saved retrieval indices for episode 117 [episode count 11/20]
[retrieval_preprocessing] for episode 118 [episode count 12/20], we have num_retrieval=np.int64(1512) num_query=np.int64(59)
2025-03-12 19:01:15,227 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-12 19:01:15,401 [INFO]: Launching the whole pipeline 03/12/2025, 19:01:15
2025-03-12 19:01:15,402 [INFO]: Reading total number of vectors and dimension 03/12/2025, 19:01:15
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 2027.21it/s]
2025-03-12 19:01:15,427 [INFO]: There are 1512 embeddings of dim 49152
2025-03-12 19:01:15,427 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0252 secs
2025-03-12 19:01:15,427 [INFO]: 	Compute estimated construction time of the index 03/12/2025, 19:01:15
2025-03-12 19:01:15,427 [INFO]: 		-> Train: 16.7 minutes
2025-03-12 19:01:15,427 [INFO]: 		-> Add: 0.8 seconds
2025-03-12 19:01:15,427 [INFO]: 		Total: 16.7 minutes
2025-03-12 19:01:15,427 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0001 secs
2025-03-12 19:01:15,427 [INFO]: 	Checking that your have enough memory available to create the index 03/12/2025, 19:01:15
2025-03-12 19:01:15,427 [INFO]: 312.0MB of memory will be needed to build the index (more might be used if you have more)
2025-03-12 19:01:15,427 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0001 secs
2025-03-12 19:01:15,427 [INFO]: 	Selecting most promising index types given data characteristics 03/12/2025, 19:01:15
2025-03-12 19:01:15,427 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-12 19:01:15,427 [INFO]: 	Creating the index 03/12/2025, 19:01:15
2025-03-12 19:01:15,427 [INFO]: 		-> Instanciate the index HNSW15 03/12/2025, 19:01:15
2025-03-12 19:01:15,428 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0007 secs
2025-03-12 19:01:15,428 [INFO]: 		-> Adding the vectors to the index 03/12/2025, 19:01:15
2025-03-12 19:01:15,428 [INFO]: The memory available for adding the vectors is 49.7GB(total available - used by the index)
2025-03-12 19:01:15,428 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/6 [00:00<?, ?it/s] 50%|█████     | 3/6 [00:00<00:00, 26.27it/s]100%|██████████| 6/6 [00:01<00:00,  4.51it/s]100%|██████████| 6/6 [00:01<00:00,  5.15it/s]
2025-03-12 19:01:16,597 [INFO]: 	Computing best hyperparameters for index knn.index 03/12/2025, 19:01:16
2025-03-12 19:01:36,993 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 20.3949 secs
2025-03-12 19:01:36,993 [INFO]: The best hyperparameters are: efSearch=353
2025-03-12 19:01:36,993 [INFO]: 	Compute fast metrics 03/12/2025, 19:01:36
  0%|          | 0/4 [00:00<?, ?it/s] 75%|███████▌  | 3/4 [00:00<00:00, 26.76it/s]
2025-03-12 19:01:47,947 [INFO]: 	>>> Finished "Compute fast metrics" in 10.9537 secs
2025-03-12 19:01:47,948 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 32.5194 secs
2025-03-12 19:01:47,948 [INFO]: {
2025-03-12 19:01:47,948 [INFO]: 	index_key: HNSW15
2025-03-12 19:01:47,948 [INFO]: 	index_param: efSearch=353
2025-03-12 19:01:47,948 [INFO]: 	index_path: knn.index
2025-03-12 19:01:47,948 [INFO]: 	size in bytes: 297476890
2025-03-12 19:01:47,948 [INFO]: 	avg_search_speed_ms: 9.745096785994882
2025-03-12 19:01:47,948 [INFO]: 	99p_search_speed_ms: 12.084960006177425
2025-03-12 19:01:47,948 [INFO]: 	reconstruction error %: 0.0
2025-03-12 19:01:47,948 [INFO]: 	nb vectors: 1512
2025-03-12 19:01:47,948 [INFO]: 	vectors dimension: 49152
2025-03-12 19:01:47,948 [INFO]: 	compression ratio: 0.9993088740439635
2025-03-12 19:01:47,948 [INFO]: }
2025-03-12 19:01:47,948 [INFO]: 	>>> Finished "Creating the index" in 32.5206 secs
2025-03-12 19:01:47,948 [INFO]: >>> Finished "Launching the whole pipeline" in 32.5464 secs
2025-03-12 19:01:48: [retrieval_preprocessing] calculating distances ...
2025-03-12 19:01:48: [retrieval_preprocessing] finished and saved retrieval indices for episode 118 [episode count 12/20]
[retrieval_preprocessing] for episode 119 [episode count 13/20], we have num_retrieval=np.int64(1502) num_query=np.int64(69)
2025-03-12 19:01:48,607 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-12 19:01:48,780 [INFO]: Launching the whole pipeline 03/12/2025, 19:01:48
2025-03-12 19:01:48,781 [INFO]: Reading total number of vectors and dimension 03/12/2025, 19:01:48
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1934.64it/s]
2025-03-12 19:01:48,808 [INFO]: There are 1502 embeddings of dim 49152
2025-03-12 19:01:48,808 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0275 secs
2025-03-12 19:01:48,808 [INFO]: 	Compute estimated construction time of the index 03/12/2025, 19:01:48
2025-03-12 19:01:48,808 [INFO]: 		-> Train: 16.7 minutes
2025-03-12 19:01:48,808 [INFO]: 		-> Add: 0.8 seconds
2025-03-12 19:01:48,808 [INFO]: 		Total: 16.7 minutes
2025-03-12 19:01:48,808 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0001 secs
2025-03-12 19:01:48,808 [INFO]: 	Checking that your have enough memory available to create the index 03/12/2025, 19:01:48
2025-03-12 19:01:48,808 [INFO]: 310.0MB of memory will be needed to build the index (more might be used if you have more)
2025-03-12 19:01:48,808 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0001 secs
2025-03-12 19:01:48,808 [INFO]: 	Selecting most promising index types given data characteristics 03/12/2025, 19:01:48
2025-03-12 19:01:48,809 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-12 19:01:48,809 [INFO]: 	Creating the index 03/12/2025, 19:01:48
2025-03-12 19:01:48,809 [INFO]: 		-> Instanciate the index HNSW15 03/12/2025, 19:01:48
2025-03-12 19:01:48,809 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0008 secs
2025-03-12 19:01:48,810 [INFO]: 		-> Adding the vectors to the index 03/12/2025, 19:01:48
2025-03-12 19:01:48,810 [INFO]: The memory available for adding the vectors is 49.7GB(total available - used by the index)
2025-03-12 19:01:48,810 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/6 [00:00<?, ?it/s] 50%|█████     | 3/6 [00:00<00:00, 26.65it/s]100%|██████████| 6/6 [00:01<00:00,  4.58it/s]100%|██████████| 6/6 [00:01<00:00,  5.22it/s]
2025-03-12 19:01:49,962 [INFO]: 	Computing best hyperparameters for index knn.index 03/12/2025, 19:01:49
2025-03-12 19:02:10,425 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 20.4630 secs
2025-03-12 19:02:10,425 [INFO]: The best hyperparameters are: efSearch=351
2025-03-12 19:02:10,425 [INFO]: 	Compute fast metrics 03/12/2025, 19:02:10
  0%|          | 0/4 [00:00<?, ?it/s] 75%|███████▌  | 3/4 [00:00<00:00, 29.34it/s] 75%|███████▌  | 3/4 [00:00<00:00, 25.59it/s]
2025-03-12 19:02:21,383 [INFO]: 	>>> Finished "Compute fast metrics" in 10.9573 secs
2025-03-12 19:02:21,384 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 32.5742 secs
2025-03-12 19:02:21,384 [INFO]: {
2025-03-12 19:02:21,384 [INFO]: 	index_key: HNSW15
2025-03-12 19:02:21,384 [INFO]: 	index_param: efSearch=351
2025-03-12 19:02:21,384 [INFO]: 	index_path: knn.index
2025-03-12 19:02:21,384 [INFO]: 	size in bytes: 295509490
2025-03-12 19:02:21,384 [INFO]: 	avg_search_speed_ms: 10.124078322567708
2025-03-12 19:02:21,384 [INFO]: 	99p_search_speed_ms: 13.258722014725208
2025-03-12 19:02:21,384 [INFO]: 	reconstruction error %: 0.0
2025-03-12 19:02:21,384 [INFO]: 	nb vectors: 1502
2025-03-12 19:02:21,384 [INFO]: 	vectors dimension: 49152
2025-03-12 19:02:21,384 [INFO]: 	compression ratio: 0.9993087396279557
2025-03-12 19:02:21,384 [INFO]: }
2025-03-12 19:02:21,384 [INFO]: 	>>> Finished "Creating the index" in 32.5753 secs
2025-03-12 19:02:21,384 [INFO]: >>> Finished "Launching the whole pipeline" in 32.6034 secs
2025-03-12 19:02:21: [retrieval_preprocessing] calculating distances ...
2025-03-12 19:02:21: [retrieval_preprocessing] finished and saved retrieval indices for episode 119 [episode count 13/20]
[retrieval_preprocessing] for episode 120 [episode count 14/20], we have num_retrieval=np.int64(1492) num_query=np.int64(79)
2025-03-12 19:02:22,058 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-12 19:02:22,226 [INFO]: Launching the whole pipeline 03/12/2025, 19:02:22
2025-03-12 19:02:22,226 [INFO]: Reading total number of vectors and dimension 03/12/2025, 19:02:22
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 2465.79it/s]
2025-03-12 19:02:22,251 [INFO]: There are 1492 embeddings of dim 49152
2025-03-12 19:02:22,251 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0245 secs
2025-03-12 19:02:22,251 [INFO]: 	Compute estimated construction time of the index 03/12/2025, 19:02:22
2025-03-12 19:02:22,251 [INFO]: 		-> Train: 16.7 minutes
2025-03-12 19:02:22,251 [INFO]: 		-> Add: 0.8 seconds
2025-03-12 19:02:22,251 [INFO]: 		Total: 16.7 minutes
2025-03-12 19:02:22,251 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0001 secs
2025-03-12 19:02:22,251 [INFO]: 	Checking that your have enough memory available to create the index 03/12/2025, 19:02:22
2025-03-12 19:02:22,251 [INFO]: 307.9MB of memory will be needed to build the index (more might be used if you have more)
2025-03-12 19:02:22,251 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0001 secs
2025-03-12 19:02:22,251 [INFO]: 	Selecting most promising index types given data characteristics 03/12/2025, 19:02:22
2025-03-12 19:02:22,252 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-12 19:02:22,252 [INFO]: 	Creating the index 03/12/2025, 19:02:22
2025-03-12 19:02:22,252 [INFO]: 		-> Instanciate the index HNSW15 03/12/2025, 19:02:22
2025-03-12 19:02:22,253 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0009 secs
2025-03-12 19:02:22,253 [INFO]: 		-> Adding the vectors to the index 03/12/2025, 19:02:22
2025-03-12 19:02:22,253 [INFO]: The memory available for adding the vectors is 49.7GB(total available - used by the index)
2025-03-12 19:02:22,253 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/6 [00:00<?, ?it/s] 67%|██████▋   | 4/6 [00:00<00:00, 35.67it/s]100%|██████████| 6/6 [00:01<00:00,  5.65it/s]
2025-03-12 19:02:23,318 [INFO]: 	Computing best hyperparameters for index knn.index 03/12/2025, 19:02:23
2025-03-12 19:02:42,586 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 19.2676 secs
2025-03-12 19:02:42,586 [INFO]: The best hyperparameters are: efSearch=361
2025-03-12 19:02:42,586 [INFO]: 	Compute fast metrics 03/12/2025, 19:02:42
  0%|          | 0/4 [00:00<?, ?it/s] 75%|███████▌  | 3/4 [00:00<00:00, 28.46it/s] 75%|███████▌  | 3/4 [00:00<00:00, 25.23it/s]
2025-03-12 19:02:53,517 [INFO]: 	>>> Finished "Compute fast metrics" in 10.9312 secs
2025-03-12 19:02:53,518 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 31.2653 secs
2025-03-12 19:02:53,518 [INFO]: {
2025-03-12 19:02:53,518 [INFO]: 	index_key: HNSW15
2025-03-12 19:02:53,518 [INFO]: 	index_param: efSearch=361
2025-03-12 19:02:53,518 [INFO]: 	index_path: knn.index
2025-03-12 19:02:53,518 [INFO]: 	size in bytes: 293542090
2025-03-12 19:02:53,518 [INFO]: 	avg_search_speed_ms: 9.916175231365237
2025-03-12 19:02:53,518 [INFO]: 	99p_search_speed_ms: 12.107997527346015
2025-03-12 19:02:53,518 [INFO]: 	reconstruction error %: 0.0
2025-03-12 19:02:53,518 [INFO]: 	nb vectors: 1492
2025-03-12 19:02:53,518 [INFO]: 	vectors dimension: 49152
2025-03-12 19:02:53,518 [INFO]: 	compression ratio: 0.9993086034101617
2025-03-12 19:02:53,518 [INFO]: }
2025-03-12 19:02:53,518 [INFO]: 	>>> Finished "Creating the index" in 31.2667 secs
2025-03-12 19:02:53,518 [INFO]: >>> Finished "Launching the whole pipeline" in 31.2921 secs
2025-03-12 19:02:54: [retrieval_preprocessing] calculating distances ...
2025-03-12 19:02:54: [retrieval_preprocessing] finished and saved retrieval indices for episode 120 [episode count 14/20]
[retrieval_preprocessing] for episode 121 [episode count 15/20], we have num_retrieval=np.int64(1491) num_query=np.int64(80)
2025-03-12 19:02:54,309 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-12 19:02:54,478 [INFO]: Launching the whole pipeline 03/12/2025, 19:02:54
2025-03-12 19:02:54,478 [INFO]: Reading total number of vectors and dimension 03/12/2025, 19:02:54
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1625.70it/s]
2025-03-12 19:02:54,506 [INFO]: There are 1491 embeddings of dim 49152
2025-03-12 19:02:54,506 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0276 secs
2025-03-12 19:02:54,506 [INFO]: 	Compute estimated construction time of the index 03/12/2025, 19:02:54
2025-03-12 19:02:54,506 [INFO]: 		-> Train: 16.7 minutes
2025-03-12 19:02:54,506 [INFO]: 		-> Add: 0.8 seconds
2025-03-12 19:02:54,506 [INFO]: 		Total: 16.7 minutes
2025-03-12 19:02:54,506 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0001 secs
2025-03-12 19:02:54,506 [INFO]: 	Checking that your have enough memory available to create the index 03/12/2025, 19:02:54
2025-03-12 19:02:54,506 [INFO]: 307.7MB of memory will be needed to build the index (more might be used if you have more)
2025-03-12 19:02:54,506 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0002 secs
2025-03-12 19:02:54,507 [INFO]: 	Selecting most promising index types given data characteristics 03/12/2025, 19:02:54
2025-03-12 19:02:54,507 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-12 19:02:54,507 [INFO]: 	Creating the index 03/12/2025, 19:02:54
2025-03-12 19:02:54,507 [INFO]: 		-> Instanciate the index HNSW15 03/12/2025, 19:02:54
2025-03-12 19:02:54,508 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0009 secs
2025-03-12 19:02:54,508 [INFO]: 		-> Adding the vectors to the index 03/12/2025, 19:02:54
2025-03-12 19:02:54,508 [INFO]: The memory available for adding the vectors is 49.7GB(total available - used by the index)
2025-03-12 19:02:54,508 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/6 [00:00<?, ?it/s] 50%|█████     | 3/6 [00:00<00:00, 29.38it/s]100%|██████████| 6/6 [00:01<00:00,  4.98it/s]100%|██████████| 6/6 [00:01<00:00,  5.69it/s]
2025-03-12 19:02:55,566 [INFO]: 	Computing best hyperparameters for index knn.index 03/12/2025, 19:02:55
2025-03-12 19:03:15,748 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 20.1809 secs
2025-03-12 19:03:15,748 [INFO]: The best hyperparameters are: efSearch=348
2025-03-12 19:03:15,748 [INFO]: 	Compute fast metrics 03/12/2025, 19:03:15
  0%|          | 0/4 [00:00<?, ?it/s] 75%|███████▌  | 3/4 [00:00<00:00, 29.67it/s] 75%|███████▌  | 3/4 [00:00<00:00, 26.15it/s]
2025-03-12 19:03:26,673 [INFO]: 	>>> Finished "Compute fast metrics" in 10.9241 secs
2025-03-12 19:03:26,674 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 32.1658 secs
2025-03-12 19:03:26,674 [INFO]: {
2025-03-12 19:03:26,674 [INFO]: 	index_key: HNSW15
2025-03-12 19:03:26,674 [INFO]: 	index_param: efSearch=348
2025-03-12 19:03:26,674 [INFO]: 	index_path: knn.index
2025-03-12 19:03:26,674 [INFO]: 	size in bytes: 293345350
2025-03-12 19:03:26,674 [INFO]: 	avg_search_speed_ms: 9.660150689311362
2025-03-12 19:03:26,674 [INFO]: 	99p_search_speed_ms: 11.795567399822174
2025-03-12 19:03:26,674 [INFO]: 	reconstruction error %: 0.0
2025-03-12 19:03:26,674 [INFO]: 	nb vectors: 1491
2025-03-12 19:03:26,674 [INFO]: 	vectors dimension: 49152
2025-03-12 19:03:26,674 [INFO]: 	compression ratio: 0.9993085896878884
2025-03-12 19:03:26,674 [INFO]: }
2025-03-12 19:03:26,674 [INFO]: 	>>> Finished "Creating the index" in 32.1671 secs
2025-03-12 19:03:26,674 [INFO]: >>> Finished "Launching the whole pipeline" in 32.1957 secs
2025-03-12 19:03:27: [retrieval_preprocessing] calculating distances ...
2025-03-12 19:03:27: [retrieval_preprocessing] finished and saved retrieval indices for episode 121 [episode count 15/20]
[retrieval_preprocessing] for episode 122 [episode count 16/20], we have num_retrieval=np.int64(1487) num_query=np.int64(84)
2025-03-12 19:03:27,466 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-12 19:03:27,640 [INFO]: Launching the whole pipeline 03/12/2025, 19:03:27
2025-03-12 19:03:27,640 [INFO]: Reading total number of vectors and dimension 03/12/2025, 19:03:27
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 2039.04it/s]
2025-03-12 19:03:27,666 [INFO]: There are 1487 embeddings of dim 49152
2025-03-12 19:03:27,667 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0263 secs
2025-03-12 19:03:27,667 [INFO]: 	Compute estimated construction time of the index 03/12/2025, 19:03:27
2025-03-12 19:03:27,667 [INFO]: 		-> Train: 16.7 minutes
2025-03-12 19:03:27,667 [INFO]: 		-> Add: 0.8 seconds
2025-03-12 19:03:27,667 [INFO]: 		Total: 16.7 minutes
2025-03-12 19:03:27,667 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0001 secs
2025-03-12 19:03:27,667 [INFO]: 	Checking that your have enough memory available to create the index 03/12/2025, 19:03:27
2025-03-12 19:03:27,667 [INFO]: 306.9MB of memory will be needed to build the index (more might be used if you have more)
2025-03-12 19:03:27,667 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0001 secs
2025-03-12 19:03:27,667 [INFO]: 	Selecting most promising index types given data characteristics 03/12/2025, 19:03:27
2025-03-12 19:03:27,667 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-12 19:03:27,667 [INFO]: 	Creating the index 03/12/2025, 19:03:27
2025-03-12 19:03:27,667 [INFO]: 		-> Instanciate the index HNSW15 03/12/2025, 19:03:27
2025-03-12 19:03:27,668 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0008 secs
2025-03-12 19:03:27,668 [INFO]: 		-> Adding the vectors to the index 03/12/2025, 19:03:27
2025-03-12 19:03:27,668 [INFO]: The memory available for adding the vectors is 49.7GB(total available - used by the index)
2025-03-12 19:03:27,668 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/6 [00:00<?, ?it/s] 50%|█████     | 3/6 [00:00<00:00, 28.87it/s]100%|██████████| 6/6 [00:01<00:00,  4.98it/s]100%|██████████| 6/6 [00:01<00:00,  5.68it/s]
2025-03-12 19:03:28,728 [INFO]: 	Computing best hyperparameters for index knn.index 03/12/2025, 19:03:28
2025-03-12 19:03:48,236 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 19.5075 secs
2025-03-12 19:03:48,236 [INFO]: The best hyperparameters are: efSearch=348
2025-03-12 19:03:48,236 [INFO]: 	Compute fast metrics 03/12/2025, 19:03:48
  0%|          | 0/4 [00:00<?, ?it/s] 75%|███████▌  | 3/4 [00:00<00:00, 27.91it/s] 75%|███████▌  | 3/4 [00:00<00:00, 24.86it/s]
2025-03-12 19:03:59,143 [INFO]: 	>>> Finished "Compute fast metrics" in 10.9068 secs
2025-03-12 19:03:59,144 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 31.4757 secs
2025-03-12 19:03:59,144 [INFO]: {
2025-03-12 19:03:59,144 [INFO]: 	index_key: HNSW15
2025-03-12 19:03:59,144 [INFO]: 	index_param: efSearch=348
2025-03-12 19:03:59,144 [INFO]: 	index_path: knn.index
2025-03-12 19:03:59,144 [INFO]: 	size in bytes: 292558390
2025-03-12 19:03:59,144 [INFO]: 	avg_search_speed_ms: 9.688174956461934
2025-03-12 19:03:59,144 [INFO]: 	99p_search_speed_ms: 11.919716040138155
2025-03-12 19:03:59,144 [INFO]: 	reconstruction error %: 0.0
2025-03-12 19:03:59,144 [INFO]: 	nb vectors: 1487
2025-03-12 19:03:59,144 [INFO]: 	vectors dimension: 49152
2025-03-12 19:03:59,144 [INFO]: 	compression ratio: 0.9993085346142355
2025-03-12 19:03:59,144 [INFO]: }
2025-03-12 19:03:59,144 [INFO]: 	>>> Finished "Creating the index" in 31.4769 secs
2025-03-12 19:03:59,144 [INFO]: >>> Finished "Launching the whole pipeline" in 31.5039 secs
2025-03-12 19:03:59: [retrieval_preprocessing] calculating distances ...
2025-03-12 19:03:59: [retrieval_preprocessing] finished and saved retrieval indices for episode 122 [episode count 16/20]
[retrieval_preprocessing] for episode 123 [episode count 17/20], we have num_retrieval=np.int64(1482) num_query=np.int64(89)
2025-03-12 19:03:59,944 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-12 19:04:00,112 [INFO]: Launching the whole pipeline 03/12/2025, 19:04:00
2025-03-12 19:04:00,112 [INFO]: Reading total number of vectors and dimension 03/12/2025, 19:04:00
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1914.33it/s]
2025-03-12 19:04:00,139 [INFO]: There are 1482 embeddings of dim 49152
2025-03-12 19:04:00,139 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0272 secs
2025-03-12 19:04:00,139 [INFO]: 	Compute estimated construction time of the index 03/12/2025, 19:04:00
2025-03-12 19:04:00,139 [INFO]: 		-> Train: 16.7 minutes
2025-03-12 19:04:00,139 [INFO]: 		-> Add: 0.8 seconds
2025-03-12 19:04:00,139 [INFO]: 		Total: 16.7 minutes
2025-03-12 19:04:00,139 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0001 secs
2025-03-12 19:04:00,139 [INFO]: 	Checking that your have enough memory available to create the index 03/12/2025, 19:04:00
2025-03-12 19:04:00,139 [INFO]: 305.8MB of memory will be needed to build the index (more might be used if you have more)
2025-03-12 19:04:00,140 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0001 secs
2025-03-12 19:04:00,140 [INFO]: 	Selecting most promising index types given data characteristics 03/12/2025, 19:04:00
2025-03-12 19:04:00,140 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-12 19:04:00,140 [INFO]: 	Creating the index 03/12/2025, 19:04:00
2025-03-12 19:04:00,140 [INFO]: 		-> Instanciate the index HNSW15 03/12/2025, 19:04:00
2025-03-12 19:04:00,141 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0009 secs
2025-03-12 19:04:00,141 [INFO]: 		-> Adding the vectors to the index 03/12/2025, 19:04:00
2025-03-12 19:04:00,141 [INFO]: The memory available for adding the vectors is 49.7GB(total available - used by the index)
2025-03-12 19:04:00,141 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/6 [00:00<?, ?it/s] 50%|█████     | 3/6 [00:00<00:00, 27.91it/s]100%|██████████| 6/6 [00:01<00:00,  4.87it/s]100%|██████████| 6/6 [00:01<00:00,  5.55it/s]
2025-03-12 19:04:01,224 [INFO]: 	Computing best hyperparameters for index knn.index 03/12/2025, 19:04:01
2025-03-12 19:04:20,420 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 19.1950 secs
2025-03-12 19:04:20,420 [INFO]: The best hyperparameters are: efSearch=370
2025-03-12 19:04:20,420 [INFO]: 	Compute fast metrics 03/12/2025, 19:04:20
  0%|          | 0/4 [00:00<?, ?it/s] 75%|███████▌  | 3/4 [00:00<00:00, 29.87it/s] 75%|███████▌  | 3/4 [00:00<00:00, 26.45it/s]
2025-03-12 19:04:31,371 [INFO]: 	>>> Finished "Compute fast metrics" in 10.9507 secs
2025-03-12 19:04:31,372 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 31.2309 secs
2025-03-12 19:04:31,372 [INFO]: {
2025-03-12 19:04:31,372 [INFO]: 	index_key: HNSW15
2025-03-12 19:04:31,372 [INFO]: 	index_param: efSearch=370
2025-03-12 19:04:31,372 [INFO]: 	index_path: knn.index
2025-03-12 19:04:31,372 [INFO]: 	size in bytes: 291574690
2025-03-12 19:04:31,372 [INFO]: 	avg_search_speed_ms: 10.078723766773399
2025-03-12 19:04:31,372 [INFO]: 	99p_search_speed_ms: 12.291196628939362
2025-03-12 19:04:31,372 [INFO]: 	reconstruction error %: 0.0
2025-03-12 19:04:31,372 [INFO]: 	nb vectors: 1482
2025-03-12 19:04:31,372 [INFO]: 	vectors dimension: 49152
2025-03-12 19:04:31,372 [INFO]: 	compression ratio: 0.9993084653541088
2025-03-12 19:04:31,372 [INFO]: }
2025-03-12 19:04:31,372 [INFO]: 	>>> Finished "Creating the index" in 31.2322 secs
2025-03-12 19:04:31,372 [INFO]: >>> Finished "Launching the whole pipeline" in 31.2600 secs
2025-03-12 19:04:31: [retrieval_preprocessing] calculating distances ...
2025-03-12 19:04:32: [retrieval_preprocessing] finished and saved retrieval indices for episode 123 [episode count 17/20]
[retrieval_preprocessing] for episode 124 [episode count 18/20], we have num_retrieval=np.int64(1492) num_query=np.int64(79)
2025-03-12 19:04:32,179 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-12 19:04:32,349 [INFO]: Launching the whole pipeline 03/12/2025, 19:04:32
2025-03-12 19:04:32,349 [INFO]: Reading total number of vectors and dimension 03/12/2025, 19:04:32
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 2042.02it/s]
2025-03-12 19:04:32,375 [INFO]: There are 1492 embeddings of dim 49152
2025-03-12 19:04:32,375 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0258 secs
2025-03-12 19:04:32,375 [INFO]: 	Compute estimated construction time of the index 03/12/2025, 19:04:32
2025-03-12 19:04:32,375 [INFO]: 		-> Train: 16.7 minutes
2025-03-12 19:04:32,375 [INFO]: 		-> Add: 0.8 seconds
2025-03-12 19:04:32,375 [INFO]: 		Total: 16.7 minutes
2025-03-12 19:04:32,375 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0001 secs
2025-03-12 19:04:32,375 [INFO]: 	Checking that your have enough memory available to create the index 03/12/2025, 19:04:32
2025-03-12 19:04:32,375 [INFO]: 307.9MB of memory will be needed to build the index (more might be used if you have more)
2025-03-12 19:04:32,375 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0001 secs
2025-03-12 19:04:32,375 [INFO]: 	Selecting most promising index types given data characteristics 03/12/2025, 19:04:32
2025-03-12 19:04:32,375 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-12 19:04:32,375 [INFO]: 	Creating the index 03/12/2025, 19:04:32
2025-03-12 19:04:32,375 [INFO]: 		-> Instanciate the index HNSW15 03/12/2025, 19:04:32
2025-03-12 19:04:32,376 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0010 secs
2025-03-12 19:04:32,376 [INFO]: 		-> Adding the vectors to the index 03/12/2025, 19:04:32
2025-03-12 19:04:32,376 [INFO]: The memory available for adding the vectors is 49.7GB(total available - used by the index)
2025-03-12 19:04:32,377 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/6 [00:00<?, ?it/s] 50%|█████     | 3/6 [00:00<00:00, 29.97it/s]100%|██████████| 6/6 [00:01<00:00,  4.89it/s]100%|██████████| 6/6 [00:01<00:00,  5.59it/s]
2025-03-12 19:04:33,453 [INFO]: 	Computing best hyperparameters for index knn.index 03/12/2025, 19:04:33
2025-03-12 19:04:53,622 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 20.1687 secs
2025-03-12 19:04:53,622 [INFO]: The best hyperparameters are: efSearch=350
2025-03-12 19:04:53,623 [INFO]: 	Compute fast metrics 03/12/2025, 19:04:53
  0%|          | 0/4 [00:00<?, ?it/s] 75%|███████▌  | 3/4 [00:00<00:00, 29.72it/s] 75%|███████▌  | 3/4 [00:00<00:00, 26.20it/s]
2025-03-12 19:05:04,565 [INFO]: 	>>> Finished "Compute fast metrics" in 10.9421 secs
2025-03-12 19:05:04,566 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 32.1894 secs
2025-03-12 19:05:04,566 [INFO]: {
2025-03-12 19:05:04,566 [INFO]: 	index_key: HNSW15
2025-03-12 19:05:04,566 [INFO]: 	index_param: efSearch=350
2025-03-12 19:05:04,566 [INFO]: 	index_path: knn.index
2025-03-12 19:05:04,566 [INFO]: 	size in bytes: 293542090
2025-03-12 19:05:04,566 [INFO]: 	avg_search_speed_ms: 9.818096064128003
2025-03-12 19:05:04,566 [INFO]: 	99p_search_speed_ms: 12.187321842648087
2025-03-12 19:05:04,566 [INFO]: 	reconstruction error %: 0.0
2025-03-12 19:05:04,566 [INFO]: 	nb vectors: 1492
2025-03-12 19:05:04,566 [INFO]: 	vectors dimension: 49152
2025-03-12 19:05:04,566 [INFO]: 	compression ratio: 0.9993086034101617
2025-03-12 19:05:04,566 [INFO]: }
2025-03-12 19:05:04,566 [INFO]: 	>>> Finished "Creating the index" in 32.1908 secs
2025-03-12 19:05:04,566 [INFO]: >>> Finished "Launching the whole pipeline" in 32.2172 secs
2025-03-12 19:05:05: [retrieval_preprocessing] calculating distances ...
2025-03-12 19:05:05: [retrieval_preprocessing] finished and saved retrieval indices for episode 124 [episode count 18/20]
[retrieval_preprocessing] for episode 125 [episode count 19/20], we have num_retrieval=np.int64(1480) num_query=np.int64(91)
2025-03-12 19:05:05,309 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-12 19:05:05,480 [INFO]: Launching the whole pipeline 03/12/2025, 19:05:05
2025-03-12 19:05:05,480 [INFO]: Reading total number of vectors and dimension 03/12/2025, 19:05:05
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1626.96it/s]
2025-03-12 19:05:05,508 [INFO]: There are 1480 embeddings of dim 49152
2025-03-12 19:05:05,508 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0279 secs
2025-03-12 19:05:05,508 [INFO]: 	Compute estimated construction time of the index 03/12/2025, 19:05:05
2025-03-12 19:05:05,508 [INFO]: 		-> Train: 16.7 minutes
2025-03-12 19:05:05,508 [INFO]: 		-> Add: 0.8 seconds
2025-03-12 19:05:05,508 [INFO]: 		Total: 16.7 minutes
2025-03-12 19:05:05,508 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0001 secs
2025-03-12 19:05:05,509 [INFO]: 	Checking that your have enough memory available to create the index 03/12/2025, 19:05:05
2025-03-12 19:05:05,509 [INFO]: 305.4MB of memory will be needed to build the index (more might be used if you have more)
2025-03-12 19:05:05,509 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0001 secs
2025-03-12 19:05:05,509 [INFO]: 	Selecting most promising index types given data characteristics 03/12/2025, 19:05:05
2025-03-12 19:05:05,509 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-12 19:05:05,509 [INFO]: 	Creating the index 03/12/2025, 19:05:05
2025-03-12 19:05:05,509 [INFO]: 		-> Instanciate the index HNSW15 03/12/2025, 19:05:05
2025-03-12 19:05:05,510 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0010 secs
2025-03-12 19:05:05,510 [INFO]: 		-> Adding the vectors to the index 03/12/2025, 19:05:05
2025-03-12 19:05:05,510 [INFO]: The memory available for adding the vectors is 49.7GB(total available - used by the index)
2025-03-12 19:05:05,510 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/6 [00:00<?, ?it/s] 50%|█████     | 3/6 [00:00<00:00, 28.40it/s]100%|██████████| 6/6 [00:01<00:00,  4.54it/s]100%|██████████| 6/6 [00:01<00:00,  5.19it/s]
2025-03-12 19:05:06,669 [INFO]: 	Computing best hyperparameters for index knn.index 03/12/2025, 19:05:06
2025-03-12 19:05:27,321 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 20.6513 secs
2025-03-12 19:05:27,321 [INFO]: The best hyperparameters are: efSearch=341
2025-03-12 19:05:27,321 [INFO]: 	Compute fast metrics 03/12/2025, 19:05:27
  0%|          | 0/4 [00:00<?, ?it/s] 75%|███████▌  | 3/4 [00:00<00:00, 28.89it/s] 75%|███████▌  | 3/4 [00:00<00:00, 25.59it/s]
2025-03-12 19:05:38,220 [INFO]: 	>>> Finished "Compute fast metrics" in 10.8984 secs
2025-03-12 19:05:38,221 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 32.7107 secs
2025-03-12 19:05:38,221 [INFO]: {
2025-03-12 19:05:38,221 [INFO]: 	index_key: HNSW15
2025-03-12 19:05:38,221 [INFO]: 	index_param: efSearch=341
2025-03-12 19:05:38,221 [INFO]: 	index_path: knn.index
2025-03-12 19:05:38,221 [INFO]: 	size in bytes: 291181150
2025-03-12 19:05:38,221 [INFO]: 	avg_search_speed_ms: 9.861840650896658
2025-03-12 19:05:38,221 [INFO]: 	99p_search_speed_ms: 12.064667062368244
2025-03-12 19:05:38,221 [INFO]: 	reconstruction error %: 0.0
2025-03-12 19:05:38,221 [INFO]: 	nb vectors: 1480
2025-03-12 19:05:38,221 [INFO]: 	vectors dimension: 49152
2025-03-12 19:05:38,221 [INFO]: 	compression ratio: 0.9993086434338212
2025-03-12 19:05:38,221 [INFO]: }
2025-03-12 19:05:38,221 [INFO]: 	>>> Finished "Creating the index" in 32.7121 secs
2025-03-12 19:05:38,221 [INFO]: >>> Finished "Launching the whole pipeline" in 32.7406 secs
2025-03-12 19:05:38: [retrieval_preprocessing] calculating distances ...
2025-03-12 19:05:38: [retrieval_preprocessing] finished and saved retrieval indices for episode 125 [episode count 19/20]
2025-03-12 19:05:38: [retrieval_preprocessing] finished for collected_demos_training/2025-03-10_move_watermelon_to_the_right [chosen_id count 6/8]
2025-03-12 19:05:39: [retrieval_preprocessing] concatenated all embeddings and indices for 20 episodes for collected_demos_training/2025-03-10_pick_up_the_orange_in_the_bowl_and_move_it_to_the_other_container [chosen_id count 7/8]
2025-03-12 19:05:39: [retrieval_preprocessing] we have num_total=2036 embedding_dim=49152
[retrieval_preprocessing] for episode 126 [episode count 0/20], we have num_retrieval=np.int64(1946) num_query=np.int64(90)
2025-03-12 19:05:39,444 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-12 19:05:39,667 [INFO]: Launching the whole pipeline 03/12/2025, 19:05:39
2025-03-12 19:05:39,667 [INFO]: Reading total number of vectors and dimension 03/12/2025, 19:05:39
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 2448.51it/s]
2025-03-12 19:05:39,691 [INFO]: There are 1946 embeddings of dim 49152
2025-03-12 19:05:39,691 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0239 secs
2025-03-12 19:05:39,691 [INFO]: 	Compute estimated construction time of the index 03/12/2025, 19:05:39
2025-03-12 19:05:39,691 [INFO]: 		-> Train: 16.7 minutes
2025-03-12 19:05:39,692 [INFO]: 		-> Add: 1.1 seconds
2025-03-12 19:05:39,692 [INFO]: 		Total: 16.7 minutes
2025-03-12 19:05:39,692 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0001 secs
2025-03-12 19:05:39,692 [INFO]: 	Checking that your have enough memory available to create the index 03/12/2025, 19:05:39
2025-03-12 19:05:39,692 [INFO]: 401.6MB of memory will be needed to build the index (more might be used if you have more)
2025-03-12 19:05:39,692 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0001 secs
2025-03-12 19:05:39,692 [INFO]: 	Selecting most promising index types given data characteristics 03/12/2025, 19:05:39
2025-03-12 19:05:39,692 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-12 19:05:39,692 [INFO]: 	Creating the index 03/12/2025, 19:05:39
2025-03-12 19:05:39,692 [INFO]: 		-> Instanciate the index HNSW15 03/12/2025, 19:05:39
2025-03-12 19:05:39,693 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0008 secs
2025-03-12 19:05:39,693 [INFO]: 		-> Adding the vectors to the index 03/12/2025, 19:05:39
2025-03-12 19:05:39,693 [INFO]: The memory available for adding the vectors is 49.6GB(total available - used by the index)
2025-03-12 19:05:39,693 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/8 [00:00<?, ?it/s] 25%|██▌       | 2/8 [00:00<00:00, 18.43it/s]100%|██████████| 8/8 [00:01<00:00,  5.83it/s]100%|██████████| 8/8 [00:01<00:00,  6.14it/s]
2025-03-12 19:05:40,999 [INFO]: 	Computing best hyperparameters for index knn.index 03/12/2025, 19:05:40
2025-03-12 19:06:01,658 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 20.6589 secs
2025-03-12 19:06:01,659 [INFO]: The best hyperparameters are: efSearch=277
2025-03-12 19:06:01,659 [INFO]: 	Compute fast metrics 03/12/2025, 19:06:01
  0%|          | 0/4 [00:00<?, ?it/s] 75%|███████▌  | 3/4 [00:00<00:00, 29.08it/s] 75%|███████▌  | 3/4 [00:00<00:00, 25.59it/s]
2025-03-12 19:06:12,746 [INFO]: 	>>> Finished "Compute fast metrics" in 11.0871 secs
2025-03-12 19:06:12,747 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 33.0540 secs
2025-03-12 19:06:12,747 [INFO]: {
2025-03-12 19:06:12,747 [INFO]: 	index_key: HNSW15
2025-03-12 19:06:12,747 [INFO]: 	index_param: efSearch=277
2025-03-12 19:06:12,747 [INFO]: 	index_path: knn.index
2025-03-12 19:06:12,747 [INFO]: 	size in bytes: 382863910
2025-03-12 19:06:12,747 [INFO]: 	avg_search_speed_ms: 9.336306771566095
2025-03-12 19:06:12,747 [INFO]: 	99p_search_speed_ms: 12.039465829730032
2025-03-12 19:06:12,747 [INFO]: 	reconstruction error %: 0.0
2025-03-12 19:06:12,747 [INFO]: 	nb vectors: 1946
2025-03-12 19:06:12,747 [INFO]: 	vectors dimension: 49152
2025-03-12 19:06:12,747 [INFO]: 	compression ratio: 0.9993085219236255
2025-03-12 19:06:12,747 [INFO]: }
2025-03-12 19:06:12,747 [INFO]: 	>>> Finished "Creating the index" in 33.0553 secs
2025-03-12 19:06:12,747 [INFO]: >>> Finished "Launching the whole pipeline" in 33.0797 secs
2025-03-12 19:06:13: [retrieval_preprocessing] calculating distances ...
2025-03-12 19:06:13: [retrieval_preprocessing] finished and saved retrieval indices for episode 126 [episode count 0/20]
[retrieval_preprocessing] for episode 127 [episode count 1/20], we have num_retrieval=np.int64(1880) num_query=np.int64(156)
2025-03-12 19:06:13,601 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-12 19:06:13,816 [INFO]: Launching the whole pipeline 03/12/2025, 19:06:13
2025-03-12 19:06:13,816 [INFO]: Reading total number of vectors and dimension 03/12/2025, 19:06:13
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1809.45it/s]
2025-03-12 19:06:13,845 [INFO]: There are 1880 embeddings of dim 49152
2025-03-12 19:06:13,845 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0289 secs
2025-03-12 19:06:13,845 [INFO]: 	Compute estimated construction time of the index 03/12/2025, 19:06:13
2025-03-12 19:06:13,845 [INFO]: 		-> Train: 16.7 minutes
2025-03-12 19:06:13,845 [INFO]: 		-> Add: 1.0 seconds
2025-03-12 19:06:13,845 [INFO]: 		Total: 16.7 minutes
2025-03-12 19:06:13,845 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0001 secs
2025-03-12 19:06:13,845 [INFO]: 	Checking that your have enough memory available to create the index 03/12/2025, 19:06:13
2025-03-12 19:06:13,845 [INFO]: 388.0MB of memory will be needed to build the index (more might be used if you have more)
2025-03-12 19:06:13,845 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0001 secs
2025-03-12 19:06:13,845 [INFO]: 	Selecting most promising index types given data characteristics 03/12/2025, 19:06:13
2025-03-12 19:06:13,846 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-12 19:06:13,846 [INFO]: 	Creating the index 03/12/2025, 19:06:13
2025-03-12 19:06:13,846 [INFO]: 		-> Instanciate the index HNSW15 03/12/2025, 19:06:13
2025-03-12 19:06:13,846 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0008 secs
2025-03-12 19:06:13,846 [INFO]: 		-> Adding the vectors to the index 03/12/2025, 19:06:13
2025-03-12 19:06:13,847 [INFO]: The memory available for adding the vectors is 49.7GB(total available - used by the index)
2025-03-12 19:06:13,847 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/8 [00:00<?, ?it/s] 38%|███▊      | 3/8 [00:00<00:00, 27.40it/s]100%|██████████| 8/8 [00:01<00:00,  5.95it/s]100%|██████████| 8/8 [00:01<00:00,  6.51it/s]
2025-03-12 19:06:15,077 [INFO]: 	Computing best hyperparameters for index knn.index 03/12/2025, 19:06:15
2025-03-12 19:06:33,975 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 18.8974 secs
2025-03-12 19:06:33,975 [INFO]: The best hyperparameters are: efSearch=315
2025-03-12 19:06:33,975 [INFO]: 	Compute fast metrics 03/12/2025, 19:06:33
  0%|          | 0/4 [00:00<?, ?it/s] 75%|███████▌  | 3/4 [00:00<00:00, 29.45it/s] 75%|███████▌  | 3/4 [00:00<00:00, 25.98it/s]
2025-03-12 19:06:45,037 [INFO]: 	>>> Finished "Compute fast metrics" in 11.0620 secs
2025-03-12 19:06:45,038 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 31.1918 secs
2025-03-12 19:06:45,038 [INFO]: {
2025-03-12 19:06:45,038 [INFO]: 	index_key: HNSW15
2025-03-12 19:06:45,038 [INFO]: 	index_param: efSearch=315
2025-03-12 19:06:45,038 [INFO]: 	index_path: knn.index
2025-03-12 19:06:45,038 [INFO]: 	size in bytes: 369878770
2025-03-12 19:06:45,038 [INFO]: 	avg_search_speed_ms: 9.433045497664935
2025-03-12 19:06:45,038 [INFO]: 	99p_search_speed_ms: 12.070318174082786
2025-03-12 19:06:45,039 [INFO]: 	reconstruction error %: 0.0
2025-03-12 19:06:45,039 [INFO]: 	nb vectors: 1880
2025-03-12 19:06:45,039 [INFO]: 	vectors dimension: 49152
2025-03-12 19:06:45,039 [INFO]: 	compression ratio: 0.9993086113052663
2025-03-12 19:06:45,039 [INFO]: }
2025-03-12 19:06:45,039 [INFO]: 	>>> Finished "Creating the index" in 31.1930 secs
2025-03-12 19:06:45,039 [INFO]: >>> Finished "Launching the whole pipeline" in 31.2223 secs
2025-03-12 19:06:46: [retrieval_preprocessing] calculating distances ...
2025-03-12 19:06:46: [retrieval_preprocessing] finished and saved retrieval indices for episode 127 [episode count 1/20]
[retrieval_preprocessing] for episode 128 [episode count 2/20], we have num_retrieval=np.int64(1953) num_query=np.int64(83)
2025-03-12 19:06:46,546 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-12 19:06:46,767 [INFO]: Launching the whole pipeline 03/12/2025, 19:06:46
2025-03-12 19:06:46,768 [INFO]: Reading total number of vectors and dimension 03/12/2025, 19:06:46
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 2394.01it/s]
2025-03-12 19:06:46,794 [INFO]: There are 1953 embeddings of dim 49152
2025-03-12 19:06:46,794 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0262 secs
2025-03-12 19:06:46,794 [INFO]: 	Compute estimated construction time of the index 03/12/2025, 19:06:46
2025-03-12 19:06:46,794 [INFO]: 		-> Train: 16.7 minutes
2025-03-12 19:06:46,794 [INFO]: 		-> Add: 1.1 seconds
2025-03-12 19:06:46,794 [INFO]: 		Total: 16.7 minutes
2025-03-12 19:06:46,794 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0001 secs
2025-03-12 19:06:46,794 [INFO]: 	Checking that your have enough memory available to create the index 03/12/2025, 19:06:46
2025-03-12 19:06:46,794 [INFO]: 403.1MB of memory will be needed to build the index (more might be used if you have more)
2025-03-12 19:06:46,794 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0001 secs
2025-03-12 19:06:46,794 [INFO]: 	Selecting most promising index types given data characteristics 03/12/2025, 19:06:46
2025-03-12 19:06:46,794 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-12 19:06:46,794 [INFO]: 	Creating the index 03/12/2025, 19:06:46
2025-03-12 19:06:46,794 [INFO]: 		-> Instanciate the index HNSW15 03/12/2025, 19:06:46
2025-03-12 19:06:46,795 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0009 secs
2025-03-12 19:06:46,795 [INFO]: 		-> Adding the vectors to the index 03/12/2025, 19:06:46
2025-03-12 19:06:46,795 [INFO]: The memory available for adding the vectors is 49.6GB(total available - used by the index)
2025-03-12 19:06:46,795 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/8 [00:00<?, ?it/s] 38%|███▊      | 3/8 [00:00<00:00, 27.32it/s]100%|██████████| 8/8 [00:01<00:00,  5.59it/s]100%|██████████| 8/8 [00:01<00:00,  6.12it/s]
2025-03-12 19:06:48,106 [INFO]: 	Computing best hyperparameters for index knn.index 03/12/2025, 19:06:48
2025-03-12 19:07:08,045 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 19.9386 secs
2025-03-12 19:07:08,045 [INFO]: The best hyperparameters are: efSearch=284
2025-03-12 19:07:08,045 [INFO]: 	Compute fast metrics 03/12/2025, 19:07:08
  0%|          | 0/4 [00:00<?, ?it/s] 75%|███████▌  | 3/4 [00:00<00:00, 27.76it/s] 75%|███████▌  | 3/4 [00:00<00:00, 24.36it/s]
2025-03-12 19:07:19,128 [INFO]: 	>>> Finished "Compute fast metrics" in 11.0829 secs
2025-03-12 19:07:19,129 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 32.3340 secs
2025-03-12 19:07:19,130 [INFO]: {
2025-03-12 19:07:19,130 [INFO]: 	index_key: HNSW15
2025-03-12 19:07:19,130 [INFO]: 	index_param: efSearch=284
2025-03-12 19:07:19,130 [INFO]: 	index_path: knn.index
2025-03-12 19:07:19,130 [INFO]: 	size in bytes: 384241090
2025-03-12 19:07:19,130 [INFO]: 	avg_search_speed_ms: 9.193033244681668
2025-03-12 19:07:19,130 [INFO]: 	99p_search_speed_ms: 12.004996582400052
2025-03-12 19:07:19,130 [INFO]: 	reconstruction error %: 0.0
2025-03-12 19:07:19,130 [INFO]: 	nb vectors: 1953
2025-03-12 19:07:19,130 [INFO]: 	vectors dimension: 49152
2025-03-12 19:07:19,130 [INFO]: 	compression ratio: 0.9993085955486958
2025-03-12 19:07:19,130 [INFO]: }
2025-03-12 19:07:19,130 [INFO]: 	>>> Finished "Creating the index" in 32.3356 secs
2025-03-12 19:07:19,130 [INFO]: >>> Finished "Launching the whole pipeline" in 32.3623 secs
2025-03-12 19:07:19: [retrieval_preprocessing] calculating distances ...
2025-03-12 19:07:19: [retrieval_preprocessing] finished and saved retrieval indices for episode 128 [episode count 2/20]
[retrieval_preprocessing] for episode 129 [episode count 3/20], we have num_retrieval=np.int64(1936) num_query=np.int64(100)
2025-03-12 19:07:19,952 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-12 19:07:20,174 [INFO]: Launching the whole pipeline 03/12/2025, 19:07:20
2025-03-12 19:07:20,174 [INFO]: Reading total number of vectors and dimension 03/12/2025, 19:07:20
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 2381.77it/s]
2025-03-12 19:07:20,200 [INFO]: There are 1936 embeddings of dim 49152
2025-03-12 19:07:20,201 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0265 secs
2025-03-12 19:07:20,201 [INFO]: 	Compute estimated construction time of the index 03/12/2025, 19:07:20
2025-03-12 19:07:20,201 [INFO]: 		-> Train: 16.7 minutes
2025-03-12 19:07:20,201 [INFO]: 		-> Add: 1.1 seconds
2025-03-12 19:07:20,201 [INFO]: 		Total: 16.7 minutes
2025-03-12 19:07:20,201 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0001 secs
2025-03-12 19:07:20,201 [INFO]: 	Checking that your have enough memory available to create the index 03/12/2025, 19:07:20
2025-03-12 19:07:20,201 [INFO]: 399.5MB of memory will be needed to build the index (more might be used if you have more)
2025-03-12 19:07:20,201 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0001 secs
2025-03-12 19:07:20,201 [INFO]: 	Selecting most promising index types given data characteristics 03/12/2025, 19:07:20
2025-03-12 19:07:20,201 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-12 19:07:20,201 [INFO]: 	Creating the index 03/12/2025, 19:07:20
2025-03-12 19:07:20,201 [INFO]: 		-> Instanciate the index HNSW15 03/12/2025, 19:07:20
2025-03-12 19:07:20,202 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0008 secs
2025-03-12 19:07:20,202 [INFO]: 		-> Adding the vectors to the index 03/12/2025, 19:07:20
2025-03-12 19:07:20,202 [INFO]: The memory available for adding the vectors is 49.6GB(total available - used by the index)
2025-03-12 19:07:20,202 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/8 [00:00<?, ?it/s] 25%|██▌       | 2/8 [00:00<00:00, 18.92it/s]100%|██████████| 8/8 [00:01<00:00,  5.84it/s]100%|██████████| 8/8 [00:01<00:00,  6.15it/s]
2025-03-12 19:07:21,504 [INFO]: 	Computing best hyperparameters for index knn.index 03/12/2025, 19:07:21
2025-03-12 19:07:40,724 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 19.2194 secs
2025-03-12 19:07:40,724 [INFO]: The best hyperparameters are: efSearch=322
2025-03-12 19:07:40,724 [INFO]: 	Compute fast metrics 03/12/2025, 19:07:40
  0%|          | 0/4 [00:00<?, ?it/s] 75%|███████▌  | 3/4 [00:00<00:00, 27.20it/s]
2025-03-12 19:07:51,799 [INFO]: 	>>> Finished "Compute fast metrics" in 11.0743 secs
2025-03-12 19:07:51,800 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 31.5977 secs
2025-03-12 19:07:51,800 [INFO]: {
2025-03-12 19:07:51,800 [INFO]: 	index_key: HNSW15
2025-03-12 19:07:51,800 [INFO]: 	index_param: efSearch=322
2025-03-12 19:07:51,800 [INFO]: 	index_path: knn.index
2025-03-12 19:07:51,800 [INFO]: 	size in bytes: 380896510
2025-03-12 19:07:51,800 [INFO]: 	avg_search_speed_ms: 10.585254548294913
2025-03-12 19:07:51,800 [INFO]: 	99p_search_speed_ms: 14.670315468683834
2025-03-12 19:07:51,800 [INFO]: 	reconstruction error %: 0.0
2025-03-12 19:07:51,800 [INFO]: 	nb vectors: 1936
2025-03-12 19:07:51,800 [INFO]: 	vectors dimension: 49152
2025-03-12 19:07:51,800 [INFO]: 	compression ratio: 0.9993084158213998
2025-03-12 19:07:51,800 [INFO]: }
2025-03-12 19:07:51,800 [INFO]: 	>>> Finished "Creating the index" in 31.5989 secs
2025-03-12 19:07:51,800 [INFO]: >>> Finished "Launching the whole pipeline" in 31.6259 secs
2025-03-12 19:07:52: [retrieval_preprocessing] calculating distances ...
2025-03-12 19:07:52: [retrieval_preprocessing] finished and saved retrieval indices for episode 129 [episode count 3/20]
[retrieval_preprocessing] for episode 130 [episode count 4/20], we have num_retrieval=np.int64(1964) num_query=np.int64(72)
2025-03-12 19:07:52,867 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-12 19:07:53,103 [INFO]: Launching the whole pipeline 03/12/2025, 19:07:53
2025-03-12 19:07:53,103 [INFO]: Reading total number of vectors and dimension 03/12/2025, 19:07:53
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1977.51it/s]
2025-03-12 19:07:53,128 [INFO]: There are 1964 embeddings of dim 49152
2025-03-12 19:07:53,128 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0252 secs
2025-03-12 19:07:53,129 [INFO]: 	Compute estimated construction time of the index 03/12/2025, 19:07:53
2025-03-12 19:07:53,129 [INFO]: 		-> Train: 16.7 minutes
2025-03-12 19:07:53,129 [INFO]: 		-> Add: 1.1 seconds
2025-03-12 19:07:53,129 [INFO]: 		Total: 16.7 minutes
2025-03-12 19:07:53,129 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0001 secs
2025-03-12 19:07:53,129 [INFO]: 	Checking that your have enough memory available to create the index 03/12/2025, 19:07:53
2025-03-12 19:07:53,129 [INFO]: 405.3MB of memory will be needed to build the index (more might be used if you have more)
2025-03-12 19:07:53,129 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0001 secs
2025-03-12 19:07:53,129 [INFO]: 	Selecting most promising index types given data characteristics 03/12/2025, 19:07:53
2025-03-12 19:07:53,129 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-12 19:07:53,129 [INFO]: 	Creating the index 03/12/2025, 19:07:53
2025-03-12 19:07:53,129 [INFO]: 		-> Instanciate the index HNSW15 03/12/2025, 19:07:53
2025-03-12 19:07:53,130 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0009 secs
2025-03-12 19:07:53,130 [INFO]: 		-> Adding the vectors to the index 03/12/2025, 19:07:53
2025-03-12 19:07:53,130 [INFO]: The memory available for adding the vectors is 49.6GB(total available - used by the index)
2025-03-12 19:07:53,130 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/8 [00:00<?, ?it/s] 50%|█████     | 4/8 [00:00<00:00, 35.04it/s]100%|██████████| 8/8 [00:01<00:00,  5.53it/s]100%|██████████| 8/8 [00:01<00:00,  6.32it/s]
2025-03-12 19:07:54,398 [INFO]: 	Computing best hyperparameters for index knn.index 03/12/2025, 19:07:54
2025-03-12 19:08:13,705 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 19.3067 secs
2025-03-12 19:08:13,706 [INFO]: The best hyperparameters are: efSearch=310
2025-03-12 19:08:13,706 [INFO]: 	Compute fast metrics 03/12/2025, 19:08:13
  0%|          | 0/4 [00:00<?, ?it/s] 75%|███████▌  | 3/4 [00:00<00:00, 29.76it/s] 75%|███████▌  | 3/4 [00:00<00:00, 25.69it/s]
2025-03-12 19:08:24,826 [INFO]: 	>>> Finished "Compute fast metrics" in 11.1205 secs
2025-03-12 19:08:24,827 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 31.6972 secs
2025-03-12 19:08:24,827 [INFO]: {
2025-03-12 19:08:24,827 [INFO]: 	index_key: HNSW15
2025-03-12 19:08:24,827 [INFO]: 	index_param: efSearch=310
2025-03-12 19:08:24,827 [INFO]: 	index_path: knn.index
2025-03-12 19:08:24,827 [INFO]: 	size in bytes: 386405230
2025-03-12 19:08:24,827 [INFO]: 	avg_search_speed_ms: 9.998594523760138
2025-03-12 19:08:24,827 [INFO]: 	99p_search_speed_ms: 13.794865924865007
2025-03-12 19:08:24,827 [INFO]: 	reconstruction error %: 0.0
2025-03-12 19:08:24,827 [INFO]: 	nb vectors: 1964
2025-03-12 19:08:24,827 [INFO]: 	vectors dimension: 49152
2025-03-12 19:08:24,827 [INFO]: 	compression ratio: 0.999308710184901
2025-03-12 19:08:24,827 [INFO]: }
2025-03-12 19:08:24,827 [INFO]: 	>>> Finished "Creating the index" in 31.6985 secs
2025-03-12 19:08:24,827 [INFO]: >>> Finished "Launching the whole pipeline" in 31.7243 secs
2025-03-12 19:08:25: [retrieval_preprocessing] calculating distances ...
2025-03-12 19:08:25: [retrieval_preprocessing] finished and saved retrieval indices for episode 130 [episode count 4/20]
[retrieval_preprocessing] for episode 131 [episode count 5/20], we have num_retrieval=np.int64(1922) num_query=np.int64(114)
2025-03-12 19:08:25,601 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-12 19:08:25,821 [INFO]: Launching the whole pipeline 03/12/2025, 19:08:25
2025-03-12 19:08:25,821 [INFO]: Reading total number of vectors and dimension 03/12/2025, 19:08:25
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 2400.86it/s]
2025-03-12 19:08:25,850 [INFO]: There are 1922 embeddings of dim 49152
2025-03-12 19:08:25,851 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0299 secs
2025-03-12 19:08:25,851 [INFO]: 	Compute estimated construction time of the index 03/12/2025, 19:08:25
2025-03-12 19:08:25,851 [INFO]: 		-> Train: 16.7 minutes
2025-03-12 19:08:25,851 [INFO]: 		-> Add: 1.1 seconds
2025-03-12 19:08:25,851 [INFO]: 		Total: 16.7 minutes
2025-03-12 19:08:25,851 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0004 secs
2025-03-12 19:08:25,851 [INFO]: 	Checking that your have enough memory available to create the index 03/12/2025, 19:08:25
2025-03-12 19:08:25,852 [INFO]: 396.7MB of memory will be needed to build the index (more might be used if you have more)
2025-03-12 19:08:25,852 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0003 secs
2025-03-12 19:08:25,852 [INFO]: 	Selecting most promising index types given data characteristics 03/12/2025, 19:08:25
2025-03-12 19:08:25,852 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-12 19:08:25,852 [INFO]: 	Creating the index 03/12/2025, 19:08:25
2025-03-12 19:08:25,852 [INFO]: 		-> Instanciate the index HNSW15 03/12/2025, 19:08:25
2025-03-12 19:08:25,855 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0027 secs
2025-03-12 19:08:25,855 [INFO]: 		-> Adding the vectors to the index 03/12/2025, 19:08:25
2025-03-12 19:08:25,856 [INFO]: The memory available for adding the vectors is 49.6GB(total available - used by the index)
2025-03-12 19:08:25,856 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/8 [00:00<?, ?it/s] 50%|█████     | 4/8 [00:00<00:00, 37.10it/s]100%|██████████| 8/8 [00:01<00:00,  5.67it/s]100%|██████████| 8/8 [00:01<00:00,  6.48it/s]
2025-03-12 19:08:27,095 [INFO]: 	Computing best hyperparameters for index knn.index 03/12/2025, 19:08:27
2025-03-12 19:08:46,045 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 18.9504 secs
2025-03-12 19:08:46,045 [INFO]: The best hyperparameters are: efSearch=322
2025-03-12 19:08:46,045 [INFO]: 	Compute fast metrics 03/12/2025, 19:08:46
  0%|          | 0/4 [00:00<?, ?it/s] 75%|███████▌  | 3/4 [00:00<00:00, 27.83it/s] 75%|███████▌  | 3/4 [00:00<00:00, 24.98it/s]
2025-03-12 19:08:57,385 [INFO]: 	>>> Finished "Compute fast metrics" in 11.3395 secs
2025-03-12 19:08:57,386 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 31.5305 secs
2025-03-12 19:08:57,386 [INFO]: {
2025-03-12 19:08:57,386 [INFO]: 	index_key: HNSW15
2025-03-12 19:08:57,386 [INFO]: 	index_param: efSearch=322
2025-03-12 19:08:57,386 [INFO]: 	index_path: knn.index
2025-03-12 19:08:57,386 [INFO]: 	size in bytes: 378142030
2025-03-12 19:08:57,386 [INFO]: 	avg_search_speed_ms: 9.60738275501623
2025-03-12 19:08:57,386 [INFO]: 	99p_search_speed_ms: 12.51221541315316
2025-03-12 19:08:57,386 [INFO]: 	reconstruction error %: 0.0
2025-03-12 19:08:57,386 [INFO]: 	nb vectors: 1922
2025-03-12 19:08:57,386 [INFO]: 	vectors dimension: 49152
2025-03-12 19:08:57,386 [INFO]: 	compression ratio: 0.9993085825450294
2025-03-12 19:08:57,386 [INFO]: }
2025-03-12 19:08:57,386 [INFO]: 	>>> Finished "Creating the index" in 31.5341 secs
2025-03-12 19:08:57,386 [INFO]: >>> Finished "Launching the whole pipeline" in 31.5657 secs
2025-03-12 19:08:58: [retrieval_preprocessing] calculating distances ...
2025-03-12 19:08:58: [retrieval_preprocessing] finished and saved retrieval indices for episode 131 [episode count 5/20]
[retrieval_preprocessing] for episode 132 [episode count 6/20], we have num_retrieval=np.int64(1945) num_query=np.int64(91)
2025-03-12 19:08:58,533 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-12 19:08:58,761 [INFO]: Launching the whole pipeline 03/12/2025, 19:08:58
2025-03-12 19:08:58,761 [INFO]: Reading total number of vectors and dimension 03/12/2025, 19:08:58
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 2501.08it/s]
2025-03-12 19:08:58,788 [INFO]: There are 1945 embeddings of dim 49152
2025-03-12 19:08:58,788 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0268 secs
2025-03-12 19:08:58,788 [INFO]: 	Compute estimated construction time of the index 03/12/2025, 19:08:58
2025-03-12 19:08:58,788 [INFO]: 		-> Train: 16.7 minutes
2025-03-12 19:08:58,788 [INFO]: 		-> Add: 1.1 seconds
2025-03-12 19:08:58,788 [INFO]: 		Total: 16.7 minutes
2025-03-12 19:08:58,788 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0001 secs
2025-03-12 19:08:58,788 [INFO]: 	Checking that your have enough memory available to create the index 03/12/2025, 19:08:58
2025-03-12 19:08:58,788 [INFO]: 401.4MB of memory will be needed to build the index (more might be used if you have more)
2025-03-12 19:08:58,788 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0001 secs
2025-03-12 19:08:58,788 [INFO]: 	Selecting most promising index types given data characteristics 03/12/2025, 19:08:58
2025-03-12 19:08:58,788 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-12 19:08:58,788 [INFO]: 	Creating the index 03/12/2025, 19:08:58
2025-03-12 19:08:58,788 [INFO]: 		-> Instanciate the index HNSW15 03/12/2025, 19:08:58
2025-03-12 19:08:58,789 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0010 secs
2025-03-12 19:08:58,789 [INFO]: 		-> Adding the vectors to the index 03/12/2025, 19:08:58
2025-03-12 19:08:58,789 [INFO]: The memory available for adding the vectors is 49.6GB(total available - used by the index)
2025-03-12 19:08:58,789 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/8 [00:00<?, ?it/s] 38%|███▊      | 3/8 [00:00<00:00, 28.42it/s]100%|██████████| 8/8 [00:01<00:00,  5.76it/s]100%|██████████| 8/8 [00:01<00:00,  6.32it/s]
2025-03-12 19:09:00,058 [INFO]: 	Computing best hyperparameters for index knn.index 03/12/2025, 19:09:00
2025-03-12 19:09:19,380 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 19.3221 secs
2025-03-12 19:09:19,380 [INFO]: The best hyperparameters are: efSearch=310
2025-03-12 19:09:19,380 [INFO]: 	Compute fast metrics 03/12/2025, 19:09:19
  0%|          | 0/4 [00:00<?, ?it/s] 75%|███████▌  | 3/4 [00:00<00:00, 27.42it/s] 75%|███████▌  | 3/4 [00:00<00:00, 24.31it/s]
2025-03-12 19:09:30,452 [INFO]: 	>>> Finished "Compute fast metrics" in 11.0710 secs
2025-03-12 19:09:30,453 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 31.6635 secs
2025-03-12 19:09:30,453 [INFO]: {
2025-03-12 19:09:30,453 [INFO]: 	index_key: HNSW15
2025-03-12 19:09:30,453 [INFO]: 	index_param: efSearch=310
2025-03-12 19:09:30,453 [INFO]: 	index_path: knn.index
2025-03-12 19:09:30,453 [INFO]: 	size in bytes: 382667170
2025-03-12 19:09:30,453 [INFO]: 	avg_search_speed_ms: 9.70950028271351
2025-03-12 19:09:30,453 [INFO]: 	99p_search_speed_ms: 12.523731507826598
2025-03-12 19:09:30,453 [INFO]: 	reconstruction error %: 0.0
2025-03-12 19:09:30,453 [INFO]: 	nb vectors: 1945
2025-03-12 19:09:30,453 [INFO]: 	vectors dimension: 49152
2025-03-12 19:09:30,453 [INFO]: 	compression ratio: 0.9993085113624981
2025-03-12 19:09:30,453 [INFO]: }
2025-03-12 19:09:30,453 [INFO]: 	>>> Finished "Creating the index" in 31.6649 secs
2025-03-12 19:09:30,453 [INFO]: >>> Finished "Launching the whole pipeline" in 31.6922 secs
2025-03-12 19:09:31: [retrieval_preprocessing] calculating distances ...
2025-03-12 19:09:31: [retrieval_preprocessing] finished and saved retrieval indices for episode 132 [episode count 6/20]
[retrieval_preprocessing] for episode 133 [episode count 7/20], we have num_retrieval=np.int64(1967) num_query=np.int64(69)
2025-03-12 19:09:31,418 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-12 19:09:31,645 [INFO]: Launching the whole pipeline 03/12/2025, 19:09:31
2025-03-12 19:09:31,645 [INFO]: Reading total number of vectors and dimension 03/12/2025, 19:09:31
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1613.81it/s]
2025-03-12 19:09:31,675 [INFO]: There are 1967 embeddings of dim 49152
2025-03-12 19:09:31,675 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0298 secs
2025-03-12 19:09:31,675 [INFO]: 	Compute estimated construction time of the index 03/12/2025, 19:09:31
2025-03-12 19:09:31,675 [INFO]: 		-> Train: 16.7 minutes
2025-03-12 19:09:31,675 [INFO]: 		-> Add: 1.1 seconds
2025-03-12 19:09:31,675 [INFO]: 		Total: 16.7 minutes
2025-03-12 19:09:31,675 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0001 secs
2025-03-12 19:09:31,675 [INFO]: 	Checking that your have enough memory available to create the index 03/12/2025, 19:09:31
2025-03-12 19:09:31,675 [INFO]: 405.9MB of memory will be needed to build the index (more might be used if you have more)
2025-03-12 19:09:31,675 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0001 secs
2025-03-12 19:09:31,675 [INFO]: 	Selecting most promising index types given data characteristics 03/12/2025, 19:09:31
2025-03-12 19:09:31,675 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-12 19:09:31,675 [INFO]: 	Creating the index 03/12/2025, 19:09:31
2025-03-12 19:09:31,675 [INFO]: 		-> Instanciate the index HNSW15 03/12/2025, 19:09:31
2025-03-12 19:09:31,676 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0009 secs
2025-03-12 19:09:31,676 [INFO]: 		-> Adding the vectors to the index 03/12/2025, 19:09:31
2025-03-12 19:09:31,676 [INFO]: The memory available for adding the vectors is 49.6GB(total available - used by the index)
2025-03-12 19:09:31,677 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/8 [00:00<?, ?it/s] 38%|███▊      | 3/8 [00:00<00:00, 27.45it/s]100%|██████████| 8/8 [00:01<00:00,  5.40it/s]100%|██████████| 8/8 [00:01<00:00,  5.93it/s]
2025-03-12 19:09:33,029 [INFO]: 	Computing best hyperparameters for index knn.index 03/12/2025, 19:09:33
2025-03-12 19:09:53,373 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 20.3438 secs
2025-03-12 19:09:53,373 [INFO]: The best hyperparameters are: efSearch=249
2025-03-12 19:09:53,373 [INFO]: 	Compute fast metrics 03/12/2025, 19:09:53
  0%|          | 0/4 [00:00<?, ?it/s] 75%|███████▌  | 3/4 [00:00<00:00, 27.59it/s] 75%|███████▌  | 3/4 [00:00<00:00, 24.68it/s]
2025-03-12 19:10:04,464 [INFO]: 	>>> Finished "Compute fast metrics" in 11.0909 secs
2025-03-12 19:10:04,465 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 32.7889 secs
2025-03-12 19:10:04,465 [INFO]: {
2025-03-12 19:10:04,465 [INFO]: 	index_key: HNSW15
2025-03-12 19:10:04,465 [INFO]: 	index_param: efSearch=249
2025-03-12 19:10:04,465 [INFO]: 	index_path: knn.index
2025-03-12 19:10:04,465 [INFO]: 	size in bytes: 386995450
2025-03-12 19:10:04,465 [INFO]: 	avg_search_speed_ms: 8.328702747837317
2025-03-12 19:10:04,466 [INFO]: 	99p_search_speed_ms: 10.906026000156999
2025-03-12 19:10:04,466 [INFO]: 	reconstruction error %: 0.0
2025-03-12 19:10:04,466 [INFO]: 	nb vectors: 1967
2025-03-12 19:10:04,466 [INFO]: 	vectors dimension: 49152
2025-03-12 19:10:04,466 [INFO]: 	compression ratio: 0.9993087412268026
2025-03-12 19:10:04,466 [INFO]: }
2025-03-12 19:10:04,466 [INFO]: 	>>> Finished "Creating the index" in 32.7901 secs
2025-03-12 19:10:04,466 [INFO]: >>> Finished "Launching the whole pipeline" in 32.8203 secs
2025-03-12 19:10:04: [retrieval_preprocessing] calculating distances ...
2025-03-12 19:10:05: [retrieval_preprocessing] finished and saved retrieval indices for episode 133 [episode count 7/20]
[retrieval_preprocessing] for episode 134 [episode count 8/20], we have num_retrieval=np.int64(1957) num_query=np.int64(79)
2025-03-12 19:10:05,128 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-12 19:10:05,352 [INFO]: Launching the whole pipeline 03/12/2025, 19:10:05
2025-03-12 19:10:05,352 [INFO]: Reading total number of vectors and dimension 03/12/2025, 19:10:05
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 2525.17it/s]
2025-03-12 19:10:05,378 [INFO]: There are 1957 embeddings of dim 49152
2025-03-12 19:10:05,378 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0258 secs
2025-03-12 19:10:05,378 [INFO]: 	Compute estimated construction time of the index 03/12/2025, 19:10:05
2025-03-12 19:10:05,378 [INFO]: 		-> Train: 16.7 minutes
2025-03-12 19:10:05,378 [INFO]: 		-> Add: 1.1 seconds
2025-03-12 19:10:05,378 [INFO]: 		Total: 16.7 minutes
2025-03-12 19:10:05,378 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0001 secs
2025-03-12 19:10:05,378 [INFO]: 	Checking that your have enough memory available to create the index 03/12/2025, 19:10:05
2025-03-12 19:10:05,378 [INFO]: 403.9MB of memory will be needed to build the index (more might be used if you have more)
2025-03-12 19:10:05,378 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0001 secs
2025-03-12 19:10:05,378 [INFO]: 	Selecting most promising index types given data characteristics 03/12/2025, 19:10:05
2025-03-12 19:10:05,378 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-12 19:10:05,378 [INFO]: 	Creating the index 03/12/2025, 19:10:05
2025-03-12 19:10:05,379 [INFO]: 		-> Instanciate the index HNSW15 03/12/2025, 19:10:05
2025-03-12 19:10:05,380 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0010 secs
2025-03-12 19:10:05,380 [INFO]: 		-> Adding the vectors to the index 03/12/2025, 19:10:05
2025-03-12 19:10:05,380 [INFO]: The memory available for adding the vectors is 49.6GB(total available - used by the index)
2025-03-12 19:10:05,380 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/8 [00:00<?, ?it/s] 25%|██▌       | 2/8 [00:00<00:00, 18.66it/s]100%|██████████| 8/8 [00:01<00:00,  5.84it/s]100%|██████████| 8/8 [00:01<00:00,  6.15it/s]
2025-03-12 19:10:06,684 [INFO]: 	Computing best hyperparameters for index knn.index 03/12/2025, 19:10:06
2025-03-12 19:10:25,875 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 19.1906 secs
2025-03-12 19:10:25,875 [INFO]: The best hyperparameters are: efSearch=308
2025-03-12 19:10:25,875 [INFO]: 	Compute fast metrics 03/12/2025, 19:10:25
  0%|          | 0/4 [00:00<?, ?it/s] 75%|███████▌  | 3/4 [00:00<00:00, 29.02it/s] 75%|███████▌  | 3/4 [00:00<00:00, 25.30it/s]
2025-03-12 19:10:37,026 [INFO]: 	>>> Finished "Compute fast metrics" in 11.1505 secs
2025-03-12 19:10:37,027 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 31.6473 secs
2025-03-12 19:10:37,027 [INFO]: {
2025-03-12 19:10:37,027 [INFO]: 	index_key: HNSW15
2025-03-12 19:10:37,027 [INFO]: 	index_param: efSearch=308
2025-03-12 19:10:37,027 [INFO]: 	index_path: knn.index
2025-03-12 19:10:37,027 [INFO]: 	size in bytes: 385028050
2025-03-12 19:10:37,027 [INFO]: 	avg_search_speed_ms: 10.115084668463219
2025-03-12 19:10:37,027 [INFO]: 	99p_search_speed_ms: 13.74157671816647
2025-03-12 19:10:37,027 [INFO]: 	reconstruction error %: 0.0
2025-03-12 19:10:37,027 [INFO]: 	nb vectors: 1957
2025-03-12 19:10:37,027 [INFO]: 	vectors dimension: 49152
2025-03-12 19:10:37,027 [INFO]: 	compression ratio: 0.9993086373836919
2025-03-12 19:10:37,027 [INFO]: }
2025-03-12 19:10:37,027 [INFO]: 	>>> Finished "Creating the index" in 31.6488 secs
2025-03-12 19:10:37,027 [INFO]: >>> Finished "Launching the whole pipeline" in 31.6751 secs
2025-03-12 19:10:37: [retrieval_preprocessing] calculating distances ...
2025-03-12 19:10:37: [retrieval_preprocessing] finished and saved retrieval indices for episode 134 [episode count 8/20]
[retrieval_preprocessing] for episode 135 [episode count 9/20], we have num_retrieval=np.int64(1959) num_query=np.int64(77)
2025-03-12 19:10:37,866 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-12 19:10:38,088 [INFO]: Launching the whole pipeline 03/12/2025, 19:10:38
2025-03-12 19:10:38,088 [INFO]: Reading total number of vectors and dimension 03/12/2025, 19:10:38
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1610.72it/s]
2025-03-12 19:10:38,115 [INFO]: There are 1959 embeddings of dim 49152
2025-03-12 19:10:38,115 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0275 secs
2025-03-12 19:10:38,115 [INFO]: 	Compute estimated construction time of the index 03/12/2025, 19:10:38
2025-03-12 19:10:38,116 [INFO]: 		-> Train: 16.7 minutes
2025-03-12 19:10:38,116 [INFO]: 		-> Add: 1.1 seconds
2025-03-12 19:10:38,116 [INFO]: 		Total: 16.7 minutes
2025-03-12 19:10:38,116 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0001 secs
2025-03-12 19:10:38,116 [INFO]: 	Checking that your have enough memory available to create the index 03/12/2025, 19:10:38
2025-03-12 19:10:38,116 [INFO]: 404.3MB of memory will be needed to build the index (more might be used if you have more)
2025-03-12 19:10:38,116 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0001 secs
2025-03-12 19:10:38,116 [INFO]: 	Selecting most promising index types given data characteristics 03/12/2025, 19:10:38
2025-03-12 19:10:38,116 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-12 19:10:38,116 [INFO]: 	Creating the index 03/12/2025, 19:10:38
2025-03-12 19:10:38,116 [INFO]: 		-> Instanciate the index HNSW15 03/12/2025, 19:10:38
2025-03-12 19:10:38,117 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0008 secs
2025-03-12 19:10:38,117 [INFO]: 		-> Adding the vectors to the index 03/12/2025, 19:10:38
2025-03-12 19:10:38,117 [INFO]: The memory available for adding the vectors is 49.6GB(total available - used by the index)
2025-03-12 19:10:38,117 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/8 [00:00<?, ?it/s] 50%|█████     | 4/8 [00:00<00:00, 36.34it/s]100%|██████████| 8/8 [00:01<00:00,  5.46it/s]100%|██████████| 8/8 [00:01<00:00,  6.25it/s]
2025-03-12 19:10:39,401 [INFO]: 	Computing best hyperparameters for index knn.index 03/12/2025, 19:10:39
2025-03-12 19:10:58,619 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 19.2179 secs
2025-03-12 19:10:58,619 [INFO]: The best hyperparameters are: efSearch=306
2025-03-12 19:10:58,620 [INFO]: 	Compute fast metrics 03/12/2025, 19:10:58
  0%|          | 0/4 [00:00<?, ?it/s] 75%|███████▌  | 3/4 [00:00<00:00, 27.67it/s] 75%|███████▌  | 3/4 [00:00<00:00, 24.69it/s]
2025-03-12 19:11:09,897 [INFO]: 	>>> Finished "Compute fast metrics" in 11.2777 secs
2025-03-12 19:11:09,899 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 31.7817 secs
2025-03-12 19:11:09,899 [INFO]: {
2025-03-12 19:11:09,899 [INFO]: 	index_key: HNSW15
2025-03-12 19:11:09,899 [INFO]: 	index_param: efSearch=306
2025-03-12 19:11:09,899 [INFO]: 	index_path: knn.index
2025-03-12 19:11:09,899 [INFO]: 	size in bytes: 385421530
2025-03-12 19:11:09,899 [INFO]: 	avg_search_speed_ms: 9.599278220234728
2025-03-12 19:11:09,899 [INFO]: 	99p_search_speed_ms: 12.409093240275977
2025-03-12 19:11:09,899 [INFO]: 	reconstruction error %: 0.0
2025-03-12 19:11:09,899 [INFO]: 	nb vectors: 1959
2025-03-12 19:11:09,899 [INFO]: 	vectors dimension: 49152
2025-03-12 19:11:09,899 [INFO]: 	compression ratio: 0.9993086582371254
2025-03-12 19:11:09,899 [INFO]: }
2025-03-12 19:11:09,899 [INFO]: 	>>> Finished "Creating the index" in 31.7833 secs
2025-03-12 19:11:09,899 [INFO]: >>> Finished "Launching the whole pipeline" in 31.8113 secs
2025-03-12 19:11:10: [retrieval_preprocessing] calculating distances ...
2025-03-12 19:11:10: [retrieval_preprocessing] finished and saved retrieval indices for episode 135 [episode count 9/20]
[retrieval_preprocessing] for episode 136 [episode count 10/20], we have num_retrieval=np.int64(1956) num_query=np.int64(80)
2025-03-12 19:11:10,668 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-12 19:11:10,891 [INFO]: Launching the whole pipeline 03/12/2025, 19:11:10
2025-03-12 19:11:10,891 [INFO]: Reading total number of vectors and dimension 03/12/2025, 19:11:10
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1855.89it/s]
2025-03-12 19:11:10,918 [INFO]: There are 1956 embeddings of dim 49152
2025-03-12 19:11:10,918 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0270 secs
2025-03-12 19:11:10,918 [INFO]: 	Compute estimated construction time of the index 03/12/2025, 19:11:10
2025-03-12 19:11:10,919 [INFO]: 		-> Train: 16.7 minutes
2025-03-12 19:11:10,919 [INFO]: 		-> Add: 1.1 seconds
2025-03-12 19:11:10,919 [INFO]: 		Total: 16.7 minutes
2025-03-12 19:11:10,919 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0001 secs
2025-03-12 19:11:10,919 [INFO]: 	Checking that your have enough memory available to create the index 03/12/2025, 19:11:10
2025-03-12 19:11:10,919 [INFO]: 403.7MB of memory will be needed to build the index (more might be used if you have more)
2025-03-12 19:11:10,919 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0002 secs
2025-03-12 19:11:10,919 [INFO]: 	Selecting most promising index types given data characteristics 03/12/2025, 19:11:10
2025-03-12 19:11:10,919 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-12 19:11:10,919 [INFO]: 	Creating the index 03/12/2025, 19:11:10
2025-03-12 19:11:10,919 [INFO]: 		-> Instanciate the index HNSW15 03/12/2025, 19:11:10
2025-03-12 19:11:10,920 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0010 secs
2025-03-12 19:11:10,920 [INFO]: 		-> Adding the vectors to the index 03/12/2025, 19:11:10
2025-03-12 19:11:10,920 [INFO]: The memory available for adding the vectors is 49.6GB(total available - used by the index)
2025-03-12 19:11:10,920 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/8 [00:00<?, ?it/s] 38%|███▊      | 3/8 [00:00<00:00, 27.31it/s]100%|██████████| 8/8 [00:01<00:00,  5.53it/s]100%|██████████| 8/8 [00:01<00:00,  6.07it/s]
2025-03-12 19:11:12,242 [INFO]: 	Computing best hyperparameters for index knn.index 03/12/2025, 19:11:12
2025-03-12 19:11:31,739 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 19.4974 secs
2025-03-12 19:11:31,740 [INFO]: The best hyperparameters are: efSearch=310
2025-03-12 19:11:31,740 [INFO]: 	Compute fast metrics 03/12/2025, 19:11:31
  0%|          | 0/4 [00:00<?, ?it/s] 75%|███████▌  | 3/4 [00:00<00:00, 27.21it/s] 75%|███████▌  | 3/4 [00:00<00:00, 24.30it/s]
2025-03-12 19:11:42,860 [INFO]: 	>>> Finished "Compute fast metrics" in 11.1205 secs
2025-03-12 19:11:42,862 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 31.9414 secs
2025-03-12 19:11:42,862 [INFO]: {
2025-03-12 19:11:42,862 [INFO]: 	index_key: HNSW15
2025-03-12 19:11:42,862 [INFO]: 	index_param: efSearch=310
2025-03-12 19:11:42,862 [INFO]: 	index_path: knn.index
2025-03-12 19:11:42,862 [INFO]: 	size in bytes: 384831310
2025-03-12 19:11:42,862 [INFO]: 	avg_search_speed_ms: 9.736524462725281
2025-03-12 19:11:42,862 [INFO]: 	99p_search_speed_ms: 12.562957042828202
2025-03-12 19:11:42,862 [INFO]: 	reconstruction error %: 0.0
2025-03-12 19:11:42,862 [INFO]: 	nb vectors: 1956
2025-03-12 19:11:42,862 [INFO]: 	vectors dimension: 49152
2025-03-12 19:11:42,862 [INFO]: 	compression ratio: 0.9993086269409835
2025-03-12 19:11:42,862 [INFO]: }
2025-03-12 19:11:42,862 [INFO]: 	>>> Finished "Creating the index" in 31.9427 secs
2025-03-12 19:11:42,862 [INFO]: >>> Finished "Launching the whole pipeline" in 31.9704 secs
2025-03-12 19:11:43: [retrieval_preprocessing] calculating distances ...
2025-03-12 19:11:43: [retrieval_preprocessing] finished and saved retrieval indices for episode 136 [episode count 10/20]
[retrieval_preprocessing] for episode 137 [episode count 11/20], we have num_retrieval=np.int64(1954) num_query=np.int64(82)
2025-03-12 19:11:43,649 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-12 19:11:43,879 [INFO]: Launching the whole pipeline 03/12/2025, 19:11:43
2025-03-12 19:11:43,879 [INFO]: Reading total number of vectors and dimension 03/12/2025, 19:11:43
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 2444.23it/s]
2025-03-12 19:11:43,907 [INFO]: There are 1954 embeddings of dim 49152
2025-03-12 19:11:43,907 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0284 secs
2025-03-12 19:11:43,907 [INFO]: 	Compute estimated construction time of the index 03/12/2025, 19:11:43
2025-03-12 19:11:43,907 [INFO]: 		-> Train: 16.7 minutes
2025-03-12 19:11:43,907 [INFO]: 		-> Add: 1.1 seconds
2025-03-12 19:11:43,907 [INFO]: 		Total: 16.7 minutes
2025-03-12 19:11:43,907 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0001 secs
2025-03-12 19:11:43,907 [INFO]: 	Checking that your have enough memory available to create the index 03/12/2025, 19:11:43
2025-03-12 19:11:43,907 [INFO]: 403.3MB of memory will be needed to build the index (more might be used if you have more)
2025-03-12 19:11:43,908 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0001 secs
2025-03-12 19:11:43,908 [INFO]: 	Selecting most promising index types given data characteristics 03/12/2025, 19:11:43
2025-03-12 19:11:43,908 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-12 19:11:43,908 [INFO]: 	Creating the index 03/12/2025, 19:11:43
2025-03-12 19:11:43,908 [INFO]: 		-> Instanciate the index HNSW15 03/12/2025, 19:11:43
2025-03-12 19:11:43,909 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0009 secs
2025-03-12 19:11:43,909 [INFO]: 		-> Adding the vectors to the index 03/12/2025, 19:11:43
2025-03-12 19:11:43,909 [INFO]: The memory available for adding the vectors is 49.6GB(total available - used by the index)
2025-03-12 19:11:43,909 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/8 [00:00<?, ?it/s] 38%|███▊      | 3/8 [00:00<00:00, 29.16it/s]100%|██████████| 8/8 [00:01<00:00,  5.75it/s]100%|██████████| 8/8 [00:01<00:00,  6.31it/s]
2025-03-12 19:11:45,179 [INFO]: 	Computing best hyperparameters for index knn.index 03/12/2025, 19:11:45
2025-03-12 19:12:04,700 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 19.5204 secs
2025-03-12 19:12:04,700 [INFO]: The best hyperparameters are: efSearch=306
2025-03-12 19:12:04,700 [INFO]: 	Compute fast metrics 03/12/2025, 19:12:04
  0%|          | 0/4 [00:00<?, ?it/s] 75%|███████▌  | 3/4 [00:00<00:00, 27.80it/s] 75%|███████▌  | 3/4 [00:00<00:00, 24.14it/s]
2025-03-12 19:12:15,847 [INFO]: 	>>> Finished "Compute fast metrics" in 11.1470 secs
2025-03-12 19:12:15,848 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 31.9394 secs
2025-03-12 19:12:15,848 [INFO]: {
2025-03-12 19:12:15,848 [INFO]: 	index_key: HNSW15
2025-03-12 19:12:15,848 [INFO]: 	index_param: efSearch=306
2025-03-12 19:12:15,848 [INFO]: 	index_path: knn.index
2025-03-12 19:12:15,848 [INFO]: 	size in bytes: 384437830
2025-03-12 19:12:15,848 [INFO]: 	avg_search_speed_ms: 9.959875267653901
2025-03-12 19:12:15,848 [INFO]: 	99p_search_speed_ms: 13.18046519299969
2025-03-12 19:12:15,848 [INFO]: 	reconstruction error %: 0.0
2025-03-12 19:12:15,848 [INFO]: 	nb vectors: 1954
2025-03-12 19:12:15,848 [INFO]: 	vectors dimension: 49152
2025-03-12 19:12:15,848 [INFO]: 	compression ratio: 0.9993086060235019
2025-03-12 19:12:15,848 [INFO]: }
2025-03-12 19:12:15,848 [INFO]: 	>>> Finished "Creating the index" in 31.9407 secs
2025-03-12 19:12:15,848 [INFO]: >>> Finished "Launching the whole pipeline" in 31.9695 secs
2025-03-12 19:12:16: [retrieval_preprocessing] calculating distances ...
2025-03-12 19:12:17: [retrieval_preprocessing] finished and saved retrieval indices for episode 137 [episode count 11/20]
[retrieval_preprocessing] for episode 138 [episode count 12/20], we have num_retrieval=np.int64(1960) num_query=np.int64(76)
2025-03-12 19:12:17,242 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-12 19:12:17,467 [INFO]: Launching the whole pipeline 03/12/2025, 19:12:17
2025-03-12 19:12:17,467 [INFO]: Reading total number of vectors and dimension 03/12/2025, 19:12:17
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1681.76it/s]
2025-03-12 19:12:17,494 [INFO]: There are 1960 embeddings of dim 49152
2025-03-12 19:12:17,494 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0270 secs
2025-03-12 19:12:17,494 [INFO]: 	Compute estimated construction time of the index 03/12/2025, 19:12:17
2025-03-12 19:12:17,494 [INFO]: 		-> Train: 16.7 minutes
2025-03-12 19:12:17,494 [INFO]: 		-> Add: 1.1 seconds
2025-03-12 19:12:17,494 [INFO]: 		Total: 16.7 minutes
2025-03-12 19:12:17,494 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0001 secs
2025-03-12 19:12:17,494 [INFO]: 	Checking that your have enough memory available to create the index 03/12/2025, 19:12:17
2025-03-12 19:12:17,494 [INFO]: 404.5MB of memory will be needed to build the index (more might be used if you have more)
2025-03-12 19:12:17,494 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0001 secs
2025-03-12 19:12:17,494 [INFO]: 	Selecting most promising index types given data characteristics 03/12/2025, 19:12:17
2025-03-12 19:12:17,494 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-12 19:12:17,494 [INFO]: 	Creating the index 03/12/2025, 19:12:17
2025-03-12 19:12:17,494 [INFO]: 		-> Instanciate the index HNSW15 03/12/2025, 19:12:17
2025-03-12 19:12:17,495 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0009 secs
2025-03-12 19:12:17,496 [INFO]: 		-> Adding the vectors to the index 03/12/2025, 19:12:17
2025-03-12 19:12:17,496 [INFO]: The memory available for adding the vectors is 49.6GB(total available - used by the index)
2025-03-12 19:12:17,496 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/8 [00:00<?, ?it/s] 38%|███▊      | 3/8 [00:00<00:00, 26.99it/s]100%|██████████| 8/8 [00:01<00:00,  5.59it/s]100%|██████████| 8/8 [00:01<00:00,  6.13it/s]
2025-03-12 19:12:18,804 [INFO]: 	Computing best hyperparameters for index knn.index 03/12/2025, 19:12:18
2025-03-12 19:12:38,853 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 20.0490 secs
2025-03-12 19:12:38,853 [INFO]: The best hyperparameters are: efSearch=292
2025-03-12 19:12:38,853 [INFO]: 	Compute fast metrics 03/12/2025, 19:12:38
  0%|          | 0/4 [00:00<?, ?it/s] 75%|███████▌  | 3/4 [00:00<00:00, 27.68it/s] 75%|███████▌  | 3/4 [00:00<00:00, 24.38it/s]
2025-03-12 19:12:49,969 [INFO]: 	>>> Finished "Compute fast metrics" in 11.1155 secs
2025-03-12 19:12:49,970 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 32.4742 secs
2025-03-12 19:12:49,970 [INFO]: {
2025-03-12 19:12:49,970 [INFO]: 	index_key: HNSW15
2025-03-12 19:12:49,970 [INFO]: 	index_param: efSearch=292
2025-03-12 19:12:49,970 [INFO]: 	index_path: knn.index
2025-03-12 19:12:49,970 [INFO]: 	size in bytes: 385618270
2025-03-12 19:12:49,970 [INFO]: 	avg_search_speed_ms: 9.685001991480041
2025-03-12 19:12:49,970 [INFO]: 	99p_search_speed_ms: 12.495613563805815
2025-03-12 19:12:49,970 [INFO]: 	reconstruction error %: 0.0
2025-03-12 19:12:49,970 [INFO]: 	nb vectors: 1960
2025-03-12 19:12:49,970 [INFO]: 	vectors dimension: 49152
2025-03-12 19:12:49,970 [INFO]: 	compression ratio: 0.9993086686478833
2025-03-12 19:12:49,970 [INFO]: }
2025-03-12 19:12:49,970 [INFO]: 	>>> Finished "Creating the index" in 32.4756 secs
2025-03-12 19:12:49,970 [INFO]: >>> Finished "Launching the whole pipeline" in 32.5031 secs
2025-03-12 19:12:50: [retrieval_preprocessing] calculating distances ...
2025-03-12 19:12:50: [retrieval_preprocessing] finished and saved retrieval indices for episode 138 [episode count 12/20]
[retrieval_preprocessing] for episode 139 [episode count 13/20], we have num_retrieval=np.int64(1926) num_query=np.int64(110)
2025-03-12 19:12:50,715 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-12 19:12:50,933 [INFO]: Launching the whole pipeline 03/12/2025, 19:12:50
2025-03-12 19:12:50,934 [INFO]: Reading total number of vectors and dimension 03/12/2025, 19:12:50
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 2616.53it/s]
2025-03-12 19:12:50,963 [INFO]: There are 1926 embeddings of dim 49152
2025-03-12 19:12:50,963 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0292 secs
2025-03-12 19:12:50,963 [INFO]: 	Compute estimated construction time of the index 03/12/2025, 19:12:50
2025-03-12 19:12:50,963 [INFO]: 		-> Train: 16.7 minutes
2025-03-12 19:12:50,963 [INFO]: 		-> Add: 1.1 seconds
2025-03-12 19:12:50,963 [INFO]: 		Total: 16.7 minutes
2025-03-12 19:12:50,963 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0001 secs
2025-03-12 19:12:50,963 [INFO]: 	Checking that your have enough memory available to create the index 03/12/2025, 19:12:50
2025-03-12 19:12:50,963 [INFO]: 397.5MB of memory will be needed to build the index (more might be used if you have more)
2025-03-12 19:12:50,963 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0001 secs
2025-03-12 19:12:50,963 [INFO]: 	Selecting most promising index types given data characteristics 03/12/2025, 19:12:50
2025-03-12 19:12:50,963 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-12 19:12:50,963 [INFO]: 	Creating the index 03/12/2025, 19:12:50
2025-03-12 19:12:50,963 [INFO]: 		-> Instanciate the index HNSW15 03/12/2025, 19:12:50
2025-03-12 19:12:50,964 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0009 secs
2025-03-12 19:12:50,964 [INFO]: 		-> Adding the vectors to the index 03/12/2025, 19:12:50
2025-03-12 19:12:50,964 [INFO]: The memory available for adding the vectors is 49.6GB(total available - used by the index)
2025-03-12 19:12:50,964 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/8 [00:00<?, ?it/s] 38%|███▊      | 3/8 [00:00<00:00, 26.23it/s]100%|██████████| 8/8 [00:01<00:00,  5.64it/s]100%|██████████| 8/8 [00:01<00:00,  6.18it/s]
2025-03-12 19:12:52,262 [INFO]: 	Computing best hyperparameters for index knn.index 03/12/2025, 19:12:52
2025-03-12 19:13:11,753 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 19.4906 secs
2025-03-12 19:13:11,753 [INFO]: The best hyperparameters are: efSearch=315
2025-03-12 19:13:11,753 [INFO]: 	Compute fast metrics 03/12/2025, 19:13:11
  0%|          | 0/4 [00:00<?, ?it/s] 75%|███████▌  | 3/4 [00:00<00:00, 27.20it/s]
2025-03-12 19:13:22,851 [INFO]: 	>>> Finished "Compute fast metrics" in 11.0984 secs
2025-03-12 19:13:22,853 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 31.8885 secs
2025-03-12 19:13:22,853 [INFO]: {
2025-03-12 19:13:22,853 [INFO]: 	index_key: HNSW15
2025-03-12 19:13:22,853 [INFO]: 	index_param: efSearch=315
2025-03-12 19:13:22,853 [INFO]: 	index_path: knn.index
2025-03-12 19:13:22,853 [INFO]: 	size in bytes: 378928990
2025-03-12 19:13:22,853 [INFO]: 	avg_search_speed_ms: 9.793593257256983
2025-03-12 19:13:22,853 [INFO]: 	99p_search_speed_ms: 12.493802513927221
2025-03-12 19:13:22,853 [INFO]: 	reconstruction error %: 0.0
2025-03-12 19:13:22,853 [INFO]: 	nb vectors: 1926
2025-03-12 19:13:22,853 [INFO]: 	vectors dimension: 49152
2025-03-12 19:13:22,853 [INFO]: 	compression ratio: 0.9993086250803878
2025-03-12 19:13:22,853 [INFO]: }
2025-03-12 19:13:22,853 [INFO]: 	>>> Finished "Creating the index" in 31.8897 secs
2025-03-12 19:13:22,853 [INFO]: >>> Finished "Launching the whole pipeline" in 31.9195 secs
2025-03-12 19:13:23: [retrieval_preprocessing] calculating distances ...
2025-03-12 19:13:23: [retrieval_preprocessing] finished and saved retrieval indices for episode 139 [episode count 13/20]
[retrieval_preprocessing] for episode 140 [episode count 14/20], we have num_retrieval=np.int64(1933) num_query=np.int64(103)
2025-03-12 19:13:23,962 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-12 19:13:24,183 [INFO]: Launching the whole pipeline 03/12/2025, 19:13:24
2025-03-12 19:13:24,183 [INFO]: Reading total number of vectors and dimension 03/12/2025, 19:13:24
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1563.29it/s]
2025-03-12 19:13:24,209 [INFO]: There are 1933 embeddings of dim 49152
2025-03-12 19:13:24,209 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0263 secs
2025-03-12 19:13:24,209 [INFO]: 	Compute estimated construction time of the index 03/12/2025, 19:13:24
2025-03-12 19:13:24,209 [INFO]: 		-> Train: 16.7 minutes
2025-03-12 19:13:24,209 [INFO]: 		-> Add: 1.1 seconds
2025-03-12 19:13:24,209 [INFO]: 		Total: 16.7 minutes
2025-03-12 19:13:24,209 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0001 secs
2025-03-12 19:13:24,210 [INFO]: 	Checking that your have enough memory available to create the index 03/12/2025, 19:13:24
2025-03-12 19:13:24,210 [INFO]: 398.9MB of memory will be needed to build the index (more might be used if you have more)
2025-03-12 19:13:24,210 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0001 secs
2025-03-12 19:13:24,210 [INFO]: 	Selecting most promising index types given data characteristics 03/12/2025, 19:13:24
2025-03-12 19:13:24,210 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-12 19:13:24,210 [INFO]: 	Creating the index 03/12/2025, 19:13:24
2025-03-12 19:13:24,210 [INFO]: 		-> Instanciate the index HNSW15 03/12/2025, 19:13:24
2025-03-12 19:13:24,211 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0010 secs
2025-03-12 19:13:24,211 [INFO]: 		-> Adding the vectors to the index 03/12/2025, 19:13:24
2025-03-12 19:13:24,211 [INFO]: The memory available for adding the vectors is 49.6GB(total available - used by the index)
2025-03-12 19:13:24,211 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/8 [00:00<?, ?it/s] 38%|███▊      | 3/8 [00:00<00:00, 28.68it/s]100%|██████████| 8/8 [00:01<00:00,  5.68it/s]100%|██████████| 8/8 [00:01<00:00,  6.23it/s]
2025-03-12 19:13:25,498 [INFO]: 	Computing best hyperparameters for index knn.index 03/12/2025, 19:13:25
2025-03-12 19:13:45,348 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 19.8500 secs
2025-03-12 19:13:45,348 [INFO]: The best hyperparameters are: efSearch=289
2025-03-12 19:13:45,348 [INFO]: 	Compute fast metrics 03/12/2025, 19:13:45
  0%|          | 0/4 [00:00<?, ?it/s] 75%|███████▌  | 3/4 [00:00<00:00, 27.41it/s] 75%|███████▌  | 3/4 [00:00<00:00, 24.27it/s]
2025-03-12 19:13:56,664 [INFO]: 	>>> Finished "Compute fast metrics" in 11.3160 secs
2025-03-12 19:13:56,665 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 32.4540 secs
2025-03-12 19:13:56,665 [INFO]: {
2025-03-12 19:13:56,665 [INFO]: 	index_key: HNSW15
2025-03-12 19:13:56,665 [INFO]: 	index_param: efSearch=289
2025-03-12 19:13:56,665 [INFO]: 	index_path: knn.index
2025-03-12 19:13:56,665 [INFO]: 	size in bytes: 380306290
2025-03-12 19:13:56,665 [INFO]: 	avg_search_speed_ms: 9.566007737812887
2025-03-12 19:13:56,665 [INFO]: 	99p_search_speed_ms: 12.29327336186543
2025-03-12 19:13:56,665 [INFO]: 	reconstruction error %: 0.0
2025-03-12 19:13:56,665 [INFO]: 	nb vectors: 1933
2025-03-12 19:13:56,665 [INFO]: 	vectors dimension: 49152
2025-03-12 19:13:56,665 [INFO]: 	compression ratio: 0.9993083837766659
2025-03-12 19:13:56,665 [INFO]: }
2025-03-12 19:13:56,665 [INFO]: 	>>> Finished "Creating the index" in 32.4556 secs
2025-03-12 19:13:56,665 [INFO]: >>> Finished "Launching the whole pipeline" in 32.4824 secs
2025-03-12 19:13:57: [retrieval_preprocessing] calculating distances ...
2025-03-12 19:13:57: [retrieval_preprocessing] finished and saved retrieval indices for episode 140 [episode count 14/20]
[retrieval_preprocessing] for episode 141 [episode count 15/20], we have num_retrieval=np.int64(1943) num_query=np.int64(93)
2025-03-12 19:13:57,695 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-12 19:13:57,921 [INFO]: Launching the whole pipeline 03/12/2025, 19:13:57
2025-03-12 19:13:57,921 [INFO]: Reading total number of vectors and dimension 03/12/2025, 19:13:57
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 2420.26it/s]
2025-03-12 19:13:57,949 [INFO]: There are 1943 embeddings of dim 49152
2025-03-12 19:13:57,949 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0285 secs
2025-03-12 19:13:57,949 [INFO]: 	Compute estimated construction time of the index 03/12/2025, 19:13:57
2025-03-12 19:13:57,949 [INFO]: 		-> Train: 16.7 minutes
2025-03-12 19:13:57,949 [INFO]: 		-> Add: 1.1 seconds
2025-03-12 19:13:57,949 [INFO]: 		Total: 16.7 minutes
2025-03-12 19:13:57,949 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0001 secs
2025-03-12 19:13:57,949 [INFO]: 	Checking that your have enough memory available to create the index 03/12/2025, 19:13:57
2025-03-12 19:13:57,949 [INFO]: 401.0MB of memory will be needed to build the index (more might be used if you have more)
2025-03-12 19:13:57,950 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0001 secs
2025-03-12 19:13:57,950 [INFO]: 	Selecting most promising index types given data characteristics 03/12/2025, 19:13:57
2025-03-12 19:13:57,950 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-12 19:13:57,950 [INFO]: 	Creating the index 03/12/2025, 19:13:57
2025-03-12 19:13:57,950 [INFO]: 		-> Instanciate the index HNSW15 03/12/2025, 19:13:57
2025-03-12 19:13:57,951 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0009 secs
2025-03-12 19:13:57,951 [INFO]: 		-> Adding the vectors to the index 03/12/2025, 19:13:57
2025-03-12 19:13:57,951 [INFO]: The memory available for adding the vectors is 49.6GB(total available - used by the index)
2025-03-12 19:13:57,951 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/8 [00:00<?, ?it/s] 38%|███▊      | 3/8 [00:00<00:00, 26.98it/s]100%|██████████| 8/8 [00:01<00:00,  5.58it/s]100%|██████████| 8/8 [00:01<00:00,  6.12it/s]
2025-03-12 19:13:59,261 [INFO]: 	Computing best hyperparameters for index knn.index 03/12/2025, 19:13:59
2025-03-12 19:14:18,770 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 19.5080 secs
2025-03-12 19:14:18,770 [INFO]: The best hyperparameters are: efSearch=302
2025-03-12 19:14:18,770 [INFO]: 	Compute fast metrics 03/12/2025, 19:14:18
  0%|          | 0/4 [00:00<?, ?it/s] 75%|███████▌  | 3/4 [00:00<00:00, 27.45it/s] 75%|███████▌  | 3/4 [00:00<00:00, 24.31it/s]
2025-03-12 19:14:29,847 [INFO]: 	>>> Finished "Compute fast metrics" in 11.0767 secs
2025-03-12 19:14:29,848 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 31.8970 secs
2025-03-12 19:14:29,848 [INFO]: {
2025-03-12 19:14:29,848 [INFO]: 	index_key: HNSW15
2025-03-12 19:14:29,848 [INFO]: 	index_param: efSearch=302
2025-03-12 19:14:29,848 [INFO]: 	index_path: knn.index
2025-03-12 19:14:29,848 [INFO]: 	size in bytes: 382273690
2025-03-12 19:14:29,848 [INFO]: 	avg_search_speed_ms: 9.55470078317902
2025-03-12 19:14:29,848 [INFO]: 	99p_search_speed_ms: 12.24133408628404
2025-03-12 19:14:29,848 [INFO]: 	reconstruction error %: 0.0
2025-03-12 19:14:29,848 [INFO]: 	nb vectors: 1943
2025-03-12 19:14:29,848 [INFO]: 	vectors dimension: 49152
2025-03-12 19:14:29,848 [INFO]: 	compression ratio: 0.9993084902076311
2025-03-12 19:14:29,848 [INFO]: }
2025-03-12 19:14:29,848 [INFO]: 	>>> Finished "Creating the index" in 31.8984 secs
2025-03-12 19:14:29,848 [INFO]: >>> Finished "Launching the whole pipeline" in 31.9274 secs
2025-03-12 19:14:30: [retrieval_preprocessing] calculating distances ...
2025-03-12 19:14:30: [retrieval_preprocessing] finished and saved retrieval indices for episode 141 [episode count 15/20]
[retrieval_preprocessing] for episode 142 [episode count 16/20], we have num_retrieval=np.int64(1905) num_query=np.int64(131)
2025-03-12 19:14:30,788 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-12 19:14:31,008 [INFO]: Launching the whole pipeline 03/12/2025, 19:14:31
2025-03-12 19:14:31,008 [INFO]: Reading total number of vectors and dimension 03/12/2025, 19:14:31
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1773.49it/s]
2025-03-12 19:14:31,033 [INFO]: There are 1905 embeddings of dim 49152
2025-03-12 19:14:31,033 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0251 secs
2025-03-12 19:14:31,033 [INFO]: 	Compute estimated construction time of the index 03/12/2025, 19:14:31
2025-03-12 19:14:31,033 [INFO]: 		-> Train: 16.7 minutes
2025-03-12 19:14:31,033 [INFO]: 		-> Add: 1.0 seconds
2025-03-12 19:14:31,033 [INFO]: 		Total: 16.7 minutes
2025-03-12 19:14:31,033 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0001 secs
2025-03-12 19:14:31,033 [INFO]: 	Checking that your have enough memory available to create the index 03/12/2025, 19:14:31
2025-03-12 19:14:31,033 [INFO]: 393.1MB of memory will be needed to build the index (more might be used if you have more)
2025-03-12 19:14:31,033 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0001 secs
2025-03-12 19:14:31,033 [INFO]: 	Selecting most promising index types given data characteristics 03/12/2025, 19:14:31
2025-03-12 19:14:31,033 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-12 19:14:31,033 [INFO]: 	Creating the index 03/12/2025, 19:14:31
2025-03-12 19:14:31,033 [INFO]: 		-> Instanciate the index HNSW15 03/12/2025, 19:14:31
2025-03-12 19:14:31,034 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0011 secs
2025-03-12 19:14:31,034 [INFO]: 		-> Adding the vectors to the index 03/12/2025, 19:14:31
2025-03-12 19:14:31,035 [INFO]: The memory available for adding the vectors is 49.7GB(total available - used by the index)
2025-03-12 19:14:31,035 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/8 [00:00<?, ?it/s] 38%|███▊      | 3/8 [00:00<00:00, 26.50it/s]100%|██████████| 8/8 [00:01<00:00,  5.66it/s]100%|██████████| 8/8 [00:01<00:00,  6.20it/s]
2025-03-12 19:14:32,328 [INFO]: 	Computing best hyperparameters for index knn.index 03/12/2025, 19:14:32
2025-03-12 19:14:51,996 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 19.6675 secs
2025-03-12 19:14:51,996 [INFO]: The best hyperparameters are: efSearch=288
2025-03-12 19:14:51,996 [INFO]: 	Compute fast metrics 03/12/2025, 19:14:51
  0%|          | 0/4 [00:00<?, ?it/s] 75%|███████▌  | 3/4 [00:00<00:00, 28.58it/s] 75%|███████▌  | 3/4 [00:00<00:00, 24.95it/s]
2025-03-12 19:15:03,087 [INFO]: 	>>> Finished "Compute fast metrics" in 11.0908 secs
2025-03-12 19:15:03,088 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 32.0535 secs
2025-03-12 19:15:03,088 [INFO]: {
2025-03-12 19:15:03,088 [INFO]: 	index_key: HNSW15
2025-03-12 19:15:03,088 [INFO]: 	index_param: efSearch=288
2025-03-12 19:15:03,088 [INFO]: 	index_path: knn.index
2025-03-12 19:15:03,088 [INFO]: 	size in bytes: 374797450
2025-03-12 19:15:03,088 [INFO]: 	avg_search_speed_ms: 9.676663480866592
2025-03-12 19:15:03,088 [INFO]: 	99p_search_speed_ms: 13.334165893029418
2025-03-12 19:15:03,088 [INFO]: 	reconstruction error %: 0.0
2025-03-12 19:15:03,088 [INFO]: 	nb vectors: 1905
2025-03-12 19:15:03,089 [INFO]: 	vectors dimension: 49152
2025-03-12 19:15:03,089 [INFO]: 	compression ratio: 0.9993083997769996
2025-03-12 19:15:03,089 [INFO]: }
2025-03-12 19:15:03,089 [INFO]: 	>>> Finished "Creating the index" in 32.0553 secs
2025-03-12 19:15:03,089 [INFO]: >>> Finished "Launching the whole pipeline" in 32.0809 secs
2025-03-12 19:15:03: [retrieval_preprocessing] calculating distances ...
2025-03-12 19:15:04: [retrieval_preprocessing] finished and saved retrieval indices for episode 142 [episode count 16/20]
[retrieval_preprocessing] for episode 143 [episode count 17/20], we have num_retrieval=np.int64(1953) num_query=np.int64(83)
2025-03-12 19:15:04,211 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-12 19:15:04,429 [INFO]: Launching the whole pipeline 03/12/2025, 19:15:04
2025-03-12 19:15:04,429 [INFO]: Reading total number of vectors and dimension 03/12/2025, 19:15:04
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 2614.90it/s]
2025-03-12 19:15:04,457 [INFO]: There are 1953 embeddings of dim 49152
2025-03-12 19:15:04,457 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0286 secs
2025-03-12 19:15:04,458 [INFO]: 	Compute estimated construction time of the index 03/12/2025, 19:15:04
2025-03-12 19:15:04,458 [INFO]: 		-> Train: 16.7 minutes
2025-03-12 19:15:04,458 [INFO]: 		-> Add: 1.1 seconds
2025-03-12 19:15:04,458 [INFO]: 		Total: 16.7 minutes
2025-03-12 19:15:04,458 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0001 secs
2025-03-12 19:15:04,458 [INFO]: 	Checking that your have enough memory available to create the index 03/12/2025, 19:15:04
2025-03-12 19:15:04,458 [INFO]: 403.1MB of memory will be needed to build the index (more might be used if you have more)
2025-03-12 19:15:04,458 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0001 secs
2025-03-12 19:15:04,458 [INFO]: 	Selecting most promising index types given data characteristics 03/12/2025, 19:15:04
2025-03-12 19:15:04,458 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-12 19:15:04,458 [INFO]: 	Creating the index 03/12/2025, 19:15:04
2025-03-12 19:15:04,458 [INFO]: 		-> Instanciate the index HNSW15 03/12/2025, 19:15:04
2025-03-12 19:15:04,459 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0009 secs
2025-03-12 19:15:04,459 [INFO]: 		-> Adding the vectors to the index 03/12/2025, 19:15:04
2025-03-12 19:15:04,459 [INFO]: The memory available for adding the vectors is 49.6GB(total available - used by the index)
2025-03-12 19:15:04,459 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/8 [00:00<?, ?it/s] 38%|███▊      | 3/8 [00:00<00:00, 28.80it/s]100%|██████████| 8/8 [00:01<00:00,  5.59it/s]100%|██████████| 8/8 [00:01<00:00,  6.14it/s]
2025-03-12 19:15:05,764 [INFO]: 	Computing best hyperparameters for index knn.index 03/12/2025, 19:15:05
2025-03-12 19:15:25,512 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 19.7479 secs
2025-03-12 19:15:25,512 [INFO]: The best hyperparameters are: efSearch=289
2025-03-12 19:15:25,512 [INFO]: 	Compute fast metrics 03/12/2025, 19:15:25
  0%|          | 0/4 [00:00<?, ?it/s] 75%|███████▌  | 3/4 [00:00<00:00, 27.34it/s] 75%|███████▌  | 3/4 [00:00<00:00, 24.35it/s]
2025-03-12 19:15:36,628 [INFO]: 	>>> Finished "Compute fast metrics" in 11.1159 secs
2025-03-12 19:15:36,629 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 32.1701 secs
2025-03-12 19:15:36,629 [INFO]: {
2025-03-12 19:15:36,629 [INFO]: 	index_key: HNSW15
2025-03-12 19:15:36,629 [INFO]: 	index_param: efSearch=289
2025-03-12 19:15:36,629 [INFO]: 	index_path: knn.index
2025-03-12 19:15:36,629 [INFO]: 	size in bytes: 384241090
2025-03-12 19:15:36,629 [INFO]: 	avg_search_speed_ms: 9.575290345190245
2025-03-12 19:15:36,629 [INFO]: 	99p_search_speed_ms: 12.24341880530119
2025-03-12 19:15:36,629 [INFO]: 	reconstruction error %: 0.0
2025-03-12 19:15:36,629 [INFO]: 	nb vectors: 1953
2025-03-12 19:15:36,629 [INFO]: 	vectors dimension: 49152
2025-03-12 19:15:36,629 [INFO]: 	compression ratio: 0.9993085955486958
2025-03-12 19:15:36,629 [INFO]: }
2025-03-12 19:15:36,629 [INFO]: 	>>> Finished "Creating the index" in 32.1715 secs
2025-03-12 19:15:36,629 [INFO]: >>> Finished "Launching the whole pipeline" in 32.2006 secs
2025-03-12 19:15:37: [retrieval_preprocessing] calculating distances ...
2025-03-12 19:15:37: [retrieval_preprocessing] finished and saved retrieval indices for episode 143 [episode count 17/20]
[retrieval_preprocessing] for episode 144 [episode count 18/20], we have num_retrieval=np.int64(1946) num_query=np.int64(90)
2025-03-12 19:15:37,373 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-12 19:15:37,599 [INFO]: Launching the whole pipeline 03/12/2025, 19:15:37
2025-03-12 19:15:37,600 [INFO]: Reading total number of vectors and dimension 03/12/2025, 19:15:37
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 1579.18it/s]
2025-03-12 19:15:37,629 [INFO]: There are 1946 embeddings of dim 49152
2025-03-12 19:15:37,629 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0293 secs
2025-03-12 19:15:37,629 [INFO]: 	Compute estimated construction time of the index 03/12/2025, 19:15:37
2025-03-12 19:15:37,629 [INFO]: 		-> Train: 16.7 minutes
2025-03-12 19:15:37,629 [INFO]: 		-> Add: 1.1 seconds
2025-03-12 19:15:37,629 [INFO]: 		Total: 16.7 minutes
2025-03-12 19:15:37,629 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0001 secs
2025-03-12 19:15:37,629 [INFO]: 	Checking that your have enough memory available to create the index 03/12/2025, 19:15:37
2025-03-12 19:15:37,629 [INFO]: 401.6MB of memory will be needed to build the index (more might be used if you have more)
2025-03-12 19:15:37,629 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0001 secs
2025-03-12 19:15:37,629 [INFO]: 	Selecting most promising index types given data characteristics 03/12/2025, 19:15:37
2025-03-12 19:15:37,629 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-12 19:15:37,630 [INFO]: 	Creating the index 03/12/2025, 19:15:37
2025-03-12 19:15:37,630 [INFO]: 		-> Instanciate the index HNSW15 03/12/2025, 19:15:37
2025-03-12 19:15:37,631 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0013 secs
2025-03-12 19:15:37,631 [INFO]: 		-> Adding the vectors to the index 03/12/2025, 19:15:37
2025-03-12 19:15:37,632 [INFO]: The memory available for adding the vectors is 49.6GB(total available - used by the index)
2025-03-12 19:15:37,632 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/8 [00:00<?, ?it/s] 38%|███▊      | 3/8 [00:00<00:00, 27.19it/s]100%|██████████| 8/8 [00:01<00:00,  5.58it/s]100%|██████████| 8/8 [00:01<00:00,  6.12it/s]
2025-03-12 19:15:38,942 [INFO]: 	Computing best hyperparameters for index knn.index 03/12/2025, 19:15:38
2025-03-12 19:15:58,523 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 19.5812 secs
2025-03-12 19:15:58,524 [INFO]: The best hyperparameters are: efSearch=306
2025-03-12 19:15:58,524 [INFO]: 	Compute fast metrics 03/12/2025, 19:15:58
  0%|          | 0/4 [00:00<?, ?it/s] 75%|███████▌  | 3/4 [00:00<00:00, 29.42it/s] 75%|███████▌  | 3/4 [00:00<00:00, 26.00it/s]
2025-03-12 19:16:09,635 [INFO]: 	>>> Finished "Compute fast metrics" in 11.1117 secs
2025-03-12 19:16:09,636 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 32.0049 secs
2025-03-12 19:16:09,637 [INFO]: {
2025-03-12 19:16:09,637 [INFO]: 	index_key: HNSW15
2025-03-12 19:16:09,637 [INFO]: 	index_param: efSearch=306
2025-03-12 19:16:09,637 [INFO]: 	index_path: knn.index
2025-03-12 19:16:09,637 [INFO]: 	size in bytes: 382863910
2025-03-12 19:16:09,637 [INFO]: 	avg_search_speed_ms: 9.648771892798385
2025-03-12 19:16:09,637 [INFO]: 	99p_search_speed_ms: 12.373459301888943
2025-03-12 19:16:09,637 [INFO]: 	reconstruction error %: 0.0
2025-03-12 19:16:09,637 [INFO]: 	nb vectors: 1946
2025-03-12 19:16:09,637 [INFO]: 	vectors dimension: 49152
2025-03-12 19:16:09,637 [INFO]: 	compression ratio: 0.9993085219236255
2025-03-12 19:16:09,637 [INFO]: }
2025-03-12 19:16:09,637 [INFO]: 	>>> Finished "Creating the index" in 32.0069 secs
2025-03-12 19:16:09,637 [INFO]: >>> Finished "Launching the whole pipeline" in 32.0372 secs
2025-03-12 19:16:10: [retrieval_preprocessing] calculating distances ...
2025-03-12 19:16:10: [retrieval_preprocessing] finished and saved retrieval indices for episode 144 [episode count 18/20]
[retrieval_preprocessing] for episode 145 [episode count 19/20], we have num_retrieval=np.int64(1779) num_query=np.int64(257)
2025-03-12 19:16:10,468 [INFO]: Using 8 omp threads (processes), consider increasing --nb_cores if you have more
2025-03-12 19:16:10,675 [INFO]: Launching the whole pipeline 03/12/2025, 19:16:10
2025-03-12 19:16:10,675 [INFO]: Reading total number of vectors and dimension 03/12/2025, 19:16:10
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 2033.11it/s]
2025-03-12 19:16:10,704 [INFO]: There are 1779 embeddings of dim 49152
2025-03-12 19:16:10,704 [INFO]: >>> Finished "Reading total number of vectors and dimension" in 0.0294 secs
2025-03-12 19:16:10,705 [INFO]: 	Compute estimated construction time of the index 03/12/2025, 19:16:10
2025-03-12 19:16:10,705 [INFO]: 		-> Train: 16.7 minutes
2025-03-12 19:16:10,705 [INFO]: 		-> Add: 1.0 seconds
2025-03-12 19:16:10,705 [INFO]: 		Total: 16.7 minutes
2025-03-12 19:16:10,705 [INFO]: 	>>> Finished "Compute estimated construction time of the index" in 0.0003 secs
2025-03-12 19:16:10,705 [INFO]: 	Checking that your have enough memory available to create the index 03/12/2025, 19:16:10
2025-03-12 19:16:10,705 [INFO]: 367.1MB of memory will be needed to build the index (more might be used if you have more)
2025-03-12 19:16:10,705 [INFO]: 	>>> Finished "Checking that your have enough memory available to create the index" in 0.0004 secs
2025-03-12 19:16:10,706 [INFO]: 	Selecting most promising index types given data characteristics 03/12/2025, 19:16:10
2025-03-12 19:16:10,706 [INFO]: 	>>> Finished "Selecting most promising index types given data characteristics" in 0.0000 secs
2025-03-12 19:16:10,706 [INFO]: 	Creating the index 03/12/2025, 19:16:10
2025-03-12 19:16:10,706 [INFO]: 		-> Instanciate the index HNSW15 03/12/2025, 19:16:10
2025-03-12 19:16:10,709 [INFO]: 		>>> Finished "-> Instanciate the index HNSW15" in 0.0025 secs
2025-03-12 19:16:10,709 [INFO]: 		-> Adding the vectors to the index 03/12/2025, 19:16:10
2025-03-12 19:16:10,709 [INFO]: The memory available for adding the vectors is 49.7GB(total available - used by the index)
2025-03-12 19:16:10,709 [INFO]: Using a batch size of 5086 (memory overhead 953.6MB)
  0%|          | 0/8 [00:00<?, ?it/s] 38%|███▊      | 3/8 [00:00<00:00, 28.25it/s]100%|██████████| 8/8 [00:01<00:00,  6.21it/s]100%|██████████| 8/8 [00:01<00:00,  6.80it/s]
2025-03-12 19:16:11,891 [INFO]: 	Computing best hyperparameters for index knn.index 03/12/2025, 19:16:11
2025-03-12 19:16:30,790 [INFO]: 	>>> Finished "Computing best hyperparameters for index knn.index" in 18.8989 secs
2025-03-12 19:16:30,790 [INFO]: The best hyperparameters are: efSearch=307
2025-03-12 19:16:30,790 [INFO]: 	Compute fast metrics 03/12/2025, 19:16:30
  0%|          | 0/4 [00:00<?, ?it/s] 75%|███████▌  | 3/4 [00:00<00:00, 27.53it/s] 75%|███████▌  | 3/4 [00:00<00:00, 24.37it/s]
2025-03-12 19:16:41,861 [INFO]: 	>>> Finished "Compute fast metrics" in 11.0708 secs
2025-03-12 19:16:41,862 [INFO]: 		>>> Finished "-> Adding the vectors to the index" in 31.1532 secs
2025-03-12 19:16:41,862 [INFO]: {
2025-03-12 19:16:41,862 [INFO]: 	index_key: HNSW15
2025-03-12 19:16:41,862 [INFO]: 	index_param: efSearch=307
2025-03-12 19:16:41,862 [INFO]: 	index_path: knn.index
2025-03-12 19:16:41,862 [INFO]: 	size in bytes: 350007610
2025-03-12 19:16:41,862 [INFO]: 	avg_search_speed_ms: 9.542873727987727
2025-03-12 19:16:41,862 [INFO]: 	99p_search_speed_ms: 12.38578128395602
2025-03-12 19:16:41,862 [INFO]: 	reconstruction error %: 0.0
2025-03-12 19:16:41,862 [INFO]: 	nb vectors: 1779
2025-03-12 19:16:41,862 [INFO]: 	vectors dimension: 49152
2025-03-12 19:16:41,862 [INFO]: 	compression ratio: 0.9993086493176534
2025-03-12 19:16:41,862 [INFO]: }
2025-03-12 19:16:41,862 [INFO]: 	>>> Finished "Creating the index" in 31.1564 secs
2025-03-12 19:16:41,862 [INFO]: >>> Finished "Launching the whole pipeline" in 31.1875 secs
2025-03-12 19:16:43: [retrieval_preprocessing] calculating distances ...
2025-03-12 19:16:44: [retrieval_preprocessing] finished and saved retrieval indices for episode 145 [episode count 19/20]
2025-03-12 19:16:44: [retrieval_preprocessing] finished for collected_demos_training/2025-03-10_pick_up_the_orange_in_the_bowl_and_move_it_to_the_other_container [chosen_id count 7/8]
2025-03-12 19:16:44: [retrieval_preprocessing] done for embedding_type='wrist_image'!
done!
